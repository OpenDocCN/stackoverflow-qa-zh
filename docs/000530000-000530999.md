# StackOverflow 问答 000530000-000530999

# .net - 那里有一个好的“RichString”类吗？

> ID：530004
> 
> 赞同：1
> 
> 时间：2009-02-09T21:14:24.533
> 
> 标签：.net, string, .net-2.0, richtextbox, rtf

我正在寻找一个类/API，它允许您创建和操作 RichText 字符串（rtf 格式）以与 RichTextbox 类似的控件一起使用。

我正在考虑类似 StringBuilder 的东西，但这也允许您在附加到它时指定格式，还可以返回并编辑以前附加的段，以及执行类似于`.Contains()`or`.IndexOf()`和字符串比较的字符串操作。它可能需要一些额外的类来支持格式化功能。

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T21:18:59.813

是的。 [http://www.codeproject.com/KB/miscctrl/RTFBuilder.aspx](http://www.codeproject.com/KB/miscctrl/RTFBuilder.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-18T05:21:54.497

为什么不添加一行*然后*格式化呢？您可以创建一个使用 stringbuilder 的自定义类，但也可以在同一个 sub 中设置文本样式（请注意，一旦绘制它就会看起来是 fomatted，因为它会完成 sub 然后绘制它）我的意思是使用选择来格式化它。此外，我觉得编写 RTF 具有开箱即用的控制能力是脑死的。

**编辑：**只是为了澄清，我的意思是
1\. 写行
2\. 选择自定义字符串生成器中使用的部分（不是通过匹配，而是通过偏移）
3\. 为它们设置样式。=)

**Edit_2：**现在我想起来了，它很有可能拥有一个简化的sintax。你可以有一个只需要你需要的子：

*WriteIt(username, "My text")*
（由您的子自动添加的日期 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T21:24:19.627

[iTextSharp](http://itextsharp.sourceforge.net/)基本上是一个 PDF 生成库，但也可用于创建文件，如下[所示](http://itextsharp.sourceforge.net/tutorial/ch08.html)。

# java - 如何将 java.util.Date 转换为 java.sql.Date？

> ID：530012
> 
> 赞同：487
> 
> 时间：2009-02-09T21:16:18.010
> 
> 标签：java, sql, datetime, date

我正在尝试使用 a[`java.util.Date`](http://docs.oracle.com/javase/8/docs/api/java/util/Date.html)作为输入，然后用它创建一个查询 - 所以我需要一个[`java.sql.Date`](http://docs.oracle.com/javase/8/docs/api/java/sql/Date.html).

我惊讶地发现它不能隐式或显式地进行转换——但我什至不知道该怎么做，因为 Java API 对我来说还是相当新的。

* * *

## 回答 #1

> 赞同：511
> 
> 时间：2009-02-09T21:18:40.860

没关系....

```
public class MainClass {

  public static void main(String[] args) {
    java.util.Date utilDate = new java.util.Date();
    java.sql.Date sqlDate = new java.sql.Date(utilDate.getTime());
    System.out.println("utilDate:" + utilDate);
    System.out.println("sqlDate:" + sqlDate);

  }

} 
```

解释它。链接是[http://www.java2s.com/Tutorial/Java/0040__Data-Type/ConvertfromajavautilDateObjecttoajavasqlDateObject.htm](http://www.java2s.com/Tutorial/Java/0040__Data-Type/ConvertfromajavautilDateObjecttoajavasqlDateObject.htm)

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2015-07-06T04:55:48.497

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2010-11-04T14:03:44.517

对于其他答案，您可能会遇到时间信息问题（将日期与意外结果进行比较！）

我建议：

```
java.util.Calendar cal = Calendar.getInstance();
java.util.Date utilDate = new java.util.Date(); // your util date
cal.setTime(utilDate);
cal.set(Calendar.HOUR_OF_DAY, 0);
cal.set(Calendar.MINUTE, 0);
cal.set(Calendar.SECOND, 0);
cal.set(Calendar.MILLISECOND, 0);    
java.sql.Date sqlDate = new java.sql.Date(cal.getTime().getTime()); // your sql date
System.out.println("utilDate:" + utilDate);
System.out.println("sqlDate:" + sqlDate); 
```

* * *

## 回答 #4

> 赞同：30
> 
> 时间：2014-02-05T21:22:48.373

此函数将从 java 日期对象返回转换后的 SQL 日期。

```
public java.sql.Date convertJavaDateToSqlDate(java.util.Date date) {
    return new java.sql.Date(date.getTime());
} 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2015-07-06T03:36:37.430

转换`java.util.Date`为`java.sql.Date`将丢失小时、分钟和秒。所以如果可能的话，我建议你这样使用`java.sql.Timestamp`：

```
prepareStatement.setTimestamp(1, new Timestamp(utilDate.getTime())); 
```

有关更多信息，您可以查看[此问题](https://stackoverflow.com/questions/2305973/java-util-date-vs-java-sql-date)。

* * *

## 回答 #6

> 赞同：16
> 
> 时间：2016-09-09T14:20:33.583

在我从 JXDatePicker（java 日历）中选择日期并将其作为 SQL Date 类型存储在数据库中的情况下，下面的工作正常..

`java.sql.Date date = new java.sql.Date(pickedDate.getDate().getTime());`

其中pickDate 是JXDatePicker 的对象

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2014-12-23T10:49:22.463

此函数将从 java 日期对象返回转换后的 SQL 日期。

```
public static java.sql.Date convertFromJAVADateToSQLDate(
            java.util.Date javaDate) {
        java.sql.Date sqlDate = null;
        if (javaDate != null) {
            sqlDate = new Date(javaDate.getTime());
        }
        return sqlDate;
    } 
```

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2016-02-16T14:28:54.253

首先格式化您的 java.util.Date。然后使用格式化日期获取java.sql.Date中的日期

```
java.util.Date utilDate = "Your date"
SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
final String stringDate= dateFormat.format(utilDate);
final java.sql.Date sqlDate=  java.sql.Date.valueOf(stringDate); 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-09-24T10:40:02.843

这是将 Util Date 转换为 Sql date 的示例，这是我在项目中使用的一个示例，可能对您也有帮助。

```
java.util.Date utilStartDate = table_Login.getDob();(orwhat ever date your give form obj)
java.sql.Date sqlStartDate = new java.sql.Date(utilStartDate.getTime());(converting date) 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-06-27T08:15:24.133

我是一个新手：经过多次运行这个工作。想法可能有用

```
 String bufDt =  bDOB.getText();  //data from form
     DateFormat dF = new SimpleDateFormat("dd-MM-yyyy"); //data in form is in this format
     Date bbdt = (Date)dF.parse(bufDt);  // string data is converted into java util date
     DateFormat dsF = new SimpleDateFormat("yyyy-MM-dd"); //converted date is reformatted for conversion to sql.date
     String ndt = dsF.format(bbdt); // java util date is converted to compatible java sql date
     java.sql.Date sqlDate=  java.sql.Date.valueOf(ndt);  // finally data from the form is convered to java sql. date for placing in database 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-06-14T08:38:34.773

比较 2 个日期的方法（util.date 或 sql.date）

```
 public static boolean isSameDay(Date a, Date b) {
    Calendar calA = new GregorianCalendar();
    calA.setTime(a);

    Calendar calB = new GregorianCalendar();
    calB.setTime(b);

    final int yearA = calA.get(Calendar.YEAR);
    final int monthA = calA.get(Calendar.MONTH);
    final int dayA = calA.get(Calendar.DAY_OF_YEAR);

    final int yearB = calB.get(Calendar.YEAR);
    final int monthB = calB.get(Calendar.MONTH);
    final int dayB = calB.get(Calendar.DAY_OF_YEAR);

    return yearA == yearB && monthA == monthB && dayA == dayB;
} 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-10-04T12:48:20.667

试试这个

```
public static String toMysqlDateStr(Date date) {
    String dateForMySql = "";
    if (date == null) {
        dateForMySql = null;
    } else {
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
        dateForMySql = sdf.format(date);
    }

    return dateForMySql;
} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2016-03-10T07:48:36.513

我认为最好的转换方法是：

```
static java.sql.Timestamp SQLDateTime(Long utilDate) {
    return new java.sql.Timestamp(utilDate);
}

Date date = new Date();
java.sql.Timestamp dt = SQLDateTime(date.getTime()); 
```

如果要将`dt`变量插入 SQL 表中，可以执行以下操作：

```
insert into table (expireAt) values ('"+dt+"'); 
```

* * *

## 回答 #14

> 赞同：-3
> 
> 时间：2013-12-12T18:20:08.413

我正在使用以下代码，请尝试一下

```
DateFormat fm= new SimpleDateFormatter(); 
```

例如，指定您想要的日期格式，`"DD-MM_YYYY"`或者`'YYYY-mm-dd'` 使用 java Date 数据类型作为

```
fm.format("object of java.util.date"); 
```

然后它会解析你的日期

* * *

## 回答 #15

> 赞同：-4
> 
> 时间：2015-04-02T05:58:04.120

您可以使用此方法将 util 日期转换为 sql 日期，

```
DateUtilities.convertUtilDateToSql(java.util.Date) 
```

* * *

## 回答 #16

> 赞同：-4
> 
> 时间：2016-08-26T11:00:45.103

我正在尝试以下工作正常的编码。

> java.util.Date utilDate = new java.util.Date();
> java.sql.Date sqlDate = new java.sql.Date(utilDate);

* * *

## 回答 #17

> 赞同：-8
> 
> 时间：2012-06-25T21:36:52.680

如果您使用的是 Mysql，则可以将日期列传递给该日期的字符串表示形式

所以我使用 DateFormatter 类对其进行格式化，然后在 sql 语句或准备好的语句中将其设置为字符串

这是代码说明：

```
private String converUtilDateToSqlDate(java.util.Date utilDate) {
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
    String sqlDate = sdf.format(utilDate);
    return sqlDate;
} 
```

字符串日期 = converUtilDateToSqlDate(otherTransaction.getTransDate());

//然后在你的sql语句中传递这个日期

# winapi - 在 Windows 中传输大文件的最佳方式

> ID：530020
> 
> 赞同：3
> 
> 时间：2009-02-09T21:18:26.867
> 
> 标签：winapi, networking, filesystems, data-transfer

在备份我们的网络电子邮件服务器期间，我经常需要在内部和外部驱动器之间传输 >50GB 有时 >100GB 的大文件。传输这些文件的最佳方法是什么？XCOPY 之类的命令行？如果由于时间限制或网络问题而中断，可能有足够强大的东西来继续传输。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T21:34:55.267

查看[robocopy](http://en.wikipedia.org/wiki/Robocopy)。来自维基百科：

> robocopy 或“Robust File Copy”是一个命令行目录复制命令。它作为 Windows 资源工具包的一部分提供，并作为 Windows Vista 和 Windows Server 2008 的标准功能引入。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T21:22:28.773

我免费使用 SyncToy（来自 Microsoft）。这样，如果出现故障，它不会中止整个传输。

恕我直言，非重复性任务的下一个最佳选择是 XCopy。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T21:33:14.520

我已经成功使用[了 Teracopy](http://www.codesector.com/teracopy.php)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T00:24:53.780

我不时被问到这个问题，我总是说同样的话。Microsoft[后台智能传输服务 (BITS)](http://msdn.microsoft.com/en-us/library/aa362708(VS.85).aspx)。这与用于向工作站提供大型服务包等的技术相同。一些特点：

*   网络节流
*   异步传输
*   自动恢复
*   下载的优先级
*   成熟的传输机制

对于那些不想处理命令行语法的人，您可以探索提供 GUI 界面的包装应用程序，[例如 SharpBITS.NET 。](http://www.codeplex.com/sharpbits)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-10T00:31:54.373

我使用[CopyHandler](http://www.copyhandler.com)并发现它做得很好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-11-28T14:52:04.743

好吧，我使用[http://itrnsfr.com](http://itrnsfr.com)在线传输我的大文件。我希望他们将报价扩展到他们目前提供给免费用户的 2 GB 以上

# asp.net - 最佳实践 - MOSS 07 和 Javascript 文件？

> ID：530027
> 
> 赞同：2
> 
> 时间：2009-02-09T21:19:24.820
> 
> 标签：asp.net, javascript, web-parts, sharepoint-2007

在 MOSS 2007 中使用 javascript 文件的建议方法是什么？12 在Hive 某处或直接在站点的虚拟目录中的一个脚本目录中？或者可能作为 webpart 中的嵌入式资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T21:38:16.273

就个人而言，这完全取决于 JavaScript 文件的用途。如果它们要在多个组件之间共享，那么我建议将它们放在 12-hive 中。但是，如果它们将被隔离到单个组件（例如 Web 部件）中，那么将它们作为资源嵌入也可以。

[本文](http://www.synergyonline.com/blog/blog-moss/Lists/Posts/Post.aspx?ID=42)讨论了部署 Web 部件资源的最佳实践，您可能会觉得这些资源很有用，总结如下：

> 在这篇文章中，您了解了如何链接和嵌入 Web 部件资源。每个都有自己的优点和缺点，主要归结为是否需要将资源与 Web 部件分开维护。在这两种情况下，资源文件都可以被缓存，因此每个选项的性能差异很小。随意将这两种方法之一用于您的下一个 Web 部件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T21:30:32.437

我建议您在 12-hive 中部署这些脚本。

*   将它们放在 12-hive 中可确保快速访问，这对脚本很重要。否则，您将面临页面呈现滞后的风险。更多的管理开销，因为您必须将它们部署在农场中的*所有*前端网络服务器上。
*   将它们放在内容数据库中使它们在性能方面更易于集中管理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T21:27:04.427

我在我称为“脚本”的文件夹中添加到 Sharepoint Designer 的位置，我认为这会将其放入数据库中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T21:35:40.287

我们使用单独的脚本目录。我们对图像使用类似的方法。

这使我们能够在我们的 webpart 和通过 Sharepoint 可用的自定义应用程序之间轻松共享图像和 Javascript。

这也应该意味着它们只下载一次并被缓存。

# jquery - jquery插件或脚本自动循环通过手风琴

> ID：530033
> 
> 赞同：1
> 
> 时间：2009-02-09T21:22:07.480
> 
> 标签：jquery, accordion, cycle

请有人可以就此向我提出建议。当您将鼠标悬停在每个项目标题上以显示每个子内容时，我目前正在使用来自[bassistance.de的手风琴插件成功工作。](http://bassistance.de/jquery-plugins/jquery-plugin-accordion/)我为此使用了一个无序列表（4 个列表项，每个项有 2 个子项）

这很好，但现在要求它：

1.  每 5 秒自动循环（展开/折叠）每个列表项，但是
2.  当您将鼠标悬停在子内容上时暂停（不是通常激活该列表项的手风琴功能的父项）
3.  仍然保留鼠标悬停功能，即。展开/折叠每个列表项的子内容。

我希望所有这些都是有道理的，如果有任何不清楚的地方，请告诉我，我会非常乐意澄清它！

感谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T23:12:23.067

为此，请创建一个执行两件事的函数：

1.  在循环中的下一个元素上调用 click()
2.  使用方法本身作为第一个参数调用 setTimeout，并将所需的延迟作为第二个参数（基本上函数被递归调用，并带有延迟）

要让它在鼠标悬停时停止循环，请在 if(running) 中调用 click() 并创建 start 和 stop 方法来控制 running 变量。将这些绑定到相关元素上的鼠标悬停。

请参阅[此示例](http://jqueryfordesigners.com/ajax-spy/)以获取灵感（查找“最后...”标题）。

# sql - 如何执行条件 SQL Server 语句？

> ID：530043
> 
> 赞同：0
> 
> 时间：2009-02-09T21:25:58.470
> 
> 标签：sql, sql-server, tsql, datetime, query-help

我有一个包含事件信息的数据库，包括日期（MMDDYYYY 格式）。是否可以编写 SQL Server 语句来仅获取特定时间范围内的行？

类似这样的伪语句：

```
SELECT * FROM events WHERE [current_date minus date <= 31] ORDER BY date ASC 
```

where`date`是 SQL Server 行中的日期，并且`current_date`是今天的日期。是`31`几天，所以基本上是一个月的时间。

我可以在通用语句（阅读：）之后轻松处理数据`SELECT * FROM events ORDER BY date ASC`，但是知道这是否可能会很“酷”（就像我学习新东西一样：P）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T21:30:09.410

SELECT * FROM events WHERE date > getdate() - 31 ORDER BY date ASC

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T21:29:47.260

使用 DateDiff：

SELECT * FROM events WHERE DATEDIFF(day, date, getdate()) < 31 ORDER BY date ASC

[http://msdn.microsoft.com/en-us/library/ms189794.aspx](http://msdn.microsoft.com/en-us/library/ms189794.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T21:33:14.507

```
DECLARE @start_date datetime
SET @start_date = DATEADD(day, -31, getdate())
SELECT * FROM events WHERE date BETWEEN @start_date AND getdate() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T21:33:30.760

为获得最佳性能，请勿在表达式中使用函数。首先计算阈值日期（在您的客户端或存储过程中），然后使用

SELECT ... WHERE [日期] > {将阈值放在这里}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T21:28:11.117

[DateDiff](http://msdn.microsoft.com/en-us/library/aa258269(SQL.80).aspx)和 GetDate() 应该可以解决您的问题。

例子：

```
SELECT * FROM events WHERE DATEDIFF(day, date, GETDATE()) <= 31 ORDER BY date ASC 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T21:31:12.887

您可能可以使用该`DATEDIFF`功能。

D'oh，Ninja'd 查了一下，以确保我没有在胡说八道！:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T21:31:58.720

还：

```
选择 *
从事件
在 dateadd(day,-31,getdate()) 和 getdate() 之间的 current_date
按日期排序 ASC
```

虽然真的 BETWEEN 是可憎的

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-09T21:32:00.843

使用 GetDate() 返回当前日期。

以天为单位增加或减少。

一个例子是：

```
SELECT *
FROM MY_TABLE T
WHERE T.SOME_DATE BETWEEN (GetDate()-31) AND GetDate() 
```

# cocoa-touch - 如何在横向模式下查看缩略图？

> ID：530045
> 
> 赞同：0
> 
> 时间：2009-02-09T21:26:03.243
> 
> 标签：cocoa-touch

我有一个任务是显示一堆图像（类似于照片应用程序）。

顶部区域是全尺寸图像，底部是图像列表。

假设存在 100 张图像。现在用户在 15-20 图像部分和图像 16 上。

现在，我的问题是如何解决这个问题。我想要一些像 UITableView 控件但在横向模式下工作的东西......

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T03:44:46.843

实际上，如果我正确理解您的需求，您应该仍然可以将 UITableView 用于您的图像滚动列表。您希望在屏幕底部有一个单个图像的滚动列表，就像您在 Aperture 之类的东西中看到的那样。

为此，请创建一个 UITableView 并使用 CGAffineTransform 将其旋转 90 度。例如，以下代码创建一个表格，将其旋转并将其放置在屏幕底部：

```
UITableView *imageTable = [[UITableView alloc] initWithFrame:CGRectMake(215.0f, 30.0f, 50.0f, 480.0f)];
imageTable.transform = CGAffineTransformMakeRotation(M_PI / 2.0f);
[self.view addSubview:imageTable]; 
```

然后，您可以使用每个行单元格的图像属性将图像简单地放置在表格行中（记住将图像在表格视图的相反方向上旋转 90 度）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-09T21:27:42.180

在横向模式下，您是一个人。

使用 UIImageViews 网格真的不会那么难。

内存可能是个问题，因此您必须翻阅数组并仅实例化您要显示的 UIImageViews。

听起来很有趣！祝你好运！

# c# - 寻找 PDF 文件解析器

> ID：530052
> 
> 赞同：4
> 
> 时间：2009-02-09T21:28:43.627
> 
> 标签：c#, regex, delphi, pdf, unicode

有谁知道我可以用来从纯文本 pdf 文件中提取部分文本的 PDF 文件解析器？特别是我想要一种能够可靠地提取特定于注释的文本部分的方法？

Delphi，C# RegEx 我不介意。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T21:48:55.450

xactpro 上的[PDF 文件解析器](http://www.xtractpro.com/articles/PDF-File-Parser.aspx)文章似乎正是您所需要的。它解释了 PDF 的格式，并附带了解析器的完整源代码（以及另一个用于模型可视化的项目）。

解析器使用特定于格式的术语，但您可以轻松地使用可视化器来了解要查找的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-10T07:29:46.473

您还可以查看 Xpdf ( [http://www.foolabs.com/xpdf/download.html](http://www.foolabs.com/xpdf/download.html) )

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T21:34:36.920

不确定它是否支持您需要的功能，但我们一直在使用[abcPDF](http://www.websupergoo.com/products.htm#pd)并取得了一些成功。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-01T07:33:11.947

签出pdfbox

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-01T17:21:38.360

abcPDF 确实允许您提取注释，它们在帮助中有一个非常好的部分，但处理它的代码通常是：

```
 for (int objectIndex = 0; objectIndex < theDoc.ObjectSoup.Count; objectIndex++)
        {
            try
            {
                IndirectObject element = theDoc.ObjectSoup.ElementAt(objectIndex);

                string elementType = element.GetType().ToString();
                switch (elementType)
                {
                    case "WebSupergoo.ABCpdf8.Objects.Annotation":
                       //process the annotation, which could be all kinds of stuff
                        WebSupergoo.ABCpdf8.Objects.Annotation annotation = (WebSupergoo.ABCpdf8.Objects.Annotation)element; 

                        ProcessAnnotation(annotation); 
```

...

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-04-08T10:06:03.167

我不知道这些 PDF 解析器的所有功能，但 Aspose 有一个相当全面的功能。不幸的是，我们确实遇到了两个错误，我已经等了很长时间才能修复它们。

ITextSharp 似乎是 .Net 最常见的开源 PDF 解析器。

# hardware - 老年硬件上的 LAMP 设置？

> ID：530055
> 
> 赞同：0
> 
> 时间：2009-02-09T21:29:02.237
> 
> 标签：hardware, lamp, distro

我的前室友同意在他的服务器上托管我的网站一段时间，而我和我的妻子（也是新的）一起住在我的新公寓里。他希望尽快搬家，并希望停用他的 Web 服务器，因此我需要构建一个服务器供我自己使用。

我研究了在我用于开发的 Mac Mini 上设置一个虚拟盒子，但我不能保证它总是可用的，所以我希望有专门用于服务该站点的硬件。

旧的设置是 LAMP，我在 Linux 中很舒服，LAMP 似乎是要走的路，但我拥有的备用硬件是旧的 - 3/486、32 或 64 兆内存，HD 介于 8 和 16 之间演出。

然而，由于与我的妻子设定了预算，新硬件几乎没有了。

你们有什么感想？我可以在旧的和受限的硬件上运行 LAMP 设置吗？一些页面利用 MySQL 和 Php，所以它不是直接的静态 HTML，但我没有运行 Java 或任何东西。是否有特别适合这种设置的发行版？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T21:33:37.920

只需四处询问，您可能会发现一台比那台更好的免费机器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T21:35:20.553

只是一个提示，但从个人经验来看，我发现 FreeBSD 在低端硬件上的工作要比现代 Linux 发行版好得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T21:34:02.647

当然，它将在该硬件上运行，但这完全取决于应用程序将对其施加什么样的负载（例如大量复杂的数据库访问），以及它将获得多少命中。

如果它只是供您玩耍和测试的东西，那么它会工作得很好，尽管如果您想要更强大的东西，这些天您几乎可以免费获得 PIII 服务器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T22:04:49.390

我只想指出，8 或 16 GB 硬盘在 386 时代并不常见。更像是 100-500mb 范围。RAM 也是如此。除此之外，我同意其他人的观点 - 这些天可能会在垃圾箱中找到更好的配置。这是严重的老了。

# asp.net - WCSF 适合我吗？

> ID：530062
> 
> 赞同：4
> 
> 时间：2009-02-09T21:31:19.597
> 
> 标签：asp.net, architecture, wcsf

我有一个 3 人的 .NET 网上商店。多年来，我们开发了许多用于内容管理、博客、电子商务、社交网络等的工具。不过，我们从未真正将软件模块化；因此将功能从一个站点移植到另一个站点是劳动密集型的（我们通常只是将代码和其他资产（如 JS、CSS 和图像）从模型站点复制并粘贴到目标站点）。我们确实有一个提供许多共享功能的控件库，但由于无法将 ASPX 或 ASCX 文件编译到控件库中，这些页面和控件通常只存在于每个网站中，并从一个站点复制并粘贴到下一个。

我们希望重新构建我们的整个平台，以便更轻松地标准化和重用模块。理想情况下，我希望能够复制一个包含模块所需所有内容的文件夹，并让目标网站识别它并在应用程序启动时注册它。

此外，我想保留我们目前拥有的一些灵活性，以便可以轻松地为特定站点自定义模块的*功能*（而不仅仅是 CSS 和母版页）。场景可能包括向联系人模块添加自定义字段，或在博客评论表单上收集自定义信息。

最后，我希望能够在基本代码和每个网站的定制之间划清界限，这样我们就可以通过更新核心代码轻松地将现有网站升级到最新版本的核心软件。我会看到核心代码（包括通用资产、代码和 ASPX/ASCX 文件）存在于每个网站项目中，但通过源代码控制进行同步。

现在，我可以很清楚地看到我们将如何自己构建和编码这一切；但是，我想知道[Web 客户端软件工厂 (WCSF) 模式](http://www.codeplex.com/websf)是否会给我们带来很多我们需要的东西。根据您使用 WCSF 的经验，您认为它适合我在这里描述的场景吗？从快速阅读来看，它似乎会为模块化问题提供一个很好的解决方案，但尚不清楚它是否会提供一种定制模块的直接方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-21T14:04:11.560

回答这个问题的最佳方法是潜入并进行一些实验——这不是浪费时间，而是对研究的投资。使用 WCSF 与您的传统架构进行一些并发开发，看看哪个效果最好。

# git - 使用 Git 合并分支

> ID：530063
> 
> 赞同：2
> 
> 时间：2009-02-09T21:31:22.933
> 
> 标签：git

我正在使用 git for windows 来管理本地项目。我有两个分支，“master”和“change_specific”。我在“change_specific”中添加了一些额外的文件。当我切换到“master”时，这些文件不会显示。当我打电话

```
git merge -m "don't need old branch" master change_specific 
```

git 告诉我“已经是最新的。是的！”。然而，分支似乎有不同的文件。我想删除'change_specific'并完成它，但我担心这会清除我添加的文件 - 一件坏事。当我扫描 git 文档时，我似乎遗漏了一些东西。**发生了什么事，我该怎么办？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-09T21:39:00.000

```
# git checkout master
# git merge change_specific 
```

那应该这样做。`git merge <branch1> <branch2>`实际上尝试合并*三个*分支，即您在命令行中给出的两个分支和当前分支。如果其中两个实际上相同，则可能会解释“已经是最新的”消息。

如果您尚未向世界公开您的更改，我宁愿执行变基：

```
# git checkout change_specific
# git rebase master
# git checkout master
# git merge change_specific 
```

这会将“更改`_`特定”分支中的更改应用到当前主控，线性重写历史。在此之后，您可以安全地删除“change_specific”分支`git branch -d change_specific`。

# c# - 在标志上使用位运算符

> ID：530077
> 
> 赞同：30
> 
> 时间：2009-02-09T21:33:59.027
> 
> 标签：c#, .net, bit-manipulation, bit-fields

我有四个标志

```
Current = 0x1  
Past = 0x2  
Future = 0x4  
All = 0x7 
```

假设我收到了过去和未来的两个标志 ( `setFlags(PAST | FUTURE)`)。我怎么知道是否`Past`在里面？同样，我怎么能`Current`说它不在里面？这样我就不必测试每一种可能的组合。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-09T21:40:07.017

如果您希望测试掩码中的所有位都匹配：

```
if((value & mask) == mask) {...} 
```

如果您希望测试掩码中的任何单个位匹配：

```
if((value & mask) != 0) {...} 
```

当您测试多个事物的值时，差异最为明显。

要测试排除：

```
if ((value & mask) == 0) { } 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-02-09T21:38:25.460

首先 - 使用带有 FlagAttribute 的枚举。这就是它的用途。

```
[Flags]
public enum Time
{
    None = 0
    Current = 1,
    Past = 2,
    Future = 4
    All = 7
} 
```

然后测试是这样完成的：

```
if ( (x & Time.Past) != 0 ) 
```

或这个：

```
if ( (x & Time.Past) == Time.Past ) 
```

如果“过去”是标志的组合并且您想全部测试它们，则后者会更好。

设置是这样的：

```
x |= Time.Past; 
```

取消设置是这样的：

```
x &= ~Time.Past; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2009-02-09T21:45:22.650

您可能还想添加这样的扩展**方法**

```
 enum states {
     Current = 0x1,
     Past = 0x2,
     Future = 0x4,
     All = 0x7
  };

  static bool Is(this states current, states value) {
     return (current & value) == value;
  } 
```

那么你可以这样做：

```
 if(state.Is(states.Past)) {
    // Past
 } 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2018-04-20T14:08:28.283

如果您使用 .NET 4 或更高版本，我更喜欢这样做，更清洁的 imao：

```
[Flags]
public enum Time
{
    None = 0
    Current = 1,
    Past = 2,
    Future = 4
}

myProp = Time.Past | Time.Future;

if (myProp.HasFlag(Time.Past))
{
    // Past is set...
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-09-22T19:15:12.640

Marc Gravell 和 Vilx- 的答案的附录：

您标记的枚举不应指定“全部”的数量，它应该只包含您现有的值。这适用于任何计算值。

```
[Flags]
public enum Time
{
    None = 0,
    Current = 1,
    Past = 2,
    Future = 4,
    All = Current | Past | Future
} 
```

请注意，Vilx- 删除了对值使用十六进制。这很重要，因为一旦您超过 0x8，您的值将必须符合十六进制。你应该只保留十进制。

**编辑：** 我还想补充一点，您可以使用位移而不是十六进制/十进制。

这看起来像：

```
[Flags]
public enum Time
{
    None = 0,
    Current = 1,
    Past = 1 << 1, // 2, 10 binary
    Future = 1 << 2, // 4, 100 binary
 // Example = 1 << 3, // 8, 1000 binary
 // Example = 1 << 4, // 16, 10000 binary
    All = Current | Past | Future
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-09T21:37:30.220

```
if ((flags & PAST) == PAST)
{
  // PAST is there
}

if ((flags & CURRENT) != CURRENT)
{
  // CURRENT is not there
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-09T21:37:50.143

```
(value & Current) == Current 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-08-17T11:23:07.457

我认为缺少的是除一个以外的“全部”

```
[Flags]
public enum Time
{
    None = 0,
    Current = 1,
    Past = 1 << 1, // 2, 10 binary
    Future = 1 << 2, // 4, 100 binary
    All = Current | Past | Future
} 
```

然后使用上面的标志枚举，你可以做

```
var notNow= Time&~Time.Current; 
```

# c# - 如何避免 System.IO.PathTooLongException？

> ID：530109
> 
> 赞同：60
> 
> 时间：2009-02-09T21:38:38.830
> 
> 标签：c#, .net

我们经常遇到这个问题...

例子：

如果我有一个文件要复制到另一个目录或 UNC 共享中，并且路径的长度超过 248（如果我没记错的话），那么它会抛出 PathTooLongException。这个问题有什么解决方法吗？

PS：是否有任何注册表设置可以将此路径设置为更长的字符集？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2016-08-11T07:11:23.693

正如 Jeremy Kuhne 的[博客](https://blogs.msdn.microsoft.com/jeremykuhne/2016/07/30/net-4-6-2-and-long-paths-on-windows-10/)中所述，.NET Framework [4.6.2](https://blogs.msdn.microsoft.com/dotnet/2016/08/02/announcing-net-framework-4-6-2/#bcl)尽可能消除了`MAX_PATH`限制，而不会破坏向后兼容性。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-07-23T04:52:25.897

试试这个：**Delimon.Win32.IO Library (V4.0)** *这个库是在 .NET Framework 4.0 上编写的*

Delimon.Win32.IO 取代了 System.IO 的基本文件功能，并支持多达**32,767**个字符的文件和文件夹名称。

[https://gallery.technet.microsoft.com/DelimonWin32IO-Library-V40-7ff6b16c](https://gallery.technet.microsoft.com/DelimonWin32IO-Library-V40-7ff6b16c)

该库是专门为克服 .NET Framework 使用长路径和文件名的限制而编写的。使用此库，您可以以编程方式浏览、访问、写入、删除等 System.IO 命名空间无法访问的文件和文件夹。库

**用法**

1.  首先在您的项目中添加对 Delimon.Win32.IO.dll 的引用（浏览到 Delimon.Win32.IO.dll 文件）

2.  在您的代码文件中添加“使用 Delimon.Win32.IO”

3.  像使用 System.IO 一样使用普通文件和目录对象

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-10T10:10:38.303

BCL 团队已经对此进行了深入讨论，请参阅[博客条目](http://blogs.msdn.com/bclteam/archive/2007/02/13/long-paths-in-net-part-1-of-3-kim-hamilton.aspx)

本质上，没有办法*在 .Net 代码*中执行此操作并坚持使用 BCL。太多的函数依赖于能够规范化路径名（这会立即触发使用期望遵守 MAX_PATH 的函数）。

您可以包装所有支持 "\\?\" 语法的 win32 函数，使用这些函数您将能够实现一套长路径感知功能，但这会很麻烦。

由于大量工具（包括 explorer[1]）无法处理长路径名，因此不建议沿着这条路线走，除非您很高兴与生成的文件系统的*所有*交互都通过您的库（或数量有限的工具）旨在像 robocopy 一样处理它）

为了满足您的特定需求，我将调查直接使用 robocopy 是否足以执行此任务。

[1] Vista 有办法通过一些花哨的重命名来缓解这个问题，但这充其量是脆弱的）

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-09T21:42:45.637

我在这个上看到的只有一种解决方法......这可能会有所帮助

[http://www.codeproject.com/KB/files/LongFileNames.aspx](http://www.codeproject.com/KB/files/LongFileNames.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-05-07T20:25:06.383

问题在于 Windows API 的 ANSI 版本。需要仔细测试的一种解决方案是强制使用 Unicode 版本的 Windows API。这可以通过`\\?\`在被查询的路径前加上“”来完成。

可以在 Microsoft 的基类库 (BCL) 团队的标题为“.NET 中的长路径”的以下博客文章中找到重要信息，包括解决方法：

*   [http://blogs.msdn.com/b/bclteam/archive/2007/02/13/long-paths-in-net-part-1-of-3-kim-hamilton.aspx](http://blogs.msdn.com/b/bclteam/archive/2007/02/13/long-paths-in-net-part-1-of-3-kim-hamilton.aspx)
*   [http://blogs.msdn.com/bclteam/archive/2007/03/26/long-paths-in-net-part-2-of-3-long-path-workarounds-kim-hamilton.aspx](http://blogs.msdn.com/bclteam/archive/2007/03/26/long-paths-in-net-part-2-of-3-long-path-workarounds-kim-hamilton.aspx)
*   [http://blogs.msdn.com/b/bclteam/archive/2008/07/07/long-paths-in-net-part-3-of-3-redux-kim-hamilton.aspx](http://blogs.msdn.com/b/bclteam/archive/2008/07/07/long-paths-in-net-part-3-of-3-redux-kim-hamilton.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-05-15T18:00:32.380

我使用“subst”命令来解决这个问题...... [http://www.techrepublic.com/article/mapping-drive-letters-to-local-folders-in-windows-xp/5975262](http://www.techrepublic.com/article/mapping-drive-letters-to-local-folders-in-windows-xp/5975262)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-01-12T16:39:59.007

我的 Drive-Mapping 解决方案使用下面列出的“NetWorkDrive.cs”和“NetWorkUNCPath.cs”工作正常且稳定。

测试示例：

```
if (srcFileName.Length > 260)
{
   string directoryName = srcFileName.Substring(0, srcFileName.LastIndexOf('\\'));

   var uncName = GetUNCPath(srcFileName.Substring(0, 2)) + directoryName.Substring(2);

   using (NetWorkDrive nDrive = new NetWorkDrive(uncName))
   {
     drvFileName = nDrive.FullDriveLetter + Path.GetFileName(sourceFileName)
     File.Copy(drvFileName, destinationFileName, true);
   }
}
else
{
   File.Copy(srcFileName, destinationFileName, true);
} 
```

**NetWorkDrive.cs**源代码：

```
using System;
using System.Collections.Generic;
using System.Runtime.InteropServices;
using System.ComponentModel;
namespace SeekCopySupportTool.Business
{

public class NetWorkDrive : IDisposable
{
    #region private fields
    private string m_DriveLetter = string.Empty;
    private string m_FullDriveLetter = string.Empty;
    private bool m_Disposed = false;
    //this list specifies the drive-letters, whitch will be used to map networkfolders
    private string[] possibleDriveLetters = new string[] 
    { 
        "G:\\", 
        "H:\\", 
        "I:\\", 
        "J:\\", 
        "K:\\", 
        "L:\\", 
        "M:\\", 
        "N:\\", 
        "O:\\", 
        "P:\\", 
        "Q:\\", 
        "R:\\", 
        "S:\\", 
        "T:\\", 
        "U:\\", 
        "V:\\", 
        "W:\\", 
        "X:\\", 
        "Y:\\", 
        "Z:\\" 
    };
    #endregion

    #region public properties
    public string DriveLetter
    {
        get { return m_DriveLetter; }
        set { m_DriveLetter = value; }
    }
    public string FullDriveLetter
    {
        get { return m_FullDriveLetter; }
        set { m_FullDriveLetter = value; }
    }
    #endregion

    #region .ctor
    public NetWorkDrive(string folderPath)
    {
        m_FullDriveLetter = MapFolderAsNetworkDrive(folderPath);
        if (string.IsNullOrEmpty(m_FullDriveLetter))
        {
            throw new Exception("no free valid drive-letter found");
        }
        m_DriveLetter = m_FullDriveLetter.Substring(0,2);
    }
    #endregion

    #region private methods
    /// maps a given folder to a free drive-letter (f:\)
    /// <param name="folderPath">the folder to map</param>
    /// <returns>the drive letter in this format: "(letter):\" -> "f:\"</returns>
    /// <exception cref="Win32Exception">if the connect returns an error</exception>
    private string MapFolderAsNetworkDrive(string folderPath)
    {
        string result = GetFreeDriveLetter();
        NETRESOURCE myNetResource = new NETRESOURCE();
        myNetResource.dwScope = ResourceScope.RESOURCE_GLOBALNET;
        myNetResource.dwType = ResourceType.RESOURCETYPE_ANY;
        myNetResource.dwDisplayType = ResourceDisplayType.RESOURCEDISPLAYTYPE_SERVER;
        myNetResource.dwUsage = ResourceUsage.RESOURCEUSAGE_CONNECTABLE;
        myNetResource.lpLocalName = result.Substring(0,2);
        myNetResource.lpRemoteName = folderPath;
        myNetResource.lpProvider = null;
        int errorcode = WNetAddConnection2(myNetResource, null, null, 0);
        if(errorcode != 0)
        {
            throw new Win32Exception(errorcode);
        }
        return result;
    }
    private void DisconnectNetworkDrive()
    {
        int CONNECT_UPDATE_PROFILE = 0x1;
        int errorcode = WNetCancelConnection2(m_DriveLetter, CONNECT_UPDATE_PROFILE, true);
        if (errorcode != 0)
        {
            throw new Win32Exception(errorcode);
        }
    }

    private string GetFreeDriveLetter()
    {
        //first get the existing driveletters
        const int size = 512;
        char[] buffer = new char[size];
        uint code = GetLogicalDriveStrings(size, buffer);
        if (code == 0)
        {                
            return "";
        }
        List<string> list = new List<string>();
        int start = 0;
        for (int i = 0; i < code; ++i)
        {
            if (buffer[i] == 0)
            {
                string s = new string(buffer, start, i - start);
                list.Add(s);
                start = i + 1;
            }
        }            
        foreach (string s in possibleDriveLetters)
        {                
            if (!list.Contains(s))
            {
                return s;
            }
        }
        return null;
    }        
    #endregion

    #region dll imports
    /// <summary>
    /// to connect to a networksource
    /// </summary>
    /// <param name="netResource"></param>
    /// <param name="password">null the function uses the current default password associated with the user specified by the username parameter ("" the function does not use a password)</param>
    /// <param name="username">null the function uses the default user name (The user context for the process provides the default user name)</param>
    /// <param name="flags"></param>
    /// <returns></returns>
    [DllImport("mpr.dll")]
    //public static extern int WNetAddConnection2(ref NETRESOURCE netResource, string password, string username, int flags);
    private static extern int WNetAddConnection2([In] NETRESOURCE netResource, string password, string username, int flags);
    /// <summary>
    /// to disconnect the networksource
    /// </summary>
    /// <param name="lpName"></param>
    /// <param name="dwFlags"></param>
    /// <param name="bForce"></param>
    /// <returns></returns>
    [DllImport("mpr.dll")]
    private static extern int WNetCancelConnection2(string lpName, Int32 dwFlags, bool bForce);
    /// <param name="nBufferLength"></param>
    /// <param name="lpBuffer"></param>
    /// <returns></returns>
    [DllImport("kernel32.dll")]
    private static extern uint GetLogicalDriveStrings(uint nBufferLength, [Out] char[] lpBuffer);
    #endregion

    #region enums/structs
    /// <example>
    /// NETRESOURCE myNetResource = new NETRESOURCE();
    /// myNetResource.dwScope = 2;
    /// myNetResource.dwType = 1;
    /// myNetResource.dwDisplayType = 3;
    /// myNetResource.dwUsage = 1;
    /// myNetResource.LocalName = "z:";
    /// myNetResource.RemoteName = @"\servername\sharename";
    /// myNetResource.Provider = null;
    /// </example>
    [StructLayout(LayoutKind.Sequential)]
    public class NETRESOURCE
    {
        public ResourceScope dwScope = 0;
        public ResourceType dwType = 0;
        public ResourceDisplayType dwDisplayType = 0;
        public ResourceUsage dwUsage = 0;
        public string lpLocalName = null;
        public string lpRemoteName = null;
        public string lpComment = null;
        public string lpProvider = null;
    };
    public enum ResourceScope : int
    {
        RESOURCE_CONNECTED = 1,
        RESOURCE_GLOBALNET,
        RESOURCE_REMEMBERED,
        RESOURCE_RECENT,
        RESOURCE_CONTEXT
    };
    public enum ResourceType : int
    {
        RESOURCETYPE_ANY,
        RESOURCETYPE_DISK,
        RESOURCETYPE_PRINT,
        RESOURCETYPE_RESERVED
    };
    public enum ResourceUsage
    {
        RESOURCEUSAGE_CONNECTABLE = 0x00000001,
        RESOURCEUSAGE_CONTAINER = 0x00000002,
        RESOURCEUSAGE_NOLOCALDEVICE = 0x00000004,
        RESOURCEUSAGE_SIBLING = 0x00000008,
        RESOURCEUSAGE_ATTACHED = 0x00000010,
        RESOURCEUSAGE_ALL = (RESOURCEUSAGE_CONNECTABLE | RESOURCEUSAGE_CONTAINER | RESOURCEUSAGE_ATTACHED),
    };
    public enum ResourceDisplayType
    {
        RESOURCEDISPLAYTYPE_GENERIC,
        RESOURCEDISPLAYTYPE_DOMAIN,
        RESOURCEDISPLAYTYPE_SERVER,
        RESOURCEDISPLAYTYPE_SHARE,
        RESOURCEDISPLAYTYPE_FILE,
        RESOURCEDISPLAYTYPE_GROUP,
        RESOURCEDISPLAYTYPE_NETWORK,
        RESOURCEDISPLAYTYPE_ROOT,
        RESOURCEDISPLAYTYPE_SHAREADMIN,
        RESOURCEDISPLAYTYPE_DIRECTORY,
        RESOURCEDISPLAYTYPE_TREE,
        RESOURCEDISPLAYTYPE_NDSCONTAINER
    };
    #endregion

    #region IDisposable Members
    public void Dispose()
    {
        Dispose(true);
    }
    #endregion

    #region overrides/virtuals
    public override string ToString()
    {
        return m_FullDriveLetter;
    }
    /// <param name="disposing"></param>
    protected virtual void Dispose(bool disposing)
    {
        if (!m_Disposed)
        {
            if (disposing)
            {
                DisconnectNetworkDrive();
            }
            m_Disposed = true;
        }
    }
    #endregion
}

} 
```

**NetWorkUNCPath.cs**源代码：

```
using System;
using System.Management;
namespace SeekCopySupportTool.Business
{

public class NetWorkUNCPath
{
    // get UNC path
    public static string GetUNCPath(string path)
    {
        if (path.StartsWith(@"\\"))
        {
            return path;
        }

        ManagementObject mo = new ManagementObject();
        mo.Path = new ManagementPath(String.Format("Win32_LogicalDisk='{0}'", path));

        // DriveType 4 = Network Drive
        if (Convert.ToUInt32(mo["DriveType"]) == 4)
        {
            return Convert.ToString(mo["ProviderName"]);
        }
        // DriveType 3 = Local Drive
        else if (Convert.ToUInt32(mo["DriveType"]) == 3)
        {
            return "\\\\" + Environment.MachineName + "\\" + path.Substring(0,1) + "$";
        }
        else
        {
            return path;
        }
    }
}

} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-06-25T11:10:31.000

这个库可能会有所帮助： [Zeta Long Paths](https://zetalongpaths.codeplex.com/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-09T05:10:32.643

在 C# 中，对我来说这是一种解决方法：

```
/*make long path short by setting it to like cd*/
string path = @"\\godDamnLong\Path\";
Directory.SetCurrentDirectory(path); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-18T19:24:59.983

我惊讶地发现 Jason 的解决方案在我使用 Visual Studio 2019 和 .Net Framework 4.7.2 的 PC 上运行良好

最初，我编写了类似于此代码的内容

```
Dim sBaseDir = "D:\Documents\+Informatique\Application\@Visual Basic.NET\GetTestAchatsPosts\Site\communication-multimedia\ordinateurs"
Dim sLastDir = "2638.pc-acer-ne-charge-plus-malgre-un-retour-en-garantie-reviens-charge-mais-ne-charge-toujours-pas-garantie-passee-plus-dintervention-gra"

System.IO.Directory.CreateDirectory(sBaseDir & "\" & sLastDir) 
```

此代码生成错误 429-PathTooLongException

* * *

然后我测试了只创建最后一个目录

```
System.IO.Directory.SetCurrentDirectory(sBaseDir)
System.IO.Directory.CreateDirectory(sLastDir) 
```

此代码返回相同的错误 429-PathTooLongException

* * *

然后我使用一个短的基本目录进行了测试，看看问题是否与最后一个目录的长度或完整目录有关

```
System.IO.Directory.SetCurrentDirectory("D:\Documents")
System.IO.Directory.CreateDirectory(sLastDir) 
```

此代码有效。但是目录是在错误的位置创建的。

* * *

然后我测试了减少名称的最后一个目录的长度。

```
System.IO.Directory.SetCurrentDirectory(sBaseDir)
System.IO.Directory.CreateDirectory(sLastDir.Substring(0, 100)) 
```

此代码有效，但最后一个目录名称减少了！

* * *

然后，我分两步使用 Jason 的提议进行了测试

```
System.IO.Directory.SetCurrentDirectory(sBaseDir)
System.IO.Directory.CreateDirectory("\\?\" & sLastDir) 
```

此代码崩溃表明目录语法不正确！

* * *

然后，我还测试了添加“。”的相同语法。细绳

```
System.IO.Directory.SetCurrentDirectory(sBaseDir)
System.IO.Directory.CreateDirectory("\\?\.\" & sLastDir) 
```

此代码崩溃表明目录语法不正确！

* * *

然后，我使用一个简单的命令进行了测试，该命令以完整目录为前缀`"\\?"`

```
System.IO.Directory.CreateDirectory("\\?\" & sBaseDir & "\" & sLastDir) 
```

**这段代码完美运行，对我来说是最好的解决方案。**

唯一的不便是该目录必须是一个完整的目录。

**警告 ！**你不能不混合“\”和“/”字符！

我写了以下代码

```
sQuestionDir = "\\?\" & sArticleDir & "/" & sQuestionDir
If Not System.IO.Directory.Exists(sQuestionDir) Then
    System.IO.Directory.CreateDirectory(sQuestionDir)
End If 
```

执行时程序崩溃`CreateDirectory() function !`

正确的代码是

```
sQuestionDir = "\\?\" & sArticleDir & "/" & sQuestionDir
If Not System.IO.Directory.Exists(sQuestionDir) Then
    System.IO.Directory.CreateDirectory(sQuestionDir)
End If 
```

我希望所有这些测试都可以帮助其他人解决他们的问题。

# python - 打印方法题Python

> ID：530114
> 
> 赞同：0
> 
> 时间：2009-02-09T21:39:49.980
> 
> 标签：python, string

在 python 中，第二个 % 表示什么？

```
print "%s" % ( i ) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T22:03:00.753

正如其他人所说，这是 Python 字符串格式化/插值运算符。它基本上相当于 C 中的 sprintf，例如：

`a = "%d bottles of %s on the wall" % (10, "beer")`

相当于类似

`a = sprintf("%d bottles of %s on the wall", 10, "beer");`

在 C 中。这些中的每一个都有`a`被设置为的结果`"10 bottles of beer on the wall"`

但是请注意，此语法在 Python 3.0 中已弃用；它的替换看起来像

`a = "{0} bottles of {1} on the wall".format(10, "beer")`

这是可行的，因为 Python 会自动将任何字符串文字转换为 str 对象。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T21:42:25.730

第二个 % 是字符串插值运算符。

[链接到文档](http://docs.python.org/library/stdtypes.html#string-formatting-operations)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T21:41:29.663

这是一个[格式说明符](http://docs.python.org/library/stdtypes.html#string-formatting)

简单用法：

```
# Prints: 0 1 2 3 4 5 6 7 8 9
for i in range(10):
    print "%d" % i, 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T21:44:08.207

```
print "%d%s" % (100, "trillion dollars") # outputs: 100 trillion dollars 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T21:45:40.403

如果您要将代码翻译成英文，它会说：获取***字符串*i**并将其格式化为谓词字符串。

另一个例子：

```
name = "world"
print "hello, %s" % (name) 
```

[有关格式说明符的更多信息。](http://docs.python.org/library/stdtypes.html#string-formatting)

# c - 在 Linux 中使用 stdio 读取和排序管道数据

> ID：530116
> 
> 赞同：3
> 
> 时间：2009-02-09T21:39:57.283
> 
> 标签：c

正如标题所说，我需要编写一个小程序来从标准输入中读取数据，对其进行排序，然后将其发送到标准输出。程序应该采用 1 个参数来告诉它一条记录有多长（以字节为单位）。这是我测试它的方法：

```
printf 'D\x00C\x00\x00B\x00A' | ./binsort 2 | od -c 
```

以上应输出如下内容：

```
0000000  \0   A  \0   B   C  \0   D  \0
0000010 
```

这是我到目前为止所拥有的（`binsort.c`）：

```
#include <stdio.h>
#include <stdlib.h>
#include <limits.h>

using namespace std;

void print_usage()
{
        printf("%s\n", "Usage: ");
}

int compare (const void * a, const void * b) // the compare function for qsort... might need some work
{
  return ( *(int*)a - *(int*)b );
}

int main(int argc, char *argv[])
{
        if (argc != 2 || stdin == NULL) // check for argument and piped input
        {
                print_usage();
                exit(EXIT_FAILURE);
        }

        int entry_size = atoi(argv[1]);

        if (entry_size <= 0 || entry_size >= INT_MAX) // check for valid range of entry size
        {
                print_usage();
                exit(EXIT_FAILURE);
        }

        char *input = new char[entry_size]; // to hold single record

        while (fgets(input, entry_size, stdin) != NULL)
        {
                printf("%s", input); // output single record we just read
        }

        exit(EXIT_SUCCESS);
} 
```

然后用`g++ binsort.c -o binsort`.

以上编译但不输出`printf`发送给它的数据。它应该以 2 字节的块输出它......就像`D\0 C\0 \0B \0A`......但它没有。

我正在考虑使用`qsort`对分配的`malloc/realloc`数组进行排序。然而，我从来没有使用过这些，实际上我在这个小工具上敲了几天。任何人都可以帮忙吗？

*PS 人们问这是否是家庭作业...不是-我公司的开发人员希望使用它来调试他们项目的输出。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T22:08:11.783

不要使用`scanf()`和`printf()`。这些应该与文本数据一起使用。由于您正在处理二进制数据，因此您希望使用较低级别的`fread()`和`fwrite()`函数。由于您不知道有多少总数据，因此您必须使用动态数据结构（例如可调整大小的数组）来存储输入。你不能在线处理数据——你必须全部读入，排序，然后写回。您的排序功能也是错误的——您只比较每条记录的前 4 个字节，如果记录大小不是 4 个字节，这是错误的。改为使用`memcmp()`。

这应该有效：

```
char *input = NULL;
size_t input_size = 0;
int num_items = 0;
int entry_size;

int compare_func(const void *e1, const void *e2)
{
  return memcmp(e1, e2, entry_size);
}

int main(int argc, char **argv)
{
   // ...
  char *datum = malloc(entry_size);  // check for NULL
  input_size = 4096;
  input = malloc(input_size);  // check for NULL

  while(1)
  {
    if(fread(datum, 1, entry_size, stdin) < entry_size)
      break;
    size_t new_size = (num_items + 1) * entry_size;
    if(new_size > input_size)
    {
      input = realloc(input, input_size * 2);  // check for NULL
      input_size *= 2;
    }
    memcpy(input + num_items * entry_size, datum, entry_size);
    num_items++;
  }

  qsort(input, num_items, entry_size, compare_func);

  fwrite(input, entry_size, num_items, stdout);

  return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T22:33:57.510

***PS 人们问这是否是家庭作业...不是-我公司的开发人员希望使用它来调试他们项目的输出。***

如果不是家庭作业，而且这是在 Linux 下，为什么不使用包含的**“排序”**程序？

例如：

```
% printf 'D\x00C\x00\x00B\x00A' | sort -z | od -c
0000000  \0   A  \0   B  \0   C  \0   D  \0
0000011 
```

FSF/GNU 排序提供 -z 选项：

```
-z, --zero-terminated
        end lines with 0 byte, not newline 
```

* * *

* * *

## 修改为：

好的，看看你仍然想要你自己的代码......

看看其他人如何发布基于 STL 的方法。

注意使用 struct FUNCTOR 进行比较（通过 stl::sort()）。而且，如果你愿意，你总是可以使用 ostream_iterator<string>(cout, "\n") 来让事情变得更易读。

```
#include <iostream>
#include <fstream>
#include <iomanip>
#include <string>
#include <vector>
#include <algorithm>
#include <iterator>

using namespace std;

   /* ifstream won't set EOF-state until we try to read past the end-of-file.*/
   /* (Makes for lots of grief trying to read in files...)                   */
inline bool
IsStreamStillGood( istream & theStream )
{
  return theStream && (theStream . peek() != EOF);
}

template<class TYPE> inline void DELETE( TYPE * x)
{
  delete x;
  x = (TYPE *) NULL;
}

struct FUNCTOR
{
  bool operator()(const string & x, const string & y) { return x < y; }
};

int
main(int argc, char **argv)
{
  istream *       stream;
  vector<string>  v;

  UASSERT( argc, >, 1 );

  const int recordSize = atoi( argv[1] );
  char      buffer [ recordSize + 1 ];

  UASSERT( recordSize, >, 0 );

  if ( argc > 2 )
    stream = new ifstream( argv[2] );
  else
    stream = & cin;

  while ( IsStreamStillGood( * stream ) )
  {
    stream-> read( buffer, recordSize );
    v.push_back( string( buffer, stream->gcount() ) );
  }

  UASSERT( v.back().size(), ==, size_t(recordSize) );

  FUNCTOR functor;
  sort( v.begin(), v.end(), functor );

  copy( v.begin(), v.end(), ostream_iterator<string>(cout) );

  if ( argc > 2 )
    DELETE(stream);
} 
```

* * *

* * *

## 修改（再次）添加：

> ***关于在您的 STL 方法中使用字符串的问题：由于输入中可能存在空字符 ('\0')，字符串不会因此而混淆吗？有人建议使用 char[] 但我怀疑会出现同样的问题***

如果我有 **char c[10];** ，我可以说**c[0] = '\0';** . **c[1]**或**c[9]**相同。我可以在该数组中包含任意数量的空字符。（当然，取决于数组的大小。）

现在，当使用**c**作为 c 字符串时，问题是它有多长。它是 1 个字符长还是 9 个字符？通常，在 C 中，这取决于第一个 NULL 字符出现的位置。

所以像*printf(%s)*、*scanf(%s)*、*strncat()*、*strncpy()*、*strncmp()*等东西对嵌入在我们的二进制数据数组中的 NULL ('\0') 字符并不满意。

但是 C++ *std::string*独立地跟踪长度。至少看起来是这样，并且它允许这样的事情： **myString.append( 10, '\0' );**

因此，通过使用**stream->read(buffer,recordSize)**我们读取了一组字符（字节）。我们并不关心它们是否为空值 ('\0')。都很好。只要给我recordSize字节数。

通过使用**v.push_back(string(buffer, stream->gcount()))**创建，我们推回一个包含**stream->gcount()**字符（字节）的新字符串。同样，我们不在乎它们是否为空值 ('\0')。我们只需要所有**的 stream->gcount()**字节。

Sort 使用 functor，它使用 operator<(const string &, const string &)，它使用 string::compare()，它再次使用字符串的长度，而不关心字符串中实际包含的数据。Nulls ('\0') 很好。

现在，如果我们尝试使用 v.back().c_str()，那么我们没有长度，所以空值会让我们感到困惑。但只要我们使用包含数据和长度的字符串对象 (egvback())，我们就可以了。

这给我们带来了输出。我们再次输出字符串，而不是 myString.c_str()，所以字符串中的所有字符都被打印出来。包括空值 ('\0')。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T21:50:10.753

fgets 和 fprintf 处理字符串（在 C 中是以特殊字符 \0 结尾的字符数组）。

对二进制数据使用 fread 和 fwrite。qsort 很好，除了您的比较函数需要逐字节比较 entry_size 字节，而不仅仅是从 void 转换为 int，这是不安全的并且可能不正确。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-09T21:51:05.493

有几点可能会有所帮助（我假设这是家庭作业，因此具有教学结构）：

*   在积累数据时，您需要将数据粘贴到某个地方。而且由于您不知道会发生多少，因此动态分配将是必要的。这里有很多选择：动态数组、链表、哈希表等*令人作呕*......选择一个适合你的（见下文）。

*   一旦你得到它，你将需要对其进行排序。*或者*，您可以首先将其排序存储。您是否碰巧知道可以管理它的数据结构？

*   排序后，您只需将其吐出另一端即可。

容易，不是吗？

* * *

恰如其分的评论：

*   你有K&R吗？`c`或者在or上的一些其他基本文本`c++`？你会想要一个。你想选择一种或另一种语言并坚持下去。如果您习惯于在另一个上下文中进行 OO 编程，请使用`c++`. 如果您也不知道，请使用`c++`.

*   如果您使用的是 c++，STL 容器将为您处理动态存储。最简单的方法是使用 a `std::vector<char[2]>`（使用命令行参数中的大小），并对其`<algorithm>`进行排序。

*   其他人指出你需要做二进制IO。这很重要，因为您的输入和输出都不像文本 IO 那样结构化。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-09T21:56:31.267

`printf`在您的流中解释`\0`为终止字符。

使用`read()`and`write()`代替：

```
 int res;
    int count;
    while (1) {
            count = 0;
            while(count < entry_size) {
                    res = read(STDIN_FILENO, input + count, entry_size - count);
                    if (res <= 0)
                            exit(errno);
                    count += res;
            }
            count = 0;
            while(res) {
                    res = write(STDOUT_FILENO, input + count, entry_size - count);
                    if (res < 0)
                            exit(errno);
                    count += res;
            }
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-09T22:46:58.993

感谢大家的好建议！只是为了记录，这里已经完成`binsort.c`，可以满足预期。

```
#include <stdio.h>
#include <stdlib.h>
#include <cstring>
#include <limits.h>

using namespace std;

int num_items = 0;
size_t input_size = 0;
int entry_size = 0;

void print_usage()
{
        printf("%s\n", "Usage: <binary data> | ./binsort [RECORD_LENGTH]");
        printf("%s\n", "For example: printf 'D\\x00C\\x00\\x00B\\x00A' | ./binsort 2 | od -c");
}

int compare (const void * a, const void * b)
{
        return memcmp(a, b, entry_size);
}

int main(int argc, char *argv[])
{
        if (argc != 2 || stdin == NULL)
        {
                print_usage();
                exit(EXIT_FAILURE);
        }

        entry_size = atoi(argv[1]);

        if (entry_size <= 0 || entry_size >= INT_MAX)
        {
                print_usage();
                exit(EXIT_FAILURE);
        }

        char *input = NULL;
        char *datum = (char*) malloc(entry_size);
        if (datum == NULL)
                exit(EXIT_FAILURE);

        while(1)
        {
                int read_size = fread(datum, 1, entry_size, stdin);

                if (read_size == 0)
                        break;

                if(read_size < entry_size)
                {
                        while(read_size < entry_size)
                        {
                                memcpy(datum, '\0', 1);
                                read_size++;
                        }
                        break;
                }

                size_t new_size = (num_items + 1) * entry_size;
                if(new_size > input_size)
                {
                        input = (char*) realloc(input, new_size);
                        if (input == NULL)
                                exit(EXIT_FAILURE);
                        input_size = new_size;
                }
                memcpy(input + num_items * entry_size, datum, entry_size);
                num_items++;
        }

        qsort(input, num_items, entry_size, compare);

        fwrite(input, entry_size, num_items, stdout);

        exit(EXIT_SUCCESS);
} 
```

# mysql - 在 Ruby on Rails 应用程序中使用 MySQL 视图来提高性能

> ID：530119
> 
> 赞同：10
> 
> 时间：2009-02-09T21:40:08.373
> 
> 标签：mysql, ruby-on-rails, ruby, performance

我在 rails 项目（在 rails 2.0.5 上运行）中遇到了一些性能问题，例如在我的用户管理页面中。

我的用户模型有许多关系（详细信息、地址、角色......），它们会被急切加载。这会创建非常庞大的 SQL 查询，在某些情况下，加载 30 个用户几乎需要一分钟。另一方面，去除急切加载会产生数百个查询，最后我遇到了同样的问题：加载页面很慢。

我曾经在 Java 和 Oracle 上进行开发，对于我用来创建视图的这种大查询，这些视图然后被缓存以加快渲染速度。维护起来非常无聊，因为我必须在视图脚本等中手动更新数据库字段......

但它确实有出色的表现....所以我想知道是否有人试图实施一些东西来利用活动记录中的 Mysql 视图？

我只是做了一些基本的测试，这是我的观点（示例中只有几个字段，我有一个标准的 Restful Authentication 用户表，以及一个用于个人数据的大表“详细信息”）：

```
CREATE VIEW users_vs AS SELECT
users.id              ,          
users.login           ,          
users.email           ,          
details.last_name           ,
details.first_name          ,
details.phone               ,
details.fax                 ,
FROM `users`   LEFT OUTER JOIN `details` ON details.user_id = users.id ; 
```

然后是一个模型：

```
class UsersV < ActiveRecord::Base
end 
```

在我的控制台中尝试了一些事情：

```
u=UsersV.find(:first)  # ok !
u=UsersV.find_by_last_name('smith') #=> ok !
us=UsersV.find_all_by_last_name('smith') #=> ok too ! 
```

查看日志，简单查询的处理方式与任何表查询相同

当然，那些假模型只会用于读取数据。

我在想：

*   如果有人已经尝试过了？

*   如果这是个好主意？

*   如果我应该研究类似 memcached 的东西......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-16T19:13:00.613

视图的“问题”（在这种情况下，您可能需要一个物化视图，假设复杂查询所基于的数据不经常更改）是您在某种程度上违反了 Rails 的 DRY'ness（为视图添加 UserV 模型，纯粹主义者会认为这是对 User 模型的复制。）

因此，理想的解决方案是充分利用 RDBMS 进行复杂查询。如果未缓存的查询仍然需要很长时间才能执行（您仍然必须运行它们以填充 memcached），或者如果您无法容纳一点时间捏造（即缓存的结果），则 Memcached 将无法为您提供帮助t 必须是实时精确的）和/或所涉及的表经常被修改。

*   在 MySQL 中，看看您是否可以进一步优化查询，以便花费毫秒而不是秒（**添加适当的索引，运行 ANALYZE**等）
*   如果您可以选择使用/尝试其他 RDBMS，例如 Postgres，请务必尝试一下。 与 Oracle 和 Postgres 等其他基于成本的引擎相比，**MySQL 在复杂连接 (InnoDB) 方面的表现非常糟糕。**我从 MySQL 切换到 Postgres，在 MySQL 上需要 30 秒以上的复杂连接（所有索引都到位）在 Postgres 上需要几毫秒。如果玩 Postgres，请充分利用 PGAdminIII 的图形解释计划工具。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T22:07:14.533

我经常在 Rails 中使用表格视图，对此我很满意。Rails 将它们视为普通表，因为您只使用它们来读取记录（这是我的常用场景）。只要你的视图只包含一个表，你甚至可以用它来做所有其他的 CRUD 事情。所以，我的答案是：去做吧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-10T04:29:36.610

[http://github.com/aeden/rails_sql_views/tree/master](http://github.com/aeden/rails_sql_views/tree/master)

↑ 在迁移中创建视图。我也只会在极端情况下使用它们，因为它们会将逻辑隐藏在您的应用程序之外，这通常并不好。

如果您有这么多相关数据，您可以考虑使用 DataMapper 之类的东西，而不是使用 Rails 的 ActiveRecord，因为它支持按需延迟加载数据。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T14:37:47.140

确保启用了缓存结果集的[MySQL 查询缓存。](http://dev.mysql.com/doc/refman/5.1/en/query-cache.html)我遇到过几种情况，其中许多没有连接的查询与很少有连接的查询相比实际上更快，即使您对服务器进行了更多的访问。

# asp.net - 如何摆脱 .aspx 页面中的“默认”表单元素？

> ID：530120
> 
> 赞同：2
> 
> 时间：2009-02-09T21:40:14.520
> 
> 标签：asp.net, webforms

作为我的网络标准极客，我不喜欢`<form runat="server">`围绕我的整个网页的默认设置。我见过很多没有这些的基于 ASP.NET 的网页，所以看起来它可以在不带走任何功能的情况下被删除。如何？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T21:44:16.960

`<form runat="server">`如果您想使用控件'n 东西，就必须有一个。否则回发是不可能的，就像视图状态和 .NET 所依赖的其他东西一样。

你确定你看到了你以为你看到的吗？也许这些页面只包含静态内容？或者它们是用户控件？或者还有另一种常见的可能性——也许是母版页有`<form runat="server">`?

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T21:57:42.653

正如其中一位评论者所提到的，在没有`<form runat="server">`标签的情况下，您很可能正在查看使用 ASP.NET MVC 构建的站点。ASP.NET MVC 不使用服务器控件、Viewstate 或服务器端表单提供的其他功能，而是使用更接近 HTML 的模型和相对简单的内联脚本。

从好的方面来说，您更接近纯 HTML（实际上，您本质上是纯 HTML），因此执行 Javascript 操作、集成自定义 UI 小部件等更容易。

在（潜在的）不利方面，如果您对 ASP.NET WebForms 控件和技术进行了大量投资，那么这些通常与新的 MVC 框架不兼容。此外，还有与之相关的学习曲线。（我现在才刚开始。）

有关 ASP.NET MVC 的更多信息，请参阅[官方网站](http://www.asp.net/mvc/)。正如其他人所提到的，SO 是建立在这项技术之上的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T21:42:56.620

表单元素对于 ASP.NET 正常工作**至关重要。**有必要将用户输入发布回网络服务器。

我建议您查看[ASP.NET 视图](http://msdn.microsoft.com/en-us/library/ms972976.aspx)状态以了解其工作原理。

您可以删除该元素的唯一情况是在 .aspx 文件中使用纯静态 HTML。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T22:26:07.873

如果您不需要利用 Web 控件、视图状态等，您可以使用标准 HTML 表单对 ASP.NET 页面进行编码，并且仍然获取通过 Request 对象传回的值。同样，您可以通过 Response 对象（显式或使用格式）写入页面，`<%= MyVar %>`因此没有什么可以阻止您拥有一个没有`<form runat="server">`. 从本质上讲，在与页面/表单的交互方面，您获得了与经典 ASP 类似的东西，但是您在后端拥有完整的 .NET 框架和所有通常好的 C#/VB.NET 东西。

显然，这是否是一种明智的方法存在一个问题，因为您失去了 ASP.NET 的许多好处（尽管您获得了对 Web 控件所没有的输出的一定程度的控制）。如果您不想使用`<form runat="server">`，那么 MVC 似乎是最好的选择。我们没有使用 Web 表单模型的唯一原因`<form runat="server">`是迁移经典 ASP 应用程序，我们希望快速移植到 ASP.NET，然后将代码修改为更自然的 .NET 样式。

因此，有一些限制，这是完全可能的，但不一定推荐。

而且，当然，它根本不会影响对 Web 标准的遵从性，因为`runat="server"`在 HTML 发送到浏览器之前该属性已被剥离 - 它仅出现在源代码中。

# latex - 如何将 LaTeX 转换为纯文本 (ASCII)？

> ID：530121
> 
> 赞同：71
> 
> 时间：2009-02-09T21:40:25.703
> 
> 标签：latex, ascii

*场景：*
我有一个使用 LaTeX 创建的文档（在这种情况下是我的简历），它正在`pdflatex`正确编译并准确输出我想要的内容。现在我需要将相同的文档转换为普通的旧 ASCII。

*示例：我在* [这里](http://www.gratisoft.us/todd/resume.html)
看到过这种情况（至少一次），作者有一个[PDF 版本](http://www.gratisoft.us/todd/resume.pdf)和一个[ASCII 版本](http://www.gratisoft.us/todd/resume.ascii)，几乎在所有方面都与 PDF 版本匹配，包括边距、间距和项目符号。

我意识到由于 ASCII 格式的限制，这种类型的转换不可能是精确的，但根据我目前发现的情况，一个非常接近的近似值似乎是可能的。这样做的过程是什么？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-01-14T14:25:40.707

[Opendetex](https://github.com/pkubowicz/opendetex)可用于 Windows 和 Linux（在 Mac 上也可以正常编译）。可以从[https://github.com/pkubowicz/opendetex下载](https://github.com/pkubowicz/opendetex)

用法：

> `detex project`
> 
> 打开 project.tex，读取使用 \include 或 \includeonly 命令包含的所有文件，将结果文本输出到标准输出。
> 
> `detex -n project > out.txt`
> 
> 打开 project.tex，不遵循 \include 或 \includeonly 命令，将结果文本输出到 out.txt
> 
> `detex --help`
> 
> 显示完整的帮助

将其解压缩到您选择的任何目录。假设您将其解压缩到您的下载目录。

在其中创建另一个任意名称的目录（这是可选的，但建议使用）。假设目录名称是“my_paper”。将您的论文放在“my_paper”目录中。假设您的论文名称是 project.tex。

导航到路径

```
 cd ~/Downloads/opendetex 
```

运行命令

```
 detex my_paper/project.tex  > out.txt 
```

通用形式

```
 detex -n full_path_to_tex_file.tex > output_text_file.txt 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-02-09T21:45:18.440

[CatDVI](http://catdvi.sourceforge.net/)可以将 DVI 转换为文本并尝试保留格式。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-09T21:45:57.627

您可以尝试这里提出的一些程序：

[TeX 转 ASCII](http://www.tex.ac.uk/FAQ-toascii.html)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-04-27T01:22:04.663

您也可以尝试[Pandoc](http://pandoc.org/demos.html)，它可以将乳胶转换为许多其他格式。我建议阅读它的文档，因为可能有一些棘手的情况需要传递一些参数来处理。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-03-09T13:41:48.490

## pdftotext 可以保留布局

如果您正在使用`pdflatex`，您可能不想弄乱您的包选项以切换`latex`到生成 DVI。

相反，请获取您的 pdf 文件并进行转换。这适用于我使用 Curve 包制作的简历/简历：

```
pdftotext  -layout MyResume.pdf 
```

注意`-layout`标志。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-09T23:44:47.670

另一种选择是使用[htlatex](http://www.cse.ohio-state.edu/~gurari/TeX4ht/)从 LaTeX 源创建网页，然后使用[链接](http://www.jikos.cz/~mikulas/links/)转换为纯文本。我使用了命令行

`links -dump -no-numbering -no-references input.html > output.txt`

在过去，这给了一个相当不错的结果。这当然会匹配呈现的 HTML 的视图而不是原始 PDF，因此可能不完全是您想要的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-09T21:55:20.833

我通常的策略是使用[hyperlatex](http://hyperlatex.sourceforge.net/)将其转换为网页，然后从网络浏览器中处理和粘贴。我发现这提供了最好的格式。

然后我通常必须通过并手动修复一些换行...

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-01-20T19:24:33.137

试试这里的步骤：http: [//zanedp.livejournal.com/201222.html](http://zanedp.livejournal.com/201222.html)

这是一个将我的 LaTeX 文件转换为纯文本的序列：

```
$ latex file.tex
$ catdvi -e 1 -U file.dvi | sed -re "s/\[U\+2022\]/*/g" | sed -re "s/([^^[:space:]])\s+/\1 /g" > file.txt 
```

catdvi 的 -e 1 选项告诉它输出 ASCII。如果使用 0 而不是 1，它将输出 Unicode。Unicode 将包括所有特殊字符，如项目符号、破折号和希腊字母。它还包括一些字母组​​合的连字，如“fi”和“fl”。你可能不喜欢那样。因此，请改用 -e 1 。使用 -U 选项告诉它打印出未知字符的 unicode 值，以便您可以轻松找到并替换它们。

该命令的第二部分查找用于指定项目符号字符 (•) 的字符串 [U+2022] 并将它们替换为星号 (*)。

第三部分吃掉了 catdvi 为使文本完全对齐而投入的所有额外空格，同时在行首保留空格（缩进）。

运行这些命令后，明智的做法是在 .txt 文件中搜索字符串 [U+，以确保没有留下无法映射到 ASCII 的 Unicode 字符并修复它们。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2012-02-12T16:08:34.557

当我需要从我的 TEX 文件中获取纯文本进行索引和搜索时，我发现 LaTeX2RTF 是一个很好的解决方案 - 它有一个[安装程序和适用于 windows 的 GUI](http://sourceforge.net/projects/latex2rtf/files/latex2rtf-win/)，它生成了一个我可以打开的 50 页论文的 RTF 文件在 Word 中。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2012-10-29T16:46:53.370

最适合我的解决方案如下。假设您存储了乳胶文档名称（不带扩展名），`${BASENAME}`请应用以下 3 个步骤：

`htlatex ${BASENAME}.tex`

`iconv -f iso-8859-1 -t utf-8 ${BASENAME}.html > ${BASENAME}-utf8.html`

`html2markdown ${BASENAME}-utf8.html > ${BASENAME}.txt`

显然，您需要拥有`tex4ht`并`python-html2text`安装。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-07-11T02:28:28.720

我试过 LyX，效果很好。唯一的细微差别是，如果您有一个包含其他 TeX 文件的 TeX 文件，则需要将它们全部单独导出，除非我遗漏了什么。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-10-31T06:22:34.030

[Pandoc](http://pandoc.org/try/)允许您将文件从一种格式转换为另一种格式使用以下 pandoc 命令：

```
pandoc -s /path/to/foobar.tex -o foobar.txt 
```

如果您希望您的行在某个列处中断，请使用`--column`标志。用于`--columns 10000`非断线。

您可以转换`-o foobar.txt`为[许多其他格式](http://pandoc.org/)，例如 markdown (.md) 等。如果您不指定`-o foobar.txt`，pandoc 将打印您可以在任何在线工具中呈现的 html。

要安装 pandoc，请遵循[此官方文档](https://pandoc.org/installing.html)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-11-01T19:09:25.133

您可以导入 lyx 并使用 lyx 的导出到文本功能。

如果你不使用 lyx 有点傻，但如果你已经拥有它，那么非常快速和简单的解决方案。对我来说结果很好，虽然公平地说我的文件很简单。不确定如何转换更复杂的文件。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2014-05-10T17:28:30.417

Emacs 有命令`iso-iso2tex`并且`iso-tex2iso`工作得很好，除了它不会将单个命令转换`\OE`为`Œ`.

# python - Python的“内置方法acquire”是什么？我怎样才能加快速度？

> ID：530127
> 
> 赞同：7
> 
> 时间：2009-02-09T21:41:59.070
> 
> 标签：python, optimization, profiling, performance

我正在编写一个具有大量文件访问权限的 Python 程序。它的运行速度出奇地慢，所以我使用 cProfile 来找出花费时间的原因。

似乎在 Python 报告为“{built-in method acquire}”的内容上花费了*很多时间。*我不知道这个方法是什么。它是什么，我怎样才能加快我的程序？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-09T21:49:50.877

没有看到您的代码，很难猜测。但猜测我会说它是[threading.Lock.acquire](http://docs.python.org/library/threading.html#threading.Lock.acquire)方法。您的部分代码正在尝试获取线程锁，并且它正在等待直到它得到它。

可能有简单的方法来修复它

*   重组您的文件访问权限，
*   不锁定，
*   使用阻塞=假，
*   甚至根本不使用线程。

但同样，如果没有看到您的代码，很难猜到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T22:05:57.983

为 IO 使用线程是个坏主意。线程不会让你的程序等待得更快。您可以通过使用异步 I/O 和事件循环来获得更好的结果；发布有关您的程序以及您使用线程的原因的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-12T17:16:54.543

您想从该方法中查找使用的 CPU，而不是“使用的总时间”——这可能会有所帮助。抱歉，我不使用 python，但这就是我在 ruby​​ 中的方式:) -r

# c# - 是否可以在空数据网格中显示消息

> ID：530130
> 
> 赞同：8
> 
> 时间：2009-02-09T21:42:41.190
> 
> 标签：c#, winforms, datagrid, .net-2.0

我有一个数据网格，当用户将文件拖放到它上面时，它会填充 CSV 数据。是否可以在空白网格中显示消息，例如“请在此处拖动文件”或“此网格当前为空”。网格当前显示为深灰色框，因为我等到拖动文件以设置列等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T21:59:06.550

我们将 DataGridView 控件子类化并添加了它。我们不需要拖放功能——我们只需要在他们的查询没有返回数据时告诉用户。

我们有一个如下声明的 emptyText 属性：

```
 private string cvstrEmptyText = "";
    [Category("Custom")]
    [Description("Displays a message in the DataGridView when no records are displayed in it.")]
    [DefaultValue(typeof(string), "")]
    public string EmptyText
    {
        get
        {
            return this.cvstrEmptyText;
        }
        set
        {
            this.cvstrEmptyText = value;
        }
    } 
```

并重载 PaintBackground 函数：

```
 protected override void PaintBackground(Graphics graphics, Rectangle clipBounds, Rectangle gridBounds)
    {
        RectangleF ef;
        base.PaintBackground(graphics, clipBounds, gridBounds);
        if ((this.Enabled && (this.RowCount == 0)) && (this.EmptyText.Length > 0))
        {
            string emptyText = this.EmptyText;
            ef = new RectangleF(4f, (float)(this.ColumnHeadersHeight + 4), (float)(this.Width - 8), (float)((this.Height - this.ColumnHeadersHeight) - 8));
            graphics.DrawString(emptyText, this.Font, Brushes.LightGray, ef);
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T21:45:14.930

我认为在这里做的最简单的事情是制作一个巨大的标签控件来执行“Drag Here”并处理标签的拖放事件。拖放完成后，隐藏标签并显示网格。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T21:48:49.193

如果您改用 gridview，则可以使用 EmptyDataText 属性。它可以做数据网格可以做的所有事情，而且（恕我直言）我认为在大多数情况下它更容易使用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T22:34:26.230

在这种情况下，我所做的是向表单添加一个选项卡控件，将 DGV 放在一个选项卡中，并将标签（“拖到此处”或类似的东西）放在另一个选项卡中。隐藏标签。然后，如果 DGV 为空，则显示带有标签的选项卡。就像 routeNpingme 的回答一样，您将在此处处理拖放事件，在后台加载 DGV，然后在加载完成后切换选项卡。这很好，因为您还可以在 VS Designer 中轻松地在选项卡之间来回切换。

# asp.net-mvc - ASP.Net RC1 中 TryUpdateModel 的模拟要求

> ID：530133
> 
> 赞同：5
> 
> 时间：2009-02-09T21:43:13.437
> 
> 标签：asp.net-mvc, unit-testing, mocking, updatemodel

我正在为 RC1 中的控制器编写一些单元测试。这是我正在测试的控制器的公共签名：

```
 [AcceptVerbs(HttpVerbs.Post)]
    public ActionResult AcceptColleague()
    { 
```

AcceptColleague 内部的实现使用 TryUpdateModel(colleague) 方法从表单字段中填充 Colleague 对象。但是，在尝试对该方法进行单元测试时，我在 TryUpdateModel 行上遇到了“对象引用未设置为对象的实例”错误。

这是我的单元测试代码：

```
 // definition
        HomeController controller = new HomeController();
        IColleagueRepository fakeColleagueRepo = MockRepository.GenerateMock<IColleagueRepository>();
        Colleague requestedColleauge = new Colleague();
        EmployeeInfo currentUser = new EmployeeInfo();            
        HttpContextBase fakeHttpContext = MockRepository.GenerateMock<HttpContextBase>();
        HttpRequestBase fakeHttpRequest = MockRepository.GenerateMock<HttpRequestBase>();
        ControllerContext fakeContext = MockRepository.GenerateMock<ControllerContext>(fakeHttpContext, new RouteData(), controller);
        NameValueCollection fakeForm = new NameValueCollection();

        // expectations
        fakeColleagueRepo.Expect(c => c.Read(1234)).Return(requestedColleauge);
        fakeColleagueRepo.Expect(c => c.Update(requestedColleauge));
        fakeColleagueRepo.Expect(c => c.Add(new Colleague())).IgnoreArguments().Constraints(Is.NotNull());
        fakeContext.Expect(cx => cx.HttpContext).Return(fakeHttpContext);
        fakeHttpContext.Expect(hcx => hcx.Request).Return(fakeHttpRequest);
        fakeHttpRequest.Expect(hr => hr.Form).Return(fakeForm);

        // setup
        controller.ColleagueRepository = fakeColleagueRepo;
        controller.ControllerContext = fakeContext;
        requestedColleauge.TargetEmployeeInfoId = 123456;
        requestedColleauge.GeneratedEmployeeInfoId = 654321;
        currentUser.EmployeeInfoId = 123456;
        fakeForm.Add("ColleagueId", "22222");

        // action
        RedirectToRouteResult result = controller.AcceptColleague() as RedirectToRouteResult;

        // validation
        Assert.IsNotNull(result, "AcceptColleague() did not return RedirectToRouteResult"); 
```

我是否在模拟中遗漏了某些内容，还是应该使用不同的公共签名，例如 AcceptColleague(Colleague colleague)，然后测试 ModelState.IsValid 属性？

如果是这样，怎么看不到我可以模拟控制器的只读 ModelState 属性的方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-09T21:53:39.073

TryUpdateModel 和 ModelState 在 RC 1 中都需要*零*模拟。您唯一需要提供的是 ValueProvider。为此，您可以使用 FormCollection.ToValueProvider()。

您仍然需要模拟您的存储库，但您无需在框架中模拟此功能。试试这个：

```
 FormCollection fakeForm = new FormCollection();
    fakeForm.Add("ColleagueId", "22222");
    controller.ValueProvider = fakeForm.ToValueProvider();

    // action 
```

注意：不需要模拟的 HttpContext，除非您的代码需要它。

# .net - .NET PInvoke 可以从用户指定的目录动态加载本机 dll 吗？

> ID：530143
> 
> 赞同：2
> 
> 时间：2009-02-09T21:45:33.133
> 
> 标签：.net, directory, pinvoke, native, loadlibrary

我有一个 .NET 应用程序，需要加载一个本地库，其位置由用户指定。PInvoke 看起来只会从全局搜索路径（或编译时指定的路径？）加载。最好的方法是创建一个在运行时调用 LoadLibrary 的 C++/CLI 程序集吗？

C++/CLI 会比 C# PInvoking LoadLibrary 更简单吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T21:53:10.933

如果您已经有一个 C#/VB.Net 项目，那么只需 PInvoke LoadLibrary 就可以更简单地加载 DLL。从现有的 dll 中快速调用 PInvoke

```
public partial class NativeMethods {

    /// Return Type: HMODULE->HINSTANCE->HINSTANCE__*
    ///lpLibFileName: LPCWSTR->WCHAR*
    [System.Runtime.InteropServices.DllImportAttribute("kernel32.dll", EntryPoint="LoadLibraryW")]
public static extern  System.IntPtr LoadLibraryW([System.Runtime.InteropServices.InAttribute()] [System.Runtime.InteropServices.MarshalAsAttribute(System.Runtime.InteropServices.UnmanagedType.LPWStr)] string lpLibFileName) ;

} 
```

仅添加此代码将比添加完整的 C++\CLI 项目快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T22:00:40.883

我同意 JaredPar。加载 dll 后，您需要使用函数指针访问 dll 公开的 API，简单的 PInvoke 声明将不再起作用，您将需要使用 Windows API GetProcAddress ...

```
[DllImport("kernel32.dll", CharSet=CharSet.Ansi, ExactSpelling=true)]
public static extern UIntPtr GetProcAddress(IntPtr hModule, string procName); 
```

...然后使用 System.Runtime.InteropServices 命名空间中的 GetDelegateForFunctionPointer() 将返回的地址绑定到委托。

# .net - .NET Compact Framework 应用程序中的版本号

> ID：530149
> 
> 赞同：5
> 
> 时间：2009-02-09T21:48:02.100
> 
> 标签：.net, compact-framework

我需要在屏幕上显示 .NET Compact Framework 版本号。我将 .NET CF 2.0 与 Windows CE 4.0 一起使用。

到目前为止，我一直完全忽略版本号。我需要向程序集添加任何内容吗？如何以编程方式检索它？

* * *

不幸的是，这不适用于*Compact Framework*。`Application.ProductVersion`Compact Framework 中不存在该属性。不过，您的答案的最新部分适用。

还有一个问题：这些属性（主要、次要、构建、修订）是否会自动增加，或者我是否可以随时设置它们？在我看来，修订版应该随着每个新版本自动增加。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-09T21:50:10.877

System.Reflection.Assembly.GetExecutingAssembly().GetName().Version.Major System.Reflection.Assembly.GetExecutingAssembly().GetName().Version.Minor System.Reflection.Assembly.GetExecutingAssembly().GetName().Version。构建 System.Reflection.Assembly.GetExecutingAssembly().GetName().Version.Revision

来源：http: [//msdn.microsoft.com/en-us/library/system.version.aspx](http://msdn.microsoft.com/en-us/library/system.version.aspx)

**（编辑）**

Application.ProductVersion 属性

获取与此应用程序关联的产品版本。

***在 Compact Framework 中不可用，但 System.Reflection.Assembly.GetExecutingAssembly().GetName().Version 是。***

来源：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.application.productversion.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.productversion.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-16T22:55:08.473

*   您还可以使用 Version.ToString() 传递要返回的组件数量作为参数：

    System.Reflection.Assembly.GetExecutingAssembly().GetName().Version.ToString(3)

    此行返回 Major.Minor.Build

    来源： http: [//msdn.microsoft.com/en-us/library/bff8h2e1 (VS.80).aspx](http://msdn.microsoft.com/en-us/library/bff8h2e1(VS.80).aspx)

*   您的项目中有一个 AssemblyInfo.cs，您可以在其中编辑您的程序集版本。要自动增加修订，您可以使用以下内容：1.0.3200.*

    来源： http: [//msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute (VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute(VS.80).aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-04T18:05:24.733

我知道这是一个老问题，但这是我使用 Reflection 和 Linq 找到的解决方案（从[我的答案转贴在这里](https://stackoverflow.com/questions/126926/how-can-i-make-the-assemblyinfo-version-of-a-c-sharp-net-cf-program-propagate-t)）。

首先，我将其添加到 AssemblyInfo.cs 中（将字符串替换为您想要使用的任何内容）：

```
[assembly: AssemblyInformationalVersion("1.0.0.0 Alpha")] 
```

然后，您可以使用此方法提取属性（我将其放在 AssemblyInfo.cs 文件中的静态类中）。方法 get 是所有 Assembly 属性的数组，然后选择与属性名称匹配的第一个结果（并将其转换为正确的类型）。然后可以访问 InformationalVersion 字符串。

```
//using System.Reflection;
//using System.Linq;
public static string AssemblyInformationalVersion
{
    get
    {
        AssemblyInformationalVersionAttribute informationalVersion = (AssemblyInformationalVersionAttribute) 
            (AssemblyInformationalVersionAttribute.GetCustomAttributes(Assembly.GetExecutingAssembly())).Where( 
                at => at.GetType().Name == "AssemblyInformationalVersionAttribute").First();

        return informationalVersion.InformationalVersion;
    }
} 
```

要获得我使用的正常“AssemblyVersion”属性：

```
//using System.Reflection;
public static string AssemblyVersion
{
    get
    {
        return Assembly.GetExecutingAssembly().GetName().Version.ToString();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-09T13:41:53.447

要使用 .NET Compact Framework（使用 2.0 和 3.5 测试）显示产品版本，可以使用下面定义的**AssemblyHelper.getProductVersion()**。

例如，如果程序集版本在 AssemblyInfo.cs 文件中定义如下，则该方法的结果为“1.2.3”。

AssemblyInfo.cs 文件的摘录：

```
[assembly: AssemblyVersion("1.2.3")] 
```

AssemblyHelper.cs 文件的摘录：

```
using System;
using System.Reflection;

public static class AssemblyHelper
{
  public static string getProductVersion()
  {
    Version assemblyVersion = Assembly.GetExecutingAssembly().GetName().Version;
    return String.Format("{0}.{1}.{2}", assemblyVersion.Major, assemblyVersion.Minor, assemblyVersion.Build);
  }
} 
```

# jdbc - Glassfish 应用服务器中的 JDBC 和连接池

> ID：530150
> 
> 赞同：2
> 
> 时间：2009-02-09T21:48:24.140
> 
> 标签：jdbc, glassfish, connection-pooling

我想在 EAR 部署中设置一个连接池和 JDBC 连接，因此我不必在我手动部署到的每个 App Server 上进行设置。我需要做什么？有没有我可以将这些信息放入的 .xml 文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T01:31:56.100

如果您使用单个 GlassFish 管理控制台来管理整个环境中的多个应用程序服务器，那么这些应用程序服务器可以共享一个通用配置。如果每个部署的应用程序服务器都有自己的管理控制台，您可以编写一个脚本来调用 CLI (asadmin) 来创建和配置连接池。实际上，您可以使用 CLI 在第一个用例中配置分布式部署，但您必须指定要修改的配置。CLI 有利于自动化。

希望以下资源有所帮助：

*   [http://docs.sun.com/app/docs/doc/820-4341/abdjl?a=view](http://docs.sun.com/app/docs/doc/820-4341/abdjl?a=view)
*   [http://wiki.glassfish.java.net/Wiki.jsp?page=GlassFishV2Architecture](http://wiki.glassfish.java.net/Wiki.jsp?page=GlassFishV2Architecture)
*   [http://docs.sun.com/app/docs/doc/820-4332/6nfq988or?a=expand](http://docs.sun.com/app/docs/doc/820-4332/6nfq988or?a=expand)（供 asadmin CLI 参考）
*   [http://docs.sun.com/app/docs/doc/820-4332/create-jdbc-connection-pool-1?a=view](http://docs.sun.com/app/docs/doc/820-4332/create-jdbc-connection-pool-1?a=view)（参见 --target 在多主机部署中指定目标）

GlassFish 集团产品经理 John Clingan

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T21:51:19.640

抱歉这么简洁，但这可能是您正在寻找的[http://docs.sun.com/app/docs/doc/820-4502/beaqi?a=view](http://docs.sun.com/app/docs/doc/820-4502/beaqi?a=view)

# asp.net - 自定义 asp.net 会员提供程序

> ID：530162
> 
> 赞同：5
> 
> 时间：2009-02-09T21:51:34.087
> 
> 标签：asp.net, membership

我正在通过从 MembershipProvider 继承来实现自定义成员资格提供程序。我有自己的数据库模式，它不同于 aspnet 成员模式。

我没有使用密码字段，我想知道如何覆盖内置的 CreateUserWizard 控件？

我找不到任何关于如何构建我自己的 CreateUserWizrd 控件的示例，该控件与我的自定义成员资格提供程序相关联。我找到的示例是使用控件中的模板自定义现有的 CreateUserWizard。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T22:20:25.373

你有几个选择。一种是如建议的那样，只需更改模板即可。另一个（更好，虽然更多的工作）是在反射器中弹出打开控件以查看它是如何工作的，然后扩展它并覆盖相关位以删除对密码的引用。

第三个（也是我推荐的）是自己动手。、和类都相当容易使用，而且`Membership`重量相当大。除非它正是我所需要的，否则我通常会将一个用户控件放在一起，无论如何，即使使用默认提供程序也是如此。`Roles``Profile``CreateUserWizard`

# automation - QTP：参数化数据库检查点

> ID：530171
> 
> 赞同：0
> 
> 时间：2009-02-09T21:54:01.710
> 
> 标签：automation, automated-tests, qtp

我在 QTP (HP QuickTest Pro) 中有一个数据库检查点；如果我将静态查询传递给此检查点，则此检查点有效，但我需要能够传入参数或以编程方式构建查询。我也知道如何从 QTP 以编程方式查询数据库，但没有看到基于其结果创建检查点的方法。

具体来说，如果返回的 RecordCount = 0，我想导致 FAIL，如果 >= 1，我想导致 PASS。我是开发人员，而不是测试人员；并且[QTP 论坛](http://www.learnqtp.com/forums/how-to-variable-checkpoint-t-1559.html)没有响应 - 请帮帮我！

这是我尝试过的代码——它有效但缺少检查点：

```
Dim con, rs,strSQL, Param1, Param2
Param1 = DataTable("B", dtGlobalSheet)
Param2 = DataTable("A", dtGlobalSheet)
Set con=Createobject("ADODB.Connection")
Set rs=Createobject("ADODB.recordset")
rs.CursorLocation = 3
rs.CursorType =3
connSTR= "Driver={SQL Server};Server=vsql0001;Database=DB0001;Dsn=myRegistryName"
con.open connSTR
strSQL= "select Field1, Field2 from dbo.Table1 where Field1 in (select Field1 from     dbo.Table2 where Param2 like '%"+Param2+"%' and active = 1) and (Field2     = '"+Param1+"' or Field2 like '"+Param1+" %' or Field2 like '%*"+Param1+"' or Field2     like '%*"+Param1+"*%')"
rs.open strSQL, con
msgbox rs.recordcount   ' want the CP to go here
rs.close
con.close 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T23:04:56.453

知道了。我给它静态查询并在评估之前对其进行更改。

```
strSQL= "select [...]"
DbTable("DbTable").SetTOProperty "Source", strSQL
DbTable("DbTable").Check CheckPoint("DbTable") 
```

# c# - 如何防止 Visual Studio 设计器在 DataGridView 中自动生成列？

> ID：530176
> 
> 赞同：10
> 
> 时间：2009-02-09T21:55:03.017
> 
> 标签：c#, .net, winforms, visual-studio-2008, datagridview

`DataGridView`我以编程方式在子类中生成所有列。然而，Visual Studio 2008 继续读取我的构造函数类（它用空内容填充 a`DataTable`并将其绑定到`DataGridView`）并为方法中的列生成代码`InitializeComponent`- 在进程设置`AutoGenerateColumns`中为`false`.

这会导致设计时编译中的错误，只能通过手动进入设计代码并删除对这些自动生成的列的所有引用来解决。

我怎样才能阻止它这样做？

**我试过了：**

*   使控件“冻结”
*   设置`DataGridView`实例化的对象`protected`（在上一篇文章中提到过[这个站点](http://weblogs.asp.net/rweigelt/archive/2003/09/24/28984.aspx)的建议）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T22:02:44.123

听起来您正在构造函数中添加控件。也许稍后再添加列 - 可能类似于覆盖`OnParentChanged`；然后，您将能够进行检查`DesignMode`，以便您仅在执行期间（而不是在设计期间）添加列。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T22:03:56.303

我以前在 ComboBox 的 Items 属性中看到过这种行为，这真的很令人沮丧。以下是我使用 ComboBox 解决问题的方法。您应该能够将其应用于 DataGridView。

我创建了一个名为 Items 的“新”属性，并将其设置为不可浏览并明确地从序列化中隐藏。在引擎盖下，它只是访问真实的 Items 属性。

```
[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public new ObjectCollection Items
{
    get { return ((ComboBox)this).Items; }
}

[Browsable(false)]
[DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
public new object DataSource
{
    get { return ((ComboBox)this).DataSource; } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-09-02T13:47:23.853

我遇到了与此类似的问题，并在这里发布我的解决方案，因为当我写我的问题时，这是建议的最高问题。每次我编译我的代码时，设计器都会自动添加数据源中的每一列（并且下次我构建我的代码时，它们会出现在正在运行的应用程序中），尽管自动生成列被设置为 false。

最终，我设法通过为我的列之一与自动生成的列具有相同的名称来阻止它（我的列最初是在数据源可用之前手动创建的）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-10T22:47:56.510

马克是对的。设计器查看构造函数以了解这种自动生成行为。这是我解决它的方法。

从构造函数中取出将 DataTable 构造/绑定到 DataGridView 的代码，并将其放在一个方法中。

使用`Load`包含表单上的事件 - 包含多个`DataGridView`s 调用`BindData()`每个实例上的方法，

```
 List<Control> childControls = Misc.Misc.GetAllChildControls(this);
foreach (Control ctrl in childControls) {
    if (ctrl is WorksheetGridView) {
         WorksheetGridView wsgv = ctrl as WorksheetGridView;
         wsgv.BindData();
    }
} 
```

`GetAllChildControls`辅助类中的方法在哪里

```
 internal static List<Control> GetAllChildControls(Control topControl)
{
    List<Control> ctrlStore = new List<Control>();
    ctrlStore.Add(topControl);
    if (topControl.HasChildren)
    {
        foreach (Control ctrl in topControl.Controls)
        {
            ctrlStore.AddRange(GetAllChildControls(ctrl));                }
        }
    }
    return ctrlStore;
} 
```

对不起，如果这是明确的，但我永远不想忘记如何做到这一点！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-10-04T12:08:26.083

JaredPar 的建议对我有用：

```
public partial class RefusjonsOppgjorGrid : DataGridView
{
    public RefusjonsOppgjorGrid()
    {
        InitializeComponent();
    }

    [Browsable(false)]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
    public new DataGridViewColumnCollection Columns
    {
        get{ return base.Columns;}
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-10T08:44:38.400

我经常在我的自定义控件中执行此操作，如果您将不想在设计器中执行的代码包装在 DesignMode 检查中，它应该可以解决您的问题。

```
 if (!DesignMode)
    {
        // Your code here
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-28T00:34:29.590

这是一个老问题，但在 2014 年 VS2013 仍然是一个问题。

我将 a设置为 a ，而后者又将`DataGridView`其设置为。为了解决我的问题，除了将 DataGridView.DataSource 分配移动到表单上的覆盖之外，我不需要更改任何其他内容。`DataSource``BindingSource``BindingSource``DataSource``OnControlCreate`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-08-09T16:47:25.870

[@JaredPar 的回答](https://stackoverflow.com/a/530219/430967)让我找到了解决这个问题的大部分方法，但是只要设计器中的任何内容发生变化，任何包含我的`DataGridView`子类的控件都会添加列。

我想将列保留在构造函数中，以便它们可以在可视化设计器中看到，所以我不得不禁用`DataGridViewDesigner`我的子类从其基类继承的标准，即。我为我的班级更改了 Designer 属性...

```
using System.Windows.Forms.Design;

[Designer(typeof(ControlDesigner))]
public class SpecificDataGridView : DataGridView
{
    [Browsable(false),
     DesignerSerializationVisibility(DesignerSerializationVisibility.Hidden)]
    public new DataGridViewColumnCollection Columns
    {
        get { return base.Columns; }
    }

    ...etc...
} 
```

这确实意味着设计人员不能在 DataGridViewDesigner 任务中使用“编辑项目”等，并且他们无法根据需要调整列的属性，但对于我的需要，这并不是特别有用，所以它是没有损失。

无论如何，这解决了问题，它仍然意味着这些列在设计器中是可见的，这是我在这里的主要目标。

只是想我会分享。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-09T15:41:52.437

由于这对某些人来说似乎仍然是一个问题，包括我自己，直到几天前，我想我会发布我的解决方案，以及从现在开始我在课堂上教给学生的解决方案：

首先，我创建一个`DataGridView`(DGV) 对象并在设计视图中创建列，记下特定列的对象名称。

现在，当我想从我的数据库（SQL Server，对于这个代码）绑定数据时。我更改列对象并将每一列直接绑定到来自`DataTable`.

```
private void FillAddresses()
    {
        // erase any old data
        if (AddrTable != null)
            AddrTable.Clear();
        else
            AddrTable = new DataTable();

        // switch-case for panel types that need an address
        switch(PanelType)
        {
            case "Customer":
            case "Customers":
            case "Location":
            case "Locations":
            case "Employee":
            case "Employees":
                BuildStateColumnChoices();
                SqlCommand sqlAddrCmd = new SqlCommand();
                sqlAddrCmd.CommandText = "exec SecSchema.sp_GetAddress " + PanelType +
                    "," + ObjectID.ToString(); // Fill the DataTable with a stored procedure
                sqlAddrCmd.Connection = DBConnection;
                sqlAddrCmd.CommandType = CommandType.Text;
                SqlDataAdapter sqlDA = new SqlDataAdapter(sqlAddrCmd);

                try
                {
                    sqlDA.Fill(AddrTable);

                    dgvAddresses.AutoGenerateColumns = false;
                    // Actually, you set both the DataSource and DataPropertyName properties to bind the data
                    dgvAddresses.DataSource = AddrTable;

                    // Note that the column parameters are using the name of the object from the designer.
                    // This differs from the column names.
                    // The DataProperty name is set to the column name returned from the Stored Procedure
                    dgvAddresses.Columns["colAddrType"].DataPropertyName = "Type";
                    dgvAddresses.Columns["collAddress"].DataPropertyName = "Address";
                    dgvAddresses.Columns["colAptNum"].DataPropertyName = "Apt#";
                    dgvAddresses.Columns["colCity"].DataPropertyName = "city";
                    dgvAddresses.Columns["colState"].DataPropertyName = "State";
                    dgvAddresses.Columns["colZIP"].DataPropertyName = "ZIP Code";

                }
                catch(Exception errUnk)
                {
                    MessageBox.Show("Failed to load address data for panel type " +
                        PanelType + "..." + errUnk.Message, "Address error",
                        MessageBoxButtons.OK, MessageBoxIcon.Exclamation);
                    return;
                }

                break;
        }
    } 
```

对于上面的代码，DBConnection 是我从中获取此代码的对象的公共属性，它存储了该`SqlConnection`对象。此外，colAddressType 是一个 ComboBox 列。来自绑定的数据`DataTable`只能匹配 ComboBox 中列出的信息。类似地，colState 是一个 ComboBox 列，但该框的默认值是通过查询另一个包含所有州的表（在此示例中为美国）添加的。

这里的要点是，您可以通过在设计时创建列来绑定要包含在 DGV 中的数据，然后将数据从 DataTable 直接绑定到列。这允许您拥有所需的任何类型的列，而不仅仅是默认绑定机制提供给您的默认 TextColumn。

应该注意的是，在这种情况下，DataTable 是存储过程的结果，在这种情况下不太可能进行编辑。我尝试使用视图以及存储函数；第一个也不允许编辑（至少，不容易......我怀疑我需要在某个地方触发之前插入，但这是一个数据库问题），而第二个不会根据一些动态问题返回表表生成。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-06-30T08:27:22.013

在设计器中重新打开表单，以便自动生成列，然后单击 DataGridView，选择编辑列，检查每个有问题的列并将其“可见”属性设置为 False。重新保存并关闭/重新打开表单以确保它不再发生。这是唯一对我有用的非编码解决方案，我不想添加代码来解决什么是 winforms 设计器问题。

# html - 如何在 LAMP 环境中正确链接到名称中带有重音符号的文件

> ID：530177
> 
> 赞同：0
> 
> 时间：2009-02-09T21:55:11.707
> 
> 标签：html, lamp, character-encoding

我制作了一个 php 脚本，它遍历目录中的文件并输出指向它们的链接。文件名是西班牙语，所以有些文件名包含 á、é 等字符。

我的脚本在我的开发机器（windows+apache+php）中运行良好，但是它在我的主机服务器（linux+apache+php）中不起作用，它找不到文件。

一些搜索建议使用 urlencode()，但是当我这样做时，它会在我的开发机器下中断，所以这对我来说是不可接受的，尽管我没有在我的网络服务器中尝试过。

编辑：有关使用 urlencode() 时开发机器上的错误的更多详细信息。

似乎有 2 个错误，一个是文件名包含 á、é 等字符。另一个是文件名包含空格。

带有空格的文件名（即“Calidad Total .doc”）会获得以下链接[http://localhost/temarios/docs/Calidad+total+.doc](http://localhost/temarios/docs/Calidad+total+.doc)，这给了我一个 404 file not found 错误。将地址栏中的 '+' 替换为 ' 可以正常工作。

带有重音字符的文件名（即 Economía.doc）获取链接[http://localhost/temarios/docs/Econom%EDa.doc](http://localhost/temarios/docs/Econom%EDa.doc)给我一个 403 Forbidden 错误。将地址栏中的 'í' 替换为 '%ED' 可以正常工作。

我已经在 Firefox 3 和 IE8 windows 7 beta 中进行了测试，并且在两种浏览器中都发生了同样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T22:39:49.370

您应该对它们进行 urlencode 的原因是 URL 必须仅由可打印的 US-ASCII 字符组成。

“URL 仅使用 US-ASCII 编码字符集的图形可打印字符编写。”

*   [http://www.ietf.org/rfc/rfc1738.txt](http://www.ietf.org/rfc/rfc1738.txt)
*   [ASCII 可打印字符](http://en.wikipedia.org/wiki/ASCII#ASCII_printable_characters)

将您收到的错误的详细信息发布在您的开发机器上并找出那里的问题可能是明智的。

# php - PHP 的循环引用问题的规模有多大，我应该担心吗？

> ID：530179
> 
> 赞同：5
> 
> 时间：2009-02-09T21:55:24.687
> 
> 标签：php, garbage-collection, circular-reference

如果我使用类似于下面代码的节点树结构，我是否需要担心循环引用？
我读过 PHP 使用了一种内存分配机制，当涉及到循环引用时，这会使垃圾收集器的生活变得非常困难。

我想知道的是：

*   如果我的树只包含几个节点，比如 25 个，这是一个问题吗？
*   内存会在脚本结束时被释放，还是我慢慢地给服务器造成了问题？
*   在什么情况下这个问题会在脚本执行过程中产生影响？
*   手动销毁引用会解决问题吗？我应该总是这样做吗？

```
class Node {
    private $parent;
    private $children;

    function addChild( Node $child ) {
        $this->children[] = $child;
        $child->setParent( $this );
    }

    function setParent( $parent ) {
        $this->parent = $parent;
    }
}

//eg
$node0 = new Node;
$node1 = new Node;

// nodes 1 and 2 have a circular reference to each other
$node0->addChild( $node1 ); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T22:21:14.157

逐点：

> *   如果我的树只包含几个节点，比如 25 个，这是一个问题吗？

除非你的节点是真正的怪物。

> *   内存会在脚本结束时被释放，还是我慢慢地给服务器造成了问题？

当解释器关闭时，所有内存都会被释放。

> *   在什么情况下这个问题会在脚本执行过程中产生影响？

我怀疑除非你有非常低的内存限制或非常大的动态数据结构，否则你会担心什么。如果您有 25 个不经常创建/释放的节点，您将不会遇到问题。

> *   手动销毁引用会解决问题吗？我应该总是这样做吗？

我会帮你的。当使用 Propel 将大型数据集加载到我们的数据库中时，我们遇到了很多内存消耗问题，我们跟踪到循环引用没有被释放。我们的解决方案是调用一个清除所有引用的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T22:00:49.680

也许是这样，但由于它在每个请求结束时都会抛出所有对象（除非你正在缓存），我认为许多 PHP 程序员不会担心这一点。

如果您正在用 PHP 编写命令行脚本，那么也许您有理由担心它，但是您必须编写一些相当复杂的 PHP 代码，然后它才会成为值得担心的事情。如果是这样的话，你会有更大的问题。

祝你好运。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-09T22:53:19.290

PHP 5.3 将包括循环引用检测和销毁功能。这是一个可选设置，只应在必要时使用，因为垃圾收集器会影响性能，但它是为您的示例量身定制的。

现在开发，注意在 __destruct() 方法中显式取消引用，并尽可能升级到 5.3。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-09T22:04:10.080

鉴于大多数 PHP 页面的性质——也就是说，该进程为网页运行并在完成时被丢弃——我相当怀疑这是一个问题。我以前没有见过循环引用的问题，并且没有问题地使用它们。以我的经验，你会遇到更多的内存消耗问题，但 PHP 5 已经通过从复制对象和数组转移到一定程度上缓解了这一问题，除非另有说明。

# asynchronous - 无时钟计算机芯片怎么了？

> ID：530180
> 
> 赞同：74
> 
> 时间：2009-02-09T21:56:19.643
> 
> 标签：asynchronous, cpu, processor, clock

几年前，“下一件大事”是无时钟计算机。它背后的想法是，如果没有时钟，处理器将运行得更快。

那是那时，这是现在，我找不到任何关于它是如何发生的或者这个想法是否失败的信息......

有人知道吗？

以供参考：

[http://www.cs.columbia.edu/~nowick/technology-review-article-10-01.pdf](http://www.cs.columbia.edu/~nowick/technology-review-article-10-01.pdf)

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-02-09T23:12:12.567

这是[几年前的一篇](http://www1.cs.columbia.edu/async/misc/technologyreview_oct_01_2001.html)关于技术的文章，但我认为答案可以在这句话中找到：

> 例如，为什么英特尔放弃了它的异步芯片？答案是，尽管该芯片的运行速度是时钟芯片的三倍，并且使用的电力只有时钟芯片的一半，但这还不足以证明转向激进技术的合理性。实验室中的异步芯片可能比任何同步设计都领先数年，但支持传统微处理器生产的设计、测试和制造系统在任何支持异步生产的产品上仍然领先大约 20 年。任何计划开发无时钟芯片的人都需要找到一种方法来短路该引线。
> 
> “如果你通过异步设计获得三倍的功率，但进入市场需要五倍的时间——好吧，你就输了，”参与 1997 年异步项目的英特尔高级科学家 Ken Stevens 说。“仅仅成为一个有远见的人，或者说这项技术有多么伟大是不够的。这一切都归结为你是否能做到足够快、足够便宜，以及你是否能年复一年地继续做下去。”

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-09T23:13:55.073

这里有一些关于这个主题的信息，这里有[异步 CPU](http://en.wikipedia.org/wiki/Asynchronous_circuit#Asynchronous_CPU)和这里[的通用 CPU 历史](http://en.wikipedia.org/wiki/History_of_general_purpose_CPUs#1990_to_today:_looking_forward)，包括（有些不是）最近的实现列表。

从一些优点（功耗、速度）和缺点（增加复杂性、更难设计）来看，近年来的发展似乎集中在嵌入式设计上似乎是合乎逻辑的：

*   爱普生ACT11
*   SEAforth® 40C18

# streaming - 媒体播放器 URL 选项

> ID：530183
> 
> 赞同：0
> 
> 时间：2009-02-09T21:56:37.147
> 
> 标签：streaming, windows-media-player, wmv

在线打开视频时，有没有办法通过 URL 传递开始时间？例如：

```
http://www.example.com/newvideo.wmv?starttime=00:33:34.0 
```

我已经看到了使用 Javascript 或制作 ASX 文件的不同方法，以便对其进行一些控制，但我只需要在文件开始播放时跳转到文件中的某个时间。这些视频很长，我的目标是制作一个目录，人们可以在其中单击他们想要查看的部分旁边的链接，这就是视频开始的地方。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T22:18:15.503

据我所知，这是不可能的，[这似乎表明](http://msdn.microsoft.com/en-us/library/aa386383%28v=VS.85%29.aspx)情况确实如此......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-04T04:27:19.580

IE 有另一种称为“时间”的语言 页面需要在样式标记中编写一些声明，就像 VML 一样，但是非常简单，您可以自己设置样式，而不是原始的 Windows Media Player。

您可以使用 javascipt 编写页面，而不是指向 http url 的链接，播放器标签是这样的

<t:media id="bMedia" volume=50 timeAction="visibility" src="xva.wmv" onend="doSomething()" onmediacomplete="doSomethingElse()" />

你需要使用的方法---- bMedia.seekActiveTime(x); //在元素的活动时间轴上定位一个指定点并从该点开始播放。

[在此处](http://msdn.microsoft.com/en-us/library/ms533611(VS.85).aspx)了解更多信息

Windows Media Player 是在这些脚本上运行的程序

# algorithm - 实现Excel和VB的IRR函数

> ID：530192
> 
> 赞同：6
> 
> 时间：2009-02-09T21:58:58.327
> 
> 标签：algorithm, excel

我需要将 Excel 和 VB 中的[IRR](http://en.wikipedia.org/wiki/Internal_rate_of_return)函数移植到 ActionScript。

*   [Excel 内部收益率公式](http://www.techonthenet.com/excel/formulas/irr.php)

知道如何找到这些功能的“来源”吗？有没有人用其他类似c的语言实现了这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T22:14:48.087

使用迭代求解器（例如二分法或牛顿法）进行编码是相当容易的。如果您的现金流`C_t_j`有时发生，那么`t_j`内部收益率满足`r`总和`j = 1``n`

```
C_t_j / (1 + r)^t_j 
```

等于零。打电话给这个`f(r)`。然后`f'(r)`是`j = 1`_ `n`_

```
-t_j * C_t_j / (1 + r)^(t_j+1). 
```

现在您可以应用牛顿法求解`r`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T01:06:39.750

Below is my iterative implementation, in ActionScript:

```
 package xattam.net.math
{
    public class Financial
    {
        public static const MAX_IRR_ITERATIONS:int = 1000;

        public static function IRR(cashFlow:Array,guess:Number=0.1):Number {
            var npv:Number;
            var cnt:Number = 0;
            do
            {
                npv = Financial.NPV(guess,cashFlow);
                guess+= 0.001;

                if(cnt > Financial.MAX_IRR_ITERATIONS) return NaN;
                else cnt++;
            }
            while(npv > 0)

            return guess;
        }
        public static function NPV(discountRate:Number,cashFlow:Array):Number {
            var npv:Number = 0;
            for(var t:int = 0; t < cashFlow.length;t++) {

                npv += cashFlow[t] / Math.pow((1+ discountRate),t);
            }
            return npv;
        }
    }   
} 

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T22:27:50.613

这是我多年前编写的 IRR Excel 宏。我无法再解释它是如何工作的，但我认为它做了正确的事情：

它的调用方式如下： =IrrCont(A8:A15,F8:F15) 其中第一个范围是日期范围，第二个范围是值范围。有些值必须是正的，有些必须是负的。

```
Option Explicit
'
' Internal Rate of return -- Calculation
' Returns a result (Double) or an error message (String)

Private Function IrrCalc(DateRange As Object, ValueRange As Object)
    Dim i As Integer
    Dim it As Integer
    Dim Count As Integer
    Dim u As Double
    Dim time As Double
    Dim d_positive As Double
    Dim positive As Double
    Dim d_negative As Double
    Dim negative As Double
    Dim sum As Double
    Const epsilon As Double = 0.000001
    Const iterations As Integer = 20
    Dim StartTime As Double
    Dim pos As Boolean
    Dim neg As Boolean
    Dim value As Double
    Dim temp As Double
    Dim delta As Double

    If DateRange.Count <> ValueRange.Count Then
      IrrCalc = "*** Date Range (argument 1) and Value Range " & _
          "(argument 2) must contain the same number of cells. ***"
      Exit Function
    End If

    Count = DateRange.Count

    For i = 1 To Count
      If ValueRange.Cells(i).value > 0 Then pos = True
      If ValueRange.Cells(i).value < 0 Then neg = True
      If pos And neg Then Exit For
    Next i

    If Not pos Or Not neg Then
      IrrCalc = "*** Cannot calculate IRR: Need both income and expenditure. ***"
      Exit Function
    End If

    StartTime = Application.Min(DateRange)

    u = 0 ' Initial interest rate guess

    For it = 1 To iterations
      positive = 0
      d_positive = 0
      negative = 0
      d_negative = 0

      For i = 1 To Count
        value = ValueRange.Cells(i).value
        time = (DateRange.Cells(i).value - StartTime) / 365.2425
        If value > 0 Then
          temp = value * Exp(u * time)
          positive = positive + temp
          d_positive = d_positive + temp * time
        ElseIf value < 0 Then
          temp = -value * Exp(u * time)
          negative = negative + temp
          d_negative = d_negative + temp * time
        End If
      Next i
      delta = Log(negative / positive) / (d_negative / negative - d_positive / positive)
      If Abs(delta) < epsilon Then Exit For
      u = u - delta
    Next it

    If it > iterations Then
      IrrCalc = "*** irr does not converge in " & Str(iterations) & " iterations ***"
    Else
      IrrCalc = u
    End If
End Function

' ====================================================================================================
'
' Internal Rate of Return: Discrete interest calculation

Function IrrDiscrete(DateRange As Object, ValueRange As Object)
  Dim result As Variant
  result = IrrCalc(DateRange, ValueRange)
  If VarType(result) = vbDouble Then
    IrrDiscrete = Exp(-result) - 1#
  Else
    IrrDiscrete = result
  End If
End Function

' ====================================================================================================
'
' Internal Rate of Return: Continuous (compounding) interest calculation

Function IrrCont(DateRange As Object, ValueRange As Object)
  Dim result As Variant
  result = IrrCalc(DateRange, ValueRange)
  If VarType(result) = vbDouble Then
    IrrCont = -result
  Else
    IrrCont = result
  End If
End Function 
```

# flash - 您更喜欢哪种触摸屏用于 Flash 信息亭工作？

> ID：530198
> 
> 赞同：0
> 
> 时间：2009-02-09T21:59:59.417
> 
> 标签：flash, touchscreen, kiosk

我们公司做了大量的闪存工作，偶尔也会进行离线/信息亭应用程序。我想向我们的客户推荐触摸屏，但对市场了解不够。

有人对任何特定型号的触摸屏有什么好的经验吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-09T22:03:06.320

在我使用过的少数供应商中，ELO 触摸屏是最好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-03T12:45:28.003

市场上有几种触摸屏技术，据我所知，我们公司正在使用其中两种比较著名的技术是基于电阻的和基于电容的，

根据我的经验：

基于阻力更容易使用，更少推动，甚至你可以**使用笔**，但寿命更少，

**电容式对于指纹大**或手指干硬的人来说有些困难，但寿命更长

# wpf - 在 XAML 中设置控件模板的属性

> ID：530201
> 
> 赞同：0
> 
> 时间：2009-02-09T22:01:00.663
> 
> 标签：wpf, xaml, controltemplates

我创建了一个按钮控件模板，我想在其中更改 xaml 级别上按钮的发光颜色。这就是我的意思。

```
<Button x:Name="btnClose" Template="{DynamicResource GlassButton}" Width="32" Height="32" GlowStartColor="Red" GlowEndColor="DarkRed">Button1</Button> 
```

GlowStartColor 和 GlowEndColor 是我要在控件模板上更改的属性。

这是我的控制模板

```
 <ControlTemplate x:Key="DefaultGlassButton" TargetType="{x:Type Button}">
    <!-- Internal Resources -->
    <ControlTemplate.Resources>
        <Storyboard x:Key="Storyboard1" RepeatBehavior="Forever" AutoReverse="True">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Glow" Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.3000000" Value="1"/>
                <SplineDoubleKeyFrame KeyTime="00:00:00.7000000" Value="1"/>
            </DoubleAnimationUsingKeyFrames>
            <ColorAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Glow" Storyboard.TargetProperty="(Panel.Background).(GradientBrush.GradientStops)[1].(GradientStop.Color)">
                <SplineColorKeyFrame KeyTime="00:00:00.3000000" Value="#00C080FF"/>
                <SplineColorKeyFrame KeyTime="00:00:00.7000000" Value="#00C080FF"/>
            </ColorAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="Storyboard2">
            <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Glow" Storyboard.TargetProperty="(UIElement.Opacity)">
                <SplineDoubleKeyFrame KeyTime="00:00:00.3000000" Value="0.745"/>
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
    </ControlTemplate.Resources>

    <!-- Actual Control Template-->
    <Border x:Name="OuterBorder" BorderBrush="#FFFFFFFF" BorderThickness="1,1,1,1" CornerRadius="4,4,4,4">
        <Border x:Name="InnerBorder" Background="#7F000000" BorderBrush="#FF000000" BorderThickness="1,1,1,1" CornerRadius="4,4,4,4">
            <Grid x:Name="MainGrid">
                <Grid.RowDefinitions>
                    <RowDefinition Height="0.5*"/>
                    <RowDefinition Height="0.5*"/>
                </Grid.RowDefinitions>
                <Border x:Name="Glow" HorizontalAlignment="Stretch" Width="Auto" Opacity="0" Grid.RowSpan="2" CornerRadius="4,4,4,4">
                    <Border.Background>
                        <RadialGradientBrush>
                            <RadialGradientBrush.RelativeTransform>
                                <TransformGroup>
                                    <ScaleTransform CenterX="0.5" CenterY="0.5" ScaleX="1.852" ScaleY="2.281"/>
                                    <SkewTransform AngleX="0" AngleY="0" CenterX="0.5" CenterY="0.5"/>
                                    <RotateTransform Angle="0" CenterX="0.5" CenterY="0.5"/>
                                    <TranslateTransform X="0.014" Y="0.458"/>
                                </TransformGroup>
                            </RadialGradientBrush.RelativeTransform>
                            <GradientStop x:Name="GlowStartColor" Color="#B1FF80FF" Offset="0"/>
                            <GradientStop x:Name="GlowEndColor" Color="#00C080FF" Offset="1"/>
                        </RadialGradientBrush>
                    </Border.Background>
                </Border>
                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Width="Auto" Grid.RowSpan="2"/>
                <Border x:Name="Shine" HorizontalAlignment="Stretch" Margin="0,0,0,0" CornerRadius="4,4,0,0">
                    <Border.Background>
                        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                            <GradientStop x:Name="ShineStartColor" Color="#99FFFFFF" Offset="0"/>
                            <GradientStop x:Name="ShineEndColor" Color="#26FFFFFF" Offset="1"/>
                        </LinearGradientBrush>
                    </Border.Background>
                </Border>
            </Grid>
        </Border>
    </Border>

    <!-- Triggers -->
    <ControlTemplate.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
        </Trigger>
        <Trigger Property="IsMouseOver" Value="True">
            <Trigger.EnterActions>
                <BeginStoryboard Storyboard="{StaticResource Storyboard1}"/>
            </Trigger.EnterActions>
            <Trigger.ExitActions>
                <BeginStoryboard x:Name="Storyboard2_BeginStoryboard" Storyboard="{StaticResource Storyboard2}"/>
            </Trigger.ExitActions>
        </Trigger>
        <Trigger Property="IsPressed" Value="True">
            <Setter Property="Opacity" TargetName="Shine" Value="0.4"/>
            <Setter Property="Background" TargetName="InnerBorder" Value="#CC000000"/>
        </Trigger>
    </ControlTemplate.Triggers>
</ControlTemplate> 
```

这是执行此操作的正确方法，还是有更好的方法？对 WPF 和 XAML 来说还是相当新的，所以还有很多学习要做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T12:44:56.390

您需要继承 Button 并添加这两个属性，或者将这两个属性添加为附加属性（通过创建一个具有两个附加依赖项属性的新类）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-18T08:33:33.720

我最近不得不做类似的事情。事实证明，您可以搭载已在控件上定义的其他属性。因此，如果您的新模板不使用`TemplateBinding`s 表示，`Foreground`那么`Background`您可以在其中粘贴您的开始/停止发光颜色。所有控件上的`Tag`属性通常都是空的。

值得研究这些选项作为子类化控件的替代方法。在控件模板只有一个自定义参数的情况下，重用现有属性通常很简单，也很自然。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T08:56:50.383

据我了解您希望将模板中的发光颜色绑定到控件上的发光属性的问题。你可以这样做：

```
<GradientStop x:Name="GlowStartColor" Color="{TemplateBinding GlowStartColor}" Offset="0"/>
<GradientStop x:Name="GlowEndColor" Color="{TemplateBinding GlowEndColor}" Offset="1"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T11:45:55.743

我也无法使上述工作正常。虽然我认为它在正确的轨道上。我只是想在定义按钮时能够设置发光属性。唯一的另一种方法是对按钮进行自定义控件，但只是添加一些额外的属性似乎有点过分。

# java - 删除junit测试以构建ant

> ID：530203
> 
> 赞同：4
> 
> 时间：2009-02-09T22:01:09.057
> 
> 标签：java, netbeans, ant, junit, testing

与其说是编程问题，但我想我还是会问。

我怎样才能让它在构建之前不需要所有的junit测试都通过？在 netbeans 中，我可以构建项目而无需先进行测试。但是，当我运行 ant 时，它会确保我的所有 junit 测试都首先通过。我从我的 netbeans 项目目录中的命令行运行 ant。我需要修改哪些文件来告诉 ant 不要这样做？

为了添加一些细节，看起来 ant 脚本进入了 build.xml 和 build-impl.xml 文件以确定要做什么。build-impl.xml 说不要编辑它，而是编辑 build.xml。Build.xml 没有任何用于 junit 测试的选项，所以我想知道在哪里禁用测试。

请告诉我。

谢谢，jbu

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T22:23:55.867

您的一个 Ant XML 文件中应该有一个“junit”任务；在您的情况下，听起来好像此任务的“haltonerror”属性设置为“on”，如果任何 JUnit 测试失败，这会导致构建停止。如果您无法立即发现 junit 指令，它可能位于包含的文件中（查找“import”指令，通常位于文件顶部附近）。

您可以将此属性设置为“关闭”以更改此行为，但我强烈建议您不要这样做；您希望您的单元测试告诉您代码何时损坏。如果由于代码更改而导致任何测试失败，最好在继续更改代码之前修复测试而不是关闭它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-23T16:27:02.030

根据具体的项目类型，只运行一个不包括测试的目标。对于基本的 Java SE 项目：

```
ant jar 
```

# ntlm - 任何人都有使用 NTLM 身份验证的成功 WCAT 负载测试场景吗？

> ID：530204
> 
> 赞同：2
> 
> 时间：2009-02-09T22:01:10.757
> 
> 标签：ntlm, wcat

该文档提供了一个简洁的示例，并且看起来它无论如何都缺少一个跃点/对。当我设置一个脚本来访问远程服务器并类似地对我的 NTLM 通信进行模式设置时，我得到以下输出：
...
所有客户端已连接，测试开始。
收到无效代码。
接受远程连接时出错。
消息：检测到运行错误，正在终止客户端...
消息：正在终止 wcclient 的所有实例... 正在
连接到：
...

当我注释掉 3 个 NTLM 中心线时，我的场景工作得很好。当它们未注释时，它会失败。WCAT 客户端能够解析场景，但我还没有真正深入研究解析机制，看它是否正确解析。

（我已经修复了阻止来自多个远程客户端的连接的错误，但可能还有更多。）

这是场景的相关部分：

```
 request
    {
        url         = "http://weatherforecast-d/";
        statuscode  = 401;
    }

    request
    {
        url         = "http://weatherforecast-d/";
               // problems begin here...
          authentication = "ntlm";
          username = "my username";
          password = "my password";
        statuscode  = 200;
    } 
```

如果有人有 WCAT NTLM 脚本的运行功能示例，我将不胜感激。谢谢你。

我已经清理了 wcat.wsf 中的日志记录并进行了多次比较。必须有更好的方法来做到这一点，但我不知道。

*   “身份验证”解析，而其他参数名称不解析
*   “用户名”和“密码”本身不会导致致命错误
*   如果我注释掉单个参数行“身份验证”，则测试运行
*   如果我取消注释同一行，则会出现致命错误
*   脚本输出完全相同，直到失败
*   basic 或 ntlm 会导致相同的失败，任何垃圾文本也是如此

这个问题似乎隐藏在 wcclient 的深处。我想我将不得不开始寻找另一种产品。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-18T19:04:41.740

错误在文档中：

```
authentication = "ntlm"; 
```

应该：

```
authentication = NTLM; 
```

该参数不是动态字符串，而是关键字。引号使解析器失去了气味。

我会将此标记为答案，因为它是，但我仍然有一个问题。目前，我找不到完全正确的方法来教 WCAT 识别来自服务器的 401 和 200 响应。它可以识别一些 401 和一些 200，但我无法将正确数量的查询组合成任何正确的组合以使其识别所有内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-10-12T20:39:04.323

当我将端口放在事务请求之外时，我也遇到了同样的错误。一旦端口成为请求的一部分，错误就消失了。

# asp.net-mvc - 在 ASP.NET MVC 控制器中覆盖哪个 View()？

> ID：530205
> 
> 赞同：3
> 
> 时间：2009-02-09T22:01:15.407
> 
> 标签：asp.net-mvc

System.Web.Mvc.Controller 中最后调用了哪个方法 View()？或者我应该覆盖每一个？我想在继承自 System.Web.Mvc.Controller 的 BaseController 中设置一些视图数据。

**编辑：** 我想存储基本用户信息，例如 IsLoggedIn 和 BasicUserDetails { PermissionLevel, UserName, EmailAddress, UserId }

这是设置它的地方吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-09T22:50:21.653

您可能想要覆盖控制器上的“过滤器”方法之一。有四种这样的方法：

*   OnActionExecuting - 在执行操作之前发生
*   OnActionExecuted - 执行操作后发生
*   OnResultExecuting - 在 Action 返回的 ActionResult 执行之前发生
*   OnResultExecuted - 在 Action 返回的 ActionResult 执行后发生

这是添加所有操作通用功能的更好方法，因为它受到官方支持并且不太可能更改

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-09T22:04:14.057

有两种不同的实现（在 RC 1 中）：

```
 protected internal virtual ViewResult View(string viewName, string masterName, object model) {

    protected internal virtual ViewResult View(IView view, object model) { 
```

其他人都称这两个。但是，我不认为这会永远保持这种状态。我不得不想象框架的未来版本可能会改变这一点。

**更新**：要存储用户信息，[请使用 ASP.NET 成员资格](http://weblogs.asp.net/scottgu/archive/2008/07/14/asp-net-mvc-preview-4-release-part-1.aspx)。它已经告诉您用户是否已登录——Request.IsAuthenticated。您可以使用普通的会员功能存储自定义权限。已经支持电子邮件属性等。当然，身份验证提供程序是可插入的，因此您可以使用您想要的任何类型的身份验证——Windows、域、OpenID 等。

**更新 2**：还请注意，ControllerBase 有一个虚拟 Initialize 方法，您可以覆盖以设置您稍后在各种操作中需要的东西。

# java - 判断一手牌是否为顺子的函数？

> ID：530208
> 
> 赞同：7
> 
> 时间：2009-02-09T22:01:55.590
> 
> 标签：java, performance, poker

对于家庭作业，我得到了一个 Card 类，其中列举了 Rank 和 Suit 的类型。我需要比较两手牌（每手是`ArrayList`5 张牌）并决定获胜者。

这个`isStraight()`功能真的很困扰我，因为我必须在 Ace 之后重新开始计数。例如，

女王、国王、王牌、二、三

还是算直的。编写此功能的最佳方法是什么？

如果有帮助，这是 Rank/Suit 枚举类型代码。

```
public enum Rank
{
    TWO(2), THREE(3), FOUR(4), FIVE(5), SIX(6), SEVEN(7), EIGHT(8), NINE(9),
    TEN(10), JACK(11), QUEEN(12), KING(13), ACE(14);

    private final int points;

    private Rank(int points)
    {
        this.points = points;
    }

    public int points()
    {
        return this.points;
    }
}

public enum Suit
{
    DIAMONDS, CLUBS, HEARTS, SPADES;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-09T22:10:45.180

你确实意识到，根据我玩过或听说过的任何扑克游戏规则，顺子都不能回滚，对吗？Ace 可以是低位 [A,2,3,4,5] 或高位 [10,J,Q,K,A] 但它不能换行。根据那些规则（不是你的），我之前已经实现了类似的东西。基本上你对数组进行排序并遍历它，确保当前卡片比前一张卡片高一个。在第一次迭代中，如果它是 ace，则显式检查 [A,2,3,4,5]。如果是，则返回 true，如果不是，则继续正常的直接逻辑。这应该使您朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-20T16:12:59.687

尽管可能的牌有很多，但您可以编写一个花哨的算法来返回 true，但是如果您意识到排序的手牌上只有 10 个有效组合，您可以只查找这些：

```
2-6, 3-7, 4-8, 5-9, 6-T, 7-J, 8-Q, 9-K, T-A, (2-5,A) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-12-19T04:26:15.183

一般来说，解决扑克手牌的一个好方法是为每张牌分配一个位值，其中位 ((rank-2)*2) 位设置以及位 (suit+28) 设置，（所以 2=1, 3=4 , 4=16 等直到 A=​​0x1000000)。然后将所有卡片加在一起（称结果为“Sum”。计算 V1=(Sum & 0x2AAAAAA)>>1, V0=(Sum & 0x1555555) 和 V2=V1 & V0。还将五张卡片的值或一起, 并计算 V3=OrValue & 0xF0000000;

1.  对于一对，V1 将设置一个位，V0 将设置多个位，V2 将为零。
2.  对于两对，V1 将设置两个位，V2 将等于 0。
3.  对于三类，V1 将设置一个位，V2 将等于 V1。
4.  对于顺子，V0 要么是 0x1000055，要么是 0x155 的二次幂倍数。
5.  对于刷新，V2 将精确设置一个位。
6.  对于满屋，V1 将设置两个位，而 V2 将非零。
7.  对于四类，要么 V1 将是 v0 的两倍，并且都设置了一个位，或者 V0 将恰好设置了两个位，并且 V1 将为零。
8.  对于同花顺，将满足同花顺和同花顺的条件。

这种方法所需的测试应该可以通过最少的分支快速实现。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-10T00:17:17.293

由于您列出的只有 5 张卡片，因此您可以对其进行排序并确定 2 张连续卡片之间的差异。如果它包含一张 A，您也需要将其视为低牌。如果所有的差异都是 1（或 -1，取决于排序顺序），那么你就有顺子。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T22:44:05.897

我认为，鉴于 RANK 的定义，直道只能以 ACE.points() - 4 的最大值开始。

因此，如果您对手牌进行排序并且最低 RANK 是 > ACE.points() - 4，那么您就不可能有顺子，否则您只需遍历手牌以查看每张牌都是之前的 RANK + 1。

如果 ACE 可以是高或低，那么就选择 SHS 的回答。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T23:00:50.707

使用内部循环非常简单，挑战是在没有内部循环的情况下做到这一点......

此外，这取决于您是否理解您的老师或您的老师是否误解（或歪曲）游戏规则。

我想我很想创建一个数组 [2..14] 并将卡片放在与其等级相对应的位置。如果你打了一个重复，它不是一个顺子，当你完成后，你应该连续有 8 个空格。如果您的连续空格少于 8 个，则不是直线。

我能想到的所有其他解决方案都需要一个内部循环——如果你想成为一个受人尊敬的程序员，那么内部循环是你需要尽可能避免的那些草率的编程事情之一。

编辑：另外，如果你误解了老师并且唯一的包装条件是“10，j，q，k，a”（就像在真正的规则中一样），那么你需要一个额外的测试，如果所有 2、13 和 14 都是设置，它也是一个失败（2-ak 环绕）。

（在重新阅读问题后再次编辑以将 1 替换为 14）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-10T00:11:21.193

我不太使用枚举，我更喜欢命名常量，但我假设从“ACE”到“14”是微不足道的

我懒得写真正的java代码（除了你实际上必须做你的功课^^）

```
check if the list has 5 cards
convert card names to a card number list named array
sort the list array
for i=1 to 4
if not (array[i] + 1) % 13 == (array[i+1]) % 13
then it is not a straight 
```

% 运算符称为模数，因此 (15 % 13) == 2 每当我面临“换行”挑战时，我都会使用此运算符

编辑：重新阅读您的问题后，我的解决方案无法开箱即用。您应该重新排序您的枚举，以便 TWO == 0

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-10T00:31:58.007

我建议使用位向量来表示卡片。这避免了必须排序。您可以添加两次 ace（一次作为 1，其他时间作为国王），或者您可以通过在检查 2 是否设置之前检查 ace 位是否设置来特殊情况下的开始情况）。如果速度很重要，您可以构建一个大查找表。这种方法还清理秤以找到其余的手（同花、2 对、满屋、旅行等）。它还可以很容易地确定给定的顺子是否高于另一个顺子。它干净地扩展到 7 卡评估器

在伪代码中，对于一个非常一般的情况，它看起来像这样（你可以有任意数量的卡片。它返回第一笔）

```
 long cardBitMask
 for each card in hand
   setBit in cardBitMask

 hearts = mask(cardBitMask)
 diamonds = mask(cardBitMask)
 clubs = mask(cardBitMask)
 spades = mask(cardBitMask)

 // find straight
 uniqueCards = hearts|diamonds|clubs|spades
 int cardsInaRow = 0
 if uniqueCards&AceCardMask:
    cardsInaRow = 1
 for card = 2...King
   if uniqueCards&(1<<card)
      cardsInARow++
   else 
      if cardsInARow == 5
         break
      cardsInARow = 0
 if cardsInARow==5:
     return true
 return false 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-10T20:13:47.457

将所有等级按顺序添加到列表中，两次。然后，要检查一手牌是否是顺子，按等级对手牌进行排序，然后检查手牌是否是该列表的子列表。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-02-09T22:36:50.953

您可以编写一个将每张卡转换为特定卡值的类

小丑 = 11 皇后 = 12 国王 = 13 王牌 = 0 或 14

这将使卡片处理和寻找可能的手牌变得更加容易。

# java - 如何使用 Eclipse 合并工具将 CVS 分支合并到 HEAD？

> ID：530209
> 
> 赞同：37
> 
> 时间：2009-02-09T22:02:03.547
> 
> 标签：java, eclipse, merge, cvs

我目前在使用 Team-->Branch 创建的分支中工作。如何使用 Team-->Merge 将我的更改合并到分支中？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2011-05-26T23:32:42.943

我也遇到了麻烦。以下是我合并的步骤（主要取自在线 Eclipse 帮助）：

1.  在创建我的开发分支（**Team -> Branch**）时，我确保我为该分支创建了一个根标签，这是 CVS 将用来确定哪些更改是由于该分支以及其他工作可能已提交的内容的标签
2.  我在分支上完成了我的开发并将所有更改提交（**Team -> Commit**）回存储库
3.  现在我对分支的所有更改都在存储库中，我加载了我想要合并到的目标分支，通常是 HEAD（**团队 -> 切换到另一个分支或版本**）

您现在已准备好开始实际的合并过程。在这里，您将选择应该完成哪些更改以及应该丢弃哪些更改。将此过程视为一个半自动化的开发周期，实际上是一个检查、更改、提交周期。除了手动插入更改之外，您还可以使用比较工具来帮助您。毕竟，您已经在分支中进行了所有代码更改！

合并：

1.  **团队 -> 合并**
2.  要合并的分支或版本（结束标记）：这是您的开发分支标记的名称
3.  Common Base Version：这是分支的根标签的名称（还记得前面部分的第 1 步吗？）。这应该是由工具自动填充的，但如果没有，请自行添加
4.  我喜欢**在同步视图中预览合并，**这样我可以确保没有任何不应该的东西进入。根据你的勇气，这是我建议的选择。单击**完成**按钮
5.  Synchronize Perspective 将出现，并且在您的目标分支和源分支之间发现的任何差异都将显示在左侧的可扩展列表中
6.  对于任何文件，您可以在比较工具中打开它以查看之前的内容并单独合并更改（记住完成后保存文件！）或者您可以右键单击文件并从可扩展列表中选择合并。如果您使用比较工具手动合并，您可以在可展开列表中选择“标记为已合并”，将文件从待办事项列表中删除。
7.  一旦您决定如何处理该文件，它将从列表中删除。目标是对每个文件进行操作
8.  现在所有更改都已合并，切换回 Java 透视图并选择**Team -> Synchronize with Repository**，Synchronize Perspective 将重新出现。
9.  这次选择 Commit 将所有更改推送到存储库中。
10.  鳍！

希望有帮助。下面提供的就是指引我走向胜利的帮助文档的内容，供参考！

[Eclipse SDK 帮助 - 合并分支](http://help.eclipse.org/help33/index.jsp?topic=/org.eclipse.platform.doc.user/tasks/tasks-100b.htm)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-09T22:08:00.490

确保目标已加载到您的工作区。这是最重要的部分，也是我尝试做几次时错过的部分。

例如，如果您希望将更改合并到 HEAD 中，请确保项目与您工作区中的 HEAD 共享（而不是您一直在处理的分支）。为此，请选择项目并`Team > Replace With > Another Branch or Version`从上下文菜单中进行选择。然后选择要替换的分支。

从这一点开始，选择`Team > Merge`然后选择要合并到 HEAD 中的分支。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-06-09T11:52:24.240

我同意这是另一种方式，如果需要将 YOUR_BRANCH 中的更改更新为 HEAD，

1) 提交对 YOUR_BRANCH 的更改 2) 将本地分支交换到 HEAD 3) 合并 HEAD 女巫在 YOUR_BRANCH 中所做的更改

因此**，您需要在 HEAD 中并从 YOUR_BRANCH 中“获取”更改**（而不是将更改从 YOUR_BRANCH 发送到 HEAD）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-21T10:52:07.687

我只需要这样做。虽然上面的答案相似，但我发现它们并不特定于我需要做的事情。

*   如前所述，确保您的 detination 分支（通常是 head）已被签出。
*   然后，突出显示您知道在您的分支（或整个项目，等等）中更改的文件，然后选择`Team -> Merge`. 在弹出的对话框中，选择“ `Branch or version to be merged (end tag)`”，即您要从中获取文件的源分支。
*   在我的情况下，这会自动填充“ `Common base version (start tag)`”，但如果不是，那么这将是创建分支时创建的标签。

当您预览更改时，它们将出现在正常的 CVS 同步视图中。当您合并文件时，它们将作为更改被带入您的本地工作区（之前是您的目标分支）。此时您需要将它们检入 CVS。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-04-15T18:59:22.627

Frankly, there is no easy, clean way unless you have been anticipating and planning for this merge right from the time you branched.

However, I found a hack that works perfectly, which [I've described in a blog post](http://sites.google.com/site/anshunjain/eclipse-musings/eclipse-hacks/cvs-replace-head-with-branch).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-03-18T16:10:06.753

我也为此苦苦挣扎，在我选中“执行合并到本地工作区”单选按钮之前，上述答案没有帮助。

不幸的是，在两个文件合并之前，我无法预览我的合并。

# ruby-on-rails - 在控制器中修改/格式化数据库数据的最佳方法？

> ID：530210
> 
> 赞同：0
> 
> 时间：2009-02-09T22:02:32.923
> 
> 标签：ruby-on-rails, ruby, model-view-controller

假设在控制器中，我以这种方式从数据库中获取一组对象：

```
@statuses = TwitterStatus.find(:all, :order => "tweet_id DESC", :include =>  :twitter_user) 
```

此外，我在视图中有以下循环：

```
<% unless @statuses.nil? -%>
<ol>
    <% for status in @statuses %>
    <li><%= h(status.text -%>/li>
    <% end -%>
</ol>
<% end -%> 
```

我的模型类中有更多数据（用户信息、status_id 等）我想放入视图中。

问题是这个日期的大部分内容需要更改。我需要以某种方式格式化日期。我想将 'target="_blank"' 插入到“文本”字段中的任何 URL 中。

我的第一个想法是在控制器中有这样的东西：

```
for status in @statuses
  status.date = status.date.formatDate
  status.url = status.date.insertTarget
  status.user = status.user.doUserstuff

  #Adding new attribute
  status.username = status.user.lookupUserName

end 
```

这对我来说有点蹩脚。但是，我想不出更好的了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T22:54:36.027

我想同意阿拉姆的观点。在我开始添加大量清理它们的模型方法之前，我的视图中充斥着格式化代码。在我的上一个应用程序中，它是 Names and Times（一个员工调度应用程序）。

```
class Employee

 def full_name
  self.first_name + " " + self.last_name
 end

end 
```

时间总是很痛苦，在我看来，时间无处不在（对应用程序至关重要）。所以我想在任何地方显示开始时间，而不是调用我存储在数据库中的属性，我调用了一个自定义方法

```
class Schedule

 def formatted_start_time
  self.start_time.strftime('%I:%M%p')
 end

end 
```

最后一点，如果您在视图中的任何地方继续以相同的方式格式化时间，您可以扩展 Time 类并使您的调用更加简洁。在我的初始化程序文件夹中，我添加了一个“conversions.rb”文件，我在其中添加了这条小线

```
Time::DATE_FORMATS.update(:shift => '%I:%M%p') 
```

现在我要做的就是打电话：

```
time_object.to_s(:shift) 
```

在应用程序的任何地方返回我经常使用的格式化字符串。您可以拥有自己喜欢的格式的完整列表，以清理视图并使它们更易于理解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T22:10:24.230

您可能希望向 TwitterStatus 模型添加一些实例方法。例如：

```
def formatted_date
  self.date.formatDate
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T11:27:20.843

格式化的责任确实属于视图。

“Rails 方式”将添加一个辅助方法来进行格式化。

每个控制器都有一个辅助模块，还有一个全局 ApplicationHelper。

例如，如果您的控制器是 StatusController

```
module StatusHelper

  def status_text( status )
    # do all your formatting and HTML escaping here
    ...
  end

end 
```

并且在视图中

```
<% unless @statuses.nil? -%>
  <ol>
    <% for status in @statuses %>
      <li><%= status_text(status) -%></li>
    <% end -%>
  </ol>
<% end -%> 
```

# c# - 创建阻塞队列 在.NET 中？

> ID：530211
> 
> 赞同：166
> 
> 时间：2009-02-09T22:02:34.327
> 
> 标签：c#, .net, multithreading, collections, queue

我有一个场景，我有多个线程添加到一个队列中，并且多个线程从同一个队列中读取。如果队列达到特定大小，**所有填充队列的线程**将在添加时被阻塞，直到从队列中删除项目。

下面的解决方案是我现在正在使用的，我的问题是：如何改进？是否有一个对象已经在我应该使用的 BCL 中启用了这种行为？

```
internal class BlockingCollection<T> : CollectionBase, IEnumerable
{
    //todo: might be worth changing this into a proper QUEUE

    private AutoResetEvent _FullEvent = new AutoResetEvent(false);

    internal T this[int i]
    {
        get { return (T) List[i]; }
    }

    private int _MaxSize;
    internal int MaxSize
    {
        get { return _MaxSize; }
        set
        {
            _MaxSize = value;
            checkSize();
        }
    }

    internal BlockingCollection(int maxSize)
    {
        MaxSize = maxSize;
    }

    internal void Add(T item)
    {
        Trace.WriteLine(string.Format("BlockingCollection add waiting: {0}", Thread.CurrentThread.ManagedThreadId));

        _FullEvent.WaitOne();

        List.Add(item);

        Trace.WriteLine(string.Format("BlockingCollection item added: {0}", Thread.CurrentThread.ManagedThreadId));

        checkSize();
    }

    internal void Remove(T item)
    {
        lock (List)
        {
            List.Remove(item);
        }

        Trace.WriteLine(string.Format("BlockingCollection item removed: {0}", Thread.CurrentThread.ManagedThreadId));
    }

    protected override void OnRemoveComplete(int index, object value)
    {
        checkSize();
        base.OnRemoveComplete(index, value);
    }

    internal new IEnumerator GetEnumerator()
    {
        return List.GetEnumerator();
    }

    private void checkSize()
    {
        if (Count < MaxSize)
        {
            Trace.WriteLine(string.Format("BlockingCollection FullEvent set: {0}", Thread.CurrentThread.ManagedThreadId));
            _FullEvent.Set();
        }
        else
        {
            Trace.WriteLine(string.Format("BlockingCollection FullEvent reset: {0}", Thread.CurrentThread.ManagedThreadId));
            _FullEvent.Reset();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2009-02-09T22:05:20.590

这看起来很不安全（很少同步）；怎么样：

```
class SizeQueue<T>
{
    private readonly Queue<T> queue = new Queue<T>();
    private readonly int maxSize;
    public SizeQueue(int maxSize) { this.maxSize = maxSize; }

    public void Enqueue(T item)
    {
        lock (queue)
        {
            while (queue.Count >= maxSize)
            {
                Monitor.Wait(queue);
            }
            queue.Enqueue(item);
            if (queue.Count == 1)
            {
                // wake up any blocked dequeue
                Monitor.PulseAll(queue);
            }
        }
    }
    public T Dequeue()
    {
        lock (queue)
        {
            while (queue.Count == 0)
            {
                Monitor.Wait(queue);
            }
            T item = queue.Dequeue();
            if (queue.Count == maxSize - 1)
            {
                // wake up any blocked enqueue
                Monitor.PulseAll(queue);
            }
            return item;
        }
    }
} 
```

（编辑）

实际上，您需要一种关闭队列的方法，以便读者开始干净地退出 - 可能类似于 bool 标志 - 如果设置，空队列只会返回（而不是阻塞）：

```
bool closing;
public void Close()
{
    lock(queue)
    {
        closing = true;
        Monitor.PulseAll(queue);
    }
}
public bool TryDequeue(out T value)
{
    lock (queue)
    {
        while (queue.Count == 0)
        {
            if (closing)
            {
                value = default(T);
                return false;
            }
            Monitor.Wait(queue);
        }
        value = queue.Dequeue();
        if (queue.Count == maxSize - 1)
        {
            // wake up any blocked enqueue
            Monitor.PulseAll(queue);
        }
        return true;
    }
} 
```

* * *

## 回答 #2

> 赞同：60
> 
> 时间：2011-12-09T15:22:55.397

使用 .net 4 BlockingCollection，入队使用 Add()，出队使用 Take()。它在内部使用非阻塞 ConcurrentQueue。更多信息在这里[快速和最佳生产者/消费者队列技术 BlockingCollection 与并发队列](https://stackoverflow.com/questions/5001003/fast-and-best-producer-consumer-queue-technique-blockingcollection-vs-concurrent)

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-02-09T22:51:03.727

“这要怎么改进？”

好吧，您需要查看类中的每个方法，并考虑如果另一个线程同时调用该方法或任何其他方法会发生什么。例如，您在 Remove 方法中放置了一个锁，但没有在 Add 方法中。如果一个线程在添加另一个线程的同时删除会发生什么？*坏事。*

还要考虑一个方法可以返回第二个对象，该对象提供对第一个对象的内部数据的访问 - 例如，GetEnumerator。想象一个线程正在通过该枚举器，另一个线程同时正在修改列表。*不好。*

一个好的经验法则是通过将类中的方法数量减少到绝对最小值来简化此操作。

特别是，不要继承另一个容器类，因为您将公开该类的所有方法，为调用者提供一种破坏内部数据或查看数据的部分完整更改的方法（同样糟糕，因为数据在那一刻似乎已损坏）。隐藏所有详细信息，并对您如何允许访问它们完全无情。

我强烈建议您使用现成的解决方案 - 获取有关线程的书或使用 3rd 方库。否则，鉴于您正在尝试的内容，您将长时间调试代码。

此外，Remove 返回一个项目（例如，第一个添加的项目，因为它是一个队列）而不是调用者选择特定项目不是更有意义吗？当队列为空时，也许 Remove 也应该阻塞。

更新：马克的回答实际上实现了所有这些建议！:) 但我将把它留在这里，因为它可能有助于理解为什么他的版本如此改进。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-02-06T10:39:38.103

您可以在 System.Collections.Concurrent 命名空间中使用[BlockingCollection](http://msdn.microsoft.com/en-us/library/dd267312.aspx)和[ConcurrentQueue](http://msdn.microsoft.com/en-us/library/dd267265.aspx)

```
 public class ProducerConsumerQueue<T> : BlockingCollection<T>
{
    /// <summary>
    /// Initializes a new instance of the ProducerConsumerQueue, Use Add and TryAdd for Enqueue and TryEnqueue and Take and TryTake for Dequeue and TryDequeue functionality
    /// </summary>
    public ProducerConsumerQueue()  
        : base(new ConcurrentQueue<T>())
    {
    }

  /// <summary>
  /// Initializes a new instance of the ProducerConsumerQueue, Use Add and TryAdd for Enqueue and TryEnqueue and Take and TryTake for Dequeue and TryDequeue functionality
  /// </summary>
  /// <param name="maxSize"></param>
    public ProducerConsumerQueue(int maxSize)
        : base(new ConcurrentQueue<T>(), maxSize)
    {
    }

} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-05-07T14:14:36.027

我刚刚使用 Reactive Extensions 解决了这个问题并记住了这个问题：

```
public class BlockingQueue<T>
{
    private readonly Subject<T> _queue;
    private readonly IEnumerator<T> _enumerator;
    private readonly object _sync = new object();

    public BlockingQueue()
    {
        _queue = new Subject<T>();
        _enumerator = _queue.GetEnumerator();
    }

    public void Enqueue(T item)
    {
        lock (_sync)
        {
            _queue.OnNext(item);
        }
    }

    public T Dequeue()
    {
        _enumerator.MoveNext();
        return _enumerator.Current;
    }
} 
```

不一定完全安全，但非常简单。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-28T12:55:36.713

这就是我为线程安全的有界阻塞队列而来的操作。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Threading;

public class BlockingBuffer<T>
{
    private Object t_lock;
    private Semaphore sema_NotEmpty;
    private Semaphore sema_NotFull;
    private T[] buf;

    private int getFromIndex;
    private int putToIndex;
    private int size;
    private int numItems;

    public BlockingBuffer(int Capacity)
    {
        if (Capacity <= 0)
            throw new ArgumentOutOfRangeException("Capacity must be larger than 0");

        t_lock = new Object();
        buf = new T[Capacity];
        sema_NotEmpty = new Semaphore(0, Capacity);
        sema_NotFull = new Semaphore(Capacity, Capacity);
        getFromIndex = 0;
        putToIndex = 0;
        size = Capacity;
        numItems = 0;
    }

    public void put(T item)
    {
        sema_NotFull.WaitOne();
        lock (t_lock)
        {
            while (numItems == size)
            {
                Monitor.Pulse(t_lock);
                Monitor.Wait(t_lock);
            }

            buf[putToIndex++] = item;

            if (putToIndex == size)
                putToIndex = 0;

            numItems++;

            Monitor.Pulse(t_lock);

        }
        sema_NotEmpty.Release();

    }

    public T take()
    {
        T item;

        sema_NotEmpty.WaitOne();
        lock (t_lock)
        {

            while (numItems == 0)
            {
                Monitor.Pulse(t_lock);
                Monitor.Wait(t_lock);
            }

            item = buf[getFromIndex++];

            if (getFromIndex == size)
                getFromIndex = 0;

            numItems--;

            Monitor.Pulse(t_lock);

        }
        sema_NotFull.Release();

        return item;
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-09T22:11:23.913

我还没有完全探索过[TPL](http://www.microsoft.com/downloads/details.aspx?FamilyId=348F73FD-593D-4B3C-B055-694C50D2B0F3&displaylang=en)，但他们可能有一些适合你需要的东西，或者至少有一些 Reflector 素材可以从中获得一些灵感。

希望有帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-11-19T16:30:17.017

从 .NET 5.0/Core 3.0 开始，您可以使用[System.Threading.Channels](https://docs.microsoft.com/en-us/dotnet/api/system.threading.channels.channel.createbounded?view=net-5.0)[这篇文章（.NET (C#) 中的异步生产者消费者模式）中的](https://www.dotnetcurry.com/dotnetcore/1509/async-dotnetcore-pattern)
基准测试显示，与 BlockingCollection 相比，速度显着提升！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-09T22:05:22.133

好吧，你可以看看`System.Threading.Semaphore`课堂。除此之外 - 不，你必须自己做。AFAIK 没有这样的内置集合。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-02-09T22:04:32.213

如果你想要最大的吞吐量，允许多个读者阅读并且只有一个作者可以写，BCL 有一个叫做 ReaderWriterLockSlim 的东西，它可以帮助你精简你的代码......

# java - Hibernate vs JPA vs JDO - 各自的优缺点？

> ID：530215
> 
> 赞同：178
> 
> 时间：2009-02-09T22:03:09.050
> 
> 标签：java, hibernate, orm, jpa, jdo

我熟悉 ORM 作为一个概念，几年前我什至在 .NET 项目中使用过 nHibernate；但是，我没有跟上 Java 中的 ORM 的主题，也没有机会使用这些工具中的任何一个。

但是，现在我可能有机会开始为我们的一个应用程序使用一些 ORM 工具，试图摆脱一系列遗留的 Web 服务。

我很难说出 JPA 规范、您从 Hibernate 库本身获得的内容以及 JDO 必须提供的内容之间的区别。

所以，我知道这个问题有点开放，但我希望得到一些意见：

*   各自的优缺点是什么？
*   你会为一个新项目推荐哪个？
*   是否存在某些情况下使用一个框架而不是另一个框架才有意义？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2009-02-09T22:14:19.943

一些注意事项：

*   JDO 和 JPA 都是规范，而不是实现。
*   这个想法是，如果您将代码限制为仅使用标准 JPA，您可以交换 JPA 实现。（同样适用于 JDO。）
*   Hibernate 可以用作 JPA 的一种此类实现。
*   然而，Hibernate 提供了一个原生 API，其特性超越了 JPA。

IMO，我会推荐 Hibernate。

* * *

*如果您需要*使用特定于 Hibernate 的功能，有一些关于您应该做什么的评论/问题。有很多方法可以解决这个问题，但我的建议是：

*   如果您不担心与供应商合作的前景，那么请在 Hibernate 和其他 JPA 和 JDO 实现（*包括*您决策中的各种供应商特定扩展）之间做出选择。

*   如果您担心与供应商合作的前景，并且如果不求助于供应商特定的扩展就无法使用 JPA，那么请不要使用 JPA。（JDO 同上）。

实际上，您可能需要权衡*您*对供应商绑定的担忧程度与*您*需要这些供应商特定扩展的程度。

还有其他因素，例如您/您的员工对各自技术的了解程度、产品的许可成本以及您认为 JDO 和 JPA 未来会发生什么的故事。

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2010-03-11T11:30:29.323

确保评估 JDO 的 DataNucleus 实现。我们从 Hibernate 开始，因为它看起来很流行，但很快意识到它不是 100% 透明的持久性解决方案。有太多警告，文档中充满了“如果你遇到这种情况，那么你必须像这样编写代码”，这剥夺了我们想要的自由建模和编码的乐趣。JDO*从未*让我调整我的代码或模型以使其“正常工作”。我可以设计和编写简单的 POJO，就好像我打算只在“内存中”使用它们一样，但我可以透明地持久化它们。

JDO/DataNucleus 相对于 hibernate 的另一个优势是它没有所有的运行时反射开销，并且内存效率更高，因为它使用构建时间字节码增强（可能为大型项目的构建时间增加 1 秒）而不是比休眠的运行时反射驱动的代理模式。

您可能会发现 Hibernate 令人讨厌的另一件事是，您必须对您认为的对象进行引用……它通常是对象的“代理”。如果没有字节码增强的好处，代理模式需要允许按需加载（即当您拉入顶级对象时避免拉入整个对象图）。准备好覆盖 equals 和 hashcode，因为您认为您正在引用的对象通常只是该对象的代理。

这是一个使用 Hibernate 时会遇到的挫败感的示例，而使用 JDO 时不会遇到这样的问题：

[http://blog.andrewbeacock.com/2008/08/how-to-implement-hibernate-safe-equals.html](http://blog.andrewbeacock.com/2008/08/how-to-implement-hibernate-safe-equals.html)
[http://burtbeckwith.com/blog/?p=53](http://burtbeckwith.com/blog/?p=53)

如果您喜欢编写“变通办法”，那么 Hibernate 肯定适合您。如果您喜欢干净、纯粹、面向对象、模型驱动的开发，您将所有时间都花在建模、设计和编码上，而没有花在丑陋的变通方法上，那么请花几个小时评估[JDO/DataNucleus](http://www.datanucleus.org)。投入的时间将得到一千倍的回报。

## 2017 年 2 月更新

很长一段时间以来，除了 JDO 持久性标准之外，DataNucleus 还实现了 JPA 持久性标准，因此将现有的 JPA 项目从 Hibernate 移植到 DataNucleus 应该非常简单，您只需很少的代码更改即可获得 DataNucleus 的所有上述好处，如果有的话。因此，就问题而言，特定标准的选择，JPA（仅限 RDBMS）与 JDO（RDBMS + 无 SQL + ODBMSes + 其他），DataNucleus 支持两者，Hibernate 仅限于 JPA。

## Hibernate DB 更新的性能

选择 ORM 时要考虑的另一个问题是其脏检查机制的效率——当它需要构造 SQL 来更新当前事务中已更改的对象时——尤其是当有很多对象时，这一点变得非常重要。在这个 SO 答案中有对 Hibernate 的脏检查机制的详细技术描述： [JPA with HIBERNATE insert very slow](https://stackoverflow.com/questions/19983065/jpa-with-hibernate-insert-very-slow/42212442#42212442)

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2010-09-27T10:39:07.547

我最近评估并选择了一个 java 项目的持久性框架，我的发现如下：

我看到的是对**JDO**的支持主要是：

*   您可以使用非 sql 数据源、db4o、hbase、ldap、bigtable、couchdb（cassandra 插件）等。
*   您可以轻松地从 sql 数据源切换到非 sql 数据源，反之亦然。
*   没有代理对象，因此在 hashcode() 和 equals() 实现方面的痛苦更少
*   更多 POJO，因此需要更少的变通方法
*   支持更多的关系和字段类型

**对JPA**的支持主要是：

*   更流行
*   jdo死了
*   不使用字节码增强

我看到很多来自 JPA 开发人员的支持 JPA 的帖子，他们显然没有使用过 JDO/Datanucleus，他们为不使用 JDO 提供了薄弱的论据。

我还看到很多来自 JDO 用户的帖子，他们已经迁移到 JDO 并且因此更快乐。

关于 JPA 更受欢迎，这似乎部分是由于 RDBMS 供应商的支持，而不是它在技术上的优势。（对我来说听起来像 VHS/Betamax）。

JDO 和它的参考实现 Datanucleus 显然没有死，正如 Google 将它用于 GAE 和源代码的积极开发 (http://sourceforge.net/projects/datanucleus/) 所示。

由于字节码增强，我看到了许多关于 JDO 的投诉，但还没有解释为什么它不好。

事实上，在一个越来越痴迷于 NoSQL 解决方案的世界中，JDO（和 datanucleus 实现）似乎是一个更安全的选择。

我刚刚开始使用 JDO/Datanucleus 并对其进行了设置，以便我可以在使用 db4o 和 mysql 之间轻松切换。使用 db4o 有助于快速开发，而不必过多担心 DB 模式，然后，一旦模式稳定，就可以部署到数据库。我也有信心，以后，我可以将我的全部/部分应用程序部署到 GAE 或利用分布式存储/map-reduce a la hbase /hadoop / cassandra，而无需进行太多重构。

我发现开始使用 Datanucleus 的最初障碍有点棘手——datanucleus 网站上的文档有点难以理解——教程并不像我希望的那样容易理解。话虽如此，一旦您越过了最初的学习曲线，关于 API 和映射的更详细的文档就会非常好。

答案是，这取决于你想要什么。我宁愿拥有更简洁的代码、无供应商锁定、更面向 pojo、nosql 选项而不是更受欢迎的选项。

如果您想要和大多数其他开发人员/绵羊一样的温暖挑剔感觉，请选择 JPA/hibernate。如果您想在您的领域中处于领先地位，请试用 JDO/Datanucleus 并做出自己的决定。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2009-02-09T22:44:25.910

> 你会为一个新项目推荐哪个？

我都不建议！将 Spring DAO`JdbcTemplate`与`StoredProcedure`, `RowMapper`and一起使用`RowCallbackHandler`。

我自己对 Hibernate 的个人经验是，预先节省的时间远远超过了您将花费无数天试图理解和调试问题（例如意外的级联更新行为）的时间。

如果您使用的是关系数据库，那么您的代码越接近它，您拥有的控制权就越大。Spring 的 DAO 层允许对映射层进行精细控制，同时无需样板代码。此外，它集成到 Spring 的事务层中，这意味着您可以非常轻松地添加（通过 AOP）复杂的事务行为，而不会侵入您的代码（当然，您也可以使用 Hibernate 来实现这一点）。

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2009-02-21T07:45:36.293

> JDO 已死

JDO 实际上并没有死，所以请检查你的事实。JDO 2.2 于 2008 年 10 月发布 JDO 2.3 正在开发中。

这是在 Apache 下公开开发的。比 JPA 发布的版本更多，其 ORM 规范甚至领先于 JPA2 提议的特性

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2010-03-10T05:45:24.670

JDO 具有比 JPA 更高级的功能，请参见[http://db.apache.org/jdo/jdo_v_jpa.html](http://db.apache.org/jdo/jdo_v_jpa.html)

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2009-04-16T21:08:57.813

我正在使用 JPA（来自 Apache 的 OpenJPA 实现，它基于 5 年以上历史且非常快速/可靠的 KODO JDO 代码库）。恕我直言，任何告诉您绕过规范的人都会给您不好的建议。我投入了时间，肯定得到了回报。使用 JDO 或 JPA，您可以通过最少的更改更改供应商（JPA 具有 orm 映射，因此我们在不到一天的时间内就可能更改供应商）。如果您像我一样有 100 多张桌子，那将是巨大的。另外，您还可以通过集群方式缓存驱逐获得内置缓存，这一切都很好。SQL/Jdbc 非常适合高性能查询，但透明持久性更适合编写算法和数据输入例程。我的整个系统中只有大约 16 个 SQL 查询（50k+ 行代码）。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-02-09T22:29:19.317

我自己一直在研究这个，找不到两者之间的明显区别。我认为最大的选择是您使用哪种实现方式。对于我自己，我一直在考虑[DataNucleus](http://www.datanucleus.org/)平台，因为它是两者的数据存储不可知的实现。

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2010-03-11T11:42:12.717

任何说 JDO 已死的人都是 astroturfing FUD 贩子，他们知道这一点。

JDO 活得很好。该规范仍然比更年轻和受限制的 JPA 更强大、更成熟和更先进。

如果您想将自己限制在 JPA 标准中可用的内容，您可以写入 JPA 并将 DataNucleus 用作比其他 JPA 实现更透明的高性能持久性实现。当然，如果您想要 JDO 带来的建模灵活性和效率，DataNucleus 也实现了 JDO 标准。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-03-10T06:24:19.997

我在同一个项目中使用了 Hibernate（JPA 实现）和 JPOX（JDO 实现）。JPOX 工作正常，但很快就遇到了错误，其中一些 Java 5 语言功能当时不支持。它在处理 XA 事务时遇到了问题。我正在从 JDO 对象生成数据库模式。它每次都想连接到数据库，如果您的 Oracle 连接发生故障，这很烦人。

然后我们切换到休眠。我们玩弄了一段时间只使用纯 JPA，但我们需要使用一些 Hibernate 特定功能来进行映射。在多个数据库上运行相同的代码非常容易。Hibernate 似乎积极地缓存对象，或者有时只是有奇怪的缓存行为。有一些 DDL 结构 Hibernate 无法处理，因此它们被定义在一个附加文件中，该文件运行以初始化数据库。当我遇到 Hibernate 问题时，通常会有很多人遇到相同的问题，这使得在谷歌上搜索解决方案变得更容易。最后，Hibernate 似乎设计良好且可靠。

其他一些响应者建议只使用 SQL。对象关系映射的真正杀手级用例是测试和开发。为处理大量数据而构建的数据库通常很昂贵，或者很难安装。它们很难测试。有大量内存中的 Java 数据库可用于测试，但通常对生产毫无用处。能够使用真实但有限的数据库将提高开发效率和代码可靠性。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-11-21T15:42:53.850

我在 2012 年 5 月制作了一个使用 JDO 3.0 和 DataNucleus 3.0 的示例 WebApp - 看看它有多干净： [https ://github.com/TorbenVesterager/BadAssWebApp](https://github.com/TorbenVesterager/BadAssWebApp)

好吧，也许它有点太干净了，因为我将 POJO 用于数据库和 JSON 客户端，但这很有趣 :)

PS：包含一些 SuppressWarnings 注释（在 IntelliJ 11 中开发）

# asp.net - 网站中的扩展控件转换为 webapp 将无法编译

> ID：530217
> 
> 赞同：1
> 
> 时间：2009-02-09T22:03:42.187
> 
> 标签：asp.net

我有一个需要转换为 Web 应用程序的 VS 2005 网站。我不知道这是否会有所不同，但我实际上是将网站的一部分拆分为自己的。独立的部分是网站其余部分的一小部分。我创建了一个新的 Web 项目，复制了所有页面，并删除了我的小应用程序不需要的所有代码。我有一些从 ASP.NET WebControls 继承的用户控件和自定义控件
（例如：公共类 AutoCheckboxList: System.Web.UI.WebControls.CheckBoxList）

在转换后不会编译。
我按照这里的说明进行操作： [将网站项目转换为 Web 应用程序项目](http://msdn.microsoft.com/en-us/library/aa983476.aspx) ，但它没有说明我遇到的问题。

我从我的 aspx 页面中删除了我的注册并将它们放在 web.config 中（例如：
添加 tagPrefix="uc1" tagName="TopOfPage" src="~/WebUserControls/TopOfPage.ascx" />

希望这会有所帮助，但没有运气。我收到以下错误：
元素“TopOfPage”不是已知元素。如果网站中存在编译错误，则可能会发生这种情况。

这一直让我发疯！有没有人遇到过这个？如果是这样，你是如何解决的？我最后的手段是将其保留为网站，或者必须手动初始化所​​有这些。如果可能的话，我想避免两者。最终，我们也希望将原始网站转换为 Web 应用程序。我已经与团队中的其他人交谈过，这个问题是唯一阻止原始网站转换的问题。

TIA，特蕾莎

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T16:24:42.547

我同意！Web 应用程序比网站好得多**！**

看起来 Visual Studio 已经把自己搞混了。尝试按照以下步骤操作：

*   清洁溶液
*   关闭 Visual Studio
*   删除 .suo 文件（它是一个隐藏文件，与您的解决方案文件位于同一文件夹中）
*   删除临时 ASP.NET 文件（C:\Windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files 中的所有内容）
*   在 Visual Studio 中重新打开您的解决方案
*   按照相互依赖的顺序，一次一个地手动编译项目

# visitor-pattern - 在访问者模式中应该如何传递“位置”信息？

> ID：530225
> 
> 赞同：2
> 
> 时间：2009-02-09T22:04:50.903
> 
> 标签：visitor-pattern

假设我有这样的访客

```
class Visitor : IVisitor
{
     void Accept(Visitable v)
     {
         /// other code
         v.AChild.Visit(this);
         v.BChild.Visit(this);
     }
} 
```

其中 AChild 和 BChild 可以是完全相同的类型，但访问代码需要区分它们（它需要在 AChild 和 BChild 上进行不同的操作）。做这个的最好方式是什么？

*   在访问者中设置状态并在下次调用时检查它
*   将不同的访客传给每个孩子
*   其他？

* * *

对不起，我第一次是倒着做的（当前`Accept`是`Visit`）。它现在匹配[Wikipedia 中显示的模式](http://en.wikipedia.org/wiki/Visitor_pattern)。

所有访问方法如下所示：

```
void Visit(IVisitor v) { v.Accept(this); } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T22:41:45.090

您仍然从我认为传统上使用该模式的方式向后命名方法。Visitable（或 Element）通常有一个 accept 方法，而 Visitor 有一个 visitX 方法。我将使用传统的命名方案以避免混淆自己:-)

IMO 最简单的方法是在您的访问者界面上使用多种方法，一种用于每种类型的孩子。孩子是否是相同的语言类型并不重要，如果它们在语义上不同，则应该通过不同的方法来处理。

您还应该尽量避免使用有关 Visitable 结构的详细信息来污染访问者实现。为了做到这一点，我会将 accept 方法向上移动到 Visitable 接口，而不是在该接口上公开 childA 和 childB。然后，Visitable 的每个实现都可以决定为每个孩子调用访问者上的哪个方法。这会将所有“位置”上下文传达给访问者，并为您提供一个不错的、干净的、解耦的解决方案。

这是我在想的一个例子。同样，我已将方法名称换回了我习惯的名称。

```
interface Visitable {
  accept(Visitor v)
}

interface Visitor {
  visitA(Node a)
  visitB(Node b)
}

class Container implements Visitable {
  private Node childA
  private Node childB

  ...
  void accept(Visitor v) {
    v.visitA(childA)
    v.visitB(childB)
  }
} 
```

现在您将拥有一个具有 2 种不同方法的 Visitor 的实现，一种用于处理 A 孩子，另一种用于处理 B 孩子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T22:39:58.963

鉴于原始海报[背景问题](https://stackoverflow.com/questions/522803)的答案中的以下附加信息：

`The visitor object is required to know the structure of the things it visits. That's OK, though. You're supposed to write specialized visit operations for each type of thing the visitor knows how to visit. This allows the visitor to decide how much it really wants to visit, and in what order.`

我会回答：创建一个特殊的 IVisitor 类，可能称为 ABChildVisitor，它有一个知道如何遍历 AChild 和 BChild 的 Visit() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T22:10:29.953

根据您的架构，您应该只调用`v.Visit(this)`，并让您的 Visitable 实现确定如何使用`AChild`and `BChild`。

此外，请考虑这一点，`AChild`并且`BChild`可能应该是您的 Visitable 实例的私有成员。

# c# - Going from VisualStudio generated Database stuff to Programmer Generated

> ID：530230
> 
> 赞同：1
> 
> 时间：2009-02-09T22:05:46.657
> 
> 标签：c#, sql, sql-server, visual-studio-2008, devforce

I'd like to be able to better access the database so I can execute queries (primarily because I don't understand/know the API for it, but I do know SQL). I don't want to remove everything Visual Studio has done because a lot is already built upon it, but how can I get an object that I can use to execute SQL queries.

This is Visual Studio 2008, C#, and MSSQL

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-09T22:10:58.423

Try something like [this](http://blog.biztalk-info.com/archive/2008/06/19/Execute_SQL_Query_from_within_a_C_function.aspx):

```
using (SqlConnection conn = new SqlConnection("Connection String Goes Here"))
{
    conn.Open();
    using (SqlCommand comm = new SqlCommand("SELECT * FROM TABLE", conn))
    {
        return command.ExecuteScalar() as string;
    }
} 
```

Don't forget to add:

```
using System.Data;
using System.Data.SqlClient; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T22:19:10.837

You might also look into the [Data Access Application Block](http://www.codersource.net/microsoft_data_access_application_block_azam.html) - just a DLL you install in your app, which allows you to execute SQL queries and such much more simply:

```
DataSet ds = SqlHelper.ExecuteDataset(cs,CommandType.StoredProcedure,"SELECT_DATA"); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-09T23:30:58.217

Personally, I would always use the free Ideablade DevForce:

[http://www.ideablade.com/](http://www.ideablade.com/)

And use no SQL at all!

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T22:08:41.533

Are you asking what .NET libraries you can use to execute SQL against a database? If so, start by looking at `SqlConnection` and `SqlCommand` (if you're using SQL Server, otherwise use `OleDbConnection` and `OleDbCommand`). `SqlCommand` has several Execute() methods that will do what you're looking for.

ADO.NET is a pretty big beast but there are tons of quickstarts and sample code out there.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T22:11:27.487

Not 100% sure what you're really asking for :-), but assuming you're interested in knowing how to programatically execute a SQL query, you'll need (assuming SQL Server as the backend):

*   a "using System.Data;" and "using System.Data.SqlClient;" using clause
*   a "SqlConnection" object to establish your connection to SQL Server (usually combined with a ConnectionString, stored in some form of a config file)
*   a "SqlCommand" object to formulate your SQL query and execute it
*   some way of dealing with possible results from that query

You'll have something like:

```
SqlConnection connection = new SqlConnection(-connection string-);

SqlCommand command = new SqlCommand("...your sql query here...", connection);

connection.Open();

command.ExecuteScalar / command.ExecuteReader / command.ExecuteNonQuery
(depending on your needs)

connection.Close(); 
```

plus of course, some error handling.... :-)

Does that help that at all??

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-09T22:10:19.160

I'm not sure from your question what you've got going on, but if you just want to learn how to use a SqlConnection, SqlCommand, and a DataReader object to retrieve items from a database, check this out:

[http://msdn.microsoft.com/en-us/library/haa3afyz(VS.71).aspx](http://msdn.microsoft.com/en-us/library/haa3afyz(VS.71).aspx)

# iphone - iPhone UIWebview -- 保存已下载的图像

> ID：530240
> 
> 赞同：5
> 
> 时间：2009-02-09T22:07:53.940
> 
> 标签：iphone, uiwebview

我有一个带有嵌入式 UIWebview (Safari) 控件的 iPhone 应用程序。我希望能够在本地存储来自某些网页的图像。

我可以以编程方式访问 UIWebview 下载图像的路径吗？还是我需要先解析 HTML 再去网上找图片资源再下载？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-15T23:30:54.060

我不知道您是否可以从 Safari 的缓存中访问预加载的图像...

但是，您可以通过运行一些 javascript 来轻松找到图像 URL，而无需解析 HTML：

```
NSString *script = @"var n = document.images.length; var names = [];"
                    "for (var i = 0; i < n; i++) {"
                    "     names.push(document.images[i].src);"
                    "} String(names);";
NSString *urls = [webView stringByEvaluatingJavaScriptFromString:script];
// urls contains a comma-separated list of the image URLs. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-10T01:18:16.477

disclaimer: I have not tried this.

If you can find out their names, UIImage responds to +(UIImage*)imageNamed:(NSString*) which the docs imply might get the image back from a device wide cache.

I'd be interested in knowing the results of any experiments.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T22:59:06.513

我不认为你可以直接使用 UIWebview 保存图像，你将不得不手动获取图像......

# c# - 从 c++ com 加载项调用 C#

> ID：530244
> 
> 赞同：3
> 
> 时间：2009-02-09T22:08:49.973
> 
> 标签：c#, c++, com, add-in, ccw

我有一个用 C++（不是 C++/CLI）编写的 COM 插件。我想从此 C++ com 库中调用 C# 库对象/方法。

我想CCW在这里出现，我目前正在阅读。

根据您的经验，有没有关于这些东西的快速指示？

此外，我的 Com 加载项中有一个方法，我希望我的 C# 库代码可以调用它 - 即方法指针调用。

你能帮我告诉我该怎么做吗？即我如何将方法指针传递给 C# 代码，以便稍后调用它。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T01:01:08.610

我有这个链接给你：
[COM Interop Part 1 Sample](http://msdn.microsoft.com/en-us/library/ekdxstex(VS.80).aspx)
[Create DCOM application from within .Net environment: Part V](http://www.c-sharpcorner.com/uploadfile/yougerthen/710262008063529am/7.aspx)
[C++ to C# call](http://www.codeproject.com/KB/dotnet/bridge.aspx)

# c# - 如何使用 StreamWriter 创建目录？

> ID：530245
> 
> 赞同：18
> 
> 时间：2009-02-09T22:09:04.433
> 
> 标签：c#, .net

是否可以使用 StreamWriter 创建目录？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-09T22:10:40.233

不，您实际上不能使用 StreamWriter 创建目录。请改用[Directory.CreateDirectory](http://msdn.microsoft.com/en-us/library/system.io.directory.createdirectory.aspx)。

如果您尝试从文件流中读取目录名称，然后根据该文本创建一个文件，您将需要如下内容：

```
FileStream fs; // this is the filestream from somewhere. make sure to dispose it
using (StreamReader r = new StreamReader(fs))
    Directory.CreateDirectory(r.ReadToEnd()); 
```

# vb.net - 当 DN 包含“/”时，“new DirectoryEntry(distinguishedName as string)”不起作用

> ID：530247
> 
> 赞同：2
> 
> 时间：2009-02-09T22:09:19.100
> 
> 标签：vb.net, active-directory, directoryservices, directoryentry, distinguishedname

我有以下代码可以将 distinctName 转换为 sAMAccountName：

```
Dim de As New DirectoryEntry("LDAP://" & stringDN)
Return CType(de.Properties("samaccountname")(0), String) 
```

它适用于我通过的每个 DN，除了一个。我们的域中有一个 AD 组，其中有一个“/” - 称之为“程序员/DBA”。该组的 DN 是“Programmers/DBA,OU=User Groups,DC=mydomain,DC=local”。当我尝试将此 DN 用作上面的 stringDN 时，我收到“未知错误 (0x80005000)”的 COMException。

我域中的所有其他组/用户都可以正常工作，并且我在我们的测试域中复制了该问题，在该域中重命名该组使其不包含“/”可以解决问题。但是，我无法在生产中做到这一点，所以我被卡住了。

我可以以某种方式逃避这个“/”吗？我必须相信有一个解决方案，这样我才能正确获得这个组的属性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-09T22:30:41.717

您是否尝试过这样做：

```
Dim de As New DirectoryEntry("LDAP://" & stringDN.Replace( "/", "\/" ))
Return CType(de.Properties("samaccountname")(0), String) 
```

# flash - ActionScript 2.0 和 ActionScript 3.0 项目

> ID：530248
> 
> 赞同：2
> 
> 时间：2009-02-09T22:09:33.373
> 
> 标签：flash, actionscript-3, actionscript-2

我正在处理一个新项目，需要一个 Flash 应用程序来加载 AS2 SWF 文件和 AS3 Flash 文件以及 FLV 电影。新的 Flash 应用程序将通过移动到主时间轴内的不同帧来控制加载的 SWF 文件。

我应该能够获得加载到 Flash 中的所有文件的源代码，但我不肯定这种情况总是会发生。根据我的阅读，您可以在 AS2 文件中创建一个桥接文件，并使用本地连接功能来控制加载的 AS2 片段。

有没有更好的方法来解决这个问题，所以我不需要使用桥接文件，或者我是否被迫获取 AS2 SWF 的源文件以在主 AS3 Flash 片段中控制它们。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T22:13:37.387

JumpEye Components.com 有一个很好的免费 AS2 桥可用：

[http://www.jumpeyecomponents.com/Flash-Components/Various/ActionScript-Bridge-91/](http://www.jumpeyecomponents.com/Flash-Components/Various/ActionScript-Bridge-91/)

使用 ASB 可以做什么？

A. 在 AS3.0 项目中使用 flash AS2.0 flash 组件。

B. 使用较旧的 AS2.0 小部件，在较新的 AS3.0 项目中使用 flash 文件。

C. 在 AS3.0 项目中使用 AS2.0 方法、函数或类，调用它们并获得返回。

从技术上讲：使用 ASB 在 Adob​​e Flash AS3.0 项目中加载 Macromedia/Adobe Flash AS2.0 项目 (swf) 并在它们之间进行通信。使用我们的 ASB API 调用函数、触发事件并获取返回变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-10-04T21:35:28.660

也许有点晚了。但以防万一其他人正在寻找它。将 AS2 与 AS3 通信的最简单方法是使用 LocalConnection，仅此而已。我希望它有所帮助。

# lisp - LISP 变量交换

> ID：530255
> 
> 赞同：7
> 
> 时间：2009-02-09T22:10:38.643
> 
> 标签：lisp, common-lisp

如何在不使用第三个变量的情况下在 LISP 中交换两个变量？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-10T01:28:27.060

```
(rotatef a b) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-09T00:33:49.580

还：

(让 ((ab) (ba)) ...)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T20:38:23.870

另一种选择，“并行 setf”：

(psetf 阿巴)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-16T19:51:44.137

还有一种方法：

```
(setf (values a b) (values b a)) 
```

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2014-02-28T18:28:41.827

相当可怕的方法，它仅适用于数值，但它更通用且不依赖于语法：

> a = a^b
> 
> b = a^b
> 
> a = a^b

假设之前分配了 a 和 b， ^ 表示逻辑排他选择。

# .net - .NET 项目使用 NAnt/MSBuild + SVN 构建自动化

> ID：530262
> 
> 赞同：4
> 
> 时间：2009-02-09T22:12:02.930
> 
> 标签：.net, svn, msbuild, build-automation, nant

很长一段时间以来，我一直试图弄清楚如何在我们的商店设置自动构建过程。我已经阅读了很多关于这个问题的帖子和指南，但没有一个真正符合我的具体需求。

我的 SVN 存储库布局如下

```
\projects
   \projectA (a product)
       \tags
           \1.0.0.1
           \1.0.0.2
           ...
       \trunk
           \src
              \proj1  (a VS C# project)
              \proj2
           \documentation 
```

然后我有一个网络共享，每个项目（产品）都有一个文件夹，其中包含每个**历史的二进制文件、书面文档和生成的 API 文档（通过 NDoc - 每个项目在存储库中可能有一个 .ndoc 文件）版本**（来自*标签*SVN 文件夹）和**最新版本**（来自*trunk*）。

基本上，我想在计划的批处理构建中执行以下步骤：

1.  检查项目的 SVN 文件夹并识别**网络共享中不存在**的*标签*
***   对于**这些标签中的每一个**
    1.  查看标签文件夹
    2.  **构建**（带有发布配置）
    3.  **将生成的二进制文件复制**到网络共享
    4.  搜索 .ndoc 文件
    5.  **通过 NDoc**生成 CHM 文件****
    ***   **将生成的 CHM 文件复制**到网络共享*****   与 2\. 中的相同，但对于*主干的 HEAD 修订*****

 ****现在，问题是，我不知道从哪里开始。我不在存储库中保留 .sln 文件，但我可以用 MSBuild 文件替换这些文件，这些文件反过来构建属于特定产品的 C# 项目。

我想最麻烦的部分是检查存储库中尚未处理的标签 - 即搜索标签并将它们与网络共享上的项目目录结构进行比较。我不知道如何在任何构建工具（NAnt、MSBuild）中做到这一点。

您能否为我提供一些关于如何整体和详细处理这项任务的指示？我不在乎我是使用 NAnt、MSBuild 还是两者兼而有之。我知道这可能相当复杂，但每个想法和 NAnt/MSBuild 片段都会有很大帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-12T21:38:18.657

在 NantContrib 中有一个 SVN 命令可以用来获取信息。您可以从 SVN 命令行运行的任何查询都应该能够使用，然后解析结果。因此，您可以进行标签搜索，将标签与网络共享上的文件夹相匹配，然后使用 svn-checkout 命令检查任何缺失的内容。完成后，为每个项目文件夹触发 msbuild 命令。

如果您想要自动构建，另一种选择是创建分支而不是标签，因为看起来您正在创建版本而不是标签。如果您创建一个分支，您可以使用 CruiseControl.net 或 TeamCity 等自动构建工具来监控您的存储库。然后，如果在 Branch 或 Trunk 上签入文件，您可以让它启动您的自动构建。

在两者之间，您应该能够处理它。如果您想要一些构建脚本的一个很好的例子，这些脚本在其中实现了文档（带有 zip 和分发的东西），请查看这里的 Castle Project：http: [//www.castleproject.org/](http://www.castleproject.org/)

他们甚至使用一些 SVN 命令来获取诸如修订号之类的东西，以及用于自动生成装配信息文件的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-16T18:43:21.460

UppercuT 可能是检查 NAnt 片段的绝佳资源。

[http://projectuppercut.org/](http://projectuppercut.org)

这里有一些很好的解释：[Uppercut](http://ferventcoder.com/category/uppercut.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T03:00:21.823

您可以让 NAnt 或 MSBuild 调用 perl 或其他一些脚本语言脚本来检查 svn 存储库并进行结帐吗？如果您也可以从命令行运行构建，那么听起来其他所有内容都只是更多的脚本。

# php - javascript 或 php - 什么是最有效的更新？

> ID：530272
> 
> 赞同：3
> 
> 时间：2009-02-09T22:15:50.317
> 
> 标签：php, javascript, ajax

我在一个 javascript 文件中有几个更新方法，用于更新我的 ajax 应用程序，如下所示：

```
function updateByPk(layer, pk) {
   url = "get_auction.php?cmd=GetAuctionData&pk="+pk+"&sid="+Math.random();
   update(layer, url);
}

function updateByQuery(layer, query) {
   url = "get_records.php?cmd=GetRecordSet&query="+query+"&sid="+Math.random();
   update(layer, url);
}

function updateByPage(layer, query, pg) {
   url = "get_records.php?cmd=GetRecordSet&query="+query+"&pg="+pg+"&sid="+Math.random();
   update(layer, url);
} 
```

我想知道通过简单地重新加载页面而不是使用 ajax 方法来执行诸如分页之类的事情是否会更有效。我不确定哪种方法更有效，或者每种方法是否有优缺点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T22:24:17.253

具有 AJAX 优势的分页：

*   传输的数据可能更少，这意味着更快的页面加载和更少的带宽使用。
*   更流畅的用户体验

没有 AJAX 的分页优势：

*   后退和前进按钮将在浏览器中工作
*   您可以拥有特定页面的 URL（尽管您也可以通过 page.php#pagenumber 技巧使用 AJAX 执行此操作）
*   也许更容易编写和维护

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T22:23:23.713

如果我得到这个问题，那么您是在问分页和类似内容是否更好地通过 Javascript + AJAX 完成，或者通过调用服务器来完成？

我个人会说只使用对服务器的请求。在这种情况下，AJAX 是不必要的，除了“bling”因素（是的，这是一个技术术语：P）

如果您在考虑可访问性的情况下正确编写应用程序，则无论如何都应该编写“直接调用服务器”位（因为当有人关闭 Javascript 并单击您的“下一页”链接之一时。

拥有 Javascript 意味着 1) 您需要维护额外的代码。2）你打破了后退按钮。如果只实现 AJAX 方法，则无法访问其他页面上的数据。如果你这样做，你没有简单的方法链接到它（通过复制地址栏）。

我个人只会将 AJAX 用于将向页面添加功能的事情，而不会带走任何其他功能，例如，在填写注册表单时检查是否使用了用户名。自动建议等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T22:23:31.157

Ajax 在客户端和服务器上会更容易。客户端不会重置他们的滚动，不必检查所有新资产，如样式表和图像，并且加载速度会更快。服务器不必生成带有页眉和页脚的整个页面；它只需要生成页面中发生变化的部分。

缺点是使用良好的 UI 编写代码有点困难（添加加载微调器和相关的装饰物）。如果客户端禁用了 javascript，您的页面会中断。所以真的，如果你做ajax，你需要两者。不过，为 Ajax 编写优雅的降级代码很容易。

```
<a href="/search?term=foo&amp;page2" onclick="loadPageViaAjax(2); return false">
  Next
</a> 
```

这是一个即使没有 javascript 也可以工作的链接示例。如果 javascript 开启，onclick 被触发，ajax 发生并且它停止跟随带有`return false`. 如果没有 javascript，onclick 将被忽略，并且链接正常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T22:26:54.313

这取决于您对效率的定义。通过 AJAX 加载新内容将减少通过网络传输的字节数，但如果您无法将动态内容缓存到静态文件中（我假设您在重新加载页面时会这样做），则在您的服务器上可能会更加费力。但是，过度依赖 AJAX 可能会导致浏览器不支持 javascript（它们存在）的用户无法访问您的页面，并且可能会损害您的网站被搜索引擎索引的能力。两全其美的方案是让链接指向重新加载的页面，但使用 javascript 覆盖该行为以通过 AJAX 加载新内容。

# leader - 团队领导类型：更多程序员 || 更多！程序员

> ID：530273
> 
> 赞同：9
> 
> 时间：2009-02-09T22:15:50.457
> 
> 标签：leader

昨天我让另一个团队的团队负责人说他们花了一段时间才弄清楚我在 wiki 页面上写的东西，因为我将从源代码管理中获取代码称为“签出”，这显然让他们感到困惑。他们说他们习惯了Clear Case，只听说过“加入一个项目”这个词，并表示他们已经很长时间没有真正编程过。

虽然这很好，但它让我想到了这些年来我所拥有的不同类型的团队领导。我有一些几乎纯粹是管理的，我也有一些同时做管理事情的程序员。

人们是否对他们拥有什么样的团队领导有偏好？您如何关心您的团队负责人是否积极参与您的产品开发？我发现像团队其他成员一样坐下来编写代码的团队领导更有可能理解以下内容（根据我的经验）：

*   事情并不总是听起来那么简单。我遇到的不写代码或很少写代码的团队领导认为，一切都是小菜一碟，根本不应该花太多时间（如果你想把它一起破解，可能就是这种情况）
*   他们更了解开发人员并不总是喜欢参加长时间的会议，并尽最大努力避免让他们的团队参加尽可能多的毫无意义的会议
*   他们从技术角度理解你所说的。那些可能有一段时间没有编码的人可能不会跟上许多新技术、技巧或术语的步伐

我发现拥有一个具有开发人员思维并喜欢在代码中亲自动手的团队领导者会更令人满意。也许有些人喜欢团队领导，他们远离事物的实际编码方面，只是简单地分配工作，或者可能是我没有提到的另一种类型的团队领导？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-09T22:20:53.970

团队领导者必须是编码员——除非团队尊重他们并且他们将每个人带到哪里，否则他们无法*领导团队。*

另一方面，团队*经理可以是编码员，也可以是组织良好且知道何时提出问题并与其他管理层互动的人。*

可以在同一个人身上找到经理和领导者，但更多时候角色（应该）是分开的和不同的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T22:28:39.943

我没有偏好，我不能，我必须和他们所有人一起工作，即使太多的厨师会破坏肉汤。在一个多开发人员的典型项目中，我有一个技术主管、项目经理和一个非技术客户。当然，部门和项目管理人员会各司其职。

领导者有多种类型，每种类型都有自己的特点：

**非技术客户：** *“客户永远是对的。”* 经常想要一个棍子上的月亮。将呼叫管理和技术团队，并将最佳答案视为福音。

**团队经理/直线经理：**有点牧师角色。对我现在正在做的项目不是特别感兴趣。在项目优先级之间做出决定时介入。可能真的很想成为一名编码员，并将他能做的所有其他工作委托给他的下属。

**项目经理：**不同程度的技术知识。只关心时间尺度和成本。不明白，“不知道要多久，我先玩几天感受一下。”

**团队负责人/技术负责人：**只是另一个开发人员，但有更多经验。负责将影响整个项目的技术决策。经常与项目经理争吵以进行良好的工程实践，即使在短期内需要更长的时间。

**团队领导/美化秘书：**应该领导团队，但更像是秘书的人。（通常比团队高一个档次）。接听电话，将客户与技术机构隔离开来。这很好用，直到他们提出一个技术问题，荣耀的秘书试图吹嘘自己的出路，最终他们围绕着秘书工作并直接与团队交谈。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-09T22:21:56.697

您应该阅读《[管理人类](https://rads.stackoverflow.com/amzn/click/com/159059844X)》一书。我的意见是经理们应该把手放在代码之外。他们有更重要的责任，比如让人们远离开发人员，这样他们就可以完成他们的工作。让他们投入开发会造成混乱，因为他们不足以了解正在发生的事情，并且他们的时间在这和其他事情之间分配，因此很难指望他们提供主要功能。另外，当你不得不告诉你的经理他们刚刚写的东西需要改变时，这真的很糟糕，你必须回去重做。经理真的是他们为团队的其他成员跳上手榴弹，所以他们可以专注于完成手头的任务。

话虽如此，经理应该了解软件工程吗？是的，他们当然应该，这就是他们所在的领域。应该知道如何使用最新和最伟大的奇思妙想技术进行编码？只要他们了解软件开发的工作原理，这并不重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T22:29:11.517

我们通常有一名 PM（非技术人员）从管理员那里管理项目。观点和技术负责人，负责管理技术方面并为团队提供技术领导。

技术主管将编写项目的部分代码，并且可能是“概念验证”阶段的主要（唯一）开发人员。

在一些较小的项目中，他们是同一个人，但这是一种罕见的组合。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-09T22:56:03.107

与我共事过的绝对最差的软件主管/首席软件工程师是那些想要密切参与技术细节的人。太多重要的任务要么错过了，要么没有完成。管理团队是一项全职工作。如果领导想涉足技术方面，那肯定会以牺牲管理方面为代价。

在我认为值得的数十名中，我只有 2 名软件主管/首席软件工程师。虽然两人以前都是软件工程师，但对他们来说，那些日子早已一去不复返了。他们知道。他们甚至没有试图伪装。他们现在的工作是管理。他们的工作是确保开发人员有机会成功。他们尽最大努力消除所有障碍，确保每个人都在进步。

我有一个理论，但从未在实践中看到过，最好的软件领导者应该不是软件开发人员，也不是软件开发人员。他们专注于真正的管理精神，特别是作为促进者的精神。不幸的是，大多数经理更有政治动机，或者只是在工作，因为他们在技术上已经达到了顶峰。

# c# - 内存管理 - 我是否应该担心在状态机中调整临时长寿命对象数组的大小？

> ID：530274
> 
> 赞同：2
> 
> 时间：2009-02-09T22:15:55.260
> 
> 标签：c#, .net, arrays, memory-management

.NET 中的垃圾收集使许多人相信轻量级对象可以被视为临时对象。这对于包含对在数组初始化上下文之外实例化的对象的对象引用的数组来说尤其如此。

因此，如果在状态机的迭代中初始化新数组似乎并不重要，特别是如果该状态以任何方式阻塞，例如调用`WaitHandle.WaitAny()`.

我宁愿动态创建一个新数组作为轻量级容器来保存我的 WaitHandle 对象，而不是`WaitHandle[]`使用`Array.Resize<T>()`.

为什么？好吧，假设内存很便宜，并且`Array.Resize<T>()`无论如何都必须执行内存分配或某种内存副本，那么通过每次将新数组传入静态方法来简单地隐式丢弃数组似乎更有效，如下所示：

```
// using C# 3.0 array initialization syntax
eventIndex = WaitHandle.WaitAny(new[] { _stateStopEvent }, 5000); 
```

（查看此[链接](http://kozmic.pl/archive/2008/02/22/c-tricks-array-initialization-in-c-3.0.aspx)以获取有关数组语法的详细信息）

`_stateStopEvent`是可能适用于任何或所有状态的几个潜在事件之一，并且这些 ManualResetEvent 对象在更高的范围内声明，因此看起来管理数组实际上比它的价值更多。

此外，如果代码为数组声明一个临时引用变量，并在状态机的每次迭代中简单地为其分配一个新的数组实例，那么从性能的角度来看有什么区别？为什么不直接跳过上面代码片段所示的那一步呢？

使用调整`WaitHandle[]`数组大小是`Array.Resize<T>()`一种更好的方法吗？

将 byte[] 数组从图片中取出，如果我需要调整数组的大小，我不会像这里推荐的那样使用 List 或 Dictionary 实例[吗](https://stackoverflow.com/questions/434761/array-versus-listt-when-to-use-which)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-09T23:49:09.593

这就是 Array.Resize 所做的：

```
[ReliabilityContract(Consistency.WillNotCorruptState, Cer.MayFail)]
public static void Resize<T>(ref T[] array, int newSize)
{
    if (newSize < 0)
    {
        throw new ArgumentOutOfRangeException("newSize", Environment.GetResourceString("ArgumentOutOfRange_NeedNonNegNum"));
    }
    T[] sourceArray = array;
    if (sourceArray == null)
    {
        array = new T[newSize];
    }
    else if (sourceArray.Length != newSize)
    {
        T[] destinationArray = new T[newSize];
        Copy(sourceArray, 0, destinationArray, 0, (sourceArray.Length > newSize) ? newSize : sourceArray.Length);
        array = destinationArray;
    }
} 
```

所以除了一些范围检查之外，它只是创建一个新数组并将元素从前一个数组复制到新数组。

# c - Windows下用cygwin编译的C程序，Linux下的segmentation fault。cygwin GCC“坏”吗？

> ID：530278
> 
> 赞同：14
> 
> 时间：2009-02-09T22:16:38.053
> 
> 标签：c, gcc, cygwin

对于我的 Programming 102 课程，我们被要求提供可在 Linux 下编译和运行的 C 代码。我的硬盘上没有足够的空闲空间来安装 Linux 和 Windows，所以我使用 cygwin 来编译我的程序。

我必须提供的最新程序在 cygwin 下编译并运行良好。它在 Linux 下编译良好，但执行到一半会产生分段错误。我向给我们上课的研究生解释了这一点，他说 cygwin 的 GCC 版本允许编译和执行更草率的代码。

我通过谷歌找到的少数参考资料还没有定论。我发现的一个线程说Linux下seg错误的原因是内存泄漏。为什么这不会影响 cygwin 版本？

我会使用大学的计算机，但我不能在它们上使用 Subversion，这会严重阻碍我的努力。（我是编码新手，经常需要能够恢复到 X 之前的版本）。

cygwin 的 GCC 版本对它编译的代码真的更“宽松”吗？如果是这样，编码时是否有任何明显的问题需要注意？有没有其他方法可以编写在 Linux 下运行的代码？

**编辑**

感谢您的回复。我在原始帖子中不够明确：我的代码中有一个错误对我来说几乎是给定的（我对编程很陌生，毕竟在谈到 C 时真的很绿色）。我的 TA 暗示 cygwin 的 GCC 是一个不太可靠的编译器 - 允许运行更草率的代码 - 比在 GNU/Linux 下找到的编译器要低。我发现这很奇怪，所以在互联网上进行了搜索，但实际上找不到任何关于该事实的参考资料。

除了将编译器与我的代码归咎于我之外，我还想知道程序在 Windows 下运行并在 Linux 下崩溃的原因是什么。回复：Windows/Linux 下的不同内存管理器和堆/堆栈布局在这方面进行了说明。

cygwin 的 GCC 与 GNU/Linux 一样“好”的结论会不会非常正确？

关于发布源代码，这是一项家庭作业，所以如果可能的话，我宁愿自己找到问题:)

**编辑 2**

我已经接受了 jalf 的回答，因为它谈到了是什么让程序在 Windows 下而不是在 Linux 下运行，这是我真正想知道的。感谢所有做出贡献的其他人，他们都是非常有趣且内容丰富的回复。

当我发现问题并修复它时，我将上传一个包含这个非工作版本的所有源代码的 zip 文件，以防有人好奇我到底做了什么:)

**编辑 3**

对于那些有兴趣看代码的人，我发现了问题，并且确实是由于指针。我试图从函数返回一个指针。我试图返回的指针是在函数内部声明的，所以一旦函数执行就被销毁。有问题的代码在第 22-24 行被注释掉。

随意嘲笑我的代码。

```
/**
*  Returns array of valid searches based on current coordinate
*/
void determine_searches(int row, int col, int last_row, int last_col, int *active_search){
    // define coordinate categories and related valid search directions
    int Library0[] = {2, 3, 4, -1};
    int Library1[] = {4, 5, 6, -1};
    int Library2[] = {2, 3, 4, 5, 6, -1};
    int Library3[] = {0, 1, 2, 3, 4, 5, 6, 7, -1};
    int Library4[] = {0, 1, 2, -1};
    int Library5[] = {0, 6, 7, -1};
    int Library6[] = {0, 1, 2, 6, 7, -1};
    int Library7[] = {0, 1, 2, 3, 4, -1};
    int Library8[] = {0, 4, 5, 6, 7, -1};

    int * Library[] = { 
        Library0, Library1, Library2,
        Library3, Library4, Library5,
        Library6, Library7, Library8,
    };

    // declare (and assign memory to) the array of valid search directions that will be returned
    //int *active_search;
    //active_search = (int *) malloc(SEARCH_DIRECTIONS * sizeof(int));

    // determine which is the correct array of search directions based on the current coordinate
    // top left corner
        int i = 0;
    if(row == 0 && col == 0){
        while(Library[0][i] != -1){
            active_search[i] = Library[0][i];
            i++;
        }
    }
    // top right corner
    else if(row == 0 && col == last_col){
        while(Library[1][i] != -1){
            active_search[i] = Library[1][i];
            i++;
        }
    }
    // non-edge columns of first row
    else if(row == 0 && (col != 0 || col != last_col)){
        while(Library[2][i] != -1){
            active_search[i] = Library[2][i];
            i++;
        }
    }
    // non-edge coordinates (no edge columns nor rows)
    else if(row != 0 && row != last_row && col != 0 && col != last_col){
        while(Library[3][i] != -1){
            active_search[i] = Library[3][i];
            i++;
        }
    }
    // bottom left corner
    else if(row == last_row && col == 0){
        while(Library[4][i] != -1){
            active_search[i] = Library[4][i];
            i++;
        }
    }
    // bottom right corner
    else if(row == last_row && col == last_col){
        while(Library[5][i] != -1){
            active_search[i] = Library[5][i];
            i++;
        }
    }
    // non-edge columns of last row
    else if(row == last_row && (col != 0 || col != last_col)){
        while(Library[6][i] != -1){
            active_search[i] = Library[6][i];
            i++;
        }
    }
    // non-edge rows of first column
    else if((row != 0 || row != last_row) && col == 0){
        while(Library[7][i] != -1){
            active_search[i] = Library[7][i];
            i++;
        }
    }
    // non-edge rows of last column
    else if((row != 0 || row != last_row) && col == last_col){
        while(Library[8][i] != -1){
            active_search[i] = Library[8][i];
            i++;
        }
    }
    active_search[i] = -1;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-09T22:21:20.647

我并不是说听起来粗鲁，但可能是你的代码不好，而不是编译器。;) 这样的问题实际上比你想象的更常见，因为不同的操作系统和编译器将有不同的方式来组织你的应用程序在堆栈和堆中的数据。前者可能特别成问题，特别是如果您最终覆盖堆栈上的内存，或者引用系统决定用于其他用途的已释放内存。所以基本上，有时你可能会侥幸逃脱，但有时你的应用程序会窒息而死。无论哪种方式，如果它出现段错误，那是因为您试图引用不允许的内存，所以它没有在另一个系统/编译器下崩溃更像是一个“幸运的巧合”。

但实际上，段错误就是段错误，因此您应该调试代码以查找内存损坏，而不是调整编译器的配置以找出问题所在。

**编辑**：好的，我明白你现在的意思了......我以为你是用“X 很糟糕，但 Y 工作得很好！”来解决这个问题的。态度，但似乎是你的TA得到了那个。;)

无论如何，这里有一些调试问题的提示：

*   寻找指针算术，引用/取消引用可能的“doh！” 错误。您添加/减去一个（又名，fencepost 错误）的任何地方都特别值得怀疑。
*   注释掉问题区域周围对 malloc/free 的调用，以及使用这些指针的任何相关区域。如果代码停止崩溃，那么您正朝着正确的方向前进。
*   假设您至少确定了代码崩溃的一般区域，请在其中插入早期返回语句并找到代码不会崩溃的点。这有助于在该点和代码实际崩溃的*地方*之间找到一个区域。请记住，像这样的段错误不一定会直接发生在您的错误所在的代码行。
*   使用系统上可用的内存调试工具。
    *   在 Unix 上，查看[本指南以在 unix 上调试内存](http://www.linuxjournal.com/article/4681)，以及[valgrind 分析器](http://www.valgrind.org)（@Sol，谢谢提醒我这个）
    *   在 Visual Studio/Windows 上，你的[好伙伴 CrtCheckMemory()](http://msdn.microsoft.com/en-us/library/e73x0s4b(VS.71).aspx)非常方便。另外，请阅读[CRT 内存调试模式](http://www.nobugs.org/developer/win32/debug_crt_heap.html)，因为它们是在 VS 中工作的更好功能之一。通常，一旦你记住了各种模式，只需在 VS 中打开一个内存选项卡就足以诊断出这样的错误。
    *   在 Mac OSX 中，您可以在 malloc_error_break（来自 gdb 或 Xcode）上设置断点，这会导致调试器在 malloc 检测到内存损坏时中断。我不确定这是否适用于其他 unix 风格，但快速的谷歌搜索似乎表明它仅限于 mac。[此外，对于 OSX 似乎存在](http://www.sealiesoftware.com/valgrind/)一个相当“实验性”的 valgrind 版本。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-10T01:37:26.463

就像其他人所说的那样，您可能想在此处发布一些代码，即使这不是您问题的真正重点。让这里的每个人浏览您的代码并查看他们是否能找到导致段错误的原因可能仍然是一个很好的学习体验。

但是，是的，问题在于影响 C 程序的因素太多了，依赖于平台，而且基本上是随机的。虚拟内存意味着*有时*，访问未分配的内存似乎会起作用，因为您遇到了在较早时间分配的页面的未使用部分。其他时候，它会出现段错误，因为您点击了一个根本没有分配给您的进程的页面。这真的是无法预测的。这取决于您的内存分配在哪里，是在页面边缘还是在中间？这取决于操作系统和内存管理器，以及到目前为止已经分配了哪些页面，以及......你明白了。不同的编译器、相同编译器的不同版本、不同的操作系统、系统上安装的不同软件、驱动程序或硬件，无论您访问未分配内存时是否出现段错误，任何事情都可能发生变化。

至于 TA 声称 cygwin 更“宽松”，这是垃圾，原因很简单。两个编译器都没有发现这个错误！如果“本机”GCC 编译器真的不那么松懈，它会在编译时给你一个错误。段错误不是由编译器生成的。编译器无法确保您获得段错误而不是看似有效的程序。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-09T22:20:39.290

我没有听说过 Cygwin 下关于 GCC 怪异的任何具体信息，但在你的情况下，使用 gcc 的 -Wall 命令行选项来显示所有警告可能是个好主意，看看它是否找到任何可能导致代码中的段错误。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-09T22:23:09.347

您的代码中肯定有错误。Windows 内存管理器可能比 Linux 内存管理器更宽松。在 Windows 上，您可能会在内存方面做坏事（如覆盖数组边界、内存泄漏、双重释放等），但它会让您侥幸逃脱。与此相关的一个著名故事可以在[http://www.joelonsoftware.com/articles/APIWar.html](http://www.joelonsoftware.com/articles/APIWar.html)（在那篇（有点长的）文章上搜索“SimCity”）。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-09T22:21:37.277

Cygwin 的 gcc 版本可能有其他默认标志和调整设置（例如 wchar_t 为 2 个字节），但我怀疑它对代码特别“松懈”，即使如此 - 你的代码不应该崩溃。如果是这样，那么很可能您的代码中存在需要修复的错误。例如，您的代码可能取决于 wchar_t 的特定大小，或者可能执行根本无法保证工作的代码，例如写入字符串文字。

如果您编写干净的代码，那么它也可以在 linux 上运行。我目前正在运行 firefox 和 KDE 桌面，它们一起由数百万行 C++ 行组成，我没有看到这些应用程序崩溃:)

我建议您将代码粘贴到您的问题中，以便我们查看问题所在。

同时，您可以在`gdb`linux 调试器中运行您的程序。您还可以在启用所有挡泥板检查并启用所有警告的情况下进行编译。mudflaps 在运行时检查您的代码是否存在各种违规行为：

```
[js@HOST2 cpp]$ cat mudf.cpp
int main(void)
{
  int a[10];
  a[10] = 3;  // oops, off by one.
  return 0;
}
[js@HOST2 cpp]$ g++ -fmudflap -fstack-protector-all -lmudflap -Wall mudf.cpp
[js@HOST2 cpp]$ MUDFLAP_OPTIONS=-help ./a.out
  ... showing many options ...
[js@HOST2 cpp]$ ./a.out 
*******                 
mudflap violation 1 (check/write): time=1234225118.232529 ptr=0xbf98af84 size=44
pc=0xb7f6026d location=`mudf.cpp:4:12 (main)'                                   
      /usr/lib/libmudflap.so.0(__mf_check+0x3d) [0xb7f6026d]                    
      ./a.out(main+0xb9) [0x804892d]                                            
      /usr/lib/libmudflap.so.0(__wrap_main+0x4f) [0xb7f5fa5f]                   
Nearby object 1: checked region begins 0B into and ends 4B after                
mudflap object 0x9731f20: name=`mudf.cpp:3:11 (main) int a [10]'                
bounds=[0xbf98af84,0xbf98afab] size=40 area=stack check=0r/3w liveness=3        
alloc time=1234225118.232519 pc=0xb7f5f9fd                                      
number of nearby objects: 1                                                     
*** stack smashing detected ***: ./a.out terminated                             
======= Backtrace: =========
.... 
```

您可以执行许多挡泥板检查，上面使用默认选项运行 a.out。另一个有助于解决此类错误的工具是`valgrind`，它还可以帮助您找到泄漏或因上述错误而关闭。将环境变量“MALLOC_CHECK_”设置为 1 也会打印违规消息。`malloc`有关该变量的其他可能值，请参见手册页。

要检查程序崩溃的位置，您可以使用`gdb`：

```
[js@HOST2 cpp]$ cat test.cpp
int main() {
    int *p = 0;
    *p = 0;
}
[js@HOST2 cpp]$ g++ -g3 -Wall test.cpp
[js@HOST2 cpp]$ gdb ./a.out
...
(gdb) r
Starting program: /home/js/cpp/a.out

Program received signal SIGSEGV, Segmentation fault.
0x080483df in main () at test.cpp:3
3           *p = 0;
(gdb) bt
#0  0x080483df in main () at test.cpp:3
(gdb) 
```

使用 -g3 编译代码以包含许多调试信息，因此 gdb 可以帮助您找到程序崩溃的精确行。所有上述技术同样适用于 C 和 C++。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-09T22:35:21.203

这几乎可以肯定是指针错误或缓冲区溢出，可能是未初始化的变量。

未初始化的指针通常不会指向任何东西，但有时它会指向某个东西；读取或写入它通常会使程序崩溃，但它可能不会。

从释放的记忆中写作或阅读是同一个故事。你可能会侥幸逃脱，然后又可能不会。

这些情况取决于堆栈、堆的布局方式以及运行时在做什么。很可能制作一个在一个编译器/运行时组合而不是另一个编译器/运行时组合上工作的坏程序，仅仅是因为它覆盖了一些无关紧要的东西（这么多），或者一个未初始化的变量“发生”包含一个有效的使用它的上下文的值。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-09T22:21:36.497

GCC 的版本可能不是问题。更有可能是运行时库中的差异和代码中的错误，当针对 Windows 版本的运行时运行时，该错误不会表现出来。如果您想要更具体的答案，您可能想要发布段错误的代码和更多背景信息。

一般来说，最好在您将用于运行代码的环境下进行开发。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-09T22:28:23.903

您是否做出任何特定于平台的假设，例如[数据类型](http://en.wikipedia.org/wiki/Data_type)的大小、 s中的[数据结构对齐](http://en.wikipedia.org/wiki/Data_structure_alignment)`struct`或[字节序](http://en.wikipedia.org/wiki/Endianness)？

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-09T22:39:26.077

分段错误意味着您尝试访问无法访问的内存，这通常意味着您尝试取消引用空指针或双重删除内存或获得野指针。有两个原因可以说明您在 cygwin 而不是 Linux 上似乎很好：要么是内存管理器的问题，要么您在其中一个上比另一个更幸运。几乎可以肯定你的代码有错误。

要解决此问题，请查看您的指针使用情况。考虑用智能指针代替原始指针。考虑在之后立即搜索删除并将指针归零（尝试删除空指针是安全的）。如果你能破解 Linux，尝试通过 gdb 获取堆栈跟踪，看看它发生的那一行是否有任何明显的错误。检查您如何使用所有未初始化的指针。如果您可以访问内存调试工具，请使用它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-09T22:49:18.003

一些提示：

1.  发布您的代码。我敢打赌你会得到一些好的输入，这将使你成为一个更好的程序员。

2.  使用该选项打开警告`-wall`并更正报告的任何问题。同样，它可以帮助您成为更好的程序员。

3.  使用调试器单步执行代码。除了帮助您了解问题所在之外，它还将帮助您成为更好的程序员。

4.  继续使用 Subversion 或其他源代码控制系统。

5.  在确定您已经确定问题所在之前，切勿责怪编译器（或操作系统或硬件）。即便如此，也要怀疑自己的代码。

* * *

Linux 上的 GCC 的源代码与 Cygwin 上的 GCC 相同。由于 Cygwin POSIX 仿真层和底层 Windows API，平台之间存在差异。额外的层可能比底层硬件更宽容，但这不能指望。

由于这是家庭作业，我会说发布代码是一个更好的主意。有什么比从专业程序员那里获得输入更好的学习方式呢？但是，我建议您在附近的评论中记录您实施的任何建议。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-10T01:52:06.833

分段错误是在不存在（或先前已释放）的地址访问内存的结果。我发现非常有趣的是代码在 cygwin 下没有段错误。这可能意味着您的程序使用了指向其他进程地址空间的野指针并且实际上能够读取它（喘气），或者（更有可能）直到程序在 Linux 下运行才到达实际导致段错误的代码.

我推荐以下内容：

1.  粘贴您的代码，因为这是一个非常有趣的问题
2.  将此副本发送给 cygwin 开发人员
3.  如果您需要制作更多在 Linux 下运行的程序，请购买便宜的 Linux VPS，它会让您的生活更轻松。

一旦您在 Linux 下工作（即，在您的 VPS 中运行），请尝试使用以下程序：

*   广发银行
*   瓦尔格林德
*   跟踪

此外，您可以尝试使用诸如电子围栏之类的库来捕捉程序运行时发生的这类事情。

最后，确保将 -Wall 传递给 gcc，您需要它传达的警告。

# language-agnostic - 从其他网站获取代码和设计。盗版还是标准？

> ID：530280
> 
> 赞同：10
> 
> 时间：2009-02-09T22:17:11.327
> 
> 标签：language-agnostic

在设计我的网站时，我经常面临是否可以从其他网站获取想法和设计的问题。在某些情况下，某些方面没有区别。这有什么道德问题吗？这是设计编程社区的预期吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-09T22:19:35.970

**取决于你“偷”了多少。**

*代码*

如果你在扯掉整个设计，那么它有点狡猾。如果你喜欢（例如）Stack Overflow 投票的概念，那么就窃取这个概念并以不同的方式使用它。如果您想知道投票项目的橙色突出显示是如何工作的，请查看代码。但不要两者兼而有之，同时窃取概念和设计，您只会创建一个克隆。

由于不同的 Web 浏览器处理 CSS 等的方式，通常只有极少数有限的方式来做特定的事情（3 列布局等）。在这些有共同做事方式的情况下，公然抄袭似乎是公平的。如果它是独一无二的，并且有很多方法可以做到这一点，那么公然复制似乎有点过分。

*图形*

扯掉图形 - 不太好。图像的存在时间比代码长得多，因此版权法等可能更适合它们。如果不出意外，您必须处理可能的水印或其他元数据来识别原始来源。检查图像窃取非常容易，对于较大块内的代码则不然。

我是一名编码员，而不是设计师，所以我倾向于借用我喜欢的图形，同时模拟我的网络应用程序供内部使用。这看起来公平吗？我会在上线之前将它们更改为新设计或付费的。至少是这样的想法，尽管它可能太容易忘记和意外使用它们。

这就是它在报纸世界中的工作方式（过去是这样，现在不确定随着互联网的出现）：您可以下载尽可能多的图形，等待您的 57.6k 调制解调器过来；您只需为实际发布的内容付费。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-09T22:32:18.437

哦，这是一个很难的问题。
一方面偷窃是错误的，另一方面你有义务通过快速解决任务来节省雇主的钱。

我唯一的建议是： *如果你的直觉感觉不对，你可能偷了太多东西。*

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-09T22:28:38.367

我认为大多数设计师和开发人员都将源自他人作品的“创意灵感”与公然抄袭区分开来。我不会三思而后行，看看有人如何做了一个特别漂亮的 javascript 效果，或者优雅地实现了一段棘手的 css，但我发现公然剪切和粘贴相同的代码以用于我自己的发展。

我不是通过抓取和重用来学习任何东西——尽管我认为拥有相同的代码作为粗略的脚手架来探索我自己的实现方式是相当标准的。我想这就是很多人的工作方式。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-09T22:26:01.213

我是一名网络开发人员，而不是设计师。因此，我有品味，但没有能力完全靠自己想出一些东西。作为道德问题，所有商业或我所做的严重交通的期望，我都会聘请一名设计师。他们也需要吃饭，从别人的工作中赚钱而不给他们报酬是有问题的。

如果它是小型的、个人的或内部一次性类型的东西，我会撕掉诸如配色方案和/或布局之类的东西。从技术上讲，您可以说这是偷窃，但我认为它更像是“模仿是最真诚的奉承形式”。我对此并没有感到那么糟糕，因为它真的没有任何钱可赚。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-09T22:24:08.673

我认为可以窃取想法，但不能窃取代码。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-09T22:29:11.860

很多设计都是这样完成的。除了它被许多电梯所掩盖，而不是一个批发电梯。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-09T22:33:22.583

如果没有特别标记为免费/开放/创意公共/等，窃取资源（图形、代码）并不是很好。如果您只是使用自己的代码复制相同的布局，那么窃取设计和布局有点粗略——使用别人的设计作为起点是一回事，但不要只是逐字重现他们的设计。窃取特定功能的代码片段很好（恕我直言），因为即使您从头开始学习参考手册，您最终也会得到相同的结果。（想想：用于更改鼠标悬停按钮图像的 javascript）

说了这么多，模仿是最真诚的奉承。不要窃取资源，但使用其他网站作为“影响力”应该是可以的。或者，如果有疑问，请询问您打算用作参考/影响的网站的所有者。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-10T00:18:20.660

几乎每个回答这个问题的人都忘记了在 1995 年到 2002 年左右使用网页是什么感觉。在那个时期，偷窃是无数设计师的生活方式。关键是，现在仍然是，只取你需要的东西，并确保你足够了解它，以便下次从头开始。谁知道呢，你可能会在这个过程中改进一些东西。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-10T00:18:34.390

我曾经听说过一句老话： **优秀的设计师创造。 *伟大的*设计师偷窃。**

尽管如此，如果你能避免的话，你永远不应该公然撕掉代码。查看它，理解它，重写它（或改进它，如果可能的话；即使它只是使用你发现的更好的变量名），但不要只是复制和粘贴。布局也是如此；采用布局并对其进行修改以满足您的需求 - 它可能最终看起来相似（就 UI 而言，看看所有 Basecamp 风格的克隆），这没什么大不了的；很多网站看起来很相似。关键是要进入情况寻找**灵感**，而不是一些代码。如果您可以按原样使用代码或稍加修改，那么您确实没有问题，但您不应该打算找到其他人的代码并将其撕掉。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-09T22:26:39.853

这是一个滑动的规模。仅仅借用一个想法是一回事，如果你将它整合到现有设计的其余部分中，而不仅仅是批发复制一个想法。抓住一个设计元素的想法很好，完全复制整个设计不是。当你借用越来越多的设计时，它就会进入不可接受的类别。直接复制也是另一个因素。如果您看到自己喜欢的东西并自己重新实现它，那通常很好。但是直接复制代码、图像或 css 并没有那么多。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-09T22:47:51.207

在大多数情况下，想法很容易接受和实施。如果人们不能接受现有的想法并扩展或重新实施它们，我们将永远无法走出黑暗时代。

如果您觉得有必要窃取代码，因为您不能很好地编写 HTML/CSS 代码或没有设计眼光，请从明确允许您使用他们的设计/代码的地方窃取代码，例如[OSWD](http://www.oswd.org/)。一般来说，窃取 HTML 是可以的，但大量窃取 CSS 是不行的。仅仅因为您可以轻松查看 CSS 源代码并不意味着只需复制和粘贴即可。

不要窃取图形，期间。尤其是照片、徽标和图标之类的东西。如果您需要这种东西，请购买图库摄影或拍摄自己的照片。

如有疑问，请询问网站所有者。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-09T22:56:50.763

窃取代码或设计是不道德的，在某些情况下是非法的。

获取灵感或复制功能不是问题。例如，在某个时间点，有人意识到输入“忘记密码？” 所有登录表单旁边的链接是个好主意，现在每个人都这样做了。这不是盗窃，它只是复制一个好主意。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-10T01:38:34.183

我不是网络开发人员，但我可能有一些见解也会有所帮助。我的团队创建了几个应用程序，作为交付给不同客户的其他应用程序的起点。

成功的衍生产品是开发人员花时间学习架构以及为什么事情会这样的衍生产品。然后，他们采用了更硬的部分并重写了它们，并且总体上扩展和改进了架构。

总是，当一个团队只是简单地采用现有项目并试图为它“品牌化”或为客户复制它而没有真正弄清楚系统时，他们要么创建了糟糕的扩展实现，要么让项目彻底失败。

我意识到这与其他人在这里解决的道德问题的主题有点偏离，但我的底线是，纯粹的盗窃通常会花费您更多的时间而不是节省的时间。

# c# - 使用 Enum.Parse() 时出现意外结果

> ID：530281
> 
> 赞同：3
> 
> 时间：2009-02-09T22:17:27.270
> 
> 标签：c#, enums, parsing

```
class Program
{
    static void Main(string[] args)
    {
        String value = "Two";
        Type enumType = typeof(Numbers);
        Numbers number = (Numbers)Enum.Parse(enumType, value);
        Console.WriteLine(Enum.Parse(enumType, value));
    }

    public enum Numbers : int
    {
        One,
        Two,
        Three,
        Four,
        FirstValue = 1
    }
} 
```

这是我在应用程序中使用的枚举的简化版本。一些枚举名称没有值的原因是因为我使用它们的名称作为参数执行 Enum.Parse，而具有值的那些是从 int 解析的。

如果您单步执行上面的代码并调查“数字”变量，您会发现它实际上是“二”，但控制台中的输出是“第一值”。在这一点上，我不明白为什么，你呢？

好的，解决方案很简单——只需给无价值的枚举一个值。但我还是很好奇。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-09T22:21:26.403

我怀疑两者`FirstValue`的`Two`内部值都为 1，因此系统不知道要输出哪个字符串。

```
public enum Numbers : int
{
    One, // defaults to 0
    Two, // defaults to 1
    Three, // defaults to 2
    Four, // defaults to 3
    FirstValue = 1 // forced to 1
} 
```

每个枚举值都有一个唯一的整数值，但不是每个整数值都有一个唯一的枚举值。

解析`"two"`时，它会在内部存储为整数`1`。然后，当您尝试将其转换回字符串时，根据用于查找该名称的技术，您可能会得到`"Two"`或`"FirstValue"`。正如您所说，解决方案是给每个枚举值一个定义的整数值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-09T22:52:25.593

这是您问题的一个有趣转折，请尝试以下枚举...

```
public enum Numbers : int
{
    One,
    Two,
    Four,
    FirstValue = 1
} 
```

console.WriteLine(...) 现在将打印“Two”！

两者`Two`和都`FirstValue`表示相同的数字`1`，但看到的实际值取决于数字如何转换为其字符串表示形式，反之亦然。

Enum 类使用反射来获取数字的名称，然后将它们存储在数组中，但它会在这样做之前对整个事物进行排序。然后 Enum.ToString() 对排序后的值进行二进制搜索以获取字符串表示形式。由于这样做的方式，根据枚举中元素的数量，您可能会得到不同的结果！

现在至于 VS 中“看到”的值，我怀疑枚举的调试器可视化器使用了它自己的算法来纠正（？）这个错误。

# c++ - 我需要为我在 XPCOM 中使用的每个自创类创建一个接口吗？

> ID：530282
> 
> 赞同：0
> 
> 时间：2009-02-09T22:17:56.690
> 
> 标签：c++, xpcom

我是 XPCOM 开发的菜鸟。在用 C++ 编写 XPCOM 代码的过程中，我需要创建额外的类以在我的 XPCOM 组件中使用。我需要为这些类创建另一个 XPCOM 组件吗？我不能只在头文件中添加新类吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T13:59:28.403

一点都不。XPCOM 描述了外部接口。“内部”类由您的 C++ 编译器编译。那个编译器不会向你告发，所以 XPCOM 永远不会知道它们的存在。

为了您自己的理智，将这些内部类保留在自己的标题中确实很有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-22T17:37:27.897

您只需为希望从外部源（例如 JavaScript）可发现和可控制的类创建接口。如果某个类仅用于实现某个其他接口的功能，那么您不需要（也不应该）为该类定义 XPCOM 接口。

# wcf - WCF ServiceHost basicHttpBinding 503 错误

> ID：530286
> 
> 赞同：4
> 
> 时间：2009-02-09T22:19:01.307
> 
> 标签：wcf, basichttpbinding, servicehost

我正在尝试在 Windows 2007 SP1 服务器上将 WCF ServiceHost 作为 NT 服务运行。ServiceHost 负责托管单个服务端点：具有以下地址的 basicHttpBinding：

```
http://localhost:5555/ToBlah 
```

当我在本地机器 (Windows XP) 上运行此 ServiceHost 时，它工作正常 - 当我向它发布 SOAP 消息时，我会返回一个 HTTP 202 代码（“已接受”），这是我的服务的正确响应，因为合同有 IsOneWay=true。但是，当我在我的 2007 服务器上运行它时，当我尝试调用该服务时出现 503 错误。我将 WCF 消息日志记录“一直向上”，但我没有看到任何日志记录，这让我相信这发生在比 WCF 更低的级别（调用永远不会到达 WCF“层” ）。

系统管理员和我尝试了各种形式的 httpcfg 命令，但到目前为止没有运气。

我知道尝试在 IIS 中托管它可能是一种可能的解决方案，但我们的生产应用程序服务器没有安装 IIS，所以我只想将服务作为 ServiceHost 运行。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-11T06:45:40.153

好吧，我仍然无法让它在 Vista 服务器上工作——它仍然给出 503 错误，但我最终在 Windows 2003 服务器上安装了它，而且它现在似乎可以工作了。

我在这个过程中学到的一件事是使用 HttpCfg.exe 来允许用户打开一个非标准的 HTTP 端口。

基本上我必须运行类似以下命令的东西：

```
httpcfg.exe set urlacl /u http://+:5555/ /a "O:AOG:DAD:(A;;RPWPCCDCLCSWRCWDWOGA;;;S-1-0-0)" 
```

然后，您可以使用以下命令查看 URL ACL 设置：

```
httpcfg.exe query urlacl 
```

在 Vista 上，您可以使用 netsh 运行相同类型的命令（请参阅下面的链接）。

可悲的是，这需要一段时间才能弄清楚，但这是一次很好的学习经历。

以下是一些我认为有助于解决此问题的链接：

*   [http://www.leastprivilege.com/HttpCfgACLHelper.aspx](http://www.leastprivilege.com/HttpCfgACLHelper.aspx)
    *   这解释了如何为您的用户帐户获取 SID（对于命令的 /a 部分。巧合的是，这在 Vista 上更容易 - 您只需在 netsh http set urlacl 命令中指定域\用户即可
*   [http://technet.microsoft.com/en-us/library/cc781601.aspx](http://technet.microsoft.com/en-us/library/cc781601.aspx)
    *   这解释了 HttpCfg.exe 命令的语法/选项
*   [http://msdn.microsoft.com/en-us/library/ms733768.aspx](http://msdn.microsoft.com/en-us/library/ms733768.aspx)
    *   这确实解释了您需要了解的有关 HttpCfg/netsh http 的所有信息
*   [http://blogs.msdn.com/drnick/archive/2006/04/14/configuring-http.aspx](http://blogs.msdn.com/drnick/archive/2006/04/14/configuring-http.aspx)
    *   与上面的 msdn 链接类似的信息，但提供了更多解释，以及与 WCF 的更多关系
*   [http://dotnet.dzone.com/news/msmq-wcf-and-iis-getting-them-](http://dotnet.dzone.com/news/msmq-wcf-and-iis-getting-them-)
    *   WCF 和 HTTP（和 MSMQ）的另一种描述，重点是 IIS

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T22:22:21.983

NT服务配置了什么**身份？**要隔离问题，请尝试使用本地管理员帐户查看此问题是否与权限相关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-09T23:04:27.517

在我看来，服务器上的防火墙或其他配置设置正在阻止该端口。

如果不是，那么您的服务可能在创建 ServiceHost 对象实例或创建服务端点期间遇到错误，并且由于某种原因未捕获错误（？）。您可以在服务代码中编写一些简单的内部测试循环，以验证服务端点是否已正确创建。这可能会揭示一些有趣的事情。

此外，从该服务器运行客户端并连接到在开发机器上运行的服务可能会告诉您更多信息？您可以使用 WCFTestClient.exe，如此处所引用：[Is it possible to make the WcfTestClient work for custom transport channels?](https://stackoverflow.com/questions/484717/error-externally-testing-wcf-udp-custom-transport-channel-sample-from-the-windows) . 这可能会给你额外的信息。但是，您需要在服务中支持 MetadataExchange (Mex) 才能使用该测试客户端。

或者，您可以使用 Visual Studio 2008 Samples 文件夹中的 WCF 示例，并结合 WCFTestClient.exe 来测试一些自托管的服务，这些服务预计可以正常工作，首先在服务器内，然后从服务器外部。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-28T08:48:00.643

如果您使用的是 Windows Vista 或 Windows 7，则必须使用“netsh”，它也更易于使用。

*   本地用户帐户：

    `netsh http add urlacl url=http://+:8001/ user=ComputerName\Username`

*   域用户帐户：

    `netsh http add urlacl url=http://+:8001/ user=DomainName\Username`

*   内置 NetworkService 帐户：

    `netsh http add urlacl url=http://+:8001/ user="NT AUTHORITY\NETWORK SERVICE"`

# c - Linux 和 C 编程：如何将 utf-8 编码的文本写入文件？

> ID：530287
> 
> 赞同：1
> 
> 时间：2009-02-09T22:19:08.357
> 
> 标签：c, linux, encoding, locale

我有兴趣将 utf-8 编码的字符串写入文件。

我用低级函数 open() 和 write() 做到了这一点。首先，我将语言环境设置为可识别 utf-8 的字符集，使用 `setlocale("LC_ALL", "de_DE.utf8")`. 但生成的文件不包含 utf-8 字符，仅包含 iso8859 编码的变音符号。我究竟做错了什么？

附录：我不知道我的字符串是否真的是 utf-8 编码的。我只是以这种形式将它们保存在源文件中：`char *msg = "Rote Grütze";`

查看文本文件内容的屏幕截图： [alt text http://img19.imageshack.us/img19/9791/picture1jh9.png](http://img19.imageshack.us/img19/9791/picture1jh9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-09T22:23:03.230

更改语言环境不会更改使用 write() 写入文件的实际数据。您必须实际*生成*UTF-8 字符才能将它们写入文件。为此，您可以将库用作[ICU](http://www.icu-project.org/)。

*编辑问题后进行编辑*：UTF-8 字符仅在“特殊”符号（ümlauts、áccénts 等）中与 ISO-8859 不同。因此，对于所有没有任何此符号的文本，两者都是等效的。但是，如果您在程序字符串中包含这些符号，则必须确保您的文本编辑器将数据视为 UTF-8。有时你只需要告诉它。

总而言之，如果源代码中的字符串是 UTF-8，您生成的文本将是 UTF-8。

*另一个编辑*：可以肯定的是，您可以使用 iconv 将*源代码*转换为 UTF-8：

```
iconv -f latin1 -t utf8 file.c 
```

这会将您所有的 latin-1 字符串转换为 utf8，当您打印它们时，它们肯定是 UTF-8。如果 iconv 遇到一个奇怪的字符，或者您看到输出字符串带有奇怪的字符，那么您的字符串已经是 UTF-8。

问候，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T22:41:01.957

是的，你可以用 glibc 做到这一点。他们将其称为多字节而不是 UTF-8，因为它可以处理不止一种编码类型。查看手册的[这一](http://www.gnu.org/software/libc/manual/html_node/Character-Set-Handling.html)部分。

寻找以 mb 为前缀的函数，以及以 wc 为前缀的函数，用于从多字节转换为宽字符。您必须首先使用 setlocale() 将语言环境设置为 UTF-8，以便它选择这种多字节支持的实现。

如果您来自 Unicode 文件，我相信您要查找的函数是 wcstombs()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T22:22:52.203

您能否在十六进制编辑器中打开文件并通过一个简单的输入示例验证写入的字节不是您传递给 write() 的 Unicode 字符的值。有时，文本编辑器无法确定字符集，而您的文本编辑器可能假定了 ISO8859-1 字符集。

完成此操作后，您可以编辑原始帖子以添加相关信息吗？

# php - 用ajax删除mysql记录

> ID：530307
> 
> 赞同：2
> 
> 时间：2009-02-09T22:22:20.377
> 
> 标签：php, javascript, ajax

我想知道从实时数据库中删除记录并立即刷新页面的最佳方法。目前我正在使用 ajax，使用以下 javascript 方法：

```
function deleterec(layer, pk) {
   url = "get_records.php?cmd=deleterec&pk="+pk+"&sid="+Math.random();
   update('Layer2', url);
} 
```

如果 php 页面上的 cmd=deleterec，则在主键 = pk 的地方进行删除。这工作正常，因为记录被删除，但页面没有更新。

我的更新方法很简单：

```
function update(layer, url) {
    var xmlHttp=GetXmlHttpObject(); //you have this defined elsewhere

    if(xmlHttp==null) {
        alert("Your browser is not supported?");
    }

    xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            document.getElementById(layer).innerHTML=xmlHttp.responseText;
        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            document.getElementById(layer).innerHTML="loading";
        }

       //etc
    }

    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
} 
```

如何删除或更改记录，以及更新页面。

目前，我的 ajax 框架通过将数据传递给 javascript 更新方法来工作，该方法适用于选择不同的查询以显示在不同的层中。

我想添加以某种方式删除或更改记录的功能。

我想知道单击链接执行查询然后调用我的更新方法并刷新 tge 页面时是否有可能。考虑到我的更新方法，有什么简单的方法可以做到这一点吗？

如果可能的话，我想避免重写我的更新方法。

最简单的方法是在执行 mysql 查询后让 php 页面（仅在层中）重新加载吗？

或者创建一个新的“alterstatus”方法，将删除或监视作为参数传递，并让 php 相应地执行查询然后更新页面？

编辑：链接是这样生成的。deleterec 将从生成的附加链接中调用。

{

```
$pk = $row['ARTICLE_NO'];

echo '<tr>' . "\n"; 

    echo '<td><a href="#" onclick="updateByPk(\'Layer2\', \'' . $pk . '\')">'.$row['USERNAME'].'</a></td>' . "\n"; 

echo '<td><a href="#" onclick="updateByPk(\'Layer2\', \'' . $pk . '\')">'.$row['shortDate'].'</a></td>' . "\n"; 

echo '<td><a href="#" onclick="updateByPk(\'Layer2\', \'' . $pk . '\')">'.$row['ARTICLE_NAME'].'</a></td>' . "\n"; 

echo '<td><a href="#" onclick="deleteRec(\'Layer2\', \'' . $pk . '\')">'.$row['ARTICLE_NAME'].'</a></td>' . "\n"; 

echo '</tr>' . "\n"; 
```

}

编辑：不能修改更新方法，因为它被需要一个层的 updateByPk 和 updateBypg 方法使用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T22:34:18.273

在不深入研究您的代码细节的情况下，我不知道有任何方法可以在不进行往返（AJAX 或页面导航）的情况下从服务器端数据库中更新/删除。但是，我建议使用 JavaScript 框架（如[jQuery](http://jquery.com/)或其他）来处理 AJAX 和 DOM 操作。从理论上讲，这应该可以减轻 Thinbs 客户端的任何跨浏览器故障排除。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-23T23:19:46.983

当您说“立即更新”时，我认为您的意思是通过 Javascript 更新文档。Ajax 和页面刷新不能一起使用。

您如何显示现有的数据行？例如，假设您像这样列出它们：

```
<div id="row1">row 1</div>
<div id="row2">row 2</div> 
```

其中 row1 和 row2 是数据库中的行，主键分别为 1 和 2。使用一个简单的 javascript 函数从 DOM 中删除关联的 div：

```
function deleterec(pk) {
    url = "get_records.php?cmd=deleterec&pk="+pk+"&sid="+Math.random();
    update(pk, url);
}

function update(pk, url) {
    var xmlHttp=GetXmlHttpObject(); //you have this defined elsewhere

    if(xmlHttp==null) {
        alert("Your browser is not supported?");
    }

    xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            document.getElementById(layer).innerHTML=xmlHttp.responseText;
            removeDomRow(pk); //You may wish to check the response here
        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            document.getElementById(layer).innerHTML="loading";
        }
    }
    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
} 
```

以及以下操作 DOM 的函数：

```
function removeDomRow(pk){
        var row = document.getElementById('row' + pk);
        row.parentNode.removeChild(row);
} 
```

如果您使用表格：

```
<tr id="row1">
    <td>row 1</td>
</tr>
<tr id="row2">
    <td>row 2</td>
</tr> 
```

你可以使用：

```
 function removeDomRow( id ) { // delete table row
    var tr = document.getElementById( 'row' + id );
    if ( tr ) {
      if ( tr.nodeName == 'TR' ) {
        var tbl = tr; // Look up the hierarchy for TABLE
        while ( tbl != document && tbl.nodeName != 'TABLE' ) {
          tbl = tbl.parentNode;
        }
        if ( tbl && tbl.nodeName == 'TABLE' ) {
          while ( tr.hasChildNodes() ) {
            tr.removeChild( tr.lastChild );
          }
          tr.parentNode.removeChild( tr );
        }
      }
    } 
```

关于 raccoonbear 的观点，如果您要使用诸如 Qjuery 之类的框架，事情会容易得多：

```
$('#row'+id).remove(); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-23T14:16:16.337

> 我想知道单击链接执行查询然后调用我的更新方法并刷新 tge 页面时是否有可能。考虑到我的更新方法，有什么简单的方法可以做到这一点吗？

那么，为什么不直接提交表格呢？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-23T14:09:28.787

你有两个选择：

*   进行一次完整的往返，即在您知道项目已成功删除之前不要更新 UI，或者

*   对你的用户撒谎

如果操作的结果有问题且重要，则使用第一个选项。如果您对结果有信心，并且人们不需要知道细节，请使用第二个。

真的，没有什么比被成功欺骗更能让人开心的了。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-28T10:05:21.580

我不会使用 HTTP GET 方法从数据库中删除记录，我会使用 POST。而且我不会使用 Ajax，因为您正在寻找的交互显然是**同步**的：删除然后更新。我会使用常规提交（JS 或 HTML）。

也就是说，如果您真的致力于使用 XHR，唯一剩下的解决方案是根据 Renzo Kooi 建议的服务器响应的回调。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T11:08:43.560

您可以创建一个回调，在客户端负责更新屏幕。您可以在 XHR 函数中执行此操作。

```
 function update(layer, url) {
        var xmlHttp=GetXmlHttpObject(),
             callbackFn = function(){ 
                  /* ... do thinks to reflect the update on the user screen,
                         e.g. remove a row from a table ...*/
                 };

        if(xmlHttp==null) {
            alert("Your browser is not supported?");
        }

        xmlHttp.onreadystatechange = function() {
            if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
                /* if the server returns no errors run callback 
                   (so server should send something like 'ok' on successfull
                   deletion 
                */
                if (xmlHttp.responseText === 'ok') {
                      callback();
                }
        //=>[...rest of code omitted] 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-28T15:23:52.593

删除和更新 DOM：

```
echo '<td><a href="#" onclick="deleteRec(this, \'' . $pk . '\')">'.$row['ARTICLE_NAME'].'</a></td>' . "\n"; 

function deleterec(row, pk) {
    var rowId = row.parentNode.parentNode.rowIndex;
    url = "get_records.php?cmd=deleterec&pk="+pk+"&sid="+Math.random();
    update(rowId, url);
}

function update(rowId, url) {
    var xmlHttp=GetXmlHttpObject(); //you have this defined elsewhere

    if(xmlHttp==null) {
        alert("Your browser is not supported?");
    }

    xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            document.getElementById(layer).innerHTML=xmlHttp.responseText;
            deleteRow(rowId); //You may wish to check the response here
        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            document.getElementById(layer).innerHTML="loading";
        }
    }
    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
}

function deleteRow(i){
    document.getElementById('myTable').deleteRow(i)
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-01T23:23:40.140

我发现使用基于 Ajax 的管理页面执行三个基本操作：更新、删除和追加。这些动作中的每一个都以不同的方式改变 DOM。

您已经编写了一个可以**更新**DOM 中现有 div 的函数，但是如果您想像在这个问题中那样从 DOM 中**删除**一个 div，该函数将无法正常工作，当您决定想要使用 Ajax 添加新记录。

为了正确处理这个问题，您首先需要为输出的每一行分配一个唯一的 id：

```
$pk = $row['ARTICLE_NO'];

echo '<tr id=\"article_' . $pk . '\">' . "\n"; 

        echo '<td><a href="#" onclick="updateByPk(\'Layer2\', \'' . $pk . '\')">'.$row['USERNAME'].'</a></td>' . "\n"; 

echo '<td><a href="#" onclick="updateByPk(\'Layer2\', \'' . $pk . '\')">'.$row['shortDate'].'</a></td>' . "\n"; 

echo '<td><a href="#" onclick="updateByPk(\'Layer2\', \'' . $pk . '\')">'.$row['ARTICLE_NAME'].'</a></td>' . "\n"; 

echo '<td><a href="#" onclick="deleteRec(\'article_' . $pk .'\', )">'.$row['ARTICLE_NAME'].'</a></td>' . "\n"; 

echo '</tr>' . "\n"; 
```

然后你需要创建一个可以删除表格行的删除函数：

```
function delete(layer, url) {
    var xmlHttp=GetXmlHttpObject(); //you have this defined elsewhere

    if(xmlHttp==null) {
        alert("Your browser is not supported?");
    }

    xmlHttp.onreadystatechange = function() {
        if(xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
            if(xmlHttp.responseText == 'result=true') {
                // Here you remove the appropriate element from the DOM rather than trying to update something within the DOM
                var row = document.getElementById(layer);
                row.parentNode.removeChild(row);
            }
        } else if (xmlHttp.readyState==1 || xmlHttp.readyState=="loading") {
            document.getElementById(layer).innerHTML="loading";
        }

       //etc
    }

    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
} 
```

然后最后调整你的 deleterec 函数：

```
function deleteRec(layer, pk) {
   url = "get_records.php?cmd=deleterec&pk="+pk+"&sid="+Math.random();
   delete(layer, url);
} 
```

作为最后一点，我必须回应其他人建议使用框架的观点。任何框架的使用，无论是 jQuery、Prototype、Dojo 还是其他，都会有短期和长期的好处。此外，我永远不会真正使用 GET 来执行这种性质的操作。强制删除元素所要做的就是点击相应的 URL 并传入相关的文章编号。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-03-02T01:48:38.590

我会投票支持推荐 jQuery 的其他答案之一，但我还没有足够的分数。

我认为实现您正在寻找的“更新”的最简单方法是让您的 AJAX 删除返回相关的删除后 HTML，或者您可以使用 jQuery 触发删除，然后删除 tr、div 等. 从页面。

```
jQuery.post("get_records.php ", { cmd: "delete", pk: 123 }, function() {
    jQuery("tr.row123").remove(); 
}) 
```

# sql-server-2005 - 如何在限制权限的同时执行 sp_send_dbmail

> ID：530320
> 
> 赞同：4
> 
> 时间：2009-02-09T22:23:59.033
> 
> 标签：sql-server-2005, stored-procedures, permissions

有没有一种方法可以访问我的数据库中的用户来执行 **`msdb.dbo.sp_send_dbmail`**，而无需将它们添加到 MSDB 数据库和 DatabaseMailUserRole？

我试过这个：

```
ALTER PROCEDURE [dbo].[_TestSendMail]
(
  @To NVARCHAR(1000),
  @Subject NVARCHAR(100),
  @Body NVARCHAR(MAX)
)
WITH EXECUTE AS OWNER
AS 
    BEGIN
        EXEC msdb.dbo.sp_send_dbmail @profile_name = N'myProfile',
            @recipients = @To, @subject = @Subject, @body = @Body
    END 
```

但我得到这个错误：

```
The EXECUTE permission was denied on the object 'sp_send_dbmail', database 'msdb', schema 'dbo'. 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-13T19:08:19.897

你的方法没问题，但你的包装过程必须在 msdb 数据库中。然后，执行“EXEC msdb.dbo._TestSendMail”

这仍然会在 msdb 中留下对 dbo._TestSendMail 的权限问题。但是 public/EXECUTE 就足够了：它只公开你需要的 3 个参数。

如有疑问，请添加 WITH ENCRYPTION。这足以阻止没有系统管理员权限的任何人查看代码

```
USE msdb
GO
CREATE PROCEDURE [dbo].[_TestSendMail]
(
  @To NVARCHAR(1000),
  @Subject NVARCHAR(100),
  @Body NVARCHAR(MAX)
)
-- not needec WITH EXECUTE AS OWNER
AS 
    BEGIN
        EXEC dbo.sp_send_dbmail @profile_name = N'myProfile',
            @recipients = @To, @subject = @Subject, @body = @Body
    END 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-11-25T19:29:59.797

您实际上可以使用证书签名的存储过程来执行此操作，并且不必在 msdb 中执行此操作：

```
CREATE DATABASE TestDBMail
GO

USE [TestDBMail]
GO

CREATE PROCEDURE [dbo].[TestSendMail]
(       
        @To NVARCHAR(1000),  
        @Subject NVARCHAR(100),  
        @Body NVARCHAR(MAX)
)
WITH EXECUTE AS OWNER
AS
BEGIN
        EXEC msdb.dbo.sp_send_dbmail 
                        @profile_name = N'Database Mail Profile',
                        @recipients = @To, 
                        @subject = @Subject, 
                        @body = @Body    
END
GO

-- This should fail
EXECUTE [dbo].[TestSendMail] 'someemail@domain.com', 'test', 'body'

-- Create a certificate to sign stored procedures with
CREATE CERTIFICATE [DBMailCertificate]
ENCRYPTION BY PASSWORD = '$tr0ngp@$$w0rd'
WITH SUBJECT = 'Certificate for signing TestSendMail Stored Procedure';
GO

-- Backup certificate so it can be create in master database
BACKUP CERTIFICATE [DBMailCertificate]
TO FILE = 'd:\Backup\DBMailCertificate.CER';
GO

-- Add Certificate to Master Database
USE [master]
GO
CREATE CERTIFICATE [DBMailCertificate]
FROM FILE = 'd:\Backup\DBMailCertificate.CER';
GO

-- Create a login from the certificate
CREATE LOGIN [DBMailLogin]
FROM CERTIFICATE [DBMailCertificate];
GO

-- The Login must have Authenticate Sever to access server scoped system tables
-- per http://msdn.microsoft.com/en-us/library/ms190785.aspx
GRANT AUTHENTICATE SERVER TO [DBMailLogin]
GO

-- Create a MSDB User for the Login
USE [msdb]
GO
CREATE USER [DBMailLogin] FROM LOGIN [DBMailLogin]
GO

-- Add msdb login/user to the DatabaseMailUserRole
EXEC msdb.dbo.sp_addrolemember @rolename = 'DatabaseMailUserRole', @membername = 'DBMailLogin';
GO

USE [TestDBMail]
GO

-- Sign the procedure with the certificate's private key
ADD SIGNATURE TO OBJECT::[TestSendMail]
BY CERTIFICATE [DBMailCertificate] 
WITH PASSWORD = '$tr0ngp@$$w0rd';
GO

-- This will succeed
EXECUTE [dbo].[TestSendMail] 'someemail@domain.com', 'test', 'body'

/*
-- Cleanup
USE [msdb]
GO
DROP USER [DBMailLogin]
GO
USE [master]
GO
DROP LOGIN [DBMailLogin]
DROP CERTIFICATE [DBMailCertificate]
DROP DATABASE [TestDBMail]

-- Delete the certificate backup from disk

*/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T09:12:08.617

一种可能的解决方案是将邮件封装为存储过程，例如 mail_error_as_MAILER （您稍后将调用）和另一个存储过程，例如

```
 ALTER PROCEDURE [dbo].[mail_error](@error_ID int)
SET NOCOUNT ON
declare @rc int
declare @object int
declare @src varchar(255)
declare @desc varchar(255)
declare @osql_cmd varchar(1000)
-- create shell object
exec @rc = sp_oacreate 'wscript.shell', @object out
if @rc0 
  begin
    exec sp_oageterrorinfo @object, @src out, @desc out
    return
  END

  DECLARE @user VARCHAR(50)
  DECLARE @password VARCHAR(50)
  DECLARE @database VARCHAR(50)
  DECLARE @server VARCHAR(50)
  DECLARE @sql varchar(200) 
 SET @user=MAILER,@password=XXXXXX,@database=XXXXXX,@server=XXXXX 
SET @sql= 'EXEC mail_ERROR_as_MAILER @error_ID=' + CAST(@error_id as varchar(10))
set @osql_cmd='osql -U'+@user+' -P'+@password+' -d'+@database+' -S"'+@server+'"  -Q"'
  +@sql+'"'

exec @rc= sp_oamethod @object, 'run', null, @osql_cmd
--print @rc
if @rc0 
  begin
    exec sp_oageterrorinfo @object, @src out, @desc out
    return
  end
-- destroy shell object
exec sp_oadestroy @object 
```

但这需要： * 硬编码密码（确保用户无法查看存储过程的定义...） * 允许用户访问 sp_oacreate 等...（引发其他安全问题，例如 DOS）

这样他们就只能按照您想要的方式使用邮件，而无需允许他们邮寄其他东西。

或者更安全，让用户将邮件放入某种 mail_queue（您可以控制他们可以放入的内容）并让代理帐户定期发送这些邮件

或者：允许他们邮寄，但在滥用时使用带有生锈尖刺的大俱乐部

# python - 为什么连接在这两个样本中的工作方式不同？

> ID：530329
> 
> 赞同：0
> 
> 时间：2009-02-09T22:25:28.110
> 
> 标签：python, concatenation

我在 Python 代码的两个不同位置引发异常：

```
holeCards = input("Select a hand to play: ")
try:
    if len(holeCards) != 4:
        raise ValueError(holeCards + ' does not represent a valid hand.') 
```

AND **（已编辑以更正提升代码）**

```
def __init__(self, card):
  [...]

  if self.cardFace == -1 or self.cardSuit == -1:
    raise ValueError(card, 'is not a known card.') 
```

出于某种原因，第一个输出一个连接的字符串，就像我预期的那样：

```
ERROR: Amsterdam does not represent a valid hand. 
```

但是，第二个输出一些奇怪的集合和字符串混合：

```
ERROR: ('Kr', 'is not a known card.') 
```

为什么“+”运算符在这两种情况下表现不同？

**编辑：**对 init 的调用如下所示：

```
 card1 = PokerCard(cardsStr[0:2])
  card2 = PokerCard(cardsStr[2:4]) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T23:04:49.543

嗯，我错过了什么还是你在比较输出

```
raise ValueError(card, 'is not a known card.') 
```

和

```
raise ValueError(card + ' is not a known card.') 
```

？？？

第二个使用“+”，但第一个使用“，”，它确实并且应该给出您显示的输出！

（nb。在这两种情况下，问题都是从带有“+”的版本编辑的。也许应该删除这个问题？？？）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-09T22:30:12.810

“card”可能表示包含字符串“Kr”的元组。当您在元组上使用 + 运算符时，您会创建一个添加了额外项的新元组。

编辑：不，我错了。将字符串添加到元组：

```
>> ("Kr",) + "foo" 
```

产生错误：

```
TypeError: can only concatenate tuple (not "str") to tuple 
```

确定“卡片”的类型可能会有所帮助。你知道它是什么类型的吗？如果没有，请尝试输入如下打印语句：

```
if len(card) != 2:
    print type(card)
    raise ValueError(card + ' is not a known card.') 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-09T23:05:09.870

这使用单个参数实例化 ValueError 异常，您的连接（或添加）字符串：

```
raise ValueError(holeCards + ' does not represent a valid hand.') 
```

这使用 2 个参数实例化 ValueError 异常，无论卡片是什么和一个字符串：

```
raise ValueError(card, 'is not a known card.') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-09T22:53:50.833

在第二种情况下`card`肯定不是字符串。如果它是一个字符串，那么`len('2')`将等于 2 并且不会引发异常，因此首先检查您要连接的内容，似乎添加到字符串中的内容会返回表示为元组的内容。

我建议您使用字符串格式而不是字符串连接来创建错误消息。它将使用`__repr__`对象的字符串表示 ( )。

使用字符串格式：

```
>>> "%s foo" % (2)
'2 foo' 
```

使用字符串连接：

```
>>> 2 + " foo"
Traceback (most recent call last):
  File "<stdin>", line 1, in ?
TypeError: unsupported operand type(s) for +: 'int' and 'str' 
```

还有其他问题……您使用的是什么 python 版本/实现？我在 Linux 上的 cpython 解释器将 ValueErrors 报告为`ValueError`，而不是`ERROR`...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T22:42:46.133

您是否重载了`__add__()`代码中的某个地方，这可能导致它返回一个元组或其他东西？

# c# - .NET 的 SFTP 库

> ID：530330
> 
> 赞同：119
> 
> 时间：2009-02-09T22:25:41.120
> 
> 标签：c#, .net, sftp

谁能推荐一个好的 SFTP 库来使用？现在，我正在研究 SecureBlackbox、IPWorks SSH、WodSFTP 和 Rebex SFTP 等产品。但是，我以前从未使用过任何 SFTP 库，所以我不确定我在寻找什么。

如果有人以前使用过这些，有什么理由我应该使用产品“X”而不是“Y”？

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-04-24T11:13:37.467

我四处搜寻，发现~~[SharpSSH 的这个分支](https://bitbucket.org/mattgwagner/sharpssh)~~和[SSH.NET是 .NET 中用于](https://github.com/sshnet/SSH.NET)[SFTP](http://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol)（不要与[FTPS](http://en.wikipedia.org/wiki/FTPS)混淆）通信的最新且维护最好的库。SSH.NET 是一个干净的 .NET 4.0 实现的 SFTP 协议，我已经在几个解决方案中使用了它，并取得了巨大的成功。

原本的~~[SharpSSH](http://sourceforge.net/projects/sharpssh/)~~似乎已经死了，大多数其他解决方案要么需要安装 Windows 可执行文件，要么需要大量现金（或者更糟；两者都有）。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2010-04-07T20:09:33.350

我们使用 WinSCP。免费。它不是一个库，但有一个文档齐全且功能齐全的命令行界面，您可以将其与 Process.Start 一起使用。

**更新：**在 v.5.0 中，WinSCP为 WinSCP 的脚本层提供[了一个 .NET 包装库。](http://winscp.net/eng/docs/library)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-02-09T22:36:55.397

看看这个：[http ://www.tamirgal.com/home/dev.aspx?Item=sharpSsh](http://www.tamirgal.com/home/dev.aspx?Item=sharpSsh)

> SharpSSH 是 SSH2 客户端协议套件的纯 .NET 实现。它提供了一个用于与 SSH 服务器通信的 API，并且可以集成到任何 .NET 应用程序中。
> 
> 该库是 JCraft Inc. 的 JSch 项目的 C# 端口，并在 BSD 样式许可下发布。
> 
> SharpSSH 允许您使用类似于 JSch 的 API 的 API 通过 SSH 通道读取/写入数据和传输文件。此外，它还提供了一些额外的包装类，这些类为 SSH 通信提供了更简单的抽象。
> 
> Source forge 的 SharpSSH 项目页面：http: [//sourceforge.net/projects/sharpssh](http://sourceforge.net/projects/sharpssh)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-02-09T22:29:21.330

我们买了一个[Rebex](http://www.rebex.net/default.aspx)文件传输包，一切都很好。API 很简单，我们在通信、代理服务器等方面没有任何问题......

但我没有机会将它与另一个 SFTP/FTPS 组件进行比较。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-02-07T17:19:41.783

Bitvise 有一个很棒的产品，叫做 Tunnelier，它可以将 FTP 桥接到 SFTP。然后，您可以在 .NET 中使用标准的 FtpWebRequest。

[http://www.bitvise.com/ftp-bridge](http://www.bitvise.com/ftp-bridge)

我目前正在出于自己的目的对此进行测试，并将根据我的发现进行更新。

# 更新

这个想法对于无人值守的自动化来说并不理想，除非你想跳过箍，保持客户端作为服务或其他东西连接，我通过使用[NSSM](http://nssm.cc/)实现了这一点。

我已经尝试使用包括 bitvise 和 winscp.com 在内的各种客户端进行 CLI 自动化。我还尝试过这些 .net 类库：Winscp、SSH.NET、SharpSSH 和商业 SecureBlackBox SFTP 客户端。

SecureBlackBox 运行良好，但它非常重量级，根据许可可能相当昂贵，而且我不太同意它的 API。

毫无疑问，用于 .NET 开发的最佳免费 sftp 客户端是[winscp](http://winscp.net/eng/docs/library)。我编写了一些类和扩展方法以使其更容易使用：[Winscp.Extensions](https://github.com/Core-Techs/Winscp.Extensions)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-01-03T03:46:30.167

几个月来，我一直在使用 Chilkat 的本地 SFTP 库 ( [http://www.chilkatsoft.com/ssh-sftp-component.asp )，它运行良好。](http://www.chilkatsoft.com/ssh-sftp-component.asp)一直在夜间工作中使用它来下载大文件并进行私钥身份验证。我唯一的问题是让 64 位版本在 Windows Server 2008 上运行，我需要在我的服务器上安装 vcredist_x64.exe ( [http://www.microsoft.com/download/en/details.aspx?id=14632](http://www.microsoft.com/download/en/details.aspx?id=14632) ) .

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-11-21T19:16:39.513

我用过 IP*Works SSH，它很棒。易于安装和使用。此外，当您遇到问题或问题时，他们的支持是一流的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-19T02:32:42.183

要在 .NET 中获得全面的 SFTP 支持，请尝试[edtFTPnet/PRO](http://www.enterprisedt.com/products/edtftpnetpro/overview.html)。支持许多不同的 SFTP 服务器已经存在很长时间了。

我们还销售适用于 Windows 的 SFTP 服务器[CompleteFTP](http://www.enterprisedt.com/products/completeftp/overview.html)，这是一种在 Windows 机器上获得 SFTP 支持的廉价方式。还有FTP和FTPS。

# wcf - “无法加载配置中指定的 X.509 证书身份”

> ID：530342
> 
> 赞同：8
> 
> 时间：2009-02-09T22:27:52.097
> 
> 标签：wcf, wcf-security, x509

我将工作 WCF 服务从我的开发环境转移到 QA 环境，包括证书（根授权、根授权撤销列表、服务证书 - 包括其 PK）。

之后，我找到了私钥 usihg 'FindPrivateKey'，并为所有相关帐户授予了在文件系统级别访问私钥文件的完全权限。

我的应用程序因未处理的异常而崩溃：System.InvalidOperationException：无法加载配置中指定的 X.509 证书身份。

我很难过，我想我涵盖了所有内容，但显然不是......

我已经在 Windows 服务主机和控制台应用程序主机上进行了尝试。同样的问题。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2011-10-03T12:01:37.123

我在 Win 7 上用 VS2010 SP1 编写的简单 WFC 服务中遇到了同样的错误。我发现的修复是添加

```
<dns value="localhost" /> 
```

到 app.config 的 <identity> 部分

资料来源：[http ://social.msdn.microsoft.com/Forums/en-AU/wcf/thread/439539ef-e8d7-4e7d-b36e-b80acd401606](http://social.msdn.microsoft.com/Forums/en-AU/wcf/thread/439539ef-e8d7-4e7d-b36e-b80acd401606)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-15T18:12:15.613

这对我有用：

```
 <identity>
      <certificateReference storeName="My" storeLocation="LocalMachine"  x509FindType="FindBySubjectName" findValue="xxxxxxxx" />
      <dns value="localhost" />
    </identity> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-11T15:36:10.097

这是一个教程，解释了如何创建一个可以解决这个问题的证书：

[Codeplex WCF 安全性：如何在开发期间为消息安全性在 WCF 中创建和安装临时证书](http://www.codeplex.com/WCFSecurity/Wiki/View.aspx?title=How%20To%20-%20Create%20and%20Install%20Temporary%20Certificates%20in%20WCF%20for%20Message%20Security%20During%20Development)。

希望能解决您所需要的问题 - 即使您在 6 个多月前问过这个问题！

问候，乔

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-28T03:09:51.667

您的证书公用名是否与您的主机域名匹配？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-06T11:04:36.343

我是 WCF 的新手，今天在创建一个简单的 WCF 服务时遇到了这个问题。只是想分享一些想法：

**1\. 解决问题 -**如果您在 Joe（上图）之前阅读了所有其他答案，您就会知道如何解决问题；）没有证书

**2\. 解决证书问题 - 我要感谢 Joe 分享了一个很棒的链接** [“如何：在 WCF 中为开发期间的消息安全创建和安装临时证书”](http://wcfsecurity.codeplex.com/wikipage?title=How%20To%20-%20Create%20and%20Install%20Temporary%20Certificates%20in%20WCF%20for%20Message%20Security%20During%20Development)

***另外：** [您可以从 Microsoft 网站下载 WCF 示例。您会在上面的链接中找到一个名为“FindPrivateKey”的工具](http://msdn.microsoft.com/en-us/library/vstudio/ms751450%28v=vs.90%29.aspx)*

# statistics - N 位数组中的 X *连续* 位设置为 1 的概率是多少？

> ID：530356
> 
> 赞同：6
> 
> 时间：2009-02-09T22:30:02.777
> 
> 标签：statistics, hardware, verification

我正在尝试编写一个简单、足够准确的过滤器来验证 RTL 模拟中的硬件。我们通过将设计中的所有触发器随机初始化为 0 或 1 来模拟芯片触发器中固有的随机性。这对应于芯片触发器在上电期间获得一些随机值。我们还随机化了重置树中的触发器（重置树没有反馈循环），这意味着您可能会在重置线上出现错误的故障。

例如

```
                              |||
                              VVV Nth 复位树触发器
          +----+ +----+ +----+ / / +----+
重置 | | 0 | | 1 | | 0 // | | 重置输出
 -------->D Q>-->D Q>----->D Q>---- / ... / -->D Q>----
          | | | | | | \ \ | |
          | | | | | | \ \ | |
          +^---+ +^---+ +^---+ / / +^---+
           | | | // |
clk ------+------------+------------+---------/ / ---+你会看到一个 0->1->0 看起来像重置，但实际上是一个小故障。

我想构建一个过滤器来查找一定数量的**连续**1 值，以确定我刚刚看到的重置是来自重置控制器的重置还是虚假重置。

我知道这是统计数据，可能与泊松分布有关，但是如何确定一组 N 位中任何 X 个连续位为 1 的概率？

PS是的。我知道 4-val RTL 模拟。我们也在这样做，但是一些 Verilog 构造在传播 X 和 Z 时没有足够的悲观情绪。

            回答 #1

赞同：3

时间：2009-02-09T22:46:14.330

编辑：下面没有回答这个问题，对不起......评论澄清了真正的问题是关于*n位中**x*个连续1的概率，而不仅仅是我假设的简单事情。快速浏览一下： http: [//www.mathhelpforum.com/math-help/probability-statistics/64519-probability-consecutive-wins.html](http://www.mathhelpforum.com/math-help/probability-statistics/64519-probability-consecutive-wins.html)这可能是您正在寻找的 - 它似乎可以解决问题从更大的toin cosses中出现toin cosses的概率，听起来很相似。但是已经晚了，我很累，所以我还没有解码数学:) *过时的：听起来您基本上是在处理二项式概率-请参阅[http://en.wikipedia.org/wiki/Binomial_probability](http://en.wikipedia.org/wiki/Binomial_probability)。

我不得不承认我已经有大约 20 年没有做过计算了，所以有点生疏……

基本上，二项式允许您将事件多次发生的概率“加在一起”，每次只有两种可能的结果。在您的情况下，顺序很重要，因此它应该像乘以概率一样简单；

1 位为 50% 

2 位为 50%^2 = 25% 

3 位为 50%^3 = 12.5%  

换个角度看；

1 位只有 2 种可能的组合，其中之一是全 1 = 50% 

2 位有 4 种可能的组合（10、01、11、00），其中只有一个是全 1 - 所以 25% 

3 位有 2^3 = 8 种可能的组合，其中只有一种全为 1，因此 1/8 = 12.5%  

所以... n 位的概率都是 1 = 1/(2^n)。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T22:35:40.173

好的，这就是我发现的：

P = 1 - Q(X)

在哪里

Q(X) = [1 - 1/2(Z)]/[(X + 1 - XZ) x 1/2 x Z^(X+1)]

在哪里

Z = 1 + (1/2)(1/2)^X + (X+1)[(1/2)(1/2)^X]^2 + ...

一些数学的链接在这里：

[数学论坛](http://mathforum.org/library/drmath/view/56637.html)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T23:30:52.257

如果您想快速测试以查看基于 1 的最长条纹的位序列是否是随机的，您可以使用 N 位中 1 的预期最长条纹为 Θ(log(N)) 的事实。

此外，最长条纹超过 r*log2(N) 位的概率最多为 1/N^(r-1)，类似地，最长条纹小于 log2(N)/r 位的概率最多1/N^(r-1)。

[这些结果是在“算法简介](http://mitpress.mit.edu/catalog/item/default.asp?tid=8570&ttype=2)”中“计数和概率”一章的“条纹”部分得出的

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T22:53:13.033

你可以做一个递归程序（python）：

prob (x,n) 给出你想要的结果

* * *

```
import math

def prob(x,n,i=0):
    if i == x: return 1
    if (x+i) > n: return 0
    t = .5 * prob(x,n-1,i+1) + .5 * prob(x,n-1,i)
    return t 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T00:15:15.833

我的方法是定义一个接受正确类型的位模式的 FSA，然后模拟每个位数的模式。IE

```
State state_map[] = {
    0 => { 0 -> 0; 1 -> 1; accepts = false },
    1 => { 0 -> 0; 1 -> 2; accepts = false },
    2 => { 0 -> 0; 1 -> 3; accepts = false },
    3 => { 0 -> 3; 1 -> 3; accepts = true }
};

state[t: 0, s: 0] = 1.0;
state[t: 0, s: 1] = 0.0;
state[t: 0, s: 2] = 0.0;
state[t: 0, s: 3] = 0.0;

for (t = 0; t < N; t++)
    for (s = 0; s<NUM_STATES; s++)
        state[t: t+1, s: state_map[s].0] += state[t, s] * .5
        state[t: t+1, s: state_map[s].1] += state[t, s] * .5

print "Probability: {0}", state[t: N, s: 3], 
```

# javascript - 从框架中弹出音乐播放器

> ID：530362
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-09T22:30:42.013
> 
>         
> 
> 标签：javascript, popup, flash

我目前正在为一个乐队编写一个网站，并且我有一个位于网站框架内的音乐播放器。当我点击一个按钮时，我想让音乐播放器从页面内弹出。

我想知道是否有某种 javascript/jquery 代码可以用于此功能。如果没有，我可以使用什么其他解决方法来实现这一点。

如果可能的话，作为功能的一部分，我希望框架在弹出后从窗口关闭，而另一个框架作为完整的网站加载。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T22:34:01.397

如果你必须... ;）

[http://javascript.internet.com/generators/popup-window.html](http://javascript.internet.com/generators/popup-window.html)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-06-11T09:30:25.013

您可以使用 ExternalInterface.call() 从您的 flash 音乐播放器调用 javascript window.open() 函数（并确保您已将 allowScriptAccess=samedomain 设置为 html 中的 flash 参数以使其正常工作）。

然后在弹出窗口中打开您的音乐播放器 swf，并附加一些附加参数，这样您就知道它位于弹出窗口中。

要使弹出版本继续播放框架所在的位置，您可以使用 LocalConnection 调用。框架版本将侦听 LocalConnection，并公开其当前播放状态（正在播放什么，在几秒等），弹出版本可以要求这个并从同一个地方继续。这将使最终用户的弹出体验更加流畅。

最后，框架播放器可以通过 ExternalInterface.call() 调用额外的 javascript 函数来将自己从框架文档的 DOM 中移除。

# sql - JOIN 语法中的 MySQL 相关子查询

> ID：530381
> 
>         
> 
> 赞同：19
> 
>         
> 
> 时间：2009-02-09T22:37:14.210
> 
>         
> 
> 标签：sql, mysql, join, subquery, entity-attribute-value

我想通过指定 innertable.id =outertable.id 为内部查询提供 WHERE 条件。但是，MySQL (5.0.45) 报告“'where 子句'中的未知列'outertable.id'”。这种查询可能吗？

内部查询使用 GROUP BY 将行旋转到列。这可以完全在外部查询中执行，但由于额外的连接可能会产生额外的开销。

或者，我可以在内部查询中省略 WHERE 条件，而是指定 ON outertable.id = innerquery.id，但它会获取整个内部查询行集以再次加入外部查询，这是低效的。

实际的 SQL 如下所示：

```
select t.ticketid, u.userid, t.fullname, u.loginapi_userid, t.email, tp.subject, tp.contents, a.PhoneNumber, a.Location, a.Extension, a.BusinessUnit, a.Department
from swtickets t
inner join swticketposts tp on t.ticketid = tp.ticketid
inner join swusers u on t.userid = u.userid
left join
  (
  select
  cfv.typeid,
  min(case cfv.customfieldid when 1 then cfv.fieldvalue end) as 'PhoneNumber',
  min(case cfv.customfieldid when 3 then cfv.fieldvalue end) as 'Location',
  min(case cfv.customfieldid when 5 then cfv.fieldvalue end) as 'Extension',
  min(case cfv.customfieldid when 8 then cfv.fieldvalue end) as 'BusinessUnit',
  min(case cfv.customfieldid when 9 then cfv.fieldvalue end) as 'Department'
  from swcustomfieldvalues cfv
  where cfv.typeid = t.ticketid
  group by cfv.typeid
  ) as a on 1 = 1
where t.ticketid = 2458; 
```

* * *

## 回答 #1

> 赞同：31
> 
>             
> 
> 时间：2009-02-12T18:57:24.253

您的问题的答案是否定的，不可能像您那样引用相关名称。派生表是在外部查询开始评估连接之前由内部查询生成的。因此，内部查询无法使用`t`、`tp`和等相关名称。`u`

为了解决这个问题，我建议在内部查询中使用相同的常量整数值，然后在外部查询中使用真实条件而不是`1=1`.

```
SELECT t.ticketid, u.userid, t.fullname, u.loginapi_userid, t.email,
  tp.subject, tp.contents, a.PhoneNumber, a.Location, a.Extension,
  a.BusinessUnit, a.Department
FROM swtickets t
 INNER JOIN swticketposts tp ON (t.ticketid = tp.ticketid)
 INNER JOIN swusers u ON (t.userid = u.userid)
 LEFT OUTER JOIN (
  SELECT cfv.typeid,
    MIN(CASE cfv.customfieldid WHEN 1 THEN cfv.fieldvalue END) AS 'PhoneNumber',
    MIN(CASE cfv.customfieldid WHEN 3 THEN cfv.fieldvalue END) AS 'Location',
    MIN(CASE cfv.customfieldid WHEN 5 THEN cfv.fieldvalue END) AS 'Extension',
    MIN(CASE cfv.customfieldid WHEN 8 THEN cfv.fieldvalue END) AS 'BusinessUnit',
    MIN(CASE cfv.customfieldid WHEN 9 THEN cfv.fieldvalue END) AS 'Department'
  FROM swcustomfieldvalues cfv
  WHERE cfv.typeid = 2458
  GROUP BY cfv.typeid
  ) AS a ON (a.typeid = t.ticketid)
WHERE t.ticketid = 2458; 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T03:04:00.683

您正在使用 Entity-Attribute-Value 设计，如果您尝试生成常规结果集，最终将无法使其具有可扩展性。不要尝试在一个查询中执行此操作。

相反，首先查询您的规范化表：

```
SELECT t.ticketid, u.userid, t.fullname, u.loginapi_userid, t.email, 
  tp.subject, tp.contents
FROM swtickets t
 INNER JOIN swticketposts tp ON (t.ticketid = tp.ticketid)
 INNER JOIN swusers u ON (t.userid = u.userid)
WHERE t.ticketid = 2458; 
```

然后查询您的自定义字段，并在结果集的多行上显示结果：

```
SELECT cfv.customfieldid, cfv.fieldvalue
FROM swcustomfieldvalues cfv
WHERE cfv.typeid = 2458; 
```

您将在结果集中获得多行，每个自定义字段一行：

```
+---------------+--------------+
| customfieldid | fieldvalue   |
+---------------+--------------+
|             1 | 415-555-1234 |
|             3 | Third office |
|             5 | 123          |
|             8 | Support      |
|             9 | Engineering  |
+---------------+--------------+ 
```

然后，您需要编写应用程序代码以循环将结果集字段映射到应用程序对象字段。

以这种方式使用实体-属性-值表在性能和代码维护方面更具可扩展性。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T01:37:27.197

我会用多个连接来编写它。当您说它“可能会产生额外的开销”时，这告诉我您尚未对其进行确定。如果您有不错的索引，则连接应该是微不足道的。

这也只显示了通用“hold all”表设计模式的缺陷之一。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T22:55:50.127

我的建议将是你以效率为由排除的。例如，省略 where 子句并使用连接（根据 t.ticketid = a.ticketid）

您是否能够通过一些具体的例子来证明您对低效率的看法？我知道您在说什么，但是无论您使用外部查询中的每一行的任何方法都将连接到内部查询中的每一行，因此根据执行计划，它可能不会像您怀疑的那样低效？

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:09:36.503

我想问题是'cfv.typeid = t.ticketid'呢？我的想法是，虽然 MySQL 支持相关子查询，但您尝试做的事情似乎在连接中可能会失败，因为“内部”查询并不是真正“在”查询的其余部分，就像它是在 WHERE 子句中。但看起来您可以将 where 子句从子查询中取出，并在 a.typeid = t.ticketid 上设置您的连接条件。

# c# - 具有企业应用程序块的自定义跟踪侦听器

> ID：530385
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-09T22:38:39.123
> 
>         
> 
> 标签：c#, logging, enterprise-library

我目前正在从事的项目使用 Enterprise Libraries V3.1 框架进行日志记录。

我需要获取生成的日志文件并在特定点将其归档。内置的跟踪侦听器似乎在记录事件之间保持文件打开。我已经设置了一个自定义跟踪侦听器，它将附加到文件并关闭它，以便该文件始终是可移动的。

它看起来像这样（为了清楚起见，减去错误处理）：

```
[ConfigurationElementType(typeof(CustomTraceListenerData))]
public class AlwaysClosedTextFileTraceListener : CustomTraceListener
{
    private string logFilePath;

    public AlwaysClosedTextFileTraceListener ()
    {
        logFilePath = @"hardcodedpath\log.txt";
    }

    public override void Write(string message)
    {
        using (StreamWriter logFile = File.AppendText(logFilePath))
        {
            logFile.Write(message);
            logFile.Flush();
            logFile.Close();
        }
    }

    public override void WriteLine(string message)
    {
        using (StreamWriter logFile = File.AppendText(logFilePath))
        {
            logFile.WriteLine(message);
            logFile.Flush();
        }
    }

    public override void TraceData(TraceEventCache eventCache, string source, TraceEventType eventType, int id, object data)
    {
        if (data is LogEntry && this.Formatter != null)
        {
            WriteLine(this.Formatter.Format(data as LogEntry));
        }
        else
        {
            WriteLine(data.ToString());
        }
    }
} 
```

这很好用，但我更愿意以某种方式将路径作为参数传递，而不是对其进行硬编码。

为了好玩，我尝试将它添加到构造函数中，看看会发生什么：

```
 public LogFolderTraceListener(string logFilePath)
    {
        this.logFilePath = logFilePath;
    } 
```

当我这样做时，我收到一条错误消息，提示我做错了什么：

```
System.InvalidOperationException : The type 'AlwaysClosedTextFileTraceListener' specified for custom trace listener named 'MyLogFile' does not a default constructor, which is required when no InitData is specified in the configuration. 
```

从这里开始，我的调查已经非常接近死胡同的反面，无限概率问题。

我在翻阅内置的源代码时发现了这个`RollingTraceListener`

*   有一个类`RollingFlatFileTraceListenerData : TraceListenerData`似乎包含传递给构造函数的所有设置

*   在文件底部露营的`RollingFlatFileTraceListenerData`是`RollingTraceListenerAssembler : TraceListenerAsssembler`似乎是工厂的类

*   还有另一个类`SystemDiagnosticsTraceListenerNode : TraceListenerNode`似乎使`Data`该类可呈现给配置应用程序

我的问题是：如何`CustomTraceListener`使用可配置参数创建一个`path`？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-10-13T06:43:35.400

CustomTraceListener 派生自 TraceListener，它有一个名为 Attributes 的 StringDictionary。

这将包含 TraceListener 配置行中的所有属性，并且可以通过名称获取，例如。

```
string logFileName= Attributes["fileName"] 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-09-10T00:38:10.950

我怀疑也许企业应用程序块虽然（可能）很棒，但看起来不必要地复杂，最终比它们对这种定制的价值还要麻烦。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-10-08T20:04:08.403

问题是典型的微软..（在此处添加您自己的形容词）..

1）当您添加自定义跟踪侦听器时，添加的“原始”app.config 语句为：

```
 name="Custom Trace Listener" initializeData="" formatter="Text Formatter" /> 
```

2）注意'initializeData' - 这就是神秘的错误消息所称的'InitData'。

3）所以它的意思是你需要有一个接受初始化数据的构造函数——用vb的说法：

```
 sub new (byval initstuff as string) 
```

4) 或删除 'initializeData=""' 并有一个默认构造函数：

```
 sub new() 
```

我怀疑 P&P 的人生活在泡沫中。里克斯。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-09-11T21:57:23.397

值得的是我如何实现它。在我的 this.buildCurrPath() 中，我可以从配置文件中读取，或者在这种情况下，我只是获取 Web 应用程序的“启动板”。但它对我来说很好。我还没有将它放入任何生产代码中，但它应该很快就会消失。

```
[ConfigurationElementType(typeof(CustomTraceListenerData))]
public class CustomListener: CustomTraceListener
{

    #region Fields (3) 
    private int logSize;
    StreamWriter sw;
    #endregion Fields 

    #region Constructors (1) 

    public CustomListener ():base()
    {
        string startPath = this.buildCurrPath();
        sw = new StreamWriter(startPath + "\\Logs\\test.log");
        sw.AutoFlush = true;

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2010-01-26T10:38:07.120

我刚刚遇到了同样的问题（Enterprise Library v4.1 除外）。

我找到的解决方案是删除默认构造函数，并且只有一个带有文件名字符串参数的构造函数，即

```
public AlwaysClosedTextFileTraceListener (string pathParameter)   
{   
    logFilePath = pathParameter;   
} 
```

然后在 app.config 中将您的路径放入`initializeData`参数中

```
<add ... initializeData="C:\Logs\myLog.log" /> 
```

虽然 Entriprise Library 配置编辑器无法识别这一点，并且没有尽可能整洁，但只要只有一个参数，它就可以工作。

如果有人知道如何正确地做到这一点，请发布并让我们知道 - 这当然不应该这么困难。

# visual-studio - VisualStudio MSI 引导加载程序错误和替换

> ID：530394
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-09T22:40:41.583
> 
>         
> 
> 标签：visual-studio, installation, windows-installer, bootstrapper

现在，我正在使用 Visual Studio 创建一个 msi 和一个 setup.exe。它工作得很好......直到最近。

我最近向 msi 添加了一个带有组合框控件的新对话框。现在，当我直接使用 msi 安装应用程序时，一切正常。

但是当我运行 Setup.exe 时，ComboBox 没有正确显示。它一次只在下拉列表中显示一个元素。所有元素仍然存在，我什至可以使用向上/向下键或字母（例如，SQL Server 的“S”）来选择它们。  

有没有人见过这种问题？此外，当我使用 InstallShield 创建设置时，InstallShield 创建的 exe 再次运行良好。

所以我想我需要用 Visual Studio 修复那个。任何想法如何修复视觉工作室引导程序？

**平台：**

使用 Visual Studio 2005 进行构建。  

操作系统：Windows XP SP3。

构建机器安装了 Windows Installer 4.5，但它不是先决条件。msi 本身在 Windows Installer 3 中运行良好。

此外，问题不在于安装程序退出太快，或者它没有正确安装......确实如此。唯一的问题是组合框没有正确显示，这可能会使一些用户感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:04:12.773

您使用的是哪个版本的 Visual Studio？你用的是VS2008 SP1吗？

在 SP1 中引入的此版本的 Visual Studio 中的引导程序存在一个已知问题。也许您面临同样的问题？您可以在 Microsoft 的连接站点上查看有关此问题的详细信息：

[https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=369138](https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=369138) 

这里还有一个讨论：http: [//social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/3731985c-d9cc-4403-ab7d-992a0971f686/](http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/3731985c-d9cc-4403-ab7d-992a0971f686/)

编辑：实际上在 SP1 中修复的东西也可以解决你的问题。SP1 的不同之处在于引导程序启动实际 MSI 安装程序的方式。在 SP1 之前，MSI 安装（即 msiexec）作为引导程序（即 setup.exe）的子进程启动。现在它作为非子进程启动，并且 setup.exe 在引导过程完成并启动 MSI 后立即返回。您还可以看到差异，因为之前设置向导中的按钮没有使用 Windows XP / Vista 主题样式。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-03-12T15:22:23.700

我无法准确找出为什么 VS 引导程序的行为方式如此，但是从另一个项目（不是使用 VS 构建）中获取另一个 Setup.exe 解决了这个问题。

[我的印象是 Setup.exe 具有某种识别信息或指向它应该启动的 MSI 的链接。显然不是。只需投入另一个 setup.exe 就可以了。]

希望这可以帮助某人。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-14T03:53:25.577

在 .MSI 本身中，组合框控件的高度设置是什么？height 属性控制选择区域和放置区域的组合高度。如果它设置得太低，那么你会得到你所描述的问题行为（尽管这不能解释为什么有时它看起来是正确的）。

# algorithm - 如何在 2D 中绘制透视校正网格

> ID：530396
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-02-09T22:41:03.453
> 
>         
> 
> 标签：algorithm, graphics, geometry, 2d, augmented-reality

我有一个应用程序，它在图像/照片之上定义了一个真实世界的矩形，当然在 2D 中它可能不是一个矩形，因为你是从一个角度看它。

问题是，假设矩形需要在其上绘制网格线，例如，如果它是 3x5，那么我需要从第 1 面到第 3 面绘制 2 条线，从第 2 面到第 4 面绘制 4 条线。

截至目前，我将每条线分成等距的部分，以获得所有网格线的起点和终点。然而，矩形的角度越大，这些线就越“不正确”，因为离你越远的水平线应该更靠近。

有谁知道我应该搜索的算法的名称？

**是的，我知道您可以在 3D 中执行此操作，但是对于此特定应用程序，我仅限于 2D。**

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-02-10T04:02:48.343

[这是](https://web.archive.org/web/20160418004152/http://freespace.virgin.net/hugo.elias/graphics/x_persp.htm)解决方案。

基本思想是您可以通过对角连接角找到矩形的正确透视“中心”。两条结果线的交点是您的透视正确中心。从那里您将矩形细分为四个较小的矩形，然后重复该过程。次数取决于您想要的准确度。您可以细分到像素大小以下，以获得有效的完美透视。

然后在您的子矩形中，您只需应用标准未校正的“纹理”三角形或矩形或其他任何东西。

您可以执行此算法，而无需费心构建“真实”3d 世界。如果您*确实*有一个真实的 3D 世界建模，但您的纹理三角形没有在硬件中进行透视校正，或者您需要一种高性能的方法来获得透视正确的平面，而无需每像素渲染技巧，这也很有用。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2012-11-22T07:34:25.363

![图片描述](https://i.stack.imgur.com/lvQXo.jpg)
图片：双线性和透视变换的示例（注意：上下水平网格线的高度实际上是其余线高度的一半，在两张图中）

=========================================

我知道这是一个老问题，但我有一个通用的解决方案，所以我决定发布它，希望它对未来的读者有用。下面的代码可以绘制任意透视网格，无需重复计算。

我实际上是从一个类似的问题开始的：绘制一个 2D 透视网格，然后转换下划线图像以恢复透视。

我开始在这里阅读：
 [http ://www.imagemagick.org/Usage/distorts/#bilinear_forward](http://www.imagemagick.org/Usage/distorts/#bilinear_forward)

然后在这里（Leptonica 图书馆）：
 http: [//www.leptonica.com/affine.html](http://www.leptonica.com/affine.html)

我发现了这个：

> 当您在有限距离内从某个任意方向查看平面上的物体时，您会在图像中获得额外的“梯形失真”失真。这是一种投影变换，它保持直线笔直，但不保留线之间的角度。这种扭曲不能用线性仿射变换来描述，事实上，分母中的 x 和 y 相关项不同。

正如许多人已经在此线程中指出的那样，这种转换不是线性的。它涉及求解一个由 8 个方程组成的线性系统（一次）以计算 8 个所需的系数，然后您可以使用它们来转换任意数量的点。

为了避免在我的项目中包含所有 Leptonica 库，我从中提取了一些代码，删除了所有特殊的 Leptonica 数据类型和宏，修复了一些内存泄漏并将其转换为 C++ 类（主要是出于封装原因）只做一件事：它将 (Qt) QPointF float (x,y) 坐标映射到相应的透视坐标。

如果你想让代码适应另一个 C++ 库，唯一需要重新定义/替换的是 QPointF 坐标类。

我希望一些未来的读者会发现它有用。下面的代码分为3部分：

A.如何使用genImageProjective C++类绘制2D透视Grid的示例

B. genImageProjective.h 文件

C. genImageProjective.cpp 文件

```
//============================================================
// C++ Code Example on how to use the 
//     genImageProjective class to draw a perspective 2D Grid
//============================================================

#include "genImageProjective.h"

// Input: 4 Perspective-Tranformed points:
//        perspPoints[0] = top-left
//        perspPoints[1] = top-right
//        perspPoints[2] = bottom-right
//        perspPoints[3] = bottom-left
void drawGrid(QPointF *perspPoints)
{
(...)
        // Setup a non-transformed area rectangle
        // I use a simple square rectangle here because in this case we are not interested in the source-rectangle,
        //  (we want to just draw a grid on the perspPoints[] area)
        //   but you can use any arbitrary rectangle to perform a real mapping to the perspPoints[] area
        QPointF topLeft = QPointF(0,0);
        QPointF topRight = QPointF(1000,0);
        QPointF bottomRight = QPointF(1000,1000);
        QPointF bottomLeft = QPointF(0,1000);
        float width = topRight.x() - topLeft.x();
        float height = bottomLeft.y() - topLeft.y();

        // Setup Projective trasform object
        genImageProjective imageProjective;
        imageProjective.sourceArea[0] = topLeft;
        imageProjective.sourceArea[1] = topRight;
        imageProjective.sourceArea[2] = bottomRight;
        imageProjective.sourceArea[3] = bottomLeft;
        imageProjective.destArea[0] = perspPoints[0];
        imageProjective.destArea[1] = perspPoints[1];
        imageProjective.destArea[2] = perspPoints[2];
        imageProjective.destArea[3] = perspPoints[3];
        // Compute projective transform coefficients
        if (imageProjective.computeCoeefficients() != 0)
            return; // This can actually fail if any 3 points of Source or Dest are colinear

        // Initialize Grid parameters (without transform)
        float gridFirstLine = 0.1f; // The normalized position of first Grid Line (0.0 to 1.0)
        float gridStep = 0.1f;      // The normalized Grd size (=distance between grid lines: 0.0 to 1.0)

        // Draw Horizonal Grid lines
        QPointF lineStart, lineEnd, tempPnt;
        for (float pos = gridFirstLine; pos <= 1.0f; pos += gridStep)
        {
            // Compute Grid Line Start
            tempPnt = QPointF(topLeft.x(), topLeft.y() + pos*width);
            imageProjective.mapSourceToDestPoint(tempPnt, lineStart);
            // Compute Grid Line End
            tempPnt = QPointF(topRight.x(), topLeft.y() + pos*width);
            imageProjective.mapSourceToDestPoint(tempPnt, lineEnd);

            // Draw Horizontal Line (use your prefered method to draw the line)
            (...)
        }
        // Draw Vertical Grid lines
        for (float pos = gridFirstLine; pos <= 1.0f; pos += gridStep)
        {
            // Compute Grid Line Start
            tempPnt = QPointF(topLeft.x() + pos*height, topLeft.y());
            imageProjective.mapSourceToDestPoint(tempPnt, lineStart);
            // Compute Grid Line End
            tempPnt = QPointF(topLeft.x() + pos*height, bottomLeft.y());
            imageProjective.mapSourceToDestPoint(tempPnt, lineEnd);

            // Draw Vertical Line (use your prefered method to draw the line)
            (...)
        }
(...)
}

==========================================

//========================================
//C++ Header File: genImageProjective.h
//========================================

#ifndef GENIMAGE_H
#define GENIMAGE_H

#include <QPointF>

// Class to transform an Image Point using Perspective transformation
class genImageProjective
{
public:
    genImageProjective();

    int computeCoeefficients(void);
    int mapSourceToDestPoint(QPointF& sourcePoint, QPointF& destPoint);

public:
    QPointF sourceArea[4]; // Source Image area limits (Rectangular)
    QPointF destArea[4];   // Destination Image area limits (Perspectivelly Transformed)

private:
    static int gaussjordan(float  **a, float  *b, int n);

    bool coefficientsComputed;
    float vc[8];           // Vector of Transform Coefficients
};

#endif // GENIMAGE_H
//========================================

//========================================
//C++ CPP File: genImageProjective.cpp
//========================================

#include <math.h>
#include "genImageProjective.h"

// ----------------------------------------------------
// class genImageProjective
// ----------------------------------------------------
genImageProjective::genImageProjective()
{
    sourceArea[0] = sourceArea[1] = sourceArea[2] = sourceArea[3] = QPointF(0,0);
    destArea[0] = destArea[1] = destArea[2] = destArea[3] = QPointF(0,0);
    coefficientsComputed = false;
}

// --------------------------------------------------------------
// Compute projective transform coeeeficients
// RetValue: 0: Success, !=0: Error
/*-------------------------------------------------------------*
 *                Projective coordinate transformation         *
 *-------------------------------------------------------------*/
/*!
 *  computeCoeefficients()
 *
 *      Input:  this->sourceArea[4]: (source 4 points; unprimed)
 *              this->destArea[4]:   (transformed 4 points; primed)
 *              this->vc  (computed vector of transform coefficients)
 *      Return: 0 if OK; <0 on error
 *
 *  We have a set of 8 equations, describing the projective
 *  transformation that takes 4 points (sourceArea) into 4 other
 *  points (destArea).  These equations are:
 *
 *          x1' = (c[0]*x1 + c[1]*y1 + c[2]) / (c[6]*x1 + c[7]*y1 + 1)
 *          y1' = (c[3]*x1 + c[4]*y1 + c[5]) / (c[6]*x1 + c[7]*y1 + 1)
 *          x2' = (c[0]*x2 + c[1]*y2 + c[2]) / (c[6]*x2 + c[7]*y2 + 1)
 *          y2' = (c[3]*x2 + c[4]*y2 + c[5]) / (c[6]*x2 + c[7]*y2 + 1)
 *          x3' = (c[0]*x3 + c[1]*y3 + c[2]) / (c[6]*x3 + c[7]*y3 + 1)
 *          y3' = (c[3]*x3 + c[4]*y3 + c[5]) / (c[6]*x3 + c[7]*y3 + 1)
 *          x4' = (c[0]*x4 + c[1]*y4 + c[2]) / (c[6]*x4 + c[7]*y4 + 1)
 *          y4' = (c[3]*x4 + c[4]*y4 + c[5]) / (c[6]*x4 + c[7]*y4 + 1)
 *
 *  Multiplying both sides of each eqn by the denominator, we get
 *
 *           AC = B
 *
 *  where B and C are column vectors
 *
 *         B = [ x1' y1' x2' y2' x3' y3' x4' y4' ]
 *         C = [ c[0] c[1] c[2] c[3] c[4] c[5] c[6] c[7] ]
 *
 *  and A is the 8x8 matrix
 *
 *             x1   y1     1     0   0    0   -x1*x1'  -y1*x1'
 *              0    0     0    x1   y1   1   -x1*y1'  -y1*y1'
 *             x2   y2     1     0   0    0   -x2*x2'  -y2*x2'
 *              0    0     0    x2   y2   1   -x2*y2'  -y2*y2'
 *             x3   y3     1     0   0    0   -x3*x3'  -y3*x3'
 *              0    0     0    x3   y3   1   -x3*y3'  -y3*y3'
 *             x4   y4     1     0   0    0   -x4*x4'  -y4*x4'
 *              0    0     0    x4   y4   1   -x4*y4'  -y4*y4'
 *
 *  These eight equations are solved here for the coefficients C.
 *
 *  These eight coefficients can then be used to find the mapping
 *  (x,y) --> (x',y'):
 *
 *           x' = (c[0]x + c[1]y + c[2]) / (c[6]x + c[7]y + 1)
 *           y' = (c[3]x + c[4]y + c[5]) / (c[6]x + c[7]y + 1)
 *
 */
int genImageProjective::computeCoeefficients(void)
{
    int retValue = 0;
    int     i;
    float  *a[8];  /* 8x8 matrix A  */
    float  *b = this->vc; /* rhs vector of primed coords X'; coeffs returned in vc[] */

    b[0] = destArea[0].x();
    b[1] = destArea[0].y();
    b[2] = destArea[1].x();
    b[3] = destArea[1].y();
    b[4] = destArea[2].x();
    b[5] = destArea[2].y();
    b[6] = destArea[3].x();
    b[7] = destArea[3].y();

    for (i = 0; i < 8; i++)
        a[i] = NULL;
    for (i = 0; i < 8; i++)
    {
        if ((a[i] = (float *)calloc(8, sizeof(float))) == NULL)
        {
            retValue = -100; // ERROR_INT("a[i] not made", procName, 1);
            goto Terminate;
        }
    }

    a[0][0] = sourceArea[0].x();
    a[0][1] = sourceArea[0].y();
    a[0][2] = 1.;
    a[0][6] = -sourceArea[0].x() * b[0];
    a[0][7] = -sourceArea[0].y() * b[0];
    a[1][3] = sourceArea[0].x();
    a[1][4] = sourceArea[0].y();
    a[1][5] = 1;
    a[1][6] = -sourceArea[0].x() * b[1];
    a[1][7] = -sourceArea[0].y() * b[1];
    a[2][0] = sourceArea[1].x();
    a[2][1] = sourceArea[1].y();
    a[2][2] = 1.;
    a[2][6] = -sourceArea[1].x() * b[2];
    a[2][7] = -sourceArea[1].y() * b[2];
    a[3][3] = sourceArea[1].x();
    a[3][4] = sourceArea[1].y();
    a[3][5] = 1;
    a[3][6] = -sourceArea[1].x() * b[3];
    a[3][7] = -sourceArea[1].y() * b[3];
    a[4][0] = sourceArea[2].x();
    a[4][1] = sourceArea[2].y();
    a[4][2] = 1.;
    a[4][6] = -sourceArea[2].x() * b[4];
    a[4][7] = -sourceArea[2].y() * b[4];
    a[5][3] = sourceArea[2].x();
    a[5][4] = sourceArea[2].y();
    a[5][5] = 1;
    a[5][6] = -sourceArea[2].x() * b[5];
    a[5][7] = -sourceArea[2].y() * b[5];
    a[6][0] = sourceArea[3].x();
    a[6][1] = sourceArea[3].y();
    a[6][2] = 1.;
    a[6][6] = -sourceArea[3].x() * b[6];
    a[6][7] = -sourceArea[3].y() * b[6];
    a[7][3] = sourceArea[3].x();
    a[7][4] = sourceArea[3].y();
    a[7][5] = 1;
    a[7][6] = -sourceArea[3].x() * b[7];
    a[7][7] = -sourceArea[3].y() * b[7];

    retValue = gaussjordan(a, b, 8);

Terminate:
    // Clean up
    for (i = 0; i < 8; i++)
    {
        if (a[i])
            free(a[i]);
    }

    this->coefficientsComputed = (retValue == 0);
    return retValue;
}

/*-------------------------------------------------------------*
 *               Gauss-jordan linear equation solver           *
 *-------------------------------------------------------------*/
/*
 *  gaussjordan()
 *
 *      Input:   a  (n x n matrix)
 *               b  (rhs column vector)
 *               n  (dimension)
 *      Return:  0 if ok, 1 on error
 *
 *      Note side effects:
 *            (1) the matrix a is transformed to its inverse
 *            (2) the vector b is transformed to the solution X to the
 *                linear equation AX = B
 *
 *      Adapted from "Numerical Recipes in C, Second Edition", 1992
 *      pp. 36-41 (gauss-jordan elimination)
 */
#define  SWAP(a,b)   {temp = (a); (a) = (b); (b) = temp;}
int genImageProjective::gaussjordan(float  **a, float  *b, int n)
{
    int retValue = 0;
    int i, icol=0, irow=0, j, k, l, ll;
    int *indexc = NULL, *indexr = NULL, *ipiv = NULL;
    float  big, dum, pivinv, temp;

    if (!a)
    {
        retValue = -1; // ERROR_INT("a not defined", procName, 1);
        goto Terminate;
    }
    if (!b)
    {
        retValue = -2; // ERROR_INT("b not defined", procName, 1);
        goto Terminate;
    }

    if ((indexc = (int *)calloc(n, sizeof(int))) == NULL)
    {
        retValue = -3; // ERROR_INT("indexc not made", procName, 1);
        goto Terminate;
    }
    if ((indexr = (int *)calloc(n, sizeof(int))) == NULL)
    {
        retValue = -4; // ERROR_INT("indexr not made", procName, 1);
        goto Terminate;
    }
    if ((ipiv = (int *)calloc(n, sizeof(int))) == NULL)
    {
        retValue = -5; // ERROR_INT("ipiv not made", procName, 1);
        goto Terminate;
    }

    for (i = 0; i < n; i++)
    {
        big = 0.0;
        for (j = 0; j < n; j++)
        {
            if (ipiv[j] != 1)
            {
                for (k = 0; k < n; k++)
                {
                    if (ipiv[k] == 0)
                    {
                        if (fabs(a[j][k]) >= big)
                        {
                            big = fabs(a[j][k]);
                            irow = j;
                            icol = k;
                        }
                    }
                    else if (ipiv[k] > 1)
                    {
                        retValue = -6; // ERROR_INT("singular matrix", procName, 1);
                        goto Terminate;
                    }
                }
            }
        }
        ++(ipiv[icol]);

        if (irow != icol)
        {
            for (l = 0; l < n; l++)
                SWAP(a[irow][l], a[icol][l]);
            SWAP(b[irow], b[icol]);
        }

        indexr[i] = irow;
        indexc[i] = icol;
        if (a[icol][icol] == 0.0)
        {
            retValue = -7; // ERROR_INT("singular matrix", procName, 1);
            goto Terminate;
        }
        pivinv = 1.0 / a[icol][icol];
        a[icol][icol] = 1.0;
        for (l = 0; l < n; l++)
            a[icol][l] *= pivinv;
        b[icol] *= pivinv;

        for (ll = 0; ll < n; ll++)
        {
            if (ll != icol)
            {
                dum = a[ll][icol];
                a[ll][icol] = 0.0;
                for (l = 0; l < n; l++)
                    a[ll][l] -= a[icol][l] * dum;
                b[ll] -= b[icol] * dum;
            }
        }
    }

    for (l = n - 1; l >= 0; l--)
    {
        if (indexr[l] != indexc[l])
        {
            for (k = 0; k < n; k++)
                SWAP(a[k][indexr[l]], a[k][indexc[l]]);
        }
    }

Terminate:
    if (indexr)
        free(indexr);
    if (indexc)
        free(indexc);
    if (ipiv)
        free(ipiv);
    return retValue;
}

// --------------------------------------------------------------
// Map a source point to destination using projective transform
// --------------------------------------------------------------
// Params:
//  sourcePoint: initial point
//  destPoint:   transformed point
// RetValue: 0: Success, !=0: Error
// --------------------------------------------------------------
//  Notes:
//   1\. You must call once computeCoeefficients() to compute
//      the this->vc[] vector of 8 coefficients, before you call
//      mapSourceToDestPoint().
//   2\. If there was an error or the 8 coefficients were not computed,
//      a -1 is returned and destPoint is just set to sourcePoint value.
// --------------------------------------------------------------
int genImageProjective::mapSourceToDestPoint(QPointF& sourcePoint, QPointF& destPoint)
{
    if (coefficientsComputed)
    {
        float factor = 1.0f / (vc[6] * sourcePoint.x() + vc[7] * sourcePoint.y() + 1.);
        destPoint.setX( factor * (vc[0] * sourcePoint.x() + vc[1] * sourcePoint.y() + vc[2]) );
        destPoint.setY( factor * (vc[3] * sourcePoint.x() + vc[4] * sourcePoint.y() + vc[5]) );
        return 0;
    }
    else // There was an error while computing coefficients
    {
        destPoint = sourcePoint; // just copy the source to destination...
        return -1;               // ...and return an error
    }
}
//======================================== 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T04:27:20.390

使用 Breton 的细分方法（与 Mongo 的扩展方法有关），将为您提供准确的任意二次幂除法。要使用这些方法拆分为非二次幂分割，您必须细分为子像素间距，这在计算上可能很昂贵。

但是，我相信您可以将[Haga 定理](http://origami.gr.jp/Archives/People/CAGE_/divide/02-e.html)的变体（在折纸中用于将一边划分为 (N-1) 个的边分为 N 个）到透视正方形细分以产生任意划分最接近 2 的幂，而无需继续细分。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2012-01-31T06:19:57.190

最优雅和最快的解决方案是找到将矩形坐标映射到照片坐标的单应矩阵。

有了一个像样的矩阵库，只要你知道你的数学，它应该不是一项艰巨的任务。

关键词：准线，单应性，直接线性变换

然而，上面的递归算法应该可以工作，但如果你的资源有限，投影几何是唯一的方法。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2017-05-13T19:06:21.890

我认为所选答案不是可用的最佳解决方案。一个更好的解决方案是将矩形的透视（投影）变换应用于简单的网格，如下所示 Matlab 脚本和图像显示。您也可以使用 C++ 和 OpenCV 实现此算法。

```
function drawpersgrid
sz      = [ 24, 16 ]; % [x y]
srcpt   = [ 0 0; sz(1) 0; 0 sz(2); sz(1) sz(2)];
destpt  = [ 20 50; 100 60; 0 150; 200 200;];

% make rectangular grid
[X,Y]   = meshgrid(0:sz(1),0:sz(2));

% find projective transform matching corner points
tform   = maketform('projective',srcpt,destpt);

% apply the projective transform to the grid
[X1,Y1] = tformfwd(tform,X,Y);

hold on;

%% find grid

for i=1:sz(2)
    for j=1:sz(1)
        x = [ X1(i,j);X1(i,j+1);X1(i+1,j+1);X1(i+1,j);X1(i,j)];
        y = [ Y1(i,j);Y1(i,j+1);Y1(i+1,j+1);Y1(i+1,j);Y1(i,j)];
        plot(x,y,'b');
    end
end
hold off; 
```

[![投影网格](https://i.stack.imgur.com/lG1vO.png)](https://i.stack.imgur.com/lG1vO.png)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-13T13:23:00.100

*在特殊情况下*，当您垂直于边 1 和 3 时，您可以将这些边分成相等的部分。然后画一条对角线，通过对角线的每个交点和前面画的分界线画出与边 1 的平行线。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2014-04-14T15:51:42.700

这是我想出来的几何解决方案。我不知道“算法”是否有名字。

假设您想首先将“矩形”划分为 n 个带有垂直线的部分。

目标是将点 P1..Pn-1 放在顶线上，我们可以用它来画线穿过它们到左右线相交或平行的点，当这样的点不存在时。

如果顶线和底线彼此平行，只需放置这些点以等距分割角之间的顶线。

否则将 n 个点 Q1..Qn 放在左侧线上，使这些点和左上角等距，并且 i < j => Qi 比 Qj 更靠近左上角。为了将 Q 点映射到顶线，找到从 Qn 到右上角的线的交点 S，并通过顶线和底线的交点找到与左线平行的线。现在将 S 与 Q1..Qn-1 连接起来。新线与顶线的交点是所需的 P 点。

对水平线做这个模拟。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2015-09-30T07:26:48.343

给定绕 y 轴的旋转，特别是如果旋转表面是平面的，则透视是由垂直梯度生成的。这些在视角上逐渐接近。而不是使用对角线来定义四个矩形，它可以在给定二的幂的情况下工作......定义两个矩形，左右。如果继续将表面划分为更窄的垂直部分，它们最终会高于宽度。这可以适应非方形的表面。如果围绕 x 轴旋转，则需要水平渐变。

* * *

## 回答 #9

> 赞同：-1
> 
>             
> 
> 时间：2009-02-09T23:31:07.920

您需要做的是在 3D（世界）中表示它，然后将其投影到 2D（屏幕）。

这将要求您使用 4D 变换矩阵，该矩阵将 4D 齐次投影到 3D 齐次向量，然后您可以将其向下转换为 2D 屏幕空间向量。

我在谷歌也找不到它，但是一本好的计算机绘图书会有详细信息。

关键词是投影矩阵、投影变换、仿射变换、齐次向量、世界空间、屏幕空间、透视变换、3D变换

顺便说一句，这通常需要几个讲座来解释所有这些。祝你好运。

# c# - 如何在主容器中注册类型，但在子容器中解析？

> ID：530405
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-09T22:44:07.923
> 
>         
> 
> 标签：c#, dependency-injection, unity-container

我有一个统一容器，用于`RegisterType`注册以下存储库和实现者，使用`ContainerControlledLifetimeManager`.

```
public interface IPersonRepository
{
  Person GetByID(ObjectSpace objectSpace, int id);
} 
```

使用这种模式，我可以让多个线程（它是一个 Web 应用程序）同时使用同一个存储库实例，尽管每个线程都使用不同的`ObjectSpace`（这是一个本地缓存 + 用于从数据库中获取对象的机制 +一个工作单元等）。但这让我觉得“肮脏”，而不是那种好:-)

我真正想要的是：

```
public interface IPersonRepository
{
  Person GetByID(int id);
} 
```

为此，我必须创建一个子容器并使用它`RegisterInstance`来注册我的`ObjectSpace`. 只要我要么：

1.  `IPersonRepository`而是在子容器中注册

2.  将生命周期管理器更改为`TransientLifetimeManager`

我也不想做。(1) 工作量太大，我想在父容器中注册一次，然后不再注册。(2) 可以，但是如果有很多依赖项，那么所有这些也必须是暂时的，这将导致每次我需要人员存储库时都会创建很多实例。

所以我的问题是：有没有办法在父容器中注册类型，但是要解析容器生命周期实例并将其存储在子容器而不是父容器中？也许有一种使用自定义生命周期管理器或其他方法的方法？

我想要实现的是：

```
UnityContainer unityContainer = new UnityContainer();
//Might be a custom manager or something
unityContainer.RegisterType<IPersonRepository, PersonRepository>
  (new ContainerControlledLifetimeManager()); 
using (var childContainer = unityContainer.CreateChildContainer())
{
    childContainer.RegisterInstance<ObjectSpace>(new MyObjectSpace());
    //01 Resolves a new instance inside the child container
    var repository = childContainer.Resolve<IPersonRepository>();
    //02 resolves same instance as 01
    repository = childContainer.Resolve<IPersonRepository>();
}

using (var childContainer = unityContainer.CreateChildContainer())
{
    childContainer.RegisterInstance<ObjectSpace>(new MyObjectSpace());
    //03 Resolves a new instance inside the child container
    var repository = childContainer.Resolve<IPersonRepository>();
    //04 resolves same instance as 03
    repository = childContainer.Resolve<IPersonRepository>(); //Resolves the same instance
} 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2016-01-18T20:30:13.817

由于提出了一个新问题`HierarchicalLifetimeManager`，因此在 Unity 中添加了一个新问题，因此在注册类型时应该使用它。

# .net - 链接到链接到静态库的静态库

> ID：530420
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-09T22:49:07.193
> 
>         
> 
> 标签：.net, c++, .net-2.0

我有一个链接到静态库的（托管/非托管 C++）winforms 应用程序。该库链接到另一个静态库。当我对 Winforms 项目进行重建时，Visual Studio 2005 会尝试重建引用静态库，但不会重建超过一层。这导致我不得不手动重新构建叶子项目，然后重新构建到 Winforms 项目的链。有没有办法强制进行更深层次的重建？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T22:53:31.770

我应该将所有静态库作为依赖项添加到 Winform 应用程序吗？

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T22:53:56.357

当然。只需确保第 n 级库项目在同一个解决方案中，并且直接依赖的库对它有依赖关系。VS 应该重建两者。这至少适用于本机 C++，也应该适用于托管的 IFAIK。

# linux - 在没有 unistd.h 的情况下获取当前进程的进程 ID

> ID：530425
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-09T22:51:45.800
> 
>         
> 
> 标签：linux, linux-kernel, kernel

我正在研究死锁检测算法，我只得到内核级库，即`#include <linux/somelibrary>`没有别的。是否有内核级工具可以让我获得类似于 of 的当前进程的[`getpid()`](http://www.kernel.org/doc/man-pages/online/pages/man2/getpid.2.html)pid [`unistd.h`](http://en.wikipedia.org/wiki/Unistd.h)？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-02-09T23:22:50.357

我做了一些快速的研究，我找到了答案。非常感谢您的指导。我使用的快速代码是：

```
printf("My current process id/pid is %d\n", current->pid); 
```

再次感谢！

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-09T23:03:44.070

这个问题意义不大。

你在写基于内核的代码吗？在这种情况下，您可以使用指向当前任务的任务结构（包含具有 pid 的成员）的“当前”宏来获取当前任务的 pid。只有当您的内核代码在“当前任务”有意义的上下文中运行（即不是中断、tasklet 等）时，这才有效。

如果您正在编写用户空间代码，那么您应该没有理由不能调用 getpid，它是来自 unistd.h 中定义的 C 库（或它包含的东西）的库调用，它会进行系统调用。如果有这样的原因，请说明。

在 Linux 中进行系统调用并不是特别困难，但确实涉及到您不想编写的特定于体系结构的代码。

# asp.net - 在 Ruby 中重新实现 ASP.NET 成员资格和用户密码哈希

> ID：530426
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-02-09T22:52:00.370
> 
>         
> 
> 标签：asp.net, ruby-on-rails, ruby, base64, sha1

我有一个庞大的用户数据库（约 200,000），我正在将其从 ASP.NET 应用程序转移到 Ruby on Rails 应用程序。我真的不想要求每个用户重置他们的密码，所以我试图在 Ruby 中重新实现 C# 密码散列函数。

旧功能是这样的：

```
public string EncodePassword(string pass, string saltBase64)
 {
     byte[] bytes = Encoding.Unicode.GetBytes(pass);
     byte[] src = Convert.FromBase64String(saltBase64);
     byte[] dst = new byte[src.Length + bytes.Length];
     Buffer.BlockCopy(src, 0, dst, 0, src.Length);
     Buffer.BlockCopy(bytes, 0, dst, src.Length, bytes.Length);
     HashAlgorithm algorithm = HashAlgorithm.Create("SHA1");
     byte[] inArray = algorithm.ComputeHash(dst);
     return Convert.ToBase64String(inArray);
 } 
```

一个示例哈希密码和盐是（并且使用的密码是“密码”）：

散列密码：“weEWx4rhyPtd3kec7usysxf7kpk=”盐：“1ptFxHq7ALe7yXIQDdzQ9Q==”密码：“密码”

现在使用以下 Ruby 代码：

```
require "base64"
require "digest/sha1"

password = "password"
salt = "1ptFxHq7ALe7yXIQDdzQ9Q=="

concat = salt+password

sha1 = Digest::SHA1.digest(concat)

encoded = Base64.encode64(sha1)

puts encoded 
```

我没有得到正确的密码哈希（我得到的是“+BsdIOBN/Vh2U7qWG4e+O13h3iQ=”而不是“weEWx4rhyPtd3kec7usysxf7kpk=”）。谁能看到问题可能是什么？

非常感谢

阿尔丰

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-11T11:56:30.220

只是快速更新，我的一个同事已经解决了这个问题：

```
require "base64"
require "digest"
require "jcode"

def encode_password(password, salt)
 bytes = ""
 password.each_char { |c| bytes += c + "\x00" }
 salty = Base64.decode64(salt)
 concat = salty+bytes
 sha1 = Digest::SHA1.digest(concat)
 encoded = Base64.encode64(sha1).strip()
 puts encoded
end 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2011-11-18T15:11:16.253

我的任务是将现有的 .NET 应用程序迁移到 Ruby on Rails。我正在使用下面的代码来模拟 .NET 密码散列。我对 Ruby 很陌生，根本不了解 .NET。代码可能不够干净，但这是一个开始。

要进行测试，请将其保存为 Ruby 脚本并运行：

ruby 脚本 plain_text_password salt_in_base64

例如

ruby dotNetHash.rb 密码123 LU7hUk4MXAvlq6DksvP9SQ==

```
require "base64"
require "digest"

# Encode password as double-width characters
password_as_text = ARGV.first
double_width_password = []
double_width_password = password_as_text.encode("UTF-16LE").bytes.to_a

# Unencode the salt
salt = Base64.decode64(ARGV[1])

# Concatenate salt+pass
salt_pass_array = []
salt_pass_array = salt.bytes.to_a + double_width_password

# Repack array as string and hash it. Then encode.
salt_pass_str = salt_pass_array.pack('C*')
sha1_saltpass = Digest::SHA1.digest(salt_pass_str)
enc_sha1_saltpass = Base64.encode64(sha1_saltpass).strip()
puts "Encoded SHA1 saltpass is " + enc_sha1_saltpass 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T23:11:39.073

你很接近。不幸的是，Ruby 目前没有内置的 unicode 支持，您的散列函数依赖于它。有解决方法。环顾该站点，了解如何在 Ruby 中执行 unicode。顺便说一句，我认为您忘记了对盐进行 base64 解码，看起来 ASP.net 函数可以做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:01:33.187

您需要对盐进行解码以将其转换回其字节表示形式，然后将其与密码连接以获得散列密码值。您直接使用编码盐字符串（这是一种不同的盐），因此它散列到不同的东西。

```
require "base64"
require "digest/sha1"
password = "password"
salt = Base64.decode64("1ptFxHq7ALe7yXIQDdzQ9Q==")
concat = salt+password
sha1 = Digest::SHA1.digest(concat)
encoded = Base64.encode64(sha1)
puts encoded 
```

# c# - 添加代码库作为参考，而不是复制 Visual Studio

> ID：530429
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-09T22:52:43.037
> 
>         
> 
> 标签：c#, visual-studio, silverlight

对于 C# 专业人士来说，这可能是一个荒谬的问题，但我来了。我是一名开始使用 Silverlight 的 Flash 开发人员，我正在尝试弄清楚如何为动画创建“代码库”（一组可重用的类）。我想将它存储在一个位置并在一堆不同的项目中重复使用它。通常在 Flash 中，我会添加一个“项目路径”引用，然后开始使用代码。我的问题是，如何向 Visual Studio 添加一个文件夹，以便我可以在我的项目中“使用”这些类。我尝试了“添加>现有项目”，但将文件复制到了我的项目目录中。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-09T22:57:51.743

最简单的方法是创建一个新`ClassLibrary`项目并构建它。这将`.dll`在您可以在项目设置菜单中指定的文件夹中输出一个文件，您可以从每个需要它的项目中引用该文件。

此外，您可以将其复制`.dll`到`/bin/`项目的文件夹中 - 这将对这个特定项目执行相同的操作，但是当您开始下一个项目时，您可以更改代码库中的一些细节而不会破坏第一个项目。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T02:17:33.743

Tomas 描述的解决方案（添加对 dll 二进制文件的引用）是该问题的正确解决方案；比引用源代码并将其编译到每个项目中更好。

但只是为了获得更多信息，如果您*确实*需要将源代码文件添加到您的 Visual Studio 项目而不复制该文件，您可以使用以下步骤：

1.  在解决方案资源管理器中右键单击您的项目，然后选择添加 -> 现有项目。

2.  导航到源代码文件的位置并选择它。

3.  在对话窗口的“添加”按钮上有一个下拉箭头。单击此按钮并选择“添加为链接”。

这将允许您在项目中使用此源代码文件，而无需 VS 复制该文件。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T22:59:41.413

在解决方案资源管理器中，右键单击项目节点，然后单击添加引用。

在“添加引用”对话框中，选择指示要引用的组件类型的选项卡。（例如对于一个类库一个 dll）

选择要引用的组件，然后单击“确定”。

# editor - RTF 编辑器

> ID：530430
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2009-02-09T22:52:47.043
> 
>         
> 
> 标签：editor, document, rtf

我有一个用 RTF 编写的模板（一些标签被应用程序中的 DB 数据替换），但是当我在 MS Word 中编辑它们时，Word 将一些不可见的标签放到模板中，这会破坏我的标签（我必须在记事本和编辑代码）。你知道一些严格遵循 RTF 规范的 RTF 编辑器吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-09T22:55:09.660

在 Windows 上，我认为包含的应用程序写字板相当不错。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2015-03-17T17:52:32.937

RTF 规范允许 RTF 编辑器（如 Word）或第三方控件在 RTF 文本之间添加标签，前提是保持实际的 RTF 显示。因此，无法保证您的原始模板文本不会受到干扰。出于这个原因，我建议使用 RTF 编辑器 API 在您的模板中进行任何搜索/替换。RTF 编辑器知道将 RTF 标签放在一边并按预期访问原始文本。

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2009-02-10T17:06:57.047

好的，我知道 google 会找到一堆编辑器，但我没有时间尝试每个编辑器来找出最好的一个。

所以我寻找好的建议，而不是可行的建议

编辑：我发现并使用此解决方案数周

[特编辑](http://www.subsystems.com/tewf.htm)

并且非常好，我推荐它。

# asp.net - 下拉列表选择上的模态弹出窗口

> ID：530438
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-09T22:54:28.647
> 
>         
> 
> 标签：asp.net

是否可以在下拉列表选择中弹出模式（AJAX）。我有一个具有 ddl 的用户控件和另一个具有该模式弹出窗口的用户控件。在选择特定项目时，我需要弹出模式。模态弹出窗口位于另一个用户控件中。  

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T02:33:58.480

我做了一个例子，说明如何使用 ClientEventPool 完全在客户端 - [http://www.aaron-powell.com/blog/january-2009/fun-with-a-client-event-pool-and-modal-弹出窗口.aspx](http://www.aaron-powell.com/blog/january-2009/fun-with-a-client-event-pool-and-modal-popups.aspx)

对于 AJAX 工作，不惜一切代价避免回发！

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:16:29.297

如果我没看错，您将需要使用链式事件或事件冒泡来强制下拉选择触发事件。然后您的第二个用户控件必须侦听该事件，并触发“显示”模式弹出窗口的事件。

如果不测试代码，您在主控件上的结构可能如下所示：

```
public delegate void DDLHandler(int selectedValue);

public event DDLHandler DDLChanged;

public void DDLChanged(int selection)
{
    if (DDLChanged != null)
    {
        DDLChanged(selection);
    }
} 
```

然后你下拉控件有它的事件有线调用处理程序

```
protected void ddlOne_SelectedIndexChanged(object sender, EventArgs e)
{

    //fire event handler for fetching value for this selection
    DDLChanged(Int32.Parse(ddlMeasurementOptions.SelectedValue));
} 
```

# java - 您将如何使用正则表达式来忽略包含特定子字符串的字符串？

> ID：530441
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-09T22:55:10.970
> 
>         
> 
> 标签：java, regex, regex-negation

我将如何使用否定的lookbehind（或任何其他方法）正则表达式来忽略包含特定子字符串的字符串？

我已经阅读了之前的两个 stackoverflow 问题：

[java-regexp-for-file-filtering](https://stackoverflow.com/questions/367862/java-regexp-for-file-filtering) 

[regex-to-match-against-something-that-is-not-a-specific-substring](https://stackoverflow.com/questions/42990/regex-to-match-against-something-that-is-not-a-specific-substring)

它们*几乎*是我想要的......我的问题是字符串没有以我想要忽略的结尾。如果这样做，这将不是问题。

我有一种感觉，这与环视是零宽度的事实有关，并且在第二次通过字符串时匹配...但是，我不太确定内部结构。

无论如何，如果有人愿意花时间解释一下，我将不胜感激。

这是我想忽略的输入字符串的示例：

192.168.1.10 - - [08/Feb/2009:16:33:54 -0800] “GET /FOO/BAR/HTTP/1.1”200 2246

这是我想保留以供进一步评估的输入字符串的示例：

192.168.1.10 - - [08/Feb/2009:16:33:54 -0800] “GET /FOO/BAR/content.js HTTP/1.1”200 2246

对我来说，关键是我想忽略任何在文档根默认页面之后的 HTTP GET。

以下是我的小测试工具和迄今为止我提出的最好的 RegEx。

```
public static void main(String[] args){
String inString = "192.168.1.10 - - [08/Feb/2009:16:33:54 -0800] \"GET /FOO/BAR/ HTTP/1.1\" 200 2246";
//String inString = "192.168.1.10 - - [08/Feb/2009:16:33:54 -0800] \"GET /FOO/BAR/content.js HTTP/1.1\" 200 2246";
//String inString = "192.168.1.10 - - [08/Feb/2009:16:33:54 -0800] \"GET /FOO/BAR/content.js HTTP/"; // This works
//String inString = "192.168.1.10 - - [08/Feb/2009:16:33:54 -0800] \"GET /FOO/BAR/ HTTP/"; // This works
String inRegEx = "^.*(?:GET).*$(?<!.?/ HTTP/)";
try {
  Pattern pattern = Pattern.compile(inRegEx);

  Matcher matcher = pattern.matcher(inString);

  if (matcher.find()) {
    System.out.printf("I found the text \"%s\" starting at " +
"index %d and ending at index %d.%n",
matcher.group(), matcher.start(), matcher.end());
  } else {
    System.out.printf("No match found.%n");
  }
} catch (PatternSyntaxException pse) {
  System.out.println("Invalid RegEx: " + inRegEx);
  pse.printStackTrace();
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-09T23:01:45.760

你能匹配任何不以 a 结尾的路径吗`/`

```
String inRegEx = "^.* \"GET (.*[^/]) HTTP/.*$"; 
```

* * *

这也可以使用*负面的lookbehind来完成*

```
String inRegEx = "^.* \"GET (.+)(?<!/) HTTP/.*$"; 
```

这里，`(?<!/)`说“*前面*的序列*不能*匹配`/`”。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:42:40.887

也许我在这里遗漏了一些东西，但是你不能不使用任何正则表达式而忽略任何正确的东西：

```
string.contains("/ HTTP") 
```

因为文件路径永远不会以斜杠结尾。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:06:23.017

我会使用这样的东西：

```
"\"GET /FOO/BAR/[^ ]+ HTTP/1\.[01]\"" 
```

这匹配不只是`/FOO/BAR/`.

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-02-09T23:17:46.250

如果您正在编写如此复杂的正则表达式，我建议您在 StackOverflow 之外构建一个资源库。

*   [Mehran Habibi (Apress) 编写的 Java 正则表达式](http://www.apress.com/book/view/9781590591079) 

*   [掌握正则表达式，第二版](http://oreilly.com/catalog/9780596002893/) 

*   [正则表达式库](http://regexlib.com/default.aspx)

# jakarta-ee - 现实世界中的玻璃鱼

> ID：530442
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-02-09T22:55:20.470
> 
>         
> 
> 标签：jakarta-ee, tomcat, glassfish, production

是否有任何公司/网站在生产中使用 Glassfish？我是 J2EE 新手，在 Glassfish v3 Prelude 中将 JRuby on Rails 与 JAX-WS Metro 应用程序一起部署。有时怪癖让我去 WTF 并扯掉我的头发。

我没有使用 Apache Tomcat 的经验，想知道切换到 Tomcat 是否有意义，因为 Glassfish 可能还没有准备好进行认真的开发？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-02-11T01:22:29.633

对于现实世界中的 GlassFish，请查看[http://blogs.oracle.com/stories](http://blogs.oracle.com/stories)。

以下是 JRuby on GlassFish 生产故事的几个快速点击：

*   [http://weblogs.java.net/blog/arungupta/archive/2008/04/jruby_and_glass.html](http://weblogs.java.net/blog/arungupta/archive/2008/04/jruby_and_glass.html)

*   [http://blog.linkedin.com/2008/08/19/jdbc-connection-pooling-for-rails-on-glassfish/](http://blog.linkedin.com/2008/08/19/jdbc-connection-pooling-for-rails-on-glassfish/)

其他有用的资源：

*   [http://wiki.glassfish.java.net/Wiki.jsp?page=JRuby](http://wiki.glassfish.java.net/Wiki.jsp?page=JRuby)

*   [http://weblogs.java.net/blog/arungupta/（GlassFish](http://weblogs.java.net/blog/arungupta/)
    帖子上有很多 JRuby）

希望这可以帮助

GlassFish 集团产品经理 John Clingan

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-07-16T13:44:28.353

我在生产和“生产测试”中有大约 50 个 Glassfish 实例。我唯一的建议是“不要在 Windows 上运行它”。有关主要原因，请参阅[Windows 上的 GlassFish 与 RedHat 。](https://stackoverflow.com/questions/951723/glassfish-on-windows-vs-redhat)

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-03-06T15:59:14.627

当我们需要 JMS 来处理异步消息时，我所在的公司从 Tomcat 切换到了 Glassfish。我们选择使用 Glassfish，而不是在 Tomcat 中使用外部 JMS 解决方案。[Glassfish 使用的OpenMQ](http://mq.dev.java.net)实际上是一个很好的 JMS 解决方案，它提供了许多关于集群和高可用性的特性。我认为 Sun 与 MySQL、OpenMQ 和 Glassfish 的堆栈是一个有趣的软件堆栈。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:19:04.937

Glassfish 是 Java EE 应用程序服务器，而 Tomcat 不是，如此[处所述](http://www.javaworld.com/javaworld/jw-01-2008/jw-01-tomcat6.html)

但是，如果您将 Spring 与 Tomcat 一起使用，那么您将拥有两全其美的优势。

[在这里](http://www.jroller.com/cardsharp/entry/tomcat_vs_app_server)查看更多讨论。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-08-20T02:02:29.087

请参见第 #45 页“谁在生产中使用 GlassFish？” 这里：[https ://slx.sun.com/1179275180](https://slx.sun.com/1179275180)

和

[http://kenai.com/](http://kenai.com/)在 GlassFish Web Stack 或 GlassFish LAMP 下运行。

# mod-rewrite - 重写 CNAME 子域

> ID：530447
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-09T22:56:17.550
> 
>         
> 
> 标签：mod-rewrite, apache2

我有一个子域，我想使用 mod_rewrite 重定向到不同的位置。例如：

subdomain.example.com -> www.example.com/subdomain

我不想向浏览器发送重定向（所以它不知道页面不同）。

BTW subdomain.example.com 有一条指向 example.com 的 CNAME 记录。

**编辑**

另一个例子，只是为了澄清。很简单：如果在浏览器中输入http: [//x.abc.com，Apache会返回](http://x.abc.com)[http://www.abc.com/x](http://www.abc.com/x)的内容。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-09T22:59:44.733

如果两个域共享同一个目录，您可以这样做来重写内部请求：

```
RewriteCond %{HTTP_HOST} ^([^.]+)\.example\.com$
RewriteRule !^subdomain/ subdomain%{REQUEST_URI} 
```

* * *

在问题得到澄清后：这个对我有用：

```
RewriteCond %{HTTP_HOST} ^([^.]+)\.example\.com$
RewriteCond %1.%{THE_REQUEST} ^([^.]+)\.[A-Z]+\ (/[^\ ]*)
RewriteCond %{DOCUMENT_ROOT}$1 !-d
RewriteRule ^([^/]+)? %1%2 
```

但你最好[听从布兰登](https://stackoverflow.com/questions/530447/rewriting-cname-subdomain/530718#530718)所说的。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T00:54:28.080

除了上面提到的 Gumbo 之外，您还可以使用 Apache 的 VirtualDocumentRoot 语句将 URL 动态映射到磁盘上的动态位置。它允许您使用部分 URL 在磁盘上构建路径。查看此链接以获取更多信息：

[http://httpd.apache.org/docs/2.2/mod/mod_vhost_alias.html](http://httpd.apache.org/docs/2.2/mod/mod_vhost_alias.html)

例子：

`URL = [http://sub.example.com/dir/page.html](http://sub.example.com/dir/page.html)

Server Path = /var/www/site.com/htdocs/sub/dir/page.html

VirtualDocumentRoot = /var/www/%-2.0.%-1.0/htdocs/%-3/`

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T00:57:37.323

```
RewriteCond %{HTTP_HOST} ^([^.]+)\.abc\.com$
RewriteRule ^(.*)$       http://www.abc.com/%1$1   [R=301] 
```

# c# - 为什么 WPF BitmapImage 对象不从 ASP.Net Web 窗体中的 Uri 源下载图像？

> ID：530450
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-09T22:57:24.960
> 
>         
> 
> 标签：c#, asp.net, wpf

我正在尝试在 ASP.Net 中完成以下任务：

1.  创建 WPF 画布控件

2.  启动 WPF Image 控件和 BitmapImage 对象

3.  将 BitmapImage 源设置为图像的 Uri

4.  将图像添加到画布

5.  下载图像后，将画布渲染为新的位图

我的代码在 WPF 本身中可以正常工作，但是在 ASP.Net 页面中运行时，不会下载图像。

它适用于其他 WPF UI 元素。对于 Image，使用 BitmapImage.StreamSource 属性设置源可以正常工作。当我使用 BitmapImage.UriSource 属性时，不会引发 BitmapImage.DownloadCompleted 事件，这暗示图像从一开始就不会开始下载。

重要的是要注意，只要我使用流源而不是 uri 源，它对于大多数控件（椭圆、矩形、墨迹演示者和图像控件）都可以正常工作。

那么，我在这里缺少什么？为什么 BitmapImage 类在 Web 应用程序中的行为不同？

我知道我会被问到，所以这样做的目的是我编写了一个 Silverlight 客户端来创建存储在 Web 服务器上的图形内容。我希望 Web 服务器将内容呈现为位图文件。

提前感谢您的任何建议..

这是我的 ASP.Net 页面代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Windows.Controls;
using System.Windows.Media.Imaging;
using System.Threading;
using System.Windows;
using System.Net;
using System.IO;
using System.Windows.Media;

public partial class _Default : System.Web.UI.Page 
{
    private static Canvas c;
    protected void Page_Load(object sender, EventArgs e)
    {
        Thread t = new Thread(new ThreadStart(
            delegate { DownloadAndSave(); }));
        t.SetApartmentState(ApartmentState.STA);
        t.Start();
        t.Join();
    }

    [STAThread]
    void DownloadAndSave()
    {
        c = new Canvas();
        BitmapImage bitmap = new BitmapImage();
        System.Windows.Controls.Image image = new System.Windows.Controls.Image();

        bitmap.DownloadCompleted += new EventHandler(bitmap_DownloadCompleted);
        bitmap.BeginInit();
        bitmap.UriSource = new Uri("http://andrew.myhre.tanash.net/customassets/andrewmyhre/image/face.jpg");
        bitmap.EndInit();

        image.Source = bitmap;

        c.Children.Add(image);

        c.UpdateLayout();
        c.Measure(new Size(400, 300));
        c.Arrange(new Rect(new Size(400, 300)));
    }

    void bitmap_DownloadCompleted(object sender, EventArgs e)
    {
        // this never fires!!
        SaveImage(c);
    }

    void SaveImage(UIElement element)
    {
        RenderTargetBitmap bmp = new RenderTargetBitmap(400, 300, 96, 96, PixelFormats.Pbgra32);
        bmp.Render(element);
        BitmapEncoder encoder = new JpegBitmapEncoder();
        encoder.Frames.Add(BitmapFrame.Create(bmp));
        using (Stream stm = File.Create(Server.MapPath("~/file.jpg")))
            encoder.Save(stm);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-08T12:58:25.383

我认为永远不会引发 DownloadCompleted 事件，因为当您使用允许后台线程（DownloadAndSave 方法）在加载图像之前完成的 UriSource 属性时，BitmapImage 会异步加载。

最近在几乎相同的情况下对我有用的是同步下载位图资源并使用 BitmapImage.StreamSource 属性进行设置。请注意，在使用该技术时，您必须在渲染 RenderTargetBitmap 之后才能关闭/处置流。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T11:18:11.927

您是否验证了将 STAThread 属性添加到 DownloadAndSave 方法实际上使其在 STA 线程中运行？

根据 STAThreadAttribute ( [http://msdn.microsoft.com/en-us/library/system.stathreadattribute.aspx](http://msdn.microsoft.com/en-us/library/system.stathreadattribute.aspx) ) 的文档，它对主要输入方法的其他方法没有任何影响，例如 WinForms 中的 Main应用。

我想您应该朝那个方向看-我在需要 STA 的 WPF 图像功能方面遇到了类似的问题。

# ruby - 为什么在 Ruby 1.8.7 中编译 IronRuby 时出现错误？

> ID：530452
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-09T22:58:00.417
> 
>         
> 
> 标签：ruby, installation, ironruby

我似乎无法在 ruby​​ 1.8.7 中编译 ironruby。我总是收到这个错误：

*没有要加载的文件——windows/path*

这是否意味着 Ironruby 与 ruby​​ 1.8.7 不兼容？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-11T13:14:19.030

看起来在 pathname2 东西成功之前需要 gem windows-pr 。我`gem install windows-pr`在我的 Ruby 1.8.7 安装中进行了一次安装，然后成功地`rake --tasks`在 IronRuby 中运行（它之前因相同的“没有要加载的文件”错误而失败）。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T02:05:47.097

IronRuby 本身不需要安装任何 ruby​​ 解释器。所以询问它是否与 MRI 1.8.7 兼容有点用词不当。这听起来像是 1.8.7 不包含 Rakefile 使用的库。  

顺便说一句，IronRuby 确实针对 1.8.6 兼容性。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-03-06T20:15:19.317

我会说你需要在你的 ruby​​ 1.8.7 安装中安装 gem pathname2。

# emacs - Emacs Lisp 函数可在 4 和 8 之间切换变量 'tab-width'

> ID：530461
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-09T23:00:13.330
> 
>         
> 
> 标签：emacs

我处理的源代码树的文件缩进了不同的制表符值（更不用说空格），我能做的最好的事情就是将 emacs 设置为使用在我正在修改的代码区域中找到的样式。而不是将 Mx set-variable tab-width 设置为 4 或 8，在这两个值之间切换 tab-width 的键绑定将有很大帮助。

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-02-09T23:39:22.690

```
;; Obviously substitute your preferred key for <f8>
(global-set-key (kbd "<f8>") 'tf-toggle-tab-width-setting) ; ' "fix" highlighting

(defun tf-toggle-tab-width-setting ()
    "Toggle setting tab widths between 4 and 8"
    (interactive)
    (setq tab-width (if (= tab-width 8) 4 8))
    (redraw-display)) 
```

*编辑以根据建议的评论添加重绘显示*

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-02-10T04:15:20.857

没有完全回答这个问题（给出的答案已经足够好了），但您可能需要考虑设置每个文件的局部变量。例如，假设“//”表示您的语言中的注释，您可以将以下内容放在文件的*第一*行：

```
// -*- tab-width: 4 -*- 
```

每当您访问该文件时，emacs 都会为您设置变量。有关基于文件的变量的更多信息，请参见[http://www.gnu.org/software/emacs/manual/html_node/emacs/Specifying-File-Variables.html](http://www.gnu.org/software/emacs/manual/html_node/emacs/Specifying-File-Variables.html)。

当然，如果文件在一个组之间共享，这可能不是一个选择——除非你能说服你的大学，这个第一行评论是完全无害的并且*非常*有用！

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T17:07:17.780

感谢所有的答案。我添加了一个 redraw-display 调用，以便立即反映更改。（尝试将此作为评论发布，但不能。）

```
(global-set-key (kbd "<f8>") 'tf-toggle-tab-width-setting)
(defun tf-toggle-tab-width-setting ()    "toggle setting tab widths between 4 and 8"
    (interactive)
    (setq tab-width (if (= tab-width 8) 4 8))
    (message "set tab-width to %d." tab-width)
    (redraw-display)
) 
```

并且沿着同样的路线。:(

```
(global-set-key (kbd "<f7>") 'tf-toggle-indent-mode-setting)
(defun tf-toggle-indent-mode-setting ()
    "toggle indenting modes"
    (interactive)
    (setq indent-tabs-mode (if (eq indent-tabs-mode t) nil t))
    (message "Indenting using %s." (if (eq indent-tabs-mode t) "tabs" "spaces"))
) 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:37:49.667

将其放入您的`.emacs`or`.emacs.d/init.el`文件中：

```
(defun toggle-spaces ()
  "Toggle tab-width between 4 and 8"
  (interactive)
  (if (eq tab-width 4)
      (setq tab-width 8)
    (setq tab-width 4)))

;; This will set Ctrl-g to toggle but you can set it to anything
;; you want.
(global-set-key "\C-g" 'toggle-spaces) 
```

# c++ - 在 C++ 中，std::multiset 是否保持稳定的排序顺序？

> ID：530462
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-09T23:00:24.327
> 
>         
> 
> 标签：c++, stl

假设我有两个比较相同的项目 a 和 b。所以 a < b 是假的， b < a 是假的。如果这些项目作为键插入到 std::multiset （或 std::multimap ）中，我对它们的最终排序顺序有任何保证吗？

我检查了一些参考资料，但找不到答案。我很想认为没有任何保证，它取决于每个特定的实现。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-02-09T23:19:35.203

[该线程](https://web.archive.org/web/20130509163609/http://objectmix.com/c/26102-stl-multimap-insert-duplicate-keys-ordering-stable.html)暗示当前标准不保证它，但所有已知的当前实现都满足它，并提供了指向包含保证的 C++0x 草案标准的链接。

# django - 如何让 django 使用它的模板系统显示空单元格？

> ID：530466
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-09T23:01:27.210
> 
>         
> 
> 标签：django, django-templates

我正在使用 Django 中的模板系统写出一个表格，它没有显示空表格单元格周围的边框。

我想没问题 - 我以前解决过这个问题。我将   放在任何要留空的单元格中。Django 好心地将 & 符号转换为 &，以便我在空单元格中有 &nbsp，并在浏览器中查看时显示  。

我用谷歌搜索了它，并尝试将 {%autoescape off%} 和 {%endautoescape%} 放在有问题的桌子周围，但它也没有任何好处。

我还尝试将 autoescape=False 添加到上下文构造函数中，但这也无济于事。

让 Django 在空单元格周围显示边框的魔术是什么？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-09T23:17:51.260

这是一个已知的 CSS/HTML“问题”。您想使用 Django 的“[默认](http://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#default)”过滤器。

```
{{value|default:"&amp;nbsp;"}} 
```

（如果我能把它弄好，我会被诅咒的。在SO中，你怎么写“nbsp;”没有前面的&导致所有东西都消失并被空白代替？）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:08:33.217

有空单元格 CSS 属性。

[http://www.w3.org/TR/CSS21/tables.html#empty-cells](http://www.w3.org/TR/CSS21/tables.html#empty-cells)

我不记得它是否适用于所有浏览器

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:32:56.277

Django 不会控制表格的外观。修补自动逃生也是多余的，并且可能会变得危险。

您是否使用 CSS 来设置表格样式？通过使用类似的属性

```
td {
  border: 1px solid red;
} 
```

你可以让每个单元格都有一个红色边框。不管它是不是空的。

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2009-02-10T06:34:08.013

你真正需要做的是在那些空单元格中获得一个不间断的空间，并防止 Django 转义 HTML 实体。您可以将几个过滤器链接在一起以实现您正在寻找的东西吗？

```
{{ value|default:"&#160;"|safe }} 
```

**编辑**：我应该提一下，`&#160;`这与`&nbsp;`, 只是不会被 SO 解析器破坏。

# python - 使用 fastcgi 部署 bluechannel

> ID：530480
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-09T23:07:03.483
> 
>         
> 
> 标签：python, django

我正在尝试通过 fcgi 运行一个基本的蓝色通道网站，我有一个 django.fcgi 文件。我该怎么做呢。谢谢

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:34:29.923

[阅读神话般的手册](http://docs.djangoproject.com/en/dev/howto/deployment/fastcgi/#apache-setup)

# c# - 使用具有 Linq 匿名类型的 ComboBox 的 SelectedItem 属性

> ID：530482
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-09T23:07:38.583
> 
>         
> 
> 标签：c#, linq, combobox, datasource, anonymous-types

在 C# 3.5 中使用 ComboBox 来显示 LinQ 查询的结果。当 LinQ 查询返回匿名类型时，如何设置 ComboBox 的 SelectedItem 属性？

我按照以下几行设置 ComboBox 的 DataSource：

```
comboBox1.DataSource = from p in db.products
                       select p;
comboBox1.DisplayMember = "Name";
comboBox1.ValueMember = "ProductId"; 
```

如果我这样做，我可以通过执行以下操作来选择所选项目：

```
comboBox1.SelectedItem = (from p in db.products 
                          where p.ProductId = 5 
                          select p).First(); 
```

问题是我想用匿名类型结果填充 ComboBox，例如：

```
comboBox1.DataSource = from p in db.products
                       select new
                       {
                           p.ProductId,
                           p.Name
                       }; 
```

我实际使用的匿名类型比那更复杂，但足以解释。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T23:21:46.133

如何将其转换为列表，然后从中选择正确的列表。由于 SelectedItem 似乎不起作用，您可能想尝试设置 SelectedValue。

```
var productList = (from p in db.products
                   select new {
                      ProductId = p.ProductID,
                      Name = p.Name
                   }).ToList();

comboBox1.DataSource = productList;
comboBox1.DisplayMember = "Name";
comboBox1.ValueMember = "ProductId";
comboBox1.SelectedValue = 5; 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:11:27.263

这应该可以解决问题

```
var list = (from p in db.products
              select new {
                             p.ProductId,
                             p.Name
                           }).ToList();
comboBox1.DataSource = list;
comboBox1.SelectedItem = list[0]; 
```

# .net - 我如何创建一个 Gridview 来对 web 服务进行 Ajax 调用

> ID：530486
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-09T23:08:52.967
> 
>         
> 
> 标签：.net, asp.net, ajax

我有一个 Gridview 。我想通过 ASP.net 中的 Ajax 调用显示来自 Webservice 的数据，请告诉我解决方案。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-12T09:25:36.793

我不太确定我是否理解正确，但没有办法将网格视图与 AJAX 调用绑定（还）。这仅仅是因为您正在处理客户端，而 Grid View 只是一个 HTML 表。您将不得不编写您的自定义方法来处理您的 AJAX 响应并动态构建一个表......我以前做过这个，它工作得很好......

如果你真的想走这条路，我建议你看看这个启用表格排序和分页的 jQuery[插件](http://tablesorter.com/docs/)......这很酷......

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-12T09:57:02.897

您不能只创建一个方法来调用 Web 服务并返回您的数据对象/数据集，然后将其绑定到您的网格并将网格包装在更新面板中，在方法端调用 myUDP.Update() 以刷新网格与新绑定的数据。

# javascript - 将 WordPress 编辑器移植到非 WP 应用程序时出现问题

> ID：530493
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-09T23:11:51.320
> 
>         
> 
> 标签：javascript, wordpress, tinymce

我喜欢 WordPress 编辑器（2.7 版）的外观和感觉，我想在另一个用 ASP.NET 编写的 Web 应用程序中使用它。我以前用过 TinyMCE，过去我什至对它进行了扩展。但是，我似乎无法让 Wordpress 配置正常工作！

我已经下载了整个 WordPress 包并获取了 TinyMCE 代码（来自“js”文件夹）并将其放在我的网站中。它最终在 tiny_mce.js 的下一行给我一个错误

```
return f.apply(s||this,Array.prototype.slice.call(arguments,2)) 
```

**'undefined' 为 null 或不是对象。**

现在，我已经仔细确保执行步骤与我所基于的 WordPress 演示站点相同。

我不是 Javascript 新手（根本），但我似乎无法弄清楚为什么这不起作用。有没有人尝试过这样做？我错过了什么？

我正在谈论的演示在[这里](http://demo.opensourcecms.com/wordpress/wp-admin/post-new.php)（用户名=“管理员”，密码=“演示”）。查看源代码，我拥有（似乎）为编辑器供电所需的 Javascript 的三个部分。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T00:46:29.360

Something of a stab in the dark, but I'm suspecting that there's a dependency on WP's prototype.js and you didn't bring that over with TinyMCE.

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-12-01T13:48:15.150

我建议包含 tiny_mce_src.js 而不是缩小版本，这样您就可以使用 firebug 进行调试并接收有用的信息。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:27:19.773

如果您能够确定哪个位未定义，这可能会给您一个线索。我试着用 firebug 看演示，但是 tinymce.js 就是一行，所以我放弃了寻找那个代码。如果您有 firebug，请尝试放入一些 console.log()，或者在该行之前放入 alert()s，并尝试查看当您收到错误时 f、s、this、arguments 等是什么，然后用同样的方法安装香草 WP 并看到区别？

# hosting - 网络服务器位置 - 对 SEO 有多重要？

> ID：530500
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-09T23:15:24.150
> 
>         
> 
> 标签：hosting, web-hosting, vps, dedicated-hosting

我在英国，有两台网络服务器，一台位于德国 (1&1)，另一台位于英国 (Easyspace)。

我最近注册了英国的 easyspace 服务器，因为它与我为我的 1&1 服务器支付的价格差不多，但我也想看看我在英国服务器上托管的网站是否在英国的流量方面提供了更好的结果。

看来我的两台服务器的流量大致相同......但是 1&1 服务器性能和客户服务比 Easyspace 好得多，所以我正在考虑取消它并获得另一台 1&1 服务器。

我了解美国/亚洲对于英国流量会慢得多的延迟问题，但我只是想知道您的想法是流量、搜索引擎优化等，以及您是否认为我应该坚持使用英国服务器或者这无关紧要？  

期待您的回复。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T23:20:05.700

我从未听说过常见的搜索引擎按响应时间对网站进行排名，因为由于互联网的性质，它是高度可变的。如果搜索引擎会因您所在的子网而惩罚您，那么您可能会遇到更大的问题。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:43:42.443

我的网站在 google.com.au 上获得的结果比在其他风格的 google 上更好，即使这些网站不在澳大利亚托管。所以我建议服务器的实际物理位置不会那么重要，如果你想在 google.co.uk 上更高，你可能想要一个 co.uk 域？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:02:04.267

Google 主要通过其后缀（TLD/SLD，例如 .co.uk）将一个地区与您的网站相关联，但如果您创建了一个 Google 网站管理员工具帐户，您可以告诉它，否则在奇怪的情况下它会出错。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T03:12:53.753

就流量而言，该网站将为英国访问者快速加载。如果您的大多数访问者来自英国，我建议使用此服务器。服务器位置与 SEO 无关。

如果您认为它更好，请坚持使用您的英国服务器。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T09:08:03.167

如果服务器位于英国以外，我主要担心的是失去英国客户，但从评论中可以看出情况可能并非如此。

但是，我的英国服务器位于苏格兰，我的另一台服务器位于德国，实际上比苏格兰更靠近伦敦？

只是为了比较苏格兰服务器和德国服务器之间的速度：

=== 德国 ===

```
Pinging firststopdigital.com [87.106.101.189]:

Ping #1: Got reply from 87.106.101.189 in 126ms [TTL=46]
Ping #2: Got reply from 87.106.101.189 in 126ms [TTL=46]
Ping #3: Got reply from 87.106.101.189 in 126ms [TTL=46]
Ping #4: Got reply from 87.106.101.189 in 126ms [TTL=46]

Variation:                 0.4ms (+/- 0%)

Shortest Time:             126ms
Average:                   126ms
Longest Time:              126ms 
```

=== 英国 ===

```
Pinging pb-net.co.uk [62.233.81.163]:

Ping #1: Got reply from 62.233.81.163 in 120ms [TTL=55]
Ping #2: Got reply from 62.233.81.163 in 119ms [TTL=55]
Ping #3: Got reply from 62.233.81.163 in 119ms [TTL=55]
Ping #4: Got reply from 62.233.81.163 in 119ms [TTL=55]

Variation:                 0.3ms (+/- 0%)

Shortest Time:             119ms
Average:                   119ms
Longest Time:              120ms 
```

差异在 6ms 左右，一点也不大。

顺便说一句，我刚刚对我拥有的美国域执行了 ping 操作：

```
Pinging pbnetltd.com [74.86.61.36]:

Ping #1: Got reply from 74.86.61.36 in 6.4ms [TTL=121]
Ping #2: Got reply from 74.86.61.36 in 6.3ms [TTL=121]
Ping #3: Got reply from 74.86.61.36 in 6.2ms [TTL=121]
Ping #4: Got reply from 74.86.61.36 in 6.3ms [TTL=121]

Variation:                 0.2ms (+/- 3%)

Shortest Time:             6.2ms
Average:                   6.3ms
Longest Time:              6.4ms 
```

考虑到横跨大西洋到纽约和返回的额外距离（英国时间上午 9 点，所以美国睡着了 - 今晚会再试一次），美国的时间安排要快得多。

# c - C 中的“CALLBACK”声明有什么作用？

> ID：530504
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-02-09T23:17:30.933
> 
>         
> 
> 标签：c, windows, syntax, callback

我正在查看[SDL](http://www.libsdl.org)库中的一些代码，并遇到了一个声明如下的函数：

```
LRESULT CALLBACK WndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam) 
```

现在，我是一名 Delphi 编码员。没有 hablo C muy bien，先生。但我记得我大学课程的语法足够多，可以这样阅读：

函数名称是 WndProc。参数列表是不言自明的。函数返回类型是 LRESULT。但是那个“CALLBACK”到底在做什么呢？在 Delphi 中，任何函数都可以用作回调；您只需要传递正确类型的函数指针。有什么特别的原因导致 C 不能这样工作吗？或者它是否意味着不同的东西？

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-02-09T23:18:20.913

“CALLBACK”是一个调用约定。还有其他类型的调用约定。CALLBACK 与 __stdcall 相同。

[http://www.codeguru.com/cpp/cpp/cpp_mfc/callbacks/article.php/c10557](http://www.codeguru.com/cpp/cpp/cpp_mfc/callbacks/article.php/c10557)

Raymond Chen 博客上的更多信息：

[http://blogs.msdn.com/oldnewthing/archive/2004/01/08/48616.aspx](http://blogs.msdn.com/oldnewthing/archive/2004/01/08/48616.aspx)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-09T23:34:43.683

Raymond Chen 博客的简短综述：

> 在 x86 平台上调用约定的好处是有很多可供选择！

**C 调用约定 (__cdecl)** 

C 调用约定受到限制，因为它允许使用具有可变数量参数的函数。它几乎需要调用者清理堆栈并将参数从右向左推送，以便第一个参数相对于堆栈顶部位于固定位置。总结：调用者清理堆栈，参数从右向左推送。

**Pascal 调用约定 (__pascal** )

Pascal 不支持具有可变数量参数的函数，因此它可以使用 callee-clean 约定。参数从左到右推送。几乎所有 Win16 函数都导出为 Pascal 调用约定。callee-clean 约定在每个调用点保存三个字节，每个函数有两个字节的固定开销。它也快了一点。在 Win16 上，节省几百字节和几个周期是一件大事。注意：Fortran 调用约定 (__fortran) 与 Pascal 调用约定相同

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T23:23:05.723

这是调用约定。当您将此函数的指针传递给稍后调用该函数的 Windows API 时，它是必需的。Windows 调用约定与 C 调用约定不同，因此您需要向编译器指定 WndProc() 是特殊的，并且它需要不同的启动和清理代码。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:23:18.657

这是一个调用约定，Delphi 也有。尝试在 Delphi 帮助中查找“cdecl”。在 Delphi（或者我们老喜欢称之为 Object Pascal）中，调用约定出现在函数声明之后，如下所示；

```
function MyFunction(X, Y: Real): Real; cdecl; 
```

# sql - SQL 查询的特殊排序

> ID：530508
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-09T23:18:18.387
> 
>         
> 
> 标签：sql, mysql, sql-order-by

我需要显示按某个数字列排序的数据库表中的记录列表。该表如下所示：

```
CREATE TABLE  items (
  position int NOT NULL,
  name varchar(100) NOT NULL,
);
INSERT INTO items (position, name) VALUE
(1, 'first'),
(5, 'second'),
(8, 'third'),
(9, 'fourth'),
(15, 'fifth'),
(20, 'sixth'); 
```

现在，列表的顺序应该根据用户提供的参数而改变。此参数指定首先出现的记录，如下所示：

```
position = 0
order should be = 1, 5, 8, 9, 15, 20

position = 1
order should be = 20, 1, 5, 8, 9, 15

position = 2
order should be = 15, 20, 1, 5, 8, 9 
```

换句话说，最后一条记录成为第一条，依此类推。你能想出一种在 SQL 中做到这一点的方法吗？

我正在使用 MySQL，但任何 SQL 数据库中的示例都可以。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T23:32:20.100

您确定要在 SQL 中执行此操作吗？

对我来说，这听起来像是您应该将结果加载到某种数据集中，然后根据需要重新排序，或者将起点定位在正确的位置。

可能使用链表。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T00:38:08.820

看看这对你有什么作用。使用通用 SQL，因此它也应该对 MySql（未经测试）有效。

```
DECLARE @user_sort INTEGER
SET @user_sort = 0

SELECT position, name FROM 
(
  SELECT I1.position, I1.name, COUNT(*) AS rownumber, (SELECT COUNT(*) FROM items) AS maxrows
  FROM items I1, items I2
  WHERE I2.position <= I1.position
  GROUP BY I1.position, I1.name
) Q1
ORDER BY 
  CASE WHEN maxrows - rownumber < (@user_sort % maxrows) THEN 1 ELSE 2 END, position 
```

注意： * 如果用户提供的排序索引大于行数，则该值将回绕到有效范围内。要删除此功能，请从 ORDER BY 中删除“% maxrows”。

***结果：***

**设置@user_sort = 0**

```
position    name
1   first
5   second
8   third
9   fourth
15  fifth
20  sixth 
```

**设置@user_sort = 1**

```
position    name
20  sixth
1   first
5   second
8   third
9   fourth
15  fifth 
```

**设置@user_sort = 2**

```
position    name
15  fifth
20  sixth
1   first
5   second
8   third
9   fourth 
```

**设置@user_sort = 9**

```
9   fourth
15  fifth
20  sixth
1   first
5   second
8   third 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:23:48.827

ORDER BY (FIELD(位置, 1, 5, 8, 9, 15, 20) + 参数) % 7

编辑：为了让花生画廊开心，一般的解决方案是：

ORDER BY (SELECT ix + parameter - 1 FROM (SELECT i.position, @ix := @ix + 1 AS ix FROM (SELECT @ix := 0) AS n, items AS i ORDER BY position) AS s WHERE s。 position = items.position) % (SELECT COUNT(*) FROM items)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T22:32:47.107

我在这里重复海滩的解决方案，但消除了自联接，只从*项目*表中选择两次（并使用 Oracle 语法）：

```
select 
    i.position
  , i.name
from(
  select 
      items.*
    , ( SELECT COUNT(*) FROM items ) AS maxrows
  from items
  order by position
) i
order by 
  case 
    when rownum > maxrows - 2 -- NOTE: change "2" to your "position" variable
      then 1 - 1 / rownum -- pseudo-rownum < 1, still ascending
    else
      rownum
  end
; 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:24:26.720

如果它是一个您知道项目数量的集合列表，您可以执行以下操作：

```
SELECT *
FROM Items
ORDER BY CASE WHEN Position >= Position THEN POSITION ELSE Position+1000 END 
```

但它真的很丑。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T00:07:45.710

这确实不是在 SQL 中做的理想事情。

我有解决方案，但是对于大桌子，它会很慢。

```
DECLARE @iOrder INT
SET @iOrder = 4

SELECT abc.position,abc.name FROM
(
SELECT position,name,ROW_NUMBER() OVER (ORDER BY position) AS rownum
FROM items
) abc
WHERE abc.rownum >= @iOrder
UNION ALL
SELECT def.position, def.name FROM
(
SELECT position,name,ROW_NUMBER() OVER (ORDER BY position) AS rownum
FROM items
) def
WHERE def.rownum < @iOrder 
```

请注意，使用 UNION (Without the all) 将重新排序结果，因为它会寻找重复项

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:40:03.690

根据约翰的评论，但使用 LIMIT 语法（ROW_NUMBER/OVER 在 MySQL 中不起作用，此外 LIMIT 更容易阅读）：

```
(
    SELECT position, name FROM items
    ORDER BY position
    LIMIT @offset, @bignum
) UNION ALL (
    SELECT position, name FROM items
    ORDER BY position
    LIMIT @offset
) 
```

其中@bignum 是一个任意数字，高于您可能拥有的任意数量的结果。

我仍然不完全相信这实际上会比重新排列 Web 服务器上的列表更快......我想这将完全取决于您如何处理结果集以及它有多大。但至少它避免了海滩巧妙方法中涉及的自交叉连接。

# jquery - jQuery - 如何选择包含 th 的 tr？

> ID：530513
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-02-09T23:19:55.810
> 
>         
> 
> 标签：jquery, jquery-selectors

标题几乎说明了一切。

给定一张像

```
<table>
  <tr>
    <th>Header 1</td>
    <th>Header 2</td>
  </tr>
  <tr>
    <td>Datum 1</td>
    <td> Datum 2</td>
  </tr>
  <tr>
    <td>Datum 1</td>
    <td> Datum 2</td>
  </tr>
</table> 
```

如何选择包含第 th 个标题而不包含其他标题的行？

* * *

## 回答 #1

> 赞同：26
> 
>             
> 
> 时间：2009-02-09T23:26:11.520

表达：

```
$(function() {
  $("tr:has(th):not(:has(td))").hide();
}); 
```

甚至只是：

```
$(function() {
  $("tr:not(:has(td))").hide();
}); 
```

完整示例：

```
<html>
<head>
  <title>Layout</title>
</head>
<body>
<table>
  <tr>
    <th>Header 1</td>
    <th>Header 2</td>
  </tr>
  <tr>
    <td>Datum 1</td>
    <td> Datum 2</td>
  </tr>
  <tr>
    <td>Datum 1</td>
    <td> Datum 2</td>
  </tr>
  <tr>
    <th>Header 3</th>
    <th>Datum 2</td>
  </tr>
</table>
<script src="http://www.google.com/jsapi"></script>
<script>
  google.load("jquery", "1.3.1");
  google.setOnLoadCallback(function() {
    $(function() {
      $("tr:has(th):not(:has(td))").hide();
    });
  });
</script>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-02-09T23:49:51.853

如果可能，最好将表头包含在 <thead> 元素中

```
<table>
    <thead>
        <tr>
            <th></th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td></td>
        </tr>
    </tbody>
</table> 
```

这样，选择表头就很简单了：

```
$('thead'); 
```

或者只选择 <tr>

```
$('thead tr'); 
```

这样您的标记将更具可读性，并且表格样式变得更加容易，因为您可以更轻松地定位表格标题或正文中的元素。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-02-09T23:24:14.503

```
jQuery("tr:has(th)") 
```

将选择每一个**至少**`tr`包含一个 **`th`**

 **kthxbye :)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T23:22:18.690

不知道它是否像 Dojo CSS3 查询，但如果 jQuery 支持，您可以使用 first-child 伪类：

tr th：第一个孩子

或者

tr th:nth-child(1)

见：[http ://www.456bereastreet.com/archive/200601/css_3_selectors_explained/](http://www.456bereastreet.com/archive/200601/css_3_selectors_explained/)

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T23:25:15.220

使用`:has`选择器：

```
$('tr:has(th)').addClass('sample') 
```

`th`如果你有一张混合和`td`儿童的桌子，可能不会工作。

# asp.net - 在 Json 中处理空字符串和整数

> ID：530515
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-09T23:20:50.627
> 
>         
> 
> 标签：asp.net, json

JSON 忽略任何具有空值的参数。因此，当我使用 JsonConverter.ExportToString 创建字符串时，这些属性会丢失。此外，任何具有空值的整数都将替换为 -2147483648

当我尝试反序列化此字符串时，这成为一个问题（我正在编写自己的反序列化器而不使用 Json.Import）

处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-11T13:55:08.843

我不确定我是否理解这个问题。JSON 只是 javascript 的一个子集，具有 null 值的属性可以表示如下：

```
{"property1": 1, "property2": null} 
```

在这种情况下，`property1`是一个数字，值为 1，而`property2`值为`null`。我不确定 Json.Import 和 JsonConverter.ExportToString 调用来自哪个库。无论如何，将空值分配给整数是典型的“强类型说话”。在 javascript 中，将 null 分配给数字（在 js 中没有整数之类的东西）只会使该变量不再是数字。

所以也许你应该给我们更多的上下文：使用的库，你使用数据的语言（显然不是 javascript）。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:38:27.573

您能否使用空字符串（即“”）而不是 null，并使用占位符数字（例如 -2147483648）来指示空整数值？

# c++ - std::mktime 和时区信息

> ID：530519
> 
>         
> 
> 赞同：39
> 
>         
> 
> 时间：2009-02-09T23:22:13.010
> 
>         
> 
> 标签：c++

我正在尝试将我作为 UTC 字符串接收的时间信息转换为`std::mktime`在 C++ 中使用的时间戳。我的问题是`<ctime>`/`<time.h>`没有转换为 UTC 的函数；mktime 只会将时间戳作为本地时间返回。

所以我需要找出时区偏移并将其考虑在内，但我找不到不涉及将整个代码移植到`boost::date_time`. 是否有一些我忽略的简单解决方案？

* * *

## 回答 #1

> 赞同：30
> 
>             
> 
> 时间：2011-03-01T16:15:25.747

```
timestamp = mktime(&tm) - _timezone; 
```

或平台无关的方式：

```
 timestamp = mktime(&tm) - timezone; 
```

如果查看第 00117 行[mktime() 的源代码](https://web.archive.org/web/20130509004432/http://www.raspberryginger.com/jbailey/minix/html/mktime_8c-source.html)，时间会转换为本地时间：

```
seconds += _timezone; 
```

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2012-07-04T07:25:17.417

mktime() 使用 tzname 来检测时区。[tzset()](http://www.kernel.org/doc/man-pages/online/pages/man3/tzset.3.html)从 TZ 环境变量初始化 tzname 变量。如果 TZ 变量出现在环境中但其值为空或无法正确解释其值，则使用 UTC。

根据[timegm 手册页的可移植（非线程安全）版本](http://www.kernel.org/doc/man-pages/online/pages/man3/timegm.3.html)

```
 #include <time.h>
   #include <stdlib.h>

   time_t
   my_timegm(struct tm *tm)
   {
       time_t ret;
       char *tz;

       tz = getenv("TZ");
       setenv("TZ", "", 1);
       tzset();
       ret = mktime(tm);
       if (tz)
           setenv("TZ", tz, 1);
       else
           unsetenv("TZ");
       tzset();
       return ret;
   } 
```

Eric S Raymond 在他的文章[Time, Clock, and Calendar Programming In C中发表了一个线程安全版本](http://www.catb.org/esr/time-programming/)

```
time_t my_timegm(register struct tm * t)
/* struct tm to seconds since Unix epoch */
{
    register long year;
    register time_t result;
#define MONTHSPERYEAR   12      /* months per calendar year */
    static const int cumdays[MONTHSPERYEAR] =
        { 0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334 };

    /*@ +matchanyintegral @*/
    year = 1900 + t->tm_year + t->tm_mon / MONTHSPERYEAR;
    result = (year - 1970) * 365 + cumdays[t->tm_mon % MONTHSPERYEAR];
    result += (year - 1968) / 4;
    result -= (year - 1900) / 100;
    result += (year - 1600) / 400;
    if ((year % 4) == 0 && ((year % 100) != 0 || (year % 400) == 0) &&
        (t->tm_mon % MONTHSPERYEAR) < 2)
        result--;
    result += t->tm_mday - 1;
    result *= 24;
    result += t->tm_hour;
    result *= 60;
    result += t->tm_min;
    result *= 60;
    result += t->tm_sec;
    if (t->tm_isdst == 1)
        result -= 3600;
    /*@ -matchanyintegral @*/
    return (result);
} 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2013-04-23T09:47:06.333

昨天我也遇到了同样的问题，通过搜索文档“man mktime”：

mktime() 和 timegm() 函数将分解的时间（在 *timeptr 指向的结构中）转换为与 time(3) 函数返回的值编码相同的时间值（即，距纪元，UTC 的秒数）。mktime() 函数根据当前时区设置解释输入结构（参见 tzset(3)）。timegm() 函数将输入结构解释为表示通用协调时间 (UTC)。

短的：

您应该使用 timegm，而不是使用 mktime。

问候，

排

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-02-09T23:32:57.197

mktime 假定日期值在本地时区。因此，您可以事先更改时区环境变量 (setenv) 并获取 UTC 时区。

[Windows tzset](https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/tzset?view=msvc-160)

也可以试试看各种自制的[utc-mktimes、mktime-utcs等。](http://www.koders.com/c/fidB1A0A680FBCF84DDC534E66371053D726A5546EB.aspx?s=md5)

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2013-11-08T17:41:50.797

如果您尝试在多线程程序中执行此操作并且不想处理锁定和解锁互斥锁（如果您使用环境变量方法，则必须这样做），有一个名为 timegm 的函数可以执行此操作。它不可移植，所以这里是来源：
 [http ://trac.rtmpd.com/browser/trunk/sources/common/src/platform/windows/timegm.cpp](http://trac.rtmpd.com/browser/trunk/sources/common/src/platform/windows/timegm.cpp)

```
int is_leap(unsigned y) {
    y += 1900;
    return (y % 4) == 0 && ((y % 100) != 0 || (y % 400) == 0);
}

time_t timegm (struct tm *tm)
{
    static const unsigned ndays[2][12] = {
        {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31},
        {31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31}
    };
    time_t res = 0;
    int i;

    for (i = 70; i < tm->tm_year; ++i)
        res += is_leap(i) ? 366 : 365;

    for (i = 0; i < tm->tm_mon; ++i)
        res += ndays[is_leap(tm->tm_year)][i];
    res += tm->tm_mday - 1;
    res *= 24;
    res += tm->tm_hour;
    res *= 60;
    res += tm->tm_min;
    res *= 60;
    res += tm->tm_sec;
    return res;
} 
```

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2013-11-15T15:40:07.940

使用[_mkgmtime](https://msdn.microsoft.com/en-us/library/2093ets1.aspx)，它会处理一切。

* * *

## 回答 #7

> 赞同：4
> 
>             
> 
> 时间：2015-07-21T07:45:27.663

这是一个简单的、经过测试的、希望可移植的代码，从`struct tm`可调整的 UTC 年开始转换为秒，无需临时更改时区。

```
// Conversion from UTC date to second, signed 64-bit adjustable epoch version.
// Written by François Grieu, 2015-07-21; public domain.

#include <time.h>                   // needed for struct tm
#include <stdint.h>                 // needed for int_least64_t
#define MY_EPOCH    1970            // epoch year, changeable
typedef int_least64_t my_time_t;    // type for seconds since MY_EPOCH

// my_mktime  converts from  struct tm  UTC to non-leap seconds since 
// 00:00:00 on the first UTC day of year MY_EPOCH (adjustable).
// It works since 1582 (start of Gregorian calendar), assuming an
// apocryphal extension of Coordinated Universal Time, until some
// event (like celestial impact) deeply messes with Earth.
// It strive to be strictly C99-conformant.
//
// input:   Pointer to a  struct tm  with field tm_year, tm_mon, tm_mday,
//          tm_hour, tm_min, tm_sec set per  mktime  convention; thus
//          - tm_year is year minus 1900;
//          - tm_mon is [0..11] for January to December, but [-2..14] 
//            works for November of previous year to February of next year;
//          - tm_mday, tm_hour, tm_min, tm_sec similarly can be offset to
//            the full range [-32767 to 32767].
// output:  Number of non-leap seconds since beginning of the first UTC
//          day of year MY_EPOCH, as a signed at-least-64-bit integer.
//          The input is not changed (in particular, fields tm_wday,
//          tm_yday, and tm_isdst are unchanged and ignored).
my_time_t my_mktime(const struct tm * ptm) {
    int m, y = ptm->tm_year+2000;
    if ((m = ptm->tm_mon)<2) { m += 12; --y; }
// compute number of days within constant, assuming appropriate origin
#define MY_MKTIME(Y,M,D) ((my_time_t)Y*365+Y/4-Y/100*3/4+(M+2)*153/5+D)
    return ((( MY_MKTIME( y           ,  m, ptm->tm_mday)
              -MY_MKTIME((MY_EPOCH+99), 12, 1           )
             )*24+ptm->tm_hour)*60+ptm->tm_min)*60+ptm->tm_sec;
#undef MY_MKTIME // this macro is private
    } 
```

[与这个](https://stackoverflow.com/a/19865296/903600)和[那个](https://stackoverflow.com/a/11324281/903600)答案中的代码相比，主要观察结果可以大大简化：

*   从 3 月开始计算月份，除前一个月份外的所有月份以 5 个月为周期重复，总共 153 天，交替 31 天和 30 天，因此，对于*任何*月份，不考虑闰年，自上一个月份以来的天数可以使用适当的常数相加、乘以 153 和整数除以 5 来计算二月（在常数内）；

*   可以通过加法计算（在常数范围内）计算 100 倍数年份闰年规则的天数校正（除 4 倍数规则外，该规则是非闰年，除非是 400 的倍数）一个适当的常数，整数除以 100，乘以 3，整数除以 4；

*   我们可以使用我们在主计算中使用的相同公式计算任何时期的校正，并且可以使用宏来执行此操作，以便在编译时计算该校正。

* * *

这是另一个不需要 64 位支持的版本，锁定到 1970 年的起源。

```
// Conversion from UTC date to second, unsigned 32-bit Unix epoch version.
// Written by François Grieu, 2015-07-21; public domain.

#include <time.h>                   // needed for struct tm
#include <limits.h>                 // needed for UINT_MAX
#if UINT_MAX>=0xFFFFFFFF            // unsigned is at least 32-bit
typedef unsigned      my_time_t;    // type for seconds since 1970
#else
typedef unsigned long my_time_t;    // type for seconds since 1970
#endif

// my_mktime  converts from  struct tm  UTC to non-leap seconds since 
// 00:00:00 on the first UTC day of year 1970 (fixed).
// It works from 1970 to 2105 inclusive. It strives to be compatible
// with C compilers supporting // comments and claiming C89 conformance.
//
// input:   Pointer to a  struct tm  with field tm_year, tm_mon, tm_mday,
//          tm_hour, tm_min, tm_sec set per  mktime  convention; thus
//          - tm_year is year minus 1900
//          - tm_mon is [0..11] for January to December, but [-2..14] 
//            works for November of previous year to February of next year
//          - tm_mday, tm_hour, tm_min, tm_sec similarly can be offset to
//            the full range [-32767 to 32768], as long as the combination
//            with tm_year gives a result within years [1970..2105], and
//            tm_year>0.
// output:  Number of non-leap seconds since beginning of the first UTC
//          day of year 1970, as an unsigned at-least-32-bit integer.
//          The input is not changed (in particular, fields tm_wday,
//          tm_yday, and tm_isdst are unchanged and ignored).
my_time_t my_mktime(const struct tm * ptm) {
    int m, y = ptm->tm_year;
    if ((m = ptm->tm_mon)<2) { m += 12; --y; }
    return ((( (my_time_t)(y-69)*365u+y/4-y/100*3/4+(m+2)*153/5-446+
        ptm->tm_mday)*24u+ptm->tm_hour)*60u+ptm->tm_min)*60u+ptm->tm_sec;
    } 
```

* * *

## 回答 #8

> 赞同：4
> 
>             
> 
> 时间：2020-03-31T15:25:56.213

一个很少编码和可移植的解决方案，因为它只使用 mktime：

解析的时间必须在 struct tm tm 中。如果您使用 c++11，您可能希望使用[std::get_time](https://en.cppreference.com/w/cpp/io/manip/get_time)进行解析。它解析大多数时间字符串！

在调用 mktime() 之前，请确保**tm.tm_isdst 设置为零**，然后 mktime 不会针对夏令时进行调整，

```
// find the time_t of epoch, it is 0 on UTC, but timezone elsewhere
// If you newer change timezone while program is running, you only need to do this once
// if your compiler(VS2013) rejects line below, zero out tm yourself (use memset or "=0" on all members)
struct std::tm epoch = {};
epoch.tm_mday = 2; // to workaround new handling in VC, add a day
epoch.tm_year = 70;
time_t offset = mktime(&epoch) - 60*60*24; // and subtract it again

// Now we are ready to convert tm to time_t in UTC.
// as mktime adds timezone, subtracting offset(=timezone) gives us the right result
result = mktime(&tm)-offset 
```

根据@Tom 的评论进行编辑

* * *

## 回答 #9

> 赞同：2
> 
>             
> 
> 时间：2020-09-06T15:22:16.197

正如其他答案所指出的那样，`mktime()`（令人发指）假设`tm`结构位于本地时区（即使在`tm`有`tm_gmtoff`字段的平台上），并且没有*标准*的跨平台方式来解释您`tm`的 GMT。

不过，以下是合理的跨平台——它适用于 macOS、Windows（至少在 MSVC 下）、Linux、iOS 和 Android。

```
tm some_time{};
... // Fill my_time

const time_t utc_timestamp =
    #if defined(_WIN32)
        _mkgmtime(&some_time)
    #else // Assume POSIX
        timegm(&some_time)
    #endif
; 
```

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:44:15.767

mktime 使用的 tm 结构有一个 timezone 字段。

如果将“UTC”放入时区字段会发生什么？  

[http://www.delorie.com/gnu/docs/glibc/libc_435.html](http://www.delorie.com/gnu/docs/glibc/libc_435.html)

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2018-12-30T21:41:18.817

我一直在试图弄清楚如何做到这一点。我不相信这个解决方案是完美的（它取决于运行时库计算夏令时的准确程度），但它对我的问题非常有效。

最初我以为我可以计算和之间的差异`gmtime`，`localtime`并将其添加到我转换的时间戳中，但这不起作用，因为差异会根据代码运行的一年中的时间而变化，如果你的源时间是在今年的另一半里，你会在一个小时之前出去。

因此，诀窍是让运行时库计算您尝试转换的时间的 UTC 和本地时间之间的差异。

所以我正在做的是计算我的输入时间，然后通过将其重新插入并添加这两个函数的差异来修改计算的`localtime`时间`gmtime`：

```
std::tm     tm;

// Fill out tm with your input time.

std::time_t basetime = std::mktime( &tm );
std::time_t diff;

tm = *std::localtime( &basetime );
tm.tm_isdst = -1;
diff = std::mktime( &tm );

tm = *std::gmtime( &basetime );
tm.tm_isdst = -1;
diff -= std::mktime( &tm );

std::time_t finaltime = basetime + diff; 
```

这是一种迂回的计算方法，但如果不求助于帮助库或编写自己的转换函数，我找不到任何其他方法。

* * *

## 回答 #12

> 赞同：1
> 
>             
> 
> 时间：2020-01-18T02:33:35.403

将 UTC 时间从字符串转换为时间戳的简单平台无关方法是使用您自己的`timegm`.

使用`mktime`和操作时区环境变量取决于正确安装和配置的 TZ 数据库。在一种情况下，某些时区链接配置不正确（可能是尝试不同时间服务器包的副作用），这导致基于 mktime 的算法在该计算机上失败，具体取决于所选时区**和**时间。

尝试在`mktime`不更改时区的情况下解决此问题是死路一条，因为在您的本地时钟设置回一小时以关闭 DST 时，字符串时间（视为本地时间）无法正确解决 - 相同的字符串将匹配两个点及时。

```
// Algorithm: http://howardhinnant.github.io/date_algorithms.html
inline int days_from_civil(int y, int m, int d) noexcept
{
    y -= m <= 2;
    int era = y / 400;
    int yoe = y - era * 400;                                   // [0, 399]
    int doy = (153 * (m + (m > 2 ? -3 : 9)) + 2) / 5 + d - 1;  // [0, 365]
    int doe = yoe * 365 + yoe / 4 - yoe / 100 + doy;           // [0, 146096]

    return era * 146097 + doe - 719468;
}

// Converts a broken-down time structure with UTC time to a simple time representation.
// It does not modify broken-down time structure as BSD timegm() does.
time_t timegm_const(std::tm const* t)
{
    int year = t->tm_year + 1900;
    int month = t->tm_mon;          // 0-11
    if (month > 11)
    {
        year += month / 12;
        month %= 12;
    }
    else if (month < 0)
    {
        int years_diff = (11 - month) / 12;
        year -= years_diff;
        month += 12 * years_diff;
    }
    int days_since_epoch = days_from_civil(year, month + 1, t->tm_mday);

    return 60 * (60 * (24L * days_since_1970 + t->tm_hour) + t->tm_min) + t->tm_sec;
} 
```

该解决方案没有外部依赖，线程安全，可移植且快速。如果您发现代码有任何问题，请告诉我。

# string - 你如何处理有结构的字符串？

> ID：530522
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-09T23:22:40.093
> 
>         
> 
> 标签：string, validation

假设我有一个代表一个人的对象，该对象的电子邮件地址具有 getter 和 setter 方法。setter 方法定义可能如下所示：

```
setEmailAddress(String emailAddress)
    {
    this.emailAddress = emailAddress;
    } 
```

那么，调用`person.setEmailAddress(0)`会产生类型错误，但调用`person.setEmailAddress("asdf")`不会——即使“asdf”绝不是有效的电子邮件地址。

以我的经验，所谓的字符串几乎*从来都不*是任意的字符序列，没有长度或格式的限制。URI 浮现在脑海中——街道地址、电话号码、名字也是如此……你明白了。然而，这些数据类型通常存储为“只是字符串”。

回到我的人对象，假设我`setEmailAddress()`这样修改

```
setEmailAddress(EmailAddress emailAddress)
    // ... 
```

哪里`EmailAddress`是一个类...其构造函数采用电子邮件地址的字符串表示。我有什么收获吗？

好的，所以电子邮件地址是一个不好的例子。如果 URI 类将 URI 的字符串表示形式作为构造函数参数，并提供管理该 URI 的方法 - 设置路径、获取查询参数等，那么源字符串的有效性变得很重要。

所以我问大家，你如何处理有结构的字符串？你如何在你的界面中明确你的结构期望？

谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-09T23:30:54.830

[“具有结构的字符串”是常见代码气味“原始痴迷](http://sourcemaking.com/refactoring/primitive-obsession)”的症状。

补救措施是密切注意验证或操作这些结构的某些部分的代码中的重复。在重复的第一个提示——但不是之前——提取一个封装结构的类并在那里定位验证和查询。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T23:26:03.843

[这是属于“验证](https://stackoverflow.com/questions/tagged/validation)”标题下的一个非常常见的问题- 有很多方法可以验证文本用户输入，最常见的方法之一是[正则表达式](http://www.regular-expressions.info/)。

您还可以考虑为此使用内置的[System.Net.MailAddress](http://msdn.microsoft.com/en-us/library/system.net.mail.mailaddress.aspx)类，因为它提供了电子邮件地址的验证。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T18:54:49.253

**欢迎来到编程世界！**

我不认为你的问题是你的错误的症状。相反，它是一个**基本问题**，在整个编程世界中以多种形式出现。具有某种结构和*含义*的字符串在应用程序的不同子系统之间传递，每个子系统只能做很多解析和验证。

例如，验证电子邮件地址的问题就非常棘手。例如，各种人提供的接受电子邮件地址的正则表达式通常要么“太紧”（不接受所有内容），要么“太松”（接受非法的东西）。例如，“正则表达式“电子邮件地址”[的第一个谷歌点击是：](http://www.regular-expressions.info/email.html)

> 我收到最多反馈的正则表达式，更不用说“错误”报告，是您可以在本网站主页上找到的正则表达式：\b[A-Z0-9._%+-]+@[A -Z0-9.-]+.[AZ]{2,4}\b 用 RegexBuddy 分析这个正则表达式。我声称，这个正则表达式匹配任何电子邮件地址。我收到的大多数反馈都通过显示一个与此正则表达式不匹配的电子邮件地址来驳斥这种说法。

事实上，什么是或不是一个有效的电子邮件地址是一个复杂的问题，一个给定的程序可能或可能不想解决。URL 的问题更严重，特别是考虑到恶意 URL 的可能性。

理想情况下，您可以拥有一个库或系统调用来解决此类问题，而不是自己做任何事情（Microsoft Windows 调用自定义对话框以允许用户选择或创建文件，因为验证文件名是另一个棘手的问题） . 但是您也不能总是指望对给定的“有意义的字符串”进行适当的系统调用。

我会说没有通用的解决方案来解决带结构的字符串问题。相反，它是在您设计应用程序时出现的一个基本问题。在**[收集应用程序需求](http://c2.com/cgi/wiki?RequirementsGathering)**的过程中，您应该确定应用程序将接收哪些数据以及这些数据对应用程序的*意义*。这就是事情变得棘手的地方，因为您可能会注意到应用程序可能会以您的老板或客户可能没有想到的方式发展 - 或者应用程序实际上可能会以您没有想到的方式发展。因此，应用程序需要比看起来像最小的灵活一点，但只是一点点*。*它也不应该那么灵活，你会陷入困境。

现在，如果您决定需要验证/解释等给定字符串，则将该字符串放入对象或散列中可能是一个好方法 - 这是我知道的确保您的界面清晰的一种方法。但棘手的事情是决定你需要多少验证或解释。

因此，做出这些决定是一门艺术——这里没有教条式的答案。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:26:11.067

字符串是字符串。如果您需要您的字符串比普通字符串更智能，那么将它们解析为您描述的结构对象将是一个好主意。我会使用正则表达式来做到这一点。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:34:32.577

在格式化字符串时，正则表达式是您的朋友。您还可以将每个部分分别存储在一个结构中，以避免每次要使用正则表达式时遇到麻烦。例如

```
struct EMail
{
    String BeforeAt = "johndoe123";
    String AfterAt = "gmail.com";
}

Struct URL
{
    String Protocol = "http";
    String Domain = "sub.example.com";
    String Path = "stuff/example.html";
} 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:28:05.383

好吧，如果您想对 EmailAddress 对象执行多种不同类型的操作，则其他操作不必检查它是否是有效的电子邮件地址，因为可以保证 EmailAddress 对象具有有效的字符串。您可以在构造函数中抛出异常或使用工厂方法或您正在使用的任何“One True Methodology”方法。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:32:56.840

就个人而言，我喜欢强类型的想法，所以如果我仍在使用这种语言工作，我会采用你的第二个示例的风格。我唯一要改变的可能是使用更“类似演员”的结构，例如`EmailAddressFromString(String)`，它生成一个新`EmailAddress`对象（或者如果字符串不正确，则调整为合适的），因为我有点喜欢应用匈牙利符号。

顺便说一句，如果您有兴趣，Joel 在[http://www.joelonsoftware.com/articles/Wrong.html](http://www.joelonsoftware.com/articles/Wrong.html)中很好地介绍了整个问题。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T03:47:46.663

我同意强类型对象的调用，但是对于从字符串解析为对象的情况，答案很简单：错误处理。

处理错误一般有两种方法：异常和返回条件。通常，如果您希望收到格式错误的数据，那么您应该返回一条错误消息。对于不期望输入的情况，我会抛出异常。例如，您可能会传入格式错误的电子邮件地址，例如“bob”而不是“bob@gmail.com”。但是，对于 null 值，您可能会抛出异常，因为您不应该尝试使用 null 来形成电子邮件。

回到您的问题，我确实认为您可以通过将结构编码为对象来获得一些好处。具体来说，您只需要验证该字符串是否代表一个特定位置（例如构造函数）中的有效电子邮件地址。在其他地方，您的代码可以自由地假设 EmailAddress 对象是有效的，并且您不必依赖具有“EmailHelper”之类名称的狡猾类。

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T03:55:37.597

在这种情况下，我个人认为没有必要将电子邮件地址字符串强类型化为 EmailAddress。

要创建您的电子邮件地址，您迟早必须执行以下操作：

```
EmailAddress(String email) 
```

或二传手

```
SetEmailAddress(String email) 
```

在这两种情况下，您都必须验证电子邮件字符串输入，这会使您回到最初的验证问题。

正如其他人指出的那样，我会使用正则表达式。

如果您计划稍后必须对存储的信息执行特定操作（例如仅获取域名，诸如此类），那么拥有一个 EmailAddress 类将很有用。

# python - 从 WSGI 访问 POST 数据

> ID：530526
> 
>         
> 
> 赞同：37
> 
>         
> 
> 时间：2009-02-09T23:23:20.340
> 
>         
> 
> 标签：python, python-3.x, wsgi

我似乎无法弄清楚如何使用 WSGI 访问 POST 数据。我在 wsgi.org 网站上尝试了该示例，但没有成功。我现在正在使用 Python 3.0。请不要推荐 WSGI 框架，因为那不是我想要的。

我想弄清楚如何将其放入字段存储对象中。

* * *

## 回答 #1

> 赞同：31
> 
>             
> 
> 时间：2009-02-15T01:55:35.683

假设您正试图将 POST 数据放入 FieldStorage 对象：

```
# env is the environment handed to you by the WSGI server.
# I am removing the query string from the env before passing it to the
# FieldStorage so we only have POST data in there.
post_env = env.copy()
post_env['QUERY_STRING'] = ''
post = cgi.FieldStorage(
    fp=env['wsgi.input'],
    environ=post_env,
    keep_blank_values=True
) 
```

* * *

## 回答 #2

> 赞同：23
> 
>             
> 
> 时间：2009-02-10T01:56:52.390

```
body= ''  # b'' for consistency on Python 3.0
try:
    length= int(environ.get('CONTENT_LENGTH', '0'))
except ValueError:
    length= 0
if length!=0:
    body= environ['wsgi.input'].read(length) 
```

请注意，WSGI 尚未完全针对 Python 3.0 指定，并且许多流行的 WSGI 基础设施尚未转换（或已转换为 2to3d，但未经过适当测试）。（甚至 wsgiref.simple_server 也不会运行。）今天你在 3.0 上做 WSGI 很艰难。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-10-15T14:44:54.077

这对我有用（在 Python 3.0 中）：

```
import urllib.parse

post_input = urllib.parse.parse_qs(environ['wsgi.input'].readline().decode(),True) 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2021-07-26T21:52:04.220

我遇到了同样的问题，我花了一些时间研究解决方案。

带有详细信息和资源的完整答案（因为此处接受的答案在**python3**上对我不起作用，在 env 库等中需要纠正许多错误）：

```
# the code below is taken from and explained officially here:
# https://wsgi.readthedocs.io/en/latest/specifications/handling_post_forms.html
import cgi
def is_post_request(environ):
    if environ['REQUEST_METHOD'].upper() != 'POST':
        return False
    content_type = environ.get('CONTENT_TYPE', 'application/x-www-form-urlencoded')
    return (content_type.startswith('application/x-www-form-urlencoded' or content_type.startswith('multipart/form-data')))
def get_post_form(environ):
    assert is_post_request(environ)
    input = environ['wsgi.input']
    post_form = environ.get('wsgi.post_form')
    if (post_form is not None
        and post_form[0] is input):
        return post_form[2]
    # This must be done to avoid a bug in cgi.FieldStorage
    environ.setdefault('QUERY_STRING', '')
    fs = cgi.FieldStorage(fp=input,
                          environ=environ,
                          keep_blank_values=1)
    new_input = InputProcessed()
    post_form = (new_input, input, fs)
    environ['wsgi.post_form'] = post_form
    environ['wsgi.input'] = new_input
    return fs
class InputProcessed(object):
    def read(self, *args):
        raise EOFError('The wsgi.input stream has already been consumed')
    readline = readlines = __iter__ = read

# the basic and expected application function for wsgi
# get_post_form(environ) returns a FieldStorage object
# to access the values use the method .getvalue('the_key_name')
# this is explained officially here:
# https://docs.python.org/3/library/cgi.html
# if you don't know what are the keys, use .keys() method and loop through them
def application(environ, start_response):
    start_response('200 OK', [('Content-type', 'text/plain')])
    user = get_post_form(environ).getvalue('user')
    password = get_post_form(environ).getvalue('password')
    output = 'user is: '+user+' and password is: '+password
    return [output.encode()] 
```

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2009-02-09T23:33:52.220

我建议你看看一些框架是如何做的。（我不推荐任何一个，只是以它们为例。）

这是来自[Werkzeug](http://dev.pocoo.org/projects/werkzeug/)的代码：

[http://dev.pocoo.org/projects/werkzeug/browser/werkzeug/wrappers.py#L150](http://dev.pocoo.org/projects/werkzeug/browser/werkzeug/wrappers.py#L150)

调用

[http://dev.pocoo.org/projects/werkzeug/browser/werkzeug/utils.py#L1420](http://dev.pocoo.org/projects/werkzeug/browser/werkzeug/utils.py#L1420)

在这里总结起来有点复杂，所以我不会。

# python - Python 2.x 的陷阱和地雷

> ID：530530
> 
>         
> 
> 赞同：64
> 
>         
> 
> 时间：2009-02-09T23:25:00.400
> 
>         
> 
> 标签：python

我的问题的目的是加强我对 Python 的知识基础并更好地了解它，包括了解它的错误和惊喜。为了保持具体，我只对 CPython 解释器感兴趣。

我正在寻找类似于从我的[PHP 地雷](https://stackoverflow.com/questions/512120/php-landmines-in-general)
问题中学到的东西，其中一些答案对我来说是众所周知的，但有几个是可怕的边缘。

更新：显然，一个可能有两个人对我提出的一个问题感到不安，这个问题已经在 Stack Overflow 之外得到了部分答案。作为某种妥协，这里是 URL
 [http://www.ferg.org/projects/python_gotchas.html](http://www.ferg.org/projects/python_gotchas.html)

请注意，这里的一两个答案已经是上述网站上所写内容的原创。

* * *

## 回答 #1

> 赞同：85
> 
>             
> 
> 时间：2009-02-10T01:27:06.050

**Expressions in default arguments are calculated when the function is defined, *not* when it’s called.** 

**Example:** consider defaulting an argument to the current time:

```
>>>import time
>>> def report(when=time.time()):
...     print when
...
>>> report()
1210294387.19
>>> time.sleep(5)
>>> report()
1210294387.19 
```

The `when` argument doesn't change. It is evaluated when you define the function. It won't change until the application is re-started.

**Strategy:** you won't trip over this if you default arguments to `None` and then do something useful when you see it:

```
>>> def report(when=None):
...     if when is None:
...         when = time.time()
...     print when
...
>>> report()
1210294762.29
>>> time.sleep(5)
>>> report()
1210294772.23 
```

**Exercise:** to make sure you've understood: why is this happening?

```
>>> def spam(eggs=[]):
...     eggs.append("spam")
...     return eggs
...
>>> spam()
['spam']
>>> spam()
['spam', 'spam']
>>> spam()
['spam', 'spam', 'spam']
>>> spam()
['spam', 'spam', 'spam', 'spam'] 
```

* * *

## 回答 #2

> 赞同：61
> 
>             
> 
> 时间：2009-02-10T07:12:07.140

你应该知道如何在 Python 中处理类变量。考虑以下类层次结构：

```
class AAA(object):
    x = 1

class BBB(AAA):
    pass

class CCC(AAA):
    pass 
```

现在，检查以下代码的输出：

```
>>> print AAA.x, BBB.x, CCC.x
1 1 1
>>> BBB.x = 2
>>> print AAA.x, BBB.x, CCC.x
1 2 1
>>> AAA.x = 3
>>> print AAA.x, BBB.x, CCC.x
3 2 3 
```

惊讶吗？如果您记得类变量在内部作为类对象的字典处理，您就不会这样了。*对于读取操作*，如果在当前类的字典中没有找到变量名，则在父类中搜索它。因此，再次使用以下代码，但带有解释：

```
# AAA: {'x': 1}, BBB: {}, CCC: {}
>>> print AAA.x, BBB.x, CCC.x
1 1 1
>>> BBB.x = 2
# AAA: {'x': 1}, BBB: {'x': 2}, CCC: {}
>>> print AAA.x, BBB.x, CCC.x
1 2 1
>>> AAA.x = 3
# AAA: {'x': 3}, BBB: {'x': 2}, CCC: {}
>>> print AAA.x, BBB.x, CCC.x
3 2 3 
```

处理类实例中的类变量也是如此（将此示例视为上述示例的延续）：

```
>>> a = AAA()
# a: {}, AAA: {'x': 3}
>>> print a.x, AAA.x
3 3
>>> a.x = 4
# a: {'x': 4}, AAA: {'x': 3}
>>> print a.x, AAA.x
4 3 
```

* * *

## 回答 #3

> 赞同：40
> 
>             
> 
> 时间：2009-02-10T07:39:02.863

循环和 lambdas（或任何闭包，真的）：变量由*名称绑定*

```
funcs = []
for x in range(5):
  funcs.append(lambda: x)

[f() for f in funcs]
# output:
# 4 4 4 4 4 
```

一种解决方法是创建一个单独的函数或按名称传递参数：

```
funcs = []
for x in range(5):
  funcs.append(lambda x=x: x)
[f() for f in funcs]
# output:
# 0 1 2 3 4 
```

* * *

## 回答 #4

> 赞同：20
> 
>             
> 
> 时间：2009-02-09T23:43:40.963

动态绑定使变量名中的拼写错误非常难以找到。花半个小时修复一个小错误很容易。

编辑：一个例子......

```
for item in some_list:
    ... # lots of code
... # more code
for tiem in some_other_list:
    process(item) # oops! 
```

* * *

## 回答 #5

> 赞同：18
> 
>             
> 
> 时间：2010-11-26T14:00:22.207

我对 Python 最大的惊喜之一就是这个：

```
a = ([42],)
a[0] += [43, 44] 
```

这正如人们所期望的那样工作，除了在更新元组的第一个条目后引发 TypeError ！执行语句后`a`也会如此，但无论如何都会有异常。另一方面，如果你尝试这个`([42, 43, 44],)``+=`

```
a = ([42],)
b = a[0]
b += [43, 44] 
```

你不会得到错误。

* * *

## 回答 #6

> 赞同：16
> 
>             
> 
> 时间：2010-12-09T22:13:35.743

```
try:
    int("z")
except IndexError, ValueError:
    pass 
```

这不起作用的原因是因为 IndexError 是您要捕获的异常类型，而 ValueError 是您要为其分配异常的变量的名称。

捕获多个异常的正确代码是：

```
try:
    int("z")
except (IndexError, ValueError):
    pass 
```

* * *

## 回答 #7

> 赞同：12
> 
>             
> 
> 时间：2009-02-10T13:10:19.753

不久前有很多关于隐藏语言特性的讨论：[hidden-features-of-python](https://stackoverflow.com/questions/101268/hidden-features-of-python)。提到了一些陷阱（以及一些好东西）。

此外，您可能想查看[Python Warts](http://wiki.python.org/moin/PythonWarts)。

但对我来说，整数除法是一个陷阱：

```
>>> 5/2
2 
```

你可能想要：

```
>>> 5*1.0/2
2.5 
```

如果你真的想要这种（类似 C 的）行为，你应该写：

```
>>> 5//2
2 
```

因为这也适用于浮点数（当你最终转到[Python 3](http://docs.python.org/dev/3.0/whatsnew/3.0.html#integers)时它会起作用）：

```
>>> 5*1.0//2
2.0 
```

GvR 解释了整数除法是如何起作用的，它在[Python 的历史上是](http://python-history.blogspot.com/2009/03/problem-with-integer-division.html)如何起作用的。

* * *

## 回答 #8

> 赞同：11
> 
>             
> 
> 时间：2009-05-20T23:58:14.393

不包括`__init__`.py 在您的包中。那个有时仍然让我着迷。

* * *

## 回答 #9

> 赞同：11
> 
>             
> 
> 时间：2011-05-13T07:28:52.447

**列表切片**让我很伤心。我实际上认为以下行为是一个错误。

定义一个列表 x

```
>>> x = [10, 20, 30, 40, 50] 
```

访问索引 2：

```
>>> x[2]
30 
```

如你所料。

将列表从索引 2 切到列表末尾：

```
>>> x[2:]
[30, 40, 50] 
```

如你所料。

访问索引 7：

```
>>> x[7]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IndexError: list index out of range 
```

再次，如您所料。

**但是**，尝试将列表从索引 7 切到列表末尾：

```
>>> x[7:]
[] 
```

？？？

补救方法是在使用列表切片时进行大量测试。我希望我只是得到一个错误。更容易调试。

* * *

## 回答 #10

> 赞同：9
> 
>             
> 
> 时间：2009-02-11T06:02:08.743

[James Dumay 雄辩地让我想起](http://twitter.com/i386/status/1194993686)了另一个 Python 陷阱：

**并非所有 Python 的“随附电池”都很棒**。

James 的具体例子是 HTTP 库：`httplib`, `urllib`, `urllib2`, `urlparse`, `mimetools`, 和`ftplib`. 某些功能是重复的，而您期望的某些功能则完全不存在，例如重定向处理。坦率地说，这很可怕。

如果这些天我必须通过 HTTP 抓取一些东西，我会使用从 Yum 项目分叉的[urlgrabber模块。](http://linux.duke.edu/projects/urlgrabber/)

* * *

## 回答 #11

> 赞同：9
> 
>             
> 
> 时间：2009-02-09T23:31:31.523

我遇到的唯一问题/惊喜是 CPython 的 GIL。如果出于某种原因，您希望 CPython 中的 python 线程同时运行……那么它们不是，Python 人群甚至 Guido 本人都很好地记录了这一点。

对 CPython 线程和幕后发生的一些事情以及为什么与 CPython 无法实现真正​​的并发进行了长而透彻的解释。
[http://jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/](http://jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/)

* * *

## 回答 #12

> 赞同：7
> 
>             
> 
> 时间：2010-11-26T13:43:01.973

```
def f():
    x += 1

x = 42
f() 
```

结果为`UnboundLocalError`, 因为本地名称是静态检测的。一个不同的例子是

```
def f():
    print x
    x = 43

x = 42
f() 
```

* * *

## 回答 #13

> 赞同：7
> 
>             
> 
> 时间：2009-05-20T23:49:21.867

默认情况下，浮点数不会以全精度打印（不带`repr`）：

```
x = 1.0 / 3
y = 0.333333333333
print x  #: 0.333333333333
print y  #: 0.333333333333
print x == y  #: False 
```

`repr`打印太多数字：

```
print repr(x)  #: 0.33333333333333331
print repr(y)  #: 0.33333333333300003
print x == 0.3333333333333333  #: True 
```

* * *

## 回答 #14

> 赞同：7
> 
>             
> 
> 时间：2009-07-19T20:12:13.610

无意中**混合 oldstyle 和 newstyle 类**可能会导致看似神秘的错误。

假设您有一个由超类 A 和子类 B 组成的简单类层次结构。当 B 被实例化时，必须首先调用 A 的构造函数。下面的代码正确地做到了这一点：

```
class A(object):
    def __init__(self):
        self.a = 1

class B(A):
    def __init__(self):
        super(B, self).__init__()
        self.b = 1

b = B() 
```

但是，如果您忘记将 A 设为 newstyle 类并像这样定义它：

```
class A:
    def __init__(self):
        self.a = 1 
```

你得到这个回溯：

```
Traceback (most recent call last):
  File "AB.py", line 11, in <module>
    b = B()
  File "AB.py", line 7, in __init__
    super(B, self).__init__()
TypeError: super() argument 1 must be type, not classobj 
```

与此问题相关的另外两个问题是[489269](https://stackoverflow.com/questions/489269/python-super-raises-typeerror-why)和[770134](https://stackoverflow.com/questions/770134/python-cmd-module-subclassing-issue)

* * *

## 回答 #15

> 赞同：5
> 
>             
> 
> 时间：2009-07-26T09:13:05.903

您不能使用 locals()['x'] = whatever 来更改您可能期望的局部变量值。

```
This works:

>>> x = 1
>>> x
1
>>> locals()['x'] = 2
>>> x
2

BUT:

>>> def test():
...     x = 1
...     print x
...     locals()['x'] = 2
...     print x  # *** prints 1, not 2 ***
...
>>> test()
1
1 
```

这实际上让我在 SO 上的答案中被烧毁了，因为我已经在函数之外对其进行了测试并得到了我想要的更改。之后，我发现它被提及并与“潜入 Python”中的 globals() 的情况进行了对比。参见示例 8.12。（尽管它没有注意到通过 locals() 进行的更改将在我上面显示的顶层起作用。）

* * *

## 回答 #16

> 赞同：5
> 
>             
> 
> 时间：2017-03-22T17:22:13.550

## `x += [...]``x = x + [...]`与何时是列表不一样`x``

```
>>> x = y = [1,2,3]
>>> x = x + [4]
>>> x == y
False

>>> x = y = [1,2,3]
>>> x += [4]
>>> x == y
True 
```

一个创建一个新列表，而另一个在原地修改

* * *

## 回答 #17

> 赞同：4
> 
>             
> 
> 时间：2015-06-12T12:24:50.467

## 带有嵌套列表的列表重复

这让我今天大吃一惊，浪费了我一个小时的调试时间：

```
>>> x = [[]]*5
>>> x[0].append(0)

# Expect x equals [[0], [], [], [], []]
>>> x
[[0], [0], [0], [0], [0]]   # Oh dear 
```

说明：[Python列表问题](https://stackoverflow.com/questions/1959744/python-list-problem)

* * *

## 回答 #18

> 赞同：2
> 
>             
> 
> 时间：2014-05-16T16:06:37.387

Python 2 的比较有一些令人惊讶的行为：

```
>>> print x
0
>>> print y
1
>>> x < y
False 
```

这是怎么回事？`repr()`救援：

```
>>> print "x: %r, y: %r" % (x, y)
x: '0', y: 1 
```

* * *

## 回答 #19

> 赞同：2
> 
>             
> 
> 时间：2014-05-15T13:00:39.113

当您需要实例变量时使用类变量。大多数情况下，这不会导致问题，但如果它是一个可变值，则会引起意外。

```
class Foo(object):
    x = {} 
```

但：

```
>>> f1 = Foo()
>>> f2 = Foo()
>>> f1.x['a'] = 'b'
>>> f2.x
{'a': 'b'} 
```

您几乎总是需要实例变量，这需要您在内部分配`__init__`：

```
class Foo(object):
    def __init__(self):
        self.x = {} 
```

* * *

## 回答 #20

> 赞同：1
> 
>             
> 
> 时间：2014-05-16T16:10:26.607

如果你在一个函数内赋值给一个变量，Python 会假定该变量是在该函数内定义的：

```
>>> x = 1
>>> def increase_x():
...     x += 1
... 
>>> increase_x()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 2, in increase_x
UnboundLocalError: local variable 'x' referenced before assignment 
```

使用`global x`（或`nonlocal x`在 Python 3 中）声明要设置在函数外部定义的变量。

* * *

## 回答 #21

> 赞同：0
> 
>             
> 
> 时间：2015-03-19T15:12:35.627

的值`range(end_val)`不仅严格小于`end_val`，而且严格小于`int(end_val)`。对于 的`float`参数`range`，这可能是一个意想不到的结果：

```
from future.builtins import range
list(range(2.89))
[0, 1] 
```

* * *

## 回答 #22

> 赞同：0
> 
>             
> 
> 时间：2017-06-13T21:01:41.203

由于“真实性”，这是有道理的：

```
>>>bool(1)
True 
```

但你可能没想到它会反过来：

```
>>>float(True)
1.0 
```

如果您将字符串转换为数字并且您的数据具有 True/False 值，这可能是一个问题。

* * *

## 回答 #23

> 赞同：-1
> 
>             
> 
> 时间：2019-03-29T08:50:01.523

如果您以这种方式创建列表列表：

```
arr = [[2]] * 5 
print arr 
[[2], [2], [2], [2], [2]] 
```

然后这将创建一个所有元素都指向同一个对象的数组！这可能会造成真正的混乱。考虑一下：

```
arr[0][0] = 5 
```

那么如果你打印 arr

```
print arr
[[5], [5], [5], [5], [5]] 
```

初始化数组的正确方法是例如使用列表推导：

```
arr = [[2] for _ in range(5)]

arr[0][0] = 5

print arr

[[5], [2], [2], [2], [2]] 
```

# c# - 在 C# 中的字符串中找到 {0} 是什么意思？

> ID：530539
> 
>         
> 
> 赞同：87
> 
>         
> 
> 时间：2009-02-09T23:28:12.997
> 
>         
> 
> 标签：c#, string, formatting

在这样的字典中：

```
Dictionary<string, string> openWith = new Dictionary<string, string>();

openWith.Add("txt", "notepad.exe");
openWith.Add("bmp", "paint.exe");
openWith.Add("dib", "paint.exe");
openWith.Add("rtf", "wordpad.exe");

Console.WriteLine("For key = \"rtf\", value = {0}.", openWith["rtf"]); 
```

输出是：

> 对于 Key = "rtf" value = wordpad.exe

是什么`{0}`意思？

* * *

## 回答 #1

> 赞同：183
> 
>             
> 
> 时间：2009-02-09T23:29:58.250

您正在打印格式化的字符串。{0} 表示在格式字符串后面插入第一个参数；在这种情况下，与键“rtf”关联的值。

对于类似的 String.Format，如果你有类似的东西

```
//            Format string                    {0}           {1}
String.Format("This {0}.  The value is {1}.",  "is a test",  42 ) 
```

您将创建一个字符串“这**是一个测试**。值是**42** ”。

您还可以使用表达式，并多次打印值：

```
//            Format string              {0} {1}  {2}
String.Format("Fib: {0}, {0}, {1}, {2}", 1,  1+1, 1+2) 
```

产生“Fib: **1** , **1** , **2** , **3** ”

请参阅[http://msdn.microsoft.com/en-us/library/txafckwd.aspx](http://msdn.microsoft.com/en-us/library/txafckwd.aspx)了解更多信息，其中讨论了复合格式。

* * *

## 回答 #2

> 赞同：25
> 
>             
> 
> 时间：2009-02-09T23:33:49.207

它是字符串中的占位符。

例如，

```
string b = "world.";

Console.WriteLine("Hello {0}", b); 
```

会产生这个输出：

```
Hello world. 
```

此外，您可以拥有任意数量的占位符。这也适用于`String.Format`：

```
string b = "world.";
string a = String.Format("Hello {0}", b);

Console.WriteLine(a); 
```

你仍然会得到相同的输出。

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2009-02-10T00:19:02.813

除了要打印的值`{0} {1}`、 等之外，您还可以指定格式。例如，`{0,4}`将是填充到四个空格的值。

有许多内置的格式说明符，此外，您可以自己制作。有关体面的教程/列表，请参阅*[C# 中的字符串格式](http://blog.stevex.net/index.php/string-formatting-in-csharp/)*。[此外，这里](http://blog.stevex.net/index.php/2007/09/28/string-formatting-faq/)还有一个常见问题解答。

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2009-02-10T17:35:07.807

为了将来参考，在 Visual Studio 中，您可以尝试将光标放在方法名称中（例如，WriteLine），然后按下`F1`以调出该上下文的帮助。在这种情况下，四处挖掘应该会找到您`String.Format()`，并提供大量有用的信息。

请注意，突出显示选择（例如，双击或进行拖动选择）并点击`F1`只会进行非上下文字符串搜索（这往往会在找到任何有用的东西时很糟糕），因此请确保将光标定位在内部的任何位置这个词没有突出显示。

这对于类和其他类型的文档也很有帮助。

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2009-02-09T23:30:13.600

它是第一个参数的占位符，在您的情况下计算为“wordpad.exe”。

如果你有一个额外的参数，你会使用`{1}`，等等。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2009-02-09T23:30:50.713

它是一个参数的占位符，很像`%s`格式说明符在`printf`.

您也可以开始在其中添加额外的东西来确定格式，尽管使用数字变量更有意义（[这里的示例](http://en.csharp-online.net/CSharp_Format_Specifiers%E2%80%94Numeric_Format_Specifiers)）。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2018-05-14T04:51:41.797

这就是我们所说的 .NET Framework 的[复合格式](https://docs.microsoft.com/en-us/dotnet/standard/base-types/composite-formatting)，用于将对象的值转换为其文本表示形式并将该表示形式嵌入到字符串中。结果字符串被写入输出流。

> 重载的[Console.WriteLine 方法 (String, Object)](https://msdn.microsoft.com/en-us/library/586y06yf(v=vs.110).aspx)使用指定的格式信息将指定对象的文本表示形式（后跟当前行终止符）写入标准输出流。

# python - 是否有一个 Python 正则表达式可以在以“#”开头的行上将所有“foo”更改为“bar”？

> ID：530546
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-09T23:30:53.490
> 
>         
> 
> 标签：python, regex

是否可以编写一个可以应用于多行字符串的 Python 正则表达式并将所有出现的“foo”更改为“bar”，但只能在以“#”开头的行上？

我能够在 Perl 中使用 Perl 的 \G 正则表达式 sigil，它匹配上一个匹配的结尾。但是，Python 似乎不支持这一点。

这是 Perl 解决方案，以防万一：

```
my $x =<<EOF;
# foo
foo
# foo foo
EOF

$x =~ s{
        (            # begin capture
          (?:\G|^\#) # last match or start of string plus hash
          .*?        # followed by anything, non-greedily
        )            # end capture
        foo
      }
      {$1bar}xmg;

print $x; 
```

当然，正确的输出是：

```
# bar
foo
# bar bar 
```

这可以在 Python 中完成吗？

* * *

## 编辑：是的，我知道可以将字符串拆分为单独的行并测试每一行，然后决定是否应用转换，但请相信我的话，在这种情况下这样做不是微不足道的。我真的需要用一个正则表达式来做。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-09T23:32:44.030

```
lines = mystring.split('\n')
for line in lines:
    if line.startswith('#'):
        line = line.replace('foo', 'bar') 
```

不需要正则表达式。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:38:04.050

*使用正则表达式看起来*很容易：

```
>>> import re
... text = """line 1
... line 2
... Barney Rubble Cutherbert Dribble and foo
... line 4
... # Flobalob, bing, bong, foo and brian
... line 6"""
>>> regexp = re.compile('^(#.+)foo', re.MULTILINE)
>>> print re.sub(regexp, '\g<1>bar', text)
line 1
line 2
Barney Rubble Cutherbert Dribble and foo
line 4
# Flobalob, bing, bong, bar and brian
line 6 
```

但是然后尝试您的示例文本并不是那么好：

```
>>> text = """# foo
... foo
... # foo foo"""
>>> regexp = re.compile('^(#.+)foo', re.MULTILINE)
>>> print re.sub(regexp, '\g<1>bar', text)
# bar
foo
# foo bar 
```

所以，试试这个：

```
>>> regexp = re.compile('(^#|\g.+)foo', re.MULTILINE)
>>> print re.sub(regexp, '\g<1>bar', text)
# foo
foo
# foo foo 
```

这*似乎有效，但我在*[文档](http://docs.python.org/library/re.html)中找不到 \g ！

**道德：**不要在喝几杯啤酒后尝试编码。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T00:12:42.203

\g 像 perl 一样在 python 中工作，并且[在 docs 中](http://docs.python.org/library/re.html)。

"除了如上所述的字符转义和反向引用之外，\g 将使用由名为 name 的组匹配的子字符串，如 (?P...) 语法所定义。\g 使用相应的组号；\g<2 > 因此等价于 \2，但在诸如 \g<2>0 之类的替换中没有歧义。\20 将被解释为对第 20 组的引用，而不是对第 2 组后跟文字字符 '0 的引用'. 反向引用 \g<0> 替换了 RE 匹配的整个子字符串。”

# javascript - Dojo - XHTML 验证？

> ID：530560
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-09T23:34:15.433
> 
>         
> 
> 标签：javascript, dojo

是否可以让 Dojo (javascript) 小部件验证 XHTML？

如果是这样，怎么做？

它可以像使用 CDATA 一样简单吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T14:55:44.663

CDATA 在这里帮不了你。如果你真的想根据 XHTML DTD/schema 编写代码，你可以做到，但不能利用 Dojo 标记语言 (DojoML) 的灵活性。您可以做的是定义自己的方式来标记小部件，例如`<div class="dojoButton"/>`，然后在页面加载时使用以下方式实例化它们：

```
dojo.query('div[class=dojoButton]').instantiate(
  dijit.form.Button, {}
); 
```

在你这样做之前，请看一下[Dojo 不验证](http://www.sitepen.com/blog/2008/10/27/debunking-dojo-toolkit-myths/) *（在文章中间）*这个段落和这个[Dojo Degradability](http://higginsforpresident.net/2008/08/dojo-degradability/)。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:55:45.473

是的，您不需要使用 dojoType="dojo.foo.bar" 非标准属性，而是需要有一个文档 onload 事件来“接管”文档中的标准 HTML 标记并将它们重写为 Dojo 标记。

# sql-server - Classic ASP: How can I use a value from SQL twice?

> ID：530565
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-09T23:35:26.070
> 
>         
> 
> 标签：sql-server, asp-classic

I'm very fresh with web dev, but am putting together a simple software catalog with classic ASP.  Everything seems fine, except I want to use a value from my SQL database twice on the page.  For example, in the page title as well as in the body of the page, however I can only seem to use each value once:

```
....
Set nItem = Request.QueryString("ID")

strSQL = "SELECT * "_
    & "FROM [Packages] "_
    & "WHERE id='" & nItem & "';" 

Set rstSearch = cnnSearch.Execute(strSQL)

<title><%=rstSearch.Fields("Software") %></title>
<body>
<center>Software Information</center>
<%=rstSearch.Fields("Software")%> <br />
<%=rstSearch.Fields("Version")%> <br />
<%=rstSearch.Fields("ID")%> <br />
<%=rstSearch.Fields("Licence")%> <br />
... 
```

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-09T23:45:16.030

Assign it to a variable; don't just pull the value from the Recordset.

```
Set nItem = Request.QueryString("ID")

strSQL = "SELECT * "_
    & "FROM [Packages] "_
    & "WHERE id='" & nItem & "';" 

Set rstSearch = cnnSearch.Execute(strSQL)

Dim software
software = rstSearch("Software")
' set your other fields as variables...

<title><%= software %></title>
<body>
<center>Software Information</center>
<%= software %> <br /> 
```

Should work fine for you.

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-09T23:48:09.190

Firstly a quick warning, you are open to SQL injection in your inclusion of nItem in the query. Just an aside but one to watch :)

Other than that there should be no problem referring to a column in your recordset twice. I'd hazard a guess that you have a different problem in the code. It might help if you publish the behaviour / errors you get when trying this page. But I think there may be some other code that we don't see in the snippet above that is causing the issue.

One thing to help you run control tests would be to replace the "select *" with "select Software, Version, ID, License" etc. You could refer to the column by numeric ordinal then which may help.

Good luck with it.

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:44:01.773

You may need to just extract the value to a local Var and use it twice.  I have seen weird stuff like this before, a long, long time ago.

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:45:35.747

Some comments:

```
1\. Possibly call rstSearch.MoveFirst before the second 
   rstSearch.Fields("Software")
2\. If that doesn't work write <%=Err.Description%> right after the 
   second rstSearch.Fields("Software") line.
3\. Try not to ever use Select * for selecting columns. 
   Always specify which columns you want.
4\. Please try and use ASP.Net. It's much better then ASP3. 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:48:27.910

Sorry, can't help on the actual answer, but this looks like the prime example of a SQL Injection Attack:

```
Set nItem = Request.QueryString("ID")

strSQL = "SELECT * "_
    & "FROM [Packages] "_
    & "WHERE id='" & nItem & "';" 
```

Looks like I could just change the URL to "?ID=1'; DROP TABLE STUDENTS; --" to mess stuff up.

# unit-testing - 除了“所有这些”作为答案之外，哪种类型的应用程序（具体而言）在单元测试方面取得了真正的成功？

> ID：530567
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-09T23:37:51.883
> 
>         
> 
> 标签：unit-testing, testing, junit

*   你使用了什么类型的应用程序，单元测试接近（Web 应用程序、编译器、Rails 等？）。

*   您的应用程序是用什么语言编写的？

*   您是否使用了诸如 junit 或 nunit 之类的现有单元测试框架，或者您是否使用了自己的框架。

*   您是使用自动代码生成测试用例还是通过手动创建大部分工作？

*   您是否将您的单元测试与自动构建程序（如巡航控制或类似的东西）集成在一起？

*   您是否认为您的测试非常细粒度、低级别或者它们是非常高级别的测试（“测试整个页面”）。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-09T23:41:58.237

他们都是。

（对不起，这个只能说）

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:42:07.707

[#67299](https://stackoverflow.com/questions/67299/is-unit-testing-worth-the-effort)

[#286587](https://stackoverflow.com/questions/286587/are-you-really-using-unit-tests)

[#301693](https://stackoverflow.com/questions/301693/why-didnt-unit-testing-work-out-for-your-project)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-09T23:45:16.483

我使用 Rspec 和 Test:Unit 对 Rails Web 应用程序和独立的 Ruby 应用程序进行了单元测试。无法生成真正的测试，也许充其量只能被淘汰。我确实使用了 Cruisecontrol，但发现用作实际的集成工具有点麻烦。它作为开发人员之间的骄傲徽章很有用，确保在提交代码之前通过测试套件保持警惕。据我所知，功能测试适用于高级别的东西，我的单元测试往往是相当低级的。

是的，我从不后悔为我的代码编写单元测试。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-08-24T20:11:52.283

一般来说，我会说从流程的早期阶段就完成单元测试的应用程序。将其固定到现有的无数行应用程序上并不像从一开始就那样有效。

如果该语言有良好的支持，它也会有所帮助。Java 和 .NET 都具有出色的 XUnit 框架——C++ 的难度更大。

# flash - 任何可以找到免费 Flash 教程的地方

> ID：530579
> 
>         
> 
> 赞同：-1
> 
>         
> 
> 时间：2009-02-09T23:43:55.830
> 
>         
> 
> 标签：flash

正如上面的问题，有谁知道我在哪里可以获得免费的Flash教程和插件

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:57:33.393

自 2000 年初以来，我一直在使用[flashkit](http://flashkit.com/)。它拥有令人惊叹的教程和源代码集合。他们在论坛上也有知识渊博的贡献者。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T00:07:00.890

[Kongregate Labs](http://www.kongregate.com/labs)有一个非常以游戏为中心的教程。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T06:34:07.357

[http://www.flashbookmarks.com](http://www.flashbookmarks.com)有一个完整的 Flash 站点、博客、教程、文章等列表，可以在他们的网页上查看（无需导航）。

# wpf - WPF：以一定角度平移画布

> ID：530587
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-09T23:45:58.023
> 
>         
> 
> 标签：wpf, math, animation, timer

*参考我目前正在构建的[这个编程游戏。](https://stackoverflow.com/questions/505040/developing-a-robocode-type-game-with-net-for-a-school-assignment)*

**重要提示：向下滚动查看[编辑]**

用户可以在我的游戏中调用的一些方法将是对机器人进行 Translate Transform 的方法（`Canvas`基本上是一个）。

从 move 方法中，我知道了 Robot 当时将要面对的航向（角度），也知道 Robot 想要移动的像素长度。

现在，我面临的问题是**如何将画布（在计时器中）平移到当前的面向角度？** 

[替代文字 http://img8.imageshack.us/img8/3606/robottranslatemovementfu3.jpg](http://img8.imageshack.us/img8/3606/robottranslatemovementfu3.jpg)

一定有一些我在这里遗漏的数学，但我只是不知道在每个 Timer 滴答声中要解决什么问题。

这是被调用的方法，它包含每 5 毫秒计时一次的计时器，为运动设置动画：

```
public void Ahead(int pix)
    {
        eventQueue.Enqueue((TimerDelegate)delegate(DispatcherTimer dt)
        {
            /* Available Variables:
            Translate_Body.X <= Current Robot Location on X-axis
            Translate_Body.Y <= Current Robot Location on Y-axis
            Bot.Body <= The Canvas that needs to be translated (moved)

            To translate the robot, I just basically do this:
                Translate_Body.X++; or Translate_Body.YY++; to increment, or -- to decrement ofcourse

            Now I need to figure out the logic on when to increment (or decrement, according to the angle I suppose) the Y and X
            */

            IsActionRunning = true;
            dt.Tick += new EventHandler(delegate(object sender, EventArgs e)
            {
                lock (threadLocker)
                {
                     //The logic needs to happen in here, with each timer tick.
                     //so with each timer tick, the robot is moved on pixel according to its angle.
                     //Then I need to make a condition that will indicate that the robot has arrived at its destination, and thus stop the timer.
                }
            });    
            dt.Start();
        });
    } 
```

* * *

**[重要编辑]**

我现在已经更改了我的逻辑，使用 WPF`BeginAnimation`而不是自动收报机来为我制作动画。所以现在我不需要计算每个刻度的新坐标，但我只提供结束坐标，然后`BeginAnimation`将在一段时间内转换它：

```
public void Ahead(int pix)
    {
        eventQueue.Enqueue((TimerDelegate)delegate
        {

            Animator_Body_X.From = Translate_Body.X;
            Animator_Body_X.To = //The end X-coordinate
            Translate_Body.BeginAnimation(TranslateTransform.XProperty, Animator_Body_X);

            Animator_Body_Y.From = Translate_Body.Y;
            Animator_Body_Y.To = //The end Y-coordinate
            Translate_Body.BeginAnimation(TranslateTransform.YProperty, Animator_Body_Y);
        });
    } 
```

所以现在，**给定画布当前旋转的角度（0-359），起始x和y坐标（画布当前所在的位置）和距离，我如何计算结束坐标？**

* * *

**更新：[解决方案](https://stackoverflow.com/questions/530587/wpf-translating-a-canvas-at-an-angle/645863#645863)**

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T02:24:57.563

为了帮助数学：

如果您想在**t秒内移动****d**个像素距离，那么您需要平均移动 x/t（像素/秒）。

 **为此，您需要存储动画的开始时间 (start_time)。

在每个计时器滴答声中，计算动画完成的百分比：

```
percent_complete= (now - start_time) / t 
```

将 percent_complete 乘以您想要移动的距离，以获得您应该距起点 (d_now) 的距离。请记住在开始动画时跟踪开始距离。

```
d_now = percent_complete * d 
```

然后可以通过以下方式计算机器人当前计时器滴答的 x 和 y：

```
x = d_now * cos(heading) + start.x
y = d_now * sin(heading) + start.y 
```

您可能需要调整事物的迹象，但这就是要点。抛开数学不谈，WPF 中不是已经为您提供了基本的动画例程吗？我从未使用过它，但这是我的印象。  [链接](http://msdn.microsoft.com/en-us/library/ms752312.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-03-14T12:42:24.327

## 解决方案

感谢[Andy Mikula](https://stackoverflow.com/questions/534424/math-in-wpf-getting-new-x-y-coordinates-after-a-translation/534475#534475)和[Cameron MacFarland](https://stackoverflow.com/questions/534424/math-in-wpf-getting-new-x-y-coordinates-after-a-translation/534628#534628)的帮助，它终于按预期工作了。  

这是工作代码：

```
double headingRadians = Heading * (Math.PI / 180);

Animator_Body_X.From = Translate_Body.X;
Animator_Body_X.To = Math.Sin(headingRadians) * pix + Translate_Body.X;
Translate_Body.BeginAnimation(TranslateTransform.XProperty, Animator_Body_X);

Animator_Body_Y.From = Translate_Body.Y;
Animator_Body_Y.To = ((Math.Cos(headingRadians) * pix) * -1) + Translate_Body.Y;
Translate_Body.BeginAnimation(TranslateTransform.YProperty, Animator_Body_Y); 
```

# cocoa-touch - -[NSURLRequest sendSynchronousRequest:returningResponse:error:] 取回 HTTP 标头

> ID：530590
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-09T23:47:06.227
> 
>         
> 
> 标签：cocoa-touch

我正在尝试从 iPhone 上的同步 HTTP 请求中提取 HTTP 标头和 HTTP 响应代码。我通常对异步请求没有任何问题，尽管这里有点麻烦。HTTP 响应标头为空，HTTP 状态代码为 0。Web 服务器配置正确，我可以在异步请求中检索我需要的详细信息。这是我复制到命令行程序的代码：

问题 #1：[httpResponse allHeaderFields] 返回 nil。

问题 #2：[httpResponse statusCode] 返回 0。

如果有错误，我现在看到的错误是：Error Domain=NSURLErrorDomain Code=-1012 UserInfo=0x14b100“操作无法完成。（NSURLErrorDomain 错误-1012。）”，我做无法访问 http 响应标头/状态代码？

```
#import <Foundation/Foundation.h>

int main (int argc, char *argv[])
{    

    NSAutoreleasePool * pool = [[NSAutoreleasePool alloc] init];
    NSString *urlStr = @"http://tmp/myscript.php";
    NSString *postBody = @"foo=bar";   
    NSMutableURLRequest *request;
    NSData *postData = [postBody dataUsingEncoding:NSASCIIStringEncoding];
    NSError *error;
    NSURLResponse *response;
    NSHTTPURLResponse *httpResponse;
    NSData *dataReply;
    id stringReply;

    request = [NSMutableURLRequest requestWithURL: [NSURL URLWithString:urlStr]];

    [request setHTTPMethod: @"POST"];
    [request setHTTPBody:postData];
    [request setValue:@"text/xml" forHTTPHeaderField:@"Accept"];
    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];  

    dataReply = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&error];
    stringReply = (NSString *)[[NSString alloc] initWithData:dataReply encoding:NSUTF8StringEncoding];
    // Some debug code, etc.
    NSLog(@"reply from server: %@", stringReply);
    httpResponse = (NSHTTPURLResponse *)response;
    int statusCode = [httpResponse statusCode];  
    NSLog(@"HTTP Response Headers %@", [httpResponse allHeaderFields]); 
    NSLog(@"HTTP Status code: %d", statusCode);
    // End debug.

    [[NSRunLoop currentRunLoop] run];
    [pool release];
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T02:04:59.627

您得到的错误代码是 NSURLErrorUserCancelledAuthentication 并且记录在[Foundation Constants Reference](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html#//apple_ref/doc/c_ref/NSURLErrorUserCancelledAuthentication)中。您可能正在尝试加载受密码保护的页面，在这种情况下，您可能必须将用户名和密码添加到 URL。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-03-15T09:07:29.523

> 问题 #1：[httpResponse allHeaderFields] 返回 nil。问题 #2：[httpResponse statusCode] 返回 0。

因为 httpResponse 为 nil，请参见[此处](https://stackoverflow.com/questions/3912532/ios-how-can-i-receive-http-401-instead-of-1012-nsurlerrorusercancelledauthentic)。

# .net - .NET 垃圾收集器 - 终端服务

> ID：530593
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-09T23:48:26.210
> 
>         
> 
> 标签：.net, memory-management, garbage-collection

有没有

*   一个垃圾收集器用于整个系统

*   为每个登录的用户创建一个垃圾收集器实例

*   每个正在运行的 .NET 应用程序一个垃圾收集器

还是以上都不是（请解释）？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-09T23:54:55.803

每个 .NET 进程有一个 GC 线程，因此每个进程有一个堆。但是，这些对象被映射到单独的 AppDomain 以提供进程隔离的好处。虽然一个进程中可以有多个 AppDomain，但默认情况下每个进程只有一个。

## 终端服务：

这意味着对于终端服务环境中应用程序（称为 MyApp.exe）的典型部署，用户正在运行的 .NET 应用程序的不同实例将各自具有独立的堆和活动内存管理。更重要的是，终端服务会话本身代表某种内存边界，因为当用户注销时会卸载会话（[http://msdn.microsoft.com/en-us/library/aa383496(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa383496(VS.85).aspx)） .

下面说明了如何为每个终端服务会话加载 MyApp.exe，并解释了一些可能影响会话中内存可用性和性能的设置：http: [//blogs.technet.com/askperf/archive/2007/07/ 24/sessions-desktops-and-windows-stations.aspx](http://blogs.technet.com/askperf/archive/2007/07/24/sessions-desktops-and-windows-stations.aspx)

## 深层细节：

请参阅 Jon Skeet 在此处的回复以获取更多详细信息：[终结器线程的范围是什么 - 每个应用程序域或每个进程？](https://stackoverflow.com/questions/241537/what-is-the-scope-of-finalizer-thread-per-application-domain-or-per-process)

## 深奥的细节：

此外，以下文章解释了 Microsoft 现在如何允许并行 CLR 实例，以便可以同时运行多个版本的 CLR。这特别适用于 Silverlight：http: [//msdn.microsoft.com/en-us/magazine/cc721609.aspx](http://msdn.microsoft.com/en-us/magazine/cc721609.aspx)

此外，似乎所有未来版本的 CLR 都将支持此功能：http: [//blogs.msdn.com/davbr/archive/2008/11/10/new-stuff-in-profiling-api -for-upcoming-clr-4-0.aspx](https://web.archive.org/web/20190114032241/https://blogs.msdn.microsoft.com/davbr/2008/11/10/new-stuff-in-profiling-api-for-upcoming-clr-4-0)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T00:24:34.327

进程中的每个 CLR 实例都有一个垃圾收集器。CLR 的多个实例可能在同一个进程中运行，但这种情况非常罕见。通常，每个进程有一个 CLR。

# javascript - 如何处理引发警告框的错误并使其显示 AJAX 错误消息？

> ID：530596
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-09T23:49:32.040
> 
>         
> 
> 标签：javascript, error-handling

我正在制作的应用程序中使用 Django 和 django-voting。如果未通过身份验证的用户尝试投票，则会显示一个警告框，告知他们未通过身份验证。我怎样才能捕捉到这个错误并使它成为一个更优雅的 AJAX 显示，以便在它发生时我可以在页面上直接显示它？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T08:43:18.390

只需从您的视图中返回 JSON 错误。如何将 django 默认错误标记更改为 json 这是一个有趣的问题。您可以编写自定义方法并将其添加到错误类中。

```
def as_json(errors):
    return dict((k, map(unicode, v)) for k, v in errors.items()) 
```

# jakarta-ee - Java EE 开发环境？

> ID：530597
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-09T23:49:33.290
> 
>         
> 
> 标签：jakarta-ee

我正在启动一个 jJava EEee 项目，我试图看看它是否有益（以及如何）设置一个本地 Java EE 服务器进行测试，就像运行 .net 开发服务器一样。

我在我们的企业开发服务器中有一个开发点，我将在其中进行大部分测试，但我只是好奇是否有一个用于调试或其他此类用途的本地运行副本有什么好处。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-09T23:54:01.610

哦，是的，本地开发环境是可行的。尤其是 eclipse，因为它可以热部署你的代码。  

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-12-26T17:22:45.627

还要检查[http://zeroturnaround.com/jrebel/](http://zeroturnaround.com/jrebel/)它允许在不重新部署的情况下工作。

# python - Python 中的大量集合

> ID：530601
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-09T23:51:19.650
> 
>         
> 
> 标签：python, performance, collections

基本上我在一个列表中存储了数百万个 vector3 值。但是现在vector3s的定义如下：

```
[5,6,7] 
```

我相信这是一个清单。这些值不会被修改，我也不需要任何 vector3 功能。

这是执行此操作的最高效方式吗？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-02-10T00:15:27.377

如果要存储数百万个，最好的方法（速度和内存使用）是使用[numpy](http://numpy.scipy.org/)。

如果您想避免使用 numpy 并仅使用内置的 python 模块，则使用元组而不是列表将为您节省一些开销。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-02-10T00:06:19.443

最好的方法可能是使用元组而不是列表。元组比列表快，并且一旦定义就不能修改。[http://docs.python.org/tutorial/datastructures.html#tuples-and-sequences](http://docs.python.org/tutorial/datastructures.html#tuples-and-sequences)

编辑：更具体地说，元组列表可能效果最好：[(4,3,2), (2,4,5)...]

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T00:07:51.437

传统上，你会分析你的代码，发现瓶颈，并根据需要处理它们。答案是“不，这可能不是*最高效的方式*”，但这真的重要吗？它可能会，当它发生时，它可以被修复。

# git - 分叉 FOSS 项目的 Git 存储库

> ID：530608
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-09T23:55:56.207
> 
>         
> 
> 标签：git, open-source, fork

我开始认真地认为我需要分叉一个开源项目，以满足我自己的需求。我已经向原作者发送了补丁，但回复非常简洁，而且，嗯，不受欢迎。

无论如何。我已经阅读了[Forking an open source project nicely](https://stackoverflow.com/questions/497593/forking-an-open-source-project-nicely)的问题，但这并不能回答我更具体的问题：

我应该如何处理这些文件？

首先，我应该继续使用原始 Git 存储库，还是干脆扔掉所有历史，重新开始（“ `rm -rf .git && git init`”）？其次，对旧自述文件、以前的版本信息和版本控制有什么意见吗？

自然，许可和归属将根据许可的要求进行处理。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-02-10T00:01:02.043

历史是源代码控制中最有价值的部分。我会说保留历史并标记您自己的发展开始的点。

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-02-10T00:09:44.723

我保留历史的原因：

1.  最重要的原因：这允许您从原始代码中导入有用的更改。除非您预测您的项目将彻底偏离原始代码，以至于您永远不希望他们所做的任何事情出现在您的项目中，否则它可以更轻松地跟踪这些有用的更改并导入它们。

2.  如果您愿意的话，它会让回馈变得更容易（比如原始项目的所有者变得更愿意与您合作）。

3.  如果您回头看它时挠头想知道它的含义，它可以更容易地追踪特定更改的起源。在 git 的情况下，它可以帮助您寻找错误，因为`git bisect`- 您可能会发现您认为无害的更改实际上是至关重要的。这种东西很容易找到，`bisect`没有它就很难找到。如果没有历史，你就无法做到这一点。

如果这些都不适用，您可能想重新开始。但即使你这样做了，也要将历史记录保存在私人副本中。如果您需要它，您可以从新存储库中移植您的更改并执行上述所有操作。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-02-10T00:06:38.023

1.  从 Github 分叉它

2.  将其克隆到您的本地计算机

3.  应用您发送给原作者但未被接受的补丁

4.  推

应该很轻松，除非您从头开始重写所有内容，否则这是正确的方法。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T08:06:05.827

即使您从未打算将补丁发送回原作者，`git`也可以制作出色的本地版本控制工具。

关于 github 的另一件很酷的事情，作为之前发布的其他一些工作流程的附录：

1.  创建一个 github 帐户。

2.  fork 你想要的存储库（通过转到他们在 github 上的页面并单击 fork 按钮）

3.  按照说明在`git clone`本地找到您的新仓库

4.  根据需要在本地工作；另外，请务必从 github 上的原始源中提取更新（您可以从*您*在 github 上的项目版本中的 Fork Queue 中执行此操作）

5.  （而不是向原作者发送补丁）通过转到原始项目的 Fork Queue 页面让作者获取您的补丁 - 它使原作者可以轻松获取您的更改。

如果你从项目作者那里得到蹩脚的回应，那么他们并不完全值得你的帮助，我想你不应该太担心回馈。但是，仍然按照关于您的 Fork 队列的步骤 #4 - 您可以与 github 上与您一起对项目进行更改的其他所有人保持最新状态。

一个快速补充：如果你想让你的工作与原作者分开一点，很容易： * 创建一个新分支 ( `git checkout -b my_branch_name`) 并在那里工作。

 * 一旦你的分支处于你想要的状态，你可以切换回原来的分支 ( `git checkout master`) 并将你的更改合并回 ( `git merge my_branch_name`)。

 * 然后你可以将它推回 github ( `git push origin master`)，或者 * 为原作者制作一个补丁（带有一些版本`git format-patch`）。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T04:55:54.583

正如其他人指出的那样：您应该真正保留历史。关于 README 和版本控制：您应该重命名项目以避免与原始项目混淆。您可以使用暗示原始项目的名称（但要注意潜在的商标问题），但尽量不要无礼。例如，如果原始项目名为“foo”，则将您的项目命名为“foo-ng”（下一代）会以某种方式表明您的项目比另一个项目“更好”。即使你觉得是这种情况，也不要那样做。

自述文件应根据您的需要进行更新。即它应该记录新的项目名称，它是项目“foo”的一个分支，并且可能是它的分支点。就我个人而言，我也会保留 ChangeLogs 和类似的、更面向技术的文档，并在必要时附加到它们，但重新开始任何“NEWS”风格的文档，即针对最终用户的文档。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T04:30:42.693

如果您实际上是在分叉（从原始项目停止的地方开始），请务必克隆原始存储库并继续提交。这不仅允许您合并来自原始存储库的更改，还允许原始项目的开发人员从您的 fork 合并更改。如果两个项目都在[Github](http://www.github.com/)上，这种协作会更容易（拉取请求）。

这实际上应该很自然，因为您应该在存储库中进行更改并发送补丁或拉取请求。分叉是相同的，只是它被标记为一个单独的项目。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-02-09T23:58:56.700

如果您打算进行完全重写，请使用新初始化的 git。除此之外，只需克隆。

# c++ - 使用 C++ 输出运算符打印前导零？

> ID：530614
> 
>         
> 
> 赞同：75
> 
>         
> 
> 时间：2009-02-10T00:00:24.543
> 
>         
> 
> 标签：c++, formatting, numbers

如何在 C++ 中格式化我的输出？换句话说，什么是 C++ 相当于使用`printf`这样的：

```
printf("%05d", zipCode); 
```

我知道我可以`printf`在 C++ 中使用，但我更喜欢输出运算符`<<`。

你会使用以下内容吗？

```
std::cout << "ZIP code: " << sprintf("%05d", zipCode) << std::endl; 
```

* * *

## 回答 #1

> 赞同：107
> 
>             
> 
> 时间：2009-02-10T00:02:59.857

这可以解决问题，至少对于非负数^(（a）) ，例如您的问题中提到的邮政编码^(（b） 。)

```
#include <iostream>
#include <iomanip>

using namespace std;
cout << setw(5) << setfill('0') << zipCode << endl;

// or use this if you don't like 'using namespace std;'
std::cout << std::setw(5) << std::setfill('0') << zipCode << std::endl; 
```

控制填充的最常见的 IO 操纵器是：

*   `std::setw(width)`设置字段的宽度。

*   `std::setfill(fillchar)`设置填充字符。

*   `std::setiosflags(align)`设置对齐方式，其中 align 是 ios::left 或 ios::right。

只是根据您对 using 的偏好`<<`，我强烈建议您查看该`fmt`库（请参阅[https://github.com/fmtlib/fmt](https://github.com/fmtlib/fmt)）。这是对我们用于格式化内容的工具包的一个很好的补充，并且比大量长度的流管道要好得多，允许您执行以下操作：

```
cout << fmt::format("{:05d}", zipCode); 
```

LEWG 目前也将其定位为 C++20，这意味着它有望在那时成为该语言的基础部分（或者如果它不完全潜入的话，几乎可以肯定在以后）。

* * *

^((a))如果*确实*需要处理负数，可以使用`std::internal`如下：

```
cout << internal << setw(5) << setfill('0') << zipCode << endl; 
```

这会将填充字符*置于*符号和大小之间。

* * *

^(（b）)这（“所有邮政编码都是非负数”）是我的一个假设，但一个相当安全的假设，我保证:-)

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2009-02-10T00:02:50.107

使用[setw 和 setfill](http://www.fredosaurus.com/notes-cpp/io/omanipulators.html)调用：

```
std::cout << std::setw(5) << std::setfill('0') << zipCode << std::endl; 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2020-06-25T16:17:15.787

在 C++20 中，您将能够：

```
std::cout << std::format("{:05}", zipCode); 
```

同时你可以使用[基于的 {fmt}](https://github.com/fmtlib/fmt)库`std::format`。

**免责声明**：我是 {fmt} 和 C++20 的作者`std::format`。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T00:03:27.000

```
cout << setw(4) << setfill('0') << n << endl; 
```

从：

[http://www.fredosaurus.com/notes-cpp/io/omanipulators.html](http://www.fredosaurus.com/notes-cpp/io/omanipulators.html)

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2013-08-13T11:42:29.837

或者，

```
char t[32];
sprintf_s(t, "%05d", 1); 
```

将输出 00001 作为 OP 已经想做的

# javascript - 根据所选项目填充选择下拉列表

> ID：530626
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-10T00:07:04.620
> 
>         
> 
> 标签：javascript, ruby-on-rails, html-select

我正在开发一个 Rails 应用程序。

我有一个国家的下拉菜单。选择一个国家将用该国家的城市填充城市下拉列表。

我知道如何在服务器端执行此操作，但如果可能的话，我想在客户端执行此操作。我使用了 RJS 助手，但我没有使用 jQuery（甚至不确定它是什么）或其他选择器 javascript 库的*经验。*

澄清：我想**完全**在客户端做这件事。也就是说，发送初始页面请求中的所有值。我不希望以ajax方式调用服务器，访问数据库，然后返回这些结果。我希望他们加载页面。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T00:30:19.900

也许这会有所帮助（一个简单的谷歌搜索就可以了）：

[http://remysharp.com/2007/01/20/auto-populating-select-boxes-using-jquery-ajax/](http://remysharp.com/2007/01/20/auto-populating-select-boxes-using-jquery-ajax/)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-18T21:22:27.883

我结合使用 jQuery 和[jQuery 计算插件](http://www.pengoworks.com/workshop/jquery/calculation/calculation.plugin.htm)来实现这个功能。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T00:30:47.793

我建议您为此使用 jQuery。但是您需要查看 jquery 的文档，然后查看 jQuery [ajax api](http://docs.jquery.com/Ajax)

* * *

## 回答 #4

> 赞同：-2
> 
>             
> 
> 时间：2009-02-10T00:13:05.293

使用 javascript 创建一长串元素很可能在客户端上表现更差。你为什么更喜欢它？

# php - 获取带有绑定参数的 PDO 查询字符串而不执行它

> ID：530627
> 
>         
> 
> 赞同：33
> 
>         
> 
> 时间：2009-02-10T00:07:44.417
> 
>         
> 
> 标签：php, sql, pdo

是否可以从具有绑定参数的 PDO 对象中获取查询字符串而不先执行它？我有类似于以下的代码（其中 $dbc 是 PDO 对象）：

```
$query = 'SELECT * FROM users WHERE username = ?';
$result = $dbc->prepare($query);
$username = 'bob';
$result->bindParam(1, $username);
echo $result->queryString; 
```

目前，这将回显一条 SQL 语句，如：“SELECT * FROM users WHERE username = ?”。但是，我希望包含绑定参数，使其看起来像：'SELECT * FROM users WHERE username ='bob'"。有没有办法在不执行它或通过某些东西用参数替换问号的情况下做到这一点像 preg_replace？

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2009-02-10T00:50:19.540

简而言之：没有。请参阅[从 PDO 准备好的语句中获取原始 SQL 查询字符串](https://stackoverflow.com/questions/210564/pdo-prepared-statements/210693#210693)

如果您只想模拟它，请尝试：

```
echo preg_replace('?', $username, $result->queryString); 
```

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2014-01-29T12:27:28.060

[这是正则表达式技术](https://stackoverflow.com/questions/210564/getting-raw-sql-query-string-from-pdo-prepared-statements/210693#210693)的通用变体，用于参数编号数组。

这比公认的答案更偏执，因为引用*所有内容*，包括数字在内，不止一次在背后咬我；在 MySQL 以及其他¹中，“123”*小于*“13”。也一样`'NULL'`，这*不是`NULL`*，而且`'false'`，这显然是*正确的*。

现在有人向我指出，我还不够偏执**:-)**，而且我的`?`替换技术 ( `"#\\?#"`) 很*幼稚*，因为无论出于何种原因，源查询都可能在正文中包含问号作为文本：

```
$query = "SELECT CONCAT('Is ', @value, ' ', ?, '? ', 
       IF(@check != ? AND 123 > '13', 'Yes!', 'Uh, no?')) 
       ;

$values = array('correct', false, 123);

// Expecting valid SQL, selecting 'correct' if check is not false for 123
// and answering Yes if @check is true. 
```

输出：

```
SELECT CONCAT('Is ', @value, ' ', 'correct', '? ',
   IF(check != false AND 123 > '13', 'Yes!', 'Uh, no?')) 
   ;

Is THIS_TEST correct? Yes! 
```

我更简单的实现会抛出一个异常，看到太多问号。一个更简单的实现会返回类似

```
Is THIS_TEST correcttrue Uh, no 
```

所以这是修改后的功能。**注意**：我知道有些[事情正则表达式不应该做](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)。我并不声称此功能适用于所有情况和所有边界情况。我声称这是一个*合理的尝试*。随意评论或通过电子邮件发送非工作测试用例。

```
function boundQuery($db, $query, $values) {
    $ret = preg_replace_callback(
        "#(\\?)(?=(?:[^']|['][^']*')*$)#ms",
        // Notice the &$values - here, we want to modify it.
        function($match) use ($db, &$values) {
            if (empty($values)) {
                throw new PDOException('not enough values for query');
            }
            $value  = array_shift($values);

            // Handle special cases: do not quote numbers, booleans, or NULL.
            if (is_null($value)) return 'NULL';
            if (true === $value) return 'true';
            if (false === $value) return 'false';
            if (is_numeric($value)) return $value;

            // Handle default case with $db charset
            return $db->quote($value);
        },
        $query
    );
    if (!empty($values)) {
        throw new PDOException('not enough placeholders for values');
    }
    return $ret;
} 
```

也可以[扩展 PDOStatement](https://stackoverflow.com/questions/3431305/extending-pdo-statement-class)以提供一种`$stmt->boundString($values)`方法。

* * *

(1) 因为这是 PHP，你有没有试过`$a = 1...1; print $a;`？

# excel - 如何解决 Excel 禁用加载项的原因？

> ID：530631
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-10T00:08:31.370
> 
>         
> 
> 标签：excel, excel-addins

我使用[Add-in Express在 .NET 中编写了一个 Microsoft Excel 加载项](http://www.add-in-express.com)，并将其部署到大约 50 个不同的用户站点，所有站点都在 Windows XP 上运行 Office 2003。该加载项在大多数站点上都可以正常工作，但在少数情况下，Excel 似乎会在一段时间后禁用该加载项，他们必须在禁用的项目列表中找到它才能重新启用。重新启用似乎可以解决它，至少是暂时的，尽管现在说它是否会再次发生还为时过早。所以我想弄清楚为什么 Excel 会禁用加载项，但我在这里寻找的只是找出 Excel 禁用加载项的原因的一般方法。在我的情况下，加载项在远程站点上运行，我只能有限地进行故障排除。我确实查看了事件日志并没有发现任何东西。我的加载项中也有错误日志记录，但没有发现任何问题。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-03-05T01:23:57.093

我很确定 Excel 不会自动禁用你的插件（我没有找到任何描述这种行为的东西，如果我错过了，请纠正我）。但是，如果插件崩溃/挂起等，那么下次 Excel 启动时，会弹出一个对话框，提示“此插件出现致命错误，您要禁用它吗？” （正如克里斯指出的那样）。

我发现用户总是会单击“是”，这样他们就可以继续工作了。可能值得与您的用户交谈，看看他们是否见过这样的事情。

显然，您想深入了解插件的潜在问题。我想您的下一步可能是（如果这些是您尝试过的明显调试步骤，我深表歉意）：

*   一定要添加一些配置来加快您的日志记录，以尝试缩小正在发生的事情。

*   与用户交谈并找出导致 Excel 挂起/崩溃的情况，因此您可以尝试重现问题（如果这是崩溃，那么日志记录可能没有多大帮助）。

*   在您的插件或您正在调用的代码中阻止可能导致用户杀死无响应的 Excel 的调用？

祝你好运追踪问题。

**编辑**：我很抱歉，在某些情况下 Excel 会自动禁用插件。我在插件的安全中心帮助中找到了以下内容：

> **禁用未签名加载项的通知（代码将保持禁用状态）**仅当您选中要求受信任的发布者签名的应用程序扩展复选框时，此复选框才可用。在某些情况下，包含加载项的动态链接库 (.dll)（动态链接库：可以从 Visual Basic 过程调用并在运行时加载并链接到应用程序的一组例程。）可能未签名。在这些情况下，由受信任的发布者签名的加载项被启用，但未签名的加载项被静默禁用。
> 
> **禁用所有应用程序加载项（可能会影响功能）**如果您不信任任何加载项，请选中此复选框。所有加载项都被禁用，没有任何通知，并且其他加载项复选框不可用。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T00:12:12.173

我已经看到当加载项出现致命错误并且进程终止时会发生这种情况。Excel 会注意到这一点，并在下次自动禁用或提供禁用。您的加载项是否记录此类错误？

# .net - 查看 VSTS 中多个变更集中更改的所有文件

> ID：530633
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-10T00:09:30.980
> 
>         
> 
> 标签：.net, visual-studio, tfs, visual-studio-2005

有谁知道如何获取 Visual Studio Team System 2005 中多个变更集中更改的所有文件的列表？我基本上希望看到从开发工作开始到结束更改的所有文件的列表。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-06-06T23:14:19.887

安装电动工具后：

```
# get-tfschangeset doesn't support arrays, so you have to loop
100, 200, 300 | % { get-tfschangeset $_ } | select-tfsitem | select -unique path | sort

# powershell also has a range operator...
100..105 | % { get-tfschangeset $_ } | select-tfsitem 
```

* * *

## 回答 #2

> 赞同：-1
> 
>             
> 
> 时间：2009-05-11T21:48:12.943

您可以从命令行使用 TF.exe 非常轻松地获取大量信息。

即使无法在一次调用中直接提取您想要的信息，编写一个调用 TF.exe 的小程序来获取您感兴趣的变更集的列表，然后为每个调用再次调用它也很容易用于检索文件列表的变更集。

启动 Visual Studio 命令提示符（从您的开始菜单）并输入`tf.exe /?`以访问文档。

# ruby-on-rails - 完成 Rails 创建操作的正确方法是什么？

> ID：530641
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-10T00:15:57.360
> 
>         
> 
> 标签：ruby-on-rails, ruby, conventions

我有一个`User.create`临时注册新用户并使用生成的密码发送电子邮件的操作。完成该动作的最类似于 Rails 的方式是什么？从现在开始，我想把所有事情都做好。废话不多说。这次我是认真的。

我在想这些是选项...

1.  创建一个名为`login_email_sent.html.haml`并渲染它的视图。（它会有一条消息，例如“谢谢，您的登录信息已发送一封电子邮件。”）

2.  创建一个名为的视图`create.html.haml`并让 Rails 默认渲染它。

3.  将用户重定向到与他们刚刚提交的表单相同的页面，并在 Flash 中显示消息。

或者是其他东西...？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-10T00:25:28.880

这更像是一个用户体验问题。

将 create 操作保留为仅创建且没有输出的内容（或者，`201 Created`如果由 API 调用创建，则只是一个简单的标头）。执行以下`redirect_to`任一操作：

1.  感谢页面告诉他们如何等待以及接下来会发生什么

2.  主页上有一条非常明显的 Flash 消息，让他们知道刚刚发生了什么。

在 99.9% 的情况下，您永远不需要创建模板。

```
def create
  User.create(...)
  respond_to do |format|
    format.html { redirect_to signup_complete_url }
    format.xml  { render :head => :created }
  end
end 
```

例如。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T00:20:58.657

绝对是选项 3，重定向到 show 动作。当您这样做时，用户将在操作完成时被重定向，因此不会意外地通过返回历史记录重新发布。此外，这确保了渲染的页面可以添加书签/保存。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T02:31:39.593

将他们重定向到登录页面，并通过一条消息告诉他们检查他们的电子邮件以获取有关验证和登录其帐户的进一步说明。许多人建议在用户验证时自动登录用户，但在我看来，这对于任何敏感站点来说都是一个安全问题。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T10:47:28.193

这取决于他们是否可以在您的网站上进行有用的操作而无需注册。如果有然后将他们重定向到主页并使用闪光灯显示一条消息，说明已发送电子邮件并邀请他们在此期间环顾四周。

如果他们无能为力，那么您可以将他们重定向到带有信息/常见问题解答的欢迎页面，以帮助他们抢占先机，让他们觉得他们已经注册了一些有价值的东西。

另外，不要在电子邮件中向他们发送密码，而是考虑向他们发送指向用户帐户设置页面的链接，他们可以在其中设置密码和其他详细信息。该链接将包含与新用户帐户关联的后门访问代码。提交并验证此页面后，可以删除后门代码。

同样的方法可以用于忘记密码，一旦用户设置了新密码，或者如果他们记住了密码并正常登录，后门密码就会被删除。

这种方法的唯一问题是它们最终可能会在您的网站上打开两个浏览器窗口或选项卡。但它确实让您有机会询问您可能需要的任何其他信息——地址、出生日期或其他任何信息——而不会因为在初始注册表单上提出太多问题而吓跑人们。

# python - 使用 os.walk 时，有没有办法确定子目录是否与 python 位于同一文件系统中？

> ID：530645
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-10T00:18:50.660
> 
>         
> 
> 标签：python, unix

我正在编写一个使用 os.walk() 遍历目录树的 python 脚本。我想让它能够跳过挂载到不同文件系统的子目录，就像`find -xdev`这样。检查 os.walk() 上的文档，我没有看到任何参数可以传递给它以自动执行此操作。有什么我可以用来自己过滤的东西吗？希望能在 Linux 和 Mac OS X 上运行的东西？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-02-10T00:48:16.690

[os.path.ismount()](http://docs.python.org/library/os.path.html#os.path.ismount)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T00:45:17.227

我认为您可以结合使用`os.stat`调用和过滤所提供的目录名`os.walk`来执行您想要的操作。像这样的东西：

```
import os
for root, dirs, files in os.walk(somerootdir) :
    do_processing(root, dirs, files)
    dirs = [i for i in dirs if os.stat(os.path.join(root, i)).st_dev == os.stat(root).st_dev] 
```

这应该通过删除那些没有相同设备的目录来修改要递归到的目录列表。

我不知道它将如何在 OS X 上运行，但经过一点点测试后，它似乎可以在 Linux 中运行。

# php - 是否可以替换（monkeypatch）PHP 函数？

> ID：530649
> 
>         
> 
> 赞同：20
> 
>         
> 
> 时间：2009-02-10T00:24:18.667
> 
>         
> 
> 标签：php, function, monkeypatching

您可以在 Python 中执行此操作，但在 PHP 中可以吗？

```
>>> def a(): print 1
... 
>>> def a(): print 2
... 
>>> a()
2 
```

例如：

```
<? function var_dump() {} ?>
Fatal error: Cannot redeclare var_dump() in /tmp/- on line 1 
```

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2013-08-08T07:23:23.043

这*有点*晚了，但我只想指出，从 PHP 5.3 开始，实际上可以在不使用 PHP 扩展的情况下覆盖内部函数。

诀窍是您可以在命名空间内重新定义内部 PHP 函数。它基于 PHP 对函数进行名称解析的方式：

在命名空间内（比如 A\B），对不合格函数的调用在运行时被解析。以下是对函数 foo() 的调用是如何解决的：

1.  它从当前命名空间中寻找一个函数：A\B\foo()。

2.  它试图找到并调用全局函数 foo()

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-02-10T00:25:18.693

不，不可能像您预期的那样执行此操作。

来自[`manual`](http://php.net/manual/en/functions.user-defined.php)：

> PHP 不支持函数重载，也不可能取消定义或重新定义先前声明的函数。

但是，您可以使用[`runkit_function_redefine`](http://php.net/manual/en/function.runkit-function-redefine.php)和它的表亲，但它绝对不是很优雅......

您还可以使用[`create_function`](http://php.net/manual/en/function.create-function.php)执行以下操作：

```
<?php
$func = create_function('$a,$b','return $a + $b;');
echo $func(3,5); // 8
$func = create_function('$a,$b','return $a * $b;');
echo $func(3,5); // 15
?> 
```

与 runkit 一样，它不是很优雅，但它提供了您正在寻找的行为。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2010-11-02T14:45:37.853

我意识到这个问题有点老了，但是[Patchwork](http://github.com/antecedent/patchwork "拼凑而成")是一个最近发布的 PHP 5.3 项目，它支持重新定义用户定义的函数。但是，正如作者所提到的，您将需要使用[runkit](http://php.net/manual/en/book.runkit.php "运行套件")或[php-test-helpers](http://github.com/sebastianbergmann/php-test-helpers "php-测试助手")来使用猴子补丁核心/库功能。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T00:25:49.177

有点儿。请参阅[http://dev.kafol.net/2008/09/php-redefining-deleting-adding.html](http://dev.kafol.net/2008/09/php-redefining-deleting-adding.html)。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2012-04-27T09:46:57.710

正如 jmikola 提到的，如果您想向函数添加代码，Patchwork 是一个很好的解决方案。

这是一篇关于它如何工作的文章：http:
 [//phpmyweb.net/2012/04/26/write-an-awesome-plugin-system-in-php/](http://phpmyweb.net/2012/04/26/write-an-awesome-plugin-system-in-php/)

它带有一些示例代码。我认为phpmyweb版本使用了稍微好一点的代码，因为他不使用eval()的代码，不像patchwork。使用 eval() 时可以缓存操作码。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2016-11-17T20:35:46.647

接受的答案非常好！我将补充一点，您可以将代码放在[命名空间括号](https://stackoverflow.com/questions/1256227/resetting-a-namespace-in-php)中，然后重置默认的 GLOBAL-SPACE。

# 其他一些方法：

1) [rename_function($old_name,$new_name)](http://php.net/manual/en/function.rename-function.php)

2) [override_function($old_name, $parameters, $new_func)](http://php.net/manual/en/function.override-function.php)

*很少使用：*

3) [runkit_function_rename(...)](http://php.net/runkit_function_rename)

4) [runkit_function_redefine(...)](http://php.net/runkit_function_redefine)

# linux - 无法分离屏幕会话

> ID：530657
> 
>         
> 
> 赞同：23
> 
>         
> 
> 时间：2009-02-10T00:29:43.443
> 
>         
> 
> 标签：linux, gnu-screen

我对屏幕很陌生，我打的是 C-Something 而不是 Ca。现在我无法分离或执行任何其他命令。我可以做些什么来分离我的屏幕会话？

* * *

## 回答 #1

> 赞同：52
> 
>             
> 
> 时间：2009-02-10T00:34:46.690

如果一切都失败了，请从另一个终端登录并输入：`screen -raAdx`。这会将您的屏幕重新连接为共享并允许您将其分离。

* * *

## 回答 #2

> 赞同：21
> 
>             
> 
> 时间：2009-02-10T00:32:32.327

可能你有`C-s`（“停止”）尝试`C-q`恢复......

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2009-02-10T03:04:56.797

ctrl-a+d 分离

如果您不需要屏幕上的信息，则可以替代分离，您可以简单地终止该进程。

不确定任何使屏幕无响应的命令。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2011-05-20T18:58:33.260

我今天遇到了类似的问题。我正在通过一个 1MBps 的链接传输一个 100GB 的文件，当我的工作站崩溃时，它已经传输到一半了。我将 PuTTY 备份并进入我的终端服务器，但分离/重新连接命令的组合不起作用。我决定我会杀死屏幕，所以我检查了 ps 以获取 PID。当我查看 PS 输出时，我注意到我用来启动 Screen 的 BASH 会话仍在运行。一时兴起，我决定终止该会话而不是屏幕，认为“这应该就像关闭 PuTTY 窗口一样，它允许我重新附加。” 果然，我能够成功运行“screen -dr”。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-11T18:06:57.987

您也可以只注销，通过终止终端会话，然后再次登录并重新连接`screen`会话。

# javascript - 在发布请求中保留用户生成的 HTML 的最佳方法是什么？

> ID：530660
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-10T00:30:52.987
> 
>         
> 
> 标签：javascript, jquery, html, user-input

我正在构建一个站点，该站点是一个用于创建 XML 文件的接口，这些 XML 文件被服务器端程序读取为输入。

该网站允许用户动态创建 HTML 块。每个块可以被认为是一个对象并包含几个输入字段。当用户提交表单时，数据将转换为 XML 文件。  

在发布请求中保留/重建用户生成的 HTML 的最佳方法是什么？我正在使用 JQuery，但不是 AJAX。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T00:48:19.310

您可能正在寻找 XML 的[CDATA](http://www.w3schools.com/XML/xml_cdata.asp)。

```
<post>
<![CDATA[

<p>Hello, world!
<span style="color: green;">Green text</span>
<!-- oops, didn't close the p! -->

<ul>
    <li>list
    <li>doesn't
    <li>have closing
    <li>&lt;/li> (note the lack of use of &gt;)
</ul>

]]>
</post> 
```

只要确保`]]>`在用户的输入中转义，否则他们可能会利用您对 XML 的使用`CDATA`并破坏您的 XML！

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T01:01:18.937

司徒怎么[说](https://stackoverflow.com/questions/530660/best-way-to-preserve-user-generated-html-across-a-post-request/530703#530703)。另外，使用 Javascript，您可以获取任何元素的 HTML 字符串：

```
document.getElementById('myimportantthing').innerHTML 
```

并将其发送到您的服务器以包含在您的 CDATA XML 元素中，您应该会很好。

尽管出于某种目的捕获 HTML 以发送到 API 的整个想法只是散发出代码气味，但在不知道您在做什么的情况下，我对此无话可说。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T00:35:52.257

如果要*保留*HTML，为什么要将 HTML 处理为 XML？

只需将 HTML 保留在服务器上，然后在发出 ajax 请求时，您就可以获得整个 HTML 树并将其粘贴到 DOM 中（无需重新构建）。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T00:42:24.503

我想指出现代 XHTML 旨在成为 XML 的一个子集。我认为卢卡是对的。

# javascript - In Dojo or Javascript how do I make my event handler fire before other event handlers?

> ID：530662
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-10T00:31:30.630
> 
>         
> 
> 标签：javascript, events, event-handling, dojo

In the Dojo Javascript library, I understand how to use dojo.connect or dojo.publish to wire up my event handler to an event. That functionality works great. 

But I want to do one additional thing. 

I want my event handler to fire first, before any other already defined event handlers. I suppose this could be called "event handler insertion" or something. 

Is there a way to do that in Dojo or a convenient and elegant way in plain Javascript? 

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T19:32:37.790

尝试像这样修改您的事件：

```
function alertTest(){
    alert('test');
}

function alertTest2(){
    alert('test2');
}

window.onload = alertTest2; //just setting it to simulate that an event
                            //is already set

oldOnload = window.onload; //store the old event into a temporary variable
window.onload = function() { //assign a new function to the event
    alertTest(); //whatever your "must happen first" function is
    oldOnload.apply(); //run the original event after
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T18:31:12.850

当事件被触发时，它们会连接到它们的*操作*（onload、onclick）。那么在触发其他操作之前如何触发事件呢？

例如，`onclick`如果您不知道何时触发事件，您将如何在事件之前触发它？

这绝对是您*不能*做的事情，也许您想将处理程序注册到`onload`通常在所有其他事件之前触发的事件。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T19:05:04.003

我有一个（可能）相关的问题，最后使用 setTimeout 来设置一个标志。

[javascript blur 事件——有没有办法检测现在哪个元素有焦点？](https://stackoverflow.com/questions/528208/javascript-blur-event-is-there-any-way-to-detect-which-element-now-has-focus)
丑陋，但它的工作原理。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-11T08:22:50.887

据我所知，一旦事件处理程序附加到 DOM 节点，处理程序的执行顺序取决于实现。

# google-search-appliance - Google Mini：访问缓存的抓取文件内容？

> ID：530668
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-10T00:33:14.370
> 
>         
> 
> 标签：google-search-appliance

现在，我有一个 Google Mini 正在抓取一个目录，其中包含一堆各种格式的文档。有没有办法访问此目录中特定文档的缓存内容（如果它已被抓取/缓存）？

我正在寻找文件的纯文本，而不是抓取的文件本身。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T14:40:01.270

我认为在管理界面中，在 Status and Reports > Crawl diagnostics 下，您应该能够深入到文档的 URL。如果有可用的缓存版本，“有关此页面的更多信息”下将有一个链接。

# javascript - jQuery 和 ActiveX 安全存在严重问题？

> ID：530670
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-02-10T00:35:14.413
> 
>         
> 
> 标签：javascript, jquery, internet-explorer, activex

有没有人注意到 JQuery 使用 ActiveX 控件？

当用户限制了他们的 activex 安全性时，他们将获得脚本提示弹出窗口和一个横跨其浏览器窗口顶部的黄色条。- 默认情况下，此设置在 Windows 服务器上。-网吧不支持Active X。 -公司内部工作站不支持。

考虑到这一点，我看不出人们如何在商业应用程序中使用 JQuery。

您在商业应用程序中使用 JQuery 吗？这与您有关吗？你觉得我应该关心这个吗？

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-02-10T00:40:56.567

`ActiveX`jQuery 代码中唯一提到的地方是`ActiveXObject`用于 XMLHttpRequests 的：     

```
// Create the request object; Microsoft failed to properly
// implement the XMLHttpRequest in IE7, so we use the ActiveXObject when it is available
var xhr = window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest(); 
```

这里有一个未解决的[问题](http://dev.jquery.com/ticket/3623)......似乎 jQuery 不会回退到在 IE7 上使用本机 XMLHttpRequest（这可能是您正在经历的）。

这也可能有帮助：[链接](http://www.mail-archive.com/discuss@jquery.com/msg06791.html)

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-02-10T00:41:07.067

jQuery 与大多数提供 AJAX 支持的库一样，在 IE 中运行时将使用 ActiveX 创建 XMLHttpRequest 对象。`XMLHttpRequest`因为这就是你在 IE 中获取对象的方式。如果禁用它，则不会获得 AJAX。

所以不，不用担心。如果您不使用 AJAX，那么在禁用 ActiveX 的系统上就不会出现问题；如果这样做，那么*无论*库如何，您都会遇到问题，除非您使用解决方法，例如使用 iframe 提交后台请求。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T00:43:04.097

除了 jQuery 可能必须使用 ActiveX（即 AJAX）的原因之外*，*您还应该考虑到并非所有 jQuery 的使用都用于 AJAX 功能。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-15T20:08:39.640

与 IE 中的 AJAX 功能无关，jQuery 1.3.2 中存在一个问题，导致在最初加载 jQuery 时显示该横幅，即使您没有对其进行任何操作。请参阅[勾选 #4017](http://dev.jquery.com/ticket/4017)。该问题已在[变更集 #6268](http://dev.jquery.com/changeset/6268)中得到解决，并将在 jQuery 1.3.3 发布时得到解决。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2011-07-12T17:35:20.020

不确定这是否适用于您的案例/问题，但我注意到几乎默认情况下，jQuery 版本冲突会导致此问题，并且如果您正在管理一个由多个组件（即门户、CMS 等）组成的大型站点。 ) 你可能无意中同时使用了多个 jQuery 版本。在我的情况下，这总是导致 IE 7 中的 ActiveX 安全弹出窗口。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2012-02-23T00:59:07.043

我在做 ajax 请求的商店遇到了同样的问题，所以我更改了我的 jquery 文件以强制在 ie 9 上加载 XMLHttpRequest

搜索：

```
var l = window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest(); 
```

将其替换为：

```
var isIE9 = navigator.userAgent.match(/MSIE 9.0/i) != null;
if(isIE9)
   var l = new XMLHttpRequest();               
else
   var l = window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest(); 
```

# graph-theory - 每个节点都连接到每个其他节点的图如何表示？

> ID：530674
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-10T00:36:55.780
> 
>         
> 
> 标签：graph-theory, terminology, discrete-mathematics

每个节点都连接到每个其他节点（没有冗余连接）的图是如何调用的？

我知道这张图有 N * (N - 1) / 2 条边。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-02-10T00:38:39.943

[完整图](http://en.wikipedia.org/wiki/Complete_graph)

# sql - SQL - 只选择不重复的行

> ID：530681
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-10T00:39:55.837
> 
>         
> 
> 标签：sql, duplicates

我需要将数据从一个表传输到另一个表。第二个表有一个主键约束（第一个没有约束）。它们具有相同的结构。我想要的是从表 A 中选择所有行并将其插入表 B 中而没有重复的行（如果一行是重复的，我只想取我找到的第一个）

例子 ：

```
MyField1 (PK)   |   MyField2 (PK)   |   MyField3(PK)   |   MyField4   |   MyField5  

----------

1               |   'Test'          |   'A1'           |   'Data1'    |   'Data1'  
2               |   'Test1'         |   'A2'           |   'Data2'    |   'Data2'  
2               |   'Test1'         |   'A2'           |   'Data3'    |   'Data3'  
4               |   'Test2'         |   'A3'           |   'Data4'    |   'Data4' 
```

如您所见，第二行和第三行获得了相同的 pk 密钥，但 MyField4 和 MyField5 中的数据不同。所以，在这个例子中，我想要第一行、第二行和第四行。不是第三个，因为它是第二个的重复（即使 MyField4 和 MyField5 包含不同的数据）。

我怎样才能通过一次选择来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T01:22:15.937

首先，您需要定义是什么让一行成为“第一”。我将组成一个任意定义，您可以根据需要更改 SQL。对于此示例，我假设“first”是 MyField4 的最低值，如果它们相等，则 MyField5 的最低值。它还解释了所有 5 列相同的可能性。

```
SELECT DISTINCT
     T1.MyField1,
     T1.MyField2,
     T1.MyField3,
     T1.MyField4,
     T1.MyField5
FROM
     MyTable T1
LEFT OUTER JOIN MyTable T2 ON
     T2.MyField1 = T1.MyField1 AND
     T2.MyField2 = T1.MyField2 AND
     T2.MyField3 = T1.MyField3 AND
     (
          T2.MyField4 > T1.MyField4 OR
          (
               T2.MyField4 = T1.MyField4 AND
               T2.MyField5 > T1.MyField5
          )
     )
WHERE
     T2.MyField1 IS NULL 
```

如果您还想考虑源表中未重复但目标表中已存在的 PK，那么您也需要考虑这一点。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T00:52:35.523

不确定您如何知道新表中需要第 2 行和第 3 行中的哪一个，但在 mysql 中您可以简单地：

```
insert ignore into new_table (select * from old_table); 
```

并且 PK 不允许插入重复的条目。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T00:46:11.500

你的数据库是什么？在甲骨文你可以说

```
SELECT FROM your_table
WHERE rowid in
(SELECT MIN(rowid)
 FROM your_table
 GROUP BY MyField1, MyField2, MyField3); 
```

请注意，具有相同 PK 的哪些行将被视为“第一行”是有些不确定的。如果需要强制执行特定顺序，则需要另外对其他列进行排序。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2012-01-11T22:12:21.533

这取决于你在寻找什么。

`JOIN`使用+ `WHERE NULL`、`NOT IN`和之间有很大的不同`NOT EXISTS`，包括性能，这对于更大的数据集更为重要。

（参见[NOT IN vs. NOT EXISTS vs. LEFT JOIN / IS NULL](http://explainextended.com/2009/09/15/not-in-vs-not-exists-vs-left-join-is-null-sql-server/)。）

链接文章中显示的三种方法非常简单。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T09:04:37.760

```
CREATE TABLE #A(
ID INTEGER IDENTITY,
[MyField1] [int] NULL,
[MyField2] [varchar](10) NULL,
[MyField3] [varchar](10) NULL,
[MyField4] [varchar](10) NULL,
[MyField5] [varchar](10) NULL
) 

INSERT INTO #A (MyField1,MyField2,MyField3,MyField4,MyField5) SELECT * FROM A

insert into B 
   select MyField1,MyField2,MyField3,MyField4,MyField5 from #A a1 
    where not exists (select id from #A a2 where a2.MyField1 = a1.MyField1 and a2.ID < a1.ID)

DROP TABLE #A 
```

或者

```
insert into b
  select distinct * from a a1 
    where not exists (
  select a2.MyField1 from a a2 where a1.MyField1 = a2.MyField1 and 
       (a1.MyField2 < a2.MyField2 or a1.MyField3 < a2.MyField3 
        or a1.MyField4 < a2.MyField5 or a1.MyField5 < a2.MyField5)) 
```

# python - copy & paste isolation with win32com & python

> ID：530682
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-10T00:39:56.287
> 
>         
> 
> 标签：python, excel

Is there a way of using python and win32com to copy and paste such that python scripts can run in the background and not mess up the "users" copy and paste ability?

```
from win32com.client import Dispatch
import win32com.client

xlApp = Dispatch("Excel.Application")
xlWb = xlApp.Workbooks.Open(filename_xls)
ws = xlWb.Worksheets(1)
xlApp.Visible=False

ws.Range('a1:k%s' % row).select
ws.Range('a1:k%s' % row).cut
ws.Range('a7').select
ws.paste 
```

assume that the script will be running continuously on a large collection of datasets...

Ok, some more clarity to the question, I need the formating, all of it, so just grabbing t values is of course simple, but not exactly what is needed.

So then let me phrase the question as:
What is there a why to grab both the value and its excel formating in python without the select, copy, and paste routine?

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2012-09-04T11:57:41.083

代替：

```
ws.Range('a1:k%s' % row).select
ws.Range('a1:k%s' % row).cut
ws.Range('a7').select
ws.paste 
```

我做了：

```
ws.Range("A1:K5").Copy(ws.Range("A7:K11")) 
```

根据[MSDN：Excel 对象模型参考](http://msdn.microsoft.com/en-us/library/bb178833%28v=office.12%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T03:51:05.767

只需将数据读入python，然后再写回来。

代替：

```
ws.Range('a1:k%s' % row).select
ws.Range('a1:k%s' % row).cut
ws.Range('a7').select
ws.paste 
```

逐个单元处理数据：

```
for r in range(1, row+1):    # I think Excel COM indexes from 1
    for c in range (1, 12):  # a--k
        val = ws.Cells(r, c).Value
        ws.Cells(r, c).Value = ''    # Blank this cell; equivalent to cut
        ws.Cells(?, ?).Value = val   # Write it somewhere .. 
```

我不确定将二维选择粘贴到单个单元格中的作用，所以我不能为你做最后一行。你可能会发现你需要做两个循环；一个读取数据，然后第二个将其写回。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2013-05-06T09:47:53.597

有点晚了，但我想我有你的解决方案，因为我找不到它，无论如何它都会帮助别人。这段代码将在不使用选择的情况下复制所有内容（值、公式、格式等）（因此不会干扰您的用户，这比使用选择要快）

首先我像这样打开excel：

```
xl = client.Dispatch("Excel.Application")
wb = xl.Workbooks.Open("c:/somepath/file.xls")
xl.Visible = 1 
```

要在保存格式、公式等的同时复制和粘贴到同一个工作表上：

```
ws = wb.Sheets("someSheet") #you can put the sheet number instead of it's name
ws.Range('a1:k%s' % row).Copy() #copy works on all range objects (ws.Columns(), ws.Cells, etc)
ws.Paste(ws.Range('a7')) 
```

要在保留格式、公式等的同时复制和粘贴到其他工作表：

```
source_ws = wb.Sheets("SheetContainingData")
destination_ws = wb.Sheets("SheetWhereItNeedsToGo")
source_ws.Range('a1:k%s' % row).Copy()
destination_ws.Paste(destination_ws.Range('a7')) 
```

**区分大小写。**

# asp.net - Web.Config 中的 Assemblies 节点的用途是什么？

> ID：530683
> 
>         
> 
> 赞同：39
> 
>         
> 
> 时间：2009-02-10T00:40:05.820
> 
>         
> 
> 标签：asp.net, ajax, configuration

在 Visual Studio 2005 中创建新的 ASP.NET AJAX Web 应用程序时，默认 web.config 包含以下部分（在*编译*节点内）：

```
<assemblies>
    <add assembly="System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
</assemblies> 
```

*程序集*节点是否存在似乎不会影响 AJAX 功能。无论对 System.Web.Extensions 的引用是否包含在 Web.Config 中，更新面板等都可以正常工作。

本节的目的是什么，是否可以安全删除？

* * *

## 回答 #1

> 赞同：33
> 
>             
> 
> 时间：2009-02-10T00:42:26.703

它可能会也可能不会被安全移除。Assemblies 节点用于添加基于配置的参考。它被 ASP.NET 网站使用，这些网站将未编译的 .cs 代码文件部署到他们的网站，而不是（像明智的人那样）已编译的程序集。

如果您将代码隐藏文件部署到您的网站而不是程序集，请将其保留。如果您正在部署程序集，请将其删除。

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2009-05-20T11:10:46.610

Rick Strahl 的 Web 日志有一篇简短但简明地解释了该主题的[文章](http://west-wind.com/weblog/posts/753705.aspx)。

# .net - .NET Optimized Int32

> ID：530690
> 
>         
> 
> 赞同：9
> 
>         
> 
> 时间：2009-02-10T00:43:12.770
> 
>         
> 
> 标签：.net, optimization, integer, 64-bit

While reading through the 70-536 training kit, it states: 

> The runtime optimizes the performance
>   of 32-bit integer types (Int32), so
>   use those types for counters and other
>   frequently accessed integral
>   variables.

Does this only apply in a 32 bit environment?  Does Int64 take over in a 64 bit environment, or is Int32 still the better choice?

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-10T00:48:03.443

That's a funny way to put it. The runtime doesn't have much to do with it.
The CPU is designed for processing 32-bit integers, which is why they're the most efficient to use.

In a 64-bit environment, it again depends on the CPU. However, on x86 CPU's at least (which, to the best of my knowledge, is the only place .NET runs), 32-bit integers are still the default. The registers have simply been expanded so they can fit a 64-bit value. But 32 is still the default.

So prefer 32-bit integers, even in 64-bit mode.

*Edit:* "default" is probably not the right word. The CPU just supports a number of instructions, which define which data types it can process, and which it can not. There is no "default" there. However, there is generally a data size that the CPU is designed to process efficiently. And on x86, in 32 and 64-bit mode, that is 32-bit integers. 64-bit values are generally not more expensive, but they do mean longer instructions. I also believe that at least the 64-bit capable Pentium 4's were significantly slower at 64-bit ops, although on recent CPU's, that part shouldn't be an issue. (But the instruction size may still be)

Smaller than 32-bit values are somewhat more surprising. Yes, there is less data to transfer, which is good, but the CPU still grabs 32-byte at a time. Which means it has to mask out part of the value, so these become even slower.

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-11T19:56:08.257

Scott Hanselman 今天在他的博客上发表了一篇文章，解决了 32 位和 64 位托管代码之间的差异。总结基本上只有指针改变大小，整数仍然是 32 位。  

[你可以在这里](http://www.hanselman.com/blog/BackToBasics32bitAnd64bitConfusionAroundX86AndX64AndTheNETFrameworkAndCLR.aspx)找到帖子。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T00:47:52.947

Unless you plan on having the value exceed 2 billion, use an integer value.  There is no reason to be using extra space for a percieved performance benefit.  

And contrary to what other people on this thread may say, until you measure the benefit of such a small thing as this, it is in only a percieved benefit.

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T00:51:08.040

[http://en.wikipedia.org/wiki/64-bit](http://en.wikipedia.org/wiki/64-bit) suggests (you might find a more authoritative source, this one is the first one that I found) that Microsoft's "64 bit" offerings use **64-bit pointers** with **32-bit integers**.

[http://www.anandtech.com/guides/viewfaq.aspx?i=112](http://www.anandtech.com/guides/viewfaq.aspx?i=112) (and I don't know how trust-worthy it is) says,

> In order to keep code bloat to a minimum, AMD actually sets the default data operand size to 32-bits in the 64-bit addressing mode. The motivation is that 64-bit data operands are not likely to be needed and could hurt performance; in those situations where 64-bit data operands are desired, they can be activated using the new REX prefix (woohoo, yet another x86 instruction prefix :)).

* * *

## 回答 #5

> 赞同：-2
> 
>             
> 
> 时间：2009-02-10T00:52:44.667

A 32-bit CPU handles 32-bit integers faster. A 64-bit one handles 64-bit integers faster; just think about it - you either have to shift bits by 32 bits all the time, or waste 32 bits for each 32 bits, which is essentially the same as using a 64-bit variable without the advantages of a 64-bit variable. An other option would building extra circuitry into the CPU so that shifting would not be necessary but obviously that would increase production costs. This is the same for 32-bit CPUs handling 16-bit or 8-bit variables.

I'm not sure but I wouldn't be surprised if the 64 bit variant of the .NET Framework was a bit more optimized to use longs - but that's just speculation on my part.

# php - 创建/拆分字符串到标签的最佳方法

> ID：530693
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-10T00:45:26.510
> 
>         
> 
> 标签：php, regex

在我的 php 应用程序中，用户可以输入标签（就像在这里提问时一样）。我假设它将是正则表达式，我使用了一个 - mb_split('\W+', $text) - 来按非单词字符分割。

但我想允许用户输入像“-、_、+、#”这样的字符，这些字符在 url 中是有效的并且很常见。

是否有针对此的现有解决方案，或者可能是最佳实践？

谢谢。

* * *

## 回答 #1

> 赞同：23
> 
>             
> 
> 时间：2009-02-10T00:47:42.230

使用[explode()](http://ca3.php.net/manual/en/function.explode.php)函数并用空格或逗号分隔。例子：

```
$string = 'tag1 tag-2 tag#3';
$tags = explode(' ', $string); //Tags will be an array 
```

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-02-10T00:46:50.920

`\s+`而是用空格分割。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T00:47:18.203

在 \s+ （空格）而不是 \W+ （非字母数字）上拆分。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-03-21T04:04:32.550

我想您可以先尝试清理字符串，然后再将其拆分为标签：

```
# List characters that you would want to exclude from your tags and clean the string
$exclude = array( '/[?&\/]/', '/\s+/');
$replacements = array('', ' '); 
$tags = preg_replace($exclude, $replacements,  $tags);

# Now split:
$tagsArray = explode(' ', $tags); 
```

您可能也可以采用白名单方法，而是将您接受的字符列在您的模式中。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-03-25T16:05:36.743

您说您希望它像 stackoverflow 标记器一样工作。这个标注器用空格字符“”将它们分开。

如果您也希望这也是您的行为，只需使用：

```
mb_split('\s+', $text) 
```

代替：

```
mb_split('\W+', $text) 
```

祝你好运！

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-03-26T18:58:05.950

我使用这个 smart_explode () 函数来解析我的应用程序中的标签：

```
function smart_explode ($exploder, $string, $sort = '') {
  if (trim ($string) != '') {
    $string = explode ($exploder, $string);
    foreach ($string as $i => $k) {
      $string[$i] = trim ($k);
      if ($k == '') unset ($string[$i]);
    }
    $u = array_unique ($string);
    if ('sort' == $sort) sort ($u);
    return $u;
  } else {
    return array ();
  }
} 
```

它通过使用 $exploder 作为分隔符（通常是逗号）将 $string 分解为数组，删除重复的，修剪标签周围的空格，如果 $sort 是“排序”，甚至为您排序标签。当 $string 中没有任何内容时，它将返回一个空数组。

用法是这样的：

```
$mytaglist = smart_explode (',', '  PHP,  ,,regEx ,PHP'); 
```

以上将返回：

```
array ('PHP', 'regEx') 
```

要过滤您不喜欢的字符，请执行

```
 $mytaglist = str_replace (array ('?', '$', '%'), '_', $mytaglist); 
```

在 smart_exploding 之前（列出数组中的“坏”字符以替换为下划线）。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-03-27T08:09:28.717

处理标签的正确方法取决于您对处理输入的偏好：您可以完全删除无效标签，或者尝试清理标签以使它们变得有效。

在清理输入时应使用定义有效字符的白名单方法 - 有太多有问题的字符需要列入黑名单。

```
mb_internal_encoding('utf8');

$tags= 'to# do!"¤ fix-this str&ing';
$allowedLetters='\w';
// Note that the hyphen must be first or last in a character class pattern,
// to match hyphens, instead of specifying a character set range
$allowedSpecials='_+#-'; 
```

第一种方法完全删除无效标签：

```
// The first way: Ignoring invalid tags

$tagArray = mb_split(' ', $tags);

$pattern = '^[' . $allowedLetters . $allowedSpecials . ']+$';

$validTags = array();
foreach($tagArray as $tag)
{
    $tag = trim($tag);
    $isValid = mb_ereg_match($pattern, $tag);
    if ($isValid)
        $validTags[] = $tag;
} 
```

第二种方法尝试清理标签：

```
// The second way: Cleaning up the tag input

// Remove non-whitelisted characters
$pattern = '[^' . $allowedLetters . $allowedSpecials .']';

$cleanTags = mb_ereg_replace($pattern, ' ', $tags);

// Trim multiple white spaces.
$pattern = '\s+';
$cleanTags = mb_ereg_replace($pattern, ' ', $cleanTags);

$tags = mb_split(' ',$cleanTags); 
```

用空格替换非法字符有时会导致问题 - 例如上面的“string&ing”被转换为“string”。完全删除非法字符会产生“字符串”，这在某些情况下更有用。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-03-26T11:29:53.187

使用`preg_match_all`.

```
$tags = array();
if(preg_match_all('/\s*(.*)\s*/U',$tags)) unset($tags[0]);
//now in $tags you have an array of tags. 
```

如果标签采用 UTF-8 格式，则将`u`修饰符添加到正则表达式。

# javascript - jQuery选择图像

> ID：530701
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-10T00:48:04.723
> 
>         
> 
> 标签：javascript, jquery, user-interface, web-applications

我希望允许用户选择预先上传的图像到用户生成的网页。

我有一个可用图像的列表，因此我可以使用选择控件轻松完成此操作，但是，我真的希望允许用户从缩略图弹出窗口中进行选择，而不是文本，然后让它填充文本带有结果文件名的表单元素。我希望最终结果会像一个日历弹出日期选择器。

我确信有一种简单的方法可以使用 Jquery / 其他 javascript 来做到这一点。有谁知道一个预先构建的小部件/示例，或者人们可以指出我从哪里开始的正确方向吗？我对 Javascript 很陌生，但愿意花一些时间学习...

* * *

澄清：理想情况下，网格或缩略图列表是我所追求的，但主要是为用户提供图片的视觉表示，而不是文件名......

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-02-10T01:16:18.587

我能够找到这个名为[“Select Box Factory 2.0”的 jQuery 插件](http://www.headcircus.com/uiguy/selectboxfactory/selectboxfactory.html)

打开“其他功能：图像”手风琴，我认为这或多或少是您想要的。

或者，您可以执行以下操作：

```
<select id='images'>
    <option value='tiger.jpg'>Tiger</option>
    <option value='owl.jpg'>Owl</option>
    <option value='bear.jpg'>Bear</option>
</select>
<div id='preview'></div> 
```

然后像这样的jQuery代码：

```
$('#images').change(function() {
    var image = $(this).val();
    var img = $('<img/>').attr('src', image);
    $('#preview').html(img);
}); 
```

祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T00:53:58.533

```
function fillBox(myImg){
    imageSource = myImg.src;
    imgName = // do some stuff to get only the filename, minus the dirs
    document.getElementById("yourTextBox").value = imgName;
} 
```

在生成缩略图时，将其添加到 img 标签：

```
onclick="javascript:fillBox(this);" 
```

我还没有测试过这些，但它应该能让你大部分时间到达那里。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T00:53:18.410

我对[jQuery custom select](http://www.acewebdesign.com.au/customselect.php)印象深刻。不过，在填充字段时似乎有点迟缓。

# php - PHP 中 TDD 和/或 BDD 的状态是什么？

> ID：530712
> 
>         
> 
> 赞同：30
> 
>         
> 
> 时间：2009-02-10T00:53:16.367
> 
>         
> 
> 标签：php, testing, tdd, bdd

PHP 世界中测试的广泛性、支持性和开发性如何？与Java相提并论？有 Ruby/Rails 吗？我用谷歌搜索并发现测试框架存在，但我想知道它们是否被广泛使用。

主要的 PHP IDE 是否像 Eclipse 的 Java 工具或 NetBeans 的 Ruby/Rails 工具那样有内置的测试运行器？测试是否像 Rails 一样内置在 PHP 的 MVC 框架中？

我问是因为我工作的一个小组想雇用某人为他们开发 PHP 应用程序。我担心质量和维护，因为我可能会被要求支持这件事。

* * *

## 回答 #1

> 赞同：44
> 
>             
> 
> 时间：2009-02-10T02:24:38.453

至少有两个成熟的、独立的、JUnit 风格的测试套件可用，分别命名为[PHPUnit](http://www.phpunit.de/)和[SimpleTest](http://www.simpletest.org/)。  

就 MVC 框架而言，Symfony 有自己的名为[lime](http://www.symfony-project.org/book/1_0/15-Unit-and-Functional-Testing)的测试框架，Code Igniter 有一个[unit_test](http://codeigniter.com/user_guide/libraries/unit_testing.html)库，[CakePHP](http://bakery.cakephp.org/articles/view/testing-models-with-cakephp-1-2-test-suite)依赖于前面提到的 SimpleTest。

我知道 Zend Studio 已经内置了对 PHPUnit 测试的支持，而且 PHPUnit 和 SimpleTest 都有命令行运行器，因此可以集成到任何工作流中。

如果开发人员想要利用这些工具，PHP 世界中就存在这些工具，而智能商店确实会利用它们。

警告是您对课程 PHP 投诉的标准。有两个 PHP 社区；PHP 作为构建软件的平台，PHP 作为一种与 Web 服务器、Web 浏览器和数据库交互的方式，以在 Web 上生成类似应用程序的东西。它不是一个黑白的东西，而是一个连续体；在软件开发人员方面，单元测试和 TDD 的更多支持和使用与在任何其他平台上一样多。在“拼凑一堆看不懂但还是有结果的人”中，闻所未闻。

周围有很多非框架/自定义框架的遗留 PHP 代码，很难找到有用的测试工具。PHP 也很容易适用于依赖浏览器环境来运行的模式。除了我自己的观察之外，我没有任何证据支持这一点，但是许多关心测试的 PHP 商店最终依赖于验收测试（即 Selenium）来代替实际的单元测试、测试优先等。 发展。

在你的具体情况下，面试你的团队将要雇用的开发人员。  

1.  问他们使用什么单元测试框架

2.  要求他们笼统地描述他们开发新功能及其支持测试的真实世界示例

3.  让他们笼统地描述一个真实世界的例子，说明他们的测试失败的时间以及他们为解决这种情况所做的工作

你对他们将要描述的具体情况不太感兴趣，而对他们讨论他们的代码测试知识的舒适程度更感兴趣。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2011-01-20T01:37:49.247

每当我使用 XUnit 风格的工具对项目进行 TDD 时，我都很难把头放在正确的位置上。我发现使用为行为驱动开发或“[通过示例规范](http://specificationbyexample.com/key_ideas.html)”设计的工具使我更容易[正确地进行 TDD——](http://gojko.net/2010/12/02/the-principle-of-symmetric-change/)即专注于设计、揭示意图和[描述特定上下文中的行为](http://martinfowler.com/bliki/SpecificationByExample.html)。***不***测试。

也就是说，我想在谈话中介绍[胸肌。](https://github.com/noonat/pecs)来自项目网站上的自述文件。

> pecs 是一个用于 PHP 5.3、la RSpec 或 JSpec 的小型行为驱动开发库。

如果您使用过 JSpec 或更好，那么[Jasmine-BDD](http://pivotal.github.com/jasmine)（用于 JavaScript）描述行为的 pecs 风格应该非常熟悉。我发现这种风格非常适合组件级别的规范。如果您正在寻找用于功能级别规范（故事或用户验收测试）的 PHP 工具，请考虑[Behat](http://everzet.com/Behat/)。

回到 pecs，这里有一个从 pecs 项目网站中挑选出来的例子：

```
describe("Bowling", function() {
  it("should score 0 for a gutter game", function() {
    $bowling = new Bowling();
    for ($i=0; $i < 20; $i++) {
      $bowling->hit(0);
    }
    expect($bowling->score)->to_equal(0);
  });
}); 
```

是的，这是一个 PHP 规范。查看 pecs 源代码，作者似乎能够通过利用 PHP 5.3+、Lambdas 和闭包中的新热点来实现这一目标。所以我想这意味着你不能在任何基于 PHP < 5.3（仅供参考）的项目中使用 pecs。

此外，pecs 不如 PHPUnit 或 SimpleTest 成熟。但是，我认为 PHP 社区中 BDD 的支持者应该支持像 pecs 这样鼓励“通过示例说明”或 BDD 的工具的发展，而不必使用遗留 XUnit 测试工具带来的混乱。

这些天我在 Python 中的工作比 PHP 更多。但是，下次我选择 PHP 项目时，如果我有一个成熟的、社区支持的工具（如 pecs）来制定软件规范，我会非常高兴。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2013-01-08T01:20:37.537

[我在 Behat / Mink http://behat.org](http://behat.org)方面有过惊人的体验

我同意其他人的观点 php 作为一个单元测试平台不是一种有趣或体验 如果您使用任何 php 框架，BDD 是最好的方法

将我的头脑围绕在 composer 作为一个 repo 构建工具是最大的绊脚石，但我们能够使用 Behat Mink Selenium Webdriver 独立服务器 jar 作为一个了不起的设计和回归测试工具。我们曾经在 Jenkins 服务器上针对我们的 CakePHP 应用程序运行回归套件，但事实证明它不够“快速失败”

现在我们的工作流程是这样的： 在 gherkin 中创建故事 完善故事编写功能并删除任何新步骤 defs 开始编码 php 解决方案以进行测试 然后最后我们有一个工作功能或错误修复，其中包含一个 bdd 测试

我们使用有效的 Behat 设置设置了一个 Ubuntu VM，并将其复制到每个工作站。我们将其融入到我们的流程中。我们只是拉下更改运行测试，然后开始编写新的东西。

我们编写了一个 shell 脚本来自动运行 mysql 转储并在每个功能之前加载它们，这使得重构代码变得轻而易举。

Mink WebAssert 类为您提供验证行为所需的所有断言 常规会话/CommonContext 类非常适合使用 css 或 xpath。

我之前在 Java 和 Rails 项目中使用过 Capybara / WebDriver，发现与 Behat 相比，设置开销 / 学习曲线太高了。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T09:19:38.863

除了[Alan](https://stackoverflow.com/questions/530712/whats-the-state-of-tdd-and-or-bdd-in-php/530886#530886)已经提到的库/框架之外，您还可以使用 mod_perl 的 Apache::Test，我将其用作工具。它允许我非常简单地将测试集成到我的发布过程中。该工具使用[TAP](http://en.wikipedia.org/wiki/Test_Anything_Protocol)输出（测试任何协议）来确定测试是通过还是失败，使用诸如[Test::Simple](http://search.cpan.org/dist/Test-Simple/lib/Test/Simple.pm)或 Test::More（[Perl](http://search.cpan.org/~mschwern/Test-Simple-0.86/lib/Test/More.pm)和[PHP](http://shiflett.org/code/test-more.php)）之类的库。

开箱即用的 Apache::Test 支持在 Perl 和 PHP 中编写测试。在我自己的项目中，它需要一些[技巧](http://shiflett.org/blog/2004/dec/testing-php)和大量阅读才能真正让它工作，但是[PHP 中 Test::More](http://shiflett.org/code/test-more.php)的实现是内置到工具中的。运行用 PHP 和 Perl 编写的所有测试都是通过一个命令完成的，并且一路上的任何失败都会被 Apache::Test 捕获，并尽可能地指出哪里出了问题。

这一切的美妙之处在于，您甚至可以使用 PHPUnit 或 Simple-Test 以及前两个测试框架。通过在每个相应的库中运行测试，您可以使用 Test::More 的 PHP 实现（甚至通过测试标准输出来使用 Perl）并吐出 TAP 以供您的工具解释。  

请务必阅读[Apache::Test](http://search.cpan.org/~phred/Apache-Test-1.30/lib/Apache/Test.pm)文档和[运行 Apache::Test 的 mod_perl 指南](http://perl.apache.org/docs/general/testing/testing.html)。此外，我发现[这里](http://www.digitalsandwich.com/archives/38-I-think-I-finally-understand-Apache-Test.html)的文章很有帮助。

举个简单的例子，你可以用几行代码在 Perl 中设置一个测试，该测试将运行你网站上的所有页面（有链接）并验证所有结果为 ' `200 OK`' 响应并且没有任何解析错误：

```
#!perl

use strict;
use warnings;

use Apache::Test qw(:withtestmore);
use Apache::TestRequest;
use Test::More;
use Test::WWW::Mechanize;
use WWW::CheckSite::Validator;
use WWW::CheckSite::Spider;

plan 'no_plan';

my $config = Apache::Test::config();
my $host = "http://". Apache::TestRequest::hostport($config) || '';

my $s = WWW::CheckSite::Spider->new(
    uri => $host,
    ua_class => 'Test::WWW::Mechanize',
);
my $m = $s->current_agent;

while (my $page = $s->get_page) {
    is($m->status(), "200", $m->uri() ." retrieved successfully.");
    $m->content_lacks("Parse Error", $m->uri() ." does not contain syntax errors.");
} 
```

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-08-07T21:24:21.660

在过去的一个项目中，我使用了 PHPUnit，但它让我一直想要。PHPUnit + 命令行运行测试，使得编写测试代码花费了太多时间，速度不够快，而且似乎确实以我不喜欢的方式限制了代码的风格（对象是更容易测试，所以它似乎有点偏爱对象）。

Selenium 是我们讨论过的一个解决方案，但从未开始发挥作用，我认为我们真的会从这种输出级测试中受益。

在这个最新项目中，首席程序员在我们修改软件时采用了更具功能性的编程方法。当我提到我想通过 TDD 进行编码时，他在一天或更短的时间内制定了一个自定义解决方案，我认为它对我来说与 PHPUnit 一样有效。此外，他真的让我对面向对象与函数式编程的问题大开眼界。

第一个项目，从头开始，在底层，面向对象编码，大型单元测试框架，它变得单一并很快陷入困境。第二个项目，成熟的 CMS 软件，有 5 年的历史和旧代码，但函数式编程范式和简单的测试框架（我们实际上经常使用 php assert）使它变得更简单，而不是变得复杂。

第二个项目也从未达到实现 Selenium 的地步（我仍然认为这将是有益的），但函数式编程方法更容易处理代码内测试。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2010-11-29T18:59:27.000

我刚刚发现了这个问题，虽然我仍处于“研究阶段”，以弄清楚发生了什么。我刚刚为 Ruby on Rails 发现了一个叫做“Cucumber”的东西[http://cukes.info/](http://cukes.info/)

它本质上是 Ruby 的“故事驱动开发”，并且很可能是功能测试领域的黄金标准，至少就我在旅行中看到的而言。（我把它公开放在那里，如果我错了，专家可以纠正我）

作为 Cucumber 中语言的一个示例，您有一些非常类似于 SQL 的东西。  *但*似乎更具人类可读性。从 cukes 头版看，他们的语言是这样的：

```
 Scenario: Add two numbers
      Given I have entered 50 in the calculator
      And I have entered 70 in the calculator
      When I press add
      Then the result should be 120 on the screen 
```

以上将编译并作为测试运行。

现在，这就是回答您关于 PHP - BDD 和 TDD 问题的序言。

在回应上述评论时，PHPUnit 将允许单元测试，并且根据这篇博客文章：[http](http://sebastian-bergmann.de/archives/738-Support-for-BDD-and-Stories-in-PHPUnit-3.3.html) ://sebastian-bergmann.de/archives/738-Support-for-BDD-and-Stories-in-PHPUnit-3.3.html也支持“故事风格”BDD 测试。

为了扩展上述关于“SIMPLETEST”的答案，ST 系统有一个内置的浏览器对象类用于浏览器自动化，而 PHPUnit 有一个 SELENIUM 浏览器自动化的扩展[http://seleniumhq.com](http://seleniumhq.com)   （优势Selenium 与 SimpleTest 的区别在于 Selinium 将运行任何页面上的 javascript 而 SimpleTest 不会）。

我希望这些信息对您有所帮助，因为它是经过数月的个人研究和对上述技术的实际试验和错误的结果。如果有专家可以澄清和提高我对上述内容的理解，我欢迎反馈。

*   亚历克斯。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-12-04T14:41:31.270

Michael Booth 对两种语言的 BDD 测试功能的比较：

[http://mechanicalrobotfish.com/posts/117-ruby-vs-php-bdd-beauty-contest-no-contest](http://mechanicalrobotfish.com/posts/117-ruby-vs-php-bdd-beauty-contest-no-contest)

得出的结论是 PHP BDD 工具和文化在这一点上是不发达的。

当然，无论是在知识（书籍、视频、文章、博客文章）还是工具（Rspec、Shouda、Factory Girl、Mocha、Cucumber）方面，都无法与 Ruby 程序员可用的东西相提并论。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2011-12-12T19:42:06.153

现在我正在为 BDD 测试开发“频谱”框架：[https ://github.com/m-haritonov/spectrum](https://github.com/m-haritonov/spectrum)

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2011-12-13T15:14:06.857

您可能想查看[PHPStorm](http://www.jetbrains.com/phpstorm/)。我喜欢在 IDE 中使用 PHPUnit 的测试运行器。

# python - Django - 如何从以前的表单帖子中删除缓存的结果？

> ID：530715
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-10T00:53:45.570
> 
>         
> 
> 标签：python, django

我有一个包含字符串字典的 django 表单。我给表单一个提交按钮和一个预览按钮。当输入一些信息后按下预览按钮时，会发送一个 POST，并自动恢复字典中的字符串（我假设它是使用会话状态或其他东西完成的）。这很棒，正是我想要的。

问题是，如果我不提交表单，然后执行 GET（即浏览到上面有表单的页面），输入一些信息并点击预览，从第一次预览存储在字典中的信息是还在那里。

你如何清除这些信息？

以下是我的表格：

```
class ListingImagesForm(forms.Form):   
#the following should be indented
def clear_dictionaries(self):
    self.statuses = {}
    self.thumbnail_urls = {}
    self.image_urls = {}

statuses = {}
thumbnail_urls = {}
image_urls = {}

valid_images = SortedDict() #from the django framework
photo_0 = forms.ImageField(required=False, label='First photo')
photo_1 = forms.ImageField(required=False, label='Second photo')

def clean_photo_0(self):
    return self._clean_photo("photo_0")

def clean_photo_1(self):
    return self._clean_photo("photo_1")

def _clean_photo(self, dataName):
    data = self.cleaned_data[dataName]
    if data != None:
        if data.size > max_photo_size:
            raise forms.ValidationError("The maximum image size allowed is 500KB")
        elif data.size == 0:
            raise forms.ValidationError("The image given is empty.")
        else:
            self.valid_images[dataName] = data
            self.statuses[dataName] = True
            list_of_image_locs = thumbs.save_image_and_thumbs(data.name, data)
            self.image_urls[dataName] = list_of_image_locs[0]
            self.thumbnail_urls[dataName] = list_of_image_locs[1]
    return data 
```

这是视图：

```
@login_required
def add(request):
#the following should be indented
preview = False
added = False
new_listing = None
owner = None

if request.POST:
    form = GeneralListingForm(request.POST)
    image_form = ListingImagesForm(request.POST, request.FILES)

    if image_form.is_valid() and form.is_valid(): 
        new_listing = form.save(commit=False)
        new_listing.owner = request.user.get_profile()

        if request.POST.get('preview', False):
            preview = True
            owner = new_listing.owner

        elif request.POST.get('submit', False):
            new_listing.save()
            for image in image_form.image_urls:
                url = image_form.image_urls[image]
                try:
                    new_image = Image.objects.get(photo=url)
                    new_image.listings.add(new_listing)
                    new_image.save()
                except:
                    new_image = Image(photo=url)
                    new_image.save()
                    new_image.listings.add(new_listing)
                    new_image.save()

            form = GeneralListingForm()
            image_form = ListingImagesForm()
            image_form.clear_dictionaries() 
            added = True

else:
    form = GeneralListingForm()
    image_form = ListingImagesForm()
    image_form.clear_dictionaries()

return render_to_response('add_listing.html', {'form': form, 'image_form' : image_form, 
                                                'preview': preview, 'added': added,
                                                'owner': owner, 'listing': new_listing,
                                                'currentmaintab': 'listings',
                                                'currentcategory': 'all'},
                                                                        context_instance=RequestContext(request)) 
```

我一直没有用 django 或 python 编程，所以欢迎任何关于修复一些代码的指针:)

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T12:07:09.733

这段代码在概念上是错误的；它永远不会做你想做的事。您的字典是 ListingImagesForm 类的类属性。此类是模块级全局。因此，您将一些状态存储在网络服务器进程的内存中的全局变量中。此状态对您的应用程序的所有用户都是全局的，而不仅仅是提交表单的用户，并且将持续存在（对所有用户都相同）直到它被明确更改或清除（或者直到您碰巧让您的下一个请求由生产网络服务器中的不同进程/线程）。

[**编辑**：我在这里以一种不清楚的方式使用了“全球”。类属性不是“全局的”，它们封装在类命名空间中，正如您所期望的那样。但是您将属性分配给类对象，而不是类的实例（您将在 __init__() 方法中执行此操作）。类对象是一个模块级的全局对象，它只有一组属性。每次更改它们时，您都是在为每个人更改它们。如果您修改上面的代码，以便在 __init__() 方法中初始化您的三个字典，那么您的“缓存数据”“问题”就会消失；但是你一开始想要的“神奇”持久性行为也是如此。]

您需要重新考虑您的设计，清楚地了解 Django 不会“自动”跨请求为您维护任何状态。您的所有状态都必须通过 POST 或 GET 显式传递，或者显式保存到会话中。除了不可变的配置类型信息外，应避免 Form 类上的类属性，并且实例属性仅用于在处理单个请求时跟踪临时状态，它们不会在请求之间持续存在（您的 Form 类的新实例在每个请求上创建）。

# wcf - 如何确保您没有收到 WCF 故障状态异常？

> ID：530731
> 
>         
> 
> 赞同：50
> 
>         
> 
> 时间：2009-02-10T01:04:26.260
> 
>         
> 
> 标签：wcf, exception, wcf-client

我得到了这个例外：

> *通信对象 System.ServiceModel.Channels.ServiceChannel 不能用于通信，因为它处于故障状态。*

WCF 服务使用默认的 wsHttpBinding。无论我在哪里使用 WCF，我都以以下方式使用它：

```
using (var proxy = new CAGDashboardServiceClient())
{
    proxy.Open();
    var result = proxy.GetSiteForRegion(ddlRegions.SelectedValue);
    ddlSites.DataSource = result;
    ddlSites.DataBind();
    proxy.Close();
} 
```

消息中显示的错误行似乎在最后一个 proxy.close 之后。不知道发生了什么。我正在从 Visual Studio 08 中启动该服务。

这是跟踪信息：

```
The communication object, System.ServiceModel.Channels.ServiceChannel, cannot be used for communication because it is in the Faulted state.

Server stack trace: 
  at System.ServiceModel.Channels.CommunicationObject.Close(TimeSpan timeout)

Exception rethrown at [0]: 
  at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
  at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
  at System.ServiceModel.ICommunicationObject.Close(TimeSpan timeout)
  at System.ServiceModel.ClientBase`1.System.ServiceModel.ICommunicationObject.Close(TimeSpan timeout)
  at System.ServiceModel.ClientBase`1.Close()
  at System.ServiceModel.ClientBase`1.System.IDisposable.Dispose()
  at CAGDashboard.UserControls.ucVolunteerCRUDGrid.ddlRegions_SelectedIndexChanged(Object sender, EventArgs e) in C:\Documents and Settings\rballalx\My Documents\Visual Studio 2008\Projects\DashboardCAG\CAGDashboard\UserControls\ucVolunteerCRUDGrid.ascx.cs:line 81
  at System.Web.UI.WebControls.ListControl.OnSelectedIndexChanged(EventArgs e)
  at System.Web.UI.WebControls.DropDownList.RaisePostDataChangedEvent()
  at System.Web.UI.WebControls.DropDownList.System.Web.UI.IPostBackDataHandler.RaisePostDataChangedEvent()
  at System.Web.UI.Page.RaiseChangedEvents()
  at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 
```

* * *

## 回答 #1

> 赞同：67
> 
>             
> 
> 时间：2009-02-10T05:23:06.920

[您应该避免将客户端代理放在`using`块中。](http://msdn.microsoft.com/en-us/library/aa355056.aspx)

* * *

## 回答 #2

> 赞同：20
> 
>             
> 
> 时间：2011-02-19T04:36:36.003

* * *

**更新**：

这个[链接的答案描述了一种使用 C# 语法做同样事情的更干净、更简单的方法。](https://stackoverflow.com/a/9489503/328397)

* * *

**原帖**

这是 Microsoft 推荐的处理 WCF 客户端调用的方法：

有关更多详细信息，请参阅：[预期异常](http://msdn.microsoft.com/en-us/library/aa354510.aspx)

```
try
{
    ...
    double result = client.Add(value1, value2);
    ...
    client.Close();
}
catch (TimeoutException exception)
{
    Console.WriteLine("Got {0}", exception.GetType());
    client.Abort();
}
catch (CommunicationException exception)
{
    Console.WriteLine("Got {0}", exception.GetType());
    client.Abort();
} 
```

**附加信息**

似乎有很多人在 WCF 上问这个问题，以至于微软甚至创建了一个专门的示例来演示如何处理异常：

c:\WF_WCF_Samples\WCF\Basic\Client\ExpectedExceptions\CS\client

下载示例：
 [C#](http://www.microsoft.com/downloads/en/confirmation.aspx?FamilyID=35ec8682-d5fd-4bc3-a51a-d8ad115a8792&displaylang=en)或  [VB](http://archive.msdn.microsoft.com/vb2010samples/Release/ProjectReleases.aspx?ReleaseId=4174)  

[考虑到涉及到 using 语句的](http://msdn.microsoft.com/en-us/library/aa355056.aspx)问题很多，[（加热？）关于这个问题的内部讨论](http://social.msdn.microsoft.com/forums/en-US/wcf/thread/4cdc67e0-3069-4d3b-b94f-27e2b8ff4429/)和[线程](http://social.msdn.microsoft.com/forums/en-US/wcf/thread/b95b91c7-d498-446c-b38f-ef132989c154/)，我不会浪费我的时间尝试成为代码牛仔并找到更清洁的方法。我将把它吸干，并为我的服务器应用程序以这种冗长（但受信任）的方式实现 WCF 客户端。  

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2014-04-24T02:38:45.740

如果传输模式为**Buffered**，则确保**MaxReceivedMessageSize**和**MaxBufferSize**的值**相同**。经过几个小时的努力，我刚刚以这种方式解决了错误状态问题，并认为如果它对某人有帮助，我会在这里发布它。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2015-04-21T15:53:34.320

此错误也可能是由使用 OperationContract 属性标记的零个方法引起的。这是我在构建新服务并进行长时间测试时遇到的问题。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2016-04-13T19:07:10.347

与 Ryan Rodemoyer 的回答类似，我发现当合同上的 UriTemplate 无效时，您会收到此错误。就我而言，我两次使用相同的参数。例如：

```
/Root/{Name}/{Name} 
```

# java - Error deploying an app to JBoss 5 that was working fine on JBoss 4.2

> ID：530735
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-02-10T01:05:11.203
> 
>         
> 
> 标签：java, deployment, jboss, jakarta-ee

Im trying to deploy an application (.ear file) to JBoss 5, and I'm receiving the following error. The app deploys fine under 4.2.2.

```
15:31:33,172 ERROR [AbstractKernelController] Error installing to Real: name=vfszip:/C:/ASE/ext/jboss-5.0.0.GA/server/all/dep
loy/UGC-WS.ear state=PreReal mode=Manual requiredState=Real
org.jboss.deployers.spi.DeploymentException: Error during deploy: vfszip:/C:/ASE/ext/jboss-5.0.0.GA/server/all/deploy/UGC-WS.
ear/ugc-ws.war
at org.jboss.deployers.spi.DeploymentException.rethrowAsDeploymentException(DeploymentException.java:49)
at org.jboss.deployers.plugins.deployers.DeployerWrapper.deploy(DeployerWrapper.java:177)
at org.jboss.deployers.plugins.deployers.DeployersImpl.doDeploy(DeployersImpl.java:1439)
at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1157)
at org.jboss.deployers.plugins.deployers.DeployersImpl.doInstallParentFirst(DeployersImpl.java:1210)
at org.jboss.deployers.plugins.deployers.DeployersImpl.install(DeployersImpl.java:1098)
at org.jboss.dependency.plugins.AbstractControllerContext.install(AbstractControllerContext.java:348)
at org.jboss.dependency.plugins.AbstractController.install(AbstractController.java:1598)
at org.jboss.dependency.plugins.AbstractController.incrementState(AbstractController.java:934)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:1062)
at org.jboss.dependency.plugins.AbstractController.resolveContexts(AbstractController.java:984)
at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:822)
at org.jboss.dependency.plugins.AbstractController.change(AbstractController.java:553)
at org.jboss.deployers.plugins.deployers.DeployersImpl.process(DeployersImpl.java:781)
at org.jboss.deployers.plugins.main.MainDeployerImpl.process(MainDeployerImpl.java:545)
at org.jboss.system.server.profileservice.ProfileServiceBootstrap.loadProfile(ProfileServiceBootstrap.java:304)
at org.jboss.system.server.profileservice.ProfileServiceBootstrap.start(ProfileServiceBootstrap.java:205)
at org.jboss.bootstrap.AbstractServerImpl.start(AbstractServerImpl.java:405)
at org.jboss.Main.boot(Main.java:209)
at org.jboss.Main$1.run(Main.java:547)
at java.lang.Thread.run(Thread.java:595)
Caused by: java.lang.ClassCastException: org.jboss.metadata.ear.spec.JavaModuleMetaData
at org.jboss.wsf.container.jboss50.deployment.metadata.JSEArchiveMetaDataAdapter.buildMetaData(JSEArchiveMetaDataAdap
ter.java:76)
at org.jboss.wsf.container.jboss50.deployment.metadata.ContainerMetaDataAdapter.buildContainerMetaData(ContainerMetaD
ataAdapter.java:76)
at org.jboss.wsf.container.jboss50.deployment.metadata.ContainerMetaDataDeploymentAspect.create(ContainerMetaDataDepl
oymentAspect.java:51)
at org.jboss.wsf.framework.deployment.DeploymentAspectManagerImpl.create(DeploymentAspectManagerImpl.java:121)
at org.jboss.wsf.container.jboss50.BareWSFRuntime.create(BareWSFRuntime.java:61)
at org.jboss.wsf.container.jboss50.deployer.ArchiveDeployerHook.deploy(ArchiveDeployerHook.java:84)
at org.jboss.wsf.container.jboss50.deployer.AbstractDeployerHookEJB.deploy(AbstractDeployerHookEJB.java:43)
at org.jboss.wsf.container.jboss50.deployer.AbstractWebServiceDeployer.internalDeploy(AbstractWebServiceDeployer.java
:60)
at org.jboss.wsf.container.jboss50.deployer.WebServiceDeployerEJB.internalDeploy(WebServiceDeployerEJB.java:112)
at org.jboss.deployers.spi.deployer.helpers.AbstractRealDeployer.deploy(AbstractRealDeployer.java:50)
at org.jboss.deployers.plugins.deployers.DeployerWrapper.deploy(DeployerWrapper.java:171)
... 19 more
15:31:33,203 ERROR [ProfileServiceBootstrap] Failed to load profile: Summary of incomplete deployments (SEE PREVIOUS ERRORS F
OR DETAILS):

*** CONTEXTS IN ERROR: Name -> Error

vfszip:/C:/ASE/ext/jboss-5.0.0.GA/server/all/deploy/UGC-WS.ear -> java.lang.ClassCastException: org.jboss.metadata.ear.spec.J
avaModuleMetaData 
```

That's the error message from the console, and I can't figure out much from that... 

The application just contains web services and a servlet that loads on startup to initialize and cache some data.

We have an EAR file which contains a few JAR files (one of them being named ugc-ws.jar) for libraries that we use, and also a WAR file which has the web.xml to load a servlet - this WAR file also has the same ugc-ws.jar in it's lib directory because the servlet is inside that JAR. So basically we have the main EAR file, and within it multiple jar files, as well as a WAR file - which also has a JAR file inside it's lib directory. And the error looks like it's coming from the WAR.

This is the output from "jar -tf ugc-ws.war": 

```
>jar -tf ugc-ws.war
META-INF/
META-INF/MANIFEST.MF
WEB-INF/
WEB-INF/web.xml
WEB-INF/lib/
WEB-INF/jboss-web.xml
WEB-INF/lib/ugc-ws.jar 
```

Just for testing, I remvoed the .WAR file from the .EAR and the application deploys without any errors, but obviously w/out the data from the WAR, i can't use the application. The way I'm deploying is just dropping the .EAR file into the server\all\deploy directory. 

I've tried splitting up the ugc-ws.jar into two separate jars, one with just the webservices and the other w/ just the servlet, but I still receive the same error. 

Just weird that this worked fine in JBoss 4 but not on JBoss 5.

Thanks

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-02-10T21:40:40.010

这并不奇怪。

JBoss 4.2 不符合 Java5EE。JBoss 5.0 IS 兼容。

在我看来，你在战争的某个地方有一个有问题的设置。该错误仅出现在 JBoss 5 中，因为在此版本中强制执行正确性。

只是一个快速的猜测。您的 jboss-web.xml 可能有错误的 dtd。 
[看看这个](https://jira.jboss.org/jira/browse/JBPM-1911)。

我还建议您重新阅读 JBoss 文档，尤其是 5.0 的发行说明以及他们为 4.2 用户提供的任何迁移提示

# c# - 尝试更改 IQueryable 集合的属性

> ID：530736
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-02-10T01:05:26.197
> 
>         
> 
> 标签：c#, linq, linq-to-sql

我正在尝试做一些我认为很简单的事情，但我怀疑我太不知道我可能做错了什么。我有一个 LINQ 查询返回：

```
IQueryable<CWords> Result 
```

其中 CWords 是一个类，我定义如下：

```
public class CWords
{
    public CWords(){}
    public string _column1{ get; set; }
    public float  _column2{ get; set; }

    public void fixData(){}
} 
```

在我的代码中，我试图为 Result 的每个成员修改 _column2 字段。我试过：

```
foreach (CWords item in Result)
{
    item.fixData();
} 
```

但这当然没有用。item 不在正确的范围内，因此我在 fixData 中所做的任何更改都没有包含在 Result 中。

因为你不能索引到 IQueryable，我的解决方法是执行以下操作：

```
var items = goodWords.ToList();

for (int i = 0; i < items.Count(); i++ )
   {
    items[i].fixData();
   } 
```

这是正确的方法吗？

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-02-10T18:44:00.997

Brandon，这是使用 LINQ 时的正常错误。看，从 LINQ 返回的 IQueryable 实际上并不包含您的项目，这就是您无法索引它的原因。当您实际要求项目时，它只有足够的信息来执行查询。这称为“[延迟执行](http://blogs.msdn.com/charlie/archive/2007/12/09/deferred-execution.aspx)”，因为查询不是在您执行时执行`select`，而是稍后在您枚举结果时执行。你可以搜索“linq deferred execution”并找到很多人试图解释它是如何工作的。

当您执行您的`foreach`时，查询将运行，并且您正在对每个项目调用 fixData()，正如您所期望的那样。但是，当您再次访问 IQueryable 时，您将再次执行查询，并且（取决于您使用的 LINQ 提供程序）您可能会再次引入原始未修改的项目。

通过在 IQueryable 上调用 ToList()，您正在创建一个包含所有查询结果的内存列表。您现在可以索引此列表并访问它，而无需再次执行查询。如果您可以将所有项目都保存在内存中（小结果集），那么使用 ToList() 对您来说可能是一个很好的解决方案。

@PaulG，你是对的，他可以使用`foreach`而不是`for`，但他应该保存对列表的引用，否则他就在他开始的地方（使用 IQueryable）。

```
var items = goodWords.ToList();

foreach (var item in items)
{
    item.fixData();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T17:47:26.967

我相信你的好词是`IQueryable<CWords>`类型？

那么为什么不这样呢？

```
foreach (CWords item in goodWords.ToList())
{
    item.fixData();
} 
```

# vb.net - Seemingly random crashes with VB.NET and COM Interop

> ID：530740
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-10T01:07:59.980
> 
>         
> 
> 标签：vb.net, com, vb6, clr, rewrite

I'm thinking of rewriting a brand new VB.NET application in VB 6.

The application runs under terminal services and makes heavy use of COM.

For some reason, there is random weirdness with the application -

*   Random Access Violation errors (WinDbg exception analysis points into dll's like comdlg32.dll, mscorwks)

*   Random Buffer Overflow errors (same)

*   Random errors in general - for example this line in Form.Load sometimes throws - Me.Icon = Resources.MyIcon

I have followed all possible advice concerning resources, garbage collection, disposal patterns, etc... It just doesn't seem to do any good.

I'm thinking there is hardware problems.  This runs on a Win2k3 virtual machine under terminal services.  The base server OS is Win2k3 with 64 GB RAM.  The server has many virtual machines each running it's own "stuff" (Exchange, etc..).

Either there's hardware problems, or the .NET environment is not as easy to program against as one may think.

If the hardware were somehow verified (a entirely different story) and the application continued to behave as such would it be a feasible route to take (rewrite closer to the metal)?

I'm not a big fan of virtual machines and doubt their integrity.  (Especially on huge servers.)

**Edit** - Thanks to all for the responses.  The issue turned out to be a single .NET .DLL in my application that was not being targeted to x86 code.  The COM objects are all 32 bit, the OS is 64 bit, thus my .NET application needs to be targetted to 32 bit.  (This explains why my sample VB6 apps always worked.  Not that I *really* wanted to go that route anyway.)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T15:23:49.010

安装 PDB 文件并使用[“调试诊断工具 1.1”](http://www.microsoft.com/downloadS/details.aspx?FamilyID=28bd5941-c458-46f1-b24d-f60151d875a3&displaylang=en)来监控您的应用程序，以识别是否发生泄漏。

也查看这个[“分析 COM 对象注册表干扰的好工具？”](https://stackoverflow.com/questions/522580/good-tools-for-analysing-com-object-registry-interference/522670#522670)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T01:35:07.467

那么您是在其中一台虚拟机上的终端服务下运行的吗？同一个 VM 上有多少其他 TS 用户？我更担心终端服务的特殊性而不是虚拟机的特殊性。但是虚拟机上的 TS 可能会受到很大的打击。我们通常会使用单个 VM 来实现可移植性/DR 或 TS 机器的裸机。

什么 COM 对象？由于您必须通过 COM 互操作，因此您肯定会面临更多的性能问题。如果 COM 对象本身在终端服务下不礼貌......

好的，所以您在一台机器上有多个 TS 用户（现在忘记 VM）。如果这些 COM 对象表现得像他们拥有这台机器，因为一次只能登录一个用户 - BAM。例如，假设一个 COM 对象（尤其是像 Corel 或 Word 这样的巨大对象，其中 COM 对象是一个巨大子系统的接口），去读取它的一些配置文件或形状库或其他东西。通常，它是唯一一个这样做的，所以它永远不会被锁定或阻止或任何事情。现在突然之间，您有多个用户访问同一个（本地）文件。这与尝试从网络共享运行应用程序类似的问题。这几乎可以在任何假设本地机器资源可以被垄断的情况下发生。诸如配置文件、临时文件等之类的东西，

VB6 无法轻易解决此类问题，因为它是第三方子系统的内部问题。您可能会在单独的终端服务器会话中运行的第三方应用程序中看到同样的问题——这正是终端服务的早期采用者在使用多种应用程序时遇到很多困难的原因。我们是 Citrix 的重度用户，在某些早期版本中，您只是没有在 Citrix 上运行某些应用程序。根据 Citrix、Microsoft 或供应商的建议，即使是表现良好的应用程序也经常需要以特殊方式安装。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T12:25:34.383

有没有机会用一个小应用程序重现这个问题？没有虚拟机或终端服务？

现在嫌疑人的数量实在是太大了。你可以得到一些不同方向的指点，希望你在不经意间发现问题。如果你缩小范围，这里的人可能真的可以帮助你。

如果它仍然不起作用，用VB6重写它将是一种可怕的浪费......

# c++ - 过程程序和面向对象的程序有什么区别？

> ID：530741
> 
>         
> 
> 赞同：31
> 
>         
> 
> 时间：2009-02-10T01:08:38.013
> 
>         
> 
> 标签：c++, c, oop, procedural-programming

我对编程还很陌生，但我一直在阅读有关 StackOverflow 的一些关于各种编程方法的有趣讨论。我仍然不是 100% 清楚过程编程和面向对象编程之间的区别。听起来面向对象编程仍然使用过程（方法），但一切的组织方式都不同，因为对象是节目的主角。但在我看来，程序仍然允许你做所有相同的事情。就像在 C 中一样，您可以将所有类似的过程放入一个库中。所以你真的不能说 C 中的库类似于 C++ 中的对象吗？

* * *

## 回答 #1

> 赞同：36
> 
>             
> 
> 时间：2009-02-10T01:35:00.853

在程序化程序中，代码为王，数据为从属。换句话说，您有对数据起作用的程序，它们通常没有紧密绑定。

在 OO 世界中，对象是最重要的东西。一个对象由数据*和*允许作用于该数据的代码组成，它们之间的联系非常紧密。它是封装的概念，信息的隐藏。

举个例子，假设你有一个数字，你想把它加倍。这样做的程序方法是：

```
n = n * 2 
```

这里的代码非常明确地将 n 乘以 2 并将结果存储回 n。

这样做的 OO 方法是向 number 对象发送一条“消息”，告诉它自己加倍：

```
n.double(); 
```

这样做的优点称为多态性。当您决定要能够将“bob”之类的字符串加倍时会发生什么。在程序世界中，您必须提供更多代码来进行加倍，但您还必须以不同的方式调用该代码。

使用 OO，您可以创建一个字符串对象，该对象也可以接收“双重”消息。将字符串加倍的代码属于字符串对象，因此它知道它必须与数字对象不同。如果它决定 "bob" * 2 是 "bobbob"，那么代码将类似于：

```
class number:                    class string:
    int n                           char array s
    procedure double:               procedure double:
        n = n * 2                       s = string_join(s,s) 
```

然后，无论 x 是什么实际类型（数字或字符串），您都可以调用 x.double() 并且它会知道要运行哪个代码 - 这大大简化了您的代码。您可以在显示器上加倍整数、字符串、矩阵、复数、实数、窗口大小以及各种不同的东西。

你是对的，C 库可以看起来有点像对象。经典的例子是`stdio.h`——你从来不关心a实际指向*什么*`FILE*`，只关心它会以某种方式运行。、`FILE*`和其他函数`fopen()`是`fclose()`代表 C 的 I/O 能力的一类。

* * *

## 回答 #2

> 赞同：21
> 
>             
> 
> 时间：2009-02-10T01:13:36.690

您可以在大多数 OO 语言中进行程序化编程，但 OO 的力量来自于继承、封装和抽象该过程逻辑的能力。我认为你是对的，图书馆应该看起来很像一个类。它应该有自己的范围并用有意义的名称封装函数背后的逻辑。

* * *

## 回答 #3

> 赞同：15
> 
>             
> 
> 时间：2009-02-10T02:53:26.810

您的观察是正确的，面向对象的程序在许多方面都基于过程范式。您在语法上也是正确的，真正发生的只是您调用函数。事实上，您可以使用过程机制（例如，C++ 中的函数指针）来实现面向对象语言的许多特性。因此，您可以进行面向对象的设计，并且仍然使用过程语言来实现它（例如，就像旧的 C++ 编译器所做的那样）。

**面向对象范式的重要性并不在于语言机制，而是在于思维和设计过程**。在过程式编程中，思维是关于操作并使用其他操作分解这些操作，将它们分组为模块等。这意味着数据或状态属于次要的重要性。这就像思考数学运算。

另一方面，面向对象的范式说您需要将状态和操作一起视为一个实体，然后将您的程序设计为交换状态和激活操作的实体之间的交互。

* * *

## 回答 #4

> 赞同：13
> 
>             
> 
> 时间：2009-02-10T06:51:12.980

两者之间的差异是微妙的，但意义重大。

在过程程序中，模块通过读取和写入存储在共享数据结构中的状态进行交互。

在面向对象的程序中，对象形式的模块通过向其他对象发送消息进行交互。

* * *

## 回答 #5

> 赞同：10
> 
>             
> 
> 时间：2009-02-10T01:45:44.163

恕我直言，面向对象编程是一个存在于比过程编程更高抽象级别的概念。这两者并不相互排斥，因为 OO 程序中的各个方法看起来与过程程序中的各个函数几乎相同。这与例如函数式编程形成鲜明对比，后者需要完全不同的思维方式。此外，您可以通过将所有内容设为静态等来使用 OO 语言进行程序化编写。您可以成为人类编译器，并通过使用大量函数指针和结构指针转换在 C 中有效地编写 OO 代码。

因此，OO 更像是一种设计哲学和世界观，而不是具有严格定义的东西。它要求将继承、多态等用作构建代码的主要模式，并提供语法以使这些可表达而无需求助于低级技巧。它要求您将作用于数据集合状态的代码视为数据的属性，而不是自身存在的过程。它不是黑白的。您的代码可以是“更多”或“更少”OO，具体取决于您对继承、多态性、类和“作为数据属性的方法”的世界观作为结构化和解释/理解代码的手段的依赖程度。

* * *

## 回答 #6

> 赞同：8
> 
>             
> 
> 时间：2009-02-10T01:42:16.777

OO主要是一种思维定势。你可以用 C 编写面向对象（如果你真的想……），你可以完美地用 C++/Java 编写程序代码；我的意思是，即使你在表面上使用类，它仍然可以是程序性的。

OO 背后的思想是状态的抽象。不是根据“数据分组”来“思考”，而是根据“对象”来“思考”，其中对象是“数据分组和操作这些数据的方法”的“接口”。

这一切听起来很哲学，因为*它是*。

这里有很多要说的，在一个小的SO帖子中不能全部说完，所以我就放在这里了。

**更新**

正如[Flanagan 的回答](https://stackoverflow.com/questions/530741/whats-the-difference-between-a-procedural-program-and-an-object-oriented-program/530919#530919)中提到的，OO 语言实现了利用这种抽象的结构。

我的意思是，从技术上讲，您可以在结构、函数和函数指针方面“破解”类和多态性。

[这是C 中的 OO](http://www.eventhelix.com/RealtimeMantra/basics/object_oriented_programming_in_c.htm)示例

* * *

## 回答 #7

> 赞同：7
> 
>             
> 
> 时间：2009-02-10T02:35:36.090

[原谅初级风格，来晚了，我累了]

程序处理数据 - 数据输入，应用一些处理，取出数据

有时，一些数据元素与其他一些数据元素相关，将它们组合成一个*数据结构*很方便，然后可以将其作为一个单元进行操作和寻址。

现在我们的程序可以将一个数据结构作为输入并改变它和/或产生另一个数据结构作为输出

偶尔我们会注意到一些程序只关心某种数据结构；将这些过程与它们的数据结构组合在一起很方便，称之为*对象*。

用于创建对象的模板称为*类*；一个对象被称为一个类的一个*实例*

我们可能会注意到一个类与另一个类非常相似，因此我们让一个类从另一个类*继承而不是复制和粘贴代码：**子类*从*超类*或“基类”继承。通过这种方式，子类可以访问超类的所有数据结构和过程，并且可以以某些方式增加或覆盖它们

如果我们礼貌地请求一个对象为我们做某事而不是直接粗暴地调用它的过程，这称为*消息传递*，即使没有实际的“消息”被传输。这里的乐趣在于许多不同类型的对象可以理解相同的消息，这导致了*多态性*的概念。例如，我们可以要求许多不同类型的文档自行打印，它们都会做出适当的响应。

通过消息传递和继承支持对象（通过或不通过类）的语言称为*面向对象*。如果没有继承，语言只是*基于对象的*。

祝你学习顺利！

* * *

## 回答 #8

> 赞同：6
> 
>             
> 
> 时间：2009-02-10T01:12:19.173

不同之处在于对象在同一位置具有过程和相关数据 - 过程语言使用“结构”（将相关数据保存在一起的东西）将数据与过程分开。实际上，您在 OO 语言中所做的任何事情都应该在结合了结构和过程的过程语言中成为可能。

主要区别在于 OO 语言赋予程序员的思维定势。

* * *

## 回答 #9

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T01:19:12.323

过程是描述程序应该做什么的不同方式之间的过程/功能/逻辑（或面向逻辑）区别（比较c，lisp和prolog）的一部分。

面向对象与另一个想法正交，并描述了一种将子程序与数据分组的方法。C++ 和 java 是具有面向对象特性的过程语言；fortran77 是一种没有面向对象特性的过程语言。Common lisp 支持面向对象；一些较旧的 lisps 没有。普通的 prolog 不支持对象，而且我无法命名一种面向逻辑的语言（我不做面向逻辑的编程，当我*有*大量空闲时间时，它在我要做的事情清单上。我几乎不做函数式编程）。

然而，正如其他人所指出的那样，正确的面向对象思维会改变您进行编程的方式，就像从过程式转换到函数式一样。

* * *

顺便说一句 - 我看到“过程”用于区分非面向对象的过程语言与其面向对象的兄弟，但我认为这是一个糟糕的用法，因为“不面向对象”缺乏一个干净的形容词。YMMV。

* * *

## 回答 #10

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T02:48:46.463

在上下文中更容易理解，请查看语言之间引入的其他抽象。

汇编语言和像 C 或 Pascal 这样的过程语言之间的一个关键区别是引入了“过程”抽象。编写汇编代码的人会创建程序，但它很难且容易出错，程序语言为您提供了使其更容易的工具。

过程语言和像 C++ 这样的面向对象语言之间的区别在于“对象”抽象。编写“c”的人经常创建概念对象[，但它很困难且容易出错](https://stackoverflow.com/questions/351733/can-you-write-object-oriented-code-in-c)，OO 语言为您提供了使其更容易的工具。

[来自 Microsoft（或 Erlang）的Sing#](http://en.wikipedia.org/wiki/Singularity_(operating_system))之类的东西将 Message/Process 抽象添加到语言中。当然，您可以在程序集、C 或 C++ 中进行消息传递和进程创建，但 Sing# 更容易。

这一切都归结为相同的机器代码，这些抽象纯粹是为了我们的大脑，而不是计算机。

* * *

## 回答 #11

> 赞同：2
> 
>             
> 
> 时间：2012-03-04T11:01:58.300

在程序化程序中，您将一个大问题分解为小问题，并将这些小问题中的每一个抽象为一个过程。这称为过程抽象。

在面向对象的程序中，您将问题分析为一些对象，以及对象之间的交互。这称为对象抽象。

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2013-02-09T07:42:39.567

不同的是

面向过程的编程 - 重视算法而不是数据。这种编程方式集中于过程，即执行特定任务和共享其数据结构的方法。它遵循自上而下的结构。

示例：帕斯卡和 C

面向对象编程 - 重视数据而不是算法。它遵循自下而上的结构。每件事都被视为一个对象。每个对象都有自己的数据结构和过程。它包括数据隐藏、多态性、封装和消息传递等特性。用户在他们的程序中使用它们时，真的不必理会这些对象内部的内容。

示例：C++ 和 Java

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T01:12:31.827

这是一个简化的答案。  

*   在真正的 OO 语言中，唯一的过程编码是在对象内部完成的。

*   C 没有对象，而 C++ 是一种支持对象的语言。另一方面，Java 一切都是对象（原语除外）。一切都是打字的。

*   线性进展发生在对象内部，但对象本身只是代码和数据的集合。

* * *

## 回答 #14

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T05:07:45.647

这取决于您如何定义 OOP。就您在对象上调用方法的类 Java OOP 而言，过程编程几乎相同。据我所知，您可以在像 C 这样的过程语言中模拟所有 OOP 原则（封装、抽象、多态性、继承）。证明是[GObject](http://library.gnome.org/devel/gobject)，在某种程度上扩展了 Objective-C，以及许多其他使用 C 的 OOP 语言实现，像 cPython。这是通过使用结构并使用函数对这些结构进行操作来完成的：

```
typedef struct {
    Object *isa;
    String *name;
    Date *birthday;
} Person;

Person *Person_new();
String *Person_name(Person *self);
void Person_setName(Person *self, String *newName);
// ... 
```

界面非常像OOP。它实际上不允许多态性，但它也是可能的。它与 Python 接口非常相似，只是属性与“方法”是分开的：

```
class Person(object):
    def __init__(self):
        self._name = ""
        self._age = datetime.datetime.now()

    @property
    def name(self):
        return self._name

    @property
    def age(self):
        return self._age 
```

我选择 Python 作为示例是因为“self”是显式的，就像在 C 示例中一样。许多 OOP 语言，如 Java，都抽象了这一点。

还有类似于 Smalltalk 的 OOP，其中消息被发送到对象，而不是调用对象上的方法。乍一看，差异很微妙，但它提供了很多功能和灵活性。正如 Objective-C 所证明的，这也可以在过程语言中实现。

面向对象编程不一定是一种语言，而是一种范式。Java、Python、Ruby等面向对象的语言提供语法糖来方便地操作对象，这是“过程语言”和“面向对象语言”的主要区别。

事实上，一个库，或者更确切地说是一组在结构上运行的函数，与 C++ 中的对象相同。事实上，C++ 就是以这种方式实现的。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T01:42:26.200

这里已经提到了很多有趣的点。

一种思考方式是，在 OO 中，您有“对象”的概念，即具有它们固有的特征和行为的事物。它们通常具有某种公共“接口”，它提供了一种机制来检索有关它们的某些信息，但是对象本身，或者更确切地说它的“类”，限制了哪些信息是公开可用的。对象的内部不会暴露给公众，因为通常不需要知道对象“引擎盖下”的肮脏细节。所以面向对象的程序利用了这个结构，以及其他的东西。

过程式编程通常不会利用这种将数据和行为耦合到“对象”中的方式。我以前在 C 中看到过它，但它并不漂亮，而且涉及太多的猴子业务，无法估计一个人可以用 C++ 做些什么。

面向对象开发背后的一个想法是，我不应该通过您提供的方式以外的任何方式来处理您的数据。如果你只为我提供一个经过深思熟虑的界面，你可以让我诚实。现在，如果您使用的是程序方法，并且您向我发送了一个没有内置保护的结构，那么我可以为所欲为，如果我是愚蠢或邪恶的，我可以更改您可能不希望我做的事情改变。  

当然，如果你很聪明，你可以绕过这个对象，但你必须不遗余力地做到这一点。

这并不完整，但这是一方面。

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T01:42:27.823

C++ 的实现方式使 OO 编程看起来很像过程编程。你需要稍微改变一下你的想法。

在 C++ 中，对象的方法只是作用于对象的过程。但是在真正的 OO 范式中，您应该将方法视为对象可以接收的潜在消息（即字母）。对象接收一条消息（参数表示消息的有效负载，即信件的内容）并根据消息改变其状态。

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T05:20:35.350

有关程序和 OO 之间区别的一个相当直接的示例，请尝试学习 Smalltalk。在 Smalltalk 中，一切，我的意思是一切都是对象。没有 if 语句或 while 循环。您可以通过向其他对象发送消息（也就是调用方法）来实现该功能。一开始它真的让你头晕目眩，但我想你很快就会理解 OO 应该是什么。

# asp.net - 是否可以序列化或创建 System.Web.UI.Page 项？

> ID：530745
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-10T01:10:56.633
> 
>         
> 
> 标签：asp.net

我有一个方法，它将 System.Web.UI.Page 作为输入并返回一些特定于应用程序的详细信息（它是什么“类型”的页面，如果某些项目在查询字符串中，等等......）。要对此运行单元测试，我试图创建一个 System.Web.UI.Page 项（在代码中我只能发送 this.Page）。

第一次尝试：序列化 - 我尝试将页面序列化为文件，然后反序列化以创建标准测试页面。收到许多关于无法序列化页面的错误。反正有没有将该对象写入文件？

第二次尝试：new Page() - 我试图创建页面并设置我感兴趣的项目，但我感兴趣的所有项目似乎都是只读的（没有设置器）。有没有办法以编程方式创建 System.Web.UI.Page？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T03:13:09.260

为什么不使用模拟框架模拟 Page 类？这正是模拟所使用的场景类型。我个人喜欢[起订量](http://code.google.com/p/moq/)。

# java - 自动计算 JTable 中的列宽

> ID：530752
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-10T01:15:50.070
> 
>         
> 
> 标签：java, jtable, column-width

这个的首选方式是什么（基于我相信的标题和内容宽度）？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T01:28:30.010

Java Developer Almanac 包含一些[很好的示例代码](http://www.exampledepot.com/egs/javax.swing.table/PackCol.html)，用于根据列宽打包表格，这可能是一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T02:15:48.633

标题和内容宽度，包括字符和字体。对于 14 点无衬线字体，您需要比 8 点更宽的列。

# linq-to-sql - 如何使用 Linq-2-Sql 匹配集合

> ID：530760
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-10T01:20:47.093
> 
>         
> 
> 标签：linq-to-sql

我试图弄清楚如何做到这一点，但我很难过。我敢肯定这是我只是想念的简单东西。

假设我有一个包含名称集合的表，我想检查这些名称的子集是否存在，如下所示：

```
var names = new List{ "John", "Steven", "Mary"};
var dbNames = from n in Db.Names
              where n.FirstName == //names ???; 
```

有没有办法做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T01:31:28.707

```
where names.Contains(n.FirstName) 
```

尽管您必须注意调用它的类型——某些 Contains 方法不会被转换为 LINQ-to-SQL。您可能需要先将其转换为 IEnumerable 或 IQueryable 或其他内容。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T02:24:34.460

如果要查看数据库中是否存在整个集合，则应使用 Intersect()。

```
var names = new List<string> { "John", "Steven", "Mary" };
var dbNames = Db.Names.Select( n => n.FirstName)
                      .Distinct();
bool isSubset = dbNames.Intersect( names ).Count() == names.Count; 
```

您希望交叉点的大小与第二组的大小相同。如果是这种情况，那么第二组是第一组的子集。

# php - 如何将会话数据反序列化为 PHP 中的任意变量？

> ID：530761
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-02-10T01:21:16.360
> 
>         
> 
> 标签：php, session, serialization

我想将`session_encode()`'d 会话数据字符串反序列化到我自己的数组中（即不是`$_SESSION`。）

似乎没有处理此问题的内置函数。有`session_decode()`，但它直接写入`$_SESSION`超级全局。有`unserialize()`，但它在`session_encode()`'d 字符串上返回 false，因为它们的格式略有不同。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：20
> 
>             
> 
> 时间：2012-03-23T17:27:39.997

我注意到手动解码会话的已发布解决方案（在 php.net 上）并不完美，因此我提供了一个更强大的解决方案。

preg_match 解决方案永远无法工作。找到可能破坏反序列化的案例并不难。在 jason-joeymail 的情况下，中断：

```
$_SESSION["test"] = ";oops|"; 
```

您可以在下面找到我的解决方案。它不使用正则表达式，而是序列化操作的可逆性和序列化的“功能”在它认为完成时会忽略所有进一步的输入。这绝不是一个漂亮或特别快速的解决方案，但它是一个更强大的解决方案。我为“php”和“php_binary”添加了一个反序列化器。为“wddx”添加一个应该很简单。

```
class Session {
    public static function unserialize($session_data) {
        $method = ini_get("session.serialize_handler");
        switch ($method) {
            case "php":
                return self::unserialize_php($session_data);
                break;
            case "php_binary":
                return self::unserialize_phpbinary($session_data);
                break;
            default:
                throw new Exception("Unsupported session.serialize_handler: " . $method . ". Supported: php, php_binary");
        }
    }

    private static function unserialize_php($session_data) {
        $return_data = array();
        $offset = 0;
        while ($offset < strlen($session_data)) {
            if (!strstr(substr($session_data, $offset), "|")) {
                throw new Exception("invalid data, remaining: " . substr($session_data, $offset));
            }
            $pos = strpos($session_data, "|", $offset);
            $num = $pos - $offset;
            $varname = substr($session_data, $offset, $num);
            $offset += $num + 1;
            $data = unserialize(substr($session_data, $offset));
            $return_data[$varname] = $data;
            $offset += strlen(serialize($data));
        }
        return $return_data;
    }

    private static function unserialize_phpbinary($session_data) {
        $return_data = array();
        $offset = 0;
        while ($offset < strlen($session_data)) {
            $num = ord($session_data[$offset]);
            $offset += 1;
            $varname = substr($session_data, $offset, $num);
            $offset += $num;
            $data = unserialize(substr($session_data, $offset));
            $return_data[$varname] = $data;
            $offset += strlen(serialize($data));
        }
        return $return_data;
    }
} 
```

用法：

```
Session::unserialize(session_encode()); 
```

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-02-10T01:28:21.773

查看 PHP 手册[`session_decode`](http://us.php.net/session_decode)页面中的注释。它有一堆用户函数来`session_encode`手动处理字符串解码。据我所知，这是唯一的出路。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2014-02-24T16:44:08.567

上面的自定义 'php' 反序列化函数可以通过避免使用“增量偏移”方法来逐渐消耗输入会话字符串，从而变得更简洁。

我没有检查它在速度方面的比较，但它肯定更整洁（并且在 while 循环中保存了对 strlen 的重复调用）

```
$r = array();
while ($i = strpos($str, '|'))
{
    $k = substr($str, 0, $i);
    $v = unserialize(substr($str, 1 + $i));
    $str = substr($str, 1 + $i + strlen(serialize($v)));
    $r[$k] = $v;
}
return $r; // session data are now in a normal array 
```

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2017-01-20T13:59:29.643

根据[http://php.net/manual/session.configuration.php#ini.session.serialize-handler](http://php.net/manual/session.configuration.php#ini.session.serialize-handler)你可以设置

```
session.serialize_handler = php_serialize 
```

然后你可以使用 php 的 serialize() / unserialize() 函数。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2014-09-20T02:53:01.913

这对我有用：

```
/* storre current session */
$current_session = session_encode(); 

/* extract $other_user_session from file or database,
   into the $_SESSION global variable */
session_decode($other_user_session); 

/* use the other user session data:  $something = $_SESSION['something']; */

/* restore previous sesison info */
session_decode($current_session); /* current $_SESSION restored */ 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2016-03-31T03:48:30.150

```
function data_session_decode($data){
    $data = array_filter(explode(';',$data));
    $list_data = array();
    foreach($data as $key => $dat){
        if(!empty($dat)){
          $data[$key] = array_filter(explode('|',$dat));
          if(substr($data[$key][1], 0, 1) == 'i'){
              $list_data[$data[$key][0]] = strstr($data[$key][1], ':');
              $list_data[$data[$key][0]] = substr($list_data[$data[$key][0]], 1);
          }elseif(substr($data[$key][1], 0, 1) == 's'){
              $list_data[$data[$key][0]] = strstr($data[$key][1], '"');
              $list_data[$data[$key][0]] = substr($list_data[$data[$key][0]], 0, -1);
              $list_data[$data[$key][0]] = substr($list_data[$data[$key][0]], 1);
          }else{
              unset($data[$key]);
          }
        }
    }
    unset($data);
    return $list_data;
} 
```

// 这里是数据会话 EX:

$dataSession = 'user_name|s:8:"你的名字";date|i:1459396063';

//出去

print_r($this->data_session_decode($dataSession));

* * *

## 回答 #7

> 赞同：-9
> 
>             
> 
> 时间：2009-02-10T01:41:20.307

你为什么不做这样的事情？

```
$myVariable = serialize($_SESSION);
$sessionCopy = unserialize($myVariable); 
```

祝你好运！

# wpf - 具有透明窗口和远程桌面的 WPF 应用程序导致弹出窗口

> ID：530766
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-10T01:24:03.203
> 
>         
> 
> 标签：wpf, transparency, contextmenu, remote-desktop

我有一个带 AllowsTransparency="True" 的 WPF 应用程序，因为我们喜欢时髦的边框。

当我将桌面远程连接到计算机并运行我们的应用程序时，文本框中的菜单和右键单击菜单会在应用程序后面弹出。我通过使背景半透明来验证这一点。这是一个屏幕截图：

[http://i662.photobucket.com/albums/uu345/jpchow26/popunder.png](http://i662.photobucket.com/albums/uu345/jpchow26/popunder.png)

我们在 XP SP3 上使用 .net 3.5 SP1。我读过一些博客文章，这应该通过渲染来修复一些问题，但这对我们来说是一个错误。任何人都知道任何解决方案，还是我对此不走运？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-11T12:34:33.967

您不应该使用 AllowsTransparency="True"，它会导致很多奇怪的错误和性能不佳，如果您想要时髦的边框，您应该使用旧方法 - 通过互操作调用 SetWindowRgn。

阅读[http://blogs.msdn.com/wpfsdk/archive/2008/09/08/custom-window-chrome-in-wpf.aspx](http://blogs.msdn.com/wpfsdk/archive/2008/09/08/custom-window-chrome-in-wpf.aspx)

查看标题为“没有 Aero 的 Office 2007 – 或者，您对一切负责”部分的末尾。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-13T21:50:27.603

[在此 MSDN 帖子](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/333d3d93-8837-42b3-a0ea-1a577485daed/)中讨论了与在其父窗口后面弹出的控件相关的已知错误。文章中提到了 XP 的修补程序，但有些人在应用此修补程序后仍会遇到此问题。

# jquery - Jquery手风琴插件

> ID：530769
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-10T01:27:16.737
> 
>         
> 
> 标签：jquery, header, icons, accordion

我正在使用 Jquery 手风琴插件。我需要使用自己的标题图标，根据文档，我需要使用背景图像创建 css 类。

所以我在我的css文件中做了这个。

```
.normal_arrow {
    background : url(../images/arrowonly.jpg);
}

.circle_arrow {
    background : url(../images/circle_arrow.jpg);
}

.circle_arrow_down {
    background : url(../images/circle_arrow_down.jpg);
} 
```

然后在javascript中：

```
$("#accordion").accordion({
    header: "h3",
    clearStyle: true,
    autoHeight: false,
    icons: {
        header: "normal_arrow",
        headerSelected: "circle_arrow_down"               
    }
}); 
```

但没有箭头出现。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2011-07-04T00:29:36.127

同样的问题，我不得不使用 position:absolute; 使图标容器具有宽度和高度。

```
.normal_arrow {
    background : url(../images/arrowonly.jpg);
    position: absolute;
    width: 10px;
    height: 10px
} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T01:37:36.883

您的代码看起来正确。

尝试使用`background-image:`而不是`background:`

还可以使用一种工具[`Firebug`](http://getfirebug.com/)来绝对确保亲属路径朝着您认为的方向前进。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2011-01-26T13:15:01.340

使用`!important`：

```
.normal_arrow {
    background : url(../images/arrowonly.jpg) !important;
} 
```

因为您需要覆盖默认样式。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T16:14:07.933

在 CSS 中使用 background-image 而在 JavaScript 中，您需要将 header 和 headerSelected 放在引号中。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-05-28T16:19:12.947

背景使用不当。为此渲染可能使用

```
background-image: url(../images/circle_arrow.jpg); 
```

**或者**

```
background: transparent url(../images/circle_arrow.jpg) top left no-repeat; 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2011-09-12T16:27:28.877

**注意：**这仅适用于不使用任何 jquery 样式的用户。（即）您没有在文件中包含 jquery 的 css。

CSS 中的默认样式是这样的：

```
.ui-icon { display: none; text-indent: -99999px; overflow: hidden; background-repeat:  no-repeat; } 
```

所以如果你设置了一个带有背景图片，宽度和高度的div，但它仍然不会显示，这是因为上面的类。

将此添加到您的文档中：

```
<style type="text/css">
.ui-icon { display: block; }

</style> 
```

# browser - JavaFX 不会加载到我的网页上

> ID：530775
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-10T01:30:06.433
> 
>         
> 
> 标签：browser, javafx, jnlp

我意识到这是一个非常模糊的问题，所以我不是在寻找细节，只是建议......

我在 NetBeans 中编写了一个 JavaFX 应用程序，它自动将它构建到一个 jar、jnlp 和 html 页面中。将这些文件上传到我的网络服务器后，我可以导航到页面并且一切正常，*在我开发它的计算机上*。在任何其他计算机上，它只是挂在加载屏幕上（旋转动画）。我尝试过的事情：

*   确保这些计算机具有最新的 JRE

*   在 Chrome 和 IE 中都试过了

*   将所有文件设置为所有用户的 RWX 权限（我已经撤消了这个）

有任何想法吗？

谢谢！

此外，如果它很重要，JavaFX 应用程序的链接就在[这里](http://www.rossallenbell.com/funstuff/RABfx/RABfx.html)。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T03:28:19.643

原来是因为我使用的是 NetBeans 生成的 JNLP。看看[这篇文章](http://www.dieajax.com/2008/12/19/10-minute-javafx-tutorial-deploy-javafx-applets-and-applications-both-online-and-offline/)。它准确地描述了我遇到的问题以及如何解决它，朝向底部。简而言之，您会注意到 JNLP 有一些名为“codebase”和“href”的属性，一旦将执行文件从 NetBeans 项目移动到 Web 服务器，它们就不再有效。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T03:00:27.013

我有“永远旋转”的轮子。

你看过浏览器启动的JVM的控制台吗？我在 XP 上运行 FF3，在任务栏中我有 Java-Icon，右键单击我可以打开控制台，它给了我：

```
Exception: null
java.io.FileNotFoundException: JNLP not available: RABfx_browser.jnlp
    at sun.plugin2.applet.JNLP2Manager.loadJarFiles(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Exception: java.io.FileNotFoundException: JNLP not available: RABfx_browser.jnlp 
```

JVM 是 1.6.0_11 。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T01:46:42.353

它对我来说很好。我注意到的一件事是有一个安全检查对话框（信任来自 Sun 的内容？）和一个 Sun 广告说 JavaFX 有多棒:-)。

**确保这些不会在您的浏览器窗口后面**启动- 在您信任内容之前它不会继续运行，我之前已经看到过这种行为。

否则，我怀疑这是您浏览器中的安全（或其他）设置。FWIW，我使用的是 Firefox 3.0.5 和最近下载的 Sun JRE 1.6._03（我认为）。

即使在难度级别 2 下，它也不是很聪明。左上角的玩家，电脑的中心，右下角的玩家，“电脑到角落”总是会导致玩家获胜（除非他们以某种方式缺乏井字游戏）。上述引文中计算机的正确移动是优势之一。但我很确定你不想让我批评你的 AI :-)。

# c# - 将关联数组传递给方法的简洁方法

> ID：530782
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-10T01:36:24.810
> 
>         
> 
> 标签：c#, silverlight, associative-array, parameter-passing

寻找一种将关联数组传递给方法的方法。我正在寻找用 C# 重写一个 Actionscript 补间包，但遇到了“关联”数组/对象的问题。通常在 Actionscript 中，我可能会执行以下操作：

```
public function tween(obj:DisplayObject, params:Object = null):void {
    if (params.ease != null) {
        //do something
    }
    //...
} 
```

这可以称为：

```
tween(this, {ease:'out', duration:15}); 
```

我正在寻找一种在 C# 中做同样事情的方法。到目前为止，我已经收集了我的选项：

a）创建一个类或结构来定义可能的参数键和类型并传递它

b) 将参数作为泛型类型传递

```
tween(frameworkElement, new {ease = 'out', duration = 15}); 
```

假设

```
public static void tween(FrameworkElement target, object parameters); 
```

并找出一些在补间函数中使用它的方法（我不确定如何分离给定该对象的键=值。有什么想法吗？）

c) 创建一个`Dictionary<string, object>`将参数传递给补间函数

还有其他想法或示例代码吗？我是 C# 的新手。

**编辑**

花了我一整天才弄清楚：

“匿名类型不能跨程序集边界共享。编译器确保每个程序集中给定的属性名称/类型对序列最多有一个匿名类型。要在程序集之间传递结构，您需要正确定义它们。”

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T01:52:53.290

我自己是选项 (b) 的粉丝——传递一个匿名类型并使用反射解析出值。

我已经看到其他人使用 lambda 表达式实现了同样的目标。调用语法是：

```
tween(frameworkElement, ease => "out", duration => 15); 
```

声明将类似于以下内容：

```
public static void tween(FrameworkElement target, params Expression<Func<object>>[] parameters) { ... } 
```

这个想法是您可以采用可变数量的“返回对象的函数”。[然后，您从每个Expression<TDelegate>](http://msdn.microsoft.com/en-us/library/bb335710.aspx)中解析出参数的名称，并调用每个来获取其值。

我不认为这比反映匿名类型更好，但这是另一种需要考虑的方法。

**更新**

[实际上，我已经在我的博客here](http://www.madprops.org/blog/named-parameters-in-c-4-0/)和[here](http://msdn.microsoft.com/en-us/library/bb335710.aspx)上写过将关联数组作为字典传递的想法。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T01:53:05.973

字典是一种合理的方法。它可能看起来像这样：

```
public static void tween(FrameworkElement target, IDictionary<string, object> parameters)
{
    if (parameters.ContainsKey("ease")) {
        //do something
    }
} 
```

请注意，当您传入值时，可以使用缩短的集合初始化语法使其更容易，例如：

```
tween(something, new Dictionary<string, object> { { "ease", "out" }, { duration, 15 } }); 
```

这将是一种非常快速的方式来完成与 ActionScript 代码大致“相同的事情”，但它并不是真正出色的 C#。C#-ish 的方法是创建一个真正的 TweenParameters 结构或类，为每个可能的参数提供属性，然后创建一个传递给 tween()。这通常被认为更易于维护，因为所有“可用”属性对于调用者来说都是显而易见的，而无需查看 tween() 的内部结构，并且因为它在编译时捕获错误，字符串比较直到运行时才会注意到，例如拼写“持续时间”“duratoin”。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T02:11:49.733

**编辑**：这基本上是 HtmlHelper 扩展在 ASP.NET MVC 中使用的机制。这不是我原创的。

* * *

我更喜欢具有两个不同签名的混合方法。注意：我没有尝试过，两个签名之间可能存在冲突，因此您可能必须给第二种方法一个稍微不同的名称，以允许编译器在它们之间进行选择，但我不这么认为。

```
public static void tween( FrameworkElement target, object parameters )
{
    return tween( target, new ParameterDictionary( parameters ) );
}

public static void tween( FrameworkElement target,
                          ParameterDictionary values )
{
    if (values.ContainsKey( "ease" ))
    {
      ....
    }
} 
```

然后你有一个 ParameterDictionary 类，它使用匿名类型的反射并设置字典。

```
public class ParameterDictionary : Dictionary<string,object>
{
    public ParameterDictionary( object parameters )
    {
         if (parameters != null)
         {
             foreach (PropertyInfo info in parameters.GetType()
                                                     .GetProperties())
             {
                 object value = info.GetValue(parameters,null);
                 this.Add(info.Name,value);
             }
         }
    }
} 
```

这为您提供了易用性和易用性——“丑陋”的反射内容被包裹在字典的单个构造函数中，而不是在您的方法中。而且，当然，字典可以反复用于类似的目的，而反射代码只写一次。

# gwt - 将数据从 Javascript 加载到 GWT

> ID：530792
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-10T01:43:39.503
> 
>         
> 
> 标签：gwt

几天来我一直在尝试执行以下操作，但无济于事：

我有一个 GWT 应用程序，它在启动时进行多次 RPC 调用以加载初始数据。在大多数情况下，这些数据是相对静态的，所以如果可以的话，我会跳过 RPC 调用。但是数据的变化比应用程序更频繁，所以我宁愿在编译时不包括它。

相反，我获取数据并将其以 JSON 格式存储在一个静态 .js 文件中。我将其包含在应用程序的加载 HTML 中：

html ... GWT 正在加载东西...>

script src="staticstuff.js">/script> //这是故意错误的，因此它将显示在stackoverflow html上，静态内容如下：

var 启动数据 = [JSON.....];

然后，在应用程序本身中，我们执行以下操作：

```
private native JsArrayString getStaticData()/*-{
    return $wnd.startupdata;
}-*/; 
```

当我们的数据是数组、字符串或其他一些 JS 原生对象时，这非常有效。我似乎不能做的是以下几点：

```
private native OurMoreComplexObject getStaticData()/*-{
    return $wnd.startupdata;
}-*/; 
```

我可以拉回 js 对象并自己将它们解析到我的对象图中，但我不希望这样做，特别是因为 GWT 已经为我创建了一个转换器（因为 OurMoreComplexObject）已经在 RPC 调用中返回。

有没有人尝试过这样的事情？如果是这样，我该如何让它工作？还有其他方法可以做到这一点吗？（主要目标是如果数据存储在文件中，我可以将其加载到我们的 CDN 上，而不是每次启动时都强制回调到我们的服务器）

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T06:43:36.303

是的（这是我经常做的事情）：

[http://wiki.shiftyjelly.com/index.php/GWT#Speed_up_Page_Loading.2C_by_pre-serializing_your_GWT_calls](http://wiki.shiftyjelly.com/index.php/GWT#Speed_up_Page_Loading.2C_by_pre-serializing_your_GWT_calls)

它的基本原理是您在服务器呈现页面时进行调用，并让 GWT 将其序列化为正常的 RPC 形式，并将其存储在页面中的 javascript 变量中。从那里您可以阅读它。希望上面的链接应该为您提供足够的详细信息。

主要好处是您的客户端以 HTML/js 格式获取页面，并且不需要进行 AJAX 调用来获取更多数据。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-13T01:12:16.143

如果您想坚持使用 JSON（而不是序列化 RPC 响应），则可以使用 JavaScriptObject 包装器，即 JSO。这是从 JSON 获取复杂对象图的好方法，无需编写一堆编组代码。它遵循以下模式：

```
startupData = { "someProperty" : "someValue", "someList" : [ { "more", "json" } ] };

public class OurMoreComplexObject extends JavaScriptObject {
    protected OurMoreComplexObject() {}

    public native String getSomeProperty() /*-{
        return this.someProperty;
    }-*/;

    public native JSArray getSomeList()  /*-{
        return this.someList;
    }-*/;
} 
```

好消息是它具有半神奇的特性，因为您的“getStaticData”方法可以正常工作。坏消息是您不能像对待 POJO 那样轻松对待这些 JSO。处理列表迭代（通过 JSArray）可能会特别痛苦。

[你可以在这里](http://googlewebtoolkit.blogspot.com/2008/08/getting-to-really-know-gwt-part-2.html)查看更多。

# c# - 将方法/属性标记为虚拟对性能有何影响？

> ID：530799
> 
>         
> 
> 赞同：68
> 
>         
> 
> 时间：2009-02-10T01:49:24.717
> 
>         
> 
> 标签：c#, performance, virtual

问题如标题中所述：将方法/属性标记为虚拟的性能影响是什么？

注意 - 我假设虚拟方法在常见情况下*不会*被重载；我通常会在这里使用基类。

* * *

## 回答 #1

> 赞同：150
> 
>             
> 
> 时间：2009-02-10T01:58:16.740

与直接调用相比，虚函数只有很小的性能开销。在低级别，您基本上是在查看数组查找以获取函数指针，然后通过函数指针进行调用。现代 CPU 甚至可以在其分支预测器中相当好地预测间接函数调用，因此它们通常不会对现代 CPU 管道造成太大伤害。在汇编级别，虚函数调用转换为如下内容，其中`I`是任意立即值。

```
MOV EAX, [EBP + I] ; Move pointer to class instance into register
MOV EBX, [EAX] ;  Move vtbl pointer into register.
CALL [EBX + I]  ;   Call function 
```

比。以下是直接函数调用：

```
CALL I  ;  Call function directly 
```

真正的开销在于虚拟函数在大多数情况下无法内联。（如果 VM 意识到它们总是会去同一个地址，它们可以是 JIT 语言。）除了内联本身获得的加速之外，内联还支持其他一些优化，例如常量折叠，因为调用者可以知道被调用者如何在内部工作。对于大到不能被内联的函数，对性能的影响可能可以忽略不计。对于可能被内联的非常小的函数，这时您需要注意虚函数。  

编辑：要记住的另一件事是，所有程序都需要流量控制，而这绝不是免费的。什么会取代你的虚拟功能？一个switch语句？一系列 if 语句？这些仍然是可能无法预测的分支。此外，给定一个 N 路分支，一系列 if 语句将在 O(N) 中找到正确的路径，而虚函数将在 O(1) 中找到它。switch 语句可能是 O(N) 或 O(1)，这取决于它是否优化为跳转表。

* * *

## 回答 #2

> 赞同：16
> 
>             
> 
> 时间：2009-02-10T02:05:51.370

[Rico Mariani 在他的Performance Tidbits 博客](http://blogs.msdn.com/ricom/archive/2004/08/24/219751.aspx)中概述了有关性能的问题，他在其中指出：

> **虚拟方法：**  当直接调用可以使用时，您是否使用虚拟方法？很多时候，人们使用虚拟方法来实现未来的可扩展性。可扩展性是一件好事，但它确实是有代价的——确保你的完整的可扩展性故事已经完成，并且你对虚函数的使用实际上会让你到达你需要的地方。例如，有时人们会考虑调用站点的问题，但不会考虑如何创建“扩展”对象。后来他们意识到（大部分）虚函数根本没有帮助，他们需要一个完全不同的模型来将“扩展”对象引入系统。
> 
>   
>   
> 
> **密封：**密封可以将类的多态性限制在需要多态性的那些位点。如果您将完全控制类型，那么密封对于性能来说可能是一件好事，因为它支持直接调用和内联。

基本上反对虚拟方法的论点是它不允许代码成为内联的候选者，而不是直接调用。

在 MSDN 文章[Improvement .NET Application Performance and Scalability](http://msdn.microsoft.com/en-us/library/ms998547.aspx)中，进一步阐述了这一点：

> **考虑虚拟会员的权衡**
> 
>   
>   
> 
> 使用虚拟成员提供可扩展性。如果您不需要扩展您的类设计，请避免使用虚拟成员，因为由于虚拟表查找，调用它们的成本更高，并且它们会破坏某些运行时性能优化。例如，编译器不能内联虚拟成员。此外，当您允许子类型化时，您实际上向消费者提供了一个非常复杂的合同，并且当您将来尝试升级您的类时，您不可避免地会遇到版本控制问题。

然而，对上述内容的批评来自 TDD/BDD 阵营（他们希望方法默认为虚拟），他们认为无论如何性能影响都可以忽略不计，尤其是当我们可以访问速度更快的机器时。

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2009-02-10T02:01:00.663

通常，虚拟方法只需通过一个函数表指针即可到达实际方法。这意味着一个额外的取消引用和一个更多的内存往返。

虽然成本不是绝对零，但它非常小。如果它有助于您的程序具有虚拟功能，那么一定要这样做。

拥有一个设计精良、性能影响很小、很小、很小的程序要比仅仅为了避免 v-table 而设计一个笨拙的程序要好得多。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T02:04:21.607

很难确定，因为 .NET JIT 编译器可能能够在某些（很多？）情况下优化开销。

但如果它不优化它，我们基本上是在谈论一个额外的指针间接。

也就是说，当你调用一个非虚方法时，你必须

1.  保存寄存器，生成函数 prologue/epilogue 以设置参数，复制返回值等。

2.  跳转到一个固定的、静态已知的地址

1 在这两种情况下是相同的。至于 2，使用虚拟方法，您必须改为从对象的 vtable 中的固定偏移量读取，然后跳转到该点的任何位置。这使得分支预测更加困难，并且可能会将一些数据推出 CPU 缓存。所以差异不是很大，但如果你让每个函数调用都是虚拟的，它可以加起来。

它还可以抑制优化。编译器可以轻松地内联对非虚拟函数的调用，因为它确切地知道调用了哪个函数。使用虚函数，这有点棘手。一旦确定调用了哪个函数，JIT 编译器可能仍然能够做到这一点，但工作量要大得多。

总而言之，它仍然可以加起来，尤其是在性能关键领域。但这不是您需要担心的事情，除非该函数每秒至少调用几十万次。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T01:56:46.913

从你的标签，你说的是 c#。我只能从德尔福的角度回答。我认为这将是相似的。（我在这里期待负面反馈:)）

静态方法将在编译时链接。虚拟方法需要在运行时查找来决定调用哪个方法，因此开销很小。只有当方法很小并且经常调用时，它才有意义。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T02:05:37.143

[我在 C++ 中运行了这个测试](http://assemblyrequired.crashworks.org/2009/01/19/how-slow-are-virtual-functions-really/)。虚函数调用（在 3ghz PowerPC 上）比直接函数调用要长 7-20 纳秒。这意味着它只对您计划每秒调用一百万次的函数，或者对于那些很小以至于开销可能大于函数本身的函数才重要。（例如，出于盲目的习惯将访问器函数设为虚拟可能是不明智的。）

我还没有在 C# 中运行我的测试，但我希望那里的差异会更小，因为 CLR 中的几乎每个操作都涉及间接操作。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:00:14.550

在桌面端，方法是否重载并不重要，它们会通过方法指针表（虚拟方法表）产生额外的间接级别，这意味着在方法调用比较之前通过间接读取大约 2 个额外的内存非密封类和非最终方法上的非虚方法。

[有趣的事实是，在紧凑框架版本 1.0 上，过热更大，因为它不使用虚拟方法表，而只是通过反射来发现调用虚拟方法时要执行的正确方法。]

此外，与非虚拟方法相比，虚拟方法不太可能成为内联或其他优化（如尾调用）的候选者。

大致这是方法调用的性能层次结构：

非虚方法 < Virtual Metods < 接口方法（在类上） < 委托调度 < MethodInfo.Invoke < Type.InvokeMember

**但是，除非您通过测量来**证明，否则各种调度机制的这些性能影响都无关紧要；）（即使这样，架构影响、可读性等也可能对选择哪一个有很大的影响）

# c# - 这个简单的 C# 代码会导致堆栈溢出吗？

> ID：530802
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-10T01:51:34.353
> 
>         
> 
> 标签：c#, stack-overflow

我有一个主要将字符串记录到文本文件的类库。它的方法之一是 LogString(string str) 所以我只是想知道基于下面的函数，如果我多次调用它，比如超过 600 次，它会导致 stackoverflow 吗？

```
 public void LogString(string str)
    {  
        try
        {
            if (filePathFilenameExists())
            {
                using (StreamWriter strmWriter = new StreamWriter(filePathFilename, true))
                {
                    strmWriter.WriteLine(str);
                    strmWriter.Flush();
                    strmWriter.Close();
                }
            }
            else
            {
                MessageBox.Show("Unable to write to file");
            }
        }
        catch (Exception err)
        {
            string errMsg = err.Message;
        }

    } 
```

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-10T01:54:01.413

这甚至看起来都不是递归函数。我不明白这会如何导致堆栈溢出。

为了溢出堆栈，您必须不断地从函数内部调用函数。每次执行此操作时，都会使用更多的堆栈空间来在被调用函数返回时恢复调用函数。递归函数会遇到这个问题，因为它们需要存储同一函数状态的多个副本，每个递归级别一个。这也可能发生在相互递归的函数中（A 调用 B，B 调用 A），并且可能更难检测，但我认为这里不是这种情况。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T01:57:46.133

不，它不会导致堆栈溢出，但如果两个不同的线程尝试写入同一个文件，它可能会导致其他异常。如有必要，请考虑使用`lock`使其成为线程安全的。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T04:13:09.660

[@Franci Penov 提供了很好的建议](https://stackoverflow.com/questions/530802/could-this-simple-c-code-result-in-a-stack-overflow/530913#530913)。

请阅读[Raymond Chen 的这篇文章](http://blogs.msdn.com/oldnewthing/archive/2009/01/07/9286576.aspx)。

它巧妙地解释了*为什么*堆栈溢出异常指向的函数不是罪魁祸首。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T02:46:32.363

如果你真的想找到你的罪魁祸首，你需要在调用堆栈中再深入一点，看看它上面还有哪些其他函数。更准确地说，寻找重复的痕迹。

获取堆栈溢出异常的另一种方法是，如果您的代码在堆栈上分配了大块内存。您是否碰巧在代码中的某处处理大型结构？

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:05:59.060

您是在问*它*是否会导致 stackoverflow 或为什么会导致 stackoverflow？

Stackoverflows（通常）在递归出现轻微错误时发生。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:06:57.810

响应[OP 的更新](https://stackoverflow.com/questions/530802/could-this-simple-c-code-result-in-a-stack-overflow/530824#530824)：问题可能出在*调用者*方法上，而不是`LogString()`本身。如果调用者方法确实是递归方法，那么如果分配的堆栈大小不够大，肯定存在堆栈溢出的风险。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:07:04.440

调用此函数不会导致“堆栈溢出”。您只能通过递归调用自身的函数导致堆栈溢出。我将简要解释一下：

当您在程序中调用函数时，它会在“调用堆栈”上创建一个新条目。这包含有关当前函数、调用它的位置以及函数的局部变量的一些信息。正如我所说，这个条目是在你调用函数时创建的，但是当你从函数返回时，抛出异常，或者只是让函数到达它的结尾，系统会使用该信息返回到上一个执行点，然后从调用堆栈*中删除该条目。*

所以，在你调用你的函数之前，你可能在堆栈上：

```
.                           .
.                           .
.                           .
|                           |
+---------------------------+
| performComplexOperation() |
| return address            |
| local variables           |
| ...                       |
+---------------------------+ 
```

然后，您调用该`LogString`函数：

```
.                           .
.                           .
.                           .
|                           |
+---------------------------+
| performComplexOperation() |
| return address            |
| local variables           |
| ...                       |
+---------------------------+
| LogString()               |
| return address            |
| local variables           |
| ...                       |
+---------------------------+ 
```

但`LogString`完成后，代码将返回`performComplexOperation`使用返回地址。LogString 的条目将被删除：

```
.                           .
.                           .
.                           .
|                           |
+---------------------------+
| performComplexOperation() |
| return address            |
| local variables           |
| ...                       |
+---------------------------+
       (this is where
    LogString used to be) 
```

在堆栈溢出中，堆栈上的条目占用的空间将超过您正在使用的语言为堆栈分配的空间*，并且程序将无法为您正在使用的函数创建条目打电话。

* 不完全是，但足够接近。

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:10:55.803

我能想到的唯一问题是，如果你在这个函数中发生了一些疯狂的事情，你没有列出**filePathFilenameExists()的代码**

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:17:55.710

这是 Sean 认为是递归的函数 filePathFileNameExists。

```
 public bool filePathFilenameExists()
    {
        if (File.Exists(filePathFilename))
        {
            return true;
        }
        else
        {
           MessageBox.Show("Can not open Existing File.");
           return false;
        }
    } 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:19:26.097

```
 public bool filePathFilenameExists()
    {
        if (File.Exists(filePathFilename))
        {
            return true;
        }
        else
        {
           MessageBox.Show("Can not open Existing File.");
           return false;
        }
    } 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:46:43.160

这里还有一些有趣的地方，因为您发布的代码基本上不可能导致堆栈溢出。

*   抛出堆栈溢出异常时，调用堆栈的其余部分是什么样的？

*   是`filePathFileName`字段还是属性？如果它是一个属性，你是否在你的吸气剂中做任何事情？也许`LogString(String)`再打电话？

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T03:41:00.270

我认为 Paul Fisher 是对的，但这是我的第一篇文章，我没有代表对他的回答发表评论。

用我的话来说同样的理论；您的调用函数导致堆栈溢出。它将自己的副本推送到堆栈上，直到距离末端相对较短的距离。在调用函数的某些“N-1”次递归迭代中，LogString 的堆栈深度足以导致溢出，因为您将在距堆栈末端很短的距离内。filePathFilenameExists() 可能比调用函数中的大多数其他方法具有更深的最大堆栈，并且足以将 LogString 单独作为捕获异常的幸运者。

抛开理论不谈，假设从某个地方重复调用它，LogString 的输出应该会明显看出您的问题。那并在 IDE 调试器中查看您的堆栈。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-02-12T21:02:09.537

谢谢大家的投入，对喧嚣感到抱歉。这是我的错，因为我的程序有我不知道的递归。我之所以没有发现这一点，是因为在程序停止之前我没有继续跟踪调用。当最后一次调用最后一个案例场景（最后一个函数）时，我总是停止调试，直到昨晚我继续调试直到程序自行停止然后我看到有很多调用来回进行，所以基于我的小编程经验我总结就是递归。

# visual-studio - 调试 VS2003 上另一个解决方案中的 DLL

> ID：530808
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-10T01:53:01.777
> 
>         
> 
> 标签：visual-studio, visual-c++, dll, debugging, breakpoints

我正在尝试调试从 VC++ 应用程序调用的 DLL，但由于 DLL 源位于另一个解决方案项目中，因此无法进入 DLL 函数。

我试图在 DLL 函数调用之前设置一个断点，但是当我尝试介入时，它只是向下传递。

我知道可以单独调试 DLL 并为其提供参数，但由于变量很多，我认为它对于调试目的并不实用。

有没有办法调试与调用应用程序分开的 DLL，就好像它在单个解决方案文件中一样？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T01:55:55.093

您可以做的一件事是在 VS 之外启动您的应用程序，使用 DLL 打开解决方案，然后附加到应用程序。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T02:16:00.317

构建 DLL 的调试版本并在项目的调试配置中链接到它。那应该可以为您提供所需的东西。它应该找到 DLL 的源代码，并且您应该能够进入它。

# database - Delphi TeeChart 仅显示数据集中的一条记录

> ID：530820
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-10T01:57:13.793
> 
>         
> 
> 标签：database, delphi, teechart

使用 Delphi Steema TeeChart 组件，如果我使用用户界面将 BarSeries 链接到数据集，它会显示得很好，但如果我使用代码（我需要这样做），它只会显示一个栏，即使我有几条记录在数据库中。我究竟做错了什么？

代码：

```
var
   i:Integer;
   Bar:TBarSeries;
begin
   ADataSet.Close;
   ADataSet.LoadFromDataSet(mtbl);
   ADataSet.Active := true;
   ADataSet.First;
   ASource.DataSet := ADataSet;

   Bar := TBarSeries.Create(AChart);
   Bar.Assign(Series2);
   Bar.ParentChart := AChart;
   Bar.DataSource := ASource;
   Bar.XLabelsSource := 'Date';
   Bar.YValues.ValueSource := 'Load';

   for i := 0 to AChart.SeriesCount - 1 do
   begin
      AChart.Series[i].CheckDataSource;
   end; 
```

ADataSet 是一个 DevExpress MemData (TdxMemData)。当我运行程序时，X 轴只显示一个条形图，即数据集中的第一条记录，即使我在数据集中有 4 条记录。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T07:03:30.233

这段代码对我有用（使用带有字段 ID 和高度的 Access 数据库，我在表单上放置了一个 TDBChart、TADODataSet 和一个 TButton）：

```
procedure TForm1.Button1Click(Sender: TObject);  
var   
    Bar : TBarSeries;  
begin  
    ADODataSet1.Close;  
    ADODataSet1.ConnectionString := 'Provider=Microsoft.Jet.OLEDB.4.0;...';  
    Bar := TBarSeries.Create(DBChart1);  
    DBChart1.AddSeries(Bar);  
    Bar.ParentChart := DBChart1;  
    Bar.DataSource := ADODataSet1;  
    Bar.XLabelsSource := 'ID';  
    Bar.YValues.ValueSource := 'Height';  
    ADODataSet1.Active := true;  
end; 
```

请注意，数据源应该是 TTable、TQuery 或 TDataSet（不是 TDataSource - 看图！）。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T03:48:12.733

TChart 每次设置都会刷新查询

> ADataSet.Active := true;

因此，将此命令移到块的末尾（例如，在您设置系列属性之后）。

# c - printf 格式化

> ID：530825
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-10T01:59:15.770
> 
>         
> 
> 标签：c, string, printf

我想用`printf`表格来显示十六进制数字`0x###`，但如果数字为0，我想省略`0x`部分。

* * *

## 回答 #1

> 赞同：16
> 
>             
> 
> 时间：2009-02-10T02:03:49.660

```
printf("%#x", number); 
```

请注意，这**正是**您想要的。如果 number 的值为 0，则打印 0，否则以十六进制打印。例子：

```
int x = 0;
int y = 548548;

printf("%#x %#x\n", x, y); 
```

结果是：

```
0 0x85ec4 
```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T02:07:33.630

```
 printf ((x == 0) ? "%03x" : "0x%03x", x); 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T02:02:59.287

```
if (num == 0)
{
     printf("0");
}
else
{
     printf("%X", num);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-10T02:01:23.347

为什么要难？

```
如果数字 = 0
  printf 没有格式化
别的
  带格式的 printf

```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:03:56.757

难道您不能只使用 if 语句来检查数字是否为 0，然后确定是否应该将其打印为 0x### 或仅打印 000 （如果您正在寻找，则为 0）

# visual-studio-2005 - 从命令行切换 devenv 中的 3rd 方编译器

> ID：530831
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-10T02:01:35.110
> 
>         
> 
> 标签：visual-studio-2005, compiler-construction, intel

我们有一个自动构建系统，它可以构建各种 Visual Studio 2005 解决方案文件。这些解决方案包含各种 Visual C++ 和 Intel Fortran 项目。

我们正在升级我们的英特尔 Fortran 编译器，并且 Visual Studio 当前设置为与旧的英特尔编译器（9.1 版）集成。

我正在寻找一种方法来告诉 Visual Studio 使用新的 Intel Fortran 编译器（版本 11）。我需要能够告诉 Studio 仅为我们的编译器升级项目执行此操作，默认保持原样（使用 9.1 版），以便我们的标准构建可以继续而不受升级项目的影响。

有人知道这是否可能吗？即，我可以通过命令行告诉 Visual Studio 使用哪个英特尔编译器吗？

目前，我可以使用英特尔提供的批处理脚本来设置 LIB=、INCLUDE= 和 PATH= 环境变量。但是，当 Visual Studio 编译 Fortran 项目时，它使用的是 9.1 版。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-07-27T15:01:44.283

devenv.exe 的“/useenv”命令行怎么样？

```
C:\>devenv /?

Microsoft (R) Visual Studio 版本 8.0.50727.867。
版权所有 (C) Microsoft Corp 1984-2005。版权所有。

利用：
devenv [解决方案文件 | 项目文件 | anyfile.ext] [开关]
...
/useenv 使用 PATH、INCLUDE、LIBPATH 和 LIB 环境变量
                而不是 VC++ 构建的 IDE 路径。

```

# algorithm - 如何用汇编语言打印 0,2,4,6,...？

> ID：530832
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-10T02:02:04.267
> 
>         
> 
> 标签：algorithm, assembly

我有一份来自我的比赛的任务。系统组织 主题，不幸的是，在汇编语言方面我是个新手。我应该编写一个分别显示数字 0、2、4、6、8、10 的程序。我该怎么办？

也许这会回答我的问题：（请反应）

```
.model small
.stack 100H
.data
.code

call proc

mov cx,5

mov dx,0
L1:
mov bx,2
add dx,bx
mov ah,02h
loop L1
int 21
endp 
```

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-10T02:10:57.177

去看你的讲师和/或导师并寻求建议。这就是他们的目的。你没有给我们*足够*的信息来帮助你。

这就是我*认为*你的 ABCD 程序应该是什么样子的。我建议你用它作为基准来尝试制作一个 0 2 4 ... 版本。

```
 model  proc
    .stack 100H
    .data
    .call

    main   proc

    mov    cx,10     ; 10 loops only.
    mov    dx,40h    ; start dx at 'A' - 1.
L1:
    inc    dx        ; move to next character.

    mov    ah,02h    ; int 21,02 is print character.
    int    21h

    loop   L1        ; loop until cx is 0

    mov    ax,4c00h  ; int 21,4c is exit with al holding exit code.
    int    21

    endp 
```

当您至少尝试过转换时，发布代码，我们将批评您所做的事情。

如果你被教过一些东西，它永远不会持续，但是，如果你学到一些东西，它会永远持续下去（尽管有酒精中毒的脑细胞:-)。

`Int 21`是允许汇编程序使用各种 DOS 功能的 DOS 中断。从概念上讲，它是一个基于`AH`寄存器的巨大 switch 语句，这就是为什么你会看到类似的东西`Int 21 Fn 02`，这意味着执行`mov ah,2`后跟`int 21`.

`Int 21 Fn 02`将获取内容`DL`并将其输出到屏幕。所以顺序：

```
mov ah,02h
mov dl,41h
int 21h 
```

将输出“A”字符（0x41）。

同样，`Int 21 Fn 4c`将退出当前正在运行的进程。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T02:10:55.150

我相信你的班级在这里给了你*一些*教育。你能编写足够的汇编代码来打印一两个数字吗？即使您无法打印它们，您是否可以编写足够的代码来计算数字？

发布这么多代码，您可能会在这里找到帮助。

否则，您实际上是在要求其他人为您做功课。

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-02-10T02:13:18.530

汇编语言是对特定 CPU（或体系结构）进行编程所需的数字机器代码和其他常量的符号表示。因此，Mac（最近是英特尔的 X86）的汇编语言与 iPhone 上的汇编语言 - ARM 不同。

您的老师也可能希望您了解您将使用的二进制形式的数字与您将用于在屏幕上显示的 ASCII 格式之间的区别。

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-02-10T02:06:54.893

您确实知道“汇编语言”不止一种风格。  

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-02-10T02:17:26.973

您可以像打印 A、B、C、D 等的程序一样执行此操作：除了不是从“A”开始，而是从“0”开始；而不是每次增加 1（从“A”到“B”），而是增加 2（从“0”到“2”）。

在打印“0”、“2”、“4”、“6”和“8”之后，您要打印的下一个数字是“10”。

要打印“10”，您可以打印“1”后跟“0”。或者，您可以设置打印字符串（设置为包含“”的内存块） ，而不是调用`int 21`with `ah=2`（一次打印一个字符）。`ah=9``ds:dx``10$`

* * *

后来您提出了以下解决方案并要求批评：

```
.model small
.stack 100H
.data
.code

main proc

call defineuser1
call defineuser2
mov cx,5

userdefine1 proc
L1:
mov dx,0
mov bx,2
add dx,bx
mov ah,02h
loop L1
int 21h
endp

userdefine2 proc
mov ah, 4ch
int 21h
userdefine2
endp 
```

我的批评如下：

*   defineuser1 不存在（我认为您的意思是 userdefine1）

*   设置 cx 需要在程序内部（而不是之前）

*   调用 int 21 需要在循环内部（而不是外部）

*   如上所述，您需要对“10”进行特殊处理

*   `'0'`（ASCII 字符/数字）和（数字）之间有区别`0`......您需要打印字符/数字，而不是数字

*   您需要学习测试您的代码（编写代码、使用调试器逐步调试并调试它），最好是在发布有关它的问题之前。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-10T02:14:29.400

您将有一个从零开始的计数器并重复将其增加 2，打印结果。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2019-01-25T18:26:52.233

```
.model small
.stack 100H
.code
.data
var2 DB "10$"
main proc
    mov cx,4
    mov ax,0
    mov dl,al
    add dl,30h
    mov ah,02h
    int 21h
    mov ax,0
    var1:
   add ax,2
   mov dl,al
   add dl,30h
   mov bx,ax
   mov ah,2h
   int 21h
   mov ax,bx
   loop var1
   mov ax,@data
   mov ds,ax
   mov dx,offset var2
   mov ah,09h
   int  21h
   main endp
end main 
```

我是计算机科学的新手，当我看到这个问题时，我只是想尝试一下。我已经做到了，这是代码

* * *

## 回答 #8

> 赞同：-2
> 
>             
> 
> 时间：2009-02-10T02:14:14.970

```
MOV AX, 0
MOV BX, 2

ADDLOOP:
ADD AX, BX
CMP AX, 10
JE DONE
JMP ADDLOOP

DONE: 
```

好的。这是我最好的尝试。遗漏了很多细节。我还应该提到，我不知道如何在屏幕上打印一个字符。

就像其他人提到的那样，您没有指定哪种汇编语言，所以我选择了 x86。

最后，去和你的导师谈谈，他们会比我们更能帮助你。

* * *

## 回答 #9

> 赞同：-4
> 
>             
> 
> 时间：2009-02-10T02:10:08.897

您是否使用宏进行输出？

应该是...

```
 ```
 mov eax, 0 
```

myloop:  cmp eax, 10
         jg done
         output macro eax
         add eax, 2
         jmp myloop
done: 当然这是针对 8086 组装的。

        ruby-on-rails - Rails：修改脚手架生成的模型

ID：530842

赞同：24

时间：2009-02-10T02:04:22.840

标签：ruby-on-rails, ruby, model

如何修改使用建模生成的模型？例如，模型 myModel 最初有 a、b 和 c 列，但我现在想添加 d 列。

            回答 #1

赞同：25

时间：2012-03-02T14:31:16.340

Rails 3 及更高版本使用以下代码：

```
rails generate migration add_fieldname_id_to_tablename fieldname:string 
```

导轨 2

```
ruby script/generate migration add_fieldname_to_tablename fieldname:string 
```

这不再有效并在 Rails 3 中返回以下错误：

ruby：没有这样的文件或目录——脚本/生成（LoadError）

            回答 #2

赞同：19

时间：2009-02-10T02:08:45.170

```
ruby script/generate migration add_fieldname_to_tablename fieldname:string 
```

这是做你想做的事的捷径。如果您需要更多控制，或者如果您有很多列要添加，Andrew H 的答案也可以正常工作。

            回答 #3

赞同：13

时间：2009-02-10T02:05:19.717

到目前为止，我发现的最佳答案是从您的项目根目录运行：

```
ruby script/generate migration add_d_column_to_myModel 
```

然后编辑位于 db/migration 中的新迁移文件，如下所示：

```
 def self.up
    add_column :myModel, :d, :string
  end

  def self.down
    remove_column :myModel, :d
  end 
```

最后一步是相应地更新您的视图。

[在这里](http://groups.google.com/group/rubyonrails-talk/browse_thread/thread/c9981c94b45b0e53)找到答案

表函数在[这里找到](http://ackbar.rubyforge.org/classes/ActiveRecord/ConnectionAdapters/KirbyBaseAdapter.html)

        c# - 如何强制 WCF 线程中未处理的异常使进程崩溃？

ID：530852

赞同：4

时间：2009-02-10T02:06:40.620

标签：c#, wcf, exception-handling, crash-dumps

所以这是场景：

我有一个 WCF 服务，它为每个操作定义了一堆 FaultContracts。我想安排它，如果在与有效的 FaultContract 不匹配的 WCF 服务线程中引发未处理的异常，它会关闭整个进程而不仅仅是线程。（原因是我想要一个包含异常信息的故障转储，因为它与合同不匹配。）

有没有办法干净地做到这一点？我遇到的主要问题是 WCF 想要将我的所有异常转换为客户端故障，以保持服务运行；我其实是想把整个过程搞下来，这本质上意味着规避 WCF 的正常行为。

            回答 #1

赞同：3

时间：2009-02-13T14:00:47.873

Environment.FailFast() 将创建故障转储；它不会运行任何挂起的 try-finally 块，也不会运行任何终结器。

            回答 #2

赞同：2

时间：2009-04-23T04:05:28.933

您需要使用[IErrorHandler](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)来自定义 WCF 的错误处理行为。在调用 (ServiceHost).Open() 之前“应用行为”。

例如（在 Main() 中查找显示“serviceHost.Description.Behaviors.Add(new FailBehavior());”的行）：

```
class FailBehavior : IServiceBehavior
{
    public void AddBindingParameters(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase, System.Collections.ObjectModel.Collection<ServiceEndpoint> endpoints, BindingParameterCollection bindingParameters)
    {
        return;
    }

    public void ApplyDispatchBehavior(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {
        Console.WriteLine("The FailFast behavior has been applied.");
        var f = new FailOnError();
        foreach(ChannelDispatcher chanDisp in serviceHostBase.ChannelDispatchers)
        {
            chanDisp.ErrorHandlers.Add(f);      
        }
    }

    public void Validate(ServiceDescription serviceDescription, ServiceHostBase serviceHostBase)
    {
        return;
    }
}

class FailOnError : IErrorHandler
{
    public bool HandleError(Exception error)
    {
        // this is called for every exception -- even ungraceful disconnects
        if( !(error is CommunicationException) )
            throw new TargetInvocationException( "WCF operation failed.", error );
        else
            throw new CommunicationException( "Unexpected communication problem. (see inner exception)", error );

        // Unreachable
        //return false; // other handlers should be called
    }

    public void ProvideFault(Exception error, MessageVersion version, ref Message fault)
    {
        // Can't throw from here (it will be swallowed), and using Environment.FailFast
        // will result in all crashes going to the same WER bucket. We could create
        // another thread and throw on that, but instead I think throwing from HandleError
        // should work.

        //Console.WriteLine( "Unhandled exception: {0}", error );
        //Environment.FailFast("Unhandled exception thrown -- killing server");            
    }
}

class Program
{
    static void Main( string[] args )
    {
        Console.WriteLine( "Greetings from the server." );

        Uri uri = new Uri( "net.tcp://localhost:5678/ServerThatShouldCrash" );
        using( ServiceHost serviceHost = new ServiceHost( typeof( Server ), uri ) )
        {
            Binding binding = _CreateBinding();

            serviceHost.AddServiceEndpoint( typeof( IServer ),
                                            binding,
                                            uri );
            serviceHost.Description.Behaviors.Add(new FailBehavior());
            serviceHost.Open();

            // The service can now be accessed.
            Console.WriteLine( "The service is ready." );
            Console.WriteLine( "\nPress <ENTER> to terminate service.\n" );
            Console.ReadLine();
        }
    }

    private static Binding _CreateBinding()
    {
        NetTcpBinding netTcp = new NetTcpBinding( SecurityMode.None );
        netTcp.ReceiveTimeout = TimeSpan.MaxValue;
        netTcp.ReliableSession.InactivityTimeout = TimeSpan.MaxValue;
        return netTcp;
    } // end _CreateBinding()
} 
```

            回答 #3

赞同：0

时间：2009-02-10T02:44:14.180

```
Application.Exit(); 
```

这可能会做到这一点，但用户将丢失他们当时正在处理的任何内容。

        serialization - 通过拉行提取数据集的子集，遵循关系

ID：530861

赞同：0

时间：2009-02-10T02:09:02.517

标签：serialization, ado.net

是否有一种相对简单的方法来**提取 DataSet 的关系一致子集**？我想要的子集是：我感兴趣的行，这些行所需的所有子行和父行，仅此而已。

我有大约十几个表，每个表与其他表有两到四个关系。

我想我可以编写代码来遍历数据表和给定一两天的关系，但我更愿意重用现有代码并将那一两天花在我的产品上。

**背景：**

我`DataSet`从我公司销售的组件的数据库中提取了一个强类型。

我正在考虑使用另一个强类型数据集来存储建议的解决方案。物料清单 (BOM) 上的每个项目将有一行。每行将描述组件的配置。

我不想将解决方案表放在组件 DataSet 中。

当我通过 序列化解决方案 DataSet 时`WriteXml`，我想保留有关组件的*足够信息。*如果我从组件表中存储主键，那应该不会太难。

我突然想到，如果我还保留了该 DataSet 中的适当行，则持久解决方案可以在主要组件 DataSet 中的数据到期后继续存在。不过，我不想保留整个组件 DataSet，因此我提出了关于提取有用子集的问题。

            回答 #1

赞同：1

时间：2009-02-27T04:10:49.710

我能想到的最简单的方法是在每一行上调用 DataRow.SetModified() 并遍历您需要获取的任何子行，然后在 DataSet 上调用 DataSet.GetChanges() 方法，它只会返回您需要的行已标记。

在调用 GetChanges 后，您还需要在原始 DataSet 中调用 RejectChanges() 才能再次使用它。

        asp.net - jquery颜色动画间歇性地抛出无效的属性值

ID：530866

赞同：10

时间：2009-02-10T02:11:09.937

标签：asp.net, jquery, updatepanel, colors, jquery-animate

我正在尝试为 ASP.Net 超链接的背景设置动画，以在更新面板刷新时进行黄色淡化。到目前为止，它几乎一直都在工作，但偶尔会抛出一个 javascript 错误“无效的属性值”。并将其调试到该行的jquery颜色插件代码中...

```
fx.elem.style[attr] = "rgb(" + [
     Math.max(Math.min(parseInt((fx.pos * (fx.end[0] - fx.start[0])) + fx.start[0]), 255), 0),
     Math.max(Math.min(parseInt((fx.pos * (fx.end[1] - fx.start[1])) + fx.start[1]), 255), 0),
     Math.max(Math.min(parseInt((fx.pos * (fx.end[2] - fx.start[2])) + fx.start[2]), 255), 0)
].join(",") + ")";
```

这是目前正在发生的事件的顺序......

首先，窗口在 doc.ready 上加载，它会注册一个事件，以便在更新面板完成刷新时执行，如下所示......

```
Sys.WebForms.PageRequestManager.getInstance().add_endRequest(yellowFade); 
```

其中 yellowFade 被定义为...

```
function yellowFade() {
    window.setTimeout("$('#' + hyperlinkUrlId).animate( { backgroundColor: 'white' }, 2000)", 2000);
    window.clearTimeout();
} 
```

现在，我很少在此时崩溃，但通常是稍后，所以我会继续......

然后我单击一个标题为“生成”的按钮，该按钮创建一个 URL 加载 ASP.Net 超链接及其创建的 URL 的文本，然后通过 javascript 将其背景颜色设置为黄色以通过此淡出...

```
$("#" + hyperlinkUrlId).css("background-color", "#FBFF9C");
```

我最初让它通过这个代码在后面的代码中设置颜色......

```
Url.BackColor = ColorTranslator.FromHtml("#FBFF9C");
```

但是后来我想也许背景颜色被设置为jquery颜色插件无法识别的东西，或者因为它被设置在服务器端，插件无法访问它的样式或其他东西，但改变它仍然没有对修复错误的影响。

最后， generate 将 URL 的背景颜色从白色更改为黄色，然后正如我所说，大多数情况下它会很好地消失，但很少会抛出错误“无效的属性值”。  

据我所知，我的语法正是使用彩色动画的方式。我觉得我使用更新面板的事实可能会在这里造成严重破坏，但我不确定。  

有没有人对可能导致这种事情的原因有任何见解？尝试调试确实是一团糟，因为它很少发生，而忽略了javascript已经很难调试的事实。  

在 Windows Vista 上使用 jquery 1.3.1 和 jquery.color 1.0。使用 Visual Studio 2008。让我知道是否有什么可以清理的。

**编辑：**当当，还没有一个回应。我在这方面工作了一段时间，但我刚刚在我的应用程序的另一部分发现了这个错误，我正在做黄色渐变。这两个页面都使用更新面板。在很多情况下，我不喜欢更新面板，它肯定对我的 jquery 造成了严重破坏。我想知道这是否与此有关。哦，这有点暗示整个 Vista 的事情，但我会指出我在 IIS7 上运行。

这会引起任何见解吗？  

            回答 #1

赞同：7

时间：2009-02-12T05:13:31.317

我想我在另一个项目中遇到了和你一样的问题；我在另一个 DIV 内部有一个 DIV（没有明确定义它的背景。）我试图“闪烁”内部 DIV 的背景颜色并遇到该错误。只有在我为容器 DIV 分配了特定颜色之后，错误才消失。

            回答 #2

赞同：7

时间：2009-04-16T20:56:54.737

我在 IE8 中遇到了同样的问题，在一些 td 元素上有背景颜色动画。即使我为 tr 提供了背景颜色，它仍然存在。

我想我现在已经通过更改 jquery.ui 中的一些代码来修复它。

找到这个部分：

```
// We override the animation for all of these color styles
$.each(['backgroundColor', 'borderBottomColor', 'borderLeftColor', 'borderRightColor', 'borderTopColor', 'color', 'outlineColor'], function(i, attr) {
    $.fx.step[attr] = function(fx) {
        if (fx.state == 0) { 
```

改变：

```
if (fx.state == 0) 
```

到：

```
if (fx.state == 0 || fx.start.constructor != Array || fx.end.constructor != Array) 
```

有时在执行此代码时。fx.State 不是 0，但是 fx.start 和 fx.end 还没有被初始化为 RGB 数组。在更新的代码中，如果 fx.start 和 fx.end 数组尚未初始化，我们将对其进行初始化。

这似乎已经解决了它，但很难确定间歇性问题。

更多细节在这里：[http ://dev.jqueryui.com/ticket/4251](http://dev.jqueryui.com/ticket/4251)

            回答 #3

赞同：2

时间：2009-08-28T13:12:34.283

[对于那些对jQuery 颜色插件](http://plugins.jquery.com/files/jquery.color.js.txt)有这个问题的人来说，一个足够好的技巧就是改变

```
if ( fx.state == 0 ) { 
```

低的像

```
if ( fx.state <= 0.045 ) { 
```

奇怪的是 fx.state 并不总是 0，这就是偶尔抛出无效属性错误的原因。

            回答 #4

赞同：2

时间：2009-12-30T19:56:19.667

jQuery 网站上的修复如下（应该在未来的版本中）。在 effects.core.js 中，更改：

```
if ( fx.state == 0 ) {
    fx.start = getColor( fx.elem, attr );
    fx.end = getRGB( fx.end );
} 
```

到：

```
if (!fx.colorInit) {
    fx.start = getColor(fx.elem, attr);
    fx.end = getRGB(fx.end);
    fx.colorInit = true;
} 
```

这完全为我解决了问题。

            回答 #5

赞同：1

时间：2010-07-24T14:09:46.307

我重写了颜色设置器函数，以防止 NaN 传播到 RGB 值中，这解决了问题。

```
var r = Math.max(Math.min( parseInt((fx.pos * (fx.end[0] - fx.start[0])) + fx.start[0]), 255), 0);
var g = Math.max(Math.min( parseInt((fx.pos * (fx.end[1] - fx.start[1])) + fx.start[1]), 255), 0);
var b = Math.max(Math.min( parseInt((fx.pos * (fx.end[2] - fx.start[2])) + fx.start[2]), 255), 0);
if (!isNaN(r) && !isNaN(g) && !isNaN(b))
{
    var rgb = "rgb(" + [r,g,b].join(",") + ")";
    fx.elem.style[attr] = rgb;
} 
```

            回答 #6

赞同：1

时间：2010-09-06T19:05:27.960

我有另一个解决方案，它对我有用。只需添加这些验证行：

```
if (fx.start == undefined) { fx.start = getRGB('white'); } 
if (fx.end == undefined) { fx.end = getRGB('white'); } 
```

在这之前：

```
fx.elem.style[attr] = "rgb(" + [
 Math.max(Math.min(parseInt((fx.pos * (fx.end[0] - fx.start[0])) + fx.start[0]), 255), 0),
 Math.max(Math.min(parseInt((fx.pos * (fx.end[1] - fx.start[1])) + fx.start[1]), 255), 0),
 Math.max(Math.min(parseInt((fx.pos * (fx.end[2] - fx.start[2])) + fx.start[2]), 255), 0)].join(",") + ")"; 
```

            回答 #7

赞同：1

时间：2010-12-14T06:48:40.087

我遇到了类似的问题`jquery.color.js`。通过使用`jquery.effects.core.js`（jquery ui effects core）解决了这个问题。

我希望它也适用于你。

            回答 #8

赞同：0

时间：2010-07-12T05:52:46.417

如果您尝试在某些浏览器中为某些元素设置动画，这似乎不起作用（在 Firefox 中有效，而不是在 Google Chrome 中）。例如，这不适用于 HTML 画布。fx.start 将是未定义的。

例如，我的“黑客”让它与 HTML Canvas 元素一起使用 -

```
if (fx.start == undefined) { fx.start = getRGB('white'); } 
```

        wpf - 更改 WPF 项目模板的命名空间

ID：530870

赞同：5

时间：2009-02-10T02:13:19.060

标签：wpf, project-template

当我修改 xaml 的 cs 时，我将不得不进入并手动修改相应的 *.g.cs 文件。每次我重建时它似乎都会被覆盖。

所以我的问题是，在 WPF 项目模板生成的 WPF 应用程序上更改命名空间的正确方法是什么？

            回答 #1

赞同：15

时间：2009-02-10T02:24:48.890

由于 .g.cs 文件是从 .xaml 文件生成的，因此除了更改 .xaml.cs 文件中的命名空间之外，您还必须更改 .xaml 文件中的命名空间。

例如，我的一个项目中的主窗口在 mainwindow.xaml 中声明如下：

```
<Window x:Class="Penov.Playground.MainWindow"> 
```

对应的 mainwindow.xaml.cs 文件包含：

```
namespace Penov.Playground
{
    public class MainWindow
} 
```

如果我想从 Penov.Playground 更改命名空间，我需要在两个地方都进行更改。这将导致在下一次构建时使用新命名空间生成 .g.cs 文件。

        file-io - 在 nfs 服务器上的两个目录之间复制

ID：530877

赞同：5

时间：2009-02-10T02:17:36.320

标签：file-io, nfs

如果我在 nfs 服务器上有两个目录，我想在它们之间复制大量数据（在几千个文件中，而不是一个大块中），有没有办法将其优化为“本地”副本服务器？NFS 是否会自动执行此操作，如果没有，是否有启用它的选项，或者是否会对客户端产生一些不可避免的影响？可悲的是，ssh 进入 nfs 服务器不是一种选择 - nfs 挂载是我对它的唯一访问权限。

            回答 #1

赞同：9

时间：2009-02-10T02:23:19.970

不，不幸的是，NFS 不这样做。协议中没有规定副本的来源了解有关目的地的任何信息，反之亦然。

如果没有 ssh 或类似的访问权限，您只能通过网络将每个字节拖到客户端，然后通过网络将其发送回服务器，一次一个块。

如果您可以使用 tar 或 dd 或其他可以修改块大小的命令，您可能会得到一些加速。但我不会打赌。

        .net - 从 .NET 启动进程但 RedirectedStandardOutput 不支持 UTF-8

ID：530882

赞同：1

时间：2009-02-10T02:23:38.020

标签：.net, process, utf-8, streamwriter

我正在尝试使用以下代码从 .NET 调用 php 的 HTML 净化器：

```
 Process myProcess = new Process();

    myProcess.StartInfo.FileName = "C:\Path\to\php.exe";
    myProcess.StartInfo.Arguments = "C:\Path\to\purify.php";
    myProcess.StartInfo.UseShellExecute = false;
    myProcess.StartInfo.RedirectStandardOutput = true;
    myProcess.StartInfo.RedirectStandardInput = true;

    myProcess.Start();

    StreamWriter myStreamWriter = myProcess.StandardInput;

    String inputText;

    inputText = txtCodes.Text;
    if (inputText.Length > 0)
    {
        myStreamWriter.Write(inputText);
    }
   myStreamWriter.Close();

    labMsg.Text = myProcess.StandardOutput.ReadToEnd();

    myProcess.WaitForExit();

    myProcess.Close(); 
```

..一切正常，除了...我无法取回非asci字符。例如，在输入中提供一些韩语字符会返回问号作为输出。

即使 HTMLPurifier 函数被绕过并且我只是想简单地提供输入 .NET，将其存储在 php 变量中，然后将该变量回显到输出，也会发生这种情况。

有任何想法吗？

            回答 #1

赞同：3

时间：2009-02-10T05:21:00.090

感谢您的指点。我确实设法解决了它。问题是为输入和输出显式指定 UTF-8。最后，woking 代码如下所示：

```
Process myProcess = new Process();

    myProcess.StartInfo.FileName = "C:\Path\to\php.exe";
    myProcess.StartInfo.Arguments = "C:\Path\to\purify.php";

    myProcess.StartInfo.UseShellExecute = false;
    myProcess.StartInfo.RedirectStandardOutput = true;
    myProcess.StartInfo.RedirectStandardInput = true;
    myProcess.StartInfo.StandardOutputEncoding = Encoding.UTF8;

    myProcess.Start();
    StreamWriter myStreamWriter = new StreamWriter(myProcess.StandardInput.BaseStream, Encoding.UTF8);

    String inputText;
    inputText = txtCodes.Text;

    if (inputText.Length > 0)
    {
        myStreamWriter.Write(inputText);
    }

    myStreamWriter.Close();

    labMsg.Text = myProcess.StandardOutput.ReadToEnd();

    myProcess.WaitForExit();

    myProcess.Close(); 
```

            回答 #2

赞同：2

时间：2009-02-10T02:46:46.343

尝试

```
myProcess.StartInfo.StandardOutputEncoding = System.Text.Encoding.UTF8; 
```

        http - HTTP Filer Server：单文件、跨平台、拖放启动

ID：530883

赞同：2

时间：2009-02-10T02:23:55.413

标签：http

[我在这里](https://stackoverflow.com/questions/530787/simple-http-web-server)问了一个先前的问题，但在阅读了答案后意识到我在定义我的要求方面做得并不好。

这就是我所追求的：

*   跨平台
*   拖放和启动
*   最好是单个文件

总而言之，我想要一些可以拖到文件夹中的东西，启动然后它将开始通过 http 服务该文件夹的内容。

希望有人知道一些事情。

干杯，

克里斯

            回答 #1

赞同：3

时间：2009-02-10T03:37:08.000

Python实现：

```
#!/usr/bin/env python

import SimpleHTTPServer, BaseHTTPServer

def launchServer(ports):
    for port in ports:
        try:
            serv = BaseHTTPServer.HTTPServer(('', port), SimpleHTTPServer.SimpleHTTPRequestHandler)
        except:
            continue
        else:
            print ("Launched on port " + str(port))
            serv.serve_forever()

        raise Exception("No ports available")

launchServer([80] + range(8000, 9000)) 
```

对于 Windows 可执行文件，运行以下命令：

```
python setup.py py2exe 
```

设置.py：

```
from distutils.core import setup
import py2exe
setup(console=['minipywebd.py']) 
```

在 Linux 上，`chmod a+x`python 文件。

            回答 #2

赞同：1

时间：2009-02-10T03:30:10.653

我发现了一个 Firefox 插件形式的小型 Web 服务器。它适用于 Firefox 可在其上运行的任何平台。它可以非常快速地安装，并且可以在大约 45 秒内准备好使用（我从开始下载到提供第一页的时间为自己计时）。服务器会在安装后立即设置一个目录供您使用，因此您可以将其拖到那里并立即开始查看页面。它还包含有限的服务器端脚本功能 (SJS)，但可以使用 php 和 Perl 等常用语言进行扩展。我不认为这将是您用来托管 Google 的服务器，但它似乎是您正在寻找的。

下载地址[在这里](https://addons.mozilla.org/en-US/firefox/addon/3002) 

            回答 #3

赞同：1

时间：2009-06-06T23:36:46.830

Well it is quite late to answer this one: but python afaik is not single file ;-)

TCL is!

Look at www.equi4.com for a tclkit or starkit. TCL can implement an HTTP server easily. But with a TCL starkit you can even pack the content to be served into the very same file as the webserver and the TCL interpreter and possibly extension.

Building a complete solution is no rocket science but you will have to read yourself into the thing a bit. TCL can be learned in two to three hours if you ever programmed anything before.

        perl - 如何在 Perl 中操作 Sybase 日期时间字符串？

ID：530889

赞同：5

时间：2009-02-10T02:25:58.747

标签：perl, datetime, sybase

我在 Sybase 表中有一个日期时间字段，需要在 Perl 中使用它来进行一些计算（差异以确保我拾取至少相隔 'n' 分钟的记录）。现在，如果我只是简单地选择`<datetime field`>，Sybase 会返回一个对我没有用处的人类可读字段。我正在寻找某种方法将其转换为基于纪元的时间，这将允许我在 Perl 中轻松地操作它们。

我可能是错的，但我在 Sybase 中没有找到现有的函数。我得到的最接近的是 datediff，它很好地满足了我的目的。事实上，我现在正在使用它作为解决方法。datediff 的问题是由于整数的限制，它的上限为 68 年。我知道我的代码可能要到那个时候才会出现，但是为什么要自己引入这样一个基于时间的限制呢？

有没有办法解决这个问题？

谢谢！

            回答 #1

赞同：4

时间：2009-02-10T02:28:23.190

如果您可以在客户端执行此操作，则 Time::ParseDate 模块应该能够为您完成工作。

            回答 #2

赞同：2

时间：2009-02-10T04:10:08.403

当我需要处理日期/时间计算时， [DateTime模块为我提供了很好的帮助。](http://datetime.perl.org/?Modules)

使用 DBD::Sybase`syb_date_fmt()`方法控制格式，然后使用[DateTime::Format::Strptime](http://search.cpan.org/dist/DateTime-Format-Strptime/)解析结果并生成 DateTime 对象。使用 DateTime`epoch`方法获取您的纪元时间，或者使用适当的 DateTime::Duration 对象更好地进行数学计算。

            回答 #3

赞同：1

时间：2009-02-10T07:14:48.820

如果你不能让 Sybase 和 Perl 合作给你一个真正的 DateTime 对象或类似的东西（比如 Time::Piece），那么我通常处理这些事情的方式是试图说服数据库给我 ISO 标准日期格式 (YYYY-MM-DDTHH:MI:SS) 并从那里转换。

        ajax - Ajax 负载测试工具

ID：530891

赞同：16

时间：2009-02-10T02:27:40.053

标签：ajax, load-testing

似乎有很多支持 AJAX 的压力/负载测试工具。

我想知道这些工具的实施情况如何。

他们只记录http请求并重播吗？

这是测试 AJAX 应用程序的正确方法吗？

谷歌如何测试他们的 ajax 应用程序？

            回答 #1

赞同：6

时间：2009-02-14T18:38:26.700

大多数负载测试工具都以相同的方式进行 AJAX 负载测试：它们执行在“记录”阶段看到的原始 HTTP 流量（可以是页面请求、图像请求甚至 AJAX 请求）。它们之间的主要区别在于它们的记录器/IDE 工具有多好，以及它如何轻松地帮助您参数化 HTTP 请求，以便它们根据动态/实时结果反映真实世界的流量。

**警告，明目张胆的插件**：唯一真正的例外是我的公司[BrowserMob](http://browsermob.com)。它不是模拟观察到的流量，而是实际上使用真实的网络浏览器来驱动回载。因此，AJAX 内容由浏览器处理。

**有用的链接**：与上面的公然插件分开（尽管我确实希望您检查一下 - 我们提前定价并提供免费试用），我最近为 Ajaxian 写了一篇关于[AJAX 负载测试](http://ajaxian.com/archives/why-load-testing-ajax-is-hard)的文章。它更详细地介绍了使用真实浏览器用户 (RBU) 与虚拟用户 (VU) 的技术含义。

            回答 #2

赞同：2

时间：2014-02-11T03:00:16.253

看看 LoadBooster ( [https://www.loadbooster.com](https://www.loadbooster.com) )。它利用无头脚本浏览器 PhantomJS/CasperJs 来测试网站。Phantomjs 将解析和渲染每个页面，执行客户端脚本。无头浏览器方法更容易编写测试场景以支持复杂的 AJAX 繁重的 Web 2.0 应用程序，浏览器导航、鼠标单击和击键进入浏览器或等到元素存在于 DOM 中。LoadBooster 也支持 selenium HTML 脚本。

免责声明：我为 LoadBooster 工作。

            回答 #3

赞同：1

时间：2009-02-10T02:34:03.003

如果您只担心功能，那么像[Watin](http://watin.sourceforge.net/)、[Watir](http://wtr.rubyforge.org/)、[Selenium](http://seleniumhq.org/)或任何功能性工具都可以。只要您在功能测试中放置足够的时间以允许 ajax 回调，那么这应该可以解决问题。

为了补充我的回应，

如果您正在谈论对您的 javascript 进行单元测试，您可以使用类似 qunit 的东西，正如 LosTechian[在这篇文章中](http://[4])所描述的那样。这是一个非常有创意的使用 nunit 插件和 qunit 来集成 js 单元测试。

纯属巧合，发布 qunit testing 博客文章的同一个人昨天刚刚发布了一篇关于[这个主题的文章](http://www.lostechies.com/blogs/johnteague/archive/2009/02/10/another-way-to-test-ajax-methods.aspx)

            回答 #4

赞同：1

时间：2009-02-10T02:34:07.653

Google 应用程序是用 GWT 编写的，它带有自己的 JUnit 扩展。[关于使用 GWT 对 ajax 应用程序进行单元测试的文章](http://www.ibm.com/developerworks/java/library/j-cq07247/index.html)。

            回答 #5

赞同：1

时间：2009-02-11T16:36:30.297

所有负载测试器都将支持 AJAX——它们只是额外的 http 连接。

那里有一些免费的[——Jmeter](http://jakarta.apache.org/jmeter/)、[BadBoy](http://www.badboy.com.au/)、[Grinder](http://grinder.sourceforge.net/)，它们都做得很好。

它们都对录制/播放有某种支持，但这并不总是你想要的。

我做过的最简单的方法是记录一个示例会话，用变量替换一些参数并将其从 csv 或 excel 文件中循环出来。

很好的起点：关于开源测试的谷歌演示[视频。](http://www.youtube.com/watch?v=335LKIXRauA)

编辑：更新的视频链接。

            回答 #6

赞同：1

时间：2009-02-12T18:18:25.423

如果您不想设置自己的负载测试服务器，有几个免费的在线负载测试服务可以直接在 Internet 上运行负载测试。例如[http://loadimpact.com](http://loadimpact.com)或[http://loadstorm.com](http://loadstorm.com)

            回答 #7

赞同：1

时间：2009-02-14T17:36:38.687

我使用虚拟用户生成器（HP Loadrunner 软件的一部分）来测试 AJAX 应用程序。该软件有多种应用程序协议，可用于记录网络应用程序，例如 AJAX 和 Click and Script。

对于大多数 Web 应用程序负载测试来说，记录和重放 http 请求就足够了。这将给出服务器如何处理负载的结果。如果您的 Web 应用程序在客户端执行大量异步加载和渲染，例如解析 xml 或 json 的大型数据集，或许多 DOM 修改，则可能需要包含浏览器层来衡量最终用户体验。

            回答 #8

赞同：0

时间：2009-02-10T03:18:18.543

我在之前的工作中使用过[SilkPerformer](http://www.borland.com/us/products/silk/silkperformer/index.html)。根据链接，他们有一些 AJAX 增强功能。不幸的是，Silk 远非免费。

            回答 #9

赞同：0

时间：2009-02-12T22:50:29.870

看看[吉菲](http://code.google.com/p/jiffy-web/)。这是一个端到端的测量套件，因此有点复杂。然而，统计数据令人印象深刻。

            回答 #10

赞同：0

时间：2009-02-14T12:31:26.940

[围攻](http://www.joedog.org/index/siege-home)？它可以进行 HTTP 测试并通过您想要的任何内容。

            回答 #11

赞同：0

时间：2009-04-21T16:53:38.587

你也可以看看[fwptt](http://fwptt.sourceforge.net)它是开源的。如果您是 .net 开发人员，您可以利用参数自动处理以及使用您自己的 .net 对象进行测试的可能性。

            回答 #12

赞同：0

时间：2011-08-16T11:42:27.257

我已经成功地使用 JMeter 对我们的 Ajax (JSF/RichFaces) 应用程序进行了负载测试。我没有使用 JMeter 的记录工具——而是使用 Firefox 的 HttpFox 插件来监控浏览器向服务器发布的内容，然后我在 JMeter 中重新创建了它。

它确实变得有点复杂，但负载测试现在相当健壮。JMeter 有各种有用的“元素”来从网页中提取 ID、执行条件逻辑、递增计数器等。

            回答 #13

赞同：0

时间：2013-08-20T04:09:03.060

更好地为负载测试 ajax 应用程序编写隔离测试方法或 API。有一些原因：

*   为 Ajax 应用程序（例如 GWT）编写功能测试并不容易。
*   您可以使用[Jmeter WebDriver 插件](http://jmeter-plugins.org/wiki/WebDriverTutorial/)，但每次运行都会启动浏览器，这将使用大部分 RAM 和 CPU。
*   您将加载后端而不是前端，因此您可以避免使用 ajax。

您可以像这样设计您的测试：对于 Ajax 应用程序，使用 Selenium 或 PhantomJS/CasperJS。对于负载测试，请使用 JMeter，通过 API 而非 Ajax 进行 Gatling。

            回答 #14

赞同：0

时间：2014-12-18T08:35:38.750

我的选择是萤火虫（浏览器插件）。它非常轻巧且易于处理

        .net - 识别连接到计算机的扫描仪？

ID：530892

赞同：1

时间：2009-02-10T02:27:41.100

标签：.net, windows, upnp, image-scanner

我正在处理的应用程序正在使用扫描仪，它可能属于几种类型之一。我需要识别附加的扫描仪，提供从附加的扫描仪中选择默认扫描仪的选项，并在需要时更改此选择。到目前为止，我想出了这个解决方案：

```
ManagementObjectSearcher search = new System.Management.ManagementObjectSearcher("SELECT * From Win32_PnPEntity");

ManagementObjectCollection deviceCollection = search.Get();

foreach (ManagementObject info in deviceCollection)
{
    string deviceName = Convert.ToString(info["Caption"]);

    if( /* check something about deviceName */)
    {
        // add a scanner to the list
    }
} 
```

这对我有用，因为我知道在 info["Caption"] 中会发生什么。但是，有几个问题：

*   我知道我的设备将在“成像设备”下。有没有办法只识别“成像设备”分支的成员，而不遍历每个 PnP 设备？刚刚发现在我的 PC 上 deviceCollection 有 190 个条目。将它过滤到只有一对会非常好。:)
*   对于我事先不知道将要连接的扫描仪的型号/类型的情况，有没有办法识别该设备是扫描仪？

            回答 #1

赞同：2

时间：2009-02-10T03:14:58.613

[您可以按照此线程](http://social.microsoft.com/Forums/en-US/netfxbcl/thread/4b350704-d9b3-4920-a68a-802f5f4e8a6a)中的建议尝试 Windows 图像采集自动化库

        drupal - Drupal 如何让视图显示为列而不是行

ID：530895

赞同：2

时间：2009-02-10T02:28:47.087

标签：drupal, drupal-views

我试图让一个 drupal 6 视图以列格式而不是行显示。基本上我想按分类对我的图片/视频进行分组并将它们显示在表格中。类似于我下面的内容。我尝试使用网格布局启用分组，但似乎没有这样做。

牛 马 狗 猫

图片 图片 图片 图片

图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片 图片

图片 图片 图片

图片 图片

图片 图片 图片

希望这是有道理的。

            回答 #1

赞同：10

时间：2009-02-10T04:21:39.563

如果您使用 Views 2，一种方法是创建一个表格视图，然后使用自定义 views-view-your-view-name.tpl.php 文件以垂直而不是水平输出列和行。该模板覆盖将行和列作为对象数组获取，您可以根据需要输出这些对象。

            回答 #2

赞同：2

时间：2009-02-13T20:04:31.010

我不认为小组是这个问题的好答案，它们有不同的目的。

我可能会使用在 URL 中按自定义参数排序的视图，将输出设置为列表（所以它是 li div.title 标题、div.date 日期、div image Image /li 等），并使用 css (. li 具有固定大小和浮动：左；）。

然后我会在视图之前有一个“排序依据”选择器（在任何视图输出之前都会重复一个 HTML 字段 - [a href="?sort=Name"]按名称排序[/a]）

            回答 #3

赞同：1

时间：2009-02-10T02:55:30.800

您也许可以使用多个视图和面板。查看面板模块

            回答 #4

赞同：0

时间：2011-09-05T17:11:10.847

Flipped Table 插件是[Views Hacks 模块](http://drupal.org/project/views_hacks)的一部分。

        statistics - 机器学习有哪些经济上重要的应用？

ID：530906

赞同：6

时间：2009-02-10T02:40:08.933

标签：statistics, machine-learning

如果这太模糊，请提前道歉。

到目前为止我的清单：

*   统计套利  
*   精算学  
*   制造过程控制  
*   图像处理（安全、制造、医学成像）  
*   计算生物学/药物设计  
*   军刀计量学  
*   收益管理  
*   运筹学/物流（我将包括商业智能）  
*   营销（偏好预测、调查设计/分析、在线广告服务）  
*   计算语言学（谷歌，信息检索，...）  
*   教育测试  
*   流行病学  
*   犯罪学（欺诈检测、反恐……）  
*   消费者信用评分  
*   垃圾邮件检测  
*   错误发现、病毒检测、计算机安全     

有没有解决这个问题的文章、书籍或期刊？我看过的唯一一本书是 Supercrunchers，它只关注消费者的偏好。

            回答 #1

赞同：5

时间：2009-02-10T02:48:50.067

有很多领域利用机器学习：

*   预测文本输入（[支持向量机](http://en.wikipedia.org/wiki/Support_vector_machine)）
*   计算机视觉
*   游戏人工智能
*   机器人感知（分类和检测）
*   基因组学
*   手写识别（例如，美国邮政服务使用神经网络进行邮件分拣）
*   信用卡欺诈检测
*   定位（[卡尔曼滤波器](http://en.wikipedia.org/wiki/Kalman_filter)、[粒子滤波器](http://en.wikipedia.org/wiki/Particle_filter)）
*   偏好预测（Netflix、亚马逊）

编辑：

如果你想把机器学习的所有应用都列出来，我想你会发现这个问题很棘手。机器学习作为一个领域主要集中在使用数据构建模型的任务上，该模型可以将输入映射到所需的一组输出。随着人们想象机器学习的新应用，利用它的领域不断发展。如果有帮助，通常机器学习在无法很好地描述输入和输出之间的映射时最强大，映射空间的维度太高而无法以合理的方式进行处理，和/或需要随着时间的推移而自适应。

如果您只是在寻找阅读机器学习应用程序的地方，您可以查看以下内容：

*   Russel 和 Norvig 的《[人工智能：现代方法](https://rads.stackoverflow.com/amzn/click/com/0137903952)》，所有 AI 事物的标准教科书
*   [机器学习研究杂志](http://jmlr.csail.mit.edu/)
*   [机器学习与应用国际会议](http://www.icmla-conference.org/icmla08/)

另一个不错的选择是访问具有强大 AI、CS、数学或机器人程序的大学网站，看看他们是否有感兴趣的课程材料。例如，我知道 CMU、MIT 和斯坦福大学通常都有很多在线课程笔记，其中经常提到各种技术的应用程序。

            回答 #2

赞同：3

时间：2009-02-12T14:56:40.510

一些对冲基金（如[Renaissance Technologies](http://en.wikipedia.org/wiki/Renaissance_Technologies)）使用各种机器学习技术来创建黑盒交易算法。做得好的基本上印钱。

一般来说，一些更复杂的套利/风险管理技术使用不同程度的机器学习，并花费相当多的钱来编写这种软件。

            回答 #3

赞同：1

时间：2009-02-12T14:51:55.293

Some others:

*   Medical Diagnosis
*   Data Visualization
*   Adaptive Software
*   Video/Audio Fingerprinting
*   Military Intelligence
*   Compression
*   Control
*   Design
*   Optimization

The last two may fall under "Operations Research".

            回答 #4

赞同：0

时间：2012-11-22T22:47:10.820

自适应和个性化的用户界面。示例可能包括：搜索建议、游戏玩法、应用程序布局等。

        sqlite - 在 SQLite 中，如何将默认列定义为当前用户？

ID：530908

赞同：1

时间：2009-02-10T02:43:47.113

标签：sqlite

在 SQLite 数据库中，如何将一列默认定义为当前用户？

            回答 #1

赞同：3

时间：2009-02-10T02:47:59.507

您是在谈论列的默认值吗？[SQLite唯一有效](http://www.sqlite.org/lang_createtable.html)的默认值如下：

DEFAULT 约束指定执行 INSERT 时使用的默认值。该值可以是 NULL、字符串常量或数字。默认值也可以是与特殊情况无关的关键字 CURRENT_TIME、CURRENT_DATE 或 CURRENT_TIMESTAMP 之一。

            回答 #2

赞同：2

时间：2009-02-10T02:49:14.183

SQLite 没有用户的概念。当您连接到 SQLite 时，您不会使用用户名/密码“登录”。

如果您需要当前操作系统用户，则应在从应用程序插入数据时将其指定为字符串。

            回答 #3

赞同：0

时间：2009-02-10T02:49:33.700

简单地说：一个没有。打算这样做意味着您的数据库必须知道应用程序状态，这是一种倒退。

        c# - 在没有布尔检查的情况下验证许可证信息？

ID：530909

赞同：5

时间：2009-02-10T02:44:09.483

标签：c#, asp.net-mvc, licensing

我目前正在使用一个简单的 XML 文件，其中包含许可证信息以及数据的签名和公钥。到目前为止，这种方法效果很好。但是，我看到了一个相当大的安全漏洞......

当我的 ASP.NET MVC 应用程序启动时，它会验证许可证并相应地设置“ValidLicense”布尔属性。在每次请求期间，都会检查此属性，如果许可证无效，则会显示错误消息。

您可以猜到，无论许可证的有效性如何，绝对没有什么可以阻止有能力的用户简单地修改我的程序集以将“ValidLicense”设置为 true。我知道这几乎可以用于任何应用程序，但使用 .NET 程序集似乎非常容易。

有什么方法可以阻止这种情况的发生，或者至少让破解许可证验证程序变得更加困难？

如果可能的话，我宁愿远离汇编加密和混淆系统。但是，如果您认为它们足以保证成本和额外的头痛，请继续建议它们。

            回答 #1

赞同：8

时间：2009-02-10T03:07:29.180

获胜的唯一方法就是不玩。

窃取您的东西的人（无论您采取了何种保护措施），如果他们难以破解，他们不会为此付出代价*。*

            回答 #2

赞同：3

时间：2009-02-10T02:53:59.320

每次需要验证许可证并将逻辑基于该计算的结果时，您都可以执行复杂的计算，而不是简单的布尔变量。不过，您确实会受到打击。无论如何，破解你的程序集也不会那么难。

您还可以使用一些更高级的技术，例如代码的动态突变和使用相应的可变函数来控制逻辑流。

但是，您应该问自己，您的程序集是否真的包含如此宝贵的知识产权，以保证花费时间和精力来实施这样的事情？走合法路线并与潜在的盗版作斗争可能会更可行，成本更低。

            回答 #3

赞同：1

时间：2009-02-10T04:45:32.890

你可以让它更复杂一点，但最终它会归结为一个（或几个）布尔值：要么运行代码，要么不运行。Non-obfuscated .NET 代码与开源代码几乎相同，并且非常容易破解。

即使混淆不是一个完整的解决方案，我认为混淆是有意义的，只是为了防止边缘业余爱好者制作破解版本。

当然这不会阻止一个愿意花时间的真正的饼干，但只要把标准提高一点，你就可以淘汰很多饼干爱好者。

混淆可以很简单地免费实现。如果您有 Visual Studio 的商业版本，则可以使用 DotFuscator（不是“Express”版本）。我从未尝试过，但我想它应该很简单。

否则，您可以使用 Assemblur。（[http://www.metapropeller.com/](http://www.metapropeller.com/)）。免费版是一个命令行应用程序（有一个 GUI 来创建设置文件，但您需要从命令行运行设置）。

总而言之，混淆一个简单的 exe 文件只需要几分钟，而且它是免费的

如果你想让你的license检查更具挑战性，你可以在各种方法中进行不同的检查，你也可以确保license检查代码实际上没有直接输出任何字符串。（例如，您在方法 A 中进行了许可证检查，但您从方法 B 输出了错误警告，因此当破解者查找许可证错误消息时，他不会正确地找到要更改的代码位） .

它所做的只是提高了想要成为饼干的人的标准，并使真正的饼干变得更加复杂。

案例 1：具有 1 种许可证检查方法的非混淆 .NET 应用程序输出“未许可”错误消息。任何可以运行反射器的人都可以在大约 5 分钟内破解。

案例 2：混淆了 .NET 应用程序，有几个不同的许可证检查，没有明显的字符串输出。一个饼干可能需要几个小时，对于一个想要的人来说太难了。

您可以从案例 1 到案例 2 只需大约 1 小时的工作，而无需花费一分钱。超越这可能是浪费时间（一切*都*可以破解），但至少，你可以淘汰那些在 Reflector 中打开你的应用程序的人，看看它是否容易。如果这个人在反射器中打开应用程序并看到如下内容：

```
public bool ValidateLicense(string sLicense)
{
    string sInvalidLicense = "Your license is not valid";
    ...
} 
```

猜猜接下来会发生什么？

//编辑：在评论中，LC 问：

您如何不让它输出任何字符串消息但仍通知用户？即使您以两种不同的方法进行许可证检查和输出，您仍然会有二元决策“if(!ValidateLicense(LicenseCode)) {NotifyUserOfInvalidLicense(); throw new LicenseException();}”之类的，不是吗？

设身处地为您着想：您正在寻找许可证验证码。您不会为了找到它而研究整个代码。相反，您在未经许可的情况下运行应用程序：出现错误消息。

您获取该错误消息，在 Refactor 中打开程序集并搜索该错误消息的一部分。

如果该字符串位于“ValidateLicence()”内，您会立即找到 ValidateLicence() 函数。从那里，您只需要找到返回值并更改该 1 个字节。完毕。

如果在“WhatEver()”中找到该字符串，您仍然需要找到调用“WhatEver()”的方法。它甚至可能不在同一个程序集中（在这种情况下，Refactor 不会为您找到它）。这使您的想成为饼干的人的工作变得更加困难。他将不得不查看该方法以了解它如何验证代码（它没有）。他甚至可能会草率地更改错误方法的返回值，在这种情况下，他会引入一个错误（如果方法被混淆，弄清楚它的作用并不是那么简单）。

更好的是，根本不要使用字符串：您可以将错误消息存储为十六进制代码序列，并在需要显示消息时将其动态转换为字符串。没有错误字符串意味着破解者将不得不依靠其他东西来定位您的许可证验证码。阅读混淆代码并不好玩。

您还可以使用包含错误消息的虚假验证方法并抑制警告以使其看起来像破解工作。

所以，像这样的一些简单、愚蠢的技巧 + 简单的混淆非常容易实现，它们可以将 5 分钟的“进出”破解会话变成破解者数周的工作，因为他不仅需要找到和破解您的验证码，但他还必须进行测试以确保一切正常，并且他不只是修复诱饵或不情愿地创建令人讨厌的错误。现在，他只是无法确定没有测试。

最后，破解程序集只是更改几个字节的问题，您*无法*阻止任何人更改程序集文件中的字节。一切都可以破解。

但是，您可以使查找必须更改的字节变得更加困难，至少，您可以避免出现“您要查找的字节就在这里”的字符串。

            回答 #4

赞同：0

时间：2009-02-10T08:28:41.340

我在尝试破解一个小 .NET 产品时遇到的一种方法是使用非托管 .DLL 进行许可证检查。不仅如此，.DLL 还包含大量软件中实际使用的代码。因此，要破解产品，我实际上必须破解非托管的 .DLL（或制作完美的包装器）。不用说，这阻止了像我这样的狂热饼干。:)

        architecture - 计算机类型

ID：530918

赞同：4

时间：2009-02-10T02:48:22.297

标签：architecture, computer-science, history, theory, von-neumann

我最近在某处读到了一些与计算机相关的东西。

阅读内容与 Lisp 和 Emacs 相关，它们适合更像图灵机的“架构”模型。

另一方面，它是 C，“其他”架构模型是以我不记得名字的人命名的，但被命名为最成功的计算机类型，因为这是我们现在都使用的（即 cpu + ram + hd +等等等等）。

如果它不是图灵机，那这种计算机的名称是什么（那 afaik 是抽象模型而不是物理模型）

字节！

            回答 #1

赞同：13

时间：2009-02-10T02:50:33.370

我认为您正在考虑[冯诺依曼架构](http://en.wikipedia.org/wiki/Von_Neumann_architecture)。尽管大多数现代计算机都使用冯诺依曼架构，但也有类似的[哈佛架构](http://en.wikipedia.org/wiki/Harvard_architecture)，它仍然是图灵完备的，但它将正在执行的指令与正在读取和写入的数据分开。

            回答 #2

赞同：3

时间：2009-02-10T02:51:10.357

你是说[冯诺依曼架构](http://en.wikipedia.org/wiki/Von_Neumann_architecture)吗？

        java - 使用依赖注入时是否有“新”的情况？

ID：530923

赞同：17

时间：2009-02-10T02:49:33.527

标签：java, oop, spring, dependency-injection, guice

依赖注入是否意味着您永远不需要“新”关键字？或者直接创建简单的叶子类比如集合是否合理？

在下面的示例中，我注入了比较器、查询和 dao，但 SortedSet 是直接实例化的：

```
public Iterable<Employee> getRecentHires()
{
    SortedSet<Employee> entries = new TreeSet<Employee>(comparator);
    entries.addAll(employeeDao.findAll(query));
    return entries;
} 
```

            回答 #1

赞同：10

时间：2009-02-10T02:52:28.933

仅仅因为依赖注入是一种有用的模式并不意味着我们将它用于所有事情。即使在使用 DI 时，也经常需要*新*的. 暂时不要删除新的。

            回答 #2

赞同：7

时间：2009-02-10T03:44:07.983

我通常决定是否使用依赖注入的一种方法是在为被测类编写单元测试时是否需要模拟或存根协作类。例如，在您的示例中，您（正确地）正在注入 DAO，因为如果您为您的类编写单元测试，您可能不希望任何数据实际写入数据库。或者可能是一个协作类将文件写入文件系统或依赖于外部资源。或者行为是不可预测的或难以在单元测试中解释。在这些情况下，最好注入这些依赖项。

对于像 TreeSet 这样的协作类，我通常不会注入它们，因为通常不需要模拟这些简单的类。

最后一点：当一个字段由于某种原因无法注入，但我仍然想在测试中模拟它时，我发现[Junit-addons PrivateAccessor](http://junit-addons.sourceforge.net/junitx/util/PrivateAccessor.html)类有助于将类的私有字段切换为模拟对象由[EasyMock](http://www.easymock.org/)（或 jMock 或您喜欢的任何其他模拟框架）创建。

            回答 #3

赞同：4

时间：2009-02-10T03:04:17.673

*使用new*并没有错，就像它在代码片段中的显示方式一样。

考虑想要附加字符串片段的情况。为什么要向注入器询问 StringBuilder ？

在我遇到的另一种情况下，我需要根据容器的生命周期运行一个线程。在那种情况下，我不得不做一个*new Thread()*因为我的 Injector 是在容器启动的回调方法被调用之后创建的。一旦注入器准备就绪，我将一些托管类手动注入到我的 Thread 子类中。

            回答 #4

赞同：0

时间：2009-02-10T02:56:42.620

是的当然。

依赖注入适用于客户端可能不知道（或无法选择）编译时间的多个可能的实例化目标的情况。  

但是，在很多情况下您确实知道要实例化什么，因此不需要 DI。

这就像在面向对象的语言中调用函数：仅仅因为您可以使用动态绑定，并不意味着您不能使用良好的旧静态调度（例如，当您将方法拆分为多个私有操作时）。

            回答 #5

赞同：0

时间：2009-02-16T01:44:46.593

我的想法是，DI 非常棒，非常适合连接层以及需要灵活应对潜在变化的代码片段。当然我们可以说一切都可能需要改变，但我们都知道在实践中有些东西是不会被触及的。

因此，当 DI 过大时，我会使用“新”并让它滚动。

例如：对我来说，将模型连接到视图到控制器层。它总是通过 DI 完成。我的应用程序使用的任何算法，DI 以及任何可插入的反射代码，DI。数据库层.. DI，但我系统中使用的几乎所有其他对象都是用一个常见的“新”处理的。

希望这可以帮助。

            回答 #6

赞同：0

时间：2009-02-21T00:57:55.540

确实，在当今框架驱动的环境中，您实例化对象的次数越来越少。例如，Servlet 由 servlet 容器实例化，Spring 中的 bean 由 Spring 实例化等。

尽管如此，当使用持久层时，您将在持久化对象被持久化之前对其进行实例化。例如，当使用 Hibernate 时，您将在持久化对象上调用 new，然后再调用 HibernateTemplate 上的 save。

        c# - LINQ：使用 INNER JOIN、组和 SUM

ID：530925

赞同：26

时间：2009-02-10T02:50:02.933

标签：c#, linq, .net-3.5

我正在尝试使用 LINQ 执行以下 SQL，而我得到的最接近的是进行交叉连接和求和计算。我知道必须有更好的方法来编写它，所以我向堆栈团队寻求帮助。

```
SELECT T1.Column1, T1.Column2, SUM(T3.Column1) AS Amount
FROM T1
     INNER JOIN T2
        ON T1.T1ID = T2.T1ID
     INNER JOIN T3
        ON T2.T3ID = T3.T3ID
GROUP BY T1.Column1, T1.Column2 
```

我一直在尝试的是以下 LINQ 代码

```
var qTotal = from T2 in context.T2
             from T3 in context.T3
             where T3.T3ID == T3.T3ID
             group T3 by T2.T1ID into gT2T3
                  from T1 in context.T1
                  where gT2T3.Key.Equals(T1.T1ID)
                  select new { T1.Column1,T1.Column2,Amount = gT2T3.Sum(t => t.Column1)}; 
```

我知道必须有更好的方法来编写它，我只是不知道如何，任何帮助都会很棒！

            回答 #1

赞同：37

时间：2009-02-10T03:11:03.337

试试这个：

```
var total = from T1 in context.T1
            join T2 in context.T2 on T1.T2ID equals T2.T2ID
            join T3 in context.T3 on T2.T3ID equals T3.T3ID
            group T3 by new { T1.Column1, T1.Column2 } into g
            select new { 
                Column1 = T1.Column1, 
                Column2 = T2.Column2, 
                Amount = g.Sum(t3 => t3.Column1) 
            }; 
```

            回答 #2

赞同：24

时间：2012-04-25T17:12:15.317

对我来说（使用 4.0），以下工作。

```
var total = from T1 in context.T1
            join T2 in context.T2 on T1.T2ID equals T2.T2ID
            join T3 in context.T3 on T2.T3ID equals T3.T3ID
            group T3 by new { T1.Column1, T1.Column2 } into g
            select new { 
                Column1 = g.Key.Column1, 
                Column2 = g.Key.Column2, 
                Amount = g.Sum(t3 => t3.Column1) 
            }; 
```

            回答 #3

赞同：0

时间：2016-06-10T06:41:18.187

下面的代码对我有用：

```
 var credit = (from bm in BulkMessage
                          join sms in SMS on bm.BulkMessageId equals sms.BulkMessageId
                          where bm.ProfileId == pid && bm.IsActive == true
                           group sms by sms.SMSCredit into g

                          select new { SMSCredits = g.Sum(s => s.SMSCredit) }).FirstOrDefault(); 
```

        testing - 测试outlook插件

ID：530928

赞同：3

时间：2009-02-10T02:51:38.843

标签：testing, outlook, automated-tests

哪些工具适合对 Outlook 插件进行自动化 UI 测试？我们正在 VB 6.0 中开发插件。我们正在使用微软的 UI 自动化框架。关于框架的任何最佳实践？还有其他应该探索的工具吗？

            回答 #1

赞同：0

时间：2012-10-17T19:20:04.963

如果你在你的插件中使用标准的 Windows API 控件并且你喜欢 Python，你可以使用[pywinauto](http://code.google.com/p/pywinauto/) - Gui Automation with Python

我在使用 pywinauto 测试 MS Outlook 的几个垃圾邮件过滤器插件方面有积极的经验。

        java - Qt Jambi vs SWT 用于跨平台 GUI 开发

ID：530938

赞同：12

时间：2009-02-10T03:01:44.933

标签：java, user-interface, cross-platform, swt, jambi

我目前参与了一个主要为 Linux (Fedora 10) 开发应用程序的项目。但是，以后可能会出现这种情况，我们将不得不将这些应用程序移植到 Mac OS X 和 Windows 上，而且我们不希望因选择错误的 GUI 工具包而陷入困境。*

由于各种遗留原因，我们被锁定在使用 Java 上。我们正在决定在 GUI 中使用 Qt Jambi 还是 SWT。我没有太多使用它们的经验，所以我正在做一些小型原型来尝试感受它们。到目前为止（只是在 Linux 上开发）它们之间没有太大区别。但是，我能在短时间内走的深度是有限度的。这就是我寻求帮助的原因。

我们感兴趣的特殊功能是：

*   无框窗户

*   自定义形状的窗口（即不是矩形）

*   美观

有没有人对这两个库有任何经验和/或见解可能会在以后绊倒我们？

*   敏捷编程人员无疑会跳上“可能……以后”这句话，并说我们不应该担心它。但是，在工具包之间没有其他决定因素的情况下，未来的可扩展性选项会起作用。我保证在需要之前不会编写任何跨平台特定代码:)

**2 月 11 日更新：**感谢您的精彩回答。对于那些好奇的人，我们可能会选择占碑。赢得我的主要是样式表功能，因为它们使我们需要做的许多自定义小部件形状变得容易。Qt 示例套件表明，无框、自定义形状的窗口确实可以在不同的平台上工作，所以我们不应该被抓到。LGPL 版本是我们考​​虑 Jambi 的原因 :)

            回答 #1

赞同：9

时间：2009-02-10T04:47:08.393

我同意 Vinegar 的观点：不排除 Swing。我已经使用 Swing 和 SWT 进行了开发，但没有使用 Qt。使用 Swing，您的代码将自动跨平台。使用 SWT，您的代码是跨平台的，虽然没有那么大的努力，但需要一点努力。您打算实现本地应用程序、Applet 还是 Web Start 应用程序？

SWT 的优点是它使用所有本机小部件。（熟悉的外观。） SWT 的缺点是它使用所有本机小部件。（没有 Swing 那么多的小部件）这更多的是优势还是劣势取决于您在做什么以及您的目标是什么。这意味着 Swing 具有更广泛的小部件。然而，SWT 做的一些事情 Swing 做得不好（或根本不做）——例如启动系统的本机浏览器并在此浏览器中执行 JavaScript 脚本。

如果您考虑 SWT，请仔细考虑。如果您有某些需求（例如在应用程序启动的浏览器窗口中执行 JavaScript），那么它可能是您的最佳选择。但是，如果 Swing 能够完全满足您的需求，它可能是一个更好的选择。

希望其他人可以提供有关 Qt Jambi 的信息。

请注意，支持应该是您做出决定的考虑因素。使用 SWT，有一个较小的社区支持它。Swing 是一个更大的社区，但这并不意味着修复会更快地进入开发版本。使用 Qt Jambi 和 SWT，如果修复了错误，您只需将更新的库与您的应用程序一起分发。使用 Swing，您必须等待更新的 JRE。两者都不一定会破坏交易，但必须加以考虑。

许可费可能是也可能不是考虑因素。当然，SWT 和 Swing 没有许可费 Jambi 我不知道这两种方式，但这可能取决于您的预期用途——例如，您是分发 GPL 应用程序，还是商业许可的应用程序。

祝你好运。

            回答 #2

赞同：4

时间：2009-02-10T15:55:14.007

我没有使用 SWT 的经验，但我也在使用 Jambi/Qt、Swing 和 GTK。我认为 Qt/Jambi 的唯一问题是许可（您必须在 GPL 下发布您的软件或购买商业许可）。您不能开始免费编写软件，然后“看看会发生什么”。您必须确保您的软件会成功，因为您必须购买许可证。这在很多时候并非如此。

问候。

哎呀，我忽略了那些评论，谢谢你的回复。这是个好消息！诺基亚的好举措。

@cursa 没有说，所以还要注意 Qt/Jambi 不仅仅是小部件工具包。您有用于网络、字符串操作（以及正则表达式引擎）、互斥体、2d 矢量和光栅图形、openGL 等的类。这为应用程序开发提供了真正的推动力。

我还建议将 Qt 包下载到 Jambi noobies，因为 Jambi 缺少非常好的帮助浏览器，称为 Assistant。Qt 和 Jambi 的所有 API 都是相同的（除了槽和信号），甚至文档都没有改变，因此您可以互换使用它。

            回答 #3

赞同：4

时间：2009-03-13T17:25:09.920

您知道 Qt Jambi 在本月 4.5 版本发布后停产了吗？这并不是一个糟糕的选择。Qt 有其他社区维护的语言绑定，它们不在奇趣科技的控制范围内。

[http://www.qtsoftware.com/about/news/preview-of-final-qt-jambi-release-available](http://www.qtsoftware.com/about/news/preview-of-final-qt-jambi-release-available) 

            回答 #4

赞同：0

时间：2009-10-14T18:27:36.100

我不会排除 SWT，因为它在日食世界中取得了巨大的成功。我已经愉快地使用它大约 6 年了，从来没有求助于摇摆。  

            回答 #5

赞同：-1

时间：2009-02-17T10:16:09.070

我不会推荐 SWT。SWT 是一个设计糟糕的库，有很多 hack 和 bug。您将一直在寻找简单 UI 任务的解决方法

        asp.net - 带有 ASP.NET 的 LaTeX

ID：530939

赞同：1

时间：2009-02-10T03:02:09.083

标签：asp.net, latex

我需要在 ASP.NET 中动态创建数学表达式，就像：

[这个](http://rogercortesi.com/eqn/index.php)

但是，我看过[mimeTeX](http://www.forkosh.com/mimetex.html)，想知道是否有人知道其他解决方案？我想在服务器上使用[TeX](http://en.wikipedia.org/wiki/TeX)而不需要 LaTeX。

谢谢您的意见。

            回答 #1

赞同：1

时间：2011-02-18T11:17:19.760

[http://www.mathjax.org](http://www.mathjax.org) provides a javascript library to render TeX and MathML based contents.

            回答 #2

赞同：1

时间：2009-02-10T06:36:03.407

[Matplotlib](http://matplotlib.sf.net)有一个类似 TeX 的数学排版引擎，适用于单个公式。它的先决条件包括[Python](http://www.python.org)和[numpy](http://numpy.scipy.org)，但它可能仍会小于完整的 TeX 分发树。听说有人要在Google SoC项目中提取渲染引擎，使其成为独立的Python库，但没有听说他们是否成功。

            回答 #3

赞同：1

时间：2009-02-10T03:53:32.547

这与这个问题非常相似，我认为：

[LaTeX 相当于 Google Chart API](https://stackoverflow.com/questions/516406/latex-equivalent-to-google-chart-api)

我的回答是：

有一种称为“mathtran”的现代服务，它为这类事情提供了一种强大而快速的方法：http:   [//www.mathtran.org/](http://www.mathtran.org/)

最大的警告是只允许使用 TeX 数学命令；尤其是 AMSLaTeX 不受支持。

        html - 我可以在内容加载之前更改或控制 IFRAME 区域的颜色吗？

ID：530943

赞同：2

时间：2009-02-10T03:04:59.263

标签：html, css, internet-explorer, iframe

**可能重复：**

  [fb like 按钮在所有 ie 版本中的页面 onload 上创建白色背景](https://stackoverflow.com/questions/6438502/fb-like-button-creates-a-white-background-on-page-onload-in-all-ie-versions)  

我有一个网站，其中部分内容被加载到 IFrame 中。

我遇到的问题是 iFrame 的内部内容在页面本身加载之前是白色的，并且内容具有不同的背景颜色（在本例中为蓝色）。所以我在屏幕上有这些白色方块，直到内容加载。

有没有办法指定空 IFrame 应该呈现什么颜色，直到它有内容？

或者我在这里采取了错误的策略 - 有没有一种好方法可以防止页面呈现直到内容准备好显示？

**更新：**看起来我正在描述的“白色区域”位是特定于 IE 的。

            回答 #1

赞同：3

时间：2009-02-10T03:56:54.537

这不是太难：

`<iframe id="IFR" src="time.php" style="background-color: #f00;" />`

编辑：我忽略了在 IE 中进行测试——它在 FireFox 中确实有效。示例：[http ://beta.tagcloud.com/contain.html](http://beta.tagcloud.com/contain.html)

该示例演示页面快速切换为全红色，然后当 iframe 加载时（在 5 秒内），它切换为黑色。

            回答 #2

赞同：2

时间：2009-09-02T20:59:51.020

这让我发疯，但我实际上找到了一个似乎适用于 IE6 和 7 的解决方案。尚未在其他浏览器中进行测试，但 Firefox 似乎无论如何都能正确地做到这一点。

如果加载时不显示 iframe，问题就解决了，但是 iframe 似乎会立即触发“onload”，所以在发出警报后，我注意到它会触发 onload 两次，一次是在页面加载时，然后再次触发一次 iframe页面加载如此...

```
<iframe id="theFrame" src="frame.html" style="display:none;" onload="loadFrame();"></iframe>

//这里是相关的javascript
负载计数 = 1;
函数加载帧（）{
  if(loadCount > 1) { //这可以防止脚本在第一次触发时显示帧
    document.getElementById('theFrame').style.display='';
    返回;
  }
  负载计数++；
}

```

            回答 #3

赞同：1

时间：2009-02-10T03:15:10.190

您也许可以`iframe`在加载内容之前设置 's 文档并设置其样式。

或者您可以使用 Ajax 而不会遇到这些问题。=]（当然，假设它是否适合该任务。）

            回答 #4

赞同：0

时间：2012-08-15T17:31:53.623

解决此问题的最简单方法是在 iframe 准备好之前不显示它。这样你就可以在 iframe 下设置你想要的任何背景。您设置背景并防止显示 iframe，直到像这样加载：

```
<div style="background-color:#XXXXX">
  <iframe src="..." style="visibility:hidden;" onload="this.style.visibility='visible';"></iframe>
</div> 
```

唯一的缺点是如果您的访问者关闭了 js，他们将不会看到 iframe。如果这是您关心的问题，请查看[http://css-tricks.com/prevent-white-flash-iframe/](http://css-tricks.com/prevent-white-flash-iframe/)

        java - 覆盖生成的 Java 源代码中的行号

ID：530945

赞同：15

时间：2009-02-10T03:08:39.160

标签：java, annotations, code-generation, janino

有没有办法覆盖 Java 中的行号（例如，通过使用某种预处理器指令）？

我正在“编译”一种高级语言，使用 Janino 编译成 Java 字节码。我需要编译器错误来报告原始文件中的行，而不是生成的 Java 代码。

C# 有#line 指令，我已经成功地利用它来将源文件中的行号映射到编译结果。我需要同样的Java。

谢谢！

            回答 #1

赞同：10

时间：2009-02-10T03:25:47.933

我从未见过它用于除 JSP 之外的其他用途，但[JSR-45](http://jcp.org/aboutJava/communityprocess/review/jsr045/index.html)旨在用于任何源语言的此目的。该过程涉及以特殊格式（“SMAP”）创建第二个文件，该文件将原始源代码中的行号映射到生成的 Java 源代码中的行号。

            回答 #2

赞同：4

时间：2009-02-10T03:13:15.297

不幸的是，不，Java 中没有等效的`#line`指令。您可以做的最好的事情是通过删除/插入换行符以匹配真实源代码（或修改代码生成器）在生成源代码后对其进行修改。或者，您可以在编译后修改二进制类文件中存储的行号，但这可能会更加痛苦。

            回答 #3

赞同：4

时间：2009-03-15T13:04:54.547

使用 Janino，您可以派生`Scanner`并覆盖该`location()`方法。此方法返回一个 Location 对象。您可以重写该`read()`方法以查找注释，例如在注释中（在代码生成期间添加），这些注释包含行号信息。

您只需将扫描仪传递*给*该`SimpleCompiler.cook()`方法，您就可以控制报告错误的文件名、行和列。

            回答 #4

赞同：3

时间：2009-02-10T10:01:50.570

您可以尝试使用 JVM 汇编器，而不是生成 Java 代码作为中间语言。[Jasmin](http://jasmin.sf.net)的语法很好，您可以在代码中的适当位置随意插入 .line 指令。您还可以使用 .source 指令指定原始源文件。

诚然，走汇编路线可能比它的价值更麻烦:)

            回答 #5

赞同：1

时间：2009-02-10T03:18:23.100

没有简单的解决方案。一种解决方法是在生成代码时生成从 [您的语言] 到 Java 的行号映射。您可以管道编译器输出并使用映射将 Java 的行号替换为您的行号。

        javascript - 识别 JavaScript 中的 lastclick

ID：530958

赞同：1

时间：2009-02-10T03:17:19.483

标签：javascript, events

我需要获得最后一次点击参数。

我的 JavaScript 代码：

```
 <a href="#" onclick="show(fid1,1);">Link1</a>
 <a href="#" onclick="show(fid2,2);">Link2</a>
 <a href="#" onclick="show(fid3,2);">Link3</a> 
```

现在我需要另一个 JavaScript 函数来找出最后一次点击显示函数的参数。我该怎么做？

```
function LastclickId(){
    //Code
} 
```

            回答 #1

赞同：3

时间：2009-02-10T03:32:11.617

如果我正确理解你的问题，你想跟踪最近的论点`show()`，对吧？如果这确实是您想要做的，您可以将两个变量添加到您的全局命名空间，并在您调用时分配值`show()`：

```
last_foo = 0; // Global namespace
last_bar = 0;

function show(foo, bar) {
    last_foo = foo;
    last_bar = bar;

    ...
} 
```

然后在该页面上的任何函数中，您可以从`last_foo`和获取值`last_bar`。

            回答 #2

赞同：0

时间：2009-02-10T04:28:55.847

如果您不喜欢使用全局变量，可以将相关方法包装到单个对象中：

```
var yourObject = function () {

  // private members...
  var lastClicked;

  function setLastClicked(id, n) {
    lastClicked = id + "," + n
  }

  return {

      // public members...
      show: function (foo, bar) {
          // ....
          setLastClicked(foo, bar);
      },

      getLastClicked: function(){
          alert(lastClicked);
      },
}; 
```

}();

            回答 #3

赞同：0

时间：2009-02-10T03:29:35.117

在 show 函数中设置一个全局变量。然后在 lastClickID 函数中读取它。

        ruby - 在 Ruby 中打印非字符串的最简单方法

ID：530963

赞同：2

时间：2009-02-10T03:19:39.243

标签：ruby, syntax

我经常这样做

```
puts “The temperature is “ + String(temperature) + “.” 
```

在我的调试代码中，另一个选择是使用插值

```
puts “The temperature is #{temperature}.” 
```

有没有更简单的方法来做到这一点？

**编辑：**这只是为了调试，如果这很重要的话。

            回答 #1

赞同：6

时间：2009-02-10T03:35:25.383

对于像这样的小案例来说，没有什么是值得的。

不过，您应该更喜欢插值，因为它比串联便宜。

            回答 #2

赞同：2

时间：2009-02-10T03:38:46.780

将动态变量插入字符串的最佳方法是

```
#interpolation
"foo #{my_var} bar" 
```

它将`to_s`在表达式返回的任何对象上调用该方法并插入该字符串。它真的和

```
#concatenation
"foo " + my_var.to_s + " bar" 
```

但是，正如 wfarr 所提到的，插值更快。也更容易阅读。

            回答 #3

赞同：1

时间：2009-02-10T16:28:52.333

稍微不同的方法是在自动化测试中使用断言。

例如使用 Test::Unit :-

```
assert_equal 25, temperature 
```

我发现使用自动化测试大大减少了我必须编写的调试代码量。

            回答 #4

赞同：1

时间：2009-02-12T15:55:47.933

使用[内核#p](http://www.ruby-doc.org/core/classes/Kernel.html#M006002)

```
p temperature #=> 10.25 
```

在调试时，我经常通过复制行并使用插入冒号将变量变成符号来标记此类语句。

```
p :attributes #=> :attributes
p attributes  #=> { :mood => "happy", 5 => [] } 
```

或者

```
p [:location, location] #=> [ :location, "@ work" ] 
```

请注意，Kernel#p 在其参数上调用 #inspect，而不是 #to_s，但这通常会提供更有用的调试信息。

            回答 #5

赞同：1

时间：2012-10-11T22:10:56.390

我强烈推荐使用包含 awesome_print 或 awesome_print 的 irbtools gem。我个人发现在 dev 中使用它更快、更简单，然后使用插值字符串，有时这是唯一的方法。

您可以在任何对象上执行此操作，它将为您提供格式良好的输出，可以是数组、字符串或散列，甚至是您可能拥有的任何其他复杂对象 - 例如打印为树结构的 3 维数组。为了让它在你的 Rails 环境中可用 - 只需将它包含在开发组的 Gemfile 中，或将其添加到 .irbrc - 始终将它放在你的 irb 控制台中。然后就做

```
require "awesome_print"
ap  MyGreatObject 
```

这是我的一个项目的示例输出

```
ap Address
class Address < ActiveRecord::Base {
                  :id => :integer,
      :address_line_1 => :string,
      :address_line_2 => :string,
      :address_line_3 => :string,
                :city => :string,
               :state => :string,
                 :zip => :string,
             :country => :string,
                :attn => :string,
         :category_id => :integer,
      :addressable_id => :integer,
    :addressable_type => :string,
          :created_at => :datetime,
          :updated_at => :datetime
}

 ap Address.first
  Address Load (1.0ms)  SELECT `addresses`.* FROM `addresses` LIMIT 1
#<Address:0x7bc5a00> {
                  :id => 1,
      :address_line_1 => "1 Sample Drive",
      :address_line_2 => nil,
      :address_line_3 => nil,
                :city => "Chicago",
               :state => "IL",
                 :zip => "60625",
             :country => "USA",
                :attn => nil,
         :category_id => 1,
      :addressable_id => 1,
    :addressable_type => "Warehouse",
          :created_at => Tue, 10 Jan 2012 14:42:20 CST -06:00,
          :updated_at => Tue, 17 Jan 2012 15:03:20 CST -06:00
} 
```

            回答 #6

赞同：0

时间：2009-02-10T13:12:15.800

总是有可能使用`printf`样式格式：

```
"The temperature is %s" % temperature 
```

这也将允许对数字等进行更精细的格式化。`#{}`但老实说，你能期望得到  比使用插值少多少“麻烦” ？

            回答 #7

赞同：0

时间：2009-02-10T13:14:22.113

另一种方法是做一些像这样愚蠢的事情：

 `"The temperature is %s." % temperature.to_s` 

我个人会使用插值

        java - jSecurity JDBCRealm SQL 设置

ID：530972

赞同：1

时间：2009-02-10T03:29:00.720

标签：java, sql, security, jdbc, jsecurity

我正在尝试将 jSecurity 用于企业 Java 应用程序，但文档......嗯......缺乏。

有没有人在 SO-land 能够获得 JDBCRealm 设置，如果是这样，您是否找到了 SQL 设置脚本，或者您是否只是自己派生了它？无论哪种方式，您能否提供创建 SQL 语句来完成这项工作？

[我已在此处](http://www.jsecurity.org/node/1075)发布到邮件列表，但我不知道是否\何时我会收到回复\我没有很长时间等待。

提前致谢！

            回答 #1

赞同：1

时间：2009-02-10T22:13:24.487

据我所知，就是这样（或者在大多数情况下都可以很好地工作）：

```
CREATE TABLE [dbo].[users](
    [username] [varchar](50) NOT NULL,
    [password] [varchar](50) NOT NULL
)

CREATE TABLE [dbo].[user_roles](
    [username] [varchar](50) NOT NULL,
    [role_name] [varchar](50) NOT NULL
)

CREATE TABLE [dbo].[roles_permissions](
    [role_name] [varchar](50) NOT NULL,
    [permission] [varchar](50) NOT NULL
) 
```

[编辑：如果您使用的是 Maven，您的 POM 中还需要 ehcache 和 commons-logging]

        .net - Web 服务数组大小限制

ID：530975

赞同：1

时间：2009-02-10T03:30:58.233

标签：.net, web-services, arrays, configuration

我的网络方法不断出错，调查最终揭示了以下内容：

格式化程序在尝试反序列化消息时抛出异常：反序列化操作“SendFirmware”的请求消息正文时出错。读取 XML 数据时已超出最大数组长度配额 (16384)。可以通过更改创建 XML 阅读器时使用的 XmlDictionaryReaderQuotas 对象的 MaxArrayLength 属性来增加此配额。

有问题的数组是`byte[]`包含方法名称中提到的固件映像的。这就是为什么它有这么多元素。好的，太棒了，现在我知道出了什么问题，如果我明确地管理 XML，那将不是问题。但我不是，这都是隐含的。

如何在 Web 服务的配置文件中设置它？

            回答 #1

赞同：6

时间：2009-02-10T03:46:56.697

这可以在以下部分的 web.config 文件中设置：

```
<system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="BasicHttpBinding" maxBufferSize="2147483647" 
               maxReceivedMessageSize="2147483647">
          <readerQuotas maxDepth="32" maxStringContentLength="8388608" 
               maxArrayLength="16384" maxBytesPerRead="4096" 
               maxNameTableCharCount="16384" />
        </binding>
      </basicHttpBinding>
    </bindings>
</system.serviceModel> 
```

        c++ - QWidget 中的浮动/嵌入式 QDockWidget（在 QT Designer 中设计的 KXmlGuiWindow 的 CentralWidget）

ID：530992

赞同：0

时间：2009-02-10T03:42:43.587

标签：c++, qt, qt4, kde, kdevelop

我只是想进入 QT（和 KDE）程序，并且遇到了一个障碍，试图向嵌入到我的 KDE 4 程序`QDockWidget`中的 .ui 文件（基于 a ）添加一个可浮动、可拖动的文件。`QWidget`

这一切都来自 KDevelop 4 提供的基本模板，所以虽然我了解发生了什么，但我只是不知道更改它的最佳方法。

这是交易：main.cpp 生成一个新`AEmpire`窗口，开始整个展示：

```
AEmpire::AEmpire()
       : KXmlGuiWindow(),
         m_view(new AEmpireView(this)),
         m_printer(0)
{
    // tell the KXmlGuiWindow that this is indeed the main widget
    setCentralWidget(m_view);

    setupActions();
    setupGUI();
} 
```

当一个 new`AEmpireView(this)`被创建（继承自`QWidget`）并被分配给 m_view 时，这个构造函数被调用：

```
AEmpireView::AEmpireView(QWidget *)
{
    ui_aempireview_base.setupUi(this);
    settingsChanged();
    setAutoFillBackground(true);
} 
```

所以，当我在 QT Designer 中编辑我的程序的 ui 时，我实际上是在编辑`AEmpireView_base`ui 文件，它是一个`QWidget`. 它仅代表`KXmlGuiWindow`（派生自`QMainWindow`）的主视图，并在运行时加载。

那么，如何将可浮动、可拖动`QDockWidget`的 s 添加到我的主应用程序中？单独设计它们并将它们添加到 UI 中是最佳选择吗？或者可能删除整个`AEmpireView`类，并使我的 ui 文件直接表示`KXmlGuiWindow`要由`AEmpireClass`?

还是我完全忽略了一些明显的东西？谢谢阅读！

            回答 #1

赞同：1

时间：2009-02-24T17:06:06.593

I would design the QDockWidget contents as separate UI files. Then create them and stick them into the QDockWidgets in the AEmpire constructor.

        windows - 你如何让 DirectShow 播放资源中的视频？

ID：530998

赞同：1

时间：2009-02-10T03:47:11.923

标签：windows, directshow, native

我正在扩展一个应用程序以在对话框中的控件上播放多个视频之一。从 Windowless 示例开始，我已经完成了这项工作，尽管视频必须是与主可执行文件分开的文件。

从打包的角度来看，理想的情况是将视频作为资源包含在可执行文件中。我为此做了一些谷歌搜索，有相当多的“有人应该这样做”，还有几个指向异步示例的指针，尽管不清楚如何从那里得到我想要的地方。

有谁知道一个简单的方法来做到这一点？看起来这不是一个角落案例，我有点惊讶它不在盒​​子里。

            回答 #1

赞同：3

时间：2009-03-28T11:18:02.717

在 DirectShow SDK 中寻找***[异步过滤器示例](http://msdn.microsoft.com/en-us/library/dd317573(VS.85).aspx)***，它有一个叫做 CMemStream 的东西，它可以从内存中流式传输数据（读取：媒体）。
[有关此博客文章的更多信息](http://blogs.msdn.com/mikewasson/archive/2008/01/24/async-filter-sample.aspx)

            回答 #2

赞同：0

时间：2009-02-10T03:58:11.710

为什么不从 EXE/DLL 中提取视频并将其存储在临时路径中？然后播放临时文件。

```***** 
```****