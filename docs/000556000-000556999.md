# StackOverflow 问答 000556000-000556999

# iphone - UIWebView 重叠

> ID：556003
> 
> 赞同：0
> 
> 时间：2009-02-17T08:53:01.233
> 
> 标签：iphone

大家下午好，我正在开发一个 iPhone 网络应用程序。在我的应用程序中，我在一个 UIWebView 中加载了两个网页。此过程完成后，一个网页应在获得用户交互时隐藏或重叠其他网页。但是，我还不需要这个。到目前为止，用户交互也应该保持不变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-26T13:59:06.757

一个 UIWebView 中不能有两个不同的网页。相反，您应该尝试创建两个 UIWebView 对象并将它们作为子视图添加到容器视图中。

您可以根据需要设置这些 UIWebView 对象的`frame`, `userInteractionEnabled`,`hidden`属性。

此外，您应该查看 UIWebView 的委托方法。当页面完成加载或出现错误时调用这些委托方法。您可以阅读文档以了解有关委托方法的更多信息： [UIWebViewDelegate 文档](http://developer.apple.com/iphone/library/documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UIWebViewDelegate)

# unit-testing - 如果您已经进行了功能测试，是否还需要进行单元和集成测试？

> ID：556006
> 
> 赞同：4
> 
> 时间：2009-02-17T08:54:33.180
> 
> 标签：unit-testing, testing, scrum, integration-testing, functional-testing

我公司的人认为单元测试是很多额外的工作，与现有的功能测试相比，它提供的好处更少。单元和集成测试值得吗？请注意在设计时并未考虑测试的大型现有代码库。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-17T09:09:13.037

大多数人不知道自动化单元测试的用途：

1.  尝试新技术
2.  记录如何使用部分代码
3.  确保死虫保持死状态
4.  为了让你重构代码
5.  允许您更改代码的任何主要部分
6.  创建一个较低的水印，低于该水印，您的产品质量不可能下降
7.  提高开发速度，因为现在，您*知道*某些东西有效（而不是希望它在客户报告错误之前有效）。

因此，如果这些原因中的任何一个给您带来好处，那么自动化单元测试就适合您。如果没有，那么不要浪费你的时间。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-17T09:07:02.247

（我假设您使用“功能测试”来表示涉及整个系统或应用程序启动并运行的测试。）

我会在编写新功能时对*新*功能进行单元测试，原因有以下三个：

*   它可以帮助我更快地编写工作代码。“单元测试失败，修复代码，单元测试通过”的周转时间通常*比*“功能测试失败，修复代码，功能测试通过”要短很多。
*   它帮助我以更简洁的方式设计我的代码
*   它可以帮助我理解我的代码以及在我来维护它时它意味着什么。如果我做出改变，它会让我更有信心，我没有破坏任何东西。

（这包括 Epaga 建议的错误修复。）

我强烈推荐 Michael Feathers 的[“Working Effectively with Legacy Code”](https://rads.stackoverflow.com/amzn/click/com/0131177052)，为您提供有关如何开始对不是为它设计的代码库进行单元测试的提示。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-17T09:02:14.677

这取决于您的功能测试是自动完成还是手动完成。如果是后者，那么任何类型的自动化测试套件都是有用的，因为运行这些单元/集成测试的成本远低于运行手动功能测试。您可以在那里显示真实的投资回报率。我建议从编写一些集成测试开始，如果将来时间/预算允许，那么看看单元测试。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T09:06:07.567

为遗留代码追溯编写单元测试通常是不值得的。坚持功能测试，并自动化它们。

然后我们所做的是制定任何错误修复（或新功能）必须伴随单元测试的指南，至少测试修复。这样，您至少可以使项目朝着正确的方向发展。

而且我必须同意 Jon Skeet（我怎么能不同意？）推荐“[有效地使用旧代码](https://rads.stackoverflow.com/amzn/click/com/0131177052)”，这确实是一个有用的略读/阅读。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-17T13:32:47.037

碰巧，我昨晚读[了一篇](http://research.microsoft.com/en-us/projects/esm/nagappan_tdd.pdf)关于这个主题的论文。作者比较了 Microsoft 和 IBM 四个小组内的项目，事后对比了同时使用单元测试和功能测试的项目以及单独使用功能测试的项目。引用作者的话：

> “案例研究的结果表明，与未使用 TDD 实践的类似项目相比，这四种产品的预览版缺陷密度降低了 40% 到 90%。主观上，团队的初始版本增加了 15% 到 35%。采用 TDD 后的开发时间。”

这表明当您向项目添加新功能时，进行单元测试当然是值得的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T09:07:31.450

是的，它们是值得的，自从我开始对我的代码进行单元测试以来，我现在的编码速度更快了。我花更少的时间修复错误，而花更多的时间思考我的代码应该做什么。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-17T09:39:50.047

我被买来咨询 FAT（测试）的一个应用程序包含一个 21,000 行的 switch 语句。大多数功能单元在案例语句中只有几十到几百行。该应用程序是在几个变体中构建的，因此开关中有许多#ifdef 部分。

它不是为单元测试而设计的——它根本没有被考虑在内。

（它是在某种意义上设计的，有一个明确的、易于理解的体系结构 - malloc 一个结构，向主循环发送一条用户消息，其中包含指向该结构的指针作为 lparam，然后在处理消息时释放它。但形式确实不遵循功能，这是好的设计的中心原则。）

将单元测试添加到新功能将意味着与模式的重大突破；要么您需要将代码放在大开关以外的地方，并使变体选择机制的复杂性加倍，要么制作大量脚手架将消息放入队列中以触发新功能。

因此，尽管对新功能进行单元测试肯定是可取的，但如果系统还没有很好地考虑因素，这并不总是可行的。要么有大量工作来重构系统以允许单元测试，要么您最终对代码进行基准测试并将其剪切并粘贴到现有框架中 - 单元测试代码的副本不是单元测试代码。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-20T15:34:23.100

当您想了解某事时，您进行测试。如果您知道您的产品（系统、单元、服务、组件...）可以正常工作，则无需对其进行测试。如果您不确定它是否会起作用，您可能对此有一些疑问。这些问题是否值得回答是风险和优先事项的问题。

如果你确定你的产品可以工作，并且你对它没有任何疑问，那么还有一个问题值得问：为什么我没有任何问题？

---迈克尔 B.

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-02-10T12:49:03.907

单元测试确实是额外的工作，但从长远来看它是有回报的。以下是集成测试的优势：

*   你会得到一个回归套件，它在重构时充当安全网——集成测试也是如此，尽管很难说测试是否涵盖了一段代码。
*   单元测试在修改代码时会立即给出反馈——这种反馈可能非常准确，指向异常所在的方法。
*   这些测试运行起来很便宜：它们运行速度非常快（通常几秒钟），无需任何安装或部署，只需**编译和测试**。所以它们可以经常运行。
*   一旦发现问题，很容易添加一个新测试来重现问题，它会增加回归套件或回答问题（“如果不使用空参数调用此函数会发生什么......”）。

两者之间显然有一些重叠，但它们是互补的，因为它们都具有优势。

现在，就像任何软件工程过程一样，测试必须根据项目需要进行定制。

对于大型遗留代码库，即未进行单元测试的遗留代码，我建议将单元测试限制为添加到代码中的新功能，因为单元测试可能很难引入。在这方面，我只能第二（第三？）“有效地使用遗留代码”一书的建议，以帮助将单元测试引入现有代码库。

# c# - 需要在连接字符串上指定提供者吗？

> ID：556014
> 
> 赞同：1
> 
> 时间：2009-02-17T08:59:18.083
> 
> 标签：c#, sql, database, connection-string

我的应用程序有一个非常有趣的问题，我收到如下错误： System.ArgumentException：ConnectionString 中未指定 OLE DB 提供程序。例如，'Provider=SQLOLEDB;'。

但是，当我尝试将连接上的提供程序指定为 Provider=SQLOLEDB.1 或 Provider=SQLOLEDB 时，我收到另一个错误，提示关键字“Provider”无效。

但是我注意到一件事，我的目标计算机有 2 个不同的数据库系统，这会导致这个错误吗？

知道如何解决这个问题吗？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T09:06:36.523

假设您使用的是 ADO.NET，如果您想使用不同的数据库系统，那么您也需要更正 DbConnection，而不仅仅是连接字符串。

请注意，您不能使用`SqlConnection`for OLEDB，您需要改为使用`System.Data.OleDb.OleDbConnection`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T09:05:53.747

看起来您缺少一些连接字符串 - 试试这些

通用连接字符串：

```
strConnect = _T("Provider=sqloledb;Data Source=MyServerName;"
        "Initial Catalog=MyDatabaseName;"
        "User Id=MyUsername;Password=MyPassword;"); 
```

命名实例连接字符串：

```
strConnect = _T("Provider=sqloledb;Data Source=MyServerName\MyInstanceName;"
    "Initial Catalog=MyDatabaseName;User Id=MyUsername;Password=MyPassword;"); 
```

可信安全：

```
strConnect = _T("Provider=sqloledb;Data Source=MyServerName;"
        "Initial Catalog=MyDatabaseName;"
        "Integrated Security=SSPI;"); 
```

从这里[http://www.codeproject.com/KB/database/connectionstrings.aspx#OLE](http://www.codeproject.com/KB/database/connectionstrings.aspx#OLE) DB SqlServer

# sql-server-2005 - 跨数据库权限问题

> ID：556036
> 
> 赞同：1
> 
> 时间：2009-02-17T09:06:21.313
> 
> 标签：sql-server-2005

谁能帮我解决这个问题？

我在同一台服务器上有 2 个数据库，都归 sa 所有。Windows 登录有权执行数据库 A 中的存储过程，该过程从表数据库 B 中选择数据。存储过程和表也都归 dbo 所有。Windows 登录是 Windows 域组的成员，该域组是数据库 A 中具有执行存储过程的权限的数据库角色的成员，但没有直接授予或拒绝对数据库 B 的任何权限。登录能够在使用数据库 A 的数据库 A 中执行存储过程，以及访问登录已经有权访问的其他数据库的其他过程，但是当它尝试执行此存储过程时，它会生成错误“服务器主体”不是能够在当前安全上下文下访问数据库“B”。”

是否像您必须在服务器和数据库级别启用跨数据库所有权链接一样简单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T09:45:03.467

如果您在服务器级别启用跨数据库链接，则从内存中它可用于所有数据库，您不必在数据库级别专门设置它。

你是如何设置链接的？对于某些系统设置，需要重新启动，或者您可以在查询窗口中运行 RECONFIGURE 命令。

[http://msdn.microsoft.com/en-us/library/ms176069(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms176069(SQL.90).aspx)

# c# - 如何在中继器中设置 DropDownList 的选定值？

> ID：556044
> 
> 赞同：1
> 
> 时间：2009-02-17T09:09:39.790
> 
> 标签：c#, asp.net, data-binding, drop-down-menu, repeater

我需要创建一组`DropDownList`s 来显示并允许更改项目的属性组。

我的 ASP 页面上有以下代码。

```
<asp:Repeater runat="server" ID="repeaterProperties">
    <ItemTemplate>
        <p><asp:DropDownList runat="server" ID="ddProperty" OnInit="ddProperty_OnInit" /><p>
    </ItemTemplate>
</asp:Repeater> 
```

使用数据库查询`ddProperty_OnInit`填充所有可能的值。`DropDownList`

如何`DropDownList`根据`Repeater`源数据设置每个创建的选定值？

`A`例如，假设我们有 和 的可能属性`B`值`C`。
如果 的数据库输出`Repeater`包含其中两个值`A`和`B`，则`Repeater`输出两个`DropDownList`s，所有 3 个值都可用，第一个`A`值作为选定值，第二个`B`值作为选定值。

**编辑：**在我的情况下，
似乎添加并选择适当的值并不是可行的方法。这是因为我还需要将可能更改的值保存到数据库中。`OnItemDataBound="repeater_ItemDataBound"``Repeater`

的`ItemDataBound`事件在 a 上的事件`Repeater`之前触发，并在保存新选择之前将所选值更改为其旧值。`OnClick``Button`

关于如何解决这个问题的任何建议？

*当前代码：*

```
<asp:Repeater runat="server" ID="repeaterJako" OnItemDataBound="repeater_ItemDataBound">
<ItemTemplate>
    <asp:DropDownList id="ddJako" runat="server" OnInit="ddJako_OnInit">
    </asp:DropDownList><br />
</ItemTemplate>
</asp:Repeater>
<asp:Button runat="server" id="updateButton" Text="Save" OnClick="update_OnClick" /> 
```

在代码隐藏中，`ddJako_OnInit`使用所有可能的选择填充下拉列表，同时`repeater_ItemDataBound`使用 Bryan Parker 建议的方法来选择正确的值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T10:45:44.117

也许我误解了你的问题......但这似乎正是 OnItemDataBound 的用途。:)

使用 FindControl 在事件处理程序中获取对 DropDownList 的引用。还要检查以确保该项目不是页眉/页脚。来自 MSDN 的示例做了以下两件事：

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.onitemdatabound.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.repeater.onitemdatabound.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-24T08:07:51.427

关于我在编辑中指定的问题，时间`DataBind`起着重要作用。我曾经在`Page_Init`事件中进行数据绑定，这导致事件在事件`repeater_ItemDataBound`之前被触发`button_OnClick`。

解决方案是将数据绑定移至`Page_PreRender`事件。
拥有所有选择的人口`DropDownList`仍然在其`OnInit`事件中完成。

# ruby-on-rails - 对 Rails 工作流程实施有什么建议吗？

> ID：556045
> 
> 赞同：5
> 
> 时间：2009-02-17T09:09:51.443
> 
> 标签：ruby-on-rails, ruby, workflow, state-machine

有人有使用 Rails 工作流插件的经验吗？ [路线](http://openwferu.rubyforge.org/)/OpenWFEru。

我正在寻找具有基于角色的编辑、提交、批准、回滚等状态的 CMS 类型工作流。这个插件是不是有点矫枉过正？使用状态机 (AASM) 做同样的事情并充当可审计/充当版本控制会更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T12:00:43.653

您可能最好使用 AASM 或“工作流程”，即基于状态的工具（至少在开始时）。

Ruote 对于“业务流程”而不是“资源生命周期”更有意义。

一个有趣的组合是使用 ruote 来管理多个资源的状态（通过 aasm / 工作流）（如果你愿意，可以是文档）。有时，一个资源可能属于许多业务流程，并且可能表现出多个状态。

这一切都取决于您的要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-30T05:38:18.810

我推出了一个更简单的 AASM 替代方案。看看[https://github.com/alternegro/flojo](https://github.com/alternegro/flojo)

# perl - Perl 有没有类似 IPython / IRB 的东西？

> ID：556050
> 
> 赞同：19
> 
> 时间：2009-02-17T09:12:11.297
> 
> 标签：perl, shell

我已经习惯了在学习 Python 的同时使用 IPython 进行尝试，现在我必须学习 Perl 才能找到一份新工作。

有没有像 IPython for Perl 这样的东西？特别是，我对完成和获得帮助感兴趣。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-17T09:49:51.287

我通常只使用`perl -de0`，但我听说过：

*   [开发::REPL](http://search.cpan.org/perldoc?Devel%3A%3AREPL)
*   [perlconsole](http://www.sukria.net/perlconsole.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T09:32:46.130

通过使用“独立”调试器，您可以拥有一个功能较少的环境。

```
perl -de 42 
```

（42 只是一个常量，以便加载非空“脚本”）。

从那里，你可以`use My::Module`等等。我不确定是否有完整的类似 irb 的程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-23T20:57:06.033

[更新为最近的变化]

IPython 不再只是 Python；Jupyter 可用于任何具有[内核](https://github.com/ipython/ipython/wiki/IPython-kernels-for-other-languages)实现的语言。Zakariyya Mughal去年发布了一个[Perl 内核，所以我建议尝试/为此做出贡献。](https://metacpan.org/release/Devel-IPerl)

* * *

## 回答 #4

> 赞同：-6
> 
> 时间：2009-02-17T09:52:47.863

[来自 Perl 常见问题解答](http://www.perl.com/doc/FAQs/FAQ/oldfaq-html/Q3.7.html)：

> ## Perl 常见问题解答 3.7
> 
> # 有perl外壳吗？
> 
> 并不真地。Perl 是一种编程语言，而不是命令解释器。

这就是我从 Perl 转向 Python 的原因。无论如何，确实存在几种 python [shell 变通方法](http://www.google.co.il/search?q=%22perl+shell)，但它们甚至不接近 IPython

# java - 在 Java 中为公式生成图像

> ID：556060
> 
> 赞同：4
> 
> 时间：2009-02-17T09:17:27.603
> 
> 标签：java, image, formula

我想生成一个显示一些数学表达式的图像文件，以“（x + a）^ n = ∑_（k = 0）^ n”之类的字符串作为输入，并获得一个更（人类）可读的图像文件输出。例如，维基百科中使用了类似的 AFAIK 内容。是否有任何Java库可以做到这一点？

或者，也许我使用了错误的方法。如果要求将公式从 MS Word 粘贴到 HTML 文档中，您会怎么做？我会要求用户自己制作屏幕截图，但那是一种懒惰的方式^^

编辑：感谢到目前为止的答案，但我真的不控制输入。我得到的是一些凌乱的 Word 式公式，而不是干净的乳胶格式公式。

Edit2： http: [//www.panschk.de/text.tex](http://www.panschk.de/text.tex) 看起来有点像 LaTeX 不是吗？这就是我 `clipboard.getContents(RTFTransfer.getInstance())`从 Word07 粘贴公式后得到的结果。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T09:35:59.463

首先，您应该熟悉[TeX](http://en.wikipedia.org/wiki/TeX)（和[LaTeX](http://en.wikipedia.org/wiki/LaTeX)）——由 Donald Knuth 创建的著名排版系统。排版数学公式是一个高级主题，有很多观点和对细节的关注——因此使用[基于 TeX 的东西](http://schmidt.devlib.org/java/libraries-dvi.html)。这样你肯定会做对;-)

**编辑：**看看[texvc](http://en.wikipedia.org/wiki/Texvc)

它可以输出为 PNG、HTML、MathML。查看[自述文件](http://svn.wikimedia.org/viewvc/mediawiki/trunk/phase3/math/README?view=markup)

**编辑 #2**将那些乱七八糟[的文字转换为 TeX](http://www.tug.org/utilities/texconv/pctotex.html)或 MathML？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-14T14:42:14.377

我的同事为这个非常具体的问题找到了一个非常简单的解决方案：当您从 Word2007 复制公式时，它们也以“HTML”的形式存储在剪贴板中。由于在 HTML 中表示公式也不容易，Word 只是动态创建一个临时图像文件并将其嵌入到 HTML 代码中。然后，您可以简单地获取临时公式图像并将其复制到其他地方。问题解决了;）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T09:38:38.177

您正在寻找的是[Latex](http://en.wikipedia.org/wiki/LaTeX)。

[MikTex](http://miktex.org/)是一个不错的小应用程序，用于使用 LaTeX 制作图像。

不过，我想研究一下即时创建它们...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T11:17:49.357

避开 LaTeX。严重地。

查看[JEuclid](http://jeuclid.sourceforge.net/index.html)。它可以将 MathML 表达式转换为图像。

# php - 从数据库时间戳中提取详细信息

> ID：556063
> 
> 赞同：2
> 
> 时间：2009-02-17T09:19:31.967
> 
> 标签：php, mysql

我正在学习时间戳。我可以找到很多关于从当前时间戳中提取数据的信息，但很少有关于查询数据库时间戳的信息。例如，我想执行以下操作（语法不正确，但希望能说明我的问题）

```
SELECT * FROM database where timestamp DAY('12') AND MONTH('01') 
```

或者

```
SELECT * FROM database where timestamp MONTH('01') AND YEAR('2009') 
```

你能为我指出正确的方向吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T09:22:46.653

**您可以使用 MySQL 功能[`FROM_UNIXTIME()`](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_from-unixtime)。**

```
SELECT * FROM database WHERE DAY(FROM_UNIXTIME(timestamp)) = 12 
    AND MONTH(FROM_UNIXTIME(timestamp)) = 1

SELECT * FROM database WHERE MONTH(FROM_UNIXTIME(timestamp)) = 1
    AND YEAR(FROM_UNIXTIME(timestamp)) = 2009 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T09:26:21.793

对于第二种，更有效的方法是这样的：

```
SELECT *
FROM database
WHERE timestamp BETWEEN
    UNIX_TIMESTAMP('2009-01-01 00:00:00')
    AND
    UNIX_TIMESTAMP('2009-01-31 23:59:59') 
```

# c++ - 具有任意索引范围的类 STL 向量

> ID：556064
> 
> 赞同：1
> 
> 时间：2009-02-17T09:19:51.327
> 
> 标签：c++, stl, vector, deque

在访问复杂性、调整大小时重新分配等方面，我想要的是类似于 STL 向量的东西。我希望它支持任意索引范围，例如可以有索引从 -2 到 +7 或从 +5 到 + 的元素10\. 我希望能够有效地 push_front。我也想要双向调整大小...

我知道我可以自己写这样的东西，但是如果有一个已经写好的库支持这个，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T09:34:31.867

Deque 非常像一个向量，它支持随机访问和末尾的高效插入，也支持开头的高效插入。

Map 支持基于任意键的访问，你可以有任何你想要的范围，甚至是一个稀疏的数组。对集合的迭代很慢。

Unordered map (tr1) 与 map 类似，只是它支持更好的迭代。

作为一般的经验法则，使用向量（在您的情况下使其适应您想要的行为）并且仅在您有证据表明该向量导致缓慢时才进行更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T09:36:38.853

似乎您想要的和向量之间的唯一区别是访问元素所需的偏移量，如果通过重载运算符 [] 或其他东西，您会注意这一点。除非我不明白你所说的双向调整大小是什么意思。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-12-01T08:20:15.097

给你，双端矢量

[http://dl.dropbox.com/u/9496269/devector.h](http://dl.dropbox.com/u/9496269/devector.h)

**用法：**

*   之前保留内存`begin()`，使用`reserve(new_back_capacity, new_front_capcity);`

*   `push_front()`使用时除外，`pop_front()`始终`squeeze()`保留前容量。

*   `squeeze()`刷新所有未使用的内存

*   默认`namespace; stdext`

**概念：**

*   在大多数情况下，相当于`::std::vector`但具有 push_front 的能力

*   `::std::vector`与（不同于`::std::deque`）相比没有性能差异

*   四个字节的开销相比`::std::vector`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T11:38:11.930

如果您想要 2 路调整大小等...您可以创建自己的向量类，其中 2 个向量用于 0 和正值，另一个用于负值。

然后只需实现常用函数并添加新函数（例如：push_begin 添加到负索引向量），并更新里面的对应向量。

# .net - 复合控件文本框和 AutoCompleteExtender

> ID：556069
> 
> 赞同：2
> 
> 时间：2009-02-17T09:22:46.093
> 
> 标签：.net, .net-3.5, asp.net-ajax, ajaxcontroltoolkit

我正在尝试使复合 Web 控件包含 TextBox 和 AutoCompleteExtender 我遵循了这篇文章[http://byatool.com/?p=244](http://byatool.com/?p=244)当我运行页面时我什么都没有，只是空页面，我得到了这个

```
<div>
    <span id="AutoCompleteTextBox2" FirstRowSelected="false" OnClientPopulated="ClientPopulated" CompletionListHighlightedItemCssClass="autocomplete_highlightedListItem"></span>
</div> 
```

而不是文本框

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-18T11:24:55.603

我没有找到解决方案，但我改变了解决问题的方法，并像[本文一样基于脚本控件重建控件](http://byatool.com/?p=329)

# wpf - 获取基于浏览器的 WPF 应用程序的 URL

> ID：556071
> 
> 赞同：0
> 
> 时间：2009-02-17T09:23:06.153
> 
> 标签：wpf, xbap

有没有办法在 WPF 浏览器应用程序 XBAP 中获取当前浏览器位置 URL？我的意思是加载应用程序的位置。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T09:32:40.733

看看[http://learnwpf.com/Posts/Post.aspx?postId=dec2f67d-b80f-4773-ba02-35506b2250e9](http://learnwpf.com/Posts/Post.aspx?postId=dec2f67d-b80f-4773-ba02-35506b2250e9)

# sql - Oracle 11g 中的更新

> ID：556072
> 
> 赞同：2
> 
> 时间：2009-02-17T09:23:41.833
> 
> 标签：sql, oracle, sql-update

我必须更新表中的字段。我正在使用以下查询。帮帮我，哪一个是对的？

```
update table1
set col1=<value>,col2=<value>....
from table1 t,table2 s
where t.id=s.num
  and s.code='abc'; 
```

或者

```
update table1
set col1=<value>,col2=<value>....
where table1.id=table2.num
  and table2.code='abc'; 
```

哪一个是对的？还是两者都不正确？请建议一些方法...

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-17T09:55:05.970

两者都不正确。从您的片段中不清楚您要做什么，但是用另一个表的值更新一个表的语法更像是：

```
update table1
set (col1, col2) =
( select col1, col2
  from   table2
  where  table2.num = table1.id
  and    table2.code = 'abc'
)
where table1.id in (select num from table2); 
```

最后一个 WHERE 子句是为了防止用空值更新所有不匹配的 table1 行。

当 table1在查询中[“保留键”](http://asktom.oracle.com/pls/asktom/f?p=100:11:189379506317175::::P11_QUESTION_ID:548422757486)时有效的另一种方法是：

```
update
( select table1.id, table1.col1, table1.col2
  ,      table2.col1 as new_col1, table2.col as new_col2
  from   table1
         join table2 on table2.num = table1.id
)
set col1 = new_col1, col2 = new_col2; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T10:06:21.307

```
MERGE
INTO table1 t1
USING (
 SELECT *
 FROM table2
 WHERE table2.code = 'abc'
) t2
ON (t1.id = t2.num)
WHEN MATCHED THEN
  UPDATE
  SET col1 = t2.value1, col2 = t2.value2 
```

**请记住始终限定 SET 语句，即 t2.value1**。模棱两可时不会引发错误。换句话说，**SET col1 = value1**将是**t2.value1**，但如果**t2.value1丢失，它将是****t1.value1**。

 *** * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-17T15:19:50.493

根据您的最后一句话，您需要使用不在数据库表中的固定值更新表 table1。但仅适用于表 1 中与表 2 中特定行匹配的行。在这种情况下，您可以使用以下语句：

```
update table1 t1
set t1.col1='value',
t1.col2='value2',
t1.col3='value3'
where exists ( select ''
               from table2 s 
               where  t1.id=s.num 
               and s.code='abc'
); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T10:38:01.997

我使用了以下查询：

```
update (select col1 from table1 t inner join table2 s
on t.id=s.num where s.code='abc') t1
set t1.col1='value'; 
```

它工作得很好..

但是当我用它来更新多个列时，它产生了一个错误：

> *缺少右括号。*

你能帮忙吗...

```
update (select col1,col2,col3 from table1 t inner join table2 s
on t.id=s.num where s.code='abc') t1
set t1.col1='value',t1.col2='value2',t1.col3='value3'; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-18T06:03:47.793

我必须在 button1 的点击事件上添加值。我使用了以下代码：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    val = TextBox1.Text

    If RadioButton1.Checked = True Then
        rcvd = RadioButton1.Text
    ElseIf RadioButton2.Checked = True Then
        rcvd = RadioButton2.Text
    End If

    If RadioButton5.Checked = True Then
        type = RadioButton5.Text
    ElseIf RadioButton6.Checked = True Then
        type = RadioButton6.Text
    ElseIf RadioButton7.Checked = True Then
        type = RadioButton8.Text
    ElseIf RadioButton9.Checked = True Then
        type = RadioButton9.Text
    ElseIf RadioButton10.Checked = True Then
        type = RadioButton10.Text
    End If

    Try

        XXX = "update(select rcvd,amount,instype,chq,ucode,uname,remarks from fapark04 f inner join sumast04 s on f.party=s.account where s.abnmn=' " & val & " ' ) fa set fa.rcvd=' " & rcvd & " ', fa.amount= " & TextBox5.Text & " ,fa.instype='" & type & " ',fa.chq= " & TextBox9.Text & " ,fa.ucode=' " & TextBox12.Text & "',fa.uname='" & TextBox13.Text & "',fa.remarks='" & TextBox14.Text & "' "

        cmd1 = New OracleCommand(XXX, con)
        cmd1.ExecuteNonQuery()

    Catch ex As Exception
        MsgBox("A Run time error occured!!!", ex.ToString)

    End Try

End Sub 
```

这不会更新行，但是当在后端触发相同的查询时，它会更新行。

从前端更新时，它显示更新了 0 行。为什么会这样？？

帮助..

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-10-10T04:21:17.863

在您的查询中，您在 where 子句条件中使用了两个表。所以你必须加入或子查询或合并类型，这样你才能得到正确的输出

# c - Linux 内核 2.6 中的计时

> ID：556074
> 
> 赞同：9
> 
> 时间：2009-02-17T09:24:13.500
> 
> 标签：c, linux-kernel

我已经阅读了“Linux 设备驱动程序” [（可以在此处找到）](http://lwn.net/Kernel/LDD3/)中的第 7 章，时间可以用“jiffies”来衡量。stock jiffies 变量的问题在于它非常频繁地回绕（特别是如果您将 CONFIG_HZ 设置为 1000）。

在我的内核模块中，我保存了一个设置为未来某个时间的 jiffies 值，并在稍后将其与当前的“jiffies”值进行比较。我已经了解到有些函数会考虑 32 位 jiffy 换行，因此要比较我正在使用的两个值：

```
if (time_after(jiffies, some_future_jiffies_value))
{
   // we've already passed the saved value
} 
```

我的问题来了：所以现在我想将“some_future_jiffies_value”设置为“now + 10ms”。这可以通过执行以下操作轻松完成：

```
some_future_jiffies_value = jiffies + msecs_to_jiffies(10); 
```

它是否正确？如果当前 jiffies 接近 MAX_JIFFY_OFFSET 并且 msecs_to_jiffies(10) 的结果值使 some_future_jiffies_value 超过该偏移量，会发生什么情况？它会自动环绕还是我应该添加一些代码来检查这个？有没有让我不必处理这个问题的功能？

**更新：**

为了避免环绕的东西，我重写了我的睡眠循环：

```
 // Sleep for the appropriate time
   while (time_after(some_future_jiffies_value, jiffies))
   {
      set_current_state(TASK_INTERRUPTIBLE);
      schedule_timeout(1);
   } 
```

我认为这更便携对吧？

**更新 2：**

非常感谢 'ctuffli' 抽出时间回到这个问题，并为我的评论提供一些反馈。我的内核驱动程序现在工作正常，与您向我提供所有这些提示之前的情况相比，它的丑陋程度要低得多。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-17T19:22:47.103

你在这里实现的本质上是 msleep_interruptible() (linux/kernel/timer.c)

```
/**
 * msleep_interruptible - sleep waiting for signals
 * @msecs: Time in milliseconds to sleep for
 */
unsigned long msleep_interruptible(unsigned int msecs) 
```

此函数的优点是规范以毫秒为单位，并隐藏了内部 jiffies 包装的细节。请务必检查返回值，因为此调用返回剩余的 jiffies 数。零表示呼叫休眠了指定的毫秒数，而非零值表示呼叫提前中断了这么多时间。

关于包装，请参阅第[6.2.1.2](http://linux-security.cn/ebooks/ulk3-html/0596005652/understandlk-CHP-6-SECT-2.html)节了解 jiffies 和包装的说明。此外，这篇[文章](http://lkml.indiana.edu/hypermail/linux/kernel/0011.1/0396.html)试图在摘要中描述包装。

# simulation - 带网格的水模拟

> ID：556075
> 
> 赞同：7
> 
> 时间：2009-02-17T09:26:07.193
> 
> 标签：simulation, physics

一段时间以来，我一直在尝试使用从[“游戏的实时流体动力学”](http://www.dgp.toronto.edu/people/stam/reality/Research/pdf/GDC03.pdf)中获得的算法来模拟流动的水。问题是我似乎没有用这些算法摆脱像水一样的行为。

我自己我想我做错了什么，那些算法并不都适合水状流体。

这些算法我做错了什么？这些算法完全正确吗？

我在[bitbucket 存储库](http://bitbucket.org/cheery/fluid/overview/)中有相关的项目。（需要[gletools](http://hg.codeflow.org/gletools)和最新的[pyglet](http://pyglet.org/index.html)才能运行）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-01T03:43:44.973

基于体素的解决方案非常适合模拟液体，并且经常用于电影中。 [Ron Fedkiw 的网站](http://physbam.stanford.edu/~fedkiw/)提供了一些学术示例——所有示例都基于网格。该代码支持 Pixar 和 ILM 使用的许多模拟。

SIGGRAPH 和他的[网站上的 Robert Bridson 的](https://www.cs.ubc.ca/~rbridson/)[流体模拟课程笔记](http://www.cs.ubc.ca/~rbridson/fluidsimulation/)也是一个很好的来源。他有一本书[《计算机图形学的流体模拟》](https://www.crcpress.com/Fluid-Simulation-for-Computer-Graphics/Bridson/p/book/9781482232837)，详细介绍了液体模拟器的开发过程。

我可以对你的问题给出的最具体的答案是 Stam 的游戏实时流体专注于烟雾，即。在流体（水）和外部空气区域之间没有边界的地方。基本上烟雾和液体使用相同的底层机制，但对于液体，您还需要跟踪液体表面的位置，并在表面上应用适当的边界条件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T09:50:40.627

你想模拟什么类型的水？涟漪的水池，还是流动的液体？

我想我从来没有见过流水，除了渲染电影。涟漪水很容易做到，[这个网站](https://web.archive.org/web/20160505235423/http://freespace.virgin.net/hugo.elias/graphics/x_water.htm)通常会出现在这类问题中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-01T04:15:56.377

[Cem Yuksel 在 SIGGRAPH 2007 上发表了关于他的Wave Particles](http://www.cemyuksel.com/research/waveparticles/)的精彩演讲。它们以相当低的成本提供了非常逼真的效果。他甚至能够模拟与盒子和船等刚体的交互。另一个有趣的方面是船的运动不是脚本化的，它是通过螺旋桨与流体的相互作用来模拟的。

[![Cem Yuksel 的波粒子](https://i.stack.imgur.com/nWEfU.jpg)](https://i.stack.imgur.com/nWEfU.jpg)
[（来源：[cemyuksel.com](http://www.cemyuksel.com/research/waveparticles/title.jpg)）]

在会议上他说他计划发布源代码，但我还没有看到任何东西。他的网站包含他在会议上展示的全文和视频。

**编辑：**刚刚看到您关于想要模拟流动液体而不是涟漪池的评论。这不适合那个，但我会把它留在这里以防其他人发现它有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T10:11:02.873

是的，这种基于体素的解决方案只有在您的液体被限制在非常离散和静态的边界时才真正起作用。

为了模拟流动的液体，对粒子进行一些调查。最近在 GPU 上加速它们取得了很大进展，您可以获得一些惊人的结果。

看看[http://nzone.com/object/nzone_cascades_home.html](http://nzone.com/object/nzone_cascades_home.html)作为可以实现的一个很好的例子。

# php - 如何最好地动态显示股票文件？

> ID：556083
> 
> 赞同：0
> 
> 时间：2009-02-17T09:31:02.703
> 
> 标签：php, ftp, cron

我正在为客户开发一个网站，使用 PHP/MySQL。他们是出版商，网站需要显示您正在查看的书是否在他们的分销商处有库存。

库存文件是分销商 FTP 上的 CSV 文件。该文件在每天晚上的特定时间更新。到目前为止，我已经用 PHP 编写了一个脚本，将文件的内容复制到 Web 服务器。然后，我会从中获取库存信息并将其粘贴到 MySQL 图书数据库中。

在文件在分销商的 FTP 上更新后，有没有办法让文件传输 PHP 脚本每天只运行一次？这是最好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T09:48:59.120

自动化重复任务的常规方法是使用**cron**。您可以使用命令行编辑您的 cron 配置`crontab -e`。该文件遵循以下格式：

```
# .---------------- minute (0 - 59) 
# |  .------------- hour (0 - 23)
# |  |  .---------- day of month (1 - 31)
# |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ... 
# |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7)  OR sun,mon,tue,wed,thu,fri,sat 
# |  |  |  |  |
  *  *  *  *  *  command to be executed 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T09:53:24.087

如果您使用的是 Windows 服务器，则需要使用计划任务；如果您使用的是 unix，则需要使用 cronjob。以下是有关使用 cron 的一些信息：http: [//www.clockwatchers.com/cron_main.html](http://www.clockwatchers.com/cron_main.html) [http://www.clickmojo.com/code/cron-tutorial.html](http://www.clickmojo.com/code/cron-tutorial.html) 和 win 任务调度程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T11:57:23.727

处理这种情况的最佳方法是上面提到的 cronjob，一年前我也遇到过类似的困境，但唯一的区别是我不知道文件何时进入以及有多少。我创建了一个 php 脚本，它监视 ftp 上传文件夹，每 10 分钟运行一次，当每个文件进入时，它都会被处理（读取并存储在数据库中的数据），然后我会将它移动到另一个文件夹，称为处理如果没有成功读取文件，另一个调用失败。我希望这会有所帮助——我只是想我会分享。

# parsing - 具体和抽象语法树的标准格式

> ID：556085
> 
> 赞同：7
> 
> 时间：2009-02-17T09:31:37.537
> 
> 标签：parsing, grammar, lexer, abstract-syntax-tree

我有一个爱好项目的想法，该项目执行一些代码分析和操作。该项目将需要给定源文件的具体和抽象语法树。此外，两棵树之间的双向引用会很有帮助。我想避免转录语法来构建我自己的词法分析器和解析器的工作。

是否有描述具体或抽象语法树的标准格式？是否有任何广泛使用的工具链支持输出到这些格式？

我没有考虑特定的目标编程语言。任何流行的原型都可以，但我更喜欢我熟悉的原型：Python、C#、Javascript 或 C/C++。

我希望能够通过工具或库运行源文件并取回两棵树。在理想情况下，在代码上运行该工具是可行的，因为它正在由用户编辑并且可以容忍错误。同样，我只是想开发一个原型，所以这些要求非常宽松。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-21T09:37:16.767

研究界认为，将信息从一种程序分析工具转移到另一种时，图形交换是正确的做法。见[http://www.gupro.de/GXL](http://www.gupro.de/GXL)

最近，OMG 定义了一个交换抽象语法树的标准。见[http://www.omg.org/spec/ASTM/1.0/Beta1/](http://www.omg.org/spec/ASTM/1.0/Beta1/)

这个问题似乎一次又一次地得到解决。多年来提出的六种“工具巴士”提案都解决了这个问题，但没有人超越这个行业。问题在于 a) 使用任何类型的可嵌套表示法 [括号如 LISP，如 XML，...] 来表示 AST 都很容易，因此人们可以轻松推出自己的解决方案，并且 b) 一个工具可以与另一个交换 AST ，他们都必须在 AST 节点的含义上达成基本一致；但是大多数 AST 都是偶然地从每个工具使用的特定语法/解析技术中衍生出来的，而且工具之间几乎总是存在分歧。所以，我见过很少有工具可以有意义地交换 AST。

如果你在做一个爱好，我会坚持使用类似于 lisp 的树编码，其中每个节点都具有以下格式： ( ... ) 它易于生成且易于阅读。

我致力于使用[专业工具来操作程序](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)。如果我们已经打印出 AST，我们就执行上述操作。在实践中，大多数单个 AST 都过于复杂，因此我们几乎不会打印出整个 AST，最多只有一个节点和几个子节点。我们的工具不与任何人交换 AST（见上述原因：），但可以很好地在内存中构建它，出于分析原因或转换原因用它做一些奇怪的事情，然后要么删除它（无需将其发送到任何地方）或从树中重新生成原始语言文本。[后者意味着你需要反解析或“prettyprinting”技术]

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T09:49:58.447

在[我们的项目](http://rcos.iist.unu.edu)中，我们在 UML 中定义了 AST 元模型，并使用 ANTLR (Java) 来填充模型。我们还在解析后维护来自 ANTLR 的令牌信息，但我们尚未尝试使用对模型进行的修改来更新底层文本文件。

这有一个可怕的开销（在基础设施中，例如 Eclipse UML2/EMF），但我们的目标是无论如何都要使用高级工具进行基于模型/驱动的开发（MDD、MDA），所以我们决定在每个级别上都使用它.

我想我们的一个学生曾经玩过[OpenArchitectureWare](http://www.openarchitectureware.org/)并设法将基于 Eclipse 的生成编辑器自动返回到语法树（与上面的 UML 模型无关），但我不知道这方面的细节。

您可能还想查看[ANTLR 的](http://www.antlr.org)树语法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-16T20:31:30.223

具体标准是一种预期，而更通用的标准也可能是合适的。Ira Baxter 已经提到了[GXL](http://www.gupro.de/GXL)，并且可能还会添加[RDF](http://www.w3.org/TR/rdf11-concepts/)，只是它需要适当的本体并且更面向语义而不是语法。仍然可能是调查的一种选择。

对于特定标准，Ira Baxter 已经提到了[ASTM](http://www.omg.org/spec/ASTM/)，另一个虽然它更针对一种特定类型的编程语言（逻辑语言），但它是[语义/概念图的标准](http://www.jfsowa.com/cg/cgstand.htm)，称为[ISO-IEC 24707 2007](http://www.iso.org/iso/catalogue_detail.htm?csnumber=39175)。

它本身不是一个标准，而是一篇关于这个问题的论文：[Towards Portable Source Code Representations Using XML](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.88.6173&rep=rep1&type=pdf) 。

我不知道任何有效使用的标准（在这个领域，到处都是自制的烹饪），我也对这个话题感兴趣。

# asp.net - 托管平台上的 ASP.NET 性能测量

> ID：556086
> 
> 赞同：1
> 
> 时间：2009-02-17T09:31:39.847
> 
> 标签：asp.net, performance, hosted

我在托管平台上有一个大型 ASP.NET 网站。它与许多其他应用程序共享机器。我们无权访问机器本身（只有 FTP 帐户）。

我们的客户抱怨它开始表现得很糟糕，尤其是在高峰时段。我已经运行了一些远程测量（使用类似 JMeter 的工具），它告诉我，是的，它在高峰时段确实表现得相当糟糕。它没有告诉我为什么。客户拒绝在没有一些确凿事实的情况下转移到专用服务器。

在我看来，我需要的是关于机器本身的硬数据。设置本地性能测试环境会非常耗时，而且我无法估计服务器性能。

**我的问题**：当我对机器的访问受限并且肯定无法访问性能监视器时，是否有一种收集（大量）性能测量的好方法？任何代码都必须在 asp.net 应用程序本身中运行，而不会搞砸太多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T11:02:19.490

我们在共享服务器上托管的 asp.net 应用程序也遇到了类似的问题，该应用程序在高峰时段也开始表现不佳。

尽管我不知道您的问题的优雅解决方案，但这就是我们所做的：

1.  与您的托管服务提供商交谈，了解他们可以为您提供哪些额外信息 - 让客户满意符合他们的最大利益。我们的主机提供商能够给我们一些时间，他们的一位网络工程师为我们提供了一些不错的 CPU 和内存利用率统计数据。

2.  [通过将信息转储到日志文件（使用log4net](http://logging.apache.org/log4net/) ）和/或数据库来进行自己的性能测量- 例如，用户会话、搜索时间、页面点击、围绕关键功能的计时测量。从这些信息中，我们能够确定我们的系统在一定数量的自动化测试中的正常行为是什么。

3.  设置一个本地服务器（不一定与托管/生产服务器相同的统计数据）并加载您的应用程序并对其进行完整的负载/性能/容量测试（我们使用 Red Gate 的[ANTS Profiler](http://www.red-gate.com/products/ants_profiler/index.htm)）。您从中收集的统计数据将为您和您的客户提供一个很好的指示，即系统在已知环境的特定负载下应该如何表现。是的，这可能很耗时，但它会为您提供出色的性能测量工具，以便您可以在本地而不是在生产环境中捕获/修复瓶颈。

祝你好运。

# email - 如何将电子邮件地址大写？

> ID：556090
> 
> 赞同：8
> 
> 时间：2009-02-17T09:33:56.753
> 
> 标签：email, internationalization

我希望这应该是一个非常简单的问题。它分为两部分：

1.  电子邮件地址是否区分大小写？（即 foo@bar.com 与 Foo@bar.com 不同吗？）
2.  如果是这样，将电子邮件地址大写的正确语言环境是什么？（即在美国和土耳其地区，大写电子邮件 tim@foo.com 会有所不同）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-17T09:38:18.800

从规格来看，第一部分*可能*区分大小写，但通常不是。
由于它都是 ASCII，因此您应该安全地使用“幼稚”的大写函数。

查看[关于电子邮件地址的维基百科文章的 RFC 规范部分](http://en.wikipedia.org/wiki/E-mail_address#RFC_specification)

如果您想阅读更多内容， [RFC5322](https://www.rfc-editor.org/rfc/rfc5322)和[RFC5321](https://www.rfc-editor.org/rfc/rfc5321)也应该很有用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-17T09:37:38.787

电子邮件地址的本地部分（即在 之前`@`）**通常区分大小写**。从[电子邮件地址](http://en.wikipedia.org/wiki/E-mail_address)上的维基百科条目：

> local-part 区分大小写，因此“jsmith@example.com”和“JSmith@example.com”可能会发送给不同的人。但是，[RFC 5321](https://www.rfc-editor.org/rfc/rfc5321)不鼓励这种做法。但是，只有域的权威邮件服务器才能做出该决定。

有关详细规范，您可能希望查阅以下 RFC：

*   [RFC 5321](https://www.rfc-editor.org/rfc/rfc5321)：简单邮件传输协议
*   [RFC 5322](https://www.rfc-editor.org/rfc/rfc5322)：互联网消息格式
*   [RFC 3696](https://www.rfc-editor.org/rfc/rfc3696)：名称检查和转换的应用技术

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T09:38:44.353

域名不区分大小写。所以 foo@BAR.COM 和 foo@bar.com 是同一个邮箱

对于用户名，它取决于邮件服务器。在我公司使用的 Outlook 服务器中，它也不区分大小写

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T09:44:39.503

电子邮件地址不区分大小写。

> 电子邮件地址的本地部分可以使用以下任何 ASCII 字符：
> 
> 1.  大写和小写英文字母（az、AZ）
> 2.  数字 0 到 9
> 3.  人物 ！# $ % & ' * + - / = ? ^ _ ` { | } ~
> 4.  特点 。前提是它既不是第一个也不是最后一个字符，也不能连续出现两次或多次。
>     
>     
>     
>     来源：[维基百科](http://en.wikipedia.org/wiki/E-mail_address)

# com - ActiveX 控件中的 OnReadyStateChange 事件

> ID：556091
> 
> 赞同：1
> 
> 时间：2009-02-17T09:34:04.303
> 
> 标签：com, activex

我编写了一个允许托管 ActiveX 控件的 Firefox 插件（仅与 FF3 atm 兼容）。
在燃烧开始之前 - 这不是这个问题的主要主题，并且该插件的设计考虑了安全性，因此它不会破坏我最喜欢的浏览器。如果您有兴趣，它托管在[http://code.google.com/p/ff-activex-host/](http://code.google.com/p/ff-activex-host/)上。

现在，我注意到在 IE 中，所有 ActiveX 控件都有一个名为 OnReadyStateChange 的事件可用，但是，并非所有 ActiveX 控件的 TypeLib 中都列出了该事件。因此，我的插件无法为每个 ActiveX 控件注册此事件的处理程序。

使用 OleView 打开此类控件，我也找不到 OnReadyStateChange 事件 - 让我相信 IE 可能在此处“作弊”以使其正常工作。当 OleView 显示这样一个处理程序（如 Shockwave ActiveX 控件）时，我可以轻松地为它注册处理程序。

此类控件的一个示例是 Microsoft 的终端服务 ActiveX。但这不是仅限于 MS ActiveX 控件的问题。

我不是 COM 对象方面的专家，我是否以错误的方式或在错误的位置搜索事件？
现在我认为我做对了，因为 OleView 也找不到它，所以......

我可以像 IE 一样以某种方式“欺骗”并让这个活动仍然可用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T09:59:43.850

是的，IE 会作弊。您在 IE 中实际拥有的是在 COM 世界中我们称之为**聚合**对象的东西。IE 将创建一个用于表示 ActiveX 对象的 COM 类的实例，并将其与 ActiveX 类的实际实例聚合，从而创建一个复合对象。

这种复合材料似乎是具有新功能的单个对象。

因此，我认为您根本不需要担心 OnReadyStateChange。

# 3d - 从 .PLY 文件将模型加载到半边数据结构中

> ID：556095
> 
> 赞同：2
> 
> 时间：2009-02-17T09:35:49.103
> 
> 标签：3d, hash, mesh, memoization

我正在尝试构建一个 .PLY 解析器，以将存储为 .ply 文件的 3d 模型加载到半边数据结构网格中。

抱歉这个大问题，我很冗长，我想确保我列出了所有细节。正因为如此，我将立即重申我的最终目标，以便用户可以在阅读大量文本之前了解我想要什么。

1) 什么是从 .PLY 文件的顶点和面列表中记忆半边的好散列

或者

2) 有没有更好的方法从 .PLY 文件中的数据填充我的半边结构？

* * *

.PLY 文件列出了顶点，然后是网格的面。显而易见的解决方案是先填写顶点表，然后使用面列表生成边表。问题是每条边都有一个伙伴边，所以对于四边形网格，我加载的第一个四边形将需要 8 个半边。这最初不是问题，只需为面部创建四个半边并反转每个边以使其伙伴成为半边。这里的问题是，这会创建 4 个悬垂的半边，这些边与 4 个不同的面相关联。

所以有两种攻击方法：首先为人脸生成所有边，然后尝试配对伙伴边。我真的不喜欢这种方法，它似乎在编程上效率较低，因为它将涉及大量搜索和排序。

第二：按照第一个说明进行：从指定的第一个面开始并生成创建多边形所需的边，并在创建边时创建它们的双胞胎。但是，我们将记住边列表，因此所有边都将散列到一个表中。然后，当我们为其他面生成边时，如果已经生成了一条边（因为它是先前加载的面的伙伴边），我们将简单地将指针从表格中取出。

这就是我卡住的地方。我需要一个智能散列函数来记忆我的边缘列表。需要尽量减少碰撞以提高效率。我现在想到的方案是根据创建它们的两个顶点命名*边，IE 边 01 和 10 是双胞胎。最坏的情况会创建一个哈希表，其中所有顶点都可能被连接，最终大小为 2^n，其中 n = 顶点数，这是完全不可接受的。我的目标是使哈希值接近实际边数（= 每个面的边数之和），同时仍尽量减少碰撞。

*注意：因为半边执行“仅逆时针”绘制方案，所以不可能发生名称冲突。通过基于绘制它们的两个顶点命名边，我们确保所有名称对于单个半边都是唯一的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T10:05:58.393

> 我很啰嗦

您可能想对此有所了解。

拥有一条边的一个简单方法是通过它的两个顶点的索引。为了使其唯一，首先采用较小的索引，然后采用较大的索引。像这样的东西：

```
uint hash(const Vertex& v1, const Vertex& v2)
{
    int i1 = v1.index;
    int i2 = v2.index;
    if (i1 > i2)
        swap(i1, i2);
    return (i1 | (i2 << 16));
} 
```

在此哈希表指向的实际数据中，您可能希望跟踪您已经看到的哪一对以及您期望的哪一对（相反的一对）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T10:05:31.590

您是否在边缘存储索引或引用？如果你使用incides，不会像这样的微不足道的哈希函数

```
19 * index0 + 7 * index1 
```

“足够好”？如果你的散列应该是对称的，我会选择两个索引的简单异或，但由于半边确实是定向的，你最好使用非对称散列并专门寻找成对的边方向。

因为实际上比较两条边是一个相对便宜的操作（即比生成复杂的散列便宜），碰撞并不像你想象的那么可怕。

也就是说，根据我的经验。准备好在这里被真正的哈希专家烧毁。:-)

*作为旁注：您可能希望确保您的哈希表实现与删除相得益彰，因为从表中删除您找到的任何配对边可能会有所回报。*

# visual-c++ - 为什么这个库没有与 pragma 注释链接？

> ID：556105
> 
> 赞同：11
> 
> 时间：2009-02-17T09:38:22.373
> 
> 标签：visual-c++, linker, pragma

我正在使用 Visual C++ 2008 开发的项目中使用 Fmod。如果我包括

```
../fmodapi375win/api/lib/fmodvc.lib 
```

在项目->链接器->输入中，它工作正常，但出于某种原因，如果我使用

```
#pragma comment(lib,"../fmodapi375win/api/lib/fmodvc.lib") 
```

相反，它的工作方式与该行不存在一样：它构建时没有链接器错误，然后因一百万个访问冲突异常而导致堆栈溢出而崩溃。

发生了什么事，我该如何解决它，以便我可以在代码中定义库？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-03-20T19:18:08.167

我认为您不应该在编译指示注释中提供 .lib ，但是，我认为真正的问题是您通过路径调用注释。将路径添加到您的 lib 搜索路径，然后只需使用

```
#pragma comment(lib,"fmodvc") 
```

您应该能够在此评论中使用路径，但您确定您使用的 ..\ 路径在链接期间是正确的路径吗？还要确保您没有使用 /nodefaultlib 进行编译...

如果这仍然不起作用，请告诉我。我经常使用这种类型的编译指示，并取得了巨大的成功......

但是，现在我几乎被困在 C# 世界中，我什至没有太多时间用 C++ 编程了......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T09:51:42.310

库可以以另一种顺序链接，因此符号的解析方式不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-19T15:54:40.003

在链接的命令行上设置 /VERBOSE。在 GUI 中，您可以在项目的属性页上执行此操作——添加到链接器下的“命令行”节点。

然后它会告诉你它是如何解析每个函数的——搜索你知道应该在 fmodvc.lib 中的函数。

另一件事是在链接期间运行 PROCMON.EXE（预过滤，以便 PATH 包含 fmodvc.lib）——然后链接。它会告诉您找到文件的确切位置（以及是否曾经查找过）。在此处获取 PROCMON：[http ://technet.microsoft.com/en-us/sysinternals/bb896645.aspx](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)

最后，如果它正在链接，但没有加载您的库（或解析引用） - 您可能可以选择强制链接成功设置 - 您应该将其关闭。它将是命令行部分中的[/FORCE （如 /VERBOSE）。](http://msdn.microsoft.com/en-us/library/70abkas3.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-23T02:58:51.503

你绝对确定它在两个实例中是同一个 lib 文件吗？

如果您错过了机器上有两个文件版本的事实，这可能会变得非常奇怪。我强烈建议您在驱动器中搜索所有出现的该文件，以便进行完整性检查。

# java - 用于圆识别的快速 Java 库

> ID：556108
> 
> 赞同：2
> 
> 时间：2009-02-17T09:39:14.073
> 
> 标签：java, image-processing, image-recognition

我正在寻找一个用于在提供的位图中进行圆圈识别的 Java 库。我的 Java 知识太基础，无法实现，例如。霍夫变换有效（Java新手）。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T09:52:43.820

您可能想看看 ImageJ 中的实现，请参见[**此处**](http://rsbweb.nih.gov/ij/plugins/download/Hough_Circles.java)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-28T11:59:03.267

很抱歉在事实发生多年后发布此答案，但该问题在 2012 年再次被问到，然后因重复而关闭。正如我在对那个副本的回答中所说的那样，我认为这里给出的答案对于这样一个简单的问题来说太过分了，我更简单的解决方案也是如此：

*   找到所有*连接*的绿色斑点。这不是完全微不足道的，但也不是那么难。
*   对于每个 blob，找到具有最小 x 坐标的点和具有最大 x 坐标的点，并在 y 中执行相同的操作。然后你很容易得到 blob 的边界框的尺寸。如果 x 和 y 维度不同，则您没有圆。但是，您应该允许一些小的差异，因为用像素绘制圆会导致不完美的圆。
*   最后，如果你有一个圆，边界框的中心（大约）是圆的中心，半径是边界框宽度的一半。你可以画一个这样的圆圈，看看有多少绿色像素适合你的圆圈。同样，您必须允许一些缺陷。

# java - 找不到“org.springframework.security.annotation.Jsr250MethodDefinitionSource”

> ID：556110
> 
> 赞同：0
> 
> 时间：2009-02-17T09:40:19.967
> 
> 标签：java, spring-security, spring

当我在 Spring Security 下配置方法安全性时，出现上面显示的错误（请参阅下面的堆栈跟踪）。我在 Eclipse 3.4 下使用 Tomcat 6 运行时运行 Spring 2.5.6、Spring Security 2.0.4。我需要任何建议来了解如何使这项工作正常进行。

我的安全配置文件如下：

```
<beans:beans xmlns="http://www.springframework.org/schema/security"
xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
          http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-2.0.4.xsd">
<http auto-config='true'>
    <intercept-url pattern="/**" access="ROLE_USER" />
</http>
<authentication-provider>
    <user-service>
        <user name="admin" password="admin" authorities="ROLE_USER, ROLE_ADMIN" />
        <user name="user" password="user" authorities="ROLE_USER" />
    </user-service>
</authentication-provider>
<global-method-security jsr250-annotations="enabled"/> 
```

和异常堆栈跟踪：

```
 ERROR [2009-02-17 20:07:34,828] main org.springframework.web.context.ContextLoader - Context initialization failed
org.springframework.beans.factory.parsing.BeanDefinitionParsingException: Configuration problem: Cannot locate 'org.springframework.security.annotation.Jsr250MethodDefinitionSource'
Offending resource: ServletContext resource [/WEB-INF/securityApplicationContext.xml]
    at org.springframework.beans.factory.parsing.FailFastProblemReporter.error(FailFastProblemReporter.java:68)
    at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:85)
    at org.springframework.beans.factory.parsing.ReaderContext.error(ReaderContext.java:72)
    at org.springframework.security.config.GlobalMethodSecurityBeanDefinitionParser.validatePresent(GlobalMethodSecurityBeanDefinitionParser.java:47)
    at org.springframework.security.config.GlobalMethodSecurityBeanDefinitionParser.registerAnnotationBasedMethodDefinitionSources(GlobalMethodSecurityBeanDefinitionParser.java:109)
    at org.springframework.security.config.GlobalMethodSecurityBeanDefinitionParser.parse(GlobalMethodSecurityBeanDefinitionParser.java:56)
    at org.springframework.beans.factory.xml.NamespaceHandlerSupport.parse(NamespaceHandlerSupport.java:69)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1297)
    at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1287)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:135)
    at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:92)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:507)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:398)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:342)
    at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:310)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:143)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:178)
    at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:149)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:124)
    at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:92)
    at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:123)
    at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:422)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:352)
    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:255)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:199)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:45)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:3843)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4342)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
    at org.apache.catalina.core.StandardService.start(StandardService.java:516)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:578)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T09:55:19.057

我找到了答案。对于注释，您需要在类路径中添加以下 jar：

spring-security-core-tiger-2.0.4.jar

# sharepoint - 正确实施带有回发的 Web 部件？

> ID：556116
> 
> 赞同：6
> 
> 时间：2009-02-17T09:46:06.083
> 
> 标签：sharepoint, sharepoint-2007, postback, web-parts

我要做的是创建一个 webpart，它有一个文本框，您可以在其中设置 webpart 上的文字 (h2) 的值，以及一个“保存”按钮，该按钮回发然后相应地设置文字。这有一个很大的警告。当页面在回发后加载时，文字没有改变。但是，如果我记录文字中实际设置的内容，则它具有新值。此外，如果我再次重新加载页面（F5），它会正确显示。

起初我认为它一定是 ViewState，所以我为所有控件禁用了它。我确认它没有保存在 ViewState 中（已解码）。所以 ViewState 没有保存旧值。

我正在使用“CreateChildControls”将我的控件添加到 Web 部件。回发由一个简单的事件处理程序处理。

有任何想法吗？

作为记录，我使用的是 MOSS 2007。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T14:20:07.157

听起来像是 ASP.NET 事件计时问题。尝试在页面加载事件中调用 EnsureChildControls()。这可确保在处理回发事件之前调用您的 CreateChildControls() 方法并将您的控件添加到页面。如果您的控件首先在 PreRender 或 Render 阶段添加，那么它们获取回发数据将为时已晚。在下一页加载之前，您将看不到更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T19:42:12.287

也许这篇博文可以帮助您更好地了解 Web 部件的生命周期并解决您的问题。[http://platinumdogs.wordpress.com/2008/10/14/sharepoint-webpart-lifecycle-events/](http://platinumdogs.wordpress.com/2008/10/14/sharepoint-webpart-lifecycle-events/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-27T16:19:16.370

您始终可以使用 AJAX 更新面板，将您的文字控件放入其中并在更新面板上调用 UDP.Update。同样通过您的初始示例检查您`runat="server"`对文字控制的了解。您应该能够向 Page_Load 事件添加更改，这应该会出现在 Web 部件上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-27T21:01:19.180

这是一个建议。无论如何它对我有用。

```
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;

namespace Skaar.UI
{
    public class PostBackWebPart:WebPart
    {
        private Literal literal;
        private TextBox textBox;
        protected override void OnInit(System.EventArgs e)
        {
            base.OnInit(e);
            literal=new Literal();
            literal.Mode = LiteralMode.PassThrough;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
            Controls.Add(literal);
            textBox=new TextBox();
            textBox.AutoPostBack = true;
            Controls.Add(textBox);
            textBox.TextChanged += textBox_TextChanged;                                                                                                                                                                                                                                                                                                                                      
        }

        void textBox_TextChanged(object sender, System.EventArgs e)
        {
            literal.Text = string.Format("<h1>{0}</h1>", textBox.Text);
        }
    }
} 
```

# c# - C#中字符串前面的@是什么？

> ID：556133
> 
> 赞同：690
> 
> 时间：2009-02-17T09:54:17.500
> 
> 标签：c#, .net, string

这是 C#（或可能是 VB.net）的 .NET 问题，但我试图弄清楚以下声明之间的区别：

```
string hello = "hello"; 
```

对比

```
string hello_alias = @"hello"; 
```

在控制台上打印出来没有区别，长度属性是一样的。

* * *

## 回答 #1

> 赞同：869
> 
> 时间：2009-02-17T09:57:31.890

它将字符串标记为[逐字字符串文字](http://csharpindepth.com/Articles/General/Strings.aspx)- 字符串中通常被解释为[转义序列](http://en.wikipedia.org/wiki/Escape_sequence)的任何内容都将被忽略。

所以`"C:\\Users\\Rich"`是一样的`@"C:\Users\Rich"`

有一个例外：双引号需要转义序列。要转义双引号，您需要连续放置两个双引号。例如，`@""""`计算结果为`"`。

* * *

## 回答 #2

> 赞同：275
> 
> 时间：2009-02-17T09:57:30.940

这是一个*逐字字符串文字*。这意味着不应用转义。例如：

```
string verbatim = @"foo\bar";
string regular = "foo\\bar"; 
```

这里`verbatim`和`regular`内容一样。

它还允许多行内容——这对于 SQL 来说非常方便：

```
string select = @"
SELECT Foo
FROM Bar
WHERE Name='Baz'"; 
```

逐字字符串文字所需的转义是获得双引号 (")，您可以通过将其加倍来实现：

```
string verbatim = @"He said, ""Would you like some coffee?"" and left.";
string regular = "He said, \"Would you like some coffee?\" and left."; 
```

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2009-02-17T11:33:19.663

'@' 还有另一个含义：将它放在变量声明的前面允许您使用保留关键字作为变量名。

例如：

```
string @class = "something";
int @object = 1; 
```

我只发现了一两个合法的用途。当您想要执行以下操作时，主要在 ASP.NET MVC 中：

```
<%= Html.ActionLink("Text", "Action", "Controller", null, new { @class = "some_css_class" })%> 
```

这将产生一个 HTML 链接，如：

```
<a href="/Controller/Action" class="some_css_class">Text</a> 
```

否则，您将不得不使用'Class'，它不是保留关键字，但大写的'C' 不符合HTML 标准并且看起来不正确。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2009-02-17T11:12:14.800

由于您也明确要求使用 VB，所以让我补充一点，VB 中不存在这种逐字字符串语法，仅存在于 C# 中。相反，*所有*字符串在 VB 中都是逐字的（除了它们不能包含换行符，这与 C# 逐字字符串不同）：

```
Dim path = "C:\My\Path"
Dim message = "She said, ""Hello, beautiful world.""" 
```

VB 中不存在转义序列（除了引号字符的加倍，就像在 C# 逐字字符串中一样），这使得一些事情变得更加复杂。例如，要在 VB 中编写以下代码，您需要使用连接（或任何其他方式来构造字符串）

```
string x = "Foo\nbar"; 
```

在VB中，这将被写成如下：

```
Dim x = "Foo" & Environment.NewLine & "bar" 
```

（`&`是 VB 字符串连接运算符。`+`同样可以使用。）

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-02-17T09:58:04.340

[http://msdn.microsoft.com/en-us/library/aa691090.aspx](http://msdn.microsoft.com/en-us/library/aa691090.aspx)

C# 支持两种形式的字符串文字：常规字符串文字和逐字字符串文字。

常规字符串文字由用双引号括起来的零个或多个字符组成，如 "hello"，并且可能包括简单的转义序列（如制表符的 \t）以及十六进制和 Unicode 转义序列。

逐字字符串文字由一个 @ 字符后跟一个双引号字符、零个或多个字符以及一个结束双引号字符组成。一个简单的例子是@"hello"。在逐字字符串文字中，分隔符之间的字符被逐字解释，唯一的例外是引号转义序列。特别是，简单的转义序列以及十六进制和 Unicode 转义序列不会在逐字字符串文字中进行处理。逐字字符串文字可能跨越多行。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-02-17T09:58:40.890

这是一个逐字字符串，并更改了转义规则 - 现在唯一转义的字符是“，转义为”。这对于文件路径和正则表达式特别有用：

```
var path = @"c:\some\location";
var tsql = @"SELECT *
            FROM FOO
            WHERE Bar = 1";
var escaped = @"a "" b"; 
```

ETC

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-02-17T09:58:58.020

将 a`@`放在字符串前面使您可以使用反斜杠或双引号等特殊字符，而无需使用特殊代码或转义字符。

所以你可以写：

```
string path = @"C:\My path\"; 
```

代替：

```
string path = "C:\\My path\\"; 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2009-02-17T09:59:27.550

[从MSDN](http://msdn.microsoft.com/en-us/library/ms228362.aspx)复制：

> 在编译时，逐字字符串被转换为具有所有相同转义序列的普通字符串。因此，如果您在调试器监视窗口中查看逐字字符串，您将看到编译器添加的转义字符，而不是源代码中的逐字版本。例如，逐字字符串`@"C:\files.txt"`将在监视窗口中显示为`"C:\\files.txt"`.

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-12-07T23:40:07.267

解释很简单。为了表示字符串`"string\"`，编译器需要`"string\\"`因为`\`是一个转义字符。如果你`@"string\"`改用，你可以忘记`\\`.

# authentication - Azure 上的 Live ID Web 身份验证

> ID：556135
> 
> 赞同：0
> 
> 时间：2009-02-17T09:55:14.207
> 
> 标签：authentication, azure, cloud, live

我有一个 Silverlight 应用程序并想在 Azure 上使用它，并带有 Live ID Web autentication。

现在我正在寻找一个很好的教程或解决方案，以在云应用程序中使用 Live Id Web 身份验证，以便在 Azure 上使用它。

有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T16:57:25.907

据我了解您的问题，`WebRole`与常规 ASP.NET 相比，Windows Azure 上的 Live ID 身份验证（考虑到您的 get a ）没有什么不同。应用常规方法应该可以工作，请参阅[http://blog.webjak.net/2008/08/13/silverlight-windows-live-id/](http://blog.webjak.net/2008/08/13/silverlight-windows-live-id/)

# user-interface - 我应该如何描述“直到版本 X 之后才通知更新”选项？

> ID：556137
> 
> 赞同：1
> 
> 时间：2009-02-17T09:55:37.077
> 
> 标签：user-interface, auto-update

我正在研究一些在我的应用程序启动时运行的自动更新检查代码。如果有可用的新版本，用户可以下载它或忽略此更新。

如果用户忽略此更新，则此更新的版本号存储在 VersionForUpdateCheck 首选项中。如果设置了此首选项，那么未来的检查将使用它与服务器上可用的内容而不是当前运行的版本进行比较。

我不知道如何在首选项页面中简洁地标记此选项。我目前正在使用繁琐且不清楚的“版本 [EDITBOX] 之后的更新通知”。

你能想出更好的措辞吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T10:14:57.293

怎么样

[![软件更新](https://i.stack.imgur.com/HxX6x.png)](https://i.stack.imgur.com/HxX6x.png)
[（来源：[rsdn.ru](http://files.rsdn.ru/27808/SoftwareUpdates.png)）]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T10:14:59.587

我知道我没有回答您的问题，您可能有充分的理由忽略我不知道的我，但是.. 为什么还要让它对用户可见？

在该首选项页面上，我只想输入：

*   当前版本
*   最新可用版本
*   如果有新版本，则启用“立即更新”按钮。
*   也许还有一个“自动提示更新”复选框

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T10:35:27.540

将其完全排除在用户偏好之外。这是令人困惑和不必要的，如果您真的想给用户这种灵活性，只需在窗口中添加“不再通知我此更新”或“请在我下次开始时提醒我此更新”复选框用户选择忽略更新的地方。

```
+---------------------------------------------+
|  Hi! a new version (1.84) is available for  |
|  upgrade? Should I install it for you?      |
|                                             |
|     () YES     () NO   () Remind me later   |
|                                             |
+---------------------------------------------+ 
```

如果用户勾选“否”，请不要唠叨，直到下一次有更新的版本可用。或者：

```
+---------------------------------------------+
|  Hi! a new version (1.84) is available for  |
|  upgrade? Should I install it for you?      |
|                                             |
|     () YES     () NO                        |
|                                             |
|                                             |
|     () Don't ask about updates until the    |
|        the next version comes out           |
|     () Don't ever ask about updates again   |
+---------------------------------------------+ 
```

在用户首选项中唯一需要的是“检查更新”框，以防用户单击“不再询问更新”。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T10:41:51.020

像谷歌浏览器那样做。仅在“帮助”>“关于”中显示更新。每当有新的更新可用时，显示一个按钮，显示“您有可用的新版本”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T10:03:21.627

我会去

> 通知比版本更新的更新 [版本号]

在我看来，首选项对话框的最佳方法是提供一个非常简短的描述，以及对该选项作为工具提示的作用的冗长解释。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T11:17:16.677

*当程序的新版本发布时，用户不想*升级有什么正当理由吗？

我想要明确控制程序版本，甚至同时安装多个版本的唯一情况是使用我的 IDE 和编译器以及其他开发库。但软件开发人员不是普通用户。对于所有其他程序，最好只是静默升级程序，这样用户甚至都不会注意到它，就像 Google Chrome 一样。

也许在选项中可能有一个选项可以在新版本可用时进行提示，但默认应该是在不告诉用户的情况下静默升级（除非它是不完全向后兼容的重大升级或可能会破坏其他一些东西）。

# c# - 如何在 WinForms 应用程序中嵌入我自己的字体？

> ID：556147
> 
> 赞同：38
> 
> 时间：2009-02-17T09:59:41.153
> 
> 标签：c#, fonts, embedding

我想在我的 WinForms 应用程序中嵌入字体，这样我就不必担心它们会安装在机器上。我在 MSDN 网站上进行了一些搜索，发现了一些关于使用本机 Windows API 调用的提示，例如 Scott Hanselman 链接到的 Michael Caplan 的 (sp?) 教程。现在，我真的必须经历所有这些麻烦吗？我不能只使用我的应用程序的资源部分吗？

如果没有，我可能会走安装路线。在那种情况下，我可以以编程方式做到这一点吗？通过将字体文件复制到 Windows\Fonts 文件夹？

我知道许可问题。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2014-05-07T13:40:59.073

这就是在 VS 2013 中对我有用的方法，而不必使用不安全的块。

**嵌入资源**

1.  双击 Resources.resx，然后在设计器的工具栏中单击 Add Resource/Add Existing File 并选择您的 .ttf 文件
2.  在您的解决方案资源管理器中，右键单击您的 .ttf 文件（现在位于资源文件夹中）并转到属性。将构建操作设置为“嵌入式资源”

**将字体加载到内存中**

1.  添加`using System.Drawing.Text;`到您的 Form1.cs 文件

2.  在默认构造函数的上方和内部添加代码以在内存中创建字体（不使用其他示例所示的“不安全”）。下面是我的整个 Form1.cs：

    ```
    using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Threading.Tasks;
    using System.Windows.Forms;
    using System.Reflection;

    using System.Drawing.Text;

    namespace WindowsFormsApplication1
    {
        public partial class Form1 : Form
        {
            [System.Runtime.InteropServices.DllImport("gdi32.dll")]
            private static extern IntPtr AddFontMemResourceEx(IntPtr pbFont, uint cbFont,
                IntPtr pdv, [System.Runtime.InteropServices.In] ref uint pcFonts);

            private PrivateFontCollection fonts = new PrivateFontCollection();

            Font myFont;

            public Form1()
            {
                InitializeComponent();

                byte[] fontData = Properties.Resources.MyFontName;
                IntPtr fontPtr = System.Runtime.InteropServices.Marshal.AllocCoTaskMem(fontData.Length);
                System.Runtime.InteropServices.Marshal.Copy(fontData, 0, fontPtr, fontData.Length);
                uint dummy = 0;
                fonts.AddMemoryFont(fontPtr, Properties.Resources.MyFontName.Length);
                AddFontMemResourceEx(fontPtr, (uint)Properties.Resources.MyFontName.Length, IntPtr.Zero, ref dummy);
                System.Runtime.InteropServices.Marshal.FreeCoTaskMem(fontPtr);

                myFont = new Font(fonts.Families[0], 16.0F);
            }
        }
    } 
    ```

**使用你的字体**

1.  在主窗体中添加一个标签，并添加一个加载事件来设置 Form1.cs 中的字体：

    ```
    private void Form1_Load(object sender, EventArgs e)
    {
        label1.Font = myFont;
    } 
    ```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-05-26T09:29:39.820

```
// specify embedded resource name
string resource = "embedded_font.PAGAP___.TTF";

// receive resource stream
Stream fontStream = Assembly.GetExecutingAssembly().GetManifestResourceStream(resource);

// create an unsafe memory block for the font data
System.IntPtr data = Marshal.AllocCoTaskMem((int)fontStream.Length);

// create a buffer to read in to
byte[] fontdata = new byte[fontStream.Length];

// read the font data from the resource
fontStream.Read(fontdata, 0, (int)fontStream.Length);

// copy the bytes to the unsafe memory block
Marshal.Copy(fontdata, 0, data, (int)fontStream.Length);

// pass the font to the font collection
private_fonts.AddMemoryFont(data, (int)fontStream.Length);

// close the resource stream
fontStream.Close();

// free up the unsafe memory
Marshal.FreeCoTaskMem(data); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-07-21T12:12:12.247

[我将随机下载的字体](http://www.fontspace.com/khryskreations/kbreindeergames)拖放到我的资源中，这很有效。虽然使用文件。我想您也可以使用它来安装字体？

```
public Form1()
{
    string filename = @"C:\lady.gaga";
    File.WriteAllBytes(filename, Resources.KBREINDEERGAMES);
    PrivateFontCollection pfc = new PrivateFontCollection();
    pfc.AddFontFile(filename);

    Label label = new Label();
    label.AutoSize = true;
    label.Font = new Font(pfc.Families[0], 16);
    label.Text = "hello world";
    Controls.Add(label);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T15:02:19.693

> 我不能只使用我的应用程序的资源部分吗？

可以，但需要是本地资源而不是 .NET 资源（即使用 rc.exe，本地资源编译器）。

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2020-08-31T06:40:51.720

我将采用 knighter 嵌入字体的方式，但在更改字体时，我选择以下代码：

```
YourLabel.Font = new Font("Arial", 24,FontStyle.Bold); 
```

欲了解更多信息：[更改字体和字体大小的最简单方法](https://stackoverflow.com/questions/10173147/easiest-way-to-change-font-and-font-size)

# html - 悬停时加粗时内联元素移动

> ID：556153
> 
> 赞同：243
> 
> 时间：2009-02-17T10:00:59.417
> 
> 标签：html, css, hover, text-size

我使用 HTML 列表和 CSS 创建了一个水平菜单。除非您将鼠标悬停在链接上，否则一切正常。你看，我为链接创建了一个粗体悬停状态，现在菜单链接由于粗体大小的不同而发生了变化。

[我遇到了与此 SitePoint 帖子](http://www.sitepoint.com/forums/showthread.php?t=593181v)相同的问题。但是，该帖子没有适当的解决方案。我到处寻找解决方案，但找不到。当然，我不可能是唯一一个尝试这样做的人。

有没有人有任何想法？

PS：我不知道菜单项中文本的宽度，所以我不能只设置 li 项的宽度。

```
.nav { margin: 0; padding: 0; }
.nav li { 
    list-style: none; 
    display: inline; 
    border-left: #ffffff 1px solid; 
}
.nav li a:link, .nav li a:visited { 
    text-decoration: none; 
    color: #000; 
    margin-left: 8px; 
    margin-right: 5px; 
}
.nav li a:hover{ 
    text-decoration: none; 
    font-weight: bold; 
}
.nav li.first { border: none; }
```

```
<ul class="nav">
    <li class="first"><a href="#">item 0</a></li>
    <li><a href="#">item 1</a></li>
    <li><a href="#">item 2</a></li>
    <li><a href="#">item 3</a></li>
    <li><a href="#">item 4</a></li>
</ul>
```

* * *

## 回答 #1

> 赞同：466
> 
> 时间：2013-11-27T17:49:33.940

**通过使用与父悬停样式具有相同内容和样式的不可见伪元素来**预设宽度。**使用数据属性，如`title`，作为内容的来源。**

 **```
li {
    display: inline-block;
    font-size: 0;
}

li a {
    display:inline-block;
    text-align:center;
    font: normal 16px Arial;
    text-transform: uppercase;
}

a:hover {
    font-weight:bold;
}

/* SOLUTION */
/* The pseudo element has the same content and hover style, so it pre-sets the width of the element and visibility: hidden hides the pseudo element from actual view. */
a::before {
    display: block;
    content: attr(title);
    font-weight: bold;
    height: 0;
    overflow: hidden;
    visibility: hidden;
}
```

```
<ul>
    <li><a href="#" title="height">height</a></li>
    <li><a href="#" title="icon">icon</a></li>
    <li><a href="#" title="left">left</a></li>
    <li><a href="#" title="letter-spacing">letter-spacing</a></li>
    <li><a href="#" title="line-height">line-height</a></li>
</ul>
```

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2013-04-03T10:51:22.190

一个妥协的解决方案是用文本阴影伪造粗体，例如：

> 文字阴影：0 0 0.01px 黑色；

为了更好地比较，我创建了这些示例：

```
a, li {
  color: black;
  text-decoration: none;
  font: 18px sans-serif;
  letter-spacing: 0.03em;
}
li {
  display: inline-block;
  margin-right: 20px;
  color: gray;
  font-size: 0.7em;
}
.bold-x1 a.hover:hover,
.bold-x1 a:not(.hover) {
  text-shadow: 0 0 .01px black;
}
.bold-x2 a.hover:hover,
.bold-x2 a:not(.hover){
  text-shadow: 0 0 .01px black, 0 0 .01px black;
}
.bold-x3 a.hover:hover,
.bold-x3 a:not(.hover){
  text-shadow: 0 0 .01px black, 0 0 .01px black, 0 0 .01px black;
}
.bold-native a.hover:hover,
.bold-native a:not(.hover){
  font-weight: bold;
}

.bold-native li:nth-child(4),
.bold-native li:nth-child(5){
 margin-left: -6px;
 letter-spacing: 0.01em;
}
```

```
<ul class="bold-x1">
  <li><a class="hover" href="#">Home</a></li>
  <li><a class="hover" href="#">Products</a></li>
  <li><a href="#">Contact</a></li>
  <li><a href="#">About</a></li>
  <li>Bold (text-shadow x1)</li>
</ul>
<ul class="bold-x2">
  <li><a class="hover" href="#">Home</a></li>
  <li><a class="hover" href="#">Products</a></li>
  <li><a href="#">Contact</a></li>
  <li><a href="#">About</a></li>
  <li>Extra Bold (text-shadow x2)</li>
</ul>
<ul class="bold-native">
  <li><a class="hover" href="#">Home</a></li>
  <li><a class="hover" href="#">Products</a></li>
  <li><a href="#">Contact</a></li>
  <li><a href="#">About</a></li>
  <li>Bold (native)</li>
</ul>
<ul class="bold-x3">
  <li><a class="hover" href="#">Home</a></li>
  <li><a class="hover" href="#">Products</a></li>
  <li><a href="#">Contact</a></li>
  <li><a href="#">About</a></li>
  <li>Black (text-shadow x3)</li>
</ul>
```

传递给`text-shadow`非常低的值`blur-radius`将使模糊效果不那么明显。

一般来说，你重复`text-shadow`的次数越多，你的文字就会越粗，但同时会失去字母的原始形状。

我应该警告您，将`blur-radius`分数设置为不会在所有浏览器中呈现相同的内容！例如，Safari 需要更大的值来渲染它，就像 Chrome 一样。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2014-10-20T22:37:49.417

另一个想法是使用`letter-spacing`

```
li, a { display: inline-block; }
a {
  font-size: 14px;
  padding-left: 10px;
  padding-right: 10px;
  letter-spacing: 0.235px
}

a:hover, a:focus {
  font-weight: bold;
  letter-spacing: 0
}
```

```
<ul>
  <li><a href="#">item 1</a></li>
  <li><a href="#">item 2</a></li>
  <li><a href="#">item 3</a></li>
</ul>
```

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2009-02-17T10:09:28.663

如果你不能设置宽度，那么这意味着宽度会随着文本变粗而改变。没有办法避免这种情况，除非通过修改每个状态的填充/边距等妥协。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2010-10-29T09:08:38.560

*jquery中的一行*：**

 *```
$('ul.nav li a').each(function(){
    $(this).parent().width($(this).width() + 4);
}); 
```

*编辑：* 虽然这可以带来解决方案，但应该提到它不能与原始帖子中的代码一起使用。"display:inline" 必须替换为浮动参数才能使宽度设置生效并且水平菜单按预期工作。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2016-06-02T10:53:16.927

## CSS3 解决方案 - 实验性

（假大胆）

想分享一种不同的解决方案，这里没有人建议。有一个名为的属性`text-stroke`将对此很方便。

```
p span:hover {
  -webkit-text-stroke: 1px black;
}
```

```
<p>Some stuff, <span>hover this,</span> it's cool</p>
```

在这里，我定位`span`标签内的文本，我们用一个像素来描边它，该像素`black`将模拟`bold`该特定文本的样式。

请注意，此属性并未得到广泛支持，截至目前（在编写此答案时），似乎只有 Chrome 和 Firefox 支持此属性。有关浏览器支持的更多信息`text-stroke`，可以参考[CanIUse](http://caniuse.com/#feat=text-stroke)。

* * *

只是为了分享一些额外的东西，如果你不想为你的中风`-webkit-text-stroke-width: 1px;`设置一个，你可以使用。`color`

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-12-04T11:17:44.200

你可以使用类似的东西

```
<ul>
   <li><a href="#">Some text<span><br />Some text</span></a></li>
</ul> 
```

然后在你的css中将span内容设置为粗体并用可见性隐藏它：隐藏，这样它就可以保持它的尺寸。然后您可以调整以下元素的边距以使其适合。

我不确定这种方法是否对 SEO 友好。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-09-04T13:20:44.833

我刚刚用“影子”解决方案解决了这个问题。这似乎是最简单有效的。

```
nav.mainMenu ul li > a:hover, nav.mainMenu ul li.active > a {
    text-shadow:0 0 1px white;
} 
```

不需要重复阴影三次（结果对我来说是一样的）。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-09-29T13:23:24.783

我遇到了和你类似的问题。当您将鼠标悬停在它们上时，我希望我的链接变得粗体，但不仅在菜单中，而且在文本中。正如您猜测的那样，弄清楚所有不同的宽度将是一件真正的苦差事。解决方案非常简单：

创建一个框，其中包含粗体的链接文本，但颜色与您的背景相似，但在其上方是您的真实链接。这是我页面中的一个示例：

CSS：

```
.hypo { font-weight: bold; color: #FFFFE0; position: static; z-index: 0; }
.hyper { position: absolute; z-index: 1; } 
```

当然，您需要将#FFFFE0 替换为页面的背景颜色。z 索引似乎不是必需的，但我还是把它们放在了（因为“hypo”元素将出现在 HTML 代码中的“hyper”元素之后）。现在，要在您的页面上放置一个链接，请包括以下内容：

HTML：

```
You can find foo <a href="http://bar.com" class="hyper">here</a><span class="hypo">here</span> 
```

第二个“此处”将不可见并隐藏在您的链接下方。由于这是一个带有粗体链接文本的静态框，因此您的其余文本将不再移动，因为在您将鼠标悬停在链接上之前它已经移动了。

希望我能提供帮助:)。

这么久

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-02-26T15:02:18.573

我使用 text-shadow 解决方案，就像这里提到的其他人一样：

```
text-shadow: 0 0 0.01px; 
```

不同的是我没有指定阴影颜色，所以这个解决方案对所有字体颜色都是通用的。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2021-05-12T18:02:42.400

如果您不想预设列表项的宽度，一个非常好的选择是尝试在列表项中使用**等宽**字体。

与等宽字体不同，它们仍然是成比例的字体——但它们*在不同的字体粗细中占据相同的大小*。**不需要 CSS、JS 或花哨的技巧来保持大小不变​​。**它直接融入字体。

我认为这是解决这个常见问题的一个非常优雅的解决方案。

[这是这篇优秀文章](https://uxdesign.cc/uniwidth-typefaces-for-interface-design-b6e8078dc0f7)中的一个示例，将比例字体 IBM Plex Sans 与 uniwidth Recursive 进行了比较。

![与单宽字体成比例比较](https://miro.medium.com/max/2400/1*eUu31P1t6Ez6xwD56BQJaw.gif)

注意在比例字体 (IBM Plex Sans) 中，列表项如何随着粗体字体大小的变化而变化。使用 uniwidth 字体 Recursive，项目在悬停时变为粗体，但**不改变 size**。

您可以尝试的免费单角字体有：

*   [递归的](https://fonts.google.com/specimen/Recursive)
*   [PT 根用户界面](https://www.paratype.com/fonts/pt/pt-root-ui)
*   [戈洛斯用户界面](https://www.paratype.com/fonts/pt/golos-ui)
*   [看台](https://fonts.google.com/specimen/Grandstander)

也有许多通过上述文章链接到的非免费选项。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2012-04-07T10:51:24.020

您可以使用“margin”属性：

```
li a {
  margin: 0px 5px 0px 5px;
}

li a:hover {
  margin: 0;
  font-weight: bold;
} 
```

只需确保左右边距足够大，以便额外的空间可以包含粗体文本。对于长词，您可以选择不同的边距。这只是另一种解决方法，但为我完成了这项工作。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-11-30T09:30:30.490

我喜欢使用 text-shadow 代替。特别是因为您可以使用过渡来为文本阴影设置动画。

您真正需要的是：

```
a {
  transition: text-shadow 1s;
}
a:hover {
  text-shadow: 1px 0 black;
} 
```

如需完整导航，请查看此 jsfiddle： [https ://jsfiddle.net/831r3yrb/](https://jsfiddle.net/831r3yrb/)

浏览器支持和更多关于文本阴影的信息：http: [//www.w3schools.com/cssref/css3_pr_text-shadow.asp](http://www.w3schools.com/cssref/css3_pr_text-shadow.asp)

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-05-15T10:59:49.430

另一种方法是通过文本阴影“模拟”粗体文本。这有一个好处（/malus，取决于你的情况）也可以在字体图标上工作。

```
 nav li a:hover {
      text-decoration: none;
      text-shadow: 0 0 1px; /* "bold" */
   } 
```

Kinda hacky，虽然它可以让你免于复制文本（如果它很多，这很有用，就像我的情况一样）。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-02-17T11:26:33.143

我建议不要在悬停时切换字体（°）。在这种情况下，它只是菜单项移动了一点，但我已经看到了整个段落被重新格式化的情况，因为加宽会导致额外的自动换行。当您唯一要做的就是移动光标时，您不希望看到这种情况发生；如果您不执行任何操作，则页面布局不应更改。

在正常和斜体之间切换时也会发生这种转变。如果文本下方有空间，我会尝试更改颜色或切换下划线。（下划线应远离底部边框）

如果我为我的表单设计课使用切换字体，我会被嘘的:-)

(°) 字体一词经常被误用。“Verdana”是一种*字体*，“Verdana normal”和“Verdana bold”是同一种*字体*的不同字体。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-05-16T22:32:54.313

```
ul {
  list-style-marker: none;
  padding: 0;
}

li {
  display: inline-block;
}

li + li {
  margin-left: 1em;
}

a {
  display: block;
  position: relative;
  text-align: center;
}

a:before, a:after {
  content: attr(aria-label);
  text-decoration: inherit;
}

a:before {
  font-weight: bold;
  visibility: hidden;
}

a:after {
  position: absolute;
  left: 0;
  top: 0;
  right: 0;
  bottom: 0;
}

a:hover:before {
  visibility: visible;
}

a:hover:after {
  display: none;
}
```

```
<ul>
  <li>
    <a href="" aria-label="Long-long-long"></a>
  </li><li>
    <a href="" aria-label="or"></a>
  </li><li>
    <a href="" aria-label="Short"></a>
  </li><li>
    <a href="" aria-label="Links"></a>
  </li><li>
    <a href="" aria-label="Here"></a>
  </li>
</ul>
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-07-28T09:03:30.013

`letter-spacing`与 一起使用`text-shadow`：

```
a {
  letter-spacing: .1em;
}

a:hover {
  text-shadow: 0 0 .9px #color, 0 0 .9px #color, 0 0 .9px #color;
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2021-09-21T10:47:28.807

我用几行javascript解决了这个问题。

```
$('a.menu_item').each(function() {
    let width = $(this).width();
    $(this).css('width',width + 'px');
}); 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2021-11-10T16:37:53.860

在这里看到很多很棒但非常复杂的答案。真的不需要重置宽度，添加隐藏元素，为不同的布局声明重新设计元素等。最简单的解决方案是通过将悬停声明中的字体大小调整为稍微增加粗体文本来解决大小的增加较小的尺寸。例如 font-size: .985em 来自正常的 1em 声明，它允许文本在悬停时变为粗体，但也保持原始大小外观。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2015-03-23T20:20:50.027

这是我喜欢的解决方案。它需要一点 JS，但你不需要你的 title 属性完全相同，你的 CSS 可以保持非常简单。

```
$('ul a').each(function() {
  $(this).css({
    'padding-left': 0,
    'padding-right': 0,
    'width': $(this).outerWidth()
  });
});
```

```
li, a { display: inline-block; }
a {
  padding-left: 10px;
  padding-right: 10px;
  text-align: center; /* optional, smoother */
}
a:hover { font-weight: bold; }
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<ul>
  <li><a href="#">item 1</a></li>
  <li><a href="#">item 2</a></li>
  <li><a href="#">item 3</a></li>
</ul>
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-12-04T01:02:09.287

那这个呢？一个 javascript - CSS3 免费解决方案。

[http://jsfiddle.net/u1aks77x/1/](http://jsfiddle.net/u1aks77x/1/)

```
ul{}
li{float:left; list-style-type:none; }
a{position:relative; padding-right: 10px; text-decoration:none;}
a > .l1{}
a:hover > .l1{visibility:hidden;}
a:hover > .l2{display:inline;}
a > .l2{position: absolute; left:0; font-weight:bold; display:none;}

<ul>
  <li><a href="/" title="Home"><span class="l1">Home</span><span class="l2">Home</span></a></li>
  <li><a href="/" title="Contact"><span class="l1">Contact</span><span class="l2">Contact</span></a></li>
  <li><a href="/" title="Sitemap"><span class="l1">Sitemap</span><span class="l2">Sitemap</span></a></li>
</ul> 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-01-10T15:45:40.210

不是很优雅的解决方案，但“有效”：

```
a
{
    color: #fff;
}

a:hover
{
    text-shadow: -1px 0 #fff, 0 1px #fff, 1px 0 #fff, 0 -1px #fff;
} 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2017-04-27T15:57:58.417

我结合了上面的一些技术来提供一些在关闭 js 时不会完全糟糕的东西，并且在使用一点 jQuery 时会更好。现在浏览器对亚像素字母间距的支持正在改进，使用它真的很棒。

```
jQuery(document).ready(function($) {
  $('.nav a').each(function(){
      $(this).clone().addClass('hoverclone').fadeTo(0,0).insertAfter($(this));
    var regular = $(this);
    var hoverclone = $(this).next('.hoverclone');
    regular.parent().not('.current_page_item').hover(function(){
      regular.filter(':not(:animated)').fadeTo(200,0);
      hoverclone.fadeTo(150,1);
    }, function(){
      regular.fadeTo(150,1);
      hoverclone.filter(':not(:animated)').fadeTo(250,0);
    });
  });
});
```

```
ul {
  font:normal 20px Arial;
  text-align: center;
}
li, a {
  display:inline-block;
  text-align:center;
}
a {
  padding:4px 8px;
  text-decoration:none;
  color: #555;
}

.nav a {
  letter-spacing: 0.53px; /* adjust this value per font */
}
.nav .current_page_item a,
.nav a:hover {
  font-weight: bold;
  letter-spacing: 0px;
}
.nav li {
  position: relative;
}
.nav a.hoverclone {
  position: absolute;
  top:0;
  left: 0;
  white-space: nowrap;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<ul class="nav">
  <li><a href="#">Item 1</a></li>
  <li><a href="#">Item 2</a></li>
  <li class="current_page_item"><a  href="#">Item 3</a></li>
  <li><a href="#">Item 4</a></li>
  <li><a href="#">Item 5</a></li>
</ul>
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2019-05-15T13:04:44.407

最好使用**a::before**而不是**a::after**像这样：

```
.breadcrumb {
  margin: 0;
  padding: 0;
  list-style: none;
  overflow: hidden;
}

.breadcrumb li, 
.breadcrumb li a {
  display: inline-block;
}

.breadcrumb li:not(:last-child)::after {
  content: '>'; /* or anything else */
  display: inline-block;
}

.breadcrumb a:hover {
  font-weight: bold;
}

.breadcrumb a::before {
  display: block;
  content: attr(data-label);
  font-weight: bold;
  height: 0;
  overflow: hidden;
  visibility: hidden;
}
```

```
<ul class="breadcrumb">
  <li><a data-label="one" href="https://www.google.fr/" target="_blank">one</a></li>
  <li><a data-label="two" href="https://duckduckgo.com/" target="_blank">two</a></li>
  <li><a data-label="three" href="#">three</a></li>
</ul>
```

更多详情：[https ://jsfiddle.net/r25foavy/](https://jsfiddle.net/r25foavy/)

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2019-09-24T10:44:10.923

当悬停大胆成功时，我修复了菜单。它支持响应式，这是我的代码：

```
(function ($) {
'use strict';

$(document).ready(function () {
    customWidthMenu();
});
$(window).resize(function () {
    customWidthMenu();
});
function customWidthMenu() {
    $('ul.nav li a').each(function() {
        $(this).removeAttr('style');
        var this = $(this);
        var width = this.innerWidth();
        this.css({'width': width + 12});
    });
}})(jQuery); 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2009-12-03T19:25:52.240

如果您不反对使用 Javascript，则可以在页面显示后设置适当的宽度。这是我的做法（使用原型）：

```
$$('ul.nav li').each(this.setProperWidth);

setProperWidth: function(li)
{
  // Prototype's getWidth() includes padding, so we 
  // have to subtract that when we set the width.
  var paddingLeft = li.getStyle('padding-left'),
      paddingRight = li.getStyle('padding-right');

  // Cut out the 'px' at the end of each padding
  paddingLeft = paddingLeft.substring(0,paddingLeft.length-2);
  paddingRight = paddingRight.substring(0,paddingRight.length-2);

  // Make the li bold, set the width, then unbold it
  li.setStyle({ fontWeight: 'bold' });
  li.setStyle({ width: (li.getWidth() - paddingLeft - paddingRight) + 'px'});
  li.setStyle({ fontWeight: 'normal', textAlign: 'center' });
} 
```

* * *

## 回答 #27

> 赞同：-1
> 
> 时间：2018-10-07T02:23:09.143

试试这个：

```
.nav {
  font-family: monospace;
} 
```

* * *

## 回答 #28

> 赞同：-2
> 
> 时间：2009-06-10T17:38:48.717

当有一个简单的问题解决方案时，有人告诉你不要那样做，我真的无法忍受。我不确定 li 元素，但我刚刚解决了同样的问题。我有一个由 div 标签组成的菜单。

只需将 div 标签设置为“display: inline-block”。内联，因此它们彼此相邻并阻挡您可以设置宽度。只需将宽度设置为足以容纳粗体文本并对齐文本中心即可。

（注意：它似乎正在剥离我的 html [下面]，但每个菜单项都有一个 div 标记，并带有相应的 ID 和类名 SearchBar_Cateogory。即：`<div id="ROS_SearchSermons" class="SearchBar_Category">`

HTML（我在每个菜单项周围都有锚标记，但我无法将它们作为新用户提交）

```
<div id="ROS_SearchSermons" class="SearchBar_Cateogry bold">Sermons</div>|
<div id="ROS_SearchIllustrations" class="SearchBar_Cateogry">Illustrations</div>|
<div id="ROS_SearchVideos" class="SearchBar_Cateogry">Videos</div>|
<div id="ROS_SearchPowerPoints" class="SearchBar_Cateogry">PowerPoints</div>|
<div id="ROS_SearchScripture" class="SearchBar_Cateogry">Scripture</div>| 
```

CSS：

```
#ROS_SearchSermons { width: 75px; }
#ROS_SearchIllustrations { width: 90px; }
#ROS_SearchVideos { width: 55px; }
#ROS_SearchPowerPoints { width: 90px; }
#ROS_SearchScripture { width: 70px; }

.SearchBar_Cateogry
{
    display: inline-block;
    text-align:center;
} 
```

* * *

## 回答 #29

> 赞同：-3
> 
> 时间：2014-08-07T17:39:15.973

如果粗体文本比常规文本更宽，您也可以尝试负边距。（并非总是如此）所以想法是使用类来设置 :hover 状态的样式。

jQuery：

```
 $(".nav-main .navbar-collapse > ul > li > a").hover(function() {
    var originalWidth = $(this).outerWidth();

    $(this).parent().addClass("hover");
    $(this).css({
       "margin-left": -(($(this).outerWidth() - originalWidth) / 2),
       "margin-right": -(($(this).outerWidth() - originalWidth) / 2)
    });
 },
 function() {
    $(this).removeAttr("style");
    $(this).parent().removeClass("hover");
 }); 
```

CSS：

```
ul > li > a {
    font-style: normal;
}

ul > li > a.hover {
    font-style: bold;
} 
```

我希望我能帮上忙！

# ssis - 我应该在 SSIS 脚本组件或应用程序的 Visual Studio 中保留调试条件吗

> ID：556154
> 
> 赞同：0
> 
> 时间：2009-02-17T10:01:00.977
> 
> 标签：ssis, debugging

当我在 t-sql 和脚本组件中编写较大的脚本时，我通常会放入一个名为 debug 的布尔值，我可以将其传递或设置为 true，它将弹出或删除调试信息。对于 Tsql，我知道它的开销可以忽略不计，但这在 SSIS 脚本组件或应用程序环境的 VS 中是否相同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T15:19:18.030

我会把它留在里面 - 我发现 SSIS 在脚本组件方面非常有效。

# algorithm - 对最近 X 秒内收到的值的平均值进行采样

> ID：556155
> 
> 赞同：3
> 
> 时间：2009-02-17T10:02:48.853
> 
> 标签：algorithm, statistics

我有一个调度成功和失败事件的类，我需要维护该类最后 X 秒内失败的平均数/事件总数的统计信息。

我正在考虑使用循环链表并为每个事件附加一个成功或失败节点。然后计算列表中故障节点的数量与总节点的数量，但这有两个主要缺点：

1.  我需要不断扩大/缩小列表大小以考虑“最后 X 秒”的要求（每秒的事件数可以改变）
2.  我需要不断循环列表并计算所有事件（可能很昂贵，因为我每秒可能会有 100 个此类事件）

有谁知道从最后 X 秒内收到的样本列表中计算平均值的另一种方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-17T10:15:01.037

您应该使用采样频率（a-la MRTG）。假设您只需要一秒的精度并保持过去一分钟的平均值，您将有一个固定的表，其中包含 60 个条目，指的是过去 60 秒（包括现在的）。并且还保持当前的全局条目。

每个条目由一个平均值和一些事件组成。两个值的每个条目都从 0 开始。

当您收到一个新事件时，您可以像这样更改当前条目和全局条目：

```
平均值 = ((数字 * 平均值) + 1) / (数字 + 1)
数字 = 数字 + 1

```

在每个采样间隔，您使用最旧的条目更改全局条目：

```
global.average = ((global.number * global.average) - (oldest.number * old.average)) / (global.number - old.number)
global.number = global.number - old.number

```

然后您将最旧的条目重置为 0 并开始将其用作当前条目。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T10:10:07.307

您可以使用[queue](http://en.wikipedia.org/wiki/Queue_(data_structure))，这将允许您将新事件添加到队列的末尾，并从队列的开头删除过期的事件，假设事件是按时间顺序添加的。例如，在 Java 中，您可以使用 a[`LinkedList`](http://java.sun.com/javase/6/docs/api/java/util/LinkedList.html)或 an [`ArrayDeque`](http://java.sun.com/javase/6/docs/api/java/util/ArrayDeque.html)，它们都实现了[`Queue`](http://java.sun.com/javase/6/docs/api/java/util/Queue.html)接口。

如果事件未按时间顺序添加，则可以使用[优先级队列。](http://en.wikipedia.org/wiki/Priority_queue)元素将按其时间戳排序，最高优先级元素（即下一个要删除的元素）将是具有最小时间戳的元素。在 Java 中，此数据结构由[`PriorityQueue`](http://java.sun.com/javase/6/docs/api/java/util/PriorityQueue.html).

我们可以只保留两个计数器，而不是定期计算事件，一个用于事件总数，另一个用于成功事件的数量。每当我们从队列中添加或删除事件时，这些计数器都会更新。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T10:07:09.543

将您的事件保存在[Queue](http://en.wikipedia.org/wiki/Queue_%28data_structure%29)中。只需追加到末尾并从前面删除所有太旧的事件。这至少会消除问题 1。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T11:29:03.810

通常对于这些类型的采样器，您通常会指定一件事，那就是**采样器分辨率**。

在您的情况下，假设您的描述，采样器分辨率可以是 1 秒或 1 滴答声。

如果您想要的采样器分辨率是 1 秒，那么这里有一个可能运行良好的算法命题。

*   创建一个链表。列表节点保存 [timestamp, Success count, Failure count, previousNode]
*   存储对列表最后一个节点的`lastNode`引用和对第一个节点的引用`firstNode`（`lastNode`将是列表的尾部，并且`firstNode`是最新添加的节点，头部）
*   包含两个全局变量 gSuccess、gFail，最后 X 秒时间范围内成功和失败的总和。

收到新事件时：

*   将事件 [timestamp] 与 firstNode 进行比较`timestamp`

    IF (eventTimestamp.TotalSeconds > firstNode.TotalSeconds)

    *   在列表的开头添加一个新节点 a（插入到 firsNode 之前），成功和失败计数为 0。
    *   firstNode.Previous = newNode
    *   第一节点 = 新节点；

    万一

    *   将 firstNode.Success 或 firstNode.Failure 计数增加 1
    *   *将 gSuccess 或 gFail 增加 1

    （添加每个事件后）REMOVE_EXPIRED_NODES

*   WHILE ( lastNode != nil AND currentTime.TotalSeconds - lastNode.TotalSeconds > X)

    *   gSuccess -= lastNode.Succes（按要删除的节点减少 gSuccess 成功计数）
    *   gFail -= lastNode.Fail（按要删除的节点减少 gFail 失败计数）
    *   删除最后一个节点

    结束时

获取 gFail 和 gSuccess 应该始终在 REMOVE_EXPIRED_NODES 之前。

这种方法的优点：

*   Fail 和 Success 的全局计数器不会从所有事件中重新计算，而是添加逐渐递增的事件，并在删除列表中早于 X 秒的节点时递减。

*   它使用 1 秒的采样器分辨率，而不是存储所有事件的列表（可能每秒数百次，确保每秒执行总共 2 个列表操作（添加 + 删除操作））

*   无论事件数量如何，平均每秒列表操作计数为 2（1 个添加操作，1 个删除操作）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T17:37:49.163

您的要求有多具体？如果允许您跳出框框思考，一个简单的盖革计数器算法，也就是无限脉冲响应 (IIR) 数字滤波器计算移动“平均值”（取决于您如何定义“平均值”），具有最小内存占用，只需要几行代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T10:11:32.187

维护两个单独的列表会更有效，一个用于成功，一个用于失败。新条目总是附加在列表的末尾（即按增加的时间戳排序）。

现在，当您想获得最后 n 秒内的成功/失败次数时，您可以为`now() - n`列表创建一个时间戳并对其进行处理。一旦找到大于该值的时间戳，就可以消除当前元素之前的所有元素。列表的长度为您提供成功或失败的次数。

如果您需要优化，请查看通过减少时间戳（即添加新值）对列表进行排序是否更有效，并处理列表直到找到时间戳小于比较值的元素。丢弃此成员和所有以下成员。

很难事先说哪种方案会更有效，因此您必须尝试一下。OTOH 如果它工作得足够好，就没有理由优化 ;-)。

# php - 有没有办法使用 php 模拟“whois”工具？

> ID：556162
> 
> 赞同：5
> 
> 时间：2009-02-17T10:05:38.533
> 
> 标签：php, whois

我的服务器上没有安装 whois（显然它正在开发中，但没有真正的消息）。我想知道是否有人知道模拟它的功能的方法。我想我会将一些数据发布到一个 url，但我不知道什么或在哪里。

基本上我完全不知所措，我会很感激任何帮助，甚至是我可以调查的东西。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T10:07:33.350

您可以使用[PHP Whois API](http://www.nott.org/blog/php-whois-script.html)。这将允许您访问所有 whois 记录。要使用该功能，该页面底部有一个指向[类](http://www.phpclasses.org/browse/package/360.html)的链接。确保你也包括在内。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T11:51:23.973

您可以尝试在您的系统上运行它，例如假设您使用的是 linux 并且您安装了 /usr/bin/whois 库，那么您可以使用 php exec 运行 php

```
<?php exec("/usr/bin/whois $strDomain",$arrOutPut);?> 
```

仅当允许 php 在您的服务器上使用 exec 函数并确保验证传递给命令的参数时，这才有效……对于机器来说最终会很丑陋。

或者，您可以尝试使用 API

1.  [http://www.nott.org/blog/php-whois-script.html](http://www.nott.org/blog/php-whois-script.html)
2.  [http://www.tevine.com/projects/whois/](http://www.tevine.com/projects/whois/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T10:19:17.550

[这是我](http://www.shrinkrays.net/code-snippets/archive/php.aspx)不久前用一个简单的技巧写的一个（没有列出所有的 whois 服务器）。我从 Perl 转换它，它也在 C# 和 COM 对象中。

它不会进行所有的 whois 查询，因为一些域名注册商是贪​​婪的 *&!$ 并希望您为查询付费，或者将其保密。页面上有关于它的详细信息。

**更新**
这是节省您下载的代码。我使用 PHP 3.x 编写了它，因此可能需要对 PHP5 进行一些按摩：

```
class Whois
{
    /*
     * Optional parameter for the server to be used for the lookup.
     * If this is not set, an appropriate whois server for the domain name
     * specified is automagically found by the Whois class. 
     * @type string
     * @access public
     */
    var $whois_server;
    /*
     * The timeout, in seconds, for the lookup. Default is 30\. 
     * @type integer
     * @access public
     */
    var $timeout = 30;

    /*
     * Returns a string, with new-lines (\n) converted to non-breaking spaces (&lt;BR&gt;),
     * with details for the domain specified by $domain. 
     * @access public
     * @param string $domain the domain to lookup, excluding http:// and www
     * @return string the results of the whois
     */
    function lookup($domain)
    {
        $result = "";
        $parts  = array();
        $host   = "";

        // .tv don't allow access to their whois
        if (strstr($domain,".tv"))
        {
            $result = "'.tv' domain names require you to have an account to do whois searches.";
        // New domains fix (half work, half don't)
        } elseif (strstr($domain,".name") || strstr($domain,".pro") >0){
            $result = ".name,.pro require you to have an account to do whois searches.";
        } else{
            if (empty($this->whois_server))
            {
                $parts    = explode(".",$domain);
                $testhost = $parts[sizeof($parts)-1];
                $whoisserver   = $testhost . ".whois-servers.net";
                $this->host     = gethostbyname($whoisserver);
                $this->host     = gethostbyaddr($this->host);

                if ($this->host == $testhost)
                {
                    $this->host = "whois.internic.net";
                }
                flush();
            }
            $whoisSocket = fsockopen($this->host,43, $errno, $errstr, $this->timeout);

            if ($whoisSocket)
            {
                fputs($whoisSocket, $domain."\015\012");
                while (!feof($whoisSocket))
                {
                    $result .= fgets($whoisSocket,128) . "<br>";
                }
                fclose($whoisSocket);
            }
        }
        return $result;
    }
} 
```

**示例用法**

```
$whois = new Whois();
echo "<B>compaq.it</B><BR>";
echo $whois->lookup("compaq.it");
echo "<HR>"; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-09-06T11:39:09.510

您也可以为此使用[Net_Whois pear 包](http://pear.php.net/package/Net_Whois)。

免责声明：我是这个包的维护者。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-04T21:26:26.200

看看[RFC3912](https://www.rfc-editor.org/rfc/rfc3912)，它定义了`whois`协议。基本上，您只需要在端口 43 上打开一个 TCP 套接字，在以 CR+LF 终止的一行上发送您的请求，然后从服务器读回一团文本。

该标准（不幸的是）没有定义查询的格式，也没有定义回复的格式，也没有定义如何根据您需要做的事情找到合适的 whois 服务器进行查询。

请查看我的其他回复以获取更多详细信息：[https ://unix.stackexchange.com/a/407030/211833](https://unix.stackexchange.com/a/407030/211833)

# javascript - COM 对象和 javascript

> ID：556166
> 
> 赞同：0
> 
> 时间：2009-02-17T10:06:46.610
> 
> 标签：javascript, com

我试图消耗第三。来自 JavaScript 的派对 COM 对象。由于某种原因，当对象被处置时，它会在没有明显原因的情况下使我的 Internet Explorer 崩溃。

COM 对象在其他环境（如 vb 和 C#）中使用时可以完美运行

有什么建议么？可能是导致问题的IE安全设置吗？没有人知道 JavaScryp/Iexplorer 中 COM 对象使用的任何关键点吗？

非常感谢，

约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T10:19:50.510

作为第一个检查，在不同的浏览器中尝试相同的脚本。如果问题只出现在 IE 中，您可能需要确保 COM 对象支持[IObjectSafety](http://msdn.microsoft.com/en-us/library/aa768224(VS.85).aspx)。

# .net - 为 Visual Studio IDE 增添趣味

> ID：556174
> 
> 赞同：1
> 
> 时间：2009-02-17T10:09:21.147
> 
> 标签：.net, visual-studio, visual-studio-2008

目前我安装了 ReSharper 来帮助我开发和编辑代码，并在两个屏幕上为我的 Visual Studio (2008) 制作了一个很好的布局。我已将文本窗口（主要是右侧的输出窗口）的设置更改为黑色背景和较小的文本。

我昨天尝试了 SlickEdit 小工具，但在我看来它的性能不是很好。

您还使用了哪些其他插件或技巧来进一步自定义或增强您的 Visual Studio 体验？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T10:12:44.647

[Whole Tomato 的视觉辅助 X](http://www.wholetomato.com/)

我不确定我能不能没有它……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T10:26:10.387

[您使用哪些 Visual Studio 插件？](https://stackoverflow.com/questions/15784/what-visual-studio-add-ins-do-you-use)

[您最喜欢的 Visual Studio 插件/设置是什么？](https://stackoverflow.com/questions/106340/what-is-your-favorite-visual-studio-add-in-setting)

[自定义 Visual Studio](https://stackoverflow.com/questions/41908/customizing-visual-studio)

[您是否有任何推荐的 Microsoft Visual Studio 附加组件/插件？](https://stackoverflow.com/questions/2767/do-you-have-any-recommended-add-ons-plugins-for-microsoft-visual-studio)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T10:13:36.127

PowerCommands 是必须具备的

[http://code.msdn.microsoft.com/PowerCommands/Release/ProjectReleases.aspx?ReleaseId=559](http://code.msdn.microsoft.com/PowerCommands/Release/ProjectReleases.aspx?ReleaseId=559)

# c# - 如何将图像动态加载到报告中？

> ID：556178
> 
> 赞同：0
> 
> 时间：2009-02-17T10:10:12.640
> 
> 标签：c#, .net, visual-studio, crystal-reports

有没有办法根据图像路径将图像动态加载到报告中。图像文件名存储在数据库中。

供参考。我正在使用嵌入 VS.NET 2005 的 CrystalReport 设计器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T16:14:15.603

插入一个 OLE 对象，右键单击它并选择格式化对象，并在图形位置中为其位置创建一个公式，您应该能够引用您的数据库字段来构建该位置的路径。

# pear - 是否存在与 FROM_UNIXTIME() 等效的 PEAR::DB

> ID：556191
> 
> 赞同：0
> 
> 时间：2009-02-17T10:15:12.317
> 
> 标签：pear

我正在研究一种从 MySQL 中的时间戳中提取给定数据的方法。有人建议我尝试 FROM_UNIXTIME() ...但我的开发是围绕 pear::db 构建的，所以我正在寻找替代品。你有什么建议吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T10:25:15.193

您的意思是基于 PHP 的解决方案而不是使用 SQL 吗？只需使用该`date()`函数来格式化您的时间戳：

```
date("Y-m-d H:i:s", $timestamp); 
```

**具体答案（请参阅评论）：**要从中获取月份，只需将格式字符串更改为“m”并忽略其他所有内容。

# c - 从 setuid root C 程序调用脚本 - 脚本不以 root 身份运行

> ID：556194
> 
> 赞同：27
> 
> 时间：2009-02-17T10:18:36.193
> 
> 标签：c, scripting, setuid

我需要以 root 身份运行 bash 脚本（无密码 sudo 或 su 不可行），并且由于您无法在 Linux 中设置脚本，因此我考虑从可执行文件中调用它并将*其*设置为setuid：

```
$ cat wrapper.c
int main(void)
{
        system("/bin/bash ./should_run_as_root.sh");
}
$ gcc -o wrapper wrapper.c
$ sudo chown root wrapper
$ sudo chmod ug+s wrapper
$ ll wrapper
-rwsr-sr-x 1 root users 6667 2009-02-17 11:11 wrapper
$ 
```

这有效 - 就像正确运行脚本一样 - 但脚本以执行“./wrapper”的用户身份运行。

为什么？以及如何正确实现这一点？

谢谢！

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-02-17T10:19:45.067

由于`suid`可执行文件上的位仅更改可执行文件将运行的有效 UID (EUID)，而不是`getuid()`返回的真实 UID (RUID)，并且除了对`suid`解释脚本（任何以“”开头的可执行文件`#!`）的限制之外，一些 shell就像`bash`在这种情况下额外的安全措施会将 EUID 设置回 RUID，您需要`setuid(0)`在执行脚本之前在 C 代码中使用调用。

请参阅、、 和的`man`页面，`setuid`了解真实有效的 UID 的确切语义。`seteuid``getuid``geteuid`

（*警告*）当然，这是一个恰当的点，即`suid`在许多 Unix 系统、shell 和解释器中对脚本的限制是有原因的，那就是如果脚本在清理其输入和状态方面不是很小心当它被执行时，它们是危险的并且可以被用于安全升级。因此，在执行此操作时要非常小心。尽可能严格地设置对脚本和包装器的访问，只允许您打算执行的这个非常特定的脚本，并在启动脚本之前清除 C 程序中的环境，设置环境变量`PATH`以准确包含以正确的顺序是必需的，并且没有可写给其他人的目录。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-17T14:18:32.607

这里要注意的另一件事是，这里的限制来自 bash 而不是 *nix 系统本身。Bash 实际上对 SUID 脚本进行验证，以仅使用 EUID root 执行它们。如果您使用较旧的贝壳，您通常会得到您想要的开箱即用的东西。例如， sh 不会进行这种验证：

```
$ cat wrapper.c
int main(void)
{
            system("/bin/sh -c whoami");
}

$ ls -l wrapper
-rwsr-sr-x 1 root users 8887 Feb 17 14:15 wrapper
$ ./wrapper
root 
```

使用 bash：

```
$ cat wrapper.c
int main(void)
{
            system("/bin/bash -c whoami");
}

$ ls -l wrapper
-rwsr-sr-x 1 root users 8887 Feb 17 14:18 wrapper
$ ./wrapper
skinp 
```

尽管如此，汤姆的回答通常是为 SUID 根程序制作包装器的方法

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-05-06T08:37:53.090

在脚本中添加 setuid(0) 并编译它。在此之后它应该起作用。

```
$ cat wrapper.c 
int main(void) 
{ 
        setuid(0);
        system("/bin/bash ./should_run_as_root.sh"); 
} 
$ gcc -o wrapper wrapper.c 
$ sudo chown root wrapper 
$ sudo chmod ug+s wrapper 
$ ll wrapper 
-rwsr-sr-x 1 root users 6667 2009-02-17 11:11 wrapper 
$ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-01-03T11:36:27.503

这些示例非常不安全，并且允许具有两种知识的任何人以 setuid 用户身份运行他们想要的任何程序。

除非您首先清理环境，否则永远不要通过 shell，这里显示的大多数示例都容易在运行之前设置 IFS 和 PATH。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-03T23:42:44.833

为什么 sudo 不可行？它避免了严重的安全漏洞，例如：

```
bash-3.2$ cat test
#!/bin/bash
echo ima shell script durp durp
bash-3.2$ chmod +x test
bash-3.2$ ./test
heh heh
bash-3.2$ 
```

由于环境没有得到适当的消毒，例如在这种情况下：

```
export echo='() { builtin echo heh heh; }' 
```

sudo 清理了这种情况，也许还有其他边缘情况和陷阱，最好不要写入自定义 suid 包装器。

# syntax-highlighting - COBOL 源列的不同背景颜色

> ID：556197
> 
> 赞同：4
> 
> 时间：2009-02-17T10:19:40.573
> 
> 标签：syntax-highlighting, notepad++, cobol, highlighting, jedit

我正在寻找一种在 Notepad++ 中“点亮”列的方法。

*   COBOL 编译器会忽略前 6 列和从第 73 列开始的所有字符（到第 80 列，81+ 无论如何都会被忽略）。
*   第七个字符具有特殊含义（注释、调试、...）。
*   第 8 到 11 个字符也有特殊含义。

对于代码查看，进行正则表达式搜索就足够了，`^.......`因为`^.{7}`它不起作用。使用“标记模式”选项点击“搜索全部”，您可以标记前 7 列。

问题是，当您编辑代码时，标记被扩展/缩小/移动，您需要重做标记/搜索。

我使用 NotePad++ 5.03 ansi w/o unicode，从其网站安装的 COBOL 突出显示。

> 编辑：我还尝试了“选项”-“视图”-窗格-“主视图”-“显示垂直限制”，但这显示在所有文档中，并且仅用于一个列位置

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T10:40:25.767

[jEdit](http://www.jedit.org/)具有 COBOL 模式，但它也不以特殊方式处理前七个字符，除非它们后跟 * 或 /。然后整行被视为注释。

应该可以改变编辑模式来改变这一点，不过我有点担心性能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-23T23:12:46.220

[Zeus编辑器为](http://www.zeusedit.com/)*大约 30 种语言*提供语法高亮显示，*COBOL*就是其中之一。

它的**COBOL 模式被配置为对***第 1-6 列*不进行特殊突出显示，对第*7列中的任何***“*”**字符进行特殊注释突出显示，并对第 8 列之后（包括*第 8 列*）的所有文本进行默认*COBOL 突出显示*。它还有一个可移动的右边距来标记第*73 列*的位置。

 ***它甚至可以进行有限数量的 COBOL 代码折叠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-23T12:07:18.520

它接缝 Notepad++ 无法突出显示列。

对于 jEdit，我发现了一些可能性，但还没有完成：

*   插件**ColumnRuler**版本：1.0.2 作者：Brad Mace，
    但在所有文件模式下都显示。
*   我正在编辑一个新的 COBOL 模式文件，这并不容易，尤其是标记从第 73 列开始的所有文本。

编辑：COBOL 模式已准备好并已提交，请参阅[https://sourceforge.net/tracker/index.php?func=detail&aid=2654343&group_id=588&atid=350588](https://sourceforge.net/tracker/index.php?func=detail&aid=2654343&group_id=588&atid=350588)

# c++ - 分析编译时间

> ID：556201
> 
> 赞同：7
> 
> 时间：2009-02-17T10:21:13.567
> 
> 标签：c++, build

我有一个使用 VC7 编译的 C++ 代码，构建它需要很多时间。有什么方法可以分析它并找出构建它需要时间的原因吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-17T10:25:03.993

在 Visual Studio 2008 中，有一个用于打开生成时间的设置。它可能也存在于VC7中......

`Tools`/ `Options`/ `Projects and Solutions`/ `VC++ Project Settings`/`Build Timing:` `Yes`

这适用于 C++ 项目，这些项目（从 VS2008 开始）不使用 MSBuild。对于基于 MSBuild 的项目（例如 C#），您希望增加详细程度：

`Tools`/ `Options`/ `Projects and Solutions`/ `Build and Run`/`MSBuild project build output verbosity`

默认情况下，它设置为“最小”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T10:47:16.407

如果代码是模板密集型的，那么您可以尝试进行模板实例化分析。Steven Watanabe 提出了[分析器](http://svn.boost.org/svn/boost/sandbox/tools/profile_templates/)，如果我没记错的话，它应该可以与 VS 一起使用（不知道版本）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-10-05T08:32:31.817

最近 Microsoft 的[C++ Build Insights SDK](https://devblogs.microsoft.com/cppblog/analyze-your-builds-programmatically-with-the-c-build-insights-sdk/)`/timetrace`为其[vcperf](https://github.com/microsoft/vcperf)引入了一个选项，允许您在任何基于铬的浏览器中以火焰图的形式分析您的构建并可视化特定组件的构建时间。

假设您已`vcperf`下载并安装，您需要：

1.  通过执行开始其会话

```
vcperf /start SessionName 
```

2.  运行您的构建（事件由 vcperf 在系统范围内捕获）
3.  停止会话

```
vcperf /stop SessionName /timetrace output.json 
```

您现在可以运行基于 chromium 的浏览器，输入`<browser_name>://tracing`,（例如`chrome://tracing`）并加载`output.json`文件以进行可视化。

从[这里获取的](https://devblogs.microsoft.com/cppblog/analyze-your-builds-programmatically-with-the-c-build-insights-sdk/)[示例可视化](https://i.stack.imgur.com/En44G.png)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T10:25:55.677

源代码在网络上吗？这有时会大大减慢编译速度。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T10:38:45.537

我的猜测是，很难从分析中获得有用的结果。您可以查看每个 .obj 文件的创建时间并检查是否有任何文件特别慢，但我怀疑情况是否如此。

您是否浏览过编译器选项（例如预编译头文件）以查看 ths 提供了哪些改进？同样，在不需要的地方关闭优化器可以显着加快构建速度。我的建议是花一些时间尝试一些“假设”场景。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-10-22T14:16:09.037

如果您的代码大量使用模板，您可能会对[Templight](http://gsd.web.elte.hu/templight/)感兴趣，这是一个由匈牙利研究团队开发的用于调试和分析 C++ 模板元程序的工具（[论文](http://gsd.web.elte.hu/contents/articles/gpce06.pdf)）。看起来很有希望，但我不确定该工具是否可供下载......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T22:03:58.273

如果可能的话，您可以尝试[#include all .cpp files into a single compilation unit](https://stackoverflow.com/questions/543697/include-all-cpp-files-into-a-single-compilation-unit)的技巧，只是为了检查您是否有很多文件和许多包含的开销。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-17T10:33:15.753

使用[预编译头文件](http://msdn.microsoft.com/en-us/library/szfdksca.aspx)

# c# - 静态类如何从对象派生？

> ID：556203
> 
> 赞同：43
> 
> 时间：2009-02-17T10:21:28.637
> 
> 标签：c#, oop

我正在尝试通过静态类继承非静态类。

```
public class foo
{ }

public static class bar : foo
{ } 
```

我得到：

> 静态类不能从类型派生。静态类必须派生自对象。

**我如何从对象派生它？**

代码在 C# 中。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2009-02-18T21:55:32.467

派生静态类没有任何价值。使用继承的原因是：

*   多态性
*   代码重用

显然，您无法使用静态类获得多态性，因为没有实例可以动态调度（换句话说，您不能将 Bar 传递给期望 Foo 的函数，因为您没有*Bar*） .

使用组合很容易解决代码重用：给 Bar 一个 Foo 的静态实例。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2009-02-17T10:27:56.060

从 C# 3.0 规范，第 10.1.1.3 节：

> 静态类可能不包括基于 *类的*规范（第 10.1.4 节），并且不能显式指定基类或已实现接口的列表。静态类隐式继承自 type `object`。

换句话说，你不能这样做。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2009-02-17T10:26:04.910

错误消息是虚假的。它不是说“一个”对象。它谈论的是称为“对象”的内置类型，它是 .NET 中所有内容的基础。

它应该说“静态类不能指定基类型”。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-02-17T10:30:51.717

取自[http://msdn.microsoft.com/en-us/library/79b3xss3(VS.80).aspx](http://msdn.microsoft.com/en-us/library/79b3xss3(VS.80).aspx)

> 静态类的主要特点是：
> 
> 它们只包含静态成员。
> 
> 它们不能被实例化。
> 
> 它们是密封的。
> 
> 它们不能包含实例构造函数（C# 编程指南）。

因此，通过将非静态成员引入静态类，从非静态类继承违反了此列表中静态类的第一个特性。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-17T10:25:54.133

我不认为 C# 支持静态类的继承。

一种选择是改用单例模式

```
public class foo
{ }

public class bar : foo
{
    private bar instance;
    public bar GetInstance()
    {
        if(instance == null) instance = new bar();
        return instance;
    }

    private bar(){} //make default constructor private to prevent instantiation 
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T13:37:50.473

如前所述，C# 规范说这是无法做到的。您也不能使用静态类实现接口。您最好的选择是从使用静态类更改为使用使用单例模式的类。您将只有一个实例（类似于静态类的工作方式），您将能够继承行为或实现接口。

[您在此处](http://msdn.microsoft.com/en-us/library/ms998558.aspx)、[此处](http://en.wikipedia.org/wiki/Singleton_pattern)和[此处](http://www.yoda.arachsys.com/csharp/singleton.html)阅读了单身人士。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-01-05T16:31:09.243

正如克里斯托弗所指出的，假设我们可以从非静态类派生静态类。

例如：

```
public class foo
{
    public int myVar;
}

public static class bar : foo { } 
```

这里，**bar**类派生自**foo**，因此静态类**Bar**现在具有非静态成员**myVar**，并且根据 c# Specification ，静态类不能包含非静态成员！

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T10:23:26.087

不是所有的类（包括静态的）都派生自对象吗？如，默认情况下？

另外，就像它说的那样，“静态类不能从类型派生。”，所以我不认为你在做什么是可能的。无论如何，您为什么希望静态类从类型派生？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-17T10:25:27.550

它不能。您必须创建一个普通类才能从其他类派生。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-17T10:26:06.237

所有类都隐式派生自`Object`. 也就是说，尽管静态类（根据定义只是静态成员的容器）从对象“派生”，但您无法从该事实中获得任何信息。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-17T10:26:38.013

错误消息具有误导性。

bar 不能从 foo 继承，因为 foo 可以被实例化而 bar 不能。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-17T14:44:52.653

如果您试图阻止人们创建该类的实例，只需添加一个私有默认构造函数。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-07-27T17:24:41.210

静态类不能是其他类的基类，也不能扩展。

静态类只能从“对象”类（.net 基类）继承。

附加信息：.net 中的所有类都继承自“对象”类，甚至任何静态类也是如此。

不同之处在于，即使静态类继承“对象类”，它也仅从“对象”类继承两个静态方法。

其他非静态类继承其他四种方法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2012-01-30T05:20:34.320

如其他答案所述，编译器消息令人困惑但正确。你可以写：

```
static class A : object
{
} 
```

当然，显式声明这种继承并不是很有用，但继承本身在框架中实际上很有用，因为您覆盖了对象的虚拟成员：

```
 static class A : object
    {
        public static new string ToString()
        {
            return "I am object A";
        }

        public static new int GetHashCode()
        {
            return ToString().GetHashCode();
        }
    } 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-11-06T16:23:53.093

OP问“我怎样才能从物体上驱动它？”。这里`object`不是另一个类的实例，所以答案是你没有。`object`指的是 System.Object 基类，它是 .NET 中所有类型的默认基类。错误消息有点误导。

只是为了完整性，另一方面，静态类也不能被继承或扩展，因为它既是抽象类又是密封类。

# iphone - 如何从 iPhone 上的 UIImage 获取 UIColor

> ID：556205
> 
> 赞同：3
> 
> 时间：2009-02-17T10:23:22.220
> 
> 标签：iphone

我想逐点处理我的图像，但我不知道如何从图像中获取点的颜色。以及如何逐点移动指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T11:15:15.403

您不能直接从 UIImage 执行此操作，但您可以使用您提供的内存缓冲区将图像渲染到位图上下文中，然后直接测试内存。这听起来比实际上更复杂，但可能仍然比你想听到的更复杂。

如果你有 Erica Sadun 的 iPhone Developer's Cookbook，从第 54 页开始就有很好的介绍。我会整体推荐这本书，如果你没有它，那么值得一读。

我独立地得出了几乎完全相同的代码，但遇到了一个看起来可能也在 Sadun 的代码中的错误。在 pointInside 方法中，point 和 size 值是浮点数，并且在转换为 int 之前作为浮点数相乘。如果您的坐标是离散值，这很好，但在我的情况下，我提供的是子像素值，所以公式被打破了。当然，一旦您确定了问题，修复就很容易了 - 只需在乘法之前将每个坐标转换为一个 int - 所以，在萨顿的情况下，它将是：

```
 long startByte = ((int)point.y * (int)size.width) + (int)point.x) * 4; 
```

此外，Sadun 的代码和我自己的代码都只对 alpha 值感兴趣，因此我们使用仅获取 alpha 值的 8 位像素。更改 CGBitMapContextCreate 调用也应该允许您获得实际的颜色值（显然，如果您的每个像素超过 8 位，您也必须将其乘以您的 pointInside 公式）。

[编辑] 这促使我将[代码放在我的博客上](http://www.levelofindirection.com/journal/2009/9/24/getting-at-pixel-data-from-a-uiimage-for-iphone-dev.html)（在我研究如何语法高亮它时附带一个旁道）：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-04-06T23:39:56.130

希望节省很多时间，CreateARGBBitmapContext 函数应该有一个 memset(bitmapData, 0, bitmapByteCount); 在 malloc 成功之后，您不会在源图像中获得随机数据 - 这会将所有内容设置为有效透明。

# c# - C#：线程安全函数

> ID：556207
> 
> 赞同：1
> 
> 时间：2009-02-17T10:23:48.427
> 
> 标签：c#

下面哪个代码更适合多线程访问函数的情况

```
public ArrayList CallMe1()
    {
        ArrayList al = new ArrayList();

        lock(al.SyncRoot)
        {
            al.Add("33");
            al.Add("45");

            return al;
        }

    }

    public ArrayList CallMe2()
    {

        ArrayList al = new ArrayList();

        Monitor.Enter(al);

        al.Add("33");
        al.Add("45");
        Monitor.Exit(al);

        return al;

    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-17T10:26:46.157

在这种情况下没有共享状态，因此不需要同步。

但是，假设 arraylist**是**共享状态，以下适用：

它们都是相同的（[lock 在内部实现 Monitor](http://msdn.microsoft.com/en-us/library/c5kehkcz(VS.80).aspx)）。

大多。

你的第二个版本需要分`finally`块释放监视器，否则如果代码抛出异常，锁将永远不会被释放，会导致你的应用程序死锁。

总之，使用第一个版本 ( `lock (...) {... }`) 可以避免不必要的输入和可能的错误。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-17T10:27:23.397

两者都不。函数不共享任何数据，因此不需要同步。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-17T10:28:01.037

两者都不。您的函数都没有共享状态（只有局部变量），这使得它们本质上是可重入的。不需要任何同步。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T10:59:50.883

1 - 你在这里不需要任何锁。

2 - 如果可以使用锁，请不要使用 Monitor。

3 - 在第一个示例中，您要锁定一个 SyncRoot 对象，这比锁定一个数组要好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T10:28:32.083

正如其他答案所说，锁使用监视器，但它比你的第二个例子做得更好。更好的是它在 try finally 块中包装对监视的调用，以确保在出现异常时释放锁。

出于这个原因，我建议您对几乎所有操作都使用锁定。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T12:00:03.750

[您也可以在此处](https://stackoverflow.com/questions/266681/c-return-statement-in-a-lock-procedure-inside-or-outside)找到部分答案。

Return 语句内部（CallMe1）或外部（CallMe2）锁也没有区别。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-02-17T10:25:52.010

.net**锁**的问题在于，如果发生死锁，它不会抛出任何异常或任何东西。

顺便说一句，您每次都会锁定一个新创建的 ArrayList。那应该有什么帮助？我更喜欢在某处创建一个静态对象并锁定它。

# episerver - 有没有人有任何 EPiServer 考试技巧？

> ID：556221
> 
> 赞同：3
> 
> 时间：2009-02-17T10:26:07.283
> 
> 标签：episerver

我和一些同事刚刚被告知，我们都将在周五参加 EPiServer CMS 认证考试。在网络上进行了一些研究之后，这听起来确实像是一项具有挑战性的考试——我听说只有六分之一的人通过了它。

[除了EPiServer 网站](http://www.episerver.com/en/Education/EPiServer-Certified--Developer/EPiServer-Knowledge-Areas-51/ "EPiServer 站点")、这篇[博](http://blog.fredrikhaglund.se/blog/2008/11/30/how-to-become-a-episerver-ceritified-developer/)文和这篇[博](http://mint.litemedia.se/2008/11/29/episerver-cms-5-certified-developer/)文中描述的内容之外，学习材料的方式似乎并不多。

最近有没有其他人通过，如果有，他们可以提供任何提示或提示吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-05-25T08:07:26.733

EPiServer 考试难度很大。在撰写此答案/回复时，有几件事值得注意：

1.  考试基于 EPiServer CMS 5（不是 CMS 5 R2）。下载该版本并熟悉它。有一些细微的区别，例如用于部署的 EPiServer Manager 与 R2 中使用的 EPiServer 部署中心相对。
2.  确保您了解的不仅仅是开发。该考试涵盖设置以及一般开发。您需要了解不同的安装方法（使用 EPiServer 管理器）以及镜像配置以及文件管理器和办公室集成的工作方式。在我工作的地方，我们往往不会过多地使用这些位，所以这对我们的人来说可能很难。
3.  熟悉 EPiServer 标准控件，例如 EPiServer:Property 和 SearchDataSource。同样，我们在这里不会过多地使用它们，因为我们有自己的一组函数，我们使用它们位于 EPiServer 之上来为我们做事。
4.  正如丹尼尔所提到的，阅读编辑器和管理手册，这里有很多宝石。

我不打算在这里写细节，因为（而且是正确的），EPiServer 宁愿你学习所有这些东西，也不愿有人告诉你问题可能是什么。尽管提供的信息有点令人沮丧，但您可以通过博客、论坛和 SDK 等来了解如何做事，而不是像 MS 考试那样有一个简洁的小课程，在那里您可以阅读一本书并通过考试。这是基于对产品本身的了解，因为这似乎更多地表明了技术能力而不是学术能力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-22T08:58:39.403

另一篇博文... [http://fringan.blogspot.se/2012/03/reflections-from-taking-episerver-cms-6.html](http://fringan.blogspot.se/2012/03/reflections-from-taking-episerver-cms-6.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-05T12:27:50.863

找到了一篇可能对您有所帮助的精彩博文。

[EPiServer CMS 5 认证开发人员](http://mint.litemedia.se/2008/11/29/episerver-cms-5-certified-developer/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-12T13:33:44.987

请务必彻底阅读 Episerver 编辑器和管理手册。大多数答案实际上都在那里找到......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-22T12:24:23.823

EPiServer 网络警察似乎与 giles 谈过话……

...阅读手册和 SDK。实际上，这是一个非常棘手的考试，如果没有几个项目，你就无法通过它。要复习的主题示例包括办公室集成、工作流、导入\导出\镜像、配置设置、日志记录、URL 重写器、页面提供程序、扩展所见即所得编辑器、语言处理、搜索控制、缓存......我可以继续所有天。

# mysql - SQL：在嵌套 FROM 子句中的 UPDATE 语句中使用目标表

> ID：556237
> 
> 赞同：1
> 
> 时间：2009-02-17T10:32:12.947
> 
> 标签：mysql, sql, sql-update, mysql-error-1093

我有一个（mysql）数据库表，其中包含以下列：

```
NAME | String (Unique)

STATUS | int

UPDATE_COUNT | int (Unique) 
```

我希望 Max(UPDATE_COUNT) 的值反映对表中的行执行的更新的累积次数。例如，从一个空表开始：

```
Insert - (Name=John, Status=0) -  // update count on that row is set to 1

Insert - (Name=Mary, Status=0) -  // update count on that row is set to 2

Update - (Name=John, Status=1) -  // update count on that row is set to 3

Update - (Name=Mary, Status=2) -  // update count on that row is set to 4 
```

ETC..

因此，对于任何行，无论是更新还是插入，每行插入或更新的更新计数值为 max(update_count) + 1。

这个想法是“从 mytable 中选择 max(update_count)”结果表示执行的插入/更新的总数。

我想编写自动增加 update_count 值的插入和更新 sql 语句，例如：

```
"UPDATE MYTABLE SET STATUS=1,UPDATE_COUNT=(SELECT MAX(UPDATE_COUNT) FROM MYTABLE) WHERE NAME IN ('John', 'Mary')" 
```

但是这不是有效的 sql，更新语句我不包含从同一个表中选择的 from 子句，mysql 中的错误是：

```
"You can't specify target table 'MYTABLE' for update in FROM clause" 
```

有关如何规避此限制的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T10:40:33.067

刚刚在优秀的 Xaprb 博客上找到了以下解决方案：

[http://www.xaprb.com/blog/2006/06/23/how-to-select-from-an-update-target-in-mysql/](http://www.xaprb.com/blog/2006/06/23/how-to-select-from-an-update-target-in-mysql/)

# java - Hibernate：外键约束违反问题

> ID：556238
> 
> 赞同：5
> 
> 时间：2009-02-17T10:32:35.550
> 
> 标签：java, mysql, hibernate, spring

我的代码中有一个 com.mysql.jdbc.exceptions.MySQLIntegrityConstraintViolationException（使用 Hibernate 和 Spring），我不知道为什么。我的实体是 Corpus 和 Semspace，并且在我的休眠映射配置中定义了从 Semspace 到 Corpus 的多对一关系：

```
<class name="xxx.entities.Semspace" table="Semspace" lazy="false" batch-size="30">
    <id name="id" column="idSemspace" type="java.lang.Integer" unsaved-value="null">
        <generator class="identity"/>
    </id>
    <property name="name" column="name" type="java.lang.String" not-null="true" unique="true" />
    <many-to-one name="corpus" class="xxx.entities.Corpus" column="idCorpus"
                insert="false" update="false" />
    [...]
</class>
<class name="xxx.entities.Corpus" table="Corpus" lazy="false" batch-size="30">
    <id name="id" column="idCorpus" type="java.lang.Integer" unsaved-value="null">
        <generator class="identity"/>
    </id>
    <property name="name" column="name" type="java.lang.String" not-null="true" unique="true" />
</class> 
```

生成异常的 Java 代码是：

```
Corpus corpus = Spring.getCorpusDAO().getCorpusById(corpusId);
Semspace semspace = new Semspace();
semspace.setCorpus(corpus);
semspace.setName(name);
Spring.getSemspaceDAO().save(semspace); 
```

我检查了语料库变量不为空（因此它在使用 DAO 检索的数据库中）完整的例外是：

```
com.mysql.jdbc.exceptions.MySQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`xxx/Semspace`, CONSTRAINT `FK4D6019AB6556109` FOREIGN KEY (`idCorpus`) REFERENCES `Corpus` (`idCorpus`))
at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:931)
at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:2941)
at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1623)
at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1715)
at com.mysql.jdbc.Connection.execSQL(Connection.java:3249)
at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:1268)
at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:1541)
at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:1455)
at com.mysql.jdbc.PreparedStatement.executeUpdate(PreparedStatement.java:1440)
at org.apache.commons.dbcp.DelegatingPreparedStatement.executeUpdate(DelegatingPreparedStatement.java:102)
at org.hibernate.id.IdentityGenerator$GetGeneratedKeysDelegate.executeAndExtract(IdentityGenerator.java:73)
at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:33)
at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2158)
at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2638)
at org.hibernate.action.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:48)
at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:250)
at org.hibernate.event.def.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:298)
at org.hibernate.event.def.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:181)
at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:107)
at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:187)
at org.hibernate.event.def.DefaultSaveEventListener.saveWithGeneratedOrRequestedId(DefaultSaveEventListener.java:33)
at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:172)
at org.hibernate.event.def.DefaultSaveEventListener.performSaveOrUpdate(DefaultSaveEventListener.java:27)
at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:70)
at org.hibernate.impl.SessionImpl.fireSave(SessionImpl.java:535)
at org.hibernate.impl.SessionImpl.save(SessionImpl.java:523)
at org.hibernate.impl.SessionImpl.save(SessionImpl.java:519)
at org.springframework.orm.hibernate3.HibernateTemplate$12.doInHibernate(HibernateTemplate.java:642)
at org.springframework.orm.hibernate3.HibernateTemplate.execute(HibernateTemplate.java:373)
at org.springframework.orm.hibernate3.HibernateTemplate.save(HibernateTemplate.java:639)
at xxx.dao.impl.AbstractDAO.save(AbstractDAO.java:26)
at org.apache.jsp.functions.semspaceManagement_jsp._jspService(semspaceManagement_jsp.java:218)
[...] 
```

外键约束已由 hibernate 创建（并添加到数据库中），我看不出在哪里可以违反约束。该表是innodb，我试图删除所有表并重新创建它，问题仍然存在......

编辑：嗯，我想我有一个答案的开始......我将休眠的日志级别更改为调试，在它崩溃之前我有以下日志

```
insert into Semspace (name, [...]) values (?, [...]) 
```

所以看起来它没有尝试插入 idCorpus 并且因为它不是 null 它使用默认值“0”，它不引用语料库表中的现有条目......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-17T13:53:19.250

我一直对关联映射感到困惑。查看所需的关联以及用于创建关联的休眠映射配置。

[http://docs.jboss.org/hibernate/core/3.5/reference/en/html/associations.html](http://docs.jboss.org/hibernate/core/3.5/reference/en/html/associations.html)

是一本很棒的协会食谱书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T10:46:02.493

看起来很简单。您的异常的第一行清楚地表明违规是从另一个表中的列`idCorpus`到另一个列，`Corpus/idCorpus`.

您应该能够直接访问数据库以找出约束是什么。我怀疑这是对另一张桌子的简单查找。

然后打印出您在提供的 Java 代码中使用的值，并且希望瞧，您会知道要在 Semspace 中插入不在 Corpus 中的值。

`com.mysql.jdbc.exceptions.MySQLIntegrityConstraintViolationException: Cannot add or update a child row: a foreign key constraint fails (`diaz/Semspace`, CONSTRAINT `FK4D6019AB6556109` FOREIGN KEY (`idCorpus`) REFERENCES `Corpus` (`idCorpus`))`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-30T18:06:58.940

旧帖子，我知道，但我发现所有这些解决方案都缺乏。

在休眠映射中，您有：

```
<many-to-one name="corpus" class="xxx.entities.Corpus" column="idCorpus"
            insert="false" update="false" /> 
```

您应该将第二行更改为：

```
<many-to-one name="corpus" class="xxx.entities.Corpus" column="idCorpus"
            cascade="save-update" not-null="true" insert="true" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-10T00:55:10.207

我知道旧帖子，但是如果另一边是@ManyToOne，我有这个并通过将@ManyToMany 更改为@OneToMany 来修复它。

# asp.net - 网址重写

> ID：556240
> 
> 赞同：0
> 
> 时间：2009-02-17T10:33:23.130
> 
> 标签：asp.net, url, mapping

我正在使用 regx 在我的 asp.net 应用程序中使用 URL 重写

虚拟网址是

```
/ProductDatabaseCMS/(?<category>\w*)/Product/(?<product>\w*)\.aspx 
```

原始网址是

```
/ProductDatabaseCMS/Product.aspx?PROD_ID=${product} 
```

应用路径是`~/ProductDatabaseCMS`

我的应用程序有使用样式表的母版页，路径是

```
~/App_Themes/Styles/Style_Sheet.css 
```

我正在请求网址

```
/ProductDatabaseCMS/(?<category>\w*)/Product/(?<product>\w*)\.aspx 
```

从使用超链接控件的应用程序网页之一，但在这种情况下，样式表不适用于此页面，因为它正在使用路径

```
~/ProductDatabaseCMS/(?<category>\w*)/Product/App_Themes/Styles/Style_Sheet.css 
```

在这种情况下我必须做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T10:49:38.833

如果您使用相对 URI 来引用外部样式表，则必须考虑这一点：相对 URI 总是从基 URI 解析的，如果未另行声明，则该基 URI 是当前资源的 URI。

因此，如果您请求`/foo/bar`并且 HTML 文档中有相对 URI 引用`css/baz.css`，它将被解析`/foo/css/baz.css`为`/foo/bar`基本 URI。

要解决此问题，您有两种选择：

1.  使用绝对 URI 或至少使用绝对路径来引用资源（例如`/App_Themes/Styles/Style_Sheet.css`），或
2.  `BASE`使用HTML 元素（例如）设置合适的基础 URI `<base href="/">`，以便从新的基础 URI 解析每个相对 URI。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T10:50:12.733

对 CSS href使用[“根相对路径”](http://www.google.com/search?q=%22root+relative%22+path)。你用“/”开始href，就是这样。

尝试：`/App_Themes/Styles/Style_Sheet.css`

# css - CSS 中什么更好： div.something 或只是 .something

> ID：556241
> 
> 赞同：5
> 
> 时间：2009-02-17T10:34:06.453
> 
> 标签：css, css-selectors

在 CSS 中，当在 div 上设置样式（例如）时，包含 'div' 是否有任何好处，而不是让它更精确地进行匹配。浏览器渲染速度可能更快吗？

即是：

```
div.something { font-size: 1em; } 
```

好于

```
.something { font-size: 1em; } 
```

除了将其缩小到只有div之外，还有什么其他原因吗？

*（我问的原因是我最近偶然发现了一个包含 'div's 但大多数人不会打扰的著名网站）*

更新：

感谢所有的答案。结论是速度是一个因素，但并不明显，因此值得忽略。最佳实践的共识是包含标签更简洁 - 一般规则应该是保持 CSS 尽可能“紧”以获得所需的样式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T10:40:07.797

除了两个选择器的不同语义，请阅读：[CSS 速度](https://stackoverflow.com/questions/536091/speed-of-css/536124)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T10:40:21.990

如果你想在不止 div 上使用一个类，你可以使用一个通用类，比如

```
.something{} 
```

但是一个类越具体，它就越突出，无论顺序如何，即：

```
#someID div.something { background: green; }
div.something { background: blue;}
.something { background: red; } 
```

由于第一个是最具体的：

```
<div class="something"> this will be blue </div>
<div id="someID">
  <div class="something">
    this will be green
  </div>
</div>
<p class="something">this will be red</div> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T10:42:49.100

将元素选择器 (div) 添加到规则中会增加规则的[特异性](http://htmldog.com/guides/cssadvanced/specificity/)，使其比通用类选择器 (.something) 更重要

它还使您的 CSS 更具可读性。如果您的所有类选择器都没有预先添加元素，则意味着您的类是模棱两可的，并且可以应用于任何元素。（这可能是意图，但更多时候不是）

如上所述，使用元素名称会在速度上进行权衡，但这几乎不会引起注意。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T10:37:10.983

好吧，我认为唯一的目的就像您说的“将其缩小到仅 div”。所以这`<p class="something">`应该与div的行为相同或不同......

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T10:37:17.177

我认为这个问题与广为人知的范围限制编程概念非常相似：您将变量和其他资源的范围限制在最低限度。

类似地，如果您知道一个样式将只与该类的 div 一起使用，那么将“类的范围”限制为 div 是有意义的。它减少了混乱并使您的样式表更易于维护。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T10:36:38.897

好吧，如果您想让其他具有相同类名的标签有另一种外观，那么这样做可能是个好主意。

我总是包含标签名称以获得更好的可读性，并且我确信如果它们共享一个类名，我不会覆盖其他规则。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T10:41:14.593

将 div 添加到选择器的开头会在 css 规则和 html-document 之间创建额外的依赖关系。突然更改元素类型也需要您更改 css，没有充分的理由。

对于需要指定元素类型以区分两个规则的场景，我建议改为更改类名。不要指望那个 div 总是一个 div。作为 ap 或 fieldset 或 label 可能更有意义。

避免不必要的依赖。

低特异性 css 规则是一个问题，但添加元素类型不是解决方案。如果我的 .price 更改为 div.price，则意外匹配的概率只会略微降低。使用外部#id 命名空间会更好。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T10:44:17.583

类应该具有良好的结构、功能性和原子性。有时，如果您认为自己会遇到类似的情况，最好将其缩小到 element.name

```
div.highlight {
    background: #FF00FF;
}

span.highlight, p.highlight {
    color: #FF00FF;
} 
```

否则你必须做类似的事情

```
.highlight {
    color: #FF00FF;
}

div.highlight {
    background; #FF00FF;
    color: inherit;
} 
```

我认为，作为一般经验法则，一个类定义应该适用于应用于它的所有元素。如果在特定情况下您必须覆盖类的默认定义，那么对于初学者来说，至少定义一个新类，这样您就不会破坏其他元素的呈现。

您还必须确定何时避免对选择器的这种结构依赖，例如

```
div#main div.section h1.title span.link { } 
```

但最好还是写

```
div#main span.link {} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-17T11:08:27.523

除非您在其他地方重用该类，否则它不会产生`something`影响，当然您没有应该使用 CSS 优先级模式解决的冲突。如果是这种情况，`div.something`则具有更高的优先级，`.something`因为它更具体。看看[Calculating a selector's specificity](http://www.w3.org/TR/CSS2/cascade.html#specificity) from the [CSS2 Specification](http://www.w3.org/TR/CSS2/)。

# sql - 在 SP 中搜索

> ID：556242
> 
> 赞同：2
> 
> 时间：2009-02-17T10:34:18.683
> 
> 标签：sql, sql-server, sql-server-2005

我的数据库中实际上有 100 个 SP。我必须在其中找到一组 10 个 SP，其中包含特定的注释。是否有任何搜索查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T10:47:51.037

找到[这篇](http://www.knowdotnet.com/articles/storedprocfinds.html)文章，如果您使用 SQL Server，它完全符合您的要求

我肯定会保留这段代码的副本供我自己使用:)

此外，它不仅适用于评论，而且似乎适用于 SP 中的所有文本。

**编辑**

为简单起见，我包含了代码的副本，但所有功劳归于 Les Smith

```
CREATE PROCEDURE Find_Text_In_SP
@StringToSearch varchar(100) 
AS 
   SET @StringToSearch = '%' +@StringToSearch + '%'
   SELECT Distinct SO.Name
   FROM sysobjects SO (NOLOCK)
   INNER JOIN syscomments SC (NOLOCK) on SO.Id = SC.ID
   AND SO.Type = 'P'
   AND SC.Text LIKE @stringtosearch
   ORDER BY SO.Name
GO 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T11:53:52.640

请注意，如果字符串搜索跨越 syscomments 中记录的边界，则 syscomments 搜索方法将失败。

要达到 100%，我想您必须将 Sprocs 脚本从数据库中删除

建议考虑将每个 Sproc 存储在单独的文件中（并存储在修订控制存储库等中），而不仅仅是在数据库中就地更改它们 - 然后您可以使用您最喜欢的编辑器进行“查找”（和“替换”如果合适的话）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T10:48:26.027

select OBJECT_NAME(id), * from syscomments WHERE text LIKE 'WhateverYouAreSearchingFor'

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T10:51:02.200

我不确定这是否是最好的解决方案，但以下应该可以工作（尽管它可能很慢）：

1.  在 SQL Server Management Studio 中打开数据库。
2.  在对象资源管理器中，右键单击数据库，任务 > 生成脚本。
3.  单击下一步按钮 3 次，直到进入选择对象类型步骤。
4.  检查存储过程，然后单击下一步。
5.  单击全选以选择所有 sp，或者如果您可以以某种方式限制 sp，请仅选择要搜索的那些。
6.  单击完成，然后再次完成。
7.  单击关闭。
8.  您现在应该已经编写了所有 sp 的脚本，因此您可以搜索它们。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-05-05T09:49:42.373

在另一个 SO 问题中找到了这个，归功于原始回答者[gbn](https://stackoverflow.com/questions/3613447/how-to-search-content-of-a-routine-sp-trigger-function/3643666#3643666)

```
SELECT 
    OBJECT_NAME(object_id)
FROM
    sys.sql_modules
WHERE
    definition LIKE '%' + 'WhatIWant' + '%' 
```

它适用于大于 4k 的物体

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T10:47:54.047

我不记得确切的表名称，但它会是这样的。试试看。

```
SELECT sysobjects.name 
FROM syscomments, sysobjects 
WHERE syscomments.id=sysobjects.id
WHERE syscomments.TEXT LIKE ‘%particular comment%’ 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T10:48:47.447

您可以为此使用 information_schema：

```
select *
from information_schema.routines
where routine_definition like '%your comment to find%' 
```

请记住，这只查看前 4096 个字符（我相信......） - 要搜索更多字符，您必须直接查询底层系统表。查看 information_schema.routines 视图的定义以查看它正在查询哪些系统表

编辑：如果您需要查询超过 4096 个字符，@Rich 的答案就是您需要的

# c++ - 如何抛出好的异常？

> ID：556255
> 
> 赞同：13
> 
> 时间：2009-02-17T10:39:25.503
> 
> 标签：c++, exception-handling, throw

我听说你永远不应该抛出一个字符串，因为缺少信息，你会捕捉到你不希望捕捉到的异常。抛出异常的好习惯是什么？你继承一个基异常类吗？你有很多例外还是少数？你做 MyExceptionClass& 还是 const MyExceptionClass& ？等等。我也知道在析构函数中永远不应该抛出异常

我会补充一点，我了解合同设计以及何时抛出异常。我在问我应该如何抛出异常。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-17T11:22:18.943

在我看来，如果一个函数不能遵守它的“承诺”，如果它必须打破它的“合同”，它应该抛出一个异常。函数的签名（名称和参数）决定了它的合约。

给定这两个成员函数：

```
const Apple* FindApple(const wchar_t* name) const;
const Apple& GetApple(const wchar_t* name) const; 
```

这些函数的名称以及它们的返回值向我表明，在**FindApple**的情况下，当找不到正确的苹果时，该函数完全能够返回 NULL，但在**GetApple**的情况下，您期望一个苹果返回. 如果第二个函数不能兑现它的承诺，它必须抛出一个异常。

异常适用于函数没有其他方式报告这些情况的异常情况。如果您决定将其作为承诺的一部分（阅读：函数签名），那么它可以报告该条件而不会引发异常。

请注意，在**FindApple**的情况下，由调用者决定如何处理“找不到合适的苹果”的情况，因为它不再是例外情况。

您可能很想尝试避免所有异常，但这意味着您必须考虑所有可能的异常情况，并且您将负担放在调用者身上。然后调用者需要检查“错误条件”。

最终，需要处理异常，但只能由**知道如何以有用的方式处理特定条件**的调用者来处理。我的意思是在最广泛的解释中：放弃的服务将在稍后重试，提供有用的错误消息的 UI，呈现“糟糕”屏幕但恢复良好的 Web 应用程序，......等等.

戴夫

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-17T10:47:52.660

一件基本的事情是只为特殊情况保留例外。不要将它们用于流量控制。例如，“找不到文件”不应该是异常，它应该是错误代码或返回值（除非文件是*必须*存在的东西，例如配置文件）。但是如果一个文件在你处理它的时候突然消失了，那么抛出一个异常是一个不错的选择。

谨慎使用异常时，您无需将代码转换为 try-catch -spaghetti 以避免从更深层接收到上下文中难以理解的异常。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T10:43:44.027

使用标准例外！如果您有特定错误，请尝试使用返回值来避免它。如果**必须**使用异常，请定义继承自 Exception 的自定义异常并创建自定义消息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T11:05:13.570

有时可能会发生您无法返回错误代码的情况，例如。当您需要错误情况发生时的确切上下文时，例如。当您需要将错误状态向上传播 3 级时 - 您会失去上下文。

在这种情况下，自定义类是最好的解决方案。我使用这种方法，定义我自己的内联类（它们没有.cpp；只有.h），例如：

```
class DeviceException {
    ;
}

class DeviceIOException: public DeviceException {
    DeviceIOException(std::string msg, int errorCode);
} 
```

等等

然后，我可以根据类型和其中包含的信息来判断/采取行动。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T11:19:54.487

我总是抛出一个异常，并给出它发生的位置以及导致它发生的原因的消息：

```
throw NException("Foo::Bar", "Mungulator cause a stack overflow!"); 
```

然后，您可以在消息框等中使用这些字符串。

我总是通过

```
catch (NException& ex) { ... } 
```

如果您运行 Windows，您可以传递错误值并让函数派生错误消息。最好的例子是[Jeffrey Richter 在 Windows 中通过 C/C++ 编写的](http://www.amazon.co.uk/Windows-via-C-Fifth-PRO-Developer/dp/0735624240/ref=sr_1_1?ie=UTF8&s=books&qid=1234869694&sr=8-1)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T11:29:27.397

抛出指针可能不是一件好事，因为它会使抛出对象的所有权复杂化。类类型异常可能比基础更好，因为它们可以包含有关异常原因的更多信息。

在使用类或类层次结构时，您应该考虑以下几点：

1.  异常对象的复制构造函数和析构函数都不能抛出异常。如果他们这样做，您的程序将立即终止。（ISO 15.5/1）

2.  如果您的异常对象具有基类，则使用公共继承。*仅当基类可访问*
    时，才会为派生到基类选择处理程序。（ISO 15.3/3）

**   最后，（对于所有异常类型）确保被抛出的表达式本身不会导致抛出异常。* 

 *例如：

```
class Ex {
public:
  Ex(int i) 
  : m_i (i)
  {
    if (i > 10) {
      throw "Exception value out of range";
    }
  }

  int m_i;
};

void foo (bool b) {
  if (! b) {
     // 'b' is false this is bad - throw an exception
     throw Ex(20);    // Ooops - throw's a string, not an Ex
  }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-18T00:38:34.253

你应该总是抛出一个从 std::exception 派生的异常类。这允许您的界面具有一定的一致性，并允许这些方法或函数的客户端具有更大的灵活性。例如，如果您想添加一个 catch all 处理程序，您可以添加一个

```
捕获（标准：：异常& e）
```

阻止并完成它。（尽管如果您不控制所有可以抛出的代码，通常您将无法摆脱这种情况）。

我倾向于只抛出标准提供的异常（即std::runtime_error），但如果你想为你的处理程序提供额外的粒度，你应该随意从std::exception派生出你自己的。请参阅[C++ FAQ 精简版](http://www.parashift.com/c++-faq-lite/exceptions.html#faq-17.6)。

此外，您应该抛出一个临时变量并通过引用捕获它（以避免在您的捕获站点调用复制 ctor）。由于不清楚谁应该清理内存，因此也不允许抛出指针。[C++ FAQ Lite](http://www.parashift.com/c++-faq-lite/exceptions.html#faq-17.8)也处理这个问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T10:52:51.477

对于当前的项目，我们考虑了主程序循环可以采取的适当行动。基本程序接受 XML 消息，并将信息保存到数据库中（中间有相当数量的处理）。

1.  指示输入错误的数据错误。适当的操作是将消息保存到日志目录但不对其进行处理。
2.  指示某些子组件（如输入队列、SQL 数据库、JNI 库）出现故障的基础设施错误。睡几分钟，然后重新连接。
3.  指示某些方面配置不可行的配置错误。退出程序。

第一项是检查异常，因为我们认为数据检查是方法接口的一部分。其他的没有检查，因为主循环不能知道子组件的实现，例如，一个实现可能使用 SQL 数据库，或者可能只是将数据保存在内存中——调用者不需要知道。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-17T11:38:39.760

正如已经说过的那样，仅将它们用于特殊情况。

始终为用户提供一种避免抛出异常的方法，例如。如果你有方法，如果出现这样的问题，它会抛出：

```
public void DoSomethingWithFile() {
    if(!File.Exists(..))
        throw new FileNotFoundException();
} 
```

提供另一种方法供用户调用：

```
public bool CanDoSomething() {
    return File.Exists(..);
} 
```

这样，调用者可以根据需要避免异常。如果出现问题，请毫不犹豫地抛出 - “快速失败”，但始终提供无异常路径。

还要保持您的异常类层次结构平坦，并查看 InvalidStateException 和 ArgumentNullExcpetion 等标准异常。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-17T13:21:03.010

如果您从其他开发人员将在下游使用的组件中抛出异常，请帮他们一个大忙，并始终从 std::exception 派生您自己的异常类（如果您真的需要它们，请参阅标准异常）。不惜一切代价避免像抛出整数、HRESULTS、char*、std::string 等完全可憎的事情......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-07-04T03:45:11.633

这是一个抛出几乎不占用任何资源的异常的简单示例：

```
class DivisionError {};
class Division
{
public:
    float Divide(float x, float y) throw(DivisionError)
    {
        float result = 0;
        if(y != 0)
            result = x/y;
        else
            throw DivisionError();
        return result;
    }
};

int main()
{
    Division d;
    try
    {
        d.Divide(10,0);
    }
    catch(DivisionError)
    {
        /*...error handling...*/
    }
} 
```

抛出的空类不占用任何资源或很少......

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-02-04T16:02:02.680

来自 C++ FAQ，[[17.12] 我应该扔什么？](http://www.parashift.com/c++-faq-lite/what-to-throw.html)：

> 一般来说，最好扔对象，而不是内置的。如果可能，您应该抛出（最终）从该类派生的类的实例`std::exception`。

...和

> 最常见的做法是抛出一个临时的：（ *参见下面的示例）*

# ruby-on-rails - 如何将 REST 与以 XML 表示的嵌套资源一起使用？

> ID：556262
> 
> 赞同：5
> 
> 时间：2009-02-17T10:41:36.293
> 
> 标签：ruby-on-rails, xml, ruby, nested

我的目标是通过一个 REST 请求创建嵌套资源。REST 请求通过 XML 文档表示。这对于单个资源来说很好，但我无法为嵌套资源管理它。好的，接下来我给你举个小例子。

首先新建一个rails项目

```
rails forrest 
```

接下来我们生成两种资源的脚手架，树木和鸟巢。

```
./script/generate scaffold tree name:string
./script/generate scaffold bird_nest tree_id:integer bird_type:string eggs_count:integer 
```

在文件 ./forrest/app/models/tree.rb 我们在下面插入“has_many”行，因为一棵树可以有很多鸟巢:-)

```
class Tree < ActiveRecord::Base
  has_many :bird_nests
end 
```

在文件 ./forrest/app/models/bird_nest.rb 中，我们在下面插入“belongs_to”行，因为每个鸟巢都应该属于一棵树。

```
class BirdNest < ActiveRecord::Base
  belongs_to :tree
end 
```

之后我们设置数据库并启动服务器：

```
rake db:create
rake db:migrate
./script/server 
```

只需将此 XML 片段复制并粘贴到名为“tree.xml”的文件中...

```
<tree>
  <name>Apple</name>
</tree> 
```

...并通过 cURL 将其发布到服务以创建新树：

```
curl  -H 'Content-type: application/xml' -H 'Accept: application/xml' -d @tree.xml http://localhost:3000/trees/ -X POST 
```

这工作正常。也为燕窝 XML（文件名“bird-nest.xml”）分开。如果我们发送这个...

```
<bird-nest>
  <tree-id>1</tree-id>
  <bird-type>Sparrow</bird-type>
  <eggs-count>2</eggs-count>
</bird-nest> 
```

...也通过以下 cURL 语句。该资源已正确创建！

```
curl  -H 'Content-type: application/xml' -H 'Accept: application/xml' -d @bird-nest.xml http://localhost:3000/bird_nests/ -X POST 
```

好的，到目前为止一切都很好。现在到了橡胶与道路相遇的地方。我们在一个请求中创建这两种资源。所以这里是包含一个鸟巢的树的 XML：

```
<tree>
  <name>Cherry</name>
  <bird-nests>
    <bird-nest>
      <bird-type>Blackbird</bird-type>
      <eggs-count>2</eggs-count>
    </bird-nest>
  </bird-nests>
</tree> 
```

我们再次使用 cURL 触发适当的请求......

```
curl  -H 'Content-type: application/xml' -H 'Accept: application/xml' -d @tree-and-bird_nest.xml http://localhost:3000/trees/ -X POST 
```

...现在我们将在树的控制器的（生成的）“创建”方法中得到一个服务器错误：**AssociationTypeMismatch (BirdNest expected, got Array)**

在我看来，这是服务器日志中关于接收到的属性和错误消息的重要部分：

```
Processing TreesController#create (for 127.0.0.1 at 2009-02-17 11:29:20) [POST]
  Session ID: 8373b8df7629332d4e251a18e844c7f9
  Parameters: {"action"=>"create", "controller"=>"trees", "tree"=>{"name"=>"Cherry", "bird_nests"=>{"bird_nest"=>{"bird_type"=>"Blackbird", "eggs_count"=>"2"}}}}
  SQL (0.000082)   SET NAMES 'utf8'
  SQL (0.000051)   SET SQL_AUTO_IS_NULL=0
  Tree Columns (0.000544)   SHOW FIELDS FROM `trees`

    ActiveRecord::AssociationTypeMismatch (BirdNest expected, got Array):
        /vendor/rails/activerecord/lib/active_record/associations/association_proxy.rb:150:in `raise_on_type_mismatch'
        /vendor/rails/activerecord/lib/active_record/associations/association_collection.rb:146:in `replace'
        /vendor/rails/activerecord/lib/active_record/associations/association_collection.rb:146:in `each'
        /vendor/rails/activerecord/lib/active_record/associations/association_collection.rb:146:in `replace'
        /vendor/rails/activerecord/lib/active_record/associations.rb:1048:in `bird_nests='
        /vendor/rails/activerecord/lib/active_record/base.rb:2117:in `send'
        /vendor/rails/activerecord/lib/active_record/base.rb:2117:in `attributes='
        /vendor/rails/activerecord/lib/active_record/base.rb:2116:in `each'
        /vendor/rails/activerecord/lib/active_record/base.rb:2116:in `attributes='
        /vendor/rails/activerecord/lib/active_record/base.rb:1926:in `initialize'
        /app/controllers/trees_controller.rb:43:in `new'
        /app/controllers/trees_controller.rb:43:in `create' 
```

所以我的问题是关于 XML 资源的嵌套我做错了什么。哪个是正确的 XML 语法？还是我必须手动修改树的控制器，因为生成的控制器没有涵盖这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-17T13:58:57.817

实现此目的的一种方法是覆盖树模型上的 bird_nests= 方法。

```
def bird_nests=(attrs_array)
  attrs_array.each do |attrs|
    bird_nests.build(attrs)
  end
end 
```

这里唯一的问题是您丢失了 setter 的默认行为，这可能是您的应用程序中的问题，也可能不是问题。

如果您正在运行更新版本的 Rails，您可以按照此处所述打开批量分配：

[http://github.com/rails/rails/commit/e0750d6a5c7f621e4ca12205137c0b135cab444a](http://github.com/rails/rails/commit/e0750d6a5c7f621e4ca12205137c0b135cab444a)

和这里：

[http://ryandaigle.com/articles/2008/7/19/what-s-new-in-edge-rails-nested-models](http://ryandaigle.com/articles/2008/7/19/what-s-new-in-edge-rails-nested-models)

```
class Tree < ActiveRecord::Base
  has_many :bird_nests, :accessible => true
end 
```

这是首选选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T22:42:09.510

覆盖树模型的**bird_nests=**方法是一个有效的解决方案，参考Patrick Richie的上一篇文章（谢谢）。因此无需对控制器进行任何更改。下面是详细的代码，它将处理上面示例中提到的给定 XML 请求（也处理非数组嵌套）：

```
 def bird_nests=(params)
    bird_nest=params[:bird_nest] 
    if !bird_nest.nil?
      if bird_nest.class==Array
        bird_nest.each do |attrs|
          bird_nests.build(attrs)
        end
      else 
        bird_nests.build(bird_nest)
      end
    end
  end 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-08-21T01:30:08.100

虽然这个问题是在两年半前提出的，但现在发生了很多变化：首先是在 Rails 2.3 中`has_many :bird_nests, :accessible => true`，现在在 Rails 3 中使用`accepts_nested_attributes_for`方法......所以这些天在 Rails 3 中，您可以使用以下代码实现上述目的：

```
class Tree < ActiveRecord::Base
  has_many :bird_nests
  accepts_nested_attributes_for :bird_nests
end

class BirdNest < ActiveRecord::Base
   belongs_to :tree
end 
```

这会为 Tree 对象生成bird_nests_attributes 访问器（getter/setter）。所以 xml 如下所示：

```
<tree>
  <name>Cherry</name>
  <bird_nests_attributes type='array'>
      <bird_nest>
          <bird-type>Blackbird</bird-type>
          <eggs-count>2</eggs-count>
      </bird_nest>
      <bird_nest>
          <bird-type>Bluebird</bird-type>
          <eggs-count>3</eggs-count>
      </bird_nest>
  </bird_nests_attributes>
</tree> 
```

Rails 会将上述 XML 转换为适当的 params 哈希...并且将使用以下语句创建具有关联的 bird_nests 对象的 Tree 对象

```
@tree = Tree.new(params[:tree])
@tree.save 
```

这是使其工作的最少代码。如果您`attr_accessible`在您的模型上使用，您必须始终使用它，然后不要忘记添加`:bird_nests_attributes`到`attr_accessible`列表中，如下所示：

```
attr_accessible :a_tree_attribute, :another_tree_attr, :bird_nests_attributes 
```

同样，您可以将属性验证添加到它们各自的模型中。如果验证失败嵌套属性错误也将在`@tree.errors`列表中可用。希望这会帮助其他在 google 中搜索相同问题的人，并且这个过时的帖子是最高结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T13:33:24.650

默认控制器将有一行

```
@tree = Tree.new(params[:tree]) 
```

它显然不会自动解析您发送的参数。您需要更改控制器以分离参数 hashf，创建并保存树，然后使用树的 ID（在保存后才会创建）创建巢，然后保存树。

清如泥？

# c# - 关于使用 XML 作为存储过程参数和返回类型的意见

> ID：556265
> 
> 赞同：3
> 
> 时间：2009-02-17T10:42:25.747
> 
> 标签：c#, xml, performance, stored-procedures

这对我来说是新的。我有一个新老板在工作，他坚持我们从现在开始执行的每个查询都是带有 XML 序列化参数和返回类型的存储过程。

我还没有运行任何测试，但这让我觉得有点矫枉过正，并且在很多方面都可能成为性能杀手。你的经验是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T10:46:32.180

尽管它是一个明显的性能杀手（想象一下解析从存储过程返回的几兆 XML），但它更是生产力、可伸缩性和可维护性的杀手。在 T-SQL 中使用 XML 并非完全没有痛苦，也不是无缝的。支持将是一场噩梦：想象在结果集中添加一个列，这将导致序列化和反序列化代码的大量修改。

另外，您将不能使用 ORM 工具，也不能使用简单的结果集映射器（iBATIS 或 BLToolkit）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T10:47:24.517

它*可能*允许您一定程度的向后和向前兼容性（因为 proc 可以开始理解额外的参数） - 但我想说全面应用它在几乎所有方面都是荒谬的。

我建议你请你的老板给出他认为这是个好主意的技术原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-17T11:57:33.960

嘿，让我们使用可扩展性最低的组件，让它做密集的 CPU 工作；-p

好吧，那是在开玩笑。Xml 作为参数和返回值在结构化数据的一些*特定*情况下使用，但一般来说，平面 TDS 流（即网格）效率更高。对于输入，CSV（通过 udf 拆分）或表值参数（SQL 2008）都是不错的选择。

2005+ 中的 Sql/xml 比使用 openxml 好得多 - 事实上，一旦 xml 在服务器中存储和索引（使用`xml`数据类型），它非常有效 - 但作为输入和输出，如果你不是，它可能是一个瓶颈。小心。

不要将其设为默认值，而是将其视为可用选项之一。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T11:28:10.987

不久前我也遇到过同样的情况，除了性能开销之外，我们在这种方法中遇到了一些非常讨厌的错误。在 Xml 文档中添加/删除/重命名标签真的很容易，当你这样做时，除非你的 SProc 保持最新，否则你会在数据库中发现不寻常的数据。我的建议是避免这种方法 - 只是不要这样做......

顺便说一句，你的老板是 AO 的吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T10:52:40.387

这是使用单个参数的一种非常简单（阅读：混乱）的方法，这可能会使引用存储过程调用的代码看起来更简洁。

**对于新老板来说，坚持**代码审查和标准化是一个非常坚定的立场。常见的编码实践在团队中是好事，但令我震惊的是，您可以通过在各处传递 XML 来隐藏一些非常糟糕的小问题。是的，它可能会使响应看起来更笼统，但是如果您计划将 XML 交给另一个进程，将其包装在一个层中，这不是更好吗：您可以将数据访问层紧密绑定到存储的程序，然后从那里显式构建 XML，获得类型检查、TDD 和辅助的好东西。

听起来有人刚刚读到您***可以***做到并认为“XML 很好，对吗？” 无需考虑是否***应该***这样做。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T12:04:06.627

有趣的。在 SQL 中解析字符串并非易事。. xml 会实现什么？（当然不是松耦合，因为数据库和应用层的解耦已经通过存储过程实现）

我相信您编写了两个存储过程，它们执行相同的操作，但一个以普通方式编写，一个以 xml 编写。希望您的老板能够“看到”并接听明显的电话。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-17T13:36:16.453

我以前说过，我再说一遍：*没有灵丹妙药。*

使用 XML 作为存储过程的输入和输出是一个灵丹妙药的解决方案，它只证明了一件事：在一个实例中可能是一个好的选择的一个解决方案在许多（可能是绝大多数）其他实例中是非常不合适的.

如果愿意，可以考虑一个不带参数并返回单个标量值的存储过程。在这种情况下，XML 显然是多余的。

还要考虑一个存储过程，在该存储过程中传递一个日期范围（两个单一日期值）并从一组连接表中返回该范围内的所有行。将日期封装在 XML 中可能并不过分，但封装您将返回的可变数量的数据可能是。你可以取回零行。你可以取回数千个。

考虑从存储过程返回的数据类型取决于传递给它的参数的类型和值的情况。此外，由于行集的性质相当不稳定，这些行集中的一个或多个可能会在未来发生变化，从而需要更改编码。最后，您有一个可能适用于 XML 的解决方案。

那么，您是否应该惩罚整个代码库，因为它们中的一小部分存在可变性问题？或者您是否应该设计一个解决方案，将这些易失性数据集封装在一个设计合理的外观后面，以保护系统的其余部分免受这种易失性的影响？

您基本上会发现 XML Everywhere 的灵丹妙药不是灵丹妙药，而是核弹头。当您想要一个可以打击单个目标并解决您的问题的解决方案时，您最终会得到的东西会摧毁眼前的一切，因为您将带来比您合理处理的更多的火力来解决问题。然后，通常情况下，武器会摧毁那些试图使用它的人。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-27T17:57:39.160

需要在客户端（浏览器）和服务器执行的网站程序之间传输数据字符串消息。然而，这些消息字符串应该具有简单的结构规则，能够将其信息快速解析为命名参数和参数字段组件。XML 是作为一种智力练习而创建的，以某种方式描述一个充满 HTML 对象的页面的复杂对象关系和属性。对于教授理论家来说，XML 是一种非常迂腐深奥的练习，但作为大多数网站通信的实用工具，它却是个笑话。

# python - ImportError：没有名为 copy_reg pickle 的模块

> ID：556269
> 
> 赞同：22
> 
> 时间：2009-02-17T10:42:58.740
> 
> 标签：python, pickle

我正在尝试取消在 MySQL 数据库中存储为 blob 的对象。我已经手动生成了腌制对象并将其存储在数据库中，但是当我尝试取消腌制对象时，我得到以下相当神秘的异常：

ImportError：没有名为 copy_reg 的模块

关于为什么会发生这种情况的任何想法？

**繁殖方法**

注意：必须在 Windows PC 上执行步骤 1，在 Linux PC 上执行步骤 3 和 4。

1) 在 Windows 电脑上：

```
file = open("test.txt", "w")
thing = {'a': 1, 'b':2}
cPickle.dump(thing, file) 
```

2) 手动将 text.txt 的内容插入到运行在 linux 上的 MySQL 数据库的 blob 字段中

3）在Linux机器上运行的Python中，从MySQL获取列的内容

4）假设您将 blob 列的内容放入一个名为 data 的变量中，试试这个：

```
cPickle.loads(rawString) 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-02-17T10:52:36.110

看来这可能是由我导出腌制对象的方法引起的。

[这个错误报告](http://www.archivum.info/python-bugs-list@python.org/2007-04/msg00222.html "类似性质的Bug报告")表明我的问题可以通过导出到以二进制模式写入的文件来解决。我现在要试一试，看看这是否能解决我的问题。

更新：这有效。解决方案是确保将腌制对象导出到以二进制模式打开的文件中，即使您使用的是默认协议 0（通常称为“文本”）

基于有问题的原始示例的正确代码：

```
file = open("test.txt", 'wb')
thing = {'a': 1, 'b':2}
cPickle.dump(thing, file) 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-17T13:50:01.900

此外，只需在（windows-created）pickle 文件上运行 dos2unix（在 linux 下）为我解决了这个问题。（还没有尝试过打开模式“wb”的东西。）丹

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-08-07T14:42:46.120

只是一个交互式 python 会话来表明你不需要任何特定的代码来解决这个问题：

在 Windows 机器上做这样的事情

```
Python 2.4.1 (#65, Mar 30 2005, 09:13:57) [MSC v.1310 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> import pickle, re
>>> empty_string = re.compile("^$")
>>> pickle.dump([empty_string,1,1.23,'abc'], file('m:/mario/test-b.dump','wb'))
>>> pickle.dump([empty_string,1,1.23,'abc'], file('m:/mario/test-t.dump','wt'))
>>> 
```

然后尝试从 linux 机器中检索数据

```
Python 2.6.2 (release26-maint, Apr 19 2009, 01:56:41) 
[GCC 4.3.3] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import pickle
>>> pickle.load(file('/home/mario/.gvfs/transfer on 192.168.0.4/mario/test-b.dump'))
/usr/lib/python2.6/pickle.py:1124: DeprecationWarning: The sre module is deprecated, please import re.
  __import__(module)
[<_sre.SRE_Pattern object at 0xb7d42420>, 1, 1.23, 'abc']
>>> pickle.load(file('/home/mario/.gvfs/transfer on 192.168.0.4/mario/test-t.dump'))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python2.6/pickle.py", line 1370, in load
    return Unpickler(file).load()
  File "/usr/lib/python2.6/pickle.py", line 858, in load
    dispatch[key](self)
  File "/usr/lib/python2.6/pickle.py", line 1090, in load_global
    klass = self.find_class(module, name)
  File "/usr/lib/python2.6/pickle.py", line 1124, in find_class
    __import__(module)
ImportError: No module named sre
>>> 
```

如果您只是腌制基本类型，则错误消息可能会更加令人困惑。这是我从列表中得到的`[12, 1.2, '']`：

```
ValueError: insecure string pickle 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-30T10:47:23.590

如另一个答案中所述，使用

```
dos2unix originalPickle.file outputPickle.file 
```

或者使用下面的 tr 命令（删除回车和 ctrl-z）

```
 tr -d '\15\32' < originalPickle.file > outputPickle.file 
```

或者使用`awk`（`gawk`或者`nawk`如果它的旧版本）

```
 awk '{ sub("\r$", ""); print }' originalPickle.file > outputPickle.file 
```

或者，如果您可以在 linux 中重新创建一个 pickle 文件，请使用它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-10-19T02:09:30.913

这里发生的另一件事是，在将泡菜倾倒到文件后，您似乎没有关闭文件。此处报告的错误有时可能是由不关闭文件引起的（无论是在 Windows 机器上还是在其他情况下）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-08-28T02:40:28.860

我的问题：</p>

```
with open('model.pkl', 'rb') as f:
    subsection_struct_model = pickle.load(f) 
```

当我从 Windows 获取 model.pkl 在我的 Mac 中运行此代码时，此问题即将出现

解决：

```
dos2unix model.pkl 
```

没关系！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-12-27T09:01:40.610

这是因为在Windows中，换行符存储为“\r\n”，而在Linux中为“\n”，所以你应该做的是逐行读取pickle文件，替换“\r\n " 与 "\n"，并将其写回文件。

**与 dos2unix 方法将跳过二进制文件不同，这也适用于二进制 pickle 文件。**

代码很简单：

```
#run this code on Linux platform

DIR="your/dir/to/file"

pickle.load(open(DIR,"rb"))
# ImportError: No module named copy_reg pickle

a=open(DIR,"rb").readlines() #read pickle file line by line

a=map(lambda x:x.replace("\r\n","\n"),a) # replace \r\n with \n

with open(DIR,"wb") as j: #write back to file in binary mode
    for i in a:
        j.write(i)         
pickle.load(open(DIR,"rb")) 
#Now it works well 
```

此外，您可以使用普通写入模式，只需将“wb”更改为“w”，将“rb”更改为“e”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-25T09:24:53.193

我遇到了这个问题，因为 git 改变了 windows 上的行尾。

`.gitattributes`我通过向我的仓库添加一个文件解决了这个问题：

```
# Pickle files (for testing) should always have UNIX line endings. 
*.pkl text eol=lf 
```

另请参阅[https://github.com/actions/checkout/issues/135](https://github.com/actions/checkout/issues/135)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-02-16T17:55:58.687

泡菜负载可能与您的 python 脚本不在同一位置。有时目录会根据您的应用程序而更改。就在你加载泡菜之前，打印一个 os.getcwd() 来制定一个解决方案。

# c++ - 从字符串中修剪/删除制表符 ( "\t" )

> ID：556277
> 
> 赞同：10
> 
> 时间：2009-02-17T10:47:35.280
> 
> 标签：c++, string, tabs

谁能建议一种从字符串中删除制表符（“\t”s）的方法？CString 或 std::string。

例如“1E10”变成“1E10”。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-02-17T11:06:06.937

如果要删除字符串中的所有出现，则可以使用[擦除/删除](http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Erase-Remove)习语：

```
#include <algorithm>

s.erase(std::remove(s.begin(), s.end(), '\t'), s.end()); 
```

如果您只想删除字符串开头和结尾的制表符，您可以使用[boost 字符串算法](http://www.boost.org/doc/libs/1_38_0/doc/html/string_algo.html)：

```
#include <boost/algorithm/string.hpp>

boost::trim(s); // removes all leading and trailing white spaces
boost::trim_if(s, boost::is_any_of("\t")); // removes only tabs 
```

如果使用 Boost 开销太大，您可以使用`find_first_not_of`和`find_last_not_of`字符串方法滚动您自己的修剪函数。

```
std::string::size_type begin = s.find_first_not_of("\t");
std::string::size_type end   = s.find_last_not_of("\t");

std::string trimmed = s.substr(begin, end-begin + 1); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-17T11:10:16.943

[hackingwords 的回答](https://stackoverflow.com/questions/556277/trim-remove-a-tab-t-from-a-string/556293#556293)让你成功了一半。但[`std::remove()`](http://en.cppreference.com/w/cpp/algorithm/remove)from`<algorithm>`实际上并没有使字符串更短——它只是返回一个迭代器，说“新序列将在此处结束”。你需要打电话[`my_string().erase()`](http://en.cppreference.com/w/cpp/string/basic_string/erase)来做到这一点：

```
#include <string>
#include <algorithm>    // For std::remove()

my_str.erase(std::remove(my_str.begin(), my_str.end(), '\t'), my_str.end()); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-17T11:05:16.767

该[`remove`](http://www.cppreference.com/wiki/stl/algorithm/remove)算法将所有不被删除的字符转移到开头，覆盖已删除的字符，但它不会修改容器的长度（因为它适用于迭代器并且不知道底层容器）。为此，请致电[`erase`](http://www.cppreference.com/wiki/string/erase)：

```
str.erase(remove(str.begin(), str.end(), '\t'), str.end()); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T11:31:43.863

由于其他人已经回答了如何使用 std::string 执行此操作，因此您可以将以下内容用于 CString：

```
myString.TrimRight( '\t' ); // trims tabs from end of string
myString.Trim( '\t' ); // trims tabs from beginning and end of string 
```

如果您想摆脱所有制表符，即使是字符串内的制表符，请使用

```
myString.Replace( _T("\t"), _T("") ); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-17T10:49:00.770

扫描字符串并删除所有发现的事件。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-17T11:11:38.517

HackingWords 即将到来：将擦除与删除结合使用。

```
std::string my_string = "this\tis\ta\ttabbed\tstring";
my_string.erase( std::remove( my_string.begin(), my_string.end(), '\t'), my_string.end()); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-17T10:55:08.023

CString 替换？

> 替换('\t', '')

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T10:52:21.183

第一个想法是使用[remove](http://www.cplusplus.com/reference/algorithm/remove.html)

```
remove(myString.begin(), myString.end(), "\t"); 
```

尽管如果该比较不起作用，您可能不得不使用 remove_if 。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-12-15T06:26:57.717

我想知道为什么没有人以这种方式修剪字符串：

```
void trim (string& s)  {
    string t = "";
    int i = 0;
    while(s[i] == ' ') i++;
    while(s[i] == '\t') i++;
    for(i; i < s.length(); i++)
        t += s[i];

    s = t;
} 
```

# vbscript - 如何检查 wscript/cscript 是否在 x64 主机操作系统上运行？

> ID：556283
> 
> 赞同：5
> 
> 时间：2009-02-17T10:48:45.013
> 
> 标签：vbscript, registry, 64-bit, wsh

我正在运行一个可以在 x64 Windows 下运行的 VBScript。我需要从注册表的 32 位部分读取注册表项。为此，我使用 path`HKLM\Software\Wow6432Node\xyz`而不是`HKLM\Software\xyz`. 如何检查脚本是否在 x64 下执行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-10-14T04:57:45.683

即使在 64 位版本的 Windows 上，您的脚本也可以在 32 位模式下执行。

您可以使用以下代码来确定实位模式，您的脚本运行在：

```
option explicit

function Determine64BitMode
    dim Shell, Is64BitOs
    set Shell = CreateObject("WScript.Shell")
    on error resume next
    Shell.RegRead "HKLM\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir (x86)"
    Is64BitOs = Err.Number = 0
    on error goto 0
    if Is64BitOs then
        Determine64BitMode = InStr(Shell.RegRead("HKLM\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir"), "(x86)") = 0
    else
        Determine64BitMode = false
    end if
end function

dim ExecutingIn64BitMode
ExecutingIn64BitMode = Determine64BitMode
if ExecutingIn64BitMode then
    MsgBox "64 bit"
else
    MsgBox "32 bit"
end if 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T17:57:28.663

我不确定您是否需要检查脚本是否在 x64 下执行。

尝试从 读取`HKLM\Software\Wow6432Node\xyz`，如果失败，请尝试从 读取`HKLM\Software\xyz`，如果失败，您的注册表项不存在，请采取任何适当的操作。

当然，如果您的设计更复杂（例如，如果该注册表项不存在，则将值写入该注册表项），那么该建议将不起作用。

这是用于检查操作系统的 VBScript。您可能还需要解释[Win32_OperatingSystem 类中可用的属性](http://msdn.microsoft.com/en-us/library/aa394239(VS.85).aspx)

```
strComputer = "."
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")        

Set colOperatingSystems = objWMIService.ExecQuery _
    ("Select * from Win32_OperatingSystem")

For Each objOperatingSystem in colOperatingSystems
    msg = objOperatingSystem.Caption & " " & _
            objOperatingSystem.Version & " " & _
                objOperatingSystem.OSArchitecture
    msgbox msg
Next 
```

请注意，对于 Windows XP 和 2003，`OSArchitecture`不可用，在这种情况下，您可能必须检查`Caption`或`Version`确定您的操作系统是否为 64 位。

您也可以根据所需的复杂程度使用类似[的东西。](http://blogs.msdn.com/garretts/archive/2006/08/04/688788.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T19:17:13.447

这是基于 Microsoft 知识库文章[How To Check If Computer Is Running A 32 Bit or 64 Bit Operating System](http://support.microsoft.com/kb/556009)的解决方案：

```
Function Is64BitOS()
    Is64BitOS = Not(Is32BitOS())
End Function

Function Is32BitOS()
    Const sRegKey = "HKLM\HARDWARE\DESCRIPTION\System\CentralProcessor\0"
    Const sIdentifierValue = "Identifier"
    Const sPlatformIDValue = "Platform ID"

    Dim oSh : Set oSh = CreateObject("WScript.Shell")
    Dim sIdentifier, nPlatformID

    sIdentifier = oSh.RegRead(sRegKey & "\" & sIdentifierValue)
    nPlatformID = oSh.RegRead(sRegKey & "\" & sPlatformIDValue)

    Set oSh = Nothing

    If InStr(sIdentifier, "x86") > 0 And nPlatformID = 32 Then
        Is32BitOS = True
    Else
        Is32BitOS = False
    End if
End Function 
```

**替代解决方案**

可以在[此处找到使用](https://stackoverflow.com/a/13979562/1497596)**WMI**的替代且更简洁的解决方案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-07-09T16:31:41.633

您没有提到您使用什么 API 从注册表中读取。例如，如果您使用 WMI[`StdRegProv`](http://msdn.microsoft.com/en-us/library/aa393664.aspx)类，则可以使用该`__ProviderArchitecture`标志来请求访问 32 位注册表配置单元，而不管脚本是在 32 位还是 64 位 Windows 脚本主机下运行。此技术在 MSDN 中[的在 64 位平台上请求 WMI 数据一文中进行了描述。](http://msdn.microsoft.com/en-us/library/aa393067.aspx)

这是从 32 位注册表读取的示例：

```
strComputer = "."
Const HKLM = &h80000002

''# Specify the required registry bitness
Set oCtx = CreateObject("WbemScripting.SWbemNamedValueSet")
oCtx.Add "__ProviderArchitecture", 32
oCtx.Add "__RequiredArchitecture", True

''# Load the 32-bit registry provider
Set oLocator = CreateObject("WbemScripting.SWbemLocator")
Set oWMI = oLocator.ConnectServer(strComputer, "root\default",,,,,, oCtx)
Set oReg = oWMI.Get("StdRegProv") 

''# Specify input parameters for the GetStringValue method call
Set oInParams = oReg.Methods_("GetStringValue").InParameters
oInParams.hDefKey     = HKLM
oInParams.sSubKeyName = "Software\xyz"
oInParams.sValueName  = "foobar"

''# Read a string value from the registry
Set oOutParams = oReg.ExecMethod_("GetStringValue", oInParams,, oCtx)
WScript.Echo oOutParams.sValue 
```

另请注意，在这种情况下，应以通常的方式指定 32 位密钥名称，`HKLM\Software\xyz`而不是`HKLM\Software\Wow6432Node\xyz`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-06-04T10:34:56.100

这显示了系统和进程架构：

```
Option Explicit
Dim WshShell, WshEnv
Set WshShell = WScript.CreateObject("WScript.Shell")
Set WshEnv = WshShell.Environment("System")
MsgBox "System: " & WshEnv("PROCESSOR_ARCHITECTURE")
Set WshEnv = WshShell.Environment("Process")
MsgBox "Process: " & WshEnv("PROCESSOR_ARCHITECTURE") 
```

只需检查您需要的那个`<> "x86"`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-08-27T12:08:28.057

一个非常简单的解决方案是检查（虚拟）文件夹是否`C:\Windows\sysnative`存在。此文件夹仅存在于 32 位进程中，请参阅[文件系统重定向器](https://docs.microsoft.com/en-us/windows/desktop/WinProg64/file-system-redirector)

```
Set fso = CreateObject("Scripting.FileSystemObject")
Set wshShell = CreateObject( "WScript.Shell" )

If fso.FolderExists(wshShell.ExpandEnvironmentStrings("%windir%") & "\sysnative" ) Then
    WScript.Echo "You are running in 32-Bit Mode"
Else
    WScript.Echo "You are running in 64-Bit Mode"
End if 
```

请注意，仅适用于 Windows Server 2003 和 Windows XP 或更高版本。

# html - 我如何（默认情况下）以不同的方式设置不同类型的标签？

> ID：556288
> 
> 赞同：0
> 
> 时间：2009-02-17T10:49:48.800
> 
> 标签：html, css, forms, format

在我的表单中，我想让 HTML 标签一般加粗，但在标记单选按钮和复选框时不要加粗。

如何在默认情况下可以导入和工作的 CSS 中做到这一点，而不需要对样式进行本地覆盖？

单选标签示例（不应为粗体）

```
<label for="banana">
<input type="radio" name="banana" id="banana" value="banana" />Banana
</label> 
```

示例非无线电标签（应为**粗体**）

```
<label for="id">ID</label>
<input type="text" size="12" id="id" name="id" /> 
```

如果有帮助，可以更改我关联标签的方式。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T10:55:35.153

如果不给正确的标签一个类或使用 Javascript，你就无法做到这一点。使用 jQuery 选择器，您可以这样做：

```
$("label:not(:has(radio))").addClass("boldmenow");
...
.boldmenow {
  font-weight: bold;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T11:03:31.700

如果将标记扩展到以下内容：

```
<label for="banana">
    <input type="radio" name="banana" id="banana" value="banana" /><span>Banana</span>
</label> 
```

然后你可以使用这个 CSS：

```
label {
    font-weight: bold;
}
label span {
    font-weight: normal;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T12:06:11.753

简短的回答是你不能，可靠。如果您试图使其在许多常用浏览器（例如 IE6、7、Firefox 等）中工作，则必须依靠 JavaScript 而不是 CSS 来识别文档中符合您的样式规则的元素并应用对这些元素中的每一个进行分类。

为了跨浏览器兼容性，您需要将数组字段标签包装在分类元素中，或者将类应用于标签以将它们与普通标签分开。

我在这里要做的是将单选选项列表包装在**一个****（**无）有序列表（用于语义）中，并将普通文本字段包装在一个段落中。

 **例如正常名称：值对：

```
<div class="form_row">
  <label for="txtFirstName">First Name</label>
  <p>
    <input type="text" class="text" name="firstName" id="txtFirstName" />
  </p>
</div> 
```

然后对于 Name:Array 对：

```
<div class="form_row">
  <label>Gender</label>
  <ul>
    <li><label for="rdoGenderMale"><input type="radio" class="radio" name="gender" id="rdoGenderMale" value="male" />&nbsp;Male</label></li>
    <li><label for="rdoGenderFemale"><input type="radio" class="radio" name="gender" id="rdoGenderFemale" value="female" />&nbsp;Female</label></li>
  </ul>
</div> 
```

现在要适当地设置它的样式，您可以为名称标签编写常规规则：

```
div.form_row label {font-weight:bold;}
div.form_row ul {list-style:none;}
  div.form_row ul label {font-weight:normal;} 
```

hth，恩多芬

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T10:53:10.993

您可以为单选按钮的标签添加一个类，然后对它们进行不同的样式设置。

```
<label for="banana" class="radio"> 
```

然后CSS可以默认使标签加粗，然后覆盖它以使收音机正常。

```
label { font-weight: bold }
label.radio { font-weight: normal; } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T10:57:47.783

基本上，你不能因为 IE 不支持它（所以改用一个类），但如果 IE 工作正常并且 CSS3 得到很好的支持，你可以使用像这样的通用兄弟选择器：

```
input[type="radio"]~label {font-weight: bold;} 
```

请注意，IE 也不真正支持那里的属性选择器。

# sql - SQL“分组依据”问题 - 我无法选择每一列

> ID：556300
> 
> 赞同：0
> 
> 时间：2009-02-17T10:54:13.923
> 
> 标签：sql, group-by

我有一个数据库，其中每一行都有一个 id、一个 URL 和一个 XML。ID 是唯一的，但 URL 列可以有重复项。我需要所有没有重复的 URL，并且对于每个 URL，我都需要 id 和 XML。

如果我只询问 URL 和 ID，我使用以下查询：

```
select URL, max(ID) as ID from T1 group by URL 
```

一切都很好。

但是当我还想要 XML 时，我使用以下查询：

```
select URL, max(ID) as ID, XML from T1 group by URL 
```

我收到以下错误：

```
ISC ERROR CODE:335544569
ISC ERROR MESSAGE:
Dynamic SQL Error
SQL error code = -104
user name required 
```

我究竟做错了什么？

谢谢，

迪克拉

感谢您的回答。我想添加一个解释：
如果 URL 重复，我不在乎会返回哪个。但我需要让它们没有重复，即使行之间的 XML 不同。是否可以？
谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T11:07:09.663

```
select id, url, xml
from table1
where id in (
    select min(id)
    from table1
    group by url) 
```

会给你删除重复网址的行（并且只包括重复网址的第一个实例）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T11:00:35.093

你需要重新阅读你的问题并思考它。

您要求提供 URL（可以是重复的），但您不希望重复，并且您还需要 ID（不重复）。样本数据：

```
1,http://www.google.com
2,http://www.yahoo.com
3,http://www.google.com 
```

在这种情况下，您到底想返回什么，请记住 Google 有多个 ID？

XML 也是如此。如果它对于给定的 URL 不是唯一的，您需要指定如何仅获取每个 URL 的一个条目，这就是您的查询不起作用的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T10:57:28.643

您没有对列 XML 执行聚合函数，您必须将其包含在您的分组依据中。

请记住，如果每一行的数据都不同，则实际上无法对其进行分组，并且您将无法获得所需的结果，尽管它们都是您向数据库询问的结果:)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T11:46:19.757

```
select urlMaxId.id, urlMaxId.url, table1.html from (select url, max(id) id from table1 group by url) urlMaxId inner join table1 on urlMaxId.id = table1.id 
```

# .net - 如何在 Visual Studio 之外启动 WCF 服务？

> ID：556305
> 
> 赞同：4
> 
> 时间：2009-02-17T10:57:36.833
> 
> 标签：.net, wcf

[我刚刚使用此 MSDN 教程](http://msdn.microsoft.com/en-us/library/ms734712.aspx)创建了 WCF 服务。

*   在 Visual Studio 中，我可以 CTRL-F5 服务，以便它运行
*   然后我可以启动我的控制台应用程序客户端并使用该服务没问题

现在我想在 Visual Studio 之外启动我的服务并让各种客户使用它。

但是当我去命令行并执行这个文件../bin/Debug/testService.exe时，我得到一个异常：“**输入格式错误**”。

当我发布服务并启动发布的 .exe 文件时，我得到了同样的错误。

我在这里想念什么？我是否需要发送 Visual Studio 发送的某种参数以使其运行？

如何在 Visual Studio 外部运行我的 WCF 服务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T11:14:11.007

如果没有看到您的代码和配置文件，很难弄清楚为什么会出现此问题，但正确设置 WCF 服务一开始可能会有些棘手。

我建议查看[WCF 上的 endpoint.TV 截屏视频](http://channel9.msdn.com/tags/WCF+endpoint+screencasts/)，尤其是[自托管 WCF 服务](http://channel9.msdn.com/shows/Endpoint/Endpoint-Screencasts-Self-hosting-WCF-Services/)截屏视频。

它们很容易理解，并且会解释得足以让您入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T22:24:05.620

对我来说，向某人展示如何启动和运行 WCF 应用程序以便您学习的最简单方法是手动创建它，避开 VS2008 内置工具。这是一个很好的教程，告诉你该怎么做：

[WCF 手动方式 - 正确的方式](http://www.devx.com/codemag/Article/39837)

我在我的博客文章中写了一篇扩展该文章的文章。我包括源​​文件以及截屏视频。你可以在这里找到它：

[手动 WCF - 扩展](http://www.tadsharp.net/?p=9)

此外，可以在 Michele Bustamante 的[Learning WCF](http://oreilly.com/catalog/9780596101626/index.html)中找到一系列优秀的教程。它有点过时，专注于 .NET 3.0，但大多数示例仍然有效，她在博客上更新了她的源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-20T17:56:27.537

```
Uri baseAddress = new Uri("http://localhost:8080/hello");

// Create the ServiceHost.
using (ServiceHost host = new ServiceHost(typeof(HelloWorldService), baseAddress))
{
    // Enable metadata publishing.
    ServiceMetadataBehavior smb = new ServiceMetadataBehavior();
    smb.HttpGetEnabled = true;
    smb.MetadataExporter.PolicyVersion = PolicyVersion.Policy15;
    host.Description.Behaviors.Add(smb);

    // Open the ServiceHost to start listening for messages. Since
    // no endpoints are explicitly configured, the runtime will create
    // one endpoint per base address for each service contract implemented
    // by the service.
    host.Open();

    Console.WriteLine("The service is ready at {0}", baseAddress);
    Console.WriteLine("Press <Enter> to stop the service.");
    Console.ReadLine();

    // Close the ServiceHost.
    host.Close();
} 
```

[http://msdn.microsoft.com/en-us/library/ms731758%28v=vs.110%29.aspx](http://msdn.microsoft.com/en-us/library/ms731758%28v=vs.110%29.aspx)

# c++ - 如何通过 SWIG 在 C++ 中嵌入 lua

> ID：556309
> 
> 赞同：4
> 
> 时间：2009-02-17T10:59:50.743
> 
> 标签：c++, lua, swig

目前，我为我的课程提供了一组 SWIG 包装器，并且它们都可以构建。我可以创建一个 lua 虚拟机并加载我的包装器，但那时我很困惑。谷歌搜索告诉我如何在 swig 中将 c++ 放入 lua 中，但不告诉我如何将 lua 放入 c++ 中。

我真正想做的就是设法实例化一个lua对象并将它传递给我的主游戏引擎对象指针，从那里我可以管理

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T16:16:33.117

看看 Programming in Lua 这本书，它有一个关于[Lua C API](http://www.lua.org/manual/5.1/manual.html#lua_pcall)的部分。

调用 Lua 函数使用[lua_pcall](http://www.lua.org/manual/5.1/manual.html#lua_pcall)，它相当于[lua_call](http://www.lua.org/manual/5.1/manual.html#lua_call)（有一个简短的例子），除了它会捕获 Lua 运行时错误。

您必须已经加载并运行过一次脚本（使用例如[luaL_dofile](http://www.lua.org/manual/5.1/manual.html#luaL_dofile)），因为第一步是让脚本定义您要调用的函数。[当它返回时，您可以使用lua_getglobal](http://www.lua.org/manual/5.1/manual.html#lua_getglobal)访问脚本定义的函数。

# c# - 在静态类中访问的 HttpContext.Current

> ID：556310
> 
> 赞同：15
> 
> 时间：2009-02-17T10:59:50.837
> 
> 标签：c#, asp.net, static

我可以`HttpContext.Current`从静态类和方法中调用吗？

我想按用户存储一个值，但希望能够以静态方式访问它。

例如，这行得通吗？

```
public static class StaticClass
{

    public static string SomeThing
    {
        get { return HttpContext.Current.Items["SomeItem"].ToString(); }
    }

} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-17T11:02:53.840

是的，这是它有用的一种方式，当然，调用它的线程当前必须正在处理请求以使其有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-17T11:03:04.947

你为什么不试试？

是的，这是完全可能的（尽管不一定是好的设计），只要记住在您的项目中引用并`System.Web.dll`检查以防您最终在非 ASP.NET 环境中运行。`HttpContext.Current``null`

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-17T11:03:47.847

是的，它是一个静态方法，因此您可以从任何您喜欢的地方调用它。正如安东尼所说，“当前”上下文取决于调用线程，因此您需要确保使用正确的线程。

# tfs - 合并 - 签入评论

> ID：556313
> 
> 赞同：2
> 
> 时间：2009-02-17T11:00:35.453
> 
> 标签：tfs, merge, version-control

在指示正在合并的内容时，签入合并的最佳方式是什么？我说我要从主分支合并到发布分支的 10 个变更集。其中每一个都包含我在签入主分支时写的详细评论。现在，当我合并时，我发现自己和团队的其他成员都在编写简短的版本，甚至遗漏或没有提及要合并的内容。因此，我想知道我们是否以某种方式完全错误地这样做了，是否有办法指向我们正在合并到发布分支的变更集？

我们正在使用 Team Foundation Server。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-27T22:53:55.577

在将来的某个时候，您可能会后悔没有使用内容丰富的评论。

即使在一次合并中将大量更改提交给分支，我也会煞费苦心地收集所有提交消息并将它们组合到分支提交中。

真的不需要那么长时间，而且真的只是很多复制粘贴工作，你会很高兴你将来做了。

为了进一步促进这一点，您可以使用[剪贴板增强实用程序](http://www.bluemars.org/clipx/)（我现在几乎不能没有它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T11:06:43.533

您不能将合并签入分配给在 10 个变更集上使用的相同工作项吗？然后您可以查阅工作项的历史记录以查看它是否已合并到发布中。如果您构建发布分支，那么这些项目将包含在相关的工作项目列表中。

就个人而言，我认为此时丢失某些信息不是问题。在我们的团队中，合并到发布分支是一个非常受控的过程，换句话说，我们确切地知道将要合并什么：错误修复、更改等。

# .net - 在 Web 上显示 Excel 文档

> ID：556314
> 
> 赞同：1
> 
> 时间：2009-02-17T11:00:53.393
> 
> 标签：.net, asp.net, silverlight, excel

我正在寻找一种通过以下方式在网络上呈现 excel 文档的方法：

将 Excel 文档转换为 html、css 和 javascript，或者使用 silverlight 控件

我不是在寻找一种自行编程转换的方法。我所追求的是一个控件或库（开源或第三方），它将使我能够在网络浏览器中呈现 excel 文件。

解决方案：我们已经找到了解决这个问题的两种解决方案，它们都可以工作并且是免费的： 1\. PHPExcell 是一个优秀的第三方库，用于读取和创建 excel 文件。对于我们的项目，我们创建了一个 PHP Rest 服务，我们的 .NET 应用程序将需要转换为 Excel 的数据发送到该服务，然后将生成的文件发送到客户端。2\. 对于第二个解决方案，我们安装了 Open office 并以无头模式启动它。我们使用它的 UNO CLI API 在 .NET 中为 Openoffice 中可能的任何转换（例如 Excel 到 PDF 到 Word 等、Convert(File, From: Format.Excell, To: Format.PDF) ）创建了一个实用程序 API。我们为此使用了网络上的 Java 教程，因为语法非常相似。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T11:10:21.140

[您可以在OfficeWriter](http://officewriter.softartisans.com/OfficeWriter-250.aspx)等第三方软件的帮助下尝试 SQL Server Reporting Services 。

**编辑：** SSRS 在 SQL Server 2005 Express 中是免费的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T11:28:25.200

[SpreadsheetGear](http://www.spreadsheetgear.com)是一个出色的开发平台，允许您使用托管代码操作和生成 Excel 文件，无需安装 Excel。您可以执行诸如将数据表转换为电子表格、通过代码在电子表格中执行宏等操作。您可以将电子表格转换为数据表并简单地将其显示在数据网格中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T11:06:15.890

试试[FlexCel](http://www.tmssoftware.com/site/flexcelnet.asp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T12:06:10.710

您可以在 MOSS 2007 (SharePoint)中尝试[Excel Services](http://www.codeproject.com/KB/sharepoint/DisplayingCharts.aspx)

# .net - 无法调试网站：未加载任何符号

> ID：556315
> 
> 赞同：7
> 
> 时间：2009-02-17T11:00:54.313
> 
> 标签：.net, asp.net, visual-studio, debugging

我的网站突然出现断点的间歇性错误。

我会从 svn work 获得解决方案，持续一天，然后第二天我会插入一个断点，突然间我收到“无符号消息”。

我试过了

1.  删除所有 obj 和 bin 文件夹。
2.  验证所有 pdb 文件与 .dll 的日期时间同步
3.  重启VS2008
4.  即使将新代码放入我的工作文件夹有时也可以。
5.  甚至重新安装VS2008。
6.  验证一切都处于调试模式

该解决方案确实包含我在网站中引用的其他项目，我也将上述所有内容应用于这些项目。

为什么会发生这种情况，我可以做些什么来解决这个问题？

这给我带来了巨大的问题，因此任何解决方案都将不胜感激。

编辑：

**网站是一个通过IIS**调试的ASP.Net**网站**

 **编辑2：

查看模块窗口，我在损坏的网站中加载的模块较少。

**Broke**
WebDev.WebServer.EXE 是 否 跳过加载符号。
WebDev.WebHost.dll 是 否 跳过加载符号。
System.Windows.Forms.dll 是 否 跳过加载符号。
System.dll 是 否 跳过加载符号。
System.Drawing.dll 是 否 跳过加载符号。
System.Web.dll 是 否 跳过加载符号。
System.Configuration.dll 是 否 跳过加载符号。
System.Xml.dll 是 否 跳过加载符号。

**工作**
mscorlib.dll 是 否 跳过加载符号。
WebDev.WebServer.EXE 是 否 跳过加载符号。
WebDev.WebHost.dll 是 否 跳过加载符号。
System.Windows.Forms.dll 是 否 跳过加载符号。
System.dll 是 否 跳过加载符号。
System.Drawing.dll 是 否 跳过加载符号。
System.Web.dll 是 否 跳过加载符号。
System.Configuration.dll 是 否 跳过加载符号。
System.Xml.dll 是 否 跳过加载符号。
Microsoft.JScript.dll 是 否 跳过加载符号。
VJSharpCodeProvider.dll 是 否 跳过加载符号。
CppCodeProvider.dll 否 否 无法找到或打开 PDB 文件。
App_GlobalResources.lehpz3-i.dll 否 是 已加载符号。
App_Code.uje8qrn7.dll 否 是 已加载符号。
Microsoft.VisualBasic.dll 是 否 跳过加载符号。
System.Data.dll 是 否 跳过加载符号。
System.Web.Services.dll 是 否 跳过加载符号。
AjaxControlToolkit.DLL 否 是 已加载符号。
System.Data.DataSetExtensions.dll 是 否 跳过加载符号。
System.Core.dll 是 否 跳过加载符号。
System.Web.Extensions.dll 是 否 跳过加载符号。
System.Web.Abstractions.dll 是 否 跳过加载符号。
App_global.asax.yoorz-jp.dll 否 是 已加载符号。
*snip*
App_Browsers.wieva6wr.dll 否 是 已加载符号。
System.Transactions.dll 是 否 跳过加载符号。
System.EnterpriseServices.dll 是 否 跳过加载符号。
System.Web.Mobile.dll 是 否 跳过加载符号。
System.ServiceModel.dll 是 否 跳过加载符号。
SMDiagnostics.dll 是 否 跳过加载符号。
App_Web_yymooqyw.dll 否 是 已加载符号。
App_Web__9iw0ile.dll 否 是 已加载符号。
System.Web.RegularExpressions.dll 是 否 跳过加载符号。
App_Web_-hwxaplp.dll 否 是 已加载符号。
A_ce20f9a1_b4fe_4ebe_a615_5a0a6bd4f7cb 否 否 未加载符号。
M_ce20f9a1_b4fe_4ebe_a615_5a0a6bd4f7cb 否 否 未加载符号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-18T09:47:54.323

**解决**此问题的方法是使用调试|附加到进程选项并附加到 aspnet_wp.exe 进程（或等效进程）。它没有回答如何修复“标准”调试的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-27T15:52:02.953

在 IIS 管理器的应用程序池属性中，尝试将最大工作进程数设置为 1。

[![替代文字](https://i.stack.imgur.com/RZcv3.png)](https://i.stack.imgur.com/RZcv3.png)

我很尴尬地承认我在这个问题上扯了几天的头发。有时调试会起作用，而有时则不会。John Nolan 提到的附加过程解决方法对我来说是成功的，那时我注意到当我按下 F5 进行调试时，我启动了多个 w3wp.exe 进程。将此值设置为 1 让 VS2008 每次都选择正确的 w3wp.exe。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T11:21:00.613

在 Web 站点中，每个页面通常都是作为其自己的动态程序集构建的。

如果您更改此类页面中的代码，则源页面不再与现有程序集匹配。断点看起来很奇怪。它不是真正的问题，当页面实际运行它的重建并且断点再次“固定”时。

# scripting - 如何重命名/移动具有特定扩展名的所有文件？

> ID：556316
> 
> 赞同：0
> 
> 时间：2009-02-17T11:00:57.637
> 
> 标签：scripting, tcl, expect

我正在学习 tcl (expect)，现在我遇到了一个有趣的问题。我需要一个命令来移动/重命名一堆扩展名为 .status 的文件。我试过这些：

```
spawn /bin/mv *.status some_dir
exec /bin/mv *.status some_dir 
```

当然，那没有用。我用谷歌搜索了一下，发现了一些关于 glob 的东西，但它似乎并没有按照我想要的方式工作。如果我做：

```
exec /bin/mv [glob *.status] somedir 
```

**mv**抱怨说“1.status 2.status 3.status ...等” 不是一个有效的文件。就好像整个文件列表连接在一个字符串中，而不是单独处理。

试图通过谷歌查找更多信息导致我发现很多损坏和过时的链接，所以我希望除了解决这个问题之外，你能否指出一些关于 tcl/expect 基础知识和常见陷阱的好的在线资源。

*更新：*只接受在 /bin 中使用标准 tcl 和标准工具的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T20:15:31.700

兰迪的回答简短而正确，但不需要使用 exec。约瑟夫的回答非常有力，但有点长。

对于一个简短而惯用的答案，我会使用（需要 Tcl 8.5）：

文件重命名 {*}[glob *.status] some_dir

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T17:42:58.700

```
proc move_to_dir {filenames dirname} {
    foreach filename $filenames {
        file rename $filename [file join $dirname [file tail $filename]]
    }
}
# Example:
move_to_dir [glob -nocomplain *.status] ~/foo/bar/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T13:17:05.093

```
$ ls -1
1.状态
2.状态
重命名.tclsh*
some_dir/
两个词.status

$ 猫重命名.tclsh
#!/usr/local/bin/tclsh

eval exec /bin/mv [glob *.status] some_dir

$ ./rename.tclsh

$ ls -1
重命名.tclsh*
some_dir/

$ ls -1 some_dir/
1.状态
2.状态
两个词.status

```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T15:39:19.090

当有很多文件等时，此解决方案适用于名称包含空格的文件：

```
exec find -maxdepth 1 -name *.status -print0 | xargs -0 mv -t some_dir 
```

但它需要 find 和 xargs，它们最常位于 /usr/bin，而不是 /bin。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T18:52:02.853

作为使用复杂的“查找”命令并可能删除数据时的一项安全功能，我在命令前面添加了一个“回显”并将其捕获到文件中。
然后，我可以在使用“源”运行它之前检查文件中列出的命令。

这也是手动处理那些偶尔出现的边缘案例文件的一种方式。

# javascript - 为什么使用 document.write？

> ID：556322
> 
> 赞同：19
> 
> 时间：2009-02-17T11:03:35.867
> 
> 标签：javascript, document.write

我想知道为什么广告仍然使用 document.write 方法将添加插入页面

```
<script language="javascript" type="text/javascript">
    document.write("<script type='text/javascript' src='http://addomain/someadd.js'><\/sc" + "ript>");
</script> 
```

为什么我不能放

```
<script type='text/javascript' src='http://addomain/someadd.js'></script> 
```

代替广告？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-05-06T02:02:52.613

传统的脚本标签会在页面加载和执行时阻塞页面。使用 document.write 加载的脚本将异步工作。这就是为什么您会在广告或分析中看到这一点，因为此类脚本不会直接影响页面内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-28T21:09:10.393

我在一家网络广告公司工作，据我所知，某些浏览器（不知道哪些浏览器）允许您将脚本标签放入页面，但不允许您自动执行其内容.

因此，要实现这一点，您需要将脚本标记分解为多个片段，以便浏览器不会将其视为脚本标记，而是将其视为任何旧的 HTML 数据。然后，随着 DOM 被串行处理，在写出脚本标签之后，它评估的下一件事是……嘿，你刚刚写出的那个脚本标签。

此时脚本标签被评估和执行。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-09-23T16:52:30.510

通常，这些 document.write 注入脚本会附加动态字符串以摆脱缓存，或将有关客户端的一些信息发送到广告服务器。我怀疑你的例子是这样开始的

```
document.write("<script type='text/javascript' src='http://addomain/someadd.js?"+extrastuff+"'><\/sc" + "ript>"); 
```

但随着时间的推移进行了调整，或者被不了解额外内容的人复制和修改。但是正如您所写的那样，没有区别：您在问题中引用的两种方式在功能上是相同的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T11:43:24.070

我的立场是正确的，doc.write 创建的脚本*被*阻塞了——虽然比我更糟糕，呵呵 :)——但作为一个 adblock 避免器，它*真的*很弱，所以我只能得出结论，它是一种 SOP 机制，用于向过度使用的脚本请求动态添加参数。

避免脚本块孩子时使用 DOM 插入技术。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T12:34:36.787

如果禁用活动脚本，此方法可避免加载外部脚本。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T12:32:35.560

我不确定，但他们可能会使用它，因此网站上的所有内容都会先加载并显示给用户，然后再加载并显示广告。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T12:33:55.727

将其与正则表达式匹配并删除很容易：

```
<script type='text/javascript' src='http://addomain/someadd.js'></script> 
```

但另一个更复杂，可以写成不同的格式。

我想这就是原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-23T17:06:06.593

恕我直言，这不仅毫无意义，甚至不正确。尖括号不会转义，这将呈现技术上无效的 HTML 文档（即使它适用于所有主要浏览器，因为它们试图从编码人员的错误中恢复）。如果一个人用 XHMTL 页面为他的网站提供服务`application/xml+xhtml`，`document.write()`那根本就不起作用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-07-29T06:58:14.727

write() 方法主要用于测试：如果在 HTML 文档完全加载后使用，它将删除所有现有的 HTML

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2014-01-15T21:16:15.157

一种降低他们的添加被阻止的可能性的方法。

# database - PostgreSQL 管理和监控

> ID：556325
> 
> 赞同：6
> 
> 时间：2009-02-17T11:04:43.773
> 
> 标签：database, oracle, postgresql

从 Oracle 迁移到 PostgreSQL，有哪些（最好是免费/OSS）软件/工具可以替代 Oracle Enterprise Manager？我知道 pgAdmin，以及捆绑到 EnterpriseDB 的 Postgres Plus AS 中的一些工具，但我正在寻找更多的上下文和对 PostgreSQL 生态系统的更好的概述。

具体来说，我对提供帮助的工具感兴趣：

*   提醒数据库管理员配置和性能问题
*   监控整体系统性能
*   一般性能调优
*   提示支持（我的理解是 PostgreSQL 通常不赞成提示）
*   磁盘管理（易于增长）
*   pg_dump 和 pg_restore 之外的备份/恢复

有什么想法吗？这似乎是很多人以前可能经历过的事情。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-17T17:54:23.710

Postgres 带有优秀的命令行工具，它们是核心开发团队的重点。我个人通过自定义特定于站点的脚本来利用这些脚本来进行数据库管理、升级、复制。对于监控，我使用 nagios 编写 psql 脚本来查询生命体征。

也就是说，除了 pgAdmin，GUI 端还有一些其他选项：

[SQL 大师](http://www.sqlmaestro.com/products/postgresql/maestro/)

[phppgadmin](http://phppgadmin.sourceforge.net/)

我认为其中任何一个都不具备您列出的所有功能，但它们可能是一个很好的起点。我怀疑您会找到真正与 Oracle Enterprise Manager 正面竞争的开源工具。在商业方面，还有其他选择：

[Navicat](http://pgsql.navicat.com/)

[RazorSQL](http://www.razorsql.com/index.html?adid=ria14&gclid=CPOfu4SO5JgCFQkzawodVD1icA)

[用于 PostgreSQL 的 MS SQL 管理器](http://www.ems-hitech.com/pgmanager)

这个 wiki 页面还包含许多其他 postgres 工具的链接：

[PostgreSQL GUI 工具社区指南](http://wiki.postgresql.org/wiki/Community_Guide_to_PostgreSQL_GUI_Tools)

作为一个 CLI 狂热者，我无法给出任何具体的建议，但希望这会有所帮助。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-06T13:36:29.560

从管理工具的角度来看，caseman 已经编译了一个不错的列表，PostgreSQL wiki 在他们的[GUI 数据库设计工具](http://wiki.postgresql.org/wiki/GUI_Database_Design_Tools)页面上也有一些额外的列表。

对于监控/调整，它有点复杂，有很多工具但没有彻底的解决方案。我再次在 Postgres Wiki: [Monitoring tools](http://wiki.postgresql.org/wiki/Monitoring)中开始编译一个列表。

由于对现状不满意，我与一位同事合作，我们开始研究我们自己的解决方案，称为[`pganalyze`](https://pganalyze.com/)，试图帮助（兼职）DBA 了解数据库中发生的事情。但我们也只能暂时关注问题领域的一小部分......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T11:32:52.240

我认为搜索适合您需要的软件的最佳站点是 PgFoundry：[http ://pgfoundry.org/](http://pgfoundry.org/)

我认为没有一款软件可以满足您的所有需求，但也许您可以结合一些工具来获得您想要的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-17T09:05:46.057

我一直在使用一些免费的 gui 工具，但没有一个可以与 Navicat PostgreSQL GUI 相提并论。我想是猫睡衣！

他们现在有一个免费版本，[http://www.navicat.com](http://www.navicat.com)。

马丁利

# google-ad-manager - Google Ad javascript 真的需要在 HEAD 标记中吗？

> ID：556330
> 
> 赞同：2
> 
> 时间：2009-02-17T11:06:36.280
> 
> 标签：google-ad-manager

谷歌广告管理器帮助网站非常规范地说明了如何调用他们的 Javascript API 以及组合 javascript 调用块如何导致代码中断。

（[http://www.google.com/admanager/help/en_US/tips/tagging.html](http://www.google.com/admanager/help/en_US/tips/tagging.html)）

我真的不喜欢在我的页面头部插入这么多 JS 的想法。我希望将其插入页面底部并包含在`document.ready()`呼叫中。

其他人有没有成功摆脱谷歌规定的非常具体的方式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-13T13:15:53.793

已经在 HEAD 之外和 BODY 部分本身的 Google Ad 部分完成了移动。真的没有什么区别，因为当它被移动时，它就在用于显示广告的参数之后。

可能与尝试在页面上的必要挂钩想要尝试调用或使用脚本文件中包含的任何函数之前加载脚本有关。

从您提到的标记指南中：

> **JavaScript 标记出现乱序**
> 
> 此错误表明对 Ad Manager JavaScript 函数的调用没有以正确的顺序发生。此错误可能会阻止广告出现。这也可能导致 Ad Manager 抓取错误的广告；例如，如果您在为页面指定页面级属性之前为该页面获取广告，则您可能会获取不考虑定位条件的广告。

这可能就是为什么他们试图规定代码的放置位置。

# css - 在 IE 中设置选择边框样式会更改箭头按钮

> ID：556334
> 
> 赞同：0
> 
> 时间：2009-02-17T11:07:27.777
> 
> 标签：css, internet-explorer, windows-xp

我们的网站在选择框和文本输入上具有边框样式，以使它们看起来像在 windows 上的 windows XP 样式中一样。这基本上给了它们一个薄的蓝色边框，而不是 windows 经典中的灰色斜面边框。我没有尝试更改选择旁边的小向下箭头按钮上的样式。CSS看起来像这样：

```
border: 1px solid #7F9DB9; 
```

我所追求的最终效果是所有选择和文本输入上的蓝色边框，并且选择应该具有小下拉箭头按钮的系统默认值。

这适用于所有非 IE 浏览器。它在 IE 7 中运行良好。如果使用的是 windows 经典主题，它甚至在 IE8 RC1 中运行良好。但是在 IE8 RC1 中，如果您使用 windows XP 主题（蓝色弯曲窗口标题），那么 IE8 RC1 将继续使用灰色 windows 经典按钮。

这是它在 IE7 中的呈现方式：[alt text http://img128.imageshack.us/img128/1993/goodboxlr2.png](http://img128.imageshack.us/img128/1993/goodboxlr2.png)

这是它在 IE8 RC1 中的呈现方式：[alt text http://img3.imageshack.us/img3/8207/badboxvq8.png](http://img3.imageshack.us/img3/8207/badboxvq8.png)

有谁知道如何让 IE8 像 IE7 一样渲染它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T11:44:06.410

简单的回答，你不能。

样式下拉列表、滚动条等几乎总是会让您对某些/大多数浏览器感到失望。

我只是把它留给主题来决定。

# excel - Excel 对 .NET DLL 的引用因新版本而中断

> ID：556337
> 
> 赞同：1
> 
> 时间：2009-02-17T11:09:51.140
> 
> 标签：excel, com-interop

我有一个安装到 GAC 的 .NET DLL，因为它被多个应用程序使用。

其中之一是 Excel 工作簿，它使用 .NET 的 COM 互操作工具引用 DLL。COM tlb 文件安装到应用程序目录。

这一切都很好，除非安装了更新版本的 DLL。在某些 PC 上，工作簿中的 COM 引用中断（显示为“缺失”）。运行相关宏会使 Excel 崩溃。这可以通过取消勾选 VBA 编辑器中缺少的引用并重新添加对 DLL 的引用来解决，但我希望我的用户不必每次打开它时都这样做。

所有相关的对象和方法都具有不变的签名，并用不变的 GUID 进行装饰。

任何想法为什么参考中断？

编辑：在对注册表进行深入调查之后，看起来 COM 注册在安装时没有正确进行。但是，这并没有显示为安装失败。不过，仍然没有找到根本原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T12:21:16.443

我们在这里也遇到了问题；因此，我们的补丁程序总是运行 gacutil.exe /cdl 来清除下载缓存。该解决方案对我们没有意义，因为我们没有通过浏览器下载我们的程序集，但它有所帮助。要查看是否对您有帮助，请尝试运行 gacutil.exe /l 以查看您的程序集是否在下载缓存中。

另外，请注意，由于某种原因，gacutil 没有随框架重新分发，因此您首先需要将其复制到相关系统中。

# lucene.net - 在生产应用程序上使用 lucene.net 主干

> ID：556339
> 
> 赞同：3
> 
> 时间：2009-02-17T11:10:16.600
> 
> 标签：lucene.net

目前，我正在 Web 应用程序上使用 Lucene.Net-2.0-004 进行原型搜索。它工作得很好，但它是相当旧的 Lucene.net 版本

使用主干版本“安全”吗？你在做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T14:48:09.743

我们目前也在我们的 beta 版本中使用 Lucene.Net 2.0.0.4。到目前为止，它似乎可以满足我们的需要，尽管我听说最新的尚未正式发布的 Lucene.Net 版本修复了几个问题。

您可以在此处查看 Lucene.Net 的标记版本列表： [https ://svn.apache.org/repos/asf/incubator/lucene.net/tags/](https://svn.apache.org/repos/asf/incubator/lucene.net/tags/)

这个 StackOverflow 问题有一些关于 Lucene.NET 当前孵化状态的背景： [Lucene.Net 和孵化状态](https://stackoverflow.com/questions/435207/lucene-net-and-incubation-status)

在回答有关[最新版本 Lucene.Net](https://stackoverflow.com/questions/554608/what-is-the-latest-version-of-lucene-net)的 StackOverflow 问题时，有人提到使用 2.3.1。

我希望 Lucene.Net 项目能尽快发布另一个“官方”版本，最好包含自 2.0.0.4 以来的更改/修复列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-22T19:36:23.040

是的，我将它用于一个项目至少 6 个月。我最终升级到 2.1，因为我想要他们添加的一些功能。我发现它也很稳定——它已经运行了 8 个月左右，没有任何问题。由于它是 Java 版本的一个端口，并且往往在该版本之后运行，我希望 .NET 版本更稳定一些（因为该端口有望在更稳定的版本上完成）。

# authentication - 用于查找 x 是否在 twitter 上关注 y 的 Python 代码。请提供更多 Pythonic 方式

> ID：556342
> 
> 赞同：1
> 
> 时间：2009-02-17T11:11:11.217
> 
> 标签：authentication, twitter, python

我用 Python 编写了一个 Twitter 应用程序。以下是我用于模块的代码，我在其中找到 x 是否跟随 y。这段代码可以明显改进。一种pythonic的方式来做到这一点？

```
import urllib2
import sys
import re
import base64
from urlparse import urlparse
import simplejson

def is_follows(follower, following):

    theurl = 'http://twitter.com/friendships/exists.json?user_a='+follower+'&user_b='+following

    username = 'uname1'
    password = 'pwd1'

    handle = urllib2.Request(theurl)

    base64string = base64.encodestring('%s:%s' % (username, password))
    authheader =  "Basic %s" % base64string
    handle.add_header("Authorization", authheader)
    fol=True
    try:
        fol = simplejson.load(urllib2.urlopen(handle))
    except IOError, e:
        # here we shouldn't fail if the username/password is right
        print "It looks like the username or password is wrong."
    return fol 
```

更新：缩进已修复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T11:17:05.943

三件事：

*   修复缩进（但我猜这不是故意的）。
*   在构造`theurl`.
*   删除`fol`变量。相反，请执行以下操作：

* * *

```
try:
    return simplejson.load(urllib2.urlopen(handle))
except IOError, e:
    # here we shouldn't fail if the username/password is right
    print "It looks like the username or password is wrong."
    return False 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T11:58:36.763

Konrad 给了你一个很好的答案，你可以做出一些改变来让你的代码更加 Pythonic。我想补充的是，如果您有兴趣查看一些**高级**代码来做同样的事情，请查看[The Minimalist Twitter API for Python](http://mike.verdone.ca/twitter/)。

它可以通过使用 __getattr__() 和 __call__() 使用动态类方法构造，向您展示编写不会重复自身的 API（换句话说，遵循 DRY [不要重复自己] 原则）的 Pythonic 方式。您的示例将类似于：

```
fol = twitter.friendships.exists(user_a="X", user_b="Y") 
```

即使 twitter 类没有“友谊”或“存在”方法/属性。

（警告：我没有测试上面的代码，所以它可能不太正确，但应该非常接近）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T12:23:11.323

从您的代码看来，您正在尝试进行基本 HTTP 身份验证。这是正确的吗？那么您不应该手动创建 HTTP 标头。而是使用 urllib2.HTTPBasicAuthHandler。[文档](http://docs.python.org/library/urllib2.html)中的一个示例：

```
import urllib2
# Create an OpenerDirector with support for Basic HTTP Authentication...
auth_handler = urllib2.HTTPBasicAuthHandler()
auth_handler.add_password(realm='PDQ Application',
                          uri='https://mahler:8092/site-updates.py',
                          user='klem',
                          passwd='kadidd!ehopper')
opener = urllib2.build_opener(auth_handler)
# ...and install it globally so it can be used with urlopen.
urllib2.install_opener(opener)
urllib2.urlopen('http://www.example.com/login.html') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T11:21:13.423

谷歌向我扔了这个带有[Twitter API for Python](http://static.unto.net/python-twitter/0.5/doc/twitter.html)的库。我认为这样的图书馆会大大简化这项任务。它有一个 GetFollowers() 方法，可以让您查找是否有人在关注您。

编辑：看起来您无法查找任意用户的关注者。

# jquery - jquery session - 动态变量命名

> ID：556350
> 
> 赞同：1
> 
> 时间：2009-02-17T11:16:29.097
> 
> 标签：jquery, jquery-session

只是这里有问题。我正在使用 jquery、css 做一个基于 web 的应用程序的 UI。有一个购物车，我想在会话中存储选定的项目，我使用了 jquery.session 插件。例如`var $.session("var1","item1");`

我想要的是将项目动态存储到动态命名的变量中。我怎么能这样做？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-04T16:01:37.367

如果有购物车，则该数据应由 PHP 等服务器端脚本语言处理。我假设最后他们将通过信用卡收费？这种数据需要安全。

此外，这是由可以关闭的非安全客户端语言（如 JS）处理的功能的很大一部分。

只是将来要考虑的事情..

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T11:29:10.220

您可以这样做的一种方法是创建一个存储“会话”变量的函数。会话将有两个参数，变量名称和它的值。例如：

```
function setSession(name, value) {

     $.session(name, value);

} 
```

每当您需要设置 jQuery 会话变量时，只需调用该函数，如下所示：

```
setSession('var1', item1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T12:40:02.857

只需使用字符串将其构建为您想要的，如下所示：

```
`function storeValueInCart(cartId, value) {
  $.session("var"+cartId, value);
}` 
```

`您还可以在元素上存储任意数据并使用它们，如下所示：`

 ````
 `$(".vote_action").each(function() {
        vote_id = $(this).attr("id").substring("action_".length);
        $(this).data("vote_id", vote_id);
    });` 
```

`上面的循环遍历了带有 vote_action 类集的每个元素。在它找到的每个元素上，它都会获取 id 属性，这是一个类似于 action_NN 的字符串，然后切断动作部分。然后它将这个 vote_id 存储为“vote_id”名称下元素上的任意数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T11:27:45.730

由于会话函数将字符串作为参数，因此只需动态创建这些字符串。

# c# - 从 system.object 向上转换为通用对象

> ID：556358
> 
> 赞同：1
> 
> 时间：2009-02-17T11:20:42.907
> 
> 标签：c#, generics, .net-2.0

我有一些简单的代码可以证明我的问题：

```
private void InitializeOther()
{
  List<Foo> list = new List<Foo>();
  Casting(list);
}

//in the "real" case I have no knowledge of o, other than it could be a List<>
private void Casting(object o)
{
  Type t = o.GetType();
  while (t.BaseType != typeof(Object))
  {
    if (t.IsGenericType && typeof(List<>) == t.GetGenericTypeDefinition())
    {
      //now I know that o is of type List<>. How can I now access List<> members from o?
      break;
    }
    t = t.BaseType;
  }
} 
```

因此，我可以确定对象 o 属于（或派生）自`List<T>`，但现在我希望能够访问`List<T>`o 上的成员，这意味着将其转换为`List<Foo>`. 在我的“真实”案例中，我不了解 Foo。

我很确定它可以完成，如果你知道怎么做，如果你能与我分享你的知识，我将非常感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T11:26:19.947

一个小技巧是尝试`o`转换为非泛型`IList`，因为`List<T>`实现了泛型和非泛型接口。可以说`Collection<T>`哪个是用户集合最常用的基类。

如果这不是一个选项，您始终可以使用反射方法调用（后期绑定）：`MethodInfo.Invoke()`等。

# sql - 数据库中空值使用的空间

> ID：556363
> 
> 赞同：22
> 
> 时间：2009-02-17T11:21:47.617
> 
> 标签：sql, sql-server, database, null

如果列为空，是否会影响该列使用的空间？列定义使用的空间是否固定？这是否因数据库而异。（我主要对 SQL Server 2000 感兴趣。）

澄清：这个问题与列“可为空”时发生的情况无关（正如 Kritsen 和 gbn 指出的那样，这需要另外花费一点）。问题是，当列实际上为空（在某些特定行中）时是否有任何保存。

...

Cadaeic 为 SQL Server 提供了答案，在 2008 版之前似乎在 SQL Server 中没有节省，而根据 Quassnoi 的说法，如果空列在最后，您可以在 Oracle 中节省。感谢您的回答，他们都很有帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-17T21:04:51.490

在列中存储 NULL 不会特别耗费或节省空间。对于定长数据，仍然保留整个空间。

另一方面，可变长度数据只需要数据长度加上存储实际长度的开销。例如，一个 VARCHAR(n) 将使用 2 个字节的数据来表示实际长度，因此所需的存储空间始终为 n+2。

此外，应该提到的是，如果 SET ANSI_PADDING ON，具有 NULL 值的 char(n) 将表现为 VARCHAR(n)。

无论如何，在使用 SQL Server 2000 或 SQL Server 2005 时，您不会认识到存储 NULL 所节省的空间。SQL Server 2008 引入了稀疏列的概念，它可以为主要为 NULL 的列节省空间。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-17T11:33:48.587

SQL Server 有一个位来指示 NULL。如果列定义为 NOT NULL，则不使用此类位

VARCHAR 使用可变长度来存储数据（因此有指示实际数据长度的开销），而 CHAR 是固定宽度。

因此，在此基础上，CHAR(1) NOT NULL 比 VARCHAR(1) NOT NULL “短”，因为 VARCHAR 需要长度指示符，而 CHAR 将始终只使用一个字节。

编辑：请注意，拥有一个允许 NULL 的 BIT 字段需要两个位来存储它！我经常看到没有考虑到这一点的 BIT 字段，不需要存储 NULL 但没有设置为 NOT NULL 所以无意中浪费了一点

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-17T11:50:46.643

在`Oracle`中，它取决于列的类型及其在行中的位置。

如果`NULL`列在行中的最后，那么它们根本不占用任何空间。Oracle 将总行大小添加到每一行，不适合的所有内容都将被考虑`NULL`。

如果某列`NULL`之后有一些非数据，则存储为单个字节（即类型）。`NULL``NULL``0xFF``NULL`

空`VARCHAR2`相当于`NULL`。如果您测试`NULL`从列表返回的文字的类型`SELECT`，它会给您一个`VARCHAR2(0)`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-17T11:38:16.547

它存储在位图中，而不是作为列值。

示例：一个名为 middle name 的可为空的 varchar 列

*   第 1 行，“bob”存储为偏移量，3 个字节存储 bob，2 个字节存储“bob”长度
*   第 2 行，NULL 行不存储为“bob”之类的值，而是存储在行标题中

除非你有一个非常小的表，比如单列 char(1)，否则效率更高

[链接 1](http://blogs.msdn.com/sqlserverstorageengine/archive/2006/06/29/650349.aspx) [链接 2](http://www.windows-tech.info/15/f602f8c2ef9e0dbc.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T18:08:05.487

如果您使用 varchar 或 nvarchar 数据类型，则该行使用的字节数会更少。这就是为什么您可以创建一个表（但不应该），它的潜在字节数多于实际存储在记录中的字节数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-13T18:16:24.910

在 Oracle 11G 中，我也遇到了同样的情况。您不能通过将列设置为 NULL 来释放（检查 dba_segments）由现有行占用的空间，无论其位置如何，在中间或最后。

```
UPDATE AUCORE_QA.SYSTEM_AUDIT_LOGS SET KEY=NULL;
SELECT OWNER, TABLESPACE_NAME , SEGMENT_NAME,SEGMENT_TYPE,BYTES/1024/1024 MB
FROM DBA_SEGMENTS 
WHERE OWNER LIKE 'AUCORE_QA' AND SEGMENT_TYPE='TABLE' AND SEGMENT_NAME like '%AUDIT_LOG%'
ORDER BY BYTES DESC; 
```

但是，我将列设为“Nullable”，并且能够看到后续插入行的保存节省。

```
ALTER TABLE SYSTEM_AUDIT_LOGS MODIFY KEY NULL; 
```

# javascript - 使用 javascript 修改 MP3 属性

> ID：556365
> 
> 赞同：0
> 
> 时间：2009-02-17T11:21:56.697
> 
> 标签：javascript

是否可以修改 mp3 文件的属性。艺术家、专辑、标题等属性。我需要更改这些字段。

仅在 JavaScript 中。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T11:46:09.087

不，Javascript 语言不包含修改 ID3 标记所需的文件读取和读取功能。

但是，根据 Javascript 引擎和环境，这些功能可能在引擎/环境提供的库中可用，也可能不可用。例如。可以在[Rhino](http://www.mozilla.org/rhino/ "犀牛")下运行的 Javascript 中执行此操作，因为 Rhino 公开了 Java 包含的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T11:26:01.180

可能不是。尽管我对 JavaScript 的经验有限，但我相信它在沙箱中运行，并且不允许在 Web 浏览器之外执行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T11:26:20.290

此链接应提供一些您可以使用的提示和代码：

[Ajaxian：使用 JavaScript 读取 ID3 标签](http://ajaxian.com/archives/reading-id3-tags-with-javascript)

这是一个[演示](http://www.nihilogic.dk/labs/id3/)，它使用您必须上传的文件。

# .net - 对 int[] 数组的并发读取访问：安全吗？快吗？

> ID：556367
> 
> 赞同：8
> 
> 时间：2009-02-17T11:22:47.677
> 
> 标签：.net, multithreading, arrays, multicore

在四核机器上，我正在考虑 C#/.NET 算法的并行化，该算法涉及让多个线程同时读取小的 int[] 数组。到目前为止，它似乎工作得很好，但我不确定在哪里指定数组上的并发读取在 .NET 中是线程安全的。任何指针？

然后，我也想知道这种方法是否真的有效？在某些情况下，您最好为每个线程实际复制输入数据，这样就没有任何并发​​读取，并且每个数组（也许？）都有机会在关联 CPU 附近缓存？

关于多核 CPU 的最佳实践有什么想法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-17T11:27:13.203

我认为并发读取没有问题。但是，如果存在并发**写入**，则可能会出现问题。

*不可变数据本质上是线程安全的。*

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-17T11:37:43.740

在您的情况下，对数组的并发读取将是线程安全的。

至于您的算法有效性，取决于阵列的大小，如果它适合缓存，那么您可能会看到出色的性能提升，因为多核有效地“争夺”CPU 中的缓存。如果他们正在努力用相同的信息填充缓存，他们将共享意味着更多的缓存命中和更好的性能。

假设您的阵列适合缓存...

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-17T11:28:01.363

假设内容永远不会改变，没有理由不同时读取数组的内容。没有并发问题，因此无需复制。

我怀疑你可以做很多事情来让它更快。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-17T11:28:39.770

它不应该打扰你。并发读取不是问题。任意数量的线程可以同时读取相同的内存。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-17T11:43:26.347

如果 .NET 性能和并行性受到威胁，我建议尝试在 F# 中编写此特定算法。F# 编译器将生成[性能提高 2-6 倍的 .NET 代码](https://web.archive.org/web/20130606063600/http://abdullin.com:80/journal/2009/1/6/f-has-better-performance-than-c-in-math.html)。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-17T11:34:05.887

仅当您更新数据时，线程安全才是一个问题。如果您有多个并发线程***更新***数组，您将不得不在同步机制中包装更新（如果更新不是原子的，则读取）。对于只读数据结构，并发性不是问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-28T19:47:56.063

赋值运算符不是线程安全的。

这意味着如果您的线程只读取数组——如果数组在程序启动时被初始化并且没有改变——那么你是安全的。

但是，如果存在编写新值的作家，那么您很容易受到竞争条件的影响。

基本问题是这样的；阅读器开始阅读一个整数。该值从内存加载到寄存器中。在这一点上，读者换掉了。然后作者更新内存中的值。然后读者换回并根据他加载的值采取行动——这不再正确。

这意味着诸如此类的`if()`事情不能可靠地工作。例如，

```
if( int_array[5] == 10 )
{
} 
```

`int_array[5]`当内存中的值不再是 10时可能触发。

我相信在 C# 中，您应该可以访问`Interlocked*()`函数调用，例如`InterlockedCompareAndSwap()`. 在这种情况下，这些将允许您轻松实现线程安全。

# .net - 在 asp.net MVC 中获取母版页名称

> ID：556371
> 
> 赞同：2
> 
> 时间：2009-02-17T11:25:08.873
> 
> 标签：.net, asp.net, asp.net-mvc

我可以以编程方式获取将在 asp.net MVC 应用程序中使用的母版页名称的最早点是什么？

这个想法是根据母版页更改使用的视图数据。我希望能够尽早设置一些东西，以便个别开发人员不需要知道填充它。理想情况下，它只会在后台发生。

在最简单的场景中，我们将为不同类型的页面设置不同的母版页，例如带有页眉、左侧导航、右侧导航和页脚的默认主页，或者可能缺少右侧导航的安全主页。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T11:31:18.750

我想说当您的母版页已知时，您的视图已被您的视图引擎解析之后。不过，您可以在 Controller 上调用 View 方法时设置母版页：

```
public ActionResult Index()
{
  return View("index","masterpagename");
} 
```

我认为如果您想对您的母版页做任何事情，那就是这样。我不知道您的问题的上下文，但我假设您想根据使用的母版页来操纵视图和/或视图数据？也许您的问题的解决方案不是首先以编程方式获取母版页的名称？

另外，在您编辑之后：您可以做的是创建一个新的“Base”控制器，它继承了默认的 Controller 类。然后你重写 View 方法，并告诉你的开发人员使用它：

```
public class MySuperController : Controller
{
  protected override ViewResult View(string viewName, string masterName, object model)
  {
    // do something here so your masterpage is different depending on the context //
    string newMasterName = "something-something";
    return base.View(viewName, newMasterName, model);
  }
} 
```

我“认为”所有其他视图方法要么通过此路由，要么在您的情况下不使用（要求您通过 IView 的方法）。

# search-engine - 新的网络标准？

> ID：556373
> 
> 赞同：0
> 
> 时间：2009-02-17T11:26:09.620
> 
> 标签：search-engine, web-standards

谷歌、微软和雅虎现在计划创建一个新的网络标准。这对使用 html、ajax 作为开发的 Web 开发人员来说是一个优势吗？

如果发生这种情况，是否不会出现浏览器问题？

他们这样做是为了打败 adobe 的 flash 播放器和 mxml 约定吗？

就 GUI 而言，当今 Web 应用程序开发的最佳举措是什么？使用 adobe 的 flex 框架进行开发或使用各种 ajax 工具包/框架（例如 GWT、EXT、jQuery）保持现代性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T11:33:17.120

您可能指的是“规范标签”的定义（“[谷歌、雅虎和微软联合在“规范标签”上减少重复内容混乱](http://searchengineland.com/canonical-tag-16537)“）：

```
<link rel="canonical" href="http://www.example.com/products/apples"/> 
```

这只是一种告诉搜索引擎哪些 URL 包含重复内容的方法。所以，我想这不是什么革命性的东西。它不会影响当今 Web 开发人员所做的大部分工作，也不会解决任何浏览器问题。

从[这里](http://itvoir.com/portal/news/Corporate-News/Google-Yahoo-Microsoft-to-Support-new-Web-Standard.asp)：

> 据估计，网络上大约 20% 的 URL 是重复的。许多网络发布商，如电子商务公司，都有多个指向同一个页面的 URL。这会使搜索引擎感到困惑，有时会导致它们多次索引同一页面。

# windows - 如何在 Visual Studio 2008 中使用 Windows 符号包？

> ID：556383
> 
> 赞同：3
> 
> 时间：2009-02-17T11:28:31.953
> 
> 标签：windows, visual-studio, visual-studio-2008, debugging, symbols

在 Microsoft，我可以下载[XP、Vista、Server 甚至 Windows 7 的 Windows 符号包](http://www.microsoft.com/whdc/devtools/debugging/symbolpkg.mspx)。

我的问题是：如何在 Visual Studio 中使用这些符号？在 VS 2008 中，我可以在哪里添加下载和提取的符号，以便我可以调试到 Windows 本身？

我想要实现的目标：我想调试 _beginthreadex/endthreadex，以查看[某些代码丢失句柄的原因/位置](https://stackoverflow.com/questions/552822/why-is-this-code-losing-handles-on-windows-7-beta)。

我知道我可以[将 Visual Studio 2008 设置为下载源文件](http://blogs.msdn.com/sburke/archive/2008/01/16/configuring-visual-studio-to-debug-net-framework-source-code.aspx)，但看起来这仅适用于 .net 框架源？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-17T11:45:16.517

符号包仅适用于您当前运行的 Windows 版本——它们安装在 C:\Windows\Symbols 中，您一次只能安装一个。

请改用符号服务器。

### 符号服务器

在 Visual Studio中，转到：`Tools`/// 。将“ [http://msdl.microsoft.com/download/symbols](http://msdl.microsoft.com/download/symbols) ”添加到列表中。您需要在. 我使用 C:\WebSymbols。尽管您可以定期清理目录，但您将有足够的空间（我的空间大约为 600Mb）。`Options``Debugging``Symbols``Symbol file (.pdb) locations``Cache symbols from symbol servers to this directory:`

这最初会减慢您的调试会话，直到您通常需要的所有符号都已被缓存。

`_NT_SYMBOL_PATH`或者，您可以通过将环境变量设置为以下内容来为所有 Windows 调试器全局设置： `SRV*C:\WebSymbols*http://msdl.microsoft.com/download/symbols`.

您还可以（作为构建过程的一部分）使用 SYMSTORE.EXE（来自[Debugging Tools for Windows](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)）收集您自己的 .PDB 文件，并将该目录添加到此列表中。

### 源服务器

.PDB 文件可以具有对构建它们的源文件的（可选）引用。正如您所提到的，您可以使用此功能下载 .NET 源代码，但它也适用于 C++ 源文件。我们用原始源文件的 SVN 路径和修订版注释我们的 .PDB 文件。当我们使用“转到源代码”时，Visual Studio 使用 SVN 来下载构建 EXE 的确切源代码。这真的很酷。

要注释 PDB 文件，您需要`srcsrv`Windows 调试工具目录中的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T11:53:23.640

如果您想“调试到 Windows 本身”，您可能希望能够附加到已经运行的进程，这是 MSVC++ 的 Express 版本无法做到的。因此，如果您使用的是 Express 版本（或者即使您不是），我建议您下载[Debugging Tools for Windows](http://www.microsoft.com/whdc/devtools/debugging/default.mspx)。这提供了`windbg`和`cdb`调试器，它们比 MSVC++ 附带的调试器更不友好，但更强大。

# html - Flex 影片与其他 HTML 重叠

> ID：556393
> 
> 赞同：2
> 
> 时间：2009-02-17T11:31:27.640
> 
> 标签：html, apache-flex, flash, actionscript

我有一个包含文本输入框和（可选）下拉列表的 Flex 电影。该设计要求此下拉菜单位于影片的下边缘下方，与下方的 HTML 重叠。

我可以将 wmode 设置为透明，并且可以使下拉列表与 HTML 重叠，但是下面的 HTML 是不可选择的，即使下拉列表不可见（flex 窃取鼠标事件）。

当用户选择/取消选择它但遇到错误时，我正在考虑更改包含我的电影的 div 的大小；如果 wmode 设置为透明，Flex 不会为您提供激活/停用事件，因此我无法在正确的时间更改 div 的大小。

我在这个解决方案的正确轨道上吗？如果是这样，我如何检测用户当前是否正在使用我的电影。

如果我叫错了树，在正确方向上的小指针将不胜感激:)

谢谢，

山姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-17T11:38:30.680

如果您希望 html 元素显示在您的 Flash 组件上方，您可以添加`<param name=”wmode” value=”transparent”&gt;`到您的 Flash 并使用绝对定位设置您的 div 样式。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T12:12:06.343

为什么不只在下拉菜单下降时才增加 div 的大小？您可以使用`ExternalInterface`（或简单地`navigateToURL("javascript:...")`）在适当的时候调用相关的 javascript 函数。

# localization - i18n 应用程序的测试工具

> ID：556396
> 
> 赞同：1
> 
> 时间：2009-02-17T11:32:24.190
> 
> 标签：localization, internationalization, globalization

对测试国际化/本地化应用程序的工具有什么建议吗？该应用程序的用户界面是通过网络界面。本地化字符串存储在 xml 文件中。

此致

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-06T20:30:59.003

我不确定你到底想测试什么，但对于桌面应用程序，我正在处理一些可翻译的字符串用于菜单。这些字符串可能包含键盘快捷键，例如：“Open\tCtrl-O”。我们需要包含键盘快捷键，因为 Ctrl-O 可能需要翻译成另一种语言的其他键盘快捷键。然而，一些翻译者（当然不是故意的）会引入错误。例如，它们会在 \t 和 Ctrl-O 之间包含一个空格，或者它们会翻译“Ctrl”。我们的解决方案是创建少量单元测试，并在每种语言的每个英语字符串翻译的字符串组合上运行这些测试。所以这是很多测试（在我们的例子中超过 50000），但它们运行得非常快（10 秒左右），因为它主要是字符串比较。

我们测试以下内容：

*   \t 和键盘快捷键之间没有空格，
*   如果英文字符串中有快捷键，翻译中也应该有快捷键，
*   如果英文字符串没有换行符，翻译也不应该，
*   如果英文字符串以“...”结尾（表示打开对话框的菜单项），则翻译也应以“...”结尾。

我希望这在您谈论 Web 应用程序时仍然有用，而我的经验是使用桌面应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-04-13T21:05:21.830

“测试” i18n 应用程序的一种方法是确保您正在处理所有特定于语言环境的行为和翻译的资源。这通常需要制定质量保证计划。

您必须执行的步骤之一是确保根据每个区域设置正确完成货币、数字、日期、时间或其他度量的格式。我知道没有特定的工具可以检查这一点。

另一个方面是确保所有用户可见的字符串确实不在代码和资源包中，无论是哪种类型（从 .properties 到 .po 到 .xml ......选择范围很大）。一些 QA 团队设置了“伪本地化”策略，这意味着创建一个资源包，其中包含原始字符串，但带有前缀和后缀“特殊”字符，例如日语平假名。然后使用伪语言环境调用应用程序会显示所有带有前缀和后缀的字符串，同时允许开发人员查看缺少的内容（那些没有平假名的字符串）以及布局管理的行为方式（裁剪不应该的文本）。

有许多工具可以做到这一点，例如 Lingoport 的 Globalyzer，它通常处理 i18n，伪本地化是其中的一部分（在菜单中，它实际上称为“PseudoJudo”）。它允许将文本增长给定的百分比，仅将前缀或仅后缀或两者都附加到原始字符串。

希望至少部分回答您的问题。

# sql - Access中的查询

> ID：556397
> 
> 赞同：1
> 
> 时间：2009-02-17T11:32:24.813
> 
> 标签：sql, ms-access

我有 2 个表，我想查询它们以形成一个新表。

表格1

```
 number    type serial index
1000001     613      3     1
1000001     613      3     1
1000001     613      3     1
1000001     613      3     1
1000001     613      4     1
1000001     613      3     1 
```

表 2

```
 number    type serial index
1000001     613      3     2
1000001     613      3     3
1000001     613      3     4
1000001     613      3     4
1000001     613      4     2
1000001     613      3     1 
```

我正在寻找一个查询，它给出这样的索引和数字的结果，并添加索引，并给出结果：

```
output table

 number  index
1000001      3
1000001      4 
1000001      5 
1000001      5 
1000001      3
1000001      2 
```

我想在这里防止交叉连接。我不能使用 where 子句，因为两个表中的数字相同，只是索引不同。我怎样才能执行这个一对一而不是一对多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T15:22:56.290

我认为不可能按照您的要求进行。您必须能够唯一区分每一行以保证一对一的结果（这通常是您的索引列或 ID 列的工作）。

您可能可以使用 rownum 进行临时操作，但是，如果表的顺序相同，那么您可能已经过度规范化了。表 1 和表 2 实际上应该只有一个，并且在一个表中有两个索引列（index1 和 index2）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T15:29:19.627

根据我对问题的理解，您希望在每个表的等效行上添加索引列。由于 MS Access 没有像数据库服务器那样的行号功能，我可以建议暂时为每个表添加一个新的自动编号字段。这会给你一些内部加入然后添加的东西。

假设您在两个表上都将此列称为 tempAuto。

```
SELECT t1.number, (t1.index + t2.index) AS index 
FROM table1 t1 
INNER JOIN table2 t2 ON t1.tempAuto = t2.tempAuto; 
```

然后，您可以在执行任何数据操作后删除额外的列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T18:04:50.190

你需要知道如何设置这个计数器函数 Qcntr() :(参见 [http://support.microsoft.com/kb/94397](http://support.microsoft.com/kb/94397) )

```
Select Counter, number, Max(index) + 1 as new_Index
From
(
  (Select Number, index, Qcntr(number) as Counter from [Table 1])
   Union
  (Select Number, index, Qcntr(number) as Counter from [Table 2])
) as both_tables
Group by Counter, number 
```

您可以在没有 Counter 字段的情况下将其附加到输出表中。

# c# - C# 代码覆盖率指标

> ID：556399
> 
> 赞同：4
> 
> 时间：2009-02-17T11:32:59.120
> 
> 标签：c#, code-coverage, metrics

是否有免费的商用代码覆盖工具（低至各个 LOC 级别）可用？

我知道VS2008 Team Edition，但不幸的是没有购买许可证的预算！所以我正在寻找一种免费的（如啤酒）替代品。

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-17T11:34:32.250

[NCover](http://ncover.sourceforge.net/)是一个用于 .NET 的开源代码覆盖工具。[NCover.com](http://www.ncover.com/)上似乎也提供了更新的商业版本。

另请参阅上一个问题：[C#/.net 的代码覆盖率](https://stackoverflow.com/questions/276829/code-coverage-for-c-net)

# unix - 在 time(1) 的输出中，“real”、“user”和“sys”是什么意思？

> ID：556405
> 
> 赞同：2048
> 
> 时间：2009-02-17T11:33:51.660
> 
> 标签：unix, time, benchmarking

```
$ time foo
real        0m0.003s
user        0m0.000s
sys         0m0.004s
$ 
```

在时间输出中是`real`什么意思`user`？`sys`

对我的应用进行基准测试时，哪一个有意义？

* * *

## 回答 #1

> 赞同：2414
> 
> 时间：2009-02-17T11:34:57.103

**Real、User 和 Sys 进程时间统计**

其中一件事与另一件事不同。Real 指实际经过的时间；User 和 Sys 指的是*仅由进程使用的 CPU 时间。*

*   **Real**是挂钟时间 - 从通话开始到结束的时间。这是所有经过的时间，包括其他进程使用的时间片和进程阻塞的时间（例如，如果它正在等待 I/O 完成）。

*   **用户是进程***内*用户模式代码（内核外部）所花费的 CPU 时间量。这只是执行进程中使用的实际 CPU 时间。其他进程和进程阻塞的时间不计入此数字。

*   **Sys**是进程内在内核中花费的 CPU 时间量。*这意味着在内核*中执行系统调用所花费的 CPU 时间，而不是仍在用户空间中运行的库代码。像“用户”一样，这只是进程使用的 CPU 时间。有关内核模式（也称为“主管”模式）和系统调用机制的简要说明，请参见下文。

`User+Sys`将告诉您进程使用了​​多少实际 CPU 时间。请注意，这是跨所有 CPU 的，因此如果进程有多个线程（并且此进程在具有多个处理器的计算机上运行），它可能会超过`Real`（通常发生）报告的挂钟时间。请注意，在输出中，这些数字包括所有子进程（及其后代）的时间`User`和时间，以及它们可能被收集的时间，例如由或，尽管底层系统调用分别返回进程及其子进程的统计信息。`Sys``wait(2)``waitpid(2)`

**报告的统计数据的来源`time (1)`**

报告的统计信息`time`是从各种系统调用中收集的。'User' 和 'Sys' 来自[`wait (2)`](https://docs.oracle.com/cd/E23823_01/html/816-5168/wait-3c.html#scrolltoc)( [POSIX](http://pubs.opengroup.org/onlinepubs/9699919799/functions/wait.html) ) 或[`times (2)`](https://linux.die.net/man/2/times)( [POSIX](http://pubs.opengroup.org/onlinepubs/9699919799/functions/times.html) )，具体取决于特定系统。[`gettimeofday (2)`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/gettimeofday.html)“真实”是根据从通话中收集的开始和结束时间计算的。根据系统的版本，各种其他统计信息，例如上下文切换的数量也可能由`time`.

在多处理器机器上，多线程进程或派生子进程的运行时间可能小于总 CPU 时间——因为不同的线程或进程可能并行运行。此外，报告的时间统计数据来自不同的来源，因此为非常短的运行任务记录的时间可能会出现舍入错误，如原始海报给出的示例所示。

**内核与用户模式的简要介绍**

在 Unix 或任何受保护内存的操作系统上，[“内核”或“主管”](https://en.wikipedia.org/wiki/Kernel_mode#Supervisor_mode)模式是指 CPU 可以运行的[特权模式](https://en.wikipedia.org/wiki/Process_management_(computing)#Processor_modes)。某些可能影响安全性或稳定性的特权操作只能在 CPU 运行时执行这种模式；这些操作不适用于应用程序代码。此类操作的一个示例可能是操纵[MMU](https://en.wikipedia.org/wiki/Memory_management_unit)以访问另一个进程的地址空间。通常，[用户模式](https://en.wikipedia.org/wiki/User_space)代码不能这样做（有充分的理由），尽管它可以从内核请求[共享内存，这](https://en.wikipedia.org/wiki/Shared_memory)*可能*被多个进程读取或写入。在这种情况下，共享内存是通过安全机制从内核显式请求的，并且两个进程都必须显式附加到它才能使用它。

特权模式通常被称为“内核”模式，因为内核是由运行在该模式下的 CPU 执行的。为了切换到内核模式，您必须发出特定指令（通常称为[*陷阱*](https://en.wikipedia.org/wiki/Trap_(computing))）将 CPU 切换到在内核模式下*运行并从跳转表中保存的特定位置运行代码。* 出于安全原因，您不能切换到内核模式并执行任意代码 - 陷阱是通过一个地址表进行管理的，除非 CPU 在超级用户模式下运行，否则这些地址无法写入。您使用显式陷阱编号进行陷阱，并在跳转表中查找地址；内核具有有限数量的受控入口点。

C 库中的“系统”调用（特别是手册页第 2 节中描述的那些）具有用户模式组件，这是您从 C 程序实际调用的组件。在幕后，他们可能会向内核发出一个或多个系统调用来执行特定的服务，例如 I/O，但他们仍然有代码在用户模式下运行。如果需要，也可以直接从任何用户空间代码向内核模式发出陷阱，尽管您可能需要编写一段汇编语言来正确设置调用的寄存器。

**更多关于“系统”的信息**

有些事情是您的代码在用户模式下无法做到的——比如分配内存或访问硬件（HDD、网络等）。这些都在内核的监督下，只有它可以做到。`malloc`像或`fread`/之类的一些操作`fwrite`将调用这些内核函数，然后将计为“sys”时间。不幸的是，它并不像“对 malloc 的每次调用都将计入 'sys' 时间”那么简单。调用`malloc`将自己进行一些处理（仍计入“用户”时间），然后在某个地方调用内核中的函数（计入“系统”时间）。从内核调用返回后，“用户”中将有更多时间，然后`malloc`将返回您的代码。至于切换发生的时间，以及在内核模式下花费了多少……你不能说。这取决于库的实现。此外，其他看似无害的功能也可能`malloc`在后台使用等，然后在“sys”中再次使用一段时间。

* * *

## 回答 #2

> 赞同：333
> 
> 时间：2010-04-29T05:29:21.317

为了扩展已[接受的答案](https://stackoverflow.com/a/556411/1677912)，我只想提供`real`≠ `user`+的另一个原因`sys`。

请记住，它`real`代表实际经过的时间，而`user`和`sys`值代表 CPU 执行时间。结果，在多核系统上，时间`user`和/或`sys`时间（以及它们的总和）实际上可能*超过*实时时间。例如，在我为类运行的 Java 应用程序上，我得到了这组值：

```
real    1m47.363s
user    2m41.318s
sys     0m4.013s 
```

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2017-11-24T19:05:56.987

•**真实**：从开始到结束运行过程所花费的实际时间，就好像它是由人用秒表测量的一样

• **user**：计算过程中所有CPU花费的累计时间

• **sys**：在系统相关任务（例如内存分配）期间所有 CPU 花费的累积时间。

> 请注意，有时 user + sys 可能大于真实值，因为多个处理器可能并行工作。

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2018-12-26T21:29:53.230

**最小可运行 POSIX C 示例**

为了使事情更具体，我想`time`用一些最小的 C 测试程序举例说明一些极端情况。

所有程序都可以编译和运行：

```
gcc -ggdb3 -o main.out -pthread -std=c99 -pedantic-errors -Wall -Wextra main.c
time ./main.out 
```

并已在 Ubuntu 18.10、GCC 8.2.0、glibc 2.28、Linux 内核 4.18、ThinkPad P51 笔记本电脑、Intel Core i7-7820HQ CPU（4 核 / 8 线程）、2x Samsung M471A2K43BB1-CRC RAM（2x 16GiB）中进行了测试。

**`sleep`系统调用**

`sleep`系统调用完成的非忙碌睡眠仅计入`real`，但不计入`user`or `sys`。

例如，一个休眠一秒钟的程序：

```
#define _XOPEN_SOURCE 700
#include <stdlib.h>
#include <unistd.h>

int main(void) {
    sleep(1);
    return EXIT_SUCCESS;
} 
```

[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/tree/164bf9459c519d6c696e4318df62fceab8735320/posix/interactive/sleep_1.c).

输出类似：

```
real    0m1.003s
user    0m0.001s
sys     0m0.003s 
```

这同样适用于在 IO 可用时被阻止的程序。

例如，下面的程序等待用户输入一个字符并按下回车：

```
#include <stdio.h>
#include <stdlib.h>

int main(void) {
    printf("%c\n", getchar());
    return EXIT_SUCCESS;
} 
```

[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/tree/164bf9459c519d6c696e4318df62fceab8735320/c/interactive/getchar.c).

如果您等待大约一秒钟，它会像 sleep 示例一样输出如下内容：

```
real    0m1.003s
user    0m0.001s
sys     0m0.003s 
```

出于这个原因`time`，可以帮助您区分 CPU 和 IO 绑定程序：[“CPU 绑定”和“I/O 绑定”这两个术语是什么意思？](https://stackoverflow.com/questions/868568/what-do-the-terms-cpu-bound-and-i-o-bound-mean/33510470#33510470)

**多线程**

以下示例在线程上执行`niters`无用的纯 CPU 绑定工作的迭代：`nthreads`

```
#define _XOPEN_SOURCE 700
#include <assert.h>
#include <inttypes.h>
#include <pthread.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

uint64_t niters;

void* my_thread(void *arg) {
    uint64_t *argument, i, result;
    argument = (uint64_t *)arg;
    result = *argument;
    for (i = 0; i < niters; ++i) {
        result = (result * result) - (3 * result) + 1;
    }
    *argument = result;
    return NULL;
}

int main(int argc, char **argv) {
    size_t nthreads;
    pthread_t *threads;
    uint64_t rc, i, *thread_args;

    /* CLI args. */
    if (argc > 1) {
        niters = strtoll(argv[1], NULL, 0);
    } else {
        niters = 1000000000;
    }
    if (argc > 2) {
        nthreads = strtoll(argv[2], NULL, 0);
    } else {
        nthreads = 1;
    }
    threads = malloc(nthreads * sizeof(*threads));
    thread_args = malloc(nthreads * sizeof(*thread_args));

    /* Create all threads */
    for (i = 0; i < nthreads; ++i) {
        thread_args[i] = i;
        rc = pthread_create(
            &threads[i],
            NULL,
            my_thread,
            (void*)&thread_args[i]
        );
        assert(rc == 0);
    }

    /* Wait for all threads to complete */
    for (i = 0; i < nthreads; ++i) {
        rc = pthread_join(threads[i], NULL);
        assert(rc == 0);
        printf("%" PRIu64 " %" PRIu64 "\n", i, thread_args[i]);
    }

    free(threads);
    free(thread_args);
    return EXIT_SUCCESS;
} 
```

[GitHub 上游 + 绘图代码](https://github.com/cirosantilli/cpp-cheat/blob/4ec6412223bcaeea48128e0dd0e11f9f320aefba/posix/interactive/pthread_cpu_heavy_work.c)。

然后我们在我的 8 个超线程 CPU 上绘制 wall、user 和 sys 作为固定 10^10 迭代的线程数的函数：

[![在此处输入图像描述](https://i.stack.imgur.com/qAfEe.png)](https://i.stack.imgur.com/qAfEe.png)

[绘制数据](https://gist.github.com/cirosantilli/24a8298a741c3c903a5551aa0740e43c#file-pthread_cpu_heavy_work-dat)。

从图中我们可以看出：

*   对于 CPU 密集型单核应用程序，wall 和 user 差不多

*   对于 2 个内核，用户大约是 2 倍的墙，这意味着用户时间是跨所有线程计算的。

    用户基本翻了一番，而墙保持不变。

*   这会持续到 8 个线程，这与我计算机中的超线程数相匹配。

    8 之后，wall 也开始增加，因为我们没有任何额外的 CPU 可以在给定的时间内投入更多的工作！

    在这一点上，该比率趋于稳定。

请注意，该图之所以如此清晰和简单，是因为该工作纯粹受 CPU 限制：如果它受内存限制，那么我们会在内核更少的情况下更早地获得性能下降，因为内存访问将成为瓶颈，如[What所示术语“CPU 限制”和“I/O 限制”是什么意思？](https://stackoverflow.com/questions/868568/what-do-the-terms-cpu-bound-and-i-o-bound-mean/33510470#33510470)

快速检查 wall < user 是确定程序是多线程的一种简单方法，并且该比率与内核数越接近，并行化越有效，例如：

*   多线程链接器：[链接时 gcc 可以使用多个内核吗？](https://stackoverflow.com/questions/5142753/can-gcc-use-multiple-cores-when-linking/64128746#64128746)
*   C++ 并行排序：[C++17 并行算法是否已经实现？](https://stackoverflow.com/questions/51031060/are-c17-parallel-algorithms-implemented-already/55989883#55989883)

**系统繁重的工作`sendfile`**

我能想到的最重的 sys 工作负载是使用`sendfile`，它在内核空间上执行文件复制操作：[以理智、安全和有效的方式复制文件](https://stackoverflow.com/questions/10195343/copy-a-file-in-a-sane-safe-and-efficient-way)

所以我想象这个内核`memcpy`将是一个 CPU 密集型操作。

首先，我使用以下命令初始化一个 10GiB 的大随机文件：

```
dd if=/dev/urandom of=sendfile.in.tmp bs=1K count=10M 
```

然后运行代码：

```
#define _GNU_SOURCE
#include <assert.h>
#include <fcntl.h>
#include <stdlib.h>
#include <sys/sendfile.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <unistd.h>

int main(int argc, char **argv) {
    char *source_path, *dest_path;
    int source, dest;
    struct stat stat_source;
    if (argc > 1) {
        source_path = argv[1];
    } else {
        source_path = "sendfile.in.tmp";
    }
    if (argc > 2) {
        dest_path = argv[2];
    } else {
        dest_path = "sendfile.out.tmp";
    }
    source = open(source_path, O_RDONLY);
    assert(source != -1);
    dest = open(dest_path, O_WRONLY | O_CREAT | O_TRUNC, S_IRUSR | S_IWUSR);
    assert(dest != -1);
    assert(fstat(source, &stat_source) != -1);
    assert(sendfile(dest, source, 0, stat_source.st_size) != -1);
    assert(close(source) != -1);
    assert(close(dest) != -1);
    return EXIT_SUCCESS;
} 
```

[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/tree/164bf9459c519d6c696e4318df62fceab8735320/glibc/sendfile.c).

这基本上提供了预期的系统时间：

```
real    0m2.175s
user    0m0.001s
sys     0m1.476s 
```

我也很想知道是否`time`会区分不同进程的系统调用，所以我尝试了：

```
time ./sendfile.out sendfile.in1.tmp sendfile.out1.tmp &
time ./sendfile.out sendfile.in2.tmp sendfile.out2.tmp & 
```

结果是：

```
real    0m3.651s
user    0m0.000s
sys     0m1.516s

real    0m4.948s
user    0m0.000s
sys     0m1.562s 
```

两者的 sys 时间与单个进程的时间大致相同，但 wall time 更大，因为这些进程可能会竞争磁盘读取访问。

因此，它似乎确实说明了哪个进程启动了给定的内核工作。

**重击源代码**

当您只`time <cmd>`在 Ubuntu 上执行此操作时，它使用 Bash 关键字，如下所示：

```
type time 
```

输出：

```
time is a shell keyword 
```

所以我们在 Bash 4.19 源代码中 grep source 输出字符串：

```
git grep '"user\b' 
```

这导致我们执行[execute_cmd.c](http://git.savannah.gnu.org/cgit/bash.git/tree/execute_cmd.c?id=b0776d8c49ab4310fa056ce1033985996c5b9807#n1299)函数`time_command`，它使用：

*   `gettimeofday()`如果两者`getrusage()`都可用
*   `times()`除此以外

所有这些都是[Linux 系统调用](https://github.com/torvalds/linux/blob/v4.19/arch/x86/entry/syscalls/syscall_64.tbl)和[POSIX 函数](http://pubs.opengroup.org/onlinepubs/9699919799/idx/functions.html)。

**GNU Coreutils 源代码**

如果我们称它为：

```
/usr/bin/time 
```

然后它使用 GNU Coreutils 实现。

这个有点复杂，但相关来源似乎在[reuse.c](https://git.savannah.gnu.org/gitweb/?p=time.git;a=blob;f=resuse.c;h=41339418a278f0ef66913117964b6d65e836a8f3;hb=ad3684f72903e3720ef3620a422c7989628f2354#l68)并且确实如此：

*   非 POSIX BSD`wait3`调用（如果可用）

*   `times``gettimeofday`否则_

    [1](https://i.stack.imgur.com/qAfEe.png) : [https://i.stack.imgur.com/qAfEe.png**](https://i.stack.imgur.com/qAfEe.png**Minimal)最小可运行 POSIX C 示例**

为了使事情更具体，我想`time`用一些最小的 C 测试程序举例说明一些极端情况。

所有程序都可以编译和运行：

```
gcc -ggdb3 -o main.out -pthread -std=c99 -pedantic-errors -Wall -Wextra main.c
time ./main.out 
```

并已在 Ubuntu 18.10、GCC 8.2.0、glibc 2.28、Linux 内核 4.18、ThinkPad P51 笔记本电脑、Intel Core i7-7820HQ CPU（4 核 / 8 线程）、2x Samsung M471A2K43BB1-CRC RAM（2x 16GiB）中进行了测试。

**睡觉**

非忙碌睡眠不计入任何一个`user`或`sys`仅计入`real`。

例如，一个休眠一秒钟的程序：

```
#define _XOPEN_SOURCE 700
#include <stdlib.h>
#include <unistd.h>

int main(void) {
    sleep(1);
    return EXIT_SUCCESS;
} 
```

[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/tree/164bf9459c519d6c696e4318df62fceab8735320/posix/interactive/sleep_1.c).

输出类似：

```
real    0m1.003s
user    0m0.001s
sys     0m0.003s 
```

这同样适用于在 IO 可用时被阻止的程序。

例如，下面的程序等待用户输入一个字符并按下回车：

```
#include <stdio.h>
#include <stdlib.h>

int main(void) {
    printf("%c\n", getchar());
    return EXIT_SUCCESS;
} 
```

[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/tree/164bf9459c519d6c696e4318df62fceab8735320/c/interactive/getchar.c).

如果您等待大约一秒钟，它会像 sleep 示例一样输出如下内容：

```
real    0m1.003s
user    0m0.001s
sys     0m0.003s 
```

出于这个原因`time`，可以帮助您区分 CPU 和 IO 绑定程序：[“CPU 绑定”和“I/O 绑定”这两个术语是什么意思？](https://stackoverflow.com/questions/868568/what-do-the-terms-cpu-bound-and-i-o-bound-mean/33510470#33510470)

**多线程**

以下示例在线程上执行`niters`无用的纯 CPU 绑定工作的迭代：`nthreads`

```
#define _XOPEN_SOURCE 700
#include <assert.h>
#include <inttypes.h>
#include <pthread.h>
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

uint64_t niters;

void* my_thread(void *arg) {
    uint64_t *argument, i, result;
    argument = (uint64_t *)arg;
    result = *argument;
    for (i = 0; i < niters; ++i) {
        result = (result * result) - (3 * result) + 1;
    }
    *argument = result;
    return NULL;
}

int main(int argc, char **argv) {
    size_t nthreads;
    pthread_t *threads;
    uint64_t rc, i, *thread_args;

    /* CLI args. */
    if (argc > 1) {
        niters = strtoll(argv[1], NULL, 0);
    } else {
        niters = 1000000000;
    }
    if (argc > 2) {
        nthreads = strtoll(argv[2], NULL, 0);
    } else {
        nthreads = 1;
    }
    threads = malloc(nthreads * sizeof(*threads));
    thread_args = malloc(nthreads * sizeof(*thread_args));

    /* Create all threads */
    for (i = 0; i < nthreads; ++i) {
        thread_args[i] = i;
        rc = pthread_create(
            &threads[i],
            NULL,
            my_thread,
            (void*)&thread_args[i]
        );
        assert(rc == 0);
    }

    /* Wait for all threads to complete */
    for (i = 0; i < nthreads; ++i) {
        rc = pthread_join(threads[i], NULL);
        assert(rc == 0);
        printf("%" PRIu64 " %" PRIu64 "\n", i, thread_args[i]);
    }

    free(threads);
    free(thread_args);
    return EXIT_SUCCESS;
} 
```

[GitHub 上游 + 绘图代码](https://github.com/cirosantilli/cpp-cheat/blob/4ec6412223bcaeea48128e0dd0e11f9f320aefba/posix/interactive/pthread_cpu_heavy_work.c)。

然后我们在我的 8 个超线程 CPU 上绘制 wall、user 和 sys 作为固定 10^10 迭代的线程数的函数：

[![在此处输入图像描述](https://i.stack.imgur.com/qAfEe.png)](https://i.stack.imgur.com/qAfEe.png)

[绘制数据](https://gist.github.com/cirosantilli/24a8298a741c3c903a5551aa0740e43c#file-pthread_cpu_heavy_work-dat)。

从图中我们可以看出：

*   对于 CPU 密集型单核应用程序，wall 和 user 差不多

*   对于 2 个内核，用户大约是 2 倍的墙，这意味着用户时间是跨所有线程计算的。

    用户基本翻了一番，而墙保持不变。

*   这会持续到 8 个线程，这与我计算机中的超线程数相匹配。

    8 之后，wall 也开始增加，因为我们没有任何额外的 CPU 可以在给定的时间内投入更多的工作！

    在这一点上，该比率趋于稳定。

请注意，该图之所以如此清晰和简单，是因为该工作纯粹受 CPU 限制：如果它受内存限制，那么我们会在内核更少的情况下更早地获得性能下降，因为内存访问将成为瓶颈，如[What所示术语“CPU 限制”和“I/O 限制”是什么意思？](https://stackoverflow.com/questions/868568/what-do-the-terms-cpu-bound-and-i-o-bound-mean/33510470#33510470)

快速检查 wall < user 是确定程序是多线程的一种简单方法，并且该比率与内核数越接近，并行化越有效，例如：

*   多线程链接器：[链接时 gcc 可以使用多个内核吗？](https://stackoverflow.com/questions/5142753/can-gcc-use-multiple-cores-when-linking/64128746#64128746)
*   C++ 并行排序：[C++17 并行算法是否已经实现？](https://stackoverflow.com/questions/51031060/are-c17-parallel-algorithms-implemented-already/55989883#55989883)

**系统繁重的工作`sendfile`**

我能想到的最重的 sys 工作负载是使用`sendfile`，它在内核空间上执行文件复制操作：[以理智、安全和有效的方式复制文件](https://stackoverflow.com/questions/10195343/copy-a-file-in-a-sane-safe-and-efficient-way)

所以我想象这个内核`memcpy`将是一个 CPU 密集型操作。

首先，我使用以下命令初始化一个 10GiB 的大随机文件：

```
dd if=/dev/urandom of=sendfile.in.tmp bs=1K count=10M 
```

然后运行代码：

```
#define _GNU_SOURCE
#include <assert.h>
#include <fcntl.h>
#include <stdlib.h>
#include <sys/sendfile.h>
#include <sys/stat.h>
#include <sys/types.h>
#include <unistd.h>

int main(int argc, char **argv) {
    char *source_path, *dest_path;
    int source, dest;
    struct stat stat_source;
    if (argc > 1) {
        source_path = argv[1];
    } else {
        source_path = "sendfile.in.tmp";
    }
    if (argc > 2) {
        dest_path = argv[2];
    } else {
        dest_path = "sendfile.out.tmp";
    }
    source = open(source_path, O_RDONLY);
    assert(source != -1);
    dest = open(dest_path, O_WRONLY | O_CREAT | O_TRUNC, S_IRUSR | S_IWUSR);
    assert(dest != -1);
    assert(fstat(source, &stat_source) != -1);
    assert(sendfile(dest, source, 0, stat_source.st_size) != -1);
    assert(close(source) != -1);
    assert(close(dest) != -1);
    return EXIT_SUCCESS;
} 
```

[GitHub 上游](https://github.com/cirosantilli/cpp-cheat/tree/164bf9459c519d6c696e4318df62fceab8735320/glibc/sendfile.c).

这基本上提供了预期的系统时间：

```
real    0m2.175s
user    0m0.001s
sys     0m1.476s 
```

我也很想知道是否`time`会区分不同进程的系统调用，所以我尝试了：

```
time ./sendfile.out sendfile.in1.tmp sendfile.out1.tmp &
time ./sendfile.out sendfile.in2.tmp sendfile.out2.tmp & 
```

结果是：

```
real    0m3.651s
user    0m0.000s
sys     0m1.516s

real    0m4.948s
user    0m0.000s
sys     0m1.562s 
```

两者的 sys 时间与单个进程的时间大致相同，但 wall time 更大，因为这些进程可能会竞争磁盘读取访问。

因此，它似乎确实说明了哪个进程启动了给定的内核工作。

**重击源代码**

当您只`time <cmd>`在 Ubuntu 上执行此操作时，它使用 Bash 关键字，如下所示：

```
type time 
```

输出：

```
time is a shell keyword 
```

所以我们在 Bash 4.19 源代码中 grep source 输出字符串：

```
git grep '"user\b' 
```

这导致我们执行[execute_cmd.c](http://git.savannah.gnu.org/cgit/bash.git/tree/execute_cmd.c?id=b0776d8c49ab4310fa056ce1033985996c5b9807#n1299)函数`time_command`，它使用：

*   `gettimeofday()`如果两者`getrusage()`都可用
*   `times()`除此以外

所有这些都是[Linux 系统调用](https://github.com/torvalds/linux/blob/v4.19/arch/x86/entry/syscalls/syscall_64.tbl)和[POSIX 函数](http://pubs.opengroup.org/onlinepubs/9699919799/idx/functions.html)。

**GNU Coreutils 源代码**

如果我们称它为：

```
/usr/bin/time 
```

然后它使用 GNU Coreutils 实现。

这个有点复杂，但相关来源似乎在[reuse.c](https://git.savannah.gnu.org/gitweb/?p=time.git;a=blob;f=resuse.c;h=41339418a278f0ef66913117964b6d65e836a8f3;hb=ad3684f72903e3720ef3620a422c7989628f2354#l68)并且确实如此：

*   非 POSIX BSD`wait3`调用（如果可用）
*   `times``gettimeofday`否则_

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2010-11-05T04:34:14.573

Real 显示流程的总周转时间；而 User 显示用户定义指令的执行时间，而 Sys 显示执行系统调用的时间！

实时还包括等待时间（I/O 等的等待时间）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-07-19T01:13:15.777

简单来说，我喜欢这样想：

*   `real`是运行命令所花费的实际时间（就像你用秒表计时一样）

*   `user`以及执行命令需要做`sys`多少“工作” 。`CPU`这个“工作”以时间单位表示。

一般来说：

*   `user`是`CPU`为了运行命令的代码而运行的工作量
*   `sys`是为了支持正在运行的命令，必须做多少工作`CPU`来处理“系统开销”类型的任务（例如分配内存、文件 I/O 等）

由于最后两次计算完成的“工作”，因此它们不包括线程可能花费的等待时间（例如等待另一个进程或磁盘 I/O 完成）。

`real`但是，它是对实际运行时间的衡量，而不是“工作”，因此它*确实*包括等待所花费的任何时间。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-10-30T13:50:20.707

当实时比用户+系统大得多时，我想提一些其他场景。我创建了一个简单的服务器，它会在很长一段时间后响应

```
real 4.784
user 0.01s
sys  0.01s 
```

问题在于，在这种情况下，进程等待的响应既不在用户站点也不在系统中。

运行`find`命令时会发生类似的情况。在这种情况下，时间主要花在从 SSD 请求和获取响应上。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2021-08-21T08:12:10.787

必须提一下，至少在我的 AMD Ryzen CPU 上，`user`它总是比`real`多线程程序（或用 编译的单线程程序`-O3`）大。

例如。

```
real    0m5.815s
user    0m8.213s
sys 0m0.473s 
```

# javascript - google.setOnLoadCallback 和 jQuery $(document).ready()，可以混用吗？

> ID：556406
> 
> 赞同：56
> 
> 时间：2009-02-17T11:34:02.970
> 
> 标签：javascript, jquery, onload, google-ajax-api

我正在使用 Google Ajax API，他们建议我`google.setOnLoadCallback()`用来做与他们的 API 相关的各种事情，但我也使用 jQuery`$(document).ready()`做其他与 Google API 无关的 JS 事情。

将这两种方法混合在一个文档中是否安全？我还没有注意到任何问题，但我想这是一个规模问题。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-02-17T11:38:56.547

你几乎必须这样做：

```
google.setOnLoadCallback(function() {
  $(function() {
    // init my stuff
  });
}); 
```

您不能`$(document).ready()`没有`$`（jQuery 对象）可用，因此需要进入回调内部。而且您不能确定文档在回调中是否准备就绪，因此您也必须这样做`ready()`。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2012-10-04T16:25:40.287

很抱歉从死里复活，但1）它仍然是这个问题的“答案”，2）我找到了更好的解决方案。

该函数有一个可选的第三个参数，`google.load`它采用配置选项的对象。选项之一是`callback`。它还消除了单独`setOnLoadCallback`调用的需要。

例如

```
google.load('visualization', '1.0', {
    'packages': "charttype", 
    'callback': $jQ.proxy(me.setupChart, me)
}); 
```

所以：

```
<script src="https://www.google.com/jsapi"></script>
<script>
$(document).ready(function () {
    function mapsLoaded() {
        etc etc etc
    }

    google.load("maps", "2", {"callback" : mapsLoaded});
});
</script> 
```

请参阅： [https ://developers.google.com/loader/#Dynamic](https://developers.google.com/loader/#Dynamic)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-11-12T15:27:03.280

如果您的 JavaScript 代码位于其自己的 js 文件中而不是 HTML 文档中，您也可以在文档中执行此操作：

```
<script>
        google.load("jquery", "1.7.0");
        google.load("jqueryui", "1.8.16");
        google.setOnLoadCallback(function() {
             var script = document.createElement("script");
             script.setAttribute("type", "text/javascript");
             script.setAttribute("src", "my.js");
             document.getElementsByTagName("html")[0].appendChild(script);
        });
</script> 
```

这`my.js`是在从谷歌加载所有其他内容之后加载的。在您的`my.js`文件中，您可以执行`$(document).ready(...)`. 因此，您的应用程序代码独立于“由 google 加载”或“直接从您的服务器加载”。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-06-03T21:20:08.270

当你可以做到这一切时，为什么要混合`$(document).ready()`？只需摆脱该`google.setOnLoadCallback`功能并使用 jQuery 的`$(document).ready()`.

**这：**

```
google.setOnLoadCallback(chartEnrollment); 
```

**变成**

```
$(document).ready(chartEnrollment); 
```

# xml - 使用 DOM 函数在 Flex (AS3) 中创建 XML 字符串

> ID：556408
> 
> 赞同：3
> 
> 时间：2009-02-17T11:34:20.723
> 
> 标签：xml, apache-flex, actionscript-3, dom

我想在 Flex 3 中创建一个 XML 字符串，其方式与您在 Java 中的处理方式类似。我只想要格式的一小段 XML

```
<slide thumb="http://www.thumbs.com/thumb.jpg" type="static" blah="bleh" /> 
```

我能找到的唯一类型的代码似乎很荒谬......

```
private function createXML(): void
{
var xm:XML = <Relyon></Relyon>;
var nodeName:String = “EMPLOYEENAME”;
var nodeValue:String = “KUMAR”;
var xmlList:XMLList = XMLList(”&lt;”+nodeName+”&gt;”+nodeValue+”&lt;/”+nodeName+”&gt;”);
xm.appendChild(xmlList);
Alert.show(xm);
} 
```

我想做类似...

```
var x:XMLNode = new XMLNode("slide");
x.setAttribute("thumb", thumbURL);
x.setAttribute("type", "static"); 
```

这肯定有可能吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-17T11:46:50.023

如果您使用的是 as3，请远离 XMLNode，它是一个遗留类，新的 XML 和 XMLList 类支持出色的 E4X。使用它们就像这样简单：

```
var myXML:XML = <slide />;
myXML.@thumb="http://www.thumbs.com/thumb.jpg";
myXML.@type="static";
myXML.@blah="bleh";
trace("myXML", myXML.toXMLString()); 
```

@ 表示它是一个属性，不使用它会添加子节点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-03T21:13:28.830

这可能会更容易：

```
var thumb:String = "http://www.thumbs.com/thumb.jpg";

var type:String = "static";

var blah:String = "bleh";

var xml:XML =        

          <Relyon>
             <slide thumb={thumb} type={type} blah={blah} />
          </Relyon>;

trace( xml.toXMLString() );

//traces out

 <Relyon>
     <slide thumb="http://www.thumbs.com/thumb.jpg" type="static" blah="bleh"/>
 </Relyon> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-25T11:56:34.920

此外，如果您使用变量作为属性名称，您可以使用

```
var _attName:String = "foo";
myXML.@[_attName] = "bar"; 
```

但你需要把它读回来

```
myXML.@[_attname][0]; 
```

# css - 寻找这些特定的网站主题

> ID：556422
> 
> 赞同：-1
> 
> 时间：2009-02-17T11:38:42.710
> 
> 标签：css, templates, web

我正在寻找根据不同主题对我的网络应用程序进行皮肤处理。所以我想我正在寻找一些 CSS 设计？

如果我能获得类似以下主题的任何链接，那将非常有帮助：

*   沙漠/砂岩/中东
*   绿色/环境/气候变化
*   公司的
*   纯白色背景（Mac-ish 外观）
*   柔和/时髦/营销

我需要沙漠/砂岩/中东主题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-17T11:49:45.850

*   [开源网页设计](http://www.oswd.org/)

*   [开源模板](http://www.opensourcetemplates.org/)

*   [开放式设计](http://www.opendesigns.org/)

*   [模板怪物](http://www.templatemonster.com/)

*   [模板世界](http://www.templateworld.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T12:26:32.703

[Themeforest](http://themeforest.net/category/site-templates/admin-skins)有一个“管理员皮肤”类别——它们比随机网站设计更适合 Web 应用程序布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T11:42:41.297

与[此](https://stackoverflow.com/questions/139487/asp-net-themes-samples-starter-kits)问题不同，但某些答案可能对您有用

例如：

*   [http://www.templateworld.com/free_templates.html](http://www.templateworld.com/free_templates.html)

*   [http://www.styleshout.com/](http://www.styleshout.com/)

*   [http://www.freecsstemplates.org/](http://www.freecsstemplates.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T12:09:35.023

[CSS 禅园](http://www.csszengarden.com/)

一个 html，几十个 CSS 样式表。

[编辑] 该站点演示了如何设置您的 HTML，使其易于样式化，并为您提供了许多如何使用 CSS 实现某些效果的示例。

它更适合设计师而不是“板凳”采摘者。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-21T00:27:59.590

这个像沙漠一样，适合中东的东西。

[http://www.elegantthemes.com/preview/EarthlyTouch/](http://www.elegantthemes.com/preview/EarthlyTouch/)

# c# - C# 中的谓词委托

> ID：556425
> 
> 赞同：268
> 
> 时间：2009-02-17T11:39:13.300
> 
> 标签：c#, .net, predicate

你能给我解释一下吗：

*   什么是谓词委托？
*   我们应该在哪里使用谓词？
*   使用谓词时有什么最佳实践吗？

描述性源代码将不胜感激。

* * *

## 回答 #1

> 赞同：330
> 
> 时间：2009-02-17T11:45:55.377

谓词是返回`true`或的函数`false`。谓词委托是对谓词的引用。

所以基本上谓词委托是对返回`true`或的函数的引用`false`。谓词对于过滤值列表非常有用 - 这是一个示例。

```
using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        List<int> list = new List<int> { 1, 2, 3 };

        Predicate<int> predicate = new Predicate<int>(greaterThanTwo);

        List<int> newList = list.FindAll(predicate);
    }

    static bool greaterThanTwo(int arg)
    {
        return arg > 2;
    }
} 
```

现在，如果您使用 C# 3，您可以使用 lambda 以更简洁的方式表示谓词：

```
using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        List<int> list = new List<int> { 1, 2, 3 };

        List<int> newList = list.FindAll(i => i > 2);
    }
} 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2009-02-17T11:56:23.603

从 Andrew 关于 c#2 和 c#3 的回答开始……您也可以将它们内联以实现一次性搜索功能（见下文）。

```
using System;
using System.Collections.Generic;

class Program
{
    static void Main()
    {
        List<int> list = new List<int> { 1, 2, 3 };

        List<int> newList = list.FindAll(delegate(int arg)
                           {
                               return arg> 2;
                           });
    }
} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-02-17T11:42:33.760

只是一个返回布尔值的委托。它在过滤列表中被大量使用，但可以在任何你喜欢的地方使用。

```
List<DateRangeClass>  myList = new List<DateRangeClass<GetSomeDateRangeArrayToPopulate);
myList.FindAll(x => (x.StartTime <= minDateToReturn && x.EndTime >= maxDateToReturn): 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-02-17T11:49:29.047

[这里](https://web.archive.org/web/20120420194059/http://msdn.microsoft.com/en-gb/magazine/cc163550.aspx)有一篇关于谓词的好文章，虽然它来自 .NET2 时代，所以没有提到 lambda 表达式。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-06-05T12:27:11.660

**什么是谓词委托？**

1）谓词是一个返回真或假的特性。这个概念已经出现在.net 2.0框架中。2) 它与 lambda 表达式 (=>) 一起使用。它将泛型类型作为参数。3) 它允许定义谓词函数并将其作为参数传递给另一个函数。4) 它是 a 的一个特例`Func`，因为它只接受一个参数并且总是返回一个布尔值。

在 C# 命名空间中：

```
namespace System
{   
    public delegate bool Predicate<in T>(T obj);
} 
```

它在 System 命名空间中定义。

**我们应该在哪里使用谓词委托？**

我们应该在以下情况下使用 Predicate Delegate：

1) 用于搜索通用集合中的项目。例如

```
var employeeDetails = employees.Where(o=>o.employeeId == 1237).FirstOrDefault(); 
```

2）缩短代码并返回true或false的基本示例：

```
Predicate<int> isValueOne = x => x == 1; 
```

现在，调用上面的谓词：

```
Console.WriteLine(isValueOne.Invoke(1)); // -- returns true. 
```

3) 匿名方法也可以分配给 Predicate 委托类型，如下所示：

```
Predicate<string> isUpper = delegate(string s) { return s.Equals(s.ToUpper());};
    bool result = isUpper("Hello Chap!!"); 
```

**关于谓词的任何最佳实践？**

使用 Func、Lambda 表达式和委托而不是谓词。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2012-12-20T21:41:40.290

基于谓词的搜索方法允许方法委托或 lambda 表达式来决定给定元素是否是“匹配”。谓词只是一个接受对象并返回真或假的委托： public delegate bool Predicate (T object);

```
 static void Main()
        {
            string[] names = { "Lukasz", "Darek", "Milosz" };
            string match1 = Array.Find(names, delegate(string name) { return name.Contains("L"); });
            //or
            string match2 = Array.Find(names, delegate(string name) { return name.Contains("L"); });
            //or
            string match3 = Array.Find(names, x => x.Contains("L"));

            Console.WriteLine(match1 + " " + match2 + " " + match3);     // Lukasz Lukasz Lukasz
        }
        static bool ContainsL(string name) { return name.Contains("L"); } 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-07-01T18:25:53.900

如果您使用的是 VB 9 (VS2008)，谓词可以是一个复杂的函数：

```
Dim list As New List(Of Integer)(New Integer() {1, 2, 3})
Dim newList = list.FindAll(AddressOf GreaterThanTwo)
...
Function GreaterThanTwo(ByVal item As Integer) As Boolean
    'do some work'
    Return item > 2
End Function 
```

或者，您可以将谓词编写为 lambda，只要它只有一个表达式：

```
Dim list As New List(Of Integer)(New Integer() {1, 2, 3})
Dim newList = list.FindAll(Function(item) item > 2) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-01-14T02:11:31.920

谓词属于 C# 中的泛型委托类别。这是用一个参数调用的，并且总是返回布尔类型。基本上，谓词用于测试条件 - 真/假。许多类支持谓词作为参数。例如，list.findall 需要参数谓词。这是谓词的示例。

想象一个带有签名的函数指针：

```
<modifier> bool delegate myDelegate<in T>(T match); 
```

这是示例：

节点.cs：

```
namespace PredicateExample
{
    class Node
    {
        public string Ip_Address { get; set; }
        public string Node_Name { get; set; }
        public uint Node_Area { get; set; }
    }
} 
```

主类：

```
using System;
using System.Threading;
using System.Collections.Generic;

namespace PredicateExample
{
    class Program
    {
        static void Main(string[] args)
        {
            Predicate<Node> backboneArea = Node =>  Node.Node_Area == 0 ;
            List<Node> Nodes = new List<Node>();
            Nodes.Add(new Node { Ip_Address = "1.1.1.1", Node_Area = 0, Node_Name = "Node1" });
            Nodes.Add(new Node { Ip_Address = "2.2.2.2", Node_Area = 1, Node_Name = "Node2" });
            Nodes.Add(new Node { Ip_Address = "3.3.3.3", Node_Area = 2, Node_Name = "Node3" });
            Nodes.Add(new Node { Ip_Address = "4.4.4.4", Node_Area = 0, Node_Name = "Node4" });
            Nodes.Add(new Node { Ip_Address = "5.5.5.5", Node_Area = 1, Node_Name = "Node5" });
            Nodes.Add(new Node { Ip_Address = "6.6.6.6", Node_Area = 0, Node_Name = "Node6" });
            Nodes.Add(new Node { Ip_Address = "7.7.7.7", Node_Area = 2, Node_Name = "Node7" });

            foreach( var item in Nodes.FindAll(backboneArea))
            {
                Console.WriteLine("Node Name " + item.Node_Name + " Node IP Address " + item.Ip_Address);
            }

            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-11-14T06:33:15.387

简单地说->它们根据主要用于查询的条件提供真/假值。主要用于代表

考虑列表的例子

```
List<Program> blabla= new List<Program>();
        blabla.Add(new Program("shubham", 1));
        blabla.Add(new Program("google", 3));
        blabla.Add(new Program("world",5));
        blabla.Add(new Program("hello", 5));
        blabla.Add(new Program("bye", 2)); 
```

包含姓名和年龄。现在说我们要在条件下查找名称所以我将使用，

```
 Predicate<Program> test = delegate (Program p) { return p.age > 3; };
        List<Program> matches = blabla.FindAll(test);
        Action<Program> print = Console.WriteLine;
        matches.ForEach(print); 
```

试图保持简单！

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2015-08-24T11:00:55.457

委托定义了可用于封装具有特定签名的方法的引用类型。 **C#委托生命周期：C#委托** 的生命周期是

*   宣言
*   实例化
*   度假中

了解更多表格 [http://asp-net-by-parijat.blogspot.in/2015/08/what-is-delegates-in-c-how-to-declare.html](http://asp-net-by-parijat.blogspot.in/2015/08/what-is-delegates-in-c-how-to-declare.html)

# winforms - 设计时错误

> ID：556428
> 
> 赞同：2
> 
> 时间：2009-02-17T11:40:55.777
> 
> 标签：winforms

我在 WINForm 中面临设计时错误。我无法在设计时查看我的控件。我的代码执行得非常好，但我无法查看控件。我收到以下错误：

为了防止在加载设计器之前可能丢失数据，必须解决以下错误：

**“设计器加载器没有提供根组件，但没有说明原因。”**

期待您的合作=合作回应。

问候， 什维塔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T11:44:43.723

这些故障排除很有趣。

如果您转到解决方案资源管理器，将有一个显示所有文件的选项。

从那里开始，当您在表单上打出加号时，不仅会有一个 .cs 文件，还会有一个 .designer.cs 文件。

打开设计器文件，查看是否从编译器收到错误或警告。

如果您有源代码控制，请查看此文件的修订历史记录，如果您出现错误的时间不远，那么您可以隔离导致它的更改。如果您没有源代码控制，那么这将是开始使用它的好时机。

# sql-server - 如何获取 ODBC 驱动程序尝试执行的原始查询？

> ID：556440
> 
> 赞同：2
> 
> 时间：2009-02-17T11:45:34.080
> 
> 标签：sql-server, odbc

我正在使用 C++ 使用 ODBC 查询 SQL Server 2005 数据库。查询包含我使用 SQLSetParam() 设置的参数。我通过调用 SQLExecute() 来运行查询。

有时查询会失败，我需要记录失败的上下文。我正在调用 SQLError() 来获取错误信息，但我还想记录 ODBC 驱动程序尝试运行的原始查询 - 即扩展参数值的查询。任何人都可以建议是否有办法访问这个？

上下文是生产环境中的错误日志记录。错误发生时我不在“那里”，所以我不能使用分析器或类似工具。这就是为什么我想记录尽可能多的信息以供以后分析。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T12:27:21.017

您可以通过控制面板在客户端上启用 ODBC 跟踪，但要为主要的性能损失和要读取的一些非常大的日志文件做好准备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T11:55:56.537

没有。据我了解，这不是 ODBC 的工作方式：参数根本不会“扩展”，而是单独发送到服务器。

对于您的日志记录情况，只需将参数临时转换为字符串并将它们插入语句文本中，然后再将其写入日志文件。这就是我们在框架中的做法，而且效果很好。对于某些参数类型，您必须决定是支持人类可读的日志记录还是可复制粘贴到 sql server 中进行复制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T12:13:39.053

~~使用 SQL Profiler 查看实际发送到服务器的内容？~~

我们的 APP 调用 Sprocs（有点不同），我们记录所有的 Sproc 调用，以及发送了哪些参数；然后，我们使用 Sproc 的返回值更新日志（因此我们可以报告没有返回结果的日志条目，其中存在某种灾难性故障）

然后，我们可以使用给定的参数重新运行任何失败的 SProcs，以查看我们得到的结果。

当我们重新运行它们时，我们用

```
BEGIN TRANSACTION

EXEC MySproc @FOO='BAR', ...

ROLLBACK 
```

这样他们就不会对数据库进行任何更改

# c# - 从 StreamWriter 输出 .txt 文件而不写入磁盘？

> ID：556441
> 
> 赞同：3
> 
> 时间：2009-02-17T11:45:46.217
> 
> 标签：c#, asp.net, .net

有什么方法可以获取 StreamWriter 并将文件（在本例中为 .txt 文件）输出给用户，并可以选择打开/保存而不将文件实际写入磁盘？如果不保存，它基本上会消失。

我正在寻找相同的功能

```
HttpContext.Current.Response.TransmitFile(file); 
```

但无需将任何内容保存到磁盘。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-17T11:49:55.770

试一试`System.IO.MemoryStream`

```
System.IO.MemoryStream ms = new System.IO.MemoryStream();
System.IO.StreamWriter sw = new System.IO.StreamWriter(ms);
sw.Write("hello"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T11:56:37.800

我最近为一个 XML 文件做了这个，你应该很容易适应

```
protected void Page_Load(object sender, EventArgs e)
        {
            Response.Clear();
            Response.AppendHeader("content-disposition", "attachment; filename=myfile.xml");
            Response.ContentType = "text/xml";
            UTF8Encoding encoding = new UTF8Encoding();
            Response.BinaryWrite(encoding.GetBytes("my string"));
            Response.Flush();
            Response.End();
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T11:58:37.340

或使用 Response.BinaryWrite(byte[]);

```
Response.AppendHeader("Content-Disposition", @"Attachment; Filename=MyFile.txt");                                               
Response.ContentType = "plain/text";    
Response.BinaryWrite(textFileBytes); 
```

像这样的东西应该工作。如果您在流中有文本文件，您可以轻松地从中获取 byte[]。

编辑：见上文，但明显更改 ContentType。

# javascript - 为什么此表单无法验证？

> ID：556448
> 
> 赞同：1
> 
> 时间：2009-02-17T11:48:48.037
> 
> 标签：javascript, html, validation

不调用“onsubmit”语句：

```
<form action="index.php" method="post" onsubmit="return validateSearchKeyword()">
        <input class="text_search" id="text_search" name="text_search" type="text" value="search" onfocus="if (this.value=='search') this.value = ''" onBlur="if (this.value=='') this.value = 'search'"  />
    </form> 
```

这是我的验证功能：

```
function validateSearchKeyword()
{ alert ('sad');//for testing purposes - this alert is not showed
if (document.getElementById('text_search').value==""){creatediv('divWarnSearch','You must supply a value', '120px', '250px');return false;}
} 
```

函数*creatediv*与其他形式一起工作得很好，所以问题不在于那个。

有任何想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T11:52:18.060

您缺少提交按钮，这可能会导致用户无法在某些浏览器中提交表单。

此外，如果您可以发布您的验证函数会很有帮助，这样我们就可以检查是否存在问题，例如它是否返回布尔值？

如果您使用以下内容，您会得到什么结果：

```
<form ... onsubmit="alert('Foo'); return true"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-17T12:16:01.590

检查以确保您正在调用的函数确实存在，然后我将通过该函数来检查问题。Firebug 可能对您有用，或者您可以将以下内容粘贴在被调用函数的顶部（以确保它走得那么远）：

```
alert('here'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T14:26:39.327

你的问题是：

```
onBlur="if (this.value=='') this.value = 'search'" 
```

当您提交时，您失去了对文本框的关注并启动了事件：尝试放置

```
alert(document.getElementById('text_search').value); 
```

你会得到“搜索”而不是空字符串......

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-17T11:54:35.293

试过了`onsubmit="javascript: validateSearchKeyword();"`吗？AFAIK，它已经返回，无需指定。

您也可以尝试删除 ()。

而且，[正如马铃薯头先生](https://stackoverflow.com/questions/556448/why-wont-this-form-validate/556460#556460)所说，如果您没有删除它以使代码简洁，那么提交按钮。

编辑：这是一个经过深思熟虑的帖子。这是不该做什么的一个很好的例子。如果您发现在您的代码中实现了这些建议中的任何一个，请重构！

# .net - 如何递归调用 MSBuild 中的任务？

> ID：556449
> 
> 赞同：3
> 
> 时间：2009-02-17T11:48:56.070
> 
> 标签：.net, msbuild, build-process, msbuild-task

例如，我想每次调用这些脚本传递差异参数：

```
<ItemGroup> 
        <SqlFiles Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\Tables\*.sql" /> 
        <SqlFiles Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\Functions\*.sql" /> 
        <SqlFiles Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\Views\*.sql" /> 
        <SqlFiles Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\ForeignKeys\*.sql" /> 
        <SqlFiles Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\StoredProcedures\*.sql" /> 
        <SqlFiles Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\Data\*.sql" /> 
</ItemGroup> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-17T13:34:07.940

您可以通过使用带有*Properties的***MSBuild Task**来实现。

 *```
<!-- Dont itemize sql files now, if you want to differenciate the task operations -->
<ItemGroup> 
  <SqlDirs Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\Tables" /> 
  <SqlDirs Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\Functions" /> 
  <SqlDirs Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\Views" /> 
  <SqlDirs Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\ForeignKeys" /> 
  <SqlDirs Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\StoredProcedures" /> 
  <SqlDirs Include="$(SourceServicesDbSqlRootDir)CreateScripts\$(SourceServiceName)\Data" /> 
</ItemGroup>

<Target Name="MainTask">
  <MSBuild Projects="$(MSBuildProjectFile)" 
           Properties="SqlDir=%(SqlDirs.Fullpath)"
           Targets="RecursivelyCalledTask">
    <Output ItemName="ProjSources" TaskParameter="TargetOutputs"/>
  </MSBuild>
</Target>

<Target Name="RecursivelyCalledTask">
  <!-- We create here the SqlFiles items based on SqlDir-->
  <CreateItem Include="$(SqlDir)\*.sql">
    <Output ItemName="SqlFiles" TaskParameter="Include"/>
  </CreateItem>

  <Message Text="SqlFiles -> @(SqlFiles)"/>
</Target> 
```

# lisp - 在 Lisp 中进行（严肃的）Web 开发是否可行？

> ID：556456
> 
> 赞同：101
> 
> 时间：2009-02-17T11:50:26.270
> 
> 标签：lisp

显然，几乎可以用几乎任何编程语言编写几乎任何类型的应用程序，尤其是像 Lisp 这样强大的语言（无论是 Scheme 还是 Common Lisp）。但是将它用于 Web 开发是否实用？如果是这样，什么应该是一个好的起点？在哪里可以找到适合此类项目的资源（工具、库、文档、最佳实践、示例等）？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-02-17T12:41:02.340

是的，Web 开发是当今 Common Lisp 的优势之一。

*   作为 Web 服务器，请使用Edmund Weitz 博士的[Hunchentoot](http://weitz.de/hunchentoot/)，以前称为 tbnl。

    您可以使用 mod_proxy 作为反向代理或作为独立服务器将其作为 Apache 的后端运行。

*   可以使用各种 HTML 生成解决方案，从 PHP 样式模板到 Lisp 宏 hack 再到 XSLT。随便挑吧。

    [HTML-TEMPLATE](http://weitz.de/html-template/)就是一个例子。

*   [Closure XML](http://common-lisp.net/project/cxml)可用于 XML 解析、序列化、XPath 1.0、XSLT 1.0。还有用于 HTML 标签汤解析的 Closure HTML。

    （完全披露：我是 Closure XML 和 Closure HTML 的维护者。）

*   如果你愿意，[Parenscript](http://common-lisp.net/project/parenscript/)可以让你的 JavaScript 体验更流畅，当然你也可以自己编写普通的旧 JavaScript。

    [jwacs](http://chumsley.org/jwacs/)中另一个很酷的 JavaScript 增强解决方案，它是用 Common Lisp 编写的，并转换 JavaScript 以添加延续支持。

*   除了服务器之外，Web 服务项目可能还需要 HTTP 客户端。

    [Drakma](http://weitz.de/drakma/)是今天使用的库。

    [PURI](http://www.cliki.net/Puri)对于 URI 操作很有用。

    还有更多！一个起点是 cliki，例如[cliki.net/web](http://www.cliki.net/web)。

在网络上，没有人知道你的服务器是用 Common Lisp 编写的 :-)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-17T16:53:25.073

Common Lisp 中的 Web 开发既有效又有趣。

一些例子：

[CL-WHO](http://weitz.de/cl-who)允许您编写 HTML 而不会再次忘记结束标记。

[Weblocks](http://weblocks.viridian-project.de/)允许您使用内置验证以声明方式定义表单：

```
(defview signup (:type form :caption "Sign up")
  (username :satisfies #'valid-username)
  (password :present-as dual-password :parse-as dual-password)
  (receive-newsletter-p :present-as checkbox :parse-as predicate)) 
```

它还以全自动方式支持 AJAX，如果浏览器不支持它，则回退到正常链接。

[cl-prevalence](http://common-lisp.net/project/cl-prevalence/)是 SQL 的一个非常简单的替代方案。

相当多的人最近将这些技术用于任务关键型应用程序——并取得了成功。

事实上，最重要的 CL 开源项目确实有出色的社区支持。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-02-17T12:05:05.813

有一些用于 Web 开发的 Web 框架。看一下：

*   [Weblocks](http://common-lisp.net/project/cl-weblocks/) (Common Lisp)
*   [复合词](http://github.com/weavejester/compojure/tree/master)(Clojure)

如果您想要得到良好支持的 lisp 工具，那么您需要为它们付费。开源工具周围没有一个很大的社区，因此它们没有与 Python 上的 Django 相同级别的文档/采用。

以下是一些商业 lisp 产品：

*   [Lispworks](http://www.lispworks.com/)
*   [弗朗茨快板 CL](http://www.franz.com/products/)

同样值得注意的是，Reddit 最初是用 Lisp 构建的，但作者后来迁移到 Python，理由是缺乏使用良好和文档化的库。（[链接](http://blog.reddit.com/2005/12/on-lisp.html)）

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-02-20T18:40:55.370

我无法与其他框架交谈，但我非常幸运地将[Hunchentoot](http://weitz.de/hunchentoot/)用于网络服务器（它本身可以正常工作，或者您可以[将它放在 Apache 后面](http://www.newartisans.com/blog/2007/11/running-common-lisp-behind-apache.html)）。真正让它大放异彩的（这可能会让一些人感到震惊）是图书馆！

*   使用[CL-WHO](http://weitz.de/cl-who/)以 lisp 样式的语法轻松编写 HTML
*   [Parenscript](http://common-lisp.net/project/parenscript/)允许您编写编译为 javascript 的代码
*   对于数据库连接，使用[Postmodern](http://common-lisp.net/project/postmodern/)与[PostgreSQL对话](http://www.postgresql.org/)

我真正喜欢将 CL 用于 Web 的地方在于，您可以在它运行时对其进行调整。您总是有一个 REPL 启动并运行您的服务器代码，然后您可以连接到该 REPL 并更改或检查代码的工作方式，而无需停止任何事情。我在站点运行时重新定义了函数，下次调用该函数时，它只会获取新代码并开始工作。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-03-02T06:04:37.147

为了进一步帮助消除没有 Lisp Web 框架的神话，以下是尚未提及的框架：

*   [不常见的网络](http://common-lisp.net/project/ucw/)
*   [BKNR](http://bknr.net/html/home.html)
*   [AllegroServe 的网络操作](http://opensource.franz.com/aserve/)

显然，很多人似乎认为 Lisp 足以编写很多 Web 框架。

我不使用或认可任何网络框架。我更喜欢通过将正交工具（David Lichteblau 提到了一些好的工具）组合在一起来构建 Web 应用程序，使用设计模式以实际上适合您正在构建的应用程序的方式，这就是我推荐的方法。Common Lisp 提供了丰富的此类工具，以及无与伦比的组合它们的能力。

Adam Petersen 去年发布了一篇关于如何开始以这种风格构建 Lisp Web 应用程序的优秀入门教程：

[http://www.adampetersen.se/articles/lispweb.htm](http://www.adampetersen.se/articles/lispweb.htm)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-17T11:56:28.173

我认为一个人可以毫不费力地说“是”。

1.  第一个 HTTP 服务器之一是[cl-http](http://www.cl-http.org:8001/cl-http/)

2.  [DrScheme](http://www.cs.brown.edu/~sk/Publications/Papers/Published/khmgpf-impl-use-plt-web-server-journal/)周围的计划人员为此花费了大量时间：

3.  www.franz.com 运行在自己的网络服务器（AllegroServer）和网络框架（webactions）上

4.  如果您有疑问，请查看 Edi Weitz 提供的 common lisp 包。他们通常工作。

所以是的，可以使用 Common Lisp 进行“严肃的”网络编程。就我而言，我目前尚未决定遵循一些 Common Lisp 路线或 Ruby on Rails。我更喜欢两者都胜过任何.NET....

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-17T11:52:56.763

[Paul Graham 的](http://www.paulgraham.com/)公司 Viaweb用 Common Lisp[编写了一个产品](http://www.paulgraham.com/avg.html)，后来变成了 Yahoo Shops。显然，雅虎随后用 C++ 重新编写了它。Lisp 编程有很多网络资源。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-17T11:55:07.287

[你可以在这个问题](https://stackoverflow.com/questions/451329/what-is-the-preferred-way-to-run-lisp-web-application/451461)中找到一些关于 Lisp Web 应用程序工具的东西。

[听听Stack Overflow Podcast 27](https://blog.stackoverflow.com/2008/10/podcast-27/)可能也值得一听，Reddit 的人在其中谈了一些他们在 Lisp 上运行网站的经历（以及他们转向 Python）。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-02-17T12:02:35.193

意见不一。普遍的看法是：最好使用不同的语言，或者更确切地说是不同的 Web 堆栈，例如 LAMP、.NET、Ruby on Rails、Java。lisp 中著名的成功 Web 项目是 Paul Graham 的[ViaWeb](http://www.paulgraham.com/avg.html)。[Reddit](http://www.reddit.com/)最初是用 lisp 实现的，但后来[切换到 python](http://blog.reddit.com/2005/12/on-lisp.html)。如果您决定使用 lisp，请尝试 Seibel 的书：[Practical Common Lisp](http://www.gigamonkeys.com/book/)。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-17T19:25:25.067

看起来很多 Orbitz[是用 LISP 编写的](http://www.paulgraham.com/carl.html)。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-17T11:54:17.430

看看 Allegro Common Lisp。它有一些库，包括一个 Web 服务器，专门用于 Web 开发。

# language-agnostic - 语言什么时候消亡？

> ID：556472
> 
> 赞同：4
> 
> 时间：2009-02-17T11:55:02.047
> 
> 标签：language-agnostic

编程语言何时消亡？

当所有语言的作者都反对它时，它会踢水桶吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-17T11:58:46.873

对于口语，有几个定义：（1）没有人会说这种语言，或者（2）没有人使用这种语言作为他们的主要语言。您可以将相同的标准应用于编程语言。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T11:58:03.303

这取决于您对“死亡”的定义：

*   当它不再改变/改善时
*   当没有人再使用它时
*   当没有人可以阅读时
*   当最后一个用该语言编写的文档消失时（否则，有人可能会从中学习该语言）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T11:58:07.390

当没有人使用它时。或者你认为开始使用英语的人还在？:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T12:47:41.093

当没有在相对现代的平台上工作的工具（编译器、库）时，编程语言就会消亡。然后除了老式平台，没有人可以使用该语言。

“当没有人使用它”不是很好的定义——你怎么*知道*没有人使用它？你不能。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T13:13:01.157

我们喜欢认为一种语言在停止维护时已经死亡。然而，现实情况是，当没有任何软件可用时，一种语言就会消亡。只要该软件仍然存在，就必须有人在某个时候对其进行维护。我对此不是 100% 确定的，但我猜想这个定义已经死掉的语言很少（如果有的话）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T13:50:16.543

据我的拉丁老师说：从来没有。;-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-09-12T15:12:44.307

只要编译器和运行程序的计算机仍在使用，编程语言就永远不会真正消亡。

在实践中，当作者停止维护一种编程语言时，它就开始消亡，而当人们停止编写新程序时，它实际上已经消亡。旧程序是否仍在运行并不重要，因为运行程序不需要源代码。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-17T13:06:26.647

直到两位作者都停止维护编程语言并且社区转向其他工具之前，编程语言才不会消亡。例如，微软已经宣布 VB6 已死，但仍有许多使用 VB6 的活跃实现。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-17T13:17:52.330

IMO，在计算机语言的背景下，当没有人说“这很容易解决”的问题时，一种语言就真的死了

使用语言不再简单的原因有很多：

*   没有人知道语法了
*   编译器不适用于您可用的机器
*   编译器不会为目标机器创建对象/可执行文件

可能还有其他人，但那些是浮现在脑海中的。

这究竟是什么时候发生的很难知道，但它以前发生过，而且还会再次发生。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-17T14:49:55.823

古老的语言永远不会消亡，它们只会[逐渐消失](http://www.bartleby.com/59/3/oldsoldiersn.html)......

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-17T14:03:17.340

我会说两个条件：

*   没有人为新项目选择这种语言。
*   没有更新/改进语言的计划。

如果这两个都是真的，那么使用该语言的项目数量只能下降到零。

然而，如果人们仍在使用它来解决新问题，那么在某些时候可能会有改进它的动力。如果有人仍在努力改进它，那么人们可能会再次开始使用它。

# java - 设计 GUI 的重要提示？

> ID：556478
> 
> 赞同：21
> 
> 时间：2009-02-17T11:56:18.453
> 
> 标签：java, user-interface, swing

不久前，我读了（在我失去它之前）一本名为[GUI Bloopers的好书，里面充满了](http://www.gui-bloopers.com/)[糟糕的 GUI 设计](https://stackoverflow.com/questions/238177/worst-ui-youve-ever-used)的例子，但也充满了有用的花絮，比如*Don't call something a* `Dialog` *one minute and a* `Popup` *next*。

您会为设计/记录 GUI 提供哪些重要提示？了解您设计用于将可读信息塞入尽可能小的屏幕空间的小部件将特别有用。

我将用我自己的一个来解决这个问题：**避免树**（例如 Swing's `JTree`），除非你真的无法避免它，或者有一个无限的层次结构。我发现用户不觉得它们很直观，而且很难导航和过滤。

PS。我认为这个问题与这个问题不同，[因为](https://stackoverflow.com/questions/136910/gui-design-how-do-you-do-it)我要求的是通才技巧

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-17T12:08:46.227

好吧，我个人遵循这些简单的规则：

*   在整个应用程序中保持一致**不要改变行为/布局**
*   信息流：从上到下从左到右（西方国家）
*   页面上没有太多信息（如 ppt 演示文稿）
*   大写字母（所以老人也可以阅读）
*   KISS（任何可以使用录像机的人都可以使用此页面/表格/等）
*   使用蓝色、绿色等轻松的颜色（不是鲜红色或霓虹粉色）
*   结构（当然可以改变，但主要是初稿）：
    *   顶部 -> 导航/菜单
    *   左 -> 导航/信息
    *   中间 -> 内容
    *   底部->状态
    *   右下角 -> 按钮

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-02-17T15:46:56.077

我曾经从一位熟练的 GUI 技术主管那里得到一个相当具体的提示：

当您有一个带有按钮、文本字段、列表等的对话框/表单时，请尽量保持它们之间的空间一致和对称。例如，尝试在所有方向上使用相同的小部件之间的距离，如果通过增加组之间的空间将一组小部件与另一组分开，则尝试使该空间与组内控件之间的空间重复。例如，如果一个部分中的所有按钮在各个方向上相隔 16 像素，请尝试为下一组 32、64、128 左右像素留出更大的空间。

对于人眼来说，解释具有明显对称性的东西要舒服得多。

自从我尝试后，我总是使用这种方法，效果非常好。我什至返回并重新设计了旧的 GUI，并且惊讶地看到仅从这次调整中得到了如此大的改观。

**编辑：**

忘了提到我从上述方法中学到的一个重要教训：

当你根据这个系统安排所有小部件时（特别是在改造旧的杂乱的 GUI 时）你可能会用完空间，并且你的对话框需要膨胀。在某些时候，人们会感觉到对话框变得太大（例如，阻止相关的背景 GUI 或相关的小部件最终彼此相距太远）。这可能是一个很好的指标，您可能应该将对话框拆分为选项卡，将内容移动到菜单中，或者只是将其变成向导式的概念等。

这与小部件间距无关，但触及了用户在任何给定时间进行交互的“少即是多”的主题。有趣的是，当你开始做正确的事情时，它会“激起涟漪”，有时会迫使你做更多的事情（有点像修复 const 正确性 :p ）。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-17T12:18:49.167

我的首要建议是从 GUI 开发人员的角度

## 保持简洁

如果你的意思是从可用性的角度

## 尽快展示给实际用户，并根据反馈进行改进

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-17T12:53:36.943

一旦你完成了设计：让几个人坐在你的软件前面，让他们尝试解决你的软件设计的任务（一个接一个，而不是一次性完成......）。仅仅通过观看它们，您将学到的东西绝对是惊人的。

如果可能，测试人员应与您的典型客户群的配置文件相匹配。为这种可用性测试找到的人越多越好，但在过去，即使每次产品迭代只观察少数人对我来说也非常有用。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2010-06-10T21:20:57.497

请记住，用户的目标不是使用您的程序。他们的目标是另一回事，而您的程序只是帮助他们实现该目标的工具。尽你最大的努力让他们成功和快乐。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-17T15:22:29.927

不要更改默认颜色。**这对色盲**的人很重要。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-02-17T15:04:03.183

为了解决您对 JTree 的问题（我同意），如果您希望在您的应用程序中实现良好的 JList 和 JTable 交互，您应该考虑使用 glazed 列表： [http ://publicobject.com/glazedlists/](http://publicobject.com/glazedlists/)

通过对代码进行一些调整，您可以获得很多功能（例如，可排序的表头）。

除此之外，保持简单。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-17T12:14:54.230

我认为在这个狭小的空间里，不可能给出可以设计好的 GUI 的提示（问题就像“我怎样才能写出好的程序？”一样大）。但我可以指点一些有用的书：

*   [日常用品的设计](https://rads.stackoverflow.com/amzn/click/com/0385267746)
*   [关于面](https://rads.stackoverflow.com/amzn/click/com/0470084111)
*   [用户界面设计：软件工程视角](https://rads.stackoverflow.com/amzn/click/com/0321181433)
*   [可用性工程](https://rads.stackoverflow.com/amzn/click/com/0125184069)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-06-10T21:05:19.323

使用尽可能少的 UI。

我想我们忘记了计算机是信息*机器*，即它们是*为我们工作的*。

见过 iPhone 上的 Shazam 吗？它几乎只有一个按钮。您按下它，将手机靠近播放歌曲的扬声器，大约 10 秒钟后它会告诉您正在播放的歌曲。

非常有用，几乎没有 UI。所有艰苦的工作都在下面进行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-06-10T21:24:05.577

[Joel Spolsky 的用户界面设计](https://rads.stackoverflow.com/amzn/click/com/1893115941)。一个下午就可以读完。

# asp.net - 清除匿名身份？

> ID：556483
> 
> 赞同：2
> 
> 时间：2009-02-17T11:56:29.937
> 
> 标签：asp.net, anonymous

是否有清除匿名 cookie 的 API？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-24T22:49:46.440

是的！

```
 System.Web.Security.AnonymousIdentificationModule.ClearAnonymousIdentifier() 
```

请参阅这篇[有用的文章](http://odetocode.com/articles/440.aspx)：（迁移匿名用户设置）

也是[迁移匿名配置文件](https://stackoverflow.com/questions/1660999/best-way-to-migrate-anonymous-profile)stackoverflow 问题的最佳方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-29T06:52:45.610

最初，我遇到了“AnonymousIdentificationModule.ClearAnonymousIdentifier()”的问题。错误是“禁用该功能或​​用户匿名时不支持 ClearAnonymousIdentifier。”

仅当用户 itsef 是匿名用户时尝试清除匿名标识符时才会出现此问题。表示匿名用户无法清除其他匿名用户的 cookie。

为此，请在用户通过身份验证（登录用户）的情况下放置代码，例如：

```
if(Request.IsAuthenticated)
{
   AnonymousIdentificationModule.ClearAnonymousIdentifier();
} 
```

这会成功的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T20:30:36.203

我正在使用 MVC4，在我的场景中，我希望能够删除匿名 cookie，以便即使用户从未登录也会自动生成一个新的 cookie。（这样测试人员不必每次都删除他们的 cookie他们想以新用户身份返回站点的时间。） AnonymousIdentificationModule.ClearAnonymousIdentifier 在这种情况下不起作用，因为您只能在用户通过身份验证时调用它。（似乎该函数的可选参数会很好。）因此，或者您必须使用过去的到期日期重写匿名 cookie。我通过创建一个基本的操作方法来做到这一点，匿名用户可以随时访问并以新的匿名用户身份重新启动：

```
 [HttpGet]
    [AllowAnonymous]
    public ActionResult ClearMyCookie()
    {
        HttpCookie cookie = new HttpCookie(".ASPXANONYMOUS");
        cookie.Expires = DateTime.Now.AddDays(-10);
        Response.Cookies.Add(cookie);
        // Make sure to also do Session.Clear() if you're using session.
        return RedirectToAction("index", "home");
    } 
```

将“.ASPXANONYMOUS”更改为您的 cookie 名称。我使用上面的默认匿名名称。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-17T12:46:34.467

我不确定这是否是您所要求的，但您可以清除发送到浏览器的所有 cookie，如下所示：

```
Response.Cookies.Clear(); 
```

如果您遇到身份验证问题，您可能需要澄清问题。

# c# - 与 Windows 服务通信的最快方法

> ID：556488
> 
> 赞同：9
> 
> 时间：2009-02-17T11:57:09.530
> 
> 标签：c#, .net, wcf, service

我们正在运行一项需要与另一个进程快速通信的服务。目前，我们在缓冲模式下使用 WCF NetNamedPipeBinding 来调用服务中的方法，这似乎提供了可用 WCF 绑定的最少开销。有没有更快的方法使用托管代码来做到这一点？

编辑：如下建议的捆绑请求是已经考虑的选项。真的，我们想知道是否存在用于进程间通信的替代 API，其性能优于使用命名管道的 WCF。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-17T12:06:03.470

如果您使用的是 WCF，那么命名管道是在本地系统上进行通信的最快方式。

如果您要抛出大量数据，那么您可以考虑流式传输您的 API（只需添加 System.IO.Stream 作为参数，而不是传递数组或字符串等）

同样对于性能，您的托管模型对于您的服务实例模式也非常重要。Juval Lowy 的关于 WCF 的书实际上非常好，当您通过代码示例进入他的书的内容时。

编辑：针对您的评论，请查看您可以应用于服务定义的“ServiceBehaviour”属性。（不是您的 IServiceInterface 描述，而是您的类的具体实现）。

您可以通过 PerCall、PerSession 或 Singleton 将代码定义为实例。默认是~~单例~~PerSession（感谢@RichardOD），并发模式设置为单，instanceContextMode 设置为 true，这允许您在 Windows 窗体上托管 WCF，并且如果您不了解实例化，可以防止您自责。

基本上，如果您将其保留为默认值，您最终会得到一个单线程、按顺序处理的 WCF 主机。

MSDN 有一些关于每种类型的作用的合理信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T11:59:11.897

那么，您是受容量限制（即大消息）还是往返限制（大量小消息）？

对于大消息，请考虑压缩（如果网络 IO 是开销）或更有效的序列化，例如 protobuf-net。

对于聊天 API，请考虑将消息打包以减少往返次数。

# c# - 如何在异常发生之前检测到导致异常的情况？

> ID：556494
> 
> 赞同：4
> 
> 时间：2009-02-17T11:58:09.247
> 
> 标签：c#, sql-server, ado.net, connection-pooling, application-role

[我对这个问题](https://stackoverflow.com/questions/553331/detecting-unusable-pooled-sqlconnections)没有运气，所以我制作了这个尽可能简单的测试用例来证明这个问题。

在下面的代码中，是否可以在尝试使用之前检测到连接不可用？

```
 SqlConnection c = new SqlConnection(myConnString);

    c.Open();  // creates pool

    setAppRole(c);  // OK

    c.Close(); // returns connection to pool

    c = new SqlConnection(myConnString); // gets connection from pool

    c.Open(); // ok... but wait for it...

    // ??? How to detect KABOOM before it happens?

    setAppRole(c); // KABOOM 
```

KABOOM 在 Windows 事件日志中显示为错误；

> 连接已被删除，因为打开它的主体随后假定了一个新的安全上下文，然后尝试在其模拟的安全上下文下重置连接。不支持此方案。请参阅联机丛书中的“模拟概述”。

...加上代码中的异常。

setAppRole 是一种在连接上设置应用程序角色的简单方法。它类似于这个...

```
static void setAppRole(SqlConnection conn) {

    using (IDbCommand cmd = conn.CreateCommand())
        {
            cmd.CommandType = CommandType.Text;
            cmd.CommandText = "exec sp_setapprole ";
            cmd.CommandText += string.Format("@rolename='{0}'",myUser);
            cmd.CommandText += string.Format(",@password='{0}'",myPassword);
            cmd.ExecuteNonQuery();
        }
    } 
```

在实际代码中，尝试在关闭连接之前使用**sp_unsetapprole**，但不能始终保证（继承的有缺陷的多线程应用程序）。无论如何，期望能够在引起爆炸之前检测到爆炸似乎仍然是合理的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T16:00:18.977

简而言之，它看起来不像你可以以任何简单的方式。

我的第一个想法是运行这个 SQL：

```
SELECT CASE WHEN USER = 'MyAppRole' THEN 1 ELSE 0 END 
```

这在您使用 SQL Server Management Studio 时有效，但在您从 C# 代码运行时会失败。问题是在调用 sp_setapprole 时不会发生您遇到的错误，它实际上是在连接池调用 sp_reset_connection 时发生的。当您第一次使用连接并且没有办法在它之前进入时，连接池会调用它。

所以我猜你有四个选择：

1.  通过添加“Pooling=false;”关闭连接池 到您的连接字符串。
2.  使用其他方式连接到 SQL Server。有比 ADO.Net 更低级别的 API，但坦率地说，这可能不值得麻烦。
3.  正如 casperOne 所说，您可以修复代码以正确关闭连接。
4.  捕获异常并重置连接池。不过，我不确定这会对其他打开的连接产生什么影响。下面的示例代码：

```
class Program
{
    static void Main(string[] args)
    {
        SqlConnection conn = new SqlConnection("Server=(local);Database=Test;UID=Scrap;PWD=password;");

        setAppRole(conn);
        conn.Close();

        setAppRole(conn);
        conn.Close();
    }

    static void setAppRole(SqlConnection conn) 
    {
        for (int i = 0; i < 2; i++)
        {
            conn.Open();
            try
            {
                using (IDbCommand cmd = conn.CreateCommand())
                {
                    cmd.CommandType = CommandType.Text;
                    cmd.CommandText = "exec sp_setapprole ";
                    cmd.CommandText += string.Format("@rolename='{0}'", "MyAppRole");
                    cmd.CommandText += string.Format(",@password='{0}'", "password1");
                    cmd.ExecuteNonQuery();
                }
            }
            catch (SqlException ex)
            {
                if (i == 0 && ex.Number == 0)
                {
                    conn.Close();
                    SqlConnection.ClearPool(conn);
                    continue;
                }
                else
                {
                    throw;
                }
            }
            return;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-10-13T17:59:19.693

> 它实际上是在连接池调用 sp_reset_connection 时发生的。当您第一次使用连接并且没有办法在它之前进入时，连接池会调用它。

根据[Martin Brown 的回答](https://stackoverflow.com/questions/556494/how-can-i-detect-condition-that-causes-exception-before-it-happens/557514#557514)，您可以尝试将“Connection Reset=False”添加到连接字符串中，作为“进入之前”sp_reset_connection 的一种方式。（有关此设置的许多缺点的说明，请参阅“[使用“脏”连接](http://betav.com/blog/billva/2007/05/managing_and_monitoring_net_co.html)”。）

Your problem is a [known issue with connection pooling](http://support.microsoft.com/kb/229564). The suggested work-around is to disable connection pooling... if this is a desktop app it may be worth considering holding a few connections open instead (also explained in [the article linked above](http://betav.com/blog/billva/2007/05/managing_and_monitoring_net_co.html)).

These days (SQL 2005+) the recommendation (under [Application Roles and Connection Pooling](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)) is to "take advantage of the [new security mechanisms](http://msdn.microsoft.com/en-us/library/bb669062.aspx) that you can use instead of application roles", like EXECUTE AS.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T12:32:01.410

我不确定你的问题，但我认为如果你创建新的连接对象而不是重用它们，你会避免它。所以而不是做

```
c.Open();
blabla;
c.Close();
c.Open(); 
kaboom... 
```

您将执行以下操作：

```
using (new SqlConnection ...)
{
  c.Open();
  blabla;
}

using (new SqlConnection ... )
{
  c.Open();
  no kaboom?
} 
```

（请原谅伪代码...我eeepc上的键盘无法使用...）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T15:30:14.900

没有办法清除所有连接的池。SqlPools.Clear 什么的。

您可以简单地尝试捕获异常并创建一个新连接，这应该会强制池创建一个完整的新连接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-17T16:02:05.277

我也发布了这个来回答你之前的问题。调用 sp_setapprole 时，您应该在完成后调用 sp_unsetapprole，我提出的解决方案将帮助您：

[检测不可用的池化 SqlConnections](https://stackoverflow.com/questions/553331/detecting-unusable-pooled-sqlconnections/557515#557515)

* * *

看起来您正在调用 sp_setapprole 但没有调用 sp_unsetapprole 然后让连接返回到池中。

我建议使用带有 IDisposable 实现的结构（或类，如果您必须跨方法使用它），它将为您解决这个问题：

```
public struct ConnectionManager : IDisposable
{
    // The backing for the connection.
    private SqlConnection connection;

    // The connection.
    public SqlConnection Connection { get { return connection; } }

    public void Dispose()
    {
        // If there is no connection, get out.
        if (connection == null)
        {
            // Get out.
            return;
        }

        // Make sure connection is cleaned up.
        using (SqlConnection c = connection)
        {
            // See (1).  Create the command for sp_unsetapprole
            // and then execute.
            using (SqlCommand command = ...)
            {
                // Execute the command.
                command.ExecuteNonQuery();
            }
        }
    }

    public ConnectionManager Release()
    {
        // Create a copy to return.
        ConnectionManager retVal = this;

        // Set the connection to null.
        retVal.connection = null;

        // Return the copy.
        return retVal;        
    }

    public static ConnectionManager Create()
    {
        // Create the return value, use a using statement.
        using (ConnectionManager cm = new ConnectionManager())
        {
            // Create the connection and assign here.
            // See (2).
            cm.connection = ...

            // Create the command to call sp_setapprole here.
            using (SqlCommand command = ...)
            {
                // Execute the command.
                command.ExecuteNonQuery();

                // Return the connection, but call release
                // so the connection is still live on return.
                return cm.Release();
            }
        }
    }
} 
```

1.  您将创建与调用 sp_setapprole 存储过程相对应的 SqlCommand。您也可以生成 cookie 并将其存储在私有成员变量中。
2.  这是您创建连接的地方。

客户端代码如下所示：

```
using (ConnectionManager cm = ConnectionManager.Create())
{
    // Get the SqlConnection for use.
    // No need for a using statement, when Dispose is
    // called on the connection manager, the connection will be
    // closed.
    SqlConnection connection = cm.Connection;

    // Use connection appropriately.
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-17T18:03:33.453

您可以检查 c.State（ConnectionState 对象），它应该是以下之一：

```
System.Data.ConnectionState.Broken
System.Data.ConnectionState.Closed
System.Data.ConnectionState.Connecting
System.Data.ConnectionState.Executing
System.Data.ConnectionState.Fetching
System.Data.ConnectionState.Open 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-17T20:56:55.220

@edg：您在评论中说，“......只有这样它才会击中实际的服务器并遇到味精引用中描述的安全问题”。

这指出了问题的根源：您遇到了安全问题，这似乎*是*不可避免的，因为调用代码假定了另一个身份，而不是用于打开连接。这自然会生成一个安全日志条目。

由于身份更改是设计使然，因此解决方案可能是过滤安全日志。事件查看器有一个过滤当前日志操作，可以按关键字或 eventid 过滤。

+汤姆

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-17T12:18:14.533

在添加应用程序角色之前尝试移动`sp_unsetapprole`（它真的是存储过程的名称吗？可能`sp_dropapprole`是正确的名称？）并执行它。`setAppRole()`

# mysql - SQL ：具有动态列值分配的更新语句

> ID：556509
> 
> 赞同：3
> 
> 时间：2009-02-17T12:01:04.340
> 
> 标签：mysql, sql, sql-update

想象一下下面的 sql 查询：

```
UPDATE MYTABLE
SET COL2 = (SELECT COL2 + 1 FROM (SELECT MAX(COL2) FROM MYTABLE) AS X)
WHERE ID IN (1,2,3,4,5) 
```

假设在执行更新之前 MAX(COL2) 为 1。

我的意图是，对于 ID=1 COL2 的更新，将其更新为 'max(COL2) + 1'（即 2），并且对于后续更新，重新评估 'MAX(COL2) + 1'，以便对于 ID =2，COL2=3 和 ID=3，COL2=4 等等...

实际发生的是对于所有行 (ID=1,2,3,4,5)，COL2 的值为 2。

是否有一种聪明的方法可以在每次更新时“重新评估” MAX(COL2) +1 的值？我意识到这样做可能会出现性能问题，但我仍然很好奇！有没有更好的选择（不涉及多个更新语句）？

顺便说一句：如果您想知道上述查询（嵌套内表）使用的语法，请参见此处：[SQL：在嵌套 FROM 子句中的 UPDATE 语句中使用目标表](https://stackoverflow.com/questions/556237/sql-using-the-target-table-in-an-update-statement-in-a-nested-from-clause)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-17T12:14:52.840

```
UPDATE mytable, (
  SELECT @loop := MAX(col1)
  FROM
    mytable
  ) o
SET col1 = (@loop := @loop + 1) 
```

你在这里遇到的叫做`query stability`.

没有查询可以看到自己所做的更改，或者以下查询：

```
UPDATE mytable
SET col1 = col2 + 1
WHERE col1 > col2 
```

永远不会结束。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T14:34:23.053

这是我的做法：

```
SELECT MAX(col2) FROM mytable INTO @max;

UPDATE mytable
SET col2 = @max:=@max+1
WHERE id IN (1,2,3,4,5)
ORDER BY id; 
```

我在 MySQL 5.1.30 上对此进行了测试，它可以工作。

我首先设置`@max`变量只是因为我发现@Quassnoi 在笛卡尔积中的技巧是不必要的且可读性较差。

请注意，MySQL 支持`ORDER BY`在`UPDATE`语句中（这不是标准 SQL），您应该这样做，以确保按照您想要的顺序更新值。否则 MySQL 保证没有特定的顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T12:07:31.190

```
declare @loop int
select @loop = 1

UPDATE MYTABLE
SET COL1 = @loop,
    @loop = @loop+1
WHERE ID IN (1,2,3,4,5) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T12:10:07.533

> > 是否有一种聪明的方法可以在每次插入时“重新评估” MAX(COL1) +1 的值？

除非您一一更新行：（

这适用于 MSSQL，不知道 MySQL，但可能会给你一个想法：

```
DECLARE @Counter int

SELECT @Counter = MAX(COL2) FROM MYTABLE

UPDATE MYTABLE
SET @Counter = @Counter + 1,
    COL1 = @Counter
WHERE ID IN (1,2,3,4,5) 
```

编辑：我认为 SET 语句可以在 MSSQL 中简化为：

```
SET @Counter = COL1 = @Counter + 1 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-17T12:05:08.933

~~它应该在每次插入时重新评估它；大概 COL2 的最大值没有变化。您确定不想选择 MAX(COL **1** )？~~ 再次阅读您的问题，您混淆了插入和更新术语（现在已修复），我被抛出一个循环。

* * *

您正在尝试一次更新许多记录，但让它表现得好像它正在单独更新每个记录一样。这不会像你想要的那样工作。

您可以创建一个存储过程来循环遍历每个记录 WHERE ID IN (1,2,3,4,5) 并单独更新。或者，既然您只做 5 行，为什么不直接复制并粘贴该语句五次并将 WHERE 子句更改为`WHERE ID = 1`（以及后续行中的 2、3、4、5）。

# .net - F# 是 .net windows 开发的可用语言吗

> ID：556510
> 
> 赞同：10
> 
> 时间：2009-02-17T12:01:29.003
> 
> 标签：.net, windows, user-interface, f#

我一直听说 F# 和微软现在有一个人在 redmond 某处写博客和编码。你真的可以用 F# 编写 GUI 代码吗（我很想看到一个例子，比如向表单添加一个按钮并订阅 onclick 事件）

F# 是否可以完全访问所有 .Net？

我真的很好奇，我知道我可以用谷歌搜索，但我很想听听真正使用该语言的人的意见。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-02-17T12:06:31.800

是的，您当然可以编写 WinForms 应用程序 - 尽管您不会覆盖 OnClick 方法，但您会订阅 Click 事件。

是的，F# 可以完全访问 .NET，尽管如果您使用大量可变类型，您将不会获得非常惯用的功能代码。

[Tomáš Petříček 的 F# 网站](http://tomasp.net/)有来自他的书的示例源代码（免责声明：我也参与了这本书，所以我显然有偏见）其中有 WinForms 示例。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-17T12:20:01.690

我强烈推荐Scott [Hanselman的](http://www.hanselman.com/blog/aboutme.aspx)[这篇出色的文章](http://www.hanselman.com/blog/TheWeeklySourceCode34TheRiseOfF.aspx)，它指向一些 F# 资源，包括示例和演示文稿。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-18T00:07:20.397

> 但正如 Jon Skeet 所说，Tomas 有一些有趣的例子（尤其是过滤/管道事件），这表明我怀疑可能是一个很好的交叉点，即用设计师设计你的 C# GUI，然后用 F# 编写大脑，与事件挂钩。

这是我认为非常好的方法。在没有 WinForms 设计器的情况下设计复杂的 GUI 有点烦人（尽管 WPF 中的区别并不大 - F# 不支持 WPF 设计器，但您不会在那里松散那么多东西）。

无论如何，请继续关注更多示例:-)。使用声明性事件处理（Event.filter、Event.map 和朋友）非常好，但在某些情况下，它并不是您想要的。我只是在写一章，我认为 F# 为您提供了一些非常棒的方式来处理 GUI——源代码将在[本书网站](http://www.functional-programming.net/sources.aspx)上免费提供，我也希望为我的博客写一些简短的介绍一旦这本书完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-17T12:20:24.543

我实际上没有使用过 F#，只阅读了规范。这对于 WinForms 开发可能非常有用，但我对此的直接反应是“这并不重要”。只要您使用符合 CLR 的编译器，您就应该能够将 F# 程序集与其他用 C#/IronPython/etc 编写的程序集混合使用。

是的，F# 可以使用 .NET Framework，并且 F# 程序集可以被其他 .NET 程序集使用。

我的建议是用 F# 编写你的函数库，然后使用你喜欢的任何 .NET 语言来编写客户端应用程序。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T22:35:09.603

您可以从 F# 编写 GUI 代码，但我不确定您是否愿意。如果您是那种在记事本中编写 C# GUI 的人，那么它可能不会打扰您。就我个人而言，我更喜欢设计器，并且没有一个用于 F# 的设计器，据我所知，也不会有一个 - 这可能说明了 F# 的预期用途。

但正如 Jon Skeet 所说，Tomas 有一些有趣的例子（尤其是过滤/管道事件），这表明我怀疑可能是一个很好的交叉点，即用设计师设计你的 C# GUI，然后用 F# 编写大脑，与事件挂钩。

# apache-flex - flex webservice 故障：HTTP 请求错误

> ID：556512
> 
> 赞同：0
> 
> 时间：2009-02-17T12:03:41.073
> 
> 标签：apache-flex, web-services, fault

我使用 Flex 3 和 WebService 组件。我开始遇到以下错误

```
 HTTP request error 
```

调用服务方法时。这个错误只出现了，我不知道是什么原因造成的

```
 <mx:WebService
    useProxy="false"
    id= "myService">
         <mx:operation name="getName" resultFormat="object"
        result="getNameResultHandler(event)"
        fault="faultHandler(event)"/>
 </mx:WebService> 
```

我将 wsdl 设置为我的 init 方法，我将其作为 flashvar 读入。有任何想法吗？

我用来拨打电话的代码如下；

```
var id:Strig = Application.application.parameters.id;
mysERVICE.getname(id); 
```

* * *

好的，我在抛出错误时看到以下内容

```
[RPC Fault faultString="HTTP request error" faultCode="Server.Error.Request" faultDetail="Error: [IOErrorEvent type="ioError" bubbles=false cancelable=false eventPhase=2 text="Error #2032: Stream Error. URL: http://localhost:9081/app/services/RoomLookup"]. URL: http://localhost:9081/`app/services/RoomLookup`"] 
```

它显示的 url 与我作为参数提供的 wsdlUrl 不同

```
app/services/RoomLookup 
```

是 flex 附加本地主机还是这可能是存储在缓存中的东西

* * *

我已经记录了这个并得到“Http请求错误”

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-17T15:06:38.263

大多数 SOAP 和 RPC 框架会将错误响应的 HTTP 状态代码设置为`500`. Flash Player 无法处理状态代码为 500 的 HTTP 响应的内容，因此可能难以使用。不幸的是，没有办法在播放器中解决这个问题，所以最常见的方法似乎是确保服务器不会`500`为用户代理是 Flash Player 的请求设置错误响应的 HTTP 状态。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-17T12:08:47.880

将以下内容添加到`faultHandler()`：

```
trace(event.fault.faultString, "Error");
if (event.fault is SOAPFault) {
    var fault:SOAPFault=event.fault as SOAPFault;
    var faultElement:XML=fault.element;
    // ...
} 
```

这会给你一些开始挑选的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-17T12:18:04.503

使用像[Fiddler](http://www.fiddlertool.com/fiddler/)这样的 http 调试器来找出确切的请求/响应是什么。Flex 没有公开soap 错误的细节，或者至少它不习惯这样做。例如，请参见[此处。](http://bugs.adobe.com/jira/browse/SDK-11841)

# flash - for（循环）动态创建

> ID：556523
> 
> 赞同：0
> 
> 时间：2009-02-17T12:06:35.950
> 
> 标签：flash, actionscript-3, dynamic, for-loop

我正在尝试通过使用`for`循环来创建动态球。出于某种原因，我得到了两个对象（跟踪显示 2 个球及其不同的属性），但在舞台上我只能看到最后一个创建的对象。

这是我的代码：

```
var randomBall_mc:ball=new ball();
for (i=1; i<3; i++)
{
        addChild(randomBall_mc);
    randomBall_mc.name="randomBall"+i;
    randomBall_mc.x=150*i;
    randomBall_mc.y=175;
    randomBall_mc.height=20*i;
    randomBall_mc.width=20*i;
        trace("randomBall"+i);
    trace(randomBall_mc.x);
    trace(randomBall_mc.height);
} 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-17T12:53:03.233

似乎您在循环之前只实例化了一次球，而不是为每次迭代都做一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-17T12:54:58.050

**var randomBall_mc:ball=新球();** 应该在 for 循环内以创建多个“球”

```
for (i=1; i<3; i++) {
var randomBall_mc:ball=new ball();**
addChild(randomBall_mc);
randomBall_mc.name="randomBall"+i;
randomBall_mc.x=150*i; randomBall_mc.y=175;
randomBall_mc.height=20*i;
randomBall_mc.width=20*i; trace("randomBall"+i);
trace(randomBall_mc.x);
trace(randomBall_mc.height);} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-30T18:36:41.567

答案是正确的，但稍微完善一下代码：

```

`var ball:Ball;                  // Observe convention: capitalise class names
var i:int = 0;                  // Make sure to type your variables
for (; i < 3; i++) {
    ball = new Ball();
    ball.name = "randomBall"+i;
    ball.x = 150 * i;
    ball.y = 175;
    ball.height = 20 * i;
    ball.width = 20 * i;

    addChild(ball);             // Configure your instance first;
                                // then add it to the display list

    trace("ball:", i, ball.x, ball.height); 
}` 

c++ - Windows中的原始套接字实现？

ID：556525

赞同：2

时间：2009-02-17T12:07:14.967

标签：c++, sockets, tcp

我需要为我的应用程序手动创建 TCP/IP 标头。为此，我使用了原始套接字。我的系统操作系统是win xp (SP3)。

我的代码编译得很好 :) 但它会引发运行时错误：

```
Initialising Winsock...Initialised successfully. Creating Raw TCP Socket...Raw TCP Socket Created successfully. Setting the socket in RAW mode...Successful. Enter hostname : 192.168.1.152

Resolving Hostname...Resolved. Enter Source IP : 192.168.1.151

Sending packet... Error sending Packet : 10022 

```

我已将 IP_HDRINCL 设置为 1。我做错了什么？我也关闭了防火墙，但仍然得到相同的结果。

            回答 #1

赞同：8

时间：2009-02-17T14:29:59.490

从 Windows XP SP2 开始，Microsoft 有意禁用原始套接字。  

*   [http://msdn.microsoft.com/en-us/library/ms740548.aspx](http://msdn.microsoft.com/en-us/library/ms740548.aspx)
*   [http://seclists.org/nmap-hackers/2005/0004.html](http://seclists.org/nmap-hackers/2005/0004.html)
*   [http://www.zdnet.com.au/news/security/soa/Microsoft-tries-to-quell-TCP-IP-danger-/0,130061744,139189876,00.htm](http://www.zdnet.com.au/news/security/soa/Microsoft-tries-to-quell-TCP-IP-danger-/0,130061744,139189876,00.htm)

            回答 #2

赞同：2

时间：2009-02-17T12:30:27.827

不是答案，但希望是一个开始......

来自[MSDN](http://msdn.microsoft.com/en-us/library/ms740668(VS.85).aspx)：

WSAEINVAL 10022 参数无效。提供了一些无效参数（例如，为 setsockopt 函数指定无效级别）。在某些情况下，它还指代套接字的当前状态——例如，在未侦听的套接字上调用接受。

您的 send 调用的参数是什么？

我在原始套接字上发现[了这个更新：](http://msdn.microsoft.com/en-us/library/ms740548.aspx)

在带有 Service Pack 2 (SP2) 的 Windows XP 和 Windows Vista 上，通过原始套接字发送流量的能力受到以下几种方式的限制：

*   TCP 数据不能通过原始套接字发送。

不确定这是否适用于 XP SP3...

            回答 #3

赞同：2

时间：2009-02-17T12:32:56.603

我建议为此目的使用[WinPcap 。](http://www.winpcap.org/)即使您知道如何使用 win32 API 正确执行此操作，它也会非常缓慢。

我已经成功使用 WinPcap 以硬件可以处理的速度将数据包注入千兆以太网端口。

            回答 #4

赞同：2

时间：2010-05-16T16:39:15.810

微软限制了 RAWSockets，但只使用 WinPcap [http://www.winpcap.org/](http://www.winpcap.org/)。有了它，您可以发送各种数据包。

        java - 如何动态创建类文件？

ID：556526

赞同：4

时间：2009-02-17T12:07:24.810

标签：java, class, dynamic, class-design, javabeans

我想动态创建一个类文件。在这里... 使用给定的 ResultSet，提取元数据我想使用 ResultSet 中存在的所有列的 getter 和 setter 方法动态构建一个类文件。此外，我应该能够在以后使用的任何地方使用生成的这个类文件。任何机构都可以建议我更好的方法来实现这一点。此外，如果有任何现有的 jar 文件可用于实现这一点，那将很有帮助。

            回答 #1

赞同：7

时间：2009-02-17T12:10:26.143

也许[Apache Beanutils](http://commons.apache.org/beanutils/)可能适合您的要求？
请参阅有关[Dynabeans的部分](http://commons.apache.org/beanutils/apidocs/org/apache/commons/beanutils/package-summary.html#dynamic)
尤其：

3.3 ResultSetDynaClass（在DynaBeans中包装ResultSet）

DynaBean API 的一个非常常见的用例是包装其他通常不以 JavaBeans 呈现的“东西”集合。最好包装的最常见的集合之一是 java.sql.ResultSet，当您要求 JDBC 驱动程序执行 SQL SELECT 语句时，它会返回。Commons BeanUtils 提供了一种标准机制，可以使结果集的每一行都作为 DynaBean 可见，您可以使用它，如下例所示：

```
 Connection conn = ...;
  Statement stmt = conn.createStatement();
  ResultSet rs = stmt.executeQuery
    ("select account_id, name from customers");
  Iterator rows = (new ResultSetDynaClass(rs)).iterator();
  while (rows.hasNext()) {
    DynaBean row = (DynaBean) rows.next();
    System.out.println("Account number is " +
                       row.get("account_id") +
                       " and name is " + row.get("name"));
  }
  rs.close();
  stmt.close(); 
```

3.4 RowSetDynaClass（断开连接的ResultSet作为DynaBeans）

尽管 ResultSetDynaClass 是将 SQL 查询的结果表示为一系列 DynaBean 的一种非常有用的技术，但一个重要的问题是底层 ResultSet 必须在应用程序处理行的整个时间段内保持打开状态。这阻碍了使用 ResultSetDynaClass 作为在模型-视图-控制器架构（例如 Struts 框架提供的架构）中将信息从模型层传递到视图层的能力，因为没有简单的机制来确保结果集最终关闭（并且底层连接返回到它的连接池，如果你正在使用一个）。

RowSetDynaClass 类代表了解决此问题的不同方法。当您构造这样一个实例时，底层数据被复制到一组表示结果的内存中 DynaBeans。当然，这种技术的优点是您可以立即关闭 ResultSet（和相应的语句），通常甚至在您处理返回的实际数据之前。当然，缺点是您必须支付复制结果数据的性能和内存成本，并且结果数据必须完全适合可用的堆内存。对于许多环境（尤其是在 Web 应用程序中），这种权衡通常是非常有益的。

作为一个额外的好处，定义了 RowSetDynaClass 类来实现 java.io.Serializable，这样它（以及与结果的每一行对应的 DynaBeans）可以方便地序列化和反序列化（只要底层的列值也是可序列化）。因此，RowSetDynaClass 代表了一种将 SQL 查询结果传输到远程基于 Java 的客户端应用程序（例如小程序）的非常方便的方法。

            回答 #2

赞同：5

时间：2009-02-17T12:14:13.153

事情是这样的——从你的情况来看，我知道你想在运行时创建这个类，基于你刚刚从数据库查询中返回的 ResultSet 的内容。这一切都很好，可以通过字节码操作来完成。

但是，您认为您会从中获得什么好处？您的其他代码将无法调用此类上的任何方法（因为它们在编译时不存在），因此实际使用此生成的类的唯一方法是通过反射或通过其父类上的方法或实现的接口（我假设它会扩展 ResultSet）。您可以在没有字节码编织的情况下执行后者（查看接口的任意运行时实现的[动态代理](http://java.sun.com/j2se/1.3/docs/guide/reflection/proxy.html)），如果您正在执行前者，我看不出拥有一个类并`getFoo`通过反射机械地调用该方法比只是调用`resultSet.getString("foo")`- 它会更慢，更笨重*且*类型安全性更低。

所以 - 你确定你真的想创建一个类来实现你的目标吗？

            回答 #3

赞同：4

时间：2009-02-17T12:08:38.817

您可能想查看[BCEL](http://jakarta.apache.org/bcel/)，尽管我相信还有其他可用的字节码操作库。

            回答 #4

赞同：4

时间：2009-02-17T12:10:52.693

如果您使用的是 Java 6，您可以编写代码并[直接调用 Java 编译器](http://java.sun.com/javase/6/docs/api/javax/tools/JavaCompiler.html)：

```
 Files[] files1 = ... ; // input for first compilation task
   Files[] files2 = ... ; // input for second compilation task

   JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();
   StandardJavaFileManager fileManager = compiler.getStandardFileManager(null, null, null);

   Iterable<? extends JavaFileObject> compilationUnits1 =
       fileManager.getJavaFileObjectsFromFiles(Arrays.asList(files1));
   compiler.getTask(null, fileManager, null, null, null, compilationUnits1).call();

   Iterable<? extends JavaFileObject> compilationUnits2 =
       fileManager.getJavaFileObjects(files2); // use alternative method
   // reuse the same file manager to allow caching of jar files
   compiler.getTask(null, fileManager, null, null, null, compilationUnits2).call();

   fileManager.close(); 
```

然后您将不得不加载该类，但您可以使用类加载器轻松完成此操作。

可悲的是，这是您在 Java 中必须做的。

在 C# 中，您只需使用 'var' 类型。

            回答 #5

赞同：1

时间：2009-02-17T12:20:32.047

我对它应该工作的方式感到困惑。而且我认为这是不可能的。原因如下：

如果您想在应用程序的其余部分中使用类代码，则需要一个接口（或大量使用反射），这意味着您事先知道列类型 - 违背了生成类的目的。

生成的类可能在运行时与另一个类发生冲突。如果您为每个 SQL 调用创建一个新类，您将拥有用于相同目的的不同类。这些可能甚至不会通过对“等于”的常规调用。您必须从以前执行的语句中查找类。你失去了灵活性和/或用类填充你的堆。

            回答 #6

赞同：1

时间：2009-02-17T13:05:13.377

我做过可能类似的事情。但我不会创建动态类。我有一个名为 Schema 的对象，它可以加载我需要的每个表的数据。我有一个具有 Schema 类型的 Table 对象。每个 Schema 对象都将具有 columns 属性，而 While Table 对象具有具有值的属性和对 Schema 列属性的引用。

Schema 拥有您在数据库中插入、选择、删除、更新数据所需的一切。

我有一个调解器来处理数据库和 Table 对象之间的连接。

```
 Table t = new Table('Dog');   
   t.randomValue(); // needed for the purpose of my project   
   t.save();    
   Table u = Table.get(t);
   u.delete(); 
```

但它可以很容易地获得某些列名的价值。无论如何，原理很简单，我可以加载表 information_data 中包含的数据，它也可能与描述一起使用。

我能够动态加载anytable，因为表具有动态属性，结构没有硬编码。但是没有真正需要为每个表创建新的类。

还有一些重要的事情需要注意。每个表模式都加载一次。表只引用了模式，而模式引用了列。列引用了列类型等...

找到比它更好的用途可能会很有趣。我为数据库复制的单元案例做了这个。我没有真正的兴趣为 30 个表中的每一个编写一个类并进行插入/删除/更新和选择。这是我认为创建有关 sql 的动态内容很有用的唯一原因。如果您不需要了解有关表格的任何信息，而只想在其中插入/删除垃圾。

如果我不得不重做我的代码，我会使用更多的关联数组。

无论如何祝你好运

            回答 #7

赞同：0

时间：2009-02-17T15:22:13.857

我赞同 dtsazza 和 Stroboskop 的评论；在这种情况下，在运行时生成一个新类可能不是您想要做的。

您还没有真正了解*为什么*要这样做，但听起来您正在尝试推出自己的[Object-Relational mapper](http://en.wikipedia.org/wiki/Object-relational_mapping)。这是一个比最初看起来更难解决的问题。

与其自下而上构建自己的系统，不如研究现有的解决方案，例如[Hibernate](http://www.hibernate.org/)（高级系统，为您管理大部分对象和查询）或[iBatis](http://ibatis.apache.org/)（更底层；它处理对象映射，但您仍然可以编写自己的 SQL）。

            回答 #8

赞同：0

时间：2009-02-17T19:49:52.747

我发现在 JSF 中 bean 和地图可以互换使用。因此，对于处理您不想构建完整的 get/setter 集而只创建 ah:table 的结果，为每一行创建一个带有映射的列表要容易得多，其中键是列名（或number），值为列内容。

如果您以后发现它相关以使其更加类型安全，则可以使用 bean 重新编写后端代码，并保持您的 JSF 代码不变。

        sql - 循环更新数据库记录？

ID：556552

赞同：4

时间：2009-02-17T12:15:23.777

标签：sql, plsql

```
declare
begin
  for i in (select * from emp)
  loop
    if i.sal=1300 then
      update emp
      set sal=13000;
    end if;
  end loop;
end; 
```

此代码正在更新工资为 13000 的所有记录。
相反，我想将工资为 1300 的记录更新为值 13000。
你能告诉我哪里出错了吗？

我正在使用隐式游标访问记录..

对于每条记录，我正在检查该记录的 Sal 值..

如果特定记录中的薪水值为 1500，我想将其更新为 15000..

            回答 #1

赞同：27

时间：2009-02-17T12:18:44.000

删除该代码并使用：

```
update emp set sal = 13000 where sal = 1300 
```

            回答 #2

赞同：14

时间：2009-02-19T12:41:30.637

每当您可以使用单个语句进行更新时，您应该这样做而不是使用循环。这样，您将获得非常巨大的性能提升；或者，反过来，循环更新会消耗大量性能。

如果你真的必须使用循环，当然你需要一个 where 条件来确保你只更新你真正想要更新的记录。一种始终有效的可能方法（即使没有可用的唯一键）是使用 rowid 伪列：

```
begin
  for i in (select rowid, emp.* from emp)
  loop
    if i.sal=1300 then
      update emp
      set sal=13000
      where rowid=i.rowid;
    end if;
  end loop;
end; 
```

另一种可能性是使用显式游标和“update ... where current of *cursorname* ”语法。

            回答 #3

赞同：5

时间：2009-02-17T12:18:00.273

您需要对更新语句施加约束。

您目前拥有的内容将遍历结果行，如果它找到薪水等于 1300 的行，则执行以下 SQL：

```
update emp 
set sal=13000;
```

没有约束，这会更新每一行。

            回答 #4

赞同：5

时间：2009-02-17T12:24:59.430

此代码正在更新工资为 13000 的所有记录。相反，我想将工资为 1300 的记录更新为值 13000。

对于每条记录，我都在检查该记录的 Sal 值。如果特定记录中的工资值为 1500，我想将其更新为 15000。

那么你到底想要什么？

您只想更新 1,500 工资，您发出：

```
UPDATE emp
SET sal = 15000
WHERE sal = 1500; 
```

你想把所有的工资提高十倍，你发出：

```
UPDATE emp
SET sal = sal * 10; 
```

            回答 #5

赞同：1

时间：2020-12-11T17:54:58.213

虽然其中一些解决方案是可行的，但它并不是一种适合所有解决方案的解决方案。我遇到了一个场景，我们必须在具有 +50 M 记录的表上将 xml/nvarchar(max) 字段设置为 null。这是代码的摘录

```
begin

declare @rows int,
        @y    int = 2020,
        @m    int = 1;

set @rows = 1;

while (@rows > 0)
begin

update top (500) cr
   set [xml] = null
 from [dbo].[customer] cr with(index(ix_customer_reportdt)) 
 where  year([reportdt]) = @y
   and month([reportdt]) = @m
   and [xml] is not null;

  set @rows = @@rowcount;

end

end 
```

            回答 #6

赞同：0

时间：2020-01-31T09:33:45.290

这是一个快速解决方案，有助于根据创建日期删除列数据的空格（修剪）：

```
UPDATE table_Name SET column_name = LTRIM(RTRIM(column_name)) 
WHERE EXTEND(dateTime_column, YEAR TO DAY)='2020-01-31' ; 
```

        php - 午夜后的PHP时间问题

ID：556555

赞同：0

时间：2009-02-17T12:17:18.153

标签：php, time

我有很多次要打印出来。我希望已经过去的时间让我们说 12:00 时钟“变灰”。

$theTime = '12:00';

if($theTime >= $time[$i]) {....}

02:30 

03:50 

03:20 

04:50 

05:45 

19:45 

20:00 

20:50 

20:55 

21:25 

21:30 

22:00 

22:45 

23:55 

00:50 

00:55   

我对每个值做一个简单的比较 12:00 时钟。当您将时间更改为午夜之后（例如 00:15）时会出现问题。午夜过后，如何按顺序计算和打印列表？

            回答 #1

赞同：5

时间：2009-02-17T12:20:51.983

如果您过了午夜，则涉及多于一天。这意味着您必须包含当天的信息！今天是几号？所以为了实现你想要的，你应该列出/存储更多的时间！如果您存储日期时间值，则计算时差不会有问题，因为 php 会根据日期信息知道以什么顺序放置时间。

看看[php datetime 函数](http://ee2.php.net/manual/en/ref.datetime.php)。

他们还将帮助您计算差异！

            回答 #2

赞同：1

时间：2009-02-17T12:19:34.297

使用 unix 时间戳。为午夜创建一个 unix 时间戳，然后将所有其他时间戳与之进行比较。然后将其格式化为打印出来的时间。

（由于我使用PHP有一段时间了，所以不太记得该怎么做，但应该很简单。我知道我以前做过类似的事情[。](http://php.net/manual/en/function.mktime.php)看看[http://php.net/time，http://](http://php.net/time) [/php.net/manual/en/function.mktime.php](http://php.net/manual/en/function.mktime.php)和[http://php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)应该足够简单 =)

            回答 #3

赞同：1

时间：2012-12-06T09:35:17.727

我解决了这个问题如下。这不是最好的解决方案，但至少它有效：

```
$before_midnight = strtotime("23:59:59");
$before_midnight++; // this makes exact midnight
$start = strtotime("21:00");
$target = strtotime("03:00");
$after_midnight = strtotime("00:00");

for($i=$start; $i<$before_midnight; $i += 3600)
    echo date("H:i", $i). "<br>";

for($i=$after_midnight; $i<=$target; $i += 3600)
    echo date("H:i", $i). "<br>"; 
```

            回答 #4

赞同：1

时间：2009-02-17T14:08:04.660

正如 Svish 所说，您应该使用真正的时间戳，并且您还应该检查日期变化......我认为，这里是了解 2 个时间（和日期）之间差异的更快速和简单的方法：

```
<?php
$dateDiff = $date1 - $date2;
$fullDays = floor($dateDiff/(60*60*24));
$fullHours = floor(($dateDiff-($fullDays*60*60*24))/(60*60));
$fullMinutes = floor(($dateDiff-($fullDays*60*60*24)-($fullHours*60*60))/60);
echo "Differernce is $fullDays days, $fullHours hours and $fullMinutes minutes.";
?> 
```

注意 $date1 和 $date2 必须是 mktime 格式，如：

```
int mktime  ([ int $hour=date("H")  [, int $minute=date("i")  [, int $second=date("s")  [, int $month=date("n")  [, int $day=date("j")  [, int $year=date("Y")  [, int $is_dst=-1  ]]]]]]] ) 
```

            回答 #5

赞同：0

时间：2009-02-17T13:31:28.257

回覆。Svish 的建议 - strtotime() 可以方便地轻松创建相对于当前时间或任意时间的 Unix 时间戳。

例如 strtotime('midnight') 将为您提供最近午夜的 unix 时间戳。

            回答 #6

赞同：0

时间：2009-02-17T16:46:28.320

您有一个字符串 ( `'12:00'`) 并试图像数字一样比较它。

[http://us3.php.net/manual/en/language.operators.comparison.php](http://us3.php.net/manual/en/language.operators.comparison.php)

就像 Svish 和 Paul 所说，您需要使用整数时间戳。

```
$now = time(); // Get the current timestamp

$timestamps= array(strtotime('midnight'),
                   strtotime('07:45'), 
                    ...
                   );

foreach ( $timestampsas $time ) {
    if ( $time >= $now ) {
        // $time is now or in the future
    } else {
        // $time is in the past
    }
} 
```

[您可以使用date](http://us3.php.net/manual/en/function.date.php "日期")函数格式化时间戳。

        git - 如何使用 Git 实现以下目标？

ID：556566

赞同：4

时间：2009-02-17T12:18:59.477

标签：git, version-control, dvcs

问题陈述

到目前为止，每个人都可以访问整个代码库。现在我需要强制人们只获取他们将使用的那些模块的代码，对于其他模块，他们将获得一个库，就像在 lib 中一样。假设我们现在有两个模块

思考机器人（头）

-> assemblebot（树/子目录）

```
 -> include

 -> source

 -> lib

 -> obj 
```

-> vpl（树/子目录）

```
 -> include

 -> source

 -> lib

 -> obj 
```

-> 包括

-> 源 -> bin`

现在，如果有人正在开发 vpl 模块，他将获得包含代码的包含和源文件夹，并且从 assemblebot 模块中他将获得一个库。因此，当他从 HEAD 进行更改和编译时，事情就会从他那里得到解决。

伙计们，我如何在 Git 中实现这个？关于阅读什么的指针？命令片段会很棒吗？

            回答 #1

赞同：8

时间：2009-02-17T12:37:44.160

目前，我能想到的唯一方法是使用[submodules](http://git.or.cz/gitwiki/GitSubmoduleTutorial)。这两个模块（assemblebot，vpl）每个都是一个子模块，树的其余部分将在超级项目中。

这实质上意味着这两个模块必须在单独的存储库中，然后在主存储库中`git submodule init git://foo.com/assemblebot.git`。

我不确定这是否值得整体努力。这不是 git 的强项之一（事实上，这是我认为唯一需要改进的地方）。

对部分结账的更好支持正在开发中（[窄](http://git.or.cz/gitwiki/SoC2009Ideas#head-2cdf2f7bd7667427d1e20c714ca33bd92aaa4905)和[稀疏](http://kerneltrap.org/index.php?q=mailarchive/git/2008/7/23/2646664/thread)的克隆）。

编辑：考虑到 vpl 和 assemblebot 依赖于 include 和 source，也许最好将 include 和 source 作为 vpl 和 assemblebot 存储库的子模块。但是，这些不是单独的项目，git 所做的是跟踪项目内容。我看不出这些模块实际上应该分开的原因。也许只是告诉开发人员不要碰其他人的代码？

        objective-c - 如何验证 Twitter 好友时间线？

ID：556572

赞同：1

时间：2009-02-17T12:20:58.817

标签：objective-c, twitter

这是我的第一个 Web API 项目，所以我希望解决这个问题的方法不会太明显。

```
// Contstruct the http request
NSString *urlString = [NSString stringWithFormat:@"http://%@:%@@twitter.com/statuses/user_timeline/%@.xml?count=5", username, password, friend];
NSURL *url = [NSURL URLWithString:urlString];
NSURLRequest *urlRequest = [NSURLRequest requestWithURL:url];

// Recive the data from the synchronous request
NSData *urlData;
urlData = [NSURLConnection sendSynchronousRequest:urlRequest returningResponse:nil error:nil]; 
```

从这个查询返回的结果看起来不错，*只是*它们没有反映我是否收藏了它们。所有推文都返回“false”，即使验证用户已为它们加注星标。我相当有信心我正在正确地进行身份验证，因为需要身份验证的代码运行正确。

            回答 #1

赞同：1

时间：2009-02-17T12:31:51.507

在您指定用户名/密码的位置添加基本身份验证标头字段。大多数库都有一个 setCredentials() 方法。

            回答 #2

赞同：0

时间：2009-02-18T00:19:33.783

正如在上一篇文章中直接指出的那样，XML 与现实不同步。完全没有更改代码，今天早上不工作的事情今晚工作了。谢谢德克！

        sharepoint-2007 - SharePoint 2007：单点登录异常

ID：556577

赞同：0

时间：2009-02-17T12:24:39.183

标签：sharepoint-2007, windows-server-2008, single-sign-on

我有一个运行以下内容的虚拟机：

*   视窗服务器 2008  
*   共享点 2007   
*   SP1 交换 2007  
*   动态 Axapta 2009

我已经启动了单点登录服务并正确配置了它。管理中心在 HTTPS 上运行，该 HTTPS 作为 IIS 中的新站点绑定到特定 IP 地址。当我单击管理中央管理服务器的链接以进行单点登录时，即使在地址栏中键入完整的 Uri，它也会继续重定向到 localhost。知道是什么导致了这种行为以及如何解决它吗？

我需要为 BDC 连接配置它。

            回答 #1

赞同：0

时间：2009-02-19T11:05:26.140

经过大量研究，事实证明这种情况没有解决方案或解释。在创建 SSL 站点和进行 IP 绑定之前，我已经重建了虚拟环境并配置了 SSO。

        inversion-of-control - ServiceContainer、IoC 和一次性对象

ID：556580

赞同：7

时间：2009-02-17T12:26:07.337

标签：inversion-of-control, idisposable, disposable

我有一个问题，我要标记这个*主观*的，因为这就是我认为它演变成的，更多的讨论。我希望有一些好的想法或一些发人深省的东西。对于这个冗长的问题，我深表歉意，但您需要了解上下文。

问题基本上是：

*   您如何处理与 IoC 容器相关的具体类型？具体来说，谁负责处理它们，如果它们需要处理，以及这些知识如何传播到调用代码？

您是否要求它们是 IDisposable 的？如果不是，那么该代码是面向未来的，还是您不能使用一次性物品的规则？如果您对接口和具体类型强制执行 IDisposable 要求以保证未来的发展，那么作为构造函数调用的一部分注入的对象是谁的责任？

**编辑**：我接受了[@Chris Ballard](https://stackoverflow.com/users/18782/chris-ballard)的答案，因为它与我们最终采用的方法最接近。

基本上，我们总是返回一个看起来像这样的类型：

```
public interface IService<T> : IDisposable
    where T: class
{
    T Instance { get; }
    Boolean Success { get; }
    String FailureMessage { get; } // in case Success=false
} 
```

然后我们从 .Resolve 和 .TryResolve 返回一个实现这个接口的对象，这样我们在调用代码中得到的总是相同的类型。

现在，实现此接口的对象`IService<T>`是 IDisposable 的，并且应该*始终*被释放。解决服务的程序员不能决定是否`IService<T>`应该释放对象。

然而，这是关键部分，无论服务实例是否应该被释放，这些知识都被嵌入到实现的对象`IService<T>`中，所以如果它是一个工厂范围的服务（即每次调用 Resolve 最终都会得到一个新的服务实例)，那么服务实例会在`IService<T>`对象被释放的时候被释放。

这也使得支持其他特殊范围成为可能，例如池。我们现在可以说我们需要最少 2 个服务实例，最多 15 个，通常是 5 个，这意味着每次调用 .Resolve 都会从可用对象池中检索一个服务实例，或者构造一个新实例。然后，当`IService<T>`持有池化服务的对象被释放时，服务实例被释放回其池中。

当然，这使所有代码看起来像这样：

```
using (var service = ServiceContainer.Global.Resolve<ISomeService>())
{
    service.Instance.DoSomething();
} 
```

但这是一种干净的方法，并且无论使用的服务类型或具体对象如何，它都具有相同的语法，因此我们选择它作为可接受的解决方案。

**原始问题如下，供后代使用**

**冗长的问题来了：**

我们有一个我们使用的 IoC 容器，最近我们发现了问题所在。

在非 IoC 代码中，当我们想使用文件时，我们使用了这样的类：

```
using (Stream stream = new FileStream(...))
{
    ...
} 
```

毫无疑问，该类是否具有有限资源，因为我们知道文件必须关闭，并且该类本身实现了 IDisposable。规则很简单，我们构造一个对象的每个类，实现 IDisposable，都必须被处理掉。无话可问。调用 Dispose 是否是可选的不是由此类的用户决定的。

好的，接下来就是迈向 IoC 容器的第一步。假设我们不希望代码直接与文件对话，而是通过一层间接。让我们将此类称为此示例的 BinaryDataProvider。在内部，该类正在使用一个流，它仍然是一个一次性对象，因此上面的代码将更改为：

```
using (BinaryDataProvider provider = new BinaryDataProvider(...))
{
    ...
} 
```

这变化不大。类实现IDisposable的知识还在，不问，需要调用Dispose。

但是，让我们假设我们的类提供的数据现在不使用任何有限的资源。

那么上面的代码可以写成：

```
BinaryDataProvider provider = new BinaryDataProvider();
... 
```

好的，到目前为止一切都很好，但问题的关键来了。假设我们想要使用 IoC 容器来注入此提供程序，而不是依赖于特定的具体类型。

代码将是：

```
IBinaryDataProvider provider =
    ServiceContainer.Global.Resolve<IBinaryDataProvider>();
... 
```

请注意，我假设有一个独立的接口可用，我们可以通过它访问对象。

有了上面的改动，如果我们以后想要使用一个真正应该被处理掉的对象怎么办？解析该接口的现有代码都没有被编写来处理该对象，那么现在怎么办？

在我们看来，我们必须选择一种解决方案：

*   实现运行时检查，检查是否正在注册的具体类型实现 IDisposable，要求它公开的接口也实现 IDisposable。这不是一个好的解决方案
*   在对正在使用的接口进行约束之前，它们必须始终从 IDisposable 继承，以便面向未来
*   强制运行时没有具体类型可以是 IDisposable，因为这不是由使用 IoC 容器的代码专门处理的
*   只需让程序员检查对象是否实现 IDisposable 并“做正确的事”？
*   还有其他人吗？

另外，在构造函数中注入对象呢？我们的容器以及我们研究过的其他一些容器能够将新对象注入到具体类型的构造函数的参数中。例如，如果我们`BinaryDataProvider`需要一个实现`ILogging`接口的对象，如果我们对这些对象强制执行 IDispose-“能力”，那么处理日志对象的责任是谁的？

你怎么看？我想要意见，好的和坏的。

            回答 #1

赞同：3

时间：2009-02-17T13:08:36.767

一种选择可能是使用工厂模式，这样由 IoC 容器直接创建的对象永远不需要自己处理，例如

```
IBinaryDataProviderFactory factory =
    ServiceContainer.Global.Resolve<IBinaryDataProviderFactory>();
using(IBinaryDataProvider provider = factory.CreateProvider())
{
    ...
} 
```

缺点是增加了复杂性，但这确实意味着容器永远不会创建开发人员应该处理的任何东西——它总是显式的代码来做这件事。

如果您真的想让它变得明显，可以将工厂方法命名为 CreateDisposableProvider() 之类的名称。

            回答 #2

赞同：2

时间：2009-02-17T20:15:06.057

（免责声明：我是根据 java 的东西来回答这个问题的。虽然我编写了 C#，但我没有在 C# 中代理任何东西，但我知道这是可能的。对 java 术语感到抱歉）

您可以让 IoC 框架检查正在构造的对象以查看它是否支持 IDisposable。如果没有，您可以使用动态代理来包装 IoC 框架提供给客户端代码的实际对象。此动态代理可以实现 IDisposable，因此您始终将 IDisposable 传递给客户端。只要您使用的接口应该相当简单？

然后，*当*对象是 IDisposable 时，您将遇到与开发人员通信的问题。我不太确定如何以一种好的方式完成这项工作。

            回答 #3

赞同：1

时间：2009-04-27T11:48:21.783

您实际上想出了一个非常肮脏的解决方案：您的`IService`合同违反了[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)，这是一个很大的禁忌。

我建议将所谓的“单例”服务与所谓的“原型”服务区分开来。“单例”的生命周期由容器管理，容器可以在运行时查询特定实例是否实现`IDisposable`，如果是，则在关闭时调用`Dispose()`。

另一方面，管理原型完全是调用代码的责任。

        oop - 寻找面向对象的编程杂志

ID：556582

赞同：0

时间：2009-02-17T12:26:44.090

标签：oop, journal

我正在寻找一本讨论 OOP 和现代编程技术的期刊。

任何人都可以推荐吗？

            回答 #1

赞同：3

时间：2009-02-17T12:28:43.417

试试鲍勃叔叔的博客。[http://blog.objectmentor.com/](http://blog.objectmentor.com/)

            回答 #2

赞同：1

时间：2009-12-02T03:09:50.527

[对象技术杂志](http://www.jot.fm)怎么样。[编辑部](http://www.jot.fm/general/about/)有一些受人尊敬的人。

            回答 #3

赞同：0

时间：2009-02-17T13:22:42.757

我是[ACCU](http://accu.org/)的成员，一直对他们期刊中文章的标准印象深刻。

大量过去的文章可以在[这里找到](http://accu.org/index.php/journals/c78/)

        sql - 我可以在 DBIx::Class 中漂亮地打印 DBIC_TRACE 输出吗？

ID：556590

赞同：22

时间：2009-02-17T12:31:47.997

标签：sql, perl, formatting, dbix-class

将 DBIC_TRACE 环境变量设置为 true：

```
BEGIN { $ENV{DBIC_TRACE} = 1 } 
```

生成非常有用的输出，特别是显示正在执行的 SQL 查询，但 SQL 查询都在一行上。

有没有办法通过某种“sql tidy”例程来更好地格式化它，也许将它分成多行？如果做不到这一点，谁能给我一个提示，我需要破解代码中的哪个位置来添加这样的钩子？最好的工具是接受格式错误的 SQL 查询并推出格式良好的查询？

在这种情况下，“漂亮的格式”仅仅意味着比“全部在一行上”更好。我对格式查询的特定样式并不特别在意

谢谢！

            回答 #1

赞同：21

时间：2010-12-20T00:33:26.443

[从 DBIx::Class 0.08124 开始，它是内置的。](http://blog.afoolishmanifesto.com/archives/1444)

只需设置`$ENV{DBIC_TRACE_PROFILE}`为`console`或`console_monochrome`。

            回答 #2

赞同：10

时间：2009-02-17T12:41:33.620

来自 DBIx::Class::Storage 的文档

如果设置了 DBIC_TRACE，则生成跟踪信息（与设置调试方法时一样）。

...

debug
导致在 debugobj 对象上发出跟踪信息。（或 STDERR，如果没有专门设置 debugobj）。

debugobj
设置或检索用于度量收集的对象。默认为与使用 coderef 作为回调的原始方法兼容的 DBIx::Class::Storage::Statistics 实例。有关更多信息，请参阅前面提到的统计类。

换句话说，您应该`debugobj`在该类中设置一个子类[DBIx::Class::Storage::Statistics](http://search.cpan.org/perldoc?DBIx::Class::Storage::Statistics)的对象。在您的子类中，您可以按照您希望的方式重新格式化查询。

            回答 #3

赞同：3

时间：2009-02-17T21:22:14.693

首先，感谢指点！部分答案如下......

到目前为止我所拥有的......首先是一些脚手架：

```
# Connect to our db through DBIx::Class
my $schema = My::Schema->connect('dbi:SQLite:/home/me/accounts.db');

# See also BEGIN { $ENV{DBIC_TRACE} = 1 }
$schema->storage->debug(1);

# Create an instance of our subclassed (see below)
# DBIx::Class::Storage::Statistics class
my $stats = My::DBIx::Class::Storage::Statistics->new();

# Set the debugobj object on our schema's storage
$schema->storage->debugobj($stats); 
```

My::DBIx::Class::Storage::Statistics 的定义是：

```
package My::DBIx::Class::Storage::Statistics;

use base qw<DBIx::Class::Storage::Statistics>;
use Data::Dumper qw<Dumper>;
use SQL::Statement;
use SQL::Parser;

sub query_start {
    my ($self, $sql_query, @params) = @_;

    print "The original sql query is\n$sql_query\n\n";

    my $parser = SQL::Parser->new();
    my $stmt   = SQL::Statement->new($sql_query, $parser);
    #printf "%s\n", $stmt->command;

    print "The parameters for this query are:";
    print Dumper \@params;
} 
```

这解决了有关如何挂钩以使我的 SQL 查询“漂亮化”的问题。

然后我运行一个查询：

```
my $rs = $schema->resultset('SomeTable')->search(
    {   
        'email' => $email,
        'others.some_col' => 1,
    },
    { join => 'others' }
);
$rs->count; 
```

但是 SQL::Parser 对 DBIx::Class 生成的 SQL 不满意：

```
The original sql query is
SELECT COUNT( * ) FROM some_table me LEFT JOIN others other_table ON ( others.some_col_id = me.id ) WHERE ( others.some_col_id = ? AND email = ? )

SQL ERROR: Bad table or column name '(others' has chars not alphanumeric or underscore!

SQL ERROR: No equijoin condition in WHERE or ON clause 
```

那么......有没有比 SQL::Parser 更好的解析器来完成这项工作？

        silverlight-2.0 - Silverlight 网格拆分器意外行为

ID：556592

赞同：6

时间：2009-02-17T12:31:55.733

标签：silverlight-2.0

我刚开始使用 2.0 版的 Silverlight。我想在页面上显示一些数据网格，并通过将每个数据网格放入网格单元格中来完成。然后我想我会尝试使用以下标记添加网格拆分器：

```
<UserControl xmlns:basics="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"  xmlns:data="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Data"  x:Class="SilverlightApplication1.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
 Loaded="UserControl_Loaded">
    <Grid x:Name="LayoutRoot" Background="White">
        <Grid.ColumnDefinitions>
            <ColumnDefinition></ColumnDefinition>
            <ColumnDefinition Width="Auto"></ColumnDefinition>
            <ColumnDefinition></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition></RowDefinition>
            <RowDefinition></RowDefinition>
        </Grid.RowDefinitions>
        <basics:GridSplitter Grid.RowSpan="2" Grid.Row="0" Grid.Column="1" HorizontalAlignment="Left" Width="5" VerticalAlignment="Stretch" ></basics:GridSplitter>
        <data:DataGrid Name="TLGrid" Grid.Row="0" Grid.Column="0">
        </data:DataGrid>
        <data:DataGrid Name="TRGrid" Grid.Row="0" Grid.Column="2">
        </data:DataGrid>
        <data:DataGrid Name="BLGrid" Grid.Row="1" Grid.Column="0">
        </data:DataGrid>
        <data:DataGrid Name="BRGrid" Grid.Row="1" Grid.Column="2">
        </data:DataGrid>
    </Grid>
</UserControl> 
```

我希望能够拖动拆分器来调整其他两列的大小。当我拖动栏时，其他两列都会缩小。谁能解释为什么？

            回答 #1

赞同：8

时间：2009-02-17T15:27:06.247

单元格以您所经历的方式调整大小的原因`ColumnDefinition`归结`HorizontalAlignment`为`GridSplitter`. 因为您没有指定高度，所以列宽默认为 Star。这意味着它们具有相等的间距。然后`GridSplitter` `HorizontalAlignment`指定它调整大小的方向。如果你居中或拉伸它，那么你会调整两边的大小，但如果你将它对齐到一个边缘或另一个边缘，它只会调整那个边缘的大小，但是因为单元格平均共享空间，所以两边都会缩小而不是只有一个。

尽管接受的答案提供了一种替代方法来使其正常工作，但它实际上并没有解释问题发生的原因。在它自己的单元中放置一个分离器是完全可以接受的——事实上，它经常被推荐。

            回答 #2

赞同：7

时间：2009-02-17T13:26:56.647

您不需要 gridsplitter 的中间列。如果您将拆分器放在第 0 列，则 Gridsplitter 将绑定到第 0 列的右边缘。您可以在左侧的网格中添加一个小边距，这样您就不会丢失最后 5 个像素。

```
<Grid x:Name="LayoutRoot" Background="White">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="1*"/>
        <!--<ColumnDefinition Width="Auto"/>-->
        <ColumnDefinition Width="1*"/>
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
        <RowDefinition Height="1*"/>
        <RowDefinition Height="1*"/>
    </Grid.RowDefinitions>

    <data:DataGrid Name="TLGrid" Grid.Row="0" Grid.Column="0" />
    <data:DataGrid Name="BLGrid" Grid.Row="1" Grid.Column="0"/>

    <!-- Moved the grid splitter to column 0 -->
    <basics:GridSplitter Grid.RowSpan="2" Grid.Row="0" Grid.Column="0" Width="5" />

    <data:DataGrid Name="TRGrid" Grid.Row="0" Grid.Column="2" />
    <data:DataGrid Name="BRGrid" Grid.Row="1" Grid.Column="2" />        
</Grid> 
```

        math - 由空间中两点之间的弧长参数化的螺旋方程

ID：556601

赞同：2

时间：2009-02-17T12:34:04.497

标签：math, matlab, wolfram-mathematica

由空间中任意两点之间的弧长（即弧长的函数）**参数化**的螺旋方程是什么？有什么功能吗？我如何使用 matlab 或 mathematica 实现相同的功能？

            回答 #1

赞同：3

时间：2009-02-17T13:22:59.790

只是为了增加 Mitch Wheat 的答案，螺旋并不是唯一的；对于给定的轴，自由度是转弯之间的距离、半径和相位（`P`、`A`和  `phi`以下）

如果你概括为

```
w = 2*pi/P
r(t) = (A cos (wt-phi)) i + (A sin (wt-phi)) j + (t) k 
```

那么将弧长作为 t 的函数进行分析的一种方法（无需显式计算弧长积分）是认识到速度的大小是恒定的；平行于半径的速度分量为 0，平行于轴`1`的速度分量为 ，垂直于半径和轴的速度分量为`Aw`，因此速度的大小为 speed = sqrt(1 + A ² w ² ), => 弧长 s = sqrt(1 + A ² w ² )t

您需要某种方式来定义轴 ,`P`和`A`作为`phi`给定输入的函数。仅端点和弧长是不够的。

            回答 #2

赞同：2

时间：2009-02-17T12:47:41.747

找到由下式定义的螺旋线的弧长参数化

```
 r(t)  =  cos t i + sin t j + t k 
```

弧长 = s = 积分(a,b){sqrt((dx/dt)^2 + (dy/dt)^2 + (dz/dt)^2) dt}

首先找到弧长函数

```
 s(t) = Integral(0,t) { sqrt((sin u)^2 + (cos u)^2 + 1) du }
          = Integral(0,t) { sqrt(2) du } = sqrt(2) * t 
```

求解 t 给出

```
 t   =  s / sqrt(2) 
```

现在替换回来得到

```
 r(s)  =  cos(s / sqrt(2)) i + sin(s / sqrt(2)) j + (s / sqrt(2)) k 
```

我把最后一点留给你！

        actionscript-3 - 我有 RTRIM；如何使用正则表达式制作 LTRIM

ID：556603

赞同：0

时间：2009-02-17T12:35:35.367

标签：actionscript-3, flex3

我有 RTRIM；如何使 LTRIM 成为一个？

公共静态函数 rtrim(string:String):String 

           { 

             return string.replace(/\s+$/,""); 

               }   

            回答 #1

赞同：3

时间：2009-02-17T12:41:42.747

```
public static function ltrim(string:String):String {
    return string.replace(/^\s+/,"");
} 
```

警告：未经测试！[在此处](http://livedocs.adobe.com/flex/3/html/help.html?content=data_access_6.html)查找 flex 3.0 文档。这与您所拥有的完全相似，只是我们使用不同的**元字符**来指定我们要从 begin( ) 而不是 end( )开始搜索空格（`\s`--另一个元字符）。after告诉模式匹配一​​个或多个空格。`^``$``+``\s`

            回答 #2

赞同：2

时间：2009-02-17T13:09:35.440

与其重新发明轮子，不如直接[使用 Adob​​e 的 as3corelib](http://code.google.com/p/as3corelib/)库中的 StringUtil 类？

出于兴趣，as3corelib 将其修剪函数定义如下：

```
public static function trim(input:String):String
{
    return StringUtil.ltrim(StringUtil.rtrim(input));
}

public static function ltrim(input:String):String
{
    var size:Number = input.length;
    for(var i:Number = 0; i < size; i++)
    {
        if(input.charCodeAt(i) > 32)
        {
            return input.substring(i);
        }
    }
    return "";
}

public static function rtrim(input:String):String
{
    var size:Number = input.length;
    for(var i:Number = size; i > 0; i--)
    {
        if(input.charCodeAt(i - 1) > 32)
        {
            return input.substring(0, i);
        }
    }
    return "";
} 
```

            回答 #3

赞同：0

时间：2009-02-17T12:49:33.553

哇，认真的吗？您正在使用正则表达式从字符串的末尾删除恒定的字符序列？真的吗？我不知道 Actionscript/Flex，但这不是要走的路。在快速谷歌之后，我找到了一个可能会或可能不会更有效的[解决方案。](http://www.twisty.com/bandwagon/archives/2007/07/23/162642)

        asp.net - 如何使用与 asp.net 的交换来发送本地电子邮件？

ID：556607

赞同：2

时间：2009-02-17T12:36:32.243

标签：asp.net, sendmail, exchange-server-2007

我有一个项目需要通过本地电子邮件向员工发送通知。我使用 SmtpClient 类发送电子邮件但没有用！这是代码：  

```
 MailMessage message = new MailMessage();

    message.From = new MailAddress("localmail1@company.com");
    message.To.Add(new MailAddress("localmail2@company.com"));
    message.Subject = "Sending mail";
    message.Body = "Check sending email by Exchange from asp.net code <> ";

    SmtpClient client = new SmtpClient("ExchangeDNS", 25);

    try
    {
        client.Send(message);
    }
    catch (Exception exc)
    {
        Label1.Text = exc.Message.ToString();
    } 
```

当我单击按钮时，它会给我一条`SmtpException`带有消息：`Failure sending mail.`

注意：我们使用 Exchange 服务器。

我该如何解决？

            回答 #1

赞同：4

时间：2009-02-17T12:44:25.017

使用服务器的完全限定名称，例如 exchangeDNS.example.com。如果这不起作用，请尝试 IP 地址。您可能想手动远程登录到 Exchange 服务器上的端口 25，只是为了看看是否可行。此外，检查您的服务器是否需要经过身份验证或加密的连接。如果是这样，您需要在请求中提供凭据或更改以使用 SSL 和安全端口。

            回答 #2

赞同：1

时间：2009-02-17T12:39:06.137

假设您拥有正确的服务器和任何所需的凭据（仔细检查这些），我会尝试增加[SMTP 客户端的超时时间](http://msdn.microsoft.com/en-us/library/system.net.mail.smtpclient.timeout.aspx)。

            回答 #3

赞同：1

时间：2009-02-17T13:09:00.357

你的代码很好。值得怀疑的是您的 Exchange 服务器的配置。Exchange 管理员的一些选项：

*   允许匿名 SMTP 连接。
*   将 IP 列入白名单，这样只有您的 Web 服务器才能以这种方式发送邮件。
*   为 Web 服务器创建一个 Active Directory 帐户，然后让您的班级使用用户名和密码进行身份验证。

如果您发布有关您的 Exchange 配置的更多详细信息，我可以提供帮助，但有可能将此问题降级为“与编程无关”。

        ajax - 在 ASP.NET MVC Actionlink 中编码 dataview 值

ID：556612

赞同：0

时间：2009-02-17T12:39:06.307

标签：ajax, asp.net-mvc, actionlink

我正在使用 Microsoft Ajax Template DataView 将值绑定到模板。我可以做到这一点，它可以按您的预期工作：

```
<h3>{{ID}}</h3>
<p>{{Address}}</p> 
```

但是，我正在尝试构建一个包含 ID 的操作链接。

```
<h2><%= Html.ActionLink(Html.AttributeEncode("{{Name}}"), "Index", "Restaurant", new { Id = Html.AttributeEncode("{{ID}}") }, null)%></h2> 
```

名称显示为我想要的链接文本，但链接不包含 ID，而是包含 %7B%7BID%7D%7D

如何让 Id 被正确解析并添加到链接中？

            回答 #1

赞同：0

时间：2009-02-17T12:50:54.737

额外的括号可能会将其丢弃。尝试将值分配给变量并使用 ActionLink 中的变量。您可以在视图顶部进行分配，然后在整个视图中重用它们。避免在任何地方重新编码它们。

```
 <% var id = Html.AttributeEncode( "{{ID}}" );
     var name = Html.AttributeEncode( "{{Name}}" );
   %>
  <h2><%= Html.ActionLink(name, "Index", "Restaurant", new { Id = id }, null)%></h2> 
```

            回答 #2

赞同：0

时间：2009-02-17T15:17:04.993

终于让它工作了，我不知道我是不是很愚蠢，或者是否缺少文档，但这里是如何将 dataview 值绑定到链接。

```
 <h2><a sys:href="{{'Restaurant/Index/' + ID}}">{{Name}}</a></h2> 
```

实际的 url 路由部分需要用单引号括起来，并且您需要使用 sys:href 而不是 href。

            回答 #3

赞同：0

时间：2009-02-17T21:37:43.003

`'<%= Url.Action("Index", "Restaurant")%>'`在构建手动 url 以避免应用程序名称和冲突 url 出现问题时包含它的好习惯。

        c# - 死锁 lock() 方法

ID：556616

赞同：0

时间：2009-02-17T12:40:15.120

标签：c#, locking, deadlock

我面临死锁，我的代码结构类似于：

```
private delegate void UpdateControlDelegate(string value);

public void UpdateControl(string value)
{
    if (txtAddress.InvokeRequired)
    {
        txtAddress.Invoke(new UpdateControlDelegate(UpdateControl), value);
    }
    else
    {
        txtAddress.Text = value; // This is in GroupBox1
        txtValue.Text = value; // This is in GroupBox2
    }
}

class ThreadHandler
{
    List<string> _list = new List<string>();
    object _criticalSection = new object();

    public ThreadHandler()
    {
        new Thread(new ThreadStart(Run)).Start();
    }

    public static ThreadHandler _threadHandler = null;

    public static ThreadHandler GetThreadHandler()
    {
        if (_threadHandler == null)
        {
            _threadHandler = new ThreadHandler();
        }

        return _threadHandler;
    }

    public void Run()
    {
        while (true)
        {
            // some code

            lock (_criticalSection)
            {
                foreach (string str in _list)
                {
                    // some Code
                }
            }

            // some code
            Thread.Sleep(SomeTime);
        }
    }

    public void AddItem(string item)
    {
        lock (_criticalSection)
        {
            _list.Add(item);
        }
    }

    public void RemoveItem(string item)
    {
        lock (_criticalSection)
        {
            _list.Remove(item);
        }
    }

} 
```

但是使用相同的代码，我只是像这样修改了 UpdateControl 方法：

```
private delegate void UpdateControlDelegate(string value);

public void UpdateControl(string value)
{
    if (InvokeRequired)
    {
        BeginInvoke(new UpdateControlDelegate(UpdateControl), value);
    }
    else
    {
        txtAddress.Text = value; // This is in GroupBox1
        txtValue.Text = value; // This is in GroupBox2
    }
} 
```

这工作正常。问题是什么？

            回答 #1

赞同：4

时间：2009-02-17T12:43:41.507

问题几乎可以肯定是您在后台线程中获取锁，然后调用`Control.Invoke`并调用试图获取相同锁的委托（在 UI 线程上）。它不能这样做，因为另一个线程持有锁 - 并且在等待 UI 操作完成时将继续持有锁。

诚然，您发布的 UpdateControl 方法中没有锁定，但我怀疑这不是完整的代码 - 而且您没有显示您正在使用的位置`AddItem`或`RemoveItem`.

顺便说一句，我注意到 GetThreadHandler() 不是线程安全的 - 这对我来说看起来像是一个错误......

            回答 #2

赞同：0

时间：2009-02-17T12:47:19.330

您是否在从工作线程调用 UpdateControl 时从主线程调用 AddItem 和 RemoveItem？这将导致死锁。

            回答 #3

赞同：0

时间：2009-02-17T14:07:19.827

这是我的代码，

```
public class ValueReader
{
    List<IDataReader> _list = new List<IDataReader>();

    object _criticalSection = new object();

      public ValueReader()
      {
        //Nothign here
      }

      public void Attach(IDataReader reader)
      {
            lock(_criticalSection)
            {
                _list.Add(reader);
            }
      }

      public void Detach(IDataReader reader)
      {
            lock(_criticalSection)
            {
                _list.Remove(reader);
            }
      }

      public void Notify(string value)
      {
            lock(_criticalSection)
            {
                foreach(IDataReader reader in _list)
                {
                    reader.Update(value);
                }
            }
        }

      public void Start()
      {
            new Thread(new ThreadStart(Run)).Start();
      }

      private void Run()
      {
            while(true)
            {

                //generate value
                Notify(value);

                Thread.Sleep(5000);

            }
      } 

}

public interface IDataReader
{
    void UpdateControls(string value);
}

public class FirstClass : IDataReader
{

    ....
    ......  
    ValueReader _reader = null;

    public FirstClass()
    {

        _reader = new ValueReader();
              _reader.Start();
        _reader.Attach(this);

    }

    private void AddToSmartClient()
    {
        // _reader has added to SmartClient's WorkItem
    }

    private delegate void UpdateControlDelegate(string value);

    public void UpdateControl(string value)
    {
        if(txtAddress.InvokeRequired)
        {
            txtAddress.Invoke(new UpdateControlDelegate(UpdateControl), value);
        }
        else
        {
            txtAddress.Text = value;
            txtValue.Text = value;
        }
    }

}

public class SecondClass : IDataReader
{
        ....
    ......
    ValueReader _reader = null;

    public void SecondClass()
    {
        _reader = ReadFromSmartClient();
        _reader.Attach(this);
    }

    private ValueReader ReadFromSmartClient()
    {
        reader = //Get from SmartClient's Workitem.
        return reader
    }

    private delegate void UpdateControlDelegate(string value);

    public void UpdateControl(string value)
    {
        if(InvokeRequired)
        {
            BeginInvoke(new UpdateControlDelegate(UpdateControl), value);
        }
        else
        {
            control1.Text = value;
            control2.Text = value;
        }
    }

} 
```

我有一段时间只调用 FirstClass。在这种情况下，它工作正常。一段时间后，我调用了 Second 类，此时从 secondClass 调用 Attach 时，应用程序挂起。（我监测到它正在运行，直到 Attach 方法的锁（_criticalSection）。

一段时间后，我将第一类中的更新控件转换如下

```
 public void UpdateControl(string value)
{
    if(InvokeRequired)
    {
        BeginInvoke(new UpdateControlDelegate(UpdateControl), value);
    }
    else
    {
        txtAddress.Text = value;
        txtValue.Text = value;
    }
} 
```

这在调用 SecondClass 之后也很有效。为什么会发生？

        c++ - 实现从 Java 到 C++ 的飞跃

ID：556625

赞同：3

时间：2009-02-17T12:44:58.370

标签：c++

正如主题所说，我对 c++ 很陌生，但我对 java 有一些经验。为了开始学习 c++，我有制作一个简单的命令行计算器的（不是很原始的）想法。我要做的是将数字和运算符存储在二叉树中。

```
#include <iostream>
using namespace std;

class Node
{
  bool leaf;
  double num;
  char oper;
  Node* pLNode;
  Node* pRNode;

public:

  Node(double n)
  {
    num = n;
    leaf = true;
    pLNode = 0;
    pRNode = 0;
  }

  Node(char o, Node lNode, Node rNode)
  {
    oper = o;
    pLNode = &lNode;
    pRNode = &rNode;
    leaf = false;
  }

  bool isLeaf()
  {
    return leaf;
  }

  double getNumber()
  {
    return num;
  }

  char getOperator()
  {
    return oper;
  }

  Node* getLeftNodePointer()
  {
    return pLNode;
  }

  Node* getRightNodePointer()
  {
    return pRNode;
  }

  //debug function
  void dump()
  {
    cout << endl << "**** Node Dump ****" << endl;
    cout << "oper: " << oper << endl;
    cout << "num: " << num << endl;
    cout << "leaf: " << leaf << endl;
    cout << "*******************" << endl << endl;
  }

};

class CalcTree
{
  Node* pRootNode;
  Node* pCurrentNode;
public:

  Node* getRootNodePointer()
  {
    return pRootNode;
  }

  Node* getCurrentNodePointer()
  {
    return pCurrentNode;
  }

  void setRootNode(Node node)
  {
    pRootNode = &node;
  }

  void setCurrentNode(Node node)
  {
    pCurrentNode = &node;
  }

  double calculateTree()
  {
    return calculateTree(pRootNode);
  }

private:

  double calculateTree(Node* nodePointer)
  {
    if(nodePointer->isLeaf())
    {
      return nodePointer->getNumber();
    }
    else
    {
      Node* leftNodePointer = nodePointer->getLeftNodePointer();
      Node* rightNodePointer = nodePointer->getRightNodePointer();
      char oper = nodePointer->getOperator();

      if(oper == '+')
      {
    return calculateTree(leftNodePointer) + calculateTree(rightNodePointer);
      }
      else if(oper == '-')
      {
    return calculateTree(leftNodePointer) - calculateTree(rightNodePointer);
      } 
      else if(oper == '*')
      {
    return calculateTree(leftNodePointer) * calculateTree(rightNodePointer);
      }
      else if(oper == '/')
      {
    return calculateTree(leftNodePointer) / calculateTree(rightNodePointer);
      }
    }
  }
};

int main(int argc, char* argv[])
{
  CalcTree tree;
  tree.setRootNode(Node('+', Node(1), Node(534)));
  cout << tree.calculateTree() << endl;
  return 0;
} 
```

我有几个关于这段代码的问题：

1.  这会编译但不会执行预期的操作。似乎在 tree.setRootNode(Node('+', Node(1), Node(534))); 之后 在 main 中，rightnode 已正确初始化，但 leftnode 未正确初始化。编译并运行它会为我打印出 534（gcc，freebsd）。这里有什么问题？

2.  在 C++ 中，人们似乎更喜欢在类之外定义类的成员，比如

    A类{公共：无效成员（）；};

    A :: member(){std::cout << "Hello world" << std::endl;}

    why is that?

3.  I'd very much like some pointers on c++ conventions (naming, indenting etc.)

4.  I'm used to coding java with eclipse. Atm I'm using emacs for learning c++. Can someone advise me on a good (free) c++ ide, or should I stfu and stick with emacs like a real man? :)

            回答 #1

赞同：5

时间：2009-02-17T13:02:48.733

*   First, I can only recommend to have a look at the book "Accelerated C++".  It will jump-start you into **STL**, and C++ **style**, and can save you a year of bad experiences.  (There is quite an amount of extraordinary well written literature on C++ out there, if you decide to go deeper).

*   C++ does not use automatic memory management on the heap.  You are storing pointers to temporaries.  Your program is incorrect as it tries to access destructed objects.  Like it or not, you'll have to learn on object lifetime first.  You can simplify a good part of this in simple cases by using value semantics (not storing pointers, but storing a copy of the object).

*   Eclipse/CDT is reported to be quite OK on linux.  On Windows you'll do easier with Microsoft Visual C++ Express Edition.  When you've gotten into the basics, switching later will be no problem for you.

*   Defining members outside of the class itself is preferred as we usually split header and implementation files.  In the header you try not to expose any unnecessary information, and also to reduce code-size, it's a simple matter of compile **time**.  But for many modern programming techniques (like using template meta-programming) this cannot be used, so quite some C++ code moves in the direction of inline definitions.

            回答 #2

赞同：3

时间：2009-02-17T13:15:47.797

First, i recommend you a good book too. There are very good SO threads about C++ books, like [The definitive C++ book guide and List](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list). In the following, you find i tell you how to solve some problems, but i don't delve into details, because i think that's what a book can do much better.
I've glanced over the code, here is what i've figured:

```
 Node(char o, Node lNode, Node rNode)
  {
    oper = o;
    pLNode = &lNode;
    pRNode = &rNode;
    leaf = false;
  } 
```

That constructor has 3 parameters, all of which are local to the function. When the function returns, the parameters do not exist anymore, and their memory occupied by them is cleaned up automatically. But you store their addresses into the pointers. That will fail then. What you want is passing pointers. By the way always use constructor initializer lists:

```
 Node(char o, Node *lNode, Node *rNode)
      :oper(o), pLNode(lNode), pRNode(rNode), leaf(false)
  { } 
```

Creating the tree now does look different:

```
 CalcTree tree;
  tree.setRootNode(new Node('+', new Node(1), new Node(534)));
  cout << tree.calculateTree() << endl; 
```

New creates a dynamic object and returns a pointer to it. The pointer must not be lost - otherwise you have a memory-leak because you can't delete the object anymore. Now, make sure you delete child nodes ordinarily by creating a destructor for Node (put it as you would put any other member function):

```
 ~Node() {
      delete pLNode;
      delete pRNode;
  } 
```

Here you see it's important to always null-ify pointers: delete on a null pointer will do nothing. To start cleaning-up, you create a CalcTree destructor too, which starts the delete chain:

```
 ~CalcTree() {
      delete pRootNode;
  } 
```

Don't forget to create a default constructor for CalcTree that initializes that pointer to 0! Now, you have one remaining problem: If you copy your object, the original object and the copy share the same pointer, and when the second object (the copy) goes out of scope, it will call delete on the pointer a second time, thus deleting the same object twice. That's unfortunate. It can be solved by forbidding copying your classes - or by using smart pointers that have shared ownership semantics (look into **shared_ptr**). A third variant is to write your own copy constructor and copy assignment operator. Well, here is how you would disable copy constructor and copy assignment operators. Once you try to copy, you will get a compile error. Put this into Node:

```
 private:
      Node(Node const&);
      Node& operator=(Node const&); 
```

The same for CalcTree, and you are protected from that subtle bug now.
Now, onto your other questions:
It seems in c++ people prefer to define members of a class outside the class
That is because the more code you add to the header, the more you have to include into your header from other files (because your code depends on something that's defined in them). Note that all other files that include that header then will transitively include the headers that one includes too. So you will in the end have less indirectly included headers when you put your code into separately compiled files instead. Another problem that is solved are cyclic references. Sometimes, you have to write a method that needs to have access to something defined later in the header. Since C++ is a single-pass language, the compiler can't resolve references to symbols that are declared after the point of use - generally.
I'd very much like some pointers on c++ conventions
That's very subjective, but i like this convention:

*   Class data-members are written like *`mDataMember`*
*   Function are written like *`getDataMember`*
*   Local variables are written like *`localVariable`*
*   Indenting with spaces, 4 spaces each (uh oh, *this* one is controversial. There are many possible ways to indent, please do not ask for the best one!)

I'm used to coding java with eclipse. Atm I'm using emacs for learning c++.
I'm using emacs for my C++ development, and eclipse for Java. Some use eclipse for Java too (there is a package called CDT for eclipse C++ development). It seems to be quite common gist (i agree) that Visual C++ on windows is the best IDE you get for windows. There are also some answers on SO regarding this: [Best IDE for C++](https://stackoverflow.com/questions/93326/which-ide-is-best-for-c) (best search with google in stackoverflow, it will give you much more results than the builtin search).

            回答 #3

赞同：1

时间：2009-02-17T13:03:26.657

1.  You're passing by value, not by reference when you say

    Node(char o, Node lNode, Node rNode)

It should be

```
Node(char o, Node &lNode, Node &rNode) 
```

or better yet (for consistency with the rest of your code),

```
Node(char o, Node *lNode, Node *rNode) 
```

2.  **Compilation speed:** The header (.h file) contains extra information not embedded in the .o files, so it must be recompiled by every other C++ file that includes it.  **Space:** If you include method bodies, they are duplicated in every file that includes the .h file.  This is in contrast to Java, where all of the relevant information is embedded in the .class file.  C++ cannot do this because it is a much richer language.  In particular, macros make it so that C++ will never be able to embed all the information in a .o file.  Also, Turing-complete templates make it challenging to get rid of the .h / .cpp distinction.

3.  There are many conventions.  The standard C++ library has one set, the standard C library has another, BSD and GNU each have their own, and Microsoft uses yet another.  I personally like to be fairly close to Java when it comes to naming identifiers and indenting.

4.  Eclipse, NetBeans, KDevelop, vim, and emacs are all good options.  If you're on Windows, Visual Studio is really nice.

            回答 #4

赞同：0

时间：2009-02-17T12:49:24.287

There are very different conventions for C++. Google some. There is no "official" convention. ;)

To your IDE question: I am using the CDT (C[/C++] Development Tools, Eclipse). There has been a first release for another Eclipse based C++ IDE: [http://www.eclipse.org/linuxtools/](http://www.eclipse.org/linuxtools/) I am going to test it out these days. Sounds very good.

Also try out KDevelop if you are using KDE.

            回答 #5

赞同：0

时间：2009-02-17T12:55:58.390

```
2\. It seems in c++ people prefer to define members of a class outside the 
class[..] 
```

It's a matter of style. Mostly. We group the big bulky methods in a separate `cpp` file, and keep the small ones along with the header file. Declaring the method within the class declaration makes the function inline (which is a hint for the compiler to do, you guessed it -- inlining). This is something you may or may not want depending on the problem you want to solve.

```
3\. I'd very much like some pointers on c++ conventions (naming, indenting etc.) 
```

The standard library is a good reference. Start looking at the headers.

```
4\. I'm used to coding java with eclipse. 
```

Eclipse can be configured to use a C++ compiler. Go(ogle) for it, please. Why punish yourself twice now that you've taken to C++ ;-)

        apache-flex - 如何将网站（谷歌、雅虎、任何网站）加载到画布

ID：556626

赞同：-6

时间：2009-02-17T12:45:07.760

标签：apache-flex, flex3

如何将网站（谷歌、雅虎、任何网站）加载到画布

            回答 #1

赞同：2

时间：2009-02-17T16:13:59.537

您需要使用 Adob​​e AIR 及其 HTML 控件来执行此操作。Flex 无法轻松呈现大型、复杂的 HTML 文档。

[http://livedocs.adobe.com/flex/3/langref/mx/controls/HTML.html](http://livedocs.adobe.com/flex/3/langref/mx/controls/HTML.html)

            回答 #2

赞同：0

时间：2009-02-23T12:31:59.303

非常简单如下：

```
<mx:HTML location="(url of the HTML)"/> 
```

对于所有其他属性和事件，请查看链接的 Brd6644 页面。

        c# - 使用 Lockbits 搜索黑色像素，但这是随机的吗？

ID：556637

赞同：1

时间：2009-02-17T12:47:49.843

标签：c#, gdi+, ocr

我遇到了 Lockbits 的问题。我正在搜索黑色像素，因为它看起来不正确，所以我使用 WindowPopup 来打印每个像素的颜色，但这就像我的程序正在使用另一张图片一样。

[替代文字 http://i208.photobucket.com/albums/bb91/Savaronna/pixel-1.jpg?t=1234874238](http://i208.photobucket.com/albums/bb91/Savaronna/pixel-1.jpg?t=1234874238) 

我将第一个发现的黑色像素标记为红色。如您所见，还有其他几个像素也应该匹配。我究竟做错了什么？

这是我的剧本，我需要监督吗？

```
Bitmap b = this.TableListBMP;
BitmapData bmpData = b.LockBits(new Rectangle(0, 0, b.Width, b.Height),
                                ImageLockMode.ReadWrite, 
                                PixelFormat.Format32bppPArgb);

int stride = bmpData.Stride;
IntPtr Scan0 = bmpData.Scan0;

unsafe
{
  byte * p = (byte *)(void *)Scan0;  
  int nOffset = bmpData.Stride - b.Width*4;    
  int xOffset, yOffset;

  for(int y=5; y<b.Height; ++y)
  {
    for(int x=1; x<b.Width; ++x)
    {
      MessageBox.Show(
        string.Format("x={0}, y={1}, ARGB={2},{3},{4},{5}",
          x, y,
          Convert.ToString(p[(y*stride)+(x*4)]),
          Convert.ToString(p[(y*stride)+(x*4)+1]),
          Convert.ToString(p[(y*stride)+(x*4)+2]),
          Convert.ToString(p[(y*stride)+(x*4)+3])));
      p +=4;
    }
    // EDIT: This line should be removed
    p += nOffset;
  }
}
b.UnlockBits(bmpData); 
```

            回答 #1

赞同：3

时间：2009-02-17T13:04:14.843

如果您使用诸如 的偏移量`p[((y)*stride)+((x)*4)]`，您可能根本不应该增加 p 吗？您肯定已经用乘法处理过 (`x`和) 吗？`y`此外，`bmpData.Stride - b.Width*4`（据我所知）不是一个有意义的数字......步幅是包括填充在内的行大小。

要么删除“ `p += ...`”代码，要么更改偏移算法。目前，您正在跳过数据（错误）并访问对象外部的数据（**非常**糟糕）。

        language-agnostic - 调试器使用

ID：556638

赞同：2

时间：2009-02-17T12:48:38.127

标签：language-agnostic, debugging, complexity-theory

您是否使用您所使用的语言的调试器来单步调试代码以了解代码在做什么，或者您是否发现很容易查看其他人编写的代码以了解发生了什么？我说的是用 C# 编写的代码，但它可以是任何语言。

            回答 #1

赞同：1

时间：2009-02-17T12:54:11.607

我为此使用单元测试。

            回答 #2

赞同：0

时间：2009-02-17T12:51:31.770

我会写特别复杂的代码部分，但我希望一般来说，我的开发人员同事编写的代码足够清晰，可以在没有它的情况下遵循。

            回答 #3

赞同：0

时间：2009-02-17T12:54:56.737

取决于谁编写了代码，即使是调试器也无助于理解它是如何工作的：我有一个同事，他以能够在每一行代码中尽可能多地完成工作而自豪。这可能导致代码通常难以阅读，更不用说从长远来看理解它的作用了。

就我个人而言，我一直希望找到与我尝试编写的代码一样可读的代码。

            回答 #4

赞同：0

时间：2009-02-17T12:56:11.617

**我将主要使用调试器在异常**上设置断点。

这样我就可以执行我编写的任何测试或单元测试，并且如果发生任何异常，仍然能够正确地处理代码失败的地方。

            回答 #5

赞同：0

时间：2009-02-17T13:01:09.047

我不会说我一直使用它，但我确实经常使用它。我工作的领域是自动化和控制。您经常需要调试器来查看系统的各种内部状态。仅仅通过查看代码通常很难甚至不可能确定这些。

            回答 #6

赞同：0

时间：2009-02-17T13:02:22.273

是的，但只有在没有单元测试覆盖并且代码特别难以遵循时作为最后的手段。使用调试器单步执行代码是一个耗时的过程，而且我觉得不太有趣。在尝试遵循 VBA 代码时，我倾向于发现自己经常使用这种技术。

            回答 #7

赞同：0

时间：2009-02-17T13:48:53.893

是的，但通常仅用于调查证明对其他方法有抵抗力的错误。

我编写嵌入式软件，因此运行调试器通常涉及必须将调试模块物理插入被测 PCB、添加/删除链接、在调试插座上焊接（如果不存在）等 - 因此我试图避免它如果可能的话。此外，一些较旧的调试器硬件/软件可能有点不稳定。

        apache-flex - 我可以将 FluorineFX 或 WebORB 改装到我的 C# Web 服务吗？

ID：556642

赞同：0

时间：2009-02-17T12:50:29.790

标签：apache-flex, performance, architecture, weborb, fluorinefx

我有一个 C# Web 服务，它目前使用 XML 与 Flex 应用程序通信。它不是流数据或任何东西，但我仍然想降低所涉及的开销。我有两个问题：

**1) 在减少服务器**负载方面，我会看到使用 FluorineFX 或 WebORB 等技术有什么好处吗？我想，Flex 客户不会感觉到太大的不同。

2) 将这样的技术改造到现有产品中有多容易？从头开始会更容易吗？

提前致谢。

            回答 #1

赞同：3

时间：2009-02-17T16:12:44.267

1.  至于服务器负载，很难说。我可以肯定地说，客户端的性能差异很大。对于大型数据集，我们已经看到通过使用 AMF 而不是 XML，客户端的性能提高了 10 倍。Flash Player 可以比 XML 更快地反序列化 AMF，这很重要，因为您不知道客户端计算机将拥有多少马力。

2.  挺容易。Fluorine 的编程模型不是您针对其显式 API 进行编码的模型。您只需配置 Fluorine 以公开某些 .NET 服务。本质上，任何普通的旧类都可以远程公开其方法。因此，您从 Web 服务迁移到 Fluorine FX 应该很容易。

            回答 #2

赞同：0

时间：2011-03-23T21:25:07.550

使用 WebORB 将现有服务公开给 Flex 客户端非常容易。您要做的只是将您的服务放入 WebORB 的 bin 文件夹中，使它们可以通过 WebORB 的服务浏览器查看。然后，您可以选择并调用这些方法进行测试，然后自动生成集成代码以部署到您的 FlashBuilder 项目中。这会在您的客户端应用程序和服务器端的服务之间创建集成。

在性能方面，与 Web 服务相比，使用远程处理可以显着提高性能。我们有一个免费的基准测试工具，可让您在自己的环境中自己测试差异。对于较大的数据集，性能提升更为明显。这是该基准工具的链接：

[http://www.themidnightcoders.com/products/weborb-for-net/developer-den/technical-articles/amf-vs-webservices.html](http://www.themidnightcoders.com/products/weborb-for-net/developer-den/technical-articles/amf-vs-webservices.html)

        .net - .NET 应用程序的内存消耗详细信息

ID：556647

赞同：1

时间：2009-02-17T12:52:51.690

标签：.net, memory, perfmon

我正在调试与我们拥有的托管应用程序相关的一些内存问题。当我对所有堆中的 .NET 字节和进程资源管理器中报告的工作集（任务管理器中的内存使用列）之间的内存差异感到困惑时，我正在使用 perfmon 监视应用程序。所有堆计数器中的字节数显示值为 15MB，而进程工作集为 78MB - 差别很大。我知道加载到内存中的文件会消耗一些内存，但这些数字仍然没有加起来。

有什么线索吗？

            回答 #1

赞同：1

时间：2009-02-17T12:56:35.003

本文[很好](http://blogs.msdn.com/ntdebugging/archive/2007/10/10/the-memory-shell-game.aspx)地概述了各种内存计数器。

**工作集**——这是一个进程的一组虚拟内存页面（已提交），位于物理 RAM 中。工作集就像“当前/最近在这些页面上工作”列表

根据您的问题描述，您似乎有大约。正在使用 63MB 的非托管内存。

            回答 #2

赞同：1

时间：2009-02-17T13:00:28.597

尝试使用 FXCop。查看有关在 IDisposable 类型上调用 dispose 失败的规则。

.net 内存泄漏的主要原因有两个，一个是调用 IDisposable 失败（这是一种为 P/Invoke 代码调用非托管析构函数的技术），第二个是未能释放对对象的引用，这导致它们不垃圾收集。例如，如果您将对象存储在列表中，您可能会不小心保留对列表的引用，因此对象仍在内存中。

            回答 #3

赞同：1

时间：2009-02-17T17:32:22.967

Rico Mariani 的 Performance Tidbits 博客文章[Tracking down managed memory leaks (how to find a GC leak)](http://blogs.msdn.com/ricom/archive/2004/12/10/279612.aspx)并不能直接回答您的问题 re: Bytes in All Heaps and the Working Set，但它应该对您的任务 re:debugging some memory 问题有很大帮助与托管应用程序相关。

您可能还想查看[为了更好地使用内存而避免的两件事](http://blogs.msdn.com/ricom/archive/2003/12/02/40780.aspx)和[追踪由于未处理对象而导致的内存泄漏的三种技术](http://blogs.msdn.com/ricom/archive/2005/04/15/408650.aspx)。

所有的文章都很老了，但是提供的信息应该仍然对您有所帮助。

        .net - 如何将带有驱动器号的路径转换为 UNC 路径

ID：556649

赞同：12

时间：2009-02-17T12:53:20.847

标签：.net, path, unc

如何将带有驱动器号的路径转换为​​.Net`W:\Path\Share`中的等效 unc 路径？`\\server\Share\File`

您可以在命令提示符处运行`net use`，这将列出映射。我如何在 .Net 中获取该信息？

            回答 #1

赞同：6

时间：2009-02-17T13:12:33.780

您可以使用 P/Invoke 并调用本机函数，例如[WNetGetUniversalName](http://www.pinvoke.net/default.aspx/advapi32/WNetGetUniversalName.html)。

            回答 #2

赞同：2

时间：2009-02-17T13:14:32.667

要在 .NET 中获取当前计算机上的共享文件夹列表，您必须选择：

*   使用 System.Management 命名空间中的类[查询 Win32_share WMI 类](http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/a45da6f3-aa74-46e2-8e7b-a54562cd2b5e/)
*   使用 P/Invoke 在 Win32 中调用[NetShareEnum函数](http://pinvoke.net/default.aspx/netapi32/NetShareEnum.html)

请注意，调用进程将在具有管理权限的用户的上下文中运行，以使其正常工作。

            回答 #3

赞同：0

时间：2011-11-18T17:34:15.107

在这里回答您的问题`net use`是一个很好的解决方案
[Get UNC Path for Mapped Drive VB.net](https://stackoverflow.com/questions/2765015/get-unc-path-for-mapped-drive-vb-net)

我喜欢这种`net use`方式。

        javascript - YUI 3 链接

ID：556650

赞同：0

时间：2009-02-17T12:53:29.283

标签：javascript, jquery, yui

YUI 3 允许您编写

`Y.all(".foo").removeClass("bar");`

但是它不允许写入

`Y.all(".foo").removeClass("bar").set("innerHTML", "baz");`

似乎所有“操作”方法总是终止调用链。

这意味着 YUI 3 只提供了 jQuery 提供的链接功能的一半。

有谁知道这是为什么，如果有办法解决它？

            回答 #1

赞同：2

时间：2009-02-17T13:16:15.017

似乎因为 Y.all 返回了一个事物列表，所以在执行 removeClass 之后，返回的是一个对象数组，而不是 Node 对象。

但是，如果您使用

```
Y.get("#foo").removeClass("bar").set("innerHTML", "baz"); 
```

一切都按您的预期进行，因为它正在处理单个对象。

或许您应该将此告诉 YUI 人员并了解如何[报告错误](http://developer.yahoo.com/yui/articles/reportingbugs/)。也许这是预期的行为，但我认为你想要做的更强大。

            回答 #2

赞同：1

时间：2009-02-20T02:48:24.987

奥伦，

显然你已经意识到了这一点，但是为了那些后来偶然发现它的人完成这个线程——

[http://tech.groups.yahoo.com/group/ydn-javascript/message/45375](http://tech.groups.yahoo.com/group/ydn-javascript/message/45375)

简而言之，这是一个错误（由 Oren 打开），并在此处进行跟踪：

[http://yuilibrary.com/projects/yui3/ticket/2525997](http://yuilibrary.com/projects/yui3/ticket/2525997)

-埃里克

        c++ - 从 C++ 中静态对象的 C'tor 抛出/捕获异常

ID：556655

赞同：4

时间：2009-02-17T12:54:31.140

标签：c++, exception, dll, static, constructor

我有一个案例，我必须在 C'tor 中读取一个输入文件，但有时这个文件不存在。该对象通常是静态保存的，因此在加载 dll 时会调用其 C'tor。如果文件不存在，我无法捕捉到我抛出的异常，因为它太早了，而且我的可执行文件以一种丑陋的方式崩溃。我知道从 C'tor 中抛出异常是不好的做法，但是如果文件不存在，我就无法继续，所以我必须这样做。有没有办法在加载 dll 时捕获异常，如果没有，对于这种情况有没有更好的解决方案？

谢谢，盖尔

            回答 #1

赞同：8

时间：2009-02-17T13:12:32.873

我假设静态对象具有文件范围（它在任何函数/类定义之外）。您可以考虑将其移至访问器函数并仅通过该函数访问它，如下所示：

```
class Object;
Object& getObject()
{
    static Object object;
    return object;
} 
```

*Object*的静态实例将在第一次调用*getObject()*方法时被初始化。如果*Object*的构造函数抛出，您可以轻松捕获异常。只是你需要记住将*getObject()*的每个调用包装到一个 try/catch 块中（或者遭受异常冒泡堆栈链）；这可能有点不方便，但另一方面，如果您知道程序逻辑流中的哪个调用，您可以决定只包装逻辑上的“第一个”调用。

            回答 #2

赞同：3

时间：2009-02-17T13:39:32.060

从构造函数中抛出异常不一定是坏习惯。事实上，RAII 通常要求你做这种事情，因为对象有一个必须满足的内部不变量，如果构造函数无法初始化对象并使其处于有效状态，那么这是唯一的方法.

另一方面，从析构函数中抛出异常**是**一种不好的做法（也是一种危险的做法）。但是从构造函数中抛出它们应该没问题。

            回答 #3

赞同：2

时间：2016-02-29T19:08:01.413

如果您可以使用 c++11，那么有一个 lambda 和`unique_ptr<>`解决方案：

```
// In some_file.hpp
#pragma once
#include <memory>
#include <stdexcept>

class CtorThrows {
public:
  CtorThrows (int value) {
    if (value < 10) {
      throw std::runtime_error("oops!");
    }
  }
};

class ClassWithStatic {
public:
private:
  static std::unique_ptr<CtorThrows> bad_member_; // <-- static member
}; 
```

进而

```
// In some_file.cpp
#include "some_file.hpp"

// Create a lambda function to initialize the static member variable.
std::unique_ptr<CtorThrows> ClassWithStatic::bad_member_ = []() {
  try {
    int value = 5;  // in this case, it is a bad value

    // This only returns successfully if bad_value DOESN'T cause
    // the ctor to throw and exception.
    return std::make_unique<CtorThrows>(value);
  } catch (std::runtime_error &e) {
    std::cerr << "OOPs!  Here's a nice error message" << std::endl;
    exit(1);
  }
  return std::unique_ptr<CtorThrows>(nullptr);
}(); 
```

即使使用具有已删除或私有复制构造函数和复制赋值运算符的类，使用 a`unique_ptr`也可以做到这一点。

            回答 #4

赞同：1

时间：2009-02-17T12:57:34.157

重新设计对象，以便稍后打开文件 - 例如，当第一次请求文件中的数据时。

或者，用静态指针替换静态对象，并在需要时调用 new。最好使用像 auto_ptr 这样的智能指针。

            回答 #5

赞同：1

时间：2009-02-17T12:59:37.523

如何将输入文件与构造函数分开读取？您可以有一个单独的 Init() 方法，必须在构造对象之后但在对象实际准备好使用之前调用该方法。

            回答 #6

赞同：1

时间：2009-02-17T13:01:05.147

您是对的，您无法捕获在静态对象初始化期间发生的异常。

由于您正在编写 DLL：每个 DLL 都可以有一个入口点，并且在此入口点内异常处理有效。（它与您的主程序中的 main 相同）。我会删除你的类的静态实例，用指针替换它们并在 dllmain 中初始化这些指针。

这将一劳永逸地解决您的问题。

顺便说一句 - DLL 入口点在加载、卸载和其他事件（例如进程附加/分离等）时被调用。确保您使用正确的位置来初始化您的类。

            回答 #7

赞同：0

时间：2009-02-17T13:07:45.477

一种方法可能是“设计”它以使调用代码（即 dll 外部的代码）负责确保 dll 的所有依赖项都到位。调用代码中的一个函数，确保 dll 的依赖项（在本例中为文件）就位并且在加载库之前可加载。如果没有，它可以优雅地退出。

        c# - 在 C# 中延迟发送电子邮件

ID：556667

赞同：10

时间：2009-02-17T12:57:36.607

标签：c#, .net, asp.net, email

我们正在编写一项功能，以在 x 天后向客户发送提醒电子邮件，只是想知道是否可以像在 Outlook 中一样延迟发送电子邮件（新邮件 > 选项按钮 > 之前不要发送）在 C# 中。

有谁知道这样做的方法？

            回答 #1

赞同：10

时间：2009-02-17T13:03:56.903

如果您想将电子邮件提交到 SMTP 服务器以保留数天，则该服务器必须支持此功能。但是，我建议不要这样做。如果您有丢失电子邮件的问题，则可能很难追查。

这是我要做的：

1.  通过创建表格条目来安排系统  中*的*电子邮件。
2.  在表格中包含“SendDate”列，您可以在其中设置未来的日期
3.  编写一个每 15 分钟唤醒一次的 Windows 服务（例如），并在 SendDate < currentDate 的表中发送电子邮件

            回答 #2

赞同：4

时间：2009-02-17T13:04:13.067

一种可能性是创建一个在计划任务处理“待处理”邮件上运行的服务。您可以将待处理的邮件存储在 SQL 数据库中。（戴夫详细说明了这一点）

如果您想避免“真正的”服务，这篇文章看起来很有希望

[http://www.codeproject.com/KB/aspnet/ASPNETService.aspx](http://www.codeproject.com/KB/aspnet/ASPNETService.aspx)

            回答 #3

赞同：3

时间：2009-02-17T13:04:26.030

不。

实现这一点的方法是让您的应用程序将电子邮件写入队列（可能是数据库、文件、MSMQ 等），然后编写一个单独的进程，该进程稍后从该队列读取邮件并发送它.

据我所知，SMTP 协议没有任何“延迟发送”功能。此外，您在 Outlook 中引用的功能实际上只是在指定日期之前将其保留在客户端的发件箱中，因此它是客户端功能，而不是服务器端功能。

            回答 #4

赞同：1

时间：2009-02-17T13:03:49.417

SmtpClient 是一个非常愚蠢的客户端，不支持这一点——无论是同步的还是异步的，发送都是立即的。您可以使用 Exchange 集成来完成此操作。不过，我不确定为 Exchange 公开了哪些 API。最简单的方法是将消息与发送时间一起保存在数据库表中，并有一个离线进程定期扫描该表并查找发送时间值已过且未标记的消息如发送。

        visual-studio - 正在跳过文档加载 - 导致此问题的文档是什么？

ID：556669

赞同：36

时间：2009-02-17T12:58:06.357

标签：visual-studio, visual-studio-2008

在 VS2008 中加载解决方案时，我得到：

上次加载此解决方案时打开关联文档时遇到错误。在此解决方案加载期间将跳过文档加载，以避免该错误。

如何找到导致问题的文档？

            回答 #1

赞同：22

时间：2009-02-19T20:35:08.417

我不能说我已经看到了这个特定的错误，但我想知道它是否可能存储在与您的解决方案关联的 .suo 文件中。.suo 是 VS 跟踪您之前打开的文件的地方，因此它也可能跟踪失败的文件。您可以尝试重命名或删除该文件，然后重新加载解决方案以查看错误是否消失。不幸的是，这些文件并不完全是人类可读的，因此如果证明是位置，确定哪个文件有问题可能并非易事。

            回答 #2

赞同：9

时间：2010-05-25T18:01:41.500

我通过 Build->Clean Solution 清理了我的解决方案。

然后我重建了我的解决方案。似乎对我有用。

*编辑：我使用 VS 2010*

            回答 #3

赞同：3

时间：2010-01-06T16:02:48.617

我整个早上都被这个问题所困扰，所以我一直在做一些强制研究。这是一个可能会有所帮助的花絮，以及我找到的一些链接（但 IO 尚未全部阅读）。

首先，花絮。似乎如果我可以完全打开解决方案（我可以，第二次，当 VS.NET 跳过“文档加载”步骤时），然后立即执行全部重建，这可能会“解决”问题（意思是，问题会暂时消失，几天后会出现，但至少我可以完成一些工作）。

当然，这可能是一个转移注意力的问题，但现在看来是正确的。

接下来，这是我找到的一些链接。我还没有阅读所有这些，但它们是关于这个问题或非常相似的问题，它们可能会对某人有所帮助。

[http://social.msdn.microsoft.com/forums/en-US/vssetup/thread/cb73c8d6-077f-4220-aaf8-463039ee1d5f](http://social.msdn.microsoft.com/forums/en-US/vssetup/thread/cb73c8d6-077f-4220-aaf8-463039ee1d5f/) 

[为什么 Visual Studio 在使用 MVC RC1 打开 ASPX 时会崩溃](https://stackoverflow.com/questions/500696/why-does-visual-studio-crash-opening-aspx-with-mvc-rc1)

[Resharper (R#) 4.5 和 MVC (1.0) 解决方案导致 Visual Studio 2008 SP1 在解决方案加载时崩溃](https://stackoverflow.com/questions/1361291/resharper-r-4-5-and-mvc-1-0-solutions-cause-visual-studio-2008-sp1-to-crash) 

[http://www.lostechies.com/blogs/hex/archive/2009/03/02/hot-fix-available-for-visual-studio-2008-sp1-crashing-when-opening-up-aspx-files-视图-vista-sp1-x64.aspx](http://www.lostechies.com/blogs/hex/archive/2009/03/02/hot-fix-available-for-visual-studio-2008-sp1-crashing-when-opening-up-aspx-files-views-on-vista-sp1-x64.aspx) 

[http://www.chowamigo.co.uk/2009/10/fix-visual-studio-hangs-crashes-and.html](http://www.chowamigo.co.uk/2009/10/fix-visual-studio-hangs-crashes-and.html) 

[http://forums.asp.net/p/1384470/2942121.aspx#2942121](http://forums.asp.net/p/1384470/2942121.aspx#2942121) 

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=471570](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=471570) 

[http://blogs.msdn.com/jnak/archive/2009/02/26/fix-available-asp-net-mvc-rc-crash-in-a-windows-azure-cloud-service-project.aspx](http://blogs.msdn.com/jnak/archive/2009/02/26/fix-available-asp-net-mvc-rc-crash-in-a-windows-azure-cloud-service-project.aspx)

            回答 #4

赞同：3

时间：2012-02-08T15:36:28.913

我正在使用 VS2010 并且有同样的错误。我删除了与解决方案关联的 2 个 SUO 文件，它运行良好。

            回答 #5

赞同：1

时间：2009-08-17T15:39:47.423

我也有这个问题。我删除了与解决方案关联的 *.suo 文件。当我尝试再次加载解决方案时，我收到了同样的错误提示，只是这次 Visual Studio 没有立即崩溃。当我在错误对话框上单击“确定”时，解决方案似乎加载得很好。

            回答 #6

赞同：1

时间：2010-09-02T19:18:09.167

可能无法确定是哪个文件导致了问题。类似的错误已在各种不同的情况下报告，除了在最后一次成功打开和关闭解决方案时至少有 1 个文件仍处于打开状态以进行编辑的情况。

我自己在 WinDbg 处于活动状态时查看了这一点，调用堆栈中充满了线程/模块卸载状态的 DLL 链。这很可能是由 Visual Studio 中的竞争条件或其他错误的多线程行为引起的。

以下是您可以查看的其他参考资料，以防其他人使用其他信息更新它们。

[IDE 报告错误...@Microsoft Connect](https://connect.microsoft.com/VisualStudio/feedback/details/516629/ide-reports-error-an-error-was-encountered-while-opening-associated-documents-the-last-time-this-solution-was-loaded-document-load-is-being-skipped)

[错误加载解决方案 100% 的时间...@Microsoft Connect](https://connect.microsoft.com/VisualStudio/feedback/details/551353/error-on-loading-solution-100-of-the-time)

[打开相关文档时出错...@Stack Overflow](https://stackoverflow.com/questions/2596574/error-opening-associated-documents-message-when-loading-vs)

**编辑：**

我应该补充一点，我关于这是一个竞争条件的结论是基于在尝试使用 WinDbg 在 Visual Studio 中创建崩溃的小型转储时收集的线索；以及旧版本 Visual Studio 中存在类似无法解释的错误的历史记录。

在我的探索中，WinDbg 不断报告由于失败而无法为此崩溃创建小型转储`ReadProcessMemory`。堆栈跟踪包含由于各种原因调用的 DllUnloads 跟踪。如果在上次关闭解决方案时没有打开任何文档视图，则没有发生此错误的报告。结合这些线索，我的猜测是实例化顺序存在错误；也许当打开两个相同类型的视图时，一个先于另一个完成并导致两个操作共享的资源的清理。

这可能不是竞争条件或线程错误，尽管症状强烈暗示了这一点。幸运的是，对于我自己和其他提出答案的人来说，当我遇到这个错误时，删除 .SUO 文件（以及旧版 Visual Studio 中的 .NCB 文件）可以解决问题。

            回答 #7

赞同：0

时间：2021-01-25T13:26:34.110

我今天在 Visual Studio 2019 中收到此错误。我分两步解决了

1.  构建 | 清洁解决方案
2.  重建解决方案

我不确定上述两个步骤中的哪一个成功了，但我确信它是固定的。如果没有 Stack，我将一事无成。感谢大家在本站发帖。

            回答 #8

赞同：0

时间：2016-07-14T18:08:08.053

当我尝试关闭 VS 时收到此“跳过文档加载”错误，然后收到“对象引用未设置为对象实例”错误。我通过删除修复了这两个问题：

*   C:\Users{user}\AppData\Local\Microsoft\VisualStudio\ComponentModelCache 和
*   C:\Users{用户}\AppData\Local\Microsoft\VisualStudio\devenv.exe.config
*   C:\Users{user}\AppData\Local\Microsoft\VisualStudio.NETFramework,Version=v4.0,Set=Extensions,Hash=6D09DECC.dat
*   C:\Users{user}\AppData\Local\Microsoft\VisualStudio.NETFramework,Version=v4.0,Set=Extensions,Hash=9951BC03.dat
*   C:\Users{user}\AppData\Local\Microsoft\VisualStudio.NETFramework,Version=v4.5.2,Set=RecentAssemblies,Hash=0.dat

当我加载我的项目时，我发现前两个导致与丢失包相关的其他错误，以及在尝试关闭 VS 时“对象引用未设置为对象的实例”，并且从 JavaScript 语言接收错误服务，抱怨最后的 .NETFramework 文件中缺少 js 文件（如果我不重新添加它们，我不会得到）：

```
01:10:11.7550: Referenced file 'C:\Program Files (x86)\Microsoft Visual Studio 14.0\JavaScript\References\libhelp.js' not found.
01:10:11.7550: Referenced file 'C:\Program Files (x86)\Microsoft Visual Studio 14.0\JavaScript\References\sitetypesWeb.js' not found.
01:10:11.7550: Referenced file 'C:\Program Files (x86)\Microsoft Visual Studio 14.0\JavaScript\References\domWeb.js' not found.
01:10:11.7550: Referenced file 'C:\Program Files (x86)\Microsoft Visual Studio 14.0\JavaScript\References\underscorefilter.js' not found.
01:10:11.7550: Referenced file 'C:\Program Files (x86)\Microsoft Visual Studio 14.0\JavaScript\References\showPlainComments.js' not found. 
```

我可能只需要重新安装/修复 JavaScript 语言服务插件，这些文件可能会被“跳过”。但我会尝试删除上面列出的所有文件并重新启动 Visual Studio。除了 .NETFramework 文件外，它们应该被重新创建。如果您愿意，您可以备份 .NETFramework 文件，然后删除它们，然后一次将它们粘贴回去，然后在您执行的每个文件复制之间重新启动 VS，以缩小范围，就像我所做的那样。

[在安装 ASP.NET 和 Web 工具 2015（RC1 更新 1）后，我在 Visual Studio 2015 错误“对象引用未设置为对象的实例”中](https://stackoverflow.com/questions/34084003/visual-studio-2015-error-object-reference-not-set-to-an-instance-of-an-object)发布了我用来解决此问题的过程

        java - 对 Java + OpenPGP 的推荐？

ID：556670

赞同：6

时间：2009-02-17T12:59:01.610

标签：java, cryptography, pgp, gnupg, openpgp

我想开发一个小型 OpenPGP 客户端，并且正在为 OpenPGP 搜索 Java 库。

这种方法是否有任何（开源）建议？

[Cryptix.org](http://www.cryptix.org/)似乎不再活跃了......

            回答 #1

赞同：9

时间：2009-02-17T14:27:26.953

我找到了用于 Java 和 C# 的[BouncyCastle](http://www.bouncycastle.org)库。我没有任何经验。我会尝试并在这里报告。

它提供：

1.  用于 Java 和 C# 的轻量级加密 API。
2.  Java Cryptography Extension 和 Java Cryptography Architecture 的提供者。
3.  JCE 1.2.1 的洁净室实现。
4.  用于读取和写入编码 ASN.1 对象的库。
5.  一个轻量级的客户端 TLS API。
6.  版本 1 和版本 3 X.509 证书、版本 2 CRL 和 PKCS12 文件的生成器。
7.  版本 2 X.509 属性证书的生成器。
8.  S/MIME 和 CMS (PKCS7/RFC 3852) 的生成器/处理器。
9.  OCSP 的生成器/处理器 (RFC 2560)。
10.  TSP 的生成器/处理器 (RFC 3161)。
11.  OpenPGP (RFC 4880) 的生成器/处理器。
12.  适用于 JDK 1.4-1.6 和 Sun JCE 的签名 jar 版本。

（来自 BouncyCastle.org）

            回答 #2

赞同：2

时间：2009-06-21T06:22:08.517

在 BouncyCastle 之上有一个商业库：[http](http://www.didisoft.com/) ://www.didisoft.com/ ，它极大地简化了 BouncyCastle API。

我没有尝试过，只是发现它在 jGuru 上提到过。

我认为单独使用 BouncyCastle 是安全的。他们的库正在开发中，他们提供 openpgp 示例......

            回答 #3

赞同：1

时间：2012-08-31T15:13:48.630

仅出于完整性考虑：我们的 SecureBlackbox（Java 版）包括[用于 Java 和 Android 的 OpenPGP 组件，](http://www.eldos.com/sbb/java-pgp.php)比 BouncyCastle 丰富得多，并提供支持、示例和文档。

            回答 #4

赞同：0

时间：2009-02-25T19:30:00.373

有[PGPJava](http://www.iam.unibe.ch/~jampen/pgpjava/index.html)，但它已经很老了。

            回答 #5

赞同：0

时间：2021-09-23T12:02:40.787

您可能想尝试同样基于 Bouncycastle 的 PGPPainless，并且在 OpenPGP 互操作性测试套件上得分[相当](https://github.com/pgpainless/pgpainless)[不错](https://tests.sequoia-pgp.org/)。

        delphi - 在 pdf 文件中搜索单词

ID：556671

赞同：0

时间：2009-02-17T12:59:03.077

标签：delphi, search, pdf

是否可以使用delphi在pdf文件中搜索“单词”？

我有代码，可以在许多其他文件中搜索，例如（exe、dll、txt），但它不适用于 pdf 文件。

            回答 #1

赞同：2

时间：2009-02-17T13:02:15.753

这取决于特定 PDF 的结构。

如果 pdf 由图像（扫描页面）组成，那么您必须对每个图像进行 OCR 并在 PDF 中构建全文索引。（要查看它是否基于图像，请使用记事本打开它并查找充满随机字符的 obj 标签）。有一些实用程序和应用程序可以为您完成此类工作，[CVision](http://www.cvisiontech.com/) PDF 压缩器是我以前使用过的一个。  

如果 pdf 是标准 PDF，那么您应该能够像任何其他文本文件一样打开它并搜索单词。

[这](http://www.planetpdf.com/developer/article.asp?ContentID=navigating_the_internal_struct)是详细介绍PDF的一些结构的页面。[这](https://stackoverflow.com/questions/88582/structure-of-a-pdf-file)是相同的SO帖子。

            回答 #2

赞同：2

时间：2009-02-17T13:19:53.590

[该问题](https://stackoverflow.com/questions/530052/looking-for-a-pdf-file-parser "寻找 PDF 文件解析器")的答案中提到的组件/库应该可以满足您的需求。

            回答 #3

赞同：1

时间：2009-02-17T18:29:37.417

我使用的一种选择是使用 Microsoft 的[ifilter](http://ifilter.org/)技术，Windows 桌面搜索和许多其他产品（如 sharepoint 和 SQL server 全文搜索）都使用了该技术。

它支持几乎任何办公室/类似办公室的文件格式，甚至 dwg、msg、pdf 和 zip/rar 档案中的文件。

使用它的最简单方法是在您拥有的任何文件上运行 FiltDump.exe，并索引文本输出。

要了解您 PC 上安装的过滤器，您可以使用[ifilter explorer](http://www.citeknet.com/Products/IFilters/IFilterExplorer/tabid/62/Default.aspx)。Wikipedia 在其[ifilters 页面](http://en.wikipedia.org/wiki/IFilters)上有一些链接。

            回答 #4

赞同：1

时间：2009-02-17T13:40:28.563

我只是在做一个这样做的项目。我使用的方法是将 PDF 文件转换为纯文本（使用 pdftotext.exe）并在结果文本上创建索引。我们对word和其他office文件做同样的事情，效果很好！

我认为直接从 Delphi 搜索 pdf 文件（没有外部应用程序）更困难。如果您发现任何东西，请在此处更新，因为我也会对此非常感兴趣！

            回答 #5

赞同：1

时间：2009-05-24T23:25:13.033

Quick PDF Library 的[GetPageText](http://www.quickpdflibrary.com/help/quickpdf/GetPageText.php)功能可以为您提供 PDF 中的单词以及这些单词的页码和坐标 - 有时对突出显示很有用。

            回答 #6

赞同：0

时间：2009-02-17T13:03:29.010

PDF 不仅仅是一种二进制表示。将其视为对象树，其中对象节点具有一些元数据和一些内容信息。其中一些对象具有字符串数据，有些则没有。其中一些甚至是加密的，有些是压缩的。因此，您的字符串查找器几乎不可能在任意 PDF 上工作。

        sql - 需要复杂的 SQL 查询

ID：556673

赞同：1

时间：2009-02-17T12:59:51.093

标签：sql, dynamic

我需要做一个相当复杂的查询，我需要帮助。下面是我做的一个例子。

基本上，我需要一个查询，该查询将为每个**case_id**返回一行，其中 type 为**support**、 status **start**和 date 表示创建的第一个（因此在下面的示例中，仅返回 2/1/2009 John 的案例，而不是 2009 年 3 月 1 日）。搜索需要是动态的，以便能够从具有数千行的表中返回具有不同 case_id 等的所有相似行。

在那之后还有更多，但我还不知道所有的细节，如果你们（一个女孩）可以在这里帮助我，我想我可以弄清楚。:)

```
身份证 | 案例_ID | 姓名 | 日期 | 状态 | 类型   

48 | 450 | 约翰 | 2009 年 6 月 1 日 | 固定 | 支持   
47 | 450 | 约翰 | 2009 年 4 月 1 日 | 搬家 | 支持   
46 | 第451章 莎拉 | 2009 年 3 月 1 日 | |           
45 | 第432章 约翰 | 2009 年 3 月 1 日 | 固定 | 危急  
44 | 450 | 约翰 | 2009 年 3 月 1 日 | 开始 | 支持
42 | 450 | 约翰 | 2009 年 2 月 1 日 | 开始 | 支持   
41 | 440 | 本 | 2009 年 2 月 1 日 | |           
40 | 第432章 约翰 | 2009 年 1 月 1 日 | 开始 | 危急  
...

```

非常感谢！

编辑：

为了回答一些人的问题，我使用的是 SQL Server 2005。日期只是普通日期，而不是字符串。

好的，现在我进一步解决了这个问题。我最终得到了 Bliek 的解决方案，它就像一个魅力。但是现在我遇到了有时状态永远不会启动的问题，因为它立即解决了。我也需要将其包括在内。但仅限于一定时期。

我想我将不得不在这里检查 FK Case_ID 引用的案例表。所以我需要一种方法来检查过去一个月内在 CaseTable 中创建的每个 Case_ID，然后在同一个表中以与上面发布的相同的方式运行这些搜索，只返回第一个结果。我怎么能像那样使用另一张桌子？

像往常一样，我会在等待时自己寻找答案，再次感谢！

编辑2：

似乎这就是答案。我还没有访问完整的数据库，所以我不能完全测试它，但它似乎正在使用我创建的虚拟表，从 Bliek 的代码的 WHERE 子句继续：

```
WHERE RowNumber = 1 AND Case_ID IN (SELECT Case_ID FROM CaseTable
      地点（日期在“2007/11/1”和“2007/11/30”之间））

```

日期又搞砸了，但你明白我敢肯定。感谢大家的帮助！如果还有更多问题，我会回来的，但我认为有了这些信息，我可以即兴解决我目前必须处理的大多数 SQL 问题。:)

            回答 #1

赞同：4

时间：2009-02-17T13:10:36.827

也许是这样的：

```
select Case_ID, Name, MIN(date), Status, Type 
from table
where type = 'Support'
 and status = 'Start'
group by Case_ID, Name, Status, Type 
```

编辑：你没有提供很多关于你真正想要的细节，所以我建议你阅读所有答案并选择一个最适合你问题的答案。到目前为止，我会说 Tomalak 的答案最接近您正在寻找的内容......

            回答 #2

赞同：3

时间：2009-02-17T13:12:06.370

```
SELECT
  c.ID,
  c.Case_ID,
  c.Name,
  c.Date,
  c.Status,
  c.Type
FROM
  CaseTable c
WHERE
  c.Type = 'Support'
  AND c.Status = 'Start'
  AND c.Date = (
    SELECT MIN(Date) 
    FROM CaseTable
    WHERE Case_ID = c.Case_ID AND Type = c.Type AND Status = c.Status)
/* GROUP BY only needed when for a given Case_ID several rows 
   exist that fulfill the WHERE clause */
GROUP BY
  c.ID,
  c.Case_ID,
  c.Name,
  c.Date,
  c.Status,
  c.Type 
```

此查询极大地受益于`Case_ID`、`Date`和列上`Status`的索引。`Type`

尽管过滤器打开`Support`并且`Status`只需要在一个地方设置，但它的附加值。

作为该`GROUP BY`子句的替代方案，您可以这样做`SELECT DISTINCT`，这将增加可读性（这可能会或可能不会影响整体性能，我建议您将两个变体相互衡量）。如果您确定`Case_ID`表中没有两行具有相同的日期，您将不需要`GROUP BY`或根本不需要`SELECT DISTINCT`。

            回答 #3

赞同：1

时间：2009-02-17T14:38:36.020

在 SQL Server 2005 及更高版本中，我将使用公用表表达式 (CTE)。这提供了很多这样的可能性：

```
With ResultTable (RowNumber
                 ,ID
                 ,Case_ID
                 ,Name
                 ,Date
                 ,Status
                 ,Type)
AS
(
    SELECT Row_Number() OVER (PARTITION BY Case_ID
                                  ORDER BY Date ASC)

          ,ID
          ,Case_ID
          ,Name
          ,Date
          ,Status
          ,Type
      FROM CaseTable
     WHERE Type   = 'Support'
       AND Status = 'Start'
)
    SELECT ID
          ,Case_ID
          ,Name
          ,Date
          ,Status
          ,Type
      FROM ResultTable
     WHERE RowNumber = 1 
```

            回答 #4

赞同：0

时间：2009-02-17T13:12:24.043

不要为您的日期格式道歉，这样更有意义。

```
 SELECT ID, Case_ID, Name, MIN(Date), Status, Type
    FROM caseTable
    WHERE Type = 'Support'
       AND status = 'Start'
    GROUP BY ID, Case_ID, Name, Status, Type 
```

        vb6 - VB6 Ide 中的预构建事件（类似于 Visual Studio 2005）

ID：556674

赞同：5

时间：2009-02-17T13:00:07.740

标签：vb6, ide

有谁知道VB6 IDE是否有能力在制作和编译代码之前运行预构建事件（这是为了从模板文件创建一个.vb文件，以便使用SubWCRev.exe将subversion修订号编译成代码） .

谢谢

            回答 #1

赞同：5

时间：2009-02-17T13:19:47.070

IDE 没有方法可以做到这一点。我的公司构建了一个实用程序（在 VB6 中）来执行我们的自动化构建过程，包括您提到的步骤（更新版本号等）。

基本技巧是您可以从命令行运行 VB6.exe 来编译项目。要查看所有选项的列表，只需转到 VB6 目录并键入

```
VB6 /? 
```

将出现所有命令行选项的列表。

这就是我们用于构建实用程序的内容。

```
VB6 /Make <project name> /out <errorlog filename> 
```

我们将项目复制到临时项目文件中，并使用复选框和参数文件对其进行更改。例如，我们可以选择将所有内容编译为二进制兼容或项目兼容。VB6 项目文件很容易操作，因为它们只是文本。如果您编写自己的构建实用程序，您可以做很多事情。

            回答 #2

赞同：0

时间：2009-02-17T20:26:27.027

我们使用[Visual Build Pro](http://www.kinook.com/VisBuildPro/)来执行此操作。它内置支持更新 VB6 项目的版本号。我们的项目组包括约 7 个 ActiveX 项目，在 VB 中以正确的顺序构建这些项目非常痛苦，因此我们总是使用 Visual Build Pro，因为它会根据项目的依赖关系以正确的顺序自动处理构建项目。

            回答 #3

赞同：0

时间：2009-02-17T20:30:17.877

NAnt（或者可能是 NAnt.Contrib）对构建 vb6 项目有一些支持。然后 NAnt 可以处理所有的前/后构建事件。只是为一些调整做好准备。

        flash - 缩短功能代码并转换变量

ID：556676

赞同：-1

时间：2009-02-17T13:01:01.123

标签：flash, actionscript, function, actionscript-2, movieclip

我有这个 AS2 代码，当我使用 TweenLite 翻转 mc 时，它会执行一些简单的动画。

我觉得我有很多重复的代码。

有没有办法可以只指定这样的功能

框链接（一）；

并有其余的代码，在函数中而不是在函数变量中具有目标影片剪辑的路径？

我怎样才能使这段代码尽可能短？

是否可以将变量：String 转换为变量：MovieClip？在这个例子中我会怎么做？

```
 import gs.*;
 import gs.easing.*;

function imageAlpha(mc_target:MovieClip) {
    mc_target.onRollOver = function() {
            TweenLite.to(mc_target,1,{_alpha:100, ease:Back.easeOut});
    };

    mc_target.onRollOut = function() {
            TweenLite.to(mc_target,1,{_alpha:60, ease:Back.easeOut});
    };
 }

  function boxLink(mc_function:MovieClip, mc_target:MovieClip, mc_image:MovieClip, linkURL:String) {
    mc_function.onRollOver = function() {
            TweenLite.to(mc_target,0.5,{_xscale:150, _yscale:150, ease:Back.easeOut});
            TweenLite.to(mc_image,1,{_alpha:100, ease:Back.easeOut});
    };

    mc_function.onRollOut = function() {
            TweenLite.to(mc_target,0.5,{_xscale:100, _yscale:100, ease:Back.easeOut});
            TweenLite.to(mc_image,1,{_alpha:60, ease:Back.easeOut});
    };

    mc_function.onRelease = function() {
            if (linkURL) {
            getURL(linkURL);
            }
    };
 }

 imageAlpha(a_box.image);
 imageAlpha(b_box.image);
 imageAlpha(c_box.image);
 imageAlpha(d_box.image);

 boxLink(a_box.link1,a_box.arrow1,a_box.image,'http://www.google.no');
 boxLink(a_box.link2,a_box.arrow2,a_box.image,'http://www.google.no');
 boxLink(a_box.link3,a_box.arrow3,a_box.image,'http://www.google.no');

 boxLink(b_box.link1,b_box.arrow1,b_box.image,'http://www.google.no');
 boxLink(b_box.link2,b_box.arrow2,b_box.image,'http://www.google.no');
 boxLink(b_box.link3,b_box.arrow3,b_box.image,'http://www.google.no');

 boxLink(c_box.link1,c_box.arrow1,c_box.image,'http://www.google.no');
 boxLink(c_box.link2,c_box.arrow2,c_box.image,'http://www.google.no');
 boxLink(c_box.link3,c_box.arrow3,c_box.image);

 boxLink(d_box.link1,d_box.arrow1,d_box.image,'http://www.google.no');
 boxLink(d_box.link2,d_box.arrow2,d_box.image,'http://www.google.no');
 boxLink(d_box.link3,d_box.arrow3,d_box.image); 
```

            回答 #1

赞同：2

时间：2009-02-17T16:07:25.980

使用数组而不是命名变量

```
a_box.link_1, a_box.link_2, ..., a_box.link_3 
```

变成

```
a_box.link[ i ] where i = 0 to n-1, n = number of links 
```

箭头也是如此。

接下来，为`boxLink()`

```
public function 
boxLinkWrapper(x:BoxType, url:string='http://www.google.no') :ReturnType {
    for (i:int = 0; i < x.link.size; ++i) {
        boxLink(x.link[ i ], x.arrow[ i ], x.image, url);
    }
} 
```

此外，由于您有许多这样的框，请将它们放在一个数组中：

```
var boxes:Array = new Array();
boxes.push(new Box("a")); //a_box
boxes.push(new Box("b")); //b_box 
```

并总结每个盒子所需的步骤：

```
public function 
processBox(x:BoxType):SomeReturnType {
    imageAlpha(d_box.image);
    boxLink(a_box.link1,a_box.arrow1,a_box.image,'http://www.google.no');
} 
```

并在数组框上运行 for 循环，或使用 forEach() 成员函数：

```
boxes.forEach(processBox); 
```

不要忘记将 BoxType、SomeReturnType 和 ReturnType 替换为适当的类型。这有帮助吗？**（注意：这是未经测试的代码，但应该可以帮助您入门！）**

        c++ - 如何清除为自定义异常分配的内存

ID：556683

赞同：0

时间：2009-02-17T13:03:26.017

标签：c++, exception, memory-leaks

我有一个自定义的异常类。说类 CustomExcep{};

我的应用程序是由 C++ 制成的中间件。它是一个 Web 服务，用于基于 Java 的 Web 前端和 DCE 后端之间的通信。

每当 DCE 后端由于某些核心转储而未运行或关闭时，应用程序都会抛出 CustomExcep。

就像这样。

CustomExcep * exc = new CustomExcep(); 抛出异常；

我无法为此使用堆栈内存，因为它会导致一些运行时异常。

我需要一个解决方案来清除此 CustomException 使用的内存。我们可以为此目的使用模板吗？

任何帮助，将不胜感激。提前致谢。

            回答 #1

赞同：1

时间：2010-01-15T13:51:54.930

使用 static 关键字预先分配异常。

```
static const CustomExcep e;
throw e; 
```

Microsoft 的“新”运算符的 VC++ 实现使用了这种技术。通过使用 static 关键字，在整个应用程序生命周期中只会创建一个异常，然后在每次调用中重用。这样你就不用担心删除了。

当涉及到异常时，使用其他方法会更加复杂，因为它们在内部是如何处理的。一般来说，应避免使用 new ，但有例外。如果我有时间，我会回来进一步解释。

            回答 #2

赞同：0

时间：2009-02-17T13:05:17.323

当您捕获异常时，您需要`delete`它。

            回答 #3

赞同：0

时间：2009-02-17T13:06:54.667

您*应该*能够为此使用堆栈。如果你不是，那可能就是你需要解决的真正问题。

我根本不建议在堆上创建异常。

            回答 #4

赞同：0

时间：2009-02-17T13:17:21.303

正如 Frederick 所提到的，您可能应该选择基于堆栈的解决方案。如果您担心复制的成本（或副作用）而不担心分配失败，您可以在异常类中分配内存并将其存储在智能指针成员中，从而使复制过程变得便宜且无副作用，你的记忆会自动释放。

        winforms - 如何在 WinForms .NET 中编写递归自定义控件

ID：556698

赞同：0

时间：2009-02-17T13:06:05.277

标签：winforms, user-controls, controls, recursion

我正在尝试在 WinForms .NET（不是 ASP.NET）中编写“用户控件”。控制比较简单。它将包含一个标签、一个按钮和一个 DataGridView。

但是，控件需要能够实例化自身，即当用户单击（父控件的）按钮时，下面将显示至少 1 个相同类型的嵌套（子）控件（有点像树）

我没有成功使用“用户控件”编写这样的递归控件。在其自己的构造函数中实例化 MyControl 时会发生 StackOverflow 异常。

因此，我倾向于使用“自定义控件”，希望它可以处理自身的实例化（可能在 Paint 事件中？？）。然而，更多的工作需要进入自定义控件，所以如果它要永远走下去，我不想走这条路。我的期限很紧。

有人使用自定义控件完成此操作，或者对如何创建递归控件有任何可靠的想法吗？

顺便说一句，这个控件将用于相当有限数量的递归组合，所以为每个父/子场景创建一个单独的控件可能会更好？我认为这将导致至少 10 个单独的用户控件。

感谢您的帮助

**更新**（根据您的反馈，这是我在停止条件下的初步尝试，但这仍然会导致无限期地创建孩子）：

```
公共部分类 CustomX：UserControl
    {
        私人 IList _children = new List();

        公共自定义X（）
        {
            初始化组件（）；

            递归（0）；

        }

        私人无效递归（int childCount）
        {
            如果 (childCount

```

            回答 #1

赞同：2

时间：2009-02-17T13:14:57.627

问题可能是子控件也实例化了子控件。必须有一个停止条件，否则将生成控件，直到堆栈溢出。

这应该有效：

```
public partial class CustomX : UserControl
    {
        private IList _children = new List();

        public CustomX(int depth)
        {
            InitializeComponent();
            if(depth > 0)
            {
                CustomX child = new CustomX(depth-1);
                this.Controls.Add(child)
            }
        }
    } 
```

            回答 #2

赞同：2

时间：2009-02-17T13:16:36.780

使用用户控件执行此操作应该没有问题。更可能是没有正确终止递归的问题。仅在最顶层的父控件中执行控件创建（而不是将该任务委托给每个构造函数）（可能）更具可读性。

您可以发布您在构造函数中的代码吗？

        asp.net-mvc - 如何最好地实现“网站关闭”功能？

ID：556703

赞同：0

时间：2009-02-17T13:07:47.970

标签：asp.net-mvc

我们需要通过远程通知（数据库值更改）自动关闭我们的 ASP.NET MVC 网站。哪里是实现这一点的最佳地点？

*   基本控制器类
*   全球.asax
*   自定义属性
*   其他

**更新**

有很多使用 app_offline 的建议，但是这种情况每天都会发生，并且完全由数据库启动，所以我宁愿让应用程序主动而不是外部推送文件。

此外，我可能需要将用户重定向到一个保留页面（最好是 MVC 控制器方法以保持一切一致）。我更倾向于在我的 BaseController 中捕获它并让它处理它

            回答 #1

赞同：13

时间：2009-02-17T13:16:45.283

有一种“优雅地”终止 ASP.NET 2.0 webapp 的标准方法 - 只需将 a 拖放`App_Offline.htm`到应用程序的根目录即可。看到[这个](http://weblogs.asp.net/scottgu/archive/2006/04/09/442332.aspx)。

            回答 #2

赞同：5

时间：2009-02-17T13:12:11.050

如果您必须以编程方式进行，我会选择 Global.asax Application_BeginRequest。

您可以将页面 Response.Redirect 到“Offline.aspx”，它可以从数据库或您需要的任何内容中检索消息。当然，您必须查看请求以查看它是否正在尝试访问“Offline.aspx”，否则您将陷入无限循环。

或者，也许您的所有应用程序都可以重定向到一个网站，这将消除大部分复杂性。

            回答 #3

赞同：2

时间：2009-02-17T16:40:36.977

我将自己回答这个问题，因为我以不同的方式回答了这个问题，但感谢大家的回答。

我最终做的是在我的 BaseController 类中覆盖 OnActionExecuting() （我的所有控制器都派生自该类）。

在这种方法中，我检查数据库（使用 1 分钟缓存），如果网站关闭，我加载视图以显示关闭消息。代码如下所示

```
Protected Overrides Sub OnActionExecuting(ByVal filterContext As System.Web.Mvc.ActionExecutingContext)
            MyBase.OnActionExecuting(filterContext)

            Dim _cfgService = ObjectFactory.GetInstance(Of IConfigService)()

            If _cfgService.DynamicConfig.WebSiteClosed Then
                filterContext.Result = ErrorHandler(_cfgService.DynamicConfig.WebSiteClosedTitle, _
                                                    _cfgService.DynamicConfig.WebSiteClosedMessage)
            End If
        End Sub 
```

            回答 #4

赞同：1

时间：2009-02-17T19:06:20.183

在 Global.asax 文件中处理这种类型的行为听起来像是最好的解决方案并重定向到静态的“离线/关闭”页面。处理Application_BeginRequest方法上的请求，检查站点是否处于活动状态，如果它让它继续，如果它不在线响应。将请求重定向到静态页面。

```
protected void Application_BeginRequest(object sender, EventArgs e)
{
    string redirectURL = "~/Offline.aspx";  //some static page
    bool isOnline = false;  //SQL Call, config value

    if (!isOnline && !string.IsNullOrEmpty(redirectURL))
    {
        Response.RedirectLocation = redirectURL;
        Response.End();
    }
} 
```

            回答 #5

赞同：-5

时间：2009-02-17T13:26:48.440

抱歉，不了解 ASP.NET，但如果有帮助：

我们的网站有一个 APPLICATION.ASP 页面（CMS / 数据库合并类型的东西）；这可能不常见，因此可能会限制有用性，但也许可以通过所有 ASPX 文件顶部的 INCLUDE 来实现

我们将 APPLICATION.ASP 重命名为 TEST.ASP 并将 HOLDING_PAGE.ASP 复制到 APPLICATION.ASP

HOLDING_PAGE.ASP 位于 WWW 文件夹中，因此随时可用。它包含“站点不可用”消息等，并且对于所有 CSS 都是自包含的（没有包含文件，没有数据库访问权限）。唯一的例外是公司徽标（显然是该文件的外部）

此方法可防止对站点的所有访问，不依赖于有效的数据库连接，并允许我们更改站点上的任何内容而不会干扰保留页面（除了公司徽标，但更改可能是良性的）

我们仍然可以在内部使用 TEST.ASP 访问该站点 - 因此我们可以在删除保留页面并使站点上线之前测试任何新的推出功能。如果你想阻止匿名使用 TEST.ASP 然后拒绝匿名权限。

删除持有页面是：删除APPLICATION.ASP（即持有页面）并将TEST.ASP重命名为APPLICATION.ASP

我们还有一个数据库标志，它会导致正常的 APPLICATION.ASP 页面显示一个暂存页面——我们可以在做更多小的更改时使用它。

        assembly - 堆栈在汇编语言中是如何工作的？

ID：556714

赞同：91

时间：2009-02-17T13:12:14.670

标签：assembly, stack, callstack, stack-memory

我目前正在尝试了解堆栈是如何工作的，所以我决定自学一些[汇编语言](http://en.wikipedia.org/wiki/Assembly_language)，我正在使用这本书：

[http://savannah.nongnu.org/projects/pgubook/](http://savannah.nongnu.org/projects/pgubook/) 

我正在使用[Gas](http://en.wikipedia.org/wiki/GNU_Assembler)并在[Linux Mint](http://en.wikipedia.org/wiki/Linux_Mint)上进行开发。

我有点困惑：

据我所知，堆栈只是一种数据结构。所以我假设如果我在汇编中编码，我必须自己实现堆栈。然而，情况似乎并非如此，因为有类似的命令

```
pushl
popl 
```

[因此，在为x86](http://en.wikipedia.org/wiki/X86)架构编写汇编代码并使用 Gas 语法时：堆栈只是已经实现的数据结构吗？或者它实际上是在硬件级别实现的？或者是别的什么？其他芯片组的大多数汇编语言也是否已经实现了堆栈？

我知道这是一个有点愚蠢的问题，但我实际上对此感到很困惑。

            回答 #1

赞同：90

时间：2009-02-17T13:24:28.540

我认为主要是您在 a`program's stack`和之间感到困惑`any old stack`。

**堆栈**

是一种抽象数据结构，由后进先出系统中的信息组成。您将任意对象放在堆栈上，然后再次取下它们，就像进/出托盘一样，最上面的物品总是被取下的物品，而您总是放在最上面。

**程序堆栈**

是一个堆栈，它是在执行期间使用的一段内存，它通常具有每个程序的静态大小，并且经常用于存储函数参数。当您调用函数时，您将参数压入堆栈，并且该函数直接寻址堆栈或从堆栈中弹出变量。

程序堆栈通常不是硬件（尽管它保存在内存中，因此可以这样说），但指向堆栈当前区域的堆栈指针通常是 CPU 寄存器。这使它比后进先出堆栈更灵活，因为您可以更改堆栈寻址的点。

您应该阅读并确保您理解[维基百科](http://en.wikipedia.org/wiki/Stack_(data_structure))文章，因为它很好地描述了您正在处理的硬件堆栈。

还有[本教程](http://ee.sharif.edu/~sakhtar3/articles/8086/ASM%20Tutorial-Ready%20to%20Start!.htm#stack)根据旧的 16 位寄存器解释了堆栈，但可能会有所帮助，[另一个](https://web.archive.org/web/20070822075422/http://www.emu8086.com/assembly_language_tutorial_assembler_reference/asm_tutorial_09.html)专门关于堆栈的教程。

来自尼尔斯·派彭布林克：

值得注意的是，一些处理器没有实现访问和操作堆栈的所有指令（推送、弹出、堆栈指针等），但 x86 却因为它的使用频率而做到了。在这些情况下，如果您想要一个堆栈，您必须自己实现它（一些 MIPS 和一些 ARM 处理器是在没有堆栈的情况下创建的）。

例如，在 MIP 中，推送指令的实现方式如下：

```
addi $sp, $sp, -4  # Decrement stack pointer by 4  
sw   $t0, ($sp)   # Save $t0 to stack 
```

Pop 指令如下所示：

```
lw   $t0, ($sp)   # Copy from stack to $t0  
addi $sp, $sp, 4   # Increment stack pointer by 4 
```

            回答 #2

赞同：58

时间：2017-02-09T20:03:30.677

（我已经对这个答案中的所有代码做了一个[要点](https://gist.github.com/amalahov/7c8df89e2dfee956fd2577073981a22d?ts=4)，以防你想玩它）
在 2003 年的 CS101 课程中，我只在 asm 中做过最基本的事情。而且我从来没有真正“了解”asm 和堆栈的工作原理，直到我意识到这一切基本上就像用 C 或 C++ 编程......但没有局部变量、参数和函数。可能听起来还不容易 :) 让我向您展示（对于带有[Intel 语法](https://en.wikipedia.org/wiki/X86_assembly_language#Syntax)的 x86 asm ）。

**1.什么是栈**
堆栈通常是在每个线程启动之前为其分配的连续内存块。你可以在那里存储任何你想要的东西。用 C++ 术语（*代码片段 #1*）：

```
const int STACK_CAPACITY = 1000;
thread_local int stack[STACK_CAPACITY]; 
```

**2.堆栈的顶部和底部**
`stack`原则上，您可以将值存储在数组的随机单元格中（*片段 #2.1*）：

```
stack[333] = 123;
stack[517] = 456;
stack[555] = stack[333] + stack[517]; 
```

`stack`但是想象一下，记住哪些单元已经在使用以及哪些单元是“免费的”将是多么困难。这就是为什么我们将新值存储在彼此相邻的堆栈上。
关于 (x86) asm 的堆栈的一个奇怪的事情是，您从最后一个索引开始添加东西并移动到较低的索引：堆栈 [999]，然后是堆栈 [998] 等等（*片段 #2.2*）：

```
stack[999] = 123;
stack[998] = 456;
stack[997] = stack[999] + stack[998]; 
```

并且（小心，你现在会感到困惑）“官方”名称`stack[999]`仍然是**bottom of the stack**。

最后使用的单元格（`stack[997]`在上面的示例中）称为**堆栈顶部**（请参阅堆栈[顶部在 x86 上的位置](http://eli.thegreenplace.net/2011/02/04/where-the-top-of-the-stack-is-on-x86/)）。

**3\. 堆栈指针（SP）**
出于讨论的目的，我们假设 CPU 寄存器表示为全局变量（请参阅[通用寄存器](https://en.wikibooks.org/wiki/X86_Assembly/X86_Architecture#General-Purpose_Registers_.28GPR.29_-_16-bit_naming_conventions)）。

```
int AX, BX, SP, BP, ...;
int main(){...} 
```

有一个特殊的 CPU 寄存器 (SP) 跟踪堆栈的顶部。SP 是一个指针（保存一个像 0xAAAABBCC 这样的内存地址）。但出于本文的目的，我将使用它作为数组索引 (0, 1, 2, ...)。
当一个线程启动时，`SP == STACK_CAPACITY`程序和操作系统会根据需要对其进行修改。规则是您不能写入超出堆栈顶部的堆栈单元，并且任何小于 SP 的索引都是无效且不安全的（因为[系统中断](https://en.wikipedia.org/wiki/Interrupt)），因此您
*首先*减少 SP，*然后*将值写入新分配的单元。
当您想将多个值连续推送到堆栈中时，您可以预先为所有这些值保留空间（*片段 #3*）：

```
SP -= 3;
stack[999] = 12;
stack[998] = 34;
stack[997] = stack[999] + stack[998]; 
```

*笔记。*现在您可以看到为什么堆栈上的分配如此之快 - 它只是单个寄存器递减。

**4.局部变量**
让我们看一下这个简单的函数（*片段 #4.1*）：

```
int triple(int a) {
    int result = a * 3;
    return result;
} 
```

并在不使用局部变量的情况下重写它（*片段 #4.2*）：

```
int triple_noLocals(int a) {
    SP -= 1; // move pointer to unused cell, where we can store what we need
    stack[SP] = a * 3;
    return stack[SP];
} 
```

看看它是如何被调用的（*片段#4.3*）：

```
// SP == 1000
someVar = triple_noLocals(11);
// now SP == 999, but we don't need the value at stack[999] anymore
// and we will move the stack index back, so we can reuse this cell later
SP += 1; // SP == 1000 again 
```

**5.推/弹出**
在栈顶添加一个新元素是一个非常频繁的操作，CPU 有一个特殊的指令，`push`. 我们将像这样实现它（*片段 5.1*）：

```
void push(int value) {
    --SP;
    stack[SP] = value;
} 
```

同样，取堆栈的顶部元素（*片段 5.2*）：

```
void pop(int& result) {
    result = stack[SP];
    ++SP; // note that `pop` decreases stack's size
} 
```

push/pop 的常见使用模式是暂时节省一些价值。比如说，我们在变量中有一些有用的东西`myVar`，出于某种原因，我们需要进行覆盖它的计算（*片段 5.3*）：

```
int myVar = ...;
push(myVar); // SP == 999
myVar += 10;
... // do something with new value in myVar
pop(myVar); // restore original value, SP == 1000 
```

**6.功能参数**
现在让我们使用堆栈（*片段#6*）传递参数：

```
int triple_noL_noParams() { // `a` is at index 999, SP == 999
    SP -= 1; // SP == 998, stack[SP + 1] == a
    stack[SP] = stack[SP + 1] * 3;
    return stack[SP];
}

int main(){
    push(11); // SP == 999
    assert(triple(11) == triple_noL_noParams());
    SP += 2; // cleanup 1 local and 1 parameter
} 
```

**7.`return`声明**
让我们在 AX 寄存器中返回值（*片段 #7*）：

```
void triple_noL_noP_noReturn() { // `a` at 998, SP == 998
    SP -= 1; // SP == 997

    stack[SP] = stack[SP + 1] * 3;
    AX = stack[SP];

    SP += 1; // finally we can cleanup locals right in the function body, SP == 998
}

void main(){
    ... // some code
    push(AX); // save AX in case there is something useful there, SP == 999
    push(11); // SP == 998
    triple_noL_noP_noReturn();
    assert(triple(11) == AX);
    SP += 1; // cleanup param
             // locals were cleaned up in the function body, so we don't need to do it here
    pop(AX); // restore AX
    ...
} 
```

**8.栈基指针（BP）**（也称*帧指针*）和**栈帧**
让我们使用更多“高级”函数并用我们的 asm-like C++ 重写它（*片段 #8.1*）：

```
int myAlgo(int a, int b) {
    int t1 = a * 3;
    int t2 = b * 3;
    return t1 - t2;
}

void myAlgo_noLPR() { // `a` at 997, `b` at 998, old AX at 999, SP == 997
    SP -= 2; // SP == 995

    stack[SP + 1] = stack[SP + 2] * 3; 
    stack[SP]     = stack[SP + 3] * 3;
    AX = stack[SP + 1] - stack[SP];

    SP += 2; // cleanup locals, SP == 997
}

int main(){
    push(AX); // SP == 999
    push(22); // SP == 998
    push(11); // SP == 997
    myAlgo_noLPR();
    assert(myAlgo(11, 22) == AX);
    SP += 2;
    pop(AX);
} 
```

现在想象一下，我们决定在返回之前引入新的局部变量来存储结果，就像我们在`tripple`（片段＃4.1）中所做的那样。函数的主体将是（*片段 #8.2*）：

```
SP -= 3; // SP == 994
stack[SP + 2] = stack[SP + 3] * 3; 
stack[SP + 1] = stack[SP + 4] * 3;
stack[SP]     = stack[SP + 2] - stack[SP + 1];
AX = stack[SP];
SP += 3; 
```

你看，我们必须更新对函数参数和局部变量的每一个引用。为了避免这种情况，我们需要一个锚索引，它不会随着堆栈的增长而改变。
我们将通过将当前顶部（SP 的值）保存到 BP 寄存器中来在函数进入时（在我们为局部变量分配空间之前）创建锚点。*片段#8.3*：

```
void myAlgo_noLPR_withAnchor() { // `a` at 997, `b` at 998, SP == 997
    push(BP);   // save old BP, SP == 996
    BP = SP;    // create anchor, stack[BP] == old value of BP, now BP == 996
    SP -= 2;    // SP == 994

    stack[BP - 1] = stack[BP + 1] * 3;
    stack[BP - 2] = stack[BP + 2] * 3;
    AX = stack[BP - 1] - stack[BP - 2];

    SP = BP;    // cleanup locals, SP == 996
    pop(BP);    // SP == 997
} 
```

属于并完全控制函数的堆栈切片称为**函数的堆栈帧**。例如`myAlgo_noLPR_withAnchor`的堆栈帧是`stack[996 .. 994]`（包括两个 idex）。

帧从函数的 BP 开始（在我们在函数内部更新它之后）并持续到下一个堆栈帧。所以栈上的参数是调用者栈帧的一部分（见注8a）。
注释：

*8a。* [维基百科对参数另有](https://en.wikipedia.org/wiki/Call_stack#Structure)说明，但在这里我坚持[英特尔软件开发人员手册](https://software.intel.com/en-us/articles/intel-sdm)，请参阅第 1 卷。1，第*6.2.4.1 节 Stack-Frame Base Pointer和第**6.3.2 节 Far CALL 和 RET 操作*中的图 6-2 。函数的参数和堆栈帧是**函数激活记录**的一部分（请参阅[函数 perilogues 的 gen](http://jdebp.eu./FGA/function-perilogues.html)）。

*8b。*BP 的正偏移指向函数参数，负偏移指向局部变量。

*这对于调试8c* 非常方便。`stack[BP]`存储前一个堆栈帧的地址，`stack[stack[BP]]`存储前一个堆栈帧等。沿着这条链，你可以发现程序中所有函数的帧，这些帧还没有返回。这就是调试器显示您调用堆栈

*8d 的方式。*的前 3 条指令`myAlgo_noLPR_withAnchor`，我们设置框架（保存旧 BP，更新 BP，为本地人保留空间）称为**函数序言**

**9\. 调用约定**
在代码片段 8.1 中，我们将参数`myAlgo`从右向左推送，并在`AX`. 我们也可以从左到右传递参数并返回`BX`。或者在 BX 和 CX 中传递参数并在 AX 中返回。显然，调用者（`main()`）和被调用函数必须同意所有这些东西的存储位置和顺序。
**调用约定**是一组关于如何传递参数和返回结果的规则。
在上面的代码中，我们使用了*cdecl 调用约定*：

*   参数在堆栈上传递，第一个参数在调用时位于堆栈的最低地址（最后推送 <...>）。调用者负责在调用后将参数从堆栈中弹出。
*   返回值放在 AX
*   EBP 和 ESP 必须由被调用者（`myAlgo_noLPR_withAnchor`在我们的例子中是函数）保存，以便调用者（`main`函数）可以依赖那些未被调用更改的寄存器。
*   所有其他寄存器（EAX，<...>）都可以由被调用者自由修改；如果调用者希望在函数调用之前和之后保存一个值，它必须将这个值保存在其他地方（我们使用 AX 执行此操作）

^(（来源：来自 Stack Overflow 文档的示例“32 位 cdecl”；[icktoofay](https://stackoverflow.com/users/200291/icktoofay)和[Peter Cordes](https://stackoverflow.com/users/224132/peter-cordes)拥有 2016 年版权；根据 CC BY-SA 3.0 许可。可在 archive.org 上找到[完整的 Stack Overflow 文档内容的存档](https://archive.org/details/documentation-dump.7z)，其中此示例由主题 ID 3261 和示例 ID 11196 索引。）)

**10.函数调用**
现在是最有趣的部分。就像数据一样，可执行代码也存储在内存中（与堆栈的内存完全无关），每条指令都有一个地址。

如果没有其他命令，CPU 会按照指令存储在内存中的顺序一个接一个地执行指令。但是我们可以命令 CPU “跳转”到内存中的另一个位置并从那里执行指令。在 asm 中，它可以是任何地址，而在 C++ 等更高级的语言中，您只能跳转到由标签标记的地址（[有一些变通方法](https://stackoverflow.com/q/8158007/264047)，但至少可以说它们并不漂亮）。
让我们使用这个函数（*片段 #10.1*）：

```
int myAlgo_withCalls(int a, int b) {
    int t1 = triple(a);
    int t2 = triple(b);
    return t1 - t2;
} 
```

而不是调用`tripple`C++ 方式，请执行以下操作：

1.  将代码复制`tripple`到`myAlgo`正文的开头
2.  在`myAlgo`入口处跳过`tripple`的代码`goto`
3.  当我们需要执行`tripple`的代码时，将调用后的代码行的堆栈地址保存起来`tripple`，以便稍后返回这里继续执行（`PUSH_ADDRESS`下面的宏）
4.  跳转到第一行的地址（`tripple`函数）并执行到最后（3.和4.一起是`CALL`宏）
5.  在结束时`tripple`（在我们清理了局部变量之后），从堆栈顶部获取返回地址并跳转到那里（`RET`宏）

因为在 C++ 中没有简单的方法可以跳转到特定的代码地址，所以我们将使用标签来标记跳转的位置。我不会详细介绍下面的宏是如何工作的，相信我他们会按照我说的去做（*片段 #10.2*）：

```
// pushes the address of the code at label's location on the stack
// NOTE1: this gonna work only with 32-bit compiler (so that pointer is 32-bit and fits in int)
// NOTE2: __asm block is specific for Visual C++. In GCC use https://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html
#define PUSH_ADDRESS(labelName) {               \
    void* tmpPointer;                           \
    __asm{ mov [tmpPointer], offset labelName } \
    push(reinterpret_cast<int>(tmpPointer));    \
}

// why we need indirection, read https://stackoverflow.com/a/13301627/264047
#define TOKENPASTE(x, y) x ## y
#define TOKENPASTE2(x, y) TOKENPASTE(x, y)

// generates token (not a string) we will use as label name. 
// Example: LABEL_NAME(155) will generate token `lbl_155`
#define LABEL_NAME(num) TOKENPASTE2(lbl_, num)

#define CALL_IMPL(funcLabelName, callId)    \
    PUSH_ADDRESS(LABEL_NAME(callId));       \
    goto funcLabelName;                     \
    LABEL_NAME(callId) :

// saves return address on the stack and jumps to label `funcLabelName`
#define CALL(funcLabelName) CALL_IMPL(funcLabelName, __LINE__)

// takes address at the top of stack and jump there
#define RET() {                                         \
    int tmpInt;                                         \
    pop(tmpInt);                                        \
    void* tmpPointer = reinterpret_cast<void*>(tmpInt); \
    __asm{ jmp tmpPointer }                             \
}

void myAlgo_asm() {
    goto my_algo_start;

triple_label:
    push(BP);
    BP = SP;
    SP -= 1;

    // stack[BP] == old BP, stack[BP + 1] == return address
    stack[BP - 1] = stack[BP + 2] * 3;
    AX = stack[BP - 1];

    SP = BP;     
    pop(BP);
    RET();

my_algo_start:
    push(BP);   // SP == 995
    BP = SP;    // BP == 995; stack[BP] == old BP, 
                // stack[BP + 1] == dummy return address, 
                // `a` at [BP + 2], `b` at [BP + 3]
    SP -= 2;    // SP == 993

    push(AX);
    push(stack[BP + 2]);
    CALL(triple_label);
    stack[BP - 1] = AX;
    SP -= 1;
    pop(AX);

    push(AX);
    push(stack[BP + 3]);
    CALL(triple_label);
    stack[BP - 2] = AX;
    SP -= 1;
    pop(AX);

    AX = stack[BP - 1] - stack[BP - 2];

    SP = BP; // cleanup locals, SP == 997
    pop(BP);
}

int main() {
    push(AX);
    push(22);
    push(11);
    push(7777); // dummy value, so that offsets inside function are like we've pushed return address
    myAlgo_asm();
    assert(myAlgo_withCalls(11, 22) == AX);
    SP += 1; // pop dummy "return address"
    SP += 2;
    pop(AX);
} 
```

注释：

*10a。*因为返回地址是存储在栈上的，原则上我们可以改变它。这就是[堆栈粉碎攻击](https://en.wikipedia.org/wiki/Stack_buffer_overflow)的工作原理

*10b。*`triple_label`(cleanup locals, restore old BP, return) “结束”的最后 3 条指令称为**函数的结尾**

**11\. 组装**
现在让我们看看真正的 asm for `myAlgo_withCalls`. 在 Visual Studio 中执行此操作：

*   将构建平台设置为 x86（*不是*x86_64）
*   构建类型：调试
*   在 myAlgo_withCalls 中的某处设置断点
*   运行，当执行在断点处停止时按`Ctrl`+ `Alt`+`D`

与我们类似 asm 的 C++ 的一个区别是 asm 的堆栈对字节而不是整数进行操作。所以要为 1 保留空间`int`，SP 将减少 4 个字节。

我们开始（*片段#11.1*，注释中的行号来自[要点](https://gist.github.com/amalahov/7c8df89e2dfee956fd2577073981a22d?ts=4)）：

```
;   114: int myAlgo_withCalls(int a, int b) {
 push        ebp        ; create stack frame 
 mov         ebp,esp  
; return address at (ebp + 4), `a` at (ebp + 8), `b` at (ebp + 12)

 sub         esp,0D8h   ; reserve space for locals. Compiler can reserve more bytes then needed. 0D8h is hexadecimal == 216 decimal 

 push        ebx        ; cdecl requires to save all these registers
 push        esi  
 push        edi  

 ; fill all the space for local variables (from (ebp-0D8h) to (ebp)) with value 0CCCCCCCCh repeated 36h times (36h * 4 == 0D8h)
 ; see https://stackoverflow.com/q/3818856/264047
 ; I guess that's for ease of debugging, so that stack is filled with recognizable values
 ; 0CCCCCCCCh in binary is 110011001100...
 lea         edi,[ebp-0D8h]     
 mov         ecx,36h    
 mov         eax,0CCCCCCCCh  
 rep stos    dword ptr es:[edi]  

;   115:    int t1 = triple(a);
 mov         eax,dword ptr [ebp+8]   ; push parameter `a` on the stack
 push        eax  

 call        triple (01A13E8h)  
 add         esp,4                   ; clean up param 
 mov         dword ptr [ebp-8],eax   ; copy result from eax to `t1`

;   116:    int t2 = triple(b);
 mov         eax,dword ptr [ebp+0Ch] ; push `b` (0Ch == 12)
 push        eax  

 call        triple (01A13E8h)  
 add         esp,4  
 mov         dword ptr [ebp-14h],eax ; t2 = eax

 mov         eax,dword ptr [ebp-8]   ; calculate and store result in eax
 sub         eax,dword ptr [ebp-14h]  

 pop         edi  ; restore registers
 pop         esi  
 pop         ebx  

 add         esp,0D8h  ; check we didn't mess up esp or ebp. this is only for debug builds
 cmp         ebp,esp  
 call        __RTC_CheckEsp (01A116Dh)  

 mov         esp,ebp  ; destroy frame
 pop         ebp  
 ret 
```

和 asm for `tripple`(*片段#11.2* )：

```
 push        ebp  
 mov         ebp,esp  
 sub         esp,0CCh  
 push        ebx  
 push        esi  
 push        edi  
 lea         edi,[ebp-0CCh]  
 mov         ecx,33h  
 mov         eax,0CCCCCCCCh  
 rep stos    dword ptr es:[edi]  
 imul        eax,dword ptr [ebp+8],3  
 mov         dword ptr [ebp-8],eax  
 mov         eax,dword ptr [ebp-8]  
 pop         edi  
 pop         esi  
 pop         ebx  
 mov         esp,ebp  
 pop         ebp  
 ret 
```

希望，在阅读了这篇文章之后，汇编看起来不像以前那么神秘了 :)

以下是帖子正文的链接和一些进一步阅读：

*   [Eli Bendersky](https://stackoverflow.com/users/8206/eli-bendersky)，[堆栈顶部在 x86 上的位置](http://eli.thegreenplace.net/2011/02/04/where-the-top-of-the-stack-is-on-x86/)- 顶部/底部、推送/弹出、SP、堆栈框架、调用约定
*   [Eli Bendersky](https://stackoverflow.com/users/8206/eli-bendersky)，[x86-64 上的堆栈框架布局](http://eli.thegreenplace.net/2011/09/06/stack-frame-layout-on-x86-64)- args 在 x64 上传递，堆栈框架，红色区域
*   马里兰大学，[Understanding the Stack](https://www.cs.umd.edu/class/sum2003/cmsc311/Notes/Mips/stack.html) - 一个非常好的堆栈概念介绍。（它适用于 MIPS（不是 x86）和 GAS 语法，但这对于该主题来说无关紧要）。如果有兴趣，请参阅有关[MIPS ISA 编程](http://www.cs.umd.edu/class/spring2003/cmsc311/Notes/index.html)的其他说明。
*   x86 Asm wikibook，[通用寄存器](https://en.wikibooks.org/wiki/X86_Assembly/X86_Architecture#General-Purpose_Registers_.28GPR.29_-_16-bit_naming_conventions)
*   x86 反汇编维基书，[堆栈](https://en.wikibooks.org/wiki/X86_Disassembly/The_Stack)
*   x86 反汇编 wikibook、[函数和堆栈框架](https://en.wikibooks.org/wiki/X86_Disassembly/Functions_and_Stack_Frames)
*   [英特尔软件开发人员手册](https://software.intel.com/en-us/articles/intel-sdm)- 我原以为它会非常硬核，但令人惊讶的是它很容易阅读（尽管信息量很大）
*   乔纳森·德博因·波拉德（Jonathan de Boyne Pollard），[功能后记](http://jdebp.eu./FGA/function-perilogues.html)- 序幕/尾声，堆栈框架/激活记录，红色区域

            回答 #3

赞同：7

时间：2009-02-17T13:22:25.690

关于堆栈是否在硬件中实现，这篇[维基百科文章](http://en.wikipedia.org/wiki/Stack-based_memory_allocation)可能会有所帮助。

某些处理器系列，例如 x86，具有用于操作当前执行线程的堆栈的特殊指令。其他处理器系列，包括 PowerPC 和 MIPS，没有明确的堆栈支持，而是依赖约定并将堆栈管理委托给操作系统的应用程序二进制接口 (ABI)。

那篇文章和它链接的其他文章可能有助于了解处理器中的堆栈使用情况。

            回答 #4

赞同：4

时间：2009-02-17T13:19:02.483

您混淆了抽象堆栈和硬件实现的堆栈。后者已经实施。

            回答 #5

赞同：4

时间：2016-02-05T22:18:13.870

**这个概念**

首先把整个事情想象成你是发明它的人。像这样：

首先考虑一个数组以及它是如何在底层实现的——>它基本上只是一组连续的内存位置（彼此相邻的内存位置）。现在您的脑海中已经有了那个图像，请考虑这样一个事实，即您可以访问任何这些内存位置并在您删除或添加阵列中的数据时随意删除它。现在考虑同一个数组，但不是删除任何位置，而是决定在删除或添加数组中的数据时只删除最后一个位置。现在，您以这种方式操作该数组中的数据的新想法称为 LIFO，这意味着后进先出。您的想法非常好，因为它可以更轻松地跟踪该数组的内容，而不必在每次从中删除某些内容时都使用排序算法。还，要始终知道数组中最后一个对象的地址是什么，您可以在 Cpu 中专用一个寄存器来跟踪它。现在，寄存器跟踪它的方式是，每次你删除或添加一些东西到你的数组时，你也会根据你从数组中删除或添加的对象的数量来减少或增加寄存器中地址的值（通过他们占用的地址空间量）。您还想确保您减少或增加该寄存器的数量固定为每个对象一个数量（如 4 个内存位置，即 4 个字节），再次，以便更容易跟踪并使其成为可能将该寄存器与某些循环结构一起使用，因为循环每次迭代使用固定增量（例如。用一个循环遍历你的数组，你构造循环以在每次迭代中将你的寄存器增加 4，如果你的数组中有不同大小的对象，这是不可能的）。最后，您选择将此新数据结构称为“堆栈”，因为它使您想起餐厅中的一堆盘子，他们总是在该堆栈顶部删除或添加一个盘子。

**实施**

如您所见，堆栈只不过是您决定如何操作它的一系列连续内存位置。因此，您可以看到您甚至不需要使用特殊指令和寄存器来控制堆栈。您可以使用基本的 mov、add 和 sub 指令自己实现它，并使用通用寄存器而不是 ESP 和 EBP，如下所示：

**移动 edx, 0FFFFFFFFh** 

**; -->**这将是您的堆栈的起始地址，离您的代码和数据最远，它还将用作跟踪我之前解释的堆栈中最后一个对象的寄存器。您将其称为“堆栈指针”，因此您选择寄存器 EDX 作为 ESP 通常用于的内容。

**子 edx, 4**

**mov [edx], dword ptr [someVar]** 

**; -->**这两条指令将使您的堆栈指针减少 4 个内存位置，并将从 [someVar] 内存位置开始的 4 个字节复制到 EDX 现在指向的内存位置，就像 PUSH 指令减少 ESP 一样，只有在这里你做了它是手动的，你使用了 EDX。所以 PUSH 指令基本上只是一个更短的操作码，它实际上是用 ESP 做的。

**mov eax, dword ptr [edx]**

**添加 edx, 4** 

**; -->**在这里我们做相反的事情，我们首先将 EDX 现在指向的内存位置开始的 4 个字节复制到寄存器 EAX 中（在这里任意选择，我们可以将它复制到任何我们想要的地方）。然后我们将堆栈指针 EDX 增加 4 个内存位置。这就是 POP 指令的作用。

现在您可以看到指令 PUSH 和 POP 以及寄存器 ESP 和 EBP 是 Intel 刚刚添加的，以使上述“堆栈”数据结构的概念更易于读写。仍然有一些 RISC（精简指令集）Cpu-s 没有 PUSH ans POP 指令和用于堆栈操作的专用寄存器，并且在为这些 Cpu-s 编写汇编程序时，您必须自己实现堆栈，就像我给你看了。

            回答 #6

赞同：3

时间：2009-02-17T13:57:36.230

我认为您正在寻找的主要答案已经被暗示了。

x86 计算机启动时，未设置堆栈。程序员必须在启动时明确设置它。但是，如果您已经在操作系统中，这已经被处理了。下面是一个简单引导程序的代码示例。

首先设置数据和堆栈段寄存器，然后将堆栈指针设置为0x4000。

```
 movw    $BOOT_SEGMENT, %ax
    movw    %ax, %ds
    movw    %ax, %ss
    movw    $0x4000, %ax
    movw    %ax, %sp 
```

在此代码之后，可以使用堆栈。现在我确信它可以通过多种不同的方式完成，但我认为这应该说明这个想法。

            回答 #7

赞同：3

时间：2013-11-10T12:42:26.097

堆栈只是程序和函数使用内存的一种方式。
堆栈总是让我感到困惑，所以我做了一个说明：
![堆栈就像钟乳石](https://i.stack.imgur.com/zjTi7.png)
（[这里是 svg 版本](http://openclipart.org/people/alexander256/stalactites.svg)）

*   推动“将新的钟乳石附着在天花板上”。
*   流行音乐“从钟乳石中弹出”。

希望它比混乱更有帮助。
随意使用 SVG 图像（CC0 许可）。

            回答 #8

赞同：2

时间：2009-02-17T13:18:25.963

堆栈是通过堆栈指针“实现”的，堆栈指针（此处假设 x86 架构）指向堆栈*段*。每次将东西压入堆栈（通过 pushl、call 或类似的堆栈操作码）时，都会将其写入堆栈指针指向的地址，并且堆栈指针会*递减（堆栈**向下*增长，即较小的地址） . 当你从堆栈中弹出一些东西（popl，ret）时，堆栈指针会*递增*并且值会从堆栈中读取。

在用户空间应用程序中，当您的应用程序启动时，堆栈已经为您设置好了。在内核空间环境中，您必须首先设置堆栈段和堆栈指针......

            回答 #9

赞同：1

时间：2009-02-17T13:16:03.457

堆栈已经存在，因此您可以在编写代码时假设它。堆栈包含函数的返回地址、局部变量和函数之间传递的变量。您还可以使用内置的堆栈寄存器，例如 BP、SP（堆栈指针），因此您提到了内置命令。如果堆栈还没有实现，函数就不能运行，代码流也不能工作。

            回答 #10

赞同：1

时间：2009-02-17T13:26:10.203

我没有专门看到 Gas 汇编器，但总的来说，堆栈是通过维护对堆栈顶部所在的内存位置的引用来“实现”的。内存位置存储在一个寄存器中，对于不同的架构有不同的名称，但可以认为是堆栈指针寄存器。

pop 和 push 命令是在大多数架构中通过构建在微指令上为您实现的。但是，一些“教育架构”需要您自己实现它们。从功能上讲，push 的实现有点像这样：

```
 load the address in the stack pointer register to a gen. purpose register x
   store data y at the location x
   increment stack pointer register by size of y 
```

此外，一些体系结构将最后使用的内存地址存储为堆栈指针。有些存储下一个可用地址。

            回答 #11

赞同：1

时间：2009-02-17T13:43:31.457

调用栈由 x86 指令集和操作系统实现。

诸如 push 和 pop 之类的指令会调整堆栈指针，而操作系统会在堆栈为每个线程增长时负责分配内存。

x86 堆栈从较高地址到较低地址“向下增长”的事实使得该架构更[容易受到缓冲区溢出攻击。](http://msdn.microsoft.com/en-us/library/aa290051.aspx#vctchcompilersecuritychecksindepthanchor3)

            回答 #12

赞同：0

时间：2009-02-17T13:23:00.960

堆栈是一种数据结构是正确的。通常，您使用的数据结构（包括堆栈）是抽象的，并且作为内存中的表示存在。  

在这种情况下，您正在使用的堆栈具有更重要的存在——它直接映射到处理器中的真实物理寄存器。作为一种数据结构，堆栈是 FILO（先进后出）结构，可确保以与输入相反的顺序删除数据。查看 StackOverflow 徽标以获得视觉效果！;)

您正在使用*指令堆栈*。这是您为处理器提供的实际指令堆栈。

            回答 #13

赞同：0

时间：2009-02-17T13:42:04.910

堆栈“只是”一种数据结构是正确的。然而，在这里，它指的是用于特殊目的的硬件实现的堆栈——“堆栈”。

许多人评论了硬件实现的堆栈与（软件）堆栈数据结构。我想补充一下，有三种主要的堆栈结构类型 -

1.  调用堆栈——你要问的是哪个！它存储函数参数和返回地址等。请阅读该书中的第 4 章（所有关于第 4 页，即第 53 页）函数。有一个很好的解释。
2.  一个通用堆栈，您可以在程序中使用它来做一些特别的事情......
3.  通用硬件堆栈

    我对此不确定，但我记得在某处读过，在某些架构中存在通用硬件实现堆栈。如果有人知道这是否正确，请发表评论。

首先要知道的是您正在为其编程的架构，这本书解释了（我只是查了一下--link）。要真正理解事物，我建议您了解 x86 的内存、寻址、寄存器和体系结构（我假设这就是您正在学习的内容——从书中）。

            回答 #14

赞同：0

时间：2011-10-21T04:59:26.227

调用函数需要以 LIFO 方式保存和恢复本地状态（而不是说，通用的协同程序方法），结果证明是一种非常普遍的需求，以至于汇编语言和 CPU 架构基本上都在其中构建了这个功能。同样可以说是线程、内存保护、安全级别等概念。理论上你可以实现自己的堆栈、调用约定等，但我假设一些操作码和大多数现有运行时都依赖于“堆栈”的本机概念.

            回答 #15

赞同：0

时间：2012-12-10T09:16:35.430

什么是堆栈？堆栈是一种数据结构——一种在计算机中存储信息的方法。当一个新对象进入堆栈时，它被放置在所有先前输入的对象之上。换句话说，堆栈数据结构就像一堆卡片、文件、信用卡邮件或您能想到的任何其他现实世界对象。从堆栈中删除对象时，首先删除顶部的对象。这种方法称为 LIFO（后进先出）。

术语“堆栈”也可以简称为网络协议堆栈。在网络中，计算机之间的连接是通过一系列较小的连接建立的。这些连接或层的作用类似于堆栈数据结构，因为它们以相同的方式构建和处理。

            回答 #16

赞同：0

时间：2015-07-21T20:47:57.870

`stack`是记忆的一部分。它使用 for`input`和`output`of `functions`。它也用于记住函数的返回。

`esp`寄存器是记住堆栈地址。

`stack`并由`esp`硬件实现。你也可以自己实现它。它会使你的程序非常慢。

例子：

nop // `esp`= 0012ffc4

推 0 // `esp`= 0012ffc0 ,Dword[0012ffc0]=00000000

调用 proc01 // `esp`= 0012ffbc ,Dword[0012ffbc] = `eip`, `eip`= adrr[proc01]

弹出`eax`// `eax`= Dword[ `esp`], `esp`= `esp`+ 4

            回答 #17

赞同：0

时间：2016-10-18T09:57:57.503

我正在搜索堆栈在功能方面的工作原理，我发现[这个博客](http://www.cryptroix.com/journey-to-the-stack/)很棒，它从头开始解释堆栈的概念以及堆栈如何在堆栈中存储值。

现在就你的答案。我将用 python 解释，但你会很好地了解堆栈在任何语言中是如何工作的。

[![在此处输入图像描述](https://i.stack.imgur.com/6ekV1.jpg)](https://i.stack.imgur.com/6ekV1.jpg)

它是一个程序：

```
def hello(x):
    if x==1:
        return "op"
    else:
        u=1
        e=12
        s=hello(x-1)
        e+=1
        print(s)
        print(x)
        u+=1
    return e

hello(3) 
```

[![在此处输入图像描述](https://i.stack.imgur.com/aAxHy.png)](https://i.stack.imgur.com/aAxHy.png)

[![在此处输入图像描述](https://i.stack.imgur.com/CaOq1.png)](https://i.stack.imgur.com/CaOq1.png)

资料来源：[Cryptroix](http://www.cryptroix.com/journey-to-the-stack/)

它在博客中涵盖的一些主题：

```
How Function work ?
Calling a Function
 Functions In a Stack
 What is Return Address
 Stack
Stack Frame
Call Stack
Frame Pointer (FP) or Base Pointer (BP)
Stack Pointer (SP)
Allocation stack and deallocation of stack
StackoverFlow
What is Heap? 
```

但它用python语言解释，所以如果你愿意，你可以看看。

        python - Python列表序列化-最快的方法

ID：556730

赞同：11

时间：2009-02-17T13:16:25.157

标签：python, serialization, caching

我需要从 Python 脚本中的文件加载（反序列化）预先计算的整数列表（到 Python 列表中）。列表很大（多达数百万个项目），我可以选择存储它的格式，只要加载速度最快。

哪种方法最快，为什么？

1.  `import`在仅包含分配给变量的列表的 .py 文件上使用
2.  使用`cPickle`_`load`
3.  其他一些方法（也许`numpy`？）

此外，如何可靠地对此类事物进行基准测试？

**附录：**可靠地测量这一点很困难，因为`import`它被缓存了，所以它不能在测试中多次执行。第一次之后使用 pickle 加载也变得更快，这可能是因为操作系统进行了页面预缓存。加载 100 万个数字`cPickle`第一次运行需要 1.1 秒，后续执行脚本需要 0.2 秒。

直觉上我觉得`cPickle`应该更快，但我会欣赏数字（我认为这是一个相当大的衡量挑战）。

是的，对我来说，快速执行很重要。

谢谢

            回答 #1

赞同：7

时间：2009-02-17T14:07:06.517

如果你真的需要列表中的东西，我猜[cPickle会是最快的。](http://docs.python.org/library/pickle.html#module-cPickle)

如果您可以使用内置序列类型的[数组，我将其计时为 1/4 秒，用于 100 万个整数：](http://docs.python.org/library/array.html)

```
from array import array
from datetime import datetime

def WriteInts(theArray,filename):
    f = file(filename,"wb")
    theArray.tofile(f)
    f.close()

def ReadInts(filename):
    d = datetime.utcnow()
    theArray = array('i')
    f = file(filename,"rb")
    try:
        theArray.fromfile(f,1000000000)
    except EOFError:
        pass
    print "Read %d ints in %s" % (len(theArray),datetime.utcnow() - d)
    return theArray

if __name__ == "__main__":
    a = array('i')
    a.extend(range(0,1000000))
    filename = "a_million_ints.dat"
    WriteInts(a,filename)
    r = ReadInts(filename)
    print "The 5th element is %d" % (r[4]) 
```

            回答 #2

赞同：3

时间：2009-02-17T13:50:14.687

有关基准测试，请参阅 Python 标准库中的 timeit 模块。要查看最快的方法，请实施您能想到的所有方法并用 timeit 测量它们。

随机想法：根据您的具体操作，您可能会发现以**.newsrc**文件中使用的样式存储“整数集”最快：

```
1, 3-1024, 11000-1200000 
```

如果您需要检查该集合中是否有某些东西，那么加载和匹配这种表示应该是最快的方法之一。这假设您的整数集相当密集，具有长的连续相邻值序列。

            回答 #3

赞同：2

时间：2009-02-17T13:43:57.837

“如何可靠地对这些事物进行基准测试？”  

我不明白这个问题。

你编写了一堆小函数来以各种形式创建和保存你的列表。

您编写了一堆小函数来以各种形式加载列表。

您编写了一个小定时器函数来获取开始时间，执行几十次加载过程（以获得足够长的稳定平均值，以使操作系统调度噪声不会主导您的测量）。

你在一份小报告中总结了你的数据。  

这有什么不可靠的？

以下是一些不相关的问题，展示了如何衡量和比较性能。  

[将整数列表转换为一个数字？](https://stackoverflow.com/questions/489999/python-convert-list-of-ints-to-one-number)

[Python中的字符串连接与字符串替换](https://stackoverflow.com/questions/376461/string-concatenation-vs-string-substitution-in-python)

            回答 #4

赞同：2

时间：2009-02-17T13:57:14.983

为了帮助您进行计时，Python 库提供了以下[`timeit`](http://docs.python.org/library/timeit.html#module-timeit)模块：

该模块提供了一种简单的方法来计时少量 Python 代码。它既有命令行也有可调用的接口。它避免了一些用于测量执行时间的常见陷阱。

一个示例（来自手册）比较了使用`hasattr()`与`try/except`测试缺失和当前对象属性的成本：

```
% timeit.py 'try:' '  str.__nonzero__' 'except AttributeError:' '  pass'
100000 loops, best of 3: 15.7 usec per loop
% timeit.py 'if hasattr(str, "__nonzero__"): pass'
100000 loops, best of 3: 4.26 usec per loop
% timeit.py 'try:' '  int.__nonzero__' 'except AttributeError:' '  pass'
1000000 loops, best of 3: 1.43 usec per loop
% timeit.py 'if hasattr(int, "__nonzero__"): pass'
100000 loops, best of 3: 2.23 usec per loop 
```

            回答 #5

赞同：2

时间：2009-02-24T12:25:20.653

您是否需要始终加载整个文件？如果没有，[upack_from()](http://docs.python.org/library/struct.html)可能是最好的解决方案。假设您有 1000000 个整数，但您只想加载从 50000 到 50099 的整数，您可以这样做：

```
import struct
intSize = struct.calcsize('i') #this value would be constant for a given arch
intFile = open('/your/file.of.integers')
intTuple5K100 = struct.unpack_from('i'*100,intFile,50000*intSize) 
```

            回答 #6

赞同：1

时间：2009-02-17T14:11:21.733

cPickle 将是最快的，因为它以二进制形式保存，无需解析真正的 Python 代码。

其他优点是它更安全（因为它不执行命令）并且`$PYTHONPATH`正确设置没有问题。

        opengl - 用opengl写阿拉伯文字

ID：556731

赞同：4

时间：2009-02-17T13:16:30.977

标签：opengl, fonts, arabic

我想在我的opengl程序中使用freetype 2写阿拉伯文我怎么做阿拉伯语文本

我之前看过第 13 课和第 43 课，但问题是当我渲染它时，它只显示了没有任何阿拉伯字母的矩形边框，我使用了 glUseOutline 它从左到右显示了字母并且没有将它们连接在一起，阿拉伯字母的问题是有一些字母必须考虑它的位置，例如字母（ب），当这个字母在单词（字符串）的开头时，它有自己的形状，并且在中间和结尾，因此，如果有专门为它写的源代码就很好了 单词示例如下： بيع 字母 ب 在开头 يبيع 字母 ب 在中间 ريب 字母 ب 在结尾

            回答 #1

赞同：3

时间：2009-02-17T13:21:00.263

查看[关于使用 OpenGL 渲染位图字体的 NeHe 教程 13](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=13)。如果您想表示阿拉伯文本，您可能想使用宽字符而不是 8 位字符。那里有几个例子，其中一些使用 Linux 和 FreeType。Freetype 在渲染 Unicode 字符时应该没有问题。这个[FreeType](http://www.freetype.org/freetype2/docs/tutorial/step1.html)教程可能会有所帮助。

            回答 #2

赞同：2

时间：2013-06-26T07:54:06.913

这看起来应该可行：
 [https ://github.com/Accorpa/Arabic-Converter-From-and-To-Arabic-Presentation-Forms-B/blob/master/ArabicConverter.m](https://github.com/Accorpa/Arabic-Converter-From-and-To-Arabic-Presentation-Forms-B/blob/master/ArabicConverter.m)

阿拉伯字形转换为相应的表示形式 B 并且应该正确呈现，也就是正确连接。从外观上看，它使用的是上面的 jheriko 的伪代码。

编辑（2016 年 9 月 26 日）：我知道这是很久以前我发布的原始答案。虽然没有错，但与此同时，我最终使用以下代码来转换阿拉伯字母。获取阿拉伯字母的演示文稿表格是一个非常简单的解决方案。
[https://github.com/eloraiby/arabtype/blob/master/arabtype.c](https://github.com/eloraiby/arabtype/blob/master/arabtype.c)

.

            回答 #3

赞同：2

时间：2009-11-17T08:24:26.087

看看[نصوص عربية في أوبن جي إل](http://www.agdn-online.com/communities.aspx?view=posts&threadid=544#post_3377)（阿拉伯语），这是一个阿拉伯语论坛中的讨论，涵盖了您在 OpenGL 中渲染阿拉伯语文本时将面临的所有问题，甚至是高级问题。

我不知道你是否会说阿拉伯语，但在第二页中，你会找到一个示例代码，它讲述了如何使用 GDI+ 编写阿拉伯语文本：

```
// مثال عن كود برمجي يقوم برسم النصوص على سطوح دايركت ثري دي
// لغة البرمجة هي دوت نيت مع
// C++/CLI
// ونستخدم مكتبة
// GDI+
// لكتابة النصوص
// تقديم: وسام البهنسي
// الشبكة العربية لمطوري الألعاب
// http://www.agdn-online.com
// رداً على الموضوع:
// http://www.agdn-online.com/communities.aspx?view=posts&threadid=544

// يقوم هذا الكلاس بإدارة الموارد اللازمة لرسم النصوص العربية
private ref class ArabicTextRenderer
{
public:
 ArabicTextRenderer() :
   m_NativeData(0)
 {
  // أنشئ صورة بأبعاد تتسع لأكبر جملة نصية تتوقع كتابتها بضربة واحدة
  // لاحظ أن هيئة البكسلات مهمة جداً، ويجب أن توافق هيئة السطح في محرك الرسم
  // وذلك لتفادي أي عمليات تحويل بطيئة
  m_Bitmap = gcnew Bitmap(256, 128, PixelFormat::Format32bppRgb); // كل بكسل 32 بت. لا يهمنا قناة ألفا
  m_BitmapData = gcnew BitmapData();
  m_Graphics = Graphics::FromImage(m_Bitmap);

  // حدد خواص الكتابة. تنسيق يمين-يسار
  m_Format = gcnew StringFormat();
  m_Format->FormatFlags = StringFormatFlags::NoClip | StringFormatFlags::DirectionRightToLeft;
  m_Format->Alignment = StringAlignment::Near;
  m_Format->HotkeyPrefix = HotkeyPrefix::None;
  m_Format->LineAlignment = StringAlignment::Near;
  m_Format->Trimming = StringTrimming::None;

  // معلومات عن كيفية حفظ الصورة في الذاكرة. كي نستطيع قراءتها دون تحويلات مكلفة
  m_Stride = (m_Bitmap->Width * Bitmap::GetPixelFormatSize(m_Bitmap->PixelFormat)) / 8; // عرض الصورة بالبايت
  int iBytesCount = m_Bitmap->Height * m_Stride; // حجم الصورة ككل بالبايت
  m_NativeData = new char[iBytesCount]; // المصفوفة الوسيطة التي ستستلم القيم اللونية للصورة

  // تجهيز معلومات الصورة لإجراء القفل
  m_BitmapData->Width = m_Bitmap->Width;
  m_BitmapData->Height = m_Bitmap->Height;
  m_BitmapData->PixelFormat = m_Bitmap->PixelFormat;
  m_BitmapData->Stride = m_Stride;
  m_BitmapData->Scan0 = (IntPtr)m_NativeData;
 }

 ~ArabicTextRenderer()
 {
  // حرر الذاكرة التي حجزناها بأنفسنا
  delete [] m_NativeData;
 }

 // إجراءات لتسهيل الوصول إلى أعضاء الكلاس
 property Bitmap^ TextBitmap { Bitmap^ get(void) { return m_Bitmap; } }
 property BitmapData^ TextBitmapData { BitmapData^ get(void) { return m_BitmapData; } }
 property Graphics^ TextGraphics { Graphics^ get(void) { return m_Graphics; } }
 property StringFormat^ TextFormat { StringFormat^ get(void) { return m_Format; } }
 property int Stride { int get(void) { return m_Stride; } }
 property void* NativeData { void* get(void) { return m_NativeData; } }

private:
 Graphics ^m_Graphics; // جهاز الرسم بجي دي آي بلس
 Bitmap ^m_Bitmap; // الصورة التي سيتم الرسم عليها
 BitmapData ^m_BitmapData; // معلومات القفل والتعبئة
 StringFormat ^m_Format; // خواص الكتابة
 int m_Stride; // عرض الصورة بالبايت. انتبه، قد يكون أكبر من عدد البكسلات مضروباً بحجم كل منها
 void *m_NativeData; // مؤشر إلى القيم اللونية للصورة
};

// إجراء الكتابة على صورة وتحويلها إلى بايتات يمكن إرسالها إلى أي محرك رسم
// البارامتر الأول هو النص المرغوب كتابته
// البارامتر الثاني هو الخط المرغوب للكتابة
// البارامتر الثالث هو كلاس الكتابة بالعربية والذي يجب أن يكون قد تم إنشاؤه من قبل
// البارامتر الأخير هو سطح دايركت ثري الذي ترغب بالرسم عليه
void SetText(String ^text, Font ^font, ArabicTextRenderer^ renderer, IDirect3DSurface9* D3DSurface)
{
 Bitmap ^bmp = renderer->TextBitmap;
 Graphics ^gfx = renderer->TextGraphics;

 // أولاً نقوم بمسح محتويات الصورة كي نتخلص من أي بقايا من المرة الماضية
 gfx->Clear(System::Drawing::Color::Transparent);

 // يجب علينا أن نقيس النص كي نستطيع توضيعه بشكل صحيح في الصورة
 SizeF sizef = gfx->MeasureString(text, font, PointF(0,0), renderer->TextFormat);
 short width = (short)sizef.Width;
 short height = (short)sizef.Height+2; // ضع هامشاً بمقدار بكسل واحد كارتفاع
 float yo = 1; // الإزاحة من أعلى الصورة

 // ارسم النص بدءاً من النقطة المحددة
 // لاحظ أن نقطة الكتابة هي الزاوية العليا اليمنى للنص لأننا نكتب بالعربية،
 // وبالتالي نحن بحاجة إلى وضع هذه النقطة على أقصى يمين الصورة
 gfx->DrawString(text, font, Brushes::White, width , yo, renderer->TextFormat);

 // يمكنك رسم إطار حول النص لو أردت التحقق من صحة الحسابات
 //gfx->DrawRectangle(Pens::White, 0, 0, width-1, height-1);

 // المستطيل الذي يحدد المنطقة التي نود قفلها من الصورة. عملياً كل الصورة
 Rectangle rc(0,0,bmp->Width,bmp->Height);

 // نقل القيم اللونية من الصورة إلى المؤشر الخاص بنا
 // هذه العملية تتم بمجرد قفل بتات الصورة، وذلك وفقاً للبارامترات التي نمررها
 // لإجراء القفل. هذه العملية سريعة نسبياً لأننا نسحب المعلومات بدون أي تحويل.
 bmp->LockBits(rc,ImageLockMode::ReadOnly|ImageLockMode::UserInputBuffer,
               bmp->PixelFormat,renderer->TextBitmapData);
 bmp->UnlockBits(renderer->TextBitmapData);

 // الآن لدينا كل ما يلزم لوضع البكسلات في محرك الرسم
 // الإجراء التالي يضع البكسلات في سطح دايركت ثري دي كمثال
 CopyImageToD3DSurface(D3DSurface, renderer->NativeData, renderer->Stride, width, height);

 //bmp->Save(L"C:\\صورة.png"); // احفظ الصورة للتحقق
}

// إجراء تعبئة سطح دايركت ثري دي بقيم لونية من مصفوفة ما. أي محرك رسم يجب أن يقدم إجراءً مماثلاً
// البارامتر الأول هو السطح المرغوب تعبئته
// البارامتر الثاني هو مصفوفة القيم اللونية التي تريد نسخها على السطح
// البارامتر الثالث هو عرض مصفوفة القيم اللونية بالبايت، وليس بالبكسل
// البارامتر الرابع والخامس هما أبعاد مصفوفة القيم اللونية بالبكسل. العرض والارتفاع على الترتيب
void CopyImageToD3DSurface(IDirect3DSurface9* D3DSurface, void* sourcePixels,
                           int stride, int width, int height)
{
 // هناك عدة افتراضات هنا لتبسيط الكود للمتعلم:
 // حجم السطح أكبر من أو يساوي أبعاد مصفوفة القيم اللونية
 // هيئة السطح هي ذاتها هيئة مصفوفة القيم اللونية. بمعنى آخر، لو كانت القيمة
 // اللونية مؤلفة من 4 بايتات، كل منها قناة لونية أحمر، أخضر، أزرق، ألفا
 // فإن سطح دايركت ثري دي يجب أن يكون من الهيئة:
 // D3DFMT_A8R8G8B8 أو D3DFMT_X8R8G8B8

 // انسخ القيم اللونية من كامل المصفوفة
 RECT srcRect = {0, 0, height, width};

 // انسخ القيم اللونية إلى الزاوية العليا اليسارية من السطح
 RECT destRect = {0, 0, height, width};

 // إجراء تعبئة السطح من مصفوفة قيم لونية مقدم من مكتبة دايركت ثري دي الإضافية
 D3DXLoadSurfaceFromMemory(
  D3DSurface, // السطح الذي يتم تعبئته
  NULL, // مصفوفة بجدول الألوان. لا نستخدم هذه الميزة
  &destRect, // المستطيل الذي سيتم تعبئته بالقيم اللونية في الصورة
  sourcePixels, // مصفوفة القيم اللونية التي سيتم النسخ منها
  D3DFMT_X8R8G8B8, // هيئة القيم اللونية. 32 بت وقناة ألفا غير مهمة
  stride, // عرض مصفوفة القيم اللونية بالبايت
  NULL, // مصفوفة بجدول الألوان في مصفوفة القيم اللونية. لا نستخدم هذه الميزة
  &srcRect, // المستطيل الذي يعبر عن مكان النسخ من مصفوفة القيم اللونية
  D3DX_FILTER_NONE, // طريقة الترشيح في حال عدم تطابق الأبعاد. لا نريد أي ترشيح
  0); // اللون المفتاحي. سيتم استبدال جميع القيم اللونية المطابقة لهذا اللون باللون الشفاف
} 
```

另一位会员改代码使用OpenGL，结果成功：（
[来源：][[agdn-online.com](http://www.agdn-online.com/postfiles/post3377_52D08C99.jpg)][）][![替代文字](https://i.stack.imgur.com/FcVc4.jpg)](https://i.stack.imgur.com/FcVc4.jpg)

[你可以在这里](http://www.agdn-online.com/postfiles/post3377_1425B9FB.zip)下载代码。

            回答 #4

赞同：0

时间：2009-07-31T22:44:32.343

您可能希望使用中间表示，以便在输入时将所有四种形式的字符都转换为一种形式。然后，如果您创建一个包含对四种形式中的每一种的引用的类/结构的数组正确的字符代码，您可以修改文本渲染器读取的字符串，以便它选择具有某种逻辑的正确的字符串，如下面的伪代码：

```
for each character in the input string

  find its entry in the array containing the character codes for the four forms

  if this is the first character
    if the next character is a space then 
      use the isolated form in the output string
    else
      use the initial form in the output string
  else
    if the preceeding character is a space and the next character is a space then
      use the isolated form in the output string
    else if the preceeding character is a space then use
      the initial form in the output string
    else if the next character is a space then
      use the terminal form in the output string
    else
      use the medial form in the output string 
```

            回答 #5

赞同：-4

时间：2013-04-07T22:34:52.963

**如何在此代码中加入阿拉伯语支持？**

```
Private Sub Form1_FormClosing(ByVal sender As Object, ByVal e As System.Windows.Forms.FormClosingEventArgs)
    Call SaveSetting(My.Application.Info.ProductName, "Base", "LastText", Me.RichTextBox1.Rtf)
End Sub

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs)
    Me.RichTextBox1.Rtf = GetSetting(My.Application.Info.ProductName, "Base", "LastText", "")
    If Me.RichTextBox1.TextLength = 0 Then Me.RichTextBox1.LoadFile("info.rtf")

End Sub

Private Sub Form1_Resize(ByVal sender As Object, ByVal e As System.EventArgs)
    Me.Timer1.Enabled = True
End Sub

Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
    Me.Timer1.Enabled = False

    Dim b As New Bitmap(Me.PictureBox1.Width, Me.PictureBox1.Height)
    Me.PictureBox1.Image = b
    Me.PictureBox1.Image = Image.FromFile(CurDir() & "\allpic\OperaDe1AFace.jpg")
    Rtb.RichTextBoxToBitmap(Me.RichTextBox1, Me.PictureBox1.Image)

End Sub

Private Sub RichTextBox1_TextChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RichTextBox1.TextChanged
    Me.Timer1.Enabled = True
End Sub

Private Sub Form1_Load_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

End Sub

Private Sub PictureBox1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

End Sub

Private Sub PictureBox2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)

End Sub

Private Sub PictureBox1_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs)

End Sub

Private Sub NewToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles NewToolStripMenuItem.Click

End Sub

Private Sub PictureBox1_Click_2(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PictureBox1.Click

End Sub

Private Sub PictureBox1_MouseDown(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles PictureBox1.MouseDown
    StartPoint = PictureBox1.PointToScreen(New Point(e.X, e.Y))
    IsDragging = True
End Sub

Private Sub PictureBox1_MouseMove(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles PictureBox1.MouseMove
    If IsDragging Then
        Dim EndPoint As Point = PictureBox1.PointToScreen(New Point(e.X, e.Y))
        PictureBox1.Left += (EndPoint.X - StartPoint.X)
        PictureBox1.Top += (EndPoint.Y - StartPoint.Y)
        StartPoint = EndPoint
    End If
End Sub

Private Sub PictureBox1_MouseUp(ByVal sender As Object, ByVal e As System.Windows.Forms.MouseEventArgs) Handles PictureBox1.MouseUp
    IsDragging = False
End Sub 
```

结束类

        iphone - UITableView 怪异！有图片

ID：556747

赞同：4

时间：2009-02-17T13:20:18.410

标签：iphone, objective-c, cocoa-touch, uitableview

我有一个 UIViewController 允许我查看和编辑类的信息。

它只分配一次，但它的行数、节数和数据根据用户选择的值传递给它。

例如。这里它正在编辑一个名称和类型属性（表的标题视图太大了。我这样做是为了让你看到下面的怪异）

![替代文字](https://farm4.static.flickr.com/3235/3287818468_19a6292d5d.jpg?v=0)

所以我输入了一个名字，一切都很好。然后我单击地址属性，详细视图现在如下所示：

![替代文字](https://farm4.static.flickr.com/3345/3286999031_2cc3a8a9b7.jpg?v=0)

到目前为止一切正常。如果我单击取消并返回编辑名称属性，它显示正常。问题是这样的。我像这样向下滚动地址表：

![替代文字](https://farm4.static.flickr.com/3487/3287818072_f5b8255b2c.jpg?v=0)

然后单击保存/取消。现在当我回去编辑 name 属性时，tableview 看起来像这样！

![替代文字](https://farm4.static.flickr.com/3596/3286998687_3d362759b3.jpg?v=0)

就好像以前的表格仍然可以通过表格的标题视图看到..？

我的 viewWillAppear: 这个 uiviewcontroller 的方法如下所示：

```
- (void)viewWillAppear:(BOOL)animated {

NSLog(@"Retain count of poolcopy is %d\n\n", [self.thePoolFacilityCopy retainCount] );
//This will be a reference to find our which pool Instance field we are editing.
self.sectionFromParentTable = self.cellPath.section;
//This will only be used by the arrays
self.rowFromPreviousTable = self.cellPath.row;

NSString *sectionName;  

switch (self.sectionFromParentTable) {
    case KNameIndex:
        sectionName = @"name";

        break;
    case KAddressIndex:
        sectionName = @"address";

        break;
    case KPhoneNumberIndex:
        sectionName = @"phone";

        break;
    case KWebAddressIndex:
        sectionName = @"url";

        break;
    case KPricesIndex:
        sectionName = @"prices";

        break;
    case KPoolIndex:
        sectionName = @"pools";

    default:
        break;
}

self.title = [NSString stringWithFormat:@"Editing %@", sectionName];

// use an empty view to position the cells in the vertical center of the portion of the view not covered by 
// the keyboard

if (self.sectionFromParentTable == KPhoneNumberIndex || self.sectionFromParentTable == KWebAddressIndex) {

    UIView *singleSectionHeaderView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 5, 60)];
    self.theTableView.tableHeaderView = singleSectionHeaderView;
    [singleSectionHeaderView release];

    self.theTableView.tableFooterView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, 5, 10)]autorelease];

}
else if (self.sectionFromParentTable == KAddressIndex) {
    UIView *addressHeaderView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 5, 0)];
    self.theTableView.tableHeaderView = addressHeaderView;
    [addressHeaderView release];

    self.theTableView.tableFooterView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, 5, 250)]autorelease];
}
else if (self.sectionFromParentTable == KPoolIndex) {
    UIView *poolHeaderView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 5, 2)];
    self.theTableView.tableHeaderView = poolHeaderView;
    [poolHeaderView release];

    self.theTableView.tableFooterView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, 5, 10)]autorelease];

}
else {
    UIView *doubleSectionHeaderView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 5, 30)];
    self.theTableView.tableHeaderView = doubleSectionHeaderView;
    [doubleSectionHeaderView release];

    self.theTableView.tableFooterView = [[[UIView alloc] initWithFrame:CGRectMake(0, 0, 5, 10)]autorelease];
}

[self.theTableView reloadData]; 
```

}

在表格看起来混乱的图片中，cellForRowAtIndexPath 方法只被调用了两次，即使有 3 个单元格可见（2 个正常单元格和一个奇怪的单元格）。奇怪的单元格随着滚动而移动，并且仍然可以点击。

我可以通过在此方法中注释掉以下行来解决此问题。但是，我不想每次有人想要编辑细节时都分配一个新的控制器：

```
 - (PoolFacilityDetailEditController *)childController {
    // Instantiate the editing view controller if necessary.
   // if (childController == nil) {
        PoolFacilityDetailEditController *controller = [[PoolFacilityDetailEditController alloc] initWithNibName:@"PoolFacilityDetailEditController" bundle:nil];
        self.childController = controller;
        [controller release];
  // }
    return childController;
} 
```

            回答 #1

赞同：2

时间：2009-02-17T19:35:24.093

如果不查看所有代码就很难判断，但是您是否有可能没有正确回收您的 tableview 单元格？您必须为呈现不同的每个单元格分配不同的重用标识符。如果标题单元格被重用为细节单元格（反之亦然），这将导致渲染出现一些奇怪的问题。

            回答 #2

赞同：0

时间：2012-03-09T14:10:52.510

请使用 TableViewCell 的另一个类，根据您的要求完全自定义它。然后将其导入您的代码。有用！！

        javascript - 限制文本区域中的行数

ID：556767

赞同：35

时间：2009-02-17T13:23:52.440

标签：javascript, jquery, textarea

我正在寻找一个可以限制行数的javascript（通过行我的意思是用户在键盘上按Enter键结束的一些文本）用户能够在textarea中输入。我找到了一些解决方案，但它们根本不起作用或表现得很奇怪。最好的解决方案是一个可以完成工作的 jquery 插件——比如[CharLimit](http://plugins.jquery.com/project/CharLimit)，但它应该能够限制文本行数而不是字符数。

            回答 #1

赞同：23

时间：2009-02-17T15:03:04.277

这*可能会*有所帮助（可能最好使用 jQuery、onDomReady 并且不显眼地将 keydown 事件添加到 textarea）但在 IE7 和 FF3 中进行了测试：

```
<html>
  <head><title>Test</title></head>
  <body>
    <script type="text/javascript">
      var keynum, lines = 1;

      function limitLines(obj, e) {
        // IE
        if(window.event) {
          keynum = e.keyCode;
        // Netscape/Firefox/Opera
        } else if(e.which) {
          keynum = e.which;
        }

        if(keynum == 13) {
          if(lines == obj.rows) {
            return false;
          }else{
            lines++;
          }
        }
      }
      </script>
    <textarea rows="4" onkeydown="return limitLines(this, event)"></textarea>
  </body>
</html> 
```

*编辑 - 解释：如果按下 ENTER 键，它会捕获按键，如果 textarea 中的行与 textarea 的行数相同，则不会添加新行。否则它会增加行数。

**编辑#2：**考虑到人们仍然会来这个答案，我想我会尽可能地更新它以处理粘贴、删除和剪切。

```
<html>

<head>
    <title>Test</title>
    <style>
        .limit-me {
            height: 500px;
            width: 500px;
        }
    </style>
</head>

<body>
<textarea rows="4" class="limit-me"></textarea>

<script>
    var lines = 1;

    function getKeyNum(e) {
        var keynum;
        // IE
        if (window.event) {
            keynum = e.keyCode;
            // Netscape/Firefox/Opera
        } else if (e.which) {
            keynum = e.which;
        }

        return keynum;
    }

    var limitLines = function (e) {
        var keynum = getKeyNum(e);

        if (keynum === 13) {
            if (lines >= this.rows) {
                e.stopPropagation();
                e.preventDefault();
            } else {
                lines++;
            }
        }
    };

    var setNumberOfLines = function (e) {
        lines = getNumberOfLines(this.value);
    };

    var limitPaste = function (e) {
        var clipboardData, pastedData;

        // Stop data actually being pasted into div
        e.stopPropagation();
        e.preventDefault();

        // Get pasted data via clipboard API
        clipboardData = e.clipboardData || window.clipboardData;
        pastedData = clipboardData.getData('Text');

        var pastedLines = getNumberOfLines(pastedData);

        // Do whatever with pasteddata
        if (pastedLines <= this.rows) {
            lines = pastedLines;
            this.value = pastedData;
        }
        else if (pastedLines > this.rows) {
            // alert("Too many lines pasted ");
            this.value = pastedData
                .split(/\r\n|\r|\n/)
                .slice(0, this.rows)
                .join("\n ");
        }
    };

    function getNumberOfLines(str) {
        if (str) {
            return str.split(/\r\n|\r|\n/).length;
        }

        return 1;
    }

    var limitedElements = document.getElementsByClassName('limit-me');

    Array.from(limitedElements).forEach(function (element) {
        element.addEventListener('keydown', limitLines);
        element.addEventListener('keyup', setNumberOfLines);
        element.addEventListener('cut', setNumberOfLines);
        element.addEventListener('paste', limitPaste);
    });
</script>
</body>
</html> 
```

            回答 #2

赞同：16

时间：2011-06-27T06:13:11.410

**如何用 jQuery 做到这一点：**

绑定到 textarea 的 keyDown 事件。

```
function limitTextareaLine(e) {
    if(e.keyCode == 13 && $(this).val().split("\n").length >= $(this).attr('rows')) { 
        return false;
    }
} 
```

            回答 #3

赞同：7

时间：2012-12-18T22:24:27.230

此解决方案有效：

```
<script type="text/javascript">
    function limitTextarea(textarea, maxLines, maxChar) {
        var lines = textarea.value.replace(/\r/g, '').split('\n'), lines_removed, char_removed, i;
        if (maxLines && lines.length > maxLines) {
            lines = lines.slice(0, maxLines);
            lines_removed = 1
        }
        if (maxChar) {
            i = lines.length;
            while (i-- > 0) if (lines[i].length > maxChar) {
                lines[i] = lines[i].slice(0, maxChar);
                char_removed = 1
            }
            if (char_removed || lines_removed) {
                textarea.value = lines.join('\n')
            }
        }
    }
</script> 
```

和文本区域将是

```
<asp:TextBox ID="myWishTB" runat="server" Height="185px" TextMode="MultiLine" 
             Style="overflow: auto;" Width="95%" 
             onkeyup="limitTextarea(this,10,80)">
</asp:TextBox> 
```

在常规 HTML 中：

```
<textarea id="textareaID" onkeyup="limitTextarea(this,5,100)" cols="20" rows="5">   </textarea> 
```

            回答 #4

赞同：7

时间：2013-09-06T20:52:18.283

jQuery 示例。这适用于打字和粘贴。

```
 //Limit to # of rows in textarea or arbitrary # of rows
  $('#yourtextarea').bind('change keyup', function(event) {
    //Option 1: Limit to # of rows in textarea
    rows = $(this).attr('rows');
    //Optiion 2: Limit to arbitrary # of rows
    rows = 6;

    var value = '';
    var splitval = $(this).val().split("\n");

    for(var a=0;a<rows && typeof splitval[a] != 'undefined';a++) {
      if(a>0) value += "\n";
      value += splitval[a];
    }
    $(this).val(value);
  }); 
```

            回答 #5

赞同：4

时间：2011-08-09T15:42:23.583

（用jquery完成）。它并不完美，但关心包装。不仅仅取决于行尾 (\n)。
如果 textarea 中的 css 溢出属性不是 auto，则 jquery 滚动事件在 mozilla 和 firefox 中存在问题，否则删除相应的行并设置溢出隐藏。可以帮助 css 调整大小：无和固定高度。

```
$('#textarea').scroll(function () {
    $(this).css("overflow", "hidden");      /* for the mozilla browser problem */
    $(this).animate({scrollTop: $(this).outerHeight()});
    while ($(this).scrollTop() > 0) {       /* for the copy and paste case */               
        lines=$(this).val().slice(0,-1);
        $(this).val(lines);
    }
    $(this).css("overflow", "auto");        /* For the mozilla browser problem */
}); 
```

            回答 #6

赞同：3

时间：2009-02-17T13:31:48.973

给定文本块的可见/显示行数会因不同的浏览器、使用的字体等而异。您必须至少设置特定的字体和字体大小，才能半可靠地计数显示行。

更新：我看到了编辑。然后像 kevchadders 代码这样的东西应该适合你。您将需要 js 来计算字符和 '\r\n' 并检查用户定义的限制。此外，如果您不使用他的脚本，请确保使用涉及时间间隔检查和/或 textarea 的 onKeyDown/onKeyUp 事件的脚本。这可能就是为什么您测试过的某些脚本看起来“行为异常”的原因。

            回答 #7

赞同：1

时间：2009-03-31T19:58:32.173

这与伊万的回答基本相同，使用 jQuery。我为自己的项目对其进行了测试；似乎工作正常。

```
<script type="text/javascript" charset="utf-8">
  $(function() 
  {
    function getLines(id)
    {
      return $('#' + id).val().split("\n").length
    }

  $('#testing').keyup(function() 
  {
    var allowedNumberOfLines = 4;

    if(getLines('testing') > allowedNumberOfLines)
    {
      modifiedText = $(this).val().split("\n").slice(0, allowedNumberOfLines);
      $(this).val(modifiedText.join("\n"));
    }
  });
});
</script> 
```

            回答 #8

赞同：1

时间：2011-12-03T23:38:44.960

我对其进行了扩展，以检测甚至溢出而无需手动换行。这适用于具有“溢出：隐藏”的固定大小的文本区域。

目前，如果字体不适合 textarea，我的解决方案会使字体变小。如果可能的话，让它再次变大。

```
var keynum, allowedLines = 5, defaultFontSize = 13/*px*/;

$(document).ready(function() {
    $("textarea").keydown(function(e, obj) {
        if(window.event)
            keynum = e.keyCode;
        else if (e.which)
            keynum = e.which;

        if (keynum == 13 && allowedLines <= $(this).val().split("\n").length)
            return false;
    });
    $("textarea").keyup(function(e, obj) {
        // Avoid copy-paste
        if (allowedLines < $(this).val().split("\n").length) {              
            lines = $(this).val().split("\n").slice(0, allowedLines);
            $(this).val( lines.join('\n') );
        }

        // Check overflow
        if ((this.clientHeight < this.scrollHeight)) {
            while ((this.clientHeight < this.scrollHeight)) {
                currFontSize = $(this).css('font-size');
                finalNum = parseFloat(currFontSize, 11);
                stringEnding = currFontSize.slice(-2);
                $(this).css('font-size', (finalNum-1) + stringEnding);
            }
        } else if ($(this).css('fontSize') != defaultFontSize+'px')  {
            while ($(this).css('font-size') != defaultFontSize+'px') {
                // First lets increase the font size
                currFontSize = $(this).css('font-size');
                finalNum = parseFloat(currFontSize, 11);
                stringEnding = currFontSize.slice(-2);
                $(this).css('font-size', (finalNum+1) + stringEnding);
                // lets loop until its enough or it gets overflow again
                if(this.clientHeight < this.scrollHeight) {
                    // there was an overflow and we have to recover the value
                    $(this).css('font-size', currFontSize);
                    break;
                }
            }
        }
    });
}); 
```

        c# - C#：是否需要编译指示警告恢复？

ID：556771

赞同：54

时间：2009-02-17T13:24:58.570

标签：c#, compiler-warnings, pragma

从[msdn](http://msdn.microsoft.com/en-us/library/441722ys(VS.80).aspx)我得到这个：

```
#pragma warning disable warning-list
#pragma warning restore warning-list 
```

在示例中，都使用了`disable`和`restore`。`restore`如果我希望对整个文件禁用它，是否有必要？

就像，如果我不恢复，它会走多远？之后编译的所有内容是否都禁用了警告？还是只针对该文件的其余部分？还是被忽略了？

            回答 #1

赞同：59

时间：2009-02-17T13:28:26.690

如果您不恢复，则禁用对文件的其余部分处于活动状态。

[有趣的是，语言规范中](http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-334.pdf)**没有**定义这种行为。（请参阅第 9.5.8 节）但是，关于条件编译符号的 9.5.1 部分确实表明了这种“直到文件行为结束”

该符号保持定义，直到处理相同符号的#undef 指令，或者直到到达源文件的末尾。

鉴于“预处理器”实际上是编译的词法分析阶段的一部分，在可预见的未来，这种行为很可能是微软和所有其他实现的有效合同（特别是因为替代方案将非常复杂且基于非确定性关于源文件编译顺序）

            回答 #2

赞同：3

时间：2009-02-17T13:32:26.990

假设我有一个使用反射初始化的私有字段，编译器显然找不到任何直接写入该字段的代码，因此它会显示一个警告 - 我不想显示。

假设我在我忘记初始化的第一行下方定义了另一个私有字段，如果我禁用整个文件的警告，则不会触发警告。

因此，#pragma 警告的最佳用法是在导致我要抑制的警告的行之前放置一个“警告禁用”，并在该行之后放置一个“警告恢复”，以便在不同位置的相同条件文件仍然会触发警告。

            回答 #3

赞同：2

时间：2009-02-17T13:28:26.003

不，您会发现编译器在完成对源文件的解析后会自动恢复任何禁用的警告。

```
#pragma warning disable 649
struct MyInteropThing
{
    int a;
    int b;
}
#pragma warning restore 649 
```

在上面的示例中，我已关闭警告 CS00649，因为我打算以不安全的方式使用此结构。编译器不会意识到我将写入具有这种布局的内存，所以我想忽略警告：

字段“字段”从未分配给，并且始终具有其默认值“值”

但我不希望整个文件不被选中。

        .net - WCF：属性与成员的 DataMember 属性

ID：556775

赞同：53

时间：2009-02-17T13:26:39.453

标签：.net, wcf, serialization

`DataMember`在wcf中，将属性应用于属性有  什么区别

```
private int m_SomeValue;

[DataMember]  
public int SomeValue {
  get {...}
  set {...}
} 
```

而不是成员变量  

```
[DataMember]  
private int m_SomeValue;

public int SomeValue {
  get {...}
  set {...}
} 
```

?

            回答 #1

赞同：41

时间：2009-02-17T14:29:13.393

通常，您应该倾向于在属性上应用 DataMember 特性，而不是在私有字段上。将属性应用于字段的唯一原因是该属性是只读的（即它没有设置器）。

            回答 #2

赞同：24

时间：2009-02-17T13:53:26.987

只要您使用`Name`标记，无论是否使用字段或属性，合同都是相同的。

```
[DataMember(Name="SomeValue")]
private int m_SomeValue; 
```

但是，访问私有成员可能存在一些权限问题，特别是在 silverlight 和 CF 上 - 在这种情况下，我建议使用公共属性作为数据成员。实际上，除非我有充分的理由，否则我倾向于*始终使用属性...*

            回答 #3

赞同：6

时间：2010-05-28T13:40:27.770

您可能希望将字段而不是属性标记为 DataMember 有充分的理由。

请检查此以获取更多详细信息：http: [//blog.walteralmeida.com/2010/05/wcf-and-datacontract-serialization-internals-and-tips-.html](http://blog.walteralmeida.com/2010/05/wcf-and-datacontract-serialization-internals-and-tips-.html)

**顺便说一句：ContractSerializers只有在完全信任环境中运行时**才会序列化任何具有 DataMemberAttribute 的私有字段。在部分信任下不起作用（查看上面列出的博客以获取解决方案）

            回答 #4

赞同：4

时间：2011-12-09T08:15:12.317

此决定取决于您的 WCF 服务的使用情况：

1.  您拥有的 .NET 系统使用的内部服务共享相同的域模型。
2.  不同平台使用的外部服务，不共享相同的域模型。

**情况1。**

序列化 - 是保持对象状态的过程。C# 中对象的状态由它的数据字段表示。

C# 中的属性本质上是方法，用于操作对象的状态。使用它们可能会导致反序列化的不同对象状态，因为设置属性的顺序可能会影响其最终数据状态。其他因素也可能导致不正确的状态反序列化，例如方法（属性集）依赖于某些正在变化的上下文，例如当前的 DateTime。

你可能会说封装呢？我不希望我的对象处于无效状态，我必须进行验证检查、对象图完整性检查等。是的，你应该这样做，所以我们将 DataMember 属性放在 props 上？不。

这里的问题是很多人混合了两种不同的东西，DTO（数据传输对象，WCF 合同）和域实体。您需要确保您收到的数据与发送的数据完全相同，然后确保您可以从该数据构造有效的域实体。实现这一点的最佳方法是为 DTO 使用单独的类，并从中构造域实体。

但是大多数程序员都很懒惰，他们喜欢用 DataMemeber 属性简单地装饰 Domain Entity。在这种情况下，决定 Field 或 Prop 取决于您的验证逻辑在哪里，如果您的验证逻辑隐藏在 Set 方法中，您将不得不使用 Props，如果它是外部的，您应该使用 Fields，并在反序列化后验证您的域实体。

PS 我认为相同的规则适用于任何序列化过程，例如数据库持久性。

另外，我想提一下 Silverlight 不能序列化\反序列化私有字段，因为您不能使用反射从外部访问它们，您必须将它们设为私有并使用 InternalsVisibleToAttribute。

**案例 2。**

这很难。这里的主要焦点是互操作性。在这种情况下，99.9% 的情况下您将拥有单独的 DTO 类，并且很可能有很多不同版本的它们来支持旧客户端。将 DataMembers 属性放在此处并不重要，因为您使用的是 DTO。我不会费心解释这种情况，因为在这种大规模系统上工作的开发人员通常很有经验，而且他们不会费心阅读 SO。

            回答 #5

赞同：3

时间：2009-02-17T13:32:13.047

从理论上讲，只要您`m_SomeValue`始终保持等于`SomeValue`（就像一个简单的 getter/setter 一样），什么都没有。除了由 WCF 公开的变量的名称。（显然，如果您标记`m_`变量，那么您的代理类也将具有相同的`m_`名称。无论您使用公共/受保护/内部/私有字段还是属性，代理类都会生成一个公共属性。

但是，如果您的访问器中有任何特殊逻辑可能会修改返回的值（`ToUpper()`例如，字符串），那么您将返回不同的值。

            回答 #6

赞同：2

时间：2009-10-27T16:34:44.743

就我个人而言，我只会使用该属性并完全删除成员变量。IE

```
[DataMember]
public int SomeValue
{ get; set; } 
```

该属性将在幕后莫名其妙地创建一个成员变量。

            回答 #7

赞同：1

时间：2010-05-21T03:08:04.137

如果在private int m_SomeValue上添加[DataMember]，该成员不能被序列化，所以必须在public int SomeValue上添加。

```
[DataMember]  
private int m_SomeValue;

public int SomeValue {
  get {...}
  set {...}
} 
```

如果您通过 WCF 使用上面的代码，则无法在客户端中获取值。

        python - WingIDE 没有自动完成我的模块

ID：556785

赞同：0

时间：2009-02-17T13:28:35.800

标签：python, ide

如果有人使用 WingIDE 来满足他们的 python 开发需求：出于某种原因，我可以在所有标准 python 库（如 datetime ......）上自动完成，但在我自己的模块上却没有。因此，如果我创建自己的类，然后从另一个类中导入它，我不会自动完成它。

有人知道为什么是这样吗？

            回答 #1

赞同：0

时间：2009-02-17T14:28:17.903

刚刚找到答案，它与pythonpath有关：http:
 [//www.wingware.com/doc/edit/how-analysis-works](http://www.wingware.com/doc/edit/how-analysis-works)

        perl - 从头开始创建 .pdf 的最佳 Perl 模块是什么？

ID：556786

赞同：14

时间：2009-02-17T13:29:51.740

标签：perl, pdf, cpan

CPAN 上有很多与 .pdf 文件的创建和操作相关的模块，我希望这个社区可以为我节省一些走上死胡同的时间。

我希望从头开始创建 .pdf 文件，只有简单的格式，例如粗体/斜体和左/右/中心对齐。从 MVC 的角度来看，能够使用模板文件会很好，但如果最好的模块不支持，我没关系。我想要针对我的狭窄问题集的最佳模块。  

**编辑：**让我们添加它必须是 Perl 模块的约束，如果不是纯 perl 解决方案。感谢您迄今为止的回答！

**更新**：PDF 创建是决定如何处理的一个难题。除了这里的好建议之外，似乎还有大约 1,000 种不同的方法可以解决这个问题，而知道将时间投入到哪些解决方案上是一个真正的挑战。在构建这个解决方案的过程中很容易获得对外部可执行文件的依赖，这就是为什么我一直倾向于尽可能在 Perl 中做所有事情。

我尝试使用 PDF::Create 但发现它太局限了。您必须给出坐标来放置每个文本字符串，并且没有内置的文本换行概念......这就是您必须做的所有工作。我的任务不可能的开销。

我现在使用的是 PDF::API2，它比 PDF::Create 功能强大得多，但仍然要求 PDF 以令人不安的低级别组装。幸运的是，网上有一些帮助。请参阅[Rick Measham 出色的 PDF::API2 教程以及随附的 text_block() 子例程](http://rick.measham.id.au/pdf-api2/)，幸运的是，它解决了文本换行问题。

除非您在这里看到另一个更新，否则这是最终为我工作的解决方案。

            回答 #1

赞同：7

时间：2009-02-18T06:28:54.863

我是 CPAN 模块[CAM::PDF](http://search.cpan.org/dist/CAM-PDF/)的作者，它绝对不是这项工作的最佳工具——它是为高性能编辑而不是创建而设计的。

在免费的 PDF 创建库中，我最喜欢 PDF::API2。它具有非常丰富的功能集和良好的加密支持（灵感来自我可能添加的 CAM::PDF！）作者 Alfredo 管理着一个流行的电子邮件列表。人们有时会抱怨文档，但我发现它已经足够了。

在商业图书馆中，我对 pdflib 有很好的经验。

            回答 #2

赞同：6

时间：2009-02-17T15:02:24.560

我想到了三个用于创建 PDF 的模块（没有特别的顺序）......

*   [PDF::API2](http://search.cpan.org/dist/PDF-API2/)
*   [PDF:::创建](http://search.cpan.org/dist/PDF-Create/)
*   [PDF::模板](http://search.cpan.org/dist/PDF-Template/)

PDF::Template 为您提供了您可能渴望的模板选项？PDF::Create 似乎更直接（至少从文档中）并且可能更充分地满足您的“简单格式”要求。

但是，如果您想知道“社区”的想法，那么只有 PDF::API2 获得了[CPAN 评级](http://cpanratings.perl.org/)的评级，总分为 5 星  中[的 4 星](http://cpanratings.perl.org/dist/PDF-API2)。

希望有帮助。

PS。免责声明：我没有使用任何这些模块。过去，我一直使用[Apache FOP](http://xmlgraphics.apache.org/fop/)来使用 XML/XSLT/XSL-FO ，而 Perl 则用于创建初始 XML 数据。如果您想将 PDF 生成嵌入到您的 Perl 应用程序中，这对于一些小东西来说可能是一种过度杀伤，而且并不总是理想的。

聚苯乙烯。因此，我还将在不久的将来某个时候查看这些 CPAN PDF 模块！

            回答 #3

赞同：5

时间：2009-02-17T13:43:30.007

它必须是 Perl 模块吗？您总是可以使用 LaTeX 并将其转换为 PDF。不是很直接，但它是另一种选择。

            回答 #4

赞同：2

时间：2009-04-02T12:14:14.367

G'day马库斯，

很高兴你找到了教程。我在 PDF::API2 中做了很多工作，所以如果有什么我可以帮忙的，请告诉我。

当然，我推荐 PDF::API2！

有一个人 Jay Hannah，他目前正在将文本块转换为 CPAN 的模块，该模块完全符合您的要求：粗体、斜体等。如果您查看邮件列表，您会在顶部看到他的帖子。

干杯!

里克·米沙姆

            回答 #5

赞同：0

时间：2009-02-17T14:45:51.963

是的，如果不确切知道您的限制是什么，很难回答。如果纯 Perl 不是必需品，我会倾向于[DocBook](http://www.docbook.org/)。  

您将生成的初始标记可以是非常简单的 XML；并且这种转换只需要一个 XSL 处理器并使用 Apache 的[FOP](http://xmlgraphics.apache.org/fop/)之类的东西。

            回答 #6

赞同：-2

时间：2009-04-06T06:54:16.390

如何使用 perl 保存在线 pdf 文件？
[http://www.nwcc.bc.ca/FNC/pdfs/Stepping%20Stones%20to%20improved%20Relationships%20-%20web.pdf](http://www.nwcc.bc.ca/FNC/pdfs/Stepping%20Stones%20to%20improved%20Relationships%20-%20web.pdf)

我正在使用文件::下载。但问题是它没有下载带有 url 编码字符串的 url。

夏尔马

        .net - Ajax 工具包 CalendarExtender 导致 IE6 崩溃的问题

ID：556787

赞同：1

时间：2009-02-17T13:30:41.207

标签：.net, asp.net, ajax

我的 Web 项目中的 CalandarExtender 有一个奇怪的问题。当有人点击小日历图标 IE6 崩溃！我认为我正确实施了它

```
<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" 
            TagPrefix="cc1" %>

<asp:TextBox ID="txtDateDebut" runat="server"
             CssClass="TextBox"></asp:TextBox>  &nbsp;
<asp:ImageButton ID="txtDateDebutButton" runat="server" 
                 ImageUrl="~/images/16X16_2/cal.gif" />
 <cc1:CalendarExtender ID="txtDateDebutCalendarExtender" runat="server" 
                       Animated="false" CssClass="Calendar"
                       FirstDayOfWeek="Monday" 
                       Format="dd/MM/yyyy"
                       PopupButtonID="txtDateDebutButton"  
                       TargetControlID="txtDateDebut">  
 </cc1:CalendarExtender> 
```

在 IE7 上它可以工作但它会伸展，在 IE6 上它会冻结应用程序直到它停止而没有任何错误消息。

            回答 #1

赞同：2

时间：2009-03-11T18:43:49.447

有两件事要尝试：

1) 如果您在 内部运行它`UpdatePanel`，请确保您的 UpdatePanel 上设置了 ID。

2）如果您已经设置`EnableEventValidation="false"`，请尝试将其转回`on`。

我知道这些听起来很奇怪，但#2 修复了我正在处理的一个非常复杂的 Web 应用程序中的 IE6 崩溃...

            回答 #2

赞同：1

时间：2009-03-10T05:02:28.557

如果你愿意走出 asp.net 给你的世界，你有很多选择，比如：

[http://www.stefanoverna.com/log/create-astonishing-ical-like-calendars-with-jquery](http://www.stefanoverna.com/log/create-astonishing-ical-like-calendars-with-jquery)

话虽如此，您是否只是想制作一个日期选择器并想要一个适当的 asp.net 控件，我以前使用过这些人并且效果很好（不，我不在那里工作）

[http://www.basicdatepicker.com/](http://www.basicdatepicker.com/)

        javascript - 隐藏整个表格调整它的大小

ID：556789

赞同：2

时间：2009-02-17T13:31:25.417

标签：javascript, html, firefox

拥有一个带有简单表格和 js 代码的 HTML 页面来显示/隐藏它：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>title</title>
    <script type="text/javascript">

    function showErrorSteps()
    {        
        var el = document.getElementById("t1");

        if(el.style.display=="none")
        {
            el.style.display="block";
        }
        else
        {
        el.style.display="none";
        }                                               
    }

    </script>
</head>
<body>

<br />
<span onclick="showErrorSteps()">[click]</span>
<br />
<br />

<table id="t1" border="1" width="100%" style="table-layout: fixed">
<tr>
    <td>s</td>
    <td>d</td>
    <td>a</td>
</tr>
</table>        
</body>
</html> 
```

发生的情况是，在 Mozilla 上单击两次后表格会调整大小（即使使用表格布局：固定 css）。IE 工作正常。

            回答 #1

赞同：6

时间：2009-02-17T13:37:17.977

表格不应设置为`display: block`. 表格行和单元格也不应该。它们具有不同的显示值。我的建议？不要这样做。使用一个类：

```
.hidden {
  display: none;
} 
```

并动态添加它并从表中删除它以避免在您显示的元素上设置正确的显示类型的问题。

**编辑：**澄清关于为什么这样做以及发生了什么的评论。试试这个：

```
<table>
<tr>
  <td>Cell 1</td>
  <td style="display: block;">Cell 2</td>
</tr>
</table 
```

它会（或应该）搞砸你的表格布局。为什么`<td>`，因为默认情况下，元素`display: table-cell`没有`block`. 表是一样的。他们有`display: table`。

取消设置 CSS 属性是……有问题的。

因此，您最好使用类来设置和取消设置属性。它更容易更改（类驻留在 CSS 文件中，而不是代码），避免了将值设置回正确的原始值等问题，并且通常提供更简洁的解决方案，尤其是在与 jQuery 等库一起使用时。在 jQuery 中，您可以执行以下操作：

```
$("table").toggleClass("hidden"); 
```

完毕。

或者你可以使用`addClass()`，`removeClass()`如果这更合适的话。例如：

```
<input type="button" id="hide" value="Hide Table">
...
<table id="mytable">
... 
```

和

```
$(function() {
  $("#hide").click(function() {
    if ($("#mytable").is(".hidden")) {
      $("#hide").val("Hide Table");
      $("#mytable").removeClass("hidden");
    } else {
      $("#hide").val("Show Table");
      $("#mytable").addClass("hidden");
    }
  });
}); 
```

这样您就有了一个健壮、简洁且易于理解的解决方案（一旦您了解了 jQuery 语法，这不会花费那么长时间）。

2002 年就直接用 Javascript 搞砸了。:-)

            回答 #2

赞同：1

时间：2009-02-17T13:48:14.193

这不是对您问题的直接回答，而是一个严肃的建议。我最近发现了[JQuery](http://jquery.com/)的乐趣。所有这些事情都可以毫不费力地完成，并且有大量的在线示例和参考资料可供使用。

如果您现在没有时间深入了解它，那么我相信有人会在这里提供解决方案，但我建议任何除了最粗略的 JavaScript DOM 操作之外做任何事情的人考虑 JQuery（或类似的框架）。

JQuery 提供独立于浏览器的 Hide()、Show() 和 Toggle() 方法。这是我最喜欢的[参考资料](http://www.gscottolson.com/jquery/jQuery1.2.cheatsheet.v1.0.pdf)之一。

            回答 #3

赞同：0

时间：2009-02-17T13:39:17.413

这可能是因为您将 style.display 设置为“block”。尝试将其设置为“”。您还应该使用 CSS 设置表格宽度。（宽度：100%；）

        windows - 如何使用一个命令一次启动多个 Windows 服务？

ID：556801

赞同：3

时间：2009-02-17T13:34:27.300

标签：windows, windows-services

我用于编程的主要计算机是我用于游戏等的同一台计算机。因此，为了提高游戏速度，我从启动时关闭了 Apache、MySQL、Subversion 等服务，因为我将其用于游戏/编程的比例约为 50/50。

这在大多数情况下都很好，但是单独启动它们有点麻烦。

有人可以告诉我如何编写批处理文件或类似的东西来启动所有服务吗？

            回答 #1

赞同：5

时间：2009-02-17T13:36:43.753

好吧，您可以编写一个批处理文件，例如

```
net start "Service Name" 
```

应该有一种方法可以将服务依赖链接在一起，所以当一个人启动时，其他人也会这样做。我会看看我是否能找到开关来做到这一点。

编辑：

我还没有尝试过，但这应该会告诉您在注册表中的哪个位置可以使服务相互依赖并自动启动：

[http://www.softwaretipsandtricks.com/windowsxp/articles/490/1/Removing-Service-Dependencies](http://www.softwaretipsandtricks.com/windowsxp/articles/490/1/Removing-Service-Dependencies)

            回答 #2

赞同：4

时间：2009-02-19T07:00:30.160

您还可以通过调用使服务并行启动：

SC START 服务名称

我不知道这是否有帮助...

*除非您真的*知道自己在做什么，否则我不会弄乱服务的依赖关系。

            回答 #3

赞同：3

时间：2009-02-17T13:37:34.687

启动服务的命令是`"net start <servicename>`“。只需将您需要的命令添加到名为 Something.bat 的文件中并运行它。简单。:)

`net stop <service name>`也会阻止他们。

            回答 #4

赞同：3

时间：2009-02-25T20:38:31.160

如果您使用的是 powershell，则可以执行以下操作：

```
"service1", "service2" | %{ start-service $_ } 
```

为了解释上面的内容，如下：

1.  创建一个包含“service1”和“service2”的数组
2.  将该数组传递给`foreach`命令（这是`%`符号）
3.  该`foreach`命令将运行代码块（由 分隔`{ }`），“当前项”由`$_`
4.  因此它将`start-service`在您的阵列中的每个事物上运行

            回答 #5

赞同：2

时间：2020-03-15T10:15:44.987

如果您有一个通用名称，只需使用 powershell

启动服务

```
Get-Service *pattern* | start-service 
```

停止服务

```
Get-Service *pattern* | stop-service 
```

            回答 #6

赞同：1

时间：2015-10-12T03:56:21.537

尽管我正在研究类似的东西，但我对此有点晚了。

创建一个批处理文件并在该批处理文件中使用 sc 命令：

sc 开始“第一个服务名称” sc 开始“第二个服务名称”

等等...保存批处理文件，然后双击它运行它，或者安排它相应地运行。

            回答 #7

赞同：1

时间：2018-03-06T10:56:59.233

像提到的其他答案一样，编写批处理/cmd 文件可以创造奇迹。  

```
@echo off

echo Press any key to start the Services
echo ===================================

pause

echo Starting Apache
net start Apache

echo Starting MySQL
net start MySQL

echo Starting Subversion
net start Subversion

echo == Services have started ==

timeout 3
exit /b 
```

            回答 #8

赞同：0

时间：2009-02-17T13:40:28.983

更简单的方法：

1.  安装 ps 工具（它为开发人员提供了很多非常酷的命令行工具）

2.  ps工具自带的工具之一是  [PsService](http://technet.microsoft.com/en-us/sysinternals/bb897542.aspx)

3.  您可以使用 start 和 stop 开始停止您的服务

            回答 #9

赞同：0

时间：2015-09-29T09:08:39.883

虽然我迟到了，但这正是你所需要的。
[ProgramUtilityv1](https://github.com/bluelurker/utilities/tree/master/ProgramUtilityv1)
我也在找这样的应用程序，所以我自己写的。它只适用于 Windows，也适用于 Windows Vista 及更高版本。我很快也会发布一个 linux 版本。

        c# - 通过 Windows Live Messenger 跟踪消息

ID：556806

赞同：1

时间：2009-02-17T13:36:19.993

标签：c#, .net, windows-live-messenger

我想跟踪通过 Windows Live Messenger 发送和接收的消息。然后我想将这些消息整理到一个数据库中（不在这个问题的范围内）。

问题是我应该如何以及在哪里跟踪这些消息。强制所有客户保留历史文件并阅读这些文件的最简单方法，但这并不是我真正想要的解决方案。有没有办法从运行在同一域中的服务器跟踪它们，我读过一点 Windows Communicator，我也看到很多人谈论[http://dev.live.com/messenger/](http://dev.live.com/messenger/)但我是希望有人可能已经解决了这个问题:)

我想使用 C# .NET 3.5 来做到这一点

            回答 #1

赞同：2

时间：2009-02-17T15:06:59.137

查看 MSNPSharp。它是一个 .NET msn 库。它非常强大，允许您从多个位置登录。因此，您可以登录并收听给定帐户上发生的其他对话。它使用起来非常简单。下载完整的源代码，有一个示例应用程序详细演示了它的使用。

[http://code.google.com/p/msnp-sharp/](http://code.google.com/p/msnp-sharp/)

            回答 #2

赞同：1

时间：2009-02-17T13:50:27.073

这是两个可能有效的想法。

第一个是最简单的，但如果用户不想被登录，则可以轻松避免。这将是在 MSN 上使用[MSN Plus](http://www.msgplus.net/)。使用 MSN Plus，您有一个 API，可以让您从任何聊天窗口获取所有消息......等等。当然，如果用户不是你，用户可以简单地卸载 Msn Plus，你的程序不会记录任何数据。

如果您有一个需要检查所有 Msn Conversation 的网络，则第二个想法会更好。如果您使用[WireShark](http://www.wireshark.org/)，您可以看到对话没有加密（我上次这样做的时候），您可以检查端口和协议以简单地从网络获取数据。

希望它可以为您提供所需的方法。

            回答 #3

赞同：0

时间：2009-02-17T13:44:19.460

只有两个想法

 1\. 首先，标准的 MSN 协议是纯文本（据我了解），因此您可以在防火墙上拦截消息，然后将它们放入数据库并在那里进行关联。

 2\. 如果这是在一个组织中，您可以使用 Office Communicator，它是 MSN 的“企业”版本，并且已经内置了该功能。然后，您可以通过他们的 SDK 进入并获取相关数据。

            回答 #4

赞同：0

时间：2009-09-29T09:31:48.687

我设法找到了两种方法来做到这一点，虽然两者都不是真正的程序化解决方案，所以可能不会吸引这些观众。

1.  使用 Jabber 网关在您的 Jabber 客户端和其他 IM 网络之间设置转发。通过 jabber 服务器在启用了 jabber 的客户端和 jabber 服务器之间流动。然后，Jabber 服务器将其转换为目标网络协议并转发消息。同样，来自外部 IM 网络的消息由 Jabber 服务器路由和翻译。一个例子是 PSI <-> IceWarp Merak <-> MSN

2.  使用[Symantec IM Manager](http://www.symantec.com/business/im-manager)拦截来自网络上消息传递客户端的消息。您将需要使用主机文件或本地 DNS 规则来使您的本地 PC 相信 Messenger.hotmail.com 实际上位于 192.168.0.59 而不是 Microsoft。

希望它可以帮助其他可能想做同样事情的人。

        java - 是否存在 Java 到 C++ 转换器/工具？

ID：556807

赞同：58

时间：2009-02-17T13:36:30.477

标签：java, c++, code-translation

我总是问自己是否可以制作 Java 到 C++ 的转换器。

也许是一个将 Java 语法转换为 C++ 语法的工具？

我知道语言不同，但简单的事情，比如语义匹配 1 到 1 的循环。

有这样的工具吗？或者有可能制作一个吗？

            回答 #1

赞同：28

时间：2009-02-17T13:44:15.497

只要有足够的时间、金钱和资源，任何事情都是可能的。实用吗？除了琐碎的例子之外，不是真的。或者更确切地说，它取决于什么构成可接受的错误率。

真正的问题是 Java 和 C++ 中的习语不同。例如，Java 到 C# 实际上会容易得多（因为习语更相似）。最大的当然是 C++ 有析构函数和手动管理的内存。Java 使用 finally 块来处理这种行为并具有垃圾收集功能。

Java 也有一个通用的 Object 超类型。C++ 没有。

我想象的模板的泛型几乎是不可能的。

            回答 #2

赞同：17

时间：2012-06-23T15:56:43.260

[Firefox HTML5 解析器是用 Java 编写并转换为 C++](http://ejohn.org/blog/html-5-parsing/)的。但我认为那里使用的转换器非常适合这个项目。有趣的是，结果表明生成的 C++ 解析器比用 C++ 编写的旧解析器更快。

我还在src/tools/org/h2/java 下编写一个转换器作为[H2 数据库的一部分。](http://h2database.com/)这个想法是允许将 H2 数据库的子集转换为 C++，因此这也不是通用翻译器。

还有开源项目[J2C](https://bitbucket.org/arnetheduck/j2c)。

所以有一些方法可以将 Java 转换为 C++。但是不要期望翻译器支持所有功能，也不要期望生成的代码比好的 Java JVM 更快。

            回答 #3

赞同：7

时间：2009-02-17T13:40:29.437

是可能的，毫无疑问，但不会那么简单。这将是一个生成 C++ 的 Java 编译器。

如果您想从头开始，那将非常困难，您必须完成 javac 和 JVM 为您完成的所有工作（例如垃圾收集）。

顺便提一句。Google 有一个 Java 到 JavaScript 的编译器（包含在[GWT](http://code.google.com/webtoolkit/)中）

            回答 #4

赞同：7

时间：2012-02-03T02:05:10.773

有一个，我不确定它是否真的有效。
[Java 到 C++ 转换器-有形软件解决方案](http://tangiblesoftwaresolutions.com/Product_Details/Java_to_CPlusPlus_Converter_Details.html)。

奇怪的是如何有 c++ 到 java 转换器，但只有 1 个 java 到 c++ 转换器。

            回答 #5

赞同：3

时间：2009-02-17T17:07:33.683

如前所述，将 Java 转换为 C++ 会很困难，但我们可以有一个应用程序或工具来生成 Java 代码和等效的 C++ 代码。

我知道一个在 C++/Java/C# 中生成代码的应用程序给定一个模型，该模型有自己的定义方式。

该工具属于 CA，名称为 CA Plex。在 www.ca.com 上搜索

            回答 #6

赞同：2

时间：2009-02-17T13:40:24.773

[http://www.tangiblesoftwaresolutions.com/Order/Order_Upgrade_Instant_CPlus_Java_Edition.htm](http://www.tangiblesoftwaresolutions.com/Order/Order_Upgrade_Instant_CPlus_Java_Edition.htm)

取决于将使用代码的领域，从学习的角度来看，它可能会很有趣。

我刚刚通过谷歌找到了这个，因为我记得在大学里看到一个基于 uml 创建代码的。

            回答 #7

赞同：2

时间：2009-02-17T13:41:48.513

有一些程序声称他们可以做到这一点，但没有一个程序获得足够的人气以至于经常被提及，所以我们将把它们留给“尝试”。制作转换器需要在程序中内置大量 AI。因为 GTK/wxWidgets/Qt/win32 API 都与 swing 有很大的不同，所以当涉及到 swing 时，难度会增加十倍。但这是可能的。并不是说代码质量会很好，也不能保证你的程序不会因为单独的内存处理方法而崩溃，但这是可能的。

            回答 #8

赞同：2

时间：2010-03-17T17:50:32.757

一个简洁的工具将是一种工具，它将 java 转换为“使用 Java API 的 C++”（如 GNU GCJ CNI），剩下的一个问题是管理`array.length`（数组而不是向量）......

            回答 #9

赞同：2

时间：2011-05-12T13:31:59.677

主要问题是java是一种为与VM对话而编写和设计的语言。我想这是可能的，但你所剩下的只是一个优化得很差的应用程序，它有一个自我翻译层，做着虚拟机已经做的事情。我的意思是，当然，有可能，它仍然不是我能想到的任何事情的解决方案。如果你想让你的缓慢的 java 应用程序成为原生的，也许你想得太难了，只需使用 JET 之类的应用程序，它实际上非常好，并且会给你带来原生应用程序带来的好处。当然，如果虚拟机已经在做应用程序要求它做的事情，就像本机代码一样（它会发生......有时：P），它可能什么都不会改变。

Java 到 c# 听起来更合理，因为这两种语言都是以类似的方式编写的，并且与框架本身对话，但这仍然会使代码非常未优化，因为无法超越从头开始为特定框架编写的代码。

            回答 #10

赞同：2

时间：2012-01-07T22:00:32.350

Java 到 C 实际上是最简单的。请记住，您需要转换语言，如果您这样做，所需的库可以由您的新编译器转换。换句话说，Swing 和 AWT 应该不是什么大问题……

我首先要好好看看 Java Native Interface (JNI)。JNI 是 java 的一部分，允许它与 C 和 C++ 一起使用。我从这里开始的原因是，如何用 C 实现 Java 的各个部分变得相当明显。一旦我掌握了基本结构，例如 Java 对象如何映射到 C 结构（结构）以及在Java 是一个包含数组的对象，我可能会偷看 Open JDK 源代码。

实际的转换器必须转换所有导入的 Java 库（以及它们的导入库等等......），这意味着您需要所有内容的源代码。由于 Java 库很大，因此这种转换任务不小。

这个过程会很耗时，但不需要人工智能。但是，我认为没有理由执行这样的转换。它失去了Java的可移植性，并且不会获得C的效率（除了它会被编译成本机代码，但最好直接从Java编译机器代码）。

        database - 如何将数据表作为参数发送到数据库中的存储过程

ID：556813

赞同：0

时间：2009-02-17T13:37:56.713

标签：database, ado.net

基本上我想在网络服务器缓存上的“datatable1”上做一个内部连接到另一个存储在数据库中的“datatable2”。  

我有两种方法 1\. 我可以将“datatable2”带到网络服务器缓存并编写连接逻辑。然而，这将非常昂贵并且被排除在外。2\. 将“datatable1”发送到数据库并在那里进行内部连接并将结果返回到 Web 服务器。

所以我需要将此 datatable1 作为参数发送到存储过程。我想避免循环遍历这个表，因为这个表可能非常大。

            回答 #1

赞同：3

时间：2009-02-17T13:43:09.320

我认为您最好的选择是将第二个数据表查询到与原始数据表相同的数据集中，然后在数据集中加入。

检查接受的答案：

[http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/f122d7f4-3b7d-4d93-bd0f-8bb57cd990a4/](http://social.msdn.microsoft.com/Forums/en-US/adodotnetdataproviders/thread/f122d7f4-3b7d-4d93-bd0f-8bb57cd990a4/)

            回答 #2

赞同：0

时间：2009-02-17T13:46:48.937

一种方法可能是将您的数据表序列化为 xml 并使用 xml 参数。像加入表格一样加入 xml 文档非常容易。

            回答 #3

赞同：0

时间：2009-02-17T13:49:52.800

如果您使用的是 SQL Server 2005+，我会使用[OPENXML](http://msdn.microsoft.com/en-us/library/aa276847(SQL.80).aspx)。您使用文本或 xml 参数（使用 DataTable.WriteXml）将数据表传递给过程，让过程解析您的文档，然后您可以将其用作结果集以连接其他表。

        iphone - 更改 UISearchBar 文本字段的大小？

ID：556814

赞同：30

时间：2009-02-17T13:38:31.797

标签：iphone, search, uitableview

我有一个 UITableView，旁边有一个索引；我想向它添加一个 UISearchBar，但索引与“x”重叠以清除搜索。我在联系人应用程序中注意到，UISearchBar 中的文本字段已调整大小以适应这一点，但我不知道如何在我自己的应用程序中执行此操作。

我在 viewDidLoad 中尝试了以下操作，但它似乎不起作用。

```
UITextField * textField = (UITextField *)[[self.search subviews] objectAtIndex:0];
CGRect r = textField.frame;

[textField setFrame:CGRectMake(r.origin.x, r.origin.y, r.size.height, r.size.width-30)]; 
```

有任何想法吗？

            回答 #1

赞同：30

时间：2009-10-28T07:10:49.477

它比所有这些建议要容易得多。在界面生成器中，您可以放置​​一个视图，而不是将搜索栏作为表视图的标题。然后，在此视图中放置一个导航栏。抓住导航栏的左侧调整大小手柄并将其拉到右侧，直到 NB 仅 25 像素宽。清除 NB 中的 Title（双击选中，然后删除）。然后，将搜索栏添加到同一视图中。将其右侧调整大小手柄向左移动，调整使其紧靠 N B。就是这样。

如果需要，您也可以启用取消按钮，它也不会与索引重叠（保留在搜索栏中）。

显然，表格视图的标题中只能有 1 个子视图，这就是为什么您需要首先放置视图，然后是 NB 和搜索栏。

更新：请参阅从 Apress 开始 iPhone 开发，p。SDK 3 版本的 241。您只需在搜索时禁用索引。

```
- (NSArray *)sectionIndexTitlesForTableView:(UITableView *)tableView {
    if (isSearching) {
        return nil;
    }
    return keys;
} 
```

他们还谈到在索引顶部添加放大镜。

到处都是好书。

            回答 #2

赞同：16

时间：2009-02-26T03:08:49.460

为什么不将实际的 UISearchBar 水平缩小，并在其右侧放置一个（空的） UINavigationBar 呢？它们将呈现完全相同的背景。

比破解可能改变的 Apple 对象的内部结构要好。

此外，在对 UISearchBar 的宽度进行动画处理时，您会注意到内部文本字段并未随之进行动画处理。您可以通过在更改其帧后在动画块中调用 UISearchBar 的“layoutSubviews”来解决此问题。（这就是它确定内部文本字段大小的地方）

            回答 #3

赞同：8

时间：2009-02-17T15:16:05.917

好的，我想出了一个解决方案。

1.  创建 UISearchBar 的子类
2.  将此代码包含在 drawRect: 方法中。

    ```
    UITextView * textField = [self.subviews objectAtIndex:0];
    textField.frame = CGRectMake(5, 6, (310 - kRightSideMargin), 31); 

    [super drawRect:rect]; 
    ```

注意：kRightSideMargin 是我在头文件中设置的常量；我把它设置为25。

感谢其他人的建议。

            回答 #4

赞同：6

时间：2009-09-17T01:50:33.640

正如Padraig 指出的那样，您所要做的就是将searchBar 子类化。创建您的 UISearchBar 子类，并将以下代码添加到`layoutSubviews`方法中：

```
- (void)layoutSubviews
{
    UITextField *searchField;

    for(int i = 0; i < [self.subviews count]; i++)
    {
        if([[self.subviews objectAtIndex:i] isKindOfClass:[UITextField class]])
        {
            searchField = [self.subviews objectAtIndex:i];
        }
    }

    if(!(searchField == nil))
    {
        searchField.frame = CGRectMake(4, 5, 285, 30); 
    }
} 
```

这将遍历所有子视图并根据 UITextField 类型检查它们。这样，如果它在它的子视图队列中移动，它仍然会抓住它。我发现 285 足够宽，不会与我的 tableView 的索引重叠。

            回答 #5

赞同：6

时间：2012-09-04T20:15:26.120

从 iOS 6 开始，导航栏解决方案对我来说效果不佳，因为现在 UISearchBar 和 UINavigationBar 之间的外观略有不同。因此，我通过继承 UISearchBar 切换到类似于 Padraig 的方法。

```
@interface SearchBarWithPad : UISearchBar
@end

@implementation SearchBarWithPad
- (void) layoutSubviews {

    [super layoutSubviews];
    NSInteger pad = 50;
    for (UIView *view in self.subviews) {
        if ([view isKindOfClass: [UITextField class]])
        view.frame = CGRectMake (view.frame.origin.x, view.frame.origin.y, view.frame.size.width - pad, view.frame.size.height);
    }   
}
@end 
```

编辑：啊，我还没有尝试过，但我认为您可以设置导航栏的 clipToBounds = YES 来关闭它的新阴影，从而在两个控件之间再次创建一致的外观。

            回答 #6

赞同：5

时间：2013-01-29T14:38:50.600

我正在使用ViewDeck[并](https://github.com/ViewDeck/ViewDeck)希望*在*.`leftController`

现在的问题是，如果我打开包含导航的左侧，右侧位与我的搜索字段重叠。

我通过过度写入摆脱了这一点`UISearchBar`，文本字段将始终具有相同的宽度，但在一种情况下，ViewDeck 重叠，在另一种情况下，我隐藏了 ViewDeck 位，然后取消按钮将占用空间：

子类化 UISearchBar

```
#import "ViewDeckSearchBar.h"
#define kViewDeckPadding 55

@interface ViewDeckSearchBar()
@property (readonly) UITextField *textField;
@end

@implementation ViewDeckSearchBar

static CGRect initialTextFieldFrame;

- (void) layoutSubviews {

    [super layoutSubviews];

    // Store the initial frame for the the text field
    static dispatch_once_t onceToken;
    dispatch_once(&onceToken, ^{
        initialTextFieldFrame = self.textField.frame;
    });

    [self updateTextFieldFrame];
}

-(void)updateTextFieldFrame{

    int width = initialTextFieldFrame.size.width - (kViewDeckPadding + 6);
    CGRect newFrame = CGRectMake (self.textField.frame.origin.x,
                                  self.textField.frame.origin.y,
                                  width,
                                  self.textField.frame.size.height);

    self.textField.frame = newFrame;
}

-(UITextField *)textField{
    for (UIView *view in self.subviews) {
        if ([view isKindOfClass: [UITextField class]]){
            return (UITextField *)view;
        }
    }

    return nil;
}

@end 
```

视图控制器类

在我的 Navigation 类中，我需要覆盖这两个`UISearchbarDelegate`方法才能使用搜索结果全屏显示：

```
- (void)searchBarTextDidBeginEditing:(UISearchBar *)searchBar{

    [self.viewDeckController setLeftSize:0];

    // I am also using scopes, which works fine (they fade out when not searching)
    self.searchBar.scopeButtonTitles = @[@"Food",
                                         @"Beverages",
                                         @"Misc"];
}

-(void)searchBarTextDidEndEditing:(UISearchBar *)searchBar{
    self.viewDeckController.leftSize = 55;
} 
```

结果

ViewDeck 显示在右侧：

[![一种](https://i.stack.imgur.com/Af1K1.png)](https://i.stack.imgur.com/Af1K1.png)

[（来源：[减号网](http://i5.minus.com/jA34MnXVqPZez.png)）]  

全屏搜索（按钮和范围按钮动画）。

[![一种](https://i.stack.imgur.com/7QJUB.png)](https://i.stack.imgur.com/7QJUB.png)

[（来源：[减号网](http://i2.minus.com/jjKEgXLur1kH6.png)）]  

            回答 #7

赞同：3

时间：2019-09-22T13:44:43.633

```
searchBar.layoutMargins = UIEdgeInsetsMake(0, 0, 0, rightPad); 
```

我更改 UITextField 框架的旧解决方案在 iOS 13 中停止工作。将 UINavigationBar 放在 UISearchBar 的右侧对我来说效果不佳，因为它们在顶部和底部的外观不同。

            回答 #8

赞同：2

时间：2011-01-06T14:18:37.900

很抱歉再次把这一切都拖了上来。

我希望 UISearchBar 更短，并且我正在使用 UISearchBarController，但实际上并不想要索引。这是因为我在右侧有一个叠加层：

![长搜索栏](https://i.stack.imgur.com/nod1U.png)

为此，我用一个空白项伪造了一个 sectionIndex，然后将其隐藏。我是这样做的：

```
 - (void)hideTableIndex {
    for (UIView *view in [tableView subviews]) {
        if ([view isKindOfClass:NSClassFromString(@"UITableViewIndex")]) {
            view.hidden = YES;
        }
    }
 }

 - (NSArray *)sectionIndexTitlesForTableView:(UITableView *)aTableView {
    if (aTableView == self.searchDisplayController.searchResultsTableView) {
        return nil;
    } else {
        [self performSelector:@selector(hideTableIndex) withObject:nil afterDelay:0];
        return [NSArray arrayWithObjects:@"", nil];
    }
 }

 - (NSInteger)tableView:(UITableView *)tableView sectionForSectionIndexTitle:(NSString *)title atIndex:(NSInteger)index {
    return 0;
 } 
```

这会缩短 UISearchBar 并隐藏索引，因此它不能被点击（否则一小部分会放在覆盖层的左侧，当点击时会将 UITableView 滚动到顶部）。像这样：

![替代文字](https://i.stack.imgur.com/4qRB2.png)

最重要的是，当您使用搜索时，您仍然会得到全宽栏：

![替代文字](https://i.stack.imgur.com/P9VRP.png)

            回答 #9

赞同：2

时间：2011-02-22T12:13:47.760

只需放置一个 UIView 并将搜索栏放在该 UIView 中。UIView 必须与 UISearchBar 大小相同。这对我有用。

            回答 #10

赞同：1

时间：2009-02-17T14:03:42.547

UISearchBar 中使用的文本字段是 UITextField 的子类，称为 UISearchBarTextField。

AFAIK，没有办法使用公共 API 调整 UISearchBarTextField 的大小，[私有 API](http://ericasadun.com/iPhoneDocs220/interface_u_i_search_bar_text_field.html)也没有透露太多信息。

如果有的话，也许你可以看看 UISearchBarTextField 的子视图。

**更新：**它没有。

**更新 2：**我认为你应该看看 UITextField 的 rightView 属性。下面的代码虽然不起作用，但似乎是一个很好的起点：

```
UIView *emptyView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 25, 25)];
[textField setRightView:emptyView];
[textField setRightViewMode:UITextFieldViewModeAlways];
[emptyView release]; 
```

            回答 #11

赞同：1

时间：2009-08-08T01:59:36.623

抱歉，Necroposting，但我找到了另一种在文本字段右侧留出一点空间的方法。我遇到了问题，我有一个带有搜索栏的索引表视图作为第一行。现在索引和搜索栏（在 IB 中制作，顺便说一句。）重叠了。它几乎尝试了所有方法，但都没有成功。似乎 textifield 的宽度和高度属性没有响应......所以我想出了这个：

```
searchBar.showsCancelButton = YES;

UIView *cButton = [searchBar.subviews objectAtIndex:2];

cButton.hidden = YES; 
```

我仍然无法调整空间的大小，但现在可以这样做......虽然......很奇怪的解决方案......

            回答 #12

赞同：1

时间：2009-12-13T09:39:54.977

每个人都提供了修改 UI 的方法。我发现了如何获得相同的结果。您必须提供以下两个实现：

1.  使用 UISearchDisplayController 更重要的是，确保使用以下命令对其进行初始化：

```
 - (id)initWithSearchBar:(UISearchBar *)searchBar contentsController:(UIViewController *)viewController 
```

未能设置有效的 UISearchBar（或传递 nil）将阻止为索引调整 UITextField。

2.  您必须通过实现返回一个有效的标题数组：

```
 - (NSArray *)sectionIndexTitlesForTableView:(UITableView *)tableView; 
```

如果返回 nil，则不会显示索引，并且 UITextField 将无法正确调整。

我已经向 Apple 提交了一份错误报告，表明只需要 #2 而不是 #1 似乎是合乎逻辑的。我在人机界面指南 (iPhone HIG) 中没有发现任何需要使用 UISearchDisplayController 的内容。

            回答 #13

赞同：1

时间：2010-05-20T02:47:50.493

关键是在使用 Interface Builder 时使用“搜索栏和搜索显示控制器”而不是“搜索栏”。

            回答 #14

赞同：0

时间：2009-02-17T14:21:56.093

它看起来好像 Apple 调整了视图的大小（请注意，索引在屏幕外向右移动），使其比屏幕大。

我想你需要实现的`searchBarTextDidBeginEditing:`方法`UISearchBarDelegate`来在适当的时候触发它。然而，这确实感觉有点hacky，也许有更好的方法。

            回答 #15

赞同：0

时间：2009-06-16T18:34:06.537

另一种方法（虽然乏味）是调整搜索栏的大小并用导航栏填补“空白”。为我工作。

            回答 #16

赞同：0

时间：2009-06-17T21:08:00.557

我想出的也好不了多少。基本上，我使用要用于搜索栏的框架创建一个空视图。然后我创建了一个 UIToolbar 放在搜索栏后面。一定要把它的frame设置成和UIView一样的frame，*只是*Y值必须是-1；否则，您将在顶部绘制两个边框。接下来创建您的 UISearchBar，但将框架的宽度设置为小于 UIView 的 30（或对您的应用有意义的任何值）。将它们添加为子视图并将您的 UIView 设置为 tableHeaderView。

            回答 #17

赞同：0

时间：2009-11-23T17:29:50.627

我按照 Mike 的建议制作了一个 UIView，然后在其中放置了一个 Navigation Bar 和 UISearch Bar。唯一的问题是第一次显示搜索栏的背景通常与导航栏相同吗？

有趣的是，如果我激活搜索，然后点击取消这个'固定'的背景！？

我使用的是 SDK 3.0，所以我删除了当我将 UISearchDisplayController 拖入我的 NIB 时创建的 UISearchBar 项目，然后按上述方式制作视图并将其连接到文件所有者和搜索显示控制器中的 searchBar 出口。

            回答 #18

赞同：0

时间：2010-05-05T18:57:18.693

它工作正常！

`[searchBar setContentInset:UIEdgeInsetsMake(5, 0, 5, 35)];`

        php - 如何使用 $_SERVER['REQUEST_URI']

ID：556818

赞同：10

时间：2009-02-17T13:39:47.737

标签：php

打字有什么区别：

```
<?php echo $_SERVER[REQUEST_URI] ?> 
```

或者

```
<?php echo $_SERVER['REQUEST_URI'] ?> 
```

或者

```
<?php echo $_SERVER["REQUEST_URI"] ?> 
```

?
他们都工作......我使用第一个。也许一个比另一个快？

            回答 #1

赞同：20

时间：2009-02-17T13:42:06.937

**如果没有引号，PHP 将 解释`REQUEST_URI`为常量**，但如果没有这样的常量，则更正您的拼写错误并将其解释为字符串。

当[`error_reporting`](http://docs.php.net/manual/en/errorfunc.configuration.php#ini.error-reporting)include时[`E_NOTICE`](http://docs.php.net/manual/en/errorfunc.constants.php)，您可能会收到如下错误：

注意：使用未定义的常量 REQUEST_URI - 在*<文件路径>*行*<行号>中假定为“REQUEST_URI”*

但是如果有一个具有此名称的常量，PHP 将使用该常量的值。（另请参阅[数组的注意事项](http://docs.php.net/manual/en/language.types.array.php#language.types.array.donts)）

**因此，当您指的是字符串时，请始终使用引号。**否则，它可能会产生不必要的副作用。

关于单引号和双引号字符串的区别，请参见[PHP 手册关于字符串](http://docs.php.net/manual/en/language.types.string.php)。

            回答 #2

赞同：3

时间：2009-02-17T13:42:16.173

第一个是错误的——你实际上是在寻找一个`REQUEST_URI`不存在的常数。这将生成通知级别的警告。

其他两个没什么区别。

            回答 #3

赞同：3

时间：2009-02-17T14:06:07.410

PHP 字符串处理中的单引号和双引号是有区别的。用双引号括起来的字符串将被评估为嵌入变量和转义字符（例如 \n）；用单引号括起来的字符串不会（或没有那么多）。

所以，例如，

```
$hello = "world";

echo "Hello $hello!\n";
echo 'Hello $hello!\n';
echo 'Done'; 
```

将输出

你好世界！
你好 $你好！\n完成

在没有转义字符或嵌入变量的情况下，使用单引号稍微更有效，因为它需要运行时对字符串的处理更少。然而，许多人（包括我）更喜欢对所有字符串使用双引号来避免混淆。

            回答 #4

赞同：1

时间：2009-02-17T14:06:04.413

作为对 Gumbo 答案的警告，第三种表示形式 - 双引号 - 实际上使 PHP 在该字符串中查找变量。因此，该方法可能会慢一些（尽管在 11 个字符的字符串中它可以忽略不计 - 但是最好不要让 PHP 这样做）。

            回答 #5

赞同：1

时间：2009-02-17T14:46:54.753

当 PHP 遇到用作数组键的纯字符串时，它会检查是否存在具有该名称的常量，如果没有，则默认将其返回为数组键。因此，不使用引号会导致轻微的性能下降，并且结果可能不是您所期望的。

            回答 #6

赞同：-1

时间：2009-02-17T14:15:53.737

```
$_SERVER[REQUEST_URI] 
```

语法不正确，AFAIK 不会在 PHP5 的默认安装上运行。数组索引是一个字符串，因此需要在字符串上传递。我知道 PHP4 将未定义的常量转换为方括号内的字符串，但这仍然不是一个好习惯。

编辑：除非您定义一个名为 REQUEST_URI 的常量，否则您的示例脚本中没有该常量。

```
$_SERVER['REQUEST_URI'] 
```

是标准方法，你应该使用什么。

```
$_SERVER["REQUEST_URI"] 
```

也可以工作，虽然没有错，但 PHP 解释器的工作量稍大一些，因此除非您需要解析它以获取变量，否则不应使用。（如果你需要这样做，你需要重新考虑你程序的那一部分。

        linux - Bash 脚本不会继续读取下一行文件

ID：556820

赞同：4

时间：2009-02-17T13:39:52.637

标签：linux, bash, shell, command-line, scripting

我有一个 shell 脚本，它将执行的命令的输出保存到 CSV 文件中。它从以下格式的 shell 脚本中读取它必须执行的命令：

```
ffmpeg -i /home/test/videos/avi/418kb.avi /home/test/videos/done/418kb.flv
ffmpeg -i /home/test/videos/avi/1253kb.avi /home/test/videos/done/1253kb.flv
ffmpeg -i /home/test/videos/avi/2093kb.avi /home/test/videos/done/2093kb.flv 
```

可以看到每一行都是一个 ffmpeg 命令。但是，脚本只执行第一行。就在一分钟前，它正在执行几乎所有的命令。由于某种原因，它丢失了一半。我编辑了包含命令的文本文件，现在它只会执行第一行。这是我的 bash 脚本：

```
#!/bin/bash
# Shell script utility to read a file line line.
# Once line is read it will run processLine() function

#Function processLine
processLine(){
line="$@"

START=$(date +%s.%N)

eval $line > /dev/null 2>&1 

END=$(date +%s.%N)
DIFF=$(echo "$END - $START" | bc)

echo "$line, $START, $END, $DIFF" >> file.csv 2>&1
echo "It took $DIFF seconds"
echo $line
}

# Store file name
FILE=""

# get file name as command line argument
# Else read it from standard input device
if [ "$1" == "" ]; then
   FILE="/dev/stdin"
else
   FILE="$1"
   # make sure file exist and readable
   if [ ! -f $FILE ]; then
    echo "$FILE : does not exists"
    exit 1
   elif [ ! -r $FILE ]; then
    echo "$FILE: can not read"
    exit 2
   fi
fi
# read $FILE using the file descriptors

# Set loop separator to end of line
BAKIFS=$IFS
IFS=$(echo -en "\n\b")
exec 3<&0
exec 0<$FILE
while read line
do
    # use $line variable to process line in processLine() function
    processLine $line
done
exec 0<&3

# restore $IFS which was used to determine what the field separators are
BAKIFS=$ORIGIFS
exit 0 
```

感谢您的任何帮助。

更新 2

它的 ffmpeg 命令而不是不起作用的 shell 脚本。但正如保罗指出的那样，我应该只使用“\b”。我也在使用 Johannes 的较短脚本。

            回答 #1

赞同：4

时间：2009-02-17T13:52:10.237

我认为应该这样做并且似乎是正确的：

```
#!/bin/bash

CSVFILE=/tmp/file.csv

cat "$@" | while read line; do
    echo "Executing '$line'"
    START=$(date +%s)
    eval $line &> /dev/null
    END=$(date +%s)
    let DIFF=$END-$START

    echo "$line, $START, $END, $DIFF" >> "$CSVFILE"
    echo "It took ${DIFF}s"
done 
```

不？

            回答 #2

赞同：4

时间：2011-11-30T23:52:01.990

ffmpeg 读取 STDIN 并耗尽它。解决方案是使用以下命令调用 ffmpeg：

```
 ffmpeg </dev/null ... 
```

请参阅此处的详细说明：http: [//mywiki.wooledge.org/BashFAQ/089](http://mywiki.wooledge.org/BashFAQ/089)
更新：
由于 ffmpeg 1.0 版本，还有这个`-nostdin`选项，所以可以用这个代替：

```
 ffmpeg -nostdin ... 
```

            回答 #3

赞同：2

时间：2009-12-26T01:00:15.020

我只是有同样的问题。

我相信 ffmpeg 应对这种行为负责。

我对这个问题的解决方案：

1) 在您的 ffmpeg 命令行末尾使用“&”调用 ffmpeg

2) 由于现在脚本不会等到 ffmpeg 进程完成，我们必须阻止我们的脚本启动多个 ffmpeg 进程。我们通过在至少有一个正在运行的 ffmpeg 进程时延迟循环通过来实现这一目标。

```
#!/bin/bash

cat FileList.txt |
while read VideoFile; do
    <place your ffmpeg command line here> &
    FFMPEGStillRunning="true"
    while [ "$FFMPEGStillRunning" = "true" ]; do
        Process=$(ps -C ffmpeg | grep -o -e "ffmpeg" )
        if [ -n "$Process" ]; then
            FFMPEGStillRunning="true"
        else
            FFMPEGStillRunning="false"
        fi 
        sleep 2s
    done
done 
```

            回答 #4

赞同：1

时间：2009-02-17T14:02:38.090

我会在 eval 之前和之后添加回声，以查看将要评估的内容（以防将整个文件视为一条大长线）和之后（以防 ffmpeg 命令之一永远占用）。

            回答 #5

赞同：1

时间：2009-02-17T14:37:38.910

除非您打算在循环之后从标准输入中读取某些内容，否则您不需要保留和恢复原始标准输入（尽管很高兴看到您知道如何操作）。

同样，我根本看不出与 IFS 共进晚餐的理由。当然没有必要在退出前恢复 IFS 的值——这是您正在使用的真实 shell，而不是 DOS BAT 文件。

当你这样做时：

```
read var1 var2 var3 
```

shell 将第一个字段分配给`$var1`，将第二个字段分配给`$var2`，并将该行的其余部分分配给`$var3`。在只有一个变量的情况下——例如你的脚本——整行进入变量，就像你想要的那样。

在 process line 函数中，您可能不想丢弃已执行命令的错误输出。您可能确实想考虑检查命令的退出状态。错误重定向是......不寻常的`echo`，而且矫枉过正。如果您充分确定命令不会失败，请继续忽略错误。命令是否“健谈”；如果是这样，请务必丢弃聊天。如果没有，也许您也不需要丢弃标准输出。

当给它处理多个文件时，脚本作为一个整体可能应该进行诊断，因为它忽略了无关的文件。

你可以通过使用来简化你的文件处理：

```
cat "$@" |
while read line
do
    processline "$line"
done 
```

该`cat`命令会自动报告错误（并在错误之后继续）并处理所有输入文件，或者如果没有剩余参数则读取标准输入。在变量周围使用双引号意味着它作为单个单元传递（因此未解析为单独的单词）。

*`date`和的使用`bc`很有趣——我以前没见过。*

总而言之，我会看类似的东西：

```
#!/bin/bash
# Time execution of commands read from a file, line by line.
# Log commands and times to CSV logfile "file.csv"

processLine(){
    START=$(date +%s.%N)
    eval "$@" > /dev/null
    STATUS=$?
    END=$(date +%s.%N)
    DIFF=$(echo "$END - $START" | bc)
    echo "$line, $START, $END, $DIFF, $STATUS" >> file.csv
    echo "${DIFF}s: $STATUS: $line"
}

cat "$@" |
while read line
do
    processLine "$line"
done 
```

        database - 非常小的表上的主键

ID：556821

赞同：2

时间：2009-02-17T13:39:52.933

标签：database, indexing, primary-key

我有一个非常小的表格，最多有 5 条记录，其中包含一些标签。我正在使用 Postgres。

结构如下：

id - smallint 标签 - varchar(100)

该表将主要用于引用其他表中的行。问题是是否真的有必要在 id 上有一个主键，或者在 id 上只有一个索引，或者两者都有？

我确实阅读了有关索引和主键的信息，并且我知道这在很大程度上取决于表的用途：

[没有主键的表](https://stackoverflow.com/questions/5600/tables-with-no-primary-key)

**编辑：**我想问一下是否有主键或索引，或者两者都有。我编辑了这个问题。

            回答 #1

赞同：4

时间：2009-02-17T13:42:33.737

拥有主键列始终是一种好习惯。需要它的典型场景是当您想要更新或删除一行时，拥有一个 PK 会使它变得更容易和更安全。

            回答 #2

赞同：2

时间：2009-02-17T13:56:11.070

是的，主键不仅是一种好的做法——它是至关重要的。缺少唯一键的表无法采用[第一范式](http://en.wikipedia.org/wiki/First_normal_form)。

如果您希望其他表使用外键引用该表，则必须声明 PRIMARY KEY 或 UNIQUE 约束。

在大多数 RDBMS 品牌中，PRIMARY KEY 和 UNIQUE 约束都隐式地在列上创建索引。如果它没有隐式执行此操作，则可能需要您自己定义索引，然后才能声明约束。

            回答 #3

赞同：1

时间：2009-02-17T13:43:36.730

是的，您将需要 id 字段上的主键，因为您不希望两个标签共享相同的 id。

您还需要一个索引，以加快此表中的搜索/查找过程（尽管对于小型表，性能增益较小）。该序列只会帮助您填写下一个ID；它不会阻止您将以前的值更改为已经存在的值。

            回答 #4

赞同：0

时间：2009-02-17T14:12:26.083

创建索引而不是主键的原因很少。正如比尔卡尔文所说，你根本不会节省资源。而且，正如您可能已经猜到的那样，如果您有主键，则根本不需要创建新索引。

在某些情况下，可能很难找到关键候选人。但这似乎并非如此，它显然违背了一些良好的做法。

顺便一提。由于您的表很小，即使有索引，大多数查询也宁愿使用全表扫描。不用担心您会看到全表扫描。

            回答 #5

赞同：0

时间：2009-02-17T14:13:11.980

从开发者的角度来看，`PRIMARY KEY`只是组合`NOT NULL`和`UNIQUE INDEX`上列之一。

A`UNIQUE INDEX`是**好的**，如果：

1.  您需要强制执行唯一性。使用索引是最有效的方法。

    *   您需要执行 a `SELECT`，`UPDATE`或`DELETE`使用对索引字段有*选择性*`WHERE`的条件，即受查询影响的行数远少于总行数（例如，行数）。*`10``2,000,000`*
     *A`UNIQUE INDEX`是**坏的**，如果：

1.  当然，您不需要此字段的唯一性:) 但是您最好在表中拥有一个唯一索引，以便每条记录都可以识别。

    *   你需要快`INSERTS`

    *   您需要快速`UPDATE`'s 和`DELETE`'s 的索引值，其`WHERE`条件对索引字段*没有选择性*，即受查询影响的行数与总行数（例如，`1,500,000`行数`2,000,000`）相当。

鉴于您将有一张小桌子，我建议您在`PRIMARY KEY`上面创建一个。

# windows - 从批处理脚本读取参数的问题

> ID：556827
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-17T13:40:40.840
> 
>         
> 
> 标签：windows, batch-file, scripting, path, filenames

在 Windows 上，我正在尝试使用 %~f1 参数获取文件名。

我正在通过添加到上下文菜单中的新声音（命令）来执行此操作。

在 Windows 注册表中，语音只是调用一个打印文件名的批处理脚本，通过这种方式：

```
`C:\script.bat %~f1` 
```

但我得到这个输出：

```
`C:\Documents and Settings\Administrator\Desktop\%~f1` 
```

所以，路径没问题，但是文件名呢？！

建议？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T13:59:42.307

当它触发上下文菜单项时，它是由资源管理器（不是 cmd.exe）完成的，资源管理器没有实现 %~f1。因此，您得到当前结果。

您需要修改您的脚本，以便它接收整个文件名（您可能只在注册表中放置 'C:\script.bat %1' 或 'C:\script.bat'）并更新您的脚本以使用 % 〜f1：

```
@echo first argument: %1
@echo filename only: %~f1
@notepad %~f1 
```

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T13:52:02.093

尝试将整个变量包含在 %'s 中。

`C:\script.bat %~f1%`

# vb.net - 在 VB.NET 中显示一个向下的三角形 ▼ (U+25BC)

> ID：556835
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-17T13:42:28.077
> 
>         
> 
> 标签：vb.net, winforms, unicode, character-encoding, escaping

嘿，我想弄清楚如何在 .NET winform 应用程序中正确显示 ▼ 字符。

我正在创建一个自定义控件，对于按钮，我希望这个角色出现。我可以将文本设置为这个字符，但它显示为一个空白方块。  

关于我需要做什么才能使这个角色正确出现在我的表单上的任何想法？

我正在使用与此符号兼容的 Arial 字体。

**编辑**：目前设置如下：

```
btnCalendarToggle.Text = "▼"  'Yes, it appears exactly like this in my code 
```

有关该字符的更多信息，请参见此处：
 [http ://www.fileformat.info/info/unicode/char/25bc/index.htm](http://www.fileformat.info/info/unicode/char/25bc/index.htm)

**EDIT2**：我尝试添加一些其他 Unicode 字符，并收到以下消息：

> “此文件中的某些 Unicode 字符无法保存在当前代码页中。您想将此文件重新保存为 Unicode 以维护您的数据吗？”

在此消息上单击“是”后，它仍然不起作用。看来文件的编码方法可能是错误的......我不知道将其设置为什么。有没有其他人尝试过在winform中显示这个角色？

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-02-17T13:51:48.800

如果在源文件中嵌入更复杂的 unicode 字符，通常会出现问题（源代码控制系统和差异工具）。

通常最好通过显式转义序列来实现，并将源文件保持在更简单的编码中。

```
btnCalendarToggle.Text = "\u25BC"; 
```

如果这可行，则问题可能出在源文件的编码设置上。

但是，您确定有问题的字体是 Arial（尝试调试和检查），因为无论上述问题如何，只要将编码设置为合法的 Unicode 编码（如果您嵌入此类，Visual Studio 将为您转换文件）其中的一个字符）这应该有效。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T13:44:05.043

您可以发布您当前使用的代码吗？

如果您知道字符代码，则可以使用 chr(int) 函数打印出字符。

```
Dim i As Integer
For i = 0 To 255
    txtTest.Text = txtTest.Text & Chr(i) & " -- " & i.ToString() & Environment.NewLine
Next i 
```

试试看你的角色是否打印出来。

# c++ - 映射复杂的查找操作

> ID：556838
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-17T13:43:12.130
> 
>         
> 
> 标签：c++, stl, boost, map, find

我想做以下事情：

在字符串和任何类型的对象（可能是列表、整数 - 任何东西）之间定义映射。

映射的键可以如下（同样，这些值并不重要）：

“AAA/123”==> 1 

“AAA/ *”==>2 

“BBB/* ”==>3 

“CCC/*” ==> 4 

"CCC/123" ==> 5

现在，诀窍是我想在给定以下字符串的情况下找到正确的值：

“AAA/123”应该给出 1。

“AAA/111”应该给出 2。

“CCC /111" 应为 4。

"CCC/123" 应为 5。

"BBB/AAA/123" 应为 3。  

知道我如何使用 C++ 和可能的 STL/boost 来做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-17T15:37:32.683

这是 litb 答案的变体（以某种方式从答案列表中删除），考虑到“*”被删除，它可能会起作用：  

```
template<typename Map> typename Map::const_iterator
find_prefix(Map const& map, typename Map::key_type const& key)
{
    typename Map::const_iterator it = map.upper_bound(key);
    while (it != map.begin())
    {
        --it;
        if(key.substr(0, it->first.size()) == it->first)
            return it;
    }

    return map.end(); // map contains no prefix
} 
```

我忘了添加使用它的代码：

```
std::map<std::string, int> smap;
smap["AAA/"] = 1;
smap["BBB/"] = 2;
smap["AAA/AA"] = 3;

find_prefix(smap, "AAA/AB")->second; // ==> 1
find_prefix(smap, "AAA/AA")->second; // ==> 3
find_prefix(smap, "BBB/AB")->second; // ==> 2
find_prefix(smap, "CCC/AB"); // ==> smap.end() 
```

有什么评论（感谢 litb）？

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T15:40:57.993

根据您的要求，您似乎并不真正想要地图数据结构，但可以设置或非常简单。

我认为像这样的结构 std::map 可能会对你有所帮助。Boost::any 将能够存储任何内容，但需要注意的是您需要知道值类型是读取它。

键是字符串，因此它也可以是正则表达式。使用这种结构，您将需要两遍算法：

```
std::map<std::string, boost::any> _map;
if (_map.find(key) != _map.end)
{
   // exact match
}
else
{
   // Have to do sequential regex (use boost::regex) matching
} 
```

由于运行时的正则表达式评估可能代价高昂，您可以使用 std::vector>，这样对于正则表达式模式，您可以将已编译的正则表达式存储到其中一个字段中。

提供更多您想要完成的背景可能会很有用，因为它可能有助于确定正确的数据结构和搜索算法。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T15:42:17.443

使用两张地图怎么样？

```
std::map<std::string, std::map<int, object> > 
```

如果你想查找 aaa/* 你做

```
a.find("aaa") => you get an iterator to the map with all "aaa" prefix 
```

如果你想查找 aaa/123 你做

```
a.find("aaa")->find(123) 
```

（当然你必须验证你没有结束，这只是为了例子）

# reporting-services - SSRS 2005 - 如何找到单元格 1 列上方和 2 行上方的值？

> ID：556861
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-17T13:49:18.340
> 
>         
> 
> 标签：reporting-services, reportingservices-2005, offset

我正在尝试使用诸如 excels offset 之类的东西来查找单元格 1 列和 2 行的值

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2011-03-15T18:36:53.130

如果单元格具有使用以下名称的名称，则可以获取单元格的值

ReportItems!YourCellValueGoesHere.Value

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-03-28T13:29:54.377

你不能：没有可以使用的列或行集合。

此外，矩阵控制、分组和合并单元格会使这进一步复杂化

# java - 如何找到 com.sun.star.uno.RuntimeException 的真正原因？

> ID：556864
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-17T13:49:54.283
> 
>         
> 
> 标签：java, openoffice.org

我正在尝试使用 OpenOffice Java API替换[OpenOffice文档中的字段。](http://en.wikipedia.org/wiki/OpenOffice.org)我正在使用以下`insertString`方法：

```
 xText.insertString(((XTextField) fieldMaster).getAnchor(), value.toString(), false); 
```

堆栈跟踪如下：

```
 [junit] com.sun.star.uno.RuntimeException: 
    [junit]     at com.sun.star.lib.uno.environments.remote.Job.remoteUnoRequestRaisedException(Job.java:182)
    [junit]     at com.sun.star.lib.uno.environments.remote.Job.execute(Job.java:148)
    [junit]     at com.sun.star.lib.uno.environments.remote.JobQueue.enter(JobQueue.java:344)
    [junit]     at com.sun.star.lib.uno.environments.remote.JobQueue.enter(JobQueue.java:313)
    [junit]     at com.sun.star.lib.uno.environments.remote.JavaThreadPool.enter(JavaThreadPool.java:101)
    [junit]     at com.sun.star.lib.uno.bridges.java_remote.java_remote_bridge.sendRequest(java_remote_bridge.java:652)
    [junit]     at com.sun.star.lib.uno.bridges.java_remote.ProxyFactory$Handler.request(ProxyFactory.java:154)
    [junit]     at com.sun.star.lib.uno.bridges.java_remote.ProxyFactory$Handler.invoke(ProxyFactory.java:136)
    [junit]     at $Proxy14.insertString(Unknown Source)
... 
```

如果我正确解释这一点，它告诉我它连接到与 Java 不同的进程，其他进程中的某些东西失败了，但它并没有告诉我问题是什么。

我发现有一些环境变量（PROT_REMOTE ...）可以让我记录来自这些远程（不同进程，同一台计算机，顺便说一句）进程的消息，但前提是我运行启用了调试的 OpenOffice 版本？

我正在使用 Ubuntu 上的 deb 存储库中的 OpenOffice 版本，并且必须对编译我自己的 OpenOffice 版本感兴趣。

有什么方法可以从远程进程中获取一些有用的错误消息来帮助我理解我的代码失败的原因？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-24T06:53:49.887

我仍然没有找到一个好的方法来确定导致 RuntimeExceptions 的原因，但是 OpenOffice.org 论坛上的某个人解决了我的问题。我以错误的方式使用 API。

代替：

```
XTextDocument xTextDocument = (XTextDocument) UnoRuntime.queryInterface(XTextDocument.class,document);
XText xText = xTextDocument.getText();
xText.insertString(((XTextField) fieldMaster).getAnchor(), value.toString(), false); 
```

我应该使用锚点中的​​文本：

```
XTextRange anchor = ((XTextField) fieldMaster).getAnchor();
anchor.getText().insertString(anchor, value.toString(), true); 
```

显然，标题中的文本不是文档的一部分。如果您打开 OpenOffice 文件，这很有意义。标头存储在[ODF](http://en.wikipedia.org/wiki/OpenDocument)文件中的单独 XML 文档中...

# html - 如何在 VS 2008 中用 HTML 标记快速包围文本？

> ID：556865
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-17T13:49:58.680
> 
>         
> 
> 标签：html, visual-studio, visual-studio-2008, shortcuts

我正在使用 Visual Studio 2008 编辑器。有没有办法以一段文本为例，突出显示它并使用快捷方式快速添加标记？

例如，假设我有一个文本，我去了：`the store`我想加粗，我必须输入`<b>the store</b>`。有没有更快更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：32
> 
>             
> 
> 时间：2011-02-24T20:24:18.290

选择文本，`Ctrl`+ `X`，输入你的标签，这将被 vs 自动关闭，`Ctrl`+`V`

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T14:04:43.497

使用 HTML 编辑器只需按`Ctrl`+ `B`...

使用常规文本编辑器 VS 不提供内置功能，但您可以添加自定义宏。像下面这样的东西会为你工作。

```
Sub MakeSelectionBold()
    DTE.ActiveDocument.Selection.Text = "<b>" + DTE.ActiveDocument.Selection.Text + "</b>"
End Sub 
```

然后，您可以将其分配给快捷方式或将按钮添加到工具栏。

# reporting-services - 上报服务功能问题

> ID：556866
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-17T13:50:07.853
> 
>         
> 
> 标签：reporting-services

我有一个关于报告服务的报告页面。在布局选项卡中，我必须计算行数。我使用 rowcount(nothing) 函数来做到这一点，但这对我来说还不够。我必须调用一些函数来计算行数。我如何编写一个函数，我可以从哪里调用它？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-23T22:55:46.590

选择报告属性 | 代码

编写你的函数

，然后在表达式框中像这样调用它  

```
=code:  'your function name' 
```

# actionscript-3 - 使用 textField.htmlText 字体颜色的最佳方法

> ID：556875
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-17T13:51:36.773
> 
>         
> 
> 标签：actionscript-3, apache-flex, flex3

使用超过 1 种字体颜色的最佳方法是什么`textField.htmlText`？

我已经使用如下代码：

```
textField.htmlText = "blaa blaa" + "< u >"+w+"< /u >"+"blaa blaa" 
```

我怎样才能让它定义一个特定的颜色呢？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-17T14:00:03.383

使用[flash.text.StyleSheet](http://livedocs.adobe.com/flash/9.0/ActionScriptLangRefV3/flash/text/StyleSheet.html)

```
var style:StyleSheet = new StyleSheet();
var underline:Object = new Object();
underline.fontWeight = "bold";
underline.color = "#FF0000";
underline.display = "inline";

style.setStyle("u", underline);

textField.styleSheet = style;
textField.htmlText = "blaa blaa" + "< u >"+w+"< /u >"+"blaa blaa" 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-25T13:08:09.450

字体标签更容易

# makefile - 当有更改时，如何在调用子构建时检查依赖关系？

> ID：556876
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-02-17T13:51:37.803
> 
>         
> 
> 标签：makefile, multiple-makefiles

如果我有一个调用另一个 makefile 的 makefile，如何让主 makefile 正确检查从属 makefile 的依赖项是否已更改？

例如，如果我有规则

```
server:
     @cd $(SERVERDIR) && $(MAKE) 
```

这会在我构建可执行“服务器”的子目录中调用 make。但是，如果我更改了组成服务器的文件之一，则父 make 不会看到更改并拒绝重建服务器 - “make: `server' 是最新的。”

如何让主 makefile 正确检测其中一个依赖文件（例如 $(SERVERDIR)/server.c 之类的文件）何时发生更改？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-02-17T15:31:34.537

看起来您想使用虚假目标

```
.PHONY: server
server:
     @cd $(SERVERDIR) && $(MAKE) 
```

[这里](http://www.gnu.org/software/make/manual/make.html#index-g_t_002ePHONY-216)有 Phony 目标的详细描述，但简短的描述是你告诉 makefile 永远不会有与此服务器目标对应的文件，因此如果有目录中名为 server 的文件。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T14:46:55.160

您的目标名称与主目录中的文件或目录之一的名称相匹配`Makefile`。

假设您需要在名为 的子目录中构建所有内容`server`，则此规则：

```
server:
    $(MAKE) -C server 
```

将不起作用，因为目标`server`是一个目录，没有源文件并且不需要构建。

这个：

```
srv:
    $(MAKE) -C server 
```

只要没有名为`srv`.

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T16:06:49.927

你不：

*   [递归使被认为是有害的](http://miller.emu.id.au/pmiller/books/rmch/)

*   [实现非递归make](http://www.xs4all.nl/~evbergen/nonrecursive-make.html)

但是是的，如果您别无选择，例如因为您无法控制子生成文件，`.PHONY`那么您正在寻找目标。

# c++ - 如何在 Vista 和 Windows 7 上从我的应用程序启动屏幕键盘

> ID：556892
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-17T13:55:06.860
> 
>         
> 
> 标签：c++, qt, visual-c++, keyboard, uac

我有一个问题，我有一个应用程序，它有一个工具栏图标来启动系统屏幕键盘。除了 Windows Vista 和 Windows 7 beta 之外，这一切都可以正常工作。UAC 似乎妨碍了 osk.exe 运行。

我已经读过，因为它在登录屏幕上使用它不会提示用户进行身份验证。如果我关闭 UAC，它可以工作，但这不是一个选项，因为客户希望它开箱即用。

我能做些什么来解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-18T14:38:35.090

好的，结果更多的是关于细节。

我使用的是 Qt 的 QProcess::startDetached，我相信它使用了 Windows 上的 CreateProcess 函数调用。

我更改了代码以使用 ShellExecute() 函数调用，它就像一个魅力。

奇怪...

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T14:02:27.230

是否有可能尝试实现您自己的 OSK，以便它以与您的应用程序相同的权限运行？

# .net - 如何在 .Net Web 浏览器控件中显示 XML 文档？

> ID：556899
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-17T13:56:13.253
> 
>         
> 
> 标签：.net, wpf, xml, vb.net

我有一个 XML 文档和一个随附的 CSS 文件，其中包括页面格式样式（均从 Adob​​e Framemaker 导出）。我想使用 Windows 窗体或 WPF 在 Web 浏览器控件中导入这些数据并显示部分 XML 文档。我不清楚如何使所有这些一起工作。

任何建议都会有所帮助，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-17T14:28:34.470

我采用的方法是获得一个 xslt 翻译，它将原始 xml 格式化为浏览器的 html 编码内容。谷歌搜索“xml pretty print”会发现你准备好了一个 xslt 转换。

使用 XML 控件完成其余的工作。给它你的 xslt 文件和 xml，它会负责转换 xml。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2010-10-13T09:34:17.203

```
webBrowser1.NavigateToStream(parseXmlToHtml(report));

private Stream parseXmlToHtml(string xmlDocument)
{           
   XmlDocument dat = new XmlDocument();
   XslCompiledTransform xslt = new XslCompiledTransform();

   MemoryStream outputStream = new MemoryStream();
   XmlTextWriter writer = new XmlTextWriter (outputStream, System.Text.Encoding.ASCII);

   dat.LoadXml(xmlDocument);  // or dat.Load("c:\\dat.xml");
   xslt.Load("c:\\MonthlyLate.xslt");
   xslt.Transform(dat, writer);

   outputStream.Position = 0;

   return outputStream;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-06-18T23:02:02.497

要在内存中执行此操作，请将 Nir ​​示例的结尾更改为执行以下操作：

```
StringBuilder sb = new StringBuilder(2500);
XmlWriterSettings settings = new XmlWriterSettings();
XmlWriter dest = XmlWriter.Create(sb, settings);
xslt.Transform(source, dest);;
MessageBox.Show(sb.ToString()); 
```

* * *

## 回答 #4

> 赞同：-2
> 
>             
> 
> 时间：2009-02-18T09:23:57.483

您不能将 XML 与 CSS 一起使用，您只能将 CSS 与 HTML（或 XHTML）一起使用。

如果 XML 文件是 XHTML，则需要在 head 元素内添加对 CSS 的引用：

```
<link href="mycss.css" type="text/css" rel="stylesheet" /> 
```

如果 XML 文件不是 XHTML，则必须将其转换为 HTML（然后将链接添加到 css）。

正如 kareem 所说，您可以使用 google 找到合适的 XSLT 代码，这是我必须在 C# 中使用 XSLT 的一些代码：

```
XmlDocument source = new XmlDocument();
source.Load(xmlFilePath);
XslCompiledTransform xslt = new XslCompiledTransform();
xslt.Load(xsltFilePath));
XmlWriterSettings settings = new XmlWriterSettings();
XmlWriter dest = XmlWriter.Create(htmlFilePath, settings);
xslt.Transform(source, dest);
dest.Flush();
dest.Dispose(); 
```

您可以在 Web 浏览器控件中的“htmlFilePath”处打开文件。

# git - OSS项目后向不兼容变更如何公告？

> ID：556904
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-02-17T13:57:41.080
> 
>         
> 
> 标签：git, project-management, backwards-compatibility, incompatibility

有时，当改进远大于缺点时，您需要引入向后不兼容的更改。可以轻松切换到旧行为，但用户必须注意此类更改。

因此问题是：**如何宣布未来对 FLOSS（开源）项目的向后不兼容的更改**，以便用户可以为他们做好准备，或者改变他们的使用，或者配置程序使用旧的行为。

因为是OSS项目，被各个发行版独立打包，可以自动升级，无需用户干预。然后向后不兼容的更改可能会弄乱某人的工作流程（例如第三方脚本）。

目前考虑（和使用）的途径：

*   项目邮件列表

*   项目主页

*   发行说明（第一个警告，然后是公告）

*   维护者的博客

**编辑 1：**此（向后不兼容）更改将在某些*主要*版本中发生。

所有更改都是关于添加保护措施（拒绝可能彻底混淆新手用户的命令），或者将默认值更改为更合理的值。

**编辑 2：**在过渡期间，默认配置（意味着更改为默认拒绝/拒绝）更改为*warn*，并说明如何关闭警告，这也可以防止默认行为的向后不兼容更改。

但如果它是自动化系统，可能无济于事......

* * *

*有问题的项目是[Git](http://git-scm.com)，分布式版本控制系统；

请参阅在[gitster 的日志](http://gitster.livejournal.com)[中向用户提供早期警告](http://gitster.livejournal.com/28129.html)（Junio C Hamano 博客）*

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-02-17T14:01:06.283

*   更改版本号的专业

*   通过您可以使用的所有途径宣布它

*   在自述文件中添加突出的公告

*   如果需要数据库或其他更改，请添加在新旧之间转换的代码

*   添加检测使用过时方法、数据存储等的代码，并在执行破坏性更改之前提醒用户

*   在主要的 Q/A 网站上询问相关的常见问题解答类型的问题，这样当人们有疑问时，使用简单的搜索即可立即获得答案

但主要版本号是主要目标 - 人们预计 1.x 到 2.x 的转换会导致问题，并且在升级时更加小心。

-亚当

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T22:09:45.670

你有很好的答案来宣传这个词。但是迁移我自己的思维方式对我来说是最大的问题，特别是当我的肌肉记忆中已弃用的功能时。不学习比学习更难。

*当我实际使用将要更改的命令时，*收到有关即将发生不兼容的警告特别有用，尤其是在更改默认值的情况下。就像是：  

```
 $ git foo  
 Note: git foo currently defaults to HEAD. Starting with
 version 2.0, git foo will instead default to master. 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T14:17:32.140

我可以选择 RSS（如果存在）、Twitter（如果存在）、邮件列表（在更新即将结束时至少发送 3 次）、主页（使其对比鲜明，因此很容易看到）和博客，当然. 发行说明很少被阅读，所以把它作为最后一点信息。

（我将此作为第一个答案发布，但没有出现）

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T14:20:45.690

以上所有加号。

如果您有更改：

非破坏性命令的确切语法将更改为破坏性命令

我看不到任何选择，而是使更改*更具*破坏性以使旧命令完全无效，因此如果用户升级并尝试（或很可能是脚本尝试）旧样式命令，它会在 stderr 上以描述性错误消息终止。使用 stderr 对具有非破坏性的细微（或不那么细微）更改的命令发出警告消息也是一个好主意。破坏性的定义在源存储库上稍微复杂一些

对简单的弃用方法使用标准错误警告通常很好，但有些人会抱怨它破坏了他们的（写得不好的）脚本。在这些情况下，静默弃用发布（所有非侵入性形式的弃用），然后是口头（stderr 警告）发布，然后可能（见下文）发布无功能但当前的发布，然后是完全删除。最后一个非功能版本将在很大程度上依赖于所讨论的项目，因为它可能比它的价值更多，特别是对于那些表现良好并及时了解已弃用功能的用户。

由于您引用的具体更改是删除内置插件，这应该没问题我可能不会在非功能模式下使用内置插件完成一个版本，但我不太了解该项目，无法确定.

注意*代码*而不是脚本级别的更改，在许多现代语言中，可能会留下带有属性/注释的方法存根，这将完全隐藏它们对智能感知以及拒绝针对它们进行编译。这使得它们的存在（如果使用了一个简单的例外）比运行时 MissingMethodException 或其他什么更好地发现你不能使用它们。

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2009-02-17T14:02:06.233

只是我的 0.02 美元。现代开发环境（特别是 .NET）提供了向开发人员报告某些 API 已被声明为过时/弃用并将在未来版本中删除的方法。Microsoft C/C++ 编译器有[#pragma deprecated](http://msdn.microsoft.com/en-us/library/c8xdzzhh(VS.80).aspx)。

如果您的环境不支持这些，请依靠[版本控制](http://apr.apache.org/versioning.html)来提供兼容反馈。

# python - 如何在同一子域上获取不同的 Django 应用程序以共享会话 cookie？

> ID：556907
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-02-17T13:58:41.810
> 
>         
> 
> 标签：python, django, deployment, session, cookies

我们在同一个子域上部署了几个 Django 应用程序。一些高级用户需要在这些应用程序之间切换。我注意到每次他们在应用程序之间跳转时，他们的会话 cookie 都会从 Django 收到一个新的会话 ID。  

除了在一个复杂的工作流程中，我很少使用 Django 会话表。如果用户在此工作流程中在应用程序之间跳转，他们将失去会话并必须重新开始。

我挖掘了 Django 会话代码，发现：

> django.conf.settings.SECRET_KEY

用于对每个请求的会话执行完整性检查。如果完整性检查失败，则会创建一个新会话。意识到这一点，我将每个应用程序中的密钥更改为使用相同的值，认为这将允许完整性检查通过并允许它们共享 Django 会话。然而，它似乎并没有奏效。  

有没有办法做到这一点？我还缺少其他东西吗？

提前致谢

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-02-17T14:21:11.040

相反，我建议您为这两个应用程序设置`SESSION_COOKIE_NAME`不同*的*值。您的用户最初仍然需要登录两次，但他们的会话不会发生冲突 - 如果他们登录到应用程序 A，然后是应用程序 B，然后返回到 A，他们仍然会有他们的 A 会话。

在 Django 实例之间共享会话可能不是一个好主意。如果您想要某种单点登录，请查看 django-cas 之类的东西。您仍然会有 2 个会话（如您所愿），但用户只会登录一次。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-03-18T18:44:25.447

我同意在 Django 实例之间共享会话可能不是一个好主意。如果你真的想，你可以：

*   确保两个 django 应用程序共享相同的 SECRET_KEY

*   确保两个 django 应用程序共享相同的 SeSSON_COOKIE_NAME

*   确保将 SESSION_COOKIE_DOMAIN 设置为允许两个实例共享 cookie 的内容。（如果他们真的共享同一个子域，您当前的设置可能没问题。）

*   确保两个 Django 实例使用相同的会话后端（相同的数据库、相同的文件目录、相同的 memcached 配置等）

*   make sure that anything put into the session makes sense in both Django databases: at the very least, that'll include the user id, since Django auth uses that to remember which user is logged in.

All that said, I haven't actually tried all this, so you may still have trouble! 

# c# - 用 linq to xml 填充下拉列表的更好方法

> ID：556909
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-17T13:58:47.350
> 
>         
> 
> 标签：c#, linq, linq-to-xml

我有一堆下拉列表，我使用 linq 从 xml 文件中填充这些下拉列表。我尝试了以下方法来填充它们并且它以某种方式工作，唯一的问题是当一个元素丢失时，例如字幕，我在下拉列表中得到一个空白空间。此外，我没有得到每个下拉列表的不同值，而是所有值。请参阅下面的代码

```
 var feeds = (from item in doc.Descendants("item")

                     select new
                     {
                         channel = (string)item.Element("channel") ?? null,
                         specialtoken = (string)item.Element("specialtoken") ?? null,
                         subchannel = (string)item.Element("subchannel") ?? null,
                         subtitle = (string)item.Element("subtitle") ?? null,
                     }).ToList().Distinct();

        cboChannel.DataSource = feeds;
        cboChannel.DataBind();

        cboSpecialToken.DataSource = feeds;
        cboSpecialToken.DataBind();

        cboSubChannel.DataSource = feeds;
        cboSubChannel.DataBind();

        cboSubtitle.DataSource = feeds;
        cboSubtitle.DataBind();
        ...And so on.... 
```

有没有比将每个值项拆分为单独的查询更好的方法，例如？

干杯，克里斯

```
var specialtoken = (from item in doc.Descendants("item")
                     select new
                     {
                         specialtoken = (string)item.Element("specialtoken") ?? null,
                     }).ToList().Distinct();

var channel= (from item in doc.Descendants("item")
                     select new
                     {
                         channel = (string)item.Element("channel") ?? null,
                     }).ToList().Distinct();
etc. etc. 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T14:02:15.483

我认为最简单的方法是保留原始查询，然后为每个下拉菜单执行子查询，以确保他们关心的项目中有一个值。

```
cboChannel.DataSource = feeds.Where(x => !String.IsNullOrEmpty(x.channel)).ToList(); 
```

我发现这更简洁

# html - 在 html 中进行简单 2 列格式化的“正确”方法

> ID：556911
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-17T13:59:13.837
> 
>         
> 
> 标签：html, css

这对 css 专家来说是一个挑战。我想在我的页面上显示 2 个链接，在同一“行”上，一个在左侧，一个在右侧。

下面的代码在视觉呈现方面效果很好，但我知道格式化页面的表格并不是完成的事情。谁能告诉我“已批准”的标记应该是什么？我猜这真的很简单，但是当我尝试时，我一直在混合页面的其余部分，并继续回到表格，因为编写和完成工作需要几秒钟，我只是想了解我应该怎么做它。

（我有一个元素在其上方保存页眉/导航，另一个在其正下方保存一个表单。）

```
<table width=95%>
    <tr>
     <td>
      <a href="<? echo $url1 ?>">Back to List of Pages  </a>
     </td>
     <td align="right">
      <a href="<? echo $url2 ?>">View this page</a>
     </td>
    </tr>
</table> 
```

* * *

## 编辑 - 找到答案！

好的，我已经测试了 Akrikos 和 Magnar 的答案，而 Magnars 似乎在我的情况下效果最好。我发现使用 Akrikos 的方法，我需要在下面放置一个 clear:both 元素，以防止它与下面的 div 合并。此外，很容易将 Magnar 包裹在

元素，因此链接与我的页面的其余部分匹配，这在链接和下面的 div 之间提供了必要的空间 - 我需要使用 Akrikos 的方法在其中放置一些其他间隔。不过，感谢大家对此的帮助——在过去的 40 分钟里，我学到了很多东西！

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-02-17T14:13:11.153

您可以利用两个链接都是单行的事实来避免大量标记。使用此标记：

```
<div id="navigation"></div>    

<a id="view" href="...">View this page</a>
<a id="back" href="...">Back to List of Pages</a>

<form></form> 
```

而这个简单的CSS：

```
#view {
    float: right;
} 
```

无需清除，也无需指定宽度。

此解决方案仅适用于这种情况：两个链接。如果您需要更多，那么您应该查看一组浮动列表项。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T14:18:37.177

我宁愿将 id 放在锚标签上并直接将样式应用于它们，而不是太“快乐 div”。您可能需要添加一个带有“clear: both;”的标签 在清除浮动的链接之后......我把它留给读者作为练习。

```
<html>
<head>
<title>Test Page</title>
<style type="text/css">
#viewpage {
  float:right;
  margin-right:5%;
}
#listpages {
  float:left; 
}
</style>
</head>
<body>

  <a id='listpages' href="<? echo $url1 ?>">Back to List of Pages</a>
  <a id='viewpage' href="<? echo $url2 ?>">View this page</a>

</body>
</html> 
```

在这种情况下，“正确”使用 CSS 背后的想法是让您的 html 以一种有意义的方式描述您的内容，然后使用 CSS 更改内容的显示方式。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T14:02:59.570

```
<div style="width: 95%">
  <div style="float: left;">Link 1</div>
  <div style="float: right;">Link 2</div>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T14:04:25.713

你的意思是？

```
 <html>
  <head>
    <style>
      div.fl {
        float: left;
      }
      div.fr {
        float: right;
        text-align: right;
      }
    </style>
  </head>
  <body>
    <div class="fl">
      A
    </div>
    <div class="fr">
      B
    </div>
  </body>
</html> 
```

替换 A 和 B

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T14:13:03.523

我认为现在进行任何布局的最佳方法是使用网格。一旦你掌握了使用网格布局的窍门，你就永远不会回头。

一个很好的入门方法是使用 Blueprint CSS。它是一个很好的框架，可以帮助您设计基于网格的布局。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T14:13:24.257

这样你可以调整列宽，我已经这样做了很长时间了。我通过研究 Wikipedia HTML 和 CSS 发现了这一点。B 列将占据剩余的宽度，但仍限制在#outer-wrapper 的宽度内。

```
<div id="outer-wrapper">
<div style="float: left; width: 200px;">
    Column A
</div>
<div style="margin-left: 210px;">
    Column B
</div>
<div style="clear: both;"></div>
</div> 
```

您可以嵌套这些具有清晰可维护的基于列的布局。

# git - 如何将本地未提交的更改合并到另一个 Git 分支？

> ID：556923
> 
>         
> 
> 赞同：674
> 
>         
> 
> 时间：2009-02-17T14:02:16.093
> 
>         
> 
> 标签：git, branch

如何在 Git 中执行以下操作？

我当前的分支是 branch1，我做了一些本地更改。但是，我现在意识到我实际上打算将这些更改应用于 branch2。有没有办法应用/合并这些更改，以便它们成为分支 2 上的本地更改，而无需在分支 1 上提交它们？

* * *

## 回答 #1

> 赞同：950
> 
>             
> 
> 时间：2009-02-17T14:16:07.730

由于您的文件尚未提交`branch1`：

```
git stash
git checkout branch2
git stash pop 
```

或者

```
git stash
git checkout branch2
git stash list       # to check the various stash made in different branch
git stash apply x    # to select the right one 
```

以上是[rbento](https://stackoverflow.com/users/281815/rbento)[答案](https://stackoverflow.com/users/281815/rbento)的更长更明确的版本：

```
git stash
git stash branch branch2 
```

它用：

> ## [`git stash branch <branchname> [<stash>]`](https://git-scm.com/docs/git-stash#Documentation/git-stash.txt-branchltbranchnamegtltstashgt) 
> 
> *   从最初创建`<branchname>`的提交开始创建并签出一个名为的新分支，`<stash>`
> 
> *   将记录的更改应用`<stash>`到新的工作树和索引。
> 
> 如果成功，并且`<stash>`是表单的引用`stash@{<revision>}`，则删除`<stash>`.
> 
> `git stash push`如果您运行的分支发生了足够多的更改`git stash apply`而由于冲突而失败，这将很有用。
> 
> 由于存储条目应用在运行时为 HEAD 的提交之上`git stash`，因此它恢复了最初的隐藏状态而没有冲突。

* * *

[正如](https://stackoverflow.com/questions/556923/how-to-merge-my-local-uncommitted-changes-into-another-git-branch/556986#comment51167745_556986)[benjohn](https://stackoverflow.com/users/2547229/benjohn)所评论的（参见[`git stash`手册页](http://git-scm.com/docs/git-stash)）：

> 要同时存储当前未跟踪（新添加的）文件，请添加参数`-u`，因此：

```
git stash -u 
```

* * *

## 回答 #2

> 赞同：89
> 
>             
> 
> 时间：2009-02-17T19:53:44.203

存储、临时提交和变基可能都过大了。如果您尚未将更改的文件添加到索引中，那么您可以只签出另一个分支。

```
git checkout branch2 
```

只要您正在编辑的文件在分支 1 和分支 2 之间没有不同，这将起作用。它会将您留在 branch2 上，并保留您的工作更改。如果它们不同，那么您可以指定要将本地更改与通过切换分支引入的更改合并，并带有`-m`结帐选项。

```
git checkout -m branch2 
```

如果您对索引添加了更改，那么您需要先通过重置来撤消这些更改。（这将保留您的工作副本，它只会删除分阶段的更改。）

```
git reset 
```

* * *

## 回答 #3

> 赞同：16
> 
>             
> 
> 时间：2014-08-23T05:46:00.797

接受答案的更短的替代方法是：

> 暂时将更改移动到存储区。

1.  `git stash`

> 创建并切换到一个新分支，然后只需一步将存储弹出到它。

2.  `git stash branch new_branch_name`

然后只是对这个新分支的更改`add`。`commit`

* * *

## 回答 #4

> 赞同：10
> 
>             
> 
> 时间：2015-04-08T08:22:46.890

**警告：**不适用于 git 新手。

这在我的工作流程中出现得足够多，以至于我几乎尝试为它编写一个新的 git 命令。通常的`git stash`流程是要走的路，*但*有点尴尬。我通常首先进行新的提交，因为**如果我一直在查看更改，所有信息在我的脑海中都是新鲜**的，最好开始`git commit`我发现的内容（通常是我在工作时发现的属于 master 的错误修复）功能分支）马上。

> 如果您经常遇到这样的情况，在当前目录旁边有[另一个工作目录](https://github.com/git/git/blob/master/contrib/workdir/git-new-workdir)也很有帮助，该目录总是`master`签出分支。

所以我如何实现这一点是这样的：

1.  `git commit`立即通过良好的提交消息进行更改。

2.  `git reset HEAD~1`从当前分支撤消提交。

3.  （可选）继续开发该功能。

有时稍后（异步），或立即在另一个终端窗口中：

1.  `cd my-project-master`这是另一个共享相同的WD`.git`

2.  `git reflog`找到我刚刚制作的错误修复。

3.  `git cherry-pick SHA1`的提交。

可选地（仍然是异步的）然后您可以重新设置（或合并）您的功能分支以获取错误修复，通常当您即将提交 PR 并且已经清理了您的功能分支和 WD 时：

1.  `cd my-project`这是我正在研究的主要 WD。

2.  `git rebase master`得到错误修正。

通过这种方式，我可以不间断地继续处理该功能，而不必担心`git stash`-ing 任何事情或必须在 a 之前清理我的 WD `git checkout`（然后再次检查功能分支退出。）并且仍然有我所有的错误修复`master`而不是隐藏在我的功能分支中。

IMO `git stash`，`git checkout`当您正在开发一些重要功能时，它是一个真正的 PIA。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T14:04:25.323

如果是关于提交的更改，您应该看看 git-rebase，但正如 VonC 在评论中指出的那样，当您谈论本地更改时，git-stash 肯定是做到这一点的好方法。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2021-10-01T10:38:26.113

这些是我遵循的步骤：

*   混帐克隆{链接}

*   cd {repo 文件夹}

您可以检查状态以及您正在使用的分支：

*   状态

*   git 分支

*   git 分支 -a

注意：如果您在移动到新分支之前在本地存储库中进行了更改，则以下步骤应该仍然有效。

如果“git branch”显示master，并且你想创建+移动到另一个分支：

*   git checkout -b {分支名称}

使用“git branch”再次检查分支它现在应该显示您在新分支中。

现在添加、提交和推送：

*   混帐添加。

*   git commit -m "添加新分支"

*   git push origin {分支名称}

上述步骤适用于我在移动到新的本地分支之前进行更改或在移动到新分支之后进行更改的情况。我希望它可以帮助遇到类似情况的人。

# vb.net - 如何在VB中简化几个类似的集合文件

> ID：556924
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-17T14:02:23.113
> 
>         
> 
> 标签：vb.net

我是编程新手。

在 VB2005 中，我有一些目标文件，如 a.vb、b.vb、c.vb.. 它们每个都有不同的属性。

然后我有集合文件，例如：as.vb 是 a 的集合，bs.vb 是 b 的集合......每个都有大致相同的内容，如 add、item、count...

所以现在我想知道，是否可以简化这些冗余集合，例如将所有集合集成到一个集合文件中，但可以被所有目标文件使用。

十分感谢

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-17T14:09:56.263

您可以使用.NET 2.0 及更高版本中的[泛型](http://msdn.microsoft.com/en-us/library/ms379564.aspx)来实现此目的。

这篇[文章](http://blogs.msdn.com/kcwalina/archive/2005/09/23/Collections.aspx)描述了 .NET 2.0 中可用的各种通用集合

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T14:18:05.900

您所描述的是您需要如何做才能在 VB6 中获得强类型集合。.Net 提供了至少 3 种不同的优越选择：

*   只有一个通用的 *s.vb 文件可以完全实现您想要的操作：  

.

```
Public Class MyTypedCollection(Of T)
    Inherits System.Collections.Generic.Collection(Of T)

    Public Overrides Sub Add(ByVal item As T)
       Mybase.Add(item)
    End Sub

    ''// ...
End Class 
```

*   使用或继承预建的`System.Collections.Generic.List(Of T)`

*   使用预先构建的 List(Of T)，但为其命名，使其具有您自己的自定义类型名称：  

.

```
 Imports ACollection = System.Collections.Generic.List(Of A) 
```

# silverlight - Silverlight 页面上的单击处理程序

> ID：556927
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-17T14:02:38.323
> 
>         
> 
> 标签：silverlight, mouse, click

有没有办法在页面或用户控件级别捕获 MouseLeftButtonDown（或其他鼠标事件），然后能够确定实际单击了哪个子控件？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T14:09:30.133

是的。在页面或其他 UI 根上设置您的处理程序，然后使用以下方法确定在该处理程序中单击了什么。

```
List<UIElement> hits = System.Windows.Media.VisualTreeHelper.FindElementsInHostCoordinates(args.GetPosition(null), startFromControl); 
```

请注意，要“命中”控件有一些要求。一个常见的原因是没有定义背景。控件还可以使用 UIElement.IsHitTestVisible 属性关闭命中测试。

# c# - 使用 SQL 后端时的存储库模式和项目删除

> ID：556945
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-17T14:06:58.407
> 
>         
> 
> 标签：c#, domain-driven-design, repository-pattern

所以假设我有一个名为 Post 的类，其中包含一个 IList

我发现当我要求我的存储库更新我的帖子时，将评论添加到列表中很容易，它可以查看哪些评论是新的，并将所需的信息发送到我的数据层，但是当评论被删除时呢？ ? 你怎么处理这个？

你会拉回一个评论列表来检查哪些评论不再存在于当前更改的集合中吗？

或者连接事件来跟踪它？

还是完全不同的东西？

只是为了获取更多信息，我在 C# 中执行此操作并且不能使用 O/R 映射器。我必须使用存储过程来检索数据集并手动映射我的对象。我可能对存储库模式的理解是错误的，但我使用它来调解数据层，从请求数据、添加数据等，它将我的数据集数据映射到对象并返回对象。因此，如果您愿意，也可以随意详细说明如何使用存储库模式。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-02-20T16:46:24.943

如果我理解您的尝试，您正在向相关 IList 添加一个 Comment()，该 IList 附加到 Post()。在您的 Post() 中，您正在 IList 中寻找任何新的 Comment() 并保存它们。让 Post() 对象控制它的子对象，例如 Comment()，确实走上了 DDD 的道路。

我自己对这些模式还是陌生的；但就个人而言，我倾向于认为任何具有元数据的实体，我都将其视为自己的实体模型；因此，我为每个实体模型创建了自己的存储库。  

```
Post()
PostRepository : IPostRepository

Comment()
CommentRepository : ICommentRepository 
```

现在，我认为拥有 IList Post.Comments 违反*了得墨忒耳定律，*因为它允许您执行 Post.Comments.Add()。

我相信您的问题的解决方案不会添加到 IList，而是在 Post() 上创建方法来处理与该 Post 实例相关的评论：

```
Post.AddComment()
Post.FetchComments()
Post.DeleteComments(IList<Comment> comments) 
```

然后在 Post() 对象中，连接 ICommentRepository（很可能使用 ServiceLocator，或者我更喜欢 Castle Windsor）并处理它们的添加和删除。

```
ICommentRepository.AddByPostID()
ICommentRepository.FetchByPostID()
ICommentRepository.Remove(int commentID) 
```

同样，我对 DDD 模式还是很陌生；但是，我相信这是保持关注点分离有效并通过将其保持在 Post() 的关注范围内来掩盖底层逻辑，以“仅处理与此 Post 对象相关的评论的操作”。

完整的 Post() 类将是这样的：

```
private ICommentRepository _commentRepo;

public class Post
{
  public Post(ICommentRepository commentRepo)
  {
    // Or you can remove this forced-injection and use a 
    // "Service Locator" to wire it up internall.
    _commentRepo = commentRepo;
  }

  public int PostID { get; set; }

  public void DeleteComments(IList<Comment> comments)
  {
    // put your logic here to "lookup what has been deleted"
    // and then call ICommentRepository.Delete() in the loop.

    _commentRepo.Remove(commentID);
  }
} 
```

如果其他人有意见或变化，请发表评论。

# .net - 测试事务代码

> ID：556951
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-17T14:08:51.333
> 
>         
> 
> 标签：.net, transactions, tdd

我正在编写自己的事务感知 (IEnlistmentNotification) 代码，并尝试使用 XUnit 对其进行测试。我所需要的只是等待事务提交并测试结果是否符合我的预期。问题是事务提交发生在一个单独的线程中，所以我需要同步我的测试和我正在测试的一段代码。除了使用 EventWaitHandle 之外，还有没有更简单的方法可以在事务完成后进行测试？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-10-04T05:15:42.917

听起来您正在尝试在一次测试中测试两件事；您正在测试某件事是否发生，并且您正在测试事务是否实际提交。我肯定会尝试单独测试它们。即在没有交易的情况下测试“功能”，然后用假的“功能”测试交易。这有望使测试它们变得更容易，并且可能会或可能不会（取决于您的设计）消除对“事务线程”的需求。

# debugging - 如何在 VC++ 6 中调试“调试断言失败”

> ID：556960
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-02-17T14:10:55.107
> 
>         
> 
> 标签：debugging, visual-c++, visual-c++-6, assertions

我想知道如何调试以下错误：

```
Debug Assertion failure

Program: tomtoprog.exe
File: dbgheap.c
Line: 1044

Expression:_CrtIsValidHeapPointer(pUserData)
... 
```

我对使用 VC++ 6 进行 Windows 开发很陌生……有 valgrind 或类似的东西吗？tomtoprog 代码不是我写的，而且相当混乱......所以像 valgrind 这样的东西会让我的生活更轻松......

提前致谢！

最好的祝福，

正补品

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-17T14:16:28.243

点击“重试”，它会进入调试器。这会给你调用堆栈。从那里，您可以找到有问题的代码部分。

提示：您可能两次删除/释放某些内容。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-17T14:17:01.003

看起来你要么有堆损坏，要么你正在做一个没有同一个指针的双重释放。如果您闯入调试器，断言发生时调用的代码的最后一行是什么？

检查此类问题的最佳方法是使用[PageHeap.exe 之类的页面堆验证程序](http://support.microsoft.com/default.aspx?scid=kb;en-us;286470)

另请参阅有关堆栈溢出的相关问题

[Win32下的堆损坏；如何定位？](https://stackoverflow.com/questions/1069/heap-corruption-under-win32-how-to-locate)

# python - 我应该在哪里发布我的 python 代码？

> ID：556967
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-02-17T14:12:24.930
> 
>         
> 
> 标签：python, excel-2007

今天我需要从一个 xlsx 文件（Office open XML 电子表格）中解析出一些数据。我本可以在 openoffice 中打开文件并导出到 csv。但是我稍后需要从这个电子表格中重新导入数据，并且我想消除手动操作。

我在网上搜索 xlsx 解析器，我发现的只是一个 stackoverflow 问题，问同样的事情：[Parsing and generate Microsoft Office 2007 files (.docx, .xlsx, .pptx)](https://stackoverflow.com/questions/173246/parsing-and-generating-microsoft-office-2007-files-docx-xlsx-pptx)

所以我推出了自己的。

它有 134 行用于解析和访问电子表格的代码，以及 54 行单元测试代码。当然，这仅在我需要的 1 个文件上进行了测试，除了它在单元测试中的使用方式之外，现在还没有文档关闭。它使用 zipfile、minidom、re 和 unittest，因此非常便携且独立于平台。

由于我不写博客，也不想将它变成 OfficeOpen XML 的 python 库，所以我一直想知道我应该在哪里发布这段代码。我已经解决了一个我相信其他人将来会遇到的问题。所以我想将我的代码发布在公共领域的某个地方，让任何人都可以复制并粘贴到他们的应用程序中并调整以解决他们的问题。

实现很简单，这里是功能的快速概述：

```
workbook = Workbook(filename) # open a file
for sheet in workbook: pass # iterate over the worksheets
workbook["sheetname"] # access a sheet by name, also possible to do by index from 0
sheet["A1"] # Access cell
sheet["A"] # Access column
sheet["1"] # Access row
cell.value # Cell value - only tested with ints and strings. 
```

感谢所有的答复。我打算将它托管在 activestate 上，但是在向我发送激活邮件时页面一直崩溃。所以我无法激活我的代码来发布它。

我的第二个选择是 codeproject，我写了一篇关于该文件的好文章。可悲的是，当我尝试提交我的帖子时，该页面崩溃了。

所以我把它放在 github 上供任何人查看和分支：http:
 [//github.com/staale/python-xlsx/tree/master](http://github.com/staale/python-xlsx/tree/master)

我不想为 python 项目托管做所有的工作，所以就这样了。

接受 git 答案，因为那是唯一对我有用的东西。和 git 岩石。

编辑：Gah，我在 codeproject 的整个帖子都丢了，我写得真好。去他妈的，我花了更多的时间试图分享这个而不是编码它。所以我现在称它为我的部分完成了。除非我决定以后再调整它。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-02-17T14:46:36.657

[GitHub](http://github.com/)也是发布此内容的好地方。特别是因为这将允许其他人快速分叉他们自己的副本并进行他们需要的任何改进或修改。然后，任何想要它们的人也可以使用这些更改。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-02-17T14:17:01.767

你应该把它贴在[这里](http://code.activestate.com/recipes/langs/python/)。这里有很多食谱，您的食谱非常适合。

Stack Overflow 旨在成为一个 wiki，人们可以在其中搜索问题并找到答案。话虽如此，如果您想在此处发布它，您要做的就是打开一个与您的答案相关的问题，然后用您的答案回答您自己的问题。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T14:48:14.080

如果您的代码足够短，可以复制和粘贴，您可能希望将其发布为[Python 配方](http://code.activestate.com/recipes/langs/python/)。该站点是学习 Python 技术的绝佳资源，其最佳内容已[编入一本书](http://www.oreilly.com/catalog/9780596007973)。

如果您的代码可以按原样重复使用，那么您应该将您的 Python 代码发布在[Python 包索引](http://python.org/pypi)(pypi) 中。组织您的源代码，[阅读本教程](http://www.python.org/~jeremy/weblog/030924.html)，了解如何`setup.py`为您的包编写一个。一旦你有你的免费 pypi 帐户并编写了`setup.py`，运行`python setup.py register`以声明你的包的名称并将它的元数据发布到索引中。`setup.py`还可以将包**的源代码或二进制文件**[上传](http://docs.python.org/distutils/uploading.html "上传")到pypi ，例如`python setup.py sdist upload`构建和上传源代码**分发**。

 ****一旦您的包成为 Python 包索引的一部分，其他 Python 程序员就可以使用包括`easy_install your_package`.

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T14:18:13.980

错误，具有更具描述性的标题，我相信很多人都会在这里找到它。（但我不知道不是问题标签）。

因此，您可以获得一个免费的博客，只需放入您想要分享的内容，这样您就可以在需要时获得稳定的在线参考。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T17:00:06.587

一般来说，只要你愿意写一篇关于代码的小文章， [CodeProject是一个发布代码的好地方。](http://www.codeproject.com/)（关于 CodeProject 的好处之一是它们确实需要一些关于代码的冗长。）该站点获得了大量的流量，因此您在此处发布的任何内容都会被看到。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T14:28:50.383

在我看来，[Python 包索引](http://pypi.python.org/pypi)是适合你的地方

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2009-02-18T18:28:00.267

我可以谦虚地推荐我的网站吗？[http://utilitymill.com](http://utilitymill.com)。它不仅可以让您发布您的 Python 代码，还可以将其变成可运行的 Web 实用程序。  

用户可以协作编写代码和撰写文章，它甚至免费为您提供该实用程序的自动 RESTful API。

# asp.net - 如何使用 ModalPopupExtender 在单击时加载面板？

> ID：556969
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-17T14:12:26.583
> 
>         
> 
> 标签：asp.net, vb.net, .net-2.0, ajaxcontroltoolkit

我正在创建一个清单，其中“清单项目”被添加到“清单”中。每个项目旁边都有一个按钮，用于启动一个模式弹出窗口，其中包含有关该项目的其他信息。

因为项目太多，所以我将实际弹出的面板放在了“清单”上，所以它只会在网页上出现一次。ModalPopupExtender 似乎可以很好地处理这个跨类弹出窗口。

我的问题是如何将信息加载到此面板中？“清单项”包含需要传递到清单中的数据——我很想通过更新面板来完成这一点，以避免完整的回发。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T14:25:09.470

您可以通过 javascript 完成它而无需回发。

向按钮的 OnClientClick 事件中抛出一个 javascript 函数，使其看起来像这样：

```
MyButton.OnClientClick = "ShowModal(); return false;" 
```

然后在javascript中：

```
function ShowModal()
{
var myDiv = document.getElementById("SomeDivInTheModal");
myDiv.InnerHTML = "<b>Some specal HTML to show in the modal.</b>";
var mpe = $find('MyModalPopUpBehaviorId');

if (mpe) {
mpe.show();
}

} 
```

# eclipse - 使用eclipse时如何在本地和SVN中布局文件夹

> ID：556971
> 
>         
> 
> 赞同：30
> 
>         
> 
> 时间：2009-02-17T14:12:45.117
> 
>         
> 
> 标签：eclipse, svn

多年来，我一直在使用 eclipse 和 SVN 的团队中从单个开发人员到 12 人，并且我始终是设置文件夹结构的人。我设法让它以某种方式工作，但我觉得我的文件夹布局远非最佳。很难说我典型的文件夹布局是什么样子的，因为每次看起来都非常不同。

我现在刚刚开始另一个大项目，这次我想以*专业的方式*来做。

## 关于项目的事实

这些是现在的事实：

*   所有开发人员都将使用 Eclipse

*   有些将使用 Subclipse 将 SVN 集成到 Eclipse 中，有些将使用外部客户端，如 Tortoise SVN 或 svnX

*   我们正在 Windows 和 Mac OS 上开发

*   我们正在使用 ant 来自动化构建和 junit 测试

*   将有多个相互关联的项目：

    *   一个用纯 Java 编写的库，因此它可以在所有已知的 Java 平台上运行

    *   几个 Java 平台（J2SE、J2ME、android...）的几个应用程序。所有这些应用程序都依赖于前面提到的库

## .project 怎么办？

我总是不确定是否要提交 eclipse 生成的那些文件（比如 ''.project'' 和 ''.classpath''）。在之前的项目中，有时我们将它们放入 SVN，有时我们没有，这两种方法都各有利弊。有一次，我们甚至承诺了整个工作空间，但这似乎不是一个好主意。

我肯定缺少的一个关键概念是 Eclipse 如何处理其工作区。默认情况下，整个项目位于工作区文件夹内，但可能有外部项目，它们以我不明白的某种神奇方式链接。

## 可能的文件夹布局

我不确定如何在本地*和*存储库上布局项目。我认为有三种可能：

*   工作区是我的本地工作副本的子文件夹（如 c:\code\myWorkingCopies\projectXyz\trunk\workspace）

*   我的工作区是我的工作副本（我使用 c:\code\myWorkingCopies\projectXyz\trunk\ 作为工作区）

*   我的工作区在某个地方（c:\code\workspace），我的工作副本在其他地方（c:\code\myWorkingCopies\projectXyz\trunk），我有那些外部项目

*   还有其他想法吗？

## 我在寻找什么样的答案？

一个虚拟的文件夹结构，可能是这样的（我只是回答我自己的问题吗？）：

*   树干

    *   项目

        *   项目A

        *   项目B

以及提示在哪里结帐的内容，例如：

*   将主干/项目结帐到 c:\code...)

还有一些准则，例如

*   永远不要上传 x,y,z 类型的文件...

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-02-17T15:52:33.753

工作区和存储库不应相关。

工作区实际上只是 Eclipse 存储一堆设置的地方。项目文件可以（并且通常确实）存在于工作区中，但如您所知，它们可以从外部源导入——导入只是一个逻辑链接。

您可以为特定目的创建任意数量的工作区；如果您有理由这样做，您甚至可以将一个工作区中的项目导入另一个工作区。

SVN 布局应该与工作区的定义方式分开。它们最终可能看起来很相似，但这并不意味着它们实际上是相同的。我建议每个 Eclipse 项目都有自己的 SVN 项目，而不是

*   [http://myrepo](http://myrepo)

    *   我的工作空间

        *   树干

            *   项目A

            *   项目B

        *   标签

        *   分支机构

你有

*   [http://myrepo](http://myrepo)

    *   项目A

        *   树干

        *   标签

        *   分支机构

    *   项目B

        *   树干

        *   标签

        *   分支机构

这对您的作用是让您可以灵活地布置工作区，与存储库的结构完全分开。您将能够将单个项目签出到工作区中，而无需签出整个代码库。当其他项目在主干上时，您将能够在开发分支上签出项目，您可以恢复对一个项目的更改，同时不理会另一个项目等等。

关于将哪些工件检查到 SVN 中的最后一个问题是个人喜好问题。我建议检查开发团队中通用的任何工件。如果 Eclipse 是标准 IDE，请继续签入 .project 和 .classpath 文件，以便新开发人员能够立即签出和构建。如果某些插件是通用的并且有自己的配置文件，请继续检查它们。另一方面，任何没有在开发团队中共享的东西都应该被排除在存储库之外。

希望这可以帮助。

* * *

*编辑*

进一步的经验告诉我，唯一应该进入源代码控制的是实际的源文件。开发人员在设置新项目时应重新生成配置和设置文件。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-02-17T15:21:11.940

我们有类似的设置（Mac、Linux 和 Windows 用户），我们的文件夹结构是：

*   树干

    *   代码

        *   项目A

        *   项目B

我们确实检查了 .project、.settings 和 .classpath 文件以及代码，但没有检查工作区。真正的问题与构建路径有关。如果你解决了这些问题，就不会让人头疼，也不需要签入哪个目录。

一些技巧：

1.  如果您的项目相互引用，请确保它们使用构建路径的“项目”选项卡相互引用。这将使所有对其他项目的引用保持相对（../projectA 而不是 /opt/trunk/projectA 会破坏其他人的项目）。

2.  如果您有任何引用的外部库，请创建用户库并让每个人都创建一个具有相同名称的库。我们使用 JBoss，所以我们让每个人都创建一个名为 JBoss 的用户库，该库引用他们本地 JBoss 安装中的 jar。这样，你的 JBoss 安装在哪里并不重要，只要你有那个用户库，你就可以开始了。您的项目将引用用户库名称，但实际的用户库信息是每个用户的本地信息。

3.  确保每个人都知道技巧 1 和 2。这里唯一搞砸的事情是当有人忘记通过“项目”选项卡进行引用而不是直接链接到 jar 时。

所有这些都适用于 Eclipse SVN 插件或不使用。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T16:00:32.847

我使用并强烈推荐存储库结构，例如：

*   项目

    *   项目A

        *   树干

            *   爪哇

            *   html

            *   文档

            *   会议

*   小贩

    *   朱尼特

        *   当前的

        *   1.1

        *   1.2

在磁盘上使用如下布局：

```
c:\dev\
   \ProjectAtrunk\
   \ProjectBbranch4\ 
```

以这种方式工作，您的分支和标签就在您的主干附近，您不太可能依赖存储库中的项目结构来引用外部库。所有对项目主干外代码的引用都应使用外部代码。

所有这一切意味着您更有可能保持这样的格言，即检查主干是您构建项目所需的一切。共享代码作为单独的项目保存和管理，并由外部引用。

您更能够查看项目主干上的更改并查看项目的完整历史记录，而不会产生垃圾。当您查看主干上的修订历史时，您不太可能对项目进行不可见的更改。

发布时，使用 stable 分支和 svn-merge。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T15:34:17.183

在 Macromedia Dreamweaver 和 Eclipse 中，我一直在执行以下操作：

```
Working folder: 
C:\Development\
    \ProjectA
    \ProjectB
    \ProjectC 
```

每个项目都有自己的存储库，并且每次签出只针对 /trunk/。

注意：对于 Eclipse，不要创建 SVN Repository 项目，只需像往常一样创建“Java App”或“PHP App”项目，然后使用外部程序签出该文件夹。然后，Eclipse 将自动检测 .svn 信息并允许您使用 SVN 工具，同时仍使用正确的工作空间。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-11-28T21:27:16.220

Ickster 说“……但正如你所知，它们可以从外部源导入——导入只是一个逻辑链接。”

实际上，这并不完全正确。导入执行复制，而链接资源是到外部源结构的链接。请参阅：
[链接资源](http://help.eclipse.org/galileo/topic/org.eclipse.platform.doc.user/concepts/concepts-13.htm)
和
[创建链接资源](http://help.eclipse.org/galileo/topic/org.eclipse.platform.doc.user/tasks/tasks-45.htm)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-02-17T14:22:28.337

我最近开始使用 Subclipse 并且有一个适合我的方法。我们正在使用 PHP 应用程序，因此我通过 Eclipse 项目向导创建了一个新的 SVN 项目，选择“通过 SVN 签出项目”。然后我使用项目配置向导配置该项目并选择 PHP 作为项目类型。我为项目命名，以便在我的工作区中，项目名称位于项目资源管理器的顶层。

我从不提交专门为 Eclipse 创建的任何内容，尤其是因为我们团队中并非每个人都使用 Eclipse。这意味着排除 .project 文件和任何其他 Eclipse 创建的文件。

使用此方法的另一个好处是您可以将多个存储库签出到工作区中。我们为我们的项目使用两个存储库位置（出于特定原因，我不会详细介绍），因此这使我可以轻松方便地同时处理两个“项目”。

我确信还有其他方法可以做到这一点，但这是我发现使用 Subversion 和 Eclipse 最简单的方法。

# ms-access - MS Access 中是否有回车、换行常量？

> ID：556978
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-02-17T14:14:31.523
> 
>         
> 
> 标签：ms-access

一个简单的问题，我的脑袋...

我有一个大型访问数据库要清理。

Access 中是否有用于换行的系统常量（如 VB 的 VBCrLf）？

如果没有，我想我只需要使用 Chr(13) + Chr(10)

* * *

## 回答 #1

> 赞同：18
> 
>             
> 
> 时间：2009-02-17T14:17:11.360

在 VBA 中，`vbCrLf`是换行符常量（与`vbCr`和一起`vbLf`）。

在字符串数据列中，它是`Chr(13) + Chr(10)`（`vbCrLf`定义为）。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-02-17T15:45:23.303

虽然存在**vbCrLf**、**vbCr**和**vbLf**，但最好使用**vbNewLine**。

为什么？

1）因为 vbNewLine 将输出当前操作系统的换行符序列（可能会改变），而其他三个只会输出回车符和换行符。

2）因为它不那么神秘。使用 vbCr 和 chr(13) 一样糟糕

合乎逻辑的回归是......来吧，MS什么时候会改变换行符，他们会疯的。事实上，便携性。已经有 .Net 端口到 unix/linux 并且没有理由不能在那里模拟 MS 访问。（例如，也许在 Wine 中）

**编辑**

与此想法类似的是在 C 和 C++ 中使用 \n 与输入 \f\r。\n 将为您提供本机换行符序列（即使您从 Unix 切换到 Windows 到 Mac 到 Vax 到 QNX）。没有条件语句，没有编辑。它只是工作。

# jsf - JSF IceFaces 重新显示输入值的基本问题

> ID：556979
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-17T14:15:11.787
> 
>         
> 
> 标签：jsf, icefaces

我不知道我做错了什么。我正在使用 IceFaces，并且我有简单的托管 bean：

```
public class TestingController {
    private String name;

    public String submit() {
        setName("newName");
        return null;
    }

    public void setName(String name) { 
        this.name = name;
    }

    public String getName() {
        return name;
    }
} 
```

并查看：

```
<ice:inputText value="#{testController.name}" />
<ice:commandButton value="submit" action="#{testController.submit}" /> 
```

当我在第一次显示页面后提交表单时，输入会重新显示为“newName”。当我清除输入字段并再次提交表单时，名称并没有像我预期的那样重新显示为“newName”，但它仍然是空的。

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T19:50:43.337

为我工作。点击提交后，输入框变成了“newName”，不管之前输入的是什么。

测试.jspx

```
<?xml version="1.0" encoding="UTF-8"?>
<!-- 
    Document   : test
    Created on : Feb 17, 2009, 2:35:12 PM
    Author     : drew
-->
<jsp:root xmlns:h="http://java.sun.com/jsf/html"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:jsp="http://java.sun.com/JSP/Page"
   xmlns:ice="http://www.icesoft.com/icefaces/component"
          version="2.0">
   <f:view>
      <ice:form>
         <ice:inputText id="inp" value="#{TestController.name}" /> <br/>
         <ice:commandButton id="submit" value="SUBMIT" action="#{TestController.submit}" />
      </ice:form>
   </f:view>
</jsp:root> 
```

测试控制器.java

```
public class TestController {

   /** Creates a new instance of TestController */
   public TestController() {
   }
   private String name;

   public String submit() {
      setName("newName");
      return null;
   }

   public void setName(String name) {
      this.name = name;
   }

   public String getName() {
      return name;
   }

} 
```

面孔-config.xml

```
<managed-bean>
   <managed-bean-name>TestController</managed-bean-name>
   <managed-bean-class>com.evi.web.viewdata.TestController</managed-bean-class>
   <managed-bean-scope>request</managed-bean-scope>
</managed-bean> 
```

你能给我们更多的信息吗？

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-03-06T08:55:20.870

尝试使用 actionListener。因为如果你使用 action 页面发送信息并重新加载页面，但如果你使用 actionListener 只会触发事件。

```
<ice:commandButton id="submit" value="SUBMIT" actionListener="#{testController.submit}" /> 
```

在支持 bean 中：

```
public class TestingController {

private String name;

public void submit(ActionEvent event) {
setName("newName");

} 
```

# tfs - TFS 中的搁置是什么？

> ID：556981
> 
>         
> 
> 赞同：323
> 
>         
> 
> 时间：2009-02-17T14:15:32.053
> 
>         
> 
> 标签：tfs, shelve

在 TFS 中搁置仅仅是一种软签入，以便其他团队成员可以看到源代码吗？

即搁置的代码不会被编译吗？

* * *

## 回答 #1

> 赞同：463
> 
>             
> 
> 时间：2009-02-18T09:37:18.343

搁板有很多用途。主要有：

1.  **上下文切换**：保存当前任务的工作，以便您可以切换到另一个高优先级任务。假设您正在开发一项新功能，并专注于自己的业务，这时您的老板跑进来说“啊！Bug Bug Bug！” 并且您必须放弃对该功能的当前更改并修复错误。您可以搁置您在功能上的工作，修复错误，然后回来并取消搁置以处理您的更改。

2.  **共享变更**集：如果您想在不签入的情况下共享代码变更集，您可以通过搁置它来方便其他人访问。当您将不完整的任务传递给其他人（可怜的灵魂）时，或者如果您有某种测试代码，您永远不会签入其他人需要运行的代码，这可以使用。[h/t](http://en.wikipedia.org/wiki/Hat_tip)对其他关于使用它进行评论的回复，这是一个非常好的主意。

3.  **保存进度**：在处理复杂功能时，您可能会发现自己处于想要保存进度的“好点”。这是搁置代码的理想时机。假设您正在修改一些 CSS / HTML 来修复呈现错误。通常你会猛烈抨击它，迭代你能想到的每一个可能的组合，直到它看起来正确。但是，一旦它看起来正确，您可能想要尝试返回以清理您的标记，以便其他人在您签入之前能够理解您所做的事情。在这种情况下，您可以在一切都呈现正确时搁置代码，那么你就可以自由地去重构你的标记，知道如果你不小心再次破坏了它，你总是可以回去获取你的变更集。

还有其他用途吗？

* * *

## 回答 #2

> 赞同：111
> 
>             
> 
> 时间：2009-02-17T14:20:01.853

搁置是一种无需签入即可将所有更改保存在您的盒子上的方法。这些更改会保留在服务器上。在以后的任何时候，您或您的任何队友都可以将它们“搁置”回您的任何一台机器上。  

它也非常适合用于审查目的。在我的团队进行检查时，我们搁置了我们的更改并发送了一封电子邮件，其中包含更改描述和变更集的名称。然后团队中的人员可以查看变更集并提供反馈。

仅供参考：查看搁置集的最佳方法是使用以下命令

> tfpt 审查/搁置集：搁置集名称；用户名

tfpt 是 Team Foundation Power Tools 的一部分

* * *

## 回答 #3

> 赞同：37
> 
>             
> 
> 时间：2009-02-17T14:20:29.933

这是正确的。如果您创建了一个书架，其他执行获取最新信息的人将看不到您的代码。

它将您的代码更改放到服务器上，这可能比您的工作 PC 得到更好的备份。

如果您有在家工作的冲动，它使您能够在另一台机器上获取您的更改。

其他人可以看到您的书架（尽管我认为这可能是可选的），因此他们可以在签入之前查看您的代码。

* * *

## 回答 #4

> 赞同：21
> 
>             
> 
> 时间：2015-10-23T08:58:23.723

在很多这些讨论中遗漏的一点是，您如何在搁置更改的同一台机器上恢复。也许对大多数人来说是显而易见的，但对我来说不是。我相信您执行撤消挂起的更改 - 对吗？

我理解的过程如下：

1.  要搁置您当前的待定更改，请右键单击项目，搁置，添加搁置名称

2.  这将保存（或搁置）对服务器的更改（没有人会看到它们）

3.  然后，您执行撤消挂起的更改以将您的代码恢复到最后一个签入点

4.  然后，您可以使用还原的代码基线做您需要做的事情

5.  您可以随时[取消搁置更改](https://stackoverflow.com/a/10246481/2093880)（可能需要一些合并冲突）

因此，如果您想开始一些您可能需要搁置的工作，请确保在开始之前签入，因为签入点是您在执行上述撤消挂起更改步骤时将返回的位置。

* * *

## 回答 #5

> 赞同：14
> 
>             
> 
> 时间：2009-02-17T14:54:54.000

我一直遇到这个，所以关于分支的补充信息：

如果您正在使用多个分支，则搁置集与您创建它们的特定分支相关联。因此，如果您让变更集在货架上生锈太久而不得不将其搁置到不同的分支，那么您必须使用 7 月发布的电动工具来做到这一点。

```
tfpt unshelve /migrate 
```

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2018-01-24T18:34:23.247

搁置就像您的更改已存储在源代码管理中，而不会影响现有更改。意味着如果您在源代码管理中签入文件，它将修改现有文件，但搁置就像在源代码管理中存储您的更改但不修改实际更改。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2016-04-13T07:36:53.757

@JaredPar：是的，您可以使用 Shelvesets 进行评论，但请记住，shelvesets 可以被您/其他人覆盖，因此不是长期稳定的。因此，对于监管相关的审查，您永远不应使用 Shelveset 作为基础，而应使用签入（变更集）。对于非正式的审查是可以的，但对于正式的（例如与 FTA 相关的）审查是不行的！

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2016-05-19T21:22:43.063

如果您使用的是 Gated 构建，则在触发构建时，它会创建一个工作区的搁置集，用于提交构建。如果构建失败，则搁置集被拒绝。如果构建成功，则会创建一个变更集并将其提交给 TFS。在任何一种情况下，执行签入/构建的人都必须协调工作区，这就像执行获取最新消息一样简单。

# c# - 如何查看添加到先前分配为 datagridview.datasource 列表的 DataGridView 中的新行？

> ID：556984
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-02-17T14:15:51.443
> 
>         
> 
> 标签：c#, datagridview

如何查看添加到先前分配为 datagridview.datasource 的列表的 datagridview 中的新行？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-02-17T14:17:34.247

您需要重新调用 databind() 方法来查看数据的任何更新。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-02-17T14:27:25.877

在 WinForms 上：

如果列表没有自动通知`DataGridView`更改，我知道显示新行的唯一方法是将 设置`DataSource`为`null`然后再次返回到您的列表。

您可能应该使用`BindingSource`here 来让您的生活更轻松并避免 UI 中出现视觉问题。`DataGridView`将 the`BindingSource`和 the绑定`BindingSource`到您的列表。然后你可以打电话`BindingSource.ResetBindings(false)`用你的新行来更新它。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2012-01-12T05:12:35.563

嘿，这取决于您使用什么方式将数据分配给 Datagridview。

如果您使用的是 Datagridview.datasource，那么您只需将行添加到分配给该 datagridview 的表中。

谢谢

# asp.net-mvc - ComponentNotRegisteredException Probs - ASP.NET MVC

> ID：556988
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-02-17T14:16:28.867
> 
>         
> 
> 标签：asp.net-mvc, routing, url-routing

我最近将我正在做的一个项目升级到 RC1，我绝对会把头发拉出来。我正在使用 AbsoluteRouting，但我不断收到以下问题，这使我无法升级。我知道你是否有任何想法，但我想我会看看你是否有（非常感谢你能提供的任何帮助:)）

迁移后出现此错误：

全球.asax.cs

```
routes.Add(new EnableAbsoluteRouting()

               .SetPort("http", 2008)

               .SetPort("https", 450));

routes.Add(new Route("Login/SignIn", new MvcRouteHandler()) {

               Defaults = new RouteValueDictionary(new { controller = "Login", action         = "SignIn" })

        }); 
```

视图内的 Control(*.ascx)

```
<% using (Html.Form<LoginController>(c => c.SignIn())) { %>

EnableAbsoluteRouting.cs:

    public override VirtualPathData GetVirtualPath(RequestContext requestContext,     RouteValueDictionary values)

    {

        using (RouteTable.Routes.GetReadLock())

        {

            foreach (var routeBase in RouteTable.Routes)

            {

                if (routeBase != this)

                {

/// Error there:

                    var vpd = routeBase.GetVirtualPath(requestContext, values);

                    if (vpd != null)

                        return EnsureCorrectScheme(requestContext, routeBase, vpd);

                }

            }

        }

        return null;

    } 
```

空引用异常：

" 在 System.Collections.Generic.Dictionary`2.Enumerator.MoveNext()\r\n

在 System.Web.Routing.ParsedRoute.Bind（RouteValueDictionary currentValues，RouteValueDictionary 值，RouteValueDictionary defaultValues，

RouteValueDictionary 约束）\r\n 在 System.Web.Routing.Route.GetVirtualPath(RequestContext requestContext,

RouteValueDictionary 值）\r\n 在 System.Web.Routing.RouteCollection.GetVirtualPath(RequestContext requestContext,

RouteValueDictionary 值）\r\n 在 Microsoft.Web.Mvc.LinkBuilder.BuildUrlFromExpression[T]（ViewContext 上下文，

表达式`1 action)\r\n   at Microsoft.Web.Mvc.LinkExtensions.BuildUrlFromExpression[T](HtmlHelper helper, Expression`1 操作)\r\n

在 Microsoft.Web.Mvc.MvcForm `1..ctor(HtmlHelper helper, HttpContextBase context, Expression`1 postAction，FormMethod 方法，

RouteValueDictionary htmlAttributes)\r\n 在 Microsoft.Web.Mvc.FormExtensions.Form[T](HtmlHelper helper, Expression`1 postAction,

FormMethod 方法，IDictionary`2 htmlAttributes)\r\n 在 Microsoft.Web.Mvc.FormExtensions.Form[T](HtmlHelper 助手，

表达式`1 postAction)\r\n at ASP.views_shared_controls_quicklogincontrol_ascx.__Render__control1(HtmlTextWriter __w,

控制参数Container)中

d:\Projects\WebSite\Views\Shared\Controls\LoginControl.ascx:第 11 行\r\n

在 System.Web.UI.Control.RenderChildrenInternal（HtmlTextWriter 编写器，ICollection 子级）\r\n  

在 System.Web.UI.Control.RenderChildren（HtmlTextWriter 编写器）\r\n 在 System.Web.UI.Control.Render（HtmlTextWriter 编写器）\r\n

在 System.Web.UI.Control.RenderControlInternal（HtmlTextWriter 编写器，ControlAdapter 适配器）\r\n

在 System.Web.UI.Control.RenderControl（HtmlTextWriter 编写器，ControlAdapter 适配器）\r\n

在 System.Web.UI.Control.RenderControl（HtmlTextWriter 编写器）\r\n

在 System.Web.UI.Control.RenderChildrenInternal（HtmlTextWriter 编写器，ICollection 子级）\r\n

在 System.Web.UI.Control.RenderChildren（HtmlTextWriter 编写器）\r\n 在 System.Web.UI.Page.Render（HtmlTextWriter 编写器）\r\n  

在 System.Web.Mvc.ViewPage.Render（HtmlTextWriter 编写器）\r\n

在 System.Web.UI.Control.RenderControlInternal（HtmlTextWriter 编写器，ControlAdapter 适配器）\r\n

在 System.Web.UI.Control.RenderControl（HtmlTextWriter 编写器，ControlAdapter 适配器）\r\n

在 System.Web.UI.Control.RenderControl（HtmlTextWriter 编写器）\r\n

在 System.Web.UI.Page.ProcessRequestMain（布尔 includeStagesBeforeAsyncPoint，布尔 includeStagesAfterAsyncPoint）"

* * *

任何想法都会有帮助:)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-02-17T17:03:13.130

你升级到 RC1 刷新了吗？这是一个已知的错误，并已被修复。

[http://haacked.com/archive/2009/01/30/aspnetmvc-refresh.aspx](http://haacked.com/archive/2009/01/30/aspnetmvc-refresh.aspx)

# user-interface - 帮助！如何创建 UI 技术规范

> ID：556991
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-02-17T14:16:51.410
> 
>         
> 
> 标签：user-interface, specifications

废话。我的任务是为我正在开发的 UI 创建技术规范。这是我的第一份真正的开发人员工作，在查看了项目后端的技术规范后，我感觉有点头晕目眩。在奶牛回家之前，我可以制作模型和线框，但我不确定如何将所有这些信息放在一起。

有谁知道一个好的资源或者可能是 UI 技术规范的一个很好的例子？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-02-17T14:23:35.293

不确定这是否有帮助，但我喜欢 mozilla 项目如何在他们的 wiki 上详细说明 ui 规范。

示例：[https ://wiki.mozilla.org/Mobile/UI/Designs/TouchScreen](https://wiki.mozilla.org/Mobile/UI/Designs/TouchScreen)

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-02-17T14:31:37.223

您可以查看[OpenOffice 的通用用户界面规范以](http://specs.openoffice.org/ui_in_general/index.html)获得想法。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2010-06-02T23:35:03.110

线框/模型是正确的最重要的事情（它们从*用户的角度*呈现功能）

我有一篇关于创建线框的博客文章，它描述了您可以使用的许多不同工具（从 Word 到 Visio），这样您就可以选择任何您觉得最舒服的工具：http: [//pm4web.blogspot.com/2008/ 10/wireframes-and-mockups-part-1.html](http://pm4web.blogspot.com/2008/10/wireframes-and-mockups-part-1.html)

还可以在软件规范样式上尝试 joel：http: [//www.joelonsoftware.com/articles/fog0000000036.html](http://www.joelonsoftware.com/articles/fog0000000036.html)

对于初学者来说，这是一个非常好的基本规范样式（这是我开始的）

希望这可以帮助

LM

# c++ - 如何在 MFC 中创建 guid

> ID：556997
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-02-17T14:17:14.153
> 
>         
> 
> 标签：c++, mfc, guid

我需要能够即时创建指南。有没有办法在 MFC 中做到这一点？我看到如何在.net 中做到这一点，但我们还没有去那里。如果没有，您是否有一些我可以使用的代码的指针？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2013-01-31T10:33:45.567

```
 //don't forget to add Rpcrt4.lib to your project

    CString m_ListID(L"error");
    RPC_WSTR guidStr;
    GUID guid;
    HRESULT hr = CoCreateGuid(&guid);
    if (hr == S_OK)
    {
        if(UuidToString(&guid, &guidStr) == RPC_S_OK)
        {
            m_ListID = (LPTSTR)guidStr;
            RpcStringFree(&guidStr);
        }
    } 
```

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2009-02-17T14:27:27.077

```
GUID guid;
HRESULT hr = CoCreateGuid(&guid); 

// Convert the GUID to a string
_TUCHAR * guidStr;
UuidToString(&guid, &guidStr); 
```

应用程序负责调用`RpcStringFree`以释放分配给 StringUuid 参数中返回的字符串的内存。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-02-17T14:22:21.833

您可以使用 COM 函数 CoCreateGuid，例如：

```
GUID guid;
HRESULT hr = CoCreateGuid(&guid); 
```

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-02-17T14:20:48.733

使用函数 UuidCreate 生成 GUID：

```
UUID generated;

if (::UuidCreate(&generated) != RPC_S_OK)
throw std::exception(...); 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2015-10-08T08:30:25.853

您可以使用此示例

```
WCHAR       GuidText[250] ={0};
UUID        uuid;

CoCreateGuid (&uuid);
wsprintf(
        GuidText,
        L"%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X",
        uuid.Data1,
        uuid.Data2,
        uuid.Data3,
        uuid.Data4[0], uuid.Data4[1],
        uuid.Data4[2], uuid.Data4[3], uuid.Data4[4], uuid.Data4[5], uuid.Data4[6], uuid.Data4[7]
        ); 
```***** 
```*``*************