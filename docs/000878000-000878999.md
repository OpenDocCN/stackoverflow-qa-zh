# StackOverflow 问答 000878000-000878999

# .net - 用于应用程序的 extjs（也带有嵌入式 http 服务器）

> ID：878000
> 
> 赞同：1
> 
> 时间：2009-05-18T14:21:20.727
> 
> 标签：.net, extjs, embeddedwebserver

是否有一个框架可以轻松地将 ExtJS 添加到普通的 .Net 应用程序中。这样我只需要创建一次 GUI，然后可以通过嵌入式网络服务器访问它。这很棒，因为我可以远程访问服务器/服务/应用程序以及在本地处理它。

我的梦想解决方案是： - 当本地 http 连接完成时，框架以某种方式将现有的 GUI（winforms）转换为 ExtJS。这样我就可以使用标准的 GUI 工具来开发应用程序，并相信框架会在 http 请求完成时执行其转换魔法。

一个不太可取但也很酷的解决方案是： - 框架公开 ExtJS 之类的类，我在这些类上实例化和定义属性（如画布、按钮等）和回调（事件）。然后这些类用于在建立连接时创建 extjs GUI。

最不受欢迎的解决方案是： - 必须手动进行 javascript 编码并处理传入的异步 ajax 调用，这样就可以完成所有接口的工作。

这样的东西已经存在了吗？或者这是我在接下来的 X 个月里要做的事情；^)

谢谢！

R

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-29T05:33:40.223

我建议您使用[http://liveui.net](http://liveui.net)框架。它提供基于 ASP.net 的控件，这些控件会自动转换为 Extjs 控件。我还包含用于快速应用程序开发的有用工具......它是免费的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T21:48:13.973

[http://www.visualwebgui.com/](http://www.visualwebgui.com/)

您可以尝试查看这个框架，它有点贵，但听起来就像您正在寻找的那样，减去 EXTJS

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T15:09:47.150

你最好的选择是[http://www.coolite.com/](http://www.coolite.com/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-26T06:56:40.460

您可能想在这里重新考虑您的要求。WinForms 模型与 ExtJS 模型或传统的 HTML 表单有很大不同，因此将您的应用程序动态转换为 Web 应用程序充其量是很困难的。自从我自己查看 ExtJS 已经有一段时间了，但是它是否具有所有标准 WebForms 控件的等价物？第三方提供的用户控制和其他控制又如何呢？和所有者绘制的控件？

与其花几个月的时间在可能无法正常工作的事情上，我建议您考虑正确分层您的应用程序。如果您分离数据层并将其公开为某种 Web 服务，那么您可以轻松地使它们可用于 win 表单应用程序和 ExtJS Web 应用程序。只要您将业务逻辑和数据层保留在 Web 服务中，用户界面本身就应该很容易制作。可能很容易自动生成 web gui 将不值得花时间。

反正。如果您真的想采用这种方式，您可以考虑使用 Web 服务来描述您的 GUI，并即时构建您的 WinForms gui 和 ExtJS gui。这两种技术都支持在代码中构建表单，因此您可以下载描述 gui 的文件并在用户第一次加载您的应用程序时构建它。这将需要您编写两组 gui 构建代码，但由于它将基于您控制的格式，因此可能比直接将 WinForms 应用程序转换为 ExtJS 更容易。

# java - 如何检测类路径中的重复 JAR？

> ID：878003
> 
> 赞同：27
> 
> 时间：2009-05-18T14:21:48.277
> 
> 标签：java, jar, classpath

有没有人有代码来检测类路径中的重复 JAR？

背景：当类路径中有同一个 JAR 的两个版本时，可能会发生非常奇怪的事情。这甚至在使用 Maven 之类的工具时也会发生：更改依赖项并构建 WAR 而无需先清理。由于`target/webapp/WEB-INF/lib`没有清理，依赖项将在那里两次。

这有安全网吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-05-18T14:28:57.887

[JBoss Tattletale](http://www.jboss.org/tattletale)可能会帮助您。

它是一个免费工具，可以扫描您的项目使用的 JAR 文件并为您提供有关它们的报告。

它的特点包括：

*   发现一个类是否位于多个 JAR 文件中
*   发现同一个 JAR 文件是否位于多个位置
*   查找具有不同版本号的类似 JAR 文件

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-05-02T09:10:08.620

有一个 Maven 插件可以做到这一点：[maven-duplicate-finder-plugin](https://github.com/ning/maven-duplicate-finder-plugin)

**[编辑]**如果您想自己在单元测试中进行，请使用

```
getClass().getClassLoader().getResources( "com/pany/package/Java.class" ) 
```

如果这返回多个`URL`，则您在类路径上有重复项。

缺点是这只适用于您过去有冲突的情况。从积极的方面来说，它只是几行代码（或者当您编写辅助方法时只需一行代码），它就可以在您的构建服务器上运行。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T14:29:14.640

`System.getProperty("java.class.path")`，拆分，排序，用肉眼看:-)。

它不会包含从其他 jars 中的清单派生的类路径：-(。

或者使用[http://www.jboss.org/tattletale](http://www.jboss.org/tattletale)作为其中一张海报的建议。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T14:23:26.463

我认为*最简单*的方法是首先简单地删除目标目录。希望复制所有 .jar 文件不会很耗时。

否则，您将不得不以某种方式比较相当大的文件（无论是直接的，通过计算的校验和或类似的）。这听起来一点都不好。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2009-05-18T14:26:23.617

您可以编写一个简单的脚本来将每个 jar 文件的 md5 总和与每个其他 jar 文件进行比较，并在此过程中删除重复项。

# c# - 以编程方式安装证书吊销列表 (CRL)

> ID：878010
> 
> 赞同：8
> 
> 时间：2009-05-18T14:22:26.637
> 
> 标签：c#, powershell, scripting, vbscript, batch-file

我需要每周下载和安装大约 50 个 CRL，并将它们安装在多个 Windows 服务器上。下载是很容易的部分，有没有办法可以编写 CRL 导入过程的脚本？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-08-06T17:50:17.293

这是我的最终来源（稍微为公众擦洗）-但应该可以。我不会更改已接受的答案，但我确实希望这会有所帮助（就像支持问题和答案一样！）。

**注意：**这会将 CRL 或常规证书导入 LOCAL MACHINE 受信任的根存储。将以下内容更改`CERT_SYSTEM_STORE_LOCAL_MACHINE`为`CERT_SYSTEM_STORE_CURRENT_USER`调用 CertOpenStore 会将其更改为适用于当前用户存储。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Runtime.InteropServices;

namespace ConsoleApplication2
{
  class Program
  {
    public struct CRYPTUI_WIZ_IMPORT_SRC_INFO
    {
      public Int32 dwSize;
      public Int32 dwSubjectChoice;
      [MarshalAs(UnmanagedType.LPWStr)]public String pwszFileName;
      public Int32 dwFlags;
      [MarshalAs(UnmanagedType.LPWStr)]public String pwszPassword;
    }

    [DllImport("CryptUI.dll", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern Boolean CryptUIWizImport(
      Int32 dwFlags,
      IntPtr hwndParent,
      IntPtr pwszWizardTitle,
      ref CRYPTUI_WIZ_IMPORT_SRC_INFO pImportSrc,
      IntPtr hDestCertStore
    );

    [DllImport("CRYPT32.DLL", CharSet = CharSet.Auto, SetLastError = true)]
    public static extern IntPtr CertOpenStore(
      int storeProvider,
      int encodingType,
      IntPtr hcryptProv,
      int flags,
      String pvPara
    );

    public const Int32 CRYPTUI_WIZ_IMPORT_SUBJECT_FILE = 1;
    public const Int32 CRYPT_EXPORTABLE = 0x00000001;
    public const Int32 CRYPT_USER_PROTECTED = 0x00000002;
    public const Int32 CRYPTUI_WIZ_NO_UI = 0x0001;

    private static int CERT_STORE_PROV_SYSTEM = 10;
    private static int CERT_SYSTEM_STORE_CURRENT_USER = (1 << 16);
    private static int CERT_SYSTEM_STORE_LOCAL_MACHINE = (2 << 16);

    static void Main(string[] args)
    {
      if (args.Length != 1)
      {
        Console.WriteLine("Usage: certimp.exe list.crl");
        Environment.ExitCode = 1;
      }
      else
      {
        IntPtr hLocalCertStore = CertOpenStore(
          CERT_STORE_PROV_SYSTEM,
          0,
          IntPtr.Zero,
          CERT_SYSTEM_STORE_LOCAL_MACHINE,
          "ROOT"
        );

        CRYPTUI_WIZ_IMPORT_SRC_INFO importSrc = new CRYPTUI_WIZ_IMPORT_SRC_INFO();
        importSrc.dwSize = Marshal.SizeOf(importSrc);
        importSrc.dwSubjectChoice = CRYPTUI_WIZ_IMPORT_SUBJECT_FILE;
        importSrc.pwszFileName = args[0];
        importSrc.pwszPassword = null;
        importSrc.dwFlags = CRYPT_EXPORTABLE | CRYPT_USER_PROTECTED;

        if (!CryptUIWizImport(
            CRYPTUI_WIZ_NO_UI,
            IntPtr.Zero,
            IntPtr.Zero,
            ref importSrc,
            hLocalCertStore
          ))
        {
          Console.WriteLine("CryptUIWizImport error " + Marshal.GetLastWin32Error());
          Environment.ExitCode = -1;
        }
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-19T00:13:56.707

我不知道如何通过脚本来做到这一点。你会写C代码吗？如果我了解您想要做什么，您将使用[CryptUiWizImport](http://msdn.microsoft.com/en-us/library/aa380598.aspx)函数和[CRYPTUI_WIZ_IMPORT_SRC_INFO](http://msdn.microsoft.com/en-us/library/aa380870(VS.85).aspx)结构。

这[是安装 Cert 的代码示例](http://blogs.msdn.com/alejacma/archive/2008/01/31/how-to-import-a-certificate-without-user-interaction-c-c.aspx)；相应的 CRL 导入类似。

**附录**：
[这篇文章](http://blogs.msdn.com/powershell/archive/2006/04/25/583236.aspx)指出 Win32 API（例如 CryptUiWizImport）不能直接从 PowerShell 访问，然后描述了一种可能的解决方法：从 PowerShell 脚本中，动态生成和编译执行 P/Invoke 内容的 C# 代码，然后运行生成的程序集。这将允许您严格从 powershell 脚本执行 CryptUiWizImport，尽管这将是一个非常奇特的脚本。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-14T11:21:12.133

嗯。有什么理由不使用 certutil.exe 实用程序？我可以通过运行以下命令将证书吊销列表导入适当的存储：

```
certutil -addstore CA <FileName>.crl 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-19T06:23:54.743

在 Powershell 中有一个`Cert:`提供者代表证书存储。操作它是通过标准 cmdlet 完成的，因此您可以在某处集成吊销列表。我只是不太了解 Windows 如何处理证书以提供进一步的帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-03T17:38:30.900

我们必须只使用 Win32 API 来执行此操作。没有一流的 C# 系统 API 可以做到这一点。参考[https://stackoverflow.com/a/67814697/3671594](https://stackoverflow.com/a/67814697/3671594)

# jquery - jQuery UI DatePicker：覆盖今天的 css

> ID：878011
> 
> 赞同：1
> 
> 时间：2009-05-18T14:22:35.607
> 
> 标签：jquery, css, user-interface, datepicker, overriding

我正在使用 beforeShowDay 突出显示我的 jQuery 日期选择器中的特殊日子。我能够更改背景的唯一方法是在我的 css 类中使用“！important”标签。这适用于除“今天”之外的所有日子。css 不改变背景颜色，只改变边框。

我的CSS：

```
.genEvent a
{
border:solid 1px #DC143C !important;
background: #9696BA url(ui-bg_flat_75_9696BA_40x100.png) 50% 50% repeat-x !important;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T14:29:21.317

您可以尝试进一步限定选择器。

例如：

```
body contentDiv .genEvent a
{
    border:solid 1px #DC143C !important;
    background: #9696BA url(ui-bg_flat_75_9696BA_40x100.png) 50% 50% repeat-x !important;
} 
```

如果可行，您可以删除另一个`!important`，这是值得避免的，因为它有点[反模式](http://en.wikipedia.org/wiki/Anti-pattern)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T14:35:11.523

我在[这里](http://www.nabble.com/Re%3A-Highlighting-of-special-days-in-datepicker-p20068050s27240.html)找到了这个......可能对你有一些帮助。

> 为什么不使用日期选择器功能来突出显示特殊日子？我也使用内联日期选择器，显示特殊日子也很好。我使用类似于：

```
$("#mnu_calendar").datepicker({
  ... other options
  beforeShowDay: function(thedate) {
    var theday    = thedate.getDate();
    if( $.inArray(theday,specialDays) == -1 )
      return [true,""];
    return [true, "specialDate"];
  },
  ... more options
}); 
```

> specialsDays 是我的数组，包含本月的特殊日子，例如 [3, 12, 24]。“specialDate”是 CSS 类名称 datepicker 将添加到特殊日子，所以你可以让它们看起来像你想要的那样

# c++ - 几个用于重新定义向量排序函数顺序的函子

> ID：878022
> 
> 赞同：0
> 
> 时间：2009-05-18T14:24:40.500
> 
> 标签：c++

我有以下数据结构：

```
typedef vector< vector<int> > MxInt2d;
typedef vector< vector<double> > MxDouble2d;

 class QSweep{   
 public:
 ....
 static MxDouble2d myPoints_;
 MxInt2d myEdges_;
 MxInt2d sweepEvents;

 class order{
 public:
    bool operator() (const vector<int>& edge1, const vector<int>& edge2){
            return (myPoints_[edge1[0]][0]<myPoints_[edge2[0]][0])|| 
                       (myPoints_[edge1[0]][0]==myPoints_[edge2[0]][0]&& 
                        myPoints_[edge1[0]][1]<myPoints_[edge2[0]][1]) 
                   ||
                    (myPoints_[edge1[0]][0]==myPoints_[edge2[0]][0]&& 
                         myPoints_[edge1[0]][1]==myPoints_[edge2[0]][1]&& 
                     getSlope(myPoints_[edge1[0]][0],myPoints_[edge1[0][1],  
                                  myPoints_[edge1[1]][0],myPoints_[edge1[1]][1])
                     <
                         getSlope(myPoints_[edge2[0][0],myPoints_[edge2[0][1],    
                                  myPoints_[edge2[1]][0],myPoints_[edge2[1]][1]));
                    }
};
static double getSlope(double a, double b, double c, double d);
static double computeDet(double a, double b, double c, double d, double x, double y); 
```

};

在以下列方式定义构造函数时，我使用了 order() 的仿函数：

```
 QSweep::QSweep(const MxDouble2d& myPoints, const MxInt2d& myEdges){ 
....
    //code here for initializing myPoints_, myEdges_
sort(myEdges_.begin(),myEdges_.end(),order());
 } 
```

通过这种方式，我的数据 myEdges_ 在使用仿函数 order() 初始化时被排列。现在我想使用完全不同的标准来安排数据 sweepEvents（它与 myEdges_ 具有相同的类型，使用来自 C++ 向量的预定义数据类型），即我不想使用函数 getSlope(...) 但函数用于扫描事件的computeDet(...)。所以我在想我仍然需要其他仿函数来重新定义矢量数据类型的 < of sort() 对吗？所以我必须编写一个新的仿函数 order1()，在其中我使用用 computeDet(...) 计算的数据，然后我在我的 sweepEvents 数据类型上调用排序：

```
 sort(sweepEvents.begin(),sweepEvents.end(),order1()); 
```

我不确定这是否是好的解决方案？如果我对函子使用不同的名称，我可以通过几种方式重新定义 <？有人有一些建议，我将不胜感激。提前谢谢你，马达琳娜

不，这两个仿函数不使用任何通用代码。我在 QSweep 类中编写了第二个仿函数，如下所示：

```
 class orderDet{
public:
    bool operator() (const vector<int>& edgeSW1, const vector<int>& edgeSW2   
                              ,const vector<int>& edgeC){
        return  
          (
          computeDet(myPoints_[edgeSW1[0]],myPoints_[edgeSW1[1]],myPoints_[edgeC[0]]) 
           < 
          computeDet(myPoints_[edgeSW2[0]],myPoints_[edgeSW2[1]],myPoints_[edgeC[0]])
           );
  }} 
```

我这样称呼它：

```
 sort(sweepEvents.begin(), sweepEvents.end(), orderDet()); 
```

但是我得到了以下编译错误：

```
 error: no match for call to '(QSweepComplete::orderDet) (std::vector<int,  
 std::allocator<int> >&, std::vector<int, std::allocator<int> >&)'
 ./QSweepComplete.h:68: note: candidates are: bool 
 QSweepComplete::orderDet::operator()(const std::vector<int, std::allocator<int>>&,   
 const std::vector<int, std::allocator<int> >&, const std::vector<int, 
 std::allocator<int> >&) 
```

我猜参数不匹配，因为 orderDet(...., edgeC) 的第三个参数不是 sweepEvents 列表的一部分，而是变量 myEdges_ 的一部分...也许有人可以给我一些建议关于如何实现这个函子？

先感谢您。最好的祝愿，马达琳娜

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T14:29:33.003

如果您有 2 个不同的排序标准，那么您应该有 2 个不同的函子。

给他们起有意义的名字，例如：

OrderBySlopes 和 OrderByXYZ

如果 2 个仿函数使用一些通用代码，您可以将其重构出来。即进入基类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T14:59:00.180

What [Glen](https://stackoverflow.com/questions/878022/several-functors-for-redefining-order-for-sort-function-of-vector/878046#878046) said.

If you really really insist on having one function do double duty, you can rely on having different parameter types to overload two versions of operator().

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T07:57:06.667

你`orderDet::operator()`需要三个论点。`std::sort`只需要两个来比较两个值。

一个解决方案可能是将边向量添加为仿函数的成员：

```
struct orderDet {
    const vector<int>& edges;
    orderDet( const vector<int>& edges ):edges(edges){};

    bool operator()( const vector<int>& v1, const vector<int>& v2 ) const {
       ....
    }
 }; 
```

顺便说一句，如果您希望人们在阅读您的代码时理解它，我宁愿认为您应该为内部向量使用 typedef 而不是外部向量。接下来，最好定义一个包含“第一”和“第二”点的结构，而不是只使用前两个点的非常通用的向量。它也会使您的代码更具可读性。

问候。

# visual-studio-2005 - Visual Studio 2005 安装程序在重新启动后启动

> ID：878025
> 
> 赞同：0
> 
> 时间：2009-05-18T14:25:28.690
> 
> 标签：visual-studio-2005

我最近重新安装了 Visual Studio，我的机器在安装过程中死机了。虽然当我下次运行安装程序时设置成功完成，但每次重新启动时都会弹出“配置 Visual Studio 2005”窗口。对我来说，这似乎是某个地方的注册表项（运行一次？），但我不确定。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T14:31:37.943

这是一个链接，其中列出了注册表中可能导致某些东西在启动时运行的所有位置：

[http://support.microsoft.com/kb/137367](http://support.microsoft.com/kb/137367)

我还会检查您的 Start->Programs->Startup 目录，看看是否有任何东西。

如果一切都失败了，运行 MSCONFIG 并查看那里的启动项，看看你是否看到它。

# entity-framework - 实体框架在插入数据库时 是否保留顺序？

> ID：878026
> 
> 赞同：1
> 
> 时间：2009-05-18T14:25:34.337
> 
> 标签：entity-framework, insert, identity-column

我们计划在我们的 sql server 数据库中使用标识列。目前我们正在使用 guids 来生成唯一的 id，但事实证明，排序是相关的，所以我们考虑切换到身份列。

由于排序是相关的，我们希望确保我们将对象添加到实体上下文的顺序也是它们插入数据库的顺序。这是相关的，因为 sql server 将为标识列生成值。

这是由实体框架保证的吗？如果不是，那么为从不同进程更新的数据库生成您自己的唯一整数 ID 的有效解决方案是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T14:28:05.500

我不会依赖插入顺序作为您返回的记录的顺序。当然，它在大多数情况下都会起作用，但是如果您需要在某处插入一行怎么办？我会说你最好的选择是添加一个序数列并积极为每一行生成序数，因为你希望它们被返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T14:31:53.497

我只是在这里猜测（虽然它应该很容易测试），但我认为 EF 不能保证顺序。我很确定内部结构基于一个 IEnumerable 类型，可能是一个 List，它只是在插入过程中被枚举，并且据我所知，枚举不能保证每次都以相同的顺序排列。

相反，我会在您的数据库表中添加一个专用的“排序顺序”列，并在那里获取它。

# c# - 以编程方式批处理文件以在夜间复制

> ID：878032
> 
> 赞同：2
> 
> 时间：2009-05-18T14:26:35.723
> 
> 标签：c#, asp.net, directory, xcopy

我需要创建一个 Intranet 网站（页面），它允许用户指示要复制到生产位置的本地网络文件夹。目前这是在批处理文件中使用 xcopy 手动完成的。

我正在寻找的是触发副本的方法，因此它是在半夜完成的，以及一种复制文件的方法。我想我可以从我的应用程序运行 xcopy，但这是一个好方法吗？我应该使用 System.IO 名称空间对象来复制文件吗？有没有更好的方法？

该应用程序将使用 C# 和 ASP.NET 编写。我们目前使用 .NET 2.0/3.0，但如果 .NET 3.5 包含更好的解决方案库，我没有问题。

基本上，用户将指示他们需要复制哪个网络文件夹以及一些其他业务信息。指示的文件夹和所有子文件夹都需要复制到目标位置（不是由用户设置的）。

如果已经有一个应用程序可以做到这一点，我也不反对。我不需要写已经存在的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T14:31:13.047

对于第一个问题（午夜复制），我建议设置一个运行现有批处理文件（或任何程序，就此而言）的计划任务

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T14:30:23.233

对于调度部分，您可以使用[Quartz.NET](http://quartznet.sourceforge.net/)

使用 System.IO 在 C# 中编写 xcopy 操作并不难。事实上，这会给你最大程度的灵活性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T14:36:48.557

最简单的解决方案是将您的 xcopy 命令包装在一个命令文件中，并安排它在您想要的任何时候作为您的 Web 服务器上的计划任务运行。

如果你想变得花哨，你可以为任务调度程序编写一个 Web 界面——我很确定我也见过这种类型的应用程序的开源示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T14:37:22.613

我认为您应该考虑使用[Windows Powershell](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)进行复制（或其他脚本语言，如果您愿意），由[Windows Scheduled Tasks](http://technet.microsoft.com/en-us/library/cc786711(WS.10).aspx)驱动。尽管您可以编写一个应用程序来执行此操作，但我认为拥有一个其他人可以编辑的脚本会更易于维护。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T14:37:57.790

您已标记此 ASP，但如果您不挑剔，我建议您将 Windows 内置计划任务和 rsync 结合使用。如果确实必须从 Intranet 页面自动执行（并且您在 IE 中），则需要某种形式的 ActiveX 或可下载的脚本/应用程序来配置计划。

# java - 为什么多线程似乎不能加速我的 Web 应用程序？

> ID：878035
> 
> 赞同：2
> 
> 时间：2009-05-18T14:26:45.393
> 
> 标签：java, performance, multithreading

```
class ApplicationContext{
    private final NetworkObject networkObject = new networkObject();

    public ApplicationContext(){
      networkObject.setHost("host");
      networkObject.setParams("param");
    }

    public searchObjects(ObjectType objType){
        networkObject.doSearch(buildQuery(objType));
    }
}

class NetworkObject{
    private final SearchObject searchObject = new SearchObject();

    public doSearch(SearchQuery searchQuery){
        searchObject.search(searchQuery); //threadsafe, takes 15(s) to return
    }
} 
```

考虑一个运行 Web 应用程序的 Web 服务器，它只创建一个 ApplicationContext 实例（单例）并使用相同的 applicationInstance 来调用 searchObjects，例如

```
 ApplicationContext appInstance = 
                  ApplicationContextFactory.Instance(); //singleton 
```

对网页的每个新请求都说“search.jsp”会调用

```
 appInstance.searchObjects(objectType); 
```

我正在向“search.jsp”页面发出 1000 个请求。所有线程都使用同一个 ApplicationContext 实例，searchObject.search() 方法需要 15 秒才能返回。我的问题是当一个已经在执行 searchObject.search() 函数或所有线程将同时执行 searchObject.search() 时，所有其他线程是否等待轮到它们（15 秒）执行，为什么？

我希望我已经把我的问题说得很清楚了？？

**更新：** 感谢大家澄清我的疑问。这是我的第二个问题，当我这样做时应该观察到哪些性能差异：

```
public synchronized doSearch(SearchQuery searchQuery){
    searchObject.search(searchQuery); //threadsafe, takes 15(s) to return
} 
```

**或者**

```
public doSearch(SearchQuery searchQuery){
    searchObject.search(searchQuery); //threadsafe, takes 15(s) to return
} 
```

我相信使用没有同步关键字的函数“doSearch”应该会提供更多的性能。但是，当我今天测试它时，结果却相反。当我使用同步关键字时，性能相似或有时更好。

任何人都可以解释这种行为。我应该如何调试这种情况。

问候，

佩里

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T14:30:18.587

好吧，您没有在代码中*指定*任何同步，所以如果没有任何其他证据，我怀疑所有线程都会同时运行。如果`SearchObject.search`包含一些同步，那显然会限制并发性。

请注意，您的 JSP 容器可能正在使用线程池来处理 1000 个请求，而不是创建 1000 个线程。

编辑： 至于为什么它可能会更快`synchronized`：有时并发实际上对吞吐量没有帮助。上下文切换、磁盘瓶颈、缓存未命中等都会产生这种影响。拥有比内核更多的运行线程通常不是一个好主意*。*

举一个现实生活中的例子，假设你有一千名购物者都想从一家相当小的商店买东西。你会怎么做？将 1000 个全部同时放入店内，还是在任何时候将其压缩到店内的一个相当小的数量，然后在外面排队？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T16:17:22.300

意识到性能与给定环境相关是明智的。在这种情况下，它可能是您的笔记本电脑或测试服务器上的软件性能。在考虑优化代码之前检查类似于生产环境的性能是明智的，因为那里的瓶颈可能与开发机器上的完全不同。

举个例子; 当我在笔记本电脑上使用大型数据库测试我的软件时，我总是最终受到硬盘 IO 的限制。然而，在生产中，数据库服务器有足够的内存和快速的磁盘，因此优化我的 IO 软件是不明智的。

与线程类似；我笔记本电脑中的处理器可以同时运行一个或两个进程。拥有 8 个线程并不能加快速度。然而，生产机器很可能能够同时处理 8 个线程。

我认为比性能更重要的是语义。使用 synchronous 之类的关键字不仅对编译器具有指导意义，而且对（下一个）开发人员也具有指导意义。

通过使用同步，您可以与 ApplicationContext 上的所有其他同步方法共享一个锁，这些方法也可能与 searchObject 无关。就我个人而言，我非常怀疑您是否希望在名为 ApplicationContext 的对象上进行同步。

如果 searchObject 不是线程安全的，我可能会推荐一个锁定对象。这涉及到口味：

```
public void doSearch(SearchQuery searchQuery){
   synchronized(searchObject) {// Only if searchObject is guaranteed to be null
       searchObject.search(searchQuery); //threadsafe, takes 15(s) to return
  }
} 
```

或者

```
public class ApplicationContext {
    private SearchObject searchObject = null;
    private final Object searchObjectLock = new Object();    

    public void doSearch(SearchQuery searchQuery){
       synchronized(searchObjectLock) {
           searchObject.search(searchQuery); //threadsafe, takes 15(s) to return
      }
    }
} 
```

不要忘记锁定每次使用 searchObject 以防止线程麻烦。使用这种细粒度的锁定机制，您至少可以使 ApplicationContext 对不需要 searchObject 相关功能的类可用。

在您的情况下，我不会使用任何同步，因为它不是必需的，并在确定瓶颈之前检查类似生产的硬件。

如果 searchObject 使用数据库，请确保数据库是属性索引并使用该索引。如果它需要进行 1000 次全表扫描，无论如何它都不会很快......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:30:40.427

在您的情况下，它们都将同时执行。

如果您想防止这种情况发生，则需要进行某种同步以防止这种情况发生（例如，将方法声明为同步或使用锁）。

预计到达时间：

如果将 doSearch() 方法声明为同步，则一次只能有一个线程可以调用它。其他线程将阻塞，直到第一个线程完成，等待的线程将一次“进入”一个。可以想象，如果您有很多线程调用该函数，这将降低您的性能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T14:30:53.983

如果您没有同步，那么每个线程将同时运行并且不会阻塞锁。

注意

```
// threadsafe 
```

（如评论）意味着它可以在多个线程访问它时正常工作 -**而不是**它会阻塞线程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T14:32:01.220

他们都可以同时执行它，除非它被声明为同步，不管你的类是一个单例 IIRC。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T14:32:19.690

如果 SearchObject.search 是同步的，那么是的。否则，请尝试一下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T14:55:06.117

为什么需要 15 秒？如果它正在等待磁盘访问并且您只有一个磁盘，那么无论您有多少线程，您都会受到磁盘寻道速度的限制。在这种情况下，更多线程甚至可能更慢。

# msbuild - MSBuild MSBuildCommunityTasks 任务时间

> ID：878037
> 
> 赞同：17
> 
> 时间：2009-05-18T14:27:31.213
> 
> 标签：msbuild, msbuild-task, msbuildcommunitytasks

我有一个 MSBuild 项目，我希望将当前日期添加到我正在创建的 zip 文件中。

我正在使用 MSBuildCommunityTasks。

```
<!-- Import the CommunityTasks Helpper -->
<Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets" /> 
```

在网站[http://msbuildtasks.tigris.org/](http://msbuildtasks.tigris.org/)上，我可以看到一个名为 time 的任务。我一直无法找到有关如何使用 Time 的文档。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2011-07-11T21:04:16.000

[在 msbuild 4 中，您现在可以](http://blogs.msdn.com/b/msbuild/archive/2010/04/02/msbuild-property-functions.aspx)

```
$([Namespace.Type]::Method(..parameters…))
$([Namespace.Type]::Property)
$([Namespace.Type]::set_Property(value)) 
```

所以我正在使用

```
$([System.DateTime]::Now.ToString(`yyyy.MMdd`)) 
```

格式周围的那些刻度不是反引号`'`

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-05-18T14:38:08.850

```
<?xml version="1.0" encoding="utf-8"?>

<Project DefaultTargets="Deploy" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

<Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/>

  <!-- Include MSBuild tasks here -->

  <ItemGroup>     
      <DefaultExclude Include="****" />           
  </ItemGroup>

 <Target Name="Deploy" >

    <Time Format="yyyy-MM-dd">
    <Output TaskParameter="FormattedTime" PropertyName="buildDate" />
    </Time>

    <Message Text="Deploying ...."></Message>   

    <Copy  SourceFiles="@(DeploymentFiles)" DestinationFolder="C:\CCNET\$(buildDate)\bin\" />

</Target>

</Project> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-12T16:28:19.727

马斯洛的回答是正确的（我不能评论或者我会）；我只想补充一点，在隐式调用 System.DateTime.Parse 时必须小心。

像这样的已解析字符串值`$([System.DateTime]::Parse("1970-01-01T00:00:00.0000000Z")`似乎不会以 Kind of 结尾`DateTimeKind.Utc`。

但是您可以使用[嵌套的属性函数](https://msdn.microsoft.com/en-us/library/dd633440.aspx#Anchor_1)来使其工作；像这样（获取 Unix 时间戳）：

`$([System.DateTime]::UtcNow.Subtract($([System.DateTime]::Parse("1970-01-01T00:00:00.0000000Z").ToUniversalTime())).TotalSeconds.ToString("F0"))`

# apache-flex - 如何在自定义 MXML 标记中填充所需参数？

> ID：878043
> 
> 赞同：3
> 
> 时间：2009-05-18T14:28:59.947
> 
> 标签：apache-flex, components

这是课程：

```
package fnc {
    import mx.containers.Canvas;

    public class Deck extends Canvas {

        protected var _chipCount:int;

        public function Deck(chipCount:int) {
            /* Associate some chips with this deck */
            _chipCount = chipCount;
        }

        public function get chipCount():int {
            return _chipCount;
        }
    }
} 
```

这是 MXML：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" xmlns:ns1="fnc.*">
    <ns1:Deck horizontalCenter="0" verticalCenter="0">
    </ns1:Deck>
</mx:Application> 
```

运行这个应用程序得到这个错误：

ArgumentError：错误 #1063：fnc::Deck() 上的参数计数不匹配。预期为 1，在 mx.core::Container/createComponentFromDescriptor()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\Container.as:3579] 处得到 0。 :Container/createComponentsFromDescriptors()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\Container.as:3493] 在 mx.core::Container/createChildren()[C:\autobuild \3.2.0\frameworks\projects\framework\src\mx\core\Container.as:2589] 在 mx.core::UIComponent/initialize()[C:\autobuild\3.2.0\frameworks\projects\framework\ src\mx\core\UIComponent.as:5370] 在 mx.core::Container/initialize()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\Container.as:2526 ] 在 mx.core::Application/initialize()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\core\Application.as：[http://www.adobe.com/2006/flex/mx/internal::childAdded()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\managers\SystemManager.as:2009](http://www.adobe.com/2006/flex/mx/internal::childAdded()[C) ]在 mx.managers::SystemManager/initializeTopLevelWindow()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\managers\SystemManager.as:3234] 在 mx.managers::SystemManager/ [http:// /www.adobe.com/2006/flex/mx/internal::docFrameHandler()[C](http://www.adobe.com/2006/flex/mx/internal::docFrameHandler()[C) :\autobuild\3.2.0\frameworks\projects\framework\src\mx\managers\SystemManager.as:3064] 在 mx。 manager::SystemManager/docFrameListener()[C:\autobuild\3.2.0\frameworks\projects\framework\src\mx\managers\SystemManager.as:2916]

像这样添加`chipCount="0"`到 MXML：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" xmlns:ns1="fnc.*">
    <ns1:Deck chipCount="0" horizontalCenter="0" verticalCenter="0">
    </ns1:Deck>
</mx:Application> 
```

得到这个编译错误：

严重性和描述路径资源位置创建时间 ID 属性“chipCount”是只读的。practice/src Practice.mxml 第 3 行 1242656555328 26

如何指定初始筹码数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T14:39:18.647

在 MXML 中声明元素时，不能将参数传递给元素的构造函数。您需要一个空的构造函数，然后有一个名为 ChipCount 的属性。您的代码还必须更新以处理未设置（或设置为 0）的 ChipCount。

我的建议是将 Deck 更改为以下内容：

```
public class Deck extends Canvas {

    protected var _chipCount:int;

    public function Deck() {
        _chipCount = 0; // Default ChipCount and wait for it to be set.
    }

    public function get chipCount():int {
        return _chipCount;
    }

    public function set chipCount(value:int):int {
        // Add logic here to validate ChipCount before setting.
        _chipCount = value;

    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T08:53:45.943

回答 brd6644 评论：

```
package
{
    import mx.containers.Canvas;

    public class Deck extends Canvas
    {
        protected var _chipCount:int;
        private var chipCountChanged:Boolean;

        public function Deck()
        {
            super();
        }

        public function set chipCount(value:int):void
        {
            if (chipCount != value)
            {
                _chipCount = value;
                chipCountChanged = true;
                invalidateProperties();
                //call invalidateSize() if changing chipCount value may change the size of your component
                //call invalidateDisplayList() if changing chipCount value need a redraw of your component
            }
        }

        public function get chipCount():int
        {
            return _chipCount;
        }

        override protected function commitProperties():void
        {
            super.commitProperties();

            if (chipCountChanged)
            {
                chipCountChanged = false;
                //here update properties that change because of chipCount new value.
            }
        }

    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T14:43:20.133

我相信，如果您要扩展 UIComponent ，则无法将参数传递给构造函数-您必须找到另一种设置筹码计数的方法。我建议监听初始化事件，然后设置它：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Script>
   public function setChipCount():void{
     myDeck.chipCount = 0;
   }
</mx:Script>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" xmlns:ns1="fnc.*">
    <ns1:Deck id="myDeck" initalize="setChipCount()" horizontalCenter="0" verticalCenter="0">
    </ns1:Deck>
</mx:Application> 
```

# c# - 从应用程序中的任何地方访问数据库

> ID：878047
> 
> 赞同：2
> 
> 时间：2009-05-18T14:29:53.907
> 
> 标签：c#, database, oop

如果我想在 Delphi 中访问数据库，我可以将数据模块添加到项目中，从我的主窗体配置它，然后在应用程序的任何位置访问它；引用将存储在全局变量中。

我知道在 C# 和其他更现代的 OO 语言中，全局变量是不受欢迎的。那么如何从我需要的地方访问我的数据库呢？我遇到的最大问题是配置：位置、用户、密码等在设计时是未知的。

我现在有一个 db-class 并在需要时创建一个新实例，但是我必须将这些设置存储在一些全局可访问的东西中，我只是移动了问题。

标准解决方案是什么？

谢谢，问候，米尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T14:33:29.030

我总是使用[单例模式](http://www.yoda.arachsys.com/csharp/singleton.html)。至于配置，请查看**System.Configuration.ConfigurationManager**类，它允许您从项目的 app.config/web.config 文件中读取设置。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T15:04:34.087

在 OOP 中定义数据库访问的绝对最佳实践有点棘手。

您已经一针见血了，有很多因素需要考虑：

*   如何处理配置参数？
*   应用程序是多线程的吗？你需要数据库连接池吗？
*   您是否需要数据库可移植性（即：您在开发与生产中使用不同的数据库？您是否担心供应商锁定一个数据库？您是否将应用程序分发给可能使用不同数据库的其他用户？）
*   您是否关心保护您的 SQL 语句，或集中执行其他访问权限？
*   在执行某些插入和更新时是否涉及到常见的逻辑，而您不想在触及特定表的任何地方重复这些逻辑？

正因为如此，许多 OOP 人员倾向于使用 ORM 框架来解决最简单的情况。一般的想法是，您的应用程序逻辑在任何时候都不需要直接与数据库对话：尽可能长时间地将您的业务代码与实际的持久性机制隔离开来。

相反，尝试设计您的应用程序，以便您的业务逻辑与模型层对话。换句话说，在系统中拥有封装和描述您的业务数据的模型对象。然后这些模型对象公开用于获取它们的状态并将其保存到数据库中的方法，但您的逻辑不需要关心这些。

例如，假设您的系统中有一个名为“Person”的概念。您可能会将其建模为具有某些属性的类。在伪代码中：

```
Person:
    - first_name
    - last_name 
```

然后，您在系统中的实际代码只涉及实例化和使用 Person 对象，而不涉及获取 DB 句柄或编写 SQL：

```
p = Person.get(first_name='Joe')
p.last_name = 'Bloggs'
p.save() 
```

在面向对象的世界中，您会发现您的业务逻辑代码变得更简洁（并且更短！）、更易于维护且更可测试。

当然，您是对的，这意味着您现在需要构建一个数据库后端，将该`Person`类转换为关系数据库中的一个或多个表。这就是使用`ORM`框架派上用场的地方。在 Python 中，人们使用 Django 和 SQLAlchemy。我会让其他人指出人们在 C# 中使用什么（我不是 C# 开发人员，但你确实标记了你的问题`OOP`，所以我在这里寻求通用答案，而不是 C# 特定的）。

不过，重点是 ORM 框架将所有 DB 访问放在代码中的一组类中，以便在一个地方处理 DB 访问、配置和池……无需在整个过程中实例化它们。应用。您在“需要它的地方”使用的是模型对象。

当然，如果您的应用程序非常简单并且您只想要一个原始数据库句柄，那么我推荐其他人列出的依赖注入方法。

希望有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T14:32:38.317

我实际上使用了一个存储库类，它在其构造函数中接收数据库信息，并让需要它的类传入它。我实际上使用控制反转 (IOC) 工具来注入该值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T14:37:19.447

在我看来，您需要创建一个适当的对象（包含连接或类似对象），并将该实例传递给*每个需要访问的对象*（请参阅[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)）

这与使用单例不同。通过使用这种机制，它将使您摆脱对一个对象的依赖，并且（在这种情况下可能是一个更令人信服的原因）允许您通过注入模拟对象或类似对象来代替最初注入的数据库访问器对象来执行测试。在这种情况下，我肯定会回避单例机制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T14:33:35.833

您可以将用户信息存储在某个平面文件中，然后从您的 db-class 读取/写入它

这样您就不会复制代码中的设置，但用户仍然可以修改设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T15:19:56.130

[SubSonic](http://www.subsonicproject.com)是对象关系映射的“瑞士军刀”，提供执行存储过程并将结果返回到 List 的能力。您可以在半小时内启动并运行它。

# c++ - 递归删除注册表项

> ID：878057
> 
> 赞同：2
> 
> 时间：2009-05-18T14:31:09.847
> 
> 标签：c++, windows-mobile, registry

我需要在 Windows Mobile 6 下删除 Windows 注册表中的子树。RegDeleteTree 函数不可用，并且 SHDeleteKey（显然）在 WM6 SDK 下的任何静态库中都不可用，尽管声明在 shlwapi.h 中可用。
我试图从 shlwapi.dll 中获取它，比如

```
 typedef DWORD (__stdcall *SHDeleteKey_Proc) (HKEY, LPCWSTR);
    SHDeleteKey_Proc procSHDeleteKey; 
    HINSTANCE shlwapidll = ::LoadLibrary(_T("shlwapi.dll"));
    if(shlwapidll) {
    procSHDeleteKey = 
            (SHDeleteKey_Proc)GetProcAddress(shlwapidll,_T("SHDeleteKeyW"));
        ASSERT(procSHDeleteKey);
    } 
```

但我打了断言。
有没有一种好方法可以递归地删除 Windows Mobile 下的注册表项（无论是否为空）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T14:50:22.290

我想我自己在[MSDN](http://msdn.microsoft.com/en-us/library/ms724235(VS.85).aspx)中找到了答案。令我困惑的是，该功能无法通过 SDK 获得，但......
我也将 MSDN 中的代码放在这里，仅供记录：

```
//*************************************************************
//
//  RegDelnodeRecurse()
//
//  Purpose:    Deletes a registry key and all it's subkeys / values.
//
//  Parameters: hKeyRoot    -   Root key
//              lpSubKey    -   SubKey to delete
//
//  Return:     TRUE if successful.
//              FALSE if an error occurs.
//
//*************************************************************

BOOL RegDelnodeRecurse (HKEY hKeyRoot, LPTSTR lpSubKey)
{
    LPTSTR lpEnd;
    LONG lResult;
    DWORD dwSize;
    TCHAR szName[MAX_PATH];
    HKEY hKey;
    FILETIME ftWrite;

    // First, see if we can delete the key without having
    // to recurse.

    lResult = RegDeleteKey(hKeyRoot, lpSubKey);

    if (lResult == ERROR_SUCCESS) 
        return TRUE;

    lResult = RegOpenKeyEx (hKeyRoot, lpSubKey, 0, KEY_READ, &hKey);

    if (lResult != ERROR_SUCCESS) 
    {
        if (lResult == ERROR_FILE_NOT_FOUND) {
            printf("Key not found.\n");
            return TRUE;
        } 
        else {
            printf("Error opening key.\n");
            return FALSE;
        }
    }

    // Check for an ending slash and add one if it is missing.

    lpEnd = lpSubKey + lstrlen(lpSubKey);

    if (*(lpEnd - 1) != TEXT('\\')) 
    {
        *lpEnd =  TEXT('\\');
        lpEnd++;
        *lpEnd =  TEXT('\0');
    }

    // Enumerate the keys

    dwSize = MAX_PATH;
    lResult = RegEnumKeyEx(hKey, 0, szName, &dwSize, NULL,
                           NULL, NULL, &ftWrite);

    if (lResult == ERROR_SUCCESS) 
    {
        do {

            StringCchCopy (lpEnd, MAX_PATH*2, szName);

            if (!RegDelnodeRecurse(hKeyRoot, lpSubKey)) {
                break;
            }

            dwSize = MAX_PATH;

            lResult = RegEnumKeyEx(hKey, 0, szName, &dwSize, NULL,
                                   NULL, NULL, &ftWrite);

        } while (lResult == ERROR_SUCCESS);
    }

    lpEnd--;
    *lpEnd = TEXT('\0');

    RegCloseKey (hKey);

    // Try again to delete the key.

    lResult = RegDeleteKey(hKeyRoot, lpSubKey);

    if (lResult == ERROR_SUCCESS) 
        return TRUE;

    return FALSE;
}

//*************************************************************
//
//  RegDelnode()
//
//  Purpose:    Deletes a registry key and all it's subkeys / values.
//
//  Parameters: hKeyRoot    -   Root key
//              lpSubKey    -   SubKey to delete
//
//  Return:     TRUE if successful.
//              FALSE if an error occurs.
//
//*************************************************************

BOOL RegDelnode (HKEY hKeyRoot, LPTSTR lpSubKey)
{
    TCHAR szDelKey[MAX_PATH*2];

    StringCchCopy (szDelKey, MAX_PATH*2, lpSubKey);
    return RegDelnodeRecurse(hKeyRoot, szDelKey);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T14:49:46.003

的第二个参数`GetProcAddress`是 a `LPCSTR`（也就是说，它*不是*a `LPCTSTR`）。所以删除`_T()`并试试这个：

```
GetProcAddress(shlwapidll, "SHDeleteKeyW"); 
```

这有助于解决问题吗？

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2009-08-27T20:10:15.503

您正在寻找[RegDeleteTree](http://msdn.microsoft.com/en-us/library/aa379776%28VS.85%29.aspx) () 函数。只需用它替换 RegDeleteKey 即可。

显然，他们花了一段时间才弄清楚，所以如果你想支持 XP 或更早版本，你需要有自己的实现。

# apache - 启用 mod_deflate 以发送 Content-Encoding: gzip

> ID：878068
> 
> 赞同：6
> 
> 时间：2009-05-18T14:33:57.267
> 
> 标签：apache, deflate, mod-deflate

**编辑**我发现问题实际上是[php minify](http://code.google.com/p/minify/)。这是发送压缩的内容而不是 Apache。我会找到更多关于这个的。

根据[高性能网站](http://oreilly.com/catalog/9780596529307/)，如果我在 Apache 2.x 中启用 mod_deflate，通过添加以下行，它应该发送 gzipped/delfated 内容：-

```
AddOutputFilterByType DEFLATE text/html text/css application/x-javascript 
```

书上还说`gzip`比`deflate`.

我通过添加同一行在 httpd.conf 中启用。但是 Apache 发送`Content-Encoding: deflate`.

我使用 CURL 进行了测试： -

```
curl -i -H "Accept-Encoding: gzip" "http://192.168.1.33/s.js" >> e:\curl_log.txt 
```

它返回“压缩”内容。但是当我发送命令时： -

```
curl -i -H "Accept-Encoding: gzip, deflate" "http://192.168.1.33/s.js" >> e:\curl_log.txt 
```

它返回“放气”的内容。

因此，如果浏览器同时支持 deflated 和 gzipped，则 Apache 发送 deflated。如何告诉 Apache 更喜欢 gzip 而不是 deflate？

供参考： -

*   我在以下位置找不到任何内容： [http](http://httpd.apache.org/docs/2.0/mod/mod_deflate.html) ://httpd.apache.org/docs/2.0/mod/mod_deflate.html 。
*   Apache conf 中没有出现 no-gzip。
*   服务器：Apache/2.2.9 (Win32) PHP/5.2.6
*   FF 发送请求标头为：“Accept-Encoding: gzip, deflate”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-03-24T09:59:47.107

正如我所见，原因已经找到。为了进一步帮助摆脱可能的混淆：

*   mod_deflate 尽管它的名字目前只支持 gzip。

*   gzip 由于以下原因更“有效”

> deflate - 尽管它的名称是 zlib 压缩 (RFC 1950)，但应该使用（与 deflate 压缩 (RFC 1951) 结合使用），如 RFC 2616 中所述。然而，现实世界中的实现似乎在 zlib 压缩和（原始）放气压缩[3][4]。由于这种混淆，gzip 将自己定位为更可靠的默认方法（2011 年 3 月）。

gzip 和 zlib 是文件/流格式，默认情况下会环绕 deflate 并且除其他外添加校验和，使它们更安全且速度更慢。另一方面，尺寸的增加不应该引起任何关注。

另见[HTTP_compression - 维基百科](http://en.wikipedia.org/wiki/HTTP_compression#Content-coding_tokens)

*   deflate 会更“高效”（[关于 zlib 的常见问题 - “gzip”和“deflate”HTTP 1.1 编码有什么区别](http://www.gzip.org/zlib/zlib_faq.html#faq38)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T15:40:14.437

我怀疑你用来测试的任何东西都没有发送......

接受编码：gzip

...在请求标头中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:42:15.690

有关所有血腥细节，请参见[http://httpd.apache.org/docs/2.0/mod/mod_deflate.html](http://httpd.apache.org/docs/2.0/mod/mod_deflate.html)`no-gzip` - 您确定在配置中的其他地方没有出现吗？当你改变你的“浏览器”时会发生什么，例如通过使用`wget`不同的值`-U`？

# java - 延迟加载或不努力提高性能

> ID：878069
> 
> 赞同：2
> 
> 时间：2009-05-18T14:34:57.983
> 
> 标签：java, hibernate, lazy-loading

有人建议，为了提高我们系统的性能，应该全面使用延迟加载。也就是将带有“mappedBy”属性的 OneToOne 映射更改为 @OneToMany 映射。这是为了解决和停止从数据库加载不需要的数据，这会导致应用程序运行缓慢。

我们运行一个多层系统（基本上是 2 层）。我们有前端 - 使用 JSF 和包含业务和数据库访问层的后端。前后通信视图 EJB - 但 EJB 在其中没有真正的逻辑。使用的其他技术 - Spring 和 Hibernate

现在，在对该主题进行了一些阅读之后，似乎延迟加载的使用并不是灵丹妙药，因为它需要正确应用。对于每次延迟加载，都会发出一条 Select 语句来获取数据。还有一个问题是，如果前端访问要延迟加载的属性并且会话/连接在后端关闭，那么我们将得到一个空值。

以上是正确的担忧吗？

那么，在实施延迟加载解决方案或性能改进时，最好的方法/实践是什么？希望尽可能不要重做数据模型。

我最初的想法是与 DBA 团队合作，以了解两个系统之间发生的情况 - 查询的外观，我们如何使用数据等。识别问题点，检查 Hibernate 对象/查询以了解如何最好改进它。还要查看前端以确定数据从后端传递到前端以显示的内容和方式等。

好的方法/其他方法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T14:42:42.103

您应该做的第一件事是测量您的应用程序并找出导致性能问题的确切原因。

使用 JProfiler 之类的工具找出问题所在。

一旦你知道发生了什么，你就可以决定如何解决它。

在不知道导致性能问题的原因的情况下直接实施延迟加载方案将浪费您的时间。

如果您发现 DB 层是您的问题所在，那么您可以让 DBA 参与进来，看看您的架构/查询是否可以在做任何更激进的事情之前得到改进。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T14:50:22.460

It is true that if your fetching of data is slowing your load times down, then lazy loading is a great solution. But applying it across the board seems to be a premature optimization. You would probably want to impliment it for each set of data and then test to see if it speeds up the app. If it does not, then it is not a good candidate for the lazy loading.

The way I have implemented the lazy loading caused no change in the data tier. It was all down in the business logic and presentation controllers. As I am not familiar with EJB I am going to assume that this will work for your java app. Any way, When I implement the lazy loading, I load no data (atleat none of the data I am going to load lazily), until it is needed. Then I call the data tier and get my data (or a subset of the data).

As for the connection concern, you will need to put checks in place to test the data connection to see if it is closed. That is, is you are pooling the data connections. Then if the connection is closed, then reopen it. But as with the actual lazy loading implementation, this should be done in your logic classes and not in the front end, so you don't have to duplicate this functionality many times.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:41:53.740

延迟加载非常适合延迟昂贵的操作，但我同意您的结论，即它不是解决所有性能问题的灵丹妙药。

跟随你的直觉，先做一些分析，看看应用程序中真正的性能问题在哪里。事实证明，延迟加载某些数据将是一个很好的解决方案，或者它可能是完全不同的东西。在您开始分析和分析应用程序内部发生的事情之前，真的没有办法知道。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T14:46:02.517

这在很大程度上取决于您要做什么，很难说。你去找你的 DBA 的想法肯定会很有成效。人们唯一能做的就是提供一些例子。就我而言：

在以下场景中，延迟加载对我们来说是一个巨大的性能提升。我们有一棵巨大的树，有 15,000 个不同级别的节点。最初我们尝试加载整个树然后渲染它。花了很长时间。我们更改了代码以仅在用户扩展节点时才延迟加载分支。节点扩展需要稍长的时间，但应用程序整体感觉更快。在这种情况下，更改映射是有意义的

现在，如果您无论如何都需要处理整个树，因为它是您的业务逻辑所需要的，延迟加载不会有太大区别。在这种情况下，仅更改映射实际上是没有解决方案的，甚至可能更昂贵。

你需要稍微思考一下你的应用程序做了什么，它在哪里感觉很慢，你想要完成什么。拔出分析器也不是灵丹妙药。

如果没有来自您的应用程序的具体示例，那么说延迟加载是否有用是没有意义的。

# c# - 将 C++ 结构编组为 C# 的最有效方法是什么？

> ID：878073
> 
> 赞同：6
> 
> 时间：2009-05-18T14:35:56.220
> 
> 标签：c#, performance, pinvoke, marshalling

我即将开始阅读大量的二进制文件，每个文件都有 1000 条或更多记录。新文件不断添加，因此我正在编写一个 Windows 服务来监视目录并在收到新文件时对其进行处理。这些文件是使用 c++ 程序创建的。我已经在 c# 中重新创建了结构定义并且可以很好地读取数据，但我担心我这样做的方式最终会杀死我的应用程序。

```
using (BinaryReader br = new BinaryReader(File.Open("myfile.bin", FileMode.Open)))
{
    long pos = 0L;
    long length = br.BaseStream.Length;

    CPP_STRUCT_DEF record;
    byte[] buffer = new byte[Marshal.SizeOf(typeof(CPP_STRUCT_DEF))];
    GCHandle pin;

    while (pos < length)
    {
        buffer = br.ReadBytes(buffer.Length);
        pin = GCHandle.Alloc(buffer, GCHandleType.Pinned);
        record = (CPP_STRUCT_DEF)Marshal.PtrToStructure(pin.AddrOfPinnedObject(), typeof(CPP_STRUCT_DEF));
        pin.Free();

        pos += buffer.Length;

        /* Do stuff with my record */
    }
} 
```

我认为我不需要使用 GCHandle，因为我实际上并没有与 C++ 应用程序进行通信，一切都是通过托管代码完成的，但我不知道其他方法。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T14:43:39.683

使用`Marshal.PtrToStructure`比较慢。我发现以下关于 CodeProject 的文章比较（和基准测试）读取二进制数据的不同方法非常有帮助：

> [使用 C# 快速读取二进制文件](http://www.codeproject.com/KB/files/fastbinaryfileinput.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-18T14:42:46.487

对于您的特定应用程序，只有一件事会给您明确的答案：对其进行分析。

这里所说的是我在使用大型 PInvoke 解决方案时学到的经验教训。编组数据的最有效方法是编组可 blittable 的字段。这意味着 CLR 可以简单地执行相当于 memcpy 的操作，在本机代码和托管代码之间移动数据。简单来说，就是从你的结构中取出所有的非内联数组和字符串。如果它们存在于本机结构中，则使用 IntPtr 表示它们并按需将值编组到托管代码中。

我从未分析过使用 Marshal.PtrToStructure 与使用本机 API 取消引用该值之间的区别。如果通过分析将 PtrToStructure 显示为瓶颈，这可能是您应该投资的东西。

对于大型层次结构，按需编组与一次将整个结构拉入托管代码。在处理大型树结构时，我最常遇到这个问题。编组单个节点的速度非常快，如果它是 blittable 并且性能明智的话，它可以只编组你当时需要的东西。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T14:57:06.550

除了 JaredPar 的综合答案，您不需要使用`GCHandle`，您可以使用 unsafe code 代替。

```
fixed(byte *pBuffer = buffer) {
     record = *((CPP_STRUCT_DEF *)pBuffer);
} 
```

`GCHandle`/语句的全部目的`fixed`是固定/修复特定的内存段，使内存从 GC 的角度来看是不可移动的。如果内存是可移动的，那么任何重定位都会使您的指针无效。

不确定哪种方式更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T14:43:53.987

这可能超出了您的问题的范围，但我倾向于在托管 C++ 中编写一个小程序集，该程序集执行 fread() 或类似的快速读取结构的程序。读入它们后，您可以使用 C# 对它们执行您需要的所有其他操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-21T05:41:05.767

这是我在玩结构化文件时做了一段时间的小班。这是我在避免不安全时能想到的最快方法（这是我试图替换并保持可比性能的方法。）

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Runtime.InteropServices;

namespace PersonalUse.IO {

    public sealed class RecordReader<T> : IDisposable, IEnumerable<T> where T : new() {

        const int DEFAULT_STREAM_BUFFER_SIZE = 2 << 16; // default stream buffer (64k)
        const int DEFAULT_RECORD_BUFFER_SIZE = 100; // default record buffer (100 records)

        readonly long _fileSize; // size of the underlying file
        readonly int _recordSize; // size of the record structure
        byte[] _buffer; // the buffer itself, [record buffer size] * _recordSize
        FileStream _fs;

        T[] _structBuffer;
        GCHandle _h; // handle/pinned pointer to _structBuffer 

        int _recordsInBuffer; // how many records are in the buffer
        int _bufferIndex; // the index of the current record in the buffer
        long _recordPosition; // position of the record in the file

        /// <overloads>Initializes a new instance of the <see cref="RecordReader{T}"/> class.</overloads>
        /// <summary>
        /// Initializes a new instance of the <see cref="RecordReader{T}"/> class.
        /// </summary>
        /// <param name="filename">filename to be read</param>
        public RecordReader(string filename) : this(filename, DEFAULT_STREAM_BUFFER_SIZE, DEFAULT_RECORD_BUFFER_SIZE) { }

        /// <summary>
        /// Initializes a new instance of the <see cref="RecordReader{T}"/> class.
        /// </summary>
        /// <param name="filename">filename to be read</param>
        /// <param name="streamBufferSize">buffer size for the underlying <see cref="FileStream"/>, in bytes.</param>
        public RecordReader(string filename, int streamBufferSize) : this(filename, streamBufferSize, DEFAULT_RECORD_BUFFER_SIZE) { }

        /// <summary>
        /// Initializes a new instance of the <see cref="RecordReader{T}"/> class.
        /// </summary>
        /// <param name="filename">filename to be read</param>
        /// <param name="streamBufferSize">buffer size for the underlying <see cref="FileStream"/>, in bytes.</param>
        /// <param name="recordBufferSize">size of record buffer, in records.</param>
        public RecordReader(string filename, int streamBufferSize, int recordBufferSize) {
            _fileSize = new FileInfo(filename).Length;
            _recordSize = Marshal.SizeOf(typeof(T));
            _buffer = new byte[recordBufferSize * _recordSize];
            _fs = new FileStream(filename, FileMode.Open, FileAccess.Read, FileShare.None, streamBufferSize, FileOptions.SequentialScan);

            _structBuffer = new T[recordBufferSize];
            _h = GCHandle.Alloc(_structBuffer, GCHandleType.Pinned);

            FillBuffer();
        }

        // fill the buffer, reset position
        void FillBuffer() {
            int bytes = _fs.Read(_buffer, 0, _buffer.Length);
            Marshal.Copy(_buffer, 0, _h.AddrOfPinnedObject(), _buffer.Length);
            _recordsInBuffer = bytes / _recordSize;
            _bufferIndex = 0;
        }

        /// <summary>
        /// Read a record
        /// </summary>
        /// <returns>a record of type T</returns>
        public T Read() {
            if(_recordsInBuffer == 0)
                return new T(); //EOF
            if(_bufferIndex < _recordsInBuffer) {
                // update positional info
                _recordPosition++;
                return _structBuffer[_bufferIndex++];
            } else {
                // refill the buffer
                FillBuffer();
                return Read();
            }
        }

        /// <summary>
        /// Advances the record position without reading.
        /// </summary>
        public void Next() {
            if(_recordsInBuffer == 0)
                return; // EOF
            else if(_bufferIndex < _recordsInBuffer) {
                _bufferIndex++;
                _recordPosition++;
            } else {
                FillBuffer();
                Next();
            }
        }

        public long FileSize {
            get { return _fileSize; }
        }

        public long FilePosition {
            get { return _recordSize * _recordPosition; }
        }

        public long RecordSize {
            get { return _recordSize; }
        }

        public long RecordPosition {
            get { return _recordPosition; }
        }

        public bool EOF {
            get { return _recordsInBuffer == 0; }
        }

        public void Close() {
            Dispose(true);
        }

        void Dispose(bool disposing) {
            try {
                if(disposing && _fs != null) {
                    _fs.Close();
                }
            } finally {
                if(_fs != null) {
                    _fs = null;
                    _buffer = null;
                    _recordPosition = 0;
                    _bufferIndex = 0;
                    _recordsInBuffer = 0;
                }
                if(_h.IsAllocated) {
                    _h.Free();
                    _structBuffer = null;
                }
            }
        }

        #region IDisposable Members

        public void Dispose() {
            Dispose(true);
        }

        #endregion

        #region IEnumerable<T> Members

        public IEnumerator<T> GetEnumerator() {
            while(_recordsInBuffer != 0) {
                yield return Read();
            }
        }

        #endregion

        #region IEnumerable Members

        System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator() {
            return GetEnumerator();
        }

        #endregion

    } // end class

} // end namespace 
```

使用：

```
using(RecordReader<CPP_STRUCT_DEF> reader = new RecordReader<CPP_STRUCT_DEF>(path)) {
    foreach(CPP_STRUCT_DEF record in reader) {
        // do stuff
    }
} 
```

（这里很新，希望不要发布太多......只是粘贴在课堂上，没有删掉评论或任何缩短它的东西。）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-31T18:45:55.483

似乎这与 C++ 和编组无关。你知道结构你还需要什么。

显然，您需要一个简单的代码来读取代表一个结构的字节组，然后使用 BitConverter 将字节放入相应的 C# 字段中。

# java - 解析来自 Google 地图页面的 JSON 响应

> ID：878074
> 
> 赞同：1
> 
> 时间：2009-05-18T14:36:28.807
> 
> 标签：java, json, google-maps, parsing

我试图在我的java代码中找到从“正常”（即不使用API​​）谷歌地图页面解析响应的最佳方法。

原因：我想提交一个请求列表的查询字符串（可以是酒店、餐馆等），然后解析返回的 JSON。我曾研究过使用 Google Maps API，但它似乎并没有涵盖我想要做的事情，因为这种类型的 URL：

[http://maps.google.de/maps/](http://maps.google.de/maps/) **geo** ?q=**地址**&output=xml&oe=utf8&sensor=false&key=...

可以，但这不是：

[http://maps.google.de/maps/](http://maps.google.de/maps/) **geo** ?q= **address+hotels** &output=xml&oe=utf8&sensor=false&key=...

（由于“+酒店”一词）。所以我认为唯一的选择是使用谷歌地图响应，例如

[http://maps.google.de/maps?q=](http://maps.google.de/maps?q=)**地址+酒店**

并解析最后包含的 JSON 信息。有没有人对如何最好地做到这一点有一些提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T20:57:41.287

您应该首先绝对确定 API 不支持您需要的内容。检查文档，甚至可能接触到真正的 Google 员工可能会有所收获。让我感到奇怪的是，他们的 API 不支持像添加另一个术语这样简单的东西。

如果你被迫以“艰难的方式”去做，有两个主要步骤：

1) 查找并学习 Java 的 JSON 解析库。我可以推荐 Jackson —— 快速、坚固，并且刚刚发布了 1.0.0 版。

2) 教您的代码了解 Google 在响应中使用的规范。这是迄今为止最具挑战性的部分。我很抱歉，但我对谷歌在这方面的规范一无所知。如果你能找到官方文档，那是最好的。或者查找由必须做类似工作的其他人发布的非官方文档。否则，您可能不得不“逆向工程”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-22T07:49:17.780

回覆。google api docs：您尝试做的事情*似乎*违背了 Google 让您（开发人员）可以使用他们的产品（= 地图）以进行自定义增强（通过添加业务网点信息或其他方式）的意图）。Google maps API 网站上有很多东西描述了这一点。但是解析他们的数据（来自他们的数据库）并独立于他们的产品显示它似乎是相当不同的：术语的第 10.12 节明确涵盖了这一点：

...code.google.com/intl/de/apis/maps/terms.html

然而，有一些应用程序（例如“Around Me”iPhone 应用程序）似乎就是这样做的：谷歌和苹果之间可能在这方面有特殊安排。

编辑：或者您可以用另一种方式看待这个问题并使用 Google Base API 提要，因为这允许您构建指定资源、距离、位置等的查询字符串 - 即它返回您需要的数据而不使用 Maps API（其中根据您的描述，您无论如何都不需要）。

# jdbc - jdbc中的语句

> ID：878082
> 
> 赞同：0
> 
> 时间：2009-05-18T14:38:45.277
> 
> 标签：jdbc

语句对象是否包含数据库为当前会话返回的会话 ID？结果集包含什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T14:46:18.897

据我所知，不，[`Statement`](http://java.sun.com/javase/6/docs/api/java/sql/Statement.html)s 没有会话 ID。似乎[该类的](http://java.sun.com/javase/6/docs/api/java/sql/Statement.html)[Java API 规范`Statement`](http://java.sun.com/javase/6/docs/api/java/sql/Statement.html)支持了这一点。基本上，`Statement`s 用于通过[`execute`](http://java.sun.com/javase/6/docs/api/java/sql/Statement.html#execute(java.lang.String))方法指定 SQL 查询来执行 SQL 语句。

A[`ResultSet`](http://java.sun.com/javase/6/docs/api/java/sql/ResultSet.html)用于检索通过 a`Statement`或执行查询返回的结果[`PreparedStatement`](http://java.sun.com/javase/6/docs/api/java/sql/PreparedStatement.html)。

The [Java Tutorials的](http://java.sun.com/docs/books/tutorial/index.html)[JDBC(TM) Database Access](http://java.sun.com/docs/books/tutorial/jdbc/index.html)跟踪包含有关这些主题的一些信息。以下部分可能会引起您的兴趣：

*   [课程：JDBC 基础](http://java.sun.com/docs/books/tutorial/jdbc/basics/index.html)
    *   [更新表](http://java.sun.com/docs/books/tutorial/jdbc/basics/updating.html)
    *   [从结果集中检索值](http://java.sun.com/docs/books/tutorial/jdbc/basics/retrieving.html)

# .net - .NET 的开源业务对象设计框架

> ID：878086
> 
> 赞同：1
> 
> 时间：2009-05-18T14:39:32.653
> 
> 标签：.net, frameworks

.NET 中的业务对象设计框架有哪些可用的开源选项。我们已经在使用的是Rockford [Lhotka的](http://www.lhotka.net/)[CSLA.NET](http://www.lhotka.net/cslanet/)，这是一个非常好的框架。但我有兴趣了解其他选择。如果有人知道任何其他好的，请在这里回复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T14:43:11.493

尝试[NHibernate](https://www.hibernate.org/343.html)。这与 CSLA 有很大不同。NHibernate 是一个 ORM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-01T17:34:32.717

如果您正在寻找业务对象设计框架和 ORM，我推荐[PLINQO](http://plinqo.com)。它拥有大量文档，速度极快，支持批处理操作、审计并具有规则引擎。

如果您继续使用 CSLA，我建议您也查看我们的[CSLA 模板](http://www.codesmithtools.com/generate-csla-code-with-templates.aspx)。它会生成一个有效的 DAL，因此您可以更多地关注 BO 设计，而不是如何填充它。

谢谢 -Blake Niemyjski（[CodeSmith CSLA 模板](http://www.codesmithtools.com/generate-csla-code-with-templates.aspx)的作者）

# c# - 如何以编程方式调用 C++ 编译器？

> ID：878089
> 
> 赞同：3
> 
> 时间：2009-05-18T14:40:21.560
> 
> 标签：c#, c++, compiler-construction

出于商业原因，我想创建一个 C# 应用程序，它将 C++ 文件/片段作为输入，编译它（可能在后台调用 C++ 编译器）并输出编译结果。

你知道这是怎么做到的吗？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T14:44:13.520

使用[CL.exe](http://msdn.microsoft.com/en-us/library/9s7c9wdw(VS.71).aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T14:44:58.727

看看`Process`课堂。

它提供了启动外部应用程序所需的所有功能，包括编译器。

现在，根据您选择的编译器，您需要仔细指定进程的启动参数，以便以可预测的方式进行编译。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T14:44:37.667

大多数编译器都支持命令行参数。您只需要构建正确的命令并通过 shell 执行它，就像[这里](https://stackoverflow.com/questions/258416/shellexecute-equivalent-in-net)建议的那样。che 如果您不仅要构建单个文件，还要构建整个 .vcproj 文件 - 检查 devenv.exe 的命令行参数。如果我没记错的话是：

```
devenv.exe /build my.vcproj 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T14:56:21.747

If you are trying to achieve something like [SnippetCompiler](http://www.sliver.com/dotnet/SnippetCompiler/) for C++, you might want to look at one of the C/C++ scripting languages. I have always liked [CInt](http://root.cern.ch/drupal/content/cint).

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T16:20:59.860

当然可能，实际上 nmake 和其他类似 make 的实用程序一直调用编译器是常见的做法。

OTOH，如果您正在考虑将此解决方案部署给客户，您可能会因为所有细节（例如设置、文件所在的位置、如何对结果做出反应、许可证、要部署的 c++ 编译器等）而陷入困境.

另一个更简单的选项（恕我直言）是代替 C++ 直接从 C# 程序调用 C# 编译器来编译 C# 片段。然后文件可以保留在内存中，您无需在编译之前保存任何文件。网上有很多例子展示了如何做到这一点。此解决方案的另一个优点是您已经拥有 C# 编译器，因此也无需安装 C++ 编译器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T14:44:32.940

您可以使用 Process.Start 对任意数量的命令行 C++ 编译器（如 gcc）进行外壳处理。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T14:45:09.257

您可以通过在命令行上调用任何 C++ 编译器来完成此操作。我确信编译结果可以重定向，以便您在编译完成后获取它。

# javascript - 正则表达式（javascript）如何多次匹配两个标签之间的任何内容

> ID：878090
> 
> 赞同：1
> 
> 时间：2009-05-18T14:40:22.713
> 
> 标签：javascript, regex

我正在尝试查找 HTML 页面中所有出现在标签之间`<nobr>`的项目。`</nobr>`编辑：（nobr 是一个例子。我需要在随机字符串之间找到内容，而不是总是标签）

我试过这个

```
var match = /<nobr>(.*?)<\/nobr>/img.exec(document.documentElement.innerHTML);
alert (match); 
```

但它只给出了一次。+ 它出现两次，一次带有`<nobr></nobr>`标签，一次没有标签。我只需要没有标签的版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T14:48:14.853

使用 DOM

```
var nobrs = document.getElementsByTagName("nobr") 
```

然后您可以遍历所有 nobrs 并提取 innerHTML 或对其应用任何其他操作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T15:02:39.330

你需要循环执行

```
var match, re = /<nobr>(.*?)<\/nobr>/img;
while((match = re.exec(document.documentElement.innerHTML)) !== null){
   alert(match[1]);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T15:11:11.513

（因为我无法评论拉斐尔的正确答案......）

`exec`正在做它应该做的事情——找到第一个匹配项，在`match`对象中返回结果，并为下一次`exec`调用做好准备。该`match`对象包含（在索引 0 处）与整个正则表达式匹配的整个字符串。在随后的槽中是与括号中的子组匹配的字符串的位。所以`match[1]`在您的示例中包含与“（。*？）”匹配的字符串位。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T15:04:12.853

您可以使用

```
while (match = /<nobr>(.*?)<\/nobr>/img.exec("foo <nobr> hello </nobr> bar <nobr> world </nobr> foobar"))
    alert (match[1]); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T15:12:04.290

如果您使用的字符串不是 xml 元素，并且您坚持使用正则表达式，那么您得到的返回值可以用括号来解释。.exec 返回整个匹配字符串，后跟括号表达式的内容。

如果您的文档包含：

```
这出来了。

嗡嗡声。这是在.unBzz。

```

然后

`/Bzz.(.*?)unBzz./img.exec(document.documentElement.innerHTML)`

会给你'Bzz。这是在。unBzz。在返回数组的元素 0 和“这是在。” 在元素 1 中。尝试显示整个数组都会以逗号分隔的列表形式给出，因为这就是 JavaScript 尝试显示它的方式。

你 `alert($match[1]);` 所追求的也是如此。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T15:12:04.710

它需要一些步骤，但你可以这样做

```
match = document.documentElement.innerHTML.match(/<nobr>(.*?)<\/nobr>/img)
alert(match)//includes '<nobr>'

match_length = match.length;
for (var i = 0; i < match_length; i++)
{
    var match2 = match[i].match(/<nobr>(.*?)<\/nobr>/im);//same regex without the g option
    alert(match2[1]);
} 
```

# android - 安卓画布滚动

> ID：878098
> 
> 赞同：2
> 
> 时间：2009-05-18T14:42:22.117
> 
> 标签：android

我正在写一个纸牌应用程序。我使用画布在屏幕上绘制所有内容。有时一堆卡片会变大并延伸到屏幕底部以下。我想让画布可滚动，以便用户可以访问这些卡片。

主要活动

```
package com.maulinpathare.solitaire;

import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;

public class Solitaire extends Activity{
    /** Called when the activity is first created. */
     private Context mContext;
     private GameView mG;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        mContext = this;
        setContentView(R.layout.main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        boolean result = super.onCreateOptionsMenu(menu);
        menu.add(0, 1, 0, R.string.newGame);
        menu.add(0, 2, 0, R.string.exitGame);
        return result;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case 1:
          mG = new GameView(this);
          setContentView(mG);
            return true;
        case 2:
            finish();
            return true;
        }
        return false;
    }

}//end class 
```

GameView 类这是发生一切的地方我已经删除了大部分游戏逻辑......

```
package com.maulinpathare.solitaire;

import java.util.Stack;
import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.graphics.Rect;
import android.view.MotionEvent;
import android.view.View;
import android.view.View.OnTouchListener;
import android.widget.ScrollView;

public class GameView extends ScrollView implements OnTouchListener{
     private Deck mD;
     private boolean mInit, mDone;
     private Stack<Card> mPile1, mPile2, mPile3, mPile4, mPile5, mPile6, mPile7,
                              mOpenPile, mEndPile1, mEndPile2, mEndPile3, mEndPile4, mTemp;
     private Canvas mCanvas;
     private int mPile;
     private boolean mPickUp, mVictory;
     private Card mCard;
     private final int mSpacing = 22;
     private Paint rectPaint, wonPaint1, wonPaint2;

     public GameView(Context context) {
        super(context);
                    //initialize everything needed for the game
    }

    @Override
    protected void onDraw(Canvas canvas) {
     mCanvas = canvas;
     if(mInit){
          initialize();
          mInit = false;
     }
        //draw stuff...

    }//end onDraw

    public boolean onTouch(View v, MotionEvent event){
     int eventAction = event.getAction();
     int x = Math.round(event.getX());
     int y = Math.round(event.getY());

     switch(eventAction){
     case MotionEvent.ACTION_DOWN:
                    //check if touch has happened on one of the card piles
          break; //end case action_touch

     case MotionEvent.ACTION_MOVE:
                    //if card touched move it
          break; //end case action_move

     case MotionEvent.ACTION_UP:
                    //check if legal move has been made
          break; //end case action_up

     }//end switch(event)

     invalidate();
     return true;
    }//end onTouch
} 
```

我应该在哪里以及如何实现屏幕滚动？我希望用户能够以他们想要滚动的方向在屏幕上滑动他们的手指。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-20T00:26:32.217

请参阅 android.widget.Scroller 和 android.view.VelocityTracker。他们将让您实现自定义滚动视图。
此外，您可以将 Canvas 放在 ScrollView 中...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-08T14:50:17.890

有趣的东西，我理解视图在 Android 中工作的方式是内部视图接收所有触摸事件，并且如果内部视图的 onTouchEvent 返回 0，则事件仅传递给包装视图（说他们没有处理它) 除非父视图拦截触摸事件。

我认为您需要覆盖 onInterceptTouchEvent；

[滚动视图](http://www.google.co.in/codesearch/p?hl=en#uX1GffpyOZk/core/java/android/widget/ScrollView.java&q=android%20package:git://android.git.kernel.org%20ScrollView)

您希望在比当前更多的情况下将被拦截的事件传递给子视图。

我发现查看源代码通常很有用，因为文档可能不完整。

抱歉，我无法提供更多帮助，希望您可以通过扩展视图找到答案。

加夫

# java - 为什么需要将类标记为可序列化？

> ID：878099
> 
> 赞同：8
> 
> 时间：2009-05-18T14:42:23.333
> 
> 标签：java, serialization

**如果 stackoverflow 上已经发布了类似的问题，请发布链接。**

为要序列化的对象实现 Serializable 接口（没有方法）的需要是什么？Java API 说 - - 如果它没有实现，那么它将抛出 java.io.NotSerializableException。

这是因为 ObjectOutputStream.java 中的以下代码

```
............................

writeObject0(Object obj, boolean unshared){
.............
 } else if (cl.isArray()) {
        writeArray(obj, desc, unshared);
        } else if (obj instanceof Serializable) {
        writeOrdinaryObject(obj, desc, unshared);
        } else {
        throw new NotSerializableException(cl.getName());
        }
................ 
```

**但我的问题是为什么有必要实现 Serializable 从而通知或告诉 Java/JVM 一个类可以被序列化。（是否只是为了避免异常？）。**

在这种情况下，如果我们编写一个类似的功能，将对象写入流而不检查 instanceOf Serializable 中的类是否是可序列化的，那么类的对象是否不会实现 Serializable 序列化？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T14:50:03.087

这是个好问题。Serializable 被称为[标记接口](http://en.wikipedia.org/wiki/Marker_interface_pattern)，并且可以被视为类上的标记，以将其标识为具有功能或行为。例如，您可以使用它来识别您想要序列化的未定义 serialVersionUid 的类（这可能是一个错误）。

请注意，常用的序列化库 XStream（和其他）不需要定义 Serializable。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T14:50:21.853

It is needed so that the JVM can know whether or not a class can be safely serialized. Some things (database connections for example) contain state or connections to external resources that cannot really be serialized.

Also, you'll want to make sure that you put a serialVersionUID member in every serializable class to ensure that serialized objects can be de-serialized after a code change or recompile:

```
// Set to some arbitrary number.  
// Change if the definition/structure of the class changes.
private static final long serialVersionUID = 1; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T19:54:44.983

序列化允许您将对象直接保存到二进制文件，而无需将它们解析为文本、写出字符串然后创建一个新对象，并在读回时解析字符串输入。主要目的是允许您保存对象将所有数据保存到二进制文件中。我发现它在处理包含大量相同类型对象的链表时非常有用，我需要保存并打开它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T15:00:52.970

The reason is that not all classes can be serialized. Examples:

*   I/O stuff: InputStream, HTTP connections, channels. They depend on objects created outside the scope of the Java VM and there is no simple way to restore them.

*   OS resources like windows, images, etc.

# cvs - 如何在 TestComplete 中使用 CVS？

> ID：878105
> 
> 赞同：3
> 
> 时间：2009-05-18T14:43:14.020
> 
> 标签：cvs, testcomplete, version-control

请告诉在哪里可以找到 CVS 的免费 SCC 提供程序。因为据我所知，TestComplete 只能通过 SCC 工作。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-06T12:13:33.913

[Jalindi Igloo](http://www.jalindi.com/igloo/)是免费的，但非常过时。[CVS SCC Proxy](http://www.pushok.com/soft_cvs_proxy.php)较新，但我不确定它是否免费。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T14:58:34.677

看起来 TestComplete 直接与 cvs 一起工作。您所需要的只是`cvs.exe`他们的[网页](http://www.automatedqa.com/products/abs/operations/cvs/)。如果您需要 Windows 的 cvs 副本，我推荐[Tortoise CVS](http://www.tortoisecvs.org/)。

# ruby-on-rails - 将 Rails 插件安装为 git 子模块

> ID：878112
> 
> 赞同：3
> 
> 时间：2009-05-18T14:44:29.477
> 
> 标签：ruby-on-rails

(为什么没有|有没有) 运行方式

```
./script/plugin install -SOME_HIDDEN_OPTION git://github.com... 
```

这样插件就安装为 git 子模块。子模块的原因是让不相关的代码远离项目的存储库。

也许有理由不将插件保留为子模块？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:51:25.443

```
./script/plugin install git://github.com/something/something... 
```

应该在没有子模块的情况下工作......

如果要更新插件，只需导航到该插件的文件夹并执行 git pull。

子模块的唯一优点是您可以从 git 存储库中的任何位置查看所有子模块。否则，git 只需找到最近的 git 存储库并对其进行处理……在上述情况下，导航到插件的目录将使其成为您正在处理的存储库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T01:49:30.883

子模块有点棘手。此外，如果您克隆您的 repo 并且您的子模块遥控器之一已关闭，您就会陷入困境。

我有时也会调整本地代码，这需要它在我的仓库中。

Braid 使管理这种情况变得简单。

# algorithm - 是否有考虑“块转置”的编辑距离算法？

> ID：878114
> 
> 赞同：10
> 
> 时间：2009-05-18T14:44:34.297
> 
> 标签：algorithm, language-agnostic, levenshtein-distance, edit-distance

我将“块转置”放在引号中，因为我不知道技术术语是否或应该是什么。只知道该过程是否有技术术语将非常有帮助。

关于编辑距离的[Wikipedia 文章](http://en.wikipedia.org/wiki/Edit_distance)为这个概念提供了一些很好的背景。

通过考虑“块转置”，我的意思是

```
Turing, Alan. 
```

应该匹配

```
Alan Turing 
```

比匹配更接近

```
Turing Machine 
```

即距离计算应该检测文本的子串何时在文本中简单地移动。常见的 Levenshtein 距离公式并非如此。

字符串最多只有几百个字符——它们是作者姓名或作者姓名列表，可以采用多种格式。我不做 DNA 测序（尽管我怀疑做过的人会对这个主题有所了解）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T16:21:01.017

对于您的应用程序，您可能应该考虑从生物信息学中调整一些算法。

例如，您可以首先通过确保所有分隔符都是空格或您喜欢的任何其他内容来统一您的字符串，这样您就可以将“Alan Turing”与“Turing Alan”进行比较。然后拆分其中一个字符串并执行精确的字符串匹配算法（如[Horspool](http://en.wikipedia.org/wiki/Horspool) -Algorithm ），将这些片段与另一个字符串进行比较，计算匹配子字符串的数量。

如果您想找到仅相似但不相等的匹配项，则[局部对齐方式](http://en.wikipedia.org/wiki/Smith_waterman)可能更合适，因为它提供了描述相似性的分数，但引用的 Smith-Waterman-Algorithm 可能有点矫枉过正对于您的应用程序，甚至不是可用的最佳局部对齐算法。

根据您的编程环境，有可能实现已经可用。我个人最近使用过[SeqAn](http://www.seqan.de)，它是 C++ 的生物信息学库，绝对提供了所需的功能。

好吧，这是一个相当抽象的答案，但我希望它为您指明正确的方向，但遗憾的是它没有为您提供解决问题的简单公式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-19T22:57:15.873

查看 Jaccard 距离度量 (JDM)。这是一个老的但很好的东西，非常擅长处理令牌级别的差异，例如姓氏在前，名字在后。对于两个字符串比较，JDM 计算只是两个字符串共有的唯一字符数除以它们之间的唯一字符总数（换句话说，联合上的交集）。例如，给定两个参数“JEFFKTYZZER”和“TYZZERJEFF”，分子为 7，分母为 8，得出的值为 0.875。我选择的字符作为标记并不是唯一可用的，顺便说一句，也经常使用 n-gram。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-09T06:58:08.493

编辑距离的最简单和最有效的现代替代方法之一称为归一化压缩距离或 NCD。基本思想很容易解释。选择用您的语言实现的流行压缩器，例如*zlib*。然后，给定字符串*A*和字符串*B*，让*C(A)*是 A 的压缩大小，*C* ( *B)*是 B 的压缩*大小*。令*AB*表示“ *A*与*B*连接”，因此*C(AB)*表示“ *A*与*B*连接”的压缩大小。接下来，计算分数

( *C(AB)* - 最小值( *C(A)* , *C(B)* )) / 最大值( *C(A)* , *C(B)* )

该值称为 NCD( *A* , *B*) 并测量类似于编辑距离的相似性，但支持更多形式的相似性，具体取决于您选择的数据压缩器。当然，zlib 支持您所描述的“块”样式相似性。如果两个字符串相似，则连接的压缩大小将接近每个单独的大小，因此分子将接近 0，结果将接近 0。如果两个字符串非常不同，则压缩后的大小将大致为添加的压缩大小，因此结果将接近 1。如果您已经可以访问 zlib 之类的数据压缩程序，则此公式比编辑距离或几乎任何其他显式字符串相似性度量更容易实现。这是因为大多数“硬” 启发式和优化等工作已经在数据压缩部分完成，这个公式简单地提取了它使用与语言无关的通用信息理论发现的相似模式的数量。此外，对于您描述的几百字节大小范围，此技术将比大多数显式相似性度量（例如编辑距离）快得多。有关此内容和示例实现的更多信息，只需搜索归一化压缩距离 (NCD) 或查看以下论文和 github 项目：

[http://arxiv.org/abs/cs/0312044](http://arxiv.org/abs/cs/0312044) "Clustering by Compression"

[https://github.com/rudi-cilibrasi/libcomplearn](https://github.com/rudi-cilibrasi/libcomplearn) C language implementation

There are many other implementations and papers on this subject in the last decade that you may use as well in other languages and with modifications.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T15:26:23.557

我认为您正在寻找恰好用于名称匹配的[Jaro-Winkler 距离。](http://en.wikipedia.org/wiki/Jaro-Winkler_distance)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-19T15:57:38.300

您可能会发现压缩距离对此很有用。请参阅[我为非常相似的问题给出的答案](https://stackoverflow.com/questions/451884/similar-string-algorithm/452956#452956)。

或者您可以使用基于 k 元组的计数系统：

1.  选择较小的 k 值，例如 k=4。
2.  将字符串的所有长度为 k 的子字符串提取到列表中。
3.  对列表进行排序。（O（knlog（n）时间。）
4.  对您要比较的另一个字符串执行相同的操作。您现在有两个排序列表。
5.  计算两个字符串共享的 k 元组的数量。如果字符串的长度为 n 和 m，则可以使用列表合并在 O(n+m) 时间内完成，因为列表是按排序顺序排列的。
6.  共同的 k 元组的数量是您的相似度得分。

对于小字母表（例如 DNA），您通常会维护一个向量来存储每个可能的 k 元组的计数，而不是一个排序列表，尽管当字母表是任何字符时这是不切实际的——对于 k=4，你会需要一个 256^4 数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T15:11:28.143

我不确定你真正想要的是编辑距离——它只适用于字符串——或语义距离——选择最合适或相似的含义。您可能想查看[信息检索](http://en.wikipedia.org/wiki/Information_retrieval)中的主题，以了解如何区分给定特定术语或短语的最合适的匹配术语/短语。从某种意义上说，您正在做的是比较非常短的文档而不是字符串。

# wpf - 如何阻止 Vista 使我的焦点 XAML 按钮跳动？

> ID：878119
> 
> 赞同：2
> 
> 时间：2009-05-18T14:45:52.830
> 
> 标签：wpf, xaml, button, focus, styles

我已经为我的 WPF 应用程序中的按钮创建了一种样式。

然而，在 Vista 上，当一个按钮被聚焦时，它会**发出一种淡蓝色的脉动，**这在设计中并不好看。

**如何覆盖这种自动脉动？**

```
<Style x:Key="NavigationButtonStyle" TargetType="Button">
    <Setter Property="Width" Value="400"/>
    <Setter Property="Height" Value="100"/>
    <Setter Property="Cursor" Value="Hand"/>
    <Setter Property="FontSize" Value="56"/>
    <Setter Property="Foreground" Value="#aaa"/>
    <Style.Triggers>
        <Trigger Property="IsEnabled" Value="False">
            <Setter Property="Foreground" Value="#ddd" />
        </Trigger>
        <Trigger Property="IsEnabled" Value="True">
            <Setter Property="Foreground" Value="#aaa" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

### 试过“IsFocused”：

添加这对 Vista 没有任何影响，按钮看起来仍然相同，并且在聚焦时在 Vista 中脉动：

```
<Trigger Property="IsFocused" Value="True">
    <Setter Property="Background" Value="Red" />
    <Setter Property="Foreground" Value="Blue" />
</Trigger> 
```

### 尝试过“ControlTemplate”解决方案：

仍然没有效果：

```
<Style x:Key="ButtonFocusVisual">
    <Setter Property="Control.Template">
        <Setter.Value>
            <ControlTemplate>
                <Rectangle SnapsToDevicePixels="true" Margin="2" Stroke="Black" StrokeDashArray="1 2" StrokeThickness="1"/>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>
<Style x:Key="NavigationButtonStyle" TargetType="Button">
    <Setter Property="Width" Value="400"/>
    <Setter Property="Height" Value="100"/>
    <Setter Property="Cursor" Value="Hand"/>
    <Setter Property="FontSize" Value="56"/>
    <Setter Property="Foreground" Value="#aaa"/>
    <Setter Property="FocusVisualStyle" Value="{StaticResource ButtonFocusVisual}"/>
    <Style.Triggers>
        <Trigger Property="IsEnabled" Value="False">
            <Setter Property="Foreground" Value="#ddd" />
        </Trigger>
        <Trigger Property="IsEnabled" Value="True">
            <Setter Property="Foreground" Value="#aaa" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T17:58:48.790

此效果是为响应 IsKeyboardFocused 而设置的，而不仅仅是标准焦点。

在 Blend 中，如果您编辑标准按钮的控件模板，您将看到 IsKeyboardFocused=true 触发器负责此效果。

```
<Style x:Key="Button_NonGlow" TargetType="{x:Type Button}">
        <Setter Property="FocusVisualStyle" Value="{StaticResource ButtonFocusVisual}"/>
        <Setter Property="Background" Value="{StaticResource ButtonNormalBackground}"/>
        <Setter Property="BorderBrush" Value="{StaticResource ButtonNormalBorder}"/>
        <Setter Property="BorderThickness" Value="1"/>
        <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="VerticalContentAlignment" Value="Center"/>
        <Setter Property="Padding" Value="1"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type Button}">
                    <Microsoft_Windows_Themes:ButtonChrome SnapsToDevicePixels="true" x:Name="Chrome" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" RenderDefaulted="{TemplateBinding IsDefaulted}" RenderMouseOver="{TemplateBinding IsMouseOver}" RenderPressed="{TemplateBinding IsPressed}">
                        <ContentPresenter SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" RecognizesAccessKey="True"/>
                    </Microsoft_Windows_Themes:ButtonChrome>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsKeyboardFocused" Value="true">
                            <Setter Property="RenderDefaulted" TargetName="Chrome" Value="true"/>
                        </Trigger>
                        <Trigger Property="ToggleButton.IsChecked" Value="true">
                            <Setter Property="RenderPressed" TargetName="Chrome" Value="true"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="#ADADAD"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T14:55:52.763

您正在寻找的是 IsFocused 触发器属性。抱歉，我在这里没有适合您的工作示例。

* * *

更新：

我找到了我曾经使用过的一小段代码。我不确定是否有效并且我无法测试它（我在 XP 盒子上）：

```
<Style x:Key="ButtonFocusVisual">
    <Setter Property="Control.Template">
        <Setter.Value>
            <ControlTemplate>
                <Rectangle SnapsToDevicePixels="true" Margin="2" Stroke="Black" StrokeDashArray="1 2" StrokeThickness="1"/>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<Style TargetType="{x:Type Button}">
    <Setter Property="FocusVisualStyle" Value="{StaticResource ButtonFocusVisual}"/>
</Style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T20:35:00.147

根据您的具体要求，您可以通过设置 IsTabStop="False" 和 IsDefault="False" 来确保按钮永远不会获得键盘焦点。

# asp.net - 是否可以触发另一个按钮的 onclientclick 事件？

> ID：878125
> 
> 赞同：1
> 
> 时间：2009-05-18T14:48:19.797
> 
> 标签：asp.net, vb.net, gridview, modalpopupextender, modalpopups

我有一个模式弹出窗口，其中包含一个隐藏按钮的 targetId。我希望在单击网格中的按钮时出现弹出窗口，但该按钮是在代码后面编程的，因此 targetId 将无效......

所以我想尝试将gridview按钮的onclientclick事件设置为隐藏按钮的onclientclick事件。这是可能的还是我应该以另一种方式去做。

这是我创建网格按钮的方式

```
 If Not IsPostBack Then
        Dim field As New TemplateField
        field.HeaderText = "Sub Departments"
        Dim col As DataControlField = field
        GridView1.Columns.Add(col)

        For i As Integer = 0 To GridView1.Rows.Count - 1
            Dim btnview As New ImageButton
            btnview.ImageUrl = "\images\icons\xp_ico_search_24x24.gif"
            GridView1.Rows(i).Cells(3).Controls.Add(btnview)
        Next

End If 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T14:59:51.083

我假设您正在使用网络表单。如果是这样，那么是的，它很有可能。请执行下列操作。

1.  在页面上创建一个javascript函数

    ```
    function openModal(btnId){
        btn = document.getElementById(btnId);
        btn.click(); // this should fire the click even of the button
    } 
    ```

2.  在网格按钮上添加 onclientclick 事件：

    ```
    gridButton.OnClientClick = String.Format("openModal('{0}');", modalButton.ClientId)) 
    ```

这会将触发模式窗口的按钮的客户端 ID 设置为 javascript 函数。如果您需要使用其他数据填充模态窗口，您也应该在此函数中执行此操作。

您在使用 ASP.Net AJAX 控制工具包吗？或者是其他东西？这假定工具包。

此外，您已将按钮的可见性设置为隐藏，但不要`Visible=False`将服务器端的属性设置为，因为这不会呈现按钮。要隐藏它，您需要使用客户端属性`style="display:none"`

此链接可能会有所帮助：[http ://forums.asp.net/t/1066506.aspx](http://forums.asp.net/t/1066506.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T15:02:15.527

这样做是有可能的，它需要您启动按钮“DoPostback”功能。

尝试调查[`Page.ClientScript.GetPostBackClientHyperlink`方法](http://msdn.microsoft.com/en-us/library/ms223396%28VS.80%29.aspx)。

或者，您可以使用 javascript 和`.click()`事件，但我认为这将您限制为 IE 作为浏览器，但不确定。

它看起来像这样

```
javascript:document.getElementById('clientSideID').click(); 
```

# sql-server - 您能推荐一本仅针对新功能的开发人员的 Sql Server 2008 书籍吗？

> ID：878128
> 
> 赞同：2
> 
> 时间：2009-05-18T14:49:26.830
> 
> 标签：sql-server, sql-server-2008

我正在寻找一本仅涉及 Sql Server 2008 的*新*开发功能的书。几年前我读过“面向开发人员的 Sql Server 2005 初探”，但找不到同等的书。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T16:28:30.343

这里有一个很好的列表 [http://www.microsoft.com/sqlserver/2008/en/us/whats-new.aspx](http://www.microsoft.com/sqlserver/2008/en/us/whats-new.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T16:37:50.747

您也可以在线查看 MS 书籍并查看新功能。您可以使用上述任何方法来深入研究任何主题。

[http://msdn.microsoft.com/en-us/library/bb500435.aspx](http://msdn.microsoft.com/en-us/library/bb500435.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T15:05:45.970

Apress 有好书：[http ://www.amazon.com/Accelerated-Server-2008-Robert-Walters/dp/1590599691/ref=sr_1_6?ie=UTF8&s=books&qid=1242658972&sr=1-6](https://rads.stackoverflow.com/amzn/click/com/1590599691)

这个似乎也不错：[http ://www.amazon.com/Microsoft%C2%AE-Server%C2%AE-2008-Step-Microsoft/dp/0735626049/ref=sr_1_7?ie=UTF8&s=books&qid= 1242658972&sr=1-7](https://rads.stackoverflow.com/amzn/click/com/0735626049)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T15:37:36.140

我最近选择了这个，它非常关注 2008 年的特定项目：

[http://www.amazon.com/Programming-Microsoft-Server-2008-PRO-Developer/dp/0735625999/ref=sr_1_1?ie=UTF8&s=books&qid=1242660997&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0735625999)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T16:15:10.247

SQL 2008 中的新开发特性本身并不值得一整本书，只有一个例外 - 地理空间数据。如果您使用的是地理空间，那么请查看有关这方面的特定书籍，但否则这些改进并不真正值得一书。

Andy Warren 对一本 2008 年以开发人员为中心的书籍写了一篇简短的评论，但这是我从一位专注于 2008 年开发人员书籍的 SQL 专家那里看到的唯一一篇评论。

[http://www.sqlservercentral.com/blogs/andy_warren/archive/2009/03/10/book-review-murach-s-sql-server-2008-for-developers.aspx](http://www.sqlservercentral.com/blogs/andy_warren/archive/2009/03/10/book-review-murach-s-sql-server-2008-for-developers.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-18T01:27:17.197

我带了两本书，现在可以推荐给其他人：

1) Michael Otey 的 Microsoft Sql Server 新功能

[http://www.amazon.com/Microsoft%C2%AE-Server-2008-Features-Microsoft/dp/0071546405/ref=sr_1_1?ie=UTF8&s=books&qid=1245288147&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0071546405)

2) 编程 Microsoft SQL Server 2008 (PRO-Developer)

涵盖 2005 年和 2008 年的新功能，并且更详细。

[http://www.amazon.com/Programming-Microsoft-Server-2008-PRO-Developer/dp/0735625999/ref=sr_1_1?ie=UTF8&s=books&qid=1245288368&sr=1-1](https://rads.stackoverflow.com/amzn/click/com/0735625999)

# perl - 如何在 Perl 中读取多个目录并读取子目录的内容？

> ID：878129
> 
> 赞同：1
> 
> 时间：2009-05-18T14:49:37.860
> 
> 标签：perl, recursion, readdir

我有一个文件夹，里面有很多子文件夹。在这些子文件夹中，我有许多要读取的 .html 文件。我已经编写了以下代码来做到这一点。它打开父文件夹和第一个子文件夹，它只打印一个 .html 文件。它显示错误：

```
NO SUCH FILE OR DIRECTORY 
```

我不想更改整个代码。对现有代码的任何修改都对我有好处。

```
 use FileHandle;
 opendir PAR_DIR,"D:\\PERL\\perl_programes\\parent_directory";
 while (our $sub_folders = readdir(PAR_DIR))
 {
         next if(-d $sub_folders);

         opendir SUB_DIR,"D:\\PERL\\perl_programes\\parent_directory\\$sub_folders";
         while(our $file = readdir(SUB_DIR))
         {

       next if($file !~ m/\.html/i);
            print_file_names($file);    
         }
         close(FUNC_MODEL1);    
 }
 close(FUNC_MODEL);

  sub print_file_names()
  {
     my $fh1 = FileHandle->new("D:\\PERL\\perl_programes\\parent_directory\\$file")  
               or die "ERROR: $!"; #ERROR HERE 
     print("$file\n");
  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T17:28:22.533

您发布的代码看起来过于复杂。查看[File::Find::Rule](http://p3rl.org/File::Find::Rule)，您可以用很少的代码完成大部分繁重的工作。

```
use File::Find::Rule;

my $finder = File::Find::Rule->new()->name(qr/\.html?$/i)->start("D:/PERL/perl_programes/parent_directory");

while( my $file = $finder->match()  ){
   print "$file\n";
} 
```

我的意思*是这不是很性感吗？！*

一位用户评论说您可能希望仅使用 Depth=2 条目。

```
use File::Find::Rule;

my $finder = File::Find::Rule->new()->name(qr/\.html?$/i)->mindepth(2)->maxdepth(2)->start("D:/PERL/perl_programes/parent_directory");

while( my $file = $finder->match()  ){
   print "$file\n";
} 
```

将应用此限制。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T15:00:24.593

您没有`$file`在函数中提取提供的参数`print_file_names()`。

它应该是：

```
sub print_file_names()
{
    my $file = shift;
    ...
} 
```

顺便说一句，您`-d`在外循环中的测试看起来也错误。你说`next if -d ...`这意味着它会跳过目录的内部循环，这似乎与你所需要的完全相反。它工作的唯一原因是因为您正在测试`$file`的只是相对于路径的文件名，而不是完整的路径名。

另请注意：

1.  Windows 上的 Perl 可以很好地处理`/`路径分隔符
2.  设置一次父目录，然后从中派生其他路径
3.  使用`opendir($scalar, $path)`代替`opendir(DIR, $path)`

注意：未经测试的代码如下：

```
use strict;
use warnings;
use FileHandle;

my $parent = "D:/PERL/perl_programes/parent_directory";

my ($par_dir, $sub_dir);
opendir($par_dir, $parent);
while (my $sub_folders = readdir($par_dir)) {
    next if ($sub_folders =~ /^..?$/);  # skip . and ..
    my $path = $parent . '/' . $sub_folders;
    next unless (-d $path);   # skip anything that isn't a directory

    opendir($sub_dir, $path);
    while (my $file = readdir($sub_dir)) {
        next unless $file =~ /\.html?$/i;
        my $full_path = $path . '/' . $file;
        print_file_names($full_path);    
    }
    closedir($sub_dir);
}
closedir($par_dir);

sub print_file_names()
{
     my $file = shift;
     my $fh1 = FileHandle->new($file) 
           or die "ERROR: $!"; #ERROR HERE 
     print("$file\n");
 } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T15:12:47.953

请开始放：

```
use strict;
use warnings; 
```

在所有脚本的顶部，它将帮助您避免此类问题并使您的代码更具可读性。

你可以在这里阅读更多关于它的信息：[Perlmonks](http://www.perlmonks.org/?node_id=111088)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T17:53:42.683

您将需要更改整个代码以使其健壮：

```
#!/usr/bin/perl

use strict;
use warnings;

use File::Find;

my $top = $ENV{TEMP};

find( { wanted => \&wanted, no_chdir=> 1 }, $top );

sub wanted {
    return unless -f and /\.html$/i;
    print $_, "\n";
}

__END__ 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T15:12:04.010

您是否考虑过使用

[文件::查找](http://perldoc.perl.org/File/Find.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-20T06:27:40.650

这是一种不需要使用 File::Find 的方法：

首先打开根目录，使用readdir将所有子文件夹的名称存储在一个数组中；

然后，使用 foreach 循环。对于每个子文件夹，通过链接根目录和文件夹名称来打开新目录。仍然使用 readdir 将文件名存储在数组中。

最后一步是编写代码来处理这个 foreach 循环中的文件。

特别感谢给我这个想法的老师 :) 真的很好用！

# c# - 如何在这种情况下使用 TryUpdateModel？

> ID：878133
> 
> 赞同：2
> 
> 时间：2009-05-18T14:50:05.567
> 
> 标签：c#, .net, asp.net-mvc, model-binding

在我的查询字符串中，我得到了一堆参数名称和值。据我了解，我应该使用内置的 asp.net mvc 函数 TryUpdateModel(modelInstance)。
似乎它没有像我预期的那样工作。我的参数名称在大写上有所延迟。这是一个问题吗？
此外，我有一些自定义类型需要特定的方法来执行一些业务逻辑检查，以将字符串转换为此类的实例。我应该把这个逻辑放在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T19:24:08.163

Steve Sanderson 在他最近出版的书[Pro ASP.NET MVC Framework (Apress)](http://blog.codeville.net/2009/04/29/now-published-pro-aspnet-mvc-framework-apress/)中几乎有一整章是关于模型绑定的，我非常推荐这本书。

您可以发布一些您遇到问题的特定代码吗？

我认为大小写并不重要，但我可能是错的。

如果 DefaultModelBinder 不适用于您的复杂模型类型，您可能需要派生自己的自定义模型绑定器。这是自定义模型绑定器的一个极其简化的示例。我很确定 DefaultModelBinder 可以处理此处定义的简单客户对象：[简单的自定义模型绑定器](http://davidhayden.com/blog/dave/archive/2008/09/08/CustomModelBinderMoreUIValidationASPNETMVC.aspx)

这是另一篇文章，其中包含一些关于模型绑定和构建自定义模型绑定器的提示： [6 Tips for ASP.NET MVC Model Binding](http://odetocode.com/Blogs/scott/archive/2009/04/27/12788.aspx) and [Iterating on an ASP.NET MVC Model Binder](http://odetocode.com/Blogs/scott/archive/2009/05/05/12801.aspx)。

我仍然推荐上面提到的 Steve Sanderson 的书，因为它有迄今为止我见过的最好的解释，并且有一个更复杂的自定义模型绑定器示例（到 XDocument）。

# wpf - 在 WPF 中，如何使 ToolBar.Header 消失？

> ID：878139
> 
> 赞同：0
> 
> 时间：2009-05-18T14:53:56.447
> 
> 标签：wpf, toolbar

我读过两本不同的书，在 WPF 中， ToolBar.Header 属性没有做任何事情：

*   由 Adam Nathan 开发的 Windows Presentation Foundation，第 1 页。119
*   [带有 VB 2008 的 Pro WPF，第 1 页。650](http://books.google.ca/books?id=3UqXw90ju5IC&pg=PA650&lpg=PA650&dq=toolbar+header+wpf&source=bl&ots=SSmU69Ysh4&sig=JRqqrhJH5GIuCu7QYe24dQhdhGo&hl=en&ei=xnMRSpv5GpfEMtvl7KYG&sa=X&oi=book_result&ct=result&resnum=10)

但是，我正在像这样动态创建我的 ToolBar 对象（tbtToolBar 实际上是在 Xaml 中定义的 ToolBarTray，vm 是窗口的 ViewModel）：

```
foreach (IToolBarViewModel toolBarViewModel in vm.ToolBars)
{
    ToolBar toolBar = new ToolBar();
    toolBar.DataContext = toolBarViewModel;

    // Bind the Header Property
    Binding headerBinding = new Binding("Header");
    toolBar.SetBinding(ToolBar.HeaderProperty, headerBinding);

    // Bind the Items Property
    Binding itemsBinding = new Binding("Items");
    toolBar.SetBinding(ToolBar.ItemsSourceProperty, itemsBinding);

    tbtToolBar.ToolBars.Add(toolBar);
} 
```

并且 Header 属性清楚地显示在标签中，作为工具栏中的第一项。这不是我想要的行为。当用户右键单击 ToolBarTray 时，我想使用标题作为工具栏下拉列表中的标题，就像书籍描述的那样。

所以，我试图通过设置摆脱 Header：

```
toolBar.HeaderTemplate = new DataTemplate(); 
```

这可行，但现在工具栏中有一个难看的小间隙。

1.  有没有办法让标题在没有间隙的情况下不可见？
2.  为什么这些书明显错了？从那时到现在有什么变化吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T11:57:38.833

我能够完成这项工作的唯一方法是保持 Header 属性为空，并在 ToolBarViewModel 上创建另一个名为 Name 的属性。

# registration - 站点注册是否应该存储在单独的表中以供活跃用户使用？

> ID：878141
> 
> 赞同：4
> 
> 时间：2009-05-18T14:55:08.160
> 
> 标签：registration

我想知道用户注册的最佳实践。我倾向于将站点注册存储在单独的注册表中，然后在通过电子邮件确认注册后将数据传输到用户表。

这样做的好处是，从用户表中读取的内容不会因为从未激活的注册而变得混乱。另一个好处是电子邮件（用户名）字段在用户表中可以保持唯一，但如果您尝试使用不属于您的电子邮件地址进行注册，该电子邮件地址的所有者仍然可以将其注册为email 字段在注册表中不会是唯一的。

我想知道这是否是一种常见做法，或者是否有任何理由这不是一个好主意？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T17:46:05.960

在一种情况下，您可能会在逻辑上拆分这两个表：如果您的注册过程仅在您确认电子邮件地址后才询问大量强制性用户信息。例如，如果您的待处理注册表最终只有几列，例如电子邮件和激活密钥，而您的用户表有许多附加列，例如用户名、名字、姓氏、邮政地址等。

在这种情况下，拆分可能有意义，因为您可以声明这些列`NOT NULL`。

不过，除此之外，我必须同意大多数其他答案；对我来说，这听起来像是过早的优化。具有相同结构的多个表是一个强烈的警告信号，表明*你做错了。*不明确，但强烈警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T15:01:41.173

我认为那将是过度工程。

将它们全部存储在一个表中，并安排一个 SQL 查询（每天）以删除超过 30 天的未激活帐户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T15:02:46.133

**激活与否**

没有真正需要将用户存储在不同的表中。只需将所有用户存储在一个表中，并带有一个布尔标志，指示他们是否已激活。每隔一段时间运行一个 cron 作业来检查是否有 x 天前未激活的帐户并删除它们。

**电子邮件**

所以大概你是从电子邮件激活用户吧？您还想设置它，以便如果其他用户输入其他人的电子邮件，其他人仍然可以正确注册？这实际上很简单。在错误发送给他们的电子邮件中，只需一个链接即可从您的数据库中删除该电子邮件，因为显然不是他们，而且他们永远不会激活该帐户。

但是如果其他人只是删除它怎么办？

然后，当他们注册时告诉他们您已经拥有他们的电子邮件并提议再次发送激活，这封电子邮件也可以选择从数据库中删除它。

或者

只需从数据库中删除旧帐户即可。如果该人试图激活一个新帐户并且有一个从未激活过的旧帐户，则可以将其删除。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T15:29:44.207

帮自己一个忙，把它放在一张桌子上。您只是没有足够的中止注册来解决性能问题（特别是如果您在 3 周后擦除它们）。

您对电子邮件地址的理由很愚蠢。没有人可能会因为虚假注册而阻止他们的电子邮件。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-05-18T15:09:52.517

出于关注点分离的原因，我同意这种做法：“注册过程”和“用户帐户”是两个独立的概念。

注册表将用于保持“注册过程”的状态。一旦该过程完成（一旦电子邮件被验证），该过程的“输出”将是一个新的“用户帐户”。如果该过程失败（例如，在用户 1 个月未能确认其电子邮件后“超时”），则对“用户帐户”概念没有影响。

正如在另一个答案中所说，在某些情况下这可能是过度工程，但它也可能是封装这两个独立概念的复杂性的有用方法。它也可以被视为与规范化原则相矛盾，但我相信您必须根据您的上下文在封装和规范化之间进行权衡。

# c# - 可恢复文件上传

> ID：878143
> 
> 赞同：6
> 
> 时间：2009-05-18T14:56:04.807
> 
> 标签：c#, java, python

我正处于文件上传服务的设计阶段，该服务允许用户将非常大的 zip 文件上传到我们的服务器，并使用数据更新我们的数据库。由于文件很大（大约 300mb），我们希望允许用户限制他们想要用于上传的带宽量。他们还应该能够暂停和恢复传输，并且应该从系统重新启动中恢复。用户还需要在我们的 MSSQL 数据库中进行身份验证，以确保他们有权上传文件并对我们的数据库进行更改。

我的问题是，做到这一点的最佳技术是什么？我们希望最大限度地减少所需的开发量，但我现在唯一能想到的能让我们这样做的就是用 python、java 或 c# 之类的东西从头开始创建一个客户端和服务器应用程序。是否有现有的技术可以让我们做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T14:58:31.447

FTP有什么问题？该协议支持可重用性，并且有大量的客户端。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T15:16:20.520

有很多上传控件，你应该可以谷歌。[这个下载页面](http://thin-slice-upload.qarchive.org/)上有一些。

另一种解决方法是让您的客户安装 Firefox FTP 插件或自己编写 Firefox 插件，但 FTP 是迄今为止最简单的启动方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T14:59:35.033

在客户端，闪存；在服务器端，无论如何（它不会有任何区别）。

没有现有的技术（除了使用 FTP 什么的）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-05T13:16:44.163

我发现了另外两种可能性

*   **Microsoft 后台智能传输服务 (BITS)**：

    **具有**：启动和下载、大文件、加密（vis https）、可恢复（即使用户登录后自动恢复）、手动暂停和恢复、身份验证（再次通过 https）、.NET 包装器、前台或后台优先事项， ...

    **不**：带宽限制、文件验证（仅文件大小）、压缩

*   **同步**：

    **具有**：单向传输、大文件、恢复部分上传（并通过 stop 暂停）、验证、加密（通过 ssh、stunnel）、压缩、可用的 c 库（Martin Pool [ [1](http://sourceforge.net/projects/librsync/) ]、[ [2](http://librsync.sourcefrog.net/) ] 的 librsync）

    **不是**：良好的 Windows 兼容性（仅通过 cygwin 或 cwrsync），商业可用（GPL）

有人在 C# 中发现了其他东西吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-02T10:58:38.297

有一个使用 HTML5 创建可恢复的大文件上传的示例，可能会有所帮助。

[http://net.tutsplus.com/tutorials/javascript-ajax/how-to-create-a-resumable-video-uploade-in-node-js/](http://net.tutsplus.com/tutorials/javascript-ajax/how-to-create-a-resumable-video-uploade-in-node-js/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-22T21:35:53.207

我很惊讶没有人提到种子文件。它们也可以被打包成一个脚本，然后触发一些东西来执行。

# c# - 如何创建一个简单的自定义容器控件，里面有 2 个 div？

> ID：878148
> 
> 赞同：1
> 
> 时间：2009-05-18T14:57:08.640
> 
> 标签：c#, asp.net, containers, custom-controls

我希望创建一个自定义 ASP.NET 容器控件，它允许我在 VS 设计器中将更多控件拖入其中。

我要寻找的最终 HTML 非常简单..

```
<div id="panel1">
    <div id="panel2">
    </div>
    <div id="panel2">
    </div>
</div> 
```

可以将其他控件拖到面板 2 和 3 中。

我确信它非常简单，但我正在努力寻找有用的例子。

任何指针或想法表示赞赏！

干杯斯图尔特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T03:30:35.920

我过去做过这样的事情，是的，根据我当时的经验，没有太多可用的文档。更糟糕的是，当时的一些文档不正确或含糊不清！

所以，为了避免你所有的头痛（哎呀，当我想到它时它已经开始受伤了：-P），这里有一些你绝对需要知道的信息。

基本上所有控件都仅供运行时使用。您可以将 ControlDesigner 附加到具有类定义属性的控件，设计时环境 (VS.NET IDE) 将加载该属性并将其用作控件顶部的层。

## 模板

Chris 使用模板的建议是正确的方向。您的控件需要在某处存储 div 的“内容”，而模板是完美的解决方案。确保你一开始就做好了这部分。注意：如果模板属性有 set 子句，它们的行为可能会很奇怪！此外，还要检查 NotifyParentAttribute 的使用。

当您准备好模板，并且可以在 ASPX 页面中使用声明性语法来添加控件并且它们呈现良好时，您就可以开始使用设计器了。

对于设计师，您有 2 个选择；简单而复杂的方法。

## 简单的设计师解决方案

让我们从简单的方法开始。基本的 ControlDesigner 类已经提供了一个框架来显示模板。您可能已经在实际中看到了这一点，例如在 GridView 控件及其模板字段中。

查看以下[有关创建模板控件设计器的 MSDN 文章](http://msdn.microsoft.com/en-us/library/system.web.ui.design.templatedcontroldesigner.aspx)。

通过这个简单的解决方案，您可以自动实现智能标记（设计时控件右侧的箭头），并且可以从下拉列表中选择要编辑的模板。

## 复杂的设计师解决方案

现在，如果这对您来说不是很满意，并且您希望能够像 Panel 控件一样编辑控件，那么您必须更深入地挖掘。所以这里是使用控制设计器区域的复杂解决方案。

请参阅[EditableDesignerRegion 类中](http://msdn.microsoft.com/en-us/library/system.web.ui.design.editabledesignerregion.aspx)示例中的示例。

此示例的作用是覆盖设计器类的 CreateChildControls。还记得我说过设计器控件是运行时控件之上的一层吗？所以这个 CreateChildControls 方法将在你的控件实现之后运行。您需要做的是在渲染输出中使用特殊的设计器区域 HTML 属性标记 HTML 元素。这样，设计者就知道渲染控件中的哪个部分应该是一个区域。

现在您必须指示 IDE 为您的区域分配编辑器或查看器。您必须在 GetDesignTimeHtml(DesignerRegionCollection region) 方法中执行此操作（请注意此方法的重载版本）。如您所见，此方法接收区域集合。您必须将可编辑的视图区域分配给此集合。重要的是——这是记录不充分的部分——*这个集合中的顺序非常重要*。HTML 中 region 属性的值是指该集合中的索引。

所以，现在我们已经在渲染输出中定义了区域，为其分配了编辑器或查看器。接下来是如何填充这些区域并将这些区域的值存储回我们的控件声明中。

这两个操作在控件设计器的 GetEditableDesignerRegionContent 和 SetEditableDesignerRegionContent 方法中处理。在这里，您会看到为什么在 GetDesignTimeHtml 方法中命名已添加到集合中的区域很重要。在这两种方法中，您会收到区域引用，并通过它的 Name 属性，您可以确定要读取/写入控件的哪个 Template 属性。

为了读取和写入模板属性，我们使用了 ControlPersister 和 ControlParser 的魔力。持久化器从声明性 ASP.NET (HTML) 代码创建模板实例。解析器以相反的方式完成工作；从模板实例创建纯 HTML。

## 简而言之

因此，由您来决定标准模板编辑框架是否适合您。如果您想在 IDE 中为您的两个编辑区域提供精美的编辑功能，那么您将不得不实施复杂的解决方案。否则，只需坚持简单的实现。提到的例子会对你有很大帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T02:00:01.393

这是关于您正在尝试做什么的 MSDN 文章的链接，不幸的是没有 VS 设计器支持，因此它可以从服务器正确呈现，但不能在 IDE 中呈现。

如何：创建模板化 ASP.NET 用户控件
[http://msdn.microsoft.com/en-us/library/36574bf6.aspx](http://msdn.microsoft.com/en-us/library/36574bf6.aspx)

# .net - OpenFileDialog 上的块上下文菜单

> ID：878153
> 
> 赞同：1
> 
> 时间：2009-05-18T14:58:15.940
> 
> 标签：.net, vb.net, controls

是否可以以编程方式阻止用户访问在显示 .net 框架附带的 openfiledialog 控件后列出的文件的上下文菜单？

目的是阻止他们访问“打开”或“打开方式”，只允许他们从列表中选择一个文件。

我唯一的另一个想法是构建自己的控件而不是使用 System.Windows.Forms.OpenFileDialog

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:03:21.903

在这种情况下，你最快和最可靠的赌注是推出你自己的 OpenFileDialog。

替代方法是尝试捕获在打开文件对话框上的鼠标右键单击，并且不允许对其进行处理

作为旁注，我会对 OpenFileDialog 感到恼火，它的行为与其他所有打开的文件对话框不同（即不允许我执行重命名或“打开方式”之类的任务）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T15:00:01.973

我会仔细查看控件属性，通常有这种事情的选项。

# java - Dependency problems with my ANT script

> ID：878161
> 
> 赞同：0
> 
> 时间：2009-05-18T14:59:45.610
> 
> 标签：java, ant, compilation, javac

I'm having problems building my project, using an Ant script, from the command prompt using Ant itself. It can't find a certain import for a particular Java file in my project (which has nearly 5,000 source files as it is). The import is included in a .jar package whose location I have set in the Ant file itself. Oddly enough, I can build the project just fine from the Ant file using an IDE like Eclipse. Any ideas what could be wrong? Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T15:04:20.123

check the basedir property. If the location of the jar in question is relative then the basedir will influence the behaviour in this peculiar way.

Or it could be that eclipse adds that jar to the classpath when it will run the ant file.

Convert the jar location to an absolute path

```
<property name="x" location="${jar.reference}" /> 
```

and print it

```
<echo message="${x}" /> 
```

My ant skills are a little rusty so you should double check the syntax :-).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T15:05:30.340

Can you tell us the name of the jar? Whenever I've had this issue it has always been to do with versions of libraries used by the IDE but not in the ANT_HOME/lib directory, usually logging or xml parsing.

Which ant command is failing? java/javac? Have you tried using the fork=yes option if it is java?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T15:10:00.377

您是否在 Ant 中正确定义了类路径？Eclipse 在运行 ant 时倾向于自动计算类路径...

# c++ - 有 C++ 惰性指针吗？

> ID：878166
> 
> 赞同：14
> 
> 时间：2009-05-18T15:00:38.947
> 
> 标签：c++, pointers

我需要一个`shared_ptr`类似的对象，但是当我尝试访问它的成员时它会自动创建一个真实的对象。

例如，我有：

```
class Box
{
public:
    unsigned int width;
    unsigned int height;
    Box(): width(50), height(100){}
};

std::vector< lazy<Box> > boxes;
boxes.resize(100);

// at this point boxes contain no any real Box object.
// But when I try to access box number 50, for example,
// it will be created.

std::cout << boxes[49].width;

// now vector contains one real box and 99 lazy boxes. 
```

是否有一些实现，或者我应该自己编写？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-05-18T15:24:22.453

推出自己的产品非常简单。

```
template<typename T>
class lazy {
public:
    lazy() : child(0) {}
    ~lazy() { delete child; }
    T &operator*() {
        if (!child) child = new T;
        return *child;
    }
    // might dereference NULL pointer if unset...
    // but if this is const, what else can be done?
    const T &operator*() const { return *child; }
    T *operator->() { return &**this; }
    const T *operator->() const { return &**this; }
private:
    T *child;
};

// ...

cout << boxes[49]->width; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-18T16:30:53.227

使用`boost::optional`，你可以有这样的事情：

```
// 100 lazy BigStuffs
std::vector< boost::optional<BigStuff> > v(100);
v[49] = some_big_stuff; 
```

将构造 100 个惰性并分配一个实数`some_big_stuff`给`v[49]`. `boost::optional`将不使用堆内存，但使用placement-new 在堆栈分配的缓冲区中创建对象。我会`boost::optional`像这样创建一个包装器：

```
template<typename T>
struct LazyPtr {
    T& operator*() { if(!opt) opt = T(); return *opt; }
    T const& operator*() const { return *opt; }

    T* operator->() { if(!opt) opt = T(); return &*opt; }
    T const* operator->() const { return &*opt; }    
private:
    boost::optional<T> opt;
}; 
```

这现在`boost::optional`用于做事。它应该支持像这样的就地构造（上的示例`op*`）：

```
T& operator*() { if(!opt) opt = boost::in_place(); return *opt; } 
```

这不需要任何复制。但是，当前的 boost 手册不包括该赋值运算符重载。然而，消息来源确实如此。我不确定这是否只是手册中的一个缺陷，或者是否故意遗漏了它的文档。所以我会使用更安全的方式使用复制分配`T()`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T15:06:58.980

我从来没有听说过这样的事情，但话说回来，我从来没有听说过很多事情。“惰性指针”如何将有用的数据放入底层类的实例中？

您确定[稀疏矩阵](http://www.boost.org/doc/libs/1_35_0/libs/numeric/ublas/doc/matrix_sparse.htm)不是您真正想要的吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T15:07:01.663

据我所知，目前还没有这种事情的实现。不过，创建一个并不难。

# c++ - 在vc2008中找到未使用的函数？

> ID：878172
> 
> 赞同：2
> 
> 时间：2009-05-18T15:01:23.047
> 
> 标签：c++, function

如何在 c++ 项目 vc2008 中找到未使用的函数

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T17:42:54.433

在创建发布版本时，我总是使用“/OPT:REF”。这个标志会删除所有未引用的函数，并且如果有许多函数没有被使用（在我们的例子中，我们有一个内核，其加载的方法与不同的定制应用程序不同），它将大大减少最终的二进制文件。

“/VERBOSE”会将有关链接会话的信息发送到输出窗口，或者如果您在命令行上进行链接，则发送到标准输出。在后者中，您始终可以将其重定向到文件。

同时使用这两个标志将使输出包含所有已消除的函数和/或从未引用的数据。

干杯!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T15:13:24.083

从“分析/构建”菜单中选择“在“您的项目名称”上运行代码分析”（根据您的 VS 版本），如果有未使用的函数，VS 将显示警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T15:04:55.600

您应该能够使用带有[/map](http://msdn.microsoft.com/en-us/library/k7xkk3e2.aspx)和 /mapinfo 的 link.exe 来生成一个映射文件，告诉您哪些函数没有被调用。

# winforms - How can I create GDI Leaks in Windows Forms!

> ID：878176
> 
> 赞同：4
> 
> 时间：2009-05-18T15:02:10.783
> 
> 标签：winforms, gdi+, gdi

I am investigating a GDI resource leak in a large application. In order to further my understanding of how these problems occur, I have created a very small application which I have deliberately made 'leaky'. Here is a simple user control which should result in the creation of 100 Pen objects:

```
public partial class TestControl : UserControl
{
    private List pens = new List();

    public TestControl()
    {
        InitializeComponent();

        for (int i = 0; i < 100; i++)
        {
            pens.Add(new Pen(new SolidBrush(Color.FromArgb(255, i * 2, i * 2, 255 - i * 2))));
        }

        this.Paint += new PaintEventHandler(TestControl_Paint);
    }

    void TestControl_Paint(object sender, PaintEventArgs e)
    {
        for (int i = 0; i < 100; i++)
        {
            e.Graphics.DrawLine(pens[i], 0, i, Width, i);
        }
    }
}

```

However, when I create an instance of my object and add it to a form, looking at my application with TaskManager I currently see ~37 GDI objects. If I repeatedly add new TestObject user controls to my form, I *still* only see ~37 GDI objects.

What is going on here! I thought that the constructor for System.Drawing.Pen would use the GDI+ API to create a new Pen, thus using a new GDI object.

I must be going nuts here. If I cannot write a simple test application that creates GDI objects, how can I create one which leaks them!

Any help would be much appreciated.

Best Regards, Colin E.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:14:27.327

GDI+ 是否使用 GDI 句柄？我不确定，尽管我在某处读到有一个依赖于裸 GDI 的 .NET System.Drawing 实现。

但是，也许您可​​以尝试使用像 AQTime 这样的分析器来查找泄漏。

您如何确定您的大型应用程序正在泄漏 GDI 句柄？任务管理器中的计数大吗？如果是这样，您总是使用 GDI+，还是同时使用 GDI？如果您多次创建控件，您的测试应用程序 GDI 处理计数是否会增加？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T18:15:23.013

您并没有真正泄漏样本中的资源。从您的 Load 事件中删除此代码：

```
for (int i = 0; i < 100; i++)
    {
        pens.Add(new Pen(new SolidBrush(Color.FromArgb(255, i * 2, i * 2, 255 - i * 2))));
    } 
```

您的 Paint 事件处理程序应如下所示：

```
void TestControl_Paint(object sender, PaintEventArgs e)
{
    for (int i = 0; i < 100; i++)
    {
        e.Graphics.DrawLine(new Pen(new SolidBrush(Color.FromArgb(255, i * 2, i * 2, 255 - i * 2))), 0, i, Width, i);
    }
} 
```

现在，您将在每个油漆调用中泄漏。开始最小化/恢复您的表单并查看 GDI 对象天空火箭...

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-07-05T01:59:51.070

如果你想从 .NET 中泄露一个 GDI 对象，那么只需创建一个 GDI 对象而不释放它：

```
[DllImport("gdi32.dll", EntryPoint="CreatePen", CharSet=CharSet.Auto, SetLastError=true, ExactSpelling=true)]
private static extern IntPtr CreatePen(int fnStyle, int nWidth, int crColor);

CreatePen(0, 0, 0); //(PS_SOLID, 0=1px wide, 0=black) 
```

Blingo blago，你在泄漏 GDI 笔。

> 我不知道你*为什么*要创建 GDI 泄漏。但是您的问题询问如何从 WinForm 创建 GDI 泄漏 - 就是这样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-22T07:08:33.627

我认为编译器只使用一个句柄。

如果我在 delphi 中创建很多字体，我只会占用内存
，但如果我使用 WinAPI `CreateFont()`，我会占用 GDI 对象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-30T08:05:10.347

我想下面的博客可能已经回答了这个问题：

[正确使用 GDI 对象](http://ozgur.ozcitak.com/blog/2009/12/23/using-gdi-objects-the-right-way.html)

未显式释放的 GDI 对象应通过它们的终结隐式释放。[（Bob Powell 在GDI+ FAQ](https://web.archive.org/web/20141006052218/http://bobpowell.net/disposing_of_resources.aspx)中也提到了这个问题）

但我怀疑 CLR 垃圾收集器是否可以如此快速地删除 GDI 资源，以至于我们甚至无法从 TaskManager 中看到内存使用情况的变化。也许当前的 GDI+ 实现不使用 GDI。

我尝试了以下代码来生成更多 GDI 对象。但是我仍然看不到 GDI 句柄数量的任何变化。

```
void Form1_Paint(object sender, PaintEventArgs e) 
{
    Random r = new Random();
    while (true)
    {
        for (int i = 0; i < 100; i++)
        {
            e.Graphics.DrawLine(
            new Pen(new SolidBrush(Color.FromArgb(r.Next()))), 0, i, Width, i);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-10-14T18:14:12.920

在窗体上创建两个按钮。在每个按钮内，添加以下代码。在一个按钮中，注释掉 Dispose 方法。

```
 Form _test = null;
    for (int i = 0; i < 20; i++)
    {
        _test = new Form();
        _test.Visible = false;
        _test.Show();
        _test.Hide();
        _test.Dispose();
    } 
```

带有 Dispose 注释的按钮显示泄漏。另一个显示 Dispose 导致 User 和 GDI 句柄保持不变。

[这](http://ozgur.ozcitak.com/blog/2009/12/23/using-gdi-objects-the-right-way.html)可能是我找到的最好的解释它的页面。

# .net - Oracle 11g 的事务超时

> ID：878183
> 
> 赞同：1
> 
> 时间：2009-05-18T15:03:28.923
> 
> 标签：.net, wcf, oracle, transactions

使用 Oracle 11g 数据库。我有一个标记为的服务：

[ServiceBehavior(InstanceContextMode = InstanceContextMode.PerCall, TransactionTimeout="00:00:10")]

该方法本身如下所示：

```
 [OperationBehavior(TransactionScopeRequired = true)]
    [TransactionFlow(TransactionFlowOption.NotAllowed)]
    public OrderMessage AddOrder(OrderMessage orderMessage)
    {
        ValidateMessage(orderMessage);
        return this.orderBusiness.Add(orderMessage);
    } 
```

如果我在 orderBusiness.Add 方法中放置一个断点并等待 10 秒，事务就会超时。如果我取出断点，然后锁定事务涉及的表，它会等待超过 10 秒，至少要等到服务在 60 秒时超时。如果表被锁定，任何想法如何让事务以指定的时间间隔超时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T00:14:22.230

如果它被锁定并在您的代码中处理它，您可以使用带有 NOWAIT 的插入来立即将控制权返回给您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T14:44:50.493

这是我在这种情况下必须做的。我发现我的 transactiontimeout 没有效果，因为我正在等待我的交易锁定。不过我不知道这一点，因为 Distributed_lock_timeout 在我的数据库中设置为默认的 60 秒，并且服务在此之前超时。由于我无法更改 Distributed_lock_timeout 我增加了服务超时，然后我开始看到：

```
InnerException: Oracle.DataAccess.Client.OracleException
Message="ORA-02049: timeout: distributed transaction waiting for lock" 
```

所以总而言之，当我有一个断点时，事务超时工作，因为它关心事务实际执行需要多长时间。当表被锁定时它没有效果，因为它还没有开始执行。在开始我的事务工作之前，我应该使用 try catch 来确保资源没有被锁定。

# apache - Beginner Apache URL Rewrite Question

> ID：878186
> 
> 赞同：2
> 
> 时间：2009-05-18T15:04:00.797
> 
> 标签：apache, url-rewriting

I'm just trying to figure out if I'm on the right path - additional details on rewriting the URL in my example would be appreciated.

I have installed a CMS program and would simply like that www.example.com be pointed to www.example.com/cms. I just want to know if URL rewriting through apache is the best way to accomplish this?

Thank you.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:16:56.713

只需将[http://example.com/](http://example.com/)重定向到[http://example.com/cms/](http://example.com/cms/)：

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewritRule ^/?$ /cms/
</IfModule> 
```

重定向所有以 /cms/ 开头的 404d url：

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^(.*)$ /cms/$1 [L]
</IfModule> 
```

将所有 url 重定向到 /cms/：

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /
  RewriteRule ^(.*)$ /cms/$1 [L]
  <Directory /var/www/html/cms/> #change this to the correct path
    RewriteEngine Off
  </Directory>
</IfModule> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T15:13:25.270

这绝对是我会采取的方法。我将假设您使用的是 Apache，尽管这也可以通过 IIS 轻松完成。您需要使用 mod_rewrite 编辑根目录中的 .htaccess 文件来执行此操作。

```
<IfModule mod_rewrite.c>

   RewriteEngine on

   RewriteRule    ^(.*)$ /cms/$1  [L]

</IfModule> 
```

这应该适用于你所追求的。将“cms”更改为您要重写的任何目录。

# wpf - Create A WPF ObservableCollection From A SubSonic 2.2 Collection

> ID：878199
> 
> 赞同：1
> 
> 时间：2009-05-18T15:07:01.880
> 
> 标签：wpf, subsonic, observablecollection

If I have a DAL created by SubSonic 2.2, how do I convert the Collections created by it to WPF ObservableCollections in code (pref.VB.NET) to be consumed by WPF?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T16:03:07.960

对不起！VB：

```
[Test]
public void Exec_Testing()
{
    ProductCollection products =
        DB.Select().From("Products")
            .Where("categoryID").IsEqualTo(5)
            .And("productid").IsGreaterThan(50)
            .ExecuteAsCollection<ProductCollection>();

    Assert.IsTrue(products.Count == 77);

    ObservableCollection<Product> obsProducts = new ObservableCollection<Product>(products);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-29T06:45:59.627

您必须手动将其添加到您的 DAL 类中，但这并不难。在每个数据访问层类的顶部，添加“Implements INotifyPropertyChanged”，然后在每个属性中，添加“set”中的代码，如下所示。

```
Private _Book As String
Public Property Book() As String
    Get
        Return _Book
    End Get
    Set(ByVal value As String)
        If Not _Book = value Then
            _Book = value
            ' Raise the property changed event.
            RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs("Book"))
        End If
    End Set
End Property 

Public Event PropertyChanged(ByVal sender As Object, ByVal e As System.ComponentModel.PropertyChangedEventArgs) Implements System.ComponentModel.INotifyPropertyChanged.PropertyChanged 
```

# java - Java curve fitting library

> ID：878200
> 
> 赞同：20
> 
> 时间：2009-05-18T15:07:24.407
> 
> 标签：java, curve-fitting

I'm hoping to find a simple library that can take a series of 2 dimensional points and give me back a larger series of points that model the curve. Basically, I want to get the effect of curve fitting like this sample from JFreeChart:

[![enter image description here](https://i.stack.imgur.com/Gr7qj.png)](https://i.stack.imgur.com/Gr7qj.png)

The problem with JFreeChart is that the code does not provide this type of api. I even looked at the source and the algorithm is tightly coupled to the actual drawing.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-08-13T09:34:02.267

[Apache Commons Math](http://commons.apache.org/proper/commons-math/)有一系列很好的算法，特别是“SplineInterpolator”，请参阅[API 文档](http://commons.apache.org/proper/commons-math/apidocs/index.html)

我们在 Groovy 中调用 alpha(x)、beta(x) 的插值函数的示例：

```
package example.com

import org.apache.commons.math3.analysis.interpolation.SplineInterpolator
import org.apache.commons.math3.analysis.polynomials.PolynomialSplineFunction

import statec.Extrapolate.Value;

class Interpolate {

    enum Value {
        ALPHA, BETA
    }

    def static xValues     = [
        -284086,
        -94784,
        31446,
        354837,
        667782,
        982191
    ]
    def static alphaValues = [
        71641,
        78245,
        80871,
        94045,
        105780,
        119616
    ]
    def static betaValues = [
        95552,
        103413,
        108667,
        128456,
        144686,
        171953
    ]

    static def getValueByName(Value value, int i) {
        def res
        switch (value) {
            case Value.ALPHA:
                res = alphaValues[i]
                break
            case Value.BETA:
                res = betaValues[i]
                break
            default:
                assert false
        }
        return res
    }

    static PolynomialSplineFunction interpolate(Value value) {
        def yValues = []
        int i = 0
        xValues.each {
            def y = getValueByName(value, i++)
            yValues << (y as Double)
        }
        SplineInterpolator spi = new SplineInterpolator()
        return spi.interpolate(xValues as double[], yValues as double[])
    }

    static void main(def argv) {
        //
        // Create a map mapping a Value instance to its interpolating function
        //
        def interpolations = [:]
        Value.values().each {
            interpolations[it] = interpolate(it)
        }
        //
        // Create an array of new x values to compute display.
        // Make sure the last "original" value is in there!
        // Note that the newxValues MUST stay within the range of the original xValues!
        //
        def newxValues = []
        for (long x = xValues[0] ; x < xValues[-1] ; x+=25000) {
            newxValues << x
        }
        newxValues << xValues[-1]
        //
        // Write interpolated values for ALPHA and BETA, adding the original values in columns 4 and 5
        //
        System.out << "X , ALPHA, BETA, X_orig, ALPHA_orig, BETA_orig" << "\n"
        int origIndex = 0
        newxValues.each { long x ->
            def alpha_ipol = interpolations[Value.ALPHA].value(x)
            def beta_ipol  = interpolations[Value.BETA].value(x)
            String out = "${x} ,  ${alpha_ipol} , ${beta_ipol}"
            if (x >= xValues[origIndex]) {
                out += ", ${xValues[origIndex]}, ${alphaValues[origIndex]}, ${betaValues[origIndex]}"
                origIndex++
            }
            System.out << out << "\n"
        }
    }
} 
```

![结果输出，绘制在 LibreOffice Calc 中](https://i.stack.imgur.com/qNqC5.jpg)

现在来看一个关于EXTRAPOLATIONS 的离题示例，因为它很有趣。在这里，我们使用与上述相同的数据，但使用 2 次多项式进行外推。当然，还有适当的课程。同样，在 Groovy 中：

```
package example.com

import org.apache.commons.math3.analysis.polynomials.PolynomialFunction
import org.apache.commons.math3.fitting.PolynomialFitter
import org.apache.commons.math3.fitting.WeightedObservedPoint
import org.apache.commons.math3.optim.SimpleVectorValueChecker
import org.apache.commons.math3.optim.nonlinear.vector.jacobian.GaussNewtonOptimizer

class Extrapolate {

    enum Value {
        ALPHA, BETA
    }

    def static xValues     = [
        -284086,
        -94784,
        31446,
        354837,
        667782,
        982191
    ]
    def static alphaValues = [
        71641,
        78245,
        80871,
        94045,
        105780,
        119616
    ]
    def static betaValues = [
        95552,
        103413,
        108667,
        128456,
        144686,
        171953
    ]

    static def getValueByName(Value value, int i) {
        def res
        switch (value) {
            case Value.ALPHA:
                res = alphaValues[i]
                break
            case Value.BETA:
                res = betaValues[i]
                break
            default:
                assert false
        }
        return res
    }

    static PolynomialFunction extrapolate(Value value) {
        //
        // how to check that we converged
        //
        def checker
        A: {
            double relativeThreshold = 0.01
            double absoluteThreshold = 10
            int maxIter = 1000
            checker = new SimpleVectorValueChecker(relativeThreshold, absoluteThreshold, maxIter)
        }
        //
        // how to fit
        //
        def fitter
        B: {
            def useLUdecomposition = true
            def optimizer = new GaussNewtonOptimizer(useLUdecomposition, checker)
            fitter = new PolynomialFitter(optimizer)
            int i = 0
            xValues.each {
                def weight = 1.0
                def y = getValueByName(value, i++)
                fitter.addObservedPoint(new WeightedObservedPoint(weight, it, y))
            }
        }
        //
        // fit using a 2-degree polynomial; guess at a linear function at first
        // "a0 + (a1 * x) + (a2 * x²)"; a linear guess mean a2 == 0
        //
        def params
        C: {
            def mStart = getValueByName(value,0)
            def mEnd   = getValueByName(value,-1)
            def xStart = xValues[0]
            def xEnd   = xValues[-1]
            def a2 = 0
            def a1 = (mEnd - mStart) / (xEnd - xStart) // slope
            def a0 = mStart - (xStart * a1) // 0-intersection
            def guess = [a0 , a1 , a2]
            params = fitter.fit(guess as double[])
        }
        //
        // make polynomial
        //
        return new PolynomialFunction(params)
    }

    static void main(def argv) {
        //
        // Create a map mapping a Value instance to its interpolating function
        //
        def extrapolations = [:]
        Value.values().each {
            extrapolations[it] = extrapolate(it)
        }
        //
        // New x, this times reaching out past the range of the original xValues
        //
        def newxValues = []
        for (long x = xValues[0] - 400000L ; x < xValues[-1] + 400000L ; x += 10000) {
            newxValues << x
        }
        //
        // Write the extrapolated series ALPHA and BETA, adding the original values in columns 4 and 5
        //
        System.out << "X , ALPHA, BETA, X_orig, ALPHA_orig, BETA_orig" << "\n"
        int origIndex = 0
        newxValues.each { long x ->
            def alpha_xpol = extrapolations[Value.ALPHA].value(x)
            def beta_xpol  = extrapolations[Value.BETA].value(x)
            String out = "${x} ,  ${alpha_xpol} , ${beta_xpol}"
            if (origIndex < xValues.size() && x >= xValues[origIndex]) {
                out += ", ${xValues[origIndex]}, ${alphaValues[origIndex]}, ${betaValues[origIndex]}"
                origIndex++
            }
            System.out << out << "\n"
        }
    }
} 
```

![结果输出，绘制在 LibreOffice Calc 中](https://i.stack.imgur.com/Gzgru.jpg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T15:18:56.710

我从来没有做过，但是快速的谷歌搜索显示贝塞尔曲线是在[http://java.sun.com/j2se/1.5.0/docs/api/java/awt/geom/QuadCurve2D.Double.html中实现的](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/geom/QuadCurve2D.Double.html)

然后，您可以从这条曲线中获取PathIterator()，然后根据文档所述，您可以获得“形状边界的坐标”，我想这就是您要寻找的。

# c++ - Displaying different graphics in multiple OpenGL windows

> ID：878201
> 
> 赞同：0
> 
> 时间：2009-05-18T15:07:30.727
> 
> 标签：c++, opengl

I got stuck with displaying multiple windows in openGL... That is if i display two windows, tranformation is not possible in both the windows... Is there any other way i can do it..???

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:19:25.553

每个窗口都应该有自己的 OpenGL 上下文，因此您需要在每个窗口中执行相同的操作以使视图保持一致。如果在第一个上下文中渲染时​​执行几何变换，则只有在第二个上下文中显式执行时，它才会出现在第二个上下文中。

有关您的设置和期望目标的更多详细信息会有所帮助。你在什么平台和框架上工作？您是在尝试从不同窗口中的不同视图渲染相同的场景，还是在不同窗口中渲染不同的场景？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T15:15:35.593

[NeHe OpenGL 教程的教程#42](http://nehe.gamedev.net/data/lessons/lesson.asp?lesson=42)展示了如何拥有多个视口（可以在一个窗口或多个窗口中拥有）。

此外，这里是一些[源代码](http://nehe.gamedev.net/counter.asp?file=data/downloads/L/llamagl_v2.zip)，它是使用多个窗口对该教程的修改。

# excel-2007 - 将日期连接为文本

> ID：878207
> 
> 赞同：2
> 
> 时间：2009-05-18T15:09:42.377
> 
> 标签：excel-2007, concatenation, excel-formula

我正在尝试以下公式：

`=concatenate(A1, " ", B1, " - ", C1)`

其中 A 列是文本，B 和 C 是日期。concatenate 函数返回日期的数值，而不是文本值。我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T15:18:20.890

您可以使用文本

```
=CONCATENATE(A1," ",TEXT(B1,"dd mmm yyyy")," - ",TEXT(C1,"dd/mm/yyyy")) 
```

# iphone - 通过拖动重新排序 iPhone 上的 UITableView 部分（如重新排序行）

> ID：878213
> 
> 赞同：4
> 
> 时间：2009-05-18T15:10:05.010
> 
> 标签：iphone, objective-c, cocoa-touch

SDK 中当前是否有任何内容允许对 tableView 部分进行重新排序？例如，将整个部分移动到相邻部分的下方或上方？这对于单独的 UITableViewCells 来说是合理的。虽然没有看到它为部分完成。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-05-03T21:02:52.753

也许不理想但相当简单，因此值得考虑：将向上/向下按钮添加到您的部分标题。第一个向下，最后一个向上，其他所有的向上和向下。然后通过以编程方式重新排序表格来响应按钮按下。Up 将部分向上移动一个，Down 将部分向下移动一个。马丁

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T17:52:35.697

没有用于移动表格视图部分的内置触摸响应 API - 您必须以编程方式执行此操作，然后发送`[tableView reloadData]`消息或类似内容。

不过，可以想象的是，您创建了一个表格视图，其中每个 UITableViewCell 的视图本身就是一个包含部分数据的 UITableView，因此“主”表格中的单元格可以作为 UITableViewCells 拖动。这将允许您重新排序表中的“部分”，但它们不再是部分 - 它们将是单独的表，每个表都有一个部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-11-10T11:17:17.410

也许作为另一种想法，在表格上 reloadData 仅将这些部分显示为表格上的一种“全部折叠”视图（也许甚至可以对此进行动画处理？）然后有一个部分，包含所有部分作为行元素. 唯一需要的就是一个按钮，它将您的表格设置为这种状态。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-08-24T13:54:08.407

我试图将行从一个部分移动到另一个部分，当然同时更新数据源。但这似乎是不可能完成的任务。中间的空单元格，部分中的错误内容，部分的错误顺序是我得到的唯一结果。

# bash - Bash 脚本，非法编号：08

> ID：878218
> 
> 赞同：5
> 
> 时间：2009-05-18T15:10:37.177
> 
> 标签：bash

我在 ubuntu 中运行了一个非常简单的 bash 脚本，但遇到了一个问题。如果需要，我会发布整个脚本，但我已经缩小了问题的范围。基本上，我想每 15 秒运行一次代码，所以我从这个开始：

```
time=`date +%S`

time2=$((time%15))

if [ $time2 -eq 0 ]

then 
```

等等等等等等……

当时间为 08 秒时，问题就出现了。该脚本以非法编号终止：08。此外，使用时：

```
time2=$(($time%15)) 
```

而不是非法数字错误，它将以算术表达式终止：期望 EOF：“08%15”

我猜 08 不会被解释为数字。或者有一些基本问题，比如它认为它是八进制或什么的。有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T15:16:02.440

最短的解决方案：

```
time2=$(( ${time#0} % 15 )) 
```

`${var#glob}`表示“如果存在则从开头删除” `$var`。`glob`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T15:19:40.063

尝试使用以下标志

```
date +%-S 
```

它说给定`-`，它不会填充。它的基数有问题，将其解释为八进制整数。

无论如何，如果你想每 15 秒做一次，我发现这个更容易理解：

```
while ((1)); do 
    echo do something now...
    sleep 15s
done 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-18T17:59:50.317

强制 Bash 以十进制解释数字，无论有多少填充零：

```
time2=$((10#$time % 15)) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-21T04:58:53.607

你是对的，它把它解释为八进制。bourne shell 对算术替换中以 0 开头的任何数字执行此操作：

```
#~ $ echo $(( 010 ))
8
#~ $ echo $(( 0100 ))
64
#~ $ echo $(( 10#0100 ))
100
#~ $ echo $(( 40#lolwut ))
2213236429 
```

在手册页中查找“base#”以查看有关此“#-forcing”事物的所有详细信息。如果你愿意，你会变得很可笑

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T15:15:10.197

由于您只对“每 15 秒”感兴趣，而不是在您可以使用`date +%s`（*小写* `s`）的那一分钟运行一次，这将为您提供自纪元开始以来的秒数。这不会有前导`0`，因此您的脚本应该可以正常运行。

但是，我想在更广泛的背景下了解您的代码。如果系统由于某种原因运行速度非常慢，则脚本可能仅在第 14 秒和第 16 秒运行，这意味着它将错过执行。

当您执行脚本所做的任何事情时，可能值得触摸文件，然后在文件的最后修改日期为 15 秒或更长时间之前执行您的操作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T15:16:17.090

看起来确实将其解释为八进制。

尝试`date +%S | sed -e 's/^0//'`

# c# - 为什么 main() 中的 try-catch 不好？

> ID：878232
> 
> 赞同：19
> 
> 时间：2009-05-18T15:12:50.077
> 
> 标签：c#, exception

有人可以向我解释为什么认为在 main() 方法中使用 try-catch 来捕获任何未处理的异常是不合适的吗？

```
[STAThread]
static void Main()
{
    try
    {
        Application.Run(new Form1());
    }
    catch (Exception e)
    {
         MessageBox.Show("General error: " + e.ToString());
    }
} 
```

我知道这是不好的做法，但不知道为什么。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-05-18T15:17:50.067

我认为这*不一定是*坏习惯。然而，有一些警告......

我相信无论谁称这种“坏习惯”，都是为了强化这样一种想法，即您应该在*最接近它们发生的地方*捕获异常（即尽可能高地/适当地调用堆栈）。一揽子异常处理程序通常不是一个好主意，因为它大大减少了您可用的控制流。粗粒度异常处理非常重要地*不是*程序稳定性的合理解决方案。不幸的是，许多初学者开发人员认为是这样，并采取了这种笼统的 try-catch 语句这样的方法。

话虽如此，*如果*您在程序的其余部分中正确地使用了异常处理（以细粒度和特定于任务的方式），并在那里相应地处理了错误（而不是仅仅显示通用错误框），*那么*一般尝试-catch 方法中的所有异常`Main`可能是一个有用的东西。这里要注意的一点是，如果您在这个try-catch 中*可重现*`Main`地捕获到错误，那么您要么有错误，要么您的本地化异常处理有问题。

这个 try-catch 的主要用途`Main`纯粹是为了防止您的程序在非常不寻常的情况下崩溃，并且应该只向用户显示（模糊的）用户友好的“致命错误”消息，以及可能在某处记录错误和/或提交错误报告。因此得出结论：这种方法*确实*有其用途，但必须非常小心，而不是出于错误的原因。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-18T15:19:16.740

好吧，这个方法只会捕获主线程中抛出的异常。如果您同时使用[Application.ThreadException](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)和[AppDomian.UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)事件，那么您将能够捕获并记录所有异常。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-18T15:14:58.307

我根本不明白这是多么糟糕的做法。

让您的程序因未处理的异常错误而崩溃不会给您的最终用户灌输任何信心。

也许其他人可以提供相反的观点。

更新：显然你需要做一些有用的例外。

1.  记录它
2.  向用户显示一个对话框，说明应用程序退出的原因（纯文本，而不是堆栈跟踪）
3.  在您的应用程序上下文中有意义的其他内容。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-18T15:17:29.847

我不认为这本身就是一个不好的做法。我认为不好的做法是，如果这是您的应用程序中唯一的 try/catch 块。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-18T15:25:22.827

任何异常都`Main()`可能是致命的。

如果这很容易，它应该在更高的地方处理。如果它超出了您的控制范围，例如`OutOfMemoryException`，那么程序*应该*会崩溃。

崩溃的 Windows 应用程序有一个标准的方法，它们会触发[Windows 错误报告](http://msdn.microsoft.com/en-us/library/windows/desktop/bb513613(v=vs.85).aspx)对话框。（你可能以前见过）。发生这种情况时，您可以注册接收崩溃数据。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-05-18T15:26:18.643

在古代，在 C++ 中放置一个 try/catch 会导致相当严重的性能损失，而在 main 周围放置一个将意味着为所有内容存储额外的堆栈信息，这同样不利于性能。

现在计算机速度更快，程序员对性能的依赖程度降低了，运行时构建得更好，所以它不再那么糟糕了（但你可能会为此付出更多，多年来没有对它的效果进行基准测试）。所以这是古老的民间传说，比如逆向迭代（编译器实际上现在已经为你修复了迭代）。在 C# 中它非常好，但对于 10 年前的人来说，它看起来很可疑。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-18T15:18:49.783

我不确定我认为这是一种不好的做法。您要做的是确保程序崩溃时的异常和当前状态最终掌握在开发人员手中，最好记录日期、时间和使用它的用户。基本上 - 您要确保您的团队拥有调试问题所需的所有信息，无论用户是否向他们询问崩溃。请记住，事实上，许多用户在遇到崩溃时不会联系支持人员。

这里不好的做法是捕获异常，显示一个简单的“错误”对话框，然后关闭应用程序。在这种情况下，该异常的状态将永远丢失。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-18T15:14:12.880

你有一个包罗万象的异常，它将捕获所有东西。因此，如果您的代码中有任何未处理的异常，您将永远看不到它们。

从积极的方面来说，您的应用程序永远不会崩溃！

如果这是必需的行为，那么您需要有足够的日志记录和报告，以让用户和您作为开发人员都知道发生了什么，并尽可能优雅地恢复或退出。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-18T15:20:11.217

从调试的角度来看，这会使生活变得更加困难，因为它使每个异常都成为用户处理的异常。这会改变调试器的行为，除非您中断未处理的异常，这可能存在其他问题。

话虽如此，我认为这是发布时的一个好习惯。此外，我还建议监听[AppDomain.UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)和[Application.ThreadException](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.threadexception.aspx)事件。这将使您可以捕获更多异常（例如一些不会在上面的“全局”处理程序中捕获的系统异常）。

这使您可以记录错误并为用户提供良好、干净的消息。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-05-18T15:20:30.513

改成这个就好了

```
catch(Exception ex)
{
    YourLoggingSystem.LogException(ex);
} 
```

当然，永远不要点击这一行，因为您将在整个代码中使用其他异常处理程序来捕获具有更多上下文的事物。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-18T15:21:47.390

顶级异常处理非常重要，但我建议使用：

```
Application.ThreadException += new ThreadExceptionEventHandler(YourExceptionHandlingMethod); 
```

但是，这只会捕获 GUI 线程上的异常（很像您的 try..catch 块）——您应该为每个新线程使用类似的代码来处理来自它们的任何意外异常。

更多关于它[的信息](http://richnewman.wordpress.com/2007/04/08/top-level-exception-handling-in-windows-forms-applications-part-1/)。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-05-18T15:20:24.477

我并不是说这是不好的做法，但我唯一会做的不同是使用内置事件：

```
 Application.ThreadException += new System.Threading.ThreadExceptionEventHandler(Application_ThreadException);

        static void Application_ThreadException(object sender, System.Threading.ThreadExceptionEventArgs e)
        {
            MessageBox.Show(e.Exception.Message); //or do whatever...
        } 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-18T15:47:05.513

我认为这是不鼓励的，因为异常只被捕获一次，并且可能有多个事情，比如后台线程，需要知道一个进程是否抛出。

这是一个 WinForms 应用程序吗？`Forms.Application.Run`每当线程抛出未处理的异常时引发事件。MSDN 文档试图解释这一点，但他们显示的处理程序不起作用！从 WinForms UE 站点阅读[更新的示例。](http://blogs.msdn.com/winformsue/archive/2006/02/08/527941.aspx)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-05-18T16:15:00.370

如果你的程序试图继续运行，尽管下面有一个无所不知的人知道什么样的违反假设，那么它就处于远程利用安全漏洞（缓冲区溢出、堆损坏）之类的危险区域。将其置于循环中并继续运行是软件质量的一大危险信号。

尽快离开是最好的，例如 exit(1)。登录和退出虽然风险稍大，但还是不错的。

不相信我？斜[接共同弱点枚举 (CWE) 同意](http://cwe.mitre.org/data/definitions/396.html)。与之密切相关的是它反对以这种方式[捕获 NULL 指针取消引用的建议。](http://cwe.mitre.org/data/definitions/395.html)

# asp.net-mvc - 如何仅更新在 MVC 中更改的模型的属性？

> ID：878245
> 
> 赞同：2
> 
> 时间：2009-05-18T15:15:49.897
> 
> 标签：asp.net-mvc, model-view-controller, entity-framework

我正在开发一个允许编辑记录的网络应用程序。有可能两个用户同时在同一个屏幕上工作，如果他们都点击保存，我想尽量减少造成的损害。

如果用户 1 请求该页面，然后更改地址、电话和联系详细信息，但在他单击保存之前，用户 2 请求相同的页面。

User1 然后单击保存并使用 TryUpdateModel() 更新整个模型，如果 User2 只是将一些详细信息附加到 Notes 字段，当他保存时，TryUpdateModel() 方法将用旧详细信息覆盖 User1 保存的新详细信息。

我考虑过将所有模型属性的原始值存储在一个隐藏的表单字段中，然后编写一个自定义 TryUpdateModel 来仅更新已更改的属性，但这感觉有点像我们都经历过的 Viewstate很高兴通过迁移到 MVC 离开。

有没有我不知道的处理这个问题的模式？

你会怎么处理？

**更新：在回答下面的评论时，我正在使用实体框架。**

安东尼

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T15:44:17.673

除非您对在这种情况下发生的事情有任何特殊要求（例如锁定记录，这当然需要一些功能来在用户决定不进行更改的情况下撤消锁定）我建议正常的方法是乐观锁：

您执行的每次更新都应检查记录在此期间没有更改。

所以：

1.  将整数“版本”属性或 guid / rowversion 记录在案。
2.  确保它包含在 html 中的隐藏字段中，因此在任何提交时都会返回；
3.  执行更新时，请确保（数据库）记录的版本/guid/rowversion 仍然与隐藏字段中的值匹配 [如果您决定继续更新，请在执行更新时将“版本”整数加 1使用这种手动方法。]

一种类似的方法显然是在记录上使用日期/时间戳，但不要这样做，因为在系统时钟的准确性范围内，它是有缺陷的。

[我建议你在别处找到对整个方法的更全面的解释。当然，如果您要在谷歌上搜索有关 NHibernate 版本功能的信息...]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T15:21:14.207

一个用户正在处理页面时锁定对页面的修改是一种选择。这是在一些 wiki 软件（如 dokuwiki）中完成的。在这种情况下，它通常会在 5-10 分钟不活动后使用一些 javascript 来释放锁，以便其他人可以更新它。

另一种选择可能是将所有修订存储在数据库中，因此当两个用户提交时，两个副本都被保存并仍然存在。从那里开始，您需要做的就是将两者合并。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T15:22:54.983

你通常不会处理这个。如果两个用户碰巧同时编辑了一个文档并提交了他们的更新，那么他们中的一个获胜，另一个失败。

资源锁定可以通过有状态的桌面应用程序来完成，但是对于 Web 应用程序，您尝试实施的任何锁定方案都可能只会最大限度地减少损坏，但不能防止损坏。

不要试图编写一个绝对完美和安全的应用程序。它已经很好了。就用吧，估计根本不会出现这种情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T11:33:03.953

如果您使用 LINQ to SQL 作为您的 ORM，它可以使用冲突集合处理有关更改值的问题。但是，基本上我同意 Mastermind 的评论。

# java - Web/Meta-Inf/Context.xml 可以从某些属性文件中读取 Tomcat

> ID：878246
> 
> 赞同：6
> 
> 时间：2009-05-18T15:16:01.380
> 
> 标签：java

我的 web/meta-inf/ 文件夹中有 context.xml，其中包含数据库连接（池）详细信息。现在我希望最终用户在某些属性文件中提供我的应用程序的数据库详细信息，并且 context.xml 从属性文件中读取数据库连接信息，而不是直接将它们硬写入文件中。

tomcat 是否可以从某些属性文件中替换占位符？

我阅读了有关上下文管理器的信息，但不确定将其放置在哪里。

请提供您的意见。

谢谢阿布舍克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T12:38:22.143

你可以用更好的方式做到这一点。在我们的案例中，我们为不同的配置文件提供了不同的数据库，例如 dev、UAT、pre-prod、support 等。

所以我所做的是，我将 context.xml 放在它的默认位置`<TOMCAT_HOME>/conf`。

在 context.xml 的资源配置中有以下内容：

```
<Resource name="jdbc/someDS" 
          auth="Container"
          type="javax.sql.DataSource" 
          driverClassName="oracle.jdbc.OracleDriver"
          url="${appName.db.url}"
          username="${appName.db.user}"
          password="${appName.db.password}"
          maxActive="30" 
          maxIdle="10"
          defaultAutoCommit="true"
          maxWait="-1"/> 
```

我创建了三个 tomcat 服务器 - server-dev、server-uat、server-support，并在 eclipse/intellij 的 tomcat 服务器配置中的 tomcat 的 vm 参数中为每个数据库传递了相应的值（如下所示）：

```
-DappName.db.url=jdbc:oracle:thin:@<DB_SERVER>:1521:<SID> -DappName.db.user=DB_USER -appName.db.password=DB_PASSWORD 
```

这样做的好处是，开发人员不需要每次都更改数据库，他们只需要启动一个特定的服务器。这非常方便，在我们的开发过程中节省了大量时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:16:54.033

将 JNDI 资源添加到 Context.xml 是不够的。您还需要在 WEB-INF/web.xml 中定义它们的用途。一步一步检查[这个。](http://tomcat.apache.org/tomcat-5.5-doc/jndi-resources-howto.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-26T17:27:23.150

如果我在构建时没有数据库连接信息，我只需配置一个资源引用并告诉管理员他们需要为连接池提供什么名称。他们可以在 Tomcat 管理控制台中配置所有内容，而我永远不必知道。这也使得构建单个 WAR 文件并在多个环境中使用它变得更加容易，因为数据库配置详细信息不是 WAR 的一部分。

另请参阅： [Apache Tomcat 6.0 JNDI 资源](http://tomcat.apache.org/tomcat-6.0-doc/jndi-resources-howto.html#JDBC%20Data%20Sources)

如果您确实知道构建时的细节并希望将它们烘焙到 WAR 中，请尝试[Ant 过滤器](http://ant.apache.org/manual/Tasks/filter.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T15:18:19.647

据我了解，您的目标是在 .war 之外进行应用程序配置，以允许系统管理员配置系统。

实现此目的的一种方法是不要将 context.xml 放在您的 .war 文件中，而是将该文件与您的 .war 一起分发。然后必须将该文件放在 CATALINA_HOME/conf/Catalina/HOSTNAME/APPLICATIONPATH.xml 中（例如 CATALINA_HOME/conf/Catalina/localhost/myapp.xml）。这样，可以直接在外部上下文配置文件中编辑数据库连接信息，而无需更改 .war 文件，在这种情况下您将不需要占位符。这对用户来说不是最舒服的方式，因为他/她必须编辑 xml 文件，但对于大多数系统管理员来说应该是可行的......

您可以在 tomcat.apache.org/tomcat-5.5-doc/config/context.html 找到有关 tomcat 上下文配置的更多信息

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-30T00:25:06.553

我不确定是否可以从属性文件中加载详细信息，但您可以在中央 server.xml 文件而不是 context.xml 中获取详细信息。一旦实现了这一点，您就可以使用标准的 XML 实体引用将连接细节外部化。

不要将您的数据库连接详细信息放在 context.xml 中，而是将它们放在 server.xml 的一个部分下，然后将 ResourceLink 元素添加到 context.xml 中，该元素在全局数据源和您的上下文之间创建链接。

不幸的是，对于您要实现的目标，文档相当薄弱。按照本页“资源定义”部分（大约一半）的说明进行操作，并特别注意其下方的（微小的）ResourceLink 部分：

[http://tomcat.apache.org/tomcat-5.5-doc/config/globalresources.html](http://tomcat.apache.org/tomcat-5.5-doc/config/globalresources.html)

# unix - Unix 的 'ls' 按名称排序

> ID：878249
> 
> 赞同：151
> 
> 时间：2009-05-18T15:16:18.290
> 
> 标签：unix, ls

[您可以按名称对ls](https://en.wikipedia.org/wiki/Ls)列表进行排序吗？

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2009-05-18T15:19:11.967

我的 ls 默认按名称排序。你在看什么？

`man ls`状态：

`List information about the FILEs (the current directory by default). Sort entries alpha‐betically if none of -cftuvSUX nor --sort is specified.`：

* * *

## 回答 #2

> 赞同：122
> 
> 时间：2009-05-18T15:22:12.350

对于简单的事情，您可以将**ls**与**sort**结合使用。对于文件名列表：

```
ls -1 | sort 
```

要以相反的顺序对它们进行排序：

```
ls -1 | sort -r 
```

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2013-08-26T19:44:06.980

`ls`from默认情况下`coreutils`执行**区域感知**排序，因此在某些情况下可能会产生令人惊讶的结果（例如，将在和之间进行`%foo`排序）。如果你想要一个 ASCIIbetical 排序，使用`bar``quux``LANG=en_US`

```
LANG=C ls 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2011-01-09T22:29:13.737

*nix 工具的美妙之处在于您可以将它们组合起来：

```
ls -l | sort -k9,9 
```

的输出`ls -l`将如下所示

```
-rw-rw-r-- 1 luckydonald luckydonald  532 Feb 21  2017 Makefile
-rwxrwxrwx 1 luckydonald luckydonald 4096 Nov 17 23:47 file.txt 
```

因此，`9,9`您将 column 排序`9`到 column `9`，即文件名。您必须提供停止的位置，在这种情况下是同一列。列以 开头`1`。

此外，如果您想忽略大写/小写，请添加`--ignore-case`到排序命令。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-04-15T07:51:52.823

仅通过数字字符串不同的文件可以在该数字前面带有分隔符的情况下按该数字排序。

在这种情况下，可以使用以下语法：

```
ls -x1 file | sort -t'<char>' -n -k2 
```

例子：

```
ls -1 TRA*log | sort -t'_' -n -k2

TRACE_1.log
TRACE_2.log
TRACE_3.log
TRACE_4.log
TRACE_5.log
TRACE_6.log
TRACE_7.log
TRACE_8.log
TRACE_9.log
TRACE_10.log 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-10-30T21:02:55.770

注意：“a”出现在“Z”之后：

```
$ touch A.txt aa.txt Z.txt 

$ ls 
```

A.txt Z.txt aa.txt

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-05-18T15:19:57.893

从手册页（对于 bash ls）：

> 如果 -cftuSUX 和 --sort 都没有，则按字母顺序对条目进行排序。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2015-04-13T19:45:14.417

该`ls`实用程序应符合 IEEE Std 1003.1-2001 ( [`POSIX.1`](https://en.wikipedia.org/wiki/POSIX#POSIX.1-2001))，其中规定：

> 22027：将目录和非目录操作数按照当前locale的排序顺序分别排序。
> 
> 26027：默认情况下，格式未指定，但**输出应按**符号名称的字母顺序排序：
> 
> *   库或对象名称，如果指定了 -A
> *   符号名称
> *   符号类型
> *   符号的价值
> *   与符号关联的大小（如果适用）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-06-30T20:46:25.327

检查您的`.bashrc`文件中的别名。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-04-02T21:05:21.443

ls -X 用于此目的，以防您将 ls 别名为更有用的默认值。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2020-11-23T20:46:05.607

你可以试试：

`ls -lru`

-u 和 -lt：按访问时间排序并显示；

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-02T18:54:53.817

```
In Debian Jessie, this works nice:

ls -lah --group-directories-first

# l=use a long listing format
# a=do not ignore entries starting with .
# h=human readable
# --group-directories-first=(obvious)
# Note: add -r for reverse alpha

# You might consider using lh by appending to ~/.bashrc as the alias:
~$ echo "alias lh='ls -lah --group-directories-first'" >>~/.bashrc
# -- restart your terminal before using lh command -- 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2021-05-19T13:34:06.350

我使用以下命令获得了按**名称**排序的目录的内容：

`ls -h`

# c# - 如何从页面名称（字符串）的集合中动态实例化 Page 对象？

> ID：878253
> 
> 赞同：0
> 
> 时间：2009-05-18T15:16:37.540
> 
> 标签：c#, wpf

在我的 ViewModel 中，我想从这个页面名称列表中构建一个 Page 对象的集合：

```
private string[] pageNames = {
    "Introduction.xaml",
    "Slide1.xaml",
    "Slide2.xaml"
}; 
```

我如何动态地实例化它们，例如这样的：

```
foreach (string pageName in pageNames)
{
    //PSEUDO CODE:
    Page thePage = new &&pageName();
    thePages.Add(thePage);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T15:26:07.240

您可以使用 XamlReader.Load ：

```
foreach (string pageName in pageNames)
{
    string xaml = File.ReadAllText(pageName);
    Page thePage = XamlReader.Load(xaml);
    thePages.Add(thePage);
} 
```

（我不确定 File.ReadAllText，这取决于你的文件在哪里......）

# publishing - 如何使用 aspnet 编译器发布到服务器

> ID：878263
> 
> 赞同：1
> 
> 时间：2009-05-18T15:17:48.880
> 
> 标签：publishing, aspnet-compiler

当前我正在尝试使用批处理文件发布 usinf aspnet 编译器

开始 /b C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_compiler.exe -p "C:\cc\titr\code\" TargetPath="C:\cc\titr\code\deploy\" 强制＝“真”调试＝“真”

给我错误 1010 文件路径无效。知道我在哪里做错了。因为路径是正确的

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-28T10:24:51.857

在此处查看 Rick Strahl 的用于管理预编译过程的实用程序：[http](http://www.west-wind.com/tools/aspnetcompiler.asp) ://www.west-wind.com/tools/aspnetcompiler.asp 。我不得不说，让命令行参数恰到好处以使 aspnet_compiler 满意并不容易。将所有斜线和空格放在正确的位置非常重要！使用“West Wind ASP.NET 2.0 Compiler Utility”肯定会让您轻松完成这项任务！

还可以看看我的文章系列，了解如何构建一个 StackOverflow 启发的知识交流。在该系列中，我详细介绍了本地构建过程和持续集成。CI 文章也直接涉及这个主题（即将推出！）。 [http://dotnetslackers.com/projects/StackOverflowInspiredKnowledgeExchange/](http://dotnetslackers.com/projects/StackOverflowInspiredKnowledgeExchange/)

在您的情况下，您可以尝试：

```
C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_compiler.exe -p "C:\cc\titr\code" -v / "C:\cc\titr\code\deploy" 
```

您有编译器特别不喜欢的斜杠。我还将您的 TargetPath 换成了 -v 参数。我不认为 TargetPath 是一个论点。

# structuremap - StructureMap：有没有办法获得一个非静态容器？

> ID：878271
> 
> 赞同：2
> 
> 时间：2009-05-18T15:19:25.133
> 
> 标签：structuremap

我见过的所有 StructureMap 示例都使用静态 ObjectFactory 类来初始化和解析对象。但是，我想传递对我的容器的引用。我假设 ObjectFactory 只是一个非静态对象的单例包装器。但它在哪里？

# ruby-on-rails - 如何获得检测“remote_form_for”使用的方法？

> ID：878281
> 
> 赞同：0
> 
> 时间：2009-05-18T15:20:20.403
> 
> 标签：ruby-on-rails, ajax, forms

Rails 的新手......这里有：

如果我希望我的“创建”方法对 AJAX 请求的响应与对普通 POST 请求的响应不同，我可以让该方法检测使用了哪个吗？

或者，对 AJAX 和非 AJAX 请求使用不同的方法会更好吗？

感谢您的输入。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T15:37:20.790

请求.xhr？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T15:49:15.493

或者，您可以使用 respond_to 块：

```
def create
  # ...
  respond_to do |format|
    format.html # for standard requests
    format.js # for AJAX requests
    # other formats...
  end
end 
```

# workflow-foundation - WorkflowInstance 在持久化时中止

> ID：878285
> 
> 赞同：1
> 
> 时间：2009-05-18T15:20:57.860
> 
> 标签：workflow-foundation

我有工作流实例在`WorkflowServiceHost`. 工作流被构建为状态机。我正在使用开箱即用`SqlWorkflowPersistenceService`，配置了`UnloadOnIdle = true`5 分钟的实例锁定时间（在此处尝试了不同的值）。

这些工作流实例运行时间很长，当它们等待接收消息时可能需要数小时或数天。

我现在遇到的问题是，如果工作流实例正在等待消息，则该消息必须在锁定时间内（InstanceState 表中的日期）到达，或者**在收到消息后，一旦下一个持久性点出现，实例就会中止打**。

我一直认为锁定时间必须等于或大于最大值。持久点之间的持续时间。当工作流实例收到消息时，锁定时间不会在 InstanceState 表中更新。

有什么想法可以做吗？

# jquery - Jquery：选择具有特定来源的图像？

> ID：878291
> 
> 赞同：6
> 
> 时间：2009-05-18T15:22:02.770
> 
> 标签：jquery, jquery-selectors

我通过文档和互联网查看了高低，如果我无法弄清楚这一点，该死的。

我想使用 jquery 选择具有特定来源的所有图像并向它们应用工具提示。当我找到带有类的目标时，我的工具提示工作正常，但我认为它会更有效率，并且当我应该能够选择所有具有已知 img 源的图像时避免添加不需要的类。我认为应该工作的代码是：

```
$("img[src*='phone']") 
```

源中的图像标签是：

```
<img src='images/icons/Phone-32x32.png'> 
```

使用 Firebug 的 Dom 检查器，img 元素具有以下来源：

```
"http://www.deleted.com/v2/images/icons/Phone-32x32.png" 
```

我已经尝试过各种选择它的浪潮，它就在我身边。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T15:23:57.540

呃......问题是大写！将其更改为：

```
$("img[src*='Phone']") 
```

现在它工作正常。请忽略我的愚蠢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T08:01:29.847

如果您想要一个不区分大小写的选择器，这个问题可能会有所帮助：

[是否有不区分大小写的 jQuery :contains 选择器？](https://stackoverflow.com/questions/187537/is-there-a-case-insensitive-jquery-contains-selector)

# ruby-on-rails - 如何从顶部部署带有 Capistrano 的 Rails 2.3.2 应用程序（用于 FastCGI）？

> ID：878296
> 
> 赞同：0
> 
> 时间：2009-05-18T15:23:57.057
> 
> 标签：ruby-on-rails, deployment, capistrano, fastcgi

免责声明：我是 Rails 和 Capistrano 的菜鸟（但是是中级 .NET C# 开发人员）试图了解更多信息。

我在设置 Capistrano 开发过程中遇到了最艰难的时期。这是我的 deploy.rb 到目前为止的内容：

```
 set :application, "MyAppName"
set :domain, "domainname"
set :user, "userid" 
set :repository,  "svn+ssh://#{user}@#{domain}/home/#{user}/svn/#{application}/trunk"
set :rails_env, :production
set :chmod755, %w(app config db lib public vendor script tmp public/dispatch.cgi public/dispatch.fcgi public/dispatch.rb)
set :deploy_to, "/home/#{user}/apps/#{application}"
set :use_sudo, false
set :deploy_via, :checkout
set :group_writable, false
default_run_options[:pty] = true
role :app, domain
role :web, domain
role :db,  domain, :primary => true 
```

这是我的 Capfile：

```
 load 'deploy' if respond_to?(:namespace) # cap2 differentiator
Dir['vendor/plugins/*/recipes/*.rb'].each { |plugin| load(plugin) }
load 'config/deploy'

namespace :deploy do

  task :restart, :roles => :app do
    run "#{current_path}/script/process/reaper --dispatcher=dispatch.fcgi"
  end

  desc "Set the proper permissions for directories and files on HostingRails accounts"
  task :after_deploy do
    run(chmod755.collect do |item|
      "chmod 755 #{current_path}/#{item}"
    end.join(" && "))
  end

end 
```

1.  Rails 2.3.2 没有脚本/进程目录，所以重启任务根本不起作用。我该如何解决？
2.  有没有办法在部署应用程序时将 environment.rb 中的 RAILS_ENV 变量设置为“production”（“set :rails_env, :production”不这样做）？
3.  另外，我还遗漏了这两个文件中的其他内容吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:45:29.137

更新了我的答案，请参阅＃3 ...

我不使用 FastCGI 进行部署，但我想到了一些事情：

1.  流程脚本已从 Rails 核心移出并放入[插件](http://github.com/rails/irs_process_scripts/tree/master)中，您可以从 GitHub 获取该插件。
2.  查看我的 deploy.rb 文件，您可能需要通过命令行将 RAILS_ENV 环境变量传递到脚本中，类似于：

    `run #{current_path}/script/process/reaper RAILS_ENV=#{rails_env} --dispatcher=dispatch.fcgi`

3.  编辑：实际上，将您的任务放在 Capfile 而不是 deploy.rb 有点奇怪 - 尽管在[Capistrano Google Group 上查看这个线程](http://groups.google.com/group/capistrano/browse_thread/thread/639aee77b3fbc7b0/6dbb553485434931)，但它并没有完全不被接受。我想这取决于你/你的团队。

希望这能为您指明正确的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T16:18:11.130

这是我的deploy.rb，很久没有真正更新了。我运行两个 sed 命令来设置我的 :after_update_code 任务中的环境。我确信有一种更简单的方法可以做到这一点，但这是我目前的方法。

```
require 'erb'

before "deploy:setup", :db
after "deploy:update_code", "db:symlink" 
after "deploy", "deploy:cleanup"

def prompt_with_default(var, default)
  set(var) do
    Capistrano::CLI.ui.ask "Enter #{var} [#{default}] : "
  end

  set var, default if eval("#{var.to_s}.empty?")
end

default_run_options[:pty] = true 

set :rake, "/usr/local/bin/rake"

set :user, "your username"
set :application, "application name"
set :repository,  "svn repository path"
set :host, "domain name"
set :db_host, "DB host name"
set :db_user, "DB user name"
set :db_prefix, "any DB name prefix your host might require"
set :rails_env, "production"

set :deploy_to, "/home/username/rails/#{host}" # your deployment directory

role :app, host
role :web, host
role :db,  host, :primary => true

set :use_sudo, false
set :checkout, "export"

#
# TASKS
#
desc "Tasks to execute after code update"
task :after_update_code, :roles => [:app, :db, :web] do
  # Make sure we're running in production
  run "sed -i -e '/ENV.*RAILS_ENV/s/# //' #{release_path}/config/environment.rb"
  run "sed -i -e '/ENV.*RAILS_ENV/s/production/#{rails_env}/' #{release_path}/config/environment.rb"

  # Add banned IPs
  deny_lines = []
  File.readlines("#{release_path}/config/banned_ips").each {|ip|
    deny_lines << "deny from #{ip}"
  }

  ip_ban_block = <<EOBAN
# Bannination
order allow,deny
#{deny_lines.join}
allow from all
EOBAN

  run "sed -i -e 's/# BANNED IPS/#{ip_ban_block}/' #{release_path}/public/.htaccess"

  run "chmod +x #{release_path}/script/runner" 
  run "chmod +x #{release_path}/script/process/reaper" 
  run "chmod +x #{release_path}/script/process/spawner" 
  run "chmod 755 #{release_path}/public/dispatch.*" 
end

desc "Restarting after deployment"
task :after_deploy, :roles => [:app, :db, :web] do
  run "cd #{current_path} && rake RAILS_ENV=production db:sessions:clear tmp:clear"
  # fix permissions
  run "dos2unix #{release_path}/public/dispatch.*"
  run "dos2unix #{release_path}/public/.htaccess"
  run "chmod -R 755 #{release_path}"
  run "chmod -R 775 #{release_path}/log #{release_path}/tmp #{release_path}/script"
  run "find #{release_path}/ | xargs touch"
  run "touch #{deploy_to}/current/public/dispatch.fcgi"
end

desc "Restarting after rollback"
task :after_rollback, :roles => [:app, :db, :web] do
  run "touch #{deploy_to}/current/public/dispatch.fcgi"
end

namespace :db do
  desc "Create database yaml in shared path" 
  task :default do
  prompt_with_default(:db_password, "")
  db_config = ERB.new <<-EOF
base: &base
  adapter: mysql
  port: 3306
  host: #{db_host}
  username: #{db_user}
  password: #{db_password}

development:
  database: #{db_prefix}#{application}development
  <<: *base

test:
  database: #{db_prefix}#{application}test
  <<: *base

production:
  database: #{db_prefix}#{application}production
  <<: *base
EOF

    run "mkdir -p #{shared_path}/config" 
    put db_config.result, "#{shared_path}/config/database.yml" 
  end

  desc "Make symlink for database yaml" 
  task :symlink do
    run "ln -nfs #{shared_path}/config/database.yml #{release_path}/config/database.yml" 
  end
end 
```

一旦我设置了我的变量，我就有了一个运行的 bash 脚本：

```
svn export $svn_path . --force
cap deploy 
```

那会要求我输入密码两次。一次用于从 SVN 导出，一次作为提示在共享路径中自动生成我的 database.yml。

# architecture - 工作流引擎有哪些替代品？

> ID：878301
> 
> 赞同：7
> 
> 时间：2009-05-18T15:25:15.463
> 
> 标签：architecture, workflow

我们正在重写一个大量（误用）工作流引擎的大型遗留系统。展望未来，我想考虑新应用程序的工作流引擎的替代方案。一个非常有趣的可能性是基于[空间的架构](https://stackoverflow.com/questions/581212/space-based-architecture)+ 规则引擎。还有哪些其他范式？

我会提到这个应用程序编排了复杂的文档发布工作流程，并根据国家/地区/等进行了许多不同的调整，但如果可能的话，我希望让答案更笼统。

**编辑：**我为这个问题添加了一个赏金以获得更多反馈。我想听听实际实施工作流程替代方案的人的意见。如果什么都没有产生，我会接受 BPEL 的答案，尽管我对技术本身完全不感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:53:28.450

基于 BPEL 的流程是一种选择。如果您设想利用未来的 BPEL 工具来完成这项工作，您就会走这条路。否则，BPEL 有点过于复杂（就像所有这些通用的“都可以插入”解决方案一样）。

一些简单的事情是意识到工作流实际上通常是关于队列而不是工作流。也就是说，它更多地是将某些东西放在某人的桌子上，而不是根据严格的模式来指导工作流程。在这种情况下，包含一个队列的东西，这是一个定义的工作阶段，然后以灵活的方式链接到其他潜在的工作块。有一个通用过程，但该过程也有例外。规则引擎可以作为一般流程在队列之间移动事物（并根据需要启动外部流程），当定义的规则不削减时，用户可以选择将事物任意移动到“正确”队列中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-09T07:45:47.450

这似乎是一个显而易见的回应，但没有其他人提出过，所以这里是：您是否考虑过文档（或内容）管理软件？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-08-11T05:12:27.247

您可以严格地将其作为一个有限状态机引擎来执行，您可以根据用户或文化或其他任何东西动态地构建它。您需要将特定的自动机作为长期运行事务的状态持久化。然后当用户调用状态或采取另一个“动作”（基本上建模为状态转换）时，您允许转换有输出（Mealy 机器）或新状态（Moore 机器）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-20T16:54:21.877

好吧，您已经提到了基于规则的处理。基于事件的处理模型有些相似，但在响应事件方面没有那么正式的约束。总的来说，我不认为一个人必须完全遵守特定的模型。

（例如，基于事件的前端 -> 基于规则的编排 -> 特定（线性）工作流处理。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-09T21:48:50.553

如果你从 30,000 英尺的高度看它，你有两种选择：

*   一个控制进程轮询队列和数据存储，检查什么在哪里，并根据一组规则移动事物。
*   等待收到事件通知并根据一组规则处理它们的系统。

在这两种情况下，“规则”都可以在工作流/编排、规则引擎或代码中定义。

我们选择根据以下标准实施系统：

*   相对简单的规则，直接在代码中实现
*   工作流程中的复杂逻辑。这样我们就可以把它展示给客户，问他们这是否是他们的意思，并且知道这没关系，因为他们正在查看的是执行的内容。
*   基于一组规则移动事物的编排发布/订阅

我使用 MS 技术，因此对于您描述的系统类型，我会在 Sharepoint 中实现它，它有一个文档管理系统和用于文档管理的内置工作流。入门级 Sharepoint 许可证 Windows Sharepoint Services 包含在操作系统中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-11T05:01:35.737

从 KISS 的角度来看，工作流程只不过是队列和规则引擎——我们有一个文档系统，我们有类似处理的工作流程。我们考虑了 websphere 的工作流程以及来自 weblogic 的 WLI，但是一个简单的带有持久存储的 JMS（MDB 和唤醒消费者）对我们来说非常有效，没有任何问题。我认为您在这里采取了正确的方法-祝您好运！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T15:30:57.170

[NetBpm](http://www.netbpm.org)（JBpm 的 .Net 端口）

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2010-09-08T10:12:28.123

你可以考虑 Apache Camel。它是 EIP 和大多数工作流语言，如 if,choice 支持，但您必须为它编写代码。

# c# - 使用带有打印对话框的 Word 互操作进行打印

> ID：878302
> 
> 赞同：10
> 
> 时间：2009-05-18T15:25:20.113
> 
> 标签：c#, printing, interop, ms-word

我正在尝试从我的 C# 代码中打印一个 word 文档。我使用了 12.0.0.0 Word Interop，我想做的是在文档打印之前弹出一个打印对话框。我不能 100% 确定所有这些的语法，因为我无法让我的代码工作:( 有什么想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-18T15:55:33.873

它应该是这样的：

```
object nullobj = Missing.Value;
doc = wordApp.Documents.Open(ref file,
                             ref nullobj, ref nullobj, ref nullobj,
                             ref nullobj, ref nullobj, ref nullobj,
                             ref nullobj, ref nullobj, ref nullobj,
                             ref nullobj, ref nullobj, ref nullobj,
                             ref nullobj, ref nullobj, ref nullobj);

doc.Activate();
doc.Visible = true;
int dialogResult = wordApp.Dialogs[Microsoft.Office.Interop.Word.WdWordDialog.wdDialogFilePrint].Show(ref nullobj);

if (dialogResult == 1)
{
    doc.PrintOut(ref nullobj, ref nullobj, ref nullobj, ref nullobj, 
                 ref nullobj, ref nullobj, ref nullobj, ref nullobj, 
                 ref nullobj, ref nullobj, ref nullobj, ref nullobj, 
                 ref nullobj, ref nullobj, ref nullobj, ref nullobj, 
                 ref nullobj, ref nullobj);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-19T22:46:53.827

接受的答案对我不起作用，所以我找到了另一种方法。这将在后台打印文档`c:\temp.docx`，使 Word 从视图中隐藏。

它使用`Microsoft.Office.Interop.Word`.

```
Word.Application wordApp = new Word.Application();
wordApp.Visible = false;

PrintDialog pDialog = new PrintDialog();
if (pDialog.ShowDialog() == DialogResult.OK)
{
  Word.Document doc = wordApp.Documents.Add(@"c:\temp.docx");
  wordApp.ActivePrinter = pDialog.PrinterSettings.PrinterName;
  wordApp.ActiveDocument.PrintOut(); //this will also work: doc.PrintOut();
  doc.Close(SaveChanges: false);
  doc = null;
}

// <EDIT to include Jason's suggestion>
((Word._Application)wordApp).Quit(SaveChanges: false); 
// </EDIT>

// Original: wordApp.Quit(SaveChanges: false);
wordApp = null; 
```

# c# - 使用 c++/cli 桥连接 c++ 和 c# 代码

> ID：878304
> 
> 赞同：1
> 
> 时间：2009-05-18T15:25:47.257
> 
> 标签：c#, c++, interop, c++-cli

我有一个使用本机 C++ dll 的本机 C++ 代码客户端应用程序。我正在研究将此代码与 c# dll 连接的可能性，因为它们更容易编写。我决定编写一个可以使用 LoadLibrary 加载的 c++/cli 桥接 dll，并将调用传递给 c# dll。

客户端和 dll 之间的通信是这样的，客户端将指针传递给接口对象，然后 dll 通过该接口对象与客户端进行通信。我将此对象包装在 c++/cli 桥接代码中，以便 c# 代码使用它。

桥还应该使用 __declspec(dllexport) 公开几个函数并将这些调用传递给 c# dll，因此它需要有一个指向 ac# 接口的指针，它将传递它们。我想将 ac# 对象与 gcroot<> 包装器一起使用，但问题是我在这两个 dll 之间得到了循环依赖。C# dll 需要引用bridge dll 才能使用包装类，bridge dll 需要引用c# dll 才能使用接口类。

我知道我可以使用 COM 而不是用 gcroot 包装 c# 对象，但我宁愿不这样做。有没有办法解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:31:24.860

只需在 C++/CLI 而不是 C# 中定义接口。这完全消除了对 C# 项目的依赖。

我建议将 C++/CLI 项目视为一个包装器——不要在其中定义任何新接口。只需获取当前 C++ 代码中的内容，并将其包装在“引用类”中，以便您可以从 C# 构造和调用它们。

# java - 具有超过 4gb 元素的 Java 数组

> ID：878309
> 
> 赞同：24
> 
> 时间：2009-05-18T15:26:48.003
> 
> 标签：java, arrays, 64-bit

我有一个大文件，预计大约 12 GB。我想将它全部加载到具有 16 GB RAM 的强大 64 位机器上的内存中，但我认为 Java 不支持那么大的字节数组：

```
File f = new File(file);
long size = f.length();
byte data[] = new byte[size]; // <- does not compile, not even on 64bit JVM 
```

Java可以吗？

Eclipse 编译器的编译错误是：

```
Type mismatch: cannot convert from long to int 
```

javac 给出：

```
possible loss of precision
found   : long
required: int
         byte data[] = new byte[size]; 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-18T15:32:07.493

Java 数组索引是类型`int`（4 字节或 32 位），所以恐怕您的数组中限制为 2 ^(31) - 1 或 2147483647 个插槽。我会将数据读入另一个数据结构，例如二维数组。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2011-04-03T21:38:57.297

```
package com.deans.rtl.util;

import java.io.FileInputStream;
import java.io.IOException;

/**
 * 
 * @author william.deans@gmail.com
 *
 * Written to work with byte arrays requiring address space larger than 32 bits. 
 * 
 */

public class ByteArray64 {

    private final long CHUNK_SIZE = 1024*1024*1024; //1GiB

    long size;
    byte [][] data;

    public ByteArray64( long size ) {
        this.size = size;
        if( size == 0 ) {
            data = null;
        } else {
            int chunks = (int)(size/CHUNK_SIZE);
            int remainder = (int)(size - ((long)chunks)*CHUNK_SIZE);
            data = new byte[chunks+(remainder==0?0:1)][];
            for( int idx=chunks; --idx>=0; ) {
                data[idx] = new byte[(int)CHUNK_SIZE];
            }
            if( remainder != 0 ) {
                data[chunks] = new byte[remainder];
            }
        }
    }
    public byte get( long index ) {
        if( index<0 || index>=size ) {
            throw new IndexOutOfBoundsException("Error attempting to access data element "+index+".  Array is "+size+" elements long.");
        }
        int chunk = (int)(index/CHUNK_SIZE);
        int offset = (int)(index - (((long)chunk)*CHUNK_SIZE));
        return data[chunk][offset];
    }
    public void set( long index, byte b ) {
        if( index<0 || index>=size ) {
            throw new IndexOutOfBoundsException("Error attempting to access data element "+index+".  Array is "+size+" elements long.");
        }
        int chunk = (int)(index/CHUNK_SIZE);
        int offset = (int)(index - (((long)chunk)*CHUNK_SIZE));
        data[chunk][offset] = b;
    }
    /**
     * Simulates a single read which fills the entire array via several smaller reads.
     * 
     * @param fileInputStream
     * @throws IOException
     */
    public void read( FileInputStream fileInputStream ) throws IOException {
        if( size == 0 ) {
            return;
        }
        for( int idx=0; idx<data.length; idx++ ) {
            if( fileInputStream.read( data[idx] ) != data[idx].length ) {
                throw new IOException("short read");
            }
        }
    }
    public long size() {
        return size;
    }
}
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-18T15:32:20.660

如有必要，您可以将数据加载到数组数组中，这将为您提供最大 int.maxValue**平方**字节，甚至比最强大的机器在内存中的容量还要多。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-18T16:30:00.467

您可以考虑使用 FileChannel 和 MappedByteBuffer 对文件进行内存映射，

```
FileChannel fCh = new RandomAccessFile(file,"rw").getChannel();
long size = fCh.size();
ByteBuffer map = fCh.map(FileChannel.MapMode.READ_WRITE, 0, fileSize); 
```

编辑：

好的，我是个白痴，看起来 ByteBuffer 也只需要一个 32 位索引，这很奇怪，因为 FileChannel.map 的大小参数很长……但是如果您决定将文件分成多个 2Gb 块对于加载，我仍然推荐内存映射 IO，因为它可以带来相当大的性能优势。您基本上将所有 IO 责任转移到操作系统内核。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-18T15:32:32.110

我建议你定义一些“块”对象，每个对象都在一个数组中保存（比如）1Gb，然后制作一个数组。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-05-18T15:34:48.020

不，数组由`int`s 索引（除了一些使用`short`s 的 JavaCard 版本）。您需要将其分割成更小的数组，可能包装在一个类型中，从而为您提供`get(long)`,`set(long,byte)`等。对于这么大的数据部分，您可能希望使用 java.nio 映射文件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-01-23T09:36:55.187

**不要用 Integer.MAX_VALUE 限制你自己**

虽然这个问题在很多年前就被问过了，但是 ai 想通过一个简单的例子来参与，只使用 java se 没有任何外部库

首先让我们说这在理论上是不可能的，但实际上是可能的

**一个新的外观**：如果数组是元素的对象，那么拥有一个数组的对象呢？

这是示例

```
import java.lang.reflect.Array;
import java.util.ArrayList;
import java.util.List;

/**
*
* @author Anosa
*/
 public class BigArray<t>{

private final static int ARRAY_LENGTH = 1000000;

public final long length;
private List<t[]> arrays;

public BigArray(long length, Class<t> glasss)
{
    this.length = length;
    arrays = new ArrayList<>();
    setupInnerArrays(glasss);

}

private void setupInnerArrays(Class<t> glasss)
{
    long numberOfArrays = length / ARRAY_LENGTH;
    long remender = length % ARRAY_LENGTH;
    /*
        we can use java 8 lambdas and streams:
        LongStream.range(0, numberOfArrays).
                        forEach(i ->
                        {
                            arrays.add((t[]) Array.newInstance(glasss, ARRAY_LENGTH));
                        });
     */

    for (int i = 0; i < numberOfArrays; i++)
    {
        arrays.add((t[]) Array.newInstance(glasss, ARRAY_LENGTH));
    }
    if (remender > 0)
    {
        //the remainer will 100% be less than the [ARRAY_LENGTH which is int ] so
        //no worries of casting (:
        arrays.add((t[]) Array.newInstance(glasss, (int) remender));
    }
}

public void put(t value, long index)
{
    if (index >= length || index < 0)
    {
        throw new IndexOutOfBoundsException("out of the reange of the array, your index must be in this range [0, " + length + "]");
    }
    int indexOfArray = (int) (index / ARRAY_LENGTH);
    int indexInArray = (int) (index - (indexOfArray * ARRAY_LENGTH));
    arrays.get(indexOfArray)[indexInArray] = value;

}

public t get(long index)
{
    if (index >= length || index < 0)
    {
        throw new IndexOutOfBoundsException("out of the reange of the array, your index must be in this range [0, " + length + "]");
    }
    int indexOfArray = (int) (index / ARRAY_LENGTH);
    int indexInArray = (int) (index - (indexOfArray * ARRAY_LENGTH));
    return arrays.get(indexOfArray)[indexInArray];
} 
```

}

这是测试

```
public static void main(String[] args)
{
    long length = 60085147514l;
    BigArray<String> array = new BigArray<>(length, String.class);
    array.put("peace be upon you", 1);
    array.put("yes it worj", 1755);
    String text = array.get(1755);
    System.out.println(text + "  i am a string comming from an array ");

} 
```

此代码仅受`Long.MAX_VALUE`Java**堆**的限制，但您可以根据需要超出它（我将其设为 3800 MB）

我希望这很有用并提供一个简单的答案

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-18T15:33:43.730

Java 数组使用整数作为索引。因此，最大数组大小为 Integer.MAX_VALUE。

（不幸的是，我无法从 Sun 自己那里找到任何证据，但他们的[论坛上已经有](http://forums.sun.com/thread.jspa?threadID=5384991&tstart=1)[很多](http://forums.sun.com/thread.jspa?threadID=584445)关于它的[讨论](http://forums.sun.com/thread.jspa?threadID=5384991&start=15&tstart=0)。）

我认为您在此期间可以做的最好的解决方案是制作一个二维数组，即：

```
byte[][] data; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-05-18T15:42:36.007

正如其他人所说，所有类型的所有 Java 数组都由 索引`int`，因此最大大小可以是 2 ^(31) - 1 或 2147483647 个元素（约 20 亿个）。这是由[Java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/arrays.html#10.1)指定的，因此切换到另一个操作系统或 Java 虚拟机将无济于事。

如果您想按照上面的建议编写一个类来克服这个问题，您可以使用数组数组（以获得很大的灵活性）或更改类型（a`long`是 8 个字节，因此 a`long[]`可以比 a 大 8 倍`byte[]`）。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2011-04-05T09:26:46.550

java目前不支持超过2^32个元素的直接数组，

希望以后能看到java的这个特性

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-07-06T04:27:48.463

我认为内存映射文件的想法（使用 CPU 的虚拟内存硬件）是正确的方法。除了 MappedByteBuffer 与本机数组具有相同的 2Gb 限制。这个人声称已经用一个非常简单的 MappedByteBuffer 替代方案解决了这个问题：

[http://nyeggen.com/post/2014-05-18-memory-mapping-%3E2gb-of-data-in-java/](http://nyeggen.com/post/2014-05-18-memory-mapping-%3E2gb-of-data-in-java/)

[https://gist.github.com/bnyeggen/c679a5ea6a68503ed19f#file-mmapper-java](https://gist.github.com/bnyeggen/c679a5ea6a68503ed19f#file-mmapper-java)

不幸的是，当您读取超过 500Mb 时，JVM 会崩溃。

# silverlight - Silverlight：为 Web 服务加密用户名和密码

> ID：878312
> 
> 赞同：3
> 
> 时间：2009-05-18T15:29:08.933
> 
> 标签：silverlight, encryption

加密不是我的强项。

我正在 Silverlight 3 中编写一个应用程序，它与 Web 服务通信以对用户进行身份验证。Web 服务不一定托管在 SSL 下。我试图找到一种在传递用户名和密码之前可逆地加密用户名和密码的方法，这种方法不依赖于将密钥和盐硬编码到 Silverlight 程序集中。它不支持 RSA（或任何非对称算法），所以我不能使用来自服务器的公钥。

有没有做这种事情的模式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T15:44:18.700

RSA 确实是最好的方法，但在 Silverlight 2 或 3 库中确实没有实现。在我看来，这是真的应该添加的东西，尽管在 Silverlight 4 之前它不太可能发生。不幸的是，自定义 RSA 实现可能真的很痛苦，所以我期望它不太可行。

这是我提出的解决方案......它当然不像简单地从服务器发送公钥那么简单，但它仍然应该安全地完成这项工作。

1.  使用[Diffie-Hellman 密钥交换](http://en.wikipedia.org/wiki/Diffie-Hellman)算法就用于以后加密的密钥达成一致。这是为在不安全的通道上工作而设计的，因此这里没有问题。有关C# 实现，请参见[此处。](http://www.mentalis.org/soft/class.qpx?id=15)
2.  使用某种对称加密和 Diffie-Hellman 交换建立的密钥来通过连接发送用户名/密码。然后服务器可以使用相同的密钥解密，虽然客户端和服务器都*知道*，但任何第三方都不知道。在这种情况下，您的对称加密算法的强度实际上并不重要。（如果我错了，请有人纠正我。）事实上，一个简单的 XOR 密码应该可以完成这项工作。看来您也可以使用[AES](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aesmanaged(VS.95).aspx)标准，该标准*包含*在`System.Security.Cryptography`Silverlight BCL 的命名空间中。

希望有帮助。如果您对任何一点不清楚，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-19T09:31:29.337

这是 Silverlight 中用于 RSA 加密的开源库 [http://www.riawebsoft.ru/Silverlight/Rsa/Test.aspx](http://www.riawebsoft.ru/Silverlight/Rsa/Test.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-11-29T18:31:39.020

我发布了一个与 .NET RSACryptoServiceProvider（PKCS 和 OAEP）兼容并且符合 RSA 标准的 RSA 库。它是开源的：

[http://scrypt.codeplex.com](http://scrypt.codeplex.com)

# web-applications - 有关网络爬取技术的信息

> ID：878314
> 
> 赞同：2
> 
> 时间：2009-05-18T15:29:23.490
> 
> 标签：web-applications, web-crawler

我正在构建一个小型网络爬虫，我想知道是否有人对实际实现有一些有趣的信息（只是爬行，没有搜索，没有排名，没有分类，只是爬行，亲吻:)。

作为记录，我已经有了 O'Reilly “Spidering hacks”和 No Starch Press “Webbots, spiders, and screen scrapers”。这些书非常好，但它们往往使事情变得简单，并且没有详细说明缩放、存储数据、并行内容和其他更高级的主题。当然，我可以查看现有开源爬虫的代码，但这会在另一边进行（C++ 爬虫似乎很复杂......）。我正在寻找一些有趣/额外的信息。

欢迎任何帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T11:54:56.347

如果您对网络爬虫的实现细节感兴趣，您可以研究现有的开源实现。这是[Java 中的开源爬虫](http://java-source.net/open-source/crawlers)列表。这些项目中的大多数都处于非活动状态。但是 Internet Archive 的爬虫[**Heritix**](http://crawler.archive.org/)和 Apache [**Nutch**](http://lucene.apache.org/nutch/)是成熟的活跃项目，有很多值得学习的地方。

# java - 如何从 Java 文件中读取数字？

> ID：878316
> 
> 赞同：0
> 
> 时间：2009-05-18T15:30:16.030
> 
> 标签：java, file-io

如何从我的 file.txt 中读取输入（字母、数字），其中它可以无限读取，但只有在遇到特殊符号时才会停止？同时当它是数字时

```
123,345,abc 
```

它应该翻译 ascii 代码并添加结果为 123 + 345 = 468 的 2 个值

**编辑问题**

这是我的代码；在我的 file.txt 中读取这些字节时，我真的遇到了问题。我想将其值转换为类似地将其添加到我的 file.txt

```
public class .... {

    static char tmp = 0;

    public static void main(String[] args) {
        try {
            Reader myReader = new FileReader("MyFolder/myFile2.txt");

            List<Character> myList = new ArrayList<Character>();

            /*for(int myData = myInputStream.read();
                  myData != -1;
                  myData = myInputStream.read()){
                System.out.print(" " + (char)myData);
            }*/

            for(int myData = myReader.read();
                myData != -1;
                myData = myReader.read()){
                if((char)myData != ','){
                    myList.add((char)myData);
                }
                else{
                    continue;
                }
            }
            for(Character i: myList)
            {
                tmp = 1;
            }
            String myString = String.valueOf(tmp);
            int num1 = Integer.parseInt(myString);
            int num2 = Integer.parseInt(myString);
            int equal = num1 + num2;

            System.out.print(equal);

            myReader.close();
        }
        catch(FileNotFoundException e){

        }
        catch(IOException e){

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T19:12:58.827

这里有一些基本的代码来做我认为你所要求的，建立在你已经拥有的基础上。

```
public class .... {

    private static final Pattern COMMA = Pattern.compile(",");

    public static void main(String[] args) {
        try {
            BufferedReader myReader =
                    new BufferedReader(new FileReader("MyFolder/myFile2.txt"));

            List<Integer> myList = new ArrayList<Integer>();
            int total = 0;
            String line;
            while ((line = myReader.readLine()) != null) {
                for (String token : COMMA.split(line)) {
                    try {
                        total += Integer.parseInt(token);
                    } catch (NumberFormatException ex) {
                        System.err.println(token + " is not a number");
                    }
                }
            } 

            System.out.print(total);

            myReader.close();
        } catch(FileNotFoundException e){

        } catch(IOException e){

        }
    }
} 
```

请注意，最好重新构造它，这样它就不会全部在 中`main()`，并且异常处理不是很好，但我只是在这里了解基础知识。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T19:07:22.957

你工作太努力了，你把你的解析逻辑和你的文件遍历混合在一起，这使得事情看起来比实际复杂得多：

-遍历文件的行；

```
 BufferedReader r = new BufferedReader(new FileReader(myFile)); 
 String line;
  while ((line=r.readLine())!=null)
 {
   parseLine(line)
  } 
```

-将文件的行解析为您期望的形式。如果表格错误，它会失败。

```
private void parseLine(String line)
{
  try{ 
    String[] values = line.split(",");
    //do something useful assuming the line is properly formed
   }
   catch(Exception e)
   {
      //how do you want to handle badly formed lines?
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2009-05-18T15:41:26.353

您可能想查看[Apache IO](http://commons.apache.org/io/)项目。它极大地简化了 Java 文件操作。

一旦你有了这个库，你就可以使用

```
int finalnumber = 0;
LineIterator it = FileUtils.lineIterator(file, null);
while (it.hasNext()) {
    List<String> segments = Arrays.asList(it.nextLine().split(","));
    for (String segment : segments) {
        try {
            finalnumber += Integer.parseInt(segment);
        } catch (NumberFormatException nfe) {
            //not a number, ignore
        }
    }
}
LineIterator.closeQuietly(it);
System.out.println(finalnumber); 
```

这将把最后一行的所有数字加在一起，忽略非数字。

如果有人想指定如何使用 Apache IO 执行此操作，他们可以发布它。我只是发现标准的 Java IO 使用起来很麻烦，所以我完全避免了它。

与这里的其他代码相比，这看起来并不简单，但 Apache IO 确实在幕后做了很多异常处理和细节（因为它是开源的，所以你可以看到）。如果这就是您想做的全部，那么您将可以使用标准 Java IO，但如果您想进一步使用 Java IO，我仍然推荐它。

# user-interface - 有谁知道 Io 语言的 GUI 库

> ID：878317
> 
> 赞同：9
> 
> 时间：2009-05-18T15:30:30.883
> 
> 标签：user-interface, programming-languages, iolanguage

**Io**是一个不错的跨平台基于原型的面向对象语言。

有人知道 Io 的任何 GUI 库吗？

Io 的名字并不适合谷歌。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-03-13T23:06:45.903

“官方”GUI 库被称为`Flux`（以前称为 Ion），可以在主存储库中找到

[http://github.com/stevedekorte/io/tree/master/addons/Flux/](http://github.com/stevedekorte/io/tree/master/addons/Flux/)

它基于 `OpenGL，因此与平台无关（在任何支持 OpenGL 的平台上运行）。

[编辑]可以在示例目录中找到
有关如何使用的一些示例：`Flux`

[http://github.com/stevedekorte/io/tree/master/addons/Flux/samples/](http://github.com/stevedekorte/io/tree/master/addons/Flux/samples/)

其中一些可能无法正常工作。欢迎提交错误报告:-)。
[/编辑]

绑定是不久前创建的`GTK+`，据我所知不再维护。我不建议使用它，除非有人想要更新它以使用当前版本编译并维护它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-12-09T16:52:25.263

[用于 Io 的 GTK+ 绑定](http://www.quantumg.net/iogtk/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T15:56:32.280

据此[，](http://portal.acm.org/citation.cfm?id=1094855.1094916)有：

> Io 绑定了许多多平台库，包括 Sockets、OpenGL、FreeType、PortAudio 等，以及一些用于透明分布式对象的模块和用 Io 编写的用户界面工具包。

此外，您可以通过目标 C 绑定来使用 Cocoa，并且语言作者曾一度致力于开发一个名为[Ion](http://osdir.com/ml/lang.io/2004-01/msg00192.html)的基于 openGL 的接口。我也经常看到“IoDesktop”这个词。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T16:00:17.233

据此[，](http://osdir.com/ml/lang.io/2004-01/msg00192.html)您可以在 linux 和 OSX 上使用 GNUstep。有一天，我玩了几个小时的 GNUstep，发现它相当愉快。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-15T18:56:47.730

根据[这篇文章](http://www.iolanguage.com/blog/blog.cgi?do=item&id=107)，有一个用于[开罗](http://cairographics.org/)绑定的库。[此外，我在他们的项目列表](http://iolanguage.com/community/projects/)中注意到 GTK+ 的 IO 库，但[链接](http://rtfm.insomnia.org/~qg/iogtk/)似乎已失效。

*如果您能够访问该（死）页面，请在此处分享。*

# asp.net-mvc - 如何使用 Html.BeginForm() 传入 ID？

> ID：878330
> 
> 赞同：41
> 
> 时间：2009-05-18T15:33:19.113
> 
> 标签：asp.net-mvc

在[ASP.NET MVC](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework)中，我使用 HTML 助手

```
Html.BeginForm("ActionName", "Controller", FormMethod.Post); 
```

但我需要发布到：/controller/action/23434

我如何传递身份证？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-05-18T15:49:30.733

马特的应该可以正常工作。但是，如果您仍在传递`FormMethod.Post`，则需要这样做：

```
Html.BeginForm("action","controller", new { Id = 12345 }, FormMethod.Post); 
```

颠倒第三个和第四个参数将导致`Id`被视为属性而不是路由值。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-18T15:35:49.047

`Html.BeginForm("action", "controller", new {Id = 12345})`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-10-09T18:39:43.237

```
Html.BeginForm("action", "controller", new { id = ViewBag.FileID },
FormMethod.Post, new { id = "feedbackform" }) 
```

至于查询字符串，`?type=golden`我不知道该怎么做。当然，查询是一种获取，它破坏了`FormMethod.Post`. 我的意思是`FormMethod.Get`，如果你想要查询字符串数据，你可以使用，这可能就是你要找的。

此外，您可以`html.beginform`使用表单标签手动避免和执行查询字符串、get + post。

第三，如果你使用表单，你可以做一个隐藏字段：

```
[input type=hidden name="type" value="golden"] 
```

然后，当按下提交按钮时，该值作为表单变量正确传递。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-09T07:48:11.683

```
<!-- ACTION: Category/Update/Id | Method:Post-->
@using (Html.BeginForm("Update", "Category",new {Id = @Model.Id },FormMethod.Post)){} 
```

# visual-studio-2008 - 类型的值 ' ' 不能转换为

> ID：878335
> 
> 赞同：3
> 
> 时间：2009-05-18T15:34:04.680
> 
> 标签：visual-studio-2008, unit-testing, mstest

我正在开发一个使用 VS 2008 中内置的测试工具的项目。

我会定期看到类似于以下内容的错误：“AcademyPro.Code.BLL.Appearance”类型的值无法转换为“AcademyPro.Code.BLL.Appearance”。类型不匹配可能是由于文件引用与对程序集“AcademyPro”的项目引用混合造成的。尝试将项目“AcademyPro”中对“academypro.dll”的文件引用替换为对“AcademyPro”的项目引用。

现在，在一个级别上，错误是正确的，有一个项目引用（编译代码所需）和一个文件引用（在一个名为 AcademyPro.accessor 的文件中）

如果我删除这些引用中的任何一个，则测试项目无法编译。我已经尝试删除两个引用，清理构建并将它们重新添加。这似乎没有帮助。

看来我处于迷失的境地，我需要项目引用来编译，我需要访问器引用以便构建私有对象访问器，我需要能够编译。

我需要做什么才能再次编译？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T14:59:50.993

经过大量挖掘后，我发现我试图测试的项目（不是单元测试项目）有一个对自身的项目引用。我不知道它为什么或如何引用自身，但确实如此。我删除了这个引用，现在一切都正确编译了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-03T19:24:35.277

我也遇到了同样的问题，我通过删除项目的所有引用来修复它，再次重新打开解决方案，然后添加引用，它对我有用。（从谷歌得到这个解决方案）

# asp.net - 文本框的asp.net自定义onfocus事件

> ID：878339
> 
> 赞同：1
> 
> 时间：2009-05-18T15:35:20.013
> 
> 标签：asp.net

是否可以为文本框控件创建自定义 onfocus 服务器端事件？

当文本框具有焦点时，我想简单地触发服务器端方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T15:39:03.783

没有内置任何内容，因为聚焦文本框不会导致页面自行提交。您总是可以将一个事件附加到客户端的焦点上，然后向服务器提交一些 AJAX 请求，但我很想知道您究竟想在这里实现什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T16:31:09.217

我强烈建议为此使用客户端验证。您可以为此使用 ASP.NET 验证器。验证器的属性之一是将焦点设置在错误上。这对于您正在尝试做的事情应该绰绰有余，它还限制了服务器端往返的次数。

如果您真的很有创意，可以查看其他一些验证选项和 AJAX 控制面板扩展程序。那里有一些非常时髦的验证器控件。另一种选择是考虑使用一些 jQuery 验证。

您仍然应该在服务器上进行验证，但是您所描述的听起来像是首先进行客户端验证的完美选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T16:12:55.883

服务器端 onFocus 真的是正确的解决方案吗？如果您想要验证弹出窗口等，您可能最好使用客户端解决方案。当您简单地选择文本框时提交表单并不是很好的可用性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T16:14:34.537

您可以使用连接到某些 AJAX 调用的自定义验证器来执行此操作，但是如果服务器上有需要验证当前数据的数据，则只需执行一次服务器之旅。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T16:08:24.597

好的，我有一个 Web 表单并在提交验证时进行，如果页面上有错误，那么这些错误将存储在状态中并显示警告标志。

现在，当用户遇到错误时，我希望在他们当前正在纠正的文本框旁边显示一个弹出框。

为此，我希望将一个事件附加到 onfocus 类型的句柄。

# c# - 当返回类型为接口时，Delegate.CreateDelegate 失败

> ID：878342
> 
> 赞同：0
> 
> 时间：2009-05-18T15:36:02.603
> 
> 标签：c#, .net, delegates

我看不到此代码失败的原因（错误绑定到目标方法。）

```
 public interface Interface
    {}

    public class Implementation : Interface
    {}

    public class Program
    {
      public static void Main()
      {
        Invoke();
      }

      public Interface SomeMethod(object arg)
      {
          return new Implementation();
      }

      public void Invoke()
      {
        Delegate someMethod = Delegate.CreateDelegate(typeof(Func<Interface, object>), this, "SomeMethod");
      }
    } 
```

尝试了不同的 CreateDelegate 重载，结果相同：当目标方法返回接口类型时，将委托绑定到方法失败。任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T15:40:32.377

您的模板参数是向后的，应该是 `Func<object,Interface>`

# php - PHP 性能有多好？

> ID：878344
> 
> 赞同：17
> 
> 时间：2009-05-18T15:36:13.803
> 
> 标签：php, performance

这是我最近看到的一篇文章的后续文章，该文章表明 PHP 性能很差：

“PHP。一直是。瓶颈。我的服务器场，让我向您展示它们！[PHP 整体性能](http://talks.php.net/show/drupal08/7)”

其次是：

“PHP 的性能非常*糟糕*。我基于我在 OpenX（在 Linux 上）和 WordPress（在 win64 上）的经验。”

我们能否就 PHP 性能的好坏获得一些客观的社区意见...

1.  与其他语言/运行时相比
2.  从语言的角度来看，是否有任何特定的库或操作比其他库或操作更好或更差？
3.  从构建的角度来看，有没有比其他版本更好或更差的版本或平台？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-05-18T15:58:51.823

“PHP 性能有多好？”的答案 是“足够好”。

我的意思是，网站的大多数性能问题都与其他问题有关，例如糟糕的数据库设计、几乎没有缓存、CSS/JavaScript/图像缓存等等。

PHP 被 Internet 上一些最大的站点使用，因此它通过了该测试。Jeff Atwood 认为[PHP 很烂，但没关系](http://www.codinghorror.com/blog/archives/001119.html)。有一些事情可以正确地批评 PHP（例如，不一致的参数顺序、不一致的函数命名、魔术引号等），但我认为他夸大了负面影响。

因此，不要根据假定的性能选择（或不选择）PHP，因为它无关紧要（与其他一切相比）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T16:02:55.980

PHP的性能很好。当然，除非你正在设计 3D 游戏。

1.  差异既可以忽略不计，也可以诱饵。因为，真的，是“谁在乎它是否快速扩展”的 Ruby 主义？都错了吗？请参阅 #2 了解减慢您速度的示例。

2.  任何需要时间的事情。（讽刺，我知道。）但实际上，这总是取决于*你如何做你所做*的事情，这需要时间。例如，我可以编写两个输出几乎相同的查询，但使用更好的语法/选择可以将速度提高 2.5 倍。总的来说，PHP 脚本中最浪费时间的是*文件访问*……这要归功于硬件。因此，您包含/需要的文件数量比其内容更能减慢脚本的速度——尤其是在碎片化时。

    通过这个简单的系统，我操纵了自己的 MVC 框架，使其速度几乎是基本 CodeIgniter 应用程序的 10 倍；它更简单，更简约，是的，但它应该表明，包括 1 个文件，而不是每个类 1 个，可以在速度上产生**巨大**差异。

3.  只要它的 *AMP 很好，Linux 服务器就会或者当然会更快。尽管硬件和软件差异很大，但我对 WAMP 和 LAMP 系统都很满意。（但一般来说，LAMP 系统是最快的，尽管硬件较少。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T15:49:46.490

目前[，PHP 开发人员正在开展一个项目，](http://wiki.php.net/rfc/better_benchmarks)旨在为 PHP 构建更好的 Benchmark 工具。

项目负责人最近在 Google Techtalks 上做了一个名为[Compiling and Optimizing Scripting Languages](http://www.youtube.com/watch?v=kKySEUrP7LA)的演讲，这是一个非常有趣的演讲。

前几天我还检查了 PHP 应用程序大小。

*   PHPBB 1.3mb
*   Joomla 6mb
*   WordPress 11.3mb

那是加载到内存中的数据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T16:06:53.697

与使用某种编程语言相比，使用正确的算法和数据结构与性能更相关（只要可以用所选语言表达它们）。

因此，如果 PHP 程序员知道自己在做什么，那么 PHP 甚至可以比 C++ 更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T20:31:17.530

[通过使用像The Alternative PHP Cache](http://pecl.php.net/package/APC)这样免费的操作码缓存可以极大地提高性能，并且通过本质上将您的脚本“编译”成可以由 Zend 引擎直接使用的操作码，从而显着提高性能（过度使用术语 IMO) 解析每个请求的代码。[您可以在此处](http://blog.digitalstruct.com/2007/12/23/php-accelerators-apc-vs-zend-vs-xcache-with-zend-framework)查看基准测试和我的博客中有关使用 APC 缓存[加速 Zend_Loader的帖子](http://codenaked.org/archives/4-A-faster-Zend_Loader.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T11:50:38.363

雅虎！使用 PHP。 [http://public.yahoo.com/bfrance/radwin/talks/yahoo-phpcon2002.htm](http://public.yahoo.com/bfrance/radwin/talks/yahoo-phpcon2002.htm)

我不同意 PHP 始终是瓶颈。PHP 与 Java 或 ASP 一样具有可扩展性和高效性。在路的尽头，它归结为您的数据库，瓶颈总是从那里开始。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-19T12:10:43.423

PHP 可能不如已编译的服务器端语言快，但它仍然非常快并且可以完成工作。

php 的“速度”方面与用户体验有关，而不是与性能本身有关。

基于 PHP 的 AJAX 应用程序不会被归类为“慢”或“无响应”：当单个请求完成时，用户有很多事情要做！此外，与表现出不稳定的性能速度相比，对用户来说，所有操作都“一律慢”要少得多。

之前的评论之一已经非常贴切地总结了它：语言不影响速度！应用程序doez。

干杯，jrh

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-21T06:21:07.280

您可能会发现 Rasmus 演讲的这些幻灯片有些相关且有趣：talks.php.net/show/drupal08/

# visual-studio - 用户 AppData 文件夹中的 ReflectedSchemas 文件夹 (Visual Studio)

> ID：878345
> 
> 赞同：31
> 
> 时间：2009-05-18T15:36:28.030
> 
> 标签：visual-studio, temporary-files

今天我运行[WinDirStat](http://windirstat.info/)来检查我的硬盘上填满了什么。我惊讶地发现这个文件夹包含 4.6 GB（！）：

```
C:\Users\...\AppData\Roaming\Microsoft\VisualStudio\9.0\ReflectedSchemas 
```

此文件夹及其包含的文件的用途是什么？有没有办法以安全的方式摆脱这些文件？

*谢谢！*

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-18T15:49:48.237

我试图完全清空文件夹，并且自从我完成后没有发现任何问题。在 VS 中启动项目时，会创建一个新模式。

编辑：当您认为自己搞砸了时，您也可以移动文件夹并将其放回...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-12-01T00:33:19.300

这让我发疯，希望它会在 VS 2010 中得到修复；但是，我找到了解决此问题的另一种方法。

我的“修复”是使用“Junction”工具将文件夹映射到另一个驱动器。如果您像我一样拥有第二个驱动器，那么您可以使用窗口的 Junction 工具创建类似于符号链接的东西，以将文件夹映射到另一个驱动器。

最重要的是，您不再需要使用命令行。这个免费软件工具效果很好：[Junction Link Magic](http://www.rekenwonder.com/linkmagic.htm)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-19T18:57:22.773

这些文件给我带来了问题，因为我使用的是 Windows 的漫游配置文件功能，所以我将它们符号链接（为其创建符号链接）到 Local AppData 文件夹：

```
cd %APPDATA%\Microsoft\VisualStudio\9.0
mklink /D ReflectedSchemas ..\..\..\..\Local\Microsoft\VisualStudio\9.0\ReflectedSchemas
mklink /D ReflectedTypeLibs ..\..\..\..\Local\Microsoft\VisualStudio\9.0\ReflectedTypeLibs 
```

如果您对这些文件的需求/问题与我的不同，您可以将它们链接到不同的文件夹，甚至在不同的分区上。（您可以使用`/J`switch 代替`/D`，在这种情况下，它可能无关紧要，但它确实有助于了解[不同类型](https://superuser.com/q/67870/45163)的链接之间的差异。）

# java - 我在哪里可以在 JUnit 测试类中配置 log4j？

> ID：878348
> 
> 赞同：90
> 
> 时间：2009-05-18T15:37:09.807
> 
> 标签：java, logging, junit, log4j

查看我编写的最后一个 JUnit 测试用例，我在类构造函数中调用了 log4j 的 BasicConfigurator.configure() 方法。这对于运行 Eclipse 的“作为 JUnit 测试用例运行”命令中的单个类来说效果很好。但我意识到这是不正确的：我很确定我们的主测试套件从一个进程运行所有这些类，因此 log4j 配置应该在更高的地方进行。

但是我仍然需要自己运行一个测试用例，在这种情况下我想要配置 log4j。我应该将配置调用放在哪里，以便在测试用例独立运行时运行它，而不是在测试用例作为更大套件的一部分运行时运行？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-05-18T16:26:07.510

我一般只是把 log4j.xml 文件放到 src/test/resources 中，让 log4j 自己找到：不需要代码，默认的 log4j 初始化会捡起它。（无论如何，我通常想将自己的记录器设置为“调试”）

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-05-18T15:40:14.030

该类确定在加载类时运行的[静态块](https://github.com/apache/log4j/blob/trunk/src/main/java/org/apache/log4j/LogManager.java#L81)`LogManager`中使用哪个 log4j 配置。为最终用户提供了三个选项：

1.  如果指定`log4j.defaultInitOverride`为 false，则根本不会配置 log4j。
2.  自己手动指定配置文件的路径并覆盖类路径搜索。您可以使用以下参数直接指定配置文件的位置`java`：

    `-Dlog4j.configuration=<path to properties file>`

    在您的测试运行器配置中。

3.  允许 log4j 在测试期间扫描类路径以查找 log4j 配置文件。（默认）

另请参阅[在线文档](http://logging.apache.org/log4j/1.2/manual.html#Default_Initialization_Procedure)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-18T16:07:21.587

您可能想要查看[Simple Logging Facade for Java (SLF4J)](http://www.slf4j.org/)。它是一个围绕 Log4j 的外观，不需要像 Log4j 这样的初始设置调用。为 Slf4j 切换 Log4j 也相当容易，因为 API 差异很小。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-10-04T13:56:53.103

我在 log4j.xml 中使用系统属性：

```
...
<param name="File" value="${catalina.home}/logs/root.log"/>
... 
```

并开始测试：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-surefire-plugin</artifactId>
    <version>2.16</version>
    <configuration>
        <systemProperties>
            <property>
                <name>catalina.home</name>
                <value>${project.build.directory}</value>
            </property>
        </systemProperties>
    </configuration>
</plugin> 
```

# asp.net - ASP.NET DataGrid 和 HoverMenu 扩展器

> ID：878354
> 
> 赞同：1
> 
> 时间：2009-05-18T15:38:16.047
> 
> 标签：asp.net, datagrid, ajaxcontroltoolkit

我有一个 ASP.NET DataGrid，我正在尝试向其中添加 HoverMenu Extender。网格标记如下：

```
<asp:datagrid id="dgrExisting" runat="server" autogeneratecolumns="false" cssclass="FormattedTable" onitemcommand="dgrExisting_ItemCommand" onitemdatabound="dgrExisting_ItemDataBound">
                <headerstyle cssclass="FormattedTableHeader">
                <alternatingitemstyle cssclass="FormattedTableAltRow"></alternatingitemstyle>
                <columns>
                    <asp:boundcolumn datafield="UrlId" visible="false"></asp:boundcolumn>
                    <asp:boundcolumn datafield="MonitorUrl" headertext="Url"></asp:boundcolumn>
                    <asp:boundcolumn datafield="LastChecked" headertext="Last Checked"></asp:boundcolumn>
                    <asp:boundcolumn datafield="NextCheck" headertext="Next Check" visible="false"></asp:boundcolumn>
                    <asp:boundcolumn datafield="LastLoadTime" headertext="Last Load Time&lt;br&gt;&lt;/asp&gt;(Milliseconds)">
                    <asp:boundcolumn datafield="LastStatus" headertext="Last Status"></asp:boundcolumn>
                    <asp:templatecolumn>
                        <itemtemplate>
                            <asp:panel id="pnlPopupMenu" runat="server">
                                <div style="border: 1px outset white; padding: 2px;">
                                    <div><asp:linkbutton id="lnkReport" runat="server" commandname="Report" text="View Reports"></asp:linkbutton></div>
                                    <div><asp:linkbutton id="lnkDelete" runat="server" commandname="Delete" text="Delete"></asp:linkbutton></div>
                                    <asp:confirmbuttonextender id="cbeNewDelete" runat="server" targetcontrolid="lnkDelete" confirmtext="Are you sure you want to remove this URL?"></asp:confirmbuttonextender>
                                </div>
                            </asp:panel>
                            <asp:hovermenuextender id="hoverMenu" runat="server" popupcontrolid="pnlPopupMenu" popupposition="Right" hovercssclass="popupHover" targetcontrolid="pnlPopupMenu" popdelay="50"></asp:hovermenuextender>
                        </itemtemplate>
                    </asp:templatecolumn>
                </asp:boundcolumn>
            </columns>
</asp:datagrid> 
```

在 ItemDataBound 事件中，我将 ID 设置为允许它为整行工作，为此我使用以下内容：

```
protected void dgrExisting_ItemDataBound(object sender, DataGridItemEventArgs e)
{
    if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType == ListItemType.AlternatingItem)
    {
        AjaxControlToolkit.HoverMenuExtender oHoverMenu = (AjaxControlToolkit.HoverMenuExtender)e.Item.FindControl("hoverMenu");
        e.Item.ID = e.Item.ItemIndex.ToString();
        oHoverMenu.TargetControlID = e.Item.ID;
    }
} 
```

然而，菜单显示，但是，单击链接按钮实际上不会回传到服务器，从而允许处理项目命令。如果我禁用悬停菜单扩展器，按钮会按预期工作。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T16:00:44.393

我没有尝试在后面的代码中实现行为，而是内联了链接......

```
<itemtemplate>
    <asp:label id="lblOptions" runat="server">Options</asp:label><img src="../Images/RightArrow.png" alt="Show Menu" />

    <asp:panel id="pnlMenu" runat="server" cssclass="popupMenu">
        <div class="popupItem"><a href="Uploader.aspx?Action=Copy&Id=<%#Eval("Id")%>">Copy</a></div>
        <div class="popupItem"><a href="Uploader.aspx?Action=Version&Id=<%#Eval("VersionId")%>">Upload New Version</a></div>
        <div class="popupItem"><a href="VersionBrowser.aspx?id=<%#Eval("Id")%>">View Versions</a></div>
    </asp:panel>

    <cc1:hovermenuextender id="hme" runat="server"
         hovercssclass="popupHover"
         popupcontrolid="pnlMenu"
         targetcontrolid="lblOptions"/>
</itemtemplate> 
```

# wpf - ComboBox 绑定到枚举，我做错了什么？

> ID：878356
> 
> 赞同：14
> 
> 时间：2009-05-18T15:39:12.660
> 
> 标签：wpf, enums, combobox

我四处搜索，似乎很容易将枚举绑定到组合框，只需通过 ObjectDataProvider 从静态 Enum.GetValues 方法检索枚举值作为字符串列表，但是我无法让它工作。错误是未找到类型 ContactExportType。

我有一个名为 ContactExportType 的枚举，它位于 Enums 类中。此类是 CEM.Marketing.Objects 命名空间的一部分。

这就是我所拥有的：

```
<UserControl 
 xmlns:local="clr-namespace:CEM.Marketing.Objects"
 xmlns:sys="clr-namespace:System;assembly=mscorlib">

<Grid>
<Grid.Resources>
        <ObjectDataProvider MethodName="GetValues"
                    ObjectType="{x:Type sys:Enum}"
                    x:Key="ContactExportTypes">
        <ObjectDataProvider.MethodParameters>
            <x:Type TypeName="local:ContactExportType" />
        </ObjectDataProvider.MethodParameters>

    </ObjectDataProvider>
    </Grid.Resources>

</Grid>
 <ComboBox 
        ItemsSource="{Binding {StaticResource ContactExportTypes}}"
... 
```

谢谢，安吉拉

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-18T22:46:21.643

要访问嵌套类型，您应该使用“+”分隔符：

```
<ObjectDataProvider MethodName="GetValues"
                    ObjectType="{x:Type sys:Enum}"
                    x:Key="ContactExportTypes">
    <ObjectDataProvider.MethodParameters>
        <x:Type TypeName="local:Enums+ContactExportType" />
    </ObjectDataProvider.MethodParameters>

</ObjectDataProvider> 
```

顺便说一句，有一种更简单的方法可以绑定到枚举的值，而无需使用 ObjectDataProvider。它基于自定义标记扩展：

```
<ComboBox ItemsSource="{local:EnumValues local:Enums+ContactExportType}"/> 
```

这是 EnumValues 标记扩展的代码：

```
[MarkupExtensionReturnType(typeof(object[]))]
public class EnumValuesExtension : MarkupExtension
{
    public EnumValuesExtension()
    {
    }

    public EnumValuesExtension(Type enumType)
    {
        this.EnumType = enumType;
    }

    [ConstructorArgument("enumType")]
    public Type EnumType { get; set; }

    public override object ProvideValue(IServiceProvider serviceProvider)
    {
        if (this.EnumType == null)
            throw new ArgumentException("The enum type is not set");
        return Enum.GetValues(this.EnumType);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T15:43:11.277

```
<ObjectDataProvider MethodName="GetValues"
                    ObjectType="{x:Type local:Enums}"
                    x:Key="ContactExportTypes"> 
```

应该

```
<ObjectDataProvider MethodName="GetValues"
                    ObjectType="{x:Type sys:Enum}"
                    x:Key="ContactExportTypes"> 
```

和

```
<x:Type TypeName="local:ContactExportType" /> 
```

应该

```
<x:Type TypeName="CEM.Marketing.Objects.ContactExportType"/> 
```

sys:Enum 指向 Enum 框架类，参数中的 typename 指向您的完全限定类型名。

查看[Bea Stollnitz 的博客](http://www.beacosta.com/blog/?p=28)

```
 <ObjectDataProvider MethodName="GetValues" ObjectType="{x:Type sys:Enum}" x:Key="odp">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="namespace.class.TShirtSizes"/>
            </ObjectDataProvider.MethodParameters>
    </ObjectDataProvider>

<ComboBox ItemsSource="{Binding Source={StaticResource odp}}" IsSynchronizedWithCurrentItem="true"/> 
```

# refactoring - 重构大型旧 ASP.Net 解决方案

> ID：878361
> 
> 赞同：0
> 
> 时间：2009-05-18T15:40:08.303
> 
> 标签：refactoring, asp.net-2.0

我正在重构旧的 asp.net 代码（其中一些来自 frontpage 时代），并且希望将所有对“$Resources:resources”的引用从 aspx 页面移动到每个页面的代码隐藏文件中的 Page_Render。

这个 excersie 的主要目的是支持本地化，因为我们已经发展到其他国际地区。大约有 70 个奇怪的 aspx 页面，每个页面包含 5 到 10 个标签、文字等，其中大多数没有 ID 标签。:)

我应该如何高效地完成这项艰巨的任务，以及人们是否有任何工具/技巧可供我使用。我已经花了 5 天的时间，它甚至还没有完成一半:(

ķ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-20T05:59:01.910

我相信你可以像这样替换你的标签：

```
<span>Some Static Content</span> 
```

像这样的 ASP.NET 代码：

```
<%= Localise("SomeStaticContent") %> 
```

在您的页面上，您可以添加以下内容：

```
public string Localise(string key) {
    return HttpUtility.HtmlEncode( ResourceManager.GetString(key) ); // or whatever
} 
```

这应该是最简单的方法之一。

# artificial-intelligence - 有没有好的开箱即用的专家系统引擎？

> ID：878365
> 
> 赞同：3
> 
> 时间：2009-05-18T15:40:25.060
> 
> 标签：artificial-intelligence, expert-system

我正在研究[专家系统](http://en.wikipedia.org/wiki/Expert_system)- 只是想知道是否有任何好的引擎（商业或开放）可用于促进自定义专家系统的开发（而不是从头开始构建整个事物）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T14:39:33.550

当然，经典的（免费）专家系统外壳是[CLIPS](http://clipsrules.sourceforge.net/)。

-m

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T15:45:32.833

在商业世界中，这些通常称为[规则引擎](http://en.wikipedia.org/wiki/Business_rules_engine)。我曾与 Haley Systems 合作过——他们去年被甲骨文收购（[http://www.oracle.com/haley/index.html](http://www.oracle.com/haley/index.html)）

我见过的另一个是[ILog](http://www.ilog.com/)

此外，对于 Net 有一个称为[inrule](http://www.inrule.com/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T15:53:05.407

computer associates 有一个 aion 业务规则系统[http://www.ca.com/us/products/product.aspx?id=250](http://www.ca.com/us/products/product.aspx?id=250)

不知道现在有多少人使用它...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-18T12:16:34.080

我所知道的最好的规则处理系统是 JBoss Rules（也称为 Drools）。您可以将程序组件集成到规则中，将规则库集成到程序组件中，甚至可以即时构建/修改规则库。

您可能还对解决基于规则的专家系统的限制而构想的系统感兴趣，称为高级逻辑 (HLL)。 [http://highlevellogic.blogspot.com/](http://highlevellogic.blogspot.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-27T05:47:35.473

[Prolog](http://en.wikipedia.org/wiki/Prolog)非常适合编写专家系统。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-25T14:38:57.977

[杰斯](http://herzberg.ca.sandia.gov/jess/)也应该考虑。对邮件列表的非常好的支持。

# iphone - iPhone 上变量的内存管理

> ID：878367
> 
> 赞同：0
> 
> 时间：2009-05-18T15:41:19.753
> 
> 标签：iphone

我知道这是一个基本的任务，但我只是没有找到一个好的答案。我有一个具有多个视图控制器的应用程序，我注意到如果创建一个变量并在一个控制器中对其执行操作：

```
int foo = 0;
foo =+ 1; 
```

我可以在另一个控制器中声明该变量，而无需初始化它的值，它将携带上次在前一个视图控制器中设置的值：

```
int foo;
if (foo == 1)
    doSomething; 
```

我利用这个优势来跟踪多人游戏中的当前玩家等......使用多个控制器中的数据，因为他们的视图被加载和删除。我是 Obj C 的新手，根据我一直在阅读的内容，这似乎不是正确的处理方式。

所以这是我的问题，这是在控制器之间传递数据的安全方式吗？如果不是，我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T15:44:59.760

听起来好像您正在声明一个全局变量（C 允许），并且不建议在视图控制器之间传递值。

您应该有一个带有您的状态的对象，并将其传递给需要它的控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T15:53:09.073

这不是在控制器之间传递信息的安全方式。如果您在您的应用程序中使用它，并且它正在工作，我实际上非常惊讶。

执行此操作的正确方法是将您需要的值从一个控制器实际传递到另一个控制器。下面的示例使用 Application Delegate 来存储值，然后每个控制器对其进行读取/写入...**这只是一个示例，请注意将 Application Delegate 用作有效地成为全局变量的存储库**。在 Application Delegate 中设置大量以这种方式使用的变量将使您的应用程序难以维护。

在你的 App Delegate.h

```
@interface AppDelegate : NSObject <UIApplicationDelegate> {  
  int sharedInt;  
}
@property int sharedInt; 
```

在你的 App Delegate.m

```
@synthesize sharedInt;  // this will automatically create the getters and setters 
```

然后在要设置值的控制器中：

```
ApplicationDelegateClassNameHere * applicationDelegate = [[ UIApplication sharedApplication] delegate];  
applicationDelegate.sharedInt = 3; 
```

然后在要读取值的控制器中：

```
ApplicationDelegateClassNameHere * applicationDelegate = [[ UIApplication sharedApplication] delegate];  
if (applicationDelegate.sharedInt == 3) {  
   //do your stuff here
} 
```

**编辑**：忘记了@synthesize。
**已编辑**：根据 Kenneth Ballenegger 的建议键入委托单例方法的返回值，以消除编译器警告。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T17:33:52.693

我建议做（并做）类似于 mmc 的回答的事情。但是，他的回答会让你有很多警告。你应该确保你得到一个`AppDelegate *`对象，而不仅仅是任何 ( `id`) 对象（就像你正在使用 mmc 的方法一样）。

只需向您的委托添加一个`+singleton`（或`+sharedDelegate`）类方法，如下所示：

```
+ (iLaughAppDelegate *)singleton
{
    iLaughAppDelegate *delegate = (iLaughAppDelegate *)[[UIApplication sharedApplication] delegate];
    return delegate;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T17:43:16.870

如果正确完成，这很好，但应该只对只读数据进行。这是共享字符串常量的一种极为常见的方式。例如：

我的对象.h

```
extern NSString* const MyObjectWillChangeNotification; 
```

我的对象.m

```
NSString* const MyObjectWillChangeNotification = @"MyObjectWillChangeNotification"; 
```

另一个对象.m

```
#import "MyObject.h"
// You can now use MyObjectWillChangeNotification in this file 
```

This same process will technically work for your `int`, but you shouldn't, as has been previously noted. It's much safer to allow any given variable be managed by one and only one object. Everyone else should get to it through an accessor.

# objective-c - 将 int 用于类属性有问题吗？

> ID：878373
> 
> 赞同：0
> 
> 时间：2009-05-18T15:42:39.953
> 
> 标签：objective-c, class

当我开始使用 Cocoa 时，我记得我在某处读到 int/float 和类似的东西不应该用于类属性并使用 NS* 等价物（如 NSInteger）。

这里是否有一个真正隐藏的问题，为什么会更好，或者这只是我读到它的人的自愿编码规则（我终生无法找到那在哪里）？

那么，有什么更好的：

```
@interface xx... 
    int myProp;
@end 
```

或者

```
@interface xx... 
    NSInteger *myProp;
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T15:45:57.327

int 版本很好，但首选 NSInteger。NSInteger 不是一个对象，也不必用指针引用——它只是一个 typedef，它允许变量在 32 位和 64 位计算机上都是本机字长。所以最好的选择是：

```
@interface SomeClass : NSObject {
    NSInteger aNumber;
@end

@implementation SomeClass
- (id)init {
    [super init];
    number = 42;
}
@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T15:48:16.883

看到这个[问题](https://stackoverflow.com/questions/13725/in-cocoa-do-you-prefer-nsinteger-or-just-regular-int-and-why)。NSInteger 是架构安全的，建议从 10.5 开始。

# java - 如何使用 JPA/EclipseLink 与连接表建立多对多关系

> ID：878374
> 
> 赞同：3
> 
> 时间：2009-05-18T15:42:41.013
> 
> 标签：java, jpa, eclipselink

我有 2 张桌子：

电影：movieID

用户：用户ID

这些表通过 Queue 表具有多对多关系，并带有一个附加属性 listOrder：

队列：movieID、userID、listOrder

我正在尝试使用 EclipseLink 对此进行建模，但出现“不兼容的映射”错误。这是我的代码示例：

```
 @Entity
@Table(name="movieinventory")
public class Movie implements Serializable
{
       private static final long serialVersionUID = 1L;

       @Id
       @GeneratedValue
       private Integer movieID;

       @OneToMany(mappedBy="movie")
       private Set moviesInQueue;

       ...Getters/Setters...
}

@Entity
@Table(name="Users")
public class User implements Serializable
{
       private static final long serialVersionUID = 1L;

       @Id
       @GeneratedValue
       private Integer userID;

       @OneToMany(mappedBy="user")
       private Set moviesInQueue;

      ...Getters/Setters...
}

@IdClass(QueueItemPK.class)
@Entity
@Table(name="queue")
public class QueueItem
{
       @Id
       @ManyToOne
       @JoinColumn(name="movieID")
       private Movie movie;

       @Id
       @ManyToOne
       @JoinColumn(name="userID")
       private User user;

       @Basic
       private String listOrder;

       ...Getters/Setters...
}

public class QueueItemPK implements Serializable
{
       private static final long serialVersionUID = 1L;

       private Movie movie;
       private User user;

       ...Getters/Setter...

       public int hashCode()
       {
           return (movie.getMovieID() + "|" + user.getUserID()).hashCode();
       }

       public boolean equals(Object obj)
       {
           if (obj == this) return true;
           if (obj == null) return false;
           if (!(obj instanceof QueueItemPK)) return false;
           QueueItemPK pk = (QueueItemPK) obj;
           return pk.movie.getMovieID() == movie.getMovieID() 
               && pk.user.getUserID() == user.getUserID();
       }
} 
```

QueueItemPK 的目的是让我可以拥有movieID 和userID 的复合主键。我不确定这是正确的方法。

这是错误： **异常描述：在 [class Movie] 和 [class QueueItem] 之间遇到不兼容的映射。这通常发生在映射的基数与其反向指针的基数不对应时。**我对 User 类有同样的错误（错误交替出现）。

但是，当我从 QueueItem 中的电影和用户变量中取出 @Id 注释并将其他一些键作为主键时，它编译时没有错误。

任何建议，将不胜感激。

谢谢， BJ

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-23T10:20:42.933

首先，正如 Mike Cornell 所建议的，EmbeddedId/Class 可能是更易于使用的选择。尽管如此，要回答您的问题和更正的代码：

```
@IdClass(QueueItemPK.class)
@Entity
@Table(name="queue")
public class QueueItem
{
       @Id
       @ManyToOne(optional=false)
       @PrimaryKeyJoinColumn(name="movieID")
       private Movie movie;

       @Id
       @ManyToOne(optional=false)
       @PrimaryKeyJoinColumn(name="userID")
       private User user;

       @Basic
       private String listOrder;

       ...Getters/Setters...
}

public class QueueItemPK implements Serializable
{
       private static final long serialVersionUID = 1L;

       @Id
       @Column(name="movieID")
       private Integer movie;
       @Id
       @Column(name="userID")
       private Integer user;

       ...Getters/Setter...

       public int hashCode()
       {
           return (movie.getMovieID() + "|" + user.getUserID()).hashCode();
       }

       public boolean equals(Object obj)
       {
           if (obj == this) return true;
           if (obj == null) return false;
           if (!(obj instanceof QueueItemPK)) return false;
           QueueItemPK pk = (QueueItemPK) obj;
           return pk.movie == movie 
               && pk.user == user;
       }
} 
```

如您所见，它们必须具有必须匹配的 id 类型。不是很漂亮，但工作。我建议为您的 Set 使用泛型；使 ist 更易于阅读，代码更安全。

# sql - 连接多个列的 SQL 查询

> ID：878376
> 
> 赞同：3
> 
> 时间：2009-05-18T15:42:48.923
> 
> 标签：sql, syntax, join, union

我正在尝试将 2 个表中的一些数据连接在一起，但是在几列上。这是一个例子：

> **源**表
> 
> 身份证 | 描述| AAAA| BBBB|
> 
> **表2**表
> 
> 身份证 | 正文| ID1 | ID2 | ID3 |

**其中Table2**中的ID1、ID2 和 ID3是**源**表中的 ID

我想做一个产生结果的查询：

```
Table2.Text,
Source.Desc(ID1),
Source.AAAA(ID1),
Source.Desc(ID2),
Source.AAAA(ID2),
Source.Desc(ID3),
Source.AAAA(ID3) 
```

我猜这将是一个连接，但我无法正确使用语法......或者我会更好地使用联合吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T15:47:47.417

你可以只使用多个连接，不是吗？例如：

```
SELECT tb.Desc, s1.Desc, s1.AAAAA, s2.Desc, s2.AAAAA, s3.Desc, s3.AAAA
FROM Table2 tb
    INNER JOIN Source s1 ON tb.ID1 = s1.ID
    INNER JOIN Source s2 ON tb.ID2 = s2.ID
    INNER JOIN Source s3 ON tb.ID3 = s2.ID 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T15:48:53.590

您需要加入源表三次，每个 ID 一次。您也可以尝试联合，看看哪个表现更好。

这是一个糟糕的表格设计（应该标准化），如果可能的话，我建议您现在更改它。应该有一个相关的表，每个 id 都在一个单独的记录中，然后你可以加入一次，它会更有效，更容易编写代码，而且你不必在你需要的那一天更改表结构和所有查询身份证4。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T15:47:41.487

三个连接应该可以解决问题：

```
select A.*, coalesce(B1.Text,B2.Text,B3.Text,'') as Text
from Source A
inner join Table2 B1 on B1.ID1=A.ID
inner join Table2 B2 on B2.ID2=A.ID
inner join Table2 B3 on B3.ID3=A.ID 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T16:04:06.383

如果不是所有的源表都填充在表 2 中，这仍然会给你部分结果：

```
SELECT
    t.Desc, s1.Desc, s1.AAAAA, s2.Desc, s2.AAAAA, s3.Desc, s3.AAAA
    FROM Table2                t
        LEFT OUTER JOIN Source s1 ON t.ID1 = s1.ID
        LEFT OUTER JOIN Source s2 ON t.ID2 = s2.ID
        LEFT OUTER JOIN Source s3 ON t.ID3 = s2.ID
    WHERE t.ID=@YourIDHere 
```

# .net - .Net 内存转储：！eeheap -gc：GC 生成在哪里开始和结束？

> ID：878379
> 
> 赞同：3
> 
> 时间：2009-05-18T15:43:00.623
> 
> 标签：.net, memory, windbg, sos, memory-dump

我想我在这里遗漏了一些基础知识，所以希望这篇文章可以澄清这一点。

我已经转储并正在查看托管堆，并且有兴趣专门查看每个堆中的对象。这是调试器的输出：

```
0:000> !eeheap -gc
Number of GC Heaps: 1
generation 0 starts at 0x3cca447c
generation 1 starts at 0x3cc9d8a0
generation 2 starts at 0x01651000
ephemeral segment allocation context: none
 segment    begin allocated     size
01650000 01651000  0264fcc8 0x00ffecc8(16772296)
139a0000 139a1000  1499e5b0 0x00ffd5b0(16766384)
18ca0000 18ca1000  19c98a58 0x00ff7a58(16743000)
25ad0000 25ad1000  26acd454 0x00ffc454(16761940)
23ad0000 23ad1000  24acd2a0 0x00ffc2a0(16761504)
27ad0000 27ad1000  28acc724 0x00ffb724(16758564)
29ad0000 29ad1000  2aacf1e8 0x00ffe1e8(16769512)
1dca0000 1dca1000  1ec9ff50 0x00ffef50(16772944)
26ad0000 26ad1000  27acf8f8 0x00ffe8f8(16771320)
1bca0000 1bca1000  1cc9f680 0x00ffe680(16770688)
30790000 30791000  3178fe0c 0x00ffee0c(16772620)
2f790000 2f791000  3078ff74 0x00ffef74(16772980)
31790000 31791000  3278eef4 0x00ffdef4(16768756)
24ad0000 24ad1000  25acf6b4 0x00ffe6b4(16770740)
1cca0000 1cca1000  1dc78438 0x00fd7438(16610360)
2bad0000 2bad1000  2cace4fc 0x00ffd4fc(16766204)
28ad0000 28ad1000  29aca8d8 0x00ff98d8(16750808)
34790000 34791000  3578aa1c 0x00ff9a1c(16751132)
2aad0000 2aad1000  2baaa004 0x00fd9004(16617476)
32790000 32791000  337385fc 0x00fa75fc(16414204)
35790000 35791000  36779394 0x00fe8394(16679828)
149a0000 149a1000  1599f9f0 0x00ffe9f0(16771568)
42550000 42551000  435493e8 0x00ff83e8(16745448)
3f370000 3f371000  4036e108 0x00ffd108(16765192)
33790000 33791000  346e6328 0x00f55328(16077608)
43550000 43551000  4452fcf8 0x00fdecf8(16641272)
3b5d0000 3b5d1000  3c3b78e4 0x00de68e4(14575844)
3c5d0000 3c5d1000  3ce92284 0x008c1284(9179780)
Large object heap starts at 0x02651000
 segment    begin allocated     size
02650000 02651000  033a4440 0x00d53440(13972544)
11040000 11041000  11b4c5b0 0x00b0b5b0(11580848)
12040000 12041000  12701580 0x006c0580(7079296)
1eca0000 1eca1000  1fb613e0 0x00ec03e0(15467488)
19ca0000 19ca1000  19eb0528 0x0020f528(2159912)
1aca0000 1aca1000  1b0e3840 0x00442840(4466752)
202d0000 202d1000  2335be68 0x0308ae68(50900584)
Total Size  0x21997e04(563707396)
------------------------------
GC Heap Size  0x21997e04(563707396) 
```

我希望我可以获取 GC 代的起始地址，然后查看从该地址开始一直到下一代的段。我相信堆是压缩的，因此希望在第一段找到第 2 代，这看起来是这样的：

```
01650000 01651000  0264fcc8 0x00ffecc8(16772296) 
```

但是，我无法确定这在哪里结束，因为我找不到第 1 代从**0x3cc9d8a0**开始的位置。

我认为我在这里遗漏了上述解决方案的一些基本原理。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T15:48:03.703

您可以使用[SOSEX](http://www.stevestechspot.com/SOSEXANewDebuggingExtensionForManagedCode.aspx)扩展单独检查每一代堆，还可以查看每个堆上每个对象的根。

# c++ - 用结构和数组切换结构？

> ID：878387
> 
> 赞同：0
> 
> 时间：2009-05-18T15:45:17.203
> 
> 标签：c++, sorting, struct

我之前有一个关于按名称、ID 和金额组织一些输入的问题。现在我已经弄清楚如何组织它们，我需要有 3 个输出；第一个按名称，第二个按 ID，最后一个按金额。我可以使用 case 和 switch 语句吗？每次我尝试时，所有三个输出都是按名称命名的。

这是我到目前为止所拥有的：

```
void GeneralSort(const int SortItem, const int count, CustomerProfile c[])
{   
string tempname;
string tempid;
float tempamount;

for(int iteration = 1; iteration < count; iteration ++)
{
    for(int n = 0; n < (count-iteration); n++)
    {
        if(c[n].CustomerName > c[n+1].CustomerName)
        {
            tempname = c[n].CustomerName;
            c[n].CustomerName = c[n+1].CustomerName;
            c[n+1].CustomerName = tempname;
        }

        if(c[n].CustomerId > c[n+1].CustomerId)
        {
            tempid = c[n].CustomerId;
            c[n].CustomerId = c[n+1].CustomerId;
            c[n+1].CustomerId = tempid;
        }

         if(c[n].AmountDue > c[n+1].AmountDue)
        {
            tempamount = c[n].AmountDue;
            c[n].AmountDue = c[n+1].AmountDue;
            c[n+1].AmountDue = tempamount
        } 
```

我如何获取其余数据，因此它将按 ID 输出第二个输出，按金额输出第三个输出。我认为您可以添加 switch 语句，但是当我累了时，所有三个输出都是按名称的第一组。任何帮助表示赞赏。我不指望任何人为我解决这一切，只是一个提示我指向正确的方向。

输出示例：

```
//by name

name    id    amount
able       b2     24
bob     g3     68 
carry   a4     12

//by id
name    id    amount
carry   a4      12
able    b2      24
bob     g3      68

//by amount

name    id     amount 
carry   a4      12
able    b2      24  
bob     g3      68 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T16:12:10.330

您现在使用函数所做的是混合数据的属性而不是对其进行排序。您应该使用一个标志来区分要排序的列或 3 个函数 sortByName、sortByID 和 sortByAmout。而且你的ifs是错误的。代替

```
if(c[n].CustomerName > c[n+1].CustomerName)
{
   tempname = c[n].CustomerName;
   c[n].CustomerName = c[n+1].CustomerName;
   c[n+1].CustomerName = tempname;
} 
```

它应该说类似

```
CustomerProfile tempItem;

if(c[n].CustomerName > c[n+1].CustomerName)
{
    tempItem = c[n];
    c[n] = c[n+1];
    c[n+1] = tempItem;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T15:59:35.333

您之前接受的[问题](https://stackoverflow.com/questions/873715/c-sort-with-structs)的答案是使用 std::sort 函数。

要在这里做你想做的事，你应该有 3 个不同的排序功能

1.  按名称分类
2.  按 ID 排序
3.  按金额排序

然后你只需用相关函数调用 std::sort

```
std::sort(customers.begin(), customers.end(), &sortByName);
//print your collection here
std::sort(customers.begin(), customers.end(), &sortById);
//print your collection here
std::sort(customers.begin(), customers.end(), &sortByAmount);
//print your collection here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T16:02:36.467

您应该为此使用 std::sort 而不是编写自己的排序代码，除非您有非常好的理由编写自己的排序代码。

在这种情况下，编写自己的代码不太清晰，效率较低，并且包含重复的代码。

**编辑：** 好的，不允许使用排序是一个很好的理由。

在这种情况下，我的建议是尝试将您的代码重构为函数，并尝试使每个函数只做一件事。这样，重复应该变得明显并且可以被消除。

您发布的代码试图在一大块中至少做四件事。尝试将您的排序代码与您正在排序的代码分开。然后你应该能够分离出三种排序方式中的每一种。

# database - 从表中删除所有记录

> ID：878395
> 
> 赞同：0
> 
> 时间：2009-05-18T15:47:26.153
> 
> 标签：database, subsonic

如何使用 SubSonic 从表中删除所有记录？Delete 方法有三个重载，但每个重载都需要一些参数。以及如何使用查询删除记录（例如删除 column1 > 100 的所有记录）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T16:06:53.307

以下将从 TempTable 中删除 ID 大于 56 的所有行：

```
new Delete().From(TempTable.Schema)
  .Where(TempTable.Columns.Id).IsGreaterThan(56)
  .Execute(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T16:12:29.830

帮助位于 [http://subsonicproject.com/docs/Main_Page](http://subsonicproject.com/docs/Main_Page) 并且许多示例都包含在源代码中的测试中。

```
int records = new Delete().From(Product.Schema)
    .Where("UnitPrice")
    .IsGreaterThan(42.00)
    .Execute();

// Delete all rows.
int records = new Delete().From(Product.Schema).Execute(); 
```

# .net - GDI+ DashStyle 在 .NET 中引发 OutOfMemoryException

> ID：878402
> 
> 赞同：1
> 
> 时间：2009-05-18T15:48:41.923
> 
> 标签：.net, winforms, gdi+, out-of-memory, pen

我`DashStyle.Dash`在渲染我的对象层次结构时使用。我的应用程序`Graphics.Transform`广泛使用，我发现在某些比例值（包括 100% 的比例）和某些旋转角度下，`Graphics.DrawLine`使用`OutOfMemoryException`带有`DashStyle.Dash`. 使用谷歌我发现这是一个[众所周知的](http://www.google.com/search?q=DashStyle+Outofmemory) [问题](http://groups.google.com/group/microsoft.public.dotnet.framework.drawing/browse_thread/thread/c52a43702fccaab8/838a26535bf6e2e6)。微软告诉我们这不是一个[阻塞](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=96831) [问题](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=96793)。到目前为止，我还没有找到解决这个问题的方法。

我有哪些选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-06T00:43:11.833

我刚刚遇到了同样的问题。经过进一步调查，我发现了以下内容。

1.  线条长度正是自定义的破折号图案长度。更改线长 +/- 1 像素可避免该错误。
2.  我正在使用`LineCapRound`and `DashCapRound`，切换到 `LineCapSquare`并`DashCapFlat`避免了错误
3.  错误来自尝试使路径变平（可能来自圆形末端）
4.  笔宽为零。

我的最终解决方案是不画零宽度线！

# delphi - TADoConnection 和池化

> ID：878403
> 
> 赞同：3
> 
> 时间：2009-05-18T15:48:48.723
> 
> 标签：delphi

我正在处理所有使用访问 sql server 2005 db 的多个线程的应用程序，我目前正在通过设置 TADOQuery 对象的连接字符串属性来使用隐式连接，但这似乎打开了很多与数据库的连接。我们需要减少单个实例保持打开的连接数，所以

1.  tadoconnection 库中是否有任何类型的连接池可用，我如何启用它并设置它的限制。
2.  如果不是，那么推荐的减少和重用数据库连接的方法是什么，以便应用程序可以很好地扩展。

我将不胜感激任何意见或想法..

非常感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T02:37:52.110

连接数量增加的另一个原因是多个打开的查询在同一连接上处于活动状态。

假设您有类似的代码

```
db := TAdoConnection.Create()
qry1 := TAdoQuery.Create();
qry2 := TAdoQuery.Create();

qry1.connection := db;
qry2.connection := db;

qry1.SQL.Text := 'select * from whatever';

qry1.open;
while not qry1.eof do
begin
  x := qry1.fieldbyname('fld').AsString;
  qry2.SQL.Text := 'select * from elsewhere where SomeField='+ QuotedStr(x);
  qry2.Open;
  ..do something..
  qry2.Close;

  qry1.Next;
end; 
```

qry2.Open() 将导致创建另一个*未池化的连接*

如果您有这样的代码，请将 qry1 的结果存储到本地，然后执行 qry2 的工作。在这种情况下，您将只维护一个连接。

粗略地说，这看起来更像：

```
db := TAdoConnection.Create()
qry1 := TAdoQuery.Create();
qry2 := TAdoQuery.Create();
str := TStringList.Create();

qry1.connection := db;
qry2.connection := db;

qry1.SQL.Text := 'select * from whatever';

qry1.open;
while not qry1.eof do
begin
  x := qry1.fieldbyname('fld').AsString;
  str.Add(x);
  qry1.Next;
end;
qry1.Close;

for i := 0 to str.Count-1 do
begin
  qry2.SQL.Text := 'select * from elsewhere where SomeField='+ QuotedStr(str[i]);
  qry2.Open;
  ..do something..
  qry2.Close;
end 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T02:20:14.423

默认情况下，与 SQL Server 的 ADO 数据库连接是池化的，您无需进行任何工作。池行为可以通过您的连接字符串进行更改。你的连接字符串是什么样的？

只需保持您的连接字符串完全相同，并在您的线程中创建/释放一个 ADO 连接，并让 ADO 运行时处理池。每个进程的连接数通常等于“最近”同时连接的最大数量加上一些缓冲区。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T15:55:07.167

在 DataModule 上设置 TADOConnection 组件并使用数据模块上所有其他 ADO 组件中的组件应该已经减少了很多连接。如果应用程序正在使用大量数据模块，则可以使这些数据模块在运行时共享相同的连接。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-03T13:04:49.353

微软说：“...禁用 ADO 默认使用的 OLE DB 资源池...您可以通过将“OLE DB Services = -2”添加到 ADO 连接字符串来实现”。

这是链接： http: [//support.microsoft.com/kb/229564](http://support.microsoft.com/kb/229564)

当客户端应用程序使用应用程序角色时，它非常有用。

# iphone - 触摸透明PNG

> ID：878405
> 
> 赞同：2
> 
> 时间：2009-05-18T15:48:58.317
> 
> 标签：iphone, objective-c, cocoa-touch, transparency

我在 UIImageView 中有一个 PNG，边缘有 alpha（比如说一个圆圈）。当我点击它时，如果我触摸不透明位，我希望它注册为圆圈的点击，但如果我触摸透明位，则点击后面的视图。

（顺便说一句：在另一个论坛上，有人说 PNG 会自动执行此操作，透明的 PNG 应该将点击传递到下面的视图，但我已经对其进行了测试，但它没有，至少在我的情况下不是。）

是否有一个我还没有翻转的标志，或者我是否需要创建某种公式：“如果点击 { 获取位置；计算距中心的距离；如果 < r { 触摸圆圈} 否则 { 传递它} }”？

-k。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T16:23:17.407

我不相信 PNG 会自动执行此操作，但找不到任何明确说明一种或另一种方式的参考资料。

您的半径计算可能更简单，但您也可以手动检查图像中触摸像素的 alpha 值，以确定是否将其计为命中。此代码针对 OS X 10.5+，但经过一些小的修改，它应该可以在 iPhone 上运行：[Getting the pixel data from a CGImage object](http://developer.apple.com/qa/qa2007/qa1509.html)。以下是关于从 UIImage 检索数据的一些相关讨论：从 UIImage[获取数据](http://www.iphonedevsdk.com/forum/iphone-sdk-development/1128-getting-data-uiimage.html)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2011-04-11T16:40:50.847

我想通了...... PNG，边界框透明度问题，并且能够点击到后面的另一个图像：

var hitTestPoint1:Boolean = false; var myHitTest1:Boolean = false; 变量对象：数组；

clip.addEventListener(MouseEvent.MOUSE_DOWN, doHitTest); clip.addEventListener(MouseEvent.MOUSE_UP, stopDragging); 剪辑.buttonMode = true; clip.mouseEnabled = true; clip.mouseChildren = true;

clip2.addEventListener(MouseEvent.MOUSE_DOWN, doHitTest); clip2.addEventListener(MouseEvent.MOUSE_UP, stopDragging); clip2.buttonMode = true; clip2.mouseEnabled = true; clip2.mouseChildren = true;

剪辑.旋转 = 60;

函数 doHitTest(event:MouseEvent):void { objects = stage.getObjectsUnderPoint(new Point(event.stageX, event.stageY)); trace("哪一个：" + event.target.name); trace("重点是什么：" + objects); for(var i:int=0; 我

函数 stopDragging(event:MouseEvent):void { event.target.stopDrag(); }

function realHitTest(object:DisplayObject, point:Point):Boolean { /* 如果我们已经在处理 BitmapData 对象，那么我们只需使用该 BitmapData 的 hitTest * 方法。*/ if(object is BitmapData) { return (object as BitmapData).hitTest(new Point(0,0), 0, object.globalToLocal(point)); } 别的 {

```
 /* First we check if the hitTestPoint method returns false. If it does, that
     * means that we definitely do not have a hit, so we return false. But if this
     * returns true, we still don't know 100% that we have a hit because it might
     * be a transparent part of the image. 
     */
    if(!object.hitTestPoint(point.x, point.y, true)) 
    {
        return false;
    }
    else {
        /* So now we make a new BitmapData object and draw the pixels of our object
         * in there. Then we use the hitTest method of that BitmapData object to
         * really find out of we have a hit or not.
         */
        var bmapData:BitmapData = new BitmapData(object.width, object.height, true, 0x00000000);
        bmapData.draw(object, new Matrix());

        var returnVal:Boolean = bmapData.hitTest(new Point(0,0), 0, object.globalToLocal(point));

        bmapData.dispose();

        return returnVal;
    }
} 
```

}

# java - 使用@transactional 时我需要使用jpatemplate/hibernatetemplate 吗？

> ID：878407
> 
> 赞同：2
> 
> 时间：2009-05-18T15:49:22.310
> 
> 标签：java, spring

使用 @transactional 时我需要使用 jpatemplate/hibernatetemplate 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-01T23:49:32.677

不，你没有。Spring 有一个内置的事务管理器，可以用于简单的事务，例如，如果您不需要跨多个数据源跟踪事务。配置应该像这样简单：

```
<tx:annotation-driven transaction-manager="txManager"/>
<bean id="txManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
    <property name="dataSource" ref="dataSource"/>
</bean> 
```

其中名为“dataSource”的 bean 是 XML 文件中其他位置配置的某个 DataSource bean。

但是，如果您使用 JPA 或 Hibernate，最好分别使用 JPATransactionManager 或 HibernateTransactionManager。

如果你真的想要，你也可以使用 JTA，它是 Sun 的标准事务实现。我认为spring类被称为JTATransactionManager。

使用 Spring 开箱即用的事务管理器（在上面的 XML 配置中定义的那个）之外的事务管理器将使您能够跨多个数据源使用事务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-09T08:38:33.937

答案取决于您使用的 Hibernate 版本。对于更高版本，简单的答案是否定的，您不需要模板。请参阅此处进行全面讨论：

[http://blog.springsource.com/2007/06/26/so-should-you-still-use-springs-hibernatetemplate-andor-jpatemplate/](http://blog.springsource.com/2007/06/26/so-should-you-still-use-springs-hibernatetemplate-andor-jpatemplate/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-07T14:39:35.400

我遇到了一篇文章，它深入解释了使用 @Transactional 实现 TxManager 的过程。如果你有兴趣，你可以在这里查看[这篇文章](http://javaprogrammingtips4u.blogspot.com/2010/04/how-to-use-transaction-manager-with.html)。我试过了，这行得通！

# visual-studio-2008 - 用于删除 SourceSafe 绑定的实用程序？

> ID：878409
> 
> 赞同：4
> 
> 时间：2009-05-18T15:49:36.880
> 
> 标签：visual-studio-2008, visual-sourcesafe, utility

我正在寻找一个实用程序，它会根据解决方案文件的位置自动删除 SourceSafe 绑定。我发现了这个工具的几个提及：

[http://codebetter.com/blogs/darrell.norton/archive/2008/05/16/sourcesafe-binding-remover.aspx](http://codebetter.com/blogs/darrell.norton/archive/2008/05/16/sourcesafe-binding-remover.aspx)

这看起来正是我所需要的——删除 .scc 文件并修改 .sln 和 .*proj 文件。但是，我不知道如何实际获得该实用程序 - 该帖子上的附件似乎实际上并不存在。

在我自己重写之前，有没有人有这个工具的副本或者知道在哪里可以找到类似的东西？我有 137 种解绑定解决方案，因此手动执行此操作不是一个有吸引力的选择。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T16:13:12.620

我不久前写了这种类型的实用程序，你在正确的轨道上需要做些什么。

这里有一些代码可以帮助您入门。它应该适用于所有 .Net 项目（VS 2003 - VS 2008），包括部署项目：

```
//get list of all files to be edited/removed
            SlnFiles = new List<FileInfo>(SelectedDir.GetFiles("*.sln", SearchOption.AllDirectories));
            ProjFiles = new List<FileInfo>(SelectedDir.GetFiles("*.*proj", SearchOption.AllDirectories));
            VssFiles = new List<FileInfo>(SelectedDir.GetFiles("*.vssscc", SearchOption.AllDirectories));
            VssFiles.AddRange(SelectedDir.GetFiles("*.vsscc", SearchOption.AllDirectories));
            VssFiles.AddRange(SelectedDir.GetFiles("*.scc", SearchOption.AllDirectories));
            VssFiles.AddRange(SelectedDir.GetFiles("*.vspscc", SearchOption.AllDirectories)); 
```

删除 VSS 文件

```
//Delete all vss files
            VssFiles.ForEach(vss =>{vss.Delete();}); 
```

编辑 sln 文件

```
//Edit sln files 
    SlnFiles.ForEach(sln =>
    {
    string fullName = sln.FullName;
    string relPath = sln.Directory.FullName.Replace(workingDir.FullName, string.Empty);

    StreamReader reader = sln.OpenText();
    String text = reader.ReadToEnd();
    reader.Close();
    string regex = "\tGlobalSection\\(SourceCodeControl\\) [\\s\\S]*? EndGlobalSection\r\n";
    RegexOptions options = ((RegexOptions.IgnorePatternWhitespace | RegexOptions.Multiline) | RegexOptions.IgnoreCase);
    Regex reg = new Regex(regex, options);

    text = reg.Replace(text, string.Empty);
        if (text.StartsWith(Environment.NewLine))
            text = text.Remove(0, 2);
        StreamWriter writer = new StreamWriter(fullName);
        writer.Write(text);
        writer.Flush();
        writer.Close();
    }); 
```

编辑项目文件

```
//edit proj files
    ProjFiles.ForEach(proj =>
    {
    string fullName = proj.FullName;
    string relPath = proj.Directory.FullName.Replace(workingDir.FullName, string.Empty);

    StreamReader reader = proj.OpenText();
    String text = reader.ReadToEnd();
    reader.Close();

    string regex = "\"*<*Scc.*?(>|\\W=\\W\").*?(>|\")";
    RegexOptions options = ((RegexOptions.IgnorePatternWhitespace | RegexOptions.Multiline) | RegexOptions.IgnoreCase);
    Regex reg = new Regex(regex, options);

    text = reg.Replace(text, string.Empty);
    StreamWriter writer = new StreamWriter(fullName);
    writer.Write(text);
    writer.Flush();
    writer.Close();
    }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-30T16:20:02.383

这是新创建的[VSSBindingRemover](http://github.com/mikoskinen/vssbindingremover)的链接。该软件是根据 Jeremy 和 juanjo.arana 的回答创建的。您可以从 GitHub下载[源代码](http://github.com/mikoskinen/vssbindingremover)和[可执行文件。](http://github.com/mikoskinen/vssbindingremover/downloads)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T15:53:15.283

如果它只是对您要处理的文件系统的影响，那么普通的命令提示符命令应该能够做到：

```
del *.scc /s /q
attrib -r *.* /s 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-12T10:36:03.253

添加以下代码以在删除文件之前将文件设置为非只读：

var allFiles = slnFiles.Union(projFiles).Union(vssFiles).ToList();

allFiles.ForEach(f => f.IsReadOnly = true);

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-01-19T11:18:07.417

我使用 Cygwin，你呢：P

```
find.exe . -type f -name *.dsp -print0 | xargs -0 -r perl -p -i.vssbak -e 's/^.*Scc_ProjName.*$//g'
find.exe . -type f -name *.dsp -print0 | xargs -0 -r perl -p -i.vssbak -e 's/^.*Scc_LocalPath.*$//g'
find.exe . -type f -name *.dsw -print0 | xargs -0 -r sed -i '/begin.source.code.control/,/end.source.code.control/d'
find.exe . -type f -name *.sln -print0 | xargs -0 -r sed -i '/GlobalSection(SourceCodeControl)/,/EndGlobalSection/d'
find.exe . -type f -name *.*proj -print0 | xargs -0 -r perl -p -i.vssbak -e 's/^.*SccProjectName.*$//g'
find.exe . -type f -name *.*proj -print0 | xargs -0 -r perl -p -i.vssbak -e 's/^.*SccLocalPath.*$//g'
find.exe . -type f -name *.*proj -print0 | xargs -0 -r perl -p -i.vssbak -e 's/^.*SccProvider.*$//g'
find.exe . -type f -name *.vssbak -print0 | xargs -0 -r rm -f 
find.exe . -type f -name *.*scc -print0 | xargs -0 -r rm -f 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-07T22:21:08.347

我扩展了[Mikael 的 VSSBindingRemover](https://github.com/mikoskinen/vssbindingremover)应用程序。以下是完整的更改列表：

*   更新了 Visual Studio 2010 的解决方案。
*   将项目更新到 .NET 4.0。
*   更新了正则表达式以在清理后删除解决方案和项目文件中的空白行。
*   添加了删除 .suo 文件的代码。
*   修改代码以删除所有文件的只读属性。
*   添加了对 DTS (.dtproj)、C++ (.vcxproj) 和部署 (.vdproj) 项目类型的支持。
*   将核心功能分离到自己的库中，可以在其他项目中轻松使用。
*   将现有的 Windows 客户端分离到使用核心功能库的自己的项目中。
*   创建了一个使用核心功能库的命令行客户端。命令行客户端通过命令行参数和标准输入流接受其输入，因此它支持管道。

# clr - 在技 术人员演讲中，为什么不能在 32 位操作系统上运行 64 位应用程序？

> ID：878412
> 
> 赞同：2
> 
> 时间：2009-05-18T15:49:53.557
> 
> 标签：clr, 64-bit

我需要一些帮助来用技术术语描述为什么 64 位应用程序在 32 位计算机上的 32 位 Windows 中提示“不是有效的 Win32 应用程序”？任何 MSDN 参考都非常感谢（我无法通过谷歌搜索可靠的来源）。我知道它不应该运行，但我对此没有很好的解释。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-18T15:52:19.963

32 位操作系统在 32 位[保护模式下运行](http://en.wikipedia.org/wiki/Protected_mode)。64 位操作系统以[长模式](http://en.wikipedia.org/wiki/Long_mode)运行（即64 位保护模式）。64 位指令（由 64 位程序使用）仅在 CPU 处于长模式时可用；所以你不能在运行 32 位操作系统的 32 位保护模式下执行它们。

（以上说法适用于x86架构）

顺便说一句，“不是有效的 Win32 应用程序”错误消息的原因是 64 位可执行文件以 PE32+ 格式存储，而 32 位可执行文件以 PE32 格式存储。PE32+ 文件不是 32 位 Windows 的有效可执行文件。它无法理解这种格式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-18T16:03:17.680

以更底层和更详细的方式扩展其他人所说的内容：

编译程序时，会针对特定的处理器指令集编写指令。我们所看到的“x = y + z”通常相当于将一个值复制到寄存器中，将 add 命令与另一个值的内存位置一起传递，等等。

具体到这个问题，一个 64 位应用程序期望 64 位地址空间可以使用。当您将命令传递给 32 位系统中的处理器时，它会同时处理这 32 位数据。

这一切的重点？如果没有创造力，您无法在 32 位系统上处理超过 4 GB (2 ^(32 ) 的内存。)一些需要多次操作的任务（例如，处理大于 40 亿无符号数字的简单数学运算）可以在一次操作中完成。更大、更快，但需要打破与旧系统的兼容性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T15:54:58.073

64 位应用程序需要 64 位 CPU，因为它使用 64 位指令。32 位操作系统会将您的 CPU 置于 32 位模式，从而禁用上述指令。

你为什么期望它起作用？您正在编译程序以利用 32 位系统上不存在的功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T15:57:41.187

构建 64 位体系结构以调用 32 位 CPU 不支持的硬件 CPU 指令，您的 CPU 正在模拟这些指令以运行 32 位操作系统。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T16:05:33.167

由于理论上可以在指令集的某种仿真模式下运行，因此一旦您的应用程序需要超过 32 位可以解决的内存，您就会遇到麻烦。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T18:31:22.437

64 位应用程序无法在 32 位操作系统上运行的主要原因与底层程序集（此处假定为 IA-32）语言中使用的寄存器有关。在 32 位操作系统和程序中，CPU 寄存器能够处理寄存器中最多 32 位数据 (DWORDS)。在 64 位操作系统中，寄存器必须处理双倍位 (64)，因此汇编中的 QWORD 数据大小。为 x86（32 位）编译意味着编译器将寄存器限制为最多处理 32 位数据。为 x64 编译意味着编译器允许寄存器处理多达 64 位的数据。从 QWORDs (64) 降级到 DWORDs (32) 意味着您最终会丢失存储在寄存器中的一半信息。你'

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-05-18T15:51:56.300

因为它们本质上是不同的。你不会指望一个法国人能理解普通话，那你为什么指望一个 32 位的 CPU 能理解 64 位代码呢？

# c# - 调试 C# 对象初始化程序

> ID：878413
> 
> 赞同：11
> 
> 时间：2009-05-18T15:50:41.420
> 
> 标签：c#, linq, object, initializer

有人对调试 C# 对象初始化程序块中的异常有任何提示吗？对象初始值设定项语法基本上是全有或全无，这使得在 LINQ 查询内部进行故障排除特别困难。除了将对象创建分解为一个单独的方法之外，我能做些什么来查看哪个属性设置器抛出异常吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-18T15:54:18.120

禁用跳过属性设置器的选项 [跳过属性和运算符（仅限托管）] 可以让您进入属性设置器。

否则，最好的选择通常是将其分解并在 LINQ 语句之外对其进行调试。您可以将初始化参数包装成 linq 中的匿名类型，并在 linq 语句之外构造对象以进行调试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T16:21:25.677

您是否将 VS 设置为在引发异常时中断？（默认情况下仅在未处理的异常上中断）。调试 | 例外，并检查“抛出”。

仅此一项可能无法回答您的问题，但它可能有助于调试。

除此之外，您可以暂时将代码从初始化程序块中分离出来（仅用于调试），然后如果您愿意，您可以在代码工作后恢复初始化程序块。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T15:54:37.153

将其从您单独设置每个属性的对象初始化程序块中分离出来。这样你就可以真正进入代码。

# asp.net - ASP.NET 1.X 到 ASP.NET 2.0：回发时验证失效

> ID：878416
> 
> 赞同：0
> 
> 时间：2009-05-18T15:51:19.700
> 
> 标签：asp.net, validation, migration

再会，

我们已将 Web 应用程序从 ASP.NET 1.1 迁移到 ASP.NET 2.0。

我们有一个页面，其中包含几个带有各自验证器的文本框。

在 .NET 1.1 上，当文本框包含 INVALID 值时，单击“提交”按钮不会产生回发（EG 什么都不会发生）。

但是，当我们迁移到 .NET 2.0 时，即使有一个 INVALID 值，回发仍然会发生。（例如按下“提交”按钮将执行回发）。

从 1.1 迁移到 2.0 时是否存在验证问题？

附加信息：“提交”按钮是一个输入按钮：

```
<input type="button"> 
```

使用`<asp:button>`代替`<input>`按钮将起作用并解决问题。但是，它`<input type="button">`能够调用将在页面上生成“等待...加载”标签覆盖的 javascript。使用 asp:button，“等待...加载”覆盖 javascript 将不会被调用。

**编辑：真正的问题和解决方案。**

无论如何，真正的问题是点击验证 javascript 在迁移过程中被破坏了。

原始和工作脚本是：

```
<input language="javascript" onclick="{if (typeof(Page_ClientValidate) != 'function' ||  Page_ClientValidate()) __doPostBack('m_bt_Save','')} " name="m_bt_Save" id="m_bt_Save" type="button" value="Save" width="80px" height="24px" /> 
```

但 ASP.NET 2.0 将其更改为：

```
<input onclick="if (typeof(Page_ClientValidate) == 'function') Page_ClientValidate(''); __doPostBack('m_bt_Save','')" name="m_bt_Save" type="button" id="m_bt_Save" value="Save" width="80px" height="24px" /> 
```

所以我的解决方案是，将 INPUT 按钮更改为 ASP:button，然后使用正确的 ASP.NET 1.1 javascript 验证添加执行页面加载的属性，如下所示：

```
m_bt_Save.Attributes.Add("OnClick", "if (typeof(Page_ClientValidate) != 'function' ||  Page_ClientValidate()) __doPostBack('m_bt_Save','')"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T15:57:21.313

您可以做的一件事是，您可以将所需的 JS 添加到按钮中。

```
Button1.Attributes.Add("OnClick", "do my js stuff here"); 
```

这将允许您拥有与输入完全相同的功能，并使其工作。

否则，我的猜测是您将需要修改输入按钮提交的方式以在它执行 from 提交之前调用验证页面方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T17:27:00.587

您可以使用来自 javascript 的页面验证器。

请参阅此链接： [http ://www.aspdotnetfaq.com/Faq/How-to-control-ASP-NET-Validator-Controls-Client-Side-validation-from-JavaScript.aspx](http://www.aspdotnetfaq.com/Faq/How-to-control-ASP-NET-Validator-Controls-Client-Side-validation-from-JavaScript.aspx)

[http://www.codedigest.com/Articles/ASPNET/166_Restrict_AspNet_Validator_controls_to_Fire_on_Page_Submit.aspx](http://www.codedigest.com/Articles/ASPNET/166_Restrict_AspNet_Validator_controls_to_Fire_on_Page_Submit.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T06:24:44.947

这也发生在我们的升级中。我认为我们将其缩小到 WebUIValidation.js 文件的问题。我认为重新安装它是我们的最终解决方案。

# spring - Spring AOP 错误

> ID：878422
> 
> 赞同：4
> 
> 时间：2009-05-18T15:52:48.607
> 
> 标签：spring, aop, spring-aop

什么会在运行时导致此问题？：

> 匹配的通配符是严格的，但找不到元素“aop:config”的声明

这是相关的 Spring XML：

```
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
       http://www.springframework.org/schema/util
       http://www.springframework.org/schema/util/spring-util-2.0.xsd
       http://www.springframework.org/schema/aop
       http://www.springframework.org/schema/aop/spring-aop-2.0.xsd">
    .
    .
    .
    <aop:config>
        <aop:advisor pointcut="execution(* acme.exam.driver.ui.components..*(..))" 
                     advice-ref="loggingInterceptor" />
    </aop:config>

    <bean id="loggingInterceptor" 
          class="org.springframework.aop.interceptor.CustomizableTraceInterceptor">
        <property name="enterMessage" 
                  value="ENTER: $[targetClassShortName].$[methodName]($[arguments])" />
        <property name="exitMessage" 
                  value="EXIT: $[targetClassShortName].$[methodName]($[arguments]) = $[returnValue])" />
    </bean>
</beans> 
```

请注意，我已经将*aspectjweaver.jar*和*aspectjrt.jar*放在类路径中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T16:38:52.413

您是否仔细检查了 classpath 上的 spring aop 工件？

而且根据我的maven依赖，aspectjweaver是不够的，我还需要aspectjrt。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T18:23:03.890

确保它`<spring-framework-directory>/dist/modules/spring-aop.jar`在你的类路径中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-10T14:07:00.917

对于其他任何人，我在我的配置中解决了这个错误，其中命名空间包含该项目

```
xmlns:aop="http://www.springframework.org/schema/aop 
```

虽然没有包含**xsi:schemaLocation**元素

```
http://www.springframework.org/schema/aop
http://www.springframework.org/schema/aop/spring-aop.xsd 
```

此配置错误导致出现上述消息。
添加 schemaLocation 元素解决了它。

# c# - 从 C# 应用程序激活具有给定 URL 的现有浏览器窗口（不触发重新加载）

> ID：878429
> 
> 赞同：1
> 
> 时间：2009-05-18T15:54:20.287
> 
> 标签：c#, windows, winforms

从 C# 应用程序中，我想激活（brint to front）一个已经在用户默认浏览器中打开的站点。我想以与浏览器无关的方式做到这一点。

困难的部分（至少对我来说）是我**不**希望浏览器打开一个新选项卡，如果页面已经打开，浏览器**就不能重新加载页面。**

我可以在默认浏览器中打开 URI

```
System.Diagnostics.Process.Start("http://foo.example"); 
```

但具体行为取决于用户的默认浏览器（IE6 似乎重用了当前最顶层的浏览器窗口，谷歌浏览器总是会打开一个新标签页等等）

我尝试的另一种方法是枚举所有打开的窗口并根据窗口标题找到我想要的（假设大多数浏览器将窗口标题设置为当前打开页面的标题）

```
public delegate bool EnumThreadWindowsCallback(int hWnd, int lParam);

[DllImport("user32.dll")]
static extern bool SetForegroundWindow(IntPtr hWnd);

[DllImport("user32.dll")]
static extern bool EnumWindows(EnumThreadWindowsCallback callback, IntPtr extraData);

[DllImport("user32.dll")]
static extern int GetWindowText(int hWnd, StringBuilder text, int count);

private bool FindWindowByRx(int hWnd, int lParam)
{
    Regex pattern = new Regex("Example Title of Page", RegexOptions.IgnoreCase);
    StringBuilder windowTitle = new StringBuilder(256);
    GetWindowText(hWnd, windowTitle, 255);

    if (pattern.IsMatch(windowTitle.ToString()))
    {
        SetForegroundWindow(new IntPtr(hWnd));
        return false; // abort search
    }
    else
    {
        return true; // keep on searching
    }
} 
```

使用它：

```
EnumWindows(new EnumThreadWindowsCallback(FindWindowByRx), new IntPtr()); 
```

这可以满足我的需要，但感觉非常脆弱和骇人听闻，而且可能很慢。

有没有更好、更优雅的方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T16:00:50.167

如果用户在浏览器中激活了该站点，这将起作用。如果他们使用的是选项卡式浏览器，并且该站点已打开，但不在选定的选项卡中，我不相信您会找到浏览器窗口。（EnumWindows 仅枚举顶级窗口）。

如果用户启动了一个新选项卡，您最终会找不到它，并且（可能）在新选项卡中启动该站点的第二个副本。

就个人而言，如果您确实需要限制为单个浏览器实例，我会考虑是否可以将浏览器嵌入到您的应用程序中，而不是使用默认浏览器。如果这可以使用浏览器控件在您的应用程序中作为 GUI 元素，您将拥有更多的控制权，并且能够避免这种类型的解决方法。

# security - 一个 Apache 服务的纯 HTML 网站会被黑客入侵吗？

> ID：878430
> 
> 赞同：1
> 
> 时间：2009-05-18T15:54:34.687
> 
> 标签：security

假设您在 Apache 上运行一个纯 HTML 网站。只是提供静态文件，没有动态的，没有什么花哨的。

还假设所有密码都是安全的，并且没有社交黑客攻击（即网络钓鱼攻击等......）

这种性质的网站基本上可以被黑吗？服务器会受到威胁吗？有没有这方面的例子？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T16:02:37.417

是的，这样的服务器可能会受到威胁。可悲的是，一个非常常见的向量是通过不安全的 wifi 连接 FTP 到服务器。任何仔细聆听的人都可以从空中挑选出您的密码。（参加技术会议并将您的密码显示在屏幕上供所有人查看，以及其他通过 wifi 明文发送凭据的傻瓜，这很有趣。）

另一个常见的向量是使用简单的密码并使其陷入字典攻击。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T16:01:33.283

当然，它可以通过 Apache 本身的安全漏洞受到损害。虽然向服务器本身添加更多层（如 php、sql 等）确实会增加漏洞的可能性，但没有什么是万无一失的。

然而，Apache 是一个非常知名的开源程序，社区在清除此类错误方面做得很好。

简短回答：任何联网设备都有可能被“黑客入侵”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T16:02:21.193

您可能会对阅读一两篇**[有关](http://www.petefreitag.com/item/505.cfm)**“**保护****[Apache 2](http://www.securityfocus.com/infocus/1786)** **”的****[文章](https://web.archive.org/web/1/http://techrepublic%2ecom%2ecom/2415-7343_11-159903.html)**感到好奇。

可以合理地说它是安全的，但您可能需要注意 Apache*确实附带了一些已经启用的模块*。

此外，保护 Apache 的目标不应该只是保护服务器实例本身，还应该以**沙盒方式对服务器进行沙箱化，以限制任何此类入侵可能造成的损害**。

当然，所有这些信息都取决于 Web 服务器是盒子上唯一暴露的组件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T15:57:19.253

任何关于网站本身的“可破解”都必须是 Apache 本身的 hack。如果是这样，那么您遇到的问题不仅仅是一个网站。

因此，在实际层面上，不，鉴于“所有密码文件都是安全的”条件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-19T04:47:53.020

理论上它可以被黑客入侵，但理论上任何东西都可以被黑客入侵。在实践中没有。因为 Apache 已经好几年没有出现任何重要的漏洞了。

# python - PyImport_Import 与导入

> ID：878439
> 
> 赞同：2
> 
> 时间：2009-05-18T15:56:27.833
> 
> 标签：python, c, import

我试过更换

```
PyRun_SimpleString("import Pootle"); 
```

和

```
PyObject *obj = PyString_FromString("Pootle");
PyImport_Import(obj);
Py_DECREF(obj); 
```

在一些 C 代码中初始化模块 Pootle 之后。第一个似乎使名称`Pootle`可用于后续`PyRun_SimpleString`调用，但第二个没有。

有人可以向我解释一下区别吗？有没有办法做第一个对 C API 调用所做的事情？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T17:11:32.003

调用所做的`PyImport_Import`只是返回对模块的引用——它不会使这样的引用对程序的其他部分可用。因此，如果您想`PyRun_SimpleString`查看新导入的模块，则需要手动添加它。

`PyRun_SimpleString`在`__main__`模块命名空间中自动工作。没有过多关注错误检查（小心 NULL 返回！），这是一个大致的大纲：

```
PyObject *main = PyImport_AddModule("__main__");  
PyObject *obj = PyString_FromString("Pootle");
PyObject *pootle = PyImport_Import(obj);  
PyObject_SetAttrString(main, "Pootle", pootle);  

Py_DECREF(obj);
Py_XDECREF(pootle); 
```

# design-patterns - 设计模式主要与什么有关？

> ID：878441
> 
> 赞同：0
> 
> 时间：2009-05-18T15:56:39.707
> 
> 标签：design-patterns

大多数人说设计模式只与软件工程有关。

模式使我们专注于重用现有模块或将我们从未来变化带来的繁重工作中解放出来。

模式是否使程序运行更高效？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T15:59:33.303

[我认为 wiki 说得最好。](http://en.wikipedia.org/wiki/Design_patterns)

> 架构和计算机科学中的设计模式是记录特定专业领域中设计问题的解决方案的正式方式。

它可以使程序更有效地运行，可以减少内存占用，可以使扩展更容易。等等等等

这完全取决于您在谈论什么模式以及您将其应用于什么软件问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T16:03:05.403

**不要重新发明轮子。**

这是主要目标。设计模式旨在解决重复的问题。

因此，它们可以帮助您获得更清晰、可用（和可重复使用）的代码（只要它们使用得当）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T13:37:05.513

设计模式通常用于帮助促进不同组件的松散耦合，以便对象本身可以在不同的应用程序中一次又一次地重用，而无需进行重大修改。代码的可重用性是开发中的一个主要因素。

要考虑的另一件事是，通过使您的代码松散耦合，通过使用设计模式来实现更改将花费更少的时间，因为一个领域的重大变化并不意味着要促进整个领域的大规模变化。这意味着，如果您想进行持续更新和功能升级，您可能只需要修改代码的一小部分和孤立的部分，而不必担心整个项目会在您周围一团糟。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T16:01:27.840

实际上有数百种设计模式。其中一些是为了便于维护，其中一些是为了正确访问对象，我相信其中一些甚至可以被认为是“性能”增强模式。

关键是它们是经过验证的解决问题的方法，从本质上讲，它们可能会提高性能或许多其他方面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T16:02:05.687

简而言之，我可以说设计模式实际上是一种解决问题的方法。如果您知道存在问题和设计模式，那么设计模式将以最好的方式解决您的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T16:03:07.120

这些模式使您的程序更易于维护，因此您的编程可能更有效。这不一定会影响运行时效率（由于运行时多态性，程序可能会更慢）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T16:05:22.030

“模式会让程序运行得更高效吗？”

仅当您找到了一些提高效率的良好模式时。

**映射**的设计模式是一种消除搜索的方法。您会看到花费在搜索上的时间会更少（一种效率），但它可能会使用更多的内存（另一种效率）。

树**图**设计模式（Python 人称其为有序字典）是这种设计模式的一种变体。

**Hash Map**设计模式（Python 人称其为字典）是该设计模式的另一种变体。

它们的时间效率更高，但空间效率更低。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-18T16:06:19.750

设计模式是对定义明确的问题的解决方案。该解决方案由相互关联的不同部分组成。该解决方案属于特定的上下文，其优点/缺点取决于所使用的工具，以及强调问题的哪个方面。设计模式也是沟通设计的好方法。

这不仅仅是一个软件的东西，相反，这个想法大量借鉴了一位名叫[Christopher Alexander](http://en.wikipedia.org/wiki/Christopher_Alexander)的建筑师。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-19T12:33:27.903

设计模式之于对象就像算法之于过程编程。设计模式告诉您如何创建一个或多个对象来执行一些有用的任务。就像一个算法告诉你如何组合语句来执行一些有用的任务。

# ant - 在 shell 中使用 Ant 的依赖问题

> ID：878449
> 
> 赞同：0
> 
> 时间：2009-05-18T15:58:35.677
> 
> 标签：ant, dependencies, javac

我在使用 Ant 本身从命令提示符处使用 Ant 脚本构建项目时遇到问题。

它在我的项目中找不到特定 Java 文件的特定导入（它有近 5,000 个源文件）。导入包含在一个 .jar 包中，我在 Ant 文件本身中设置了该包的位置。（作为一个路径元素，以及其他需要的 JAR，它们要么很好，要么在崩溃发生时未尝试使用）。崩溃发生在 javac 上，简单的消息是“import etc.ect.* cannot be found at line etc”

奇怪的是，我可以使用 Eclipse 之类的 IDE 从 Ant 文件构建项目。有什么想法可能是错的吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T16:47:49.620

哇，解决方案完全不相关。在类试图从只有文件夹的目录中导入 .* 的 Java 代码中，这是一个愚蠢的错误。出于某种原因，Eclipse 似乎并不介意，但 javac 却做到了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:01:44.237

Eclipse 的根类加载器包含很多类，当您从控制台运行 ant 时，就会少得多。

只需告诉 javac 任务使用所需的 .jar，就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T16:04:16.103

您应该发布堆栈跟踪，是否显示“...需要导入”？（我忘记了确切的文字）。您的 Eclipse 环境中可能有一个 jar 可用，但未包含在您的 ant 脚本中。在堆栈跟踪中查找缺少的类，以识别未包含在您的构建中的 jar。

# c# - WMS认证插件

> ID：878450
> 
> 赞同：0
> 
> 时间：2009-05-18T15:58:42.527
> 
> 标签：c#, authentication, plugins, wms

我正在尝试在 C# 中为 WMS 2009 创建一个自定义身份验证插件。

我设法实现了一些出于某种原因阻止所有请求的东西......

```
[ComVisible(true)]
[Guid("C0A0B38C-C4FE-43B5-BE9E-C100A83BBCEE")]
public class AuthenticationPlugin : IWMSBasicPlugin, IWMSAuthenticationPlugin, IWMSAuthenticationContext
    private const string SubKey = "SOFTWARE\\Microsoft\\Windows Media\\Server\\RegisteredPlugins\\Authentication\\{C0A0B38C-C4FE-43B5-BE9E-C100A83BBCEE}";

    [ComRegisterFunction]
    public static void RegisterFunction(Type t)
    {
        try
        {
            RegistryKey regHKLM = Registry.LocalMachine;
            regHKLM = regHKLM.CreateSubKey(SubKey);
            regHKLM.SetValue(null, "UC WMS Authentication plugin");

            RegistryKey regHKCR = Registry.ClassesRoot;
            regHKCR = regHKCR.CreateSubKey("CLSID\\{C0A0B38C-C4FE-43B5-BE9E-C100A83BBCEE}\\Properties");
            regHKCR.SetValue("Name", CustomC WMS Authentication plugin");
            regHKCR.SetValue("Author", "Me");
            regHKCR.SetValue("CopyRight", "Copyright 2009\. All rights reserved");
            regHKCR.SetValue("Description", "Enables custom WMS authentication");
        }
        catch (Exception error)
        {
            Console.WriteLine(error.Message, "Inside RegisterFunction(). Cannot Register.");
        }
    }

    [ComUnregisterFunction]
    public static void UnRegisterFunction(Type t)
    {
        try
        {
            RegistryKey regHKLM = Registry.LocalMachine;
            regHKLM.DeleteSubKey(SubKey);

            RegistryKey regHKCR = Registry.ClassesRoot;
            regHKCR.DeleteSubKeyTree("CLSID\\{C0A0B38C-C4FE-43B5-BE9E-C100A83BBCEE}");
            regHKCR.DeleteSubKeyTree("CSEventTest.CSEventPlugin");
        }
        catch (Exception error)
        {
            Console.WriteLine(error.Message, "Cannot delete a subkey.");
        }
    }

    #region IWMSBasicPlugin Members

    public void InitializePlugin(IWMSContext serverContext, WMSNamedValues namedValues, IWMSClassObject classFactory)
    {
    }

    public void ShutdownPlugin()
    {
    }

    public void EnablePlugin(ref int flags, ref int heartbeatPeriod)
    {
    }

    public void DisablePlugin()
    {
    }

    public object GetCustomAdminInterface()
    {
        return null;
    }

    public void OnHeartbeat()
    {
    }

    #endregion

    #region IWMSAuthenticationPlugin Members

    public IWMSAuthenticationContext CreateAuthenticationContext()
    {
        return (IWMSAuthenticationContext)this;
    }

    public int GetFlags()
    {
        return Convert.ToInt32(WMS_AUTHENTICATION_FLAGS.WMS_AUTHENTICATION_ANONYMOUS, CultureInfo.InvariantCulture);
    }

    public string GetPackageName()
    {
        return "Custom WMS Authentication";
    }

    public string GetProtocolName()
    {
        return "Basic";
    }

    #endregion

    #region IWMSAuthenticationContext Members

    public void Authenticate(object responseBlob, IWMSContext userContext, IWMSContext presentationContext, IWMSCommandContext commandContext, IWMSAuthenticationCallback callBack, object context)
    {
        callBack.OnAuthenticateComplete(WMS_AUTHENTICATION_RESULT.WMS_AUTHENTICATION_SUCCESS, null, context);
    }

    public IWMSAuthenticationPlugin GetAuthenticationPlugin()
    {
        return (IWMSAuthenticationPlugin)this;
    }

    public string GetImpersonationAccountName()
    {
        return String.Empty;
    }

    public int GetImpersonationToken()
    {
        return 0;
    }

    public string GetLogicalUserID()
    {
        return this.GetImpersonationAccountName();
    }

    #endregion
} 
```

谁能发现为什么会这样？

另外，有什么方法可以查看已经安装在服务器上的标准匿名身份验证插件的代码吗？它在某个地方的集会中吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-06-02T13:18:37.043

我遇到了同样的问题。从 Authenticate 方法返回成功状态是不够的。

您实现的方法必须检索到有效 Windows 登录的句柄。在网上搜索如何调用此方法的 C# 示例：http: [//msdn.microsoft.com/en-us/library/aa378184%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa378184%28VS.85%29.aspx)

```
bool result = LogonAPI.LogonUser("username", "domain", "password", LogonAPI.LOGON32_LOGON_NETWORK, LogonAPI.LOGON32_PROVIDER_DEFAULT, ref _userToken); 
```

存储从 LogonUser 调用返回的 IntPtr 并实现 GetImpersonationToken 方法，如下所示：

```
public int GetImpersonationToken()
{
    return _userToken.ToInt32();
} 
```

不知何故，插件能够将该整数值绑定回真实的 Windows 帐户。我在 Power Users 组中的服务器上创建了一个本地帐户，并在 LogonUser 方法中使用其用户名和密码，服务器是域。一旦能够这样做，媒体就应该流式传输。

我的整个 IWMSAuthenticationPlugin 如下（它使用基本身份验证）：

```
public class AuthenticationContext : IWMSAuthenticationContext
{
#region IWMSAuthenticationContext Members

private WMS_AUTHENTICATION_RESULT _result;

private readonly IWMSAuthenticationPlugin _plugin;
private Credentials _credentials;
private IntPtr _userToken;

public AuthenticationContext(IWMSAuthenticationPlugin plugin)
{
    _plugin = plugin;
}

public void Authenticate(object responseBlob, IWMSContext pUserCtx, IWMSContext pPresentationCtx, IWMSCommandContext pCommandContext, IWMSAuthenticationCallback pCallback, object context)
{
    // must be Unicode.  If it isn't, the 
    // challenge isn't sent correctly
    Encoding enc = Encoding.Unicode;
    byte[] response;
    byte[] challenge = enc.GetBytes("");

    try
    {
        response = (byte[])responseBlob;
        if (response.Length == 0)
        {
            // The client requested authentication; prepare the
            // challenge response to send to the client.  In order to 
            // do Basic authentication, be sure to return "Basic" from 
            // your implementation of IWMSAuthenticationPlugin.GetProtocolName()
            string challengeTxt = "WWW-Authenticate: Basic realm=\"Domain\"";
            challenge = enc.GetBytes(challengeTxt);

            _result = WMS_AUTHENTICATION_RESULT.WMS_AUTHENTICATION_CONTINUE;
        }
        else
        {
            // parses Base64 encoded response and gets passed in credentials
            SetCredentials(enc.GetString(response));

            LdapConnection ldc = new LdapConnection("Domain");
            NetworkCredential nc = new NetworkCredential(_credentials.Username, _credentials.Password, "Domain");
            ldc.Credential = nc;
            ldc.AuthType = AuthType.Negotiate;
            ldc.Bind(nc); // user has authenticated at this point, as the credentials were used to login to the dc.

            // must log in with a local windows account and get a handle for the account.
            // even if success is returned, the plugin still needs a valid windows account
            // to stream the file.                    
            bool result = LogonAPI.LogonUser("local username", "local domain", "local password", LogonAPI.LOGON32_LOGON_NETWORK, LogonAPI.LOGON32_PROVIDER_DEFAULT, ref _userToken);
            _result = WMS_AUTHENTICATION_RESULT.WMS_AUTHENTICATION_SUCCESS;
        }
    }
    catch (LdapException e)
    {
        _result = WMS_AUTHENTICATION_RESULT.WMS_AUTHENTICATION_DENIED;
    }
    catch (Exception e)
    {
        _result = WMS_AUTHENTICATION_RESULT.WMS_AUTHENTICATION_ERROR;
    }
    finally
    {
        pCallback.OnAuthenticateComplete(_result, challenge, context);
    }
}

public IWMSAuthenticationPlugin GetAuthenticationPlugin()
{
    return _plugin;
}

public string GetImpersonationAccountName()
{
    return "Domain\\" + _credentials.Username;
}

public int GetImpersonationToken()
{
    // somehow the plugin knows how this integer ties to a windows account.
    return _userToken.ToInt32();
}

public string GetLogicalUserID()
{
    return GetImpersonationAccountName();
}

public void SetCredentials(string responseStr)
{
    // for whatever reason, the responseStr has an extra character
    // tacked on the end that blows up the conversion.  When converting
    // from the Base64 string, remove that last character.
    string decoded = new UTF8Encoding().GetString(Convert.FromBase64String(responseStr.Substring(0, responseStr.Length - 1)));

    // now that the string has been decoded and is now in the format
    // username:password, parse it further into a Username and Password 
    // struct.
    _credentials = new Credentials(decoded);
}

#endregion
} 
```

# windows - OpenGL 上下文和设备上下文如何工作？

> ID：878452
> 
> 赞同：2
> 
> 时间：2009-05-18T15:59:31.247
> 
> 标签：windows, user-interface, opengl, drawing, openglcontext

我是 U/I 编程的新手，我正在尝试开始使用 OpenGL。当我运行一个使用 GLUT 创建新 OpenGL 窗口的示例程序时，它运行良好。好的。但是，在另一个程序的上下文中，我必须响应 Draw 事件（在 Windows 上），并将设备上下文传递给我——而且我可能没有可用的 GLUT——我的困惑是：

1.  何时创建和销毁设备上下文？我可以绘制给我的任何设备上下文，还是只绘制其中的一些（我怎么知道）？

2.  我是否必须创建自己的 OpenGL 上下文并使用它来绘制，或者我可以使用“当前”OpenGL 上下文？每次发送绘图事件时，我是否必须重新创建上下文？

基本上我的问题是，在我收到“Draw”事件的情况下，我多久尝试一次创建 OpenGL 上下文以及这与设备上下文的创建/销毁周期有何关系？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T16:08:59.603

通常，将单个 OpenGL 上下文视为一个窗口通常是安全的，尤其是在窗口上。

设备上下文将（通常）映射到窗口句柄 (HWND)。它实际上是一个 DC（HDC 是句柄），但通常您会将一个 HDC 与一个 HWND 相关联。在 Windows 中，您将根据要渲染的屏幕上的窗口创建一个要使用的窗口。

通常，您将在应用程序的整个运行时重用此设备上下文。如果要渲染到不同的窗口，则需要为新窗口句柄生成设备上下文 (HDC)。此外，屏幕外渲染有点不同，因为您也需要为此创建兼容的设备上下文。

至于你的问题：

1) 当您创建要在其中进行渲染的窗口时，您将获取一个设备上下文，并在该窗口的整个生命周期内使用它。

2）您将希望始终使用为您正在渲染的窗口创建的设备上下文。

# flash - 为什么这会修复 Flash 中的双显示器问题？

> ID：878460
> 
> 赞同：6
> 
> 时间：2009-05-18T16:00:23.303
> 
> 标签：flash, hex, multiple-monitors

# 问题：

您设置了双显示器，并在其中一台显示器上以全屏模式观看 Flash 视频（比方说任何 YouTube 视频）。如果您在另一台显示器上工作，视频将退出全屏模式。因此，您无法在全屏模式下观看视频时工作。

# 解决方案：

谷歌搜索产生了这个绝妙的解决方案。 [http://www.youtube.com/watch?v=qwH_-C2-93E](http://www.youtube.com/watch?v=qwH_-C2-93E) 基本上，它将'0x136340'地址处的字节值从'74'更改为'EB'下面的DLL，它做了诡计！

C:\WINDOWS\system32\Macromed\Flash\NPSWF32.dll（仅适用于 Flash v10）

# 问题：

为什么这个解决方案会解决这个问题？改变字节值到底有什么作用？

谢谢大家！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T16:03:10.690

我敢打赌它会`if(someting) {...}`变成`if(0) {...}`.

我想它会阻止代码在切换到另一个窗口时退出全屏，永远。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-02-24T16:23:42.610

Update: So I have checked, and it works because it is replacing a conditional jump with an unconditional jump.

~~I believe it is a goto.~~

I've written this to automatically 'hack' various versions of flash (saving you the trouble of breaking out a hex editor) [http://jmaxxz.com/index.php?option=com_content&view=article&id=89:flashhacker&catid=16:downloads&Itemid=32](http://jmaxxz.com/index.php?option=com_content&view=article&id=89:flashhacker&catid=16:downloads&Itemid=32)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T14:22:07.527

它可以像 alamar 状态一样，只需更改 if 语句的条件。

虽然我发现它更有可能是 at goto 语句的地址，所以退出全屏的代码被绕过了。

无论如何，效果几乎相同。如果不是专家，我只是认为另一个想法更容易制作。但是 StackOverflow 上有其他人可以肯定地告诉你。

# eclipse - 使用 Eclipse Ganymede 对方法进行更细粒度的排序：有没有好的插件可用？

> ID：878461
> 
> 赞同：4
> 
> 时间：2009-05-18T16:00:23.350
> 
> 标签：eclipse, refactoring, eclipse-plugin

这些是我们开箱即用的选项：

[![替代文字](https://i.stack.imgur.com/0Kfc3.png)](https://i.stack.imgur.com/0Kfc3.png)

在方法方面，我想要更细粒度的排序。我想：

1.  让所有方法的名称不以**get**、**is**或**set**开头。
2.  然后拥有访问器方法（名称以 get、is 或 set 开头）。

单独`[1]`和`[2]`上面的方法可以按字母顺序排序。除了将常规方法分为两部分外，我喜欢现有的排序顺序。

我发现这个顺序（最后使用访问器方法）更好，因为当我维护一个类并且我需要修复错误等时，我更有可能找到有趣的非访问器方法。

有我可以使用的插件吗？如果没有，自己做这种插件会不会很困难？（我从未创建过 Eclipse 插件。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-15T17:00:46.560

我希望我的回答还不算晚。

据我所知，没有这样的插件（我现在查看了 eclipse 插件中心）。

如果您想编写这样的插件，编写重构（Java 编辑器基于 AST，可以通过扩展点访问）本身应该不会太难，但是对于构建一个工作插件可能需要更多的研究.

一些可能有帮助的资源：

*   来自stackoverflow的插件开发资源：**问题592391**（抱歉，不能发两个超链接）
*   一个开源重构插件：[http](http://code.google.com/p/tane/) ://code.google.com/p/tane/ （它目前包含一个重构加上相关的 gui 元素，它可能是一个很好的例子）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T23:39:09.533

2011 年，一项学术[练习产生](http://code-recommenders.blogspot.com.au/2011/08/eclipse-clean-code-method-sorter-try-1.html)了一个[Eclipse 插件，它根据 Robert C. Martin 的“清洁代码”一书中的想法实现了方法排序](http://wiki.eclipse.org/Recommenders/CleanCodeMethodSorter)。我还在努力解决我是否喜欢它。

有一个开放的错误报告来增强 Eclise 中的排序成员功能：[排序成员不提供对 getter/setter 对进行分组的方法](https://bugs.eclipse.org/bugs/show_bug.cgi?id=72418)。它于 2004 年开业，目前还没有实施的计划。

# sql - 如何使用 MySQL 计算移动平均线？

> ID：878473
> 
> 赞同：5
> 
> 时间：2009-05-18T16:02:41.800
> 
> 标签：sql, mysql, statistics

我需要做类似的事情：

```
SELECT value_column1 
FROM table1 
WHERE datetime_column1 >= '2009-01-01 00:00:00' 
ORDER BY datetime_column1; 
```

除了 之外`value_column1`，我还需要检索的前 20 个值的[移动平均值](http://en.wikipedia.org/wiki/Moving_average)`value_column1`。

首选标准 SQL，但如有必要，我将使用 MySQL 扩展。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-18T16:15:17.110

这只是我的想法，我正在出门的路上，所以它未经测试。我也无法想象它会在任何类型的大型数据集上表现得非常好。我确实确认它至少运行没有错误。:)

```
SELECT
     value_column1,
     (
     SELECT
          AVG(value_column1) AS moving_average
     FROM
          Table1 T2
     WHERE
          (
               SELECT
                    COUNT(*)
               FROM
                    Table1 T3
               WHERE
                    date_column1 BETWEEN T2.date_column1 AND T1.date_column1
          ) BETWEEN 1 AND 20
     )
FROM
     Table1 T1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T17:41:06.873

Tom H 的方法会奏效。如果你有一个标识列，你可以像这样简化它：

```
SELECT T1.id, T1.value_column1, avg(T2.value_column1)
FROM table1 T1
INNER JOIN table1 T2 ON T2.Id BETWEEN T1.Id-19 AND T1.Id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T16:22:01.370

当我遇到类似的问题时，出于各种原因，我最终使用了临时表，但这让这变得容易多了！就架构而言，我所做的看起来与您正在做的非常相似。

使架构类似于 ID 身份、开始日期、结束日期、值。选择时，根据身份 ID 对前 20 个进行子选择平均。

仅当您发现自己出于其他原因已经在使用临时表时才这样做（我一遍又一遍地针对不同的指标点击相同的行，因此拥有小数据集很有帮助）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-02T20:01:56.113

我的解决方案在表中添加了一个行号。以下示例代码可能会有所帮助：

```
set @MA_period=5;
select id1,tmp1.date_time,tmp1.c,avg(tmp2.c) from 
(select @b:=@b+1 as id1,date_time,c from websource.EURUSD,(select @b:=0) bb order by date_time asc) tmp1,
(select @a:=@a+1 as id2,date_time,c from websource.EURUSD,(select @a:=0) aa order by date_time asc) tmp2
where id1>@MA_period and id1>=id2 and id2>(id1-@MA_period)
group by id1
order by id1 asc,id2 asc 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-09-12T13:07:20.017

我意识到这个答案已经晚了大约 7 年。我有类似的要求，并认为我会分享我的解决方案，以防它对其他人有用。

有一些用于技术分析的 MySQL 扩展，包括简单的移动平均线。它们非常易于安装和使用：[https ://github.com/mysqludf/lib_mysqludf_ta#readme](https://github.com/mysqludf/lib_mysqludf_ta#readme)

安装 UDF 后（根据 README 中的说明），您可以在 select 语句中包含一个简单的移动平均线，如下所示：

```
SELECT TA_SMA(value_column1, 20) AS sma_20 FROM table1 ORDER BY datetime_column1 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-07-02T08:01:41.347

根据我的经验，从 5.5.x 开始，Mysql 倾向于不使用依赖选择的索引，无论是子查询还是连接。这会对性能产生非常显着的影响，因为相关选择标准在每一行上都发生了变化。

移动平均线是属于此类别的查询示例。执行时间可能会随着行的平方而增加。为了避免这种情况，选择了一个可以对依赖选择执行索引查找的数据库引擎。我发现 postgres 有效地解决了这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-12-10T22:20:39.630

在 mysql 8[窗口函数框架](https://dev.mysql.com/doc/refman/8.0/en/window-functions-frames.html)中可用于获取平均值。

```
SELECT value_column1, AVG(value_column1) OVER (ORDER BY datetime_column1 ROWS 19 PRECEDING) as ma
FROM table1
WHERE datetime_column1 >= '2009-01-01 00:00:00' 
ORDER BY datetime_column1; 
```

这将计算当前行和前 19 行的平均值。

# javascript - 以 TextArea 为背景的 TextArea 字符限制器作为实时计数器

> ID：878485
> 
> 赞同：1
> 
> 时间：2009-05-18T16:05:18.957
> 
> 标签：javascript

我正在研究一种解决方案，当您在 TextArea 中键入文本时，它应该通知用户还剩多少字符要输入。就像你只能输入200或其他东西。这很容易制作，但我希望计数器显示在 TextArea 的背景中，而不是单独的地方。

我知道我可以更改 TextArea 的背景图像，但是如何将 Text 显示为褪色或不透明度为 0.4/0.5 的 textarea 的背景。一种解决方案是制作大量图像，然后在用户键入字符时更改图像。我不认为我想走那条路，因为它会迫使我创建 200 张图像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T16:07:56.877

你能把它包装在一个div中然后让textarea透明然后把文本放在它后面的div中。您需要将 textarea 绝对定位在 div 中。

这也可以

```
<div style="position:relative; width:500px; height:500px; ">
150
    <textarea style="position:absolute; background-color:transparent; top:0; left:0; width:500px; height:500px;"></textarea>
</div> 
```

您必须修改 div 的文本颜色和边距等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:10:18.510

您是否尝试过使用 jQuery 来执行此操作？这是一篇关于如何使用 javascript 和 css 做（水印）你正在寻找的东西的帖子。

[http://updatepanel.net/2009/04/17/jquery-watermark-plugin/](http://updatepanel.net/2009/04/17/jquery-watermark-plugin/)

# amazon-web-services - 使用 SimpleDB 作为数据源构建 Web 应用程序的最佳选择？

> ID：878493
> 
> 赞同：1
> 
> 时间：2009-05-18T16:07:01.307
> 
> 标签：amazon-web-services, amazon-simpledb

我已经看过 SimpleDB 的 PHP 库，但没有什么太有趣的……是否有任何最佳实践或框架，或者我应该继续这样做吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-27T13:56:01.923

除了 Amazon 的 SimpleDB 基本 PHP 库之外，我还知道另外两个库。

[Paws](http://code.google.com/p/paws-library/)是一个 SimpleDB 特定的库，并且

[Tarzan](http://tarzan-aws.com/)支持许多亚马逊网络服务，并且似乎有据可查。

需要注意的一件事是，任何单个 SimpleDB 请求可能不如普通数据库调用快，但大多数时候您可以并行调用。

如果您能够在 Amazon EC2 上运行您的 Web 应用程序（自托管或如果您可以找到使用 EC2 的托管公司），您将看到 SimpleDB 请求的延迟比从 Amazon 之外的 PHP 主机获得的延迟要低得多云。在 EC2 上运行时，SimpleDB 的往返延迟通常为 2-7 毫秒（不包括请求处理时间）。

# c - 多个子进程+从流中读取

> ID：878494
> 
> 赞同：2
> 
> 时间：2009-05-18T16:07:14.613
> 
> 标签：c, fork, child-process, external-sorting

参考我的最后一个问题（[多个子进程](https://stackoverflow.com/questions/876605/multiple-child-process)），我现在正在尝试使用多个子进程进行外部排序实现。

```
...
fp = fopen(pathname, "r"); // open inputfile in r mode
fgets(trash, 10, fp); // ignore first line

for (i=0; i<numberOfProcess; ++i) {
    #ifdef DBG
        fprintf(stderr, "\nDBG: Calling fork()\n"); 
    #endif

    if ((pids[i] = fork()) < 0) {
        perror("fork error");
        exit(EXIT_FAILURE);

    } else if (pids[i] == 0) { // Child Code

        if (numbersToSort % numberOfProcess == 0) { // 16 % 4 = 0
            partialDataSize = numbersToSort / numberOfProcess;          

            for (j=0; j<partialDataSize; j++) { 
                fscanf(fp, "%d", &arrayPartialData[j]);
                qsort(arrayPartialData, partialDataSize, sizeof(int), (void *)comp_num);

                //printf("%d\n", arrayPartialData[j]);
                // TODO: qsort data until partialDataSize
            }

        } 
        printf("pid: %d child process %d outputs: ", getpid(), pids[i]);
        printArray(arrayPartialData, partialDataSize);
        //break;
        exit(0);
    }  
}   

/* Wait for children to exit. */

while (numberOfProcess > 0) {
    pid = wait(&status);
    --numberOfProcess;
}

fclose(fp); 
```

但当然，由于 fscanf，这段代码会从 inputfile 输出相同的排序整数序列。例如，如果输入文件的开头包含 5 1 4，那么它会输出：

(第一个孩子) 1 4 5
(第二个孩子) 1 4 5

（有两个子进程）.. 因为 fscanf 从输入流的开头开始读取整数。

我现在的问题是如何继续从前一个子进程离开的点开始读取数字？例如，如果输入文件包含 5 1 4 8 5 10，那么它可以输出：

（第 1 个孩子） 1 4 5

(第二个孩子) 5 8 10

提前致谢;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T16:23:37.467

我会使用较低级别的 open() 和 read() 而不是等效的流，否则您将不得不担心将 stdio 缓冲区与底层文件描述符同步。请注意，您仍然会遇到读取完整数字的问题，因此您可能需要在进程之间进行一些同步。

作为替代方案，我建议使用单个进程来读取文件并将行的子集写入进行排序的子进程（使用 pipe()），然后将其写入另一个进行合并的进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:20:39.330

如果你使用 fscanf，你唯一能做的就是让每个进程读取并丢弃数字，直到它到达它应该处理的那些。在您的情况下，丢弃 i*partialdatasize 数字。

所以例如 5 7 3 1 4 8 5 10 2 你可能有 5 7 3

1 4 8

5 10 2

这会给出

3 5 7

1 4 8

2 5 10。

然后你必须弄清楚如何合并排序的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T16:34:17.493

如果您可以将整数存储为二进制。您可以让第一个线程读取它的块

```
fread(&arrayPartialData[j], sizeof(int), partialDataSize, fp); 
```

第二个线程可以跳过已经读取的块（因为你知道每个块的大小）。然后您可以从那里开始阅读，而无需丢弃任何数据。

```
fseek(partialDataSize * threadNumber); 
```

我还建议您使用线程，因为分叉非常昂贵。[线程教程](http://students.cs.byu.edu/~cs460ta/cs460/labs/pthreads.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-12T14:13:43.870

您正在使用链接频道。

来自**glibc 13.5.1**（重点是我的）

> 来自单个打开的通道共享相同的文件位置；我们称它们为**链接频道**。当您使用 fdopen 从描述符创建流时，当您从具有 fileno 的流中获取描述符时，当您使用 dup 或 dup2 复制描述符时，**以及在 fork 期间继承描述符时，会产生链接通道。**

显然，您不能同时从两个流中执行 I/O。

> 如果您一直在使用流进行 I/O（或刚刚打开流），并且想要使用与其链接的另一个通道（流或描述符）进行 I/O，则必须首先清理您一直在使用的流。

# asp.net - .netCART 信用卡解密 - IIS 7 应用程序池和解密问题

> ID：878500
> 
> 赞同：0
> 
> 时间：2009-05-18T16:08:23.677
> 
> 标签：asp.net, vb.net, .net-2.0, windows-server-2008

我有一个使用[.netCART](http://www.dotnetcart.com/)的网站。它在 Windows Server 2003 和 .NET 2.0 的生产环境中运行良好。在新服务器（Windows Server 2008）上，除了商店管理员中的信用卡解密外，一切正常。没有发送错误，没有抛出异常，只是将加密的字符串输出到屏幕，而不是解密的信用卡号。

```
Dim strCCEncrypt As String
strCCEncrypt = Trim(DataRow.Item("CreditCard"))
strCCEncrypt = tools.Decrypt(strCCEncrypt) 'tools is a .netCART utility 
```

有没有人有过 .netCART 的经验，或者以前见过这个问题？

编辑：经过昨天的大量调查，似乎问题与应用程序池（在 .NET 2.0 上以经典管道模式运行）和解密有关。谁能告诉我与帮助处理解密的默认应用程序池相关联的进程或服务是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-19T00:31:27.203

不知道您的具体问题出在哪里，但是该代码段等效于：

```
Dim CCEncrypt As String = tools.Decrypt(DataRow("CreditCard").ToString().Trim()) 
```

解释这些变化：

*   您可以跳过该`.Item`部分，因为它是 DataRow 的索引器
*   `.ToString()`但是如果是其他类型或 DbNulls，您应该调用
*   然后使用字符串类型的`.Trim()`方法而不是VB`Trim()`函数。 `Trim()`和其他旧字符串函数的存在仅仅是为了向后兼容。您最好习惯于附加到字符串类型的方法。
*   在.Net中，声明一个变量并在同一行分配给它没什么大不了的
*   在 .Net 中，Microsoft 的样式指南特别建议不要在变量名称上使用任何匈牙利符号类型的疣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-02T15:14:49.350

这个问题的最终结果是我使用 Reflector 来获取方法，手动提供密钥来执行解密，因为上面显示的解密方法只是提供了对获取密钥的方法的调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-02T15:20:10.993

检查 web.config 中的 machinekey 元素。信用卡是否可能使用与您尝试解密它们不同的密钥进行加密？

# serial-port - 更改 boost::asio::serial_port 的 DCB 结构

> ID：878510
> 
> 赞同：0
> 
> 时间：2009-05-18T16:12:42.280
> 
> 标签：serial-port, boost-asio

我想使用`boost::asio::serial_port::set_option`函数禁用 RTSControl。并且还可以提高或降低`DTR`线？

```
boost::asio::serial_port_base::baud_rate baud_option(115200);       
serialPort.set_option(baud_option); 
```

标准选项很好用，但我不知道如何改变 `DCB`结构，或者如何控制 RS232 信号线。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T16:58:27.133

[可设置的串口选项要求](http://www.boost.org/doc/libs/1_39_0/doc/html/boost_asio/reference/SettableSerialPortOption.html)（强调我的）：

> 下表中，X表示串口选项类，a表示X的值，ec表示error_code类型的值，s表示实现定义类型storage的值（其中storage是**Windows**和termios上的DCB类型在 POSIX 平台上），并且 u 表示标识符。

# security - 没有 SSL 证书？

> ID：878520
> 
> 赞同：5
> 
> 时间：2009-05-18T16:16:24.940
> 
> 标签：security, ssl, https

我正在为当地教会开发一个小型网站。该站点需要允许管理员编辑内容并发布新事件/更新。该站点管理的唯一“安全”信息将是管理员的登录信息以及带有电话号码和地址的教堂目录。

如果我不使用 SSL 并且只让用户使用直接 HTTP 登录，我会有多大的风险？通常我什至不会考虑这个，但这是一个小教堂，他们需要尽可能地省钱。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T16:27:14.637

由于只有您的管理员会使用安全会话，因此只需使用自签名证书。这不是最好的用户体验，但最好保护这些信息的安全。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T16:56:21.740

使用带有免费证书的 HTTPS。[StartCom](http://cert.startcom.org/)是免费的，并且包含在 Firefox 浏览器中；由于只有您的管理员会登录，因此如果他们想使用 IE，他们可以轻松导入 CA。

不要吝啬安全。有趣的是，我看到听起来与您的网站相似的网站只是为了好玩而被污损。这是值得努力避免的事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T16:22:10.903

好吧，如果您不使用 SSL，那么试图嗅探您的密码的人总是面临更高的风险。您可能只需要评估您网站的风险因素。

另请记住，即使使用 SSL 也不能保证您的数据是安全的。真正重要的是您如何对其进行编码，以确保为您的网站提供额外的保护。

我建议使用单向密码加密算法并以这种方式进行验证。

此外，您可以获得非常便宜的 SSL 证书，我之前使用过 Geotrust 并获得了 250.00 的认证。我相信那里有更便宜的。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T16:25:01.957

在您描述的场景中，普通用户将面临会话劫持，并且他们的所有信息也将“以明文形式”传输。除非您使用受信任的 CA，否则管理员可能会受到中间人攻击。

您可能需要考虑使用来自[CAcert](http://www.cacert.org/)的证书并在管理员的浏览器中安装其根证书，而不是自签名证书。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T16:18:06.653

普通 HTTP 很容易被嗅探。如果您不想购买 SSL 证书，您可以使用自签名证书并要求您的客户信任该证书以规避浏览器显示的警告（因为您的经过身份验证的用户只是少数已知的管理员，这种方法非常完美感觉）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T16:31:33.817

实际上，用于访问网站的其中一台计算机被键盘记录器破坏的可能性比 HTTP 连接被嗅探的可能性要大得多。

# java - NullPointerException 使用 ImageIO.read

> ID：878521
> 
> 赞同：1
> 
> 时间：2009-05-18T16:16:49.540
> 
> 标签：java, nullpointerexception, javax.imageio

我在尝试读取图像文件时遇到了 NPE，我终生无法弄清楚原因。这是我的台词：

```
BufferedImage source = ImageIO.read(new File(imgPath)); 
```

imgPath 基本上保证是有效的，并且在它到达这里之前它会从服务器复制文件。当它到达那条线时，我得到了这个堆栈跟踪：

```
Exception in thread "Thread-26" java.lang.NullPointerException
    at com.ctreber.aclib.image.ico.ICOReader.getICOEntry(ICOReader.java:120)
    at com.ctreber.aclib.image.ico.ICOReader.read(ICOReader.java:89)
    at javax.imageio.ImageIO.read(ImageIO.java:1400)
    at javax.imageio.ImageIO.read(ImageIO.java:1286)
    at PrintServer.resizeImage(PrintServer.java:981)    <---My function
    <Stack of rest of my application here> 
```

此外，这被扔到我的输出窗口中：

无法创建 ICOFile：无法读取字节：2

我不知道发生了什么，特别是因为 File 构造函数成功了。我似乎找不到任何有类似问题的人。有人有什么想法吗？（如果这有什么不同的话，Java 5）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T17:02:07.750

我又摸索了一些，发现您可以指定 ImageReader ImageIO 将使用哪个并以这种方式读取它。我浏览了我们的代码库，发现我们已经有了一个功能，可以完全按照我在这里想要完成的工作。对于遇到类似问题的其他人，这里是代码的症结所在（上面定义了一些废话，但这应该有助于任何尝试这样做的人）：

```
File imageFile = new File(filename);
Iterator<ImageReader> imageReaders = ImageIO.getImageReadersByFormatName("jpeg");
if ( imageReaders.hasNext() ) {
    imageReader = (ImageReader)imageReaders.next();
    stream = ImageIO.createImageInputStream(imageFile);
    imageReader.setInput(stream, true);
    ImageReadParam param = imageReader.getDefaultReadParam();
    curImage = imageReader.read(0, param);
} 
```

感谢大家的建议和帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T16:27:54.213

File 构造函数几乎肯定会成功，*无论它是否指向有效/现有的文件*。至少，我会通过该`exists()`方法检查您的基础文件是否存在。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T10:13:41.900

另请注意，这`ImageIO.read`不是线程安全的（它重用缓存`ImageReader`的不是线程安全的）。

这意味着您不能轻松地并行读取多个文件。为此，您必须`ImageReader`自己处理 s。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T16:21:57.753

您是否考虑过文件可能只是损坏了，或者 ImageIO 试图将其作为错误类型的文件读取？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T16:39:56.530

谷歌搜索 ICOReader 类会得到一击：[`IconsFactory`](http://www.java2s.com/Open-Source/Java-Document/Swing-Library/jide-common/com/jidesoft/icons/IconsFactory.java.htm)来自[jide-common](https://jide-oss.dev.java.net/)。
显然他们有同样的问题：

```
// Using ImageIO approach results in exception like this.
//    Exception in thread "main" java.lang.NullPointerException
//            at com.ctreber.aclib.image.ico.ICOReader.getICOEntry(ICOReader.java:120)
//            at com.ctreber.aclib.image.ico.ICOReader.read(ICOReader.java:89)
//            at javax.imageio.ImageIO.read(ImageIO.java:1400)
//            at javax.imageio.ImageIO.read(ImageIO.java:1322)
//            at com.jidesoft.icons.IconsFactory.b(Unknown Source)
//            at com.jidesoft.icons.IconsFactory.a(Unknown Source)
//            at com.jidesoft.icons.IconsFactory.getImageIcon(Unknown Source)
//            at com.jidesoft.plaf.vsnet.VsnetMetalUtils.initComponentDefaults(Unknown Source)

//    private static ImageIcon createImageIconWithException(final Class<?> baseClass, final String file) throws IOException {
//        try {
//            InputStream resource =
//                    baseClass.getResourceAsStream(file);
//            if (resource == null) {
//                throw new IOException("File " + file + " not found");
//            }
//            BufferedInputStream in =
//                    new BufferedInputStream(resource);
//            return new ImageIcon(ImageIO.read(in));
//        }
//        catch (IOException ioe) {
//            throw ioe;
//        }
//    } 
```

他们做了什么？

```
private static ImageIcon createImageIconWithException(
        final Class<?> baseClass, final String file)
        throws IOException {
    InputStream resource = baseClass.getResourceAsStream(file);

    final byte[][] buffer = new byte[1][];
    try {
        if (resource == null) {
            throw new IOException("File " + file + " not found");
        }
        BufferedInputStream in = new BufferedInputStream(resource);
        ByteArrayOutputStream out = new ByteArrayOutputStream(1024);

        buffer[0] = new byte[1024];
        int n;
        while ((n = in.read(buffer[0])) > 0) {

            out.write(buffer[0], 0, n);
        }
        in.close();
        out.flush();
        buffer[0] = out.toByteArray();
    } catch (IOException ioe) {
        throw ioe;
    }

    if (buffer[0] == null) {
        throw new IOException(baseClass.getName() + "/" + file
                + " not found.");
    }
    if (buffer[0].length == 0) {
        throw new IOException("Warning: " + file
                + " is zero-length");
    }

    return new ImageIcon(Toolkit.getDefaultToolkit().createImage(
            buffer[0]));
} 
```

因此，您可能想尝试相同的方法：读取原始字节并使用`Toolkit`它们创建图像。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T16:57:26.527

> “这是一个 jpeg，但没有 jpeg 扩展名。”

可能就是这样。

看来[AC.lib-ICO](http://www.acproductions.de/commercial/aclibico/index.html)库正在抛出 NPE。由于此库旨在读取 Microsoft ICO 文件格式，因此 JPEG 可能是它的问题。

考虑使用[替代方法](http://java.sun.com/javase/6/docs/api/javax/imageio/ImageIO.html#getImageReadersByFormatName(java.lang.String))显式提供格式。

# xml - 在 VB.NET 中读取 XML 标记信息

> ID：878523
> 
> 赞同：1
> 
> 时间：2009-05-18T16:16:55.033
> 
> 标签：xml, vb.net, infopath

# 一种可能的*（工作）*解决方案：

```
Private Sub ReadXMLAttributes(ByVal oXML As String)
    ReadXMLAttributes(oXML, "mso-infoPathSolution")
End Sub
Private Sub ReadXMLAttributes(ByVal oXML As String, ByVal oTagName As String)
    Try
        Dim XmlDoc As New Xml.XmlDocument
        XmlDoc.LoadXml(oXML)
        oFileInfo = New InfoPathDocument
        Dim XmlNodes As Xml.XmlNodeList = XmlDoc.GetElementsByTagName(oTagName)
        For Each xNode As Xml.XmlNode In XmlNodes
            With xNode
                oFileInfo.SolutionVersion = .Attributes(InfoPathSolution.solutionVersion).Value
                oFileInfo.ProductVersion = .Attributes(InfoPathSolution.productVersion).Value
                oFileInfo.PIVersion = .Attributes(InfoPathSolution.PIVersion).Value
                oFileInfo.href = .Attributes(InfoPathSolution.href).Value
                oFileInfo.name = .Attributes(InfoPathSolution.name).Value
            End With
        Next
    Catch ex As Exception
        MsgBox(ex.Message, MsgBoxStyle.OkOnly, "ReadXMLAttributes")
    End Try
End Sub 
```

这可行，但如果重新排序属性，它仍然会遇到以下问题。我能想到的避免这个问题的唯一方法是将属性名称硬编码到我的程序中，并让它通过遍历解析的标签并搜索指定的标签来处理条目。

注意：InfoPathDocument 是我制作的自定义类，并不复杂：

```
Public Class InfoPathDocument
    Private _sVersion As String
    Private _pVersion As String
    Private _piVersion As String
    Private _href As String
    Private _name As String
    Public Property SolutionVersion() As String
        Get
            Return _sVersion
        End Get
        Set(ByVal value As String)
            _sVersion = value
        End Set
    End Property
    Public Property ProductVersion() As String
        Get
            Return _pVersion
        End Get
        Set(ByVal value As String)
            _pVersion = value
        End Set
    End Property
    Public Property PIVersion() As String
        Get
            Return _piVersion
        End Get
        Set(ByVal value As String)
            _piVersion = value
        End Set
    End Property
    Public Property href() As String
        Get
            Return _href
        End Get
        Set(ByVal value As String)
            If value.ToLower.StartsWith("file:///") Then
                value = value.Substring(8)
            End If
            _href = Form1.PathToUNC(URLDecode(value))
        End Set
    End Property
    Public Property name() As String
        Get
            Return _name
        End Get
        Set(ByVal value As String)
            _name = value
        End Set
    End Property
    Sub New()

    End Sub
    Sub New(ByVal oSolutionVersion As String, ByVal oProductVersion As String, ByVal oPIVersion As String, ByVal oHref As String, ByVal oName As String)
        SolutionVersion = oSolutionVersion
        ProductVersion = oProductVersion
        PIVersion = oPIVersion
        href = oHref
        name = oName
    End Sub
    Public Function URLDecode(ByVal StringToDecode As String) As String
        Dim TempAns As String = String.Empty
        Dim CurChr As Integer = 1
        Dim oRet As String = String.Empty
        Try
            Do Until CurChr - 1 = Len(StringToDecode)
                Select Case Mid(StringToDecode, CurChr, 1)
                    Case "+"
                        oRet &= " "
                    Case "%"
                        oRet &= Chr(Val("&h" & Mid(StringToDecode, CurChr + 1, 2)))
                        CurChr = CurChr + 2
                    Case Else
                        oRet &= Mid(StringToDecode, CurChr, 1)
                End Select
                CurChr += 1
            Loop
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.OkOnly, "URLDecode")
        End Try
        Return oRet
    End Function
End Class 
```

# 原始问题

我正在处理一个需要读取 XML 文档的项目，尤其是来自 Microsoft InfoPath 的已保存表单。

以下是我将使用的一个简单示例以及一些可能有用的背景信息：

```
<?xml version="1.0" encoding="UTF-8"?>
<?mso-infoPathSolution solutionVersion="1.0.0.2" productVersion="12.0.0" PIVersion="1.0.0.0" href="file:///C:\Users\darren\Desktop\simple_form.xsn" name="urn:schemas-microsoft-com:office:infopath:simple-form:-myXSD-2009-05-15T14-16-37" ?>
<?mso-application progid="InfoPath.Document" versionProgid="InfoPath.Document.2"?>
<my:myFields xmlns:my="http://schemas.microsoft.com/office/infopath/2003/myXSD/2009-05-15T14:16:37" xml:lang="en-us">
    <my:first_name>John</my:first_name>
    <my:last_name>Doe</my:last_name>
</my:myFields> 
```

我现在的目标是提取表单的版本 ID 和位置。使用正则表达式很容易：

```
Dim _doc As New XmlDocument
_doc.Load(_thefile)
Dim oRegex As String = "^solutionVersion=""(?<sVersion>[0-9.]*)"" productVersion=""(?<pVersion>[0-9.]*)"" PIVersion=""(?<piVersion>[0-9.]*)"" href=""(?<href>.*)"" name=""(?<name>.*)""$"
Dim rx As New Regex(oRegex), m As Match = Nothing
For Each section As XmlNode In _doc.ChildNodes
    m = rx.Match(section.InnerText.Trim)
    If m.Success Then
        Dim temp As String = m.Groups("name").Value.Substring(m.Groups("name").Value.ToLower.IndexOf("infopath") + ("infopath").Length + 1)
        fileName = temp.Substring(0, temp.LastIndexOf(":"))
        fileVersion = m.Groups("sVersion").Value
    End If
Next 
```

这个工作解决方案带来的唯一问题是，如果 InfoPath 文档标题中的架构发生变化……例如解决方案版本和产品版本属性交换位置（微软似乎喜欢这样做）。

所以我选择尝试使用VB.NET的XML解析能力来帮助我实现上述结果，无正则表达式。

`ChildNode`来自包含我需要的信息的对象`_doc`，但是它没有任何子节点：

```
_doc.ChildNode(1).HasChildNodes = False 
```

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T19:25:54.887

处理指令是 XML 文档的一部分，但它们的属性不会被解析。试试这个代码：

```
// Load the original xml...
var xml = new XmlDocument();
xml.Load( _thefile );

// Select out the processing instruction...
var infopathProcessingInstruction = xml.SelectSingleNode( "/processing-instruction()[local-name(.) = \"mso-infoPathSolution\"]" );

// Since the processing instruction does not expose it's attributes, create a new XML document...
var xmlInfoPath = new XmlDocument();
xmlInfoPath.LoadXml("<data " + infopathProcessingInstruction.InnerText + " />");

// Get the data...
var solutionVersion = xmlInfoPath.DocumentElement.GetAttribute("solutionVersion");
var productVersion  = xmlInfoPath.DocumentElement.GetAttribute("productVersion"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:51:08.007

问题是您要解析的标签实际上并不是 XML 文档的一部分。它们是包含处理指令的 XML-Prolog。因此它们不会在 XmlDocument 中作为元素提供。

我唯一的想法是（除了查看文档如何访问这些元素之外）在剥离 <? ?> 将它们替换为 < />。然后，您可以访问这些属性，而不管它们的顺序如何。

# css - 我在这个共享点母版页中的样式做错了什么？

> ID：878534
> 
> 赞同：1
> 
> 时间：2009-05-18T16:19:49.567
> 
> 标签：css, sharepoint

这是代码示例

```
 <div class="Layouts">
            <asp:ContentPlaceHolder ID="Center" runat="server" />
            <asp:ContentPlaceHolder ID="PlaceHolderMain" runat="server" /> 
            <p>&nbsp;</p>
</div> 
```

布局 div 样式的 CSS 是

```
.Layouts
{
    background-color: White;
    margin-top: 17px;    
    padding-top: 18px;
} 
```

没有什么可疯狂的！我遇到的问题是，如果没有“ `<p>&nbsp;</p>`”，白色背景不会填满我放入两个 ContentPlaceHolders 的任何内容（不，他们没有过度骑行的背景！）

`<p>&nbsp;</p>`一切都如我所愿......但不是我所期望的！

我做错了什么还是浏览器或 Sharepoint 问题？有没有比空间更好的解决方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T16:22:57.640

是`ContentPlaceHolder`浮动的吗？

如果是这样，请尝试将：添加`overflow:hidden;`到`.Layouts`选择器。

# asp.net - 将盐存储在代码中而不是数据库中

> ID：878538
> 
> 赞同：7
> 
> 时间：2009-05-18T16:20:40.813
> 
> 标签：asp.net, security, cryptography, salt

关于 salt 最佳实践已经有过[几次](https://stackoverflow.com/questions/674904/salting-your-password-best-practices)[精彩的](https://stackoverflow.com/questions/536584/non-random-salt-for-password-hashes)讨论，似乎压倒性的建议是为每个密码生成不同的 salt，并将其与密码一起存储在数据库中。

但是，如果我正确理解了 salt 的用途，它是为了减少您受到彩虹表攻击的可能性。所以，我知道通过将它存储在数据库中，为每个用户更改它是最佳的，但是如果盐离数据库不远怎么办？如果我在代码中存储一个盐值（在 Web 服务器上将在已编译的 dll 中），那么如果攻击者以某种方式获得对数据库的访问权限，这难道不是同样的目的吗？在我看来，这会更安全。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-18T16:24:21.633

盐的价值在于它对每个用户都是不同的。当您重新创建散列值以进行比较时，您还需要能够检索此非唯一值。

如果您为每个密码存储一个盐值，那么您首先会大大降低使用盐的价值。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-05-18T16:28:19.097

盐的目的是要求每个密码重新生成彩虹表。如果您使用单一的盐，黑客/破解者只需重新生成彩虹表一次，并且他拥有您所有的密码。但是，如果您为每个用户生成一个随机的，他必须为每个用户生成一个。黑客部分要贵得多。这就是为什么您可以以纯文本形式存储盐的原因，只要有多个盐，黑客是否知道它并不重要。

默默无闻的安全性并不好，微软已经教会了我们这一点。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-18T16:23:53.333

...直到攻击者获得对 DLL 的访问权限。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-05-19T09:09:36.923

除了其他答案之外，还值得注意的是，攻击者可以像找出密码一样找出你的盐：给定一个已知的密码（他自己的），他可以对可能的盐进行暴力攻击。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T17:18:40.260

我从盐中学到的教训是：分而治之（安全）

# routing - 根据域名将传入请求路由到特定服务器

> ID：878541
> 
> 赞同：1
> 
> 时间：2009-05-18T16:21:31.653
> 
> 标签：routing, dns

现在我有防火墙（安装了 iptables、Apache、Squid、DNS）和防火墙后面的应用程序服务器。

防火墙端口 443 (HTTPS) 上的传入流量被重定向到应用程序。由 iptables 提供的服务器。所以基本上，防火墙上的 Apache 和其他应用程序都没有看到 HTTPS 流量。我直接从防火墙提供了一些 Web 内容——它通过 80 到达 Apache。

现在我想添加一些额外的服务器并在它们上安装其他 Web 服务。

如何配置防火墙计算机以根据域名将传入流量路由到所需的主机？

**常见的做法、技术和工具是什么？**

在当前设置中，我拥有的所有域都将转到同一服务器，无论它们的名称如何，如果它们通过端口 443 来。所以我希望例如 foo.com 转到 server1 和 bar.com 由 server2 提供服务；与港口无关。

非常感谢你！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T16:30:02.430

您将需要更多的 IP 地址。

HTTPS 的问题是证书（包含域名）在客户端发送 Host: 标头之前发送，其中包含请求的域名。

如果您有[https://foo.com](https://foo.com)和[https://bar.com](https://bar.com)，并且 foo.com 和 bar.com 在同一个 IP 上，那么浏览到 bar.com 将获得 foo.com 证书并失败并显示证书验证错误。

一旦防火墙上有多个 IP 地址，就可以直接将每个 IP 地址路由到不同的服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:33:51.863

我最近实际上正在研究同样的事情。使用 mod_proxy 将 Apache 设置为其他服务器的反向代理是我见过的更好的选择之一。我很好奇其他人会想出什么。

正如 pjc50 所提到的，这不适用于 HTTPS 上的多个域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-16T14:27:59.993

您在 DNS 服务器上使用 SRV 记录。

例如：

子域 TTL 数据（优先级第一）

server1.domain.com : 3600 : 10 10 1337 domain.com

这会将域 server1.domain.com 上的所有传入流量映射到 domain.com 上的端口 1337

就这么简单。

# java - 获取 JPopupMenu 的位置

> ID：878542
> 
> 赞同：6
> 
> 时间：2009-05-18T16:21:55.973
> 
> 标签：java, user-interface, swing, usability

我很难获得**`JPopupMenu`职位**。

我需要的是能够右键单击工作区，单击某个
菜单项，然后在先前显示的菜单的位置下方**就地创建一个元素。**

我尝试获取菜单本身及其项目的位置，
但它给了我大约 0的**常量值。** *（请参阅代码中的注释）*

由于**关注点分离**，菜单显示在一个类中
，而其操作在另一个类中处理。

```
public final class MainFrameMenu
    extends JPopupMenu
    implements ActionListener {

  private final MainFrame mainFrame;
  private final JMenuItem item1 = new JMenuItem("add line");
  private final JMenuItem item2 = new JMenuItem("add element");

  public MainFrameMenu(MainFrame mainFrame) {
    super("Main menu");
    this.mainFrame = mainFrame;

    item1.addActionListener(this);
    item2.addActionListener(this);

    add(item1);
    add(item2);
  }

  @Override
  public void actionPerformed(ActionEvent e) {
    if (e.getSource() == item1) {
      System.out.println(getLocation()); // gives ALWAYS [0, 0]
      System.out.println(item1.getLocation()); // gives ALWAYS [1, 3]

      // I want to create an element IN PLACE
      mainFrame.addConnectionLine(getX(), getY());
    }
  }

}

public final class PopupMouseListener
    extends MouseAdapter {

  private final JPopupMenu menu;

  public PopupMouseListener(JPopupMenu menu) {
    this.menu = menu;
  }

  @Override
  public void mousePressed(MouseEvent e) {
    popup(e);
  }

  @Override
  public void mouseReleased(MouseEvent e) {
    popup(e);
  }

  private void popup(MouseEvent e) {
    if (e.isPopupTrigger()) {
      menu.show(e.getComponent(), e.getX(), e.getY());
    }
  }

} 
```

我知道我可以将**最后一个已知位置**存储在 中，并从**MainFrameMenu****`PopupMouseListener`**读取它，但它会破坏类层次结构（大多数其他情况不需要它）。****`PopupMouseListener`****

 *** * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T16:34:12.050

getLocation() 返回相对于父组件坐标空间的位置。这就是为什么 item1.getLocation() 总是返回相同的值，因为它总是在相对于弹出菜单的相同位置。

从阅读 Javadoc 听起来，调用 mainFrame.getMousePosition() 可以返回您正在寻找的点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-23T17:53:42.997

旧线程，但我最近遇到了这个问题。这里的问题是，在 ActionPerformed 调用期间，PopupMenu 的可见性已经设置为 false，这意味着它的位置不再定义（即 (0,0)）。我正在开发一个无鼠标界面，所以我不可能抓住鼠标的位置。每次菜单可见时，我最终都会存储菜单的位置，并使用它来创建我的组件。

# css - 使用 CSS 与图像并排的项目

> ID：878546
> 
> 赞同：3
> 
> 时间：2009-05-18T16:22:36.753
> 
> 标签：css

我正在尝试仅使用 css 并排显示图像。问题是图像不是内联显示，而是作为列表显示（我正在使用`<ul>`标签来完成此操作）。也许我使用了错误类型的标签或者我的 css 是错误的（见下文）：

```
ul {
    float: left;
    width: 15em; /* width is changed */
    margin: 0;
    padding: 0;
    list-style-type: none;
    list-style-position: outside;
}
li {
    float: left;
    width: 100%;
    margin: 20%;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T16:27:13.763

尝试这个：

```
ul.gallery {
   height:425px;
   width:200px;
   list-style-type: none;
}
ul.gallery li {
   border:1px solid #BBBBBB;
   float:right;
   height:50px;
   margin-right:7px;
   margin-top:7px;
   width:50px;
} 
```

和 (x)html

```
<ul class="gallery">
    <li><img src="images/0001.jpg" /></li> 
    <li><img src="images/0001.jpg" /></li> 
    <li><img src="images/0001.jpg" /></li> 
    <li><img src="images/0001.jpg" /></li> 
    <li><img src="images/0001.jpg" /></li> 
    <li><img src="images/0001.jpg" /></li> 
    <li><img src="images/0001.jpg" /></li> 
    <li><img src="images/0001.jpg" /></li> 
    <li><img src="images/0001.jpg" /></li>
</ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:26:38.600

为什么不使用 span 标签而不是 ul/li？使用列表标签可能是您获得列表的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T16:26:59.223

你想这样做吗？

```
ul
 li  img 1 /li
 li  img 2 /li
/ul 
```

如果是这样，您的 css 应该在 li 元素上

```
li { display:block float:left padding: 0 margin: 0} 
ul { padding:0 margin 0;} 
```

# opengl - 在已经使用 OpenGL 的程序中进行 OpenGL 编程？

> ID：878553
> 
> 赞同：0
> 
> 时间：2009-05-18T16:24:27.030
> 
> 标签：opengl

鉴于我正在另一个已经使用 OpenGL 的程序中进行编程（假设理论上我不知道他们是如何使用它的）。

我可以根据需要设置我的上下文并将其从堆栈中推送/弹出，并且所有内容都应该按预期工作，还是我必须知道我的（调用）程序如何使用 OpenGL 以避免意外搞砸？

另外，当它可能已经被初始化时，我将如何去“初始化”OpenGL？

感谢您提供的任何建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T20:29:47.597

有人告诉我，只要您事后恢复先前的上下文，理论上 OpenGL 应该能够在任何上下文中工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T21:21:20.987

要回答您的第一个问题，您可能可以在调用程序函数之前调用 glPushAttrib(GL_ALL_ATTRIB_BITS) 并在之后调用 glPopAtrib() 。请注意，如果您经常这样做（例如，循环中的每一帧），这可能会很慢。

我不确定初始化OpenGL是什么意思。你的意思是设置渲染上下文？设置视口和投影？禁用或启用某些功能？您始终可以检查是否启用了某些状态（使用 glGet 函数），但其余的取决于您的程序和其他程序的工作方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-07-01T00:10:21.557

你到底想用 OpenGL 做什么？你想画到同一个窗口吗？你想画到你自己的窗口吗？如果您只想在自己的窗口中绘图，而现有应用程序使用 OpenGL 的事实只是巧合，那么您可能只需创建一个全新的上下文并忽略现有内容即可。唯一的问题是，当你完成你正在做的事情时，你需要使现有的上下文成为最新的，并在你想用它做某事时使你的上下文成为最新的。现有代码不会期望需要将其自己的上下文设为最新，如果您不小心，可能会随机绘制到您的上下文中。

如果你想在现有的窗口中绘图，那么你的使用几乎肯定需要对现有的东西在做什么有所了解。

# git - 为什么我有时会看到“条目‘文件名’不是最新的。无法合并。” 在“git reset --hard”和“git pull”之后？

> ID：878554
> 
> 赞同：23
> 
> 时间：2009-05-18T16:24:31.880
> 
> 标签：git, merge, reset, pull

有时，当我执行以下操作时...

```
git reset --hard
HEAD is now at 0123abde comment is here
```

```
git pull
Updating 0123abde..456789fa
```

我得到错误...

```
error: Entry 'filename' not uptodate. Cannot merge.
```

我发现的唯一解决方法是“git reset --hard”，删除有问题的文件，然后执行“git pull”。这对我来说似乎不对。硬重置不应该删除任何和所有本地更改，从而允许我在没有任何合并问题的情况下提取最新的吗？我使用 git 错了吗？:)

这是在 CI 机器上，所以这里的任何更改都是不需要的。我在 Windows Vista 上使用 git 版本 1.6.1.9.g97c34。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2018-12-20T14:18:32.340

我发现这个问题最简单的解决方案是：

```
git add .
git merge --abort 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2016-10-26T17:32:51.087

我遇到了同样的问题，我重命名了导致此问题的文件并执行了 git pull。它提取了那个丢失的文件并解决了这个问题。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-05-18T17:04:31.037

“”背后的总体思路[`Entry 'filename' not uptodate. Cannot merge.`](http://git.or.cz/gitwiki/GitFaq#head-a188936efde5885e0ff8540c5be897e8029047f7)是：

> 如果要继续签出和更改到新分支，您对工作目录中的文件所做的更改将被覆盖、删除或以其他方式丢失。

据[报道](http://kerneltrap.org/mailarchive/git/2008/12/14/4415044)，此消息有时可能是“虚假的”（可能是因为“ `git pull`”在尝试合并之前[没有刷新索引），但修复是在 Git1.6.1 中。](http://kerneltrap.org/mailarchive/git/2008/8/20/3014674/thread)
但是，它可能仍然存在于 mSysGit 1.6.1 中，那么您是否看到与更新的 mSysGit 版本相同的错误？（如 1.6.3）

* * *

在 Git 2.30.1（2021 年第一季度）之前，“ [`git stash`](https://github.com/git/git/blob/62fb47a4d3a93d97f4ed82323425135ecd3b84f5/Documentation/git-stash.txt)” ^(（[man](https://git-scm.com/docs/git-stash)）)在稀疏签出的工作树中效果不佳。

请参阅[Elijah Newren ( ) 的](https://github.com/newren)[提交 ba359fd](https://github.com/git/git/commit/ba359fd5070c189f07990c487dc916908830488a)、[提交 b34ab4a](https://github.com/git/git/commit/b34ab4a43ba68dd4bba66d765368a37d99890ab2)、[提交 a31e48d](https://github.com/git/git/commit/a31e48d39429415d2afa35f2c8421482e06a0677)（2020 年 12 月 1 日[）](https://github.com/newren)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([62fb47a 提交中](https://github.com/git/git/commit/62fb47a4d3a93d97f4ed82323425135ecd3b84f5))^(，2021 年 1 月 15 日）)[`newren`](https://github.com/newren)
^([`gitster`](https://github.com/gitster))

> ## [`t7012`](https://github.com/git/git/commit/a31e48d39429415d2afa35f2c8421482e06a0677)：添加一个测试用例，演示在稀疏结帐中隐藏应用错误
> 
> ^(签字人：以利亚·纽伦)

> 在稀疏结帐中应用存储，特别是当用于定义稀疏性的模式在创建存储和应用存储之间发生变化时，会有许多错误。
> 
> 主要问题是有时仅部分应用了存储。
> 
> 在大多数此类情况下，它会默默地执行此操作，而不会显示任何警告或错误，并且退出状态为 0。
> 
> 但是，在少数情况下会显示未翻译的错误消息并且存储应用程序会提前中止。
> 
> 第一种是尽管设置了位，但仍有文件存在`SKIP_WORKTREE`，在这种情况下，显示的错误消息是：
> 
> ```
> error: Entry 'PATHNAME' not uptodate. Cannot merge. 
> ```
> 
> 另一种情况是当存储包含要添加到工作树的新文件时；在这种情况下，代码提前中止但仍部分应用了存储，并显示以下错误消息：
> 
> ```
> error: NEWFILE: does not exist and --remove not passed
> fatal: Unable to process path NEWFILE 
> ```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2019-11-25T06:24:42.687

这也可能由于使用`--skip-worktree`or命令而发生，`--assume-unchanged`并且 git 阻止您执行：`checkout`、或.`merge``rebase``pull`

如果我们采用以下方法，跳过的文件/目录可能不起作用：

*   `git stash`
*   `git merge --abort`, &
*   `git rm --cached`这也不适用于`skipped`该命令将抛出的文件：`fatal: pathspec [file] did not match any files`而是

[在此处](https://stackoverflow.com/a/49069203/3763032)检查`skipped`文件的解决方案

```
$: git update-index --really-refresh
<file>: needs update 
```

如果要删除`skipped`本地目录或未跟踪的目录/文件，则可选

```
$: git reset --hard 
```

如果上述命令都不能解决问题，您只需从`skipped`树中撤消文件，例如：

```
$: git update-index --no-skip-worktree [file] 
```

如果您`skipped`是目录，请转到[此处](https://stackoverflow.com/a/55860969/3763032)详细了解如何递归地跳过/撤消，例如：

```
find . -maxdepth 1 -type d \( ! -name . \) -exec bash -c "cd '{}' && pwd && git ls-files -z ${pwd} | xargs -0 git update-index --skip-worktree" \; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-11-30T14:59:38.337

我在尝试跑步时遇到了同样的问题

```
git merge --abort 
```

为了让它发挥作用，我进行了我不想要的更改。一旦我这样做了，git就能够成功地撤消它们。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-06-25T19:15:12.913

在使用假设未更改的索引中删除文件然后尝试签出另一个分支后，可能会发生此错误。例如，

```
git checkout master 
```

乃至

```
git checkout -f master 
```

结果错误：

```
error: Entry 'gradle/apk.gradle' not uptodate. Cannot merge. 
```

解决方案是将文件返回到索引：

```
git update-index --no-assume-unchanged gradle/apk.gradle 
```

然后，您最终可以进行正常结帐。

# objective-c - Xcode 不会将 IB 插件构建到资源文件夹中

> ID：878566
> 
> 赞同：1
> 
> 时间：2009-05-18T16:27:18.473
> 
> 标签：objective-c, xcode, interface-builder

我使用 IB3 插件模板为它创建了一个自定义控件和一个框架/IB 插件。

根据文档，插件应该直接构建到框架的资源目录中。当我构建我的项目时，插件与框架一起位于配置文件夹（调试）中。

这与我创建新模板时开箱即用的行为相同。我试图改变它`CONFIGURATION_BUILD_DIR`，`$(BUILD_DIR)/$(CONFIGURATION)/FrameworkName.framework/Resources/`但没有改变。

对于笑容，我也尝试弄乱安装路径，但也无济于事。我检查了其他几个开源项目以检查它们的构建设置，但它们与我自己的相同，但它们的插件已按预期构建并放入资源目录中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T16:53:23.837

不要乱用构建设置。相反，将“复制文件”构建阶段添加到框架目标。在复制文件构建阶段的检查器中，将目录设置为“资源”。通过从 Xcode 的“组和文件”树中的“产品”组中拖动插件产品，将插件添加到此构建阶段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-20T06:20:09.723

要将一个 Xcode 目标的构建产品包含在另一个 Xcode 目标产品的资源目录中，您应该在组和文件树中找到该产品并将该产品拖到另一个目标的副本“捆绑资源阶段”中。您还应该使用目标的获取信息面板在两个目标之间添加目标依赖项。

如果您在构建产品目录中看到构建插件，这并不意味着它没有被复制到框架的资源目录中。Xcode 将所有目标构建到构建目录中，然后将它们复制（而不是移动）到它们的最终目的地——在本例中是框架的资源目录。一个原因是一个产品可以有多个最终目的地。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T01:01:32.650

谢谢，巴里。当我尝试使用复制文件构建阶段时，IB 无法解析框架和插件之间的连接。由于某种原因，它找不到相关的插件。

然而，在无尽的摆弄之后，我发现自己比我想象的更接近。更改`CONFIGURATION_BUILD_DIR`为：

```
$(BUILD_DIR)/$(CONFIGURATION)$(EFFECTIVE_PLATFORM_NAME)/FrameworkName.framework/Resources/ 
```

并更新框架搜索路径为我解决了这个问题。这不是开箱即用的插件模板（至少在我的机器上）的行为，因此希望这对其他人有所帮助。

# java - Java 是否支持多行字符串？

> ID：878573
> 
> 赞同：571
> 
> 时间：2009-05-18T16:28:47.287
> 
> 标签：java, string, multiline

来自 Perl，我肯定错过了在源代码中创建多行字符串的“here-document”方法：

```
$string = <<"EOF"  # create a three-line string
text
text
text
EOF 
```

在 Java 中，当我从头开始连接我的多行字符串时，我必须在每一行加上繁琐的引号和加号。

有哪些更好的选择？在属性文件中定义我的字符串？

**编辑**：两个答案说 StringBuilder.append() 比加号更可取。谁能详细说明他们为什么这么认为？它看起来一点也不适合我。我正在寻找一种解决方法，即多行字符串不是一流的语言构造，这意味着我绝对不想用方法调用替换一流的语言构造（字符串连接加号）。

**编辑**：为了进一步澄清我的问题，我根本不关心性能。我担心可维护性和设计问题。

* * *

## 回答 #1

> 赞同：535
> 
> 时间：2009-05-18T16:57:04.967

* * *

**注意**：此答案适用于 Java 14 及更早版本。

Java 15 中引入了文本块（多行文字）。有关详细信息，请参阅[此答案](https://stackoverflow.com/a/50155171/466862)。

* * *

听起来你想做一个多行文字，这在 Java 中不存在。

您最好的选择是将字符串`+`组合在一起。人们提到的其他一些选项（StringBuilder、String.format、String.join）只有在您从字符串数组开始时才会更可取。

考虑一下：

```
String s = "It was the best of times, it was the worst of times,\n"
         + "it was the age of wisdom, it was the age of foolishness,\n"
         + "it was the epoch of belief, it was the epoch of incredulity,\n"
         + "it was the season of Light, it was the season of Darkness,\n"
         + "it was the spring of hope, it was the winter of despair,\n"
         + "we had everything before us, we had nothing before us"; 
```

对战`StringBuilder`：

```
String s = new StringBuilder()
           .append("It was the best of times, it was the worst of times,\n")
           .append("it was the age of wisdom, it was the age of foolishness,\n")
           .append("it was the epoch of belief, it was the epoch of incredulity,\n")
           .append("it was the season of Light, it was the season of Darkness,\n")
           .append("it was the spring of hope, it was the winter of despair,\n")
           .append("we had everything before us, we had nothing before us")
           .toString(); 
```

对战`String.format()`：

```
String s = String.format("%s\n%s\n%s\n%s\n%s\n%s"
         , "It was the best of times, it was the worst of times,"
         , "it was the age of wisdom, it was the age of foolishness,"
         , "it was the epoch of belief, it was the epoch of incredulity,"
         , "it was the season of Light, it was the season of Darkness,"
         , "it was the spring of hope, it was the winter of despair,"
         , "we had everything before us, we had nothing before us"
); 
```

与 Java8 相比[`String.join()`](http://docs.oracle.com/javase/8/docs/api/java/lang/String.html#join-java.lang.CharSequence-java.lang.CharSequence...-)：

```
String s = String.join("\n"
         , "It was the best of times, it was the worst of times,"
         , "it was the age of wisdom, it was the age of foolishness,"
         , "it was the epoch of belief, it was the epoch of incredulity,"
         , "it was the season of Light, it was the season of Darkness,"
         , "it was the spring of hope, it was the winter of despair,"
         , "we had everything before us, we had nothing before us"
); 
```

如果您想要特定系统的换行符，您需要使用`System.lineSeparator()`，或者您可以使用`%n`in `String.format`。

另一种选择是将资源放在文本文件中，然后读取该文件的内容。这对于非常大的字符串会更可取，以避免不必要地膨胀您的类文件。

* * *

## 回答 #2

> 赞同：193
> 
> 时间：2011-10-10T17:07:02.957

在 Eclipse 中，如果您打开选项“粘贴到字符串文字时转义文本”（在 Preferences > Java > Editor > Typing 中）并将多行字符串粘贴到引号中，它将自动为您的所有行添加`"`和`\n" +`。

```
String str = "paste your text here"; 
```

* * *

## 回答 #3

> 赞同：123
> 
> 时间：2009-05-18T17:47:24.820

Stephen Colebourne提出了在 Java 7 中添加多行字符串的[提议。](http://blog.joda.org/2008/01/java-7-multi-line-string-literals_594.html)

此外，Groovy 已经支持[多行字符串](http://groovy-lang.org/syntax.html#_triple_single_quoted_string)。

* * *

## 回答 #4

> 赞同：102
> 
> 时间：2012-08-01T07:46:34.133

这是一个旧线程，但一个新的非常优雅的解决方案（只有 4 个或 3 个小缺点）是使用自定义注释。

检查： http: [//www.adrianwalker.org/2011/12/java-multiline-string.html](http://www.adrianwalker.org/2011/12/java-multiline-string.html)

受该工作启发的项目托管在 GitHub 上：

[https://github.com/benelog/multiline](https://github.com/benelog/multiline)

Java代码示例：

```
import org.adrianwalker.multilinestring.Multiline;
...
public final class MultilineStringUsage {

  /**
  <html>
    <head/>
    <body>
      <p>
        Hello<br/>
        Multiline<br/>
        World<br/>
      </p>
    </body>
  </html>
  */
  @Multiline
  private static String html;

  public static void main(final String[] args) {
    System.out.println(html);
  }
} 
```

缺点是

1.  您必须激活相应的（提供的）注释处理器。
2.  该字符串变量不能定义为局部变量检查[原始字符串文字项目](https://github.com/mageddo/mageddo-projects/tree/master/raw-string-literals)，您可以将变量定义为局部变量
3.  该字符串不能包含其他变量，如在 Visual Basic .Net 中使用 XML 文字 ( `<%= variable %>`) :-)
4.  该字符串文字由 JavaDoc 注释 (/**) 分隔

而且您可能必须配置 Eclipse/Intellij-Idea 以不自动重新格式化您的 Javadoc 注释。

有人可能会觉得这很奇怪（Javadoc 注释并非旨在嵌入除注释之外的任何内容），但由于 Java 中缺少多行字符串最终真的很烦人，我发现这是最不糟糕的解决方案。

* * *

## 回答 #5

> 赞同：75
> 
> 时间：2018-05-03T12:31:36.603

[JEP 378: Text Blocks](https://openjdk.java.net/jeps/378)涵盖了此功能，并包含在 JDK 15 中。它最初以[JEP 355: Text Blocks (Preview)](https://openjdk.java.net/jeps/355) in JDK 13 和[JEP 368: Text Blocks (Second Preview)](https://openjdk.java.net/jeps/368)在 JDK 14 中出现，并且可以在这些版本中启用使用`––enable–preview`javac 选项。

语法允许编写如下内容：

```
String s = """
           text
           text
           text
           """; 
```

在此 JEP 之前，在 JDK 12 中，[JEP 326: Raw String Literals](http://openjdk.java.net/jeps/326)旨在实现类似的功能，但最终被撤回：

> *请注意：这原本是 JDK 12 中的[预览语言功能](http://openjdk.java.net/jeps/12)，但它已被撤回并且没有出现在 JDK 12 中。它在 JDK 13 中被文本块 ( [JEP 355 ) 取代。](https://openjdk.java.net/jeps/355)*

* * *

## 回答 #6

> 赞同：65
> 
> 时间：2009-05-18T16:38:29.530

另一种选择可能是将长字符串存储在外部文件中并将文件读入字符串。

* * *

## 回答 #7

> 赞同：60
> 
> 时间：2009-11-03T15:55:30.027

这是你不应该*在*不考虑它在做什么的情况下使用的东西。但是对于一次性脚本，我已经非常成功地使用了它：

例子：

```
 System.out.println(S(/*
This is a CRAZY " ' ' " multiline string with all sorts of strange 
   characters!
*/)); 
```

代码：

```
// From: http://blog.efftinge.de/2008/10/multi-line-string-literals-in-java.html
// Takes a comment (/**/) and turns everything inside the comment to a string that is returned from S()
public static String S() {
    StackTraceElement element = new RuntimeException().getStackTrace()[1];
    String name = element.getClassName().replace('.', '/') + ".java";
    StringBuilder sb = new StringBuilder();
    String line = null;
    InputStream in = classLoader.getResourceAsStream(name);
    String s = convertStreamToString(in, element.getLineNumber());
    return s.substring(s.indexOf("/*")+2, s.indexOf("*/"));
}

// From http://www.kodejava.org/examples/266.html
private static String convertStreamToString(InputStream is, int lineNum) {
    /*
     * To convert the InputStream to String we use the BufferedReader.readLine()
     * method. We iterate until the BufferedReader return null which means
     * there's no more data to read. Each line will appended to a StringBuilder
     * and returned as String.
     */
    BufferedReader reader = new BufferedReader(new InputStreamReader(is));
    StringBuilder sb = new StringBuilder();

    String line = null; int i = 1;
    try {
        while ((line = reader.readLine()) != null) {
            if (i++ >= lineNum) {
                sb.append(line + "\n");
            }
        }
    } catch (IOException e) {
        e.printStackTrace();
    } finally {
        try {
            is.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    return sb.toString();
} 
```

* * *

## 回答 #8

> 赞同：59
> 
> 时间：2014-07-17T12:12:02.807

# `String.join`

Java 8 添加了一个新的静态方法，`java.lang.String`它提供了一个更好的选择：

[`String.join( CharSequence delimiter , CharSequence... elements )`](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#join-java.lang.CharSequence-java.lang.CharSequence...-)

使用它：

```
String s = String.join(
    System.getProperty("line.separator"),
    "First line.",
    "Second line.",
    "The rest.",
    "And the last!"
); 
```

* * *

## 回答 #9

> 赞同：34
> 
> 时间：2020-03-06T08:59:16.657

## Java 13 及更高版本

[Java 现在通过Text Blocks](https://openjdk.java.net/jeps/355)支持多行字符串。在 Java 13 和 14 中，此功能要求您`––enable–preview`在构建和运行项目时设置选项。在 Java 15 及更高版本中，不再需要此选项，因为文本块已成为标准功能。查看官方[的文本块程序员指南](https://docs.oracle.com/en/java/javase/15/text-blocks/index.html)了解更多详细信息。

现在，在 Java 13 之前，这是您编写查询的方式：

```
List<Tuple> posts = entityManager
.createNativeQuery(
    "SELECT *\n" +
    "FROM (\n" +
    "    SELECT *,\n" +
    "           dense_rank() OVER (\n" +
    "               ORDER BY \"p.created_on\", \"p.id\"\n" +
    "           ) rank\n" +
    "    FROM (\n" +
    "        SELECT p.id AS \"p.id\",\n" +
    "               p.created_on AS \"p.created_on\",\n" +
    "               p.title AS \"p.title\",\n" +
    "               pc.id as \"pc.id\",\n" +
    "               pc.created_on AS \"pc.created_on\",\n" +
    "               pc.review AS \"pc.review\",\n" +
    "               pc.post_id AS \"pc.post_id\"\n" +
    "        FROM post p\n" +
    "        LEFT JOIN post_comment pc ON p.id = pc.post_id\n" +
    "        WHERE p.title LIKE :titlePattern\n" +
    "        ORDER BY p.created_on\n" +
    "    ) p_pc\n" +
    ") p_pc_r\n" +
    "WHERE p_pc_r.rank <= :rank\n",
    Tuple.class)
.setParameter("titlePattern", "High-Performance Java Persistence %")
.setParameter("rank", 5)
.getResultList(); 
```

感谢 Java 13 Text Blocks，您可以按如下方式重写此查询：

```
List<Tuple> posts = entityManager
.createNativeQuery("""
    SELECT *
    FROM (
        SELECT *,
               dense_rank() OVER (
                   ORDER BY "p.created_on", "p.id"
               ) rank
        FROM (
            SELECT p.id AS "p.id",
                   p.created_on AS "p.created_on",
                   p.title AS "p.title",
                   pc.id as "pc.id",
                   pc.created_on AS "pc.created_on",
                   pc.review AS "pc.review",
                   pc.post_id AS "pc.post_id"
            FROM post p
            LEFT JOIN post_comment pc ON p.id = pc.post_id
            WHERE p.title LIKE :titlePattern
            ORDER BY p.created_on
        ) p_pc
    ) p_pc_r
    WHERE p_pc_r.rank <= :rank
    """,
    Tuple.class)
.setParameter("titlePattern", "High-Performance Java Persistence %")
.setParameter("rank", 5)
.getResultList(); 
```

更具可读性，对吧？

## IDE 支持

IntelliJ IDEA 支持将传统`String`连接块转换为新的多行`String`格式：

[![IntelliJ IDEA 文本块支持](https://i.stack.imgur.com/IoIRN.png)](https://vladmihalcea.com/multiline-string-java-text-blocks/)

## JSON、HTML、XML

多行在`String`编写 JSON、HTML 或 XML 时特别有用。

考虑这个使用`String`连接构建 JSON 字符串文字的示例：

```
entityManager.persist(
    new Book()
    .setId(1L)
    .setIsbn("978-9730228236")
    .setProperties(
        "{" +
        "   \"title\": \"High-Performance Java Persistence\"," +
        "   \"author\": \"Vlad Mihalcea\"," +
        "   \"publisher\": \"Amazon\"," +
        "   \"price\": 44.99," +
        "   \"reviews\": [" +
        "       {" +
        "           \"reviewer\": \"Cristiano\", " +
        "           \"review\": \"Excellent book to understand Java Persistence\", " +
        "           \"date\": \"2017-11-14\", " +
        "           \"rating\": 5" +
        "       }," +
        "       {" +
        "           \"reviewer\": \"T.W\", " +
        "           \"review\": \"The best JPA ORM book out there\", " +
        "           \"date\": \"2019-01-27\", " +
        "           \"rating\": 5" +
        "       }," +
        "       {" +
        "           \"reviewer\": \"Shaikh\", " +
        "           \"review\": \"The most informative book\", " +
        "           \"date\": \"2016-12-24\", " +
        "           \"rating\": 4" +
        "       }" +
        "   ]" +
        "}"
    )
); 
```

由于转义字符以及大量的双引号和加号，您几乎无法阅读 JSON。

使用 Java 文本块，JSON 对象可以这样编写：

```
entityManager.persist(
    new Book()
    .setId(1L)
    .setIsbn("978-9730228236")
    .setProperties("""
        {
           "title": "High-Performance Java Persistence",
           "author": "Vlad Mihalcea",
           "publisher": "Amazon",
           "price": 44.99,
           "reviews": [
               {
                   "reviewer": "Cristiano",
                   "review": "Excellent book to understand Java Persistence",
                   "date": "2017-11-14",
                   "rating": 5
               },
               {
                   "reviewer": "T.W",
                   "review": "The best JPA ORM book out there",
                   "date": "2019-01-27",
                   "rating": 5
               },
               {
                   "reviewer": "Shaikh",
                   "review": "The most informative book",
                   "date": "2016-12-24",
                   "rating": 4
               }
           ]
        }
        """
    )
); 
```

自从我在 2004 年使用 C# 以来，我一直想在 Java 中拥有这个功能，现在我们终于有了。

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2009-05-18T16:47:43.300

如果您在属性文件中定义字符串，它看起来会更糟。IIRC，它看起来像：

```
string:text\u000atext\u000atext\u000a 
```

一般来说，不将大字符串嵌入到源中是一个合理的想法。您可能希望将它们作为资源加载，可能以 XML 或可读文本格式加载。文本文件既可以在运行时读取，也可以编译成 Java 源代码。如果您最终将它们放在源代码中，我建议将它们放在`+`前面并省略不必要的新行：

```
final String text = ""
    +"text "
    +"text "
    +"text"
; 
```

如果您确实有新行，您可能需要一些连接或格式化方法：

```
final String text = join("\r\n"
    ,"text"
    ,"text"
    ,"text"
); 
```

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2009-05-19T00:37:21.683

加号被转换为 StringBuilder.append，除非两个字符串都是常量，因此编译器可以在编译时将它们组合起来。至少，Sun 的编译器是这样的，我怀疑大多数（如果不是所有）其他编译器都会这样做。

所以：

```
String a="Hello";
String b="Goodbye";
String c=a+b; 
```

通常会生成与以下内容完全相同的代码：

```
String a="Hello";
String b="Goodbye":
StringBuilder temp=new StringBuilder();
temp.append(a).append(b);
String c=temp.toString(); 
```

另一方面：

```
String c="Hello"+"Goodbye"; 
```

是相同的：

```
String c="HelloGoodbye"; 
```

也就是说，为了便于阅读，在多行中使用加号打破字符串文字不会受到任何惩罚。

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2016-10-08T16:28:13.033

在 IntelliJ IDE 中，您只需键入：

```
"" 
```

然后将光标放在引号内并粘贴您的字符串。IDE 会将其扩展为多个连接的行。

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2009-05-18T17:10:10.307

遗憾的是，Java 没有多行字符串文字。您要么必须连接字符串文字（使用 + 或 StringBuilder 是最常见的两种方法），要么从单独的文件中读取字符串。

对于大型多行字符串文字，我倾向于使用单独的文件并使用`getResourceAsStream()`（`Class`类的方法）读取它。这使得查找文件变得容易，因为您不必担心当前目录与代码的安装位置。它还使打包更容易，因为您实际上可以将文件存储在 jar 文件中。

假设你在一个名为 Foo 的类中。只需执行以下操作：

```
Reader r = new InputStreamReader(Foo.class.getResourceAsStream("filename"), "UTF-8");
String s = Utils.readAll(r); 
```

另一个烦恼是Java没有标准的“从这个阅读器中读取所有文本到字符串中”的方法。不过写起来很容易：

```
public static String readAll(Reader input) {
    StringBuilder sb = new StringBuilder();
    char[] buffer = new char[4096];
    int charsRead;
    while ((charsRead = input.read(buffer)) >= 0) {
        sb.append(buffer, 0, charsRead);
    }
    input.close();
    return sb.toString();
} 
```

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2009-05-18T16:34:34.590

```
String newline = System.getProperty ("line.separator");
string1 + newline + string2 + newline + string3 
```

但是，最好的选择是使用[String.format](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html#format(java.lang.String,%20java.lang.Object...))

```
String multilineString = String.format("%s\n%s\n%s\n",line1,line2,line3); 
```

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2010-05-18T05:27:08.727

您可以使用与 java 兼容的 scala-code，并允许使用 """ 括起来的多行字符串：

```
package foobar
object SWrap {
  def bar = """John said: "This is
  a test
  a bloody test,
  my dear." and closed the door.""" 
} 
```

（注意字符串内的引号）和来自java：

```
String s2 = foobar.SWrap.bar (); 
```

这是否更舒服......？

如果您经常处理应该放在源代码中的长文本，另一种方法可能是脚本，它从外部文件中获取文本，并将其包装为 multiline-java-String ，如下所示：

```
sed '1s/^/String s = \"/;2,$s/^/\t+ "/;2,$s/$/"/' file > file.java 
```

这样您就可以轻松地将其剪切并粘贴到您的源代码中。

* * *

## 回答 #16

> 赞同：9
> 
> 时间：2011-02-21T18:22:12.263

由于 Java 不（还）本机支持多行字符串，因此目前唯一的方法是使用上述技术之一绕过它。我使用上面提到的一些技巧构建了以下 Python 脚本：

```
import sys
import string
import os

print 'new String('
for line in sys.stdin:
    one = string.replace(line, '"', '\\"').rstrip(os.linesep)
    print '  + "' + one + ' "'
print ')' 
```

将其放入名为 javastringify.py 的文件中，并将您的字符串放入 mystring.txt 文件中，然后按如下方式运行它：

```
cat mystring.txt | python javastringify.py 
```

然后，您可以复制输出并将其粘贴到您的编辑器中。

根据需要修改它以处理任何特殊情况，但这适合我的需要。希望这可以帮助！

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2009-05-18T16:40:53.143

您可以在单独的方法中连接您的追加，例如：

```
public static String multilineString(String... lines){
   StringBuilder sb = new StringBuilder();
   for(String s : lines){
     sb.append(s);
     sb.append ('\n');
   }
   return sb.toString();
} 
```

无论哪种方式，都更喜欢`StringBuilder`加号。

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2012-01-13T21:52:01.157

请参阅[Java Stringfier](http://stringfier.amterano.net)。如果需要，将您的文本转换为 StringBuilder java 块转义。

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2014-06-03T07:17:16.547

```
 import org.apache.commons.lang3.StringUtils;

    String multiline = StringUtils.join(new String[] {
        "It was the best of times, it was the worst of times ", 
        "it was the age of wisdom, it was the age of foolishness",
        "it was the epoch of belief, it was the epoch of incredulity",
        "it was the season of Light, it was the season of Darkness",
        "it was the spring of hope, it was the winter of despair",
        "we had everything before us, we had nothing before us",
        }, "\n"); 
```

* * *

## 回答 #20

> 赞同：7
> 
> 时间：2014-07-14T01:32:44.633

实际上，以下是迄今为止我见过的最干净的实现。它使用注释将注释转换为字符串变量...

```
/**
  <html>
    <head/>
    <body>
      <p>
        Hello<br/>
        Multiline<br/>
        World<br/>
      </p>
    </body>
  </html>
  */
  @Multiline
  private static String html; 
```

因此，最终结果是变量 html 包含多行字符串。没有引号，没有加号，没有逗号，只有纯字符串。

此解决方案可在以下 URL 获得... [http://www.adrianwalker.org/2011/12/java-multiline-string.html](http://www.adrianwalker.org/2011/12/java-multiline-string.html)

希望有帮助！

* * *

## 回答 #21

> 赞同：6
> 
> 时间：2009-11-03T16:06:24.340

我还没有看到答案的另一种选择是[`java.io.PrintWriter`](http://java.sun.com/javase/6/docs/api/java/io/PrintWriter.html).

```
StringWriter stringWriter = new StringWriter();
PrintWriter writer = new PrintWriter(stringWriter);
writer.println("It was the best of times, it was the worst of times");
writer.println("it was the age of wisdom, it was the age of foolishness,");
writer.println("it was the epoch of belief, it was the epoch of incredulity,");
writer.println("it was the season of Light, it was the season of Darkness,");
writer.println("it was the spring of hope, it was the winter of despair,");
writer.println("we had everything before us, we had nothing before us");
String string = stringWriter.toString(); 
```

[`java.io.BufferedWriter`](http://java.sun.com/javase/6/docs/api/java/io/BufferedWriter.html)也没有提到有`newLine()`方法的事实。

* * *

## 回答 #22

> 赞同：6
> 
> 时间：2019-10-28T21:48:18.863

Java 13 预览：

> *[文本块来到 Java。Java 13 提供了 Mala Gupta 期待已久的多行字符串](https://blogs.oracle.com/javamagazine/text-blocks-come-to-java)*
> 
> 借助文本块，Java 13 使您可以更轻松地处理多行字符串文字。您不再需要转义字符串文字中的特殊字符或对跨越多行的值使用连接运算符。
> 
> 文本块使用三个双引号 (""") 作为开始和结束分隔符来定义。开始分隔符后面可以跟零个或多个空格和一个行终止符。

例子：

```
 String s1 = """
 text
 text
 text
 """; 
```

* * *

## 回答 #23

> 赞同：5
> 
> 时间：2009-05-18T16:47:57.013

一个非常有效且独立于平台的解决方案是使用系统属性作为行分隔符和 StringBuilder 类来构建字符串：

```
String separator = System.getProperty("line.separator");
String[] lines = {"Line 1", "Line 2" /*, ... */};

StringBuilder builder = new StringBuilder(lines[0]);
for (int i = 1; i < lines.length(); i++) {
    builder.append(separator).append(lines[i]);
}
String multiLine = builder.toString(); 
```

* * *

## 回答 #24

> 赞同：5
> 
> 时间：2014-02-15T19:53:49.990

使用`Properties.loadFromXML(InputStream)`. 不需要外部库。

比凌乱的代码更好（因为您关心可维护性和设计），最好不要使用长字符串。

从读取 xml 属性开始：

```
 InputStream fileIS = YourClass.class.getResourceAsStream("MultiLine.xml");
 Properties prop = new Properies();
 prop.loadFromXML(fileIS); 
```

那么您可以以**更易于维护**的方式使用您的多行字符串...

```
static final String UNIQUE_MEANINGFUL_KEY = "Super Duper UNIQUE Key";
prop.getProperty(UNIQUE_MEANINGFUL_KEY) // "\n    MEGA\n   LONG\n..." 
```

MultiLine.xml` 位于同一文件夹 YourClass 中：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">

<properties>
    <entry key="Super Duper UNIQUE Key">
       MEGA
       LONG
       MULTILINE
    </entry>
</properties> 
```

PS.：您可以将`<![CDATA["`...`"]]>`用于类似 xml 的字符串。

* * *

## 回答 #25

> 赞同：5
> 
> 时间：2018-09-21T09:44:06.143

使用[JDK/12 early access build #12](http://jdk.java.net/12/)，现在可以在 Java 中使用多行字符串，如下所示：

```
String multiLine = `First line
    Second line with indentation
Third line
and so on...`; // the formatting as desired
System.out.println(multiLine); 
```

这将导致以下输出：

> ```
> First line
>     Second line with indentation
> Third line
> and so on... 
> ```

编辑：推迟到 java 13

* * *

## 回答 #26

> 赞同：4
> 
> 时间：2012-07-10T17:08:27.990

如果你和我一样喜欢 google 的 guava，它可以提供一个相当干净的表示和一个很好、简单的方法来不硬编码你的换行符：

```
String out = Joiner.on(newline).join(ImmutableList.of(
    "line1",
    "line2",
    "line3")); 
```

* * *

## 回答 #27

> 赞同：4
> 
> 时间：2016-05-18T02:38:15.817

一个不错的选择。

```
import static some.Util.*;

    public class Java {

        public static void main(String[] args) {

            String sql = $(
              "Select * from java",
              "join some on ",
              "group by"        
            );

            System.out.println(sql);
        }

    }

    public class Util {

        public static String $(String ...sql){
            return String.join(System.getProperty("line.separator"),sql);
        }

    } 
```

* * *

## 回答 #28

> 赞同：3
> 
> 时间：2009-05-18T16:43:20.267

> 在属性文件中定义我的字符串？

属性文件中不允许使用多行字符串。您可以在属性文件中使用 \n ，但我认为这不是您的解决方案。

* * *

## 回答 #29

> 赞同：3
> 
> 时间：2010-05-17T14:57:58.833

我建议使用 ThomasP 建议的实用程序，然后将其链接到您的构建过程中。仍然存在包含文本的外部文件，但在运行时不会读取该文件。那么工作流程是：

1.  构建一个“文本文件到 Java 代码”实用程序并检查版本控制
2.  在每次构建时，针对资源文件运行该实用程序以创建修改后的 Java 源
3.  Java 源代码包含一个标头， `class TextBlock {...`后跟一个从资源文件自动生成的静态字符串
4.  使用其余代码构建生成的 java 文件

* * *

## 回答 #30

> 赞同：3
> 
> 时间：2018-07-07T22:15:30.103

我知道这是一个老问题，但是对于有兴趣的开发人员来说，多行文字将出现在 #Java12 中

[http://mail.openjdk.java.net/pipermail/amber-dev/2018-July/003254.html](http://mail.openjdk.java.net/pipermail/amber-dev/2018-July/003254.html)

* * *

## 回答 #31

> 赞同：2
> 
> 时间：2009-05-19T19:07:51.177

当使用一长串 + 时，只会创建一个 StringBuilder，除非在编译时确定 String，在这种情况下不使用 StringBuilder！

只有当使用多个语句来构造 String 时，StringBuilder 才更有效。

```
String a = "a\n";
String b = "b\n";
String c = "c\n";
String d = "d\n";

String abcd = a + b + c + d;
System.out.println(abcd);

String abcd2 = "a\n" +
        "b\n" +
        "c\n" +
        "d\n";
System.out.println(abcd2); 
```

注意：只创建一个 StringBuilder。

```
 Code:
   0:   ldc     #2; //String a\n
   2:   astore_1
   3:   ldc     #3; //String b\n
   5:   astore_2
   6:   ldc     #4; //String c\n
   8:   astore_3
   9:   ldc     #5; //String d\n
   11:  astore  4
   13:  new     #6; //class java/lang/StringBuilder
   16:  dup
   17:  invokespecial   #7; //Method java/lang/StringBuilder."<init>":()V
   20:  aload_1
   21:  invokevirtual   #8; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   24:  aload_2
   25:  invokevirtual   #8; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   28:  aload_3
   29:  invokevirtual   #8; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   32:  aload   4
   34:  invokevirtual   #8; //Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder;
   37:  invokevirtual   #9; //Method java/lang/StringBuilder.toString:()Ljava/lang/String;
   40:  astore  5
   42:  getstatic       #10; //Field java/lang/System.out:Ljava/io/PrintStream;
   45:  aload   5
   47:  invokevirtual   #11; //Method java/io/PrintStream.println:(Ljava/lang/String;)V
   50:  ldc     #12; //String a\nb\nc\nd\n
   52:  astore  6
   54:  getstatic       #10; //Field java/lang/System.out:Ljava/io/PrintStream;
   57:  aload   6
   59:  invokevirtual   #11; //Method java/io/PrintStream.println:(Ljava/lang/String;)V
   62:  return 
```

> 为了进一步澄清我的问题，我根本不关心性能。我担心可维护性和设计问题。

让它尽可能清晰和简单。

* * *

## 回答 #32

> 赞同：2
> 
> 时间：2010-12-12T18:39:44.153

一个小技巧。使用这个我在动态创建的 HTML 页面中注入 javascritp

```
StringBuilder builder = new StringBuilder();

public String getString()
{
    return builder.toString();
}
private DropdownContent _(String a)
{
    builder.append(a);
    return this;
}

public String funct_showhide()
{
   return
    _("function slidedown_showHide(boxId)").
    _("{").
    _("if(!slidedown_direction[boxId])slidedown_direction[boxId] = 1;").
    _("if(!slideDownInitHeight[boxId])slideDownInitHeight[boxId] = 0;").
    _("if(slideDownInitHeight[boxId]==0)slidedown_direction[boxId]=slidedownSpeed; ").
    _("else slidedown_direction[boxId] = slidedownSpeed*-1;").
    _("slidedownContentBox = document.getElementById(boxId);").
    _("var subDivs = slidedownContentBox.getElementsByTagName('DIV');").
    _("for(var no=0;no<subDivs.length;no++){").
    _(" if(subDivs[no].className=='dhtmlgoodies_content')slidedownContent = subDivs[no];").
    _("}").
    _("contentHeight = slidedownContent.offsetHeight;").
    _("slidedownContentBox.style.visibility='visible';").
    _("slidedownActive = true;").
    _("slidedown_showHide_start(slidedownContentBox,slidedownContent);").
    _("}").getString();

} 
```

* * *

## 回答 #33

> 赞同：2
> 
> 时间：2012-01-14T07:40:08.070

这可能看起来有点疯狂，但由于 heredocs 是单行声明的语法糖，换行符已转义，因此可以为 Java 文件编写预处理器，在预处理期间将 heredocs 更改为单行。

它需要在编译阶段（用于 ant/maven 构建）和 IDE 插件之前编写适当的插件来预处理文件。

从意识形态的角度来看，它与 fg “泛型”没有什么不同，后者也是一种预处理语法糖而不是强制转换。

然而，这是很多工作，所以我会在你的地方只使用 .properties 文件。

* * *

## 回答 #34

> 赞同：2
> 
> 时间：2013-04-01T17:40:23.097

后期模型 JAVA 对带有常量字符串的 + 进行了优化，在幕后使用了 StringBuffer，因此您不想用它弄乱您的代码。

它指向一个 JAVA 疏忽，它在双引号字符串的自动连接中与 ANSI C 不同，它们之间只有空格，例如：

```
const char usage = "\n"
"Usage: xxxx <options>\n"
"\n"
"Removes your options as designated by the required parameter <options>,\n"
"which must be one of the following strings:\n"
"  love\n"
"  sex\n"
"  drugs\n"
"  rockandroll\n"
"\n" ; 
```

我希望有一个多行字符数组常量，其中嵌入的换行符得到尊重，所以我可以呈现块而不会造成任何混乱，例如：

```
String Query = "
SELECT
    some_column,
    another column
  FROM
      one_table a
    JOIN
      another_table b
    ON    a.id = b.id
      AND a.role_code = b.role_code
  WHERE a.dept = 'sales'
    AND b.sales_quote > 1000
  Order BY 1, 2
" ; 
```

要做到这一点，需要击败 JAVA 众神。

* * *

## 回答 #35

> 赞同：2
> 
> 时间：2020-11-11T01:41:30.680

Java15 现在支持像 Python 一样的三引号字符串。

* * *

## 回答 #36

> 赞同：1
> 
> 时间：2009-05-18T16:32:44.877

我知道的唯一方法是用加号连接多行

* * *

## 回答 #37

> 赞同：1
> 
> 时间：2010-10-24T11:27:12.043

我看到至少有一种情况应该避免对长字符串使用外部文件：如果这些长字符串是单元测试文件中的预期值，因为我认为测试应该始终以它们不使用的方式编写依赖任何外部资源。

* * *

## 回答 #38

> 赞同：1
> 
> 时间：2014-03-17T05:37:50.073

我有时会使用一个并行的 groovy 类来充当一袋字符串

这里的java类

```
public class Test {
    public static void main(String[] args) {
        System.out.println(TestStrings.json1);
        // consume .. parse json
    }
} 
```

以及 TestStrings.groovy 中令人垂涎的多行字符串

```
class TestStrings {
    public static String json1 = """
    {
        "name": "Fakeer's Json",
        "age":100,
        "messages":["msg 1","msg 2","msg 3"]
    }""";
} 
```

当然，这仅适用于静态字符串。如果我必须在文本中插入变量，我只需将整个文件更改为 groovy。只要保持强类型的做法，它就可以被取消。

* * *

## 回答 #39

> 赞同：1
> 
> 时间：2018-12-04T11:43:49.197

使用这个库

[https://github.com/alessio-santacroce/multiline-string-literals](https://github.com/alessio-santacroce/multiline-string-literals)

可以这样写

```
System.out.println(newString(/*
      Wow, we finally have
      multiline strings in
      Java! HOOO!
*/)); 
```

非常好用且简单，但仅适用于单元测试

* * *

## 回答 #40

> 赞同：1
> 
> 时间：2020-02-17T05:38:55.337

这个问题的两个答案：

1.  如果您想坚持使用纯 Java，Java 14 将于 2020 年 3 月发布，您可以在第二预览模式下利用[JEP 368](https://openjdk.java.net/jeps/368) - 文本块。实际上，该功能在其他版本中处于预览模式（至少有 13 个）。我在[这里](https://github.com/knowledge-base-and-tutorials/java14-features/blob/master/src/main/java/com/github/kbnt/java14/tb/TextBlocks.java)创建并设置了示例。
2.  虽然此功能很有用，但很*容易被滥用*。请记住，Java 需要编译——在你的代码中包含大型字符数组可能是一个让你自责的简单方法（如果你想快速改变，你将需要重新编译——那个工具集可能对操作你的应用程序的人不可用） .

根据我的经验，建议在配置文件中保留大字符串（通常是应用程序操作员可以/应该在运行时更改的字符串）。

摘要：负责任地使用文本块:)。

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2009-08-26T20:33:23.157

[一个简单的选择是使用 SciTE ( http://www.scintilla.org/SciTEDownload.html](http://www.scintilla.org/SciTEDownload.html) ) 之类的编辑器编辑您的 java 代码，它允许您包装文本，以便轻松查看和编辑长字符串。如果您需要转义字符，只需将它们放入。通过关闭 wrap-option，您可以检查您的字符串确实仍然只是一个长的单行字符串。但当然，如果不是，编译器也会告诉你。

Eclipse 或 NetBeans 是否支持编辑器中的文本换行，我不知道，因为它们有很多选择。但如果没有，那将是一件好事。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2010-01-27T19:04:15.693

读到确实为 jdk7 计划了多行语法，我有点恼火（在 Java 存在大约几十年之后？）。有趣的是，甚至还没有用于读取文件完整内容的 readAll() 函数（仅来自 jdk7，呵呵），所以下面的代码读取单行。

```
/*
  MakeMultiline v1.0 (2010) - 免费使用和复制。

  将文本 blob 转换为一个 java 字符串文字的小工具
  （在行中进行拆分，在每一端添加 \n 并封闭
  双引号）。是否对文本 blob 中遇到的引号进行转义。

  对于解决 java 中缺少的多行字符串语法很有用
  之前的jdk7。用于：

     java MakeMultiline " "
  或者
     java MakeMultiline " " mytextfile.txt
*/

导入java.io.*；

类 MakeMultiline {
  公共静态无效主要（字符串[]参数）{
    尝试 {
      // args[0]: 缩进
      // args[1]: 要读取的文件名（可选；如果没有给出标准输入）
      // 使用标准输入时要注意末尾换行的 nmb！

      字符串缩进 = (args.length > 0 ? args[0] : "");
      文件阅读器 fr = null; BufferedReader br;
      如果 (args.length > 1)
        { fr = new FileReader(args[1]); br = new BufferedReader(fr); }
      别的
        { br = new BufferedReader(new InputStreamReader(System.in)); }
      字符串 s; 字符串 res = "";
      while((s = br.readLine()) != null) {
        if (res.length() > 0) res += " +\n";
        res += 缩进 + "\"" + s.replace("\"", "\\\"") + "\\n\"";
      }
      br.close(); if (fr != null) fr.close();
      System.out.println(res + ";");
    }
    捕获（异常 e）{
      System.out.println("异常：" + e);
    }
  }
}

```

这对我来说是最快的解决方案。(2010-01-27)

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2014-12-05T22:28:20.877

如果作者有兴趣使用某种需要具有一些动态值的格式化大字符串，则问题并不完全清楚，但如果是这种情况，则使用像 StringTemplate （[http://www.stringtemplate.org/](http://www.stringtemplate.org/)）这样的模板引擎可能非常有用。

下面是一个使用 StringTemplate 的简单代码示例。可以从外部纯文本文件加载实际模板（“Hello, < name >”）。模板中的所有缩进都将被保留，无需转义。

```
import org.stringtemplate.v4.*;

public class Hello {
    public static void main(String[] args) {
        ST hello = new ST("Hello, <name>");
        hello.add("name", "World");
        System.out.println(hello.render());
    }
} 
```

PS 出于可读性和本地化目的，从源代码中删除大块文本总是一个好主意。

* * *

## 回答 #44

> 赞同：-3
> 
> 时间：2021-12-11T09:14:38.100

您可以使用 Kotlin 多行字符串支持。

只需创建一个 Kotlin 类，并在那里使用它，

您可以将 kotlin 类称为 java synxtax

> //科特林

```
 fun jsIncreaseOrDecreaseWebFonts(webView : YHYWebView, sliderValue : Int, intFontSize : Int){
            var initialData = """
                  bla bla
                """

} 
```

> //来自Java

```
 KotlinFunctions t = new KotlinFunctions();
 t.jsIncreaseOrDecreaseWebFonts(webView,progresValue,incOrDec); 
```

# java - Java静态初始化器线程安全吗？

> ID：878577
> 
> 赞同：140
> 
> 时间：2009-05-18T16:30:29.107
> 
> 标签：java, multithreading, static, synchronization, static-initializer

我正在使用静态代码块来初始化我拥有的注册表中的一些控制器。因此，我的问题是，我可以保证这个静态代码块在类第一次加载时绝对只会被调用一次吗？我知道我无法保证何时调用此代码块，我猜是 Classloader 第一次加载它的时间。我意识到我可以在静态代码块中的类上同步，但我猜这实际上是怎么回事？

简单的代码示例是；

```
class FooRegistry {

    static {
        //this code must only ever be called once 
        addController(new FooControllerImpl());
    }

    private static void addController(IFooController controller) { 
        // ...
    }
} 
```

还是我应该这样做；

```
class FooRegistry {

    static {
        synchronized(FooRegistry.class) {
            addController(new FooControllerImpl());
        }
    }

    private static void addController(IFooController controller) {
        // ...
    }
} 
```

* * *

## 回答 #1

> 赞同：203
> 
> 时间：2009-05-18T16:43:44.947

是的，Java 静态初始化器是线程安全的（使用您的第一个选项）。

但是，如果您想确保代码只执行一次，您需要确保该类仅由单个类加载器加载。每个类加载器执行一次静态初始化。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-05-18T18:57:24.770

这是一个可以用于延迟初始化的技巧

```
enum Singleton {
    INSTANCE;
} 
```

或用于 Java 5.0 之前的版本

```
class Singleton {
   static class SingletonHolder {
      static final Singleton INSTANCE = new Singleton();
   }
   public static Singleton instance() {
      return SingletonHolder.INSTANCE;
   }
} 
```

由于 SingletonHolder 中的静态块将以线程安全的方式运行一次，因此您不需要任何其他锁定。只有在调用 instance() 时才会加载 SingletonHolder 类

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-18T16:44:44.070

在通常情况下，静态初始化程序中的所有内容都发生在使用该类的所有内容之前，因此通常不需要同步。但是，静态初始化程序调用的任何东西都可以访问该类（包括导致调用其他静态初始化程序）。

一个类可以由一个加载的类加载，但不一定要立即初始化。当然，一个类可以被多个类加载器实例加载，从而成为多个同名的类。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T16:50:59.707

是的，有点

初始化程序只被调用一次`static`，因此根据该定义，它是线程安全的——您需要两次或多次调用`static`初始化程序才能获得线程争用。

也就是说，`static`初始化程序在许多其他方面令人困惑。实际上没有指定的调用顺序。如果您有两个`static`初始化器相互依赖的类，这会变得非常混乱。如果您使用一个类但不使用`static`初始化程序将设置的内容，则不能保证类加载器将调用静态初始化程序。

最后，请记住您正在同步的对象。我意识到这并不是您真正要问的，但请确保您的问题并不是真正询问您是否需要使`addController()`线程安全。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T16:49:53.467

是的，静态初始化程序只运行一次。 [阅读此内容以获取更多信息](http://www.developer.com/java/other/article.php/2238491)。

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2015-05-12T22:16:41.990

所以基本上，既然你想要一个单例实例，你应该或多或少地用老式的方式来做，并确保你的单例对象只初始化一次。

# asp.net-mvc - 如何在 ASP.NET MVC 中使用小写路由？

> ID：878578
> 
> 赞同：154
> 
> 时间：2009-05-18T16:30:30.637
> 
> 标签：asp.net-mvc, url, routes, case, canonical-link

如何在 ASP.NET MVC 中使用小写字母和下划线（如果可能）？所以我会`/dinners/details/2`打电话`DinnersController.Details(2)`，如果可能的话，`/dinners/more_details/2`打电话`DinnersController.MoreDetails(2)`？

所有这一切，同时仍然使用像`{controller}/{action}/{id}`.

* * *

## 回答 #1

> 赞同：253
> 
> 时间：2012-07-25T10:02:42.590

使用 System.Web.Routing 4.5，您可以通过设置 RouteCollection 的 LowercaseUrls 属性来实现这一点：

```
public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.LowercaseUrls = true;

        routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
        );
    } 
```

还假设您出于 SEO 原因执行此操作，您希望将传入的 url 重定向为小写（如本文中的许多链接所述）。

```
protected void Application_BeginRequest(object sender, EventArgs e)
    {
        //You don't want to redirect on posts, or images/css/js
        bool isGet = HttpContext.Current.Request.RequestType.ToLowerInvariant().Contains("get");
        if (isGet && !HttpContext.Current.Request.Url.AbsolutePath.Contains("."))
        {
            //You don't want to modify URL encoded chars (ex.: %C3%8D that's code to Í accented I) to lowercase, than you need do decode the URL
            string urlLowercase = Request.Url.Scheme + "://" + HttpUtility.UrlDecode(HttpContext.Current.Request.Url.Authority + HttpContext.Current.Request.Url.AbsolutePath);
            //You want to consider accented chars in uppercase check
            if (Regex.IsMatch(urlLowercase, @"[A-Z]") || Regex.IsMatch(urlLowercase, @"[ÀÈÌÒÙÁÉÍÓÚÂÊÎÔÛÃÕÄËÏÖÜÝÑ]"))
            {
                //You don't want to change casing on query strings
                urlLowercase = urlLowercase.ToLower() + HttpContext.Current.Request.Url.Query;

                Response.Clear();
                Response.Status = "301 Moved Permanently";
                Response.AddHeader("Location", urlLowercase);
                Response.End();
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2009-05-18T16:39:13.863

当我想做同样的事情并很好地工作时，这两个教程很有帮助：

[http://www.coderjournal.com/2008/03/force-mvc-route-url-lowercase/](http://www.coderjournal.com/2008/03/force-mvc-route-url-lowercase/) [http://goneale.com/2008/12/19/lowercase-route-urls-in-aspnet-mvc/](http://goneale.com/2008/12/19/lowercase-route-urls-in-aspnet-mvc/)

编辑：对于有区域的项目，您需要修改 GetVirtualPath() 方法：

```
public override VirtualPathData GetVirtualPath(RequestContext requestContext, RouteValueDictionary values)
{
  var lowerCaseValues = new RouteValueDictionary();

  foreach (var v in values)
  {
    switch (v.Key.ToUpperInvariant())
    {
      case "ACTION":
      case "AREA":
      case "CONTROLLER":
        lowerCaseValues.Add(v.Key, ((string)v.Value).ToLowerInvariant());
        break;
      default:
        lowerCaseValues.Add(v.Key.ToLowerInvariant(), v.Value);
        break;
    }
  }
  return base.GetVirtualPath(requestContext, lowerCaseValues);
} 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2017-02-05T09:30:46.707

如果你碰巧使用 ASP.NET Core，你可能应该看看[这个](https://stackoverflow.com/a/39113342/1414809)：

> 将以下行添加到类的`ConfigureServices`方法中`Startup`。
> 
> ```
> services.AddRouting(options => options.LowercaseUrls = true); 
> ```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2009-11-13T20:21:07.777

如果您使用 UrlHelper 生成链接，您可以简单地将操作和控制器的名称指定为小写：

```
itemDelete.NavigateUrl = Url.Action("delete", "photos", new { key = item.Key }); 
```

结果：/media/photos/delete/64（即使我的控制器和操作是帕斯卡案例）。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-05-31T09:49:01.493

我在[Nick Berardi 的 Coder Journal](http://www.coderjournal.com/2008/03/force-mvc-route-url-lowercase/)中找到了这个，但它没有关于如何实现`LowercaseRoute`该类的信息。因此，在此处重新发布附加信息。

首先将`Route`类扩展到`LowercaseRoute`

```
public class LowercaseRoute : Route
{
    public LowercaseRoute(string url, IRouteHandler routeHandler)
        : base(url, routeHandler) { }
    public LowercaseRoute(string url, RouteValueDictionary defaults, IRouteHandler routeHandler)
        : base(url, defaults, routeHandler) { }
    public LowercaseRoute(string url, RouteValueDictionary defaults, RouteValueDictionary constraints, IRouteHandler routeHandler)
        : base(url, defaults, constraints, routeHandler) { }
    public LowercaseRoute(string url, RouteValueDictionary defaults, RouteValueDictionary constraints, RouteValueDictionary dataTokens, IRouteHandler routeHandler) : base(url, defaults, constraints, dataTokens, routeHandler) { }
    public override VirtualPathData GetVirtualPath(RequestContext requestContext, RouteValueDictionary values)
    {
        VirtualPathData path = base.GetVirtualPath(requestContext, values);

        if (path != null)
            path.VirtualPath = path.VirtualPath.ToLowerInvariant();

        return path;
    }
} 
```

然后修改`RegisterRoutes`Global.asax.cs的方法

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.Add(new LowercaseRoute("{controller}/{action}/{id}", 
        new RouteValueDictionary(new { controller = "Home", action = "Index", id = "" }), 
        new MvcRouteHandler()));

    //routes.MapRoute(
    //    "Default",                                              // Route name
    //    "{controller}/{action}/{id}",                           // URL with parameters
    //    new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
    //);
} 
```

但是，我想知道一种使用 routes.MapRoute 的方法...

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2010-06-14T06:46:23.283

您可以通过将此类添加为 RouteCollection 的扩展来继续使用 MapRoute 语法：

```
public static class RouteCollectionExtension
{
    public static Route MapRouteLowerCase(this RouteCollection routes, string name, string url, object defaults)
    {
        return routes.MapRouteLowerCase(name, url, defaults, null);
    }

    public static Route MapRouteLowerCase(this RouteCollection routes, string name, string url, object defaults, object constraints)
    {
        Route route = new LowercaseRoute(url, new MvcRouteHandler())
        {
            Defaults = new RouteValueDictionary(defaults),
            Constraints = new RouteValueDictionary(constraints)
        };

        routes.Add(name, route);

        return route;
    }
} 
```

现在您可以在应用程序的启动中使用“MapRouteLowerCase”而不是“MapRoute”：

```
 public void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        // Url shortcuts
        routes.MapRouteLowerCase("Home", "", new { controller = "Home", action = "Index" });
        routes.MapRouteLowerCase("Login", "login", new { controller = "Account", action = "Login" });
        routes.MapRouteLowerCase("Logout", "logout", new { controller = "Account", action = "Logout" });

        routes.MapRouteLowerCase(
            "Default",                                              // Route name
            "{controller}/{action}/{id}",                           // URL with parameters
            new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
        );
    } 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-18T16:48:14.080

这实际上有两个答案：

1.  您已经可以这样做了：路由引擎进行不区分大小写的比较。如果您键入小写路由，它将被路由到相应的控制器和操作。
2.  如果您使用生成路由链接的控件（ActionLink、RouteLink 等），除非您覆盖此默认行为，否则它们将生成大小写混合的链接。

不过，下划线是你自己的……

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-05-18T17:27:56.497

你可以使用 ActionName 属性吗？

```
 [ActionName("more_details")]
 public ActionResult MoreDetails(int? page)
 {

 } 
```

我认为案件不重要。URL 中的 More_Details、more_DETAILS、mOrE_DeTaILs 都将您带到同一个 Controller Action。

# java - 最佳场景设计

> ID：878583
> 
> 赞同：1
> 
> 时间：2009-05-18T16:32:42.737
> 
> 标签：java, database, performance, hashmap

我有一个要求，我必须从数据库中选择大约 6000 万条记录。一旦我在 ResultSet 中拥有所有记录，那么我必须根据客户要求（日期格式和数字格式）格式化一些列，然后我必须将所有记录写入文件（辅助内存）。

*   目前我正在从数据库中每天选择记录（7 天选择 7 次）并将它们放入 HashMap 中。从 HashMap 读取并格式化一些列，最后写入一个文件（单独的文件 7 天）。
*   最后，我将所有 7 个文件合并到一个文件中。

*   但这整个过程需要6个小时才能完成。为了改进这个过程，我创建了 7 个线程 7 天，所有线程都在编写单独的文件。

*   最后，我将所有 7 个文件合并到一个文件中。这个过程需要2个小时。但我的程序将在 1 小时后进入 OutOfMemory 等。

请为这种情况提出最佳设计，我是否应该使用一些缓存机制，如果是，那么是哪一种以及如何使用？

注意：客户不想更改数据库中的任何内容，例如创建索引或存储过程，他们不想接触数据库。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T16:39:14.037

您是否需要将所有记录都保存在内存中才能格式化它们？您可以尝试通过流程和对文件的权限来流式传输记录。如果您甚至能够进一步分解查询，您就可以开始处理结果，同时您仍然可以检索它们。

根据您的数据库后端，他们可能有工具来帮助解决这个问题，例如用于 Sql Server 2005+ 的 SSIS。

**编辑**

我是一名 .net 开发人员，所以让我建议我将在 .net 中做什么，并希望您可以在 java 端转换成类似的技术。

ADO.Net 有一个 DataReader，它是结果集的只进、只读 (Firehose) 游标。它在查询执行时返回数据。这个非常重要。本质上，我的逻辑是：

```
IDataReader reader=GetTheDataReader(dayOfWeek);

while (reader.Read())
{
    file.Write(formatRow(reader));
} 
```

由于这是在我们返回行时执行的，因此您不会阻止网络访问，我猜这对您来说是一个巨大的瓶颈。这里的关键是我们不会将任何这些内容长时间存储在内存中，因为我们循环读取器将丢弃结果，并且文件会将行写入磁盘。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T17:08:21.090

我认为乔希的建议是这样的：

您有循环，您当前在其中遍历查询的所有结果记录（此处仅使用伪代码）：

```
while (rec = getNextRec() )
   {
   put in hash ...
   }

for each rec in (hash)
   {
   format and save back in hash ...
   }

for each rec in (hash)
   {
   write to a file ...
   }

instead, do it like this:

while (rec = getNextRec() )
   {
   format fields ...
   write to the file ...
   } 
```

那么您一次在内存中永远不会有超过 1 条记录......并且您可以处理无限数量的记录。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T17:39:08.407

显然，一次读取 6000 万条记录会耗尽你所有的内存——所以你不能这样做。（即你的 7 线程模型）。一次读取 6000 万条记录会占用您所有的时间 - 所以您也不能这样做（即您的初始读取文件模型）。

所以....你将不得不妥协并做一些两者兼而有之。

Josh 是对的 - 打开一个光标到您的数据库，它只是以最简单、功能最简单的方式一个接一个地读取下一条记录。“firehose”游标（也称为只读、只进游标）是您想要的，因为它对数据库施加的负载最少。数据库不会让您更新记录，或在记录集中倒退，这是您无论如何都不想要的，因此它不需要处理记录的内存。

现在你有了这个光标，数据库一次给你一条记录——读取它，然后将它写入一个文件（或多个文件），这应该很快完成。然后，您的任务是以正确的顺序将文件合并为 1，这相对容易。

鉴于您必须处理的记录数量，我认为这是您的最佳解决方案。

但是......既然你到目前为止做得很好，为什么不减少线程数量，直到你的内存限制范围内。批处理是许多公司在一夜之间运行的，这似乎只是这些过程中的另一个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T16:36:22.840

取决于您使用的数据库，但如果它是 SQL Server，我会建议使用类似 SSIS 的东西来执行此操作，而不是编写程序。

# jsf - 具有输入行的数据表

> ID：878585
> 
> 赞同：0
> 
> 时间：2009-05-18T16:32:59.913
> 
> 标签：jsf, datatable, rows, input

我有一个生成文本输入行和选择列表行的数据表，当我提交时，这些值为空。我意识到这是因为 jsf 为每个输入生成单独的随机 ID。我真的需要逐行的数据，然后解析出我需要的数据。有什么建议么？：

```
<h:dataTable id="returnableItems" value="#{returnableItemsBean.orderCustomerFamilyItems}" var="item" styleClass="data stripeTable center">
  <h:column>
    <f:facet name="header">Item Number</f:facet>
    <h:outputText id="itemNum" value="#{item.itemNum}"/>
  </h:column>
  <h:column>
    <f:facet name="header">Description</f:facet>
    <h:outputText value="#{item.itemDescription}"/>
  </h:column>
  <h:column>
    <f:facet name="header">Original Quantity</f:facet>
    <h:outputText value="#{item.originalQuantity}"/>
  </h:column>
  <h:column>
    <f:facet name="header">Remaining Quantity</f:facet>
    <h:outputText value="#{item.eligibleQuantity}"/>
  </h:column>
  <h:column>
    <f:facet name="header">Quantity For Return</f:facet>
    <h:panelGrid styleClass="stepper">
      <span class="ns ui-stepper">
        <input id="returnQuantity" type="text" name="returnQuantity" size="2" autocomplete="off" class="ui-stepper-textbox" value="0" />
        <button type="button" name="ns_button_1_0" value="" class="ui-stepper-plus" onclick="setMaxVal(this,#{item.eligibleQuantity});">+</button>
        <button type="button" name="ns_button_2_0" value="" class="ui-stepper-minus">-</button>
      </span>
    </h:panelGrid>
  </h:column>
  <h:column>
    <f:facet name="header">Reason for Return</f:facet>
    <h:selectOneMenu id="returnReason" value="#{returnableItemsBean.orderReason.ordReasonCode}">
      <f:selectItems value="#{returnableItemsBean.orderReasons}"/>
      <f:converter  converterId="orderReasonConverter"/>
    </h:selectOneMenu>
  </h:column>
  <h:column>
    <f:facet name="header">Return/Replacement</f:facet>
    <h:selectOneMenu id="returnOption">
      <f:selectItem itemLabel="Option" itemValue=""/>
      <f:selectItem itemLabel="Return" itemValue="return"/>
      <f:selectItem itemLabel="Replacement" itemValue="replacement"/>
    </h:selectOneMenu>
  </h:column>
</h:dataTable> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T09:10:51.273

我不明白为什么您在表单中使用 HTML 输入和按钮而不是 JSF 输入和按钮。改用`<h:inputText>`and`<h:commandButton>`并将它们的值绑定到支持 bean 中的属性。当然，整个表应该在一个`<h:form> ... </h:form>`标签内。

此外，您的输入可能应该绑定到“item”变量的属性，就像您对输出所做的那样。如果没有，每一行都会有一个输入绑定到您的支持 bean 的相同属性。

您使用的是 JSP 还是 Facelets ？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T10:19:44.757

> jsf 为每个输入生成单独的随机 ID

ID 不是随机的；*h:dataTable*是一个[NamingContainer](http://java.sun.com/javaee/5/docs/api/javax/faces/component/NamingContainer.html)并管理其子[项 clientId](http://java.sun.com/javaee/5/docs/api/javax/faces/component/UIComponent.html#getClientId(javax.faces.context.FacesContext))，因此它们变得唯一（HTML 规范的要求）。JSF：[使用组件 ID（id vs clientId）](http://illegalargumentexception.blogspot.com/2009/02/jsf-working-with-component-ids.html)。

您添加的直接 HTML 将难以与 JSF model-view-presenter 框架集成。最好坚持 JSF 控件。此代码显示如何使用 JavaScript 和[自定义 TLD 函数](http://illegalargumentexception.blogspot.com/2009/02/jsf-working-with-component-ids.html#id_tld)操作客户端字段值：

```
 <h:dataTable value="#{rowDataBean.data}" var="row">
    <h:column>
      <f:facet name="header">
        <h:outputText value="product" />
      </f:facet>
      <h:outputText value="#{row.name}" />
    </h:column>
    <h:column id="column2">
      <f:facet name="header">
        <h:outputText value="quantity" />
      </f:facet>
      <h:inputText id="quantityCount" value="#{row.quantity}" />
      <h:commandButton value="+"
        onclick="increment('#{id:clientId('quantityCount')}'); return false;" />
    </h:column>
  </h:dataTable> 
```

调用的 JavaScript：

```
function increment(id) {
  //TODO: error handling
  var textField = document.getElementById(id);
  var value = textField.value;
  value++;
  textField.value = value;
} 
```

如果您使用 Facelets 而不是 JSP，则需要在[Facelets 标记库](https://facelets.dev.java.net/nonav/docs/dev/docbook.html#taglib-create)中定义该函数。

# xml - 使用 XProc 进行 XML 流式传输

> ID：878591
> 
> 赞同：2
> 
> 时间：2009-05-18T16:34:33.360
> 
> 标签：xml, streaming, large-files, xproc

我正在使用[xproc](http://www.w3.org/TR/xproc/)、XML 管道语言和[http://xmlcalabash.com/](http://xmlcalabash.com/)。我想找到一个流式传输大型 xml 文档的示例。例如，给定以下**巨大**的xml 文档：

```
<Books>
 <Book>
   <title>Book-1</title>
 </Book>
 <Book>
   <title>Book-2</title>
 </Book>
 <Book>
   <title>Book-3</title>
 </Book>

<!-- many many.... -->
 <Book>
   <title>Book-N</title>
 </Book>
</Books> 
```

我应该如何继续循环（流式传输）x-> N 文档，例如

```
<Books>
 <Book>
   <title>Book-x</title>
 </Book>
</Books> 
```

并用 xslt 处理每个文档？xproc 可以吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T09:44:30.370

以下是您可以如何使用 XProc 来实现它，该 XProc 将使用 QuiXProc 进行流式传输

```
<p:declare-step xmlns:p="http://www.w3.org/ns/xproc" version="1.0">
  <p:load href="hugedocument.xml"/>
  <p:for-each>
    <p:iteration-source select="/Books/Book"/>
    <p:xslt>
      <p:input port="stylesheet">
        <p:document href="book.xsl"/>
      </p:input>
      <p:input port="parameters">
        <p:empty/>
      </p:input>
    </p:xslt>
  </p:for-each>
  <p:wrap-sequence wrapper="Books"/>    
  <p:store href="hugedocument.res.xml"/>
</p:declare-step> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-09-02T12:24:47.060

您应该看看 QuiXProc ( [http://code.google.com/p/quixproc](http://code.google.com/p/quixproc) )，它是基于 Calabash 的 XProc 实现，添加了流和并行处理希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-30T11:57:48.697

EMC 的 Calumet ( [http://developer.emc.com/xmltech](http://developer.emc.com/xmltech) ) 也不做流媒体。到目前为止，主要关注点一直是遵守 XProc 规范以及与我们的其他 XML 相关工具的集成性，例如 xDB 原生 XML 数据库。对流媒体的支持在我的雷达上，尽管我现在不知道什么时候能够做到这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-03-10T10:53:57.677

是的，尽管我很想支持流，但我对 XML Calabash 的真正目标是完整性和正确性。

我对改造 XML Calabash 的内部结构以使用 Saxon 的更多推/拉流功能有一些想法，但我的“待办事项”列表上还有很多其他的东西：-/

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-07T08:38:47.037

我记得最近关于 XProc Dev 列表的讨论与流相关。Calabash 似乎没有尝试流式传输，请参阅[此处](http://markmail.org/message/yvrnvvgewytrxay2?q=list:xproc-dev+%22XML+Calabash+doesn%27t+attempt+to+stream%22+from:%22Norman+Walsh%22)的 Norman Walsh 消息。

Saxon SA，支持 XSLT 和 XQuery 的流式传输，详情请参阅： http: [//www.saxonica.com/documentation/sourcedocs/serial.html](http://www.saxonica.com/documentation/sourcedocs/serial.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-11-12T15:14:08.313

尽管大多数 XProc 处理器不会在步骤之间流式传输数据，但这并不一定意味着您的情况不会工作（例如，内存使用量会爆炸）。这取决于您想对 XSLT 步骤的结果做什么。

如果您正在收集结果，尝试构建一个大的输出文件，那么是的，这可能是一个问题。但在这种情况下，无论如何，您最好使用流式解决方案（SAX、STaX、JOOST 解析器......）。

如果您将分别存储每个 XSLT 的结果，那么问题就会少很多。您只需要关心是否有足够的可用内存来加载初始文档，并对每个文档进行处理。不确定 XMLCalabash 下的 Saxon 表现如何，但我希望高达 50 兆字节的大小不会是一个非常大的问题。

干杯

# javascript - 如何使用 Javascript 动态属性使 Foo.Bar 返回当前 Date()？

> ID：878595
> 
> 赞同：0
> 
> 时间：2009-05-18T16:35:19.190
> 
> 标签：javascript

我想创建一个对象属性，每次调用它时都会重新计算它的值。

我对它进行了抨击：

```
var Foo = { Bar : (function() { return Date(); })() }

alert(Foo.Bar); // shows time at object literal Foo was init'd
                // but need it to show time when it's called 
```

它甚至可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T16:37:50.607

不可能 - JS 属性不像 C# 属性那样“可执行”。你能做的最好的就是一个正常的方法。

另外：从设计的角度来看，我实际上认为自动更改属性非常差。无论如何，最小意外的原则会更好地服务于一种方法。

# c# - Graphics.DrawImage 徽标在大图像上的缩放不正确

> ID：878596
> 
> 赞同：4
> 
> 时间：2009-05-18T16:35:39.910
> 
> 标签：c#, graphics

我正在做一些标准代码，我正在将徽标应用于图像并且工作正常。

源图像始终为 1024 x 768，因为在此之前的代码会获取图像并调整其大小（基于原始图像创建一个新文件）。

徽标正确应用在我拥有的一些 2288 x 1712 的图像上。如果我使用 3264 x 2448 的图像，则徽标会添加到正确的起始坐标处，但会在 x 和 y 轴上进行。

徽标的两侧应有 10 像素的间隙。您可以看到的徽标中的 2 个字母也远大于源图像徽标。

[![替代文字](https://i.stack.imgur.com/3yv6u.jpg)](https://i.stack.imgur.com/3yv6u.jpg)

如果我拍摄行为错误的图像（3264 x 2448）并将其更改为 2288 x 1712，然后运行代码，它会输出正确的结果！

我不明白，因为变量 sourceImg 始终是 1024 x 768 版本，那么**为什么调整原始图像的大小会产生影响？**

```
Image sourceImg = Image.FromFile(Path.Combine(filepath,filename));
Image logo = Image.FromFile(watermark);

Graphics g = Graphics.FromImage(sourceImg);
g.DrawImage(
   logo,
   sourceImg.Width - horizontalPosition - logo.Width,
   sourceImg.Height - verticalPosition - logo.Height
);
g.Dispose();
logo.Dispose();

sourceImg.Save(Path.Combine(filepath, filename));
sourceImg.Dispose(); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T16:46:50.353

您正在使用的超载`DrawImage`使用图像的 PPI 值来计算大小。由于徽标的 PPI 值低于图像的 PPI 值，因此将徽标按比例放大，使其相对物理尺寸（英寸而不是像素）相同。

在以像素为单位指定大小的地方使用重载：

```
g.DrawImage(
   logo,
   sourceImg.Width - horizontalPosition - logo.Width,
   sourceImg.Height - verticalPosition - logo.Height,
   logo.Width,
   logo.Height
); 
```

# java - 如何从域对象创建 JSON 视图？

> ID：878597
> 
> 赞同：3
> 
> 时间：2009-05-18T16:35:40.657
> 
> 标签：java, json, spring, spring-mvc

我正在创建基于 AJAX 的 Web 应用程序的服务器端实现，其中客户端接收响应，这些响应是序列化为 JSON 的域对象。为了提供通用的外观和感觉，我想为不同类型的域对象创建模板，并将这些模板重新用作多个控制器的 Spring 视图。

例如，假设我有以下对象图：

A - B - C

其中 A 和 C 具有多对多关系。当我作为 AJAX 请求的结果返回 A 类型的对象时，我想在 B 和 C 表中返回其关联数据。但是，当我返回 C 类型的对象作为结果时，我只想返回表 C 中的数据。

到目前为止，我发现的唯一解决方案是在控制器中创建一个自定义数据绑定器；但是我相信这个用例更适合作为可以在许多控制器之间共享的视图。是否存在解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T17:23:59.657

是的，您可以拥有模型的 JSON 格式版本的视图。

看看[Spring-Json 视图](http://spring-json.sourceforge.net/)和`org.springframework.web.servlet.view.json.JsonView`类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-19T04:45:29.137

[XStream](http://xstream.codehaus.org/)具有用于任意 Java 对象的[JSON 序列化器和反序列化器。](http://xstream.codehaus.org/javadoc/com/thoughtworks/xstream/io/json/package-summary.html)

# .net - 如何检测 .Net 应用程序类型？

> ID：878598
> 
> 赞同：4
> 
> 时间：2009-05-18T16:36:21.920
> 
> 标签：.net, asp.net, winforms, console

我有一个库需要以不同的方式响应异常，具体取决于它是在控制台应用程序、WinForms、AspNet 还是 Windows 服务中运行。我已经尝试查看 System.Windows.Forms 和 System.Web 命名空间中的各种属性，但我找不到可靠的方法来准确检测托管我的库的应用程序类型。有人来过这里吗？有人有可靠的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T16:40:31.803

如果我正确理解您正在寻找的内容，那么您有一个执行错误处理的库，但您希望该库知道源是 Web、控制台、winforms 等吗？

您可能能够利用库中的一个属性，比如一个枚举，它跟踪正在使用的应用程序类型是什么。例如...

```
ErrorLogger error = new ErrorLogger(ErrorLoggerAppType.WinForm);
ErrorLogger error = new ErrorLogger(ErrorLoggerAppType.Web);
ErrorLogger error = new ErrorLogger(ErrorLoggerAppType.Console); 
```

 ***在评论中从 Samir***编辑**
... 此外，您总是可以让每种类型的应用程序的类在错误记录器库中实现相同的接口。**

 **例如，在 Web 应用程序中，您将使用：

```
WebErrorLogger error = new WebErrorLogger(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T16:49:32.110

在走这条路之前，我会质疑你的设计，但我认为这是一个有趣的挑战，想看看我是否能找到。

ASP.Net：检查 HttpContext.Current 不为空。您还可以查看 System.Web.Hosting.ApplicationManager.GetApplicationManager()，但我不确定它在 Asp.net 之外的表现如何

窗口窗体：您可以尝试使用 System.Windows.Forms.Application.OpenForms，这将返回任何打开的窗体。假设 Windows 窗体应用程序永远不会没有任何窗体。此外，控制台应用程序也可以启动 win 表单。

服务：对此不确定，但我想知道您是否可以检查进程的名称。还必须有一个 Windows API，因为任务管理器会显示进程何时是服务（至少在 Vista 上是这样）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T16:39:39.353

这感觉就像你想要更多地研究设计，但这是我的自发性。类库不需要知道关于它的调用者的事情。

您希望根据运行的上下文更改异常处理行为的哪些内容？

根据您的评论，我建议考虑为错误处理程序定义一个接口，然后创建该接口所需数量的实现（一个用于 WinForms，一个用于控制台等），并让客户端应用程序创建和注入相应的实现到库中。这样，您就可以从库中提取知识需求并将责任转移到客户端应用程序上。这些实现仍然可以驻留在您的类库中，但使用哪个实现将由客户端应用程序来决定。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T16:42:23.733

这听起来像是最好通过配置处理的事情。也许通过 IOC 注入类似 IExceptionHandler 接口的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T17:06:41.733

```
BOOL IsConsole(PBYTE file)
{
    PIMAGE_DOS_HEADER pDosHeader = (PIMAGE_DOS_HEADER)file;
    if(pDosHeader->e_magic == IMAGE_DOS_SIGNATURE) 
    {
        PIMAGE_NT_HEADERS pImageHeaders = (PIMAGE_NT_HEADERS)(file + pDosHeader->e_lfanew);
        if(pImageHeaders->Signature == IMAGE_NT_SIGNATURE) 
        {
            IMAGE_OPTIONAL_HEADER optionalHeader = pImageHeaders->OptionalHeader;
            return (optionalHeader.Subsystem == IMAGE_SUBSYSTEM_WINDOWS_CUI);
        }
    }

    return FALSE;
} 
```

`IMAGE_SUBSYSTEM_WINDOWS_CUI`可以`IMAGE_SUBSYSTEM_WINDOWS_GUI`用来检测它是否是 GUI 应用程序而不是控制台。

Windows 中的服务通常以 ' `services.exe`' 作为其父进程，确定父进程的方式在[CodeProject](http://www.codeproject.com/KB/threads/ParentPID.aspx)中有很好的描述。

ASP.NET 进程在名为 ASPNET 的特殊用户下运行，用户名可以从[访问令牌](http://msdn.microsoft.com/en-us/library/aa446671(VS.85).aspx)中获取。

# bash - 如何在没有交互式编辑器的情况下使用 Bash 自动创建 cron 作业？

> ID：878600
> 
> 赞同：481
> 
> 时间：2009-05-18T16:37:47.237
> 
> 标签：bash, shell, cron

crontab 是否具有不使用编辑器创建 cron 作业的参数（crontab -e）。如果是这样，从 Bash 脚本创建 cronjob 的代码是什么？

* * *

## 回答 #1

> 赞同：647
> 
> 时间：2009-05-18T16:47:43.240

您可以按如下方式添加到 crontab：

```
#write out current crontab
crontab -l > mycron
#echo new cron into cron file
echo "00 09 * * 1-5 echo hello" >> mycron
#install new cron file
crontab mycron
rm mycron 
```

* * *

## Cron 行解释

```
* * * * * "command to be executed"
- - - - -
| | | | |
| | | | ----- Day of week (0 - 7) (Sunday=0 or 7)
| | | ------- Month (1 - 12)
| | --------- Day of month (1 - 31)
| ----------- Hour (0 - 23)
------------- Minute (0 - 59) 
```

来源[nixCraft](http://www.cyberciti.biz/faq/how-do-i-add-jobs-to-cron-under-linux-or-unix-oses/)。

* * *

## 回答 #2

> 赞同：363
> 
> 时间：2009-05-18T18:02:42.837

您也许可以即时进行

```
crontab -l | { cat; echo "0 0 0 0 0 some entry"; } | crontab - 
```

`crontab -l`列出当前的 crontab 作业，`cat`打印它，`echo`打印新命令`crontab -`并将所有打印的内容添加到 crontab 文件中。您可以通过执行 new 来查看效果`crontab -l`。

* * *

## 回答 #3

> 赞同：106
> 
> 时间：2013-07-31T16:05:54.533

这个较短的文件不需要临时文件，它不受多次插入的影响，它允许您更改现有条目的时间表。

假设你有这些：

```
croncmd="/home/me/myfunction myargs > /home/me/myfunction.log 2>&1"
cronjob="0 */15 * * * $croncmd" 
```

要将其添加到 crontab 中，且不重复：

```
( crontab -l | grep -v -F "$croncmd" ; echo "$cronjob" ) | crontab - 
```

要将其从 crontab 中删除，无论其当前计划如何：

```
( crontab -l | grep -v -F "$croncmd" ) | crontab - 
```

笔记：

*   grep -F 从字面上匹配字符串，因为我们不想将其解释为正则表达式
*   我们也忽略了时间调度，只寻找命令。这边走; 可以更改计划，而无需向 crontab 添加新行的风险

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2011-11-12T18:08:47.917

谢谢大家的帮助。拼凑我在这里和其他地方找到的东西，我想出了这个：

## 编码

```
command="php $INSTALL/indefero/scripts/gitcron.php"
job="0 0 * * 0 $command"
cat <(fgrep -i -v "$command" <(crontab -l)) <(echo "$job") | crontab - 
```

我无法弄清楚如何在不重复自己的情况下消除对这两个变量的需求。

`command`显然是我要安排的命令。`job`获取`$command`并添加调度数据。我在完成工作的代码行中分别需要这两个变量。

## 细节

1.  感谢duckyflip，我使用这个小重定向thingy ( `<(*command*)`) 将输出`crontab -l`转换为`fgrep`命令的输入。
2.  `fgrep`然后过滤掉`$command`( `-v`option) 的任何匹配，不区分大小写 ( `-i`option)。
3.  同样，小重定向 thingy ( `<(*command*)`) 用于将结果转换回`cat`命令的输入。
4.  该`cat`命令还`echo "$job"`通过使用重定向事物（自我解释）再次接收（自我解释）`<(*command*)`）。
5.  因此，过滤后的输出`crontab -l`和简单`echo "$job"`的组合，通过管道（'|'）传递`crontab -`给最终被写入。
6.  然后他们都过上了幸福的生活！

## 简而言之：

这行代码过滤掉任何与命令匹配的 cron 作业，然后用新的 cron 作业写出剩余的 cron 作业，有效地充当“添加”或“更新”功能。要使用它，您所要做的就是换出`command`和`job`变量的值。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2009-05-18T16:49:38.773

编辑（固定覆盖）：

```
cat <(crontab -l) <(echo "1 2 3 4 5 scripty.sh") | crontab - 
```

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2017-03-13T21:46:13.247

关于 crontab 的使用已经有很多很好的答案，但没有提到更简单的方法，例如使用`cron`.

Using`cron`将利用位于或`/etc/crontab`的系统文件和目录：`/etc/cron.daily,weekly,hourly``/etc/cron.d/`

```
cat > /etc/cron.d/<job> << EOF
SHELL=/bin/bash 
PATH=/sbin:/bin:/usr/sbin:/usr/bin 
MAILTO=root HOME=/  
01 * * * * <user> <command>
EOF 
```

在上面的示例中，我们在 中创建了一个文件`/etc/cron.d/`，为命令成功执行提供了环境变量，并为命令提供了环境变量`user`，以及它`command`本身。此文件不应是可执行文件，并且名称应仅包含字母数字和连字符（下面有更多详细信息）。

不过，为了给出一个彻底的答案，让我们看看`crontab`vs之间的区别`cron/crond`：

```
crontab -- maintain tables for driving cron for individual users 
```

对于那些想要在系统上的用户上下文中运行作业的人来说，使用`crontab`可能非常有意义。

```
cron -- daemon to execute scheduled commands 
```

对于那些使用配置管理或想为其他用户管理作业的人，在这种情况下我们应该使用`cron`.

手册页的快速摘录为您提供了一些关于该做什么和不该做什么的示例：

> /etc/crontab 和 /etc/cron.d 中的文件必须由 root 拥有，并且不能是组可写或其他可写的。与假脱机区相比，/etc/cron.d 下的文件或 /etc/cron.hourly、/etc/cron.daily、/etc/cron.weekly 和 /etc/cron.monthly 下的文件也可能是符号链接，前提是符号链接和它指向的文件都归 root 所有。/etc/cron.d 下的文件不需要是可执行文件，而 /etc/cron.hourly、/etc/cron.daily、/etc/cron.weekly 和 /etc/cron.monthly 下的文件可以，如它们由 run-parts 运行（有关更多信息，请参见 run-parts(8)）。
> 
> **来源： http:** [//manpages.ubuntu.com/manpages/trusty/man8/cron.8.html](http://manpages.ubuntu.com/manpages/trusty/man8/cron.8.html)

从系统的角度来看，以这种方式管理 cron 更容易且更具可扩展性，但并不总是最好的解决方案。

* * *

## 回答 #7

> 赞同：10
> 
> 时间：2018-10-25T15:08:14.207

因此，在 Debian、Ubuntu 和许多类似的基于 Debian 的发行版中......

有一个 cron 任务连接机制，它接受一个配置文件，将它们捆绑起来并将它们添加到运行的 cron 服务中。

您可以在 /etc/cron.d/somefilename 下放置一个文件，其中 somefilename 是您想要的任何内容。

```
sudo echo "0,15,30,45 * * * * ntpdate -u time.nist.gov" >> /etc/cron.d/vmclocksync 
```

让我们分解一下：

sudo - 因为您需要提升权限才能更改 /etc 目录下的 cron 配置

echo - 在标准输出上创建输出的工具。printf, cat ... 也可以

" - 在字符串的开头使用双引号，您是专业人士

0,15,30,45 * * * * - 标准 cron 运行计划，这个每 15 分钟运行一次

ntpdate -u time.nist.gov - 我要运行的实际命令

" - 因为我的第一个双引号需要一个伙伴来关闭正在输出的行

>> - 双重重定向追加而不是覆盖*

/etc/cron.d/vmclocksync - vmclocksync 是我选择的文件名，它位于 /etc/cron.d/

* * *

* 如果我们使用 > 重定向，我们可以保证我们只有一个任务条目。但是，我们可能会破坏现有文件中的任何其他规则。您可以自己决定是否使用 > 进行破坏是正确的，或者使用 >> 进行可能的重复是否适合您。或者，您可以做一些复杂或涉及的事情来检查文件名是否存在，是否有任何内容，以及是否添加了任何类型的重复项——但是，我有事情要做，我不能这样做你现在。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2010-07-19T09:24:14.247

您可能正在自动执行此操作，并且您不希望将单个作业添加两次。在这种情况下使用：

```
__cron="1 2 3 4 5 /root/bin/backup.sh"
cat <(crontab -l) |grep -v "${__cron}" <(echo "${__cron}") 
```

这仅在您使用 BASH 时才有效。我不知道正确的 DASH ( `sh`) 语法。

**更新：**如果用户还没有 crontab，这将不起作用。更可靠的方法是：

```
(crontab -l ; echo "1 2 3 4 5 /root/bin/backup.sh") | sort - | uniq - | crontab - 
```

或者，如果您的发行版支持它，您也可以使用单独的文件：

```
echo "1 2 3 4 5 /root/bin/backup.sh" |sudo tee /etc/crond.d/backup 
```

[在另一个 SO question](https://stackoverflow.com/questions/610839/how-can-i-programmatically-create-a-new-cron-job)中找到了那些。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2014-05-29T17:02:58.483

为了使用 BASH 脚本快速而肮脏地创建/替换 crontab，我使用了以下表示法：

```
crontab <<EOF
00 09 * * 1-5 echo hello
EOF 
```

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2015-11-21T10:21:29.020

如果在那里找不到所需的字符串，则仅编辑 crontab 的变体：

```
CMD="/sbin/modprobe fcpci"
JOB="@reboot $CMD"
TMPC="mycron"
grep "$CMD" -q <(crontab -l) || (crontab -l>"$TMPC"; echo "$JOB">>"$TMPC"; crontab "$TMPC") 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2019-05-23T22:10:40.263

```
echo "0 * * * * docker system prune --force >/dev/null 2>&1" | sudo tee /etc/cron.daily/dockerprune 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-05-22T21:28:56.853

如果您正在使用 Vixie Cron，例如在大多数 Linux 发行版上，您可以将一个文件放在 /etc/cron.d 中，并带有单独的 cronjob。

这当然只适用于root。如果您的系统支持这一点，您应该会在其中看到几个示例。（注意该行中包含的用户名，与旧的 /etc/crontab 语法相同）

cron 中的一个可悲的错误功能是作为普通用户无法处理这个问题，而且这么多 cron 实现根本无法处理这个问题。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-09-08T12:29:34.660

我对此的首选解决方案是：

```
(crontab -l | grep . ; echo -e "0 4 * * * myscript\n") | crontab - 
```

这将确保您正确处理底部的空白新行。为避免 crontab 出现问题，您通常应该以空白新行结束 crontab 文件。上面的脚本确保它首先使用“grep”删除任何空白行。部分，然后在脚本末尾添加一个带有“\n”的新空行。如果您现有的 crontab 文件以空行结尾，这也将防止在新命令上方出现空行。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-12-18T12:29:33.837

用于在没有交互式编辑器的情况下添加 cron 作业的 Bash 脚本。下面的代码有助于使用 linux 文件添加 cronjob。

```
#!/bin/bash

cron_path=/var/spool/cron/crontabs/root

#cron job to run every 10 min.
echo "*/10 * * * * command to be executed" >> $cron_path

#cron job to run every 1 hour.
echo "0 */1 * * * command to be executed" >> $cron_path 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2020-09-23T09:39:01.483

```
(2>/dev/null crontab -l ; echo "0 3 * * * /usr/local/bin/certbot-auto renew") | crontab - 
```

```
cat <(crontab -l 2>/dev/null) <(echo "0 3 * * * /usr/local/bin/certbot-auto renew") | crontab - 
```

#写出当前的crontab

```
crontab -l > mycron 2>/dev/null 
```

#echo 新的 cron 到 cron 文件中

```
echo "0 3 * * * /usr/local/bin/certbot-auto renew" >> mycron 
```

#安装新的cron文件

```
crontab mycron

rm mycron 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2017-06-03T20:48:19.183

`crontab`这是一个 bash 函数，用于在不重复的情况下添加命令

```
function addtocrontab () {
  local frequency=$1
  local command=$2
  local job="$frequency $command"
  cat <(fgrep -i -v "$command" <(crontab -l)) <(echo "$job") | crontab -
}
addtocrontab "0 0 1 * *" "echo hello" 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-09-04T12:47:31.817

```
CRON="1 2 3 4 5 /root/bin/backup.sh" 
cat < (crontab -l) |grep -v "${CRON}" < (echo "${CRON}") 
```

将 -w 参数添加到 grep 精确命令，没有 -w 参数添加 cronjob“testing”导致删除 cron 作业“testing123”

添加/删除 cronjobs 的脚本函数。没有重复条目：

```
cronjob_editor () {         
# usage: cronjob_editor '<interval>' '<command>' <add|remove>

if [[ -z "$1" ]] ;then printf " no interval specified\n" ;fi
if [[ -z "$2" ]] ;then printf " no command specified\n" ;fi
if [[ -z "$3" ]] ;then printf " no action specified\n" ;fi

if [[ "$3" == add ]] ;then
    # add cronjob, no duplication:
    ( crontab -l | grep -v -F -w "$2" ; echo "$1 $2" ) | crontab -
elif [[ "$3" == remove ]] ;then
    # remove cronjob:
    ( crontab -l | grep -v -F -w "$2" ) | crontab -
fi 
} 
cronjob_editor "$1" "$2" "$3" 
```

测试：

```
$ ./cronjob_editor.sh '*/10 * * * *' 'echo "this is a test" > export_file' add
$ crontab  -l
$ */10 * * * * echo "this is a test" > export_file 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-05-18T16:53:51.230

不，crontab 中没有修改 cron 文件的选项。

您必须：获取当前的 cron 文件（crontab -l > newfile），更改它并将新文件放置到位（crontab newfile）。

如果你熟悉 perl，你可以使用这个模块[Config::Crontab](http://search.cpan.org/dist/Config-Crontab/Crontab.pm "配置::Crontab")。

律师事务所，安德里亚

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-09-03T16:00:13.647

添加 cronjobs 的脚本函数。检查重复条目，可用表达式 * > "

```
cronjob_creator () {         
# usage: cronjob_creator '<interval>' '<command>'

  if [[ -z $1 ]] ;then
    printf " no interval specified\n"
elif [[ -z $2 ]] ;then
    printf " no command specified\n"
else
    CRONIN="/tmp/cti_tmp"
    crontab -l | grep -vw "$1 $2" > "$CRONIN"
    echo "$1 $2" >> $CRONIN
    crontab "$CRONIN"
    rm $CRONIN
fi
} 
```

测试：

```
$ ./cronjob_creator.sh '*/10 * * * *' 'echo "this is a test" > export_file'
$ crontab  -l
$ */10 * * * * echo "this is a test" > export_file 
```

来源：我的大脑；）

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-09-24T21:04:04.787

假设您以用户“ubuntu”的身份登录，但您想将作业添加到其他用户的 crontab，例如“john”。您可以执行以下操作：

```
(sudo crontab -l -u john; echo "* * * * * command") | awk '!x[$0]++' | sudo crontab -u john - 
```

此解决方案的大部分来源：[https ://www.baeldung.com/linux/create-crontab-script](https://www.baeldung.com/linux/create-crontab-script)

我在尝试将工作添加到**另一个用户的 crontab**时遇到了很多问题。它一直在复制 crontab，或者干脆直接删除它们。不过，经过一些测试，我相信这行代码会以非破坏性的方式将新作业**附加到指定用户的 crontab 中，包括不创建已经存在的作业。**

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2021-11-22T17:09:10.447

我想找到一个这样的例子，所以也许它有帮助：

```
COMMAND="/var/lib/postgresql/backup.sh"
CRON="0 0 * * *"
USER="postgres"
CRON_FILE="postgres-backup"
# At CRON times, the USER will run the COMMAND
echo "$CRON $USER $COMMAND" | sudo tee /etc/cron.d/$CRON_FILE
echo "Cron job created. Remove /etc/cron.d/$CRON_FILE to stop it." 
```

# iphone - 为 iPhone 创建 PDF，如何？

> ID：878604
> 
> 赞同：0
> 
> 时间：2009-05-18T16:38:33.787
> 
> 标签：iphone, pdf

我正在尝试使用 PDF 格式为 iPhone 编写电子书。

问题是，我无法创建 5 cm x 5 cm 的 PDF（示例）。

我试过 Adob​​e Acrobat Pro 9。没有用，因为无法自定义纸张大小。

我试过Pages 08，但也不可能（可以设置自定义大小，但它不起作用，可能是一个错误）。

我试过微软Word。生成的 PDF 是一团糟……不能正常工作。

所以..我无法创建具有自定义纸张尺寸的 PDF。这太疯狂了......必须有一个工具或其他东西可以正常工作。

任何人都知道任何工作良好的工具？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T16:47:56.093

在 Mac 上（因为底层绘图系统 Quartz 基于与 PDF 相同的祖先），您始终可以通过执行 Print->Save as PDF... 来生成 PDF...

这通常会产生良好的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:45:36.520

我只有一个建议，但也许开放办公室？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-02-04T22:57:35.703

看看乳胶。您可以将文档排版为您想要的任何大小。[http://www.latex-project.org/](http://www.latex-project.org/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-10T10:11:49.207

鉴于 iPhone 分辨率为 320 x 360 像素，分辨率为 163ppi，我们需要在将文档导出为 PDF 之前优化打印设置。我提示大多数人会在 iphone 横向模式下查看他们的文档，因此我们将文档宽度基于 360 像素。

因此，在将文档导出或打印为 PDF 时，您需要使用以下设置：

宽度：125 毫米 x 225 毫米。

而已。现在只需使用 PDF 打印机驱动程序（如 doPDF）将您的文档打印为 PDF，然后将文档通过电子邮件发送到您的 iPhone。

# programming-languages - 哪些语言具有可以分配 getter 和 setter 的属性？

> ID：878616
> 
> 赞同：1
> 
> 时间：2009-05-18T16:40:51.163
> 
> 标签：programming-languages, properties

Java没有。（这只是惯例）

德尔福可以。我相信 C# 可以。

其他语言有什么作用？

**编辑：** 我应该举个例子：

Delphi：（注意，已经有一段时间了，我可能会弄错）

```
 type
   TSomething = class
   fEmployeeNum: String;
    property employeeNum: String read fEmployeeNum write setEmployeeNum;
   end;

 procedure TSomething.setEmployeeNum(var val: String);
 begin
   fEmployeeNum := val;
 end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T16:48:13.067

C# 确实（仅提供一个示例）：

```
class Foo
{
    public string Bar { get; private set; }
    public string Bargain
    {
        get { return this._Bargain; }
        set { this._Bargain = value; }
    }
    private string _Bargain;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T16:48:35.343

Ruby 通过`attr_reader`, `attr_writer`, 和`attr_accessor`（用于读/写）：

```
class SomeClass
  attr_reader :foo #read-only
  attr_writer :bar #write-only
  attr_accessor :baz #read and write

  ...
end 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T16:50:02.140

Python 可以。

```
class SomeClass( object ):
def f_get( self ):
    return self.value
fprop = property( f_get ) 
```

setter 的代码类似。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T16:41:47.087

VB.NET 通过 Property 关键字来实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T16:48:00.303

C++ 不符合标准，但您可以通过模板创建容量。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T17:30:53.103

[目标 c](http://macdevelopertips.com/objective-c/objective-c-properties-setters-and-dot-syntax.html)，你可以用 synthesize 关键字偷懒。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T21:37:42.357

在 Perl 6 中，

```
use v6;

sub foo() is rw {
    state $foo;
    return new Proxy:
        FETCH => method { return $foo },
        STORE => method($to) { $foo = $to };
}

foo = "Hello, world!";
say foo; 
```

……至少在理论上。似乎不适用于 Rakudo r38250。

# iphone - Iphone Core Animation 坐标跟踪和碰撞

> ID：878626
> 
> 赞同：0
> 
> 时间：2009-05-18T16:44:15.850
> 
> 标签：iphone, cocoa-touch, core-animation

我目前正在学习 Iphone 编程，但在思考 CAKeyframeAnimation 时遇到了一些麻烦

我正在使用 CAKeyframeAnimation 为屏幕上的对象设置动画，如下所示：

CGPathMoveToPoint(thePath, NULL, start.x, start.y); CGPathAddLineToPoint(thePath, NULL, finish.x, finish.y); 动画.path = thePath; 动画持续时间 = 动画持续时间；

// 将动画组添加到图层 [Layer addAnimation:animation forKey:@"animate"]

我使用这个基本思想来移动我的对象，但现在我希望能够检测对象之间的碰撞。

我正在考虑向屏幕上的每个动画对象添加一个观察者 [animated addObserver:...]

并让当位置改变时调用一个方法来检查当前位置与所有其他动画对象的位置。

问题是可能有很多对象（可能多达 100 个（估计但可能更多）），正在检查 10 - 20 个对象的列表是否存在碰撞。因此我担心每次迭代都会进行大量测试。

你会建议我做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T23:05:56.983

```
for(UIView *aView in arrayOfMovingObjects){

    CGRect aFrame = [(CALayer*)[aView.layer presentationLayer] frame];

    for(UIView *anotherView in arrayOfMovingObjects){

        if(aView!=anotherView){

             CGRect anotherFrame = [(CALayer*)[anotherView.layer presentationLayer] frame];

             if(CGRectIntersectsRect(aFrame, anotherFrame){

             // handle collision

             }
        }
   }
} 
```

我不太确定大量对象的性能，但这会起作用。您还需要处理存储检测到的碰撞，否则您将检测到每个碰撞两次。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-21T11:59:21.763

我相信 CoreAnimation (CA) 旨在用于*不影响您的“业务逻辑”*（或这种情况下的游戏逻辑）的动画，而只是取悦用户或给他视觉反馈。如果您需要做的不仅仅是取消动画或在动画完成时收到通知，那么强烈建议*不要*使用 CA。

正如 tequilatango 所指出的，将碰撞和图形分开通常是一个好主意。或者更笼统地说：图形通常是通往用户的单向之路。渲染结果很少会影响程序的其他部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T17:34:03.270

做好碰撞检测可能是一个棘手的问题。通常，独立于图形对其进行建模是个好主意。我建议您熟悉一些内置碰撞检测的开源物理引擎[。Box2D](http://www.box2d.org/)是一种流行且不错的选择，它具有适用于 iPhone 游戏的自由许可证。

对具有大量移动动画的游戏使用核心动画转换可能会很棘手。动画期间 CALayer 的实际位置不反映在其坐标中，仅反映在终点或起点，具体取决于您的选择。~~因此，您需要为此构建自己的抽象。~~ *编辑：正如布拉德指出的那样，您可以在动画期间从表示层获得位置。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T17:38:59.000

> 你会建议我做什么？

我不认为核心动画是您的应用程序的正确框架。100 个精灵将在 iPhone 上推送核心动画的功能，并且无法获得您需要的更新类型。

# c++ - 从 Windows API 获取计算机的域名

> ID：878627
> 
> 赞同：4
> 
> 时间：2009-05-18T16:44:21.437
> 
> 标签：c++, winapi

在我的应用程序中，我需要知道计算机是否是域的主域控制器，因此我需要知道计算机的域才能调用 NetGetDCName 函数。

谢谢。

编辑：问题与 DCOM 身份验证有关，因此如果我需要使用计算机的本地身份验证数据库，我需要知道域以在 PDC 或 COMPUTER\USERNAME 的情况下使用 DOMAIN\USERNAME。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-01T08:32:23.630

该[`NetWkstaGetInfo()`](http://msdn.microsoft.com/en-us/library/aa370663%28VS.85%29.aspx)函数返回计算机的域名或工作组，因此不是确定计算机是否是域成员的可靠方法。

该[`GetComputerNameEx()`](http://msdn.microsoft.com/en-us/library/ms724301%28v=vs.85%29.aspx)函数将有所帮助，与`ComputerNameDnsDomain`参数一起使用，如下所示。如果计算机在工作组中，这将返回一个空字符串，或者是域的 DNS 名称：

```
DWORD bufSize = MAX_PATH;
TCHAR domainNameBuf[ MAX_PATH ];

GetComputerNameEx( ComputerNameDnsDomain, domainNameBuf, &bufSize ); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-18T16:58:15.340

我会考虑使用[NetWkstaGetInfo()](http://msdn.microsoft.com/en-us/library/aa370663(VS.85).aspx)并传递本地计算机名称是第一个参数。

```
#include <Lmwksta.h>
#include <StrSafe.h>

WCHAR domain_name[256];
WKSTA_INFO_100 info = {0};
if (NERR_Success == NetWkstaGetInfo(L"THIS-COMPUTER", 100, &info) && 
    SUCCEEDED(StringCchCopy(domain_name, ARRAYSIZE(domain_name), info.wki100_langroup))) {
    // use domain_name here...
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T16:58:33.873

您可以使用[NetWkstaGetInfo](http://msdn.microsoft.com/en-us/library/aa370663(VS.85).aspx)函数执行此操作。

如果您为计算机名称传入 null，它将返回有关本地计算机的信息。

它将返回一个`WKSTA_INFO_100`包含域名的实例。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T17:10:46.467

如果您只想知道代码运行的机器是否是主域控制器，我认为您最好的选择是[NetServerGetInfo](http://msdn.microsoft.com/en-us/library/aa370624.aspx)。如果您将*101*作为*级别*参数传递，它将返回一个[SERVER_INFO_101 结构](http://msdn.microsoft.com/en-us/library/aa370903.aspx)。然后寻找它的*sv101_type*成员：

> **sv101_type**
> 
> > 计算机正在运行的软件类型。此成员可以是以下值之一。
> > 
> > > (...)
> > > 
> > > `SV_TYPE_DOMAIN_CTRL`: 主域控制器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-08-05T09:18:15.763

有一个特定的函数来确定工作站的加入状态。 [https://docs.microsoft.com/en-gb/windows/desktop/api/lmjoin/nf-lmjoin-netgetjoininformation](https://docs.microsoft.com/en-gb/windows/desktop/api/lmjoin/nf-lmjoin-netgetjoininformation)

可以是 3 个状态，“已加入”工作组（旧的 Windows 3.0 网络）状态 == NetSetupWorkgroupName，或已加入域状态 == NetSetupDomainName 或未加入（独立）状态 == NetSetupUnjoined

因此，如果您知道这一点，则可以以可靠的方式调用相应的所需功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T10:55:46.960

最后我使用了这段代码。它在本地机器上工作，远程执行 nStatus 给出一个 ACCESS_DENIED 错误。

```
NET_API_STATUS nStatus;
TOleString oleServerName=strServerName.c_str();
DWORD dwLevel=101;
LPSERVER_INFO_101 pBufServer=NULL;
LPWKSTA_INFO_100 pBufWksta = NULL;

nStatus=NetServerGetInfo(oleServerName, dwLevel,
    (LPBYTE*)&pBufServer);
if(nStatus==NERR_Success &&
    (pBufServer->sv101_type & SV_TYPE_DOMAIN_CTRL))
{
    dwLevel=100;
    nStatus=NetWkstaGetInfo(oleServerName, 100,
        (LPBYTE*)&pBufWksta);

    if(nStatus==NERR_Success)
    {
        AnsiString strDomain(pBufWksta->wki100_langroup);

        m_pgServerConnection->SetDomain(strDomain);
    }
} 
```

谢谢大家 ：）

# asp.net - ASP.NET 黄屏死机 (YSOD) 能否按需生成或捕获？

> ID：878628
> 
> 赞同：6
> 
> 时间：2009-05-18T16:44:29.533
> 
> 标签：asp.net, error-reporting, error-logging, yellow-screen-of-death

例如，我们只想从 Global.asax 错误处理程序中捕获 YSOD 输出以在错误报告电子邮件中使用。有没有办法利用内置的 ysod 生成器？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T16:47:36.140

我会研究[ELMAH（ASP.NET 的错误记录模块和处理程序）](http://code.google.com/p/elmah/)：

> ELMAH（错误记录模块和处理程序）是一个完全可插拔的应用程序范围的错误记录工具。它可以动态添加到正在运行的 ASP.NET Web 应用程序，甚至是一台机器上的所有 ASP.NET Web 应用程序，无需重新编译或重新部署。
> 
> 将 ELMAH 放入正在运行的 Web 应用程序并进行适当配置后，您无需更改任何一行代码即可获得以下功能：
> 
> *   记录几乎所有未处理的异常。
> *   用于远程查看重新编码异常的整个日志的网页。
> *   用于远程查看任何记录的异常的完整详细信息的网页。
> *   在许多情况下，即使关闭了 customErrors 模式，您也可以查看 ASP.NET 为给定异常生成的原始黄屏死机。
> *   每个错误发生时的电子邮件通知。
> *   来自日志的最后 15 个错误的 RSS 提要。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-10-20T12:53:28.093

是的，有一种方法可以做到这一点。

在 global.asax 文件的 Application_Error 事件中，将最后一个异常作为 System.HttpUnhandledException 获取。您的代码将如下所示：

```
var lastException = Server.GetLastError() as HttpUnhandledException;
string Ysod = lastException.GetHtmlErrorMessage();
// your call to emailing routine follows 
```

我同意其他人的评论。您也可以使用 ELMAH 执行此操作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T16:47:01.540

你听说过ELMAH吗？它可能会为您提供您真正想要的所有功能...

这是一篇博客文章，对此进行了一些解释：[http ://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx](http://www.hanselman.com/blog/ELMAHErrorLoggingModulesAndHandlersForASPNETAndMVCToo.aspx)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T16:46:22.507

您应该检查[ELMAH](http://code.google.com/p/elmah/)它会自动执行您的要求。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-18T16:46:43.380

我会说一般来说，您不希望用户体验 YSOD。这是我之前在网络应用程序中放置的东西，用于捕获错误，然后为用户提供更优雅的错误页面......

```
protected void Application_Error(object sender, EventArgs e)
{
    MailMessage msg = new MailMessage();
    HttpContext ctx = HttpContext.Current;

    msg.To.Add(new MailAddress("me@me.com"));
    msg.From = new MailAddress("from@me.com");
    msg.Subject = "My app had an issue...";
    msg.Priority = MailPriority.High;

    StringBuilder sb = new StringBuilder();
    sb.Append(ctx.Request.Url.ToString() + System.Environment.NewLine);
    sb.Append("Source:" + System.Environment.NewLine + ctx.Server.GetLastError().Source.ToString());
    sb.Append("Message:" + System.Environment.NewLine + ctx.Server.GetLastError().Message.ToString());
    sb.Append("Stack Trace:" + System.Environment.NewLine + ctx.Server.GetLastError().StackTrace.ToString());
    msg.Body = sb.ToString();

    //CONFIGURE SMTP OBJECT
    SmtpClient smtp = new SmtpClient("myhost");

    //SEND EMAIL
    smtp.Send(msg);

    //REDIRECT USER TO ERROR PAGE
    Server.Transfer("~/ErrorPage.aspx");
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T16:47:55.453

每当应用程序中发生未处理的异常时，就会触发 Global.asax 文件中的 Application_Error 事件。您可以使用 Server.GetLastError() 方法获取最后发生的异常。

同样，您可以通过在 web.config 文件的 customErrors 部分下的 web.config 中指定它来创建自己的自定义错误页面。通过指定默认文件，您可以在将异常路由到那里时进行任何自定义编码。

# php - 更快地在 MYSQL 中查询或使用 PHP 逻辑

> ID：878631
> 
> 赞同：1
> 
> 时间：2009-05-18T16:44:47.863
> 
> 标签：php, mysql, performance

我有一个页面，可以根据类别 ID 从多个类别中提取许多标题。

我想知道提取所有标题然后通过 PHP if/ifelse 语句对它们进行排序是否更有意义，或者最好运行多个查询，每个查询都包含每个类别的标题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T16:49:15.077

为什么不一次查询呢？就像是：

```
SELECT headline FROM headlines WHERE category_id IN (1, 2, 3, ...); 
```

如果你用 PHP 过滤你的标题，想想你会扔掉多少。如果您最终只删除了 10% 的标题，那么与丢弃 90% 的结果相比，这并不重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T20:39:25.690

这类问题总是很难回答，因为情况决定了最好的路线。从来没有真正正确的答案，只有更好的方法。根据我的经验，无论您是尝试在 PHP 中还是在数据库中完成这项工作并不重要，因为您应该始终尝试使用诸如[memcached](http://www.php.net/manual/en/book.memcached.php)之类的缓存引擎来缓存任何昂贵操作的结果。这样，您就不会在数据库或 php 本身上花费大量时间，因为结果将被缓存并立即准备好使用。[归根结底，除非您使用像xDebug](http://xdebug.org/)这样的工具来分析您的应用程序，否则您认为的性能瓶颈只是猜测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:02:38.077

每次访问数据库都会让您付出一些代价。返回您随后决定忽略的额外数据会使您付出一些代价。所以你几乎肯定最好让数据库来做你的修剪。

我敢肯定，有人可能会想出一些情况，即确定您需要哪些数据会使查询变得非常复杂，从而使数据库难以优化，而您可以轻松地在代码中做到这一点。但是，如果我们谈论的是“从类别='体育'的故事中选择标题”，然后是“从类别='政治'的故事中选择标题”，然后是“从类别='健康'的故事中选择标题”等，而不是“ select category, title from story where category in ('Health','Sports','Politics')”，后者显然更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T16:48:13.377

通常最好不要使数据库过载，因为如果您有许多同时查询，您可能会导致瓶颈。

但是，在 PHP 中处理您的处理*通常会*更好，因为 Apache 会在需要处理多个请求时分叉线程。

像往常一样，这一切都归结为：“有多少流量？”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T16:50:24.137

MySQL 已经可以为您完成数据的选择和排序。我建议懒惰并使用它。

此外，我会寻找一个 (1) 查询，它可以一次获取所有类别及其标题。ORDER BY category、publishdate 或其他什么东西可以吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-16T22:06:48.723

On the topic of "Faster to query in MYSQL or to use PHP logic", which is how I ended up on this question 10 years later. I have determined that the correct answer is "it depends". There are just too many examples where using the DB saves processing time over writing PHP Code.... but there are just as many examples where writing PHP Code saves time on excessively complex MySQL queries.

There is no right answer here. If you end up here, like I did, then the best I can suggest is try to solve your problem with the skills that you have. Start first with the Query and try to solve it, if you run into issues then start thinking about just gathering the data and running the logic through PHP code to come up with a solution.

At the end of the day, you need to solve a problem.... if you solve it, but its not fast enough, then thats another problem... work on optimizing which may end up meaning that you go back to writing more MySQL logic.

Use the 80/20 rule and try to get things 80% of the way there as quickly as possible. You can go back and optimize once its workable. Spending all your effort on making it perfect the first time will surely mean you miss your deadline.

Thats my $0.02

# c# - 在 C# 中调用外部程序并解析输出的最佳方法

> ID：878632
> 
> 赞同：25
> 
> 时间：2009-05-18T16:44:56.643
> 
> 标签：c#, .net

### 复制

> [将控制台输出重定向到单独程序中的文本框](https://stackoverflow.com/questions/415620/redirect-console-output-to-textbox-in-separate-program-c) [使用 C# 捕获 nslookup shell 输出](https://stackoverflow.com/questions/353601/capturing-nslookup-shell-output-with-c)

我希望从我的 c# 代码中调用一个外部程序。

我正在调用的程序，假设 foo.exe 返回大约 12 行文本。

我想调用程序并通过输出解析。

执行此操作的最佳方法是什么？

代码片段也很感激:)

非常感谢您。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-18T16:48:20.023

```
using System;
using System.Diagnostics;

public class RedirectingProcessOutput
{
    public static void Main()
    {
        Process p = new Process();
        p.StartInfo.FileName = "cmd.exe";
        p.StartInfo.Arguments = "/c dir *.cs";
        p.StartInfo.UseShellExecute = false;
        p.StartInfo.RedirectStandardOutput = true;
        p.Start();

        string output = p.StandardOutput.ReadToEnd();
        p.WaitForExit();

        Console.WriteLine("Output:");
        Console.WriteLine(output);    
    }
} 
```

# c++ - 这是一个有效的 C++ 函数吗？

> ID：878636
> 
> 赞同：4
> 
> 时间：2009-05-18T16:46:02.790
> 
> 标签：c++

在我看来，此函数无效，因为它使用关键字“默认”作为标识符：

```
int foo()
{
    int default = 42;
    return default;
} 
```

但是，Microsoft C++ 编译器（版本 14.00.50727.762 和 15.00.30729.0）编译代码时不会出现警告或错误（使用最简单的命令行：'cl foo.cpp'）。

Dev-C++ 4.9.9.2 在编译函数时确实会产生错误。

这似乎是一个明显的问题，我必须忽略一些东西。

**编辑：** [litb](https://stackoverflow.com/users/34509/litb)挖出**Duplicate** for this question [Default as a variable name](https://stackoverflow.com/questions/664123/default-as-a-variable-name/664134#664134)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T16:48:58.523

MS Visual C++ 6.0 和 g++ 4.4.0 会产生许多错误——它们应该如此。我很难相信 C++ 编译器会接受这一点——你确定你真的编译了这段代码吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T16:51:21.593

默认是[保留字](http://www.cppreference.com/wiki/keywords/start)，gcc 4.3.2 不会编译该代码，不确定 MS 编译器在那里播放什么！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T16:51:26.647

不，默认是保留的 c++ 关键字，这就是它无法编译的原因。

# javascript - 如何单击或双击网页上的单词以触发事件处理程序？

> ID：878637
> 
> 赞同：10
> 
> 时间：2009-05-18T16:46:12.307
> 
> 标签：javascript, event-handling, dom-events, dhtml

对于像这样的页面

[http://www.answers.com](http://www.answers.com)

如果用户双击页面中的任何单词，将出现一个弹出框并显示该单词的定义。

我可以想出一种方法来使用 DOM 脚本来分解页面中的所有单词，然后让它们中的每一个都放在一个单独的“span”元素下......但是如果所有文本都在一个“p”元素，然后“p”元素节点被触发来处理双击事件，但是没有简单的方法来判断点击了哪个单词？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-18T17:02:49.307

您只需将双击事件添加到整个文档，如下所示：

```
function get_selection() {
    var txt = '';
    if (window.getSelection) {
        txt = window.getSelection();
    } else if (document.getSelection) {
        txt = document.getSelection();
    } else if (document.selection) {
        txt = document.selection.createRange().text;
    }
    return txt;
}

$(document).dblclick(function(e) {
    var t = get_selection();
    alert(t);
}); 
```

如果您只希望它适用于选定的段落，您可以将选择器更改为`p.myclass`或类似的东西。这取决于双击一个单词会在浏览器中突出显示它的事实。老实说，不确定这是否正是 answers.com 的做法。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T17:04:47.120

你去吧，一篇博客文章描述了你如何使用 jQuery 做到这一点。他的测试实现和你想要的差不多。即双击一个单词从字典中提取定义：

[使用jQuery和双击获取数据](http://web.archive.org/web/20090202031620/http://www.dumpsterdoggy.com/articles/?combine-jquery-and-double-clicks-to-get-data)

# asp.net - ASP.NET 2.0 JQuery AJAX 登录

> ID：878643
> 
> 赞同：6
> 
> 时间：2009-05-18T16:47:04.130
> 
> 标签：asp.net, jquery, ajax, login, controls

我试图弄清楚如何使用 Jquery 为 ASP.NET 2.0 站点实现 AJAX 登录。我已经在网站上实现了其他简单的 Jquery AJAX 应用程序，但我不确定如何通过 AJAX 将标准登录控件转换为 POST。我应该公开 login.aspx 页面方法吗？任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T22:00:49.097

以下是有关如何实施的一些想法。这不是完整的代码，但应该足以让您走上正轨。

您需要为用户名/密码创建自己的登录表单字段。

使用类似于以下的方法创建 ASMX 或 WCF WebService 进行身份验证：

```
[WebMethod]
public string AuthenticateUser(string username, string password)
{
    string result = "Invalid Username or Password";
    if(Membership.ValidateUser(userName, password))
    {
        FormsAuthentication.SetAuthCookie(u.UserName, false);
        result = "successful";
    }
    return result;
} 
```

然后从登录按钮的单击事件中，您可以使用 jQuery ajax 将用户名/密码发布到 Web 服务：

```
$.ajax({
  type: "POST",
  url: "WebService.asmx/AuthenticateUser",
  data: "{username:"+$('#txtUsername').val()+",password:"+$('#txtPassword').val()+"}",
  success: function(result) {
     alert(result);
    //if(result=='successful')
   // redirectUser to the home page
  }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-07-18T08:40:11.250

使用此解决方案存在一个很大的安全问题，即用户名和密码将以纯文本格式发送。所以你应该使用 SSL 或以某种方式散列这些数据。 [看看这里](http://evolt.org/node/60505)

# c# - 功能说明

> ID：878650
> 
> 赞同：90
> 
> 时间：2009-05-18T16:47:52.600
> 
> 标签：c#, .net, func

我想知道是否有人可以`Func<int, string>`通过一些清晰的示例来解释什么是以及如何使用它。

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2009-05-18T16:53:45.130

你对代表很熟悉吗？我有一个关于[代表和事件](http://csharpindepth.com/Articles/Chapter2/Events.aspx)的页面，如果没有，它可能会有所帮助，尽管它更倾向于解释两者之间的差异。

[`Func<T, TResult>`](http://msdn.microsoft.com/en-us/library/bb549151.aspx)只是一个通用委托 - 通过在声明中将*类型参数*( `T`and `TResult`) 替换为相应的*类型参数*( `int`and `string`) 来确定它在任何特定情况下的含义。我还重命名了它以避免混淆：

```
string ExpandedFunc(int x) 
```

换句话说，`Func<int, string>`是一个代表一个函数的委托，它接受一个`int`参数并返回一个`string`.

`Func<T, TResult>`在 LINQ 中经常用于预测和谓词（在后一种情况下，`TResult`总是`bool`）。例如，您可以使用 a`Func<int, string>`将整数序列投影到字符串序列中。*Lambda 表达式*通常在 LINQ 中用于创建相关的委托：

```
Func<int, string> projection = x => "Value=" + x;
int[] values = { 3, 7, 10 };
var strings = values.Select(projection);

foreach (string s in strings)
{
    Console.WriteLine(s);
} 
```

结果：

```
Value=3
Value=7
Value=10 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-05-18T17:18:19.447

A`Func<int, string>`吃整数并返回字符串。那么，什么吃整数并返回字符串？这个怎么样 ...

```
public string IntAsString( int i )
{
  return i.ToString();
} 
```

在那里，我刚刚编写了一个函数，它吃整数并返回字符串。我将如何使用它？

```
var lst = new List<int>() { 1, 2, 3, 4, 5 };
string str = String.Empty;

foreach( int i in lst )
{
  str += IntAsString(i);
}

// str will be "12345" 
```

不是很性感，我知道，但这是许多技巧所基于的简单想法。现在，让我们使用 Func 代替。

```
Func<int, string> fnc = IntAsString;

foreach (int i in lst)
{
  str += fnc(i);
}

// str will be "1234512345" assuming we have same str as before 
```

我没有在每个成员上调用 IntAsString ，而是创建了一个对它的引用，称为 fnc （这些对方法的引用称为[delegates](http://msdn.microsoft.com/en-us/library/ms173171(VS.80).aspx)）并改用它。（记住 fnc 吃整数并返回字符串）。

这个例子不是很吸引人，但是你会看到很多聪明的东西都是基于函数、委托和[扩展方法](http://msdn.microsoft.com/en-us/library/bb383977.aspx)的简单思想。

我见过的关于这些东西的最好的入门书之一是[这里](http://blogs.msdn.com/ericwhite/pages/FP-Tutorial.aspx)。他还有很多真实的例子。:)

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-05-18T16:48:51.363

它是一个委托，它接受一个`int`作为参数并返回一个 type 的值`string`。

以下是它的用法示例：

```
using System;

class Program
{
    static void Main()
    {
        Func<Int32, String> func = bar;

        // now I have a delegate which 
        // I can invoke or pass to other
        // methods.
        func(1);
    }

    static String bar(Int32 value)
    {
        return value.ToString();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-24T17:08:24.597

`Func<int, string>`接受一个 int 值参数并返回一个字符串值。这是一个不需要额外支持方法的示例。

```
Func<int, string> GetDogMessage = dogAge =>
        {
            if (dogAge < 3) return "You have a puppy!";
            if (dogAge < 7) return "Strong adult dog!";

            return "Age is catching up with the dog!";
        };

string youngDogMessage = GetDogMessage(2); 
```

注意：Func 中的最后一个对象类型（即本例中的“字符串”）是函数返回类型（即不限于原语，而是任何对象）。因此，`Func<int, bool, float>`接受 int 和 bool 值参数，并返回一个浮点值。

```
Func<int, bool, float> WorthlessFunc = (intValue, boolValue) =>
        {
            if(intValue > 100 && boolValue) return 100;

            return 1;
        };
float willReturn1 = WorthlessFunc(21, false);
float willReturn100 = WorthlessFunc(1000, true); 
```

高温高压

# c++ - 二分匹配

> ID：878668
> 
> 赞同：1
> 
> 时间：2009-05-18T16:49:45.637
> 
> 标签：c++, c, algorithm, graph, matching

如何在 C 或 C++ 中实现二分匹配算法（可能基于最大流算法）？

具体来说，我在一个文件中有这个输入： (1,3) (1,5) (2,5)

(M,F) --> 其中 M 代表 MALE 的 id，F 是 FEMALE 的 id。

我需要找到最大匹配数并显示匹配的情侣。喜欢：匹配：1&3、2&5

我读过一些书，我可以将这个问题建立在“网络中的最大流量”算法上，但除了“这个问题可以通过......算法解决”这句话之外，我找不到任何具体信息。我对最大流量知之甚少，也不知道如何实现它......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T17:07:56.927

是的，二分匹配可以减少到最大流量：

1.  你得到了一组节点`M`和`F`. 如果您的文件中有这对，则将一个有向边从一个节点添加`m`到`M`一个节点。`f``F``(m, f)`

2.  向其中的每个节点添加一个`S`具有有向边的单个节点（这是您的“超级源”节点）。`S``M`

3.  `T`从每个节点添加一个具有有向边的单个节点`F`到`T`（这是您的“超级接收器”节点）。

4.  现在，您需要找到从 到 的最大流量（所有边的权重为 1 `S`）`T`。

那么最大流量到底是什么？从到的*流*是一组边，使得对于每个节点（除了和），其*流入边的权重与其**流出*边的权重相同。想象一下，您的图表是一系列管道，您将水倒入系统中并在 处放水。在中间的每个节点处，流入的水量必须与流出的水量相同。`S``T``S``T`**`S``T`**

 **试着说服自己一个流程对应于你的原始集合的匹配。（给定一个流，你如何得到一个匹配？给定一个匹配，你如何得到一个流？）

最后，要在图中找到最大流量，可以使用[Ford-Fulkerson 算法](http://en.wikipedia.org/wiki/Ford-Fulkerson_algorithm)。上面的维基百科页面用伪代码很好地描述了它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T19:19:17.347

[是的，如果您已经有解决最大流问题的代码，您可以使用它来解决二分匹配问题，方法是按照本](http://oucsace.cs.ohiou.edu/~razvan/courses/cs404/lecture21.pdf)讲座末尾所示的方式转换图形，但如果您从头开始，这可能不是正确的方法。如果您只想实现一些相当简单的代码来解决不太庞大的示例问题，那么最好使用[此处](http://www.maths.lse.ac.uk/Courses/MA314/matching.pdf)概述的简单扩充路径方法。这为您提供了一种 O(|V||E|) 方法，该方法非常容易编码，并且适用于除非常大的图形之外的所有图形。如果你想要在最坏情况下性能更好的东西，你可以试试[Hopcraft-Karp](http://en.wikipedia.org/wiki/Hopcroft%E2%80%93Karp_algorithm)算法，它一次找到多个增广路径并且具有 O(sqrt(|V|)|E|) 运行时间限制，但是关于它的 Wikipedia 文章指出：

> 几位作者已经对二分匹配算法进行了实验比较。他们的结果总体上倾向于表明，Hopcroft-Karp 方法在实践中不如理论上那么好：它在寻找增强路径的更简单的广度优先和深度优先策略以及推送重新标记技术方面都优于.

在任何情况下，在尝试解决 Hopcraft-Karp 或 Wikipedia 文章参考文献中提到的一种可推相关技术之前，您绝对应该理解并能够实现一种简单的增广路径方法。

编辑：由于某种原因，上面的链接没有正确显示。以下是有问题的网址：（[http://oucsace.cs.ohiou.edu/~razvan/courses/cs404/lecture21.pdf](http://oucsace.cs.ohiou.edu/~razvan/courses/cs404/lecture21.pdf)），（[http://www.maths.lse.ac.uk/Courses/MA314 /matching.pdf](http://www.maths.lse.ac.uk/Courses/MA314/matching.pdf)）和（[http://en.wikipedia.org/wiki/Hopcroft](http://en.wikipedia.org/wiki/Hopcroft) –Karp_algorithm）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-11T06:04:01.947

[QuickGraph](http://quickgraph.codeplex.com/)库包括一个二分匹配算法，我刚刚研究并检查了一个修复程序。它包装了 Edmonds Karp 最大流量算法。

到目前为止，该算法的唯一文档是我添加的单元测试。如果有人想添加一个（希望更快）不简单地包装 maxflow 算法的实现，请与我联系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-17T03:26:31.540

这是最大二分匹配的流算法的实验研究：

```
@article{cherkassky98,
   author = {Boris V. Cherkassky and Andrew V. Goldberg and Paul Martin and Joao C. Setubal and Jorge Stolfi},
   title = {Augment or Push:  A Computational Study of Bipartite Matching and Unit Capacity Flow Algorithms},
   journal = {Journal of Experimental Algorithmics},
   volume = 3,
   number = 8,
   year = 1998
} 
```

获胜者是一个推重标签算法，我相信它是 Andrew Goldberg 的“BIM”包的实现，你可以在这里下载：

[http://www.avglab.com/andrew/soft.html](http://www.avglab.com/andrew/soft.html)

请注意，如果您自己编写解决方案很重要，那么您可能希望像 Jesse 建议的那样选择 Ford-Fulkerson。如果你这样做，我建议你使用广度优先搜索，而不是深度优先搜索，来查找增广路径（原因在上面的文章中解释过）。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2017-11-21T06:40:16.873

```
#include<stdio.h> 
#include<conio.h> 

void main() 
{ 
    int m,n,x,y,i,j,i1,j1,maxvalue;
    float s[10][10] = {0,0};
    int s2[10][10] = {0,0};
    float f[20][20] = {0,0};
    float f1[20][20] = {0,0};
    float f2[20][20] = {0,0};

    printf("\nEnter Number of Jobs(rows) and Machines(columns) of Matrix:\n"); 
    scanf_s("%d%d",&m,&n); 
    printf("\nEnter the Pij elements of matrix:\n"); 
    for(x=1;x<m+1;++x)
        for(y=1;y<n+1;++y)
            scanf("%f", &s[x][y]);
    //Find sum of each row
    for(x=1;x<m+1;++x)
    {
        s[x][n+1]=0;
        for(y=1;y<n+1;++y)

s[x][n+1]=s[x][n+1]+s[x][y];

//Find sum of each column
    for(y=1;y<n+1;++y)
    {
        s[m+1][y]=0;
        for(x=1;x<m+1;++x)
            s[m+1][y]+=s[x][y];
    }
    printf("\nMatrix s, Row Sum (Last Column)   and Column Sum (Last Row) : \n");

    printf("\ns:\n");
    for(x=1;x<m+2;++x)
    {
        for(y=1;y<n+2;++y)
            printf(" %2.0f  " , s[x][y]);
        printf("\n");
    }
    //Print sum of each column
    /*x=n+1;
    for(y=1;y<m+1;++y)
    printf(" %2.0f  " , s[x][y]);*/
    printf("\n");

    maxvalue = s[1][1];
    for(x=1; x<m+2; ++x)
        for(y=1; y<n+2; ++y)
        {

if(maxvalue < s[x+1][y+1])
                maxvalue = s[x+1][y+1];
        }

        printf("\n");
        printf("maxvalue = %d" , maxvalue);

        printf("\nd1:\n");
        float d1[20][20] = {0,0};
        for(i=1;i<=m;++i)
        {
            for(j=1;j<=m;++j)
            {
                if(i==j)
                    d1[i][j] = maxvalue - s[i][n+1];
                printf(" %2.0f  " , d1[i][j]);
            }
            printf("\n");
        }

        printf("\nd2\n");
        float d2[20][20] = {0,0};
        for(i=1;i<=n;++i)
        {
            for(j=1;j<=n;++j)
            {
                if(i==j)
                    d2[i][j] = maxvalue - s[m+1][j];
                printf(" %2.0f  " , d2[i][j]);

            }
            printf("\n");
        }

//row diff:
        printf("\n\nRow diff:\n");
        float r[20]= {0};
        for(i=1;i<=n;i++)
            for(j=1;j<=n;j++)
            {
                if(i == j)
                {
                    r[i] = maxvalue - d2[i][j];
                    printf("%f ",r[i]);
                }
            }

            //col diff:
            printf("\n\nCol diff:\n");
            float c[20]= {0};
            for(i=1;i<=m;i++)
                for(j=1;j<=m;j++)
                {
                    if(i == j)
                    {
                        c[i] = maxvalue - d1[i][j];
                        printf("%f ",c[i]);
                    }

                }

                //assignment matrix:
                float am[20][20]={0}; 

                i=j=1; 
ITERATION1: 
                if((c[i]<r[j]) && i<=m && j<=n) 
                { 
                    am[j][i]=c[i]; 
                    r[j]=r[j]-c[i]; 
                    c[i]=0; 
                    i++; 
                } 
                else if((c[i]>r[j]) && i<=m && j<=n) 
                { 
                    am[j][i]=r[j]; 
                    c[i]=c[i]-r[j]; 
                    r[j]=0; 
                    j++; 
                } 
                else if((c[i]==r[j]) && i<=m && j<=n) 
                { 
                    am[j][i]=r[j]; 
                    c[i]=r[j]=0; 
                    i++;j++; 
                } 
                else 

                    goto END; 
                for(int z=0;z<=n;z++) 
                { 
                    if(c[z]==0) 
                        continue; 

                    else 
                        goto ITERATION1; 
                } 

                for(int b=0;b<=m;b++) 
                { 
                    if(r[b]==0) 
                        continue; 
                    else 
                        goto ITERATION1; 
                } 

END: 
                printf("\n\nASSIGNMENT MATRIX:\n"); 

                for(i=1;i<=n;i++) 
                { 
                    for(j=1;j<=m;j++) 
                    { 
                        printf(" %2.0f  ",am[i][j]); 
                    } 
                    printf("\n"); 
                } 

                printf("\n\nf:\n");
                for(i=1; i<(m+n)+1;++i)
                {
                    for(j=1;j<(m+n)+1;++j)
                    {
                        if((i<=m) && (j<=n))

                    {
                            f[i][j]=s[i][j];
                        }
                        if((i<=m)&&(j>n))
                        {
                            f[i][j] = d1[i][j-n];
                        }
                        if((i>m)&&(j<=n))
                        {
                            f[i][j] = d2[i-m][j];
                        }
                        if((i>m)&&(j>n))
                        {
                            f[i][j] = am[i-m][j-n];
                        }

                        printf(" %2.0f  " , f[i][j]);
                    }
                    printf("\n");
                }

                //printf("\n\nf1:\n");
                for(i=1; i<(m+n)+1;++i)
                {
                    for(j=1;j<(m+n)+1;++j)
                    {
                        f1[i][j]=f[i][j];

                        //printf(" %2.0f  " , f1[i][j]);

                }
                    //printf("\n");
                }

                int cnt = 0;
ITERATION2: 
                for(i=1; i<(m+n)+1;++i)
                {
                    for(j=1;j<(m+n)+1;++j)
                    {
                        f2[i][j] = -1;
                    }
                }

                for(i=1; i<(m+n)+1;++i)
                {
                    for(j=1;j<(m+n)+1;++j)
                    {

                        if(f1[i][j]!=0 && f2[i][j]!=0)
                        {
                            f2[i][j] = f1[i][j];
                            for(j1=j+1;j1<(m+n)+1;++j1)
                                f2[i][j1] = 0;
                            for(i1=i+1;i1<(m+n)+1;++i1)
                                f2[i1][j] = 0;
                        }
                    }
                }

                //printf("\n\nf2:\n");
                for(i=1; i<(m+n)+1;++i)
                {
                    for(j=1;j<(m+n)+1;++j)
                    {
                        if(f2[i][j] == -1)
                        {
                            f2[i][j] = 0;
                        }
                        //printf(" %2.0f  " , f2[i][j]);
                    }
                    //printf("\n");
                }

                //printf("\n\nf1:\n");
                for(i=1; i<(m+n)+1;++i)
                {
                    for(j=1;j<(m+n)+1;++j)

                    {
                        if(f2[i][j] != 0)
                        {
                            f1[i][j] = f1[i][j] - 1;
                        }
                        //printf(" %2.0f  " , f1[i][j]);
                    }
                    //printf("\n");
                }

                cnt++;

                printf("\nITERATION - %d", cnt);
                printf("\n\Gant Chart:\n");
                for(i=1; i<=m;++i)
                {
                    for(j=1;j<=n;++j)
                    {
                        if(f2[i][j] != 0)
                        {
                            s2[i][cnt] = j;
                            printf(" J%d -> M%d", i,j);
                        }
                    }
                    printf("\n");
                }

                int sum = 1;
                for(i=1; i<(m+n)+1;++i)
                {

                    for(j=1;j<(m+n)+1;++j)
                    {   
                        sum = sum + f1[i][j];
                    }
                }

                if(sum>1)
                    goto ITERATION2;
                else
                    goto END2;
END2:

                printf("\n\Final Gant Chart:\n");
                for(i=1; i<=m;++i)
                {
                    for(j=0;j<=cnt;++j)
                    {
                        if(j == 0 )
                            printf(" J%d -> ", i);
                        else
                        {
                            if(s2[i][j] !=0)
                                printf(" M%d ", s2[i][j]);
                            else
                                printf(" %2c ", ' ');
                        }
                    }
                    printf("\n");
                }

                getch();
} 
```

# .net - 确定 ADO.NET 中是否存在列的通用方法

> ID：878672
> 
> 赞同：1
> 
> 时间：2009-05-18T16:50:15.043
> 
> 标签：.net, ado.net

我正在使用 2.0 框架，并且正在寻找一种通用方法来确定表中是否存在列。我想将此代码与多种数据库类型和提供程序一起使用。

GetSchema 方法将返回架构信息，但信息的格式和限制返回信息的数据似乎都是特定于提供者的。

我见过的其他解决方案似乎归结为 Select * from table 然后搜索结果以查看该列是否存在。这将起作用，但是为整个表发出选择以查看列是否存在似乎很疯狂。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T16:53:26.643

我马上能想到的两个选择：

使用作为 sql 标准一部分的 INFORMATION_SCHEMA 视图会很好，但并非所有数据库系统都实现它们。但是，如果您关心的一组数据库确实实现了它，那是您的最佳选择。

另一种选择是接受您的查询，但在其上添加一个“WHERE 1 = 0”子句，这样它就不会返回任何行。在这种情况下，ADO.NET 仍将返回架构

编辑：实际上，第二种方法会给你列的存在及其数据类型。但是，我不确定您是否会获得完整的模式信息，例如最大长度、可空等。INFORMATION_SCHEMA 视图确实是最好的选择，但 ORACLE 没有实现它们。

我确实遇到过这个：

[http://database-geek.com/2009/04/30/oracle-information_schema/](http://database-geek.com/2009/04/30/oracle-information_schema/)

这是在 Oracle 中模拟 INFORMATION_SCHEMA 视图的开源工作。在这一点上，我不知道这项工作有多完整或有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T16:54:04.490

而不是 select * from the table 你可以这样做：

```
select * from table
where true=false 
```

这将使 ADO 看到列的名称而不返回任何数据。可能有更好更通用的方法来查询跨数据库提供程序的系统表，但我不知道。

# visual-studio - 我可以做些什么来让 Visual Studio 2008 中的“帮助”加载速度更快吗？

> ID：878681
> 
> 赞同：2
> 
> 时间：2009-05-18T16:52:03.293
> 
> 标签：visual-studio, optimization, ide

在 Visual Studio 中加载帮助或单击 F1 加载速度非常慢，并且一直在我安装它的任何 PC 上。是否有任何优化可以用来缓解这种痛苦？

[这与Visual Studio 优化](https://stackoverflow.com/questions/8440/visual-studio-optimizations)不是同一个问题，我只是想通过帮助加载来解决问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T17:00:50.903

Visual Studio（至少 2005 和 2008）默认在本地帮助之前搜索联机帮助。

安装 Visual Studio 时是否在本地安装了帮助？如果您这样做了，是否配置为在搜索在线帮助之前搜索本地帮助？

仅供参考，在 VS2005 和 VS2008 中，设置位于工具 | 选项 | 环境 | 帮助 | 在线的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T16:59:20.547

这是微软提醒您本杰明富兰克林名言的方式：

> “能有耐心的人，就能得到他想要的。”</p>

...在这种情况下，***Help***。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-05-18T16:57:45.760

请参考：[关于提高 VS 速度的一些指示。](https://stackoverflow.com/questions/8440/visual-studio-optimizations)

编辑：重新阅读问题后，我发现您正在寻找加速**HELP**，而不是一般的 IDE。

# apache-flex - flex datagrid - 使网格高度动态和包含它的组件

> ID：878683
> 
> 赞同：2
> 
> 时间：2009-05-18T16:52:58.937
> 
> 标签：apache-flex, dynamic, datagrid, height

你好，

我想构建一个具有动态高度值的数据网格，因为行数总是不同的。我还想将高度传达回保持它的组件，以便它也随着数据网格一起增长。任何人都可以帮助我找到创建这样一个动态数据网格的最佳方法。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-04-19T23:07:17.657

The DataGrid's height is controlled by its `rowCount` property. If you want your DataGrid to always be exactly high enough to show all the contained elements (and, for example, wrap it inside a Scroller to handle the situation where the DataGrid is too big for the available space, rather than having the DataGrid itself scroll), simply bind it to an appropriate property of your data source:

```
<mx:DataGrid dataProvider="{myData}" rowCount="{myData.length}"/>
<fx:Script>
    <![CDATA[
        import mx.collections.ArrayCollection;

        protected var myData:ArrayCollection;
    ]]>
</fx:Script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T17:11:23.517

*你可以说得更详细点吗？你是说你不希望数据网格滚动吗？如果行数超过屏幕上可以看到的行数怎么办？- 一旦你回答了这些问题，我可以编辑这个更具体的答案。*

至于从您的自定义 DataGrid 实现到父对象的通信，您要做的是广播一个指示高度应该改变的事件，并附加一些值 - 行数或新高度，可能 - 到那个事件。

在学习了 Flex 中事件广播的基础知识后，我意识到它们过于复杂，并学习了[Swiz 框架](http://code.google.com/p/swizframework/)，它使事件广播和处理尽可能简单（以及其他一些很棒的东西）。

# java - 当没有这样的类时，如何使用 ant/javac 编译“import pack.*”？

> ID：878685
> 
> 赞同：0
> 
> 时间：2009-05-18T16:53:09.530
> 
> 标签：java, ant, batch-file, jar, javac

对于我的公司，我正在制作一个批处理脚本来为我们当前的项目编译并编译最新版本的代码。我正在使用 Ant 构建类文件，但遇到了一个奇怪的错误。其中一个源文件从没有文件（只有文件夹）的目录中导入 .*，事实上，所需的文件夹是在之后立即导入的。

它在 Eclipse 中编译得非常好，但我正在使用 Ant 脚本在 IDE 之外对其进行自动化，Javac 在遇到这一行时会抛出错误。是否有任何自动化程序可以用来在 Ant 中使用 javac 忽略/抑制此错误？

我什至会在导入目录中创建一个虚拟文件，但所有这些都包含在一个 Jar 文件中，我不希望必须解压缩然后用虚拟文件重新压缩。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-13T01:09:55.223

拥有一个空的（包）目录不会导致错误。确保将该包层次结构的（根）目录添加到为 javac 指定的类路径中。

例如。如果包是 com.stuff 并且目录是 /java/src/com/stuff 那么您需要将 /java/src 添加到 javac 类路径。

或者只是删除导入，如果它是从一个空目录导入 .* 那么它是多余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T21:13:27.197

错误是什么？

也许这超出了您的问题范围，但您是否考虑过持续集成解决方案？我们使用 LuntBuild 并且非常满意（也存在其他替代方案：CruiseControl、Hudson、QuickBuild）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T21:55:09.843

检查以确保您在 Eclipse 和 Ant 中使用相同版本的 JDK。也许这是JDK版本之间的差异？

唯一的其他选择是传递给 javac 的参数有所不同。

我敢打赌是前者，而不是后者。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-04-08T20:30:33.953

要在 Eclipse 之外构建 Eclipse 项目，请查看[ant4eclipse](http://ant4eclipse.org)项目。

# php - 多维混合关联/数字数组移位

> ID：878692
> 
> 赞同：3
> 
> 时间：2009-05-18T16:54:01.680
> 
> 标签：php, multidimensional-array, associative-array

我有一个问题需要尽快解决。如果我有时间重写整个脚本我会的，但这就是程序员的生活，对吧？任何人，我已经接管了一个项目，并且我有一个多维混合关联/数字数组，如下所示：

```
Array
(
    [item1] => Array
        (
            [dataset] => Array()
            [3] => Array()
            [7] => Array()
        )
    [item2] => Array
        (
            [dataset] => Array()
            [4] => Array()
            [19] => Array()
            [2] => Array()
        )
) 
```

我需要做的是将每个**itemX索引中的****数据集**索引转换为最后一个索引以产生以下结果：

 **```
Array
(
    [item1] => Array
        (
            [3] => Array()
            [7] => Array()
            [dataset] => Array()
        )
    [item2] => Array
        (
            [4] => Array()
            [19] => Array()
            [2] => Array()
            [dataset] => Array()
        )
) 
```

一些可能有助于实现这一点的事情是，我***知道***数据**集**索引将始终是**itemX**索引中的第一个索引，并且键将始终是“数据集”，而其他索引将始终是数字索引。有没有办法在 php 中做到这一点？它是一个混合数组的事实让我很震惊。我不能让数字索引重置并从 0 开始。它们的顺序是否被移动并不重要，只是它们都在“数据集”索引之前。也许这只是那些日子之一......：\任何建议或意见都非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T16:58:49.627

像这样循环所有元素：

```
foreach ($all_items as $key =>$items) {
   $dataset = $items['dataset'];
   unset($all_items[$key]['dataset']); // Removing it (from the top)
   $all_items[$key]['dataset'] = $dataset; // Adding it again (at the bottom)
} 
```

取消设置 'dataset' 元素并再次添加它会导致该元素被添加到底部。

It's important that you modify the original array directly, not the $items from the foreach, because those changes will not affect the original array.

# java - Swing 组件何时“可显示”？

> ID：878694
> 
> 赞同：6
> 
> 时间：2009-05-18T16:54:27.437
> 
> 标签：java, swing, graphics

有没有办法（例如，通过事件？）来确定 Swing 组件何时变为“可显示”——根据[`Component`.getGraphics](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Component.html#getGraphics())的 Javadocs吗？

我尝试这样做的原因是我可以调用`getGraphics()`，并将其传递给组件的“渲染策略”。

我试过添加一个`ComponentListener`，但`componentShown`似乎没有被调用。还有什么我可以尝试的吗？

谢谢。

此外，是否可以保留`Graphics`我收到的对象？或者是否有可能在生命周期的后期创建一个新的`Component`？（例如，在调整大小/隐藏之后？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T17:41:59.103

添加层次监听器

```
public class MyShowingListener {
private JComponent component;
public MyShowingListener(JComponent jc) { component=jc; }

public void hierarchyChanged(HierarchyEvent e) {
    if((e.getChangeFlags() & HierarchyEvent.SHOWING_CHANGED)>0 && component.isShowing()) {
        System.out.println("Showing");
    }
}
}

JTable t = new JTable(...);
t.addHierarchyListener(new MyShowingListener(t)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T17:01:09.607

您可以侦听调整大小事件。当一个组件首次显示时，它的大小从 0,0 调整为布局管理器确定的任何值（如果有的话）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T16:59:16.240

您需要检查组件层次结构。调用[AncestorListener.ancestorAdded](http://java.sun.com/javase/6/docs/api/javax/swing/event/AncestorListener.html#ancestorAdded(javax.swing.event.AncestorEvent))后检查。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T20:53:43.460

我一直使用 Coomponent.addNotify 来了解组件何时可以渲染。不确定是否是最好的方法，但它对我有用。当然，您必须对组件进行子类化。

Component.isDisplayable 应该是正确的答案，但我知道它并没有像我想象的那样对我有用（我不记得为什么，但有一些东西我切换到 addNotify）。

查看 SUN 的源代码，我可以看到 addNotify 触发 HierarchyEvent.SHOWING_CHANGED 所以这是最好的通知方式。

# .net - 如何在 MVC 中将 XML 字符串作为操作结果返回

> ID：878695
> 
> 赞同：56
> 
> 时间：2009-05-18T16:55:01.523
> 
> 标签：.net, xml, asp.net-mvc, actionresult

> **可能重复：**
> [从 ASP.NET MVC 中的控制器操作返回 XML 的最佳方法是什么？](https://stackoverflow.com/questions/134905/what-is-the-best-way-to-return-xml-from-a-controllers-action-in-asp-net-mvc)

我能够将 JSON 和部分视图 (html) 作为有效的 ActionResult 返回，但是如何返回 XML 字符串？

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2009-05-18T17:01:56.563

您可以使用`return this.Content(xmlString, "text/xml");`从操作中返回构建的 XML 字符串。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-18T18:55:35.727

对于 JSON/XML，我编写了一个[XML/JSON 操作过滤器](http://aleembawany.com/2009/03/27/aspnet-mvc-create-easy-rest-api-with-json-and-xml/)，它可以很容易地处理，而无需在您的操作处理程序中处理特殊情况（这就是您似乎正在做的事情）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-10-14T18:26:54.143

另一种方法是使用 XDocument：

```
using System.Xml.Linq;

public XDocument ExportXml()
{
    Response.AddHeader("Content-Type", "text/xml");

    return XDocument.Parse("<xml>...");
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-03T22:32:43.283

如果您正在使用 Linq-to-XML 构建 XML，[请在此处查看我的答案](https://stackoverflow.com/a/12718046/24874)。它允许您编写如下代码：

```
public ActionResult MyXmlAction()
{
    var xml = new XDocument(
        new XElement("root",
            new XAttribute("version", "2.0"),
            new XElement("child", "Hello World!")));

    return new XmlActionResult(xml);
} 
```

# javascript - 网页上的任何文本都可以 以编程方式选择标签或标签？

> ID：878697
> 
> 赞同：3
> 
> 时间：2009-05-18T16:55:37.090
> 
> 标签：javascript, dhtml, selected

网页上的任何文本都可以

以编程方式选择标签或标签？input 元素和 textarea 元素可以很容易地做到这一点，但在其他情况下 text 呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T17:00:51.263

[您可以在此处](http://www.java2s.com/Code/JavaScriptReference/Javascript-Properties/innerTextExample.htm)`<p>`找到从标签获取内部文本的示例。与.`<span>`

要设置它，您只需要分配 InnerText 属性。

如果您的 javascript 片段超出范围（在函数等中），请使用文档全局对象的[GetElementById](http://www.w3schools.com/HTMLDOM/met_doc_getelementbyid.asp)方法来检索您的`<p>`或`<span>`其他内容 - 事实上，只要您为元素分配 id，您就可以对任何元素执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-19T01:19:48.307

JohnIdol 的答案将适用于除 Firefox 之外的所有现代浏览器。请参阅[此处](http://www.quirksmode.org/dom/w3c_html.html#t04)以获取有关`innerText`. 正如链接还显示的那样，您可以使用`textContent`在 FF 中获得相同的东西。

使用的建议`getElementById`是一个很好的建议，但值得注意的是，如果元素没有附加 id，您仍然可以访问它的文本，这通常是使用`<p>`和`<span>`标签的情况。例如，如果您知道第 4 个`<p>`标签有您想要的文本，您可以执行以下操作：

```
var p = document.getElementsByTagName('p')[3];
var text = p.innerText || p.textContent; 
```

# html - CSS：强制文本换行（或仅由其一个子项定义元素宽度）

> ID：878703
> 
> 赞同：5
> 
> 时间：2009-05-18T16:57:02.033
> 
> 标签：html, css, image

好吧，这对我来说很奇怪。这是我正在使用的 HTML 元素：

[大声笑 http://www.ubuntu-pics.de/bild/14571/screenshot_030_0O2o3D.png](http://www.ubuntu-pics.de/bild/14571/screenshot_030_0O2o3D.png)

一张带标题的照片。理想情况下，我希望它通过纯 CSS 看起来像这样：

[替代文字 http://www.ubuntu-pics.de/bild/14572/screenshot_031_mp84u7.png](http://www.ubuntu-pics.de/bild/14572/screenshot_031_mp84u7.png)

图像父元素的宽度需要取决于图像的大小。

我可以更改所有我需要的标记。（文本当前不在其自己的 div 中，但如有必要，可以。） CSS 中有什么方法可以实现这一点吗？我的印象是我需要“强制”文本尽可能地换行（这似乎无法实现），或者使整个元素的宽度仅取决于一个元素而忽略另一个元素（我从未听说过之前的）。

*有*没有真正的方法？还是我需要使用神奇的 Javascript 来代替？（JS解决方案相当简单，但相当蹩脚......）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T17:27:52.363

查看这篇[很棒的文章](http://www.cs.tut.fi/~jkorpela/www/captions.html)，了解处理带有字幕的图像的最佳方法。

就个人而言，这是您必须接受并继续使用的情况之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T17:12:33.937

使用 table-layout:fixed 将容器制作成表格并将图像放在第一行。您也可以使用 display:table-* 属性（以及用于 IE6 兼容性的 IE7-js 库）使用纯 CSS 执行此操作。

table-layout:fixed 所做的是，一旦知道该列中第一个单元格的宽度，表格绘制算法就会锁定每个表格列的宽度。标题将无处可扩展，因此它将包裹到图像的宽度（第一个单元格）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:25:32.257

`table`答案会奏效。容易地。我不*鼓励*使用它，但易用性确实有优点。我打算建议使用`clip:`CSS 属性，但我无法让它在我的本地机器上工作（出于某种原因，尽管它完美地呈现了cssplay.co.uk[上的](http://www.cssplay.co.uk/ "Link to site hosting the example, 'css play.'")[示例](http://www.cssplay.co.uk/menu/clip_gallery "链接到正在使用的“剪辑”示例。")）。

这样做的缺点是它可能仅在您为容器定义固定宽度时才有效。不过，我相信一定有办法。我会继续寻找。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T22:11:41.977

好吧，看起来没有简单的解决方案可以解决。谢谢你帮我解决这个问题：）

我认为，考虑到我将如何存储这些图像，访问宽度不会涉及不断的重新计算。我可能只是使用那个服务器端的魔法。

谢谢！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T22:43:12.630

这是一个可能对您不起作用的解决方案，即使它确实产生了您请求的布局：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
<style>
div.a {float: left;
        position:relative;}

div.b {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        text-align: center;
        background-color:gray;}

</style>
</head>

<body>

<div class="a">
<img src="http://stackoverflow.com/content/img/so/logo.png" alt="">
<div class="b">Caption text Caption text Caption text Caption text Caption text </div>
</div>

</body>
</html> 
```

如果您在 div a 下方放置一些内容，您会看到不满意的原因。它将与标题重叠，因为绝对定位的标题没有垂直扩展父 div。如果您在下面有足够的空白空间或者您愿意保留它，它仍然可能对您有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T04:18:46.600

我想出了一个可行且相当干净的解决方案。

该解决方案使用一个表格（如果您愿意，可以使用带有 display:table 的 div）并添加第二列以将第一个单元格“推”到它真正需要的最小空间中。表格可以设置为 1px 宽度以阻止它在整个页面中增长。我整理了一个演示来展示这一点：

[http://test.dev.arc.net.au/caption-layout.html](http://test.dev.arc.net.au/caption-layout.html)

在 IE8、Firefox 和 Safari/Win 中测试和工作

# javascript - 使用 JQuery 的模态确认框是否可行？

> ID：878710
> 
> 赞同：33
> 
> 时间：2009-05-18T16:58:22.407
> 
> 标签：javascript, jquery, modal-dialog

环顾四周，似乎无法为此找到 JQuery 解决方案（*也许它只是 JavaScript 的限制*）：

```
<a href="somelink.php" 
   onclick="return confirm('Go to somelink.php?');">Click Here</a> 
```

在上面的例子中，当用户点击链接时，如果用户在确认框中点击 OK，它只会转到其 href。

我想要做的是使用弹出 div 获得更现代的外观。也许是这样的：

```
<a href="somelink.php" 
   onclick="return jq_confirm('Go to somelink.php?');">Click Here</a> 
```

（其中**jq_confirm**是一个自定义的 JQuery 确认函数，它会弹出一个带有 YES/NO 或 OK/CANCEL 按钮对的漂亮 div）。

**但是，我似乎找不到任何这样的东西。**

我查看了一些提供类似功能的 JQuery 小部件库等，但没有一个会等待用户的响应（*至少，不是在上述场景中*），而是他们只是继续并将用户带到链接（*或运行嵌入在链接的 href='' 片段中的任何 JavaScript*）。我怀疑这是因为虽然您可以将回调函数附加到许多这些小部件以返回真/假值，但**onclick**事件不会等待响应（*回调是异步*的），从而破坏了确认框的目的。

我需要的是默认的**confirm()**命令提供的相同类型的暂停所有 JavaScript（模式）功能。这在 JQuery 中（*甚至在 JavaScript 中*）是否可行？

因为我不是 JavaScript 和 JQuery 方面的专家，所以我听从你们那里的专家。欢迎任何 JQuery（*甚至纯 JavaScript*）解决方案（*如果可能*）。

谢谢 -

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-09T21:29:37.913

我只需要解决同样的问题。我最终使用了[JQuery UI](http://jqueryui.com/home)[`dialog`](http://jqueryui.com/demos/dialog/)中的小部件。我能够在不使用回调的情况下实现这一点，但需要注意的是，必须在事件处理程序中对要使用确认功能的链接进行部分初始化（如果您想将其用于多个链接）。这是因为必须将链接的目标 URL 注入到确认按钮单击的事件处理程序中。 `dialog``click`

这是我的解决方案，抽象出来以适合示例。我使用 CSS 类来指示哪些链接应该具有确认行为。

```
<div id="dialog" title="Confirmation Required">
  Are you sure about this?
</div>

<script type="text/javascript">
  $(document).ready(function() {
    $("#dialog").dialog({
      autoOpen: false,
      modal: true
    });

  $(".confirmLink").click(function(e) {
    e.preventDefault();
    var targetUrl = $(this).attr("href");

    $("#dialog").dialog({
      buttons : {
        "Confirm" : function() {
          window.location.href = targetUrl;
        },
        "Cancel" : function() {
          $(this).dialog("close");
        }
      }
    });

    $("#dialog").dialog("open");
  });

  }); // end of $(document).ready

</script>

<a class="confirmLink" href="http://someLinkWhichRequiresConfirmation.com">Click here</a>
<a class="confirmLink" href="http://anotherSensitiveLink">Or, you could click here</a> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-18T17:01:29.293

查看[http://www.84bytes.com/2008/06/02/jquery-modal-dialog-boxes/](http://www.84bytes.com/2008/06/02/jquery-modal-dialog-boxes/)

他们有各种各样的 JQuery 模式框。

我想你应该看看[http://www.ericmmartin.com/simplemodal/](http://www.ericmmartin.com/simplemodal/)

> JavaScript 确认功能的模式对话框覆盖。演示 onShow 的使用以及如何显示模式对话框确认而不是默认的 JavaScript 确认对话框。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-27T09:44:03.883

您在[jQuery UI 网站上看到](http://jqueryui.com/)[jQuery 模态对话框](http://jqueryui.com/demos/dialog/)了吗？

*   **[模态确认对话框演示](http://jqueryui.com/demos/dialog/#modal-confirmation)**

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-01-25T08:46:06.637

我在这里写了关于这个问题的解决方案的博客：http: [//markmintoff.com/2011/03/asp-net-jquery-confirm-dialog/](http://markmintoff.com/2011/03/asp-net-jquery-confirm-dialog/)

尽管这篇文章是面向 ASP.Net 的，但它可以很容易地适应 php。它依赖于通过返回 false 来防止点击，并且当用户点击“确定”或“是”或你有什么时；只需再次单击链接或按钮。

```
var confirmed = false;
function confirmDialog(obj)
{
    if(!confirmed)
    {
        $( "#dialog-confirm" ).dialog({
            resizable: false,
            height:140,
            modal: true,
            buttons: {
                "Yes": function()
                {
                    $( this ).dialog( "close" );
                    confirmed = true; obj.click();
                },
                "No": function()
                {
                    $( this ).dialog( "close" );
                }
            }
        });
    }

    return confirmed;
} 
```

试一试，让我知道你的想法。我希望这能解决你的问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-27T09:37:46.547

您应该能够重写标准的 window.confirm 函数来编写以下代码。

```
window.confirm = modalConfirm 
```

那么你需要做一个这样的功能

```
function modalConfirm(message){
  // put your code here and bind "return true/false" to the click event
  // of the "Yes/No" buttons.
} 
```

这应该可以，虽然我还没有测试过。我现在就要做这件事，并将让你们知道它是如何工作的。

编辑：我现在已经测试了上面的示例，但这是不可能的，您必须将回调函数传递给覆盖的确认函数，如下所示：

```
function modalConfirm(message, callback){
  ... 
  $("button.yes").click(function(){
     callback(result);
  });
  ...
} 
```

..使您对函数的调用如下所示：

```
confirm("Are you sure?", function(result){
  alert(result);
}); 
```

换句话说，不可能完全覆盖默认的 window.confirm 函数而不引起导致浏览器挂起的讨厌的循环。我认为您将不得不像上面那样修改您的确认电话。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-10-18T22:47:55.303

由于这个问题似乎缺少规范的答案：**没有办法像`alert`或`confirm`do**那样以编程方式暂停（和恢复）javascript 执行。

话虽如此，鉴于 javascript 的单线程性质，如今依赖这种行为通常被认为是不好的做法，而上述函数之所以会暂停执行，可能是因为它们是在 Web 仍处于早期阶段时设计的，并且后来保持不变以确保兼容性。由于现在的重点是编写尽可能多的非阻塞 js 代码，因此以编程方式停止 js 的功能不太可能适用于任何未来的 ECMAScript 规范，因此您最好的选择是重新设计您的网站以确保确认和警报对话框可以与后台运行的其他 javascript 代码共存。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-18T17:05:27.070

将重定向放在函数中，例如：

```
<script>
    function confirmRedirect(url, desciption) {
       if (confirmWindow(desciption)) {
           window.location = url;
       }
    }
</script> 
```

并这样称呼它：

```
<a href="javascript:confirmRedirect('somlink.php','Are you sure?')">Go!</a> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-05-11T15:40:11.053

我解决这个问题的方法是向对象添加一些任意数据，并在点击时检查该数据。如果存在，则正常使用该功能，否则使用是/否确认（在我的情况下使用 jqtools 覆盖）。如果用户单击是 - 在对象中插入数据，模拟另一次单击并擦除数据。如果他们单击否，只需关闭覆盖。

这是我的例子：

```
$('button').click(function(){
    if ($(this).data('confirmed')) {
        // Do stuff
    } else {
        confirm($(this));
    }
}); 
```

这就是我为覆盖确认功能所做的（使用 jquery 工具覆盖）：

```
window.confirm = function(obj){
    $('#dialog').html('\
        <div>\
            <h2>Confirm</h2>\
            <p>Are you sure?</p>\
            <p>\
                <button name="confirm" value="yes" class="facebox-btn close">Yes</button>\
                <button name="confirm" value="no" class="facebox-btn close">No</button>\
            </p>\
        </div>').overlay().load();
    $('button[name=confirm]').click(function(){
        if ($(this).val() == 'yes') {
            $('#dialog').overlay().close();
            obj.data('confirmed', true).click().removeData('confirmed');
        } else {
            $('#dialog').overlay().close();
        }
    });
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-09-21T03:45:45.060

建立在 Banu 的解决方案之上（非常感谢！），使其成为每个页面顶部的一个流行解决方案。将这段代码粘贴到里面：

```
$(document).ready 
```

并将“confirmLinkFollow”类添加到您要确认的所有链接：

```
$(".confirmLinkFollow").click(function(e) {
    e.preventDefault();
    var targetUrl = $(this).attr("href");
var $dialog_link_follow_confirm = $('<div></div>').
        html("<p>Are you sure?</p>").
        dialog({autoOpen: false,
        title: 'Please Confirm',
        buttons : {
            "Confirm" : function() { 
                window.location.href = targetUrl; 
        },
        "Cancel" : function() { 
                $(this).dialog("close"); 
            }
        },

        modal: true,
    minWidth: 250,
    minHeight: 120
    }
    );

    $dialog_link_follow_confirm.dialog("open");
}); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-03-04T15:02:55.390

我有一个解决方案可以用来替换默认的 window.confirm 函数。它不需要您覆盖 window.confirm ，因为这并不完全可能。

我的解决方案允许您拥有像我这样的通用类，假设您放置在任何需要在处理之前进行确认的元素上的“确认操作”。该脚本非常简单，使用 jQuery、jQuery UI Dialog 和其他插件。

您可以在 jsFiddle 上找到完整的实现演示，[http://jsfiddle.net/74NDD/39/](http://jsfiddle.net/74NDD/39/)。

用法：

*   在您的 html 头中或在您的 javascript 中的任何其他点击绑定之前添加此 javascript 代码。

    ```
    $("#dialog:ui-dialog").dialog("destroy");

    $('.confirm-action').live('click', function(e) {
        $self = $(this);

        if (e && e.stopImmediatePropagation && $self.data('confirmed') !== true) {
            e.stopImmediatePropagation();

            $('#confirm-action-dialog').dialog({
                height: 110,
                modal: true,
                resizable: false,
                draggable: false,
                buttons: {
                    'Yes': function() {
                        $(this).dialog('close');
                        $self.data('confirmed', true);
                        $self.click();
                    },
                    'No': function() {
                        $self.data('confirmed', false);
                        $(this).dialog('close');
                    }
                }
            });
        } else if ($self.data('confirmed') === true) {
            e = window.event;
            e.cancelBubble = false;
            $self.data('confirmed', false);
        }

        return false;
    }); 
    ```

*   将此 html 放在正文中的某个位置（默认情况下它是隐藏的）。

    ```
    <div style="display:none;" id="confirm-action-dialog" title="确认操作？">
        <p>
            <span class="ui-icon ui-icon-alert"></span>
            你确定你要继续吗？
        </p>
    </div>

    ```

*   将类 'confirm-action' 放在任何需要确认的元素上。

    ```
    确认动作
    ```

这个解决方案非常完美，因为它不会改变 jQuery 事件冒泡，它只是暂停（停止）所有其他事件，直到用户决定他们想要做什么。

我希望这对其他人有帮助，因为我找不到任何其他不需要我安装另一个 jQuery 插件或进行其他黑客攻击的解决方案。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-02-20T04:11:33.767

差不多三年后，我正在寻找类似的东西。由于我还没有找到一个可接受的“快速”解决方案，我写了一些非常接近 OP 标准的东西。我认为其他人将来可能会发现它很有用。

JavaScript 是事件驱动的，这意味着它不支持我们可以用来暂停纯 JavaScript 确认函数的任何类型的“等待”或“睡眠”循环。这些选项包括消耗处理器周期、使用浏览器插件或 AJAX。在我们日益移动的世界中，有时互联网连接参差不齐，这些都不是很好的解决方案。这意味着我们必须立即从“确认”函数返回。

但是，由于上面的代码片段中没有“假”逻辑（即用户点击“取消”时什么都不做），我们可以在用户点击“确定”时再次触发“点击”或“提交”事件。 " 为什么不在我们的“确认”函数中设置一个标志并根据该标志做出反应？

对于我的解决方案，我选择使用 FastConfirm 而不是“模态”对话框。您可以轻松地修改代码以使用您想要的任何内容，但我的示例旨在使用它：

[https://github.com/pjparra/Fast-Confirm](https://github.com/pjparra/Fast-Confirm)

由于这样做的性质，我看不到一个干净的方式来打包它。如果您觉得这有太多粗糙的边缘，请随意平滑它们或按照其他人推荐的方式重写您的代码：

```
/* This version of $.fn.hasEvent is slightly modified to provide support for
 * the "onclick" or "onsubmit" tag attributes. I chose this because it was
 * short, even if it is cryptic.
 *
 * Learn more about the code by Sven Eisenschmidt, which is licensed under
 * the MIT and GPL at:
 *     http://github.com/fate/jquery-has-event
 */
(function($) {
    $.fn.hasEvent = function(A, F, E) {
        var L = 0;
        var T = typeof A;
        E = E ? E : this;
        var V = (E.attr('on'+A) != undefined);
        A = (T == 'string') ? $.trim(A) : A;
        if (T == 'function')
            F = A, A = null;
        if (F == E)
            delete(F);
        var S = E.data('events');
        for (e in S)
            if (S.hasOwnProperty(e))
                L++;
        if (L < 1)
            return V; // = false;
        if (A && !F) {
            return V = S.hasOwnProperty(A);
        } else if(A && S.hasOwnProperty(A) && F) {
            $.each(S[A], function(i, r) {
                if(V == false && r.handler == F) V = true;
            });
            return V;
        } else if(!A && F) {
            $.each(S, function(i, s) {
                if (V == false) {
                    $.each(s, function(k, r) {
                        if (V == false && r.handler == F)
                            V = true;
                    });
                }
            });
        }
        return V;
    }
    $.extend($, {hasEvent: $.fn.hasEvent});
}) (jQuery);

/* Nearly a drop-in replacement for JavaScript's confirm() dialog.
 * Syntax:
 *   onclick="return jq_confirm(this, 'Are you sure that you want this?', 'right');"
 *
 * NOTE: Do not implement "false" logic when using this function. Find another way.
 */
var jq_confirm_bypass = false;
function jq_confirm(el, question, pos) {
    var override = false;
    var elem = $(el);

    if ($.fn.fastConfirm == undefined) {
        override = confirm(question);
    } else if (!jq_confirm_bypass) {
        if (pos == undefined) {
            pos = 'right';
        }

        elem.fastConfirm({
            position: pos,
            questionText: question,
            onProceed: function(trigger) {
                var elem = $(trigger);
                elem.fastConfirm('close');

                if (elem.hasEvent('click')) {
                    jq_confirm_bypass = true;
                    elem.click();
                    jq_confirm_bypass = false;
                }
                if (elem.hasEvent('submit')) {
                    jq_confirm_bypass = true;
                    elem.submit();
                    jq_confirm_bypass = false;
                }
                // TODO: ???
            },
            onCancel: function(trigger) {
                $(trigger).fastConfirm('close');
            }
        });
    }

    return override ? override : jq_confirm_bypass;
} 
```

所以... onclick="return confirm('你想测试这个吗？');" 会变成 onclick="return jq_confirm(this, 'Do you want to test this?');" pos/"right" 参数是可选的，专门用于快速确认。

当您单击时，jq_confirm() 函数将生成 jQuery 对话框并返回“false”。当用户单击“确定”时，jq_confirm() 设置一个标志，调用原始单击（或提交）事件，返回“true”，然后取消设置标志以防您想留在同一页面上。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2011-04-03T16:05:22.710

以下链接有一个用于确认框的 jQuery 插件，类似于在 JavaScript 中构造类似 confirm("something")

[http://labs.abeautifulsite.net/archived/jquery-alerts/demo/](http://labs.abeautifulsite.net/archived/jquery-alerts/demo/)

# php - 使用正则表达式检查字符串中的非法字符

> ID：878715
> 
> 赞同：1
> 
> 时间：2009-05-18T16:58:53.277
> 
> 标签：php, regex

我想在 PHP 中使用以下正则表达式检查任何非法字符。本质上，我只想允许字母数字和下划线 (_)。不幸的是，下面的代码似乎无法正常工作。如果字符串 $username 中有任何非法字符，它应该返回 true。但是，它仍然允许字符串中的任何字符。知道正则表达式有什么问题吗？

```
if ( !preg_match("/^[-a-z0-9_]/i", $username) )
{
    return true;
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-18T17:02:38.077

您的代码检查第一个字符是否无效。要检查是否存在*任何*无效字符，请否定您的字符类而不是函数返回并删除锚点：

```
if ( preg_match("/[^-a-z0-9_]/i", $username) )
{
    return true;
} 
```

当然，您也可以将其缩短为`/[^-\w]/`（“单词”字符是字母、数字和下划线），或者即使`/\W/`您不想允许破折号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T17:06:53.777

如果`$username`只有字母数字和下划线，它将返回 TRUE

```
if (preg_match("/^[a-z0-9_]+$/i", $username) )
{
    return true;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T17:03:47.433

您的表达式仅匹配 1 个字符。尝试**/^[-a-z0-9_]+$/i** '+' 匹配多于 1 个字符，'$' 是行尾锚

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T17:03:52.083

您也需要在最后锚定它，而不是只检查第一个字符。试试`"/^[-a-z0-9_]*$/i"`吧。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T17:04:39.943

您没有中继器。您需要一个中继器，例如 +。据我所见，如果不执行它，您检查行首和一个匹配 a-zA-Z0-9 和 _ 的字符，但在第一个字符之后没有任何内容。

# f# - 范围 A 到 B，其中 A > B 在 F#

> ID：878721
> 
> 赞同：8
> 
> 时间：2009-05-18T16:59:54.493
> 
> 标签：f#

我刚刚在 F# 中发现了一些我称之为怪癖的东西，并且想知道它是设计使然还是错误，如果是设计使然，为什么会这样...如果您编写任何范围表达式的第一项是大于第二项返回的序列为空。看一下反射器表明这是设计使然，但我真的找不到它必须如此的原因。重现它的一个例子是：

```
 [1..10] |> List.length
[10..1] |> List.length 
```

第一个将打印出 10，而第二个将打印出 0。在 F# CTP 1.9.6.2 中进行了测试。

**编辑**：感谢您建议明确范围，但仍有一个案例（这是启发我提出这个问题的原因）不会被涵盖。如果 A 和 B 是变量，并且没有一个总是大于另一个，尽管它们总是不同的怎么办？考虑到范围表达式似乎无论如何都没有在编译时得到优化，如果 A 和 B 是整数不允许负步骤，那么确定步骤（未明确指定）的代码有什么好的理由吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-18T17:27:10.443

正如其他答案所建议的那样，您可以这样做

```
[10 .. -1 .. 1] |> List.iter (printfn "%A") 
```

例如

```
[start .. step .. stop] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-22T15:46:58.980

> Adam Wright - 但是您应该能够更改您感兴趣的类型的绑定，使其以您喜欢的任何方式运行（包括如果 x > y 则倒计时）。

将亚当的建议转化为代码：

```
let (..) a b =
    if a < b then seq { a .. b }
             else seq { a .. -1 .. b }

printfn "%A" (seq { 1 .. 10 })
printfn "%A" (seq { 10 .. 1 }) 
```

这适用于 int 范围。查看 (..) 的源代码：您可以使用它来处理其他类型的范围，但不确定如何为您的特定类型获得正确的 -1 值。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T17:16:30.480

当然，“应该”发生什么是主观的。在我看来，正常范围表示法将 [x..y] 定义为所有大于或等于 x 且小于或等于 y 的元素的集合；如果 y < x 则为空集。在这种情况下，我们需要诉诸 F# 规范。

> 范围表达式 expr1 .. expr2 被评估为对重载运算符 (..) 的调用，其默认绑定在 Microsoft.FSharp.Core.Operators 中定义。这会为给定的开始 (expr1) 和结束 (expr2) 值之间的值范围生成一个 IEnumerable<_>，增量为 1。运算符需要存在静态成员 (..)（长名称 GetRange）在具有适当签名的 expr1 的静态类型上。
> 
> 范围表达式 expr1 .. expr2 .. expr3 被评估为对重载运算符 (.. ..) 的调用，其默认绑定在 Microsoft.FSharp.Core.Operators 中定义。这将使用 expr2 的增量为给定的开始 (expr1) 和结束 (expr3) 值之间的值范围生成一个 IEnumerable<_>。运算符要求在 expr1 的静态类型上存在具有适当签名的静态成员 (..)（长名称 GetRange）。

该标准似乎没有定义 .. 运算符（至少，我可以找到）。但是您应该能够更改您感兴趣的类型的绑定，使其以您喜欢的任何方式运行（包括如果 x > y 则倒计时）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T17:16:13.243

在 haskell 中，您可以编写`[10, 9 .. 1]`. 也许它在 F# 中的工作方式相同（我还没有尝试过）？

编辑：

似乎 F# 语法不同，可能类似于`[10..-1..1]`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T17:10:15.970

范围通常表示（在支持它们的语言和框架中）如下：

> `low_value <to> high_value`

你能给出一个很好的论据，为什么一个范围应该能够以不同的方式表达吗？既然您请求的范围从较高的数字到较低的数字，那么结果范围没有成员是不是没有理由？

# passwords - 登录物流

> ID：878722
> 
> 赞同：0
> 
> 时间：2009-05-18T17:00:11.653
> 
> 标签：passwords

我正在编写一套都需要登录到服务器的应用程序。它结合得很好，但我遇到了后勤障碍。应用程序的性质要求它们稍后以某种频率关闭并再次启动。每次需要启动其中一个应用程序时都必须登录非常烦人。

我正在尝试一种可能将登录信息存储在本地用户计算机上的安全方式。有没有什么好方法可以解决这个问题？受权限保护的配置文件？注册表？Firefox 如何存储其密码？你曾经做过这样的事情吗？

该套件更像是一种协议，所有的应用程序都是用各种语言（Python、C#、Java 等）编写的，并在各种操作系统（Windows、Linux、OSX 等）上运行。我并不是真的在寻找代码示例，而是更多地寻找解决这个问题的一般方法。本地存储密码是否明智？对于具有如此不同组件的套件，您如何进行会话登录？现在我使用存储在每个应用程序本地的 application.rc 配置文件，但它们是纯文本并且远非安全。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T17:08:03.230

我将与 Jeff 一起讨论这个问题，并假设既然您提到了注册表，那么您指的是 Windows。我还将假设您正在谈论桌面应用程序（否则您可以只使用内置浏览器 cookie 来存储用户的会话）。

在我的脑海中，我设计了应用程序，以便当用户登录到服务器时，服务器返回一个唯一的会话 id，用于标识经过身份验证的用户。然后，我将存储比 id 以及加盐/加密时间戳（这使您可以选择使缓存的凭据过期）。

存储机制由您决定。您可以将它们存储在 Windows 注册表的 HKEY_LOCAL_USERS 部分或 Windows 中的 Application Data 文件夹中。两者都为您提供了用户分段存储的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T17:04:20.757

通常，这类事情是通过使用“cookie”来完成的；一个（安全地）表明用户先前已成功登录到服务器资源的密钥。这是大多数网站管理登录信息的方式，而 Firefox（实际上是所有浏览器）存储浏览器在用户登录时设置的 cookie。关于 cookie 的一些重要事项：它们应该被加密，以确保恶意程序无法生成一个从而绕过登录过程，它们应该匹配服务器保留的资源（同样的原因），它们应该过期，这样当你可以在网站上维护登录信息一段时间，您的登录信息不是永久的（这是另一个安全漏洞）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:08:53.040

就我个人而言，我会使用带有某种机器 ID 值（主板 ID、芯片 ID、HD ID 等）的加密本地配置文件作为加密密钥的一部分，这样配置文件就不能从一台机器复制到另一台机器. 我还将包括日期和时间，以便您可以在确定它过时时将其过期。

或者，您可以创建一个主机 exe 或启动程序，用于登录，然后在每次您想要启动新应用程序时进入睡眠状态并唤醒它。主机 exe 将应用程序作为参数并决定是否要求登录凭据（通常在第一个应用程序启动时，然后将登录用户和加密密码保存在内存中。当主机 exe 退出登录信息时被遗忘，当您再次启动时，循环重新开始。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T17:34:39.633

Tomcat 6 支持会话的持久性/复制，因此您应该关心选择管理器并对其进行配置；-)

更多信息：http: [//tomcat.apache.org/tomcat-6.0-doc/config/manager.html](http://tomcat.apache.org/tomcat-6.0-doc/config/manager.html)

# ruby-on-rails - 使用 mod_rails 在 SSL 下托管多个应用程序，同一个域

> ID：878733
> 
> 赞同：1
> 
> 时间：2009-05-18T17:02:43.427
> 
> 标签：ruby-on-rails, apache, apache2, mod-rails

我正在尝试将多个 Rails 应用程序托管在同一域下，但目录不同。在尝试托管多个应用程序（效果很好）之前，我的配置如下所示：

```
<VirtualHost *:443>
    ServerName secure.mydomain.com  
    DocumentRoot /root/store/public
</VirtualHost> 
```

我搜索了一下，发现文档建议我使用以下配置：

```
<VirtualHost *:443>
    ServerName secure.mydomain.com
    DocumentRoot /root
    RailsBaseURI /store/public
    RailsBaseURI /store2/public                
</VirtualHost> 
```

但是，该配置只会显示我的目录结构，并且似乎没有应用程序运行。任何建议都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T22:13:32.363

不确定您在 Google 上找到了什么，但您可能想重新阅读有关[部署到子 URI的 mod_rails 文档](http://www.modrails.com/documentation/Users%20guide%20Apache.html#deploying_rails_to_sub_uri)

我猜你需要在你的`/root`目录中创建一些符号链接（别名）到`public`每个应用程序的文件夹

```
ln -s /store/public /root/store 
```

# html - 强调html提交按钮的正确方法？

> ID：878734
> 
> 赞同：3
> 
> 时间：2009-05-18T17:02:46.780
> 
> 标签：html, css, submit, semantics

如果您绝对必须为您的 html 按钮设置样式，那么强调其中一些按钮的正确方法是什么？例如，“添加到购物车”通常在视觉上强调以使其脱颖而出。

选项 1 - 在 em 或 strong + css 中包装提交

选项 2 - 类 + css

选项 3 - ?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T17:07:29.767

CSS是要走的路。例如，在 Facebook“Notes”应用程序中，“发布”按钮为深蓝色，其他按钮为灰色。这一切都是通过 CSS 类和 ID 完成的。

最终，如果您想对 CSS 提出第二意见，您应该只寻找您信任的网站。像[Firebug](https://addons.mozilla.org/en-US/firefox/addon/1843)这样的工具可以很容易地看到它们是如何做样式的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T17:05:39.317

一个类可能是你最灵活的解决方案。如果你想做的不仅仅是粗体或斜体，那么无论如何你都必须使用某种类/id。

但是，如果您将此项目放在容器中，那么您可以使用该容器来选择您的按钮。

**html**

```
<div class="foo">
  <input type="submit" />
</div> 
```

**css**

```
.foo input
{
 ...some styles
} 
```

不过，将课程放在输入上是完全可以接受的。前一种方法仅适用于容器中已有按钮并且不想添加任何额外标记的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T17:08:29.967

好吧，如果您想*强调*一个*button*，我想说最语义化的表示是将您的`<button>`标签（或`<input type="submit">`您正在使用的任何东西）包装在`<em>`标签中并在 CSS 中设置样式，例如：

```
em button {
    color: blue;
    font-style: normal;
    font-weight: bold;
} 
```

（请记住，虽然斜体和粗体可能是大多数浏览器的默认视觉样式`<em>`，`<strong>`但这只是惯例。如果您不是“强烈”强调某些内容，`<em>`即使您希望它显示为粗体，也可以使用。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T17:33:33.817

正确和语义的方式是

```
<button><em>label</em></button> 
```

但是由于 IE 不支持多个元素，因此您必须使用 <input type="button"> -- 并将其包装在 em 中或其他东西中是不好的。

我非常喜欢

```
<input type="button" class="emphasized"/> 
```

或者其他的东西..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T17:40:00.373

使用 CSS2+，您可以使用选项 3：仅 CSS

```
input[type="submit"] {
    border: 3px solid blue;
} 
```

更多信息：[http ://www.w3.org/TR/CSS2/selector.html](http://www.w3.org/TR/CSS2/selector.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T17:06:54.480

我会使用图像按钮...没有任何重点可以与精心设计的图标的美感相提并论...

“一张图片胜过千言万语！”

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T18:03:34.660

问一个开放的问题，得到一堆正确但不同的答案......

大多数人只是选择图像作为按钮，因为它绕过了很多浏览器问题。你知道它在*每个*浏览器上看起来都是一样的。

您可以使用 CSS 来设置您用来提交的元素的样式。走这条路，你可以使用 <input type="submit"> 和适当的样式，或者你可以使用 <button type="submit">[lable goes here]</button>。我更喜欢后者，因为它更容易设计，但这主要是个人喜好。

最好的建议是环顾四周，当你看到你想要的东西时，看看他们是如何做到的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-18T23:41:23.357

很多网站都使用图片。一个问题可能是不一致 - 您必须制作所有按钮图像，否则它们都不会或有些看起来不合适。

我一般会选择：

*   较大的字体大小 ( `font-size: 120%`)
*   粗体字 ( `font-weight: bold`)
*   填充（水平多于垂直，例如`padding: 4px 8px`）

由于平台变化很大，我不会改变颜色。对于大多数人来说，灰色文本可能看起来不错，但如果用户使用较暗的主题，那么按钮背景颜色可能会使文本不可读。

如果您开始更改任何颜色，您至少需要设置一个`color`,`background-color`和`border`.

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-18T20:13:26.303

考虑此类问题的一个好方法是考虑您希望从听觉浏览器中获得什么。在这种情况下，如果您的页面正在被读出，您是否还希望通过与其他按钮不同的音调或音量来强调该按钮。如果是这样，您应该使用语义标记来表明这是重点，而不仅仅是表示。

<em> 确实应该用于强调单个单词以指示重音应该放在句子中的位置，因此除非您的按钮出现在句子中间，否则我宁愿将输入元素包装在 <strong> 而不是 <em >。

此外，您可以添加 CSS 以获得您想要的视觉效果。

# python - 与 JDBC DatabaseMetaData 等效的 Python 是什么？

> ID：878737
> 
> 赞同：3
> 
> 时间：2009-05-18T17:03:24.080
> 
> 标签：python, jdbc, database-metadata

什么是 Python 等价于[DatabaseMetaData](http://java.sun.com/j2se/1.5.0/docs/api/java/sql/DatabaseMetaData.html)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-18T17:59:08.680

这不是特定于 python 的答案；事实上，我不知道 Python 数据驱动程序是否有这种东西。但也许这些信息会有所帮助。

ANSI SQL-92 和 SQL-99 标准需要[INFORMATION_SCHEMA 模式](http://en.wikipedia.org/wiki/Information_Schema)，它将有关表的信息存储在目录中。

您可以通过对该架构中视图的查询来检索您寻找的元数据。

例如：

```
select column_name, is_nullable, data_type, character_maximum_length as maxlen 
from information_schema.columns 
where table_name = 'Products' 
```

并非所有数据库都实现该标准的那一部分。例如，甲骨文就没有。

幸运的是，还有一些特定于数据库的表可以存储此类信息。

虽然 Microsoft SQL Server 支持 Information_Schema，但也有一些特定于 SQL Server 的表可以提供更多元数据信息。这些是`[CatalogName].dbo.sysobjects`和`[CatalogName].dbo.sysolumns`。这些表上的类似查询将为您提供所需的元数据。例子：

```
select * from [CatalogName].dbo.syscolumns 
where id = 
    (Select id from [CatalogName].dbo.sysobjects where name = 'Products') 
```

在 Oracle 中，ALL_TAB_COLUMNS 表可以为您提供以下信息：

```
select column_name, data_type, data_length, data_precision, data_scale
from ALL_TAB_COLUMNS
where table_name = 'EMP'; 
```

无论您是查询标准视图还是特定于数据库的视图，都不需要 ODBC 来执行这些查询 - 您可以使用任何可用于操作数据的数据库连接，当然要获得安全批准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T17:28:03.140

如果您愿意使用 ODBC 进行数据访问，那么您可以使用 pyodbc，[http://code.google.com/p/pyodbc/wiki/Features](http://code.google.com/p/pyodbc/wiki/Features)。Pyodbc 允许你调用 SQLTables 之类的函数，相当于 JDBC 的 getTables 函数。获取元数据的 JDBC 和 ODBC 函数非常相似。

# sharepoint - 今日计算列问题的任何解决方案是 SharePoint？

> ID：878744
> 
> 赞同：10
> 
> 时间：2009-05-18T17:04:41.160
> 
> 标签：sharepoint, formula

例如，我希望能够在 SharePoint 列表的计算列中使用今天的日期来确定任务是否过期。有一个有据可查的技巧，它涉及创建一个名为“Today”的虚拟列，在公式中使用它，然后将其删除，从而“欺骗”SharePoint 使用 Today 函数。

问题是这种方法不能可靠地工作——计算不是动态的；它仅在保存项目时生成，因此今天“列”有效地成为修改日期。（这可能是 SharePoint 不允许您直接使用 Today 功能的原因。）

有没有人找到有效的解决方案？我知道我可以使用 javascript 在客户端获取实际日期并显示颜色、标志等，但我正在寻找“服务器端”解决方案。

* * *

作为参考，Today 专栏的技巧及其问题在这两个帖子和相关评论中得到了很好的描述：http: [//blogs.msdn.com/cjohnson/archive/2006/03/16/552314.aspx](http://blogs.msdn.com/cjohnson/archive/2006/03/16/552314.aspx)和[http:// pathtosharepoint.wordpress.com/2008/08/14/calculated-columns-the-useless-today-trick/](http://pathtosharepoint.wordpress.com/2008/08/14/calculated-columns-the-useless-today-trick/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T21:35:27.777

根本没有办法解决这个问题。由于列表的值存储在数据库中并“按原样”返回给搜索爬虫等其他功能，因此无法创建动态字段。

可以创建一个自定义字段，在计算中使用今天的日期*显示值。*

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-25T12:28:13.687

除了 Christophe (PathToSharePoint) 的文章之外，本文还介绍了 Today 技巧以及为什么它不起作用

[在计算列中使用 Today 的真相](http://blog.pentalogic.net/2008/11/truth-about-using-today-in-calculated-columns/)

有很多软糖，可能最好的是 Dessie 的控制台应用程序（MNM 上面提到过）

[动态更新包含 Today 引用的 SharePoint 计算列](http://www.sharepointblogs.com/dez/archive/2008/07/31/dynamically-updating-a-sharepoint-calculated-column-containing-a-quot-today-quot-reference.aspx)

它很好但并不完美，例如您可能不得不担心不同的时区。

在走这条路之前，你应该问问自己，你是否真的、真的需要这样做。例如 ：-

*   如果您想要[倒计时（逾期天数/完成任务的剩余天数）](http://pathtosharepoint.wordpress.com/2008/08/25/a-countdown-for-tasks-lists/)，则可以使用 SPD 和 XLST 数据视图 Web 部件

*   如果您希望视图显示过期项目或在过去 X 天 ec 中创建的项目，那么您可以在视图过滤器[2中使用 [Today]](http://www.sharepointblogs.com/dez/archive/2008/07/31/dynamically-updating-a-sharepoint-calculated-column-containing-a-quot-today-quot-reference.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T15:48:11.540

如果您创建 Today 列，则需要对其进行更新。您可以使用计时器作业或将 jquery 脚本放置在用户点击的页面上来做到这一点。该脚本可以调用 SPServices.SPUpdateMultipleListItems 来进行更新。传递一个 CAML 子句，以便您只更新需要更新 Today 值的列表项，例如每天一次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T20:16:54.737

我的建议是创建为您执行此计算的 on 字段，然后在您的 SharePoint 列表中引用它。这不是一个简单的实现，但它会起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-17T07:33:47.943

我也一直在寻找解决方案，但仍然没有运气.. Today 专栏技巧的局限性在于不是动态的。

不过，我确实有一个建议，我们为什么不创建一个计时器作业，该作业将在每天上午 12 点用当前日期更新某个特定列。我知道你们中的一些人可能会认为这有点过头了。只是我的建议：D！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-24T21:43:18.827

我想出了一个非常粗略但有效的解决方案，无需进行任何编码。我将解释我是如何制作今天的专栏以及如何将其放入过期专栏的，因为该专栏也很难找到如何做。

首先，我做了一个名为“今天”的专栏（喘气！）。接下来，我创建了一个名为“Days Overdue”的专栏。然后我打开了共享点设计器并创建了一个新的工作流程。我将它设置为在每次编辑/更新项目时运行（请记住，我关闭了此列表的版本控制，否则我将不得不求助于编码以避免在我们的服务器上建立一堆无用的数据）。我将操作设置为简单地将修改后的日期存储在工作流变量中，然后将今天列的值更改为该变量。虽然修改后的列是日期/时间，而我今天的列只是一个日期，但它传输得很好。然后我将工作流程设置为暂停 2 小时。显然，您可以将其设置为您想要的任何时间，它只会更改您今天列更新的最新可能时间，即在我的情况下是凌晨 2 点。

到逾期天数列。这是那个人的代码-

```
=IF([Due Date]>Today,"None",IF([Date Closed]=0,Today-[Due Date],IF([Due Date]>[Date Closed],"None",IF(Today>=[Date Closed],[Date Closed]-[Due Date],IF([Due Date]<Today,Today-[Due Date]))))) 
```

这以天数的形式显示逾期天数，如果未逾期，则显示“无”。您可以使用数字格式或字符串格式，但不能使用日期格式。好吧，我希望这对遇到这个问题并且不想深入研究编码的人有所帮助。

编辑：我忘了说，在上面的逾期天数列的代码中，我输入如果今天已经过了关闭日期，使用关闭日期减去到期日而不是今天减去到期日，以确保计算关闭项目后不会继续发生。您可能会在代码中注意到这一点，但我觉得我应该指出它以防万一。

编辑 2：在我的计算列的第二次编辑之前，我在问题被标记为“已关闭”后没有正确计算逾期天数。我输入了更新的代码。代码的最后一部分没有意义，因为它与开头的逻辑相同，但它有效，所以我不想冒险！:)

和平。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-30T17:13:54.310

我使用了以下，没有任何问题。

字段名称：过期

字段类型：计算

返回的数据类型：是/否

公式： `=AND([Due Date]<NOW(),Status<>"Completed",[Due Date]<>"")`

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-05-28T17:04:41.633

这是一种解决方法：

创建一个名为 Today 的日期列。在计算公式中使用此列（忽略公式返回错误值的事实）。完成公式后，从列表中删除 Today 列。

出于某种原因，它以这种方式工作！现在 Sharepoint 将公式中的今天视为今天的日期。

注意：如果您决定要更改公式，则必须再次创建 Today 列。否则，它不会将 Today 识别为有效列。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-12-14T07:33:18.610

我尝试了@Farzad 的方法，它似乎运行良好。我想对**经过的天数进行自定义计数，因此添加了一个计算列，以前我使用的是****创建日期**和**修改日期**列之间的差异，只有在用户更新帖子时才会显示，这让我很沮丧。

我现在有一个公式，它可以按我的意愿工作并使用**Today**列，这里适用于任何想使用它的人。我还有一个 Status 列，在此基础上使用 On Hold 的基础，其余公式基于**Today - Created**的日期差异。

```
=IF(Status="On Hold","On Hold",IF(AND(Today=Created,(DATEDIF(Created,Today,"D")=0)),"New",IF(AND(Today<>Created,(DATEDIF(Created,Today,"D")=0)),"New (updated)",IF(DATEDIF(Created,Today,"d")>3,"Need Update Immediately",IF(DATEDIF(Created,Today,"d")=1,"One day old",IF(DATEDIF(Created,Today,"d")=2,"Two days old","")))))) 
```

基本上它只是一堆嵌套的**IF**条件，它们为我提供标签，在此基础上，我可以在我的视图中添加一个组并在需要时过滤掉数据。希望这可以帮助任何寻找答案的人！

# windows - 纯win32跨进程子窗口

> ID：878747
> 
> 赞同：2
> 
> 时间：2009-05-18T17:05:09.803
> 
> 标签：windows, winapi

我需要创建一个透明的覆盖窗口，它位于另一个窗口之上。另一个窗口来自另一个供应商。当用户拖动*该*窗口时，我需要跟随。

**WS-CHILD 似乎是个好主意，但它不能与**我真正需要的 WS-EX-LAYERED 结合使用（为了透明）。但是我仍然可以在不使用 WS-CHILD 的情况下设置父级。

育儿确实给了我的winproc通知（WM-WINDOWPOSCHANGING），但只有在拖动完成后，鼠标向上。**为了给人一种美好的感觉，我需要在拖动时连续**获取这些通知（或例如 WM-MOVE） 。

 **我想我的问题类似于对接，但在 CodeProjet 上看到的 fx 的精细对接解决方案使用 WS-CHILD。( [http://www.codeproject.com/KB/toolbars/dockwnd.aspx](http://www.codeproject.com/KB/toolbars/dockwnd.aspx) )

我想我可以使用轮询，但这不是我想要的。我也可以使用 ::SetWindowsHook()。但这是我最后的手段。我希望我错过了一些微不足道的事情，并且有人可以为我指明一个好的方向。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T17:15:05.273

我知道这不是您首选的解决方案，但我认为您需要使用全局鼠标挂钩。在低级鼠标 proc 的默认情况下传递`WH_MOUSE_LL`给并且不执行任何操作。`SetWindowsHookEx()`但是当您收到`WM_WINDOWPOSCHANGING`通知时，请开始跟踪鼠标移动并进行适当的调用`MoveWindow()`或其他操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T09:27:29.967

我为此使用了 LayeredWindow 并将另一个窗口设置为父窗口。

这是我使用的代码：

```
::SetWindowLong(GetHwnd(), GWL_EXSTYLE, GetWindowLong(GetHwnd(), GWL_EXSTYLE) |WS_EX_LAYERED);
::SetLayeredWindowAttributes(GetHwnd(), RGB(255,0,255), 255, LWA_COLORKEY | LWA_ALPHA);
::SetWindowLongPtr(GetHwnd(),GWLP_HWNDPARENT,(long)GetParentHWND());
::SetWindowPos(hndOtherWindow, hndOverlayWinow, 0, 0, 0, 0, SWP_NOSIZE | SWP_NOMOVE |SWP_NOACTIVATE); 
```

它适用于我的目的。只剩下一个问题：如果我的覆盖窗口失去焦点，我想设置焦点，或者激活另一个窗口。你有想法吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-26T15:30:02.607

如果您想知道另一个进程中的窗口何时被移动或调整大小，您需要安装一个挂钩，捕获 WM_MOVING 和 WM_SIZING 消息并将这些消息反映回您的控制器进程。对不起，这不是你想要的答案！我不怪你想避免跨进程钩子，这有点痛苦......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-21T08:22:59.953

WM_MOVING 消息怎么样？您可以尝试拦截此消息并相应地移动您的窗口。

# php - PHP 会话在 PHP5 中不起作用

> ID：878756
> 
> 赞同：2
> 
> 时间：2009-05-18T17:07:27.613
> 
> 标签：php, session

我有 2 个页面：login.php 和 index.php。两个页面都以

```
session_start(); 
```

当我设置

```
$_SESSION['user'] = "name"; 
```

在 login.php 中，而不是打开 index.php，我的会话对象是空的。怎么会？

编辑：

我发现了问题：IE 7。我必须访问我的域。但是，我认为会话存储在服务器上，而不是客户端？比为什么我拥有对我的域的 IE 盛大访问权限？( [http://www.pcwindowstips.com/2007/09/04/how-to-enable-cookies-in-internet-explorer-7/](http://www.pcwindowstips.com/2007/09/04/how-to-enable-cookies-in-internet-explorer-7/) )

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T17:27:41.863

> 我认为会话存储在服务器上，而不是客户端？比为什么我有 IE 授予访问我的域的权限？( [http://www.pcwindowstips.com/2007/09/04/how-to-enable-cookies-in-internet-explorer-7/](http://www.pcwindowstips.com/2007/09/04/how-to-enable-cookies-in-internet-explorer-7/) )

会话的工作方式是为站点存储一个会话 cookie，其中包含您的会话 ID。服务器知道你是谁的唯一方法是在每次页面加载时读取会话 ID cookie。对于每个用户，所有 $_SESSION 数据都存储在服务器上，但必须设置 cookie 以便服务器知道要检索哪些 $_SESSION 数据。

这也是为什么如果您获得他们的会话 id cookie，您基本上可以“成为”另一个用户。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T17:29:09.940

与大多数其他浏览器相比，Internet Explorer 具有更严格的 cookie 政策。检查您的[会话 cookie 参数](http://docs.php.net/manual/en/session.configuration.php)（另请参阅[`session_get_cookie_params()`](http://docs.php.net/session_get_cookie_params)）并尽可能用显式值替换默认值。此外，您可能会发送 [假 P3P 策略]( [http://msdn.microsoft.com/en-us/library/ms537343(VS.85).aspx)](http://msdn.microsoft.com/en-us/library/ms537343(VS.85).aspx))以满足 Internet Explorer。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-11-09T20:07:02.183

也许 php.ini 中的这个变量正在映射到现有路径

session.save_path = "c:/错误/路径"

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-07T20:25:11.873

这是发生在我身上的事情，可能会为某人带来启发。我的会话工作不正常。IE 8 和 Firefox 正在丢失会话信息。

我包括了一个文件。包含的文件在尾随的 &ques? 之后有一个额外的回车符？>

该回车开始了会话。我把 session_start 放在包含之后。繁荣。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T17:14:04.590

这里没有太多信息，我会尝试使用我的精神力量。

用户登录后，是否设置会话变量，然后使用 http 标头将用户重定向到 index.php？如果是这样，我认为会话 cookie 不会发送给用户。如果是这种情况，解决方案是：

1.  在最初显示登录表单时调用 session_start() （不仅仅是在用户回帖之后）；或者：
2.  显示“登录成功！” 消息，然后使用元刷新重定向，或者只提供指向 index.php 的链接。

* * *

您还可以尝试在两个页面上转储会话 ID，以查看您是否正在以某种方式开始新会话：

```
echo 'Session ID is: ' . SID . "<br/>\n" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T17:16:04.210

在调用 session_start() 之前，您需要验证是否启用了 cookie，并且没有任何内容（包括存档开头或结尾的空白行）发送到浏览器。

# emacs - emacs 使用大纲次要模式在类中折叠函数

> ID：878766
> 
> 赞同：4
> 
> 时间：2009-05-18T17:08:51.743
> 
> 标签：emacs, outline

我应该使用什么样的钩子来折叠类中的函数。我想查看类中函数的轮廓，但如果我挂钩隐藏 - 所有包括类在内的所有内容在打开期间都会折叠。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T18:04:11.883

这个小片段对我有用。但是，您可能希望限制启用大纲模式的文件。您可以自定义注释掉的`when`语句来做到这一点。并添加正确的关闭括号。

```
(defun my-outline-trigger ()
  "enable outline mode and hide all the function bodies"
  ;; (when (member major-mode '(cc-mode emacs-lisp-mode)) ....)
  (outline-minor-mode)
  (hide-body))

(add-hook 'find-file-hooks 'my-outline-trigger) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T23:25:59.393

我使用[hideshow.el](http://www.emacswiki.org/emacs/HideShow) - 它似乎对我更有效。

# exception - 从 .NET 中的 JPEG 读取 IPTC 字段时出错

> ID：878768
> 
> 赞同：1
> 
> 时间：2009-05-18T17:09:01.947
> 
> 标签：exception, .net-3.5, jpeg, iptc

在我尝试过的大约 1% 的 JPEG 上调用 BitmapMetadata.GetQuery("/app13/irb/8biiptc/iptc") 时出现以下异常。这可能是什么原因造成的，我能做些什么来解决它？（我试过谷歌搜索，但我只能找到一个相关的结果，问同样的问题但没有答案。）

```
System.OverflowException:
The image data generated an overflow during processing. ---> 
System.Runtime.InteropServices.COMException (0x88982F05): 
Exception from HRESULT: 0x88982F05
--- End of inner exception stack trace ---
at System.Windows.Media.Imaging.BitmapMetadata.GetQuery(String query)
at MyProject.ImageRecord..ctor(String file)
in C:\MyProject\ImageRecord.cs:line 93
The image data generated an overflow during processing. 
```

编辑：

该`exiv2`工具报告：

```
Error: Invalid Photoshop IRB data size 6372 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T20:26:05.477

我的猜测是 Photoshop IRB 数据比标题指定的要长。

至少这是我可以通过浏览 Exiv2 的来源（第 107 行）来推断的：

[http://dev.exiv2.org/repositories/entry/exiv2/trunk/src/jpgimage.cpp?rev=1146](http://dev.exiv2.org/repositories/entry/exiv2/trunk/src/jpgimage.cpp?rev=1146)

但是我对c的理解不是很好！:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-01T15:42:18.497

错误 0x88982F05 只是 WIC 的常规值超出范围错误，因此您可以轻松处理它。此外，这可能不是您使用 IPTC 查询字符串的唯一问题。只需尝试 {} catch {} 这部分像这样优雅地切换

```
if (bitmapMetadata.GetQuery(MY_QUERY) != null &&) {
try { 
... }
catch {} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-01T18:25:27.647

根据exiv2报告的信息，Photoshop IRB信息的大小与元数据的整体大小不一致。

如果您希望忽略消息，我会更具体地说明您捕获的异常类型——只忽略或报告特定的 COM 异常。

有几个工具/资源：

*   [http://blogs.msdn.com/rwlodarc/archive/2007/11/26/wic-tools-now-available.aspx](http://blogs.msdn.com/rwlodarc/archive/2007/11/26/wic-tools-now-available.aspx)
*   [http://www.drewnoakes.com/code/exif/index.html](http://www.drewnoakes.com/code/exif/index.html)

# windows - 如何使用 Windows Search 搜索 Jar 文件？

> ID：878769
> 
> 赞同：14
> 
> 时间：2009-05-18T17:09:03.600
> 
> 标签：windows, search, windows-xp, jar

我相信当我们使用 Win2K 时，Windows Search 会搜索 Jar 文件来定位特定的类，但这似乎在 XP 中不起作用。有谁知道如何在 XP 中启用此功能？

注意，要在 Win2K 中进行搜索，我们只需为文件输入 *.jar 并为搜索文本字符串输入“ClassABC”，搜索将返回任何包含标题包含“ClassABC”的类文件的 jar 文件。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-18T18:18:19.077

将此添加到文本文件，保存文件，将扩展名更改为 .reg，双击以添加到注册表，您应该没问题...您可以搜索文件名或内容，它应该显示具有类名的 jar

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\.jar\PersistentHandler]
@="{5e941d80-bf96-11cd-b579-08002b30bfeb}" 
```

剩下的唯一一件事就是注销并重新登录到 Windows，它应该可以正常工作，请参阅[http://support.microsoft.com/kb/309173](http://support.microsoft.com/kb/309173)了解更多详细信息

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T18:00:13.607

我也推荐[总司令](http://www.ghisler.com/)。它是一个很棒的文件管理工具，具有强大的搜索功能，可以轻松查看 jar 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T17:43:15.560

如果它被删除，很可能是由于在 XP 开发期间发生的 Sun-Microsoft Java 纠纷。不太可能有办法重新启用它。

您可能会发现这很有帮助：http: [//jarbrowser.sourceforge.net/](http://jarbrowser.sourceforge.net/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-03-31T13:32:27.507

只需使用 FindClassInJars 工具，它是一个简单的摇摆程序，但很有用。[您可以在http://code.google.com/p/find-class-in-jars/](http://code.google.com/p/find-class-in-jars/)查看源代码或下载 jar 文件

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-10T12:58:05.057

我在这里制作了另一个版本的 FindClassInJars。外观相同，但搜索效果更好、更智能。单击此处的“原始按钮”： [https ://github.com/Oxvalley/FindClassInJars/blob/master/lib/findclassinjars-2.0.0.jar](https://github.com/Oxvalley/FindClassInJars/blob/master/lib/findclassinjars-2.0.0.jar)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T18:17:23.870

根据[这篇 MSDN Channel 9 文章](http://channel9.msdn.com/wiki/desktopsearchifilters/)，添加适当的[IFilter](http://channel9.msdn.com/Wiki/IFilters/)即可。由于 .jar 文件与 .zip 文件相同，因此它们列出的[四个](http://www.4-share.com/) [ZIP](http://www.alnasoft.com/) [文件](http://www.citeknet.com/) [IFilter](http://www.ifiltershop.com/)之一可能会起作用（除非它们都是基于扩展名的）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-18T18:19:04.613

来自[Brenden Anstey 的博客](http://brendenanstey.blogspot.com/2008/12/browse-jar-war-and-ear-files-in.html)：

```
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\.jar]
"Content Type"="application/x-zip-compressed"
"PerceivedType"="compressed"
@="CompressedFolder"

[HKEY_CLASSES_ROOT\.jar\CompressedFolder]

[HKEY_CLASSES_ROOT\.jar\CompressedFolder\ShellNew]
"Data"=hex:50,4b,05,06,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00

[HKEY_CLASSES_ROOT\.jar\OpenWithProgids]
"CompressedFolder"=""

[HKEY_CLASSES_ROOT\.jar\PersistentHandler]
@="{098f2470-bae0-11cd-b579-08002b30bfeb}"

[HKEY_CLASSES_ROOT\.war]
"Content Type"="application/x-zip-compressed"
"PerceivedType"="compressed"
@="CompressedFolder"

[HKEY_CLASSES_ROOT\.war\CompressedFolder]

[HKEY_CLASSES_ROOT\.war\CompressedFolder\ShellNew]
"Data"=hex:50,4b,05,06,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00

[HKEY_CLASSES_ROOT\.war\OpenWithProgids]
"CompressedFolder"=""

[HKEY_CLASSES_ROOT\.war\PersistentHandler]
@="{098f2470-bae0-11cd-b579-08002b30bfeb}"

[HKEY_CLASSES_ROOT\.ear]
"Content Type"="application/x-zip-compressed"
"PerceivedType"="compressed"
@="CompressedFolder"

[HKEY_CLASSES_ROOT\.ear\CompressedFolder]

[HKEY_CLASSES_ROOT\.ear\CompressedFolder\ShellNew]
"Data"=hex:50,4b,05,06,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00

[HKEY_CLASSES_ROOT\.ear\OpenWithProgids]
"CompressedFolder"=""

[HKEY_CLASSES_ROOT\.ear\PersistentHandler]
@="{098f2470-bae0-11cd-b579-08002b30bfeb}" 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-05-13T05:25:58.683

我知道这不是 Windows 搜索，但我长期以来一直使用[Agent Ransack](http://www.mythicsoft.com/page.aspx?type=agentransack&page=home)：它非常快速，可以搜索所有各种 java 存档格式（jar、war、ear）以及 zip。

我特别喜欢并经常使用的一个功能是保存搜索：您可以保存条件（以便您可以轻松地重复该搜索）或结果。所以当我在一个项目上工作时，我经常想要搜索通过项目目录树查找文件（或 jar/zip 中的文件）。我执行一次搜索并将条件保存为 .srf 文件，之后我可以快速打开该文件以执行类似的搜索。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-20T22:29:59.427

[正如@iubing 所建议的](https://stackoverflow.com/a/5500683/27657)，FindClassInJars 代码运行良好，但作者一定搞砸了包装。

我已经从谷歌代码中分叉了 FindClassInJars 实用程序，你可以[在这里](https://github.com/javamonkey79/FindClassInJars/blob/master/target/findclassinjars-1.0.0.jar)获得一个有效的构建副本。只需单击“原始”按钮。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2014-04-25T21:16:46.800

不久前我开发了这个：[https](https://github.com/javalite/jar-explorer) ://github.com/javalite/jar-explorer只是为了这个场合。甚至可以在 Windows 上工作 :)

# c - 汇编编译错误（gcc4.2.4=win, gcc4.3.3=fail）

> ID：878770
> 
> 赞同：2
> 
> 时间：2009-05-18T17:09:04.037
> 
> 标签：c, assembly

我们最近将代码升级到`gcc4.3.3`from `gcc4.2.4`。

```
void testAndSet(  volatile int*  s, int* val )
{
   __asm__ __volatile__ ( "btsl   $0, %0\n   "
           "jc   bitSet\n   "
           "movl   $0, %1\n   "
           "jmp   returnVector\n"
           "bitSet:\n   "
           "movl   $1, %1\n"
           "returnVector: " : "=m"(*s), "=m"(*val) );
} 
```

我们的代码现在失败并出现以下错误，

```
lock.cxx: Assembler messages:
lock.cxx:59: Error: symbol `bitSet' is already defined
lock.cxx:61: Error: symbol `returnVector' is already defined
lock.cxx:59: Error: symbol `bitSet' is already defined
lock.cxx:61: Error: symbol `returnVector' is already defined 
```

这些符号在其他任何地方都找不到。（重命名它们会导致与新名称相同的错误）。

这是怎么回事？为什么我会收到两次错误？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T17:16:29.467

可能优化器已更改，现在将您的 testAndSet() 函数内联到 2 个位置。因为您为标签使用全局名称，所以这不起作用。您应该改用本地名称。例如：

```
 __asm__ __volatile__ ( "btsl   $0, %0\n   "
           "jc   0f\n   "
           "movl   $0, %1\n   "
           "jmp   1f\n"
           "0:\n   "
           "movl   $1, %1\n"
           "1: " : "=m"(*s), "=m"(*val) ); 
```

本地标签只是数字；要消除有许多名为“0”的标签的情况，您需要使用“ `jmp 0f`”表示向前跳跃，“ `jmp 0b`”表示向后跳跃。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T17:22:27.023

这与您的错误无关，但您可以使用[setCC 指令](http://pdos.csail.mit.edu/6.828/2008/readings/i386/SETcc.htm)改进代码并避免分支：

```
 __asm__ __volatile__ ( "btsl   $0, %0\n   "
       "mov $0, %1\n"
       "setc %1\n" : "=m"(*s), "=m"(*val) ); 
```

指令（其中`setCC`CC 是条件代码标志之一，类似于`jCC`指令）根据是否满足给定条件将字节设置为 0 或 1。由于目标是一个 4 字节的值，因此您需要将其预加载 0 或使用[MOVZX 指令](http://pdos.csail.mit.edu/6.828/2008/readings/i386/MOVZX.htm)将高 3 字节设置为 0。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-04T13:58:27.460

您也可以通过在每个本地标签后添加**%=**来使用本地标签名称：

"循环%=:" "\n\t"

# haskell - Haskell：为拉链创建类型类

> ID：878774
> 
> 赞同：4
> 
> 时间：2009-05-18T17:09:37.720
> 
> 标签：haskell, design-patterns, typeclass, zipper

所以我一直在阅读一些关于 Haskell（以及其他函数式语言，我想）中的 Zipper 模式来遍历和修改数据结构的内容，我认为这对我来说是一个磨练创建类型技能的好机会Haskell 中的类，因为该类可以提供一个通用的遍历接口供我编写代码，而与遍历的数据结构无关。

我想我可能需要两个类——一个用于根数据结构，一个用于为遍历第一个而创建的特殊数据结构：

```
module Zipper where

class Zipper z where
  go'up :: z -> Maybe z
  go'down :: z -> Maybe z
  go'left :: z -> Maybe z
  go'right :: z -> Maybe z

class Zippable t where
  zipper :: (Zipper z) => t -> z
  get :: (Zipper z) => z -> t
  put :: (Zipper z) => z -> t -> z 
```

但是当我用一些简单的数据结构（如列表）尝试这些时：

```
-- store a path through a list, with preceding elements stored in reverse
data ListZipper a = ListZipper { preceding :: [a], following :: [a] }

instance Zipper (ListZipper a) where
  go'up ListZipper { preceding = [] } = Nothing
  go'up ListZipper { preceding = a:ps, following = fs } = 
      Just $ ListZipper { preceding = ps, following = a:fs }
  go'down ListZipper { following = [] } = Nothing
  go'down ListZipper { preceding = ps, following = a:fs } = 
      Just $ ListZipper { preceding = a:ps, following = fs }
  go'left _ = Nothing
  go'right _ = Nothing

instance Zippable ([a]) where
  zipper as = ListZipper { preceding = [], following = as }
  get = following
  put z as = z { following = as } 
```

或者二叉树：

```
-- binary tree that only stores values at the leaves
data Tree a = Node { left'child :: Tree a, right'child :: Tree a } | Leaf a
-- store a path down a Tree, with branches not taken stored in reverse
data TreeZipper a = TreeZipper { branches :: [Either (Tree a) (Tree a)], subtree :: Tree a }

instance Zipper (TreeZipper a) where
  go'up TreeZipper { branches = [] } = Nothing
  go'up TreeZipper { branches = (Left l):bs, subtree = r } =  
      Just $ TreeZipper { branches = bs, subtree = Node { left'child = l, right'child = r } }
  go'up TreeZipper { branches = (Right r):bs, subtree = l } =  
      Just $ TreeZipper { branches = bs, subtree = Node { left'child = l, right'child = r } }
  go'down TreeZipper { subtree = Leaf a } = Nothing
  go'down TreeZipper { branches = bs, subtree = Node { left'child = l, right'child = r } } =
      Just $ TreeZipper { branches = (Right r):bs, subtree = l }
  go'left TreeZipper { branches = [] } = Nothing
  go'left TreeZipper { branches = (Right r):bs } = Nothing
  go'left TreeZipper { branches = (Left l):bs, subtree = r } =
      Just $ TreeZipper { branches = (Right r):bs, subtree = l }
  go'right TreeZipper { branches = [] } = Nothing
  go'right TreeZipper { branches = (Left l):bs } = Nothing
  go'right TreeZipper { branches = (Right r):bs, subtree = l } =
      Just $ TreeZipper { branches = (Left l):bs, subtree = r }

instance Zippable (Tree a) where
  zipper t = TreeZipper { branches = [], subtree = t }
  get TreeZipper { subtree = s } = s
  put z s = z { subtree = s } 
```

我无法编译它，我的每个`Zippable`实例定义都会出现很多这样的错误：

```
拉链.hs:28:14:
    无法匹配预期的类型“z”
           针对推断类型“ListZipper a”
      `z' 是一个刚性类型变量，由
          Zipper.hs:10:20 中“zipper”的类型签名
    在表达式中：ListZipper {preceding = [], following = as}
    在“拉链”的定义中：
        zipper as = ListZipper {preceding = [], following = as}
    在方法“拉链”的定义中

```

所以我不确定从这里去哪里。我怀疑我的问题是我试图将这两个实例绑定在一起，而`(Zipper z) =>`声明只是想`z`成为 any `Zipper`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-19T07:03:20.750

您还可以使用类型同义词族代替多参数类型类和功能依赖项。在这样的情况下，它们提供了一个更清晰、更易于理解的解决方案。在这种情况下，类和实例将变为：

```
class Zippable t where
  type ZipperType t :: *
  enter :: t -> ZipperType t
  focus :: ZipperType t -> t

instance Zippable [a] where
  type ZipperType [a] = ListZipper a
  enter = ...
  focus = ... 
```

[Fun with type functions](http://research.microsoft.com/en-us/um/people/simonpj/papers/assoc-types/typefun.pdf)是对已经熟悉 Haskell 的人的类型同义词系列的极好介绍。不久前，我还写[了一篇](http://martijn.van.steenbergen.nl/journal/2009/01/11/type-synonym-families/)关于如何经常使用类型同义词系列而不是功能依赖关系的文章。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-18T17:32:55.520

（顺便说一句：你的`go'up`命名方案是……有创意的。Haskell 风格通常是驼峰式。）

你在正确的轨道上。你写的和下面的一样。

```
{-# LANGUAGE RankNTypes #-}
instance Zippable [a] where
    zipper = ... :: forall z. (Zipper z) => [a] -> z
    get = ... :: forall z. (Zipper z) => z -> [a]
    set = ... :: forall z. (Zipper z) => z -> [a] -> z 
```

（对于所有类型`z`，给定`Zipper z`，存在一个`zipper :: [a] -> z`。）

您正在尝试定义`zipper = ... :: [a] -> ListZipper a`，这显然过于严格。

您的代码将通过以下最小更改进行类型检查：

```
{-# LANGUAGE MultiParamTypeClasses #-}
class (Zipper z) => Zippable z t where
    zipper :: t -> z
    get :: z -> t
    set :: z -> t -> z
instance Zippable (ListZipper a) [a] where
    ...
instance Zippable (TreeZipper a) (Tree a) where
    ... 
```

请参阅[多参数类型类](http://www.haskell.org/haskellwiki/Multi-parameter_type_class)。这是一个 post-Haskell'98 扩展，但 Haskell 实现广泛支持它。

# iphone - 在 iPhone 上水平滚动的 UIPickerView？

> ID：878775
> 
> 赞同：3
> 
> 时间：2009-05-18T17:09:38.280
> 
> 标签：iphone, objective-c, cocoa-touch

我正在查看这个小部件，它似乎是一个 UIPickerView，但是我没有看到 iPhone SDK API 提供的任何只允许水平滚动的东西。大多数情况下，这一切都是垂直完成的。此选择器周围似乎还有一个自定义图形，所以它可能也不是。

我很好奇是否有人能够确定这确实是 UIPickerView 还是被黑掉的 UIScrollView？这个小部件很方便——我喜欢它的使用。我在应用商店的一些随机杂货应用中找到了它。

这是屏幕截图：

![在此处输入图像描述](https://i.stack.imgur.com/bCLRa.jpg)

谢谢大家。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-23T21:32:00.493

我肯定会使用 iCarousel 库：

[https://github.com/nicklockwood/iCarousel](https://github.com/nicklockwood/iCarousel)

该库的文档非常好，代码干净且维护良好。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-18T17:24:44.973

这完全是习惯。你确实可以做一些覆盖 UIImageView 和 UIScrollView 的事情。我猜这是100％的习惯。与所有编程一样，有很多方法可以做任何一件事情。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-08-15T11:29:27.840

正如我最近在回答[这个](https://stackoverflow.com/questions/4594685/how-could-i-make-a-horizontal-picker)问题时发布的那样，iOS 水平选择器控件 (STHorizo​​ntalPicker) 的类刚刚发布在[GitHub 上](https://github.com/stackthread/STHorizontalPicker)。它远没有 UIPickerView 复杂，但它提供了用于选择数值的基本功能，并且底层基础可能是添加更复杂功能的良好起点（它是一个 UIScrollView，其中包含一个带有多个 CATextLayers 的 UIView 作为标记）。

它被设计用于 UITableCellViews，目前看起来像这样： ![STH水平选择器](https://i.stack.imgur.com/nW2eN.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-18T11:01:32.597

[这个网站](http://isujith.wordpress.com/2009/03/17/horizontal-uipickerview/)有一个选择器的源代码，它水平对齐而不继承它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-18T17:18:52.723

这绝对看起来像一个自定义组件。我建议从你的 iPhone 上获取 .app 文件，打开捆绑包，然后查看是否有该接口的 xib 文件。您可能会很幸运并发现该组件坐在那里。我的猜测是它是 的子类`UIScrollView`，但如果不亲自了解开发人员或代码库，我当然无法确定这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-19T01:03:15.720

您将通过它们巨大的屏幕占用空间来识别选择器 :-) 这很可能是带有一系列固定宽度标签（或图像）的水平 UIScrollView。棘手的一点是让顶部的挡板带有透明的中心通道，可以接触到底层的滚动视图。或者您可以采取简单的方法并覆盖四个图像条（每个边缘）并保持中间打开，以便触摸事件直接进入滚动条。

这是一个自定义控件，但构建起来并不难。

# spam-prevention - 垃圾被张贴到网站

> ID：878779
> 
> 赞同：2
> 
> 时间：2009-05-18T17:10:29.557
> 
> 标签：spam-prevention, bots

我认为它是机器人或类似的东西。我们的网站上有论坛，每天我们都会收到 1000 次发布垃圾邮件的尝试。这些从未真正进入数据库，通常是通过抛出 ViewState 或 EventValidation 异常。我不确定我是否真的应该担心。我真的很想对这些机器人**做点什么。**他们不仅浪费了我们的资源，而且试图筛选所有这些错误以找出真正的错误也很烦人。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T17:36:50.143

听起来这不是内容问题。用户看不到垃圾邮件，因为绝大多数提交的内容格式错误。您有几个选项，具体取决于您对软件的控制：

1.  如果您编写了论坛软件，或者能够/愿意修改它，您可以捕获这些损坏的提交所引发**的最常见异常。**（听起来您已经确定了这些异常。）您可以将这些异常写入不同的“垃圾邮件日志”或类似的东西，这样您就可以进行统计和报告。
2.  使用垃圾邮件日志中的数据，或者甚至是您当前记录的数据，您可以识别经常发送这些错误提交的**IP 或范围，并****在防火墙处阻止它们**。但是，如果这真的是垃圾邮件，他们很可能有办法绕过它，因为这是一个非常基本的垃圾邮件拦截策略。
3.  这也可能不是垃圾邮件，而是一个糟糕的浏览器。如果您可以**将 User-Agent 信息添加到异常/垃圾邮件日志**中，您也许可以对其进行跟踪。您可能会很幸运，结果可能会发现为 IE5Mac 或 Mini Opera 或类似的东西修复表单不仅可以防止这些异常，而且还会增加您的访客数量。

除非这些提交对您网站的性能产生可衡量的影响，否则我认为做更多的事情并没有多大用处。添加验证码不会阻止垃圾邮件被提交，只是被*成功*提交（这听起来不像是现在的问题）。在这一点上，唯一值得您花时间的是将错误的提交分成单独的日志。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T17:16:47.063

我相信 CAPCHA 旨在解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:24:52.727

最佳解决方案取决于您论坛上的受欢迎程度（用户数量）。

大多数论坛软件都有验证码和相关技术的插件。这就是您想要的大型网站。对于小型网站，您可以通过在提交表单中添加一些随机问题来作弊，例如“你是人类吗？” 如果他们没有在输入框中输入“是”，他们就不会通过您的（图灵？）测试。大多数垃圾邮件发送者实际上并没有访问您的网站，他们只是运行脚本来寻找已知的论坛软件或明显的评论表单。

作为对您上一条评论的回应，您无法阻止真正的人类向您的网站发送垃圾邮件（即使拒绝链接也是不够的）。如果不关闭您的网站，您当然无法阻止任何人向您发送数据。您应该简单地让版主删除通过您的验证码获得的任何垃圾邮件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T17:37:41.373

你可以查看你的网络服务器的日志文件，看看这些连接来自什么类型的“用户代理”。IE/Firefox 等浏览器的用户代理签名类似于“Mozilla/4.0（兼容；MSIE 7.0；Windows NT 6.0）”

机器人可能有（少数）特定的用户代理签名，您可以将它们添加到服务器配置文件中的黑名单中，以便您的服务器忽略来自它们的请求。

你也应该花一点时间通读

[http://www.kloth.net/internet/bottrap.php](http://www.kloth.net/internet/bottrap.php)

# apache-flex - Eclipse Flex 插件删除了我的项目，有什么办法可以恢复它？

> ID：878784
> 
> 赞同：0
> 
> 时间：2009-05-18T17:10:48.730
> 
> 标签：apache-flex, actionscript-3, eclipse

我只是尝试使用 Eclipse 的“移动”功能来移动我的项目。Eclipse 没有移动它，而是删除了我的项目。我已经备份了大部分内容，但如果我无法恢复它，我将失去几个小时的工作。

有谁知道如何恢复它？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T17:18:29.620

如果您删除了该文件，我不确定这是否会起作用，但 Eclipse 确实有一个默认历史记录，其中应该包含您的代码。这在断电时帮助了我，并且用乱码覆盖了我的文件

编辑：好的，我查看了 Eclipse，尝试右键单击该文件夹，那里应该有一个替换为本地历史记录的选项。看看会不会有帮助。

# html - CSS - 非 IE 浏览器是否支持“过滤器”属性？

> ID：878786
> 
> 赞同：2
> 
> 时间：2009-05-18T17:11:07.903
> 
> 标签：html, css, internet-explorer, browser, cross-browser

IE5.5+ 支持 CSS 属性“ `filter`”，您可以在其中仅使用 CSS 将彩色图像转换为灰度。

```
filter: progid:DXImageTransform.Microsoft.BasicImage(grayscale=1); 
```

其他浏览器是否支持类似的 CSS 标签而不使用 JavaScript？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T17:12:29.053

不会。过滤器与 ActiveX 相关联。

[如何在其他浏览器中实现灰度的一个示例](http://james.padolsey.com/javascript/grayscaling-in-non-ie-browsers/)，但它确实使用 JavaScript。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T17:13:15.700

不，他们没有。实际上，您不应该在跨浏览器 Web 开发中使用它们，除非它是为了让 IE 以其他浏览器不具备的方式工作。一个明显的例子是 PNG 支持。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:12:41.283

您可以查看：[http ://snipplr.com/view/2836/grayscale-img-with-css-crossbrowser/](http://snipplr.com/view/2836/grayscale-img-with-css-crossbrowser/)

我希望它有所帮助。我仍然建议使用服务器端进行图像处理或 Photoshop。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-18T23:32:57.663

我很确定 Opera 支持一些 MS 的东西。无法准确找出他们支持的部分。

# ruby-on-rails - 将变音符号 (äüö) 替换为 Rails 中的 SEO 链接 - 最佳方式

> ID：878789
> 
> 赞同：5
> 
> 时间：2009-05-18T17:11:30.880
> 
> 标签：ruby-on-rails, ruby, string, seo, replace

我正在使用 permalink_fu 插件从标题创建永久链接。我的问题是：如果标题包含德文字符，它们将被替换为“_”。

我需要的是用ae ü 用ue ö 用oe 代替ä 的东西

我找到了 String.tr 但这里的问题是它用 1 个替换替换了 1 个字符，所以它可以替换

é 与 e ø 与 o

等等

有没有人有一个好的和干净的解决方案？

谢谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-12-26T11:53:44.427

查看 transliterate 和 parameterize（在 locales/de.yml 中使用音译）：

[http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-transliterate](http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-transliterate)

```
I18n.transliterate("Über der Höhenstraße")
 => "Ueber der Hoehenstrasse" 
```

[http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-parameterize](http://api.rubyonrails.org/classes/ActiveSupport/Inflector.html#method-i-parameterize)

```
"Über der Höhenstraße".parameterize
 => "ueber-der-hoehenstrasse" 
```

如果您不想自己编写音译，可以安装`rails-i18n`gem。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-18T17:32:16.347

我为此目的编写了一个名为[Asciify的小型库](http://github.com/levinalex/asciify/)

```
$ sudo gem install asciify 
```

用法：

```
#!/bin/ruby
require "asciify"

"Lücke".asciify   #=> "Luecke" 
```

您可以为自定义映射提供 YAML 文件，如下所示：

```
translator = Asciify.new("/path/to/mappings.yaml")
output_string = translator.convert("input string") 
```

（有关预期格式，请参阅[内置默认映射）](http://github.com/levinalex/asciify/blob/master/lib/mappings/default.yaml)

整个项目已经很老了，但也许它可以完成您需要的工作。如果没有，也许[源代码](http://github.com/levinalex/asciify/blob/6f1e67fd508fedf0288ca97fe7b2a2b7acbfca9f/lib/asciify.rb)会有所帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-18T17:27:35.653

使用[`String.gsub()`](http://www.ruby-doc.org/core-1.8.7/classes/String.html#M000756)：

```
"ich bin doch nicht blöd, mann!".gsub(/[äöü]/) do |match|
    case match
        when "ä"
          'ae'
        when "ö"
          'oe'
        when "ü"
          'ue'
    end
end 
```

当然，使用查找表可以改进查找，但原理要清楚。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-12-30T21:31:06.470

```
"äöü".gsub('ä','ae').gsub('ö','oe').gsub('ü','ue') 
```

;)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T17:29:18.350

试试[String.sub！](http://www.ruby-doc.org/core/classes/String.html#M000801).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T17:31:54.257

[我曾经问过一个类似的问题](https://stackoverflow.com/questions/286921/javascript-equivalent-of-xpaths-translate)。它适用于 JavaScript，它采用基于正则表达式的方法。从方法论上讲，也许该解决方案仍然对您有价值。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2010-03-29T14:01:20.200

尝试使用这个：`"Ich bin doch nicht böld ähhh ühh öhhh".gsub(/[äöüßÄÖÜ„“§%&–+]/){|t|t.to_xs}`

# qt - 将 qt 移植到另一个操作系统就这么简单吗？

> ID：878791
> 
> 赞同：6
> 
> 时间：2009-05-18T17:11:37.403
> 
> 标签：qt

将[Qt for Embedded Linux 移植到另一个操作系统](http://doc.trolltech.com/4.5/qt-embedded-porting-operatingsystem.html)一文列出了将 Qt for Embedded Linux 移植到另一个操作系统必须做的五件事。来自文章：

> 如果您打算将自己的端口移植到另一个操作系统，则需要注意几个问题。特别是您必须为嵌入式 Linux 的共享内存和信号量（用于共享窗口区域）解析 Qt，并且您必须为应用程序间通信提供类似于 Unix 域套接字的东西。您还必须提供屏幕驱动程序，如果要实现声音，则必须提供自己的声音服务器。最后，您必须修改 Qt for Embedded Linux 使用的事件分派器。

将 Qt 移植到另一个操作系统真的这么容易吗，还是我错过了一些信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-22T11:47:31.480

移植的另一个重要组件是 QAtomic，以确保您可以使原子操作和隐式共享运行良好。也可以看看

[http://labs.trolltech.com/blogs/2007/08/28/say-hello-to-qatomicint-and-qatomicpointer/](http://labs.trolltech.com/blogs/2007/08/28/say-hello-to-qatomicint-and-qatomicpointer/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-02T10:35:59.227

由于 Qt 已经被移植了很多次，它本质上很简单似乎是合乎逻辑的。但是，问题实际上在于您要移植到的平台以及它当前支持的功能数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-19T23:12:03.943

假设您发现所有这些事情都很容易，那么移植很容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-21T16:59:14.113

在对此进行了更详细的调查之后，我得出的结论是，文章“将 Qt for Embedded Linux 移植到另一个操作系统”假设您正在将 Qt 移植到一个非常“类似 linux”的操作系统。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-02T21:43:09.597

我已经尝试过了，目前正在取得进展。一些困难：

IDE - 我必须手动添加所有 Qt 文件并使用#ifdefs 与编译器对抗，直到它构建时所有依赖项都已到位。

Linux(ness) - 我不得不禁用我的目标操作系统不支持的所有 Linux/Windows 东西：线程、套接字、进程。甚至计时器也略有不同。

提示： 从小处着手：我在 IDE 中将 QtCore 编译为标准库，接下来是 QtGui，与 QtCore 相比它是一个庞然大物。

我计划只运行一个 QThread，所以我必须人为地制作一个 Thread 对象以避免空指针。您无法编译出线程信息，因为它是所有 QObjects 的关键。

到目前为止，我在 qcoreapplication 中运行了一个 qeventloop。我写了一些内联汇编，但在我的 IDE 和编译方面遇到了严重的困难。我把它留在 C++ 中，让汇编程序为我处理它。因为我是单线程的，所以我不太关心原子操作所需的共享数据/独占访问。

# c# - 使用 ServiceController 以不同的帐户启动服务

> ID：878799
> 
> 赞同：0
> 
> 时间：2009-05-18T17:12:55.857
> 
> 标签：c#, .net, windows-services

我正在使用`ServiceController`该类来启动（自定义）安装服务，如下所示：

```
var newServiceController = new ServiceController("theNameOfMyService");
newServiceController.Start(); 
```

麻烦的是，该服务总是在本地系统帐户下运行，而我希望它在我的帐户下运行。

谁能告诉我如何使用`ServiceController`在不同的帐户下运行服务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T17:17:02.803

我认为您不能...服务的凭据是在安装时提供的，或者通过 Service.msc 管理单元提供

服务控制器只能启动/停止预装的服务

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T17:24:00.777

在您服务的 ServiceProcessInstaller 实例上，有一个名为 Acount、Password 和 Username 的属性，可以使用这些属性来设置服务以谁运行。

# django - 模型表单集和日期字段

> ID：878805
> 
> 赞同：3
> 
> 时间：2009-05-18T17:15:03.993
> 
> 标签：django, datetime, templates, modelform

我在具有几个日期字段的模型上有一个模型表单集 - 这又是模型中的 DateTimeField。但是当它显示在模板中时，它显示为一个文本字段。如何将其显示为下拉框？

```
WFormSet = inlineformset_factory(UserProfile, W, can_delete=False,exclude=[<list of fields to be excluded>], extra=3) 
```

这就是我初始化模型集的方式。

如何覆盖这些设置

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T18:00:26.897

执行此操作的常用方法是[覆盖 ModelForm 定义中的默认字段类型](http://docs.djangoproject.com/en/dev/topics/forms/modelforms/#overriding-the-default-field-types)。

如果您的模型中有一个 DateField，下面的示例将起作用（我注意到您有一个 DateTimeField ...我会在几秒钟内回到那个）。您将指定与通常指定的完全相同的字段类型，但您将向表单字段构造函数传递不同的小部件。

```
from django.db import models
from django import forms
from django.forms.extras import SelectDateWidget

class MyModel(models.Model):
    a_date_field = models.DateField()

class MyModelForm(forms.ModelForm):
    a_date_field = forms.DateField(widget=SelectDateWidget())

    class Meta:
        model = MyModel 
```

据我所知，没有为`DateTimeField`Django 1.0.x 中提供的等效小部件。在这种情况下，您需要制作一个自定义小部件，可能是子类化`SelectDateWidget`。我从一个快速的谷歌上注意到`SelectDateTimeWidget`，还有其他几个人一直在制作您正在寻找的小部件。我没有使用过它们，所以请谨慎购买，但是像[这样的 SelectDateTimeWidget 补丁](http://code.djangoproject.com/attachment/ticket/6231/ticket_6231.patch)可能是一个不错的起点。

* * *

编辑：使用 ModelFormset 或 InlineModelFormset 时，您仍然可以通过传递`form=MyModelForm`给`inlineformet_factory`函数来实现：

```
MyModelFormset = inlineformset_factory(MyParentModel, MyModel, form=MyModelForm) 
```

这是有效的，因为这两个模型表单集工厂实际上`formset_factory`在它们自己的实现中调用了常规构造函数。有点难以弄清楚，因为它没有在文档中明确说明……而是 Django 文档通过顺便提到模型表单集工厂扩展了正常的表单集工厂来暗示这种能力。每当我有疑问时，我都会打开`django/forms/models.py`查看表单集工厂函数的完整签名。

# .net - 从简单的 XSD 模式生成 Xml 文档

> ID：878807
> 
> 赞同：2
> 
> 时间：2009-05-18T17:15:23.587
> 
> 标签：.net, asp.net, xsd

我有一个 xsd 文件，我需要从中生成一个 xml 文件。实现这一目标的最简单方法是什么？

[编辑：这里](https://stackoverflow.com/questions/761661/tool-to-generate-xml-file-from-xsd-for-testing)有一个类似的问题，所以我想结束我的问题。但是，如果您有答案，请发布...

**编辑：** 其中一位[受访者](https://stackoverflow.com/users/67985/demi)删除了他们的答案，但我发现它是最适合我的解决方案。它在[这里](http://msdn.microsoft.com/en-us/library/aa302296.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T17:57:41.257

它在[这里](http://msdn.microsoft.com/en-us/library/aa302296.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T17:23:02.917

看看使用[XMLSpy](http://www.altova.com/xml-editor/)。这是一个很棒的软件。。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:25:22.787

[Stylus Studio](http://www.stylusstudio.com/index.html)将通过使用示例数据创建 XML 来为您完成此操作。

文件 -> 文档向导 -> XML Schema to XML。

但是您想以编程方式执行此操作吗？

# c# - 平台详细信息捕获 API/工具——Windows 错误报告等效项

> ID：878811
> 
> 赞同：1
> 
> 时间：2009-05-18T17:16:11.560
> 
> 标签：c#, .net, windows, error-reporting

我正在开发一个用 C# 编写的基于 .NET 的桌面应用程序。如果应用程序崩溃，我想捕获有关运行应用程序的机器的某些详细信息：

1.  操作系统详细信息：版本、服务包等。
2.  .NET 详细信息：框架版本
3.  已安装的程序
4.  崩溃时正在运行的进程。
5.  我缺少的东西，但应该在这里。

是否有工具或 API 集可以让我方便地获得这一切？我想做的是调用 API（当崩溃发生时），捕获所有细节，并让用户能够将其报告给我。类似于 Windows 错误报告服务。

PS：目前，我无法注册[Windows 错误报告服务](http://www.microsoft.com/whdc/winlogo/maintain/StartWER.mspx)本身。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T17:34:10.913

1) System.OperatingSystem osInfo=System.Environment.OSVersion；

2) [http://geekswithblogs.net/lorint/archive/2006/01/30/67654.aspx](http://geekswithblogs.net/lorint/archive/2006/01/30/67654.aspx)

3) 字符串 registryKey = @"SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall";

```
 using (Microsoft.Win32.RegistryKey key = Registry.LocalMachine.OpenSubKey(registryKey)) 
        { 
            var query = from a in 
                            key.GetSubKeyNames() 
                        let r = key.OpenSubKey(a) 
                        select new 
                        { 
                            Application = r.GetValue("DisplayName") 
                        };

            foreach (var item in query) 
            { 
                if (item.Application != null)
                    Console.WriteLine(item.Application); 
            }
        } 
```

（通过[http://www.onedotnetway.com/get-a-list-of-installed-applications-using-linq-and-c/](http://www.onedotnetway.com/get-a-list-of-installed-applications-using-linq-and-c/)）

4)

```
Process[] processlist = Process.GetProcesses();

foreach(Process theprocess in processlist)
{
    Console.WriteLine("Process: {0} ID: {1}", theprocess.ProcessName, theprocess.Id);
} 
```

# c# - 如何调试 ASP.NET 2.0 Web 服务应用程序中的泄漏连接？

> ID：878819
> 
> 赞同：1
> 
> 时间：2009-05-18T17:18:11.803
> 
> 标签：c#, asp.net, web-services, .net-2.0, connection-leaks

我有一个应用程序，它是一堆 c# Web 服务，位于 Win2k3 上 IIS7 中的 ASP.NET 2.0 之上。在上一个版本之后，我们不断收到连接超时。使用 Perfmon 进行的快速调查证实我们的应用程序正在泄漏连接。

然而，在上一个版本中发生了太多代码更改，仅通过查看代码更改很难确定问题出在哪里。

有没有办法调试实际发生连接泄漏的位置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T17:21:35.930

您可以使用性能计数器来检查内存泄漏。

请参阅此链接：http: [//msdn.microsoft.com/en-us/library/fxk122b4.aspx](http://msdn.microsoft.com/en-us/library/fxk122b4.aspx)

它可以说明您的应用程序是否存在内存泄漏？但它不会找到导致这些事情的代码。为此，您必须调试应用程序。

# sql - 将充满逗号分隔值的 varchar 传递给 SQL Server IN 函数

> ID：878833
> 
> 赞同：69
> 
> 时间：2009-05-18T17:22:19.673
> 
> 标签：sql, sql-server, tsql, sql-in

> **[使用 Like 和 In的](https://stackoverflow.com/questions/303149/parameterized-queries-with-like-and-in-conditions)
> [动态 SQL 逗号分隔值查询参数化查询的](https://stackoverflow.com/questions/517028/dynamic-sql-comma-delimited-value-query)**重复****

 **我有一个 SQL Server 存储过程，我想将一个`varchar`完整的逗号分隔值传递给一个`IN`函数。例如：

```
DECLARE @Ids varchar(50);
SET @Ids = '1,2,3,5,4,6,7,98,234';

SELECT * 
FROM sometable 
WHERE tableid IN (@Ids); 
```

这当然行不通。我得到错误：

> 将 varchar 值 '1,2,3,5,4,6,7,98,234' 转换为数据类型 int 时转换失败。

我怎样才能在不求助于构建动态 SQL 的情况下完成这个（或类似的事情）？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2009-05-19T03:16:20.303

当然，如果你像我一样懒惰，你可以这样做：

```
Declare @Ids varchar(50) Set @Ids = ',1,2,3,5,4,6,7,98,234,'

Select * from sometable
 where Charindex(','+cast(tableid as varchar(8000))+',', @Ids) > 0 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-05-18T17:49:11.430

**不要使用循环分割字符串的函数！**，我下面的函数将非常快地分割一个字符串，没有循环！

在你使用我的功能之前，你需要建立一个“帮助”表，每个数据库只需要这样做一次：

```
CREATE TABLE Numbers
(Number int  NOT NULL,
    CONSTRAINT PK_Numbers PRIMARY KEY CLUSTERED (Number ASC)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]
DECLARE @x int
SET @x=0
WHILE @x<8000
BEGIN
    SET @x=@x+1
    INSERT INTO Numbers VALUES (@x)
END 
```

使用这个函数来分割你的字符串，它不会循环并且非常快：

```
CREATE FUNCTION [dbo].[FN_ListToTable]
(
     @SplitOn              char(1)              --REQUIRED, the character to split the @List string on
    ,@List                 varchar(8000)        --REQUIRED, the list to split apart
)
RETURNS
@ParsedList table
(
    ListValue varchar(500)
)
AS
BEGIN

/**
Takes the given @List string and splits it apart based on the given @SplitOn character.
A table is returned, one row per split item, with a column name "ListValue".
This function workes for fixed or variable lenght items.
Empty and null items will not be included in the results set.

Returns a table, one row per item in the list, with a column name "ListValue"

EXAMPLE:
----------
SELECT * FROM dbo.FN_ListToTable(',','1,12,123,1234,54321,6,A,*,|||,,,,B')

    returns:
        ListValue  
        -----------
        1
        12
        123
        1234
        54321
        6
        A
        *
        |||
        B

        (10 row(s) affected)

**/

----------------
--SINGLE QUERY-- --this will not return empty rows
----------------
INSERT INTO @ParsedList
        (ListValue)
    SELECT
        ListValue
        FROM (SELECT
                  LTRIM(RTRIM(SUBSTRING(List2, number+1, CHARINDEX(@SplitOn, List2, number+1)-number - 1))) AS ListValue
                  FROM (
                           SELECT @SplitOn + @List + @SplitOn AS List2
                       ) AS dt
                      INNER JOIN Numbers n ON n.Number < LEN(dt.List2)
                  WHERE SUBSTRING(List2, number, 1) = @SplitOn
             ) dt2
        WHERE ListValue IS NOT NULL AND ListValue!=''

RETURN

END --Function FN_ListToTable 
```

您可以将此函数用作连接中的表：

```
SELECT
    Col1, COl2, Col3...
    FROM  YourTable
        INNER JOIN FN_ListToTable(',',@YourString) s ON  YourTable.ID = s.ListValue 
```

这是您的示例：

```
Select * from sometable where tableid in(SELECT ListValue FROM dbo.FN_ListToTable(',',@Ids) s) 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2013-06-05T09:48:08.750

**无表无功能无循环**

基于将您的列表解析为我们的 DBA 建议使用 XML 的表的想法。

```
Declare @Ids varchar(50)
Set @Ids = ‘1,2,3,5,4,6,7,98,234’

DECLARE @XML XML
SET @XML = CAST('<i>' + REPLACE(@Ids, ',', '</i><i>') + '</i>' AS XML)

SELECT * 
FROM
    SomeTable 
    INNER JOIN @XML.nodes('i') x(i) 
        ON  SomeTable .Id = x.i.value('.', 'VARCHAR(MAX)') 
```

这些似乎与@KM 的答案具有相同的性能，但我认为要简单得多。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-18T17:29:30.800

您可以创建一个返回表的函数。

所以你的陈述会是这样的

```
select * from someable 
 join Splitfunction(@ids) as splits on sometable.id = splits.id 
```

这是一个模拟函数。

```
CREATE FUNCTION [dbo].[FUNC_SplitOrderIDs]
(
    @OrderList varchar(500)
)
RETURNS 
@ParsedList table
(
    OrderID int
)
AS
BEGIN
    DECLARE @OrderID varchar(10), @Pos int

    SET @OrderList = LTRIM(RTRIM(@OrderList))+ ','
    SET @Pos = CHARINDEX(',', @OrderList, 1)

    IF REPLACE(@OrderList, ',', '') <> ''
    BEGIN
        WHILE @Pos > 0
        BEGIN
            SET @OrderID = LTRIM(RTRIM(LEFT(@OrderList, @Pos - 1)))
            IF @OrderID <> ''
            BEGIN
                INSERT INTO @ParsedList (OrderID) 
                VALUES (CAST(@OrderID AS int)) --Use Appropriate conversion
            END
            SET @OrderList = RIGHT(@OrderList, LEN(@OrderList) - @Pos)
            SET @Pos = CHARINDEX(',', @OrderList, 1)

        END
    END 
    RETURN
END 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-05-18T19:52:01.370

这是一个很常见的问题。罐头答案，几个不错的技巧：

[http://www.sommarskog.se/arrays-in-sql-2005.html](http://www.sommarskog.se/arrays-in-sql-2005.html)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-05-18T17:32:49.607

这完美！下面的答案太复杂了。不要将其视为动态的。如下设置您的存储过程：

```
(@id as varchar(50))
as

Declare @query as nvarchar(max)
set @query ='
select * from table
where id in('+@id+')'
EXECUTE sp_executesql @query 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-05-18T17:26:13.817

在不使用动态 SQL 的情况下，您必须获取输入变量并使用拆分函数将数据放入临时表中，然后加入该表。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2015-09-26T05:18:49.360

我可以建议`WITH`这样使用：

```
DECLARE @Delim char(1) = ',';
SET @Ids = @Ids + @Delim;

WITH CTE(i, ls, id) AS (
    SELECT 1, CHARINDEX(@Delim, @Ids, 1), SUBSTRING(@Ids, 1, CHARINDEX(@Delim, @Ids, 1) - 1)
    UNION ALL
    SELECT i + 1, CHARINDEX(@Delim, @Ids, ls + 1), SUBSTRING(@Ids, ls + 1, CHARINDEX(@Delim, @Ids, ls + 1) - CHARINDEX(@Delim, @Ids, ls) - 1)
    FROM CTE
    WHERE  CHARINDEX(@Delim, @Ids, ls + 1) > 1
)
SELECT t.*
FROM yourTable t
    INNER JOIN
    CTE c
    ON t.id = c.id; 
```

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2017-05-31T06:07:43.087

我认为一个非常简单的解决方案可能如下：

```
DECLARE @Ids varchar(50);
SET @Ids = '1,2,3,5,4,6,7,98,234';

SELECT * 
FROM sometable 
WHERE ','+@Ids+',' LIKE '%,'+CONVERT(VARCHAR(50),tableid)+',%'; 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-03-05T06:37:15.320

谢谢，我使用它的功能............这是我的示例

```
**UPDATE [RD].[PurchaseOrderHeader]
SET     [DispatchCycleNumber] ='10'
 WHERE  OrderNumber in(select * FROM XA.fn_SplitOrderIDs(@InvoiceNumberList))**

CREATE FUNCTION [XA].[fn_SplitOrderIDs]
(
    @OrderList varchar(500)
)
RETURNS 
@ParsedList table
(
    OrderID int
)
AS
BEGIN
    DECLARE @OrderID varchar(10), @Pos int

    SET @OrderList = LTRIM(RTRIM(@OrderList))+ ','
    SET @Pos = CHARINDEX(',', @OrderList, 1)

    IF REPLACE(@OrderList, ',', '') <> ''
    BEGIN
        WHILE @Pos > 0
        BEGIN
                SET @OrderID = LTRIM(RTRIM(LEFT(@OrderList, @Pos - 1)))
                IF @OrderID <> ''
                BEGIN
                        INSERT INTO @ParsedList (OrderID) 
                        VALUES (CAST(@OrderID AS int)) --Use Appropriate conversion
                END
                SET @OrderList = RIGHT(@OrderList, LEN(@OrderList) - @Pos)
                SET @Pos = CHARINDEX(',', @OrderList, 1)

        END
    END 
    RETURN
END 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-10-06T08:17:58.927

如果您使用 SQL Server 2008 或更高版本，请使用表值参数；例如：

```
CREATE PROCEDURE [dbo].[GetAccounts](@accountIds nvarchar)
AS
BEGIN
    SELECT * 
    FROM accountsTable 
    WHERE accountId IN (select * from @accountIds)
END

CREATE TYPE intListTableType AS TABLE (n int NOT NULL)

DECLARE @tvp intListTableType 

-- inserts each id to one row in the tvp table    
INSERT @tvp(n) VALUES (16509),(16685),(46173),(42925),(46167),(5511)

EXEC GetAccounts @tvp 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2016-02-23T11:17:33.920

已经有一段时间了，但我过去曾使用 XML 作为过渡。

我对此不以为然，但恐怕我不再知道我从哪里得到这个想法：

```
-- declare the variables needed
DECLARE @xml as xml,@str as varchar(100),@delimiter as varchar(10)

-- The string you want to split
SET @str='A,B,C,D,E,Bert,Ernie,1,2,3,4,5'

-- What you want to split on. Can be a single character or a string
SET @delimiter =','

-- Convert it to an XML document
SET @xml = cast(('<X>'+replace(@str,@delimiter ,'</X><X>')+'</X>') as xml)

-- Select back from the XML
SELECT N.value('.', 'varchar(10)') as value FROM @xml.nodes('X') as T(N) 
```

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2017-03-07T11:26:18.143

创建一个像下面这样的表函数，它解析逗号分隔的 varchar 并返回一个可以与其他表进行内部连接的表。

```
CREATE FUNCTION [dbo].[fn_SplitList]
(
  @inString     varchar(MAX)  = '',
  @inDelimiter  char(1)       = ',' -- Keep the delimiter to 100 chars or less.  Generally a delimiter will be 1-2 chars only.
)
RETURNS @tbl_Return  table
(
  Unit  varchar(1000) COLLATE Latin1_General_BIN
)
AS
BEGIN 
    INSERT INTO @tbl_Return
    SELECT DISTINCT
      LTRIM(RTRIM(piece.value('./text()[1]', 'varchar(1000)'))) COLLATE DATABASE_DEFAULT AS Unit
    FROM
    (
      --
      --  Replace any delimiters in the string with the "X" tag.
      --
      SELECT
        CAST(('<X>' + REPLACE(s0.prsString, s0.prsSplitDelimit, '</X><X>') + '</X>') AS xml).query('.') AS units
      FROM
      (
        --
        --  Convert the string and delimiter into XML.
        --
        SELECT
          (SELECT @inString FOR XML PATH('')) AS prsString,
          (SELECT @inDelimiter FOR XML PATH('')) AS prsSplitDelimit
      ) AS s0
    ) AS s1
    CROSS APPLY units.nodes('X') x(piece)
  RETURN
END 
```

================================================== 现在在您的代码中使用上面创建的表函数，函数的创建是您数据库中的一次性活动，可以跨数据库使用，也可以在同一台服务器上使用。

```
DECLARE @Ids varchar(50);
SET @Ids = '1,2,3,5,4,6,7,98,234';

SELECT
     *
FROM sometable AS st
INNER JOIN fn_SplitList(@ids, ',') AS sl
     ON sl.unit = st.tableid 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-05-18T17:29:35.260

我之前写过一个存储过程来展示如何做到这一点。您基本上必须处理字符串。我试图在这里发布代码，但格式变得很糟糕。

```
IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'[dbo].[uspSplitTextList]') AND OBJECTPROPERTY(id, N'IsProcedure') = 1)
   DROP PROCEDURE [dbo].[uspSplitTextList]
GO

SET QUOTED_IDENTIFIER ON 
GO
SET ANSI_NULLS ON 
GO

/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
-- uspSplitTextList
--
-- Description:
--    splits a separated list of text items and returns the text items
--
-- Arguments:
--    @list_text        - list of text items
--    @Delimiter        - delimiter
--
-- Notes:
-- 02/22/2006 - WSR : use DATALENGTH instead of LEN throughout because LEN doesn't count trailing blanks
--
-- History:
-- 02/22/2006 - WSR : revised algorithm to account for items crossing 8000 character boundary
-- 09/18/2006 - WSR : added to this project
--
CREATE PROCEDURE uspSplitTextList
   @list_text           text,
   @Delimiter           varchar(3)
AS

SET NOCOUNT ON

DECLARE @InputLen       integer         -- input text length
DECLARE @TextPos        integer         -- current position within input text
DECLARE @Chunk          varchar(8000)   -- chunk within input text
DECLARE @ChunkPos       integer         -- current position within chunk
DECLARE @DelimPos       integer         -- position of delimiter
DECLARE @ChunkLen       integer         -- chunk length
DECLARE @DelimLen       integer         -- delimiter length
DECLARE @ItemBegPos     integer         -- item starting position in text
DECLARE @ItemOrder      integer         -- item order in list
DECLARE @DelimChar      varchar(1)      -- first character of delimiter (simple delimiter)

-- create table to hold list items
-- actually their positions because we may want to scrub this list eliminating bad entries before substring is applied
CREATE TABLE #list_items ( item_order integer, item_begpos integer, item_endpos integer )

-- process list
IF @list_text IS NOT NULL
   BEGIN

   -- initialize
   SET @InputLen = DATALENGTH(@list_text)
   SET @TextPos = 1
   SET @DelimChar = SUBSTRING(@Delimiter, 1, 1)
   SET @DelimLen = DATALENGTH(@Delimiter)
   SET @ItemBegPos = 1
   SET @ItemOrder = 1
   SET @ChunkLen = 1

   -- cycle through input processing chunks
   WHILE @TextPos <= @InputLen AND @ChunkLen <> 0
      BEGIN

      -- get current chunk
      SET @Chunk = SUBSTRING(@list_text, @TextPos, 8000)

      -- setup initial variable values
      SET @ChunkPos = 1
      SET @ChunkLen = DATALENGTH(@Chunk)
      SET @DelimPos = CHARINDEX(@DelimChar, @Chunk, @ChunkPos)

      -- loop over the chunk, until the last delimiter
      WHILE @ChunkPos <= @ChunkLen AND @DelimPos <> 0
         BEGIN

         -- see if this is a full delimiter
         IF SUBSTRING(@list_text, (@TextPos + @DelimPos - 1), @DelimLen) = @Delimiter
            BEGIN

            -- insert position
            INSERT INTO #list_items (item_order, item_begpos, item_endpos)
            VALUES (@ItemOrder, @ItemBegPos, (@TextPos + @DelimPos - 1) - 1)

            -- adjust positions
            SET @ItemOrder = @ItemOrder + 1
            SET @ItemBegPos = (@TextPos + @DelimPos - 1) + @DelimLen
            SET @ChunkPos = @DelimPos + @DelimLen

            END
         ELSE
            BEGIN

            -- adjust positions
            SET @ChunkPos = @DelimPos + 1

            END

         -- find next delimiter      
         SET @DelimPos = CHARINDEX(@DelimChar, @Chunk, @ChunkPos)

         END

      -- adjust positions
      SET @TextPos = @TextPos + @ChunkLen

      END

   -- handle last item
   IF @ItemBegPos <= @InputLen
      BEGIN

      -- insert position
      INSERT INTO #list_items (item_order, item_begpos, item_endpos)
      VALUES (@ItemOrder, @ItemBegPos, @InputLen)

      END

   -- delete the bad items
   DELETE FROM #list_items
   WHERE item_endpos < item_begpos

   -- return list items
   SELECT SUBSTRING(@list_text, item_begpos, (item_endpos - item_begpos + 1)) AS item_text, item_order, item_begpos, item_endpos
   FROM #list_items
   ORDER BY item_order

   END

DROP TABLE #list_items

RETURN

/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */

GO
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS ON 
GO 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2016-11-29T02:14:38.913

我对用户 KM 有同样的想法。但不需要额外的表号。仅此功能。

```
CREATE FUNCTION [dbo].[FN_ListToTable]
(
    @SplitOn              char(1)              --REQUIRED, the character to split the @List string on
   ,@List                 varchar(8000)        --REQUIRED, the list to split apart
)
RETURNS
@ParsedList table
(
    ListValue varchar(500)
)
AS
BEGIN
    DECLARE @number int = 0
    DECLARE @childString varchar(502) = ''
    DECLARE @lengthChildString int = 0
    DECLARE @processString varchar(502) = @SplitOn + @List + @SplitOn

    WHILE @number < LEN(@processString)
    BEGIN
        SET @number = @number + 1
        SET @lengthChildString = CHARINDEX(@SplitOn, @processString, @number + 1) - @number - 1
        IF @lengthChildString > 0
        BEGIN
            SET @childString = LTRIM(RTRIM(SUBSTRING(@processString, @number + 1, @lengthChildString)))

            IF @childString IS NOT NULL AND @childString != ''
            BEGIN
                INSERT INTO @ParsedList(ListValue) VALUES (@childString)
                SET @number = @number + @lengthChildString - 1
            END
        END
    END

RETURN

END 
```

这是测试：

```
SELECT ListValue FROM dbo.FN_ListToTable('/','a/////bb/c') 
```

结果：

```
 ListValue
______________________
   a
   bb
   c 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2012-07-31T11:20:14.517

```
-- select * from dbo.Split_ID('77,106')  

    ALTER FUNCTION dbo.Split_ID(@String varchar(8000))     
    returns @temptable TABLE (ID varchar(8000))     
    as     
    begin     
        declare @idx int     
        declare @slice varchar(8000)     
        declare @Delimiter char(1)
         set @Delimiter =','

        select @idx = 1     
            if len(@String)<1 or @String is null  return     

        while @idx!= 0     
        begin     
            set @idx = charindex(@Delimiter,@String)     
            if @idx!=0     
                set @slice = left(@String,@idx - 1)     
            else     
                set @slice = @String     

            if(len(@slice)>0)
                insert into @temptable(ID) values(@slice)     

            set @String = right(@String,len(@String) - @idx)     
            if len(@String) = 0 break     
        end 
    return     
    end 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2014-12-22T12:58:08.593

你可以这样做：

```
create or replace 
PROCEDURE UDP_SETBOOKMARK 
(
  P_USERID IN VARCHAR2  
, P_BOOKMARK IN VARCHAR2  
) AS 
BEGIN

UPDATE T_ER_Bewertung
SET LESEZEICHEN = P_BOOKMARK
WHERE STAMM_ID in( select regexp_substr(P_USERID,'[^,]+', 1, level) from dual
                   connect by regexp_substr(P_USERID, '[^,]+', 1, level) is not null )
and ER_ID = (select max(ER_ID) from T_ER_Bewertung_Kopie);

commit;

END UDP_SETBOOKMARK; 
```

然后尝试使用

```
Begin
UDP_SETBOOKMARK ('1,2,3,4,5', 'Test');
End; 
```

您也可以在其他情况下将此 IN-Clause 与 regexp_substr 一起使用，只需尝试一下。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-07-21T17:51:08.883

```
Error 493: The column 'i' that was returned from the nodes() method cannot be 
   used directly. It can only be used with one of the four XML data type 
   methods, exist(), nodes(), query(), and value(), or in IS NULL and IS NOT 
   NULL checks. 
```

使用以下代码段在 SQL Server 2014 中修复了上述错误

```
Declare @Ids varchar(50)
Set @Ids = '1,2,3,5,4,6,7,98,234'

DECLARE @XML XML
SET @XML = CAST('<i>' + REPLACE(@Ids, ',', '</i><i>') + '</i>' AS XML)

SELECT SomeTable.* 
FROM
    SomeTable 
    cross apply @XML.nodes('i') x(i) 
        where SomeTable .Id = x.i.value('.', 'VARCHAR(MAX)') 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-08-20T03:31:36.447

试试这个：

```
SELECT ProductId, Name, Tags  
FROM Product  
WHERE '1,2,3,' LIKE '%' + CAST(ProductId AS VARCHAR(20)) + ',%'; 
```

如[该链接的最后一个示例所述](https://docs.microsoft.com/en-us/sql/t-sql/functions/string-split-transact-sql)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-11-06T10:36:53.643

最好和简单的方法。

```
DECLARE @AccumulateKeywordCopy NVARCHAR(2000),@IDDupCopy NVARCHAR(50);
SET @AccumulateKeywordCopy ='';
SET @IDDupCopy ='';
SET @IDDup = (SELECT CONVERT(VARCHAR(MAX), <columnName>) FROM <tableName> WHERE <clause>)

SET @AccumulateKeywordCopy = ','+@AccumulateKeyword+',';
SET @IDDupCopy = ','+@IDDup +',';
SET @IDDupCheck = CHARINDEX(@IDDupCopy,@AccumulateKeywordCopy) 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-02-21T08:42:47.797

```
CREATE TABLE t 
  ( 
     id   INT, 
     col1 VARCHAR(50) 
  ) 

INSERT INTO t 
VALUES     (1, 
            'param1') 

INSERT INTO t 
VALUES     (2, 
            'param2') 

INSERT INTO t 
VALUES     (3, 
            'param3') 

INSERT INTO t 
VALUES     (4, 
            'param4') 

INSERT INTO t 
VALUES     (5, 
            'param5') 

DECLARE @params VARCHAR(100) 

SET @params = ',param1,param2,param3,' 

SELECT * 
FROM   t 
WHERE  Charindex(',' + Cast(col1 AS VARCHAR(8000)) + ',', @params) > 0 
```

工作小提琴在这里找到[小提琴](http://sqlfiddle.com/#!3/71c5d/1)

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2020-11-28T22:05:06.153

我遇到了同样的问题，我不想在源数据库上留下任何足迹——即没有存储过程或函数。我是这样处理的：

```
declare @IDs table (Value int)

insert into @IDs values(1)
insert into @IDs values(2)
insert into @IDs values(3)
insert into @IDs values(5)
insert into @IDs values(4)
insert into @IDs values(6)
insert into @IDs values(7)
insert into @IDs values(98)
insert into @IDs values(234)

SELECT * 
FROM sometable 
WHERE tableid IN (select Value from @IDs) 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-05-11T12:16:01.720

*@RBarryYoung*（上图）的答案对我有用。但是当逗号分隔的字符串值之间有空格时，它将省略带空格的 ID。所以我删除了空格。

看看下面的代码片段。

```
Declare @Ids varchar(50) Set @Ids = '1   ,   2,3'
set @Ids=','+Replace(@Ids,' ', '')+',';

Select * from [tblEmployee]
where Charindex(','+cast(ID as varchar(8000))+',', @Ids) > 0 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-06-10T04:22:41.123

这里有很多答案，但要加上我的两分钱，我认为`STRING_SPLIT`这是解决此类问题的一种非常简单的方法：

```
DECLARE @Ids varchar(50);
SET @Ids = '1,2,3,5,4,6,7,98,234';

SELECT * 
FROM sometable 
WHERE tableid IN;
(SELECT value FROM STRING_SPLIT(@Ids, ',')) 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2017-03-30T04:54:46.413

我发现最简单的方法是使用 FIND_IN_SET

```
FIND_IN_SET(column_name, values)

values=(1,2,3)

SELECT name WHERE FIND_IN_SET(id, values) 
```

* * *

## 回答 #26

> 赞同：-1
> 
> 时间：2020-05-21T09:02:36.147

这对于我不想使用 CTE 也不想使用内部连接的要求之一非常有用。

```
DECLARE @Ids varchar(50);
SET @Ids = '1,2,3,5,4,6,7,98,234';

SELECT
   cn1,cn2,cn3
FROM tableName
WHERE columnName in (select Value from fn_SplitString(@ids, ',')) 
```

拆分字符串的功能：

```
CREATE FUNCTION [dbo].[fn_SplitString] ( @stringToSplit VARCHAR(MAX), @seperator Char )  
RETURNS  
 @returnList TABLE ([Value] [nvarchar] (500))  
AS  
BEGIN  

 DECLARE @name NVARCHAR(255)  
 DECLARE @pos INT  

 WHILE CHARINDEX(@seperator, @stringToSplit) > 0  
 BEGIN  
  SELECT @pos  = CHARINDEX(@seperator, @stringToSplit)    
  SELECT @name = SUBSTRING(@stringToSplit, 1, @pos-1)  

  INSERT INTO @returnList   
  SELECT @name  

  SELECT @stringToSplit = SUBSTRING(@stringToSplit, @pos+1, LEN(@stringToSplit)-@pos)  
 END  

 INSERT INTO @returnList  
 SELECT @stringToSplit  

 RETURN  
END 
```

# svn - 如何使用颠覆一次提交多个目录？

> ID：878834
> 
> 赞同：9
> 
> 时间：2009-05-18T17:22:23.323
> 
> 标签：svn, commit, checkin

我尝试使用 svn ci dir/a dir/b -m "my comment" 但这不起作用。我还使用了 svn ci dir/a/* dir/b/* -m "my comment" 也不起作用。

我知道你可以指定多个文件，但是我如何告诉 subversion 签入这些文件夹中所有修改过的文件？我主要想这样做，以便我的所有更改都在一个修订版中生效。我可以一次签入一个目录，但这最终会为每个目录提供不同的修订版..

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-18T18:27:35.877

您可能需要指定“但这不起作用”是什么意思，因为它在这里可以正常工作：

```
D:\Projects>svn commit -m 'test1' test\aaa "test\aaa bbb ccc"
Sending        test\aaa\aaa222\xxx.txt
Sending        test\aaa bbb ccc\aaa.txt
Transmitting file data ..
Committed revision 8.

D:\Projects> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T17:24:14.600

```
svn add dir/a
svn add dir/b
svn commit 
```

虽然，更有可能的是，你在想：

```
svn add dir/*
svn commit 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T17:26:11.710

我认为您只有一个选项：签入包含目录 - 将这两个目录都作为子目录的目录。

如果它们还没有像那样组织（即它们都是 repo 中的顶级目录），那么你可以做的事情不多 - svn 命令只能在单个目录上工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-06T14:27:11.597

您可以使用 --changelist 选项，在顶级目录上创建一个包含您要提交的所有文件的更改列表，然后提交该更改列表。

来源和信息： [svn book：changelist](http://svnbook.red-bean.com/en/1.7/svn.advanced.changelists.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T17:26:38.167

如果您从更高级别的文件夹中签出 a 和 b 所在的位置，这很容易。因此，如果您的工作副本是“dir”并且 a 和 b 有更改，请提交“dir”以提交对两者的更改。我一直这样做。

**编辑：**
要提交多个文件夹，您需要将它们放在同一个工作副本中。

如果您担心要处理的东西太多，您可以尝试只使用您需要的文件夹进行稀疏检出，然后您可以根据需要提交基本目录*或*子目录，而不会产生其他项目的开销。

[稀疏目录信息](http://svnbook.red-bean.com/en/1.5/svn.advanced.sparsedirs.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T19:59:19.967

考虑使用 svn:externals 属性来检出存储库的一部分。您可以选择要获取的目录，然后在一个步骤中提交到多个目标。我们使用这种方法已经有一段时间了，并取得了巨大的成功。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-06-15T04:09:19.280

考虑以下是查询

1.  您有很多文件从存储库签出到多个目录中，其中许多文件已被修改，您不记得哪些文件被修改了，您将很难一次合并一个文件，然后执行以下操作

转到顶级目录并运行命令

```
svn ci -m "comments" 
```

这将签入顶级目录下的所有修改文件以及它下面的许多子目录。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-01T23:29:14.877

遇到了类似的问题。我有一个存储库，我需要有一些存储库子文件夹的两个单独的工作副本。存储库是这样的：

```
/web/lib
/web/htdocs
... 
```

...我需要在单独的工作副本中（分别）：

```
C:/.../web/lib
C:/.../htdocs/cbs 
```

我通过拥有 in 的“主”工作副本`/web`并`C:/.../web`在`C:/.../htdocs/cbs`“指向”到`C:/.../web/htdocs`. 因此，每当我在其中一个工作副本中进行本地更改时，我总是提交`C:/.../web`，它自然包含来自两个工作副本的更改。

我希望这种方式对你有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-02T15:21:40.693

自从提出这个问题以来已经有很长时间了，但我有任何迟到的更新。

假设您有一个像 dir/a, dir/b, dir/c, dir/d.... 这样的树，并且只想在子文件夹 a 和 b 中提交更改，则以下命令有效：

svn ci dir/a/* dir/b/* -m "我的评论"

如果您在七年前尝试时确实无法使用，我只能假设此功能是在后续版本中添加的。

# c# - 在流上加盐 C# MD5 ComputeHash

> ID：878837
> 
> 赞同：3
> 
> 时间：2009-05-18T17:23:11.293
> 
> 标签：c#, hash, stream, md5, salt

我看不到任何方法来加盐 MD5.ComputeHash(Stream)。我是否错过了将字节注入 HashAlgorithm 的某种方式？

我尝试在执行流计算之前执行 ComputeHash(byte[])，但不出所料，它没有任何效果。任何想法（除了修改文件）？

谢谢你的时间。

**附录** 更具体一点，我想使用流来获取我不想加载到内存中的大文件的哈希值。

```
FileInfo myFI= new FileInfo("bigfile.dat");
FileStream myIFS = piFile.OpenRead();
MD5 md5 = MD5.Create();
byte[] hash = md5.ComputeHash ( myIFS );
myIFS.Close (); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T19:16:17.823

在我看来，缺乏例子的答案是：你真的不需要加盐。

像 MD5 这样的哈希算法采用任意长度的字节表并将其转换为已知长度的字节表 - 该操作不易可逆，对输入表的微小更改会导致输出表发生不可预测的变化：

输入 => MD5 => 输出

加盐的目的是防止用户已经预先计算了哈希结果表（[彩虹表](http://en.wikipedia.org/wiki/Rainbow_table)）的攻击。通过在输入中引入微小的变化，结果会发生巨大的变化，因此即使攻击者知道哈希结果和盐，也很难猜测输入：

输入 + 盐 => MD5 => 输出

散列文件的原因是计算校验和。例如，您在网页上发布一个文件以及哈希结果。用户然后下载一个文件，通过 MD5 运行它并将结果与​​您发布的结果进行比较。篡改文件将非常困难，因为每次操作都会更改生成的哈希值。

此处不需要加盐，因为您必须使用生成的散列发布盐，以便用户可以重复散列操作。

如果您确实需要引入盐渍，只需以可重复的方式更改输入流，例如在每个字节中添加一个（带有溢出）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-14T17:06:27.673

这是正确的方法：

```
 private static byte[] _emptyBuffer = new byte[0];

    public static byte[] CalculateMD5(Stream stream)
    {
        return CalculateMD5(stream, 64 * 1024);
    }

    public static byte[] CalculateMD5(Stream stream, int bufferSize)
    {
        MD5 md5Hasher = MD5.Create();

        byte[] buffer = new byte[bufferSize];
        int readBytes;

        while ((readBytes = stream.Read(buffer, 0, bufferSize)) > 0)
        {
            md5Hasher.TransformBlock(buffer, 0, readBytes, buffer, 0);
        }

        md5Hasher.TransformFinalBlock(_emptyBuffer, 0, 0);

        return md5Hasher.Hash;
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-22T23:35:54.103

您可以考虑使用[HMACMD5](http://msdn.microsoft.com/en-us/library/system.security.cryptography.hmacmd5.aspx)类并设置[Key](http://msdn.microsoft.com/en-us/library/system.security.cryptography.hmac.key.aspx)属性。一般来说，我会使用 HMAC 而不是标准哈希函数，因为它们提供了更好的安全性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T18:34:04.473

我认为您可以使用如下语法：

```
byte[] saltedBytes;
//TODO: fill the saltedBytes;
var hasher=new MD5CryptoServiceProvider();
var memoryStream=new MemoryStream(saltedBytes);
hasher.ComputeHash(memoryStream);
memoryStream.Close; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-22T23:27:48.160

为避免像 Dabblernl 的解决方案一样将所有文件拉入内存，您需要使用 FileStream ，如本 SO 问题[Computing MD5SUM of large files in C#](https://stackoverflow.com/questions/805730/computing-md5sum-of-large-files-in-c)中所述，但 MD5CryptoServiceProvider 不允许您在末尾添加额外数据。

因此，您需要这样的合并流：

```
public class MergedStream : Stream, IDisposable
{
    Stream s1;
    Stream s2;

    public MergedStream(Stream first, Stream second)
    {
        s1 = first;
        s2 = second;
    }

    public override int Read(byte[] buffer, int offset, int count)
    {
        int s1count = (int)Math.Min((long)count, s1.Length - s1.Position);
        int bytesRead = 0;

        if (s1count > 0)
        {
            bytesRead += s1.Read(buffer, offset, s1count);
        }

        if (s1count < count)
        {
            bytesRead += s2.Read(buffer, offset + s1count, count - s1count);
        }

        return bytesRead;
    }

    public override void Write(byte[] buffer, int offset, int count)
    {
        throw new NotImplementedException();
    }

    public override bool CanRead
    {
        get { return s1.CanRead && s2.CanRead; }
    }

    public override bool CanSeek
    {
        get { return s1.CanSeek && s2.CanSeek; }
    }

    public override bool CanWrite
    {
        get { return s1.CanWrite && s2.CanWrite; }
    }

    public override void Flush()
    {
        s1.Flush();
        s2.Flush();
    }

    public override long Length
    {
        get { return s1.Length + s2.Length; }
    }

    public override long Position
    {
        get
        {
            return s1.Position + s2.Position;
        }
        set
        {
            throw new NotImplementedException();
        }
    }

    public override long Seek(long offset, SeekOrigin origin)
    {
        throw new NotImplementedException();
    }

    public override void SetLength(long value)
    {
        throw new NotImplementedException();
    }

    void IDisposable.Dispose()
    {
        s1.Dispose();
        s2.Dispose();
    }
} 
```

然后您可以像这样使用它来为您的文件散列加盐

```
 FileStream fs = new FileStream(@"c:\text.txt", FileMode.Open);
        var m = new MemoryStream(ToAnsiiBytes("SALT"), false);
        var ms = new MergedStream(fs, m);

        var C = hasher.ComputeHash(ms);
        PrintHash(Console.Out, C); 
```

ToAnsiiBytes 和 PrintHash 只是这样的实用函数：

```
 static void HashAndPrint(TextWriter op, string text)
    {
        MD5 md5 = new MD5CryptoServiceProvider();

        byte[] bytes = ToAnsiiBytes(text);

        byte[] hash = md5.ComputeHash(bytes);

        PrintHash(Console.Out, hash);
        Console.Out.WriteLine( " = {0}", text);
    } 
```

和

```
 public static void PrintHash(TextWriter op, byte[] hash)
    {
        foreach (byte b in hash)
        {
            op.Write("{0:X2}", b);
        }
    } 
```

当文件 c:\text.txt 包含文本*toto*时，您可以运行此代码以查看文件 + salt 等于文本“totoSALT”

```
 FileStream fs = new FileStream(@"c:\text.txt", FileMode.Open);

        var hasher = new MD5CryptoServiceProvider();
        var A = hasher.ComputeHash(fs);
        PrintHash(Console.Out, A);
        Console.Out.WriteLine();

        var salt = new byte[] { 0x53, 0x41, 0x4C, 0x54 };

        var B = hasher.ComputeHash(ToAnsiiBytes("SALT"));
        PrintHash(Console.Out, B);
        Console.Out.WriteLine();

        var m = new MemoryStream(ToAnsiiBytes("SALT"), false);

        fs.Seek(0, SeekOrigin.Begin);
        var ms = new MergedStream(fs, m);

        var C = hasher.ComputeHash(ms);
        PrintHash(Console.Out, C);
        Console.Out.WriteLine();

        HashAndPrint(Console.Out, "toto");
        HashAndPrint(Console.Out, "totoSALT");
        HashAndPrint(Console.Out, "SALT"); 
```

有了这个输出

```
F71DBE52628A3F83A77AB494817525C6
8C4F4370C53E0C1E1AE9ACD577DDDBED
308DB2451D6580FEEB09FCF2DC1CEE19
F71DBE52628A3F83A77AB494817525C6 = toto
308DB2451D6580FEEB09FCF2DC1CEE19 = totoSALT
8C4F4370C53E0C1E1AE9ACD577DDDBED = SALT 
```

# java - 用数据填充 ResultSet 的简单方法

> ID：878848
> 
> 赞同：24
> 
> 时间：2009-05-18T17:26:17.810
> 
> 标签：java, unit-testing, jdbc, mocking, resultset

我想模拟一个结果集。严重地。我正在重构一大段复杂的代码，它正在解析来自 ResultSet 的数据，并且我希望我的代码具有相同的行为。因此，我需要为正在重构的部分编写一个单元测试，以便能够对此进行测试。

谷歌搜索后，我想出了两个想法：

1.  使用 EasyMock，编写 looooong 模拟序列。非常糟糕的解决方案：难以添加初始数据，难以更改数据，大型测试调试promice。
2.  使用 Apache Derby 或 HSQLDB 创建内存数据库，从文件或字符串数​​组中填充它，使用一些神奇的 InMemoryDBUtils.query(sql) 进行查询。然后使用该结果集。不幸的是，我没有找到任何神奇的 InMemoryDBUtils 来快速编写测试:-)。IBM 文章“使用 Derby 进行持久性的隔离单元测试”似乎很好地满足了我的需求，不过......

第二种方法看起来更容易并且更受支持。

你对创建这样一个模拟有什么建议？（尽管有医生，当然:-)？我错过~~了~~一些银弹吗？可能，DBUnit 是这个工具？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2009-05-18T18:07:34.840

我从这里的 MockResultSet 类取得了成功：http: [//mockrunner.sourceforge.net/](http://mockrunner.sourceforge.net/)。它允许您创建一个实现 ResultSet 接口的类，并允许您设置每一列和每一行的值。

如果您的方法使用大小合理的 ResultSet，您应该能够创建测试来相当容易地返回您需要的值。

这是一个简单的例子：

```
MockResultSet rs = new MockResultSet("myMock");

rs.addColumn("columnA", new Integer[]{1});
rs.addColumn("columnB", new String[]{"Column B Value"});
rs.addColumn("columnC", new Double[]{2});

// make sure to move the cursor to the first row
try
{
  rs.next();
}
catch (SQLException sqle)
{
  fail("unable to move resultSet");
}

// process the result set
MyObject obj = processor.processResultSet(rs);

// run your tests using the ResultSet like you normally would
assertEquals(1, obj.getColumnAValue());
assertEquals("Column B Value", obj.getColumnBValue());
assertEquals(2.0d, obj.getColumnCValue()); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-05-18T17:52:36.837

据我所知，DBUnit 不提供结果集，尽管它可以很好地帮助您填充内存数据库。

我会说在这一点上模拟框架是错误的方法。模拟是关于测试行为和交互，而不仅仅是返回数据，所以它可能会妨碍你。

相反，我要么实现结果集接口，要么创建结果集接口的动态代理到实现您关心的方法的类，而不必实现整个结果集。您可能会发现维护一个类就像维护一个内存数据库一样容易（假设被测数据集是一致的），并且可能更容易调试。

您可以使用 DBUnit 备份该类，在其中使用 dbunit 拍摄结果集的快照，并让 dbunit 在测试期间从 xml 读取它，并让您的虚拟结果集从 dbunit 的类中读取数据。如果数据稍微复杂，这将是一种合理的方法。

如果类是如此耦合以至于它们需要读取作为同一测试的一部分而修改的数据，我会选择内存数据库。即使那样，我也会考虑使用真实数据库的副本，直到您设法将这种依赖关系分开。

一个简单的代理生成方法：

```
private static class SimpleInvocationHandler implements InvocationHandler {
    private Object invokee;

    public SimpleInvocationHandler(Object invokee) {
        this.invokee = invokee;
    }

    public Object invoke(Object proxy, Method method, Object[] args)
            throws Throwable {
        method = invokee.getClass().getMethod(method.getName(), method.getParameterTypes());
        if (!method.isAccessible()) {
            method.setAccessible(true);
        }
        try {
            return method.invoke(invokee, args);
        } catch (InvocationTargetException e) {
            throw e.getTargetException();
        }
    }
}

public static <T> T generateProxy(Object realObject, Class... interfaces) {
    return (T) Proxy.newProxyInstance(realObject.getClass().getClassLoader(), interfaces, new SimpleInvocationHandler(realObject));
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2010-01-21T00:59:21.373

[Mockrunner](http://mockrunner.github.io/)可以加载 CSV 或 XML 文件并自动创建 MockResultSet。它还可以模拟 Connection 和 Statement，因此您的所有 JDBC 内容都可以正常工作，甚至无需将 JDBC 驱动程序添加到您的类路径中。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-01-25T00:06:58.813

我为同样的情况写了一些东西。您可以使用 Mockito 模拟结果集。您也可以通过使用这段代码模拟 resultset.next() 来遍历结果集的模拟行。

```
// two dimensional array mocking the rows of database.
String[][] result = { { "column1", "column2" }, { "column1", "column2" } };

@InjectMocks
@Spy
private TestableClass testableClass;

@Mock
private Connection connection;

@Mock
private Statement statement;

@Mock
private ResultSet resultSet;

@BeforeTest
public void beforeTest() {
    MockitoAnnotations.initMocks(this);
}

@BeforeMethod
public void beforeMethod() throws SQLException {
    doAnswer(new Answer<Connection>() {
        public Connection answer(InvocationOnMock invocation)
                throws Throwable {
            return connection;

        }
    }).when(testableClass).getConnection();

    when(connection.createStatement()).thenReturn(statement);
    when(statement.executeQuery(anyString())).thenReturn(resultSet);
    final AtomicInteger idx = new AtomicInteger(0);
    final MockRow row = new MockRow();

    doAnswer(new Answer<Boolean>() {

        @Override
        public Boolean answer(InvocationOnMock invocation) throws Throwable {
            int index = idx.getAndIncrement();
            if (result.length > index) {
                String[] current = result[index];
                row.setCurrentRowData(current);
                return true;
            } else
                return false;

        }

        ;
    }).when(resultSet).next();

    doAnswer(new Answer<String>() {

        @Override
        public String answer(InvocationOnMock invocation) throws Throwable {
            Object[] args = invocation.getArguments();
            int idx = ((Integer) args[0]).intValue();
            return row.getColumn(idx);
        }

        ;
    }).when(resultSet).getString(anyInt());
}

static class MockRow {
    String[] rowData;

    public void setCurrentRowData(String[] rowData) {
        this.rowData = rowData;
    }

    public String getColumn(int idx) {
        return rowData[idx - 1];
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-18T17:30:14.823

如果适用，您可以从真实数据源中获取您现在拥有的结果集，对其进行序列化并保存文件。然后，您可以为每个单元测试反序列化该结果集，您应该一切顺利。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T17:32:17.080

只要你不调用大多数`ResultSet`方法，我可能只是将一个分隔的文本文件加载到一个二维数组中，并实现我实际需要的方法，剩下的抛出一个`UnsupportedOperationException`（这是默认实现我的 IDE 中的存根方法）。

# jquery - jQuery将小数添加到SELECT，没有重复选项删除

> ID：878852
> 
> 赞同：2
> 
> 时间：2009-05-18T17:27:30.460
> 
> 标签：jquery

好的，这里是：需要过滤掉重复项和删除添加到 SELECT 框中的值的能力。

```
Number: <input type="text" name="number" />
<br />
<!-- Clicking the button should add an option w/ the value being the text displayed -->
<button type="button">Add</button>
<br />
<Select id="mySelect" size="9"></Select>
<br />
<!-- Display only if SELECT box has a value -->
<button type="button" hidden="hidden">Remove</button> 
```

我看过[这个线程](https://stackoverflow.com/questions/47824/using-core-jquery-how-do-you-remove-all-the-options-of-a-select-box-then-add-on)，但仍然缺少一些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-19T01:08:18.657

我不太确定你在问什么，所以澄清会有所帮助。这是我对您正在寻找的东西的破解：

**Javascript**

```
<script type="text/javascript" charset="utf-8">
 $( function() {       
   // Add number from <input> as an <option> to the <select>
   $('#add_number').click( function() {
     // Get Number from <input>
     var numberToAdd = $('#number_to_add').val();

     // Make sure it's not a duplicate; if so, don't add
     var match = false;
     $('#mySelect option').each( function() {
       if (numberToAdd == this.value) match = true;
     });
     if (match) return false;

     // Add the number to the <select>
     $('#mySelect').append(
       $('<option></option>').html(numberToAdd).val(numberToAdd)
     );

     // Show the remove button
     $('#remove_selected').show();
     return false;
   });

   // Remove the currently selected <option> in the <select>
   $('#remove_selected').click( function() {
     $('#mySelect option:selected').remove();
     return false;
   });
 })
</script> 
```

**HTML**

```
<form action="#">
  <p>
    Number: <input type="text" name="number_to_add" id="number_to_add" />
    <button id="add_number" type="button">Add</button>
  </p>
  <p>
    <select id="mySelect" size="9"></select>
    <button id="remove_selected" type="button" style="display:none;">Remove</button>
  </p>
</form> 
```

# .net - 我应该在 dotnet 中使用哪种依赖注入技术？

> ID：878859
> 
> 赞同：4
> 
> 时间：2009-05-18T17:28:12.313
> 
> 标签：.net, dependency-injection, inversion-of-control

[修订版 5/14/09：由于我的部署场景，我需要这个来针对 Dotnet 2.0]

我是依赖注入和 IoC 的新手。

我看到有大量的容器和库来帮助这个过程。

使用这些库的优缺点是什么。你最喜欢的（dotnet）容器是什么，为什么？

为依赖注入滚动我自己的容器怎么样？

谢谢，

彼得斯蒂芬斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T09:29:04.140

如果您只需要依赖注入，AutoFac 可能是最好的选择，因为它很小，非常简单且合乎逻辑。摸索应该不难。

一旦你明白了，你觉得需要更成熟的产品（除了简单的 DI 之外，它可以做其他事情）我建议看看 Castle Windsor，它开箱即用，设计非常好，可定制. 如果你不喜欢这样，我听说过关于 StrcutureMap 的好消息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T17:33:48.543

[春天网](http://www.springframework.net/news.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T17:31:51.463

我喜欢[MEF](http://mef.codeplex.com/)，主要是因为它将在 .NET 4.0 中得到很好的支持（因为 MS 已经宣布他们将它用于 Visual Studio 2010 中的 DI 基础）。

它的使用也非常简单，尤其是对于 DI。处理 DI 和插件场景是该框架的主要目标，因此在这些情况下它非常干净和简单。

它也适用于 IoC，但这不是它的主要目标。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-18T17:32:28.313

我使用了一个名为 StructureMap 的 IOC 工具：[Structure Map](http://structuremap.sourceforge.net/Default.htm) 我发现该工具非常有用且易于实现。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-20T15:57:09.683

经过更多研究：[Ninject](http://ninject.org)似乎是一个有用的选择。它支持Dotnet 2.0。而且它不需要大量的 XML 配置。

仍在尝试找出为生产和单元测试环境提供不同 DI 配置的最佳实践。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-20T16:16:00.490

[在此处](https://stackoverflow.com/questions/21288/which-c-net-dependency-injection-frameworks-are-worth-looking-into)找到有关此主题的另一个线程

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-18T18:22:26.900

您可以在代码中使用[Common Service Locator](http://www.codeplex.com/CommonServiceLocator)，它需要显式调用容器。这样，如果您对所选框架不满意，您可以通过插入新框架来切换它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-10-18T14:37:03.883

春天.NET。如果您只想使用 Spring 的 DI 组件，这就是您需要使用的全部内容（并且您只需要引用那些 DLL）。稍后，如果你想使用单元测试的东西，或者 Quartz 的东西，或者 NHibernate 的东西，你也可以添加这些 DLL——它是以模块化的方式构建的。所有不同的部分都具有一致性，因为它们来自同一个框架。我认为这是一个非常好的框架，可以很好地补充 .NET。

# math - 通过重用基本的贝塞尔曲线函数来绘制贝塞尔曲线的一部分？

> ID：878862
> 
> 赞同：17
> 
> 时间：2009-05-18T17:28:34.420
> 
> 标签：math, graphics, drawing, coordinates

假设我正在使用一些图形 API，它允许我通过指定 4 个必要点来绘制贝塞尔曲线： **开始、结束、两个控制点**。

我可以**重复使用这个函数**来绘制“原始”曲线的**x%**（通过调整控制点和终点）吗？

还是不可能？

*不必要的信息，如果有人关心：*

*   *我需要
    用不同的颜色和/或线条样式绘制原始贝塞尔曲线的每 n%*
*   *我正在使用 Java 的 Path2D 绘制贝塞尔曲线：*

    ```
    Path2D p = new GeneralPath();
    p.moveTo(x1, y1);
    p.curveTo(bx1, by1, bx2, by2, x2, y2);
    g2.draw(p); 
    ```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-18T18:51:49.103

您需要的是[De Casteljau 算法](http://en.wikipedia.org/wiki/De_Casteljau%27s_algorithm)。这将允许您将曲线分割成您想要的任何部分。

但是，由于您只处理三次曲线，我想建议一个更容易使用的公式，它可以为您提供一个从where`t0`到`t1`where的段`0 <= t0 <= t1 <= 1`。这是一些伪代码：

```
u0 = 1.0 - t0
u1 = 1.0 - t1

qxa =  x1*u0*u0 + bx1*2*t0*u0 + bx2*t0*t0
qxb =  x1*u1*u1 + bx1*2*t1*u1 + bx2*t1*t1
qxc = bx1*u0*u0 + bx2*2*t0*u0 +  x2*t0*t0
qxd = bx1*u1*u1 + bx2*2*t1*u1 +  x2*t1*t1

qya =  y1*u0*u0 + by1*2*t0*u0 + by2*t0*t0
qyb =  y1*u1*u1 + by1*2*t1*u1 + by2*t1*t1
qyc = by1*u0*u0 + by2*2*t0*u0 +  y2*t0*t0
qyd = by1*u1*u1 + by2*2*t1*u1 +  y2*t1*t1

xa = qxa*u0 + qxc*t0
xb = qxa*u1 + qxc*t1
xc = qxb*u0 + qxd*t0
xd = qxb*u1 + qxd*t1

ya = qya*u0 + qyc*t0
yb = qya*u1 + qyc*t1
yc = qyb*u0 + qyd*t0
yd = qyb*u1 + qyd*t1 
```

然后只需绘制由 、 和 组成`(xa,ya)`的`(xb,yb)`贝塞尔`(xc,yc)`曲线`(xd,yd)`。

请注意，`t0`和`t1`不完全是曲线*距离*的百分比，而是曲线*参数空间*的百分比。如果您绝对必须保持距离，那么事情就会变得更加困难。试试这个，看看它是否满足您的需求。

*编辑：*值得注意的是，如果`t0`or`t1`为 0 或 1（即您只想从一侧修剪），这些方程式会简化很多。

此外，这种关系`0 <= t0 <= t1 <= 1`不是严格的要求。例如`t0 = 1`， 和`t1 = 0`可用于向后“翻转”曲线，或`t0 = 0`可`t1 = 1.5`用于将曲线延伸到原始末端。但是，如果您尝试将其扩展到该`[0,1]`范围之外，则该曲线可能看起来与您预期的不同。

*Edit2：*在我最初回答 3 年多之后，MvG 指出了我的方程式中的一个错误。我忘记了最后一步（获得最终控制点的额外线性插值）。上述等式已更正。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-07-28T23:29:22.497

在[回答](https://stackoverflow.com/a/11704152/1468366)[另一个问题](https://stackoverflow.com/q/11703283/1468366)时，我只包含了一些公式来计算三次曲线部分的控制点。当*u* = 1 − *t*时，三次贝塞尔曲线被描述为

B( *t* ) = *u* ³ *P* [1] + 3 *u* ² *t* *P* [2] + 3 *ut* ² *P* [3] + *t* ³ *P* [4]

*P* [1]是曲线的起点，*P* [4]是曲线的终点。*P* [2]和*P* [3]是控制点。

给定两个参数*t* [0]和*t* [1]（并且*u* [0] = (1 − *t* [0] ), *u* [1] = (1 − *t* [1] )），区间 [ *t* [0] , *t* [1] ] 中的曲线部分由下式描述新的控制点

*   *Q* [1] = *u* [0] *u* [0] *u* [0] *P* [1] + ( *t* [0] *u* [0] *u* [0] + *u* [0] *t* [0] *u* [0] + *u* [0] *u* [0] *t* [0] ) *P* [2] + ( *t* [0] *t* [0] *u* [0] + *u* [0] *t* [0] *t* [0] + *t* [0] *u* [0] *t* [0] ) *P* [3]+ *t* [0] *t* [0] *t* [0] *P* [4]
*   *Q* [2] = *u* [0] *u* [0] *u* [1] *P* [1] + ( *t* [0] *u* [0] *u* [1] + *u* [0] *t* [0] *u* [1] + *u* [0] *u* [0] *t* [1] ) *P* [2] + ( *t* [0] *t* [0] *u* [1] + *u* [0] *t* [0] *t* [1] + *t* [0] *u* [0] *t* [1] ) *P* [3]+ *t* [0] *t* [0] *t* [1] *P* [4]
*   *Q* [3] = *u* [0] *u* [1] *u* [1] *P* [1] + ( *t* [0] *u* [1] *u* [1] + *u* [0] *t* [1] *u* [1] + *u* [0] *u* [1] *t* [1] ) *P* [2] + ( *t* [0] *t* [1] *u* [1] + *u* [0] *t* [1] *t* [1] + *t* [0] *u* [1] *t* [1] ) *P* [3]+ *t* [0] *t* [1] *t* [1] *P* [4]
*   *Q* [4] = *u* [1] *u* [1] *u* [1] *P* [1] + ( *t* [1] *u* [1] *u* [1] + *u* [1] *t* [1] *u* [1] + *u* [1] *u* [1] *t* [1] ) *P* [2] + ( *t* [1] *t* [1] *u* [1] + *u* [1] *t* [1] *t* [1] + *t* [1] *u* [1] *t* [1] ) *P* [3]+ *t* [1] *t* [1] *t* [1] *P* [4]

请注意，在括号中的表达式中，至少有一些项是相等的并且可以组合。我没有这样做，因为我相信这里所说的公式会使模式更清晰。*您可以简单地为x*和*y*方向独立执行这些计算来计算新的控制点。

请注意，*t*的参数范围的给定百分比通常不会对应于长度的相同百分比。因此，您很可能必须对曲线进行积分才能将路径长度转换回参数。或者你使用一些近似值。

# uml - UML 中的类和对象之间的中间地带在哪里？

> ID：878863
> 
> 赞同：2
> 
> 时间：2009-05-18T17:28:40.597
> 
> 标签：uml, class-diagram, object-diagram

假设您要绘制一个`Map`类（数学类，而不是制图类）。在 Ruby 中，你可能有类似的东西：

```
class Map
  attr_accessor :nodes, :edges
  def initialize
    @nodes = Set.new
    @edges = Set.new
  end
  def minimum_spanning_tree(&mst_algorithm)
    mst_algorithm.call(@nodes, @edges)
  end
  ...
end 
```

当我开始绘制图表时，我的想法如下：

让我们尝试一个类图，因为我们正在讨论类。我会创建一个`Map`类。和一`Node`堂课。和一`Edge`堂课。和一`Set`堂课。美好的。现在我将绘制一条 Composed-Of(1:2) 线，从`Map`到`Set`—— 每个`@nodes`和`@edges`。然后是从 to 的 has-many(1:0..*) 行和从`Set`to 的`Node`另一`Set`行`Edge`。但是现在我说每个集合都可以有`Node`s 和`Edge`s 的任意组合，这是不正确的。并且在图表上放置两个`Set`元素（有两条对应的 Composed-Of(1:1) 线）也无济于事，因为它们是同一个对象。

所以我想：嗯，也许 UML 想让我更像 C++/Java-ey。在 UML 中不可能使用模板化`Set<Node>`，但我可以创建子类：和.`Set<Edge>``NodeSet``EdgeSet`

最后我考虑了一个对象图，但那是不对的。我说的是`Set`类，而不是个别`Set`实例。

有更好的答案吗？还是我已经找到了“最不坏”的那个？

**之后**

正如我最初所说的那样，[Marc W](https://stackoverflow.com/questions/878863/wheres-the-middle-ground-between-class-and-object-in-uml/878895#878895)和[Pete Kirkham](https://stackoverflow.com/questions/878863/wheres-the-middle-ground-between-class-and-object-in-uml/879034#879034)的回答非常适合这个问题。问题是我试图对我的实际问题使用一个简单的类比，因为我无法揭示存在的问题。我真的只是在了解如何拥有两个具有不同关系但行为相同并具有相同属性（尽管不是属性值）的同一类。

让我们用一些不同的模型再试一次：an `ActiveDirectory`、a`Firewall`和 two `Router`s。一台路由器（LAN 一台）引用了`ActiveDirectory`和`Firewall`; 另一个（广域网）引用了`Firewall`一些公共服务器（我们将在此图中忽略它们）。完全可以想象，两个`Router`s 的品牌、型号等都相同。它们会有不同的序列号（对象不同），但它们肯定都是`Router`s。然而，要将两者都放在类图上，我必须将其子类`Router`化为`LANRouter`and `WANRouter`。类比 Marc W 的解决方案是直接连接`Firewall`and `ActiveDirectory`，留下实现 (`Router`) 到类来确定。但是，如果要使用 UML 来实际构建系统，则抽象必须泄漏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T18:07:11.410

如果您正在对领域进行建模，而不是对实现进行建模，那么 UML 为关系提供了原型。在这种情况下，您会将节点和边标记为 {unordered}，这与袋子或集合有关，而 {unique} 将其缩小为集合。我看不到对节点或边缘类型的任何限制，所以如果它不存在，那么不要尝试添加它：

```
class Map
  +nodes : { unordered, unique } object[0..*]
  +edges : { unordered, unique } object[0..*]
  +minimum_spanning_tree(mst_algorithm:callable) 
```

一个好的代码生成器/逆向工程工具会将 { unordered, unique } UML 集合映射到源代码中的 Set 或从 Set 映射。

如果该信息对您有用，您可能希望在您的域模型中使 Map 成为参数类型。但是由于这些信息没有在实现中使用，所以有点难以理解这一点，并且在不失去实用性的情况下使事情尽可能简单一直是建模的目标。

如果你想记录一个特定的类是使用 Sets 实现的，你可以用关联来做到这一点。没错，C++ 或 Java 允许您在 Set 中声明元素的类型，并且这些映射到 UML 中的参数类型。AFAIK Ruby 没有实现此类类型限制的机制，因此要记录 Map 的 Ruby 实现，仅记录实现中的内容 - Map 与 Set 有两个关联，并且对 Set 中的内容没有任何限制。（您可能希望将其记录为不变约束，然后进行单元测试而不是类型约束，但是如果您想要限制性的静态类型检查，又很难理解为什么要在 Ruby 中工作）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T17:34:33.207

不要从`Map`to画任何线`Set`。在这种情况下，`Set`它只是 Ruby 提供给您的一个数据结构，其中包含真正重要的对象。是否是 a `Set`、 a `HashMap`、 an`Array`等是特定于实现的，对于 UML 无关紧要。`Map`只需从to`Node`和 from `Map`to制作一条 Composed-of(1:0..*) 行`Edge`。毕竟，在英语中，你`Map`真的是由节点和边组成的，对吗？您包含`Map`在图表中的原因是因为您实际上是创建类的人。

您对对象图是正确的：在这种情况下没有必要。与您建议的模板语法相同。

# networking - 衡量应用程序对网络流量影响的指标

> ID：878866
> 
> 赞同：1
> 
> 时间：2009-05-18T17:29:22.437
> 
> 标签：networking, client-server, metrics, bandwidth, measurement

我正在编写一个应用程序，并且能够将其吞吐量（通过网络发送的每秒比特数）设置为我希望的任何速率。但是，我想将其设置得尽可能高，只要网络上的其他流量不会受到严重影响。

问题是，我没有一个好的衡量标准来衡量这种影响。我想到了以下几个，但都不是真正“完整”的：

1.  增加数据包的平均延迟时间
2.  丢包增加
3.  抖动增加
4.  增加完成 tcp 事务的平均时间（使用 http 下载文件）

有没有标准的度量？您对如何衡量应用程序对网络的影响还有其他想法吗？

顺便说一句 - 我对网络有完全的控制权，并且可以采取我想要的任何测量来计算该指标。

谢谢，

肉里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-18T17:38:36.427

[交通工程](http://en.wikipedia.org/wiki/Traffic_engineering_(telecommunications))是一个相当复杂的领域。[服务质量](http://en.wikipedia.org/wiki/Quality_of_service)可能是解决这个问题的一个很好的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T17:45:14.307

这是可能难以以编程方式回答的问题之一。在我见过的允许这种限制的应用程序中，它一直是一个配置选项。通常很难了解您的用户网络，您所做的任何假设都可能是错误的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T18:57:12.260

当您超出其带宽时，不同的网络会以不同的方式运行。他们中的大多数人都有一连串的坏处：

1.  由于某些数据包必须排队或重新传输（例如，半双工以太网或无线上的冲突），抖动将开始急剧上升。平均延迟会略有上升。
2.  随着过饱和的继续（或在更高的过饱和水平），平均延迟将达到顶峰，因为几乎所有数据包都在排队或重新传输。如果队列大小很小，这可能会受到限制。
3.  随着队列溢出，丢包率会增加。您驱动的带宽越高，丢失的数据包就越多。根据硬件，抖动和延迟可能会或可能不会下降。

如果使用某种形式的 QoS，不同的数据包流可能会独立地看到这些影响。例如，您可能会在应用程序连接上抽取 3 倍带宽，并且看到 ping 时间的变化相对较小。因此，您必须使用应用程序的数据包进行测量。

(1) 和 (2) 可能不会出现在给定的网络上。(3) 总会发生，无论如何。不幸的是，即使您远未达到带宽限制，这三种情况也可能发生。

# asp.net-mvc - 导轨到.net mvc

> ID：878869
> 
> 赞同：2
> 
> 时间：2009-05-18T17:29:47.180
> 
> 标签：asp.net-mvc

我正在计划一个需要在 Windows 机器上运行的网站/商店。我在 RoR 方面有一些经验，但对于这个项目，我猜 .NET 是解决方案。对于有经验的程序员（RoR、Ruby、大量的 C/++）来说，转到 .NET MVC 的学习曲线是怎样的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T18:52:13.143

*   路由约束 (global.asax)
*   动作过滤器（通过动作属性）
*   LINQ转SQL
*   C# 3.0 特性，如 lambda 表达式、匿名初始化器和隐式类型 (var)
*   DataContractSerializer 或 JavascriptSerializer 用于序列化的东西
*   Donut 缓存、身份验证、CSRF 和其他一些在构建应用程序时需要注意的概念

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T17:41:52.117

概念将是相同的，但您会发现实现完全不同。您的 C++ 经验将对您有所帮助，因为您将能够开始使用 C# 运行，但我仍然认为您需要阅读一些内容以熟悉 .NET（语言、编译器、框架和运行时）。

学习曲线是非常主观的东西——这完全取决于你的软件开发能力以及你愿意投入多少时间来学习新东西。

# c# - WebBrowser 控件不会从 C# 打印

> ID：878878
> 
> 赞同：4
> 
> 时间：2009-05-18T17:31:52.587
> 
> 标签：c#, winforms, webbrowser-control

我在 WinForms 应用程序上有一个 WebBrowser 控件，该应用程序正在加载转换为 HTML/CSS 的 XML。如果我只想在那里或在常规浏览器中查看它，看起来很漂亮。

当表单加载时，它应该导航到文件，然后当 OnDocumentCompleted 事件触发时，它应该在注册表中设置页眉、页脚和默认打印机名称，然后为用户指定的多个副本调用 Print()。

我已经通过调试器运行它，它在 OnDocumentCompleted 事件中调用 webBrowser.Print() 的次数正确。没有什么不应该是 null，WebBrowser 控件上的 Visible 是 true，AllowNavigation 也是如此。是的，打印机已打开并可通过网络访问。完全相同的代码在项目的其他地方工作，但在这里不工作。

还有什么可能导致这个地狱般的控件忽略我的打印命令？

理想情况下，我希望将整个内容隐藏在屏幕外，因为这是使用 Windows 调度程序运行的，用户永远不会看到它。不过，我已经读过控件需要可见，所以在我解决第一个问题之前，可以等待。

**编辑**：我的 OnDocumentCompleted 事件处理程序的最后两行将 DialogResult 设置为 OK 并关闭了表单。删除对 Close() 的调用让它打印，所以我猜它在表单关闭和 WebBrowser 控件被释放之前没有到达打印后台处理程序。

除了设置任意时间限制以在关闭之前等待之外，有什么方法可以判断何时完成打印？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T18:48:22.560

原来是时间问题，表单在将文档发送到后台打印程序之前被关闭。我最终在表单中添加了一个 Timer，将其设置为 30 秒，并让它的 Tick() 事件关闭表单。以前关闭表单的地方，现在只调用 closeTimer.Start()。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T17:35:58.773

试试这个：

```
mshtml.IHTMLDocument2 doc;
doc = oWeb.Document;        
doc.execCommand("Print", True, Nothing); 
```

**从编辑：**

可以使用 SHELL 命令检查打印队列中作业的状态

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-11T12:04:01.027

这是我从字符串中打印 HTML 的最佳方式

```
void PrintString(string strHTMLText)
{
    WebBrowser wbPrintString = new WebBrowser() { DocumentText = string.Empty };
    wbPrintString.Document.Write(strHTMLText);
    wbPrintString.Document.Title = "Type The Header You Want Here";
    Microsoft.Win32.RegistryKey rgkySetting = Microsoft.Win32.Registry.CurrentUser.OpenSubKey("Software\\Microsoft\\Internet Explorer\\PageSetup", true);
    rgkySetting.SetValue("footer", "Type THe Footer You Want Here");
    rgkySetting.Close();
    wbPrintString.Parent = this;
    wbPrintString.ShowPrintPreviewDialog();
    wbPrintString.Dispose(); 
```

}

# iphone - 如何正确获取presentationLayer的当前变换？

> ID：878885
> 
> 赞同：2
> 
> 时间：2009-05-18T17:32:51.290
> 
> 标签：iphone, core-animation

我试过这个：

```
CATransform3D rotationTransform = [[self.layer presentationLayer] transform]; 
```

这不起作用，因为编译器会抛出警告和错误：

> 警告：找到多个方法“-transform”。错误：初始化程序无效。

所以我尝试了这个：

```
CATransform3D rotationTransform = [[self.layer presentationLayer] valueForKey:@"transform"]; 
```

> 错误：初始化程序无效。

那有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T17:51:00.833

`-presentationLayer`返回一个`id`. 您需要将其转换回 CALayer：

```
CATransform3D rotationTransform = [(CALayer*)[self.layer presentationLayer] transform]; 
```

为了非常安全，您将首先检查：

```
CATransform3D rotationTransform = {0};
CALayer* presentationLayer = (CALayer*)[self.layer presentationLayer];
if( [presentationLayer respondsToSelector:@selector(transform)]) {
    rotationTransform = presentationLayer.transform;
} 
```

但在实践中，如果没有这个检查，这会很好。

在第二种情况下，`-valueForKey:`还返回一个`id`，您试图将其分配给 struct，这是不可能隐式执行的。您不能只将对象指针转换为结构。

# ruby - 这个正则表达式在 Ruby 中验证 URL 有什么问题？

> ID：878892
> 
> 赞同：0
> 
> 时间：2009-05-18T17:33:53.520
> 
> 标签：ruby, regex

我正在传递一组要验证的 URL。函数如下。当我只传递一个 URL 但不超过一个时，它可以工作。正则表达式似乎是正确的。我哪里错了？

```
 def check_urls (list) 
    regexp =/(^$)|(^(http|https):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(([0-9]{1,5})?\/.*)?$)/ix    
    list.each do |url| 
        if not regexp.match(url) 
            return false 
        end 
    end 
    return true 
  end 
```

* * *

修复了错误。正则表达式函数没有错，只是拆分做错了。

感谢所有花时间提供帮助的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T17:39:29.873

在将其与正则表达式匹配之前尝试检查每个 url：

```
def check_urls (list) 
  regexp =/(^$)|(^(http|https):\/\/[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(([0-9]{1,5})?\/.*)?$)/ix        
  list.all? do |url|
    p url # see what URL is getting inspected
    regexp =~ url  # make sure it matches the regexp
  end
end 
```

这应该可以帮助您找到与其不匹配的 URL，并且您可以从那里开始工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T17:42:41.787

也许您可以尝试解析 uris 并在错误时中止。

```
def check_urls(list = [])
  list.to_a.all? do |uri_string|
    uri = URI.parse(uri_string) rescue nil
    uri && uri.scheme == "http"
  end
end 
```

另请参阅[Enumerable#all](http://www.ruby-doc.org/core/classes/Enumerable.html#M003162)和[URI.parse的文档](http://www.ruby-doc.org/stdlib/libdoc/uri/rdoc/classes/URI.html#M009380)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:46:26.927

查看[Rubular](http://rubular.com)。这是一个很棒的小工具，在很多情况下都帮助了我。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T17:49:20.853

好的，找到问题了。我正在尝试像这样拆分字符串

user_input.split("\r\n")

看起来这是错误的，这就是为什么函数对一个值而不是超过一个值正常工作的原因，因为数组始终包含一个字符串，即输入字符串:-(

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-04T19:18:37.890

This method does what you are asking. It could also be inside `String` class:

```
def linkify text
  text.gsub!(/\b((https?:\/\/|ftps?:\/\/|mailto:|www\.)([A-Za-z0-9\-_=%&@\?\.\/]+))\b/) {
    match = $1
    tail  = $3
    case match
    when /^www/     then  "<a href=\"http://#{match}\">Link</a>"
    when /^mailto/  then  "<a href=\"#{match}\">Link</a>"
    else                  "<a href=\"#{match}\">Link</a>"
    end
  }
  text
end 
```

# windows - 在 Windows 中区分管道和文件

> ID：878896
> 
> 赞同：3
> 
> 时间：2009-05-18T17:34:33.550
> 
> 标签：windows, file, pipe, handle

在 Unix 上，一切都是文件，因此您可以将文件 i/o 函数与管道、文件、套接字等一起使用。但在 Windows 上，您使用的 api 取决于您拥有的 i/o HANDLE 的类型。

我的问题是：给定一个 HANDLE 你如何确定底层类型是什么？例如，我有一个 HANDLE，它可以是真实文件，也可以是命名/匿名管道。我想知道是否可以在这个 HANDLE 上调用 PeekNamedPipe。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T20:15:46.017

使用`GetFileType`. 检查返回值`FILE_TYPE_PIPE`.

[http://msdn.microsoft.com/en-us/library/aa364960(VS.85).aspx](http://msdn.microsoft.com/en-us/library/aa364960(VS.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T20:07:03.977

不想装傻。称它为。如果你收到一个错误代码，说它是错误类型的东西......那么你就知道了。

在尝试查看用户是否有权打开文件时，类似的主体是相关的。可以尝试完全逆向工程并重新实现文件系统测试 ACL 所经过的逻辑。或者，只是尝试打开它。

# java - 休眠用于获取子选择的原始整数列表

> ID：878900
> 
> 赞同：0
> 
> 时间：2009-05-18T17:35:51.597
> 
> 标签：java, hibernate, subquery

Hibernate 没有办法从表中的一列返回（原始）值列表吗？我需要这个子选择，我只想要特定字段不在另一个表的 id 列表中的行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T18:11:48.827

您可以使用 Hibernate 原始 SQLQuery 吗？

```
SQLQuery q = getSession().createSQLQuery("select int_column from table");
List<Integer> list = (List<Integer>) q.list(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T18:15:56.103

好吧，它变得像下面这样简单，来自 URL [https://www.hibernate.org/hib_docs/nhibernate/html/queryhql.html](https://www.hibernate.org/hib_docs/nhibernate/html/queryhql.html)，这实际上是我在谷歌搜索时发现的第一个结果之一，但我担心它可能是 NHibernate 特定的

```
from Eg.DomesticCat as cat where cat.Name not in ( 
select name.NickName from Eg.Name as name ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T18:12:16.593

不知道如何使用休眠引擎本身，我认为这将取决于您如何映射模型对象，如果没有看到映射，您可以通过休眠会话对象并使用标准 SQL；

```
session.createSQLQuery("select idCol from someTable where someId not in (
select someId from anotherTable)"); 
```

然后在查询上使用 list() 方法，并对原始 int 数组使用自动装箱。

# windows - 为什么程序不直接杀死并重新启动 explorer.exe？

> ID：878903
> 
> 赞同：7
> 
> 时间：2009-05-18T17:36:28.163
> 
> 标签：windows

我知道很多程序一旦安装（或更新注册表）就需要一些东西来刷新值。这可以通过杀死并重新启动 explorer.exe 来完成，但是大多数人不会这样做，而是要求您重新启动计算机。一个需要很长时间的过程。

我目前正在编写一个仅供技术人员使用的工具，它对注册表进行了一些更改，需要重新启动（或重新启动 explorer.exe）才能生效。我不必担心我的用户会因为 explorer.exe 在他们身上重新启动而吓坏，所以这不是问题。

在这样做之前我还应该考虑什么？为什么其他应用程序告诉您重新启动而不是更快的重新启动资源管理器？有安全原因吗？还是只是习惯？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-18T17:44:04.920

杀死并重新启动资源管理器不会完成重新启动系统所做的所有事情：

1) 任何当前正在运行的应用程序都不会被刷新。

2) 这也可能导致系统出现稳定性问题。特别是，我注意到我的图形驱动程序在资源管理器关闭/重新启动后没有正确更新的问题。

3）它只是一种气味;）作为安装的一部分杀死一个进程看起来很讨厌。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-18T17:42:50.867

我发现在资源管理器重新启动后通知区域中的图标没有显示的问题（通常在它停止响应并且我必须杀死它之后）。

根据通知图标，这可能会导致用户问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-05-18T18:04:17.500

重新启动 Windows 是一项经过充分测试的操作。注销/登录也是。可以期待所有第三方软件都通过重启测试过，几乎所有第三方软件都通过注销、登录测试过。

你认为有多少是通过 kill & respawn explorer.exe 测试的？可能远没有这么多，当然也远没有那么彻底。

因此，如果您是在内部分发到一个非常受控的环境，当然，请继续杀死并重新生成 explorer.exe。但是不要这样做，因为您将用户的机器置于测试非常差的状态，并且事情可能会神秘地中断，直到他重新启动。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-18T17:39:12.823

可能进行了其他更改，需要*的不仅仅是*重新启动 explorer.exe。同样正如您所说，重新启动 explorer.exe 对于最终用户来说可能会非常令人担忧。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-18T17:43:23.873

资源管理器可能具有未保存的状态（打开的窗口、文件夹视图设置等），如果突然重新启动，这些状态会丢失）。如果安装程序会在不询问的情况下杀死我的 explorer.exe，我会讨厌它，而且我不确定我是否会认为它比重新启动有所改进。

在重新启动 explorer.exe 无法处理的事情列表中，特别是替换当前正在使用的 DLL 和不侦听注册表更改事件但从那里保存信息的程序（explorer.exe 之外）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-18T17:43:58.413

总是需要重新启动资源管理器吗？

我曾经有一个应用程序安装了一个性能监视器计数器，该计数器应该由我的应用程序和 Perfmon 共享（当它运行时），所以安装它应该只是为了确保任一应用程序都已关闭。*简单...除了加载每个*perfmon 对象 dll 并保持它们全部锁定的驱动程序（不记得哪个驱动程序，或者我会为制造商感到羞耻） 。结果，我的应用程序需要重新启动。

现在，如果您有一个工具可以确定哪些进程锁定了哪些要安装的文件，并在用户必须决定的情况下关闭它们，那么其中一个进程可能对 Windows 很重要（例如工作站服务, 或 svchost) 或对用户很重要 (例如 Word 有一天的未保存工作) (这可能是一个坏例子)。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-18T17:54:56.940

使用重新启动选项而不是刷新 explorer.exe。已经预料到，大多数在 Windows 上安装的软件都使用重新启动，因此用户习惯于在安装软件时重新启动，这让他们有机会关闭任何其他窗口并保存数据。其次，正如已经指出的那样，重新启动 explorer.exe 会在没有警告的情况下使当前屏幕空白，并使其看起来好像出了问题并且所有信息都丢失了。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-18T17:56:37.217

对于下次重新启动时发生的已安装内容，注册表中有很多事情要做；例如，“RunOnce”键下的条目会在下次启动时运行一次。有很多安装应用程序依赖于这种行为；并且因为微软没有弃用该功能或​​找到一个好的解决方法，人们继续编写期望这个功能并依赖它的软件。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-18T17:42:59.400

重新启动资源管理器具有报废用户当前环境的不幸副作用。如果你简单地杀死 explorer.exe，任务栏按钮、待处理的操作等都会丢失。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-18T17:42:59.710

为什么不让用户选择是重启还是重启资源管理器。

请记住，虽然普通用户不会知道这意味着什么或需要什么，因此请确保您的用户确实“足够技术”。

# c# - 使 Linq To SQL DRY

> ID：878909
> 
> 赞同：1
> 
> 时间：2009-05-18T17:38:25.883
> 
> 标签：c#, .net, linq, linq-to-sql, .net-3.5

我们决定在我们最近的项目中使用 Linq To SQL 作为我们的数据层。我们有一个功能性的解决方案，到目前为止，它已经处理了我们提出的所有问题，但有一个主要问题。我们必须一遍又一遍地编写相同的方法来从我们的数据库中检索略有不同的结果集。

举个例子：

```
 public List<TeamBE> GetTeamsBySolutionID(Guid SolutionID)
        {
            List<TeamBE> teams = new List<TeamBE>();

            Esadmin db = new Esadmin(_connectionString);

            var qry = (from teamsTable in db.Teams
                       join solutionsTable in db.Solutions on teamsTable.SolutionID equals solutionsTable.SolutionID
                       where teamsTable.SolutionID == SolutionID
                       select new { teamsTable, solutionsTable.SolutionName });

            foreach (var result in qry)
            {
                TeamBE team = new TeamBE();

                team.TeamID = result.teamsTable.TeamID;
                team.Description = result.teamsTable.Description;
                team.Status = result.teamsTable.Status;
                team.LastModified = result.teamsTable.LastModified;
                team.SolutionID = result.teamsTable.SolutionID;
                team.SolutionName = result.SolutionName;
                team.Name = result.teamsTable.Name;
                team.LocationLevel = result.teamsTable.LocationLevel;
                team.AORDriven = result.teamsTable.AoRDriven;
                team.CriteriaID = result.teamsTable.CriteriaID ?? Guid.Empty;

                teams.Add(team);
            }
            return teams;
        }

        public TeamBE GetTeamByID(Guid TeamID)
        {
            Esadmin db = new Esadmin(_connectionString);
            TeamBE team = new TeamBE();

            var qry = (from teamsTable in db.Teams
                       join solutionsTable in db.Solutions on teamsTable.SolutionID equals solutionsTable.SolutionID
                       where teamsTable.TeamID == TeamID
                       select new { teamsTable, solutionsTable.SolutionName }).Single();

            team.TeamID = qry.teamsTable.TeamID;
            team.Description = qry.teamsTable.Description;
            team.Status = qry.teamsTable.Status;
            team.LastModified = qry.teamsTable.LastModified;
            team.SolutionID = qry.teamsTable.SolutionID;
            team.SolutionName = qry.SolutionName;
            team.Name = qry.teamsTable.Name;
            team.LocationLevel = qry.teamsTable.LocationLevel;
            team.AORDriven = qry.teamsTable.AoRDriven;
            team.CriteriaID = qry.teamsTable.CriteriaID ?? Guid.Empty;

            return team;
        } 
```

并在广告恶心。

有没有办法将 Linq 结果作为参数传递给函数，这样我就可以将我的对象映射放在一个函数中，而不会重复太多？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-18T17:53:16.570

我快速尝试了一下。可能无法编译（尤其是团队中的“来自 teamsTalbe”），但想法是您可以提取返回 IQueryable<> 的内容。尽管您是 IQueryable 返回匿名类型，但这是行不通的。所以您可以需要创建一个显式类型来代替“select new { teamsTable, solutionsTable.SolutionName }”

```
 public List<TeamBE> GetTeamsBySolutionID(int solutionID)
    {
        Esadmin db = new Esadmin(_connectionString);
        return GetTeamsBy(db, _GetTeamsBySolutionID(db, solutionID));
    }

    IQueryable<Team> _GetTeamsBySolutionID(Esadmin db, int solutionID)
    {
        return from teamsTable in db.Teams
               where teamsTable.SolutionID == SolutionID
               select teamsTable;
    }

    List<TeamBE> GetTeamsBy(Esadmin db, IQueryable<Team> teams)
    {
        List<TeamBE> teams = new List<TeamBE>();

        var qry = (from teamsTable in teams
                   join solutionsTable in db.Solutions on teamsTable.SolutionID equals solutionsTable.SolutionID
                   select new { teamsTable, solutionsTable.SolutionName });

        foreach (var result in qry)
        {
            TeamBE team = new TeamBE();

            team.TeamID = result.teamsTable.TeamID;
            team.Description = result.teamsTable.Description;
            team.Status = result.teamsTable.Status;
            team.LastModified = result.teamsTable.LastModified;
            team.SolutionID = result.teamsTable.SolutionID;
            team.SolutionName = result.SolutionName;
            team.Name = result.teamsTable.Name;
            team.LocationLevel = result.teamsTable.LocationLevel;
            team.AORDriven = result.teamsTable.AoRDriven;
            team.CriteriaID = result.teamsTable.CriteriaID ?? Guid.Empty;

            teams.Add(team);
        }
        return teams;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T17:46:45.397

我认为您可以将`qry`变量声明为`IEnumerable<YourDataTypeEntity>`并将其传递给方法。我倾向于喜欢将其作为构造函数：

```
class MyDataType
{
  public MyDataType() {}
  public MyDataType(MyDataTypeEntity mdte)
  {
    // set properties and fields here
  }

  // ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:52:32.000

您可以传递一个 IQueryable 然后当您想要处理结果时，您可以迭代结果。我不确定这是否是您要问的那种事情，或者我是否对您的问题有意见。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T17:56:53.083

还可以查看[AutoMapper](http://www.codeplex.com/AutoMapper)，这是一个 API，它使用基于约定的匹配算法来匹配对象中的源值和目标值。使用它可能会删除您的大部分 a = bc 代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T18:26:24.710

我用 entityFramework 实现了这样的东西：

```
//This returns an IQueryable of your Linq2Sql entities, here you put your query.
protected IQueryable<Team> GetTeamByIdQuery(Guid teamID)
{
    var qry = (from TeamsTable in db.Teams
               where blablabla.....
               select Teams;

    return qry;
}

//This will return your real entity
public IList<TeamBE> GetTeamById(Guid teamID)
{
    var query = this.GetTeamByIdQuery(teamID);
    IList<TeamBE> teams = ExecuteTeamQuery(query).toList<TeamBE>();

    return teams;
}

//this method will do the mapping from your L2S entities to your model entities
protected IQueryable<TeamBE> ExcuteTeamQuery(IQueryable<Team> query)
{
    return 
        query.select<Team, TeamBE> (team => 
           new TeamBE
           {
              TeamID = team.TeamID,
              Description = team.Description 
           }

} 
```

还没有测试这么多，但它的工作原理。我还在努力根据 bitflag 参数定义要加载的属性。我还没有让它工作，但会是这样的：

```
public IQueryable<TeamBE> ExcuteTeamQuery(IQueryable<Team> query, int loadLevel)
{
    return 
        query.select<Team, TeamBE> (team => 
           new TeamBE
           {
              TeamID = team.TeamID,
              TeamMembers = (HaveToLoad(LoadLevel.TeamMembers, loadLevel)) ? team.TeamMembers : null 
           }

}

enter code here 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T22:15:45.043

尝试扩展方法：如果你有

```
public IQueryable<Team> GetTeams() { return db.Teams; } 
```

试着写：

```
public IQueryable<Team> WithDivisionId(this IQueryable<Team> qry, int divisionId)
{ return (from t in qry where t.DivisionId = divisionId select t);} 
```

通过这种方式，您可以编写多个扩展方法来查询任何内容`IQueryable<Team>`并将它们分层......

要让第 1 级的球队在某个时候获得 9 次或更多胜利并且连续 5 次或更多，您只需编写：

```
GetTeams().WithDivisionId(1).HavingWonAtLeast(9).WithWinningStreak(5); 
```

# sql-server - Reporting Services 问题呈现 RTF

> ID：878912
> 
> 赞同：0
> 
> 时间：2009-05-18T17:38:37.957
> 
> 标签：sql-server, reporting-services, rtf

我正在使用**VS.NET 2005**和**SQL Server 2005**。我的开发计算机运行的是**Windows XP SP2**。SQL Server 2005 数据库和报告服务在**Windows 2003 Server**上运行。

我的业务需求是开发和部署一个报告，该报告采用存储在数据库（**datatype = TEXT ）中的富文本（** **RTF** ），并在运行时使用自定义程序集将其转换为图像（源代码可在此处找到[http://blogs. digineer.com/blogs/jasons/archive/2006/10/03/520.aspx](http://blogs.digineer.com/blogs/jasons/archive/2006/10/03/520.aspx)）。我可以使用**ReportManager** Web 界面和**Render**方法在我的本地（即开发人员）计算机上生成和查看包含 RTF 的动态图像。当我将它部署到我们的测试服务器时，我最终得到了一个损坏的链接图像。

 ******回顾一下，我采取了以下步骤。

**使用将 RTF 转换为位图图像的 VS.NET 2005**创建了自定义程序集。**自定义程序集有一个强名称。**

 ****在本地开发者机器上**

1.  **将自定义程序集复制**到 C:\Program Files\Microsoft Visual Studio 8\Common7\IDE**PrivateAssemblies**。
2.  **修改**C:\Program Files\Microsoft Visual Studio 8\Common7\IDE\PrivateAssemblies**RSReportDesigner.config** 以包含一个**CodeGroup，该 CodeGroup 将 FullTrust 授予**基于**StrongNameMembership**的自定义程序集（**注意**：ReadMe.txt 未提及添加条目到这个文件）。
3.  **修改**C:\Program Files\Microsoft Visual Studio 8\Common7\IDE\PrivateAssemblies**RSPreviewPolicy.config** 以包含一个**CodeGroup，该 CodeGroup 将 FullTrust 授予**基于 StrongNameMembership 的自定义程序集（**注意**：ReadMe.txt 未提及添加条目到这个文件）。

**使用 VS.NET 2005 修改报告如下**

1.  **添加**了对自定义程序集和 System.Drawing 的引用。
2.  **添加**了 type= **Database**， MimeType= **image/bmp**， Value = **call to custom assembly method 的**图像控件；方法传递包含 RTF 的数据库字段的值。
3.  部署报告。
4.  通过 HTML 和使用 EXCEL 作为输出格式的 WebService 的 Render 方法成功查看报告。 **图像的 HTML**

**在本地开发者机器和服务器上**

1.  **将自定义程序集复制**到 C:\Program Files\Microsoft SQL Server\MSSQL.3\Reporting Services\ReportServer\bin
2.  **修改C:\Program Files\Microsoft SQL Server\MSSQL.3\Reporting Services\ReportServer**rssrvpolicy.config** 以包含一个 CodeGroup，它根据****StrongNameMembership**将 FullTrust 授予自定义程序集（**注意**：源代码表明权限应该基于在 **UrlMembership**上）。
3.  部署报告。
4.  通过 HTML 和使用 EXCEL 作为输出格式的 WebService 的 Render 方法查看报告均失败。图像的 HTML

 **最初，我在导出到 Excel 时收到“数据丢失”的错误消息，但这些似乎已通过在 ReadMe.txt 中未提及的 .config 文件中授予权限来解决。我已经没有办法尝试了，我束手无策。我确信该解决方案与权限有关，因为它适用于我的计算机但不适用于服务器。

提前感谢您的任何想法或建议。

问候，

账单

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-29T20:37:55.030

您是否[授予您的程序集](http://searchsqlserver.techtarget.com/news/article/0,289142,sid87_gci1102094,00.html)访问测试服务器上的数据库所需的权限？（看起来你做到了。）

如果是这样，请检查您是否真的在测试服务器上创建图像。如果不是，那么这是一个写权限问题。如果它正在创建但无法查看，那么这是一个读取权限问题。

# flash - Flash 调试播放器和普通播放器有什么区别？

> ID：878913
> 
> 赞同：2
> 
> 时间：2009-05-18T17:38:51.810
> 
> 标签：flash

一些应用程序和 IDE 建议安装 Adob​​e Flash 播放器的调试版本。我知道即使没有通过 Test Movie 运行 Flash，这也允许查看跟踪语句，但还有什么不同？任何事物？

另外，当我看到正在运行的调试播放器而不是普通播放器时，我怎么知道？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-19T05:11:45.323

调试播放器有几个不同之处：

*   [您可以使用远程调试器](http://www.adobe.com/devnet/flash/articles/as3_debugger_04.html)连接到它
*   （右键单击）上下文菜单将包含一个“显示重绘区域”选项，可让您验证每帧重绘了多少内容
*   调试播放器将显示未捕获异常的弹出错误消息（在常规播放器中它们会静默失败）
*   有一些 AS3 命令只能在调试播放器中使用，例如 System.gc()。请参阅[系统参考](http://help.adobe.com/en_US/AS3LCR/Flash_10.0/flash/system/System.html)。

这只是我的想法，它不是一个详尽的列表。基本上，调试播放器具有一些特性，使其更适合开发，任何开发自己的内容的人都应该使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-18T17:47:03.837

我不确定调试播放器是否较慢。当然，正如您提到的，它允许您查看 flashlog.txt 中的跟踪语句，它还允许您通过右键单击并选择“显示重绘区域”来查看重绘区域。有一些应用程序，如 De Monster Debugger ( [http://demonsterdebugger.com/](http://demonsterdebugger.com/) ) 和 flash tracer ( [https://addons.mozilla.org/en-US/firefox/addon/3469](https://addons.mozilla.org/en-US/firefox/addon/3469) ) 允许您检查变量使用调试播放器更容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:54:44.820

除了 quoo 提到的内容外，调试播放器将显示一个弹出窗口，其中包含应用程序中发生的任何未捕获异常的堆栈跟踪（至少对于基于 AS3 的 SWF）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-05-18T17:42:24.750

调试版本会更慢，我认为它可以更容易地在运行时检查一些变量。

# perl - sed：跨多行使用变量

> ID：878920
> 
> 赞同：1
> 
> 时间：2009-05-18T17:39:25.210
> 
> 标签：perl, shell, sed

我正在尝试从 LDAP 日志文件中为特定用户“grep”绑定。我需要的行将分布在日志中的多行中。这是示例输入：

```
[2009/04/28 17:04:42.414] DoBind on connection 0x7c8affc0
[2009/04/28 17:04:42.414] Bind name:cn=admin,ou=appids,o=admineq, version:3, authentication:simple
[2009/04/28 17:04:42.415] Failed to authenticate local on connection 0x6cc8ee80, err = log account expired (-220)
[2009/04/28 17:04:42.416] Sending operation result 53:"":"NDS error: log account expired (-220)" to connection 0x6cc8ee80
[2009/04/28 17:04:42.416] Operation 0x3:0x60 on connection 0x6cc8ee80 completed in 3 seconds
[2009/04/28 17:04:42.416] Sending operation result 0:"":"" to connection 0x7c8affc0
[2009/04/28 17:04:42.416] Operation 0x1:0x60 on connection 0x7c8affc0 completed in 0 seconds
[2009/04/28 17:04:48.772] DoSearch on connection 0x7c8affc0
[2009/04/28 17:04:48.772] Search request:
base: "o=intranet"
scope:2  dereference:0  sizelimit:0  timelimit:600  attrsonly:0
filter: "(guid='03ADmin)"
attribute: "cn"
attribute: "cn"
attribute: "cn"
attribute: "cn"
attribute: "objectClass"
attribute: "guid"
attribute: "mail"
[2009/04/28 17:04:48.773] Sending operation result 0:"":"" to connection 0x7c8affc0
[2009/04/28 17:04:48.773] Operation 0xe851:0x63 on connection 0x7c8affc0 completed in 0 seconds 
```

对于此示例，结果应该如下：

```
[2009/04/28 17:04:42.414] DoBind on connection 0x7c8affc0
[2009/04/28 17:04:42.414] Bind name:cn=admin,ou=appids,o=admineq, version:3, authentication:simple
[2009/04/28 17:04:42.416] Sending operation result 0:"":"" to connection 0x7c8affc0
[2009/04/28 17:04:42.416] Operation 0x1:0x60 on connection 0x7c8affc0 completed in 0 seconds 
```

基本上，这是跨多个连接的服务器操作日志。我需要分析管理员用户在“绑定”操作中花费的时间，但是这个服务器非常繁忙，所以我需要消除很多噪音。

在伪代码中：

```
for each line in file
    if line contains "DoBind" and next line contains "cn=admin"
        print both lines
        find the connection number X in lines
        skip lines until "Sending operation result.*to connection X" is found
        print two lines 
```

我想获取用户“cn=admin”之前的“DoBind”行，然后是结果行，在本例中根据连接号“0x7c8affc0”列出。在我不需要的绑定的开始和结束之间可能会发生其他操作，例如在不同的连接上发生的“验证失败”消息。

此外，绑定完成后，连接上还会发生其他我不感兴趣的操作。在上面，不能捕获在“绑定”之后发生的 DoSearch 操作的结果。

我正在尝试使用“sed”来做到这一点，这似乎是适合这项工作的工具。唉，不过，我是一个初学者，这是一次学习经历。这是我到目前为止所拥有的：

```
/.*DoBind on connection \(0x[0-9a-f]*\)\n.*Bind name:cn=OblixAppId.*/ p
/.*Sending operation result.*to connection \1\nOperation.*on connection \1 completed.*/ p 
```

sed 抱怨我使用 '\1' 的第二行。我正在尝试捕获连接地址并在后续搜索中使用它来捕获结果字符串，但我显然没有正确使用它。'#' 变量似乎是每个搜索操作的本地变量。

有没有办法将“变量”从一个搜索传递到另一个搜索，或者我应该学习 perl 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-19T13:32:15.473

作为一项智力挑战，我提出了一个使用 sed 的解决方案（根据要求），但我会说使用其他一些技术（我最喜欢的 perl）会更容易理解，因此更容易支持。

对于 sed 中的多行处理，您有几个选择：

*   您可以使用*保持空间*- 可用于存储全部或部分*模式空间*以供后续处理，或者

*   您可以使用*诸如*`N`.

    你可以使用*保持空间*

**注意：**下面的示例使用 GNU sed。通过更改多命令语法（';' 替换为 ），它还可以与 Solaris sed 一起使用。我使用了 GNU sed 变体来使脚本更紧凑。

**为了读者和**我的利益，对下面的脚本进行了评论。

```
sed -n '
# if we see the line "DoBind" then store the pattern in the hold space
/DoBind/ h

# if we see the line "cn=admin", append the pattern to the holdspace
# and branch to dobind
/cn=admin/{H;b dobind}

# if we see the pattern "Sending...." append the hold space to the
# pattern and  branch to doop
/Sending operation result/{G;b doop}

# branch to the end of the script
b

# we have just seen a cn=admin, ad the hold space contains the last
# two lines
:dobind

# swap hold space with pattern space
x

# print out the pattern space
p

# strip off everying that is not the connection identifier
s/^.*connection //
s/\n.*$//

# put it in the hold space
x

# branch to end of script.
b

# have just seen "Sending operation" and the current stored connection
#identifier has been appended to the pattern space
:doop

# does the connection id on both lines match? Yes do to gotop.
/connection \(0x[0-9a-f]*\).*\n\1$/ b gotop

# branch to end of script
b

# pattern contains two lines "Sending....", and the connection id.
:gotop

# delete the second line
s/\n.*$//

# read the next line and append it to the pattern space.
N

# print it out
p

# clear the pattern space, and put it into the hold space - hence
# clearing the hold space
s/^.*$//
x 
```

'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T17:54:38.627

```
fgrep -B1 cn=admin logfile | 
sed -n 's/.*DoBind on connection \(.*\)/\1/p' | 
fgrep -wf - logfile 
```

第一个 fgrep 提取 Bind 行和前一行 (-B1)，sed 提取连接号，最后一个 fgrep 查找包含一个连接号的所有行。

这是一个两次通过的解决方案，一次通过是可能的，但实施起来更复杂。

编辑：这是一个在 python 中做你想要的解决方案。但是请注意，这并不完全正确，因为它无法正确处理不同连接之间的交错日志行 - 如果您足够关心修复它，我将由您决定。它也有点效率低下，并且做了比必要更多的正则表达式编译和匹配。

```
import re

todo = set()
display_next = False
previous_dobind = None

for line in open('logfile'):
  line = line.strip()
  if display_next:
    print line
    display_next = False
    continue
  dobind = re.search('DoBind on connection (.*)', line)
  bind = re.search('Bind name:cn=admin', line)
  oper = re.search('Sending operation result.*to connection (.*)', line)
  if dobind:
    previous_dobind = (dobind.groups(1), line)
  elif previous_dobind:
    if bind:
      todo.add(previous_dobind[0])
      print previous_dobind[1]
      print line
    previous_dobind = None
  elif oper:
    conn = oper.groups(1)
    if conn in todo:
      print line
      display_next = True
      todo.remove(conn) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-18T18:07:42.203

如果您希望一次通过 sed 参考，您将需要仔细查看它 - 您当然可以这样做。查看交换保持和模式缓冲区的 sed 命令，并比较两者。您可以编写一个匹配“cn=admin”的多步规则，并将其交换到保持缓冲区，然后在保持缓冲区不为空时匹配“DoBind”模式。

我不记得这些命令，但它并不是非常复杂；您只需要在参考文档中查找它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-19T00:32:33.783

好吧，我找不到单独使用 sed 的解决方案。这是我丑陋的 perl 解决方案：

```
open INFILE, $ARGV[0] or die "Couldn't open file $ARGV[0]";
while (<INFILE>) {
  if (/(.*DoBind on connection (0x[0-9a-f]*))/) {
    $potentialmatch = $1; $connid = $2;
    $currentline = <INFILE>;
    if ($currentline =~ /(.*Bind name:cn=OblixAppId.*)/) {
      print $potentialmatch . "\n" . $1 . "\n";
      $offset = tell INFILE;
      while($currentline = <INFILE>) {
        if ($currentline =~ /(.*Sending operation result.*to connection $connid.*)/) {
          print "$1\n";
          next;
        }
        if ($currentline =~ /(.*Operation.*on connection $connid completed.*)/) {
          print  "$1\n";
          seek INFILE, $offset, 0;
          last;
        }
      }
    }
  }
} 
```

# delphi - 如何将字节 [] 分配给记录

> ID：878921
> 
> 赞同：5
> 
> 时间：2009-05-18T17:39:25.817
> 
> 标签：delphi

在 C++ 中，它是这样完成的：

```
tPacket * packet = (tPacket *)data; //data is byte[] array; tPacket is a structure 
```

在 C# 中：

```
tPacket t = new tPacket();
GCHandle pin = GCHandle.Alloc(data, GCHandleType.Pinned);
t = (tPacket)Marshal.PtrToStructure(pin.AddrOfPinnedObject(), typeof(tPacket));
pin.free(); 
```

数据是通过 TCP 接收数据包后用作接收缓冲区的字节数组。该代码将数据放在 tPacket 的一个实例（一个结构）中，以便我以后可以访问该结构。

在 Delphi 中是如何实现的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T20:29:10.607

您还可以使用 absolute 关键字来强制两个结构共享相同的内存地址：

```
var
  Data: array[1..SizeOf(TMyStruct)] of byte;
  s : TMyStruct absolute Data; 
```

写入 S 的任何数据也可以作为 Data 使用，而无需执行移动或指针转换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-19T06:55:56.097

你可以在 Delphi 中做你在 C++ 中所做的事情。但是，为记录指针定义一个命名类型，因为 Delphi 不允许您在语句中定义类型。

```
type
  PPacket = ^TPacket;
var
  packet: PPacket;

packet := PPacket(@data[0]); 
```

*   我使用的原因`@data[0]`是无论数据是否为动态数组，它都可以工作。如果它是一个动态数组，那么`data`它实际上是一个指向数据包第一个字节的指针，所以这会起作用：

    ```
    packet := PPacket(data); // for dynamic array only 
    ```

    但如果*不是*`data`动态数组，那么该类型转换将无效。相反，您需要将*指针*类型转换为，如下所示：**`data`**

     **```
    packet := PPacket(@data); // for static array only 
    ```

    如果它是动态数组，那将不起作用。第一个代码在这两种情况下都适用。`data`但是如果你启用了范围检查（你可能应该），那么我认为如果是零长度动态数组，第一个代码会引发异常，所以要小心。** 

 *** * *

如果您想转而使用 C# 路线，将数组中的字节复制到一个单独的`TPacket`变量中，那么我会使用它：

```
var
  packet: TPacket;

// Source param comes first. Params are passed by
// reference automatically.
Move(data[0], packet, SizeOf(packet)); 
```

您需要确保`data`包含足够的字节来填充整个`TPacket`值。`TPacket`最好不要包含任何编译器管理的类型，如`string`、`Variant`、`IUnknown`或动态数组类型。`Move`在这种情况下，指针类型转换和表现都不好。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T17:55:51.417

这可能很棘手，因为您必须确保源和目标结构布局相同。如果是，那么您有 2 个选择，要么使用指向 Data 数组的指针，要么使用内存副本：

指针：

```
type
  // Declare a pointer type for your struct.
  PMyStruct = TMyStruct^;

...

var
  ptr: PMyStruct;
begin
  ptr := PMyStruct(Cardinal(@Data));
  // use ptr...
end; 
```

内存拷贝：

```
var
  Data: array of Byte;
  s: TMyStruct;
begin
  // fill Data...
  if SizeOf(s) <> Length(Data) then
    raise Exception.Create('Input size is not the same size as destination structure.');
  CopyMemory(@s, @Data, Length(Data));
  // use s...
end; 
```

# wpf - 将文本框 IsFocused 绑定到 Popup IsOpen 以及附加条件

> ID：878930
> 
> 赞同：3
> 
> 时间：2009-05-18T17:42:15.157
> 
> 标签：wpf, binding, textbox, focus, dependency-properties

我有一个`TextBox`和一个`Popup`控制。我希望该`Popup.IsOpen`属性绑定到该`TextBox.IsFocused`属性。换句话说，如果文本框有焦点，则弹出窗口是打开的。或者，如果弹出窗口是焦点，我不希望它因为文本框失去焦点而关闭。我希望使用绑定来处理这个问题，而不是在事件处理程序中处理这个问题。此外，我是否必须对依赖属性做任何事情，因为它们是预先存在的（即注册、覆盖元数据等），或者我可以绑定到这些属性。

这是一些类似于我的场景的示例代码

```
StackPanel sp = new StackPanel();
TextBox tb = new TextBox();
Popup popup = new Popup();

sp.Children.Add(tb);
sp.Children.Add(popup);
this.Content = sp;

Binding bd = new Binding("IsFocused");
bd.source = tb.IsFocused;
popup.SetBinding(Popup.IsOpenProperty, bd); 
```

从这里我假设如果我点击文本框控件并给它焦点，弹出窗口会打开，相反，如果文本框失去焦点，弹出窗口会关闭。我似乎无法让它工作。

如果有人知道我做错了什么，那么也许他们也可以回答我的问题的后半部分，即如果文本框失去焦点但弹出窗口获得焦点，则弹出窗口将保持打开状态或将焦点返回到文本框，以便它将在第一个绑定之前保持打开状态。当文本框失去焦点时获得焦点的任何其他控件都不适用于这种情况。

如果为了清楚起见我可以改写它，我会这样说。

**1.)**绑定`Popup.IsOpen`到`TextBox.IsFocused`

**2.)**绑定`TextBox.IsFocused`到`Popup.IsFocused`（假设这只会让焦点回到文本框）

* * *

这是我的第一次 C# 尝试。有些事情还是不太对劲。什么都没有发生，所以我不太确定我的错误在哪里。

```
 StackPanel sp = new StackPanel(); 
        TextBox tb = new TextBox(); 
        Popup popup = new Popup();

        TextBox popupTextBox = new TextBox();
        popup.Child = popupTextBox;

        sp.Children.Add(tb); 
        sp.Children.Add(popup); 
        this.Content = sp;

        //***Questions concerning giving the UIElement a name and registering it
        tb.Name = "siblingTextBox";
        System.Windows.NameScope.GetNameScope(tb).RegisterName("siblingTextBox", tb);

        //***Questions concerning giving the UIElement a name and registering it
        popupTextBox.Name = "popupTextBox";
        System.Windows.NameScope.GetNameScope(tb).RegisterName("popupTextBox", popupTextBox);

        Binding binding = new Binding();
        binding.ElementName = tb.Name;
        popup.PlacementTarget = tb;

        Style style = new Style();
        style.TargetType = typeof(Popup);

        DataTrigger dataTrigger = new DataTrigger();
        Binding focusedBinding = new Binding("IsFocused");
        focusedBinding.ElementName = tb.Name;
        dataTrigger.Value = true;
        dataTrigger.Binding = focusedBinding;

        Setter setter = new Setter();
        setter.Property = Popup.IsOpenProperty;
        setter.Value = true;
        dataTrigger.Setters.Add(setter);
        style.Triggers.Add(dataTrigger);

        dataTrigger = new DataTrigger();
        focusedBinding = new Binding("IsFocused");
        focusedBinding.ElementName = popupTextBox.Name;
        dataTrigger.Value = true;
        dataTrigger.Binding = focusedBinding;
        setter = new Setter();
        setter.Property = Popup.IsOpenProperty;
        setter.Value = true;
        dataTrigger.Setters.Add(setter);
        style.Triggers.Add(dataTrigger);

        popup.Style = style; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T19:19:32.603

以下代码演示了在 StackPanel 中有两个文本框，将焦点设置到顶部文本框将打开 Popup。此时，如果您将焦点移动到弹出窗口中包含的文本框，它将保持打开状态。如果将焦点移动到另一个元素，在本例中为 StackPanel 中的第二个文本框，弹出窗口将关闭。由于您无法聚焦 Popup 本身，我实际上绑定到 Popup 中文本框的 IsFocused 属性。

```
<StackPanel>
    <TextBox x:Name="text" Text="This is a text box" />
    <TextBox Text="Another Text Box" />
    <Popup PlacementTarget="{Binding ElementName=text}">
        <Popup.Style>
            <Style TargetType="{x:Type Popup}">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ElementName=text, Path=IsFocused}" Value="True">
                        <Setter Property="IsOpen" Value="True" />
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ElementName=popupText, Path=IsFocused}" Value="True">
                        <Setter Property="IsOpen" Value="True" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Popup.Style>
        <TextBox x:Name="popupText" Text="HELLO WORLD" />
    </Popup>
</StackPanel> 
```

要在 C# 中实现相同的功能，您不必使用 ElementName 绑定，因为您手头已经有了元素。我几乎总是使用 XAML 来定义我的元素，所以我相信您可以稍微整理一下。

```
var text1 = new TextBox { Name = "text", Text = "This is a text box" };
var text2 = new TextBox { Text = "Another Text Box" };
var popupText = new TextBox { Name = "popupText", Text = "HELLO WORLD" };
var popup = new Popup { Child = popupText, PlacementTarget = text1 };
var stackPanel = new StackPanel();

stackPanel.Children.Add(text1);
stackPanel.Children.Add(text2);
stackPanel.Children.Add(popup);

var popupStyle = new Style(typeof (Popup));
var textIsFocusedTrigger = new DataTrigger
    {
        Binding = new Binding {Source = text1, Path = new PropertyPath("IsFocused")},
        Value = true
    };

textIsFocusedTrigger.Setters.Add(new Setter(Popup.IsOpenProperty, true));

var popupTextIsFocusedTrigger = new DataTrigger
    {
        Binding = new Binding {Source = popupText, Path = new PropertyPath("IsFocused")},
        Value = true
    };

popupTextIsFocusedTrigger.Setters.Add(new Setter(Popup.IsOpenProperty, true));

popupStyle.Triggers.Add(textIsFocusedTrigger);
popupStyle.Triggers.Add(popupTextIsFocusedTrigger);

popup.Style = popupStyle; 
```

我希望这有帮助！

# winapi - 将短（8.3）路径转换为长路径？

> ID：878933
> 
> 赞同：1
> 
> 时间：2009-05-18T17:42:27.153
> 
> 标签：winapi, wtl

在 Win32/WTL/C++ 应用程序中，我需要将一些 8.3 路径转换为它们的真实文件名。我该怎么做？

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-18T17:46:54.757

使用[GetLongPathName](http://msdn.microsoft.com/en-us/library/aa364980(VS.85).aspx) API。

# c# - Visual Studio 2008 Pro 中的单元测试浮动操作

> ID：878937
> 
> 赞同：23
> 
> 时间：2009-05-18T17:42:55.950
> 
> 标签：c#, unit-testing, .net-3.5, floating-point

我有一些执行一些浮点/双精度操作的 C# 单元测试，我想对它们进行单元测试。由于舍入错误，Assert.AreEqual 不足。

以单位换算为例。10.5 米到英尺的转换系数为 3.281，所以我得到 34.4505。使用更准确的转换因子给我 34.4488189。我想在 0.1 内测试这个（所以 34.3488-34.5488 会通过测试）。

我可以确定在我的单元测试中手动测试带有容差的值，但这是高度重复的，并且失败消息不会很有描述性（再次不必编写我自己的 Assert 失败消息）：

```
Assert.IsTrue(Math.Abs(34.4488189 - value) < 0.1); 
```

**如何在一定的容错范围内对浮点操作进行单元测试？** 我找不到任何与 VS 一起执行此操作的 Assert 类。我想念它还是必须自己动手？

**在测试浮点数/双打时是否有标准做法需要牢记？**

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2009-05-18T17:55:07.503

MSTest 中的 Assert.AreEqual 具有接受 delta（容错）参数的重载：

```
public static void AreEqual (double expected, double actual, double delta) 
```

例如：

```
Assert.AreEqual(34.4488189, value, 0.1); 
```

或者，对于尽可能小的公差：

```
Assert.AreEqual(34.4488189, value, double.Epsilon); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-18T17:50:19.133

你可以看看[NUnit](http://sourceforge.net/projects/nunit)框架：

```
//Compare Float values
Assert.AreEqual(float expected, float actual, float tolerance);
Assert.AreEqual(float expected, float actual, float tolerance, string message);

//Compare Double values
Assert.AreEqual(double expected, double actual, double tolerance);
Assert.AreEqual(double expected, double actual, double tolerance, string message) 
```

（以上摘自[这篇](http://www.code-magazine.com/article.aspx?quickid=0411051&page=2)文章）

[更多在这里](http://www.nunit.org/index.php?p=equalityAsserts&r=2.2.7)列出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-18T17:50:36.637

NUnit 可以通过提供 AreEqual 方法的第三个参数来在容差范围内进行比较。看看[NUnit 平等断言](http://www.nunit.org/index.php?p=equalityAsserts&r=2.5)

Visual Studio 单元测试也有这个：[AreEqual Method (Double, Double, Double, String)](http://msdn.microsoft.com/en-us/library/ms243456.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T17:54:03.480

我在我的手机上，所以请原谅缺少代码/链接。

这里有一个关于最喜欢的 c# 扩展的问题，人们在其中扩展了内置类型，例如字符串。您可以使用这样的方法扩展浮点类型：

```
Myfloat.IsInTolerance(34.8f, 0.1f) 
```

..如果 Myfloat 浮点数在 34.8 的任一侧为 0.1，则返回 true。它可以使它不那么费力。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-15T21:44:57.303

看看 NUnit Equality Constraints，它们很灵活！希望它可以帮助！

# python - 为什么返回 NotImplemented 而不是引发 NotImplementedError

> ID：878943
> 
> 赞同：362
> 
> 时间：2009-05-18T17:43:40.817
> 
> 标签：python, exception

Python 有一个名为[`NotImplemented`](https://docs.python.org/2/library/constants.html#NotImplemented).

为什么有人想要返回`NotImplemented`而不是引发[`NotImplementedError`](https://docs.python.org/2/library/exceptions.html#exceptions.NotImplementedError)异常？会不会让查找错误变得更加困难，例如执行无效方法的代码？

* * *

## 回答 #1

> 赞同：354
> 
> 时间：2009-05-18T17:58:32.020

这是因为`__lt__()`相关的比较方法在列表排序等中非常常用。有时算法会选择尝试另一种方式或选择默认的获胜者。除非被捕获，否则引发异常将打破排序，而`NotImplemented`不会引发异常并且可以在进一步的测试中使用。

[http://jcalderone.livejournal.com/32837.html](http://jcalderone.livejournal.com/32837.html)

总结该链接：

> "`NotImplemented`向运行时发出信号，它应该要求其他人来满足操作。在表达式`a == b`中，如果`a.__eq__(b)`返回`NotImplemented`，则 Python 尝试`b.__eq__(a)`。如果`b`知道足够的返回`True`或`False`，则表达式可以成功。如果没有，那么运行时将回退到内置行为（基于 和 的身份`==`）`!=`。”

* * *

## 回答 #2

> 赞同：193
> 
> 时间：2017-06-15T19:55:19.053

**因为它们有不同的用例。**

引用文档（Python 3.6）：

**[未实现](https://docs.python.org/3.6/library/constants.html#NotImplemented)**

> 应由二进制特殊方法（例如`__eq__()`, `__lt__()`, `__add__()`,`__rsub__()`等）返回，以指示该操作未针对其他类型实现

**[异常 NotImplementedError](https://docs.python.org/3.6/library/exceptions.html#NotImplementedError)**

> [...] 在用户定义的基类中，当抽象方法需要派生类覆盖方法时，或者在开发类以指示仍需要添加实际实现时，它们应该引发此异常。

有关详细信息，请参阅链接。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-05-18T17:54:03.650

一个原因是性能。在像富比较这样的情况下，您可能会在短时间内执行大量操作，设置和处理大量异常可能比简单地返回`NotImplemented`值花费更长的时间。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2020-08-27T06:08:12.783

由函数返回`NotImplemented`类似于声明该函数无法处理输入，但不是引发异常，而是将控制权转移到另一个称为**反射函数**的函数，希望反射函数能够处理输入。

首先，预定义与任何函数相关的**反射函数。**其次，当原始函数返回时`NotImplemented`，解释器运行**反射函数**，但输入参数的**顺序颠倒了。**

[您可以在此处](https://www.youtube.com/watch?v=vqzrLnZ9Y5M&t=91s)找到详细示例

# javascript - FBML 框架/沙盒页面？

> ID：878949
> 
> 赞同：1
> 
> 时间：2009-05-18T17:46:01.233
> 
> 标签：javascript, facebook, fbml

有谁知道我在哪里可以找到一个体面的骨架页面或创建全 FBML Facebook 应用程序的示例？我已经查看了官方 wiki 并进行了很多搜索，但我找不到任何可靠的东西。wiki 中的大多数示例要么已过时，要么已损坏，要么过于简单化。我可以做“Hello World”——现在我需要剩下的了。

例如，我是否需要使用标签来包含我所有的 FBML？我在哪里使用 - 仅在 iframe 中？我如何以及何时使用 profile.setFBML？

我意识到竞争很激烈，但那里必须有一些不错的资源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-26T14:13:20.533

FBML 已被弃用 (https://developers.facebook.com/docs/reference/fbml/)，您应该考虑使用 Javascript SDK (https://developers.facebook.com/docs/reference/javascript/) 包装器对于图形 API。

此外，使用 FBML 完成的一些核心工作现在可以在 HTML 社交插件中完成。请参阅[https://developers.facebook.com/docs/plugins/](https://developers.facebook.com/docs/plugins/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T21:34:55.517

示例应用程序通常与客户端库（例如 .NET 或 RoR 库）一起分发。

你真的想完全用 FBML 构建一个没有后端的应用程序吗？

有关您要达到的目标的其他信息将有助于您。

# .net - IJW：托管代理结构？

> ID：878955
> 
> 赞同：3
> 
> 时间：2009-05-18T17:46:59.843
> 
> 标签：.net, unmanaged, marshalling

我正在将一些 C++ 代码移植到托管 .NET。我需要保留一些原生形式的 C++ 代码，并尝试使用 IJW 方法。我知道可以声明一个非托管结构，以便将其正确编组为 .NET 代码，但 C++ 编译器似乎没有这样做。

例如我有这个代码（托管）：

```
struct MyStruct
{
     int some_int;
     long some_long;
};

public ref class Class1
{
    static MyStruct GetMyStruct()
    {
        MyStruct x = { 1, 1 };
        return x;
    }
}; 
```

它可以编译，但是当我使用反射器查看它时，代码如下所示：

```
public class Class1
{
    // Methods
    private static unsafe MyStruct GetMyStruct()
    {
        MyStruct x;
        *((int*) &x) = 1;
        *((int*) (&x + 4)) = 1;
        return x;
    }
}

[StructLayout(LayoutKind.Sequential, Size=8), NativeCppClass, 
                      MiscellaneousBits(0x41), DebugInfoInPDB]
internal struct
{
} 
```

基本上，MyStruct 中没有任何字段对 .NET 可见。有没有办法告诉 C++ 编译器生成一个？

**回答时，请考虑这一点**：我知道如何创建一个对 .NET 框架可见的托管类。我对这样做不感兴趣。我想要的是 C++ 编译器以 .NET 可以理解的方式声明非托管结构，例如：

```
[StructLayout(LayoutKind::Sequential, blablabla ... )]
struct MyStruct
{
    [MarshalAs ....... ]
    System::Int32 some_int;
    [MarshalAs ....... ]
    System::Int32 some_long;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-01-09T12:49:52.080

如果您想从 C++ 托管代码定义对 .NET 应用程序可见的公共结构，可以使用以下方法（注意“public”和“value”关键字）：

```
[StructLayout(LayoutKind::Sequential)]
public value struct MyStruct
{
    int some_int;
    long some_long;
}; 
```

如果您希望在 C# 和 C/C++ 之间移动非托管结构，则必须在双方都声明它。像这样在C中：

```
struct MyUnmanagedStruct
{
         int some_int;
         long some_long;
}; 
```

就像这样，比如说，在 C# 中，例如：

```
[StructLayout(LayoutKind.Sequential)]
struct MyUnmanagedStruct
{
    public int some_int;
    public long some_long; // or as int (depends on 32/64 bitness)
}; 
```

您必须确保 .NET 中的字段与 C 中的字段匹配。您可能需要使用[StructLayout](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.structlayoutattribute.aspx)属性（尤其是 Pack）。请参阅此处的两个教程：[结构教程](http://msdn.microsoft.com/en-us/library/aa288471%28v=vs.71%29.aspx)和此处：[如何：使用 PInvoke 编组结构](http://msdn.microsoft.com/en-us/library/ef4c3t39%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-09T13:43:28.540

这个问题在过去 2 年被浏览了 194 次，不乏关注。将缺乏答案作为充分证明这是不可能的。必须对非托管结构*进行*封送处理，结构的 .NET 布局规则与 C 或 C++ 编译器的布局规则根本不兼容。 [这个答案](https://stackoverflow.com/a/3362736/17034)提供了一些关于为什么 .NET 以这种方式工作的背景信息。

# asp.net - 如何在没有锚的页面上为 url 编写正确的正则表达式？

> ID：878957
> 
> 赞同：1
> 
> 时间：2009-05-18T17:47:11.667
> 
> 标签：asp.net, asp.net-mvc, regex, weblogic, logic

我想剪切所有 url 之类的（[http://...](http://...)。）并将它们替换为锚点`<a></a>`，但我的要求：不要触摸锚点和页面定义（文档类型），例如：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

所以我需要找到带有url的纯文本......

我正在尝试覆盖我在页面内的渲染，并制作了 BrowserAdapter：

```
<browser refID="default">
    <controlAdapters>
        <adapter controlType="System.Web.Mvc.ViewPage"
                 adapterType="Facad.Adapters.AnchorAdapter" />
    </controlAdapters>
</browser> 
```

它看起来像这样：

```
public class AnchorAdapter : PageAdapter
{
    protected override void Render(HtmlTextWriter writer)
    {
        /* Get page output into string */
        var sb = new StringBuilder();
        TextWriter tw = new StringWriter(sb);
        var htw = new HtmlTextWriter(tw);

        // Render into my writer
        base.Render(htw);

        string page = sb.ToString();
        //regular expression 
        Regex regx = new Regex("http://([\\w+?\\.\\w+])+([a-zA-Z0-9\\~\\!\\@\\#\\$\\%\\^\\&amp;\\*\\(\\)_\\-\\=\\+\\\\\\/\\?\\.\\:\\;\\'\\,]*)?", RegexOptions.IgnoreCase); 

        //get the first match 
        Match match = regx.Match(page); 

        //loop through matches 
        while (match.Success)
        {

            //output the match info 
            System.Web.HttpContext.Current.Response.Write("<p>url match: " + match.Groups[0].Value+"</p>");

            //get next match 
            match = match.NextMatch();
        }

        writer.Write(page);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-18T18:18:08.440

您只需要在 url 前后搜索一下，看看它是否在引号中，不太可能有人将引用的 url 粘贴为纯文本，但 url 总是在标签和文档类型中引用。所以你的正则表达式变成：

```
(^|[^'"])(http://([\\w+?\\.\\w+])+([a-zA-Z0-9\\~\\!\\@\\#\\$\\%\\^\\&amp;\\*\\(\\)_\\-\\=\\+\\\\\\/\\?\\.\\:\\;\\'\\,]*)?)([^'"]+|$) 
```

(^|[^'"]+) 表示字符串的开头或不是引号的字符 ([^'"]|$) 表示字符串的结尾或不是引号

旧正则表达式周围的额外括号确保它是一个捕获组，因此您可以使用 \2 （组 2）检索实际 URL，而不是获取它可能在 url 边缘匹配的额外废话

顺便说一句，您的 URL 正则表达式看起来很糟糕，有更紧凑和准确的形式。你真的不需要逃避一切。

# html - 为什么将搜索输入放在表单标签中？

> ID：878960
> 
> 赞同：5
> 
> 时间：2009-05-18T17:47:33.133
> 
> 标签：html, search

我发现SO将搜索输入放在表单标签中，我发现其他一些网站也这样做，例如谷歌，他们将搜索输入和搜索按钮放在这个里面：

```
<form action="/search" method="get" name="gs" id="tsf"> 
```

我只想知道这样做的好处，因为它似乎很常见，我很想念它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-18T17:53:25.743

您如何阅读[有关 HTML 表单的教程](http://www.w3schools.com/html/html_forms.asp)？

表格中输入的数据必须发送到服务器。该`action`属性告诉浏览器*是哪个*服务器。

此外，发送数据的常用方法有两种：通过`POST`（在[`HTTP`](http://en.wikipedia.org/wiki/HTTP)标头中）和通过`GET`（作为查询字符串的一部分，a 中问号后面的部分`URL`）。必须使用哪种方法在`method`属性中指定。

`POST`当数据应该只提交一次或应该是私有的（例如在网站上注册或登录）时，通常使用。`GET`用于可能根据需要经常发送的数据（因为结果`URL`包含一个查询字符串，例如可以添加书签）。示例：使用 发送 Google 搜索查询`GET`，但使用登录到您的 GMail 帐户`POST`。更详细的解释可以在[这里](http://www.cs.tut.fi/~jkorpela/forms/methods.html)找到。

**编辑**：下面你问为什么整个页面不能只包含在一个表单标签中。正如[divo](https://stackoverflow.com/users/40347/divo)正确回答的那样：您可能有多个表单可以提交到不同的服务器。例如，您可以在网页上提供两个文本字段：一个允许一个使用 Google 搜索网站，另一个使用 Yahoo。有了一点创造力，其他用途就会浮现在脑海中。

**编辑 2**：

> 你能指出一个不同的教程吗？W3Schools 有错误。– [David Dorward](https://stackoverflow.com/users/19068/david-dorward) 10 分钟前

如果是这样（我没有检查），这两个看起来很有希望：

*   [tizag.com](http://www.tizag.com/htmlT/forms.php)
*   [javascript-coder.com](http://www.javascript-coder.com/html-form/html-form-tutorial-p1.phtml)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T17:50:35.157

元素的`action`属性`<form>`告诉浏览器服务器上的哪个 URL 负责处理表单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:48:57.797

否则您将如何将搜索词传输到服务器？在表单标签内输入的原因是浏览器可以将值发布到服务器进行处理。

**编辑：**为了更好地理解，我建议您阅读[HTML Forms 和 Input](http://www.w3schools.com/html/html_forms.asp)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-18T17:53:03.107

搜索输入只是一个通用文本框，从页面获取信息（您正在搜索的内容）到服务器的唯一方法是通过表单发送信息。

www.w3schools.com 和其他人有一些关于构建表格的很棒的教程。

从理论上讲，您可以使用 JavaScript 提交信息而无需显式输入表单，但如果客户端禁用了 JavaScript，它将永远无法工作 - 而使用 HTML 将一直有效

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-18T17:57:51.427

这可能有点牵强，但根据您的网站 www.igurr.com，我认为您真正要问的是：

> 为什么我不必在我的页面上放置一个表单标签才能将其发回？

这是因为 ASP.NET 会在`form`标记之后自动为您添加一个`body`标记：

```
<form name="aspnetForm" method="post" action="/default.aspx" id="aspnetForm"> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-18T18:02:12.947

我明白了原因，很简单：

这些网站没有为所有页面放置一个大的通用表单标签，而是将表单放在将返回服务器的部分周围，但为什么不将所有内容都放在一个表单中，这是我现在想要理解的。

# asp.net - 直接在标记中设置 ASP.NET 应用程序

> ID：878966
> 
> 赞同：3
> 
> 时间：2009-05-18T17:49:38.620
> 
> 标签：asp.net, markup, appsettings

直接从 ASP.NET 标记访问 AppSettings 的语法是什么？我记不清了，但它类似于 '<%= $.settingname %>'

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-18T17:51:28.600

<%$ AppSettings:SettingName %>'

# python - Windows cmd 编码更改导致 Python 崩溃

> ID：878972
> 
> 赞同：61
> 
> 时间：2009-05-18T17:52:10.410
> 
> 标签：python, windows, unicode, encoding, cmd

首先，我将 Windows CMD 编码更改为 utf-8 并运行 Python 解释器：

```
chcp 65001
python 
```

然后我尝试在其中打印一个 unicode 刺痛，当我这样做时，Python 以一种特殊的方式崩溃（我只是在同一个窗口中得到一个 cmd 提示符）。

```
>>> import sys
>>> print u'ëèæîð'.encode(sys.stdin.encoding) 
```

任何想法为什么会发生以及如何使其发挥作用？

**UPD**：`sys.stdin.encoding`退货`'cp65001'`

**UPD2**：我刚想到这个问题可能与 utf-8 使用[多字节字符集](http://en.wikipedia.org/wiki/Multi-byte_character_set)的事实有关（kcwu 对此提出了很好的意见）。我尝试使用“windows-1250”运行整个示例并得到“ëea”？Windows-1250 使用单字符集，因此它适用于它理解的那些字符。但是我仍然不知道如何让 'utf-8' 在这里工作。

**UPD3**：哦，我发现这是一个[已知的 Python 错误](http://bugs.python.org/issue1602)。我猜发生的情况是 Python 将 cmd 编码作为 'cp65001 复制到 sys.stdin.encoding 并尝试将其应用于所有输入。由于它无法理解“cp65001”，它会在任何包含非 ascii 字符的输入上崩溃。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2010-07-15T19:35:10.067

以下是如何在`cp65001`不更改的情况下别名为 UTF-8 `encodings\aliases.py`：

```
import codecs
codecs.register(lambda name: codecs.lookup('utf-8') if name == 'cp65001' else None) 
```

[（恕我直言，在http://bugs.python.org/issue6058#msg97731](http://bugs.python.org/issue6058#msg97731)上不要注意`cp65001`与 UTF-8 不同的愚蠢。即使微软的编解码器有一些小错误，它也应该是一样的.)

下面是一些代码（为 Tahoe-LAFS，tahoe-lafs.org 编写），*无论*代码页如何，都可以使控制台输出工作`chcp`，并且还可以读取 Unicode 命令行参数。感谢[Michael Kaplan](http://www.siao2.com/2008/03/18/8306597.aspx)提出这个解决方案背后的想法。如果 stdout 或 stderr 被重定向，它将输出 UTF-8。如果你想要一个字节顺序标记，你需要明确地写出来。

[编辑：此版本使用`WriteConsoleW`而不是`_O_U8TEXT`MSVC 运行时库中的标志，这是错误的。`WriteConsoleW`相对于 MS 文档也是错误的，但不是这样。]

```
import sys
if sys.platform == "win32":
    import codecs
    from ctypes import WINFUNCTYPE, windll, POINTER, byref, c_int
    from ctypes.wintypes import BOOL, HANDLE, DWORD, LPWSTR, LPCWSTR, LPVOID

    original_stderr = sys.stderr

    # If any exception occurs in this code, we'll probably try to print it on stderr,
    # which makes for frustrating debugging if stderr is directed to our wrapper.
    # So be paranoid about catching errors and reporting them to original_stderr,
    # so that we can at least see them.
    def _complain(message):
        print >>original_stderr, message if isinstance(message, str) else repr(message)

    # Work around <http://bugs.python.org/issue6058>.
    codecs.register(lambda name: codecs.lookup('utf-8') if name == 'cp65001' else None)

    # Make Unicode console output work independently of the current code page.
    # This also fixes <http://bugs.python.org/issue1602>.
    # Credit to Michael Kaplan <http://www.siao2.com/2010/04/07/9989346.aspx>
    # and TZOmegaTZIOY
    # <http://stackoverflow.com/questions/878972/windows-cmd-encoding-change-causes-python-crash/1432462#1432462>.
    try:
        # <http://msdn.microsoft.com/en-us/library/ms683231(VS.85).aspx>
        # HANDLE WINAPI GetStdHandle(DWORD nStdHandle);
        # returns INVALID_HANDLE_VALUE, NULL, or a valid handle
        #
        # <http://msdn.microsoft.com/en-us/library/aa364960(VS.85).aspx>
        # DWORD WINAPI GetFileType(DWORD hFile);
        #
        # <http://msdn.microsoft.com/en-us/library/ms683167(VS.85).aspx>
        # BOOL WINAPI GetConsoleMode(HANDLE hConsole, LPDWORD lpMode);

        GetStdHandle = WINFUNCTYPE(HANDLE, DWORD)(("GetStdHandle", windll.kernel32))
        STD_OUTPUT_HANDLE = DWORD(-11)
        STD_ERROR_HANDLE = DWORD(-12)
        GetFileType = WINFUNCTYPE(DWORD, DWORD)(("GetFileType", windll.kernel32))
        FILE_TYPE_CHAR = 0x0002
        FILE_TYPE_REMOTE = 0x8000
        GetConsoleMode = WINFUNCTYPE(BOOL, HANDLE, POINTER(DWORD))(("GetConsoleMode", windll.kernel32))
        INVALID_HANDLE_VALUE = DWORD(-1).value

        def not_a_console(handle):
            if handle == INVALID_HANDLE_VALUE or handle is None:
                return True
            return ((GetFileType(handle) & ~FILE_TYPE_REMOTE) != FILE_TYPE_CHAR
                    or GetConsoleMode(handle, byref(DWORD())) == 0)

        old_stdout_fileno = None
        old_stderr_fileno = None
        if hasattr(sys.stdout, 'fileno'):
            old_stdout_fileno = sys.stdout.fileno()
        if hasattr(sys.stderr, 'fileno'):
            old_stderr_fileno = sys.stderr.fileno()

        STDOUT_FILENO = 1
        STDERR_FILENO = 2
        real_stdout = (old_stdout_fileno == STDOUT_FILENO)
        real_stderr = (old_stderr_fileno == STDERR_FILENO)

        if real_stdout:
            hStdout = GetStdHandle(STD_OUTPUT_HANDLE)
            if not_a_console(hStdout):
                real_stdout = False

        if real_stderr:
            hStderr = GetStdHandle(STD_ERROR_HANDLE)
            if not_a_console(hStderr):
                real_stderr = False

        if real_stdout or real_stderr:
            # BOOL WINAPI WriteConsoleW(HANDLE hOutput, LPWSTR lpBuffer, DWORD nChars,
            #                           LPDWORD lpCharsWritten, LPVOID lpReserved);

            WriteConsoleW = WINFUNCTYPE(BOOL, HANDLE, LPWSTR, DWORD, POINTER(DWORD), LPVOID)(("WriteConsoleW", windll.kernel32))

            class UnicodeOutput:
                def __init__(self, hConsole, stream, fileno, name):
                    self._hConsole = hConsole
                    self._stream = stream
                    self._fileno = fileno
                    self.closed = False
                    self.softspace = False
                    self.mode = 'w'
                    self.encoding = 'utf-8'
                    self.name = name
                    self.flush()

                def isatty(self):
                    return False

                def close(self):
                    # don't really close the handle, that would only cause problems
                    self.closed = True

                def fileno(self):
                    return self._fileno

                def flush(self):
                    if self._hConsole is None:
                        try:
                            self._stream.flush()
                        except Exception as e:
                            _complain("%s.flush: %r from %r" % (self.name, e, self._stream))
                            raise

                def write(self, text):
                    try:
                        if self._hConsole is None:
                            if isinstance(text, unicode):
                                text = text.encode('utf-8')
                            self._stream.write(text)
                        else:
                            if not isinstance(text, unicode):
                                text = str(text).decode('utf-8')
                            remaining = len(text)
                            while remaining:
                                n = DWORD(0)
                                # There is a shorter-than-documented limitation on the
                                # length of the string passed to WriteConsoleW (see
                                # <http://tahoe-lafs.org/trac/tahoe-lafs/ticket/1232>.
                                retval = WriteConsoleW(self._hConsole, text, min(remaining, 10000), byref(n), None)
                                if retval == 0 or n.value == 0:
                                    raise IOError("WriteConsoleW returned %r, n.value = %r" % (retval, n.value))
                                remaining -= n.value
                                if not remaining:
                                    break
                                text = text[n.value:]
                    except Exception as e:
                        _complain("%s.write: %r" % (self.name, e))
                        raise

                def writelines(self, lines):
                    try:
                        for line in lines:
                            self.write(line)
                    except Exception as e:
                        _complain("%s.writelines: %r" % (self.name, e))
                        raise

            if real_stdout:
                sys.stdout = UnicodeOutput(hStdout, None, STDOUT_FILENO, '<Unicode console stdout>')
            else:
                sys.stdout = UnicodeOutput(None, sys.stdout, old_stdout_fileno, '<Unicode redirected stdout>')

            if real_stderr:
                sys.stderr = UnicodeOutput(hStderr, None, STDERR_FILENO, '<Unicode console stderr>')
            else:
                sys.stderr = UnicodeOutput(None, sys.stderr, old_stderr_fileno, '<Unicode redirected stderr>')
    except Exception as e:
        _complain("exception %r while fixing up sys.stdout and sys.stderr" % (e,))

    # While we're at it, let's unmangle the command-line arguments:

    # This works around <http://bugs.python.org/issue2128>.
    GetCommandLineW = WINFUNCTYPE(LPWSTR)(("GetCommandLineW", windll.kernel32))
    CommandLineToArgvW = WINFUNCTYPE(POINTER(LPWSTR), LPCWSTR, POINTER(c_int))(("CommandLineToArgvW", windll.shell32))

    argc = c_int(0)
    argv_unicode = CommandLineToArgvW(GetCommandLineW(), byref(argc))

    argv = [argv_unicode[i].encode('utf-8') for i in xrange(0, argc.value)]

    if not hasattr(sys, 'frozen'):
        # If this is an executable produced by py2exe or bbfreeze, then it will
        # have been invoked directly. Otherwise, unicode_argv[0] is the Python
        # interpreter, so skip that.
        argv = argv[1:]

        # Also skip option arguments to the Python interpreter.
        while len(argv) > 0:
            arg = argv[0]
            if not arg.startswith(u"-") or arg == u"-":
                break
            argv = argv[1:]
            if arg == u'-m':
                # sys.argv[0] should really be the absolute path of the module source,
                # but never mind
                break
            if arg == u'-c':
                argv[0] = u'-c'
                break

    # if you like:
    sys.argv = argv 
```

最后，可以满足 ΤZΩΤZΙΟΥ 使用 DejaVu Sans Mono 的愿望，我同意这是一种出色的字体，用于控制台*。*

[您可以在“命令窗口中可用字体的必要条件”Microsoft KB](https://support.microsoft.com/en-us/kb/247815)中找到有关字体要求以及如何为 Windows 控制台添加新字体的信息

但基本上，在 Vista（可能还有 Win7）上：

*   下`HKEY_LOCAL_MACHINE_SOFTWARE\Microsoft\Windows NT\CurrentVersion\Console\TrueTypeFont`，设置`"0"`为`"DejaVu Sans Mono"`；
*   对于 下的每个子项`HKEY_CURRENT_USER\Console`，设置`"FaceName"`为`"DejaVu Sans Mono"`。

在 XP 上，检查线程[“更改命令提示符字体？” 在 LockerGnome 论坛](http://help.lockergnome.com/windows/Changing-Command-Prompt-fonts--ftopict551879.html)中。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-10-11T07:26:37.083

设置**PYTHONIOENCODING**系统变量：

```
> chcp 65001
> set PYTHONIOENCODING=utf-8
> python example.py
Encoding is utf-8 
```

来源`example.py`很简单：

```
import sys
print "Encoding is", sys.stdin.encoding 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-04-23T07:23:56.753

对我来说，在执行 python 程序之前设置这个环境变量：

```
set PYTHONIOENCODING=utf-8 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T18:21:09.367

你想让 Python 编码为 UTF-8 吗？

```
>>>print u'ëèæîð'.encode('utf-8')
Ã«Ã¨Ã¦Ã®Ã° 
```

Python 不会将 cp65001 识别为 UTF-8。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-09-16T11:42:40.763

我也遇到了这个烦人的问题，我讨厌无法在 MS Windows 中像在 linux 中一样运行我的 unicode-aware 脚本。所以，我设法想出了一个解决方法。

拿这个脚本（比如说，`uniconsole.py`在你的站点包或其他东西中）：

```
import sys, os

if sys.platform == "win32":
    class UniStream(object):
        __slots__= ("fileno", "softspace",)

        def __init__(self, fileobject):
            self.fileno = fileobject.fileno()
            self.softspace = False

        def write(self, text):
            os.write(self.fileno, text.encode("utf_8") if isinstance(text, unicode) else text)

    sys.stdout = UniStream(sys.stdout)
    sys.stderr = UniStream(sys.stderr) 
```

这似乎可以解决 python 错误（或 win32 unicode 控制台错误等）。然后我添加了所有相关的脚本：

```
try:
    import uniconsole
except ImportError:
    sys.exc_clear()  # could be just pass, of course
else:
    del uniconsole  # reduce pollution, not needed anymore 
```

最后，我只是根据需要在`chcp 65001`运行且字体为`Lucida Console`. （我多么希望`DejaVu Sans Mono`可以使用它……但是破解注册表并将其选择为控制台字体会恢复为位图字体。）

这是一个快速而肮脏的`stdout`替代`stderr`品，并且也不处理任何`raw_input`相关的错误（显然，因为它根本不涉及`sys.stdin`）。而且，顺便说一下，我在标准库的文件中添加了`cp65001`别名。`utf_8``encodings\aliases.py`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-12-08T07:03:16.790

对于未知编码：cp65001 问题，可以将新**变量**设置为 PYTHONIOENCODING 并将**值**设置为 UTF-8。（这对我有用）

查看这个：
[![查看这个](https://i.stack.imgur.com/BUbDC.png)](https://i.stack.imgur.com/BUbDC.png)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-18T18:12:57.013

这是因为 cmd 的“代码页”与系统的“mbcs”不同。尽管您更改了“代码页”，python（实际上是 windows）仍然认为您的“mbcs”没有改变。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-02-07T14:14:06.070

从 Python 3.8+ 开始，编码`cp65001`是`utf-8`

[https://docs.python.org/library/codecs.html#standard-encodings](https://docs.python.org/library/codecs.html#standard-encodings)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-01-22T15:42:11.960

该问题已在此线程中解决并解决：

[更改系统编码](https://stackoverflow.com/questions/51053464/fatal-python-error-py-initialize-cant-initialize-sys-standard-streams-lookupe)

解决方案是取消选择 Unicode UTF-8 以获得 Win 中的全球支持。这将需要重新启动，您的 Python 应该会恢复正常。

获胜步骤：

1.  转到控制面板
2.  选择时钟和区域
3.  单击区域 > 管理
4.  在非 Unicode 程序的语言中，点击“更改系统区域设置”</li>
5.  在弹出的“区域设置”窗口中，取消勾选“测试版：使用 Unicode UTF-8...”</li>
6.  根据 Win 提示重启机器

图片显示了如何解决问题的确切位置：

[如何解决问题](https://i.stack.imgur.com/50MXn.png)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-18T18:29:59.367

一些评论：你可能拼错了`encodig`and `.code`。这是我运行的示例。

```
C:\>chcp 65001
Active code page: 65001

C:\>\python25\python
...
>>> import sys
>>> sys.stdin.encoding
'cp65001'
>>> s=u'\u0065\u0066'
>>> s
u'ef'
>>> s.encode(sys.stdin.encoding)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
LookupError: unknown encoding: cp65001
>>> 
```

结论 -`cp65001`不是 python 的已知编码。尝试“UTF-16”或类似的东西。

# visual-c++ - Visual C++ 2008 中的结构成员对齐

> ID：878973
> 
> 赞同：3
> 
> 时间：2009-05-18T17:52:29.100
> 
> 标签：visual-c++, struct, memory-alignment

Visual C++ 让您在项目的属性页面中选择结构成员 alignemnt。问题是，这个配置被用于项目中的所有结构。

有没有办法（VC++ 特定的，我猜）单独设置某个结构的成员对齐？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T17:54:13.947

```
#pragma pack 
```

[http://msdn.microsoft.com/en-us/library/2e70t5y1(VS.80).aspx](http://msdn.microsoft.com/en-us/library/2e70t5y1(VS.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-18T17:54:42.557

[#pragma 包](http://msdn.microsoft.com/en-us/library/2e70t5y1(VS.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T17:58:35.390

对于真正特定的结构对齐，您可以摆弄填充字节

因此，在各个字段之间添加一些虚拟字节，直到对齐符合您的需要。

例子：

结构示例 { 无符号短 x；字节虚拟1；字节虚拟2；字节虚拟3；字节虚拟4；字节虚拟5；字节虚拟6；无符号整数 y；};

如果没有放置虚拟字节，则 int 可能已放置在偏移量 4 上（从结构开头开始的 4 个字节，而现在它已放置在偏移量 8 处）

waring：非常特定于编译器，并且代码实践不好；^）

# iphone - 关于 CLLocation Manager 和 Multiple ViewControllers 的一些架构问题

> ID：878983
> 
> 赞同：2
> 
> 时间：2009-05-18T17:53:44.727
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch

首先，对不起，如果这个问题很愚蠢，但我是 ObjC 的新手。在我的 iPhone 应用程序中，我的唯一 ViewController 中有一个 CLLocationManager 实现，因为我只有一个 View。不，我希望在我的应用程序中有更多视图，并且每个视图都需要来自 CLLocationmanager 的位置信息。

所以，我认为我必须将实现从 ViewController 移动到我的 AppController 中，因为我不想在每个 ViewController 中实现 CLLocationManager，对吗？

但是现在，我真的不知道 ViewCrollers 将如何获取位置信息？我想实现一个单例类，在其中存储信息，每个 VieController 都可以从那里获取信息。但为此我必须在 ViewControllers 中实现一个计时器或类似的东西，以便他们每秒检查一次是否有新数据可用。那声音不是很好，很糟糕。

ViewControllers如何自动获取新的Position信息？也许我需要像观察者这样的东西，但也许 Cocoa/ObjC 中已经准备好了一些东西？我认为我的申请方向错误。

非常感谢您的帮助

twickl

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-18T20:26:57.710

这是我脑海中浮现的一个建议，可能对作为起点有用。您认为您不想重复代码来设置与每个 ViewController 中的 CLLocationManager 的连接是正确的。但是，我不会将该代码移到您的 AppController 中（我假设您的意思是 AppDelegate）。

我会创建一个通用的 ViewController 子类并将其称为 LocationAwareViewController。LocationAwareViewController 将负责创建与 CLLocationManager 的连接并“注册”以获取更新。

我会将 LocationAwareViewController 设置为 CLCLocationManager 的代表。然后 LocationAwareViewController 将实现部分或全部 CLLocationManagerDelegate 方法。现在，只要有新的位置信息可用，这个 ViewController 就会收到更新。您不必设置任何轮询计时器。

然后，您的每个特定 ViewController 都将成为 LocationAwareViewController 的子类。他们还可以覆盖 CLLocationManagerDelegate 方法来为他们负责的视图执行特定的操作。

一项免责声明：我还没有机会使用 Core Location，所以我对 CLLocationManager 如何仅在文档上工作的期望是基于我的期望。它看起来很简单，但也许其他人可以根据他们的经验提供更多信息。

# asp.net - Elmah - ASP.NET -> 多个连接字符串 -> 在代码中设置 SQL 错误日志连接字符串

> ID：878987
> 
> 赞同：3
> 
> 时间：2009-05-18T17:54:33.837
> 
> 标签：asp.net, connection-string, elmah

我希望将[ELMAH](http://code.google.com/p/elmah/)集成到现有的 ASP.NET 应用程序中，以进一步支持错误调查，并可以使用连接字符串的一些帮助。我们为部署应用程序的所有环境或我们的环境使用单个 web.config 文件，并且在运行时，应用程序通常根据 URL 决定它所在的环境。

这就是我们想要的标准块...

```
 <connectionStrings>
    <add name="TESTAppDB" connectionString="Data Source=SQL-T-APPNAME.COMPANY.COM;Initial Catalog=APPNAME;User ID=USER;Password=THEPASS" providerName="System.Data.SqlClient"/>
    <add name="CERTAppDB" connectionString="Data Source=SQL-C-APPNAME.COMPANY.COM;Initial Catalog=APPNAME;User ID=USER;Password=THEPASS" providerName="System.Data.SqlClient"/>
    <add name="PRODAppDB" connectionString="Data Source=SQL-P-APPNAME.COMPANY.COM;Initial Catalog=APPNAME;User ID=USER;Password=THEPASS" providerName="System.Data.SqlClient"/>
  </connectionStrings> 
```

使用 Elmah，您似乎只需要指定连接字符串的名称，但是如何在运行时动态地执行此操作？例如，如果我正在测试，那么我想要这个：

```
<elmah>
     <errorLog type="Elmah.SqlErrorLog, Elmah" connectionStringName="TESTAppDB"/>
</elmah> 
```

但如果我在 PROD：

```
<elmah>
     <errorLog type="Elmah.SqlErrorLog, Elmah" connectionStringName="PRODAppDB"/>
</elmah> 
```

**编辑**
Web 应用程序的部署实践远远超出了我想要做的范围。我需要一个代码解决方案，允许我更改 ELMAH Sql 错误日志的数据源...

我无法改变我们今天部署 Web 应用程序的方式。这意味着，无论 TEST 是什么，都会转移到 CERT。CERT 中的内容移至 PROD。Web 应用程序必须能够确定它所在的环境并运行...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-18T18:17:26.053

我为此使用了一个 Web 部署项目。您可以为每个配置指定一个包含连接字符串的文件（默认为调试和发布）。这样，所有部署的所有配置文件都具有相同的文件，并且您的 web.config 会针对每个部署进行适当的更新。

Scott Gu 在这里有很好的信息：[http ://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx](http://weblogs.asp.net/scottgu/archive/2005/11/06/429723.aspx)

它适用于以前的版本，但信息仍然适用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T18:42:54.753

由于 Elmah 是开源的，因此很容易添加您自己的 :-)

您需要做的就是向`SqlErrorLog`包含您要使用的连接字符串的类添加一个新的静态属性，然后您将更新该`SqlErrorLog.ConnectionString`属性以返回您的自定义连接字符串（如果它有一个值）。

尝试在类中添加这样的内容（警告 - 未经测试的代码）：

```
public static string CustomConnectionString { get; set; }

public virtual string ConnectionString
{
  get 
  { 
    if (string.IsNullOrEmpty(CustomConnectionString)) 
    {
      return _connectionString;
    }
    else
    {
      return CustomConnectionString; 
    }
  }
} 
```

这应该足够了。现在您所要做的就是找到您选择连接字符串的位置并更新它以设置`SqlErrorLog.CustomConnectionString`属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-18T18:07:48.943

我会使用一个连接字符串名称“AppDB”，但实际上将连接字符串托管在一个外部（web.config 文件之外）配置文件中，这在每个环境中都不同。

在您的 web.config 中：

```
<connectionStrings configSource="config\connectionStrings.config"/> 
```

然后，在 connectionStrings.config 文件中：

```
<connectionStrings>    
    <add name="AppDB" connectionString="Data Source=SQL-T-APPNAME.COMPANY.COM;Initial Catalog=APPNAME;User ID=USER;Password=THEPASS" providerName="System.Data.SqlClient"/>
</connectionStrings> 
```

然后根据connectionStrings.config文件所在的环境，修改connectionString。在代码中，只需参考“AppDB”即可。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-24T21:05:45.310

为了建立 Rune Grimstad 的答案，除了他的更改，添加：

```
if (connectionString.Length == 0)
    connectionString = CustomConnectionString; 
```

后：

```
string connectionString = ConnectionStringHelper.GetConnectionString(config); 
```

在 SqlErrorLog(IDictionary config) 构造函数中。

然后我做了 RSolberg 所做的事情，但是在 application_start 中，而不是在 session 中：

Elmah.SqlErrorLog.CustomConnectionString = "你的 CS";

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-11-23T13:50:39.100

我们可以在这种情况下使用数据库上下文吗？

我在 MVC 3 中有一个 webapp，我使用数据库上下文连接到数据库（根据上面的示例）：

```
using (var ctx = new TESTAppDB())
{
    var res = (from p in ctx.Customer select p).FirstOrDefault();
} 
```

其中 TESTAppDB：

```
public class TESTAppDB: DbContext
{
    public DbSet<Customer> Customer{ get; set; }
} 
```

如果我想连接到另一个数据库，所以我写：

```
using (var ctx = new CERTAppDB())
{
    var res = (from p in ctx.Order select p).FirstOrDefault();
} 
```

好像是对的……

# c# - Unity 中有 TryResolve 吗？

> ID：878994
> 
> 赞同：16
> 
> 时间：2009-05-18T17:55:53.053
> 
> 标签：c#, unity-container, ioc-container

`ResolutionFailedException`如果失败，我怎样才能让 Unity 不抛出`Resolve`？

有没有类似的东西`TryResolve<IMyInterface>`？

```
var container = new UnityContainer();
var foo = container.TryResolve<IFoo>();
Assert.IsNull(foo); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2010-08-25T16:23:10.170

另请注意，如果您使用的是[Unity 2.0](http://msdn.microsoft.com/en-us/library/ee651008%28v=PandP.20%29.aspx)，您可以使用新的[IsRegistered()](http://msdn.microsoft.com/en-us/library/ff661604%28PandP.20%29.aspx)方法，它也是[通用版本](http://msdn.microsoft.com/en-us/library/ff661003%28v=PandP.20%29.aspx)。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-23T15:53:21.363

这是codeplex网站上的一个问题，你可以在这里找到代码（看看那个线程的底部，他们已经做了一个扩展方法......非常方便）

[http://unity.codeplex.com/Thread/View.aspx?ThreadId=24543](http://unity.codeplex.com/Thread/View.aspx?ThreadId=24543)

你可以使用这样的代码：

```
if (container.CanResolve<T>() == true)
{
    try
    {
        return container.Resolve<T>();
    }
    catch (Exception e)
    {
        // do something else
    }
} 
```

`CanResolve`是那种扩展方法。我实际上是在创建容器时注册该扩展......像这样：

```
private void CreateContainer()
{
    ExeConfigurationFileMap map = new ExeConfigurationFileMap();

    map.ExeConfigFilename = // path to config file

    // get section from config code goes here

    IUnityContainer container = new UnityContainer();
    container.AddNewExtension<UnityExtensionWithTypeTracking>();
    section.Containers.Default.Configure(container);        
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-18T18:14:21.240

它似乎缺少此功能。[本文](http://msdn.microsoft.com/en-us/library/cc707875.aspx)展示了在 try/catch 块中包含 Resolve 方法来实现它的示例。

```
public object TryResolve(Type type)
{
    object resolved;

    try
    {
        resolved = Resolve(type);
    }
    catch
    {
        resolved = null;
    }

    return resolved;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-18T19:25:55.447

这在当前版本中不可用。但是，您始终可以使用 C# 3 中的扩展方法“自行开发”。一旦 Unity 支持这一点，您就可以省略或更新扩展方法。

```
public static class UnityExtensions
{
    public static T TryResolve<T>( this UnityContainer container )
        where T : class
    {
        try
        {
            return (T)container.Resolve( typeof( T ) );
        }
        catch( Exception )
        {
            return null;
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-02T11:51:43.983

在 Prism Unity 5 中，他们提出了**TryResolve**函数，该函数已包含在命名空间**Microsoft.Practices.Prism.UnityExtensions**中。

请通过此链接[https://msdn.microsoft.com/en-us/library/gg419013(v=pandp.50).aspx](https://msdn.microsoft.com/en-us/library/gg419013(v=pandp.50).aspx)进行参考。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-06T14:14:12.330

```
IComponent component= null;

if (c.IsRegistered<IComponent>(registrationName))
{
  component= c.Resolve<IComponent>(registrationName);
}

return component; 
```

# objective-c - 为什么我不能 @synthesize 类别中的访问器？

> ID：878995
> 
> 赞同：7
> 
> 时间：2009-05-18T17:56:10.853
> 
> 标签：objective-c

Obj-C 2.0 允许我在类别中声明属性，但编译器拒绝在类别内合成访问器。为什么？

（有时将一堆相关的东西放在一个类别中是有意义的——即使支持 iVar 进入类声明。我知道类扩展和如何做私有属性，但这不是我的用例。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-18T21:26:35.670

问题是类别在逻辑上与其类是分开的，甚至单独存储在二进制文件中。内部实现是一个类描述结构包含一个方法列表数组，该数组最初只包含在主`@implementation`块中定义的方法列表。当 ObjC 链接器模块加载新类别时，它们的方法列表被添加到该数组中。

由于这种实现，类别本身无法访问类的存储，因此无法修改它（这也引发了当类别被卸载时该做什么的问题）。

最后，从更合乎逻辑而非技术的角度来看，这个想法是一个类别对一个类的内存结构没有任何“所有权”，它只是关联了一些新方法。为了完全支持属性合成，它需要以某种方式修改类的存储

解决方案？您可以将@synthesize 语句放在主@implementation 块中，或者直接在@implementation 类别中实现您自己的访问器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T19:05:59.420

那里提出的问题涵盖了私有访问器问题。这种方法来自非私有访问者 POV。

# apache-flex - Flex ItemRenderer 防止在文本输入之间使用制表符

> ID：878999
> 
> 赞同：7
> 
> 时间：2009-05-18T17:56:58.527
> 
> 标签：apache-flex, flex3, usability, itemrenderer

我有一个自定义**ItemRenderer**，它在 3 个面板中的每个面板中显示 5 个文本输入：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:VBox 
    xmlns:mx="http://www.adobe.com/2006/mxml"
    height="300"
    width="800"
    creationComplete="onCreationComplete()"
>
    <!-- code-behind -->
    <mx:Script source="ChainListRenderer.mxml.as" />

    <mx:Label text="{data.title}" fontSize="25" fontWeight="bold" width="100%" textAlign="center" />
    <mx:HBox>
        <mx:Panel id="triggerPanel" title="Trigger" width="260">
            <mx:VBox id="tpBoxes" width="100%" paddingBottom="5" paddingLeft="5" paddingRight="5" paddingTop="5">
                <mx:TextInput id="trigger1" width="100%" textAlign="left" tabIndex="0" tabEnabled="true" />
                <mx:TextInput id="trigger2" width="100%" textAlign="left" tabIndex="1" tabEnabled="true" />
                <mx:TextInput id="trigger3" width="100%" textAlign="left" tabIndex="2" tabEnabled="true" />
                <mx:TextInput id="trigger4" width="100%" textAlign="left" tabIndex="3" tabEnabled="true" />
                <mx:TextInput id="trigger5" width="100%" textAlign="left" tabIndex="4" tabEnabled="true" />
            </mx:VBox>
        </mx:Panel>
        <mx:Panel id="linkPanel" title="Link" width="260">
            <mx:VBox id="lpBoxes" width="100%" paddingBottom="5" paddingLeft="5" paddingRight="5" paddingTop="5">
                <mx:TextInput id="link1" width="100%" textAlign="left" tabIndex="5" tabEnabled="true" />
                <mx:TextInput id="link2" width="100%" textAlign="left" tabIndex="6" tabEnabled="true" />
                <mx:TextInput id="link3" width="100%" textAlign="left" tabIndex="7" tabEnabled="true" />
                <mx:TextInput id="link4" width="100%" textAlign="left" tabIndex="8" tabEnabled="true" />
                <mx:TextInput id="link5" width="100%" textAlign="left" tabIndex="9" tabEnabled="true" />
            </mx:VBox>
        </mx:Panel>
        <mx:Panel id="answerPanel" title="Answer" width="260">
            <mx:VBox id="apBoxes" width="100%" paddingBottom="5" paddingLeft="5" paddingRight="5" paddingTop="5">
                <mx:TextInput id="answer1" width="100%" textAlign="left" tabIndex="10" tabEnabled="true" />
                <mx:TextInput id="answer2" width="100%" textAlign="left" tabIndex="11" tabEnabled="true" />
                <mx:TextInput id="answer3" width="100%" textAlign="left" tabIndex="12" tabEnabled="true" />
                <mx:TextInput id="answer4" width="100%" textAlign="left" tabIndex="13" tabEnabled="true" />
                <mx:TextInput id="answer5" width="100%" textAlign="left" tabIndex="14" tabEnabled="true" />
            </mx:VBox>
        </mx:Panel>
    </mx:HBox>
</mx:VBox> 
```

不幸的是，当用作 ItemRenderer 时，文本输入之间的制表符不起作用，即使使用上面的 tabIndex 值也是如此。如果我将此代码复制到它自己的 MXML 应用程序中，则文本输入之间的制表符按预期工作。

有谁知道如何在这种情况下恢复制表符？如果我不得不在没有这么简单的可用性元素的情况下发布这个应用程序，那将是一种耻辱。

我想我可能需要实施`mx.managers.IFocusManagerComponent`，但我找不到任何关于如何做到这一点的例子，而且[FocusManager 文档](http://livedocs.adobe.com/flex/3/langref/mx/managers/FocusManager.html)也没有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-09-03T00:04:14.627

我将 mx:VBox 用作我的数据网格的 rendererIsEditor="true" 的自定义 itemRenderer，并且我也遇到了选项卡顺序问题。

我发现 itemRenderer 需要实现 IFocusManagerComponent 才能使主应用程序的 FocusManager() 能够正确地对其进行制表符。我尝试实现该接口：

```
<?xml version="1.0"?>
<mx:VBox implements="mx.managers.IFocusManagerComponent" ...>
 [the rest of my itemRenderer code]
</mx:VBox> 
```

...结果证明做起来相当复杂...很多接口函数要实现。

但是，就我而言，我很幸运；我的 itemRenderer 中只有一个 TextInput 元素（其余的都是自定义代码、验证器和格式化程序），所以我将 itemRenderer 从 mx:VBox 转换为 mx:TextInput（它已经实现了 IFocusManagerComponent）：

```
<?xml version="1.0"?>
<mx:TextInput ...>
 [the rest of my itemRenderer code]
</mx:TextInput> 
```

瞧！我的标签顺序问题已修复。

我想对于那些拥有更复杂 itemRenderers 的人的结论是，你需要在你的类中完全实现 IFocusManagerComponent 接口......这可能很好，因为它看起来会告诉 flex 如何通过你的 itemRenderer 自定义选项卡字段。或者，也许您可​​以将顶级标签更改为已经实现接口的东西，例如：您可以将 mx:VBox 嵌套在类似的东西中：

```
<mx:Container focusIn="FocusManager.setFocus(trigger1)"> 
```

......也许它可以工作？代码比我更复杂的人应该尝试一下，看看会发生什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-03-11T12:34:25.423

我在“ListBase 派生”组件中使用的 itemRender 遇到了同样的问题。我发现所有“ListBase 派生”组件都将所有项目渲染器包装在 ListBaseContentHolder 中。

从 ListBase 来源：

```
/**
 *  An internal display object that parents all of the item renderers,
 *  selection and highlighting indicators and other supporting graphics.
 *  This is roughly equivalent to the <code>contentPane</code> in the 
 *  Container class, and is used for managing scrolling.
 */
protected var listContent:ListBaseContentHolder; 
```

此类的*tabChildren*和*tabEnabled属性默认设置为 false。*我能找到的唯一解决方法是创建一个从 List 派生的 MyList 组件，并以这种方式覆盖 createChildren 方法（在其中初始化 listContent）：

```
import flash.display.DisplayObject;
import mx.controls.List;

public class MyList extends List {
    override protected function createChildren():void {
            super.createChildren();
            this.listContent.tabChildren = this.tabChildren
            this.listContent.tabEnabled = this.tabEnabled
        }
    } 
```

然后使用“<MyList tabChildren="true"/>”而不是“<mx:List/>”组件让我恢复了ItemRender 中的选项卡功能。

希望能帮助到你，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-19T20:01:08.760

我想我可能正朝着正确的方向前进，但我还没有完全做到。

我有我的主应用程序，其中 Horizo​​ntalList 使用自定义 ItemRenderer：

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application 
    xmlns:mx="http://www.adobe.com/2006/mxml" 
    xmlns:com="ventures.view.component.*"
    layout="absolute"
    backgroundColor="#ffffff"
    preinitialize="onPreInitialize()"
    click="onClick(event)"
>
    <!-- code-behind -->
    <mx:Script source="ConsumptionChain.as" />

    <!-- show chain links -->
    <mx:HorizontalList
        id="ChainList"
        direction="horizontal"
        dataProvider="{chainData}"
        rollOverColor="#ffffff"
        selectionColor="#ffffff"
        horizontalScrollPolicy="off"
        left="20"
        right="20"
        top="20"
        height="300"
        minWidth="802"
        rowHeight="300"
        columnWidth="800"
        tabChildren="false"
        itemRenderer="ventures.view.ItemRenderer.ChainListRenderer"
    />

</mx:Application> 
```

我已更新原始问题中的代码示例以包含整个 ItemRenderer MXML（适用部分）；这是 ActionScript 代码隐藏：

```
/*
 * ChainListRenderer.mxml.as -- code-behind for ChainListRenderer.mxml
 */

import flash.events.Event;
import flash.events.KeyboardEvent;
import flash.ui.Keyboard;

//used to combine all textboxes in a single array to make looping through them with the TAB key easier
private var allBoxes:Array;

public function expandPanel(e:Event):void {
    trace(e.currentTarget);                
    var state : String = e.currentTarget.parent.parent.id;                
    if (state != this.currentState)
        this.currentState = state;
}

private function onCreationComplete():void{
    //this function will be run on each object via the map function
    function forEach(o:Object, index:int, ar:Array):void{
        o.addEventListener(FocusEvent.FOCUS_IN, expandPanel)
        o.addEventListener(MouseEvent.CLICK, stopBubble);           //don't propagate click events (which return to base state)
        o.addEventListener(KeyboardEvent.KEY_DOWN, customTabbing);  //fix tabbing between text fields
    }

    this.addEventListener(KeyboardEvent.KEY_DOWN, customTabbing);

    //loop over textboxes and add the focusIn event listener
    tpBoxes.getChildren().map(forEach);
    lpBoxes.getChildren().map(forEach);
    apBoxes.getChildren().map(forEach);

    //create an "allBoxes" array that is used by the customTabbing function
    allBoxes = tpBoxes.getChildren();
    function forEachTabbing(o:Object, index:int, ar:Array):void {
        allBoxes.splice(allBoxes.length, 0, o);
    }
    lpBoxes.getChildren().map(forEachTabbing);
    apBoxes.getChildren().map(forEachTabbing);
}

//this function is used to prevent event bubbling
private function stopBubble(e:Event):void {
    e.stopPropagation();
}

//this function re-implements tabbing between text fields, which is broken when inside an itemRenderer
public function customTabbing(e:KeyboardEvent):void {
    trace('keyCode: ' && e.keyCode.toString());
    if (e.keyCode == flash.ui.Keyboard.TAB){
        trace(focusManager.getFocus());
        //loop over array of all text-boxes
        for (var i:int = 0; i < allBoxes.length; i++){
            trace(i.toString());
            //if event (keypress) current target is the current TextInput from the array
            if (e.currentTarget == allBoxes[i]){
                //then focus the NEXT TextInput, and wrap if at last one
                allBoxes[((i+1) % allBoxes.length)].setFocus();
                //break out of the loop
                break;
            }
        }

        //prevent arrow keys from navigating the horizontal list
        e.stopPropagation();
    }
} 
```

本质上，我在这里尝试做的是通过检查每个文本字段的 key_down 事件上的 TAB 键来重新实现制表符，并使用它将焦点移动到下一个 TextInput（从最后一个 TextInput 包装到第一个 TextInput）。但这并没有达到预期的效果，并且焦点仍然跳到此 Horizo​​ntalList 之外的下一个控件。

有什么想法可以从这里开始吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T18:22:56.483

你为什么要做 tabChildren="false"？您不想标记 HorziontalList 的子项吗？因为 itemRenderer 是列表的子项....

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-08-24T13:04:06.297

这对于我使用的方法似乎是不可能的。我没有使用带有自定义项目渲染器的列表，而是切换到单项目视图组件和一个单独的列表来显示所有项目的摘要，这让我解决了我的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-12-27T01:30:33.910

我有同样的问题，通过尝试重新实现选项卡按钮的行为来解决它。成功的线索只是使用`event.preventdefault()`方法。使用的代码显示在前面。

```
private function initFocusMap():void {
    focusMap = {
        InNom:benefPersona.InApePat,
        InApePat:benefPersona.InApeMat,
        InApeMat:benefPersona.InFecNacimiento,
        InFecNacimiento:benefPersona.InRFC,
        InRFC:benefPersona.InCURP,
        InCURP:benefPersona.InIdSexo,
        InIdSexo:benefPersona.InIdParentesco,
        InIdParentesco:benefPersona.InPorc,
        InPorc:domBeneficiario.InCalle,
        InCalle:domBeneficiario.InNumExterior,
        InNumExterior:domBeneficiario.InNumInterior,
        InNumInterior:domBeneficiario.InCP,
        InCP:domBeneficiario.InColonia,
        InColonia:domBeneficiario.InIdPais,
        InIdPais:domBeneficiario.InIdEdo,
        InIdEdo:domBeneficiario.InIdCiudad,
        InIdCiudad:benefPersona.InNom                   
    }
}

private function kfcHandler(event:FocusEvent):void {
    var id:String = ""
    if (event.target is AperClsDateField || event.target is AperClsCombo) {
        id = event.target.id;
    } else {
        id = event.target.parent.id;
    }
    if (id != "InIdDelegacionMunic") {
        event.preventDefault();             
        focusManager.setFocus(focusMap[id]);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-28T18:05:52.613

这是使用 ComboBox itemEditor 的方式：

[http://blog.flexmonkeypatches.com/2008/02/18/simple-datagrid-combobox-as-item-editor-example/](http://blog.flexmonkeypatches.com/2008/02/18/simple-datagrid-combobox-as-item-editor-example/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-04-27T15:43:11.427

我在我的 AdvancedDataGrid 中选择一个 itemRenderer 时遇到了同样的问题（顺便说一句，我使用的是 Flex SDK 3.5），但是这篇文章非常有助于我制作标签友好的 itemRenderer，所以我想做也有贡献:)

要使其工作，您还需要更改网格和 gridColumn 上的一些属性。

我们先来谈谈grid和gridColumn。

众所周知，当您将网格的“可编辑”属性设置为“真”时，您可以在每个列单元格中使用标签（假设您没有将列的“可编辑”属性设置为“假”）。

**第 1 步**，将网格的“可编辑”属性设置为“真”

**步骤 #2**，使您的网格的列“可编辑”属性也设置为“真”和“rendererIsEditor”为“真”

将 dataField 设置为虚假字段很重要，因为由于我们将渲染器设置为编辑器，这意味着您在 itemRenderer 中更新的任何内容都将分配给 dataField，即您将 dataField 设置为具有 int 类型的“Foo”并且您没有- 填充组合框 itemRenderer 的原始对象。当您进行选择时，该对象将被分配给“Foo”

**步骤 #3**，使您的网格列“dataField”属性也设置为虚假字段。

现在让我们做一些让选项卡在 itemRenderer 上工作的事情

我知道这不是优化版本，但这将适用于第一次通过。

```
import mx.core.mx_internal;
import mx.managers.IFocusManagerComponent;
use namespace mx_internal;

public class FriendlyItemRendererContainer extends HBox implements IFocusManagerComponent
{

    public function FriendlyItemRendererContainer ()
    {
    super();
    addEventListener(FocusEvent.KEY_FOCUS_CHANGE, keyFocusChangeHandler);       
    }

    private var _listData:DataGridListData;
    //This is required to make it work as itemEditor
    public var text:String;

    private function keyFocusChangeHandler(event:FocusEvent):void
    {
            if (event.keyCode == Keyboard.TAB &&
                ! event.isDefaultPrevented() &&
                findNextChildToFocus(event.shiftKey))
            {

                event.preventDefault();

            }

    }

    private function findNextChildToFocus(shiftKey:Boolean):Boolean
    {
          var myChildrenAry:Array = getChildren();
      var incr:int = shiftKey ? -1 : 1;
      var index:int = shiftKey ? myChildrenAry.length : 0;
      var focusChildIndex:int = 0;
      var found:Boolean = false;

         for (focusChildIndex = 0; focusChildIndex < myChildrenAry.length; ++focusChildIndex)
     {
        if (!(myChildrenAry[focusChildIndex] as UIComponent).visible ||
            (myChildrenAry[focusChildIndex] is Container))
        {
            //If it's an invisible UIComponent or a container then just continue
            continue;
        }

            if (myChildrenAry[focusChildIndex] is TextInput)
        {
                    if (systemManager.stage.focus == (myChildrenAry[focusChildIndex] as TextInput).getTextField())
                    {
                        (myChildrenAry[focusChildIndex] as UIComponent).drawFocus(false);
                        found = true;
                        break;
                    }
        }
        else
        {
                    if (systemManager.stage.focus == myChildrenAry[focusChildIndex])
                    {
                        (myChildrenAry[focusChildIndex] as UIComponent).drawFocus(false);
                        found = true;
                        break;
                    }
       }
         }

         if (!found)
     {
        focusChildIndex = 0;
      }

      while (true)
      {
                focusChildIndex = focusChildIndex + incr;

                if ((focusChildIndex < 0) || (focusChildIndex >= myChildrenAry.length))
                {
                    UIComponentGlobals.nextFocusObject = null;
                    return false;
                }
                else
                if (myChildrenAry[focusChildIndex] is UIComponent)
                {
                (myChildrenAry[focusChildIndex] as UIComponent).setFocus();
                (myChildrenAry[focusChildIndex] as UIComponent).drawFocus(true);

                    break;
                }
        }

        return true;
    }

    override public function setFocus():void
    {
       var myChildrenAry:Array = getChildren();
       if (myChildrenAry.length > 0)
       {
        for (var i:int = 0; i < myChildrenAry.length; ++i)
        {
            if ((myChildrenAry[i] is UIComponent) && (myChildrenAry[i] as UIComponent).visible)
            {
               (myChildrenAry[i] as UIComponent).setFocus();
                   (myChildrenAry[i] as UIComponent).drawFocus(true);
               break;
            }
       }
    }

    }

    public function get listData():BaseListData
    {
            return _listData;
    }

    public function set listData(value:BaseListData):void
    {
            _listData = DataGridListData(value);
    }  
} 
```

有关如何在 itemRenderer 上使用它的示例：

```
<FriendlyItemRendererContainer xmlns:mx="http://www.adobe.com/2006/mxml">

<mx:TextInput/>
<mx:Button label="Boo"/>
<mx:RadioButton/>
<<mx:TextInput/>
<mx:Button label="Baa"/>

</FriendlyItemRendererContainer> 
```

然后把它放在 gridColumn 中就可以了。

享受。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-11-15T14:45:23.750

基本上你想删除焦点更改事件的默认行为。我认为你需要这样做：

```
1\. yourRenderer.addEventListener(FocusEvent.KEY_FOCUS_CHANGE, onKeyFocusChange);
2\. since you want to stop tab key, in the handler, do this: 
        if (event.keyCode == Keyboard.TAB)
            event.preventDefault()
3\. in your keyDown handler, catch TAB, then you can manually move your focus. 
```************************