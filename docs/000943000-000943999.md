# StackOverflow 问答 000943000-000943999

# python - 基于 Flash 的文件上传 (swfupload) 使用 Apache/mod-wsgi 失败

> ID：943000
> 
> 赞同：0
> 
> 时间：2009-06-03T04:05:37.697
> 
> 标签：python, flash, apache, file-upload, mod-wsgi

**此问题已重新命名/重新标记，以便其他人可以更轻松地找到此问题的解决方案。**

* * *

我正在尝试将项目从 Django 开发服务器迁移到 Apache/mod-wsgi 环境。如果你昨天问我，我会说过渡非常顺利。我的网站已启动、可访问、快速等。但是，该网站的一部分依赖于文件上传，因此我遇到了最奇怪和最令人抓狂的问题。有问题的特定页面使用[swfupload](http://swfupload.org/)将文件和关联的元数据发布到捕获文件并启动一些服务器端处理的 url。这在开发服务器上工作得很好，但是每当我在 Apache 上发布到这个 url 时，Django 请求对象就会变成空的——**没有 GET、POST 或 FILES 数据**。

通过使用 Wireshark 进行侦听，我消除了客户端问题。据我所知，根本原因源于某种 Apache 配置问题，可能与我试图访问的临时文件目录有关。我是 Apache 配置的相对新手，并且已经为此努力了好几个小时。

我的 Apache 配置：

```
<VirtualHost *:80>
ServerAdmin user@sitename.com
ServerName  sitename.com
ServerAlias www.sitename.com
LogLevel warn
WSGIDaemonProcess sitename processes=2 maximum-requests=500 threads=1
WSGIProcessGroup sitename
WSGIScriptAlias / /home/user/src/sitename/apache/django.wsgi
Alias /static /home/user/src/sitename/static
Alias /media /usr/share/python-support/python-django/django/contrib/admin/media
</VirtualHost> 
```

我的直觉是，这可能与我在 Django settings.py ( `'/home/sk/src/sitename/uploads/'`) 中指定的文件上传目录的权限有关，但是我的 Apache 错误日志并没有提出任何类似的建议，即使日志级别被提升最多调试。

关于我应该如何进行调试的建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T04:54:55.453

通常 apache 作为用户“www-data”运行；如果它没有读/写访问权限，您可能会遇到问题。但是，您的设置似乎没有使用 apache 来访问“/home/sk/src/sitename/uploads”；我对此配置文件的理解是，除非它命中 /static 或 /media，否则 apache 会将其交给 WGSI，因此最好检查这些权限和日志，而不是 apache 的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T07:18:33.877

另一种可能性是 mod_wsgi 的“旧”版本中的一个错误（我疯狂地寻找并修复它）。[此错误报告](http://code.google.com/p/modwsgi/issues/detail?id=121)中的更多信息。由于[以下提示](http://the-stickman.com/web-development/php-and-curl-disabling-100-continue-header/)（也适用于 CLI，使用 -H 开关），我修复了它（用于 curl 上传）。

# web - 关于用户反社会行为，我应该知道什么？

> ID：943002
> 
> 赞同：1
> 
> 时间：2009-06-03T04:06:14.407
> 
> 标签：web

受此帖子[https://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site](https://stackoverflow.com/questions/72394/what-should-a-developer-know-before-building-a-public-web-site)的启发，我想知道：

关于用户反社会行为，我应该知道什么？我知道有些用户会尝试该帖子中提到的所有内容。其他用户会向其他人发送垃圾邮件，写帖子来拖钓其他人。我应该担心哪些事情，以便我可以设计一种方法来恢复这些操作？

我计划建立的网站是一个用户内容网站——例如 YouTube、Wikipedia 和 SO :)。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T04:44:08.683

禁止人永远不会奏效。让冒犯者的帖子对除冒犯者之外的所有人都不可见要容易得多。巨魔消耗了大量的能量试图让人们崛起，而这一切都是徒劳的，因为我们其他人完全看不到他们的辛勤工作。我发现这种让关注的人挨饿的技术比直接禁止人们成功几个数量级。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T04:25:29.600

1.  如果有任何形式的声誉计划，您应该假设用户会尽一切努力以您做梦也想不到的无数方式来玩弄系统。确保您尽可能多地进行日志记录和监控，以便您可以检测到任性的活动并在事后纠正 - 然后确保它不会再次发生，并知道如果修复没有，您的日志记录和监控将再次发现它发生工作不够好。重复*恶心*。

2.  如果您有登录名和密码，请在密码中允许尽可能多的字符——无论是长度还是字符库。只要确保您不会被愚弄执行密码中的任何内容。类似的规则可能适用于登录；更有可能的是，您最好使用电子邮件地址（相对容易验证）或 OpenID 之类的东西。

3.  他们说的...

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T04:28:22.953

我了解到在与讨厌的用户打交道时有帮助的一件事是不要通过个人帐户与他们打交道。

如果您在与巨魔打交道时将自己的名字写在帖子或其他东西上，那么您就会对自己进行人身攻击，尤其是在任何有争议的情况下。以员工或管理员的身份接近他们比你自己的名字要好得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T04:35:30.033

如果您有足够的时间可以浪费，有一种方法可以在互联网上发布几乎所有内容。任何限制反社会行为的尝试都需要通过限制其他用户的方式来平衡。你不想吓跑你的好用户。由于网络上的任何社区网站都通过吸引人们而获得成功，因此请确保您对人们如何响应您在系统上所做的更改保持敏感。

我认为需要很大的耐心。对于某人的行为，我也会对“从臀部开火”持谨慎态度。你不想让人们激怒你自己表现出反社会行为。

# html - 编号行代码示例？

> ID：943006
> 
> 赞同：2
> 
> 时间：2009-06-03T04:07:25.640
> 
> 标签：html

如何在代码示例中添加编号行，并提供打印和查看纯文本选项，如以下链接中的代码示例：

[http://www.sitepoint.com/blogs/2009/06/02/css-sizing-absolute-position/](http://www.sitepoint.com/blogs/2009/06/02/css-sizing-absolute-position/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T04:09:11.160

您应该查看[SyntaxHighlighter](http://alexgorbatchev.com/wiki/SyntaxHighlighter)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:10:47.510

您作为示例提供的站点点文章使用 javascript 创建表，然后使用 css 设置它们的样式。

恕我直言，这是一个糟糕的选择。它将非表格信息放入表格中。

你可以通过使用 div 和 spans 来完成同样的事情

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T20:21:40.080

就个人而言，我希望您**不**添加行号。它们通常不会添加任何有用的东西，并且会使复制和粘贴代码变得更加困难。

如果您要发布一个非常长的片段并在文本中引用行号，最好将其分成块。

无论如何要考虑一些事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T04:19:09.880

我查看了您链接到的网站的来源。他们使用 Wordpress 作为他们的博客软件。有一个 Wordpress 插件可以让你做到这一点。我在*Dreaming In JavaScript*中使用它。看起来他们正在使用与我相同的一个。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T04:40:30.217

如果您想简单地将行号应用于代码，您可以推出一个简单的脚本，例如：

```
#!/usr/bin/perl

use strict;
use warnings;

my $file = $ARGV[0];
unless ( -f $file ) {
    print "File name has to be provided.\n";
    exit;
}

open my $fh, '+<', $file or die $!;
my @lines = <$fh>;
seek $fh, 0, 0;

my $line_number = 0;
for (@lines) {
    print $fh $line_number++, ": ", $_;
} 
```

只需将文件作为第一个参数传递行号。始终保留原始文件的备份。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-03T09:16:59.593

您可能想使用[google-code-prettify](http://code.google.com/p/google-code-prettify/)。我认为 Stack Overflow 也使用它来突出显示代码。它可以配置为显示行号。

# c# - C# 2008 - NotifyIcon - BaloonTip

> ID：943016
> 
> 赞同：1
> 
> 时间：2009-06-03T04:10:04.577
> 
> 标签：c#, tooltip, notifyicon

我正在使用以下代码：

```
notify.ShowBalloonTip(
    15000, 
    "Reminder!", 
    myText,
    System.Windows.Forms.ToolTipIcon.None); 
```

但问题是气球几乎总是在活动窗口后面隐藏一层。显然，当您的活动窗口最大化并一直向下到任务栏时，这不会很好地工作，因为提示气球在它后面。有谁知道为什么会发生这种情况？我正在使用 Win XP Pro SP3。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T04:54:50.620

您可能会遇到一个已知的（烦人且随机的）Windows 错误： http: [//www.howtogeek.com/howto/windows/how-to-fix-system-tray-tooltips-not-displaying-in-windows-xp /](http://www.howtogeek.com/howto/windows/how-to-fix-system-tray-tooltips-not-displaying-in-windows-xp/)

# django - 带有自定义包含标签的 Django 模型继承

> ID：943020
> 
> 赞同：5
> 
> 时间：2009-06-03T04:13:23.923
> 
> 标签：django, inheritance, django-models, django-templates

我将尝试尽可能简化这一点。可以说我有以下内容：

# 模型.py

```
class Person(models.Model):
    name = models.CharField(max_length=255)

    def getRealPerson(self):
        # is there a better way to do this?
        ret = None
        try:
            ret = self.worker
        except:
            try:
                ret = self.retired
            except:
                ret = self
        return ret
class Worker(Person):
    salary = models.IntegerField(default=0)

class Retired(Person):
    age = models.IntegerField() 
```

这个例子对我想要什么并不重要，跟我一起去吧。这样做的目的是让我可以拥有一个主 Person 表来引用所有人。

理想情况下，我希望能够调用 Person 的视图，并为每个类类型以自定义方式列出每个特定的详细信息。我想使用自定义的包含标签来执行此操作。

# 人.html

```
{% load people_extras %}
{% for person in people %}
   {% show_person person %}
{% endfor %} 
```

# people_extras.py - 模板标签

```
from django import template

@register.inclusion_tag('worker.html')
def show_worker(person):
    return {'person':person}

@register.inclusion_tag('worker.html')
def show_retired(person):
    return {'person':person}

#How do I write this function and use it as the show_person person tag?
from project.app.models import Worker, Retired
def show_person(person):
    person = person.getRealPerson():
    if isinstance(person, Worker):
        return show_worker # yes, this doesn't work. 
```

我不知道如何让它根据人员类型调用正确的模板。

我不知道如何使用 {% ifequal %} 使用模板来完成此操作，如下所示：

```
{% ifequal person.getRealPerson.__class__.__name__ "Worker" %}
    {% show_worker %}
... 
```

我用模板标签走了我上面写的路线。但是，我不知道在哪里放置逻辑来确定人的类型！

我想最终我希望能够在 Person 对象上使用通用视图。

如果有更好的方法可以做到这一点，我愿意接受建议，我只想让它发挥作用。

我已经在这里卡了一天多……真的可以用一推。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T16:36:46.387

请参阅[此答案](https://stackoverflow.com/questions/929029/how-do-i-access-the-child-classes-of-an-object-in-django-without-knowing-the-name/929982#929982)以获取在对 Person 表进行查询后获取正确人员类型子对象的有效方法。

一旦你完成了这项工作，你应该能够通过使用多态性来消除模板标签中的大部分复杂性。如果您想使用不同的模板显示每个人类型，请将该模板名称作为模型的类属性，或者甚至只是根据模型名称创建模板名称（使用 person._meta.module_name）。一个简单的模板标签应该能够覆盖所有情况，甚至不知道存在哪些子类的任何细节。 **编辑**这个单一标签不能使用inclusion_tag 装饰器注册，因为您需要动态确定模板名称。但是使用 simple_tag 装饰器很容易编写：

```
@register.simple_tag
def show_person(person):
    t = template.loader.select_template(["%s.html" % person._meta.module_name,
                                         "person.html")
    return t.render({'person': person}) 
```

这将使用worker.html 渲染一个Worker，使用retired.html 渲染一个Retired，等等。如果找不到子类型的特定模板，它将回退到默认的person.html。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T08:46:30.580

利用 Django 的[contenttypes 框架](http://docs.djangoproject.com/en/dev/ref/contrib/contenttypes/)来识别您的模型类型。

请参阅此片段：[儿童感知模型继承](http://www.djangosnippets.org/snippets/1187/)并在评论中使用[Carl Meyer 的](https://stackoverflow.com/users/3207/carl-meyer)建议（将作业包装在“ `if not self.id:`”中）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T09:04:37.923

我使用一种我现在快速组合起来的方法来完成一项非常相似的工作。我有许多模型继承自一个主要的“基本”模型——我可以通过一个唯一的代码（我们称之为“go code”）访问我数据库中的所有内容。为了找出父对象的子对象，我做了这样的事情：

```
def get_child_types(self):
    return [ c.__name__.lower() for c in self.__subclasses__() ]

def get_child(self):
    for type in self.get_child_types():
        try:
            o = self.__getattribute__(type)
        except:
            pass
        else:
            return o 
```

我知道这很混乱，但它工作正常。我将对象的“类型”存储在父对象模型的非规范化字段中，所以我只需要“找到”一次——这减少了对数据库的访问和所需的 CPU 工作。然后，我只需覆盖 save() 以在创建时查找对象类型，并将其存储在该字段中。

希望能帮助到你！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T09:58:14.150

将此代码段用于您的 getRealPerson() Person 模型方法：

```
def getRealPerson(self):
    from django.db.models.fields.related import OneToOneRel
    from django.core.exceptions import ObjectDoesNotExist
    for related in self._meta.get_all_related_objects():
        rel_opts_name = related.get_accessor_name()
        if isinstance(related.field.rel, OneToOneRel):
            try:
                sub_obj = getattr(self, rel_opts_name)
            except ObjectDoesNotExist:
                pass
            else:
                return sub_obj 
```

它将返回第一个相关对象（Worker 或 Retired）。

# mysql - mysqldump 或 mysqlhotcopy 备份大型 MySQL 数据库？

> ID：943028
> 
> 赞同：2
> 
> 时间：2009-06-03T04:18:00.020
> 
> 标签：mysql, backup, mysqldump

我有一些 NAS 存储可以通过我的专用托管服务提供商进行备份。我使用 WHM 设置自动每日备份来备份数据库和帐户。服务器托管一个站点。当它进行备份时，它会进行 mysql 转储，并且在进行备份的整个过程中基本上都会关闭站点，因为在转储发生时没有人可以连接到数据库。该站点通常会关闭大约 30 秒到一分钟（这可能看起来不多，但对于这种站点来说，这是一个真正的问题）。

有没有更好的备份方法来避免这种情况发生（mysqlhotcopy 或 Maatkit 会更好吗？），无论是备份到 NAS 的不同方法，还是根本不使用 NAS 并使用其他方法.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T04:24:56.387

mysqlhotcopy 比 mysqldump 快，但不做 InnoDB。

要进行备份，我使用复制并在从属设备上进行转储。在备份过程中，您的停机时间为 0，并且没有负载峰值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-15T12:44:55.890

对于 InnoDB，没有复制的最佳解决方案似乎是：

```
mysqldump mydbname --result-file=mydbname.sql --verbose --single-transaction 
```

它使用 InnoDB 的事务快照功能，并允许正常（写入！）数据库操作而不会中断。用`--master-data=1`你甚至应该能够自动记录快照的二进制日志位置。但是，在同一台服务器上的多个数据库上单独执行此操作时，二进制日志位置似乎毫无价值。

一个缺点是当你有一些 MyISAM 表时，这不能正常工作。我自己使用 MySQL 的全文索引，它需要未分区的 MyISAM 表。但是，可以这样安排，MyISAM 表只是辅助数据集，将 InnoDB 表中已经存在的文本转储到其中，以便在需要时可以从头开始重建 MyISAM 表。我有一个脚本可以检查数据库的表类型并使用`--single-transaction`，而不是`--lock-tables`在一个数据库中只有 InnoDB 表时使用。

另一种解决方案是使用一些磁盘或文件系统快照功能，例如 LVM。但是，由于 LVM 极其愚蠢的写时备份机制（这被错误地声称是 COW，这不是常识），当存在快照时写入时，这将是一个相当大的性能损失。因此，一个非常好的解决方案似乎是 Solaris ZFS 或 FreeBSD UFS 上的 MySQL。两者都支持高效的快照，并且由于它们的年龄而相对稳定。Btrfs 也有高效的快照，但仍然是 BETA。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T21:20:33.257

您不需要另一台服务器，只需在同一台机器上的沙箱中安装另一个 MySQL。负载可能会飙升一点，但您不会遇到任何锁定问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-11-16T04:55:51.083

好的，还有另一种相当有效的快照技术：mdraid1 -- Linux softraid level 1。如果你在 mdraid1 上运行 MySQL，只需插入另一个磁盘，让它同步，停止 mysql，进行同步，删除第三个和同步的 raid 组件，重启mysql。如果您在 raid1 中使用位图，则重新同步以拍摄另一个快照通常会很快....

# xml - Eclipse 3.5：如何从编辑器获取文件名？

> ID：943030
> 
> 赞同：4
> 
> 时间：2009-06-03T04:18:27.387
> 
> 标签：xml, eclipse, editor

谁能告诉我如何从编辑器获取文件名？

我刚刚制作了自己的编辑器来打开 xml 文件并创建几个部分来显示数据。现在我想读取 XML 文件并将其放在该部分中。

我想我现在如何读取 xml 数据，但我不知道如何访问文件名以便可以打开它。

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2011-02-04T09:24:23.907

我意识到这是旧的，但由于我在寻找完全相同的问题的解决方案时偶然发现了它，我想在 VonC 的答案中添加一个注释：

```
IFileEditorInput 
```

隐藏在*org.eclipse.ui.ide*插件中，因此为了使解决方案能够正常工作，您的插件需要将其声明为依赖项。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T06:31:23.037

可能[这种方法](http://dev.eclipse.org/newslists/news.eclipse.tools.jdt/msg20041.html)对你有用

> 将编辑器输入转换为`IFileEditorInput`并使用`IFile`来调用`getLocation()`或`getLocationURI()`。

正如[这里](http://dev.eclipse.org/newslists/news.eclipse.platform/msg35496.html)所说，基本上

> `((IFileEditorInput)editorInput).getFile().getLocation()`足够。

另请参阅[此代码](http://dev.eclipse.org/mhonarc/lists/pde-dev/msg00444.html)：

```
public static String getCurrentFileRealPath(){
        IWorkbenchWindow win = PlatformUI.getWorkbench
().getActiveWorkbenchWindow();

        IWorkbenchPage page = win.getActivePage();
        if (page != null) {
            IEditorPart editor = page.getActiveEditor();
            if (editor != null) {
                IEditorInput input = editor.getEditorInput();
                if (input instanceof IFileEditorInput) {
                    return ((IFileEditorInput)input).getFile
().getLocation().toOSString();
                }
            }
        }
        return null;
} 
```

# php - PHP中相当简单的正则表达式问题

> ID：943055
> 
> 赞同：0
> 
> 时间：2009-06-03T04:25:12.080
> 
> 标签：php, regex

好的，我是一个正则表达式傻瓜。我只学到了足够的东西来让我度过难关，但我想知道如何在不使用 php 三元运算符的情况下执行以下正则表达式。它也可能很难看，但它有效......

```
'^". $date[0].(($date[0] == 0)?'?':'').$date[1]."[/.-]".$date[2].(($date[2] == 0)?'?':'').$date[3]."'"; 
```

嗯。正如您所看到的，我使用三元运算符来测试日期是否包含 0。如果包含.. 那么它可以被忽略，如果不是，那么它是 1 或 2，并且不要忽略。我确定有一种方法可以用正则表达式来写这个吗？如果您知道如何，请告诉我，我将永远感激不尽。另外，如果您想知道这是 mysql 查询中的正则表达式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T05:11:23.033

你在找这个吗？match[1] 是月份，match[2] 是日期，match[3] 是年份

```
$regex = '#(0?[1-9]|1[0-2])[-/]([0-2]?[1-9]|3[01])[-/](19|20)?\d\d)#'; 
```

你在这里有几个问题。

首先，永远不要将不确定格式正确的文本放入数据库。日期在数据库中有和没有 0 的事实是一个问题。为什么日期时间字段中的日期不能由数据库确保它们的格式正确？

其次，上面的正则表达式仅适用于使用“mm/dd/yyyy”日期的美国。如果您绑定到该正则表达式，则不可能支持其他日期格式。

第三，你为什么要在数据库中这样做？你的例子是 WHERE 生日正则表达式的东西......这意味着你在将它传递给 mySQL 之前有这个日期。所以首先在 PHP 中修复日期：

```
$date = strtotime($_GET['date']);
$sql = "select blah From blah WHERE birthday = '$date' blah"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:51:45.320

确实没有任何简单的方法可以简化这一点。问题是您正在构建一个正则表达式，无论如何它都会强制您在零上进行测试。您最好使用 mktime 将 $date 转换为真实日期，然后在查询中使用它。

```
$date1 = mktime(0,0,0, substr($date, 0, 2), substr($date, 2, 2));
$sqlquery = "select * from table WHERE table_date == $date1";
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T04:32:03.373

```
for($i = 0; $i < 3; $i++) {
    $date[i] = preg_replace($date[i], '0', '');
} 
```

任何零都消失了。

查看 PHP 文档，它有很多不错的功能。www.php.net

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T04:40:17.860

我建议不要在生成正则表达式的单个语句中内置这么多条件逻辑。即使有办法将其实现为原生正则表达式，我怀疑它是否更具可读性。如果目标是使此代码段更具可读性，我建议有条件地在不同的正则表达式之间进行选择，或者有条件地在单独的步骤中构建各个部分，然后将它们拼接在一起。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T05:18:27.873

JDany 有一个更好的解决方案，但您正在寻找的正则表达式是：

```
 Month         /            Day               /     Year
(0?[1-9]|1[0-2])[/-](0?[1-9]|[1-2][0-9]|3[0-1])[/-](19|20)?\d\d) 
```

请注意，此正则表达式不处理/验证情况，例如：

1.  月份及其对应的日期（即 28、30、31 天）

2.  闰年

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T06:05:16.073

到目前为止，正则表达式解决方案的反应很好。

这是另一种方法——使用原生 PHP 函数[strtotime](http://us.php.net/strtotime) () 来规范化字符串。它并不完美，但在处理人们可能用作日期的多种格式时，正则表达式解决方案也不是完美的。

以下是我将如何开始攻击它：

```
<?php

// improve strtotime by eliminating dash ambiguity
function strtotimePlus($string) {
    $bads = array('-');
    $goods = array('/');
    return strtotime(str_replace($bads,$goods,$string));
}

// return date in fomat YYYY-MM-DD
function myDateFormat($timeformat) {
    return date("Y-m-d",$timeformat);
}

// convert free-form date string to YYYY-MM-DD
function betterDate($string) {
    return myDateFormat(strtotimePlus($string));

}

// samples from examples mentioned on the thread.
$dates = array();
$dates[] = "6/6/87";
$dates[] = "06/06/87";
$dates[] = "5.3.2001";
$dates[] = "5-2-82";
$dates[] = "1/1/83";

foreach($dates as $date) {
    print $date . " becomes " . betterDate($date) . "<br />";
} 
```

输出：

```
6/6/87 becomes 1987-06-06
06/06/87 becomes 1987-06-06
5.3.2001 becomes 2001-03-05
5-2-82 becomes 1982-05-02
1/1/83 becomes 1983-01-01 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T06:29:04.537

谢谢大家的答案！

需要注意的几点：
1）我没有设计这个数据库，也不想对它进行任何大的改变。
2）我非常清楚如何将字符串转换为日期，反之亦然，以及所有爵士乐。
3）我想知道的是是否有一个正则表达式运算符/表达式可以取消它中间的三元语句。

我意识到我不是很清楚。我在数据库中有所有格式的生日，它是一个大型数据库。我在客户生日前两周从数据库中提取日期。
所以..！我将当前日期加上 14，我将得到“17/06/09”，这是我需要对照数据库中 2000 多个日期检查的日期。这个日期的格式很好。我喜欢美好的事物。特别是日期。美好的约会。无论如何....

我需要对照数据库中的杂烩来检查我的日期，而我知道对照数据库检查这一点的唯一方法是
A）拉出每条记录，正确格式化糟糕的日期，然后对照我的（这就是我正在做......非常cpu密集型）
B）在我的sql中有一个正则表达式子句并且只检索符合我的规范的日期。

我的逻辑合理吗？但愿如此。如果不是，那么请向我指出显而易见的事情，我会送你一些糖果*。

*想象中的糖果

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T12:05:02.800

不要因为解决根本问题而被否决，但是......

如果您现在拥有所有这些不同的日期格式，那么在我看来，这似乎意味着其他应用程序可以使用不同的格式，并且可以解析、理解或至少以字符串的任何形式呈现日期。因此，作为一个字符串，使用此数据的其他应用程序可以以它现在的任何形式接受它。

所以在我看来，如果所有日期数据仍然是字符串，但恰好都在一个特定的布局中（例如，国际 YYYY-MM-DD），那么所有其他应用程序都会对此感到满意这种格式与其他任何格式一样，并且必须解析实际值的任何脚本（例如您的）都可以更简单地执行此操作。

所以，我的问题是，你是否允许擦洗和重新格式化字符串，让它们保持字符串，所以它们看起来都一样？我的意思是在你的工作之前运行一个清理工作（作为一个单独的维护任务，或者在你处理数据之前），它检查日期是否符合你的格式，并重新格式化它并将其作为字符串存储回数据库中如果不是最好的格式。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T12:24:38.393

A separate question about your goal of finding two weeks earlier than the date in the database. How do you know that the user input a day or a month first, if both values are less than 12? For a date like 1/5/06, how do you know whether the user meant 1 May or 5 January? I think you have to solve this, or at least make a decision about it, before you can subtract 14 days.

# wpf - 带有 Alpha 通道的 WPF 3D 纹理

> ID：943067
> 
> 赞同：4
> 
> 时间：2009-06-03T04:32:31.800
> 
> 标签：wpf, xaml, 3d, transparency

使用 WPF 3D，是否可以使用带有 Alpha 通道的纹理？

我想制作一个 3d 场景，其中一切都是平面（就像一切都是剪纸）。我认为实现这一点的最简单方法是创建一个平面，将其分成多个三角形（如布），然后应用具有透明背景的纹理。通过这种方式，我可以使用相同的几何形状，只需更换纹理即可获得完全不同的形状。

我尝试将具有透明背景的 PNG 作为画笔添加到模型中，但它显示为白色背景。WPF 3D 是否提供此功能？如何做呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-19T20:59:00.783

带有 alpha 的纹理确实适用于 wpf（它适用于我！）。你确定你的 png alpha 没问题吗？

一个在 DiffuseMaterial 中带有 alpha 的 png，你只需要。这是一大块 xaml，带有两个带纹理的平面网格上的相机。

替换 png 的路径，将其放入 xaml 文件并启动。您应该能够在 material1 的 alpha 后面看到 material2。

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Width="640.0" Height="480.0"   >
  <Grid.Resources>
    <MeshGeometry3D x:Key="Mesh" Positions="-4.999,-4.999,0.001 5.001,-4.999,0.001 -4.999,5.001,0.001 5.001,5.001,0.001 " TriangleIndices="2 0 3  1 3 0  " TextureCoordinates="0,0 1,0 0,1 1,1 "  />

      <DiffuseMaterial x:Key="material1" >
        <DiffuseMaterial.Brush>
          <ImageBrush ImageSource="C:\mypng.png" Transform="1,0,0,-1,0,1" />
        </DiffuseMaterial.Brush>
      </DiffuseMaterial>

      <DiffuseMaterial x:Key="material2" >
        <DiffuseMaterial.Brush>
         <ImageBrush ImageSource="C:\image_4.png"  Transform="1,0,0,-1,0,1"  />
        </DiffuseMaterial.Brush>
      </DiffuseMaterial>

  </Grid.Resources>
  <Viewport3D Width="640.0" Height="480.0" >
    <Viewport3D.Camera>
      <PerspectiveCamera  Position="0,0,20"/>
    </Viewport3D.Camera>

    <ModelVisual3D>
      <ModelVisual3D.Content>
        <Model3DGroup >

            <AmbientLight />

            <GeometryModel3D Geometry="{StaticResource Mesh}" Material="{StaticResource material2}">
             <GeometryModel3D.Transform>
              <MatrixTransform3D Matrix="1.0,0.0,0.0,0,0.0,1.0,0.0,0,0.0,0.0,1.0,0,0.0,0.0,-5.0,1" />
            </GeometryModel3D.Transform>
            </GeometryModel3D>

            <GeometryModel3D Geometry="{StaticResource Mesh}" Material="{StaticResource material1}">
            <GeometryModel3D.Transform>
              <MatrixTransform3D Matrix="1.0,0.0,0.0,0,0.0,1.0,0.0,0,0.0,0.0,1.0,0,0.0,0.0,0.0,1" />
            </GeometryModel3D.Transform>
            </GeometryModel3D>

        </Model3DGroup>
      </ModelVisual3D.Content>
    </ModelVisual3D>
  </Viewport3D>
</Grid> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-13T14:40:19.423

可以使用带有 Alpha 通道的纹理，尽管 WPF 不能很好地处理它。我做了和你一样的事情，得到了同样的白色背景。这是因为您必须以 z 顺序显示几何模型。从下到上。

然而，有时不可能以这样的顺序真正显示您的模型（对我来说就是这种情况），我真的希望他们能想出一个解决方案。

# c - TTCN 到 C 的转换

> ID：943069
> 
> 赞同：3
> 
> 时间：2009-06-03T04:33:31.673
> 
> 标签：c, ttcn

是否有可以将 TTCN 脚本转换为 C 的开源 TTCN 工具

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-04-10T12:42:37.177

[https://projects.eclipse.org/projects/tools.titan](https://projects.eclipse.org/projects/tools.titan) 这个工具可以提供帮助，它将 TTCN 文件转换为 C++，所以你只需要传递给 C

编辑：更多信息：[https ://polarsys.org/wiki/images/9/95/TITAN_Datasheet_3.b-090914.pdf](https://polarsys.org/wiki/images/9/95/TITAN_Datasheet_3.b-090914.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:43:01.477

我不知道任何实质性项目，但有：

*   [又一个 TTCN 赛跑者](http://code.google.com/p/yatr/)
*   [T3DevKit](http://www.irisa.fr/tipi/wiki/doku.php/t3devkit)（有一个`picottcn`项目的链接）

# asp.net - jQuery 中的母版页控件

> ID：943078
> 
> 赞同：0
> 
> 时间：2009-06-03T04:38:27.957
> 
> 标签：asp.net, jquery

我有一个母版页和一个内容页（SomePage.aspx）。内容页面有一个名为 Button1 的控件。

我像这样在 MasterPage 中使用 jQuery 调用 Button1

```
$('[id$=Button1]').click(function() {
                        alert('');
                    }); 
```

然而什么也没有发生。我在 SomePage.aspx 中添加了 MasterType。

Button 是一个链接按钮。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T05:12:27.757

您发布的代码有效，尽管[jQuery 建议](http://docs.jquery.com/Selectors/attributeEndsWith#attributevalue) `$("[id$='Button1']")`或`$('[id$=\'Button1\']')`.
母版页在这里不应该相关，最后都转到一个 HTML 页面。
确保：

*   JavaScript 确实在页面上（没有母版页错误） - 查看页面的源并查找它。
*   jQuery 已加载 - 在`alert(jQuery);`某处尝试。
*   你的 jQuery 代码在里面[`$(document).ready`](http://docs.jquery.com/Events/ready#fn)
*   JavaScript 被执行：一个小的 JavaScript 语法错误通常会导致整个页面无法工作。尝试调试它，或者在代码前后放置一些老式的警告框，看看它是如何（以及是否）运行的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T05:15:54.947

我认为应该是：'#[id$=Button1]'

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T05:30:55.003

正如 Paolo 所提到的，请确保它在 document.ready 中，因为 JS 无法对（尚）不存在的元素进行操作。此外，请仔细检查您的源以确保控件的实际呈现 ID 与您预期的一样。

您可能会发现这些控件很有帮助：[http ://clipperhouse.com/jQuery/](http://clipperhouse.com/jQuery/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T04:46:57.463

您应该查看由浏览器呈现的页面的源代码，并检查`Button1`. 可能不是`Button1`，而是类似`myContent$Button1`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-03-30T07:35:17.587

我有一个类似的，我想与你分享一些资源......希望可以帮助:-)

[http://weblogs.asp.net/stevewellens/archive/2010/11/26/finding-controls-in-a-master-page-with-jquery.aspx](http://weblogs.asp.net/stevewellens/archive/2010/11/26/finding-controls-in-a-master-page-with-jquery.aspx)

# c# - 启动单个控制台应用程序

> ID：943085
> 
> 赞同：1
> 
> 时间：2009-06-03T04:40:44.270
> 
> 标签：c#, visual-studio, visual-studio-2008

> 可能重复：[使用 Mutex 运行应用程序的单个实例](https://stackoverflow.com/questions/819773/run-single-instance-of-an-application-using-mutex)

我在控制台应用程序上使用 C# 中的 VS 2008。不确定是否有任何可用的类（进程？）来限制一次只运行一个控制台应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T04:48:57.333

没有这样的类，但您可以使用[System.Threading.Mutex](http://msdn.microsoft.com/en-us/library/system.threading.mutex.aspx)来构建一个。

Mutex 是一种同步原语，也可用于进程间同步。

**请参阅示例：** [如何确保只有一个应用程序实例将运行？](http://en.csharp-online.net/CSharp_FAQ:_How_ensure_that_only_one_instance_of_an_application_will_run)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T04:50:29.250

我很快将它拍打在一起，但它确实短暂显示了第二个控制台，然后将其隐藏。不确定是否有办法阻止第二个控制台甚至出现......

```
class Program
{
    private static Mutex mutex;

    static void Main(string[] args)
    {
        mutex = new Mutex(true, "MyMutex");
        if (!mutex.WaitOne(0, false))
        {
            return;
        }
        Console.WriteLine("Application started");
        Console.ReadKey(true);

    }
} 
```

您需要添加对 System.Threading 的引用。

# c++ - 如果我在项目中禁用 C++ 异常，究竟会发生什么？

> ID：943087
> 
> 赞同：23
> 
> 时间：2009-06-03T04:42:33.537
> 
> 标签：c++, exception, exception-handling

Visual C++ 有一个编译器设置“启用 C++ 异常”，可以设置为“否”。如果我这样设置会发生什么？我的代码从不显式抛出或捕获异常（因此第一个抛出的异常无论如何都会终止程序）并且不依赖于堆栈展开——我是否应该期望重新编译的程序有更多不希望的行为？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-03T05:13:17.693

设置的[MSDN 文档](http://msdn.microsoft.com/en-us/library/1deeycx5(VS.80).aspx)解释了不同的异常模式，甚至给出了代码示例来展示不同模式之间的差异。此外，[这篇文章](http://www.thunderguy.com/semicolon/2002/08/15/visual-c-exception-handling/)可能很有趣，尽管它已经很老了。

底线：该选项基本上启用或禁用跟踪所有对象的寿命。这样的跟踪是必需的，因为在发生异常的情况下，需要调用所有适当的析构函数，必须展开堆栈，并进行大量清理工作。这种跟踪需要组织开销（= 附加代码） - 这可以通过将选项设置为“否”来删除。

我自己没有尝试过，但是如果选项设置为“否”，看起来你仍然可以`throw`并且`catch`例外，但是缺少清理和展开，这可能会产生非常糟糕的后果（不推荐;）..

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T05:18:49.013

当 C++ 对象因异常而超出范围时，编译器将省略析构函数和其他堆栈展开代码。

换句话说，它省去了一堆清理代码。这[将显着提高性能](http://www.gamearchitect.net/Articles/ExceptionsAndErrorCodes.html)，但如果确实抛出异常，也会导致严重的邪恶。（如果您不相信我，请自行计时。）

性能差异并不是禁用异常的真正理由，除非在某些关键应用程序中您绝对有义务这样做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T05:31:07.500

当您对“启用 C++ 异常”说“否”时，则不会选择编译器的异常处理同步模型（/GX 或 /EHsc）。在这种模式下，不会启用展开语义。也就是说，一个在框架中自动存储的对象，在执行抛出的函数和捕获抛出的函数之间，不会被破坏。

有关异常处理的更多详细信息，您可以参考 MSDN 或[A Visual C++ 异常常见问题解答。](http://members.cox.net/doug_web/eh.htm#Q1)

```
class Test
{
public:

    Test()
    {
        printf("Test::constructor");
    }
    ~Test()
    {
        printf("Test::Destructor");
    }

};

int _tmain(int argc, _TCHAR* argv[])
{
    int a;

 try
   {
     Test a;
     int* p = 0;
     *p = 0; // Cause access violation
   }
   catch (...)
   {
      printf("Caught access violation"); 
   }
    return 0;
} 
```

如果对异常处理没有，则输出将是：

```
Test::constructor
Caught access violation 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T12:44:52.020

我使用过的代码总是关闭异常。我还没有看到损坏或资源浪费的问题。

我认为异常通常不适合 C++。堆栈爆破，尤其是在缺少 GC 的情况下，使整个异常变得痛苦。然后是关于“异常”真正意味着什么的辩论与失败的可能性相比。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T08:10:22.400

您仍然可以访问结构化异常处理 (SEH)，它可以由 __try、__except 和 __finally 处理。

C++ 异常处理只是建立在 SEH 之上的类实现。

如果您尝试在具有 SEH 异常处理程序的函数中实例化类（抱怨需要展开的对象，即类），编译器也会抱怨，这可能有点混乱，但有一些方法可以绕过它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T08:13:58.867

就标准 C++ 而言，您将获得未定义的行为。C++ 标准不承认异常被全局关闭的可能性，并且某些标准库操作被定义为在某些情况下抛出异常。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T04:48:52.810

如果`operator new`分配内存失败，我相信它会返回`NULL`而不是抛出`std::bad_alloc`异常。

如果您对引发异常的第三方库进行任何调用，将会导致很多问题。

# algorithm - 生成填字游戏的算法

> ID：943113
> 
> 赞同：129
> 
> 时间：2009-06-03T04:52:45.490
> 
> 标签：algorithm, crossword, language-agnostic

给定一个单词列表，你会如何将它们排列成一个填字游戏网格？

它不必像对称的“正确”填字游戏或类似的东西：基本上只为每个单词输出一个起始位置和方向。

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2009-06-20T15:02:03.413

我想出了一个可能不是最有效的解决方案，但效果很好。基本上：

1.  按长度对所有单词进行降序排序。
2.  取第一个单词并将其放在板上。
3.  接下一个词。
4.  搜索所有已经在板上的单词，看看是否有任何可能的交叉点（任何常见字母）与这个单词。
5.  如果这个词有可能的位置，循环遍历板上的所有词并检查新词是否干扰。
6.  如果这个词没有破坏棋盘，则将其放在那里并转到步骤 3，否则，继续搜索位置（步骤 4）。
7.  继续这个循环，直到所有单词都被放置或无法放置。

这是一个有效的，但通常很差的填字游戏。我对上面的基本配方进行了许多修改，以获得更好的结果。

*   在生成填字游戏的最后，根据放置的单词数量（越多越好）、板子的大小（越小越好）以及高宽比（越接近）给它打分为 1 越好）。生成一些填字游戏，然后比较他们的分数并选择最好的一个。
    *   我决定在任意时间内创建尽可能多的填字游戏，而不是运行任意数量的迭代。如果您只有一个小的单词列表，那么您将在 5 秒内获得几十个可能的填字游戏。较大的填字游戏可能只能从 5-6 种可能性中选择。
*   放置一个新词时，不是在找到可接受的位置后立即放置，而是根据它增加网格大小的多少以及有多少交叉点给该词的位置打分（理想情况下，您希望每个词都是被2-3个其他词交叉）。跟踪所有位置及其分数，然后选择最佳位置。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2010-04-11T18:41:16.883

我最近刚刚用 Python 编写了自己的代码。你可以在这里找到它：http: [//bryanhelmig.com/python-crossword-puzzle-generator/](http://bryanhelmig.com/python-crossword-puzzle-generator/)。它不会创建密集的 NYT 风格填字游戏，而是创建您可能在儿童益智书中找到的填字游戏风格。

与我发现的一些算法不同，这些算法实现了一些随机蛮力放置单词的方法，就像一些人建议的那样，我尝试在单词放置时实现一种稍微智能的蛮力方法。这是我的过程：

1.  创建一个任意大小的网格和一个单词列表。
2.  打乱单词列表，然后将单词从最长到最短排序。
3.  将第一个和最长的单词放在最左上角的位置，1,1（垂直或水平）。
4.  移动到下一个单词，遍历单词中的每个字母和网格中的每个单元格，寻找字母到字​​母的匹配。
5.  找到匹配项后，只需将该位置添加到该单词的建议坐标列表中即可。
6.  循环遍历建议的坐标列表并根据它跨越的其他单词数量“评分”单词位置。0 分表示位置不好（与现有单词相邻）或没有单词交叉。
7.  返回步骤#4，直到单词列表用完。可选的第二关。
8.  我们现在应该有一个填字游戏，但由于一些随机放置，质量可能会受到影响。所以，我们缓冲这个填字游戏并返回到第 2 步。如果下一个填字游戏有更多的单词放在板上，它会替换缓冲区中的填字游戏。这是时间限制的（在 x 秒内找到最好的填字游戏）。

到最后，你就有了一个不错的填字游戏或单词搜索游戏，因为它们差不多。它往往运行得相当好，但如果您有任何改进建议，请告诉我。更大的网格运行速度呈指数级增长；线性更大的单词列表。更大的单词列表也有更高的机会获得更好的单词放置数字。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-06-03T05:22:59.693

大约十年前，我实际上写了一个填字游戏生成程序（它很神秘，但同样的规则也适用于普通填字游戏）。

它有一个存储在文件中的单词列表（和相关线索），按迄今为止的使用情况降序排序（因此较少使用的单词位于文件顶部）。一个模板，基本上是一个代表黑色和自由方块的位掩码，是从客户端提供的池中随机选择的。

然后，对于拼图中的每个不完整的单词（基本上找到第一个空白方块，看看右边的（跨字）或下面的（下字）也是空白的），搜索完成文件寻找适合的第一个单词，考虑到该单词中已经存在的字母。如果没有合适的词，您只需将整个词标记为不完整并继续前进。

最后是一些未完成的单词，编译器必须填写（如果需要，可以在文件中添加单词和线索）。如果他们想不出*任何*想法，他们可以手动编辑填字游戏以更改约束，或者只是要求完全重新生成。

一旦单词/线索文件达到一定大小（并且它每天为该客户添加 50-100 条线索），很少有需要为每个填字游戏完成超过两到三个手动修复的情况.

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-07-22T12:07:17.320

该算法在 60 秒内创建 50 个密集的 6x9[箭头填字游戏。](https://www.google.com.br/search?q=arrow%20crosswords&tbm=isch&tbo=u&source=univ&sa=X&ei=y5y4UdeLDoXW8gSoq4HgBA&ved=0CE8QsAQ&biw=1680&bih=890)它使用一个单词数据库（带有单词+提示）和一个板数据库（带有预配置板）。

```
1) Search for all starting cells (the ones with an arrow), store their size and directions
2) Loop through all starting cells
2.1) Search a word
2.1.1) Check if it was not already used
2.1.2) Check if it fits
2.2) Add the word to the board
3) Check if all cells were filled 
```

更大的单词数据库大大减少了生成时间，并且某些类型的板更难填充！更大的板需要更多的时间才能正确填充！

* * *

例子：

预配置的 6x9 板：

（# 表示一个单元格中的一个提示，% 表示一个单元格中的两个提示，箭头未显示）

```
# - # # - % # - # 
- - - - - - - - - 
# - - - - - # - - 
% - - # - # - - - 
% - - - - - % - - 
- - - - - - - - - 
```

生成的 6x9 板：

```
# C # # P % # O # 
S A T E L L I T E 
# N I N E S # T A 
% A B # A # G A S 
% D E N S E % W E 
C A T H E D R A L 
```

提示[行，列]：

```
[1,0] SATELLITE: Used for weather forecast
[5,0] CATHEDRAL: The principal church of a city
[0,1] CANADA: Country on USA's northern border
[0,4] PLEASE: A polite way to ask things
[0,7] OTTAWA: Canada's capital
[1,2] TIBET: Dalai Lama's region
[1,8] EASEL: A tripod used to put a painting
[2,1] NINES: Dressed up to (?)
[4,1] DENSE: Thick; impenetrable
[3,6] GAS: Type of fuel
[1,5] LS: Lori Singer, american actress
[2,7] TA: Teaching assistant (abbr.)
[3,1] AB: A blood type
[4,3] NH: New Hampshire (abbr.)
[4,5] ED: (?) Harris, american actor
[4,7] WE: The first person of plural (Grammar) 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-05-02T19:33:39.723

虽然这是一个较老的问题，但会根据我所做的类似工作尝试回答。

有很多方法可以解决约束问题（一般属于 NPC 复杂性类）。

这与组合优化和约束规划有关。在这种情况下，约束是网格的几何形状和单词是唯一的要求等。

随机化/退火方法也可以工作（尽管在适当的设置内）。

高效的简单可能只是终极智慧！

要求是一个或多或少完整的填字游戏编译器和（可视化所见即所得）构建器。

撇开所见即所得的构建器部分不谈，编译器大纲是这样的：

1.  加载可用的词表（按词长排序，即2,3,..,20）

2.  在用户构建的网格上找到字槽（即网格词）（例如，x,y 处的词，长度为 L，水平或垂直）（复杂度 O(N)）

3.  计算网格词的交点（需要填充）（复杂度 O(N^2) ）

4.  计算单词列表中的单词与所使用的各种字母的交集（这允许使用模板搜索匹配的单词，例如[cwc 使用的 Sik Cambon 论文](http://thesis.cambon.dk/)）（复杂度 O(WL*AL)）

步骤 .3 和 .4 允许执行此任务：

一种。网格词与其自身的交集能够创建一个“模板”，用于尝试在该网格词的可用词的关联词表中找到匹配项（通过使用其他与该词相交的词的字母，这些词已经在某个特定位置填充算法步骤）

湾。单词列表中的单词与字母表的交集可以找到与给定“模板”匹配的匹配（候选）单词（例如，第一名的“A”和第三名的“B”等）。

因此，随着这些数据结构的实现，所使用的算法是这样的：

注意：如果网格和单词数据库是不变的，前面的步骤可以只做一次。

1.  算法的第一步是随机选择一个空词槽（网格词），并用其相关词表中的候选词填充它（随机化可以在算法的连续执行中产生不同的解决方案）（复杂度 O(1) 或 O( N))

2.  对于每个仍然为空的词槽（与已填充的词槽有交集），计算一个约束比率（这可能会有所不同，简单的是该步骤中可用解决方案的数量）并按此比率对空词槽进行排序（复杂度 O(NlogN ) 或 O(N) )

3.  循环遍历上一步计算的空词槽，并为每个空词槽尝试多个候选解（确保保留“弧一致性”，即如果使用此词，则网格在此步骤后有解）并根据下一步的最大可用性（即，如果当时在那个地方使用这个词等，下一步有最大可能的解决方案。）（复杂度 O(N*MaxCandidatesUsed) ）

4.  填写该单词（将其标记为已填写并转到步骤 2）

5.  如果没有找到满足步骤 .3 标准的单词，请尝试回溯到上一步的另一个候选解决方案（此处的标准可能有所不同）（复杂度 O(N)）

6.  如果找到回溯，则使用替代方法并可选地重置任何可能需要重置的已填充单词（再次将它们标记为未填充）（复杂度 O(N) ）

7.  如果没有找到回溯，则找不到解决方案（至少使用此配置、初始种子等）

8.  否则，当所有单词都填满时，您有一个解决方案

该算法对问题的解决方案树进行随机一致游走。如果在某个时候出现死胡同，它会回溯到前一个节点并遵循另一条路线。直到找到解决方案或用尽各种节点的候选者数量。

一致性部分确保找到的解决方案确实是一个解决方案，随机部分能够在不同的执行中产生不同的解决方案，并且平均而言具有更好的性能。

PS。所有这些（以及其他）都是用纯 JavaScript（具有并行处理和所见即所得）功能实现的

PS2。该算法可以很容易地并行化，以便同时产生多个（不同的）解决方案

希望这可以帮助

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-06-20T15:07:58.500

为什么不直接使用随机概率方法开始。从一个单词开始，然后反复选择一个随机单词，并尝试在不破坏大小等限制的情况下使其适合拼图的当前状态。如果失败，重新开始。

您会惊讶于这样的蒙特卡洛方法的工作频率。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-03-07T17:04:32.213

这是一些基于 nickf 的答案和 Bryan 的 Python 代码的 JavaScript 代码。只是发布它以防其他人在js中需要它。

```
function board(cols, rows) { //instantiator object for making gameboards
this.cols = cols;
this.rows = rows;
var activeWordList = []; //keeps array of words actually placed in board
var acrossCount = 0;
var downCount = 0;

var grid = new Array(cols); //create 2 dimensional array for letter grid
for (var i = 0; i < rows; i++) {
    grid[i] = new Array(rows);
}

for (var x = 0; x < cols; x++) {
    for (var y = 0; y < rows; y++) {
        grid[x][y] = {};
        grid[x][y].targetChar = EMPTYCHAR; //target character, hidden
        grid[x][y].indexDisplay = ''; //used to display index number of word start
        grid[x][y].value = '-'; //actual current letter shown on board
    }
}

function suggestCoords(word) { //search for potential cross placement locations
    var c = '';
    coordCount = [];
    coordCount = 0;
    for (i = 0; i < word.length; i++) { //cycle through each character of the word
        for (x = 0; x < GRID_HEIGHT; x++) {
            for (y = 0; y < GRID_WIDTH; y++) {
                c = word[i];
                if (grid[x][y].targetChar == c) { //check for letter match in cell
                    if (x - i + 1> 0 && x - i + word.length-1 < GRID_HEIGHT) { //would fit vertically?
                        coordList[coordCount] = {};
                        coordList[coordCount].x = x - i;
                        coordList[coordCount].y = y;
                        coordList[coordCount].score = 0;
                        coordList[coordCount].vertical = true;
                        coordCount++;
                    }

                    if (y - i + 1 > 0 && y - i + word.length-1 < GRID_WIDTH) { //would fit horizontally?
                        coordList[coordCount] = {};
                        coordList[coordCount].x = x;
                        coordList[coordCount].y = y - i;
                        coordList[coordCount].score = 0;
                        coordList[coordCount].vertical = false;
                        coordCount++;
                    }
                }
            }
        }
    }
}

function checkFitScore(word, x, y, vertical) {
    var fitScore = 1; //default is 1, 2+ has crosses, 0 is invalid due to collision

    if (vertical) { //vertical checking
        for (i = 0; i < word.length; i++) {
            if (i == 0 && x > 0) { //check for empty space preceeding first character of word if not on edge
                if (grid[x - 1][y].targetChar != EMPTYCHAR) { //adjacent letter collision
                    fitScore = 0;
                    break;
                }
            } else if (i == word.length && x < GRID_HEIGHT) { //check for empty space after last character of word if not on edge
                 if (grid[x+i+1][y].targetChar != EMPTYCHAR) { //adjacent letter collision
                    fitScore = 0;
                    break;
                }
            }
            if (x + i < GRID_HEIGHT) {
                if (grid[x + i][y].targetChar == word[i]) { //letter match - aka cross point
                    fitScore += 1;
                } else if (grid[x + i][y].targetChar != EMPTYCHAR) { //letter doesn't match and it isn't empty so there is a collision
                    fitScore = 0;
                    break;
                } else { //verify that there aren't letters on either side of placement if it isn't a crosspoint
                    if (y < GRID_WIDTH - 1) { //check right side if it isn't on the edge
                        if (grid[x + i][y + 1].targetChar != EMPTYCHAR) { //adjacent letter collision
                            fitScore = 0;
                            break;
                        }
                    }
                    if (y > 0) { //check left side if it isn't on the edge
                        if (grid[x + i][y - 1].targetChar != EMPTYCHAR) { //adjacent letter collision
                            fitScore = 0;
                            break;
                        }
                    }
                }
            }

        }

    } else { //horizontal checking
        for (i = 0; i < word.length; i++) {
            if (i == 0 && y > 0) { //check for empty space preceeding first character of word if not on edge
                if (grid[x][y-1].targetChar != EMPTYCHAR) { //adjacent letter collision
                    fitScore = 0;
                    break;
                }
            } else if (i == word.length - 1 && y + i < GRID_WIDTH -1) { //check for empty space after last character of word if not on edge
                if (grid[x][y + i + 1].targetChar != EMPTYCHAR) { //adjacent letter collision
                    fitScore = 0;
                    break;
                }
            }
            if (y + i < GRID_WIDTH) {
                if (grid[x][y + i].targetChar == word[i]) { //letter match - aka cross point
                    fitScore += 1;
                } else if (grid[x][y + i].targetChar != EMPTYCHAR) { //letter doesn't match and it isn't empty so there is a collision
                    fitScore = 0;
                    break;
                } else { //verify that there aren't letters on either side of placement if it isn't a crosspoint
                    if (x < GRID_HEIGHT) { //check top side if it isn't on the edge
                        if (grid[x + 1][y + i].targetChar != EMPTYCHAR) { //adjacent letter collision
                            fitScore = 0;
                            break;
                        }
                    }
                    if (x > 0) { //check bottom side if it isn't on the edge
                        if (grid[x - 1][y + i].targetChar != EMPTYCHAR) { //adjacent letter collision
                            fitScore = 0;
                            break;
                        }
                    }
                }
            }

        }
    }

    return fitScore;
}

function placeWord(word, clue, x, y, vertical) { //places a new active word on the board

    var wordPlaced = false;

    if (vertical) {
        if (word.length + x < GRID_HEIGHT) {
            for (i = 0; i < word.length; i++) {
                grid[x + i][y].targetChar = word[i];
            }
            wordPlaced = true;
        }
    } else {
        if (word.length + y < GRID_WIDTH) {
            for (i = 0; i < word.length; i++) {
                grid[x][y + i].targetChar = word[i];
            }
            wordPlaced = true;
        }
    }

    if (wordPlaced) {
        var currentIndex = activeWordList.length;
        activeWordList[currentIndex] = {};
        activeWordList[currentIndex].word = word;
        activeWordList[currentIndex].clue = clue;
        activeWordList[currentIndex].x = x;
        activeWordList[currentIndex].y = y;
        activeWordList[currentIndex].vertical = vertical;

        if (activeWordList[currentIndex].vertical) {
            downCount++;
            activeWordList[currentIndex].number = downCount;
        } else {
            acrossCount++;
            activeWordList[currentIndex].number = acrossCount;
        }
    }

}

function isActiveWord(word) {
    if (activeWordList.length > 0) {
        for (var w = 0; w < activeWordList.length; w++) {
            if (word == activeWordList[w].word) {
                //console.log(word + ' in activeWordList');
                return true;
            }
        }
    }
    return false;
}

this.displayGrid = function displayGrid() {

    var rowStr = "";
    for (var x = 0; x < cols; x++) {

        for (var y = 0; y < rows; y++) {
            rowStr += "<td>" + grid[x][y].targetChar + "</td>";
        }
        $('#tempTable').append("<tr>" + rowStr + "</tr>");
        rowStr = "";

    }
    console.log('across ' + acrossCount);
    console.log('down ' + downCount);
}

//for each word in the source array we test where it can fit on the board and then test those locations for validity against other already placed words
this.generateBoard = function generateBoard(seed = 0) {

    var bestScoreIndex = 0;
    var top = 0;
    var fitScore = 0;
    var startTime;

    //manually place the longest word horizontally at 0,0, try others if the generated board is too weak
    placeWord(wordArray[seed].word, wordArray[seed].displayWord, wordArray[seed].clue, 0, 0, false);

    //attempt to fill the rest of the board 
    for (var iy = 0; iy < FIT_ATTEMPTS; iy++) { //usually 2 times is enough for max fill potential
        for (var ix = 1; ix < wordArray.length; ix++) {
            if (!isActiveWord(wordArray[ix].word)) { //only add if not already in the active word list
                topScore = 0;
                bestScoreIndex = 0;

                suggestCoords(wordArray[ix].word); //fills coordList and coordCount
                coordList = shuffleArray(coordList); //adds some randomization

                if (coordList[0]) {
                    for (c = 0; c < coordList.length; c++) { //get the best fit score from the list of possible valid coordinates
                        fitScore = checkFitScore(wordArray[ix].word, coordList[c].x, coordList[c].y, coordList[c].vertical);
                        if (fitScore > topScore) {
                            topScore = fitScore;
                            bestScoreIndex = c;
                        }
                    }
                }

                if (topScore > 1) { //only place a word if it has a fitscore of 2 or higher

                    placeWord(wordArray[ix].word, wordArray[ix].clue, coordList[bestScoreIndex].x, coordList[bestScoreIndex].y, coordList[bestScoreIndex].vertical);
                }
            }

        }
    }
    if(activeWordList.length < wordArray.length/2) { //regenerate board if if less than half the words were placed
        seed++;
        generateBoard(seed);
    }
}
}
function seedBoard() {
    gameboard = new board(GRID_WIDTH, GRID_HEIGHT);
    gameboard.generateBoard();
    gameboard.displayGrid();
} 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-06-03T05:26:01.907

我会生成两个数字：长度和拼字游戏得分。假设拼字游戏分数低意味着更容易加入（低分数 = 很多常用字母）。按长度降序和拼字游戏分数升序对列表进行排序。

接下来，只需从列表中删除。如果单词不与现有单词交叉（分别检查每个单词的长度和拼字游戏分数），则将其放入队列中，并检查下一个单词。

冲洗并重复，这应该会生成一个填字游戏。

当然，我很确定这是 O(n!) 并且不能保证为您完成填字游戏，但也许有人可以改进它。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2010-09-22T17:34:08.933

我一直在思考这个问题。我的感觉是，要创建一个真正密集的填字游戏，你不能希望你有限的单词列表就足够了。因此，您可能想要获取字典并将其放入“trie”数据结构中。这将使您可以轻松找到填充剩余空格的单词。在 trie 中，实现一个遍历是相当有效的，比如说，给你所有形式为“c?t”的单词。

所以，我的一般想法是：创建某种相对蛮力的方法，如本文所述，创建一个低密度的十字架，并用字典单词填充空白。

如果其他人采用这种方法，请告诉我。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-12-05T08:47:35.623

我在玩填字游戏生成器引擎，我发现这是最重要的：

0。`!/usr/bin/python`

1.  一种。`allwords.sort(key=len, reverse=True)`

    湾。制作一些类似光标的项目/对象，它将在矩阵周围移动以便于定位，除非您以后想通过随机选择进行迭代。

2.  第一个，拿起第一对并将它们从 0,0 上下放置；将第一个存储为我们当前的填字游戏“领导者”。

3.  将光标按对角线顺序或以更大对角线概率随机移动到下一个空单元格

4.  遍历单词 like 并使用可用空间长度来定义最大单词长度： `temp=[] for w_size in range( len( w_space ), 2, -1 ) : # t for w in [ word for word in allwords if len(word) == w_size ] : # if w not in temp and putTheWord( w, w_space ) : # temp.append( w )`

5.  将单词与我使用的可用空间进行比较，即：

    ```
    w_space=['c','.','a','.','.','.'] # whereas dots are blank cells

    # CONVERT MULTIPLE '.' INTO '.*' FOR REGEX

    pattern = r''.join( [ x.letter for x in w_space ] )
    pattern = pattern.strip('.') +'.*' if pattern[-1] == '.' else pattern

    prog = re.compile( pattern, re.U | re.I )

    if prog.match( w ) :
        #
        if prog.match( w ).group() == w :
            #
            return True 
    ```

6.  每个成功使用的单词后，改变方向。循环同时填充所有单元格，或者您用完单词或通过迭代限制然后：

`# CHANGE ALL WORDS LIST inexOf1stWord = allwords.index( leading_w ) allwords = allwords[:inexOf1stWord+1][:] + allwords[inexOf1stWord+1:][:]`

...并再次迭代新的填字游戏。

7.  通过填写的容易程度和一些估计计算来制作评分系统。如果您的评分系统满足分数，则通过将其附加到已制作的填字游戏列表中，为当前填字游戏打分并缩小以后的选择范围。

8.  在第一次迭代会话之后，再次从制作的填字游戏列表中迭代以完成工作。

通过使用更多参数，速度可以大大提高。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-04-20T07:16:07.253

这个项目作为一个项目出现在哈佛的[AI CS50 课程](https://cs50.harvard.edu/ai/projects/3/crossword/)中。这个想法是将填字游戏生成问题表述为一个约束满足问题，并使用不同的启发式回溯来解决它以减少搜索空间。

首先，我们需要几个输入文件：

1.  填字游戏的结构（如下图所示，例如，“#”代表不填的字符，“_”代表要填的字符）

`

```
###_####_#
____####_#
_##_#_____
_##_#_##_#
______####
#_###_####
#_##______
#_###_##_#
_____###_#
#_######_#
##_______# 
```

`

2.  一个输入词汇表（单词列表/字典），将从中选择候选词（如下所示）。

    `a abandon ability able abortion about above abroad absence absolute absolutely ...`

现在定义CSP并解决如下：

1.  变量被定义为具有来自作为输入提供的单词列表（词汇表）的值（即，它们的域）。
2.  每个变量由一个 3 元组表示： (grid_coordinate, direction, length) 其中坐标表示相应单词的开头，方向可以是水平或垂直，长度定义为变量将是单词的长度分配给。
3.  约束由提供的结构输入定义：例如，如果水平和垂直变量具有共同的字符，它将表示为重叠（弧）约束。
4.  现在，可以使用节点一致性和 AC3 弧一致性算法来减少域。
5.  然后回溯以获得具有 MRV（最小剩余值）、度等的 CSP 的解决方案（如果存在）。启发式可用于选择下一个未分配的变量，并且 LCV（最小约束值）等启发式可用于域-排序，使搜索算法更快。

下面显示了使用 CSP 求解算法的实现获得的输出：

```
`
███S████D█
MUCH████E█
E██A█AGENT
S██R█N██Y█
SUPPLY████
█N███O████
█I██INSIDE
█Q███E██A█
SUGAR███N█
█E██████C█
██OFFENSE█ 
```

`

以下动画显示了回溯步骤：

[![在此处输入图像描述](https://i.stack.imgur.com/E5Fr4.gif)](https://i.stack.imgur.com/E5Fr4.gif)

这是另一个带有孟加拉语（孟加拉语）语言单词列表的单词：

[![在此处输入图像描述](https://i.stack.imgur.com/RveHK.gif)](https://i.stack.imgur.com/RveHK.gif)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-06-03T05:15:49.877

我会得到每个单词使用的每个字母的索引，以了解可能的交叉。然后我会选择最大的单词并将其用作基础。选择下一个大的并穿过它。冲洗并重复。这可能是一个NP问题。

另一个想法是创建一个遗传算法，其中强度指标是您可以在网格中放入多少单词。

我发现的困难部分是何时知道某个列表不可能被越过。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-04-17T18:54:18.313

[![jQuery 填字游戏生成器和游戏](https://i.stack.imgur.com/IIHXh.jpg)](https://i.stack.imgur.com/IIHXh.jpg)

我已经编写了一个 JavaScript/jQuery 解决方案来解决这个问题：

示例演示：[http ://www.earthfluent.com/crossword-puzzle-demo.html](http://www.earthfluent.com/crossword-puzzle-demo.html)

源代码：[https ://github.com/HoldOffHunger/jquery-crossword-puzzle-generator](https://github.com/HoldOffHunger/jquery-crossword-puzzle-generator)

我使用的算法的意图：

1.  尽可能减少网格中不可用方块的数量。
2.  有尽可能多的混合词。
3.  在极快的时间内计算。

[![演示生成的填字游戏。](https://i.stack.imgur.com/sDkKl.jpg)](https://i.stack.imgur.com/sDkKl.jpg)

我将描述我使用的算法：

1.  根据共享一个共同字母的单词将单词组合在一起。

2.  从这些组中，构建一组新的数据结构（“词块”），这是一个主词（贯穿所有其他词），然后是其他词（贯穿主词）。

3.  从填字游戏左上角的第一个单词块开始填字游戏。

4.  对于其余的单词块，从填字游戏的最右下角开始，向上和向左移动，直到没有更多可用的位置可以填充。如果向上的空列多于向左的空列，则向上移动，反之亦然。

# java - 标签的 src 属性中的请求未处理

> ID：943120
> 
> 赞同：0
> 
> 时间：2009-06-03T04:56:11.990
> 
> 标签：java, image, jsp

我有一个包含参数的请求，响应将给出条形码图像。我们正在使用 Comergent 框架工作。

```
<img src="../direct/bestbuy?cmd=BBFBGenerateBarCode&type=code128&msg=12345&fmt=JPEG&height=10&hrsize=5pt" alt="Barcode" width="166" height="44"> 
```

以上将进入控制器“BBFBGenerateBarCode”并执行相应的java类“BarCodeGenerator.java”，它将创建条形码图像并返回图像作为响应。

我面临的问题是，我需要在两件事上显示此图像。一个是打印页面，另一个是电子邮件。如果我在 Print.jsp 中使用上述代码，请求会得到处理并转到 BarCodeGenerator.java 类（我在 BarCodeGenerator.java 中使用过 system.out.println()）并创建图像并在 printpage 中显示但是如果我使用Confirmemail.jsp 中的上述图像标记（将向用户发送电子邮件），请求未处理，我无法在邮件中看到图像。请帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T05:04:08.157

这似乎是一个基本问题，如果您已经发现这不是问题，我深表歉意，但如果您`../direct/bestbuy?cmd=BBFBGenerateBarCode&type=code128&msg=12345&fmt=JPEG&height=10&hrsize=5pt`在电子邮件中使用文字路径，您将永远不会从中获得图像，至少从桌面电子邮件客户端。

您想要做的是在其前面加上服务器名称/路径。假设这`mydomain.com`是您使用的域名，您将需要更新您的电子邮件内容以具有以下图像标签：

```
<img src="http://mydomain.com/direct/bestbuy?cmd=BBFBGenerateBarCode&type=code128&msg=12345&fmt=JPEG&height=10&hrsize=5pt" alt="Barcode" width="166" height="44"> 
```

这也假定到*/direct/bestbuy* servlet/jsp/etc 的路径正确。

# asp.net-mvc - 从动作写入输出流

> ID：943122
> 
> 赞同：30
> 
> 时间：2009-06-03T04:56:34.050
> 
> 标签：asp.net-mvc

由于一些奇怪的原因，我想将 HTML 从控制器操作直接写入响应流。（我理解 MVC 分离，但这是一个特例。）

我可以直接写入`HttpResponse`流吗？在这种情况下，`IView`控制器动作应该返回哪个对象？我可以返回“空”吗？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-11-19T14:50:55.850

我使用了一个派生的类`FileResult`来使用普通的 MVC 模式来实现这一点：

```
/// <summary>
/// MVC action result that generates the file content using a delegate that writes the content directly to the output stream.
/// </summary>
public class FileGeneratingResult : FileResult
{
    /// <summary>
    /// The delegate that will generate the file content.
    /// </summary>
    private readonly Action<System.IO.Stream> content;

    private readonly bool bufferOutput;

    /// <summary>
    /// Initializes a new instance of the <see cref="FileGeneratingResult" /> class.
    /// </summary>
    /// <param name="fileName">Name of the file.</param>
    /// <param name="contentType">Type of the content.</param>
    /// <param name="content">Delegate with Stream parameter. This is the stream to which content should be written.</param>
    /// <param name="bufferOutput">use output buffering. Set to false for large files to prevent OutOfMemoryException.</param>
    public FileGeneratingResult(string fileName, string contentType, Action<System.IO.Stream> content,bool bufferOutput=true)
        : base(contentType)
    {
        if (content == null)
            throw new ArgumentNullException("content");

        this.content = content;
        this.bufferOutput = bufferOutput;
        FileDownloadName = fileName;
    }

    /// <summary>
    /// Writes the file to the response.
    /// </summary>
    /// <param name="response">The response object.</param>
    protected override void WriteFile(System.Web.HttpResponseBase response)
    {
        response.Buffer = bufferOutput;
        content(response.OutputStream);
    }
} 
```

控制器方法现在是这样的：

```
public ActionResult Export(int id)
{
    return new FileGeneratingResult(id + ".csv", "text/csv",
        stream => this.GenerateExportFile(id, stream));
}

public void GenerateExportFile(int id, Stream stream)
{
    stream.Write(/**/);
} 
```

请注意，如果缓冲关闭，

```
stream.Write(/**/); 
```

变得非常缓慢。解决方案是使用 BufferedStream。这样做在一种情况下将性能提高了大约 100 倍。看

[无缓冲输出非常慢](https://stackoverflow.com/q/26010915/141172)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T05:00:21.360

是的，您可以直接写入响应。完成后，您可以调用 CompleteRequest() 并且您不需要返回任何内容。

例如：

```
// GET: /Test/Edit/5
public ActionResult Edit(int id)
{

    Response.Write("hi");
    HttpContext.ApplicationInstance.CompleteRequest();

    return View();     // does not execute!
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-02-05T08:15:11.053

如果您不想派生自己的结果类型，您可以简单地写入`Response.OutputStream`并返回`new EmptyResult()`。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-06-03T05:00:33.327

编写您自己的操作结果。这是我的一个例子：

```
public class RssResult : ActionResult
{
    public RssFeed RssFeed { get; set; }

    public RssResult(RssFeed feed) {
        RssFeed = feed;
    }

    public override void ExecuteResult(ControllerContext context) {
        context.HttpContext.Response.ContentType = "application/rss+xml";
        SyndicationResourceSaveSettings settings = new SyndicationResourceSaveSettings();
        settings.CharacterEncoding = new UTF8Encoding(false);
        RssFeed.Save(context.HttpContext.Response.OutputStream, settings);
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T04:59:21.160

`return Content(...);`如果我没记错的话，你可以`...`在你想直接写入输出流的地方做，或者什么也不做。

看看上的`Content`方法`Controller`：[http ://aspnet.codeplex.com/SourceControl/changeset/view/22907#266451](http://aspnet.codeplex.com/SourceControl/changeset/view/22907#266451)

还有`ContentResult`：[http ://aspnet.codeplex.com/SourceControl/changeset/view/22907#266450](http://aspnet.codeplex.com/SourceControl/changeset/view/22907#266450)

# xml - 使用 XSD 验证 XML

> ID：943131
> 
> 赞同：7
> 
> 时间：2009-06-03T05:00:20.720
> 
> 标签：xml, xsd, linq-to-xml

我在使用[XSD](http://en.wikipedia.org/wiki/XML_Schema_%28W3C%29)验证 XML 时遇到了真正的困难。我应该在所有这些前面加上前缀并声明，我是 XSD 和验证的新手，所以我不确定这是代码问题还是 XML 问题。我曾经历过 XML API 的地狱，并带着无数不同的选项回来，并认为我已经找到了使用 XSD 验证 XML 的理想策略。请注意，我的 XML 和 XSD 来自数据库，因此我不需要从磁盘读取任何内容。

我已将我的问题缩小为一个简单的示例[Windows 窗体](http://en.wikipedia.org/wiki/Windows_Forms)应用程序。它有一个用于 XSD 的文本框 (txtXsd)、一个用于 XML 的文本框 (txtXml)、一个用于结果的文本框 (txtResult) 和一个用于开始验证的按钮 (btnValidate)。

我正在使用 Microsoft 的示例 XSD 文件，

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="urn:bookstore-schema" elementFormDefault="qualified" targetNamespace="urn:bookstore-schema">
    <xsd:element name="title" type="xsd:string" />
    <xsd:element name="comment" type="xsd:string" />
    <xsd:element name="author" type="authorName"/>
    <xsd:complexType name="authorName">
        <xsd:sequence>
            <xsd:element name="first-name" type="xsd:string" />
            <xsd:element name="last-name" type="xsd:string" />
        </xsd:sequence>
    </xsd:complexType>
</xsd:schema> 
```

我在我的应用程序中使用以下代码。

```
private void btnValidate_Click (object sender, EventArgs e)
{
    try
    {
        XmlTextReader reader = new XmlTextReader(txtXsd.Text, XmlNodeType.Document, new XmlParserContext(null, null, String.Empty, XmlSpace.None));
        XmlSchema schema = XmlSchema.Read(reader, null);
        XmlSchemaSet schemas = new XmlSchemaSet();
        schemas.Add(schema);

        XDocument doc = XDocument.Parse(txtXml.Text);
        doc.Validate(schemas, ValidateSchema);
    }
    catch (Exception exception)
    {
        txtResult.Text += exception.Message + Environment.NewLine;
    }
}

private void ValidateSchema (Object sender, ValidationEventArgs e)
{
    txtResult.Text += e.Message + Environment.NewLine;
} 
```

作为测试，我输入了有效的 XML，但我认为不应该符合上面的 XSD。

```
<xml>
    <bogusNode>blah</bogusNode>
</xml> 
```

结果什么都没有，没有任何验证错误。我如何解决它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T05:34:47.840

好吧，首先 - 您的 XSD 定义了一个 XML 名称空间`xmlns="urn:bookstore-schema"`，该名称空间不存在于您的 XML 测试文件中 - 因此，您的 XML 测试文件中的任何内容都不会被验证。

如果您从架构中删除这些元素：

```
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
        <xsd:element name="title" type="xsd:string" /> 
```

然后它将正确验证您的 XML 测试文件并抱怨错误的元素。

同样使用命名的元素`<xml>`可能不是一个好主意 - 因为该指令`<?xml ......?>`是预定义的指令，不应在文档中的其他位置显示为标签名称。

马克

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T19:18:10.070

> 我不希望用户提交 XSD 中未定义的 XML。

你为什么在乎？您的架构会验证名称空间中的 XML 节点。您的处理逻辑处理名称空间中的 XML 节点。不在您的命名空间中的节点与您的架构或逻辑无关。

如果确实有必要将 XML 文档中的所有节点限制在一个特定的名称空间中，您可以通过扩展此处的基本[验证](http://msdn.microsoft.com/en-us/library/as3tta56.aspx)`XmlReader`逻辑来​​实现。

```
 public static void Main()
    {
        const string myNamespaceURN = "urn:my-namespace";

        XmlSchemaSet sc = new XmlSchemaSet();
        sc.Add(myNamespaceURN, "mySchema.xsd");

        XmlReaderSettings settings = new XmlReaderSettings();
        settings.ValidationType = ValidationType.Schema;
        settings.Schemas = sc;
        settings.ValidationEventHandler += ValidationCallBack;

        XmlReader reader = XmlReader.Create("myDocument.xml", settings);

        while (reader.Read())
        {
            if ((reader.NodeType == XmlNodeType.Element ||
                 reader.NodeType == XmlNodeType.Attribute)
                &&
                reader.NamespaceURI != myNamespaceURN)
            {
                LogError(reader.NamespaceURI + " is not a valid namespace.");
            }
        }
    }

    private static void ValidationCallBack(object sender, ValidationEventArgs e)
    {
        LogError(e.Message);
    }

    private static void LogError(string msg)
    {
        Console.WriteLine(msg);
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T05:59:28.890

您也可以尝试[XmlValidatingReader](http://msdn.microsoft.com/en-us/library/system.xml.xmlvalidatingreader.aspx)进行 XML 验证

# c# - 您是否喜欢返回修改后的对象？

> ID：943135
> 
> 赞同：8
> 
> 时间：2009-06-03T05:01:09.660
> 
> 标签：c#, class

```
Class c = new Class( { Prop = "Initial" } ); 
```

我有上面的课。您将如何创建一种方法来修改它？

```
public Class ModifyIt(Class c)
{
    c.Prop = "changed";
    return c;
} 
```

或者

```
public void ModifyIt(Class c)
{
    c.Prop = "changed";
} 
```

然后像这样调用...

```
Class c = ModifyIt(c);
Console.WriteLine(c.Prop);
// changed 
```

或这个

```
ModifyIt(c)
Console.WriteLine(c.Prop);
// changed 
```

你的偏好是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T05:09:49.117

就个人而言，我更喜欢[命令-查询分离](http://en.wikipedia.org/wiki/Command-query_separation)——即，返回结果的方法不应该是mutators，反之亦然。我理解`return this`人群的论点，即“链接”调用的易用性：

```
foo.ChangeThis(23).ChangeThat(45).AndAlso(67); 
```

但是将这些情况编码为绝对不错

```
var x=foo;
x.ChangeThis(23); x.ChangeThat(45); x.AndAlso(67); 
```

同时，正如维基百科网址所讨论的那样，“命令-查询分离”的优势（在绝大多数情况下，虽然不是 100%），持续存在......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T05:11:11.097

是否返回对象实例的选择取决于具体情况。

通过方法返回对象的常见情况在[构建器模式](http://en.wikipedia.org/wiki/Builder_pattern)中可以看到，例如[`StringBuilder`](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)类：

```
new StringBuilder("Hello").Append(" ").Append("World!").ToString(); 
```

但总的来说，如果不执行这种[方法链接](http://en.wikipedia.org/wiki/Method_chaining)，我会选择不返回任何东西。如果常见的用例是不使用返回的对象（只是丢弃它），这似乎是一种浪费。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T05:07:29.777

第一种方法很酷，即在更改项目后实际返回项目，它允许方法链接。这意味着您可以执行以下操作：

```
c.ModifyIt("hello").MessWithIt("World").ReallyScrewWithIt("!!!"); 
```

如果它对您可以预见需要链接的特定类有意义，则返回该实例。如果没有，那么您可以将其设为无效。一个很好的例子是 StringBuilder 类，它允许您执行以下操作：

```
myStringBuilder.Replace("!", "?").Append("Something").Remove(4,3); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T05:47:12.047

我个人更喜欢构建一个像 ModifyIt 这样的函数，如果可能的话，把它放在我正在创建的类上。我这么说的原因是在这两种方法中我都在修改调用变量，因为我通过引用传递它。当然，我不能对所有函数都这样做，但是将 ref 放在函数调用中有助于澄清我是通过引用传递变量，而不是通过值传递变量。例子：

```
public Class ModifyIt(ref Class c) 
```

为什么？因为当我回来阅读我通过引用传递值的代码时，我很可能会忘记，然后更有可能对代码做一些“坏”的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T05:13:13.187

首先，如果您只是更改一个属性，我根本不会有单独的修改功能；我只是直接更改属性。顺便说一句，让我们假设您正在给出一个更复杂的简单示例，修改函数内部可能有几个不同的更改。

我会使用返回“类”对象的那个。它使您可以将多个呼叫链接在一起。同样，我假设这是一个实际上更复杂的系统的简单示例；假设您有 MakeModification()、MakeAnotherModification() 和 MakeAThirdModification()。如果您返回“类”对象，您可以获得以下语法细节：

```
Class c = new Class();
c.MakeModification().MakeAnotherModification().MakeAThirdModification(); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T05:15:57.067

实际上我更喜欢第二种风格，因为该方法是一个 mutator，因此，预计不会返回新值，而是预计会修改实际值。但是，您可能需要指出 ModifyIt 接受一个 ref 变量，以表明实际的 c 将被修改。这里的c是按值传递的，虽然是引用类型，但是按值传递引用类型和通过ref传递引用类型还是有区别的。请参阅以下内容：

```
public void ModifyIt(Myclass c) { c = new MyClass(); } 
```

在上述情况下，c 变量将按值传递（即，将传递并修改引用的副本以指向新实例化的对象，这反过来意味着在这种情况下您将拥有两个 MyClass 类型的对象。这里是一个例子来说明：

```
Myclass s = new MyClass () { prop = "value" }; ModifyIt(s); Console.WriteLine(s.prob); // this will print "value" 
```

虽然 MOdifyIT 将引用实例化为一个新对象，这应该意味着 prob 将被初始化为 null，但它实际上并没有实例化 s，它实例化了 s 的副本。与 s 由 ref 传递的情况不同。
希望这可以帮助！

# ruby-on-rails - 如何在 Rails 中实现动态 404、500 等错误页面？

> ID：943138
> 
> 赞同：7
> 
> 时间：2009-06-03T05:02:24.743
> 
> 标签：ruby-on-rails, ruby

如何在 Rails 中实现动态的自定义错误页面？

例如，使用您的 application.html.erb 布局和页面中的一些动态字段的自定义 404 错误页面。

另外，如何从本地机器测试这个？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-02-10T13:52:56.507

我在谷歌上查看了一些关于如何做到这一点的博客文章，不幸的是，大多数似乎都依赖于污染你的 ApplicationController。

我所做的是创建一个带有 404 消息的模板，然后使用该模板从 rake 任务中更新 public/404.html 文件：

```
# Rake file to generate static 404 page

file "public/404.html" => ["app/views/layouts/application.html.erb"] do |t|
    print "Updating 404 page\n"
    `curl --silent http://locahost/content/error404 -o public/404.html`
end 
```

现在，每当我更新我的全局布局时，404 页面都会自动更新。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-03T09:04:00.357

只需将以下内容添加到您的 ApplicationController：

```
 rescue_from ActiveRecord::RecordNotFound, :with => :render_record_not_found

  # Catch record not found for Active Record
  def render_record_not_found
    render :template => "shared/catchmissingpage", :layout => false, :status => 404
  end

  # Catches any missing methods and calls the general render_missing_page method
  def method_missing(*args)
    render_missing_page # calls my common 404 rendering method
  end

  # General method to render a 404
  def render_missing_page
    render :template => "shared/catchmissingpage", :layout => false, :status => 404
  end 
```

您可以自定义渲染调用（使用您的模板，使用布局等）并以这种方式捕获错误。现在它会为您捕获缺少的方法和 record_not_found，但也许在某些情况下您想要显示 500 错误页面，因此您可以继续使用此方法并使其适合您。

对于从本地机器进行测试，它就是这样工作的。如果您只希望它在生产模式下工作，请添加

```
 if ENV['RAILS_ENV'] == 'production' 
```

你很好。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T05:56:30.690

检查[Henrik Nyh 的帖子](http://henrik.nyh.se/2008/07/rails-404)。其他的也可以通过谷歌找到。

背后的想法：Rails 似乎呈现`public/404.html`404 错误。

*   如果要显示静态字段，则可以覆盖页面
*   对于动态内容，您似乎可以覆盖框架方法来挂钩并重定向以呈现您的动态页面。

`ActionController::Rescue`定义一个`rescue_action_in_public`调用`render_optional_error_file`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-05T14:23:37.853

如果您决定创建动态 404（或其他状态代码）页面，请务必从`/public`（如果存在）中删除相应的 html 文件

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-09-17T07:06:50.663

在测试方面，一个非常好的方法（至少出于开发目的）是使用Passenger并将rails环境设置为生产环境（或在站点配置中注释掉“RailsEnv development”）。至少通过这种方式，您可以模仿它在生产中的工作方式。

但是，为了完成这项工作，我有各种设置文件，它们在启动时被解析并根据环境被拾取。其中一项设置是是否显示错误页面（AppSettings.show_page_errors？）。然后在我的应用程序控制器中，我有

```
 if !AppSettings.show_page_errors?
    alias_method :rescue_action_locally, :rescue_action_in_public
  end 
```

所以，它通常设置为默认设置，但有时我真的需要看看到底发生了什么，所以我可以在生产时将其关闭。

另一个步骤是使用自定义页面。就我而言，我有基于错误的模板，其中还包括要提交到谷歌表单的表单（因为我的服务器可能已损坏）。为此，请将其（并根据需要进行更改）放入您的应用程序控制器中：

```
def render_optional_error_file(status_code)
  status = interpret_status(status_code)
  render :template => "/errors/#{status.to_s[0,3]}.html.haml", :status => status, :layout => 'application.html.haml' if [404, 422, 500].include?(status)
  render :template => "/errors/unknown.html.haml", :status => status, :layout => 'application.html.haml' unless [404, 422, 500].include?(status)
end 
```

这将使用模板呈现状态代码 404、422 和 500，否则它将使用未知。如果需要处理其他的，只需要更新这个方法，添加模板即可。

# http - HTTP 书籍推荐？

> ID：943139
> 
> 赞同：15
> 
> 时间：2009-06-03T05:03:06.443
> 
> 标签：http, rest

我看到和使用 REST 的次数越多，它似乎就越像是对 HTTP 背后思想的重新迭代。有很多书都在谈论 REST - HTTP 呢？

关于 HTTP 本身背后的想法和技术细节的最好的书是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T05:14:22.887

[HTTP：权威指南](http://oreilly.com/catalog/9781565925090/)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-03T05:09:04.347

[RESTful Web 服务](http://www.crummy.com/writing/RESTful-Web-Services/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-04T05:41:28.703

我建议阅读 RFC 规范文档。它们写得很好，而且这些书通常只是对它们的掩饰。

(Sir) Tim Berners-Lee 编写[了原始的 RFC 1945 HTTP/1.0 文档](http://www.ietf.org/rfc/rfc1945.txt)。初读时跳过更深奥的部分。

该协议现在在版本[HTTP/1.1](http://www.w3.org/Protocols/rfc2616/rfc2616.html)上。

在你读一本书的时间里，你可以读三四遍 RFC，了解如何才能很好地掌握它们。:-)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-30T11:43:11.680

今天有一本书涵盖了 REST api 的所有级别，它们介绍了超媒体的概念，一种让您的应用程序 api 与其他计算机应用程序对话的语义方式。

这是吉姆·韦伯、萨瓦斯·帕拉斯塔蒂迪斯和伊恩·罗宾逊写的一本优秀的书，叫做：

[REST 实践：超媒体和系统架构](https://rads.stackoverflow.com/amzn/click/com/0596805829)

# excel - 在没有 GUI 的情况下将 Excel (xls) 文件转换为逗号分隔 (csv) 文件

> ID：943153
> 
> 赞同：21
> 
> 时间：2009-06-03T05:12:39.833
> 
> 标签：excel, scripting, csv

有没有一种简单的方法可以在不启动 Excel 窗口应用程序的情况下将 XLS 转换为 CSV 格式的文件？

我需要使用脚本处理一些 Excel XLS 工作簿。为此，我需要将 xls 文件转换为 csv 文件。这可以通过 Excel 应用程序中的另存为来完成。但是，我想自动化这个（所以，不要打开 Excel 应用程序窗口）。

如果工作簿中的第一张工作表被翻译成 CSV 格式就足够了。我只需要处理该表中的数据。

我的系统上安装了 Cygwin 和 Excel——如果有帮助的话。

编辑：好的，我有一个使用 Perl 的工作解决方案。更新以供其他人将来使用。

我安装了**Spreadsheet::ParseExcel**模块。然后使用[read-excel.pl](http://www.perlmonks.org/?node_id=170743)示例。

我的代码是这个示例代码的轻微变化，如下所示。

```
#!/usr/bin/perl -w
# For each tab (worksheet) in a file (workbook),
# spit out columns separated by ",",
# and rows separated by c/r.

use Spreadsheet::ParseExcel;
use strict;

my $filename = shift || "Book1.xls";
my $e = new Spreadsheet::ParseExcel;
my $eBook = $e->Parse($filename);
my $sheets = $eBook->{SheetCount};
my ($eSheet, $sheetName);

foreach my $sheet (0 .. $sheets - 1) {
    $eSheet = $eBook->{Worksheet}[$sheet];
    $sheetName = $eSheet->{Name};
    print "#Worksheet $sheet: $sheetName\n";
    next unless (exists ($eSheet->{MaxRow}) and (exists ($eSheet->{MaxCol})));
    foreach my $row ($eSheet->{MinRow} .. $eSheet->{MaxRow}) {
        foreach my $column ($eSheet->{MinCol} .. $eSheet->{MaxCol}) {
            if (defined $eSheet->{Cells}[$row][$column])
            {
                print $eSheet->{Cells}[$row][$column]->Value . ",";
            } else {
                print ",";
            }
        }
        print "\n";
    }
} 
```

* * *

**更新**：这是一个 Powershell 脚本，可能也很容易使用；来自[这个 MSDN 博客](http://blogs.msdn.com/krishkp/archive/2008/03/06/powershell-script-to-access-an-excel-file.aspx) [和 SO Reference](https://stackoverflow.com/questions/1021039/read-a-value-from-a-xls-file-using-bat-files)的原样。

```
$excel = New-Object -comobject Excel.Application
$workbooks = $excel.Workbooks.Open("C:\test.xlsx")
$worksheets = $workbooks.Worksheets
$worksheet = $worksheets.Item(1)
$range = $worksheet.UsedRange
foreach($row in $range.Rows)
{
    foreach($col in $row.Columns)
    {
        echo $col.Text
    }
} 
```

* * *

更新：我最近在这个[超级用户答案](https://superuser.com/questions/54356/program-to-display-csv-nicely-from-clipboard/54362#54362)中遇到了一个 Windows 工具[**CSV**](http://csved.sjfrancke.nl/index.html) ，它可能对某些人有用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-10-13T12:06:41.467

如果你在 Debian/Ubuntu 上，你可以使用 catdoc 包中的 xls2csv

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T05:56:34.917

在 Java 世界中，您可以使用 apache poi。您可以从以下 Groovy 代码段开始。

```
FileInputStream fis = new FileInputStream(filename);
Workbook wb = new HSSFWorkbook(fis); 
Sheet sheet = wb.getSheetAt(0);
for (Row row : sheet) {
  for (Cell cell : row) {
    doSomething(cell.toString())
  }

} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-10-03T07:04:01.850

来自[Gnumeric 文档](https://help.gnome.org/users/gnumeric/stable/gnumeric.html#sect-files-ssconvert)：

> Gnumeric 可以自动转换文件，无需用户干预。这允许使用脚本转换大量文件。Gnumeric 与一个名为的程序一起分发，`ssconvert`该程序用于自动转换文件。Gnumeric 支持的所有文件格式都可以使用，除了通过打印系统运行的 Postscript 和 PDF 文件格式。
> 
> 通过指定任何所需的选项、输入文件和输出文件，从命令行使用此应用程序。例如，
> 
> ```
> ssconvert myfile.xls myfile.gnumeric 
> ```
> 
> 会将 Excel 格式文件转换为 Gnumeric 格式文件。
> 
> 可以使用列出 ssconvert 可以读取的可用导入和导出文件格式
> 
> ```
> ssconvert --list-importers 
> ```
> 
> 或者
> 
> ```
> ssconvert --list-exporters 
> ```
> 
> 分别。
> 
> 与其他 GNU 命令行应用程序一样，ssconvert 包含一个手册页。可以通过键入以下内容访问此页面：
> 
> ```
> man ssconvert 
> ```
> 
> 这将打开手册页。可以通过键入空格键或使用 Page Up 和 Page Down 按钮来导航此页面。可以通过键入 q 键来关闭 man 程序。

我正在使用它并且效果很好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T05:54:58.697

使用 perl 脚本。使用来自 CPAN 的 Spreadsheet::ParseExcel perl 模块来解析 xls 文件，然后输出为 csv 应该可以正常工作。

[http://search.cpan.org/dist/Spreadsheet-ParseExcel](http://search.cpan.org/dist/Spreadsheet-ParseExcel)

您也可以尝试使用 VBScript。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T05:35:41.893

使用可移植的 [Python] 库之一：

pyxlreader.sourceforge.net/

sourceforge.net/projects/pyexcelerator

并在其上制作额外的脚本层。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T05:42:18.920

Excel 可用作数据源，并且有驱动程序可用于访问 EXCEL 作为数据库。

1.) 创建并打开要转换为 CSV 的 EXCEL 文件的连接。

2.) 触发类似“SELECT * From Sheet1”的查询，它将把 Sheet1 的所有数据加载到记录集或数据表中。

3.）由于我使用的是 .net，我可以将这些记录保存在数据表上，并使用以下扩展方法转换为 CSV。

```
 public static string ToCSV(this DataTable _dataTable)
        {
            StringBuilder csv = new StringBuilder();
            StringWriter sw = new StringWriter(csv);
            int icolcount = _dataTable.Columns.Count;
            for (int i = 0; i < icolcount; i++)
            {
                sw.Write(_dataTable.Columns[i]);
                if (i < icolcount - 1)
                {
                    sw.Write(",");
                }
            }
            sw.Write(sw.NewLine);
            foreach (DataRow drow in _dataTable.Rows)
            {
                for (int i = 0; i < icolcount; i++)
                {
                    if (!Convert.IsDBNull(drow[i]))
                    {
                        sw.Write(drow[i].ToString());
                    }
                    if (i < icolcount - 1)
                    {
                        sw.Write(",");
                    }
                }
                sw.Write(sw.NewLine);
            }
            sw.Close();
            return csv.ToString();
        } 
```

> **您可以在您正在使用的平台上应用这种方法。**

谢谢。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-06-01T15:16:48.973

VBS 脚本，它的工作很棒 [http://www.go4expert.com/forums/showthread.php?t=18188](http://www.go4expert.com/forums/showthread.php?t=18188)

将 objArgs = WScript.Arguments For I = 0 设置为 objArgs.Count - 1

```
FullName = objArgs(I)
FileName = Left(objArgs(I), InstrRev(objArgs(I), ".") )

Set objExcel = CreateObject("Excel.application")
set objExcelBook = objExcel.Workbooks.Open(FullName)

objExcel.application.visible=false
objExcel.application.displayalerts=false

objExcelBook.SaveAs FileName & "csv", 23

objExcel.Application.Quit
objExcel.Quit   

Set objExcel = Nothing
set objExcelBook = Nothing 
```

下一个

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T05:23:01.753

推荐转换 XLS： http: [//www.softinterface.com/Convert-XLS%5CConvert-XLS.htm](http://www.softinterface.com/Convert-XLS%5CConvert-XLS.htm)

' Convert XLS ' 是一个简单易用但复杂的 Excel 转换器实用程序，专为 Excel、文本和 CSV（字符/逗号分隔）文件而设计。如果您需要转换/操作位于一个或多个文件夹中的一个或数千个文件，这就是工具！如果没有 MS Excel，转换速度可以提高 10-15 倍。

使用以下工具自动执行 Excel 转换任务：

*   内置调度器
*   命令行
*   接口 COM接口

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T06:21:50.977

如果你有 Cygwin，很可能你会拥有 Python。如果不安装 python 并使用此 [脚本](http://sujitpal.blogspot.com/2007/02/python-script-to-convert-csv-files-to.html)。它比您需要的要多得多，但可以轻松快速地转换。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-11T22:38:30.930

@John Machin：我不能添加评论，因为我是这个论坛的新手 :)

我没有使用旧包**pyXLreader**，但在发帖时要考虑**xlrd** ;)

我在一个月前看到了它，但没有在项目中使用。

WBR

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-26T21:33:38.467

我对这些论坛很陌生，如果他们把年份放在时间戳上会很好（宠物小毛病），这样我就知道帖子的年龄了。我会假设它们是从 2009 年开始的。

但是在 python 中一个好的解决方案是使用 xlrd 来读取你的 xls 文件。这是一个非常简单的介绍教程： [http](http://scienceoss.com/read-excel-files-from-python/) ://scienceoss.com/read-excel-files-from-python/ 它不是我的。

我唯一的问题是excel日期。这是他们的快速修复：

date = xlrd.xldate_as_tuple(int(sheet.cell(rowNum,colNum).value),workBookName.datemode)

而不是使用内置的 csv 模块创建一个 csv 文件，因为我是一个新用户，我只能发布一个超链接。但谷歌 csv 模块 api。

希望这有帮助

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-01-31T13:25:17.453

我的解决方案：

```
use Spreadsheet::BasicRead;

my $xls = 'file.xls';   
my $csv = 'file.csv';

   my $ss = new Spreadsheet::BasicRead($xls) or die "Could not open '$xls': $!";
   my $name = '';
   my $row = 0;

   open(FILE, ">$csv") or die "Could not open : $!\n";
      flock(FILE, 2) or die "Could not lock file\n"; 

        while (my $data = $ss->getNextRow()){
            $row++;
            $name = join(';',@$data);         
            print FILE $name."\n" if ($name ne "");
        }

      flock(FILE, 8); 
   close FILE; 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-12-21T16:21:29.053

您可以使用 Alacon - [Alasql](http://github.com/agershun/alasql)数据库的命令行实用程序来完成。

它适用于 Node.js，因此您需要安装[Node.js](http://nodejs.org/)，然后安装[Alasql](https://www.npmjs.com/package/alasql)包：

```
> npm install alasql 
```

要将 Excel 文件转换为 CVS (ot TSV)，您可以输入：

```
> node alacon "SELECT * INTO CSV('mydata.csv', {headers:true}) FROM XLS('mydata.xls', {headers:true})" 
```

Alacon 支持其他类型的转换（CSV、TSV、TXT、XLSX、XLS）和 SQL 语言结构（有关示例，请参见[用户手册](http://www.slideshare.net/AndreyGershun/alasql-manual-141220-1?qid=0351eced-b529-4e96-99a3-062e02ccb704&v=qf1&b=&from_search=1)）。

# gwt - GWT 视图随着浏览器调整大小而缩小

> ID：943158
> 
> 赞同：1
> 
> 时间：2009-06-03T05:14:32.030
> 
> 标签：gwt, gwt-ext

我将 GWT 与 GWT-Ext 一起使用。我设计了一个带有表格和几个按钮的简单面板。在浏览器中，一切看起来都很完美。当我缩小浏览器的大小时，我的整个视图也会缩小，而不是浏览器应该显示垂直和水平滚动条。有什么我可以在这里做的吗？或者这种行为是预期的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T08:29:38.057

此行为取决于您的布局，最终只是 HTML。

如果您使用的是 FlowPanel，那么内容将被调整大小。Horizo​​ntalPanel 的作用相同。另一方面 AbsolutePanel*应该*给你相当多的静态定位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-09T15:36:30.637

即使您使用[setWidth(String width)](http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/ui/UIObject.html#setWidth(java.lang.String))方法为[SimplePanel指定宽度，也会发生这种情况吗？](http://google-web-toolkit.googlecode.com/svn/javadoc/1.6/com/google/gwt/user/client/ui/SimplePanel.html#methods_inherited_from_class_com.google.gwt.user.client.ui.UIObject)

# c# - 什么是 ASP.NET Web 应用程序的推荐架构？

> ID：943165
> 
> 赞同：2
> 
> 时间：2009-06-03T05:16:15.273
> 
> 标签：c#, asp.net, vb.net, architecture

在这个问题的第一条评论（JW）中：

[使用 ObjectDataSource 和 DataObjectTypeName，你如何处理只有一个 id 参数的删除方法？](https://stackoverflow.com/questions/913571/using-objectdatasource-and-dataobjecttypename-how-do-you-handle-delete-methods-w),

据说使用 ObjectDataSource 是一个糟糕的设计。

对于架构良好的 ASP.NET 应用程序来说，什么是好的设计？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T05:58:46.457

这是 asp.net 应用程序架构的终极资源。[Imaar](http://imar.spaanjaars.com)写了几本关于 ASP.NET 的书籍，他发表了 2 个关于如何构建您的 asp.net 应用程序的系列文章。[一个系列](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=416)适用于 ASP.NET 2.0，[另一个系列](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=476)适用于 ASP.NET 3.5

**链接文本 1： http:** [//imar.spaanjaars.com/QuickDocId.aspx ?quickdoc=416](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=416)

**链接文本 1： http:** [//imar.spaanjaars.com/QuickDocId.aspx ?quickdoc=476](http://imar.spaanjaars.com/QuickDocId.aspx?quickdoc=476)

并且相信我 ObjectDataSource 摇滚。用起来没毛病，能玩好就行。

谢谢。

# c - 如何将 C 中的源代码拆分为单独的文件？

> ID：943170
> 
> 赞同：4
> 
> 时间：2009-06-03T05:20:33.927
> 
> 标签：c

我正在尝试阅读其他人的代码，但大多数代码都被分解成单独的文件。我还没学会怎么做。如何将代码拆分为单独的文件？以及如何为函数找到正确的源代码文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T05:25:02.390

关键技术是使用“头文件”（又名`.h`文件）来公开每个“源文件”（即文件）的“应该从外部可见”部分`.c`。要跨多个文件查找源代码，请参阅[ctags](http://ctags.sourceforge.net/)，除非您使用的 IDE 提供了更好的方法！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T05:32:37.310

您的函数可以在“.h”文件（也称为“头文件”）中声明（即函数返回类型、名称和参数类型）。

这些函数已定义（即您为函数编写的代码）应该在“.c”文件中。

该“.c”文件的顶部应该有一个*包含指令。*它看起来像这样：

```
#include "myHeaderFile.h" 
```

现在，要在 Linux/Mac/Windows+cygwin 中找到正确的函数源代码，我只需在命令提示符下使用 grep：

```
grep functionName *.c 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T05:28:57.957

研究使用 #include 预处理器指令。#include 基本上是在您放置它的行中插入您指定的文件的副本。这允许您将源代码模块化到多个文件中，然后将它们全部编译在一起。

见： http: [//msdn.microsoft.com/en-us/library/36k2cdd4 (VS.71).aspx](http://msdn.microsoft.com/en-us/library/36k2cdd4(VS.71).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T05:43:18.887

关于 ctags 和 cscope 的快速说明。

如果您的代码位于名为 src/ 的目录中，您可以执行此操作

```
#!/bin/sh
find src/ -name '*.c' >  cscope.files
find src/ -name '*.C' >> cscope.files
find src/ -name '*.h' >> cscope.files
find src/ -name '*.H' >> cscope.files
ctags -R -V --c-kinds=+p --fields=+S -L cscope.files 
cscope -b 
```

现在你使用 ctags 和 vim 并直接跳转到一个名为 main 的函数：

```
gvim -t main 
```

您可以在其他问题中找到其他一些很好的问题，因此我不会对此进行更深入的讨论。

*   [Vim 和 Ctags 提示和技巧](https://stackoverflow.com/questions/563616/vimctags-tips-and-tricks)
*   [什么是帮助浏览/遵循 C 代码的好工具？](https://stackoverflow.com/questions/68247/what-is-a-good-tool-to-aid-in-browsing-following-c-code)

/约翰

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T05:43:37.700

单个源文件应包含一组（最好是密切相关的）相关函数。它应该为源文件之外的功能提供一组连贯的服务。

源文件应该有一个与之关联的标头，用于声明源代码提供的服务。（例外：包含`main()`但不提供其他文件使用的函数的单个源文件不需要头文件。）

使用这些函数的其他文件包括标题。定义函数的文件还包括头文件，以确保定义与声明匹配。

一般来说，源文件首先包含头文件是个好主意；这确保了标头可以“独立”使用。也就是说，如果其他一些源文件需要使用头文件的服务，它可以包含头文件，而不必担心应该先包含哪些其他头文件。

# c# - 在 c# 中的用户控件中公开和引发子控件的事件

> ID：943171
> 
> 赞同：25
> 
> 时间：2009-06-03T05:20:51.193
> 
> 标签：c#, winforms, user-controls, childcontrol

你好。我有一个包含文本框的 UserControl。我想访问文本框的 textchanged 事件，但在用户控件的事件属性中，我看不到文本框的事件。如何使用 C# 在 Winforms 中公开公开的 UserControl 公开和处理子控件的特定事件。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-03T05:28:39.750

如果您愿意，您可以显示一个新事件并将任何订阅直接传递给控件：

```
public class UserControl1 : UserControl 
{
    // private Button saveButton;

    public event EventHandler SaveButtonClick
    {
        add { saveButton.Click += value; }
        remove { saveButton.Click -= value; }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T05:24:36.790

将整个 TextBox 公开为用户控件中的公共属性，并以您希望的方式订阅它的事件。
例子：

```
class myUserControl: UserControl { 
private TextBox _myText;
public TextBox MyText { get {return _myText; } } 
```

}

完成此操作后，您可以订阅它的任何事件，如下所示：

```
theUserControl.MyText.WhatEverEvent += ... 
```

希望这可以帮助！

# asp.net - 自动点击超链接

> ID：943180
> 
> 赞同：0
> 
> 时间：2009-06-03T05:23:20.317
> 
> 标签：asp.net, jquery

如何使用 jQuery 自动单击 Hyerlink 或 LinkBut​​ton

```
<asp:Hyperlink id="ttt" PostBackUrl="Hut.htm">Click</asp:Hyperlink>or<asp:LinkButton id="ttt" PostBackUrl="Hut.htm">Click</asp:LinkButton> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T05:28:56.160

您可以使用不带任何参数的[jQuery click()函数来模拟用户点击。](http://docs.jquery.com/Events/click)

asp.net 控件唯一棘手的部分是 ID 将是一些笨拙的生成 ID，例如 ctr_00_0001，因此您必须使用一个类来定位按钮：

```
<asp:LinkButton id="ttt" PostBackUrl="Hut.htm" CssClass="myButton">Click</asp:LinkButton> 
```

和 jQuery：

```
$('.myButton').click(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T09:35:36.253

在 LinkBut​​ton 上调用 click 事件（呈现 html 链接）不会有太大影响，除非您手动定义了一个 javascript click 事件。

您需要执行 href 属性中的内容（*javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions("ctl00$phContent$ttt", "", true, "", "", false, true))*）：

> `eval($("a[id*='ttt']").attr("href"))`

上面的代码将评估 href 属性中的 javascript 代码并执行它。

# javascript - 使用 ajax 解析 xml 命名空间

> ID：943183
> 
> 赞同：0
> 
> 时间：2009-06-03T05:24:45.807
> 
> 标签：javascript, xml, ajax, url, namespaces

```
<item>
<guid>http://jahboo.fliggo.com/video/kPZj01cs</guid>
<pubDate>Tue, 10 Mar 2009 18:31:38 -0500</pubDate>
<title>How to be perverted with water proof cam</title>
<author>Jennisita@fliggo</author>
<link>http://jahboo.fliggo.com/video/kPZj01cs</link>
<description>
    This vid shows how easy it is to make perverted vids with a water proof cam. Kids don&apos;t try this @ home.   <![CDATA[ <object width="425" height="355"><param name="movie" value="http://jahboo.fliggo.com/embed/kPZj01cs"></param><param name="wmode" value="window"></param><param name="allowscriptaccess" value="always"></param><param name="allowfullscreen" value="yes"></param><embed src="http://jahboo.fliggo.com/embed/kPZj01cs" type="application/x-shockwave-flash" wmode="window" allowscriptaccess="always" allowfullscreen="yes" width="425" height="355"></embed></object> ]]> </description>
<media:group>
    <media:title>How to be perverted with water proof cam</media:title>
    <media:content url="http://static.fliggo.com/content/k/P/16119.flv" type="video/flv" bitrate="450" fileSize="0" framerate="0" duration="29" height="400" width="300" />
    <media:player url="http://jahboo.fliggo.com/embed/kPZj01cs" height="400" width="300" />
    <media:credit role="author">Jennisita</media:credit>
    <media:thumbnail url="http://static.fliggo.com/content/k/P/16119-158-large.jpg" />
    <media:text type="plain">This vid shows how easy it is to make perverted vids with a water proof cam. Kids don&apos;t try this @ home.</media:text>  
</media:group> 
```

我想解析以下 xml 数据。我想从 media:thumbnail 命名空间中检索数据并访问该命名空间中的 url 属性。有什么工具或教程可以指导我这样做吗？谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T06:11:42.147

所以，你想用 JavaScript 来做这件事。

[DOM 级别 2](http://www.w3.org/TR/DOM-Level-2-Core/)具有处理名称空间的方法，但不幸的是 Internet Explorer 不支持这些方法。

所以你有以下选择：

1.  不支持IE。
2.  使用 DOM 级别 1 方法编写忽略名称空间的代码。
3.  查找支持命名空间的 JavaScript XML 库。
4.  开发您自己的 JavaScript XML 库。
5.  只需使用正则表达式来提取这些字符串。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-03T06:19:49.247

你应该**阅读**这个，网上有[很多](http://www.google.com/search?q=javascript%2Bxml%2Bparse&btnG=Searrrch)关于这个的例子......

start with the basics, **[JasvaScript & XML](http://www.webreference.com/programming/javascript/definitive2/index.html)** by David Flanagan, it covers **how to create**, **read**, **load** xml synchronous and asynchronous, and **parse** the XML data... and even **convert** XML into a html table.

# unit-testing - 如何为 OR 关系条件应用“每个测试一个断言”

> ID：943189
> 
> 赞同：4
> 
> 时间：2009-06-03T05:27:33.450
> 
> 标签：unit-testing, assert

断言中的“每个测试一个断言”是公认的。写断言不好如下：</p>

```
 Assert((foo != null) && (bar != null)); 
```

更好的选择是：

```
 Assert(foo != null);
  Assert(bar != null); 
```

问题是如果断言是：

```
 Assert((foo == null) || (foo.length == 0)); 
```

关系是 OR 而不是 AND。

有没有办法在保持逻辑的同时做出“每个测试一个断言”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T05:45:14.047

该指南背后的想法是，您只在一次测试中测试一件合乎逻辑的事情（在某些情况下可能归结为**几个断言）。**因此，如果测试失败，您就会知道失败的确切原因，并且可以快速进入特定的代码块。借用[这个页面](http://www.artima.com/weblogs/viewpost.jsp?thread=35578)的一个例子，如果以下测试失败，我知道在地址类型中如何提取/确定国家/地区有问题。

```
public void testCountry() throws Exception {
        assertEquals("COUNTRY",  anAddress.getCountry());
    } 
```

将此与具有多个断言的测试版本进行比较，它可能由于多种原因而失败（除非您使用有用的断言消息），否则您需要**调试测试**（糟糕！）。

我需要看看你的完整测试。从它所看到的情况来看，您似乎正在检查集合中是否存在未找到的场景。在这种情况下，建议返回一个空集合，以便客户端不必检查 null。由于您的测试也是客户端，因此它的生活也变得更简单：`Assert.AreEqual (0, foo.length)`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T05:54:36.903

问题不在于断言，而在于测试用例的[排列或动作部分：当您进行单元测试时，您会在](http://c2.com/cgi/wiki?ArrangeActAssert)**受控环境**中调用一小段代码。也就是说，您应该知道被测软件的行为方式，从而知道它会返回空指针还是空字符串。**每项测试都应有一个预期结果**。

... 除非您针对多个行为不同的函数/方法或某些第三方代码在不同情况下表现不同的函数/方法使用您的测试。如果是这种情况，“每个规则一个断言”只是一个指导方针，您可以使用问题所示的断言。如果此测试失败，则意味着返回的 foo 是一个非空字符串。

或者，您可以创建一个函数来测试空字符串，该函数还将测试字符串指针是否不为空：

```
Assert(is_empty_string(foo)); 
```

您的语言字符串类可能会提供此方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T05:30:52.993

当然：一项测试确保空 foo 断言，一项确保长度为 0 的非空 foo 也失败（而其他测试则检查 foo 不为空*且*长度为 != 0 的情况）。比检查 AND 有什么好处？

编辑：根据要求的伪代码...：

```
 should_assert(themethod(foo=null))
  fakefoo = fakewhatever(length=0)
  should_assert(themethod(foo=fakefoo))
  ...rest of tests w/foo not null, w/length != 0 
```

例如，在带有 Still-pseudocode 的 Python 单元测试中`mock`，这可能是：

```
 self.assertRaises(AssertionError, theobj.themethod, null)
  fakefoo = mock.makeObj(length=0)
  self.assertRaises(AssertionError, theobj.themethod, fakefoo))
  ...rest of tests w/foo not null, w/length != 0 
```

# c - 为什么这段代码修改字符串不起作用？

> ID：943191
> 
> 赞同：5
> 
> 时间：2009-06-03T05:28:17.770
> 
> 标签：c, pointers, char, segmentation-fault, access-violation

使用 c 风格的字符串，如何将 char 分配给字符指针指向的内存地址？例如，在下面的示例中，我想将 num 更改为“123456”，因此我尝试将 p 设置为 '0' 所在的数字，并尝试用 '4' 覆盖它。谢谢。

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
    char* num = (char*)malloc(100);
    char* p = num;

    num = "123056";

    p = p+3;    //set pointer to where '4' should be
    p = '4';

    printf("%s\n", num );

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T05:35:09.303

首先，当你这样做时：

```
num = "123056"; 
```

您没有将字符串“123056”复制到由`malloc()`. 在 C 中，为指针分配一个`char *`字符串字面值相当于将其设置为一个常量 - 即等同于：

```
char str[] = "123056"; 
```

所以，你刚刚完成的是你放弃了对 100 字节堆区域的唯一引用`malloc()`，这就是为什么你的后续代码没有打印正确的值；' `p`' 仍然指向`malloc()`（因为`num`在分配时指向它）分配的堆区域，但`num`不再指向。

我假设您实际上打算将字符串“123056”*复制*到该堆区域中。以下是如何做到这一点：

```
strcpy(num, "123056"); 
```

虽然，出于多种原因，这是更好的做法：

```
strncpy(num, "123056", 100 - 1);  /* leave room for \0 (null) terminator */ 
```

如果您刚刚完成：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int     main(void) {
        char    *num = malloc(100);
        char    *p = num;

        strncpy(num, "123056", 100 - 1);

        p = p + 3;
        *p = '4';

        printf("%s\n", num);

       return 0;
} 
```

你会得到正确的结果：

```
123456 
```

您可以收缩此操作：

```
p = p + 3;
*p = '4'; 
```

...并通过如下方式避免迭代指针：

```
*(p + 3) = '4'; 
```

其他一些注意事项：

*   `malloc()`尽管常见的风格实践，强制转换to的返回值`(char *)`是不必要的。类型的转换和对齐`void *`由 C 语言保证。

*   总是检查的返回值`malloc()`。如果堆分配失败（即您的内存不足），它将为 NULL，此时您的程序应该退出。

*   根据实现，分配的内存区域`malloc()`在某些情况下可能包含陈旧垃圾。在分配后将其归零总是一个好主意：

    ```
    memset(num, 0, 100); 
    ```

*   永远不要忘记`free()`你的堆！在这种情况下，程序会退出，操作系统会清理你的垃圾，但如果你不养成这种习惯，你很快就会发生内存泄漏。

因此，这是“最佳实践”版本：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int     main(void) {
        char    *num, *p;

        /*
         * Don't take 1-byte chars for granted - good habit to get into.
         */

        num = malloc(sizeof(char) * 100);

        if(num == NULL)
                exit(1);

        memset(num, 0, sizeof(char) * 100);

        p = num;

        strncpy(num, "123056", 100 - 1);

        *(p + 3) = '4';

        printf("%s\n", num);

        free(num);

        return 0;
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-03T05:40:11.573

该代码不起作用，仅仅是因为该行：

```
num = "123056"; 
```

更改`num`为指向远离分配的内存（并且`p`仍然指向该内存，因此它们不再是相同的位置）到最有可能的只读内存。您不允许更改属于字符串文字的内存，这是未定义的行为。

您需要以下内容：

```
#include <stdio.h>
#include <stdlib.h>
int main (void) {
    char *num = malloc (100); // do not cast malloc return value.
    char *p = num;

    strcpy (num, "123056");   // populate existing block with string.

    p = p + 3;                // set pointer to where '0' is.
    *p = '4';                 // and change it to '4'.

    printf ("%s\n", num );    // output it.

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T05:38:37.457

除了其他人指出的 *p 问题外，您还有内存使用问题。您有一个 100 字节的缓冲区，内容未知。您还有另一个 7 字节的缓冲区，其中包含字符串“123056”和一个空终止符。你这样做：

1.  num 设置为指向 100 字节的缓冲区
2.  p 设置为指向 num；即，它指向 100 字节的缓冲区
3.  您将 num 重置为指向 7 字节缓冲区；p 仍然指向 100 字节的缓冲区
4.  您使用 p 修改 100 字节缓冲区
5.  然后您使用 num 打印出 7 字节缓冲区

因此，您打印的缓冲区与您正在修改的缓冲区不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T05:32:04.193

只需使用`*p = '4';`...！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T05:36:53.453

好吧，你知道 p 是指针类型。它存储 char '0' 的地址。如果您为 p 分配“4”的值。它将以“4”作为地址。但是，地址“4”是非法的。您可以使用 '*' 运算符来获取存储在 p 中的地址的值 stored 。

# c# - 截取 C# webbrowser 的超链接

> ID：943205
> 
> 赞同：3
> 
> 时间：2009-06-03T05:32:54.660
> 
> 标签：c#, windows-mobile, webbrowser-control

我在 C#.NET CF 中有一个 webbrowser 控件。

当用户单击超链接时，我不会尝试导航到指定的 URL，而是如何显示存储在内存中的 html 内容片段？

我试过以下

```
//page doesnt refresh
private void webBrowser_Navigating(object sender, WebBrowserNavigatingEventArgs e)
{
    if (e.Url.Host != String.Empty) {
       e.Cancel = true;
       webBrowser.DocumentText = "<html> some text </html>";
    }
}

//some text appears but then the original page is loaded up
private void webBrowser_Navigating(object sender, WebBrowserNavigatingEventArgs e)
{
    if (e.Url.Host != String.Empty) {
       webBrowser.DocumentText = "<html> some text </html>";
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T05:52:35.517

我建议尝试`webBrowser.Stop()`与事件结合使用`Cancel`，这将完全停止导航。

# javascript - JavaScript 代码到类图

> ID：943212
> 
> 赞同：22
> 
> 时间：2009-06-03T05:36:04.763
> 
> 标签：javascript, scripting, uml, class-diagram

我正在寻找一种可以从 JavaScript 代码生成类图的工具。类似于 C++ 和 Java 的那些。有没有？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-11-29T05:00:01.017

如果您使用的是 node.js，我制作了一个为 javascript/node/html/css 生成类图的模块。它被称为 wavi。对于 javascript，可以识别函数和变量。

[https://www.npmjs.org/package/wavi](https://www.npmjs.org/package/wavi)

![wavi生成的图表](https://i.stack.imgur.com/3rCS1.png)

# visual-studio-2008 - 将目标设备从 window mobile 5 更改为 WM6 Professional Visual Studio 2008

> ID：943216
> 
> 赞同：6
> 
> 时间：2009-06-03T05:36:53.500
> 
> 标签：visual-studio-2008, windows-mobile

对比 2008

我开发了一个在 windows mobile 5 上运行的设备应用程序。

但是，我想知道我现在是否可以更改此设置并使用移动 6 作为目标设备部署我的应用程序。

在 Visual Studio 中，我单击运行按钮，它会弹出只有 window mobile 5 设备可以运行。

我还选择了我的项目并单击下拉列表框以更改目标设备。但是，仅显示 Windows 移动设备。

同样在“设备选项”下，我已将其更改为 windows mobile 6。但是，当我尝试部署时，我总是得到 windows mobile 5。

我记得你可以将目标设备从移动 5 更改为 6。但是，我只是不记得我过去是如何做到的。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-03T05:49:02.153

只需右键单击您的项目并选择“更改目标平台”。它将弹出一个窗口让您选择所需的平台。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T18:24:29.610

大多数为 Windows Mobile 5 编译的本机应用程序都可以在 Windows Mobile 6 设备和模拟器上顺利部署和运行。只需安装您的 WM6 设备或模拟器，从下拉列表中选择 Windows Mobile 5.0 Pocket PC 设备，然后部署您的应用程序。

# php - 帮助对大量报告做出决定

> ID：943217
> 
> 赞同：0
> 
> 时间：2009-06-03T05:37:03.950
> 
> 标签：php, reporting

我想问问你对我的案子的意见。我们有大桌子。我们每月都会对该表格进行报告。也就是说，我们需要下载多达 20000 条记录为 PDF 或 Excel 文件并打印出来。我计划实时生成报告。没有提前一代。这是解决我的问题的好方法吗？或者如果你有更好的主意，我想听听。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T06:02:02.117

我不完全明白你的问题；但是当我需要对非常大的表格或多个非常大的表格进行实时报告时，我所做的是预先计算我想要的任何总数。

因此，而不是像这样的查询：

select count(*), sum(items) * price, datefield, type from bigtable bt join realbigtable rbt on bt.id=rbt.rbtid where datefield between 'january 1, 2009' 和 'january 31, 2009' 按类型分组，日期字段

我们将有一个存储过程计算每晚的每日总计到第二张表 - 然后它只是将 30 天价值预先计算的总计相加的简单问题，而不是计算加入和汇总 ba-zillion 记录的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T05:56:57.320

这取决于您是否要大量生成此 PDF。如果您经常生成此文件，最好将最后生成的 PDF 缓存 15 到 30 分钟，以避免不断处理这个“大表”。

获取所有数据需要一点时间，但如果您不介意延迟，不提前生成数据可能是一个很好的解决方案。

如果您有很多人访问 PDF，并且不希望延迟，并且数据不会很快更改，您可能应该提前生成它。您的生成间隔应该与您的数据过时的速度一致。如果数据可能每天更改一次，那么每天更新通常就足够了。如果数据变化很大，您可能每 30 分钟左右生成一次。

因此，这取决于谁将访问 PDF 以及访问频率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T06:02:51.677

如果您要生成那么大的报告，很难想象用户会期望频繁更新。总的来说，我认为人们非常看重能够每天下载一致的可重复视图。事实上，一致性/可重复性通常是不超过每天刷新报告的一个很好的理由，然后存储结果。

如果不太可能每天或更频繁地需要给定报告，您可以进行惰性报告生成，存储给定日期第一次创建的副本，并可能使用类似“RepABC_05032009.xls”的文件命名方案作为给定日期报告的标记。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T06:33:41.177

20000 条记录实际上并没有那么大，因此“即时”生成肯定可以正常工作（除非检索这些记录的查询很复杂/很慢）。

我推荐使用 Excel，因为它更容易实现。只需输出 csv 数据（PHP 对此有现成的功能），并发送适当的内容标头作为响应。

使用 Excel 而不是 PDF 的另一个原因是用户可以在打印前进行一些小的调整和修改（更改横向/纵向布局、行号、添加自定义备忘录等）。

# xcode - 在 xcode 中打开 .h 文件时，是否有快速打开相应 .cc 文件的方法？

> ID：943218
> 
> 赞同：1
> 
> 时间：2009-06-03T05:37:48.037
> 
> 标签：xcode, macos

我在 XCode 中打开了 .h（例如 Ah）文件，有没有快速打开相应 .cc/.cpp（例如 A.cpp）文件的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T05:55:54.450

optionKey-appleKey-arrowUp

这适用于 .h 和 .m 目标 c 文件以及 .h 和 .cpp/.cc 文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T14:30:56.250

Option-Cmd-UpArrow 在实现 (.c/.m/.cpp/.mm) 和头文件 (.h/.hh) 文件之间切换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T14:39:04.143

相同的答案，但符号

⌥ + ⌘ + ↑

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T15:35:42.693

假设使用默认的 XCode 键绑定，上述答案基本上是正确的......

更改快捷方式：xcode 首选项->键绑定->查看->“切换到头文件/源文件”

我更喜欢使用⌘§</p>

# php - 不同的图像取决于用户是否已经投票

> ID：943226
> 
> 赞同：0
> 
> 时间：2009-06-03T05:41:10.620
> 
> 标签：php

我正在开发一个链接投票站点，并且我有这个功能，以检查用户是否已经对链接进行了投票：

```
function  has_voted($user) 
    {
       try
        {
            $db = parent::getConnection();
            $query = "select id from votes where username = '$user' and article_id  = $this->id";
            $results = parent::execSQL($query);
            if($results->num_rows == 1) {
                return true;                 
            }
            else 
            {
                return false;
            }            
            parent::closeConnection($db);

        }
        catch(Exception $e){
            throw $e;
        }       
    } 
```

在首页中，我显示了一张图片来用这一行投票：

```
 <a href="/index.php?action=vote&amp;param=<?php echo $articles[$index]->getId(); ?>">
<img class="vote_button" src="assets/images/triangulo.png" />
</a> 
```

如果用户已经投票，我希望它插入一个“如果”来显示不同的图像，我试过这个，但它显示错误：

```
 <a href="/index.php?action=vote&amp;param=<?php echo $articles[$index]->getId(); ?>">
<?php if($articles[$index]->has_voted($articles[$index]->getUsername()) == true) 
{ ?><img src="assets/images/triangulo.png"/></a><?php } 
else 
{ ?><img class="vote_button"  src="assets/images/triangulo2.png" /></a><?php } ?> 
```

+++编辑：

施纳勒，

感谢您的分析，这就是我所做的：

*   好的，我把 parent::closeConnection($db) 拿出来了，谢谢

*   我也尝试删除 catch 语句，但出现此错误：`Parse error: syntax error, unexpected '}', expecting T_CATCH in /home/mexautos/public_html/kiubbo/data/article.php on line 155`

*   我在这里得到用户名，我不知道它是否足够安全：

    function getUsername(){ return $this->username; }

    我试过这段代码来清理它：

    $query = sprintf("select id from votes where username = '$user' and article_id = $this->id", mysql_real_escape_string($user), mysql_real_escape_string($password));

    但我得到了 mysql_real_escape 行的这个错误：

警告：mysql_real_escape_string() [function.mysql-real-escape-string]：在 /home/mexautos/public_html/kiubbo/data/article.php 上的用户 'mexautos'@'localhost' 访问被拒绝（使用密码：NO）第 145 行警告：mysql_real_escape_string() [function.mysql-real-escape-string]：无法在第 145 行的 /home/mexautos/public_html/kiubbo/data/article.php 中建立到服务器的链接警告：mysql_real_escape_string( ) [function.mysql-real-escape-string]：第 146 行 /home/mexautos/public_html/kiubbo/data/article.php 中用户 'mexautos'@'localhost' 的访问被拒绝（使用密码：否）警告： mysql_real_escape_string() [function.mysql-real-escape-string]：无法在第 146 行的 /home/mexautos/public_html/kiubbo/data/article.php 中建立到服务器的链接

*   修复此问题后，我将在外面关闭标签，我不确定它是否单独工作。

*   你是对的，我得到了错误的变量。我更改为 $_SESSION['user'] 并且成功了！

*   我理解你的意思：不要用循环编写链接，只需选择它们并将它们写下来，我会检查它以了解如何做。

*   我为此使用了一个 id，让我实现它。

谢谢， CS

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T06:03:08.713

> 如果用户已经投票，我希望它插入一个“如果”来显示不同的图像，我试过这个但它**显示错误**

错误？啊哈！可能有问题......错误。我的建议：*用扫帚或大声喧哗把错误赶走*，然后你的代码就可以工作了。

如果这没有帮助，请尝试忽略它们。错误需要您注意。这就是为什么在 PHP（和大多数其他编程语言）中有如此多的**错误消息**和**通知。**通知是小错误，还没有危险，但是当它们完全长大后，它们可以删除比它们更大的应用程序。
事实：如果你忽略它们，它们往往会因为无聊而消失。

但是如果你有一些非常一致的错误仍然不会消失，可能会有另一种策略：

在互联网上发布错误的不雅图片，最好在 SO（SO 是程序员 TMZ）上。错误是骄傲和虚荣的，所以他们中的大多数人都羞愧难当，他们躲在一块石头下哭泣，直到整个事情都化为乌有。*只有当你没有心时才这样做。*

**更新：**

我不想在这里不友好或不礼貌，只是你的代码有很多问题，我取笑你告诉我们有*错误*消息，但你没有告诉我们*他们是什么说*。所以我们知道“它不起作用”并且仍然只能猜测......不，它没有帮助“删除那 3 行代码”，或者它可能会。哪3条线？3条随机线？问题：它看起来不太错，没有明显的语法错误或任何东西。它*可以工作*。但它是以一种荒谬的方式完成的。

*   首先，`parent::closeConnection($db);`是死代码，因为该函数要么返回 true 要么返回 false，并且永远不会到达`parent::closeConnection($db);` 下面的代码 ( )。这不会造成任何损害，因为通常数据库连接会在脚本结束时自动关闭。如果 getConnection 返回一个现有句柄，这种方式可能会更好，否则它将为每个查询打开/关闭连接。*是的，那很糟糕。*在脚本开始时打开连接一次，或者如果您是第一次使用它。

*   您的 catch 语句没有多大意义。你显然不处理错误，你只是传递异常（我什至不确定这是否合法。尽管你可以通过忽略整个异常处理来实现同样的效果）。你在别的地方处理吗？

*   您的 sql 查询中的用户名字符串没有转义，因此攻击者可能会将其用于 sql 注入。取决于您从哪里获得用户名。你确定你把所有东西都消毒了吗？

*   您在 if 语句之外打开 a-tag，但在内部关闭它。这并不违法，因为它有效。但它很丑。此外，很高兴即使您已经投票，您仍然拥有链接。那么，您可以多次对一篇文章进行投票吗？我对此表示怀疑。我认为您应该能够撤回您的投票，但恕我直言，最好为此采取单独的行动。赞成和反对也许？可读性，可维护性，我不是你的母亲，但请保持你的代码库干净（是的，我是个伪君子）。

让我们分析一下您的 if 语句：

```
if($articles[$index]->has_voted($articles[$index]->getUsername()) == true) { ... 
```

有异味：`$articles[$index]->getUsername()`。我假设`$article->getUsername()`返回文章作者的用户名。*所以你正在检查文章的作者是否已经对他自己的文章进行了投票。*您可能*想要*做的是将所有帖子标记为**VISITOR**，而不是已经投票的**AUTHOR 。**我们无法帮助您，因为我们不知道获取访问者数据的代码（$_SESSIONish）。

*   因此，假设您要标记用户已经投票的文章。并且 kiubbo 在它的首页上显示了 30 篇文章。这意味着您在循环中运行 sql-queries，每次页面视图需要 30 个查询，而此时您需要正好为零。为什么是零而不是一？因为当您选择文章时，您应该 LEFT OUTER JOIN 投票上的文章。另一方面，我假设您有很多钱购买一些额外的 SQL 服务器，并且熟练地进行复制舞蹈。

*   这并不重要，但是……您可以在用户名上进行选择。没有身份证吗？比如，主键 INT(11) authorID？

现在够了。

# sql-server - SQL Server 链接服务器查询内存不足

> ID：943240
> 
> 赞同：5
> 
> 时间：2009-06-03T05:49:56.643
> 
> 标签：sql-server, foxpro, linked-server

我在尝试将其选择到 SQL Server 表中的网络共享上有一个 DBF 文件。

这个查询：

```
SELECT * FROM OPENQUERY(MyLinkedServer, 'SELECT * FROM DP') 
```

...引发此错误：

链接服务器“MyLinkedServer”的 OLE DB 提供程序“MSDASQL”返回消息“[Microsoft][ODBC Visual FoxPro Driver]没有足够的内存用于文件映射。”。
消息 7399，级别 16，状态 1，第 11 行链接服务器“MyLinkedServer”的 OLE DB 提供程序“MSDASQL”报告错误。提供程序内存不足。
消息 7320，级别 16，状态 2，第 11 行无法针对链接服务器“MyLinkedServer”的 OLE DB 提供程序“MSDASQL”执行查询“SELECT * FROM DP”。

我读过关于使用 SYS(3050) 来释放 FoxPro 的内存。不过，我不知道如何针对链接服务器执行该操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T08:30:47.070

链接服务器查询使用 SQL Server 缓冲池之外称为 memToLeave 的区域的内存，该区域用于为连接线程提供服务，现在还有 sql clr 等。在 32 位上，它的大小为 384 MB，这对于某些情况可能是不够的。

如果您需要调整 SQL Server 内存配置，尤其是 memToLeave 区域，您可以在以下博客中找到解释：

[SQL Server 内存配置，确定 memToLeave 设置](http://www.johnsansom.com/sql-server-memory-configuration-determining-memtoleave-settings/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-29T14:05:55.980

如果您运行的是 SQL Server 2005 甚至 2008 SP1 或更早版本，则有针对内存泄漏问题的修补程序：http: [//support.microsoft.com/kb/974130](http://support.microsoft.com/kb/974130)

# python - 从 .deb 与 .tar.gz 安装 Django 的好处？

> ID：943242
> 
> 赞同：4
> 
> 时间：2009-06-03T05:50:43.163
> 
> 标签：python, django, ubuntu, apt-get

我正在开始 Django 开发，我可以使用 .deb 从 .deb 安装它

```
$ apt-get install python-django 
```

在我的 Ubuntu 机器上，或者我可以从[djangoproject.com](http://djangoproject.com)下载 .tar.gz ，然后开始。

每种方法的优点和缺点是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T05:59:05.117

使用`apt-get`可以让您的系统跟踪安装（例如，如果您想要卸载、升级等，则延迟）。从源代码（`.tar.gz`或其他方式）安装让您负责什么是什么和在哪里——您可以在不同的位置安装多个版本等，但没有简单的“卸载”等。就我个人而言，我更喜欢通过我的操作系统支持的方法（`apt-get`等）安装我认为是次要或辅助的软件包，直接从 svn/hg/&c 安装我正在贡献或希望保持最密切控制的软件包，以及`.tar.gz`（或在可用时更好`.tar.bz2`；-) 中间的“快照”和“源版本”...

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-03T06:51:48.050

最好的安装方法是检查代码，无论你想要哪个变更集（分支/标签），并定义一个符号链接到它

签出您想要的版本：

```
# For trunk
svn co http://code.djangoproject.com/svn/django/trunk/ django-trunk   
# For a tag, 1.02 release
svn co http://code.djangoproject.com/svn/django/tag/1.02 django-1.02
# To update the trunk
cd django-trunk
svn up 
```

然后定义符号链接

```
ln -fs /usr/lib/python2.5/site-packages/django/* ~/django-1.02/ 
```

如果您想在最新版本中测试您的代码，只需重新定义符号链接：

```
ln -fs /usr/lib/python2.5/site-packages/django/* ~/django-trunk/ 
```

软件包管理器 aptitude 和 apt-get 非常适合自动更新那些您每天都不会真正为开发而烦恼的软件，例如媒体播放器、浏览器。对于日常使用的 U 代码，需要完全控制版本，您只能通过源代码获得。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T05:58:57.910

使用 apt-get 您将通过包管理器获得更好的卸载支持，它还可以为您安装依赖项。如果您使用 apt-get 安装，您可能会获得自动更新，这对于安全补丁非常有用。

使用 tar 您可能会获得更新的版本，并且您可能有机会定制编译标志。构建可以针对您的特定处理器进行更优化，但因为在这种情况下它是 python 并不重要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T13:43:54.443

从 Ubuntu 存储库获取 Django 会为您提供较旧的“稳定”版本。这对你来说可能没问题，但我相信大多数开发人员更喜欢坚持使用主干中可用的最新代码来获得更多功能。

恕我直言，最干净的解决方案不是直接`sudo python setup.py install`（或使用`easy-install`）安装 .tar.gz/SVN 版本，而是制作一个 .deb 包。这样您应该获得最大的好处：1) 您想要的所有前沿功能 2) 适当的 Debian/Ubuntu 软件包，您可以轻松地卸载、升级和部署到任意数量的 Debian 机器。

这是一种快速而肮脏的方法：

```
#
# This is dirty (you have been warned) way to quickly
# make new Django .deb package from SVN trunk for personal use.
#
apt-get source python-django
apt-get build-dep python-django
svn co http://code.djangoproject.com/svn/django/trunk/ django-trunk
DJANGO_SVN_REVISION=`LC_ALL=C svn info django-trunk \
                     | grep ^Revision: | awk '{ print $2 }'`
cp -R python-django-*/debian django-trunk/
cd django-trunk
dch --newversion=1.1-1ubuntu1~svn${DJANGO_SVN_REVISION} \
    "Non-maintainer quick-and-dirty update to SVN r${DJANGO_SVN_REVISION}"
dpkg-buildpackage
# Have a good sip of tea, coffee or whatever you prefer.
# Because of tests, this is going to take quite a while.
# You may consider disabling (this is bad!) tests by commenting out
# line mentioning "runtests.py" in debian/rules.
cd ..
dpkg -i python-django_*.deb 
```

这甚至不能真正保证工作（而且我什至不确定正确的包版本命名），但我自己尝试过，它对我有用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T06:18:44.350

我一直使用开发版安装。[（指示）](http://docs.djangoproject.com/en/dev/topics/install/#installing-development-version)

这使得更新变得非常容易，并为您提供 /dev/ 文档中的所有精美功能。如果可能的话，我建议你尝试这条路线（如果有的话，它可以让你了解站点包的工作方式）。

注意：ubuntu 9.04 最近从 site-packages (8.04) 迁移到 dist-packages 使这有点混乱，不得不重新创建链接。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T08:35:01.790

我知道在 debian 和其他一些发行版中，包管理器中的 django 版本是 0.9 分支，而不是 1.X 分支。绝对是你想要避免的事情。

# c++ - 用信号替换自旋锁

> ID：943245
> 
> 赞同：3
> 
> 时间：2009-06-03T05:52:20.133
> 
> 标签：c++, boost, spinlock

我的多线程代码中有很多自旋锁，大部分时间它们都在等待其他线程工作，因此会占用大量的 CPU 资源。在 linux 中，我通常使用 pthread_cond_wait 和 pthread_cond_signal 来暂停线程并在收到信号时唤醒。boost库中有这样的东西吗？快速浏览一下，我找不到任何东西。

视觉工作室 2005

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T06:13:52.097

找到它，boost 称它们为条件变量： http: [//www.boost.org/doc/libs/1_39_0/doc/html/thread/synchronization.html#thread.synchronization.condvar_ref](http://www.boost.org/doc/libs/1_39_0/doc/html/thread/synchronization.html#thread.synchronization.condvar_ref)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T06:06:27.630

您正在寻找互斥体或信号量。Boost 库确实支持[Mutex 和 Semaphore](http://www.boost.org/doc/libs/1_39_0/doc/html/interprocess/synchronization_mechanisms.html#interprocess.synchronization_mechanisms.mutexes)。

互斥量是一个二进制信号量，它被简单地认为是一个锁，只允许一个线程通过你的[临界区](http://en.wikipedia.org/wiki/Critical_section)。

计数[信号量](http://en.wikipedia.org/wiki/Semaphore_(programming))有助于简化某些锁（互斥锁）过于严格的情况。

# c# - 奇怪的访问问题

> ID：943255
> 
> 赞同：0
> 
> 时间：2009-06-03T05:55:59.147
> 
> 标签：c#, ms-access

我有一个大约 8 1/2 年前为朋友构建的 MS Access 数据库。它现在拥有大量重要的数据、报告和编程（我承认重要但糟糕的编程）。我现在需要修改这个应用程序并用 c# 重写它。但这里有一个问题，我不再可以访问 MS Access（双关语不是故意的——好吧，确实如此）。而且我不想从 MS 下载试用版，因为它是 Office Professional 的一部分，安装 Professional 试用版会弄乱我注册的 Small Buiness edt 版本。所以实际上，我需要卸载我的office版本，安装试用版，做我需要做的事情，然后卸载试用版并重新安装我的版本。在那个过程中的某个地方，我确信我的电脑会死掉。

所以我对小组的问题是，你能想出一种方法来从 Access 中提取报告和表单（数据很简单），这样我就可以继续在 VS2008 和 c# 中进行开发。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T06:19:30.997

在您的机器上安装 VMWare，然后创建一个安装了必要软件的新虚拟机。这样你的主系统就会保留。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T06:32:15.560

添加到[kosoant](https://stackoverflow.com/users/15114/kosoant)答案

**VMWare**不是免费的（只有旧版本的 Virtual Server），但**Virtual PC 是**免费的，然后您可以创建一个 Windowx XP（或您拥有的任何 CD ......甚至尝试 Win7）并安装试用版.. .记住VPC不支持x64。

> 虚拟 PC： http: [//www.microsoft.com/windows/virtual-pc/](http://www.microsoft.com/windows/virtual-pc/)
> 
> Windows 7 RC： http: [//www.microsoft.com/windows/windows-7/](http://www.microsoft.com/windows/windows-7/)
> 
> Microsoft Office 2007（试用版）：[http ://us20.trymicrosoftoffice.com/default.aspx](http://us20.trymicrosoftoffice.com/default.aspx)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T06:08:01.293

找到安装了 Access 版本（任何版本）的朋友并从那里做你需要的事情会容易得多。这将花费更少的时间，尤其是因为涉及到代码。

# php - 哪个 PHP 框架最接近 ActiveRecord (RoR)

> ID：943262
> 
> 赞同：3
> 
> 时间：2009-06-03T05:58:44.820
> 
> 标签：php, ruby, activerecord, frameworks

正如问题说明了一切。

PHP 中的哪个框架最接近于 ActiveRecord（Ruby on Rail）。

我经历了许多声称基于 ActiveRecord 意识形态的框架，但不幸的是，没有一个真正接近 ActiveRecord。有吗？

有没有我错过的这样的框架？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T06:08:38.907

我想你有点困惑。ActiveRecord 本身并不是一个真正的框架。Rails 是框架，ActiveRecord 是[对象关系映射器](http://en.wikipedia.org/wiki/Object-relational_mapping)（ORM，或者数据库抽象层，如果您愿意的话）。

也就是说，总的来说， [CakePHP](http://cakephp.org/)可能是与 Rails 最相似的 PHP 框架。

但不管怎样，为什么不直接*使用*Rails 呢？您将无法在 PHP 上获得像 Rails 这样的东西。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T09:53:39.557

如果您正在寻找 ORM 包，那么[Propel](http://propel.phpdb.org/trac/)非常好。

PHP 在实现 Active Record 模式时遇到了一些麻烦。由于其处理静态方法和继承的缺点，您不能（轻松）实现`Person::findByPrimary(1)`样式静态方法。

相反，大多数 PHP ORM 使用表数据网关模式，并为表操作`PersonHelper->findByPrimary(1);`和行操作提供单独的类`new Person()->save()`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T19:51:06.257

我想说最稳定和最新的类似于 RoR 的项目是[PhpOnTrax](http://www.phpontrax.com/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-07-19T04:17:31.630

值得一提的是，自 PHP 5.3 发布以来，后期静态绑定为在 PHP 上实现 ActiveRecord 所需的各种反射打开了大门！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-11-01T08:30:54.293

选择您选择的框架并使用[http://www.phpactiverecord.org/](http://www.phpactiverecord.org/)或[http://www.doctrine-project.org/projects/orm](http://www.doctrine-project.org/projects/orm)之类的东西:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T06:07:28.987

有一个名为 php-activerecord (beta) 的项目：http: [//www.derivante.com/2009/05/19/php-activerecord-available-for-beta-testing/](http://www.derivante.com/2009/05/19/php-activerecord-available-for-beta-testing/)

# c++ - 在 C++ 中使用联合是一种好习惯吗？

> ID：943267
> 
> 赞同：26
> 
> 时间：2009-06-03T06:00:00.247
> 
> 标签：c++

我需要定义一个这样的类：

```
class Color
{
private:
   union Data
   {
       unsigned int intValue;
       unsigned char argbBytes[4];
   }

private:
    Data m_data;
}; 
```

另一种方法当然是将数据定义为整数，并在必要时将其转换为 char 数组。

我想知道哪个是首选方式。这里的矛盾是我有一个人提醒不要再使用联合的远程记忆但是在这种情况下它似乎是一个更清洁的解决方案。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-06-03T06:10:32.087

工会可以很好，只要你**小心**使用它们。

它们可以通过两种方式使用：

1.  允许以多种方式访问​​单一类型的数据（如在您的示例中，将颜色访问为 int 或（如您可能想要的）四个字符）

2.  制作多态类型（例如可以保存 int 或 float 的单个值）。

情况（1）很好，因为你没有改变类型的含义——你可以在不破坏任何东西的情况下读写联合体的任何成员。这使它成为一种非常方便和有效的方式，可以以略微不同的形式访问相同的数据。

情况 (2) 可能有用，但极其危险，因为您需要始终从联合中访问正确类型的数据。如果您编写一个 int 并尝试将其作为浮点数读回，您将得到一个无意义的值。除非内存使用是您的主要考虑因素，否则最好使用一个包含两个成员的简单结构。

联合曾经在 C 中至关重要。在 C++ 中，通常有更好的方法来实现相同的目的（例如，可以使用一个类来包装一个值并允许以不同的方式访问它）。但是，如果您需要原始性能或存在严重的内存情况，联合可能仍然是一种有用的方法。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T06:21:57.183

这是好习惯吗？是的，但有一些警告。

回到内存稀缺的时代，联合重用内存很流行。那些日子早已一去不复返了，为此目的使用工会增加了不必要的复杂性。不要这样做。

如果联合真实地描述了您的数据，就像您给出的示例中那样，那么这是一件完全合理的事情。但是，请注意您正在构建某些平台依赖项。在具有不同整数大小或不同字节顺序的不同平台上，您可能无法获得预期的结果。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T08:17:55.957

在 C++ 中，联合的使用受到其成员必须是 POD（普通旧数据）这一事实的限制。例如，联合成员不能有构造函数或析构函数，以及其他限制。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T08:33:59.077

在我假设的 C++ 编码标准中，联合将被**禁止**，因为它们往往违反“正确性、简单性和清晰性至上”的规则。

然而，这并不是普遍的建议，据我记得，Sutter 和 Alexandrescu 在他们的[C++ 编码标准](http://www.gotw.ca/publications/c++cs.htm)中并没有反对他们。

幸运的是，我认识的每个人都发现它们很难正确处理，以至于他们不生产它们。如果他们`void *`在 API 中也发现 's 也很难做对就好了:)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-07-18T05:45:52.343

如果按照您描述的方式使用，此代码将出现未定义的行为。

在 C++ 中，只有最后写入的联合成员在任何时候都*处于活动状态。*访问其他成员就像访问未初始化的变量。

有关深入讨论，请参阅[此线程](https://stackoverflow.com/questions/11373203/accessing-inactive-union-member-undefined)。

工会可以用来节省空间；例如实施变体。它们不能用于类型双关语。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-03T06:09:25.847

使用联合仍然是可以接受的做法。只需将 rgbBytes 更改为数组 :)

在 C 中，联合可以用于不同的目的。有时它们被用作 Variant 类型，即在同一内存位置保存不同类型的值。这种用法在 C++ 中是有问题的，因为您会使用继承/多态。然而，联合的另一个用途是为相同的数据提供不同的“接口”。这种用法对 C++ 仍然有效。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-03T08:14:33.953

由于您使用的是 C++，我会说这不是一个好习惯。如果您仅限于纯 C，请确定为什么不这样做。

imo最大的问题是union的大小始终是最大“成员”的大小，所以如果要存储一个字节或shitloadofdata，大小是sizeof(shitloadofdata)而不是字节。

多态是比联合更好的选择。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-03T13:21:36.017

我不喜欢工会的一点是他们不分青红皂白。他们没有提供有关当前底层类型的信息，并且通过访问联合的错误一侧非常容易违反类型安全。

[Boost::variant](http://www.boost.org/doc/libs/1_39_0/doc/html/variant.html)解决了很多这样的问题。正如文档指出的那样，联合“在面向对象的环境中几乎没有用”，而 boost::variant 提供了一种非常面向对象的方法来解决实际的联合问题。它的接口被设计为不允许访问变体，除非您使用正确的类型，并且如果将联合扩展为包含您不期望的类型，它们提供的“访问者”模式示例会给出编译时错误。

至于是否有用；我认同。我已经将它们用于简单的大型接口

```
 class some_xml_class {
 public:
    void set_property(const string&, const string&);
    void set_property(const string&, const vector<string>&);
    void set_property(const string&, const set<string>&);
    void set_property(const string&, int);

    void set_super_property(const string&, const string&);
    void set_super_property(const string&, const vector<string>&);
    void set_super_property(const string&, const set<string>&);
    void set_super_property(const string&, int); 
```

诗句

```
 class some_xml_class {
 public:
    typedef boost::variant<string, vector<string>, set<string>, int> property_type;
    void set_property(const string&, const property_type&);
    void set_super_property(const string&, const property_type&); 
```

（模板在这里也可能有用，但假设 impl 足够长，我不想内联它）

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-03-25T19:24:30.437

请记住，C++11 标准表示使用是未定义的行为，请参阅[MM 的答案](https://stackoverflow.com/a/31488191/343721)（恕我直言，这是这里的最佳答案）。未来的标准可能会定义它，但多字节数仍然可以以大端或小端方式存储。**因此，如果可移植性是一个问题，则不应使用联合或类型转换来进行类型转换。**

如果这不是问题，让我尝试稍微升级一下您的代码，以展示工会如何在 C++ 的阳光下找到自己的位置。

```
class Color {
    union {
        uint32_t value;
        struct {
            uint8_t b, g, r; // LSB value expected
        } part;
    } data;
public:
    uint32_t &value;
    uint8_t &r, &g, &b;
    Color()
        : value(data.value)
        , r(data.part.r)
        , g(data.part.g)
        , b(data.part.b)
    { value = 0; }
    Color(Color const& c) : Color() { value = c.value; }
    Color(uint32_t _value) : Color() { value = _value; }
    Color& operator=(Color const& c) { value = c.value;}
    Color& operator=(uint32_t _value) { value = _value;}
}; 
```

**解释**

*   union 内部的结构应该有名称：ISO C++ 禁止匿名结构，但是 g++ 会编译它们
*   其他构造函数委托给默认构造函数来复制值，而不是引用 (C++11)
*   第三个构造函数在这里用于舒适的隐式调用
*   该构造假定多字节数以 LSB 顺序存储

**用法**

```
Color c1 = 0xAABBCC; // implicit call
std::cout << hex << +c1.r << endl; // AA
Color c2 = c1; // copy constructor
c2.g = 127;
std::cout << hex << +c1.g << " " << +c2.g << endl; // BB 7F
c1 = 0xDEADCD; // assignment operator
std::cout << hex << +c1.g << " " << +c2.g << endl; // AD 7F 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-06-05T23:09:08.093

这绝对是 C++ 中联合的有效使用。根据您想要做什么，您可以将您的类更改为联合，这样您就没有嵌套。联合可以有方法并使用继承。如果这是不可能的（还有其他数据成员），那么您可能想要使用这样的匿名联合：

```
class Color
{
private:
   union
   {
       unsigned int intValue;
       unsigned char argbBytes[4];
   };
public:
    unsigned int GetIntValue() { return intValue; }
}; 
```

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-06-03T12:35:22.957

是的，使用联合绝对是一种好习惯——它是告诉编译器一块内存用于存储不同类型的唯一方法。使用联合维护静态类型安全，因为不需要使用 reinterpret_cast<> 并使代码的意图更易于阅读。

在使用严格别名进行编译时还需要使用联合，在这种情况下，编译器将假定指向不同类型的指针永远不会指向同一内存。严格别名本身就是一个主题，但简而言之，当启用严格别名时，通过不同的指针类型读取/写入同一内​​存通常不会按预期运行。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2009-06-03T12:54:20.813

如果您使用 GCC 并要取消引用指向同一位置的指针，最好坚持使用联合。

考虑以下代码：

```
int main() {
    char rgba[4] = {0xCC, 0xCC, 0xCC, 0};
    int *value = (int*)&rgba;
} 
```

使用 -Wstrict-aliasing=2 编译此代码将引发警告，指出违反了严格的别名规则。访问一个值是未定义的行为。另一方面，使用 union 访问另一个变量的某些部分并不违反严格的别名规则。

# wcf - WCF 服务和与设备的通信

> ID：943269
> 
> 赞同：1
> 
> 时间：2009-06-03T06:00:38.687
> 
> 标签：wcf, device

我有一个项目正在着手进行：具有自己用 C 语言编写的系统的设备，以及用于管理目的的 Windows 应用程序（发送配置、从设备检索记录的数据、监视设备的状态）。我可以灵活地选择我将使用的技术。现在的要求非常模糊，所以它应该是灵活的。主要的通信协议是 TCP。我们可能会使用 COM 端口作为维护选项，例如当由于某些网络故障导致正常通信失败时。

我正在考虑使用 WCF 服务作为应用程序和设备之间的“代理”。应用程序向服务发送数据，服务处理数据并将 TCP 数据包发送到设备（数据包中的数据可以被设备理解），设备做出反应，将 TCP 数据包发送回 WCF 服务，WCF 服务又将处理后的消息发送给应用程序。使用 WCF 是否有意义？

WCF 可以很容易地从 webapp 访问，所以除了普通的 windows 应用程序之外，我们可以让我们的系统更性感，但它值得吗？你怎么看，请分享你的想法：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T12:32:14.493

据我了解，您正在考虑具有三个元素的系统架构。一个 Windows 应用程序、一组设备，以及一个充当代理或中间人的附加服务，在两者之间进行通信。

第一个问题：管理应用程序无法连接到设备本身是否有原因？用于管理的 Windows 应用程序应该能够像其他应用程序一样轻松地打开设备的套接字。你为什么不呢？我想问这个问题的另一种方式是，*将代理（第三个元素）引入架构的理由是什么？* 你想介绍一些异步吗？是规模问题吗？也许设备的数量如此之多，以至于您希望使用单独的应用程序来管理与所有设备的通信，而不是直接从具有 UI 的应用程序连接。是网络拓扑的问题吗？在考虑在代理中使用什么技术之前，首先要确定是什么促使您在架构中包含代理。

假设第三个元素有充分的理由，那么您可以考虑 WCF 是否适合该元素的通信技术的问题。当然，在 2 个基于 Windows 的应用程序之间，WCF 将运行良好。如果它们在同一台机器上，您可以使用命名管道绑定并获得非常好的本地通信性能。如果这两个应用程序分布在不同的 Windows 机器上，您可以使用 TCP 再次获得非常好的网络通信性能。

您还需要考虑代理和设备之间的连接。WCF 可以与非 WCF 系统互连。您必须在 WCF 端编写一些扩展，才能与现有系统互连。但这是可能的，我想说的是 WCF 的一个近乎主流的用例。有关该主题的更多信息，请参阅[此 Q。](https://stackoverflow.com/questions/381142/how-to-write-a-socket-based-custom-transport-for-wcf)

# c# - 使用 C# 将 Google 电子表格作为 Excel 获取

> ID：943270
> 
> 赞同：0
> 
> 时间：2009-06-03T06:00:56.783
> 
> 标签：c#

我认为以下是我应该做的步骤：

A）我需要发布以下登录信息：

POST /accounts/ClientLogin HTTP/1.0 内容类型：application/x-www-form-urlencoded

accountType=HOSTED_OR_GOOGLE&Email=jondoe@gmail.com&Passwd=north23AZ&service=cl& source=Gulp-CalGulp-1.05

B) 需要检查返回码

C) 如果它返回成功代码，我需要在以下示例 url 中下载电子表格：[http ://spreadsheets.google.com/fm?key=DOCUMENT_ID&fmcmd=4&hl=en](http://spreadsheets.google.com/fm?key=DOCUMENT_ID&fmcmd=4&hl=en)

如何在 C# 中进行上述操作？

编辑：在登录之前我已经完成了。响应流是这样的。我不知道如何使用这个下载excel表。任何提示都会有很大帮助。

响应流如下：

SID=DQAAAIcAAADFWSVJV-6__fb211rhQLHU_jCQ1sKElh-qOf7V10WI1PUQsKmuTdPD2DEWGdbspK2h7DFxH7DPwDIQaTt1RGhwxSq9isqkmlFgcyX8nu7EotpwOfAnyGrD9mL4N vOVq4MM0FfRWVNlOn64wNM3W4tN0DTN5mLx1_jYHVD5png7esvwneScOSf6wEXGoQfsw5E LSID=DQAAAIkAAACzE9S9RdLtuCl6gfbWn9CKn4nhCdAmW4d0yLp4ypT2In769POcAsQBKiQ-VLH1Y194EuqIVrYoQTphK0Na2GQf_DWwHmXSyToZoqIh2c5GVXA0k_0IH8j745GjzLEqLpVmH2oJFNxOJYpu02If 5O8Wd1x99AsxJ35rz1OHDq_XlDBW4192pReV7SQxSf7z4-4 Auth=DQAAAIkAAACz5fRdLtuCl6gfbWn9CKn4nhCdAmW4d0yLp4ypT2In769POcAsQBKiQ-VLH1Y1-g-zsSlAXwWMwUNufqHku2F5LoAxLIElcF4aLcnQYVGs7xKNX9XlCgwubHkw7sYm4aEnjpLp0Fpmyb_paP_BABWQ ahpM5oyWob5f4KfoLFC7ltcFAVjgJjXsAAjHkToUg

编辑：这是 FireBug 捕获的请求标头：（我不明白其中一些参数在 C# 中创建 HTTP 请求）请帮助。

主持人

电子表格.google.com

用户代理

Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.10) Gecko/2009042316 Firefox/3.0.10 (.NET CLR 3.5.30729)

接受

文本/html,应用程序/xhtml+xml,应用程序/xml;q=0.9, */* ;q=0.8

接受语言

en-us,en;q=0.5

接受编码

gzip，放气

接受字符集

ISO-8859-1,utf-8;q=0.7,*;q=0.7

活着

300

代理连接

活着

曲奇饼

PREF=ID=090597c918ef0061:TM=1245011295:LM=1245011295:S=qs8OO7D02yy9tKj8; 记住我=假；SID=DQAAA IUAAAAi0iAuzneHzKleShR4itA8-zGxSKw6hqf8qBHBHJBLbNpynNOon7Ni96C4ckRcVVC5Wt89K8PywrKK5qjTmscrqizfWHygV _nPssvw5uOL9IcEWpa5aqUfeQyk-vsEMHYjLe9Ko0i2pAJrQxBrNFii588ucAVtyNoSrZVzAtZADXhhywHUK8x-LezoUaHiEbM

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T06:41:03.657

另一件事是 Fiddler：

[http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

当您“正常”下载电子表格时，使用它来了解浏览器和谷歌之间的交互，然后编写应用程序来模仿它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T06:35:59.347

看起来 SID 是“会话 ID”，它可能是您应该在下一次 POST/GET 中发回的 cookie。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-03T09:40:43.667

这不是很困难：下载 Google SS API，并查看示例代码 - 它会将您连接到您的 Google 文档，如果您在 Visual Studio 中将其构建为 VSTO 插件，您可以轻松地将数据传递到 Excel - 做到了我自己在一天之内，但不会倾向于先发布“没有跑腿”的代码。

# asp.net - asp.net 开源项目

> ID：943276
> 
> 赞同：1
> 
> 时间：2009-06-03T06:04:42.500
> 
> 标签：asp.net, asp.net-mvc, webforms

想知道哪些开源项目（例如 blog engine.net 等）适合探索/阅读其源代码。

主要目的是帮助初学者`ASP.NET /C#`开发人员了解如何干净地编写表示/业务/数据层。

一`ASP.NET`为`Webforms`。也许另一个为`ASP.NET MVC`. 最好用于 .NET Framework 3.5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T06:10:07.500

我强烈建议查看这篇列出[2008 年最佳 .net 开源项目的帖子](https://stackoverflow.com/questions/365263/whats-your-favorite-c-open-source-project-of-the-year-2008)

另外，Scott Gu（任何 .Net 开发人员必读）评论了[Microsoft 的 Web Platform Installer](http://weblogs.asp.net/scottgu/archive/2009/06/02/microsoft-web-platform-installer.aspx)工具，该工具可让您轻松安装 Web 平台组件，包括许多优秀且有用的示例站点。

最后，有关尖端 .NET 3.5 技术的终极示例，请查看名为[Nerd Diner](http://nerddinner.codeplex.com/)的开源项目。它由 MS 赞助，但仍然是开源的，旨在展示 .Net 开发实践中的最佳表现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T06:48:23.860

我没有在列表中看到这 2 个项目，

*   [凯霍加](http://www.cuyahoga-project.org/)
*   [魔力门户](http://www.mojoportal.com/)

2 个 ASP.NET 项目...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-28T15:19:10.270

The best way to develop your coding skills is to participate and contribute.

Here is an open source ERP solution ["MixERP"](http://mixerp.org) that is based on ASP.net(C#) webforms and PostgreSQL being developed over at [GitHub](http://github.com/binodnp/mixerp) and is looking for contributions.

Go ahead, get your hands dirty and enjoy learning.

# c++ - 印刷的 CDC 在纸上看起来很小

> ID：943279
> 
> 赞同：0
> 
> 时间：2009-06-03T06:05:21.860
> 
> 标签：c++, mfc, printing

当我为我创建的报告控件打印 CDC 时，它看起来很小（在纸上小于 1 平方英寸）。如何让打印的报告占据整个页面？或者换句话说，我怎样才能使整个报告出现在一个打印页面中。

`CPrintDialog printDialog(FALSE); printDialog.DoModal();`

 ````
CDC dcPrint;
if(dcPrint.Attach(printDialog.GetPrinterDC()))
{
    int iHorzRes = dcPrint.GetDeviceCaps(HORZRES);
    int iVertRes = dcPrint.GetDeviceCaps(VERTRES);

    int iHorzResCDC = m_CDC.GetDeviceCaps(HORZRES);
    int iVertResCDC = m_CDC.GetDeviceCaps(VERTRES);

    dcPrint.m_bPrinting = TRUE;
            dcPrint.BitBlt(0,0, iHorzRes, iVertRes, &m_CDC, iHorzResCDC, iVertResCDC, SRCCOPY);
    CFont* pOldFont = dcPrint.SelectObject(&m_HeaderFont);
    dcPrint.TextOut(0,0,"HelloWorld")       ;
    dcPrint.SelectObject(pOldFont);

    CPrintInfo printInfo;
    printInfo.m_rectDraw.SetRect(0,0, iHorzRes, iVertRes);
    dcPrint.StartDoc("Report Print");       
    dcPrint.StartPage();
    if(dcPrint.EndPage())
        dcPrint.EndDoc();
    else
        dcPrint.AbortDoc();     
}

dcPrint.DeleteDC(); 
````  `m_CDC 是我用来缓冲和在屏幕上显示整个报告的内存 DC。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T04:06:51.573

正如其他人所说，这是因为通常打印机的显示分辨率比显示器高很多。显示器通常为 96 到 120DPI：在 96DPI 下，这意味着 96 像素（点）乘 96 像素的图像在显示器上占据大约 1 平方英寸。但是，如果您只是拍摄该图像并在 600DPI 打印机上打印出来，图像的尺寸将约为 1/6" x 1/6" - 小得多。这是出版界的祸根——在显示器上看起来不错的图像在打印时通常看起来要么很小要么很糟糕。

正如建议的那样，您可以使用 StretchBlt 而不是 BitBlt 来放大图像。根据您的显示器和打印机之间的差异，这将看起来有点块状，或者完全是可怕的块状。

一个更好的选择是重写你的代码来绘制控件，这样你就有一个方法可以获取设备上下文（和一些坐标）并绘制到它。您的普通窗口绘制代码可以将内存 DC 传递给此例程，然后将结果 BitBlt 到窗口，您的绘制代码可以使用打印机 DC 和一些合适的坐标调用此方法。

编写此例程时，您将不得不担心缩放：例如，您需要为给定的设备上下文创建字体，并具有与缩放无关的大小（即，以磅为单位指定字体大小，而不是像素） ，而不是依赖于预先创建的字体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T06:30:38.573

我想您没有将报告缩放到打印机的分辨率。典型的屏幕分辨率为 72 DPI（有时为 96 DPI）。打印机分辨率可以是 300DPI、600DPI 或更高。

您应该将报告重新绘制到打印机 DC，并将所有坐标和大小缩放到打印机的分辨率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T06:40:00.977

您的打印机每英寸的点数比屏幕多得多。您将需要缩放以更好地适应打印页面。

尝试使用 StretchBlt() 而不是 BitBlt()。

# c++ - C中的静态和C ++中的静态之间的区别？？

> ID：943280
> 
> 赞同：55
> 
> 时间：2009-06-03T06:06:06.523
> 
> 标签：c++, c

C 和 C++ 中的 static 关键字有什么区别？

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2009-06-03T06:14:55.557

该`static`关键字在 C 和 C++ 中的用途相同。

1.  在文件级别（函数外部）使用时，它设置应用它的项目的可见性。静态项在其编译单元之外不可见（例如，对于链接器）。它们的持续时间与程序的持续时间相同。

    这些文件级项目（函数和数据）应该是静态的，除非有特殊需要从外部访问它们（并且几乎从不需要直接访问数据，因为这破坏了封装的核心原则）。

    如果（正如您对问题的评论所示）这是`static`您所关心的唯一用途，那么，不，C 和 C++ 之间没有区别。

2.  在函数中使用时，它设置项目的持续时间。同样，持续时间与程序相同，并且该项目在该函数的调用之间继续存在。

    它不会影响该项目的可见性，因为它仅在函数内可见。一个例子是一个随机数生成器，它需要在调用之间保持其种子值，但不希望该值对其他函数可见。

3.  `static`在一个类中，C++ 还有一个用途。当在那里使用时，它成为一个单一的类变量，在该类的所有对象中都是通用的。一个经典示例是存储已为给定类实例化的对象的数量。

正如其他人所指出的，文件级静态的使用已被弃用，取而代之的是未命名的命名空间。但是，我相信在它真正从语言中删除之前，在某个温暖的地方会是一个寒冷的日子——目前使用它的代码太多了。尽管我们都知道这是一个危险的功能，但ISO C 才*刚刚*开始删除。`gets()`

即使它已被弃用，现在也不会改变它的*语义*。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-03T06:44:57.627

在文件范围内使用 static 来限制对当前翻译单元的访问在 C++ 中已弃用，但在 C 中仍然可以接受。

相反，使用未命名的命名空间

```
namespace
{
    int file_scope_x;
} 
```

以这种方式声明的变量仅在文件中可用，就像它们被声明为静态一样。

弃用的主要原因是删除 static 关键字的几个重载含义之一。

最初，这意味着变量，例如函数中的变量，将在程序的生命周期中存储在此类变量的区域中，而不是像通常的函数局部变量那样存储在堆栈中。

然后关键字被重载以应用于文件范围链接。根据需要组成新关键字是不可取的，因为它们可能会破坏现有代码。所以这个变量再次以不同的含义使用而不会引起冲突，因为声明为静态的变量不能同时在函数内部和顶层，并且函数之前没有修饰符。（当提到函数时，存储的含义就完全丢失了，因为它们没有存储在任何地方。）

当 C++（以及 Java 和 C#）中出现类时，再次使用了该关键字，但其含义至少更接近最初的意图。以这种方式声明的变量存储在全局区域中，而不是像函数变量那样存储在堆栈中，或者像对象成员那样存储在堆中。因为变量不能同时位于顶层和类定义中，所以可以明确地将额外的含义附加到类变量上。它们只能通过类名或从该类的对象中引用。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-03T06:09:43.540

它在两种语言中具有相同的含义。

但是 C++ 增加了类。在类（因此是结构）的上下文中，它具有使方法/变量类成员而不是对象成员的额外含义。

```
class Plop
{
    static int x; // This is a member of the class not an instance.

    public:
    static int getX() // method is a member of the class.
    {
        return x;
    }
};

int Plop::x  = 5; 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-03T08:04:46.483

请注意，使用 static 来表示“文件范围”（又名命名空间范围）仅被 C++ 标准反对用于对象，而不是用于函数。换句话说，：

```
// foo.cpp  
static int x = 0;               // deprecated
static int f() { return 1; }    // not deprecated 
```

引用标准的附录 D：

> 在命名空间范围内声明对象时，不推荐使用 static 关键字。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-04-10T16:10:41.213

您不能在 C 中的结构内声明静态变量...但在范围解析运算符的帮助下允许在 Cpp 中。

同样在 Cpp 静态函数中只能访问静态变量，但在 C 静态函数中可以有静态和非静态变量...

# php - 在 PHP 中扩展 mysql JOIN 查询

> ID：943291
> 
> 赞同：0
> 
> 时间：2009-06-03T06:09:43.710
> 
> 标签：php, mysql

我需要在下面更改我现有的 JOIN 查询，以包括与帖子制作者`users.image`相关的数据。`UserID`就像是：

`users.image WHERE users.UserID = posts.userid`

我还不太擅长连接查询。我该怎么做？

现有查询：

```
$result = mysql_query("SELECT  posts.* FROM  listen JOIN posts ON posts.userid = listen.listenid WHERE listen.userid = '$user_id' ORDER BY DATE desc") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T06:15:48.257

只需添加另一个 JOIN 子句：

```
SELECT  posts.* 
FROM  listen 
JOIN posts ON (posts.userid = listen.listenid) 
JOIN users ON (users.UserID = posts.userid)
WHERE listen.userid = '$user_id' 
ORDER BY DATE desc 
```

您可能需要将 JOIN 更改为特定的联接，例如 LEFT JOIN，具体取决于您所追求的。

顺便说一句，在多行上查看查询更容易。

编辑：您可能需要添加您在字段中选择的其他项目，例如`SELECT posts.*, users.*`

# subsonic - 附加和

> ID：943299
> 
> 赞同：0
> 
> 时间：2009-06-03T06:12:48.667
> 
> 标签：subsonic

我公司的 MySql 数据库充满了名为“system”的字段，因此 SubSonic 生成的代码与 .NET System 命名空间发生冲突。

我了解 AppendWith 将一个字符附加到它识别为与保留字冲突的字段，但在我的情况下它似乎没有做任何事情。有没有办法查看/更新它知道的保留字列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T07:56:59.573

同样的问题：AppendWith 仅适用于保留关键字（例如 public 等），不适用于命名空间。

这就是我解决问题的方法（查看 regexDictionaryReplace 条目）

```
 <add name="MyDataProvider"
       type="SubSonic.MySqlInnoDBDataProvider, SubSonic"
       connectionStringName="myConnectionString"
       generateLazyLoads="true"
       regexDictionaryReplace="[sS]ystem,SystemX;[tT]able[nN]ame,TableNameX"
       fixPluralClassNames="false"
       generatedNamespace="My.NameSpace"
       removeUnderscores="false"
       generateNullableProperties="false"
       generatePropertyChangedEventHandler="true"
       generateRelatedTablesAsProperties="true"
       excludeTableList="audit"
       tableBaseClass="ActiveRecord" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T07:03:48.323

您可以尝试使用“stripTableText”将“system”替换为“”。有很多方法可以做到这一点，如果需要它甚至使用正则表达式 - 看看： [http ://subsonicproject.com/configuration/config-options/](http://subsonicproject.com/configuration/config-options/)

# ruby-on-rails - 单表继承路由？

> ID：943300
> 
> 赞同：3
> 
> 时间：2009-06-03T06:13:38.947
> 
> 标签：ruby-on-rails, ruby, inheritance

我的单表继承对我的应用程序来说工作得很好。我有两个继承超类型用户的用户子类型（运动员和公司）。

假设我要列出所有用户，并希望从此列表中获得指向每个用户个人资料的链接。如果类型是运动员，我想链接到运动员控制器，如果类型是公司，我想链接到公司控制器。有标准的 Rails 方法吗？也许一些路由技巧？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T09:14:05.610

你甚至可以做得更简单，Rails 可以识别它必须处理的用户类型，所以假设你有一个实例变量 @user 可以是运动员或公司，你可以这样做

```
= link_to "Profile", @user 
```

砰！轨道魔法！

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2009-06-03T07:27:09.400

```
<% User.find(:all).each do |user| %>
  <%= link_to "user", eval("#{user.type.underscore}_path(user)") %>
<% end %> 
```

这将根据用户的类型（存储在类型字段中）生成路径。不要忘记将用户类型添加到您的路线配置中。

我希望这有帮助。

问候

# javascript - 在 Eclipse 中加载 IIS 网站

> ID：943308
> 
> 赞同：1
> 
> 时间：2009-06-03T06:16:00.783
> 
> 标签：javascript, eclipse, eclipse-plugin

我不确定是否有办法将 IIS 网站加载到 Eclipse 中。类似于我们可以通过 File > Open Website 在 Visual Studio 中加载的方式

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-09-17T00:38:42.447

简短的回答：没有。

稍微长一点的答案：使用开源 Web 应用程序服务器（例如 Tomcat），您可以在 Eclipse 中运行它。您可以设置断点，在运行时检查变量值等。但是，Microsoft 离开源还很远。如果您想通过调试器运行 IIS，您将不得不使用 Visual Studio 或一些类似的仅限 MS 的工具，因为这就是 MS 设计事物的方式。

当然，正如 Kekoa 所指出的，您始终可以在 Eclipse 中加载单个文件，但您只是将其用作美化的文本编辑器；要获得所有“IDE”功能的全部功能，您确实需要使用非 MS（通常是非专有）堆栈。

# wpf - MeshGeometry3D (WPF) 中顶点的平滑

> ID：943309
> 
> 赞同：0
> 
> 时间：2009-06-03T06:16:12.170
> 
> 标签：wpf, silverlight

我正在使用 Windows.Media.Media3D 工具包将 DirectX 应用程序移植到 WPF 中。这一切都很好，除了模型呈现不完整，即使它已经获得了所有可能的数据。

我怀疑这是因为 DirectX 优化并以某种方式平滑或帮助根据顶点和索引渲染其他内容。

所以我想知道是否可以选择更改 WPF 渲染 3D 模型的方式？准确地表达我的意思有点困难，但我希望它是可以理解的。

这是重要的代码：

```
private void DrawModel()
{
    SwordModel swordModel;

    string filename = "PG_S8_02";

    using(FileStream stream = File.OpenRead(string.Format("Media/Models/{0}.gb", filename)))
    using(BinaryReader reader = new BinaryReader(stream))
    {
        swordModel = new SwordModel(reader);         
    }

    var group = new Model3DGroup();

    foreach(var modelMesh in swordModel.Meshes)
    {
        var mesh3D = new MeshGeometry3D();

        // Indices
        foreach(var index in modelMesh.Indices)
        {
            mesh3D.TriangleIndices.Add(index);
        }

        // Vertices
        foreach(var vertex in modelMesh.Vertices)
        {
            mesh3D.Positions.Add(vertex);
        }

        // Normals
        foreach(var normal in modelMesh.Normals)
        {
            mesh3D.Normals.Add(normal);
        }

        // Texture Coordinates
        foreach(var vertex in modelMesh.Vertices)
        {
            mesh3D.TextureCoordinates.Add(new Point(vertex.X, vertex.Y));
        }

        // Material
        var material = new DiffuseMaterial();
        var texture  = new BitmapImage(new Uri(
            string.Format("Media/Textures/{0}.png", filename), 
            UriKind.RelativeOrAbsolute
        ));   
        material.Brush = new ImageBrush(texture);                               

        // Add to View
        group.Children.Add(
            new GeometryModel3D(mesh3D, material)
        );
    }    

    mainViewport.Children.Add(
        new ModelVisual3D() { Content = group }
    );         
} 
```

和 XAML：

```
<Viewport3D Name="mainViewport" ClipToBounds="True">
    <Viewport3D.Camera>
        <PerspectiveCamera 
            FarPlaneDistance="100"
                        LookDirection="-11,-10,-9"
                        UpDirection="0,1,0"
                        NearPlaneDistance="1" 
                        Position="11,10,9" 
                        FieldOfView="70" />
    </Viewport3D.Camera>
    <ModelVisual3D>
        <ModelVisual3D.Content>
            <DirectionalLight Color="White" Direction="-2,-3,-1" />
        </ModelVisual3D.Content>
    </ModelVisual3D>
</Viewport3D> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T08:02:26.753

我唯一能想到的是法线没有被平滑，但是没有看到网格是什么样子我不能肯定地说。

我的意思是顶点法线平行于面法线，使网格具有多面外观。如果法线被平滑，那么整个形状看起来很平滑。像这样的东西：

**平面阴影：**

[http://www.forman.free-online.co.uk/images/flatshading.png](http://www.forman.free-online.co.uk/images/flatshading.png "平面着色示例")

**平滑阴影：**

[http://www.forman.free-online.co.uk/images/smoothshading.png](http://www.forman.free-online.co.uk/images/smoothshading.png "平滑着色示例")

*由链接替换的图像以限制我的带宽使用*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T07:51:20.520

偏方有问题吗？默认情况下，我认为 WPF 会单方面呈现方面 - 您无法从“错误”方面看到它们。

与照明类似，如果您的模型没有从各个方向照明，您可能会得到奇怪的效果 - 尝试放入 AmbientLight

# javascript - 谁能提供一个合理的解释来解释为什么网络服务器必须协助创建上传进度条？

> ID：943310
> 
> 赞同：4
> 
> 时间：2009-06-03T06:17:04.853
> 
> 标签：javascript, upload, client, progress

我已经在 Rails 中建立了一个小型个人网站，并且已经到了需要能够上传文件的地步。这是一项几乎微不足道的任务，根本不需要时间。

需要时间 - 并且正在慢慢削弱我的理智 - 是为用户提供上传进度条的任务。我现在已经看到了至少十几种解决方案，它们似乎都有一个共同点——它们需要在 Web 服务器上安装一个模块。

鉴于我无法控制我的服务器，而且托管公司似乎不太可能安装任何这样的动物，我有点束手无策。真正令人抓狂的是，以任何方式、形式或形式让服务器参与此过程是绝对没有必要的。

想一想：您的浏览器打开一个到远程服务器的套接字并开始发送数据。您的浏览器确切地知道要发送多少字节，并且由于 TCP 确认的魔力，还知道有多少字节已到达服务器端。那么，为什么以“飞行意大利面怪物”的名义，没有简单的方法可以将这些数据呈现给 Javascript，而不会与被炸毁的服务器混为一谈呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T07:26:44.470

这里真正的限制是 HTML 表单。它们是 10 多年前发明的，当时上传较大的文件似乎完全不可行。因此它们只为您提供一个回调：当整个上传完成时（ACTION 参数）。

幸运的是，有一些免费的基于 Flash 的上传器提供进度条。别担心，它们中的大多数都会优雅地降级（如果用户没有闪存，则提供一个简单的文件上传字段）。所有选项都可以通过 Javascript 控制。而且，它们不需要任何特殊的服务器端基础设施。

检查 swfupload.org

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T05:50:50.957

现在除了 IE（所有版本）之外，几乎所有的网络浏览器都可以。

JavaScript 相当简单。检查 sourceforge.net 上的 webfolder 项目。它显示所有支持 HTML5 的浏览器的上传百分比。

```
 function upload() {
   document.folder.encoding = "multipart/form-data";
   if (document.folder.file.files) { 
       var xhr = new XMLHttpRequest();
        var fd = new FormData(document.folder);
        /* event listeners */
        xhr.upload.addEventListener("progress", uploadProgress, false);
        xhr.addEventListener("load", uploadComplete, false); // loadend if doesn't matter success or not 
        xhr.addEventListener("error", uploadError, false);
        xhr.open("POST", document.folder.action, true);
        fd.append('submit', 'Upload'); // keep consistent with view, so maybe return method in view
        fd.append('background', '1');
        xhr.send(fd); 
        return false;
   }
   return true;
}

function uploadProgress(evt) {
    if (evt.lengthComputable) {
        var per = (evt.loaded*100/evt.total).toFixed(0)+'%';
        getElement('_progress').innerHTML = per;
        document.title = 'Upload ('+per+')';
    }   else {
        getElement('_progress').innerHTML = evt.loaded;
    }
}

function uploadComplete(evt) {
    getElement('_progress').innerHTML = '100%';
    window.location.reload();
}

function uploadError(evt) {
    getElement('_progress').innerHTML = 'error';
} 
```

我还有代码显示具有更多娱乐能力的网站的进度条。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T06:25:00.813

我完全同意，不幸的是没有跨浏览器的标准 api。但是，即使存在，服务器也需要参与。你不能相信你发送了多少数据，HTTP 需要一个确认。因此，您需要服务器告诉您是否收到了数据报 #526。如果有一个 API，它可能是一个很好的猜测，但不是一回事：S

检查 www.faqs.org/rfcs/rfc1867.html

如果您可以 ping 服务器，您可以模拟它（没有信心）。

# c - 分段错误 - 字符指针

> ID：943312
> 
> 赞同：7
> 
> 时间：2009-06-03T06:18:27.907
> 
> 标签：c, segmentation-fault

在下面的代码中，该行：

```
*end = *front; 
```

给出分段错误。[我在这里](https://stackoverflow.com/questions/943191/assigning-character-to-char-pointer)问了一个类似的问题，但我不确定这是否是因为我有两个 num 副本。请解释为什么它是段错误。谢谢你。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char* getPalin(char* num);

int main()
{
    char* num = (char*)malloc(100);

    num = "123456";

    printf("%s\n", getPalin(num) );

    return 0;
}

char* getPalin(char* num)
{
    int length = strlen(num);

    if ( length % 2 == 0 )
    {
        char* front = num;
        char* end = num + strlen(num) - 1;  //pointer to end

        while( front != num + (length/2) )  //pointers not middle yet
        {
            *end = *front;

            printf("%c", *end);

            front++;
            end--;
        }
    }

    return num;
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-03T06:28:25.583

这两行：

```
char* num = (char*)malloc(100);
num = "123456"; 
```

有以下效果。

第一个分配 100 个字节并设置`num`为指向这些字节。

第二个更改 num 以指向字符串“123456”，该字符串几乎可以肯定在只读内存中。

任何更改只读内存内容的尝试都将导致分段违规。在尝试更改它之前，您需要将字符串复制到`malloc`'d中，使用：`num`

```
strcpy (num, "123456"); 
```

这就是您当前应该拥有的行：

```
num = "123456"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T06:24:16.137

采用

```
strncpy(num, "123456", 100); 
```

代替

```
num = "123456"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T06:46:00.590

根据康斯坦丁的回答。

您已经使用 malloc 语句为 num 分配了内存。

如果你没有，那么你可以逃脱：

```
char* num = "123456"; 
```

它将动态定义和分配内存，但它很可能被分配为常量，因此是只读的。

使用 strncpy 而不是 strcpy 复制“123456”将确保字符串空终止符末尾之外的任何额外空间也初始化为空，只要您将 n 指定为 100（例如）。否则，如果不将 malloc 分配的内存初始化为 null (memset(num, 0, 100))，那么可以想象您可以超出字符串的末尾。

哦差点忘了。建议使用 strcpy_s 或 strncpy_s，因为它们更安全，尽管对于您的代码来说这无关紧要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-13T21:04:27.567

错误的原因是：

```
 char* num = (char*)malloc(100); 
```

在这一行中，您已将 num 声明为指向数组的指针或指向其第一个元素的指针，而不是字符串。

```
 num = "123456"; 
```

这一行您在将其声明为字符串时使用了 num。这是违反分段的，因此是分段错误。您的代码的首选（正确）语法是：

```
 char num[100];
   strcpy(num,"123456"); //Even if you use num="123456"; here it would still be wrong 
```

或者

```
 char* num = (char*)malloc(100);
  strcpy(num,"123456"); 
```

或者

```
 char num[100]={'1','2','3','4','5','6'}; 
```

这些中的任何一个都可以完成您的工作。

# client - 我们是否必须购买域名才能为 Bugzilla 提供服务？

> ID：943324
> 
> 赞同：0
> 
> 时间：2009-06-03T06:22:39.227
> 
> 标签：client, dns, ip-address, bugzilla

我尝试将我来自 whatismyip.com 的 IP 放入 Bugzilla 的 urlbase，但它不起作用。我无法为我的队友创建新帐户，他也无法通过在浏览器中输入我的 IP 地址来访问服务器。当然，当我再次连接时，我的 IP 地址会改变。我们是否必须购买 www 地址来托管 Bugzilla？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T06:30:54.237

您可以设置动态 dns 服务，例如通过[http://www.dyndns.com](http://www.dyndns.com)或[http://www.no-ip.com](http://www.no-ip.com)或[http://freedns.afraid.org](http://freedns.afraid.org)来解决更改 ip 问题而无需购买一个域（或购买一个域，但这不是必需的）。

但真正的问题是您的队友无法通过当前 IP 地址访问服务器，这表明网络服务器配置错误（仅在 localhost 上侦听？）、中间的防火墙，或者很可能是端口转发不是t 在您的路由器中设置将来自外部 IP 地址的请求转发到您设置了 Bugzilla 的机器。此外，您必须将 urlbase 设置为您的本地 IP 地址，而不是外部 IP 地址，如 blak3r 所说。

查看[http://www.portforward.com](http://www.portforward.com)以获取有关如何进行端口转发的说明。但不要忘记提到的所有内容都必须有效：

*   **Web 服务器侦听外部请求**：这可以通过本地网络 IP 地址从同一内部网络进行测试（您在 Windows 中的命令行控制台 ipconfig 和 Linux 中的 ifconfig 中看到的内容）。如果您可以通过本地 IP 地址从同一网络上的不同计算机连接，则可以解决此问题。
*   **防火墙（在路由器和网络服务器机器中）接受到网络服务器端口的连接**：对于网络服务器中的防火墙，与上面相同的测试涵盖了它。
*   **端口转发，因此路由器将在 Web 服务器端口上收到的请求转发到 Web 服务器机器**：这与路由器中的防火墙测试方式相同，也就是说，您必须有您的朋友（或您朋友家中的您自己） ) 尝试连接到设置的 dyn dns 名称或 whatsmyip.org 报告的外部 IP。

这一切都假设您的测试伙伴不在同一个网络上，如果他在，只需使用本地 IP 地址（通过 ipconfig 或 ifconfig 显示）而不是外部 IP 地址，并确保涵盖了第一步（Web 服务器侦听外部请求）应该足够了，不需要其他任何东西！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T06:39:07.450

您很可能没有将端口 80 转发到您的计算机，这就是他在使用从 whatismyip.com 返回的 IP 时无法连接的原因。

假设你在一个 Windows 盒子上......做

```
 Start->Run->cmd then type 
  ipconfig 
```

如果您的地址以 192 开头*。*.* 或 10 *..* .* 这是您的局域网 (LAN) IP。如果是这种情况，那么您的 isp 为您提供了路由器。查找称为端口转发或“应用程序设置”的设置，它允许您将路由器上的所有传入流量转发到特定 IP 地址。进入路由器的配置设置并确保端口 80（如果您使用 ssl，则可能是 443 转发到您的本地 IP）。

您提到的另一个问题是您没有静态 IP。这是一个常见问题，不，您不需要购买地址。有几个站点可以为您提供免费的动态 dns 主机。试试 no-ip.org。

# php - 为什么在 Symfony 1.2 中重写 Doctrine_Record::save() 会给我一个严格的标准错误？

> ID：943325
> 
> 赞同：4
> 
> 时间：2009-06-03T06:23:35.263
> 
> 标签：php, symfony1, doctrine

我有以下模型：

```
class Model extends BaseModel
{
   public function save($conn = null)
   {
      if(!$this->getId())
      {

        //do stuff

     }
     return parent::save($conn);

    }
} 
```

我觉得我正在遵循[Doctrine_Record::save()](http://www.doctrine-project.org/Doctrine_Record/1_1#method_save)签名的 API 描述（除了奇怪的括号，我会给我一个语法错误......）。

当我运行此代码时，**它运行良好** ，但我收到以下警告：

```
Strict Standards: Declaration of Model::save() should be compatible with that of Doctrine_Record::save() in $ROOT/lib/model/doctrine/Model.class.php on line 6 
```

我通常将错误报告转为 ERROR_ALL，并尝试坚持使用无警告代码。这让我很困扰。我检查了所有的 Doctrine 源代码并用 greped “保存（”，在它上面，一个接一个地尝试一个签名。什么都没有。PHP 第一次让我太宽容了，奇怪 hu :-) ？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-03T07:09:15.037

保存方法的正确签名应该是：

```
public function save(Doctrine_Connection $conn = null) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-08T18:39:20.660

On a side note: On other functions you may get this error but you will need to use function($event) in place of the above.

# php - 如何检查Flex中的xml值是否为空？

> ID：943326
> 
> 赞同：0
> 
> 时间：2009-06-03T06:23:54.577
> 
> 标签：php, apache-flex

```
$output .="<keyword>".$_POST['keyword']."</keyword><name>".$row['url']."</name><occur>".$row['occurrences']."</occur><queryTime>".(substr($end_time-$start_time,0,5))."</queryTime>";
} 
```

我想检查 Flex，如果 name 的值为 null 与否。我尝试了这些，但是当节点值为空时我没有收到任何警报。

```
event.result.attribute("name").value < 0

event.result.attribute("name").length < 0

event.result.loginsuccess.name = "" 
```

谁能帮帮我，下面是我的弹性代码。

```
if(keyword.text == "") 
{ 

Alert.show("Please enter the search term");
    } else if(event.result.attribute("name").length < 0) {
            Alert.show("No search Results"); } 
else { 
                subtitle.text = "Search results for " +  event.result.loginsuccess.keyword[0];
                        query.text = "query executed in " + event.result.loginsuccess.queryTime[0] + " Seconds";
            }
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T06:26:11.623

检查这个

```
event.result.loginsuccess.name[0] == null 
```

为什么？

因为当您直接在 XML 上调用子级时，它总是以 XMLList 的形式返回，所以我们应该检查 XMLList 是否有任何子级。[0] （第一个索引）如果存在则尝试返回第一个孩子，否则返回 null

在您的示例中，它应该是：

```
if(event.result.name[0])
{
...
} 
```

因为名称是元素而不是属性，如果名称是属性，那么它应该是

```
if(event.result.@name[0])
{
...
} 
```

我希望它有帮助

**编辑**

请尝试这种方式

```
if(keyword.text == "") 
{ 

Alert.show("Please enter the search term");
    } else if(!XML(event.result).name[0]) {
                Alert.show("No search Results"); } 
else { 
                        subtitle.text = "Search results for " +  event.result.loginsuccess.keyword[0];
                                        query.text = "query executed in " + event.result.loginsuccess.queryTime[0] + " Seconds";
                }
                } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T08:38:27.663

还可以检查空字符串，例如

```
if(event.result.name=="")
{
} 
```

# version - Javadoc 版本控制

> ID：943329
> 
> 赞同：0
> 
> 时间：2009-06-03T06:25:08.507
> 
> 标签：version, javadoc

我的项目中的版本编号有一点问题。

比如说我有 4 个班级一二三四

我第一次发布这个软件时，它会被标记为版本 1.0.0

在我的 java doc 注释中，对于所有类，我将其作为 @version 1.0.0

所以现在测试将它发回，并带有第二类中的错误

我更新了第二类，现在必须发布版本 1.0.1

我现在是否更新每个班级的@version 标签？

还是我最终会在 javadoc 注释中得到一堆具有不同版本号的类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T06:44:54.007

我相信正确的答案只是更改受该错误影响的那些文件。

我会将版本或修订留给您的控制版本。在一个完美的世界中，脚本会保持版本同步。

当然，这个问题是主观的。如果您打算将版本标签用作营销工具，那么是的，您可能希望让所有代码都使用相同的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T07:02:33.300

我认为错误修复根本不会影响这一点，因为在修复错误时，您只需更改版本号中的修订号（第 3 个）。而且您不必在您的 javadoc 中输入修订号 - 它在那里毫无用处，因为 javadoc 用于描述 API，并且 API 不会随着修复错误而改变。

这意味着您应该只输入**@version 1.2**而不是**@version 1.2.6**

您的 javadoc 仅在您更改 API 时才会更改 - 而不是您必须更改主要（1st）或次要（2nd）版本号，并且应该在您的 javadoc 中投影。

我认为您应该只更改已更改的类中的版本号，因为其他类是从以前的版本“继承”的，因此未更改的类中的版本号应该保持不变。但我不确定那..

# asp.net-mvc - 更多控制 ASP.Net MVC 的 Authorize；保持 AJAX 请求 AJAXy

> ID：943330
> 
> 赞同：5
> 
> 时间：2009-06-03T06:25:11.937
> 
> 标签：asp.net-mvc, ajax, authorize

我在 Authorize 后面有一些操作方法，例如：

```
[AcceptVerbs(HttpVerbs.Post), Authorize]
public ActionResult Create(int siteId, Comment comment) { 
```

我遇到的问题是我正在通过 AJAX 发送一个请求来评论/创建

```
X-Requested-With=XMLHttpRequest 
```

这有助于将请求识别为 AJAX。当用户未登录并点击授权墙时，它会被重定向到

```
/Account/LogOn?ReturnUrl=Comment%2fCreate 
```

这打破了 AJAX 工作流程。我需要被重定向到

```
/Account/LogOn?X-Requested-With=XMLHttpRequest 
```

有什么想法可以实现吗？有什么方法可以更好地控制请求授权时发生的事情？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T21:54:29.020

感谢 Lewis 的评论，我能够找到这个解决方案（这远非完美，附有我自己的评论，如果你有修复，请随时编辑和删除这个短语），但它有效：

```
public class AjaxAuthorizeAttribute : AuthorizeAttribute {
    override public void OnAuthorization(AuthorizationContext filterContext) {
        base.OnAuthorization(filterContext);
        // Only do something if we are about to give a HttpUnauthorizedResult and we are in AJAX mode.
        if (filterContext.Result is HttpUnauthorizedResult && filterContext.HttpContext.Request.IsAjaxRequest()) {
            // TODO: fix the URL building:
            // 1- Use some class to build URLs just in case LoginUrl actually has some query already.
            // 2- When leaving Result as a HttpUnauthorizedResult, ASP.Net actually does some nice automatic stuff, like adding a ReturnURL, when hardcodding the URL here, that is lost.
            String url = System.Web.Security.FormsAuthentication.LoginUrl + "?X-Requested-With=XMLHttpRequest";
            filterContext.Result = new RedirectResult(url);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-13T13:38:59.153

最近我遇到了完全相同的问题，并使用 J. Pablo Fernández 发布的代码进行了修改以解释返回 URL。这里是：

```
public class AuthorizeAttribute : System.Web.Mvc.AuthorizeAttribute
{
    override public void OnAuthorization(AuthorizationContext filterContext)
    {
        base.OnAuthorization(filterContext);
        // Only do something if we are about to give a HttpUnauthorizedResult and we are in AJAX mode. 
        if (filterContext.Result is HttpUnauthorizedResult && filterContext.HttpContext.Request.IsAjaxRequest())
        {
            // TODO: fix the URL building: 
            // 1- Use some class to build URLs just in case LoginUrl actually has some query already. 
            HttpRequestBase request = filterContext.HttpContext.Request;
            string returnUrl = request.Path;
            bool queryStringPresent = request.QueryString.Count > 0;
            if (queryStringPresent || request.Form.Count > 0)
                returnUrl += '?' + request.QueryString.ToString();
            if (queryStringPresent)
                returnUrl += '&';
            returnUrl += request.Form;
            String url = System.Web.Security.FormsAuthentication.LoginUrl +
                         "?X-Requested-With=XMLHttpRequest&ReturnUrl=" +
                         HttpUtility.UrlEncode(returnUrl);
            filterContext.Result = new RedirectResult(url);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T15:50:15.130

而不是使用授权属性，我一直在做类似下面的事情。

```
public ActionResult SomeCall(string someData)
{
    if (Request.IsAjaxRequest() == false)
    {
        // TODO: do the intended thing.
    }
    else
    {
        // This should only work with AJAX requests, so redirect
        // the user to an appropriate location.
        return RedirectToAction("Action", "Controller", new { id = ?? });
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T16:16:37.430

我认为处理这个问题的正确方法是在你的 Javascript 中进行 AJAX 调用。

如果用户需要被授权（或如您的代码所暗示的那样进行身份验证）并且不需要，您应该通知他们并且可能不允许他们首先尝试和评论。

但是，如果这不符合您的需求。您可以尝试编写自己的授权操作过滤器，可能继承自 MVC 框架附带的过滤器，但会重定向您想要的方式。这很简单。

# java - Java 优化

> ID：943331
> 
> 赞同：1
> 
> 时间：2009-06-03T06:25:33.623
> 
> 标签：java, optimization, jit

我想知道两者之间是否存在任何性能差异

1.  字符串 s = someObject.toString(); System.out.println(s);

    和

2.  System.out.println(someObject.toString());

查看生成的字节码，似乎有区别。JVM 是否能够在运行时优化此字节码以使两种解决方案都提供相同的性能？

在这个简单的情况下，当然解决方案 2 似乎更合适，但有时出于可读性的目的，我更喜欢解决方案 1，我只想确保不会在关键代码部分引入性能“降低”。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T06:34:24.933

创建临时变量（尤其是像字符串一样小的变量）对代码的速度无关紧要，因此您应该停止担心这一点。

尝试测量在这部分代码中花费的实际时间，我敢打赌你会发现根本没有性能差异。调用`toString()`和打印结果所需的时间比存储临时值所需的时间要长得多，而且我认为您根本不会在这里找到可测量的差异。

即使这里的字节码看起来不同，那也是因为它`javac`很幼稚，而您的 JIT 编译器为您完成了繁重的工作。如果这段代码真的对速度很重要，那么它将被执行很多次，你的 JIT 会选择它来编译为本机代码。很可能这两者都编译为相同的本机代码。

最后，为什么要调用`System.out.println()`性能关键代码？如果这里有什么东西会影响你的表现，那会。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T06:28:29.843

如果您有需要性能的关键代码部分，请避免使用`System.out.println()`. 与变量赋值相比，转到标准输出会产生更多的开销。

做解决方案1。

**编辑**：或解决方案2

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T06:30:10.197

没有*代码足够关键，以至于您的两个示例之间的差异根本没有任何区别。我鼓励您对此进行测试；运行数百万次，并记录所用时间。

选择更具可读性和可维护性的形式。

`*`夸大效果。如果您的代码足够关键，那么您已经研究过它来学习这一点。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T06:30:46.657

生成的字节码*不能*很好地衡量给定代码段的性能，因为如果该字节码被认为是性能瓶颈。

如有疑问，请使用分析器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T06:27:56.427

与控制台的输出相比，我怀疑两者之间*的*性能差异是否可以衡量。在您测量并确认您有问题之前不要进行优化。

# visual-studio - Visual Studio：循环断点

> ID：943341
> 
> 赞同：23
> 
> 时间：2009-06-03T06:28:54.850
> 
> 标签：visual-studio, keyboard-shortcuts, breakpoints

是否有循环通过我的断点的快捷方式？在调试项目时，我经常忘记断点。当我处理完一个错误后，我必须为即将解决的新错误重置断点。有一个按键可以让我循环通过断点并禁用我不需要的断点并保留我需要的断点会很方便。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-06-03T06:35:53.260

您可以随时打开断点窗口 ( `Ctrl`+ `Alt`+ `B`) 来循环浏览它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T06:35:50.390

我不相信你可以。

您可以显示所有断点的列表并使用断点视图（Debug / Windows / Breakpoints）跳转到它们。

如果您愿意，您也可以编写一个宏来执行此操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T06:45:14.553

我认为没有内置的方法可以做到这一点。但是，您可能想看看这个[问题](https://stackoverflow.com/questions/653974/is-there-a-breakpoint-plugin-for-visual-studio)。您可能可以保存一个错误的断点并在需要时加载它。

# java - 语法特征“long foo = 12L;”的技术名称是什么？Java中硬编码值的样式转换？

> ID：943350
> 
> 赞同：2
> 
> 时间：2009-06-03T06:31:34.797
> 
> 标签：java, syntax, literals

今天，我试图将一个硬编码的值转换为一个 short 并且 S 不起作用。于是，我去搜了一下，结果发现我什至不知道Java语法的这个特性叫什么。它有名字吗？如果没有，是否至少列出了转换硬编码数值的所有可能方法？

**结语**

在得到“文字”的答案后，我能够回答我关于短裤的问题。如果您想知道，Java 中没有短文字。你只需要明确地将它转换为：`(short)12`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T06:33:40.707

它们被称为*字面量*。

从Java 教程的[原始数据类型页面：](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/datatypes.html)

> 字面量是固定值的源代码表示；文字直接在您的代码中表示，无需计算。

[在 Literals 部分下的Primitive Data Types](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/datatypes.html)页面中有一个可以使用的文字列表。

[第 3.10 节：](http://java.sun.com/docs/books/jls/third_edition/html/lexical.html#3.10) Java 语言规范的文字，[第三版](http://java.sun.com/docs/books/jls/third_edition/html/j3TOC.html)也有一个完整的列表。

# asp.net - 将 Web 应用程序部署到 IIS 后的 JavaScript

> ID：943361
> 
> 赞同：0
> 
> 时间：2009-06-03T06:33:49.647
> 
> 标签：asp.net, javascript, iis

我开发了一个使用大量 JavaScript 的 Web 应用程序。我在我的机器上开发了第一部分代码，一切正常。部署到远程机器到 IIS 后出现问题 - 页面运行但即我编写的​​整个验证没有运行 - 我在 FF、IE6、IE7 下检查过。是否有任何 IIS 属性可以设置以使其运行？

**编辑** 我刚刚发现问题出在这里：

```
<script type="text/javascript">
   function validate() {
      return validateTrees();
   }
</script> 
```

validate() 函数在这里被调用：

```
<asp:Button ID="btnSubmit" CssClass="button" runat="server" OnClientClick="return validate();" Text="Send for approval" /> 
```

并且 validateTrees() 函数由控件从 .js 文件动态加载：

```
<cust:CustomTreeControl ID="CustomTreeControl 1" runat="server" /> 
```

它位于此提交按钮之前。似乎部署后浏览器找不到 validateTrees() 函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T06:38:51.167

无论如何，IIS 都不应该影响您的 JS（只要 JS 文件存在并且可以正确访问）。

您能否发布一些代码示例，说明您拥有什么（最好是简单的测试用例）以及您期望它做什么和没有做什么，以及您遇到的错误（如果有的话）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T06:39:56.263

IIS 与此无关。

您的 javascript 文件由客户端计算机上的浏览器下载并在那里运行，而不是在服务器上运行。

确保您发布的文件正确无误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T06:41:36.870

Javascript 通常在客户端而不是服务器上运行。是什么让您认为这与 IIS 有任何关系？

使用诸如[fiddler](http://www.fiddler2.com)之类的工具来确认浏览器正在接收您期望的所有内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T10:43:26.587

好的，这很愚蠢，我没有在部署后更新脚本的路径。

# java - 带有惰性求值的 String.format

> ID：943367
> 
> 赞同：24
> 
> 时间：2009-06-03T06:36:27.317
> 
> 标签：java, logging, lazy-evaluation

我需要类似于[String.format(...)](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/String.html#format(java.lang.String,%20java.lang.Object...))方法的东西，但需要延迟评估。

这个lazyFormat 方法应该返回一些对象，其toString() 方法将评估格式模式。

我怀疑有人已经这样做了。这在任何库中都可用吗？

我想替换它（记录器是 log4j 实例）：

```
if(logger.isDebugEnabled() ) {
   logger.debug(String.format("some texts %s with patterns %s", object1, object2));
} 
```

有了这个：

```
logger.debug(lazyFormat("some texts %s with patterns %s", object1, object2)); 
```

仅当启用调试日志记录时，我才需要lazyFormat 格式化字符串。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-03T06:46:17.750

如果您正在寻找“简单”的解决方案：

```
 public class LazyFormat {

    public static void main(String[] args) {
        Object o = lazyFormat("some texts %s with patterns %s", "looong string", "another loooong string");
        System.out.println(o);
    }

    private static Object lazyFormat(final String s, final Object... o) {
        return new Object() {
            @Override
            public String toString() {
                return String.format(s,o);
            }
        };
    }
} 
```

输出：

> 一些文本 loooong 带有模式的字符串 另一个 loooong 字符串

`isDebugEnabled()`如果愿意，您当然可以在lazyFormat中添加任何语句。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2012-12-29T05:16:13.653

可以通过在最新的 log4j 2.X 版本[http://logging.apache.org/log4j/2.x/log4j-users-guide.pdf](http://logging.apache.org/log4j/2.x/log4j-users-guide.pdf)中使用参数替换来完成：

> 4.1.1.2 参数替换
> 
> 通常，记录的目的是提供有关系统中正在发生的事情的信息，这需要包括有关被操作对象的信息。在 Log4j 1.x 中，这可以通过执行以下操作来完成：

```
if (logger.isDebugEnabled()) {     
  logger.debug("Logging in user " + user.getName() + " with id " + user.getId()); 
} 
```

> 重复执行此操作会使代码感觉更像是日志记录而不是手头的实际任务。此外，它会导致日志级别被检查两次；一次调用 isDebugEnabled 和一次调试方法。更好的选择是：

```
logger.debug("Logging in user {} with id {}", user.getName(), user.getId()); 
```

> 使用上面的代码，日志级别只会检查一次，并且只有在启用调试日志时才会发生字符串构造。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-06-03T06:40:07.357

如果您正在寻找延迟连接以实现高效日志记录，请查看[Slf4J](http://www.slf4j.org/) ，它允许您编写：

```
LOGGER.debug("this is my long string {}", fatObject); 
```

只有设置了调试级别，才会发生字符串连接。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-08-19T15:33:01.163

**重要说明：**强烈建议将所有日志记录代码移动到使用[SLF4J](http://www.slf4j.org/)（尤其是 log4j 1.x）。它可以保护您免受特定日志记录实现的任何类型的特殊问题（即错误）的困扰。它不仅为众所周知的后端实现问题提供了“修复”，而且还适用于多年来出现的更新更快的实现。

* * *

[直接回答您的问题，这里是使用SLF4J](http://www.slf4j.org/)的样子：

```
LOGGER.debug("some texts {} with patterns {}", object1, object2); 
```

您提供的最重要的一点是您正在传递两个 Object 实例。和方法不会立即评估`object1.toString()`。`object2.toString()`更重要的是，这些`toString()`方法只有在它们返回的数据实际上要被使用时才会被评估；即惰性求值的真正含义。

我试图想出一种我可以使用的更通用的模式，它不需要我必须覆盖`toString()`大量的类（并且有些类我无权进行覆盖）。我想出了一个简单的就地解决方案。同样，使用[SLF4J](http://www.slf4j.org/)，我仅在启用级别的日志记录时/才编写字符串。这是我的代码：

```
 class SimpleSfl4jLazyStringEvaluation {
      private static final Logger LOGGER = LoggerFactory.getLogger(SimpleSfl4jLazyStringEvaluation.class);

      ...

      public void someCodeSomewhereInTheClass() {
//all the code between here
        LOGGER.debug(
            "{}"
          , new Object() {
              @Override
              public String toString() {
                return "someExpensiveInternalState=" + getSomeExpensiveInternalState();
              }
            }
//and here can be turned into a one liner
        );
      }

      private String getSomeExpensiveInternalState() {
        //do expensive string generation/concatenation here
      }
    } 
```

为了简化为**one-liner**，您可以将 someCodeSomewhereInTheClass() 中的 LOGGER 行缩短为：

```
LOGGER.debug("{}", new Object(){@Override public String toString(){return "someExpensiveInternalState=" + getSomeExpensiveInternalState();}}); 
```

我现在已经重构了我所有的日志记录代码以遵循这个简单的模型。它已经大大整理了一些东西。现在，当我看到任何不使用它的日志记录代码时，我会重构日志记录代码以使用这个新模式，即使它还需要它。这样，如果/当稍后进行更改以需要添加一些“昂贵的”操作时，基础设施样板已经存在，将任务简化为仅添加操作。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-03T07:24:00.717

基于[Andreas 的回答](https://stackoverflow.com/questions/943367/string-format-with-lazy-evaluation/943396#943396)，我可以想到几种方法来解决仅在`Logger.isDebugEnabled`返回时执行格式化的问题`true`：

**选项 1：传入“执行格式化”标志**

一种选择是有一个方法参数来告诉是否实际执行格式化。一个用例可能是：

```
System.out.println(lazyFormat(true, "Hello, %s.", "Bob"));
System.out.println(lazyFormat(false, "Hello, %s.", "Dave")); 
```

输出将是：

```
Hello, Bob.
null 
```

的代码`lazyFormat`是：

```
private String lazyFormat(boolean format, final String s, final Object... o) {
  if (format) {
    return String.format(s, o);
  }
  else {
    return null;
  }
} 
```

在这种情况下，只有在标志设置为时`String.format`才会执行，如果设置为，它将返回一个。这将停止记录消息的格式化，并且只会发送一些“虚拟”信息。`format``true``false``null`

所以记录器的用例可能是：

```
logger.debug(lazyFormat(logger.isDebugEnabled(), "Message: %s", someValue)); 
```

此方法不完全符合问题中要求的格式。

**选项 2：检查记录器**

另一种方法是直接询问记录器是否`isDebugEnabled`：

```
private static String lazyFormat(final String s, final Object... o) {
  if (logger.isDebugEnabled()) {
    return String.format(s, o);
  }
  else {
    return null;
  }
} 
```

在这种方法中，预计`logger`将在`lazyFormat`方法中可见。这种方法的好处是调用者在调用时不需要检查`isDebugEnabled`方法`lazyFormat`，所以典型的用法可以是：

```
logger.debug(lazyFormat("Debug message is %s", someMessage)); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-06-03T13:28:25.923

您可以将 Log4J 记录器实例包装在您自己的 Java5 兼容/String.format 兼容类中。就像是：

```
public class Log4jWrapper {

    private final Logger inner;

    private Log4jWrapper(Class<?> clazz) {
        inner = Logger.getLogger(clazz);
    }

    public static Log4jWrapper getLogger(Class<?> clazz) {
        return new Log4jWrapper(clazz);
    }

    public void trace(String format, Object... args) {
        if(inner.isTraceEnabled()) {
            inner.trace(String.format(format, args));    
        }
    }

    public void debug(String format, Object... args) {
        if(inner.isDebugEnabled()) {
            inner.debug(String.format(format, args));    
        }
    }

    public void warn(String format, Object... args) {
        inner.warn(String.format(format, args));    
    }

    public void error(String format, Object... args) {
        inner.error(String.format(format, args));    
    }

    public void fatal(String format, Object... args) {
        inner.fatal(String.format(format, args));    
    }    
} 
```

要使用包装器，请将您的记录器字段声明更改为：

```
private final static Log4jWrapper logger = Log4jWrapper.getLogger(ClassUsingLogging.class); 
```

包装类将需要一些额外的方法，例如它当前不处理日志记录异常（即 logger.debug(message, exception)），但这应该不难添加。

使用该类几乎与 log4j 相同，除了字符串被格式化：

```
logger.debug("User {0} is not authorized to access function {1}", user, accessFunction) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-02-23T14:08:56.413

Log4j 1.2.16 中引入了两个可以为您执行此操作的类。

`org.apache.log4j.LogMF`它使用`java.text.MessageFormat`for 格式发送消息并`org.apache.log4j.LogSF`使用“SLF4J 模式语法”，据说速度更快。

以下是示例：

```
LogSF.debug(log, "Processing request {}", req); 
```

和

```
 LogMF.debug(logger, "The {0} jumped over the moon {1} times", "cow", 5); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2017-06-14T13:36:49.960

如果您比 {0} 语法更喜欢 String.format 语法并且可以使用**Java 8 / JDK 8**，那么您可以使用 lambdas / Suppliers：

`logger.log(Level.FINER, () -> String.format("SomeOperation %s took %04dms to complete", name, duration));`

`()->...`在这里充当供应商，将被懒惰地评估。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-03T20:59:48.727

或者你可以把它写成

```
debug(logger, "some texts %s with patterns %s", object1, object2); 
```

和

```
public static void debug(Logger logger, String format, Object... args) {
    if(logger.isDebugEnabled()) 
       logger.debug(String.format("some texts %s with patterns %s", args));
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-03T06:47:34.830

您可以定义一个包装器，以便`String.format()`仅在需要时调用。

有关详细的代码示例，请参阅[此问题](https://stackoverflow.com/questions/105852/conditional-logging-with-minimal-cyclomatic-complexity/105908#105908)。

正如安德烈亚斯的回答所建议的，同样的问题也有一个[可变参数函数示例。](https://stackoverflow.com/questions/105852/conditional-logging-with-minimal-cyclomatic-complexity/106031#106031)

# .net - Linq 并比较两个日期列

> ID：943379
> 
> 赞同：0
> 
> 时间：2009-06-03T06:41:11.143
> 
> 标签：.net, linq, .net-3.5

运行以下 linq 查询时出现不支持的异常。任何想法如何解决它

```
 var declines = from d in _Db.DeclinedSettlementSet
                       where d.STATUS == Status.REPORTED               
                        && d.ADD_DATE < d.EDIT_DATE.AddDays(-3) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T06:56:36.590

从 SP1 开始，Microsoft 已从表达式树中删除了对客户端功能的支持，这样做是为了提高性能。在简单的世界中，任何客户端功能都不能像您的.AddDays（n）一样包含在其中。关于乔恩的回答，我认为它也不起作用，因为 TimeSpan 也是客户端功能。

# java - 调用java方法时如何设置请求参数值？

> ID：943387
> 
> 赞同：1
> 
> 时间：2009-06-03T06:44:29.483
> 
> 标签：java

我需要从jsp页面调用java类的方法。在jsp页面调用时，还需要设置一些请求参数。我如何在jsp页面中做到这一点？

前任 ：

Java类：

```
 public void execute() {
     string msg = request.getParameter("text");
 } 
```

JSP 文件：

```
 I need to call the method here and also need to set parameter values (eg : &text=hello) 
```

请帮我...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T06:50:10.207

只需将您的 Java 代码嵌入到 JSP 中。对象“请求”可用于获取参数（不能设置参数）。除非您打算在具有属性的另一个上下文中转发到另一个 JSP，否则就足够了。

要引用您自己的类，不要忘记在 JSP 的开头添加 import 语句（类似于 Java 类中的导入）。

```
<!-- JSP starts here -->
<%@page import="test.MyClass" %>

<%
MyClass myClass = new MyClass();
String text=myClass.execute();

// This is not neccessary for this JSP since text variable is already available locally.
// Use it to forward to another page.
request.setAttribute("text");
%>

<p>
This is the <%=text%>
</p> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T07:12:16.620

不能设置请求参数。我建议您尝试使用前面答案中建议的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T06:52:16.317

您不能设置请求参数 - 它们应该来自客户端。

如果你需要给方法一些信息，你应该使用普通的方法参数，或者其他一些状态。请求参数不适合这个，IMO。

# python - 如何使用正则表达式获取函数声明或定义

> ID：943391
> 
> 赞同：6
> 
> 时间：2009-06-03T06:45:13.163
> 
> 标签：python, regex

我只想得到函数原型，比如

```
int my_func(char, int, float)
void my_func1(void)
my_func2() 
```

从 C 文件使用正则表达式和 python。

这是我的正则表达式格式：`".*\(.*|[\r\n]\)\n"`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T06:58:45.477

这是我为此类任务编写的一个方便的脚本，但它不会给出函数类型。它仅适用于函数名称和参数列表。

```
# Exctract routine signatures from a C++ module
import re

def loadtxt(filename):
    "Load text file into a string. I let FILE exceptions to pass."
    f = open(filename)
    txt = ''.join(f.readlines())
    f.close()
    return txt

# regex group1, name group2, arguments group3
rproc = r"((?<=[\s:~])(\w+)\s*\(([\w\s,<>\[\].=&':/*]*?)\)\s*(const)?\s*(?={))"
code = loadtxt('your file name here')
cppwords = ['if', 'while', 'do', 'for', 'switch']
procs = [(i.group(2), i.group(3)) for i in re.finditer(rproc, code) \
 if i.group(2) not in cppwords]

for i in procs: print i[0] + '(' + i[1] + ')' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T07:23:46.783

看看你的 C 编译器是否有一个选项来输出一个只包含它正在编译的原型的文件。对于 gcc，它是 -aux-info FILENAME

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T07:40:44.317

我认为正则表达式不是您的最佳解决方案。有很多陷阱，例如注释、字符串中的文本等，但是如果您的函数原型具有共同的风格：

```
type fun_name(args); 
```

那么`\w+ \w+\(.*\);`在大多数情况下应该可以工作：

```
mn> egrep "\w+ \w+\(.*\);" *.h
md5.h:extern bool md5_hash(const void *buff, size_t len, char *hexsum);
md5file.h:int check_md5files(const char *filewithsums, const char *filemd5sum); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T09:44:56.937

我认为这个应该做的工作：

```
r"^\s*[\w_][\w\d_]*\s*.*\s*[\w_][\w\d_]*\s*\(.*\)\s*$" 
```

这将扩展为：

```
string begin:   
        ^
any number of whitespaces (including none):
        \s*
return type:
  - start with letter or _:
        [\w_]
  - continue with any letter, digit or _:
        [\w\d_]*
any number of whitespaces:
        \s*
any number of any characters 
  (for allow pointers, arrays and so on,
  could be replaced with more detailed checking):
        .*
any number of whitespaces:
        \s*
function name:
  - start with letter or _:
        [\w_]
  - continue with any letter, digit or _:
        [\w\d_]*
any number of whitespaces:
        \s*
open arguments list:
        \(
arguments (allow none):
        .*
close arguments list:
        \)
any number of whitespaces:
        \s*
string end:
        $ 
```

匹配所有可能的组合并不完全正确，但应该适用于更多情况。如果您希望它更准确，请告诉我。

编辑：免责声明 - 我对 Python 和正则表达式都很陌生，所以请放纵 ;)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T12:20:31.910

尝试仅使用正则表达式“解析” C 代码（或至少提取一些信息）有很多陷阱，我肯定会为您最喜欢的解析器生成器借用一个 C（比如 Bison 或 Python 的任何替代方案，有 C语法作为例子无处不在）并在相应的规则中添加动作。

另外，不要忘记在解析之前对文件运行 C 预处理器。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-05-03T05:02:17.187

我建立在 Nick Dandoulakis对类似用例的[回答之上。](https://stackoverflow.com/a/943429/724752)我想`socket`在glibc中找到函数的定义。这找到了一堆名称中带有“socket”`socket`但未找到的函数，突出了许多其他人所说的：可能有更好的方法来提取这些信息，比如编译器提供的工具。

```
# find_functions.py
#
# Extract routine signatures from a C++ module
import re
import sys

def loadtxt(filename):
    # Load text file into a string. Ignore FILE exceptions.
    f = open(filename)
    txt = ''.join(f.readlines())
    f.close()
    return txt

# regex group1, name group2, arguments group3
rproc = r"((?<=[\s:~])(\w+)\s*\(([\w\s,<>\[\].=&':/*]*?)\)\s*(const)?\s*(?={))"
file = sys.argv[1]
code = loadtxt(file)

cppwords = ['if', 'while', 'do', 'for', 'switch']
procs = [(i.group(1)) for i in re.finditer(rproc, code) \
 if i.group(2) not in cppwords]

for i in procs: print file + ": " + i 
```

然后

```
$ cd glibc
$ find . -name "*.c" -print0 | xargs -0 -n 1 python find_functions.py | grep ':.*socket'
./hurd/hurdsock.c: _hurd_socket_server (int domain, int dead)
./manual/examples/mkfsock.c: make_named_socket (const char *filename)
./manual/examples/mkisock.c: make_socket (uint16_t port)
./nscd/connections.c: close_sockets (void)
./nscd/nscd.c: nscd_open_socket (void)
./nscd/nscd_helper.c: wait_on_socket (int sock, long int usectmo)
./nscd/nscd_helper.c: open_socket (request_type type, const char *key, size_t keylen)
./nscd/nscd_helper.c: __nscd_open_socket (const char *key, size_t keylen, request_type type,
./socket/socket.c: __socket (int domain, int type, int protocol)
./socket/socketpair.c: socketpair (int domain, int type, int protocol, int fds[2])
./sunrpc/key_call.c: key_call_socket (u_long proc, xdrproc_t xdr_arg, char *arg,
./sunrpc/pm_getport.c: __get_socket (struct sockaddr_in *saddr)
./sysdeps/mach/hurd/socket.c: __socket (int domain, int type, int protocol)
./sysdeps/mach/hurd/socketpair.c: __socketpair (int domain, int type, int protocol, int fds[2])
./sysdeps/unix/sysv/linux/socket.c: __socket (int fd, int type, int domain)
./sysdeps/unix/sysv/linux/socketpair.c: __socketpair (int domain, int type, int protocol, int sv[2]) 
```

就我而言，[这](https://stackoverflow.com/questions/8658747/socket-function-definition)和[这](http://www.skyfree.org/linux/kernel_network/socket.html)可能对我有帮助，但似乎我需要阅读汇编代码才能重用那里描述的策略。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-10-19T07:19:21.260

下面的正则表达式还考虑了析构函数或 const 函数的定义：

```
^\s*\~{0,1}[\w_][\w\d_]*\s*.*\s*[\w_][\w\d_]*\s*\(.*\)\s*(const){0,1}$ 
```

# asp.net - LinkBut ton 不会在 click() 上调用

> ID：943397
> 
> 赞同：16
> 
> 时间：2009-06-03T06:46:20.433
> 
> 标签：asp.net, jquery

为什么这不起作用？

```
 <script src="Scripts/jquery-1.3.2.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $('.myButton').click();
        });
    </script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:LinkButton id="ttt" runat="server" PostBackUrl="~/Default.aspx" CssClass="myButton">Click</asp:LinkButton>
    </div>
    </form> 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-03T07:05:03.763

您要提交表单，还是添加 Click 事件？您的链接按钮转换为

```
<a id="ttt" class="myButton" href="javascript:WebForm_DoPos[...]">Click</a> 
```

，所以它没有点击 javascript。因此，`.click();`什么都不做。
我还没有测试它，但也许这会起作用：

```
eval($('.myButton').attr('href')); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-08T14:14:42.000

trigger('click') 触发 .NET 未连接的 jQuery 的单击事件侦听器。您可以触发 javascript click 事件，该事件将转到（或在这种情况下运行）href 属性中的内容：

```
 $('.myButton')[0].click(); 
```

或者

```
 ($('.myButton').length ? $('.myButton') : $('<a/>'))[0].click(); 
```

如果您不确定该按钮是否会出现在页面上。

乔

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-04-18T22:39:14.727

如果需要触发链接按钮的 OnClick 服务器端事件，则需要使用 __doPostback(eventTarget, eventArgument)。

前任：

```
<asp:LinkButton ID="btnMyButton" runat="Server" OnClick="Button_Click" />

<script type="text/javascript">

function onMyClientClick(){ 
  //do some client side stuff

  //'click' the link button, form will post, Button_Click will fire on back-end
  //that's two underscores
  __doPostBack('<%=btnMyButton.UniqueID%>', ''); //the second parameter is required and superfluous, just use blank
}

</script> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T06:48:53.140

您需要分配一个事件处理程序以在引发单击事件时触发

```
 $(document).ready(function() {
        $('.myButton', '#form1')
            .click(function() {  
                /* 
                   Your code to run when Click event is raised.
                   In this case, something like window.location = "http://..."                      
                   This can be an anonymous or named function
                */
                return false; // This is required as you have set a PostbackUrl
                              // on the LinkButton which will post the form
                              // to the specified URL
            }); 
    }); 
```

我已经用 ASP.NET 3.5 测试了上面的内容，它按预期工作。

Linkbutton 上还有一个[`OnClientClick`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.linkbutton.onclientclick.aspx)属性，它指定在引发单击事件时要运行的客户端脚本。

我能问一下你想达到什么目标吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T06:51:22.997

单击事件处理程序必须实际执行操作。试试这个：

```
$(function () {
    $('.myButton').click(function () { alert('Hello!'); });
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T06:57:35.107

您需要给 linkBut​​ton 一个 CssClass="myButton" 然后在顶部使用它

```
$(document).ready(function() {
        $('.myButton').click(function(){
             alert("hello thar");
        });
    }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T07:16:56.643

这是一个艰难的。据我了解，您想模仿在 javascript 代码中单击按钮的行为。问题是 ASP.NET 向 onclick 处理程序添加了一些花哨的 javascript 代码。

在 jQuery 中手动触发事件时，只会执行 jQuery 添加的事件代码，不会执行 onclick 属性或 href 属性中的 javascript。所以想法是创建一个新的事件处理程序，它将执行属性中定义的原始 javascript。

我要提出的建议尚未经过测试，但我会试一试：

```
$(document).ready(function() {

// redefine the event
$(".myButton").click(function() {
   var href = $(this).attr("href");

   if (href.substr(0,10) == "javascript:") {
      new Function(href.substr(10)).call(this);
      // this will make sure that "this" is
      // correctly set when evaluating the javascript
      // code
   } else {
      window.location = href;
   }

   return false;
});

// this will fire the click:

$(".myButton").click();

}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2011-01-14T19:25:35.700

澄清一下，只有 FireFox 会遇到这个问题。请参阅[http://www.devtoolshed.com/content/fix-firefox-click-event-issue](http://www.devtoolshed.com/content/fix-firefox-click-event-issue)。在 FireFox 中，anchor (a) 标签没有 click() 函数来允许 JavaScript 代码直接在它们上模拟点击事件。它们**确实**允许您映射锚标记的点击**事件**，而不是使用 click() 函数来模拟它。

幸运的是，ASP.NET 将 JavaScript 回发代码放入 href 属性中，您可以在其中获取它并在其上运行 eval。（或者只是调用 window.location.href = document.GetElementById('LinkBut​​ton1').href;）。

或者，您可以调用 __doPostBack('LinkBut​​ton1'); 请注意，“LinkBut​​ton1”应替换为 LinkBut​​ton 的 ClientID/UniqueID 以处理命名容器，例如 UserControls、MasterPages 等。

乔丹·里格

# c# - 从 C# 中的枚举中获取 int 值

> ID：943398
> 
> 赞同：2141
> 
> 时间：2009-06-03T06:46:39.357
> 
> 标签：c#, enums, casting, int

我有一个名为`Questions`（复数）的课程。在这个类中有一个名为`Question`(singular) 的枚举，它看起来像这样。

```
public enum Question
{
    Role = 2,
    ProjectFunding = 3,
    TotalEmployee = 4,
    NumberOfServers = 5,
    TopBusinessConcern = 6
} 
```

在`Questions`类中，我有一个`get(int foo)`返回`Questions`对象的函数`foo`。有没有一种简单的方法可以从枚举中获取整数值，以便我可以做这样的事情`Questions.Get(Question.Role)`？

* * *

## 回答 #1

> 赞同：2722
> 
> 时间：2009-06-03T06:49:18.553

只需投射枚举，例如

```
int something = (int) Question.Role; 
```

以上将适用于您在野外看到的绝大多数枚举，因为枚举的默认基础类型是`int`.

然而，正如[cecilphillip 所](https://stackoverflow.com/users/333082/cecilphillip)指出的，枚举可以有不同的底层类型。如果枚举被声明为`uint`、`long`或`ulong`，则应将其强制转换为枚举的类型；例如对于

```
enum StarsInMilkyWay:long {Sun = 1, V645Centauri = 2 .. Wolf424B = 2147483649}; 
```

你应该使用

```
long something = (long)StarsInMilkyWay.Wolf424B; 
```

* * *

## 回答 #2

> 赞同：349
> 
> 时间：2010-07-09T14:54:16.767

由于 Enums 可以是任何整数类型（`byte`、`int`、`short`等），获取枚举的基础整数值的更可靠的方法是将该`GetTypeCode`方法与`Convert`类结合使用：

```
enum Sides {
    Left, Right, Top, Bottom
}
Sides side = Sides.Bottom;

object val = Convert.ChangeType(side, side.GetTypeCode());
Console.WriteLine(val); 
```

无论底层的整数类型如何，这都应该有效。

* * *

## 回答 #3

> 赞同：213
> 
> 时间：2012-06-15T19:28:37.827

将其声明为具有公共常量的静态类：

```
public static class Question
{
    public const int Role = 2;
    public const int ProjectFunding = 3;
    public const int TotalEmployee = 4;
    public const int NumberOfServers = 5;
    public const int TopBusinessConcern = 6;
} 
```

然后您可以将其引用为`Question.Role`，并且它始终评估为 an`int`或您将其定义为的任何内容。

* * *

## 回答 #4

> 赞同：103
> 
> 时间：2013-12-01T08:47:44.817

在相关说明中，如果您想从中获取`int`值`System.Enum`，则`e`在此处给出：

```
Enum e = Question.Role; 
```

您可以使用：

```
int i = Convert.ToInt32(e);
int i = (int)(object)e;
int i = (int)Enum.Parse(e.GetType(), e.ToString());
int i = (int)Enum.ToObject(e.GetType(), e); 
```

最后两个简直丑陋。我更喜欢第一个。

* * *

## 回答 #5

> 赞同：100
> 
> 时间：2009-06-03T06:48:16.030

```
Question question = Question.Role;
int value = (int) question; 
```

将导致`value == 2`.

* * *

## 回答 #6

> 赞同：44
> 
> 时间：2009-06-03T06:51:59.360

它比您想象的要容易 - 枚举已经是 int。只是需要提醒一下：

```
int y = (int)Question.Role;
Console.WriteLine(y); // Prints 2 
```

* * *

## 回答 #7

> 赞同：43
> 
> 时间：2009-09-25T10:43:14.107

例子：

```
public enum EmpNo
{
    Raj = 1,
    Rahul,
    Priyanka
} 
```

并在后面的代码中获取枚举值：

```
int setempNo = (int)EmpNo.Raj; // This will give setempNo = 1 
```

或者

```
int setempNo = (int)EmpNo.Rahul; // This will give setempNo = 2 
```

枚举将递增 1，您可以设置起始值。如果您不设置起始值，它将最初分配为 0。

* * *

## 回答 #8

> 赞同：31
> 
> 时间：2013-03-30T01:08:55.633

我最近在我的代码中不再使用枚举，而是使用具有受保护构造函数和预定义静态实例的类（感谢 Roelof - [C# Ensure Valid Enum Values - Futureproof Method](https://stackoverflow.com/questions/10704863/c-sharp-ensure-valid-enum-values-futureproof-method)）。

鉴于此，下面是我现在处理这个问题的方式（包括隐式转换到/从`int`）。

```
public class Question
{
    // Attributes
    protected int index;
    protected string name;
    // Go with a dictionary to enforce unique index
    //protected static readonly ICollection<Question> values = new Collection<Question>();
    protected static readonly IDictionary<int,Question> values = new Dictionary<int,Question>();

    // Define the "enum" values
    public static readonly Question Role = new Question(2,"Role");
    public static readonly Question ProjectFunding = new Question(3, "Project Funding");
    public static readonly Question TotalEmployee = new Question(4, "Total Employee");
    public static readonly Question NumberOfServers = new Question(5, "Number of Servers");
    public static readonly Question TopBusinessConcern = new Question(6, "Top Business Concern");

    // Constructors
    protected Question(int index, string name)
    {
        this.index = index;
        this.name = name;
        values.Add(index, this);
    }

    // Easy int conversion
    public static implicit operator int(Question question) =>
        question.index; //nb: if question is null this will return a null pointer exception

    public static implicit operator Question(int index) =>        
        values.TryGetValue(index, out var question) ? question : null;

    // Easy string conversion (also update ToString for the same effect)
    public override string ToString() =>
        this.name;

    public static implicit operator string(Question question) =>
        question?.ToString();

    public static implicit operator Question(string name) =>
        name == null ? null : values.Values.FirstOrDefault(item => name.Equals(item.name, StringComparison.CurrentCultureIgnoreCase));

    // If you specifically want a Get(int x) function (though not required given the implicit converstion)
    public Question Get(int foo) =>
        foo; //(implicit conversion will take care of the conversion for you)
} 
```

这种方法的优点是您可以从枚举中获得所有内容，但是您的代码现在更加灵活，因此如果您需要根据 的值执行不同的操作`Question`，您可以将逻辑放入`Question`自身（即在首选 OO 中）时尚）而不是在整个代码中放置大量案例语句来处理每种情况。

* * *

注意：答案于 2018-04-27 更新以利用 C# 6 功能；即声明表达式和 lambda 表达式主体定义。查看原始代码的[修订历史](https://stackoverflow.com/posts/15713789/revisions)。这样做的好处是使定义不那么冗长；这是对此答案方法的主要抱怨之一。

* * *

## 回答 #9

> 赞同：22
> 
> 时间：2012-06-10T22:58:20.227

如果您想获取存储在变量中的枚举值的整数，其类型将为`Question`，例如在方法中使用，您可以简单地执行我在此示例中编写的操作：

```
enum Talen
{
    Engels = 1, Italiaans = 2, Portugees = 3, Nederlands = 4, Duits = 5, Dens = 6
}

Talen Geselecteerd;    

public void Form1()
{
    InitializeComponent()
    Geselecteerd = Talen.Nederlands;
}

// You can use the Enum type as a parameter, so any enumeration from any enumerator can be used as parameter
void VeranderenTitel(Enum e)
{
    this.Text = Convert.ToInt32(e).ToString();
} 
```

这会将窗口标题更改为 4，因为变量`Geselecteerd`是`Talen.Nederlands`. 如果我将其更改为`Talen.Portugees`并再次调用该方法，则文本将更改为 3。

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2014-09-19T05:42:30.490

另一种方法：

```
Console.WriteLine("Name: {0}, Value: {0:D}", Question.Role); 
```

这将导致：

```
Name: Role, Value: 2 
```

* * *

## 回答 #11

> 赞同：17
> 
> 时间：2011-07-22T20:56:19.087

要确保枚举值存在然后解析它，您还可以执行以下操作。

```
// Fake Day of Week
string strDOWFake = "SuperDay";

// Real Day of Week
string strDOWReal = "Friday";

// Will hold which ever is the real DOW.
DayOfWeek enmDOW;

// See if fake DOW is defined in the DayOfWeek enumeration.
if (Enum.IsDefined(typeof(DayOfWeek), strDOWFake))
{
    // This will never be reached since "SuperDay"
    // doesn't exist in the DayOfWeek enumeration.
    enmDOW = (DayOfWeek)Enum.Parse(typeof(DayOfWeek), strDOWFake);
}
// See if real DOW is defined in the DayOfWeek enumeration.
else if (Enum.IsDefined(typeof(DayOfWeek), strDOWReal))
{
    // This will parse the string into it's corresponding DOW enum object.
    enmDOW = (DayOfWeek)Enum.Parse(typeof(DayOfWeek), strDOWReal);
}

// Can now use the DOW enum object.
Console.Write("Today is " + enmDOW.ToString() + "."); 
```

* * *

## 回答 #12

> 赞同：14
> 
> 时间：2014-04-21T02:51:42.283

改用扩展方法：

```
public static class ExtensionMethods
{
    public static int IntValue(this Enum argEnum)
    {
        return Convert.ToInt32(argEnum);
    }
} 
```

而且用法稍微漂亮一点：

```
var intValue = Question.Role.IntValue(); 
```

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2014-09-27T01:30:47.993

也许我错过了，但有没有人尝试过一个简单的通用扩展方法？

这对我很有用。您可以通过这种方式避免 API 中的类型转换，但最终会导致更改类型操作。[这是对Roslyn](https://en.wikipedia.org/wiki/.NET_Compiler_Platform)进行编程以让编译器为您创建 GetValue<T> 方法的一个很好的案例。

```
 public static void Main()
    {
        int test = MyCSharpWrapperMethod(TestEnum.Test1);

        Debug.Assert(test == 1);
    }

    public static int MyCSharpWrapperMethod(TestEnum customFlag)
    {
        return MyCPlusPlusMethod(customFlag.GetValue<int>());
    }

    public static int MyCPlusPlusMethod(int customFlag)
    {
        // Pretend you made a PInvoke or COM+ call to C++ method that require an integer
        return customFlag;
    }

    public enum TestEnum
    {
        Test1 = 1,
        Test2 = 2,
        Test3 = 3
    }
}

public static class EnumExtensions
{
    public static T GetValue<T>(this Enum enumeration)
    {
        T result = default(T);

        try
        {
            result = (T)Convert.ChangeType(enumeration, typeof(T));
        }
        catch (Exception ex)
        {
            Debug.Assert(false);
            Debug.WriteLine(ex);
        }

        return result;
    }
} 
```

* * *

## 回答 #14

> 赞同：13
> 
> 时间：2014-03-31T16:35:56.253

```
public enum QuestionType
{
    Role = 2,
    ProjectFunding = 3,
    TotalEmployee = 4,
    NumberOfServers = 5,
    TopBusinessConcern = 6
} 
```

...是一个很好的声明。

您必须将结果转换为 int ，如下所示：

```
int Question = (int)QuestionType.Role 
```

否则，类型仍然是`QuestionType`.

这种严格程度是 C# 的方式。

一种替代方法是使用类声明：

```
public class QuestionType
{
    public static int Role = 2,
    public static int ProjectFunding = 3,
    public static int TotalEmployee = 4,
    public static int NumberOfServers = 5,
    public static int TopBusinessConcern = 6
} 
```

声明不太优雅，但您不需要在代码中强制转换：

```
int Question = QuestionType.Role 
```

或者，您可能对 Visual Basic 感觉更舒服，它在许多领域都满足了这种类型的期望。

* * *

## 回答 #15

> 赞同：12
> 
> 时间：2014-09-18T22:53:47.663

```
int number = Question.Role.GetHashCode(); 
```

`number`应该有价值`2`。

* * *

## 回答 #16

> 赞同：12
> 
> 时间：2019-08-12T03:27:28.350

采用：

```
Question question = Question.Role;
int value = question.GetHashCode(); 
```

这将导致`value == 2`.

仅当枚举适合于`int`.

* * *

## 回答 #17

> 赞同：11
> 
> 时间：2012-12-09T22:09:56.603

您可以通过为定义的枚举类型实现[扩展方法来做到这一点：](https://en.wikipedia.org/wiki/Extension_method)

```
public static class MyExtensions
{
    public static int getNumberValue(this Question questionThis)
    {
        return (int)questionThis;
    }
} 
```

这简化了获取当前枚举值的 int 值：

```
Question question = Question.Role;
int value = question.getNumberValue(); 
```

或者

```
int value = Question.Role.getNumberValue(); 
```

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2018-07-27T06:29:29.937

```
public enum Suit : int
{
    Spades = 0,
    Hearts = 1,
    Clubs = 2,
    Diamonds = 3
}

Console.WriteLine((int)(Suit)Enum.Parse(typeof(Suit), "Clubs"));

// From int
Console.WriteLine((Suit)1);

// From a number you can also
Console.WriteLine((Suit)Enum.ToObject(typeof(Suit), 1));

if (typeof(Suit).IsEnumDefined("Spades"))
{
    var res = (int)(Suit)Enum.Parse(typeof(Suit), "Spades");
    Console.Out.WriteLine("{0}", res);
} 
```

* * *

## 回答 #19

> 赞同：6
> 
> 时间：2017-12-06T05:14:37.847

由于可以使用多种原始类型声明枚举，因此转换任何枚举类型的通用扩展方法可能很有用。

```
enum Box
{
    HEIGHT,
    WIDTH,
    DEPTH
}

public static void UseEnum()
{
    int height = Box.HEIGHT.GetEnumValue<int>();
    int width = Box.WIDTH.GetEnumValue<int>();
    int depth = Box.DEPTH.GetEnumValue<int>();
}

public static T GetEnumValue<T>(this object e) => (T)e; 
```

* * *

## 回答 #20

> 赞同：4
> 
> 时间：2013-01-28T13:52:52.347

我能想到的最简单的解决方案是重载这样的`Get(int)`方法：

```
[modifiers] Questions Get(Question q)
{
    return Get((int)q);
} 
```

where`[modifiers]`通常可以与`Get(int)`方法相同。如果您不能编辑`Questions`类或出于某种原因不想编辑，您可以通过编写扩展来重载该方法：

```
public static class Extensions
{
    public static Questions Get(this Questions qs, Question q)
    {
        return qs.Get((int)q);
    }
} 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2014-01-14T20:28:07.547

试试这个，而不是将 enum 转换为 int：

```
public static class ReturnType
{
    public static readonly int Success = 1;
    public static readonly int Duplicate = 2;
    public static readonly int Error = -1;        
} 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2015-06-26T16:51:09.400

我最喜欢的带有 int 或更小的枚举的 hack：

```
GetHashCode(); 
```

对于枚举

```
public enum Test
{
    Min = Int32.MinValue,
    One = 1,
    Max = Int32.MaxValue,
} 
```

这，

```
var values = Enum.GetValues(typeof(Test));

foreach (var val in values)
{
    Console.WriteLine(val.GetHashCode());
    Console.WriteLine(((int)val));
    Console.WriteLine(val);
} 
```

输出

```
one
1
1
max
2147483647
2147483647
min
-2147483648
-2147483648 
```

**免责声明：**

它不适用于基于 long 的枚举。

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2016-12-16T06:58:06.100

以下是扩展方法

```
public static string ToEnumString<TEnum>(this int enumValue)
{
    var enumString = enumValue.ToString();
    if (Enum.IsDefined(typeof(TEnum), enumValue))
    {
        enumString = ((TEnum) Enum.ToObject(typeof (TEnum), enumValue)).ToString();
    }
    return enumString;
} 
```

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2015-08-03T07:12:01.750

我想建议“从枚举中获取'int'值”的示例是

```
public enum Sample
{
    Book = 1, 
    Pen = 2, 
    Pencil = 3
}

int answer = (int)Sample.Book; 
```

现在答案将是 1。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2020-09-23T06:54:32.937

您应该使用[***类型转换***](https://www.w3schools.com/cs/cs_type_casting.asp)，因为我们可以在任何其他语言中使用。

如果你`enum`是这样的——

```
public enum Question
{
    Role = 2,
    ProjectFunding = 3,
    TotalEmployee = 4,
    NumberOfServers = 5,
    TopBusinessConcern = 6
} 
```

而且您需要转换为`int`，然后执行此操作-

```
Question q = Question.Role;
.............
.............
int something = (int) q; 
```

## 关于-

在 C# 中，有两种类型的强制转换：

*   **隐式转换（*自动*）** -将较小的类型转换为较大的类型，例如-

> `char`-> `int`-> `long`-> `float`->`double`

*   **显式转换（*手动*）** -将较大的类型转换为较小的类型，例如-

> `double`-> `float`-> `long`-> `int`->`char`

更多可以在***[这里](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/types/casting-and-type-conversions)***找到。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2016-04-12T07:09:30.300

在 Visual Basic 中，它应该是：

```
Public Enum Question
    Role = 2
    ProjectFunding = 3
    TotalEmployee = 4
    NumberOfServers = 5
    TopBusinessConcern = 6
End Enum

Private value As Integer = CInt(Question.Role) 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2021-01-12T02:14:04.690

将为您提供包含 enum 的所有整数值的列表：

列出 enumValues = Enum.GetValues(typeof(EnumClass)).Cast().ToList();

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2021-06-10T16:09:43.990

```
public enum ViewType
{
    List = 1,
    Table = 2,
};

// You can use the Enum type as a parameter, so any enumeration from any enumerator 
// cshtml
// using proyects.Helpers
// @if (Model.ViewType== (int)<variable>.List ) 
```

* * *

## 回答 #29

> 赞同：-2
> 
> 时间：2019-03-02T17:55:26.353

我想出了这个包含当前语言功能的扩展方法。通过使用动态，我不需要使它成为一个通用方法并指定使调用更简单和一致的类型：

```
public static class EnumEx
{
    public static dynamic Value(this Enum e)
    {
        switch (e.GetTypeCode())
        {
            case TypeCode.Byte:
            {
                return (byte) (IConvertible) e;
            }

            case TypeCode.Int16:
            {
                return (short) (IConvertible) e;
            }

            case TypeCode.Int32:
            {
                return (int) (IConvertible) e;
            }

            case TypeCode.Int64:
            {
                return (long) (IConvertible) e;
            }

            case TypeCode.UInt16:
            {
                return (ushort) (IConvertible) e;
            }

            case TypeCode.UInt32:
            {
                return (uint) (IConvertible) e;
            }

            case TypeCode.UInt64:
            {
                return (ulong) (IConvertible) e;
            }

            case TypeCode.SByte:
            {
                return (sbyte) (IConvertible) e;
            }
        }

        return 0;
    } 
```

# vba - Word VBA 宏中的错误，试图将值插入书签

> ID：943402
> 
> 赞同：1
> 
> 时间：2009-06-03T06:47:37.903
> 
> 标签：vba, text-files, ms-word

我正在尝试编写一个 Word 宏，它将注册表中当前用户的数据插入到文档中的预定义书签中。我有一个 ini 文件，它规定了每个注册表项的名称，然后将该值导入 Word 宏中的循环中。这很好用（我认为），但 Word 宏也需要将数据插入到文档中。如果书签在那里，这很好用，但如果它们不在那里，宏似乎无论如何都会插入数据。我不想要那个。如果有一个与名称对应的书签，我只想让宏插入数据。我已经做到了，每个书签都需要被称为““书签”和 sBookMarkname”。

这是代码..

```
Sub MalData()
    ''
    ''// MalData Macro
    ''

    Dim objShell
    Dim strShell
    Dim strDataArea
    Dim Verdier() As String
    Dim regPath
    Dim regString
    Dim Felter
    Dim WScript

    Dim sFileName As String
    Dim iFileNum As Integer
    Dim sBuf As String

    sFileName = "C:\felter.ini"
    If Len(Dir$(sFileName)) = 0 Then
        MsgBox ("Can't find " & sFileName)
    End If

    ''//Load values from ini-file which is later used to query the registry

    Set objShell = CreateObject("Wscript.Shell")

    With New Scripting.FileSystemObject
    With .OpenTextFile(sFileName, ForReading)

        If Not .AtEndOfStream Then regPath = .ReadLine
        If Not .AtEndOfStream Then regString = .ReadLine

        Do Until .AtEndOfStream
            Felter = .ReadLine

            On Error Resume Next
            Dim sBookMarkName, sVerdi
            sBookMarkNametemp = "Bookmark" & Felter
            MsgBox (sBookMarkNametemp)
            sVerdi = objShell.RegRead(regPath & "\" & Felter) ''"

            sBookMarkName = ""
            sBookMarkName = (sBookMarkNametemp)

            If sVerdi <> Felter Then
                Selection.GoTo What:=wdGoToBookmark, Name:=sBookMarkName
                Selection.Delete Unit:=wdCharacter, Count:=0
                Selection.InsertAfter sVerdi
                ActiveDocument.Bookmarks.Add Range:=Selection.Range, Name:=sBookMarkName
            End If
        Loop

        On Error GoTo 0
    End With
    End With

End Sub 
```

现在，错误发生在大约这里：

```
sVerdi = objShell.RegRead(regPath & "\" & Felter) ''"

sBookMarkName = ""
sBookMarkName = (sBookMarkNametemp)

If sVerdi <> Felter Then 
```

即使注册表只包含三个键，宏也会遍历从文本文件中获取的每个名称，并多次插入最后一个注册表键。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T07:14:11.267

为什么不在插入名称之前检查书签是否存在？

```
If ActiveDocument.Bookmarks.Exists(sBookmarkName) Then
    ... insert using your code
End If 
```

# f# - F# 中带有对象/记录的无点样式

> ID：943405
> 
> 赞同：3
> 
> 时间：2009-06-03T06:48:39.460
> 
> 标签：f#, functional-programming, function, methods

在尝试以无点函数样式进行编程时，“点表示法”与对象和记录一起工作的方式让我感到困扰（我认为这是使用默认情况下使用 curries 的函数语言的一种很好、简洁的方式）。

是否有我缺少的运算符或函数可以让我执行以下操作： `(.) object method`而不是`object.method`?

（从我读到的关于 new`?`运算符的内容来看，我认为它是这样工作的。除了它需要定义并进入整个动态绑定的东西，我认为我不需要。）

换句话说，我可以将方法作为参数应用到它的对象上，就像我将普通函数应用到它的参数上一样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T07:37:59.627

简短的回答：没有。

更长的答案：您当然可以在模块中创建 let-bound 函数，调用给定类型的方法......例如在代码中

```
let l = [1;2;3]
let h1 = l.Head 
let h2 = List.hd l 
```

从某种意义上说，“List.hd”是您想要的“.Head on a list”的版本。或者在本地，你总是可以做例如

```
let AnotherWay = (fun (l:list<_>) -> l.Head)
let h3 = AnotherWay l 
```

但是没有什么通用的，因为没有很好的方法来“命名”给定类型上的任意实例方法；'AnotherWay' 展示了一种“从 'list<_>' 对象的 'Head' 属性中创建函数”的方法，但是对于要视为一流函数值的每个实例方法，您都需要这样的样板文件。

我建议创建一个语言结构来概括这一点：

> 关于语言设计建议，如果
> 
> ```
>  SomeType..Foo optArgs   // note *two* dots 
> ```
> 
> 意思是
> 
> ```
>  fun (x : SomeType) -> x.Foo optArgs 
> ```
> 
> ?

在这种情况下你可以写

```
list<_>..Head 
```

作为“功能化”此实例属性的一种方式，但如果我们曾经在 F# 的那个领域做任何事情，那将是 VS2010 之后的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T07:32:30.433

如果我正确理解你的问题，答案是：不，你不能。点 (.) 不是 F# 中的运算符，它是语言内置的，因此不能用作函数。

# java - 我可以让一个 Maven 配置文件激活另一个吗？

> ID：943411
> 
> 赞同：75
> 
> 时间：2009-06-03T06:51:02.980
> 
> 标签：java, maven-2

我有 2 个 maven2 配置文件，selenium 和 jspc。现在对于“selenium”，我希望隐式激活“jspc”，这样我就不必从命令行编写 mvn -Pselenium,jspc。这可能吗 ？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-06-03T07:17:50.120

您不能“链接”配置文件激活（[maven reference](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)），但您可以通过相同的属性激活它们：

```
<activation>
  <property>
    <name>profile.selenium</name>
  </property>
</activation> 
```

和运行`mvn -Dprofile.selenium`

# java - 当它们被截断时，如何将两个 java.sql.Date 存储到数据库表中？

> ID：943413
> 
> 赞同：1
> 
> 时间：2009-06-03T06:51:34.913
> 
> 标签：java, database, datetime

我想将不同列中的 2 个`java.sql.Date`对象存储到同一个表中，以对应它们的 SQL 日期时间。它工作正常，但小时、分钟和秒被截断。这记录在 javadoc 中。

例如具有日期：**5/30/2009 14:33:21 AM**当插入表时，它被截断为 **5/30/2009 12:00:00 AM**。

我也尝试将其存储为时间戳，但我不能将时间戳格式的 2 行存储到同一个表中。

有解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T06:56:43.517

为什么不能有超过一行的时间戳格式？我认为你必须在那里详细说明（如果有的话，你的 ORM 是什么，你的数据库服务器是什么）。

无论如何，您可以将日期时间拆分为 java.sql.Date 和 java.sql.Time 并分别拥有两个或多个，或者使用 java.sql.Timestamp，这样设计不会丢失时间信息。所以你真的应该研究为什么你不能有多个时间戳。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T07:02:48.073

对于 SQL DATETIME 列，您仍应使用 java.sql.Timestamp 和 statement.setTimestamp(int, java.sql.Timestamp) 方法。

JDBC 驱动程序 Timestamp 类应该映射到 SQL DATETIME 和 SQL TIMESTAMP 列。

# windows - 如何更改 Excel 中的图例类型？

> ID：943419
> 
> 赞同：0
> 
> 时间：2009-06-03T06:52:26.457
> 
> 标签：windows, excel, charts, legend

我有一个折线图，其中图表图例也是折线形式。有没有办法可以将图例类型从彩色更改`line`为彩色`circle`或`square`？

如图这样[。http://www.nevron.com/gallery/FullGalleries/chartActiveX/stackline/images/StackLine1.png](http://www.nevron.com/gallery/FullGalleries/chartActiveX/stackline/images/StackLine1.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-27T21:41:59.657

我不认为你可以用这个方法得到圆，但是如果你想得到正方形，你可以将图表改为3-D折线图，然后右键单击图表区域并选择'3-D Rotation' . 将菜单“旋转”部分中的所有内容更改为尽可能接近 0。这将使您的图表显示为常规折线图，而图例显示小立方体。但是，完成此操作后，您可能必须更改轴设置。根据我的经验，3D 图表往往会显示太多的网格线。

# sql - MySQL：“SELECT 将检查超过 MAX_JOIN_SIZE 行”

> ID：943423
> 
> 赞同：14
> 
> 时间：2009-06-03T06:56:10.617
> 
> 标签：sql, mysql, join

我正在使用 PHP 和 MySQL。在我的程序中有一个涉及连接的选择查询。当我在本地主机上运行它时它工作正常，但是当我将它上传到我的服务器上并尝试执行它时，它会生成以下错误：

`The SELECT would examine more than MAX_JOIN_SIZE rows; check your WHERE and use SET SQL_BIG_SELECTS=1 or SET SQL_MAX_JOIN_SIZE=# if the SELECT is okay`

我该如何纠正？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-17T06:01:09.070

使用 PHP 时，应在主查询之前的单独查询中设置[SQL_BIG_SELECTS =1。](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_sql_big_selects)例如：

```
$mysqli = new mysqli("localhost", "root", "password", "db"); 

$mysqli->query("SET SQL_BIG_SELECTS=1");  //Set it before your main query

$results = $mysqli->query("SELECT a, b, c FROM test");
while($row = $results->fetch_assoc()){
    echo '<pre>';
    print_r ($row);
    echo '</pre>';
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-03T07:03:33.423

尝试在执行您的选择之前作为查询运行：

```
SET SQL_BIG_SELECTS=1 
```

这真的是在一个巨大的数据集上执行吗？如果不是，这应该以不同的方式解决。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T07:05:36.290

该参数的效果记录在[http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_max_join_size](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html#sysvar_max_join_size)。

您应该更严格地过滤涉及的记录（因此查询的每个部分涉及的记录较少）。如果可能，从可以使用简单 WHERE 子句过滤掉最多记录的表开始。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-01-13T17:05:08.487

我遇到了同样的问题。它是一个 drupal 站点，因此它倒下也就不足为奇了。

这是一个旧式查询，即`Select blah From table1, table2, table3 Where table1.id=table2.id And table2.some = 'thing'`

就像@VolkerK 说的那样，解决方案是将过滤 table2 结果的 where 子句移到将 table1 匹配到 table2 的 where 子句（实际上是连接子句），从而减少需要在 table2 中匹配到 table1 的记录数量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-22T02:13:57.403

如果您使用的是 PDO 驱动程序，请在构建新数据库句柄时`PDO::MYSQL_ATTR_INIT_COMMAND`在您的*driver_options数组中设置*

像这样：

```
$dbh = new PDO('mysql:host=xxx;port=xxx;dbname=xxx', 'xxx', 'xxx', array(PDO::MYSQL_ATTR_INIT_COMMAND => 'SET SESSION SQL_BIG_SELECTS=1')); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-13T13:46:18.713

对我来说，解决方案是为所有用于匹配连接的列添加索引键。

# groovy - 如何在 Groovy 的 SimpleTemplateEngine 中转义特殊字符？

> ID：943424
> 
> 赞同：1
> 
> 时间：2009-06-03T06:56:11.410
> 
> 标签：groovy, templates, escaping

默认情况下，groovy 的 SimpleTemplateEngine`<% %>`用作 scriptlet 容器。如果我想打印出来，如何转义这些字符`<% %>`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T04:25:27.617

看起来这可能是一个错误

[http://jira.codehaus.org/browse/GROOVY-399](http://jira.codehaus.org/browse/GROOVY-399)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-09T09:49:45.420

我红色的书（可能已经过时）说你需要有包含 <% 和 %> 的变量，然后你需要输出这些变量。

# c# - COM ApplicationClass.Documents.Open 线程

> ID：943438
> 
> 赞同：2
> 
> 时间：2009-06-03T07:04:05.123
> 
> 标签：c#, com, ms-word, document

我正在使用 Interop word ApplicationClass.Documents.Open 方法打开一个 word 文档。在我的应用程序中，当我使用以下语句时，它会挂起： IE 显示它仍在加载，但它从不做任何事情。

```
_Document aDoc = WordApp.Documents.Open(
    ref fileName, ref oMissing, ref readOnly, ref oMissing, ref oMissing,
    ref oMissing, ref oMissing, ref oMissing, ref oMissing, ref oMissing,
    ref oMissing, ref isVisible, ref oMissing, ref oMissing, ref oMissing,
    ref oMissing); 
```

我通过创建一个虚拟网站尝试了同样的事情，并且成功了。问题是它只是没有在我的应用程序中打开 word 文档。这段代码有什么问题，还是我需要添加更多内容？

我还看到了一个创建和执行的线程，但不知道它的起源。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-11-03T16:12:37.663

我可以从您的问题中了解到，您正在尝试使用 Web 服务器上的 Word 应用程序本身（通过 COM 互操作）打开一个 Word 文档。

你不应该这样做。Word 不是为了在 Windows 服务的上下文中运行而创建的。也就是说，没有用户界面。

可能 Word 正在对话框中等待用户的某些响应。但由于您没有 UI，因此不会显示。

# java - 如何使用 Spring XML 配置来设置包含特定类型所有 bean 列表的 bean 属性？

> ID：943439
> 
> 赞同：11
> 
> 时间：2009-06-03T07:04:17.057
> 
> 标签：java, spring

我有以下 XML 配置：

```
<bean id="bean1" class="Simple"/>
<bean id="bean2" class="Simple"/>

<bean id="tasks" class="java.util.ArrayList">
    <constructor-arg>
        <list>
            <ref bean="bean1" />
            <ref bean="bean2" />                
        </list>
    </constructor-arg>
</bean>

<bean id="list" class="Comp">
    <property name="tasks" ref="tasks"/>
</bean> 
```

“任务”包含所有 Simple 类型的 bean。这样做的问题是我可能会忘记将我配置的简单 bean 添加到列表中。

我可以使用编程方式执行此操作

```
Map map = context.getBeansOfType(Simple.class); 
```

并使用检索到的 bean 设置列表 bean。

有没有办法只使用 XML 配置来做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T07:13:52.263

你的上下文文件应该是这样的：

```
<bean id="bean1" class="Simple"/>
<bean id="bean2" class="Simple"/>

<bean id="list" class="Comp" autowire="byType"/> 
```

注意`autowire="byType"`添加和[自动装配文档](http://static.springframework.org/spring/docs/2.5.x/reference/beans.html#beans-factory-autowire)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T07:35:45.077

我建议自己编写`FactoryBean`一个这样的列表。这将是可重用的，然后只能使用 XML 进行配置。看起来`FactoryBean`像

```
import java.util.ArrayList;
import java.util.List;

import org.springframework.beans.factory.FactoryBean;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;
import org.springframework.util.Assert;

public class CollectingListFactoryBean implements FactoryBean, ApplicationContextAware {
    private ApplicationContext appCtx;
    private Class type;

    public Object getObject() {
        Assert.notNull(type, "type must be initialized");
        List result = new ArrayList();
        result.addAll(appCtx.getBeansOfType(type).values());
        return result;
    }

    public Class getObjectType() {
        return List.class;
    }

    public boolean isSingleton() {
        return false;
    }

    public void setApplicationContext(ApplicationContext applicationContext) {
        this.appCtx = applicationContext;
    }

    public void setType(Class type) {
        this.type = type;
    }
} 
```

那么您的 XML 配置将是

```
<bean id="bean1" class="Simple"/>
<bean id="bean2" class="Simple"/>

<bean id="tasks" class="CollectingListFactoryBean">
    <property name="type" value="Simple" />
</bean>

<bean id="list" class="Comp">
    <property name="tasks" ref="tasks"/>
</bean> 
```

注意：我没有时间测试上面的示例。我只是使用我已经拥有的代码作为模板。;) 特别是我不确定`Simple`作为属性的`Class`参数传递是否以`type`这种方式工作。试一试。在最坏的情况下，您将不得不使用`String`作为属性类型并使用`Class.forName(type)`来获取您的课程。但我的猜测是 Spring 为你做了这个转换。

**编辑**即使这个解决方案应该有效，我还是推荐 Robert Munteanu 的回答。

# iphone - 从起始角度旋转 CALayer

> ID：943449
> 
> 赞同：3
> 
> 时间：2009-06-03T07:07:14.727
> 
> 标签：iphone, cocoa-touch, core-animation

我想使用 连续旋转图层`byValue`，但无法使其正常工作。我想每秒旋转 6 度，在 60 秒内完成一次旋转。

如果图层的初始旋转为 0，则一切正常。

问题是当我尝试设置初始`fromValue`. 如果我将 设置`fromValue`为 90 度，动画将从 90 旋转到 90+6，然后跳转到 90+(90+6)，动画，然后再次跳转。

任何想法？

```
CABasicAnimation* animation = [CABasicAnimation animationWithKeyPath:@"transform.rotation.z"];

animation.fromValue = [NSNumber numberWithDouble:M_PI_2];
animation.byValue = [NSNumber numberWithDouble:6.0f*M_PI/180.0f];
animation.toValue = nil;

animation.fillMode = kCAFillModeForwards;
animation.cumulative = YES;
animation.additive = NO;
animation.repeatCount = 10000;
animation.removedOnCompletion = YES;
animation.duration = 1.0;
[myLayer addAnimation:animation forKey:@"transform"]; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-03T07:58:37.370

这对我有用：

```
CABasicAnimation* animation = [CABasicAnimation animationWithKeyPath: @"transform"];
CATransform3D transform = CATransform3DMakeRotation (DegreesToRadians (90), 0, 0, 1);
animation.toValue = [NSValue valueWithCATransform3D: transform];
animation.duration = 60;
animation.cumulative = NO;
animation.repeatCount = 10000;
animation.removedOnCompletion = YES; 
```

# c# - 在 WPF 中绘制正弦波

> ID：943452
> 
> 赞同：4
> 
> 时间：2009-06-03T07:08:07.423
> 
> 标签：c#, wpf, math, drawing

这个看起来很愚蠢，但我从一个小时开始努力做到这一点，

**如何在 WPF 中绘制正弦波？**

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T07:32:06.767

在您使用 Math.Sin 函数计算的点之间画线。您必须决定每个循环使用多少点，这是绘图速度和准确性之间的折衷方案。据推测，您还需要缩放幅度以适应屏幕上的区域，因为 Sin 函数将返回 +1 和 -1 之间的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T08:00:47.473

你的“绘图”怎么样。WPF 没有像 Winforms 这样的 OnPaint 事件，因此这可能有点棘手。在 WinForms 中执行此操作的方法是使用该`Graphics.DrawBezier`方法

```
e.Graphics.DrawBezier(new Pen(new SolidBrush(Color.Red)), 
                          new Point(0, 100), 
                          new Point(50, 0), 
                          new Point(50, 200), 
                          new Point(100, 100)); 
```

也许这很有帮助，但我什至不确定如何直接绘制到 WPF 画布上。

快速浏览 MSDN 表明它有一个 BezierSegment 控件，可能对您有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T10:05:55.630

如果想要点之间的曲线，您可以使用 PolyBezier 使用从 Math.Sin 方法计算的 PointCollection 绘制正弦波。或者，您可以创建许多相互流动的 BezierSegments。最后，只需使用 drawingarea.Children.Add(curve) 将您的 PolyBezier 或 BezierSegments 添加到您的表单中，其中绘图区域是您正在绘制的网格或画布。

# .net - 一台机器上运行的 CLR 和 GC 实例的数量？

> ID：943453
> 
> 赞同：13
> 
> 时间：2009-06-03T07:08:44.427
> 
> 标签：.net, clr

我创建了 2 个 .NET 应用程序并在一台机器上运行它们 - 会有多少 CLR 和 gc？

另外：我想了解一些有关 Windows 如何处理 COM 组件，尤其是 CLR 的背景信息。希望有人可以详细说明 CLR 如何在内存中加载以及如果我在运行此命令时列出多个 CLR 实例意味着什么：

```
tasklist /m mscor* 
```

它实际上是多个 CLR 还是单个 CLR 作为所有 .NET 进程的 COM 服务器？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T07:20:25.853

每个进程都有自己的 CLR 副本作为宿主进程。但是，由于 CLR 实际上只是几个 DLL，Windows 将能够在进程之间共享 DLL。有关详细信息，请参阅：http: [//msdn.microsoft.com/en-us/magazine/cc301727.aspx](http://msdn.microsoft.com/en-us/magazine/cc301727.aspx)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-03T08:13:30.677

除了可[移植可执行文件（PE 格式）](http://en.wikipedia.org/wiki/Portable_Executable)之外，托管 exe 还具有附加的**CLR 标头**。操作系统现在能够确定启动的 exe 是否是“托管”exe，因此可以在后台加载 CLR 并对其进行控制。

*   mscoree.dll 是一个 shim DLL（该文件的最新版本始终存在于 Windows/System32 文件夹中，因此知道如何加载当前和旧版本的 CLR。​​）
*   mscorwks.dll 是 CLR 的实际实现。如果你安装了多个版本的框架，你会发现这个 dll 的多个版本。此 dll 的正确版本由 shim dll 加载。

从上面可以看出，每个托管可执行文件的进程都有自己的 CLR 副本（2 个 Dll）。ManagedExecutable1 可能正在使用 CLR v1，而 ManagedExecutable2 可能正在使用 CLR v2。到目前为止，它们尚未共享。
垃圾收集器是 CLR 的一部分，因此在托管可执行文件的进程中也是不同的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T07:33:44.940

我想说，您可以通过检查加载的 dll 轻松计算运行或加载 CLR 的进程。但我不确定您是否能够计算正在运行的应用程序域的数量。但我不认为这是你的目标。

每个进程只有一个堆，还有一个 GC，它在收集期间挂起所有托管线程。因此，您可以遍历进程并检查是否加载了 mscorlib，如果是，您可以假设它正在运行 .NET CLR 和 GC。我确信应该有更好的方法来确定进程是否托管了 CLR，请同时检查 CLR API。

请尝试 Jeffrey Richter 的《CLR via C#》一书以更深入地了解。

下面的代码迭代 .NET 进程

```
// Import these namespaces
using System.Diagnostics;
using System.ComponentModel;

// Here is the code
Process[] prcs = Process.GetProcesses();
foreach (Process prc in prcs)
{
    try
    {
        foreach (ProcessModule pm in prc.Modules)
        {
            if (pm.ModuleName.Contains("mscorlib"))
            {
                Console.WriteLine(prc.ProcessName);
            }
        }
    }
    catch (Win32Exception exWin)
    {
        // Cannot detemine process modules ... some will deny access
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T07:13:21.267

CLR 实际上是将[MSIL](http://en.wikipedia.org/wiki/Common_Intermediate_Language)转换为本机机器代码的组件。然后，该本机机器代码在每个应用程序的自己的进程中运行。

在 .NET 世界中，进程与[appdomain](http://en.wikipedia.org/wiki/Application_Domain)密切相关。这就是为什么我认为[这](http://en.wikipedia.org/wiki/Application_Domain)是一个很好的起点。

# c# - 如何将 .net 集合类型转换为 VBA 集合？

> ID：943457
> 
> 赞同：1
> 
> 时间：2009-06-03T07:11:32.330
> 
> 标签：c#, .net, vba, collections

我正在编写一个 VBA 应用程序，它调用返回集合对象的 C#.net 方法。

当我将输出分配给 VBA.Collection 时，我得到一个编译时错误 - 参数不是可选的。

如果我将输出分配给对象，则会出现运行时错误 - 对象变量或未设置块变量

我认为这是因为 Collection 类型不兼容。

谁能帮我将 .net 集合类型转换为 vba。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T07:27:00.037

我认为您需要使用 SET 命令？

# c# - ASP.NET MVC：如何处理交叉操作 TempData 和 ViewData

> ID：943467
> 
> 赞同：4
> 
> 时间：2009-06-03T07:15:17.113
> 
> 标签：c#, asp.net-mvc, viewdata, tempdata

我正在尝试找到一种处理以下情况的好方法（我对此还是有点陌生​​）：

用户可以使用 RPX/OpenId 提供程序通过我的站点进行注册。

第 1 步：用户通过提供者进行身份验证。提供者将一个临时令牌返回给我的一种操作方法。

第 2 步：我使用令牌获取用户的个人资料信息并加载允许他们输入任何缺少的必填字段和可选字段的视图。

我在第 2 步中使用了 2 种操作方法：一种使用令牌来处理信息的获取。获取授权信息并加载缺失/可选字段视图的第二个操作。

我通过 TempData 将授权信息传递给第二个操作。第二个操作可以处理验证，因此我有可能需要保留授权对象来处理超过 1 个请求。我不能使用令牌来重新生成授权信息，因为它在技术上是一次性令牌，并且重新生成请求会很愚蠢，因为它正在使用网络资源。

对于同一操作的任何后续请求，我如何将对象保留在我的 TempData 中，但删除任何重定向的对象？由于这在我的应用程序中可能是可重复的模式，我应该创建一个过滤器来自动处理这种情况吗？

例如，我想象一个过滤器属性，它将 TempData（如果有的话）合并到 ViewData - 但是我如何将我的数据保存到未来对同一操作的调用中？再次将其放入 TempData 中？如果我检测到重定向清空 TempData？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-29T18:50:09.027

如有必要，我最终将数据重新添加到 TempData。由于 TempData 不允许您添加重复的密钥，因此我创建了自己的辅助方法来删除然后重新添加密钥：

```
public static void AddNew(this TempDataDictionary tempData, string key, object obj)
{
    if ( tempData.ContainsKey( key ) ) tempData.Remove( key );

    tempData.Add( key, obj );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-25T13:32:10.517

我遇到了同样的问题，但处理方式略有不同 - 我使用了仅适用于 OpenID 的表单身份验证方法......如果我的提供者返回 Authenticated，我将执行以下操作

```
 var fields = openid.Response.GetExtension(typeof(ClaimsResponse)) as ClaimsResponse;

                if (fields != null)
                {
                    TempData["Email"] = fields.Email;
                    TempData["Nickname"] = fields.Nickname;
                }

                FormsAuthentication.RedirectFromLoginPage(openid.Response.ClaimedIdentifier, false);

                break; 
```

这意味着我不需要传递任何类型的身份验证令牌 - 执行此代码后，我知道我的用户已通过身份验证。

因此，将控制权传递给的操作将简单地将 TempData 字段（如果已填充）复制到 ViewData 中并将它们传递到视图中。

验证在此之后处理 - 我不在乎 OpenID 返回什么（即它是否有效），我让用户编辑它然后保存，然后执行我的验证。

# c# - 数据绑定是否适用于隐形控件？

> ID：943473
> 
> 赞同：9
> 
> 时间：2009-06-03T07:17:48.620
> 
> 标签：c#, .net, winforms

这是 winforms 的 .net 问题，而不是 asp.net。

我有一个带有多个选项卡的 Windows 窗体。我在加载表单时设置了所有控件的数据绑定。但我注意到第二个选项卡上控件的数据绑定不起作用。这些绑定仅在加载表单并选择第二个选项卡时才起作用。这给我带来了怀疑：数据绑定仅在绑定控件变得可见时才起作用。

谁能告诉我这是真的还是假的？测试这一点并不难，但我想知道一些确认。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T07:23:23.947

你是对的。在控件可见之前，不会更新数据绑定控件。

目前我能找到的唯一参考是[这个 MSDN 线程](http://social.msdn.microsoft.com/Forums/en-US/winformsdatacontrols/thread/70f0bbbb-07d5-4253-9a79-789700a8450a)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-06-01T15:22:28.613

您的问题与 TabControl 的行为有关。请参阅[Microsoft 错误报告](https://connect.microsoft.com/VisualStudio/feedback/details/351177)。我针对该问题发布了一个解决方法，该问题将 TabControl 子类化并在创建控件或创建句柄时“初始化”所有选项卡页。下面是解决方法的代码。

```
public partial class TabControl : System.Windows.Forms.TabControl
{
    protected override void OnHandleCreated(EventArgs e_)
    {
        base.OnHandleCreated(e_);
        foreach (System.Windows.Forms.TabPage tabPage in TabPages)
        {
            InitializeTabPage(tabPage, true, Created);
        }
    }

    protected override void OnControlAdded(ControlEventArgs e_)
    {
        base.OnControlAdded(e_);
        System.Windows.Forms.TabPage page = e_.Control as System.Windows.Forms.TabPage;
        if ((page != null) && (page.Parent == this) && (IsHandleCreated || Created))
        {
            InitializeTabPage(page, IsHandleCreated, Created);
        }
    }

    protected override void OnCreateControl()
    {
        base.OnCreateControl();
        foreach (System.Windows.Forms.TabPage tabPage in TabPages)
        {
            InitializeTabPage(tabPage, IsHandleCreated, true);
        }
    }

    //PRB: Exception thrown during Windows Forms data binding if bound control is on a tab page with uncreated handle
    //FIX: Make sure all tab pages are created when the tabcontrol is created.
    //https://connect.microsoft.com/VisualStudio/feedback/details/351177
    private void InitializeTabPage(System.Windows.Forms.TabPage page_, bool createHandle_, bool createControl_)
    {
        if (!createControl_ && !createHandle_)
        {
            return;
        }
        if (createHandle_ && !page_.IsHandleCreated)
        {
            IntPtr handle = page_.Handle;
        }
        if (!page_.Created && createControl_)
        {
            return;
        }
        bool visible = page_.Visible;
        if (!visible)
        {
            page_.Visible = true;
        }
        page_.CreateControl();
        if (!visible)
        {
            page_.Visible = false;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-09-13T14:03:28.503

我们遇到了类似的问题。我们正在尝试写入 2 个绑定的不可见字段，以便我们可以更改写入数据集的格式。这在对象可见时工作正常，但在可见属性更改为 false 时停止工作。

为了解决这个问题，我添加了以下代码：

```
 // Stop our screen flickering.
        chSplitContainer.Panel2.SuspendLayout();
        // Make the bound fields visible or the binding doesn't work.
        tbxValueCr.Visible = true;
        tbxValueDb.Visible = true;

        // Update the fields here.
        <DO STUFF>

        // Restore settings to how they were, so you don't know we're here.
        tbxValueCr.Visible = false;
        tbxValueDb.Visible = false;
        chSplitContainer.Panel2.ResumeLayout(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-04-11T15:35:53.450

我自己一直在努力解决这个问题，并得出结论，除了显然进行子类化（参见 hjb417 的答案）之外，唯一的解决方法是让另一个选项卡可见。在表单可见之前切换到另一个选项卡并返回到上一个选项卡不起作用。如果您不想让第二个选项卡可见，我使用以下代码作为解决方法：

```
this.tabControl.SelectedTab = this.tabPageB; 
this.tabPageB.BindingContextChanged += (object sender, EventArgs e) => {
    this.tabContainerMain.SelectedTab = this.tabPageA; 
}; 
```

假设*tabPageA*是可见选项卡，而*tabPageB*是您要初始化的不可见选项卡。这将切换到 pageB，并在数据绑定完成后切换回来。这对表单中的用户是不可见的。

仍然是一个丑陋的黑客，但至少这是有效的。当然，当你有多个标签时，他的代码会变得更加丑陋。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T07:23:44.383

这不是我直接遇到的。但是，您可能会遇到[BindingContext](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingcontext.aspx)的问题。没有更多细节很难说，但如果我是你，我会设置一个断点并确保所有控件都绑定在同一个上下文中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-30T22:18:46.950

根据答案，我制作了适合我的方法：

```
 public partial class Form1: Form
 {
    private void Form1_Load(object sender, EventArgs e)
    {
        ...
        forceBindTabs(tabControl1);
    }

    private void forceBindTabs(TabControl ctl)
    {
        ctl.SuspendLayout();

        foreach (TabPage tab in ctl.TabPages)
            tab.Visible = true;

        ctl.ResumeLayout();
    }
 } 
```

除了解决问题之外，选项卡在开始时被加载，并且在用户单击它们时显示得更快。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-05T09:49:02.920

很抱歉对这个线程进行了死灵处理，但是使用这种方法很容易强制不可见控件的数据绑定/句柄准备好：

[https://social.msdn.microsoft.com/Forums/vstudio/en-US/190296c5-c3b1-4d67-a4a7-ad3cdc55da06/problem-with-binding-and-tabcontrol?forum=winforms](https://social.msdn.microsoft.com/Forums/vstudio/en-US/190296c5-c3b1-4d67-a4a7-ad3cdc55da06/problem-with-binding-and-tabcontrol?forum=winforms)

简单地说，假设您的控件位于标签页`tpg_Second`（或`tabCtl.TabPages[1]`）中，在您对其数据执行任何操作之前，请先调用它：

```
tpg_Second.Show() 
```

这不会激活任何标签页，但是 viola，控件的数据绑定现在应该可以工作了。

# tfs - 与 TFS workItem.Fields 相关的问题

> ID：943479
> 
> 赞同：0
> 
> 时间：2009-06-03T07:20:26.650
> 
> 标签：tfs

我在访问 teamfoundation 缺陷跟踪应用程序时出现以下错误

“工作项类型定义文件中的字段定义症状不存在。为此字段添加定义或删除对该字段的引用，然后重试。”

任何身体都可以帮忙吗？

谢谢苏妮莎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T07:32:11.120

工作项类型定义必须已修改：“症状”类型可能已被重命名或删除。

如果您是 TFS 服务器上的管理员，可以使用[TFS Power Tools完成此操作。](http://msdn.microsoft.com/en-us/teamsystem/bb980963.aspx#wit)

# html - 如何使用流动表格行制作 XHTML“表格”

> ID：943480
> 
> 赞同：2
> 
> 时间：2009-06-03T07:20:44.543
> 
> 标签：html, css, layout, quirks-mode

基本上，我希望能够制作一个框格，我可以在其中对齐每个框的顶部中间和底部的文本，并且当同一行中的另一个框中的文本将其向下推时，使同一行上的框调整大小。

如果您查看此 HTML 4 代码，它实现了我想要能够做的事情，但我希望能够使用 XHTML 1.0 doctype 来实现这一点。

```
<style type="text/css">
<!--
#apDiv1 {
        width:200px;
        height:100%;
            border:1px solid #000;
}

#apDiv1 table{
        width:200px;
        height:100%;
            border:1px solid #000;
}
-->
</style>
<div id="apDiv1"><table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td>
    <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
      <tr><td>blah</td></tr>
      <tr><td height="100%">blah</td></tr>
      <tr><td>blah</td></tr>
    </table>
    </td>
    <td>
    <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
      <tr><td>blah</td></tr>
      <tr>
        <td height="100%"><p>blahfhfh</p>
          <p>dfhdf</p>
          <p>h</p>
          <p>dfh</p>
          <p>df</p>
          <p>h</p>
<p>&nbsp;</p></td></tr>
      <tr><td>blah</td></tr>
    </table>
    </td>
    <td>
        <table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
      <tr><td>blah</td></tr>
      <tr><td height="100%">blah</td></tr>
      <tr><td>blah</td></tr>
    </table>
    </td>
  </tr>
  <tr>
    <td><table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td>blah</td>
      </tr>
      <tr>
        <td height="100%"><p>blahfhfh</p>
          <p>dfhdf          </p>
          <p>&nbsp;</p></td>
      </tr>
      <tr>
        <td>blah</td>
      </tr>
    </table></td>
    <td><table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td>blah</td>
      </tr>
      <tr>
        <td height="100%">blah</td>
      </tr>
      <tr>
        <td>blah</td>
      </tr>
    </table></td>
    <td><table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td>blah</td>
      </tr>
      <tr>
        <td height="100%">blah</td>
      </tr>
      <tr>
        <td>blah</td>
      </tr>
    </table></td>
  </tr>
  <tr>
    <td><table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td>blah</td>
      </tr>
      <tr>
        <td height="100%">blah</td>
      </tr>
      <tr>
        <td>blah</td>
      </tr>
    </table></td>
    <td><table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td>blah</td>
      </tr>
      <tr>
        <td height="100%">blah</td>
      </tr>
      <tr>
        <td>blah</td>
      </tr>
    </table></td>
    <td><table width="100%" height="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td>blah</td>
      </tr>
      <tr>
        <td height="100%">blah</td>
      </tr>
      <tr>
        <td>blah</td>
      </tr>
    </table></td>
  </tr>
</table>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-07T18:34:01.850

有[一种跨浏览器的方法可以使用 CSS](http://blog.mozilla.com/webdev/2009/02/20/cross-browser-inline-block/) with来实现网格`display:inline-block`，但是它可能不像你想要的那样灵活（如果你想支持 Firefox 2，代码会非常难看）。

“XHTML”可能存在的问题是，没有模拟 IE5 错误的 CSS（当您不使用 DOCTYPE 或使用旧的/不完整的错误之一时会得到）限制了您何时可以使用`height:100%`.

如果父元素具有高度，则百分比高度不起作用`auto`，并且默认情况下，几乎每个 HTML 元素都有自动高度。您必须在表格的所有父元素上设置显式高度：

```
html,body,#apDiv1 {
  height:100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T07:42:52.033

首先，使用[http://validator.w3.org使您的文档具有 HTML 4.01 严格的 DOCTYPE 并首先对其进行验证](http://validator.w3.org)

然后，您可以将 DOCTYPE 更改为

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

然后重新验证它。如果有任何问题或行为不同的事情，您可以在此处询问具体问题。

# cryptography - 这个错误在 Botan 加密库中意味着什么？

> ID：943488
> 
> 赞同：3
> 
> 时间：2009-06-03T07:25:03.863
> 
> 标签：cryptography

我正在使用名为 Botan 的 c++ 加密库，并且在任意时间我在运行时收到以下错误。这是什么意思？

> 在抛出“Botan::PRNG_Unseed”的实例后调用终止 what(): Botan: PRNG not seeded: X9.31(AES-256)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-12T02:51:01.943

我遇到了同样的错误消息，这是由于缺少任何熵源引起的。您可以在构建 Botan 库或生成单个源文件时尝试启用熵源。对于 windows 平台，将 win32_stats 模块添加到选项 --enable-modules 中。对于 linux，使用 dev_random。

例如 configure.py --enable-modules=win32_stats,...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-06T23:22:59.080

The most likely answer is that you are using v 1.8.2 which had problems with its autoseeding routines. Upgrading to 1.8.4 or 1.8.5 has fixed this for everyone who had reported this problem up to now.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T07:31:37.113

好吧，在我看来，您好像忘记播种 PRNG（伪随机数生成器）。由于未能这样做，Botan 库抛出了上述异常，这似乎导致`terminate`函数被调用。

# sharepoint - 使用共享点对象模型 VS 2008 的自定义列表表单

> ID：943489
> 
> 赞同：0
> 
> 时间：2009-06-03T07:25:06.923
> 
> 标签：sharepoint, forms, list

有没有办法为列表项新表单处理 DropDownSelectedIndexChanged。

假设我有一个名为 Temp 的自定义列表，其中包含 Title、Products（这是一个 DropDownList）和 Color Shade（这是一个 TextBox）。当我创建一个列表项时，我想从 DropDownList 中选择一个产品，并且在所选索引发生更改时，我想编写业务逻辑，例如从 Color Shade 列表中获取行并将数据绑定到 Color Shade 的 TextBox。现在我可以说好的，以便创建一个列表项。是否可以使用 VS 2008 共享点对象模型。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T03:51:33.300

有一些第三方组件可以作为自定义列类型执行此类操作，但如果您是从头开始开发，您可能会发现自定义表单要容易得多。如果您执行 newform.aspx 的完全自定义版本，您仍将使用标准的新项目菜单。

如果您尝试修改标准控件，如果提交的值不在原始列表中，您将遇到安全错误等问题。

如果您不想编写自己的保存代码，则使用 css 隐藏标准新表单并使用自定义控件中的 javascript 修改值可以很好地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T10:45:22.867

您可以将自定义控件添加到您的母版页，它会递归地遍历您的控件树（从 this.Page 开始）以找到您的下拉列表并附加事件处理程序（其本身在您的自定义控件中定义）。找到它后，还要在下拉列表中将 AutoPostBack 属性设置为 true。

在获取事件处理程序中的文本框的引用方面，您还可以应用遍历控制树的相同方法。

请注意，您需要确保在事件处理程序运行之前附加事件处理程序。

雅普

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T12:38:47.180

我不确定我是否明白你的意思。

另一种方法（可能工作量更少）是使用 javascript（我建议使用 jQuery 库）在下拉列表的选择发生变化时自动填充您的文本框。一切都将在客户端完成。

雅普

# asp.net - ASP.NET RegisterStartupScript() 方法...与 Response.Write()

> ID：943495
> 
> 赞同：0
> 
> 时间：2009-06-03T07:27:31.817
> 
> 标签：asp.net, callback

为什么我们不能使用 Response.Write(".....") 编写 JavaScript 代码来实现与 RegisterStartupScript() 相同的目的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T07:34:26.153

RegisterStartupScript() 会将 HTML 放置在 HTML 中的正确位置（通常在末尾，在`</body>`标记之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T10:37:42.523

RegisterStartupScript() 将在从 UpdatePanel 加载脚本时正确连接您的脚本。默认情况下，UpdatePanel 更新中的代码不被视为脚本 - 这应该手动完成或使用 RegisterStartupScript() 完成。

# file - 加载依赖于另一个 jar 文件的 jar 文件时出现问题

> ID：943498
> 
> 赞同：1
> 
> 时间：2009-06-03T07:29:46.180
> 
> 标签：file, jar, load, runtime, dependencies

在运行时加载我的 jar 文件时遇到问题。我的hotel.jar 已加载，并使用以下代码调用它的方法（makeReservation）：

```
File file = new File("c:/ComponentFiles/hotel.jar");
URL jarfile = new URL("jar", "", "file:" + file.getAbsolutePath() + "!/");
URLClassLoader cl = URLClassLoader.newInstance(new URL[]{jarfile});
Class  componentClass = cl.loadClass("HotelPackage.HotelMgt");
Object componentObject = componentClass.newInstance();
Method setMethod = componentClass.getDeclaredMethod("makeReservation", null);
setMethod.invoke(componentObject, null); 
```

问题出在我的 jar 文件的类 HotelPackage.HotelMgt 中，我有另一个类（HotelPackage.Hotel）的类变量，它在另一个 jar 文件中。我尝试使用与上面相同的代码打开并加载另一个 jar 文件，但我收到找不到类 def 的 **异常。：线程“main”中的异常 java.lang.NoClassDefFoundError: BeanPackage/Hotel**

解决办法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T08:49:07.360

您可以通过在 JAR 的清单文件中定义 Class-Path 属性来指定 JAR 之间的依赖关系。然后 JVM 将根据需要自动加载依赖项 JAR。

更多信息在这里：http: [//java.sun.com/docs/books/tutorial/deployment/jar/downman.html](http://java.sun.com/docs/books/tutorial/deployment/jar/downman.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T02:56:27.303

谢谢，但我找到了另一个真正有效的解决方案。由于我知道将相互协作的整个组件系列，因此我使用一个类加载器实例（URL 数组）将它们全部加载。然后类加载器本身管理依赖项。

# python - Python：以超过一秒的分辨率获取文件修改时间

> ID：943503
> 
> 赞同：5
> 
> 时间：2009-06-03T07:32:36.487
> 
> 标签：python, windows, macos, filesystems, timestamp

`os.path.getmtime()`并且`os.stat()`似乎只在整秒内返回值。

这是 Windows 或 OSX 文件系统上可能的最大分辨率，还是有办法在文件时间上获得更大的分辨率？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T07:44:30.127

[os.stat() 的文档](http://docs.python.org/library/os.html#os.stat)有一条说明：

> st_atime、st_mtime 和 st_ctime 成员的确切含义和解析取决于操作系统和文件系统。例如，在使用 FAT 或 FAT32 文件系统的 Windows 系统上，st_mtime 的分辨率为 2 秒，而 st_atime 的分辨率仅为 1 天。有关详细信息，请参阅您的操作系统文档。

例如在[Windows](http://msdn.microsoft.com/en-us/library/ms724284(VS.85).aspx)上，用于表示文件时间的 FILETIME 结构使用 100 纳秒的分辨率。我希望 Python 能够“知道”这一点，并为您提供最佳解决方案。您是否有可能使用 FAT 文件系统上的文件？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T07:46:47.020

HFS+（由 OS X 使用）的日期分辨率为[一秒](http://en.wikipedia.org/wiki/HFS_Plus)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T07:55:03.337

如[Python`os`模块](http://docs.python.org/library/os)中所述，它是操作系统特定功能的可移植接口。根据您运行的平台，您将获得不同的行为。

具体来说，调用返回的修改时间`stat`取决于文件所在的文件系统。例如，对于 FAT 文件系统中的条目，修改时间的最佳分辨率是 2 秒。其他文件系统将具有不同的分辨率。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-07T12:07:25.630

Python 3 os.stat() 包含具有纳秒分辨率的 st_atime_ns、st_ctime_ns、st_mtime_ns 属性，取决于文件系统保存的时间结构。见：[https ://docs.python.org/3/library/os.html](https://docs.python.org/3/library/os.html)

# php - MySQL父->子查询

> ID：943507
> 
> 赞同：0
> 
> 时间：2009-06-03T07:34:30.163
> 
> 标签：php, mysql, hierarchical-data

我正在使用 mySQL，并且我需要从一个表中选择与另一个表中父-> 子数据层次结构中任何级别的 ID 匹配的数据。

此外，我想用一个写得很好的 SQL 查询来解决这个问题，而不是我的 PHP 代码中的递归函数，因为这个特性会被使用很多。

我确实尝试过搜索，并且偶然发现了许多类似的问题（大多数都已解决），但是没有一个对我有帮助。

为了帮助说明情况，这是我当前的设置

表“文章”：

*   article_id
*   类别ID
*   ...

表类别

*   类别ID
*   parent_id
*   ...

我需要从“articles.category_id”为10的“articles”中选择所有文章。但还要从“categories.category_id”10所属的树中接收所有类别的所有文章。

意思是，其中“10”是父母和所有的孩子，向上是10是孩子和所有的父母。

没有递归php函数可能吗？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T07:47:56.517

鉴于您使用的是 MySQL，不可能使用您正在使用的邻接列表设计在一个查询中获取整个树。

其他一些品牌的数据库支持 SQL 扩展来处理这种设计。Oracle、Microsoft SQL Server、IBM DB2 和 PostgreSQL 8.4（目前处于测试阶段）支持 SQL 扩展。

存在其他允许您更有效地查询树的数据库设计。这个问题已在 StackOverflow、博客和文章中多次解决。

您还可以阅读Joe Celko 的“ [Smarties in SQL 中的树和层次结构](https://rads.stackoverflow.com/amzn/click/com/1558609202)”，其中深入介绍了几种此类设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T15:41:22.363

这在 中是可能的`MySQL`，但需要一点努力。您必须编写这样的函数：

```
CREATE FUNCTION hierarchy_connect_by_parent_eq_prior_id(value INT) RETURNS INT
NOT DETERMINISTIC
READS SQL DATA
BEGIN
        DECLARE _id INT;
        DECLARE _parent INT;
        DECLARE _next INT;
        DECLARE CONTINUE HANDLER FOR NOT FOUND SET @id = NULL;

        SET _parent = @id;
        SET _id = -1;

        IF @id IS NULL THEN
                RETURN NULL;
        END IF;

        LOOP
                SELECT  MIN(id)
                INTO    @id
                FROM    categories
                WHERE   parent = _parent
                        AND id > _id;
                IF @id IS NOT NULL OR _parent = @start_with THEN
                        SET @level = @level + 1;
                        RETURN @id;
                END IF;
                SET @level := @level - 1;
                SELECT  id, parent
                INTO    _id, _parent
                FROM    categories
                WHERE   id = _parent;
        END LOOP;
END 
```

并在查询中使用它：

```
SELECT  id, parent, level
FROM    (
        SELECT  hierarchy_connect_by_parent_eq_prior_id(id) AS id, @level AS level
        FROM    (
                SELECT  @start_with := 0,
                        @id := @start_with,
                        @level := 0
                ) vars, categories 
        WHERE   @id IS NOT NULL
        ) ho
JOIN    categories hi
ON      hi.id = ho.id 
```

有关更多详细信息，请参阅我的博客中的此条目：

*   [**MySQL 中的分层查询**](http://explainextended.com/2009/03/17/hierarchical-queries-in-mysql/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T07:40:02.757

在关系数据库中存储分层数据的最常见模式是相邻列表或[修改的预排序（也称为嵌套集）](http://www.sitepoint.com/article/hierarchical-data-database/)。另一种方法是使用物化路径，它基本上是一种缓存机制，位于相邻列表的顶部。另请参阅[此表以比较优缺点](http://ezcomponents.org/docs/api/trunk/introduction_Tree.html#database-based-back-ends)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T09:07:47.200

我不知道这对你有多大帮助，但我写了一个小函数，它使用单个 MySQL 查询生成层次树。基本上，所有重要的逻辑都移到了 PHP 中。我的解决方案使用邻接列表模型，然后使用 PHP 引用，以便通过平面结构构建树形数据结构。看看下面的要点，看看你是否得到了一些灵​​感。我会为您提供更多帮助，但在我的工作中我必须处理一些问题。

[http://gist.github.com/104357](http://gist.github.com/104357)

# sql-server-2005 - SQL Server 2005：从 WHERE 子句调用存储过程

> ID：943516
> 
> 赞同：2
> 
> 时间：2009-06-03T07:38:51.870
> 
> 标签：sql-server-2005, stored-procedures, where-clause

我需要在 WHERE 子句中调用存储过程来进行 SELECT。应该是这样的......

SELECT distinct top 10 ix, d.droit FROM v_droit d, v_info i WHERE d.nomdroit='yy' AND i.id<>2 AND (select val from (exec up_droits(ix, d.droit)) <>3

但它不起作用......有什么想法吗？

不要说用函数替换存储过程，因为不可能在函数中使用现有代码。所以这个函数不是一个有效的选项。我真的需要能够使用存储过程

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T07:56:27.233

这是通过首先执行存储过程，将输出捕获到#temp 表或@tabel 变量中，然后对表运行查询来实现的。像这样的东西：

```
declare @droits_table (val ,... );
insert into @droits_table
exec up_droits(param, param);
SELECT distinct top 10 i.x, d.droit FROM v_droit d, v_info i WHERE d.nomdroit='yy' AND i.id<>2 AND (select val from @droits) <>3 
```

当然，这对您不起作用，因为 up_droits 需要查询中的 ix 和 d.droit 参数。这表明您的存储过程可能应该是一个视图或表值函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T07:53:33.307

抱歉，请将其**设为表值函数**而不是存储过程。

例如：

```
Scalar - SELECT id, name FROM test WHERE id < (SELECT dbo.mytestfunction())
Table - SELECT id, name FROM test WHERE id = (SELECT col1 from dbo.mytestfunction()) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T07:43:41.830

你不能。WHERE 子句的内容必须是[搜索表达式](http://msdn.microsoft.com/en-us/library/ms173545(SQL.90).aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T07:48:39.183

代码不能作为函数工作的原因是因为它修改了一些数据吗？如果是这样，那么你就不走运了，where 子句中使用的函数必须是不可变的。

如果存储过程不修改任何数据，您可以将其包装在函数中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T07:53:29.843

如果你在 SQL Server 上，我认为你不能按照你的建议去做。

但是您可以做的一件事是构建动态查询，但要小心这样做，因为它们会打开许多​​有趣的问题区域。

语法是：

```
EXEC @<query>
```

但是您可以做的另一件事（对您来说可能要好得多）是让 up_droits 函数将其结果传递到临时表中，如果您选择 #table 它在​​您的函数/过程范围内是临时的

```
 declare procedure up_droits() as
select val .. into #temp 
```

所以你要做的是创建一个程序

```
 create procedure Top10FromDroit
begin
  exec up_droits
  SELECT distinct top 10 i.x, d.droit FROM v_droit d, v_info i WHERE d.nomdroit='yy' AND i.id2 AND (select val from (#temp) 3 
```

希望这会给你你想要达到的结果。

如果一开始你没有成功，围绕它编写代码^^

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-01T22:52:40.737

你们中的任何人都可以解释在存储过程中执行动态 SQl 的原因吗？当你需要它们时，我知道的情况很少——但真的很少。99.9%（或 1000 个中的 999 个）执行字符串可以重写为带有参数的普通 sql 语句。

在 select 或 where 子句中具有函数的 Select 也是如此。

尝试考虑您的数据集，而不是如何解决它的程序方法。

# sql-server - 无法在 SSRS 中编辑或删除计划报告

> ID：943528
> 
> 赞同：3
> 
> 时间：2009-06-03T07:43:13.283
> 
> 标签：sql-server, reporting-services

在 SSRS 中编辑和删除计划报告时，我目前收到以下错误：“仅允许 sysadmin 角色的成员更新或删除由不同登录名拥有的作业。”

我尝试将作业的所有者更改为 SSRS 使用的服务帐户，我已将这些用户添加为系统管理员，并且我已经检查了 Reporting Services 本身的受限帐户的用户和密码。没什么大不了的。

报告服务日志仅显示：

```
w3wp!library!a!06/03/2009-01:23:42:: e ERROR: Throwing Microsoft.ReportingServices.Diagnostics.Utilities.InternalCatalogException: An internal error occurred on the report server. See the error log for more details., ;
 Info: Microsoft.ReportingServices.Diagnostics.Utilities.InternalCatalogException: An internal error occurred on the report server. See the error log for more details. ---> System.Data.SqlClient.SqlException: Only members of sysadmin role are allowed to update or delete jobs owned by a different login.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)
   at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Microsoft.ReportingServices.Library.InstrumentedSqlCommand.ExecuteNonQuery()
   at Microsoft.ReportingServices.Library.SqlAgentScheduler.DeleteTask(Guid id)
   at Microsoft.ReportingServices.Library.SchedulingDBInterface.UpdateTaskProperties(Task task, Boolean updateSqlAgentSchedule)
   at Microsoft.ReportingServices.Library.TimedSubscriptionHandler.ValidateSubscriptionData(Subscription subscription, String subscriptionData, UserContext userContext)
   at Microsoft.ReportingServices.Library.SubscriptionManager.ValidateSubscriptionData(Subscription subscription, String eventType, String subscriptionData)
   at Microsoft.ReportingServices.Library.SubscriptionManager.SetSubscriptionProperties(Guid id, String eventType, String matchData, ExtensionSettings extensionSettings, String description, ParameterValueOrFieldReference[] parameters, DataRetrievalPlan dataSettings)
   at Microsoft.ReportingServices.Library.SetSubscriptionPropertiesAction.PerformActionNow()
   at Microsoft.ReportingServices.Library.RSSoapAction`1.Execute()
   --- End of inner exception stack trace --- 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T07:45:59.750

我发现了问题。IIS 中报告管理器的 SSRS 应用程序池以网络服务用户身份运行，该用户被用作连接上下文，即使使用该服务的应用程序以受限用户身份登录也是如此。

解决方案：

*   将应用程序池更改为具有系统管理员权限或数据库中作业所有权的用户
*   或者将网络服务用户添加为 SQL 用户和 SysAdmin

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-19T23:10:58.603

我对 SSRS 2005 也有同样的问题。并非所有的报告都是这样的，而是遇到了无法更新/删除的奇怪订阅。IIS 作为内置网络在一台服务器上运行，表位于单独的集群服务器上。我无法向远程数据库服务器上的表授予 IIS 内置帐户权限。我很幸运地在目录中找到了报告的 itemid，匹配订阅表中的 report_oid 并删除了受影响订阅 itemid 的行。听起来很糟糕，但在此之后我可以重新创建订阅，世界上一切都很好。

# cocoa - 如何通过 NSOpenPanel 打开具有新文件夹功能的面板？

> ID：943535
> 
> 赞同：4
> 
> 时间：2009-06-03T07:45:29.737
> 
> 标签：cocoa

默认情况下，我们使用 NSOpenPanel 类方法打开一个打开面板： -beginSheetForDirectory:file:types:modalForWindow:modalDelegate:didEndSelector:contextInfo: 但是我发现有些软件可以使用新文件夹按钮打开打开面板，包括 XCode ，如何得到它？非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T01:17:43.727

由于[NSOpenPanel](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSOpenPanel_Class/Reference/Reference.html)继承自[NSSavePanel](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSSavePanel_Class/Reference/Reference.html#//apple_ref/occ/cl/NSSavePanel)，您可以使用 NSSavePanel 的`setCanCreateDirectories`方法，如下所示：

```
 // Show an 'Open' dialog box allowing save folder selection.
    NSOpenPanel *open = [NSOpenPanel openPanel];
    [open setCanChooseFiles:NO];
    [open setAllowsMultipleSelection:NO];
    [open setCanChooseDirectories:YES];
    [open setCanCreateDirectories:YES];
    [open setTitle:@"Open Panel Title"];
    [open setPrompt:@"Select Button Title"]; 
```

回到 OS X 10.2.x 时代，有一个私有方法 ，`_setIncludeNewFolderButton`它做同样的事情，但它在 Panther 中被删除了。不要尝试使用它——你的应用程序会崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-10-26T17:22:17.427

迅速：

```
 let picker = NSOpenPanel()
    picker.canCreateDirectories = true
    picker.runModal() 
```

# ruby-on-rails - 如何重构这个 Ruby（控制器）代码？

> ID：943545
> 
> 赞同：0
> 
> 时间：2009-06-03T07:49:33.347
> 
> 标签：ruby-on-rails, ruby, refactoring, automated-refactoring

这是我的报告控制器中的代码，它看起来很糟糕，谁能给我一些关于如何整理它的建议？

```
# app\controller\reports_controller.rb

 @report_lines  = []
   @sum_wp, @sum_projcted_wp, @sum_il, @sum_projcted_il, @sum_li,@sum_gross_profit ,@sum_opportunities = [0,0,0,0,0,0,0]    
 date = @start_date

 num_of_months.times do
    wp,projected_wp, invoice_line,projected_il,line_item, opp = Report.data_of_invoicing_and_delivery_report(@part_or_service,date)
    @sum_wp += wp
    @sum_projcted_wp +=projected_wp
    @sum_il=invoice_line
    @sum_projcted_il +=projected_il
    @sum_li += line_item
    gross_profit = invoice_line - line_item
    @sum_gross_profit += gross_profit
    @sum_opportunities += opp
    @report_lines << [date.strftime("%m/%Y"),wp,projected_wp ,invoice_line,projected_il,line_item,gross_profit,opp]
    date = date.next_month
 end 
```

我正在寻找使用某种方法，例如

```
@sum_a,@sum_b,@sum_c += [1,2,3] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T08:40:05.443

我的即时想法是：将代码移动到模型中。

目标应该是“瘦控制器”，因此它们不应包含业务逻辑。

其次，我喜欢将我的报告行作为 OpenStruct() 对象呈现给我的视图，这对我来说似乎更干净。

因此，我会考虑将这种累积逻辑移动到（很可能）Report 上的一个类方法中，并返回一组“报告行”OpenStructs 和一个总计 OpenStruct 以传递给我的视图。

我的控制器代码会变成这样：

```
@report_lines, @report_totals = Report.summarised_data_of_inv_and_dlvry_rpt(@part_or_service, @start_date, num_of_months) 
```

编辑：（一天后）

看着添加累积到数组的东西，我想出了这个：

```
require 'test/unit'

class Array
  def add_corresponding(other)
    each_index { |i| self[i] += other[i] }
  end
end

class TestProblem < Test::Unit::TestCase
  def test_add_corresponding
    a = [1,2,3,4,5]
    assert_equal [3,5,8,11,16], a.add_corresponding([2,3,5,7,11])
    assert_equal [2,3,6,8,10], a.add_corresponding([-1,-2,-2,-3,-6])
  end
end 
```

看：测试！它似乎工作正常。没有检查两个数组之间的大小差异，因此有很多方法可能出错，但这个概念似乎足够合理。我正在考虑尝试类似的方法，让我获取 ActiveRecord 结果集并将其累积到 OpenStruct 中，这是我倾向于在报告中使用的...

我们新的 Array 方法可能会将原始代码简化为如下所示：

```
totals = [0,0,0,0,0,0,0]    
date = @start_date

num_of_months.times do
  wp, projected_wp, invoice_line, projected_il, line_item, opp = Report.data_of_invoicing_and_delivery_report(@part_or_service,date)
  totals.add_corresponding [wp, projected_wp, invoice_line, projected_il, line_item, opp, invoice_line - line_item]
  @report_lines << [date.strftime("%m/%Y"),wp,projected_wp ,invoice_line,projected_il,line_item,gross_profit,opp]
  date = date.next_month
end

@sum_wp, @sum_projcted_wp, @sum_il, @sum_projcted_il, @sum_li, @sum_opportunities, @sum_gross_profit = totals 
```

...如果 Report#data_of_invoicing_and_delivery_report 也可以计算`gross_profit`，将进一步减少到：

```
num_of_months.times do
  totals.add_corresponding(Report.data_of_invoicing_and_delivery_report(@part_or_service,date))
end 
```

完全未经测试，但是对于向 Array 添加单行方法并在模型中执行单个额外减法，这是一个地狱般的减少。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T08:39:17.663

创建一个包含所有这些字段的求和对象，将整个数组传递给 @sum.increment_sums(Report.data_of...)

# visual-studio - 在 Visual Studio 中调试 XSLT 时的条件断点

> ID：943546
> 
> 赞同：0
> 
> 时间：2009-06-03T07:50:03.970
> 
> 标签：visual-studio, xslt, debugging

我发现你可以在 Visual Studio 中调试 XSLT，这很酷，但是如何设置*条件*断点呢？

例如，仅当某个变量为空时，我将如何中断？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-01-21T00:43:33.390

右键单击断点红圈并选择“条件”是否适合您？

# c# - 我应该如何创建用户偏好属性？

> ID：943548
> 
> 赞同：0
> 
> 时间：2009-06-03T07:50:59.333
> 
> 标签：c#, .net, asp.net-mvc

在我当前的 asp.net mvc 项目中，用户应该能够登录。登录时可以选择设置一组首选项。其中一些偏好是通用的（例如，首选的站点语言等），但有些是特定于该项目的（预定义的查询过滤等）。

由于这些偏好存在于我网站的许多不同位置，我将其定义为交叉关注。最好我会有一个属性来处理这个而不是它自己的每个动作。

我如何设计这样一个足够通用的属性以在未来的项目中重用，同时又对当前项目有足够的了解以使用所有项目特定的设置？

**--EDIT--**
获取和设置首选项不是问题。我将一个 UserSettings 类连接到 asp.net 配置文件提供程序。我的问题是如何将这种交叉关注从我的控制器中提取到一个属性中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T08:20:23.613

对于用户偏好，您应该使用 ASP.NET Profile Provider 框架。一些资源：

*   [ASP.NET 配置文件提供程序](http://msdn.microsoft.com/en-us/library/014bec1k.aspx)
*   [实现配置文件提供程序](http://msdn.microsoft.com/en-us/library/0580x1f5.aspx)
*   StackOverflow：[在 ASP.NET MVC 中实现 Profile Provider](https://stackoverflow.com/questions/79129/implementing-profile-provider-in-asp-net-mvc)
*   StackOverflow：[在 ASP.NET MVC 中实现自定义配置文件提供程序](https://stackoverflow.com/questions/834166/implementing-custom-profile-provider-in-asp-net-mvc)

您可以在 Profile 提供程序框架之上构建基于属性的用户偏好处理，但我想这种事情将特定于您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T08:04:52.990

独立地，如果您将该首选项存储在文本文件、xml 或数据库中，创建一个类（例如 Utility.UserPreferences）将不会更容易从用户加载这些首选项并将它们存储在 Session 变量中，然后使用一个枚举调用它们来检索/更新

```
namespace Utility
{
    public class UserPreferences
    {
        public UserPreferences(int userID)
        {
            // Load Preferences from text file, xml file or DB
            string loadedPreferences = "us|20|yes|no";

            HttpContext.Current.Session["userPreferences"] = loadedPreferences;
        }

        public void Savepreferences(string[] pref, int userID)
        { 
            // Save preferences for that user
        }

        public static string GetPreferences(PreferencesType type)
        {
            string[] pref = HttpContext.Current.Session["userPreferences"].ToString().Split('|');

            switch (type)
            {
                case PreferencesType.Language: return pref[0];
                case PreferencesType.ShowHowManyResults: return pref[1];
                case PreferencesType.ShowNavigation: return pref[2];
                case PreferencesType.GetEmailAlerts: return pref[3];
            }
        }

        public enum PreferencesType
        {
            Language, ShowHowManyResults, ShowNavigation, GetEmailAlerts
        }
    }
} 
```

然后 ...

```
// Login sucessfully...
Utility.UserPreferences pref = new Utility.UserPreferences(CurrentUser.ID);

// to retrieve a preference
string language = Utility.UserPreferences.GetPreferences(
                        Utility.UserPreferences.PreferencesType.Language,
                        CurrentUser.ID); 
```

这只是一个想法......我会这样做的方式......它很简单而且它的项目范围很广，因为你只需要改变类来持有更多的偏好......

# delphi - 不想让表格最小化

> ID：943551
> 
> 赞同：1
> 
> 时间：2009-06-03T07:51:52.220
> 
> 标签：delphi, minimize

是否可以在 Delphi 中禁止最小化表单\应用程序？

我找到了以下代码：

```
procedure TForm1.WMShowWindow(var Msg: TWMShowWindow);
begin
  if not Msg.Show then
    Msg.Result := 0
  else
    inherited;
end; 
```

但是，如果我按 Windows 键 + M 或 WindowsKey + D，它仍然会被最小化。有没有办法防止这种情况？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T08:35:19.527

将 BorderIcons.bsMinimized 设置为 false（将其从集合中删除）将适用于 WindowsKey + M，但不会停止 WindowsKey + D。我认为这是有道理的。两者之间的区别在于第一个是要求所有窗口最小化，而第二个是用户明确请求查看他们的桌面。覆盖后者可能会惹恼用户（类似于强迫自己集中注意力）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T09:11:46.083

或者您可以放置​​一个键盘挂钩并抓住 winkey+d 或 winkey+m 并保持您的表单最大化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T14:57:32.953

只需将这样的代码放入表单***onShow***事件中：

```
 WindowState:=wsMaximized; 
```

对于***OnCanResize***这个：

```
 if (newwidth<width) and (newheight<height) then
    Resize:=false; 
```

# javascript - 如何在 QWebView 中获取 Javascript 以创建基于 C++ 的类的新实例？

> ID：943554
> 
> 赞同：6
> 
> 时间：2009-06-03T07:52:50.283
> 
> 标签：javascript, qt, webkit, qtwebkit

我已经使用 addToJavaScriptWindowObject 成功地将 C++ 对象添加到[QWebFrame](https://doc.qt.io/qt-4.8/qwebframe.html#addToJavaScriptWindowObject)中，并且可以从 javascript 调用该对象上的插槽。

但我真正想做的是让其中一个插槽返回一个新对象。例如，我有一个像这样的插槽，它返回一个 QObject 派生类实例：

```
 MyObject* MyApp::helloWorld()
   {
          //MyObject is dervied from QObject
          return new MyObject();
   } 
```

我可以像这样从javascript成功调用这个插槽

```
 var foo=myapp.helloWorld(); 
```

但是 foo 似乎是空的，我无法调用任何插槽或从 Javascript 访问其上的任何属性。

关于如何实现这一目标的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T20:31:39.063

我考虑过的一个相当丑陋的技巧是使用 addToJavaScriptWindowObject 将我想要返回的对象放入具有随机名称的窗口对象中，然后让我的插槽返回对象实例的名称：

```
QString MyApp::helloWorld()
{
     //general a unique name for the js variable
     QString name=getRandomVariableName();

     //here's the object we want to expose to js
     MyObject* pReturn=new MyObject();

     //we make attach our object to the js window object    
     getWebFrame()->addToJavaScriptWindowObject(name, pReturn,
         QScriptEngine::ScriptOwnership);  

     //tell js the name we used
     return name;
} 
```

可以编写JS来检查返回值是否为字符串，如果是则从窗口中抓取对象：

```
var foo=myapp.helloWorld();
if (typeof foo == "string")
{
    foo=window[foo];
} 
```

有点难看，但会在更好的方法出现之前让我度过难关。未来的 Qt 版本将统一脚本支持，使其全部基于 WebKit 中的 JavaScriptCore，因此希望这会有所改善！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-03T07:22:42.127

您可以将 Object 指针分配给 QObject * 并返回它。

```
 QObject * obj = new MyObject();
    return obj; 
```

这在 Linux 上的 Qt Webkit 端口上对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-04T14:51:04.950

QtScript 具有原型的概念——它允许您为脚本值创建 C++ 原型。我们正在研究是否可以将 QtScript 与 JavaScriptCore 连接起来——这*应该*会导致使用 WebKit 的 JavaScript 环境中的原型的可能性；[http://doc.trolltech.com/4.5/qtscript.html#making-use-of-prototype-based-inheritance](http://doc.trolltech.com/4.5/qtscript.html#making-use-of-prototype-based-inheritance)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-11T15:55:56.357

尝试将新对象作为 QObject* 而不是 MyObject* 返回。如果您只是使用 QtScript，那么您可以调用[qScriptRegisterMetaType](http://doc.trolltech.com/4.5/qscriptengine.html#qScriptRegisterMetaType)来定义一些代码来处理将 MyObject*s 转换为 QScriptValues（或 QVariants），但似乎没有与 QtWebKit 中使用的 JavaScript 引擎等效的代码。

令人讨厌的是，这意味着将您的内部对象模型暴露给 WebKit 将涉及使用一组单独的代理函数将您的对象指针转换为 QObject*s，或者使用某种适配器类来做同样的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-05T04:55:14.447

这个答案是基于保罗的答案，但有点简化。经过测试并适用于 Qt 5.3。您需要一个实例化对象的工厂，然后返回`QObject`指向该对象的指针。对象的类必须继承自，`QObject`以便它在 JavaScript 中正常工作：

```
QObject * MyApp::createInstance(QString objname) {
    MyClass * obj = new MyClass(this);
    m_mainWindow->webView->page()->mainFrame()->addToJavaScriptWindowObject(objname, obj, QWebFrame::ScriptOwnership);
    return obj;
} 
```

有了这个，您可以从 Javascript 执行以下操作：

```
var myobject = MyApp.createInstance("obj1"); 
```

此时，您在全局 JavaScript 命名空间中拥有`obj1`以及`myobject`（它们只是指针，因此执行以下两项工作：

```
myobject.testmethod();
obj1.testmethod(); 
```

此时，您可以`connect`在 JavaScript 中使用将 C++ 信号连接到 JavaScript 插槽。有关此技术的更多信息：http: [//doc.qt.io/qt-5/qtwebkit-bridge.html](http://doc.qt.io/qt-5/qtwebkit-bridge.html)

# php - PHP mail() 产生一个“dead.letter”文件

> ID：943556
> 
> 赞同：1
> 
> 时间：2009-06-03T07:53:07.053
> 
> 标签：php, email

我有一个使用 PHP mail() 函数发送电子邮件的脚本：

邮件（“我@mydomain.com”，“主题”，“消息”）；

直到昨天一切都很好。现在，邮件要么以 dead.letter 文件结尾，要么不被发送。

这可能是什么原因？关于如何调试此类代码的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T08:06:51.190

如果对你来说都一样，我建议使用[SwiftMailer](http://swiftmailer.org)之类的东西，而不是 php 的内置 mail() 函数。

无论如何，你的 MTA 是否给你一个死信的理由？您可能会在文件 /var/log/maillog 中找到线索（取决于您的服务器/MTA 配置）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T10:01:42.627

当 sendmail 无法发送邮件时，它会将邮件保存在一个名为“dead.letter”的文件中。您的 sendmail 可能配置错误或根本没有运行。

编辑：您可能需要检查 /var/log/maillog 以检查来自 sendmail 的调试信息。

# java - Microsoft 的 MVC 是 Dot net 的新 Struts 吗？

> ID：943560
> 
> 赞同：1
> 
> 时间：2009-06-03T07:53:37.160
> 
> 标签：java, asp.net-mvc, struts

我没有使用过 MVC，但我只是想作为一个 Java 人，因此 q.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T08:21:20.397

简短的回答......是的。它们都是 MVC 框架，针对不同的开发堆栈。也就是说，有很多不同的 MVC 框架，它们在帮助开发人员在该模式下工作的方式上都有所不同。例如，MonoRails 是另一个 ASP.NET MVC 框架。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T07:56:57.513

我从来没有真正使用过 Struts，但这个 wiki 可能用于比较：

[http://en.wikipedia.org/wiki/Comparison_of_web_application_frameworks](http://en.wikipedia.org/wiki/Comparison_of_web_application_frameworks)

# java - 如何配置 OSGi 环境以便可以从 EclipseStarter 类中使用它？

> ID：943575
> 
> 赞同：1
> 
> 时间：2009-06-03T07:58:02.957
> 
> 标签：java, configuration, command-line, osgi, executable-jar

目前我正在尝试使用 EclipseStarter 类的功能来执行一些包。如果我直接从 Eclipse 运行我的程序，则会加载 OSGi 服务包，并且我可以安装和启动其他包。

但是，如果我将我的 java 程序导出到一个可执行的 jar 文件并从命令行运行它，那么环境会加载一个名为“System Bundle [0]”的包，而不是 OSGi 服务包。每次尝试安装新包都会导致 Nullpointer-Exception。

我是否必须在框架属性中设置一些特殊配置才能使用 jar 文件中的 OSGi 环境？目前我只设置以下两个值：

```
frameworkProperties.put("osgi.clean", "true");
frameworkProperties.put("osgi.console", "true"); 
```

更新：

我认为我的问题可能与使用的 java 类路径有关。如果我像这样将 Framework-Bundle 添加到类路径中

```
java -classpath /home/markus/org.eclipse.osgi_3.4.3.R34x_v20081215-1030.jar:test.jar 
Starter.Starter 
```

一切正常：

```
osgi> ss

Framework is launched.

id      State       Bundle
0       ACTIVE      org.eclipse.osgi_3.4.3.R34x_v20081215-1030 
```

但如果我只运行 jar 文件，我会收到以下错误日志：

```
markus@markus-laptop:~/configuration$ cat 1244201504478.log
!SESSION 2009-06-05 13:31:44.895 -----------------------------------------------
eclipse.buildId=unknown
java.version=1.6.0_13
java.vendor=Sun Microsystems Inc.
BootLoader constants: OS=linux, ARCH=x86, WS=gtk, NL=de_DE
Command-line arguments:  -clean -console

!ENTRY org.eclipse.osgi 4 0 2009-06-05 13:31:44.897
!MESSAGE An unexpected runtime error has occurred.
!STACK 0
java.lang.NullPointerException
        at org.eclipse.osgi.internal.baseadaptor.BaseStorage.readStateData(BaseStorage.java:743)
        at org.eclipse.osgi.internal.baseadaptor.BaseStorage.getStateManager(BaseStorage.java:698)
        at org.eclipse.osgi.baseadaptor.BaseAdaptor.getState(BaseAdaptor.java:390)
        at org.eclipse.core.runtime.adaptor.EclipseStarter$1.bundleChanged(EclipseStarter.java:307)
        at org.eclipse.osgi.framework.internal.core.BundleContextImpl.dispatchEvent(BundleContextImpl.java:1234)
        at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:211)
        at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:141)
        at org.eclipse.osgi.framework.internal.core.Framework.publishBundleEventPrivileged(Framework.java:1518)
        at org.eclipse.osgi.framework.internal.core.Framework.publishBundleEvent(Framework.java:1469)
        at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:281)
        at org.eclipse.osgi.framework.internal.core.StartLevelManager.launch(StartLevelManager.java:247)
        at org.eclipse.osgi.framework.internal.core.SystemBundle.resume(SystemBundle.java:201)
        at org.eclipse.osgi.framework.internal.core.Framework.launch(Framework.java:644)
        at org.eclipse.osgi.framework.internal.core.OSGi.launch(OSGi.java:51)
        at org.eclipse.core.runtime.adaptor.EclipseStarter.startup(EclipseStarter.java:313)
        at CanEmulator.OSGiFramework.run(OSGiFramework.java:119)
        at java.lang.Thread.run(Thread.java:619)

!ENTRY System Bundle 4 0 2009-06-05 13:31:44.898
!MESSAGE
!STACK 0
java.lang.NullPointerException
        at org.eclipse.osgi.internal.baseadaptor.BaseStorage.readStateData(BaseStorage.java:743)
        at org.eclipse.osgi.internal.baseadaptor.BaseStorage.getStateManager(BaseStorage.java:698)
        at org.eclipse.osgi.baseadaptor.BaseAdaptor.getState(BaseAdaptor.java:390)
        at org.eclipse.core.runtime.adaptor.EclipseStarter$1.bundleChanged(EclipseStarter.java:307)
        at org.eclipse.osgi.framework.internal.core.BundleContextImpl.dispatchEvent(BundleContextImpl.java:1234)
        at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:211)
        at org.eclipse.osgi.framework.eventmgr.ListenerQueue.dispatchEventSynchronous(ListenerQueue.java:141)
        at org.eclipse.osgi.framework.internal.core.Framework.publishBundleEventPrivileged(Framework.java:1518)
        at org.eclipse.osgi.framework.internal.core.Framework.publishBundleEvent(Framework.java:1469)
        at org.eclipse.osgi.framework.internal.core.StartLevelManager.doSetStartLevel(StartLevelManager.java:281)
        at org.eclipse.osgi.framework.internal.core.StartLevelManager.launch(StartLevelManager.java:247)
        at org.eclipse.osgi.framework.internal.core.SystemBundle.resume(SystemBundle.java:201)
        at org.eclipse.osgi.framework.internal.core.Framework.launch(Framework.java:644)
        at org.eclipse.osgi.framework.internal.core.OSGi.launch(OSGi.java:51)
        at org.eclipse.core.runtime.adaptor.EclipseStarter.startup(EclipseStarter.java:313)
        at CanEmulator.OSGiFramework.run(OSGiFramework.java:119)
        at java.lang.Thread.run(Thread.java:619) 
```

目前，我在我的 Eclipse 项目中使用 framework-jar-file 作为外部库。我认为当我将项目导出到可执行文件时出现问题......

BR,

马库斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T09:07:38.383

我还将添加以下属性

```
osgi.noShutdown=true

osgi.configuration.area= (path)
osgi.baseConfiguration.area= (path)
osgi.sharedConfiguration.area= (path)
osgi.instance.area= (path)
osgi.user.area= (path) 
```

第一个告诉 Equinox 不要停止。如果您不创建 Eclipse 应用程序，这是必要的。其他的是各种文件应该去的路径。当您想使用控制台时，只需执行

```
osgi.console= 
```

不需要值。如果你输入一个数字，那将是一个可以看到控制台的 telnet 端口。

现在，对于您的捆绑包，您将始终看到系统捆绑包。那就是 OSGi 本身。要添加其他捆绑包，您需要安装它们。您可以通过控制台安装它们，或者通过配置使用：

```
osgi.bundles= (comman delim list of bundle paths) 
```

您可以使用 System Bundle 实例以编程方式安装包，该实例可以从 EclipseStarter 获得。

如果这些不起作用，您能否上传堆栈跟踪或 osgi 日志文件（您可能会在工作目录或“osgi.configuration.area”中找到 osgi 日志文件）。这将是一个名称纯数字的文件。

# wpf - XAML 有多独特？

> ID：943579
> 
> 赞同：6
> 
> 时间：2009-06-03T08:02:19.843
> 
> 标签：wpf, silverlight, xaml

正在与一位同事谈论 XAML，以及它如何既是一种表示语言又是对象描述语言，因此在 IT 技术中非常独特和新颖。

XAML 是独一无二且新颖的，这是真的吗？

XAML 在 Java 世界或其他地方是否有任何对应物或前身？我相信有人告诉我 Java Server Faces 类似于 WPF，那么那里的 XAML 等价物是什么？

我知道 Flex 中的 MXML 是相似的，但据我所知，存在一些主要的结构差异，据我所知，MXML 并没有真正描述对象，而更像是一种纯粹的表示 XML。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T08:52:59.787

这是具有如此压倒性的通用特定用途的通用技术的情况，该通用技术成为特定用途的同义词。例如，Javascript 的讨论通常假设浏览器上下文和 HTML DOM 的操作，而无需任何人明确表示。

严格来说，XAML 除了是 XML 之外，不像 XUL 或 SVG。XUL、SVG 具有用于声明用户界面或图形元素的已定义语法，而原始 XAML 则没有。

例如，XAML 也可以用于描述 Workflow Foundation 中的 Workflows。

XAML 实际上是一种读取 XML 以描述这些类型的类型和属性的方法。例如，可以使用属性或元素来描述类型的属性，只要它的名称可以正确解释即可。XAML 还包括对基本 XML 语法的扩展，其中属性中的 { } 可以充当复杂元素的简写。

我以前没有遇到过这种事情。所有其他基于 XML 的技术都有特定的用途，XAML 是我见过的第一个 XML 用法，它没有任何特定的命名法，只是一种将 XML 映射到类型的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T08:36:42.847

****XAML、XUL 和 XHTML 重叠****

XAML 和其他标准之间最大的重叠在于它支持从 HTML/XHTML 中提取的概念。XAML 和 HTML 之间有很多相似之处。当然，与 HTML 的重叠不仅限于 XAML。另一个著名的 XML GUI 方言——Mozilla 的 XUL——也与 XHTML 重叠。最后，XAML 和 XUL 在 XHTML 甚至不包括的地方都有重叠。XHTML 和 XUL 可以组合在一个文档中（至少在 Mozilla 浏览器中）。这种组合是 XAML 的非 Web 用途的粗略模拟。事实上，Mozilla 的 XUL 本身就是 XAML 某些用途的粗略模拟。

但综合起来，它们实际上只支持大多数基本的 HTML 内容和表单小部件，这些小部件已经在普通 Web 应用程序中很常见。XUL 与 XHTML 的重叠比 XAML 少，因为 XUL 试图将自己与 XHTML 分开。它并没有像 XAML 那样试图成为一个替代品。

与 HTML 相比，我喜欢 XAML 的一件事是增加了从 HTML 的发布派生特性中的自由度。XAML 将您从 h1 标记、代码标记和许多其他在 HTML 中不经常使用的杂项标记中解放出来。出于实际目的，这些标签在现代 HTML 文档中仅充当样式信息。

尽管 Web 很受欢迎，但 HTML 对于应用程序来说也是一个糟糕的 GUI。XAML 和 XUL 都在纠正这个问题上大有帮助。如果 XAML 有更好的 CSS 支持，您可以用 XAML 重新编写您的 Web 应用程序，它们看起来会比 HTML 原件更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T09:02:56.570

来自 Apple 的 Cocoa 或更早的事件 NeXtStep 早在 XAML 之前就有类似的东西。

GUI 是使用界面构建器创建的，它生成所谓的 nib ( [Nextstep Interface Builder](http://en.wikipedia.org/wiki/Interface_Builder) ) 文件，其中包含布局、绑定、操作、出口和序列化对象实例。以前这些 nib 文件以二进制文件格式存储，但现在它也是 xml (xib)。

所以 XAML 不是第一个，根本不是唯一的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T14:06:21.777

仔细阅读与其他表示技术的比较 - Xaml 是一种构造和组合 .NET 对象的方法。这与其他旨在构建用户界面的系统形成鲜明对比。Xaml 的好处在于它*独立*于它所使用的技术堆栈——它是一种与目的无关的声明性语言，它更像 C# 而不是 XHTML。这样，它是独一无二的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T08:19:24.223

除了 XAML，您还有 Mozilla 使用的 XUL。另一方面，SVG 是 W3C 推荐的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T08:26:17.237

Mozilla 创建他们的 UI 描述语言[XUL](http://en.wikipedia.org/wiki/XUL)最初是为了能够轻松地自定义其所有产品的 UI。如今，它是一个可以包含在其他应用程序中并且还具有扩展功能的包。

尽管 XUL 主要关注 UI 表示，但它也包含其他结构，例如事件和脚本以及数据源。尽管如此，据我所知，XAML 将这些概念更紧密地集成到它们的 .NET（和附加）框架中。但我不确定这是否足以称其为独特和新颖。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-23T03:23:20.540

`XAML`是方言中的一种对象图构造语言`XML`（不是最好的选择）。每个`XAML`元素都是一个对象实例化，相应的属性是所述实例上的属性分配。由于`XML`是基于字符串的语言，属性值需要从其字符串类型转换为属性期望的任何类型。这是使用处理器自动定位和使用`TypeConverter`的后代来完成的。`XAML`XAML 和 WPF 附带一组默认的 TypeConverters，对应于它们提供的类型，您可以提供自己的类型。

定义过程的粗略概述如下：

```
<classG-in-namespace-A
   xmlns="namespace-A"
   xmlns:alias-B="namespace-B"
   xmlns:alias-C="clr-namespace:namespace-C;assembly=assembly-of-namespace-C"
   propertyG1="simple text value stipulation"
   propertyG2="{alias-C:classH-in-namespace-C propertyC1=valueC1,..}"
   >
   <classG-in-namespace-A.propertyG2>
        <alias-B:class-I-in-namespace-B propertyB1=valueB1,...>
           class-I-in-namespace-B's content property value assignment
        </alias-B:class-I-in-namespace-B>
   </classG-in-namespace-A.propertyG2>
   classG-in-namespace-A's content property value assignment
</classG-in-namespace-A> 
```

There are utility types provided by XAML and WPF beyond TypeConverters that facilitate property assignments. In particular, there are the following: `ResourceDictionary`, `ObjectDataProvider`, `RelativeSource`, `StaticResource`, `DynamicResource`, [...and more as shown in Microsoft Docs](https://msdn.microsoft.com/en-us/library/system.windows.data.multibinding(v=vs.110).aspx)

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-06-03T08:23:49.690

嗯，XAML 基本上是 .NET 的高级标记，因此我认为您可以从 XAML 和 XHTML 中得出很多相似之处——两者都是表示技术。

也有很多差异（XHTML 被浏览器解释以产生图形，而 XAML 被编译成 MSIL 并依靠 CLR 来做图形:)）

# javascript - 如何调试 JQuery 选项卡的浏览器兼容性问题？

> ID：943583
> 
> 赞同：1
> 
> 时间：2009-06-03T08:04:00.993
> 
> 标签：javascript, jquery, user-interface, tabs

*   Jquery 选项卡在 IE6 的手风琴中显示为垂直列表。
*   但它在 Firefox 和 IE 7 中运行良好。有什么解决方案吗？

我在 jquery 手风琴中使用 Jquery 选项卡。它可以正常工作并显示良好的 IE7 和 firefox，但不能在 IE6 中显示。选项卡显示为垂直列表。选项卡确实有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-12-18T09:05:54.270

jQuery UI 1.9 版本应该没有这个问题，尝试使用最新版本。

正如[jQuery UI 1.10 升级指南](http://jqueryui.com/upgrade-guide/1.10/#removed-support-for-ie6)所建议的那样：

> **删除了对 IE6 的支持**
> 
> IE6 的使用率已经下降到 jQuery UI 不再需要支持的程度。从 1.10.0 开始，jQuery UI 的某些部分可能无法在 IE6 中正常工作。如果需要继续支持 IE6，请使用最新的 jQuery UI 1.9 版本。

# unit-testing - 在使用 Hibernate 进行单元测试时比较实体

> ID：943590
> 
> 赞同：1
> 
> 时间：2009-06-03T08:08:33.510
> 
> 标签：unit-testing, hibernate, junit, entity

我正在使用内存 HSQLDB 运行 JUnit 测试。假设我有一个向数据库插入一些值的方法，并且我正在检查该方法是否正确插入了这些值。请注意，插入的顺序并不重要。

```
@Test
public void should_insert_correctly() {
    MyEntity[] expectedEntities = new MyEntity[2];
    // init expected entities

    Inserter out = new Inserter(session); // out: object under test
    out.insert();

    List list = session.createCriteria(MyEntity.class).list();

    assertTrue(list.contains(expectedEntities[0]));
    assertTrue(list.contains(expectedEntities[1]));
} 
```

问题是我无法将预期实体与实际实体进行比较，因为预期的 id 和实际的 id 不同。由于 MyEntity 的 setId() 是私有的（以防止显式设置 id），我不能将所有实体的 id 设置为 0 并进行比较。

如何比较两个结果集而不管它们的 id 是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-04T06:53:59.327

我发现这更实用。我不是一次获取所有结果，而是根据标准获取结果并断言它们不为空。

```
public void should_insert_correctly() {
    Inserter out = new Inserter(session); // out: object under test
    out.insert();

    Criteria criteria;

    criteria = getCriteria(session, 0);
    assertNotNull(criteria.uniqueResult());

    criteria = getCriteria(session, 1);
    assertNotNull(criteria.uniqueResult());
}

private Criteria getCriteria(Session session, int i) {
    Criteria criteria = session.createCriteria(MyEntity.class);
    criteria.add(Restrictions.eq("x", expectedX[i]));
    criteria.add(Restrictions.eq("y", expectedY[i]));
    return criteria;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T08:43:40.243

有状态的实体不应覆盖 equals - 也就是说，应通过引用身份比较实体是否相等 - 因此 List.contains 不会按您的意愿工作。

我所做的是使用反射来比较原始实体和重新加载实体的字段。遍历对象字段的函数会忽略瞬态字段和注释为@Transient 的字段。

我发现我不需要忽略 id。当对象第一次刷新到数据库时，Hibernate 为其分配一个 id。重新加载时，对象将具有相同的 id。

您的测试中的缺陷是您没有设置事务边界。您需要在一个事务中保存对象。当您提交该事务时，Hibernate 会将对象刷新到数据库并分配它们的 ID。然后在另一个事务中从数据库中加载实体。您将获得另一组应具有相同 ID 和持久（即非瞬态）状态的对象。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-03T09:04:54.583

我会尝试`Object.equals(Object)`在您的课程中实现方法`MyEntity`。

`List.contains(Object)`使用`Object.equals(Object)`（来源：[Java 6 API](http://java.sun.com/javase/6/docs/api/java/util/List.html#contains(java.lang.Object))）来确定对象是否在此列表中。

该方法`session.createCriteria(MyEntity.class).list();`返回一个包含您插入的值的*新实例列表（希望如此）。*
所以你需要比较这些值。这很容易通过`Object.equals(Object)`.

**澄清编辑：**
您可以忽略`equals`方法中的 id，以便比较只关心“真实值”。

**YAE（另一个编辑）：**
我推荐阅读这篇关于`equals()`方法的文章：[Angelika Langer: Secrets Of Equal](http://www.angelikalanger.com/Articles/JavaSolutions/SecretsOfEquals/Equals.html)。它很好地解释了所有背景信息。

# language-agnostic - 使用 LOC 确定项目规模

> ID：943591
> 
> 赞同：3
> 
> 时间：2009-06-03T08:08:44.773
> 
> 标签：language-agnostic, code-metrics, lines-of-code

需要多少行代码 (LOC) 才能被视为一个大型项目？只写一个人怎么样？

我知道这个指标是有问题的，但是对于单个开发人员来说，1k 和 10k LOC 之间存在显着差异。我通常使用空间来提高可读性，尤其是对于 SQL 语句，并且为了维护目的，我尝试减少 LOC 的数量，以尽可能多地遵循最佳实践。

比如我今天修改的代码创建了一个统一的diff，超过1k LOC（包括注释和空行）。“修改后的 LOC”是一个更好的指标吗？我有~2k LOC，所以我修改了 1k 令人惊讶。我猜重写既是删除又是添加，这会使统计数据加倍。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T08:15:26.477

一个稍微没用的指标 - 编译时间。
如果您的项目需要超过...比如说，编译 30 分钟，那么它就很大了 :)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T08:16:03.153

使用[Steve Yegge](http://steve-yegge.blogspot.com/)作为规模上限的基准，假设[500k 行代码](http://en.wikipedia.org/wiki/Wyvern_(Online_Game))是（超过？）单个开发人员可以维持的最大值。

不过更严重的是；我认为一旦你达到 100k LOC，你可能会想要在扩展代码之前开始寻找重构。

但是请注意，绕过此限制的一种方法显然是更多地划分代码。如果所有代码的总和由两个或三个大型库和一个应用程序组成，那么结合起来可能会比您作为单个代码库维护的要多，但只要每个库都很好地自包含，您就是不会超出理解解决方案每个部分的能力。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T08:28:30.337

也许对此的另一个衡量标准是[COCOMO](http://en.wikipedia.org/wiki/Cocomo)衡量标准——尽管它可能与 LOC 一样无用。

单个开发人员只能做有机项目——具有“良好”经验的“小”团队，可以处理“不那么严格”的需求。

在这种情况下，以人工月计算的工作量计算为

```
2.4 * (kLOC)^1.05 
```

也就是说，1kLOC 需要 2.52 人月。您可以根据产品、硬件、人员和项目属性使用多个因素来优化它。

但是我们现在所做的只是将 LOC 投影到时间测量中。在这里，您必须再次决定是否将 2 个月或 20 个月的项目视为大型项目。

但正如你所说，LOC 可能不是正确的测量方法。关键词：软件度量，功能点，基于证据的调度，计划游戏。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T08:22:11.283

在我看来，这还取决于您的代码设计——我从事过 1-10K loc 范围内的项目，设计非常糟糕，感觉就像一个非常大的项目。

但是 LOC 真的是一个有趣的代码度量吗？;-)

# c# - 静态方法还是 OO 替代方案？

> ID：943592
> 
> 赞同：0
> 
> 时间：2009-06-03T08:09:11.700
> 
> 标签：c#, design-patterns, oop

假设有一个像 Person 这样的类，它与在 Setting 类中实现的一些默认设置相关联。这些设置可能是“默认标题”或“需要名字”之类的。相应地，其他类如地址类也可能有一些默认设置。Setting 类将每个设置保存到一个持久存储中。

是否应该在每个类中实现一个静态方法，例如包含这些设置的“SetDefaults()”，以便外部方法可以在每个对象类型上调用 SetDefaults()？例如 Person.SetDefaults() 然后是 Address.SetDefaults()？

还是有一些更好的面向对象的方式来做到这一点？

[更新：这不能在构造函数中，因为 SetDefaults() 应该在特定时间点从外部类调用，而不是每次构造对象时。]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T08:24:34.430

我想不出很多情况下默认值真正跨越...考虑到一个对象可能经历的所有不同用例（尤其是反序列化之类的事情——即使不是这样，最终也可能会设置默认值是什么意思）。

这里的一种选择是 IoC；像 StructureMap 这样的 IoC 容器能够在初始化后设置属性，然后从调用代码中抽象出来。

另一种选择可能是某种模板实例（静态），实例可以从中复制值。但我认为这在某些情况下是有风险的。如果不同的线程（可能是网络服务器上的请求）需要不同的默认值，您也会遇到问题。`[ThreadStatic]`不是一个*好的*选择（尽管它是一个选择）。

另一种选择（提供最大的灵活性）是提供一个用户可设置的工厂......也许通过委托或事件机制 - 但我很难理解*为什么*你可能想要这种情况。这不是我经常看到的...

* * *

重新更新：如果只被外部类使用；它是否可以使用类似扩展方法的东西（而不是`Person`类必须对此有所了解）：

```
public static class PersonExt {
    public static void SetDefaults(this Person person) {
       // your code
    }
} 
```

由于听起来原始`Person`类不关心`SetDefaults`，因此这与巧妙地脱离了逻辑`Person`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T08:12:15.157

为什么不在创建对象时（在构造函数中）设置这些默认值。默认值是 -imho- 当没有为该属性赋予特定值时应该分配给该属性的值，因此，我认为在创建对象时设置这些默认值是个好主意（在构造函数中，或通过工厂）。

或者，我错过了什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T08:23:18.053

我会把它们放在构造函数中。

```
class Person
{
  public Person()
  {
    this.Settings = MakeDefault();
  }

  public Person(Settings settings)
  {
    this.Settings = settings;
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T08:32:37.877

您可以创建一个设置类来封装所有类（Person、Address）的设置。

您可以为说人设置默认设置：

```
// Injected
Settings settings;
Setting personSetting = new ...;

...
settings.StoreSettingsFor(typeof(Person), personSettings); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T08:32:50.170

如果您愿意，您还可以使用单例来存储此数据，特别是如果从某处的存储中检索值，因为这将减少访问存储的次数。

（在这种情况下，存储可以是数据文件、注册表、数据库。）

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-03T08:20:30.227

您还可以实现[抽象工厂模式](http://en.wikipedia.org/wiki/Abstract_factory_pattern)并使用您的设置配置工厂。或者，您也可以使用[IoC](http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx)[将依赖](http://en.wikipedia.org/wiki/Dependency_injection)项注入此工厂类。

Preson 的简单工厂类如下所示：

```
public class PersonFactory
{
  private readonly ISettings settings;

  public PersonFactory(ISettings settings)
  {
    this.settings = settings;
  }

  public Person Create()
  {
     Person p = new Person();
     // ... you code for populating person's attributes form settings.
     return p;
  }
} 
```

# asp.net-mvc - ADO.Net 实体框架/Linq

> ID：943598
> 
> 赞同：0
> 
> 时间：2009-06-03T08:12:38.870
> 
> 标签：asp.net-mvc, linq, entity-framework

我正在考虑学习更多 ASP.Net MVC 和 Linq To Entity。

我正在使用它来开发一个项目，但下面的代码行有问题

```
ViewData["ProjectName"] = db.Projects.FirstOrDefault(p => p.ProjectId  == task.ProjectId).ProjectName; 
```

当记录存在时它工作正常，但如果不存在记录它会出错，因为我正在尝试检查空对象的 ProjectName 属性。我意识到我可以将对象转换为变量并在将 ProjectName 存储到 ViewData 之前测试它是否为空，但我只是想知道是否有更简洁的方法来执行此操作？

我知道这是一个简单的问题，我可以解决它，但如果有更好的方法来做到这一点，那就太好了。

谢谢

加文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T08:16:54.773

```
var project = db.Projects.FirstOrDefault(p => p.ProjectId == task.ProjectId);
if (project != null)
{
  ViewData["ProjectName"] = project.ProjectName;
}
else
{
  //........
} 
```

不需要演员表。

或者完全跳过条件并执行以下操作：

```
ViewData["ProjectName"] = db.Projects.Where(p => p.ProjectId == task.ProjectId)
                           .Select(p => p.ProjectName).FirstOrDefault(); 
```

# java - 如何自定义 JComboBox 的外观？

> ID：943606
> 
> 赞同：3
> 
> 时间：2009-06-03T08:15:53.667
> 
> 标签：java, swing

我想制作一个如下所示的下拉列表：

[![替代文字](https://i.stack.imgur.com/Q7tBs.png)](https://i.stack.imgur.com/Q7tBs.png)

JComboBox 提供了我需要的功能，因此我不需要编写自定义组件。但是我找不到一种方法来自定义 JComboBox 的整个外观来实现这一点。有什么建议么？

**更新**：我不希望所有 JComboBoxes 看起来像这样。我只想用这种自定义外观创建一个。据我所知，创建自定义 L&F 不是解决方案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T08:30:06.790

JComboBox UI 由文本字段、列表和箭头组成。要自定义它们，您可以使用一些现成的 L&F 或使用 Synth L&F 最轻松地实现它们。

初始化 L&F：

```
SynthLookAndFeel lookAndFeel = new SynthLookAndFeel();

try {
    lookAndFeel.load(YourClassAlongWithSynthXml.class.getResourceAsStream("synth.xml"), YourClassAlongWithSynthXml.class);
} catch (ParseException e) {
    e.printStackTrace();
}

UIManager.setLookAndFeel(lookAndFeel); 
```

其中 synth.xml 包含如下内容：

```
<style id="textfield">
    <insets top="4" left="6" bottom="4" right="6" />

    <state>
        <font name="Verdana" size="12" />

        <!--
        <color type="BACKGROUND" value="#D2DFF2" />
        -->
        <color type="TEXT_FOREGROUND" value="#003c2d" />
    </state>

    <imagePainter method="textFieldBorder" path="images/textfield.png" sourceInsets="4 6 4 6" paintCenter="false" />
</style>

<bind style="textfield" type="region" key="TextField" />

<style id="arrowStyle">
    <imagePainter method="arrowButtonForeground" path="images/arrow-up.png" sourceInsets="0 0 0 0" stretch="false" direction="north" />
    <imagePainter method="arrowButtonForeground" path="images/arrow-down.png" sourceInsets="0 0 0 0" stretch="false" direction="south" />
    <imagePainter method="arrowButtonForeground" path="images/arrow-left.png" sourceInsets="0 0 0 0" stretch="false" direction="west" />
    <imagePainter method="arrowButtonForeground" path="images/arrow-right.png" sourceInsets="0 0 0 0" stretch="false" direction="east" />
</style>

<bind key="ArrowButton" type="region" style="arrowStyle" />

<style id="comboArrowStyle">
    <imagePainter method="arrowButtonForeground" path="images/combobox-arrow.png" sourceInsets="0 0 0 0" stretch="false" direction="south" />
</style> 
```

使用 Synth L&F，您将需要完全定义您的 UI 组件的外观，您无法做到这一点。

但是，如果您只需要简单地使用默认 L&F 修改颜色，您可以使用以下代码片段来初始化组合框的 UI：

```
final Color COLOR_BUTTON_BACKGROUND = Color.decode("#d3dedb");

UIManager.put("ComboBox.buttonBackground", COLOR_BUTTON_BACKGROUND);
UIManager.put("ComboBox.buttonShadow", COLOR_BUTTON_BACKGROUND);
UIManager.put("ComboBox.buttonDarkShadow", COLOR_BUTTON_BACKGROUND);
UIManager.put("ComboBox.buttonHighlight", COLOR_BUTTON_BACKGROUND); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T18:13:50.230

如果您不想创建完整的外观和感觉，最简单的答案是继承 jcombobox 并覆盖paintComponent 方法并绘制您想要的任何内容。

用灰色填充背景，然后用较浅的颜色绘制文本和箭头。

如果你走这条路，你可能还需要重写 updateUI 方法，这样如果 VM 尝试更新你的外观和感觉，你的组合框就不会回到错误的颜色。

# wpf - 有没有人有在 MVVM 模式下工作的 WPF Datagrid 的代码示例？

> ID：943618
> 
> 赞同：3
> 
> 时间：2009-06-03T08:20:34.190
> 
> 标签：wpf, data-binding, datagrid, mvvm

我得到了一个[WPF DataGrid](http://wpf.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=25047)绑定到 MVVM 模式中的 ViewModel 的以下示例，但它是只读的：

[MVVM 示例，它具有在 ViewModel 中切换数据的按钮](http://www.tanguay.info/web/index.php?pg=codeExamples&id=180)

我尝试对其进行扩展，以便将 DataGrid 绑定到*可观察的 ViewModel 集合，*以便编辑单元格会在适当的 ViewModel 上触发 OnPropertyChanged 事件，但无法使其按我想要的方式工作。

有谁知道这样做的代码示例，即将**DataGrid 绑定到具有 OnPropertyChanged 属性和委托命令**等的 ViewModel 集合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-07T18:16:34.513

Jaime Rodriguez 和 Karl Schifflett 正在进行 MVVM 培训路演。他们开发了一个演示应用程序（使用数据网格），也许您想查看该应用程序以及文档......

[http://blogs.msdn.com/jaimer/archive/2009/02/10/mv-vm-training-day-sample-application-and-decks.aspx](http://blogs.msdn.com/jaimer/archive/2009/02/10/m-v-vm-training-day-sample-application-and-decks.aspx)

# c# - C#/winforms：如何最好地绑定 propertygrid 和 System.Data.DataRow

> ID：943621
> 
> 赞同：8
> 
> 时间：2009-06-03T08:21:28.010
> 
> 标签：c#, winforms, binding, propertygrid, datarow

我有带有多个字段的 System.Data.DataRows，其中大多数只是普通类型，如 int、single、string。

使用 propertygrid 使它们可编辑的最佳方法是什么？无论数据行具有哪种类型的字段，它都应该自动工作，但不应显示所有字段。我想提供一个应该隐藏的属性列表。

由于 DataTable 是自动生成的，因此我无法添加 [Browsable(false)] 等自定义属性

多谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-03T08:48:15.663

编辑处理过滤；诡计多端：除了获取 之外`DataRowView`，我们还需要提供一个自定义组件，该组件（通过 pass-thru `PropetyDescriptor`s）`DataRowView`假装是（它本身假装是`DataRow`） - 并过滤掉我们不想要的属性。

非常有趣的问题 ;-p 在经典课程中更容易解决，但以下适用于`DataRow`;-p

请注意，您可以在此区域中执行其他操作以使某些属性不可编辑 ( `IsReadOnly`)，或者具有不同的标题 ( `DisplayName`) 或类别 ( `Category`) - 通过覆盖 中的其他成员`RowWrapperDescriptor`。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Windows.Forms;
static class program
{
    [STAThread]
    static void Main()
    {
        DataTable table = new DataTable();
        table.Columns.Add("ID", typeof(int));
        table.Columns.Add("Foo", typeof(int));
        table.Columns.Add("Bar", typeof(string));
        table.Columns.Add("Audit", typeof(DateTime));

        table.Rows.Add(1, 14, "abc", DateTime.MinValue);
        DataRow row = table.Rows.Add(2,13,"def", DateTime.MinValue);
        table.Rows.Add(3, 24, "ghi", DateTime.MinValue);

        RowWrapper wrapper = new RowWrapper(row);
        wrapper.Exclude.Add("ID");
        wrapper.Exclude.Add("Bar");

        Application.EnableVisualStyles();
        Application.Run(new Form {Controls = {
            new PropertyGrid { Dock = DockStyle.Fill,
                SelectedObject = wrapper}}});
    }
}

[TypeConverter(typeof(RowWrapper.RowWrapperConverter))]
class RowWrapper
{
    private readonly List<string> exclude = new List<string>();
    public List<string> Exclude { get { return exclude; } }
    private readonly DataRowView rowView;
    public RowWrapper(DataRow row)
    {
        DataView view = new DataView(row.Table);
        foreach (DataRowView tmp in view)
        {
            if (tmp.Row == row)
            {
                rowView = tmp;
                break;
            }
        }
    }
    static DataRowView GetRowView(object component)
    {
        return ((RowWrapper)component).rowView;
    }
    class RowWrapperConverter : TypeConverter
    {
        public override bool GetPropertiesSupported(ITypeDescriptorContext context)
        {
            return true;
        }
        public override PropertyDescriptorCollection GetProperties(
            ITypeDescriptorContext context, object value, Attribute[] attributes)
        {
            RowWrapper rw = (RowWrapper)value;
            PropertyDescriptorCollection props = TypeDescriptor.GetProperties(
                GetRowView(value), attributes);
            List<PropertyDescriptor> result = new List<PropertyDescriptor>(props.Count);
            foreach (PropertyDescriptor prop in props)
            {
                if (rw.Exclude.Contains(prop.Name)) continue;
                result.Add(new RowWrapperDescriptor(prop));
            }
            return new PropertyDescriptorCollection(result.ToArray());
        }
    }
    class RowWrapperDescriptor : PropertyDescriptor
    {
        static Attribute[] GetAttribs(AttributeCollection value)
        {
            if (value == null) return null;
            Attribute[] result = new Attribute[value.Count];
            value.CopyTo(result, 0);
            return result;
        }
        readonly PropertyDescriptor innerProp;
        public RowWrapperDescriptor(PropertyDescriptor innerProperty)
            : base(
                innerProperty.Name, GetAttribs(innerProperty.Attributes))
        {
            this.innerProp = innerProperty;
        }

        public override bool ShouldSerializeValue(object component)
        {
            return innerProp.ShouldSerializeValue(GetRowView(component));
        }
        public override void ResetValue(object component)
        {
            innerProp.ResetValue(GetRowView(component));
        }
        public override bool CanResetValue(object component)
        {
            return innerProp.CanResetValue(GetRowView(component));
        }
        public override void SetValue(object component, object value)
        {
            innerProp.SetValue(GetRowView(component), value);
        }
        public override object GetValue(object component)
        {
            return innerProp.GetValue(GetRowView(component));
        }
        public override Type PropertyType
        {
            get { return innerProp.PropertyType; }
        }
        public override Type ComponentType
        {
            get { return typeof(RowWrapper); }
        }
        public override bool IsReadOnly
        {
            get { return innerProp.IsReadOnly; }
        }
    }
} 
```

# c# - 如何将一系列数组元素克隆到新数组？

> ID：943635
> 
> 赞同：370
> 
> 时间：2009-06-03T08:26:07.783
> 
> 标签：c#, arrays, .net, clone, deep-copy

我有一个包含 10 个元素的数组 X。我想创建一个新数组，其中包含 X 中从索引 3 开始并以索引 7 结束的所有元素。当然，我可以轻松编写一个循环来为我做这件事，但我想让我的代码尽可能干净. C# 中有没有可以为我做的方法？

类似的东西（伪代码）：

```
Array NewArray = oldArray.createNewArrayFromRange(int BeginIndex , int EndIndex) 
```

**`Array.Copy`不符合我的需要**。我需要将新数组中的项目克隆。`Array.copy`只是 C 样式`memcpy`的等效项，这不是我要找的。

* * *

## 回答 #1

> 赞同：491
> 
> 时间：2009-06-03T08:32:22.107

您可以将其添加为扩展方法：

```
public static T[] SubArray<T>(this T[] data, int index, int length)
{
    T[] result = new T[length];
    Array.Copy(data, index, result, 0, length);
    return result;
}
static void Main()
{
    int[] data = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };
    int[] sub = data.SubArray(3, 4); // contains {3,4,5,6}
} 
```

* * *

更新重新克隆（在原始问题中并不明显）。如果你*真的*想要一个深度克隆；就像是：

```
public static T[] SubArrayDeepClone<T>(this T[] data, int index, int length)
{
    T[] arrCopy = new T[length];
    Array.Copy(data, index, arrCopy, 0, length);
    using (MemoryStream ms = new MemoryStream())
    {
        var bf = new BinaryFormatter();
        bf.Serialize(ms, arrCopy);
        ms.Position = 0;
        return (T[])bf.Deserialize(ms);
    }
} 
```

不过，这确实要求对象是可序列化的（`[Serializable]`或`ISerializable`）。您可以根据需要轻松替换任何其他序列化程序 - `XmlSerializer`, `DataContractSerializer`, protobuf-net 等。

请注意，如果没有序列化，深度克隆会很棘手；特别`ICloneable`是在大多数情况下很难信任。

* * *

## 回答 #2

> 赞同：339
> 
> 时间：2009-06-03T08:31:57.270

您可以[`Array.Copy(...)`](http://msdn.microsoft.com/en-us/library/z50k9bft.aspx)在创建新数组后使用它来复制它，但我认为没有一种方法可以创建新数组*并*复制一系列元素。

如果您使用的是 .NET 3.5，则*可以*使用 LINQ：

```
var newArray = array.Skip(3).Take(5).ToArray(); 
```

但这会有点效率低下。

有关更具体情况的选项，请参阅类似问题的[答案。](https://stackoverflow.com/questions/886488/copy-one-string-array-to-another/886498#886498)

* * *

## 回答 #3

> 赞同：76
> 
> 时间：2009-07-14T01:51:59.873

你考虑过使用`ArraySegment`吗？

[http://msdn.microsoft.com/en-us/library/1hsbd92d.aspx](http://msdn.microsoft.com/en-us/library/1hsbd92d.aspx)

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2009-07-07T14:28:42.657

我看到你想做克隆，而不仅仅是复制参考。在这种情况下，您可以使用`.Select`将数组成员投影到它们的克隆。例如，如果您的元素已实现`IClonable`，您可以执行以下操作：

```
var newArray = array.Skip(3).Take(5).Select(eachElement => eachElement.Clone()).ToArray(); 
```

注意：此解决方案需要 .NET Framework 3.5。

* * *

## 回答 #5

> 赞同：33
> 
> 时间：2011-12-19T12:34:48.923

以下代码在一行中完成：

```
// Source array
string[] Source = new string[] { "A", "B", "C", "D" };
// Extracting a slice into another array
string[] Slice = new List<string>(Source).GetRange(2, 2).ToArray(); 
```

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2019-01-25T16:41:53.153

在 C# 8 中，他们引入了一个新的`Range`和`Index`类型，可以这样使用：

```
int[] a = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };
Index i1 = 3;  // number 3 from beginning
Index i2 = ^4; // number 4 from end
var slice = a[i1..i2]; // { 3, 4, 5 } 
```

参考：

*   [https://docs.microsoft.com/en-us/dotnet/core/whats-new/dotnet-core-3-0#ranges-and-indices](https://docs.microsoft.com/en-us/dotnet/core/whats-new/dotnet-core-3-0#ranges-and-indices)
*   [https://devblogs.microsoft.com/dotnet/building-c-8-0/](https://devblogs.microsoft.com/dotnet/building-c-8-0/)

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2014-06-03T13:25:48.673

```
string[] arr = { "Parrot" , "Snake" ,"Rabbit" , "Dog" , "cat" };

arr = arr.ToList().GetRange(0, arr.Length -1).ToArray(); 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2009-06-03T08:37:12.923

你可以很容易地做到这一点；

[](http://ref.)

```
 object[] foo = new object[10];
    object[] bar = new object[7];   
    Array.Copy(foo, 3, bar, 0, 7); 
```

* * *

## 回答 #9

> 赞同：8
> 
> 时间：2009-07-08T16:11:20.420

基于 Marc 的回答，但添加了所需的克隆行为

```
public static T[] CloneSubArray<T>(this T[] data, int index, int length)
    where T : ICloneable
{
    T[] result = new T[length];
    for (int i = 0; i < length; i++)
    { 
        var original = data[index + i];
        if (original != null)
            result[i] = (T)original.Clone();            
    return result;
} 
```

如果实现 ICloneable 太像艰苦的工作，那么使用[Håvard Stranden 的 Copyable 库](http://ox.no/posts/extension-methods-for-copying-or-cloning-objects)来完成所需的繁重工作。

```
using OX.Copyable;

public static T[] DeepCopySubArray<T>(
    this T[] data, int index, int length)
{
    T[] result = new T[length];
    for (int i = 0; i < length; i++)
    { 
        var original = data[index + i];
        if (original != null)
            result[i] = (T)original.Copy();            
    return result;
} 
```

请注意，OX.Copyable 实现适用于以下任何一种：

> 但是，要使自动副本起作用，例如必须满足以下语句之一：
> 
> *   它的类型必须有一个无参数的构造函数，或者
> *   它必须是可复制的，或者
> *   它必须具有为其类型注册的 IInstanceProvider。

因此，这应该涵盖您遇到的几乎所有情况。如果您正在克隆对象，其中子图包含诸如数据库连接或文件/流句柄之类的内容，您显然会遇到问题，但对于任何通用深层副本都是如此。

如果您想使用其他一些深拷贝方法，[本文列出了其他几种](http://www.csharp411.com/c-object-clone-wars/)方法，因此我建议您不要尝试编写自己的方法。

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2009-06-03T08:36:48.947

我认为您正在寻找的代码是：

`Array.Copy(oldArray, 0, newArray, BeginIndex, EndIndex - BeginIndex)`

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-06-03T09:13:56.017

作为复制数据的替代方法，您可以制作一个包装器，使您可以访问原始数组的一部分，就好像它是数组部分的副本一样。优点是您不会在内存中获得数据的另一个副本，缺点是访问数据时会产生轻微的开销。

```
public class SubArray<T> : IEnumerable<T> {

   private T[] _original;
   private int _start;

   public SubArray(T[] original, int start, int len) {
      _original = original;
      _start = start;
      Length = len;
   }

   public T this[int index] {
      get {
         if (index < 0 || index >= Length) throw new IndexOutOfRangeException();
         return _original[_start + index];
      }
   }

   public int Length { get; private set; }

   public IEnumerator<T> GetEnumerator() {
      for (int i = 0; i < Length; i++) {
        yield return _original[_start + i];
      }
   }

   IEnumerator IEnumerable.GetEnumerator() {
      return GetEnumerator();
   }

} 
```

用法：

```
int[] original = { 1, 2, 3, 4, 5 };
SubArray<int> copy = new SubArray<int>(original, 2, 2);

Console.WriteLine(copy.Length); // shows: 2
Console.WriteLine(copy[0]); // shows: 3
foreach (int i in copy) Console.WriteLine(i); // shows 3 and 4 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2020-10-21T06:42:20.887

在 C# 8.0 中，您现在可以做许多更出色的工作，包括像 Python 中一样的反向索引和范围，例如：

```
int[] list = {1, 2, 3, 4, 5, 6};
var list2 = list[2..5].Clone() as int[]; // 3, 4, 5
var list3 = list[..5].Clone() as int[];  // 1, 2, 3, 4, 5
var list4 = list[^4..^0].Clone() as int[];  // reverse index 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-06-03T08:33:02.247

Array.ConstrainedCopy 将起作用。

```
public static void ConstrainedCopy (
    Array sourceArray,
    int sourceIndex,
    Array destinationArray,
    int destinationIndex,
    int length
) 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2020-05-06T17:41:44.620

它不符合您的克隆要求，但它似乎比许多答案更简单：

```
Array NewArray = new ArraySegment(oldArray,BeginIndex , int Count).ToArray(); 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-07-11T07:08:23.043

没有一种方法可以满足您的需求。您需要为数组中的类提供一个克隆方法。然后，如果 LINQ 是一个选项：

```
Foo[] newArray = oldArray.Skip(3).Take(5).Select(item => item.Clone()).ToArray();

class Foo
{
    public Foo Clone()
    {
        return (Foo)MemberwiseClone();
    }
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-07-13T20:15:40.600

如何使用[Array.ConstrainedCopy](http://msdn.microsoft.com/en-us/library/system.array.constrainedcopy.aspx)：

```
int[] ArrayOne = new int[8] {1,2,3,4,5,6,7,8};
int[] ArrayTwo = new int[5];
Array.ConstrainedCopy(ArrayOne, 3, ArrayTwo, 0, 7-3); 
```

* * *

### 下面是我的原帖。不起作用

您可以使用[Array.CopyTo](http://msdn.microsoft.com/en-us/library/06x742cw.aspx)：

```
int[] ArrayOne = new int[8] {1,2,3,4,5,6,7,8};
int[] ArrayTwo = new int[5];
ArrayOne.CopyTo(ArrayTwo,3); //starts copy at index=3 until it reaches end of
                             //either array 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-07-14T05:13:49.367

这个怎么样：

```
public T[] CloneCopy(T[] array, int startIndex, int endIndex) where T : ICloneable
{
    T[] retArray = new T[endIndex - startIndex];
    for (int i = startIndex; i < endIndex; i++)
    {
        array[i - startIndex] = array[i].Clone();
    }
    return retArray;

} 
```

然后，您需要在需要使用它的所有类上实现 ICloneable 接口，但应该这样做。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2010-01-31T22:23:54.470

我不确定它到底有多深，但是：

`MyArray.ToList<TSource>().GetRange(beginningIndex, endIndex).ToArray()`

这有点开销，但它可能会减少不必要的方法。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-07-12T09:03:03.113

克隆数组中的元素不是可以以通用方式完成的事情。您想要深度克隆还是所有成员的简单副本？

让我们采用“尽力而为”的方法：使用 ICloneable 接口或二进制序列化克隆对象：

```
public static class ArrayExtensions
{
  public static T[] SubArray<T>(this T[] array, int index, int length)
  {
    T[] result = new T[length];

    for (int i=index;i<length+index && i<array.Length;i++)
    {
       if (array[i] is ICloneable)
          result[i-index] = (T) ((ICloneable)array[i]).Clone();
       else
          result[i-index] = (T) CloneObject(array[i]);
    }

    return result;
  }

  private static object CloneObject(object obj)
  {
    BinaryFormatter formatter = new BinaryFormatter();

    using (MemoryStream stream = new MemoryStream())
    {
      formatter.Serialize(stream, obj);

      stream.Seek(0,SeekOrigin.Begin);

      return formatter.Deserialize(stream);
    }
  }
} 
```

这不是一个完美的解决方案，因为根本没有一个适用于任何类型的对象。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-07-12T22:35:07.183

就克隆而言，我认为序列化不会调用您的构造函数。如果您在 ctor 中做有趣的事情，这可能会破坏类不变量。

似乎更安全的选择是调用复制构造函数的虚拟克隆方法。

```
protected MyDerivedClass(MyDerivedClass myClass) 
{
  ...
}

public override MyBaseClass Clone()
{
  return new MyDerivedClass(this);
} 
```

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2015-07-08T15:24:52.653

您可以参加 Microsoft 制作的课程：

```
internal class Set<TElement>
{
    private int[] _buckets;
    private Slot[] _slots;
    private int _count;
    private int _freeList;
    private readonly IEqualityComparer<TElement> _comparer;

    public Set()
        : this(null)
    {
    }

    public Set(IEqualityComparer<TElement> comparer)
    {
        if (comparer == null)
            comparer = EqualityComparer<TElement>.Default;
        _comparer = comparer;
        _buckets = new int[7];
        _slots = new Slot[7];
        _freeList = -1;
    }

    public bool Add(TElement value)
    {
        return !Find(value, true);
    }

    public bool Contains(TElement value)
    {
        return Find(value, false);
    }

    public bool Remove(TElement value)
    {
        var hashCode = InternalGetHashCode(value);
        var index1 = hashCode % _buckets.Length;
        var index2 = -1;
        for (var index3 = _buckets[index1] - 1; index3 >= 0; index3 = _slots[index3].Next)
        {
            if (_slots[index3].HashCode == hashCode && _comparer.Equals(_slots[index3].Value, value))
            {
                if (index2 < 0)
                    _buckets[index1] = _slots[index3].Next + 1;
                else
                    _slots[index2].Next = _slots[index3].Next;
                _slots[index3].HashCode = -1;
                _slots[index3].Value = default(TElement);
                _slots[index3].Next = _freeList;
                _freeList = index3;
                return true;
            }
            index2 = index3;
        }
        return false;
    }

    private bool Find(TElement value, bool add)
    {
        var hashCode = InternalGetHashCode(value);
        for (var index = _buckets[hashCode % _buckets.Length] - 1; index >= 0; index = _slots[index].Next)
        {
            if (_slots[index].HashCode == hashCode && _comparer.Equals(_slots[index].Value, value))
                return true;
        }
        if (add)
        {
            int index1;
            if (_freeList >= 0)
            {
                index1 = _freeList;
                _freeList = _slots[index1].Next;
            }
            else
            {
                if (_count == _slots.Length)
                    Resize();
                index1 = _count;
                ++_count;
            }
            int index2 = hashCode % _buckets.Length;
            _slots[index1].HashCode = hashCode;
            _slots[index1].Value = value;
            _slots[index1].Next = _buckets[index2] - 1;
            _buckets[index2] = index1 + 1;
        }
        return false;
    }

    private void Resize()
    {
        var length = checked(_count * 2 + 1);
        var numArray = new int[length];
        var slotArray = new Slot[length];
        Array.Copy(_slots, 0, slotArray, 0, _count);
        for (var index1 = 0; index1 < _count; ++index1)
        {
            int index2 = slotArray[index1].HashCode % length;
            slotArray[index1].Next = numArray[index2] - 1;
            numArray[index2] = index1 + 1;
        }
        _buckets = numArray;
        _slots = slotArray;
    }

    internal int InternalGetHashCode(TElement value)
    {
        if (value != null)
            return _comparer.GetHashCode(value) & int.MaxValue;
        return 0;
    }

    internal struct Slot
    {
        internal int HashCode;
        internal TElement Value;
        internal int Next;
    }
} 
```

进而

```
public static T[] GetSub<T>(this T[] first, T[] second)
    {
        var items = IntersectIteratorWithIndex(first, second);
        if (!items.Any()) return new T[] { };

        var index = items.First().Item2;
        var length = first.Count() - index;
        var subArray = new T[length];
        Array.Copy(first, index, subArray, 0, length);
        return subArray;
    }

    private static IEnumerable<Tuple<T, Int32>> IntersectIteratorWithIndex<T>(IEnumerable<T> first, IEnumerable<T> second)
    {
        var firstList = first.ToList();
        var set = new Set<T>();
        foreach (var i in second)
            set.Add(i);
        foreach (var i in firstList)
        {
            if (set.Remove(i))
                yield return new Tuple<T, Int32>(i, firstList.IndexOf(i));
        }
    } 
```

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2017-05-09T08:01:35.210

我发现这是执行此操作的最佳方式：

```
private void GetSubArrayThroughArraySegment() {
  int[] array = { 10, 20, 30 };
  ArraySegment<int> segment = new ArraySegment<int>(array,  1, 2);
  Console.WriteLine("-- Array --");
  int[] original = segment.Array;
  foreach (int value in original)
  {
    Console.WriteLine(value);
  }
  Console.WriteLine("-- Offset --");
  Console.WriteLine(segment.Offset);
  Console.WriteLine("-- Count --");
  Console.WriteLine(segment.Count);

  Console.WriteLine("-- Range --");
  for (int i = segment.Offset; i <= segment.Count; i++)
  {
    Console.WriteLine(segment.Array[i]);
  }
} 
```

希望能帮助到你！

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2019-04-04T08:56:31.827

使用扩展方法：

```
public static T[] Slice<T>(this T[] source, int start, int end)
    {
        // Handles negative ends.
        if (end < 0)
        {
            end = source.Length + end;
        }
        int len = end - start;

        // Return new array.
        T[] res = new T[len];
        for (int i = 0; i < len; i++)
        {
            res[i] = source[i + start];
        }
        return res;
    } 
```

你可以使用它

```
var NewArray = OldArray.Slice(3,7); 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-01-06T20:00:13.977

System.Private.CoreLib.dll 中的代码：

```
public static T[] GetSubArray<T>(T[] array, Range range)
{
    if (array == null)
    {
        ThrowHelper.ThrowArgumentNullException(ExceptionArgument.array);
    }
    (int Offset, int Length) offsetAndLength = range.GetOffsetAndLength(array.Length);
    int item = offsetAndLength.Offset;
    int item2 = offsetAndLength.Length;
    if (default(T) != null || typeof(T[]) == array.GetType())
    {
        if (item2 == 0)
        {
            return Array.Empty<T>();
        }
        T[] array2 = new T[item2];
        Buffer.Memmove(ref Unsafe.As<byte, T>(ref array2.GetRawSzArrayData()), ref Unsafe.Add(ref Unsafe.As<byte, T>(ref array.GetRawSzArrayData()), item), (uint)item2);
        return array2;
    }
    T[] array3 = (T[])Array.CreateInstance(array.GetType().GetElementType(), item2);
    Array.Copy(array, item, array3, 0, item2);
    return array3;
} 
```

* * *

## 回答 #25

> 赞同：-1
> 
> 时间：2014-08-20T15:22:08.963

```
public   static   T[]   SubArray<T>(T[] data, int index, int length)
        {
            List<T> retVal = new List<T>();
            if (data == null || data.Length == 0)
                return retVal.ToArray();
            bool startRead = false;
            int count = 0;
            for (int i = 0; i < data.Length; i++)
            {
                if (i == index && !startRead)
                    startRead = true;
                if (startRead)
                {

                    retVal.Add(data[i]);
                    count++;

                    if (count == length)
                        break;
                }
            }
            return retVal.ToArray();
        } 
```

# cocoa - 我想为 700 MB 到 800 MB 图像大小分配内存

> ID：943647
> 
> 赞同：0
> 
> 时间：2009-06-03T08:32:06.367
> 
> 标签：cocoa

我正在尝试分配内存 NSI​​mage*originalLocationImage;

NSURL *fileURL = [NSURL fileURLWithPath:originalLocation]; //originalLocation 是我磁盘中的文件路径

originalLocationImage = [[NSImage alloc]initByReferencingURL:fileURL];

```
NSBitmapImageRep *sourceRep = [[NSBitmapImageRep alloc]initWithData:[SourceImage TIFFRepresentation]]  //this line fails to allocate memory 
```

大图像失败/

并抛出错误

```
malloc: *** mmap(size=268435456) failed (error code=12)
*** error: can't allocate region
*** set a breakpoint in malloc_error_break to debug 
```

对于小图像，它可以正常工作。

有什么帮助吗？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T09:54:14.187

使用 libjpeg 可能是一种选择，它似乎能够进行高达 16 的优化子缩放：http: [//jpegclub.org/djpeg/](http://jpegclub.org/djpeg/)。

libjpeg 是纯 C 语言，因此您可以从 Objective-C 中调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T08:43:42.410

我会质疑为什么您首先要将所有图像加载到内存中-肯定像平铺集一样处理它会是更好的选择吗？

您收到此消息是因为，虽然您可能有这么多可用内存，但您没有这么多*连续*可用内存

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T09:50:24.693

如果您想要的只是预览，您可以逐行阅读，每 n 行跳过一次，每行每 n 个像素跳过一次。您会留下一个（方式）较小的图像，如果需要，您可以通过更复杂的缩放算法，或者您可以将其保存为缩略图或其他任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T18:50:54.807

如果您只想创建图像的预览，CGImageSource 有专门用于此的 API。它们是第一个，不需要将整个图像读入内存。

# mingw - Windows 上的 Cython pyximport 错误

> ID：943658
> 
> 赞同：5
> 
> 时间：2009-06-03T08:34:40.790
> 
> 标签：mingw, cython

我正在使用 Cython 迈出第一步，并根据wiki 中的[说明](http://wiki.cython.org/InstallingOnWindows)将其安装在我的机器上。

通过 Cython 教程，我得到了[pyximport](http://docs.cython.org/docs/tutorial.html#pyximport-cython-compilation-the-easy-way)，它应该使 cython 编译变得非常简单。但是，当我尝试使用它时，我收到以下错误消息（重新格式化）：

```
ImportError: Building module failed: 
DistutilsPlatformError('
    Python was built with Visual Studio 2003;
    extensions must be built with a compiler than can generate compatible binaries.
    Visual Studio 2003 was not found on this system. If you have Cygwin installed,
    you can try compiling with MingW32, by passing "-c mingw32" to setup.py.',) 
```

所以我的问题是：有人知道让 pyximport 使用 mingw 的方法吗？

请注意，mingw 似乎已正确安装，制作 Cython 模块（使用 setup.py）的漫长方法*确实*为我工作，而且我什至创建了一个`distutils.cfg`wiki 告诉我的文件。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-03-26T23:16:04.237

我最近在闲逛，发现了 pyximport.install 的 setup_args 参数。这对我有用：

```
mingw_setup_args={'options': {'build_ext': {'compiler': 'mingw32'}}}
import pyximport; pyximport.install(setup_args=mingw_setup_args) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-11-04T23:42:13.220

[也许这样（来自邮件列表）](http://groups.google.com/group/cython-users/browse_thread/thread/f6b4dea016a984de)：

c:\Python2x\Lib\distutils\distutils.cfg：

```
[build]
compiler = mingw32

[build_ext]
compiler = mingw32 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-11-19T18:22:38.803

您还可以在您的主页下创建一个“ **pydistutils.cfg** ”文件，以便获得以下路径之一：“ **C:\Documents and Settings\YourUsername\pydistutils.cfg** ”或“ **C:\Users\YourUsername\pydistutils.cfg** ” .

然后加：

**[build_ext]**

**编译器=mingw32**

到那个文件。还要确保你的路径上有**"MinGW"**的 gcc。从那时起，当您使用“import pyximport; pyximport.install()”时，cython 应该在您的主文件夹下生成一个名为“.pyxbld”的文件夹（见上文）。在 Windows 上，此文件夹将包含由 cython 生成的所有“ **.c、.o、.pyd、.def** ”文件。

快乐的cythoning！

# xml - 如何定义允许未知（通配符）元素的 XSD 文件？

> ID：943659
> 
> 赞同：14
> 
> 时间：2009-06-03T08:34:48.827
> 
> 标签：xml, xsd

我收到一条带有未知变量名称元素的 XML 消息……也就是说，它们不是预定义的……

我只知道可以有 0 个或更多这些元素，以及其他一些强制性的......

例如

```
<root>
    <service>my service</service>
    <resource>my resource</resource>
    <action>update</action>
    <parameters>
      <field1>value1</field1>
      <field2>value2</field2>
      <field3>value3</field3>
    </parameters>
</root> 
```

也就是说，我不知道什么会作为“参数”传递，我只知道会有0个或更多的元素有一个值，不允许更深的标签嵌套....

我在想类似的东西

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

<xs:element name="root">
  <xs:complexType>
    <xs:sequence>
      <xs:element name="service" type="xs:string" minOccurs="1" maxOccurs="1" nillable="false"/>
      <xs:element name="resource" type="xs:string" minOccurs="1" maxOccurs="1" nillable="false"/>
      <xs:element name="action" type="xs:string" minOccurs="1" maxOccurs="1" nillable="false"/>
      <xs:element name="parameters">
        <xs:complexType>
          <xs:element name="*" maxOccurs="unbounded">
        </xs:complexType>
      </xs:element>
    </xs:sequence>
  </xs:complexType>
</xs:element>

</xs:schema> 
```

当然，困难的部分是

```
<xs:element name="*" maxOccurs="unbounded"> 
```

有可能做这样的事情吗？
如何定义验证此类消息的 XSD 文件？

--

我检查了 w3c 参考资料

[http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/datatypes.html#NCName](http://www.w3.org/TR/2004/REC-xmlschema-2-20041028/datatypes.html#NCName)

它说：

> NCName 的·词法空间·是所有字符串的集合，它们·匹配·[Namespaces in XML] 的NCName 产生。

那么这是什么意思呢？
此外...你能推荐我一些简单的方法来测试是否符合 XSD 定义吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-06T08:21:15.107

你想要的是一个通配符粒子，详情见 [http://www.w3.org/TR/xmlschema-1/#Wildcards](http://www.w3.org/TR/xmlschema-1/#Wildcards)

为此，您可以使用`xs:any`. 请注意，`xs:element`and`xs:any`不能直接放在`xs:complexType`. 您需要一个容器，例如 a`xs:sequence`或`xs:choice`。

处理通配符的有效模式如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">

  <xs:element name="root">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="service" type="xs:string"/>
        <xs:element name="resource" type="xs:string"/>
        <xs:element name="action" type="xs:string"/>
        <xs:element name="parameters">
          <xs:complexType>
            <xs:sequence maxOccurs="unbounded">
              <xs:any processContents="lax"/>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

</xs:schema> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T08:58:33.707

试试这个：

```
<xs:element name="parameters">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded">
          <xs:complexType>
            <xs:sequence>
              <xs:any processContents="lax"></xs:any>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element> 
```

# drupal - 我们如何为图像字段选择现有图像？

> ID：943661
> 
> 赞同：1
> 
> 时间：2009-06-03T08:35:18.420
> 
> 标签：drupal

我需要为图像字段选择现有图像而不是在 drupal6X 中新上传图像

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T15:57:22.760

[IMCE 模块](http://drupal.org/project/imce)允许您浏览服务器上的图像并选择它们以包含在您的撰写字段中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-01-12T19:48:55.260

还有[ImageField Assist](https://www.drupal.org/project/imagefield_assist)模块。插入已上传的图像就像单击图像按钮一样简单。关于它的一些细节（来自它的项目页面）：

> 该模块可以使用添加到 Drupal 6 网站中任何节点的每个 ImageField 字段，并使用 ImageCache 预设来显示它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-25T10:04:20.130

很晚了，但是……这是答案[IMCE Filefield](http://drupal.org/project/imce_filefield)

干杯！！！

# subsonic - 有没有办法强制刷新元模型，SubSonic 在数据库中的 DDL 更改后构建

> ID：943664
> 
> 赞同：0
> 
> 时间：2009-06-03T08:35:53.207
> 
> 标签：subsonic, metadata

例如，当我添加一个新表时，它不会出现在 Northwind 命名空间中，直到我从以下位置删除项目文件夹：C:\Users\userName\AppData\Local\Temp\Temporary ASP.NET Files\

或添加并读取 SubSonic.dll

我有以下配置：

```
 <configSections>
      <section name="SubSonicService" type="SubSonic.SubSonicSection, SubSonic"></section>

....

  <SubSonicService defaultProvider="Northwind">
    <providers>
      <clear/>
      <add name="Northwind" 
           type="SubSonic.SqlDataProvider, SubSonic" 
           connectionStringName="Northwind" 
           generatedNamespace="Northwind"/>
    </providers>
  </SubSonicService>

  <connectionStrings>
    <add name="Northwind" connectionString="Data Source=.;Database=Northwind;Integrated Security=true;"/>
  </connectionStrings>  

....
        <compilation debug="true">

          <buildProviders>
            <add extension=".abp" type="SubSonic.BuildProvider, SubSonic"/>

          </buildProviders>
...

      <pages>
        <controls>
                    <add assembly="SubSonic" namespace="SubSonic" tagPrefix="subsonic"/> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T18:02:52.887

这里的问题是除非您更改 App_Code 中的 abp 文件，否则 BuildProvider 不会“关闭”。这是一个 hack，但如果你想让它工作，你需要打开该文件并通过添加空格或其他东西以某种方式更改它 - 然后它将启动构建器。

我正在处理一些 T4 模板，因此您不必这样做。此外 - 您可以使用我们的命令行工具为您生成要归档的内容：http: [//subsonicproject.com/subcommander/using-the-command-line-tool-subcommander/](http://subsonicproject.com/subcommander/using-the-command-line-tool-subcommander/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-04T10:10:49.600

谢谢，两者都有效！

正如您所说，只需更改 *.abp 文件（添加了几个空格）

或者

sonic.exe 生成 /config "D:\path\to\my\web.config"

PS 我有一个 D:\temp\utils 文件夹，其中保存了所有使用的命令行工具......它是 %PATH% 环境变量的一部分......我花了几分钟才意识到我有复制整个：

D:\libs\orm\SubSonic_2.1_Final_Source\src\SubSonic\bin\Debug 目录到该命令行工具文件夹...

编辑：使用 VS 外部工具命令更快：工具 - 外部工具 - 添加标题：SubSonic 命令：D:\path\to\sonic.exe 参数：生成 /config "D:\path\to\my\web.config"初始目录：{$ProjectDir}

工具 - 选项 - 键盘 查找工具 亚音速

让它可以在命令行的任何地方工作

# svn - 如何在 SVN 中更新文件？

> ID：943665
> 
> 赞同：6
> 
> 时间：2009-06-03T08:36:12.567
> 
> 标签：svn

谁能告诉我更新 SVN 存储库中文件的命令。该文件已经导入，我只想修改更改。

该文件是`main.css`和文件路径`/home/weblab/public_html/cake_1_2/app/webroot/css`。

有人可以给我确切的命令吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T08:52:36.323

我猜您已经使用“svn import”将文件导入存储库。如果是这种情况，那么您在磁盘上的本地文件*不是*工作副本的一部分，您将无法“svn commit”它。

为了验证这一点，`svn info`请从您的代码所在的目录运行。如果它显示：`svn: '.' is not a working copy`，则您的当前目录不是工作副本。

然后你需要做的是：

1.  `svn checkout`您的项目从存储库到本地工作副本（临时目录）。
2.  将您的更改复制到工作副本上的现有文件
3.  `svn commit`这些变化。

完成此操作后，重命名原始项目位置（您现在工作的位置）并将工作副本移动到该位置。您现在可以`svn commit`像往常一样从您的工作副本中。

如果您现在使用的文件夹被称为：`/home/username/myproject`并且工作副本被称为`/tmp/workingcopy`. 然后你可以输入以下内容：

1.  `mv /home/username/myproject /home/username/myproject.old`
2.  `mv /tmp/workingcopy /home/username/myproject`

现在继续你的工作，如果你确定你的所有代码都在 svn 存储库中`/home/username/myproject`，你可以删除`myproject.old`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T08:41:34.723

有三种方法可以解释您的问题：

1.  您只有 subversion 存储库中的文件，并且您想修改其内容
2.  您在存储库和磁盘上都有该文件，尚未完成任何更改，并且您想在这两个地方修改其内容
3.  您在存储库和磁盘上都有该文件，磁盘上的文件包含更改，并且您希望使用这些更改更新存储库版本

如果是第一个，您需要先将文件签出到磁盘上的工作副本，然后继续进行案例 2。

如果是第二种，您需要使用更改来修改磁盘上的文件，然后转到案例 3。

如果是第三个，则需要将更改提交到存储库。

您可以使用您选择的 Subversion 客户端来执行此操作。如果这是命令行，典型的命令如下所示：

```
svn ci -m "Text that describes the changes that were done" 
```

但这里真正的问题是你不知道如何使用 Subversion。我会找到一个 Subversion 教程并使用它，创建一个临时存储库并将文件放入其中，使用 commit、checkout、revert、log 等命令来了解系统的工作原理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T08:37:30.957

svn ci 文件名

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T08:38:20.067

快速回答：使用“**提交**”

那么，哪个操作系统，哪个客户端？

如果在 Windows 上，TortoiseSVN 是最好的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-04T23:04:58.023

使用 Mac OS，并具有到 SVN 的 Url 链接。按照步骤

- 打开终端。

- 将目录更改为所需路径（例如：cd Desktop/）。

-类型命令：svn结帐网址

```
 $MacBook-Pro:~ worktpg$ svn checkout http://stackoverflow.com/questions/ 
```

- 如果出现提示，请输入用户名和密码并等待过程完成

-对于从终端更新 svn，cd 到路径并输入命令：svn update

# embedded - PIC I2C 从机确认数据

> ID：943669
> 
> 赞同：2
> 
> 时间：2009-06-03T08:37:10.023
> 
> 标签：embedded, pic, i2c

我正在研究 PIC16F88X 的 I2C 协议。我想做的是根据 I2C 上接收到的数据使 I2C 从机能够进行 ACK 或 NACK。

PIC 可以对在线发送的 I2C 地址进行 ACK 或 NACK，但从我读到的内容来看，它总是会在后续接收到的字节上进行 ACK。那是对的吗？

在以下通讯中：

```
Start - I2c_Addr+write/ACK - Register_value/Nack 
```

我希望从站能够根据寄存器`_`值中的值进行确认或确认。如果从机不了解寄存器`_`值，它不应该 Ack。

有人可以确认这是不可能的，还是告诉我该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-04T05:10:53.470

假设您使用 MSSP 外设

简短的回答：使用 PIC 可能无法实现您的要求，至少在 I/O 线路没有一点敲打的情况下。原因是在第 9 个时钟沿检查 ack/nack，直到第 9 个时钟结束才触发 SSPIF 中断。您可以尝试在数据字节移入 I/O 寄存器（第 8 个时钟）后立即重复检查 BF 位。如果您可以在第 9 个时钟周期之前进行比较并设置 SSPOV 位，这应该会产生 NACK，如果您有任何中断正在运行，这将是非常粗略的。

更长的答案：听起来您试图验证从站接收到的数据字节是否有效或不使用 ack。我个人不会这样做，ack 是为了表示线路的完整性，而不是验证数据的完整性。如果设备是从设备，则根据定义，主设备必须确切地知道它是如何工作的，并且可以在将字节推送到 I2C 线路之前检查字节的有效性。在这种情况下，我假设您还可以控制 I2C 主控代码，使用一个通用头文件来定义可以发送的所有命令或有效数据字节，以避免代码中的不匹配。

如果出于某种原因必须保证发送了正确的字节，请让主机向从机请求响应字节，让从机返回一个代码，指示先前传输的结果。

如果您的目的是保证 I2C 线路的完整性，那么这些方法都没有真正起作用。您唯一的选择是在启动时发送大量字节或定期使用 CRC 并检查它是否与从机匹配。通常 I2C 线要么工作要么不工作，它们速度低，通常走线短，允许的总线电容很高，如果它们不工作，你根本看不到任何 ack。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T01:06:42.160

如果 I2C 硬件内置在 PIC 中，我的猜测是没有。我使用过的所有硬件解决方案都有一个状态机，除非传输出现问题（例如丢失一点），否则它会不由自主地确认第二个字节。您最好在软件中使用 bit-banging 和用于 ACK 的开放式收集器缓冲区来实现自己的 I2C。然后你可以做任何你想做的事情。它不是 I2C 标准，因此请注意是否将任何不符合您的规格的设备放在总线上。我不确定，但我认为对于任何标准 I2C 设备，如果它没有收到 ACK，它可能会重新传输数据或只是故障，因为它不确定故障后谁控制了总线（由 NAK 表示）。

# jquery - jqGrid内联编辑问题

> ID：943672
> 
> 赞同：1
> 
> 时间：2009-06-03T08:37:41.720
> 
> 标签：jquery, jqgrid

我想使用 jqGrid 内联（行）编辑，但是如何在每一行之外放置“编辑”、“取消”、“保存”和“删除”按钮。

官方网站上有一个关于如何为内联（行）编辑放置“编辑”、“取消”和“保存”按钮的示例，我尝试放置删除按钮，但它不起作用。我该怎么做？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T09:22:49.003

```
 jQuery("#grid").jqGrid({
     ....
     colNames:[...,'Actions'],
     ....    
     colModel:[ .... , { 
        name: "actions", 
        classes:'jg_actions', 
        formatter: "actions", 
        editable: false, 
        sortable: false, 
        resizable: false, 
        fixed: true, 
        width:60, 
        formatoptions: {keys: true, delbutton:true}}
 ... 
```

这会将内联编辑按钮放在每行的末尾

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-06T08:02:14.677

你能显示不起作用的代码吗？

删除行的函数是[delGridRow](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3aform_editing#delgridrow) - 它的名称中有网格，与 editRow、saveRow、restoreRow 不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-28T05:45:16.783

请访问[http://www.trirand.com/jqgrid/jqgrid.html#](http://www.trirand.com/jqgrid/jqgrid.html#)检查每个链接，特别是实时数据操作和自定义编辑链接...

# validation - 确保用户名不是保留字的最佳方法？

> ID：943676
> 
> 赞同：4
> 
> 时间：2009-06-03T08:38:31.687
> 
> 标签：validation

假设我正在构建一个 Web 应用程序，其用户页面可以在[http://example.com/](http://example.com/)`NAME`找到。确保用户名不与保留字（例如“关于”、“联系人”等）冲突的最佳方法是什么？我可以想到两种方法：

*   在我的代码中的某处维护一个列表。这很好，但意味着如果我决定将“关于”页面更改为“关于我们”，我必须编辑另一段代码。
*   请求 URI（例如[http://example.com/someusername](http://example.com/someusername)）并检查它是否存在（不返回 404）。这感觉有点像 hack，但另一方面，它确实做了它应该做的事情。另一方面，如果不为其创建页面，我将无法保留任何东西。

解决此问题的最佳方法是什么？手动验证用户名不是一种选择。谢谢！

**编辑：**我忘了提，用户名*必须*放在根目录下，如下所示：

> [http://example.com/USERNAME](http://example.com/USERNAME)

不像这样：

> [http://example.com/users/USERNAME](http://example.com/users/USERNAME)

因此，我为什么要问这个问题。这是出于技术原因，不要问。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T08:44:16.700

我强烈建议使用类似的唯一路径`http://example.com/users/NAME`。否则，如果你想添加一个保留字，但用户已经把它作为他们的用户名，你会怎么做？您最终会遇到各种潜在的迁移问题。

或者，如果你必须有一些直接的东西，`http://example.com/`你可以给所有用户名加上前缀吗？所以那个用户`jerryjvl`会翻译成链接`http://example.com/user_jerryjvl`？

如果真的没有其他可能的解决方案，那么我会说要么根据任何数据源检查用户名来确定“保留字”是什么，或者在某个地方创建一个包含所有保留字的查找文件/表/结构。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T08:48:38.720

为了完整起见，如果您无法更改路由。另一种可能性是让您的用户路由和非用户路由具有编程区别。例如，如果您`'_'`在每个用户路由的末尾附加了 a，那么您可以确保用户位于：[http](http://example.com/NAME_) ://example.com/NAME_并且其他路由永远不会以`'_'`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T08:42:51.837

如何更改您的路由方案以使用户位于 example.com/users/NAME ？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-09-15T16:03:41.803

我在代码中维护保留字。这是我在[http://postbit.com/](http://postbit.com/)网站中用于检查用户名是否为保留字的 PERL 代码：

```
# Black list of logins and sub-domains reserved keywords
my @black_list = qw(
  about access account accounts add address adm admin administration
  adult advertising affiliate affiliates ajax analytics android anon
  anonymous api app apps archive atom auth authentication
  ...
);

my $username_normalized = lc($username);
   $username_normalized =~ s/\W//gs; # 'log-in' -> 'login'

for my $this_username (@black_list) {
  if ($username_normalized eq $this_username) {
    die("This username is already taken. Please choose other username.\n");
  }
} 
```

保留名称的完整列表（如 'css'、'images'、'js'、'admin'、'root'、'old'、'test'、'www'、'admin'、'login'、'devel '...) 有超过 300 个登录用户名发布在这里：

[http://blog.postbit.com/reserved-username-list.html](http://blog.postbit.com/reserved-username-list.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T08:42:12.837

你只知道这些“保留”的词是什么。所以最好维护一个列表并针对它进行验证。

另一种方法是，如果您使用 CMS，那么所有这些关键字“关于”、“联系人”等都将存在于您的数据库中。验证它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T08:44:02.363

不如先用所有保留字创建虚拟帐户？只需列出所有可能的并创建它们。

如果你使用

```
www.example.com/user/name 
```

那么就不会有问题了，但您似乎希望 URL 简短一些。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-03T08:52:19.820

文本框旁边的内容类似于：“请使用您的个人昵称或您的真实姓名。带有表明与站点管理关系的常用词的用户名可能会被撤销”。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-12T05:56:16.027

> 在我的代码中的某处维护一个列表。这很好，但意味着如果我决定将“关于”页面更改为“关于我们”，我必须编辑另一段代码。

您的菜单应存储在数组/列表中。这样你就只有 1 段代码可以编辑，而不是 2 段。=]

然后，由于所有菜单都在一个数组中，您可以将用户名与数组中的元素匹配。例如

```
$menu = array('About', 'Contact', 'Home')
if( in_array($username, $menu) ) {
  echo 'invalid username'
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-03T08:43:30.803

您可以随时查看[stackoverflow.com](http://stackoverflow.com)的工作原理。

# asp.net-mvc - asp.net MVC - 如何获取完整的本地和全局资源

> ID：943677
> 
> 赞同：2
> 
> 时间：2009-06-03T08:38:54.403
> 
> 标签：asp.net-mvc, resources

我正在本地化应用程序，需要为所有视图的应用程序的 JS 部分提供本地和全局资源的 JSON 表示。我目前的想法是我将实现 HtmlHelper 扩展方法，例如 GetLocalResourcesJSON/GetGlobalResourcesJSON，它应该编码所有资源键+值并将它们返回 JSON 编码为字符串（我也会实现缓存）。

目前，我能够从属于当前视图的全局或本地资源中检索单个特定键（使用 httpContext.GetGlobalResourceObject/GetLocalResourceObject），但我无法找出如何检索整个资源对象并迭代其所有键+价值观。有什么方法可以实现吗？

看起来 ResourceProviderFactory 可能是解决这个问题的关键，但它在任何地方都无法公开访问。我可以实例化 ResourceExpressionBuilder 并使用反射来使用 GetLocal/GlobalResourceProvider() 方法检索提供程序，但我根本不喜欢在这里使用反射......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-04T08:08:13.717

如果您可以获得 ResourceManager，您可以使用 GetResourceSet() 方法返回给定文化的所有本地化字符串。

App_GlobalResources 将被编译到“Resources”命名空间中，您可以在那里访问 ResourceManager（即 Resources.General.ResourceManager）。对于 App_LocalResources，这有点棘手，这也是我倾向于不使用 App_LocalResources 的原因之一。有关一种可能的解决方案，请参阅此 [post][1]。

```
<dl>
<% foreach (DictionaryEntry entry in Resources.Global.ResourceManager.GetResourceSet(CultureInfo.CurrentCulture, true, true)) { %>
  <dt><%= entry.Key %></dt>
  <dd><%= entry.Value %></dd>
<% } %>
</dl> 
```

回报：

```
<dl>
  <dt>SiteName</dt>
  <dd>The Site Name</dd>

  <dt>Copyright_Text</dt>
  <dd>Copyright 2009</dd>

  <dt>Copyright_Html</dt>
  <dd>Copyright &copy; 2009</dd>
</dl> 
```

[1]：[http](http://blog.mattweber.name/?p=39) ://blog.mattweber.name/?p= 39 “ASP.NET - 从 Resx 文件中获取值”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-05-30T08:51:44.317

目前我使用这样的反射解决了它： var resourceManager = ResourceExpressionBuilder.GetLocalResourceProvider(virtualPath).CreateResourceManager(); 而不是使用 resourceManager.GetResourceSet() 遍历所有资源项。我不喜欢这种肮脏的解决方案；（

# java - 检测要在 JAVA 中插入/删除的 PKCS#11 令牌

> ID：943678
> 
> 赞同：1
> 
> 时间：2009-06-03T08:38:59.910
> 
> 标签：java, ssl, pkcs#11

我正在使用 PKCS#11 USB 设备来创建 SSLContext。该项目正在从 IAIK jce 实现迁移到 sun 的，iaik 提供了一个令牌管理器来检测令牌何时被删除、插入，无法找到通过 sun 实现执行此操作的方法。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-22T07:53:22.183

Sun PKCS#11 提供程序会创建一个 TokenPoller，它会尝试检测令牌的添加和删除。您也可以这样做。您可以使用传递用于创建提供程序的库路径的 PKCS11.getInstance() 方法获取对 PKCS11 对象的引用。不过要小心，因为库路径大小写必须相同（其非规范化）。对它调用 C_GetSlotList 传递一个空值。异常表示令牌删除。然而，重新插入并未反映在这一点上。

# iphone - 有没有办法查明应用程序是使用 Core Animation 还是 OpenGL ES？

> ID：943679
> 
> 赞同：0
> 
> 时间：2009-06-03T08:39:17.507
> 
> 标签：iphone

我对 ConvertBot 背后的技术非常感兴趣。我尝试用 Core Animation 做很多事情，但我在那里看到的对于 Core Animation 来说似乎太快了。

我试图用 Instruments 打开它，但它不适用于 3rd-party 应用程序。有什么合法的方法可以找出引擎盖下的东西吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T17:30:58.253

我还建议只问tapbots的人。但是，如果您只是好奇（并且不耐烦），您可以随时查看可执行文件。

您可以在“~/Music/iTunes/Mobile Applications/”中找到您 iPhone 的同步应用程序。'*.ipa' 文件实际上只是您可以重命名和解压缩的 zip 文件。您将在“有效负载”目录中找到应用程序包装器。

要查看可执行文件链接到哪些框架以使用命令行：

```
> otool -L MyApp/Payload/MyApp.app/MyApp 
```

如果输出中有一行像

```
/System/Library/Frameworks/OpenGLES.framework/OpenGLES (compatibility version 1.0.0, current version 1.0.0) 
```

他们可能正在使用 OpenGL。

您还可以查看链接的符号，以查看它们正在使用哪些功能：

```
> nm -u MyApp/Payload/MyApp.app/MyApp

...
_glColorPointer
_glDrawArrays
_glEnable
_glVertexPointer
_glViewport
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T10:27:35.697

我会冒险猜测 ConvertBot 正在使用 CA。它在做什么让你不这么认为？

顺便说一句，这是一个完整的猜测。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T12:33:48.500

为什么不写下来问问呢？他们在博客[文章和](http://tapbots.com/blog/design/designing-convertbot)[Mobile Orchard 播客](http://www.mobileorchard.com/category/podcast/)上的采访中对他们的设计过程非常开放。通过查看应用程序，他们所做的一切都无法通过 Core Animation 完成并达到他们所看到的性能水平。我不知道你在用 Core Animation 做什么，但我对它在我的应用程序中的功能印象深刻。

奇怪的是，您无法将 Instruments 附加到 iPhone 上正在运行的应用程序上，就像在 Mac 上附加任意应用程序一样。Instruments 基于 DTrace，因此它应该挂接到任何正在运行的进程中，但 DRM 可能会阻止 iPhone 上的这种情况。

# c# - 应用程序关闭时关闭另一个进程

> ID：943681
> 
> 赞同：4
> 
> 时间：2009-06-03T08:40:00.593
> 
> 标签：c#, winforms

我有一个 C# winform 应用程序，它在工作期间会打开另一个 Winform 进程。另一个进程有自己的 UI。当我关闭父应用程序时，我希望自动关闭另一个应用程序。

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T08:45:40.520

如果你正在使用`Process.Process`那里的`CloseMainWindow`方法。如果您保留对该对象的引用，则可以稍后使用它。

[这是MSDN](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.close(VS.71).aspx "进程.关闭（）")中的相关页面

和相关代码：

```
// Close process by sending a close message to its main window.
myProcess.CloseMainWindow();
// Free resources associated with process.
myProcess.Close(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T08:58:25.643

有几种不同的选择。我建议您让您的应用程序跟踪它启动的进程：

```
private Stack<Process> _startedProcesses = new Stack<Process>();
private void StartChildProcess(string fileName)
{
    Process newProcess = new Process();
    newProcess.StartInfo = new ProcessStartInfo(fileName); ;
    newProcess.Start();    
    _startedProcesses.Push(newProcess);
} 
```

当应用程序关闭时，您可以调用一个方法来关闭所有已启动且仍在运行的子进程。您可以通过 Kill 方法或调用 CloseMainWindow 和 Close 方法来使用它。CloseMainWindow/Close 将执行更优雅的关闭（如果您启动记事本并且有未保存的更改，Kill 将丢失它们，CloseMainWindow/Close 将使记事本询问您是否要保存）：

```
private void CloseStartedProcesses()
{
    while (_startedProcesses.Count > 0)
    {
        Process process = _startedProcesses.Pop();
        if (process != null && !process.HasExited)
        {
            process.CloseMainWindow();
            process.Close();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T08:48:20.297

最优雅的方法可能是向另一个进程的主进程发送一个窗口消息。您可以简单地使用属性获取此主窗体的句柄`Process.MainWindow.Handle`（我假设您正在使用`Process`该类，然后只需使用`PostMessage`Win API 调用将具有自定义 ID 的消息发送到此“子”进程的主窗口。然后, 另一个进程的消息循环可以很容易地检测到这个消息（通过覆盖该`WndProc`方法）并相应地执行适当的关闭。另一种方法是发送标准`WM_CLOSE`方法，这意味着您只需从处理程序中卸载应用程序事件`Form.Closed`，但可能允许您较少控制（在某些情况下是否取消关闭）。

# silverlight - Silverlight 数据绑定以定位 UIElements

> ID：943684
> 
> 赞同：0
> 
> 时间：2009-06-03T08:40:09.360
> 
> 标签：silverlight, data-binding, find, uielement, uielementcollection

是否可以`UIElement`通过以某种方式检查数据绑定以查找被绑定的业务对象，从而在 Silverlight 中定位可视化树。我想要做的是使用 lambda 表达式（或任何其他方式）从被绑定的元素中定位元素，例如：

```
var uielements = FindAllUIElements ( (businessObject)=> { businessObject.Firstname; } ); 
```

谁能指出我正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-10T08:04:17.910

与 microsoft Hammids 的人交谈的建议是：遍历可视化树并调用`FrameworkElement.GetBindingExpression(DP)`该元素上的所有 DP。生成的`BindingExpression`类有一个名为的属性`DataItem`，您可以使用它来查看您是否对该绑定感兴趣。

# datetime - 流利的 NHibernate 复合键与日期

> ID：943694
> 
> 赞同：3
> 
> 时间：2009-06-03T08:43:21.460
> 
> 标签：datetime, fluent-nhibernate, key, composite

我是 NHibernate 的新手，遇到一个简单但顽固的错误时遇到了困难。

我的数据库（MSSQL2008）中有一个表，其中复合键由 2 个日期列组成。

这些将代表一个时间段 StartDate 和 EndDate 对于我的解决方案而言是唯一的。

表定义如下：

CREATE TABLE [dbo].[CompositeKeyTab]( [KeyCol1] [date] NOT NULL, [KeyCol2] [date] NOT NULL, [Value] [decimal](18, 0) NULL, CONSTRAINT [PK_CompositeKeyTab] PRIMARY KEY CLUSTERED ( [ KeyCol1] ASC, [KeyCol2] ASC )WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY] ) ON [PRIMARY]

在我的域模型中，我有一个相应的实体：

```
public class CompositeKeyEnt
{
    public virtual DateTime KeyCol1 { get; set; }
    public virtual DateTime KeyCol2 { get; set; }
    public virtual decimal Val { get; set; }

    public override bool Equals(object obj)
    {
        var compareTo = obj as FinancialDay;
        if (compareTo == null)
            return false;
        return this.GetHashCode() == compareTo.GetHashCode();
    }
    public override int GetHashCode()
    {
        return this.KeyCol1.GetHashCode() ^ this.KeyCol2.GetHashCode();
    }
} 
```

在我的映射程序集中有一张地图：

```
public class CompositeKeyEntMap: ClassMap<CompositeKeyEnt>
{
    public CompositeKeyEntMap()
    {
        WithTable("CompositeKeyTab");
        UseCompositeId().WithKeyProperty(e => e.KeyCol1, "KeyCol1").WithKeyProperty(e => e.KeyCol2, "KeyCol2");
        Map(e => e.Val, "Value");
    }    
} 
```

一切编译正常。但是当我尝试将我的类的一个实例持久化到数据库时（就像这样）

```
 CompositeKeyEnt cke = new CompositeKeyEnt() { KeyCol1 = DateTime.Now.AddDays(1), KeyCol2=DateTime.Now.AddDays(1), Val = 2.2M };
        CompositeKeyEnt cke1 = new CompositeKeyEnt() { KeyCol1 = DateTime.Now, KeyCol2 = DateTime.Now, Val = 1.1M };
        Repository<CompositeKeyEnt> crep = new Repository<CompositeKeyEnt>();
        crep.SaveOrUpdate(cke);
        crep.SaveOrUpdate(cke1); 
```

我得到：

“意外的行数：0；预期：1”

在会话上调用 Flush() 时。

```
 public virtual T SaveOrUpdate(T entity)
    {
        using (var context = Session)
        {
            context.SaveOrUpdate(entity);
            context.Flush(); //Exception raised here!!!
        }
        return entity;
    } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-11T17:20:51.740

我认为问题在于 NHibernate 不知道复合键的未保存值是什么，因此当您调用 SaveOrUpdate() 时它会尝试发出更新而不是插入。我认为您不可能为此类拥有有效的未保存值，因此我建议您修改存储库以分别实现 Save() 和 Update() 并调用适当的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-15T10:40:16.420

我遇到了同样的问题，我发现如果要向数据库中添加新项目，则需要调用 Save()，如果要更新项目，则需要调用 Update()。

出于某种原因，调用 SaveOrUpdate() 似乎存在错误。

希望这可以帮助

# perl - 为什么我的 Perl/Tk Scrolled 实际上不滚动？

> ID：943699
> 
> 赞同：2
> 
> 时间：2009-06-03T08:44:05.967
> 
> 标签：perl, tk

下面的代码几乎可以产生我想要的东西，但是左侧的可滚动窗格不会滚动。我正在使用 ActivePerl 5.8.9 Build 825：

代码是：

```
use Tk;
use Tk::Pane;
use Tk::LabFrame;

# create the application window
my $MW = MainWindow->new ( -background => "GREY" );

# set the x/y size for the window
$MW->geometry("800x600");

# add a window title
$MW->title("Monitor Boxes");

# Disallow window resizing
$MW->resizable(0,0);

# create a labelled frame on the window to house the list of buttons to be pressed
$boxListFrame = &create_framed_section( "List Of Boxes", 
                    "acrosstop", 
                    5, 
                    5, 
                    170, 
                    565,
                    "BLUE", 
                    "GREY");

# create a labelled frame on the window to house the information to be displayed 
# when a particular button is pressed
$statusOfBoxFrame = &create_framed_section( "Status", 
                        "acrosstop", 
                        185, 
                        5, 
                        600, 
                        565, 
                        "BLUE", 
                        "GREY");

# create a scrollable pane in the left hand pane so that if more buttons than 
# is able to be displayed are put onto the application the scroll bar will allow 
# the ones not displayed to be access
my $pane = $MW->Scrolled(   'Pane', 
                -scrollbars => 'e', 
                -width => 140, 
                -height => 555, 
                -background => "GREY")->place(-x=>15,-y=>25);

# setup the array of buttons
@boxes = ("BUTTON1", "BUTTON2", "BUTTON3", "BUTTON4", "BUTTON5", "BUTTON6", "BUTTON7", "BUTTON8", "BUTTON9", "BUTTON10", "BUTTON11", "BUTTON12", "BUTTON13", "BUTTON14", "BUTTON15", "BUTTON16");

# put the buttons onto the scrollable pane in the frame on the window (LOL)
DisplayCheckButtons( $pane, @boxes);

# wait until the user exits the app
MainLoop;

# exit the app
exit 0;

sub DisplayCheckButtons 
{
    my ( $parent, @names ) = @_;
    $Frame->destroy if $Frame;
    $Frame = $parent->Frame(    -width => 160, 
                    -height => 555, 
                    -background => "GREY")->place(-x=>15,-y=>15);

    $xpos = 5;
    $ypos = 5;

    foreach $box (@names)
    {
        $buttons->{$box} = $Frame->Button(-text => $box)->place(-x=>$xpos,-y=>$ypos);

        $ypos = $ypos + 40;

    }
}

sub create_framed_section
{
    # get the parameters
    my($label, $labelside, $posX, $posY, $width, $height, $fontColour, $backgroundColour) = @_;

    # create the item in the desired position with supplied information
    $frame = $MW->LabFrame( -label      => $label,
                -labelside  => $labelside,
                -width      => $width,
                -height     => $height,
                -foreground => $fontColour,
                -background => $backgroundColour,
                )->place(-x=>$posX,-y=>$posY);

    return $frame;
} 
```

我希望有人能指出我错过的小事，结束我的挫败感。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T13:33:47.553

你有两个问题。首先是您应该直接使用`Pane`小部件，而不是`Frame`在其中创建另一个小部件。另一个问题似乎是在小部件`place`内使用几何管理器`Pane`。尝试`pack`改用。

```
$buttons->{$box} = $parent->Button(-text => $box)->pack(-pady => 10); 
```

顺便说一句，请了解如何使用`strict`and`warnings`编译指示。它们在帮助您编写好代码方面非常宝贵。正如 Sinan 指出的那样，不要使用该`&foo()`符号来调用子例程。那是（非常）古老的语法。这不是必需的，并且可能有害。最后，我建议使用`pack`or`grid`而不是`place`Perl/Tk。通常更容易获得您想要的行为。仅`place`在需要绝对定位时使用。您甚至可以混合搭配几何管理器，只要它们管理不同的帧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T11:51:39.473

首先有一些观察：您的代码不是严格安全的，这使得调试更加困难。您也没有在任何小部件上调用 pack。调用 subs 时，不应在子名称前使用 & 符号，除非您知道它的效果并想要它们——有关详细信息，请参阅[perldoc perlsub](http://perldoc.perl.org/perlsub.html#DESCRIPTION)。

三个面板的宽度加起来有800多。你想要的布局不是那么清晰。

现在，这里有一些代码（[从 PerlMongers 偷来的](http://www.perlmonks.org/?node_id=321488)）创建了一个带有一堆按钮的可滚动窗格：

```
#!/usr/bin/perl

use strict;
use warnings;

use Tk;
use Tk::Pane;

my $top = MainWindow->new;
$top->Label(-text => "Enter the scroll frame")->pack;

my $frame = $top->Scrolled(
    'Frame',
    -scrollbars => "e",
)->pack;

$frame->Button(-text => "BUTTON $_")->pack for ( 1 .. 16 );

MainLoop; 
```

# c# - Asp.net C# 文件上传和访问交互

> ID：943709
> 
> 赞同：0
> 
> 时间：2009-06-03T08:46:41.047
> 
> 标签：c#, ms-access, interop, file-upload

我正在构建一个需要与 Access 数据库交互的 webapp。Access 数据库大约有 200 兆，我不想上传整个内容……只是一张表的内容。到目前为止，我过去曾在桌面应用程序上使用过 Microsoft.Office.Interop.Access，但是当我在 Web 应用程序上尝试此操作时，Web 服务器上存在一些神秘的权限问题（我认为）需要找出来。

据我了解，我可以 1 - 上传整个数据库并选择数据 2 - 我可以使用互操作并找出权限问题

有 3 或 4 选项吗？

多谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T09:00:30.067

我不知道我是否理解您的问题，但也许您可以使用 CSV 文件上传表数据，然后解析每一行并使用 SQL 查询将这些数据插入 Access 数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T09:58:16.597

访问文件的位置无关紧要，只要它可以在本地或通过网络访问，并且网络服务器的 NETWORK 帐户（如果它是 Win2K3 或更高版本的服务器，否则它是 ASP.NET 帐户）可以访问该位置. 所以不需要下载或上传任何东西。此外......您的后端正在处理访问数据库的事实不应该是可见的或与客户有任何关系......

OTOH，如果您正在寻找“通过 Web 界面管理数据库”的解决方案，那么也许最好看一下这样的东西[......](http://sourceforge.net/projects/asp-ent-man/)（它适用于 sql server，但从访问到 sql server 的迁移并不是那么大一个问题 ;-）

如果您想自己编写代码，我认为[这篇](http://aspalliance.com/542)文章可以派上用场。无需互操作，只需使用带有正确连接字符串的 OleDbConnection。

# certificate - QA东西认证？为什么/在哪里/如何？

> ID：943711
> 
> 赞同：0
> 
> 时间：2009-06-03T08:47:03.793
> 
> 标签：certificate, qa

我们正在寻找方法来认证我们的 QA 部门。您可以推荐哪些课程/证书？

哪些 QA 证书受到尊重（在欧洲/全球范围内）？您是否通过了任何 QA 认证……值得付出努力/花钱吗？也许有一些您不推荐的证书？

任何其他有用的信息表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-19T10:55:23.973

我所知道的与欧洲最相关的 QA 证书是 ISO9001（适用于公司而不是 QA 团队）。

根据我的经验和与朋友的交谈，当一家公司想要获得这种证书时，有几个目标：

1.  在营销层面，能够贴上这个“标签”可能会很好
2.  一些客户可能需要这种证书才能与您签约
3.  你真的想改善你的问答

很多公司只关注前两点，基本上问答团队编写了团队需要在权威审计前几天学习的程序......一旦他们获得了证书，他们就忘记了:-(

如果你对前两点不感兴趣，另一种方法是获得这些认证的精神，并尝试在公司中一点一点地介绍它。重点是写程序。如果您在一家小公司，这非常重要。事实上，如果一些重要的人变得不可用（离开公司，长时间生病），那么您应该能够使用这些程序来替换他们。从我的角度来看，另一个重要的观点是程序应该与应用程序的人一起编写。不要试图强迫人们（特别是开发人员:-)）遵循他们不同意的程序。

希望我确实很好地理解了您的问题并且对您有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-25T20:18:19.723

如果您希望获得这些工具的认证，则有针对 winrunner、qtp、testdirector 等的水星 (HP) 认证，如果您使用这些工具，这些认证是有价值的。

如果您正在寻找与 QA 相关的认证，有 SQA、CSQA 认证，您可以在[http://www.softwarecertifications.org](http://www.softwarecertifications.org)上找到更多信息。

如果您真的想了解 QA 和测试领域正在发生的事情，那么由不同组织主办的会议和研讨会以及有时由水星主办的会议和研讨会可能非常有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-04T00:02:02.033

对于一般测试员/QA 认证，请尝试 ISEB 或 ISTQB（我会选择 ISTQB）。您也可以尝试 TMap（尤其是 TMapNext），但这会更难。要获得专业认证，请尝试 HP 或 IBM 的课程。

# asp.net-mvc - 带有 asp.net mvc 应用程序的 WCF 服务

> ID：943712
> 
> 赞同：35
> 
> 时间：2009-06-03T08:47:58.050
> 
> 标签：asp.net-mvc, wcf

我已经开始使用 asp.net MVC，并且作为传统方式，我想将我的数据访问层保留在 WCF 服务中。如何使用 asp.net MVC 实现这一点？

设想

我在 asp.net MVC 中启动了一个测试应用程序，它显示、插入和编辑数据。我通过添加“ADO.Net 实体数据模型”成功地创建了它。

所以现在如果我想在 WCF 服务中移动这个数据访问层，即使用 GetData()、UpdateData()、CreateNewData() 等方法的 WCF 服务，我该如何实现呢？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-06-03T10:57:26.447

简短的回答：

您只需将数据访问层移动到 WCF 服务中，将其公开，然后从 MVC 应用程序中调用它。

长答案：

1) 我建议阅读 Scott Guthrie 的[Nerd Dinner](http://weblogs.asp.net/scottgu/archive/2009/04/28/free-asp-net-mvc-nerddinner-tutorial-now-in-html.aspx)演练，以真正了解 MVC 基础知识。

2) 以下博客介绍了使用 WCF 服务编写分层 ASP.NET MVC 应用程序的过程（第 III 和 IV 部分特别关注 WCF 和 MVC 交互）：

*   [第一部分](http://sankarsan.wordpress.com/2009/04/12/a-layered-aspnet-mvc-application-part-i/)（一般概念）
*   [第二部分](http://sankarsan.wordpress.com/2009/04/12/a-layered-aspnet-mvc-application-part-ii/)（构建存储库）
*   [第三部分](http://sankarsan.wordpress.com/2009/04/12/a-layered-aspnet-mvc-application-part-iii/)（构建服务）
*   [第四部分](http://sankarsan.wordpress.com/2009/04/12/a-layered-aspnet-mvc-application-part-iv/)（使用服务）

我没有详细阅读链接的文章（只是略读了一下），但它们似乎对这个过程给出了一个不错的概述。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-11-22T06:55:36.267

**带有 Wcf 服务的 Asp.net MVC 应用程序** [http://patilranjeet.blogspot.in/2014/11/aspnet-mvc-with-wcf-sample.html](http://patilranjeet.blogspot.in/2014/11/aspnet-mvc-with-wcf-sample.html)

# iis - c++ webservice 与 Mozilla Firefox 浏览器有问题

> ID：943719
> 
> 赞同：0
> 
> 时间：2009-06-03T08:50:59.853
> 
> 标签：iis

关于问题：- 我们有一个用 c++ 编写的 web 服务。我们在 HTML 页面中使用 cgi 脚本来运行我们自己的 exe，它将输出 HTML。使用 IE，我没有看到任何问题。但是对于 Mozilla FireFox 3.0，出现错误显示为

“您已选择打开 gefebt.exe，它是一个：来自 http:\3.212.219.180\test 的应用程序您要保存此文件吗”

我也做了一些调查：- 我使用 IIS 创建了一个虚拟目录，当我单击超链接时，我已经让 gefebt.exe 执行。使用 IIS 没有问题，直到 Execute Permissions 设置为 "Scripts and Executables" 。如果我选择脚本，我可以在 IE 和 mozilla 插件中看到相同的消息。

同时我看不出与 Webservice 的代码有任何区别。我们在 HTML 中引用可执行文件的方式是 href=gefebt.exe?xyz.bcl>Invoke xyz.bcl - 我也尝试过使用 IFrames 和 frames 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T08:53:13.030

看起来您发送了错误的 http 标头。尝试添加`Content-type: text/html`

# mysql - MySQL - my.cnf 中的跳过锁定有什么作用？

> ID：943723
> 
> 赞同：28
> 
> 时间：2009-06-03T08:52:30.380
> 
> 标签：mysql

我在 RHEL5 上使用 MySQL 5.0.67，并将我的配置基于 my-huge.cnf。

我在 MySQL 手册中找不到配置文件中出现的“skip-locking”行的任何内容。

应该将其替换为“skip_external_locking”还是我应该完全删除该行，因为这现在是默认设置。

[MySQL 跳过外部锁定手册](http://dev.mysql.com/doc/refman/5.0/en/server-options.html#option_mysqld_skip-external-locking)

谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-06-03T09:02:59.097

见[http://dev.mysql.com/doc/refman/5.0/en/external-locking.html](http://dev.mysql.com/doc/refman/5.0/en/external-locking.html)

引用：

> 如果您运行使用相同数据库目录的多台服务器（不推荐），则每台服务器都必须启用外部锁定。

它实际上只是与访问相同数据的多个进程所带来的危险有关。在许多 DBMS 情况下，您希望在执行操作之前锁定表/行，然后再解锁。这是为了防止可能的数据损坏。

编辑： 见[http://dev.mysql.com/doc/refman/4.1/en/news-4-0-3.html](http://dev.mysql.com/doc/refman/4.1/en/news-4-0-3.html)

> 将 --skip-locking 重命名为 --skip-external-locking。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-13T08:12:36.540

对于不遵循@Jonathan Fingland 提供的链接的任何人的附加说明：
[8.7.4。外部锁定](http://dev.mysql.com/doc/refman/5.0/en/external-locking.html)

此选项仅适用于 MyISAM 表。

正如 Richard 指出的那样，默认情况下禁用外部锁定。如果您`myisamchk`用于写操作或`myisampack`用于打包表，则需要启用外部锁定。

从文档：

> If you use myisamchk to perform table maintenance operations on MyISAM tables, you must either ensure that the server is not running, or that the server has external locking enabled so that it locks table files as necessary to coordinate with myisamchk for access to the tables. The same is true for use of myisampack to pack MyISAM tables.
> 
> If you use myisamchk for write operations such as repairing or optimizing tables, or if you use myisampack to pack tables, you must always ensure that the mysqld server is not using the table. If you don't stop mysqld, you should at least do a mysqladmin flush-tables before you run myisamchk. Your tables may become corrupted if the server and myisamchk access the tables simultaneously.

# ms-word - 哪些工具可用于文件的字节级检查？

> ID：943725
> 
> 赞同：1
> 
> 时间：2009-06-03T08:52:35.247
> 
> 标签：ms-word, binary, binaryfiles, file-recovery

我有一个部分损坏的 MS-Word 文件，我想在字节级别进行检查。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T08:56:54.367

[HexEdit](http://www.physics.ohio-state.edu/~prewett/hexedit/)非常好（也允许你编辑文件）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T08:55:15.133

我喜欢这种任务的免费十六进制编辑器[xvi32](http://www.chmaas.handshake.de/delphi/freeware/xvi32/xvi32.htm)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-03T08:56:20.357

你需要的是一个十六进制编辑器。一些文本编辑器可以在这种模式下运行。我一直为此使用[PSPad](http://pspad.com)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T08:57:23.023

与 emacs 一样，[hexl-mode](http://www.phys.ufl.edu/docs/emacs/emacs_422.html)允许您查看和编辑 hex 文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T08:54:04.760

我敢肯定有很多，但[Ultraedit 会这样做](http://www.ultraedit.com/)。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T08:55:49.610

如果您安装了 Visual Studio，您可以将 .dat 扩展名添加到文件并在 Visual Studio 中打开它以获得十六进制/ASCII 显示。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-18T20:00:36.043

[010 Editor](http://www.sweetscape.com/010editor/)非常适合查看遵循某些模板的文件，它会尝试将原始数据转换为对您有意义的标记值。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-18T20:16:42.377

看看[BeyondCompare](http://www.scootersoftware.com)以进行文件比较；版本 3 也对 Word 文件进行了比较。一旦拥有它，您会惊讶于使用它的频率。

# java - 如何使用 HTML 标记向 JSP 页面显示以字节为单位的图像？

> ID：943729
> 
> 赞同：4
> 
> 时间：2009-06-03T08:53:23.000
> 
> 标签：java, html, jsp, image

我有 ByteArrayOutputStream，其中包含以字节为单位的 JPEG 图像。我的要求是在[JSP](http://en.wikipedia.org/wiki/JavaServer_Pages)页面中显示该图像（使用 HTML 标记在前端显示图像）。我怎么做？

我已经推荐了这`BufferedImage`门课，但这对我来说很困惑，因为我是新手。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-03T08:59:46.293

如果图像不是太大，你可以这样做。

```
<img src="data:image/jpg;base64,iVBORw0KGgoAAAANS..." /> 
```

其中`iVBORw0KGgoAAAANS`... 是[Base64](http://en.wikipedia.org/wiki/Base64)编码的字节。

Base64 编码可以使用库完成，例如[Ostermiller Java Utilities 的*Base64 Java 库*](http://ostermiller.org/utils/Base64.html)或*[org.apache.commons.codec.binary.Base64](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html)*。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T08:58:19.887

除非您使用[“数据”URI](http://en.wikipedia.org/wiki/Data_URI_scheme)（对小图像有用），否则浏览器将发出两个请求：一个请求 HTML，另一个请求图像。您需要能够输出`img`包含足够信息的标签，以便您使用`ByteArrayOutputStream`.

根据您获取该 JPEG 文件的方式以及服务器的横向扩展方式，这可能涉及将图像写入磁盘、将其缓存在内存中、重新生成它或这些的任意组合。

如果您可以延迟图像生成，直到浏览器首先请求实际图像，那是非常理想的。这可能涉及在图像的 URL 中添加额外的参数 - 例如图形上的点，或要生成的缩略图的大小，或任何图像。

如果您对 JSP 和 HTML 都不熟悉，我强烈建议您首先专注于 HTML 方面。在确定如何动态提供服务之前，先确定您需要提供什么服务以及浏览器会做什么。从 HTML 和图像的静态页面和文件开始，然后研究如何生成它们。

# database-design - 数据库设计：定义数据库中实体之间的关系

> ID：943730
> 
> 赞同：1
> 
> 时间：2009-06-03T08:53:54.823
> 
> 标签：database-design

我想为我的应用程序设计一个数据库，我对定义实体之间关系的方式有疑问。

我有 2 个相关实体，其 ID 是复合的。例如：

*   由属性 [街道号码、门牌号码、城市、国家/地区] 和电话号码 (xx-yyyyyy) 标识的地址实体
*   由属性 [区域编号，编号] 标识的实体。

关系是“每个地址都有几个电话号码。我有两种可能的方法来定义表格：

1.  由所有 ID 字段连接的表
    *   地址→[街道号码、门牌号码、城市、国家、...、地区号码、号码]
    *   PhoneNumber → [地区号码，号码，...]
2.  具有由该字段连接的 ID 字段 (GUID) 的表。
    *   地址 → [身份证、门牌号、门牌号、城市、国家、...、]
    *   PhoneNumber → [ID, 地区号码, 号码, ..., AddressID]

在第一个解决方案中，主键将是标识实体的所有字段，而在第二个解决方案中，主键将只是 ID 字段。

我的问题是-更好的方法是什么？（按性能、维护、设计等...）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T09:48:23.153

无论您是否拥有**G** UID，第二个选项都更易于编码和设计。当您通过连接两个表来选择数据时，您只需要索引标识符列。另一种方式，您需要复合索引来进行此连接。

根据我的经验，在企业公司系统的表中拥有唯一的主键是一种宝贵的实践。（从 dba 和开发人员的角度来看）

为性能设计数据库是一个复杂的问题，涉及许多标准。如果您手头有 Oracle，请在实践中使用您的两种方法并使用解释计划工具，而不是追求理论。我的意思是使用您提到的方法创建表，使用索引并使用解释计划。如果我没记错的话，Oracle 甚至可以通过投影（即让您估计表中的行数）为您提供有关查询性能的想法。我不确定 Express Edition 版本是否有此支持

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T09:05:41.633

主键*永远不会*是“表中的所有字段”。这不是关系数据库应该如何工作的，所以忘记这种方法。

密钥就是密钥，数据就是数据。永远不要把两者混为一谈。如果混合使用它们，最终会出现这样一种情况，即您需要在数据更改后立即更改密钥和数据库中使用它的所有记录。哪个不好。

设计这种（常见的）1:n 关系的唯一正确方法是：

```
地址电话号码
-------- -----------
 *ID <---+ *ID
 StreetNumber +--- 地址ID
 门牌号 地区号
 城市 TheNumber
 国家 ...
 ...

```

表示主`*`键，通常是一个带有唯一索引的自动递增数字。

箭头表示外键关系。

# xml - XSLT 分组兄弟

> ID：943739
> 
> 赞同：6
> 
> 时间：2009-06-03T08:56:11.560
> 
> 标签：xml, xslt

我正在尝试将同级数据分组到 XML 文件中。

给定：

```
<?xml version="1.0" encoding="UTF-8"?>
<data>
    <competition>
        <timeline>10:00</timeline>
        <fixture>team a v team b</fixture>
        <fixture>team c v team d</fixture>
        <timeline>12:00</timeline>
        <fixture>team e v team f</fixture>
        <timeline>16:00</timeline>
        <fixture>team g v team h</fixture>
        <fixture>team i v team j</fixture>
        <fixture>team k v team l</fixture>
    </competition>
</data> 
```

我正在尝试制作：

```
<?xml version="1.0" encoding="UTF-8"?>
<data>
    <competition>
        <timeline time="10:00">
            <fixture>team a v team b</fixture>
            <fixture>team c v team d</fixture>
        </timeline>
        <timeline time="12:00">
            <fixture>team e v team f</fixture>
        </timeline>
        <timeline time="16:00">
            <fixture>team g v team h</fixture>
            <fixture>team i v team j</fixture>
            <fixture>team k v team l</fixture>
        </timeline>
    </competition>
</data> 
```

我正在使用以下 XSLT：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

    <xsl:template match="competition" >

        <xsl:apply-templates select="timeline" />

    </xsl:template>

    <xsl:template match="timeline">
        <timeline>
            <xsl:attribute name="time" >
                <xsl:value-of select="." />
            </xsl:attribute>

            <xsl:apply-templates select="following-sibling::*" mode="copy"/>

        </timeline>
    </xsl:template>

    <xsl:template match="fixture" mode="copy">
        <fixture>
            <xsl:value-of select="." />
        </fixture>
    </xsl:template>

    <xsl:template match="timeline" mode="copy">
        <xsl:apply-templates select="following-sibling::*" mode="null" />
    </xsl:template>

    <xsl:template match="*" mode="null">
    </xsl:template>
</xsl:stylesheet> 
```

我的问题是当它到达下一个时间线时它没有停止处理夹具节点

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T09:51:14.537

当以下情况成立时（我认为是），这很容易做到：

*   a 中的所有`<timeline>`s`<competition>`都是唯一的
*   只有`<fixture>`给定后的 s才`<timeline>`属于它
*   在它之前没有`<fixture>`没有`<timeline>`元素

这个 XSLT 1.0 解决方案：

```
<xsl:stylesheet
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>

  <xsl:key name="kFixture" 
           match="fixture" 
           use="generate-id(preceding-sibling::timeline[1])" 
  />

  <xsl:template match="data">
    <xsl:copy>
      <xsl:apply-templates select="competition" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="competition">
    <xsl:copy>
      <xsl:apply-templates select="timeline" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="timeline">
    <xsl:copy>
      <xsl:attribute name="time">
        <xsl:value-of select="." />
      </xsl:attribute>
      <xsl:copy-of select="key('kFixture', generate-id())" />
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

产生：

```
<data>
  <competition>
    <timeline time="10:00">
      <fixture>team a v team b</fixture>
      <fixture>team c v team d</fixture>
    </timeline>
    <timeline time="12:00">
      <fixture>team e v team f</fixture>
    </timeline>
    <timeline time="16:00">
      <fixture>team g v team h</fixture>
      <fixture>team i v team j</fixture>
      <fixture>team k v team l</fixture>
    </timeline>
    </competition>
</data> 
```

请注意使用 an`<xsl:key>`来匹配所有`<fixture>`属于（“前面是”）给定 的 s `<timeline>`。

一个稍短但不太明显的解决方案是修改身份转换：

```
<xsl:stylesheet
  version="1.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
>

  <xsl:key name="kFixture" 
           match="fixture" 
           use="generate-id(preceding-sibling::timeline[1])" 
  />

  <xsl:template match="* | @*">
    <xsl:copy>
      <xsl:apply-templates select="*[not(self::fixture)] | @*" />
    </xsl:copy>
  </xsl:template>

  <xsl:template match="timeline">
    <xsl:copy>
      <xsl:attribute name="time">
        <xsl:value-of select="." />
      </xsl:attribute>
      <xsl:copy-of select="key('kFixture', generate-id())" />
    </xsl:copy>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T09:30:26.140

这是我的尝试。我所做的一个简化事情的假设是具有特定文本值的时间线元素已经是唯一的。

```
<?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" encoding="UTF-8" />

  <xsl:template match="/data">
    <data>
      <xsl:apply-templates select="competition" />
    </data>
  </xsl:template>

  <xsl:template match="competition">
    <xsl:for-each select="timeline">
      <timeline time="{text()}">
        <xsl:copy-of
          select="./following-sibling::fixture[count(preceding-sibling::timeline[1] | current()) = 1]" />
      </timeline>
    </xsl:for-each>
  </xsl:template>

</xsl:stylesheet> 
```

根据 Tomalak 的建议，将上面的内容编辑为使用 current() 而不是变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T09:16:08.540

G Andrieu 的解决方案不起作用，因为不幸的是没有像“下一个兄弟”这样的轴。

替代解决方案如下：

```
<xsl:template match="timeline">
<timeline>
  <xsl:attribute name="time" >
    <xsl:value-of select="." />
  </xsl:attribute>

  <xsl:apply-templates select="following-sibling::*[local-name()='fixture' and position()=1]" />

</timeline>
</xsl:template>

<xsl:template match="fixture">
  <fixture>
      <xsl:value-of select="." />
  </fixture>
  <xsl:apply-templates select="following-sibling::*[local-name()='fixture' and position()=1]" />
</xsl:template> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T09:24:53.343

即使相同的时间线分散在多个地方，以下 xslt 也将起作用。例如，在 foll xml 中，时间轴 10:00 有 2 个条目

```
<?xml version="1.0" encoding="UTF-8"?>
<data>
    <competition>
        <timeline>10:00</timeline>
        <fixture>team a v team b</fixture>
        <fixture>team c v team d</fixture>
        <timeline>12:00</timeline>
        <fixture>team e v team f</fixture>
        <timeline>16:00</timeline>
        <fixture>team g v team h</fixture>
        <fixture>team i v team j</fixture>
        <fixture>team k v team l</fixture>
        <timeline>10:00</timeline>
        <fixture>team a v team b new</fixture>
        <fixture>team c v team d new</fixture>
    </competition>
</data> 
```

**Xslt**：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>
    <xsl:key name="TimelineDistint" match="timeline" use="."/>

    <xsl:template match="data">
        <xsl:apply-templates select="competition"/>
    </xsl:template>

    <xsl:template match="competition">
        <data>
            <competition>
                <xsl:for-each select="timeline[generate-id() = generate-id(key('TimelineDistint', .)[1])]">
                    <timeline>
                        <xsl:variable name="varTimeline" select="."/>
                        <xsl:attribute name="time"><xsl:value-of select="normalize-space(.)"/></xsl:attribute>
                        <xsl:for-each select="../fixture[preceding::timeline[1] = $varTimeline]">
                            <fixture>
                                <xsl:value-of select="normalize-space(.)"/>
                            </fixture>
                        </xsl:for-each>
                    </timeline>
                </xsl:for-each>
            </competition>
        </data>
    </xsl:template>
</xsl:stylesheet> 
```

**输出**：

```
<?xml version="1.0" encoding="UTF-8"?>
<data>
    <competition>
        <timeline time="10:00">
            <fixture>team a v team b</fixture>
            <fixture>team c v team d</fixture>
            <fixture>team a v team b new</fixture>
            <fixture>team c v team d new</fixture>
        </timeline>
        <timeline time="12:00">
            <fixture>team e v team f</fixture>
        </timeline>
        <timeline time="16:00">
            <fixture>team g v team h</fixture>
            <fixture>team i v team j</fixture>
            <fixture>team k v team l</fixture>
        </timeline>
    </competition>
</data> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-03T09:07:03.567

尝试这样的事情：

```
<xsl:template match="timeline">
    <timeline>
            <xsl:attribute name="time" >
                    <xsl:value-of select="." />
            </xsl:attribute>

            <xsl:apply-templates select="following-sibling::*[name()=fixture][1]" />

    </timeline>
</xsl:template>

<xsl:template match="fixture">
    <fixture>
            <xsl:value-of select="." />
    </fixture>
    <xsl:apply-templates select="following-sibling::*[name()=fixture][1]" />
</xsl:template> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T09:14:47.870

在 g andrieu 的帮助下，我不得不让它只得到下一个项目，而不是下面的列表：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" version="1.0" encoding="UTF-8" indent="yes"/>

    <xsl:template match="competition" >

        <xsl:apply-templates select="timeline" />

    </xsl:template>

    <xsl:template match="timeline">
        <timeline>
            <xsl:attribute name="time" >
                <xsl:value-of select="." />
            </xsl:attribute>

            <xsl:apply-templates select="following-sibling::*[1]" mode="copy"/>

        </timeline>
    </xsl:template>

    <xsl:template match="fixture" mode="copy">
        <fixture>
            <xsl:value-of select="." />
        </fixture>
        <xsl:apply-templates select="following-sibling::*[1]" mode="copy"/>
    </xsl:template>

    <xsl:template match="timeline" mode="copy" />

</xsl:stylesheet> 
```

# c++ - 至强的 gcc 优化标志？

> ID：943755
> 
> 赞同：35
> 
> 时间：2009-06-03T09:02:09.270
> 
> 标签：c++, c, optimization, gcc, compiler-flags

我想要您输入在优化 Xeons 时使用哪些 gcc 编译器标志？

mtune 或 March 中没有“至强”，那么哪个是最接近的匹配？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2014-08-02T14:00:34.683

最近 GCC / Xeon 的更新。

*   **[基于 Sandy-Bridge 的](http://en.wikipedia.org/wiki/Sandy_Bridge)Xeon**（E3-12xx 系列、E5-14xx/24xx 系列、E5-16xx/26xx/46xx 系列）。

    `-march=corei7-avx`对于 GCC < 4.9.0 或`-march=sandybridge`对于 GCC >= 4.9.0。

    这启用了[高级矢量扩展支持](http://en.wikipedia.org/wiki/Advanced_Vector_Extensions)以及 Sandy Bridge 的 AES 和[PCLMUL](https://en.wikipedia.org/wiki/CLMUL_instruction_set)指令集。以下是 GCC i386/x86_64 选项页面的概述：

    > 具有 64 位扩展的 Intel Core i7 CPU、MMX、SSE、SSE2、SSE3、SSSE3、SSE4.1、SSE4.2、AVX、AES 和 PCLMUL 指令集支持。

*   **[基于 Ivy-Bridge 的](http://en.wikipedia.org/wiki/Ivy_Bridge_%28microarchitecture%29)至强**（E3-12xx v2 系列、E5-14xx v2/24xx v2 系列、E5-16xx v2/26xx v2/46xx v2 系列、E7-28xx v2/48xx v2/88xx v2 系列） .

    `-march=core-avx-i`对于 GCC < 4.9.0 或`-march=ivybridge`对于 GCC >= 4.9.0。

    这包括 Sandy Bridge (corei7-avx) 选项，同时还支持新的 Ivy 指令集：FSGSBASE、[RDRND](http://en.wikipedia.org/wiki/RdRand)和[F16C](http://en.wikipedia.org/wiki/F16C)。从 GCC 选项页面：

    > 具有 64 位扩展的 Intel Core CPU、MMX、SSE、SSE2、SSE3、SSSE3、SSE4.1、SSE4.2、AVX、AES、PCLMUL、FSGSBASE、RDRND 和 F16C6 指令集支持。

*   **[基于 Haswell 的](http://en.wikipedia.org/wiki/Haswell_(microarchitecture))Xeon**（E3-1xxx v3-series、E5-1xxx v3-series、E5-2xxx v3-series）。

    `-march=core-avx2`对于 GCC 4.8.2/4.8.3 或`-march=haswell`对于 GCC >= 4.9.0。

    从 GCC 选项页面：

    > 具有 64 位扩展的 Intel Haswell CPU、MOVBE、MMX、SSE、SSE2、SSE3、SSSE3、SSE4.1、SSE4.2、POPCNT、AVX、AVX2、AES、PCLMUL、FSGSBASE、RDRND、FMA、BMI、BMI2 和 F16C指令集支持。

*   **[基于 Broadwell 的](https://en.wikipedia.org/wiki/Broadwell_%28microarchitecture%29)Xeon**（E3-12xx v4 系列、E5-16xx v4 系列）

    `-march=core-avx2`对于 GCC 4.8.x 或`-march=broadwell`GCC >= 4.9.0。

    从 GCC 选项页面：

    > 具有 64 位扩展的 Intel Broadwell CPU、MOVBE、MMX、SSE、SSE2、SSE3、SSSE3、SSE4.1、SSE4.2、POPCNT、AVX、AVX2、AES、PCLMUL、FSGSBASE、RDRND、FMA、BMI、BMI2、F16C 、RDSEED、ADCX 和 PREFETCHW 指令集支持。

*   **[基于 Skylake 的](https://en.wikipedia.org/wiki/Skylake_%28microarchitecture%29)Xeon**（E3-12xx v5 系列）和**[基于 KabyLake 的](https://en.wikipedia.org/wiki/Kaby_Lake)Xeon**（E3-12xx v6 系列）：

    `-march=core-avx2`对于 GCC 4.8.x 或`-march=skylake`GCC 4.9.x 或`-march=skylake-avx512`GCC >= 5.x

    [AVX-512](https://en.wikipedia.org/wiki/AVX-512)是 256 位高级矢量扩展 SIMD 指令的 512 位扩展。

    从 GCC 选项页面：

    > 具有 64 位扩展的英特尔 Skylake 服务器 CPU、MOVBE、MMX、SSE、SSE2、SSE3、SSSE3、SSE4.1、SSE4.2、POPCNT、PKU、AVX、AVX2、AES、PCLMUL、FSGSBASE、RDRND、FMA、BMI、 BMI2、F16C、RDSEED、ADCX、PREFETCHW、CLFLUSHOPT、XSAVEC、XSAVES、AVX512F、AVX512VL、AVX512BW、AVX512DQ 和 AVX512CD 指令集支持。

*   **[基于 Coffee Lake 的](https://en.wikipedia.org/wiki/Skylake_%28microarchitecture%29)Xeon** (E-21xx)`-march=skylake-avx512`：.

*   **[基于 Cascade Lake 的](https://en.wikipedia.org/wiki/Cascade_Lake_(microarchitecture))至强**（Platinum 8200/9200 系列、Gold 5200/6200 系列、Silver 4100/4200 系列、Bronze 3100/3200 系列）：（`-march=cascade-lake`需要[gcc 9.x](https://gcc.gnu.org/gcc-9/changes.html#x86)）。

    从 GCC 选项页面：

    > 启用 MOVBE、MMX、SSE、SSE2、SSE3、SSSE3、SSE4.1、SSE4.2、POPCNT、PKU、AVX、AVX2、AES、PCLMUL、FSGSBASE、RDRND、FMA、BMI、BMI2、F16C、RDSEED、ADCX、PREFETCHW 、CLFLUSHOPT、XSAVEC、XSAVES、AVX512F、CLWB、AVX512VL、AVX512BW、AVX512DQ、AVX512CD 和 AVX512VNNI。

    [AVX-512 矢量神经网络指令](https://en.wikichip.org/wiki/x86/avx512vnni)(AVX512 VNNI) 是 x86 扩展，是 AVX-512 的一部分，旨在加速基于卷积神经网络的算法。

*   **[基于 Cooper Lake 的](https://en.wikichip.org/wiki/intel/microarchitectures/cooper_lake)Xeon**（白金、金、银、铜）：（`-march=cooperlake`需要[gcc 10.1](https://gcc.gnu.org/gcc-9/changes.html#x86)）。

    该开关启用 AVX512BF16 ISA 扩展。

* * *

要了解编译器将使用该`-march=native`选项做什么，您可以使用：

```
gcc -march=native -Q --help=target 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-06-03T12:17:25.053

较新版本的 gcc 具有**-march=native**让编译器自动确定最佳`-march`标志。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-03T11:10:36.623

Xeon 是一个营销术语，因此它涵盖了一长串内部结构截然不同的处理器。

如果您指的是较新的 Nehalem 处理器（Core i7），那么[这张幻灯片](https://software.intel.com/sites/default/files/m/4/7/e/15507330-Intel-Nehalem-Core-Architecture-82-page.pdf)表明自 4.3.1 起 gcc 应使用 -march=generic（尽管您自己对自己的应用程序的测试可能会发现其他设置优于此设置）。如果您希望优化 FP 数学的这方面，4.3 系列还添加了 -msse4.2。

这是[一些](http://software.intel.com/en-us/forums/intel-vtune-performance-analyzer/topic/63801/)比较英特尔编译器调整与一些 gcc 标志的讨论。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T12:35:12.710

March=native 对你自己的机器没问题，但对二进制版本不好。

-march=nocona 建议用于 atom 330 (p4/64bit) -march=core2 用于 core2

我假设您要使用 64 位。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-10-07T00:28:42.567

以下将显示您的处理器支持的所有标志：

```
cat /proc/cpuinfo | grep flags | head -1 
```

确定您的处理器存在哪些优化的最佳方法不仅取决于模型，还取决于您正在编译的系统上的 gcc 版本。确保检查您拥有的 gcc 版本，并在他们的文档中交叉引用：

[https://gcc.gnu.org/onlinedocs](https://gcc.gnu.org/onlinedocs)

即我有 Slackware 14.1 x64，它有 gcc 4.8.2，所以我会去这里：

[https://gcc.gnu.org/onlinedocs/gcc-4.8.2/gcc/i386-and-x86-64-Options.html#i386-and-x86-64-Options](https://gcc.gnu.org/onlinedocs/gcc-4.8.2/gcc/i386-and-x86-64-Options.html#i386-and-x86-64-Options)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-07-10T07:32:05.597

我使用 Intel CPU 和 x86_64 的经验是，每次我试图告诉 gcc 为特定的 CPU 类型进行优化时，性能都会比使用 -march=generic 时更差，而不是更好。当然，YMMV，但这些年来我一直在玩这样的东西很多次，而且一直都是这样。

OTOH，在 i386 上，至少以 i686 为目标可能是有意义的，或者，如果您想要 SSE 数学，至少是 Pentium 4。

# emacs - 如何使用 Emacs Lisp 检查文件是否存在？

> ID：943760
> 
> 赞同：73
> 
> 时间：2009-06-03T09:03:16.473
> 
> 标签：emacs, elisp

我希望 emacs 将打开时生成的文件标记为只读。我缺少的部分难题是如何检查文件是否“存在”。我目前有以下内容：

```
;;
;; get file extension
;;
(defun get-ext (file-name)
  (car (cdr (split-string file-name "\\."))))

;; 
;; get the base name of the file
;;
(defun base-name (file-name)
  (car (split-string file-name "\\.")))

;;
;; if an 'lzz' file exists for this header, mark it as read only
;;
(defun mark-read-only ()
  (if (string= (get-ext (cur-file)) "h")
      (if ( ??file-exists??? (concat (base-name (cur-file)) ".lzz") )
          (toggle-read-only)))) 
```

我可以为“???文件存在???”使用什么？

一旦我找到这个，我会添加“mark-read-only”到适当的钩子（我认为是 find-file-hook）。

**背景**

我们使用[lzz](http://www.lazycplusplus.com/)作为代码生成器来简化我们的 C/C++ 开发过程。简而言之，lzz 采用单个输入文件（看起来很像 C/C++）并根据需要生成头文件和源文件。

默认情况下，lzz 包含#line 指令，以便调试器指向原始源而不是生成的源，但是，为了减少编译依赖性，我们通常在头文件中禁用这些指令。结果是在调试模板或内联函数时，调试器通常指向生成的头文件而不是原始源文件。

这没什么大不了的，但是，最近我发现在调试时我会快速修改显示的文件，然后我会重建。当然，这通常意味着我所做的更改会消失，因为我编辑的文件已生成，因此在库重建期间更改会“被吹走”。

**解决方案**

感谢大家的帮助和评论。特别感谢[cobbal](https://stackoverflow.com/users/73681/cobbal)指出要使用的正确功能。

这是生成的代码（也根据此处的其他评论进行了更新）：

```
(defun cur-file ()
  "Return the filename (without directory) of the current buffer"
  (file-name-nondirectory (buffer-file-name (current-buffer)))
  )

(defun mark-generated-as-read-only ()
  "Mark generated source files as read only.
Mark generated files (lzz or gz) read only to avoid accidental updates."
  (if
      (or (string= (file-name-extension (cur-file)) "h")
          (string= (file-name-extension (cur-file)) "cpp"))
      (cond
       (
        (file-exists-p (concat (file-name-sans-extension (cur-file)) ".lzz"))
        (toggle-read-only))
       (
        (file-exists-p (concat (file-name-sans-extension (cur-file)) ".gz") )
        (toggle-read-only))
       )
    )
  ) 
```

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2009-06-03T09:08:46.870

尝试`file-exists-p`

“如果文件文件名存在则返回 t（无论您是否可以阅读它。）”。

请注意，它并不适用于文件，也适用于目录。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2011-09-05T01:14:47.753

*   根据您的需要，您可能想要`file-readable-p`而不是`file-exists-p`.

*   Apropos 只会让你走这么远。 [***Icicles***](http://www.emacswiki.org/emacs/Icicles)提供了适当的[补全](http://www.emacswiki.org/emacs/Icicles_-_Apropos_Completions)和[渐进](http://www.emacswiki.org/emacs/Icicles_-_Progressive_Completion)补全，让您可以轻松地找到以任意顺序匹配子部分的命令、函数、变量等名称的帮助（是它`file-exists-p`还是`exists-file-p`？）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-03-14T15:24:46.797

Use [`f.el`](https://github.com/rejeep/f.el), modern library for file and directory manipulation. You can use [`f-exists?`](https://github.com/rejeep/f.el#f-exists-path), `f-file?`, `f-directory?` and many other predicates. The library is better than standard functions, because it's every file related function you'll ever need under one namespace.

# asp.net - asp.net 和 Ajax

> ID：943761
> 
> 赞同：0
> 
> 时间：2009-06-03T09:03:38.113
> 
> 标签：asp.net, javascript, ajax

我正在使用以下 JavaScript 代码刷新另一个页面

```
window.opener.location.replace(url) 
```

问题是在输入 URL 时，找不到该页面，因为该页面位于根目录中，并且此调用代码放置在另一个文件夹内的页面中。如何指定指向根的路径，即页面所在的位置？我尝试了很多东西，但没有一个奏效：

```
//page.aspx 
../page.aspx 
~/page.aspx
page.aspx
/page.aspx
.... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-31T09:28:34.947

你必须给出确切的路径

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T09:06:47.747

这种形式应该工作：

```
window.opener.location = url; 
```

replace 方法用另一个字符串替换当前 URL 中的匹配项，但它不能只使用一个参数。无论如何，没有必要指定完整的 URL，您可以只指定部分路径，例如：

```
../page.htm 
```

# asp.net - 如何让我的表单提交以理解 unicode 字符？

> ID：943764
> 
> 赞同：5
> 
> 时间：2009-06-03T09:04:34.380
> 
> 标签：asp.net, unicode

当我的 ASP.NET 应用程序的某些用户输入以下文本时

> Je bénéficie d'un coaching

我在 Request.Form 中得到以下值：

> Je b�n�ficie d�un coaching

起初我的页面将编码设置为 Latin1，我认为使用以下元标记将其更改为 Unicode (UTF8) 会有所帮助：

```
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/> 
```

但是在更改之后，我仍然在 Request.Form 中获得了那些“块”。

现在奇怪的是，当我提交由 IIS 提供服务的页面时会发生这种情况（例如[http://localhost/myform.aspx](http://localhost/myform.aspx)）。如果我得到相同的 html，将其保存在本地，直接在浏览器中打开文件（例如 c:\myform.html）并提交，一切都很好，我在 Request.Form 中看到了应有的 unicode 字符。

有小费吗？我在这里迷路了……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T10:54:15.893

您提到的元标记确保页面内容按照 UTF-8 代码页呈现，但不告知应如何处理发布的数据。为此，您应该在表单标签中添加此属性：

```
<form accept-charset="utf-8" ....> 
```

但是，不知道为什么当您通过 IIS 和文件系统运行它时行为会有所不同。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-03T09:22:14.487

你可以试试“charset=ISO-8859-1”。我希望能有所帮助。

# java - 带有“包含”页面的 jsp 页面中的变量

> ID：943770
> 
> 赞同：54
> 
> 时间：2009-06-03T09:06:04.363
> 
> 标签：java, jsp, jakarta-ee

使用标签添加页面的jsp页面中变量的范围规则是什么？

我的理解是，包含的页面本质上是逐字复制到页面中的，这将导致我假设如果我在父 JSP 中声明了一个变量，那么它将在子 JSP 中可用。

然而 Eclipse 对此抱怨（可以理解，因为我可以将页面包含在任何页面中或单独使用它们。当我尝试启动 tomcat 服务器时，它无法启动。

我基本上想从父页面中的会话中获取几个变量并在子页面中使用它们。这行不通。

所以我想到了从每个子页面的会话中获取它们的想法，但是我想知道我是否可以给它们所有相同的变量名，或者我是否必须为它们选择不同的变量名每一页，所以他们没有冲突。

另外，如果我在父 jss 中导入 log4net，我还必须在子 jss 中导入它吗？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-06-03T09:13:43.350

在 JSP 中有两种方法可以包含其他 jsp 页面。

```
<%@include file="include.jsp"%> 
```

和

```
<jsp:include page="include.jsp" /> 
```

如果您使用前者，那么在父 JSP 上声明的任何变量都将在 include.jsp 的范围内（当然 Eclipse 不会像您推测的那样看到这一点），因为它被编译器有效复制。

如果您使用第二种方法，则包含在运行时完成，并且包含页面有自己的范围。

同上进口。尽管在包含页面中冗余导入它们是安全的。

如果我使用前者，我更喜欢在它们后面加上 .jspf 来表示 JSP 片段。我可以关闭片段文件中的一些 Eclipses 警告。但总的来说，我尽量避免使用这种方法，而更喜欢第二种方法。

可以在此处的文档中找到更多信息：[包含指令](http://profesores.elo.utfsm.cl/~agv/elo330/2s03/projects/Tomcat/doc/1.2/syntaxref129.html)和[JSP 包含](http://tecfa.unige.ch/guides/jsp/jsp-ref10/syntaxref10.fm11.html)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2010-03-03T08:41:18.457

如果要在要包含的页面的路径中使用变量，请使用以下内容：

```
<% pageContext.include("/cities/" + (String) request.getAttribute("country_code") + ".jsp"); %> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T12:05:43.750

从面向对象的角度来看，我建议不要依赖 parent.jsp 中包含在 child.jsp 中的变量的范围。这是因为当我在 jsp 中包含一个片段时，我倾向于在许多不同的地方重用该片段。例如，如果我有一个 child.jsp，我可能想在 parent1.jsp 和 parent2.jsp 中使用它。在这种情况下最好不要变量继承。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-10-04T09:08:34.737

创建变量时，应将范围设置为会话，否则，包含的页面将看不到它。例子 ：

```
<logic:iterate id="supportTmp" name="publicites" indexId="indexLots" scope="session">                                    
    <c:set var="support" value="${supportTmp}" scope="session"/>
    <c:choose>
    <c:when test="${publiciteMoniteur == true}">
    <jsp:include page="/jsp/bodies/suiviEnvoiPubliciteMoniteurLigne.jsp" />
    </c:when>
    <c:otherwise>
        <jsp:include page="/jsp/bodies/suiviEnvoiPubliciteDefautLigne.jsp" />
    </c:otherwise>
</c:choose>
</logic:iterate> 
```

# java - 包装罐

> ID：943774
> 
> 赞同：0
> 
> 时间：2009-06-03T09:07:01.507
> 
> 标签：java, plugins, properties, jar

尝试将多个插件及其属性文件打包到可执行 jar 中是令人沮丧的一天。

如何将这些插件打包到一个 jar 中，将属性文件留在外面：
- 带有 pluginA.properties 的 pluginA
- 带有 pluginB.properties 的 pluginB
- 需要 pluginA 和 pluginB 的 pluginC

属性文件可从其相关插件中访问，例如 pluginA.properties 可从 pluginA 访问。
但是，无法从 pluginC 访问属性文件。

有人可以帮忙吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T09:11:08.690

不确定是否理解您的问题。您是否有包含存储属性文件的文件夹的 jar 类路径（在 META 文件中）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T09:17:23.403

当 pluginA 应该使用类 frmo pluginB 时，pluginA 必须将包路径放到运行时包中。您可以在 MANIFEST->Runtime->"Exported Packages" 中找到配置

当您想使用属性文件时，您必须使用被调用插件的捆绑包来找到正确的属性文件。尝试在pluginC中获取pluginA的默认插件实现

> AbstractUIPlugin.getDefault()

然后搜索捆绑对象并使用 findResource 方法查找属性文件。

另一种方法是在 pluginA 中编写一个实用程序类，它为您提供特定键的属性值。这个类你可以从你想要的每个插件中调用。

您可以通过调用在 Eclipse 中测试您的 jar

> 导出 -> 可部署的插件和片段

您可以检查导出是否有效并且所有文件都在 jar 中。如果没有，您必须更新您的 MANIFEST 或 build.properties 文件

# windows - STDIN.getc 锁定我的应用程序

> ID：943779
> 
> 赞同：0
> 
> 时间：2009-06-03T09:07:58.743
> 
> 标签：windows, ruby, curses

我有以下代码

```
class TimeReport
  def run
    init_screen
    lines = Curses::lines
    cols  = Curses::cols
    read=""

    begin
      crmode
      noecho

      gotoDay  diaActual.data.to_s #loads the screen with data

      while !read.eql?("q")
        printPrompt #simply prints the command prompt
        read=STDIN.getc
        printOnSpot 10,10,read.to_s #prints what was read

        if(!read.empty? && !read.strip.empty?)
          processPrompt(read,@ecra) # process the read command
          else
          printInfo "Say What??" 
          end
      end

    ensure

    echo
    nocrmode
    close_screen
    end
  end
end
TimeReport.new.run 
```

当我尝试运行应用程序时，应用程序会锁定并且不会初始化屏幕。如果我使用 Curses.getch，则不会出现此问题。

谁能告诉我为什么会发生这种情况？以及解决问题的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T10:50:10.860

这就是为什么你不应该混合 Curses 和 STDIN

# algorithm - 我在哪里可以找到有关双三次插值和 Lanczos 重采样的好读物？

> ID：943781
> 
> 赞同：19
> 
> 时间：2009-06-03T09:08:53.467
> 
> 标签：algorithm, image-processing, resampling

我想在 C++ 中实现上述两种图像重采样算法（双三次和 Lanczos）。我知道那里有几十个现有的实现，但我仍然想自己做。我想做到这一点，部分是因为我想了解它们是如何工作的，部分是因为我想给他们一些主流实现中没有的功能（比如可配置的多 CPU 支持和进度报告）。

我尝试阅读维基百科，但这些东西对我来说有点太干了。也许对这些算法有更好的解释？我在 SO 或 Google 上都找不到任何东西。

**补充：**似乎没有人能给我一个关于这些主题的好链接。至少有人可以在这里解释一下吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-03T21:02:30.513

虽然 Ants Aasma 所说的大致描述了差异，但我认为它并不能特别说明你为什么会做这样的事情。

就链接而言，您在图像处理中提出了一个非常基本的问题，任何关于该主题的体面的入门教科书都会对此进行描述。如果我没记错的话，[冈萨雷斯和伍兹](https://rads.stackoverflow.com/amzn/click/com/0201180758)在这方面做得不错，但我不在我的书本上，无法检查。

现在谈谈细节，从根本上考虑你在做什么应该会有所帮助。您有一个要为其插入新值的测量方格。在上采样的简单情况下，假设您想要在您已经拥有的每个测量之间进行新的测量（例如，分辨率加倍）。

现在您将无法获得“正确”的值，因为通常您没有该信息。所以你必须估计它。这个怎么做？一种非常简单的方法是线性插值。每个人都知道如何用两个点来执行此操作，您只需在它们之间画一条线，然后读取线外的新值（在这种情况下，在中间点）。

现在图像是二维的，所以你真的想在左右和上下方向上都这样做。将结果用于您的估计，瞧，您有“双线性”插值。

这样做的主要问题是它不是很准确，尽管它比“最近邻”方法更好（并且更慢），后者也非常本地和快速。

为了解决第一个问题，您需要比两点的线性拟合更好的东西，您想要将某些东西拟合到更多的数据点（像素），以及可以是非线性的东西。精度和计算成本的良好权衡称为三次样条。因此，这将为您提供一条平滑的拟合线，并再次通过中间值来近似您的新“测量值”。在两个方向上都这样做，你就有了“双三次”插值。

所以这更准确，但仍然很重。解决速度问题的一种方法是使用卷积，它具有很好的特性，在傅立叶域中，它只是一个乘法，所以我们可以很快地实现它。但是您无需担心实现，以了解任何时候的卷积结果都是一个函数（您的图像）被集成到另一个产品中，通常支持更小的支持（非零部分）称为内核的函数)，在该内核以该特定点为中心之后。在离散世界中，这些只是产品的总和。

事实证明，您可以设计一个具有与三次样条非常相似的属性的卷积核，并使用它来获得快速的“双三次”

Lancsoz 重采样是类似的事情，内核中的属性略有不同，这主要意味着它们将具有不同的特征工件。您可以很容易地查找这些内核函数的详细信息（我相信维基百科有它们，或任何介绍文本）。图形程序中使用的实现往往是高度优化的，有时有专门的假设，使它们更有效但不太通用。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-06-03T20:12:38.913

两种算法的基本操作原理都非常简单。它们都是卷积滤波器。一个卷积滤波器，它针对每个输出值将卷积函数的原点移动到以输出为中心，然后将输入中的所有值与该位置的卷积函数的值相乘，然后将它们相加。

卷积的一个特性是输出的积分是两个输入函数的积分的乘积。如果考虑输入和输出图像，则积分表示平均亮度，如果您希望亮度保持不变，则卷积函数的积分需要加起来为 1。

如何理解它们的一种方法是将卷积函数视为显示输入像素根据距离影响输出像素的程度。

卷积函数通常被定义为当距离大于某个值时它们为零，这样您就不必考虑每个输出值的每个输入值。

对于 lanczos 插值，卷积函数基于*sinc(x) = sin(x*pi)/x*函数，但仅采用前几个波瓣。通常为 3：

```
lanczos(x) = {
    0 if abs(x) > 3,
    1 if x == 0,
    else sin(x*pi)/x
} 
```

这个函数称为过滤器内核。

要使用 lanczos 重新采样，假设您将输出和输入相互叠加，点表示像素位置的位置。对于每个输出像素位置，您从该点取一个框 +- 3 个输出像素。对于位于该框中的每个输入像素，计算该位置的 lanczos 函数的值，并将输出像素坐标中与输出位置的距离作为参数。然后，您需要通过缩放计算值来归一化计算值，使它们加起来为 1。然后将每个输入像素值与相应的缩放值相乘，并将结果加在一起以获得输出像素的值。

因为 lanzos 函数具有可分离性，并且如果您正在调整大小，网格是规则的，您可以通过分别进行水平和垂直卷积并预先计算每行的垂直过滤器和每列的水平过滤器来优化它。

双三次卷积基本相同，只是滤波器核函数不同。

[要获得更多详细信息，请参阅《数字图像处理](https://rads.stackoverflow.com/amzn/click/com/1846283795)》第 16.3 节中的非常好的和彻底的解释。

此外， skia 中的[image_operations.cc](http://src.chromium.org/svn/trunk/src/skia/ext/image_operations.cc)和[convolver.cc](http://src.chromium.org/svn/trunk/src/skia/ext/convolver.cc)对 lanczos 插值的实现进行了很好的评论。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-17T17:20:58.277

我想推荐以下文章，以基本了解[通过卷积进行](http://www.codeproject.com/Articles/236394/Bi-Cubic-and-Bi-Linear-Interpolation-with-GLSL)图像插值的不同图像插值方法。如果你想尝试更多的插值方法，[imageresampler](http://code.google.com/p/imageresampler/)是一个不错的开源项目。

我认为图像插值可以从两个方面来理解，一个是从函数拟合的角度，一个是从卷积的角度。例如，[通过卷积在图像插值中解释的样条插值在](http://www.codeproject.com/Articles/236394/Bi-Cubic-and-Bi-Linear-Interpolation-with-GLSL)[三次插值](http://www.paulinternet.nl/?page=bicubic)中从函数拟合的角度得到了很好的解释。

此外，图像插值总是与特定应用相关，例如图像缩放、图像旋转等。事实上，对于特定的应用程序，图像插值可以以一种智能的方式实现。例如，图像旋转可以通过[三剪切方法](https://www.google.be/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&ved=0CD0QFjAB&url=http://www.cipprs.org/papers/VI/VI1986/pp077-081-Paeth-1986.pdf&ei=cjL4UP7aH427hAfY1YGoBA&usg=AFQjCNGGZDb3RcogbQjj8I2aMub1ZCXmbQ&sig2=i2DFoc8WnaylIombdEFcuQ&bvm=bv.41018144,d.ZG4)实现，并且在每次剪切操作期间可以实现不同的一维插值算法。

# regex - SciTE 正则表达式，在 x 和 y 次之间匹配表达式，例如 \w*{x,y}

> ID：943783
> 
> 赞同：1
> 
> 时间：2009-06-03T09:09:21.470
> 
> 标签：regex, scite

如何使用 SciTE 匹配一个单词字符 1 到 7 次？

通常会是

```
\w{1,7} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T09:22:04.457

我认为在 SciTE 中不能这样做。

也许：\w\w?\w?\w?\w?\w?\w?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T09:26:26.833

它不支持该语法，您可以在[此处](http://www.scintilla.org/SciTERegEx.html)查看文档。正如 activa 所说，这样做的唯一方法似乎是 \w\w?\w?\w?\w?\w?\w?

# code-generation - 手动编写业务对象还是使用 DAL 对象？

> ID：943788
> 
> 赞同：2
> 
> 时间：2009-06-03T09:12:20.043
> 
> 标签：code-generation, poco, data-access-layer, n-tier-architecture

假设您有三层（带有命名空间）：

*   用户界面 ( `App.UI`) - 调用业务层流程并使用对象进行通信
*   业务层 ( `App.Core`) - 使用对象编排流程并使用 DAL 层
*   DAL ( `App.Data`) - 直接操作存储和持久化对象

假设您有 User 表，因此反映在您的 DAL 层中，`App.Data.User`并且可能也反映在`App.Data.Users`.

您的 UI 中有一个显示应用程序用户的视图。

要真正拥有一个分离（分层）的应用程序，您还应该拥有`App.Core.User`并且`App.Core.Users`可能必须手动创建。

***最好*的解决方案（在我看来）当然是**：应该有第四层*业务对象（`App.Objects`）*，其中包含类`App.Objects.User`和`App.Objects.Users`. 这些 POCO 将在所有层之间共享。业务层只允许使用 DAL，UI 只允许使用 BL，但它们都将`App.Objects`用于公共对象模型。

Asp.net MVC 模板暗示直接在视图上使用 DAL 对象，LINQ 2 实体本身也不创建任何 POCO...

**那么当使用任何*自动*代码生成时，我们应该使用 DAL 对象还是手动硬编码我们共享的 POCO？**第一部分似乎是一个*简单的出路，*但没有将 DAL 与 UI 分开（以后可能会有安全性和可伸缩性问题），第二部分容易出错并且对于中等大小的数据库非常乏味。

你有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T10:05:57.207

你所谓的 App.Objects 基本上就是你的领域模型，在所有层之间共享以传递数据是合乎逻辑的，但你需要决定这个模型是贫血的还是活跃的。

# asp.net - 处理包含页面上的用户控制事件

> ID：943794
> 
> 赞同：6
> 
> 时间：2009-06-03T09:14:31.913
> 
> 标签：asp.net, user-controls

我想要一个包含保存按钮的用户控件。

我希望附加到保存按钮的单击事件由包含页面而不是用户控件处理

这可能吗？

编辑更具体

假设我有一个名为“编辑器页面”的页面和一个名为“编辑器按钮”的用户控件。在“编辑器按钮”用户控件上，我有一个保存按钮（这是一个 Web 控件）。我希望保存按钮的 Click 事件由“编辑器页面”而不是用户控件处理。

这样做的原因是因为我想指定实现常见行为的基本页面。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-19T08:48:35.280

这种技术通常被称为“事件冒泡”。

这是一个例子：

```
public partial class Test : System.Web.UI.UserControl

{

 public event EventHandler buttonClick;

 protected void Button1_Click(object sender, EventArgs e)
 {
     buttonClick(sender, e);
 }

} 
```

然后您可以订阅事件按钮点击网页以显示不同的信息。

```
public partial class Test: System.Web.UI.Page
 {
 protected void Page_Load(object sender, EventArgs e)
 {

 UserControlID.buttonClick+=new EventHandler(UserControlID_buttonClick);

}

protected void UserControlID_buttonClick(object sender, EventArgs e)
 {
     Response.Write("hello,I am jack.");
 }

} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T09:24:27.993

我将假设您拥有 UserControl 的代码。如果是这种情况，您可以在您的用户控件中定义一个 Save 事件，并让它直接公开保存按钮的 Click 事件[，](https://stackoverflow.com/questions/943171/expose-and-raise-event-of-a-child-control-in-a-usercontrol-in-c/943192#943192)或者通过内部设置事件处理程序并在单击按钮时引发 Save 事件。在 UserControl 中可能看起来像这样：

```
public event EventHandler Save;

private void SaveButton_Click(object sender, EventArgs e)
{
    OnSave(e);
}

protected void OnSave(EventArgs e)
{
    // raise the Save event
    EventHandler save = Save;
    if (save != null)
    {
        save(this, e);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T08:52:35.403

用户控件1.ascx

UserControl1.ascx.cs

公共部分类 UserControl1：System.Web.UI.UserControl

{

```
public event EventHandler UserControl1Click;

protected void Page_Load(object sender, EventArgs e)

{

}

protected void btn1_Click(object sender, EventArgs e)

{

    UserControl1Click(sender, e);

} 
```

}

用户控件2.ascx

UserControl1.ascx.cs

公共部分类 UserControl2：System.Web.UI.UserControl

{

```
public event EventHandler UserControl2Click;

protected void Page_Load(object sender, EventArgs e)

{

} 

protected void btn2_Click(object sender, EventArgs e)

{

    UserControl2Click(sender, e);

} 
```

}

然后将一个 Asp.Net 文本框（用于显示用户控件 ID）和上面的两个用户控件添加到 Aspx 页面，如下所示。

```
<title>Untitled Page</title> 
```

```
<form id="form1" runat="server">

<div>

<asp:TextBox ID="txt1" runat="server"></asp:TextBox> <br />

<UC1:UC ID="uc1" runat="server" />

<UC1:UC ID="uc2" runat="server" />

</div>

</form> 
```

现在为每个用户控件添加事件处理程序来处理两个控件的按钮单击事件，如下所示。

公共部分类_默认：System.Web.UI.Page

{

```
protected void Page_Load(object sender, EventArgs e)

{

    uc1.UserControl1Click += new EventHandler(uc1_UserControl1Click);

    uc2.UserControl2Click += new EventHandler(uc2_UserControl2Click);

}

protected void uc1_UserControl1Click(object sender, EventArgs e)

{

    txt1.Text = "User Control 1 Clicked";

}

protected void uc2_UserControl2Click(object sender, EventArgs e)

{

    txt1.Text = "User Control 2 Clicked";

} 
```

}

如果我们点击 User Control1，文本框会显示“User Control 1 Clicked”，或者如果我们点击 User Control2，文本框会显示“User Control 2 Clicked”。

# perl - Perl 中的单引号和双引号有什么区别？

> ID：943795
> 
> 赞同：22
> 
> 时间：2009-06-03T09:14:47.810
> 
> 标签：perl, string

`'`在 Perl 中，和有什么区别`"`？

例如，我有 2 个变量，如下所示：

```
$var1 = '\(';
$var2 = "\(";

$res1 = ($matchStr =~ m/$var1/);
$res2 = ($matchStr =~ m/$var2/); 
```

该`$res2`声明抱怨说`Unmatched ( before HERE mark in regex m`。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-06-03T09:18:33.887

双引号使用变量扩展。单引号不

在双引号字符串中，您需要转义某些字符以阻止它们被不同地解释。在单引号字符串中，您不需要（反斜杠除外，如果它是字符串中的最后一个字符）

```
my $var1 = 'Hello';

my $var2 = "$var1";
my $var3 = '$var1';

print $var2;
print "\n";
print $var3;
print "\n"; 
```

这将输出

```
Hello
$var1 
```

[Perl Monks在这里](http://www.perlmonks.org/?node_id=401006)有一个很好的解释

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T09:17:37.210

' 不会解析变量和转义

" 将解析变量和转义字符。

如果要将 \ 字符存储在 $var2 中的字符串中，请使用 "\\("

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T09:17:22.810

双引号解释，单引号不解释

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T09:25:29.847

Perl 采用单引号字符串“原样”并插入双引号字符串。插值意味着它用变量值替换变量，并且还理解转义字符。所以，你的 "\(" 被解释为 '('，你的正则表达式变成 m/(/，这就是 Perl 抱怨的原因。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-03T16:07:59.673

如果您要创建正则表达式字符串，您应该真正使用[qr// 类似引号的运算符](http://perldoc.perl.org/perlop.html#Regexp-Quote-Like-Operators)：

```
my $matchStr = "(";
my $var1 = qr/\(/;
my $res1 = ($matchStr =~ m/$var1/); 
```

它创建了一个编译的正则表达式，比仅使用包含字符串的变量要快得多。如果没有在正则表达式上下文中使用，它也会返回一个字符串，所以你可以说类似

```
print "$var1\n"; #prints (?-xism:\() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-03T09:20:37.250

"" 支持变量插值和转义。所以里面`"\("` `\`逃脱（

其中 ' ' 也不支持。`'\('`从字面上看也是如此`\(`

# asp.net-mvc - 在向用户报告进度的同时，在 ASP.NET MVC 中做一些需要一段时间的事情？

> ID：943801
> 
> 赞同：1
> 
> 时间：2009-06-03T09:16:59.303
> 
> 标签：asp.net-mvc

在我的 ASP.NET MVC 应用程序中，我的一个操作需要一段时间——它会启动一系列其他任务。我想向用户报告进度。我想显示文本——我不想要一个简单的进度条或微调器。

我应该如何去做这两个部分？首先，如何向用户显示进度？其次，我应该如何实施该操作以便用户可以使用进度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T09:38:09.603

我的想法：

创建控制器方法，该方法返回 JSON：

```
{
    "Message" : "Processing something serious",
    "Percentage" : "43"
} 
```

通过 JS 处理 - 将消息跨度和条形指示器放在单独的 div 中，更改其内容。

对于进度条，我会使用[这个](http://t.wits.sg/misc/jQueryProgressBar/demo.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T09:26:39.097

我开始编写响应，但后来我意识到我应该重定向到[进度指示器](http://ajaxpatterns.org/Progress_Indicator)AJAX 模式资源。它对问题、解决方案、可用性考虑和其他有趣的细节进行了全面而简洁的讨论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T09:41:36.320

我正在玩一些游戏，目前我想到了以下几点：

1.  在初始控制器动作中，启动一个执行实际工作的后台线程，立即返回。
2.  在网页中，使用计时器查询“GetProgress”动作。这将返回一些可用于更新网页的 JSON。我将使用 jQuery。
3.  在 GetProgress 操作中，查询后台线程的进度。

我可能会将 Job ID 传递给 GetProgress，并使用它来识别我正在询问*的后台线程。*

# iphone - 加载动画

> ID：943808
> 
> 赞同：0
> 
> 时间：2009-06-03T09:19:11.233
> 
> 标签：iphone, cocoa-touch, core-animation

我想在运行函数时加载动画图像（例如：加载....）。我如何在 iphone SDK 中进行操作？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-04-04T19:38:40.027

使用 CoreAmination。

```
self.layer.transform = CATransform3DRotate(self.layer.transform, M_PI, 0.f, 0.f, 1.f);
CABasicAnimation *animation = [CABasicAnimation animationWithKeyPath:@"transform"];
animation.toValue = [NSValue valueWithCATransform3D:CATransform3DIdentity];
animation.autoreverses = NO;
animation.duration = 1.00;
//animation.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut];

animation.repeatCount = HUGE_VALF;
[self.layer addAnimation:animation forKey:@"spinner"]; 
```

# python - Cython 中的字符串操作

> ID：943809
> 
> 赞同：29
> 
> 时间：2009-06-03T09:19:23.603
> 
> 标签：python, string, cython

我有一些代码可以执行一些非常占用 CPU 的字符串操作，并且我正在寻找提高性能的方法。

（编辑：我正在做一些事情，比如找到最长的公共子字符串，运行许多可能更好地表示为 c 中的状态机的正则表达式，从 HTML 中剥离注释，诸如此类。）

在听到很多关于它的好消息后，我目前正在考虑将一些代码移植到[Cython 。](http://www.cython.org/)然而，Cython 的主要关注点似乎是数值计算，并且几乎没有记录使用字符串。

Unicode 也可能是一个大问题。

我的问题是：

1.  我什至应该为字符串的东西烦恼 Cython 吗？有没有人在 cython 中有这种类型的处理经验并可以分享？
2.  我在 Cython 文档中遗漏了什么吗？有谁知道有关在 Cython 中使用字符串的教程/参考/文档？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-03T12:41:38.797

我投了“profile it”的答案，但想补充一点：在可能的情况下，您可以进行的最佳优化是使用 Python 标准库或内置函数来执行您想要的任务。这些通常在 C 中实现，并将提供与任何扩展大致相当的性能，包括用 Cython 编写的扩展。如果您的算法在 Python 中逐个字符地执行循环，那么如果可能的话，这些应该是首先要做的事情。

但是，如果您的算法无法根据内置或其他现有标准库进行修改，那么 Cython 似乎是一种合理的方法。它只是将伪 Python 编译为本机代码，并且真的像任何其他操作一样适合字符串操作。但我不相信如果你只是将惯用的 Python 代码交给 Cython，你会看到使用 Cython 的巨大好处。如果您能够在 C 中重写每个算法的部分或全部，从而使低级操作不会不断地跨 Python/C 障碍转换变量，那么最大的好处就会出现。

最后，Unicode——你暗示它可能是一个“大问题”，但没有具体说明你是如何使用它的。Cython 可能会生成调用处理 Unicode 的相关 Python API 的 C 代码，因此功能不太可能受到限制。然而，在 C 中处理 Unicode 字符串并非易事，并且可能意味着在 C 中重写一些算法以获得更好的性能的想法是不值得的。许多经典的字符串算法根本不适用于许多 Unicode 编码，它们不是传统意义上的“字符串”，即每个字符有 1 个存储单元。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-11-26T11:36:11.560

只是为了完整起见，我最终做的只是用 C 编写（一些）字符串操作代码。

事实证明，开始为 python 编写 c 扩展[非常容易。](http://en.wikibooks.org/wiki/Python_Programming/Extending_with_C)Unicode 字符串只是 Py_UNICODE 的数组，它是 int 或 short 取决于 python 构建。

我得到了 x20 改进转换代码，例如

```
s = re.sub(r' +', ' ', s) 
```

到 c. 我用更复杂的正则表达式得到了类似的改进，但是 c 代码很快变得非常复杂。

总体而言，重写后我的吞吐量提高了 20%。我现在正在寻找更多要重写的东西...

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-11-26T23:57:05.400

“非常容易”是一个非常相对的术语。“开始”就是这样。用 C 语言编写健壮的扩展需要非常小心地注意引用计数、内存分配/释放和错误处理等问题。Cython 为你做了很多事情。

Cython 中的非 unicode 字符串可以是 Python str 对象，也可以是 char 数组，如在 C 中。您认为需要哪些 Cython 特定文档？

我建议您自己尝试 Cython。但在你这样做之前，我强烈建议你检查你的 Python 代码是否效率低下。有时你可以很容易地获得巨大的加速。

例如，压缩空格字符的运行......使用

```
re.sub(' +', ' ', s) # one space in pattern 
```

意味着在运行长度为 1 的可能并不少见的情况下，它将用空格替换空格。如果所有运行的长度都为 1，它将创建一个新的替换字符串，当它可以轻松地增加（或不减少，或其他）输入字符串的引用计数并将其传回时。

```
re.sub('  +', ' ', s) # two spaces in pattern 
```

产生完全相同的结果并且可能运行得更快......让我们看看：

所有运行长度 1：它以 3.4 倍的速度运行。未显示：输入字符串越长越好。

```
\python26\python -mtimeit -s"s='now is the winter of our discontent'; import re; x = re.compile(' +').sub" "x(' ', s)"
100000 loops, best of 3: 8.26 usec per loop

\python26\python -mtimeit -s"s='now is the winter of our discontent'; import re; x = re.compile('  +').sub" "x(' ', s)"
100000 loops, best of 3: 2.41 usec per loop 
```

对于长度为 2 的一次运行，速比为 2.5。对于所有长度为 2 的运行，速比为 1.2。考虑到所有因素，1 次击键的投资回报还不错。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-02-17T20:37:35.280

我最近被介绍给 Cython，并在包装​​大型 C 和 C++ 库以用于重要项目中取得了巨大成功。一些生成的 Python 扩展实际上已经在我们的生产环境中运行。所以，首先，Cython 绝对是一个不错的选择。

话虽如此，您应该考虑是否真的想用 Cython 编写所有代码，或者是否想编写 C/C++ 代码并简单地使这些函数可以从 Cython 访问。显然，这部分取决于您对 C 和/或 C++ 的熟悉程度。

当您使用字符串时，使用`std::string`from C++ 而不是`char*`. 它可以很容易地导入到 cython 中，`from libcpp.string cimport string`然后可以通过标准 cython 用字符串类型声明变量`cdef string ...`

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-10-13T15:02:17.597

这是一个非常有趣的问题。Cython 的核心是将 python 与 C 数据类型集成的工具。它不提供任何帮助处理字符串的功能，可能是因为对它的需求不如对特定 Numpy 功能的需求多。

话虽如此，您可以很好地使用 Cython 与旨在处理您描述的问题类型的现有 C/C++ 库进行交互。例如，对于处理 HTML/XML，您可能需要查看[libxml](http://xmlsoft.org/)。但是，（当然）已经有[现成的 python 绑定](http://codespeak.net/lxml/)可用于此。我已经广泛使用 lxml 来处理 HTML，它可以满足我的所有需求并且*速度很快*，而且它可以很好地处理 unicode。

在您的情况下，我认为 lxml 和定制的 C 函数的组合是最好的。例如，您可以“轻松”创建一个快速函数来查找 C 中最长的子字符串，因为这可以在字节级别完成（回想一下，C 中的字符串只是一个 char*，它是一个字节数组）。然后你可以将它们映射回 python（Cython 会让你很容易）并在 unicode 抽象天堂中继续进行:)。当然不是微不足道的，但如果您的应用程序的性能依赖于它，则可能值得付出努力。

当然，在 C/C++ 中使用 unicode 也有一些不错的（尽管不是很重要的）方法。[Evan Jones 的这篇文章](http://evanjones.ca/unicode-in-c.html)可能会帮助您确定是否值得付出努力。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2011-04-16T14:15:20.443

请注意，Cython 实际上支持 CPython 的 Py_UNICODE 类型，因此，例如，您可以直接迭代 unicode 字符串或以 C 速度比较字符。看

[http://docs.cython.org/src/tutorial/strings.html](http://docs.cython.org/src/tutorial/strings.html)

# sql - 将数据从电子表格导出到 Pgsql 数据库

> ID：943816
> 
> 赞同：0
> 
> 时间：2009-06-03T09:22:31.693
> 
> 标签：sql, database, postgresql, spreadsheet

我有一个巨大的电子表格文件（1000 多行）和一个 postgreSQL 表。我需要将电子表格数据与 postgresql 表数据进行比较，并用电子表格中的数据填充表格中的空白字段，并添加 db 表中不存在的条目。

是的，我可以（通过 csv）将整个电子表格转换为数据库表。但是，两个文档中都有唯一的值，所以这样做会丢失数据。或者，是否可以比较 2 个表并用表 B 中的数据填充表 A 中的缺失字段？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T09:33:49.580

在 SQL 中很容易比较两个表，并且插入不在一个表中的行。例如：

```
INSERT INTO TableA
    (col1, col2, col3)
SELECT
    col1, col2, col3
FROM SpreadSheetTable
WHERE NOT EXISTS (
    SELECT *
    FROM TableA
    WHERE TableA.col1 = SpreadSheetTable.col1
) 
```

此查询将 SpreadSheetTable 中的所有行插入到 TableA 中，除了那些 TableA 已经包含具有相同“col1”值的行的行。

# c# - DataGridView 只读单元格

> ID：943823
> 
> 赞同：15
> 
> 时间：2009-06-03T09:24:41.737
> 
> 标签：c#, datagridview

我有一个包含大量数据的绑定 DataGridView。问题是某些单元格必须是只读的，而且当用户在单元格之间使用 TAB 或 ENTER 导航时，应该绕过只读单元格。加载后立即使某些特定单元格只读的最佳方法是什么？

考虑到网格有大量数据，在设置 DataSource 后循环遍历单元格不是一个好主意。此外，在 CellEnter 上设置单元格 ReadOnly 不起作用，因为使用 TAB 键导航时，我必须已经知道下一个单元格是否为 ReadOnly。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-03T09:43:12.290

在绑定数据之前尝试使列而不是单个单元格只读：

```
this.dgrid.Columns["colName"].ReadOnly = true; 
```

如果您需要对列中的单个单元格执行此操作，则必须像这样循环并设置它们：

```
this.dgridvwMain.Rows[index].Cells["colName"].ReadOnly = true; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-02-28T14:33:30.903

您可以使用 CellBeginEdit 事件并在需要禁用单元格时设置 e.Cancel = True 。

```
Private Sub DataGridView_CellBeginEdit(sender As System.Object, e As System.Windows.Forms.DataGridViewCellCancelEventArgs) Handles DataGridViewMsg.CellBeginEdit
    If DataGridViewMsg.Rows(e.RowIndex).Cells("disable").Value = "Y" Then
        e.Cancel = True
    End If
End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-20T20:22:37.840

我没试过这个。

但是，您可以在 RowEnter 事件中将单元格的只读属性设置为 true（根据 Rashmi）吗？

我猜 RowEnter 事件应该在您从一行移动到另一行时触发（或者当您从单元格 A1 更改为 B3 时应该触发）。

这些帮助有用？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-30T16:02:52.290

```
this.dataGridViewEmpList.EditMode = DataGridViewEditMode.EditProgrammatically; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-11-13T09:39:43.453

我使用以下代码遍历数据网格：

```
dataGridViewTest.DataSource = persons;

foreach (DataGridViewRow row in dataGridViewTest.Rows)
{
    foreach (DataGridViewCell cell in row.Cells)
    {
        if (cell.Value.ToString() == "John")
        {
            cell.ReadOnly = true;
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T09:45:40.057

一旦该列是只读的（请参阅 Rashmi 的回复），您就可以处理此事件...

```
private void dataGridView1_KeyPress(object sender, KeyPressEventArgs e)
{
    if (e.KeyChar == (char)Keys.Tab)
    {
        Boolean readOnly = (sender as DataGridView).SelectedCells[0].ReadOnly;

        return;
    }

} 
```

这将获得下一个单元格的只读属性。

谢谢

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-10-23T11:33:57.820

您可以使用`BeginningEdit`事件来检查单元格是否满足条件，如果不满足则取消操作：

在下面的示例中，如果单元格已经包含一个值，它将取消操作，将其视为只读。

`xaml`：

```
<DataGrid BeginningEdit="DataGrid_BeginningEdit" ItemsSource="{Binding Example, Mode=TwoWay}"/> 
```

`c#`：

```
private void DataGrid_BeginningEdit(object sender, DataGridBeginningEditEventArgs e)
{
    string content = (e.EditingEventArgs.Source as TextBlock).Text;

    if (!(String.IsNullOrEmpty(content)))
        e.Cancel = true;
} 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-06-26T17:33:13.380

您是否可以不使用模板列而不是绑定列然后对字段的只读性有条件？

然后你可以显示一个只读标签和一个可编辑的文本框。标签不会干扰您的标签索引。

```
<asp:TemplateColumn>
  <ItemTemplate>
<%
    if ( <%# Eval( "ReadOnlyFlag" ) %> )
    { 
%>
    <asp:Label Text="<%# Eval( "BoundColumn" ) %>" />
<%
    }
    else
    {
 %>
    <asp:Textbox Text="<%# Eval( "BoundColumn" ) %>" />
<%
    }
%>
    </ItemTemplate>
</asp:TemplateColumn> 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-06-20T20:43:39.233

这里有一个非常好的示例：http:
[//blogs.msdn.com/netcfteam/archive/2006/04/25/583542.aspx](http://blogs.msdn.com/netcfteam/archive/2006/04/25/583542.aspx)

你只需要覆盖`Paint()`，我已经在紧凑的框架上使用它来根据单元格内容更改背景颜色，所以在同一张纸条上，你应该没有任何问题将它们设置为只读。

# c - 如何使用 goto 在 C 中模拟异常？

> ID：943826
> 
> 赞同：0
> 
> 时间：2009-06-03T09:26:17.817
> 
> 标签：c, exception, goto

我正在用 C 编写并发事务库，发现以下问题。让我们考虑一个示例事务成员伪代码，其中“事务”表示与事务主机的通信通道：

```
transaction = trans_join();

do_some_ops();

/* receive the data from the master */
trans_rcv(transaction, data);

do_some_ops();

trans_send(transaction, answer);

/* wait for the possibility for voting */
trans_ready(transaction);

/* vote for commiting and wait for the voting results. */
if(trans_commit(answer))
{
   printf("Final commiting the changes.\n");
}
else
{
   printf("Rolling back the changes.\n");
} 
```

在并发事务中，只有当我们被主人要求投票时，我们才能投票。但是master可以随时调用`trans_abort(member)`，强制指定成员取消事务。成员可以在执行的任何阶段接收到 ABORT 消息，在这种情况下，它不应该等到执行到达`trans_ready()`调用。例如，如果`trans_rcv()`在后面的代码中有一个调用，则该进程将一直等待来自 master 的数据，这些数据永远不会发送。

现在，重点。我已经有代码来注册回滚更改的中止函数，但我还希望有一个额外的机制，允许跳过其余的操作并立即跳转到投票代码。我有个想法在这里使用 goto 来模拟异常：

```
if(!trans_rcv()) /* fail, we received the abort message */
{
   goto abort_code;
}

...

abort_code:
trans_ready(transaction);
/* etc. */ 
```

但是，为or的每个调用编写**ifs**并不是很舒服，尤其是在事务代码很复杂的情况下。您对更好的解决方案有任何想法还是这是唯一的方法？顺便说一句，它不必使用:)。`trans_rcv``trans_send``goto`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-03T10:12:03.170

`goto`只能在一个函数内工作，这可能是异常机制的太多限制。

我建议使用`setjmp`/`longjmp`功能 - 有关详细信息，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Exception_handling_syntax#C)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T09:45:12.427

如果键入 IF 是问题，您可以使用宏，例如：

```
#define trans_rcv_CHK do { \
     if (!trans_rcv()) \
     { \
          goto abort_code; \
     } \
} while(0) 
```

如果 trans_rcv 有参数，这应该有效（至少在 gcc 中）：

```
#define trans_rcv_CHK(...) do { \
     if (!trans_rcv(__VA_ARGS__)) \
     { \
          goto abort_code; \
     } \
} while (0) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T09:51:13.257

就我个人而言，我会通过使用带有基于开关的状态机的 while 循环来编写代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T18:40:39.973

[C 中异常处理](http://www.on-time.com/ddj0011.htm)的最佳来源之一。基本上，RTOS 的人们如何为他们的 RTFile 模块实现异常。谨防文章后半部分可怕地滑入汇编语言。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T18:50:55.413

请参阅 Hanson 的“ [C 接口和实现：创建可重用软件的技术](http://www.cs.princeton.edu/software/cii/)”。它提供了一种基于`setjmp()`和的异常机制`longjmp()`。该代码可通过 MIT 许可证获得。

# c# - 明确阻止 ContextMenuStrip 在 C# 中加载

> ID：943827
> 
> 赞同：1
> 
> 时间：2009-06-03T09:26:21.060
> 
> 标签：c#, user-controls, mouseclick-event, right-mouse-button

当未设置特定标志时，我需要隐藏 contextmenustrip。由于我认为我们无法显式控制上下文菜单条的显示/隐藏，因此我决定将鼠标右键单击与上下文菜单条关联的控件。它是一个用户控件，所以我尝试处理它的 MouseClick 事件，在该事件中我检查是否设置了标志以及按钮是否为右键。然而令我惊讶的是，该事件不会在鼠标右键单击时触发，而是仅在左键单击时触发。

我有什么问题还是有任何解决方法？

**检测到右键单击，问题标题和描述已更改**

在做了更多研究之后，当我处理控件上的 Mouse_Down 事件时，我得到了右键触发。但是我仍然一无所知，因为如何*明确阻止 ContextMenuStrip From Loading*。另一个问题是，为什么 MouseClick 没有检测到右键单击？

* * *

当前的解决方法

注册事件处理程序

```
 userControl1.Control1.MouseDown += new MouseEventHandler(Control1_MouseDown);

 void Control1_MouseDown(object sender, MouseEventArgs e)
    {
        if (e.Button == MouseButtons.Right && flag == false)
        {
           userControl1.Control1.ContextMenuStrip = null;
        }
        else
        {
            userControl1.Control1.ContextMenuStrip = contextMenuStrip1;
        }

    } 
```

这是我正在做的当前解决方法。但是如何在 ContextMenuStrip 的打开事件中更改它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T09:32:57.710

当使用键盘上的上下文菜单键（或它的名称）调用上下文菜单时，您的解决方案无论如何都会失败。您可以使用该`Opening`事件取消上下文菜单的打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T09:34:07.020

有一个解决方法。

假设菜单项 A 设置了控制控件 B 上的上下文菜单的标志。

在 A 的单击事件中，您设置 b.ContextMenu = nothing 以将其关闭，并将 b.ContextMenu 设置回上下文菜单控件以将其重新打开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T09:35:17.160

在 WinForms 中还有一个`Click`事件——它会在鼠标右键单击时触发。

如果你使用的是 WPF，你应该有`MouseRightButtonDown`和`MouseRightButtonUp`事件。

查看此[MSDN 页面](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.click.aspx)上的表格，其中列出了哪些控件引发了哪些点击事件。重要的是，Button、CheckBox、RichTextBox 和 RadioButton（以及其他一些）在右键单击时不会引发和事件。

# iphone - 为什么当我触摸 UIImageView 时会出现这种奇怪的内存泄漏？

> ID：943841
> 
> 赞同：1
> 
> 时间：2009-06-03T09:32:32.547
> 
> 标签：iphone, memory-management, instruments, memory-leaks

这真的很奇怪。我有一个空白的 UIImageView 子类，它实现了 -touchesEnded:、-touchesMoved 和 -touchesBegan: 方法。这些方法的实现是空的。他们只是什么都不做。但是，当我使用“Leaks”运行 Instruments 时，我触摸 UIImageView 并将手指移到 UIImageView 之外，同时仍然触摸屏幕，我收到 Instruments 的 Memory Leak 警告。

在我的演示应用程序中，这样做时不会发生对象分配。方法是空的。我在 Instruments 中阅读的所有内容都与 Foundation 和 Run Loop 相关。我已经检查了我的班级两次并删除了任何对象分配。它只是一个只显示图像的骨架，但是当触摸它或在屏幕上移动手指时，该图像不会改变。这是没有意义的。

有没有其他人遇到过这样的问题？

**更新：**我测试了一下，发现当用 5 个手指快速敲击时，屏幕上的任何位置都会发生内存泄漏。我从 Instruments.app 得到的一切都与一些运行和事件循环有关。似乎设备无法足够快地处理触摸，然后在释放分配的对象时卡住了。如果您发现相同的问题，请尝试并在此处报告。

**更新：**我现在也测试了一些 Apple 示例应用程序。当我像普通用户一样用 3 到 5 根手指在屏幕上进行黑客攻击时（是的，他们会这样做！），然后 Instrument 会显示有关事件和运行循环的内存泄漏。在框架或工具中肯定有一个大的。使用 iPhone OS 2.2.1 测试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T10:48:36.777

正如在苹果论坛上阅读的那样，这是 SDK 中未解决的问题。当加速度计委托不为零时会发生这种情况。触摸事件对象被分配但从未被释放。调用加速计委托的速度越快，分配失败发生的速度就越快。许多苹果示例代码都显示了同样的问题。我打开了加速度计。

但我也遇到过，当触摸从一个视图跟踪到另一个视图时，就会发生这种泄漏。如果我一直触摸同一个视图并在该视图上移动手指而不离开它，我就不会遇到这个问题。

解决方案：关闭加速计（delegate 设置为 nil），减少应用中的视图数量。我不知道他们是否在 iPhone OS 3.0 中解决了这个问题。

不幸的是，这无济于事：

```
- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [[UIAccelerometer sharedAccelerometer] setDelegate:nil]; // because of framework bug
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    [[UIAccelerometer sharedAccelerometer] setDelegate:self]; // because of framework bug
}

- (void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event {
    [[UIAccelerometer sharedAccelerometer] setDelegate:self]; // because of framework bug
} 
```

更多信息请访问：[http ://discussions.apple.com/thread.jspa?messageID=9396584t](http://discussions.apple.com/thread.jspa?messageID=9396584)

# apache-flex - HTTP服务帮助

> ID：943849
> 
> 赞同：0
> 
> 时间：2009-06-03T09:38:08.277
> 
> 标签：apache-flex

我的 Flex 代码无法访问 PHP，但是当我正常访问时，它就像

[http://localhost/search/populate.php?urlWeb=http://www.google.com](http://localhost/search/populate.php?urlWeb=http://www.google.com)

```
$url = addslashes( $_GET['urlWeb'] );

if( !$url )
{
   die( "You need to define a URL to process." );
}
else if( substr($url,0,7) != "http://" )
{
   $url = "http://$url";
   $output = "<loginsuccess>";
   $output .="yes";
   $output .= "</loginsuccess>";
   print($output);
} 
```

```
<mx:HTTPService id="addWeb" resultFormat="object" result="Added(event)" showBusyCursor="true" method="GET" url="http://localhost/search/populate.php" useProxy="false">
        <mx:request xmlns="">
            <urlWeb>
                {urlWeb.text}
            </urlWeb>
        </mx:request>
    </mx:HTTPService> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-17T19:39:44.637

这可能是 crossdomain.xml 问题。尝试放置一个包含以下内容的 crossdomain.xml 文件 ( [http://localhost/crossdomain.xml )：](http://localhost/crossdomain.xml)

```
<?xml version="1.0"?>

<cross-domain-policy>

    <allow-access-from domain="*" to-ports="*" secure="false" />

</cross-domain-policy> 
```

并再次运行该应用程序。如果它仍然不起作用，您能否将故障处理程序添加到您的 HTTPService 中，检查您是否有错误以及是否将其发布在这里以便我们查看问题所在？

# c# - 如何在 C# 中发送 HTTPS GET 请求

> ID：943852
> 
> 赞同：51
> 
> 时间：2009-06-03T09:38:38.400
> 
> 标签：c#, .net, ssl, httpwebrequest

> 相关：[我如何使用 webrequest-to-access-an-ssl-encrypted-site-using-https](https://stackoverflow.com/questions/560804/how-do-i-use-webrequest-to-access-an-ssl-encrypted-site-using-https)

如何在 C# 中发送 HTTPS GET 请求？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-06-03T09:45:40.850

添加`?var1=data1&var2=data2`到 url 的末尾以通过 GET 向页面提交值：

```
using System.Net;
using System.IO;

string url = "https://www.example.com/scriptname.php?var1=hello";

HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
HttpWebResponse response = (HttpWebResponse)request.GetResponse();
Stream resStream = response.GetResponseStream(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T19:42:55.447

我更喜欢使用 WebClient，它似乎可以透明地处理 SSL：

[http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)

这里有一些故障排除帮助：

[https://clipperhouse.com/webclient-fiddler-and-ssl/](https://clipperhouse.com/webclient-fiddler-and-ssl/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-12T09:44:53.520

使用 HttpClient 类的简单获取请求

```
using System.Net.Http;

class Program
{
   static void Main(string[] args)
    {
        HttpClient httpClient = new HttpClient();
        var result = httpClient.GetAsync("https://www.google.com").Result;
    }

} 
```

# maven-2 - mvn archetype:generate Error building POM（可能不是这个项目的POM）

> ID：943853
> 
> 赞同：0
> 
> 时间：2009-06-03T09:39:49.473
> 
> 标签：maven-2, pom.xml

我正在尝试从一个 spring 项目中创建一个 jsf+spring+hibernate。以下是我已采取的步骤。我过去曾使用相同的方法成功地创建项目。我不知道我在哪里犯了错误。

寻找所有提示，我哪里出错了。

注意：我已将输入和错误消息设为粗体。

M:\SCHOLION\SPRING\maven> **mvn 原型：生成**

```
Choose a number:  (1/2/3/4/5/6/7/8/9/10/11/12/13/14/15/16/17/18/19/20/21/22/23/24/25/26/27/28/29/30/31/32/33/34/35/36/37/38/39/40/41/42/43/
**Define value for groupId: : com.unibz
Define value for artifactId: : springacltutorial
Define value for version:  1.0-SNAPSHOT: : 1.0
Define value for package: : springacltutorial
Confirm properties configuration:
groupId: com.unibz
artifactId: springacltutorial
version: 1.0
package: springacltutorial**
 Y: : y
[INFO] ----------------------------------------------------------------------------
[INFO] Using following parameters for creating OldArchetype: appfuse-basic-jsf:2.0
[INFO] ----------------------------------------------------------------------------
[INFO] Parameter: groupId, Value: com.unibz
[INFO] Parameter: packageName, Value: springacltutorial
[INFO] Parameter: package, Value: springacltutorial
[INFO] Parameter: artifactId, Value: springacltutorial
[INFO] Parameter: basedir, Value: M:\SCHOLION\SPRING\maven
[INFO] Parameter: version, Value: 1.0
 ********************* End of debug info from resources from generated POM ***********************
[INFO] OldArchetype created in dir: M:\SCHOLION\SPRING\maven\springacltutorial
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESSFUL
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 2 minutes 1 second
[INFO] Finished at: Wed Jun 03 11:15:59 CEST 2009
[INFO] Final Memory: 8M/15M
[INFO] ------------------------------------------------------------------------

M:\SCHOLION\SPRING\maven>cd springacltutorial

M:\SCHOLION\SPRING\maven\springacltutorial>dir
 Volume in drive M is Data
 Volume Serial Number is 76A4-1C35

 Directory of M:\SCHOLION\SPRING\maven\springacltutorial

03.06.09  11:15    <DIR>          .
03.06.09  11:15    <DIR>          ..
03.06.09  11:15            32.930 pom.xml
03.06.09  11:15               826 README.txt
03.06.09  11:15    <DIR>          src
               2 File(s)         33.756 bytes
               3 Dir(s)   8.521.940.992 bytes free

M:\SCHOLION\SPRING\maven\springacltutorial>**mvn compile**

[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] **Error building POM (may not be this project's POM).**

Project ID: org.appfuse:maven-warpath-plugin

Reason: POM 'org.appfuse:maven-warpath-plugin' not found in repository: Unable to download the artifact from any repository

  org.appfuse:maven-warpath-plugin:pom:2.0-SNAPSHOT

[INFO] ------------------------------------------------------------------------
[INFO] For more information, run Maven with the -e switch
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1 second
[INFO] Finished at: Wed Jun 03 11:16:12 CEST 2009
[INFO] Final Memory: 1M/4M
[INFO] ------------------------------------------------------------------------ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T09:47:10.457

您生成的项目取决于 org.appfuse:maven-warpath-plugin 您需要安装或提供存储库以首先从中获取。

在中央仓库中有这个插件的 2.0.2 最新版本： [http ://repo1.maven.org/maven2/org/appfuse/maven-warpath-plugin/](http://repo1.maven.org/maven2/org/appfuse/maven-warpath-plugin/)

如果不存在，请尝试在 maven-warpath-plugin 声明中明确指定此版本。

# jquery - 空的浮动图表？

> ID：943855
> 
> 赞同：1
> 
> 时间：2009-06-03T09:41:16.273
> 
> 标签：jquery, flot, bar-chart

我正在运行下面的代码并使用 Flot/jQuery 获取一个空图表。理想情况下，我所追求的是数据的条形图。我不高兴地看着这一切——有人有什么想法吗？

```
<div id="user_breakdown_placeholder" style="width:300px;height:300px"></div>

<script>
    $(function () {
        var d = [["Unassigned", 310],["Maynard Schumm", 274]];
            var options = {};
        $.plot($("#user_breakdown_placeholder"), d, options);
    });

</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-05T21:37:18.900

当前版本的 flot (v. 0.6) 支持条形图。这是一个[例子](http://people.iola.dk/olau/flot/examples/graph-types.html)。在您的 plot() 函数中，您只需输入：

```
bars: { show: true} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-10T14:15:23.530

一个老问题，但我认为它没有得到回答。根据 Flot API 文档：

> 请注意，为了简化 Flot 中的内部逻辑，x 和 y 值都必须是数字……如果您遇到神秘错误，请仔细检查您输入的是数字而不是字符串。

如果在上述情况下，您在数据中使用了字符串（例如 ["Unassigned", 310]），根据文档，这将不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-25T02:04:03.510

你可以这样做，但你只需要稍微伪造你的数据。

```
$(function () {
    var data = [[0, 310],[1,274]];
    var datasets = [ {
                 "data": data
                     }, 
                   ];
    var options = {
                   bars: {show: true},
                   yaxis: { min: 0 },
                   xaxis: { ticks:  [
                                     [0.5, "Unassigned"],
                                     [1.5, "Maynard Schumm"]
                                    ],
                          },
                  };
   $.plot($("#user_breakdown_placeholder"), datasets, options);
}); 
```

------>

![替代文字](https://i.stack.imgur.com/fI7Iy.png)

大概您可以在将数据传递给 Flot 之前适当地修改数据。

[FlotUsage](http://code.google.com/p/flot/wiki/FlotUsage)有很多很好的实际使用示例。例如[Fedora](https://admin.fedoraproject.org/updates/metrics/)有一些不错的条形图。最棒的是因为它是 JavaScript，您可以查看任何人的源代码和婴儿床想法 :)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T10:24:25.703

正如 Neil Middleton 在评论中所说，Flot 不支持条形图。

也许[这个](http://www.maxb.net/scripts/jgcharts/include/demo/)或[这个](http://www.dumpsterdoggy.com/articles/?jquery-horizontal-bar-graph)插件可以帮助你？

# iphone - 在处理加载图像时

> ID：943859
> 
> 赞同：0
> 
> 时间：2009-06-03T09:42:29.720
> 
> 标签：iphone

我调用了一个 javascript 函数，在等待返回结果时我想加载一个动画图像（比如：请稍候......）。

```
//step1\. call javascript
 NSString *resultMess = [webView stringByEvaluatingJavaScriptFromString:_scriptMethod];

//step2\. want to load animation while waiting

//step3\. after finish -> send alert 
```

. 我该怎么做 stept2 和 step3 ？

太感谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-04T02:23:47.980

您可以开始一个新线程。在你开始你的 javascript 函数之前添加这个

```
[NSThread detachNewThreadSelector:@selector(loadAnimation) toTarget:self withObject:nil]; 
```

然后添加任何你想要的动画......

```
- (void)loadAnimation {

//Animation stuff here
} 
```

您可以尝试在您的 javascript 内容之后立即运行“第 3 步”。所以在所有你会

```
 - (void)someMethod {
    //start your animation 
    [NSThread detachNewThreadSelector:@selector(loadAnimation) toTarget:self withObject:nil];
    //run javascript
    NSString *resultMess = [webView stringByEvaluatingJavaScriptFromString:_scriptMethod];

    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"title" message:@"message" cancelButtonTitle:@"Okay" otherButtonTitles:nil];
[alert show]

    } 
```

如果 javascript 导致您的应用程序停止，那么在完成之前不应弹出警报。

# python - 使用 COM 连接到正在运行的 Visual Studio 2003 实例，构建并读取输出

> ID：943863
> 
> 赞同：1
> 
> 时间：2009-06-03T09:43:16.970
> 
> 标签：python, visual-studio, com

对于 Visual Studio 6.0，我可以连接到一个正在运行的实例，例如：

```
o = GetActiveObject("MSDev.Application") 
```

*   我在 Visual Studio 2003 中使用什么 prog ID？
*   拥有引用 VS2003 实例的 COM 对象后，如何执行“构建解决方案”？
*   执行构建解决方案命令后如何获取构建输出窗口的字符串内容？

是的，我知道我可以从命令行构建解决方案。但在这种情况下，我需要连接到正在运行的 Visual Studio 实例。

编辑：找到并提交了答案，见下文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T10:19:43.153

经过一番研究（主要看 EnvDTE 文档），我自己找到了解决方案：

要构建当前解决方案（Python 中的代码）：

```
def build_active_solution(progid="VisualStudio.DTE.7.1"):
    from win32com.client import GetActiveObject
    dte = GetActiveObject(progid)
    sb = dte.Solution.SolutionBuild
    sb.Build(True)

    output = dte.Windows['Output'].Object.ActivePane.TextDocument.Selection
    output.SelectAll()
    return output.Text 
```

# delphi - 德尔福 2009 中的 Zlib

> ID：943867
> 
> 赞同：3
> 
> 时间：2009-06-03T09:44:36.110
> 
> 标签：delphi, soap, delphi-2009, zlib, compression

我正在将应用程序升级到 Delphi 2009。该应用程序使用 Soap，我们使用 Zlib 压缩肥皂请求和响应流。这在 Delphi 2006 中运行良好，但在 Delphi 2009 中却不行。

所以我回到Delphi 2006，改用FastZlib。它在 Delphi2006 中一切正常，但在 Delphi 2009 中不起作用，我得到解压缩错误。

有没有其他人有这个问题？

我该如何解决这个问题？

桑迪普

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-11T21:38:54.257

可能值得尝试的东西 - 压缩您的数据，然后对其进行 UUENCODE，然后在另一端反转该过程。这将检测某些代码是否没有正确处理嵌入的零。

抱歉，这只是帮助您缩小问题范围的部分解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T04:32:30.757

在 D2009 中你可以使用 ZCompress/ZDecompress 代替 CompressBuf/DecompressBuf
我测试它没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T12:39:25.260

我刚刚查看了内置的 Zlib.pas，它似乎已针对 D2009 进行了正确更新。什么给你带来问题？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T21:49:46.800

在 delphi 2006 中，我有以下使用 Zlib 压缩和解压缩的方法（来自 Delphi 2006）

```
procedure CompressStream(inpStream, outStream: TStream);
var
  InpBuf, OutBuf: Pointer;
  InpBytes, OutBytes: Integer;
begin
  InpBuf := nil;
  OutBuf := nil;
  try
    GetMem(InpBuf, inpStream.Size);
    inpStream.Position := 0;
    InpBytes := inpStream.Read(InpBuf^, inpStream.Size);
    CompressBuf(InpBuf, InpBytes, OutBuf, OutBytes);
    outStream.Write(OutBuf^, OutBytes);
  finally
    if InpBuf <> nil then FreeMem(InpBuf);
    if OutBuf <> nil then FreeMem(OutBuf);
  end;
end;

{ Decompress a stream }
procedure DecompressStream(inpStream, outStream: TStream);
var
  InpBuf, OutBuf: Pointer;
  OutBytes, sz: Integer;
begin
  InpBuf := nil;
  OutBuf := nil;
  sz     := inpStream.Size - inpStream.Position;
  if sz > 0 then 
    try
      GetMem(InpBuf, sz);
      inpStream.Read(InpBuf^, sz);
      DecompressBuf(InpBuf, sz, 0, OutBuf, OutBytes);
      outStream.Write(OutBuf^, OutBytes);
    finally
      if InpBuf <> nil then FreeMem(InpBuf);
      if OutBuf <> nil then FreeMem(OutBuf);
    end;
  outStream.Position := 0;
end; 
```

我应该改变什么才能在 Delphi 2009 中工作？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-25T16:29:03.177

原始海报清楚地说明了这个问题：CompressBuf 和 DecompressBuf 都消失了。

我还有一个项目在 D7 中编译得很好，但在 D2010 中编译失败，因为它找不到“CompressBuf”或“DecompressBuf”。

使用 D7 非常令人愉快的 find 命令进行搜索，将例程定位在 c:\Program Files\Borland\Delphi7\Source\Rtl\Common\ZLib.pas

但是使用 D2010 的（单独的尴尬）“在文件中查找”命令搜索无法在任何地方找到 CompressBuf 或 DecompressBuf。

升级 IDE 会导致项目中使用和需要的例程消失，这非常令人不安！

# c# - 正则表达式检测字符串中的重复

> ID：943872
> 
> 赞同：8
> 
> 时间：2009-06-03T09:45:17.607
> 
> 标签：c#, regex

是否可以使用正则表达式检测重复的数字模式？

因此，例如，如果我有以下字符串“034503450345”，是否可以匹配重复的序列 0345？我有一种感觉，这超出了正则表达式的范围，但我想我还是会在这里问，看看我是否遗漏了什么。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-06-03T10:00:29.543

此表达式将匹配一个或多个重复组：

```
(.+)(?=\1+) 
```

这是分解的相同表达式（使用注释，因此它仍然可以直接用作正则表达式）。

```
(?x)  # enable regex comment mode
(     # start capturing group
.+    # one or more of any character (excludes newlines by default)
)     # end capturing group
(?=   # begin lookahead
\1+   # match one or more of the first capturing group
)     # end lookahead 
```

要匹配特定模式，请将 更改`.+`为该模式，例如`\d+`一个或多个数字，或`\d{4,}`匹配 4 个或更多数字。

要匹配特定数量的模式，请将 更改为`\1+`，例如`\1{4}`重复四次。

要允许重复不相邻，您可以`.*?`在前瞻内添加。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-03T09:49:15.273

是的，你可以——这是一个 Python 测试用例

```
import re
print re.search(r"(\d+).*\1", "8034503450345").group(1)
# Prints 0345 
```

正则表达式说“找到一些数字序列，然后是任意数量的其他东西，然后再次找到相同的序列。”

在几乎不相关的注释中，这是我最喜欢的正则表达式之一 - 质数检测器：

```
import re
for i in range(2, 100):
    if not re.search(r"^(xx+)\1+$", "x"*i):
        print i 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-06-03T10:12:55.943

只是为 RichieHindle 的（正确）答案添加注释：

请注意，虽然 Python 的正则表达式实现（以及许多其他实现，例如 Perl 的）可以做到这一点，但这不再是狭义上的正则表达式。

您的示例不是正则语言，因此不能由纯正则表达式处理。有关详细信息，请参见例如出色的[Wikipedia 文章](http://en.wikipedia.org/wiki/Regular_expression)。

虽然这主要只是学术兴趣，但也有一些实际后果。与这种情况相比，真正的正则表达式可以更好地保证最大运行时间。因此，您可能会在某些时候遇到性能问题。

并不是说这不是一个好的解决方案，但您应该意识到您正处于正则表达式（即使是扩展形式）能力的极限，并且可能希望在出现问题时考虑其他解决方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-03T10:17:23.937

这是 C# 代码，它使用反向引用构造来查找重复的数字。它将与 034503450345、123034503450345、034503450345345、232034503450345423 一起使用。正则表达式更容易理解。

```
/// <summary>
/// Assigns repeated digits to repeatedDigits, if the digitSequence matches the pattern
/// </summary>
/// <returns>true if success, false otherwise</returns>
public static bool TryGetRepeatedDigits(string digitSequence, out string repeatedDigits)
{
    repeatedDigits = null;

    string pattern = @"^\d*(?<repeat>\d+)\k<repeat>+\d*$";

    if (Regex.IsMatch(digitSequence, pattern))
    {
        Regex r = new Regex(pattern, RegexOptions.IgnoreCase | RegexOptions.Compiled);
        repeatedDigits = r.Match(digitSequence).Result("${repeat}");
        return true;
    }
    else
        return false;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-13T17:22:16.157

使用正则表达式重复： bar{2,} 查找具有两个或多个 bar 的文本： barbar barbarbar ...

# url - 在 Groovy 中连接到 URL 并转储网页

> ID：943873
> 
> 赞同：43
> 
> 时间：2009-06-03T09:45:29.150
> 
> 标签：url, groovy, webpage, dump

我想从 groovy 打开一个网页，转储指定的网页并最终将网页转储到锚标签后面。

有人有一些示例代码吗？

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2009-06-05T00:00:33.213

这是一个变化

```
println 'http://www.google.com'.toURL().text 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2009-06-03T10:02:04.373

这是一个很好的例子

[http://docs.codehaus.org/display/GROOVY/Simple+file+download+from+URL](http://docs.codehaus.org/display/GROOVY/Simple+file+download+from+URL)

基本上你想做类似的事情

```
def data = new URL(feedUrl).getText() 
```

# c# - 围绕 SqlTransaction 回滚的异常处理

> ID：943876
> 
> 赞同：4
> 
> 时间：2009-06-03T09:45:41.520
> 
> 标签：c#, .net, sql, transactions

我有两个要在事务中执行的存储过程。由于各种原因，我需要在我的应用程序代码中而不是在数据库中处理事务。

目前，我的代码如下所示：

```
try
{
    using (SqlConnection conn = Connection())
    {
        conn.Open();

        using (SqlTransaction sqlTrans = conn.BeginTransaction())
        {
            try
            {
                using (SqlCommand cmd1 = new SqlCommand("Stored_Proc_1", conn, sqlTrans))
                {
                    cmd1.CommandType = CommandType.StoredProcedure;
                    cmd1.ExecuteNonQuery();
                }

                using (SqlCommand cmd2 = new SqlCommand("Stored_Proc_2", conn, sqlTrans))
                {
                    cmd2.CommandType = CommandType.StoredProcedure;
                    cmd2.ExecuteNonQuery();
                }

                sqlTrans.Commit();
            }
            catch
            {
                    sqlTrans.Rollback();

                    throw;
            }

        }

        conn.Close();
    }
}

catch (SqlException ex)
{
  // exception handling and logging code here...
} 
```

当其中一个存储过程引发错误时，我看到的异常消息如下所示：

```
Error message from raiserror within stored procedure.
Transaction count after EXECUTE indicates that a COMMIT or ROLLBACK TRANSACTION statement is missing. Previous count = 1, current count = 0. 
```

这是有道理的，因为在第一次捕获时，事务还没有回滚。

但是我想要我的异常处理代码有一个“干净”的错误（没有 tran count 消息 - 我对此不感兴趣，因为我*正在*回滚事务）。有没有办法可以重组我的代码来实现这一点？

**编辑：**

我的存储过程的基本结构如下所示：

```
create proc Stored_Proc_1
as

set nocount on

begin try
    begin transaction 

        raiserror('Error raised by Stored_Proc_1', 16, 1)       

    commit

end try
begin catch  
    if (@@trancount > 0) rollback   

    declare @ErrMsg nvarchar(4000), @ErrSeverity int, @ErrProc sysname, @ErrLine varchar(10)
    select @ErrMsg = ERROR_MESSAGE(), @ErrSeverity = ERROR_SEVERITY(), @ErrProc = ERROR_PROCEDURE(), @ErrLine = ERROR_LINE()

    -- log the error 
    -- sql logging code here...

    raiserror(@ErrMsg, @ErrSeverity, 1) 
end catch 
```

**更新：** 我已经从我的存储过程中取出了事务处理，这似乎已经解决了这个问题。显然我做错了——但我仍然想知道如何做对。从存储过程中删除事务是最好的解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T09:50:08.953

好吧，`conn.Close()`无论如何都可以去 - 它会被关闭`using`（如果你考虑一下，奇怪的是我们只`Close()`在异常之后才使用它）。

您的任何一个存储过程是否在其内部执行任何事务代码（未回滚/提交）？听起来问题*出*在哪里……？如果有的话，错误消息向我表明其中一个存储过程正在执行，`COMMIT`即使它没有启动事务 - 可能是由于（不正确的）方法：

```
-- pseduo-TSQL
IF @@TRANCOUNT = 0 BEGIN TRAN
-- ...
IF @@TRANCOUNT > 0 COMMIT TRAN -- or maybe = 1 
```

（如果您在 TSQL 中执行条件事务，您应该（通过 bool 标志）跟踪您是否创建了事务 - 并且仅`COMMIT`当您这样做时）

另一个选项是使用`TransactionScope`- 更易于使用（您不需要针对每个命令进行设置等），但效率*稍低：*

```
using(TransactionScope tran = new TransactionScope()) {
    // create command, exec sp1, exec sp2 - without mentioning "tran" or
    // anything else transaction related

    tran.Complete();
} 
```

（注意没有回滚等；`Dispose()`(via `using`) 将在需要时进行回滚。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T10:09:55.093

如果您在应用程序中执行此操作，请不要在您的数据库/存储过程中执行事务！这肯定只会造成混乱。选择一层并坚持下去。确保你有一个很好的标准化数据库，并且异常应该向上渗透。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T09:57:12.730

我同意 Marc 的观点，即问题可能出在存储过程本身。[有一篇非常有趣的文章在这里](http://www.code-magazine.com/articleprint.aspx?quickid=0305111&page=1&printmode=true)概述了一些问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-11T11:25:44.660

如果存储过程包含如下代码：

```
BEGIN TRY
    SET @now = CAST(@start AS datetime2(0))
END TRY
BEGIN CATCH
    SET @now = CURRENT_TIMESTAMP
END CATCH 
```

并且您将例如“now”作为@start 传递，try 中的 CAST 将失败。即使错误本身已被捕获和处理，这也将事务标记为回滚。因此，尽管您从上述代码中没有发现异常，但无法提交事务。如果您的存储过程有这样的代码，则需要对其进行重写以避免 try/catch。

# php - PHP中结果为空的条件

> ID：943877
> 
> 赞同：0
> 
> 时间：2009-06-03T09:45:42.693
> 
> 标签：php

```
$output = "<loginsuccess>";

for( $i = 1; $row = mysql_fetch_array($result); $i++ )          {

$output .="<keyword>".$_POST['keyword']."</keyword><name>".$row['url']."</name><occur>".$row['occurrences']."</occur><queryTime>".(substr($end_time-$start_time,0,5))."</queryTime>";
}

$output .= "</loginsuccess>"; 
```

我现在需要一个简单的条件，如果结果为空，那么我需要在 xml [登录成功] 中返回 no。

这是正确的方法吗......

```
if($row = mysql_fetch_array($result))          {

for( $i = 1; $row = mysql_fetch_array($result); $i++ )          {

$output .="<keyword>".$_POST['keyword']."</keyword><name>".$row['url']."</name><occur>".$row['occurrences']."</occur><queryTime>".(substr($end_time-$start_time,0,5))."</queryTime>";
} } else { 
    $output.="no"; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T09:48:45.807

```
if (mysql_num_rows($result) == 0) { 
  $output .= '<loginsuccess>no</loginsuccess>';
} else {
  // your code
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T09:50:04.553

试试这个：

```
$i = 1;

while($row = mysql_fetch_array($result))
{
    $output .="<keyword>".$_POST['keyword']."</keyword><name>".$row['url']."</name><occur>".$row['occurrences']."</occur><queryTime>".(substr($end_time-$start_time,0,5))."</queryTime>";

    $i++;
}

if ($i == 1)
    $output .= "no"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T10:24:58.243

只是一个简短的说明，我会做 Schnalle 所做的事情，但在你的代码中，我会将 for 循环更改为 while 循环，因为你没有对 $i 做任何事情

```
while($row = mysql_fetch_row($result)){ 
```

总的来说，我会给你写这样的代码：

```
$output = '<loginsucces>';
if(mysql_num_rows($result)){
  while($row = mysql_fetch_row($result)){
    $output .="<keyword>".$_POST['keyword']."</keyword><name>".$row['url']."</name><occur>".$row['occurrences']."</occur><queryTime>".(substr($end_time-$start_time,0,5))."</queryTime>";
  }
} else {
  $output .= 'no';
}
$output .= '</loginsucces>'; 
```

此外，最好不要混合逻辑和输出，但在这种情况下那将是矫枉过正。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T09:50:52.773

`for`当没有行时，不会简单地跳过 -loop 吗？否则，您可能希望使用[`mysql_num_rows`](http://php.net/manual/en/function.mysql-num-rows.php)来计算结果集中的行数。

# asp.net-mvc - 如何在 VB.NET 中定义 RouteTable？

> ID：943880
> 
> 赞同：0
> 
> 时间：2009-06-03T09:46:54.780
> 
> 标签：asp.net-mvc, vb.net, routetable

[Route Table 1][1] 此图显示了如何使用 Route 类在 C# 中定义 RouteTable。如何在 VB.NET 中定义它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T13:13:11.713

我看到你问了几个关于代码转换的问题。有一些免费工具可以帮助解决这个问题，例如：

[http://codechanger.com/](http://codechanger.com/)

比等别人帮你翻译要快。有一些语言特性没有得到很好的处理，但它适用于大多数代码。

另外，你的图片链接坏了，所以我看不到帮助翻译的代码。

# java - 如何编写高效的Java代码？

> ID：943883
> 
> 赞同：18
> 
> 时间：2009-06-03T09:48:11.220
> 
> 标签：java, optimization, compiler-construction, jvm

众所周知，Java 代码是由 JVM 编译和解释的。我的问题涉及优化：它是仅在运行时由 JVM 优化还是在编译时优化？

为了编写高效的代码，我在哪里可以找到支持的优化列表？或者 JVM 优化是否足够强大，以至于我只需要编写可读且易于维护的代码，而不管速度性能如何？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-03T09:52:51.600

大多数优化是由 JVM 完成的。JIT 级别的优化空间通常比编译时更大。（“优化”标志实际上已从 中删除`javac`，因为事实证明某些“优化”实际上会损害现实世界中的性能。）

一般来说（这适用于许多语言/平台，而不仅仅是 Java）：

*   编写尽可能易读和可维护的代码。
*   制定绩效目标和基准，这样您就可以随时衡量绩效
*   努力使您的*架构*发挥作用；以后很难改变（与改变实现相比）
*   更多地从算法复杂性的角度考虑性能，而不是“让它快 10%”：从 O(n^2) 到 O(n) 的变化（通常）要重要得多。（这在很大程度上取决于现实世界的使用情况 - 如果您只处理 的小值`n`，“理论上更好”的算法很容易由于恒定因素而最终变慢。）
*   使用分析器确定瓶颈在哪里
*   只有在分析器建议值得做时，才以可读性为代价进行微优化
*   在这样的优化之后测量——你实际上可能没有太大的影响，在这种情况下回滚

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-03T09:54:45.980

Java HotSpot JIT 编译器可以检测“热点”并自适应地修改正在执行的代码，从而提供更好的性能。[在这里](http://java.sun.com/products/hotspot/whitepaper.html)阅读。

另一方面，如果您想编写高效的代码，请阅读Robert Simmons的“ [Hardcore Java](http://oreilly.com/catalog/9780596005689) ”或Brian Goetz 的“ [Java Concurrency in Practice ”等书籍。](http://www.javaconcurrencyinpractice.com/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-03T09:50:34.833

我肯定会选择编写代码以提高可读性和可维护性，而不是所谓的优化。

过早的优化通常被视为一件坏事。 [http://en.wikipedia.org/wiki/Optimization_(computer_science)#When_to_optimize](http://en.wikipedia.org/wiki/Optimization_(computer_science)#When_to_optimize)

当然，使用分析工具测量和证明瓶颈完全是另一回事。如果您这样做并且可以证明存在需要优化的领域，那么您可以衡量收益并继续优化。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-03T10:01:20.040

> 它是仅在运行时由 JVM 优化还是在编译时优化？

Java 编译器通常只做很少的优化（除了解析复合文字），因为“优化的”字节码可能会阻碍 JIT 编译器的优化能力——这才是真正重要的地方。

> 或者 JVM 优化是否足够强大，以至于我只需要编写可读且易于维护的代码，而不管速度性能如何？

这不是相信 JVM 会比你做的更好的优化问题（尽管这绝对是一个因素），而是优化问题在 95% 的情况下完全无关紧要，因为代码不经常执行。如果一段代码占应用程序执行时间的 0.1%，那根本不值得费心。即使你可以将它加速 100 倍，它也不会给你带来任何好处。这是最常见的情况。

只要您避免明显愚蠢的事情，您就应该忘记优化，直到您遇到具体的性能问题，然后只优化分析器告诉您代码中热点的代码片段。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-09T19:19:13.917

尽管这些提示是针对 Google Android 的特定 Java 实现的，但我猜[这些 Google Android 性能提示](http://developer.android.com/guide/practices/design/performance.html)也适用于“普通”JVM。请注意，据我所知，Android 的 Java 不会在运行时优化代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T10:12:38.347

不用担心特定的 JVM 优化。这些细节因版本而异。

购买 Josh Bloch 的“Effective Java”书——这是关于这个主题的最好的书。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2017-01-30T14:15:50.750

JVM 优化因版本而异。

# java - 如何在 ehcache.xml 中配置 QueryCache

> ID：943888
> 
> 赞同：0
> 
> 时间：2009-06-03T09:49:03.263
> 
> 标签：java, xml, hibernate, ehcache, second-level-cache

从我的 sql 日志文件中，我认为 QueryCache 的物理属性是由元素配置的：

```
 <defaultCache
                maxElementsInMemory="0"
                eternal="false"
                timeToIdleSeconds="120"
                timeToLiveSeconds="120"
                overflowToDisk="false"
                memoryStoreEvictionPolicy="LRU"
                /> 
```

**甚至我在ehcache.xml**中添加了另一个元素，从 sql 日志看来，QueryCache 的物理属性仍然由*元素。*

 *```
 <cache name="org.hibernate.cache.QueryCache"
                maxElementsInMemory="10000"
                eternal="false"
                timeToIdleSeconds="120"
                timeToLiveSeconds="120"
                overflowToDisk="false"
                memoryStoreEvictionPolicy="LRU"
        /> 
```

我只想在内存中启用 QueryCache，同时默认禁用其他（在内存中）。也许是*name*属性*元素不正确？我从书<>复制它。或者，我应该使用除 之外的其他元素吗？也许有一种元素？*

 *谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-03T09:54:32.470

试试：name="org.hibernate.cache.StandardQueryCache"

# c# - 如何获取 WPF 中的内置路由事件列表

> ID：943898
> 
> 赞同：7
> 
> 时间：2009-06-03T09:51:48.717
> 
> 标签：c#, .net, wpf, events, xaml

我刚开始使用 WPF，需要一些有关路由事件的帮助。我添加了一个带有一些动画的数据网格，但我似乎找不到任何地方可以显示要在数据网格上使用的路由事件列表，或者任何其他控件。到目前为止似乎是一个猜谜游戏。

我认为数据网格标准事件，例如 CellEditEnding，是它，但它们不是它所说的“无效事件名称”。

我复制的示例使用了 MouseEnter 路由事件，但我不知道还有什么可供我使用（当然除了我自己的）。

```
<Window.Triggers>
    <EventTrigger RoutedEvent="my:DataGrid.MouseEnter">
        <BeginStoryboard Storyboard="{StaticResource MyAnimation}"/>
    </EventTrigger>
</Window.Triggers> 
```

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-06-11T14:35:17.983

这是清单...

```
[0]: {FrameworkElement.RequestBringIntoView}
[1]: {FrameworkElement.SizeChanged}
[2]: {FrameworkElement.Loaded}
[3]: {FrameworkElement.Unloaded}
[4]: {ToolTipService.ToolTipOpening}
[5]: {ToolTipService.ToolTipClosing}
[6]: {ContextMenuService.ContextMenuOpening}
[7]: {ContextMenuService.ContextMenuClosing}
[8]: {Mouse.PreviewMouseDown}
[9]: {Mouse.MouseDown}
[10]: {Mouse.PreviewMouseUp}
[11]: {Mouse.MouseUp}
[12]: {UIElement.PreviewMouseLeftButtonDown}
[13]: {UIElement.MouseLeftButtonDown}
[14]: {UIElement.PreviewMouseLeftButtonUp}
[15]: {UIElement.MouseLeftButtonUp}
[16]: {UIElement.PreviewMouseRightButtonDown}
[17]: {UIElement.MouseRightButtonDown}
[18]: {UIElement.PreviewMouseRightButtonUp}
[19]: {UIElement.MouseRightButtonUp}
[20]: {Mouse.PreviewMouseMove}
[21]: {Mouse.MouseMove}
[22]: {Mouse.PreviewMouseWheel}
[23]: {Mouse.MouseWheel}
[24]: {Mouse.MouseEnter}
[25]: {Mouse.MouseLeave}
[26]: {Mouse.GotMouseCapture}
[27]: {Mouse.LostMouseCapture}
[28]: {Mouse.QueryCursor}
[29]: {Stylus.PreviewStylusDown}
[30]: {Stylus.StylusDown}
[31]: {Stylus.PreviewStylusUp}
[32]: {Stylus.StylusUp}
[33]: {Stylus.PreviewStylusMove}
[34]: {Stylus.StylusMove}
[35]: {Stylus.PreviewStylusInAirMove}
[36]: {Stylus.StylusInAirMove}
[37]: {Stylus.StylusEnter}
[38]: {Stylus.StylusLeave}
[39]: {Stylus.PreviewStylusInRange}
[40]: {Stylus.StylusInRange}
[41]: {Stylus.PreviewStylusOutOfRange}
[42]: {Stylus.StylusOutOfRange}
[43]: {Stylus.PreviewStylusSystemGesture}
[44]: {Stylus.StylusSystemGesture}
[45]: {Stylus.GotStylusCapture}
[46]: {Stylus.LostStylusCapture}
[47]: {Stylus.StylusButtonDown}
[48]: {Stylus.StylusButtonUp}
[49]: {Stylus.PreviewStylusButtonDown}
[50]: {Stylus.PreviewStylusButtonUp}
[51]: {Keyboard.PreviewKeyDown}
[52]: {Keyboard.KeyDown}
[53]: {Keyboard.PreviewKeyUp}
[54]: {Keyboard.KeyUp}
[55]: {Keyboard.PreviewGotKeyboardFocus}
[56]: {Keyboard.GotKeyboardFocus}
[57]: {Keyboard.PreviewLostKeyboardFocus}
[58]: {Keyboard.LostKeyboardFocus}
[59]: {TextCompositionManager.PreviewTextInput}
[60]: {TextCompositionManager.TextInput}
[61]: {DragDrop.PreviewQueryContinueDrag}
[62]: {DragDrop.QueryContinueDrag}
[63]: {DragDrop.PreviewGiveFeedback}
[64]: {DragDrop.GiveFeedback}
[65]: {DragDrop.PreviewDragEnter}
[66]: {DragDrop.DragEnter}
[67]: {DragDrop.PreviewDragOver}
[68]: {DragDrop.DragOver}
[69]: {DragDrop.PreviewDragLeave}
[70]: {DragDrop.DragLeave}
[71]: {DragDrop.PreviewDrop}
[72]: {DragDrop.Drop}
[73]: {Touch.PreviewTouchDown}
[74]: {Touch.TouchDown}
[75]: {Touch.PreviewTouchMove}
[76]: {Touch.TouchMove}
[77]: {Touch.PreviewTouchUp}
[78]: {Touch.TouchUp}
[79]: {Touch.GotTouchCapture}
[80]: {Touch.LostTouchCapture}
[81]: {Touch.TouchEnter}
[82]: {Touch.TouchLeave}
[83]: {FocusManager.GotFocus}
[84]: {FocusManager.LostFocus}
[85]: {ManipulationDevice.ManipulationStarting}
[86]: {ManipulationDevice.ManipulationStarted}
[87]: {ManipulationDevice.ManipulationDelta}
[88]: {ManipulationDevice.ManipulationInertiaStarting}
[89]: {ManipulationDevice.ManipulationBoundaryFeedback}
[90]: {ManipulationDevice.ManipulationCompleted}
[91]: {Control.PreviewMouseDoubleClick}
[92]: {Control.MouseDoubleClick}
[93]: {ScrollViewer.ScrollChanged}
[94]: {ScrollBar.Scroll}
[95]: {Thumb.DragStarted}
[96]: {Thumb.DragDelta}
[97]: {Thumb.DragCompleted}
[98]: {RangeBase.ValueChanged}
[99]: {TextBoxBase.TextChanged} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-09-24T19:01:19.480

在您的代码中，调用静态 EventManager.GetRoutedEvents() 方法以获取已注册/可用于您的应用程序的路由事件列表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T17:33:14.710

您可以通过查看 MSDN 上的文档来获取控件公开的事件的完整列表。这`DataGrid`是一种特殊情况，因为它不是主框架的一部分（目前），仅在 WPF 工具包中可用。但是，这里有 .NET 4.0 版本的文档`DataGrid` [-](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid(VS.100).aspx)不过，我不确定它与控件的 Toolkit 版本相比如何。

如果您尝试订阅 XAML 文件中控件本身的标记中的事件，Visual Studio 应提供包含控件属性和事件的智能感知。

# mysql - MySql 复制场景

> ID：943903
> 
> 赞同：1
> 
> 时间：2009-06-03T09:52:46.267
> 
> 标签：mysql, replication

我在定义复制和同步不同 mysql 服务器中的某些信息的最佳方法时遇到问题。

让我解释：

**实际场景：**

**服务器 A**
-Table A1 *（读/写）操作*
-Table A2 *（读/写）操作*

**服务器 B**
- 表 B1 *（写入）操作*

**所需场景：**

**服务器 A**
-表 A1 *（读/写）操作*
-表 A2 *（读/写）操作*
**-表复制 B1 *（读）操作***

**服务器 B**
-表 B1 *（写入）操作*
**-表 A1 复制*（读取）操作***
**-表 A2 复制*（读取）操作***

我应该如何定义我的 mysql 复制配置？

我应该将两台服务器定义为主服务器吗？

问候，
佩德罗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T12:39:42.590

您可以使用 MySQL 进行这种复制。请查看以下[从属选项](http://dev.mysql.com/doc/refman/5.0/en/replication-options-slave.html#option_mysqld_replicate-do-db)

*   `replicate-do-db`
*   `replicate-ignore-db`
*   `replicate-do-table`
*   `replicate-ignore-table`
*   `replicate-ignore-table`
*   `replicate-wild-do-table`
*   `replicate-wild-ignore-table`

和[相应的注释](http://dev.mysql.com/doc/refman/5.0/en/replication-rules.html)。使用这些选项，您可以将两台服务器设置为相互从属服务器并限制要复制的表（数据库）。由于 MySQL 无法进行多主复制，因此您必须确保所有*写入*都定向到正确的服务器，并且没有任何内容写入复制的表中。

# iphone - 我的 ViewController 中没有调用 awakeFromNib

> ID：943905
> 
> 赞同：7
> 
> 时间：2009-06-03T09:53:38.870
> 
> 标签：iphone

我有一个通过 initWithNibName 创建的视图控制器，我刚刚发现没有调用 awakeFromNib。仅当视图控制器从 Nib 中取消归档时才调用 awakeFromNib 吗？（即调用initWithCoder）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-03T20:41:48.653

我想你要找的是`viewDidLoad`. `awakeFromNib`仅在从 nib 加载的对象上调用。控制器本身接收`viewDidLoad:`. 既然你在打电话`initWithNibName:bundle:`，它实际上并没有从笔尖取消存档！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T12:58:43.270

UIViewController 延迟加载其视图，仅在需要显示时才加载。这适用于使用 -loadView 以编程方式创建视图或从 nib 取消归档。

您可以通过引用 UIViewController 的 view 属性来加载视图。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-08T02:06:52.787

awakeFromNib 不会为占位符对象调用，例如 iOS 中的文件所有者和第一响应者。[请参阅对象加载过程文档](https://developer.apple.com/library/mac/#DOCUMENTATION/Cocoa/Conceptual/LoadingResources/CocoaNibs/CocoaNibs.html#//apple_ref/doc/uid/10000051i-CH4-SW19 "Object Loading Process")中的 #4

# latex - 乳胶链接

> ID：943907
> 
> 赞同：3
> 
> 时间：2009-06-03T09:53:53.423
> 
> 标签：latex

如何链接到我的 LaTeX 文档的另一个部分或子部分？这种链接的常规格式是什么，写成[链接名称]，还是像网页超链接一样？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-03T10:08:27.543

链接到另一个部分需要您的部分进行一些额外的标记。要使用的命令是：

*   \label{identifier} -*创建一个标签，以后可以通过以下两个命令**引用***

*   \ref{identifier} - LaTeX 用*定义标签标识符的节/子节/图/表/定理的****编号****替换此标记。*

***   \pageref{identifier} - LaTeX 用*定义标签标识符的节/子节/图/表/定理的****页码****替换此标记。*** 

 ****因此，要在文本中创建对另一部分的引用，请说“参见 Z 页上的 XY 部分”，您可以这样写

```
\label{mySection} % Put this inside your section

see section \ref{mySection} on page \pageref{mySection}" 
```

注意：当您进行交叉引用时，请确保编译多次，直到不再收到任何警告。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-03T10:06:52.180

它在这里解释：

[http://en.wikibooks.org/wiki/LaTeX/Labels_and_Cross-referencing](http://en.wikibooks.org/wiki/LaTeX/Labels_and_Cross-referencing) [http://en.wikibooks.org/wiki/LaTeX/Formatting#Typesetting_URLs](http://en.wikibooks.org/wiki/LaTeX/Formatting#Typesetting_URLs)

[编辑]

如果您想自定义链接的外观，请查看[hyperref 的文档](https://www.ctan.org/pkg/hyperref)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-12T09:06:56.307

是的，除了使用`\label`,`\ref`和`\pageref`，使用 package [`hyperref`](http://www.ctan.org/pkg/hyperref)。

# javascript - 如何基于多属性和多属性值显示/隐藏元素？

> ID：943908
> 
> 赞同：0
> 
> 时间：2009-06-03T09:54:12.597
> 
> 标签：javascript, jquery, filter, html

我想根据属性过滤器查看/隐藏页面上的 div。我已经制作了几个可以有多个值的属性。用户可以选择他们希望看到的显示。

我无法获得正确的算法（或者我不知道`Javascript/jQuery`要使用哪个函数）。以下显然不起作用。我首先显示所有项目，然后遍历过滤器，隐藏与属性不匹配的项目（阅读：循环中的当前属性）。这意味着项目会被隐藏，即使它们稍后可能匹配某个属性......

**我怎样才能使这个过滤器机制工作，并且不排除/隐藏不需要根据循环稍后选择的属性隐藏的项目？**也许有一些 OR 运算符可以用于属性选择`('div[group=firstgroup|thirdgroup]')`？

**Javascript：**

```
 $(document).ready(function() {
        var items = $('#items').find('div');
        $(items).show();

        var groupsToShow = Array('firstgroup','thirdgroup');
        var namesToShow = Array('Fred','Pete');
        var applicationsToShow = Array('light');

        for(var i=0;i<groupsToShow;i++) {
            $(items).find('div[group!='+groupsToShow[i]+']').hide();    
        }

        for(var i=0;i<namesToShow;i++) {
            $(items).find('div[name!='+namesToShow[i]+']').hide();    
        }

        for(var i=0;i<applicationsToShow;i++) {
            $(items).find('div[application!='+applicationsToShow[i]+']').hide();    
        }
    }); 
```

**HTML 代码：**

```
<div id="items">
    <div group="firstgroup" name="Rob" application="special"></div>
    <div group="firstgroup" name="Fred" application="light"></div>
    <div group="secondgroup" name="Pete" application="special"></div>
    <div group="thirdgroup" name="Pete" application="special"></div>
    <div group="thirdgroup" name="Pete" application="light"></div>
    <div group="secondgroup" name="Pete" application="normal"></div>
    <div group="thirdgroup" name="Pete" application="special"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T10:19:54.057

据我了解，您只希望在元素满足所有三个数组中包含的内容时显示元素。所以在上述情况下，第二个和第五个 DIV 将是唯一显示的......对吗？

如果我的假设是正确的，那么这应该有效：

```
var show = {
    'group': ['firstgroup','thirdgroup'],
    'name': ['Fred','Pete'],
    'application': ['light']
};

$('#items div')
    .hide()
    .filter(function(){
        // Only returns true for elements
        // that satisfy all three arrays
        for (var i in show) {
            var attr = $(this).attr(i),
                match = ('|' + show[i].join('|') + '|').indexOf(attr) > -1;
            if (!match) {
                return false;
            }
        }
        // If we reach this point then we can assert
        // that the element contains all required attributes
        return true;
    })
    .show(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-03T10:02:38.587

您可以使用 add() 构建要显示的项目列表：

```
$(document).ready(function() {
    var items = $('#items').find('div');
    $(items).hide();

    var groupsToShow = ['firstgroup','thirdgroup'];
    var namesToShow = ['Fred','Pete'];
    var applicationsToShow = ['light'];

    var $itemsToShow = $();

    for(var i=0;i<groupsToShow;i++) {
        $itemsToShow = $itemsToShow.add('div[group='+groupsToShow[i]+']');
    }

    for(var i=0;i<namesToShow;i++) {
        $itemsToShow = $itemsToShow.add('div[name='+namesToShow[i]+']');    
    }

    for(var i=0;i<applicationsToShow;i++) {
        $itemsToShow = $itemsToShow.add(('div[application='+applicationsToShow[i]+']');    
    }

    $itemsToShow.show();
}); 
```

# jquery - jQuery自定义点击

> ID：943911
> 
> 赞同：2
> 
> 时间：2009-06-03T09:54:39.897
> 
> 标签：jquery

我正在尝试执行以下操作：

```
$("#something ."+id).click(function() {
    callFunction(id,message);
});     

$("#something ."+id).silentclick(function() {
    callFunction(id,message,'silent');
}); 
```

但是silentclick给出了一个错误，说函数不存在。如何创建自己的自定义事件，如silentclick？

感谢您的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-03T09:59:56.797

你像这样扩展 jQuery：

```
(function($){
    $.fn.silentclick = function(action) {
        /* do what you like with the function passed */
        action(); /* for example invoke the function */
    }
})(jQuery); 
```

在不知道silentclick 想要做什么或您希望它如何触发的情况下，我真的无法提供更多细节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T10:12:06.150

我认为您正在尝试创建自定义事件。如果是这种情况，您可以使用 .bind() 或 .live()。

```
$("#something ."+id).bind('silentclick',function() {    
  callFunction(id,message,'silent');
}); 
```

然后，您可以从代码中的其他位置触发事件。

```
$("#something ."+id).trigger('silentclick'); 
```

# javascript - Microsoft Visual Studio 中的 JavaScript

> ID：943918
> 
> 赞同：2
> 
> 时间：2009-06-03T09:58:14.727
> 
> 标签：javascript, visual-studio, ide

有谁知道是否有计划在 MS Visual Studio 中实现 JavaScript，就像他们做所有其他语言一样？

我对 JavaScript 编码还很陌生，但我开始意识到它对于创建 RIA 的真正强大之处。主要问题是，在 IDE 中进行开发和调试时，它远不如我用 C# 编写那样流畅。也许这只是 Visual Studio 的一个限制，并且有更好的环境来编写 JavaScript？

最重要的是调试。目前，当我附加并逐步完成整个过程时，非常笨拙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T10:13:24.523

VS 2010 将对 Javascript和智能感知提供更好[的支持](http://blogs.msdn.com/mikeormond/archive/2009/04/16/visual-studio-2010-enhancements-for-asp-net.aspx)

> VS2010 的进一步增强将带来巨大的性能改进，特别是大型脚本库和识别动态生成的对象的能力以及 VS2008 中的 Intellisense 引擎难以处理的许多 Javascript 框架使用的其他技术。还为提高 Intellisense 与 3rd 方库的兼容性做出了重大努力。

还有专门用于 Javascript 和 XML 开发的[Spket IDE 。](http://spket.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T10:03:24.543

JavaScript 在 Visual Studio 2008 中运行良好。它支持具有完整智能感知功能的 jQuery，如果我没记错的话，调试器也支持 JavaScript，至少在 Web 应用程序中是这样（尽管我不确定）。不过，我倾向于在浏览器中进行调试工作，因为无论如何，这就是操作发生的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-03T10:04:18.910

您可能会发现在 firefox 中的 Firebug 甚至在 IE8 的内置调试器中调试 Javascript 更容易。

我经常使用 VS 调试 Javascript，我不能说我觉得体验很笨拙。你觉得它有什么笨拙的地方？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T14:05:23.213

除了已经说过的内容之外，重要的是要注意 JavaScript 有一个非常松散的标准（委婉地说）。在这种情况下，“完整的”JavaScript InteliSense 支持永远不会像 Visual Studio 或任何其他 IDE 中的 C# 那样强大。我希望（如前所述）对 JQuery、Prototype 和其他 JS 库的支持会很好，但核心语言总是有点困难，无论是否有 IntelliSense。

# java - 在 Java 应用程序中嵌入 Web 浏览器

> ID：943927
> 
> 赞同：14
> 
> 时间：2009-06-03T10:01:04.283
> 
> 标签：java, browser, include

> **可能重复：**
> [有没有办法在 Java 中嵌入浏览器？](https://stackoverflow.com/questions/48249/is-there-a-way-to-embed-a-browser-in-java)

如何在 Java 应用程序中嵌入 Web 浏览器？

谢谢，大卫

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-03T10:14:12.603

有多种选择：

*   [JEdi​​torPane](http://java.sun.com/j2se/1.4.2/docs/api/javax/swing/JEditorPane.html) - 包含在 JRE 中，但只呈现简单的 HTML
*   [JDIC](http://workshop.evolutionzone.com/2007/08/30/jdic-embedding-a-web-browser-in-java/) - 开源，嵌入原生浏览器
*   [ICEBrowser](http://www.icesoft.com/products/icebrowser.html) - 商业的，用 Java 渲染 HTML
*   [WebRenderer](http://www.webrenderer.com) - 商业，在 Java 中嵌入原生浏览器

还有一些似乎没有在积极开发中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-01-26T22:29:35.017

您也可以尝试来自 DJ Native Swing 的 JWebBrowser：http: [//djproject.sourceforge.net/ns](http://djproject.sourceforge.net/ns)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T13:36:25.237

[Flying Saucer](http://code.google.com/p/flying-saucer//)很小，可以很好地呈现*常规*的HTML 页面

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T10:16:57.403

如果您想要纯 java 解决方案，请尝试[Lobo](http://lobobrowser.org)。

否则，您可以使用 SWT / JRex 或其他一些基于 JNI 的产品。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-11T15:53:46.223

如果您需要纯 Java 解决方案，则可以使用[JWebEngine](http://www.inetsoftware.de/other-products/jwebengine)。它是目前可用的最好的纯 Java 解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T10:07:41.947

您可以为此使用 SWT，这是一个[简单的示例](http://dev.eclipse.org/newslists/news.eclipse.platform.swt/msg38959.html)。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-03T10:17:22.393

我有另一个

[Lobo 项目](http://lobobrowser.org/cobra.jsp)- 开源

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-03T10:17:24.423

您可以使用[mozswing](http://sourceforge.net/projects/mozswing)。有用。

# iphone - 如何将 appDelegate 中的信息传递到 UINavigationcontroller 中的视图控制器之一

> ID：943929
> 
> 赞同：2
> 
> 时间：2009-06-03T10:01:33.313
> 
> 标签：iphone, uinavigationcontroller

在我正在开发的 iphone 应用程序中，我使用自定义类来管理与主机的网络通信。名为protocolClass 的类是appDelegate 中的ivar 和applicationDidFinishLaunching: 方法中的alloc + init。

现在，每当 protocolClass 从主机接收数据时，它都会在其委托（我将其设置为 appDelegate）中调用 protocolClassDidReceiveData: 方法。然后我需要更新 UINavigatorController 中一个 customViewController 中的数据。

我应该只添加对我需要在 appDelegate 中更新的 customViewController 的引用吗？还是有其他更有效的方法？

如果我要保留对 customViewcontroller 的引用，那么内存使用的后果是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T16:45:44.660

如果我猜对了，您想在程序的某个不相关部分发生事件后更新视图。

为了减少代码中的依赖项数量，我建议使用 NSNotification 而不是更紧密耦合的实例变量。通知是一个 Cocoa 概念，它允许您的代码的一部分发出类似事件的消息，任何数量的侦听器都可以注册。

在您的情况下，它看起来像这样：

AppDelegate 标头：

```
extern NSString* kDataReceived; 
```

AppDelegate 实现：

```
NSString* kDataReceived = @"DataReceived";

- (void)protocolClassDidReceiveData:(NSData*)data {
    [[NSNotificationCenter defaultCenter] postNotificationName:kDataReceived
                                                        object:self
                                                      userInfo:data];
} 
```

在一些感兴趣的监听器类（例如你的 UIViewController）的实现中：

```
// register for the notification somewhere
- (id)init
{
    self = [super init];
    if (self != nil) {
        [[NSNotificationCenter defaultCenter] addObserver:self
                                                 selector:@selector(dataReceivedNotification:)
                                                     name:kDataReceived
                                                   object:nil];
    }
}

// unregister
- (void)dealloc
{
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}

// receive the notification
- (void)dataReceivedNotification:(NSNotification*)notification
{
    NSData* data = [notification userInfo];
    // do something with data
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-03-02T03:41:38.370

是的，通知是一个很好的方法。而当模型想要更新控制器 [即 ViewController] 时，通知是一种很好的方式。就我而言，我正在尝试使用 SSDP（使用 AsyncUdpSocket）发现设备，并且我想在找到设备时更新/通知我的视图控制器。由于这是异步的，所以当接收到数据时，我使用了通知。这是我做的简单的事情：

在 viewDidLoad 中（我尝试覆盖 init 但这对我来说效果不佳） - 我为我的 ViewController 注册了如下通知：

```
*NSNotificationCenter *nc = [NSNotificationCenter defaultCenter];
    [nc addObserver:self
           selector:@selector(foundController:) 
               name:@"DiscoveredController"
             object:nil]; 
```

这是我的 ViewController 中的选择器：

```
// receive the notification
- (void)foundController:(NSNotification *)note
{
    self.controllerFoundStatus.text = @"We found a controller";
} 
```

在我的“模型”[不是应用程序委托中-我创建了一个新类，用于发现设备“serviceSSDP”，我所做的只是发布如下通知：

```
[[NSNotificationCenter defaultCenter] postNotificationName:@"DiscoveredController" object:nil]; 
```

就是这样。当我收到对我的 SSDP 发现的正确响应时，就会发布此通知 [特别是在：

```
- (BOOL)onUdpSocket:(AsyncUdpSocket *)sock 
     didReceiveData:(NSData *)data 
            withTag:(long)tag 
           fromHost:(NSString *)host 
               port:(UInt16)port 
```

AsyncUdpSocket 的。

# sharepoint - 以编程方式获取 12 Hive 的目录路径

> ID：943933
> 
> 赞同：4
> 
> 时间：2009-06-03T10:02:20.147
> 
> 标签：sharepoint, moss

有没有办法以编程方式获取 12 Hive 的目录路径？我正在创建一个将文件传递到 12 配置单元中的 XML 目录的功能，并且我不想在我的代码中对目录路径进行硬编码。

是否有任何对象模型属性将 12 Hive 目录路径字符串作为属性公开？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-03T14:05:07.207

您可以使用 Microsoft.SharePoint.Utilities.SPUtility.GetGenericSetupPath() 方法。有关 WSS SDK 的更多信息，请参阅：http: [//msdn.microsoft.com/en-us/library/microsoft.sharepoint.utilities.sputility.getgenericsetuppath.aspx](http://msdn.microsoft.com/en-us/library/microsoft.sharepoint.utilities.sputility.getgenericsetuppath.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-11T11:23:57.463

为什么需要将 xml 文件放在 12 个配置单元中？这样你的工作“不受支持” 部署到 TEMPLATE\XML 文件夹不是更容易吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T10:12:46.257

您是否曾经见过一个 SharePoint 安装，其中 12-hive 不像往常一样在同一个地方？我认为微软甚至不支持将它放在其他地方..

即使这样，您也可以对“/_layouts”目录执行[MapPath](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.mappath.aspx)以获取值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-03T13:48:41.423

32 位与 64 位无关紧要，因为在任何一种情况下，Program Files 都是 c:\Program Files。

重要的是操作系统语言，它可以更改 c:\Program Files\Common Files 的文字文本。获取该目录的正确方法是： System.Environment.GetFolderPath(System.Environment.SpecialFolder.CommonProgramFiles);

然后您可以使用该文件夹，然后连接其余项目...我认为这些项目不是特定于语言的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-09-01T12:25:15.393

只想补充一点，如果您在 Sharepoint 中使用 MapPath()，您会收到指向网站位置的路径，默认情况下为“Inetpub”，例如：

C:\Inetpub\wwwroot\wss\VirtualDirectories\12345\myFolder

路径不指向 12-hive。

# objective-c - 通过 Cocoa 连接到 Sharepoint

> ID：943934
> 
> 赞同：2
> 
> 时间：2009-06-03T10:02:28.010
> 
> 标签：objective-c, cocoa, sharepoint, active-directory

如何通过 Cocoa 连接到 Sharepoint（例如获取列表）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T11:11:22.037

使用[Cocoa Web 服务 API](https://developer.apple.com/library/archive/documentation/Networking/Conceptual/UsingWebservices/Introduction/Introduction.html)访问[SharePoint Web 服务](https://msdn.microsoft.com/en-us/library/ms479390.aspx?ppud=4)。

我认为没有人专门写过一篇关于从 cocoa 访问 SharePoint Web 服务的文章，但[这里有一篇](https://lists.apple.com/archives/Macnetworkprog/2006/Apr/msg00038.html)用于从 cocoa 连接到 .Net Web 服务的文章。

# c# - Func有什么区别 和转换器 ?

> ID：943939
> 
> 赞同：10
> 
> 时间：2009-06-03T10:03:33.687
> 
> 标签：c#, delegates

查看 Func 和 Converter 代表的签名，

```
public delegate TResult Func<T, TResult>(T arg);
public delegate TOutput Converter<TInput, TOutput>(TInput input); 
```

我很难看出两者之间的区别。当然，如果我们重命名泛型类型参数，它们本质上是一样的吗？

谁能解释一下为什么它们都存在？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-03T10:06:46.533

没有区别。它们存在的原因是历史性的。在 .NET 2.0 中已经可用，但后来添加`Converter<T1,T2>`了一系列委托类型。`Func<>`为了保持一致性，`Func<T,TResult>`添加了，但它与`Converter<T1,T2>`.

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T10:10:27.167

有许多有效地相同的委托类型*-*例如：

*   `ThreadStart`
*   `MethodInvoker`
*   `Action`

都有相同的`void Foo()`签名。从历史上看，名称是根据特定用途选择的；但是使用 LINQ 并展望未来，似乎更清楚地关注签名 - 因此在 .NET 3.5 中，他们引入了`Func<...>`和`Action<...>`（代表*家族）之类的东西*

不幸的是，它们在方差级别上并不真正兼容，因此如果您同时使用两者，则通常必须在它们之间进行填充。哪个痛...

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T10:09:19.460

`Converter<,>`在 .NET 2.0 中添加。各种`Func`s 是在 3.5 中添加的（我认为）。现在，当然，框架设计者*可能*`Func`会说“嘿，我们已经为此有了一个通用的委托”，但是拥有所有其他的而不是这个看起来会很奇怪。并且为了避免破坏性的变化`Converter`，必须留在原地。

# c# - 转换 Action 的最佳方式是什么 功能 ?

> ID：943941
> 
> 赞同：22
> 
> 时间：2009-06-03T10:03:43.310
> 
> 标签：c#, .net, delegates

我的班上有两个带有这个签名的函数，

```
public static TResult Execute<TResult>(Func<T, TResult> remoteCall);
public static void Execute(Action<T> remoteCall) 
```

如何将第二种方法中的相同委托传递给第一种？使用 Delegate 参数创建方法不是一种方法，因为我丢失了一些异常信息。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-06-03T10:07:10.777

`Func<T, TResult>`将其包装在具有虚拟返回值的类型委托中，例如

```
public static void Execute(Action<T> remoteCall)
{
    Execute(t => { remoteCall(t); return true; });
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T10:14:13.600

您实际上是在要求将不提供结果的东西传递给需要它的函数。
这是荒谬的。

如果您愿意提供一些结果值（隐式或显式） ，您可以轻松地将 Form`Action<T>`的任何函数转换为`Func<T,TResult>`

```
Func<T,TResult> MakeDefault<T,TResult>(Action<T> action)
{
    return t =>  { action(t); return default(TResult);}; 
} 
```

或者

```
Func<T,TResult> MakeFixed<T,TResult>(Action<T> action, TResult result)
{
    return t =>  { action(t); return result; };
} 
```

# android - Android中的双色水平线

> ID：943944
> 
> 赞同：5
> 
> 时间：2009-06-03T10:04:38.783
> 
> 标签：android

我目前正在构建的 Android 应用程序的图形设计师提出了一条双色线作为布局框中项目之间的分隔符：

[双色分隔线 http://img7.imageshack.us/img7/3351/twocolorline.png](http://img7.imageshack.us/img7/3351/twocolorline.png)

如果你仔细观察图像，你会看到一条深灰色的线，紧接着它下面有一条非常浅的灰色（几乎是白色）的线。线条应调整为容器的宽度。

在 UI 中实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-06-03T16:23:07.713

这里最好的方法是将您显示的图像转换为[9-patch](http://developer.android.com/guide/developing/tools/draw9patch.html)，将其作为资源添加到 res/drawable 文件夹中，并使用`ImageView`, setting 将其显示在您的布局中`android:width="fill_parent"`。

9-patch 图像可让您指定调整图像大小时要拉伸的图像区域（在本例中为整个图像 - 尽管您可能需要考虑在其边缘“淡出”线条以符合某些原生 Android样式）。

在您的布局文件中，ImageView 定义如下所示：

```
<ImageView
  android:src="@drawable/my_separater_nine_patch"
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:scaleType="fitXY"
/> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2011-12-17T15:53:10.377

如果您不想使用 9-patch，可以尝试使用 LayerList。

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >
    <item>
        <shape >
            <solid android:color="#ffffff" />
        </shape>
    </item>
    <item android:bottom="1px">
        <shape >
            <solid android:color="#252525" />
        </shape>
    </item>

</layer-list> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-03-27T09:41:40.763

```
<ImageView android:layout_width="match_parent" android:id="@+id/line1"
            android:layout_height="1dp" android:background="#FFFFFF"
            android:layout_weight="1" android:layout_marginTop="5dp"
            android:layout_marginBottom="5dp" android:layout_marginLeft="5dp"
        android:layout_marginRight="5dp"/> 
```

在 LinearLayout 视图中插入

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T18:02:36.400

您可以创建 2 个视图，每行一个，将该视图的背景颜色设置为您想要的颜色，然后将高度设置为 1px，宽度设置为“fill_parent”。与 9 补丁方法相比，它的优点是您不需要加载资源，并且可以动态地将颜色更改为用户想要的任何颜色。缺点是您正在创建更多的布局对象。

# objective-c - 如何在Objective C中形成CGPoint数组

> ID：943945
> 
> 赞同：29
> 
> 时间：2009-06-03T10:04:57.410
> 
> 标签：objective-c

我想得到这个结构

```
CGPoint addLines1[] =
{
    CGPointMake(30.0, 150.0),
    CGPointMake(41.67, 145.19),
    CGPointMake(53.33, 103.25),
    CGPointMake(65.0, 131.67),
    CGPointMake(76.67, 106.11),
    CGPointMake(88.33, 110.20),
    CGPointMake(100.0, 111.54),
    CGPointMake(111.67, 112.13),
    CGPointMake(123.33, 115.66),
    CGPointMake(135.0, 123.7),
    CGPointMake(146.67, 125.53),
    CGPointMake(158.33, 115.1),
    CGPointMake(170.0, 69.38),
    CGPointMake(181.67, 112.47),
    CGPointMake(193.33, 65.1),
    CGPointMake(205.0, 103.33),
    CGPointMake(216.67, 92.6),
    CGPointMake(228.33, 54.76),
    CGPointMake(240.0, 79.66),
    CGPointMake(251.67, 53.81),
    CGPointMake(263.33, 56.81),
    CGPointMake(275.0, 88.19),
    CGPointMake(286.67, 74.81),
    CGPointMake(298.33, 28.1),
    CGPointMake(310, 20.0),
}; 
```

为了进行一些计算和绘制数据。

我有`CGPoint *lines = appDelegate.averageResponseTimePoints;`

如何制作`addLines[]`数组`*lines`？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-05-21T10:44:34.170

对于 iOS：

创建数组：

```
NSArray *myCGPointArray = @[[NSValue valueWithCGPoint:CGPointMake(30.0, 150.0)],[NSValue valueWithCGPoint:CGPointMake(41.67, 145.19)]]; 
```

获取第一个 CGPoint 对象：

```
CGPoint myPoint = [myCGPointArray[0] CGPointValue]; 
```

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2009-06-03T10:40:01.397

C 数组在运行时并不是真正的数组，它们只是指向同一类型对象的连续块的指针。当您看到`items[n]`时，这只是 . 的语法糖`*(items+n)`。

在您的示例`addLines[1]`中将是`*(lines+1)`并且`addLines[0]`将是`*(lines+0)`，即`*lines`。所以，`addLines`只是`lines`没有指针解引用。`*lines`是数组中的第一项并且`lines`是整个数组。

数组在编译时与指针有一些区别。例如，`sizeof(addLines)`会给你整个数组的大小。

一旦您将数组传递到它的大小可能可变的地方，数组特性就会丢失，但您仍然可以使用下标运算符。例如：

```
#include <Foundation/Foundation.h>

#define showsize( expr ) ( printf(#expr " = %zd\n", ( expr ) ) )

CGPoint *
pass_back(CGPoint points[4])
{
    showsize(sizeof(points));
    return points;
}

int
main(void)
{
    CGPoint square[] = {CGPointMake(-1.0,  1.0),
                        CGPointMake( 1.0,  1.0),
                        CGPointMake( 1.0, -1.0),
                        CGPointMake(-1.0, -1.0)};
    CGPoint* returned;
    int i;

    showsize(sizeof(CGPoint));
    showsize(sizeof(CGPoint*));
    showsize(sizeof(square));
    returned = pass_back(square);
    showsize(sizeof(returned));

    for (i = 0; i < 4; ++i) {
        printf("returned[%d] = {%0.1f, %0.1f}\n", i, (float) returned[i].x,
                                                 (float) returned[i].y);
    }

    return 0;
} 
```

这会在我的 Mac 上输出以下内容：

```
大小（CGPoint）= 8
sizeof(CGPoint*) = 4
大小（正方形）= 32
大小（点）= 4
大小（返回）= 4
返回[0] = {-1.0, 1.0}
返回[1] = {1.0, 1.0}
返回[2] = {1.0, -1.0}
返回[3] = {-1.0, -1.0}

```

这里，`square`是 4 个`CGPoint`s 的大小，但是一旦发送给`pass_back`函数，它就只是一个指针的大小，因为它就是这样。当指针返回（并命名`returned`）时，它仍然可以像数组一样使用。

注意循环中的幻数`4`。指针不知道它指向的数组的长度。

不能使用`=`运算符重新分配数组。如果您真的必须`addLines`使用 中的点填充`lines`，您可以使用以下内容来执行此操作：

```
memcpy(addLines, lines, sizeof(CGPoint) * numberOfPoints); 
```

你必须`numberOfPoints`从某个地方得到，并且`addLines`必须足够大以处理这些点。如果点的数量是一个常数，那没关系，但如果点的数量在运行时可以变化，那就*不好*了，特别是如果这些点来自外部世界（想想任意代码执行）。

我会更改`averageResponseTimePoints`为返回 NSArray 而不是 C 样式的数组。您需要将`CGPoint`s 封装在对象中 - 您自己的对象或`NSValue`s.

这是一个如何编写的示例`averageResponseTimePoints`：

```
- (NSArray*) averageResponseTimePoints
{
    NSMutableArray* result = [[[NSMutableArray alloc] init] autorelease];

    for (int i = 0; i < numberOfPoints; ++i) {
        NSValue* point = [NSValue value:points+i
                           withObjCType:@encode(CGPoint)];
        [result addObject:point];
    }

    return result;
} 
```

如果您的代码使用 CocoaTouch 运行，您可以使用它来创建点值：

```
NSValue* point = [NSValue valueWithCGPoint:points[i]]; 
```

要将`CGPoint`s 从数组中取出，您可以编写如下内容：

```
for (NSValue* value in result) {
    NSPoint pt;
    [value getValue:&pt];
    NSLog(@"%f %f", pt.x, pt.y);
} 
```

或者使用 CocoaTouch：

```
CGPoint pt = [value CGPointValue]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-04T09:31:31.340

试试这个

```
CGPoint A[10];
A[0] = CGPointMake(10.0, 10.0);
A[1] = CGPointMake(10.0, 12.0);
float x = A[1].y;
NSLog(@"%.0f", x); 
```

有用。祝你好运。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-24T21:03:16.580

我尝试了 Tibidabo 的答案，但它对我不起作用。它说 [myCGPointArray objectAtIndex:0] 是 id 类型，所以我不能在它上面调用 CGPointValue。嗯。

但是，这有效：

```
NSArray *points = [NSArray arrayWithObjects:
                   [NSValue valueWithCGPoint:CGPointMake(5.5, 6.6)],
                   [NSValue valueWithCGPoint:CGPointMake(7.7, 8.8)],
                   nil];

NSValue *val = [points objectAtIndex:0];
CGPoint point = [val CGPointValue];
float X = point.x;
NSLog(@"cgpoint value is: %f", X); 
```

或者

```
NSArray *points = [NSArray arrayWithObjects:
                        [NSValue valueWithCGPoint:CGPointMake(20, 6.6)],
                        [NSValue valueWithCGPoint:CGPointMake(7.7, 8.8)],
                        nil];
float xCoordinate = [[points objectAtIndex:0] CGPointValue].x; 
```

我在这里找到它：[如何以简单的方式将 CGPoint 对象添加到 NSArray？](https://stackoverflow.com/questions/899600/how-can-i-add-cgpoint-objects-to-an-nsarray-the-easy-way), 杰瑞特·哈迪 (Jarret Hardie) 发布。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-10-05T18:24:48.677

我解决了我的问题做下一个：

* * *

```
NSMutableArray *myArray = [[NSMutableArray alloc] init];
[myArray addObject:[NSValue valueWithCGPoint:myPoint]]; 
```

* * *

感谢[michael-jensen](https://stackoverflow.com/users/2203705/michael-jensen)的[解决方案](https://stackoverflow.com/a/15603975/2835520)！

# linq - ADO.Net 实体框架关系

> ID：943951
> 
> 赞同：0
> 
> 时间：2009-06-03T10:06:02.247
> 
> 标签：linq, entity-framework

我有 2 个表映射在我的实体模型中，基本上就是这个

```
Tasks
(
   TaskId
   TaskName
   Description
   ProjectId (Foreign Key)
)

Projects
(
   ProjectId
   ProjectName
) 
```

我使用 Linq 检索我的任务到这样的实体

```
Tasks task = (from t in db.Tasks where t.TaskId == id select t).FirstOrDefault(); 
```

然后，任务对象有一个 Projects 对象，我假设它可能包含与此任务相关的项目，但在我的情况下，Projects 对象始终为空。如果我至少可以从任务对象中获取 projectId，我不介意，但这似乎是隐藏的。

关于我应该如何处理这个问题或我哪里出错了？我仍在尝试了解 linq 和实体框架。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T10:29:50.497

```
Tasks task = (from t in db.Tasks.Include("Project") where t.TaskId == id select t).FirstOrDefault(); 
```

（将“项目”替换为项目导航属性的名称）

# c# - 数据绑定 wpf KeyedCollection

> ID：943952
> 
> 赞同：1
> 
> 时间：2009-06-03T10:06:27.033
> 
> 标签：c#, wpf, data-binding, xaml

我是 WPF 数据绑定的初学者，我刚刚发现了一种令人困惑的行为。也许有人可以帮助我：

我的 xaml 代码将列表框绑定到列表：

```
<ListBox ItemsSource="{Binding Path=Axes}"  SelectedItem="{Binding Path = SelectedAxis}" DisplayMemberPath = "Name" Name="listboxAxes"/> 
```

如果绑定到的实际项目是 List 一切都按预期工作。

但是当我更改为 KeyedCollection 时，会出现更新问题。调用 NotifyPropertychanged("Axes") 不会更新整个 ListBox。

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-09T20:19:23.640

如果 Axes 收集的任何类都不是具有自己的 Name 属性的类，那么 DisplayMemberPath="Name" 属性可能会导致您什么都看不到。

不过，使用 KeyedCollection 作为 ItemsSource 非常好。ItemsSource 属性是[ItemsControl.ItemsSource](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemssource.aspx)属性。它只要求它绑定的任何东西都实现 IEnumerable。

[KeyedCollection](http://msdn.microsoft.com/en-us/library/ms132438.aspx)确实实现了 IEnumerable，因为它实现了 Collection。

这是一个使用 KeyedCollection 的简短示例：

```
<Grid>
    <DockPanel x:Name="QuickListButtonsStackPanel">
        <Button DockPanel.Dock="Top"
                Content="Load Animals"
                Click="AnimalButtonClick" />
        <Button DockPanel.Dock="Top"
                Content="Load Objects"
                Click="ObjectButtonClick" />

        <TextBlock DockPanel.Dock="Bottom"
                   Background="Azure"
                   Text="{Binding SelectedExample}" />

        <ListBox x:Name="uiListBox"
                 ItemsSource="{Binding Examples}"
                 SelectedItem="{Binding SelectedExample}" />

    </DockPanel>
</Grid> 
```

以及我们的 Window & KeyedCollection 的代码：

```
public partial class Window1 : Window, INotifyPropertyChanged
{
    public Window1()
    {
        InitializeComponent();
        this.DataContext = this;
    }

    public KeyedCollection<char, string> Examples
    {
        get;
        set;
    }

    private string mySelectedExample;
    public string SelectedExample
    {
        get
        { return this.mySelectedExample; }
        set
        {
            this.mySelectedExample = value;
            this.NotifyPropertyChanged("SelectedExample");
        }
    }

    private void AnimalButtonClick(object sender, RoutedEventArgs e)
    {
        Examples = new AlphabetExampleCollection();
        Examples.Add("Ardvark");
        Examples.Add("Bat");
        Examples.Add("Cat");
        Examples.Add("Dingo");
        Examples.Add("Emu");

        NotifyPropertyChanged("Examples");
    }

    private void ObjectButtonClick(object sender, RoutedEventArgs e)
    {
        Examples = new AlphabetExampleCollection();
        Examples.Add("Apple");
        Examples.Add("Ball");
        Examples.Add("Chair");
        Examples.Add("Desk");
        Examples.Add("Eee PC");

        NotifyPropertyChanged("Examples");
    }

    #region INotifyPropertyChanged Members

    private void NotifyPropertyChanged(String info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;

    #endregion
}

public class AlphabetExampleCollection : KeyedCollection<char, string>
{
    public AlphabetExampleCollection() : base() { }

    protected override char GetKeyForItem(string item)
    {
        return Char.ToUpper(item[0]);
    }
} 
```

可能发生的另一个问题是，如果您只是从集合中添加/删除项目，而不是重新设置集合。在上面的示例中，您可以看到我们正在重新设置键控集合。如果我们不这样做，那么仅仅调用 NotifyPropertyChanged 就不会做任何事情。

让我们再添加两个按钮来演示这一点：

```
<Button DockPanel.Dock="Top"
        Content="Add Zebra"
        Click="AddZebraClick" />
<Button DockPanel.Dock="Top"
        Content="Add YoYo"
        Click="AddYoYoClick" /> 
```

和汉德尔人：

```
private void AddZebraClick(object sender, RoutedEventArgs e)
{
    Examples.Add("Zebra");
    NotifyPropertyChanged("Examples");
}

private void AddYoYoClick(object sender, RoutedEventArgs e)
{
    Examples.Add("YoYo");
    NotifyPropertyChanged("Examples");
} 
```

这两个都**不起作用**。当您调用 NotifyPropertyChanged 时，必须实际更改该属性。在这种情况下，它不是。我们已经修改了它的项目，但是 Examples 集合仍然是同一个集合。为了解决这个问题，我们可以像第一部分那样循环集合，或者如果我们可以访问 UI，我们可以调用：

```
uiListBox.Items.Refresh(); 
```

我们也可以循环 DataSource，我们可以循环 ListBox 的 ItemsSource，或者我们可以清除并重新分配绑定，但只是调用 UpdateTarget() 不会这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-03T11:01:24.753

尝试调用`listboxAxes.Items.Refresh()`. 这有时会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-09T11:36:23.580

`KeyedCollection`既不实现`INotifyCollectionChanged`也不实现`INotifyPropertyChanged`。要让绑定自动更新，请使用实现这些接口的集合（`ObservableCollection`例如）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-09T11:41:34.287

[WPF Gridview 绑定到 KeyedCollection 对象列表。](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/89882dc4-b4ef-43b9-b806-ac0a9d1072e8)

[使用“复合”键将数据绑定到字典的某些索引。](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/eb9edcf8-1db8-4536-9888-05e805956cc6)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T10:00:00.337

将您的属性公开为 IList 类型的属性，并将 ItemSource 绑定到此属性：

```
public IList MyIListKeyedCollection { get { return myKeyedCollection; } } 
```

并在 myKeyedCollection 更改时调用 NotifyPropertyChanged("MyIListKeyedCollection") 。我认为这应该工作...

# sql-server - 从 Access 2007 创建 SQL Server 存储过程 - 更改架构

> ID：943961
> 
> 赞同：0
> 
> 时间：2009-06-03T10:08:29.137
> 
> 标签：sql-server, sql-server-2005, ms-access, ms-access-2007

我有一个带有 SQL Server 2005 后端的 Access 2007 项目。但是，在 Access 中创建新的存储过程时，会出现错误：

> ADO 错误：特定架构名称 DOMAIN\username 不存在或您无权使用它

如何使用“dbo”模式创建存储过程？存储过程属性对话框的“所有者”下拉列表设置为用户名，并且不能更改为 dbo，即使用户处于“db_owner”角色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-03T18:20:54.787

好的，我会让人们在 SQL Server 上创建过程，而不是在其中将 dbo 添加到创建过程代码中。如果您不能这样做，也许您可​​以在使用 sp_changeobjectowner 创建所有者后运行代码来更改所有者

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-03T20:37:30.877

尝试使用户成为 dbo 模式的成员，而不是 db_owner。我就是这样做的。

顺便说一句，您可能想查看特定的 SQL Server 管理工具（SQL Server 2005 附带的 Management Studio 或免费下载的 2005 或 2008 快速版本），这为 DDL 类型的任务提供了更丰富的界面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-04T10:15:07.597

设法解决它。如果您使用户成为数据库的所有者（而不是具有 db_owner 角色的用户），当您在 Access 2007 中创建存储过程时，它会在 dbo 架构而不是 DOMAIN\username 下创建它。

这样做的步骤（在 Management Studio 中）：

*   右键单击数据库，选择属性
*   单击文件
*   在文本框中更改所有者
*   确定确认

缺点 - db_owner 角色下的其他用户仍将附加他们的用户名。所以必须为这些用户创建模式。

# vb.net - Vba - 错误不起作用？读取注册表值

> ID：943962
> 
> 赞同：0
> 
> 时间：2009-06-03T10:08:40.883
> 
> 标签：vb.net, vba, ms-word, text-files

这很奇怪，我有一个包含多个注册表项的数组的宏。我想将这些值插入到 Word 文档中的预定义书签中。

如果密钥在那里，这很好用，但如果不是，我希望代码跳过它并继续尝试数组中的下一个。

我的代码如下所示：

```
sVerdi = objShell.RegRead(regPath & "\" & Felter(iTeller)) 
```

这行代码返回注册表项的值，由数组中的第一个指定。但是，如果注册表项不在注册表中，我自然会得到一个错误：

```
Run-time error '-2147024894(80070002)':

Unable to open registry key
"HKEY_CURRENT_USER\Blablabla" for reading 
```

现在，这是合乎逻辑的，但是如果我输入“On error GoTo 0”，那么它就会忽略该行。我想不通，我一步一步地遍历每个数组，错误不断出现。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T10:12:25.663

当您说“它只是忽略了那条线”时，您的意思是`On Error GoTo 0`? `On Error GoTo 0`并不意味着忽略错误：它意味着“恢复默认错误处理”。你的意思是使用`On Error Resume Next`？

# javascript - 如何在jQuery中将本地作为全局ajax事件执行？

> ID：943965
> 
> 赞同：2
> 
> 时间：2009-06-03T10:09:29.743
> 
> 标签：javascript, ajax, javascript-events, jquery

最近从[Prototype](http://www.prototypejs.org/)切换到[jQuery](http://jquery.com/)，我正在努力解决一些基本问题。

我在我的应用程序中使用了几个 AJAX 请求；对于 95% 的这些请求，我希望执行一些全局事件，例如显示或隐藏加载指示器。除了全局功能外，每个请求还应该在完成后执行一些自定义代码。

似乎本地[Ajax 事件](http://docs.jquery.com/Ajax_Events)一旦设置就会覆盖全局事件。例如，请参见以下代码：

```
// global events
$('#loader').bind('ajaxStart', function() { 
    // in this particular example, the ajaxStart() works fine, 
    // as it has not been overridden
    Loader.enable();
}).bind('ajaxComplete', function() { 
    // this section will not execute. when the local complete()
    // is removed, it will execute just fine
    Loader.disable();
} );

// local ajax event
$.ajax({
    type: $(element).attr('method'),
    url: $(element).attr('action'),
    data: $(element).serialize(),
    global: 'true',
    complete: function(data) {
        if (params.target && $('#' + params.target)) {
            $('#' + params.target).html(data.responseText);
        }
        Behaviour.apply();
}); 
```

在这种特殊情况下，本地 complete() 事件似乎阻止了全局 ajaxComplete() 事件的执行。

**有没有办法将本地作为全局ajax事件执行？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T14:22:17.110

刚刚尝试运行您的代码。添加了缺失的 }); 尽管。像魅力一样工作。调用顺序如下：

1.  ajax启动
2.  完全的
3.  ajax 完成

**这是我所做的：**

```
// local ajax event
$.ajax({
    ...
    global: 'true',
    complete: function(data) {
        ...
    }
}); // <=== This line here 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-03T12:01:46.223

我没试过，但你为什么不创建一个全局方法：

```
function globalAjaxComplete(data) 
```

并从全局和本地事件处理程序中调用它？

您还可以定义一个类“ajaxEnabled”并执行以下操作：

```
$(".ajaxEnabled").bind("ajaxStart", 
   Function() { globalAjaxComplete(); }); 
```

那么你就不需要每次都调用全局方法了。

但是仍然不知道为什么本地绑定会取消全局绑定。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-08T08:00:15.020

首先，感谢您的回复。他们两个至少帮助我一次又一次地重新评估我的代码。

**问题和解决方案非常简单：**

`Behaviour.apply();`在我的本地完成事件中调用的那个在其他地方触发了一个错误，阻止了`complete()`函数正确完成并有效地禁用了全局`ajaxComplete()`事件。修复此错误也解决了我的问题。

**这意味着 jQuery 支持将*本地*和*全局*ajax 事件结合起来。**

# database-design - 如何最好地实施“查看次数”？

> ID：943967
> 
> 赞同：27
> 
> 时间：2009-06-03T10:09:57.557
> 
> 标签：database-design, schema

在任何网站上，例如在 StackOverflow 上，每个问题都有一个查看计数，并且用户阅读了一个问题但之前阅读过它不会计算两次。

我对它是如何实现的以及使用哪些表来完成它有一些想法。

您认为实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-03T20:38:25.600

在我看来，你有几个选择。

**饼干**

您可以在用户浏览器中为您记录视图的每个页面存储一个 cookie。检查此 cookie 是否存在，如果 cookie 已存在，则不要记录视图。

这样做的缺点是，如果 cookie 被禁用或有人试图玩弄系统，它将无法工作。

从好的方面来说，您不必担心可能存储数百万/数十亿行表数据。

**数据库**

您为每个视图保存一个记录。以某种方式将该记录与用户相关联，例如 MemberID、IP 地址；对用户来说应该是唯一的东西。如果您不要求用户登录，IP 并不理想但足够好。

因此，例如，您将拥有一个包含以下列的表格，

*   ArticleID（外键）
*   用户 ID（外键）
*   日期

由于几个原因，该日期将很有用，

*   报告。一旦您知道每个视图的记录时间，您就可以构建更好的统计数据。
*   查看超时。例如，您可能只想为每个用户每小时存储一个视图。保留日期列后，您可以执行此操作。

如果您的应用程序在这种情况下变得流行，那么您将需要处理存储问题。我运行了一个流行的 Facebook 应用程序，它导致每天添加超过 100,000 个视图行。实际上，如果您的应用程序变得如此受欢迎以至于成为问题，那么您将面临更大的问题需要处理。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2011-05-14T09:28:18.907

在我的网站上，我通过使用随机数除以浏览次数来处理访客浏览次数和产生的“数据量”。

假设我有一个在 0 和 1 之间分布良好的随机数生成器，并且我每天在特定页面上获得 100,000 次查看。如果我在每个视图中调用 'logView()' 函数，但在其中生成一个新的随机数，并且仅当随机数 < 0.001 时才真正将视图记录到数据库中，那么对于 100,000 个视图，我只会大约访问数据库100,000*0.001 = 1000 次。

如果我想返回一个视图计数，那么我只需将我的 DB 编号除以相同的值，例如。1000/0.001 = 100,000。这大约精确到最接近的 1000 个视图。

显然，您可以根据站点的负载选择一个随机数范围，如果您的负载发生巨大变化，甚至可以更改此范围（您只需要相应地修改存储的值）。

此外，只有 1000 次浏览的页面甚至可能不会在浏览次数中获得 1，但如果您有一个浏览次数为 100,000 的页面，那么浏览次数为 1000 的页面就微不足道了。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-03T20:50:50.583

简短的回答：这取决于！

*   这真的取决于您需要的观看次数有多准确，一个人可能被注册两次或三次是否可以接受？
*   这取决于您要使用这些数据的目的。如果您想对数据做其他整洁的事情（统计信息、最近的视图列表等），您可能需要考虑将所有单独的视图存储在数据库中。这可能会导致一个**巨大**的表，所以你必须在实现它之前解决这个问题。

我以前使用 cookie 与内存数据库相结合来存储个人视图（出于显而易见的原因，我将实际视图计数存储在持久保存到磁盘的数据库表中）。我可以这样做，因为统计数据没有任何意义。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-15T08:02:01.293

看起来 stackoverflow 不计算查看主题的来宾（未登录）用户。计算匿名用户浏览量的问题在于您的计数器可能会被玩弄。有人可以随时删除 cookie 并再次查看。记录视图是确保准确性的最安全的解决方案，但当然您有两个主要问题：表的大小和缺乏来宾/匿名用户。令我惊讶的是，stackoverflow 没有记录来宾（未登录）用户。我认为大多数视图将来自这些用户进行谷歌搜索。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-03T10:18:20.287

当您网站的大多数访问者都已注册时，确保他们没有被计算两次相对容易。

我不确定 SO 是否会计算客人的观看次数。我想我可以检查一下，但已经晚了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-11-03T22:22:24.330

我将尝试从功能的角度给出答案。

计算每个用户的观看次数 - 对于注册用户。对于匿名用户 - 每个会话。

在查看该项目的其他人进行重大更新后，增加第一个视图和任何视图的视图计数。

创作时的海报视图不应计入

你也可以想象做起来更简单，但我试图想出一个理想的解决方案。

# sql - SQL Server 查询的多组帮助

> ID：943968
> 
> 赞同：1
> 
> 时间：2009-06-03T10:10:00.223
> 
> 标签：sql, sql-server

我在使用多“分组依据”从 2 个表中检索数据时遇到了一些麻烦。

例如，下面是 2 个表，以及我希望从查询中获得的结果。

```
PrdID    Name   KG
------------------
1    Hals       10
2    Hals       3
3    Kugel      4
4    Kugel      10
5    Hals       12
6    Kugel      11
7    Hals       12
8    Hals       14
9    Hals       15
10   Kugel      16
11   Hals       8
12   Hals       15
13   Kugel      7
14   Kugel      8
15   Kugel      9 
```

材料

```
PrdId    MatID    MatSize
-------------------------
1    a    300/600
2    b    350/500
5    c    400/650
3    b    350/500
4    c    400/650
6    d    450/650
9    b    350/500
10   d    450/650
13   d    450/650
11   c    400/650
12   b    350/500
14   c    400/650
15   d    450/650
7    a    300/600
8    b    350/500 
```

结果表

```
Name     MatSize    Kg
----------------------
Hals    300/600    22
Hals    350/500    47
Hals    400/650    20
Kugel   350/500    4
Kugel   400/650    18
Kugel   450/650    43 
```

总之，我想知道每种材料每种产品使用的公斤量...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-03T10:18:59.240

我想这就是你想要的

```
select P.Name, M.MatSize, sum(P.KG) as Kg
from Products P
join Material M
on P.PrdId = M.PrdId
Group By P.Name, M.MatId, M.MatSize 
```

（编辑为只返回 wnted 列）

作为一个方面，我可以建议您将您的表格更多地标准化为 Products[PrdId, Name, Kg] Materials[MatId, MatSize] ProductMaterials[PrdId, MatId]

然后查询将变为

```
select P.Name, M.MatSize, sum(P.KG) as KG
from Products P
join ProductMaterial PM
on PM.PrdId = P.PrdId
join Materials M
on M.MatId = PM.MatId
group by P.Name, M.MatId, P.MatSize 
```

这样做的好处是您只需为每种材料类型存储一次 MatSize。

# wpf - 根据监视器分辨率加载 WPF 主题

> ID：943972
> 
> 赞同：1
> 
> 时间：2009-06-03T10:11:31.720
> 
> 标签：wpf, app-themes

我在我的 WPF 应用程序中遇到了相当大的分辨率问题，该应用程序将在**Hospital**中使用，客户被要求提供 BIG 字体和控件，以便他们可以从远处清楚地看到数据。

现在的问题是，当应用程序以 800X600 分辨率运行时，整个 UI 会变得混乱，所以我想为较低的显示器分辨率定义另一个主题，现在**如何从 C# 代码加载主题？**

**或者你们有更好的主意？？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T10:28:01.687

看看[这篇](http://dotnet.org.za/rudi/archive/2009/03/14/flexible-layout-on-steroids.aspx)文章。它使用 PhotoSuru 的 SizeTemplateControl 根据屏幕分辨率或窗口大小显示不同的布局！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-04T03:06:09.610

我认为您可以使用[Viewbox 控件](http://msdn.microsoft.com/en-us/library/system.windows.controls.viewbox.aspx)解决此问题。将此 XAML 粘贴到新窗口中并运行它。

```
<Viewbox>
    <StackPanel>
        <Button>One</Button>
        <Button>Two</Button>
        <Button>Three</Button>
    </StackPanel>
</Viewbox> 
```

当窗口重新调整大小时，包括字体在内的内容都会被缩放。

出于某种原因，Visual Basic 2008 Express 中的设计器无法在 Viewbox 内绘制任何内容。如果它发生在 Pro 或 TS 中，这可能会破坏您的交易。

# c# - 列表框作为 WPF 中的数值 UpDown 控件

> ID：943973
> 
> 赞同：1
> 
> 时间：2009-06-03T10:12:01.657
> 
> 标签：c#, .net, wpf, listbox

我在 WPF 中发现的缺点之一是它没有 Numeric UpDown 控件。所以我制作了一个高度为 25 的列表框，这样它一次只显示一个项目，垂直滚动感觉就像一个 UpDown 控件。我的问题是当我使用滚动更改值时，我无法获得列表框中显示的当前值。有什么想法可以在不选择的情况下获取列表框中显示的值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T10:41:33.313

Though there's no standard WPF NumericUpDown, you can try [NumericUpDown Custom Control with Theme and UI Automation Support Sample](http://msdn.microsoft.com/en-us/library/ms771573.aspx).

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-03-17T03:24:31.667

The Extented WPF Toolkit has one: [NumericUpDown](http://wpftoolkit.codeplex.com/wikipage?title=NumericUpDown&referringTitle=Home) ![enter image description here](https://i.stack.imgur.com/KbVoa.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-03T10:37:17.907

好吧，因为您使用的是 WPF，所以您可以更改 ListBoxItem 的模板，并在选择项目时将其更改为空（我的意思是删除触发器），仅此而已。
我希望它会有所帮助，除非您需要除此之外的其他东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T10:52:09.720

You can also attach a ScrollBar.Scroll event. This fires when you scroll. Maybe you can then change the SelectedIndex manually or set the focus?

# text-editor - 在 stackoverflow 中使用什么类型的文本框编辑器来提问和发布答案

> ID：943978
> 
> 赞同：0
> 
> 时间：2009-06-03T10:12:34.230
> 
> 标签：text-editor

在 stackoverflow 中使用什么类型的文本框编辑器来提问和发布答案。

我不确定，但听起来像是某种 jQuery 插件

任何人都可以帮助我们解决这个问题吗？

亲切的问候， Saurabh

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-12-08T12:42:22.327

它是大规模杀伤性武器的修改版本。

# jquery - 将jQuery单击处理程序添加到多个元素？

> ID：943987
> 
> 赞同：10
> 
> 时间：2009-06-03T10:14:17.143
> 
> 标签：jquery

我需要`for`在我的 jQuery 中有一个循环。

例子：

```
 for(i=0;i<counter;i++)
   {
    $("div"+i+"").click(function(){//some code});
   } 
```

我怎样才能做到这一点？

* * *

### 编辑：

此代码由 OP 在对其中一个答案的评论中发布：

```
$("#displayPanel div").click(function (){ alert($(this).attr("id")); } 

<div id="displayPanel" class="displayPanel"> 
  <div id="heading"> Display Panel </div> <br/> 
  <div id="save" class="saveClass"></div> <br/> 
  <div id="field1" class="my"> 
    <label id="labelstr1">Untitled1</label> 
    <input id="inputstr1" type="text"/> 
  </div> 
  <div id="field2" class="my"> 
    <label id="labelstr2">Untitled1</label> 
    <input id="inputstr2" type="text"/> 
  </div> 
</div> 
```

警报向我显示前两个`div`s 的 id 而不是`field1`and `field2`。

* * *

### 笔记：

`Field1`和`Field2` `div`s 是动态创建的。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-03T10:27:01.517

您可以将 div 放在一个通用类中

```
<div id="d1" class="your_css_class your_control_class">
<div id="d2" class="your_css_class your_control_class">
<div id="d3" class="your_css_class your_control_class">
<div id="d4" class="your_css_class your_control_class">
<div id="d5" class="your_css_class your_control_class">

$(".your_control_class").click(function(){
   var div_id=$(this).attr("id"); // gives you the ID of the clicked div
   if(div_id==="d1") functionForDiv1();
   else if(div_id==="d2") functionForDiv2();
   ...
}); 
```

编辑：

如果您在那个大 div 中拥有所有内容，那么您可以执行以下操作：

```
$("#displayPanel > div").click(function(){
... 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-03T10:21:50.420

该循环似乎没有必要，因为 div 的选择器将适用于所有 div。

```
$("div").click(function(){
  //this will apply to any div you click on the page
  //for example:
  $(this).css('color','red'); //change the color of the div clicked to red
}); 
```

**编辑**：由于您在编辑中提到 #field1 和 #field2 是动态创建的，因此您需要使用[.live()](http://docs.jquery.com/Events/live)绑定点击事件，如下所示：

```
$("#displayPanel div").live('click', function(){
  alert($(this).attr('id'));
}); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-03T10:17:18.727

例如，您可以像这样遍历所有 div：

```
$("div").each(function() {
    $(this).hide(); // this points to the current element
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-03T10:25:45.420

是的，您可以在 jQuery 中使用 for 循环，但从您的问题来看，您可能不需要它。当你使用

```
$('div').click(function(). { ... }); 
```

您可以使用一个命令将该函数绑定为所有 div 的事件处理程序。您还可以使用[context](http://beardscratchers.com/journal/jquery-its-all-about-context)、[类名](http://docs.jquery.com/Selectors/class#class)或[其他属性](http://docs.jquery.com/Selectors/attributeEquals#attributevalue)来过滤应用事件处理程序的 div。

如果您想为每个 div 执行不同的操作，最好在每个 div 上都有一个唯一的 ID，然后使用绑定事件处理程序

```
$('#divId').click(function() { ... }); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-17T14:32:08.373

假设 html 是

```
<div class="module">
  <div id="header1">h</div>
  <div id="content1">c</div>
</div>
<div class="module">
  <div id="header2">h</div>
  <div id="content2">c</div>
</div>
<div class="module">
  <div id="header3">h</div>
  <div id="content3">c</div>
</div> 
```

您可以使用 jquery 以这种方式循环：例如，当您单击标题时，内容被隐藏。

```
$(".module").each(function(index){
   $("#header"+index).click(function(){
      $("content"+index).hide()
   });
}); 
```

您可能想看看 jQuery.each(collection, callback(indexInArray, valueOfElement)) 函数[http://api.jquery.com/jQuery.each/](http://api.jquery.com/jQuery.each/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-03T10:23:05.893

这些`div`s 是否有共同的父级、属性或其他任何东西？通过某种形式的 ID 进行匹配（即`divXYZ`在您的情况下）可能不是最简单/最明显的事情。选择器的 API 文档包含[选择](http://docs.jquery.com/Selectors)元素的不同方式的完整列表。选择最适合的，JQuery 变得非常简单。

这是选择具有**共同父**级的 div 的示例：

```
$("#parent > div").click(function() {
    // some code
}); 
```

对于选择具有**共同属性**的 div （如果它们没有共同的父级，一种解决方案可能是给它们每个 cusotm 属性）：

```
$("div[fooAttribute]").click(function() {
    // some code
}); 
```

# php - 配置Easyphp将htm文件作为php处理

> ID：943990
> 
> 赞同：3
> 
> 时间：2009-06-03T10:15:13.850
> 
> 标签：php, easyphp

在我的远程服务器上，我使用该行
`AddType application/x-httpd-php .php .htm .html`
来解析具有 htm/html 扩展名的文件中的 php
如何在运行 EasyPHP 的本地计算机上复制此行为。
我尝试将同一行添加到 Apache/conf/httpd.conf 并重新启动服务器，但文件显示为 html 文件，而没有运行 php 代码。

各种 googles/php docs/stack/easyphp 文档搜索未能提供帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-16T05:11:58.410

您需要在 conf_files/httpd.conf 中添加同一行，
因为每次启动服务器时都会重新生成 apache/conf/httpd.conf。

# objective-c - 如何在 Objective-C 中编写 lambda 方法？

> ID：943992
> 
> 赞同：69
> 
> 时间：2009-06-03T10:16:13.537
> 
> 标签：objective-c, functional-programming, lambda

如何在 Objective-C 中编写 lambda 方法？

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2009-11-27T20:03:33.643

Objective-C 中的 lambda 概念现在被封装为 Blocks 的概念，[Blocks](http://developer.apple.com/mac/library/documentation/Cocoa/Conceptual/Blocks/index.html "块")相当于传递引用函数。当然，可以说在 C 语言中已经有了函数指针的概念。块只是捕获本地状态的一种方式（即可以是闭包）。事实上，块也可以用在其他 C 语言中（在 Mac 上）——有一个建议是让它们成为标准 C 语法的一部分。

这是一个定义 lambda 以将两个数字相乘的示例：

```
int (^mult)(int, int) = ^(int a, int b) { return a*b; }; 
```

第一部分声明一个类型的变量，`^int(int,int)`然后将其分配给 lambda 表达式（又名块），该表达式返回其两个参数的倍数。然后，您可以传递该 fn，在其他地方定义它等；您甚至可以在其他功能中使用它。

这是一个定义函数的示例，当调用该函数时，它会返回另一个函数：

```
multiplyBy = ^(int a) { return ^(int b) { return b*a; }; };
triple = multiplyBy(3); 
```

请注意，您可以将块与对象类型混合（通常`id`用作对象类型），并且许多新的 Objective-C 对象数据结构具有某种块级操作。GCD 也使用块来传递任意事件；但是，请注意 GCD 也可以与函数指针一起使用。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-06-03T11:42:11.850

OS X 10.6 引入了块。有关示例，请参见[AlBlue 的答案](https://stackoverflow.com/questions/943992/how-to-write-lambda-methods-in-objective-c/1810458#1810458)。

如果您不使用 Snow Leopard，则可以使用各种其他功能获得接近功能组合的东西。

使用 C 函数指针的示例：

```
void sayHello() {
    NSLog(@"Hello!");
}

void doSomethingTwice(void (*something)(void)) {
    something();
    something();
}

int main(void) {
    doSomethingTwice(sayHello);
    return 0;
} 
```

使用命令模式的示例：

```
@protocol Command <NSObject>
- (void) doSomething;
@end

@interface SayHello : NSObject <Command> {
}
@end

@implementation SayHello
- (void) doSomething {
    NSLog(@"Hello!");    
}
@end

void doSomethingTwice(id<Command> command) {
    [command doSomething];
    [command doSomething];
}

int main(void) {
    SayHello* sayHello = [[SayHello alloc] init];
    doSomethingTwice(sayHello);
    [sayHello release];
    return 0;
} 
```

使用选择器的示例：

```
@interface SaySomething : NSObject {
}
- (void) sayHello;
@end

@implementation SaySomething
- (void) sayHello {
    NSLog(@"Hello!");    
}
@end

void doSomethingTwice(id<NSObject> obj, SEL selector) {
    [obj performSelector:selector];
    [obj performSelector:selector];
}

int main(void) {
    SaySomething* saySomething = [[SaySomething alloc] init];
    doSomethingTwice(saySomething, @selector(sayHello));
    [saySomething release];
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-03T11:49:29.697

我在 NSConference 上听到 André Pang 谈论下一个版本的 Objective-C 将如何引入块。

这应该允许函数式编程。

编辑：自从雪豹发布以来，情况确实如此。Objective-C 现在有[Blocks](http://developer.apple.com/mac/library/documentation/Cocoa/Conceptual/Blocks/Articles/00_Introduction.html)。

# c# - 如何使用 C# 下载 Google 电子表格？

> ID：943995
> 
> 赞同：5
> 
> 时间：2009-06-03T10:16:32.020
> 
> 标签：c#, google-sheets, google-data-api

我可以使用我从网上找到的以下代码使用我的应用程序登录谷歌。它返回一个授权码作为响应。谷歌帮助说这个验证码应该被用来发送未来的 POST/GET 请求。

[我需要从http://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=DOCUMENT_ID&fmcmd=4](http://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=DOCUMENT_ID&fmcmd=4)下载 Excel 格式的电子表格， 当我登录到谷歌时，我通常可以从浏览器中执行此操作。

如何使用 C# 中的授权代码发送对上述文件的请求？我在 SO 中看到了一个使用 Google Data API 的线程。我不想利用它。

下面是登录的代码示例。它工作正常。

```
 string str = "/accounts/ClientLogin HTTP/1.0 Content-type: application/x-www-form-urlencoded accountType=GOOGLE&Email=myname@gmail.com&Passwd=password&service=cl&source=Gulp-CalGulp-1.05";

        string uri = "https://www.google.com/accounts/ClientLogin";

        HttpWebRequest request = (HttpWebRequest) WebRequest.Create(uri); 
        request.KeepAlive = false;
        request.ProtocolVersion = HttpVersion.Version10;
        request.Method = "POST";

        byte[] postBytes = Encoding.ASCII.GetBytes(str);

        request.ContentType = "application/x-www-form-urlencoded";
        request.ContentLength = postBytes.Length;
        Stream requestStream = request.GetRequestStream();

        requestStream.Write(postBytes, 0, postBytes.Length);
        requestStream.Close();

        HttpWebResponse response = (HttpWebResponse)request.GetResponse();
        StringBuilder sb = new StringBuilder();

        string webresponse = new StreamReader(response.GetResponseStream()).ReadToEnd();
        int AuthIndex = webresponse.IndexOf("Auth=");

        sb.Append(webresponse);
        sb.Append("\n");
        sb.Append(response.StatusCode);

        richTextBox1.Text = sb.ToString();
        string authCode = webresponse.Substring(AuthIndex + 5, webresponse.Length - (AuthIndex + 5)); 
```

已编辑：这是我根据 miffTheFox 回复的内容所做的回复：

```
<html><head><title>Redirecting</title>
<meta http-equiv="refresh" content="0; url=&#39;http://spreadsheets.google.com/feeds/download/spreadsheets/Export?key=p_zC6U3bOsLTuXeUdmQI1RA&amp;fmcmd=4&amp;pli=1&amp;auth=DQAAAIoAAAAfbQUnX8EaZzQcBSIRJSeU4xtFF6ITt9069JLJyJsoqFGMzSE8HrvArHmGPoA-Wf2CbhnDQv_bGKXye2_qyL6EAhTEdOs6Alz-VMeYFsqdGlYjxospBokgCO1958kSVuVFRe9UuKkfV2f_6ZX8SROMkMNdMz3MW8Wh3UNmflIX4E92CpnMleSjCRVpH9x5gSQ&amp;gausr=username%40gmail.com&#39;"></head>
<body bgcolor="#ffffff" text="#000000" link="#0000cc" vlink="#551a8b" alink="#ff0000"><script type="text/javascript" language="javascript">
    location.replace("http://spreadsheets.google.com/feeds/download/spreadsheets/Export?key\x3dp_zC6U3bOsLTuXeUdmQI1RA\x26fmcmd\x3d4\x26pli\x3d1\x26auth\x3dDQAAAIoAAAAfbQUnX8EaZzQcBSIRJSeU4xtFF6ITt9069JLJyJsoqFGMzSE8HrvArHmGPoA-Wf2CbhnDQv_bGKXye2_qyL6EAhTEdOs6Alz-VMeYFsqdGlYjxospBokgCO1958kSVuVFRe9UuKkfV2f_6ZX8SROMkMNdMz3MW8Wh3UNmflIX4E92CpnMleSjCRVpH9x5gSQ\x26gausr\x3dusername%40gmail.com")
  </script></body></html> 
```

如果我将流保存为 HTML 并在浏览器中打开它，则会提示下载我需要直接下载的 Excel 文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-03T10:24:10.430

实际上我之前做过一个类似的项目，只是它使用了谷歌阅读器，尽管我假设谷歌授权过程是相同的。

首先，对于您从登录获得的响应中的每个键/值对，您必须将其转换为 cookie。

```
string loginResponseText = new StreamReader(loginResponse.GetResponseStream()).ReadToEnd();
CookieContainer cookies = new CookieContainer();
foreach (string ln in loginResponseText.Split('\n'))
{
    if (!ln.Contains("=")) continue;
    string tId = ln.Substring(0, ln.IndexOf('=')).Trim();
    string tVal = ln.Substring(ln.IndexOf('=') + 1).Trim();
    cookies.Add(new Cookie(tId, tVal, "/", "www.google.com"));
} 
```

然后，您必须为您发出的请求设置 cookie 容器。

```
string url = string.Format("http://spreadsheets.google.com/feeds/download/spreadsheets/Export?key={0}&fmcmd=4", documentID);
HttpWebRequest rqForFile = (HttpWebRequest)WebRequest.Create(url);
rqForFile.CookieContainer = cookies;
WebResponse respForFile = rUnread.GetResponse(); 
```

享受！

**编辑**：如何解码返回的 HTML！

您需要使用正则表达式来解析 URL，然后使用一种方法对其进行 HTML 解码。对我们来说幸运的是，Microsoft 在 System.Web 中提供了一个。只需将它的引用添加到您的项目中。

确保将 using System.Text.RegularExpressions 添加到文件顶部！

```
Match m = Regex.Match("content=\"0; url=&#39;(.+)&#39;");
if (!m.Success) throw new Exception(); // Or some other method of making sure the result is okay.
string finalurl = m.Groups[1].ToString();
finalurl = System.Web.HttpUtility.HtmlDecode(finalurl); 
```

然后只需使用您的 CookieContianer 获取 finalurl！（这是未经测试的，但应该可以工作！）

# c# - 在自定义表更改时重新创建 Linq to Sql 代码

> ID：943996
> 
> 赞同：0
> 
> 时间：2009-06-03T10:16:34.267
> 
> 标签：c#, asp.net-mvc, visual-studio-2008, linq-to-sql

我有一个由 VS ORD 生成的 Linq to Sql 模型，但我想对其进行更改以解决几个问题。我可以更改`designer.cs`生成的代码，但是如果我需要在模型中重新创建一个表，那么我将其删除并将其拖回 ORD。然而，这失去了我所有的定制。还有其他方法吗？

我已经看到对[sqlMetal.exe](http://msdn.microsoft.com/en-us/library/bb386987.aspx)的引用，但不确定如何使用它来解决这个问题。

有关信息，我的定制如下：

1.  我正在使用`Guid`'s 并希望数据库默认这些值，因此我想更改默认的 linqtosl 行为以将属性添加`[Column(IsDbGenerated= true)]`到 ID 属性。
2.  MVC 的默认模型绑定不适用于集合 ( `EntitySet<T>`)。要解决这个问题，我需要稍微更改这些集合的设置器。

这些变化都不是特别大，但我的数据库可能会随着时间的推移发生很大变化，我需要记住每次都进行自定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-03T10:43:12.047

这就是[“部分”课程的全部内容](http://msdn.microsoft.com/en-us/library/wa80x488%28VS.80%29.aspx)。L2SQL 将您的实体类创建为“部分”，因此即使您重新创建实体模型，您也不必编辑设计器生成的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-09T19:23:54.047

我有同样的问题，并希望看到一个答案出现在这里，解决你提到的两点。（我为您的项目 #2 找到了另一种解决方法，尽管您在部分中使用 OnCreated() 的想法似乎比我目前正在做的更好。）

我最近确实遇到了一篇文章（我将在下面链接到），这可能是实现这些目标的适用解决方案。本文介绍了作者如何 (1) 使用 SQLMetal 生成 dbml 文件，(2) 运行一个自定义进程来解析和修改此 dbml 文件以满足他的需要，然后 (3) 再次使用 SQLMetal，这次输入修改后的dbml 文件，以便生成代码。对于小型项目/模式可能需要做很多工作，但我可以看到这对于大型项目来说可能是一个方便的解决方法。

这是链接：[http ://www.onedotnetway.com/enum-support-with-linq-to-sql-and-sqlmetal/](http://www.onedotnetway.com/enum-support-with-linq-to-sql-and-sqlmetal/)

祝你好运！-麦克风

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T19:47:33.127

我以前曾走过这条路，唯一可靠的方法是远离 sql​​metal.exe / dbml 路径并参与自定义类生成器，如 LINQ 到 T4 的 SQL 模板。

[http://l2st4.codeplex.com/](http://l2st4.codeplex.com/)

你需要使用这样的东西的原因是你需要让你的类生成器从不同的源中提取你的自定义更改信息。我最终将自定义放入 Dbml 传统上使用的生成的 XML 中。然后我修改了 t4 模板以吐出我需要的自定义类。

警告：这最终成为实施的一场**彻头彻尾的噩梦**，并被丢弃，取而代之的是自定义更改的记事本文件。我们只需要根据需要烧掉它们。IMO 这是 Linq2SQL 的最弱点之一，也是我为未来项目探索其他 ORM 的重要原因。******`