# StackOverflow 问答 12238000-12238999

# mysql - how to get the sum of group by in mysql

> ID：12238002
> 
> 赞同：0
> 
> 时间：2012-09-02T17:04:16.887
> 
> 标签：mysql, sql, aggregate-functions

I have the following tables:

**Fans**

`id, id_page, number_of_fans, created_at`

This table has many same `id_page` but it differs in `created_at`

**Page**

`id, id_facebook, id_keyword, is_processed (0/1)`

**keyword**

`id, keyword, category`

I am experimenting/trying sub-queries but I didn't get the result that I wanted, sometimes the query is very slow because of its complexity.

I would like the result to:

1.  I will get the latest(`created_at`) - (returns only 1 row from table `fans` per page) - `number_of_fans` in `fans` table by page and get the sum of all `number_of_fans` by group by `keyword`
2.  I will get all the pages group by `keyword`
3.  I will get all the pages group by `keyword` where `is_processed` = 1

How will it be possible to combine the result of 1, 2, 3 with just 1 query in MySQL?

Thank you.

Regards, bhadz

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:48:38.053

You're looking for the [groupwise maximum](http://dev.mysql.com/doc/en/example-maximum-column-group-row.html) from the `Fans` table: it can be found from grouping the table by page and selecting the maximum `created_at` value, this is then joined back to the `Fans` table to obtain the other columns from that maximum record:

```
SELECT   Keyword.keyword,
         SUM(Fans.number_of_fans) fans_of_all_pages,
         SUM(IF(Page.is_processed,Fans.number_of_fans,0)) fans_of_processed_pages
FROM     Fans NATURAL JOIN (
           SELECT   id_page, MAX(created_at) AS created_at
           FROM     Fans
           GROUP BY id_page
         ) t
    JOIN Page    ON    Page.id = Fans.id_page
    JOIN Keyword ON Keyword.id = Page.id_keyword
GROUP BY Keyword.id 
```

# python - Python：洗牌列表，但保持一些元素冻结

> ID：12238005
> 
> 赞同：15
> 
> 时间：2012-09-02T17:04:48.780
> 
> 标签：python, python-2.7

我有这样一个问题：

有一个类的元素列表`CAnswer`（无需描述类），我需要对其进行洗牌，但有一个限制 - 列表中的某些元素已`CAnswer.freeze`设置为`True`，并且这些元素不得洗牌，但仍保留在其原来的职位。因此，假设对于给定的列表：

```
[a, b, c, d, e, f] 
```

如果所有元素都是`CAnswer`, but的实例`c.freeze == True`，并且对于 others `freeze == False`，可能的结果可能是：

```
[e, a, c, f, b, d] 
```

所以索引为 2 的元素仍然在它的位置上。

实现它的最佳算法是什么？

先感谢您 ：）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-02T17:18:48.163

另一种解决方案：

```
# memorize position of fixed elements
fixed = [(pos, item) for (pos,item) in enumerate(items) if item.freeze]
# shuffle list
random.shuffle(items)
# swap fixed elements back to their original position
for pos, item in fixed:
    index = items.index(item)
    items[pos], items[index] = items[index], items[pos] 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-09-02T17:16:04.677

一种解决方案：

```
def fixed_shuffle(lst):
    unfrozen_indices, unfrozen_subset = zip(*[(i, e) for i, e in enumerate(lst)
                                            if not e.freeze])
    unfrozen_indices = list(unfrozen_indices)
    random.shuffle(unfrozen_indices)
    for i, e in zip(unfrozen_indices, unfrozen_subset):
        lst[i] = e 
```

注意：如果`lst`是一个[numpy 数组](http://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html)而不是常规列表，这可能会更简单一些：

```
def fixed_shuffle_numpy(lst):
    unfrozen_indices = [i for i, e in enumerate(lst) if not e.freeze]
    unfrozen_set = lst[unfrozen_indices]
    random.shuffle(unfrozen_set)
    lst[unfrozen_indices] = unfrozen_set 
```

其用法示例：

```
class CAnswer:
    def __init__(self, x, freeze=False):
        self.x = x
        self.freeze = freeze

    def __cmp__(self, other):
        return self.x.__cmp__(other.x)

    def __repr__(self):
        return "<CAnswer: %s>" % self.x

lst = [CAnswer(3), CAnswer(2), CAnswer(0, True), CAnswer(1), CAnswer(5),
       CAnswer(9, True), CAnswer(4)]

fixed_shuffle(lst) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-09-02T18:13:45.773

在线性时间，常数空间使用[`random.shuffle() source`](http://hg.python.org/cpython/file/2.7/Lib/random.py#l276)：

```
from random import random

def shuffle_with_freeze(x):
    for i in reversed(xrange(1, len(x))):
        if x[i].freeze: continue # fixed
        # pick an element in x[:i+1] with which to exchange x[i]
        j = int(random() * (i+1))
        if x[j].freeze: continue #NOTE: it might make it less random
        x[i], x[j] = x[j], x[i] # swap 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-03T00:50:32.363

过度设计的解决方案：创建一个包装类，其中包含未冻结元素的索引并模拟一个列表，并确保 setter 写入原始列表：

```
class IndexedFilterList:
    def __init__(self, originalList, filterFunc):
        self.originalList = originalList
        self.indexes = [i for i, x in enumerate(originalList) if filterFunc(x)]

    def __len__(self):
        return len(self.indexes)

    def __getitem__(self, i):
        return self.originalList[self.indexes[i]]

    def __setitem__(self, i, value):
        self.originalList[self.indexes[i]] = value 
```

并调用：

```
random.shuffle(IndexedFilterList(mylist, lambda c: not c.freeze)) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-10T13:34:40.260

使用列表具有快速删除和插入的事实：

*   枚举固定元素并复制它们及其索引
*   从列表中删除固定元素
*   洗牌剩余的子集
*   将固定元素放回

有关更通用的解决方案，请参阅[https://stackoverflow.com/a/25233037/3449962 。](https://stackoverflow.com/a/25233037/3449962)

这将使用内存开销取决于列表中固定元素的数量的就地操作。时间线性。一个可能的实现`shuffle_subset`：

```
#!/usr/bin/env python
"""Shuffle elements in a list, except for a sub-set of the elments.

The sub-set are those elements that should retain their position in
the list.  Some example usage:

>>> from collections import namedtuple
>>> class CAnswer(namedtuple("CAnswer","x fixed")):
...             def __bool__(self):
...                     return self.fixed is True
...             __nonzero__ = __bool__  # For Python 2\. Called by bool in Py2.
...             def __repr__(self):
...                     return "<CA: {}>".format(self.x)
...
>>> val = [3, 2, 0, 1, 5, 9, 4]
>>> fix = [2, 5]
>>> lst = [ CAnswer(v, i in fix) for i, v in enumerate(val)]

>>> print("Start   ", 0, ": ", lst)
Start    0 :  [<CA: 3>, <CA: 2>, <CA: 0>, <CA: 1>, <CA: 5>, <CA: 9>, <CA: 4>]

Using a predicate to filter.

>>> for i in range(4):  # doctest: +NORMALIZE_WHITESPACE
...     shuffle_subset(lst, lambda x : x.fixed)
...     print([lst[i] for i in fix], end=" ")
...
[<CA: 0>, <CA: 9>] [<CA: 0>, <CA: 9>] [<CA: 0>, <CA: 9>] [<CA: 0>, <CA: 9>]

>>> for i in range(4):                # doctest: +NORMALIZE_WHITESPACE
...     shuffle_subset(lst)           # predicate = bool()
...     print([lst[i] for i in fix], end=" ")
...
[<CA: 0>, <CA: 9>] [<CA: 0>, <CA: 9>] [<CA: 0>, <CA: 9>] [<CA: 0>, <CA: 9>]

"""
from __future__ import print_function
import random

def shuffle_subset(lst, predicate=None):
    """All elements in lst, except a sub-set, are shuffled.

    The predicate defines the sub-set of elements in lst that should
    not be shuffled:

      + The predicate is a callable that returns True for fixed
      elements, predicate(element) --> True or False.

      + If the predicate is None extract those elements where
      bool(element) == True.

    """
    predicate = bool if predicate is None else predicate
    fixed_subset = [(i, e) for i, e in enumerate(lst) if predicate(e)]

    fixed_subset.reverse()      # Delete fixed elements from high index to low.
    for i, _ in fixed_subset:
        del lst[i]

    random.shuffle(lst)

    fixed_subset.reverse()      # Insert fixed elements from low index to high.
    for i, e in fixed_subset:
        lst.insert(i, e)

if __name__ == "__main__":
    import doctest
    doctest.testmod() 
```

# javascript - Synchronising Events In Broswers On Different Computers

> ID：12238008
> 
> 赞同：1
> 
> 时间：2012-09-02T17:04:58.227
> 
> 标签：javascript, html, time, timer

I have been playing about with Javascript Drum Machines and Sequencers and thought it would be cool to build an HTML5 orchestra for children.

The idea is to make it as easy for 2,3,4 or 5 kids to start playing music live together on smart phones/iPads.

Writing an HTML5 touch keyboard to play different sounds is easy enough - but what I would like to do is to have the web page display the music and maybe do Guitar-Hero-style-press-this-key-now notifications - and also play a basic rhythm track.

So the plan is that you go to a web page and select a song and instrument and you get the base HTML skeleton, some sound files into the cache and a json document that describes the structure of the song: * tempo * key * what notes on what instruments to play with these durations on these beats on this bar

All very straightforward - except for one problem. I need to find a way to get the various browsers to synchronise time so that they are all (mostly) in synch with the rhythm track and the music display.

I looked at the time on various mobile phones and there was a drift of a couple of minutes so using phone time is no good.

I could make a server request for current time and offset to bandleader time but that would be tricky to align them - you might expect 200ms drift? more?

I could try and do a manual synching ("One, Two, Three, Now....") followed by a manual start ("One, Two, Three, Start").

Are there other synching options available via the browser? Bluetooth? The assumption is that the individuals will be physically present.

Thoughts, suggestions, comments on process or techniques both software, hardware and manual.

Is that is possible at all?

# c# - C# Databinding a sub collection of objects

> ID：12238009
> 
> 赞同：0
> 
> 时间：2012-09-02T17:05:09.320
> 
> 标签：c#, data-binding, collections

I'm databinding a collection of objects to a datagridview as follows:

```
 public BindingList<Selection> selections = new BindingList<Selection>();
    dgvSelections.DataSource = selections;
    if (!mainForm.selections.Contains(mySelection))
    {
       mainForm.selections.Add(mySelection);
       mainForm.dgvSelections.Refresh();                        
    }
    else
    {
       int index = mainForm.activeArbSelections.IndexOf(mySelection);
    } 
```

The 'Selection' object looks like this:

```
public class Selection : INotifyPropertyChanged, IComparable
{

    private Int64 id;
    public Int64 ID
    {
        get { return id; }
        set
        {
            id = value;
        }
    }

    public SortedDictionary<Int64, Quote> quotes = new SortedDictionary<Int64, Quote>();
    public SortedDictionary<Int64, Quote> Quotes
    {
        get { return quotes; }
        set
        {
            quotes = value;
            NotifyPropertyChanged("quotes");
        }
    } 
```

The 'Quote' object looks like this:

```
public class Quote
{
    public string name;
    public Int64 ID; 
```

When I databind the 'selections' collection to the dgvSelections datagridview, and add selections to the collection, the datagridview show the ID variable in the datagridview, and then just shows the text 'Collection' for the 'quotes' object as a placeholder, or object type or something.

How can I get the datagridview to display this following: for each row (selection) a cell for each quote in the 'quotes' collection showing the name and ID of the quote? In fact, I'd be happy enough with a cell for each quote, and some kind of concatenated text variable showing the name and ID as a string or something. Just in case: different rows (selections) may have a different number of quotes associated with it.

Basically, I can show each selection on a separate row, and have all the relevant variables in that selection diplayed in the datagridview, but am stuck with no way of showing all the quotes in the quotes collection in each of those selections.

I'd appreciate any pointers at all on this. Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:49:22.973

这是您必须寻找的 -[绑定到源的二级属性](http://blogs.msdn.com/b/msdnts/archive/2007/01/19/how-to-bind-a-datagridview-column-to-a-second-level-property-of-a-data-source.aspx "绑定到源的二级属性")

# java - Java - 找不到逻辑错误

> ID：12238012
> 
> 赞同：0
> 
> 时间：2012-09-02T17:05:20.163
> 
> 标签：java

所以我有这段代码提示输入两侧的空格分隔输入和三角形的斜边。如果三角形是正确的，则 main 下面的方法应该返回 true，否则返回 false。

出于某种原因，即使我知道我输入的测量值是针对直角三角形的，它仍然会打印出三角形不是直角三角形。

一段时间以来，我一直在尝试检测此代码中的逻辑错误，可以帮忙/叫我出来吗？

```
import java.util.Scanner; 
```

`public class VerifyRightTriangle { public static void main(String[] args) { Scanner sc = new Scanner(System.in);`

```
 System.out.print("Please enter the two sides and the hypotenuse: ");
    String input = sc.nextLine();

    String[] values = input.split(" ");

    int[] nums = new int[values.length];

    for (int i = 0; i < nums.length; i++) {
        nums[i] = Integer.parseInt(values[i]);
    }

    double s1 = nums[0];
    double s2 = nums[1];
    double hyp = nums[2];

    System.out.printf("Side 1: %.2f Side 2: %.2f Hypotenuse: %.2f\n", s1, s2, hyp);

    boolean result = isRightTriangle(s1, s2, hyp);

    if (result == true) {
        System.out.println("The given triangle is a right triangle.");
    } else if (result == false) {
        System.out.println("The given triangle is not a right triangle.");
    }
}

/**
 * Determine if the triangle is a right triangle or not, given the shorter side, the longer
 * side, and the hypotenuse (in that order), using the Pythagorean theorem.
 * @param s1 the shorter side of the triangle
 * @param s2 the longer side of the triangle
 * @param hyp the hypotenuse of the triangle
 * @return true if triangle is right, false if not
 */

private static boolean isRightTriangle(double s1, double s2, double hyp) {
    double leftSide = s1 * s1 + s2 * s2;
    double rightSide = hyp * hyp;
    if (Math.sqrt(leftSide) == Math.sqrt(rightSide)) {
        return true;
    } else {
        return false;
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:09:32.337

浮点计算不精确，这就是数字永远不匹配的原因，请尝试使用[BigDecimal](http://docs.oracle.com/javase/1.5.0/docs/api/java/math/BigDecimal.html)而不是`double`

编辑：重新考虑，因为您已经在解析整数 `nums[i] = Integer.parseInt(values[i]);`

简单地使用`int`代替`double`和不使用`Math.sqrt`，简单地使用`leftSide==rightside`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T17:12:40.713

您必须在`s1*s1 + s2*s2 == hyp*hyp`不使用的情况下进行检查`sqrt`。见[勾股定理](http://en.wikipedia.org/wiki/Pythagorean_theorem)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T17:16:22.103

鉴于输入是`int`值，您不应该有错误。如果我测试

```
public static void main(String... args) {
    for (int i = 3; i <= 11; i += 2) {
        int side1 = (i * i - 1) / 2;
        int side2 = side1 + 1;
        System.out.println(i + "," + (side1 - 1) + " and " + (side2 - 1) + " is " + isRightTriangle(i, side1 - 1, side2 - 1));
        System.out.println(i + "," + side1 + " and " + side2 + " is " + isRightTriangle(i, side1, side2));
        System.out.println(i + "," + (side1 + 1) + " and " + (side2 + 1) + " is " + isRightTriangle(i, side1 + 1, side2 + 1));
    }
} 
```

它打印

```
3,3 and 4 is false
3,4 and 5 is true
3,5 and 6 is false
5,11 and 12 is false
5,12 and 13 is true
5,13 and 14 is false
7,23 and 24 is false
7,24 and 25 is true
7,25 and 26 is false
9,39 and 40 is false
9,40 and 41 is true
9,41 and 42 is false
11,59 and 60 is false
11,60 and 61 is true
11,61 and 62 is false 
```

哪个是对的。

您能否提供此方法失败的用例？

* * *

试试这个，以允许出现一个小错误。

```
private static boolean isRightTriangle(double s1, double s2, double hyp) {
    double leftSide = s1 * s1 + s2 * s2;
    double rightSide = hyp * hyp;
    return Math.abs(leftSide - rightSide) < 1e-9;
} 
```

如果`sqrt`两个值的 相等，则这两个值相等。

Math.sqrt() 有一些错误，所以如果你能避免它，你应该这样做。

# winapi - Messagebox delay in Delphi

> ID：12238015
> 
> 赞同：2
> 
> 时间：2012-09-02T17:05:49.337
> 
> 标签：winapi, delphi-7, messagebox, delphi

I'm having problems with the messagebox API. I use messageboxw to ask a question to the user. For example my program is very busy with threads, etc. and when a user clicks on a button that shows the messagebox it doesn't show the messagebox until my program is less busy than before. When I remove the messagebox the code after it gets executed fine. I have too much code to show but maybe there is something that I have to take care of...

Anybody had this experience too?

Thanks for your help.

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-02T17:20:22.343

当您单击该按钮时，会发生消息被发布到消息队列中。在您下次抽出消息队列之前，它不会得到处理。因此，如果您在单击按钮和程序响应之间看到延迟，那是因为消息队列没有及时得到服务。

如果你的 GUI 线程很忙，那么在主线程完成它正在做的任何事情之前，消息队列都不会被抽取。如果你有长时间运行的任务，你的 GUI 线程会很忙。一旦排队的按钮点击消息最终得到处理，那么调用`MessageBoxW`将导致对话框立即显示。

GUI 线程无法运行的唯一其他原因是 CPU 被更高优先级的线程占用。但这不太可能。应用程序使用高优先级线程是非常不寻常的。如果你这样做，我会感到惊讶。

如何解决问题？如果您的主线程上有长时间运行的任务，请将这些任务移至后台线程。或者，如果您有停止 GUI 线程运行的高优先级线程，则以正常优先级运行您的后台线程。

# javascript - How to stop a JQuery UI addClass / removeClass?

> ID：12238016
> 
> 赞同：4
> 
> 时间：2012-09-02T17:05:54.150
> 
> 标签：javascript, jquery, jquery-ui, animation, addclass

I'm using JQuery UI to addClass(), and later to removeClass().

If removeClass() is called before addClass() completes, it queues up and executes later. This is not ideal, I'd rather have the removeClass() execute immediately from the current CSS values.

If I invoke stop() just before add/removeClass(), animation seems permanently 'frozen' at the moment of the stop() call, though the add/removeClass() callback still fires.

Just the JS here:

```
var obj = $("#obj");
obj.addClass("obj");

$("#add").click(function(){
    //obj.addClass("adder", 2000, "easeInOutCubic", onAdded);
    obj.stop().addClass("adder", 2000, "easeInOutCubic", onAdded);
});

$("#remove").click(function(){
    //obj.removeClass("adder", 2000, "easeInOutCubic", onRemoved);
    obj.stop().removeClass("adder", 2000, "easeInOutCubic", onRemoved);
});

function onAdded () { console.log("added"); }
function onRemoved () { console.log("removed"); } 
```

All the rest here: [http://jsfiddle.net/mmstM/42/](http://jsfiddle.net/mmstM/42/)

This seems like it would be a common issue but haven't found any good info on SO or elsewhere...note this is for JQuery *UI*, not core.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T17:24:34.553

出现此问题是因为即使在删除类之后，为动画生成的插页式大小规则仍然存在于元素的`style`属性中。

我们可以通过以下方式轻松修复该部分：

`obj.stop().attr("style", "").removeClass("adder", 2000, "easeInOutCubic", onRemoved);`

然而，这会导致动画中相当大的跳跃，**因为类操作的缓动没有考虑元素样式**——这与首先简单地清除队列不起作用的原因相同。我担心，快速解决这个问题非常难看：改用该`.animate()`方法，并将样式从类移动到您的 jQuery，如下所示：

```
$("#add").click(function(){
    //obj.addClass("adder", 2000, "easeInOutCubic", onAdded);
    obj.stop().animate({
        width: '200px',
        height: '80px',
    }, 2000, "easeInOutCubic", onAdded);
});

$("#remove").click(function(){
    //obj.removeClass("adder", 2000, "easeInOutCubic", onRemoved);
    obj.stop().animate({
        width: '40px',
        height: '40px',
    }, 2000, "easeInOutCubic", onRemoved);
}); 
```

您可以在此处查看工作示例[，](http://jsfiddle.net/mmstM/57/)其中有一个额外的技巧，可以从 CSS 加载宽度/高度值并将它们存储在对象中以模仿 add/removeClass() 语法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T17:27:23.077

问题是当您停止动画时，您的类不会应用于元素。它现在处于意料之外的状态。所以删除类没有效果，因为类没有应用于元素。

你最好的选择是做这样的事情：

[http://jsfiddle.net/nickaknudson/8UnRd/](http://jsfiddle.net/nickaknudson/8UnRd/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T19:23:35.483

这是我最终结束的地方：

```
$.fn.extend({
    animateClass: function (propNames, className, speed, easing, callback) {
        var $store = $("<div>").css('display', 'none').addClass(className);
        $("body").append($store);

        var i=0, len=propNames.length, name, propsMap={};
        for (i; i<len; i++) {
            name = propNames[i];
            propsMap[name] = $store.css(name);
        }
        $store.remove();

        this.stop().animate(propsMap, speed, easing, callback);
    }
});

var $obj = $("#obj");
$("#bigger").click(function(){
    $obj.animateClass(["width", "height"], "bigger", 2000, "easeOutQuad", function () { console.log("BIG"); });
}); 
```

[​这里](http://jsfiddle.net/mmstM/64/)有多个状态的工作示例。

这不是最漂亮的事情，因为它需要传递要在动画中使用的 CSS 属性列表，而不仅仅是使用样式表中的所有内容，但我找不到将样式表中指定的属性与所有其他属性分开的方法样式已经在 animateClass() 中创建的虚拟“$store”div 上。

我会接受@sudowned 的回答，因为它对带领我到这里最有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T07:53:49.847

为什么不搜索样式表，获取 cssText，然后将其（我不确定如何以最佳方式执行此操作）解析为 JS 对象？

通过比较CSS 规则的成员，可以使用`document.stylesheets[i].rules`数组搜索样式表。`selectorText`

[animateToSelector](http://james.padolsey.com/javascript/animatetoselector-jquery-plugin/)是一个可以实现这两个功能的 jQuery 插件。

主要问题是它不灵活。我无法为（比如说）鼠标悬停的元素的子元素设置动画。理想情况下，我们应该简单地获取我们可以传递给的样式对象`animate()`

这种解决方案会很棒，因为 jQuery-UI addClass 不支持多个选择器（AFAIK）。

# php - Making a 3d Array with PHP Mysql

> ID：12238018
> 
> 赞同：2
> 
> 时间：2012-09-02T17:06:32.497
> 
> 标签：php, mysql, database, arrays

I want to create a Array with multidimension arrays from a database. The Database has 3 tables, one for vehicle, one for damages and one for damagesPhotos.

Table vehicle has two columns **id** and **name**

Table damages has four columns **damagesID**, **vehicleID**, **damagesType** and **damagesDescription**.

Table damagesPhotos has three columns **damagesPhotoID**, **damagesID** and **damagesPhotoUrl**

I need to combine thoose three columns into an array, that looks like this:

```
$vehicle = array( 
"id" => "somestring", 
"name" => "somestring", 
"damages" => array( 
    "damagesType" => "somestring", 
    "damagesDescription" => "somestring", 
    "photoOfDamages" => array( 
            "damagesPhotoUrl" => "somestring" 
    ) 
) 
); 
```

I'am using this code:

```
$query = "SELECT * from vehicle v LEFT JOIN damages d ON v.id = d.vehicleID LEFT JOIN   damagesPhotos p ON d.damagesID = p.damagesID WHERE d.damagesID = p.damagesID AND v.id = 1";

$result = mysql_query($query);

$i = 0;
$vehicle = array();
while($row = mysql_fetch_array($result)){
    $vehicle[$i] = array( 
        "id" => $row[id], 
        "name" => $row[name], 
        "damages" => array( 
            "damagesType" => $row[damagesType], 
            "damagesDescription" => $row[damagesDescription], 
            "photoOfDamages" => array( 
                    "damagesPhotoUrl" => $row[damagesPhotoUrl] 
        ) 
        )
  );
  $i++;
  } 
```

And it returns this:

```
 [{"vehilceId":"1",
  "name":"AW55005",
  "damages":{
        "damagesType":"Exterior",
        "damagesDescription":"Rust",
        "photoOfDamages":{
              "damagesPhotoUrl":"link to damagesPhoto 01"
        }
  }
  },

  {"vehilceId":"1",
  "name":"AW55005",
  "damages":{
        "damagesType":"Exterior",
        "damagesDescription":"Rust",
        "photoOfDamages":{
              "damagesPhotoUrl":"link to damagesPhoto 02"
  }
  }
  },

  {"vehilceId":"1",
  "name":"AW55005",
  "damages":{
        "damagesType":"Interior",
        "damagesDescription":"Scratch",
        "photoOfDamages":{
              "damagesPhotoUrl":"link to damagesPhoto 03"
        }
  }
  } 
```

But as you can see the first two objects are the same only the damagesPhotoUrl is different. How do I merge thoose two array so it will look like this:

```
{"vehilceId":"1",
"name":"AW55005",
"damages":{
    "damagesType":"Exterior",
    "damagesDescription":"Rust",
    "photoOfDamages":{
        {"damagesPhotoUrl":"link to damagesPhoto 01"},
        {"damagesPhotoUrl":"link to damagesPhoto 02"}
    }
}
}, ... 
```

Thanks in advance.

/ Morten

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:22:43.013

理想情况下，我建议您将原始查询分成三个单独的查询并构建关联数组，首先处理来自“Vehicle”表的结果，然后使用“damages”表和来自“damagesPhotos”表的结果。

但是，如果您仍然只想进行一次查询，那么您就是这样做的，请注意我已经修改了代码以支持每辆车多次损坏和每次损坏一张以上的照片：

```
$query = "SELECT * from vehicle v LEFT JOIN damages d ON v.id = d.vehicleID LEFT JOIN   damagesPhotos p ON d.damagesID = p.damagesID WHERE d.damagesID = p.damagesID AND v.id = 1";

$result = mysql_query($query);

$i = 0;
$vehicle = array();
while($row = mysql_fetch_array($result)){
    $id = $row['id'];
    $damageId  = $row['damageId'];
    $damagesPhotoId = $row['damagesId'];

    if (!isset($vehicle[$id])) {
        $vehicle[$id] =  array(
            'id' => $id,
            'name' => $row['name'],
            'damages' => array(
            )
        )
    }
    if (!isset($vehicle[$id]['damages'][$damageId])) {
        $vehicle[$id]['damages'][$damageId] = array(
            'damagesType' => $row['damagesType'],
            'damageDescription' = $row['damageDescription'],
            'photoOfDamages' => array ()
        )
    }
    $vehicle[$id]['damages'][$damageId]['photoOfDamages'][] = array(
        'damagesPhotoUrl' => $row['damagesPhotoUrl']
    )
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T17:22:58.287

答案是你不能这样做：
你想要的是这样的：

```
"photoOfDamages":{
    {"damagesPhotoUrl":"link to damagesPhoto 01"},
    {"damagesPhotoUrl":"link to damagesPhoto 02"}
} 
```

但是如果您尝试将具有相同键的值添加到关联数组，它将覆盖最后一个值，这意味着，如果您将创建：

```
"photoOfDamages":{
    {"damagesPhotoUrl":"link to damagesPhoto 01"}
} 
```

并尝试添加：

```
{"damagesPhotoUrl":"link to damagesPhoto 02"} 
```

结果将是：

```
"photoOfDamages":{
    {"damagesPhotoUrl":"link to damagesPhoto 02"}
} 
```

为了解决这个问题，您需要做的是更改`key`连接运行计数器，例如：

```
"photoOfDamages":{
    {"damagesPhotoUrl-1":"link to damagesPhoto 01"},
    {"damagesPhotoUrl-2":"link to damagesPhoto 02"}
} 
```

至于完成工作的代码，以下是一个示例 - 为了使其适合您，您应该取消注释，注释行并注释`line with the`foreach`
：

```
<?php

$rows = array(
    array(//vehicle 1 
            "id" => "somestring",
            "name" => "somestring",
            "damages" => array( 
                "damagesType" => "somestring", 
                "damagesDescription" => "somestring", 
                "photoOfDamages" => array( 
                            "damagesPhotoUrl" => "somestring1")
        )
    ),
     array(//vehicle 2
            "id" => "somestring",
            "name" => "somestring",
            "damages" => array( 
                "damagesType" => "somestring", 
                "damagesDescription" => "somestring", 
                "photoOfDamages" => array( 
                            "damagesPhotoUrl" => "somestring2")
        )
    )
);
$i = 0;
//$row = mysql_fetch_array($result);
//while($row){
foreach($rows as $row){ //this should be commented
    if($id === $row["id"]){
        $j++;
        $vehicle[$i]["damages"]["photoOfDamages"]["damagesPhotoUrl-$j"] = $row["damages"]["photoOfDamages"]["damagesPhotoUrl"];          
        continue;
    }
    $j = 1;
    $i++;
    $id = $row["id"];
    $vehicle[$i] = array( 
        "id" => $id, 
        "name" => $row[name], 
        "damages" => array( 
            "damagesType" => $row["damages"]["damagesType"], 
            "damagesDescription" => $row["damages"]["damagesDescription"], 
            "photoOfDamages" => array( 
                    "damagesPhotoUrl-$j" => $row["damages"]["photoOfDamages"]["damagesPhotoUrl"]  
            ) 
        )
  );
  //$row = mysql_fetch_array($result);      
}
print_r($vehicle);
?> 
```

**输出：**

```
Array
(
    [1] => Array
        (
            [id] => somestring
            [name] => somestring
            [damages] => Array
                (
                    [damagesType] => somestring
                    [damagesDescription] => somestring
                    [photoOfDamages] => Array
                        (
                            [damagesPhotoUrl-1] => somestring1
                            [damagesPhotoUrl-2] => somestring2
                        )

                )

        )

) 
```

# string - Is there a clojure function between read-string and load-string?

> ID：12238024
> 
> 赞同：3
> 
> 时间：2012-09-02T17:07:15.270
> 
> 标签：string, list, clojure

I would like to read the entire string into a list, but not evaluate it. wtf? is the function or mix of functions which I can not find to do this.

```
user=> (wtf?  " S  I I ( S I I)")
(S I I (S I I)) 
```

The function should also work as:

```
user=> (last (wtf?  " S  I I ( S I I)"))
(S I I) 
```

read-string returns only the first object, while load-string returns them all, but tries to evaluate them.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T17:12:29.403

这就是我使用的：

```
(defn safe-read
  "Evaluate the string in a safe way"
  [s]
  (binding [*read-eval* false]
    (read-string s))) 
```

从文档：

> “当设置为逻辑假时，在线程本地绑定的读取/加载中禁用 EvalReader (#=(...))。例如：
> 
> ```
> (binding [*read-eval* false] (read-string \"#=(eval (def x 3))\")) 
> ```

所以它的作用是像往常一样读取字符串，但禁用评估。

因此，您可以使用此功能读取打印出来的地图、列表和矢量，而不必担心评估恶意代码。（好吧，我确定这在多大程度上是安全的，但对于日常使用来说，它可以完成这项工作）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T17:46:50.027

我就是个菜鸟。我很高兴了解安全阅读，但似乎我最初的问题是通过在表单周围添加 () 来解决的，这是我在尝试安全阅读时无意中所做的。

```
user=> (read-string  "( S  I I ( S I I))")
(S I I (S I I))

user=> (last (read-string  "( S  I I ( S I I))"))
(S I I) 
```

# php - Performing a Select statement with MSSQL (does work with MySQL)

> ID：12238026
> 
> 赞同：4
> 
> 时间：2012-09-02T17:07:47.070
> 
> 标签：php, mysql, sql-server

I have connected to MSSQL, but i am unaware to do a select statement and print it out. I have done this using MySQL, but unable to convert it to MSSQL. Can someone help me to find the equvalent for `mysql_query`,`mysql_real_escape_string`,`mysql_num_rows`,`mysql_fetch_array` or a sample code that helps.

```
// Connecting to MSSQL -  Working
$name = $_POST['myname'];
$x=mysql_query("SELECT * FROM MyTable WHERE Name='".mysql_real_escape_string($name)."'");
$num_rows = mysql_num_rows($x);    
  while($norows = mysql_fetch_array($x)) {
// PRINT ROW
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T17:11:14.510

[使用 mssql_* 函数](http://www.php.net/manual/en/function.mssql-connect.php)

或尝试 PDO：[PDO_SQLSRV 驱动程序](http://php.net/manual/en/ref.pdo-sqlsrv.php)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T17:12:00.463

在 MSSQL 中有以下替代函数：

```
mysql_query              ---> mssql_query
mysql_num_rows           ---> mssql_num_rows
mysql_fetch_array        ---> mssql_fetch_array 
```

[请查看此处](http://php.net/manual/en/book.mssql.php)的官方文档以获取更多信息...

唯一缺少的函数是转义字符串（`mysql_real_escape_string`），为此您可以为自己定义一个像这样的函数：

```
function mssql_escape($str) {
    if(get_magic_quotes_gpc())
    {
        $str= stripslashes($str);
    }
    return str_replace("'", "''", $str);
} 
```

# c# - 如何在没有中间对象的情况下按字母顺序对两个单独的列表进行排序？

> ID：12238027
> 
> 赞同：1
> 
> 时间：2012-09-02T17:07:51.897
> 
> 标签：c#, linq

我有以下问题，不知道如何解决。

我需要对两组项目（例如汽车和摩托车）进行分页。我需要一个按字母顺序排序的列表，单击该列表时会定向到该项目的信息页面。这以 10 个一组的形式显示，并带有一个后退/下一步按钮。

我的实际课程具有非常不同的属性集。我不想为汽车和摩托车开设一个课程。

这两个项目都有 Id、Name 和 Description 属性，但其余属性是唯一的（无论是 Car 还是 Motorcycle 项目）。

将两个列表分组、按字母顺序排序、然后选择所需项目（例如合并列表中的项目 11-20）的最佳方法是什么？现在，我正在通过执行以下操作（有效）将所有项目转换为 DisplayItem 类，但不适用于大型项目组。

```
IEnumerable<DisplayItem> entities = cars.Select(b => new DisplayItem(b)).Union(motorcycles.Select(a => new DisplayItem(a))).Skip(10).Take(10); 
```

这样做的正确方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T17:11:45.197

您可以创建两个类都实现的包含 sortable 属性的接口：

```
interface ISortableItem
{
  string Name { get; }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T17:11:12.150

您可以使用 Id、Name 和 Description 属性创建一个接口，并让 Car 和 Motorcycle 类实现该接口。

```
public interface IDisplayable
{
    int Id {get; }
    string Name { get; }
    string Description { get; }
}

public class Car : IDisplayable
{
    ...
} 
```

然后你可以做

```
IEnumerable<IDisplayable> entities = cars.Select(b => (IDisplayable)b).Union(motorcycles.Select(a => (IDisplayable)a)).Skip(10).Take(10); 
```

# html - HTML & CSS：如何完全删除侧面的滚动条 ?

> ID：12238036
> 
> 赞同：1
> 
> 时间：2012-09-02T17:09:31.027
> 
> 标签：html, css

我在删除标签侧面的滚动条时遇到问题。我已经阅读了一些关于添加溢出：隐藏属性的内容，但我仍然怀疑如何（以及在​​哪里）应用该属性。你能帮我吗？

HTML：

```
<html>

<head>
    <title>Circle Motion</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
</head>

<body> 
    <div id="outer-wrapper">
        <div id="wrapper">

            <div id="top">  
            </div>

            <div id="box_1">
            <img src="chrome_400x400.png" />
            </div>

            <div id="box_2">
            </div>

        </div>
    </div>
</body> 
```

CSS：

```
#outer-wrapper {
height: 100%;
width: 1000px;
margin: 0px auto;
background-color: EAFFDB;
-moz-border-radius: 15px;
border-radius: 15px;
}

#wrapper {
height: 100%;
width: 960px;
margin: 0px auto;
background-color: EAFFDB;
overflow: auto;
}

#top {
width: 900px;
height: 110px;
margin-top: 35px;
margin-left: auto;
margin-right: auto;
margin-bottom: 35px;
background-color: white;
-moz-border-radius: 15px;
border-radius: 15px;
}

#box_1 {
width: 430px;
height: 430px;
background-color: black;
-moz-border-radius: 15px;
border-radius: 15px;
float:left;
margin-left: 30px;
margin-bottom: 30px;
text-align: center;
}

#box_1 img {
margin: 15px 0px;
}

#box_2 {
width: 430px;
height: 430px;
background-color: white;
-moz-border-radius: 15px;
border-radius: 15px;
float:right;
margin-right: 30px;
margin-bottom: 30px;
text-align: center;
}       

#box_1 img {
margin: 15px 0px;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T17:15:23.610

它应该在您的`#wrapper`样式中；

```
#wrapper {
height: 100%;
width: 960px;
margin: 0px auto;
background-color: #EAFFDB; /*note you were missing this hashtag before the color, which might work, but this is safer*/
overflow: hidden; /*this was auto, while it should be hidden*/
} 
```

希望这有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T17:18:09.790

是的，您应该应用`overflow:hidden`到必须从中删除滚动条的元素。

而且您在十六进制颜色代码之前缺少主题标签（＃）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T17:18:40.877

在课堂上使用`overflow: hidden;`而不是`overflow: auto;``#wrapper`

# wix - WIX：使用条件停止卸载？

> ID：12238041
> 
> 赞同：1
> 
> 时间：2012-09-02T17:10:02.957
> 
> 标签：wix, windows-installer

我正在用 DLL 中定义的自定义操作在 WiX 中编写安装程序文件。自定义操作在卸载时运行，如果失败，我希望它停止卸载过程并回滚。该操作不会影响系统，因此我可以在之前调用它`InstallInitialize`，因此它不应该有其他要撤消的更改。

有人告诉我，如果我为自定义操作定义了一个属性，那么我可以使用它`condition`来停止卸载过程，如下所示：

```
<SetProperty Id="CA_mine" 
             Value="No" Sequence="execute" 
             Before="CA_mine">
  Installed AND remove=ALL
</SetProperty> 
<CustomAction Id="CA_mine" BinaryKey="BIN_mine" DllEntry="mine" Execute="immediate"/>
<InstallExecuteSequence>
  <Custom Action="CA_mine"
          Before="InstallInitialize">
    Installed AND remove=ALL      
  </Custom>
</InstallExecuteSequence>

<Condition>
  NOT (Installed AND remove=ALL)  OR [CA_mine] = "No"
</Condition> 
```

如果我希望卸载停止，`mine`则将属性设置为“是”。`CA_mine`

这甚至会起作用吗？何时`condition`评估标签？`mine`有没有更简单的方法来实现我的目标（失败时回滚卸载）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T17:22:41.577

Condition 元素嵌套在 Product 元素下时，指的是 LaunchConditions 表。

您的自定义操作需要在[LaunchConditions 操作](http://msdn.microsoft.com/en-us/library/windows/desktop/aa369751%28v=vs.85%29.aspx)之前安排，以便设置该属性并可用于评估。将其视为[AppSearch 操作](http://msdn.microsoft.com/en-us/library/windows/desktop/aa367578%28v=vs.85%29.aspx)的扩展。

# scala - Typesafe SBT - 从 Play 2.0.2 更新到 Play 2.0.3

> ID：12238045
> 
> 赞同：1
> 
> 时间：2012-09-02T17:10:44.377
> 
> 标签：scala, playframework, playframework-2.0, sbt

我正在使用 Typesafe 的 0.11.3 版本的 sbt 工具，它嵌入了 2.0.2 的 Play Framework。然而，2.0.3 已经发布，它有一个我想得到的错误修复。

是否有一些命令可以从 sbt 工具运行并更新所有工具？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:49:56.863

更改 project/plugins.sbt 文件中的播放版本。

附录：sbt 没有嵌入 play，play 只是一个库，作为插件添加到你的项目中。插件通常定义在 project/plugins.sbt 文件中，因此您只需使用适当的版本对其进行修改并重新加载项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T00:29:30.920

您需要下载最新版本的 Play。然后更新项目中的 plugins.sbt 文件并运行“播放更新”。

# javascript - Ember.js 和 connectOutlet 模板上下文问题

> ID：12238046
> 
> 赞同：1
> 
> 时间：2012-09-02T17:10:45.930
> 
> 标签：javascript, ember.js

我正在尝试遵循 Ember.js 文档中的“Ember 应用程序架构”指南，以便制作一个带有插座和路由的 simpla 应用程序，但有些事情一直困扰着我。

为什么 ember 路由器将控制器设置为模板的数据上下文，而不是视图对象？这搞砸了一切。例如，如果由于 URL 更改而必须呈现以下模板并将其附加到插座：

```
<script data-template-name="feed_template" type="text/x-handlebars">
    <h1>The feeds<h1>
    {{this}}
    {{#each items}}
      <a href="#" {{action "onClick"}}>test</a>
    {{/each}}
  </script> 
```

模板的数据上下文是一个控制器，而不是一个视图对象。还是可以的，但是，现在 {{action}} 交互似乎都不起作用，因为，你猜怎么着，上下文不同......

那我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:49:46.880

从 ember-1.0.pre 版本开始，操作的上下文已更改为路由器。因此，默认情况下，您的 onClick 操作将由路由器处理。要将其更改为视图，您必须在操作上显式设置目标或设置`controller.target`属性。要将视图设置为操作的目标：

```
<script data-template-name="feed_template" type="text/x-handlebars">
    <h1>The feeds<h1>
    {{this}}
    {{#each items}}
      <a href="#" {{action onClick target="view"}}>test</a>
    {{/each}}
</script> 
```

# windows - 如何检查 Emacs 框架是否在 MS Windows 上最大化？

> ID：12238049
> 
> 赞同：0
> 
> 时间：2012-09-02T17:11:20.663
> 
> 标签：windows, emacs

表达方式

```
(frame-parameter nil 'fullscreen) 
```

`nil`即使在框架最大化时也会返回。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:25:03.970

```
(cdr (assoc 'fullscreen (frame-parameters))) 
```

应该在两边都最大化时返回'fullboth。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T13:35:57.883

我认为这取决于你如何最大化它：如果你只是告诉你的窗口管理器最大化，Emacs 不会知道它。而如果您告诉 Emacs 最大化帧，则`fullscreen`帧参数应该是非零（如果它是零，则 IOW，您应该将其报告给`M-x report-emacs-bug`）。

# javascript - 替换正则表达式中的文本

> ID：12238053
> 
> 赞同：0
> 
> 时间：2012-09-02T17:11:45.133
> 
> 标签：javascript, regex

我需要使用 javascript 和正则表达式替换文本。这样，borex、edge 和 rss feeds 就会被**borex**、**edge**和**rss** feeds 替换。文本显示如下。

```
<body>
<img src="http://some.web.site/image.jpg" title="borex" />
These words are highlighted: borex, edge, rss feeds while these words are not: bewedge, borexlumina, rss feedssss
</body> 
```

替换为：

```
<body>
<img src="http://some.web.site/image.jpg" title="borex" />
These words are highlighted: <b>borex</b>, <b>edge</b>, <b>rss feeds</b> while these words are not: bewedge, borexlumina, rss feedssss
</body> 
```

我试过：

```
var str = document.getElementByTagName("body")
 str.replace(/borex/g,'<b>borex</b>').replace(/edge/g,'<b>edge</b>').replace(/rss feeds/,'<b>rss feeds</b>') 
```

这得到了他们所有人。我如何只得到不属于另一个单词的单词？欢迎任何其他建议..需要一些帮助...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T17:14:08.403

用于`\b`表示[单词边界](https://stackoverflow.com/questions/1324676/what-is-a-word-boundary-in-regexes#answer-1324756)：

```
str.replace(/\b(borex|edge|rss feeds)\b/g, '<b>$1</b>'); 
```

这是小提琴：http: [//jsfiddle.net/ELaWZ/](http://jsfiddle.net/ELaWZ/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T17:14:42.950

使用正则表达式[单词边界](http://www.regular-expressions.info/wordboundaries.html)：

```
str.replace(/\bborex\b/g,'<b>borex</b>').replace(/\bedge\b/g,'<b>edge</b>').replace(/\brss feeds\b/,'<b>rss feeds</b>') 
```

# facebook - 如何从我的应用程序中删除付款

> ID：12238059
> 
> 赞同：0
> 
> 时间：2012-09-02T17:12:11.420
> 
> 标签：facebook, facebook-credits, credits

有没有办法从我的应用程序中删除“付款”？以前没用过，以后也不想用，也不想每天都收到 Credits 邮件。

问候， Code.Working

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:18:07.980

请按照以下说明从您的 Facebook 帐户中删除您的付款信息。请注意，如果您在朋友或家人的账户上进行了任何付款，您的付款信息将被存储在他们的账户中，除非被手动删除。

要从 Facebook 删除您的付款信息：

*   登录帐户
*   进入首页右上角“账户”下拉菜单中的“账户设置”
*   点击“付款”
*   在付款方式旁边，点击“管理”

然后，您可以删除您的信用卡、PayPal 帐户或手机号码。

# javascript - 使用 JQUERY 过滤 JSON 数据

> ID：12238072
> 
> 赞同：3
> 
> 时间：2012-09-02T17:12:53.963
> 
> 标签：javascript, jquery, json, format, filtering

我无法使用 jquery 和 JSON 过滤数据。我正在尝试删除 ID 为“234”或名称为“Alan Ford”的每个对象作为发件人。因为我想制作一个将由收件箱/发件箱分开的消息传递系统，并且由于 Alan Ford 是发送者，所以我需要将它们分开而不直接篡改 JSON。

这是代码：

```
$(document).ready(function(){
    $.getJSON('public/js/data.json', function(json){
        $.each(json.data, function(i, data){
        if(data.from.id == "234"){         //if is not working correctly
                $("p").remove();
                $("h1").remove();
                $("h2").remove();
                $("hr").remove()}
            $("#inbox").append(
            '<div class="post">'+
            'To: '+data.to.name+''+
            ''+data.subject+''+
            ''+data.message_formatted+''+
            'added: '+data.date_sent_formatted.formatted+''+
            'Sender: '+data.from.name+''+
            '<hr />'+
        '</div>'
    );
});
    });

}); 
```

和 JSON：

```
{
   "data":[
      {
         "id":"2146",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"4949",
            "name":"Eric Owens"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1344359836",
         "date_read":"0",
         "subject":"test",
         "message":"test inbox",
         "message_formatted":"test inbox",
         "date_sent_formatted":{
            "id":1196,
            "timestamp":1344297600,
            "month":8,
            "day":7,
            "year":2012,
            "week":32,
            "dayid":3,
            "weekday":"Tue",
            "mname":"Aug",
            "formatted":"Aug 7, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2048",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"8110",
            "name":"Event"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1343248577",
         "date_read":"0",
         "subject":"afd",
         "message":"asdfads",
         "message_formatted":"asdfads",
         "date_sent_formatted":{
            "id":1184,
            "timestamp":1343260800,
            "month":7,
            "day":26,
            "year":2012,
            "week":30,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jul",
            "formatted":"Jul 26, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2047",
         "from":{
            "id":"5245",
            "name":"Ian Graham"
         },
         "to":{
            "id":"234",
            "name":"Alan Ford"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1343234342",
         "date_read":"1343837983",
         "subject":"re: This is SP",
         "message":"Hi How are you[quote=Alan Ford]This is SP..Thais is SP[\/quote]",
         "message_formatted":"Hi How are you",
         "date_sent_formatted":{
            "id":1183,
            "timestamp":1343174400,
            "month":7,
            "day":25,
            "year":2012,
            "week":30,
            "dayid":4,
            "weekday":"Wed",
            "mname":"Jul",
            "formatted":"Jul 25, 2012"
         },
         "date_read_formatted":{
            "id":1190,
            "timestamp":1343779200,
            "month":8,
            "day":1,
            "year":2012,
            "week":31,
            "dayid":4,
            "weekday":"Wed",
            "mname":"Aug",
            "formatted":"Aug 1, 2012"
         }
      },
      {
         "id":"2046",
         "from":{
            "id":"5245",
            "name":"Ian Graham"
         },
         "to":{
            "id":"234",
            "name":"Alan Ford"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1343232908",
         "date_read":"1344001216",
         "subject":"Hello",
         "message":"Hi",
         "message_formatted":"Hi",
         "date_sent_formatted":{
            "id":1183,
            "timestamp":1343174400,
            "month":7,
            "day":25,
            "year":2012,
            "week":30,
            "dayid":4,
            "weekday":"Wed",
            "mname":"Jul",
            "formatted":"Jul 25, 2012"
         },
         "date_read_formatted":{
            "id":1192,
            "timestamp":1343952000,
            "month":8,
            "day":3,
            "year":2012,
            "week":31,
            "dayid":6,
            "weekday":"Fri",
            "mname":"Aug",
            "formatted":"Aug 3, 2012"
         }
      },
      {
         "id":"2043",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5399",
            "name":"Kob Bryant"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1342560365",
         "date_read":"0",
         "subject":"asda",
         "message":"ASDASDAS",
         "message_formatted":"ASDASDAS",
         "date_sent_formatted":{
            "id":1176,
            "timestamp":1342569600,
            "month":7,
            "day":18,
            "year":2012,
            "week":29,
            "dayid":4,
            "weekday":"Wed",
            "mname":"Jul",
            "formatted":"Jul 18, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2042",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5226",
            "name":"1341478142_Kareena kapoor"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1341364262",
         "date_read":"0",
         "subject":"adaasd",
         "message":"asdadadas",
         "message_formatted":"asdadadas",
         "date_sent_formatted":{
            "id":1162,
            "timestamp":1341360000,
            "month":7,
            "day":4,
            "year":2012,
            "week":27,
            "dayid":4,
            "weekday":"Wed",
            "mname":"Jul",
            "formatted":"Jul 4, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2041",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5226",
            "name":"1341478142_Kareena kapoor"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1341091202",
         "date_read":"0",
         "subject":"asdasd",
         "message":"asdasfagfsdgsgsgasg",
         "message_formatted":"asdasfagfsdgsgsgasg",
         "date_sent_formatted":{
            "id":1159,
            "timestamp":1341100800,
            "month":7,
            "day":1,
            "year":2012,
            "week":26,
            "dayid":1,
            "weekday":"Sun",
            "mname":"Jul",
            "formatted":"Jul 1, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2040",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5226",
            "name":"1341478142_Kareena kapoor"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1341091171",
         "date_read":"0",
         "subject":"asdad",
         "message":"adasdasdada",
         "message_formatted":"adasdasdada",
         "date_sent_formatted":{
            "id":1159,
            "timestamp":1341100800,
            "month":7,
            "day":1,
            "year":2012,
            "week":26,
            "dayid":1,
            "weekday":"Sun",
            "mname":"Jul",
            "formatted":"Jul 1, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2039",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5226",
            "name":"1341478142_Kareena kapoor"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1341091049",
         "date_read":"0",
         "subject":"Events",
         "message":"Good to hear that.",
         "message_formatted":"Good to hear that.",
         "date_sent_formatted":{
            "id":1159,
            "timestamp":1341100800,
            "month":7,
            "day":1,
            "year":2012,
            "week":26,
            "dayid":1,
            "weekday":"Sun",
            "mname":"Jul",
            "formatted":"Jul 1, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2038",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"4982",
            "name":"Hamza Nadeem"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1341053992",
         "date_read":"0",
         "subject":"adfads",
         "message":"agsgsggasgasgasas",
         "message_formatted":"agsgsggasgasgasas",
         "date_sent_formatted":{
            "id":1158,
            "timestamp":1341014400,
            "month":6,
            "day":30,
            "year":2012,
            "week":26,
            "dayid":7,
            "weekday":"Sat",
            "mname":"Jun",
            "formatted":"Jun 30, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2037",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"4949",
            "name":"Eric Owens"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340985832",
         "date_read":"0",
         "subject":"test",
         "message":"testtest",
         "message_formatted":"testtest",
         "date_sent_formatted":{
            "id":1157,
            "timestamp":1340928000,
            "month":6,
            "day":29,
            "year":2012,
            "week":26,
            "dayid":6,
            "weekday":"Fri",
            "mname":"Jun",
            "formatted":"Jun 29, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2036",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5730",
            "name":"Mobile Employee"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2035",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5735",
            "name":"Fsdfsdghh"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2034",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5743",
            "name":"double dots3"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2033",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5742",
            "name":"double dots2"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2032",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5734",
            "name":"Adalph"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2031",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5731",
            "name":"Mobile Scheduler"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2030",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"4949",
            "name":"Eric Owens"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2029",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5628",
            "name":"Test email"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2028",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5627",
            "name":"1341059685_dejan email test"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2027",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5625",
            "name":"Test"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2026",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5623",
            "name":"El Homo"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2025",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5618",
            "name":"Tiengo Mass"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2024",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5608",
            "name":"1344517115_Test22"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      },
      {
         "id":"2023",
         "from":{
            "id":"234",
            "name":"Alan Ford"
         },
         "to":{
            "id":"5606",
            "name":"1341474388_sgdfgdfg"
         },
         "type":"1",
         "replyto":"0",
         "date_sent":"1340878624",
         "date_read":"0",
         "subject":"This is SP",
         "message":"This is SP..Thais is SP",
         "message_formatted":"This is SP..Thais is SP",
         "date_sent_formatted":{
            "id":1156,
            "timestamp":1340841600,
            "month":6,
            "day":28,
            "year":2012,
            "week":26,
            "dayid":5,
            "weekday":"Thu",
            "mname":"Jun",
            "formatted":"Jun 28, 2012"
         },
         "date_read_formatted":[

         ]
      }
   ]
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T17:36:17.263

如果您无论如何都需要遍历它以打印消息，我不明白为什么要从 JSON 中删除任何内容（至少这是您的示例让我想到的）。

因此，我只需将此条件添加到您的 JS 中：

```
$.each(json.data, function(i, data){
    if(data.from.id != 234 && data.from.name != 'Alan Ford'){
        $("#inbox").append(
            '<div class="post">'+
            'To: '+data.to.name+''+
            ''+data.subject+''+
            ''+data.message_formatted+''+
            'added: '+data.date_sent_formatted.formatted+''+
            'Sender: '+data.from.name+''+
            '<hr />'+
            '</div>'
        );
    }
});​ 
```

* * *

[`.text()`](http://api.jquery.com/text/)此外，您可能希望通过自己替换危险字符或使用jQuery中的函数来正确转义正在打印的每个变量。

* * *

最后一条建议：编辑 DOM 需要时间，因此如果您打算处理大量消息，最好只追加一次：

```
var output = '';
$.each(json.data, function(i, data){
    if(data.from.id != 234 && data.from.name != 'Alan Ford'){
        output +=
            '<div class="post">'+
            'To: '+data.to.name+''+
            ''+data.subject+''+
            ''+data.message_formatted+''+
            'added: '+data.date_sent_formatted.formatted+''+
            'Sender: '+data.from.name+''+
            '<hr />'+
            '</div>';
    }
});
$("#inbox").append(output);​ 
```

事情是这样的：http: [//jsfiddle.net/pioul/Hy2nd/](http://jsfiddle.net/pioul/Hy2nd/)

# javascript - 从 javascript 函数的代码块中获取值

> ID：12238073
> 
> 赞同：-2
> 
> 时间：2012-09-02T17:13:17.597
> 
> 标签：javascript, jquery, google-chrome-extension

[我查看了谷歌，发现了一种我在这里](https://stackoverflow.com/questions/1415606/get-the-value-of-onclick-with-jquery)尝试做的方法，但现在我被卡住了。我正在使用 jQuery 来获取 onclick 函数的值，但我需要 Info 函数之外的一些内部代码。

这是我从 $('a.turqheadlabel') 得到的：

```
[<a href=​"#" onclick=​"Info('another-ending')​" class=​"TurqHeadLabel">​ANOTHER ENDING ​&lt;/a>​,
<a href=​"#" onclick=​"Info('good-ending')​" class=​"TurqHeadLabel">​GOOD ENDING ​&lt;/a>​ ] 
```

我使用了 $('a.turqheadlabel').attr('onclick') 我得到了这个：

```
function onclick(event) {
    Info('another-ending')
} 
```

我看的是得到另一个结局和好结局，这样我就可以把它们放在一个我需要调用的数组中。

PS。如果有办法避免使用 eval 是更可取的，因为 chrome 将在明年阻止它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:40:10.237

### 在您控制的网站上

假设您想要访问您传递给`Info`(`'good-ending'`和`'another-ending'`) 的值，那么您最好使用[HTML 数据属性](http://ejohn.org/blog/html-5-data-attributes/)并使用[jQuery 的`data`函数](http://api.jquery.com/data)访问这些值。

如果您将 HTML 重新编写为如下所示：

```
<a href='#' class='TurqHeadLabel' data-info='some-ending'>SOME ENDING</a> 
```

然后您可以`onclick`动态添加您的处理程序，也可以轻松地`info`在其他地方访问您的值。这将`onclick`在 DOM 准备好时附加处理程序：

```
jQuery(function ($) {
    $('a.TurqHeadLabel').click(function () {
        Info($(this).data('info'));
    });
}); 
```

在 JavaScript 的其他地方，您始终可以`data-info`使用以下方式访问该属性：

```
myLink.data('info'); 
```

### 在 Chrome 扩展程序中

`Info`您可以用捕获传递给它的值的东西临时替换该函数：

```
function getInfoParam(func) {
    var originalInfo, result;

    originalInfo = window.Info;
    window.Info = function (arg) {
        result = arg;
    }
    func();
    window.Info = originalInfo;

    return result;
} 
```

或者，您可以使用正则表达式来查找带引号的字符串：

```
function getInfoParam(func) {
    var match;
    match = func.toString().match(/"([^"]*)"/);
    if (match) {
        return match[1];
    }
} 
```

这个实现是有限的：它不适用于包含转义引号的字符串（例如`"foo\"bar"`），或由单引号分隔的字符串（例如`'foobar'`）。

无论您做什么，都容易受到主机网站变化的影响，因此有些脆弱。

# android - 如何在应用程序中添加 sd 卡的文件？

> ID：12238074
> 
> 赞同：0
> 
> 时间：2012-09-02T17:13:24.580
> 
> 标签：android, file, apk, sd-card

我需要在我的应用程序中添加一些文件，并且这些文件必须在应用程序安装后解压到 sd 卡。在安卓上可以吗？我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T17:19:30.953

将文件添加到您的资源/原始目录。当应用程序运行时，您可以检查目标文件是否存在。如果不存在，[请解压并写入 SD 卡](https://stackoverflow.com/a/7215369/974369)：

```
File dest = Environment.getExternalStorageDirectory();
InputStream in = context.getResources().openRawResource(R.raw.file);
// Used the File-constructor
OutputStream out = new FileOutputStream(new File(dest, "file.zip"));

// Transfer bytes from in to out
byte[] buf = new byte[1024];
int len;
try {
    // A little more explicit
    while ( (len = in.read(buf, 0, buf.length)) != -1){
         out.write(buf, 0, len);
    }
} finally {
    // Ensure the Streams are closed:
    in.close();
    out.close();
} 
```

# java - Hector 还是 CQL，我应该使用哪一个

> ID：12238075
> 
> 赞同：3
> 
> 时间：2012-09-02T17:13:36.023
> 
> 标签：java, cassandra, hector, cql

我是卡桑德拉的新手。我必须编写一个使用 cassandra 的应用程序。我想知道哪一个对我更好，这样我将来就不会遇到太多问题。我应该为我的应用程序使用哪个 api。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T22:57:51.803

Sunil，您正在解决一个合理的问题，我认为您在解决问题之前提出这个问题是完全合适的。如果这样说的话，您可能会接触到更广泛接受的受众，“我应该在这两种方法之间寻找哪些优缺点来帮助我在它们之间做出决定？”

Hector 客户端支持与 Cassanda 通信的编程接口，以及解析 CQL 语句的方式，因此您的选择不一定是在 Hector 和 CQL 之间，而更像是编程与 CQL，或两者的组合。即使在 Hector 和 Astyanax 客户之间进行选择，您也可能面临同样的问题。

**选择 CQL 的理由：**

*   CQL 易于存储、检索和比较修订。
*   CQL 易于阅读和审查，尤其是作为 DDL。
*   CQL 易于记录以进行故障排除和审计。
*   具有 RDBMS 历史的开发人员可能会更快地适应 CQL，从而减少培训时间或增加招聘候选人的数量。
*   社区发展趋向于对 CQL 进行类似 JDBC 的处理。

**选择程序化的理由：**

[修正案]

看来我的一些知识已经过时了。根据 jbellis 的评论（我认为*是*Jonathan Ellis），CQL 目前比 thrift 更高效，并且还支持准备好的语句。我对反对基于 CQL 的方法的好论据感到茫然。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-05T12:36:32.593

另一个完全不同的选项是 playOrm，这样您就可以无限制地进行连接。playOrm 允许您执行如下所示的“可扩展 JQL”。您只需要决定如何对数据进行分区。

@NoSqlQuery(name="findJoinOnNullPartition", query="PARTITIONS t(:partId) select t FROM TABLE as t INNER JOIN t.security as s where s.securityType = :type and t.numShares = :shares")

# php - Mysql表中行的超链接

> ID：12238078
> 
> 赞同：1
> 
> 时间：2012-09-02T17:13:40.430
> 
> 标签：php, mysql, hyperlink

问题是我已经制作了保存在数据库中的申请表。我想在其他页面上只显示 php 表中 mysql 表的一些行，其中第一列是到单个应用程序的超链接，因为它在表单中。我的问题是它如何自动为每个表单制作超链接和页面？

这是我现在的代码

```
mysql_connect("host", "user", "password") or die(mysql_error()); 
mysql_select_db("dbname") or die(mysql_error()); 
$data = mysql_query("SELECT * FROM applications ") or die(mysql_error()); 
echo ' <table width="760" border=1>
                    <tr> 
                        <th>Заявление<br>От дата:</th> 
                        <th>От/До</th>
                        <th>Статус</th>
                    </tr>';
    while($info = mysql_fetch_array( $data )) 
        { 
             echo  '
                    <tr>
                        <td><a href="applications.php?id=' . $row['id'] . '">'.$info['today'] .'</a></td>  
                        <td>От '.$info['data1data'] .'.'.$info['data1mesec'] .'.'.$info['data1god'] .' до '.$info['data2data'] .'.'.$info['data2mesec'] .'.'.$info['data2god'] .' </td>
                        <td>';
                            if($info['status'] == 1) {
                                echo '<img src="Images/approved.jpg" />';
                            }
                            else {
                                echo '<img src="Images/declined.jpg" />';
                            }

            echo '          </td>
                    </tr> ';
        } 
echo '</table>'; 
```

我试图得到的结果是一个表格，每个应用程序都有 3 列和行，并且从应用程序的第一列我被重定向到该申请表的单个网页，并且这个链接由类似“应用程序”之类的代码自动生成.php?id=[应用程序 ID]"

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-02T17:18:05.780

我不是很明白，但是：

```
<?php
$query = mysql_query("SELECT * FROM applications");
while($t = mysql_fetch_array($query)){
  echo '<a href="'.$t['hyperlink'].'">'.$t['name'].'</a><br/>';
}
?> 
```

不知道是什么问题。

# php - 将表单字符串发布到 php - 导致 mysql_real_escape_string() 中断

> ID：12238081
> 
> 赞同：0
> 
> 时间：2012-09-02T17:14:37.560
> 
> 标签：php, sql, forms

我有一个带有隐藏字段的表单，看起来像这样：

```
 <form id="myform" method="post" action="/myphp.php">

        <div>
            <label for="name">Name</label>
            <input type="text" id="name" name="name" />
        </div>
        <div>
            <input type="hidden" id="id" name="title" value="Bob's Group (test)" />
        </div>
        <div>     
            <input type="submit" value="Sign up" class="send_button" />
        </div>   

      </form> 
```

隐藏值“title”从 Perch CMS php 内联脚本中获取其值，在本例中为“Bob's Group (test)”。

处理此表单的 php 脚本如下所示：

```
<?php

// Get and check input
$title = check_input($_POST['title']);
echo "title: $title<br>";

$name = check_input($_POST['name']);

$title = mysql_real_escape_string($title);

// Some sql queries that use $title
?> 
```

输出如下所示：

标题：鲍勃的小组（测试）标题：

换句话说， mysql_real_escape_string 导致 title 变成一个空白字符串。

有没有办法处理这个表单值并生成一个安全的 sql 字符串来使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:21:16.760

`mysql_real_escape_string()`是 MySQL 服务器端。它需要一个活动的数据库连接。在检查时检查您是否有一个。

只是一个注释，而不是一个建议：`mysql_escape_string()`是客户端，即即使没有活动的 MySQL 连接也可以在 PHP 中工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T17:21:34.653

您必须与 MySQL 建立活动连接才能使 msyql_real_escape_string() 工作。您很可能从 m_r_e_s() 中返回布尔值 FALSE，因为您尚未连接，并且它正在发出错误。如果你这样做

```
$title = mysql_real_escape_string($title) or die(msyql_error());
                                         ^^^^^^^^^^^^^^^^^^^^^^ 
```

您很可能会收到“未连接”错误消息。

连接是必需的，因此 m_r_e_s 可以正确地转义 - 它基本上会询问服务器它必须转义的元字符是什么，以便它可以正确地完成它的工作。

# php - PHP memcached 客户端 - 它的 CRC32 是否适用于 32 位和 64 位服务器？

> ID：12238087
> 
> 赞同：0
> 
> 时间：2012-09-02T17:15:08.057
> 
> 标签：php, memcached, 32bit-64bit

PHPs crc32 在 32 位和 64 位系统上没有给出相同的值。

PHP 上的 memcache 客户端在其路由算法中使用 crc32。

我的问题是：路由是否跨架构工作，所以如果我从 32 位机器和 64 位机器连接到同一个服务器池，它们将按预期工作并找到彼此的数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:31:23.043

CRC32 是数学定义的并且独立于架构。不过，PHP 在表示方面似乎很棘手，请参阅[手册](http://php.net/manual/en/function.crc32.php)。

# eclipse - Eclipse -> Maven -> 更新项目配置和 Maven 标准目录布局

> ID：12238090
> 
> 赞同：2
> 
> 时间：2012-09-02T17:15:23.007
> 
> 标签：eclipse, maven

我在我的 eclipse maven 项目中使用标准 maven 目录布局： src/main/java src/main/assembly src/main/config src/main/scripts src/main/resources src/test/java src/test/resources

根据：[http ://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)

每当我在 m2e 插件中使用“Maven -> 更新项目配置”时，m2e 都会从源文件夹中删除“程序集”、“配置”和“脚本”目录。如果有人能建议如何配置 m2e 以尊重标准的 Maven 布局，我将不胜感激。我使用 m2e 提供的基本 java 原型来创建项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-07T10:43:41.803

使用[maven-build-helper](http://mojo.codehaus.org/build-helper-maven-plugin/usage.html)插件，您可以将其他源文件夹添加到您的构建中。要让 Eclipse 从插件中提取该信息，您需要 m2e 连接器`buildhelper`和`m2e-apt`. 它们可以在市场上找到。

# c# - SpeechSynthesizer 无法获取所有已安装的声音 2

> ID：12238091
> 
> 赞同：3
> 
> 时间：2012-09-02T17:15:23.740
> 
> 标签：c#, .net, speech-recognition, text-to-speech

我在我的 Windows 7 32 位操作系统中安装了一个新语音，以便能够在我正在开发的一个 .NET 应用程序中使用。

但是当我使用`GetInstalledVoices()`方法查看所有声音的列表时，只有一个（默认“Microsoft Anna”）出现。为什么会发生？

语音出现在控制面板 -> 语音部分。

其他 TTS 应用程序也可以使用此语音。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-04T15:03:22.530

[**我在这里**](https://stackoverflow.com/questions/538329/acapela-voice-not-detected-in-c-sharp)找到了我的问题的答案[](https://stackoverflow.com/questions/538329/acapela-voice-not-detected-in-c-sharp)

 **这是一个错误`System.Speech.Synthesis`，.NET v4.5 解决了这个问题。**

# javascript - 单击时使命名的锚书签始终显示在屏幕顶部

> ID：12238099
> 
> 赞同：5
> 
> 时间：2012-09-02T17:17:35.403
> 
> 标签：javascript, jquery, html, css

我的标记如下：

```
<li><a href="#sheds_housing">Sheds &amp; Housing</a></li>
<div id="sheds_housing">
    <h1>sheds &amp; housing</h1>
    <img src="images/cattle/sheds_housing.png" width="150" height="150" alt="Sheds & Housing"
        title="Sheds & Housing" />
    <p>Text here</p>
</div> 
```

创建指向页面某个部分的链接，以便当用户单击锚点时，它会将他带到该部分。

无论如何我可以确保当用户这样做时，内容始终显示在顶部，而没有任何额外内容可能出现在链接 div 上方文档的正常流程中。

可以单独使用 CSS 完成，还是我必须为此使用 JS/jQuery，如果是，什么代码？

**编辑**

我以前不清楚；看到这个[小提琴](http://jsfiddle.net/dKfVL/)。如果单击前两个链接，您将被带到相应的部分，内容将显示在窗口顶部，但如果您单击最后一个链接，您将被带到相应的部分，但内容不会出现在窗口的顶部和位于相应部分上方的内容都存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-07T14:03:45.123

将 id "last_anchor" 添加到列表中的最后一个链接，这将通过 jquery 实现。如何以及是否决定改变身体的边缘取决于您...

```
$(document).ready(function(){
  $("#last_anchor").click(function(){
    var content_id = $(this).attr("href");
    var win_height = $(window).height();
    var content_height = $(content_id).height();
    var target_margin = win_height - content_height;
    $("body").css("margin-bottom", target_margin)
  });
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T17:27:02.673

> 内容始终显示在顶部，而链接 div 上方的文档正常流程中可能没有任何额外内容。

假设这意味着您要隐藏页面上的所有部分，只显示与单击的链接对应的部分，您要查找的内容称为 Accordian，您可以[在此处](http://sandbox.scriptiny.com/accordion/)找到示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T18:05:31.563

问题是（如果我理解正确的话！）您正在点击页面末尾。如果您扩展最后一个元素的边距或添加一些内容，则标题将显示在顶部（如果剩余的页面足够显示）。

见小提琴：http: [//jsfiddle.net/tHXsS/](http://jsfiddle.net/tHXsS/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-08T21:26:16.607

**解决方案：http:** [//jsfiddle.net/AdKy9/2/](http://jsfiddle.net/AdKy9/2/)

将此添加到您的代码中：

```
<!-- 
  padding div tag goes AFTER #med_vac
  but BEFORE closing tag of #content
-->
<div id="lowerPadding"></div>

<!-- script tag goes in <head> -->

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript">

  $(document).ready(function() {
    $("a").click(function() {
      var targ = $(this).attr('href');
      var elem = $(targ);
      document.location.href= targ;
      assureAtTop(elem);
      document.location.href= targ;
    });
  });

  function assureAtTop(inObj) {
    var y = $(inObj).height();
    var z = $("#lowerPadding").height();
    var w = $(window).height();
    while (y+z < w) {
      $("#lowerPadding").append("<br/>");
      z = $("#lowerPadding").height();
    }
  }

</script> 
```

*   被点击`<a>`元素，进入位置。
*   获取目标位置、填充标签和窗口的高度。
*   将`<br/>`标签添加到填充标签，直到目标位置位于窗口顶部

    **注意：**检查所有`<a>`标签，因为如果窗口具有较大的垂直高度和/或较大的水平宽度，则第二个甚至第三个目标位置可能需要填充。这也可以在没有 jQuery 的情况下实现，但使用 jQuery 更容易并且跨浏览器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-09-10T14:51:30.007

我最初解决您的问题的解决方案类似于上面的@saurabh：

[http://jsfiddle.net/Cgx3h/](http://jsfiddle.net/Cgx3h/)

```
$('.sub_navi a').click(function() {
    var theID = $(this).attr('href');
    $(theID+':last-child').css('min-height', $(window).height());
}) 
```

如果您最终使用 jQuery，您可能会考虑的其他事情是突出重点内容 - 同时使其余内容变暗......

[http://jsfiddle.net/hZGwA/](http://jsfiddle.net/hZGwA/)

```
$('.sub_navi a').click(function() {
    $('#content div').css('opacity',0.5);
    var theID = $(this).attr('href');
    $(theID).css('opacity', 1);
}) 
```

​</p>

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-09-11T15:38:46.603

这是我所做的：

1.  **用户向下滚动页面。**
    没有任何异常发生（您的页面没有变化）。

2.  **用户单击/使用您的锚点。**
    代码在 之后创建了一些空白空间`#content`，因此它可以将所需的部分放在屏幕顶部。

3.  **用户将页面向上滚动到第一个`div`内部`#content`（可以是您喜欢的任何点）或点击后退按钮转到页面顶部。**
    空白区域消失（您的页面恢复正常）。

在这里在线测试：http: [//jsfiddle.net/RASG/z3q3s/](http://jsfiddle.net/RASG/z3q3s/)

或者将此代码保存为 HTML 文件以在您的电脑上进行测试：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
    <script src="http://code.jquery.com/jquery.min.js" type="text/javascript"></script>
    <script>
    $(document).ready(function() {
        function isScrolledIntoView(elem){
            var docViewTop = $(window).scrollTop();
            var docViewBottom = docViewTop + $(window).height();

            var elemTop = $(elem).offset().top;
            var elemBottom = elemTop + $(elem).height();

            return ((elemBottom <= docViewBottom) && (elemTop >= docViewTop));
        }

        var elem_that_hides_dummydiv = $('#content div:first');
        var elem_that_shows_dummydiv = $('#content div:last');
        $(window).scroll(function() {
            if (isScrolledIntoView(elem_that_hides_dummydiv)) { $('#dummydiv').hide() }
        });
        $('#gonnaclickhere').click(function() {
            $('#dummydiv').css({'height':(elem_that_shows_dummydiv.offset().top)+'px'}).show()
        })
    });
    </script>
</head>

<body>

<ul class="sub_navi">
    <li><a href="#sheds_housing">Sheds &amp; Housing</a></li>
    <li><a href="#feed_fodder">Feed &amp; Fodder</a></li>
    <li id="gonnaclickhere"><a href="#med_vac">Medication &amp; Vaccination</a></li>
</ul>

<div id="content">

    <div id="content_pic">
    <img src="images/cattle/cattle_main.jpg" width="400" height="300" alt="Cattle Main" title="Cattle Main" />
    </div>

    <p>Pak United Food Services Ltd., (PUFS) has earned a creditable name and become a major player in the animal husbandry market by building upon Pakistan&apos;s large livestock population. Introducing the concept of corporate cattle farming on scientific lines, the conglomerate uses a livestock development policy consisting of innovative strategies and action plans with the intention of bringing about a radical change in the current livestock production system. The cattle farms are established on rich and fertile acres of land and consist of an impressive and mixed herd of cows/buffalos and sheep/goats.</p>
    <p>A hybrid meat breed is developed by crossing the local indigenous breeds which are predominately draught/milch animals with high meat yielding animals from other parts of the world. A herd management system is incorporated to improve record keeping and obtain information for bench marking decisions. The farms employ a state of the art feedlot design involving the integration of the standard components into a fully functional operating system. This consists of housing, feeding, watering, health-care and cattle effluent &amp; manure management systems, making them well known across the country.</p>

    <div id="sheds_housing">
    <h1>sheds &amp; housing</h1>
    <img src="images/cattle/sheds_housing.png" width="150" height="150" alt="Sheds & Housing" title="Sheds & Housing" />
    <p>The housing for the animals utilizes a proper lay out for the farm buildings while keeping in view the environment, climate and wind direction. Sheds, pens and paddocks are constructed according to different categories and sex groups besides other infrastructure &amp; allied facilities. All buildings are made airy for the protection of the animals from extreme temperatures and strong winds. Adequate supply of water for drinking and cleaning is made necessary with strict maintenance of hygienic conditions. Ample sunlight and natural ventilation is assured to assist in the reduction of moisture and bacteria, offering a healthier, cleaner &amp; drier environment while also reducing the risk of disease and mortality in the livestock.</p>
    </div>

    <div id="feed_fodder">
    <h1>feed &amp; fodder</h1>
    <img src="images/cattle/feed_fodder.png" width="150" height="150" alt="Feed & Fodder" title="Feed & Fodder" />
    <p>The farms are equipped with in-house feed formulation capabilities which produce feed of constant quality and are palatable, nutritious and free from contamination. Feed supplies are made available according to different feed formulae while keeping in view the nutrient value and energy levels. Daily requirements are worked out for each category and class to achieve improved growth &amp; overall health. A restricted feeding regime is employed that is balanced &amp;amp; concentrated, containing minerals &amp; vitamins, leading to an improved feed/gain ratio. Fodder &amp; wheat/rice straws are purchased/contracted from the nearest markets, while treating it with ammonia or urea to improve the quality and gain a marked effect on cattle weight during the fattening period.</p>
    </div>

    <div id="med_vac">
    <div id="med_vac_title">
    <h1>medication &amp; vaccination</h1>
    </div>
    <img src="images/cattle/med_vac.png" width="150" height="150" alt="Medication & Vaccination" title="Medication & Vaccination" />
    <p>Regular vaccination of the whole herd against contagious and infectious diseases are carried out as a prophylactic measure in order to make sure that the animals are free of diseases of digestive, respiratory, urinary, gynecological and obstetrics by a designated veterinarian. A proactive health plan in employed to improve the health, welfare and productivity of the animals. A pre-weaning vaccination program is used with correct, effective and proper vaccines, dewormers, antibiotics and other medications to prime the immune systems of the animals. Furthermore post-weaning vaccination program is used to boost the immune system of the animals and increase the passive protection against common endemic livestock diseases.</p>
    </div>

</div>

<div id='dummydiv' style="bottom: 0; width: 100%;"></div>

</body>

</html> 
```

用 FF13 和 IE9 测试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-09-02T17:26:54.090

您将希望用另一个导航包裹您的导航，`div`以便您可以将 CSS 应用于整个导航。完成后，您可以将标题定位为固定。下一步是通过将页面内容向下移动一些（导航高度）来为页面顶部的常量标题腾出空间为此将所有内容包装在另一个中`div`（不要在此内容 div 中包含导航）并应用一些 CSS -`margin-top: (height of nav);`

```
#topnav
{
    position: fixed;
}

#content
{
    margin-top: (height of nav);
} 
```

编辑：

啊，好吧，我知道你想要什么。`div`要做到这一点，您可以设置's的高度，或者`min-height`在您到达锚点时使用所有的潜水方式，它们将在底部留出空间供浏览器向下滚动到。

所以你必须在你的 CSS 中定义一个新类作为元素或项目，并为每个`div`'s添加一个类

```
CSS 

.elementItem
{
    //use height or min height
}

HTML

<div id="sheds" class="elementId">
    Content
</div> 
```

见 JSFiddle：http: [//jsfiddle.net/dKfVL/](http://jsfiddle.net/dKfVL/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-09-05T10:01:45.057

首先检查我的解决方案：http: [//jsfiddle.net/dKfVL/4/](http://jsfiddle.net/dKfVL/4/)

上述解决方案使用 JavaScript，它**仅**在单击链接时`div`动态添加所需的高度。

 **```
var fixLink = $(".sub_navi li:last a"); // change this to a/c to your requirement

fixLink.click(function(){
    var targetDiv = fixLink.attr("href"); //get the ID of div to be fixed
    $(targetDiv).height($(window).height());
}); 
```

之后这不会删除高度，我看不出您为什么要这样做。但是如果你真的想这样做，你可以监视浏览器的滚动事件，如果滚动大于视口高度，那么你可以将目标 div 的高度设置为`auto`.

* * *

**方案二：**
如果不想使用javascript，可以使用css的`vh`unit，和css中的unit很相似`%`，不同的是它是相对于视口的，目前只支持**chrome**。

**CSS**：

```
#med_vac {
  height: 100vh;
} 
```

jsfiddle： http: [//jsfiddle.net/dKfVL/5/](http://jsfiddle.net/dKfVL/5/)
注意：这不是跨浏览器

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-09-05T13:22:38.423

试试这个小提琴：http: [//jsfiddle.net/dKfVL/9/](http://jsfiddle.net/dKfVL/9/)

我不确定单独使用 css 是否可行（至少不能跨浏览器）。

我使用 jQuery 来确保 #med_vac 元素有足够的高度来确保标题将出现在页面顶部。我已将代码设置为在调整窗口大小时运行，因此它也会响应任何屏幕大小的变化。

希望这可以帮助！

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-09-10T16:12:59.113

一个更好的（不需要填充 div！）

试试[这个 jsfiddle](http://jsfiddle.net/dKfVL/31/)。它对我来说完美无缺。

`Highlights of this fiddle:`

1.  不需要填充 div
2.  仅在单击最后一个链接时更改最后一个包装器 div 的高度

代码如下。

```
$(document).ready(function(){
  //apply height change while clicking on last link only
  $("ul.sub_navi li a:last").click(function(){
    var $targ= $($(this).attr("href"));
    if($targ.height() < $(window).height()){
      $targ.css('min-height', $(window).height())
    }
  });
});​ 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2012-09-11T04:19:57.313

如果您不介意重新组织部分以将点击的目标移到顶部，那么这可以工作[http://jsfiddle.net/robx/dKfVL/34/](http://jsfiddle.net/robx/dKfVL/34/)

我这样做是为了将所选部分放在第一个“牛”的正下方。不知道那是什么，但似乎它应该留在原地。

我在这里看到的唯一可行的选择是：

1.  将它们全部隐藏并仅显示单击的（手风琴或标签样式）。
2.  通过克隆、附加和删除重新组织，以便选定的部分向上移动并向下推其余部分。
3.  在底部放置一些丑陋的大边距，它总是在那里（对我来说不受欢迎）。

希望这有助于为您指明更好的方向。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-09-11T08:18:01.727

这是一个更跨浏览器和无 javascript 的解决方案。

但是，这意味着您可以使用绝对定位，因此对浮点数等不太友好：

```
#med_vac {
    position: absolute;    
    height: 100%;
} 
```

**演示此解决方案的小提琴叉：**

[http://jsfiddle.net/fFL7x/](http://jsfiddle.net/fFL7x/)**

# java - jarsigner 的文件夹权限问题

> ID：12238102
> 
> 赞同：2
> 
> 时间：2012-09-02T17:17:50.573
> 
> 标签：java, jar, jarsigner

这绝对是一个非常初学者的问题，可能不需要对编程做任何事情。几天后，我终于确定了为什么我无法使用 jarsigner 签署 jar 的问题。我不断收到这个错误，上面写着“jarsigner：无法创建 hello.jar.sig”。

基本上，我所做的是将一个 jar 放入 Java jdk 的 bin 文件夹中，然后在文件夹中左键单击以单击“在此处打开命令窗口”。我从 keytool 生成了密钥，还使用了 selfcert。然后，当我为已放入 bin 文件夹中的 jar 执行 jarsigner 时，出现错误。我终于找到了原因。我无法在 bin 文件夹中创建 jar.sig，因为我没有某种权限。问题是，如何将目标设置为某个可修改的文件夹？

我不知道如何设置 java 目录的路径并从桌面或其他地方调用 jarsigner，所以我不得不学习在 java bin 文件夹中编写命令提示符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:20:31.107

1.  将您的 JAR 文件移动到您可以读/写的目录。
2.  运行原始命令： `"C:\Path\To\JDK\bin\jarsigner" [options] jar-file`

默认情况下，输出将被写入您运行命令的目录。

从长远来看，您可以[将 JDK bin 目录添加到您的 Windows 路径](http://docs.oracle.com/javase/7/docs/webnotes/install/windows/jdk-installation-windows.html#path)中。

# javascript - Javascript 原型与通用函数 - 性能/可读性

> ID：12238103
> 
> 赞同：6
> 
> 时间：2012-09-02T17:17:54.203
> 
> 标签：javascript, prototype

所以我写了这些测试来看看使用原型会快多少……

```
function User() {
    return {
        name: "Dave",
        setName: function(n) {
            this.name = n;
        },
        getName: function() {
            return this.name;
        }
    };
}

function UserPrototype() {
    if (!(this instanceof UserPrototype)) return new UserPrototype();
    this.name = "Dave";
}
UserPrototype.prototype.getName = function() {
    return this.name;
};
UserPrototype.prototype.setName = function(n) {
    this.name = n;
};

function setName(obj,name)
{
    obj.name = name;
}
function getName(obj)
{
    return obj.name;
}

//Test 1
var c = 10000000;
var tstart = 0;
var tend = 0;
tstart = new Date().getTime();
for (var j = 0; j < c; j++) {
    var newUser = User();
    newUser.setName("michael");
    newUser.getName();
}
tend = new Date().getTime() - tstart;
console.log("Returning object with methods: " + tend / 1000.0 + " seconds");
//Test 2
tstart = new Date().getTime();
for (var j = 0; j < c; j++) {
    var newUser = new UserPrototype();
    newUser.setName("michael");
    newUser.getName();
}
tend = new Date().getTime() - tstart;
console.log("Using prototypes: " + tend / 1000.0 + " seconds");
//Test 3
tstart = new Date().getTime();
for (var j = 0; j < c; j++) {
    var newUser = {name:"dave"};
    setName(newUser,"michael");
    getName(newUser);
}
tend = new Date().getTime() - tstart;
console.log("Using general functions: " + tend / 1000.0 + " seconds");
​ 
```

我的结果：

```
Returning object with methods: 9.075 seconds
Using prototypes: 0.149 seconds 
Using general functions: 0.099 seconds 
```

我写了前两个测试，当我看到结果时，我想我为什么会看到它们......我在想原因是由于每次都会创建两个新的方法属性实例，所以返回的对象很慢对象被实例化，而原型方法更快，因为它只创建一次函数。一般函数调用和原型之间的性能接近使我认为我的假设是正确的。

所以我的第一个问题是，我对我的假设是否正确？

我的第二个问题是，如何在保持高性能的同时使原型编写更具可读性？有没有办法以看起来像是在“类”中的方式对原型进行编码（如果有意义的话）

*编辑 - 我忘了用 Object.create() 做一个测试，只是做了一个并发布了结果。JSFiddle：（[http://jsfiddle.net/k2xl/SLVLx/](http://jsfiddle.net/k2xl/SLVLx/)）。

我现在得到：

```
Returning object with methods: 0.135 seconds fiddle.jshell.net:63
Using prototypes: 0.003 seconds fiddle.jshell.net:72
Using general functions: 0.002 seconds fiddle.jshell.net:81
Returning object.create version: 0.024 seconds 
```

看起来这可能是解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T18:21:52.660

我同意你的假设。如果代码是这样编写的，这也会结束：

```
function UserObject() {
    this.name = "Dave";

    this.getName = function() {
        return this.name;
    };
    this.setName = function(n) {
        this.name = n;
    };
} 
```

在这种情况下，就像在您的“对象”方法中一样，每次构造对象时都会创建`getName`和方法。`setName``UserObject`

“原型”和“函数”方法之间的代码略有不同。去除`if (!(this instanceof UserPrototype)) return new UserPrototype();`（这是不必要的安全防护）剃须相当多。也可以说，更接近的比较...

```
var newUser = new UserPrototype();
[newUser].name = "Dave"; 
```

... 是 ...

```
var newUser = new Object();
newUser.name = "dave"; 
```

... 因为 ...

```
var newUser = {name:"dave"}; 
```

...在创建`Object`和添加`name`属性时依赖于本机代码。

在这种情况下，结果会翻转，“原型”方法会更快出现。在此处查看 jsFiddle：

*   [http://jsfiddle.net/bcfPp/2/](http://jsfiddle.net/bcfPp/2/)

关于如何使您的原型更具可读性，我无能为力。对我来说，它们是可读的:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-16T16:59:03.220

当您不在构造函数中使用 this 值时，永远不要在构造函数中使用它，而是将其用作原型。例如

UserPrototype.prototype.name = "戴夫";

当你这样做时，原型会在速度上获胜。

# php - 在 PHP 中使用指定扩展名检索目录中文件名的最佳方法

> ID：12238104
> 
> 赞同：-1
> 
> 时间：2012-09-02T17:18:01.227
> 
> 标签：php, arrays, file, list, directory

> **可能重复：**
> [从 php 中某些扩展名过滤的目录中获取文件的最佳方法](https://stackoverflow.com/questions/8541180/best-way-to-get-files-from-a-dir-filtered-by-certain-extension-in-php)

检索具有指定扩展名的文件名的最佳方法是什么？

我想出了这个解决方案，它工作正常，但我想知道是否有更好的方法。

```
print_r(array_filter(scandir(dirname(__FILE__)), create_function('$a', 'return (substr($a, -4) == ".php") ? true : false ;'))); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T17:23:14.823

我会使用[glob](http://php.net/manual/en/function.glob.php)。也许最简单的方法是：

```
$files = glob( dirname(__FILE__) . '/*.php'); 
$files = array_map('basename', $files);
print_r($files); 
```

# android - 原始文件或可绘制文件的路径

> ID：12238109
> 
> 赞同：1
> 
> 时间：2012-09-02T17:18:38.150
> 
> 标签：android, media-player, uri

您好，我在[这里使用媒体播放器的教程](http://www.androidhive.info/2012/03/android-building-audio-player-tutorial/)

我想更改媒体路径位置以指向原始文件夹中的所有文件，这样我就可以将我的歌曲保存在 apk 中。我尝试了几次都没有成功。有人可以帮忙吗。这里的代码我需要调整。

```
package com.androidhive.musicplayer;

import java.io.File;
import java.io.FilenameFilter;
import java.util.ArrayList;
import java.util.HashMap;

// Need to redirect the path below to the raw or drawable folder
public class SongsManager {
    // SDCard Path
    final String MEDIA_PATH = new String("/sdcard/");
    private ArrayList<HashMap<String, String>> songsList = new ArrayList<HashMap<String, String>>();

    // Constructor
    public SongsManager(){

    }

    /**
     * Function to read all mp3 files from sdcard
     * and store the details in ArrayList
     * */
    public ArrayList<HashMap<String, String>> getPlayList(){
        File home = new File(MEDIA_PATH);

        if (home.listFiles(new FileExtensionFilter()).length > 0) {
            for (File file : home.listFiles(new FileExtensionFilter())) {
                HashMap<String, String> song = new HashMap<String, String>();
                song.put("songTitle", file.getName().substring(0, (file.getName().length() - 4)));
                song.put("songPath", file.getPath());

                // Adding each song to SongList
                songsList.add(song);
            }
        }
        // return songs list array
        return songsList;
    }

    /**
     * Class to filter files which are having .mp3 extension
     * */
    class FileExtensionFilter implements FilenameFilter {
        public boolean accept(File dir, String name) {
            return (name.endsWith(".mp3") || name.endsWith(".MP3"));
        }
    }
} 
```

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T17:31:46.963

实际上，Android 的 Raw 文件夹的工作方式与文件系统略有不同。例如，您不应该在 File 范例中使用它。相反，您可以使用 Context 的 Resources 类，例如`openRawResource` [http://developer.android.com/reference/android/content/res/Resources.html#openRawResource(int](http://developer.android.com/reference/android/content/res/Resources.html#openRawResource(int) )

但是，使用此类 API 来存储大文件（如音频）可能会导致性能成本高昂且不可预测。例如，如果文件大小 > 1MB，我无法从 /assets/ 文件夹打开文件。这似乎是平台限制，至少在那个时候是这样。

所以一般来说，如果有必要，我建议从网络下载文件。或者，如果文件的大小非常小 - 将它们从资源预复制到内部/外部存储。

希望对你有帮助，祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T17:49:05.983

AlexN 是对的，1 MB （仍然）是文件大小的限制`assets`，`res`等等。

# javascript - 匹配字符串中的Javascript正则表达式

> ID：12238112
> 
> 赞同：0
> 
> 时间：2012-09-02T17:19:14.097
> 
> 标签：javascript, regex

我有这样的字符串

```
<html>
    [[Wayfinder? &amp;startId=`0` &amp;outerClass=`art-hmenu` ]] &amp;
    &amp; 
</html> 
```

我想改变`&amp;`里面的所有内容`[[`，`]]`并将被替换为`&`

如何用 javascript 做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T17:23:08.913

```
str.replace(/\[\[(.*)?]]/, function(match) {
    return match.replace(/&amp;/g, '&');
}); 
```

这是小提琴：http: [//jsfiddle.net/Jtv5a/](http://jsfiddle.net/Jtv5a/)

# apache-flex - 如何将 Flex Air 应用程序放在单独的桌面窗口上？

> ID：12238113
> 
> 赞同：1
> 
> 时间：2012-09-02T17:19:13.677
> 
> 标签：apache-flex, air

我想要 2 个窗口，一个在主桌面上，另一个在单独的桌面窗口上。我在文档中找不到这个。这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T09:40:30.850

Yep it's possible use the Window class [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/Window.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/core/Window.html)

all Windows are stored in NativeApplication.nativeApplication.openedWindows

so you can do stuff like this

```
for (var i:int =
   NativeApplication.nativeApplication.openedWindows.length - 1; i > 0;
   --i)             { NativeWindow(NativeApplication.nativeApplication.openedWindows[i]).close();
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:34:06.527

您可以创建新的[NativeWindow](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/NativeWindow.html)以在 Adob​​e AIR 桌面应用程序中添加新窗口。作为[WindowedApplication的一部分已经创建了一个 NativeWindow](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/WindowedApplication.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T19:15:52.577

实际上我所追求的是这里描述的 Screens 数组

[http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118676a47e0-8000.html](http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118676a47e0-8000.html)

# jquery - 在滚动时更改 CSS 属性

> ID：12238114
> 
> 赞同：2
> 
> 时间：2012-09-02T17:19:15.383
> 
> 标签：jquery, css, scroll, opacity, transition

我正在设计一个 HTML/CSS 模板。我有一个带有 CSS3 渐变和相对位置的标题。我想 。当访问者开始向下滚动时。标题属性更改为另一个属性。我可以用 jQuery 做到这一点吗？并提前感谢:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T17:21:41.333

[http://api.jquery.com/scroll/](http://api.jquery.com/scroll/)

```
$(your-selector).scroll(function() {

 $(your-object-to-change-css).addClass('new_class');
 $(your-object-to-change-css).removeClass('old_class');

}); 
```

# c# - CSV 文件助手：行为空错误 - 如何在记录类中添加属性 [IgnoreEmptyLines]

> ID：12238123
> 
> 赞同：0
> 
> 时间：2012-09-02T17:20:22.500
> 
> 标签：c#, csv, filehelpers

我在使用 Csv Parser（**文件助手**）时经常出错。它要求设置一些属性以避免为空。但我完全不知道该怎么做。

如何在课堂上设置“IgnoreEmptyLines”？

我的示例 csv 文件是，这是服务器生成的 csv 文件：

```
 Date,Open,High,Low,Close,Volume,AdjClose
    2012-08-31,5298.20,5303.25,5238.90,5258.50,000,5258.50 
```

错误是， **第 2 行是空的。也许您需要在记录类中使用属​​性 [IgnoreEmptyLines]。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T18:29:53.850

如果'Stock'是你的公开课，那么你必须在顶部

```
 [DelimitedRecord(",")]
    [IgnoreEmptyLines()]
    public class Stock
    {
        public string Date;
        public string Open;
        public string High;
        public string Low;
        public string Clos;
        public string Volume;
        public string AdjClose;

    } 
```

# iphone - 挑选 NSMutableAray 的某些部分

> ID：12238125
> 
> 赞同：0
> 
> 时间：2012-09-02T17:20:41.507
> 
> 标签：iphone, ios5, nsstring, split, nsmutablearray

我将如何挑选 NSMutableArray 的某些部分？来自服务器的一个部署阵列是 2012-09-01 09:00:00 America/Los_Angeles 我正试图赶上时间。我在想把它变成一个字符串，然后得到它，然后回到 NSMutablearray 来填充到 tableview 单元格。我还在看文档

我正在考虑的选项：-subarrayWithRange: componentsSeparatedByString:

更新：这是我现在正在做的以获得约会领域

```
NSDictionary *json = [NSJSONSerialization JSONObjectWithData:responseData options:NSJSONReadingMutableContainers error:&error];

    NSDictionary* myslots =[json objectForKey:@"slots"];
    self.timesArray = [[NSMutableArray alloc] init];
    NSLog(@"allslots: %@", myslots);

    for (NSString *slotKey in myslots.allKeys) {
    NSDictionary *slot = [myslots valueForKey:slotKey];

        for (myDays in slot){

        if ([[self.myDays objectForKey:@"isReservable"] isEqualToNumber:[NSNumber numberWithInt:1]])

           [self.timesArray addObject:[self.myDays objectForKey:@"begin"]];

        //NSLog(@"This is the times count: %@", timesArray.count);

    }

    }
     NSLog(@"These are the times avail: %@", self.timesArray); 
     [self.tableView reloadData];
} 
```

我最终想要的只是时间的数组。如果我不清楚，我很抱歉。我在尝试着。请让我知道我可以提供哪些信息来绘制更清晰的画面

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:29:29.053

我会先将其保存为字符串

```
NSString *someString = [myArray objectAtIndex:index]; 
```

然后使用 NSMakeRange 之类的东西来获得那一点

```
[someString substringWithRange:NSMakeRange(11,18)]; 
```

# sqlite - match 子句返回不正确的结果

> ID：12238126
> 
> 赞同：0
> 
> 时间：2012-09-02T17:21:08.523
> 
> 标签：sqlite, full-text-search, fts3

我正在尝试在 sqlite 中使用 FTS3 并执行未返回所需结果的查询。这是查询：

```
select * from table1 where col1 MATCH 'rain'; 
```

此查询返回 col1 也包含我不想要的文本“应变”。我想要这个查询的确切副本：

```
select * from table1 where col1 like '% rain %'; 
```

任何建议/意见/帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:44:12.087

我不确定你为什么会得到这个结果。您应该只获得与您发布的 MATCH 查询匹配的字词的结果。您可以发布您的 FTS3`CREATE TABLE`声明吗？

例如：

```
SQLite version 3.7.11 2012-03-20 11:35:50
Enter ".help" for instructions
Enter SQL statements terminated with a ";"
sqlite> CREATE VIRTUAL TABLE mail USING fts3(subject, body);
sqlite> INSERT INTO mail(docid, subject, body) VALUES(1, 'software feedback', 'found it too slow');
sqlite> INSERT INTO mail(docid, subject, body) VALUES(2, 'software feedback', 'no feedback');
sqlite> INSERT INTO mail(docid, subject, body) VALUES(3, 'slow lunch order',  'was a software problem');
sqlite> select * from mail where body match 'back';
sqlite> select * from mail where body match 'feedback';
software feedback|no feedback 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T09:35:43.497

对于 sqlite 数据库中的 FTS3/FTS4，我得出的结论是，在对任何文本列中的元素进行标记时，简单的（至少）默认标记器会忽略 '(' 和 ')'。也可以检查其他特殊字符，因为我怀疑还会有其他特殊字符。执行匹配查询时，这些值被忽略。这是我的场景的测试用例：

```
create virtual table tab1 using fts3(val text);
insert into tab1 values('this is rain test');
insert into tab1 values('this is strain test');
insert into tab1 values('this is (rain) test with parenthesis');
insert into tab1 values('rain test');
insert into tab1 values('this is rain');
insert into tab1 values('strain test');
insert into tab1 values('this is strain'); 
```

执行以下查询后：

```
select * from tab1 where val MATCH 'rain'; 
```

结果是：

```
this is rain test
this is (rain) test with parenthesis
rain test
this is rain 
```

# c# - 如何接受json字符串作为参数

> ID：12238132
> 
> 赞同：0
> 
> 时间：2012-09-02T17:21:53.173
> 
> 标签：c#, wcf-data-services

我有 wcf 之类的方法

void finalize(string jsonstring);

我使用像 finalize/{json} 这样的请求 url

但是如果尝试用 json 调用它，它会给出错误的请求原因，例如：等等

如何解决这个问题

这是我用于该方法的代码

```
 [WebInvoke(Method = "POST",
ResponseFormat = WebMessageFormat.Json,
RequestFormat = WebMessageFormat.Json,
UriTemplate = "FinalBooking/{BookingJsonString}")]
        public int Finalize(string JsonString)
        {
            int result; // 1 success , 0 faill

            JavaScriptSerializer json_serializer = new JavaScriptSerializer();
            Routess routes =
                   (Routess)json_serializer.DeserializeObject(JsonString);
            using (XEntities context = new XEntities())
            {
                result = context.usp_Final(routes.TypeID, routes.regID, routes.CycleID, routes.DateTime,
                      routes.LocationID, routes.PatID, routes.PO, routes.BTID, routes.DID);

            }

            return result;

        }

    } 
```

数据示例是简单的 JSON 字符串，例如

```
{"DateTime":"03/09/2012 09:00","CycleID":6,"BTID":31,"DiseaseID":814,"LocID":36,"PatID":13,"PO":1,"TypeID":744,"rID":-1} 
```

此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:31:06.197

当您将 JSON 字符串添加到您的 URL 时，您是否对其进行了 URL 编码？如果 URL 是从 C# 创建的，那么您将使用类似[HttpServerUtility.UrlEncode()](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.urlencode)或在 javascript 中的[escape()](http://www.w3schools.com/jsref/jsref_escape.asp)

如果您可以在发送时显示 URL，那将很有帮助。不清楚 URL 是问题还是 WCF 中的问题。

* * *

*编辑：*

查看您发布的代码，我注意到您的 UriTemplate 和您的方法参数名称不匹配：

```
[WebInvoke(Method = "POST",
ResponseFormat = WebMessageFormat.Json,
RequestFormat = WebMessageFormat.Json,
UriTemplate = "FinalBooking/{BookingJsonString}")]
    public int Finalize(string JsonString) 
```

`BookingJsonString`与`JsonString`.

`UriTemplate`有 2 种绑定模式：“按名称绑定”，名称应该匹配，“按位置绑定”，它忽略名称并仅按参数索引。我似乎找不到有关 WCF WebInvoke 使用哪种模式的任何信息，因此您可能想尝试重命名模板或参数以匹配。

# ruby-on-rails - Rake 回滚迁移

> ID：12238138
> 
> 赞同：1
> 
> 时间：2012-09-02T17:22:45.200
> 
> 标签：ruby-on-rails, ruby, postgresql, rake

迁移时，我迁移了名称错误的文件，现在我回滚了这些文件，需要进行另一次迁移，但我不能，出现以下消息：

```
PG::Error: ERROR:  relation "users" already exists
: CREATE TABLE "users" ("id" serial primary key, "name" character varying(255), "email" character varying(255), "created_at" timestamp NOT NULL, "updated_at" timestamp NOT NULL) 
```

我怎样才能回滚整个迁移过程，或者清理我的数据库表？我正在使用 PostgreSQL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T17:26:05.323

```
DROP TABLE users; 
```

或者

```
rake db:rollback STEP=1 
```

# excel - 从 excel 导入到具有更多字段的访问表 (vba)

> ID：12238144
> 
> 赞同：0
> 
> 时间：2012-09-02T17:23:39.193
> 
> 标签：excel, vba, ms-access, import-from-excel

当用户单击按钮（通过使用 VBA）时，我成功地在访问表中导入了 excel 工作表：

```
DoCmd.TransferSpreadsheet [Transfer Type], [Spreadsheet Type], [Table Name], [File Name], [Has Field Names], [Range] 
```

我想知道是否可以在具有更多字段的访问表中导入 excel 数据，以及是否可以在将 excel 数据插入访问表之前对其进行处理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:44:50.043

您可以在查询中引用 Excel 工作表或范围：

```
INSERT INTO Table1 ( ADate ) 
SELECT SomeDate FROM [Excel 8.0;HDR=YES;DATABASE=Z:\Docs\Test.xls].[Sheet1$a1:a4] 
```

# android - 对话框对象的空指针异常

> ID：12238146
> 
> 赞同：0
> 
> 时间：2012-09-02T17:24:15.870
> 
> 标签：android

我从市场上的一个应用程序中收到一个错误消息，发送到对话框中的 TextView。错误是

```
java.lang.NullPointerException
at com.b2creativedesigns.eyetest.ColorBlindTest1$2.onClick(ColorBlindTest1.java:324) 
```

部分代码为：

```
btnNext1.setOnClickListener(new View.OnClickListener() {

@Override
public void onClick(View v) {

GlobalVars.setPoints(points);
dialog = new Dialog(ColorBlindTest1.this);
dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
dialog.setContentView(R.layout.cbtdialog);

TextView dialogtext = (TextView) dialog.findViewById (R.id.tvCBTresult); 
TextView dialogtext2 = (TextView) dialog.findViewById (R.id.tvCBTresult2); 
Button btnQuit = (Button) dialog.findViewById (R.id.btnCTBback);  
Button btnFB = (Button) dialog.findViewById (R.id.btnCBTFB); 
Button btnMarket = (Button) dialog.findViewById (R.id.btnCBTMarket); 
if (points >= 14)
{
   dialogtext.setText("Your result is " + points + "/15!");
   dialogtext.setTextColor(Color.rgb(19, 20, 111));
   dialogtext2.setText("Something"); //error line
}
... 
```

我的问题是

1.  可以在本地声明对象（如果是TextView），而不是全局声明对象（如果是TextView），而不是全局声明`TextView dialogtext2;`，只写在这里`dialogtext2 = (TextView) dialog.findViewById (R.id.tvCBTresult2);` `?`

2.  我有 4 个用于 4 密度的文件夹：layout-ldpi、layout-mdpi、layout-hdpi、layout-xhdpi。layout-xhdpi 文件夹中的 xml 不包含 dialogtext2 TextView。这会导致错误吗？当另一个密度文件夹中的相同 xml 中缺少一个对象时，android 是否不会应用另一个密度文件夹中的 xml？

还有什么可能是错误的根源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:48:43.350

如果你在那里使用 findViewById() 没有问题。但是，似乎 R.id. **tvCBTresult2**不在您使用的布局中（**R.layout.cbtdialog**）

> layout-xhdpi 文件夹中的 xml 不包含 dialogtext2 TextView。这会导致错误吗？

这可能是问题，因为 Android 找不到 dialigtext2（您使用的是带有 xhdpi 屏幕的设备。

> 当另一个密度文件夹中的相同 xml 中缺少一个对象时，android 是否不会应用另一个密度文件夹中的 xml？

实际上，Android 所做的是在找不到文件（不是单个元素）时在另一个文件夹中搜索。

# unit-testing - 如何配置 pom 以运行打包在 jar 中的测试？

> ID：12238149
> 
> 赞同：17
> 
> 时间：2012-09-02T17:24:33.733
> 
> 标签：unit-testing, maven, jar

我有一个 Maven 构建过程，将可执行 jar 及其测试发布到 Nexus。我有另一个需要访问这些 jars（可执行文件 + 测试）并运行测试的 maven 构建过程。

我该怎么做？到目前为止，只有当 jar 被分解为类文件时，我才设法做到这一点。我是 Maven 新手，完全迷失在文档中。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-03T06:20:07.833

Surefire 和 failsafe 目前不支持从 jar 中运行测试。

这主要是无法识别测试的情况。

有两种方法可以让测试运行。

1.  使用列出来自 test-jar 的所有测试的测试套件。因为测试套件将在 src/test/java 中（更准确地说是编译成 target/test-classes）将被拾取并且套件中的所有测试都将由 Surefire/failsafe 运行（假设套件类名称匹配包含规则：以 Test 开头或结尾）

2.  使用 maven 依赖插件的 unpack-dependencies 目标将 test-jar 解压到 target/test-classes 中（这是骇客的尖叫，但效果很好）

第一个选项的主要问题是您不能轻松地从套件中只运行一个测试，并且您需要从 test-jar 中命名每个测试

出于这个原因，我倾向于选择选项 2……还有一个额外的好处是，选项 2 并不意味着编写代码来解决构建工具插件中的限制……你越少将自己锁定在特定的构建工具中，更好的恕我直言

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-01-25T04:02:35.067

这实际上适用于较新的surefire和failsafe插件，请参阅相关问题：

*   [使用 Maven Surefire 运行包含在依赖项 jar 中的 JUnit 测试](https://stackoverflow.com/questions/10496846/run-junit-tests-contained-in-dependency-jar-using-maven-surefire)
*   [从类路径运行 Maven 测试](https://stackoverflow.com/questions/3543473/run-maven-tests-from-classpath)

因此，您不再需要解压 jar，只需提供要扫描的依赖项的组和工件 ID（这适用于“main jar”依赖项以及“test-jar”依赖项）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T06:06:01.640

附加的 test-jar 可以用作其他项目中的常用依赖项，它支持在测试区域中重用代码，但您不能从 jar 中运行测试。如果您真的需要解决方案，您必须至少编写一个套件（等等？）才能从 jar 开始测试。

# ios - ViewController 包含 UIView 这是一个 MKMapView

> ID：12238152
> 
> 赞同：0
> 
> 时间：2012-09-02T17:25:10.670
> 
> 标签：ios, ios5, uiview, uiviewcontroller, mkmapview

我有一个视图控制器，我希望它的一部分成为`UIView`我将自定义`UIView`的我创建的，并在整个应用程序运行期间更改它们。

我有我的视图控制器，并在情节提要中放入了`UIView`. 我创建了一个自定义`UIView`，它具有`MKMapView`：

```
@interface MapUIView : UIView <CLLocationManagerDelegate,MKMapViewDelegate> {
    CLLocationManager *locationManager;
}

@property (weak, nonatomic) IBOutlet MKMapView *mapCtl;
@property (strong, nonatomic) IBOutlet UILabel *address;
@property (nonatomic,strong) CLGeocoder *reverseGeo;

@end 
```

现在我想做的是`UIView`将主视图控制器中的 设置为我的自定义`UIView`，它将显示一个`MKMapView`.

我对此有点陌生，所以如果您发现我的实施有任何问题，请纠正我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:10:01.113

选择视图，然后在右侧的实用程序面板中选择身份检查器。您可以将其更改为`UIView`那里的自定义子类。

请注意，仅`MKMapView`在视图上创建属性实际上并不会创建实例`MKMapView`或将其添加为子视图，因此您需要以编程方式执行此操作或将其添加到情节提要中。

# javascript - 为什么 JavaScript 中包含非语言相关的全局对象？

> ID：12238154
> 
> 赞同：3
> 
> 时间：2012-09-02T17:25:12.230
> 
> 标签：javascript

我正在阅读 Flanagan 的 Definitive JavaScript，他列出了该语言定义的所有 JavaScript 全局对象。

然而，其中 5 个（约 20 个）似乎与语言无关：

```
decodeURI
encodeURI
decodeURIComponent
encodeURIComponent
JSON 
```

当 URI 和 JSON 更像是浏览器服务器时，为什么这些被认为是语言的一部分？

**参考**

[decodeURI 和 decodeURIComponent 的区别](https://stackoverflow.com/questions/747641/what-is-the-difference-between-decodeuricomponent-and-decodeuri)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T18:14:07.927

和方法由 Microsoft 在 IE5.5（随后是 Netscape 6）中引入，后来包含在 ECMA-262 规范的修订版 3/1999 中`encodeXXX`。 `decodeXXX`JSON 是后来引入的，现在所有主要浏览器都支持它，并且包含在 ECMA-262 规范的修订版 5/2011 中。

这些方法不是原始语言的一部分，~~也许~~它们不应该在全局命名空间中。就像`AJAX`，这些方法是由特定供应商引入的，后来被其他供应商采用，没有严格和正式的流程。这只是 JavaScript 美丑的一方面。

# android - 在片段中设置微调器

> ID：12238155
> 
> 赞同：14
> 
> 时间：2012-09-02T17:25:19.327
> 
> 标签：android, android-fragments, spinner

我正在尝试从我的以下片段中的一个字符串数组中设置我的微调器的 `onCreateView`值`public final class Manual extends Fragment`：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

    View v = inflater.inflate(R.layout.manual, container, false);

    String [] values = 
        {"Time at Residence","Under 6 months","6-12 months","1-2 years","2-4 years","4-8 years","8-15 years","Over 15 years",};
    Spinner spinner = (Spinner) v.findViewById(R.id.spinner1);
    ArrayAdapter<String> LTRadapter = new ArrayAdapter<String>(this.getActivity(), android.R.layout.simple_spinner_item, values);
    LTRadapter.setDropDownViewResource(android.R.layout.simple_dropdown_item_1line);
    spinner.setAdapter(LTRadapter);

    return inflater.inflate(R.layout.manual, container, false);

} 
```

我的代码没有错误，但它没有设置微调器。微调器保持空白，没有值。关于为什么我的代码没有设置微调器的任何想法？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-02T19:18:22.913

问题是我正在返回一个新视图，而不是我设置的那个。我不得不这样做`return v;`，而且效果很好。

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

    View v = inflater.inflate(R.layout.manual, container, false);

    String [] values = 
        {"Time at Residence","Under 6 months","6-12 months","1-2 years","2-4 years","4-8 years","8-15 years","Over 15 years",};
    Spinner spinner = (Spinner) v.findViewById(R.id.spinner1);
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this.getActivity(), android.R.layout.simple_spinner_item, values);
    adapter.setDropDownViewResource(android.R.layout.simple_dropdown_item_1line);
    spinner.setAdapter(adapter);

    return v;

} 
```

# bash - Bash 函数参数返回错误“找不到命令”

> ID：12238158
> 
> 赞同：12
> 
> 时间：2012-09-02T17:25:24.450
> 
> 标签：bash, shell, .bash-profile, bash-function

我在 bash 脚本中有这个功能，可以创建一个新的 jekyll 帖子；但它将参数作为未找到的命令返回。这是脚本：

```
 function new_post () {
     if [ -z "$1" ]
     then
         read -p "Post Title:"  TITLE
     else
         TITLE= "$1"
     fi
     FILE=$( echo $TITLE | tr A-Z a-z | tr ' ' _ )
     echo -e '---\nlayout: post\ntitle: '$TITLE'\npublished: false\n---\n' > $(date '+%Y-%m-%d-')"$FILE"'.md'
 } 
```

但是每当我尝试运行它时，它都会返回：

```
$>new_post "Hello World"
-bash: Hello World: command not found 
```

它似乎试图将参数作为命令运行。

我什至试过这个并得到相同的结果

```
$>TITLE= "Hello World" && echo -e ---layout: post\ntitle: "$TITLE"\n--- 
-bash: Hello World: command not found 
```

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-02T17:28:30.057

可能是`TITLE= "$1"`导致错误的空间。尝试`TITLE="$1"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-29T09:49:05.790

就我而言：

```
echo "Deploy of `$1` to `$2` project? (Y/N)" 
```

这个问题也存在。当我删除 [``] 时，它就消失了。不确定您是否粘贴了完整的脚本，但请注意 args 的双引号。

类似的答案[https://askubuntu.com/questions/180320/bash-script-program-with-parameters-as-a-single-variable-command-not-found](https://askubuntu.com/questions/180320/bash-script-program-with-parameters-as-a-single-variable-command-not-found)

# java - Android Java R.layout.balloon_overlay 无法解析或不是字段-android 错误

> ID：12238160
> 
> 赞同：0
> 
> 时间：2012-09-02T17:25:55.310
> 
> 标签：java, android, google-maps

我在一个 android 项目的 res/layout 文件夹中有一个 balloon_overlay.xml 文件。我收到资源文件无法解析或不是字段的错误。我确实在我使用资源文件的活动文件中正确引用了 android.R，但我似乎无法找出问题所在或如何解决它。任何帮助将不胜感激。谢谢

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/balloon_main_layout"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:background="@drawable/balloon_overlay_bg_selector"
    android:minWidth="200dip"
    android:orientation="horizontal"
    android:paddingBottom="25dip"
    android:paddingLeft="10dip"
    android:paddingRight="0dip"
    android:paddingTop="0dip" >

    <LinearLayout
        android:id="@id/balloon_inner_layout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="6dip"
        android:layout_weight="1" >

        <LinearLayout
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:gravity="center_vertical"
            android:minHeight="40dip"
            android:orientation="vertical" >

            <TextView
                android:id="@+id/balloon_item_title"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="balloon_item_title"
                android:textColor="@android:color/primary_text_light"
                android:textSize="16dip" />

            <TextView
                android:id="@+id/balloon_item_snippet"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="balloon_item_snippet"
                android:textColor="@android:color/secondary_text_light"
                android:textSize="12dip" />
        </LinearLayout>

        <ImageView
            android:id="@+id/balloon_disclosure"
            android:layout_width="wrap_content"
            android:layout_height="fill_parent"
            android:layout_gravity="center_vertical"
            android:paddingTop="3dip"
            android:src="@drawable/balloon_disclosure"
            android:visibility="gone" />
    </LinearLayout>

    <ImageView
        android:id="@id/balloon_close"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:paddingBottom="10dip"
        android:paddingLeft="10dip"
        android:paddingRight="5dip"
        android:paddingTop="5dip"

        android:src="@drawable/balloon_overlay_close" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:45:32.010

不要使用`android.R`您自己的`R`类（它会在文件夹中自动生成`gen`并包含您的资源的常量。在 Eclipse 中，按*Strg+Shift+O*应该可以正确组织您的导入。

# javascript - Expressjs - 将表单数组/括号字段解析为真实数组

> ID：12238162
> 
> 赞同：2
> 
> 时间：2012-09-02T17:26:09.833
> 
> 标签：javascript, node.js, express

我想找到一些现有的中间件或一些方便的代码来将带有方括号的表单字段（即'contact[21][name]'）转换为 ExpressJS 3 的真实数组。

类似于以下内容：

```
for(key in req.body){
    if(key.isArrayField()) {
       //add new array field to req.body and delete old string version from req.body
... 
```

我想解析无限深度的括号。我还在学习 JS/Node，所以会喜欢一些方向。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-14T08:46:27.900

您能否澄清一下您要通过此实现的目标？

根据您首先从 Web 表单获取输入的方式，您可以使用内置于 node.js 中的JSON.parse()（[此处的文档）轻松地将 JSON 语法解析为真实对象（包括数组）](https://developer.mozilla.org/en-US/docs/Using_native_JSON)

使用该方法，您可以拥有无​​限级别的嵌套值（散列/对象和数组），但您需要一些客户端脚本首先将值放在那里（例如[jQuery ）。](http://jquery.com)

如果你给出一个更完整的例子，包括提交表单的上下文，我可能会给出更好的方向......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-12-19T14:25:01.223

根据我的经验，你可以简单地做这样的事情......

**玉**

```
input(type="text" name="foo[]" value="foo1")
input(type="text" name="foo[]" value="foo2") 
```

**JS**

```
app.post('/test', function(req,res){
    console.log(req.body)// { foo: [ 'foo1', 'foo2' ] }
    console.log(req.body.foo)//["foo1","foo2"]
    console.log(req.body.foo[0])//foo1
    console.log(req.body.foo[1])//foo2
}); 
```

我不知道这是否有意义，但这就是你对待他们的方式……至少在 express 3.0+ 上

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-16T12:42:00.193

我已经通过使用[https://github.com/marioizquierdo/jquery.serializeJSON](https://github.com/marioizquierdo/jquery.serializeJSON)解决了​​这个问题 - 问题是/是如果我只是提交一个 POST 表单来表达它不会将括号作为数组处理，所以他们有手动正则表达式。通过使用插件将表单解析为 JSON，我可以通过 ajax 提交它。

# java - 如何以编程方式将 Android TextView 对齐到另一个 TextView 的右侧

> ID：12238164
> 
> 赞同：2
> 
> 时间：2012-09-02T17:26:12.703
> 
> 标签：java, android, android-layout, textview

在下面的代码中，我创建了两个文本视图并以编程方式将它们添加到相对布局中。我想将它们并排对齐。

代码运行良好，但没有将新的放在`TextView`前一个的右侧，`TextView`而是将新`TextView`的放在边距（0,0,0,0），即屏幕的右上角：

```
 super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    relativeLayout= (RelativeLayout) findViewById(R.id.relative_Layout);

    textView[0] = new TextView(this);//creates first textview
    textView[0].setId(0);
    textView[0].setText("1");
    textView[0].setBackgroundResource(R.drawable.shape);//parses an image from shape.xml

    relativeLayoutParams.addRule(RelativeLayout.CENTER_IN_PARENT);
    textView[0].setLayoutParams(relativeLayoutParams);

    relativeLayout.addView(textView[0]);//creates another textview

    textView[1] = new TextView(this);

    textView[1].setBackgroundResource(R.drawable.shape);

    RelativeLayout.LayoutParams relativeLayoutParams=
            new RelativeLayout.LayoutParams((RelativeLayout.LayoutParams.WRAP_CONTENT),(RelativeLayout.LayoutParams.WRAP_CONTENT));//create params for new textview

    relativeLayoutParams.addRule(RelativeLayout.RIGHT_OF, textView[0].getId());//to align the textview side by side
    textView[1].setText("2");

    relativeLayout.addView(textView[1], relativeLayoutParams); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T18:11:12.870

尝试以下操作：

1.  将textView[0]的id设置为1而不是0（id需要为正整数）
2.  在 textView[1] 的 relativeLayoutParams 中添加 RelativeLayout.ALIGN_TOP 的规则

以下对我有用：

```
RelativeLayout relativeLayout = (RelativeLayout) findViewById(R.id.test);
RelativeLayout.LayoutParams relativeLayoutParams;       
TextView[] textView = new TextView[2];

// 1st TextView
textView[0] = new TextView(this);

relativeLayoutParams = new RelativeLayout.LayoutParams(
        RelativeLayout.LayoutParams.WRAP_CONTENT,
        RelativeLayout.LayoutParams.WRAP_CONTENT);

textView[0].setId(1); // changed id from 0 to 1
textView[0].setText("1");   

relativeLayoutParams.addRule(RelativeLayout.CENTER_IN_PARENT);

relativeLayout.addView(textView[0], relativeLayoutParams);

// 2nd TextView
textView[1] = new TextView(this);

relativeLayoutParams = new RelativeLayout.LayoutParams(
        RelativeLayout.LayoutParams.WRAP_CONTENT,
        RelativeLayout.LayoutParams.WRAP_CONTENT);      

textView[1].setText("2");

relativeLayoutParams.addRule(RelativeLayout.RIGHT_OF,
        textView[0].getId());
relativeLayoutParams.addRule(RelativeLayout.ALIGN_TOP,
        textView[0].getId()); // added top alignment rule

relativeLayout.addView(textView[1], relativeLayoutParams); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T17:41:38.560

只是一个猜测：您可以尝试使用与 0 不同的 id 吗？

# php - JSON 不能正确显示字母

> ID：12238166
> 
> 赞同：0
> 
> 时间：2012-09-02T17:26:33.297
> 
> 标签：php, json

我的网页女巫包含来自数据库的数据的 JSON 代码，代码是由 PHP 脚本生成的，但是 JSON 代替显示那些字母“čšćđž”显示类似于“\u0161”、“\u0111”等的东西，但我不知道找出错误的地方，表、数据库、文档、标题的编码是 UTF-8

这是页面[http://dmb.site50.net/application.php?app_access_key=c4ca4238a0b923820dcc509a6f75849b的链接](http://dmb.site50.net/application.php?app_access_key=c4ca4238a0b923820dcc509a6f75849b)

这是PHP脚本的来源

```
$APP_URL_ACCESS = $_GET['app_access_key'];

$sql_app = mysql_query("SELECT * FROM app_sys WHERE APP_OW_C='$APP_URL_ACCESS'") or die(mysql_error());

if(mysql_num_rows($sql_app)==1){

    while($row = mysql_fetch_array($sql_app)){
    $APP_UA_ID          = $row['APP_UA_ID'];
    $APP_NM             = $row['APP_NM'];
    $APP_H_DMN          = $row['APP_H_DMN'];
    $APP_H              = $row['APP_H'];
    $APP_H_DB_UNM       = $row['APP_H_DB_UNM'];
    $APP_DB_NM          = $row['APP_DB_NM'];
    $APP_H_DB_PSW       = $row['APP_H_DB_PSW'];
    $APP_H_DB_SRV       = $row['APP_H_DB_SRV'];
    $APP_ACTIVE         = $row['APP_ACTIVE'];
    $APP_OW_C           = $row['APP_OW_C'];

}
$ROW_APP[] = array(
                    'APP_UA_ID' => $APP_UA_ID,
                    'APP_PERMISSION' => $APP_ACTIVE,
                    'APP_KEY' => $APP_OW_C);
$APP_ARRAY[] = $ROW_APP;

($APP_ACTIVE == '1')? $sql_connect_app = mysql_connect($APP_H_DB_SRV, $APP_H_DB_UNM, $APP_H_DB_PSW) && mysql_select_db($APP_DB_NM): $_MSG = "Application Is Not Active"; 

$sql_news = mysql_query("SELECT * FROM news  ORDER BY id DESC LIMIT 10") or die(mysql_error());
while($row = mysql_fetch_array($sql_news, MYSQL_ASSOC)){
        //$display_json['data'] = array(
            //'id' => $row['id'],
//          'title' => $row['title'],
    //      'story' => $row['story'],
    //      'img' => $row['img'],
        //  'author' => $row['author'],
            //'datetime' => $row['datetime'],
            //'shorten_story' => substr($row['story'], 0, 150) . '...'); */
            $ROW_APP_DATA[] = $row; 
    //

}

$sql_news = mysql_query("SELECT * FROM actual  ORDER BY id DESC LIMIT 10") or die(mysql_error());
while($row = mysql_fetch_array($sql_news, MYSQL_ASSOC)){
        /*$display_json['data'] = array(
            'id' => $row['id'],
            'title' => $row['title'],
            'story' => $row['story'],
            'img' => $row['img'],
            'author' => $row['author'],
            'datetime' => $row['datetime'],
            'shorten_story' => substr($row['story'], 0, 150) . '...'); */
            $ROW_APP_THIRDPART[] = $row;    
    //

}

$JSON_ARRAY_APP['application'] = $ROW_APP;
$JSON_ARRAY_DATA_1['news'] = $ROW_APP_DATA;
$JSON_ARRAY_DATA_2['actual'] = $ROW_APP_THIRDPART;
$JSON_ARRAY_DATA['data'] = array_merge($JSON_ARRAY_DATA_1, $JSON_ARRAY_DATA_2);
$JSON_OUTPUT = array_merge($JSON_ARRAY_APP, $JSON_ARRAY_DATA);
echo json_encode($JSON_OUTPUT);

}else{
exit(); 
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T17:28:31.003

这很正常。JSON 的规范使用`\uxxxx`扩展 unicode 字符的序列。请参阅[http://json.org](http://json.org)并搜索“unicode”。

JSON 字符串通常不适合人类消费，因此字符在其中的编码方式并不重要。如果您的消费者正确支持 unicode，那么当您将 json 字符串解码回本机数据结构时，您将恢复原来的重音字符。

# ruby-on-rails - 如何使用 :remote => true 使用 jQuery 将数据发送到控制器

> ID：12238176
> 
> 赞同：0
> 
> 时间：2012-09-02T17:27:43.897
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我想使用 :remote => true(Unobtrusive JavaScript) 将数据发送到 Rails3 中的控制器，但没有 link_to 或 form_tag。我想用 jQuery 响应向控制器发送数据（一些参数）。我怎么能这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:00:17.680

您可以使用 jQuery 发送带有 ajax 请求的数据，如下所示。

1.  根据类绑定事件和
2.  从jquery函数提交ajax请求

代码：

```
$(document).on('click',".ajaxRequestEvent",function(){
$.ajax({
type: 'POST'
url: url,
data: {'key1':'value1', 'key2':'value2'},
success: success,
dataType: dataType
});
}); 
```

其中，“ajaxRequestEvent”是元素的类，单击时需要发送您的请求。如上所述，您可以使用 jquery ajax 函数的 'data' 属性发送数据

# jquery - Adobe Edge 设置变换旋转属性

> ID：12238178
> 
> 赞同：0
> 
> 时间：2012-09-02T17:28:06.463
> 
> 标签：jquery, rotation, transform, adobe-edge

我正在尝试编写 Adob​​e Edge 中元素的旋转属性的脚本，但无法计算出语法。

我正在尝试这个：

```
var element = sym.$("Rectangle");
element.css("transform", "rotate(25deg)"); 
```

但它根本不会改变旋转。对其他 CSS 属性使用完全相同的方法，例如：

```
var element = sym.$("Rectangle");
element.css("left", 150+myVar); 
```

有人知道我如何在这里访问 transform:rotate 属性吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-28T00:07:48.397

这是我用来处理各种浏览器的。任何时候在不同属性的分配方式存在差异时都需要这样做。您将通过这个示例在下面看到我的意思。我把它放在“点击”事件中，以便在点击时摆动名片。

如果转换在一个浏览器中有效，但在另一个浏览器中无效，您可以在 w3schools.com 上查找该属性，它会告诉您是否存在浏览器差异。

```
// Get us a random rotate transform value between -5 and 5
var rotate_val = Math.floor((Math.random()*10)+1) - 5;

// Get instance of this element
var card_element = sym.$("wr_business_card");

// Set a random rotation for the business card when clicked
card_element.css("transform", "rotate(" + rotate_val + "deg)");
card_element.css("-ms-transform", "rotate(" + rotate_val + "deg)");     /* IE 9 */
card_element.css("-webkit-transform", "rotate(" + rotate_val + "deg)"); /* Safari and Chrome */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:50:09.223

您正在测试哪个浏览器？显然，transform 属性没有官方支持。所以你必须根据你的浏览器使用这个的修改版本。

[http://www.w3schools.com/cssref/css3_pr_transform.asp](http://www.w3schools.com/cssref/css3_pr_transform.asp)

# c# - 无法加载文件或程序集“System.Net.Http”或其依赖项之一

> ID：12238179
> 
> 赞同：7
> 
> 时间：2012-09-02T17:28:10.753
> 
> 标签：c#, .net, azure

也许相关信息：我有一个使用 .net 4.5 构建的 Web 应用程序。我想部署到 Azure 的网站，但它只支持 .net 4.0，所以我将项目降级为 .net 4.0。在本地运行时它仍然有效。

当我发布到 Azure 时，我收到此错误：

> 无法加载文件或程序集“System.Net.Http”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（来自 HRESULT 的异常：0x80131040）

我已经尝试使用 nuget 删除 Web API 并阅读它，正如关于 SO 的另一个问题所建议的那样，但我仍然遇到同样的问题。
我试过关闭/打开VS，并清理/构建。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-05T05:54:30.053

我解决了一个类似的问题（System.Web.Http 和 System.Net.Http.Formatting）错误，方法是删除对问题参考的引用（指向我的 .Net 安装文件夹）并将其替换为我的包文件夹中的参考文件由 Microsoft.AspNet.WebApi NuGet 包安装。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-28T19:01:22.327

我有同样的问题。但是，仅更新程序集版本、复制本地和特定版本设置并不能解决我的问题。在我的应用程序配置中，我将 Web 和工作角色部署到云服务。创建服务后，在配置选项卡上，我将操作系统设置为 Windows Server 2012 R2 以获得对 .Net Framework 4.5.1 的支持。但是错误仍然发生。

经过进一步研究，我发现我的云服务的 *.cscfg 文件使用模糊的 osFamily 设置“3”覆盖了门户设置。当我开始我的项目时，它在 MVC3 上，还没有 WebAPI 和框架 4.5.1。osFamily 3 是当时最新的。

在我最新的部署中，我已将我的站点升级到 4.5.1 框架和 MVC5。我验证它在我的开发机器上本地工作。但部署后它没有工作，错误引用 System.Net.Http.Formatting 版本 4.0.0.0 未找到。我后来看到了显示源错误的部署日志

“上载包所需的名为 NetFx451 的功能在为部署选择的操作系统 * 中不可用。”

这是一篇博客文章，它引导我找到将 osFamily 设置更改为 4 的解决方案。然后我的网站在全新部署后工作。

[http://tech.trailmax.info/2014/02/azure-deployment-the-feature-named-netfx451-that-is-required-by-the-uploaded-package-is-not-available-in-the-为部署而选择的操作系统/](http://tech.trailmax.info/2014/02/azure-deployment-the-feature-named-netfx451-that-is-required-by-the-uploaded-package-is-not-available-in-the-os-chosen-for-the-deployment/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-03T07:15:21.090

System.NET.HTTP.dll 仅依赖于 System.dll、System.Core.dll 和 mscorlib.dll。

确保您的部署包中有此 DLL (System.NET.HTTP.dll)（您可以进行 RDP 连接并检查部署文件夹）。使用“复制到本地”属性的引用，或**将此 dll 包含在您的项目中的根级别并在属性中设置类型“内容”**。

如我所见，.NET 2.0 也支持 System.Net.Http.dll - 这可能会导致问题。所以除了上面尝试**设置参考属性“特定版本”= true**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-05T06:04:35.173

Azure 现在在配置选项卡上支持 .Net 4.5，您可以选择 .Net 框架版本 V3.5 或 V4.5 我有几个 MVC Web 应用程序，其中包含大量支持的 DLL，所有这些都在 V4.5 中编译。Azure 不支持的是 V 4.5.1（来自 VS 2013 RC 版本）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-15T10:44:05.817

我在一个 asp.net 应用程序中遇到了同样的问题，其中一些 Web 作业部署到了同一个 Azure 应用服务。通过从所有项目中引用相同的 System.Net.Http（nuget 包）来解决它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-06T14:05:52.247

如果您所做的所有选项都不起作用，请尝试重新启动（以“管理员”身份关闭/打开）您的 Visual Studio，然后清理/重建。这解决了我的问题。

虽然这仅适用于我的本地机器，但尚未尝试使用其他环境，如 azure 或任何服务器。

**我对缺少System.Net.Http**问题有同样的经历。

# r - 在 R 中使用 for 循环收敛

> ID：12238183
> 
> 赞同：0
> 
> 时间：2012-09-02T17:28:35.307
> 
> 标签：r

我有以下代码：

```
for(n in 1:1000){
    ..............
} 
```

这将运行`............`1000 次。我没有输入完整的代码，因为它非常长并且与答案无关

我的问题是有什么方法可以让代码运行，直到它达到指定的收敛值到小数点后四位。有一些初始值被输入到这个方程中，这会产生新的值，并且这个过程会不断地迭代，直到达到收敛（如上所述）。

**编辑**

我的代码末尾有一组 4 个值，带有不同的标签（A、B、C、D）。在我的代码中，当每个函数计算不同的值并相互提供时，有两个单独的函数。因此，当我说收敛时，我的意思是当函数 1 告诉函数 2 特定值并计算 A、B、C 和 D 的新值并且循环继续并且下一次这些值与函数 2 计算的值相同时

我在这里问的关键问题是代码应该采用什么格式（下面建议重复是可取的）以及如何正确编码收敛标准，因为连续迭代的分配符号将是相同的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T17:33:34.147

如果您只是在寻找一种退出`for`循环的方法，您可以使用`break`.

```
for (n in 1:1000)
    {
    ...
    if (condition)
       break;
    } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-02T18:09:20.783

只是根据我的评论做出回答，我认为这通常`repeat`是最好的。它不需要您在开始时评估条件，并且在有限次数的迭代后不会停止（当然，除非这是您想要的）：

```
repeat
{
 # Do stuff
 if (condition) break
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-02T17:34:12.487

如果您不知道需要多少次迭代，您总是可以只使用一个 while 循环。一般形式可能如下所示：

```
while(insert_convergence_check_here){
     insert_your_code_here
} 
```

编辑：作为对 nico 评论的回应，我应该补充一点，您也可以按照这种模式基本上创建一个 do/while 循环，以防您需要循环至少运行一次才能检查收敛标准。

```
continue_indicator <- TRUE
while(continue_indicator){
    insert_your_code_here
    continue_indicator <- convergence_check_here
} 
```

# javascript - 如何使这个示例函数适应 Backbone？

> ID：12238187
> 
> 赞同：1
> 
> 时间：2012-09-02T17:29:01.923
> 
> 标签：javascript, backbone.js, onclick, coffeescript

我想将此代码重写为 Backbone.js，我该怎么做？

应用程序/资产/javascripts/views/plots/plots_index.js.coffee

```
class App.Views.PlotsIndex extends Backbone.View
  template: JST['plots/index']

  events:
    'submit #new_plot': 'createPlot'

  initialize: ->
    @collection.on('reset', @render, this)
    @collection.on('add', @appendPlot, this)

  render: =>
    $(@el).html(@template())
    @collection.each(@appendPlot)
    this

  appendPlot: (plot) =>
    view = new App.Views.Plot(model: plot)
    @$('#all_plots').append(view.render().el)

  createPlot: (event) ->
    event.preventDefault()
    attributes = name: $('#new_plot_name').val()
    @collection.create attributes,
      wait: true
      success: ->  $('#new_plot')[0].reset()
      error: @handleError 
```

app/assets/templates/plots/index.jst.eco

```
<textarea class="input" id="new_plot_name" name="name" rows="5"  onClick="if(this.value == 'Type something') { this.value = ''; }">Type something</textarea> 
<input class="generate_button col2" name="commit" type="submit" value="Submit" /> 
```

我想将 onClick 中的函数放入视图代码中，但不太清楚。我尝试过这样的事情，但没有运气：

```
 events:
        'click #new_plot_name' : 'clear'

    clear: =>
    if @$('#new_plot_name').value == 'Type something'
        @$('#new_plot_name').value = '' 
```

这样做的方法是什么，所以我可以做类似的事情：

```
 <textarea class="input" id="new_plot_name" name="name" rows="5"  onClick="<%= @clear(this) %>">Type something</textarea> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:09:59.103

我很确定问题出在你的`clear`方法上。

```
clear: =>
  if @$('#new_plot_name').value == 'Type something'
    @$('#new_plot_name').value = '' 
```

当你说`x = @$('#new_plot_name')`，你得到一个 jQuery 对象`x`。jQuery 对象通常没有`value`DOM 对象那样的属性；如果您想使用包装在 jQuery 对象中的表单元素的值，您需要使用以下[`val`](http://api.jquery.com/val/)方法：

```
clear: =>
  if @$('#new_plot_name').val() == 'Type something'
    @$('#new_plot_name').val('') 
```

`onClick`然后从模板中删除属性：

```
<textarea class="input" id="new_plot_name" name="name" rows="5">Type something</textarea> 
```

CoffeeScript ( `@clear(this)`) 在那里不起作用，在那种情况下`@`也不`this`是你想要的，而且`clear`无论如何也不接受对象参数。此外，这是 Backbone，所以事件应该通过视图的`events`.

演示：http: [//jsfiddle.net/ambiguous/gfK4L/](http://jsfiddle.net/ambiguous/gfK4L/)

* * *

也就是说，人们确实`Tab`习惯于在表单内移动，因此您可能希望使用焦点事件（而不是单击）来删除占位符并使用模糊事件将其放回原处。

您还应该[`placeholder`](http://www.w3.org/TR/html-markup/textarea.html#textarea.attrs.placeholder)为这类事情使用属性；如果您需要支持非 HTML5 浏览器，那么有很多 shims 和插件会比您的`clear`方法更好。占位符行为很难正确处理，例如，您可能会提交很多表单，`name`因为`'Type something'`您没有检查它们是否确实在您的提交处理程序中输入了某些内容。

此外，不需要`$(@el)`.Backbone 已经提供了一个 jQuery 包装`@el`在[`@$el`](http://backbonejs.org/#View-%24el). 在你的`initialize`：

```
initialize: ->
  @collection.on('reset', @render, this)
  @collection.on('add', @appendPlot, this) 
```

您不需要提供 context 参数给`on`since`render`并且`appendPlot`已经是绑定的方法，应该这样做：

```
initialize: ->
  @collection.on('reset', @render)
  @collection.on('add', @appendPlot) 
```

# iphone - 目标 c - 向地址簿中的联系人之一发送短信/电子邮件

> ID：12238191
> 
> 赞同：2
> 
> 时间：2012-09-02T17:29:29.380
> 
> 标签：iphone, ios, object, abpeoplepickerview

我`ABPeoplePickerNavigationController`用来显示地址簿用户，然后我返回“是” `shouldContinueAfterSelectingPerson`以查看用户的电话和电子邮件。
但是当我点击电话或电子邮件时，什么也没有发生……我希望它发送短信或电子邮件。
这是我需要自己实现的吗？

我也返回 YES `shouldContinueAfterSelectingPerson`，它不应该做的工作吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T17:38:51.023

很抱歉，你有很多工作要做。首先，一旦用户选择了联系人，那么您需要自己提取电话或电子邮件。如果有多个电话号码或电子邮件地址，您可能应该提示用户使用哪一个 - 通过使用 UIActionSheet 或表格。使用电话号码，您可以创建电话 URL 并将其发送到共享应用程序，这会导致拨打电话（这里有很多关于如何执行此操作的示例）。

使用电子邮件地址，您需要使用 MFMailComposeViewController 创建一封电子邮件，然后通过委托为用户添加一个已知地址。还有一个姊妹类，MFMessageComposeViewController，用于发送 SMS 消息。

我为我的公司做了同样的事情，我花了大约 3 天的时间来编码和测试整个事情（所有 3 个选项）。

编辑：一个人可以有多个电话号码和电子邮件地址。您在这里有两个选择：

*   使用您已经在使用的委托方法，返回 NO，但保存用户点击的“属性”和“标识符”。这将是一个电话号码、电子邮件地址等（它也可能是一个地址，因此您需要更深入地探索。您可以在此处或其他地方找到如何使用这两个值获取确切属性的示例。

*   您可以使用“peoplePickerNavigationController:shouldContinueAfterSelectingPerson:”不向用户显示人员的属性，而只是表明这是他们有兴趣联系的人。通过该人的记录，您可以了解他们有多少个电子邮件地址，如果只有一个，那么您的工作就完成了。如果不是，你必须让那个人告诉你是哪一个。[这就是我的做法]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:15:09.100

我同意大卫 H 在他的回答中所说的，你有很多工作要做。为了帮助你一点，[这](https://stackoverflow.com/questions/8898996/how-to-have-a-precomposed-sms-message-for-the-user-in-ios-sdk/8899207#8899207)将向你解释如何发送短信。

这里还有一个小代码片段，可以让您了解如何从通讯簿记录中获取电话号码：

```
ABAddressBookRef addressBook = ABAddressBookCreate();
ABRecordRef record = ABPersonCreate();
ABMutableMultiValueRef multi;
record = ABAddressBookGetPersonWithRecordID(addressBook, contactID);
multi = ABRecordCopyValue(record, kABPersonPhoneProperty);
int multiCount = ABMultiValueGetCount(multi);
for(CFIndex i=0; i<multiCount; i++)
{
    [tempArrayPhones addObject:[NSString stringWithFormat:@"%@", (NSString *)ABMultiValueCopyValueAtIndex(multi, i)]];
} 
```

同样，这不是一个完整的代码，它只是给你一个想法的片段。

# iphone - 将 iOS 应用程序从通配符更新为显式应用程序 ID 时出现问题？

> ID：12238196
> 
> 赞同：1
> 
> 时间：2012-09-02T17:29:48.253
> 
> 标签：iphone, ios

我们现在在商店中有一个带有通配符应用 ID 的应用。

现在等待批准的更新是使用显式应用 ID 创建的，以启用推送通知。

我们在更新的临时测试期间注意到以下问题：如果我们从 iPhone 中删除应用商店版本，然后安装临时更新，一切都很好。但是，如果我们让应用商店版本在后台运行，并在其上安装临时更新，则更新的版本会安装但无法启动。我们怀疑这与 ID 更改有关。

如果这个问题是特定于临时安装的，那么我们不必担心，但我们担心现有用户在从应用商店进行真正升级时会遇到这个问题。

从通配符 ID 应用程序升级到显式 ID 版本后，有人遇到过安装问题吗？

# javascript - 温斯顿记录器名称

> ID：12238199
> 
> 赞同：7
> 
> 时间：2012-09-02T17:29:56.043
> 
> 标签：javascript, node.js, winston

Flatiron 的日志库 Winston 非常有用，但我不知道如何为记录器分配名称。我期待与其他日志库类似的输出，例如：

```
 [<date>] [<log level>] <logger name> - <the message> 
```

是否可以以这种方式配置 Winston？

谢谢你。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2016-09-06T12:36:07.663

创建日志传输时，您可以提供一个`label`参数，该参数将添加到日志级别和日志消息之间的日志输出中。例如：

```
var logger = new (winston.Logger)({
    transports: [
        new (winston.transports.Console)({
            colorize: true,
            prettyPrint: true,
            timestamp: true,
            label: 'CustomLabel'
        })
    ]
}); 
```

这将导致以下输出：

```
2016-09-06T12:16:17.335Z - info: [CustomLabel] hello 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-29T16:47:59.657

[您可以命名记录器](https://github.com/flatiron/winston#working-with-multiple-loggers-in-winston)；但是，似乎没有办法将记录器名称添加到输出中。

但如果它可用，我也会使用它。有一个[开放的拉取请求](https://github.com/flatiron/winston/pull/186)可以通过在输出字符串中添加一个“名称”来实现这一点，因此希望能够通过。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-24T12:47:00.740

[https://github.com/mcclelanmj/SimplyLog](https://github.com/mcclellanmj/SimplyLog)的前提是能够轻松地使用自定义输出编写您自己的附加程序，并且以命名记录器为中心。

# opencv - Viola Jones 人脸检测 - 对象/人脸大小的变化

> ID：12238201
> 
> 赞同：6
> 
> 时间：2012-09-02T17:30:57.523
> 
> 标签：opencv, image-processing, computer-vision, face-detection, viola-jones

我正在尝试理解 Viola Jones 的方法，而且我基本上已经掌握了。

它使用简单的类似 Haar 的特征被提升为强分类器并组织成层/级联以实现更好的性能（不打扰明显的“非对象”区域）。

我想我了解积分图像，并且了解特征的计算值是如何计算的。

我唯一想不通的是算法如何处理面部大小的变化。

据我所知，他们使用在图像上滑动的 24x24 子窗口，其中算法通过分类器并试图找出上面是否有人脸/物体。

我的问题是——如果一张脸是 10x10 大小，而另一张脸是 100x100 怎么办？那会发生什么？

而且我很想知道前两个特征是什么（在级联的第一层），它们看起来如何（记住这两个特征，根据 Viola&Jones 的说法，几乎不会错过一张脸，并且会消除60% 的错误) ? 如何？？

而且，如何构建这些特征来处理图像中不同人脸尺寸的这些统计数据？

我是否遗漏了什么，或者我认为这一切都错了？

如果我不够清楚，我会尝试更好地解释我的困惑。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T19:02:21.663

## 训练

Viola-Jones 分类器在 24*24 图像上进行训练。每个人脸图像都包含一个类似比例的人脸。这会生成一组特征检测器，这些特征检测器由两个、三个或四个针对特定尺寸的面部优化的矩形组成。

## 脸型

通过在不同尺度上重复分类来检测不同的人脸尺寸。原始[论文](http://research.microsoft.com/~viola/Pubs/Detect/violaJones_CVPR2001.pdf)指出，通过将不同的比例相隔 1.25 倍，可以获得良好的结果。

请注意，积分图像意味着很容易通过简单地缩放矩形角的坐标来计算任何比例的矩形特征。

## 最好的功能

原始论文包含在典型级联中选择的前两个特征的图片（参见第 4 页）。

第一个特征检测在脸颊较亮的较宽矩形上方的眼睛较宽的深色矩形。

```
----------
----------
++++++++++
++++++++++ 
```

第二个特征检测鼻梁的明亮薄矩形，位于包含眼睛的两侧较暗的矩形之间。

```
---+++---
---+++---
---+++--- 
```

# c - 使用另一个过程而不是直接使用 main()

> ID：12238206
> 
> 赞同：0
> 
> 时间：2012-09-02T17:31:29.870
> 
> 标签：c, gcc, arm

在 nxp CMSIS 示例中，我们没有在主过程的主体中编写代码，而是像这样调用另一个过程：

```
int c_entry(void)
{
       //code Entry
    while(1);
    return 1;
}

int main (void)
{
    return c_entry();
} 
```

我想我们只是失去了记忆，我想知道这种编码的优势是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T12:09:45.717

> 我想我们只是失去了一段记忆

没有你想象的那么多。编译器可以优化对跳转的尾调用——因此不会有额外的堆栈使用——或者它甚至可以自动内联 c_entry 函数。至少 GCC 能够在更高的优化级别上做到这一点。

# xcode - XCode / AppleScriptObjC 新手

> ID：12238208
> 
> 赞同：3
> 
> 时间：2012-09-02T17:31:37.277
> 
> 标签：xcode, applescript, applescript-objc

我是 Xcode 4.4 和 AppleScriptObjC 世界的新手。我正在尝试扩展和试验 Sanderson 和 Rosenthal 的“Learn AppleScript”一书中关于 AppleScriptObjC 的教程，但我遇到了问题。编码：

```
property parent : class "NSObject"
property textField : missing value

on buttonClick_(sender)
    set theText to textField's stringValue()
    set dialogText to text returned of (display dialog "Here is the text your entered: " & return & theText default answer "")
    textfield's setStringValue_(dialogText)
end buttonClick 
```

运行完美，我得到了预期的对话框，一切正常。但是，如果我尝试弄乱它并添加这两行（当然是在适当的地方）：

```
property anotherTextField : missing value
...
set theText to textField's stringValue() & otherTextField's stringValue() 
```

该程序仍在运行 - 但是！- 如果我转到 MainMenu.xib 并按住 ctrl-单击 AppDelegate 以获取 outlets inspector ... anotherTextField 没有 Outlet，即使应该有。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T20:46:44.403

我也是 AppleScript 的新手，我遇到的一个常见问题是我首先在 applicationWillFinishLaunching 部分中声明了属性。检查那个。如果它仍然不起作用（您确实提到您在适当的位置添加了代码），那么尝试将第二个文本字段的属性声明放在​​“属性父级”部分之前。我想可能会起作用……</p>

尝试发布您的 AppDelegate.applescript 的完整代码

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-18T01:56:36.437

1.  确保您添加的属性不在操作中

例如。这不起作用：

```
 on buttonClick_(sender)
        property anotherTextField : missing value
        ....
    end buttonClick 
```

例如。这应该有效：

```
 property anotherTextField : missing value
    on buttonClick_(sender)
        ....
    end buttonClick 
```

2.  PS。您制作了变量“anotherTextField”，但在您使用“otherTextField”的操作中

    ```
    property ---> anotherTextField <--- : missing value
    ...
    set theText to textField's stringValue() & ---> otherTextField <---'s stringValue() 
    ```

3.  如果这些都没有帮助，如果您发布完整的代码，我可能会更好地理解它，那么我可能会为您提供更多帮助：D

# php - 创建 zip 存档并将其流式传输到 ftp 服务器

> ID：12238211
> 
> 赞同：4
> 
> 时间：2012-09-02T17:32:00.473
> 
> 标签：php, ftp, stream, zip, ziparchive

我正在尝试从本地文件创建一个 zip 文件并将其直接流式传输到 ftp（无需先将 zip 写入磁盘）。我对压缩本身没有任何问题，但似乎 ZipArchive 类无法识别 ftp 流包装器。

以下代码是我能想到的最简单的东西，可以说明问题

```
<?php

$zip = new ZipArchive();
var_dump($zip->open('ftp://[username]:[password]@[hostname.net]/public_html/test.zip', ZipArchive::OVERWRITE));

$zip->addFile(realpath('/input.txt'), 'input.txt');

var_dump($zip->close()); 
```

`$zip->open`调用在返回`true`时`$zip->close`返回`false`。我找不到一种方法来获取错误消息或比仅`there is an error`. 问题是我做错了什么，或者我不能用 ZipArchive 类做这些事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-03T21:20:25.220

我已经在我的 Ubuntu 系统上测试了你的代码，我可以确认它不起作用。
通过使用“strace”实用程序，我看到 PHP 正在处理“$filename”参数，就好像它是本地文件名一样，如下所示：

```
lstat64("/var/www/test/ftp://myuser:mypass@127.0.0.1/tmp/test.zip", 0xbfcbb008) = -1 ENOENT (No such file or directory)
lstat64("/var/www/test/ftp://myuser:mypass@127.0.0.1/tmp", 0xbfcbaeb8) = -1 ENOENT (No such file or directory)
lstat64("/var/www/test/ftp://myuser:mypass@127.0.0.1", 0xbfcbad68) = -1 ENOENT (No such file or directory)
lstat64("/var/www/test/ftp:", 0xbfcbac28) = -1 ENOENT (No such file or directory) 
```

“/var/www/test”前缀是我的 PHP 测试脚本的路径。
因此，实际上 ZipArchive::open() 方法似乎无法处理 URL 文件名。
查看 PHP 源代码，我发现 ZipArchive::open() 方法调用了“ [zip_open](http://php.net/manual/en/function.zip-open.php) ”函数。
“ [fopen](http://www.php.net/manual/en/function.fopen.php) ”函数的 PHP 手册页指出：

> 如果文件名的格式为“scheme://...”，则假定它是一个 URL，PHP 将搜索该方案的协议处理程序（也称为包装器）。如果没有注册该协议的包装器，PHP 将发出通知以帮助您跟踪脚本中的潜在问题，然后继续执行，就好像 filename 指定了一个常规文件一样。

[这篇文章](http://docs.php.net/manual/en/function.stream-wrapper-register.php#85763)，在 PHP 手册页中找到“ [stream_wrapper_register](http://docs.php.net/manual/en/function.stream-wrapper-register.php) ”函数，声明 zip_open() 忽略自定义流包装器，但上面的测试表明它也忽略了标准流包装器。[ZipArchive::open() 手册页](http://www.php.net/manual/en/ziparchive.open.php)和 zip_open 手册页都没有明确表示“$filename”参数可以是 URL
，这也是事实。

# javascript - JavaScript：在“foreach”循环中模拟“break”

> ID：12238217
> 
> 赞同：0
> 
> 时间：2012-09-02T17:32:37.520
> 
> 标签：javascript, foreach, iteration, break

当您迭代用户/引擎定义的函数时，实现 for 循环的“中断”功能模拟的最佳方法是什么？

```
foreach([0,1,2,3,4],function(n){
    console.log(n);
    if (n==2)
        break;}); 
```

我曾想过以一种在函数返回“false”时会中断的方式实现 foreach - 但我想听听关于通常如何完成的想法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T17:35:04.933

`return`ing`false`是最常见的方法。这就是 jQuery 的迭代器函数的[`.each()`](http://api.jquery.com/jQuery.each/)作用：

> **我们可以通过使回调函数返回false**来在特定迭代中打破 $.each() 循环。返回非 false 与 for 循环中的 continue 语句相同；它将立即跳到下一次迭代。

及其*非常*简化的实现：

```
each: function( object, callback ) {
  var i = 0, length = object.length,
  for ( var value = object[0]; 
        i < length && callback.call( value, i, value ) !== false; // break if false is returned by the callback 
        value = object[++i] ) {}
  return object;
} 
```

# javascript - 如何使用 yyyymmdd 格式将 n 天添加到日期但不包括星期日？

> ID：12238220
> 
> 赞同：0
> 
> 时间：2012-09-02T17:32:49.983
> 
> 标签：javascript, jquery, jquery-ui

我想要一个从给定日期以'yyyymmdd'格式的'n'天之后的日期（输出也是相同的格式）。添加n天应该不包括星期日。可以在javascript中做到这一点吗？

这是我将 n 天添加到日期的代码

```
 function mydate(dateStr,offset) 
    {
       var ymd = dateStr.match(/^(\d{4})(\d{2})(\d{2})$/);
       if (ymd) 
       {
         var date = new Date(ymd[1], ymd[2] - 1, ymd[3]);
         date.setDate(date.getDate() + offset);
         return $.datepicker.formatDate('yymmdd', date);
       } 
       else 
       {  // parse error
         return null;
       }
    } 
```

例如，

```
 mydate('19890831',10) 
```

将返回

```
 19890910 
```

但实际上我需要的是“19891012”，因为当我们将 10 天添加到“19890831”时，有 2 个星期日

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T17:50:17.330

简单的解决方案；您可以循环浏览这些日子并跳过星期天：

```
while (offset > 0) {      
  date.setDate(date.getDate() + 1);
  if (date.getDay() != 0) offset--;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T17:39:50.453

您可以在此处参考答案以计算出两个日期之间有多少个星期日，一旦您有了，您可以简单地将该数字添加到您原来的天数差异中。

[java - 如何确定Java脚本中两个日期之间的星期六和星期日的数量](https://stackoverflow.com/questions/6210906/how-to-determine-number-saturdays-and-sundays-comes-between-two-dates-in-java-sc)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:16:10.310

```
function pad(n){
    if(n < 10){
        return "0" + n;
    }
    return n;
}

function addDays(dt, n){
    var matches = dt.match(/^(\d{4})(\d{2})(\d{2})$/);
    var year = matches[1];
    var month = matches[2];
    var day = matches[3];

    var dt = new Date(year, month - 1, day);
    var weekDay = dt.getDay();

    if((weekDay + n) > 6){
        n = n + 1;
    }

    if(weekDay === 0){
        n = n + 1;
    }

    var oneDayInMillis = 1 * 24 * 60 * 60 * 1000;
    var newDt = new Date(dt.getTime() + (oneDayInMillis * n));

    return "" + newDt.getFullYear() + pad(newDt.getMonth() + 1) + pad(newDt.getDate());
} 
```

# iphone - 检查 NSString 是否为整数

> ID：12238221
> 
> 赞同：2
> 
> 时间：2012-09-02T17:32:52.700
> 
> 标签：iphone, ios, sdk

> **可能重复：**
> [NSString 是整数？](https://stackoverflow.com/questions/565696/nsstring-is-integer)

我正在寻找一个字符串是否只有数字。基本上：

```
if (string is integer):
   #do whatever
else:
   #error 
```

我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T20:02:17.557

我用过`[NSCharacterSet decimalDigitCharacterSet]`。绝对运作良好。

```
NSCharacterSet* notDigits = [[NSCharacterSet decimalDigitCharacterSet] invertedSet];

if ([newString rangeOfCharacterFromSet:notDigits].location == NSNotFound)
{
// newString consists only of the digits 0 through 9
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:02:20.973

```
-(BOOL)isANumber:(NSString *)string{
    NSPredicate *numberPredicate = [NSPredicate predicateWithFormat:@"SELF MATCHES '^[0-9]+$'"];
    return [numberPredicate evaluateWithObject:string];
} 
```

# google-bigquery - 对从另一个查询的结果创建的表运行查询时出现奇怪的结果

> ID：12238224
> 
> 赞同：2
> 
> 时间：2012-09-02T17:33:50.380
> 
> 标签：google-bigquery

从昨天 1-09-2012 开始，我无法对从另一个查询的结果创建的表运行任何查询。

示例查询：

```
SELECT region FROM [project.table] LIMIT 1000 
```

结果：

```
Query Failed
Error: Field 'region' is incompatible with the table schema.
49077933619 
```

在过去的几周里，这些查询每天都成功通过。有没有其他人遇到过类似的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T02:46:14.823

我们在星期五添加了一些额外的模式检查。我无法重现该问题，但我会查看您的示例（我能够在日志中找到您失败的工作）。与此同时，我正在关闭额外的模式检查。请再试一次，如果问题仍然存在，请告诉我们。

# cryptoapi - 访问 PKCS12 存储的证书

> ID：12238225
> 
> 赞同：1
> 
> 时间：2012-09-02T17:34:06.167
> 
> 标签：cryptoapi, pkcs#12, mscapi

我正在探索必须提取存储的证书以与 OpenSSL（C++ 应用程序）一起使用的情况。它被导入到本地计算机\个人存储中，并且包含受密码保护的私钥。

我可以通过 MS CryptoAPI 获得什么？

我想要的是要么检索原始证书，要么以受密码保护或不受保护的形式检索其私钥。是否可以？或者 CryptoAPI 不是为了提供证书副本而我将使用它的功能而不是使用 OpenSSL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T10:02:38.927

**我想要的是要么检索原始证书，要么以受密码保护或不受保护的形式检索其私钥。是否可以？**

是的，您可以使用 cryptoAPI 从证书存储中导出您的 PFX [`PFXExportCertStore`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa387311%28v=vs.85%29.aspx)

# c++ - 如何将目录路径转换为唯一的数字标识符 (Linux/C++)？

> ID：12238228
> 
> 赞同：4
> 
> 时间：2012-09-02T17:34:16.443
> 
> 标签：c++, linux, hash, uniqueidentifier

我正在研究获取目录（文件夹）并派生某种形式的唯一数字标识符的方法。我研究了“字符串到哈希”方法，但是，[鸽子洞原理](http://www.codinghorror.com/blog/2007/12/hashtables-pigeonholes-and-birthdays.html)意味着永远无法为每个字符串导出一个真正唯一的数字。

字符串到唯一哈希是不好的。

我最近一直在研究实现目标的其他方法，因此有以下问题要问：

**目录时间戳 - 它们有多“独特”？**[此处](http://www.linuxquestions.org/questions/programming-9/how-to-get-directory-time-stamp-in-c-719347/) 描述的“stat”报告的时间戳的分辨率是多少（第二篇文章）？如果分辨率足够小，是否可以在 Linux 系统上让多个文件夹共享完全相同的时间戳？

如果有人想分享其他方法/技术，我很乐意倾听:)

**编辑 1**澄清我的用例以回应迄今为止发布的答案：我在 Android 平台上工作，所以文件系统没有链接到任何其他（当然除了可移动媒体，如 Micro SD 卡）。

我将每个路径插入数据库，但在查询表时尝试避免字符串比较。使用地图/哈希图在这里不是一个选项。是的，路径本身是唯一的，但理想情况下，我需要一个可用于查询表的数字标识符，而不是路径本身。每个路径的标识符也必须是唯一的。我已经尝试过 std::collat​​e 但发现哈希中有很多碰撞（20, 000 条路径的数据集会产生大约 100 次碰撞）。更令人惊讶的是，每次运行我的应用程序时，哈希值似乎都大不相同。我想知道它是否以某种方式播种？

非常感谢，P

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T17:42:29.150

在任何基于 UNIX 的系统上，您都可以使用 inode 编号作为该文件系统中的唯一标识符。将其与设备编号结合将使其在机器内具有唯一性。如果您希望它是全球唯一的，您可以输入系统的主 MAC 地址。

但是，请记住：

1.  如果目录被移动或重命名，inode 号将“跟随”目录。如果目录被删除和替换，它将改变。

2.  跨系统的 inode 数量将不稳定，超过一两个真正特殊的目录。（例如，`/`通常是 inode 2。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T17:50:20.277

+1 黄昏，好一个！

另一种方法是将目录的路径简单地视为一个数字（“BigInt”）。

以这个目录为例：`/opt/www/log`
它有 12 个字符长。
12 * 8bits = 96bits
因此，您有一个**96 位长的数字**，您可以用 hex/base64/anything 表示（以防您需要将其作为 HTML 链接传递）。

不过，我个人会选择黄昏的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:31:50.373

我认为这在很大程度上取决于您为什么想要一个唯一的数字标识符的目的。时间戳可以改变，inode 可以改变，disknumbers 可以改变，MAC 地址可以改变。（不过，+1 为黄昏）

在某些情况下，您可以简单地创建一个表，其中添加的每个路径都会获得一个新的唯一编号，就像数据库中的数字键列一样。

尽管散列**可能**会发生冲突，但在每个实际环境中这绝对不可能（如果您不使用最糟糕的算法......）由于实现中的缺陷，您更有可能遇到错误，例如您对待“/ tmp" 与 "/tmp/" 不同，因为在对路径进行散列处理之前不会对其进行规范化。或者，您**想**区分物理文件夹，但忘记检查同一个文件夹的硬链接和符号链接，因此您会获得同一个目录的多个哈希/ID。

同样，根据您的用例，冲突不一定是致命的：如果您发现新路径导致与现有路径相同的哈希（不会发生！）您仍然可以对这种情况做出反应。(*)

只是为了帮助您的想象力：如果您使用 64 位散列，您可以用空文件夹填充 150 000 000 个 1TB 硬盘驱动器（上面什么都没有，只有简短的文件夹名称......），然后肯定会发生冲突。如果您认为这太冒险（眨眼，眨眼），请使用 128 位散列，这使其可能性降低 18 446 744 073 710 000 倍。

哈希旨在使冲突不太可能发生，如果没有人**愿意**尝试产生冲突，即使是好的旧 MD5 也会很好地完成它的工作。

**(*) 编辑：** 您的鸽巢文章已经指出：碰撞只是意味着查找不再是 O(1)，而是稍微慢一些。因为它很少发生，你可以很容易地忍受它。如果您使用 std::map（无哈希）或 std::hashmap，则不必担心冲突。看看[STL中map和hashmap有什么区别](https://stackoverflow.com/questions/5139859/what-the-difference-between-map-and-hashmap-in-stl)

# php - mootools 表单 json 发布请求

> ID：12238229
> 
> 赞同：0
> 
> 时间：2012-09-02T17:34:51.503
> 
> 标签：php, javascript, html, mootools

我想`request.JSON` 在动态表格上。

是否可以通过表单 ID 发布完整的表单？

```
<table>
<form id="form">
        <tr>
          <td>username</td>
          <td><input type="text" id="username"></td>
        </tr>
        <tr>
          <td>password</td>
          <td><input type="password" id="password"/></td>
        </tr>
        <tr>
          <td></td>
          <td><input type="submit" id="go" value="go"/></td>
        </tr>
</table> 
```

在脚本方面：

```
$('go').addEvent('click',function( event )
{
  event.stop();
   var myForm = document.id('form');

  var request= new Request.JSON (
  {
    url: 'check_login.php',
    method: 'post',
    data:
    {
     form: myForm
    },
    onSuccess: function( response ) 
    {
      if ( response.status )
      {
        document.location = "home.php"   
      }
      else
      {
        $('response').addClass('error');
        $('response').set('html', response.message);
      }
    },

});
     request.send(); 
```

在 php 脚本中，我想通过 $_POST 变量进行检查。但我找不到这样的方法。实际上我什么都没有。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:48:49.433

当然，看看这个链接，它显示了如何做到这一点：

[http://demos111.mootools.net/Ajax.Form](http://demos111.mootools.net/Ajax.Form)

它基本上通过您的 ID 选择表单，添加一个侦听器来提交事件，当它出现时，它会以您正在寻找的方式发送所有表单:-)

# android - 活动破坏时如何删除所有片段

> ID：12238234
> 
> 赞同：6
> 
> 时间：2012-09-02T17:35:54.503
> 
> 标签：android, android-fragments

您知道如何清除活动、布局和后台堆栈中的所有片段吗？

我知道我们可以使用以下方法清除 backstack：

```
FragmentManager.popBackStack(null, FragmentManager.POP_BACK_STACK_INCLUSIVE); 
```

但是在我动态添加到布局中的布局中呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T17:52:04.257

> 活动破坏时如何删除所有片段

当持有它们的活动被销毁时，所有片段都会自动销毁。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T17:53:03.600

你不需要打扰。一旦活动被破坏，所有片段也将被破坏

# java - App Engine 服务的适当范围

> ID：12238237
> 
> 赞同：1
> 
> 时间：2012-09-02T17:36:27.240
> 
> 标签：java, google-app-engine, design-patterns, scope

**创建 servlet 时 App Engine 服务**的正确范围是什么：静态、实例或本地？****每个的含义是**什么？似乎您应该希望在尽可能广泛的范围内使用它们，以避免重新创建（或重新检索）它们的开销，但我想知道这是否会导致数据的不当重用，尤其是如果`<threadsafe>true</threadsafe>`.**

 *** * *

下面提供了每个范围的示例。 [`MemcacheService`](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/memcache/MemcacheService)将在下面的示例中使用，但我的问题适用于任何和所有服务（尽管我不确定答案是否取决于所使用的服务）。我通常使用[`MemcacheService`](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/memcache/MemcacheService), [`DatastoreService`](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/datastore/DatastoreService), [`PersistenceManager`](http://db.apache.org/jdo/api20/apidocs/javax/jdo/PersistenceManager.html),[`ChannelService`](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/channel/ChannelService)和[`UserService`](https://developers.google.com/appengine/docs/java/javadoc/com/google/appengine/api/users/UserService)。

**静态范围：**

```
public class MyServlet extends HttpServlet {
    private static MemcacheService memcacheService = MemcacheServiceFactory.getMemcacheService();

    @Override
    public void doGet(HttpServletRequest req, HttpServletResponse resp) {
        memcacheService.get("x");
    }
} 
```

**实例成员：**

```
public class MyServlet extends HttpServlet {
    private MemcacheService memcacheService = MemcacheServiceFactory.getMemcacheService();

    @Override
    public void doGet(HttpServletRequest req, HttpServletResponse resp) {
        memcacheService.get("x");
    }
} 
```

**本地范围：**

```
public class MyServlet extends HttpServlet {
    @Override
    public void doGet(HttpServletRequest req, HttpServletResponse resp) {
        MemcacheService memcacheService = MemcacheServiceFactory.getMemcacheService();
        memcacheService.get("x");
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T18:23:04.503

GAE 是一个分布式系统，它的所有服务都运行在不同的服务器上。因此，当您调用服务时，它会在内部序列化请求（使用协议缓冲区的 afaik）将其发送到运行服务的服务器，检索结果并反序列化它。

所以所有的`*Service`类基本上都是围绕序列化/反序列化代码的非常薄的包装器。例如，参见[MemcacheService 的来源](http://code.google.com/p/googleappengine/source/browse/trunk/java/src/main/com/google/appengine/api/memcache/AsyncMemcacheServiceImpl.java)。

关于范围：不需要对`*Service`类进行优化，因为它们是非常薄的包装器，与整个服务往返相比，创建它们所花费的时间可以忽略不计。**

# dom - 获取dojo中相同功能的按钮点击ID？

> ID：12238240
> 
> 赞同：1
> 
> 时间：2012-09-02T17:36:46.323
> 
> 标签：dom, button, dojo, onclick

我不知道这是否是一个简单的问题，但我找不到解决方案。我想在 dojo 中创建 10 个按钮，如下面的按钮。

```
 <div style="right: 1px">
                <button data-dojo-type="dijit.form.Button" id="SaveChangesDataGrid1" onclick="SaveChanges()">
                    Save</button>
            </div> 
```

但是每个按钮都有不同的ID但onClick的功能相同。所以我想要的是当单击按钮时，单击按钮的 id 将在函数中知道。

我正在使用 dojo 1.8 有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:32:35.773

更改或`onclick="SaveChanges()"`摆脱`onclick="SaveChanges(event)"`它并使用`data-dojo-props`：

```
<button
    data-dojo-type="dijit.form.Button"
    data-dojo-props="onClick:SaveChanges"
    id="SaveChangesDataGrid2"
>
    SaveChangesDataGrid2
</button> 
```

`SaveChanges()`以这种方式开始获得`id`：

```
require([
    "dijit/registry",        
    "dijit/form/Button",

], function(
    registry
) {

    window.SaveChanges = function(event) {
        var button =  registry.getEnclosingWidget(event.target);
        console.log("onclick id:", button.id);
    }  
}); 
```

在 jsFiddle 上查看它的实际效果：http: [//jsfiddle.net/phusick/WfdKF/](http://jsfiddle.net/phusick/WfdKF/)

# arrays - 在数组中查找局部最小值

> ID：12238241
> 
> 赞同：32
> 
> 时间：2012-09-02T17:37:06.297
> 
> 标签：arrays, algorithm, binary-search

给定一个整数数组，找到局部最小值。如果 A[i-1] > A[i] 且 A[i] < A[i+1] 其中 i = 1...n-2，则元素 A[i] 被定义为局部最小值。在边界元素的情况下，数字必须小于其相邻数字。

我知道如果只有一个局部最小值，那么我们可以通过修改后的二进制搜索来解决。但如果已知数组中存在多个局部最小值，能否及时求解`O(log n)`？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-09-02T17:49:32.490

如果不能保证数组元素是不同的，那么就不可能在 O(log n) 时间内做到这一点。原因如下：假设您有一个数组，其中所有 n > 1 值都相同。在这种情况下，没有一个元素可以是局部最小值，因为没有一个元素小于它的邻居。但是，为了确定所有值都相同，您必须查看所有数组元素，这需要 O(n) 时间。如果您使用的时间少于 O(n)，则不一定能查看所有数组元素。

另一方面，如果保证数组元素是不同的，则可以使用以下观察在 O(log n) 时间内解决此问题：

1.  如果只有一个元素，则保证为局部最小值。
2.  如果有多个元素，请查看中间元素。如果它是局部最小值，那么您就完成了。否则，它旁边的至少一个元素必须小于它。现在，想象一下，如果您从较小的元素之一开始，并沿着远离中间元素的方向逐渐向数组的一端移动，会发生什么情况。在每一步，要么下一个元素小于前一个元素，要么它会更大。最终，您要么以这种方式达到数组的末尾，要么达到局部最小值。请注意，这意味着您**可以**这样做是为了找到一个局部最小值。但是，我们实际上不会这样做。相反，我们将使用在数组的这一半中存在局部最小值这一事实作为丢弃一半数组的理由。在剩下的部分中，我们保证找到一个局部最小值。

因此，您可以构建以下递归算法：

1.  如果只有一个数组元素，则为局部最小值。
2.  如果有两个数组元素，请检查每个元素。一个必须是局部最小值。
3.  否则，请查看数组的中间元素。如果是局部最小值，则返回它。否则，至少有一个相邻值必须小于这个值。递归包含该较小元素的数组的一半（但不是中间）。

请注意，这具有递归关系

> T(1) ≤ 1
> 
> T(2) ≤ 1
> 
> T(n) ≤ T(n / 2) + 1

使用主定理，您可以根据需要证明该算法在 O(log n) 时间内运行。

希望这可以帮助！

另请注意，仅当数组的边缘小于相邻元素时，该算法才有效。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-02T17:44:45.143

局部最小值的数量可以是`n/2`; 您无法及时枚举它们`O(log n)`。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-01-20T17:33:50.963

使用分而治之的算法。令 m = n/2，并检查值 A[m]（即数组中间的元素）。

情况 1：A[m-1] < A[m]。那么数组的左半部分必须包含一个局部最小值，所以在左半部分递归。我们可以通过矛盾来证明这一点：假设 A[i] 不是每个 0 ≤ i < m 的局部最小值。那么 A[m-1] 不是局部最小值，这意味着 A[m-2] < A[m-1]。类似地，A[m -3] < A[m -2]。以这种方式继续，我们得到 A[0] < A[1]。但是 A[0] 是一个局部最小值，这与我们最初的假设相反。

情况 2：A[m + 1] > A[m]。那么数组的右半部分必须包含一个局部最小值，所以在右半部分递归。这与案例 1 对称。

情况 3：A[m - 1] > A[m] 和 A[m + 1] < A[m]。那么 A[m] 是一个局部最小值，所以返回它。运行时间递归为 T(n) = T(n/2) + Θ(1)，得出 T(n) = Θ(log n)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-28T21:02:01.670

你的算法不适用于这个数组

```
15, 13, 12, 18, 19, 20, 7, 6, 5, 4, 3, 2, 1 
```

这里的局部最小值是 12.. 但是当我检查中间元素 7 时，您的算法将丢弃左半部分（具有最小值）并检查右半部分。因此它不起作用

我认为它仅适用于数组具有 A[1] ≥ A[2] 和 A[n - 1] ≤ A[n] 的特殊属性的特殊情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-07-11T17:08:59.390

原来的问题不完整。

[刚刚在Find local minima in a array 中](http://www.dsalgo.com/2013/03/find-local-minima-in-array.html)找到了完整的问题和详细的解释 ！- 不是我的博客

给定一个唯一整数数组，其前两个数字正在减少，最后两个数字正在增加，请在数组中找到一个局部最小值。如果数组中的数字小于其左右数字，则称为局部最小值。

例如，在数组 9,7,2,8,5,6,3,4 中，2 是一个局部最小值，因为它小于其左右数字 7 和 8。类似地，5 是另一个局部最小值，因为它在 8 之间和 6，都大于 5。

您需要找到任何一个局部最小值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-09-28T00:33:48.340

这是一个适用于 O(log n) 的解决方案。基本上，这适用于合并排序方法（分而治之）。

```
public class LocalMaxima {
    int []a = {5,8,10,25,6,3,44,51,55,56,57,58,34,5,59};

    @Test 
    public  void localMaxima () {
        System.out.println((a[localMaxima(0,a.length-1)]));
    }

    int localMaxima(int low, int high) {
        if(high-low > 2) {
            int mid = (low+high)/2;
            return maxof(localMaxima(low,mid),localMaxima(mid+1, high));
        }
        else if(high-low == 1) {
            return maxof(high,low);
        }
        else if(high-low == 0) {
            return high;
        }
        if(high-low == 2) {
            return maxof(maxof(low, high),low+1);
        }
        return 0;
    }

    int maxof(int i, int j) {
        if(a[i] <a[j]) {
            return j;
        }
        else {
            return i;
        }
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-09-28T05:21:12.327

实际上，我以前的算法可以修改为在 O(log n) 时间内获得所有最大值。我测试了它对提供的所有输入都很好。请让我知道您的反馈

```
public class LocalMaximas {

@Test
public void test () {
    System.out.println("maximas: please modify code to handle if array size is <= 2");

    int []a = {5,8,10,25,6,3,44,51,55,56,57,58,34,5,59,2};
    localMaximas(a);

    int []b = {9,7,2,8,5,6,3,4, 2}; //9,8,6,4
    localMaximas(b);

    int [] c= {15, 13, 12, 18, 19, 20, 7, 6, 5, 4, 3, 2, 1};//15,20
    localMaximas(c);
}

public  void localMaximas (int [] a) {
    System.out.println("\n\n");
    if(isMaxima(a,0)) {
        System.out.println(a[0]);
    }
    if(isMaxima(a,a.length-1)) {
        System.out.println(a[a.length-1]);
    }
    localMaximas(a,0,a.length-1);
}

int localMaximas(int []a,int low, int high) {
    int mid = (low+high)/2;
    if(high-low > 3) {     // more than 4 items in currently  divided array
        if(isMaxima(a,mid)) {
            System.out.println(a[mid]);
        }   
        localMaximas(a,low, mid);
        localMaximas(a,mid, high);
    }
    else if(high-low == 3){ //exactly 4 items in currently  divided array
        localMaximas(a,low, mid+1);
        localMaximas(a,mid, high);
    }   
    else if((high-low == 2) && (isMaxima(a,low+1))) {
        System.out.println(a[low+1]);
    }
    return 0;
}

int maxof(int []a, int i, int j) {
    if(a[i] <a[j]) {
        return j;
    }
    else {
        return i;
    }
}

boolean isMaxima(int []a ,int mid) {
    if(mid == 0) {
        if(maxof(a, mid, mid+1) == mid) {
            return true;
        }
        else {
            return false;
        }
    }
    else if(mid==a.length-1) {
        if(maxof(a,mid,mid-1) == mid) {
            return true;
        }
        else {
            return false;
        }
    }
    else {
        if((maxof(a, mid, mid+1) == mid) && (maxof(a, mid, mid-1) == mid)) {
            return true;
        }
        else {
            return false;
        }           
    }
}
} 
```

# python - 在 sqlalchemy 中，如何获取与表中所有行匹配的查询，以使另一个表中的行没有链接到它？

> ID：12238243
> 
> 赞同：1
> 
> 时间：2012-09-02T17:37:13.587
> 
> 标签：python, sqlalchemy

我有两个表，“event”和“event_exception”。表“事件”有一个（布尔）列“常规”，指示事件是否每年定期发生。表“event_exception”具有列“event_id”、列“year”和（布尔）列“occurs”。

数据应以这种方式解释：

*   有些事件每年都会定期发生，但有时它们会异常地不发生，这是由“event.regular == True”的“event”行和“event_exception.occurs == False”的“event_exception”行编码的每年都会特别省略该事件。
*   有些事件不会定期发生，但有时它们会异常发生。这是由“event.regular == False”的“event”行和“event_exception.occurs == True”的“event_exception”行编码的，用于事件异常发生的每一年。

如何编写一个匹配今年将发生的所有事件的查询？

我的猜测是

```
session.query(Event, EventException).filter(Event.id==EventException.event_id)
.filter(EventException.year==current_year).
filter(or_(
    and_(Event.regular==1, EventException.occurs==0, having(count(EventException)==0)),
    and_(Event.regular==0, EventException==1, having(count(EventException)>0)
)) 
```

，但我不确定该`having`子句是否可以在`and_`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:59:19.433

不确定答案，我只是想注意一些事情，因为我最近在 sqlalchemy 下遇到了一些布尔查询问题......

*   您应该将布尔比较作为“== True”和“== False”进行。MySQL 将布尔值存储为 1/0，但 PostgreSQL 和其他存储为 true/false，Python 也是如此。SqlAlchemy 会根据需要进行转换，但是当您查看其他人的代码时……这看起来像是 INT 比较而不是 BOOL。对于将来必须查看此内容的其他人来说，这将变得更加容易。.

*   根据 SQL 存储引擎和列默认值，您可能无法获得想要的结果。如果集合中允许有 NULL 值，则您的比较将不匹配。您将通过以下搜索获得所需的结果：

    `Event.regular.op('IS NOT')(True)`

    `Event.regular.op('IS')(False)`

    `sqlalchemy.sql.functions.coalesce( Event.regular , False ) != True` `sqlalchemy.sql.functions.coalesce( Event.regular , False ) == False`

在第一段代码中，我们搜索不为 True 的项目——这将是 False 和 NULL。结果集`regular != True`仅包含`False`项目；`regular IS NOT True`包含的结果集`False`和`Null`

在第二段代码中，数据库将在比较之前合并`Null`值。`False`

您可能不需要进行这些比较，但是如果您这样做并且结果看起来不正确，这可能就是原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T00:21:51.157

你不能`HAVING`没有`GROUP BY`. 无论如何，在这种情况下，它们都不是必需的，需要的是`EXISTS`. 假设您已经为 定义了 SQLAlchemy 关系`Event.exceptions`，则以下表达式应该可以工作：

```
session.query(Event).filter(or_(
    and_(
        Event.regular == True,
        ~Event.exceptions.any(and_(
            EventException.year == current_year,
            EventException.occurs == False,
        )),
    ),
    and_(
        Event.regular == False,
        Event.exceptions.any(and_(
            EventException.year == current_year,
            EventException.occurs == True,
        )),
    ),
)) 
```

并生成如下 SQL：

```
SELECT event.*
FROM event
WHERE
    (
        event.regular = true
        AND NOT EXISTS (
            SELECT 1
            FROM event_exception
            WHERE
                event.id = event_exception.event_id
                AND event_exception.year == :year
                AND event_exception.occurs = false
        )
    )
    OR
    (
        event.regular = false
        AND EXISTS (
            SELECT 1
            FROM event_exception
            WHERE
                event.id = event_exception.event_id
                AND event_exception.year == :year
                AND event_exception.occurs = true
        )
    ) 
```

编辑：第一个条件应该`NOT EXISTS`使用

# windows - 在安装期间检查所有用户配置文件

> ID：12238245
> 
> 赞同：0
> 
> 时间：2012-09-02T17:37:21.287
> 
> 标签：windows, registry, windows-installer

我正在创建一个 Windows 应用程序，它需要向 Send-To 资源管理器上下文菜单添加一个条目，并且需要为所有用户这样做。由于 Send-To 文件夹对每个用户都是特定的，所有用户都没有公用文件夹，所以我有两个选择：

我可以查看所有用户配置文件以及默认用户配置文件，找到 SendTo 文件夹并将快捷方式添加到它。这将确保在卸载期间删除快捷方式。

或者，我可以确保每次用户登录时快捷方式都在 SendTo 文件夹中（通过将我的应用程序添加到所有用户的启动文件夹中）。这将使我在安装过程中的生活更轻松，但是当应用程序被卸载时，所有这些快捷方式都不会被删除。

所以无论哪种方式，我都需要一种方法来找到所有用户的 SendTo 文件夹。我可以扫描 HKEY_USERS 并找到每个用户的 SendTo 文件夹（它可能不在默认位置，用户可以移动它），但是我如何找到用户配置文件的根文件夹？对于 SendTo 文件夹，注册表有类似 %USERPROFILE\AppData\Roaming... 的内容。如何确定另一个用户的 %USERPROFILE% 是什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T00:50:15.520

**更简单的方法**：使用 exe 本身的启动序列来检查它在启动时是否存在快捷方式，如果没有，则创建它。

最好使用 ActiveSetup 处理所有用户的卸载，它将为每个登录机器的用户运行一次“可运行的东西”。在您的情况下，一个简单的批处理命令可以完成这项工作。

如果您确实选择了这种卸载方法，则必须确保您的 msi 安装程序检查此卸载密钥并在安装时将其删除 - 否则您将在下次用户登录时为快捷方式安排删除操作。

另请记住，每次安装都应在 ActiveSetup 中使用不同的条目，以确保为已卸载快捷方式的用户重新运行快捷方式创建。在您阅读有关 ActiveSetup 的更多信息之前，最后一部分可能有点难以理解：[http ://www.etlengineering.com/installer/activesetup.txt](http://www.etlengineering.com/installer/activesetup.txt)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T12:23:17.290

您可以在 MSI 中创建自定义操作，该操作将遍历所有用户配置文件并从 SendTo 文件夹中删除您的快捷方式。您可以找到所有用户配置文件，只需扫描 Windows7 (Vista) 中 %systemdrive%\Users 文件夹中的所有文件夹，或 Windows XP 中的 Documents and Settings 中的所有文件夹。

或者您可以为此目的使用 ActiveSetup 机制，创建一些脚本（应用程序）从 SendTo 文件夹中删除您的快捷方式，当用户下次登录系统时。

# iis - 是否可以控制请求数据？

> ID：12238247
> 
> 赞同：0
> 
> 时间：2012-09-02T17:37:28.257
> 
> 标签：iis, filter, request

我想在 IIS 端控制请求内容（GET，POST）。那可能吗？控制是指过滤字符或字符串。也可以检查 request 是否只有某些变量列表（例如`foo`，`bar`对于 request `http://site?foo=a&bar=b`）。

# flash - 触屏游戏控制和Flash Stage

> ID：12238255
> 
> 赞同：0
> 
> 时间：2012-09-02T17:38:04.517
> 
> 标签：flash, actionscript-2, game-physics, touchscreen

我正在尝试制作一个基于触摸的游戏，并在 Flash 中与 Stage 作斗争。我需要通过触摸天空中的一个区域来发射大炮（我有这个工作），但是当我触摸虚拟按钮时，我还需要大炮忽略/不瞄准和射击。

它归结为舞台和我无法从中分离出我的虚拟按钮。我觉得我需要将虚拟按钮制作成影片剪辑，然后通过一些层次结构方法在动作脚本中对其进行处理，例如：_root.button_mc.blahblahblah，但我似乎找不到正确的方法。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:29:45.483

舞台代表整个可见区域。如果你监听舞台的 onMouseDown 事件，它会在任何地方的任何点击被触发。

您必须在舞台上绘制一个剪辑“bigArea”，覆盖您想要使其可点击的所有区域，并在此监听点击事件。然后你画你的按钮，你也把它放在 bigArea 上面的舞台上

```
Stage
|- yourButton
|- bigArea 
```

如果您单击 yourButton，您也会单击舞台，但不会单击 bigArea。

# ruby-on-rails-3 - 为什么我不能阻止 Solr 运行？

> ID：12238257
> 
> 赞同：2
> 
> 时间：2012-09-02T17:38:14.527
> 
> 标签：ruby-on-rails-3, sunspot-rails, sunspot-solr

我使用的[sunspot_solr版本是 1.3.3。](https://rubygems.org/gems/sunspot_solr)

我正在使用[sunspot_solr gem](https://rubygems.org/gems/sunspot_solr)来启动和停止 Solr 的本地实例。我使用以下命令来启动它：

```
rake sunspot:solr:start 
```

和以下命令停止它：

```
rake sunspot:solr:stop 
```

但是，停止不起作用。我注意到 pids 文件夹中写入的 pid 不是正确的。

`ps -ef | grep 'java'`当我开始时，我可以在命令中看到以下输出：

```
1000      4758  4752  0 20:32 ?        00:00:00 sh -c java -Djetty.port\=8982 -Dsolr.data.dir\=/home/panayotis/my_documents/ezMTA/solr/data/development -Dsolr.solr.home\=/home/panayotis/my_documents/ezMTA/solr -Djava.util.logging.config.file\=/tmp/logging.properties20120902-4758-13patuu -jar start.jar

1000      4761  4758  7 20:32 ?        00:00:01 java -Djetty.port=8982 -Dsolr.data.dir=/home/panayotis/my_documents/ezMTA/solr/data/development -Dsolr.solr.home=/home/panayotis/my_documents/ezMTA/solr -Djava.util.logging.config.file=/tmp/logging.properties20120902-4758-13patuu -jar start.jar 
```

这意味着真正的服务器进程是 pid "4761" 的那个。进程“4758”仅用于在 shell 中启动服务器。

当我 cat pid 文件时，我看到：

```
cat solr/pids/development/sunspot-solr-development.pid
4758 
```

这意味着`rake sunspot:solr:stop`正在杀死“4758”并让“4761”启动并运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T01:39:19.500

这是一个错误！

```
1000      4758  4752  0 20:32 ?        00:00:00 sh -c java -Djetty.port\=8982 -    Dsolr.data.dir\=/home/panayotis/my_documents/ezMTA/solr/data/development -Dsolr.solr.home\=/home/panayotis/my_documents/ezMTA/solr -Djava.util.logging.config.file\=/tmp/logging.properties20120902-4758-13patuu -jar start.jar

1000      4761  4758  7 20:32 ?        00:00:01 java -Djetty.port=8982 -Dsolr.data.dir=/home/panayotis/my_documents/ezMTA/solr/data/development -Dsolr.solr.home=/home/panayotis/my_documents/ezMTA/solr -Djava.util.logging.config.file=/tmp/logging.properties20120902-4758-13patuu -jar start.jar 
```

因为进程4758是前台进程，而进程4761是后台进程，所以如果你杀死pid 4758，它不会破坏他的子进程4761，init进程将成为进程4761的父进程！

在 sunspot_solr/lib/sunspot/solr/server.rb #line 103

```
exec(Shellwords.shelljoin(command)) 
```

Shellwords.shelljoin(command) 是一个字符串，但是[Kernel#exec](http://ruby-doc.org/core-1.9.3/Kernel.html#method-i-exec)描述：

```
exec([env,] command... [,options]) 
```

如果给定单个字符串作为命令，则将其视为命令行，在执行之前需要进行 shell 扩展。标准 shell 在类 Unix 系统上始终表示“/bin/sh”。

所以，它将启动两个过程。

使用这个： exec(*command)

将启动一个进程，因此 rake sunspot:solr:stop 将正常工作。

[看到这个拉取请求](https://github.com/sunspot/sunspot/pull/221)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T06:52:25.193

我已经降级到`'sunspot_solr', '1.3.1'`现在它工作正常。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-07-28T13:28:53.290

像这样设置环境 -`RAILS_ENV=production rake sunspot:solr:stop`

# android - 如何在android中同步声音播放？

> ID：12238260
> 
> 赞同：4
> 
> 时间：2012-09-02T17:38:40.327
> 
> 标签：android, android-mediaplayer

我正在编写我的第一个 android 应用程序，尝试同步播放两个 10 分钟的声音文件（想象一个乐器音轨和一个无伴奏合唱），以便能够独立更改每个音轨的音量）。我为此使用了两个 MediaPlayer，因为就我所读到的而言，SoundPool 的目标是较短的音频样本。

现在我的问题是，在暂停和恢复播放时，有时播放器不再同步，即使我在恢复播放之前将它们的位置设置为相同的值。

我知道这是不可避免的，因为它们不能在完全相同的时刻开始，并且它们可能需要不同的时间来开始播放，但是：是否有其他方法可以满足我的要求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T19:11:52.557

你可以看看[JetPlayer](http://developer.android.com/guide/topics/media/jetplayer.html)，这可以完成你想要的同步。

要使用它，您可以在轨道中创建音频通道（您的乐器通道和人声通道）作为 MIDI 文件，播放器可以保持它们同步，同时允许您根据需要将不同的通道静音或取消静音。

[可以在此处](http://developer.android.com/guide/topics/media/jet/jetcreator_manual.html)找到创建 JET 资源的用户指南。

# android - 不错的安卓ORM工具

> ID：12238262
> 
> 赞同：-2
> 
> 时间：2012-09-02T17:39:04.303
> 
> 标签：android, orm, android-sqlite

我正在构建一个本机应用程序，它的所有实体都应该在 sqlite 数据库中进行通信。我一直在寻找一个不错的安卓 ORM 工具，它应该类似于 Iphone 的 CoreData（它支持图形设计和代码生成）。

我想根据图形设计构建我的实体代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T08:12:26.120

如果它只是关于创建和管理数据库并且您可以使用 SQLite，那么看看这个页面：

[SQLite 管理工具列表](http://www.sqlite.org/cvstrac/wiki?p=ManagementTools)

有很多工具 listet 可以与 SQLite 一起使用，当然应该有一个适合您的需要。

另外，我认为您对 ORM 使用了错误的术语。您想要的是一个管理工具，您可以在其中与设计师一起构建您的数据库。ORM 系统基本上是数据库和编程语言之间的映射器。当你想用代码表示你的数据库时，ORM 就会发挥作用。

参见维基百科的描述：

> 计算机软件中的对象关系映射（ORM、O/RM 和 O/R 映射）是一种编程技术，用于在面向对象编程语言中的不兼容类型系统之间转换数据。这实际上创建了一个可以在编程语言中使用的“虚拟对象数据库”。尽管一些程序员选择创建自己的 ORM 工具，但可以使用免费和商业包来执行对象关系映射。

[ORM 上的维基百科页面](http://de.wikipedia.org/wiki/ORM)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:59:32.053

虽然周围[有一些](https://stackoverflow.com/questions/371538/any-good-orm-tools-for-android-development)（SQLite）ORM 库适用于 Android，但据我所知，没有图形工具可以输出`Class`为任意 ORM 类模板量身定制的 Java es。Java 中的 ORM 倾向于用于`@Annotations`包装数据库中的给定字段，并且每个 ORM 几乎都有自己的风格。

因此，我建议您为您的预期数据库（最终在建模应用程序中）布置蓝图，并尝试使用所选 ORM 的特定 API 重新创建它。希望这对你有帮助！

# java - String.split() 将保留原始字符数组

> ID：12238263
> 
> 赞同：3
> 
> 时间：2012-09-02T17:39:05.027
> 
> 标签：java, string, split, substring, deep-copy

我注意到 Java String 将在其中重用 char 数组，以避免在 subString() 等方法中为新的 String 实例创建新的 char 数组。为此目的，String 中有几个 unpublish 构造函数，接受一个 char 数组和两个 int 作为范围来构造一个 String 实例。

但是直到今天我发现 split 也会重用原始 String 实例的 char arr 。现在我从一个文件中读取了一个 loooooong 行，用“，”分割它，并为实际使用剪切了一个非常有限的列。因为每一行都偷偷持有looooong char数组的引用，所以很快就得到了OOO。

这是示例代码：

```
ArrayList<String> test = new ArrayList<String>(3000000);
BufferedReader origReader = new BufferedReader(new FileReader(new File(
        "G:\\filewithlongline.txt")));
String line = origReader.readLine();
int i = 0;
while ((line = origReader.readLine()) != null) {
    String name = line.split(',')[0];
    test.add(name);
    i++;
    if (i % 100000 == 0) {
        System.out.println(name);
    }
}
System.out.println(test.size()); 
```

JDK中是否有任何标准方法来确保吐出的每个String实例都是“真正的深拷贝”而不是“浅拷贝”？

现在我正在使用一个非常丑陋的解决方法来强制创建一个新的 String 实例：

```
ArrayList<String> test = new ArrayList<String>(3000000);
BufferedReader origReader = new BufferedReader(new FileReader(new File(
        "G:\\filewithlongline.txt")));
String line = origReader.readLine();
int i = 0;
while ((line = origReader.readLine()) != null) {
    String name = line.split(',')[0]+"  ".trim(); // force creating a String instance
    test.add(name);
    i++;
    if (i % 100000 == 0) {
        System.out.println(name);
    }
}
System.out.println(test.size()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T17:45:45.603

最简单的方法是直接创建一个新字符串。这是一个好主意的罕见情况之一。

```
String name = new String(line.split(",")[0]); // note the use of "," 
```

另一种方法是自己解析文件。

```
do {
    StringBuilder name = new StringBuilder();
    int ch;
    while((ch = origReader.read()) >= 0 && ch != ',' && ch >= ' ') {
       name.append((char) ch);
    }
    test.add(name.toString());
} while(origReader.readLine() != null); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T20:41:23.827

`String`有一个可用于此目的的[复制构造函数。](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#String%28java.lang.String%29)

```
final String name = new String(line.substring(0, line.indexOf(','))); 
```

...或者，正如彼得建议的那样，只阅读直到`,`.

```
final StringBuilder buf = new StringBuilder();
do {
  int ch;
  while ((ch = origReader.read()) >= 0 && ch != ',') {
    buf.append((char) ch);
  }
  test.add(buf.toString());
  buf.setLength(0);
} while (origReader.readLine() != null); 
```

# android - 由视图的代码属性定义

> ID：12238265
> 
> 赞同：0
> 
> 时间：2012-09-02T17:39:24.897
> 
> 标签：android, android-view

如何通过代码定义视图的属性？

例如，如何使用此属性（宽​​度、高度、顶部边距等）定义此图像按钮？

```
<ImageButton
    android:id="@+id/add_butt1"
    android:layout_width="35dp"
    android:layout_height="35dp"
    android:layout_marginTop="50dp"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:src="@drawable/button_state" 
/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:48:14.927

如果您正在谈论 layout_ 属性 - 可以使用布局的 LayoutParams 内部类定义，您要在其中添加视图。例如，如果要将视图添加到 RelativeLayout，您可以使用：http: [//developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html 。](http://developer.android.com/reference/android/widget/RelativeLayout.LayoutParams.html)

```
 RelativeLayout layout = findViewById(R.id.my_layout);
        RelativeLayout.LayoutParams params = new RelativeLayout.LayoutParams(
                    RelativeLayout.LayoutParams.WRAP_CONTENT,
                    RelativeLayout.LayoutParams.WRAP_CONTENT);
        params.leftMargin = 10; //px
        layout.addView(new TextView(this), params); 
```

# java - 返回任何类型的对象

> ID：12238273
> 
> 赞同：0
> 
> 时间：2012-09-02T17:40:35.383
> 
> 标签：java, oop, generics

在我的**缓存类**中，我将有一个函数将对象的序列化版本（未确定的类型）写入文件，如下所示（通用函数）：

```
public <O> void write(O object) {

   // ...
   serialize(file, object);
   // ...

} 
```

效果很好，但是，我无法找到一种方法来创建**可以返回任何对象**的方法，就像该`write()`方法可以采用任何对象一样。寻找这样的东西：

```
public <O> read() {

   // ...
   O object = unserialize(file);
   // ...

   return object;

} 
```

任何关于如何实现这一点的建议都非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T17:42:56.613

您指定 Object 类型的返回类型：

```
public Object function(...) 
```

这样，返回类型将始终为 Object 类型（因为所有对象都是 的后代`Object`），因此它们将被接受。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T17:43:19.503

如果你的意思是

```
public <O> O read() { 
```

这几乎没用，因为它与

```
public Object read() { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T17:48:01.070

不确定我是否正确理解了这个问题......您可以将这两种方法包装在一个类中并使用对象的类型参数化该类，如下所示：

```
public class ReaderWriter <T> {
    public ReaderWriter(File file) {...}
    public void write(T object) {...}
    public T read() {...}
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T17:49:09.750

我会通过使整个班级通用来做到这一点

```
class Cache <O extends Serializable> {

    public void write(O object) {
        serialize(file, object);
    }

    public O read() {
        O object = (O)unserialize(file);

        return object;
    }
} 
```

注意返回对象的转换。

除此之外，您应该使用`<O extends Serializable>`而不仅仅是`<O>`. 这可确保您的类型参数 id 是可序列化的类型。如果要保存（序列化）对象并防止以后出现错误，则需要这样做。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T17:54:47.330

我假设 read() 的调用者知道它期望得到哪种类型。这是一个合理的假设，因为他要将返回值分配给某个变量：

```
MyType o = read(...); // Caller knows he's going to get a MyType object 
```

如果这个假设是真的，那么你应该改变`read()`方法，让它接受一个类对象：

```
public<T> T read(Class<T> t) {
   ... 
} 
```

然后调用站点将如下所示：

```
MyType o = read(MyType.class); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-03T23:44:17.043

是的，

```
public <O> O read() 
```

是有效的并且会做你想做的（返回调用者想要的任何类型）。这是否是一个好主意是另一回事

# xml - 错误的命名空间？xsl：模板找不到匹配项

> ID：12238279
> 
> 赞同：3
> 
> 时间：2012-09-02T17:41:29.947
> 
> 标签：xml, xslt, namespaces, match

我对这个问题感到很惭愧，但我找不到解决方案，希望你能帮助我。

这是我的代码 xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="C:/Program%20Files/XML%20Copy%20Editor/esercizi%20xml/prova2.xsl"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0">
<teiHeader>
    <fileDesc>
        <titleStmt>
            <title></title>
        </titleStmt>
        <publicationStmt><p>AA</p></publicationStmt>
        <sourceDesc><p>AA</p></sourceDesc>
    </fileDesc>
</teiHeader>
    <text>
    <body><div>
    <head>Titolo</head>
        <p>Scriver&#242; un <rs>nome</rs> di luogo come questo:  <rs key="Persia" type="luogo">Persia</rs>.</p>
    </div></body>
    </text>
</TEI> 
```

这就是我在我的文件 xsl 中写的：

```
<?xml version="1.0" encoding="UTF-8"?>

<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:tei="http://www.tei-c.org/ns/1.0" xmlns="http://www.w3.org/1999/xhtml" version="1.0">  
    <xsl:template match="/">  
        <back>
            <div>
               <xsl:value-of select="//rs"/>
            </div>
        </back>     
    </xsl:template>
</xsl:stylesheet> 
```

输出是：

```
<?xml version="1.0" encoding="UTF-8"?>
<back xmlns="http://www.w3.org/1999/xhtml" xmlns:tei="http://www.tei-c.org/ns/1.0">
  <div/>
</back> 
```

我不明白我的错误在哪里；我想它在[命名空间](http://www.w3schools.com/xml/xml_namespaces.asp)中，但我找不到解决方案。

谢谢指教！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:57:41.993

```
 <div> 
           <xsl:value-of select="//rs"/> 
        </div> 
```

“选择”属性中的表达式尝试选择`rs`“无命名空间”中的任何元素，但没有这样的元素——没有选择任何内容。

**你实际上想要**：

```
 <div> 
           <xsl:value-of select="//tei:rs"/> 
        </div> 
```

然而，在 XSLT 1.0 中，这仅输出第一个选定`rs`元素。

**如果您想要所有这些，请使用以下内容**：

```
 <div> 
          <xsl:for-each select="//tei:rs">
           <p><xsl:value-of select="."/></p>
          </xsl:for-each> 
        </div> 
```

# java - 浏览器中的 java.lang.reflect.invocationtargetexception

> ID：12238280
> 
> 赞同：1
> 
> 时间：2012-09-02T17:41:37.643
> 
> 标签：java, browser, applet

我制作了这个运行记事本的小 Java 代码：

```
import java.io.IOException;

public class pad {

    public static void main(String[] args) throws IOException, InterruptedException {
        execute();
    }

    private static void execute() throws IOException, InterruptedException {
        Process exec = Runtime.getRuntime().exec("notepad.exe");
        exec.waitFor();
    }
} 
```

该代码在构建到 .jar 文件之前和之后都可以正常工作，但是当从 html 页面运行时，它会给我一个 java.lang.reflect.invocationtargetexception 错误，这是 html 源代码：

```
<applet code="pad.class"
    archive="not.jar"
    width=400 height=400>
</applet> 
```

请注意，我还是 Java 新手，感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:49:11.293

为了在 Web 浏览器中运行您的代码，`pad`该类需要扩展`Applet`类（或者如果您使用 Swing - [`JApplet`](http://docs.oracle.com/javase/6/docs/api/javax/swing/JApplet.html)）。

您需要知道的第一件事是，applet 不是使用该`main(String[])`方法启动的——它们有一个[生命周期方法](http://docs.oracle.com/javase/tutorial/deployment/applet/lifeCycle.html)，如`init()`,`start()`等。

Oracle 网站上有一个[关于 Applets 的很好的教程](http://docs.oracle.com/javase/tutorial/deployment/applet/)，我强烈建议你去看看。

# helper - 助手应用位置

> ID：12238282
> 
> 赞同：1
> 
> 时间：2012-09-02T17:41:43.720
> 
> 标签：helper, mac-app-store

将 Mac 助手应用程序放入另一个应用程序的捆绑包中的最佳位置在哪里？我找不到明确的答案（包括 Mac App Store 可以接受的答案）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:44:47.370

对于任何捆绑包，您都可以`Support`在目录内创建一个名为的文件夹：

```
XYZ.app/
    Info.plist
    XYZ
    Icon.png
    Support/
        SomeHelper 
```

# ember.js - 如何使用操作助手访问 ember 1.0 pre 中的特定上下文

> ID：12238283
> 
> 赞同：4
> 
> 时间：2012-09-02T17:41:47.497
> 
> 标签：ember.js

在我的 ember 视图中，我想在此期间获取该人并将其传递给操作，但目前我仅在路由器中获得一个 jquery 事件（好奇这是否在 1.0 之前的版本中免费绑定到上下文）

模板

```
<script type="text/x-handlebars" data-template-name="person">
       {{#each person in controller}}
          <li> 
          {{person.username}}
          <input type="submit" value="delete" {{action removePerson person}}/>                   
          </li>
       {{/each}}
</script> 
```

带有我希望通过人员上下文调用的方法的路由器

```
Router: Ember.Router.create({
  root: Ember.Route.extend({
    index: Em.Route.extend({
      route: '/',
      removePerson: function(router, context) {
        router.get('personController').removePerson(context);
      }, 
```

控制器更详细

```
PersonController: Ember.ArrayController.extend({
      content: [],                                                                               
      addPerson: function (username) {
        var person = PersonApp.Person.create({
          username: username
        });
        this.pushObject(person);
      },
      removePerson: function (person) {
        this.removeObject(person);
      }
    }), 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T20:45:10.037

传递给路由器操作处理程序的第二个变量实际上是事件。上下文是此事件的变量。像这样重写它：

```
Router: Ember.Router.create({
  root: Ember.Route.extend({
    index: Em.Route.extend({
      route: '/',
      removePerson: function(router, event) {
        router.get('personController').removePerson(event.context);
      }, 
```

# ruby - Webbynode gem 冲突 (Gem::LoadError)

> ID：12238284
> 
> 赞同：1
> 
> 时间：2012-09-02T17:41:51.043
> 
> 标签：ruby, gem, webbynode

我已经安装了 Webbynode gem：

```
sudo gem install webbynode 
```

但是当我尝试一些命令时，比如：

```
wb help 
```

显示此错误：

```
Unable to activate launchy-2.1.0, because addressable-2.3.2 conflicts with addressable (~> 2.2.6) (Gem::LoadError) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T19:57:04.180

试试看：

```
gem uninstall addressable 
```

所以删除冲突宝石，最终应该只有一个可寻址的。

这个对我有用。

# android - Android lastKnownLocation 返回 null

> ID：12238290
> 
> 赞同：0
> 
> 时间：2012-09-02T17:42:40.957
> 
> 标签：android, geolocation, location

我遇到了这个问题，我在代码中看不到任何错误，但 getLastKnownLocation 每次都返回 null 。有任何想法吗 ？

```
public class LocationDemo2Activity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        EditText et1 = (EditText) findViewById(R.id.editText1);

        LocationManager manager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);
        Location location = manager.getLastKnownLocation(LocationManager.GPS_PROVIDER);

        if(location != null)    et1.setText((int)location.getLatitude());
        else et1.setText("null");

    }
} 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T17:50:18.093

`getLastKnownLocation()`将经常返回`null`，尤其是在最近未使用位置提供程序（例如 GPS）的情况下。您仅`getLastKnownLocation()`在您并不真正*需要*位置（但希望拥有一个）或在`getLastKnownLocation()`返回时将使用其他技术`null`（例如，请求位置更新）的情况下使用。

# vb.net - 试图理解 IDisposable

> ID：12238295
> 
> 赞同：0
> 
> 时间：2012-09-02T17:44:06.517
> 
> 标签：vb.net, garbage-collection, idisposable

如果 IDisposable 和 GC 工作集，我阅读了一些关于实现的文章和博客。但是，我无法理解差异化的核心领域，例如：以下是我的测试类的代码：

```
Imports System.ComponentModel
Namespace Classes
    Public Class BaseClass
        Implements INotifyPropertyChanged
        Implements IDisposable

        Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged

        Protected Friend Sub NotifyPropertyChanged(ByVal info As String)
            RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(info))
        End Sub

#Region "IDisposable Support"
        Private disposedValue As Boolean ' To detect redundant calls

        Protected Overridable Sub Dispose(disposing As Boolean)
            If Not Me.disposedValue Then
                If disposing Then
                    ' TODO: dispose managed state (managed objects).
                End If
            End If
            Me.disposedValue = True
        End Sub
        Public Sub Dispose() Implements IDisposable.Dispose
            Dispose(True)
            GC.SuppressFinalize(Me)
        End Sub
#End Region

    End Class

    Public Class GenreClass
        Inherits BaseClass
#Region "Private Variables"
        Private _GenreValue As String
        Private _IconValue As String
        Private _IsSelectedValue As Boolean
        Private _IsExpandedValue As Boolean
#End Region

#Region "Property Variables"
        Property Genre As String
            Get
                Return _GenreValue
            End Get
            Set(Value As String)
                If Not _GenreValue = Value Then
                    _GenreValue = Value
                    NotifyPropertyChanged("Genre")
                End If
            End Set
        End Property
        Property Icon As String
            Get
                Return _IconValue
            End Get
            Set(Value As String)
                If Not _IconValue = Value Then
                    _IconValue = Value
                    NotifyPropertyChanged("Icon")
                End If
            End Set
        End Property
        Property IsSelected As Boolean
            Get
                Return _IsSelectedValue
            End Get
            Set(Value As Boolean)
                If Not _IsSelectedValue = Value Then
                    _IsSelectedValue = Value
                    NotifyPropertyChanged("IsSelected")
                End If
            End Set
        End Property
        Property IsExpanded As Boolean
            Get
                Return _IsExpandedValue
            End Get
            Set(Value As Boolean)
                If Not _IsExpandedValue = Value Then
                    _IsExpandedValue = Value
                    NotifyPropertyChanged("IsExpanded")
                End If
            End Set
        End Property
#End Region

        Protected Overrides Sub Dispose(disposing As Boolean)
            Genre = Nothing
            MyBase.Dispose(disposing)
        End Sub

        Public Overrides Function ToString() As String
            Return Genre
        End Function            
    End Class
End Namespace 
```

我的测试场景如下： Test1：

```
Dim list1 As New List(Of HODLib.Classes.GenreClass)
For i = 0 To 4
    Using z As New HODLib.Classes.GenreClass

        With z
            .Genre = "asdasd"
            .Icon = "asdasdasdasdasd"
            .IsExpanded = True
            .IsSelected = True

        End With
        list1.Add(z)

    End Using
Next
For Each z In list1
    MessageBox.Show(z.ToString)
Next 
```

test1 的结果是立即调用 GC 并且我失去了对资源的访问权限，我收到 null 消息。

测试2：

```
Dim list1 As New List(Of HODLib.Classes.GenreClass)
For i = 0 To 4

    Dim z As New HODLib.Classes.GenreClass
    With z
        .Genre = "asdasd"
        .Icon = "asdasdasdasdasd"
        .IsExpanded = True
        .IsSelected = True

    End With
    list1.Add(z)

Next
For Each z In list1
    MessageBox.Show(z.ToString)
Next 
```

结果是从未调用过 Dispose，即使对于 forloop 中的 z，我也不明白，为什么 z 没有被释放，是因为列表引用了它的值而等待吗？

测试3：

```
 Dim list1 As New List(Of HODLib.Classes.GenreClass)
        For i = 0 To 4

            Dim z As New HODLib.Classes.GenreClass
            With z
                .Genre = "asdasd"
                .Icon = "asdasdasdasdasd"
                .IsExpanded = True
                .IsSelected = True

            End With
            list1.Add(z)
            z.Dispose()

        Next
        For Each z In list1
            MessageBox.Show(z.ToString)
        Next 
```

结果：Test2 vs test3 在添加到列表后手动调用 dispose。结果是我失去了对资源的访问权限，我收到了空消息。为什么会发生这种情况，尽管我在调用 dispose 方法之前将对象添加到列表中。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:33:49.117

不幸的是，Visual Basic IDE 自动生成的 Dispose 实现在 99.9% 的情况下都是错误的。仅当您的类具有 Finalize() 方法或基类具有受保护的 Dispose(Boolean) 方法时，才应使用它。这是极其罕见的，终结器是由 .NET Framework 类实现的。他们的工作是包装应该提前释放的非托管资源。

当您发现无法在 Dispose() 方法中编写任何有意义的代码时，它就会 100% 出错。像这种情况下，您的类没有一次性类型的字段。将字段设置为 Nothing 无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:06:56.203

您正在添加对您创建的实例 z 的引用。当该实例被销毁时，引用不再指向任何东西。该`Using`构造会自动为您调用 Dispose。您可以通过向类添加方法来制作对象 z 的新副本：

```
Public Function Clone() As GenreClass
    Return DirectCast(Me.MemberwiseClone(), GenreClass)
End Function 
```

并使用`list1.Add(z.Clone)`.

有关详细信息以及是否需要创建深层副本，请参阅[Object.MemberwiseClone 方法。](http://msdn.microsoft.com/en-us/library/57ctke0a%28v=vs.100%29.aspx)

# java - Java 动态选项卡

> ID：12238298
> 
> 赞同：0
> 
> 时间：2012-09-02T17:44:42.057
> 
> 标签：java, jtree, jtabbedpane

我正在使用 JTabbedpane 创建一个应用程序，并创建了一个通过单击按钮添加选项卡的功能。选项卡包含 JTree。添加选项卡后，我希望能够将节点添加到选项卡中的树中。

现在，由于选项卡和树是以编程方式创建的，我如何访问特定选项卡中的特定 JTree 以便向其中添加节点？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:00:54.823

您应该拥有扩展选项卡的类，而不是直接使用具体的选项卡，并拥有从中添加/获取树的方法。因此，您创建选项卡的实例，创建树，然后将其添加到选项卡。如果您不知道将创建多少个选项卡，请将它们保存在一个列表中。

# c++ - QTreeWidget：类似 Windows 资源管理器的编辑

> ID：12238299
> 
> 赞同：2
> 
> 时间：2012-09-02T17:44:42.940
> 
> 标签：c++, python, qt4, pyqt4

我想创建一个`QTreeWidget`项目既可编辑又可启动的地方。我希望它表现得像 Windows 资源管理器：

单击 -> 选择

单击先前选择的项目 -> 打开 LineEdit 以编辑名称

双击 -> 执行“启动”

所以我为`itemClicked()`和创建了插槽`itemDoubleClicked()`。第一个如下：

```
def EditName(self, item, column):
    if self.lastclick == item:
        self.editItem(item)
    self.lastclick = item 
```

第二个只是“启动”文件。

但是这种方案不区分双击和连续两次，所以`QLineEdit`双击后还是会出现 。是否可以强行摆脱编辑器？我尝试了一种黑客解决方案，例如隐藏和显示该项目，但它没有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T17:49:17.200

您只需在 QTreeWidgetItem 上设置标志以包含 ItemIsEditable 选项，并在 QTreeWidget 上为 SelectedClick 设置编辑触发器

```
def populate( self, tree ):
    tree.setEditTriggers(tree.SelectedClicked)
    for i in range(10):
        item = QTreeWidgetItem(['Testing %02i' % i])
        item.setFlags(item.flags() | item.ItemIsEditable) 
```

# iphone - 使用 CCScrollView 进行垂直滚动

> ID：12238303
> 
> 赞同：0
> 
> 时间：2012-09-02T17:44:50.387
> 
> 标签：iphone, cocos2d-iphone

有什么办法可以使用 CCScrollView 进行垂直滚动..？我正在尝试使用它，但我无法让它在垂直方向滚动。

请帮助我提供一些关于如何使用 CCScrollView 进行垂直滚动的想法或教程..？或者任何其他可以在 Cocos2d 中实现垂直滚动的方式..？

谢谢你的时间..！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T06:31:26.800

我找到了解决方法.. 谢谢@Superman：我研究了将 UIKit 与 Cocos2d 混合，我发现了 [THIS](http://goaheadwithiphonetech.blogspot.in/2012/01/implement-uitableview-in-cocos2d.html "这")，它帮助了我。！！

我希望它可以帮助任何寻找相同的人:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-05T06:55:55.603

```
CCScrollView *scrollView=CCScrollView::create(CCSizeMake(screenSize.width,screenSize.height));
scrollView->setContentSize(CCSizeMake(screenSize.width,screenSize.height-header->getContentSize().height));
scrollView->setPosition(ccp(0,0));
scrollView->setDirection(kCCScrollViewDirectionVertical);
this->addChild(scrollView,0); 
```

# vim - Vim 语法高亮和某些字符

> ID：12238305
> 
> 赞同：2
> 
> 时间：2012-09-02T17:45:08.490
> 
> 标签：vim

我正在尝试为 Vim 编写语法文件。

其中一行代码读取

```
syn match constant "\**\*" 
```

而许多其他行之一读取

```
syn keyword aiOperators up-build 
```

高亮代码如下：

```
hi constant gui=bold
hi aiOperators guifg=green 
```

但是，上面的结果是只突出显示了以下内容：

*   每个**常数的星号**的星号，但不是它们之间的字符。
*   **直到aiOperators**的第一个连字符为止的字符。

似乎是什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T18:38:23.740

常量的正则表达式指定一个文字星号，零次或多次，后跟一个文字星号。如果您打算匹配由星号分隔的字符，您需要类似`\*\w\+\*`：一个文字星号，后跟一个或多个单词字符，然后是一个文字星号。

`:syn keyword`唯一适用于关键字字符；默认情况下，连字符*不*包括在内，因此匹配停止。如果对于您的文件类型，连字符属于关键字字符集，请使用

```
:setlocal iskeyword+=- 
```

这不应该放在语法文件本身中，而应该放在`~/.vim/ftplugin/myfiletype.vim`. 否则，使用`:syn match`.

# python - 在 Python 中声明编码

> ID：12238307
> 
> 赞同：13
> 
> 时间：2012-09-02T17:45:31.343
> 
> 标签：python, string

我想使用以下代码在 python 中拆分一个字符串：

```
means="a ، b ، c"
lst=means.split("،") 
```

但我收到此错误消息：

> SyntaxError：第 2 行文件 dict.py 中的非 ASCII 字符“\xd8”，但未声明编码；有关详细信息，请参见[http://www.python.org/peps/pep-0263.html](http://www.python.org/peps/pep-0263.html)

如何声明编码？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-09-03T01:32:12.573

放：

```
# -*- coding: UTF-8 -*- 
```

作为文件的第一行（如果使用 *nix，则为第二行）并将文件保存为 UTF-8。

如果您使用的是 Python 2，请使用 Unicode 字符串文字 ( `u"..."`)，例如：

```
means = u"a ، b ، c"
lst = means.split(u"،") 
```

如果您使用的是 Python 3，则字符串文字已经是 Unicode（除非标记为 bytestrings `b"..."`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-02T17:47:16.533

您需要为您的文件声明一个编码，如此处和[此处所记录](http://www.python.org/dev/peps/pep-0263/)[的](http://docs.python.org/release/2.5.1/ref/encodings.html)。

# oop - 每个层次结构的工厂方法

> ID：12238310
> 
> 赞同：1
> 
> 时间：2012-09-02T17:45:34.177
> 
> 标签：oop, design-patterns

我正在开发一个具有许多不直接相关的继承层次结构的应用程序。

我是否必须为客户端代码中的每个层次结构分配一个工厂方法以从每个层次结构中选择某个类以通过 GUI 对用户选择进行实例化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T17:52:04.987

相反，如果是一个具体的工厂，你可以看看抽象工厂

> 抽象工厂提供了用于创建一系列相关对象的接口，而无需明确指定它们的类。

[参考](http://www.oodesign.com/abstract-factory-pattern.html)

如果对象不相关，我认为您无法避免为每个对象创建一个工厂。看看依赖注入架构，它可能是一个有趣的选择[依赖注入与工厂模式](https://stackoverflow.com/questions/557742/dependency-injection-vs-factory-pattern)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:18:52.423

看看这个网页，它演示了使用具有多重继承层次结构的抽象工厂模式：http: [//www.dofactory.com/Patterns/PatternAbstract.aspx](http://www.dofactory.com/Patterns/PatternAbstract.aspx)。

# google-app-engine - 实例 Key 或 ID 的 NDB 投影

> ID：12238317
> 
> 赞同：5
> 
> 时间：2012-09-02T17:46:34.567
> 
> 标签：google-app-engine, python-2.7, google-cloud-datastore

我在 GoogleAppEngine 上使用 NDB，我想通过将电子邮件传递到查询中来检索实例密钥或 ID。

我的模型看起来像这样：

```
class Users(ndb.Model):
    user_name = ndb.StringProperty(required=True)
    user_email = ndb.StringProperty(required=True)
    user_password = ndb.StringProperty(required=True)

    @classmethod
    def get_password_by_email(cls, email):
        return Users.query(Users.user_email == email).get(projection=[Users.key, Users.user_password]) 
```

运行代码时，我收到以下错误：

```
BadProjectionError: Projecting on unknown property __key__ 
```

如何通过 AppEngine 的 NDB 中的电子邮件（例如登录过程）查询用户来获取实例 ID 或密钥？

谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-02T18:50:39.300

投影查询将始终包含键以及您指定的字段，因此如果 keys_only 不够，则：

```
return Users.query(Users.user_email == email).get(projection=[Users.password]) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-02T18:45:08.890

如果您只需要密钥，您可以尝试仅密钥查询：

```
Users.query(Users.user_email == email).get(keys_only=True) 
```

# ios - 来自线程的 NSURLConnection 同步请求与异步请求

> ID：12238319
> 
> 赞同：5
> 
> 时间：2012-09-02T17:46:45.043
> 
> 标签：ios, multithreading, ipad, asynchronous, nsurlconnection

添加一个在 NSOperationQueue 中发出同步 NSURLConnection 请求的操作（或来自线程（不是主线程）的同步请求）和从主线程发出异步请求有什么区别？

两者都不会阻塞主线程，因此 UI 将保持响应，但使用其中一个有什么优势吗？我知道在后面的方法中我可以跟踪请求进度等，但假设进度和其他 HTTP 内容在这里并不重要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T22:28:08.707

They are very similar. The biggest problem with synchronous requests is that they can't easily be cancelled. Depending on your application, that could be a problem. Imagine you are downloading a big document and the user moves to another screen so you no longer need that information. In our case, I actually chose doing asynchronous NSURLConnections on a secondary NSThread, which may be overkill for some apps. It is more complicated, but it gives us the ability to both cancel requests and to decode the JSON/XML/image data on secondary threads so they don't impact main thread user interactivity.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T18:44:16.733

历史上的立场是，异步请求在功耗和电池寿命方面具有优势——大概包括旧的委托方法和新的基于块的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T22:47:41.833

异步请求在运行循环上调度并设置为运行循环源，仅当从网络接收到数据（作为任何套接字源）时才会自动触发代码。

在一个线程上运行的同步请求`NSThread`会独占一个线程来监视传入的数据，这通常是非常过分的。

`NSURLConnection`即使它已经异步执行，您也可以使用该`cancel`方法取消它。

`NSOperationQueue`我敢打赌，使用允许在( )上发送异步请求的新 API`+sendAsynchronousRequest:queue:completionHandler:`使用 GCD 和`dispatch_source_create`，或类似的东西，因此它的行为与在运行循环上调度时的行为相同`NSURLConnection`，避免使用额外的线程（观看 WWDC'12 视频，其中解释了为什么线程是邪恶的并且应该尽量减少它们的使用），不同之处仅在于允许您使用在完成时通知块而不是使用委托机制。

几年前，我创建了一个类，将`NSURLConnection`异步调用和委托管理嵌入到一个不错的块 API 中（请参阅我的 github 上的[OHURLLoader](https://github.com/AliSoftware/OHURLLoader)），这使得它更易于使用（请随意查看）。我敢打赌，使用 s 的新 API 使用`NSOperationQueue`相同的原理，仍然在 runloop 上执行异步请求，但允许您使用块而不是必须实现委托。

# asp.net-mvc - Html.HiddenFor 和 HiddenInput 属性之间的区别

> ID：12238322
> 
> 赞同：8
> 
> 时间：2012-09-02T17:47:02.147
> 
> 标签：asp.net-mvc, data-annotations, html.hiddenfor

**HiddenFor**描述是：为由指定表达式表示的对象中的每个属性返回一个 HTML 隐藏输入元素。

我读到它对于模型/视图模型中的字段很有用，您需要在页面上保留并在进行另一次调用但用户不应该看到时传回。

**HiddenInput**描述是：表示一个属性，用于指示是否应将属性或字段值呈现为隐藏输入元素。

你能告诉我 HiddenInput 什么时候有用吗？以及何时使用它而不是 Html.HiddenFor？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-02T17:51:41.360

`HiddenFor`由视图决定——视图从视图模型或数据的任何元素创建一个隐藏的输入值。

`HiddenInput`是（视图）模型中字段的属性 - 这意味着它可以跨多个视图使用，并指示该字段应隐藏在`EditorFor`助手渲染的任何位置

# makefile - 停止 GNU make 打印特定行

> ID：12238323
> 
> 赞同：0
> 
> 时间：2012-09-02T17:47:02.700
> 
> 标签：makefile

默认情况下，GNU make 会在 shell 发出这些命令之前打印任何包含 shell 命令的行。

如果我不希望 GNU make 打印其中一些行，我该怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T17:49:09.907

`@`在您不想打印的行前使用：

```
test:
    echo twice
    @echo just once 
```

（使用`-s`开关抑制所有输出。）

# javascript - 函数并不总是返回值？

> ID：12238325
> 
> 赞同：0
> 
> 时间：2012-09-02T17:47:21.367
> 
> 标签：javascript, jquery

我试图使这个 ajax 请求函数工作，但 netbeans 发出警告，以下函数并不总是返回值。任何人都可以请帮忙。

```
function fpform(){
    var response='';
    var fpemail = $('#frgtpwd').val();
    //var fpemail = document.getElementById('frgtpwd').value;

    if (fpemail == ""){
        $('span#fperror').text("insert your emal address");
        //document.getElementById('fperror').innerHTML = "Insert your email address";
        return false;
    } else {
        var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        if (filter.test(fpemail)==false) { 
            $('span#fperror').text("Email address is not in valid format");
            //document.getElementById('fperror').innerHTML = "Email address is not in valid format";
            return false;
        } else {
            $("#loader").html('<img src="images/ajax-loader.gif" />');
            $.post("forgot_password_process.php", {
                email:fpemail
            }, function(response){
                response = response.trim();
            }).success(function () {
                if (response == 'yes'){
                    $("#fperror").html('<font color="green"><b>Your password has been reset now and emailed to you </b></font>');
                    $("#loader").hide('<img src="images/ajax-loader.gif" />');
                    return true;
                } else {
                    alert("your email address was not found");
                    $("#loader").hide('<img src="images/ajax-loader.gif" />');
                    $("#fperror").html('<font color="black"><b> Email address was not found in database!</b></font>');
                    return false;
                } 
            });
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T17:50:11.450

您的代码中的`return true;`语句不是从`fpform`. 相反，它从给定的回调函数返回`.success()`。到执行此函数时，外部函数 ,`fpform`早已返回。使用 ajax 从函数“返回”的唯一方法是使用回调。

* * *

在我给你任何代码之前，你已经犯了很多其他错误：

1.  您的电子邮件正则表达式 ,`/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/`在我的电子邮件地址上失败。`+`也是一个有效的字符。考虑[不使用 regex 验证电子邮件地址](https://stackoverflow.com/q/201323/102441)。

2.  `$("#loader").hide('<img src="images/ajax-loader.gif" />')`不起作用。完全没有。你要`$("#loader").empty()`

3.  您在顶部声明的变量`response`被您`response`在其中一个匿名函数中的参数所遮蔽，因此`response = response.trim()`没有任何效果。

* * *

```
function fpform(callback) {
    var fpemail = $('#frgtpwd').val();

    if (fpemail == ""){
        $('span#fperror').text("insert your email address");
        callback(false);
    } else {
        var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        if (filter.test(fpemail)==false) { 
            $('span#fperror').text("Email address is not in valid format");
            callback(false);
        } else {
            $("#loader").html('<img src="images/ajax-loader.gif" />');
            $.post("forgot_password_process.php", {
                email:fpemail
            }).success(function(response) {
                response = response.trim();
                if (response == 'yes'){
                    $("#fperror").html('<font color="green"><b>Your password has been reset now and emailed to you </b></font>');
                    $("#loader").hide('<img src="images/ajax-loader.gif" />');
                    callback(true);
                } else {
                    alert("your email address was not found");
                    $("#loader").hide('<img src="images/ajax-loader.gif" />');
                    $("#fperror").html('<font color="black"><b> Email address was not found in database!</b></font>');
                    callback(false);
                } 
            }).error(function() { callback(false); });
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T17:52:39.380

您应该在之后返回值`$.post(...).success(...);`

# sql - 用于删除数据库中的 WordPress 附件的正则表达式

> ID：12238326
> 
> 赞同：0
> 
> 时间：2012-09-02T17:47:25.103
> 
> 标签：sql, regex, wordpress, attachment

我不得不移动我的 WordPress 网站并对媒体进行一些内部清理，然后运行一个插件将清理过的媒体重新插入数据库。然而，它这样做的方法是查看目录，所以现在不仅仅是文件：xyz.jpg，我有 xyz-150x150、xyz-200x200 等。我想在我的 sql 上运行一个正则表达式来删除所有具有 _wp_attached_file 的附件，然后它们遵循以下命名方案“名称-”“大小”。例如：

```
INSERT INTO `wp_postmeta` VALUES(2379, 2152, '_wp_attached_file', '2010/09/Oneonta-Gorge-leaves-150x150.jpg'); 
```

这整行将被删除，但看起来像这样的行将保留：

```
INSERT INTO `wp_postmeta` VALUES(2379, 2152, '_wp_attached_file', '2010/09/Oneonta-Gorge-leaves.jpg'); 
```

此外，如果您认为删除 -200x200 会更容易，然后运行另一个脚本来删除重复的行，那也可以。我拥有的不同维度是：

*   150x150
*   200x200
*   200x300
*   300x189

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:27:30.217

这是你可以尝试的东西。第一个查询将选择所有带有维度后缀的图像。这只是为了检查查询以确保您选择了所需的图像。

```
select * from wp_postmeta where meta_key = '_wp_attached_file' and meta_value regexp  '.+-[0-9]{3}x[0-9]{3}\.(jpg|gif|png)$' 
```

如果您对结果满意，可以运行删除查询：

```
delete from wp_postmeta where meta_key = '_wp_attached_file' and meta_value regexp  '.+-[0-9]{3}x[0-9]{3}\.(jpg|gif|png)$' 
```

或者，您可以使用`LIKE`. 您必须为每个维度运行它。此查询还假定三个字符的扩展名，例如 gif、jpg 或 png。

```
select * FROM wp_postmeta WHERE meta_key = '_wp_attached_file' and meta_value LIKE '%-150x150.___' 
```

# html - 在 HTML 中设置登录名和密码输入

> ID：12238328
> 
> 赞同：0
> 
> 时间：2012-09-02T17:47:28.513
> 
> 标签：html, login, login-control

在 HTML 中设置登录名和密码输入框的正确方法是什么？

我问的原因是因为我用来管理所有密码（1Password）的程序没有发现我刚刚输入了它应该尝试保存的凭据。这让我觉得我设置的表格错误。

`click()`在提交按钮上的事件之后，凭据正在通过 SSL 连接通过 Ajax 发送。它们作为 JSON 对象存储在帖子正文中。不确定他们需要在标题中还是什么？

到目前为止，这是我在页面上的内容：

```
Username: <input id='username_input' type='text'><br>
Password: <input id='password_input' type='password'><br>
<input id='login-button' type='submit' value='login'> 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T18:09:21.703

您的输入没有任何名称，因此在提交表单时不会将任何数据发送到服务器。尝试：

```
Username: <input id='username_input' name='username' type='text'><br>
Password: <input id='password_input' name='password' type='password'><br>
<input id='login-button' type='submit' value='login'> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T17:49:05.300

确保对属性使用双引号：

```
Username: <input id="username_input" type="text" /><br />
Password: <input id="password_input" type="password" /><br />
<input id="login-button" type="submit" value="login" /> 
```

此外，将字段包装在表单元素中可能会起作用。

# javascript - node.js：获取浏览器语言

> ID：12238329
> 
> 赞同：2
> 
> 时间：2012-09-02T17:47:37.240
> 
> 标签：javascript, node.js, internationalization

有没有办法让浏览器语言或类似的东西知道客户端使用哪种语言？

我说的是node.js =)

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T17:49:29.620

与任何其他 HTTP 服务器一样，这里的关键是浏览器随每个请求发送的[`Accept-Language`标头。](http://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Requests)请参阅[HTTP 1.1 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.4)和[用于区域设置](http://www.w3.org/International/questions/qa-accept-lang-locales.en.php)W3C 常见问题页面的接受语言。

读取 HTTP 值的实际代码取决于您使用的框架（“vanilla”Node、Express 等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-16T15:25:26.347

如果您碰巧使用著名的快速服务器，那么存在可以完成这项工作的中间件。[request-language](https://github.com/tinganho/express-request-language)解析`Accept-Language`标头并为您返回最喜欢的语言：

```
var requestLanguage = require('express-request-language');
var cookieParser = require('cookie-parser');
var express = require('express');
var app = express();

app.use(cookieParser());
app.use(requestLanguage({
  languages: ['en-US', 'zh-CN'],
  cookie: {
    name: 'language',
    options: { maxAge: 24*3600*1000 },
    url: '/languages/{language}'
  }
}));

app.get('/', function(req, res, next) {
  console.log(req.language); // 'en-US'
}); 
```

# jquery - 居中 DIV 并在同一动画中放大它？

> ID：12238364
> 
> 赞同：3
> 
> 时间：2012-09-02T17:51:30.023
> 
> 标签：jquery

我`position: absolute`在文档上有一个 DIV。我希望它（无论它在文档上的哪个位置）在增长到一定大小的同时到达中心（所有内容都在动画中）我尝试使用 jQuery 的动画：

```
$('#el').animate({
        width: 600,
        height: 600,
        top: "-20%",
        left: "-50%"
    },1200); 
```

有很多变化，但我就是无法确定数学应该如何发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:11:51.080

您需要根据当前窗口的宽度和高度计算顶部和左侧，根据需要减去目标DIV的和高度并将结果除以2以获得中心点。

例如，要计算当前窗口宽度 = 1200 像素且 DVI 目标宽度为 600 像素的左侧位置，您可以执行以下操作： (WindowWidth - DivTargetWidth) / 2 = leftPosition; (1200 - 600) / 2 = 300;

这同样适用于从相关高度值计算顶部位置。

以下应该有效：

```
var targetWidth = 600;
var targetHeight = 600;
var targetTopPosition = ($(window).height() - targetHeight) / 2;
var targetLeftPosition = ($(window).width() - targetWidth) / 2;

console.log(targetTopPosition);

$('#el').animate({
    width: targetWidth,
    height: targetHeight,
    top: targetTopPosition,
    left: targetLeftPosition
}, 1200);​ 
```

### [演示](http://jsfiddle.net/Akc4n/)- 居中和放大 DIV

这里是上面demo[**的全屏版的链接。**](http://jsfiddle.net/Akc4n/embedded/result/)

# android - android 在屏幕上显示对话框时控制后退按钮

> ID：12238370
> 
> 赞同：0
> 
> 时间：2012-09-02T17:52:05.333
> 
> 标签：android, dialog, back

我有一个持续运行的计时器。当我按下 BACK 按钮时，我会出现一个对话框，您可以在其中退出该意图或返回并继续计时器已被 BACK 按钮停止的内容。好吧，如果我单击继续， onResume() 方法会使计时器继续并且工作良好。但是，如果我在屏幕上显示对话框时按下后退按钮，我希望计时器继续运行，就像我在对话框上按下 Continue 一样。但是，相反，我按下后退按钮并没有任何反应，计时器停止了，这对我不利，因为我的一些方法仅在计时器正在运行或被对话框停止时才有效。但是，如果没有对话并且计时器停止，则可能会发生许多潜在的错误。那么当对话框在屏幕上时，如何阻止用户按下后退按钮？我试过这样的事情：

```
if ((keycode==back) && a=0 ) {... a=1 , onPuase()}  // dialog comes in onPause() just happened
else ((keycode==back) && a=1 ) {... a=0, onResume()}  //I want onResume() to happen here 
```

但这并不好。该对话框出现在第一个 Back 按钮上，然后在第二个 Back 按钮上消失（这里没有任何反应）。计时器仍然在这里停止，但是第三个后退按钮启动计时器。所以有一个不必要的返回可能会导致麻烦，因为用户不会知道他们必须再次按下它......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:56:43.843

如果您想在显示对话框时用户按下 BACK 时收到通知，请使用[OnDismissListener](http://developer.android.com/reference/android/content/DialogInterface.OnDismissListener.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:00:39.220

一些建议：

1.  不要手动调用 onResume/onPause，只有系统才能调用。否则，您将在各种设备上遇到无法解释的问题。
2.  您真的想使用 OnDismissListener ( [http://developer.android.com/reference/android/content/DialogInterface.OnDismissListener.html](http://developer.android.com/reference/android/content/DialogInterface.OnDismissListener.html) )。从 ICS 开始，对话框不仅可以通过按 Back 键来关闭，还可以通过在对话框外点击屏幕上的某个位置来关闭。
3.  如果你想防止通过“返回”和“敲出对话框”来关闭对话框 - 使用 setCancellable(false) [http://developer.android.com/reference/android/app/Dialog.html#setCancelable(boolean](http://developer.android.com/reference/android/app/Dialog.html#setCancelable(boolean) )对话框。

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-10T12:13:04.837

在您的 DialogClass 中实现 OnDismissListener

并覆盖 OnDismiss 方法

```
 @Override
public void onDismiss(DialogInterface dialog) {
    super.onDismiss(dialog);
    //you can control back button from here 
} 
```

# django - TemplateSyntaxError：渲染时捕获 ImportError：无法导入名称 utils

> ID：12238371
> 
> 赞同：1
> 
> 时间：2012-09-02T17:52:19.037
> 
> 标签：django, apache, postgresql, centos, wsgi

我无法让这个 django 应用程序在我的 CentOS 6/Apache/2.2.15 上运行。当我运行该应用程序时，我收到此错误：

```
 Traceback (most recent call last):
   File "/usr/local/lib/python2.7/site-packages/django/core/handlers/wsgi.py", line 272, in __call__
     response = self.get_response(request)
   File "/usr/local/lib/python2.7/site-packages/django/core/handlers/base.py", line 169, in get_response
     response = self.handle_uncaught_exception(request, resolver, sys.exc_info())
   File "/usr/local/lib/python2.7/site-packages/django/core/handlers/base.py", line 203, in handle_uncaught_exception
     return debug.technical_500_response(request, *exc_info)
   File "/usr/local/lib/python2.7/site-packages/django/views/debug.py", line 59, in technical_500_response
     html = reporter.get_traceback_html()
   File "/usr/local/lib/python2.7/site-packages/django/views/debug.py", line 151, in get_traceback_html
     return t.render(c)
   File "/usr/local/lib/python2.7/site-packages/django/template/base.py", line 123, in render
     return self._render(context)
   File "/usr/local/lib/python2.7/site-packages/django/template/base.py", line 117, in _render
     return self.nodelist.render(context)
   File "/usr/local/lib/python2.7/site-packages/django/template/base.py", line 744, in render
     bits.append(self.render_node(node, context))
   File "/usr/local/lib/python2.7/site-packages/django/template/debug.py", line 73, in render_node
     result = node.render(context)
   File "/usr/local/lib/python2.7/site-packages/django/template/debug.py", line 90, in render
     output = self.filter_expression.resolve(context)
   File "/usr/local/lib/python2.7/site-packages/django/template/base.py", line 536, in resolve
     new_obj = func(obj, *arg_vals)
   File "/usr/local/lib/python2.7/site-packages/django/template/defaultfilters.py", line 695, in date
     return format(value, arg)
   File "/usr/local/lib/python2.7/site-packages/django/utils/dateformat.py", line 285, in format
     return df.format(format_string)
   File "/usr/local/lib/python2.7/site-packages/django/utils/dateformat.py", line 30, in format
     pieces.append(force_unicode(getattr(self, piece)()))
   File "/usr/local/lib/python2.7/site-packages/django/utils/dateformat.py", line 191, in r
     return self.format('D, j M Y H:i:s O')
   File "/usr/local/lib/python2.7/site-packages/django/utils/dateformat.py", line 30, in format
     pieces.append(force_unicode(getattr(self, piece)()))
   File "/usr/local/lib/python2.7/site-packages/django/utils/encoding.py", line 71, in force_unicode
     s = unicode(s)
   File "/usr/local/lib/python2.7/site-packages/django/utils/functional.py", line 206, in __unicode_cast
     return self.__func(*self.__args, **self.__kw)
   File "/usr/local/lib/python2.7/site-packages/django/utils/translation/__init__.py", line 81, in ugettext
     return _trans.ugettext(message)
   File "/usr/local/lib/python2.7/site-packages/django/utils/translation/trans_real.py", line 286, in ugettext
     return do_translate(message, 'ugettext')
   File "/usr/local/lib/python2.7/site-packages/django/utils/translation/trans_real.py", line 276, in do_translate
     _default = translation(settings.LANGUAGE_CODE)
   File "/usr/local/lib/python2.7/site-packages/django/utils/translation/trans_real.py", line 185, in translation
     default_translation = _fetch(settings.LANGUAGE_CODE)
   File "/usr/local/lib/python2.7/site-packages/django/utils/translation/trans_real.py", line 162, in _fetch
     app = import_module(appname)
   File "/usr/local/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
     __import__(name)
   File "/usr/local/lib/python2.7/site-packages/django/contrib/admin/__init__.py", line 3, in <module>
     from django.contrib.admin.helpers import ACTION_CHECKBOX_NAME
   File "/usr/local/lib/python2.7/site-packages/django/contrib/admin/helpers.py", line 3, in <module>
     from django.contrib.admin.util import (flatten_fieldsets, lookup_field,
   File "/usr/local/lib/python2.7/site-packages/django/contrib/admin/util.py", line 1, in <module>
     from django.db import models
   File "/usr/local/lib/python2.7/site-packages/django/db/__init__.py", line 78, in <module>
     connection = connections[DEFAULT_DB_ALIAS]
   File "/usr/local/lib/python2.7/site-packages/django/db/utils.py", line 93, in __getitem__
     backend = load_backend(db['ENGINE'])
   File "/usr/local/lib/python2.7/site-packages/django/db/utils.py", line 33, in load_backend
     return import_module('.base', backend_name)
   File "/usr/local/lib/python2.7/site-packages/django/utils/importlib.py", line 35, in import_module
     __import__(name)
   File "/usr/local/lib/python2.7/site-packages/django/db/backends/postgresql_psycopg2/base.py", line 9, in <module>
     from django.db import utils
 TemplateSyntaxError: Caught ImportError while rendering: cannot import name utils 
```

搜索此错误我找到了一些解决方案，尝试了所有但没有奏效：

1.  使 WSGI 在守护进程模式下运行。
2.  检查 Django 安装路径是否在 Python 路径中。
3.  我认为这可能是因为另一个应用程序在同一个 Apache VirtualHost 上运行，所以我放入了另一个 VH（另一个端口）但没有工作。
4.  我有 2 个数据库连接：这个应用程序上的 Oracle 和 PostgreSQL，Oracle 很好，也许问题是 postgresql_psycopg2。我已经安装了 yum。

这是我的文件：

vhost.conf：

```
 NameVirtualHost 10.7.0.17:80
    NameVirtualHost 10.7.0.17:8080

    <VirtualHost 10.7.0.17:80>
        ServerAdmin webmaster@www.domain.com
        ServerName www.domain.com
        ServerAlias www.domain.com
        DocumentRoot /var/www/www.domain.com/html/
        ErrorLog /var/www/www.domain.com/logs/error.log
        CustomLog /var/www/www.domain.com/logs/access.log combined

        WSGIDaemonProcess www.domain.com processes=2 threads=15 display-name=%{GROUP}
        WSGIProcessGroup www.domain.com

        Alias /vlv/media/ /var/www/www.domain.com/django/vlv_vistoria/media/

        WSGIScriptAlias /vlv /var/www/www.domain.com/django/vlv_vistoria/django.wsgi

        <Directory /var/www/www.domain.com/django/vlv_vistoria>
            Order allow,deny
            Allow from all
            Options Indexes FollowSymLinks
        </Directory>

        <Directory /var/www/www.domain.com/django/vlv_vistoria/media>
            Order allow,deny
            Allow from all
            Options Indexes FollowSymLinks
        </Directory>

    </VirtualHost>

    <VirtualHost 10.7.0.17:8080>
        ServerAdmin webmaster@www.domain.com
        ServerName www.domain.com
        ServerAlias www.domain.com
        DocumentRoot /var/www/www.domain.com/html/
        ErrorLog /var/www/www.domain.com/logs/sistema_error.log
        CustomLog /var/www/www.domain.com/logs/sistema_access.log combined

        WSGIDaemonProcess sistema.www.domain.com processes=2 threads=15 display-name=%{GROUP}
        WSGIProcessGroup sistema.www.domain.com

        Alias /sistema/media/ /var/www/www.domain.com/django/sistema/media/

        WSGIScriptAlias /sistema /var/www/www.domain.com/django/sistema/django.wsgi

        <Directory /var/www/www.domain.com/django/sistema>
            Order allow,deny
            Allow from all
            Options Indexes FollowSymLinks
        </Directory>

        <Directory /var/www/www.domain.com/django/sistema/media>
            Order allow,deny
            Allow from all
            Options Indexes FollowSymLinks
        </Directory>

    </VirtualHost> 
```

django.wsgi

```
 import os, sys

    sys.path.append('/var/www/www.domain.com/django')
    sys.path.append('/var/www/www.domain.com/django/sistema')

    sys.path.append('/usr/local/lib/python2.7/site-packages/django')

    root = os.path.join(os.path.dirname(__file__), '..')
    sys.path.insert(0, root)

    os.path.dirname(__file__)
    sys.path.insert(0, root)

    os.environ['DJANGO_SETTINGS_MODULE'] = 'settings'

    os.environ["ORACLE_HOME"] = "/ora00/app/oracle/product/client"

    import django.core.handlers.wsgi
    application = django.core.handlers.wsgi.WSGIHandler() 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T23:49:07.883

One of the causes for this in the past has been module import path issues.

Specifically, using a mod_wsgi installation compiled against one version of Python, and then using WSGIPythonPath or other means of setting the Python path to refer to a Python virtual environment constructed using a different Python version.

So, validate what version of Python mod_wsgi was compiled and installed for. If that is not Python 2.7, but an older Python version, you can get this specific problem.

For how to check what mod_wsgi was compiled for use:

[http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Python_Shared_Library](http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Python_Shared_Library)

[http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Python_Installation_In_Use](http://code.google.com/p/modwsgi/wiki/CheckingYourInstallation#Python_Installation_In_Use)

It may also be worthwhile checking patch level revision differences of Python as well when looking at what mod_wsgi was compiled for. I do recollect that there was an issue a one point like this between Python 2.7.1 and 2.7.2 on there about.

That your Python site-packages is under /usr/local then quite possible that mod_wsgi using a different version under /usr.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-15T11:52:43.480

如果有人在 Pyramid 和 sqlalchemy 上搜索此问题时偶然发现：

与 Pyramid 一起使用时，我遇到了同样的错误（“ImportError: cannot import name util”）。经过数小时的反复试验，唯一的原因是我在 production.ini 中设置了：

```
[server:main]
use = egg:waitress#main
host = 0.0.0.0
port = 80 
```

我还在端口 80 上使用 Apache2，这似乎很奇怪，这应该是相同的。将端口更改为例如 6543 后，错误消失并且 WSGI 服务器正常工作。没有必要的 apache2 设置（WSGIPythonHome、WSGIPythonPath）。

显然不相关，我不知道为什么端口冲突会导致此错误，但它可能会帮助其他人解决此问题。

# ios - 地图上显示错误的注记视图

> ID：12238373
> 
> 赞同：0
> 
> 时间：2012-09-02T17:52:39.497
> 
> 标签：ios, mkannotation, mkannotationview, mkmapviewdelegate

我正在插入一种新的注释，与以前的注释不同，它们的行为很疯狂。当显示一个区域的地图时，代表会被传递属于一个遥远区域的注释，报告他们自己的特征。然而，它们恰好出现在正确注释应该出现的位置！90% 的情况都会发生这种情况，其余的是正确的注释，并且显示的注释始终属于可用注释的严格子集。

产生这种奇怪的行为可能是什么以及如何解决它？

问题是我到处都使用了一个静态标识符。一旦我使用了一个带有依赖于注释的标识符的字符串，一切都得到了整理。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-30T15:09:00.083

事实上，我不得不为每个注释使用一个标识符：太糟糕了，它们很多，但它们带来了不同的信息，所以我不能让它们都一样。

# php - 我如何防止 php 在 php 语句中尝试解释 now()

> ID：12238374
> 
> 赞同：0
> 
> 时间：2012-09-02T17:52:43.797
> 
> 标签：php, mysql

我一直在杀死我的页面，并在查询中显示错误“Call to undefined function now()”，该查询已从下面的实际内容中缩短

```
$RToDB = mysql_query("INSERT INTO LIP(id,updated,detected) 
        VALUES(
        '".$_COOKIE["ID"]."',
        now(),
        now()
        )"); 
```

无论如何，有什么我没有看到我做错了吗？我如何提交 now() 作为查询的一部分，而不需要 php 尝试解释它？

编辑：错误实际上来自用 now(); 定义一个变量；我的错

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T17:58:00.020

`NOW()`是大写的

```
INSERT INTO LIP(id,updated,detected) 
    VALUES(
    '".(int)$_COOKIE["ID"]."',
    NOW(),
    NOW() 
```

请记住，这`$_COOKIE`是基于客户端的，因此他们可以更改它，尽量不要依赖它，至少`(int)`要避免 SQL 注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:52:36.470

除非必要，否则不要在 php 中使用双引号 "。它比较慢。

尽可能多地使用 ' 来代替。

被 " 包围的字符串被解析以替换变量，例如 "Hello $username" 中的变量 $username 将被检测并替换为其值。

# c++ - boost::asio 异步服务器设计

> ID：12238375
> 
> 赞同：14
> 
> 时间：2012-09-02T17:53:00.887
> 
> 标签：c++, networking, boost, architecture, boost-asio

目前，当服务器读取流的前 4 个字节，然后在标头解码后读取 N 个字节时，我正在使用设计。

但我发现第一次 async_read 和第二次读取之间的时间是 3-4 ms。我刚刚从回调中打印了控制台时间戳以进行测量。我总共发送了 10 个字节的数据。为什么要花这么多时间阅读？

> 我在调试模式下运行它，但我认为用于调试的 1 个连接与其说是从套接字读取之间有 3 毫秒的延迟。也许我需要另一种方法来减少“数据包”上的 TCP 流？

**更新：**我在这里发布了一些代码

```
void parseHeader(const boost::system::error_code& error)
        {
            cout<<"[parseHeader] "<<lib::GET_SERVER_TIME()<<endl;
            if (error) {
                close();
                return;
            }
            GenTCPmsg::header result = msg.parseHeader();
            if (result.error == GenTCPmsg::parse_error::__NO_ERROR__) {
                msg.setDataLength(result.size);
                boost::asio::async_read(*socket, 
                    boost::asio::buffer(msg.data(), result.size),
                    (*_strand).wrap(
                    boost::bind(&ConnectionInterface::parsePacket, shared_from_this(), boost::asio::placeholders::error)));
            } else {
                close();
            }
        }
        void parsePacket(const boost::system::error_code& error)
        {
            cout<<"[parsePacket] "<<lib::GET_SERVER_TIME()<<endl;
            if (error) {
                close();
                return;
            }
            protocol->parsePacket(msg);
            msg.flush();
            boost::asio::async_read(*socket, 
                boost::asio::buffer(msg.data(), config::HEADER_SIZE),
                (*_strand).wrap(
                boost::bind(&ConnectionInterface::parseHeader, shared_from_this(), boost::asio::placeholders::error)));
        } 
```

如您所见，unix 时间戳在 3-4 毫秒内有所不同。我想了解为什么 parseHeader 和 parsePacket 之间要经过这么多时间。这不是客户端问题，摘要数据是 10 个字节，但我不能发送更多，延迟恰好在调用之间。我正在使用 Flash 客户端版本 11。我所做的只是通过打开的套接字发送 ByteArray。我不确定客户端的延迟。我一次发送所有 10 个字节。我如何调试实际延迟在哪里？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-11T16:18:24.460

有太多未知数无法从发布的代码中确定延迟的根本原因。然而，有一些方法和考虑可以帮助确定问题：

*   为 Boost.Asio 1.47+启用[处理程序跟踪](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/overview/core/handler_tracking.html)。只需定义`BOOST_ASIO_ENABLE_HANDLER_TRACKING`，Boost.Asio 就会将调试输出（包括时间戳）写入标准错误流。这些时间戳可用于帮助过滤掉由应用程序代码（ 、 等）引入的`parseHeader()`延迟`parsePacket()`。
*   验证是否正确处理了[字节排序。](http://en.wikipedia.org/wiki/Endianness)例如，如果协议将标头的`size`字段定义为网络字节顺序中的两个字节，并且服务器将该字段作为原始短格式处理，则在接收到正文大小为 的消息时`10`：
    *   大端机器将调用`async_read`读取`10`字节。读取操作应该很快完成，因为套接字已经有`10`可供读取的字节体。
    *   little-endian 机器将调用`async_read`读取`2560`字节。读取操作可能仍然未完成，因为尝试读取的字节数比预期的要多得多。
*   使用跟踪工具，例如[strace](http://linux.die.net/man/1/strace)、[ltrace](http://linux.die.net/man/1/ltrace)等。
*   修改 Boost.Asio，在整个调用堆栈中添加时间戳。Boost.Asio 仅作为头文件库提供。因此，用户可以对其进行修改以提供所需的详细程度。虽然不是最干净或最简单的方法，但在整个调用堆栈中添加带有时间戳的打印语句可能有助于提供对时间的可见性。
*   尝试在一个简短、简单、自包含的示例中复制该行为。从最简单的示例开始，以确定延迟是否是系统性的。然后，对示例进行迭代扩展，使其每次迭代都更接近真实代码。

* * *

这是我开始的一个简单示例：

```
#include <iostream>

#include <boost/array.hpp>
#include <boost/asio.hpp>
#include <boost/bind.hpp>
#include <boost/date_time/posix_time/posix_time.hpp>
#include <boost/enable_shared_from_this.hpp>
#include <boost/make_shared.hpp>
#include <boost/shared_ptr.hpp>

class tcp_server
  : public boost::enable_shared_from_this< tcp_server >
{
private:

  enum 
  {
     header_size = 4,
     data_size   = 10,
     buffer_size = 1024,
     max_stamp   = 50
  };

  typedef boost::asio::ip::tcp tcp;

public:

  typedef boost::array< boost::posix_time::ptime, max_stamp > time_stamps;

public:

  tcp_server( boost::asio::io_service& service,
              unsigned short port )
    : strand_( service ),
      acceptor_( service, tcp::endpoint( tcp::v4(), port ) ),
      socket_( service ),
      index_( 0 )
  {}

  /// @brief Returns collection of timestamps.
  time_stamps& stamps()
  {
    return stamps_;
  }

  /// @brief Start the server.
  void start()
  {
    acceptor_.async_accept( 
      socket_,
      boost::bind( &tcp_server::handle_accept, this,
                   boost::asio::placeholders::error ) );
  }

private:

  /// @brief Accept connection.
  void handle_accept( const boost::system::error_code& error ) 
  {
    if ( error )
    {  
      std::cout << error.message() << std::endl;
      return;
    }

    read_header();
  }

  /// @brief Read header.
  void read_header()
  {
    boost::asio::async_read(
      socket_,
      boost::asio::buffer( buffer_, header_size ),
      boost::bind( &tcp_server::handle_read_header, this,
                   boost::asio::placeholders::error,
                   boost::asio::placeholders::bytes_transferred ) );
  }

  /// @brief Handle reading header.
  void
  handle_read_header( const boost::system::error_code& error,
                      std::size_t bytes_transferred )
  {
    if ( error )
    {  
      std::cout << error.message() << std::endl;
      return;
    }

    // If no more stamps can be recorded, then stop the async-chain so
    // that io_service::run can return.
    if ( !record_stamp() ) return;

    // Read data.
    boost::asio::async_read(
      socket_,
      boost::asio::buffer( buffer_, data_size ),
      boost::bind( &tcp_server::handle_read_data, this,
                   boost::asio::placeholders::error,
                   boost::asio::placeholders::bytes_transferred ) );

  }

  /// @brief Handle reading data.
  void handle_read_data( const boost::system::error_code& error,
                         std::size_t bytes_transferred )
  {
    if ( error )
    {  
      std::cout << error.message() << std::endl;
      return;
    }

    // If no more stamps can be recorded, then stop the async-chain so
    // that io_service::run can return.
    if ( !record_stamp() ) return;

    // Start reading header again.
    read_header();
  }

  /// @brief Record time stamp.
  bool record_stamp()
  {
    stamps_[ index_++ ] = boost::posix_time::microsec_clock::local_time();

    return index_ < max_stamp;
  }

private:
  boost::asio::io_service::strand strand_;
  tcp::acceptor acceptor_;
  tcp::socket socket_;
  boost::array< char, buffer_size > buffer_;
  time_stamps stamps_;
  unsigned int index_;
};

int main()
{
  boost::asio::io_service service;

  // Create and start the server.
  boost::shared_ptr< tcp_server > server =
    boost::make_shared< tcp_server >( boost::ref(service ), 33333 );  
  server->start();

  // Run.  This will exit once enough time stamps have been sampled.
  service.run();

  // Iterate through the stamps.
  tcp_server::time_stamps& stamps = server->stamps();
  typedef tcp_server::time_stamps::iterator stamp_iterator;
  using boost::posix_time::time_duration;
  for ( stamp_iterator iterator = stamps.begin() + 1,
                       end      = stamps.end();
        iterator != end;
        ++iterator )
  {
     // Obtain the delta between the current stamp and the previous.
     time_duration delta = *iterator - *(iterator - 1);
     std::cout << "Delta: " << delta.total_milliseconds() << " ms"
               << std::endl;
  }
  // Calculate the total delta.
  time_duration delta = *stamps.rbegin() - *stamps.begin();
  std::cout <<    "Total" 
            << "\n  Start: " << *stamps.begin()
            << "\n  End:   " << *stamps.rbegin()
            << "\n  Delta: " << delta.total_milliseconds() << " ms"
            << std::endl;
} 
```

关于实现的几点说明：

*   只有一个线程（主）和一个异步链*read_header->handle_read_header->handle_read_data*。这应该最大限度地减少准备运行的处理程序花费在等待可用线程上的时间。
*   专注于`boost::asio::async_read`，噪声通过以下方式最小化：
    *   使用预先分配的缓冲区。
    *   不使用`shared_from_this()`or `strand::wrap`。
    *   记录时间戳，并在收集后执行处理。

我使用 gcc 4.4.0 和 Boost 1.50 在 CentOS 5.4 上编译。为了驱动数据，我选择使用[netcat](http://linux.die.net/man/1/nc)发送 1000 个字节：

```
$ ./a.out > 输出 &
[1] 18623
$ echo "$(for i in {0..1000}; do echo -n "0"; done)" | 数控 127.0.0.1 33333
[1]+ 完成 ./a.out >输出
$尾输出
增量：0 毫秒
增量：0 毫秒
增量：0 毫秒
增量：0 毫秒
增量：0 毫秒
增量：0 毫秒
全部的
  开始时间：2012-9-10 21:22:45.585780
  结束：2012-9-10 21:22:45.586716
  增量：0 毫秒
```

`boost::asio::async_read`没有发现任何延迟，我通过修改调用、替换`this`和`shared_from_this()`包装`ReadHandlers`s来扩展示例`strand_.wrap()`。我运行了更新的示例，但仍然没有观察到延迟。不幸的是，这是我根据问题中发布的代码所能得到的。

考虑扩展该示例，在每次迭代中添加实际实现中的一部分。例如：

*   首先使用`msg`变量的类型来控制缓冲区。
*   接下来，发送有效数据，并介绍`parseHeader()`和`parsePacket`功能。
*   最后介绍一下`lib::GET_SERVER_TIME()`印刷品。

* * *

如果示例代码尽可能接近真实代码，并且没有观察到延迟`boost::asio::async_read`，则`ReadHandler`s 可能已准备好在真实代码中运行，但它们正在等待同步（链）或资源（一个线程），导致延迟：

*   如果延迟是与链同步的结果，那么考虑[Robin](https://stackoverflow.com/a/12238487/1053968)的建议，通过读取更大的数据块来潜在地减少每条消息所需的读取量。
*   如果延迟是等待线程的结果，则考虑进行额外的线程调用`io_service::run()`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-02T18:12:00.157

使 Boost.Asio 很棒的一件事是充分利用异步功能。依靠一批中读取的特定字节数，可能会放弃一些已经读取的内容，这并不是您真正应该做的。

相反，请查看网络服务器的示例，尤其是这个： http: [//www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/example/http/server/connection.cpp](http://www.boost.org/doc/libs/1_51_0/doc/html/boost_asio/example/http/server/connection.cpp)

一个 boost tribolean 用于 a) 如果所有数据在一个批次中都可用，则完成请求，b) 如果它可用但无效，则放弃它，c) 如果请求不完整，则在 io_service 选择时读取更多内容。连接对象通过共享指针与处理程序共享。

为什么这优于大多数其他方法？您可以节省已经解析请求的读取之间的时间。遗憾的是，示例中没有遵循这一点，但理想情况下，您应该对处理程序进行线程化，以便它可以处理已经可用的数据，而将其余数据添加到缓冲区中。它阻塞的唯一时间是数据不完整时。

希望这会有所帮助，但无法解释为什么读取之间会有 3ms 的延迟。

# ios - 如何在 iOS 中检查 Web 服务器的状态？

> ID：12238377
> 
> 赞同：0
> 
> 时间：2012-09-02T17:53:11.137
> 
> 标签：ios, http

我需要检查网络服务器的状态，特别是网络服务器是否返回正确的状态代码 200 的信息。有没有办法从 iOS 的网络服务器获取 HTTP 响应代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T00:41:24.960

这在[官方文档](https://developer.apple.com/library/mac/documentation/Foundation/Reference/NSURLConnectionDelegate_Protocol/Reference/Reference.html#//apple_ref/doc/uid/TP40009947-CH1-BAJFIJBC)中有很好的记录，无需实现 3rd 方库（尽管如果您是 iOS 编码新手，网络 API 可以简化底层函数调用）。您的类必须是一个 NSURLConnection 委托，并且在制作 NSURLConnection 之后，您实现了类似这样的委托方法：

```
-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSHTTPURLResponse*)response 
{
    if ([response statusCode] == 200) {
        // Handle valid response (You can probably just let the connection continue)
    }
    else {
        // Other status code logic here (perhaps cancel the NSURLConnection and show error)
    }
} 
```

您应该会发现[URL 加载指南](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html#//apple_ref/doc/uid/10000165i)对于 iOS 上的此功能和其他网络功能非常有用。

# bash - 找到一个目录并在其中启动一个可执行文件

> ID：12238378
> 
> 赞同：2
> 
> 时间：2012-09-02T17:53:28.560
> 
> 标签：bash, find, exec

我必须找到一个名为“A”的目录，然后在其中启动一个名为“B”的可执行文件，该可执行文件将路径作为参数并有一行带有 execl() ：

```
 execl("./C","C",path,(char*)0);
    perror("Exec failed"); 
```

其中 C 在“A”中并且设置了 suid 位。

. 我想到了类似的东西：

```
 find -name A -execdir {}/B path \ 
```

但是我得到的是：

```
 Exec failed: Permission denied 
```

怎么了 ？从 A 启动 B 没有错误。

对不起，如果这是一个愚蠢的问题，我对 bash 脚本真的很陌生。任何帮助表示赞赏，非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T18:06:46.000

当您通过该`find`命令运行 B 时，当前目录是包含 A 的目录（即 A 的父目录），而不是 A。

如果你运行，你会得到正确的目录`find -path '*/A/B' -execdir {} \;`。

这可能是解决实际问题的正确方法，也可能不是。在此示例中，`B`没有任何目的，因此很难猜测现实世界的问题是什么。你考虑过`sudo`吗？

# android - 计时器 NullPointerException

> ID：12238379
> 
> 赞同：1
> 
> 时间：2012-09-02T17:53:41.340
> 
> 标签：android, timer, nullpointerexception

我收到 NullPointerException 到有关计时器的活动的最后一行之一。活动中发生的是 5 个 .ogg 文件一个接一个地播放。错误指向最后一个 TimerTask。我贴出整个代码，请不要害怕，代码中有很多重复。我不知道用户在错误之前做了什么，它没有出现在我的手机上。

```
java.lang.NullPointerException
at com.b2creativedesigns.eyetest.AmslerGrid1$5.run(AmslerGrid1.java:343)
at java.util.Timer$TimerImpl.run(Timer.java:284) 
```

部分代码：

```
public class AmslerGrid1 extends Activity {

    Button btnFinish;
    Button btnMute;
    ImageView imgAG;
    TextView tvResult;
    MediaPlayer help1, help2, help3, help4, help5;
    int paused=0;
    long del=250;
    int intentcounter=0;
    int p=10;
    int length;
    private Timer timer;
    boolean out;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.amslergrid1);
        out = false;
        imgAG = (ImageView)findViewById(R.id.imgAG);
        tvResult = (TextView)findViewById(R.id.tvAGResult);
        btnFinish = (Button)findViewById(R.id.btnAGResult);
        btnMute = (Button)findViewById(R.id.btnAGmute);

        help1 = MediaPlayer.create(AmslerGrid1.this, R.raw.ag1);
        help2 = MediaPlayer.create(AmslerGrid1.this, R.raw.ag2);
        help3 = MediaPlayer.create(AmslerGrid1.this, R.raw.ag3);
        help4 = MediaPlayer.create(AmslerGrid1.this, R.raw.ag4);
        help5 = MediaPlayer.create(AmslerGrid1.this, R.raw.ag5);

        timer = new Timer("AmslerGridTimer");
        timer.schedule(TimerHelp1, 2000);

        help1.setOnCompletionListener(new OnCompletionListener() {

            @Override
            public void onCompletion(final MediaPlayer cim) {
                if (paused == 0)
                {
                }
                help1.release();help1=null;
                timer = new Timer("AmslerGridTimer");
                timer.schedule(TimerHelp2, 1500);
            }
        });

        help2.setOnCompletionListener(new OnCompletionListener() {...
        help3.setOnCompletionListener(new OnCompletionListener() {...
        help4.setOnCompletionListener(new OnCompletionListener() {...
        help5.setOnCompletionListener(new OnCompletionListener() {...

            @Override
            public void onCompletion(final MediaPlayer cim) {
                if (paused == 0)
                {
                }
                help5.release();help5=null;
            }
        });

    }

    @Override
    protected void onPause() {
        super.onPause();
        if (help1 != null)
        {
            help1.pause(); 
            length=help1.getCurrentPosition();
        }
        ...
        else if (help5 != null)
        {
            help5.pause(); 
            length=help5.getCurrentPosition();
        }

        p=0;
    }

    @Override
    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
        if (help1 != null)
        {
            if (p==0){
                help1.seekTo(length); help1.start(); 
                help1.setOnCompletionListener(new OnCompletionListener() {

                    @Override
                    public void onCompletion(final MediaPlayer cim) {
                        help1.release();help1=null;
                    }
                });
                paused=0;p=1;
            }
        }
           ...
        else if (help5 != null)
        {
            if (p==0){
                help5.seekTo(length); help5.start(); 
                help5.setOnCompletionListener(new OnCompletionListener() {

                    @Override
                    public void onCompletion(final MediaPlayer cim) {
                        help5.release();help5=null;
                    }
                });
                paused=0;p=1;
            }
        }
    }

    @Override
      public void onDestroy() {
        super.onDestroy();
        timer.cancel();
        timer = null;
      }

    public boolean onKeyDown(int keyCode, KeyEvent event) 
    {
        if (keyCode == KeyEvent.KEYCODE_BACK && event.getRepeatCount() == 0) 
        {
            out = true;
            if (help1 != null)
            {
                help1.stop(); 
            }
            else if (help2 != null)
            {
                help2.stop(); 
            }
            else if (help3 != null)
            {
                help3.stop(); 
            }
            else if (help4 != null)
            {
                help4.stop(); 
            }
            else if (help5 != null)
            {
                help5.stop(); 
            }
            Intent intentstart = new Intent(AmslerGrid1.this, MainActivity.class);
            intentstart.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
            startActivity(intentstart);

        }
        return super.onKeyDown(keyCode, event);
    }

    private TimerTask TimerHelp1 = new TimerTask() {
        @Override
        public void run() {
            if (!out) help1.start();p=1;
        }
      };
    private TimerTask TimerHelp2 = new TimerTask() {
        @Override
        public void run() {
            if (!out) help2.start();p=1;
        }
      };
    private TimerTask TimerHelp3 = new TimerTask() {
        @Override
        public void run() {
            if (!out) help3.start();p=1;
        }
      };
    private TimerTask TimerHelp4 = new TimerTask() {
        @Override
        public void run() {
            if (!out) help4.start();p=1;
        }
      };
    private TimerTask TimerHelp5 = new TimerTask() {
        @Override
        public void run() {
            if (!out) help5.start();p=1; //error line. Maybe out is null?
        } 
      };
} 
```

# javascript - 如何阻止流星？

> ID：12238382
> 
> 赞同：60
> 
> 时间：2012-09-02T17:54:08.717
> 
> 标签：javascript, meteor

我看到的这个问题的唯一答案 - 在不同的端口上开始另一个副本。 [从一个 Meteor 工作区切换到另一个](https://stackoverflow.com/questions/10115931/switching-from-one-meteor-workspace-to-another) 好的，我看到我可以在不同的端口上运行另一个，但是如何停止第一个？

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2013-10-13T16:29:17.797

我使用这个命令：

```
kill -9 `ps ax | grep node | grep meteor | awk '{print $1}'` 
```

或者，如果我在本地机器上杀死远程进程，我会运行它：

```
ssh [user]@[server] <<'ENDSSH'
kill -9 `ps ax | grep node | grep meteor | awk '{print $1}'`
exit
ENDSSH 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-09-02T18:45:41.910

在 OSX 上，回到您打开的术语以启动流星，然后使用`CTRL`+`C`退出该过程。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-03-17T14:14:32.553

如果 Meteor 在 :3000 端口上运行：

```
kill -9 $(lsof -i :3000 -t); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-11-07T06:36:29.643

与 Fernando 的回复类似，如果您使用的是 OSX，则可以退出进程`node`并`mongod`使用 Activity Monitor。

退出`node`将停止服务器。数据库仍将运行并接受传入连接，因此退出`mongod`将关闭数据库。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-05-25T06:00:35.910

在运行流星进程的终端上输入命令“Ctrl + C”。这是在 Mac 和 Ubuntu 中终止进程的最简单方法。虽然不确定Windows。

快乐编码！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-09-02T18:41:47.583

就我而言（Ubuntu 11.10），我打开系统监视器并手动终止`node`和`mongod`进程。

当然，您也可以使用终端并在知道它们的 PID 的情况下杀死这些进程。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-08-26T16:02:02.697

对 John Devor 的（已接受）答案的编辑：如果您使用 Atom 编辑代码，他的命令可能会杀死编辑器实例：

```
$ ps ax | grep node | grep meteor
19312 pts/2    Sl+    0:16 /home/teo/.meteor/packages/meteor-tool/.1.1.4.e4elpj++os.linux.x86_64+web.browser+web.cordova/mt-os.linux.x86_64/dev_bundle/bin/node /home/teo/.meteor/packages/meteor-tool/.1.1.4.e4elpj++os.linux.x86_64+web.browser+web.cordova/mt-os.linux.x86_64/tools/main.js
19541 pts/2    Sl+    0:02 /home/teo/.meteor/packages/meteor-tool/.1.1.4.e4elpj++os.linux.x86_64+web.browser+web.cordova/mt-os.linux.x86_64/dev_bundle/bin/node /home/teo/meteor/beari/dist/.meteor/local/build/main.js
24438 ?        Sl     0:00 /usr/share/atom/atom --no-deprecation /home/teo/.atom/packages/linter-jshint/node_modules/jshint/bin/jshint --reporter /home/teo/.atom/packages/linter-jshint/node_modules/jshint-json/json.js --filename /home/teo/meteor/beari/beari.js - 
```

最好使用如下命令：

```
kill -9 `ps ax | grep node | grep meteor | grep -v atom | awk '{print $1}'` 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-05-15T21:11:27.087

当您正在查看运行不需要的流星的终端时，只需按`Ctrl`+`C`即可关闭流星。

要并排运行更多应用程序，请使用该`--port`选项在不同的端口上运行

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-01-04T07:13:22.123

使用`sudo killall -9 node`命令。它会杀死所有的rprocess。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-02-23T18:09:37.507

实际上，`kill -9`立即杀死流星，这不是一个好主意。这是一项紧急功能，应仅在常规`kill`（未指定信号）失败时应用，因为它会阻止进程运行关闭程序。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-05-05T06:30:40.530

默认端口是 3000。如果你想在不同的端口上运行它，请使用以下 meteor run --port 3030

在两个命令提示符下运行此命令。如果要停止在必要的命令提示符下使用 ctrl+c

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-01-04T08:26:33.293

在要停止进程正在运行的终端上输入命令“Ctrl + C”。这是在 Mac 和 Ubuntu 和 Windows 中杀死进程的最简单方法。您可以使用“meteor run --port portnumber”同时运行两个或多个项目

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-08-24T16:03:21.823

就我而言，这很简单，我总是打开两个终端选项卡，一个用于启动 Meteor/停止它，另一个用于运行命令。所以为了阻止它，我只是做通用`control+c`来停止工作过程。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-03-28T17:03:50.273

在终端中，我使用了：（`$ sudo killall -9 node`这会杀死所有正在运行的节点作业）

# mysql - 在线设置mysql数据库的基本工作流程

> ID：12238383
> 
> 赞同：1
> 
> 时间：2012-09-02T17:54:34.280
> 
> 标签：mysql, phpmyadmin

我想在线建立一个Mysql数据库。我一直试图在网上找到这方面的信息，但我一直无法找到整个过程的一个很好的总结。一般来说，我在虚拟主机方面的经验非常有限，因此非常感谢任何指点。

我的问题是：-您是否需要在线专用的 mysql 服务器，或者我可以在我的网站空间上设置一个（我有一个用于随机内容的网站）-我如何在我的网站空间上设置数据库（如果可能的话）

到目前为止，我已将 phpMyAdmin 上传到我的网站，并且开始屏幕加载正常，但我为用户和密码感到困惑。我需要在这里输入我的 webspace ftp 用户名和密码吗？或者我的 mysql 用户和密码（我觉得这很奇怪，因为我还没有真正设置任何 mysql 网络空间）。还是我需要为特定的用户和密码配置 phpMyAdmin？

所以，是的，非常基本的东西真的...... :)

谢谢！戴夫

# regex - 用斜线字符查找和替换文本

> ID：12238384
> 
> 赞同：2
> 
> 时间：2012-09-02T17:54:38.163
> 
> 标签：regex, string, perl, replace, slash

所以我在 Stackoverflow 上环顾四周，我明白查找和替换文本的工作方式如下：

```
perl -pi -w -e 's/www.example.com/www.pressbin.com/g;' *.html 
```

但是，如果我要查找和替换的文本是带有斜杠的文件路径怎么办？那我该怎么做呢？

```
perl -pi -w -e 's/path/to/file/new/path/to/file/g;' *.html 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T17:58:46.460

使用 perl 正则表达式，您可以使用除空格以外的*任何字符作为正则表达式分隔符，尽管*

*   中的字符`\w`(so`s xfooxbarx`与 相同`s/foo/bar/`) 和
*   问号 `?`（隐式激活仅匹配一次行为，已弃用）和
*   单引号`'...'`（变量插值的轮次）

应该避免。我更喜欢花括号：

```
perl -pi -w -e 's{path/to/file}{new/path/to/file}g;' *.html 
```

分隔符可能不会出现在各自的字符串中，除非它们是平衡的大括号或正确转义。所以你*也*可以说

```
perl -pi -w -e 's/path\/to\/file/new\/path\/to\/file/g;' *.html 
```

但这太丑陋了。

当使用大括号/括号等时，正则表达式和替换之间可以有空格，允许漂亮的代码，如

```
$string =~ s {foo}
             {bar}g; 
```

在这种情况下，另一个有趣的正则表达式选项是`quotemeta`函数。如果您的搜索表达式包含许多通常会被解释为具有特殊含义的字符，我们可以将该字符串包含在`\Q...\E`. 所以

```
m{\Qx*+\E} 
```

匹配确切的 string `x*+`，即使包括`*`、 '+'`|`等字符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T17:59:35.133

您可以使用“/”以外的其他字符来指定模式。例如：

```
perl -pi -w -e 's,path/to/file,new/path/to/file,g;' *.html 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T17:58:08.833

`perl -pi -w -e 's/path\/to\/file/new\/path\/to\/file/g;' *.html`

# symfony - 将本地开发分支与远程分支同步

> ID：12238388
> 
> 赞同：0
> 
> 时间：2012-09-02T17:55:58.600
> 
> 标签：symfony, amazon-ec2

人们通常如何使用本地内容管理远程内容？假设我有一个运行 ubuntu 的 EC2 实例，而我的开发机器是 OS X。我有一个 symfony2 项目。人们通常会直接在 EC2 上的远程服务器上处理文件吗？如果是，他们如何在 EC2 框中使用文本编辑器，例如 sublime text？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:27:21.030

我不能说“人”是如何工作的。但对我来说，最佳做法如下：

**偏僻的：**

*   安装**mysql & php 包括。需要所有扩展**。(symfony-project/web/config.php) 您可以使用本教程： http: [//www.howtoforge.com/perfect-server-ubuntu-10.04-lucid-lynx-ispconfig-3](http://www.howtoforge.com/perfect-server-ubuntu-10.04-lucid-lynx-ispconfig-3)
*   在服务器上为您的项目创建**数据库**
*   **在服务器上克隆**您的 git 存储库并定义**WebHook URL**
*   在您的服务器上创建文件。**`<?php git pull ?>`**

从现在开始，您将永远不会直接在远程工作！（通过 ssh 安装供应商除外）

**当地的：**

*   安装**本地网络服务器**。我推荐[http://php-osx.liip.ch/](http://php-osx.liip.ch/)但你也可以使用 MAMP（不喜欢那样）。
*   **在 web 文件夹中克隆**git 存储库
*   在 symfony 项目中定义**远程数据库**
*   **查看本地更改**

Commit&Push 会自动拉取远程

# c# - 动态转换类

> ID：12238390
> 
> 赞同：0
> 
> 时间：2012-09-02T17:56:03.047
> 
> 标签：c#

```
 class Base
    {
        virtual public void FuncA()
        {
            MessageBox.Show("10");
        }
    }

    public class BasePlusOne: Base
    {
        public void Bp1MEthod()
        {
            MessageBox.Show("BasePlusOne");
        }
        override public  void FuncA()
        {
            MessageBox.Show("overridden by BasePlusTwo");
        }
    }

    public class BasePlusTwo : Base
    {
        public void Bp1MEthod()
        {
            MessageBox.Show("BasePlusTwo");
        }
        override public void FuncA()
        {
            MessageBox.Show("overridden by BasePlusTwo");
        }
    }

    public class One
    {
        public Base GetBase(int i )
        {
            if (i == 1)
            {
                return new BasePlusOne();
            }
            else
            {
                 return new BasePlusTwo();
            }
        }
    }

    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            One one = new One();
            Base bp =one.GetBase(2);

            BasePlusOne b = (BasePlusOne)bp;

            b.Bp1MEthod();
            b.FuncA();
        }
    } 
```

正如所见，我正在使用以下代码来动态选择`base`类。我正在将`base`收到的课程转换为适当的课程。如果返回的类是 ，此代码将抛出异常`BasePlusOne`。有没有更好的方法来处理这种情况？这种方法还有其他错误吗？

```
One one = new One();
Base bp =one.GetBase(2);

BasePlusOne b = (BasePlusOne)bp;

b.Bp1MEthod();
b.FuncA(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:03:44.510

您可以使用`is`运算符测试对象的类型：

```
if (obj is BasePlusOne) // this should be first
{
   BaseBlusOne b = obj as BaseBluseOne;
}
else if (obj is Base)
{
   Base b = obj as Base;
} 
```

注意`if`s 的顺序。如果类`BasePlusONe`继承`Base`，那么顺序必须像上面那样。如果第一个是`Base`，那么它将由`Base`对象和`BasePlustOno`（假设`BasePlusOne : Base`，如我们所说）输入。

**回答您的代码**：

```
One one = new One();
Base bp = one.GetBase(2);

if (bp is BasePlusOne)
{
    BasePlusOne b = (BasePlusOne)bp;
    b.Bp1MEthod();
    b.FuncA();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T17:59:59.843

除非我错了，听起来你想使用[策略模式......](http://www.dofactory.com/Patterns/PatternStrategy.aspx)

编辑-我还没有阅读所有代码....我会使用一个界面来指定策略模式中的常见内容...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:00:27.787

您需要添加`Bp1MEthod`一个通用的基类（即`Base`）。铸造`BasePlusTwo`意志`BasePlusOne`（通常）失败。

在对象祖先中向上（从`Base`到`BasePlusOne`）铸造是一个坏主意，并且强烈暗示有缺陷的设计。向另一个方向投射是多态的基本思想。

# sql - 良好的软件工程概念：混乱的数据库与一切合二为一

> ID：12238392
> 
> 赞同：-1
> 
> 时间：2012-09-02T17:56:34.407
> 
> 标签：sql, database

首先，我将说明情况。请仔细阅读。

我正在创建一个 java 电话簿软件。我创建了一个包含名称、地址、mobile1、mobile2、landPh1、landPh2 等字段的数据库。完成 90% 后，我决定扩展它的功能。因此，我开始使用 VCards，现在该程序可以读取 VCards 并将它们添加到数据库中。然后我决定使用存储在数据库中的数据编写 VCards。这里，问题出现了！！

VCard 没有名为“名称”的字段，就像我在我的软件中那样。取而代之的是，他们有“名字”、“姓氏”和“中间名”。VCard 没有我的软件中的“地址”。它们有“国家”、“城市”和“街道地址”。现在，我怎样才能得到这些单独的细节？？？？我只能得到名字，而不是第一个，最后一个等。我只能得到地址，而不是国家，城市等。现在我该怎么办？？？？？？以下是我的建议

1.  获取完整名称。将其设置为 VCards 的“名字”字段。您将在那里获得完整的名称。对于地址，将完整地址添加到 VCard 的“街道地址”字段。

2.  编辑数据库，更改它并添加缺少的字段。但是，数据库将看起来像这样

名字，地址，mobile1，mobile2，landPh1，landPh2，middleName，lastName，国家，城市

很乱，不是吗？

我无法删除表格，因为已经根据当前格式创建了很多东西！改变它需要很多时间！

我不知道上述建议是否适用于良好的软件工程概念。如果你有更好的方法，我也很高兴听到。请帮忙！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:36:23.093

您在最初的数据库设计中犯了许多错误。您应该尽早纠正这些错误，因为您维护具有设计缺陷的系统的时间越长，以后纠正它们的难度就越大。

简而言之，您需要：

1.  确保每一列包含一个且仅一个信息。这意味着名称部分的单独列，地址部分的单独列等。

2.  您需要确保您没有将同一项目的多个实例存储在一条记录中。这意味着为电话号码创建一个单独的表。该表很可能包含三列，一个指向联系人的 ID，一个用于电话号码的列，以及一个描述。

您将永远无法准确地“解码”100% 的可能地址和名称。

您可以通过谷歌搜索了解更多关于良好数据库设计规则的信息`database normalization`。

不要担心表中列的顺序或表中的记录。SQL 不包含默认排序的概念，而是在检索时根据需要对列和记录进行排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T18:10:10.593

FWIW，我会：

*   不要太担心数据库中列的物理顺序。新列通常附加在生产数据库的末尾而不重新创建表。
    *   保持数据规范化，即不要将所有姓名和地址字段合并为一列，因为以后拆分这些字段很麻烦。
    *   您可能会考虑将您的地址和 vcf 卡数据标准化为单独的表，这些表与您的人员/联系人表 1:N。这将允许每个人拥有多个电子名片和地址。

# iphone - 检查当前时间是否在时间 A 和 B 之间

> ID：12238395
> 
> 赞同：0
> 
> 时间：2012-09-02T17:57:00.287
> 
> 标签：iphone, ios, ipad, time

无论如何我可以检查当前时间是否在两次之间？

当前时间 = 上午 12:00
时间 A：上午 8:00
时间 B：下午 3:00

这将返回真，这不会：
当前时间：下午 1:00
A = 上午 1:00
B = 凌晨 2:00

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T22:40:25.627

您可以按照以下方式进行操作：

```
NSDate *timeA, *timeB; // Whatever and however you want to set these;
NSDate *now = [NSDate date];

If([now compare:timeA] == NSOrderedDescending && [now compare:timeB] == NSOrderedAscending)
    // then now is between timeA and Time B 
```

# html - 如何在 Chrome 中禁用来自 HTML 的谷歌翻译

> ID：12238396
> 
> 赞同：175
> 
> 时间：2012-09-02T17:57:01.890
> 
> 标签：html, google-chrome, google-translate

我刚为一家法国餐馆做了一个网站。该网站是英文的，但我想网站上有足够的法语（菜单项的标签图片）提示访问者在使用 Chrome 时翻译网站。

我可以在 html 中添加一些内容以防止 chrome 要求翻译页面吗？我认为它会是类似的东西，`<html lang="en">`但那是行不通的。

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：357
> 
> 时间：2012-09-02T17:59:46.367

### 新答案

添加`translate="no"`到您的`<html>`标签，如下所示：

```
<html translate="no"> 
```

[MDN 参考](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/translate)

* * *

### 旧答案

（这应该仍然有效，但不太理想，因为它是谷歌特有的，而且还有其他翻译服务。）

`<head>`在和之间添加这个标签`</head>`：

```
<meta name="google" content="notranslate"> 
```

[文档参考](https://support.google.com/webmasters/answer/79812)

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2020-04-22T10:40:30.870

因此，对于我提出的最终解决方案；

```
<!DOCTYPE html>
<html lang="en" class="notranslate" translate="no">
<head>
  <meta name="google" content="notranslate" />
</head>
<body>
...
</body>
</html> 
```

这对我有用。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2019-07-23T13:34:40.387

中的元标记`<head>`对我不起作用，但是

`class="notranslate"`

添加到父级`div`（甚至`<body>`）确实有效，并允许更精确地控制您不想翻译的内容。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2021-05-07T16:12:02.920

解决方案：

```
<html lang="en" class="notranslate" translate="no">    <!-- All translators -->
 <head><meta name="google" content="notranslate" /> <!-- Just for google -->
</head>                                                <!-- Close head      --> 
```

更简单的方法是添加**translate="no"**属性。这可以在 div、文本等中进行。这是一个例子：

```
// Just for instructions
// Do not copy or paste
console.log("The first div don't alows translateing. But the second, alows it.")
console.log("Open the translator and see the efect.")
```

```
DIV1
<div translate="no">
  Try translating me!
  <b>Olá - Hello - Hola</b>
</div>
<hr> DIV2
<div translate="">
  Now, you can do it!
  <b>Olá - Hello - Hola</b>
</div>
```

请注意，此示例在 StackOverflow 查看器中存在一些问题。

* * *

免责声明：重复此答案，在社区 Wiki 上。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-02-05T20:00:06.333

仅供参考，如果您想要适用于您网站中所有内容的内容（包括非 HTML 内容），您可以将`Content-Language`响应（[source](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Language)）中的标头设置为适当的语言（在我的情况下为`en-US`）。

这样做的好处是它将“禁用”为您翻译页面的提议*（*因为它会正确地知道源语言），但对于其他非母语读者，他们仍然可以选择翻译您的网站成他们自己的语言，它会正常工作。

（同样对于我的用例，Chrome 提供将格式良好的 JSON 从拉丁语翻译成英语，BS 消失了。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-11-27T16:18:24.413

**在您的网站上禁用谷歌翻译**

将此添加到您的`<head></head>`：

```
<meta name="google" content="notranslate" /> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-09-12T10:07:42.417

试试这个以获得最终解决方案：

```
<html lang="en" class="notranslate" translate="no">    <!-- All translators -->
 <head><meta name="google" content="notranslate" /> <!-- Just for google -->
</head>                                                <!-- Close head      --> 
```

更简单的方法是添加**translate="no"**属性。这可以在 div、文本等中进行。这是一个例子：

```
// Just for instructions
// Do not copy or paste
console.log("The first div don't alows translateing. But the second, alows it.")
console.log("Open the translator and see the efect.")
```

```
DIV1
<div translate="no">
  Try translating me!
  <b>Olá - Hello - Hola</b>
</div>
<hr> DIV2
<div translate="">
  Now, you can do it!
  <b>Olá - Hello - Hola</b>
</div>
```

请注意，此示例在 stackoverflow 查看器上存在一些问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-21T07:29:07.947

我的 Windows 是德语的德语。

我在 Chrome 中做了以下体验： 如果我设置

```
<html lang="en" translate="no"> 
```

谷歌翻译提出了翻译英语的建议。

当然我必须省略 lang 属性。这对我有用：

```
<html translate="no"> 
```

没有弹出窗口出现，并且 URL 字段中的翻译图标不再显示。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-03T10:28:41.467

有时您需要阻止的不是所有 html，而是特定元素，在这种情况下，您可以仅将 class="notranslate" 添加到该元素。IE。`<div class="notranslate"> some content </div>`

# php - 为什么 symfony 找不到我的自动加载类？

> ID：12238401
> 
> 赞同：0
> 
> 时间：2012-09-02T17:58:26.700
> 
> 标签：php, symfony-1.4, autoload

我正在尝试在我的 symfony 项目中使用[php-ga](http://code.google.com/p/php-ga/)第三方库。我已经在 config_autoload.yml.php 中安装了库`apps/<app>/lib`，清除了缓存，并且第三方文件出现在我所期望的**config_autoload.yml.php**中：

```
'tracker' => 'C:/wamp/www/apps/api/lib/php-ga/GoogleAnalytics/Tracker.php',
'transaction' => 'C:/wamp/www/apps/api/lib/php-ga/GoogleAnalytics/Transaction.php',
... 
```

但是，当我尝试在同一应用程序下的操作中使用类时，如下所示：

```
use UnitedPrototype\GoogleAnalytics;

public function executeNew(sfWebRequest $request)
{
   $tracker = new GoogleAnalytics\Tracker(...);
   ... 
```

我收到一条错误消息，说它无法解析该类：

> 致命错误：在 C:\wamp\www\apps\api\modules\encoding\actions\actions.class.php 中找不到类“UnitedPrototype\GoogleAnalytics\Tracker”

我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T18:14:42.827

Symfony 的自动加载器无法正确加载命名空间类。我认为您应该将 ga lib 移动到并在（如）`lib/vendor/php-ga`中使用它自己的自动加载器。`config/ProjectConfiguration.class.php``require_once __DIR__ . '/../lib/vendor/php-ga/autoload.php'`

# .net - 瞬态故障处理应用程序块是否处理当前连接到联合数据库的连接？

> ID：12238403
> 
> 赞同：2
> 
> 时间：2012-09-02T17:58:29.097
> 
> 标签：.net, azure, database-connection, azure-sql-database, sharding

在 Windows Azure 中，我们有重试逻辑，使用瞬态故障处理应用程序块，它在我们的工作角色上按预期工作。但是，我们最近升级了我们的 SQL Azure 数据库以进行联合，并且从那时起遇到了一些问题。

我们的工作者角色偶尔会说某个特定的存储过程不存在。这是我们让它在运行循环中每秒检查的存储过程。角色遍历每个分片并在每个分片数据库上运行存储过程。这一切都很好，但是我们偶尔会在日志中收到错误，指出它找不到存储过程，调用堆栈表明 TransientFaultHandling 连接已重试。

看到我们的代码只是创建一个连接（保持打开）连接到一个分片，然后执行存储过程，我认为候选可能是，如果存在暂时性故障并且它重试连接，它可能最终连接回根数据库而不是它曾经连接的分片？

我的问题是 TransientFaultHandling 块是否正确解释了这一点并在重试连接时重新连接回正确的分片，如果没有，是否有这样做的最佳实践？

谢谢加雷斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T21:27:41.660

I suspect that you are on the right track; the connection is probably reset to the root database. The Transient Fault Handling block will handle transient errors automatically but is not Federation aware as far as I know.

I wonder how your code is structured. But here is an idea (if that's not what you are already doing): You could use the application block to retry an entire piece of code that includes the connection request, the USE command (for federation) and the stored proc call. So if that fails, everything gets to be retried. You do that by creating a retry policy object (which would be the SQL database transient detection strategy), and call the ExecuteAction method that performs all the work you want done.

Hope this helps.

Herve

# web-services - 如何让 JMeter 等待页面回答

> ID：12238409
> 
> 赞同：3
> 
> 时间：2012-09-02T17:59:17.510
> 
> 标签：web-services, jmeter, httpresponse, load-testing, performance-testing

我无法弄清楚如何让 JMeter 等待来自 Web 服务的 HTTP 响应。
我添加了带有选项的 If Controller `${JMeterThread.last_sample_ok}`，但不幸的是它不起作用。
任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T19:39:24.087

我同意奥利弗的回应。

但也许你的问题太模糊了，你想做的是等待中间“加载页面”之后的一些响应，在这种情况下，答案是这样的：

*   [http://www.sourcepole.ch/2011/1/4/waiting-for-a-page-change-in-jmeter](http://www.sourcepole.ch/2011/1/4/waiting-for-a-page-change-in-jmeter)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T18:52:42.043

JMeter 默认等待 HTTP 响应。

如果您使用的是[HTTP 采样器，那么您可以使用](http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Request)[View Results Listener 查看](http://jmeter.apache.org/usermanual/component_reference.html#View_Results_Tree)每个请求的响应。您还可以在采样器本身或使用[HTTP Defaults Control](http://jmeter.apache.org/usermanual/component_reference.html#HTTP_Request_Defaults)设置请求的超时时间。

# ios - 如何在 UITable 中获取 UIButton 或 UILabel 的位置？

> ID：12238411
> 
> 赞同：1
> 
> 时间：2012-09-02T17:59:18.257
> 
> 标签：ios, uitableview

我在所有的`UICellViews`. 按下这些按钮时，会触发一些操作。到目前为止，一切都很好。

如何获取这些按钮之一相对于屏幕上可见区域的位置？您对如何实现这一目标有任何想法（或教程）吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T18:05:04.603

可以使用的方法[`-convertRect:toView:`](http://developer.apple.com/library/ios/documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-BBCEAJCI)。`UIView`

```
CGRect frameInWindow = [button convertRect:button.bounds toView:viewController.view]; 
```

这是一个小测试：

```
- (void)loadView
{
    [super loadView];

    self.view = [[UIView alloc] initWithFrame:[UIScreen mainScreen].applicationFrame];

    UIView *parentView = [[UIView alloc] initWithFrame:CGRectMake(100, 100, 300, 300)];
    [self.view addSubview:parentView];

    UIView *childView = [[UIView alloc] initWithFrame:CGRectMake(100, 100, 100, 100)];
    [parentView addSubview:childView];

    CGRect rect1 = [childView convertRect:childView.bounds toView:self.view];
    // 200, 200, 100, 100 => correct

    // Other tests for the discussion of @H2CO3's answer.

    CGRect rect2 = [childView.superview convertRect:childView.frame toView:self.view];
    // 200, 200, 100, 100 => correct
    CGRect rect3 = [childView convertRect:childView.frame toView:self.view];
    // 300, 300, 100, 100 => wrong
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T18:05:12.087

您可以使用`frame`视图的属性来获取其相对于其父视图的位置：

```
CGRect frame = someView.frame;
CGPoint topLeftCorner = frame.origin; 
```

如果这还不够（即您想要获取相对于任何其他视图的视图框架，而不仅仅是其父视图），您可以使用各种转换方法：

```
CGRect relativeFrame = [view convertRect:view.bounds toView:anotherView]; 
```

有关更多信息，请参阅[UIView 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/uiview/uiview.html)。

# google-chrome - Chrome插件未显示在上下文菜单中

> ID：12238416
> 
> 赞同：0
> 
> 时间：2012-09-02T17:59:59.547
> 
> 标签：google-chrome, google-chrome-extension

> **可能重复：**
> [将 chrome 扩展程序从清单 v1 更改为 v2 时出现端口错误](https://stackoverflow.com/questions/11913575/port-error-while-changing-chrome-extension-from-manifest-v1-to-v2)

我正在尝试为我的网站开发一个插件。我的用户需要能够右键单击任何网页上的任何超链接，然后单击 Chrome 上下文菜单中的链接，该链接会将他们带到我的网站以执行操作。

我的插件已经完成，但每次我尝试测试它时，当右键单击超链接时，链接不会出现在 Chrome 上下文菜单中。

这是我的文件：

**清单.jason**

```
{
"manifest_version": 2,
"background_page": "background.html",
"description": "Decrypt Short URLs.",
"icons": {
  "128": "icon-128.png",
  "16": "icon-16.png",
  "48": "icon-48.png"
 },
"minimum_chrome_version": "8.0.0.0",
"name": "xxxx.xxx",
"permissions": [ "http://*/*", "https://*/*", "tabs", "contextMenus" ],
"version": "1.0"
} 
```

**背景.html**

```
<!DOCTYPE html>

<html>
<head>

</head>
<body>
<script>

  function handleClick() {
    return function(info, tab) {

      var url = 'http://xxx.xxx/api.php?url=' + info.linkUrl +    '&source=chromeextension'

      // Create a new tab to the results page
      chrome.tabs.create({ url: url, selected:true  });
    };
  };

  chrome.contextMenus.create({
    "title" : "Decrypt this Link",
    "type" : "normal",
    "contexts" : ["link"],
    "onclick" : handleClick()
  });
 </script>
</body> 
```

我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T07:03:23.093

我想问题出在您的清单文件中。您使用清单版本 2，但您的背景页面被声明为清单版本 1。

您应该尝试更改 manifest.json 的这一部分：

```
"background_page": "background.html", 
```

在这个：

```
 "background": {
        "scripts": ["background.js"]
    }, 
```

并将所有后台代码放入 background.js

您可以在此处阅读更多信息：[background_pages](http://developer.chrome.com/extensions/background_pages.html)

PS对不起，[Rob W先生](https://stackoverflow.com/users/938089/rob-w)已经在主要问题的评论中指出了这个问题。

# android - 如何动态更新片段视图

> ID：12238421
> 
> 赞同：2
> 
> 时间：2012-09-02T18:00:29.470
> 
> 标签：android, bluetooth, android-fragments

我必须为我的大学实施申请，我需要专家的一些建议:)。我有一个使用的活动`PageIndicator`，每个页面都是一个片段。当前最多显示一页。在每个片段中，有 4 个小部件包含通过蓝牙从应用程序读取的值（有一个串行设备通过蓝牙向应用程序发送数据）我认为我的活动必须有一个独立的线程，在循环中与串行设备通信. 但是当这个线程读取值时，如何将数据发送到当前的fragment，尤其是指定的widget？当前小部件必须显示最近读取的数据。换句话说，我需要知道活动线程如何将 dato 发送到当前片段。对不起我的英语不好

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T18:17:14.527

在创建片段时，将它们记录在 ArrayList 中并创建一个扩展 Fragment 的自定义片段类

```
static public ArrayList<CustomFragment> fragmentsList = new ArrayList<CustomFragment>();

// create new fragment
// Example:
// CustomFragment myFragment = new FragmentOne();

fragmentsList.add(newlyCreatedFragment); 
```

并在片段内部创建一个接收更新的方法，例如

你的片段类：

```
public class CustomFragment extends Fragment {

    public void receiveUpdate(String update) {
      // Do something
    }
} 
```

然后代替“扩展片段”使用“扩展自定义片段”

然后从其他班级

```
CustomFragment theFragment = SomeClass.fragmentsList.get(0); // where 0 is the fragment's index
theFragment.receiveUpdate("the update"); 
```

# linqpad - LinqPad - 将 SQL 转换为 Linq 命令

> ID：12238423
> 
> 赞同：18
> 
> 时间：2012-09-02T18:00:40.310
> 
> 标签：linqpad

我最近购买了 LINQPad，希望它能让我将 SQL 语句转换为 LINQ 语句。

使用 LINQPad，我可以附加一个数据库并运行返回我需要的结果的 SQL 语句。

但我找不到将该 SQL 语句转换为 LINQ 的“命令”。

您能否告诉我如何使用 LINQPad 或其他工具将 SQL 转换为 LINQ？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-09-03T00:41:00.687

有一个名为[Linqer](http://www.sqltolinq.com/)的工具，但要小心：从 SQL 音译到 LINQ 会给您带来[两全其美的结果](http://linqpad.uservoice.com/forums/18302/suggestions/194040)。

例如，假设您希望所有 1000 美元或以上的购买都以现金或由居住在华盛顿的客户支付。这是 SQL 中的查询：

```
SELECT p.*
FROM Purchase p
    LEFT OUTER JOIN 
        Customer c INNER JOIN Address a ON c.AddressID = a.ID
    ON p.CustomerID = c.ID  
WHERE
   (a.State = 'WA' || p.CustomerID IS NULL)
    AND p.ID in
    (
        SELECT PurchaseID FROM PurchaseItem
        GROUP BY PurchaseID HAVING SUM (SaleAmount) > 1000
    ) 
```

如何将其转换为 LINQ？错误的方法是将查询*音译成*LINQ，试图重现外连接和内连接、子查询和组子句。正确的方法是将原始查询（英文）直接映射到 LINQ，利用 LINQ 的线性数据流和关联属性：

**我要所有购买...**

```
from p in db.Purchases 
```

**... 1000 美元或更多...**

```
where p.PurchaseItems.Sum (pi => pi.SaleAmount) > 1000 
```

**...现金支付...**

```
where p.Customer == null 
```

**...或居住在华盛顿的客户**

```
|| p.Customer.Address.State == "WA" 
```

这是最终的查询：

```
from p in db.Purchases
where p.PurchaseItems.Sum (pi => pi.SaleAmount) > 1000
where p.Customer == null || p.Customer.Address.State == "WA"
select p 
```

更多信息[在这里](https://www.linqpad.net/WhyLINQBeatsSQL.aspx)。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-09-02T18:24:51.783

一般来说，没有像@andres-abel 之前提到的那样将 SQL 转换为 Linq 的工具，但有时您必须编写完全按照指定 SQL 执行的 Linq（例如，由于性能问题、向后兼容性或其他一些原因）。

在这种情况下*，我会建议您自己进行逆向工程*：

1.  配置 Linq 生成的转储 SQL 语句的日志记录以`stdout`使用
    *   [`ObjectQuery.ToTraceString`](http://msdn.microsoft.com/en-us/library/system.data.objects.objectquery.totracestring.aspx),
    *   [`DbCommand.CommandText`](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.getcommand.aspx),
    *   [记录器可用于您的数据源](http://www.codeproject.com/Articles/26066/Redirect-LINQ-to-SQL-DataContext-Log-Messages-To-L)
2.  手动重写 Linq 语句，直到你得到你需要的

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-02T18:05:15.190

LinqPad 不包含 SQL->LINQ 转换器。LinqPad 实际上也不包含任何 LINQ->SQL 转换器。它依赖于 .Net Linq-to-Sql 库或实体框架进行翻译。

我也不知道任何其他具有该功能的工具。在简单的情况下，可以创建一个，但对于更复杂的情况，这是不可能的，因为没有与某些 SQL 构造匹配的 LINQ 表达式。

# vb.net - Visual Studio 2012 ClickOnce 发布默认网页

> ID：12238424
> 
> 赞同：0
> 
> 时间：2012-09-02T18:00:43.983
> 
> 标签：vb.net, visual-studio, webpage, publish

我正在使用 Visual Studio 2012 中的 ClickOnce 发布工具将应用程序发布到我的网站，该工具会发布检查先决条件的网页，然后下载应用程序。但是，这与我的网站的格式完全不同。

有没有办法让 Visual Studio 传递某种模板，它可以用来创建网页，否则我必须手动更改我发布的每个应用程序/更新的所有样式。我知道我可以使用外部 CSS 文件来执行此操作，但是网页是使用内联样式创建的，这导致我昨晚尝试时的布局方式出现问题。

我从[http://msdn.microsoft.com/en-us/library/k5befhe3.aspx](http://msdn.microsoft.com/en-us/library/k5befhe3.aspx)找到了这个：

> 自定义发布网页
> 
> 1\. 将 ClickOnce 应用程序发布到 Web 位置。有关详细信息，请参阅如何：使用发布向导发布 ClickOnce 应用程序。
> 
> 2\. 在 Web 服务器上，在 Visual Web Designer 或其他 HTML 编辑器中打开 Publish.htm 文件。
> 
> 3\. 根据需要自定义页面并保存。
> 
> 4\. 可选。要防止 Visual Studio 覆盖您的自定义发布网页，请取消选中“发布选项”对话框中的每次发布后自动生成部署网页。有关详细信息，请参阅发布选项对话框。

这意味着我必须手动更改每个页面。有谁知道传递模板供 VS 使用的方法，或者当我单击发布时每个网页都是动态创建的？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T08:41:17.183

> 可选的。要防止 Visual Studio 覆盖您的自定义发布网页，请取消选中“发布选项”对话框中的每次发布后自动生成部署网页。有关详细信息，请参阅发布选项对话框。

这就是你想做的，我猜？

# java - JAVA：BufferdInputStream 和 BufferedOutputStream

> ID：12238426
> 
> 赞同：2
> 
> 时间：2012-09-02T18:00:49.610
> 
> 标签：java, stream, inputstream, outputstream

我有几个问题-

**1.** 我有两台电脑通过socket连接。程序执行时

```
outputStream.writeInt(value);
outputStream.flush(); 
```

实际发生了什么？程序是否等到另一台计算机读取整数值？

**2.**如何清空`outputStream`or `inputStream`？意思是，当清空`outputStream`or时`inputStream`，写入该流的任何内容都会被删除。（请不要建议通过关闭连接来做到这一点！）我试图用`inputStream`这种方式清空 -

```
byte[] eatup=new byte[20*1024];
int available=0;
while(true)
{
    available=serverInputStream.available();
    if(available==0)
       break;
    serverInputStream.read(eatup,0,available);
}
eatup=null;

String fileName=(String)serverInputStream.readObject(); 
```

程序不应处理该行，因为`outputStream`. 但是我的程序无论如何都会执行它并引发`java.io.OptionalDataException`错误。

**注意：**我正在开发一个客户端-服务器文件传输项目。客户端将文件发送到服务器。第二个代码用于服务器终端。如果在服务器端按下“取消按钮”，那么它将停止从客户端读取字节并向客户端`serverInputStream`发送信号（我使用`int` -1）。当客户端收到此信号时，它会停止向服务器发送数据，但我注意到它`serverInputStream`不是空的。所以我需要清空它`serverInputStream`，以便客户端计算机能够再次发送服务器计算机文件（这就是为什么我无法从`read`方法管理锁定）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:11:03.073

1 - 否。在 flush() 上，数据将被写入操作系统内核，操作系统内核可能会立即将其交给网卡驱动程序，然后由网卡驱动程序将其发送到接收端。简而言之，发送就是一劳永逸。

2 - 正如 Jeffrey 评论的那样，available() 对于这种操作是不可靠的。如果做阻塞 IO，那么正如他建议的那样，你应该只是投机地使用 read() 。但是应该说，您确实需要在原始流之上定义一个协议，即使它只是使用 DataInput/DataOutputStream。使用原始写入/读取时，黄金法则是一次写入！= 一次读取。例如，如果您要在一侧写入 10 个字节，而在另一侧有一个读取循环，则无法保证一次读取将读取所有 10 个字节。它可以作为块的任何组合被“读取”。类似地，两次 10 字节的写入可能会在接收端显示为一次 20 字节的读取。换句话说，除非您在原始字节之上创建更高级别的协议来执行数据包，否则没有“数据包”的概念。

如果您确实需要做比基本应用程序更复杂的事情，我强烈建议您研究一些已经解决了网络 IO 的许多棘手问题的更高级别的库。我会推荐用于生产应用程序的[Netty 。](https://netty.io/)然而，从简单的 IO 流到 Netty 的更多基于事件的系统的理解是一个很大的飞跃。中间的某个地方可能还有其他库。

# objective-c - 为什么我不能依靠 NSNotificationCenter 使用 AVFoundation 来循环视频？

> ID：12238429
> 
> 赞同：0
> 
> 时间：2012-09-02T18:01:38.097
> 
> 标签：objective-c, video, avfoundation, nsnotificationcenter

在 NSNotificationCenter 和 playerItemDidReachEnd 的帮助下，我循环播放了使用 AVFoundation 视频播放的视频：

```
 AVURLAsset *asset = [AVURLAsset URLAssetWithURL:url options:nil];
    self.playerItem = [AVPlayerItem playerItemWithAsset:asset];
    self.avPlayer = [AVPlayer playerWithPlayerItem:self.playerItem];

    [self.avPlayer      addObserver:self forKeyPath:@"status"
                        options:0 context:AVMoviePlayerViewControllerStatusObservationContext];
    [[NSNotificationCenter defaultCenter]           addObserver:self
                                                    selector:@selector(playerItemDidReachEnd:)
                                                    name:AVPlayerItemDidPlayToEndTimeNotification
                                                    object:[self.avPlayer currentItem]];

    [self.VideoView setPlayer:self.avPlayer]; 
```

和

```
- (void)playerItemDidReachEnd:(NSNotification *)notification {        
        [notification.object seekToTime:kCMTimeZero];
        [self startVideoLoop];
} 
```

效果很好 - 但不幸的是不可靠。有时没有任何逻辑原因（在我看来）播放器在电影结束时停止而没有再次重新启动。

NSNotificationCenter 是否有可能错过了电影的结尾或方法 playerItemDidReachEnd 错过了通知消息？愚蠢的问题。但我无法确定它的头或尾......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:02:33.230

答案是

```
self.avPlayer.actionAtItemEnd = AVPlayerActionAtItemEndNone;  // default: AVPlayerActionAtItemEndPause 
```

# jquery - Jquery UI：范围滑块。哪个滑块被移动了？

> ID：12238432
> 
> 赞同：7
> 
> 时间：2012-09-02T18:03:01.953
> 
> 标签：jquery, jquery-ui, jquery-plugins

在这个演示页面：http: [//jqueryui.com/demos/slider/#event-change](http://jqueryui.com/demos/slider/#event-change)

事件“幻灯片”重写一次有两个输入：

```
$( "#amount" ).val( "$" + $( "#slider-range" ).slider( "values", 0 ) +
            " - $" + $( "#slider-range" ).slider( "values", 1 ) ); 
```

出于我的目的，我想知道移动了两个滑块中的哪一个（最小或最大）。我怎样才能得到它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-04-04T12:11:22.707

右滑块处理程序是滑块容器的最后一个子项，因此，与左处理程序不同，右处理程序没有 nextSibling：

```
$('#slider-range').slider({ 
    range: true,
    min: 0, max: 500,
    values: [ 75, 300 ],
    slide: function(event, ui) {
        if (ui.handle.nextSibling) {
            // Moving LEFT slider ...
        } else {
            // Moving RIGHT slider ...
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-29T04:56:03.077

即使我最近也遇到了同样的问题。使用范围滑块时，您需要确定移动了哪个滑块（右侧或左侧）。没有*直接*的方法可以确定，但是`ui`object 具有 attributes ，`value`您`values`可以使用它来确定移动了哪个滑块。这是对我有用的解决方案：-

```
 $( "#slider-range" ).slider({
      range: true,
      min: 75,
      max: 300,
      values:[75,300],
      slide: function( event, ui ) {
        target_name = ''
        if(ui.values[0] == ui.value) target_name = 'min_price'
        else if(ui.values[1] == ui.value) target_name = 'max_price'
        alert(target_name)
      } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-02T18:23:31.847

@Nikoole，没有特定的方法可以找到哪个手柄在滑动，但你可以试试这个技巧

```
var minSlide = 75, maxSlide = 300;
$("#slider-range").slider({
    range: true,
    min: 0,
    max: 500,
    values: [ 75, 300 ],
    slide: function( event, ui ) {
       if(minSlide != parseInt(ui.values[0], 10)){
          // Do what in minimum handle case
       }
       else if(maxSlide != parseInt(ui.values[1], 10)) {
          // Do what in maximum handle case
       }
    },
    stop: function(event, ui){
        minSlide = parseInt(ui.values[0], 10);
        maxSlide = parseInt(ui.values[1], 10);               
    }
 }); 
```

希望这会有所帮助。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-07-06T18:07:50.680

幻灯片事件有两个参数：event 和 ui。ui 包含一个句柄对象。您可以像这样访问和测试句柄的索引：

```
$("#slider-range").slider({
    range: true,
    min: 0,
    max: 500,
    values: [ 75, 300 ],
    slide: function( event, ui ) {
        var index = $(ui.handle).index();
        if (index == 1) {
            // do stuff for minimum
        }
        if (index == 2) {
            // do stuff for maximum
        }
    }
}); 
```

这适用于给定滑块中的任意数量的手柄。但请注意，索引从 1 而不是 0 开始。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-09T22:51:18.277

我通过在滑块 API [http://api.jqueryui.com/1.8/slider/#event-create](http://api.jqueryui.com/1.8/slider/#event-create)定义的创建事件上将 ID 属性设置为最小和最大选择器来解决这个问题。

```
 create:function(event, ui) 
      {
         var handlers = $('.ui-slider-handle');
         $.each(handlers, function(i, element)
         {
            if(i == 0)
                $(element).attr('id', 'slider-handler-min');
            else
                $(element).attr('id', 'slider-handler-max');
         });
      } 
```

...然后回到我的`slide`事件中，我只需从红色 ID 属性`ui.handler`中获取哪个正在移动:)

# css - 结束时不需要的水平滚动空间

> ID：12238435
> 
> 赞同：4
> 
> 时间：2012-09-02T18:03:13.633
> 
> 标签：css, html, whitespace, horizontal-scrolling

我无法在我的无序列表末尾摆脱这个不需要的水平滚动空间。我遵循了一些没有结果的教程。有什么想法可能是错的吗？

[![一只忙碌的猫](../Images/5f647537e32d0729b469fb4a296bc592.png)](https://web.archive.org/web/20160307062746/http://goawaymom.com/ "您看不到背景颜色的空白在堆栈溢出时是白色的")
[（来源：[goawaymom.com](http://goawaymom.com/grr.png)）]

点击图片去查看问题

如果有人知道出了什么问题，请提前感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T18:09:24.973

```
.megamenu > li {
    -moz-transition: background-color 0.4s ease-out 0s;
    border: medium none;
    display: inline;
    float: left;
    margin: 0;
    padding: 0 0 0 13px;
} 
```

我不确定这是否是您的问题/问题..但我将填充更改为 13px 而不是 68。为我修复了它

# javascript - 为什么要使用额外的输入元素来创建内部网站搜索框（和）

> ID：12238436
> 
> 赞同：1
> 
> 时间：2012-09-02T18:03:17.983
> 
> 标签：javascript, html, css, search-engine

我为什么要使用或需要使用具有隐藏属性的额外输入元素来制作一个在内部搜索给定网站的网站搜索框。

```
<div id="search_box">
<form name="searchform" action="http://www.google.com/search" method="get" target="_blank">
<input name="sitesearch" type="hidden" value="www.example.com" />
<input name="as_q" onfocus="this.value=''" type="text" size="20" value="Search www.example.com" title="Enter your search here" />
<input title="Begin Search" type="submit" value="Search" />
</form>
</div> 
```

`onfocus="this.value=''"`此外，一旦用户点击它，我是否真的需要使用 Javascript来清除“搜索 www.example.com”的文本/值。为什么这不起作用，我怀疑这是因为人们无法通过“定位”某些“属性”。CSS 并且给定的 HTML 属性没有“替代”CSS 属性。

```
input[type="text"]:focus
{
value: "";
} 
```

以上将失败，因为我不能（或者我可以？）定位 value 属性！但是对于像这样的非常小的功能使用 Javascript 似乎有点过头了。几乎就像使用 JS 来实现悬停效果而不是 CSS 伪：悬停。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:25:16.403

> 我为什么要使用或需要使用具有隐藏属性的额外输入元素来制作一个在内部搜索给定网站的网站搜索框。

您必须以某种方式告诉搜索引擎您要将搜索限制在特定站点。通常这是通过隐藏的输入字段完成的，因为当表单提交但不显示给用户时会包含该字段。

但是，它不需要是隐藏元素。你可以把它放在一个`text`, `radiobutton`,`checkbox`或`select`too 中。唯一的要求是将其发送到名称为“sitesearch”的搜索引擎，并带有您选择的网站的值。

> 一旦用户点击它，我真的需要使用Javascript onfocus =“this.value =''”来清除“搜索www.example.com”的文本/值吗？

您可以`value=''`从头开始设置并使用新的 html5 属性`placeholder='Search www.example.com'`。或者在页面的某处使用描述性文字。

> 但是对于像这样的非常小的功能使用 Javascript 似乎有点过头了。几乎就像使用 JS 来实现悬停效果而不是 CSS 伪：悬停。

您可能会认为这是矫枉过正，但多年来，这是唯一的方法。Javascript 早在 CSS 实现之前就已经在浏览器中了。悬停效果必须在 javascript 中实现，因为`:hover`直到 CSS2 才引入。您想在这种情况下使用的占位符效果最近才用 HTML5 实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T18:11:29.380

这`sitesearch`是传递给 google 的查询参数，它告诉 google 搜索特定网站，所以是的，这个属性是必需的，至于 javascript 代码， ~~我认为你可以通过`content`css3 的属性执行相同的操作，这将在现代浏览器中工作。~~

编辑：我尝试使用`content`但它似乎不起作用

# model-view-controller - 无法让 defroutes 在 webnoir 中工作

> ID：12238437
> 
> 赞同：1
> 
> 时间：2012-09-02T18:03:33.727
> 
> 标签：model-view-controller, web-applications, clojure, compojure, noir

所以，我是一个 clojure n00b，当我试图为我正在构建的项目获取路线时，我错过了一些东西。

我在循环依赖方面遇到了一些问题，在使用 Django 之后，我认为将路由全部定义在一个地方要好得多，而不是像使用`defpage`.

上代码：

这是我的`core.clj`文件：

```
(ns blktechies-home.core
  (:use compojure.core
        hiccup.middleware)
  (:require [compojure.route :as route]
            [blktechies-home.routes :as site-routes]
            [compojure.handler :as handler]
            [compojure.response :as response]))

(def app
  (-> (handler/site site-routes/app)
      (wrap-base-url))) 
```

然后在我的路线文件中，我有以下内容：

```
(ns blktechies-home.routes
  (:use compojure.core
        noir.core
        hiccup.middleware)
  (:require [compojure.route :as route]
            [compojure.handler :as handler]
            [compojure.response :as response]
            [blktechies-home.views.common :as common]))

(defroutes app
  (GET "/" [] (common/main-layout
               (welcome/index-page)))
  (route/resources "/")
  (route/not-found "<h1>NOPE</h1>")) 
```

一切都是404'ing，我什至不知道从这里去哪里。我可以使用该站点`defpage`，但随着路由数量的增加，它看起来很丑陋且不可扩展。

所以

*   我在这里做错了什么？对底层组合/clojure/ring 层的任何洞察都会很棒
*   如果这不是定义路线的最佳方式，那是什么？
*   github上有大型clj-noir网站的好例子吗？（我的 google-fu 让我失望了。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T08:07:08.337

也许您会发现此页面对[Global Noir Routes](http://www.flyingmachinestudios.com/programming/global-noir-routes/)很有帮助（实现了一个`defpage`允许在一个地方定义路线的宏变体）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T00:27:30.633

在 Noir 中，您可以将所有 defpage 放在同一个命名空间中，如果您想将它们全部放在同一个位置，则可以一个接一个。它们可以像委派给其他函数来完成“真正的”工作一样简单，就像您在示例中定义 (GET "/" ...) 路由的方式一样。

> 我在这里做错了什么？对底层组合/clojure/ring 层的任何洞察都会很棒

不知道你做错了什么，你的代码对我有用，只需进行一些最小的更改：

加载文件时只需添加 ring.adapter.jetty 即可启动码头服务器的核心：

```
 (ns blktechies-home.core
  (:use compojure.core
        hiccup.middleware
        [ring.adapter.jetty :only [run-jetty]])
  (:require [compojure.route :as route]
            [blktechies-home.routes :as site-routes]
            [compojure.handler :as handler]
            [compojure.response :as response]))

(def app
  (-> (handler/site site-routes/app)
    (wrap-base-url)))

(run-jetty app {:port 8080 :join? false}) 
```

您的路线文件，没有“views.common”命名空间：

```
 (ns blktechies-home.routes
  (:use compojure.core
        noir.core
        hiccup.middleware)
  (:require [compojure.route :as route]
            [compojure.handler :as handler]
            [compojure.response :as response]))

 (defroutes app
   (GET "/" [] "the root path")
   (route/resources "/")
   (route/not-found "<h1>NOPE</h1>")) 
```

现在开始repl：

```
lein repl 
```

并加载核心：

```
user=> (load-file "src/blktechies_home/core.clj")
#<Server Server@9ae1ab> 
```

并获得根：

```
wget http://localhost:8080/ -O - -q
the root path 
```

# android - 如何在文本视图附近显示“加载”图像

> ID：12238440
> 
> 赞同：0
> 
> 时间：2012-09-02T18:03:53.763
> 
> 标签：android

我需要一种在文本视图附近显示“加载”图像的方法。在我的应用程序中，一些数据会定期从服务器接收，当这些进程执行时，我需要向用户显示加载（等待）图像，如下图所示。

[示例图片 http://img685.imageshack.us/img685/1403/androidwait.png](http://img685.imageshack.us/img685/1403/androidwait.png)

然后，执行完成后，我希望加载图像从屏幕上消失。一段时间后，当异步任务开始再次接收一些数据时。此图像将再次显示。这所有过程将定期进行。我不使用 ProgressDialog。因为它覆盖了所有屏幕并让用户等待。

重要的一点：当图像消失时，它在布局中的区域将被文本视图使用，并且不会有空白。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T18:08:21.763

为什么不使用进度条？[http://developer.android.com/reference/android/widget/ProgressBar.html](http://developer.android.com/reference/android/widget/ProgressBar.html)

您可以在主 UI 内的任何位置对其进行充气，并使用 和 进行`progressBar.setVisibility(View.GONE)`操作`progressBar.setVisibility(View.VISIBLE)`。

请不要忘记仅在主 UI 线程中执行此操作。所以要么使用 AsyncTask 的 onPostExecute，要么使用`activity.runOnUiThread(Runnable)`.

**注意：** Android 中的 ProgressBar 可以有 2 种状态：水平的有进度，或者只是旋转的圆圈，就像你的截图一样。默认是第二个，所以这正是你想要的。

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T15:29:26.853

[本教程](http://www.example.com/)是我的问题的答案。当我们应用这个 xml 代码时，我们想在布局中显示旋转圆形进度条，

```
<ProgressBar
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         style="@android:style/Widget.ProgressBar.Small"
         android:layout_marginRight="5dp" /> 
```

似乎只是我想要的。

然后使用java代码来启动和停止它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:06:21.780

您可以在 asyntask 中放置一个图像视图

onPreExecute(){//Imageview 在此处设置为可见}

onPostExecute(){//在这里关闭imageview}

# entity-framework-4 - 克服实体框架中缺少 ConflictMode.ContinueOnConflict 实现的模式？

> ID：12238443
> 
> 赞同：2
> 
> 时间：2012-09-02T18:04:42.243
> 
> 标签：entity-framework-4, batch-processing, optimistic-concurrency

Linq To SQL`DataContext`有一个重载`SubmitChanges`，允许在抛出 Optimistic Concurrency Exception 时继续更新，并为开发人员提供了一种机制，以便之后在[单个 Try Catch 块](http://msdn.microsoft.com/en-us/library/system.data.linq.datacontext.changeconflicts%28v=vs.100%29.aspx)中解决冲突。

甚至它的方法也`WCFDataServicesContext`有一个`SaveChangedOptions.ContinueOnError`参数 `SaveChanges`，至少允许您在发生错误时继续更新，并使冲突更新未解决，以便您稍后查看它们。

(1) 那么为什么该`ObjectContext.SaveChanges`方法没有这样的选项呢？

(2) 是否存在任何模仿 Linq To SQL 行为的更新模式？我在 MSDN 上找到的示例使它看起来好像[单个 Try Catch 块](http://msdn.microsoft.com/en-us/library/bb336792.aspx)会在多次更新的情况下让您回家。但是这种模式不允许您单独调查每个有冲突的更新：它只是提醒您注意第一个冲突，然后让您选择“一次性清除表”以防止出现任何进一步的乐观并发异常，而无需您的知道是否存在，以及您希望如何处理它们。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T20:20:07.383

> 那么为什么 ObjectContext.SaveChanges 方法没有这样的选项呢？

我认为最简单的答案是因为 Linq-to-Sql、Entity Framework 和 WCF 数据服务都是由不同的团队实现的，这些团队之间的内部沟通并没有像我们希望的那样工作。[我在以前的一个答案](https://stackoverflow.com/a/6416147/413501)中描述了新 API 中缺少的一些有趣功能，但我不认为这是一个缺少的功能 - 我将在答案的第二部分中解释它。

WCF 数据服务有更多有趣的特性，它们也应该是实体框架的一部分。例如：

*   [更改和查询拦截器](http://msdn.microsoft.com/en-us/library/dd744842%28v=vs.100%29.aspx)
*   [批处理](http://msdn.microsoft.com/en-us/library/dd744839%28v=vs.100%29.aspx)多个查询和 SaveChanges 操作以对服务器进行一次调用
*   [异步操作](http://msdn.microsoft.com/en-us/library/dd756365%28v=vs.100%29.aspx)- 这将以 async/await 实现的形式出现在 EF6

> 是否存在任何模仿 Linq To SQL 行为的更新模式？

有一种模式可以解决这个问题，但你可能不会喜欢它。EF`SaveChanges`作为工作单元工作。它要么保存所有更改，要么不保存。如果您的保存操作可能会导致仅保留部分更改而不是单个`SaveChanges`调用来处理它。每个原子更改集都应该有自己的`SaveChanges`调用：

```
using (var scope = new TransactionScope(...)) {
    foreach (var entity in someEntitiesToModify) {
        try {
            context.SomeEntities.Attach(entity);
            context.ObjectStateManager.ChangeObjectState(entity, EntityState.Modified);
            context.SaveChanges();
        catch (OptimisticConcurrencyException e) {
            // Do something here 

            context.Refresh(e.StateEntries[0].Entity, RefreshMode.ClientWins);
            context.SaveChanges();
        }
    }

    scope.Complete();
} 
```

我认为此功能不存在的原因是因为它不是通用的，并且如上所述它违反了工作单元模式。假设这个例子：

*   你加载一个实体
*   您将新的依赖实体添加到加载实体的导航属性
*   你在加载的实体上改变了一些东西
*   与此同时，其他人同时删除了您加载的实体
*   您可以通过轻松解决冲突来触发 SaveChanges
*   EF 将尝试保存对主体实体的更改，但由于数据库中没有要更新的实体而发生冲突
*   EF 将继续，因为冲突解决已放宽
*   EF 将尝试插入依赖实体，但它会触发`SqlException`，因为数据库中不存在主体实体。此异常将破坏持久性操作，您将不知道为什么它抱怨引用完整性，因为您有一个主体实体。（由于上下文的内部状态不一致，此插入甚至可能不会发生，并且 EF 会触发另一个异常，但这取决于 EF 的内部实现）。

这立即使冲突解决的整体放松变得更加复杂。恕我直言，有三种解决方法：

*   根本不支持。如果您需要基于每个实体解决冲突，您仍然可以使用我上面展示的示例，但对于复杂的场景，它可能不起作用，因为复杂的场景很难解决。
*   每次发生冲突时重建数据库更改集——这意味着探索剩余的更改集，并从处理的持久性中排除与冲突实体及其关系等相关的所有实体。有一个问题：EF 无法从处理中排除任何已更改的实体。那会破坏工作单元的意义，我再重复一遍：放松冲突解决也会破坏工作单元的意义。
*   即使主体实体发生冲突，也让 EF 继续处理依赖关系。这需要处理数据库异常并了解其内容，以了解异常是由于主体冲突还是由于其他错误（应该立即使整个持久性操作失败）而触发的。在代码级别上理解数据库异常可能非常困难，而且它是针对每个受支持的数据库的提供程序特定的。

这并不意味着可能无法实现这样的功能，但它需要涵盖所有涉及关系的场景，这可能非常复杂。我不确定 Linq-to-Sql 是否可以处理这个问题。

您可以随时对[Data UserVoice](http://data.uservoice.com/forums/72025-entity-framework-feature-suggestions)提出建议或[查看代码](http://entityframework.codeplex.com/)并尝试自己实现。也许我觉得这个功能太复杂了，很容易实现。

# c# - 监控互联网连接状态

> ID：12238444
> 
> 赞同：2
> 
> 时间：2012-09-02T18:05:02.803
> 
> 标签：c#, wpf, http, monitoring, network-monitoring

我尝试实现（在**WPF**，*C#*中）`Ellipse`控件，该控件根据与[google.com](http://www.google.com/)的连接来改变其颜色。*如果与Google*有连接，椭圆为绿色；否则它是红色的。

我是这样编码的：

XAML 代码

```
<Window.Resources>
    <l:InternetConnectionToBrushConverter x:Key="InternetConnectionConverter" />
</Window.Resources>
<Grid>
    <DockPanel LastChildFill="True">
        <StatusBar Height="23" Name="statusBar1" VerticalAlignment="Bottom" DockPanel.Dock="Bottom">
            <Label Content="Google connection:" Name="label1" FontSize="10" Padding="3" />
            <Ellipse Name="ellipse1" Stroke="Black" Width="10" Height="10" Fill="{Binding Converter={StaticResource InternetConnectionConverter}}" Margin="0,4,0,0" />
        </StatusBar>
    </DockPanel>
</Grid> 
```

和 C# 代码后面（值转换器和函数检查连接）：

```
public class InternetConnectionToBrushConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        if (targetType != typeof(Brush))
            throw new InvalidOperationException("The target must be a Brush!");

        return CheckConnection("http://www.google.com/") == true ? Brushes.Green : Brushes.Red;
    }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
    {
        throw new NotSupportedException();
    }

    /// <summary>
    /// Checks connection to specified URL. 
    /// </summary>
    /// <param name="URL"></param>
    /// <returns><b>True</b> if there is connection. Else <b>false</b>.</returns>
    private bool CheckConnection(String URL)
    {
        try
        {
            HttpWebRequest request = WebRequest.Create(URL) as HttpWebRequest;
            request.Timeout = 15000;
            request.Credentials = CredentialCache.DefaultNetworkCredentials;
            HttpWebResponse response = request.GetResponse() as HttpWebResponse;

            return response.StatusCode == HttpStatusCode.OK ? true : false;
        }
        catch (Exception e)
        {
            Debug.WriteLine(e.ToString());
            return false;
        }
    }

} 
```

它运作良好，但有两个问题：

1.  检查连接需要一些时间，所以我认为我应该在新线程中进行（如果我错了，请告诉我原因）
2.  更重要的是——它只检查一次与[谷歌](http://www.google.com/)的连接，当程序开始运行时（尽管我使用绑定，所以我希望会有持续的连接监控）

我应该如何解决这个问题？
我想要持续监控连接，这样当我断开互联网连接时，`Ellipse`控件会改变它的颜色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:18:12.100

你必须稍微改变你的架构。
您不能使用线程`IValueConverter`来避免锁定 UI。在从`IValueConverter`.

您需要创建一个`HasConnection`属性来将椭圆颜色绑定到。然后，您可以在另一个线程中运行连接检查。最好通过使用`BackgroundWorker`. `HasConnection`检查完成后，应更新该属性。然后，您可以使用计时器并定期检查您的连接，并`HasConnection`在每次检查后更新。

**编辑**
您还可以监视[`NetworkChange.NetworkAvailabilityChanged`](http://msdn.microsoft.com/en-us/library/system.net.networkinformation.networkchange.networkavailabilitychanged%28v=vs.90%29.aspx)事件以了解本地网络连接何时启动或关闭。但是，您希望确保您可以实际连接到您的目标，您应该保留旧的`CheckConnection`，但`CheckConnection`在启动时调用，当网络可用性发生变化时并定期在计时器上调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T00:05:22.650

使用background worker在后台监控，使用ReportProgress获取当前状态

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
{
    // Get the BackgroundWorker that raised this event.
    BackgroundWorker worker = sender as BackgroundWorker;

    bool connected = false;
    string url = "https://www.google.com/";

    while (!worker.CancellationPending)
    {
        try
        {
            HttpWebRequest request = WebRequest.Create(url) as HttpWebRequest;
            request.Timeout = 15000;
            request.Credentials = CredentialCache.DefaultNetworkCredentials;
            HttpWebResponse response = request.GetResponse() as HttpWebResponse;

            connected = (response.StatusCode == HttpStatusCode.OK);
            backgroundWorker1.ReportProgress(10, connected);
            Thread.Sleep(1000);

        }
        catch (Exception ex)
        {
            System.Diagnostics.Debug.WriteLine(ex.ToString());
            e.Cancel = true;
            e.Result = "cancelled";

            //return false;
        }
    }
    e.Result = connected;
}

private void backgroundWorker1_ProgressChanged(object sender,
    ProgressChangedEventArgs e)
{
    this.tbResult.Text = e.ProgressPercentage.ToString();
    System.Diagnostics.Debug.WriteLine(e.UserState.ToString());
} 
```

# nsis - 创建卸载程序时出错

> ID：12238451
> 
> 赞同：0
> 
> 时间：2012-09-02T18:05:44.830
> 
> 标签：nsis, uninstallation

我使用 NSIS 和下面给出的代码创建了一个安装程序。安装程序已成功创建，但是当我在 pc 中安装程序时，在第一次安装期间未创建卸载程序，但是当我再次安装时，卸载程序已成功创建>我能做些什么请帮助...我的 nsi 脚本：

```
# declare name of installer file

!define PRODUCT_NAME "NepHotel"

Name "NepHotel"
outfile "NepHotel_setup.exe"
InstallDir $PROGRAMFILES\NepHotel

RequestExecutionLevel user

Page directory
Page instfiles

# open section
section ""

CreateShortCut "$DESKTOP\${PRODUCT_NAME}.lnk" "$INSTDIR\${PRODUCT_NAME}.exe" ""

;create start-menu items
CreateDirectory "$SMPROGRAMS\NepHotel"
CreateShortCut "$SMPROGRAMS\NepHotel\${PRODUCT_NAME}.lnk"          "$INSTDIR\${PRODUCT_NAME}.exe" "" "$INSTDIR\${PRODUCT_NAME}.exe" 0
CreateShortCut "$SMPROGRAMS\NepHotel\Readme.lnk" "$INSTDIR\user.props" "" "$INSTDIR\user.props" 0
CreateShortCut "$SMPROGRAMS\NepHotel\uninstall.lnk" "$INSTDIR\uninstall.exe" 1

;write uninstall information to the registry
 WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\NepHotel" \
             "DisplayName" "${PRODUCT_NAME}"
 WriteRegStr HKLM "Software\Microsoft\Windows\CurrentVersion\Uninstall\NepHotel" \
             "UninstallString" "$\"$INSTDIR\Uninstall.exe$\""

  WriteUninstaller "$INSTDIR\Uninstall.exe"

SetOutPath $INSTDIR
File NepHotel.exe
File user.props

# end the section
sectionEnd

;Uninstaller Section  
Section "Uninstall"

;Delete Files 
  RMDir /r "$INSTDIR\*.*"    

;Remove the installation directory
  RMDir "$INSTDIR"

;Delete Start Menu Shortcuts
  Delete "$DESKTOP\${PRODUCT_NAME}.lnk"
  Delete "$SMPROGRAMS\${PRODUCT_NAME}\*.*"
  RmDir  "$SMPROGRAMS\${PRODUCT_NAME}"

;Delete Uninstaller And Unistall Registry Entries
 enter code here DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\${PRODUCT_NAME}"
  DeleteRegKey HKEY_LOCAL_MACHINE "SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall    \${PRODUCT_NAME}"  

SectionEnd

Function .onInstSuccess
  MessageBox MB_OK "You have successfully installed ${PRODUCT_NAME}. Use the desktop icon to     start the program."
FunctionEnd 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:34:18.337

放在`SetOutPath $INSTDIR`调用之前`WriteUninstaller`。

您不能使用`RequestExecutionLevel user`然后安装到 $Programfiles/HKLM，您需要请求管理员权限：

```
Outfile RequireAdmin.exe

; BEGIN 8< 8< 8< 8< 8< 8< 8< 8<

RequestExecutionLevel admin ;Require admin rights on NT6+ (When UAC is turned on)

!include LogicLib.nsh

Function .onInit
UserInfo::GetAccountType
pop $0
${If} $0 != "admin" ;Require admin rights on NT4+
    MessageBox mb_iconstop "Administrator rights required!"
    SetErrorLevel 740 ;ERROR_ELEVATION_REQUIRED
    Quit
${EndIf}
FunctionEnd

; END >8 >8 >8 >8 >8 >8 >8 >8

Page InstFiles

Section
SectionEnd 
```

# actionscript-3 - as3 循环加载 url - 完成后继续循环

> ID：12238460
> 
> 赞同：0
> 
> 时间：2012-09-02T18:07:02.623
> 
> 标签：actionscript-3, flash, for-loop

我正在尝试按顺序加载一堆文件。我希望另一个在下载前一个后开始下载。我认为最好的方法是通过 for 循环。

TheURL = 是一个 ARRAY 中的一堆 url

```
for(var i:int=0;i<TheURL.length;i++)
{
    var urlString:String = TheURL[i];
    var urlReq:URLRequest = new URLRequest(urlString);
    var urlStream:URLStream = new URLStream();
    var fileData:ByteArray = new ByteArray();
    urlStream.addEventListener(Event.COMPLETE, loaded);
    urlStream.load(urlReq);

function loaded(event:Event):void
    {
        /// code to continue loop
    }

} 
```

重要的是，其他人在前一个完成之前不要开始下载。关于如何做到这一点的任何建议？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T18:24:18.737

```
function downloadFiles():void
{
    downloadNextFile();
}

function downloadNextFile():void
{
    var urlString:String = TheURL.shift();
    var urlReq:URLRequest = new URLRequest(urlString);
    var urlStream:URLStream = new URLStream();
    var fileData:ByteArray = new ByteArray();
    urlStream.addEventListener(Event.COMPLETE, loaded);
    urlStream.load(urlReq);
}

function loaded(event:Event):void
{
     downloadNextFile();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T18:28:36.730

使用 for 循环并不能解决您想要做的事情。

在我看来，最简单的方法应该是使用 URL 数组作为队列。这可以通过使用来完成`Array.shift()`。但是，如果您在完成后需要原始 URL 集，则应该复制您的数组，因为`shift()`对数组进行内联修改。

解决方案可能如下：

```
function loadQueue(urlQueue:Array):void
{
    var url:String = urlQueue.shift();
    var request:URLRequest = new URLRequest(url);
    var stream:URLStream = new URLStream();
    var data:ByteArray = new ByteArray();

    var completeHandler:Function = function(event:Event)
    {
        // remove listener from stream to be a clean coder ;)
        stream.removeEventListener(Event.COMPLETE, completeHandler);

        // handle completion in the way you need ...

        // continue with the next element
        if (urlQueue.length > 0)
           loadQueue(urls);
    }

    urlStream.addEventListener(Event.COMPLETE, loaded);
    urlStream.load(urlReq);
} 
```

加载您的队列将如下所示：

```
loadQueue(TheURL.concat()); // concat() will clone your array 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:39:03.527

您应该使用像 greensock LoaderMax [http://www.greensock.com/loadermax/](http://www.greensock.com/loadermax/)这样的库。
这比创建自己的加载队列要困难得多。有很多错误、陷阱和特殊情况需要处理。它似乎工作正常，有一天一位客户回电给你，因为这个防火墙后面的这台计算机上的这个特定的闪存版本存在一个错误......我已经开始做我的库，但最后我使用了 LoadManager。

# java - 用于在远程桌面上工作的 Java IDE

> ID：12238461
> 
> 赞同：1
> 
> 时间：2012-09-02T18:07:14.070
> 
> 标签：java, ide, remote-desktop

我最近发现任何 Swing（NetBeans，IDEA）在远程桌面（RDP）上绘制 UI 的速度都非常慢。

你们能给我一些建议吗？可以通过 RDP 正常工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:11:26.107

实际上，与我所看到的一切相反——主要是在许多地方提到的**"Dsun.java2d.noddraw=true"**，实际上将它设置为 false 以解决绘图问题（至少对我而言）。去搞清楚。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T18:29:11.227

RDP 针对原生 Windows 应用程序进行了优化，遗憾的是，较旧的 (XP/Server 2003) 版本相比，较新版本的 RCP（如 Vista/Win7 的默认 RDP）对非原生应用程序*更具敌意。*这是一个很好的链接：

*   [http://devnet.jetbrains.net/thread/280673](http://devnet.jetbrains.net/thread/280673)

*   [http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4204845](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4204845)

一种解决方法是获得快速的 CPU/显卡、大量内存和超高速网络连接 :)

另一个是：

*   在终端服务设置中选择“32 位真彩色”

*   选择“调制解调器”

*   降低屏幕分辨率（见鬼，尽可能使用 1024x768）

以下是一些额外的提示：

*   [http://www.codinghorror.com/blog/2006/04/remote-desktop-tips-and-tricks.html](http://www.codinghorror.com/blog/2006/04/remote-desktop-tips-and-tricks.html)

*   尝试设置“Dsun.java2d.noddraw=true”

[http://ubuntuforums.org/archive/index.php/t-1129187.html](http://ubuntuforums.org/archive/index.php/t-1129187.html)

[http://www.mindfiresolutions.com/Solving-DIRECT-DRAW-ddraw-problems-in-Java-Swing-730.php](http://www.mindfiresolutions.com/Solving-DIRECT-DRAW-ddraw-problems-in-Java-Swing-730.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-11T10:13:24.193

我正在从 Linux 启动一个 java swing 应用程序，并通过 MobaXterm 将其显示为 Windows 框架。

如果您还没有这样做，请查看以下文档： [https ://docs.oracle.com/javase/8/docs/technotes/guides/2d/flags.html](https://docs.oracle.com/javase/8/docs/technotes/guides/2d/flags.html)

使用`-Dsun.java2d.noddraw=true`并没有解决我的问题，但设置`xrender`为解决`true`。

所以这是我在 Linux 上使用的代码：

```
export _JAVA_OPTIONS='-Dsun.java2d.xrender=true'
java -jar my_java_application.jar 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T18:15:01.350

也许不仅仅是 Swing 在远程桌面上画得慢。但是，Eclipse 是基于 SWT，基于原生小部件，所以它不是 Swing。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T19:43:37.750

你应该试试[JavaWIDE](http://javawide.org/index.php/Main_Page)。它是一个 IDE，设计用于访问没有安装在系统上的 JDK，具有内置存储系统，因此您只需要访问 Internet。它不完全是用于访问计算机上所有内容的程序，但它会很好地完成您的编程。然而，这可能需要一段时间，因为编译是在单独的服务器上完成的。

# vim - 使用 Janus 更改 VIM 中的缩进设置

> ID：12238462
> 
> 赞同：2
> 
> 时间：2012-09-02T18:07:18.917
> 
> 标签：vim, janus

我正在尝试更改我的 vim 配置上的缩进设置，当前设置为 2 个空格。但是手动更改 vimrc.old 和 vimrc.after 或使用该`echo 'setting' >> ~/.vimrc.after`方式都不会更改设置。如何使用 Janus 更改缩进设置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-26T20:57:47.010

实际上，您不必放弃 Janus。我自己真的很喜欢 janus（对于颜色主题）。

只需创建一个文件`~/.vimrc.after`

在文件中，将制表符设置为 4 个空格`set tabstop=4`

那么janus会在janus之后加载.vimrc.after文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:43:44.867

删除 Janus 并使用常规的`~/.vimrc`.

或者，您可以键入`:verbose set {setting}`以查看`{setting}`设置的位置。这里的“问题”是 Vim 可能会使用一堆缩进设置：试试上面的代码：

```
tabstop
softtabstop
shiftwidth 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-17T13:04:20.653

我发现的最好方法是在 ~/.janus 文件夹中创建一个文件夹（我们称之为 mysettings）

在*~/.janus/mysettings/after/ftplugin/*中创建一个文件，其名称为您希望更改缩进的文件类型的名称。对于 cpp 它将是*cpp.vim*

然后在这个文件中设置你想要使用的缩进样式，在我的例子中：

```
setlocal noexpandtab
setlocal tabstop=4
setlocal shiftwidth=4
setlocal softtabstop=4
setlocal textwidth=0 
```

然后在你的*.vimrc.after*放一行

```
filetype plugin indent on 
```

# java - 获取磁盘签名？

> ID：12238464
> 
> 赞同：2
> 
> 时间：2012-09-02T18:07:51.513
> 
> 标签：java, windows, disk

使用Java，是否可以获得驱动器的所谓Windows“磁盘签名”？我知道我可以以某种方式解析 diskpart 的输出，但这不是一个很好的解决方案）：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:46:59.623

我没有使用 Java 尝试过，但我之前通过 Python 使用过[Windows Management Instrumentation](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394582%28v=vs.85%29.aspx)，发现这是一种使用 Windows 的非常愉快的方式。磁盘签名在[Win32_DiskDrive](http://msdn.microsoft.com/en-us/library/windows/desktop/aa394132%28v=vs.85%29.aspx)的 Signature 属性中可用。

[使用 WMI 和 java 的推荐库/howtos](https://stackoverflow.com/questions/4610063/recommended-libraries-howtos-for-using-wmi-with-java)的答案？提到了一些 Java 到 COM 的桥接器，它们可以让您利用 api 并提到[这个站点](http://www.vijaykandy.com/2009/09/windows-management-instrumentation-wmi-from-java/)，它看起来像是一个很好的例子，说明了如何从 Java 访问 WMI。

# .htaccess - htaccess 重写导致 500 内部服务器错误

> ID：12238467
> 
> 赞同：0
> 
> 时间：2012-09-02T18:08:09.983
> 
> 标签：.htaccess

我正在尝试使用 htaccess 获取漂亮的 url，用于 SLIR 图像调整大小插件。

我想重写如下内容：

**重写前：**
localhost/img/600x400/slider/image.jpg

**重写后**
localhost/application/public/slir/index.php?r=slir&w=600&h=400&i=img/slider/image.jpg

但以下代码返回 500 Internal server error ...

```
<IfModule mod_rewrite.c>

RewriteEngine On
RewriteBase /

RewriteRule ^(.*)/([0-9]{1,4})x([0-9]{1,4})/(.*)\.(gif|jpg|jpeg|png) application/public/slir/index.php?r=slir&w=$2&h=$3&i=$1/$4.$5 [NC,NE,QSA,L]

</IfModule> 
```

请帮我.....

* * *

# **更新**

我以为是文件权限问题...所以我检查了所有相关的目录和文件，令人惊讶的是所有目录和文件都是 755/644。
然后我直接检查了**/application/public/slir/index.php**。它无法访问。

我在同一个 slir 目录中创建了另一个名为**hello.php的文件，并且可以访问****hello.php**。
然后我将 SLIR 目录移动到另一个名为**public**的文件夹中。在这里，**index.php**和**hello.php**都可以访问。

之后，我将 SLIR 目录移回原来的**脚本**文件夹。在**scripts**文件夹中，可以访问**hello.php**，但无法访问**index.php 。**
现在，这两个文件具有相同的权限并且在同一个文件夹中..我不知道这里发生了什么......：/：/

**有人请帮助我......**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T22:54:39.650

万一其他人在看这个 - 我发现的问题是 htaccess 文件中的这两行：

```
php_value auto_prepend_file none 
```

&

```
php_value auto_append_file none 
```

有些服务器不允许它们。

将它们移到我的`php.ini`文件中为我解决了这个问题：

```
auto-prepend-file = none

auto-append-file = none 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:18:56.540

查询字符串中通常禁止使用斜杠，但您可以通过设置 [AllowEncodedSlashes](http://httpd.apache.org/docs/2.2/mod/core.html#allowencodedslashes)指令来启用它们。

您可能还希望您的重写规则对斜杠使用百分比编码（即 %2F），因此在重写后： `localhost/application/public/slir/index.php?r=slir&w=600&h=400&i=img%2Fslider%2Fimage.jpg`

另请参阅[如何配置 apache php 以接受查询字符串中的斜杠](https://stackoverflow.com/questions/462082/how-do-you-configure-apache-php-to-accept-slashes-in-query-strings)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:17:28.233

这可能是因为您正在使用基于 Windows 的编辑器（如记事本）编辑 .htaccess 文件。记事本向文件中添加了一些您看不到的字符，但它们与 .htaccess 混淆了。我建议使用 Notepad++ 之类的编辑器并将模式设置为 Unix，这样它就不会与服务器混淆。从技术上讲，这是因为 Linux 和 Windows 具有不同类型的 EOL（行尾），因此记事本会添加一些字符每行的末尾转到下一行，但 Unix 不会识别它们，因为它有自己的 EOL 类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-03T01:53:07.760

重复，措辞非常不同：

[有人在子域网站上使用过 Smart Image Resizer 吗？](https://stackoverflow.com/questions/3761733/has-anyone-used-smart-image-resizer-on-subdomain-sites)

问题是子域...

# python-3.x - 得到错误的答案

> ID：12238469
> 
> 赞同：0
> 
> 时间：2012-09-02T18:08:24.480
> 
> 标签：python-3.x

我是 python 编程的新手。我正在上我的第一节课。我必须纠正一个程序来计算一个人的 BMI 等级。我在一些在线计算器上进行了计算，得到了 42.61 的答案。但是通过我的程序，我得到的答案是 0.05918367346938776。我检查了excel中的计算并得到了正确的答案，所以我知道我的公式基本上是正确的。我错过了什么？

这是我的代码：

```
weight_str = input("Enter your weight in pounds: ")
height_str = input ("Enter your height in inches: ")
weight = float(weight_str)
height = float(height_str)
weight_in_kilo = (weight * 0.453592) #convert pounds to kg
height_in_meters = (height * 0.0254) #convert inches to meter
bmi = weight / (height**2)
print ("Your BMI is: ",bmi) 
```

感谢对新手的帮助。

玻利弗

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T18:12:34.430

您将重量转换为公斤和米，但在计算中使用磅和英寸。

```
bmi = weight / (height**2) 
```

应该

```
bmi = weight_in_kilo / (height_in_meters**2) 
```

对于英制转换，谷歌告诉我们公式是 `bmi = (weight / (height**2)) * 703`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-02T18:13:04.123

您在计算 时使用了`weight`and`height`而不是`weight_in_kilo`and`height_in_meters``bmi`

# xcode - 下载图片，在 UIImageView 中显示，并排序

> ID：12238470
> 
> 赞同：0
> 
> 时间：2012-09-02T18:09:12.283
> 
> 标签：xcode, arrays, sorting, uiimageview

好的，伙计们，我对目标 C 很陌生。我有一个应用程序，它从我的网络服务器下载图像列表，并在 UIImage 视图中显示适当的图像，并通过滑动手势向前或向后移动下一张/上一张图片显示。目前图片的命名格式是这样的：

```
uploaded_141_admin1.png
uploaded_141_admin2.png
uploaded_141_interior1.png
uploaded_141_interior2.png
uploaded_141_exterior1.png 
```

当前代码将每张图片加载到文件名中间部分有 141 的视图中（或者用户在... 141 上的任何记录在这种情况下是可变的，此处仅显示格式示例）。问题是，它们的显示顺序似乎没有押韵或原因。我希望它使用文件名的最后一部分按字母顺序排序（甚至整个文件名，因为它会达到相同的结果）。在上面的示例中，它会在滑动 uiimageiew 时按以下顺序显示下载的图片：

```
uploaded_141_admin1.png
uploaded_141_admin2.png
uploaded_141_exterior1.png
uploaded_141_interior1.png
uploaded_141_interior2.png 
```

我已经搜索但找不到我要找的东西（可能是因为我使用了错误的搜索条件）。这是我现有的代码，用于下载并显示 UIImageView 中的图像。我假设“排序”代码会在这里某处：

```
-(void)downloadPictures:(NSArray *)picPaths {
    ELog(@"Downloading pictures: %@",picPaths);
    // wait indicator
    [[WaitingView sharedInstance] setMessage:LocStr(@"Loading pictures... The more pictures there are, the longer this will take.  Please be patient.")];
    [[WaitingView sharedInstance] showIndicator:YES];
    [[WaitingView sharedInstance] displayOn:[self view]];
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];
    //  queue download operation 
    NSOperationQueue *queue = [[NSOperationQueue alloc] init];
    NSInvocationOperation *downloadOp = [[NSInvocationOperation alloc] initWithTarget:self selector:@selector(downloadOperation:) object:picPaths];
    [queue addOperation:downloadOp];
}

-(void)downloadOperation:(NSArray *)picPaths {
    NSMutableArray *allPictures = [[NSMutableArray alloc] init];
    for(NSString *path in picPaths) {
        NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"http://%@%@/%@/%@",SERVER_ADDRESS,SERVER_PORT,SERVER_PHOTOS,path]];
        NSData *picData = [NSData dataWithContentsOfURL:url];
        if(picData!=nil) {
            UIImage *img = [UIImage imageWithData:picData];
            if(img!=nil) {
                [allPictures addObject:img];    
            } else {
                ELog(@"Failed to convert data to image from url %@",url);
            }
        } else {
            ELog(@"Failed to download image from url %@",url);
        }
    }
    [[WaitingView sharedInstance] performSelectorOnMainThread:@selector(remove) withObject:nil waitUntilDone:NO];
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    self.pictures=allPictures;
    if([self.pictures count]==0) {
        [self performSelectorOnMainThread:@selector(downloadErrorMessage) withObject:nil waitUntilDone:NO];
    } else {
        self.currentIndex=0;
        [self performSelectorOnMainThread:@selector(showPicture) withObject:nil waitUntilDone:NO];
    }
}

-(void)downloadErrorMessage {
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Oooops!" message:LocStr(@"Pictures download failed") delegate:nil cancelButtonTitle:LocStr(@"Close") otherButtonTitles:nil];
    [alert show];
    [alert release];    
    [self goBack];
}

-(void)showPicture {
    UIImage *image = [self.pictures objectAtIndex:self.currentIndex];
    ELog(@"Now displaying image with index %d: %@",self.currentIndex,image);
    self.picture.image=image;
    [self.picture setNeedsLayout];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:34:11.233

在您的`downloadPictures:`方法中，您应该`picPaths`在开始下载操作之前将您的数组排序为您想要的图像顺序。您可以通过使用 NSArray 方法创建一个新的排序数组来做到这一点`sortedArrayUsingSelector:`。用作排序的选择器`caseInsensitiveCompare:`将按字母顺序排列数组中的 NSString。

```
NSArray *sortedPicPaths = [picPaths sortedArrayUsingSelector:@selector(caseInsensitiveCompare:)]; 
```

然后，当您初始化 NSInvocationOperation 时，将排序后的数组作为对象传递。

# ios - 扫描设备和服务时找不到外围设备，iPad 3 丢失

> ID：12238475
> 
> 赞同：1
> 
> 时间：2012-09-02T18:09:36.770
> 
> 标签：ios, core-bluetooth

我在我的 MAC 应用程序中使用 CBManager 来发现我的 iPad3 设备，但没有找到。

我的一段代码在我的 Mac 应用程序中基于这篇文章： [在扫描特定服务 CBUUID 时找不到外围设备](https://stackoverflow.com/questions/11216248/cannot-find-peripheral-when-scanning-for-specific-service-cbuuid)

在这两个简单的代码中：

```
 _centralMan = [[CBCentralManager alloc] initWithDelegate:self queue:nil];
 [_centralMan scanForPeripheralsWithServices:nil options:nil]; 
```

和代表

```
- (void)centralManager:(CBCentralManager *)central didDiscoverPeripheral:(CBPeripheral *)peripheral advertisementData:(NSDictionary *)advertisementData RSSI:(NSNumber *)RSSI 

{
NSLog(@"Did discover peripheral. peripheral: %@ rssi: %@, UUID: %@ advertisementData: %@ ", peripheral, RSSI, peripheral.UUID, advertisementData);
//Do something when a peripheral is discovered.
} 
```

但它没有找到并记录我的 iPad3 设备。

蓝牙已开启。我正在使用 Mac mini 和 iPad3。

怎么了 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:54:10.533

您的 Mac 应用程序正在寻找蓝牙外围设备。iOS 无法充当蓝牙外围设备，除非您运行仍在 NDA 下的 iOS 6 测试版。如果您询问 iOS 6 的功能，您应该在 Apple 的开发者论坛上提问，而不是 Stack Overflow。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T07:08:20.397

我建议观看[WWDC 2012 视频](https://developer.apple.com/videos/wwdc/2012/) **Advanced Core Bluetooth**的 Session 705 。

有一个简短的演示，说明如何使用 iOS 设备作为外围设备创建服务器/客户端关系。

也调查一下**`CBPeripheralManmager`**。

# node.js - 运行节点 bin 脚本时确定命令行工作目录

> ID：12238477
> 
> 赞同：147
> 
> 时间：2012-09-02T18:10:39.070
> 
> 标签：node.js, command-line, npm

我正在创建一个节点命令行界面。它是全局安装的，并使用 bin 文件来执行。

我计划在我正在处理的文件的根目录中打开一个命令窗口，然后只运行命令，但是我无法确定当前的工作目录，因为`process.cwd()`它正在返回节点包的目录。我最初假设由于代码是使用批处理文件作为包装器执行的（这就是 bin 文件在开始时可以在没有节点的情况下执行的方式），因此这是不可能的，但 coffee-script 设法做到了。我查看了咖啡脚本源，但无法遵循（经验不足）。

要自己测试它，请使用此 package.json 文件创建一个包：

```
{
  "name": "test-package",
  "version": "1.0.0",
  "bin": {
    "test-package":  "./bin/test-package"
  },
  "main": "/lib/test"
} 
```

bin中的这个测试包文件：

```
#!/usr/bin/env node

var path = require('path');
var fs   = require('fs');
var lib  = path.join(path.dirname(fs.realpathSync(__filename)), '../lib');

require(lib + '/test'); 
```

任何人都可以对此有所了解。

然后尝试获取 lib/test 中的命令行目录。

* * *

## 回答 #1

> 赞同：226
> 
> 时间：2012-09-02T20:55:03.743

*   `process.cwd()`如果它没有被应用程序内部的“process.chdir”更改，则返回执行命令的目录（不是节点包的目录）。
*   `__filename`返回放置文件的绝对路径。
*   `__dirname`返回目录的绝对路径`__filename`。

如果您需要从模块目录加载文件，则需要使用相对路径。

```
require('../lib/test'); 
```

代替

```
var lib  = path.join(path.dirname(fs.realpathSync(__filename)), '../lib');

require(lib + '/test'); 
```

它总是相对于它调用的文件，并且不依赖于当前的工作目录。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2018-04-17T10:33:58.250

## 当前工作目录

要获取当前工作目录，您可以使用：

```
process.cwd() 
```

但是，请注意，某些脚本，尤其是 gulp，会使用`process.chdir()`.

## 节点模块路径

您可以通过以下方式获取当前模块的路径：

*   `__filename`
*   `__dirname`

## 原始目录（启动命令的位置）

如果您从命令行运行脚本，并且想要运行脚本的原始目录，无论脚本当前在哪个目录中运行，您都可以使用：

```
process.env.INIT_CWD 
```

## 使用 NPM 脚本时的原始目录

有时需要在当前目录而不是项目的根目录中运行 NPM 脚本。

此变量在 npm 包脚本中可用：

```
$INIT_CWD. 
```

您必须运行最新版本的 NPM。如果此变量不可用，请确保 NPM 是最新的。

这将允许您访问 package.json 中的当前路径，例如：

```
scripts: {
  "customScript": "gulp customScript --path $INIT_CWD"
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-10-29T19:57:03.493

`path.resolve('.')`也是一个可靠且干净的选择，因为我们几乎总是`require('path')`. 它将为您提供调用它的目录的绝对路径。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-03-18T22:28:13.437

或者，如果您只想获取当前 NodeJS 脚本的当前目录，您可以尝试类似这样的简单操作。请注意，这在 Node CLI 本身中不起作用：

```
var fs = require('fs'),
    path = require('path');

var dirString = path.dirname(fs.realpathSync(__filename));

// output example: "/Users/jb/workspace/abtest"
console.log('directory to start walking...', dirString); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-22T15:23:10.847

这对我有用：

```
console.log(process.mainModule.filename); 
```

# java - Android：在片段中填充 ListView

> ID：12238481
> 
> 赞同：1
> 
> 时间：2012-09-02T18:11:10.033
> 
> 标签：java, android, listview, android-activity, fragment

我有一个填充 ListView 的活动，它正在工作。因为我使用标签 ViewPager，所以我必须使用片段而不是活动。所以有人可以告诉我我需要改变什么来从我的活动中制作一个片段（FragmentActivity 不能在选项卡中使用）。

```
package com.basnijkamp.safanagendatest;

import java.util.HashMap;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;

import android.app.Activity;
import android.os.Bundle;
import android.widget.ListView;
import android.widget.SimpleAdapter;

public class ListSample extends Activity {  

    public final static String ITEM_TITLE = "title";  
    public final static String ITEM_CAPTION = "caption";  

    public Map<String,?> createItem(String title, String caption) {  
        Map<String,String> item = new HashMap<String,String>();  
        item.put(ITEM_TITLE, title);  
        item.put(ITEM_CAPTION, caption);  
        return item;  
    }  

    @Override  
    public void onCreate(Bundle icicle) {  
        super.onCreate(icicle);  

        List<Map<String,?>> september2012 = new LinkedList<Map<String,?>>();  
        september2012.add(createItem("Electra Mining Africa 2012", "Johannesberg South Africa"));  
        september2012.add(createItem("MSV", "Brno Czech Republic"));  
        september2012.add(createItem("IMTS", "Chicago USA"));
        september2012.add(createItem("AMB", "Stuttgart Germany"));  
        september2012.add(createItem("Den Teknise Messe", "Lillestrom Norway"));  
        september2012.add(createItem("ITM", "Plovdiv Bulgaria"));  

        List<Map<String,?>> oktober2012 = new LinkedList<Map<String,?>>();  
        oktober2012.add(createItem("BIMU", "Milan Italy"));  
        oktober2012.add(createItem("Matek", "Istanbul"));
        oktober2012.add(createItem("TIB", "Bucharest Romania"));
        oktober2012.add(createItem("Vienna Tec", "Vienna Austria"));
        oktober2012.add(createItem("Euro Blech 2012", "Hanover Germany"));
        oktober2012.add(createItem("Technica Massan", "Stockholm Sweden"));

        List<Map<String,?>> november2012 = new LinkedList<Map<String,?>>();  
        november2012.add(createItem("JIMTOF", "Tokyo Japan"));
        november2012.add(createItem("Metavak", "Gorinchem Netherlands"));
        november2012.add(createItem("FABTECH", "Las Vegas USA"));
        november2012.add(createItem("Prodex", "Basel Switzerland"));
        november2012.add(createItem("EMAF 2012", "Porto Portugal"));
        november2012.add(createItem("Manufact Indonesia", "Jakarta Indonesia"));

        // create our list and custom adapter  
        SeparatedListAdapter adapter = new SeparatedListAdapter(this);  
        adapter.addSection("September 2012", new SimpleAdapter(this, september2012, R.layout.list_complex,   
            new String[] { ITEM_TITLE, ITEM_CAPTION }, new int[] { R.id.list_complex_title, R.id.list_complex_caption }));
        adapter.addSection("Oktober 2012", new SimpleAdapter(this, oktober2012, R.layout.list_complex,   
            new String[] { ITEM_TITLE, ITEM_CAPTION }, new int[] { R.id.list_complex_title, R.id.list_complex_caption }));
        adapter.addSection("November 2012", new SimpleAdapter(this, november2012, R.layout.list_complex,   
                new String[] { ITEM_TITLE, ITEM_CAPTION }, new int[] { R.id.list_complex_title, R.id.list_complex_caption }));

        ListView list = new ListView(this);  
        list.setAdapter(adapter);  
        this.setContentView(list);  

    }  

} 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:17:29.317

我建议您扩展 ListFragment - [http://developer.android.com/reference/android/app/ListFragment.html](http://developer.android.com/reference/android/app/ListFragment.html)。

所以从这里：

```
 ListView list = new ListView(this); 
        list.setAdapter(adapter); 
        this.setContentView(list); 
```

你应该做这个：

```
 setListAdapter (adapter); 
```

从

```
@Override 
public void onCreate(Bundle icicle) { 
        super.onCreate(icicle); 
```

->

```
@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState); 
```

并从`ListSample extends Activity`->`ListSample extends ListFragment`

如果需要更多细节，请告诉我，祝你好运

# hadoop - Hadoop Pig 比较两个值并对它们进行排序

> ID：12238485
> 
> 赞同：2
> 
> 时间：2012-09-02T18:11:46.103
> 
> 标签：hadoop, apache-pig, compareto

我目前正在学习 hadoop 框架和猪拉丁语。现在我有一个问题。

我有一个格式如下的数据集：

```
"long a, long b, char c, char d" 
```

现在我想用 pig 读取这个数据集。负载和 PigStorage 功能没有问题..

```
bla = load 'data/examples/test' as (a:long, b:long, c:chararray, d:chararray); 
```

我的下一步是，我想在每一行上比较 a 和 b。如果 a 大于 b 没关系。如果b大于a，我不想用b切换a，这样较高的值总是我数据集的第一个值......

这可能吗？在Java中，我可以用一个简单的“compareTo”来做到这一点......

对不起，我的英语不好 ：-）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:48:23.730

```
blb = FOREACH bla GENERATE ((a < b) ? b : a), ((a < b) ? a : b), c, d; 
```

Pig 中的此运算符称为[bincond](http://pig.apache.org/docs/r0.10.0/basic.html#arithmetic)。第一个说，如果`a`小于`b`，则输出`b`。第二个说，如果`a`小于`b`，则输出`a`。请注意，当`a`大于时`b`，它会输出相反的结果。

# objective-c - 在 iOS 上使用 NSDateFormatter

> ID：12238493
> 
> 赞同：1
> 
> 时间：2012-09-02T18:12:50.167
> 
> 标签：objective-c, ios, nsdateformatter

我目前在我的应用程序上使用 NSDateFormatter 以我想要的格式显示日期。我的 NSDateFormatter 看起来像这样：`[formatter setDateFormat:@"MMM dd, yyyy hh:mm"];`这会给我这样的日期：`Sep 02 , 2012 08:30`。我有 2 个问题。我想以军事时间显示时间我如何使用格式化程序来做到这一点？我知道如何显示上午/下午，但我希望上面的时间看起来是 20:30。其次，我怎样才能让月份显示为一个数字？九月将是 09 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T18:26:06.770

[该站点](http://waracle.net/mobile/iphone-nsdateformatter-date-formatting-table/)有一个很好的表格，其中包含您可以使用的格式说明符，然后跟进。

在这种情况下，您应该使用`[formatter setDateFormat:@"MM dd, yyyy HH:mm"];`来获取`09 02, 2012 20:30`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:23:33.677

[`H`](http://unicode.org/reports/tr35/tr35-10.html#Date_Format_Patterns)每小时使用大写字母`M`，每月仅使用两个。

```
[formatter setDateFormat:@"MM dd, yyyy HH:mm"]; 
```

# java - 更好的是，使用 mysql“从表中选择...”或将整个表移动到 Arraylist 并遍历它？

> ID：12238494
> 
> 赞同：3
> 
> 时间：2012-09-02T18:12:57.093
> 
> 标签：java

我正在尝试查找特定记录。那么有什么更好的办法呢？使用 mysql 语句查找记录或抓取整个表，放入 arraylist 并遍历它，直到找到我想要的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-02T18:13:55.673

将数据库工作卸载到数据库总是更好。

我看到的一些优点是：

您将只获得您想要的数据，从而提高性能，结果会更快（大多数数据库服务器都带有优化以改善查询执行路径）。

节省空间。您不需要在运行时内存中保留不需要的数据

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T18:15:03.950

我认为制作一个比`Database query`将**所有数据输入**然后处理它**更快更有效......** **`ArrayList`**

 **如果可以通过对数据库的精心准备的查询来解决，那么编写逻辑将是忙碌的……

`ArrayList`是一个`object`本身，我认为您还需要将数据作为某些对象存储在数据库中`custom made class`......**这将占用空间**......！！！

有时您可能**只需要一小部分信息**，只考虑表格中的一个值......然后我认为使用类似的东西`ArrayList`不是**一个聪明的举动**......**

# function - 如何从函数执行动态查询（创建触发器）？

> ID：12238495
> 
> 赞同：0
> 
> 时间：2012-09-02T18:12:57.143
> 
> 标签：function, postgresql, triggers, dynamicquery

我是 PostgreSql 的新手，我使用的是 8.3 版。我需要创建一个函数来检查表是否有特定的触发器。如果触发器存在，我需要删除它。

我正在生成如下所示的删除查询：

var_DropTriggerSqlPart = '删除触发器 "' || var_TriggersRecord."triggerName" || '" on "' || var_Record."SchemaName" || '"."' || var_Record."TableName" || '";';

-- （其中所有 'var_' 都是具有所需数据的变量）。

执行 var_DropTriggerSqlPart；

但我没有看到触发器下降。有人可以让我知道我在这里做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:37:56.430

我想我找到了答案。我将“执行”更改为“执行”，并使函数“易失”而不是“稳定”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T00:04:38.253

这里有几点。

首先，您是对的，EXECUTE 是执行此操作的正确方法。如果您正在创建触发器，但需要记住一些事情（我们会做很多这样的事情）。

最重要的是，像这样的实用程序语句没有查询计划，因此无法参数化。当然，您正在创建一个字符串并将其作为 SQL 执行。这有它在任何地方都会出现的所有问题，包括 SQL 注入的可能性。如果您的函数是 SECURITY DEFINER，那么您有可能通过存储过程中的 sql 注入来提升权限。

这可以通过很好地了解两个函数来解决：quote_ident() 和quote_literal()。

在上面的示例中，我建议将其更改为：

```
var_DropTriggerSqlPart = 'drop trigger "' || 
     quote_ident(var_TriggersRecord."triggerName") || '" on "' || 
     quote_ident(var_Record."SchemaName") || '"."' || 
     quote_ident(var_Record."TableName") || '";'; 
```

在 LedgerSMB 中，我们在 UDF 中做了很多实用程序语句，并且必须处理这个问题。通常，我们还将执行此操作的大部分功能放在一起以便于审查/审计。

# oracle - 为其值存储在临时变量中的列选择某些内容

> ID：12238497
> 
> 赞同：1
> 
> 时间：2012-09-02T18:13:20.217
> 
> 标签：oracle, plsql

我有两个输入表 input_table_1 看起来像这样：

```
prod_id store id    net_sales   gender  color
1   1   34  m   blue
2   1   43  f   green
3   2   12  f   green
4   3   22  f   blue
5   3   56  m   black
6   3   4   f   green 
```

第二个表是look_up_table，它具有表1的列名及其值：

```
attribut  value_1
gender  m
gender  f
color   blue
color   green
color   black
.           .
.           .
.           . 
```

我创建了这段代码，在其中运行嵌套循环并将属性值和 value_1 存储在临时变量中。现在我想从 input_table_1 中选择 net_sales 的总和，其中列名存储在 temp_atr_val 中，单元格值作为 temp_val。我正在尝试这样的事情，但它对我不起作用，并且 temp_sales 变量没有任何价值。请帮助我如何使用 select 语句来选择特定属性值的销售额总和。

编码：

```
declare 
temp_atr_val varchar2(400);
temp_val varchar2 (400);
temp_name varchar2 (400);
temp_sum_percent decimal (10,3);
temp_variable number := 786;
column_count number ; 
val_count number;
temp_storeid number (38,0);
temp_sales number ; 
store_count number;
/*  sales_store number; */
BEGIN   
create table store_table as 
select distinct id_dmstore 
from input_table_1
order by store_id;   

select count(distinct attribute) into column_count from look_up_table;
for ind in 1..column_count loop

    /* putting current value of attribute from look_up_table in temp variable*/
    select attribute into temp_atr_val from (
        select attribute, rownum rwn
        from 
        (
           select distinct attribute
           from look_up_table
           order by attribute
        )
    ) where rwn = ind;

    select count( value ) into val_count from look_up_table
   where ATTRIBUTE = temp_atr_val;

    for ind in 1..val_count loop

   /* putting current value_for_atr for corresponding attribute from look_up_table in temp variable*/
        select value_for_atr into temp_val from 
         (
          select value_for_atr, rownum rwn
          from look_up_table
        where ATTRIBUTE = temp_atr_val
         ) where rwn = ind;

      select name_of_col into temp_name from 
      (
      select name_of_col, rownum rwn
      from look_up_table
       where ATTRIBUTE = temp_atr_val
      /* and VALUE_FOR_ATR = temp_val*/
       ) where rwn = ind;

 select count (STORE_id )into store_count from store_table;

 for ind in 1..column_count loop

  select store_id into temp_storeid from (
        select id_dmstore, rownum rwn
        from store_table
        order by store_id
        )
     where rwn = ind;

 select sum(net_sales_home) into temp_sales
 from input_table_1
 where temp_atr_val = temp_val
 and store_id = temp_storeid;

dbms_output.put_line (temp_sales);
 end loop; 
       /* SELECT SUM(CASE WHEN temp_atr_val = temp_val THEN net_sales_home ELSE 0 END) into temp_variable
       FROM schemafinal_1;

 dbms_output.put_line (temp_val);
*/
/*temp_variable := temp_variable/sales_store; */

EXECUTE IMMEDIATE 'ALTER TABLE SAR ADD ('||temp_name||' number)'; 
EXECUTE IMMEDIATE ' UPDATE SAR b 
SET b.'||temp_name||' = :temp_variable' using temp_variable;

END LOOP;
END LOOP;   
END; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T23:10:04.787

如果您尝试创建一个新列来存储数据，并且每次在临时变量中出现一个新值时都会创建一个新列，那么您为什么不试试这个：
创建两个新列并调用它们column_name 和列值。这样，您可以存储列的名称和将存储在其中的值。
稍后，要从该列中进行选择，而不是执行以下操作：

```
select column_name from table; 
```

你会这样做：

```
select column_value from table where column_name = temp_variable; 
```

如果我理解你想要做什么，当然......

# wpf - xaml 和 wpf 中的多绑定图像源

> ID：12238505
> 
> 赞同：0
> 
> 时间：2012-09-02T18:14:52.530
> 
> 标签：wpf, xaml, binding

在我的项目中，我有一个名为 Images 的文件夹，我在我的应用程序中使用的所有图像都保存在子文件夹中。所有图像在构建过程中都设置为“资源”。

```
myproject
  |__Images
      |__AppImages
          |__StarOn.png
          |__StarOff.png 
```

现在，如果我像这样手动设置图像：

```
<Image Source="Images\AppImages\StarOn.png" width="32" height="32"/> 
```

图像正确显示在图像框中。

我想使用转换器和这样的绑定来设置图像：

```
<Image>
<Image.Source>
  <Binding Path="Number" converter="{StaticResource GetImagePathConverter}"/>
</Image.Source>
</Image> 
```

其中数字是整数

我的转换器是：

```
public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        int questionNr=int.parse(value.ToString());

            if (questionNr>100)
            {
                return "Images\\AppImages\\StarOn.png";
            }

            return "Images\\AppImages\\starOff.png";
    } 
```

但这并没有改变形象？..

我做错了什么？如何从转换器正确设置图像源？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T18:39:03.730

您使用转换器的方式不正确。您需要创建一个转换器实例，在您的绑定中使用它`StaticResource`。`local:`是您需要在 xaml 中声明的本地命名空间 -

```
<Image>
  <Image.Resources>
    <local:GetImagePathConverter x:Key="GetImagePathConverter"/>
  </Image.Resources>
  <Image.Source>
    <Binding Path="Number" Converter="{StaticResource GetImagePathConverter}"/>
  </Image.Source>
</Image> 
```

此外，`Source`属性不是字符串类型，而是`ImageSource`您的转换器中需要一些东西 -

```
public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
{
   int questionNr=int.parse(value.ToString());

   if (questionNr>100)
   {
      return new BitmapImage(new Uri("Images\\AppImages\\StarOn.png", UriKind.Relative));
   }
   return new BitmapImage(new Uri("Images\\AppImages\\StarOff.png", UriKind.Relative));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:37:06.020

看到[这个答案](https://stackoverflow.com/questions/10502171/multibinding-not-working-on-textbox-text/10502735#10502735)。

基本上，您必须注意在转换器中返回的对象类型，不能返回类型`string`属性`ImageSource`。

我不在我的开发机器上，但代码是这样的：

```
return new BitmapImage(new Uri(the/path/to/image.png)).Source; //or '*.ImageSource', can't remember 
```

# php - 获取 jquery ajax autoscroll 的下一组数据

> ID：12238508
> 
> 赞同：0
> 
> 时间：2012-09-02T18:15:03.137
> 
> 标签：php, jquery, ajax, infinite-scroll

我正在尝试使用 jQuery 和一些 Ajax 设置自定义无限滚动。这是我到目前为止所拥有的：

```
 $(window).scroll(function() {
            if($(window).scrollTop() + $(window).height() == $(document).height()) {
                $.ajax({
                    type: "POST",
                    url: "posts/view/",
                    data: "",
                    success: function(results){
                        $(".container").after(results);
                    }
                })
            }
        }); 
```

这一切都很好，花花公子，但我正在努力想象的是如何获得下一个“集合”或“页面”数据。我正在使用 PHP，在我的函数中我会有类似 getMore($page = 1) 的东西。但是我怎样才能让 jQuery 跟踪它当前所在的页面，并知道下一个页面是什么？我是否应该在 jQuery 中设置某种增量函数，以便它提取 URL（例如，posts/page/1/），然后简单地将 1 添加到它通过 Ajax 传递的 url？

我觉得我真的想多了，有没有更简单的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:25:59.077

只需在滚动闭包内使用页面计数器：

```
(function(){

    //inner functions will be aware of this
    var currentPage = 0;

    $(window).scroll(function() {

        if($(window).scrollTop() + $(window).height() == $(document).height()) {

         $.ajax({
             type: "GET",
             url: "posts/view/" + currentPage,
             data: "",
             success: function(results){
                 $(".container").after(results);
             }
         })

         currentPage++;

         }

    });

})();​ 
```

并根据`page`您传递的参数更改您的服务器脚本。如果没有更多可以检索的内容，只需用空的身体回答即可。

顺便说一下，`POST`不适合检索数据，`GET`改用吧。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T18:18:53.747

你可以选择更简单的方法。像这样放置一个隐藏字段

```
<input type hidden value="1" id="page" /> 
```

现在在每个 ajax 发送之前从该隐藏字段中获取页面值。并且在每个 ajax 成功函数之后像这样增加隐藏的字段值。

```
$('#page').val(parseInt($('#page').val())+1) 
```

您的 ajax 调用将如下所示

```
$(window).scroll(function() {
        if($(window).scrollTop() + $(window).height() == $(document).height()) {
            $.ajax({
                type: "POST",
                url: "posts/view/"+$('#page').val(),
                data: "",
                success: function(results){
                    $('#page').val(parseInt($('#page').val())+1);
                    $(".container").after(results);
                }
            })
        }
    }); 
```

# c# - ADO .NET EF 中的可组合查询每次迭代都会返回更多实体

> ID：12238509
> 
> 赞同：4
> 
> 时间：2012-09-02T18:15:15.617
> 
> 标签：c#, sql, entity-framework, ado.net

堆栈溢出！

我有一个 MS SQL 数据库。该数据库的部分显示在下一张图片中

![http://i.stack.imgur.com/DFnc5.png](../Images/546b6a362970f067216519bff3836611.png)

我正在尝试进行可组合的查询，我正在尝试查找具有特定 evEventKindID 事件的患者。例如，我想查找具有 (evEventKindtID == 1) 事件和 (evEventKindID == 1) 事件的患者。

```
var query = from pt in db.tblPatient
            select pt;
var list = query.ToList();// {1}

foreach (var limit in group.limits.Values)
{
      if (limit.eventKind.Type == TypeOfEventKind.ekEvent)
      {
           query = from pt in query
           where (pt.tblEvent.Count(j => j.evEventKindID == limit.eventKind.ID) > 0)
                                select pt;// {2}

           list = query.ToList();
           MessageBox.Show(query.Count().ToString());
      }
 } 
```

问题是每次下一次迭代都可以返回比上一次更多的元素。它让我感到困惑。查询中的查询如何返回比第一个查询更多的实体？

在 SQL Server Profiler 中，我找到了由 ADO .NET EF 生成的 SQL 查询。在位置 {1}：

```
SELECT 
[Extent1].[ptID] AS [ptID], 
[Extent1].[ptFullName] AS [ptFullName], 
[Extent1].[ptHomeAddress] AS [ptHomeAddress], 
[Extent1].[ptPhone] AS [ptPhone], 
[Extent1].[ptBirthDate] AS [ptBirthDate], 
[Extent1].[ptIsMale] AS [ptIsMale], 
[Extent1].[ptUserID] AS [ptUserID], 
[Extent1].[ptINN] AS [ptINN], 
[Extent1].[ptSNILS] AS [ptSNILS]
FROM [dbo].[tblPatient] AS [Extent1] 
```

在第一次迭代的 {2} 位置：

```
exec sp_executesql N'SELECT 
[Project1].[ptID] AS [ptID], 
[Project1].[ptFullName] AS [ptFullName], 
[Project1].[ptHomeAddress] AS [ptHomeAddress], 
[Project1].[ptPhone] AS [ptPhone], 
[Project1].[ptBirthDate] AS [ptBirthDate], 
[Project1].[ptIsMale] AS [ptIsMale], 
[Project1].[ptUserID] AS [ptUserID], 
[Project1].[ptINN] AS [ptINN], 
[Project1].[ptSNILS] AS [ptSNILS]
FROM ( SELECT 
    [Extent1].[ptID] AS [ptID], 
    [Extent1].[ptFullName] AS [ptFullName], 
    [Extent1].[ptHomeAddress] AS [ptHomeAddress], 
    [Extent1].[ptPhone] AS [ptPhone], 
    [Extent1].[ptBirthDate] AS [ptBirthDate], 
    [Extent1].[ptIsMale] AS [ptIsMale], 
    [Extent1].[ptUserID] AS [ptUserID], 
    [Extent1].[ptINN] AS [ptINN], 
    [Extent1].[ptSNILS] AS [ptSNILS], 
    (SELECT 
        COUNT(1) AS [A1]
        FROM [dbo].[tblEvent] AS [Extent2]
        WHERE ([Extent1].[ptID] = [Extent2].[evPatientID]) AND ([Extent2].[evEventKindID] = @p__linq__0)) AS [C1]
    FROM [dbo].[tblPatient] AS [Extent1]
)  AS [Project1]
WHERE [Project1].[C1] > 0',N'@p__linq__0 int',@p__linq__0=29 
```

在第二次迭代的 {2} 位置：

```
exec sp_executesql N'SELECT 
[Project2].[ptID] AS [ptID], 
[Project2].[ptFullName] AS [ptFullName], 
[Project2].[ptHomeAddress] AS [ptHomeAddress], 
[Project2].[ptPhone] AS [ptPhone], 
[Project2].[ptBirthDate] AS [ptBirthDate], 
[Project2].[ptIsMale] AS [ptIsMale], 
[Project2].[ptUserID] AS [ptUserID], 
[Project2].[ptINN] AS [ptINN], 
[Project2].[ptSNILS] AS [ptSNILS]
FROM ( SELECT 
    [Project1].[ptID] AS [ptID], 
    [Project1].[ptFullName] AS [ptFullName], 
    [Project1].[ptHomeAddress] AS [ptHomeAddress], 
    [Project1].[ptPhone] AS [ptPhone], 
    [Project1].[ptBirthDate] AS [ptBirthDate], 
    [Project1].[ptIsMale] AS [ptIsMale], 
    [Project1].[ptUserID] AS [ptUserID], 
    [Project1].[ptINN] AS [ptINN], 
    [Project1].[ptSNILS] AS [ptSNILS], 
    (SELECT 
        COUNT(1) AS [A1]
        FROM [dbo].[tblEvent] AS [Extent3]
        WHERE ([Project1].[ptID] = [Extent3].[evPatientID]) AND ([Extent3].[evEventKindID] = @p__linq__1)) AS [C1]
    FROM ( SELECT 
        [Extent1].[ptID] AS [ptID], 
        [Extent1].[ptFullName] AS [ptFullName], 
        [Extent1].[ptHomeAddress] AS [ptHomeAddress], 
        [Extent1].[ptPhone] AS [ptPhone], 
        [Extent1].[ptBirthDate] AS [ptBirthDate], 
        [Extent1].[ptIsMale] AS [ptIsMale], 
        [Extent1].[ptUserID] AS [ptUserID], 
        [Extent1].[ptINN] AS [ptINN], 
        [Extent1].[ptSNILS] AS [ptSNILS], 
        (SELECT 
            COUNT(1) AS [A1]
            FROM [dbo].[tblEvent] AS [Extent2]
            WHERE ([Extent1].[ptID] = [Extent2].[evPatientID]) AND ([Extent2].[evEventKindID] = @p__linq__0)) AS [C1]
        FROM [dbo].[tblPatient] AS [Extent1]
    )  AS [Project1]
    WHERE [Project1].[C1] > 0
)  AS [Project2]
WHERE [Project2].[C1] > 0',N'@p__linq__0 int,@p__linq__1 int',@p__linq__0=31,@p__linq__1=31 
```

你怎么看这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:27:57.983

这是与`foreach`. 引用变量的查询在执行查询时获取其参数值，而不是在绑定参数时。所以你可以拥有

```
int orderId = 1;
var query = from o in context.Orders where o.Id == orderId;
orderId = 2;
MessageBox.Show(query.Single().Id.ToString()); // shows that order 2 was retrieved 
```

在您的情况下，您的`foreach`循环有*一个*变量`limit`。您多次引用它，但这些多次引用都看到相同的值。这就是为什么你看到

```
N'@p__linq__0 int,@p__linq__1 int',@p__linq__0=31,@p__linq__1=31 
```

两个参数的值都是 31，第一次迭代的 29 消失了。

解决这个问题的最简单方法是每次创建一个新变量：

```
foreach (var limit in group.limits.Values)
{
    var locallimit = limit;
    // refer to locallimit in your query, not to limit
} 
```

# python - 编译前在运行时预处理函数文本

> ID：12238511
> 
> 赞同：1
> 
> 时间：2012-09-02T18:15:19.903
> 
> 标签：python

我决定尝试在将函数文本编译成字节码并执行之后对其进行预处理。这只是为了训练。我很难想象它会成为一个令人满意的解决方案的情况。我遇到了一个我想以这种方式解决的问题，但最终找到了更好的方法。所以这只是为了训练和学习新东西，而不是为了真正的使用。

假设我们有一个函数，我们希望在编译之前对源代码进行大量修改：

```
def f():
    1;a()
    print('Some statements 1')
    1;a()
    print('Some statements 2') 
```

例如，让其中的一些行用 标记`1;`，以便它们有时被注释，有时不被注释。我只是举个例子，功能的修改可能会有所不同。

为了评论这些行，我做了一个装饰器。整个代码如下：

```
from __future__ import print_function

def a():
    print('a()')

def comment_1(s):
    lines = s.split('\n')
    return '\n'.join(line.replace(';','#;',1) if line.strip().startswith('1;') else line for line in lines)

def remove_1(f):    
    import inspect
    source = inspect.getsource(f)    
    new_source = comment_1(source)
    with open('temp.py','w') as file:
        file.write(new_source)
    from temp import f as f_new
    return f_new

def f():
    1;a()
    print('Some statements 1')
    1;a()
    print('Some statements 2')

f = remove_1(f) #If decorator @remove is used above f(), inspect.getsource includes @remove inside the code.

f() 
```

我使用[了 inspect.getsourcelines](http://docs.python.org/library/inspect.html#inspect.getsource)来检索函数`f`代码。然后我进行了一些文本处理（在这种情况下，注释行以 开头`1;`）。之后我将它保存到`temp.py`模块，然后导入。`f`然后在主模块中装饰一个函数。

应用装饰器时的输出是这样的：

```
Some statements 1
Some statements 2 
```

未应用时是这样的：

```
a()
Some statements 1
a()
Some statements 2 
```

我不喜欢的是我必须使用硬盘驱动器来加载编译的功能。可以在不将其写入临时模块`temp.py`并从中导入的情况下完成吗？

第二个问题是关于将装饰器放在上面`f`：`@replace`。当我这样做时，使用这个装饰器`inspect.getsourcelines`返回文本。我可以从的文本中`f`手动删除。`f`但这将非常危险，因为可能应用了多个装饰器。所以我求助于老式的装饰语法`f = remove_1(f)`，它完成了这项工作。但是，是否可以允许正常的装饰技术`@replace`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:41:44.773

`exec`可以通过调用源上的语句来避免创建临时文件。（如果您想对编译进行额外控制，您也可以`compile`在之前显式调用，但会为您进行编译，因此没有必要。）正确调用还有一个额外的好处，即如果函数从命名空间访问全局变量，它将正常工作其模块。`exec``exec``exec`

第二个问题中描述的问题可以通过在装饰器运行时暂时阻塞来解决。这样，装饰器与所有其他装饰器一起保留，但没有操作。

这是更新的来源。

```
from __future__ import print_function

import sys

def a():
    print('a()')

def comment_1(s):
    lines = s.split('\n')
    return '\n'.join(line.replace(';','#;',1) if line.strip().startswith('1;') else line for line in lines)

_blocked = False

def remove_1(f):
    global _blocked
    if _blocked:
        return f
    import inspect
    source = inspect.getsource(f)    
    new_source = comment_1(source)
    env = sys.modules[f.__module__].__dict__
    _blocked = True
    try:
        exec new_source in env
    finally:
        _blocked = False
    return env[f.__name__]

@remove_1
def f():
    1;a()
    print('Some statements 1')
    1;a()
    print('Some statements 2')

f()

def remove_1(f):    
    import inspect
    source = inspect.getsource(f)    
    new_source = comment_1(source)
    env = sys.modules[f.__module__].__dict__.copy()
    exec new_source in env
    return env[f.__name__] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T22:18:58.650

我将保留**user4815162342**答案中给出的解决方案的修改版本。[正如对问题的评论](https://stackoverflow.com/questions/12238511/preprocessing-function-text-in-runtime-bofore-compilation/12240203#comment16402435_12238511)所建议的那样，它使用`ast`模块来删除 的某些部分。为了做到这一点，我主要依赖于[本文](http://blueprintforge.com/blog/2012/02/27/static-modification-of-python-with-python-the-ast-module)中的信息。`f`

此实现删除所有出现的`a`as 独立表达式。

```
from __future__ import print_function
import sys
import ast
import inspect

def a():
    print('a() is called')

_blocked = False

def remove_1(f):
    global _blocked
    if _blocked:
        return f
    import inspect
    source = inspect.getsource(f)

    a = ast.parse(source) #get ast tree of f

    class Transformer(ast.NodeTransformer):
        '''Will delete all expressions containing 'a' functions at the top level'''
        def visit_Expr(self, node): #visit all expressions
            try:
                if node.value.func.id == 'a': #if expression consists of function with name a
                    return None #delete it
            except(ValueError):
                pass
            return node #return node unchanged
    transformer = Transformer()
    a_new = transformer.visit(a)
    f_new_compiled = compile(a_new,'<string>','exec')

    env = sys.modules[f.__module__].__dict__
    _blocked = True
    try:
        exec(f_new_compiled,env)
    finally:
        _blocked = False
    return env[f.__name__]

@remove_1
def f():
    a();a()
    print('Some statements 1')
    a()
    print('Some statements 2')

f() 
```

输出是：

```
Some statements 1
Some statements 2 
```

# ruby-on-rails-3 - Rails 3：当一个集合被渲染时，它是否为每个实例访问一个控制器？

> ID：12238512
> 
> 赞同：0
> 
> 时间：2012-09-02T18:15:33.443
> 
> 标签：ruby-on-rails-3, collections, controller, render

一个用户可以有很多帖子，每个帖子可以有很多评论。访问用户的个人资料时，您会在视图中获得如下呈现的帖子列表：

```
<%= render @posts %> 
```

我还想通过执行以下操作来呈现每个帖子的评论：

```
<%= render @comments %> 
```

但是，我会在哪里声明@comments？如果我在 user#show 中声明它，那么我会得到用户的所有评论，而不是特定帖子的评论。

那么当一个集合被渲染时，它会访问每个实例的控制器吗？如果是这样，它使用什么控制器方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:23:47.607

您可以在帖子部分中呈现每个帖子的评论：

```
<% @posts.each do |post| %>
  <%= render post %>
  <%= render :partial => 'posts_comments', :collection => post.comments %>
<% end %> 
```

这不会在每个`post.comments`语句上发送到控制器，它只是查询数据库。

您还可以通过以下方式在控制器中设置 @posts 实例变量来消除多个查询：

```
@posts = @user.posts.includes(:comments) 
```

然后当你这样做时，`post.comments`它不会查询数据库，而是从内存中加载评论。

# c# - 数据库酒店预订

> ID：12238514
> 
> 赞同：0
> 
> 时间：2012-09-02T18:16:02.577
> 
> 标签：c#, asp.net, sql-server-2012

所以我有一点问题，在我的 ASP.Net 网站上，我希望它显示所有当前可用且未使用的房间。当我说不使用时，我的意思是目前没有人为那个房间预留，所以系统日期不在 checkin 和 checkoutdate 的任何值之间。

我的架构的一部分：

```
 CREATE TABLE "Rooms"(

    RoomNo int NOT NULL,
    RoomType nvarchar(20) NULL,
    PricePerNight money NULL,
    MaximumOccupancy int NULL,
    NoOfBeds int NULL,
    NoOfBathrooms int NULL,
    Entertainment bit NULL,
    RoomService bit NULL,
    Gym bit NULL,

    CONSTRAINT PK_Rooms PRIMARY KEY(RoomNo)
)
CREATE TABLE "Reservation"(

    ReservationID int IDENTITY (1,1) NOT NULL,
    CustomerID int NOT NULL,
    RoomNo int NOT NULL,
    CheckInDate date NOT NULL,
    CheckOutDate date NOT NULL,
    NoOfDays int NOT NULL,

    CONSTRAINT PK_Reservation PRIMARY KEY(ReservationID),

    CONSTRAINT FK_Reservation_Customers_CustID FOREIGN KEY(CustomerID)  
        REFERENCES dbo.Customers(CustomerID),

    CONSTRAINT FK_Reservation_Rooms_RoomNo FOREIGN KEY(RoomNo)
        REFERENCES dbo.Rooms(RoomNo)
) 
```

所以这是我的想法，我假设我需要一个类似这样的 sql 查询：

> 从房间中选择所有 &CheckInDate != "从预订中选择 CheckIndate" AND &CheckOutDate != "从预订中选择 CheckOutDate"。

但这有一些缺陷。

有人可以告诉我如何做到这一点，如何使我的 Sue-do-code（让我们称之为）更可行，因为我不确定这样的事情是否可行，如果有必要建议我可以做出改进到我的架构。

TLDR；我需要一个查询，其中有人输入了 checkindate 和 checkoutdate，它会返回所有可用的房间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:52:18.813

尝试这个..

从不存在的房间中选择 *（从房间 r 中选择 *，预订 rs WHERE r.RoomNo = rs.RoomNo AND GETDATE() BETWEEN rs.CheckInDate AND rs.CheckOutDate）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:05:21.083

这就是我想要的。

```
SELECT dbo.Rooms.RoomNo
FROM dbo.Rooms JOIN dbo.Reservation
ON (dbo.Rooms.RoomNo = dbo.Reservation.RoomNo)
WHERE '2012-01-01' NOT BETWEEN dbo.Reservation.CheckInDate AND dbo.Reservation.CheckOutDate
AND '2012-01-05' NOT BETWEEN dbo.Reservation.CheckInDate AND dbo.Reservation.CheckOutDate; 
```

花了时间，但我最终得到了它。where 语句的初始日期可以替换为 &Date。

# python - 为什么python字符串split（）不分裂

> ID：12238517
> 
> 赞同：4
> 
> 时间：2012-09-02T18:16:20.420
> 
> 标签：python, http

我有以下python代码。

```
class MainPage(BaseHandler):

    def post(self, location_id):
        reservations = self.request.get_all('reservations')
        for r in reservations:
            a=str(r)
            logging.info("r: %s " % r)
            logging.info("lenr: %s " % len(r))
            logging.info("a: %s " % a)
            logging.info("lena: %s " % len(a))
            r.split(' ')
            a.split(' ')
            logging.info("split r: %s " % r)
            logging.info("split a: %s " % a) 
```

我得到以下日志打印输出。

```
INFO     2012-09-02 17:58:51,605 views.py:98] r: court2 13 0 2012 9 2 
INFO     2012-09-02 17:58:51,605 views.py:99] lenr: 20 
INFO     2012-09-02 17:58:51,605 views.py:100] a: court2 13 0 2012 9 2 
INFO     2012-09-02 17:58:51,606 views.py:101] lena: 20 
INFO     2012-09-02 17:58:51,606 views.py:108] split r: court2 13 0 2012 9 2 
INFO     2012-09-02 17:58:51,606 views.py:109] split a: court2 13 0 2012 9 2 
```

如果我使用 split() 代替 split('')，我会得到相同的日志打印输出，顺便说一句。

为什么 split 不将结果拆分为包含 6 个条目的列表？我想问题是涉及到 http 请求，因为我在 gae 交互式控制台中的测试得到了预期的结果。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-02T18:17:54.027

`split`不修改字符串。它返回拆分部分的列表。如果您想使用该列表，则需要将其分配给某些内容，例如`r = r.split(' ')`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-02T18:17:29.080

`split`不拆分原始字符串，而是返回一个列表

```
>>> r  = 'court2 13 0 2012 9 2'
>>> r.split(' ')
['court2', '13', '0', '2012', '9', '2'] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-02T18:17:48.133

改变

```
r.split(' ')
a.split(' ') 
```

至

```
r = r.split(' ')
a = a.split(' ') 
```

说明：`split`不就地拆分字符串，而是返回拆分版本。

来自文档：

```
split(...)

    S.split([sep [,maxsplit]]) -> list of strings

    Return a list of the words in the string S, using sep as the
    delimiter string.  If maxsplit is given, at most maxsplit
    splits are done. If sep is not specified or is None, any
    whitespace string is a separator and empty strings are removed
    from the result. 
```

# c# - 从我的项目的外部文件计算数字（Project Euler #13）

> ID：12238518
> 
> 赞同：1
> 
> 时间：2012-09-02T18:16:24.620
> 
> 标签：c#, algorithm

我正在尝试寻找多种方法来解决 Project Euler 的[问题 #13](http://projecteuler.net/problem=13)。我已经用两种不同的方式解决了它，但是这次我要做的是让我的解决方案从包含所有数字的文本文件中读取，然后从那里对其进行转换并将最远的列号添加到正确的。我还想以某种方式解决这个问题，如果我们要向列表中添加新数字，列表可以包含任意数量的行或列，因此它的长度不是预定义的（非数组？我不确定是否锯齿状数组将在此处正确应用，因为它无法预定义）。

到目前为止，我有：

```
 static void Main(string[] args)
    {

        List<int> sum = new List<int>();

        string bigIntFile = @"C:\Users\Justin\Desktop\BigNumbers.txt";

        string result;

        StreamReader streamReader = new StreamReader(bigIntFile);

        while ((result = streamReader.ReadLine()) != null)
        {
            for (int i = 0; i < result.Length; i++)
            {
                int converted = Convert.ToInt32(result.Substring(i, 1));
                sum.Add(converted);
            }
        }

    } 
```

它读取文件并将每个字符从字符串转换为单个 int。我试图思考如何将该 int 存储在一个类似于 2D 数组的集合中，但该集合需要是通用的并存储任何 # 行/列。除了基本列表之外，关于如何存储这些数字的任何想法？有没有办法可以设置一个列表，使它就像一个未预定义的二维数组？提前致谢！

更新：我也不想使用“BigInteger”。这有点太容易阅读该行，将字符串转换为 BigInt，将其存储在 BigInt 列表中，然后从那里总结所有整数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:45:22.307

在这种情况下，您可以简单地使用 2D 数组，因为您实际上事先知道它的尺寸：100 x 50。

如果出于某种原因你想解决一个更普遍的问题，你可能确实会使用 List of Lists，List>。

话虽如此，我想知道：你真的想总结所有的数字吗？如果是这样，我会建议另一种方法：考虑 50 位数字的哪一部分实际上影响了它们总和的前几位。提示：您不需要完整的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T18:45:44.677

.NET 框架中没有内置可调整大小的 2D 集合。我只使用“锯齿状数组”类型的数据结构，仅使用列表：

```
List<List<int>> 
```

您还可以通过为每一行使用一个数组来改变这种模式：

```
List<int[]> 
```

如果你想更简单地阅读文件，这里是如何：

```
List<int[]> numbers =
 File.EnumerateLines(path)
 .Select(lineStr => lineStr.Select(@char => @char - '0').ToArray())
 .ToList(); 
```

少得多的代码。你可以重用很多内置的东西来做基本的数据转换。这使您编写和维护的代码更少。它更具可扩展性，并且不易出现错误。

如果要从此结构中选择一列，请执行以下操作：

```
int colIndex = ...;
int[] column = numbers.Select(row => row[index]).ToArray(); 
```

您可以将此行封装到一个辅助方法中，以从您的主要加法算法中去除噪声。

请注意，所有这些模式的效率*远*低于 2D 数组，但在您的情况下它已经足够好了。

# c# - 非法跨线程操作错误

> ID：12238522
> 
> 赞同：-2
> 
> 时间：2012-09-02T18:17:28.133
> 
> 标签：c#

> **可能重复：**
> [C# 中的“跨线程操作错误”需要帮助](https://stackoverflow.com/questions/606642/help-needed-for-cross-thread-operation-error-in-c-sharp)
> [解决 WinForms 中的跨线程异常](https://stackoverflow.com/questions/5868783/solve-a-cross-threading-exception-in-winforms)

我试图在 foreach 循环中添加进度条

```
private void backgroundWorker1_DoWork(object sender, DoWorkEventArgs e)
{
    foreach (...)
    {
        ...
        i++;
        backgroundWorker1.ReportProgress(100 * i / rcount);
        Thread.Sleep(100);
    }
    this.close();
} 
```

现在我有一个非法的跨线程操作 `this.close();` 错误

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:20:13.863

在ui线程中运行命令：

[如何从 C# 中的另一个线程更新 GUI？](https://stackoverflow.com/questions/661561/how-to-update-gui-from-another-thread-in-c)

```
this.Invoke((MethodInvoker)delegate {
    this.close();
}); 
```

# c++ - 校验和计算 - 所有字节的二进制补码和

> ID：12238528
> 
> 赞同：4
> 
> 时间：2012-09-02T18:18:03.500
> 
> 标签：c++, algorithm, checksum

我有关于创建这样描述的消息校验和的说明：

校验和由一个字节组成，该字节等于从“消息类型”字开始到消息块末尾的所有字节的二进制补码和（不包括传输的校验和）。最高有效位的进位被忽略。

我发现的另一个描述是：校验和值包含数据消息中其他字（即消息类型、消息长度和数据字）的模 256 和的二进制补码。接收设备可以计算接收到的字的模256和并将这个和加到接收到的校验和字上。结果为零通常表示消息已正确接收。

我理解这意味着我将消息中所有字节的值（不包括校验和）相加，得到这个数字的模 256。得到这个数字的二进制补码，这就是我的校验和。

但是我在使用示例消息示例时遇到了问题（来自设计文档，因此我必须假设它已正确编码）。

```
unsigned char arr[] = {0x80,0x15,0x1,0x8,0x30,0x33,0x31,0x35,0x31,0x30,0x33,0x30,0x2,0x8,0x30,0x33,0x35,0x31,0x2d,0x33,0x32,0x31,0x30,0xe}; 
```

所以最后一个字节 0xE 是校验和。我计算校验和的代码如下：

```
bool isMsgValid(unsigned char arr[], int len) {
   int sum = 0;
   for(int i = 0; i < (len-1); ++i) {
      sum += arr[i];
   }
   //modulo 256 sum
   sum %= 256;

   char ch = sum;

   //twos complement
   unsigned char twoscompl = ~ch + 1;

   return arr[len-1] == twoscompl;
}

int main(int argc, char* argv[])
{
   unsigned char arr[] = {0x80,0x15,0x1,0x8,0x30,0x33,0x31,0x35,0x31,0x30,0x33,0x30,0x2,0x8,0x30,0x33,0x35,0x31,0x2d,0x33,0x32,0x31,0x30,0xe};
   int arrsize = sizeof(arr) / sizeof(arr[0]);

   bool ret = isMsgValid(arr, arrsize);

   return 0;
} 
```

规格在这里：= [http://www.sinet.bt.com/227v3p5.pdf](http://www.sinet.bt.com/227v3p5.pdf)

我假设我误解了所需的算法。知道如何创建这个校验和吗？

Flippin 规范编写者在他们的数据示例中犯了一个错误。刚发现这个然后回到这里发现其他人也发现了。对不起，如果我浪费了你的时间。我将研究回复，因为它看起来像是一些有助于改进我的代码的有用评论。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T18:56:46.953

您从链接的 pdf 中错误地复制了示例消息。第二个参数长度为 9 个字节，但您在代码中使用了 0x08。

当参数中确实有 9 个字节时，该文档在第三列中错误地声明了“8 个字节”。第二列正确地指出“00001001”。

换句话说，您的测试信息应该是：

```
{0x80,0x15,0x1,0x8,0x30,0x33,0x31,0x35,0x31,0x30,0x33,0x30, // param1
 0x2,0x9,0x30,0x33,0x35,0x31,0x2d,0x33,0x32,0x31,0x30,0xe}  // param2
     ^^^ 
```

`ret == true`当我尝试您的程序时，使用正确的消息数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T18:49:07.377

同意评论：看起来校验和是错误的。这些数据在 .PDF 中的什么位置？

一些一般提示：

使用无符号类型作为累加器；这为您提供了明确定义的溢出行为，并且您需要更长的消息。同样，如果将结果存储在 char 变量中，请将其设为 unsigned char。

但是您不需要存储它；只需使用无符号类型进行数学运算，对结果进行补码，加 1，并屏蔽高位，以便获得 8 位结果。

另外，这里有一个技巧，如果您使用的是使用二进制补码算法的硬件：只需添加所有值，包括校验和，然后屏蔽高位；如果输入正确，结果将为 0。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T18:59:50.153

> 接收设备可以计算接收到的字的模256和并将这个和加到接收到的校验和字上。

使用此条件来理解校验和要容易得多：

```
{byte 0} + {byte 1} + ... + {last byte} + {checksum} = 0    mod 256
{checksum} = -( {byte 0} + {byte 1} + ... + {last byte} )   mod 256 
```

正如其他人所说，在处理单个位时，您确实应该使用无符号类型。在进行模运算时也是如此。如果你使用有符号类型，你会让自己面临*大量*与符号相关的错误。OTOH，几乎你打开自己使用无符号数字的唯一错误就是忘记`2u-3u`是一个正数。

（请注意将有符号和无符号数字混合在一起：其中也涉及很多微妙之处）

# android - 日历删除

> ID：12238531
> 
> 赞同：1
> 
> 时间：2012-09-02T18:18:40.530
> 
> 标签：android, calendar

我添加了一个新日历：

```
ContentValues event2= new ContentValues();          
event.put("name", "My calendar");
                    event.put("displayName", "My new calendar");
                    event.put("hidden",0);  
                            Uri url2 = getContentResolver().insert(calendarUri, event); 
```

当我列出所有日历时，会出现新日历，但我的本地日历 APP 崩溃，现在我不能新日历！我在这里搜索并测试了一些方法：

```
Uri uri1=ContentUris.withAppendedId(calendarUri, calId);
  int url3 = getContentResolver().delete(uri1,"_id="+calId",projection);
  int url2 = getContentResolver().delete(calendarUri,"_id=3",projection); 
```

但总是显示错误：名称不能为空：null（投影是一个带有id和名称的数组字符串）

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-13T22:28:26.883

尝试这个：

> getContentResolver.delete(ContentUris.withAppendedId(CalendarContract.Calendars.CONTENT_URI, id), null, null);

`id`您要删除的日历的 ID 在哪里。

尚未对其进行测试，但适用于事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T18:02:58.013

可能有点晚了，但是：

```
Uri evuri = CalendarContract.Calendars.CONTENT_URI;
//substitue your calendar id into the 0
long calid = 0; 
Uri deleteUri = ContentUris.withAppendedId(evuri, calid);
getActivity().getContentResolver().delete(deleteUri, null, null); 
```

为我工作。

或者，如果您不知道您的日历 ID：

```
Uri evuri = CalendarContract.Calendars.CONTENT_URI;
Cursor result = getActivity().getContentResolver().query(evuri, new String[] {CalendarContract.Calendars._ID, CalendarContract.Calendars.ACCOUNT_NAME, CalendarContract.Calendars.CALENDAR_DISPLAY_NAME}, null, null, null);
while (result.moveToNext()) 
{
     if(result.getString(2).equals("YOUR CALENDAR NAME"))
     {
         long calid = result.getLong(0);
         Uri deleteUri = ContentUris.withAppendedId(evuri, calid);
         getActivity().getContentResolver().delete(deleteUri, null, null);
     }
} 
```

当然，查找 CalendarContract.Calendars.ACCOUNT_NAME 对您来说可能是多余的，因此只需将其删除。（实际上几乎没有任何开销）

# c++ - 如何正确地将变量传入和传出非默认构造函数？

> ID：12238534
> 
> 赞同：1
> 
> 时间：2012-09-02T18:19:04.373
> 
> 标签：c++, oop, constructor

我正在用 C++ 编写一个家庭作业程序。我在将值从一个初始化的构造函数传递到另一个时遇到了一点问题，它说：

```
error C2664: 'Book::Book(std::string,Author *,Publisher *,double)' : cannot convert parameter 2 from 'Author' to 'Author *' 
```

我对 OOP 和 C++ 新手有点生疏。

如果我应该包含更多代码，请发布我将附加来自主类和我无法进行转换的类的代码。该程序还没有完成。

主文件

```
#include <iostream>
using namespace std;

#include "Book.h"

void main()
{
    cout << "Book 1" << endl;

    Author *pAuthor = new Author("John", "Doe");
    Publisher *pPublisher = new Publisher("Wrox", "10475 Crosspoint Blvd.", "Indianapolis");
    Book *book = new Book("Memory Management", *pAuthor, *pPublisher, 49.99);

    cout << "Book 2" << endl;
    int i;
    cin >> i;
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T18:22:52.177

您不应该取消引用 Author 和 Publisher 指针，因为 Book 构造函数需要指针，而不是传入的值。

但是，在处理所有这些指针时，您可能会遇到很多内存管理问题。这对于一个小程序来说是可以的，因为一旦程序退出，所有内存都会被释放，但是养成正确管理内存的习惯很重要。如果您想避免按值传递，也许您应该阅读 C++ 中的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T18:23:44.370

Book 的构造函数需要指针，但你给它取消引用的值。

```
 wants pointer       wants pointer
                                    ^                  ^                                        
                                    |                  |
                                    |                  |
Book::Book(string title, Author *pAuthor, Publisher *pPublisher, double price)
{
    title = title;
    price = price;
} 
```

但在 main() 中，

```
Book *book = new Book("Memory Management", *pAuthor, *pPublisher, 49.99);
                                             |          |
                                             |          |
                                            \/         \/
                                        Dereferenced, so its a value copied 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T18:23:54.133

如果您只是设置值，您可能应该将参数作为 const 引用接收：

```
Author::Author(const string& first, const string& last)
{
    firstName = first;
    lastName = last;
} 
```

然后以正常方式传递它们：

```
Author *pAuthor = new Author("John", "Doe"); 
```

或者，如果您仅在该方法中使用 author 对象，则实际上不需要使用`new`，只需将其放在堆栈上即可，这将避免程序中潜在的内存泄漏：

```
Author author("John", "Doe"); 
```

# javascript - 将变量 1 分配给变量 2，将变量 2 分配给变量 3 javascript

> ID：12238535
> 
> 赞同：1
> 
> 时间：2012-09-02T18:19:05.230
> 
> 标签：javascript, variables, optimization

我有一个数组，我想根据某种模式对它们进行洗牌（我正在尝试用 javascript 制作一个 rubics 立方体）。我想将 value2 分配给 value 1，将 value 1 分配给 value 3，将 value 3 分配给 value 2。我可以在 4 行代码内做到这一点，但有更短的方法吗？喜欢：

```
temp = var3; //make temporary variable
(var3 = var2) = var1;//put var2 in var3 and var3 in var1
var1 = temp;//put var3/temp in var1 
```

我知道它不会以这种方式工作，但是你们知道它的工作方式吗？这在循环 8 个变量时很有用。

谢谢，暴风雨露迪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:28:37.480

如果您处理的变量超过 2 个，最好使用数组，因为数组具有内置函数，您可以使用

```
var nums = [1,2,3]; // this is your array. it can have any length you want
// this is one line that does the magic
nums.push(nums.shift()); // to the left
nums.unshift(nums.pop()); // to the right 
```

[http://jsfiddle.net/wbKYY/2/](http://jsfiddle.net/wbKYY/2/)
[http://jsfiddle.net/wbKYY/4/](http://jsfiddle.net/wbKYY/4/)

**不管怎样**，关于你的评论。由于您将旋转的指针不是预先确定的，并且会有所不同，因此最好使用一个函数。
将遍历您定义的指针的函数。

```
function rotateArr(arr,pointers,dir) {
    var narr = arr; // create a local copy we can use it
    var savevalue;
    if (dir == 1) { // rotate to the right
        savevalue = narr[pointers[pointers.length-1]]; // save the last value
        for(var i=pointers.length-2;i>=0;i--) {
            narr[pointers[i+1]] = narr[pointers[i]];
        }
        narr[pointers[0]] = savevalue; // set the first value
    } else { // rotate to the left
        savevalue = narr[pointers[0]]; // save the first value
        for(var i=0;i<pointers.length-1;i++) {
            narr[pointers[i]] = narr[pointers[i+1]];
        }
        narr[pointers[pointers.length-1]] = savevalue; // set the last value
    }
    return narr;
}
// arr is the array of faces
// pointers is the elements which you want to rotate (an array)
// dir is either 1 or -1 
```

您可以使用执行此功能

```
nums = rotateArr(nums,[pointers],[1,-1]);
// just some examples
nums = rotateArr(nums,[0,1,2,5],1);
nums = rotateArr(nums,[3,6,1,4],-1); 
```

这是一个工作示例： http: [//jsfiddle.net/w2jGr/](http://jsfiddle.net/w2jGr/)

但是，如果您更喜欢使用只是数组方法的原型函数，您可以定义一个属性并从那里访问它。

```
Object.defineProperty(Object.prototype, "rotateArr", { value: function(pointers,dir) {
    var savevalue;
    if (dir == 1) { // rotate to the right
        savevalue = this[pointers[pointers.length-1]]; // save the last value
        for(var i=pointers.length-2;i>=0;i--) {
            this[pointers[i+1]] = this[pointers[i]];
        }
        this[pointers[0]] = savevalue;
    } else { // rotate to the left
        savevalue = this[pointers[0]]; // save the last value
        for(var i=0;i<pointers.length-1;i++) {
            this[pointers[i]] = this[pointers[i+1]];
        }
        this[pointers[pointers.length-1]] = savevalue;
    }
}, enumerable : false}); 
```

永远不建议修改对象的原型，但如果您不想要干净的代码并且想要可用性或可读性，这很有效，因为您可以调用函数

```
nums.rotate([pointers],dir); 
```

[http://jsfiddle.net/w2jGr/1/](http://jsfiddle.net/w2jGr/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:20:29.610

为什么不把你的值放在一个数组中，当你想使用不同的值时只改变索引指针？

# javascript - 在jQuery中获取变量名

> ID：12238540
> 
> 赞同：0
> 
> 时间：2012-09-02T18:19:24.690
> 
> 标签：javascript, jquery, variables, attributes

如何获取变量的名称？

假设我有一个空变量：

```
var myvariable; 
```

我怎样才能得到变量名，这样：

```
alert(this_is_what_i_am_looking_for); 
```

将显示：

```
myvariable 
```

**编辑：**

也许我把事情复杂化了。我真正的问题是我有这两个变量：

```
var firstVariable;
var secondVariable; 
```

我想创建第三个变量，它实际上具有这个名称：

```
var firstVariablesecondVariable; 
```

编辑2：

谢谢各位的解答，信息量太大了，我得好好看看。

这就是我所拥有的：

```
<div></div>
<div></div>
<div></div>

var i = 0;
var q = 0;

$('div').each(function() {
    var qi;
    i++;
});​ 
```

所以我想创建三个变量：var 00;var 01;var 02; 然后我将使用 ajax 加载更多 div 并执行以下操作：

```
q++;
i=0; 
```

所以当我第二次应用每个函数时，我还有三个变量：var 10;var 11;var 12;

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T18:37:36.610

变量名称是标识符，您不能“询问”标识符的名称。您可以做的是使用标识符的*内容创建一个新变量，如下所示：*

```
 var var1 = "variable1";
 var var2 = "variable2";

 // this will create an property/variable "variable1variable2" 
 // on the global namespace.
 window[var1 + var2] = "xyz";

 var content = variable1variable2; // content = xyz; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T18:45:36.207

也许您可以使用哈希表将名称映射到值。最后，值 barFooTest 的名称 barFoo 被添加到哈希表中。

```
var o = { bar: 'barTest' };
o.foo = 'fooTest';

var prevKey = '';
for(key in o)
{   
    prevKey = prevKey + '' + key ;
    alert(key + ': ' + o[key]);
}

o[prevKey] = "barFooTest"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:41:34.697

这是不可能的，你可以做的是使用 json 对象：

```
var myvars = {
   'firstVariable': 1,
   'secondVariable': 2,
   'firstVariablesecondVariable': function() { return this['firstVariable'] + this['secondVariable']; }
};

console.log(myvars['firstVariable'+'secondVariable']());
​ 
```

[运行代码](http://jsfiddle.net/adescalzo/4ZRfM/)

**用于编辑**

```
var elements = [];
var myformat = function(n) { return (String(n).length == 1 ? '0' : '') + n; }
$('div').each(function(i, el) {
    elements.push(myformat(i));
});

console.log(elements);
​
// response ["00", "01", "02"] 
```

[运行代码](http://jsfiddle.net/adescalzo/b6tSA/)

**编辑二**

但如果你想为变量设置值，你可以试试这个：

```
var elements = {}; // <- object
var myformat = function(n) {
    return (String(n).length == 1 ? '0' : '') + n;
}
$('div').each(function(i, el) {
    elements[myformat(i)] = el;
});

console.log(elements);​

Object
00: HTMLDivElement
01: HTMLDivElement
02: HTMLDivElement 
```

[运行代码](http://jsfiddle.net/adescalzo/zp8f4/)

# python - Python：与窗口应用程序通信

> ID：12238541
> 
> 赞同：1
> 
> 时间：2012-09-02T18:19:29.997
> 
> 标签：python, pywinauto

我正在尝试使用 python 与 Windows 应用程序通信。需要填写文本字段并检索结果（也显示在文本字段中）。目前使用 PywinAuto，效果很好，但对我来说太慢了。填写 6 个文本字段并按下两个按钮需要 2 到 3 秒……我正在寻找一种方法来加快速度。

对于 Python 初学者来说，从 Windows 应用程序控制和检索数据的最快方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T13:13:10.820

这是非常困难的。PywinAuto 是处理此类问题的最佳方法之一，但您必须非常小心您正在使用的 Windows 应用程序。这是因为并非每个 Windows 应用程序都会以可靠的方式“发布”它的控件，以便您实现自动化。Mozilla Firefox 尤其如此。但是，Microsoft Office 套件*确实*始终如一地发布了我所见过的每个界面上的几乎每个控件和按钮。因此，真正的问题不在于 PywinAuto，甚至不在于 Windows，而在于编写您试图自动化的应用程序的人，以及他们是否可靠地发布了您试图控制的接口。

您必须问自己的另一个问题是如何填充文本字段以及实际花费的时间。如果它们可以独立工作，则填写字段和按钮应该只需要几分之一秒。否则，您可能应该调查其他事情。

祝你好运。这是一个非常棘手的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T20:13:41.977

我已经使用 pywinauto 1.5 年了。我已经尝试了很多不同的 UI 自动化工具。你知道吗，pywinauto 不是其中最慢的。

Ofcource 一些动作可能需要很长的时间（几秒钟），但通常这是一个高权重的动作，例如计算孩子等。

请确保在不需要时不要调用 findwindows 方法。

# php - 我怎么知道我的 mysql_query 更新是否实际上没有更新任何东西？

> ID：12238544
> 
> 赞同：0
> 
> 时间：2012-09-02T18:19:41.717
> 
> 标签：php, mysql, insert, sql-update

我正在为可能不存在的行更新表。如果它不存在，我需要进行插入。我最初计划知道我需要根据更新语句的负返回值进行插入，但它没有返回任何负值。

我怎么知道更新没有做任何事情？做另一个查询，看看是否有任何东西？或者也许之前的查询？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T18:21:08.010

使用[http://php.net/manual/en/function.mysql-affected-rows.php](http://php.net/manual/en/function.mysql-affected-rows.php)

> 通过与 link_identifier 关联的最后一个 INSERT、UPDATE、REPLACE 或 DELETE 查询获取受影响的行数。

```
<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
mysql_select_db('mydb');

/* this should return the correct numbers of deleted records */
mysql_query('DELETE FROM mytable WHERE id < 10');
printf("Records deleted: %d\n", mysql_affected_rows());

/* with a where clause that is never true, it should return 0 */
mysql_query('DELETE FROM mytable WHERE 0');
printf("Records deleted: %d\n", mysql_affected_rows());
?> 
```

如果您使用`mysqli`而不是`mysql`(**很久**`mysql`以前已弃用)，它是.**[`mysqli_affected_rows`](http://php.net/manual/en/mysqli.affected-rows.php)**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:33:22.490

简单`mysql_affected_rows`的方法是在表存在与否的情况下找出表中变化的方法。但是，为了优化代码，最好先检查表是否存在，例如：

```
$status = mysql_query("select * from table_name");
if($status==false){
   echo "table don't exists";
}
else{
  //do your stuff here
} 
```**

# javascript - 如何通过 JavaScript 保存图像

> ID：12238545
> 
> 赞同：3
> 
> 时间：2012-09-02T18:19:54.487
> 
> 标签：javascript

当用户选择照片并单击按钮时，我想将图像文件（jpeg 图像）下载到用户文件系统。到目前为止，我搜索并找到[了这个链接](http://stuartk.com/jszip/)和[这个](https://github.com/dcneiner/Downloadify)

我在一篇博客中看到，与 jszip 一起使用时，downloadify 可以启用此功能，但它没有对此进行进一步说明。有谁知道怎么下载图片。我有图像的链接，我只是希望用户将其下载到他的系统上，而不是再次查询服务器。

谁能给我一个例子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T19:01:24.183

您可以在画布元素中加载图像，获取画布的数据 url 并以数据 url 作为源打开一个新窗口。看看这个例子：[https ://gist.github.com/1875132](https://gist.github.com/1875132)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-23T15:12:06.333

使用 HTML5**`download`**属性。

作为选择，您可以将*文件名*设置为属性值。

```
<a href="/images/image-name.jpg" download="new-image-name.jpg"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-07T19:01:11.947

最后我做到了。对于将来可能需要这个的任何人，这里是我使用 jquery 的方式

```
jQuery.ajax({

    url: 'http://localhost:8080/yourwebsite/servlet?img=' + document.getElementById(id).alt,
    //data: myData,
    type: 'GET',
    crossDomain: true,
    dataType: 'jsonp',
   // success: function() { alert("Success"); },
   // error: function() { alert('Failed!'); },
   // beforeSend: setHeader
}); 
```

这是我不得不遇到的跨域 http 请求的问题，除非您遵循一些冗长的过程，否则大多数网站通常会阻止这些请求。所以，我让它变得更简单，并在我的 servlet 中调用了一个 get 方法，并将它从中下载图像的图像的 url 传递给它。如果你在同一个域上，这更容易做，甚至更容易，但那没有'不符合我的要求，这段代码对我有用:)

# windows-phone-7 - WP7 中的媒体元素

> ID：12238547
> 
> 赞同：1
> 
> 时间：2012-09-02T18:20:23.000
> 
> 标签：windows-phone-7, media, mediaelement

在 windows phone 7 中 .. 我使用 medialement 元素从 URL 播放 mp3 音频 ..

音频第一次播放没有任何故障..但是当第二次设置源时，它会引发以下异常：

```
AG_E_NETWORK_ERROR 
```

可能是什么问题呢

注意：我尝试播放相同的音频文件，但它也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T03:59:08.293

这是由于 Silverlight 中的 URL 限制。答案的完整描述在这里[http://msdn.microsoft.com/en-us/library/cc189008(VS.95).aspx](http://msdn.microsoft.com/en-us/library/cc189008(VS.95).aspx)

> 出于安全原因，Silverlight 运行时限制从 System.Net 命名空间中的 WebClient 和 HTTP 类访问某些 URL 类。运行时对其他类（包括 System.Windows.Controls 命名空间中的 Image 和 MediaElement 类）应用了类似的访问限制。运行时还根据 URL 的类对 XAML 源文件和字体文件应用访问限制。这些限制在 Silverlight 2 和更高版本的运行时中实现。受影响的连接是对跨区域、跨域和跨方案 URL 的访问。这些限制旨在防止网络威胁（例如，基于从 Internet 服务器运行的 Silverlight 应用程序访问本地 Intranet 服务器上的资源的威胁）。

# ado.net - 连接字符串中初始目录和数据库关键字之间的区别

> ID：12238548
> 
> 赞同：92
> 
> 时间：2012-09-02T18:20:28.360
> 
> 标签：ado.net

连接字符串中`Initial Catalog`和关键字的主要区别是什么？`Database`

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2012-09-02T18:21:02.550

唯一的区别是名称。

这些可以互换使用。

请参阅 的文档[`SqlConnectionStringBuilder.InitialCatalog`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnectionstringbuilder.initialcatalog.aspx)，在备注下：

> 此属性对应于连接字符串中的**“初始目录”**和**“数据库”键。**

（强调我的）

# java - 从 Java 运行 Linux 命令 - runtime.exe

> ID：12238551
> 
> 赞同：4
> 
> 时间：2012-09-02T18:20:58.773
> 
> 标签：java, linux, find, command, runtime

我正在尝试使用 Java 运行时运行以下命令：

```
find /home/Alison/workspace/FunctionalTestFramework/src/com/q1labs/qa/selenium/screens -type d |   awk -F/ 'NF <= old_NF {print prev} {old_NF=NF; prev=$0} END {print $0}' 
```

该命令在直接输入终端时工作正常，但在以下函数中运行时会出现以下错误：

```
find: paths must precede expression: |
Usage: find [-H] [-L] [-P] [-Olevel] [-D help|tree|search|stat|rates|opt|exec] [path...] [expression]
Process exitValue: 1 
```

Java函数：

```
 try
        {            
            Runtime rt = Runtime.getRuntime();
            Process proc = rt.exec("find /home/Alison/workspace/FunctionalTestFramework/src/com/q1labs/qa/selenium/screens -type d |   awk -F/ 'NF <= old_NF {print prev} {old_NF=NF; prev=$0} END {print $0}'");
            InputStream stderr = proc.getErrorStream();
            InputStreamReader isr = new InputStreamReader(stderr);
            BufferedReader br = new BufferedReader(isr);
            String line = null;
            while ( (line = br.readLine()) != null)
                System.out.println(line);
            int exitVal = proc.waitFor();
            System.out.println("Process exitValue: " + exitVal);
        } catch (Throwable t)
          {
            t.printStackTrace();
          } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:15:10.583

正如我所评论的，您可以`exec`使用 shell，例如`/bin/sh`，`-c`后跟要解释的字符串。这就是标准 C 中的[system(3)](http://www.kernel.org/doc/man-pages/online/pages/man3/system.3.html)函数在 Unix 和 Posix 系统上所做的事情。

但是，我只是建议编写一个 shell 脚本来执行您的复杂命令，然后执行该 shell 脚本。这提供了在不更改 Java 代码的情况下（测试和）改进该 shell 脚本的能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:27:02.583

尝试更换：

```
rt.exec("find /home/Alison/workspace/FunctionalTestFramework/src/com/q1labs/qa/selenium/screens -type d |   awk -F/ 'NF <= old_NF {print prev} {old_NF=NF; prev=$0} END {print $0}'"); 
```

这样：

```
rt.exec(new String[]{"find", "/home/Alison/workspace/FunctionalTestFramework/src/com/q1labs/qa/selenium/screens", "-type", "d"}); 
```

请注意，您将无法运行任何使用管道的命令，`|`因为像管道这样的重定向运算符是 shell 功能，但传递给 exec() 的命令不会在命令 shell 中运行。

# python - 在 Jinja2 中将子模板中的值注入父模板

> ID：12238556
> 
> 赞同：1
> 
> 时间：2012-09-02T18:21:30.133
> 
> 标签：python, jinja2

我创建了一个名为 course.html 的 Jinja2 模板，它定义了课程的基本结构。由此，我为每节实际课程派生一个子模板（因为每节课的内容不同）。例如，intro.html、variables.html、lists.html 和functions.html 都派生自lesson.html。

除了幻灯片、练习等等，每节实际课程都有一个 YouTube 视频。我想将视频的 ID 放在子模板文件中，然后将实际引用视频的 HTML 放在父模板（即 course.html）中，以确保每个视频都以相同的方式引用和格式化。例如，我希望 course.html 看起来像：

```
<div class="youtube"><br/>
    <iframe title="{{TITLE}}" time="{{TIME}}" src="http://www.youtube.com/embed/{{ID}}"></iframe>
<br/>
</div> 
```

然后在子模板文件本身中定义 TITLE、TIME 和 ID（因为这是存储它们的最合乎逻辑的位置）。我目前的技巧是创建一个函数，将这些值作为参数并返回要插入到正确位置的 HTML 块：

```
{{youtube("Title of this Lecture", "abcde01234", "05:10")|safe}} 
```

但是 (a) 我宁愿使用直接模板扩展而不是函数调用，并且 (b) 课程模板文件中没有明确标识标题、YouTube ID 和时间（这使得它们更难提取以在其他地方使用：我可以用正则表达式来做，但我真的不想）。

有没有一种干净的方法来定义子模板中的值以在父模板中使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-26T02:05:26.083

可以使用[set](http://jinja.pocoo.org/docs/dev/templates/#assignments)，DOC 如下：

> 在代码块中，您还可以为变量赋值。顶层（块、宏或循环之外）的分配像顶层宏一样从模板中导出，并且可以由其他模板导入。

可以在[此处](https://stackoverflow.com/questions/24833370/pass-variables-from-child-template-to-parent-in-jinja2?rq=1)找到相同的问题。

# c# - 优化 SQL 连接

> ID：12238557
> 
> 赞同：0
> 
> 时间：2012-09-02T18:21:33.650
> 
> 标签：c#, asp.net, sql-server

我注意到执行查询时连接数据库需要很长时间。是否可以以这种方式编写一个具有始终打开的数据库连接的 asp.net 应用程序？还是编写服务并让 asp.net 应用程序与该服务通信更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:36:00.803

您可以使用连接池来节省初始化连接所需的时间。顺便说一句，[SQL-Server 支持它 OOTB](http://msdn.microsoft.com/en-us/library/8xx3tyca.aspx)，所以你不必自己实现它。使用哪种方式连接数据库并不重要（ADO.NET、DAAB 等）

至于你的第二个建议，编写一个服务并让应用程序向它传达请求：在这种情况下它不会有帮助，因为你只是将问题转移到另一个进程，但完成请求的累积时间仍然存在*甚至增长*，考虑额外的网络时间。

# c# - 让布局控件出现在 UserControl 中

> ID：12238560
> 
> 赞同：1
> 
> 时间：2012-09-02T18:22:19.263
> 
> 标签：c#, wpf, layout, user-controls

我正在尝试编写一个`UserControl`允许其中的单个控件（如`Label`）以及“布局”控件`StackPanel`和朋友的“布局”控件。

我很难做到这一点。我的代码适用于单个控件，但不适用于布局控件。我觉得这是一个明显的修复，我是 WPF 的新手。这是`UserControl`XAML：

```
<UserControl <!-- namespaces omitted for brevity -->>
    <UserControl.ContentTemplate>
        <DataTemplate>
            <ContentPresenter Content="{TemplateBinding Content}" />
        </DataTemplate>
    </UserControl.ContentTemplate>
</UserControl> 
```

当我尝试像这样使用它时：

```
<my:SpecialUserControl>
    hello
</my:SpecialUserControl> 
```

没关系。但是当我尝试做类似的事情时

```
<my:SpecialUserControl>
    <StackPanel>
        <!-- stuff -->
    </StackPanel>
</my:SpecialUserControl> 
```

我在 Visual Studio Intellisense 中收到错误提示

> 无法将指定的值分配给集合。预期以下类型：`UIElement`

当我运行应用程序（它构建）时，我在 XAML 中的那个地方得到这个异常：

> “向类型集合添加值`System.Windows.Controls.UIElementCollection`引发异常。” 行号`x`和行位置`y`。

我该怎么做才能让我`UserControl`能够接受任何类型的内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T04:33:54.097

继承您的 UserControl 从`ContentControl`. `ContentControl`已经有 Content 属性与`ContentPresenter`inside相结合`ControlTemplate`。

您还可以使用 microsoft blend 来获取 ContentControls 可视化树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:48:33.017

`ContentPresenter`应该是控件的**ControlTemplate** ( )的一部分`<UserControl.Template>`，而不是在`ContentTemplate`. 我认为这可能是你的问题。

# c# - .Net（C#）中与 ISNULL() 等效的方法是什么？

> ID：12238561
> 
> 赞同：2
> 
> 时间：2012-09-02T18:22:35.607
> 
> 标签：c#, sql, entity-framework, ado.net

我有一个用于我的购物车系统的存储过程，它返回总金额，看起来像这样；

```
ALTER PROCEDURE [dbo].[ShoppingCartGetTotalAmount]
(@CartID char(36))
AS
SELECT ISNULL(SUM(Product.Price * ShoppingCart.Quantity), 0)
FROM ShoppingCart INNER JOIN Product
ON ShoppingCart.ProductID = Product.ProductID
WHERE ShoppingCart.CartID = @CartID 
```

但是，现在我想在实体框架中做同样的事情。因此，我需要知道以下任一选项；
**1）我怎样才能在实体框架中完成上述任务，即**

```
SELECT ISNULL(SUM(Product.Price * ShoppingCart.Quantity), 0)
    FROM ShoppingCart INNER JOIN Product
    ON ShoppingCart.ProductID = Product.ProductID
    WHERE ShoppingCart.CartID = @CartID 
```

**2) 或者 C# 中 SQL ISNULL() 函数的等价物是什么？**
**3）或者我怎样才能做到这一点 - >** `ISNULL(SUM(Product.Price * ShoppingCart.Quantity), 0)` **使用任何.Net方法？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T18:24:58.113

C# 具有[空合并运算符](http://msdn.microsoft.com/en-us/library/ms173224.aspx)- `??`。

> 这 ？？运算符称为空值合并运算符，用于为可空值类型或引用类型定义默认值。如果操作数不为空，则返回左侧操作数；否则返回正确的操作数。

EF 理解该运算符并正确翻译它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T18:28:46.673

如果您试图确定从数据库中读取的值在数据库中是否为空，则需要将该值与 DBNull.Value 进行比较。

例如，假设在下面的代码中 oTotal 持有 Price * Quantity 的数据库结果，下面是 SQL ISNULL 操作的等价物：

```
decimal dTotal = (oTotal == DBNull.Value ? 0 : Convert.ToDecimal(oTotal)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:34:21.193

在 C# 中，存在一个扩展方法，即[GetValueOrDefault](http://msdn.microsoft.com/en-us/library/72cec0e0%28v=vs.80%29.aspx)用于可空类型。所以你也可以试试这个。如果 null 包含，它将返回默认值。

```
decimal? oTotal = null;
decimal dTotal = oTotal.GetValueOrDefault(0); 
```

# c++ - 属性组合在 Boost::spirit 中不起作用

> ID：12238562
> 
> 赞同：1
> 
> 时间：2012-09-02T18:22:42.553
> 
> 标签：c++, boost, boost-spirit

[文档](http://www.boost.org/doc/libs/1_50_0/libs/spirit/doc/html/spirit/karma/reference/operator/sequence.html)说，如果同时使用 A 和 B，则两个复合规则 (a >> b) 的属性应该是元组。

假设这一点，我试图读出这样一个元组的第一个属性。但它失败了：（
我尝试将解析的整数存储在'i'中）

```
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix_core.hpp>
#include <boost/spirit/include/phoenix_operator.hpp>
#include <boost/spirit/include/phoenix_object.hpp>

template <typename ForwardIterator> class TestGrammar
: public boost::spirit::qi::grammar<ForwardIterator, boost::spirit::ascii::space_type>
{
    boost::spirit::qi::rule<ForwardIterator, boost::spirit::ascii::space_type> foo_;
public:
    TestGrammar( void ) : TestGrammar::base_type( foo_ )
    {
        int i;
        foo_ = ((boost::spirit::qi::int_ >> boost::spirit::qi::float_)
                      [boost::phoenix::ref(i) = boost::phoenix::at_c<0>(boost::spirit::_1)]);
    }
};

int main( void )
{
    TestGrammar<std::string::iterator> g;

    return 0;
} 
```

写作：

```
foo_ = ((boost::spirit::qi::int_ >> boost::spirit::qi::float_)
                     [boost::phoenix::ref(i) = boost::spirit::_1]); 
```

只要 A 是一个 int，它将始终有效。
来回更改类型并编写自定义规则表明，无论 B 是什么，(a >> b) 的属性都将始终为 A。

甚至

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T23:13:07.953

我猜你想这样做：

```
int i;
float f;
foo_ = (boost::spirit::qi::int_ >> boost::spirit::qi::float_)
             [ boost::phoenix::ref(i) = boost::spirit::_1,
               boost::phoenix::ref(f) = boost::spirit::_2 ]; 
```

如果您真的想使用该序列，请尝试：

```
foo_ = qi::attr_cast<>(qi::int_ >> qi::float_)
                [ boost::phoenix::ref(i) = phx::at_c<0>(qi::_1),
                  boost::phoenix::ref(f) = phx::at_c<1>(qi::_1) ] 
```

或者使用辅助规则：

```
helper = qi::int_ >> qi::float_;
foo_ = helper
                [ boost::phoenix::ref(i) = phx::at_c<0>(qi::_1),
                  boost::phoenix::ref(f) = phx::at_c<1>(qi::_1) ]
    ; 
```

**[所有三个版本都在http://liveworkspace.org/code/518f2bd03e1fed7ed734d62071a88eab](http://liveworkspace.org/code/518f2bd03e1fed7ed734d62071a88eab)**编译

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:27:16.437

如果你编译这个：

```
struct TestDelegate
{
    template <typename T, typename U, typename V>
    void operator()(T const& t, U const& u, V const& v) const {
        bar;
    }
};

template <typename ForwardIterator> class TestGrammar
: public boost::spirit::qi::grammar<ForwardIterator, boost::spirit::ascii::space_type>
{
    boost::spirit::qi::rule<ForwardIterator, boost::spirit::ascii::space_type> foo_;
public:
    TestGrammar( void ) : TestGrammar::base_type( foo_ )
    {
        //int i;
        TestDelegate test_delegate;
        //foo_ = ((boost::spirit::qi::int_ >> boost::spirit::qi::float_)
        //              [boost::phoenix::ref(i) = boost::phoenix::at_c<0>(boost::spirit::_1)]);
        foo_ = ((boost::spirit::qi::int_ >> boost::spirit::qi::float_)
                      [test_delegate]);
    }
};

int main( void )
{
    TestGrammar<std::string::iterator> g;

    return 0;
} 
```

您应该在生成的错误文章中看到属性类型是一个元组：

```
1>e:\work\test\spiritprob\spiritprob\spiritprob.cpp(14) : error C2065: 'bar' : undeclared identifier
1>        e:\boost\boost_1_44_0\boost_1_44_0\boost\spirit\home\support\action_dispatch.hpp(29) : see reference to function template instantiation 'void TestDelegate::operator ()<Attribute,Context,bool>(const T &,const U &,const V &) const' being compiled
1>        with
1>        [
1>            Attribute=boost::fusion::vector2<int,float>,
1>            Context=boost::spirit::context<boost::fusion::cons<boost::fusion::unused_type &,boost::fusion::nil>,boost::fusion::vector0<>>,
1>            T=boost::fusion::vector2<int,float>,
1>            U=boost::spirit::context<boost::fusion::cons<boost::fusion::unused_type &,boost::fusion::nil>,boost::fusion::vector0<>>,
1>            V=bool
1>        ] 
```

（用 Visual Studio 2008 编译）

不能直接解决我们的问题，但至少你知道它确实作为一个`fusion::vector<int,float>`

# ssh - 我终止远程会话后，Tornado 立即停止在 AWS 上运行

> ID：12238567
> 
> 赞同：3
> 
> 时间：2012-09-02T18:23:27.677
> 
> 标签：ssh, amazon-web-services, tornado

我正在使用 SSH 在 Amazon Web Service 上远程启动 Tornado。当我通过以下方式启动它时它工作正常：

python startTornado.py

但是，在我的 SSH 会话超时或终止后，Tornado 服务器也立即停止，因此我无法再访问该网页。我做了很多搜索，但在谷歌上找不到答案。

如何在 SSH 会话终止后保持 Tornado 和站点运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T19:06:17.187

如果进程在前台运行，或者如果它尝试写入标准输出并且它输出到的终端不再存在，则该进程将在您注销时关闭。尝试启动服务器

```
nohup python startTornado.py & 
```

nohup 命令将输出重定向到文件，最后的 & 在后台运行命令。或者，您可以使用 screen 实用程序，它允许您分离终端并在不同的 ssh 会话中重新附加它（有关详细信息，请参阅 screen 手册页）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-03T02:13:57.017

虽然上述所有解决方案都解决了眼前的问题，但您可能真正需要在生产中运行这些进程，控制它们（启动/重启/停止）是[supervisor](http://supervisord.org/)。它是基于 python 的，当您必须在 nginx 后面运行多个龙卷风实例时，它更有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T19:13:18.237

除了`nohup`凯文提到的，[`disown`](http://docstore.mik.ua/orelly/unix3/upt/ch23_11.htm)如果你使用 bash，你也可以使用命令：

```
disown <job-id> 
```

# c# - 线程池多客户端 TCP（消息处理）

> ID：12238568
> 
> 赞同：2
> 
> 时间：2012-09-02T18:23:28.253
> 
> 标签：c#, multithreading, tcp, client, threadpool

我刚刚了解到您可以将线程池​​用于多客户端 TCP 连接，我今天有一个 C# 应用程序，我想实现它。我已经阅读了一些，例如这个问题的第一个答案（[接受多个 tcp 客户端的最佳方式？](https://stackoverflow.com/questions/7104293/best-way-to-accept-multiple-tcp-clients)），但我真的不知道如何根据我的“需求”进行最后的调整。我对每个连接都有一个消息处理功能（每个连接是 2 个线程，一个用于接收/发送消息（连接大部分时间打开很长时间），一个用于根据消息执行任务（也创建发送回的答案） . 我现在想使用下面链接中的接收方法，但是在我的示例中如何使用线程池来执行此操作？

如果有什么不清楚的，请提出问题！

/缺口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:31:10.787

只是避免每个连接有一个线程。它会在操作系统上产生大量开销并且不能很好地扩展。

今天我们使用 NIO：非阻塞 I/O。一个线程可以处理 10k+ 个连接。使用它们的方法非常简单，例如 NodeJs。NIO 库可用于大多数平台/语言（Netty for Java、NodeJs with javascript...）。

您应该指定您正在使用的语言/环境。

# c# - 如果主窗口关闭，如何让自定义窗口关闭？

> ID：12238576
> 
> 赞同：1
> 
> 时间：2012-09-02T18:24:07.623
> 
> 标签：c#, wpf, expression-blend

我使用 Expression Blend 4 为我的 WPF 应用程序设计了一个自定义消息框。我将生成的 MyCustomBox.xaml 复制到我的项目中，更改了命名空间以直接访问它。

我的问题是如何使主窗口成为我的自定义框的父级？如果我关闭我的主窗口，自定义框仍将显示。如果主窗口正在关闭，我想让自定义框关闭。我的自定义消息框是 Window 的子类。

在此先感谢您的任何提示:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:31:46.713

将`Owner`弹出窗口的 设置为主窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:41:40.540

`Application.Shutdown`如果关闭主窗口应该使应用程序退出，您也可以调用主窗口关闭。

# javascript - $.getImageData 不起作用，因为 img-to-json 已关闭？

> ID：12238581
> 
> 赞同：3
> 
> 时间：2012-09-02T18:24:27.940
> 
> 标签：javascript, image-processing, getimagedata

我正在尝试使用[Pixastic](http://www.pixastic.com/)对外部图像进行一些图像处理。我知道我需要使用[$.getImageData](http://www.maxnov.com/getimagedata/)对外部图像进行操作，否则由于画布“被跨域数据污染”，您将获得 DOM Exception 18。不幸的是，$.getImageData 使用的应用程序服务“img-to-json”因“503 Over Quota”错误而关闭，并且已经持续了好几天。我发现另一个名为“img2json”的服务昨天实际上工作了一段时间，但我不完全确定它是否做同样的事情（我认为 img2json 只为您提供基本元数据，而不是实际像素数据）。所以，我的实际问题是：

*   “img2json”和“img-to-json”是同一个服务吗？如果是这样，也许我可以修改 $.getImageData 代码以使用 img2json。

*   经常看到 apppot 应用程序像这样停机吗？img-to-json 在不久的将来重新出现的机会有多大？

*   如果没有，将这些外部图像临时下载到服务器，对它们进行图像处理，然后删除它们有多容易？是否可以仅使用 javascript 来做到这一点？

# javascript - 消除移动 Safari 中点击事件的 300 毫秒延迟

> ID：12238587
> 
> 赞同：92
> 
> 时间：2012-09-02T18:25:10.063
> 
> 标签：javascript, jquery, jquery-mobile, safari, touch

我读过[移动版 Safari](https://developers.google.com/mobile/articles/fast_buttons?hl=de-DE.)从点击链接/按钮到事件触发的时间有 300 毫秒的点击事件延迟。延迟的原因是等待查看用户是否打算双击，但从 UX 角度来看，等待 300 毫秒通常是不可取的。

消除这 300 毫秒延迟的[一种解决方案是使用 jQuery Mobile“点击”处理。](http://www.mikedellanoce.com/2012/09/10-tips-for-getting-that-native-ios.html)`touchend`不幸的是，我不熟悉这个框架，如果我只需要一两行以正确方式应用的代码，我不想加载一些大框架。

像许多网站一样，我的网站有很多这样的点击事件：

```
$("button.submitBtn").on('click', function (e) {   
  $.ajaxSubmit({... //ajax form submisssion
});

$("a.ajax").on('click', function (e) {   
  $.ajax({... //ajax page loading
});

$("button.modal").on('click', function (e) {   
      //show/hide modal dialog
}); 
```

我想做的是使用这样的单个代码片段消除**所有这些点击事件的 300 毫秒延迟：**

```
$("a, button").on('tap', function (e) {
 $(this).trigger('click');
 e.preventDefault();
}); 
```

这是一个坏/好主意吗？

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2014-01-11T12:21:00.560

现在，如果您设置视口，一些移动浏览器会消除 300 毫秒的点击延迟。您不再需要使用变通方法。

```
<meta name="viewport" content="width=device-width, user-scalable=no"> 
```

目前**支持 Android 版 Chrome、Android 版**Firefox**和**iOS**版 Safari**

~~**但是在 iOS Safari 上**，双击是不可缩放页面上的滚动手势。出于这个原因**，他们无法消除 300ms 延迟**。如果他们不能消除不可缩放页面上的延迟，他们就不可能在可缩放页面上消除它。~~

~~**Windows Phone**在不可缩放页面上也保留了 300 毫秒的延迟，但它们没有像 iOS 那样的替代手势，因此它们可以像 Chrome 那样消除这种延迟。~~您可以使用以下方法消除 Windows Phone 上的延迟：

```
html {
-ms-touch-action: manipulation;
touch-action: manipulation;
} 
```

来源：[http ://updates.html5rocks.com/2013/12/300ms-tap-delay-gone-away](http://updates.html5rocks.com/2013/12/300ms-tap-delay-gone-away)

**2015 年 12 月更新**

到目前为止，iOS 上的 WebKit 和 Safari 在单击激活链接或按钮之前有 350 毫秒的延迟，以便人们通过双击来放大页面。几个月前，Chrome 已经通过使用更智能的算法来检测这一点改变了这一点，而[WebKit 将采用类似的方法](https://webkit.org/blog/5610/more-responsive-tapping-on-ios/)。这篇文章提供了一些很棒的见解，浏览器如何使用触摸手势，以及浏览器如何仍然比现在更智能。

**2016 年 3 月更新**

在 iOS 版 Safari 上，检测第二次点击的 350 毫秒等待时间已被移除，以创建“快速点击”响应。这对于声明具有宽度=设备宽度或用户可缩放=否的视口的页面启用。[作者还可以通过使用此处](https://webkit.org/blog/5610/more-responsive-tapping-on-ios/)`touch-action: manipulation`记录的 CSS （向下滚动到“样式化快速点击行为”标题）和[此处](http://www.w3.org/TR/pointerevents/#the-touch-action-css-property)的 CSS 来选择对特定元素进行快速点击行为。

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2012-11-05T01:08:58.580

[这个由金融时报开发的插件-FastClick](https://github.com/ftlabs/fastclick) 为您完美！

确保添加`event.stopPropagation();`和/或`event.preventDefault();`直接在点击功能之后，否则它可能会像我一样运行两次，即：

```
$("#buttonId").on('click',function(event){
    event.stopPropagation(); event.preventDefault();
   //do your magic

}); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-04-29T22:08:43.327

我知道这很旧，但你不能测试一下浏览器是否支持“触摸”吗？然后创建一个“touchend”或“click”变量并将该变量用作绑定到您的元素的事件？

```
var clickOrTouch = (('ontouchend' in window)) ? 'touchend' : 'click';
$('#element').on(clickOrTouch, function() {
    // do something
}); 
```

因此，该代码示例检查浏览器是否支持“touchend”事件，如果不支持，则使用“click”事件。

（编辑：将“touchend”更改为“ontouchend”）

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-05-24T14:19:01.460

我遇到了一个[非常受欢迎的替代方案，称为 Hammer.js](http://eightmedia.github.io/hammer.js/) [（Github 页面）](https://github.com/EightMedia/hammer.js/)，我认为这是最好的方法。

Hammer.js 是一个比 Fastclick.js（最受好评的答案）功能更全面的触摸库（有许多滑动命令）。

*但请注意：*当您使用 Hammer.js 或 Fastclick.js 时，在移动设备上快速滚动往往会真正锁定 UI。如果您的网站有一个新闻源或用户会经常滚动的界面（看起来像大多数网络应用程序），这将是一个主要问题。出于这个原因，我目前没有使用这些插件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-02T20:14:28.520

不知何故，禁用缩放似乎禁用了这个小延迟。有道理，因为那时不再需要双击。

[如何“禁用”移动网页的缩放？](https://stackoverflow.com/questions/4472891/how-can-i-disable-zoom-on-a-mobile-web-page)

但请注意这将产生的可用性影响。它可能对设计为应用程序的网页有用，但不应该用于更通用的“静态”页面恕我直言。我将它用于需要低延迟的宠物项目。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-02T18:56:41.803

不幸的是，没有简单的方法可以做到这一点。因此，仅使用`touchstart`or`touchend`会给您带来其他问题，例如单击按钮时有人开始滚动。我们使用[zepto](http://zeptojs.com/)有一段时间了，即使有了这个非常好的框架，随着时间的推移也出现了一些问题。其中很多是[封闭](https://github.com/madrobby/zepto/issues/search?q=tap)的，但似乎不是一个简单解决方案的领域。

我们有这个解决方案来全局处理链接点击：

```
 $(document.body).
    on('tap', 'a',function (e) {
      var href = this.getAttribute('href');
      if (e.defaultPrevented || !href) { return; }
      e.preventDefault();
      location.href= href;
    }).
    on('click', 'a', function (e) {
      e.preventDefault();
    }); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-08-15T20:11:41.977

我搜索了一种没有 jquery 和 fastclick 库的简单方法。这对我有用：

```
var keyboard = document.getElementById("keyboard");
var buttons = keyboard.children;
var isTouch = ("ontouchstart" in window);
for (var i=0;i<buttons.length;i++) {
    if ( isTouch ) {
        buttons[i].addEventListener('touchstart', clickHandler, false);         
    } else {
        buttons[i].addEventListener('click', clickHandler, false);          
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-12-07T23:20:11.160

在 jQuery 中，您可以绑定“touchend”事件，在点击后立即触发代码（就像键盘中的按键）。在当前的 Chrome 和 Firefox 平板电脑版本上测试。对于您的触摸屏笔记本电脑和台式设备，也不要忘记“点击”。

```
jQuery('.yourElements').bind('click touchend',function(event){

    event.stopPropagation();
    event.preventDefault();

	// everything else
});
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-03-07T10:02:30.350

只是为了提供一些额外的信息。

在 iOS 10`<button>`上，我的页面上的 s 无法连续触发。总是有一个滞后。

我试过fastclick / Hammer / tapjs /用touchstart替换click，都失败了。

更新：原因似乎是按钮太靠近边缘！将它移到中心附近并滞后消失！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-08-15T21:23:41.613

**你应该明确声明被动模式**：

```
window.addEventListener('touchstart', (e) => {

    alert('fast touch');

}, { passive : true}); 
```

# c# - 需要正数，如何解决这个错误？

> ID：12238592
> 
> 赞同：-1
> 
> 时间：2012-09-02T18:25:32.153
> 
> 标签：c#, winforms, csv, filehelpers

![在此处输入图像描述](../Images/2f8ca5d2922a26ceab70d812c3a71f73.png)
我正在尝试在我的项目中实现 FILEHELPER 2.0，但是一些带有“”引用的 csv 文件面临问题。它显示错误（显示此错误日志）

**" LineNumber | LineString |ErrorDescription 2|"Symbol","Date","Expiry","Strike Price","Open","High","Low","Close","LTP","结算价“，“不。of contract","Turnover in Lacs","Open Int","Change in OI","Underlying Value "|长度不能小于零。-> 参数名称：长度不能小于零。-> 参数名称：长度 3|" **

我的代码是这样的：

```
 var engine = new FileHelperEngine<script>();
   engine.Options.IgnoreFirstLines = 1; // skipping the header line

   script[] res = engine.ReadFile("agile.csv");  <<<<< at this line error occred 
```

和我的课程文件：

```
 [DelimitedRecord(",")]
      public class script
    {
         [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
        public string Symbol;
         [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
        public string Date;
         [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
        public string Expiry;
         [FieldQuoted('"', QuoteMode.AlwaysQuoted)]

       ...
    } 
```

和 csv 文件是 .

"交易品种","日期","到期","行权价","开盘价","最高价","最低价","收盘价","LTP","结算价","合约数量"," Lacs 的营业额","Open Int","OI 的变化","基础价值"

"漂亮","2012 年 8 月 31 日","2012 年 9 月 27 日","5400.00","56.00","56.90","38.05","44.45","43.55","44.45","281087 ","765592.77","4845150","1334150","5258.50"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T08:38:08.053

我看不出您的错误有任何原因：以下代码可以正常工作：

```
[DelimitedRecord(",")]
public class Script
{
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string Symbol;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string Date;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string Expiry;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string StrikePrice;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string Open;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string High;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string Low;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string Close;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string LTP;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string SettlePrice;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string NoOfContracts;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string TurnOverInLacs;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string OpenInt;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string ChangeInOI;
    [FieldQuoted('"', QuoteMode.AlwaysQuoted)]
    public string UnderlyingValue;
}

class Program
{
    static void Main(string[] args)
    {
        string input = @"""Symbol"",""Date"",""Expiry"",""Strike Price"",""Open"",""High"",""Low"",""Close"",""LTP"",""Settle Price"",""No. of contracts"",""Turnover in Lacs"",""Open Int"",""Change in OI"",""Underlying Value """ + Environment.NewLine +
            @"""NIFTY"",""31-Aug-2012"",""27-Sep-2012"","" 5400.00"","" 56.00"","" 56.90"","" 38.05"","" 44.45"","" 43.55"","" 44.45"","" 281087"","" 765592.77"","" 4845150"","" 1334150"","" 5258.50""";

        var engine = new FileHelperEngine<Script>();
        engine.Options.IgnoreFirstLines = 1; // skipping the header line

        Script[] validRecords = engine.ReadString(input);

        // Check the third record
        Assert.AreEqual("NIFTY", validRecords[0].Symbol);
        Assert.AreEqual("31-Aug-2012", validRecords[0].Date);
        Assert.AreEqual("27-Sep-2012", validRecords[1].Date);
        // etc...            

        Console.WriteLine("All assertions passed");
        Console.Read();
    }
} 
```

# textmate2 - 如何启用软标签 textmate2

> ID：12238593
> 
> 赞同：0
> 
> 时间：2012-09-02T18:25:44.340
> 
> 标签：textmate2

我已经看到了一些其他的答案，但我的同事表现得很有趣。我无法启用软标签，现在我正在使用 haml，这变得很烦人。有任何想法吗？

附加的屏幕截图，softtabs 选项是灰色的。我错过了什么？

谢谢，JD

![在此处输入图像描述](../Images/c49568d4154131d6baf78812c41bf3b9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-15T13:51:46.820

如果您希望在任何地方启用软标签，请将以下内容添加到`.tm_properties`您的主目录中的文件中。如果你没有它，只需创建一个。

如果您只想为特定项目启用它，只需`.tm_properties`在项目目录中创建一个文件。

```
softTabs = true
tabSize  = 4 
```

如果您只想为某些文件类型启用 Soft Tab，您可以像这样向文件中添加一个部分：

```
[ *.coffee ]
softTabs = true
tabSize = 2 
```

我建议您查看这些文件的工作原理。这是[hmans 的一个例子](https://github.com/hmans/homedir/blob/master/.tm_properties)。

另请查看[Textmate 2 Tips](http://tm2tips.tumblr.com/)了解更多信息。

**更新**

正如 Michael Sheets 在他的回答中所写，现在可以通过 GUI 保存更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T00:31:30.653

从 r9290 开始，您现在可以从编辑窗口底部的菜单中更改选项卡设置，如果适用，它们将被保存为当前文件类型和父文件类型。

这些保存在其中，您可以在（帮助 → 发行说明）`Global.tmProperties`的发行说明中阅读更多信息。`r9290`

# java - 将 RadioButton 组添加到 JTable

> ID：12238597
> 
> 赞同：0
> 
> 时间：2012-09-02T18:26:12.433
> 
> 标签：java, swing, jtable, tablecelleditor, jradiobutton

我正在设计一个考勤系统，为此我使用 JTable 列出学生并根据他们的姓名标记出勤率。我在 Jtable 列中添加了一个 RadioButton 组，我的代码如下：-

```
JTable jTable = new JTable(){

public void tableChanged(TableModelEvent e) {
    super.tableChanged(e);
    repaint();
}

};
jTableDT=new DefaultTableModel(
new Object [][] {},
new String [] {
    "Enroll","Student Id", "Student Name","Attendance"    });

jTable.setModel(jTableDT);
jTable.getColumn("Attendance").setCellRenderer(new RadioButtonRenderer());
jTable.getColumn("Attendance").setCellEditor(new RadioButtonEditor(new JCheckBox()));

class RadioButtonRenderer implements TableCellRenderer {
public JPanel pnl = new JPanel();
public ButtonGroup group1 = new ButtonGroup();
public JRadioButton btnOne = new JRadioButton("Present");
public JRadioButton btnTwo = new JRadioButton("Absent");
public JRadioButton btnThree = new JRadioButton("on Leave");

public Component getTableCellRendererComponent(JTable table, Object value,boolean isSelected, boolean     hasFocus, int row, int column) {
       if (value==null) return null;

      group1.add(btnOne );
 group1.add(btnTwo );
 group1.add(btnThree );
 pnl.add(btnOne );
 pnl.add(btnTwo );
 pnl.add(btnThree );

 btnThree .setSelected(false);
 btnOne .setSelected(false);
btnTwo .setSelected(false);
 switch(Integer.parseInt((String)value))
{

 case 3:
    btnThree.setSelected(true);
   break;
case 2:
   btnTwo.setSelected(true);
   break;
 case 1:
   btnOne.setSelected(true);
   break;
 }
 return pnl;
   }
 }

 class RadioButtonEditor extends  DefaultCellEditor implements ItemListener 
 {

 public JPanel pnl = new JPanel();
 public ButtonGroup group1 = new ButtonGroup();
  public JRadioButton btnOne = new JRadioButton("Present");
  public JRadioButton btnTwo = new JRadioButton("Absent");
  public JRadioButton btnThree = new JRadioButton("On Leave");

   public RadioButtonEditor(JCheckBox checkBox) {
     super(checkBox);
   }

   public Component getTableCellEditorComponent(JTable table, Object value,boolean isSelected, int row,    int column) {
       if (value==null) return null;

  group1.add(btnOne );
   group1.add(btnTwo );
  group1.add(btnThree );

  pnl.add(btnOne );
   pnl.add(btnTwo );
  pnl.add(btnThree );

  btnThree .setSelected(false);
  btnTwo .setSelected(false);
 btnOne .setSelected(false);

 switch(Integer.parseInt((String)value)) {
 case 3:
    btnThree.setSelected(true);
    break;
  case 2:
   btnTwo.setSelected(true);
   break;
  case 1:
   btnOne.setSelected(true);
   break;
 }
    return pnl;
   }

   public Object getCellEditorValue() {
     if(btnTwo.isSelected() == true)
 return "2";
   if(btnOne.isSelected() == true)
 return "1";
      if(btnThree.isSelected() == true)
 return "3";
 return "";

   }

  public void itemStateChanged(ItemEvent e) {
           super.fireEditingStopped();                
   }
 } 
```

上面的代码正在运行，我将一组单选按钮作为第 4 列。

我正在向表中动态添加行，将默认选择的 RadioButton 设置为“4”。

```
 jTableDT.getDataVector().removeAllElements();
  while(rs.next())
 {

  jTableDT.insertRow(i,new Object[ {rs.getString(1),rs.getString(2),rs.getString(4),"4"});
            i++;
  } 
```

**我的问题：-**

假设用户选择一个班级/部分来标记学生出勤率，并且学生列表（比如说表中的 10 行）通过上面的 RadioButtons 面板动态生成。现在，当用户选择另一个只有 3 行学生的班级/部分时，会引发以下异常：-

```
Exception in thread "AWT-EventQueue-0" java.lang.ArrayIndexOutOfBoundsException: 2 >= 1
at java.util.Vector.elementAt(Vector.java:470)
at javax.swing.table.DefaultTableModel.setValueAt(DefaultTableModel.java:665)
at javax.swing.JTable.setValueAt(JTable.java:2744)
at javax.swing.JTable.editingStopped(JTable.java:4726)
at javax.swing.AbstractCellEditor.fireEditingStopped(AbstractCellEditor.java:141)
at javax.swing.AbstractCellEditor.stopCellEditing(AbstractCellEditor.java:85)
at javax.swing.JTable.columnMarginChanged(JTable.java:4595)......... 
```

据我了解，无论是否删除了所有行并输入了新行，表格都会以某种方式保留单选按钮值并将其应用于新的 jtable（当用户选择另一个部分/类时）。当所选类/部分的行数少于其先前选择的类/部分表时，也不会引发上述异常。

有没有办法在每个类/部分调用上重置 tablecellrenderer 或 tablecelleditor （因为我正在重置 tablemodel 数据）？

请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:33:52.437

在我看来，我的问题是我没有完成 CellEditing 任务，当用户选择另一个部分/类时，jtable celleditor 只是将以前的值应用于导致问题的新数据。所以我添加了

```
if(jTable.isEditing()){
jTable.getCellEditor().stopCellEditing();
} 
```

如果我错了，请纠正我...

# c# - 按名称查找 WPF 控件

> ID：12238599
> 
> 赞同：15
> 
> 时间：2012-09-02T18:26:25.827
> 
> 标签：c#, wpf

我正在寻求一些帮助，以找到引用在 C# 中以编程方式构建的控件的最佳方法

如果我在 XAML 中预先包含一个标签并命名它，`marketInfo`那么我可以在代码中设置`Tag`属性，例如

```
marketInfo.Tag = timeNow; 
```

但是，我正在构建控件并使用类似于

```
System.Windows.Controls.Label lbl = new System.Windows.Controls.Label();
lbl.Content = market.name + " - " + DateTime.Now.ToLocalTime().ToLongTimeString();
lbl.HorizontalContentAlignment = System.Windows.HorizontalAlignment.Left;
lbl.Height = 40;
lbl.Name = @"_" + "marketInfo" + countMarket; 
```

如何从其他方法引用这些控件？我已经阅读了一些建议使用的帖子，`visualtreehelper`但这似乎需要循环控件才能找到特定的控件。有没有办法通过名称访问控件以避免循环？

例如类似于

```
//pseudo code
SomeControl("_marketInfo5").Tag = timeNow; 
```

谢谢

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-02T18:39:53.660

至少有两种方法可以做到这一点：

*   使用[`FindName`](https://docs.microsoft.com/en-us/dotnet/api/system.windows.frameworkelement.findname?view=netframework-4.8)父容器的方法找到控件（但它会在内部涉及循环，如visualtreehelper）

*   创建字典以存储您创建的每个控件的引用

    ```
    var controls = new Dictionary<string, FrameworkElement>();
    controls.Add("_marketInfo5", lbl); 
    ```

    然后你可以这样做：

    ```
    controls["_marketInfo5"].Tag = timeNow; 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-10T13:00:37.320

您可以使用 XamlQuery 在运行时查找控件。[CodePlex 中的 XamlQuery](https://xamlquerywpf.codeplex.com/)

```
XamlQuery.Search(RegisterGrid, "Label[Name=_marketInfo5]").SetValue(Control.TagProperty, timeNow); 
```

# java - 从 sshj 输入流中读取时如何获得“输入提示”？

> ID：12238601
> 
> 赞同：1
> 
> 时间：2012-09-02T18:26:35.883
> 
> 标签：java, android, sshj

我正在尝试使用 sshj 为 android 编写 ssh 应用程序。我可以毫无问题地连接到服务器并从输入流中读取，得到如下信息：

```
Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0.29-generic x86_64)

Documentation: https://help.ubuntu.com/

Last login: date time from user` 
```

通常我希望现在得到格式为 user@host:~$ 的输入提示，输入流就在这里结束。我能够毫无问题地写入 shell 并执行命令，但我真的很担心没有得到输入提示，因为知道何时写入输出流和正确格式化很有帮助。当我执行命令时，提示符被写入输入流，它看起来像这样：

```
"executed command"

user@host:~$ "executed command"

"result"` 
```

我尝试使用 readline() 和 read() 进行读取，并检查流是否有任何数据可供读取。

有什么方法可以让我在不执行命令的情况下接收来自输入流的提示？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T19:09:50.527

这个问题可以通过使用如“RudimentaryPTY”示例中所示的 StreamCopier 并将 System.out 重定向到 PrintStream 来规避：

```
 baos = new ByteArrayOutputStream();
    ps= new PrintStream(baos);
    System.setOut(ps);
    new StreamCopier (shell.getInputStream(),System.out).bufSize(shell.getLocalMaxPacketSize()).spawn("stdout");
    textView.setText(baos.toString("UTF8")); 
```

这个解决方案绝对不是完美的，但它确实有效。我仍然愿意就如何更好地做到这一点提出建议！

# bonjour - 如何在 bonjour mDNSPosix 中使用 API 调用

> ID：12238603
> 
> 赞同：0
> 
> 时间：2012-09-02T18:27:10.523
> 
> 标签：bonjour, mdns, dns-sd

我已经在 linux 上安装了苹果 mDNSreponder，并且能够通过命令行 $ dns-sd -P Stack Overflow _ftp._tcp 发布服务。. 80 空气 14.99.8.77

现在我想知道如何在我的应用程序中使用它的 API 调用来发布相同的服务。当我编译 bonjour 源代码时，我得到了两个库**libdns_sd.so libnss_mdns-0.2.so**

谁能建议我如何使用我的 linux c 代码调用 apis ..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-14T17:32:13.877

链接`libdns_sd.so`到您的项目并包括在内`dns_sd.h`。现在跟随`dns_sd.h`文件查看各种功能，如注册服务、浏览等。

# c++ - 在不使用静态关键字的情况下使整个程序中的数据成员保持一致

> ID：12238604
> 
> 赞同：1
> 
> 时间：2012-09-02T18:27:12.773
> 
> 标签：c++, c++11

在下面的程序中，我使用了一个名为 check 的布尔变量，它在 main 函数中被 Tst1 和 Test2 两个对象访问。但是程序中不维护检查变量的值。我们可以使用静态，但我想知道一些替代方式..有人能给我一些提示吗？提前致谢 。

在jointdetails.h里面

```
#pragma once

class Jointdetails
{
public:
    Jointdetails(void);
    ~Jointdetails(void);
    bool check;

}; 
```

在jointdeatils.cpp里面

```
#include "Jointdetails.h"

Jointdetails::Jointdetails(void)
{
    check = false ;
}

Jointdetails::~Jointdetails(void)
{
} 
```

内部分析器.h

```
#pragma once
#include "Jointdetails.h"
class Analyzer
{
public:
    Analyzer(void);
    Jointdetails* GetJointDetails();
    Jointdetails* m_ptheCTJointDetails;
    ~Analyzer(void);
}; 
```

内部分析器.cpp

```
#include "Analyzer.h"
#include "stddef.h"
Analyzer::Analyzer(void)
{
    m_ptheCTJointDetails = new Jointdetails();

}

Analyzer::~Analyzer(void)
{
}
Jointdetails* Analyzer::GetJointDetails()
{

    if(m_ptheCTJointDetails) 
        return m_ptheCTJointDetails;
    else
        return NULL;

} 
```

Test1.h 内部

```
#pragma once
#include "Analyzer.h"
class Tst1
{
public:
    Tst1(void);
    Analyzer *analyzer1 ;
public:
    ~Tst1(void);
}; 
```

Test1.cpp 内部

```
#include "Tst1.h"

Tst1::Tst1(void)
{
    analyzer1 = new Analyzer ;
}

Tst1::~Tst1(void)
{
} 
```

Test2.h 内部

```
#pragma once
#include "Analyzer.h"
class Test2
{
public:
    Test2(void);
    Analyzer *analyzer2 ;
public:
    ~Test2(void);
}; 
```

Test2.cpp 内部

```
#include "Test2.h"

Test2::Test2(void)
{
    analyzer2 = new Analyzer ;
}

Test2::~Test2(void)
{
} 
```

main.cpp 内部

```
#include "Test2.h"
#include "Tst1.h"
#include "stdio.h"

int main()
{
    Tst1 *test1 = new Tst1 ; //check = false
    Test2 *test2 = new Test2 ; //check = false
    test1->analyzer1->GetJointDetails()->check = true ;
    if(test2->analyzer2->GetJointDetails()->check )
        printf("Check value is changed");
    else
        printf("Check value is not changed");
        return 0 ;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:36:14.473

这样做只有两种可能的方法：

1.  使用`static`存储数据
2.  将自动或动态存储数据作为参数传递给目标函数/ctors

方式 #1 更方便，因为您可以直接从任何函数访问此类数据。但它应该被认为是糟糕的设计，因为它与邪恶的全局变量几乎一样。

方式 #2 更正确（例如，参见[justin](https://stackoverflow.com/users/191596/justin)的回答）但可能有点烦人 - 您需要将所需数据作为参数传递给每个所需函数和/或将数据存储为类数据成员。在许多类/嵌套调用的情况下，这不是一件令人愉快的工作。

不过，如果您不关心方式#1 的缺点，请考虑**单例按需**概念。它允许以更动态的方式使用静态数据 - 按需创建，由多个用户共享访问，并在没有人使用时销毁。请参阅示例（为简洁起见，跳过了一些详细信息，包括等）：

JointDetails.h

```
 class JointDetails
 {
    // Actual class definition
    // ...
 public:

    // Function accessing to JointDetails instance
    static std::shared_ptr<JointDetails> Get();
 }; 
```

JointDetails.cpp

```
 std::shared_ptr<JointDetails> JointDetails::Get()
 {
    static std::weak_ptr<JointDetails> s_trackInstance;
    if(s_trackInstance.expired())
    {
       auto instance = std::make_shared<JointDetails>();
       s_trackInstance = instance;
       return instance;
    }

    return s_trackInstance.lock();
 } 
```

分析器.h

```
// All instances of Analyzer share the same instance of JointDetails.
// But JointDetails instance is created dynamically only when first instance of
// Analyzer is created and destoyed when the last instance of Analyzer is destroyed.
class Analyzer
{
   std::shared_ptr<JointDetails> m_details;
public:
   Analyzer(): m_details(JointDetails::Get()) {}
   const JointDetails& GetDetails() const { return *m_details; }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:32:38.300

您要么必须将 check 设为静态，要么将 JointDetails 设为单例（也使用 static 关键字）。

如果您将检查设为静态，则表示 JointDetails 的所有实例都具有相同的检查。

如果您将 JointDetails 设为单例，那么您就是说对 JointDetails 对象的每个引用都是同一个对象，因此您的 Tst1 和您的 Test2 都将具有指向同一个对象的指针。

我*认为*后者是你正在寻找的：

联合详情.h

```
#pragma once

class Jointdetails
{
public:
    ~Jointdetails(void);
    bool check;

    static Jointdetails* getInstance();
private:
    Jointdetails(void);
}; 
```

Jointdetails.cpp

```
#include "Jointdetails.h"

Jointdetails::Jointdetails(void)
{
    check = false ;
}

Jointdetails::~Jointdetails(void)
{
}

Jointdetails* Jointdetails::getInstance() {
    static Jointdetails s_instance;
    return &s_instance;
} 
```

分析器.cpp

```
Analyzer::Analyzer(void)
{
    m_ptheCTJointDetails = Jointdetails::getInstance();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:53:29.193

0）你不需要`new`经常使用。

1）您可以使用关节细节作为构造函数中的参数来构造对象。

为了显示：

```
class Tst1 {
public:
  Tst1(Jointdetails& pJointdetails) : analyzer1(pJointdetails) {
  }

  Analyzer analyzer1;
public:
  ~Tst1(void);
};

int RunProgram(Jointdetails& pJointdetails) {
  Tst1(pJointdetails);
  ...
}

int main() {
  Jointdetails jointdetails;
  const int result(RunProgram(jointdetails));
  return result;
} 
```

# php - 将php数组发送到javascript函数onclick

> ID：12238607
> 
> 赞同：1
> 
> 时间：2012-09-02T18:27:32.707
> 
> 标签：php, javascript, arrays

关于将 PHP 数组发送到 javascript 函数的小问题，我做了功课，到处看了看，我知道这样做不可靠，但目前我不知道任何其他方法，所以试着建议我如何完成它。

我首先执行 php 代码，想法是在页面加载时我从 MySQL 获取一些数据，我用该 select 语句中的 ID 填充 php 数组。

```
<?php
include('config.php');
$TicketExist = "select BetSlipID,probatip1.betslips.MatchID as GameID, 
TipID,tim1.Name AS HomeTeam ,tim2.Name AS AwayTeam, UserID 
from probatip1.betslips
inner join probatip1.matches matches on probatip1.betslips.MatchID = matches.MatchID
inner join probatip1.teams tim1 on matches.HomeTeamID = tim1.TeamID
inner join probatip1.teams tim2 on matches.AwayTeamID = tim2.TeamID
where UserID = 1";

$TicketResult = mysql_query($TicketExist);
$TicketNum = mysql_numrows($TicketResult);

mysql_close();

if($TicketNum != 0)
{
$s=0;
while($s < $TicketNum)
{       

    $GameID = mysql_result($TicketResult,$s,"GameID");
    $TipID = mysql_result($TicketResult,$s,"TipID");    
    $ArrayIDs[$s] = $GameID;
    echo "<script>window.onload=GetInfo($GameID,$TipID); </script>";
    $s++;
}
} 
?> 
```

所以我得到了我想要填写并写在我的页面上的所有内容，现在的想法是用户点击，调用javascript来获取这个'$ArrayIDs'并从脚本执行代码

这是即时调用脚本的代码

```
<ul>
<li 
id="ConfirmButton" name="Insert" method="post" 
onclick="GetAllIDs(<?php $ArrayIDs ?>)"><a>POTVRDI</a></li>
</ul> 
```

还有我的脚本代码

```
function GetAllIDs(Ticket) {
$("td.ID").each(function () {

    var MatchID = $(this).attr('id');
    var lab = "Label";

    var Label = lab + MatchID;

    var Final = document.getElementById(Label);

    var TipID;

    if (Final.innerHTML == '1') {
        TipID = 1;
    }
    else if (Final.innerHTML == 'X') {
        TipID = 2;
    }
    else if (Final.innerHTML == '2') {
        TipID = 3;
    }
    else {
        return;
    }

    var request_type;
    var browser = navigator.appName;

    if (browser == "Microsoft Internet Explorer") {
        request_type = new ActiveXObject("Microsoft.XMLHTTP");
    }
    else {
        request_type = new XMLHttpRequest();
    }

    var http = request_type;

    var AlreadyPlayed = false;

    if (Ticket != null) {
        var TicketExists = Ticket;
        for (var i = 0; i < TicketExists.length; i++) {
            if (TicketExists[i] == MatchID) {
                AlreadyPlayed = true;
                break;
            }
        }
    }

    if (http != null) {

        if (AlreadyPlayed == true) {
            http.open('get', 'update.php?MatchID=' + MatchID + 
            '&TipID=' + TipID + '&UserID=' + 1, true);
        }
        else {
            http.open('get', 'insert.php?MatchID=' + MatchID + 
            '&TipID=' + TipID + '&UserID=' + 1, true);
        }
        http.send(null);
    }
});

if (Ticket == null) {
    alert('Tiket je napravljen');
}
else {
    alert('Tiket je promenjen');
}
} 
```

使用这个发布的代码，当我在 mozzila 中使用 firebug 调试代码时，我发现我的假设为 '$ArrayIDs' 的 'Ticket' 参数是未定义的。

我想制作数组并将其发送到javascript onclick事件的原因是检查用户是否已经在某个游戏上下注，如果他这样做我想发送所有数据以进行更新，以及他是否还没有下注某个游戏到发送数据以插入数据库。所以我需要数组，然后再检查 MatchID 和我数组中的所有 ID，所以我知道该怎么做。

提前感谢大家的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:35:36.380

你的脚本可以做一些清理工作，但本质上你需要改变

```
onclick="GetAllIDs(<?php $ArrayIDs ?>)"> 
```

到

```
onclick="GetAllIDs(<?php echo json_encode($ArrayIDs) ?>)"> 
```

我也建议不要输出

```
"<script>window.onload=GetInfo($GameID,$TipID); </script>"; 
```

对于 mysql 中的每一行，创建一个值的数组并在循环之后创建一个脚本。使用 mysql_fetch_row 而不是 mysql_numrows 和 mysql_result 可能更整洁。

```
while ($row = mysql_fetch_row($result)) {
    //...do things here...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:35:09.227

您需要将数组输出为有效的 JavaScript，使用[`json_encode`](http://php.net/manual/en/function.json-encode.php)

```
GetAllIDs(<?php echo  json_encode($ArrayIDs); ?>) 
```

# cloud - 在基于在线应用程序的云中需要帮助

> ID：12238618
> 
> 赞同：0
> 
> 时间：2012-09-02T18:29:12.997
> 
> 标签：cloud

我正在开发我的客户将每月使用的在线应用程序。我已经购买了云服务器。我还将提供托管服务

但我一度感到困惑。假设有 100 个用户注册并申请了我的应用程序。

那么我是否需要手动在每个用户域名上安装我的应用程序？即在我们的例子中为 100

或者我应该创建集中应用程序，我只给他们用户名和密码，然后他们有自己的后端应用程序？

希望这是有道理的！

哪个容易实现？如何进一步处理？

请指导我

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T06:18:28.833

[SAAS](http://en.wikipedia.org/wiki/Software_as_a_service)范式似乎很适合您。您可以向他们提供凭据，以便他们在线使用应用程序，而不是在每个客户的站点上部署、维护和支持您的应用程序。您的客户也将从这种范例中受益，因为他们不需要硬件来现场部署您的应用程序。在开发应用程序时，您应该考虑可伸缩性和弹性。

# sql - SQL：子查询的列太多

> ID：12238621
> 
> 赞同：29
> 
> 时间：2012-09-02T18:29:32.340
> 
> 标签：sql, postgresql

我正在尝试使用 postgresql 进行查询。该数据库包含两个关系：“kingdom”，其中包括一些英国国王，以及“dinasty”，其中包含一些来自 stuart dinasty 的人

关系“王国”包括国王的名字以及他的王国开始和结束的时间。关系“神圣”包括姓名、性别、出生和死亡。

我想问的是他死时最年长的国王。

通过我的查询，我在第 3 行（不在）收到此错误：`subquery has too many columns`

这是查询：

```
SELECT kingdom.king, dinasty.birth, dinasty.death
FROM kingdom, dinasty
WHERE kingdom.king = dinasty.name AND kingdom.king NOT IN
(
    SELECT DISTINCT R1.king, R1.birth, R1.death
    FROM
    (
        SELECT DISTINCT R1.king, D1.birth, D1.death
        FROM kingdom AS R1, dinasty AS D1, dinasty AS D2
        WHERE R1.king=D1.name
    ) AS R1, 
    (
        SELECT DISTINCT R1.king, D1.birth, D1.death
        FROM kingdom AS R1, dinasty AS D1, dinasty AS D2
        WHERE R1.king=D1.name
    ) AS R2
    WHERE R1.death-R1.birth < R2.death-R2.birth
); 
```

NOT IN 里面的内容是正确的。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-09-02T18:31:04.550

您在子查询中投影*三*列，但在子句中比较其中的*一*`IN`列。在子查询中只选择所需的列 ( `r1.king`) `IN`：

```
SELECT kingdom.king, dinasty.birth, dinasty.death
FROM kingdom, dinasty
WHERE kingdom.king = dinasty.name AND kingdom.king NOT IN
(
    SELECT DISTINCT R1.king
    FROM
    (
        SELECT DISTINCT R1.king, D1.birth, D1.death
        FROM kingdom AS R1, dinasty AS D1, dinasty AS D2
        WHERE R1.king=D1.name
    ) AS R1, 
    (
        SELECT DISTINCT R1.king, D1.birth, D1.death
        FROM kingdom AS R1, dinasty AS D1, dinasty AS D2
        WHERE R1.king=D1.name
    ) AS R2
    WHERE R1.death-R1.birth < R2.death-R2.birth
); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-03-18T01:57:34.827

正如所回答的那样，您的列数不匹配，但是有一种更简单的方法来编写它。

在编写查询时，最好分阶段进行思考。首先，您需要知道每位国王去世时的年龄：

```
SELECT *, death-birth AS lived_for FROM dinasty 
```

现在你有了它，你可以使用 DISTINCT ON 来找到每个王国最长寿的国王

```
SELECT DISTINCT ON( name ) name, birth, death, lived_for
  FROM (
      SELECT *, death-birth AS lived_for FROM dinasty
    ) a
  ORDER BY name, lived_for DESC
; 
```

distinct on 将占据每个不同值的第一行，因此将其与正确的 . 配对很重要`ORDER BY`。首先我们按朝代的名字排序，然后*按降序排列*国王的寿命。这意味着每个王朝出现的第一个国王将是寿命最长的国王，这就是 DISTINCT ON 将为每个王朝保留的记录。

请注意，我还删除了 JOIN 到 kindgom，但如果需要，您可以将其重新添加：

```
SELECT k.*, oldest.*
  FROM (
    SELECT DISTINCT ON( name ) name, birth, death, lived_for
      FROM (
          SELECT *, death-birth AS lived_for FROM dinasty
        ) a
      ORDER BY name, lived_for DESC
    ) oldest
    JOIN kingdom k ON k.king = oldest.name
; 
```

最后，如果您需要在子选择中使用多个列，您可以使用 ROW() 构造：

```
SELECT ...
  FROM table_a
  WHERE ROW(f1, f2, f3) NOT IN (SELECT f1a, f2a, f3a FROM ... )
; 
```

# python - Python - 想要根据 url 选择更改标题徽标

> ID：12238624
> 
> 赞同：-5
> 
> 时间：2012-09-02T18:30:05.860
> 
> 标签：python, html, python-2.7

我想根据浏览网站的用户当前激活/看到的菜单更改网站的徽标。

例如我有 www.urltowebsite.com/menu1 = Header Logo 1 然后我有 www.urltowebsite.com/menu2 = Header Logo 2

在此之上，我想添加一条 else 语句，说明：如果选择了任何其他菜单，请使用标题徽标 3。

我怎样才能用 Python 做到这一点？我似乎无法理解如何定义在何处以及如何调用 HTML 网站上的不同功能。

哦，我坚持用 Python 来做这件事。并且最好没有任何框架，例如 Django。但如果需要，我可以安装 web.py

编辑：

那我是否被迫使用php？我想一劳永逸地开始在我的网络项目中使用 Python。正如我首先所说，该网站是用简单的 HTML 制作的。Javascript 函数仅用于通过 AJAX 提供 HTML 菜单。同样，这对于我想要做的事情并不重要，因为菜单有类，我可以在 php 中定义这些类，从而更改我的徽标/标题。我想做的是在这种情况下使用 Python。这是该网站的代码片段：

```
<div id="header">
    <span class="title"><img src="http://www.url.com/subfolder/images/logo.png"/>
        </span>
    </div> 
```

还有一些与此相关的：

```
<div id="menu">
<ul>
<li><a href="#slider" id="menu_slider">001</a></li>
<li><a href="#about" id="menu_about">002</a></li>
<li><a href="#application" id="menu_portfolio">003</a></li>
<li><a href="#about" id="menu_contact">004</a></li>
<li><a href="#contact" id="menu_reel">005</a></li>
<li><a href="#contactresell" id="menu_awards">006</a></li>
<li><a href="#handel" id="link">007</a></li>
<li><a href="#faq" id="menu_faq">008</a></li>
</ul>
</div> 
```

那么我可以在这里使用python吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:38:18.610

你要求以错误的方式做错误的事情。

为了根据 Python 中的 URL 更改徽标，您需要 Python 生成页面并知道该 url 是什么。

在 Python 中有两种方法可以做到这一点：

*   使用现有的 Web 框架
*   编写自己的 Web 框架

“Python”不知道也不关心你的 URL 是什么——框架和支持库（Django、Pyramid、Bottle、Flash、Tornado、Twisted 等）通过与底层 Web 服务器的集成来确定 URL 是什么（尽管有些有自己的网络服务器耦合）。同样，PHP 并不真正知道或关心 URL 是什么——这些信息来自与 Apache 或 FCGI/Nginx/等的集成。PHP 往往会附带完成大部分/所有集成。还值得注意的是，PHP 不仅仅是一种语言，而是一种 Web 框架。Python 只是一种语言。

大多数 Python 框架将写入 WSGI 规范，并具有一个“请求”对象，其中包含您想要的所有数据（并且许多使用 WebOb 库）。

如果您打算使用静态 HTML 文件做所有事情，那么您有几个选择：

*   有一个静态目录。使用 javascript 找出地址栏位置，并渲染相应的徽标/编写页眉和页脚。
*   有一个包含所有 HTML 的“模板”目录。使用 Python 脚本使用自定义页眉/页脚构建每个网站的静态版本，并将您的网络服务器配置为为每个域提供不同的服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:28:26.297

不，Python 不能在 HTML 网页中运行。如果您真的在提供纯 HTML 页面，那么您必须在页面加载后使用 javascript 在浏览器中执行代码。但是，由于您提到使用 AJAX，听起来您提供纯 HTML 而是提供一些服务器端代码并*​​不是真的。*如果是这样，那么该服务器端代码就是放置您的 HTML 构造逻辑的地方。要知道做到这一点的最佳方式，您必须描述服务器上发生的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T19:37:17.993

虽然没用过，但听说[pyhp](http://pyhp.sourceforge.net)项目或多或少地为python提供了类似php的嵌入功能。

# image-processing - LabVIEW Vision Development 中的轮廓分析

> ID：12238626
> 
> 赞同：1
> 
> 时间：2012-09-02T18:30:27.217
> 
> 标签：image-processing, computer-vision, labview

我有具有相同元素的图像。我想检测两个图像上元素的轮廓并计算轮廓距离。

对于调试，我正在绘制点，这些点对应于可视化用于计算距离的点。

不幸的是，模板图像上的点似乎与目标图像上的点几乎相同。我认为它应该计算两个图像上对应点之间的距离。因此，如果轮廓旋转距离会很大。

**我的问题是如何选择点来计算距离？我的代码有什么问题？LabVIEW 文档没有提到我使用的控件。**

我正在添加 vi 来测试它并检查我的代码是否正常 ->[链接](http://forums.ni.com/ni/attachments/ni/200/36476/1/contours_matching.vi)

我没有添加任何图像，因为这不是解决我的问题的重点，但重点是弄清楚 LabVIEW 是如何工作的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T20:15:00.820

答案出现在评论中引用的主题上。再次链接[http://forums.ni.com/t5/Machine-Vision/Contour-analysis/td-p/2138766](http://forums.ni.com/t5/Machine-Vision/Contour-analysis/td-p/2138766)

总结和回答这个问题：

> 计算轮廓距离使用轮廓匹配算法（基于几何图案匹配）在目标图像上定位模板轮廓。匹配算法负责移位、旋转、缩放和遮挡。一旦找到匹配，就会有细化算法来生成模板轮廓点和目标轮廓点之间的准确对应关系。完成一一对应后，将计算距离。

# python - 名称“newList”未定义

> ID：12238632
> 
> 赞同：1
> 
> 时间：2012-09-02T18:31:27.200
> 
> 标签：python

所以我正在制作一个python游戏，我正在尝试实现一个保存/加载系统。我有保存部分但是我制作的加载功能不起作用。当我将 cPickle.load 分配给一个新列表时，它没有注册。

```
def save():
    file = open('save.txt', 'wb')
    cPickle.dump(GameState, file)
    file.close()

def load():
    inFile = open('save.txt', 'rb')
    newList = cPickle.load(inFile)
    inFile.close() 
```

请帮忙，谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T18:34:06.833

您可能忘记在以下位置返回您的列表`load`：

```
def load():
    inFile = open('save.txt', 'rb')
    newList = cPickle.load(inFile)
    inFile.close()
    return newList 
```

请注意，加载文件的更 Pythonic 是：

```
def load(name_of_your_saved_file):
    with open(name_of_your_saved_file, 'rb') as inFile:
        newList = cPickle.load(inFile)
    return newList 
```

在这里，我们使用 Python 中所谓的上下文（`with...as`语句），这对于确保自动调用您的文件非常有用。最好不要在函数中硬编码文件名，而是将其作为参数传递。

当你调用你的`load`函数时，你会得到你放入泡菜的东西，`GameState`在你的情况下。

```
game_state_loaded = load('save.txt') 
```

# objective-c - 具有给定数量元素的集合的组合

> ID：12238635
> 
> 赞同：2
> 
> 时间：2012-09-02T18:31:52.713
> 
> 标签：objective-c, algorithm

我试图这样做，但无法弄清楚，

假设我有一套：`{1,2,3,4,5}`

我想要两个元素的组合，比如：

```
{1,2}
{1,3}
{1,4}
{1,5}
{2,3}
{2,4}
{2,5}
{3,4}
{3,5}
{4,5} 
```

我如何在objective-c中实现它？

我已经检查了算法，但我无法弄清楚我该怎么做..这是我之前检查过的主要网址：[从 n 返回 k 元素的所有组合的算法](https://stackoverflow.com/questions/127704/algorithm-to-return-all-combinations-of-k-elements-from-n)

如果有人可以帮助我，我会很高兴..

问候。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T18:49:03.717

只是一个嵌套循环遍历数组元素并将组合写入结果数组应该可以工作（此代码经过测试并且有效）：

```
NSArray *set = [[NSArray alloc] initWithObjects:
                [NSNumber numberWithInteger:1],
                [NSNumber numberWithInteger:2],
                [NSNumber numberWithInteger:3],
                [NSNumber numberWithInteger:4],
                [NSNumber numberWithInteger:5], nil];

NSMutableArray *combinations = [[NSMutableArray alloc] init];

for (NSInteger i=0; i<[set count]; i++) {
    for(NSInteger j=i+1; j<[set count]; j++){
        NSArray *newCombination = [[NSArray alloc] initWithObjects:
                                   [set objectAtIndex:i],
                                   [set objectAtIndex:j],
                                   nil];
        [combinations addObject:newCombination];
        NSLog(@"added combination %@", newCombination);
    }
} 
```

在这个嵌套循环结束时， NSMutableArray**组合**包含你所有的组合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T18:38:01.070

您可以使用 2`for-loop`秒来完成此操作。在第一个循环中，您遍历元素 as`i`和在第二个循环中从值`j=i+1`到集合中元素数的计数结束。

它可能是这样的：

```
 for (i = 0; i < length_set; i++)
{
    for (j = i + 1;length_set; j++)
    {
        print ("%d%d\n", set[i], set[j]);
    }
} 
```

}

**注意：**它只是一个伪代码，我没有检查语法，它只是为了显示逻辑。

# javascript - 从页面获取特定数据并将其写入 div

> ID：12238637
> 
> 赞同：0
> 
> 时间：2012-09-02T18:31:57.950
> 
> 标签：javascript, jquery

我正在使用 javascript 购物车建立一个在线商店。但是，脚本在显示购物车时不允许只打印一两个值，但我需要这样做。

这是购物车的样子：

```
<div class="simpleCart_items">
    <div>
        <div class="headerRow">
            <div class="item-name">Tuote</div>
            <div class="item-price">Hinta</div>
            <div class="item-decrement">-</div>
            <div class="item-quantity">Määrä</div>
            <div class="item-increment">+</div>
            <div class="item-total">Yhteensä</div>
            <div class="item-remove">Poista</div>
        </div>
        <div class="itemRow row-0 odd" id="cartItem_SCI-1">
            <div class="item-name">Teipit</div>
            <div class="item-price">€0.00</div>
            <div class="item-decrement"><a href="javascript:;" class="simpleCart_decrement"><img src="css/minus.png" alt="minus"></a>
            </div>
            <div class="item-quantity">3</div>
            <div class="item-increment"><a href="javascript:;" class="simpleCart_increment"><img src="css/plus.png" alt="plus"></a>
            </div>
            <div class="item-total">€0.00</div>
            <div class="item-remove"><a href="javascript:;" class="simpleCart_remove"><img src="css/remove.png" alt="Remove"></a>
            </div>
        </div>
        <div class="itemRow row-1 even" id="cartItem_SCI-3">
            <div class="item-name">Car Speaker -hajuste</div>
            <div class="item-price">€4.00</div>
            <div class="item-decrement"><a href="javascript:;" class="simpleCart_decrement"><img src="css/minus.png" alt="minus"></a>
            </div>
            <div class="item-quantity">1</div>
            <div class="item-increment"><a href="javascript:;" class="simpleCart_increment"><img src="css/plus.png" alt="plus"></a>
            </div>
            <div class="item-total">€4.00</div>
            <div class="item-remove"><a href="javascript:;" class="simpleCart_remove"><img src="css/remove.png" alt="Remove"></a>
            </div>
        </div>
        <div class="itemRow row-2 odd" id="cartItem_SCI-5">
            <div class="item-name">Teipit (Musta hiilikuitu)</div>
            <div class="item-price">€0.00</div>
            <div class="item-decrement"><a href="javascript:;" class="simpleCart_decrement"><img src="css/minus.png" alt="minus"></a>
            </div>
            <div class="item-quantity">1</div>
            <div class="item-increment"><a href="javascript:;" class="simpleCart_increment"><img src="css/plus.png" alt="plus"></a>
            </div>
            <div class="item-total">€0.00</div>
            <div class="item-remove"><a href="javascript:;" class="simpleCart_remove"><img src="css/remove.png" alt="Remove"></a>
            </div>
        </div>
    </div>
</div> 
```

**注意：**购物车是通过 javascript 编写的，因此它在页面源代码中不可见，仅在浏览器的检查模式下可见。

那么我将如何收集`item-name`,`item-price`和`item-quantity`？

我试过这个：

```
 var name = $('.item-name');
    var price = $('.item-price');
    var quantity = $('.item-quantity');
    var data = name + price + quantity;
    $('#items').html(data); 
```

但这实际上不会做任何事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:35:37.387

这样做时->`$('.item-name');`

您只是将元素捕获为对象，而不是值。

现在您将元素作为对象，您需要提取值，在这种情况下，您的元素对象是 a `div`，因此您可以尝试`.text()`or `.html()`（获取 div 内的文本或 html）。

*（对于这种情况，我将使用`text()`因为您只使用值并且与 html 没有任何关系）*

**试试这个：**

```
var name = $('.item-name');
var price = $('.item-price');
var quantity = $('.item-quantity');
var data = name.text() + price.text() + quantity.text();
$('#items').html(data); 
```

* * *

## 更好的解决方案：

这将使`div`您拥有产品并匹配**cartItem_SCI**模式的可点击。

`name`因此，当用户单击您购物车的任何元素时，您将使用方法而不是*（因为使用此方法将替换用户每次单击 div 时的产品信息）*附加到div`price`和`quantity`值`$('#items')``append()``html()`

 *```
$(document).ready(function() {

    $('div[id^="cartItem_SCI-"]').css({ cursor:'pointer' });

    $('div[id^="cartItem_SCI-"]').click(function() {
        var name = $(this).find('.item-name');
        var price = $(this).find('.item-price');
        var quantity = $(this).find('.item-quantity');
        var data = name.text() + ' - ' + price.text() + ' - ' + quantity.text();
        $('#items').append(data + '<br/>');
    });

});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:33:47.923

对于一个项目，您可以获得这样的结果。但是由于您有多个项目，因此可以像这样制作一个对象。

```
var item={};

$('.item-name').each(function(){item.name=$(this).html()});
$('.item-price').each(function(){item.price=$(this).html()});
$('.item-quantity').each(function(){item.quantity=$(this).html()});

  var data='';    
        for(var i=0;i<item.length;i++)
               {
              data+=item[i].name+item[i].price+item[i].quantity;
                  }
        $('#items').html(data); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:35:34.067

您只是获得对该类的引用，添加 .html() 以获取该类应用到的元素的内部 html。

```
var name = $('.item-name').html(); 
```*

# entity-framework - 如何从 psake 构建运行代码优先迁移？

> ID：12238640
> 
> 赞同：5
> 
> 时间：2012-09-02T18:32:29.847
> 
> 标签：entity-framework, powershell, entity-framework-migrations, psake

我可以从包管理器控制台键入等，它工作正常`Update-Database`。`Enable-Migrations`

如果我需要从常规的 powershell 会话或 psake 构建文件中执行相同的操作，那么我该怎么做呢？

我尝试`EntityFramework.5.0.0\tools\EntityFramework.psm1`从 packages 目录导入模块，我确实得到了`Update-Database`,`Enable-Migrations`函数，但我无法提供他们的参数——他们需要一个项目、源代码和另外 6 个——而且没有任何文档。我不能在我们的 CI 链中的某些机器上自动部署数据库吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-04T03:19:39.770

The problem with importing the module into a PowerShell console is that I believe the module expects to run in a context where it has a Visual Studio DTE object available. That environment is the NuGet Package Manager Console. This issue has been brought up before. Check out this [blog post](http://blog.davidebbo.com/2011/05/thoughts-on-installing-and-updating.html) and this [SO question](https://stackoverflow.com/questions/11386672/using-nuget-to-update-project-files-outside-of-package-manager-console).

This [blog post shows how to write code that does migrations](http://romiller.com/2012/02/09/running-scripting-migrations-from-code/).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-29T05:39:37.480

`migrate.exe`从 EntityFramework NuGet 包中使用。

[https://stackoverflow.com/a/14139229/991267](https://stackoverflow.com/a/14139229/991267)

# jquery - jQuery 在生成的 div 中调用

> ID：12238647
> 
> 赞同：0
> 
> 时间：2012-09-02T18:33:07.820
> 
> 标签：jquery, forms, button, html, innerhtml

我正在尝试从生成到 div 的按钮中捕获事件（由另一个 jQuery 调用提供）。我想知道 jQuery 调用应该在哪里？进入主页面还是进入之前的 jQuery 调用生成的 html？

另外，jQuery 如何处理具有相同名称的对象？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:02:05.547

如果您正在处理现在或将来退出的对象，则必须使用 live 函数来附加您的事件：

[http://api.jquery.com/live/](http://api.jquery.com/live/)

*描述：为现在和将来匹配当前选择器的所有元素附加一个事件处理程序。*

如果您有多个与选择器匹配的对象，您将获得一个对象数组

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T21:25:30.307

[使用jsFiddle](http://jsfiddle.net/)创建一个示例。目前很难说你的问题是什么。

要回答您的第一个问题，您可以在“主页”和“生成的 html”中注册您的事件，具体取决于任务。而且由于没有代码/示例，我无法判断哪个更适合您。

问题“jQuery 如何处理具有相同名称的对象？” 真的没有意义。JQuery 是一个 JavaScript 库，而 JavaScript 与任何其他编程语言一样，每个对象都有一个唯一的名称。也许您的意思是元素类名称，jQuery 将它们视为元素的集合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T21:46:25.260

如果要将事件绑定到尚不存在的内容，则可以将其放在生成的 html 中。

像这样：

```
$("#generatedButton").on("click",function(){
    //do something..
}); 
```

* * *

**或者**

您可以将其放在主页中，并将事件绑定到已经存在的更高包装器并单独指定事件目标

像这样：

```
$("#mainWrapper").on("click", "#generatedButton" , function(){
    //do something..
}); 
```

* * *

所有这些都使用[`.on()`](http://api.jquery.com/on/).

# html - 在 IE7 中放置在 PRE-tag 中时，多个 BR-tag 将折叠成一个

> ID：12238649
> 
> 赞同：0
> 
> 时间：2012-09-02T18:33:25.833
> 
> 标签：html, css, line-breaks, internet-explorer-7, pre

在 IE7 中，标签内的多个换行符（使用`<br />`或`<br>`）`<pre>`将导致 IE7 将换行符折叠成单个换行符。为了证明这一点，您可以使用以下 HTML 代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
        <style type="text/css">
            *
            {
                margin: 0px;
                padding: 0px;
            }
            .a, .b
            {
                float: left;
            }
            .b br
            {
                display: block;
            }
        </style>
    </head>
    <body>
        <pre class="a">Line 1a<br /><br />Line 2a</pre>
        <pre class="b">Line 1b<br /><br />Line 2b</pre>
    </body>
</html> 
```

这将导致：（对于 IE7）

```
Line 1a Line 1b
Line 2a
        Line 2b 
```

并且会导致：（对于其他浏览器：FF等）

```
Line 1a Line 1b
        Line 2b
Line 2a 
```

正如您将看到的，我可以使用标签本身来解决这个`display: block;`问题。`<br />`但问题是，它不再适用于其他浏览器，因此它只是 IE7 的修复程序，因此无用，因为 IE7 不是真正的主要浏览器，将来也不会。

虽然这只是一个备注，而不是`<pre>`标签，你可以更好地在标签上使用 CSS 代码`<div>`：`white-space: pre-wrap;word-wrap: break-word;`为了模拟类似的行为，剩下要回答的问题是如何以跨浏览器的方式解决这个问题，而不需要 CSS hack 或特定的浏览器定位的 CSS 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:06:06.550

我认为你应该使用 IE 条件注释。

是的，它是*针对特定浏览器的 CSS 代码*，但您正在编写正确的 HTML 注释。如果 IE 不是兼容的浏览器并决定阅读评论，那是他的问题。此外，如果这解决了您的问题，您还想要什么？

然后，您可以使用

```
<!--[if lte IE 7]>
<style type="text/css">
.b br{
    display:block;
}
</style>
<![endif]--> 
```

在这里看到它：http: [//jsfiddle.net/APj3Y/1/](http://jsfiddle.net/APj3Y/1/)

# sorting - 你会使用什么排序算法来对大的、几乎排序的列表进行排序

> ID：12238650
> 
> 赞同：0
> 
> 时间：2012-09-02T18:33:31.753
> 
> 标签：sorting, computer-science

假设您有一个几乎已排序的 30 亿个整数数组。
哪种排序算法更合适（从“经典”算法中）？
如果列表是完全随机的呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:02:58.073

我会对两者都使用合并排序，因为它是标准 unix sort() 调用中使用的，并且您没有提供任何会改变它的约束（例如最小时间或最小内存）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T11:07:29.563

考虑使用插入排序，如果输入（几乎）已排序，则需要线性时间。即使输入已排序，快速排序和归并排序的时间复杂度也为 O(n log n)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-03T11:11:47.367

根据“简而言之算法”的作者，他们比较了不同用途的排序方法，您的标准将支持 InsertionSort。看;

[http://my.safaribooksonline.com/book/software-engineering-and-development/algorithms/9780596516246/sorting-algorithms/criteria_for_choosing_a_sorting_algorit](http://my.safaribooksonline.com/book/software-engineering-and-development/algorithms/9780596516246/sorting-algorithms/criteria_for_choosing_a_sorting_algorit)

# ruby-on-rails - 回形针：路径参数

> ID：12238651
> 
> 赞同：0
> 
> 时间：2012-09-02T18:33:38.660
> 
> 标签：ruby-on-rails, amazon-s3, paperclip

在本地开发时，我不希望我上传到我的 s3 存储桶的任何图像覆盖或以任何方式影响那些已经通过生产应用程序上传的图像。

我的 :path 参数看起来像这样

```
:path => "profile_photo/:id/photo_:style.:extension" 
```

这意味着上传的文件将位于`profile_photo/1/photo_normal.png`

很好，但是如果我使用 :id 1 为我的资源上传图像，它将覆盖可能由 RL 用户上传的照片。

如果有办法获得当前环境，可能会解决这个问题，也许是这样？

```
:path => "profile_photo/:environment/:id/photo_:style.:extension" 
```

输出文件路径

```
profile_photo/production/1/photo_normal.png 
```

或 profile_photo/development/1/photo_normal.png

这将是理想的，我真的不想为开发创建一个单独的桶，我只是有点奇怪。

我一直在寻找一个地方来查找哪些符号可以作为参数传递，但没有成功。

其他人是如何解决这个问题的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:11:50.020

根据源代码[here](https://github.com/thoughtbot/paperclip/blob/master/lib/paperclip/interpolations.rb#L33)和[here](https://github.com/thoughtbot/paperclip/blob/master/lib/paperclip/interpolations.rb#L74)，我很确定你可以做到：

```
:path => "profile_photo/:rails_env/:id/photo_:style.:extension" 
```

# algorithm - 点云到低波利网格

> ID：12238654
> 
> 赞同：0
> 
> 时间：2012-09-02T18:33:52.043
> 
> 标签：algorithm, mesh, triangulation, smoothing, point-clouds

我正在使用 Kinect 传感器生成一个人的点云。
我需要从点云中生成 NVidia PhysX 中相应的一组碰撞表面。
为了实现它，我必须平滑并在对其进行三角剖分以凹网格/凸网格集。
我发现只有 1 个平滑算法：

```
 The Moving Least Squares. 
```

为了三角测量，我发现了一些算法：

```
 Greedy Projection Triangulation or
    Constrained Delaunay triangulation.
    Ear clipping algorithm 
```

[准备好的解决方案](http://www.cgal.org/Manual/latest/doc_html/cgal_manual/Surface_reconstruction_points_3/Chapter_main.html)需要一个定向点作为输入数据。
我也想实时进行（在初始化创建网格并在移动部分对应于真人移动之后）所以我需要快速方法。
此外，平滑算法必须返回 < 1000 点才能实现低波利网格。
你能推荐一些有用的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-13T19:29:41.963

也许您可以使用点云库 (PCL)。

[您可以在模块Filters](http://docs.pointclouds.org/trunk/group__filters.html)中找到用于下采样的函数。并用于模块[Surface](http://docs.pointclouds.org/trunk/group__surface.html)中的网格化。

因此，您应该能够从点云实时创建低多边形网格。

# php - 在 PHP 中解码 javascript 转义序列（\x27、\x22 等...）

> ID：12238657
> 
> 赞同：2
> 
> 时间：2012-09-02T18:34:10.193
> 
> 标签：php, javascript, decode

如果我有这个 PHP 字符串：

```
$string = '\\x27\\x22'; 
```

我将如何将其解码为`'"`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T18:42:04.867

正则表达式可以在这里为您提供帮助：

```
$out = preg_replace_callback(
  "(\\\\x([0-9a-f]{2}))i",
  function($a) {return chr(hexdec($a[1]));},
  $string
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:38:54.947

您不需要对其进行解码。做吧`str_replace('\\x27', "'", $str);`。如果您`'"`只是示例，请注意您得到了可重复的模式`\\xAA`，其中`x`表示十六进制表示法并且`AA`本身就是十六进制值，因此每个`\\xAA`表示单个字节并且`AA`从 0 到 0xFF。因此，您可以使用正则表达式或只是在您的字符串上走任何其他方式，提取这些`AA`值并将其转换为`chr(hexdec($AA))`对应的字符并与结果字符串粘合。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-28T07:16:47.567

```
$out = preg_replace_callback(
  "(\\\\x([0-9a-f]{2}))i",
  function($a) {return '\u00'.bin2hex(hex2bin($a[1]));},
  $string
); 
```

在我将值从 ascii 转换为 unicode 之后就可以了。

# php - 未收到贝宝错误令牌

> ID：12238664
> 
> 赞同：0
> 
> 时间：2012-09-02T18:34:37.600
> 
> 标签：php, paypal

我正在尝试集成 PayPal 付款专业快速结帐。我使用了以下代码：

[https://www.x.com/paypal-apis-getexpresscheckoutdetails-php-5.3/nvp](https://www.x.com/paypal-apis-getexpresscheckoutdetails-php-5.3/nvp)

我输入了我的 Api 凭据并打开了相关的网站首选项，但我不断收到错误消息，未收到令牌。有谁知道是什么问题？我迷路了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:29:27.083

从该脚本的评论中：

```
/**
 * This example assumes that this is the return URL in the SetExpressCheckout API call.
 * The PayPal website redirects the user to this page with a token.
 */ 
```

据我了解，您需要先将用户定向到 PayPal，然后发送 return_url 以指向此脚本。然后在用户付款后，他将被重定向到这个脚本。

# c++ - BloodShed DevC++ 上的 C++ 编译器错误

> ID：12238666
> 
> 赞同：0
> 
> 时间：2012-09-02T18:34:52.397
> 
> 标签：c++

我试图弄清楚我做错了什么以获得以下编译器错误，我使用的是 Bloodshed Dev-C++ 4.9.9.2：

错误读取：'stackType::stackType(const stackType&)'的原型与类'stackType'中的任何一个和非模板'stackType::stackType(const stackType&)'的模板定义不匹配，用于我的复制构造函数的一个定义

```
stackType<Type>::stackType(const stackType<Type>& otherStack) //definition of copy constructor
{
     list = NULL;
     copyStack(otherStack);
} 
```

另一个错误是 stackType::stackType(int) 但它没有进一步说明代码用于构造函数的定义这个错误是：

```
template <class Type>
stackType<Type>::stackType(int stackSize) //definition of constructor
{
     if (stackSize <= 0)
     {
          cout << "Size of the array holding the stack must be positive." << endl;
          cout << "Creating an array of size 100." << endl;
          maxStackSize = 100;
     }
     else
          maxStackSize = stackSize; //sets stack size to value specified by parameter stackSize
          stackTop = 0; //sets stackTop to 0
          list = new Type[maxStackSize]; //creates array to hold elements of the stack
} 
```

我在 C:\Users\Owner\Desktop\SD254\SD254 Unit7B.cpp 中包含的文件中得到状态的最后一个错误，并且再次没有进一步说明。以上显然是主文件存储在我的计算机上的目录，但为什么这是一个问题？我的完整代码如下。

头文件：

```
#ifndef H_StackType
#define H_StackType
#include <iostream>
#include <cassert>

using namespace std;

template <class Type>
class stackADT
{
      public:
             virtual void initializeStack() = 0; //initialize stack
             virtual bool isEmptyStack() const = 0; //determines whether stack is empty or not
             virtual bool isFullStack() const = 0; //determines whether stack is full or not
             virtual void push(const Type& newItem) = 0; //adds new item to the stack
             virtual Type top() const = 0; //returns the top element to the stack
             virtual void pop() = 0; //removes the top element of the stack
};
template <class Type>
class stackType: public stackADT<Type>
{
      public:
             const stackType<Type>& operator=(const stackType<Type>&); //overloads assignment operator
             void initializeStack(); //initializes stack to empty state
             bool isEmptyStack() const; //determines stack is empty
             bool isFullStack() const; //determines stack is not full
             void push(const Type& newItem); //adds new item to stack
             Type top() const; //return the top element of the stack
             void pop(); //removes top element of the stack
             stackType(int stackSize = 100); //constructor and creates array with default size of 100
             ~stackType(); //destructor and removes all elements from the stack
             void copyStack(const stackType<Type>& otherStack); //copies other stack
      private:
              int maxStackSize; //stores maximum stack size
              int stackTop; //point to the top of the stack
              Type *list; //pointer to the array that holds the stack elements

};
template <class Type>
void stackType<Type>::initializeStack() //definition of function intializeStack
{
     stackTop = 0;
}
template <class Type>
bool stackType<Type>::isEmptyStack() const //definition of function isEmptyStack
{
     return(stackTop == 0);
}
template <class Type>
bool stackType<Type>::isFullStack() const //definition of function isFullStack
{
      return (stackTop == maxStackSize);
}
template <class Type>
void stackType<Type>::push(const Type& newItem) //definition of push function
{
     if (!isFullStack())
     {
          list[stackTop] = newItem; //adds new item to top of stack
          stackTop++; //increments stackTop
     }
     else
          cout << "Cannot add to a full stack." << endl;
}
template <class Type>
Type stackType<Type>::top() const //definition of top-returns the top element to the stack
{
     assert(stackTop != 0); //if stack is empty terminate program
     return list[stackTop - 1]; //return element of the stack indicated by stackTop -1
}
template <class Type>
void stackType<Type>::pop() //definition of function pop
{
     if (!isEmptyStack())
          stackTop--; //decrement stackTop
     else
          cout << "Cannot remove from an empty stack." << endl;
}
template <class Type>
void stackType<Type>::copyStack(const stackType<Type>& otherStack) //definition to make copy of stack
{
     delete [] list;
     maxStackSize = otherStack.maxStackSize;
     stackTop = otherStack.stackTop;
     list = new Type[maxStackSize]; //copies otherStack into this one
     for (int j = 0; j < stackTop; j++)
          list[j] = otherStack.list[j];
}
template <class Type>
stackType<Type>::stackType(int stackSize) //definition of constructor
{
     if (stackSize <= 0)
     {
          cout << "Size of the array holding the stack must be positive." << endl;
          cout << "Creating an array of size 100." << endl;
          maxStackSize = 100;
     }
     else
          maxStackSize = stackSize; //sets stack size to value specified by parameter stackSize
          stackTop = 0; //sets stackTop to 0
          list = new Type[maxStackSize]; //creates array to hold elements of the stack
 }
template <class Type>
stackType<Type>::~stackType() //definition of destructor
{
     delete [] list; //deallocates the memory occupied by the array
}
template <class Type>
stackType<Type>::stackType(const stackType<Type>& otherStack) //definition of copy constructor
{
     list = NULL;
     copyStack(otherStack);
}
template <class Type>
const stackType<Type>& stackType<Type>::operator=(const stackType<Type>& otherStack) //overload assignment operator
{
      if (this != &otherStack) 
           copyStack(otherStack);
      return *this;
}
#endif 
```

实际的程序文件是：

```
#include <iostream>
#include "myStack.h"

using namespace std;
void testCopyConstructor(stackType<int> otherStack);
int main()
{
    stackType<int> stack(25);
    stackType<int> copyStack(25);
    stackType<int> dummyStack(50);

    stack.initializeStack();
    stack.push(15);
    stack.push(10);
    stack.push(20);
    copyStack = stack; //copies stack into copyStack

    cout << "The elements of copyStack: " ;
    while (!copyStack.isEmptyStack()) //prints copyStack
    {
          cout << copyStack.top() << " ";
          copyStack.pop();
    }
    cout << endl;
    copyStack = stack;
    testCopyConstructor(stack); //tests the copy constructor
    if (!stack.isEmptyStack())
         cout << "The original stack is not empty." << endl; 
         cout << "The top element of the original stack: " << copyStack.top() << endl;
    dummyStack = stack; //copies stack into dummyStack
    cout << "The elements of dummyStack: ";
    while (!dummyStack.isEmptyStack()) //prints dummyStack
    {
          cout << dummyStack.top() << " " ;
          dummyStack.pop();
    }
    cout << endl;
    return 0;
 }
void testCopyConstructor(stackType<int> otherStack)
{
     if (!otherStack.isEmptyStack())
         cout << "otherStack is not empty." << endl; 
         cout << "The top element of otherStack: " << otherStack.top() << endl;
} 
```

谁能帮我弄清楚如何修复错误，以便我可以正确编译和构建它，在此先感谢我收到的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:39:50.433

您必须在类定义中为复制构造函数添加声明；你不能突然定义它。

类定义应如下所示

```
template<typename Type>
class stackType: public stackADT<Type>
{
public:
    stackType(const stackType&);
    // ... all the other stuff
}; 
```

然后将识别下面的函数定义。

# html - 为什么我的背景在这个简单的 CSS 中没有变成红色？

> ID：12238667
> 
> 赞同：1
> 
> 时间：2012-09-02T18:35:04.220
> 
> 标签：html, css

### HTML

```
<div class="main">
    Lorem ipsum dolor.
</div>

<div class="footer">
    <p>More lorem.</p>
    <ul>
        <li>One</li>
        <li>Two</li>
        <li>Three</li>
    </ul>
</div> 
```

### CSS

```
.main {
    text-align: center;
}

.footer {
    background: red;
    clear: both;
}

.footer ul {
    float: right;
}

.footer li {
    display: inline;
}

.footer p {
    float: left;
}​ 
```

也在[JSFiddle 上](http://jsfiddle.net/uZs92/1/)。

我已经简化了我的主要网站的较大版本，但无法正常工作。我的页脚不会改变颜色。看看它是怎么写红色的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T18:38:05.370

见[http://jsfiddle.net/uZs92/2/](http://jsfiddle.net/uZs92/2/)

添加

```
.footer {
    overflow:hidden;
} 
```

当容器内有浮动元素时，您可以：

*   将`overflow:hidden`（或不同于`visible`）添加到容器中 -> [http://jsfiddle.net/uZs92/2/](http://jsfiddle.net/uZs92/2/)
*   `clear:both`在容器末尾添加一个元素（而不是容器本身）-> [http://jsfiddle.net/uZs92/6/](http://jsfiddle.net/uZs92/6/)
*   添加`:after,::after{content:'.';font-size:0;}`到容器-> [http://jsfiddle.net/uZs92/5/](http://jsfiddle.net/uZs92/5/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T18:37:48.917

页脚确实变红了，但由于它的所有内容都是浮动的，所以它里面没有任何东西可以阻止它的高度`0`。

设置`overflow: hidden`它，以便浮动元素会影响它的高度。

# objective-c - UIButton继承不显示图像

> ID：12238670
> 
> 赞同：0
> 
> 时间：2012-09-02T18:35:08.783
> 
> 标签：objective-c, inheritance, uibutton, uiimage

我正在尝试继承 UIButton。如果单击将播放声音，按比例放大。并且当完成播放声音时，声音会恢复到原始状态。一切正常，除了图像没有显示。标题和背景确实放大了，并且正在播放声音。有人提示吗？ **声音按钮.h**

```
#import <UIKit/UIKit.h>
#import <AVFoundation/AVFoundation.h>
#import <AudioToolbox/AudioToolbox.h>

@interface soundButton : UIButton <AVAudioRecorderDelegate, AVAudioPlayerDelegate>{
    BOOL                isPlaying;
    AVAudioPlayer       *audioPlayer;
}
@property (nonatomic)BOOL       isPlaying;
@property (nonatomic, strong) AVAudioPlayer *audioPlayer;
- (id)initWithFrame:(CGRect)frame;
-(void)loadSound:(NSString*)audiofile;
-(void)touchUpInside;
@end 
```

**声音按钮.m**

```
#import "soundButton.h"
@implementation soundButton
@synthesize isPlaying;
@synthesize audioPlayer;
void audioRouteChangeListenerCallback (
                                   void *inUserData,
                                   AudioSessionPropertyID inPropertyID,
                                   UInt32 inPropertyValueSize,
                                   id *inPropertyValue);

-(BOOL)isPlaying{
return audioPlayer.isPlaying;
}

- (id)initWithFrame:(CGRect)frame
{
self = [super initWithFrame:frame];
if (self) {
    [self addTarget:self action:@selector(touchUpInside) forControlEvents:UIControlEventTouchUpInside];
    UIImage *image = [UIImage imageNamed:@"kers.png"];
    [self setBackgroundImage:image forState:UIControlStateNormal];

}
return self;
}
-(void)loadSound:(NSString*)audiofile{
NSURL *url = [NSURL fileURLWithPath:[[NSBundle mainBundle]
                                     pathForResource:audiofile
                                     ofType:nil]];

NSError *error;
audioPlayer = [[AVAudioPlayer alloc] initWithContentsOfURL:url error:&error];
if (error)
{
    NSLog(@"Error in audioPlayer: %@",
          [error localizedDescription]);
} else {
    audioPlayer.delegate = self;
    [audioPlayer setVolume:1.0];
    [audioPlayer prepareToPlay];
    audioPlayer.currentTime = 0;
 }
 }

-(void)audioPlayerDidFinishPlaying:(AVAudioPlayer *)player successfully:(BOOL)flag{
   [audioPlayer setCurrentTime:0];
self.transform = CGAffineTransformMakeScale(1.5,1.5);
self.alpha = 1.0f;
[UIView beginAnimations:@"fish" context:nil];
[UIView setAnimationDuration:1];
self.transform = CGAffineTransformMakeScale(1.0,1.0);
self.alpha = 1.0f;
[UIView commitAnimations];

self.isPlaying = NO;
 }

-(void)touchUpInside{
//Check if something is playing If YES=>stop it
if (self.isPlaying) {
    [audioPlayer stop];
    [audioPlayer setCurrentTime:0];
} else {

    self.transform = CGAffineTransformMakeScale(1.0,1.0);
    self.alpha = 1.0f;
    [UIView beginAnimations:@"fish" context:nil];
    [UIView setAnimationDuration:1];
    self.transform = CGAffineTransformMakeScale(1.5,1.5);
    self.alpha = 1.0f;
    [UIView commitAnimations];
}

// Create an asynchronous background queue
        NSOperationQueue *queue = [[NSOperationQueue alloc] init];
        [queue addOperationWithBlock:
         ^{
                 [audioPlayer play];
        }];
}
@end 
```

在 viewController 中的 ViewdidLoad 中实现：

```
UIImage *image = [[UIImage alloc]initWithContentsOfFile:@"cherry.png"];
fishButton = [[soundButton alloc] initWithFrame:CGRectMake(323, 312, 123, 123)];

[fishButton setImage:image forState:UIControlStateNormal];
[fishButton loadSound:@"chime1.mp3"];
[fishButton setTitle:@"fish" forState:UIControlStateNormal];
[fishButton setBackgroundColor:[UIColor yellowColor]];
[fishButton setShowsTouchWhenHighlighted:YES];

[self.view addSubview:fishButton]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:52:28.810

替换这个

```
UIImage *image = [[UIImage alloc]initWithContentsOfFile:@"cherry.png"]; 
```

有了这个

```
UIImage *image = [UIImage imageNamed:@"cherry.png"]; 
```

或者如果你真的需要`initWithContentsOfFile`使用 URL 链接，比如

```
NSString *filePath = [[NSBundle mainBundle] pathForResource:@"cherry" ofType:@"png"];
UIImage *image = [[UIImage alloc]initWithContentsOfFile:filePath]; 
```

# java - Java 数组列表索引

> ID：12238674
> 
> 赞同：3
> 
> 时间：2012-09-02T18:35:37.420
> 
> 标签：java, arraylist, indexing

这是我的课`animals.java`：

```
public class animals {
    String Name, ID;
    static ArrayList<animals> animalData = new ArrayList<animals>();

    public animals(){}
    public animals(String name, String id){
        super();
        this.Name = name;
        this.ID = id;
    }

    public void addAnimal(String name, String id){
        animalData.add(new animals(name, id));
    }

    public int search(String name){
        return this.animalData.indexOf(name);
    }
} 
```

当我添加带有 id 的动物名称时，它可以正常工作，但是当我使用搜索方法时，我只看到 -1。也许我尝试覆盖方法`equals`或`indexof`在这个类中？帮帮我

谢谢你，对不起我的英语不好..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T18:36:57.570

是的，当您在集合中使用对象并执行基于对象的查找时，您需要重写`equals()`和方法。`hashcode()`

`indexOf()`返回对象，因为它只返回该特定索引处的对象。但是，当您进行基于对象的查找时，如果 equals() 并且`hashCode()`未被覆盖，`equals()`则可能会失败并且您会得到不可预测的结果。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-02T18:46:10.620

您正在将 的实例添加`animals`到列表中。您正在按名称搜索实例。由于`animalData`不包含 , 的任何实例`String`，`indexOf()`因此永远不会返回索引。

如果要按`animals`名称访问 的实例，则应使用`Map<String,animals>`.

```
Map<String,animals> animalMap = new HashMap<String,animals>();
animalMap.put("Mat", new animals("Mat", "id");
animals animal = animalMap.get("Mat"); 
```

的正确用法`indexOf()`是传入一个等于集合中已有实例的实例。正如其他人指出的那样，这将需要您定义`equals()`以定义使两个实例相等的原因。您还应该在覆盖`hashcode()`时覆盖`equals()`，因为存在假定的相关性。

*注意*：约定是使用大写字母作为类名。此外，类名不应该是复数。您将有许多 s 的实例`Animal`，稍后您可能会创建一个作为 s 集合的类`Aniamal`，但这不应该是主类的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:40:33.507

您需要定义一个“等于”方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T18:43:39.540

您正在寻找一个字符串...我认为您最好使用 HashMap...

但是是的，你必须改变你的结构（这不是很有效）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T18:50:54.620

这是我将使用的代码：

```
public class animals {
    String Name, ID;
    static Map<String, animals> animalData = new HashMap<String, animals>();

    public animals(){}
    public animals(String name, String id){
        super();
        this.Name = name;
        this.ID = id;
    }

    public static void addAnimal(String name, String id){
        animalData.add(new animals(name, id));
    }

    // Returns null if no registered animal has this name.
    public animals search(String name){
        return this.animalData.get(name);
    }
} 
```

这样，您可以使该`search`方法更快（O（1）），您不再需要覆盖该`equals`方法。

请注意，如果`animalData`是静态的，您也应该考虑将其设为`addAnimal()`静态，因为它有点像`aniamalData`.

# php - 如何在没有顺序重复的情况下获得 PHP 中的所有排列？

> ID：12238675
> 
> 赞同：2
> 
> 时间：2012-09-02T18:35:43.283
> 
> 标签：php, recursion, permutation, combinations

这个问题已经以多种形式提出。我想在 PHP 中获取一个数组并获取所有可能的组合/排列。我想要整个集合和部分集合的排列。

我对这个问题的转折是询问如何从结果项中删除顺序重复项。[通过使用“ PHP 采用所有组合](https://stackoverflow.com/questions/9787051/php-take-all-combinations)”并添加一个函数，我接近了我想要的：

```
$words = array('a','b','c');
function permutations($arr,$n)
{
    $res = array();
    foreach ($arr as $w)
    {
        if ($n==1) $res[] = $w;
        else
        {
            $perms = permutations($arr,$n-1);
            foreach ($perms as $p)
            {
                $res[] = $w." ".$p;
            } 
        }
    }
    return $res;
}

function get_all_permutations($words=array())
{
    $r = array();
    for($i=sizeof($words);$i>0;$i--)
    {
        $r = array_merge(permutations($words,$i),$r);
    }
    return $r;
}

$permutations = get_all_permutations($words);
print_r($permutations); 
```

这将输出：

```
Array
(
    [0] => a
    [1] => b
    [2] => c
    [3] => a a
    [4] => a b
    [5] => a c
    [6] => b a
    [7] => b b
    [8] => b c
    [9] => c a
    [10] => c b
    [11] => c c
    [12] => a a a
    [13] => a a b
    [14] => a a c
    [15] => a b a
    [16] => a b b
    [17] => a b c
    [18] => a c a
    [19] => a c b
    [20] => a c c
    [21] => b a a
    [22] => b a b
    [23] => b a c
    [24] => b b a
    [25] => b b b
    [26] => b b c
    [27] => b c a
    [28] => b c b
    [29] => b c c
    [30] => c a a
    [31] => c a b
    [32] => c a c
    [33] => c b a
    [34] => c b b
    [35] => c b c
    [36] => c c a
    [37] => c c b
    [38] => c c c
) 
```

我知道一旦生成了集合，我就可以查看输出，但是是否可以在生成过程中删除顺序重复？

应该转换/删除的示例：

*   `c c c`将与`c`
*   `c c b`将与`c b`
*   `c c c c c`也将与`c`（如果集合更大）相同

笔记：

*   我不擅长递归，但可能有一种奇特的方法可以将我拥有的两个函数合二为一。
*   现在输出集是字符串，但我不介意它们是否是数组（如果这让事情变得更容易）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T18:41:33.023

您可以将 permutations 数组作为[参考](http://php.net/manual/en/language.references.pass.php)（带有前导符）作为 permutations() 的第三个参数传递，并在添加值之前运行 in_array() 检查。然而，这将远低于在 get_all_permutation() 末尾删除重复项的性能

# java - java.util 包 - 类与接口

> ID：12238678
> 
> 赞同：8
> 
> 时间：2012-09-02T18:36:03.607
> 
> 标签：java, interface, stack, queue

为什么[Queue](http://docs.oracle.com/javase/6/docs/api/java/util/Queue.html)是接口，而[Stack](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Stack.html)和[ArrayList](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)等其他接口是类？

我知道接口的制作是为了让客户可以实现它们并添加他们自己的方法，而对于类，如果每个客户都需要他们的方法，那么它会变得巨大而臃肿..

...或者我在这里错过了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T18:42:25.130

A`Queue`可以以多种方式实现，a`List`或 a也可以`Set`。他们都只是为不同类型的集合指定了一个合同。

然而， an`ArrayList`是 a 的特定实现，用于`List`在内部使用数组来存储元素。`LinkedList`也是 a 的一种实现`List`，它使用一系列相互连接的节点，即[双向链表](http://en.wikipedia.org/wiki/Doubly_linked_list)。同样，`TreeSet`和`HashMap`分别是集合和映射的特定实现。

现在，`Stack`这是一个奇怪的情况，特别是因为它是旧版本 Java 的遗留类。你真的不应该再使用 a`Stack`了；相反，您应该使用它的现代等价物[`ArrayDeque`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayDeque.html). `ArrayDeque`是一个`Deque`（双端队列）的实现，它在内部使用一个数组进行存储（这正是`Stack`它的作用）。A`Deque`支持 a `Stack`，like `pop`，等的所有操作。 include`push`的其他实现，正如其他人所提到的，虽然这偏离了底层它不是一个数组，而是一个双向链表：-p`Deque``LinkedList``Stack`

现在，有很多 s 的实现`Queue`，以及许多不同类型的`Queue`s。你不仅有`BlockingQueue`s（通常用于生产者-消费者），它的常见实现包括`LinkedBlockingQueue`and `ArrayBlockingQueue`，还有`TransferQueue`s 等等。[我离题了...您可以在相关的Java 教程](http://docs.oracle.com/javase/tutorial/collections/index.html)中阅读有关集合 API 的更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-02T18:40:37.083

你正确地理解了接口的概念。在这种情况下，Java 标准库已经提供了实现和接口。您最好使用接口，以便您可以随时切换实现。

希望这是有道理的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T18:41:57.763

我认为`Stack`作为一个应该是接口的类而闻名。在正确选择提供接口时，Java 库有点失败。

`ArrayList`只是`List`接口的一个实现，所以 Sun 在那里得到了它的正确性！另一个经典的失误（在我看来）是`Observable`类，它非常需要成为接口的默认实现，而不仅仅是一个类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T18:46:11.457

有趣的问题。我认为这`Queue`是许多数据结构（如 BlockingQueue、PriorityQueue、Deque 等）的基础。这些类需要针对各种操作进行特定实现，因此将其制作`Queue`为接口要简单得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-02T19:39:25.777

接口用于 List 和 Queue 的原因**不是**为了减少过多的代码。

接口的主要优点是它们允许您编写灵活、松散耦合的代码。

（这是一个[很棒的答案](https://stackoverflow.com/questions/383947/what-does-it-mean-to-program-to-an-interface)，完美地描述了这个概念）

接口只是定义了一个类将要实现的方法列表。

这使我们能够做一件非常强大的事情：

*   *我们可以将所有实现接口的类视为相同。*

这是一个巨大的优势。

这是一个非常简单的例子：

我们想编写一个调试方法来打印[Collection](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html)中的每个元素。

[集合](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html)是一个接口。它定义了一个操作列表并且不实现它们。

您**不能**实例化集合。您**可以**实例化一个实现 Collection 的类。

[实现Collection](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html)的类有很多：ArrayList、Vector、TreeSet、LinkedList 等......它们都有*不同的*时髦特性，但它们*也*有一些共同点：因为每个类都*实现了 Collection ，所以它们都实现*[了这里](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html#method_summary)的每个方法。

这让我们可以做一件非常强大的事情：

*   *我们可以编写一个对实现 Collection的**任何***类进行操作的方法。

它看起来像这样：

```
public void printCollection(Collection semeCollection) {
    for (Object o : someCollection) {
       String s = (o == null) ? "null" : o.toString(); 
       System.out.println(s);
    }
} 
```

由于接口的魔力，我们现在可以执行以下操作：

```
public void testStuff() {

    Collection s = new TreeSet();
    Collection a = new ArrayList();
    Collection v = new Vector();

    s.add("I am a set");
    a.add("I am an array list");
    v.add("I am a vector");

    printCollection(s);
    printCollection(a);
    printCollection(v);
} 
```

# algorithm - 查找列表中哪些哈希与另一个哈希匹配最快的算法？（这在标题上解释起来很复杂）

> ID：12238689
> 
> 赞同：3
> 
> 时间：2012-09-02T18:37:46.087
> 
> 标签：algorithm, data-structures, hash, pattern-matching

当 2 个哈希匹配时用单词解释是很复杂的，因此，请参见示例：哈希模式存储在如下列表中：（*我使用 JavaScript 表示）*

```
pattern:[
    0:{type:'circle', radius:function(n){ return n>10; }},
    1:{type:'circle', radius:function(n){ return n==2; }},
    2:{type:'circle', color:'blue', radius:5},
    ... etc]

var test = {type:'circle', radius:12}; 
```

test 应该与模式 0 匹配，因为 pattern[0].type==test.type && pattern.radius(test.radius)==true。

因此，尝试使用单词时，如果哈希的每个值都等于模式的值，或者在作为函数应用时返回 true，则哈希匹配模式。

我的问题是：是否有一种算法可以在不测试所有模式的情况下找到与某个哈希匹配的所有模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:39:00.023

考虑一个动态的递归决策树结构，如下所示。

```
decision:[
    field:'type',
    values:[
        'circle': <another decision structure>,
        'square': 0, // meaning it matched, return this value
        'triangle': <another decision structure>
    ],
    functions:[
        function(n){ return n<12;}: <another decision structure>,
        function(n){ return n>12;}: <another decision structure>
    ],
    missing: <another decision structure>
] 
```

d 上的算法（一个决策结构）：

```
if test has field d.field
    if test[d.field] in d.values
        if d.values[test[d.field]] is a decision structure
            recurse using the new decision structure
        else
            yield d.values[test[d.field]]
    foreach f => v in d.functions
        if f(test[d.field])
            if v is a decision structure
                recurse using the new decision structure
            else
                yield v
else if d.missing is present
    if d.missing is a decision structure
        recurse using the new decision structure
    else
        yield d.missing
else
    No match 
```

# java - 分析一个已经加载的类

> ID：12238694
> 
> 赞同：3
> 
> 时间：2012-09-02T18:38:05.520
> 
> 标签：java, aspectj, profiler, trace

我正在为服务开发一个插件。为了使其发挥作用，它需要一些服务不提供的数据。

插件具有严格的加载/卸载规范。一个裸插件如下所示：

```
public class Plugin extends JavaPlugin 
{    
    @Override
    public void onEnable() {} //Plugin enters here. Comparable to main(String[] args)

    @Override
    public void onDisable() {} //Plugin exits here, when service shuts down.
} 
```

有一个名为 org.service.aClass 的包。里面有一个Method。aMethod 看起来像这样：

```
public boolean aMethod(boolean bool) {
return bool;
} 
```

一个过于简单的场景，但它确实有效。**每当调用 aMethod 时，我的插件都需要知道 bool 的值。这对我的程序绝对至关重要；我没有其他方法可以获得该值。**

我会建议 aMethod，但由于我的插件是在服务之后加载的，所以这不起作用。据我了解，加载时间编织也不适合这里，因为加载后。

尽管它不起作用，但这是我正在使用的方面，以防它可能有用：

```
public aspect LogAspect {

    pointcut publicMethodExecuted(): execution(* org.service.aClass.aMethod(..));

    after(): publicMethodExecuted(){
    cat(String.format("Entered method: %s.",
        thisJoinPoint.getSignature()));

    List<Object> arguments = Arrays.asList(thisJoinPoint.getArgs());
    List<Object> argTypes = new ArrayList<Object>();
    for (Object o: arguments) {  
        argTypes.add(o.getClass().toString());

    }

    cat(String.format("With argument types: %s and values: %s.",
            argTypes, arguments));

    cat(String.format("Exited method: %s.", thisJoinPoint.getSignature()));
    }

 public void cat(Object dog) {
    System.out.println("[TEST] " + dog);
    }

} 
```

我现在在我旁边打开了 AspectJ: In Action 书籍，在所有加载时编织示例中，它都提到程序必须以 -javaagent 标志启动。因为我的程序是一个插件，所以这不可能发生。

我还研究了 ASM。[我在这里](http://www.ibm.com/developerworks/java/library/j-jip/)找到了一个关于构建分析器的精彩教程（基本上是我想做的）。

问题是它在启动时再次使用 -javaagent 标志，以及公共静态 premain，所以它不合适，因为我只有 onEnable 和 onDisable。

然后我发现了 Java 的[Attach API](http://docs.oracle.com/javase/6/docs/technotes/guides/attach/index.html)。从外观上看，这将允许我在加载类之后附加我的代理，即探查器。看起来很完美，但经过半小时的搜索，我找不到一个我能理解的好例子。

有人可以帮忙吗？这是一个二合一的问题：AspectJ 可以用于此目的吗？如果是这样，怎么办？此外，如果它不能，有人可以指出我使用带有 ASM 分析器的 Attach API 的正确方向吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-05T23:15:28.550

我做到了！

[我为此处](http://www.ibm.com/developerworks/java/library/j-jip/)概述的分析器创建了一个运行时附加程序。基本上就是这样，将 premain 重命名为“agentmain”。

我创建了一个 Util 类，它具有附加器以及其他有用的功能。附加程序通过使用代理创建一个 jar 来工作，并带有一个说明它可以分析的清单。Util 类如下所示：

```
 public class Util {

    /**
     * Gets the current JVM PID
     * @return
     * Returns the PID
     * @throws Exception
     */

    public static String getPidFromRuntimeMBean() {
    String jvm = ManagementFactory.getRuntimeMXBean().getName();
    String pid = jvm.substring(0, jvm.indexOf('@'));
    return pid;
    }

    /**
     * Attaches given agent classes to JVM
     * 
     * @param agentClasses
     * A Class<?>[] of classes to be included in agent
     * @param JVMPid
     * The PID of the JVM to attach to
     */

    public static void attachAgentToJVM(Class<?>[] agentClasses, String JVMPid) {

    try {

    File jarFile = File.createTempFile("agent", ".jar");
    jarFile.deleteOnExit();

    Manifest manifest = new Manifest();
    Attributes mainAttributes = manifest.getMainAttributes();
    mainAttributes.put(Attributes.Name.MANIFEST_VERSION, "1.0");
    mainAttributes.put(new Attributes.Name("Agent-Class"),
        Agent.class.getName());
    mainAttributes.put(new Attributes.Name("Can-Retransform-Classes"),
        "true");
    mainAttributes.put(new Attributes.Name("Can-Redefine-Classes"), "true");

    JarOutputStream jos = new JarOutputStream(new FileOutputStream(
        jarFile), manifest);

    for(Class<?> clazz: agentClasses) {         
        JarEntry agent = new JarEntry(clazz.getName().replace('.',
            '/')
            + ".class");
        jos.putNextEntry(agent);

    jos.write(getBytesFromIS(clazz.getClassLoader()
        .getResourceAsStream(
            clazz.getName().replace('.', '/') + ".class")));
    jos.closeEntry();
    }

    jos.close();
    VirtualMachine vm = VirtualMachine.attach(JVMPid);
    vm.loadAgent(jarFile.getAbsolutePath());
    vm.detach();
    } catch (Exception e) {
        e.printStackTrace();
    }

    }

    /**
     * Gets bytes from InputStream
     * 
     * @param stream
     * The InputStream
     * @return 
     * Returns a byte[] representation of given stream
     */

    public static byte[] getBytesFromIS(InputStream stream) {

    ByteArrayOutputStream buffer = new ByteArrayOutputStream();
    try {
        int nRead;
        byte[] data = new byte[16384];

        while ((nRead = stream.read(data, 0, data.length)) != -1) {
        buffer.write(data, 0, nRead);
        }

        buffer.flush();
    } catch (Exception e) {
        System.err.println("Failed to convert IS to byte[]!");
        e.printStackTrace();
    }

    return buffer.toByteArray();

    }

    /**
     * Gets bytes from class
     * 
     * @param clazz    
     * The class
     * @return
     * Returns a byte[] representation of given class
     */

    public static byte[] getBytesFromClass(Class<?> clazz) {            
    return getBytesFromIS(clazz.getClassLoader().getResourceAsStream( clazz.getName().replace('.', '/') + ".class"));   
    }

} 
```

为了清楚起见，我包含了 JavaDoc 注释。

使用它的一个例子是：

```
Util.attachAgentToJVM(new Class<?>[] { Agent.class, Util.class,
        Profile.class, ProfileClassAdapter.class,
        ProfileMethodAdapter.class }, Util.getPidFromRuntimeMBean()); 
```

请记住，attacher 希望 Agent.class 成为主要代理。您可以轻松更改此设置。Class[] 的其余部分是要包含在临时 agent.jar 中的类

如果您的 IDE 抱怨“UnsatisfiedLinkError”，那是因为为此所需的 attach.(dll|so) 仅随 JDK 提供。只需将其复制粘贴到您的 %JAVA_PATH%/jre/lib 中。另外，添加对 JDK 的 tools.jar 的引用，因为它包含所有 com.sun 导入。

**编辑：**我有一个有效的 github 示例，任何人都可能认为这很有用。它[在这里](https://github.com/Icyene/ASM-Late-Bind-Agent)。

# qt - 离开 -j 关闭 Qt4 的 mingw32-make 命令？

> ID：12238695
> 
> 赞同：0
> 
> 时间：2012-09-02T18:38:16.540
> 
> 标签：qt, blackberry, qt4, mingw, playbook

[根据Building Qt4](http://qt-project.org/wiki/Building-Qt5-for-Blackberry)文档从 mingw32-make编译[Qt4](http://qt.gitorious.org/) [**git://gitorious.org/qt/qt.git**](http://qt.gitorious.org/)存储库时，我不小心遗漏了[-j [jobs] 。](http://www.gnu.org/software/make/manual/html_node/Options-Summary.html#Options-Summary)除了编译所需的时间之外，这还会产生任何其他影响吗？[](http://qt.gitorious.org/)

 ****我对命令的理解。**

*   我对命令的理解是它控制正在执行的作业的数量，但是如果在 [jobs] 中的 -j 之后没有设置任何内容，那么它可能毫无意义。
*   我可能是错的，因为我仍然没有完全理解 configure.exe 命令语法（*例如 configure.exe -opensource -confirm-license -release -xplatform unsupported/blackberry-armv7le-qcc -arch arm -nomake 示例nomake 演示 -no-neon -opengl es2 -prefix c:\dev\qt4install*）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:49:42.040

`-j`没有论据，让我们做出决定。从您的链接中，来自“<code>-j [jobs]”部分：

> 没有参数，make 同时运行尽可能多的食谱。

如果 makefile 编写正确，则使用或不使用 运行它应该没有区别`-j`，尽管（如您所述）一次运行一项作业可能会更慢。**

# java - 使用 php 脚本和来自 android 的 httppost 将数据添加到在线数据库

> ID：12238697
> 
> 赞同：0
> 
> 时间：2012-09-02T18:38:41.843
> 
> 标签：java, php, android, mysql

在我的应用程序中，我有一个特定的表格供用户填写，我想将这些数据存储在我的在线数据库中。

这是我在java中的代码：

```
public void send_data_to_DB(){
         String result = "";
         InputStream is = null;
         StringBuilder sb=null;
         ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();//() before
         nameValuePairs.add(new BasicNameValuePair("table", table));
         nameValuePairs.add(new BasicNameValuePair("code", Integer.toString(code)));
         nameValuePairs.add(new BasicNameValuePair("name", name));
         nameValuePairs.add(new BasicNameValuePair("email", email));
            try{
                HttpClient httpclient = new DefaultHttpClient();
                HttpPost httppost = new HttpPost("http://myurl.php");
                HttpEntity entity = new UrlEncodedFormEntity(nameValuePairs);
                httppost.addHeader(entity.getContentType());
                httppost.setEntity(entity);
                HttpResponse response = httpclient.execute(httppost);
                //HttpEntity entity = response.getEntity();
                //is = entity.getContent();
        }catch(Exception e){
                Log.e("log_tag", "Error in http connection "+e.toString());
        }
     } 
```

这是我的 php 脚本：

```
<?php

    mysql_connect("dserver","User","Code");

    mysql_select_db("DB_Name");

$table.=$_POST['table'];
$code.=$_POST['code'];
$name.=$_POST['name'];
$email.=$_POST['email'];

  $q=mysql_query(" INSERT INTO {$table} (code,name,email) VALUES ({$code},{$name},{$email}) ")or die(mysql_error());

mysql_close();
?> 
```

我认为这一定是我的 php 中的某些东西以及我分配或使用变量的方式，但我在 PHP 方面不太有经验。你能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:51:47.033

在 PHP 方面，它必须`.=`代替`=.`.

**编辑：**

SQL 语句中的引号丢失：

改成

```
"INSERT INTO {$table} (code,name,email) VALUES ('{$code}','{$name}','{$email}')" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:44:27.130

```
$table=.$_POST['table'];
$code=.$_POST['code'];
$name=.$_POST['name'];
$email=.$_POST['email']; 
```

每个等号后都有额外的点，这可能会导致语法错误。

您的另一个问题是 sql 注入漏洞，请在查询中使用之前始终检查 /escape 正确的值。

# ruby-on-rails - gem install sqlite3 错误权限被拒绝

> ID：12238698
> 
> 赞同：0
> 
> 时间：2012-09-02T18:38:44.790
> 
> 标签：ruby-on-rails, sqlite

从今天早上开始，我无法在我的 rails 项目上安装 sqlite3 gem ......

当我跑步时，`gem install sqlite3`我得到

```
Building native extensions.  This could take a while...
ERROR:  Error installing sqlite3:
        ERROR: Failed to build gem native extension.

        /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb
checking for sqlite3.h... *** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
        --with-opt-dir
        --with-opt-include
        --without-opt-include=${opt-dir}/include
        --with-opt-lib
        --without-opt-lib=${opt-dir}/lib
        --with-make-prog
        --without-make-prog
        --srcdir=.
        --curdir
        --ruby=/Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/bin/ruby
        --with-sqlite3-dir
        --without-sqlite3-dir
        --with-sqlite3-include
        --without-sqlite3-include=${sqlite3-dir}/include
        --with-sqlite3-lib
        --without-sqlite3-lib=${sqlite3-dir}/lib
        --enable-local
        --disable-local
/Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)
You have to install development tools first.
        from /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:506:in `try_cpp'
        from /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:970:in `block in find_header'
        from /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'
        from /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'
        from /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'
        from /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'
        from /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'
        from /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'
        from /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'
        from /Users/Jonathan/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:969:in `find_header'
        from extconf.rb:34:in `<main>'

Gem files will remain installed in /Users/Jonathan/.rvm/gems/ruby-1.9.3-p194/gems/sqlite3-1.3.6 for inspection.
Results logged to /Users/Jonathan/.rvm/gems/ruby-1.9.3-p194/gems/sqlite3-1.3.6/ext/sqlite3/gem_make.out 
```

搜索问题后，我发现解决了几乎类似的问题，`gem install sqlite3 -- --with-sqlite3-dir=/opt/local`但它告诉我 `ERROR: While executing gem ... (Errno::EACCES) Permission denied - /Users/Jonathan/.rvm/gems/ruby-1.9.3-p194/gems/sqlite3-1.3.6/API_CHANGES.rdoc`

我对编程/终端/等很陌生。所以我真的不知道该怎么办。我做了其他项目没有任何问题或错误，我认为我没有改变任何东西......我刚开始从 rails guide 做博客应用程序，并在运行时遇到了关于 sqlite3 的错误`rake db:create`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-12T20:24:17.183

作为 Ruby on Rails 的新手，我在 Windows 8 上遇到了同样的权限错误，因为我在尝试安装 sqlite3 gem 时让 rails 服务器处于运行状态。

1.  如果它正在运行，则关闭 Rails 服务器
2.  `gem install sqlite3`再次运行

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T21:09:41.810

最后是一些权限问题等。没有找到解决方法，所以我只是通过运行 RailsInstaller 重新安装了我的所有环境，重新安装 Xcode 和命令行工具，并清除`brew doctor`告诉我要做什么。

现在它又可以工作了:)

# jquery - 页面在 Facebook 共享器/状态中的行为与在 Facebook 调试器/Linter 中的行为不同

> ID：12238707
> 
> 赞同：0
> 
> 时间：2012-09-02T18:39:59.410
> 
> 标签：jquery, facebook, facebook-opengraph

我一直在为我们的双语网站制作 og 标签；它使用 jquery 滑块将语言（以及动态更改页面标题）从英语更改为阿拉伯语。

因此，所有英文页面都是**www.ourwebsite.com/page/#en**（或者只是 www.ourwebsite.com/page/，因为英语是默认设置），所有阿拉伯文页面都是**www.ourwebsite.com/page/#ar**

问题是，当我使用 facebook linter 时，上述两个页面都给了我相同的响应（这是所需且正确的响应），但是当我只是在 facebook 中分享它们时，#ar 页面给了我看起来像是第一个的响应阿拉伯文内容的段落作为页面标题（它还抓取阿拉伯文描述，这是一个无意但受欢迎的怪癖）。我想要的是#ar 页面的行为与粘贴在 facebook 共享器中时的英文页面完全一样，或者只有阿拉伯文描述但英文/阿拉伯文标题保持不变。

以下是每种语言的示例页面的 facebook 调试器结果：

*   [https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fanstonesaudiarabia.com%2Fpartners%2Flist%2F%23en](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fanstonesaudiarabia.com%2Fpartners%2Flist%2F%23en)
*   [https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fanstonesaudiarabia.com%2Fpartners%2Flist%2F%23ar](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fanstonesaudiarabia.com%2Fpartners%2Flist%2F%23ar)

如您所见，它们是相同的。但是，将第二个 URL 粘贴到 facebook 的状态中会给出一个非常不同的链接预览标题（基本上它的所有阿拉伯页面文本内容）。

任何帮助表示赞赏，

-沙迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T21:34:13.217

我注意到您在两个页面中都没有 og:url 标记。您可以尝试添加 og:url 元标记并将其指向没有 #en 或 #ar 标记的基本 url 吗？这将通知 facebook 抓取工具从该 url 中提取元内容。

# .net - 常见的实现接口类型

> ID：12238709
> 
> 赞同：-1
> 
> 时间：2012-09-02T18:40:04.847
> 
> 标签：.net, vb.net, oop, interface

我不清楚如何发布这个问题，但以某种方式表达，我想说你能列出所有常用的接口实现类型，我通常只使用 INotifyPropertyChanged，但最近只有我来了了解使用 IValueConverter 的要求，以及更多新的东西，今天我知道使用 IDisposable，因此，请您列出最常用的工具。我知道这个问题没有正确提出，因为这些实现是基于程序逻辑要求的，但我想知道，以便我可以了解它们是什么以及我需要针对某种情况做些什么。非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:21:59.133

我认为你很难在这里得到一个简洁的答案，因为“这取决于”你在做什么以及你正在开发什么类型的应用程序。恕我直言，最好的学习方式就是以身作则，用正确的资源（人员和纸张）来指导您并找到并围绕您自己。

我也不会直接回答您的问题 :)，但更广泛地了解构建在 .NET 中的框架和开源项目，看看它们是如何组合在一起的。对设计模式进行一些调查，以及在您为其构建应用程序的场景类型中使用了哪些概念和范式 - 我特别喜欢以下内容：

> [doFactory：.NET 中的设计模式](http://www.dofactory.com/Patterns/Patterns.aspx)
> 
> [.NET Framework 指南和最佳实践](http://msdn.microsoft.com/en-us/library/ms184412.aspx)
> 
> [框架设计指南](http://www.barnesandnoble.com/w/framework-design-guidelines-krzysztof-cwalina/1100835446)
> 
> [.NET 中的依赖注入](http://www.manning.com/seemann/)

但是博客圈中还有许多其他出色的参考资料和软件工匠。

总的来说，我的理念是采用并熟悉经过验证的软件模式，然后像接口这样的“细节”细节自然会出现。反之亦然，这有点像试图记住一本字典。

# c - 即使连接被接受，“recv”也不起作用

> ID：12238713
> 
> 赞同：1
> 
> 时间：2012-09-02T18:40:21.110
> 
> 标签：c, sockets, unix

2010 年，我查看了一个由 stackoverflow 成员**atanos**编写的关于将多个客户端连接到单个服务器的程序，我稍微修改了他的程序以从命令行接受连接详细信息，下面是服务器和 cient 代码。

**服务器.c**

```
int main(int argc, char **argv)
{
  fd_set fds, readfds;
  int i, clientaddrlen, portno;
  int clientsock[2], rc, numsocks = 0, maxsocks = 2;

  if (argc < 2){
      fprintf(stderr,"ERROR, no port provided\n");
      exit(1);
  }

  int serversock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);

  if (serversock == -1) perror("Socket");

  portno = atoi(argv[1]);
  struct sockaddr_in serveraddr, clientaddr;
  bzero(&serveraddr, sizeof(struct sockaddr_in));
  serveraddr.sin_family = AF_INET;
  serveraddr.sin_addr.s_addr = htonl(INADDR_ANY);
  serveraddr.sin_port = htons(portno);

  if (-1 == bind(serversock, (struct sockaddr *)&serveraddr,sizeof(struct sockaddr_in))) perror("Bind");

  if (-1 == listen(serversock, SOMAXCONN)) perror("Listen");

  FD_ZERO(&fds);
  FD_SET(serversock, &fds);

  while(1) {
    readfds = fds;
    rc = select(FD_SETSIZE, &readfds, NULL, NULL, NULL);

    if (rc == -1){
      perror("Select");
      break;
   }

    for (i = 0; i < FD_SETSIZE; i++)
    {
      if (FD_ISSET(i, &readfds)){
        if (i == serversock){
          if (numsocks < maxsocks){
            clientsock[numsocks] = accept(serversock,(struct sockaddr *) &clientaddr,
                (socklen_t *)&clientaddrlen);

            if (clientsock[numsocks] == -1) perror("Accept");
            else printf("Connection accepted\n");

            FD_SET(clientsock[numsocks], &fds);
             numsocks++;
          }
          else
            printf("Ran out of socket space.\n");
        }
        else
        {
          int messageLength = 10;
          char message[messageLength+1];
          int numOfChRead, index = 0, limit = messageLength+1;

          numOfChRead = recv(clientsock[i], message, messageLength,0);

          if(numOfChRead > 0)
              printf("Data Received !!! length: %d Message: %s", numOfChRead, message);
          else
              printf("Nothing read\n");
        }
      }
    }
  }
  close(serversock);
  return 0;
} 
```

**客户端.c**

```
int main(int argc, char **argv)
{
  struct sockaddr_in servaddr;
  struct hostent *server;
  int portno, bytesSent = 0;

  if (argc < 3){
      fprintf(stderr,"Usage %s hostname port\n", argv[0]);
      exit(0);
  }

  portno = atoi(argv[2]);
  int sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
  if (sock == -1) perror("Socket");

  server = gethostbyname(argv[1]);

  if (server == NULL){
      fprintf(stderr,"ERROR, no such host\n");
      exit(0);
  }

  bzero((void *) &servaddr, sizeof(servaddr));
  servaddr.sin_family = AF_INET;

  servaddr.sin_port = htons(portno);
  bcopy((char *)server->h_addr,(char *)&servaddr.sin_addr.s_addr,server->h_length);

  if (-1 == connect(sock, (struct sockaddr *)&servaddr, sizeof(servaddr))) perror("Connect");

  while(1) {
    char message[10];
    fgets(message, 10, stdin);
    message[10] = '\0';

    bytesSent = send(sock, message, strlen(message), 0);

    if(bytesSent == -1) printf("Sending failed with errno %d", errno);
    else printf("Sent %d characters", bytesSent);
  }
  close(sock);
} 
```

我可以看到服务器接受多个连接，但是当我从任何客户端发送消息时，服务器中的 recv API 不会读取任何内容。客户端的发送 API 成功，我可以看到所有字符都已发送。有人可以评论吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:48:38.263

问题是您实际上从未将客户端连接放入 read 中`fd_set`。

该行：

```
readfds = fds; 
```

重置`readfds`为其中只有服务器（侦听）套接字的状态。`fd_set`您需要在调用之前完全重新设置每个客户端文件描述符`select`，每次循环。

可能是其他问题（要处理很多代码），但这似乎是最有可能的问题。

（顺便说一句，我不确定分配是否合法。我认为实现对`fd_set`简单、可复制的结构没有任何要求。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:04:44.417

您的代码中有多个错误。您没有正确使用 select 调用。select 的第一个参数取您正在收听的 fd 的最大数量加 1。第二个参数包含要观看的 fd 列表。

我用 fdmax 替换了你的 FD_SETSIZE。我更正了您的代码中的问题并粘贴在下面。

```
 8 int main(int argc, char **argv)
  9 {
 10   fd_set fds, readfds;
 11   int i, clientaddrlen, portno;
 12   int clientsock[2], rc, numsocks = 0, maxsocks = 2;
 13   int fdmax=0;
 14
 15   if (argc < 2){
 16       fprintf(stderr,"ERROR, no port provided\n");
 17       exit(1);
 18   }
 19
 20   int serversock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);
 21
 22   if (serversock == -1) perror("Socket");
 23
 24   portno = atoi(argv[1]);
 25   struct sockaddr_in serveraddr, clientaddr;
 26   bzero(&serveraddr, sizeof(struct sockaddr_in));
 27   serveraddr.sin_family = AF_INET;
 28   serveraddr.sin_addr.s_addr = htonl(INADDR_ANY);
 29   serveraddr.sin_port = htons(portno);
 30
 31   if (-1 == bind(serversock, (struct sockaddr *)&serveraddr,sizeof(struct sockaddr_in))) perror("Bind");
 32
 33   if (-1 == listen(serversock, SOMAXCONN)) perror("Listen");
 34
 35   FD_ZERO(&fds);
 36   FD_SET(serversock, &fds);
 37   fdmax = serversock;
 38
 39   clientaddrlen = sizeof(clientaddr);
 40   while(1) {
 41     readfds = fds;
 42     rc = select(fdmax + 1, &readfds, NULL, NULL, NULL);
 43
 44     if (rc == -1){
 45       perror("Select");
 46       break;
 47    }
 48
 49     for (i = serversock; i <= fdmax; i++)
 50     {
 51       if (FD_ISSET(i, &readfds)){
 52         if (i == serversock){
 53           if (numsocks < maxsocks){
 54             clientsock[numsocks] = accept(serversock,(struct sockaddr *) &clientaddr,
 55                 (socklen_t *)&clientaddrlen);
 56
 57             if (clientsock[numsocks] == -1) perror("Accept");
 58             else printf("Connection accepted\n");
 59
 60             FD_SET(clientsock[numsocks], &fds);
 61             fdmax = clientsock[numsocks];
 62              numsocks++;
 63           }
 64           else
 65             printf("Ran out of socket space.\n");
 66         }
 67         else
 68         {
 69           int messageLength = 100;
 70           char message[messageLength+1];
 71           int numOfChRead, index = 0, limit = messageLength+1;
 72
 73           numOfChRead = recv(i, message, messageLength,0);
 74
 75           if(numOfChRead > 0)
 76               printf("Data Received !!! length: %d Message: %s", numOfChRead, message);
 77           else
 78               printf("Nothing read\n");
 79         }
 80       }
 81     }
 82   }
 83   close(serversock);
 84   return 0;
 85 } 
```

# android - 在 Android 应用中从 Google 获取搜索结果

> ID：12238727
> 
> 赞同：3
> 
> 时间：2012-09-02T18:41:47.500
> 
> 标签：android

在我的 android 应用程序中，我想从用户那里获取搜索查询，并使用该查询搜索 google，获取搜索结果并使用搜索结果填充列表。自定义搜索 API 限制为每天 100 次免费搜索。那么有没有其他的搜索方式呢？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T19:12:16.167

这是您可以使用的东西。

[http://google.com/complete/search?output=toolbar&q=](http://google.com/complete/search?output=toolbar&q=)**查询**

它返回一个 XML 文件。解析该 xml 以获得结果。但谷歌将来可能会改变查询的格式。这是这里唯一的问题。否则效果很好。

为了将来参考，请注意以下对其他有用网站的查询。一些以 JSON 格式返回，而另一些以 XML 格式返回。

[http://suggestqueries.google.com/complete/search?hl=en&ds=yt&client=youtube&hjson=t&cp=1&q=](http://suggestqueries.google.com/complete/search?hl=en&ds=yt&client=youtube&hjson=t&cp=1&q=) **query** &alt=json

[http://search.yahooapis.com/WebSearchService/V1/relatedSuggestion?appid=YahooDemo&query=](http://search.yahooapis.com/WebSearchService/V1/relatedSuggestion?appid=YahooDemo&query=)**查询**

[http://en.wikipedia.org/w/api.php?action=opensearch&search=](http://en.wikipedia.org/w/api.php?action=opensearch&search=)**查询**&limit=10&namespace=0&format=json

[http://anywhere.ebay.com/services/suggest/?q=](http://anywhere.ebay.com/services/suggest/?q=)**查询**&s=0

[http://completion.amazon.com/search/complete?method=completion&q=](http://completion.amazon.com/search/complete?method=completion&q=) **query** &search-alias=aps&mkt=1

[http://api.bing.net/osjson.aspx?Query=](http://api.bing.net/osjson.aspx?Query=)**查询**&Market=en-us

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T10:21:11.760

您可以尝试使用此代码

MainActivity.java

```
private EditText editTextInput;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_g__search);

editTextInput = (EditText) findViewById(R.id.editTextInput);
}

public void onSearchClick(View v)
{
try {
Intent intent = new Intent(Intent.ACTION_WEB_SEARCH);
String term = editTextInput.getText().toString();
intent.putExtra(SearchManager.SUGGEST_URI_PATH_QUERY, term);
startActivity(intent);
} catch (Exception e) {
// TODO: handle exception
}

} 
```

Activity_layout.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
 >

<EditText
    android:id="@+id/editTextInput"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:ems="10" >

    <requestFocus />
</EditText>

<Button
    android:id="@+id/button1"
    style="?android:attr/buttonStyleSmall"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignRight="@+id/editTextInput"
    android:layout_below="@+id/editTextInput"
    android:layout_marginRight="43dp"
    android:layout_marginTop="60dp"
    android:onClick="onSearchClick"
    android:text="CLICK" /> 
```

还添加互联网权限

# mysql - Mysql获取表的上半部分然后是表的下半部分

> ID：12238731
> 
> 赞同：3
> 
> 时间：2012-09-02T18:42:15.783
> 
> 标签：mysql

我需要在第一个查询中获取表的**上半**部分，在下一个查询中我需要**下半部分。**

我尝试为顶部执行此操作，但它不起作用

```
SELECT * FROM t_domains WHERE type_domain='radio' ORDER BY 
date_created DESC LIMIT 0, (COUNT(*) / 2) 
```

我需要它作为我的函数工作的两个查询。

有人有任何指示或提示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T18:50:29.860

我建议做2个查询：

```
select count(*) from t_domains 
```

获取总数，然后使用limit和offset获取你想要的数据：

```
select * from t_domains limit count/2 
```

对于顶部和

```
select * from t_domains offset count/2 
```

对于下半部分......

这种方法还为您提供了一种在另一种情况下限制查询的方法：如果表包含 100 万条记录怎么办？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:43:18.367

上半年

```
 mysql-> SET @n := 0

 mysql-> SELECT *,nnn FROM (
         SELECT *, @n := @n + 1 AS nnn  FROM t_domains   ORDER BY date_created 
         ) AS t
         WHERE nnn <=  ( SELECT COUNT(date_created) / 2  FROM t_domains  ) AND type_domain =    'radio' 
```

下半场，在此处更改 **WHERE nnn <=** this "<" on this ">"

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-03-23T09:25:52.713

正如MySQL 的官方文档中解释的那样，除了准备好的语句和存储的程序外，[的](https://dev.mysql.com/doc/refman/8.0/en/select.html)两个`LIMIT`参数都必须是**CONSTANTS 。**`LIMIT`简单地存储计数并稍后在子句中使用它似乎并不容易。

从 8.0 版开始，MySQL 提供了一个[`ROW_NUMBER()`](https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html)函数，它提供了一个比其他答案指出的更简单的解决方案。

```
set @count=(select count(*)/2 from t_domains);

select * from (
select *, ROW_NUMBER() over (order by date_created desc) as row_num 
from t_domains
) as t
where row_num <= @count
; 
```

您还可以检查[`RANK()`](https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html#function_rank)，它认为具有相同值的行具有相同的“排名”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-02T18:49:02.460

这总是有效的。

存储计数

```
SELECT COUNT(*) FROM t_domains WHERE type_domain='radio' 
```

然后使用存储的计数。

```
SELECT * FROM t_domains WHERE type_domain='radio' ORDER BY 
date_created DESC LIMIT 0, {$stored_count/2} 
```

# perl - Perl 哈希 + 文件 + While

> ID：12238732
> 
> 赞同：0
> 
> 时间：2012-09-02T18:42:16.860
> 
> 标签：perl

好吧，这个想法是删除文件的描述方向并将其存储在哈希中

这是文件 /home/opmeitle/files-pl/bookmarks2 中的内容

```
 }, {
       "date_added": "12989744094664781",
       "id": "1721",
       "name": "Perl DBI - dbi.perl.org",
       "type": "url",
       "url": "http://dbi.perl.org/"
    }, {
       "date_added": "12989744373130384",
       "id": "1722",
       "name": "DBD::mysql - MySQL driver for the Perl5 Database Interface (DBI) - metacpan.org",
       "type": "url",
       "url": "https://metacpan.org/module/DBD::mysql"
    }, { 
```

现在，perl 中的代码。

```
use strict;

open(FILE, '/home/opmeitle/files-pl/bookmarks2');  
my @lines = <FILE>;
my @list55;
my $count = 1;
my $n = 0;
my %hash=();   #$hash{$lines[$n]}=$lines[$n];
    while ($lines[$n]) {
        if ($lines[$n] =~ /(http:|https:|name)/) {
            if ($lines[$n] =~ s/("|: |,|id|url|name|\n)//g) {
                if ($lines[$n] =~ s/^\s+//){
                    if ($lines[$n] =~ /http:|https/){ 
                        $hash{$lines[$n]} = '';
                    }
                    else {
                        $hash{$n} = $lines[$n];
                    }
                }
            }
        }
    $n++;
    $count++;
    }
close(FILE);
# print hash
my $key;
my $value;
while( ($key,$value) = each %hash){
    print "$key = $value\n";
} 
```

执行脚本后的结果。

```
http://dbi.perl.org/ = 
https://metacpan.org/module/DBD::mysql = 
3 = Perl DBI - dbi.perl.org
9 = DBD::mysql - MySQL driver for the Perl5 Database Interface (DBI) - metacpan.org 
```

但我需要这样的东西

```
http://dbi.perl.org/ = Perl DBI - dbi.perl.org
Perl DBI - dbi.perl.org = DBD::mysql - MySQL driver for the Perl5 Database Interface (DBI) - metacpan.org 
```

谢谢你的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:56:28.140

[正如@amon 所暗示的，Chrome 书签是 JSON 格式，在CPAN](https://metacpan.org/search?q=json)上有几个很好的模块。

```
use strict;
use warnings;
use JSON;

my $file = '/home/opmeitle/files-pl/bookmarks2';
open my $fh, '<', $file or die "$file: $!\n";
my $inhash = decode_json(join '', <$fh>);
close $fh;

my %outhash = map traverse($_), values %{ $inhash->{roots} };
sub traverse
{
  my $hashref = shift;

  if (exists $hashref->{children}) {
    return map traverse($_), @{ $hashref->{children} };
  } else {
    return $hashref->{url} => $hashref->{name};
  }
} 
```

现在`%outhash`有了你想要的数据。

编辑：帮助了解这里发生了什么：

```
use Data::Dumper;
print Dumper($inhash); # pretty-print the structure returned by decode_json 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:52:19.013

正如其他人所说，最好的办法是将 JSON 数据加载到 Perl 数据结构中。使用该[`JSON`](http://p3rl.org/JSON)模块很容易做到这一点。在我们这样做之前，我们需要读入文件。有两种方法可以做到这一点。非 CPAN 方式：

```
# always ...
use strict;
use warnings;

my $file = '/home/opmeitle/files-pl/bookmarks2';

my $text = do {
  open my $fh, '<', $file or die "Cannot open $file: $!\n";
  local $/; #enable slurp
  <$fh>;
}; 
```

或 CPAN 方式

```
# always ...
use strict;
use warnings;

use File::Slurp;
my $text = read_file $file; 
```

一旦你读入文件，然后解码

```
use JSON;

my $data = decode_json $text; 
```

Please post a whole file and a better description of what you want and I would be glad to comment on a more formal way of traversing the datastructure.

# java - 如何在运行时从 Hibernate 检索 hibernate.hbm2ddl.auto 值？

> ID：12238740
> 
> 赞同：0
> 
> 时间：2012-09-02T18:43:29.873
> 
> 标签：java, hibernate, configuration

我正在尝试解决 Web 应用程序中可能存在的配置错误。我想`hibernate.hbm2ddl.auto`在运行时从 Hibernate 检索值，可以吗？JPA EntityManager 创建成功。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-03T04:29:09.043

检查源代码后，用于构建的所有配置参数都`SessionFactory`将存储在其 [Settings](http://docs.jboss.org/hibernate/orm/4.1/javadocs/org/hibernate/cfg/Settings.html)属性中。

给定 的实例 `EntityManager`，您可以`SessionFactory`通过以下代码获取用于构建它的实例：

```
Session session = entityManager.unwrap(Session.class);
SessionFactoryImpl sessionImpl = (SessionFactoryImpl)session.getSessionFactory(); 
```

并`Settings`从 SessionFactoryImpl 获取实例：

```
Settings setting = sessionImpl.getSettings(); 
```

但是，根据以下[代码](http://grepcode.com/file/repo1.maven.org/maven2/org.hibernate/hibernate-core/4.1.5.Final/org/hibernate/cfg/SettingsFactory.java?av=f)如何`Settings`从配置参数构建此实例：

```
Settings settings = new Settings();
String autoSchemaExport = properties.getProperty( Environment.HBM2DDL_AUTO );
    if ( "validate".equals(autoSchemaExport) ) {
        settings.setAutoValidateSchema( true );
    }
    if ( "update".equals(autoSchemaExport) ) {
        settings.setAutoUpdateSchema( true );
    }
    if ( "create".equals(autoSchemaExport) ) {
        settings.setAutoCreateSchema( true );
    }
    if ( "create-drop".equals( autoSchemaExport ) ) {
        settings.setAutoCreateSchema( true );
        settings.setAutoDropSchema( true );
    } 
```

的实际值`hibernate.hbm2ddl.auto`不会存储在`Settings`实例中。它仅解析为 `autoDropSchema`,`autoCreateSchema`和的不同值`autoValidateSchema`。您必须使用这些属性来确定 的实际值`hibernate.hbm2ddl.auto`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T04:08:36.243

要读取配置属性，您可以尝试以下操作：

```
AnnotationConfiguration conf = new AnnotationConfiguration().configure();
String confValue = conf.getProperty( "hibernate.hbm2ddl.auto" ); 
```

# internet-explorer - IE 9 中的 GWT 和画布

> ID：12238745
> 
> 赞同：0
> 
> 时间：2012-09-02T18:43:45.987
> 
> 标签：internet-explorer, gwt, html5-canvas

我有一个使用两个画布的 Web 应用程序。今天我注意到其中一个画布在 IE9 中无法正确显示。与正确显示的不同，第二个画布的大小参数不是由默认值设置的，而是使用应该在主应用程序启动之前加载的 ImageElement 的尺寸。

但是尽管所有这些在 Chrome 和 Firefox 中都能正常工作，但画布的样式参数仍保持在 0px。

这是我用来设置画布的代码：

```
tableImage = IMAGES.get(imageName);     
simulatorScreen = Canvas.createIfSupported();   
simulatorScreen.setPixelSize(tableImage.getWidth(),tableImage.getHeight());
simulatorScreen.setCoordinateSpaceWidth(tableImage.getWidth());
simulatorScreen.setCoordinateSpaceHeight(tableImage.getHeight()); 
```

IMAGES 是由我的图像加载器创建的一个 Map，其中填充了 ImageElements，键是一个字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T02:52:11.513

**您可能希望通过检查完整**属性来确保已加载图像。如果是，那么您拥有的第二个选项是在 setPixelSize 函数上设置断点并验证参数是否以适当的大小通过。您可以通过点击“F12”键或菜单中的工具 -> F12 开发人员工具来使用 IE 中的集成调试器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T07:35:47.683

我发现了问题所在。虽然 Firefox 和 Chrome 支持将图像元素存储在单独的变量中，但 IE 似乎要求将元素显式存储在 DOM 中才能访问其维度属性。它现在可以正常工作。

# ajax - 拖放 Javascript 在移动设备上的 ajax 请求中不起作用

> ID：12238748
> 
> 赞同：1
> 
> 时间：2012-09-02T18:44:26.017
> 
> 标签：ajax, jquery-mobile, drag-and-drop, touch

我正在尝试制作一个功能，让用户在文本框中输入内容，在您输入内容时生成建议（如 Google Instant），然后可以将这些建议拖到页面上的框中。一切都很好，直到我发现触摸屏移动设备不能使用 HTML 5 拖放。我试图让它与 jquery 一起工作，但进展并不顺利。

下面的代码显示了一个可拖动的图像，它适用于触摸屏和鼠标。

```
<script type='text/javascript' src='js/head.min.js'></script>
        <link rel='stylesheet' type='text/css' href='css/style.css' />
<script>
head.js('https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js','js/ui.js','js/touch.js', function (){
   $('#touchme1').draggable({revert:true});
$('#drop').droppable({
    drop: function( event, ui ) {
        $(ui.draggable).remove();
        $(this).css({'border':'#777 dashed 3px','background':'#eee'});
    },
    over: function(event, ui) {
        $(this).css({'border':'#a33 dashed 3px','background':'#faa'});
    },
    out: function (event, ui){
        $(this).css({'border':'#777 dashed 3px','background':'#eee'});
    }
});
});
</script>
<img src='itemimages/75.jpg' id='touchme1' class='touchBox'> 
```

问题是，当在调用以显示搜索结果的 php 文件中使用相同的代码时，拖放在移动设备上不起作用（但在台式机上起作用）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T08:34:00.553

我感觉您可能需要将事件处理程序附加到 #touch1 元素。您发布的代码仅查找 DOM 中已存在的 #touch1 元素，但由于您的元素是通过 AJAX 加载的，因此页面首次加载时它不会在 DOM 中。

您可以使用`.on()`将事件处理程序附加到对象。

```
$(document).on('mouseover', '#touchme1', function(){
    $(this).draggable({revert:true});
}); 
```

在上面的示例中，我使用了`mouseover`事件。但是，您需要选择一个事件处理程序，该处理程序适用于您的触摸设备和鼠标。

示例 jsbin：http: [//jsbin.com/agisom/2/edit](http://jsbin.com/agisom/2/edit)

# spring - Spring 3.2 长轮询导致 SPRING_SECURITY_CONTEXT 被清除

> ID：12238750
> 
> 赞同：3
> 
> 时间：2012-09-02T18:44:44.673
> 
> 标签：spring, spring-security, tomcat7

我正在使用 Spring 3.2 Milestone 1 来实现具有[长轮询](http://blog.springsource.org/2012/05/13/spring-mvc-3-2-preview-adding-long-polling-to-an-existing-web-application/)的服务。但是由于某种原因，Spring Security (3.1.2) 在第一个延迟结果过期后立即清除 SPRING_SECURITY_CONTEXT（已达到 asynctimeout 并且 tomcat 以 http.200 响应）或某些响应被发送回客户端。使用 Spring Security 3.1.0，这只发生在某些情况下（HTTPS 和客户端位于某些硬件防火墙后面），但在 3.1.2 中它总是发生（在第一个 DeferedResult 完成之后）！

这是日志相关部分的调试输出

```
DEBUG: org.springframework.security.web.util.AntPathRequestMatcher - Checking match of request : '/updates/events'; against '/login*'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 1 of 11 in additional filter chain; firing Filter: 'SecurityContextPersistenceFilter'
DEBUG: org.springframework.security.web.context.HttpSessionSecurityContextRepository - Obtained a valid SecurityContext from SPRING_SECURITY_CONTEXT: 'org.springframework.security.core.context.SecurityContextImpl@fc783ee2: Authentication: org.springframework.security.authentication.UsernamePasswordAuthenticationToken@fc783ee2: Principal: org.springframework.security.core.userdetails.User@33ca09: Username: nvrs; Password: [PROTECTED]; Enabled: true; AccountNonExpired: true; credentialsNonExpired: true; AccountNonLocked: true; Granted Authorities: ADMIN; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@0: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: 46EC76439E921FE347EC48ECF71C1258; Granted Authorities: ADMIN'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 2 of 11 in additional filter chain; firing Filter: 'LogoutFilter'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 3 of 11 in additional filter chain; firing Filter: 'UsernamePasswordAuthenticationFilter'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 4 of 11 in additional filter chain; firing Filter: 'BasicAuthenticationFilter'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 5 of 11 in additional filter chain; firing Filter: 'RequestCacheAwareFilter'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 6 of 11 in additional filter chain; firing Filter: 'SecurityContextHolderAwareRequestFilter'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 7 of 11 in additional filter chain; firing Filter: 'RememberMeAuthenticationFilter'
DEBUG: org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter - SecurityContextHolder not populated with remember-me token, as it already contained: 'org.springframework.security.authentication.UsernamePasswordAuthenticationToken@fc783ee2: Principal: org.springframework.security.core.userdetails.User@33ca09: Username: nvrs; Password: [PROTECTED]; Enabled: true; AccountNonExpired: true; credentialsNonExpired: true; AccountNonLocked: true; Granted Authorities: ADMIN; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@0: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: 46EC76439E921FE347EC48ECF71C1258; Granted Authorities: ADMIN'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 8 of 11 in additional filter chain; firing Filter: 'AnonymousAuthenticationFilter'
DEBUG: org.springframework.security.web.authentication.AnonymousAuthenticationFilter - SecurityContextHolder not populated with anonymous token, as it already contained: 'org.springframework.security.authentication.UsernamePasswordAuthenticationToken@fc783ee2: Principal: org.springframework.security.core.userdetails.User@33ca09: Username: nvrs; Password: [PROTECTED]; Enabled: true; AccountNonExpired: true; credentialsNonExpired: true; AccountNonLocked: true; Granted Authorities: ADMIN; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@0: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: 46EC76439E921FE347EC48ECF71C1258; Granted Authorities: ADMIN'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 9 of 11 in additional filter chain; firing Filter: 'SessionManagementFilter'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 10 of 11 in additional filter chain; firing Filter: 'ExceptionTranslationFilter'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 at position 11 of 11 in additional filter chain; firing Filter: 'FilterSecurityInterceptor'
DEBUG: org.springframework.security.web.util.AntPathRequestMatcher - Checking match of request : '/updates/events'; against '/updates/**'
DEBUG: org.springframework.security.web.access.intercept.FilterSecurityInterceptor - Secure object: FilterInvocation: URL: /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526; Attributes: [hasAnyRole('ADMIN','MANAGER','INTERNAL')]
DEBUG: org.springframework.security.web.access.intercept.FilterSecurityInterceptor - Previously Authenticated: org.springframework.security.authentication.UsernamePasswordAuthenticationToken@fc783ee2: Principal: org.springframework.security.core.userdetails.User@33ca09: Username: nvrs; Password: [PROTECTED]; Enabled: true; AccountNonExpired: true; credentialsNonExpired: true; AccountNonLocked: true; Granted Authorities: ADMIN; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@0: RemoteIpAddress: 0:0:0:0:0:0:0:1; SessionId: 46EC76439E921FE347EC48ECF71C1258; Granted Authorities: ADMIN
DEBUG: org.springframework.security.access.vote.AffirmativeBased - Voter: org.springframework.security.web.access.expression.WebExpressionVoter@52bf21bf, returned: 1
DEBUG: org.springframework.security.web.access.intercept.FilterSecurityInterceptor - Authorization successful
DEBUG: org.springframework.security.web.access.intercept.FilterSecurityInterceptor - RunAsManager did not change Authentication object
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481959526 reached end of additional filter chain; proceeding with original chain
DEBUG: org.springframework.security.web.access.ExceptionTranslationFilter - Chain processed normally
DEBUG: org.springframework.security.web.context.SecurityContextPersistenceFilter - SecurityContextHolder now cleared, as request processing completed
DEBUG: org.springframework.security.web.access.ExceptionTranslationFilter - Chain processed normally
DEBUG: org.springframework.security.web.context.SecurityContextPersistenceFilter - SecurityContextHolder now cleared, as request processing completed
DEBUG: org.springframework.security.web.access.ExceptionTranslationFilter - Chain processed normally
DEBUG: org.springframework.security.web.context.SecurityContextPersistenceFilter - SecurityContextHolder now cleared, as request processing completed
DEBUG: org.springframework.security.web.util.AntPathRequestMatcher - Checking match of request : '/updates/events'; against '/login*'
DEBUG: org.springframework.security.web.util.AntPathRequestMatcher - Checking match of request : '/updates/events'; against '/resources/css/**'
DEBUG: org.springframework.security.web.util.AntPathRequestMatcher - Checking match of request : '/updates/events'; against '/resources/images/**'
DEBUG: org.springframework.security.web.util.AntPathRequestMatcher - Checking match of request : '/updates/events'; against '/resources/*'
DEBUG: org.springframework.security.web.FilterChainProxy - /updates/events?clientId=nvrs1346481959144&timestamp=0&_=1346481985081 at position 1 of 11 in additional filter chain; firing Filter: 'SecurityContextPersistenceFilter'
DEBUG: org.springframework.security.web.context.HttpSessionSecurityContextRepository - HttpSession returned null object for SPRING_SECURITY_CONTEXT
DEBUG: org.springframework.security.web.context.HttpSessionSecurityContextRepository - No SecurityContext was available from the HttpSession: org.apache.catalina.session.StandardSessionFacade@61ed10f7\. A new one will be created. 
```

如果您仔细查看输出，您将看到第一个长轮询请求“/updates/events?” 被正确处理 - 授予访问权限，但之后弹簧安全上下文被清除，正如您从“HttpSession 返回 SPRING_SECURITY_CONTEXT 的空对象”行中看到的那样，这是由客户端在第一个请求过期后对该 URL 的另一个请求触发的或事件触发非空响应。我想在这里指出，我所有的自定义过滤器都已被禁用，并且在处理长轮询请求时，我将 DeferedResult 存储到带有 sessionId-clientid （每个页面实例浏览器选项卡唯一）作为访问它的键的 Map 和在收到 JMS 消息的情况下向客户端发送结果。

Spring framework 3.2 M1 和最新的 3.2 快照版本与 Spring Security 3.1.2 或其各自的最新快照在 Tomcat 7.0.28 / 7.0.29（默认和 APR 连接器）下存在问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-03T09:29:53.227

在调试器的帮助下，我得出了以下结论：

在设置 DeferedResult 之后，通过代理调用的`flush()`方法`org.springframework.security.web.context.SaveContextOnUpdateOrErrorResponseWrapper`被`saveContext()`调用`org.springframework.security.web.context.HttpSessionSecurityContextRepository`。

```
@Override
protected void saveContext(SecurityContext context) {
    final Authentication authentication = context.getAuthentication();
    HttpSession httpSession = request.getSession(false);

    // See SEC-776
    if (authentication == null || authenticationTrustResolver.isAnonymous(authentication)) {
        if (logger.isDebugEnabled()) {
            logger.debug("SecurityContext is empty or contents are anonymous - context will not be stored in HttpSession.");
        }

        if (httpSession != null && !contextObject.equals(contextBeforeExecution)) {
            // SEC-1587 A non-anonymous context may still be in the session
            // SEC-1735 remove if the contextBeforeExecution was not anonymous
            httpSession.removeAttribute(springSecurityContextKey);
        }
        return;
    } 
```

由于身份验证对象为空（由于 spring 安全上下文已被清除）， httpSession.removeAttribute(springSecurityContextKey) 行从会话中删除 SPRING_SECURITY_CONTEXT 并且用户发出的下一个请求导致会话没有安全上下文因此用户被重定向到登录。除非我在这里遗漏了一些明显的东西，否则这是异步请求的交易破坏者。我想知道 Spring Security 团队是否意识到了这个问题，以及他们是否计划在 3.2 发布之前修复它。与此同时，有人对适当的解决方法有任何建议吗？

编辑：目前作为临时解决方案，我通过在异步请求的情况下不编辑会话来处理该问题。具体来说，我修改了检查何时从以下位置刷新 securityContext：

```
if (httpSession != null && !contextObject.equals(contextBeforeExecution)) 
```

到

```
if (httpSession != null && !contextObject.equals(contextBeforeExecution) && this.request.getAttribute("javax.servlet.async.request_uri") == null) 
```

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-22T07:31:50.180

您是否在服务器端使用分叉线程？

我们有一个类似的安全上下文被清除的问题，因为我们`forked threads`与响应进行了交互。安全上下文是一个`thread local`变量，默认情况下不与分叉线程共享（请参阅[doc](http://docs.spring.io/spring-security/site/docs/current/apidocs/org/springframework/security/core/context/SecurityContextHolder.html)）。

我们通过将 of 设置`strategy`为`SecurityContextHolder`来解决了这个问题`MODE_INHERITABLETHREADLOCAL`：

弹簧安全配置xml：

```
<beans:bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
    <property name="targetClass" value="org.springframework.security.core.context.SecurityContextHolder" />
    <property name="targetMethod" value="setStrategyName" />
    <property name="arguments" value="MODE_INHERITABLETHREADLOCAL" />
</beans:bean> 
```

**2016 年 10 月 31 日更新**：

在使用线程池（例如 Tomcat）的环境中使用`INHERITABLETHREADLOCAL`可能会导致 ThreadLocal 泄漏。还有其他方法（例如使用`DelegatingSecurityContextRunnable`）来确保分叉线程获得正确的 Spring 安全上下文。请参阅[并发支持](http://docs.spring.io/spring-security/site/docs/current/reference/html/concurrency.html)。

# objective-c - 错误线程 1：信号 SIGBRT

> ID：12238755
> 
> 赞同：0
> 
> 时间：2012-09-02T18:45:29.663
> 
> 标签：objective-c, ios, sigabrt

我正在学习Objective C，并且正在学习本书中的示例。但是在某些示例中，我不断收到此错误！我完全按照步骤操作，请帮助！我已经尝试将 iOS 模拟器恢复为其默认设置，但仍然没有运气。

这是一个应用程序，您可以在其中录制声音并播放。这是代码...

```
- (IBAction)recordAudio:(id)sender {
    if ([self.recordButton.titleLabel.text isEqualToString:@"Record Audio"]){
        [self.audioRecorder record];
        [self.recordButton setTitle:@"Stop Recording"
                           forState:UIControlStateNormal];
    } else {
        [self.audioRecorder stop];
        [self.recordButton setTitle:@"Record Audio"
                           forState:UIControlStateNormal];

        // Load the new sound in the audioplayer for playback
        NSURL *soundFileURL = [NSURL fileURLWithPath:[NSTemporaryDirectory()
                             stringsByAppendingPaths:@"sound.caf"]];

        self.audioPlayer = [[AVAudioPlayer alloc]
                            initWithContentsOfURL:soundFileURL error:nil];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:16:55.227

我运行了您的部分代码，这是错误消息：

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '***
-[__NSCFString stringsByAppendingPaths:]: paths argument is not an array' 
```

正如文档所说，stringsByAppendingPaths 返回一个由 NSString 对象组成的 NSArray，该对象是通过将每个 NSString 分别附加到接收器的 NSArray 路径中而制成的。@"sound.caf" 是一个 NSString，而不是一个 NSArray，它会引发异常。

更改以下内容：

```
 NSURL *soundFileURL = [NSURL fileURLWithPath:[NSTemporaryDirectory()
                         stringsByAppendingPaths:@"sound.caf"]]; 
```

至：

```
 NSURL *soundFileURL = [NSURL fileURLWithPath:[NSTemporaryDirectory()
                         stringByAppendingPathComponent:@"sound.caf"]]; 
```

它应该可以工作。

# android - 按下返回或主页时 Android 应用程序崩溃

> ID：12238759
> 
> 赞同：0
> 
> 时间：2012-09-02T18:45:47.190
> 
> 标签：android

我的应用程序崩溃时遇到问题。当我按下返回按钮或主页按钮时，它有时会崩溃。有时我可以退出应用程序，当我返回它时它会崩溃。我认为这是因为我正在使用线程。我使用了一个在线教程，展示了如何使用图形。它使用表面视图和线程。这是来自 GraphicalMenu.java 的代码。

```
 class Panel extends SurfaceView implements SurfaceHolder.Callback{
    private TutorialThread _thread;

    public Panel(Context context) {

        super(context);

        getHolder().addCallback(this);
        _thread = new TutorialThread(getHolder(), this);
        setFocusable(true);

        // TODO Auto-generated constructor stub
    }

    @Override
    public void onDraw(Canvas canvas){

    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {

        return true;
    }   

    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int width,
            int height) {
        // TODO Auto-generated method stub

    }

    @Override
    public void surfaceCreated(SurfaceHolder holder) {
        _thread.setRunning(true);
        _thread.start();

    }

    @Override
    public void surfaceDestroyed(SurfaceHolder holder) {
        // TODO Auto-generated method stub

         boolean retry = true;
            _thread.setRunning(false);
            while (retry) {
                try {
                    _thread.join();
                    retry = false;
                } catch (InterruptedException e) {
                    // we will try it again and again...
                }
            }

    }

}
class TutorialThread extends Thread {
    private SurfaceHolder _surfaceHolder;
    private Panel _panel;
    private boolean _run = false;

    public TutorialThread(SurfaceHolder surfaceHolder, Panel panel) {
        _surfaceHolder = surfaceHolder;
        _panel = panel;
    }

    public void setRunning(boolean run) {
        _run = run;
    }

    @Override
    public void run() {
        Canvas c;
        while (_run) {
            c = null;
            try {
                c = _surfaceHolder.lockCanvas(null);
                synchronized (_surfaceHolder) {
                    _panel.onDraw(c);
                }
            } finally {
                // do this in a finally so that if an exception is thrown
                // during the above, we don't leave the Surface in an
                // inconsistent state
                if (c != null) {
                    _surfaceHolder.unlockCanvasAndPost(c);
                }
            }
        }
    }
} 
```

这是我在 logcat 中得到的错误和警告

```
09-01 10:41:39.690: E/global(17293):    at com.UWIgem.test2d.Splash$1.run(Splash.java:37)    
09-01 10:43:07.920: E/AndroidRuntime(17293):    at com.UWIgem.test2d.GraphicalMenu$Panel.surfaceCreated(GraphicalMenu.java:193)
09-01 10:43:07.940: W/ActivityManager(2799):   Force finishing activity com.UWIgem.test2d/.GraphicalMenu
09-01 10:43:08.475: W/ActivityManager(2799): Activity pause timeout for ActivityRecord{40757290 com.UWIgem.test2d/.GraphicalMenu}
09-01 10:43:17.879: W/ActivityManager(2799): Activity idle timeout for ActivityRecord{40757290 com.UWIgem.test2d/.GraphicalMenu}
09-01 10:43:18.525: W/WindowManager(2799): Force-removing child win Window{42377460 SurfaceView paused=false} from container Window{42313fe8 com.UWIgem.test2d/com.UWIgem.test2d.GraphicalMenu paused=false}
09-01 10:43:27.885: W/ActivityManager(2799): Activity destroy timeout for ActivityRecord{40757290 com.UWIgem.test2d/.GraphicalMenu}
09-01 10:47:36.930: E/AndroidRuntime(17445):    at com.UWIgem.test2d.GraphicalMenu$Panel.surfaceCreated(GraphicalMenu.java:193)
09-01 10:47:36.980: W/ActivityManager(2799):   Force finishing activity com.UWIgem.test2d/.GraphicalMenu
09-01 10:47:37.495: W/ActivityManager(2799): Activity pause timeout for ActivityRecord{41c1dcc8 com.UWIgem.test2d/.GraphicalMenu}
09-01 10:47:46.895: W/ActivityManager(2799): Activity idle timeout for ActivityRecord{41c1dcc8 com.UWIgem.test2d/.GraphicalMenu}
09-01 10:47:51.335: W/ActivityManager(2799): Activity idle timeout for ActivityRecord{41634868 com.UWIgem.test2d/.StartMenu}
09-01 10:47:52.259: W/ActivityManager(2799): Activity pause timeout for ActivityRecord{41634868 com.UWIgem.test2d/.StartMenu}
09-01 10:47:57.230: W/ActivityManager(2799): Activity destroy timeout for ActivityRecord{41c1dcc8 com.UWIgem.test2d/.GraphicalMenu}
09-01 10:52:41.354: W/WindowManager(2799): Force-removing child win Window{41a5dbb0 SurfaceView paused=false} from container Window{40b37498 com.UWIgem.test2d/com.UWIgem.test2d.GraphicalMenu paused=false} 
```

我知道这是很多文字，但我总是看到有人在这个网站上要求 logcat 和代码。我不会覆盖 onPause onStart 或 onStop。我需要在这些方法中添加什么？如果您有任何意见，将不胜感激。

# html - 未显示徽标图像 除了在默认页面上

> ID：12238764
> 
> 赞同：0
> 
> 时间：2012-09-02T18:46:29.607
> 
> 标签：html, webmatrix-2

我正在做一个网站。我已经链接了徽标图像文件。当站点在默认页面（即主页）上运行时，徽标仅显示一次。当我切换到另一个页面时，徽标不会显示在任何页面上。我已经给出了正确的源路径，有人可以帮我解决这个问题吗？

```
<div id="header">
    <a href="Default.cshtml"><img src="Images/logo2.jpg" alt="Twenty47"   
       style="width:285px; height:250px; margin-top:5px; margin-left:5px;margin-bottom: 0px" /></a>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:01:18.503

不要忘记文件扩展名 .jpg 和 .jpeg 是不一样的。Webmatrix 要求您使用正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:09:07.483

我发表了评论：*您是否尝试过设置相对于根目录的路径？`src="/Images/logo2.jpg"`*. 似乎就是这样。

因此，如果有人遇到同样的问题并来到这里，解决方案是：

**在路径的开头添加`/`以使其相对于站点的根目录。**

# c# - 使用单独的类的 TPL Fire and Forget

> ID：12238765
> 
> 赞同：2
> 
> 时间：2012-09-02T18:46:29.793
> 
> 标签：c#, .net, task-parallel-library

我正在尝试使用 Task Parallel Library 来实现 fire and forget 功能。通过对 的内联调用`Task.Factory.StartNew`，一切都按预期工作。但是，我想将`Task.Factory.StartNew`调用移动到一个单独的类中，以便我可以添加日志记录、错误处理等，并可能在将来升级代码，因为将更好的线程类等添加到 .NET Framework 中，而无需复制代码。

下面是一个我希望通过的单元测试，但事实并非如此。我将不胜感激帮助试图弄清楚如何使这项工作。

```
[TestFixture]
public class ThreadingServiceFixture
{
    public static bool methodFired = false;

    [Test]
    public void CanFireAndForgetWithThreadingService()
    {
        try
        {
            var service = new ThreadingService();

            service.FireAndForget(() => methodFired = true);

            var endTime = DateTime.Now.AddSeconds(1);

            while(DateTime.Now < endTime)
            {
                //wait
            }

            Assert.IsTrue(methodFired == true);
        }
        finally
        {
            methodFired = false;
        }       
    }

}

public class ThreadingService
{
    public Task FireAndForget(Action action)
    {
        return Task.Factory.StartNew(() => action);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T18:56:19.250

你不是在执行这个动作，你只是在返回它。

尝试：

```
return Task.Factory.StartNew(() => action()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T18:57:50.063

如果是“一劳永逸”，则不需要`Task`从`FireAndForget`方法中返回，因为调用者可以得到它`Task`并取消它（严格来说，调用者会“记住”调用）。

如果您想从许多不从公共继承的服务中调用此方法，`ThreadingService`您可以通过接口实现扩展方法。

```
public interface IFireAndForget 
{
     // no member needed.
}

public static class FireAndForgetExtensions 
{
    public static void FireAndForget(this IFireAndForget obj, Action action) 
    {
         // pass the action, not a new lambda
         Task.Factory.StartNew(action);
    }
}

// using
public class ThreadingService : IFireAndForget 
{

} 
```

另请注意，在您的方法中，您必须将 传递`action`给`StartNew`insted 的方法，以传递返回`action`参数的 lambda。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-02T18:52:17.250

您没有在`ThreadingService`

代码应该类似于

```
public class ThreadingService
{
    public Task FireAndForget(Action action)
    {
        return Task.Factory.StartNew(() => action.Invoke());
    }
} 
```

附加说明：使用公共字段测试状态是邪恶的。考虑可重复性、维护、以不同的顺序运行测试。你应该`bool methodFired`在测试里面移动。我还假设有更好的技术来测试这个（但我不确定是哪一个）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T18:58:43.247

测试线程代码很困难。基于时间的测试是一个坏主意，它们可能会变得不确定，并且您可能会在构建服务器上观察到不稳定的行为。想象一个有时通过有时不通过的测试！

您的代码有一个错误，因为您实际上并没有调用该操作。

但考虑这种变化：

```
[Test]
[TimeOut(5000)]
public void CanFireAndForgetWithThreadingService()
{
   var service = new ThreadingService();
   ManualResetEvent mre = new ManualRestEvent(bool); // I never remember what is the default...

   service.FireAndForget(() => mre.Set() /*will release the test asynchroneously*/);
   mre.WaitOne(); // blocks, will timeout if FireAndForget does not fire the action.
} 
```

是的，我们仍在使用计时。但是只有在代码中断时才会发生测试超时！在所有其他情况下，测试是绝对可预测的，执行时间非常短，无需等待和祈祷时间问题不会发生；-)

# ms-word - WordML 语言自动检测

> ID：12238772
> 
> 赞同：0
> 
> 时间：2012-09-02T18:47:27.767
> 
> 标签：ms-word, wordml, wordprocessingml

我正在创建一个 wordml 文档，通常不是英文的。Word 将所有单词标记为拼写错误。我知道`<w:lang>`标签，但问题是我在创建时不懂语言。有没有办法指示 word 自动检测语言？或者至少可以防止拼写检查？或者也许是一种简单的方法来检测代码中的语言？
非常感谢，我真的很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T15:16:45.543

您应该能够通过添加到每次运行的运行参数来防止拼写检查（例如）

# eclipse - Ubuntu + Eclipse 4.2 - 深色主题 - 如何使侧边栏背景变暗？

> ID：12238773
> 
> 赞同：27
> 
> 时间：2012-09-02T18:47:30.537
> 
> 标签：eclipse, ubuntu, netbeans, gtk

由于在计算机屏幕前（工作、论文）花费 24/7 编程，因此尽可能多地查看深色是有益的。

Ubuntu 的 Ambiance 主题可以使用[Solancer 的定制](http://solancer.blogspot.co.uk/2012/04/dark-ambiance-theme-for-ubuntu-1204.html)来巧妙地增强，Eclipse Juno 在应用[Roger Dudler 的深色 Juno 主题](https://github.com/eclipse-color-theme/eclipse-ui-themes)后看起来基本一致。

但是，使用像 Dudler's 这样的深色 Juno 主题存在问题。`Package Explorer`中的（非）活动元素的背景颜色`Project Explorer`以及其他 Eclipse 视图显示的白/灰颜色不仅不一致，而且实际上掩盖了重要的显示组件，例如扩展箭头。

经过多次谷歌搜索，似乎这些颜色是从操作系统继承的，因此无法从 Eclipse 中更改`Preferences`。我希望深色 GTK 3 / Unity 主题（Solancer's Ambiance）能够提供必要的深色，但事实并非如此。

我已使用 sed 替换下*所有*文件中的*所有*预定义颜色，以确定那里定义的任何颜色是否会影响白色/灰色问题颜色；可悲的是他们没有。*`.css``/opt/eclipse/plugins/org.eclipse.platform_4.2.0.v*/css``#FF0000`*

 *在网上看到提到`~/.e4css`可能包含此类属性的覆盖 CSS 定义的文件夹后，我在本地计算机上寻找该文件夹，却发现它不存在。

SO上存在与此类似的问题，但没有一个明确指定如何“修复”这些颜色。

我的问题很简单：**是否可以定义一个 GTK+ 3.0 CSS 属性（组）来为 Eclipse 4.x 指定这些颜色，应该在哪里配置？**

![光——它燃烧！](../Images/9d8c1d6f608f237a7c4f44561d8c8043.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-02T19:05:59.483

终于通过自己手动搜索GTK配置文件找到了解决方案。

事实证明 Eclipse 使用 GTK+ 2.0 。

如果您在 Ubuntu 中安装自定义 GTK 主题（都与 Unity 兼容），您将把主题文件夹解压缩到`~/.themes`.

GTK+ 3.0 是通过 css 配置的，例如`~/.themes/YourTheme/gtk-3.0/gtk.css`

GTK+ 2.0 通过`rc`文件配置，例如`~/.themes/YourTheme/gtk-2.0/gtkrc`

由于许多应用程序是特定于 GTK+ 2.0 的，因此大多数 GTK+ 3.0 主题都包含这两个配置文件夹。

GTK+ 2.0`gtkrc`文件中的第一行包含基本的前景色和背景色；这些是必须改变的。

要在 Eclipse 视图中修改选定的活动元素背景颜色，您必须更改颜色`base_color`。要修改未选中元素的背景颜色，您必须更改`selected_bg_color`. 字体颜色使用等效`fg_color`属性进行更改（在这种情况下`base_color`是简单的`'fg_color'`）。

请记住，这将影响所有 GTK 应用程序，因此您可能需要根据个人喜好进行调整。另请注意，您必须重新加载活动的 GTK 主题并重新启动 Eclipse 才能看到更改生效。执行此操作的最快方法是`sudo apt-get install myunity`在颜色更改期间重新启动 Eclipse 时启动并保持打开状态，并在每次希望加载`gtkrc`更改时选择另一个主题，然后选择所需的主题。

`gtkrc`我活跃的 GTK 主题中的原始引导线如下：

```
gtk-color-scheme = "base_color:#ffffff\nfg_color:#4c4c4c\ntooltip_fg_color:#ffffff\nselected_bg_color:#f07746\nselected_fg_color:#FFFFFF\ntext_color:#3C3C3C\nbg_color:#F2F1F0\ntooltip_bg_color:#000000\nlink_color:#DD4814" 
```

经过大量实验后，我确定了这个替换配置：

```
gtk-color-scheme = "base_color:#555555\nfg_color:#000000\ntooltip_fg_color:#999999\nselected_bg_color:#666666\nselected_fg_color:#ffffff\ntext_color:#000000\nbg_color:#333333\ntooltip_bg_color:#000000\nlink_color:#DD4814" 
```

整个操作系统的变化非常令人愉悦！这是 Eclipse 现在的样子，这次没有模糊：

![甜蜜的黑暗之母](../Images/45271674240bc82be017038b1ead24c9.png)

希望你喜欢新的外观:)

PS 如您所料，Netbeans 的过程是等效的。

## 更新

这是补充信息，当使用自定义主题（例如 Dudler's）时，上述过程仍然正确。

经过进一步的实验，现在很清楚为什么编辑`/opt/eclipse/plugins/org.eclipse.platform_4.2.0.v*/css/*.css`没有任何效果：

假设您正在`e4_default_gtk.css`该位置进行编辑 - 该文件中更改样式的效果仅在您选择`GTK`.`Window -> Preferences -> Appearance -> [Theme]`

您可以将此下拉列表中列出的主题以及您的操作系统与上述文件系统位置中的 .css 文件的名称相关联。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-07T21:09:55.560

如果您不想更改整个桌面的外观，您可以通过在启动 Eclipse 的命令中设置 GTK2_RC_FILES 标志来为 Eclipse 启动一个单独的 GTK+ 主题。

例子：

```
GTK2_RC_FILES=/path/to/gtk/theme/gtkrc /opt/eclipse/eclipse 
```

这意味着您可以创建 GTK+ 主题的副本并针对 Eclipse 对其进行调整，而不会影响桌面的任何其他部分。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-22T16:23:35.890

你终于不需要改变你的 GTK 主题来拥有一个黑暗的包资源管理器或项目资源管理器等窗口。试试[这里](https://stackoverflow.com/a/15988908/2286117)发布的解决方案，对我来说，它在 Ubuntu 和 Windows 上都运行良好，无需更改系统主题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-10-09T08:39:30.633

即使在 2013 年，有些项目仍然不能“主题化”，不仅在 Eclipse IDE 中。与颜色硬编码器（通过常量而不是主题参数定义项目颜色的人）对抗的唯一方法是 Compiz 颜色过滤器。我开发了这样的过滤器，它在反转时保留颜色。**所以任何**软件都没有问题了。

不幸的是，据我所知，颜色过滤不适用于最新的 Ubuntu。

请在此处阅读更多信息[http://ubuntuforums.org/showthread.php?t=1419702&page=3](http://ubuntuforums.org/showthread.php?t=1419702&page=3)

```
!!ARBfp1.0
TEMP temp, neg, YPbPr;
TEX temp, fragment.texcoord[0], texture[0], RECT;
RCP neg.a, temp.a;
MAD temp.rgb, -neg.a, temp, 1.0;
MUL temp.rgb, temp.a, temp;
MUL temp, fragment.color, temp;
DP3 YPbPr.x, temp, {0.333, 0.333, 0.333, 1};
SUB YPbPr.y, YPbPr.x, temp.b;
SUB YPbPr.z, YPbPr.x, temp.r;
ADD temp.r, YPbPr.x, YPbPr.z; 
ADD temp.b, YPbPr.x, YPbPr.y;
SUB temp.g, YPbPr.x, YPbPr.z; 
SUB temp.g, temp.g, YPbPr.y;

MOV result.color, temp;
END

# DO NOT MOVE LINE #2 (TEMP...) below, i.e. do not insert comments before it!
# do not insert comments before 'END' token: SOMETIMES not work!

# replace file /usr/share/compiz/filters/negative with this file.

#  Color filter: negative, but preserve colours. Tested on Ubuntu LTS 10.04.

# compiled from [1], [2] by jopka@kvidex.ru, www.bdyssh.ru
# [1] http://hronir.blogspot.com/2008/09/compiz-fusion-color-filter-for-hue.html
# [2] http://ubuntuforums.org/showthread.php?t=1419702

# add to line 15:  MUL temp.b, 0.5, temp.b;  - for warm/melatonine colors, or 
#  MUL temp.g, 0.5, temp.g;  - for cold colors. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-03-07T11:18:06.063

对于 Eclipse 4.5： 1\. 创建一个类似于插入片段的文件 2\. 将其保存为“/usr/share/themes/..used theme../gtk-3.0/apps/eclipse.css” 3\. 包含它“/usr /share/themes/..使用的主题../gtk-3.0/gtk-main.css"

```
@define-color ecl_scrollbutton_color #7C7C7C;
@define-color ecl_scrollbutton_color_hover #FB7A00;

.scrollbar,
.scrollbar.vertical {
    -GtkScrollbar-has-backward-stepper: 0;
    -GtkScrollbar-has-forward-stepper: 0;
    -GtkRange-slider-width: 14;

    border-radius: 20px;

    border-image: none;
}

/*.scrollbar.trough,
.scrollbar.trough.vertical {
}
*/
.scrollbar.slider,
.scrollbar.slider.horizontal,
.scrollbar.slider.vertical,
.scrollbar.button,
.scrollbar.button.horizontal,
.scrollbar.button.vertical {
    border-width: 0.5px;
    border-style: solid;
    border-color: shade (@ecl_scrollbutton_color, 0.66);
    background-image: -gtk-gradient (linear, left top, right top,
                                     from (shade (@ecl_scrollbutton_color, 1)),
                                     color-stop (0.5, @ecl_scrollbutton_color),
                                     to (shade (@ecl_scrollbutton_color, 1)));
    box-shadow: inset 1px 0 shade (@bg_color, 1.1),
                inset -1px 0 shade (@bg_color, 1.01),
                inset 0 1px shade (@bg_color, 1.1),
                inset 0 -1px shade (@bg_color, 1.1);
}

.scrollbar.slider:hover,
.scrollbar.slider.vertical:hover,
.scrollbar.slider.horizontal:hover {
    background-image: -gtk-gradient (linear, left top, left bottom,
                                     from (shade (@ecl_scrollbutton_color_hover, 1)),
                                     color-stop (0.5, @ecl_scrollbutton_color_hover),
                                     to (shade (@ecl_scrollbutton_color_hover, 1)));
    box-shadow: inset 1px 0 shade (@bg_color, 1.1),
                inset -1px 0 shade (@bg_color, 1.1),
                inset 0 1px shade (@bg_color, 1.1),
                inset 0 -1px shade (@bg_colo
```*

# perl - 通过 Perl CPAN 模块的 Mechanical Turk CreateHIT 工作但未显示在 Amazon Mturk UI 中？

> ID：12238775
> 
> 赞同：2
> 
> 时间：2012-09-02T18:47:55.637
> 
> 标签：perl, api, mechanicalturk

我目前正在为 Mechanical Turk 测试 Perl CPAN 模块：

[https://metacpan.org/pod/Net::Amazon::MechanicalTurk](https://metacpan.org/pod/Net::Amazon::MechanicalTurk)

“GetAccountBalance”方法工作正常，但是，我在使用“CreateHIT”时遇到了问题。

该方法成功执行，但是，生成的 HIT 未显示在我的 Amazon Mturk Requester Web UI 中。

基于 CPAN 页面上示例的输出（无错误）：

```
Created HIT:
HITId:     2N6Q2SNQQ7Q68M3LN73NV12UAGJS8Z
HITTypeId: 2YBT2HVWAVKI7OL4NQS76Z99Q09FNV 
```

有没有其他人有这个问题？

Mturk Web UI 指的是“项目”和“批次”，所以也许我遗漏了什么？

谢谢，

琳达

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T00:21:04.747

单击“管理”选项卡后，尝试单击右上角附近的“单独管理 HIT”链接。您创建的点击可能隐藏在那里。

# javascript - simplecart：需要在结帐时传递另一个参数

> ID：12238786
> 
> 赞同：0
> 
> 时间：2012-09-02T18:49:41.387
> 
> 标签：javascript

我需要通过自定义表单上的结帐传递项目 ID。这是项目添加

```
<div class="simpleCart_shelfItem">
  <div class="ju_cntr" style="width:350px">
    <input type="hidden" class="item_id" name='tratata' value="asfd2">
    <div class="juice_hd item_name" style="width:350px">
       test2
    </div>
    <div class="juice_pic" style="width:350px">
      <img class="item_thumb item_image item_add" src="/images/upload/9174.jpg"/>
    </div>
    <div class="juice_txt">
      <span class="item_price">$123.00</span><input type="text" value="1" class="item_Quantity"><a class="item_add" href="javascript:;"> Add to Cart </a>
    </div>
  </div>
</div> 
```

和结帐结果

```
Array
(
    [currency] => USD
    [shipping] => 0
    [tax] => 0
    [taxRate] => 0
    [itemCount] => 2
    [item_name_1] => 
                                            123                                     
    [item_quantity_1] => 7
    [item_price_1] => 123
    [item_options_1] => 
    [item_name_2] => 
                                            test2                                       
    [item_quantity_2] => 6
    [item_price_2] => 123
    [item_options_2] => 
) 
```

有人知道我该怎么做吗？谢谢！

这是文档[http://simplecartjs.org/documentation/](http://simplecartjs.org/documentation/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T20:29:10.147

实际上，附加项目数据是在 item_options_n 元素内传递的。

所以在你的情况下应该是：

```
[item_name_1] => 
                                        123                                     
[item_quantity_1] => 7
[item_price_1] => 123
[item_options_1] => 
[item_name_2] => id: <your_id_here>
                                        test2                                       
[item_quantity_2] => 6
[item_price_2] => 123
[item_options_2] => id: <your_id_here> 
```

如果没有，可能是它没有从表单元素中获取值。在这种情况下，您将不得不手动获取它们。

# algorithm - 给定一个对象 A 和一个对象列表 L，如何在不测试所有情况的情况下找出 L 上的哪些对象是 A 的克隆？

> ID：12238788
> 
> 赞同：1
> 
> 时间：2012-09-02T18:49:46.923
> 
> 标签：algorithm, data-structures, hash, functional-programming, pattern-matching

使用 JavaScript 表示法：

```
A = {color:'red',size:8,type:'circle'};

L = [{color:'gray',size:15,type:'square'},
     {color:'pink',size:4,type:'triangle'},
     {color:'red',size:8,type:'circle'},
     {color:'red',size:12,type:'circle'},
     {color:'blue',size:10,type:'rectangle'}]; 
```

这种情况的答案是 2，因为 L[2] 与 A 相同。您可以通过测试每种可能性在 O(n) 中找到答案。什么是可以更快地找到答案的表示/算法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:00:52.800

我只需创建一个 HashMap 并将所有对象放入 HashMap 中。我们还需要定义一个哈希函数，它是对象中数据的函数（类似于在 java 中覆盖 Object.hashcode()）

假设给定数组 L 是 [B, C, D]，其中 B、C 和 D 是对象。那么 HashMap 将是 {B=>1, C=>2, D=>3}。现在假设 D 是 A 的副本。所以我们只需在这张地图中查找 A 并得到答案。同样正如 Eric P 在评论中所建议的那样，我们需要根据数组 L 中的任何更改保持哈希图的更新。这也可以在 O(1) 中对数组 L 中的每个操作完成。

在 HashMap 中查找对象的成本是 O(1)。所以我们可以实现 O(1) 复杂度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T18:58:28.110

我认为不可能比`O(n)`您的先决条件更快地做到这一点。使用二分搜索可以找到元素`O(logn)`，但是：

*   A）您需要具有一个变量的元素进行比较
*   B）按该变量排序的列表

也许通过一些技术（排序、跳过列表等），您可以比 N 次迭代更快地找到答案，但最坏的情况是`O(n)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T19:14:45.397

由于目标是找到所有对象是 A 的克隆，因此您必须对每个对象至少测试一次以确定它是否是 A 的克隆，因此最小测试次数为 N。通过列表一次并测试每个对象执行 N 次测试，因此由于该方法是最少的测试次数，因此它是一种最优方法。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-02T21:14:13.733

首先，我假设您在谈论数组，而不是列表。“list”这个词是为特定类型的数据结构保留的，它具有 O(n) 索引复杂性，因此同时在其中的任何搜索至少是线性的。

对于未排序的数组，唯一的算法是线性时间的全扫描。但是，如果数组已排序，则可以使用二进制或插值搜索来获得更好的时间。

排序数组的问题在于它们具有线性插入时间。不好。因此，如果您希望更新您的集合并且更新和搜索时间都很重要，您应该搜索优化的容器，在 c++ 和 haskell 中调用`Set`（分别在头文件中的`set`模板和包中的模块）。我不知道JS中有没有。`set``Data.Set``containers`

# ruby-on-rails-3 - Rails Active Admin：为什么我的自定义表单没有呈现任何输入？

> ID：12238789
> 
> 赞同：0
> 
> 时间：2012-09-02T18:50:01.573
> 
> 标签：ruby-on-rails-3, activeadmin, formtastic

**Rails 3.1.1
活动管理员 0.4.4
格式 2.1.1**

**这是我`Agency`模型的活动管理控制器。**

```
ActiveAdmin.register Agency do
  form do |f|
    f.input :name
    f.input :contact_email, :label=>"Email invoices to"
    f.input :api_key, :hint=>"Create a key by following <a href=\"#\" target=\"_blank\">these instructions</a>".html_safe
    f.actions
  end
end 
```

**表单应该呈现三个输入，然后是提交按钮，但我得到的只是：**

![没有输入](../Images/7feb70ae331b048cfdbca9fe9a920473.png)

**为了清楚起见，HTML 没有显示缺少输入的迹象：**

```
<form accept-charset="UTF-8" action="/admin/agencies" class="formtastic agency" id="agency_new" method="post" novalidate="novalidate" name="agency_new">
  <div style="margin:0;padding:0;display:inline">
    <input name="utf8" type="hidden" value="✓"><input name="authenticity_token" type="hidden" value="...">
  </div>
  <fieldset class="actions">
    <ol>
      <li class="action input_action" id="agency_submit_action">
        <input name="commit" type="submit" value="Create Agency">
      </li>
    </ol>
  </fieldset>
</form> 
```

**我还尝试使用具有相同（错误）输出的字段集：**

```
ActiveAdmin.register Agency do
  form do |f|
    f.inputs "New Agency" do 
      f.input :name
      f.input :contact_email, :label=>"Email invoices to"
      f.input :api_key, :hint=>"Create a key by following <a href=\"#\" target=\"_blank\">these instructions</a>".html_safe
    end
    f.actions
  end
end 
```

**更新：我发现注释掉该`f.actions`行会很容易打印输入，但现在只是没有按钮。**

```
ActiveAdmin.register Agency do
  form do |f|
    f.inputs "New Agecny" do 
      f.input :name
      f.input :contact_email, :label=>"Email invoices to"
      f.input :api_key, :hint=>"Create a key by following <a href=\"#\" target=\"_blank\">these instructions</a>".html_safe
    end

    #f.actions
  end
end 
```

有输入但没有按钮的表单：

![没有按钮](../Images/3f3da56bfb98c54c8d47d988f1907ad4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:07:28.380

`f.buttons`应该使用，而不是`f.actions`.

`f.buttons`, 打印按钮。`f.actions`需要一个用于格式化按钮的块，类似于`f.inputs`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T14:04:29.627

你是正确的：将你的输入包装在一个 f.inputs 块中。

取消注释块外的“f.actions”行。

你应该被设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-04T14:12:58.973

尝试使用这个： f.input :type => :submit 。这对我有用

```
form do |f| 
  f.input :starts_at
  f.input :ends_at
  f.input :type => :submit
end 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-02T19:06:43.087

尝试使用这个：`f.buttons :submit`

我还认为按钮/操作块在某个时候在活动管理员版本中发生了一些变化，因此您可能会被旧教程等绊倒。

# c - Linux Ubuntu 如何获取远程主机名

> ID：12238792
> 
> 赞同：-1
> 
> 时间：2012-09-02T18:50:23.363
> 
> 标签：c, linux, python-3.x, python-2.7

您如何获得与我连接到同一网络的主机名。示例我在 192.168.1.16 其他在 192.168.1.15

我如何使用 python 或任何有用的命令知道他的主机名？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:53:29.433

您可以尝试：

`nslookup IP_ADDRESS`

它应该向您显示一个`name`包含主机名的字段。

还有一个特定的命令，但我不知道它是否包含在每个发行版中：

`resolveip IP_ADDRESS`

试试看。它还有一个`-s`选项，只为您提供主机名，仅在您需要检索它并将其存储在变量中时非常有用。

`resolveip -s IP_ADDRESS`

# sql - 错误：无法将数据库附加到 SQL Server 2012

> ID：12238796
> 
> 赞同：0
> 
> 时间：2012-09-02T18:51:07.647
> 
> 标签：sql, database, sql-server-2012

我有 SQL Server 2012，我正在尝试附加一个以前与 SQL Server 2012 一起使用的数据库，令人惊讶的是，我收到了以下错误：

> 无法打开数据库“DatabaseName”，因为它是版本 706。此服务器支持版本 622 和更早版本。不支持降级路径。

我真的不明白这是怎么发生的，因为就像我说它与相同的 2012 版本一起使用。我究竟做错了什么？我怎样才能让它工作？请详细说明如何解决此问题。

谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T18:55:25.913

该错误听起来像是您尝试将数据库附加到的服务器不是 SQL Server 2012。这可能是您正在使用的 Management Studio / Management Studio Express 的版本，但我怀疑`SELECT @@VERSION;`会告诉您一些不同的东西。如果您安装了多个 SQL Server 实例，则可能只是连接字符串混淆，否则您应该[从此处下载并安装 SQL Server 2012 Express](http://www.microsoft.com/en-us/download/details.aspx?id=29062)。

[@来源](https://stackoverflow.com/questions/11569882/cant-attach-the-sample-database-in-sql-server-2012)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T23:20:25.973

听起来您有以下配置和源数据库：

1.  SQL Server 2008 SP3 (ver 10.0...) - 数据库引擎
2.  SQL Server Management Studio 2012 (ver 11.0...) - 管理工具
3.  使用 SQL Server 2012（版本 706）创建的数据库

如前所述，您可以为 SQL Server 2008 安装 SSMS（在您为 SQL Server 2012 卸载 SSMS 之后）。然后，您必须为该版本编写数据库脚本并通过“任务>脚本...”重新运行脚本，记住设置目标服务器版本，如下所示。

![服务器版本选项的脚本](../Images/16c2a619152ff796390082b3c806f81e.png)

编写脚本后，您可以使用导入/导出向导导出数据，然后将数据导入新的（降级数据库），假设数据库没有 2012-only 数据类型（例如序列）。

另一个考虑因素是数据库兼容性级别，如下所示。您可以拥有一个承载具有各种兼容性级别的数据库的 SQL Server 2012 实例。

![数据库兼容级别](../Images/937bbccf058e0867457bed1f40dd5bd3.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-02T03:51:22.810

使用`SELECT @@VERSION`对我来说效果很好。您的数据库引擎连接到一个 2008 数据库，它当然不允许您附加。一旦我将数据库引擎更改为连接到 2012 数据库，它就对我有用。

检查您的数据库引擎连接。您可以在 2012 Management Studio 上工作但连接到 2008 DB。这就是发生在我身上的事情，我已经使用 SELECT @@VERSION 解决了​​它。

# java - Google App Engine (GAE) Java 服务器如何检查它是否为后端？

> ID：12238797
> 
> 赞同：2
> 
> 时间：2012-09-02T18:51:08.687
> 
> 标签：java, google-app-engine, backend

我希望服务器知道它是否是后端，或者不是最好已经在

```
contextInitialized(final ServletContextEvent event) 
```

（但在第一个 HTTP 请求到达时不太好）。

我试过了

```
BackendServiceFactory.getBackendService().getCurrentBackend() 
```

但它总是返回 null （至少在 Google Eclipse 插件中是本地的），即使它是后端，甚至在传入的 http 请求的上下文中！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:50:00.243

更新。

```
 BackendServiceFactory.getBackendService().getCurrentBackend() 
```

确实适用于产品，但不适用于 Eclipse 插件。仍然想要一个适用于两者的版本。也许这只是一个错误：

[http://code.google.com/p/googleappengine/issues/detail?id=8058&thanks=8058&ts=1346615492](http://code.google.com/p/googleappengine/issues/detail?id=8058&thanks=8058&ts=1346615492)

# dart - Dart #import from other drive:“不允许加载本地资源”

> ID：12238801
> 
> 赞同：2
> 
> 时间：2012-09-02T18:51:48.097
> 
> 标签：dart, dartium

我在另一个驱动器上有一个库（在 m: 上工作并引用 c:)。在 Chromium 中运行我的飞镖程序时，我不断收到“不允许加载本地资源...”

开发时是否有避免该错误的最佳实践？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T09:27:13.033

我将所有内容、库和项目源都移到了一个地方以避免该错误。

# java - 向量 C++，列表 ＆矢量 爪哇

> ID：12238802
> 
> 赞同：0
> 
> 时间：2012-09-02T18:52:06.207
> 
> 标签：java, list, vector

我在大学学习了这段代码，同时学习 C++ .. 后来我在 C# 中使用了同样的东西......但现在我想在 Java 中使用它......我在互联网上到处寻找类似的东西，但我甚至不知道如何表达它，所以我得到了正确的结果。

所以嗯，请让我知道如何在 JAVA 中执行此操作，并让我知道这种方式叫什么？？？我知道它的作用..但我不知道它是怎么做的..所以请注意解释一下...

C++ 和下面是一样的，除了看下面的一个不同之处

```
C# if (Customers[i].delExecute(delIn) == true)

C++ if (Customers[i]->delExecute(delIn) == true)

Java ?? if (????????????????????????????????) 
```

所以在这里我生病尽力解释。C＃

```
Class called Customer with custId etc etc

List<Customer> Customers = new List<Customers>

    public void delCust(int delIn)
    {
        for (int i = 0; i < Customers.Count(); i++)
        {
            if (Customers[i].delExecute(delIn) == true)
            {
                Customers.Remove(Customers[i]);
                break;
            }
        }
    }

bool delExecute(int delInput) {
    if (custId == delInput) {
        return true;
    }
    return false;
} 
```

好的，所以上面的代码有效

现在我想用 JAVA 做同样的事情......有人有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T18:53:22.293

```
if (Customers.get(i).delExecute(delIn)) 
```

BTW，没必要`== true`明确说

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-02T19:03:42.913

在 Java 中，`Vector`是一个过时的类，您可能应该避免使用它。相反，您应该使用[`ArrayList`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html). 但是，无论哪种方式，两者都是[`List`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html)s，因此实现[`get`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#get%28int%29)了*random-access*。

您可以按如下方式实现您正在尝试的内容......

```
if (customers.get(i).delExecute(delIn)) 
```

请注意，这`== true`是多余的，因为它实际上是一个身份（`true == true`is `true`，`false == true`is `false`）。您还应该避免在 Java 中使用大写的字段名称。

现在，还有一种*首选*方法可以使用`Iterator`.

```
private List<Customer> customers = new ArrayList<Customers>();

public void delCust(int delIn) {
  final Iterator<Customer> cursor = customers.iterator();
  while (cursor.hasNext()) {
    if (cursor.next().delExecute(delIn)) {
      cursor.remove();
      break;
    }
  }
} 
```

...加上：

```
boolean delExecute(int delInput) {
  return custId == delInput;
} 
```

# php - array_walk_recursive，在 PHP 中使用外部变量的函数

> ID：12238803
> 
> 赞同：6
> 
> 时间：2012-09-02T18:52:13.883
> 
> 标签：php

```
 $total_materials_cost = 0;
   array_walk_recursive($materials, function($item, $key) {
        if (in_array($key, array('id'))) {

                    (....)

                    $total = $material_price * $material['amount'];

                    $total_materials_cost += $total;
                }
            }
        }
    });
echo $total_materials_cost; 
```

对于上面的代码，我在 line 处收到错误`$total_materials_cost += $total;`，说变量未定义 - 我相信这是因为我在函数内部？但是我怎么能以任何方式绕过/解决这个问题，所以它确实添加到变量中？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-02T18:53:14.663

使用`use`关键字：

```
$total_materials_cost = 0;
array_walk_recursive($materials, function($item, $key) use(&$total_materials_cost) {
  if (in_array($key, array('id'))) {
    // (....)
    $total = $material_price * $material['amount'];
    $total_materials_cost += $total;
  }
});
echo $total_materials_cost; 
```

传递引用 ( `&`) 以更改闭包外的变量。

# javascript - jquery在点击事件上运行插件

> ID：12238808
> 
> 赞同：0
> 
> 时间：2012-09-02T18:52:38.360
> 
> 标签：javascript, jquery, events, image-manipulation

我正在使用[**这个插件**](http://alexmic.github.com/filtrr/)来处理我正在处理的网站上的一些图像。

应该发生的是，当页面加载时，用户会看到 5 个过滤器示例图像，他们可以将其应用于显示图片。
当他们决定他们想要什么效果时，他们点击示例并将其应用于更大的图像。

我的问题是我无法让它工作，因此用户可以单击另一个示例并将其应用于大图像。

我已经修改了所有代码供您查看，最终结果是我需要用户能够单击每个缩略图并在更大的图像上看到这种效果。小提琴目前是暂时的，但代码显示了我正在尝试做的事情。

[http://jsfiddle.net/q7Pq7/1/](http://jsfiddle.net/q7Pq7/1/)

# c# - 在 c# 中为 windows phone 7 应用程序将字符串转换为图像

> ID：12238810
> 
> 赞同：3
> 
> 时间：2012-09-02T18:53:01.760
> 
> 标签：c#, windows-phone-7.1

我想将用户输入的字符串转换为图像..怎么做？我尝试了以下代码，但我在该行中得到一个参数异常：WriteableBitmap wbimg = PictureDecoder.DecodeJpeg(memStream);

```
 static public string EncodeTo64(string toEncode)
    {
        byte[] toEncodeAsBytes
              = StringToAscii(toEncode);
        string returnValue
              = System.Convert.ToBase64String(toEncodeAsBytes);
        return returnValue;
    }

    public static byte[] StringToAscii(string s)
    {
        byte[] retval = new byte[s.Length];
        for (int ix = 0; ix < s.Length; ++ix)
        {
            char ch = s[ix];

            if (ch <= 0x7f)  retval[ix] = (byte)ch; 
            else  retval[ix] = (byte)'?'; 
        }

        return retval;
    }
    void convert()
    {
        String s = textBox1.Text;
        byte[] data = Convert.FromBase64String(EncodeTo64(s));

        for (int i = 0; i < data.Length; i++)
        {
            System.Diagnostics.Debug.WriteLine(data[i]);
        }
        Stream memStream = new MemoryStream();
        memStream.Write(data, 0, data.Length);

        try
        {
        WriteableBitmap wbimg = PictureDecoder.DecodeJpeg(memStream);

        image1.Source = wbimg;
        }
        catch (Exception e)
        {
            MessageBox.Show(e.ToString());

        }

    } 
```

我在以下链接中得到了我想要的东西。[在 Windows Phone 7 中，如何在后台线程上的 WriteableBitmap 上呈现文本？](https://stackoverflow.com/questions/5666772/how-can-i-render-text-on-a-writeablebitmap-on-a-background-thread-in-windows-ph)和[http://blogs.u2u.be/michael/post/2011/04/20/Adding-a-text-to-an-image-in-WP7.aspx](http://blogs.u2u.be/michael/post/2011/04/20/Adding-a-text-to-an-image-in-WP7.aspx)感谢所有回复最初帮助的人！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T06:04:51.723

这是您可以将**TextBlock 文本转换为图像的简单方法**

```
 private void convert_Click(object sender, RoutedEventArgs e)
    {
        Canvas c1 = new Canvas();
        TextBlock t = new TextBlock();
        t.Text = text1.Text;
        t.FontFamily = text1.FontFamily;
        t.Foreground = text1.Foreground;
        t.FontSize = text1.FontSize;
        c1.Children.Add(t);
        WriteableBitmap wbmp = new WriteableBitmap(c1, null);
        im = new Image();
        im.Source = wbmp;
        im.Height = 200;
        im.Width = 200;     
        Canvas.SetTop(im, 10);
        Canvas.SetLeft(im, 10);

        Main_Canvas.Children.Add(im);
    } 
```

这里我将 Textblock Text 转换为 Bitmap，然后将其分配给图像源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-03T08:09:25.707

以下是如何将字符串写入位图：

```
 Bitmap b = new Bitmap(200, 100);
        Graphics g = Graphics.FromImage(b);
        g.DrawString("My sample string", new Font("Tahoma",10), Brushes.Red, new Point(0, 0));
        b.Save("mypic.png", System.Drawing.Imaging.ImageFormat.Png);
        g.Dispose();
        b.Dispose(); 
```

如果您需要解释任何细节，Shubhi1910 让我知道。

# jquery - 如何防止鼠标快速移动发生多个事件？

> ID：12238813
> 
> 赞同：2
> 
> 时间：2012-09-02T18:53:16.087
> 
> 标签：jquery

当鼠标打开和鼠标离开元素时，我正在使用此代码在两个图像之间淡入淡出。当鼠标移动太快时，这会产生一些不适当的过渡。如何防止这种情况？

我的代码：

```
$('.prods li').live('mouseenter',function() {
    $(this).children('.label').stop().animate({top: '80%',opacity: 1}, 800, 'easeOutQuint');
    if ($(this).children('.producthover').length) {
        $(this).children('.product').fadeOut(800);
        $(this).children('.producthover').fadeIn(800);
    }
}).live('mouseleave',function() {
    $(this).children('.label').stop().animate({top: '50%',opacity: 0}, 800, 'easeOutQuint');
    if ($(this).children('.producthover').length) {
        $(this).children('.product').fadeIn(800);
        $(this).children('.producthover').fadeOut(800);
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:28:49.580

您是否尝试过更改`.stop()`为`.stop(true,true)`?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:19:44.103

您可以检查意图。

基本上你需要延迟动画的执行，以确保在最短的时间内没有发生另一个动作。

```
var mouseEnterTimer = null;

$('.prods').on('mouseenter', 'li',  function(){

   /*clear timer since another mouseenter has occured within 200 ms */
   clearTimeout(mouseEnterTimer); 

   /*now queue up another one to execute 200 ms later*/
   mouseEnterTimer = setTimeout)function(){
      //all your animation logic here

   }, 200); 
}); 
```

这确保了即使鼠标快速移入和移出相关区域，事件也**只触发一次。**

* * *

您可能想进一步了解[去抖动事件](http://unscriptable.com/2009/03/20/debouncing-javascript-methods/)。（以及它们[与节流有何不同](http://benalman.com/projects/jquery-throttle-debounce-plugin/)）

此外，已经有一个出色的[hoverIntent 插件](http://cherne.net/brian/resources/jquery.hoverIntent.html)（等等）。

# java - 设置多方向 - Android

> ID：12238817
> 
> 赞同：6
> 
> 时间：2012-09-02T18:53:39.857
> 
> 标签：java, android, android-layout, android-orientation

我是 android 编程新手，但我遇到了方向问题。

我希望我的活动只能在纵向和反向纵向和方向中查看。

我以为`android:screenOrientation="portrait|reversePortrait"` 会起作用，但它不起作用。有没有办法在清单文件中做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-02T19:06:05.657

请查看文档：http: [//developer.android.com/guide/topics/manifest/activity-element.html#screen](http://developer.android.com/guide/topics/manifest/activity-element.html#screen)

在 API 9+ 中添加了纵向，但可以是基于设备传感器的正常或反向纵向。所以你可以`android:screenOrientation="sensorPortrait"`同时使用。

# php - 如何正确索引以下内容？

> ID：12238819
> 
> 赞同：5
> 
> 时间：2012-09-02T18:53:51.373
> 
> 标签：php, mysql, indexing

我有下表 ( `file_category_tbl`) 来表示文件和类别之间的连接。

```
fileId - bigint(20)         
categoryId - bigint(20)
order - int(10) 
```

为了可以对类别中的文件进行排序，我有一个 order 字段......因此我的问题是我需要哪些索引才能在以下方面获得最佳性能：

```
SELECT * FROM file_category_tbl WHERE categoryId="3" ORDER BY order ASC 
```

我有一个唯一索引 UNIQUE ( `fileId`, `categoryId`); 因为不能有相同`fileId`的相同`categoryId`。我也有一个索引`categoryId`，因为这是正在搜索的内容。我也有一个索引`order`？...但这有必要吗？因为它只是在做`orderBy`这个......

向任何响应者致以亲切的问候... J

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:11:41.983

如[`ORDER BY`优化](https://dev.mysql.com/doc/en/order-by-optimization.html)中所述：

> 在某些情况下，MySQL*不能*使用索引来解析**`ORDER BY`**，尽管它仍然使用索引来查找与**`WHERE`**子句匹配的行。这些案例包括：
> 
> `[ deletia ]`
> 
> *   用于获取行的键与以下中使用的键不同**`ORDER BY`**：
>     
>     
>     
>     ```
>     SELECT * FROM t1 WHERE *key2* =*常量*ORDER BY *key1*；
>     ```

因此，您当前的索引不能用于执行排序操作。但是，同一页面还记录了：

> 即使**`ORDER BY`**索引不完全匹配索引，也可以使用索引，只要索引的所有未使用部分和所有额外**`ORDER BY`**列都是**`WHERE`**子句中的常量。以下查询使用索引来解析**`ORDER BY`**部件：
> 
> `[ deletia ]`
> 
> ```
> 选择 * 从 t1
>   WHERE *key_part1* =*常量*
>   ORDER BY *key_part2*；
> ```

因此，复合索引`(categoryId,order)`可用于*过滤*和*排序*操作，这是此查询的最佳结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:08:05.417

据我了解，您的索引是明智的，将有助于提高查询的性能。但我也建议你`Primary Key`在你的表中有一个索引，而不是只有组合`Unique Index`

我这么说的原因是，如果您想引用此表的任何记录，可能是删除它或执行任何其他功能，主键会很有用。另一方面，它实际上可能会降低查询的性能，因为您需要所有字段，而现在使用主键字段，您必须引入 4 个字段。作为解决方案，您可以指定结果中所需的列。

希望这是有道理的:-)

# javascript - 这个正则表达式的日期/时间有什么问题

> ID：12238820
> 
> 赞同：-2
> 
> 时间：2012-09-02T18:53:56.970
> 
> 标签：javascript, jquery, regex

我在[http://regexlib.com/REDetails.aspx?regexp_id=233](http://regexlib.com/REDetails.aspx?regexp_id=233)找到了一个很好的正则表达式。为了便于参考，它是

```
^([0]\d|[1][0-2])\/([0-2]\d|[3][0-1])\/([2][01]|[1][6-9])\d{2}(\s([0]\d|[1][0-2])(\:[0-5]\d){1,2})*\s*([aApP][mM]{0,2})?$ 
```

我对正则表达式一无所知，所以我根本不知道如何调试它。我从这个 jQuery 插件[http://trentrichardson.com/examples/timepicker/](http://trentrichardson.com/examples/timepicker/)得到一个日期/时间字符串，格式如下：

```
"09/02/2012 14:51" //Fail 
```

然而，上面是一个失败的字符串的例子，虽然它对我来说似乎很好。当我得到当前时间时，它通过了：

```
"12/22/2012 00:01" //Pass 
```

任何人都可以看到这个正则表达式的问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T18:59:52.580

该正则表达式仅接受 am/pm 格式的小时数，从`0`to `12`：

```
((\s([0]\d|[1][0-2])(\:[0-5]\d){1,2})*\s*([aApP][mM]{0,2})?)
     ^-------------
     This block represents the hours, and its range is 0-12 
```

要考虑一天中的小时，从 0 到 23，请将以下内容添加到小时部分：

`(0\d|1[0-9]|2[0-3])`

产生最终的正则表达式：

```
/^([0]\d|[1][0-2])\/([0-2]\d|[3][0-1])\/([2][01]|[1][6-9])\d{2}(\s(([0]\d|[1][0-2])|(0\d|1[0-9]|2[0-3]))(\:[0-5]\d){1,2})*\s*([aApP][mM]{0,2})?$ 
```

# java - 如何创建平铺地图（我只是得到一个白屏）

> ID：12238822
> 
> 赞同：5
> 
> 时间：2012-09-02T18:54:13.947
> 
> 标签：java, image, swing, awt, tiled

我需要一些帮助来制作平铺地图，我只是得到一个白屏而不是带有图像（平铺）的地图。有人可以帮忙吗？

**`World.java`：**

```
 package game.test.src;

   import java.awt.Graphics;
   import java.awt.Image;
   import java.awt.Rectangle;

   import javax.swing.ImageIcon;

    public class World {

private Rectangle[] blocks;
private Image[] blockImg;
private final int arrayNum = 500;

//Block Images
private Image BLOCK_GRASS, BLOCK_DIRT, BLOCK_STONE, BLOCK_SKY;

private int x, y;

public World(){
    BLOCK_GRASS = new ImageIcon("C:/Users/Pim/Desktop/2D game test/Game test 2/src/game/test/src/images/tile_grass").getImage();
    BLOCK_DIRT = new ImageIcon("C:/Users/Pim/Desktop/2D game test/Game test 2/src/game/test/src/images/tile_dirt").getImage();
    BLOCK_STONE = new ImageIcon("C:/Users/Pim/Desktop/2D game test/Game test 2/src/game/test/src/images/tile_stonek").getImage();
    BLOCK_SKY = new ImageIcon("C:/Users/Pim/Desktop/2D game test/Game test 2/src/game/test/src/images/tile_sky").getImage();
    blocks = new Rectangle[500];
    blockImg = new Image[500];

    loadArrays();
}

private void loadArrays()
{
    for(int i = 0; i < arrayNum; i++)
    {
        if(x >= 500){
            x = 0;
            y += 20;
        }
        if(i >= 0 && i < 100)
        {
            blockImg[i] = BLOCK_SKY;
            blocks[i] = new Rectangle(x, y, 20, 20);
        }
        if(i >= 100 && i < 125)
        {
            blockImg[i] = BLOCK_GRASS;
            blocks[i] = new Rectangle(x, y, 20, 20);
        }
        if(i >= 125 && i < 225)
        {
            blockImg[i] = BLOCK_DIRT;
            blocks[i] = new Rectangle(x, y, 20, 20);
        }
        if(i >= 225 && i < 500)
        {
            blockImg[i] = BLOCK_STONE;
            blocks[i] = new Rectangle(x, y, 20, 20);
        }
        x += 20;

    }

}

public void draw(Graphics g)
{
    for(int i = 0; i< arrayNum; i++){
        g.drawImage(blockImg[i], blocks[i].x, blocks[i].y, null);
    }
}   
} 
```

**这是`GamePanel.java`：**

```
 package game.test.src;

import java.awt.*;
import java.awt.event.*;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JPanel;

public class GamePanel extends JPanel implements Runnable {
    //Double buffering
    private Image dbImage;
    private Graphics dbg;
    //JPanel variables
    static final int GWIDTH = 500, GHEIGHT = 400;
    static final Dimension gameDim = new Dimension(GWIDTH, GHEIGHT);
    //Game variables
    private Thread game;
    private volatile boolean running = false;
    //Game Objects
    World world;

    public GamePanel(){
        world = new World();

        setPreferredSize(gameDim);
        setBackground(Color.WHITE);
        setFocusable(true);
        requestFocus();
        //Handle all key inputs from user
        addKeyListener(new KeyAdapter(){
            @Override
            public void keyPressed(KeyEvent e){

            }
            @Override
            public void keyReleased(KeyEvent e){

            }
            @Override
            public void keyTyped(KeyEvent e){

            }
        });

    }

    public void run(){
        while(running){
            gameUpdate();
            gameRender();
            paintScreen();

        }
    }

    private void gameUpdate(){
        if(running && game != null){

        }
    }

    private void gameRender(){
        if(dbImage == null){ // Create the buffer
            dbImage = createImage(GWIDTH, GHEIGHT);
            if(dbImage == null){
                System.err.println("dbImage is still null!");
                return;
            }else{
                dbg = dbImage.getGraphics();
            }
        }
        //Clear the screen
        dbg.setColor(Color.WHITE);
        dbg.fillRect(0, 0, GWIDTH, GHEIGHT);
        //Draw Game elements
        draw(dbg);
    }

    /* Draw all game content in this method */
    public void draw(Graphics g){
        world.draw(g);
    }

    private void paintScreen(){
        Graphics g;
        try{
            g = this.getGraphics();
            if(dbImage != null && g != null){
                g.drawImage(dbImage, 0, 0, null);
            }
            Toolkit.getDefaultToolkit().sync(); //For some operating systems
            g.dispose();
        }catch(Exception e){
            System.err.println(e);
        }
    }

    public void addNotify(){
        super.addNotify();
        startGame();
    }

    private void startGame(){
        if(game == null || !running){
            game = new Thread(this);
            game.start();
            running = true;
        }
    }

    public void stopGame(){
        if(running){
            running = false;
        }
    }
    } 
```

**和`Main.java`：**

```
package game.test.src;

import javax.swing.JFrame;

public class Main extends JFrame
{
    GamePanel gp;

    public Main()
    {
        gp = new GamePanel();
        setSize(500, 400);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setVisible(true);
        setResizable(false);
        add(gp);
    }

    public static void main(String[] args)
    {
        Main m = new Main();
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-02T19:48:49.650

我稍微修改了你的代码，试试

```
import java.awt.*;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;

import javax.swing.*;

public class World {

  private Rectangle[] blocks;
  private Image[] blockImg;
  private final int arrayNum = 500;

  //Block Images
  private Image BLOCK_GRASS, BLOCK_DIRT, BLOCK_STONE, BLOCK_SKY;

  private int x, y;

  public World(){
    BLOCK_GRASS = new ImageIcon(Frame1.class.getResource("images/openFile.gif")).getImage();
    BLOCK_DIRT = new ImageIcon(Frame1.class.getResource("images/openFile.gif")).getImage();
    BLOCK_STONE = new ImageIcon(Frame1.class.getResource("images/openFile.gif")).getImage();
    BLOCK_SKY = new ImageIcon(Frame1.class.getResource("images/openFile.gif")).getImage();
    blocks = new Rectangle[500];
    blockImg = new Image[500];

    loadArrays();
  }

  private void loadArrays()
  {
    for(int i = 0; i < arrayNum; i++)
    {
      if(x >= 500){
        x = 0;
        y += 20;
      }
      if(i >= 0 && i < 100)
      {
        blockImg[i] = BLOCK_SKY;
        blocks[i] = new Rectangle(x, y, 20, 20);
      }
      if(i >= 100 && i < 125)
      {
        blockImg[i] = BLOCK_GRASS;
        blocks[i] = new Rectangle(x, y, 20, 20);
      }
      if(i >= 125 && i < 225)
      {
        blockImg[i] = BLOCK_DIRT;
        blocks[i] = new Rectangle(x, y, 20, 20);
      }
      if(i >= 225 && i < 500)
      {
        blockImg[i] = BLOCK_STONE;
        blocks[i] = new Rectangle(x, y, 20, 20);
      }
      x += 20;

    }

  }

  public void draw(Graphics g)
  {
    for(int i = 0; i< arrayNum; i++){
      g.drawImage(blockImg[i], blocks[i].x, blocks[i].y, null);
    }
  }
}

class GamePanel extends JPanel implements Runnable {
  //Double buffering
  private Image dbImage;
  private Graphics dbg;
  //JPanel variables
  static final int GWIDTH = 500, GHEIGHT = 400;
  static final Dimension gameDim = new Dimension(GWIDTH, GHEIGHT);
  //Game variables
  private Thread game;
  private volatile boolean running = false;
  //Game Objects
  World world;

  public GamePanel(){
    world = new World();

    setPreferredSize(gameDim);
    setBackground(Color.WHITE);
    setFocusable(true);
    requestFocus();
    //Handle all key inputs from user
    addKeyListener(new KeyAdapter(){
      @Override
      public void keyPressed(KeyEvent e){

      }
      @Override
      public void keyReleased(KeyEvent e){

      }
      @Override
      public void keyTyped(KeyEvent e){

      }
    });

  }

  public void run(){
    while(running){
      gameUpdate();
//      gameRender();
//      paintScreen();
      repaint();

    }
  }

  private void gameUpdate(){
    if(running && game != null){

    }
  }

  private void gameRender(){
    if(dbImage == null){ // Create the buffer
      dbImage = createImage(GWIDTH, GHEIGHT);
      if(dbImage == null){
        System.err.println("dbImage is still null!");
        return;
      }else{
        dbg = dbImage.getGraphics();
      }
    }
    //Clear the screen
    dbg.setColor(Color.WHITE);
    dbg.fillRect(0, 0, GWIDTH, GHEIGHT);
    //Draw Game elements
    draw(dbg);
  }

  /* Draw all game content in this method */
  public void draw(Graphics g){
    world.draw(g);
  }
  public void paintComponent(Graphics g){
    super.paintComponent(g);
    gameRender();
    paintScreen(g);
  }
  private void paintScreen(Graphics g){
    try{
//      g = this.getGraphics();
      if(dbImage != null && g != null){
        g.drawImage(dbImage, 0, 0, null);
      }
      Toolkit.getDefaultToolkit().sync(); //For some operating systems
//      g.dispose();
    }catch(Exception e){
      System.err.println(e);
    }
  }

  public void addNotify(){
    super.addNotify();
    startGame();
  }

  private void startGame(){
    if(game == null || !running){
      game = new Thread(this);
      game.start();
      running = true;
    }
  }

  public void stopGame(){
    if(running){
      running = false;
    }
  }
}
class Main extends JFrame
{
  GamePanel gp;

  public Main()
  {
    gp = new GamePanel();
    setSize(500, 400);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    add(gp);
    setResizable(false);
    setVisible(true);
  }

  public static void main(String[] args)
  {
    Main m = new Main();
  }

} 
```

# javascript - 从 Mongoose 结果匿名函数返回父函数

> ID：12238825
> 
> 赞同：0
> 
> 时间：2012-09-02T18:54:16.643
> 
> 标签：javascript, node.js, mongoose

我正在编写一个函数，该函数返回一个列表，其中包含在 Mongo 数据库中注册的所有用户。

```
function getUsers() {
    db.collection('users').find({}, {username: true}, function(error, results) {
        if (results) return results;
        return [];
    });
} 
```

问题是 Mongoose 需要一个匿名函数来获取结果，如果我在获得结果时尝试返回这些结果，则返回只影响匿名函数，因此父函数返回未定义。我想 Mongoose 异步运行匿名函数。

解决这个问题的最佳方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:58:30.357

你说的对; 从异步函数返回没有任何意义。您需要异步处理数据库操作的结果。（你可以使用承诺，正如 Kamugo 提到的，但即使承诺使用回调函数）。

使这项工作最直接的方法是`getUsers`通过传入一个回调来实现异步，并使用该回调来回调`find`：

```
function getUsers(callback) {
    db.collection('users').find({}, {username: true}, callback);
} 
```

然后像这样使用它：

```
getUsers(function(error, results) {
    if (results) {
        // do something with results
    } else {
        // no results
    }
}); 
```

# c# - 如何进行事件：单击 ListView 中的随机区域？

> ID：12238826
> 
> 赞同：0
> 
> 时间：2012-09-02T18:54:30.450
> 
> 标签：c#, .net, winforms, listview

如果我想在 Col1 和 Col2 上捕捉点击人民币的事件，并且事件应该不同，有没有机会这样做？

![在此处输入图像描述](../Images/ec964edd9effc651a42266bce8594190.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:34:15.310

正如@HansPassant 所说，添加 mouseup 事件

```
void listview1_MouseUp(object sender, MouseEventArgs e)
    {
        ListViewItem item = listview1.GetItemAt(e.X, e.Y);
        ListViewHitTestInfo info = listview1.HitTest(e.X, e.Y);

        if ((item != null) && (info.SubItem != null))
        {
            //item.SubItems.IndexOf(info.SubItem) gives the column index
            MessageBox.Show(item.SubItems.IndexOf(info.SubItem).ToString());
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:44:49.333

使用 ListView 的 DataGridView。DataGridView 已经支持单元格点击：

```
 private void DataGridView1_CellClick(object sender, DataGridViewCellEventArgs e)
    {
        string message = "You have clicked " + (e.ColumnIndex + 1).ToString() + " cell inside " + (e.RowIndex + 1).ToString() + " row!";
        MessageBox.Show(message, "Click info", MessageBoxButtons.OK, MessageBoxIcon.Information);
    } 
```

ListView 不能与表格数据一起使用。它的主要用途是列表，很好的例子是 Windows 资源管理器。

# objective-c - 如何在 NSStream 中使用委托？

> ID：12238828
> 
> 赞同：2
> 
> 时间：2012-09-02T18:54:57.450
> 
> 标签：objective-c, delegates, nsstream

我是Objective-C的新手。我正在尝试学习如何使用`NSStream`. 我只是使用了 Apple 支持的简单代码。此代码应从我的桌面中的文件打开一个流，并在 iStream 调用委托时显示一条简单消息。在代码的最后，我可以看到状态是正确的，但委托永远不会被调用。我错过了什么？

```
#import <Foundation/Foundation.h>

@interface MyDelegate: NSStream <NSStreamDelegate>{
}

- (void)stream:(NSStream *)stream handleEvent:(NSStreamEvent)eventCode ;

@end

@implementation MyDelegate

- (void)stream:(NSStream *)stream handleEvent:(NSStreamEvent)eventCode  {
    NSLog(@"############# in DELEGATE###############");
}

@end

int main(int argc, const char * argv[])
{
    @autoreleasepool {
        MyDelegate* myDelegate=[[MyDelegate alloc]init];
        NSInputStream* iStream= [[NSInputStream alloc] initWithFileAtPath:@"/Users/Augend/Desktop/Test.rtf"];

        [iStream setDelegate:myDelegate];

        [iStream scheduleInRunLoop:[NSRunLoop currentRunLoop]
                           forMode:NSDefaultRunLoopMode];
        [iStream open];

        NSLog(@" status:%@",(NSString*) [iStream streamError]);
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T19:03:24.667

运行循环运行的时间不够长，无法调用委托方法。

添加：

```
[[NSRunLoop currentRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:2.0]]; 
```

在您打开流之后。这仅在没有 GUI 的程序中是必需的——否则将为您旋转运行循环。

`stream:handleEvent:`如果您想在退出之前绝对确定已被调用，请在该方法中设置一个（全局）标志并将其放入测试该标志`runUntilDate:`的循环中：`while`

```
while( !delegateHasBeenNotified ){
     [[NSRunLoop currentRunLoop] runUntilDate:[NSDate dateWithTimeIntervalSinceNow:0.5]];
} 
```

# php - 应该替换哪些字符以避免输出 HTML？

> ID：12238831
> 
> 赞同：3
> 
> 时间：2012-09-02T18:55:20.097
> 
> 标签：php, html, escaping

我在网站中有一些用户输入，以后用 PHP 输出该输入时**我不想允许 HTML 。**

我认为唯一危险的字符是`<`, `>`, `/`(slash) 和`\`(backslash)。

我对吗？

因此，例如，如果我替换`<`为`&#60;`是否足以防止 HTML 被输出？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-02T18:56:59.463

只需使用内置函数[`htmlspecialchars()`](http://php.net/manual/en/function.htmlspecialchars.php)，你就会很好。请注意，您还应该始终添加编码参数。

例如：

```
echo htmlspecialchars($unsafeString, ENT_QUOTES, 'UTF-8'); 
```

# php - 将函数转换为 MySQLi 时，出现“未定义索引”错误

> ID：12238833
> 
> 赞同：1
> 
> 时间：2012-09-02T18:55:37.173
> 
> 标签：php, mysqli

我正在将我的`mysql`功能更改为功能`mysqli`并遇到了一个有趣的问题。

我想回显特定的用户数据。我创建了一个函数，在其中插入多个参数（每个参数代表数据库中的一列），然后用一行简单的代码回显我想要的任何列。

如果我刚才所说的令人困惑，我下面的代码将进一步解释它。它是完整的。

我的问题是它不起作用。

它返回一个错误，`Notice: Undefined index: last_name in...`它发生在代码的最后一行，`echo $user_data['last_name'];`.

是什么导致了错误？是功能吗？如果是这样，问题出在哪里？这是我与`mysqli`.

```
$mysqli = new mysqli("localhost", "user", "password", "database"); 
```

这是功能：

```
function user_data ($mysqli, $user_id) {
    $data = array();
    $user_id = (int)$user_id;
    $func_num_args = func_num_args();
    $func_get_args = func_get_args();
    if ($func_num_args > 1) {
        unset($func_get_args[0]);
        unset($func_get_args[1]);
        $fields ='`' .  implode ('`, `', $func_get_args) . '`';
        //here I am starting the mysqli prepared statement              
        if ($stmt = $mysqli->prepare("SELECT ? FROM `users` WHERE `user_id` = ?")) {
            $stmt->bind_param('si', $fields, $user_id);
            $stmt->execute();
            //here I am trying to convert the result into an array
            $meta = $stmt->result_metadata();
            while ($field = $meta->fetch_field()) {
                $parameters[] = &$row[$field->name];
            }
            call_user_func_array(array($stmt, 'bind_result'), $parameters);
            while ($stmt->fetch()) {
                foreach($row as $key => $val) {
                        $x[$key] = $val;
                }
                $results[] = $x;
            }
            return $results;
            $stmt->close(); 
            }
    }
} 
```

测试该功能以查看它是否有效：

```
$session_user_id = 1;
$user_data = user_data($mysqli, $session_user_id, 'username', 'password', 'first_name', 'last_name', 'email');
echo $user_data['last_name']; 
```

`var_dump()`用于变量的 A`$user_data`与此一起返回。

```
array(1) { [0]=> array(1) { ["?"]=> string(58) "`username`, `password`, `first_name`, 
`last_name`, `email`" } } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:18:31.400

您不能将`?`in`prepare`用于表名或列名。[请参阅文档](http://php.net/manual/en/mysqli.prepare.php#refsect1-mysqli.prepare-parameters)。

相反，创建一个数组，如

```
$valid = array('username', 'password', ...); 
```

然后检查输入[`in_array`](http://php.net/manual/en/function.in-array.php)：

```
$fields = array();
foreach($func_get_args as $arg) {
    if(in_array($arg, $valid)) $fields[] = $arg;
}
$fields = '`' . implode ('`, `', $fields) . '`';
if($stmt = $mysqli->prepare("SELECT $fields FROM `users` WHERE `user_id` = ?")) {
    // ... 
```

# haskell - 如何检查 Haskell 中缀运算符优先级

> ID：12238836
> 
> 赞同：20
> 
> 时间：2012-09-02T18:55:49.513
> 
> 标签：haskell, ghci, infix-operator

我可以使用 :t 在 GHCi 中看到中缀运算符的类型，如下所示：

```
>:t (.)
(.) :: (b -> c) -> (a -> b) -> a -> c 
```

如何查看 GHCi 中的运算符优先级？那可能吗？

另外，额外的问题，有没有办法通过 ghci 查看这些前奏函数的来源？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-09-02T19:06:47.553

`:i`( `:info`)。

```
[Prelude]
> :i (+)
class Num a where
  (+) :: a -> a -> a
  ...
        -- Defined in `GHC.Num'
infixl 6 + 
```

# macos - 无法使特定文件夹操作生效

> ID：12238841
> 
> 赞同：0
> 
> 时间：2012-09-02T18:56:37.547
> 
> 标签：macos, applescript, directory

这里有点问题。我正在尝试使特定的文件夹操作起作用，但是无论我做什么，我似乎都无法使其正常工作。我的所有其他文件夹操作都按预期工作，即使是我自己编写的 AppleScript 也是如此。但是，不是这个。继承人的代码：

```
on adding folder items to this_folder after receiving added_items
--set added_items to choose file with multiple selections allowed
processItems(added_items)

end adding folder items to

on processItems(added_items)

set imageTypesList to {"JPEG image", "Portable Network Graphics image", "Windows bitmap image", "Graphics Interchange Format image", "Adobe Photoshop File", "TIFF Image"}

set audioTypesList to {"MP3 audio", "AIFF-C audio", "Waveform audio"}
set videoTypesList to {"Video-MPEG4", "MPEG-4 File", "Video-MPEG2", "Video-MPEG", "AVI", "Matroska Video File"}
set fontTypesList to {"TrueType font", "PostScript® Type 1 outline font", "Font Suitcase"}
set docsTypesList to {"Portable Document Format (PDF)", "Scrivener Project", "Microsoft Word 97 - 2004 document", "Rich Text Document", "Plain Text Document", "CSV Document", "Pages Publication", "Keynote Presentation"}
set epubTypesList to {"epub", "Kindle Document", "iBooks Author Template", "iBooks Author Book"}
set archTypesList to {"ZIP archive", "tar archive", "rar archive", "Tar Gzip Archive"}
set diskTypesList to {"Installer package", "Disk Image"}
set execTypesList to {"Unix Executable File"}
set appsTypesList to {"Application (32-bit)", "Application"}
set iconTypesList to {"Apple Icon Image", "Icon Container", "Windows Icon Image"}
set otherTypesList to {"XTorrent File"}
set scriptTypesList to {"Compiled OSA Script"}
set openTypesList to {"Chromium Extra", "Action", "RapidWeaver Theme", "Mac OS X Preference Pane"}

set uberList to imageTypesList & audioTypesList & videoTypesList & fontTypesList & docsTypesList & ¬
    epubTypesList & archTypesList & diskTypesList & execTypesList & appsTypesList & iconTypesList & ¬
    otherTypesList & scriptTypesList & openTypesList

set imagesFolder to "Technomage:Users:andyhainline:Downloads:Images" as alias
set appsFolder to "Technomage:Users:andyhainline:Downloads:Apps" as alias
set archivesFolder to "Technomage:Users:andyhainline:Downloads:Archives" as alias
set epubFolder to "Technomage:Users:andyhainline:Downloads:eBooks" as alias
set fontsFolder to "Technomage:Users:andyhainline:Downloads:Fonts" as alias
set docsFolder to "Technomage:Users:andyhainline:Downloads:PDFs and Docs" as alias
set diskFolder to "Technomage:Users:andyhainline:Downloads:Installers and Disk Images" as alias
set iconFolder to "Technomage:Users:andyhainline:Downloads:Icons" as alias
set audioFolder to "Technomage:Users:andyhainline:Downloads:Audio" as alias
set videoFolder to "Technomage:Users:andyhainline:Downloads:Video" as alias
set otherFolder to "Technomage:Users:andyhainline:Downloads:Torrent Files" as alias
set miscFolder to "Technomage:Users:andyhainline:Downloads:Miscellanious" as alias
set scriptFolder to "Technomage:Users:andyhainline:Downloads:AppleScripts and Automator Stuff" as alias
set execFolder to "Technomage:Users:andyhainline:Downloads:Run From Here" as alias

tell application "Finder"
    repeat with anItem in added_items
        if (kind of anItem) is in imageTypesList then
            move file anItem to imagesFolder with replacing
        else if (kind of anItem) is in audioTypesList then
            move file anItem to audioFolder with replacing
        else if (kind of anItem) is in videoTypesList then
            move file anItem to videoFolder with replacing
        else if (kind of anItem) is in fontTypesList then
            move file anItem to fontsFolder with replacing
        else if (kind of anItem) is in docsTypesList then
            move file anItem to docsFolder with replacing
        else if (kind of anItem) is in epubTypesList then
            move file anItem to epubFolder with replacing
        else if (kind of anItem) is in archTypesList then
            move file anItem to archivesFolder with replacing
            open (path to archiveFolder & (name of file anItem))
        else if (kind of anItem) is in diskTypesList then
            move file anItem to diskFolder with replacing
        else if (kind of anItem) is in execTypesList then
            move file anItem to appsFolder with replacing
        else if (kind of anItem) is in webTypesList then
            move file anItem to docsFolder with replacing
        else if (kind of anItem) is in iconTypesList then
            move file anItem to iconFolder with replacing
        else if (kind of anItem) is in otherTypesList then
            move file anItem to otherFolder with replacing
        else if (kind of anItem) is in scriptTypes then
            move file anItem to scriptFolder with replacing
        else if (kind of anItem) is in openTypes then
            delay 10
            open anItem
            move file anItem to miscFolder
        else if (kind of anItem is "Folder") then
            set folderFiles to get every file of folder anItem
            processItems(folderFiles)
        end if
    end repeat
end tell 
```

结束进程项

如您所见，它相当复杂。请注意：如果我在开头注释掉“on”处理程序并使用“选择文件”对话框运行脚本，它可以完美运行，正如预期的那样。因此，从理论上讲，代码本身没有任何问题。我已经检查了“/Library/Scripts/Folder Action Scripts”中文件的文件权限，这就是我得到的：

```
-rwxr-xr-x   1 root  wheel  20758 Sep  2 14:43 add - copy based on type.scpt 
```

在我看来，这完全正确。（我必须在保存文件后手动设置这些权限。）

关于出了什么问题的任何想法？

- 啊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T23:38:11.720

我的猜测是您希望 added_items 是文件列表，因此您使用重复循环。我怀疑也许当只添加一个文件时它不是一个列表，因此重复循环不起作用。因此，我建议检查 added_items 的类并相应地进行。因此，请尝试将脚本的顶部更改为此...

```
on adding folder items to this_folder after receiving added_items
    --set added_items to choose file with multiple selections allowed
    if (class of added_items) is list then
        processItems(added_items)
    else
        processItems({added_items}) -- here we make it a list so the repeat loop works
    end if
end adding folder items to 
```

# git - 从可以应用于不同文件夹结构的提交中创建补丁的最简单方法是什么

> ID：12238842
> 
> 赞同：1
> 
> 时间：2012-09-02T18:56:38.687
> 
> 标签：git, diff, patch

假设我有这个文件夹结构：

```
/projectroot/foo/bar/subfoo/foo.txt 
```

现在我在`foo.txt`提交中更改了一些内容。

我有另一个完全相同的存储库，`foo.txt`但文件夹结构是这样的：

```
/projectroot/somedir/foo.txt 
```

很明显，应该有一种方法可以自动将工作应用到`foo.txt`第二个存储库中。我想可以创建一个补丁，但我找不到正确的方法。我需要以某种方式从仅适用于文件（或相对于父目录）的提交中创建一个补丁，然后将其仅应用于文件或托管文件的目录。

我怎样才能用 git 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:25:40.257

通常要做的是像往常一样创建补丁，然后使用选项

`--directory`（也许还有）在使用或`-p`应用补丁时。`git apply``git am`

# php - PHP中UTF-8字符串的字节数组？

> ID：12238845
> 
> 赞同：6
> 
> 时间：2012-09-02T18:56:56.213
> 
> 标签：php, utf-8

如何将字节数组转换为 UTF-8 字符串？我需要这个，因为我是从二进制格式中提取的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-02T19:08:49.520

字符串只不过是一个字节数组。因此，UTF-8 字符串与字节数组非常相似，除了您还知道字节数组代表什么。

所以你的输入字节数组还需要一个额外的信息：字符集（字符编码）。如果您知道输入字符集，则可以将字节数组转换为另一个表示 UTF-8 字符串的字节数组。

执行此操作的 PHP 方法称为[`mb_convert_encoding()`](http://php.net/manual/en/function.mb-convert-encoding.php).

PHP 本身不知道字符集（字符编码）。所以一个字符串实际上只不过是一个字节数组。应用程序必须知道如何处理它。

因此，如果您有一个字节数组并希望将其转换为 PHP 字符串以便使用 转换字符集`mb_convert_encoding()`，请尝试以下操作：

```
$input = array(0x53, 0x68, 0x69);
$output = '';
for ($i = 0, $j = count($input); $i < $j; ++$i) {
    $output .= chr($input[$i]);
}
$output_utf8 = mb_convert_encoding($output, 'utf-8', 'enter input encoding here'); 
```

（而不是上面的单个示例，请查看[https://stackoverflow.com/a/5473057/530502](https://stackoverflow.com/a/5473057/530502)上的更多示例。）

`$output_utf8`然后将一个 PHP 字符串的输入字节数组转换为 UTF-8。

# python - Python多处理+日志记录.FileHandler

> ID：12238848
> 
> 赞同：10
> 
> 时间：2012-09-02T18:57:32.113
> 
> 标签：python, logging, multiprocessing

我正在尝试在多处理服务器中实现日志记录。根据文档，“不支持从多个进程记录到单个文件”。我创建了一个小程序来检查这个语句：

```
import logging
import multiprocessing
import os

log = logging.getLogger()

def setup_logger():
    formatter = logging.Formatter('%(asctime)s %(name)s %(levelname)s: %(message)s')

    fileHandler = logging.FileHandler('test.log')
    fileHandler.setFormatter(formatter)

    log.setLevel(logging.DEBUG)
    log.addHandler(fileHandler)

def write_log_entries(identifier, start_event):
    start_event.wait()
    for i in range(100):
        s = ''.join(str(identifier) for k in range(30))
        log.info('[{}, {}] --- {}'.format(os.getpid(), identifier, s))

if __name__ == '__main__':
    setup_logger()
    procs = []
    start_event = multiprocessing.Event()
    for i in range(100, 300):
        p = multiprocessing.Process(target=write_log_entries, args=(i, start_event))
        procs.append(p)

    for p in procs:
        p.start()

    start_event.set()

    for p in procs:
        p.join() 
```

执行上述代码后，我预计会在“test.log”中看到一团糟，但一切似乎都很好（当然，时间戳除外，它们不是按顺序排列的）。

任何人都可以解释为什么当多个进程同时写入日志文件时日志条目不重叠？在这种情况下 log.info() 可以被认为是原子的吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-02T19:25:39.403

简短的回答：内核锁定对 的单个调用`write`，因此只要消息很小，您就可以了，因此它们会在单个`write`中刷新，这样就可以`write`一次成功地写入所有内容。没有一般保证是这种情况，这就是为什么文档不承诺这会起作用的原因。

长答案：每次调用都会`log.info`刷新日志输出。这是必要的，否则您将无法在文件中看到最新的日志条目。在 Python/libc 级别，flush 被实现为对 write(2) 系统调用的调用，调用该系统调用以写出文件缓冲区的内容（如果有）。在您的情况下，缓冲区内容是您的日志消息。因此，Python 或 libc，取决于正在使用的文件，最终会调用操作系统调用，例如：

```
write(fd, buf, buflen); 
```

...其中`fd`是日志文件的系统级文件描述符，`buf`是缓冲写入的内存，`buflen`是消息的长度。（如果您使用诸如`strace`Linux 之类的工具跟踪您的 Python 进程，您可以看到这些调用。）`write`返回成功写入的字符数，并且内核不会将这些字符与文件同一区域中的其他写入交错。如果文件以 O_APPEND 模式打开，甚至可以保证写入在文件末尾，至少在 Unix 上是这样。所以，如果`buflen`它很小，就像正常的日志消息一样，一切都很好。但至少有两件事会出错。

首先，不能保证所有内容`buflen`都会写在一个`write`. `write`可以被信号中断，`fd`可以指向接受固定大小写入的设备，或者您的日志消息可能足够大，以至于内核无法在单个块中接受它。通常，这不会是一个问题——正确编写`write`总是作为循环实现的。但在你的情况下，这将是一场灾难，因为不同的调用`write` *会*与其他进程交错。

其次，如果您的日志消息足够大以至于无法放入 stdio 缓冲区（8K 左右），那么它将在到达内核之前被分割成块。在记录回溯或将日志格式化为 XML 等详细格式时，很容易发生这种情况。

# gnome-shell - st_widget_get_theme_node 拖动错误

> ID：12238851
> 
> 赞同：1
> 
> 时间：2012-09-02T18:58:20.097
> 
> 标签：gnome-shell, gnome-shell-extensions

我正在尝试在我正在开发的扩展中实现拖放系统，但我遇到了问题。据我所知，dnd 是通过制作这样的`draggable`对象来实现的

```
 let draggable = DND.makeDraggable(this.actor) 
```

`this.actor`我要拖放的 Clutter 演员在哪里，然后实现必要的回调。但是，当我这样做时，当我开始拖动时，Gnome Shell 会立即崩溃，并像这样在 stderr 上留下输出

```
 (gnome-shell:15279): St-ERROR **: st_widget_get_theme_node called on the widget [0x2b3c000 StBoxLayout.window-list-item-box:focused ("extension.js (~/Source/js/Botto...gmail.com) - GVIM")] which is not in the stage. 
```

但是，使用窥镜调用该`get_theme_node`特定小部件上的方法确实可以正常工作！

我必须明确将演员添加到舞台吗？又怎么会`get_theme_node`在 Gnome Shell 的腹部深处发生故障，而不是从窥镜中失败呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-24T04:13:54.037

还需要在您尝试拖动的 Actor 的委托上实现 getDragActor 和 getDragActorSource 方法。

这是一个简单的实现，它只是拖动演员的克隆。

```
getDragActor: function() {
    return new Clutter.Clone({source: this.actor,
                                   reactive: false,
                                   width: this.actor.get_width(),
                                   height: this.actor.get_height()});
},

getDragActorSource: function() {
    return this.actor;
} 
```

# ruby-on-rails - 启动 Redmine、Debian/Apache2 时出错

> ID：12238854
> 
> 赞同：0
> 
> 时间：2012-09-02T18:58:46.043
> 
> 标签：ruby-on-rails, ruby, redmine

使用命令启动 Redmine 时`ruby script/server -e production`，会引发以下错误：

```
/usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `gem_original_require': no such file to load -- initializer (LoadError)
    from /usr/local/lib/ruby/site_ruby/1.8/rubygems/custom_require.rb:31:in `require'
    from /var/www/redmine/config/boot.rb:60:in `load_initializer'
    from /var/www/redmine/config/boot.rb:43:in `run'
    from /var/www/redmine/config/boot.rb:16:in `boot!'
    from /var/www/redmine/config/boot.rb:119
    from script/server:2:in `require'
    from script/server:2 
```

我已经彻底搜索了我遇到的问题，但无济于事。这个错误的原因是什么？

在此先感谢，丹尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:11:06.997

您的 Rails gem 存在问题。

这个问题可以在 Redmine wiki 上[找到](http://www.redmine.org/projects/redmine/wiki/FAQ#When-I-start-the-application-I-get-this-error-in-gem_original_require-no-such-file-to-load-initializer-LoadError)。

很可能您还没有安装启动/运行服务器所需的许多 gem。

假设你已经安装了[bundler](http://gembundler.com/)`bundle install` ，从 redmine 根目录运行。

# asp.net-mvc - Upshot.js 的当前状态

> ID：12238855
> 
> 赞同：19
> 
> 时间：2012-09-02T18:58:54.100
> 
> 标签：asp.net-mvc, knockout.js, upshot, breeze

我正在考虑在我的一个非常重要的项目中使用 upshot.js 和 Knockout。我没有看到任何有关结果的文档或任何活动。在我做出这个决定之前，这个项目是否仍然有效？

如果整个 asp.net 堆栈现在是开放的，并且可以看到提交到存储库的内容，为什么这个小库仍然不在 codeplex 或 github 上供社区查看？

我希望这仍然在 asp.net 团队的雷达上。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-13T04:40:04.840

According to this blog post, Upshot is officially dead: [http://www.riaservicesblog.net/Blog/post/WCF-RIA-Services-is-Dead-Long-Live-WCF-RIA-Services.aspx](http://www.riaservicesblog.net/Blog/post/WCF-RIA-Services-is-Dead-Long-Live-WCF-RIA-Services.aspx)

The author points to BreezeJS as an alternative: [http://www.breezejs.com](http://www.breezejs.com)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-16T23:27:33.873

结果正式死亡。

“今年早些时候，Visual Studio 2012 的 Beta 版包含一个模板，该模板旨在使用 Upshot.js 和一个特殊的基于 Web API 的 DataController 构建“单页应用程序”，该数据控制器支持使用该单元进行插入、更新和删除操作支持事务的工作模式。我们目前没有继续开发该模板或 Upshot.js。我们希望首先专注于改善现有流行 JavaScript 库的开发体验，在未来的版本中，我们将重新审视这个决定，看看是否有其他库需要完善 SPA 体验。”

[http://aspnetwebstack.codeplex.com/wikipage?title=路线图](http://aspnetwebstack.codeplex.com/wikipage?title=Roadmap)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-25T11:59:07.543

[在http://jaydata.org](http://jaydata.org)上试试 JayData ，它具有[JavaScript 语言查询](http://wikipedia.org/wiki/JSLQ)和 JavaScript CRUD 功能，具有更改跟踪、批处理等功能。它通过 BreezeJS 提供的是与提供程序无关的架构和许多开箱即用的提供程序：OData、webSQL、IndexedDB、localStore、Facebook 和 YQL。

JayData 与 NodeJS 配合得很好，让您可以从基于 JavaScript 的中间层使用 OData。

此外，如果您在服务器端与 NodeJS 和 mongoDB 一起使用 JayData，您不仅可以使用它，还可以使用它来提供 OData。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-09T23:18:45.550

[根据关于 SPA 的讨论（参见http://aspnetwebstack.codeplex.com/discussions/topics/5321/asp-net-single-page-application](http://aspnetwebstack.codeplex.com/discussions/topics/5321/asp-net-single-page-application) ）中所说的，整个 SPA 策略会改变，所以我认为最终版本 o SPA 或任何将取代它的东西将与实际位完全不同......所以我不知道继续使用实际版本是否是一个好的举措......据我所知，这与 Mvc 不兼容4 RTM。我是[Mvc 控件工具包的作者](http://mvccontrolstoolkit.codeplex.com/)在那里，我们实现了一些 js 函数来帮助查询 OData，并更新客户端的实体。它们处理验证错误（客户端和服务器端），返回在服务器上创建的客户端主体密钥，进行更改跟踪（将刚刚更改的实体发送到服务器）并允许撤消在客户端所做的更改。他们还处理一对多的关系。此外，更新不仅由 WebApi 控制器处理，也由普通控制器处理。看看第一个教程：[http](http://dotnet-programming.com/post/2012/04/03/Mvc-Controls-Toolkit-Support-to-Mvc4-WebApi.aspx) : //dotnet-programming.com/post/2012/04/03/Mvc-Controls-Toolkit-Support-to-Mvc4-WebApi.aspx，然后参考其他链接的教程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-05T06:37:47.223

ASP.NET 团队尚未及时完成 ASP.NET SPA 的正式发布以发布最终的 ASP.NET MVC 4 版本，但他们仍在努力。

您可以在 ASP.NET CodePlex 站点上找到 ASP.NET SPA 的源代码并关注开发工作：

*   [ASP.NET SPA 源代码](http://aspnetwebstack.codeplex.com/SourceControl/list/changesets)（要查看结果，请单击*浏览*并展开`src/SPA/upshot`
*   [ASP.NET SPA 讨论](http://aspnetwebstack.codeplex.com/discussions/topics/5321/asp-net-single-page-application)

文档的普遍缺乏是由于尚未正式发布这一事实造成的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-07T16:45:32.287

对我的公司来说——我们使用了完全相同的组合（Knockout + Upshot），在大汗淋漓之后，我们决定摆脱 Upshot 并用 JQuery 的 ajax 调用代替它。更透明，更无错误。但是，还有更多的代码。

早在二月份，Upshot 的作者就承诺他们会在一周左右的时间内完成文档，从那以后我就再也没有听到过他们的消息。如果你想要我的意见，我认为这个项目已经被埋葬或无限期推迟。

# javascript - 如何获取字符串的一部分？

> ID：12238862
> 
> 赞同：0
> 
> 时间：2012-09-02T18:59:52.357
> 
> 标签：javascript

我提出了一个 oAuth 请求令牌的请求，我通过访问一个特殊的 URL 来做到这一点。这个请求的结果（页面内容）是这样的，我怎样才能从这个中获取 auth_token？

```
oauth_token=TBFdNoytaizrfMAWNZ6feqssNz3BsozHk5AesIioX8u8Ec&oauth_token_secret=DtQ3jiUIe33VdRcBAKwVQJRWpgKtEHi3m1yl3k0nlsHCBj0&oauth_callback_confirmed=true 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:04:35.427

你可以这样找到它：

```
var string = 'oauth_token=TBFdNoytaizrfMAWNZ6feqssNz3BsozHk5AesIioX8u8Ec&oauth_token_secret=DtQ3jiUIe33VdRcBAKwVQJRWpgKtEHi3m1yl3k0nlsHCBj0&oauth_callback_confirmed=true';

var match = /oauth_token=([^&]*)/.exec(string);
if(match)
{
    var oauth_token = match[1];
} 
```

另外，我认为在这里展示您的信息不是一个好主意，`oauth_token_secret`因为我认为只有您应该知道这个秘密，对吧？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:06:30.603

```
var oAuth = /auth_token=(.*?)&/.exec( str )[1]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T19:06:41.407

```
 // token param + value
 var tokenParam = ostr.split("&")[0];

 // only token value
 var tokenValue = tokenParam.split("=")[1]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-02T19:11:45.763

请求的结果与查询字符串的格式相同。这可以使用常见的 JS 函数进行解析。

```
var str = "oauth_token=TBFdNoytaizrfMAWNZ6feqssNz3BsozHk5AesIioX8u8Ec&oauth_token_secret=DtQ3jiUIe33VdRcBAKwVQJRWpgKtEHi3m1yl3k0nlsHCBj0&oauth_callback_confirmed=true";

var auth_token = getQueryVariable("oauth_token", str);
console.log(auth_token);

function getQueryVariable(variable, query) {
    if (!query) query = window.location.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');
        if (decodeURIComponent(pair[0]) == variable) {
            return decodeURIComponent(pair[1]);
        }
    }
    console.log('Query variable %s not found', variable);
}​ 
```

# ms-access - 在不打开表单的情况下更新表格和计算字段

> ID：12238863
> 
> 赞同：0
> 
> 时间：2012-09-02T19:00:02.923
> 
> 标签：ms-access, sharepoint-2010, ms-access-2010, infopath2010

我有一个 Access 20 数据库，其中包含链接到 SharePoint 库列表的数据。数据是通过 Infopath 表格收集的。

在数据库中，用于显示与每个项目相关的数据的表单使用查询从客户表和跟踪项目成本的表中提取。for 包含一个子表单，它跟踪项目花费的时间，计算从开始时间到停止时间之间经过的时间。子窗体页脚中的 umbound 文本框计算工作小时数的总和，主窗体上的文本框显示子窗体的总工作小时数。

在打开表单之前，不会在主表单中计算通过 infopath 表单输入的数据。由于一些用户甚至没有进入数据库并仅通过 Infopath 表单输入他们的数据，因此在这些一次性项目上花费的时间也不会在主表单上得到跟踪 - 只有子表单小时表。

现在的问题是：如何在不打开表单视图中的每个项目的情况下对数据进行编码以进行计算？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:33:33.053

您将不得不编写一个查询或者一个脚本/可执行文件来复制打开表单时完成的逻辑。

如果这太难了（一种明显的可能性）。然后是其他选项。

编写一个应用程序/脚本，为每个事物打开主窗体。如果您可以检测到需要执行的操作并打开它们，那就更好了。

再次检测场景。提供受影响客户的报告，以便他们在打开时放下它。阻止依赖于此数据正确的功能，直到它正确为止。

这是一个不好的位置，当关注点分离被分箱以支持“这将更便宜”时，你最终可能会遇到这种情况。你有我的同情，我自己的这件 T 恤的样本是食物发现和严重磨损。

# mysql - 将索引添加到 300 万行 MySQL

> ID：12238864
> 
> 赞同：0
> 
> 时间：2012-09-02T19:00:03.007
> 
> 标签：mysql, indexing, innodb

我需要在 InnoDB 表上的 int(1) 类型的列中添加至少 1 个索引。它需要索引大约 300 万行。这是我的生产服务器上的一个数据库，每天有成千上万的人在使用它。我尝试以标准方式添加索引，但它占用了太多时间（我让它运行了大约 7 分钟，然后才终止进程）并锁定了行，这意味着许多用户的应用程序被冻结。

运行所有这些的我的 VPS 有 512mb 的 RAM，并有一个 Intel Xeon E5504 处理器。

如何在不中断用户体验的情况下向此生产数据库添加索引？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:17:05.180

看看[pt-online-schema-change](http://www.percona.com/doc/percona-toolkit/2.1/pt-online-schema-change.html)。我认为这个工具在你的情况下非常有用。它显然会给您的数据库服务器增加额外的负载，但在大多数操作时间内不应阻止对表的访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T20:31:52.100

除非该表读取 XOR 写入，否则您可能需要关闭该站点。锁定数据库，运行操作并等待。

如果表是只写表，则将写入交换到临时表并在旧表上运行操作，然后将写入交换回旧表并插入临时表中的数据。

如果该表是只读的，请复制该表并在副本上运行该操作。

如果表是读/写的，那么一个*可能*有效的混乱替代方案是使用索引创建一个新表并将主键起点设置为原始表中的下一个值，在您的读取请求中添加一个连接以选择从两个表中，但专门写入新表。然后编写一个脚本，从旧表插入新表，然后删除旧表中的行。这将花费比停机时间更长的时间，而且可能会出现很多问题，但它应该是可行的。

您可以设置主键的起点

```
ALTER TABLE `my_table` AUTO_INCREMENT = X; 
```

希望有帮助。

# json.net - 如何强制 Newtonsoft.Json.Net 字典序列化为 KeyValuePair

> ID：12238865
> 
> 赞同：1
> 
> 时间：2012-09-02T19:00:17.303
> 
> 标签：json.net

是否有可能让 Json.Net 4.5+ 将我的 Dictionary<,> 序列化为这样；

```
{
    dic:[
        {k:"apples",v:2},
        {k:"pears",v:43}
    ]
} 
```

相反;

```
{
    dic:{
        "apples":2,
        "pears":43,
    }
} 
```

虽然后者是一个很好的默认值，并且查看 SO 帖子时，几乎每个人都想要它，但它不是默认值，但我有一个特定的情况，当我实际上想要它时，我会以另一种（前一种）方式代替。我尝试将以下内容添加到字典类或成员中；

```
[JsonProperty(ItemConverterType=typeof(DictionaryArrayConverter)] 
```

但这只会导致它在序列化堆栈中出现空值。

# c++ - SymInitialize 失败，出现错误 2147483661

> ID：12238867
> 
> 赞同：2
> 
> 时间：2012-09-02T19:01:12.300
> 
> 标签：c++, windows, winapi, error-handling

知道为什么会这样吗？该方法对当前进程完美无缺，对于在同一台本地机器上运行的远程进程失败，我的垃圾错误代码为 2147483661 (0x80000000D)，因为在任何地方都没有关于这个特定错误代码的任何提示，或者我错过了什么？ . 另外，我觉得；因为`SymInitialize`它自己失败了，所以`SymFromAddr`. 我对么？

有问题的进程以管理员身份运行，并且确实具有 SeDebug 和 SeSecurity 权限。

```
bool DbgHelpWrapper::MatchTargetSymbol( IntPtr processHandle, int procId, int threadId )
{
    DWORD dwStartAddress;
    DWORD dwInitializeError;
    DWORD dwThreadID = static_cast<DWORD>(threadId);
    DWORD dwProcessId = static_cast<DWORD>(procId);
    HANDLE hRemoteProcess = OpenProcess( PROCESS_ALL_ACCESS, FALSE, dwProcessId );

    if (GetThreadStartAddress( processHandle, dwProcessId, dwThreadID, &dwStartAddress ))
    {
        dwInitializeError = ERROR_SUCCESS;
    } else {
        dwInitializeError = Marshal::GetLastWin32Error();
        System::Console::WriteLine( String::Format("GetThreadStartAddress failed: {0}", dwInitializeError ));
    }

    try
    {
        DWORD dwSymSetOptStatus = SymSetOptions(SYMOPT_DEFERRED_LOADS | SYMOPT_UNDNAME | SYMOPT_LOAD_LINES);
        DWORD dwSymInitStatus = ERROR_SUCCESS;
        if (dwSymInitStatus = SymInitialize(hRemoteProcess, NULL, TRUE)) {
            dwInitializeError = ERROR_SUCCESS;
        } else {
            dwInitializeError = Marshal::GetLastWin32Error();
            System::Console::WriteLine( String::Format("SymInitialize failed: {0} error: {1}", dwSymInitStatus, dwInitializeError ));
            return false;
        }
        const int kMaxNameLength = 256;

        ULONG64 buffer[(sizeof(SYMBOL_INFO) + kMaxNameLength * sizeof(wchar_t) + sizeof(ULONG64) - 1) / sizeof(ULONG64)];
        memset(buffer, 0, sizeof(buffer));

        // Initialize symbol information retrieval structures.
        DWORD64 sym_displacement = 0;
        PSYMBOL_INFO symbol = reinterpret_cast<PSYMBOL_INFO>(&buffer[0]);
        symbol->SizeOfStruct = sizeof(SYMBOL_INFO);
        symbol->MaxNameLen = kMaxNameLength - 1;
        if( SymFromAddr(hRemoteProcess, (DWORD64)dwStartAddress, &sym_displacement, symbol ))
        {
            System::String^ name = gcnew System::String( symbol->Name );
            System::Console::WriteLine( String::Format("Found thread with ModuleName: {0}", name ));
            if( name->Contains( this->symbolName ))
            {
                return true;
            }
        }
        else
        {
            dwInitializeError = Marshal::GetLastWin32Error();
            System::Console::WriteLine( String::Format("SymFromAddr failed: {0}", dwInitializeError ));
        }
    }
    finally
    {
        CloseHandle(hRemoteProcess);
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-02-16T23:59:12.497

另一个原因，虽然在这种情况下可能不是，但可能是该过程尚未完全启动。在我的调试器代码中，我在 WaitForDebugEvent 返回 CREATE_PROCESS_DEBUG_EVENT 事件代码后立即调用 SymInitialize。这给出了 0x80000000D。稍后调用它（就在我需要堆栈遍历之前）成功了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:11:22.020

Microsoft 结果代码通常以十六进制表示。在这种情况下，您会在 Google 上搜索“SymInitialize 错误 8000000D”：

*   [http://msdn.microsoft.com/en-us/library/windows/desktop/ms681351%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681351%28v=vs.85%29.aspx)

对于错误代码“8000000D”的任何内容，我都空手而归（除了[这个](http://forums.citrix.com/thread.jspa?threadID=38939)，但 MSDN 链接听起来很有趣：

> 传递给 SymInitialize 的句柄必须与传递给进程调用的所有其他符号处理函数的值相同。它是函数用来识别调用者和定位正确符号信息的句柄。<=听起来你正在这样做......

```
A process that calls SymInitialize should not call it again unless it calls SymCleanup first. 
  <= What about this?

All DbgHelp functions, such as this one, are single threaded. Therefore, calls from more than one thread to this function will likely result in unexpected behavior or memory corruption. To avoid this, call SymInitialize only when your process starts and SymCleanup only when your process ends. It is not necessary for each thread in the process to call these functions.
  <= Or this 
```

问：您*不是*从多个线程调用 SymInitialize()，是吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-04T04:14:38.253

如果您尝试调用 SymInitialize 其中进程 id 属于 64 位进程，但您自己的进程是 32 位进程，则会收到错误 2147483661。

# android - 更新后未生成 R.java

> ID：12238871
> 
> 赞同：0
> 
> 时间：2012-09-02T19:01:41.973
> 
> 标签：android, eclipse, r.java-file

我的 R.java 一代是不存在的，但是在重建项目时仍然会生成我的 BuildConfig.java。这个问题不是局限于我的工作空间中的单个项目，而是存在于从姜饼到 jb 的项目的整个工作空间，所有这些都显示此错误。我已经在 Android 平台上工作了一年多，R.java 一代总是有点神秘，但似乎总是通过重启 eclipse 或重建项目来修复自己。

这开始于我对 java 7 的 java 更新，所以也改回了 java 6 sdk，特别是 1.6.0_26，重新安装了 eclipse(4.2)、android sdk 和 adt，但没有效果。

我正在与其他组成员（使用同一个主 git 存储库）一起开发这个项目，并且他们在生成 R.java 时没有问题，因此我可以肯定地说文件中没有导致 R 的错误.java 不生成。

作为免责声明，是的，我在这里阅读了与 R.java 相关问题的大量材料。

有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-12T16:07:53.570

我有完全相同的症状。

## 问题

*   `R.java`没有跨工作区构建，在尝试导入时导致错误：

    ```
    导入 <tld>.<project>.R 无法解析
    ```

*   `adb`尽管存在无法确定版本的错误报告：

    ```
    获取 adb 版本失败：无法运行程序“/home/dtk/.opt/android-sdk-linux/platform-tools/adb”：java.io.IOException: error=2, No such file or directory from '/ home/dtk/.opt/android-sdk-linux/platform-tools/adb' -存在=真`
    ```

    ```
    dtk@humbee ~/.opt/android-sdk-linux/platform-tools %ll | grep 亚行
    -rwxr-xr-x 1 dtk dtk 200K Sep 12 14:41 adb*
    dtk@humbee ~/.opt/android-sdk-linux/platform-tools % 文件 adb
    adb：ELF 32 位 LSB 可执行文件，Intel 80386，版本 1 (SYSV)，动态链接（使用共享库），用于 GNU/Linux 2.6.8，已剥离
    dtk@humbee ~/.opt/android-sdk-linux/platform-tools % ./adb
    zsh：没有这样的文件或目录：./adb
    127 dtk@humbee ~/.opt/android-sdk-linux/平台工具%
    ```

## 解决方案

安装`ia32-libs`为我修复了它：

```
root@humbee:~# uname -m
x86_64
root@humbee:~# aptitude search ia32-libs
p ia32-libs - 用于 amd64 和 ia64 系统的 ia32 共享库                                                                 
p ia32-libs-dev - 用于 amd64 和 ia64 系统的 ia32 开发文件                                                                
p ia32-libs-gtk - GTK+ ia32 共享库                                                                                              
v ia32-libs-静态-                                                                                                                         
root@humbee:~# aptitude install ia32-libs
将安装以下新软件包：
  ia32-libs lib32asound2 lib32bz2-1.0 lib32gcc1 lib32ncurses5 lib32stdc++6 lib32tinfo5{a} lib32v4l-0 lib32z1 libc6-i386{a}
    [...]

```

```
dtk@humbee ~/.opt/android-sdk-linux/platform-tools % ./adb 版本
Android 调试桥版本 1.0.29
dtk@humbee ~/.opt/android-sdk-linux/platform-tools %
```

HTH, dtk

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:06:16.367

如果您使用的是 Eclipse，我建议打开扩展日志记录，它应该显示 AAPT 输出，而 AAPT 是生成 R.java 的工具。

要做到这一点 - 转到 Window->Preference->Android->Build 并将 BuildOutput 设置为 Verbose。完成后 - 进行干净的构建并高度关注 Eclipse 中的 COnsoleOutput 选项卡。每个警告或消息都可以引导您找到错误。

让我们知道您是否会注意到一些有趣的事情。

祝你好运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T03:58:01.363

我在最新更新中遇到了这个问题。**删除**然后将项目**重新导入**我的工作区修复了它。

# c++ - 为了速度牺牲常量正确性可以吗？

> ID：12238873
> 
> 赞同：3
> 
> 时间：2012-09-02T19:01:48.957
> 
> 标签：c++, oop, optimization, constants

我有一个工厂类，它将用于创建某个类的大量实例。创建过程非常混乱，可能需要相当长的时间。所以我认为存储已经在工厂内创建的类的实例会很聪明，我可以稍后再回忆它们。

创建取决于单个参数（名称），因此可以将内容存储在`std::map`我称之为`old_instances`.

```
A A_factory::make_A(std::string const& name)
{
    if ( old_instances.find(name) != old_instances.end() )
    {
        return old_instances.find(name) -> second;
    }
    else
    {
        // obfuscated creation process that creates instance 'new_A'
        // ...

        old_instances.insert(std::pair<std::string, A>(name, new_A)); // <- problem
        return new_A;
    }
} 
```

这里的问题是整个例程可能是`const`工厂的成员。但因为`old_instances`是改编的。

我有点尴尬`const`，为了这样微不足道的事情而牺牲函数的特性。这些牺牲合乎逻辑吗？

如果这个问题太依赖口味，请不要拍我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:37:13.427

这是使用`mutable`. 只要外部行为确实是 const 的行为，您应该可以这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:26:43.800

这取决于您 - 如果您认为 old_instances 的状态不会对您的类的客户端代码产生任何可观察/概念上的差异，那么您可以使其可变，并使工厂函数 const。但是你真的应该确保它是真实的，否则你只会让你自己或其他人在以后阅读你的代码时感到困惑。

# php - codeigniter 添加一个新的控制器给出 404

> ID：12238878
> 
> 赞同：1
> 
> 时间：2012-09-02T19:02:31.900
> 
> 标签：php, codeigniter

每次，当我尝试在 CodeIniter 中添加新控制器时，都会得到以下信息：

> 404页面不存在
> 
> 未找到您所请求的页面。

*汽车管理员.php：*

```
 if ( ! defined('BASEPATH')) exit('No direct script access allowed');
 class Carsadmin extends Base_Controller {
       public function index(){
    echo 'Hello World!';
   }
 } 
```

任何想法为什么会发生这种情况？我需要更改路由文件吗？

```
$route['default_controller'] = "welcome";
$route['404_override'] = '';
$route['^(en|ar|ru)/pages/(.+)$'] = 'pages/index/$2';
$route['^(en|ar|ru)/profile/([0-9]+)$'] = '/profile/index/$2';
$route['^(en|ar|ru)/admin$'] = 'admin/dashboard';
$route['^(en|ar|ru)/(.+)$'] = "$2";
$route['^(en|ar|ru)$'] = $route['default_controller']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:09:06.233

尝试一下：-

```
<?php

class Carsadmin extends CI_Controller {

    public function __construct()
    {
        parent::__construct();
        $this->load->model('news_model');
    }

    public function index()
    {
        echo 'Hello World!';                   
            die;

    }

}

?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-02T19:08:45.617

您将需要一个包含以下内容的 htaccess 文件。

```
<IfModule mod_rewrite.c>
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?/$1 [L]
</IfModule> 
```

问题是可以通过在 URL 中添加 /index 和控制器名称来访问控制器。

因此，您需要一个 htaccess 文件来消除该问题。

# c - snprintf 或 vsnprintf 更好，我如何确保安全地使用它们？

> ID：12238880
> 
> 赞同：6
> 
> 时间：2012-09-02T19:02:37.510
> 
> 标签：c, printf, buffer-overflow

我决定在一些旧代码上运行一个静态分析工具，我发现了很多我正在使用 sprintf 的地方。该工具建议使用 vsnprintf 或 snprintf 替换调用，因为 sprintf 不会对缓冲区溢出进行任何类型的边界检查。

我可以轻松地对调用进行查找和替换，以便它使用 snprintf 或 vsnprintf 代替，但我想确保不需要做任何其他事情来确保功能安全

在某些情况下，所使用的字符串源自用户输入，而在某些情况下则不是。

有人对如何正确做有任何建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T19:08:16.607

> 我可以轻松地对调用进行查找和替换，以便它使用 snprintf 或 vsnprintf

不，没那么容易。只需查看`snprintf`or的定义，`vsnprintf`您就会发现它们采用了一个名为的额外参数`size`，该参数指定了输出缓冲区的长度。这就是`n`函数名中的意思。为了使您的代码安全，您必须查看执行 sprintf 的每个地方，找出可以安全写入输出缓冲区的最大字节数，并将该数字作为`size`参数传递给`snprintf`or `vsnprintf`。

**不安全代码：**

```
char buffer[10];
sprintf(buffer, "%d %d", x, y);  // UNSAFE if x and y can be large 
```

**等效安全码：**

```
char buffer[10];
snprintf(buffer, sizeof(buffer), "%d %d", x, y); 
```

也许如果您的所有代码都符合上述示例，那么您可以进行搜索和替换。但是对于更复杂的情况，您可能不得不考虑它。

# jquery - jQuery替换类

> ID：12238884
> 
> 赞同：18
> 
> 时间：2012-09-02T19:03:32.393
> 
> 标签：jquery

我有一个很大的`<li>`'s 列表，它们从 'span3' 类中获得了宽度。

```
<ul class="thumbnails">
    <li class="span3">
        <div class="thumbnail"><img src="/images/logos-s/s-001.png" alt="" data-creator="swc"> <span>01</span></div>
    </li>
    repeat...40x
</ul> 
```

我有按钮（`button#grid-bigger`&& `button#grid-smaller`），允许用户在点击时增加和减少网格的大小。理想情况下，用户可以点击 3 次，每次都会将`<li>`类从 span3 更改为 span4，然后再更改为 span12。

这是JavaScript：

```
$('#grid-bigger').live('click', function (e) {
    $('#blob .thumbnails').find('li').each(function(i, ojb) {
        if ( $(this).hasClass('span2') ) {
            $(this).removeClass('span2').addClass('span3');
        }

        if ( $(this).hasClass('span3') ) {
            $(this).removeClass('span3').addClass('span4');
        }

        if ( $(this).hasClass('span4') ) {
            $(this).removeClass('span4').addClass('span12');
        }
    });
}); 
```

发生的情况是，它不会允许单独单击“放大”按钮，而是只单击一次并同时执行两个语句。

有什么建议么？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-09-02T19:05:58.553

您只需要使用`else if`，否则它们将按顺序执行：

```
if ( $(this).hasClass('span2') ) {
    $(this).removeClass('span2').addClass('span3');
} else if ( $(this).hasClass('span3') ) {
    $(this).removeClass('span3').addClass('span4');
} else if ( $(this).hasClass('span4') ) {
    $(this).removeClass('span4').addClass('span12');
} 
```

# perl - chomp 给我 1 和 0

> ID：12238885
> 
> 赞同：2
> 
> 时间：2012-09-02T19:03:36.570
> 
> 标签：perl

我有两段代码。第一个是我想要的。但是为什么第二个给我1和0（我的英语是正确的，还是“1和0”）而不是“johnchrismandy”。

```
 foreach (@data) {
    print ;
}
//output
john
chris
mandy 
```

 ````
 foreach  (@data) {
    print chomp ;
}
//output
110
```

 `UPDATE:: Thank you guys, I understand it more now. But I don't understand the last part of the doc.` 

`=> You can actually chomp anything that's an lvalue, including an assignment: chomp($cwd = pwd`);

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T19:07:24.800

这是[记录在案](http://perldoc.perl.org/functions/chomp.html)的行为：“它返回从所有参数中删除的字符总数。” 你要

```
for (@data) {
   chomp;
   print "$_\n";
} 
```

请注意，它`$_`是元素的别名`@data`，因此`@data`也被修改了。如果你不希望这种情况发生。

```
for (@data) {
   my $item = $_;
   chomp($item);
   print "$item\n";
} 
```

* * *

关于文档的最后一行：

`my $item = $_;`作为左值返回`$item`（适合***赋值***左侧的值）。像这样，

```
my $item = $_;
chomp($item); 
```

可以写成

```
chomp( my $item = $_ ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:06:27.110

这是因为您正在打印函数的返回值，`chomp`这是从其所有参数中删除的字符总数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-02T19:06:57.413

[chomp](http://perldoc.perl.org/functions/chomp.html)返回删除的字符总数。

`\n`所以它会打印它已经删除了多少。

请按以下方式进行：

```
foreach  (@data) {
    chomp($_);
    print $_;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T21:24:01.183

正如其他人所说， chomp 返回删除的字符数。在我的特定实例中（单行 perl 替换文件语句中带有 eval 修饰符的正则表达式），我需要在单个语句中获取 chomped 值，而无需单独的打印语句。我终于找到了一个可行的解决方案 - 将 chomp 命令包装在 if 语句中。

从...开始：

```
$in = "I have COMMITS commits in my log";
$in =~ s/COMMITS/`git log | grep -i '^commit' | wc -l`/e;
print $in; 
```

这将返回：

```
I have 256
 commits in my log 
```

太好了，我需要大嚼这个，所以我尝试：

```
$in = "I have COMMITS commits in my log";
$in =~ s/COMMITS/chomp `git log | grep -i '^commit' | wc -l`/e;
print $in; 
```

但这会引发错误：

```
Can't modify quoted execution (``, qx) in chomp at ./script line 4, near "`git log | grep -i '^commit' | wc -l`}"
Execution of ./script aborted due to compilation errors. 
```

是的，所以我需要将输出分配给本地 var 并 chomp 它：

```
$in = "I have COMMITS commits in my log";
$in =~ s/COMMITS/chomp (my $VAR = `git log | grep -i '^commit' | wc -l`)/e;
print $in; 
```

但正如我们所说， chomp 返回删除的字符数：

```
I have 1 commits in my log 
```

然后我发现我可以将它包装在一个 if 语句中并让它返回结果，chomped：

```
$in = "I have COMMITS commits in my log";
$in =~ s/COMMITS/if (chomp (my $VAR = `git log | grep -i '^commit' | wc -l`)) { $VAR }/e;
print $in; 
```

最后，我在一个语句中得到了命令结果，chomped：

```
I have 256 commits in my log 
````

# python - Trigger.io 和 Backbone.js

> ID：12238888
> 
> 赞同：0
> 
> 时间：2012-09-02T19:04:24.543
> 
> 标签：python, ruby-on-rails, backbone.js, trigger.io

只是想知道 Trigger.io 和 Backbone.js 是否很好玩？我将使用 Trigger.io 编写我的第一个应用程序，并想知道我是否会通过使用主干使过程复杂化。我的 Trigger.io 应用程序的后端将是 Rails，我已经将 Backbone.js 与 Rails 一起使用，这还不错。您可以提供的任何教程或建议都会很酷，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:31:56.280

是的 trigger.io 和backbone.js 工作正常。事实上，它为您创建的默认 trigger.io 模板应用程序使用它。这是一个最近在应用程序商店中使用的应用程序，它使用了backbone.js 和 trigger.io -

[https://github.com/dragthor/south-ridge-app](https://github.com/dragthor/south-ridge-app)

祝你好运。并让我们了解您的应用程序是如何开发的。

这是另一个示例应用程序 -

[http://docs.trigger.io/en/v1.4/best_practice/example_project.html](http://docs.trigger.io/en/v1.4/best_practice/example_project.html)

# r - 使用 csv 和 quantmod 加载多个符号

> ID：12238892
> 
> 赞同：7
> 
> 时间：2012-09-02T19:05:11.753
> 
> 标签：r, time-series, xts, quantmod

我正在尝试使用 csv 文件加载多个符号，而不是从 Yahoo 下载。原始代码效果很好并且使用

```
load.packages('quantmod')
tickers = spl('TLT,IWM,GLD')
data <- new.env()
getSymbols(tickers, src = 'yahoo', from = '1980-01-01', env = data,
           auto.assign = T) 
```

但是，当我尝试使用下面的代码时，它会导致脚本稍后出现“下标越界”错误：

```
load.packages('quantmod')
tickers = spl('TLT,IWM,GLD')
data <- new.env()
getSymbols(tickers, src="csv", dir= "C:/Users/Admiral/Downloads/",
           env = data, auto.assign = T) 
```

任何人都有想法为什么第二个代码集不起作用？为了测试，我刚刚从 Yahoo 下载了 csv 数据并保存在本地（Windows）。如果我只使用一个 csv 文件，我不会收到下标错误。我也尝试了下面的代码，但稍后在脚本中得到了相同的错误：

```
setSymbolLookup(tickers=list(src="csv", dir= "C:/Users/Admiral/Downloads/"))
getSymbols(tickers, auto.assign = T, from = '1980-01-01', env=data) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T19:19:44.467

我会使用 FinancialInstrument 包来做到这一点

```
require('quantmod')
require('FinancialInstrument')
tickers <- c("TLT", "IWM", "GLD")
data <- new.env()
getSymbols(tickers, src = 'yahoo', from = '1980-01-01', env = data)

# Now save the data in a directory
tmpdir <- tempdir()
saveSymbols.common(tickers, tmpdir, env=data)

#remove the data    
rm(list=tickers, pos=data)
ls(data) # see that there is nothing there
# Now load the data back from disk
getSymbols(tickers, src='FI', dir=tmpdir, env=data, split_method='common')
ls(data) 
```

如果你想使用`getSymbols.csv`，你的数据必须有日期和 6 列（OHLCVA）

```
#write data to csv files on disk
for (i in seq_along(tickers)) {      
  write.zoo(get(tickers[i], pos=data), file=paste0(tmpdir, "/", tickers[i], ".csv"), sep=",")
}
rm(list=tickers, pos=data) #remove from memory
getSymbols(tickers, src='csv', dir=tmpdir)#, env=data)  #load from csv files 
```

# javascript - 哈希表是如何在 JavaScript 中实现的

> ID：12238893
> 
> 赞同：2
> 
> 时间：2012-09-02T19:05:36.730
> 
> 标签：javascript, hash

一些语言实现了哈希表，它可以使用任何东西，而不仅仅是字符串，作为键。在 JavaScript 中，您只能使用字符串和数字。这种实现的查找仍然是 O(1) 吗？JavaScript中有实现吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-02T19:58:25.907

显然，围绕这个主题存在很多误解。在 JavaScript 中，对象的键实际上**只是字符串**（参见[§8.10](http://ecma-international.org/ecma-262/5.1/#sec-8.10)）。 用作对象键的*任何内容（包括数字）都将转换为字符串。*因此，`obj[1]`和`obj["1"]` **是等价的**。

在内部，许多 JS 实现使用某种哈希表来快速查找对象属性。V8 实际上[生成隐藏的 C++ 类](https://developers.google.com/v8/design#prop_access)，允许在单个 CPU 指令中执行查找。无论哪种方式，都可以安全地假设对象属性访问速度很快并且接近 O(1)。

由于所有对象属性键都被转换为字符串，因此您只能使用转换为字符串的东西作为键。由于数字自然会转换为字符串，因此它们可以正常工作。布尔值也一样。日期也可以，因为`Date`实例转换为唯一的字符串（尽管有一些边缘情况需要注意）。

但是，对象不会转换为有意义的字符串。例如：

```
var o = {};
o[{a:1}]='some value'; 
```

实际上导致：

```
o = { '[object Object]': 'some value' } 
```

因为[字符串转换规则](http://ecma-international.org/ecma-262/5.1/#sec-9.8)。由于每个对象都转换为`[object Object]`，因此将许多对象作为键添加到另一个对象将导致对象只有一个属性。

当然，仍然可以使用对象作为键。你只需要覆盖默认实现`toString`——实际上，创建你自己的散列算法。例如，

```
function ComplexKey(a,b) {
    this.a = a;
    this.b = b;
}

ComplexKey.prototype.toString = function() {
    return this.a + ':' + this.b;
}

var o = {};
o[new ComplexKey(1,2)] = 'x';
o[new ComplexKey(3,4)] = 'y'; 
```

结果是：

```
o = {
    '1:2': 'x',
    '3:4': 'y'
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-02T19:21:21.917

JavaScript 没有“哈希表”。

它的[字典](http://en.wikipedia.org/wiki/Associative_array)是键/值对的集合，但键必须是唯一的。不同之处在于字典的实现并不意味着哈希，尽管出于性能原因，实现内部可能会使用[哈希表。](http://en.wikipedia.org/wiki/Hash_table)

JavaScript 中的所有*对象*都用作字典（这不包括原始类型，例如`string`和`number`）。通常一个空对象用于一个通用的“散列表”：

```
var o = {};
o[propExpression] = valueExpression; 
```

但是，重要的是：**所有属性/键值首先转换为字符串**。

因此以下是相同的：

```
o[true] = 1
o["true"] = 1 
```

* * *

遵循 ECMAScript 有点令人困惑，但“知道”属性名称都是字符串的关键部分可以在[Property Descriptors](http://es5.github.com/#property-identifier)中找到：

> 属性标识符类型用于将属性名称与属性描述符相关联。Property Identifier 类型的值是 (name, descriptor) 形式的对，*其中 name 是 String*，descriptor 是 Property Descriptor 值。

# c# - 如何避免使用 C# 在文件 IO 中添加空行

> ID：12238894
> 
> 赞同：0
> 
> 时间：2012-09-02T19:05:40.573
> 
> 标签：c#, file-io

我从这个站点获得了帮助，将对象中的数据写入制表符分隔的文本文件。它工作得很好。问题是它在文件末尾放置了一个额外的空白行。因此，拾取文件的过程失败。请让我知道是否有办法阻止添加额外行的代码。以下是代码：

```
private void WriteFile<T>(string filePath, IEnumerable<T> objectlist, string userName, string password)
{

        bool createHeader = false;

        if (!File.Exists(filePath))
        {
            using (File.Create(filePath)) ;
            createHeader = true;
        }

        string data = ToCsv<T>("\t", objectlist, createHeader);
        var file = new StreamWriter(filePath, true);
        file.WriteLine(data);
        file.Close();

} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-02T19:08:48.557

尝试`file.Write`代替`file.WriteLine`.

# c# - 泛型亚型继承

> ID：12238897
> 
> 赞同：1
> 
> 时间：2012-09-02T19:06:02.903
> 
> 标签：c#

我想为“hede”方法定义“Hayt”类约束。

有没有办法定义约束，比如

```
Hayt<?> or Hayt<extends Huyt> 
```

这是测试代码

```
class Program
    {
        static void Main(string[] args)
        {
            Hayt<Huyt> asd1 = new Hayt<Huyt>();
            Hayt<Huyt2> asd2 = new Hayt<Huyt2>();

            //there arent any problem here
            hede<Hayt<Huyt>>(asd1);

            //runtime error
            hede<Hayt<Huyt2>>(asd2);
        }

        static T hede<T>(T vede)
            where T : Hayt<Huyt>
        {
            return vede;
        }
    }

    public class Hayt<T>
        where T : Huyt

    {

    }

    public class Huyt
    {

    }

    public class Huyt2 : Huyt
    {

    } 
```

它可能像这样

```
static void Main(string[] args)
{
    Hayt<Huyt> asd1 = new Hayt<Huyt>();
    Hayt<Huyt2> asd2 = new Hayt<Huyt2>();

    hede<Hayt<Huyt>, Huyt>(asd1);

    hede<Hayt<Huyt2>, Huyt2>(asd2);
}

static T hede<T, B>(T vede)
    where B : Huyt
    where T : Hayt<B>
{
    return vede;
} 
```

但我认为可能有更好的解决方案

对不起，我的英语不好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:11:19.893

这就是你要做的。没有更平滑的方法。

但请注意，C# 4.0 在混合中添加了协变和逆变。参见例如

*   [http://blogs.msdn.com/b/csharpfaq/archive/2010/02/16/covariance-and-contravariance-faq.aspx](http://blogs.msdn.com/b/csharpfaq/archive/2010/02/16/covariance-and-contravariance-faq.aspx)
*   [http://msdn.microsoft.com/en-us/library/dd799517.aspx](http://msdn.microsoft.com/en-us/library/dd799517.aspx)

# asp.net - Appharbor 不会构建新的 Web 项目

> ID：12238904
> 
> 赞同：1
> 
> 时间：2012-09-02T19:06:23.577
> 
> 标签：asp.net, asp.net-mvc, appharbor

我刚刚在 AppHarbor 上创建了一个新应用程序并推送了一个包含 ASP.NET MVC 3 Web 项目的解决方案。奇怪的情况是它是一个 Web 项目，而不是 Web 应用程序，所以它是一个包含视图、dll 等的目录。它不是一个带有项目文件的 Web 应用程序。

AppHarbor 无法构建它：

> 构建于 2012 年 9 月 2 日晚上 7:54:11 开始。节点 1 上的项目“D:\temp\1yrhrtod.nii\input\AppHarbor.sln”（默认目标）。ValidateSolutionConfiguration：构建解决方案配置“Release|Any CPU”。D:\temp\1yrhrtod.nii\input\AppHarbor.sln.metaproj：警告 MSB4121：解决方案配置“Release|Any CPU”的解决方案文件中未指定项目“HoustersForum”的项目配置。[D:\temp\1yrhrtod.nii\input\AppHarbor.sln] 项目“D:\temp\1yrhrtod.nii\input\AppHarbor.sln”（1）正在构建“D:\temp\1yrhrtod.nii\input\ HoustersForum.metaproj" (2) 在节点 1（默认目标）上。建造：
> C:\Windows\Microsoft.NET\Framework\v4.0.30319\aspnet_compiler.exe -v /HoustersForum -p ..\HoustersForum\ -u -f D:\temp\1yrhrtod.nii\output_PublishedWebsites\HoustersForum\ ASPNETCOMPILER：错误 1003 : 目录 'D:\temp\1yrhrtod.nii\HoustersForum\' 不存在。[D:\temp\1yrhrtod.nii\input\HoustersForum.metaproj] 完成构建项目“D:\temp\1yrhrtod.nii\input\HoustersForum.metaproj”（默认目标）- 失败。完成构建项目“D:\temp\1yrhrtod.nii\input\AppHarbor.sln”（默认目标）——失败。
> 
> 构建失败。
> 
> “D:\temp\1yrhrtod.nii\input\AppHarbor.sln”（默认目标）（1）->（ValidateProjects 目标）->
> D:\temp\1yrhrtod.nii\input\AppHarbor.sln.metaproj：警告 MSB4121 ：解决方案配置“Release|Any CPU”的解决方案文件中未指定项目“HoustersForum”的项目配置。[D:\temp\1yrhrtod.nii\input\AppHarbor.sln]
> 
> "D:\temp\1yrhrtod.nii\input\AppHarbor.sln" (默认目标) (1) -> "D:\temp\1yrhrtod.nii\input\HoustersForum.metaproj" (默认目标) (2) -> （构建目标）-> ASPNETCOMPILER：错误 1003：目录“D:\temp\1yrhrtod.nii\HoustersForum\”不存在。[D:\temp\1yrhrtod.nii\input\HoustersForum.metaproj]
> 
> ```
> 1 Warning(s)
> 1 Error(s) 
> ```
> 
> 经过时间 00:00:00.12

我试过将代码拉到另一个目录，它编译得很好。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:06:18.100

我最终不得不创建一个新的 ASP.NET MVC 3 Web 应用程序项目，然后将所有内容从 Web 项目文件夹复制到其中。然后我在 web 项目的 bin 文件夹中引用了 dll，一切都很好。

# javascript - ajax请求的xml错误

> ID：12238911
> 
> 赞同：0
> 
> 时间：2012-09-02T19:07:04.967
> 
> 标签：javascript, xml, ajax

我在文件 test.txt 中以 xml 格式存储数据，

```
<element-list>
    <element>
        <name>sam</name>
        <title>header</title>
    </element>
    <element>
        <id>3732</id>
        <name>mad</name>
        <title>header</title>
    </element>
</element-list> 
```

我正在尝试使用代码使用 ajax 请求访问该文件，

```
$.ajax({
    type : 'GET',
    //url : "http://localhost:8080/cleo-primer/rest/elements/search?uid=1&query="+$("#srchBox").val() ,
    url: 'json/test.txt',
    dataType: 'xml',
    success : function result(s){           
        console.log(s.element[k].term[j] + "  /  " + s.element[k].title) ;              
    },
    error: function(xhr, textStatus, error) {
        console.log('status: ' + textStatus);
        console.log(xhr.responseText + " / " + xhr.status);
        //showError('an unknown error occurred while trying to fetch the feed: ' + xhr.status);
    }
}); 
```

除了错误没有给我任何回应？？有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:16:50.470

`s`是一个`XMLDocument`你可以使用 jQuery 来访问它的节点

```
console.log($(s).find('element').eq(k).find('term')[j].text() + "  /  " + $(s).find('element')[k].find('title').text()); 
```

此外，您要查找的内容似乎与您的 xml 文件中的内容不匹配。

# ruby-on-rails - Heroku 关注：如何在 Rails 应用程序中处理多个数据库？

> ID：12238915
> 
> 赞同：5
> 
> 时间：2012-09-02T19:07:29.450
> 
> 标签：ruby-on-rails, heroku, multiple-databases

我们在 Heroku 上托管了一个 Rails 应用程序，我需要为我们的营销人员设置一些分析页面。这似乎是 Heroku[关注数据库的典型用例](https://devcenter.heroku.com/articles/heroku-postgresql#follow-beta)

2 个数据库将共享相同的模型类，我只想要一些操作来查询复制的数据库。

在我的应用程序中处理这种情况的首选方法是什么？

[ActiveRecord::Base 文档](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)讨论了特定于类的连接：

> 您还可以设置特定于类的连接。例如，如果 Course 是一个 ActiveRecord::Base，但驻留在不同的数据库中，您可以只说 Course.establish_connection 并且 Course 及其所有子类将使用此连接。

我应该将所有模型类子类化以指定与辅助数据库的连接吗？（它甚至会工作吗？）

我也找到了这个 gem，但它似乎不再维护了.... [magic_multi_connections gem](http://magicmodels.rubyforge.org/magic_multi_connections/)？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-19T20:53:58.183

所以......我喜欢这个解决方案：

```
module Analytics

  class Base < ActiveRecord::Base
    self.abstract_class = true
    establish_connection ENV['ANALYTICS_DATABASE_URL']
  end

  class User < Base; end

  class Product < Base; end

end 
```

现在您的模型都连接到您的分析数据库（跟随者）。

如果您需要在分析应用程序和普通应用程序之间共享范围或方法，您可以将共享代码放在一个 mixin 中，然后将其包含在您的分析或普通模型中。

或者，您可以`.establish_connection`在控制器中调用您需要用于分析的模型，然后再将它们用于分析，但我不知道这是否会破坏您对其他正常 Web 请求的连接，需要您将其设置回您在下一个请求时的正常数据库连接...

**更新**：另一个想法让我震惊：

```
class UserBase < ActiveRecord::Base
  self.abstract_class = true
  # all your user model code goes here
end

class User < UserBase
  establish_connection(Rails.env) # connect to your normal database
end

class AnalyticsUser < UserBase
  self.table_name = 'users'
  establish_connection(ENV['ANALYTICS_DATABASE_URL'])
end 
```

这允许您在模型之间共享所有代码，无论它们是用于分析还是普通 Web 请求，但根据模型名称设置不同的连接。

另外，作为旁注，如果您不想在开发环境中设置关注者，只需在 development.rb 中设置 ENV['ANALYTICS_DATABASE_URL'] ：

```
ENV['ANALYTICS_DATABASE_URL'] ||= 'postgres://localhost/myapp_development' 
```

显然，在 Heroku 上，您需要将 ANALYTICS_DATABASE_URL 的配置变量重命名或设置为关注者的任何 DATABASE_URL。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-05-04T17:53:12.727

[为了更好地回答这个问题：Heroku 现在发布了一种使用Octopus gem](https://github.com/tchandy/octopus)处理这种情况的“官方”方式：

[https://devcenter.heroku.com/articles/distributing-reads-to-followers-with-octopus](https://devcenter.heroku.com/articles/distributing-reads-to-followers-with-octopus)

使用这个 gem，可以创建一个完全复制的模型，或者只在 follower 上执行一个块：

```
Octopus.using(:slave_two) do
  User.create(:name => "Mike")
end 
```

# php - 使用 JMSSerializerBundle 序列化时如何将元素附加到对象？

> ID：12238918
> 
> 赞同：1
> 
> 时间：2012-09-02T19:08:23.677
> 
> 标签：php, serialization, symfony

这是我想做的事情：

1.  我有一个对象，假设`Article`有两个属性`id`和`title`
2.  我想使用 JMSSerializerBundle 以 XML 或 JSON 格式对其进行序列化（但它应该适用于任何支持的格式）
3.  在序列化时，我想附加一些信息，因此序列化结果如下所示：

    ```
    <article>
      <id>1</id>
      <title>Lorem ipsum</title>
      <slug>1-lorem-ipsum</slug>
    </article> 
    ```

如您所见，结果已附加了`<slug>`实际上不是`Article`对象属性的元素。

我尝试深入研究代码，并尝试编写自定义序列化处理程序。我尝试了几种策略，例如附加动态对象属性，但它从未被序列化。我读到了一个类似的问题，`stdClass`我认为同样的问题也适用，这个属性不存在元数据，因为它在实例化后被动态添加到对象中。

然后我决定创建一个新的 XML 元素，但如果我返回我新创建的元素，这是唯一被序列化的元素，它会导致类似：

```
 <article>
      <slug>1-lorem-ipsum</slug>
    </article> 
```

我也尝试返回整个文档，但它会导致错误（应该是 DOMElement）。

我有点卡住，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T12:15:16.967

我在为每个序列化对象自动添加 Link rel 时遇到了类似的问题。我最终决定在要序列化的实体中创建一个 Link 实体和与它的关联。你可以对蛞蝓做同样的事情。

这具有额外的优势，即如果 URL 发生更改，则能够动态编辑链接。

# ftp - FTP到局域网内的FTP服务器

> ID：12238926
> 
> 赞同：0
> 
> 时间：2012-09-02T19:09:37.813
> 
> 标签：ftp

我使用 FTP（实际上使用 ipSwitch WS_FTP）相当多地在我的网络托管公司的服务器上来回移动内容，没有问题。

但现在我想通过 FTP 连接到局域网内的计算机。虽然我知道路由器的外部 I/P 地址，并且知道运行 FTP 服务的内部计算机是 192.168.0.7，但我不知道如何配置它。

这是怎么做到的？谢谢，加里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:24:42.507

路由器必须配置为将入站 FTP 连接转发到内部地址 192.168.0.7，并且它还必须提供一个帮助程序来管理数据通道（FTP 使用 2 个连接，而不是像大多数其他协议一样只有 1 个）。可以在[此处](http://www.slacksite.com/other/ftp.html)找到有关 FTP 工作原理的相当好的解释。

# cordova - 带有 phonegap 的 Google JavaScript API

> ID：12238927
> 
> 赞同：3
> 
> 时间：2012-09-02T19:09:38.663
> 
> 标签：cordova, google-drive-api, google-drive-realtime-api

我将 Google JavaScript API 的 SDK 用于 Google Drive Web 应用程序。我想使用 phonegap 将其转换为 iOS 的本机应用程序。我应该在 API 的控制台中指定什么 Javascript 来源。

# jquery - 使图像（横向和纵向）适合方形缩略图

> ID：12238929
> 
> 赞同：4
> 
> 时间：2012-09-02T19:09:53.177
> 
> 标签：jquery, html, css, image

为了画廊的目的，我真的很难让横向和纵向的图像很好地适合方形缩略图。

我尝试了各种 CSS 技巧，但认为我可能需要使用 Javascript。

有人知道我该如何解决这个问题吗？

编辑 - HTML/CSS 可以是任何东西，目前它只是用拇指正方形类打印出图像，即。

```
<img class="thumb_square" src="/images/uploads/pic.jpg"/>
<img class="thumb_square" src="/images/uploads/pic2.jpg"/>
<img class="thumb_square" src="/images/uploads/pic3.jpg"/> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-02T19:16:52.607

一种可能的解决方案（经过测试）：在`div`. 使用 css`background`属性显示缩略图，并`center`使用`no-repeat`. 您必须指定包含的`width`and 。将宽度和高度设置为所有缩略图的最大宽度/高度。即，如果您的缩略图是 150px*200px 和 200px*150px，则将所有 div 设置为 200px*200px。然后缩略图将在 200px*200px 框内居中，无论它们是处于纵向还是横向“模式”。`height``div`

例子：

```
<div style="width:200px; height:200px;
   background: url('/images/uploads/pic.jpg') no-repeat center;
   border:1px solid red;">
</div>

<div style="width:200px; height:200px;
   background: url('/images/uploads/pic2.jpg') no-repeat center;
   border:1px solid red;">
</div>

<div style="width:200px; height:200px;
   background: url('/images/uploads/pic3.jpg') no-repeat center;
   border:1px solid red;">
</div> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-04T10:04:04.390

我认为这正是您所需要的：无论图像有多大，您都会看到整个高度（如果是横向）或宽度（如果是纵向）；

jFiddle：http: [//jsfiddle.net/ECRC4/3/](http://jsfiddle.net/ECRc4/3/)

HTML：

```
<div class="thumb" style="background-image: url('http://placehold.it/250x500')"></div>
<br/>
<div class="thumb" style="background-image: url('http://placehold.it/500x200')"></div>
<br/>
<div class="thumb" style="background-image: url('http://placehold.it/100x200')"></div> 
```

CSS：

```
.thumb{
    display:inline-block;
    width:100px;
    height:100px;
    background:center;
    background-size:cover;
} 
```

# jquery - fancybox iframe 内容和谷歌搜索

> ID：12238930
> 
> 赞同：0
> 
> 时间：2012-09-02T19:09:55.190
> 
> 标签：jquery, iframe, fancybox, fancybox-2

我的网站上有一个页面，列出了所有项目的拇指。单击特定拇指（项目）时，Fancybox 会在 iframe 中加载项目的详细信息。一切都很好！（iframe 中的内容不包括导航、标题和其他网站元素。）

我遇到的问题是 Google 搜索结果页面 - Google 为所有详细信息页面编制了索引，现在当用户单击 Google 结果中的链接时，详细信息内容页面会在浏览器中打开（而不是 Fancybox iframe）。这很糟糕，因为详细信息页面不包括导航页面。

任何用户友好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-03T21:46:35.057

如果您对那些没有被 Google 索引的页面感到满意，那么您可以将 rel="nofollow" 添加到链接中：

更多详细信息：http: [//support.google.com/webmasters/bin/answer.py ?hl=en&answer=96569](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=96569)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-03T21:38:51.593

正如我在评论中提到的，您需要在每个“详细信息”页面中包含一个脚本来嗅探 URL 并检测页面是否在新窗口（首页）中打开，如果是，则重定向到修改后的主页URL（使用`hash`例如）将允许从主页打开fancybox中的“详细信息”页面。

因此，您可以在每个“详细信息”页面中包含此脚本：

```
<script type="text/javascript">
var isWindow = self == top; // returns true if opened in a new window, otherwise it migh be inside an iframe
if(isWindow){ 
 // alert("this page was opened in a new browser window");
 // then redirect to main page and add hash "detailedXX"
 window.location = "{URL}/mainpage.html#detailed01"
}
</script> 
```

`detailed01`为每个“详细信息”页面更改为不同的值。

然后在主页中，您可能有指向每个详细信息页面的链接，例如

```
<a id="detailed01" class="fancybox" href="detailed01.html">Open project detail page 01 in fancybox</a>
<a id="detailed02" class="fancybox" href="detailed02.html">Open project detail page 02 in fancybox</a> 
```

**请注意**，我`ID`在每个锚点中都包含了一个与`hash`我们将在重定向到主页时使用的锚点相匹配的锚点。

然后你的 fancybox 脚本可以是这样的：

```
<script type="text/javascript">
var thisHash = window.location.hash;
$(document).ready(function() {
 if(window.location.hash) {
  // get the URL without hash so we can restore it if needed
  var thisWindowLocation = window.location;
  var thisWindowLocationSplit = String(thisWindowLocation).split("#")[0];
  $(thisHash).fancybox({
   width: 800,
   height: 320,
   fitToView: false,
   autoSize : false,
   type: 'iframe',
   afterClose : function(){
    // returns URL to main page with no hash
    window.location = thisWindowLocationSplit
   }
  }).trigger('click');
 }
// fancybox for normal main page operation
 $(".fancybox").fancybox({
  width: 800,
  height: 320,
  fitToView: false,
  autoSize : false,
  type: 'iframe'
 });
}); // ready
</script> 
```

我[在这里设置了一个DEMO](http://www.picssel.com/playground/jquery/openDetailPageFancyboxONLY_03sep12.html)

此演示打开两个“详细”页面：

[http://www.picssel.com/playground/jquery/detailed01.html](http://www.picssel.com/playground/jquery/detailed01.html) 和 [http://www.picssel.com/playground/jquery/detailed02.html](http://www.picssel.com/playground/jquery/detailed02.html)

如果您尝试直接打开它们，则会重定向到[调用页面](http://www.picssel.com/playground/jquery/openDetailPageFancyboxONLY_03sep12.html)并在 fancybox 中打开

# java - JUnit 在 JAR 中运行测试

> ID：12238932
> 
> 赞同：6
> 
> 时间：2012-09-02T19:10:03.950
> 
> 标签：java, unit-testing, testing, ant, junit

我正在使用纯 JUnit 4 测试，并将它们编译在一些属于类路径的 jar 中。我想在我的类路径中运行所有测试。

有办法吗？

我的任务如下：

```
<target name="test" description="All the tests">
    <junit fork="yes">
        <classpath> 
            <path refid="test.classpath" />
            <fileset dir="war/WEB-INF/lib/">
                <include name="*.jar"/>
            </fileset>
            <fileset dir="war/WEB-INF"/>
            <fileset dir="war"/>
        </classpath>
    <formatter type="plain" usefile="false" />

    </junit>
</target> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T21:41:39.560

下面的示例假定 JUnit 测试使用后缀“Test”命名，例如“MyClassTest.java”，并且 JUnit 4 jar 文件位于属性指向的库目录中`lib.dir`。对于每个包含已编译测试的 jar 文件，[ZipFileSet](http://ant.apache.org/manual/Types/zipfileset.html)可用于选择嵌套`<batchtest>`元素中的测试类。JUnit 4 jar 的路径包含在类路径中，以确保使用正确的版本。

```
<target name="test" description="All the tests.">
  <junit fork="true">
    <classpath>
      <fileset dir="war/WEB-INF/lib/" includes="**/*.jar" />
      <fileset dir="${lib.dir}" includes="junit*.jar" />
    </classpath>
    <batchtest haltonfailure="true">
      <zipfileset src="war/WEB-INF/lib/test.jar" includes="**/*Test.class" />
    </batchtest>
    <formatter type="plain" usefile="false" />
  </junit>
</target> 
```

# android - SDB Android SDK - putAttributes() 和 getAttributes() 结果不一致

> ID：12238937
> 
> 赞同：0
> 
> 时间：2012-09-02T19:10:52.317
> 
> 标签：android, amazon-web-services

我刚开始使用适用于 AWS SDB 的 Android 开发工具包，在进行写入和读取时遇到了意外结果。这肯定是一个简单的问题，所以我将不胜感激任何解释！

这就是问题所在。

首先，我向 SDB 写入一条记录，如下所示：

```
sdb.createDomain(new CreateDomainRequest("myDomain"));

List<ReplaceableAttribute> attributes = new ArrayList<ReplaceableAttribute>(1);
attributes.add(new ReplaceableAttribute().withName("myField").withValue(myField));

sdb.putAttributes(new PutAttributesRequest("myDomain", itemName, attributes)); 
```

我可以看到 myField 的值已使用 Chrome SdbNavigator 正确写入 SDB。

现在我使用相同的代码更改记录，但 myField 属性的值不同。同样，我可以看到使用 SdbNavigator 使用新值正确写入了记录。

最后，我从设备上卸载了该应用程序（即，将其擦除干净），重新安装该应用程序，然后再次运行它以执行以下代码：

```
String s = "select * from `myDomain`";
SelectRequest selectRequest = new SelectRequest(s).withConsistentRead(true);
List items = sdb.select(selectRequest).getItems();

int count = items.size();

for (int i=0; i<count; i++) {
    Item item = (Item)(items.get(i));
    String itemName = item.getName();

    myField = getStringValueForAttributeFromList("myField", item.getAttributes());
} 
```

其中 getStringValueForAttributeFromList() 定义为

```
protected String getStringValueForAttributeFromList( String attributeName, List<Attribute> attributes ) {
    for ( Attribute attribute : attributes ) {
        if ( attribute.getName().equals( attributeName ) ) {
            return attribute.getValue();
        }
    }
    return "";      
} 
```

意想不到的部分是 getStringValueForAttributeFromList() 函数返回 myField 属性的第一个（现在不正确的）值 - 即使 sdbNavigator 显示记录具有第二个（正确的）值。

知道发生了什么，以及如何解决？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T20:00:42.943

已解决：我面临的问题是 SDB 允许在同一记录（项目）中具有相同名称的多个属性，因此它选择了我为属性 myField 设置的第一个值。

如果要保证唯一性，则必须在可替换属性上设置标志，如下所示：

```
ReplaceableAttribute ra = new ReplaceableAttribute().withName("myField").withValue(myField);
ra.setReplace(true); attributes.add(ra); 
```

然后调用 putAttributesRequest()，如上。谢谢。

# html - 背景图像在 IE 中不会一直拉伸

> ID：12238938
> 
> 赞同：1
> 
> 时间：2012-09-02T19:11:00.343
> 
> 标签：html, internet-explorer, background-image, css

我有一张图像用作背景，并试图让它 100% 填充屏幕的宽度。我已经应用了 background-size:100% 并且在 MZF 中它可以工作，但在 IE 中它不会再拉伸了。有谁知道解决这个问题？

这是HTML...

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        </head>
<body class="body">
            <!--Container to hold everything in the middle of page-->
            <div class="container">
</div>
</body>
</html> 
```

这是CSS..

```
.body
{
    background-image: url(final2.gif);
    background-size: 100%;
    background-repeat:no-repeat;
    background-color:#C2C2C2;
}

.container {
    width: 1000px;
    height: 1930px;
    margin-top: 0px;
    margin-right: auto;
    margin-left: auto;
    background-color:blue;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-09T14:57:37.967

您也可以尝试使用特定于 IE 的 alphaImageLoader。只需添加

```
.body {
    filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='final2.gif', sizingMethod='scale');
} 
```

到您的样式表。或者，最好创建一个新的 IE7/IE8 特定 css（通过[条件注释](http://www.quirksmode.org/css/condcom.html)包含）并将此样式放入其中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T19:18:23.213

见[http://jsfiddle.net/j5q63/](http://jsfiddle.net/j5q63/)

您可以使用紧随其后的图像模拟背景`<body>`：

```
<img id="bg" src="path/to/your/image.png" /> 
```

接着

```
#bg{
    position:absolute;
    top:0;left:0;
    width:100%;
    z-index:-1;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T20:38:43.597

您尚未指定要测试的 IE 版本。这很重要，因为不同版本的 IE 具有非常不同的功能和怪癖。

在这种情况下，我猜您使用的是 IE8，因为在 IE8 和更早版本`background-size`中不支持 CSS 功能。

有许多解决方案。遗憾的是，它们都不是很好，但我建议使用 javascript polyfill 解决方案，它允许您为其他浏览器保留现有的 CSS 代码。下一个最佳解决方案是将背景图像替换为`<img>`在现有元素后面分层的标签。一个 javascript polyfill 可能会使用相同的技术，但对您来说是透明的，因此您可以继续使用现有的 CSS。

您可以使用的一些脚本：

*   [http://srobbin.com/jquery-plugins/backstretch/](http://srobbin.com/jquery-plugins/backstretch/)
*   [https://github.com/louisremi/jquery.backgroundSize.js](https://github.com/louisremi/jquery.backgroundSize.js) （这两个都是jquery插件，但如果你不使用它，你应该能够找到不需要jquery的插件）

希望有帮助。

# django - 对模板中的对象进行排序

> ID：12238939
> 
> 赞同：5
> 
> 时间：2012-09-02T19:11:03.470
> 
> 标签：django, django-templates, django-views

让这些模型：

```
class Category(models.Model):
    name = models.CharField(max_length=20)

class Word(models.Model):
    name = models.CharField(max_length=200)
    votes = models.IntegerField(default=1)
    categories = models.ManyToManyField(Category, null=True, blank=True) 
```

这种观点：

```
def main_page(request):
    words = Word.objects.all()
    categories = Category.objects.all()
    return render(request, "main_page.html", {'words': words}) 
```

这个模板：

```
{% for category in categories %}
    {% for word in category.word_set.all %}
    <p>{{ word }}</p>
    {% endfor %}
{% endfor %} 
```

我想分别按票数和发布日期对模板中的单词进行排序。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-02T20:48:24.247

您可以制作[自定义模板标签或过滤器](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/)，将单词集和排序类型作为参数。

例如（未测试）：

**custom_tags.py：**

```
from django import template
register = template.Library()

@register.filter
def sort_by(queryset, order):
    return queryset.order_by(order) 
```

**模板.html**

```
{% load custom_tags %}
...
{% for word in category.word_set.all|sort_by:'-votes' %}
    <p>{{ word }}</p>
{% endfor %}
... 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-02T19:16:20.683

您可以在视图中执行此操作

```
words = Word.objects.all().order_by('votes', 'pub_date') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-02T21:16:56.823

你也可以：

1.  在类别模型中添加特殊方法，
2.  在 Word 的自定义相关管理器中添加简单的快捷方式，
3.  在 Word 中将此顺序设为默认值（老实说，我不喜欢这个顺序）

# php - 在 Codeigniter 中更新多行

> ID：12238941
> 
> 赞同：4
> 
> 时间：2012-09-02T19:11:20.367
> 
> 标签：php, sql, codeigniter, sql-update

我可以在数据库中插入多行，但问题是当我尝试更新它时，它会给我一个 Codeigniter 错误消息。这是我的模型，实际上我在控制器中没有什么重要的发现错误，因为我只是在控制器中加载了该模型。

```
$data  = array();
//$todayDate = date('Y-m-d');
for($i = 1; $i < count($_POST['code']); $i++) {
    //$code=$_POST['code'][$i];
    if($_POST['code'][$i] != '') {
        $data[] = array(
            $code='code' => $_POST['code'][$i],
            'price' => $_POST['sell']
            );
    }
}
$linksCount = count($data);

if($linksCount) {
    $this->db->where('code',$code);
    $this->db->insert_batch('sell_rate', $data);
}

return $linksCount; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-02T23:19:28.293

在您的`Model`以下部分应该是

```
$data[] = array(
    $code='code' => $_POST['code'][$i],
    'price' => $_POST['sell']
); 
```

替换为

```
$data[] = array(
    'code' => $_POST['code'][$i],
    'price' => $_POST['sell']
); 
```

并更新您应该使用的值，`update_batch`而不是`insert_batch`

```
$this->db->update_batch('yourtableName', $data, 'code'); // 'code' is where key 
```

替换`yourtableName`为您的原始表名并`code`用于`where`键，因此您不需要使用`$this->db->where('code',$code)`.

**参考：** [**CodeIgniter**](http://codeigniter.com/user_guide/database/active_record.html)。

# javascript - 如何在three.js中为三角形添加纹理？

> ID：12238944
> 
> 赞同：4
> 
> 时间：2012-09-02T19:11:27.553
> 
> 标签：javascript, three.js

我创建了一个场景，其中包含许多立方体、球体等，并且能够将纹理应用于这些图元，但是当我想为一个简单的三角形添加纹理时，我完全迷失了。

这是我最接近正确的方法：

```
 var texture=THREE.ImageUtils.loadTexture('/f/3d-images/texture-steel.jpg');
  var materialDecalRoof=new THREE.MeshBasicMaterial( {
    'map': texture,
    'wireframe': false,
    'overdraw': true
  } );
var geometry = new THREE.Geometry();
geometry.vertices.push(new THREE.Vector3(tentX/2+1, tentY, tentZ/2+1));
geometry.vertices.push(new THREE.Vector3(0, tentT, 0));
geometry.vertices.push(new THREE.Vector3(0, tentT, 0));
geometry.vertices.push(new THREE.Vector3(-tentX/2-1, tentY, tentZ/2+1));
geometry.faces.push(new THREE.Face4(0, 1, 2, 3));
geometry.faceVertexUvs[0].push([
  new THREE.UV(0, 0),
  new THREE.UV(0, 0),
  new THREE.UV(0, 0),
  new THREE.UV(0, 0)
]);
geometry.computeFaceNormals();
geometry.computeCentroids();
geometry.computeVertexNormals();
var mesh= new THREE.Mesh( geometry, materialDecalRoof);
scene.add(mesh); 
```

这不起作用。我得到的只是一个闪烁的三角形（当场景移动时）图像应该在哪里。

要对此进行测试，请访问[https://www.poptents.eu/3dFrame.php](https://www.poptents.eu/3dFrame.php)，在屋顶部分上传一张图片，然后拖动视图以查看屋顶闪烁。

有谁知道我在这里做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T21:36:12.857

您需要阅读一些关于[UV Mapping](http://en.wikipedia.org/wiki/UV_mapping)的内容。您不能使用 (0,0) 将其初始化到所有 4 个角。您需要指定一个介于 0 到 1 之间的数字，它是纹理宽度和高度的百分比。意思是，如果顶点像（左上），（右上），Face4 上的完整纹理将是（0,0），（1,0），（1,1），（0,1）， （右下），（左下）......等等......

# wordpress - 检测是否存在 WordPress 插件

> ID：12238950
> 
> 赞同：1
> 
> 时间：2012-09-02T19:12:00.723
> 
> 标签：wordpress, plugins

有没有办法检测 WordPress 中是否存在插件并输出条件代码？

这就是我想这样做的原因......

我正在使用 WordPress SEO Yoast 插件，并且需要更改默认标题标签以使其正常工作，例如

```
<title>
    <?php
        wp_title( '|', true, 'right' );
    ?>
</title> 
```

需要改成...

```
<title><?php wp_title(''); ?></title> 
```

没关系，但是如果我在某个时候卸载了 SEO Yoast 并忘记将代码切换回来怎么办？为了安全起见，我想要一些条件代码说..

如果存在 SEO Yoast 插件，则更改标题代码，如果没有，则输出默认标题代码。

有没有一种简单的方法可以做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T19:30:11.233

您可以尝试`is_plugin_active`功能（在前端，主题等）

```
<?php 
    include_once( ABSPATH . 'wp-admin/includes/plugin.php' );
    If (is_plugin_active('plugin-directory/plugin-file.php')) {

        //plugin is activated
    }
    else
    {
        //plugin is not activated
    }
?> 
```

[**更多在这里**](http://codex.wordpress.org/Function_Reference/is_plugin_active)。

**更新：**

```
<?php
    include_once( ABSPATH . 'wp-admin/includes/plugin.php' );
    if (is_plugin_active('wordpress-seo/wp-seo.php')) { 
        ?><title><?php wp_title(''); ?></title><?php
    } else {

        ?><title><?php wp_title( '|', true, 'right' ); ?></title><?php
    }
 ?> 
```

# asp.net - Ajax Control / RadEditor 在特定页面上不起作用

> ID：12238954
> 
> 赞同：0
> 
> 时间：2012-09-02T19:13:18.787
> 
> 标签：asp.net, html, ajax, ajaxcontroltoolkit

我在几个页面上使用 AjaxControlKit 和 RadEditor，但问题是 Ajax Control 和 RadEditor 在特定页面上不起作用。

A/B/C/X.aspx 工作

A/B/D/Y.aspx 不工作

我检查了文件夹C和D下的web.config文件，它们完全一样。AjaxControlKit 已添加到文件夹 A 下的全局 web.config 文件中。

非常感谢，

这是我从 Firebug 得到的错误信息

> “NetworkError：500 内部服务器错误 - ....ase.aspx?_TSM_HiddenField_=ctl00_AjaxScriptManager_HiddenField&_TSM_CombinedScripts_=%3b%3bAjaxControlToolkit%2c+Version%3d4.1.51116.0%2c+Culture%3dneutral%2c+PublicKeyToken%3d28f01b0e84b6d53e%3 ％3afd384f95-1b49-47cf-9b47-2fa2a921a36a％3a475a4ef5％3a5546a2b％3ad2e10b12％3aeffe2a26％3a37e2e5c9％3a1d3ed089％3a497ef277％3aa43b07eb％3a751cdd15％3adfad98a5％3a3cf12cf1％3aaddc6819％3a5a682656％3ac7029a2％3ae9e598a9"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-11T15:35:28.390

此问题现已解决。

工具包脚本管理器。组合脚本=“假”

# iphone - 表格视图单元格中来自 Twitter 的个人资料图片

> ID：12238956
> 
> 赞同：0
> 
> 时间：2012-09-02T19:13:54.723
> 
> 标签：iphone, ios, xcode, twitter

> **可能重复：**
> [拉推特个人资料图片](https://stackoverflow.com/questions/2115084/pull-twitter-profile-image)

有谁知道我如何从 Twitter 以及表格视图单元格中获取个人资料图片？我正在使用以下代码来获取用户名和文本。但想要有个人资料图像以获得更好的清晰度。

```
NSDictionary *tweet = [self.results objectAtIndex:indexPath.row];
    cell.textLabel.text = [NSString stringWithFormat:@"%@: %@", [tweet objectForKey:@"from_user"],
                           [tweet objectForKey:@"text"]]; 
```

如果您需要，我会从这里借用代码。

*   [http://useyourloaf.com/blog/2011/06/16/searching-twitter-with-ios.html](http://useyourloaf.com/blog/2011/06/16/searching-twitter-with-ios.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-03T02:46:43.433

如果您已经有了图像，只需执行以下操作：

```
cell.imageView.image = theTwitterImage; 
```

否则，请查看在对您的问题的评论中发布的[链接](https://stackoverflow.com/questions/2115084/pull-twitter-profile-image)@Legolas。（我之前没有使用过 Twitter API，所以我无法帮助您实际获取图像。）

# openoffice.org - 如何在单词间距正常的开放式办公室作家中进行合理对齐？

> ID：12238962
> 
> 赞同：0
> 
> 时间：2012-09-02T19:15:07.680
> 
> 标签：openoffice.org, openoffice-writer

我想为大学写一篇 2 栏论文，标准模板使用如下合理对齐：

> 我的文档 我的文档 我的文档 我的文档 我的文档 我的文档 我的文档 我的文档 我
> 的文档 我的文档 我
> 的文档 我的文档 我的文档。

你知道...但是当我选择对齐而不是左对齐时，单词会变得异常距离以使每行对齐...

我的错是什么？我必须使用特殊选项或模板来修复它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:21:07.610

特德，额外的空间使证明成为可能。Open Office 并不是很聪明，但大多数文字处理器也并不聪明。如果你真的需要它看起来光滑，你应该看看 teX 和 LaTeX，它们使用了一个最佳方案。

如果做不到这一点，您可以尝试玩弄hypenation 和所谓的“字距调整”。只需在帮助中查找“字距调整”即可。

# c# - 带有超链接的 itextsharp 图像

> ID：12238966
> 
> 赞同：3
> 
> 时间：2012-09-02T19:15:43.637
> 
> 标签：c#, itextsharp

我使用 itextsharp 库和 c# 创建了一个带有图像的 pdf。现在我需要在该图像上有一个超链接，以便在单击它时，它会转到特定站点。我该怎么做？我试图找到一个链接到图像对象的属性，但找不到。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-02T19:55:37.747

你必须使用[锚](http://api.itextpdf.com/itext/com/itextpdf/text/Anchor.html)

```
Chunk cImage = new Chunk(yourImage, 0, 0, false); 
Anchor anchor = new Anchor(cImage); 
anchor.Reference = "www.yourAddress.com"; 
document.Add(anchor); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-16T14:22:23.260

对于**iText7**

```
var url = "micorosft.com";
var fbImageData = ImageDataFactory.Create("c:/temp/fb.png");
var fbImage = new Image(fbImageData);
var twImageData = ImageDataFactory.Create("c:/temp/tw.png");
var twImage = new Image(twImageData);

fbImage.SetMaxWidth(16);
fbImage.SetMaxHeight(16);
fbImage.SetAction(PdfAction.CreateURI($"https://www.facebook.com/sharer/sharer.php?u={url}&quote={"quotegoeshere"}"));

twImage.SetMaxWidth(16);
twImage.SetMaxHeight(16);
twImage.SetAction(PdfAction.CreateURI($"https://twitter.com/intent/tweet?text={"randomtextgoeshere"}" + $" {url}")); 
```

# android - 为后台任务和元数据任务优化代码的一些技巧

> ID：12238968
> 
> 赞同：0
> 
> 时间：2012-09-02T19:15:55.367
> 
> 标签：android, android-intent, ogg

请帮助优化我的代码 1）我想在后台处理我的媒体元数据，这样它就不会让我的应用程序崩溃。2）在较慢的互联网连接（如 3g）上，开始流式传输需要超过 10 秒，并且它停留在该按下事件上，直到它播放音乐..所以有时我得到强制关闭对话框，其中有等待或确定按钮强制关闭应用程序所以我也不想发生这种情况。

我想让我的应用程序使用更少的 cpu 和更少的内存......

因此，请查看我的代码并给我示例链接，因为我是开发新手。

```
 super.onCreate(savedInstanceState); 
     setContentView(R.layout.activity_main);
        Button b1 = (Button) findViewById(R.id.button1);
         Timer timer = new Timer();
       timer.schedule(new TimerTask()
       {
           public void run()
           {

   // this is to take metadata from stream so i want do this part in separate task or in background 
               try
               {
                   IcyStreamMeta icy   = new IcyStreamMeta(new URL("http://84.15.135.51:80/mp3/adw"));
                  data  = icy.getArtist() + " - " + icy.getTitle();
                  String temp = null;

                   runOnUiThread(new Runnable()
                   {
                        public void run()
                        {
                            tv.setText(data);

                        }
                   });

               }
               catch (MalformedURLException e)
               {
                   e.printStackTrace();
               }
               catch (IOException e)
               {
                   e.printStackTrace();
               }
           }
       },0,20000);

       mynotification(); // i called notification function to show notification 

    // i have used Vitamio jar and plugin to play ogg stream 

    try {
        mp = new MediaPlayer(this);
    } catch (VitamioNotCompatibleException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (VitamioNotFoundException e1) {

        System.out.println("Install vitamio on your device");
        Intent i = new Intent(this,mp3.class);
        startActivity(i);
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }

    // i want to play media streaming on background and in different task or service so it wont stuck during play . 

    b1.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            swap();

            try {

                    Boolean flag=mp.isPlaying();
                    if(flag==true)
                    {   
                        mp.reset();

                    }

                mp.setDataSource(link1);                       mp.setWakeMode(getApplicationContext(),     
                  PowerManager.SCREEN_DIM_WAKE_LOCK);   

                mp.prepare();
                mp.setOnPreparedListener(new OnPreparedListener() {

                    @Override
                    public void onPrepared(MediaPlayer arg0) {
                        // TODO Auto-generated method stub
                        progressDialog.dismiss();
                        mp.start(); 

                    }
                });

            } catch (IllegalArgumentException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IllegalStateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }
    });@Override  
public void onBackPressed()
{
Log.d("CDA", "onBackPressed Called");
Intent setIntent = new Intent(Intent.ACTION_MAIN);
setIntent.addCategory(Intent.CATEGORY_HOME);
setIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(setIntent); 

return;
}
     // I am taking metadata data like title of track and show on notification.i want to show continuous notification until app exit

@SuppressWarnings("deprecation")
void mynotification()
    {
 nm=(NotificationManager)getSystemService(NOTIFICATION_SERVICE);
Intent intent = new Intent(this,MainActivity.class);
intent.addFlags(Intent.FLAG_ACTIVITY_LAUNCHED_FROM_HISTORY);    
PendingIntent pi= PendingIntent.getActivity(this, 0, intent, 0);
 String title = "radio";
 Notification n = new Notification(R.drawable.noti, data, System.currentTimeMillis());
 n.setLatestEventInfo(this , title, data, pi);
 n.defaults=Notification.DEFAULT_ALL;
 nm.notify(uniid,n);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T19:24:08.120

利用

```
mp.prepareAsync(); 
```

代替

```
mp.prepare(); // runs on main thread 
```

# java - 应用程序服务器如何跟踪 HttpSession 对象和客户端？

> ID：12238969
> 
> 赞同：1
> 
> 时间：2012-09-02T19:15:58.790
> 
> 标签：java, jakarta-ee, servlets, httpsession

应用程序服务器如何跟踪哪个客户端与哪个 HttpSession 对象相关联？是否与跟踪客户端之间的 TCP/IP 连接有关？或者饼干？我怀疑它是 cookie，因为有一种单独的方法可以提取 cookie。

**背景**

我知道 servlet 和 JSP 可以调用 request.getSession() 来获取与客户端关联的 HttpSession 对象。我很好奇当客户端请求新页面时服务器如何知道返回相同的对象。我四处搜索，我找到的所有文档都是关于如何提取会话信息的。我感兴趣的是服务器如何将会话信息与它可以访问的大量客户端数据隔离开来。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-02T19:18:59.827

> 我怀疑是饼干

这是！在无状态 HTTP 协议和 servlet 中，基本上有两种方法可以跟踪用户会话：`JSESSIONID`cookie 或 URL 重写。后者在 cookie 不可用时使用。

使用第一个响应 servlet 容器在客户端设置以下 cookie：

```
Set-Cookie: JSESSIONID=25E7A6C27095CA1F560BCB2983BED17C; Path=/; HttpOnly 
```

每个后续请求都包含这个 cookie，servlet 容器使用它来提供正确的`HttpSession`. `JSESSIONID`您可以使用 servlet API 直接访问此 cookie，甚至可以在或其他一些 cookie之上构建自己的会话机制。但是 servlet 容器会为您做到这一点。

# 也可以看看

*   [为什么启用 cookie 时 jsessionid 会出现在 Wicket URL 中？](https://stackoverflow.com/questions/6808331)- 有关 servlet 容器如何区分 cookie 和 URL 重写的一些技术细节

# node.js - 当消息名为“next_round”时，socket.io 服务器端停止发送消息

> ID：12238972
> 
> 赞同：1
> 
> 时间：2012-09-02T19:16:39.097
> 
> 标签：node.js, websocket, socket.io

我在 node.js 0.8.8 上使用 socket.io v9，最新的 Chrome 作为客户端。

我看到了一个非常奇怪的行为，昨天我花了大部分的 Indie Game Jam 来缩小范围。

问题发生在这部分服务器代码中：

```
this.msg('message', {message:'beta'});
this.msg('next_round', {players: this.make_player_list()});
this.msg('message', {message:'zeta'}); 
```

"this.msg" 是一个包装器，用于遍历套接字列表并在它们上调用 socket.emit()。

在此代码之前和之后也会发送消息。

在客户端上，我将看到直到并包括“消息”/“测试版”消息的所有消息。'next_round' 消息，以及在同一套接字上的任何消息，将不会在客户端上看到。

现在，奇怪的是：如果我将消息的名称更改为“nnnn_round”（并更新客户端上的消息处理程序连接），“nnnn_round”和之后的所有消息都可以正常通过。

因此，似乎一条名为“next_round”的消息会阻塞 socket.io 的服务器端机制。请注意，节点/套接字端的调试输出不显示正在写入套接字的 next_round 消息，但它确实显示了正在写入套接字的 nnnn_round 消息。

是否有任何文档可以解释这种行为？我在 socket.io 上找不到任何东西（无论如何它没有太多文档），并且在 socketio 模块源中对“next_round”的 grepping 出现了 emtpy。

# c# - 奇怪的“方法的类型参数不能从用法中推断出来。”

> ID：12238973
> 
> 赞同：0
> 
> 时间：2012-09-02T19:16:46.110
> 
> 标签：c#, text, slimdx

我正在努力实现一些代码以在 SlimDX 中的 D3D10 和 D3D11 之间共享纹理。

此方法导致问题：

```
 public void InitialiseTextureSharing()
    {
        // A DirectX10 Texture2D sharing the DirectX11 Texture2D
        sharedResource = new SlimDX.DXGI.Resource(textureD3D11);
        textureD3D10 = device10_1.OpenSharedResource(sharedResource.SharedHandle);  // This fails to compile! 

    } 
```

我从编译器收到以下错误：

无法从用法中推断方法“SlimDX.Direct3D10.Device.OpenSharedResource(System.IntPtr)”的类型参数。尝试明确指定类型参数。

奇怪的事情（对我来说）是，这段代码是直接从其他人那里移植过来的，这应该可以工作。原始代码是：

```
 // A DirectX10 Texture2D sharing the DirectX11 Texture2D
        SlimDX.DXGI.Resource sharedResource = new SlimDX.DXGI.Resource(textureD3D11);
        SlimDX.Direct3D10.Texture2D textureD3D10 = device10_1.OpenSharedResource(sharedResource.SharedHandle); 
```

我的实现的不同之处在于我在 SlimDX 表单中实例化了“sharedResource”和“textureD3D10”对象。

我当然没想到会出现编译错误。我基于此的代码来自：[http](http://www.aaronblog.us/?p=36) : //www.aaronblog.us/?p=36 ...这是关于使用 DX11 在 SlimDX 中绘制文本的全部内容。

我完全被这件事难住了。我看过一些帖子，其中包含类似问题的解决方案，但目前我无法适应我的情况。

任何指针都会受到赞赏。

更新：

SlimDX API 文档中 OpenSharedResource 的签名：

[http://slimdx.org/docs/html/M_SlimDX_Direct3D11_Device_OpenSharedResource__1.htm](http://slimdx.org/docs/html/M_SlimDX_Direct3D11_Device_OpenSharedResource__1.htm)

...和资源： [http ://slimdx.org/docs/html/T_SlimDX_DXGI_Resource.htm](http://slimdx.org/docs/html/T_SlimDX_DXGI_Resource.htm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T21:37:55.417

根据文档，您收到错误的原因是代码错误。OpenSharedResource 接受一个通用参数，指定要返回的类型，所以它应该是

```
SlimDX.Direct3D10.Texture2D textureD3D10 = device10_1.OpenSharedResource<SlimDX.Direct3D10.Texture2D>(sharedResource.SharedHandle); 
```

在 HTML 中，`<`用于`>`元素；正因为如此，代码片段在人们的博客上过滤掉它们的通用参数而没有任何人意识到的情况并不少见。在这种情况下，您需要自己重新插入它们。

# python - 从 ruby (rails) 调用 python shell 应用程序

> ID：12238977
> 
> 赞同：0
> 
> 时间：2012-09-02T19:17:02.663
> 
> 标签：python, ruby

如何从 ruby​​ 调用在 shell 中运行的 python。实际上，我需要 ruby​​ 与在 shell 中的 python 下运行的一些应用程序进行通信。所以我需要ruby在cmd中调用python（命令'python'），然后在python环境下导入库（命令'import xyz'），然后运行这个导入库的函数（例如'xyz.showdate（）'） ，当然得到结果。

我尝试使用 IO.popen 和 Open3.popen3 函数来实现这一点，但我做错了。

实际上我在rails上使用jruby，但我猜它应该和ruby一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:59:54.157

你可能真的不想这样做，这会使你的 ruby​​ 脚本过于复杂，而你可能可以直接在 ruby​​ 中得到结果。

但是，如果您决定采用这种方式，则可以创建一个执行所需操作的 python 脚本并从 ruby​​ 脚本运行它：

```
# python-script.py 
import xyz
if __name__ == '__main__':
    xyz.showdate() 
```

然后，您将安排您的 ruby​​ 脚本调用以下命令：

```
python path/to/python-script.py 
```

如果您`xyz.showdate`打印日期，您可以收集标准输出以获得结果。

但同样，这可能不是一个好主意。

# jsp - 使用 jsp 将图像上传到 DB2 数据库

> ID：12238980
> 
> 赞同：1
> 
> 时间：2012-09-02T19:17:42.433
> 
> 标签：jsp, db2, image-upload

嗨，我正在做我最后一年的项目，这是使用移动短信的在线图书销售管理系统。DB2 是我正在使用的数据库。我需要有关使用 jsp 或 servlet 将图像上传到我的数据库的帮助，反之亦然。请帮忙。我一直在寻找它，但我无法理解所使用的概念。任何机构都可以帮助我获得任何类型的资源或推荐我关于这个主题的书。有很多关于 PHP 的书，但不是针对 JSP 的 :( -thaks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-14T04:39:55.320

您的 JSP 将需要使用几乎所有 Java 程序都用于数据库访问的标准 JDBC API 与数据库交互的 Java 代码。DB2 提供了一个符合 JDBC 标准的轻量级 JCC Type 4 通用驱动程序，而无需在 Java EE 服务器上安装完整的 DB2 客户端。在您的 Java 代码中的某处（可能在您的 JSP 引用的一个或多个专用 POJO 类中），您将开发将连接到 DB2 数据库并执行 SQL 语句的方法。由于单个图像可能超过 32K 的最大列大小，因此您需要将图像列定义为使用 BLOB 数据类型，该数据类型可能存储大量二进制数据。写入和检索 BLOB 和 CLOB 数据需要使用专门的 JDBC 函数，这些函数不是

# php - 在谷歌地图上显示所有搜索到的位置结果

> ID：12238981
> 
> 赞同：-1
> 
> 时间：2012-09-02T19:17:46.687
> 
> 标签：php, javascript, jquery, html, google-maps

我在其中使用 Google 地图创建了一个 Web 应用程序。我需要知道如何实现，当我使用 php 搜索某个位置并在 php array() 中得到结果时，包含不同位置坐标（纬度经度）的数组结果显示在地图上 + 关注地图视图中的这些坐标......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T20:45:02.543

您需要创建一个 GBound 并在稍后使用 extend() 方法创建所有要点。 [https://developers.google.com/maps/documentation/javascript/v2/reference#GBounds](https://developers.google.com/maps/documentation/javascript/v2/reference#GBounds)

然后使用 map.fitBounds() 方法在这些点上设置视图。 [https://developers.google.com/maps/documentation/javascript/reference](https://developers.google.com/maps/documentation/javascript/reference)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-02T19:29:41.287

如果您不需要地图滚动，请使用 Google 静态地图 API： [https ://developers.google.com/maps/documentation/staticmaps/](https://developers.google.com/maps/documentation/staticmaps/)

将`<img>`标签添加到您的 HTML 中，源代码格式如下： `https://maps.googleapis.com/maps/api/staticmap?center=LAT,LONG&amp;zoom=14&amp;size=288x200&amp;sensor=false"`

这将返回以您指定的坐标为中心的地图图像。

# grails - 检索数据库 grails 中的整行

> ID：12238988
> 
> 赞同：0
> 
> 时间：2012-09-02T19:18:30.840
> 
> 标签：grails, groovy

我的数据库中有一个名为“District”的表：

```
+----+---------+-------------+----------+------+------------------------------------------------+-----------+
| id | version | description | homepage | logo | name                                           | region_id |
+----+---------+-------------+----------+------+------------------------------------------------+-----------+ 
```

所以，在我的控制器上，我有：

```
def show = {
        def districtInstance = District.get(params?.id)
        println districtInstance
        println params
        if(!districtInstance){
            flash.message = "${message(code: 'default.not.found.message', args: [message(code: 'district.label', default: 'District'), params.id])}"
            redirect(action : "list", params?.id)
        }
        else{
            [districtInstance : districtInstance]
        }
    } 
```

虽然我期待看到完整的行：

```
| 71 |       0 | bogus  |          |      | bogus                                      |         4 | 
```

我只看到：

```
bogus 
```

在控制台上。我怎样才能访问整行？（特别`districtInstance.region_id`？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-02T20:11:30.473

`println districtInstance`只打印`toString()`方法的输出。用于`println districtInstance?.dump()`查看更多输出，包括所有类字段。然而，它看起来不像数据库视图，因为它是一个 Groovy 对象，而不是数据库查询结果。

根据问题更新：如果您需要 region_id，您可以通过`districtInstance.regionId`它获取它，不需要额外的数据库调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-02T20:23:00.350

```
println districtInstance?.region.id 
```

在 Groovy 和一般的面向对象语言中，您可以像这样*导航*类属性，但您应该了解得[墨忒耳法则](https://stackoverflow.com/questions/163071/coupling-cohesion-and-the-law-of-demeter)

# c# - 使用 Shopify API 将 JSON 反序列化为 C# 对象

> ID：12238995
> 
> 赞同：1
> 
> 时间：2012-09-02T19:19:33.813
> 
> 标签：c#, shopify

我想将 Shopify API 调用的 JSON 输出转换为可以在 C# 中操作的对象。

这是我到目前为止的代码

```
1 var client = new ShopifyAPIClient(new ShopifyAuthorizationState { AccessToken = token, ShopName = shopName });
2 var orders = JsonConvert.DeserializeObject((string)client.Get("/admin/orders.json"));
3 
4 foreach(object order in orderss){
5  // do stuff with member variables of object
6 } 
```

第 4 行错误：*类型“对象”不可枚举*

[此](http://api.shopify.com/order.html#index)页面具有返回的 JSON 对象的格式。

[此页面有一个示例，说明如何将 JSON 反序列化为定义](http://james.newtonking.com/projects/json/help/index.html?topic=html/SerializingJSON.htm)**了**类的 C# 对象

有什么方法可以将 JSON 反序列化为 C# 对象，无需定义类即可枚举？如果没有，是否在某个地方定义了 Shopify 类，我可以将它们复制到我的项目中？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T19:25:59.730

它在根对象下有另一个`orders`对象。尝试

```
dynamic dynObj = JsonConvert.DeserializeObject(json);
foreach (var order in dynObj.orders)
{
    Console.WriteLine("{0}  {1}", 
                        (string)order.email, 
                        (string)order.payment_details.credit_card_number);
} 
```