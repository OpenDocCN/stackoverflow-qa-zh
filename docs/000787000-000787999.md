# StackOverflow 问答 000787000-000787999

# c# - 在 Func 中使用 new

> ID：787000
> 
> 赞同：2
> 
> 时间：2009-04-24T18:17:38.240
> 
> 标签：c#, generics, function, delegates

我想知道，在阅读[了这个问题](https://stackoverflow.com/questions/786890/generic-way-to-find-or-create-an-object-in-linq-to-sql/786932#786932)之后......他有这个代码：

```
public static T FindOrCreate<T>(this Table<T> table, Func<T, bool> find) 
    where T : new()
{
    T val = table.FirstOrDefault(find);
    if (val == null)
    {
        val = new T();
        table.InsertOnSubmit(val);
    }
    return val;
} 
```

是否可以将该新项目作为另一个 Func 发送？我的意思是，当然会。但是，那会已经创建了吗？还是在您实际运行 Func 时首先创建它？假设你有这个：

```
public static T FindOrCreate<T>(this Table<T> table, Func<T, bool> find, Func<T> replacement) 
    where T : new()
{
    T val = table.FirstOrDefault(find);
    if (val == null)
    {
        val = replacement();
        table.InsertOnSubmit(val);
    }
    return val;
} 
```

然后通过这样做来调用它：

```
var invoiceDb = ctx.Invoices.FindOrCreate(a => a.InvoicerId == InvoicerId
                                            && a.Number == invoiceNumber,
                                          () => new Invoice());
invoiceDb.Number = invoiceNumber; 
```

如果找到该发票，是否会创建该新发票？还是该代码在实际调用该函数之前才运行？或者它是如何工作的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T18:20:47.793

`replacement`在实际调用该函数并且发现表中缺少该值之前，不会运行其中的代码。

顺便说一句，如果您按照说明实现这一点，这是完全合理的——您可能希望`where T : new()`从函数中删除 " " 约束，因为它不再需要；你给它所有关于如何构建一个相当明确的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T18:22:04.843

在这种情况下，您将传递一个委托，因此

```
() => new Invoice() 
```

代码不会被调用，直到

```
val = replacement(); 
```

线

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T18:22:42.220

不，不会创建新发票。Func 只是一个委托，因此当您创建 lambda: () => new Invoice() 时，它实际上与执行此操作相同：

```
public Invoice Create()
{
   return new Invoice();
} 
```

并将委托传递给 Create 方法。只有在您实际*执行*委托（“创建”函数）后，该代码才会真正运行，从而创建发票。

# c# - 我可以将构造函数参数传递给 Unity 的 Resolve() 方法吗？

> ID：787001
> 
> 赞同：93
> 
> 时间：2009-04-24T18:18:16.413
> 
> 标签：c#, .net, dependency-injection, unity-container, constructor-injection

我正在使用 Microsoft 的 Unity 进行依赖注入，我想做这样的事情：

```
IDataContext context = _unityContainer.Resolve<IDataContext>();
var repositoryA = _unityContainer.Resolve<IRepositoryA>(context); //Same instance of context
var repositoryB = _unityContainer.Resolve<IRepositoryB>(context); //Same instance of context

IDataContext context2 = _unityContainer.Resolve<IDataContext>(); //New instance
var repositoryA2 = _unityContainer.Resolve<IRepositoryA>(context2); 
```

`RepositoryA`并且`RepositoryB`两者都有一个带`IDataContext`参数的构造函数，我希望 Unity 使用我传递的上下文初始化存储库。另请注意，`IDataContext`未在 Unity 中注册（我不想要 3 个实例`IDataContext`）。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-09-21T23:52:47.660

截至今天，他们已经添加了这个功能：

这是最新的下降：

[http://unity.codeplex.com/SourceControl/changeset/view/33899](http://unity.codeplex.com/SourceControl/changeset/view/33899)

在这里讨论它：

[http://unity.codeplex.com/Thread/View.aspx?ThreadId=66434](http://unity.codeplex.com/Thread/View.aspx?ThreadId=66434)

例子：

```
container.Resolve<IFoo>(new ParameterOverrides<Foo> { { "name", "bar" }, { "address", 42 } });" 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-04-24T18:48:02.097

< 2 美分>

如果您后来决定使用需要更多或更少不仅仅是上下文的不同服务怎么办？

构造函数参数和 IoC 的问题在于，参数最终与所使用的具体类型相关联，而不是作为服务接口定义的契约的一部分。

我的建议是你要么解决上下文，我相信 Unity 应该有办法让你避免构造它的 3 个实例，或者你应该考虑一个工厂服务，它可以让你构造对象。

例如，如果您稍后决定构建一个完全不依赖传统数据库的存储库，而是使用 XML 文件为测试生成虚拟数据，该怎么办？您将如何将 XML 内容提供给该构造函数？

IoC 基于解耦代码，通过将参数的类型和语义绑定到具体类型，您确实没有正确地完成解耦，仍然存在依赖关系。

“此代码可能与任何类型的存储库通信，只要它实现此接口......哦，并使用数据上下文”。

现在，我知道其他 IoC 容器对此有支持，我自己的第一个版本中也有它，但在我看来，它不属于解决步骤。

</2 美分>

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-10-29T15:43:22.737

谢谢大家...我的类似于“存在”的帖子。见下文：

```
 IUnityContainer container = new UnityContainer();
        container.LoadConfiguration();

        _activeDirectoryService = container.Resolve<IActiveDirectoryService>(new ResolverOverride[]
        {
            new ParameterOverride("activeDirectoryServer", "xyz.adserver.com")
        }); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2010-04-28T19:02:06.330

您可以根据 ResolvedParameter< T >("name") 中的注入架构使用 InjectionConstructor / InjectionProperty / InjectionMethod 来获取容器中预注册对象的实例。

在您的情况下，此对象必须使用名称注册，并且同样需要 ContainerControlledLifeTimeManager() 作为 LifeTimeManager。

```
_unityContainer.RegisterType<IDataContext,DataContextA>("DataContextA", new ContainerControlledLifeTimeManager());
_unityContainer.RegisterType<IDataContext,DataContextB>("DataContextB");

  var repositoryA = _unityContainer.Resolve<IRepositoryA>(new InjectionConstructor(
new ResolvedParameter<IDataContext>("DataContextA")));

  var repositoryB = _unityContainer.Resolve<IRepositoryB>(new InjectionConstructor(
new ResolvedParameter<IDataContext>("DataContextA")));

  var repositoryA2 = _unityContainer.Resolve<IRepositoryA>(new InjectionConstructor(
new ResolvedParameter<IDataContext>("DataContextB"))); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-29T12:54:17.740

非常简短的回答是：不。Unity 目前无法将参数传递给我能够找到的非常量或注入的构造函数。恕我直言，这是它缺少的最大的东西，但我认为这是设计而不是遗漏。

正如 Jeff Fritz 所指出的，理论上您可以创建一个自定义生命周期管理器，它知道将哪个上下文实例注入到各种类型中，但这是一种硬编码，它似乎首先排除了使用 Unity 或 DI 的目的。

您可以从完整的 DI 退后一步，让您的存储库实现负责建立自己的数据上下文。上下文*实例*仍然可以从容器中解析，但决定使用哪一个的逻辑必须进入存储库的实现。当然，它不是那么纯粹，但它会解决这个问题。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-15T12:02:27.970

您可以使用的另一种选择（不知道这是否是一个好习惯）是创建两个容器并为每个容器注册一个实例：

```
IDataContext context = _unityContainer.Resolve<IDataContext>();
_unityContainer.RegisterInstance(context);
var repositoryA = _unityContainer.Resolve<IRepositoryA>(); //Same instance of context
var repositoryB = _unityContainer.Resolve<IRepositoryB>(); //Same instance of context

//declare _unityContainer2
IDataContext context2 = _unityContainer2.Resolve<IDataContext>(); //New instance
_unityContainer2.RegisterInstance(context2);
var repositoryA2 = _unityContainer2.Resolve<IRepositoryA>(context2); //will retrieve the other instance 
```

希望这也有帮助

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-28T10:18:17.360

NotDan，我想你可能已经在对 lassevk 的评论中回答了你自己的问题。

首先，我将使用 LifetimeManager 来管理 Unity 创建的 IDataContext 实例的生命周期和数量。
[http://msdn.microsoft.com/en-us/library/cc440953.aspx](http://msdn.microsoft.com/en-us/library/cc440953.aspx)

听起来该`ContainerControlledLifetimeManager`对象将为您提供所需的实例管理。有了 LifetimeManager，Unity 应该将相同的 IDataContext 实例添加到所有需要 IDataContext 依赖项的对象。

# c# - C# 理论：将 JMP 写入 asm 中的 codecave

> ID：787006
> 
> 赞同：6
> 
> 时间：2009-04-24T18:19:41.387
> 
> 标签：c#, assembly, codecave

假设我已经分配了放置我的 codecave 的地址`VirtualAllocEx`（它返回地址），并且我使用`WriteProcessMemory()`.

这是问题：

我如何写一个跳转到我的codecave？我知道跳转以“ `E9`”开头，但是如何将返回的地址转换`VirtualAllocEx`为正确的 UInt32（dword），以便调试器/编译器理解指令？

例如：

我在地址`00402020`（本机应用程序的 OEP）。我写了一个跳转到`004028CF`（空白处）“ `JMP 004028CF`”。以字节为单位的指令如下所示：

```
CPU Disasm
Address   Hex dump      Command                                  Comments
00402020  E9 AA080000   JMP 004028CF 
```

“ `E9`”是我们表示 JMP 的方式。那么“ `AA080000`”呢，我如何生成这个？

我需要做一些类似的事情，这样我就可以将 JMP 初始化到我的 codecave，它将位于由`VirtualAllocEx()`.

任何帮助将不胜感激！

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T18:35:06.433

E9 是相对跳转，因此后面的 32 位只是当前指令指针的偏移量。有关详细信息，请参阅[英特尔® 64 和 IA-32 架构软件开发人员手册第 2A 卷：指令集参考，AM](http://download.intel.com/design/processor/manuals/253666.pdf)第 549 页。有关详细信息，请参阅[英特尔® 64 和 IA-32 架构软件开发人员手册](http://www.intel.com/products/processor/manuals/)。

所以从 00402020 跳转到 004028CF 的操作码应该如下。

```
    E9 00 00 08 AA

```

```
Offset   = DestinationAddress - CurrentInstructionPointer
000008AA = 004028CF           - 00402025 
```

执行跳转指令时，指令指针已经设置为下一条指令。所以跳转指令的偏移量和当前指令指针值相差5。

```
CurrentInstructionPointer = AddressOfJumpInstruction + 5 
```

**更新**

更正了有关当前指令指针值的错误。谢谢jn。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-10T09:29:27.293

要获得相对偏移量，只需减去地址：

```
uint32_t patch_address = (uint32_t) VirtualAlloc(...);
uint32_t jmp_offset = patch_address - (current_offset + current_len); 
```

注意：current_len 在 x86 E9 JMP 指令上为 5 个字节。有关更多信息，请参阅我在此线程上的帖子：

[VirtualAlloc C++，注入 dll，asm](https://stackoverflow.com/questions/5242720/virtualalloc-c-injected-dll-asm/7004228#7004228)

# user-interface - 你把这个用户界面控件叫做什么？

> ID：787013
> 
> 赞同：3
> 
> 时间：2009-04-24T18:21:26.110
> 
> 标签：user-interface, listbox

这个界面控件叫什么。

您有 2 个列表，其中一个列表用作您的池，另一个用作您的当前值。看起来像这样

```
[1    ]               [1     ]
[2    ]     Add>>     [2     ]
[3    ]   Add All>>   [      ]
[4    ]    <Remove    [      ]
[5    ] <<Remove All  [      ]
[6    ]               [      ] 
```

无论操作如何，源列表都不会改变。

非常感谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T18:48:57.603

根据 Alan Cooper 在 About Face 中的说法，它被称为收藏家。Sari Laasko 在她的[画廊里说双重名单](http://www.cs.helsinki.fi/u/salaakso/patterns/Double-List.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T18:25:05.867

池和当前值列表小部件

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T18:31:02.403

订购的多选小工具

或者

两个列表四个按钮的盛会

促进评论回答：

我建议在列表之间移动项目的位置调用控制：Ping Pong，而这个：Ping Pong against a wall

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T18:43:01.190

我以前见过这个叫做**LeftRightMultiSelect**或类似的东西。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T18:52:57.703

它可能在不同的环境中称为不同的东西。在 struts2 中有一个称为**optiontransferselect**的 UI 小部件，它可以执行您所描述的操作。我确定在桌面环境中以不同的名称调用同一事物。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-24T18:46:17.920

静态左多选控件

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-24T18:48:31.380

字体/DA 移动器

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-24T19:34:54.527

“分选控制”？

# python - 站点包适用于应用程序还是仅适用于库？

> ID：787015
> 
> 赞同：5
> 
> 时间：2009-04-24T18:22:20.303
> 
> 标签：python

我正在与其他一些开发人员就一个开源项目进行一些讨论。我是 python 新手，但在我看来，站点包是用于库而不是最终用户应用程序。这是真的还是站点包是安装最终用户运行的应用程序的合适位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T19:18:15.440

我们这样做。

我们下载的大多数东西都在站点包中。它们来自`pypi`或 Source Forge 或其他一些外部来源；它们很容易重建；它们被高度重用；他们变化不大。

我们写的东西必须在其他位置（通常在`/opt`, 或下`c:\opt`）并且包含在`PYTHONPATH`.

没有*很好的*理由将我们的东西拒之门外`site-packages`。然而，我们无力的借口是我们的东西变化很大。几乎不断。每次我们认为我们有更好的东西时重新安装站点包有点痛苦。

由于我们在工作目录或 SVN 签出目录中进行测试，因此我们的测试环境大量使用`PYTHONPATH`.

将流血的开发使用`PYTHONPATH`转移到生产中。我们使用 a`setup.py`进行生产安装，但安装到备用主目录下`/opt`并将 设置`PYTHONPATH`为包含`/opt/ourapp-1.1`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T11:58:15.583

一旦你的应用程序准备好分发，就可以将它打包到你最喜欢的发行版/操作系统中，将你的库代码放在站点包和系统路径上的可执行脚本中。

在那之前（即对于所有开发工作），不要做上述任何事情：省去你的大麻烦，并使用[zc.buildout](http://pypi.python.org/pypi/zc.buildout)或[virtualenv](http://pypi.python.org/pypi/virtualenv)来保持你的开发代码（如果你喜欢，它的依赖项）与系统的其余部分。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T18:58:55.300

最终用户运行的程序通常位于其路径中的某个位置，大部分代码位于模块目录中，该目录通常位于站点包中。

许多 python 程序在路径中都有一个小脚本，用于导入模块，并调用“main”方法来运行程序。这允许程序员进行一些前期检查，并可能在需要时修改 sys.path 以找到所需的模块。这也可以加快大型程序的加载时间，因为只有导入的文件才会从字节码运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T19:19:54.830

Site-packages 绝对是用于库的。

混合方法可能有效：您可以在站点包中安装应用程序所需的库，然后将主模块安装在其他地方。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T04:54:16.540

如果您可以将应用程序的一部分转换为库并提供 API，那么 site-packages 是一个很好的地方。这实际上是有多少 python 应用程序这样做。

但从用户或管理员的角度来看，这实际上并不是问题所在。问题是我们如何管理已安装的东西。安装后如何升级和卸载？

我使用 Fedora。如果我使用它附带的 python，我不喜欢将东西安装到 RPM 系统之外的站点包中。在某些情况下，我自己构建了 rpm 来安装它。

如果我在 RPM 之外构建自己的 python，那么我自然想使用 python 的机制来管理它。

第三种方法是使用 easy_install 之类的东西来安装这样的东西，例如作为用户到主目录。

所以

*   允许打包分发。
*   允许选择要使用的 python。
*   允许使用您无权访问站点包的分发版安装的 python。
*   允许使用安装在可以使用站点包的分发外部的 python。

# c# - C# - 使用泛型进行反射：IList 嵌套集合的问题

> ID：787018
> 
> 赞同：1
> 
> 时间：2009-04-24T18:22:54.793
> 
> 标签：c#, generics, reflection, nested, ilist

我希望能够打印对象属性，但当我点击 iList 的嵌套集合时遇到了障碍。

```
foreach (PropertyInformation p in properties)
            {
                //Ensure IList type, then perform recursive call
                if (p.PropertyType.IsGenericType)
                {
                         //  recursive call to  PrintListProperties<p.type?>((IList)p,"       ");
                } 
```

任何人都可以提供一些帮助吗？

干杯

K A

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T18:31:25.490

我只是在这里大声思考。也许你可以有一个看起来像这样的非通用 PrintListProperties 方法：

```
private void PrintListProperties(IList list, Type type)
{
   //reflect over type and use that when enumerating the list
} 
```

然后，当您遇到嵌套列表时，请执行以下操作：

```
if (p.PropertyType.IsGenericType)
{
   PringListProperties((Ilist)p,p.PropertyType.GetGenericArguments()[0]);
} 
```

再说一次，还没有测试过，但试一试......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T18:34:04.423

```
foreach (PropertyInfo p in props)
    {
        // We need to distinguish between indexed properties and parameterless properties
        if (p.GetIndexParameters().Length == 0)
        {
            // This is the value of the property
            Object v = p.GetValue(t, null);
            // If it implements IList<> ...
            if (v != null && v.GetType().GetInterface("IList`1") != null)
            {
                // ... then make the recursive call:
                typeof(YourDeclaringClassHere).GetMethod("PrintListProperties").MakeGenericMethod(v.GetType().GetInterface("IList`1").GetGenericArguments()).Invoke(null, new object[] { v, indent + "  " });
            }
            Console.WriteLine(indent + "  {0} = {1}", p.Name, v);
        }
        else
        {
            Console.WriteLine(indent + "  {0} = <indexed property>", p.Name);
        }
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-24T18:28:19.587

```
p.PropertyType.GetGenericArguments() 
```

会给你一个类型参数的数组。（在这种情况下，只有一个元素， T in `IList<T>`）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-03-14T18:06:36.853

```
var dataType = myInstance.GetType();
var allProperties = dataType.GetProperties(BindingFlags.Public | BindingFlags.Instance);
var listProperties =
  allProperties.
    Where(prop => prop.PropertyType.GetInterfaces().
      Any(i => i == typeof(IList))); 
```

# delphi - 如何刷新 TFileStream？

> ID：787019
> 
> 赞同：18
> 
> 时间：2009-04-24T18:23:01.860
> 
> 标签：delphi, buffer, flush, tfilestream

TFileStream 提供缓冲输出，这在大多数情况下都很棒，但在某些情况下（尤其是在调试期间）最好立即刷新缓冲区。问题是，除了调用 Free 之外，我不知道有任何方法可以做到这一点，这会适得其反。

有更好的方法吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-04-24T18:30:52.560

您需要刷新流。尝试：

```
 FlushFileBuffers(fs.Handle); 
```

? 你看到/尝试过这个吗？

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-24T20:59:31.640

这有点复杂，但实际上您可以在调用 (win32 api) CreateFile 时控制很多这种行为。您可以使用或向缓存系统添加`FILE_FLAG_WRITE_THROUGH`/`FILE_FLAG_NO_BUFFERING`甚至提供优化提示。要以这种方式使用 TFileStream，我认为您需要覆盖 Create 以更改它获取文件句柄的方式。FWIW，FlushFileBuffers 相当于文件的关闭/打开。如果您通过重复刷新进行大量活动，则会大大减慢代码速度。`FILE_FLAG_SEQUENTIAL_SCAN``FILE_FLAG_RANDOM_ACCESS`

[这里](http://support.microsoft.com/kb/99794)有一些文档

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-04-24T18:47:15.827

我认为 altCognito 的答案（FlushFileBuffers）可能是最好的，但这只是因为 TFileStream 本身没有缓冲。对于其他缓冲流，应首先查看流是否提供了 Flush 方法。作为最后的手段，您可能会使用 Seek(Begin) 然后 Seek(CurrentPos) 的旧技巧。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-12T15:59:10.493

您是使用 TWriter/TReader 还是直接使用 TFileStream 接口？TReader 和 TWriter 有内部缓冲区。但是对于普通的文件流，上面的回复对其进行了排序。我个人会使用直接处理它的方法来实现我自己的流。

# c# - 线程安全的 Form.Show

> ID：787023
> 
> 赞同：1
> 
> 时间：2009-04-24T18:25:05.147
> 
> 标签：c#, winforms, multithreading

我正在编写一个需要线程安全的 Toast，因为它用于报告异步套接字输入的状态。我试图使它成为线程安全的，但 toasts 仍然被锁定。

```
 public static void Show( string message ) {
        Toast toast = new Toast( message );
        toast.ShowAction();
    }

    private delegate void InvokeCallback();

    public void ShowAction() {
        if ( InvokeRequired ) {
            Invoke( new InvokeCallback( ShowAction ) );
        }
        else {
            Show();
        }
    } 
```

我希望能够像消息框一样轻松地显示它们，即`Toast.Show("Status changed");`. 任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T18:28:46.747

`Toast`您的问题是在另一个线程上创建的事实。您可能需要做的是在主 UI 线程上有一个“目标”，您可以`Invoke()`在其中创建和显示`Toast`，将所有 UI 保持在同一个线程上。

**编辑**

如果您需要能够将其保留在另一个线程上，您唯一的其他选择是创建另一个带有消息循环的线程。

```
Thread t = new Thread();

t.SetApartmentState(ApartmentState.STA) // Required for a UI thread 
```

至于向这个线程发送任务和消息的实现，我会留给你。您需要`Application.Run()`在它开始时调用以启动您的消息循环。

而且，与往常一样，您必须确保`Invoke()`您的 Toast（或此线程上的任何内容）中可能与主 UI 线程交互的任何操作。

# apache-flex - AdvancedDataGrid LockedRowCount 不起作用

> ID：787039
> 
> 赞同：0
> 
> 时间：2009-04-24T18:28:30.677
> 
> 标签：apache-flex, flex3, advanceddatagrid

我正在尝试锁定我的 ADG 中的第一行。第一行是 SummaryRow。当我将lockedRowCount 属性设置为1 时，它仍然不会冻结第一行。我尝试了不同的数字，但它仍然无法正常工作。实际上，当我尝试跟踪lockedRowCount 的值时，它会将其跟踪为0。任何人都可以提供有关如何使用lockedRowCount 属性执行此操作的建议，或者如果您可以为我提供另一种解决方法，那就太好了。

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-08-12T13:42:45.353

我认为你使用分层数据作为数据提供者，如果数据提供者是 HierarchicalData 类型，你不能锁定高级数据网格

# streaming - 使用 DirectShow 和 Windows Media Format SDK 进行直播

> ID：787040
> 
> 赞同：1
> 
> 时间：2009-04-24T18:28:40.520
> 
> 标签：streaming, directshow, asf

首先，一些背景知识：
我正在开发 Silverlight 3 应用程序，并希望添加对实时流媒体的支持（网络摄像头 + 麦克风作为输入）。不幸的是，Silverlight 无法访问网络摄像头或麦克风本身，因此我需要创建一个独立的应用程序来建立媒体流。我猜 Silverlight 最适合 Microsoft 技术，所以我想使用带有 WMV/WMA 编码的 ASF 格式。

在做了一些研究之后，这是我认为我可以做的：

*   似乎可以使用 DirectShow 捕获网络摄像头和麦克风输入，然后将其组合成一个“流”。
*   要对流进行编码，我可能需要将其传递给 Windows Media Format SDK 库（MSDN 文档描述了如何将 DirectShow 与 WM ASF Writer 一起使用）。
*   我认为应该可以使用“网络接收器”之类的东西来广播 ASF 流（无需将其写入 HDD）。
*   我猜想将大量客户端连接到流上会占用大量带宽，所以我可能应该将流发送到服务器并从那里广播。我只是不知道是否可以使用 ASF 读取器/写入器的组合来通过服务器“传递”流。我也不知道是否可以使用多播来获得类似的结果。

我打算使用 C#，尽管这可能没有太大区别，因为无论如何我都必须为 C++ 库使用一些包装器（如 DirectShow.Net 或 SlimDX）。

不幸的是，我几乎没有处理媒体流的经验。所以我的第一个问题是，是否可以按照我描述的方式进行流式传输？

如果可能的话，这是一种明智的方式还是我应该考虑使用一些不同的库/框架？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-29T03:26:15.983

虽然使用 DShow 和/或 WMF SDK 将为您提供最大的灵活性，但如果您的唯一目标是将视频/音频流式传输到 Silverlight，您可以使用[Windows Media Encoder 9](http://www.microsoft.com/downloads/details.aspx?FamilyID=5691ba02-e496-465a-bba9-b2f1182cdf24&displaylang=en)之类的东西，或者您可以使用新的 Expression Encoder。两者都支持将实时网络摄像头和麦克风流式传输到 Windows Media Server 发布点，或者它可以在本地端口上托管流。两者都有一个可通过 .NET 获得的 SDK（WME 使用 COM 互操作，而 Encoder 有一个本机 .NET API）此流与 Silverlight 和 Windows Media Player 兼容。

# svn - 如何让 Subversion 使用自动生成的文件？

> ID：787044
> 
> 赞同：3
> 
> 时间：2009-04-24T18:29:57.523
> 
> 标签：svn, tortoisesvn, visualsvn, web-deployment-project

我正在使用带有 TortoiseSVN 和 VisualSVN 的 ASP.NET Web 部署项目，但这是关于 Subversion 中生成文件的一般问题。

Web 部署项目会自动生成网站的并行“部署”版本，其中所有代码都被剥离并编译到单个程序集中。我的文件结构是：

*   **树干**
*   **Trunk/MyProject**（网站根目录）
*   **Trunk/MyProject_deploy**（部署项目根）
*   **Trunk/MyProject_deploy/Release**（部署网站根目录，自动生成）

这是问题所在：**MyProject_deploy/Release**在构建时重新生成（在发布模式下）。该目录被删除并重新创建，因此我丢失了所有 .svn 元数据；当我去提交时，我得到状态“阻塞”，我已经查过了，这意味着有一个与服务器上的托管文件夹同名的非托管本地文件夹。

（我可以忽略 Release 文件夹，但我想直接从 Subversion 服务器进行 FTP 部署。）

在 Subversion 中处理自动生成文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-24T18:35:52.377

设置 svn:ignore 属性。不要将它们添加到您的版本控制系统中。构建过程生成的任何东西都不属于那里。属于那里的是完成构建过程所需的东西。

我建议将像 CruiseControl.NET 这样的持续集成服务器添加到组合中 - 它可以从源代码构建项目，然后从中进行部署。这将使您处于使用 2 个最佳实践而不是 1 个的位置，并且仍然可以解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T18:34:14.207

如果您使用的是 Visual Studio，您能否定义构建前和构建后事件以在构建之前将 .svn 目录（或多个目录）移出 Release，然后再移回？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-11-22T12:54:42.927

在使用安装项目创建 Windows Installer 输出时，这也是一个问题。

一种选择是更改*输出文件名*，以便将生成的文件转储到部署项目的根目录中，而不是放在名为“Release”的子文件夹中。

在安装项目的情况下，我生成了一个 MSI 文件并且效果很好 - 没有文件夹被删除/重新创建，因此没有 SVN 错误，并且部署项目根文件夹中只有两个文件是干净的。

# javascript - 检索事件列表

> ID：787047
> 
> 赞同：1
> 
> 时间：2009-04-24T18:30:59.410
> 
> 标签：javascript, events, resume, addeventlistener

有没有办法在 Javascript 中检索 DOM 的事件列表？

例如，我使用**AddEvent**或**AddEventListener**方法为**onclick**事件注册 FuncA、FuncB、FuncC 。如何获取该**onclick**事件的所有这些函数的引用？

 ******理想情况下，我希望有这样的功能：

```
eventList = getEvents(obj, 'onclick'); 
```

并将获取数组中的事件。

任何想法？

或者我可以用来“暂停”事件并稍后“恢复”的任何功能？例如，我想暂停 obj.click 一段时间，直到发生某些事情，然后恢复它。我不想删除所有事件并将它们注册回来。
我知道有事件停止传播功能，但无法恢复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T18:44:36.333

创建挂钩到 addEvent 或 addEvent 侦听器的东西，然后跟踪它的加法/减法。但我不会重写它，因为 jQuery 已经这样做了。

这是完全相同的问题，但有所有答案：

[如何在调试时或从 JavaScript 代码中找到 DOM 节点上的事件侦听器？](https://stackoverflow.com/questions/446892/how-to-find-event-listeners-on-a-dom-node)

（包含做你想做的三种方法）

# c# - 试图了解 TransactionScope

> ID：787052
> 
> 赞同：3
> 
> 时间：2009-04-24T18:32:57.127
> 
> 标签：c#, transactions, transactionscope

我正在尝试制作一个快速的虚拟应用程序，以便了解 System.Transactions 的来龙去脉。这个应用程序与 2 个不同的 SQLExpress DB 交互。如果我在组件服务中提取我的事务统计信息，我可以看到在打开第二个连接时在 outerScope 中启动了一个事务。如果 failOuter 为真，则事务中止，但不会引发任何异常。当 failInner 为真时，会抛出 TransactionAbortedException。

> 来自 MSDN：
> 
> 当您的应用程序完成它想要在事务中执行的所有工作时，您应该只调用一次 Complete 方法来通知事务管理器可以接受提交事务。将 Complete 调用作为 using 块中的最后一条语句是非常好的做法。
> 
> 未能调用此方法会中止事务，因为事务管理器将此解释为系统故障，或等效于事务范围内抛出的异常。
> 
> 如果作用域创建事务并且事务被中止，则会引发 TransactionAbortedException。

基于此，我希望我的 outerScope 会抛出 TransactionAbortedException，因为每次我运行我的应用程序并将 failOuter 设置为 true 时，我的事务统计信息都会显示一个中止的事务。我的方法返回 true，因为即使事务中止也不会引发异常。除非我中止内部事务，否则它的行为与我预期的一样。任何澄清将不胜感激。

```
public bool CreateNestedTransaction(bool failOuter, bool failInner)
    {
        try
        {
            using (TransactionScope outerScope = new TransactionScope())
            {

                /* Perform transactional work here */
                using (SqlConnection myConnection = new SqlConnection("server=(local)\\SQLExpress;Integrated Security=SSPI;database=test1"))
                {
                    SqlCommand myCommand = new SqlCommand();
                    myConnection.Open();
                    myCommand.Connection = myConnection;

                    myCommand.CommandText = "update test set Value = ((select Value from test where Id = (select max(Id) from test))+1) where Id = (select max(Id) from test)";
                    myCommand.ExecuteNonQuery();
                }

                using (SqlConnection myConnection = new SqlConnection("server=(local)\\SQLExpress;Integrated Security=SSPI;database=test1"))
                {
                    SqlCommand myCommand = new SqlCommand();
                    myConnection.Open();
                    myCommand.Connection = myConnection;

                    myCommand.CommandText = "update test set Value = Value";
                    myCommand.ExecuteNonQuery();
                }

                using (TransactionScope innerScope = new TransactionScope())
                {
                    using (SqlConnection myConnection = new SqlConnection("server=(local)\\SQLExpress;Integrated Security=SSPI;database=test2"))
                    {
                        SqlCommand myCommand = new SqlCommand();
                        myConnection.Open();
                        myCommand.Connection = myConnection;

                        myCommand.CommandText = "update test set Value = ((select Value from test where Id = (select max(Id) from test))+1) where Id = (select max(Id) from test)";
                        myCommand.ExecuteNonQuery();
                    }
                    if (failInner == false) { innerScope.Complete(); }
                }

                if (failOuter == false) { outerScope.Complete(); }
            }
        }

        catch (TransactionAbortedException)
        {
            return false;
        }

        return true;
    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-24T18:38:19.017

通常，在 TransactionScope 超出范围并被处置之前，您不会因未能调用 TransactionScope.Complete() 而引发异常。事务将悄悄地回滚。

您的案例中的异常正在发生，因为您试图在外部 TransactionScope 上调用 Complete 并且由于内部 TransactionScope 已经失败而无法正确完成 - 因此这会引发异常。

那有意义吗？

如果您想在外部事务中止的情况下执行某些操作，您可以尝试以下操作：

```
// Inside each using TransactionScope(), hhok up the current transaction completed event
Transaction.Current.TransactionCompleted += new TransactionCompletedEventHandler(Current_TransactionCompleted);

// handle the event somewhere else
void Current_TransactionCompleted(object sender, TransactionEventArgs e)
{
  //  check the status of the transaction
  if(e.Transaction.TransactionInformation.Status == TransactionStatus.Aborted)
    // do something here
} 
```

尽管我认为更简洁的通用模式是始终在 TransactionScope 内调用 Complete() 并处理任何导致的异常，如果您想针对事务失败执行特定操作。

# iphone - cocos2d：LabelAtlas 文本对齐？

> ID：787054
> 
> 赞同：1
> 
> 时间：2009-04-24T18:33:22.133
> 
> 标签：iphone, text, cocos2d-iphone

cocos2d 0.7.1 中有没有办法在 LabelAtlas 中指定文本对齐方式？

我正在使用 LabelAtlas 作为分数（显示在右上角），但是当分数超过 10 时，第二个数字被切断。

我可以实现代码来检测并移动 LabelAtlas，但是有没有办法让 cocos2d 为我做这件事？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-08-01T20:33:22.773

虽然这有效，但如果分数超过 1000，您将遇到同样的问题。

您可以使用该`anchorPosition`属性来更改定义位置的位置。例如; 在我的游戏中，我将 放置`scoreLabel`在屏幕的右下角。为了确保它始终可见，我将其设置`anchorPosition`为标签的右下角，然后将其设置`position`在我希望标签右下角的位置。

```
[scoreLabel setAnchorPoint:ccp(1, 0)];
[scoreLabel setPosition:ccp(480, 0)]; 
```

如果您希望它位于屏幕的右上角，那么您可以类似地使用以下代码将锚点定义为右上角。

```
[scoreLabel setAnchorPoint:ccp(1, 1)];
[scoreLabel setPosition:ccp(480, 320)]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-10-22T20:34:02.873

我只是用它来集中我的`LabelAtlas`：

```
[scoreLabel setAnchorPoint:ccp(.5, .5)]; 
```

当分数改变时，标签保持中心对齐而不更新位置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-02T06:41:55.640

FWIW，我确实最终编写了代码来做到这一点。

```
 if(delegate.score > 99) {
        [scoreLabel setPosition:ccp(374, 265)];
    } else if(delegate.score > 9) {
        [scoreLabel setPosition:ccp(410, 265)];
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-25T06:45:52.987

[http://www.cocos2d-iphone.org/wiki/doku.php/prog_guide:labels#alignment](http://www.cocos2d-iphone.org/wiki/doku.php/prog_guide:labels#alignment)

# reporting-services - SSRS：如何查找给定用户的报告？

> ID：787058
> 
> 赞同：1
> 
> 时间：2009-04-24T18:34:18.247
> 
> 标签：reporting-services, reportingservices-2005

我在 SQL Server Reporting Services 2005 中设置了几个不同的用户帐户，我想以编程方式检查（通过他们的 Web 服务）报告给定用户可以访问哪些报告。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T21:41:24.800

您可以使用 ReportingService2005 Web 服务的 ListChildren Web 方法。它将返回当前用户可以访问的 CatalogItems 列表。然后删除不是报告的项目。

```
List<CatalogItem> result = new List<CatalogItem>();
result.AddRange(ListChildren(SOME_PATH_BLAH_BLAH_BLAH, true));
result.RemoveAll(delegate(CatalogItem item)
                                {
                                    return item.Type != ItemTypeEnum.Report;
                                }); 
```

来自[http://technet.microsoft.com/en-us/library/reportservice2005.reportingservice2005.listchildren.aspx](http://technet.microsoft.com/en-us/library/reportservice2005.reportingservice2005.listchildren.aspx) -

> ListChildren 方法仅返回用户有权查看的子项。返回的项目可能不代表指定父项目的子项目的完整列表。

# ajax - Firefox 中是否有等效的 XDomainRequest？

> ID：787067
> 
> 赞同：12
> 
> 时间：2009-04-24T18:37:31.390
> 
> 标签：ajax, cross-domain, xdomainrequest, firefox-3

Firefox 或任何其他浏览器中是否有与 Internet Explorer 的 XDomainRequest 等效的功能？

我想访问我域之外的服务/网站。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-09-28T21:09:10.340

Internet Explorer 8 中的 XDomainRequest 对象是一种用于请求“同源策略”之外的资源的专有方法。

Firefox 3.5+ 和 Safari 4+ 允许通过 XMLHTTPRequest 对象进行跨域请求。支持 XMLHTTPRequest Level 2 的用户代理必须具有跨域资源共享支持 (CORS)，如果资源宣布可以从其他域请求它，则允许检索资源。

请记住，资源必须在兼容的用户代理检索资源之前将自己声明为跨域资源。

更多信息在这里： [http](http://www.w3.org/TR/cors/) ://www.w3.org/TR/cors/和W3C 网站上的[/TR/XMLHttpRequest2 。](http://www.w3.org/TR/XMLHttpRequest2)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-05-10T15:17:05.597

有可能，您只需在目标服务器上设置跨域标头。

.htaccess 示例：

```
Header set Access-Control-Allow-Origin "*"
Header set Access-Control-Allow-Headers "X-Requested-With"
Header set Access-Control-Max-Age "60" 
```

XmlHttpRequest 将向目标服务器提交一个 OPTIONS 请求，目标服务器将响应这些标头，从而允许客户端提交预期的请求。

来源： [http ://www.oriontransfer.co.nz/blog/2011-05/cross-domain-ajax/index](http://www.oriontransfer.co.nz/blog/2011-05/cross-domain-ajax/index)

# java - 如何在 Eclipse 中正确管理 Tomcat Web 应用程序？

> ID：787070
> 
> 赞同：9
> 
> 时间：2009-04-24T18:41:08.743
> 
> 标签：java, eclipse, tomcat

我曾经在我的机器上单独运行 Tomcat。我有一个 Ant 脚本，它可以重建我的项目、在本地部署它并重新启动 Tomcat。一切正常，但我无法在 Eclipse 中调试 Web 应用程序。

所以我学会了如何在 Eclipse 中设置 Tomcat 并运行我的 Web 应用程序。现在的问题是我不完全了解如何以这种方式管理它。Eclipse 设置为根据更改自动构建我的项目，但这些更改似乎并不总是反映在 Web 应用程序中。有时我必须手动构建项目并手动“清理”服务器以反映更改。

是否有关于如何管理此设置的规则？例如，如果我只更改一个 JSP，那么它会自动同步吗？如果我更改了一个 servlet 类，那么我需要手动重建项目吗？这些规则是否一致，或者我应该每次都手动重建和清理？

如果有人能给我最佳实践规则或指出一个好的资源来学习如何管理这个环境，我将不胜感激。

PS。我正在使用 Eclipse 3.4.1 Java EE 包和 Tomcat v5.5

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-29T13:13:16.773

您可以按照您提到的方式使用 Eclipse 和 Tomcat。首先是如何设置它的基础知识：

1.  在 Servers 视图中设置一个指向 TOMCAT_HOME 的新 Tomcat 服务器
2.  确保您的项目是 Eclipse“网络项目”。您可能需要创建一个虚拟文件并复制 .settings 中的一些文件（查看 wst 文件）。
3.  通过右键单击“服务器”视图中的服务器和“添加和删除项目...”将项目部署到 Tomcat，以将项目添加到服务器。

您可以运行您的服务器并对其进行测试，就像您在 Eclipse 之外运行 Tomcat 一样。如果您在调试模式下运行服务器，您可以设置断点并单步执行代码。

至于何时需要重新启动服务器 Eclipse 通常非常擅长自动部署更改。您几乎不需要重新启动以更改 jsp 页面。如果您更改一个类，如果您更改方法的主体，它将自动部署更改（通常）。如果您更改类的签名（添加或删除方法或更改其参数），您几乎总是需要重新启动。对配置文件（web.xml 或类似文件）的任何更改也几乎总是需要重新启动。

要重新启动，只需单击服务器视图中的“调试”或“运行”按钮。您的所有更改都将重新部署到 Tomcat 中。

需要注意的一件事是，在默认配置中，不会使用 TOMCAT_HOME 中的“webapp”目录。相反，它将使用 Eclipse 工作区目录下的文件夹 (WORKSPACE/.metadata/.plugins/org.eclipse.wst.server.core/tmp0)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T19:03:31.297

通常您应该重新发布应用程序以获取最新更改，不要忘记先与文件系统同步，以防您的文件被外部修改。您可以指定您的应用程序在修改时自动重新加载，在您的服务器配置项目的 server.xml 中查找 Auto-reload 属性。当设置为 true 时，tomcat 将自动重新加载您的应用程序。顺便说一句，这并不总是一个好主意。修改后的 JSP 应该会自动运行，无需重新启动应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-27T05:28:01.497

如果您更改已加载和使用的类的结构（添加/删除成员、更改方法签名等），您的代码更改将不会被反映。这不是 Eclipse 问题，而是 JVM 问题。如果您进行简单的代码更改，例如现有方法中的逻辑更改，您的更改将在类编译和重新部署后生效。无论如何，如果您更改公共常量，则必须重新构建您的项目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-20T07:59:40.957

我发现有两件事需要理解：

*   Eclipse 不会自动识别文件是否在 Eclipse 之外更改。单击项目上的刷新会这样做，F5 也是如此。您还可以将设置更改为自动刷新，但是，它不会立即检测到更改（我的直觉说最多延迟 10 秒）

*   使用服务器具有将文件“发布”到 Tomcat 的概念。这通常会在任何更改后的一秒钟内自动发生。更改许多类可能会导致许多服务器重新加载，如果上下文重新加载需要一些时间（复杂的 Spring 应用程序肯定会这样做），这可能是一个拖累。所以我将设置更改为不自动发布（双击服务器实例）

# polling - 轮询数据库的替代方案？

> ID：787073
> 
> 赞同：4
> 
> 时间：2009-04-24T18:42:26.150
> 
> 标签：polling

我有一个应用程序，其工作方式如下：Linux 机器生成 28 种不同类型的给客户的信件。信件必须以 .docx（Microsoft Word 格式）发送。秘书维护 MS Word 模板，这些模板会根据需要自动使用。改变使用 MS Word 不是一种选择。

为了协调这一切，将文档作业放入数据库表中，并且在每台 Windows 机器上运行的 python 程序频繁地轮询数据库，锁定作业并根据需要运行它们。

我们为作业信息使用中央数据库表来协调不同的状态（“新”、“处理”、“完成”、“打印”）......以及提供准确的状态信息。

无论如何，我不喜欢客户经常轮询数据库，因为他们大部分时间都没有工作。客户端每 5 秒进行一次 hpoll。

为了避免轮询，我希望向所有客户端机器发送广播“有一些工作要做”或“检查你的数据库是否有一些工作要做”消息。

我认为某种发布/订阅消息队列可以胜任这项工作，但我不想要任何巨大的额外复杂性。

是否有零或接近零的配置/维护软件可以实现这一目标？有什么选择？

X

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T22:12:48.737

是否有任何客观证据表明服务器上有任何重大负载？如果它有效，我会确保这里确实有问题需要解决。

一切都运行得如此顺利，以至于您看到的东西可能只会被改进，这一定是件好事！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T19:01:09.227

> 是否有零或接近零的配置/维护软件可以实现这一目标？有什么选择？

可能，但是您在配置和实施时间中节省的时间可能会比您的轮询服务更严重地损害性能。SQL Server 并不是真正用来推动的（无论如何也不容易）。您可以使用某些东西来推送数据（复制服务、日志传送 - 令人讨厌的东西），但它们会比简单的轮询服务更复杂并且需要更多资源。一些选择是：

1.  某种使用命令行调用 (sp_cmdshell) 运行可执行文件的触发器

2.  使用 SQL Server 可以打开和运行的 COM 对象

3.  使用 SQL 代理作业运行 VBScript（这将再次被视为“轮询”）

考虑到您已经完成的工作要简单得多，这些选项有点荒谬。

如果您担心轮询服务使用太多周期或其他东西 - 您可以随时将其限制 - 每分钟、每 10 分钟或什至每天一次轮询可能更合适 - 这将是一个商业决策，所以去吧询问业务中的某人需要多快。

简单的轮询服务相当普遍，因为它们……嗯……简单。此外，它们还具有低开销、远程稳定和容错性。不利的一面是，如果不仔细控制，他们可能会将数据库锤成灰尘。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T22:03:59.147

消息队列可能运行良好，因为它们通常被设置为能够在不浪费资源的情况下阻塞一段时间。但是对于 MySQL，我认为这不是一个选择。

如果你只是想减少数据库的负载，你可以创建一个单行表：最新的作业 ID。然后客户端只需将其与他们的最后一个 ID 进行比较，以查看他们是否需要对真实表运行完整的轮询。如果现在是问题，这种方式应该大大减少开销。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-27T23:43:56.173

与 Postgres 和 SQL Server（或 CouchDb 之类的对象存储）不同，MySQL 不发出数据库事件。但是，您可以使用一些编码模式来模拟这一点。

如果您有一个或多个要监视的表，您可以在这些表上创建触发器，将一行添加到记录要处理的事件队列的“更改”表中。您的触发器过滤您关心的数据更改子集，并在更改表中为您希望执行的每个事件创建记录。因为这种模式对事件进行**排队**和**持久**化，所以即使处理这些事件的工作人员出现中断，它也能很好地工作。

您可能认为 MyISAM 是更改表的最佳选择，因为它主要执行写入（如果您不需要在数据库服务器中断之间持久保存事件，甚至是 MEMORY）。但是，请记住，Memory 和 MEMORY 以及 MyISAM 都只有全表锁，因此在对 MEMORY 和 MyISAM 表执行插入操作时，您对 InnoDB 表的触发器可能会遇到瓶颈。如果您将 ON DELETE CASCADE 与另一个 InnoDB 表一起使用（要求两个表使用相同的引擎），您可能还需要 InnoDB 用于更改表。

您还可以使用`SHOW TABLE STATUS`检查更改表的最后更新时间来检查是否有要执行的操作。此功能[不适](https://bugs.mysql.com/bug.php?id=14374)用于 InnoDB 表。

这些文章更深入地描述了一些在 MySQL 中实现队列甚至避免轮询的替代方法！

*   [如何在 MySQL 中通知事件侦听器](http://www.xaprb.com/blog/2007/08/29/how-to-notify-event-listeners-in-mysql/)
*   [如何在 SQL 中实现队列](http://www.xaprb.com/blog/2007/01/11/how-to-implement-a-queue-in-sql/)
*   [使用 MySQL 作为队列的 5 种微妙方式，以及为什么它会咬你](https://blog.engineyard.com/2011/5-subtle-ways-youre-using-mysql-as-a-queue-and-why-itll-bite-you)

# javascript - IE8 Jquery Javascript“错误：需要对象”错误

> ID：787074
> 
> 赞同：0
> 
> 时间：2009-04-24T18:42:49.083
> 
> 标签：javascript, jquery, internet-explorer-8

当此函数中的 switch 语句运行时，IE8 会抛出“错误：需要对象”消息（实际 jquery 库脚本中的错误，而不是我的 javascript 文件中的错误）。此代码适用于 IE6、IE7、FF3 和 Safari……有什么想法吗？它与开关中的'$（this）'选择器有关吗？谢谢！

```
函数 totshirts(){
    $('.shirt-totals input').val('0');
    var cxs = 0;
    变量 cs = 0;
    无功厘米 = 0;
    $.each($('select.size'), function() {
        开关($(this).val()){
            案例“cxs”：
                CXS++;
                $('input[name="cxs"]').val(cxs);
                休息;
            案例“cs”：
                c++;
                $('input[name="cs"]').val(cs);
                休息;
            案例“厘米”：
                厘米++;
                $('input[name="cm"]').val(cm);
                休息;
        }
    });
}

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T18:51:08.673

哦，不，不要那样做。

沿着这条线做更多的事情：

```
$('.shirt-totals input').val('0');
$('select.size').each(function() {
 var name = $(this).attr('name');
 var currVal = parseInt($("input[name='"+name+"']").val());
 $("input[name='"+name+"']").val(currVal+1);
}); 
```

作为旁注，我倾向于发现在进行“等于”比较时，jQuery 似乎比双引号更好地处理单引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T14:12:40.540

我将 jQuery 库从 1.2.6 升级到 1.3.2，这解决了问题。没有意识到我有一个旧版本 - 哎呀。

谢谢大家的帮助！

# sql - SQL Server 2005：如何在表的开头添加列？

> ID：787075
> 
> 赞同：3
> 
> 时间：2009-04-24T18:42:49.677
> 
> 标签：sql, sql-server

再会，

当我们向表中添加一列时，它会被添加到表的末尾。但是，我确实需要在表的开头添加一列。原因是我们有脚本可以将数据从平面文件源导入到表中，并且将开头的列添加到表中会更容易。

谢谢！

sql server 2005

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-06T06:28:20.163

```
ALTER TABLE table_name ADD COLUMN column_name FIRST; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T18:49:12.937

GUI 方法：在 SQL Server Management Studio 中，如果您右键单击表格并选择“设计”，您可以将列向上拖动到顶部并点击保存。

**注意**：*请注意，这样做会导致 SQL Server 删除该表并重新创建它。不过，您不会丢失数据。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T18:46:09.950

删除并重新创建具有新结构的表。（或重命名现有的，创建新的，并插入数据）

没有可以运行的 ALTER 语句将其插入到开头。

即使您使用 SQL 2005 Management Studio，并且您在开头插入一列，当您单击“保存”时，这也是它在幕后所做的事情。（重命名原表，新建表，插入数据）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-16T14:12:01.047

您的问题的答案在下面的链接中！

[http://www.tech-recipes.com/rx/378/add-a-column-to-an-existing-mysql-table/](http://www.tech-recipes.com/rx/378/add-a-column-to-an-existing-mysql-table/)

# c# - 我必须在 C# 中哈希两次吗？

> ID：787076
> 
> 赞同：5
> 
> 时间：2009-04-24T18:42:55.887
> 
> 标签：c#

我有如下代码：

```
class MyClass
{
    string Name;
    int NewInfo;
}

List<MyClass> newInfo = .... // initialize list with some values
Dictionary<string, int> myDict = .... // initialize dictionary with some values

foreach(var item in newInfo)
{
    if(myDict.ContainsKey(item.Name)) // 'A' I hash the first time here
         myDict[item.Name] += item.NewInfo // 'B' I hash the second (and third?) time here
    else
        myDict.Add(item.Name, item.NewInfo);
} 
```

有什么方法可以避免在字典中进行两次查找——第一次查看是否包含条目，第二次更新值？甚至可能在“B”行有两个哈希查找——一个用于获取 int 值，另一个用于更新它。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-24T18:44:46.537

是的 - 使用`Dictionary.TryGetValue`。它接受一个`out`参数来接收该值，并返回是否找到该值。这是您调整后的代码：

```
foreach(var item in newInfo)
{
    int value;
    if (myDict.TryGetValue(item.Name, out value))
    {
        myDict[item.Name] = value + item.NewInfo;
    }
    else
    {
        myDict[item.Name] = item.NewInfo;
    }
} 
```

**但是，在这种特殊情况下**，我们可以做得更好。*如果未*找到key- ，则`out`参数设置为 0。因为我们要将新值设置为`item.NewInfo`或者`item.NewInfo + value`我们真的在做同样的事情。我们可以忽略方法的返回值，直接使用：

```
foreach(var item in newInfo)
{
    int value;
    myDict.TryGetValue(item.Name, out value);
    myDict[item.Name] = value + item.NewInfo;
} 
```

不过这很不寻常——显然，您通常*会*使用返回值。

**题外话**

只是因为你真的在做一个`GetValueOrDefault`手术，它才有效。事实上，这将是一对有效的扩展方法：

```
public static TValue GetValueOrDefault<TKey, TValue>
    (this IDictionary<TKey, TValue> dictionary, TKey key)
{
    TValue value;
    dictionary.TryGetValue(key, out value);
    return value;
}

public static TValue GetValueOrDefault<TKey, TValue>
    (this IDictionary<TKey, TValue> dictionary, TKey key,
     TValue customDefault)
{
    TValue value;
    if (dictionary.TryGetValue(key, out value))
    {
        return value;
    }
    else
    {
        return customDefault;
    }
} 
```

那时你可以让你的代码简洁*明了*：

```
foreach(var item in newInfo)
{
    myDict[item.Name] = myDict.GetValueOrDefault(item.Name) + item.NewInfo;
} 
```

（您可以要求`GetValueOrDefault(item.Name, 0)`更清晰。）

**回到正题...**

请注意，您仍在进行两次查找 - 一次用于获取值，另一次用于添加/替换它。如果不将类型参数设置为可变的，您就无法真正避免这种情况`TValue`，您可以在适当的位置进行更改。那是可能的，但不是非常好。

在原始代码中，您可能会执行*三个*查找 - 一个 for `ContainsKey`，然后两个（如果找到键）替换值。如果我们扩展以下内容，则更容易看到`+=`：

```
myDict[item.Name] = myDict[item.Name] + item.NewInfo; 
```

（`item.Name`只会被评估一次，但除此之外它是相同的。）

**另一个题外话**

最好有一个操作`Dictionary`基于一个函数进行“查找和替换”以根据旧值获取新值，例如

```
bool Update(TKey key, Func<TValue, bool, TValue> replacementFunction) 
```

where`replacementFunction`将是一个函数，该函数采用当前值（或未`TValue`找到密钥时的默认值）和一个布尔值，表示是否实际找到密钥，*并*返回新值。然后字典可以查找键，调用替换函数并就地更新值。（这个不能作为扩展方法来实现。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T19:24:16.800

不，您不必在大多数情况下进行两次哈希运算。秘诀是您将对象存储在字典中，而不仅仅是一个 int。

```
class Program
{
    static void Main(string[] args)
    {
        var newInfo = new List<MyClass>();
        var myDict = new Dictionary<string, MyClass>();

        foreach (var item in newInfo)
        {
            MyClass temp;
            if (!myDict.TryGetValue(item.Name, out temp))
            {
                temp = new MyClass() { Name = item.Name };
                myDict.Add(temp.Name,temp);
            }

            temp.NewInfo += 1;

        }

    }
}

class MyClass
{
    public string Name;
    public int NewInfo;
} 
```

# internet-explorer - Internet Explorer -> 工具 -> 代理设置：如何添加菜单项、单击时创建窗口、对注册表执行操作

> ID：787078
> 
> 赞同：0
> 
> 时间：2009-04-24T18:43:28.317
> 
> 标签：internet-explorer, registry, menuitem

我想将菜单项添加到 Internet Explorer-> 工具。

例如：完全像 Intrnet explorer-> 工具 -> 删除浏览历史

我要添加代理相关的动作 例如：工具 -> 启用代理工具 -> 禁用代理

还有代理缓存，我想显示的窗口与单击“删除浏览历史记录”时显示的完全一样。当点击互联网前。-> 工具 -> '编辑代理设置' 菜单项，它将显示一个附加窗口。从那里用户将显示代理的缓存数据，用户将能够修改代理数据。

我想知道我该怎么做？（哪种技术可以帮助我做到这一点？）

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-24T12:25:50.987

我在这个地方找到了它：http://msdn.microsoft.com/en-us/library/aa753591(VS.85).aspx

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T19:03:42.620

能够打开和关闭代理使用将无济于事。无论如何，代理中的更改都需要重新启动 IE。

此外，单击工具-> Internet 选项，单击连接选项卡，单击局域网设置按钮，选中/取消选中使用代理复选框，然后单击确定真的那么复杂吗？我数了五次鼠标点击；从“工具”菜单上的新菜单项执行此操作只会节省三下鼠标点击。

编辑：对不起，它需要*六次*点击，而不是五次（工具-> Internet 选项只计算一次），所以一个新项目将节省整个 4 次鼠标左键点击。

# networking - 如何以编程方式打开防火墙设备上的端口？

> ID：787082
> 
> 赞同：2
> 
> 时间：2009-04-24T18:45:25.940
> 
> 标签：networking, firewall, ports

是否有可靠的编程方法来打开常用防火墙设备的端口？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T18:50:56.910

[UPnP 协议](http://en.wikipedia.org/wiki/Upnp)可能对有线路由器等消费级设备有所帮助。但是，我不确定我是否会称它们为“可靠的”，因为并非所有硬件都支持它们。然而，这就是 Xbox 360 试图通过 NAT 设备来实现 Xbox Live 的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-10-24T06:08:29.360

简短的回答：没有。

有一些简单的 IPv4/NAT 网关的方法，即 NAT-PMP 和 UPnP IGD，但不能保证它们在那里，当你拥有它们时，通常只有一种或另一种，而不是两者兼而有之。很多时候，你什么都得不到。对于简单的 IPv6 防火墙，情况更糟：什么都没有。句号。

可悲的是，像[portforward.com](http://portforward.com)这样的东西之所以存在，是因为它们继续服务于有用的目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T19:05:32.383

添加到 Mattk 的答案中，您还可以将[NAT-PNP](http://en.wikipedia.org/wiki/NAT_Port_Mapping_Protocol)与 UPnP 一起使用。这是 Apple 推广的新兴标准，并在其最近的 Airport Extreme WiFi 接入点中使用。这是一个涵盖大部分协议的快速文档：http: [//miniupnp.free.fr/nat-pmp.html](http://miniupnp.free.fr/nat-pmp.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-04-24T18:47:05.983

如果防火墙是安全的，那么不是。如果代码只能打开漏洞，它会破坏目的，不是吗？

# asp.net - 丢失一个请求的 ASP.NET 会话，然后在下一个请求中重新获得它

> ID：787091
> 
> 赞同：0
> 
> 时间：2009-04-24T18:47:15.453
> 
> 标签：asp.net, session, cookies

我在我的一个生产盒子上看到一个非常奇怪的问题。我们在一台机器上托管在 IIS 6 中的应用程序，前面有一个 apache Web 服务器。我的应用程序使用 ASP.NET Membership 进行身份验证并依赖于会话状态。我现在看到一个问题，其中一些服务器请求在尝试访问任何会话变量时会遇到空异常，但是如果重试请求，则页面不会遇到异常并且行为正常。

我相信这与会话 ID cookie 在请求中损坏或丢失有关，但我不知道是什么原因造成的。我相信这是因为 ASP.NET 似乎没有看到 cookie 并创建了一个新会话，这可以解释为什么变量为空。当它得到异常时，它无法将新的 SessionID cookie 写回客户端，所以客户端仍然保持原来的 SessionID。然后在发送下一个请求时，使用原始的 SessionID cookie，现在 ASP.NET 找到并能够检索会话状态。这纯粹是猜测，但似乎符合症状。

此外，除了 ASP.NET 成员资格和 ASP.NET 会话所需的 cookie 之外，该站点不使用其他 cookie，因此我完全低于 IE 的 cookie 限制。该网站已经正常运行了大约 8 个月，这个问题最近才出现。我已经尝试过 IIS 重置并实际上重新启动了机器，但似乎没有任何解决问题的方法。

更新：

以下是一些要求的澄清。

1.）我们的 Apache 服务器是唯一暴露在互联网上的东西。所有请求都通过 HTTPS 发送到此框。然后，Apache 框通过 HTTP 将所有请求转发到我们的应用程序服务器。这样做是出于安全原因。我们查看了 Apache 是否可能是问题所在，但 Apache 日志中似乎没有错误。

2.) 尝试访问存储在应用程序期望存在的会话中的对象时发生空异常，而不是实际会话对象本身发生的异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T20:02:01.917

我们找到了问题的根源。看起来我们的应用服务器上的 IIS 元数据库已损坏。解决此问题的最佳方法是全新安装 IIS，但由于业务限制，这不是我们的选择。所以另一种解决方案是实际上只是为应用程序创建一个新的应用程序池以在其下运行。据一些比我更有 IIS 专业知识的人说，这将在短期内解决问题，但同样的事情很可能会发生在这个 App Pool 上。因此，如果这种情况再次发生，我们需要创建新的应用程序池。

# assembly - 什么是代码洞穴，是否有任何合法用途？

> ID：787100
> 
> 赞同：27
> 
> 时间：2009-04-24T18:50:18.270
> 
> 标签：assembly, terminology, definition, self-modifying, codecave

[我在 StackOverflow 问题“ C# Theoretical: Write a JMP to a codecave in asm](https://stackoverflow.com/questions/787006/) ”中第一次遇到这个词。我看到根据[维基词典](http://en.wiktionary.org/wiki/code_cave)，代码洞穴是：

> 一个未使用的内存块，通常是软件破解者，可以用来注入自定义编程代码来修改程序的行为。

我找到正确的定义了吗？如果是这样，代码洞穴是否有任何合法用途？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-04-24T18:58:08.313

有人可能希望有意创建一个代码洞穴作为使用[自修改代码](http://en.wikipedia.org/wiki/Self-modifying_code)的一部分。

当然，假设那个人是疯了。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-04-24T19:45:03.817

我用过它们，虽然直到今天我才听说过*代码洞穴这个词。*维基词典的定义表明，代码洞穴是破解者在他或她试图破解的可执行文件中发现的东西。你引用的问题并没有那样使用它。相反，它建议分配代码洞穴`VirtualAllocEx`以在目标进程中创建一个全新的内存块。这消除了在目标中搜索未使用空间的需要，并保证您将有足够的空间来放置所有新代码。

Ultimately, I think **a "code cave" is just a place to store run-time-generated code**. There doesn't have to be any nefarious purpose to that code. And at that point, the question of what a code cave is becomes entirely uninteresting. The interesting parts are what reasons there are for generating code at run time, and what techniques there are for making sure that new code gets run when you want it.

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-04-24T18:59:32.430

代码洞穴通常由编译器创建用于[对齐](http://en.wikipedia.org/wiki/Data_structure_alignment)，并且通常位于大量函数之间。结构和跳转之间也应该有代码洞穴（在某些架构中），但通常不会有很多。

您也可以搜索一块归零的内存，但不能保证程序不会使用它们。

我想从理论上讲，如果您丢失了源代码，您可以通过使用它们来修补您的错误程序，并且您的程序不会增长。

**编辑**

对于那些建议代码洞穴仅适用于运行时生成的代码的人：这是一个不完整的定义。很多时候，我在“代码洞穴”中编写了一个数据结构并更新了指向那里的指针，我怀疑我不是唯一这样做的人。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-24T19:42:08.597

**一些合法用途**：在不重新启动的情况下修补实时操作系统二进制文件（MS 这样做），为防火墙和防病毒挂钩低级操作系统功能（文件系统，网络），在没有源代码时扩展应用程序（如抓取低级操作系统调用）到 DrawText，这样你就可以为盲人大声朗读它们）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-24T19:13:20.507

[这里](http://www.codeproject.com/KB/cpp/codecave.aspx)描述的方式让我想起了[补丁点](http://www.windriver.com/products/technologies/sensorpoint/)——一个合法的用途。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-24T19:16:54.120

不熟悉这个术语，但热补丁机制可以使用保留空间来存储代码补丁。您挂钩有缺陷的功能并将其重定向到新改进的功能。它可以在不关闭关键设备（大型电信交换机）的情况下即时完成。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-24T18:57:57.113

它可用于在运行时注入代码。假设操作系统允许您（NX 位未设置等），它可用于以静态语言编写自修改代码。它有很多用途，但这不是您应该在典型的商业应用程序中考虑的事情。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-24T19:07:07.683

对我来说，这听起来像是正确的定义。

至于合法使用，我要说：除非你只是为了试验而试验，并且愿意承担后果，否则不要这样做。

这种类型的东西**不可能**进入生产代码：

1.  这是一个巨大的潜在安全问题。如果可以将代码注入内存然后执行它，那么恶意攻击者理论上可以为所欲为。
2.  这是代码维护的噩梦和调试的噩梦。如果最终运行的代码可以在运行时更改，则几乎不可能跟踪错误和错误。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-04-24T19:38:05.690

自修改代码不应该掉以轻心，但有时可以带来很大的性能提升。如果您已经编程了很长时间，您可能已经在不知不觉中使用了它。

在广泛使用 486 及更高版本之前，许多 PC 不包括硬件浮动支持。这让人们在编写涉及浮点的程序时进退两难。如果他们编译他们的程序以使用内联浮点指令，它将在具有浮点处理器的机器上快速运行，而在没有浮点处理器的机器上则根本无法运行。如果他们用软件浮点仿真编译他们的程序，它可以在所有机器上运行，但即使在具有硬件浮点的机器上也很慢。

许多编译器库使用了一个有趣的技巧来自修改代码。默认行为是在需要浮点运算的地方放置一个陷阱指令。陷阱处理程序将在软件中模拟指令，或者如果它检测到它在具有浮点硬件的机器上运行，它将通过用适当的硬件浮点指令替换陷阱指令来修改代码并执行它。结果是软件可以在所有机器上运行，并且在具有浮点硬件的机器上运行速度几乎与代码已被编译为直接使用浮点硬件一样快（因为大多数浮点密集型操作发生在多次执行的循环中）。

# c# - 使用最小 TabIndex 获得控制句柄

> ID：787105
> 
> 赞同：1
> 
> 时间：2009-04-24T18:51:11.870
> 
> 标签：c#, .net, winforms

我需要处理具有最小 TabIndex 的控件。我尝试使用 GetNextDlgTabItem() 并为第二个参数传递一个 0 指针，但返回的句柄并不总是屏幕选项卡顺序中的第一个。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T18:54:39.023

肮脏的方法：尝试循环遍历控件集合并跟踪具有最小选项卡索引的控件，当循环完成时，您应该能够返回该集合中具有最小 tabindex 属性的控件的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T15:36:54.660

我最终跟踪了哪个字段关注负载，然后在需要时将焦点设置回该字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-13T10:48:50.847

```
 public Control GetFirstTabindexControl(Control container)
        {
            Control res= container.GetNextControl(container, true);
            if (!res.CanSelect)
                res= GetFirstTabindexControl(res);
            return res;
        } 
```

# visual-studio - 哪些 VS.NET 设置会影响 F# 交互式窗口的主题颜色

> ID：787107
> 
> 赞同：2
> 
> 时间：2009-04-24T18:52:09.997
> 
> 标签：visual-studio, f#, themes

重复：[如何更改 F# 交互式 shell 的颜色](https://stackoverflow.com/questions/316161/how-do-i-change-colors-for-the-f-interactive-shell)

你好，

我为 VS.NET 安装了一个深色主题，它适用于所有东西，除了 F# 交互式窗口。该窗口现在具有黑色背景，文本具有白色背景和浅灰色前景。

我一直在使用颜色选项，但找不到哪个设置控制 F# 交互式窗口的主题？

谁能告诉我哪些设置会影响这个窗口？

（视觉工作室 2008）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T18:56:15.323

您应该能够在 Visual Studio 中的“**文本编辑器**”项“**只读区域**”中编辑**字体和颜色选项**

 ****# visual-studio - 卸载/安装新软件包版本后未更新 Visual Studio 隔离外壳工具箱

> ID：787109
> 
> 赞同：1
> 
> 时间：2009-04-24T18:53:35.733
> 
> 标签：visual-studio, dsl

我正在开发一个包含许多工具栏项的 DSL 包。如果我在 DSL 资源管理器中添加新的工具栏项，则将新包安装到 Visual Studio 隔离外壳中，则不会出现新项。我首先在虚拟机上通过安装包的第一个版本、卸载它然后安装更新版本来测试它。即使正在安装新版本的 DSL 包程序集，系统似乎也在以某种方式缓存旧的工具栏设置等。

任何想法为什么旧工具栏项目出现而新工具栏项目不出现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-03T15:22:43.933

实际上，使用了缓存机制。如果您使用新帐户启动 shell，则不会出现此问题。我不知道发生此问题的原因，但这是强制工具箱刷新的解决方法。

*   转到 USERPROFILE%\Local Settings\Application Data\Microsoft\AppEnv\Apps\YourShell_GUID\
*   删除所有 tbd 文件 (.tbd)（不要忘记 tbd 文件是隐藏文件）。

祝你好运。

# flash - .swf 文件是源文件吗？

> ID：787112
> 
> 赞同：4
> 
> 时间：2009-04-24T18:54:42.440
> 
> 标签：flash

我收到了一个 .swf (Flash) 文件，他们要求我修改一些内容。我不知道（还）Flash。.swf 本身是源文件还是其他文件的编译形式。

与 Flash 一起使用的建议 IDE 是什么，从哪里开始？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T19:02:15.760

**swf**文件格式在Action Script（您可以在 Flash 中开发的语言）中没有源代码。要能够修改 flash 项目中的某些内容，您需要访问**.fla**或**.as**文件。

**.fla** — 文件包含 Flash 应用程序的源材料（图像、电影、字体、代码等）。Flash 创作软件可以编辑 FLA 文件并将它们编译成 .swf 文件。Flash 源文件格式目前是基于 Microsoft 复合文件格式的二进制文件格式。在 Flash Pro CS5 中，fla 文件格式是基于 XML 的项目结构的 zip 容器。

**.as** — .as 文件包含简单源文件中的 ActionScript 源代码。FLA 文件也可以直接包含 Actionscript 代码，但由于结构原因，通常会出现单独的外部 .as 文件，或者将代码公开给版本控制应用程序。

**.swf** — 文件是完成、编译和发布的文件，不能用 Adob​​e Flash 编辑。

[维基百科上 Adob​​e 所有文件格式的描述](http://en.wikipedia.org/wiki/SWF#Related_file_formats_and_extensions)

开始使用 Flash 的最佳方式是学习 Adob​​e Flash CS ( [http://www.adobe.com/products/flash/](http://www.adobe.com/products/flash/) )。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T18:56:16.260

SWF 是 FLA 文件的“编译”形式。FLA 文件包含源文件，因此您不能（轻松）编辑 SWF 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-24T18:55:57.227

swf 是一个闪存包，其中可以包含源代码等。

您可以找到[免费的 Flash 反编译](http://www.google.com/search?q=swf%20decompiler)器来为您反汇编它。

# c# - 如何解决 C# 应用程序中的 FTP 超时

> ID：787116
> 
> 赞同：8
> 
> 时间：2009-04-24T18:55:24.590
> 
> 标签：c#, ftp

我正在使用以下 C# 代码从远程服务提供商 FTP 传输约 40MB 的 CSV 文件。大约 50% 的时间，下载会挂起并最终超时。在我的应用程序日志中，我得到如下一行：

```
> Unable to read data from the transport
> connection: A connection attempt
> failed because the connected party did
> not properly respond after a period of
> time, or established connection failed
> because connected host has failed to
> respond. 
```

当我使用 LeechFTP 之类的图形客户端以交互方式下载文件时，下载几乎从不挂起，大约在 45 秒内完成。我很难理解出了什么问题。

任何人都可以建议我如何检测此代码以更深入地了解正在发生的事情，或者更好地下载此文件吗？我应该增加缓冲区大小吗？多少？避免缓冲写入磁盘并尝试吞下内存中的整个文件？任何建议表示赞赏！

```
...

private void CreateDownloadFile()
    {
        _OutputFile = new FileStream(_SourceFile, FileMode.Create);
    }
public string FTPDownloadFile()
    {
        this.CreateDownloadFile();

        myReq = (FtpWebRequest)FtpWebRequest.Create(new Uri(this.DownloadURI));
        myReq.Method = WebRequestMethods.Ftp.DownloadFile;
        myReq.UseBinary = true;
        myReq.Credentials = new NetworkCredential(_ID, _Password);

        FtpWebResponse myResp = (FtpWebResponse)myReq.GetResponse();
        Stream ftpStream = myResp.GetResponseStream();

        int bufferSize = 2048;
        int readCount;
        byte[] buffer = new byte[bufferSize];
        int bytesRead = 0;
        readCount = ftpStream.Read(buffer, 0, bufferSize);

        while (readCount > 0)
        {
            _OutputFile.Write( buffer, 0, readCount );
            readCount = ftpStream.Read( buffer, 0, bufferSize );

            Console.Write( '.' );    // show progress on the console
            bytesRead += readCount;
        }
        Console.WriteLine();
        logger.logActivity( "    FTP received " + String.Format( "{0:0,0}", bytesRead ) + " bytes" );

        ftpStream.Close();
        _OutputFile.Close();
        myResp.Close();
        return this.GetFTPStatus();
    }

    public string GetFTPStatus()
    {
        return ((FtpWebResponse)myReq.GetResponse()).StatusDescription;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2011-10-05T17:15:55.323

我尝试按照上面的建议使用 FTPClient 并得到相同的超时错误，FTPClient 使用 FtpWebRequest 所以我必须遗漏一些东西，但我不明白这一点。

经过更多研究后，我发现 -1 是无穷大的值

就我的目的而言，使用无穷大是可以的，所以我就这样做了，问题解决了。

这是我的代码：

//从FTP站点获取文件。

```
 FtpWebRequest reqFTP;

        string fileName = @"c:\downloadDir\localFileName.txt";
        FileInfo downloadFile = new FileInfo(fileName);
        string uri = "ftp://ftp.myftpsite.com/ftpDir/remoteFileName.txt";

        FileStream outputStream = new FileStream(fileName, FileMode.Append);

        reqFTP = (FtpWebRequest)FtpWebRequest.Create(new Uri(uri));
        reqFTP.Method = WebRequestMethods.Ftp.DownloadFile;
        reqFTP.UseBinary = true;
        reqFTP.KeepAlive = false;
        reqFTP.Timeout = -1;
        reqFTP.UsePassive = true;
        reqFTP.Credentials = new NetworkCredential("userName", "passWord");
        FtpWebResponse response = (FtpWebResponse)reqFTP.GetResponse();
        Stream ftpStream = response.GetResponseStream();
        long cl = response.ContentLength;
        int bufferSize = 2048;
        int readCount;
        byte[] buffer = new byte[bufferSize];
        readCount = ftpStream.Read(buffer, 0, bufferSize);
        Console.WriteLine("Connected: Downloading File");
        while (readCount > 0)
        {
            outputStream.Write(buffer, 0, readCount);
            readCount = ftpStream.Read(buffer, 0, bufferSize);
            Console.WriteLine(readCount.ToString());
        }

        ftpStream.Close();
        outputStream.Close();
        response.Close();
        Console.WriteLine("Downloading Complete"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T19:14:26.933

我建议您不要使用 FtpWebRequest 进行 FTP 访问。FtpWebRequest 是我见过的最脑残的 FTP API。

目前我使用 FtpClient [http://www.codeplex.com/ftpclient](http://www.codeplex.com/ftpclient)

[IndySockets http://www.indyproject.org/index.en.aspx](http://www.indyproject.org/index.en.aspx)我也很幸运

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T19:09:09.380

我还没有在代码级别处理过 FTP，但 FTP 支持恢复。也许你可以让它在超时时自动尝试恢复上传

# c# - 如何从异常中获取 IIS 子状态代码？

> ID：787117
> 
> 赞同：6
> 
> 时间：2009-04-24T18:55:50.753
> 
> 标签：c#, asp.net, iis-6, http-status-codes

我正在以如下方式处理异常`HttpModule`：

```
int errorCode = 500;
HttpApplication httpApp = (HttpApplication)sender;

try
{
    if (httpApp.Server != null)
    {
        Exception ex;

        for (ex = httpApp.Server.GetLastError(); ex != null; ex = ex.InnerException)
        {
            try
            {
                HttpException httpEx = ex as HttpException;
                if (httpEx != null)
                    errorCode = httpEx.GetHttpCode();

                // ... retrieve appropriate content based on errorCode
            }
            catch { }
    }
} 
```

对于[HTTP 状态代码](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes)（例如：302、404、503 等），一切正常。但是，对于[IIS 状态码](http://support.microsoft.com/default.aspx?scid=kb;en-us;318380)（例如：401.5、403.4 等），是否可以将`GetHttpCode`这些作为其返回值是整数来检索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T20:24:02.740

你可能做不到。请参阅此处的倒数第二个响应：[http](http://www.velocityreviews.com/forums/t73739-sending-status-as-4011.html) ://www.velocityreviews.com/forums/t73739-sending-status-as-4011.html 。HTTP RFC 没有定义子代码 ( [http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html) )。看起来它可能是唯一的 MS - 请参阅第一个链接中的最后一个响应，然后指向此处：http: [//msdn.microsoft.com/en-us/library/system.web.httpresponse.substatuscode.aspx](http://msdn.microsoft.com/en-us/library/system.web.httpresponse.substatuscode.aspx) . 虽然这是设置子状态码而不是检索它的方法，但对我来说有趣的是，它仅受“IIS 7.0 中的集成管道模式和至少 .NET Framework 3.0 版”的支持。

我唯一能想到的另一件事是查看 HttpException 的 ErrorCode 属性中的 HRESULT，看看是否在位级别发生了一些事情，您可以从中找出代码和子代码。

不知道这是否有帮助。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2009-04-24T19:02:56.197

你不想要内部异常。你要：

```
HttpException httpEx = httpApp.Server.GetLastError() as HttpException;
if (httpEx != null)
    errorcode = httpEx == null ? 0 : httpex.GetHttpCode(); 
```

# javascript - Internet Explorer 中的 JS 错误

> ID：787118
> 
> 赞同：0
> 
> 时间：2009-04-24T18:55:50.987
> 
> 标签：javascript, internet-explorer

我在 IE 6 和 7 中收到“Object Expected JS 错误。我无法始终重现这一点。行为不一致。我在我的 JSP 页面中使用 Dojo 图表。发生此错误时，没有任何图表得到加载。

我之前在 IE 上遇到过类似的问题。那是在完全加载 JS 文件之前调用了一个 JS 函数。我们可以在请求中看到 JS 文件，但是那个文件是空的。我想知道为什么 IE 不从缓存中获取 JS 文件。它在 Mozilla 中完美运行。有人可以提出一种更好的方法来跟踪这种不一致的 JS 错误吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T18:59:51.803

您正在取消引用一个未定义的变量，但没有示例，除此之外很难说。

（一切都是 javascript 中的对象，因此它几乎是生成该错误的唯一方法）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T20:58:36.387

在高级选项卡的 Internet 选项中，您可以启用调试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T23:46:36.780

IE 有很多在其他浏览器中不会出现的怪癖。调试 IE 的最佳方法是获取 Microsoft 的 Script Debugger 的副本，您可以从 IE 启动它以更清楚地了解实际问题出在哪里。Script Debugger 将在问题行停止执行并将其显示在一个单独的窗口中（IE 锁定，直到您关闭 Script Debugger，但您可以更好地了解导致问题的行）。

请参阅此处了解更多信息： http: [//www.codestore.net/store.nsf/unid/DOMT-5UBUVW?OpenDocument](http://www.codestore.net/store.nsf/unid/DOMT-5UBUVW?OpenDocument)

该文档中间有一个指向 MS Script Debugger 的链接，但[无论如何都在这里](http://www.microsoft.com/downloads/details.aspx?familyid=2F465BE0-94FD-4569-B3C4-DFFDF19CCD99&displaylang=en)。

# ruby-on-rails - 共享活动的 URL 布局

> ID：787127
> 
> 赞同：1
> 
> 时间：2009-04-24T18:58:45.537
> 
> 标签：ruby-on-rails, rest

我的应用程序目前有一个非常简单的 URL 布局：

```
map.resource  :account, :controller => "users", :only => [:show, :update, :destroy] 
map.resources :workouts do |workout|
  workout.resource  :chart, :only => [:show]
  workout.resources :taggings, :only => [:destroy, :create]
end 
```

为当前用户提供不错的简单网址。我现在正在添加一些公共功能 - 让公众看到项目的能力。我想在这些 URL 前面加上用户的登录名。同时，除了一个锻炼资源之外，公共用户无需访问任何内容。我不确定执行此操作的最佳方法。我想结束看起来像这样的 URL：

```
/teich/workouts/3454 
```

大致是哪个

```
/:user_login/workouts/:id 
```

我做 path_prepend 吗？对于想要完整的 RESTful 控件的当前用户，最好的做法是仍然保留他们的用户名而不是像我现在拥有的直接 URL？`:before`因为无论如何我都会进行权限检查，所以我不担心使用 path_prepend 的所有额外路由吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T19:18:33.443

实现此类目标的最简单方法可能是`to_param`在`User`模型中覆盖。

```
 def to_param
    "#{id}-#{login}"
  end 
```

Rails 在为模型生成路径时使用这种方法。然后，当找到`to_i`将抓取整数的字符串发送时。

不要忘记您也需要转义无效的 url 字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-07-20T22:29:08.383

在 API 中包含 URI 定义或命名约定违反了 REST 架构的约束。见：[http ://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven)

# java - 我可以确定正则表达式匹配的第一个字符集吗？

> ID：787134
> 
> 赞同：4
> 
> 时间：2009-04-24T19:00:01.773
> 
> 标签：java, regex, scala, automata, dfa

我希望能够计算所有字符的集合，这些字符可能与给定*的*`java.util.regex.Pattern`. 更正式地说，给定 DFA 等价于某个正则表达式，我想要从起始状态开始的所有传出转换的集合。

一个例子：

```
Pattern p = Pattern.compile("[abc]def|daniel|chris|\\s+");
Set<Character> first = getFirstSet(p); 
```

该集合`first`应包含以下元素：

```
{ 'a', 'b', 'c', 'd', ' ', '\n', '\r', '\t' } 
```

有任何想法吗？我很清楚我可以自己构建 DFA 并以这种方式确定相关状态，但我想避免这种麻烦（阅读：这对我来说不值那么多）。请注意，我的宿主语言实际上是 Scala，因此我可以访问所有核心 Scala 库（值得一提）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T19:09:02.797

我认为您可以解析正则表达式并定义一些递归函数，该函数以从左到右的方式对解析的正则表达式进行操作，从而建立这样的一组第一。

有些事情很简单：

*   序列： first(r1r2) = first(r1) + ( if '' in first(r1) first(r2) else empty set )
*   交替：first(r1|r2) = first(r1) + first(r2)
*   迭代：first(r*) = first(r) + ''
*   字符：first(c) = c
*   字符类：first([c1-cn]) = set(c1, c2, ..., cn) ...

将此扩展到您的正则表达式方言知道的所有原语和特殊标志，您就可以开始了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T19:14:22.080

你可以递归地解决它......

*   带括号并递归调用。
*   在顶层备选方案处拆分并为每个部分递归调用。
*   如果没有其他选择，
    *   输出从左边开始到第一个非可选符号的所有符号。
    *   如果有字符组，则输出所有符号。

这个想法可能有很多错误，但这是我会尝试的。你必须去掉断言、组名和其他上千种东西。如果你发现像 [^0-9] 这样的反转字符类，你必须输出很多字符。

所以我认为这确实是一个复杂的问题。

# asp.net - Web.HttpContext.Current.User.Identity.Name 来自哪里？

> ID：787143
> 
> 赞同：5
> 
> 时间：2009-04-24T19:03:45.930
> 
> 标签：asp.net, forms-authentication, httpcontext, roleprovider

我有

```
FormsAuthentication.SetAuthCookie("someName", True) 
```

作为我的自定义登录序列的一部分。后来，我有一些页面只允许特定角色：

```
<location path="myPage.aspx">
    <system.web>
        <authorization>
            <allow roles="SomeRole"/>
            <deny users="*"/>
        </authorization>
    </system.web>
</location> 
```

据我所知，这会调用我的角色提供者的 GetRolesForUser 实现。它似乎从 Web.HttpContext.Current.User.Identity.Name 获取用户名参数。

我的问题是.... **auth cookie 中的用户名何时被设置为我当前用户身份中的名称？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T20:24:46.750

用户名只是 IPrinciple 用户对象的一个​​属性，并且该对象设置在标准 ASP.NET HTTPModules 之一中，在您的情况下，可能是 System.Web.Security.FormsAuthenticationModule 作为 OnAuthenticate 方法的一部分。

如果您想知道如何更改此信息，例如设置不同的用户名或身份，您将需要查看创建 global.asax 或覆盖 Application_AuthenticateRequest 的自定义 HTTPModule。这是一个例子：

```
Public Sub Application_AuthenticateRequest(ByVal sender As Object, ByVal e As System.EventArgs)
    Dim cookieName As String = FormsAuthentication.FormsCookieName
    Dim authCookie As HttpCookie = HttpContext.Current.Request.Cookies(FormsAuthentication.FormsCookieName)

    If Not IsNothing(authCookie) Then
        Dim authTicket As FormsAuthenticationTicket = FormsAuthentication.Decrypt(authCookie.Value)
        If IsNothing(authTicket) OrElse authTicket.Expired Then
            HttpContext.Current.Response.Redirect(FormsAuthentication.LoginUrl)
        Else
            Dim id As New FormsIdentity(authTicket)

            Dim newUser As New YourCustomUserType(id.Name)
            HttpContext.Current.User = newUser
        End If
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T19:59:01.490

看起来它可能发生在 System.Web.Security.FormsAuthenticationModule 的私有方法 OnAuthenticate 中。这条线是

```
 e.Context.SetPrincipalNoDemand(
      new GenericPrincipal(new FormsIdentity(ticket),
      new string[0])); 
```

# delphi - TableAdapter 构造函数上的类类型预期错误

> ID：787144
> 
> 赞同：0
> 
> 时间：2009-04-24T19:03:54.900
> 
> 标签：delphi, advantage-database-server, oxygene

我正在使用 Delphi Prism 连接到 Advantage 数据库服务器。我使用服务器资源管理器创建了与数据库的连接。我向我的项目添加了一个数据集对象，并向数据集添加了一个表。在 IDE 中一切正常，但是，在表适配器构造函数上生成的设计器代码中出现错误。

错误是：(PE26) 预期类类型。

这是生成的代码：

```
{ Presidents.PresidentsTableAdapters.USPRESIDENTSTableAdapter }

constructor Presidents.PresidentsTableAdapters.USPRESIDENTSTableAdapter;
begin
    self.ClearBeforeFill := true;
end; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-24T20:24:52.940

省略“自我”有帮助吗？我会期待“自我”。是不必要的。我很少使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-06-12T11:48:23.233

你能显示完整的文件吗？该错误表明“Presidents.PresidentsTableAdapters.USPRESIDENTSTableAdapter”不是已知的类类型。

# emacs - 有没有人有用于缩进（和取消缩进）文本块的 Emacs 宏？

> ID：787145
> 
> 赞同：4
> 
> 时间：2009-04-24T19:04:12.700
> 
> 标签：emacs, lisp, elisp

有没有人有用于缩进（和取消缩进）文本块的 Emacs 宏？

我的意思是通常理解的“缩进”，而不是 Emacspeak。换句话说，我想标记一个区域，按 Cu 2，运行这个宏，并让它在该区域的每一行之前添加两个空格。

或者在运行宏之前按 Cu -2 并让它从区域中每行的开头*删除两个空格。*如果它抱怨行没有足够的前导空白，则奖励积分。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-24T19:27:31.567

indent-rigidly (绑定到 Cx TAB) 做你想要的。它在 indent.el 中，它应该是标准 emacs 发行版的一部分。

此外，当某个地方没有足够的空白时让它抱怨/中止，你可以做这样的事情：（对原始缩进严格代码的快速丑陋黑客攻击）

```
(defun enough-whitespace-to-indent-p (start end arg)
  (save-excursion
    (goto-char end)
    (setq end (point-marker))
    (goto-char start)
    (or (bolp) (forward-line 1))
    (while (and (< (point) end)
                (>= (+ (current-indentation) arg) 0))
      (forward-line 1))
    (>= (point) end)))

(defun indent-rigidly-and-be-picky (start end arg)
  (interactive "r\np")
  (if (or (plusp arg) (enough-whitespace-to-indent-p start end arg))
      (indent-rigidly start end arg)
(message "Not enough whitespace to unindent!"))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T20:44:16.047

也可以使用[矩形](http://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles.html#Rectangles)的世界。要插入两个空格：

```
C-x r t SPC SPC RET 
```

删除两个空格是

```
C-x r d 
```

前提是您已将矩形定义为覆盖两个空间。CUA 包中还有一个很好的矩形编辑功能。CUA 包不仅仅包含矩形，所以如果你只想要矩形部分，请查看[此描述](http://trey-jackson.blogspot.com/2008/10/emacs-tip-26-cua-mode-specifically.html)（完整披露，链接到我的博客）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-24T19:29:05.713

默认使用`indent-rigidly`绑定到`C-x TAB`

# html - 在 ASP.NET 中将 html 表导出到 excel 文件的简单方法？

> ID：787149
> 
> 赞同：3
> 
> 时间：2009-04-24T19:06:15.033
> 
> 标签：html, asp.net, csv, xls

有一个从数据库生成的报告，想要添加一个导出按钮，以便他们可以在某种类型的 excel 可读表中获得相同的报告。这里的关键是易于实施，因此如果更容易，CSV 比 XLS 更好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T19:19:25.610

Excel 实际上有点擅长阅读 HTML。特别是如果您的 HTML 仅包含一个表格。如果你想告诉浏览器在 excel 中打开文件，你可以使用

```
Response.ContentType = "application/vnd.ms-excel" 
```

这告诉浏览器在 Excel 中打开文档，而不是仅仅自己呈现它。不过也有一些问题。如果有人想用 OO.org calc 打开它，我认为它不会起作用。此外，当尝试保存它时，它永远不会将文件转换为真正的 excel 文件，除非用户明确更改文件类型。如果它只是您组织的 Intranet 应用程序，这可能不是问题。好处是，您可以使用颜色、边框甚至公式，而使用直接 CSV 则无法做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T19:10:27.677

您可以使用 HtmlTextWriter：

```
 System.IO.StringWriter stringWriter = new System.IO.StringWriter();

  System.Web.UI.HtmlTextWriter htmlWriter = new HtmlTextWriter(stringWriter);

  grid.RenderControl(htmlWriter); 
```

其中 grid 是一个 DataGrid 对象。您也可以使用其他类型的控件。

# php - 迁移技术：PHP+MySQL -> ASP.NET MVC+MS SQL 2008

> ID：787153
> 
> 赞同：0
> 
> 时间：2009-04-24T19:07:27.153
> 
> 标签：php, mysql, sql-server, asp.net-mvc

我有一个完整的 PHP 5 + MySQL 网络应用程序。我还没有开始它的转换，但它会迁移到 ASP.NET MVC + MS SQL 2008。我不确定如何进行最简单的转换：

1.  编辑 SQL Server 的 PHP DAL。立即迁移到新数据库
2.  不理会实时代码。使用 MySQL DAL 创建 ASP.NET MVC 以供现在使用。稍后迁移到新数据库
3.  不理会实时代码。完全编写新版本。同时过渡db和code

对于哪条路最好走，有一些共同的智慧吗？

* * *

**编辑：**解决戴夫的问题：

> 你是如何访问数据库的？如果您的代码和数据库之间有很好的分离并且正在使用存储过程，它可能会影响给出的答案。

根本没有编写任何 ASP.NET MVC 的东西。必须进行一些更改才能使当前的 PHP 数据层与 MS SQL 一起使用。我目前正在利用一些 PHP+MSSQL 不存在的 PHP+MySQL 东西。没什么大不了的，但需要一些重组。我的数据层足够独立，我希望它不会太具有侵入性。

> 还有你的发布计划是什么？你会被迫逐步释放，还是打算有一天“翻转开关”？

拨动开关——这只是我家人的一个爱好网站。但我不反对留下 1 db 并且两个代码集都存在一段时间，直到我确信新的代码集没问题。

* * *

**编辑2：**

看起来我的选择比我想象的要有限。对于 SQL 2000 及更早版本，您只能使用 PHP 的本机 MSSQL 函数。对于 2005+，您需要安装 MS 提供的驱动程序。我在 el Cheapo 共享主机上，所以我不能真正要求他们为我安装驱动程序。看来我很不幸有我的答案:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T19:31:16.597

纯粹主义者会建议从 TDD 开始，这样您就可以通过通过所有单元测试来衡量迁移何时相当完成。

但是，我建议您在 ASP.NET MVC 中从头开始使用该应用程序，因为它与非 MVC PHP 应用程序非常不同。我会先映射数据层并构建一些模型，然后在控制器和视图上进行操作。如果您使用 Visual Studio Surface Designer，则数据模型应该很容易迁移。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T07:39:00.090

一种简单的方法是使用应用程序生成器。

有很多可用的，例如：
- Iron Speed Designer（仅支持 ASP.NET）
- Code Charge Studio（支持许多不同的 Web 脚本语言，如 PHP、ASP、ASP.NET、Pearl 等）

我都试过了。但是对任何内容都不满意，因为他们没有记录 MVC/MVP 部分，以至于开发人员可以轻松地修改生成的代码。

Iron Speeds Designer MVC 比 CCS 更好，但 ISD 将被证明是昂贵的，因为它仅支持一组技术，而 CCS 支持多种技术，并且只需其开发人员的少量支持即可添加对新语言的支持。

# proxy - ClickOnce 不服从 Localhost 的安装文件夹

> ID：787154
> 
> 赞同：4
> 
> 时间：2009-04-24T19:07:28.290
> 
> 标签：proxy, clickonce, localhost, publish, proxy-authentication

我正在测试 ClickOnce 应用程序部署。我已经在我的机器上设置了一个虚拟目录（运行 IIS）。我已在 Visual Studio 的“发布”选项卡中将[http://localhost/SampleApplication](http://localhost/SampleApplication)指定为安装文件夹 URL。但是，当我发布应用程序时，出现以下错误：

> 警告：无法从[http://chrish/SampleApplication/](http://chrish/SampleApplication/)下载文件。
> 
> 远程服务器返回错误：(407) 需要代理身份验证。发布成功。
> 
> 警告：无法在 [http://chrish/SampleApplication/publish.htm](http://chrish/SampleApplication/publish.htm)查看已发布的应用程序。 [http://chrish/SampleApplication/publish.htm](http://chrish/SampleApplication/publish.htm)

请注意它是如何将我的 url 从 Localhost 更改为我的登录名的。为什么？这不是在一周前发生的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-02-08T17:47:19.573

ClickOnce 安装涉及验证服务器名称是否与预期名称匹配。因此 localhost 总是被翻译成计算机名称[不是您在问题中建议的用户名]（ClickOnce 所做的许多令人困惑的事情之一 - 这样做的一个副作用是，如果您想设置 3 个下载服务器，您需要做 3 次单独的发布和/或像这样）或[像这样](http://blog.gatosoft.com/PermaLink,guid,d0a0dd1e-c9ac-4fa9-a408-615454d49702.aspx)[编写发布脚本](http://msdn.microsoft.com/en-us/library/xc3tc5xx.aspx)。所以这并不奇怪——它总是在幕后做这件事。

407 错误与代理身份验证有关。这意味着下载正在通过 Microsoft ISA Server 等代理转移。查看您的 IE Internet 选项连接代理设置并确保它绕过本地地址 [例如`chrish`]。

它报告成功的原因是上传可能使用了与验证不同的替代机制，并且没有通过代理路由/阻止。（根本问题是 .NET 框架默认不传递代理凭据，您需要[为 devenv 应用配置条目](http://support.microsoft.com/kb/910804)或发布的任何内容，或者让构建过程调用带有额外代码的测试步骤发送代理凭据]( [http://blogs.msdn.com/jpsanders/archive/2009/03/24/httpwebrequest-webexcepton-the-remote-server-returned-an-error-407-proxy-authentication-required.aspx](http://blogs.msdn.com/jpsanders/archive/2009/03/24/httpwebrequest-webexcepton-the-remote-server-returned-an-error-407-proxy-authentication-required.aspx) ). 另请参阅[如何将默认代理设置为使用默认凭据？](https://stackoverflow.com/questions/299940/how-should-i-set-the-default-proxy-to-use-default-credentials) )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-12T04:18:40.847

ClickOnce 不喜欢“localhost”，但您可以解决这个问题。

如果将发布文件夹位置设置为：

C:\inetpub\wwwroot\SampleApplication\

和安装文件夹 URL：

[http://chrish/SampleApplication/](http://chrish/SampleApplication/)

（其中“chrish”是您计算机的网络名称）然后您可以在本地发布。

# linux - 使用用户空间进程来辅助内核模块

> ID：787155
> 
> 赞同：3
> 
> 时间：2009-04-24T19:08:21.143
> 
> 标签：linux, kernel

我正在开发一个在 Linux 下工作的非常高性能的硬件。我们想缓存一些数据，但我们担心内存消耗——所以我们的想法是创建一个用户进程来管理缓存。这样，缓存可以在虚拟内存中，而不是在内核空间中，等等。

问题是：最好的方法是什么？我的第一直觉是让内核模块创建一个字符设备文件，并让一个用户程序打开该文件，然后坐在一个选择语句上等待命令到达它。但我担心这可能不是最佳的。一位朋友提到他知道基于套接字的接口，但是当他按下时他无法提供任何细节......

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T19:15:39.003

我认为您正在寻找[netlink](http://en.wikipedia.org/wiki/Netlink)接口。有关更多信息，请参阅[为什么以及如何使用 Netlink 套接字](http://www.linuxjournal.com/article/7356)[原文如此]。在内核和用户空间之间进行通信时要注意安全问题；当忽略检查消息来自内核而不是用户空间时，最近出现了一个[漏洞。](http://lwn.net/SubscriberLink/329266/e127dc10e931bd66/)`udev`

# sql - SQL - 嵌套选择语句？

> ID：787156
> 
> 赞同：0
> 
> 时间：2009-04-24T19:08:26.590
> 
> 标签：sql, nested

我有 2 张桌子，ticket 和 ticket_custom。
以下是表格的设置方式。![替代文字](https://lh3.ggpht.com/_BExRqkFgz70/SfIKYSErMxI/AAAAAAAAAHk/pALtXucgIS8/howTablesAreDefined.jpg)

我有一个 Web 界面，我可以在其中更改状态（表 ticket_custom 中的值） Web 界面添加一个新条目，而不是更新原始条目。

```
ticket  name    value
1   state   Ready for Final Verification
2   state   Ready for Final Verification
1   state   Verified 
```

最后一行被添加

所以我需要修改查询。

```
 SELECT p.value AS __color__,
   id AS ticket, summary, component, version, c.value AS state, milestone, t.type AS type, 
   owner, status,
   time AS created,
   changetime AS _changetime, description AS _description,
   reporter AS _reporter
  FROM ticket t,  ticket_custom c
  LEFT JOIN enum p ON p.name = t.priority AND p.type = 'priority' AND id = c.ticket
  WHERE status <> 'closed' AND id = c.ticket
  ORDER BY CAST(p.value AS int), milestone, t.type, time, c.ticket 
```

该查询现在返回两个条目。我试图在 where 子句中添加一个嵌套选择。

```
SELECT g.ticket
FROM ticket_custom g
WHERE g.ticket = id
ORDER BY g.ticket DESC LIMIT 1 
```

所以 -

```
SELECT p.value AS __color__,
   id AS ticket, summary, component, version, c.value AS state, milestone, t.type AS type, 
   owner, status,
   time AS created,
   changetime AS _changetime, description AS _description,
   reporter AS _reporter
  FROM ticket t,  ticket_custom c
  LEFT JOIN enum p ON p.name = t.priority AND p.type = 'priority' AND id = c.ticket
  WHERE status <> 'closed' AND id = c.ticket and (
         SELECT g.ticket
         FROM ticket_custom g
         WHERE g.ticket = id
         ORDER BY g.ticket DESC LIMIT 1 )
  ORDER BY CAST(p.value AS int), milestone, t.type, time, c.ticket 
```

显然我做错了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T21:56:11.037

这似乎更像是一个设计问题而不是查询问题。虽然可以从 ticket_custom 表中仅返回一条记录，但无法确定将是哪条记录。在您的示例表中，ticket 1 的值为“Ready for...”和“Verified”，但没有显示首先发生的情况。从逻辑上讲，“准备好……”首先发生。

解决此问题的最简单方法是添加时间戳或递​​增 ID 字段。然后您的子查询可以选择最近的条目（最新的时间戳或最高 ID）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T19:16:16.053

假设至少有一张票，您可以这样做：

SELECT MAX(g.ticket) FROM ticket_custom g WHERE g.ticket=id

您可以将其转换为 JOIN 或嵌套的 SELECT 等。

所以改变 id=c.ticket id=MAX(c.ticket)

但检查你的 WHERE & LEFT JOIN 里面有一些奇怪的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T23:44:12.870

不要使您的数据库模式动态化（即“表驱动”）。这不是一个明智的设计模式（我从经验中知道）。它在创建附加属性方面只节省了一点前期工作量，但之后会产生额外的开销，包括编写查询和执行它们所需的数据库处理。

只需在工单表中添加一个状态 id 列，并在状态更改时更新它。创建一个引用表来存储状态名称。然后您的查询变得非常简单，并且数据库引擎对小型参考表进行索引连接所需的工作量更少。

# java - 在 J2ME 中可以通过字符串值设置日期字段吗？

> ID：787159
> 
> 赞同：0
> 
> 时间：2009-04-24T19:08:44.013
> 
> 标签：java, java-me

可以通过字符串值设置 DateField 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T23:51:21.517

当然可以，但不是直接...

```
SimpleDateFormat df1 = new SimpleDateFormat( "dd/MM/yy" );
java.util.Date dDate = df1.parse( strInput );
(DateField)yourDateField.setDate(dDate); 
```

# ios - 以编程方式检索 iPhone 上的内存使用情况

> ID：787160
> 
> 赞同：109
> 
> 时间：2009-04-24T19:08:54.870
> 
> 标签：ios, objective-c, iphone, cocoa-touch, memory

我正在尝试以编程方式随时检索我的 iPhone 应用程序正在使用的内存量。是的，我知道 ObjectAlloc/Leaks。我对这些不感兴趣，只是想知道是否可以编写一些代码并获取正在使用的字节数并通过 NSLog 报告它。

谢谢。

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2009-04-24T20:50:53.923

要获取应用程序正在使用的实际内存字节数，您可以执行以下示例。但是，您确实应该熟悉各种分析工具，因为它们旨在让您更好地了解总体使用情况。

```
#import <mach/mach.h>

// ...

void report_memory(void) {
  struct task_basic_info info;
  mach_msg_type_number_t size = TASK_BASIC_INFO_COUNT;
  kern_return_t kerr = task_info(mach_task_self(),
                                 TASK_BASIC_INFO,
                                 (task_info_t)&info,
                                 &size);
  if( kerr == KERN_SUCCESS ) {
    NSLog(@"Memory in use (in bytes): %lu", info.resident_size);
    NSLog(@"Memory in use (in MiB): %f", ((CGFloat)info.resident_size / 1048576));
  } else {
    NSLog(@"Error with task_info(): %s", mach_error_string(kerr));
  }
} 
```

结构 info.virtual_size 中还有一个字段，它将为您提供可用虚拟内存的字节数（或分配给您的应用程序的内存作为潜在的虚拟内存在任何情况下）。pgb 链接到的代码将为您提供设备可用的内存量以及它是什么类型的内存。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2019-08-01T19:40:00.983

已于 2019 年 7 月 1 日在 Mojave 10.4.6 中的 Xcode 11 和 2020 年 11 月 5 日的 Xcode 11.3 上进行了测试

之前的所有答案都返回了**不正确的结果**。

下面是两个`Swift`版本。

以下是如何获得 Apple 的 Quinn “The Eskimo!”所写的期望值。

这使用了**`phys_footprint`**var from`Darwin > Mach > task_info`并*与 Xcode 的 Debug navigator 中的内存量表中的值非常匹配*。

返回的值以字节为单位。

[https://forums.developer.apple.com/thread/105088#357415](https://forums.developer.apple.com/thread/105088#357415)

原始代码如下。

```
func memoryFootprint() -> mach_vm_size_t? {  
    // The `TASK_VM_INFO_COUNT` and `TASK_VM_INFO_REV1_COUNT` macros are too  
    // complex for the Swift C importer, so we have to define them ourselves.  
    let TASK_VM_INFO_COUNT = mach_msg_type_number_t(MemoryLayout<task_vm_info_data_t>.size / MemoryLayout<integer_t>.size)  
    let TASK_VM_INFO_REV1_COUNT = mach_msg_type_number_t(MemoryLayout.offset(of: \task_vm_info_data_t.min_address)! / MemoryLayout<integer_t>.size)  
    var info = task_vm_info_data_t()  
    var count = TASK_VM_INFO_COUNT  
    let kr = withUnsafeMutablePointer(to: &info) { infoPtr in  
        infoPtr.withMemoryRebound(to: integer_t.self, capacity: Int(count)) { intPtr in  
            task_info(mach_task_self_, task_flavor_t(TASK_VM_INFO), intPtr, &count)  
        }  
    }  
    guard  
        kr == KERN_SUCCESS,  
        count >= TASK_VM_INFO_REV1_COUNT  
    else { return nil }  
    return info.phys_footprint  
} 
```

稍微修改一下以创建一个类级别的 Swift 方法集，可以轻松返回实际字节和以 MB 为单位的格式化输出以进行显示。我使用它作为自动化 UITest 套件的一部分来记录同一测试的多次迭代之前和之后使用的内存，以查看我们是否有任何潜在的泄漏或需要调查的分配。

```
//  Created by Alex Zavatone on 8/1/19.
//

class Memory: NSObject {

    // From Quinn the Eskimo at Apple.
    // https://forums.developer.apple.com/thread/105088#357415

    class func memoryFootprint() -> Float? {
        // The `TASK_VM_INFO_COUNT` and `TASK_VM_INFO_REV1_COUNT` macros are too
        // complex for the Swift C importer, so we have to define them ourselves.
        let TASK_VM_INFO_COUNT = mach_msg_type_number_t(MemoryLayout<task_vm_info_data_t>.size / MemoryLayout<integer_t>.size)
        let TASK_VM_INFO_REV1_COUNT = mach_msg_type_number_t(MemoryLayout.offset(of: \task_vm_info_data_t.min_address)! / MemoryLayout<integer_t>.size)
        var info = task_vm_info_data_t()
        var count = TASK_VM_INFO_COUNT
        let kr = withUnsafeMutablePointer(to: &info) { infoPtr in
            infoPtr.withMemoryRebound(to: integer_t.self, capacity: Int(count)) { intPtr in
                task_info(mach_task_self_, task_flavor_t(TASK_VM_INFO), intPtr, &count)
            }
        }
        guard
            kr == KERN_SUCCESS,
            count >= TASK_VM_INFO_REV1_COUNT
            else { return nil }

        let usedBytes = Float(info.phys_footprint)
        return usedBytes
    }

    class func formattedMemoryFootprint() -> String
    {
        let usedBytes: UInt64? = UInt64(self.memoryFootprint() ?? 0)
        let usedMB = Double(usedBytes ?? 0) / 1024 / 1024
        let usedMBAsString: String = "\(usedMB)MB"
        return usedMBAsString
     }
} 
```

享受！

注意：有进取心的编码员可能希望在类中添加一个静态格式化程序，以便`usedMBAsString`只返回 2 个有效小数位。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2014-12-05T19:21:40.610

标题`TASK_BASIC_INFO`说：

```
/* Don't use this, use MACH_TASK_BASIC_INFO instead */ 
```

这是使用的版本`MACH_TASK_BASIC_INFO`：

```
void report_memory(void)
{
    struct mach_task_basic_info info;
    mach_msg_type_number_t size = MACH_TASK_BASIC_INFO_COUNT;
    kern_return_t kerr = task_info(mach_task_self(),
                                   MACH_TASK_BASIC_INFO,
                                   (task_info_t)&info,
                                   &size);
    if( kerr == KERN_SUCCESS ) {
        NSLog(@"Memory in use (in bytes): %u", info.resident_size);
    } else {
        NSLog(@"Error with task_info(): %s", mach_error_string(kerr));
    }
} 
```

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2011-07-08T16:49:05.993

这是增强的 report_memory() 以在 NSLog() 中快速显示泄漏状态。

```
void report_memory(void) {
    static unsigned last_resident_size=0;
    static unsigned greatest = 0;
    static unsigned last_greatest = 0;

    struct task_basic_info info;
    mach_msg_type_number_t size = sizeof(info);
    kern_return_t kerr = task_info(mach_task_self(),
                               TASK_BASIC_INFO,
                               (task_info_t)&info,
                               &size);
    if( kerr == KERN_SUCCESS ) {
        int diff = (int)info.resident_size - (int)last_resident_size;
        unsigned latest = info.resident_size;
        if( latest > greatest   )   greatest = latest;  // track greatest mem usage
        int greatest_diff = greatest - last_greatest;
        int latest_greatest_diff = latest - greatest;
        NSLog(@"Mem: %10u (%10d) : %10d :   greatest: %10u (%d)", info.resident_size, diff,
          latest_greatest_diff,
          greatest, greatest_diff  );
    } else {
        NSLog(@"Error with task_info(): %s", mach_error_string(kerr));
    }
    last_resident_size = info.resident_size;
    last_greatest = greatest;
} 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-08-05T09:04:09.040

[Jason Coco](https://stackoverflow.com/users/34218/jason-coco)的快速解决方案：

```
func reportMemory() {
    let name = mach_task_self_
    let flavor = task_flavor_t(TASK_BASIC_INFO)
    let basicInfo = task_basic_info()
    var size: mach_msg_type_number_t = mach_msg_type_number_t(sizeofValue(basicInfo))
    let pointerOfBasicInfo = UnsafeMutablePointer<task_basic_info>.alloc(1)

    let kerr: kern_return_t = task_info(name, flavor, UnsafeMutablePointer(pointerOfBasicInfo), &size)
    let info = pointerOfBasicInfo.move()
    pointerOfBasicInfo.dealloc(1)

    if kerr == KERN_SUCCESS {
        print("Memory in use (in bytes): \(info.resident_size)")
    } else {
        print("error with task info(): \(mach_error_string(kerr))")
    }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2017-07-14T02:16:35.103

**Swift 3.1** *（截至 2017 年 8 月 8 日）*

```
func getMemory() {

    var taskInfo = mach_task_basic_info()
    var count = mach_msg_type_number_t(MemoryLayout<mach_task_basic_info>.size)/4
    let kerr: kern_return_t = withUnsafeMutablePointer(to: &taskInfo) {
        $0.withMemoryRebound(to: integer_t.self, capacity: 1) {
            task_info(mach_task_self_, task_flavor_t(MACH_TASK_BASIC_INFO), $0, &count)
        }
    }
    if kerr == KERN_SUCCESS {
        let usedMegabytes = taskInfo.resident_size/(1024*1024)
        print("used megabytes: \(usedMegabytes)")
    } else {
        print("Error with task_info(): " +
            (String(cString: mach_error_string(kerr), encoding: String.Encoding.ascii) ?? "unknown error"))
    }

} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-10-21T13:15:21.593

这是一个 Swift 3 版本：

```
func mach_task_self() -> task_t {
    return mach_task_self_
}

func getMegabytesUsed() -> Float? {
    var info = mach_task_basic_info()
    var count = mach_msg_type_number_t(MemoryLayout.size(ofValue: info) / MemoryLayout<integer_t>.size)
    let kerr = withUnsafeMutablePointer(to: &info) { infoPtr in
        return infoPtr.withMemoryRebound(to: integer_t.self, capacity: Int(count)) { (machPtr: UnsafeMutablePointer<integer_t>) in
            return task_info(
                mach_task_self(),
                task_flavor_t(MACH_TASK_BASIC_INFO),
                machPtr,
                &count
            )
        }
    }
    guard kerr == KERN_SUCCESS else {
        return nil
    }  
    return Float(info.resident_size) / (1024 * 1024)   
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-09-01T15:54:02.790

[Objective-C 版本：](https://github.com/aozhimin/iOS-Monitor-Platform/issues/5#issuecomment-429518591)

```
size_t memoryFootprint()
{
    task_vm_info_data_t vmInfo;
    mach_msg_type_number_t count = TASK_VM_INFO_COUNT;
    kern_return_t result = task_info(mach_task_self(), TASK_VM_INFO, (task_info_t) &vmInfo, &count);
    if (result != KERN_SUCCESS)
        return 0;
    return static_cast<size_t>(vmInfo.phys_footprint);
} 
```

# c++ - Boost Regex - 匹配的字符串存储在哪里？

> ID：787164
> 
> 赞同：3
> 
> 时间：2009-04-24T19:09:49.377
> 
> 标签：c++, regex, boost

我正在编写一个网络蜘蛛，并想使用 boost 正则表达式库而不是制作一些复杂的解析函数。

我看了一下这个例子：

```
#include <string> 
#include <map> 
#include <boost/regex.hpp> 

// purpose: 
// takes the contents of a file in the form of a string 
// and searches for all the C++ class definitions, storing 
// their locations in a map of strings/int's 
typedef std::map<std::string, int, std::less<std::string> > map_type; 

boost::regex expression(
   "^(template[[:space:]]*<[^;:{]+>[[:space:]]*)?"
   "(class|struct)[[:space:]]*"
   "(\\<\\w+\\>([[:blank:]]*\\([^)]*\\))?"
   "[[:space:]]*)*(\\<\\w*\\>)[[:space:]]*"
   "(<[^;:{]+>[[:space:]]*)?(\\{|:[^;\\{()]*\\{)"); 

void IndexClasses(map_type& m, const std::string& file) 
{ 
   std::string::const_iterator start, end; 
   start = file.begin(); 
   end = file.end(); 
      boost::match_results<std::string::const_iterator> what; 
   boost::match_flag_type flags = boost::match_default; 
   while(regex_search(start, end, what, expression, flags)) 
   { 
      // what[0] contains the whole string 
      // what[5] contains the class name. 
      // what[6] contains the template specialisation if any. 
      // add class name and position to map: 
      m[std::string(what[5].first, what[5].second) 
            + std::string(what[6].first, what[6].second)] 
         = what[5].first - file.begin(); 
      // update search position: 
      start = what[0].second; 
      // update flags: 
      flags |= boost::match_prev_avail; 
      flags |= boost::match_not_bob; 
   } 
} 
```

但是，它有点混淆（这是我第一次尝试使用 boost ;)）而且我似乎无法找到匹配字符串的实际位置。

所以我的问题是 - 我如何获得所有比赛的位置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T19:28:13.873

正如代码中的注释所示，what[0] 包含整个字符串。所以 what[0].first 将指向循环的每次迭代中匹配的开始。一般来说，要获得第 i 个组，您可以使用：

```
string s(what[i].first, what[i].second); 
```

要阅读有关 match_results 类的更多信息，请查看此[链接](http://www.boost.org/doc/libs/1_38_0/libs/regex/doc/html/boost_regex/ref/match_results.html)。

# model - 存储库仍然是没有工作单元的存储库吗？

> ID：787165
> 
> 赞同：10
> 
> 时间：2009-04-24T19:10:04.090
> 
> 标签：model, domain-driven-design, repository-pattern

如果您创建了一个存储库类，它封装了给定实体的所有持久性逻辑，例如 PersonRepository，但您的存储库类没有实现工作单元模式或身份映射模式，它是否仍被视为存储库？换句话说，存储库实现是否需要工作单元和身份映射，或者我们可以将任何封装了我们的持久性逻辑的类称为存储库？

我应该补充一件事。如果存储库不需要这些模式并且它实际上只是持久性方法的容器，那么存储库和 DAO（数据访问对象）之间有什么区别？我们只是为同一个对象创建了多个名称，还是我们缺少存储库应有的部分内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T19:29:45.883

是的，它仍然是一个存储库。

至于如果Repository == DAO，我认为Repository 应该在业务逻辑层，DAO 应该在数据访问层，即我认为它们在不同的层。据我了解，存储库调用 DAO 方法来加载和持久化数据。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-28T12:00:32.573

我会说存储库和工作单元模式是正交的。

很多时候，我希望单个工作单元跨越多个存储库上的操作，因此它的实现将属于更高层。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-28T12:09:13.550

基于 Sii 所说的 - 如果存储库和工作单元不相关，对我来说似乎*更好。*关注点分离？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T19:50:39.120

在考虑关注点分离时，请记住您的存储库将具有数据存储实现方法，允许您将其排除在主代码之外。这对于单元测试以及最终完全替换您的数据存储实现很有帮助（数据存储实现的一个示例是 ASP.NET 中的 LINQ-to-SQL。）

# sql - 验证 sql/oracle 中的电子邮件/邮政编码字段

> ID：787167
> 
> 赞同：6
> 
> 时间：2009-04-24T19:10:43.963
> 
> 标签：sql, oracle, plsql, constraints

将不胜感激以下方面的一些建议 - 是否可以通过 oracle 中的 sql 中的某种检查约束来验证电子邮件和邮政编码字段？还是我怀疑带有正则表达式的pl/sql这种事情？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-25T13:07:38.680

这是电子邮件地址的正则表达式语法，包括引号

```
'[a-zA-Z0-9._%-]+@[a-zA-Z0-9._%-]+\.[a-zA-Z]{2,4}' 
```

因此，您可以在 where 子句或 regexp_substr() 中使用 regexp_like() 来检查您的字段是否包含有效的电子邮件地址。这是一个示例 - 您将看到 regexp_substr() 在缺少 .domain 的地址上返回 NULL，这会导致子字符串验证失败。从那里你可以围绕它建立一个检查约束，或者使用触发器（yuck）等来强制它。

```
SQL> desc email
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 EMAIL_ID                                           NUMBER
 EMAIL_ADDRESS                                      VARCHAR2(128)

SQL> select * from email;

  EMAIL_ID EMAIL_ADDRESS
---------- ----------------------------------------
         1 NEIL@GMAIL.COM
         2 JOE@UTAH.GOV
         3 lower_name@lower.org
         4 bad_address@missing_domaindotorg

SQL> @qry2
SQL> column email_address format a40
SQL> column substr_result format a30
SQL> SELECT  email_address
  2       ,  regexp_substr(email_address,'[a-zA-Z0-9._%-]+@[a-zA-Z0-9._%-]+\.[a-zA-Z]{2,4}') substr_result
  3    FROM  email
  4  /

EMAIL_ADDRESS                            SUBSTR_RESULT
---------------------------------------- ------------------------------
NEIL@GMAIL.COM                           NEIL@GMAIL.COM
JOE@UTAH.GOV                             JOE@UTAH.GOV
lower_name@lower.org                     lower_name@lower.org
bad_address@missing_domaindotorg 
```

使用相同的数据，这是一个仅限制有效电子邮件地址的查询，使用 REGEXP_LIKE

```
SQL> column email_address format a40
SQL> column substr_result format a30
SQL> SELECT  email_address
  2    FROM  email
  3   WHERE  REGEXP_LIKE (email_address, '[a-zA-Z0-9._%-]+@[a-zA-Z0-9._%-]+\.[a-zA-Z]{2,4}');

EMAIL_ADDRESS
----------------------------------------
NEIL@GMAIL.COM
JOE@UTAH.GOV
lower_name@lower.org 
```

[在SQL 参考](http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/toc.htm)的内容页面中搜索regexp 以查看对正则表达式的支持。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-09-19T11:20:35.843

一个更好的正则表达式是：

```
^[a-zA-Z0-9._%-]+@[a-zA-Z0-9._%-]+\.[a-zA-Z]{2,4}$ 
```

（给出相同的表达式，但锚定到行的开始（`^`）和结束（`$`））

如果没有锚点，将验证诸如“test1@hotmail.com some other text”之类的表达式，如果您尝试验证一封电子邮件，则上述字符串不应验证

注意：电子邮件应该事先被修剪，这样前导或尾随空格就不会搞砸验证。

希望能帮助到你，

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-05T12:03:44.433

注意`'.'`字符：这是一个小丑（类似于`*`SQL`%`语法）。您必须使用`'\'`.

这是我用来匹配[RFC2822](http://www.ietf.org/rfc/rfc2822.txt)的正则表达式（可能不是所有情况 :)）：

```
'^[a-zA-Z0-9!#$%''\*\+-/=\?^_`\{|\}~]+@[a-zA-Z0-9._%-]+\.[a-zA-Z]{2,4}$' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T20:07:12.343

如果您只关心美国，您可以获取多个邮政编码来源，以平面文件格式获取并导入到表中，然后将地址中的外键约束应用于该表。

可以将电子邮件地址与正则表达式（需要 10g 或更高版本）进行匹配以验证格式，但检查它们是否是实际地址是一项更加困难的任务。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-20T03:42:59.933

正如其他人所提到的，您可以使用正则表达式来验证电子邮件，但准确性有限。您可能会发现使用像[Real Email](https://isitarealemail.com)这样的服务来验证电子邮件会更好，它不仅会检查电子邮件是否正确，还会检查域和帐户是否有效。

您可以将数据导出为 csv，然后对其进行验证。有关更多信息，请参阅[如何验证 sql 数据库中的电子邮件](https://docs.isitarealemail.com/how-to-validate-email-addresses-in-an-sql-database)。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-01-23T22:51:40.683

```
declare

-- where customer is the table in my case

email_input customer.email%type;

begin

    email_input:=:EMAIL; 
    IF email_input is not null
    AND email_input not like '%@%.COM' then
        message('Please enter a valid email address!');
        message('   ');
        clear_message;
        :EMAIL:=null;
        raise form_trigger_failure;
    end if;
end; 
```

# tdd - 什么是演示 TDD 的好示例类？

> ID：787172
> 
> 赞同：46
> 
> 时间：2009-04-24T19:12:14.240
> 
> 标签：tdd

我需要做一个关于测试驱动开发的简短演示（2-4 小时），并且需要提出一个我可以使用 TDD 方法构建的小类。该类必须相对较小，但“推销” TDD 的概念。

如果有人读过 James Newkirk 的书，Microsoft.Net 中的测试驱动开发，那么 Stack 示例就是完美的。这是一个小类，有一个可管理的测试/需求列表，并且创建过程销售 TDD（恕我直言）。

我不想使用 Stack 示例或类似的数据结构（队列、列表等），以免影响 Newkirk 的工作。

因此，我正在为示例类寻找一些好主意。

谢谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-04-24T19:22:19.910

[使用Kent Beck 的 Money 示例的第 1 部分](http://www.amazon.co.uk/Test-Driven-Development-Addison-Wesley-signature/dp/0321146530)怎么样。它开始时非常简单，但是当您将两种不同的货币相加时，TDD 突然向您展示了预先设计或 YAGNI 的错误（您将不需要它）。

另一个很好的例子是 Bob 大叔的[保龄球得分 TDD 示例](http://www.objectmentor.com/resources/articles/xpepisode.htm)。我认为这是一个很好的例子，说明 TDD 叙述如何为您带来一个干净的解决方案，而该解决方案通过预先设计*显然是无法实现的。*

为了使它成为一个真正令人兴奋的演示，您可以预先挑战观众使用他们认为合适的任何方法来设计这两个场景。然后，您将展示设计它们的 TDD 方式。

对我来说，使用 TDD 的真正 WTF 时刻是 Beck 删除了 Money 的两个子类，并且测试成功了。这不是一个小动作；那个人删了两个班！只有通过两种方式才能找到做这样的事情的信心。

1) 将所有高级玩家聚集在一个代码库中并运行场景，然后进行广泛的跟进以确认其有效

2）TDD

=D

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-04-24T19:24:32.290

如果您有时间，我会选择一个具有某种外部依赖关系的示例，该依赖关系将在测试中抽象出来。数据库、对 GUI 的调用、对远程系统的调用等。

原因是 TDD 的障碍之一是该示例似乎过于独立。“当然，当一切都是独立的单元时，你可以进行单元测试，但是当我有 15 个系统要集成时，还有什么意义呢？” 之类的事情。

我还将在最后展示一个迁移现有类以将其置于 TDD 之下的示例（请参阅 Michael Feather 的《有效使用遗留代码的方法》一书）。不要以这个为例，但您的听众很可能会考虑如何迁移他们那天早上编写的课程，没有理由让这种溃烂成为“不可提及的”。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-24T19:25:12.507

[TDD 问题](http://sites.google.com/site/tddproblems/)有一个问题列表，从简单到不太简单。

有些人有一个测试列表，从没有解决方案开始。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-24T19:16:40.093

如果您有一本书的完美示例，那么您应该使用它并宣传这本书。没有作者会反对。

除此之外，几年前我参加了一个 TDD 演示文稿，其中的示例是一个简单的计算器，并且运行良好。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-24T19:40:37.057

三个我喜欢，按难度大致递增的顺序：

*   范围（整数；实现 isEmpty()、contains()、intersects()、length()）
*   [自然排序](https://blog.codinghorror.com/sorting-for-humans-natural-sort-order/)
*   [蛇](http://en.wikipedia.org/wiki/Snake_(video_game))

如果我有半个小时，我会做 Range；90 分钟，可能是自然排序；更多：蛇。不过要看观众。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-24T19:17:53.447

我会尝试从知名域中找到一些小的东西。我最近做了一个关于基于 ASPNET.MVC 的 BDD / TDD 的演讲。这包括一个控制器、一个动作和一个视图模型。这也让我有机会介绍一个依赖容器和一个模拟框架。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-24T19:14:23.843

一个简单的数学课怎么样，加法，减法，乘法等等？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-24T19:27:11.317

TDD/Extreme/Agile 社区的另一个经典示例是保龄球游戏示例；我似乎记得它已经在 Beck 和 Martin 中被使用过，并且在 xprogramming.com 上也多次用于 TDD 中不同技术的示例和探索。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-24T19:31:57.233

走出去，接受观众的要求。:)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-24T19:34:37.883

如果目标是销售 TDD，您还希望展示对大型测试库的小重构。使用小样本很容易使其工作，大多数开发人员现在都接受了。关于可扩展性还有更多的疑问。一个高级主题将是如何处理大量遗留（无单元测试）代码。

一个简单的纸牌游戏会很好，特别是因为你可以提供一些结果的视觉表示

而且我假设您将使用编码道场作为演示文稿，不是吗？没有花哨的PowerPoint。如果公众是非程序员，使用excel示例

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-02-27T13:49:20.510

敏捷开发的基本技能 - Ka Iok Tong。这本书是关于敏捷的，但包含一些关于测试尤其是 TDD 的章节。作者从需求编码解释了TDD，也记录了他对如何解决TDD中的问题的想法。[你可以在这里](https://rads.stackoverflow.com/amzn/click/com/9993776726)找到这本书。要更新有关概念和现代工具的更多信息，您可以访问[此处](http://blogs.telerik.com/james-bender/posts.aspx/13-09-09/30-days-tdd-day-one-what-is-tdd)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-24T19:18:14.473

我建议您自己购买Kent Beck [的“示例测试驱动设计”一书。](http://books.google.be/books?id=gFgnde_vwMAC&dq=test+driven+design+by+example+beck&printsec=frontcover&source=bn&hl=nl&ei=GxDySY2mF8mw-AbG2c3CDw&sa=X&oi=book_result&ct=result&resnum=4)

这本书几乎完全专注于通过 TDD 构建一个类。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-05-05T10:03:19.520

罗马数字。计算源代码的非注释行。河内的塔。那里有很多想法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2013-08-28T06:37:40.943

如果目标受众对 TDD 很天真，那么我建议使用以下示例。它确实让您对 TDD 概念和实现有了很好的理解。

1.  [银行账户](http://phpunit.de/manual/3.7/en/test-driven-development.html)

2.  [保龄球比赛](http://phpunit.de/manual/3.7/en/behaviour-driven-development.html)

# asp.net - 如何以最低成本在数据库上保存修改文件的所有版本

> ID：787173
> 
> 赞同：0
> 
> 时间：2009-04-24T19:12:59.573
> 
> 标签：asp.net, database, sql-server-2005

我最近为我的网站获得了数据库，并惊讶地发现他们给我的空间量是多么昂贵（sql2005 只有 500 mb）。该数据库用于存储会员提交的帖子或文章等数据。

问题：我希望不仅能够保存用户帖子的最终版本，还希望能够保存自他发布以来发生的所有可能的修改。我怎样才能将这些修改保存在数据库中，而不必用不同的版本号多次存储整个帖子？我担心数据库的大小可能会增长过快并达到 500mb 的限制。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T19:21:17.773

您需要多久检索一次以前的帖子？它们有多大？

您可以在插入数据库之前压缩数据，但这会增加检索时间。

您可以存储帖子的差异，但这需要遍历每个帖子并应用差异来重新创建历史记录。

您应该确定您期望的文章/编辑的数量，以便您可以确定在您的限制范围内可以存储多少。

如果文章很大并且以前的版本不常访问，则只需将文章存储为文件并将标题信息存储在数据库中。

# java - Java：双重与浮动

> ID：787181
> 
> 赞同：23
> 
> 时间：2009-04-24T19:15:00.440
> 
> 标签：java, types, casting, floating-point, double

在另一个 Bruce Eckel 练习中，我编写的代码采用一个方法并更改另一个类中的值。这是我的代码：

```
class Big {
  float b;
}

public class PassObject {
  static void f(Letter y) {
    y.c = 'z';
  } //end f()
  static void g(Big z) {
    z.b = 2.2;
  }

  public static void main(String[] args ) {
    Big t = new Big();
    t.b = 5.6;
    System.out.println("1: t.b : " + t.b);
    g(x);
    System.out.println("2: t.b: " + t.b);
  } //end main
}//end class 
```

它抛出一个错误，说“可能失去精度”。

```
PassObject.java:13: possible loss of precision
found: double
required : float   z.b = 2.2
passobject.java:20: possible loss of precision
found : double
required : float   t.b = 5.6 
```

`double`s不能也`float`s吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-24T19:17:23.883

是的，但是您必须指定它们是浮点数，否则它们将被视为双精度数：

```
z.b = 2.2f 
```

数字末尾的“f”使其成为浮点数而不是双精度数。

Java 不会自动将双精度数缩小为浮点数。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-04-24T19:16:11.437

不，浮点数可以自动向上转换为双精度数，但是如果没有显式转换，双精度数永远不会是浮点数，因为双精度数具有更大的范围。

浮动范围`1.40129846432481707e-45`是`3.40282346638528860e+38`

双范围`4.94065645841246544e-324d`是`1.79769313486231570e+308d`

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-24T19:31:26.220

默认情况下，Java 会将小数（例如“ `4.3`”）视为 a `double`，除非您`float`通过在数字后添加 f 来指定 a（例如“ `4.3f`”）。

你在两条线上都有同样的问题。首先，十进制文字被编译器解释为双精度。然后它尝试将其分配给`b`类型为 的`float`。由于 a`double`是 64 位，而 a`float`只有 32 位（请参阅[Java 的原语文档](http://java.sun.com/docs/books/tutorial/java/nutsandbolts/datatypes.html)`float`），Java会给您一个错误，表明`double`. 解决方案是将 f 添加到您的十进制文字中。

如果您试图做相反的事情（即将 a 分配`float`给 a `double`），那没关系，因为您可以将 a`float`的 32 位放入 a`double`的 64 位。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-04-25T01:15:13.540

不要使用浮动。几乎没有充分的理由使用它，而且已经有十多年没有使用它了。只需使用双倍。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-24T19:37:35.007

```
can't doubles be floats as well? 
```

不，每个值或变量都只有一种类型（double、float、int、long 等）。[Java 语言规范](http://java.sun.com/docs/books/jls/third_edition/html/j3TOC.html)准确地说明了当您尝试将一种类型的值分配给另一种类型的变量时会发生什么。通常，允许并隐式地将“较小”值分配给“较大”类型，但是由于目标类型太“小”而无法容纳原始类型的所有值而导致信息丢失的分配是不允许的。编译器，即使具体值确实适合目标类型。

这就是为什么编译器抱怨为浮点变量分配一个双精度值（字面意思是隐含的）可能会丢失信息，您必须通过将值设为浮点数或显式转换来安抚它。

经常引起混淆的一个领域是计算，因为出于技术原因，这些都隐含地“扩大”到 int 。因此，如果您将两个 short 相乘并尝试将结果分配给一个 short，编译器会报错，因为计算的结果是一个 int。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-29T17:44:15.443

浮点范围低于双精度，因此浮点可以很容易地用双精度表示，但反过来是不可能的，因为假设我们取一个超出浮点范围的值，那么在约定期间我们将丢失确切的数据

# sql - Access DB 用另一个表的值更新一个表

> ID：787186
> 
> 赞同：11
> 
> 时间：2009-04-24T19:15:57.413
> 
> 标签：sql, database, ms-access

我正在尝试使用在另一个表中找到的值更新一个表中的所有记录。

我已经尝试了相同基本查询的多个版本，并且总是得到相同的错误消息：

> 操作必须使用可更新的查询。

关于为什么此查询在 Access DB 中不起作用的任何想法？

```
UPDATE inventoryDetails as idet
SET idet.itemDesc = 
(
    SELECT bomItemDesc
    FROM BOM_TEMPLATES as bt
    WHERE bt.bomModelNumber = idet.modelNumber
) 
```

也尝试了这个，因为我意识到，因为第二个表对于每个型号都有多个型号记录 - 我只需要为每个型号找到的第一条记录中的第一个描述。

```
UPDATE inventoryDetails as idet
SET idet.item_desc = 
(
    SELECT TOP 1 bomItemDescription 
    FROM BOM_TEMPLATES as bt
    WHERE bt.bomModelNumber = idet.modelNumber
) 
```

...虽然仍然得到同样的错误。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-24T19:24:20.543

您必须使用连接

```
UPDATE inventoryDetails 
INNER JOIN BOM_TEMPLATES ON inventoryDetails.modelNumber = BOM_TEMPLATES.bomModelNumber 
SET inventoryDetails.itemDesc = [bomItemDesc]; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-27T12:51:25.487

`Any thoughts on why this query won't work in Access DB`?

答案是，因为 ACE/Jet SQL 语法不符合 SQL-92（即使在其 ANSI-92 查询模式下！）。

我假设你的是一个标量子查询。ACE/Jet 根本不支持这种结构。

ACE/Jet 有自己的古怪和有缺陷`UPDATE..JOIN`的语法，有缺陷是因为引擎不强制`JOIN`ed 值是标量，并且可以自由地静默使用任意值。它再次不同于 SQL Server 自己的 UPDATE..JOIN 语法，但至少 SQL Server 支持标准标量子查询作为替代。ACE/Jet 迫使您要么学习其古怪的非便携方式，要么使用替代的 SQL 产品。

很抱歉听起来很消极：ACE/Jet 引擎是一个很棒的软件，但是 UPDATE 语法是绝对基础的，而且自从 SQL-92 标准以来它没有改变的事实确实表明了它的时代。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-04-24T19:24:08.470

尝试：

```
update idet
SET idet.itemDesc = bt.bomItemDesc
from inventoryDetails as idet
     inner join BOM_TEMPLATES as bt
          on bt.bomModelNumber = idet.modelNumber 
```

这就是我为 SQL Server 编写它的方式。希望 Access 理解相同的命令。

# wpf - 为什么在 Collection 更改时不调用 Converter？

> ID：787188
> 
> 赞同：6
> 
> 时间：2009-04-24T19:16:11.530
> 
> 标签：wpf, data-binding

我做了一个`CollectionToStringConverter`可以将任何`IList`转换为​​逗号分隔的字符串（例如“Item1，Item2，Item3”）。

我这样使用它：

```
<TextBlock Text="{Binding Items, 
                  Converter={StaticResource CollectionToStringConverter}}" /> 
```

以上工作，但只有一次当我加载用户界面。`Items`是一个`ObservableCollection`。文本块不会更新，当我从`Items`.

知道使这项工作缺少什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-24T19:21:31.050

绑定到产生集合的属性。它会在集合实例本身发生变化时生效，而不是在集合中的项目发生变化时生效。

有很多方法可以实现您想要的行为，包括：

1) 将 an 绑定`ItemsControl`到集合并配置`ItemTemplate`以输出以逗号开头的文本，如果它不是集合中的最后一项。就像是：

```
<ItemsControl ItemsSource="{Binding Items}">
    <ItemsControl.ItemTemplate>
        <TextBlock>
            <TextBlock Visibility="{Binding RelativeSource={RelativeSource PreviousData}, Converter={StaticResource PreviousDataConverter}}" Text=", "/>
            <TextBlock Text="{Binding .}"/>
        </TextBlock>
    </ItemsControl.ItemTemplate>    
</ItemsControl> 
```

2）在您的代码隐藏中编写代码以观察集合的更改并更新将项目连接成单个的单独属性`string`。就像是：

```
public ctor()
{
    _items = new ObservableCollection<string>();

    _items.CollectionChanged += delegate
    {
        UpdateDisplayString();
    };
}

private void UpdateDisplayString()
{
    var sb = new StringBuilder();

    //do concatentation

    DisplayString = sb.ToString();
} 
```

3) 编写您自己的`ObservableCollection<T>`子类，该子类维护一个类似于#2 的单独连接字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T19:23:37.113

只有在属性更改时才会调用转换器。在这种情况下，“项目”值不会改变。当您在集合中添加或删除新项目时，绑定部分不会意识到这一点。

您可以扩展 ObservableCollection 并在其中添加一个新的 String 属性。请记住在您的 CollectionChanged 事件处理程序中更新该属性。

这是实施

```
public class SpecialCollection : ObservableCollection<string>, INotifyPropertyChanged
{

    public string CollectionString
    {
        get { return _CollectionString; }
        set { 
            _CollectionString = value;
            FirePropertyChangedNotification("CollectionString");
        }
    }

    protected override void OnCollectionChanged(System.Collections.Specialized.NotifyCollectionChangedEventArgs e)
    {
        string str = "";

        foreach (string s in this)
        {
            str += s+",";
        }

        CollectionString = str;

        base.OnCollectionChanged(e);
    }

    private void FirePropertyChangedNotification(string propName)
    {
        if (PropertyChangedEvent != null)
            PropertyChangedEvent(this,
               new PropertyChangedEventArgs(propName));
    }   

    private string _CollectionString;
    public event PropertyChangedEventHandler PropertyChangedEvent;   

} 
```

你的 XAML 会像

```
<TextBlock DataContext={Binding specialItems} Text="{Binding CollectionString}" /> 
```

# air - AIR 和浏览器有什么区别？

> ID：787189
> 
> 赞同：0
> 
> 时间：2009-04-24T19:16:14.883
> 
> 标签：air

我很好奇 Adob​​e AIR 中的哪些“功能”使其在浏览器中独一无二。我听说它内置了 SQLlite，但还有什么使它与 Chrome 的应用程序模式有任何不同（使用[Firefox 的 Prism 插件](https://addons.mozilla.org/en-US/firefox/addon/6665)获得相同的功能）

称它为浏览器是否公平？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T19:20:32.783

AIR 在技术上是一个运行时，很像 Prism 和用于 RIA 的 Silverlight（不知道 Chrome）。他们试图弥合桌面应用程序和浏览器之间的差距。浏览器通常没有磁盘访问权限。

我建议你通过[这个](http://www.adobe.com/products/air/comparison/)链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T19:25:18.343

Adobe Air 有点像在您的桌面上运行一个 Web 应用程序，就好像它是一个 windows/mac 应用程序一样。这是 Adob​​e 出于浏览器体验向 Microsoft Silverlight 提供的答案。存在一些技术差异；对于一个你需要安装一个单独的软件才能使用它，而 Silverlight 一个带有 Silverlight 运行时。另一个区别是在 Adob​​e Air 上运行的应用程序在您的系统上拥有比 Silverlight 更高的权限。

# iphone - 使用 UIScrollView 用两根手指滚动

> ID：787212
> 
> 赞同：42
> 
> 时间：2009-04-24T19:23:04.667
> 
> 标签：iphone, objective-c, uiscrollview

我有一个应用程序，我的主视图同时接受`touchesBegan`和`touchesMoved`，因此接受单指触摸和拖动。我想实现 a `UIScrollView`，我让它工作，但它覆盖了拖动，因此我的 contentView 永远不会收到它们。我想实现 a `UIScrollview`，其中两指拖动表示滚动，并且单指拖动事件被传递给我的内容视图，因此它可以正常执行。我需要创建自己的子类`UIScrollView`吗？

这是我`appDelegate`实现`UIScrollView`.

```
@implementation MusicGridAppDelegate

@synthesize window;
@synthesize viewController;
@synthesize scrollView;

- (void)applicationDidFinishLaunching:(UIApplication *)application {    

    // Override point for customization after app launch    
    //[application setStatusBarHidden:YES animated:NO];
    //[window addSubview:viewController.view];

    scrollView.contentSize = CGSizeMake(720, 480);
    scrollView.showsHorizontalScrollIndicator = YES;
    scrollView.showsVerticalScrollIndicator = YES;
    scrollView.delegate = self;
    [scrollView addSubview:viewController.view];
    [window makeKeyAndVisible];
}

- (void)dealloc {
    [viewController release];
    [scrollView release];
    [window release];
    [super dealloc];
} 
```

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2010-07-04T00:12:48.933

在 SDK 3.2 中，UIScrollView 的触摸处理是使用手势识别器处理的。

如果要进行两指平移而不是默认的单指平移，可以使用以下代码：

```
for (UIGestureRecognizer *gestureRecognizer in scrollView.gestureRecognizers) {     
    if ([gestureRecognizer  isKindOfClass:[UIPanGestureRecognizer class]]) {
        UIPanGestureRecognizer *panGR = (UIPanGestureRecognizer *) gestureRecognizer;
        panGR.minimumNumberOfTouches = 2;               
    }
} 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-08-04T02:24:49.637

对于 iOS 5+，设置此属性与 Mike Laurence 的回答具有相同的效果：

```
self.scrollView.panGestureRecognizer.minimumNumberOfTouches = 2; 
```

panGestureRecognizer 忽略一指拖动，因此一指拖动事件被传递到内容视图。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-09-25T05:08:06.460

在 iOS 3.2+ 中，您现在可以很容易地实现两指滚动。只需将平移手势识别器添加到滚动视图并将其 maximumNumberOfTouches 设置为 1。它将要求所有单指滚动，但允许 2+ 手指滚动将链向上传递到滚动视图的内置平移手势识别器（因此允许正常的滚动行为）。

```
UIPanGestureRecognizer *panGestureRecognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(recognizePan:)];
panGestureRecognizer.maximumNumberOfTouches = 1;
[scrollView addGestureRecognizer:panGestureRecognizer];
[panGestureRecognizer release]; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-05-10T06:02:20.980

您需要继承 UIScrollView （当然！）。然后你需要：

*   使单指事件转到您的内容视图（简单），并且

*   使两指事件滚动滚动视图（可能很容易，可能很难，可能不可能）。

Patrick 的建议通常很好：让您的 UIScrollView 子类知道您的内容视图，然后在触摸事件处理程序中检查手指的数量并相应地转发事件。只需确保 (1) 您发送到内容视图的事件不会通过响应者链返回 UIScrollView（即确保处理所有事件），(2) 尊重通常的触摸事件流（即 touchesBegan，而不是一些 {touchesBegan, touchesMoved, touchesEnded}，以 touchesEnded 或 touchesCancelled 结束），尤其是在处理 UIScrollView 时。#2 可能很棘手。

如果您决定事件是针对 UIScrollView，另一个技巧是让 UIScrollView 相信您的两指手势实际上是单指手势（因为 UIScrollView 不能用两根手指滚动）。尝试只将一根手指的数据传递给 super（通过过滤`(NSSet *)touches`参数——注意它只包含更改的触摸——并完全忽略错误手指的事件）。

如果这不起作用，你就有麻烦了。从理论上讲，您可以尝试通过创建一个看起来类似于 UITouch 的类来创建人工触摸以提供给 UIScrollView。底层 C 代码不检查类型，因此将 (YourTouch *) 转换为 (UITouch *) 可能会起作用，并且您将能够欺骗 UIScrollView 处理实际上并没有发生的触摸。

您可能想阅读[我关于高级 UIScrollView 技巧的文章](http://github.com/andreyvit/ScrollingMadness/tree/master)（并在那里查看一些完全不相关的 UIScrollView 示例代码）。

当然，如果你不能让它工作，总是可以选择手动控制 UIScrollView 的移动，或者使用完全自定义编写的滚动视图。[Three20 库](http://github.com/joehewitt/three20/tree/master)中有 TTScrollView 类；用户感觉不好，但程序员感觉不错。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-03-09T14:00:42.800

这个答案一团糟，因为您只能通过阅读所有其他答案和评论来找到正确的答案（最接近的答案让问题倒退）。接受的答案太模糊而无用，并提出了一种不同的方法。

合成，这行得通

```
 // makes it so that only two finger scrolls go
    for (id gestureRecognizer in self.gestureRecognizers) {     
        if ([gestureRecognizer  isKindOfClass:[UIPanGestureRecognizer class]])
        {
            UIPanGestureRecognizer *panGR = gestureRecognizer;
            panGR.minimumNumberOfTouches = 2;              
            panGR.maximumNumberOfTouches = 2;
        }
    } 
```

这需要两个手指来滚动。我已经在子类中完成了此操作，但如果没有，只需替换`self.gestureRecognizers`为`myScrollView.gestureRecognizers`即可。

我唯一添加的是`id`用来避免丑陋的演员表:)

**这可行，但如果您希望 UIScrollView 也进行缩放，则可能会变得非常混乱......手势无法正常工作，因为捏到缩放和滚动会解决它。如果我找到合适的答案，我会更新这个。**

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-03-10T09:29:36.297

我们设法在我们的 iPhone 绘图应用程序中实现了类似的功能，方法是继承 UIScrollView 并以简单粗暴的方式根据触摸次数过滤事件：

```
//OCRScroller.h
@interface OCRUIScrollView: UIScrollView
{
    double pass2scroller;
}
@end

//OCRScroller.mm
@implementation OCRUIScrollView
- (id)initWithFrame:(CGRect)aRect {
    pass2scroller = 0;
    UIScrollView* newv = [super initWithFrame:aRect];
    return newv;
}
- (void)setupPassOnEvent:(UIEvent *)event {
    int touch_cnt = [[event allTouches] count];
    if(touch_cnt<=1){
        pass2scroller = 0;
    }else{
        double timems = double(CACurrentMediaTime()*1000);
        pass2scroller = timems+200;
    }
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [self setupPassOnEvent:event];
    [super touchesBegan:touches withEvent:event];
}
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    [self setupPassOnEvent:event];
    [super touchesMoved:touches withEvent:event];   
}
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    pass2scroller = 0;
    [super touchesEnded:touches withEvent:event];
}

- (BOOL)touchesShouldBegin:(NSSet *)touches withEvent:(UIEvent *)event inContentView:(UIView *)view
{
    return YES;
}

- (BOOL)touchesShouldCancelInContentView:(UIView *)view
{
    double timems = double(CACurrentMediaTime()*1000);
    if (pass2scroller == 0 || timems> pass2scroller){
        return NO;
    }
    return YES;
}
@end 
```

ScrollView 设置如下：

```
scroll_view = [[OCRUIScrollView alloc] initWithFrame:rect];
scroll_view.contentSize = img_size;
scroll_view.contentOffset = CGPointMake(0,0);
scroll_view.canCancelContentTouches = YES;
scroll_view.delaysContentTouches = NO;
scroll_view.scrollEnabled = YES;
scroll_view.bounces = NO;
scroll_view.bouncesZoom = YES;
scroll_view.maximumZoomScale = 10.0f;
scroll_view.minimumZoomScale = 0.1f;
scroll_view.delegate = self;
self.view = scroll_view; 
```

* * *

简单的点击什么都不做（你可以按照你需要的方式处理它），用两根手指点击滚动/缩放视图，如预期的那样。没有使用 GestureRecognizer，因此适用于 iOS 3.1

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-12-28T00:27:14.240

我对上面的代码做了进一步的改进。问题是，即使我们设置`setCanCancelContentTouches:NO` 了我们有问题，缩放手势也会中断内容。它不会取消内容触摸，但同时允许放大。为了防止这种情况，我通过每次将 minimumZoomScale 和 maximumZoomScale 设置为相同的值来锁定缩放，计时器会触发。

一个非常奇怪的行为是，当一个手指事件在允许的时间段内被两个手指手势取消时，计时器将被延迟。它在 touchCanceled 事件被调用后被触发。所以我们遇到了问题，尽管事件已经取消，但我们尝试锁定缩放，因此禁用下一个事件的缩放。为了处理这种行为，计时器回调方法检查是否之前调用了 touchesCanceled。 `@implementation JWTwoFingerScrollView`

 ````
#pragma mark -
#pragma mark Event Passing

- (id)initWithCoder:(NSCoder *)coder {
    self = [super initWithCoder:coder];
    if (self) {
        for (UIGestureRecognizer* r in self.gestureRecognizers) {
            if ([r isKindOfClass:[UIPanGestureRecognizer class]]) {
                [((UIPanGestureRecognizer*)r) setMaximumNumberOfTouches:2];
                [((UIPanGestureRecognizer*)r) setMinimumNumberOfTouches:2];
                zoomScale[0] = -1.0;
                zoomScale[1] = -1.0;
            }
            timerWasDelayed = NO;
        }
    }
    return self;
}
-(void)lockZoomScale {    
    zoomScale[0] = self.minimumZoomScale;
    zoomScale[1] = self.maximumZoomScale;
    [self setMinimumZoomScale:self.zoomScale];
    [self setMaximumZoomScale:self.zoomScale];
        NSLog(@"locked %.2f %.2f",self.minimumZoomScale,self.maximumZoomScale);
}
-(void)unlockZoomScale {
    if (zoomScale[0] != -1 && zoomScale[1] != -1) {
        [self setMinimumZoomScale:zoomScale[0]];
        [self setMaximumZoomScale:zoomScale[1]];
        zoomScale[0] = -1.0;
        zoomScale[1] = -1.0;
        NSLog(@"unlocked %.2f %.2f",self.minimumZoomScale,self.maximumZoomScale);
    }
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    NSLog(@"began %i",[event allTouches].count);
    [self setCanCancelContentTouches:YES];
     if ([event allTouches].count == 1){
         touchesBeganTimer = [NSTimer scheduledTimerWithTimeInterval:0.1 target:self selector:@selector(firstTouchTimerFired:) userInfo:nil repeats:NO];
         [touchesBeganTimer retain];
         [touchFilter touchesBegan:touches withEvent:event];
     }
 }

//if one finger touch gets canceled by two finger touch, this timer gets delayed
// so we can! use this method to disable zooming, because it doesnt get called when two finger touch events are wanted; otherwise we would disable zooming while zooming
-(void)firstTouchTimerFired:(NSTimer*)timer {
    NSLog(@"fired");
    [self setCanCancelContentTouches:NO];
    //if already locked: unlock
    //this happens because two finger gesture delays timer until touch event finishes.. then we dont want to lock!
    if (timerWasDelayed) {
        [self unlockZoomScale];
    }
    else {
        [self lockZoomScale];
    }
    timerWasDelayed = NO;
 }

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
//    NSLog(@"moved %i",[event allTouches].count);
    [touchFilter touchesMoved:touches withEvent:event];
}

 - (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    NSLog(@"ended %i",[event allTouches].count);
    [touchFilter touchesEnded:touches withEvent:event];
    [self unlockZoomScale];
 }

 //[self setCanCancelContentTouches:NO];
 -(void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event {
    NSLog(@"canceled %i",[event allTouches].count);
    [touchFilter touchesCancelled:touches withEvent:event];
    [self unlockZoomScale];
     timerWasDelayed = YES;
 }

@end 
````  `* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-11-03T16:48:59.077

坏消息：iPhone SDK 3.0 及更高版本，不要再传递`-touchesBegan:`和 - `touchesEnded:`** `UIScrollview`**子类方法。你可以使用不一样的`touchesShouldBegin`和`touchesShouldCancelInContentView`方法。

如果你真的想接触到这个，有一个允许这个的*黑客。*

在您的`UIScrollView`覆盖子类中，`hitTest`方法如下：

```
- (UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event {

  UIView *result = nil;
  for (UIView *child in self.subviews)
    if ([child pointInside:point withEvent:event])
      if ((result = [child hitTest:point withEvent:event]) != nil)
        break;

  return result;
} 
```

这将传递给你这个触摸的子类，但是你不能取消对`UIScrollView`超类的触摸。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-01-12T06:05:44.467

我要做的是让我的视图控制器设置滚动视图：

```
[scrollView setCanCancelContentTouches:NO];
[scrollView setDelaysContentTouches:NO]; 
```

在我的孩子看来，我有一个计时器，因为两指触摸通常从一根手指开始，然后是两根手指。

```
- (void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    // Hand tool or two or more touches means a pan or zoom gesture.
    if ((selectedTool == kHandToolIndex) || (event.allTouches.count > 1)) {
        [[self parentScrollView] setCanCancelContentTouches:YES];
        [firstTouchTimer invalidate];
        firstTouchTimer = nil;
        return;
    }

    // Use a timer to delay first touch because two-finger touches usually start with one touch followed by a second touch.
    [[self parentScrollView] setCanCancelContentTouches:NO];
    anchorPoint = [[touches anyObject] locationInView:self];
    firstTouchTimer = [NSTimer scheduledTimerWithTimeInterval:kFirstTouchTimeInterval target:self selector:@selector(firstTouchTimerFired:) userInfo:nil repeats:NO];
    firstTouchTimeStamp = event.timestamp;
} 
```

如果第二个 touchesBegan: 事件来自多于一根手指，则允许滚动视图取消触摸。因此，如果用户使用两根手指进行平移，该视图会收到一条`touchesCanceled:`消息。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-05-25T21:06:27.127

这似乎是互联网上这个问题的最佳资源。[可以在这里找到](http://www.iphonedevsdk.com/forum/iphone-sdk-development/6686-uiscrollview-wont-respond-touch-event-scrolls-pans-but-tochesshouldbegin-ne.html)另一个接近的解决方案。

我以不同的方式以非常令人满意的方式解决了这个问题，主要是通过将我自己的手势识别器替换为等式。我强烈建议任何试图达到原始海报要求的效果的人考虑这种替代方法，而不是激进的`UIScrollView`.

以下过程将提供：

*   A`UIScrollView`包含您的自定义视图

*   用两根手指缩放和平移（通过`UIPinchGestureRecognizer`）

*   您的视图对所有其他触摸的事件处理

首先，假设您有一个视图控制器及其视图。在 IB 中，使视图成为 scrollView 的子视图并调整视图的调整大小规则，使其不会调整大小。在滚动视图的属性中，打开任何“反弹”并*关闭*“ `delaysContentTouches`”。此外，您必须将缩放最小值和最大值设置为默认值 1.0 以外的值，因为正如 Apple 的文档所说，这是缩放工作所必需的。

创建 的自定义子类`UIScrollView`，并使此滚动视图成为自定义子类。为滚动视图添加一个出口到您的视图控制器并将它们连接起来。你现在已经完全配置好了。

您需要将以下代码添加到`UIScrollView`子类中，以便它透明地传递触摸事件（我怀疑这可以更优雅地完成，甚至可能完全绕过子类）：

```
#pragma mark -
#pragma mark Event Passing

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [self.nextResponder touchesBegan:touches withEvent:event];
}
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    [self.nextResponder touchesMoved:touches withEvent:event];
}
- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    [self.nextResponder touchesEnded:touches withEvent:event];
}
- (BOOL)touchesShouldCancelInContentView:(UIView *)view {
    return NO;
} 
```

将此代码添加到您的视图控制器：

```
- (void)setupGestures {
    UIPinchGestureRecognizer *pinchGesture = [[UIPinchGestureRecognizer alloc] initWithTarget:self action:@selector(handlePinchGesture:)];
    [self.view addGestureRecognizer:pinchGesture];
    [pinchGesture release];
}

- (IBAction)handlePinchGesture:(UIPinchGestureRecognizer *)sender {
if ( sender.state == UIGestureRecognizerStateBegan ) {
    //Hold values
    previousLocation = [sender locationInView:self.view];
    previousOffset = self.scrollView.contentOffset;
    previousScale = self.scrollView.zoomScale;
} else if ( sender.state == UIGestureRecognizerStateChanged ) {
    //Zoom
    [self.scrollView setZoomScale:previousScale*sender.scale animated:NO];

    //Move
    location = [sender locationInView:self.view];
    CGPoint offset = CGPointMake(previousOffset.x+(previousLocation.x-location.x), previousOffset.y+(previousLocation.y-location.y));
    [self.scrollView setContentOffset:offset animated:NO];  
} else {
    if ( previousScale*sender.scale < 1.15 && previousScale*sender.scale > .85 )
        [self.scrollView setZoomScale:1.0 animated:YES];
} 
```

}

请注意，在此方法中，您必须在视图控制器的类文件中定义许多属性：

*   `CGFloat previousScale;`
*   `CGPoint previousOffset;`
*   `CGPoint previousLocation;`
*   `CGPoint location;`

好的，就是这样！

不幸的是，我*无法*让 scrollView 在手势期间显示其滚动条。我尝试了所有这些策略：

```
//Scroll indicators
self.scrollView.showsVerticalScrollIndicator = YES;
self.scrollView.showsVerticalScrollIndicator = YES;
[self.scrollView flashScrollIndicators];
[self.scrollView setNeedsDisplay]; 
```

我真正喜欢的一件事是，如果您查看最后一行，您会注意到它会抓取大约 100% 的任何最终缩放并将其四舍五入。你可以调整你的容忍度；我在 Pages 的缩放行为中看到了这一点，并认为这将是一个不错的选择。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-10-02T02:33:07.583

我把它放在 viewDidLoad 方法中，这完成了处理两个触摸平移行为的滚动视图和另一个处理单点触摸平移行为的平移手势处理程序 -->

```
scrollView.panGestureRecognizer.minimumNumberOfTouches = 2

let panGR = UIPanGestureRecognizer(target: self, action: #selector(ViewController.handlePan(_:)))
panGR.minimumNumberOfTouches = 1
panGR.maximumNumberOfTouches = 1

scrollView.gestureRecognizers?.append(panGR) 
```

在作为附加到 ViewController 的函数的 handlePan 方法中，只有一个 print 语句来验证是否正在输入该方法 -->

```
@IBAction func handlePan(_ sender: UIPanGestureRecognizer) {
    print("Entered handlePan numberOfTuoches: \(sender.numberOfTouches)")
} 
```

高温高压

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-24T21:47:09.703

是的，您需要继承`UIScrollView`并覆盖它的 -`touchesBegan:`和`-touchesEnded:`方法来“向上”传递触摸。这可能还涉及具有`UIView`成员变量的子类，以便它知道将触摸传递给的含义。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2011-12-15T16:39:41.727

查看我的[解决方案](http://kreuzundqwertz.wordpress.com/2011/12/14/uiscrollview-that-doesnt-interfere-with-content-touches/ "解决方案")：

```
#import “JWTwoFingerScrollView.h”

@implementation JWTwoFingerScrollView

- (id)initWithCoder:(NSCoder *)coder {
    self = [super initWithCoder:coder];
    if (self) {
        for (UIGestureRecognizer* r in self.gestureRecognizers) {
            NSLog(@“%@”,[r class]);
            if ([r isKindOfClass:[UIPanGestureRecognizer class]]) {
                [((UIPanGestureRecognizer*)r) setMaximumNumberOfTouches:2];
                [((UIPanGestureRecognizer*)r) setMinimumNumberOfTouches:2];
            }
        }
    }
    return self;
}

-(void)firstTouchTimerFired:(NSTimer*)timer {
    [self setCanCancelContentTouches:NO];
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
    [self setCanCancelContentTouches:YES];
    if ([event allTouches].count == 1){
        touchesBeganTimer = [NSTimer scheduledTimerWithTimeInterval:0.1 target:self selector:@selector(firstTouchTimerFired:) userInfo: nil repeats:NO];
        [touchesBeganTimer retain];
        [touchFilter touchesBegan:touches withEvent:event];
    }
}

- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    [touchFilter touchesMoved:touches withEvent:event];
}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
    NSLog(@“ended %i”,[event allTouches].count);
    [touchFilter touchesEnded:touches withEvent:event];
}

-(void)touchesCancelled:(NSSet *)touches withEvent:(UIEvent *)event {
    NSLog(@“canceled %i”,[event allTouches].count);
    [touchFilter touchesCancelled:touches withEvent:event];
}

@end 
```

它不会延迟第一次触摸，也不会在用户使用一个手指后用两根手指触摸时停止。它仍然允许使用计时器取消刚刚开始的一键式事件。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-12-22T15:25:49.333

[Kenshi在](https://stackoverflow.com/users/382864/kenshi)**Swift 4**中的回答

 **```
for gestureRecognizer: UIGestureRecognizer in self.gestureRecognizers! {
    if (gestureRecognizer is UIPanGestureRecognizer) {
        let panGR = gestureRecognizer as? UIPanGestureRecognizer
        panGR?.minimumNumberOfTouches = 2
    }
} 
```

# msvcrt - 我应该静态还是动态链接到 Visual Studio C 运行时？

> ID：787216
> 
> 赞同：22
> 
> 时间：2009-04-24T19:23:57.673
> 
> 标签：msvcrt, crt

我已经阅读了双方关于是否应该在 Visual Studio 项目中静态或动态链接到 C 运行时库的争论，但我仍然不完全确定该怎么想。

我的项目引入了一些第三方库（Python、HDF5、Trilinos 和 Microsoft MPI），每个库都必须使用与我的最终可执行文件相同的运行时库构建（否则它们无法链接在一起）。静态链接时，这些库中的每一个都将包含 C 运行时的副本。我读到这可能会导致问题，因为最终的可执行文件将包含运行时的多个副本，它们都不能相互交互。但是如果相同的符号被多次定义，链接器不会抱怨吗？

我想避免“DLL Hell”，但我担心在运行时的多个副本中静态链接可能产生的潜在错误。我读错了吗？

此外，我使用的是 Visual Studio 2005，并且我读到 Service Pack 1 运行时不向后兼容。这是否意味着没有 SP1 构建的应用程序将无法在具有 SP1 dll 的机器上运行，即使它们具有相同的名称（例如 msvcr80.dll）？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2009-04-24T21:54:30.417

静态链接会使您的所有 EXE 和 DLL 膨胀，并可能导致崩溃（例如，如果一个 DLL 中的代码调用 free() 并使用另一个 DLL 中的 malloc() 分配的指针）。

通过动态链接和将运行时 DLL 部署为私有程序集，您可以两全其美。这只是意味着将包含运行时 DLL 及其清单的特殊命名目录的副本放在可执行文件旁边。

[有关详细信息，请参阅http://msdn.microsoft.com/en-us/library/ms235291(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms235291(VS.80).aspx)上的“将 Visual C++ 库 DLL 部署为私有程序集”部分，但基本上您的应用程序如下所示：

```
c:\Program Files\My App\MyApp.exe
c:\Program Files\My App\MyLibrary.dll
c:\Program Files\My App\Microsoft.VC80.CRT\Microsoft.VC80.CRT.manifest
c:\Program Files\My App\Microsoft.VC80.CRT\msvcr80.dll 
```

至于你的最后一个问题，是的，目标机器需要正确版本的运行时 DLL 才能工作，但是通过将它们部署为私有程序集，你可以保证这一点。

另一个好处是非管理员用户可以安装您的应用程序（不是安装到程序文件中，而是安装在其他地方）——他们不需要将文件写入 WinSxS 区域的权限。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-24T22:21:50.507

只有当您将库静态链接到 DLL 时，才会获得运行时的多个副本——每个 DLL 都会获得一个副本，exe 也将获得一个副本。如果它们*都是*静态库而不是 DLL，它们将全部链接在一起，并且您的所有库将共享相同的运行时。

这是链接器的工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T19:32:21.540

静态库不需要静态链接到其他静态库。您只需要链接主项目中的所有静态库。这样编译器就不会抱怨多个符号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T19:34:24.980

...静态执行...尝试修复DLL Hell并没有那么好...只需使用静态链接在您的安装中添加额外的200k。

# sql-server - 使用 SSIS 将视图转换为表

> ID：787230
> 
> 赞同：0
> 
> 时间：2009-04-24T19:27:37.650
> 
> 标签：sql-server, view, ssis, data-warehouse

使用 SSIS 将“db1”中的复杂视图转换为“db2”中的表是一个好主意。

将视图转换为表格的目的是使报表更快。

有什么缺点或风险吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T19:32:32.210

您会做得更好，以使您的视图模式绑定并根据需要添加索引。这样做实际上会导致 SQL Server 在您的服务器上制作视图的具体副本。

[有关详细信息，请在此 MSDN 链接](http://msdn.microsoft.com/en-us/library/ms187956.aspx)中搜索“SCHEMABINDING” 。

# .net - 数据库表复制指南

> ID：787236
> 
> 赞同：1
> 
> 时间：2009-04-24T19:29:27.723
> 
> 标签：.net, sql-server, database, linq-to-sql

我有一个恒定的数据流。所有数据都必须使用时间戳存储到数据库中。数据以 5 分钟的时间间隔出现，并在同一时间间隔内选择最新数据，使用伪 SQL 代码：

```
SELECT * FROM TB_TABLE WHERE TIMESTAMP = MAX(TIMESTAMP) 
```

随着这个表变得非常大（千兆字节），我做了一个过早的优化，将它分成两个表：一个用于所有数据（仅用于插入），另一个用于最新数据（用于插入、删除和选择）。

我想知道这种重复是否是一件好事，因为我没有指标可以证明它提高了我的应用程序性能。作为一般指导方针，你会推荐我所做的吗？

**更新**顺便说一句，我使用 MS SQL Server 2005 和 .NET C# Linq-To-Sql

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T19:39:07.607

将具有高输入量的表拆分为写入优化的“最近”表和读取优化的“存档”表通常是一个很好的优化。它确实增加了复杂性，因此您不想在不需要的地方执行此操作，但如果您确定相关表将获取大量数据，这是合理的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T19:52:03.660

我不推荐您采用的方法。如果目的是提高应用程序性能，那么首先收集性能指标会更合适。如果趋势表明随着数据量的增长而性能下降，那么很明显某些数据库更改是合适的。

假设您主要关心的是针对大型表的选择性能，那么像应用良好的索引和仅用您想要的列替换“select *”之类的步骤可能比跨多个表复制数据更好。如果您的查询有大量连接，我可以看到这会对您的性能产​​生负面影响。在这种情况下，创建一个额外的表来消除查询中的连接需求将是一个很好的优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T19:57:07.407

您没有提到您正在使用什么数据库，但我可以想到几个可能的快速优化。我们在谈论多少千兆字节？

1) 考虑到大量行，计算 max(timestamp) 可能会很昂贵。您可能已经知道这个值是什么，将其存储在不同的表或配置文件或其他东西中。这可能是您最大的优化。

2) 添加另一列以标记最近的更新。当您开始更新 SET 最近 = false WHERE 最近 = true 时，将所有记录写入最近 = true。您可以通过向它添加 where 条件来限制索引的大小 CREATE INDEX foo_index on "TB_TABLE" (recent) WHERE recent = true;

3) 确保您的数据库服务器已正确优化。确保您的键和排序缓冲区的大小适合您的数据集。大多数开源数据库都针对开发人员的工作站进行了预调，而不是生产工作负载。

4）重新考虑您的架构。你确定你需要所有的记录吗？您是否记录了所有数据而不仅仅是更改的数据？在这种情况下，我充分利用了两个时间戳，一个用于最后一次加载的时间戳，一个用于最后一次更改的时间戳。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T23:43:31.187

我想知道表分区是否会有所帮助。我没有亲自使用它，所以不能从经验中说出来，但这听起来像是使用它的适当情况。

# c# - 什么是动态语言，为什么 C# 不合格？

> ID：787239
> 
> 赞同：31
> 
> 时间：2009-04-24T19:30:15.880
> 
> 标签：c#, ruby, static-libraries, dynamic-languages

听播客，我听说 C# 不是动态语言，而 Ruby 是。

什么是“动态语言”？动态语言的存在是否意味着存在静态语言？

为什么 C# 是一种动态语言，而其他哪些语言是动态的？如果 C#*不是*动态的，那么微软为什么要大力将其推向市场？

以及为什么大多数 .NET 程序员都为之疯狂而离开其他语言并转向 C#？

为什么 Ruby 是“未来的语言”？

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2009-04-24T19:35:00.143

## 什么是动态语言？

语言是否是动态的通常是指编译器执行的绑定类型：静态或后期绑定。

静态绑定只是意味着方法（或虚拟方法的方法层次结构）在编译时绑定。运行时可能涉及虚拟调度，但方法令牌在编译时绑定。如果在编译时不存在合适的方法，您将收到错误消息。

动态语言则相反。他们在运行时完成他们的工作。他们在编译时很少或根本不检查方法的存在，而是在运行时进行。

## 为什么 C# 不是动态语言？

C#，在 4.0 之前，是一种静态绑定语言，因此不是动态语言。

## 为什么 Ruby 是未来的语言？

这个问题基于一个错误的前提，即确实存在一种语言，它是编程的未来。今天没有这样的语言，因为没有一种语言最擅长完成所有需要完成的不同类型的编程。

例如，对于许多不同的应用程序来说，Ruby 是一门很棒的语言：Web 开发是一种流行的语言。但是，我不会在其中编写操作系统。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2009-04-24T19:35:09.613

在动态语言中，您可以这样做：

```
var something = 1;
something = "Foo";
something = {"Something", 5.5}; 
```

换句话说，类型不是静态的。在静态类型语言中，这将导致编译器错误。

C、C++、C# 和 Java 等语言是静态类型的。

Ruby、Python 和 Javascript 等语言是动态类型的。

此外，这与“强或弱”类型不同。那是完全不同的东西。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-08-01T00:50:03.330

我对 c# 采用一套基本的编程范式的方式感到震惊。

我们可以说 C# 允许丰富的面向对象编程、丰富的面向组件的编程、良好集成的函数式编程、对不同类型数据源 (linq) 的完整查询操作集、通过 pLinq 和并行进行并发编程的优雅方法扩展，在下一个版本 (c# 4.0) 中将具有强大的动态功能，并且几乎可以肯定在 c# 5.0 中将具有一组可靠的元编程功能。

只能说 c# 在将所有这些强大的东西集成到一个工具箱中方面做得很好。在我看来，这就是它必须的方式，因为从一种编程语言跳到另一种编程语言几乎总是非常痛苦。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-24T19:38:52.553

C# 是一种静态类型语言，因为您正在使用的每个对象的类型都需要在编译时知道。在动态语言中，您不需要在编译时知道对象的类型。也许你导入了一些你事先不知道的类，比如你导入一个文件夹中的所有类，比如插件之类的。甚至对象的类型也可能取决于用户交互。

您可以通过使用接口或基类来实现类似的效果，但它并不完全相同，因为您仅限于使用显式继承或实现该接口的类。

在动态类型语言中，编译时它不关心类型是什么，它会尝试调用您按名称指定的方法，如果该方法在对象上不存在，它将引发运行时异常，因此由程序员来确保不会发生或适当地处理它。您获得了灵活性，但在编译时错误检查方面有所损失。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-24T19:39:47.667

查看[Wikipedia 条目](http://en.wikipedia.org/wiki/Dynamic_programming_language)，我们看到动态语言是一种在运行时执行大多数在编译时执行的操作。通常，在动态语言中，变量可以快速轻松地更改类型，并且通常没有单独的编译步骤（而是解释执行或真正快速编译）。C# 是一种更传统的语言，使用变量声明并被编译。

维基百科条目列出了许多动态语言。

另一方面，“X 是未来的 Y”意味着有人想卖给你一些东西。（不一定是字面意思，而是试图以一种方便说话者的方式影响你的信念。）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2010-02-26T11:07:14.783

您知道 VB6 既是静态的又是动态的？

如果您声明具有给定类型的变量，那么您将获得静态行为：

```
Dim name as Label 
```

您现在只能访问名称为`Label`s 的成员，而智能感知知道这一点。

如果你有一个类并添加`implements`关键字，那么你的类可以实现另一个类的方法。这是VB6允许的接口继承。您可以获得一些运行时多态性。

你也可以像这样声明变量：

```
Dim proxy As Object 
```

现在智能感知不会给你任何帮助，而 VB6 将允许你做任何你喜欢的事情`proxy`：

```
proxy.foo() 
```

这条线可以位于已编译和正在运行的程序中，不会引起任何问题，尤其是如果它没有自行运行。只有当线路运行时才会进行查找。

您还可以执行：

```
set proxy = <any instance> 
```

这将运行。`<any instance>`有没有`foo`方法并不重要。

然后可以分配任何实现的类的*任何实例，调用的方法和VB6都会很高兴。*`foo`

请注意，随着您变得越来越动态，运行时性能会受到影响。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-24T19:35:48.363

**静态**和**动态**这两个词没有明确定义。

然而，最常见的意思是两个问题：

1）在静态语言中，变量的**类型**（即变量可以包含或指向的值的类型）在程序执行过程中不能改变。例如，在 C# 中，您在定义变量时声明它的类型，例如：

```
int a; 
```

现在`a`只能保存一个`int`值——如果你试图给它分配一个字符串，或者在它上面调用一个方法，你会得到一个编译类型错误。

2）在静态语言中**，对象的类型**不能改变。在动态语言中，一个对象可以改变，因为您可以附加或删除方法和属性，从而基本上将它变成一个完全不同的对象。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-24T19:35:59.313

在 C# 3.0 中，需要在编译时知道所有内容的类型。它是一种静态语言。动态语言在运行时使用动态调度来决定事物的类型以及调用这些事物的方法。这两种语言都有其优点和缺点。C# 4.0 将添加动态功能。 [Anders Hejlsberg 在 PDC 上就静态与动态语言和 C# 4.0 进行了精彩的演讲。](http://channel9.msdn.com/pdc2008/TL16/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-04-24T19:37:02.777

动态语言通常被认为是一种可以在运行时动态解释和生成代码的语言。C# 无法做到这一点。

还有动态类型和静态类型的语言。动态类型意味着变量的类型没有设置并且可以在整个程序执行过程中改变。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-24T19:35:34.213

c#是静态类型的，即int i =0；尝试将 i 设置为字符串。编译器会抱怨，

其中，作为 python，可以将用于保存整数的变量设置为保存字符串，

静态：类型是最终的，动态：类型可以更改，

c# 正在尝试添加更多类似动态的功能，例如 var

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-04-24T19:36:27.927

没有真正的“未来语言”。不同的语言有不同的目的。最多，你可以说 Ruby 是*一种*未来的语言。

根据维基百科：

> 动态编程语言是计算机科学中广泛使用的一个术语，用于描述一类高级编程语言，它们在运行时执行其他语言在编译期间可能执行的许多常见行为，如果有的话。这些行为可能包括程序扩展、添加新代码、扩展对象和定义或修改类型系统，所有这些都在程序执行期间进行。这些行为几乎可以用任何足够复杂的语言来模拟，但动态语言提供了直接使用它们的工具。大多数动态语言都是动态类型的，但不是全部。

Ruby 是一种动态语言，而 C# 不是，因为 Ruby 是解释型的，而 C# 是编译型的。但是，C# 确实包含一些使它看起来动态的特性。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-12-03T03:17:34.957

一种语言是动态类型的，这意味着一个变量可以用于任何事情。变量没有类型，值是。变量可以具有任何原始类型的值，也可以引用任何对象。

# c# - 根据后代节点的属性选择节点的最佳 LINQ-to-XML 查询？

> ID：787240
> 
> 赞同：3
> 
> 时间：2009-04-24T19:30:45.630
> 
> 标签：c#, xml, linq-to-xml

我有以下 XML 文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<FamilyTree>
  <Parent name="Ken">
    <Child name="Lorna">
      <Grandchild name="Andrew"/>
      <Grandchild name="Brian"/>
    </Child>
    <Child name="Mike">
      <Grandchild name="Ann"/>
      <Grandchild name="Beth"/>
    </Child>
  </Parent>
  <Parent name="Norma">
    <Child name="Owen">
      <Grandchild name="Charles"/>
    </Child>
    <Child name="Peter">
      <Grandchild name="Charlotte"/>
    </Child>
  </Parent>
  <Parent name="Quinn">
    <Child name="Robert">
      <Grandchild name="Debbie"/>
      <Grandchild name="Eric"/>
    </Child>
    <Child name="Susan">
      <Grandchild name="Frank"/>
    </Child>
  </Parent>
  <Parent name="Tom">
    <Child name="Ursula">
      <Grandchild name="George"/>
      <Grandchild name="Harriet"/>
    </Child>
    <Child name="Victor">
      <Grandchild name="Ian"/>
      <Grandchild name="Juliet"/>
    </Child>
  </Parent>
</FamilyTree> 
```

我正在尝试选择拥有至少两个孩子（“孙子”）的孩子的所有“父母”。请注意，我*不是*在寻找至少有两个“孙子 [ren]”的“父母”。

以下 LINQ 查询有效，但我觉得它不是最优雅的。

```
IEnumerable<XElement> parents = (from c in familyTreeElement.Descendants("Child")
                                 where c.Elements().Count() > 1
                                 select c.Parent).Distinct(); 
```

有没有更好的方法来指定这个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T19:39:15.500

Hmmm... I'm finding it hard to get my head round it exactly :)

Normally to find out if there are *any* elements, I'd use `Any` - but you want to see if there are *at least two* elements. We still don't need to use `Count` though - because there being at least two elements is the same as skipping an element and seeing if there are still any. So...

```
var parents = familyTreeElement.Elements("Parent")
    .Where(parent => parent.Elements("Child").Any(
                     child => child.Elements("Grandchild").Skip(1).Any())); 
```

I think that works - and actually it doesn't read *too* badly:

For each parent, see whether *any* of there children has *any* (grand)children after ignoring the first (grand)child.

I suspect using XPath (as per Marc's answer) would be the most readable option though.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T19:42:47.957

Ahh the edit (2 grand-children) helps ;-p

While `XDocument` is useful, at times I miss XPath/XQuery. With `XmlDocument` you could just use `doc.DocumentElement.SelectNodes("Parent[Child/Grandchild[2]]")`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T19:38:43.600

我对“类 SQL”语法的了解不足以保证如果我这样写我会得到正确的语法，但是你想使用`.Any()`而不是`.Count()`，如果你以不同的方式选择，你不会最后不需要`Distinct()`。试试这个：

```
IEnumerable<XElement> parents =
    familyTreeElement.Elements("Parent").Where(
        parent => parent.Elements("Child").Any(
            child => child.Elements().Count() >= 2)); 
```

**EDIT:** If you want to ensure that there are at least 2, you do pretty much have to use `.Count()`.

# python - 是否可以动态定义函数参数的名称？

> ID：787262
> 
> 赞同：2
> 
> 时间：2009-04-24T19:36:01.280
> 
> 标签：python, django

现在我有这个代码：

```
 attitude = request.REQUEST['attitude']
        if attitude == 'want':
            qs = qs.filter(attitudes__want=True)
        elif attitude == 'like':
            qs = qs.filter(attitudes__like=True)
        elif attitude == 'hate':
            qs = qs.filter(attitudes__hate=True)
        elif attitude == 'seen':
            qs = qs.filter(attitudes__seen=True) 
```

动态定义“attitudes__xxxx”的名称会更好。有什么办法吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-24T19:41:33.747

是的。

```
qs.filter( **{ 'attitudes__%s'%arg:True } ) 
```

# sql-server - 如何获取以 UTF-8 格式存储为 windows-1252 的 SQL Server 2005 数据？

> ID：787265
> 
> 赞同：1
> 
> 时间：2009-04-24T19:36:55.303
> 
> 标签：sql-server, sql-server-2005, encoding

我有一个客户端数据库，其中包含 Windows-1252 编码的英语和法语数据。我需要获取这些数据作为 AJAX 调用的一部分并以 UTF-8 格式发送。

有没有办法可以通过存储过程传递数据来执行这种转换？

我的网络应用程序无法更改以自行执行此转换。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-28T02:21:31.513

Microsoft 已发布适用于 SQL Server 2008 的 UTF-8 CLR UDT，可安装在 SQL Server 2005 上。请参见此处：[msdn.microsoft.com/en-us/library/ms160893.aspx](http://msdn.microsoft.com/en-us/library/ms160893.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T20:41:14.570

尝试转换为 nvarchar 甚至更好地使用 nvarchar 列

# html - 尝试跨浏览器内联块技巧时 Firefox 2 冻结

> ID：787268
> 
> 赞同：1
> 
> 时间：2009-04-24T19:37:21.107
> 
> 标签：html, css, firefox, firefox2

我正在尝试设计一个使用 CSS inline-block 显示值进行表格排列的表单。我知道包括Firefox 2在内的一些浏览器不知道如何处理它，所以我使用这种方法使其在所有浏览器中都能正常工作。但是，有时当我在 Firefox 2 中尝试时，浏览器会冻结。我的 CPU 使用率接近 100%，有时内存使用率会迅速增加到一个巨大的值。有谁知道为什么会发生这种情况或如何解决它？这是显示此问题的页面的简单示例：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>-moz-inline-stack test</title>
<style type="text/css">
div {
    display: -moz-inline-stack;
}
</style>
</head>
<body>
<div>
    <input type="radio" name="test" value="yes">
    <br>
    <input type="radio" name="test" value="no">
</div>
</body></html> 
```

它在 Firefox 3 中运行良好，但它冻结了 Firefox 2。 <br> 标签对于该错误不是必需的，但它可以防止输入相互重叠。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T21:08:29.670

试试这个

```
div {
  display: -moz-inline-box;
  display: inline-block;
  } 
```

# javascript - 学习 jQuery 并精通 Javascript

> ID：787271
> 
> 赞同：19
> 
> 时间：2009-04-24T19:38:08.670
> 
> 标签：javascript, jquery, html, css

在过去的几年里，我看到 jquery 突飞猛进。每次我看一些 jquery 代码时，我都觉得我缺少一些我需要学习的东西。我已经尝试过他们的文档，对于基本的东西似乎没问题。

你们能推荐一本可能有帮助的好书吗？我正在寻找一些对 jquery 的理论部分没有深入了解的东西，但实际上却做了并展示了如何做所有很酷的东西的例子。

回到我上学的时候，我从不关心 JS、CSS、HTML ......但是现在放学 3 年后，我看到自己做了很多服务器端 Web 开发。我想学习这些技术。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-24T19:46:52.923

[我认为您首先学习javascript](http://www.w3schools.com/JS/default.asp)会更好，然后您可以从那里学习它的库，例如 jQuery。我推荐的书是[JQuery in Action](http://www.scribd.com/doc/8635225/jQuery-in-Action)，它是最好的 IMO，最近我发现了一个链接，它使第一章免费在线，只是为了给你一点品味。相信我值得购买

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-24T19:49:09.143

我认为你最好先学习 JavaScript。在没有背景知识的情况下学习图书馆会让你在最糟糕的时候变得高高在上。

此外，当你意识到你可以在 1 行中完成过去需要 50 行的事情时，你会*更加*欣赏 jQuery 。:)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-24T19:51:17.000

查看[Jquery 了解绝对初学者视频系列](http://blog.themeforest.net/screencasts/jquery-for-absolute-beginners-video-series/)。我喜欢这个页面上的博客。检查一下，您将了解 JQuery 和一些额外的 Javascript 所需的内容。我相信该链接将向您展示了解所需的 JQuery 功能所需的基础知识。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-24T20:41:32.620

[这些书](http://www.amazon.com/s?ie=UTF8&search-type=ss&index=books&field-author=John%20Resig&page=1)都是（共同）由同时编写 jQuery 的 John Resig 撰写的。

对于一般的 JS，我也听说过非常好的事情： [JavaScript: The Good Parts](https://rads.stackoverflow.com/amzn/click/com/0596517742)，Douglas Crockford 为 Yahoo! 工作。

[Crockford 和 Resig 在YUI 剧院](http://developer.yahoo.com/yui/theater/)都有免费和全面的视频。这三个有利于对一般 JS 的广泛概述：

*   Douglas Crockford — JavaScript 编程语言
*   Douglas Crockford — 高级 JavaScript
*   Douglas Crockford — 一个不方便的 API：DOM 理论

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-24T20:27:55.307

当这本书出版时，你会从编写 jQuery 的人那里学到*很多关于如何编写好的 javascript 的知识。*就个人而言，我等不及它出来了。

说真的……这个一出来就值得入手了……

[JavaScript 忍者的秘密](http://jsninja.com/)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-24T19:44:05.910

最好的起点之一是 jQuery 教程：

[教程 - jQuery](http://docs.jquery.com/Tutorials)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-04-24T20:13:21.143

我开始在一个项目中使用 jQuery，并且正在向 jquery 网站和我的同事学习。在阅读 jQuery in Action 之后，我学到了很多我错过的东西。我真的很喜欢阅读这本书。仍然是一个很好的参考。Jquery in Action 还介绍了一些jquery 的插件。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-24T19:42:57.927

这里有两篇很好的入门文章：

[http://msdn.microsoft.com/en-us/magazine/dd453033.aspx](http://msdn.microsoft.com/en-us/magazine/dd453033.aspx)

[http://msdn.microsoft.com/en-us/magazine/dd569752.aspx](http://msdn.microsoft.com/en-us/magazine/dd569752.aspx)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-04-24T19:46:09.807

阅读文档 - jQuery 有很好的支持以及 jquery.com 本身的大量示例。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-04-24T20:25:05.187

1.  先学语言：[Javascript The Definitive Guide, 5th Edition](https://rads.stackoverflow.com/amzn/click/com/0596101996)

2.  学习 jQuery：[jQuery 在行动](https://rads.stackoverflow.com/amzn/click/com/1933988355)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-05-06T13:42:42.260

我推荐以下网址提供的文章和视频（截屏视频）：

[http://www.jqueryfordesigners.com/](http://www.jqueryfordesigners.com/)

因为作者 Remy Sharp 描述了他做出选择的方式和*原因*，您可以从头到尾看到进展。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-04-24T20:48:38.593

一个很好的起点是它的在线文档。

JQuery 为您提供了“少写多做”的绝佳机会。但是 javascript 的编写和调试不太舒服。我认为深入研究 javascript 没有多大意义。我建议你看看 GWT。您可以在 java 中编写代码，这些代码将自动生成为有效的 javascript。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-04-24T20:57:18.277

看看这些视频系列，它们很棒！[关联](http://blog.themeforest.net/tutorials/jquery-for-absolute-beginners-video-series/)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-04-24T19:52:54.610

是的，我同意 Mark，首先从[w3schools](http://www.w3schools.com)的 Javascript 本身开始。如果您需要学习 HTML 和 CSS，[w3schools](http://www.w3schools.com)是最好的学习场所。然后尝试使用[JQuery](http://docs.jquery.com/Main_Page)解决您的问题。我认为这会更有效。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-04-24T19:55:44.633

我同意下面的马克赫德。首先学习 Javascript。

第一本让我“啊哈——太棒了”的书是[DOM Scripting: Web Design with JavaScript and the Document Object Model](https://rads.stackoverflow.com/amzn/click/com/1590595335)

一旦你掌握了这些基础知识，jQuery 所做的事情对你来说就会变得更自然，而且看起来很容易。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-04-24T20:15:59.953

[http://www.quirksmode.org/](http://www.quirksmode.org/)

和他关于 JavaScript 的书[ppk](https://rads.stackoverflow.com/amzn/click/com/0321423305)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-07-08T13:33:40.337

[Rebecca Murphey](http://www.rebeccamurphey.com/)（因[Yayquery Podcast](http://yayquery.com/)成名）发布了一本她的 jQuery 培训材料书。 [它可以在这里找到](http://jqfundamentals.com/)。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-04-25T13:36:37.080

这个链接收集了你想知道的关于 JQuery 的几乎所有内容

[JQuery 备忘单](http://speckyboy.com/2008/04/02/65-excellent-jquery-resources-tutorialscheat-sheetsebooksdemosplugins/)

这里有一个入门教程 -[在 ASP.NET 中使用 JQuery 入门](http://www.dotnetcube.com/post/Getting-started-with-JQuery-in-ASPNET.aspx)

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-04-26T21:35:26.407

另一本好书（连同“jQuery in Action”）是“ [Learning JQuery 1.3](http://www.packtpub.com/learning-jquery-1.3/book) ”，这是（我认为）第一本 jQuery 书的更新版本。

来自亚马逊产品描述：*“需要基本的 JavaScript 编程知识。您需要了解 HTML 和 CSS 的基础知识，并且应该熟悉 JavaScript 的语法”*。

# javascript - IE 7 嵌入 winform 应用程序正在冻结整个 winform 应用程序

> ID：787275
> 
> 赞同：0
> 
> 时间：2009-04-24T19:38:56.343
> 
> 标签：javascript, winforms, internet-explorer, webbrowser-control

我们偶然发现了通常的周五下午错误......

我们有一个使用 WebBrowser 控件的 .NET 2.0 WinForms 应用程序（部署在 XP 平板电脑版上，带有最新的 IE 7）。在页面的某个时刻，我们隐藏了 a并使用一些 JavaScript`div`设置了一个值。`textbox`此时，操作正在运行（文本出现在 中`textbox`），但整个窗口现在被冻结。最小化/最大化窗口没有响应，等等：似乎不再处理 Windows 消息。

如果我单击此窗口之外的任何位置（任务栏、另一个打开的窗口），则先前冻结的窗口现在可以正常工作。我重做相同的操作，再次发生锁定。这是系统的，可以随时在这台特定的机器上复制。

我们无法使用各种机器在内部复制它。

在同一台机器上，如果我导航到同一页面并直接使用 IE 7 执行相同的操作，一切正常……非常令人沮丧。

关于什么可能导致这种行为的任何想法？检查什么？显然页面没有抛出 JavaScript 错误。

感谢您的任何想法或指示

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T19:49:52.590

用于 Windows 窗体的 .NET 2.0 WebBrowser 有问题；我们在实现中遇到了很多不同的错误，包括一些导致 AccessViolationExceptions 崩溃的互操作错误，我们现在正在远离嵌入式 IE 并使用 Mozilla。

我讨厌成为一个悲观主义者，但可嵌入的 IE 控件只是垃圾。

您可能想查看[Mono.WebBrowser](http://mono-project.com/WebBrowser)控件。相同的托管编程接口，但使用 Firefox 的 Gecko 引擎和 Chrome 和 Safari 的 WebKit 引擎的替代实现。

另一种选择是跳过 .NET 2.0 WebBrowser 包装器并通过 mshtml 接口直接使用 ActiveX IE 控件。不幸的是，生成的 mshtml 包装器中甚至存在一些错误。

底线：我推荐[Mono.WebBrowser](http://mono-project.com/WebBrowser)。

# sql-server - 对连接到网络存储设备的数据库进行负载测试

> ID：787286
> 
> 赞同：2
> 
> 时间：2009-04-24T19:42:15.570
> 
> 标签：sql-server, performance, load-testing, nas

我们正在研究对数据库的 NAS 系统进行压力测试，基本上是想看看它可以承受多少滥用以及它对数据库性能的影响有多大。这是我们计划的

*   我有一个正在构建的测试工具，它将启动可配置数量的运行 sql 查询的线程（也是可配置的，并考虑让它能够运行多个查询）
*   使用 SQLIOSim 实用程序模拟 SQL Server 活动
*   将大量数据复制到设备上或从设备上复制下来（同时）

谁能想到我们可以做的任何其他事情（这是可重复的）来给系统施加负载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T20:09:46.177

您还需要模拟数据库和 NAS 之间的网络状况。随着越来越多的流量进入网络，其可实现的利用率下降，这将严重影响您的性能。

举例来说。如果您在 1Gbps 网络上有 50 台机器并且网络的利用率接近 100%，那么数据链路层的数据包冲突和重试意味着您的有效总传输量只是您只有两个通信器所能实现的网络潜力的一小部分网络上。更糟糕的是，随着重试次数的增加，有效负载也会增加。面对高峰需求，你会得到一个丑陋的反馈循环。

那里有许多网络流量模拟器和生成器，但恐怕我从未使用过它们中的任何一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T04:32:46.467

您可以查看 Pole Position，这是一个通用的数据库性能测试套件。 [http://www.polepos.org/](http://www.polepos.org/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T22:36:32.097

根据您希望通过负载测试实现的目标，您可能还想考虑使用 SQLIO 而不仅仅是 SQLIOSim。SQLIOSim 非常适合用于压力测试和模拟 SQL Server 负载，如果检测到任何 IO 错误，它将从绿色变为红色。尽管[KKline](http://sqlblog.com/blogs/kevin_kline/archive/2007/06/28/understanding-sqliosim-output.aspx)给出了一些见解，但它的输出有点神秘。

如果您想连续执行一项操作，例如大型随机读取或大型顺序写入以及介于两者之间的任何操作，SQLIO 很有用。它还将为您提供一些有用的输出统计信息，您可以将其绘制成图表并用作比较。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-13T16:14:12.150

你可以试试英特尔的[IoMeter](http://www.iometer.org/)

# python - 如何转换 SVG 图像以用于 Pisa / XHTML2PDF？

> ID：787287
> 
> 赞同：3
> 
> 时间：2009-04-24T19:42:30.813
> 
> 标签：python, pdf, pdf-generation, svg, pisa

我正在使用[Pisa/XHTML2PDF](http://www.xhtml2pdf.com/)在 Django 中动态生成 PDF。不幸的是，我还需要包含 SVG 图像，我认为这不是一件容易的事。

a）将 SVG 转换为 PNG/JPG（在 Python 中）或 b）在比萨的 PDF 导出中包含 SVG 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T21:30:50.083

有基于 Java 的 Apache [Batik SVG 工具包](http://xmlgraphics.apache.org/batik/tools/rasterizer.html)。

在[关于 C# 的类似问题中](https://stackoverflow.com/questions/58910/converting-svg-to-png-using-c)，有人建议为此使用[Inkscape 的命令行版本](http://harriyott.com/2008/05/converting-svg-images-to-png-in-c.aspx)。

对于 Python，这里有一个来自[这个讨论线程](http://coding.derkeiler.com/Archive/Python/comp.lang.python/2007-09/msg02200.html)的有用建议：

```
import rsvg
from gtk import gdk
h = rsvg.Handle('svg-file.svg')
pixbuf = h.get_pixbuf()
pixbuf.save('foobar.png', 'png') 
```

[Lukasz](https://stackoverflow.com/users/211413/lukasz)`from gtk import gdk`建议的步骤是必要的，并且必须在创建 pixbuf 之前，否则您将无法获得[原始海报](https://stackoverflow.com/users/22468/nick-sergeant)所观察到的方法。`save`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-04-16T12:57:40.557

“我让 rsvg 正常工作，但这是我尝试保存时得到的结果：AttributeError: 'gtk.gdk.Pixbuf' object has no attribute 'save' – Nick Sergeant 2009 年 4 月 25 日 0:10”

您需要导入 gdk 才能访问 pixbuf 方法：

```
import rsvg
from gtk import gdk
h = rsvg.Handle('svg-file.svg')
pixbuf = h.get_pixbuf()
pixbuf.save('foobar.png', 'png') 
```

并从包含 svg 数据的字符串转换：

```
import rsvg
from gtk import gdk
h = rsvg.Handle()
h.write(svg_string)
h.close()
pixbuf = h.get_pixbuf()
pixbuf.save('foobar.png', 'png') 
```

# c++ - 在 vs2008 SP1 中禁用检查迭代器时出现问题 (_HAS_ITERATOR_DEBUGGING=0)

> ID：787288
> 
> 赞同：7
> 
> 时间：2009-04-24T19:42:38.643
> 
> 标签：c++, visual-studio-2008, debugging, crash, iterator

当我尝试禁用检查的迭代器时，我在调试模式下运行 vs2008 SP1 时遇到了一些问题。以下程序重现了该问题（字符串析构函数中的崩溃）：

```
#define _HAS_ITERATOR_DEBUGGING 0

#include <sstream>

int do_stuff(std::string const& text)
{
    std::string::const_iterator i(text.end());
    return 0;
}

int main()
{
    std::ostringstream os;
    os << "some_text";
    return do_stuff(os.str());
} 
```

我在 gamdev.net 上找到了一个[类似的帖子](http://www.gamedev.net/community/forums/topic.asp?topic_id=374918)，讨论了在 vs2005 中遇到这个问题。该帖子中的示例程序按原样在 2008 SP1 上为我编译 - 但是当我修改它以使用 ostringstream 时，我能够解决问题。

从调试器中四处寻找，看起来该库将迭代器从堆栈中弹出，然后尝试在 _Orphan_All 中使用它们，这是某种迭代器检查清理代码...

其他人可以重现这个问题或告诉我发生了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T17:30:26.533

我刚刚在 Windows XP 上的 VS2008 中尝试过这个，并且在 SP1 之前和之后的 VS2008 上都收到了有关缓冲区溢出的警告。

有趣的是，问题似乎集中在通过引用或按值将字符串传递给 do_stuff - 如果我使用原始代码，它会抱怨缓冲区溢出，但如果我按*值*传递字符串，它运行良好。这与多线程调试 DLL 运行时有关。当您喜欢静态 MT 调试运行时，该错误就会消失。

在这两种情况下，预编译头文件都已关闭，通常生成预编译头文件的文件已从项目中删除。

在阅读[了 MSDN 上的这篇文章](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=352680)后，我想知道如果您使用调试 DLL 运行时构建（只需尝试将 VS2008 生成的二进制文件与早期的图书馆并注意未解决的外部因素以确认这一点）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T20:28:38.283

看起来这是 VS2005 中的一个已知错误，已在 VS2005 SP1 中修复：

*   [http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=99655](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=99655)

看起来这是由在 gamedev.net 上发布的那个人提交的。

我不确定它是如何或为什么会悄悄回到 VS2008 的（您是否有来自 VS2005 的标头可能会妨碍或其他什么？）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T19:52:53.907

您的代码在我的 VS2005 上的调试/发布模式下运行良好。我已关闭预编译头文件并使用运行时库的多线程 DLL 版本。

在 Vista 机器上使用 VS2008 SP1 检查（无预编译头文件，多线程 DLL）。工作得很好。

检查您的安装。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-07T12:34:39.623

我在微软网站上报告了这个问题。他们承认了这个错误并说他们已经为下一个版本修复了它。

[http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=435483](http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=435483)

# java - Spring MVC 控制器 HTTP GET 查询参数

> ID：787291
> 
> 赞同：6
> 
> 时间：2009-04-24T19:43:25.460
> 
> 标签：java, spring-mvc

**我如何在没有注释的情况下创建和连接一个控制器，该控制器将根据查询参数执行操作？**

所以也许我有一个页面，上面有一个项目列表，每个项目都是一个链接，如“edititem.htm?id=5”。当用户单击链接时，我希望控制器加载“item #5”并将其传递给我的编辑表单。

很抱歉提出这样一个愚蠢的问题，但由于某种原因，我在网上找不到任何这样做的例子。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T20:05:16.047

您应该有一个映射到 edititem.htm 的控制器。（也许是[SimpleFormController](http://static.springframework.org/spring/docs/2.5.5/api/org/springframework/web/servlet/mvc/SimpleFormController.html)）

覆盖两个 showForm 方法之一以使用项目填充模型：

```
protected ModelAndView showForm(HttpServletRequest request, HttpServletResponse response, BindException errors){
//get the id
int id = Integer.parseInt(request.getParameter("id"));

// get the object
Item item = dao.getItemById(id);
return  new ModelAndView(getFormView(), "item", item);
} 
```

此外，请参阅[Spring 的 SimpleFormController 的不同视图](https://stackoverflow.com/questions/762104/different-views-with-springs-simpleformcontroller)

# configuration - Hadoop：从 HDFS 映射/减少

> ID：787295
> 
> 赞同：0
> 
> 时间：2009-04-24T19:45:24.470
> 
> 标签：configuration, input, hadoop, mapreduce

我可能错了，但是我在 Apache Hadoop 中看到的所有（？）示例都将存储在本地文件系统上的文件（例如 org.apache.hadoop.examples.Grep）作为输入

有没有办法在 Hadoop 文件系统 (HDFS) 上加载和保存数据？例如，我在 HDFS 上使用了一个名为“stored.xls”的制表符分隔文件`hadoop-0.19.1/bin/hadoop dfs -put ~/local.xls stored.xls`。我应该如何配置 JobConf 来阅读它？

谢谢 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T20:21:13.543

```
JobConf conf = new JobConf(getConf(), ...);
...
FileInputFormat.setInputPaths(conf, new Path("stored.xls"))
...
JobClient.runJob(conf);
...

```

setInputPaths 会做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-09T19:19:28.373

Pierre，Hadoop 的默认配置是在本地模式下运行，而不是在分布式模式下运行。您可能只需要修改 hadoop-site.xml 中的一些配置。看起来您的默认文件系统仍然是 localhost，而它应该是 hdfs://youraddress:yourport。查看 fs.default.name 的设置，并查看[Michael Noll 博客](http://www.michael-noll.com/wiki/Running_Hadoop_On_Ubuntu_Linux_(Multi-Node_Cluster))上的设置帮助以获取更多详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-14T17:02:31.047

FileInputFormat.setInputPaths(conf, new Path("hdfs://hostname:port/user/me/stored.xls"));

这会做

# linq-to-sql - 不允许在查询中显式构造实体类型“###”。

> ID：787296
> 
> 赞同：37
> 
> 时间：2009-04-24T19:45:40.010
> 
> 标签：linq-to-sql

使用 Linq 命令和 Linq To SQL 数据上下文，我试图以这种方式从我的数据上下文中实例化一个名为“Produccion”的实体：

```
Demo.View.Data.PRODUCCION pocoProduccion = 
(
    from m in db.MEDICOXPROMOTORs
    join a in db.ATENCIONs on m.cmp equals a.cmp
    join e in db.EXAMENXATENCIONs on a.numeroatencion equals e.numeroatencion
    join c in db.CITAs on e.numerocita equals c.numerocita
    where e.codigo == codigoExamenxAtencion
    select new Demo.View.Data.PRODUCCION
    {
         cmp = a.cmp,
         bonificacion = comi,
         valorventa = precioEstudio,
         codigoestudio = lblCodigoEstudio.Content.ToString(),
         codigopaciente = Convert.ToInt32(lblCodigoPaciente.Content.ToString()),
         codigoproduccion = Convert.ToInt32(lblNroInforme.Content.ToString()),
         codigopromotor = m.codigopromotor,
         fecha = Convert.ToDateTime(DateTime.Today.ToShortDateString()),
         numeroinforme = Convert.ToInt32(lblNroInforme.Content.ToString()),
         revisado = false,
         codigozona = (c.codigozona.Value == null ? Convert.ToInt32(c.codigozona) : 0),
         codigoclinica = Convert.ToInt32(c.codigoclinica),
         codigoclase = e.codigoclase,
    }
).FirstOrDefault(); 
```

在执行上述代码时，我收到以下错误，其中包含堆栈跟踪：

```
System.NotSupportedException was caught
  Message="The explicit construction of the entity type 'Demo.View.Data.PRODUCCION' in a query is not allowed."
  Source="System.Data.Linq"
  StackTrace:
       en System.Data.Linq.SqlClient.QueryConverter.VisitMemberInit(MemberInitExpression init)
       en System.Data.Linq.SqlClient.QueryConverter.VisitInner(Expression node)
       en System.Data.Linq.SqlClient.QueryConverter.Visit(Expression node)
       en System.Data.Linq.SqlClient.QueryConverter.VisitSelect(Expression sequence, LambdaExpression selector)
       en System.Data.Linq.SqlClient.QueryConverter.VisitSequenceOperatorCall(MethodCallExpression mc)
       en System.Data.Linq.SqlClient.QueryConverter.VisitMethodCall(MethodCallExpression mc)
       en System.Data.Linq.SqlClient.QueryConverter.VisitInner(Expression node)
       en System.Data.Linq.SqlClient.QueryConverter.Visit(Expression node)
       en System.Data.Linq.SqlClient.QueryConverter.VisitFirst(Expression sequence, LambdaExpression lambda, Boolean isFirst)
       en System.Data.Linq.SqlClient.QueryConverter.VisitSequenceOperatorCall(MethodCallExpression mc)
       en System.Data.Linq.SqlClient.QueryConverter.VisitMethodCall(MethodCallExpression mc)
       en System.Data.Linq.SqlClient.QueryConverter.VisitInner(Expression node)
       en System.Data.Linq.SqlClient.QueryConverter.ConvertOuter(Expression node)
       en System.Data.Linq.SqlClient.SqlProvider.BuildQuery(Expression query, SqlNodeAnnotations annotations)
       en System.Data.Linq.SqlClient.SqlProvider.System.Data.Linq.Provider.IProvider.Execute(Expression query)
       en System.Data.Linq.DataQuery`1.System.Linq.IQueryProvider.Execute[S](Expression expression)
       en System.Linq.Queryable.FirstOrDefault[TSource](IQueryable`1 source)
       en Demo.View.InformeMedico.realizarProduccionInforme(Int32 codigoExamenxAtencion, Double precioEstudio, Int32 comi) en D:\cs_InformeMedico\app\InformeMedico.xaml.cs:línea 602
       en Demo.View.InformeMedico.UpdateEstadoEstudio(Int32 codigo, Char state) en D:\cs_InformeMedico\app\InformeMedico.xaml.cs:línea 591
       en Demo.View.InformeMedico.btnGuardar_Click(Object sender, RoutedEventArgs e) en D:\cs_InformeMedico\app\InformeMedico.xaml.cs:línea 683
  InnerException: 
```

现在在 LINQ2SQL 中允许这样做吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-24T19:52:59.383

实体可以在查询之外创建并使用 DataContext 插入到数据存储中。然后，您可以使用查询检索它们。但是，您不能将实体创建为查询的一部分。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-08T21:33:55.637

我发现这个限制非常烦人，并且违背了在查询中不使用 SELECT * 的普遍趋势。

仍然使用 c# 匿名类型有一种解决方法，通过将对象获取到匿名类型，然后将其复制到正确的类型中。

例如：

```
var q = from emp in employees where emp.ID !=0
select new {Name = emp.First + " " + emp.Last, EmployeeId = emp.ID }
var r = q.ToList();
List<User> users = new List<User>(r.Select(new User
   {
        Name = r.Name,
        EmployeeId = r.EmployeeId 
   })); 
```

在我们处理单个值的情况下（如问题中描述的情况），它更容易，我们只需要直接复制值：

```
var q = from emp in employees where emp.ID !=0 
select new { Name = emp.First + " " + emp.Last, EmployeeId = emp.ID }
var r = q.FirstOrDefault();
User user = new User { Name = r.Name, EmployeeId = r.ID }; 
```

如果属性的名称与数据库列匹配，我们可以在查询中更简单地执行 select

```
var q = from emp in employees where emp.ID !=0 
select new { emp.First, emp.Last, emp.ID } 
```

可以继续编写一个 lambda 表达式，该表达式可以根据属性名称自动复制，而无需显式指定值。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-12-19T01:42:27.257

这是另一种解决方法：

1.  创建一个派生自 LINQ to SQL 类的类。我假设您要返回的 L2S 类是 Order：

    ```
    internal class OrderView : Order { } 
    ```

2.  现在以这种方式编写查询：

    ```
    var query = from o in db.Order
                select new OrderView // instead of Order
                {
                   OrderID = o.OrderID,
                   OrderDate = o.OrderDate,
                   // etc.
                }; 
    ```

3.  将结果重新转换为 Order，如下所示：

    ```
    return query.Cast<Order>().ToList(); // or .FirstOrDefault() 
    ```

4.  （或者使用更合理的东西，比如 BLToolkit / LINQ to DB）

注意：我没有测试过跟踪是否有效；它可以检索数据，这是我所需要的。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-01-11T09:42:59.650

我发现，如果您在尝试构建新对象之前对查询执行 .ToList() ，则它可以工作

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-04-30T07:23:20.070

我刚刚遇到了同样的问题。

我找到了一个非常简单的解决方案。

```
var a = att as Attachment;

Func<Culture, AttachmentCulture> make = 
    c => new AttachmentCulture { Culture = c };

var culs = from c in dc.Cultures
           let ac = c.AttachmentCultures.SingleOrDefault( 
                                           x => x.Attachment == a)
           select ac == null ? make(c) : ac;

return culs; 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-01-30T18:47:54.433

我构造了一个匿名类型，使用 IEnumerable（保留延迟执行），然后重新构造 datacontext 对象。Employee 和 Manager 都是 datacontext 对象：

```
 var q = dc.Employees.Where(p => p.IsManager == 1)
            .Select(p => new { Id = p.Id, Name = p.Name })
            .AsEnumerable()    
            .Select(item => new Manager() { Id = item.Id, Name = item.Name }); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-21T16:00:53.750

我找到了解决该问题的另一种解决方法，它甚至可以让您将结果保留为 IQueryale，因此它实际上不会执行查询，直到您希望它被执行（就像使用 ToList() 方法一样）。

所以 linq 不允许您创建实体作为查询的一部分？您可以将该任务转移到数据库本身并创建一个函数来获取您想要的数据。将函数导入数据上下文后，只需将结果类型设置为所需的类型。

* * *

当我不得不编写一段代码来生成 a 时，我发现了这一点`IQueryable<T>`，其中项目实际上并不存在于包含 T 的表中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-25T09:33:33.333

在“70-515 Web Applications Development with Microsoft .NET Framework 4 - Self-paced training kit”一书中，第 638 页有以下示例将结果输出到强类型对象：

```
 IEnumerable<User> users = from emp in employees where emp.ID !=0
    select new User
    {
    Name = emp.First + " " + emp.Last,
    EmployeeId = emp.ID
    } 
```

Mark Pecks 的建议似乎与这本书相矛盾——然而，对我来说，这个例子仍然显示上述错误，让我有些困惑。这与版本差异有关吗？欢迎任何建议。

# .net - Linq to SQL - 返回前 n 行

> ID：787302
> 
> 赞同：83
> 
> 时间：2009-04-24T19:47:44.247
> 
> 标签：.net, linq-to-sql

我想使用 Linq 返回前 100 条记录。

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2009-04-24T19:48:59.643

使用 Take 扩展方法。

```
var query = db.Models.Take(100); 
```

* * *

## 回答 #2

> 赞同：57
> 
> 时间：2009-04-24T19:49:37.520

你想使用 Take(N);

```
var data = (from p in people
           select p).Take(100); 
```

如果你也想跳过一些记录，你可以使用 Skip，它会跳过前 N 个数字：

```
var data = (from p in people
           select p).Skip(100); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2011-06-03T06:30:44.640

Example with order by:

```
var data = (from p in db.people  
            orderby p.IdentityKey descending 
            select p).Take(100); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T19:51:02.650

使用`Take()`扩展

例子：

```
var query = (from foo in bar).Take(100) 
```

# c# - 如何在未注册的情况下使用 Win32 中的 .Net 程序集？

> ID：787303
> 
> 赞同：9
> 
> 时间：2009-04-24T19:47:51.830
> 
> 标签：c#, delphi, interop

我想从 Delphi Win32 应用程序动态加载和使用用 C# 创建的 .Net 程序集。我的类和接口被标记为 ComVisible，但我想避免注册程序集。这可能吗？

PS 我在这里找到了关于该主题的另一个很好的讨论[链接文本](https://stackoverflow.com/questions/258875/hosting-the-net-runtime-in-a-delphi-program)，但更多的是围绕托管 CLR。这引出了一个问题 - 为什么要托管 CLR 而不是使用 ClrCreateManagedInstance？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-24T19:50:25.397

奇怪的是，我在 StackOverflow 上找不到答案，而且网上也没有什么，尤其是对于 Delphi。[我从此处](http://interop.managed-vcl.com/)发布的示例中找到了解决方案。这是我最后得到的：

```
function ClrCreateManagedInstance(pTypeName: PWideChar; const riid: TIID;
out ppObject): HRESULT; stdcall; external 'mscoree.dll';

procedure TMyDotNetInterop.InitDotNetAssemblyLibrary;
var
  MyIntf: IMyIntf;
hr: HRESULT;
NetClassName: WideString;
begin
//Partial assembly name works but full assembly name is preffered.
    NetClassName := 'MyCompany.MyDLLName.MyClassThatImplementsIMyIntf,
          MyCompany.MyDLLName';
    hr := ClrCreateManagedInstance(PWideChar(NetClassName), IMyIntf, MyIntf);
    //Check for error. Possible exception is EOleException with ErrorCode
    //FUSION_E_INVALID_NAME = $80131047 2148732999 : The given assembly name 
    //or codebase was invalid.
    //COR_E_TYPELOAD = $80131522 - "Could not find or load a specific type 
    //(class, enum, etc)"
    //E_NOINTERFACE = $80004002 - "Interface not supported".
    OleCheck(hr);
end; 
```

顺便说一句，根据情况，您可能希望动态加载 mscoree.dll，因为它可能不存在于系统上（没有 .Net Framework 的 XP）

编辑：不幸的是，正如我刚刚发现的那样，这已被弃用并停止使用 .Net4。这只剩下两个选项 - [CLR 托管和非托管导出](https://stackoverflow.com/questions/2048540/hosting-clr-in-delphi-with-without-jcl-example)。此外，[.Net4 COM 代码的调试也被破坏了](https://stackoverflow.com/questions/6102882/debugging-net4-com-registered-assembly-from-win32-caller-in-visual-studio-2010)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T19:50:53.303

也许使用 RegFreeCOM 和一个 COM-Callable Wrapper。

[http://msdn.microsoft.com/en-us/magazine/cc188708.aspx](http://msdn.microsoft.com/en-us/magazine/cc188708.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T19:49:27.503

不幸的是（据我所知）如果不暴露 COM 对象就无法做到这一点，因为 .NET dll 并未真正编译为 Delphi（或其他任何东西）可以加载的库，因为这一切都是由 JIT 编译器在运行时完成的.

# java - 是否有任何类似 Python 的 Java 交互式控制台？

> ID：787313
> 
> 赞同：81
> 
> 时间：2009-04-24T19:50:55.800
> 
> 标签：java, console

最近我花了很多时间在 Java 中进行编程，而我错过了脚本语言的一件事是能够在控制台中测试它们。

为了快速测试一个 java 程序，我必须编辑一个文件，然后将其转换为字节码并执行它。即使使用 IDE，在第 372 次之后它也失去了乐趣。

我想知道是否有一种产品具有交互式控制台（我敢打赌你需要一个 JIT 编译器）和一些自动完成功能（我想这是可能的）。

也许这是我不知道的非常常见的事情，或者是完全不可能的事情，但这是最糟糕的问题:-)

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-04-24T19:54:29.160

是的; [jshell](https://docs.oracle.com/javase/9/jshell/introduction-jshell.htm#JSHEL-GUID-630F27C8-1195-4989-9F6B-2C51D46F52C8)，在此之前一些接近的近似是[Groovy](http://groovy-lang.org/)、[Clojure](http://clojure.org/)、[Scala](http://www.scala-lang.org/)和[Bean Shell](http://www.beanshell.org/)。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-04-24T20:04:00.853

有趣的是，您将获得一个带有[Jython](http://www.jython.org/Project/)的交互式控制台！你不会得到*更多*类似 Python 的东西。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2014-08-18T15:49:49.410

Java REPL [http://www.javarepl.com/term.html](http://www.javarepl.com/term.html)

使用 intellij 插件： [http ://plugins.jetbrains.com/plugin/7215?pr=](http://plugins.jetbrains.com/plugin/7215?pr=)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-11-20T16:49:05.413

试试[Java 博士的](http://drjava.org)“交互窗格”。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-01-15T15:28:20.780

JShell 现在是 Java 9 中的标准。 [JShell 介绍](https://docs.oracle.com/javase/9/jshell/introduction-jshell.htm)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-04-24T20:01:50.000

我使用过的一种成功的方法是在 Eclipse 中调试并使用显示视图。显示视图为您提供的是通过执行 Java 语句来操作当前在 JVM 中运行的代码的能力。在您停止的特定断点处可用的任何对象都在显示视图的范围内。虽然这不是您正在寻找的内容，但它确实提供了 REPL 为其他编程环境提供的一些功能。有关更多信息，请参阅[使用 Eclipse 平台进行调试。](http://www.ibm.com/developerworks/library/os-ecbug/ "使用 Eclipse 平台进行调试")

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-24T20:13:38.990

您也可以执行 Scala 交互式解释器。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-04-24T19:55:35.087

您可能对[Groovy](http://groovy.codehaus.org)感兴趣。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-11-02T08:54:53.093

您可以使用[BeanShell](http://www.beanshell.org/)运行任意 Java 代码。如果您想要 Eclipse 集成， [EclipseShell](http://eclipse-shell.sourceforge.net/)具有 BeanShell 支持。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-11-23T10:08:29.970

Jgrasp IDE 有一个交互式控制台，您可以在其中进行测试，我经常使用它，并且在您使用它们后，还有一个调试视图显示 variabel 等。

它是opensoruce，您可以在 [http://www.jgrasp.org/获得一份副本](http://www.jgrasp.org/)

// 安德斯

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-04-24T19:59:37.137

我偶尔会遇到同样的问题并有部分解决方案。我保留了一个文件（正如查理马丁所说，Java 需要它的类上下文），它只不过是一个测试程序。在第二个窗口（控制台）中，我运行了一个脚本，它每隔一两秒检查一次源文件的修改时间。当它看到源代码更改时，它会重新编译它（我通常在 C 中摆弄，但我也用 Java 完成过）并执行结果。

这不是一个很好的解决方案，但它是一个快速的一次性解决方案，我发现它非常有用。

# windows - 在 Windows 中休眠单个进程

> ID：787318
> 
> 赞同：11
> 
> 时间：2009-04-24T19:52:19.213
> 
> 标签：windows, process, process-migration

是否有任何库或软件或任何方式将 Windows 中单个进程的状态保存到文件中，然后将正在运行的进程恢复到运行状态，并且所有内存都已在以后加载？

我知道必须重新打开打开的句柄，可能必须启动线程等，但是至少可以恢复堆和单个线程堆栈吗？

我看到了[这个问题](https://stackoverflow.com/questions/192838/can-you-freeze-a-c-c-process-and-continue-it-on-a-different-host)，但答案都是针对 linux 的，而且大多数人都说无法做到。

我知道我可以使我所有的数据结构可序列化并自己完成，但我想知道如果没有它是否有可能。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-24T21:04:16.670

[Raymond Chen](http://en.wikipedia.org/wiki/Raymond_Chen_(Microsoft))（当谈到晦涩的 Windows 知识时，他甚至可能会踢 Jon Skeet 的屁股）说[这是不可能的](http://blogs.msdn.com/oldnewthing/archive/2004/04/20/116749.aspx)。

本质上，除非您的进程完全不使用系统资源（例如任何类型的句柄），否则总会有一些您无法保存和恢复的操作系统状态。

解决此问题的最实用方法是创建一个运行另一个 Windows 实例的 VM，并在其中运行您的进程：

*   [您可以使用nLite](http://www.nliteos.com/)使来宾操作系统尽可能轻量级。
*   然后，您可以使用[VMWare VIX API](http://www.vmware.com/support/developer/vix-api/)以编程方式挂起/恢复 VM。
*   这当然会暂停来宾操作系统以及您的进程，从而解决操作系统状态问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-10T18:15:58.570

*>> •您可以使用nLite 使guest OS 尽可能轻量级。*

添加到上述声明 - Windows XP 的官方轻量级版本是“XP Embedded”或“ [Windows Embedded Standard](http://www.microsoft.com/windowsembedded/en-us/products/westandard/default.mspx) ”。它是一个高度组件化的 XP 版本，可让您将 XP 映像缩小至 40 MB。

Windows 7 的“轻量级”版本是 Windows Embedded Standard 2011，目前处于测试阶段，可供下载 (connect.microsoft.com/windowsembedded)

当然，它不像 NLite 那样是免费软件。

谢谢，

斯里坎特

# vim - 在 VI 中对齐列

> ID：787322
> 
> 赞同：6
> 
> 时间：2009-04-24T19:54:12.703
> 
> 标签：vim, vi

我有一堆行，我想分成两列，并从每一列中获取数据。数据看起来像这样：

```
current_well.well_number
current_well.well_name
current_well.well_type_code
well_location.section
well_location.range 
```

本质上，我想做的是根据期间拆分行，将数据转换为两列，然后获取每列的数据。我知道这可以在 Excel 中完成，但我对解决这个问题的 VI 解决方案非常感兴趣。我知道

```
%s/\./ 
```

将用空格格式化字符串。但是一旦我的数据看起来像：

```
current_well    well_number
current_well    well_name
current_well    well_type_code
well_location   section
well_location   range 
```

如何获取每列的所有值，以便将其粘贴到另一个应用程序中？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-06-10T18:06:31.063

linux column 命令非常适合创建列

```
:%!column -s . -t 
```

然后使用块复制。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-24T21:01:35.990

一种选择是使用此[对齐插件](http://www.vim.org/scripts/script.php?script_id=294)来排列句点，以便您可以更轻松地在可视块模式下选择一列。例如，如果你这样做：

```
:%Align \. 
```

你最终会得到：

```
current_well  . well_number
current_well  . well_name
current_well  . well_type_code
well_location . section
well_location . range 
```

如果您不想使用插件，请尝试用空格填充列。例如对于您的文字：

```
:%s/\v(.*)\.(.*)/\=printf("%-16s %s", submatch(1), submatch(2))/ 
```

这会给你留下：

```
current_well     well_number
current_well     well_name
current_well     well_type_code
well_location    section
well_location    range 
```

然后，您可以`Ctrl-V`选择要复制的一列文本。只要确保您选择的列宽比您的最宽值宽。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-24T20:48:27.910

我已经多次遇到这个问题。将点更改为制表符会使它们排列得*很好*，但不是真的。的确，所有列都将从一个制表位开始，但不能保证它们会在同一个制表位上。例如，如果这是您的原始文本：

```
lt1tab.value1
gt1tabstop.value2 
```

你也是：

```
%s/\./\t/g 
```

并假设一个制表位是 8 个空格，你会得到：

```
lt1tab  value1
gt1tabstop    value2 
```

您可能想要做的是删除除最后一列（或您想要的任何一列）之外的所有内容。例如：

```
%s/^.*\.// 
```

会给你留下：

```
value1
value2 
```

您可以轻松复制和粘贴。

* * *

如果你不必使用 Vim，你可以使用 unix`cut`来做你想做的事：

```
cut -f2 -d. input_file > output_file 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-12-12T00:15:33.623

我一直这样做，只需用大量空间填充：

```
%s/./                     / 
```

然后`<c-v>`在空白处进入块模式，绘制我想要的列位置，`<`将文本向右移动到我的列，然后按住`.`。需要几秒钟。

如果您知道要排列的特定列位置，则可以使用另一种方法：转到第一行并开始记录 ( `qq`)，找到您的分隔符 ( `f.`)，插入一堆空格 ( `20i <esc>`)，将空格删除回特定列 ( `d15|`)，然后向下移动一行 ( `j`)。然后，您只需按住 shift 并滚动手指`@Q`多次（或使用 count `10@q`），直到所有列都排好。:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T21:01:05.443

显然，上述带有块选择和/或 Excel 的方法更容易。但我是一个受虐狂，我决定假设您无权访问其中任何一个，并尝试仅使用 vi 命令来完成。这是我想到的可怕的事情：

我的基本计划是将连接列列表变成两个列表，一个接一个。这基本上包括将每一行分成两行，然后将每隔一行复制到文件末尾。

所以，首先我们必须用这个命令把每一行分成两行：

```
:%s/\./^M/ 
```

接下来，在文件底部摆动并创建一个空行，然后返回第一行。这将有助于以后的可读性。

```
Go[Esc]
:1 
```

现在，您需要将以下序列映射到您喜欢的键：

```
:map [Key] mkjddGp'kj 
```

（对于记录，这会标记当前行，删除它下面的行，将该行粘贴到文件底部，返回到您开始的行，然后移动到下一行。）

最后，为列表中的每一行按一次映射键。因此，对于示例列表，您需要按 5 次。确保从列表的第一行开始！！

最后你将拥有以下内容：

```
current_well
current_well
current_well
well_location
well_location

well_number
well_name
well_type_code
section
range 
```

您现在可以轻松地将每个列表复制到需要放置它们的任何位置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-24T20:01:27.600

一种可能的解决方案：

1.  w（或 W for WORDS）跳转到下一个单词，
2.  `CTRL`- `R` `CTRL`-`W`获取光标下的单词并将其粘贴到命令行

现在您必须将这些命令链接在一个循环中，然后以您自己的方式输出它们。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-24T20:01:34.277

为什么不阻止视觉模式？Cv，选择您想要的，然后将其粘贴到其他应用程序中。对于那种粘贴，你可能应该设置

```
:set guioptions+=a 
```

也是。

嗯，现在我重新阅读了你的问题。您是在问如何将数据分成列，或者如何将其粘贴到其他应用程序中？

* * *

我想我现在明白了（第三次阅读）。

照你做的那样做，得到以前点所在的空间。然后再做一次替换，用制表符替换空格，每个制表符是 15 或其他东西。它会很好地排列它们。然后您可以选择并将它们复制到任何地方。

例如，您也可以匹配正则表达式以选择第二列，但是尽管它像圣诞树一样亮起，但您将无法拉动它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-24T20:05:15.173

`Ctrl-V``Ctrl-G`您可以通过键入或`Ctrl-Q``Ctrl-G`（取决于您是否使用 Windows 插入键映射）然后用鼠标选择来选择 gvim 中的列。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-24T20:06:13.750

Ctrl V 选择一列

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-24T20:41:00.313

我会将点转换为制表符，然后块选择每一列：

:%s/\./ *CtrlV-Tab* /g

*CtrlV*然后阻止选择列。

或者，由于您有制表符分隔值，它们将直接粘贴到 Excel 中的列中。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-02-05T00:32:54.407

在文件的顶部：

```
!}awk -F. '{print $1}' >> % 
```

您将被告知文件已更改。选择`L`（加载）选项。
在原行下面添加一个空行，回到顶部。

```
for(i=1;i<=NR;i++);print $2 >> % 
```

再次选择`L`选项

删除原来的行。
您现在有两组中的第一部分和第二部分。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-07-30T21:45:03.823

```
nnoremap <BS> v"by:%!column -t -s<C-r>b -o'      '<CR> 
```

这是遵循@NES 和@SergioAraujo 想法的一个很好的解决方案。把它放在你的 vimrc 中。

用法。将光标移动到分隔符。然后按退格键。

解释我们使用命名寄存器 b 来保存我们的分隔符。然后将其替换为列 UNIX 实用程序的 --separator 选项的变量。

Backspace 是一个很好的键，因为在普通模式下与 h 相同。但话又说回来，你也可能会不小心撞到它。

# c# - 你什么时候使用扩展方法，分机。方法与继承？

> ID：787324
> 
> 赞同：61
> 
> 时间：2009-04-24T19:55:25.367
> 
> 标签：c#, .net

我们开始使用 C# (.NET 3.0)，我想知道你们是如何使用扩展方法的？你什么时候使用它们？

此外，如果您还列出使用它们的所有黑暗先决条件，我将不胜感激。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-04-24T19:59:49.930

使用扩展方法的时间：

*   当你不控制被扩展的类型时
*   您不想强制实现者提供可以使用现有方法完成的代码

以第二点为例；您可能在`IList<T>`（例如，`Sort`）上有一个扩展方法，可以完全使用现有`IList<T>`成员编写......那么为什么要强迫其他人写任何东西呢？这是 LINQ 的基础块，允许 Microsoft 在不破坏任何内容的情况下提供更多功能*。*

**不**使用扩展方法的时间：

*   当多态性很关键时；您不能保证您的代码将是使用扩展方法执行的版本，因为直接在类型上的方法优先
*   当您需要访问私人/受保护成员时

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-04-24T19:58:04.223

扩展方法允许扩展现有类，而无需依赖继承或更改类的源代码。这意味着如果你想在现有的 String 类中添加一些方法，你可以很容易地做到这一点。在决定是否使用扩展方法时，需要考虑以下几个规则：

*   扩展方法不能用于覆盖现有方法

*   不会调用与实例方法具有相同名称和签名的扩展方法

*   扩展方法的概念不能应用于字段、属性或事件

*   谨慎使用扩展方法......过度使用可能是一件坏事！

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-07-04T15:44:27.420

此链接[http://geekswithblogs.net/BlackRabbitCoder/archive/2010/04/26/c-extension-methods---to-extend-or-not-to-extend.aspx](http://geekswithblogs.net/BlackRabbitCoder/archive/2010/04/26/c-extension-methods---to-extend-or-not-to-extend.aspx) 提供了有关何时使用扩展方法的良好指导什么时候没有。

引用这篇文章：

> 一个好的扩展方法应该：
> - 应用于它扩展的类型的任何可能的实例。
> - 简化逻辑并提高可读性/可维护性。
> - 适用于最具体的类型或适用的接口。
> - 在命名空间中隔离，以免污染 IntelliSense。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-04-24T20:03:04.477

我在有意义的时候使用扩展方法。如果您控制一个类及其代码，通常不需要扩展方法。

如果你*不这样做*，扩展方法可能会很有用。

我经常使用扩展方法的一个地方是 [Flags] 枚举。当您有一个基于标志的枚举时，需要一个相当大的表达式来确定枚举值是否具有特定的标志集。因此，每当我构建 [Flags] 枚举时，我都会构建以下扩展方法：

```
[Flags]
public enum MyEnum
{
    FlagA,
    FlagB,
    // etc.
}

public static class MyEnumExt
{
    public static bool HasFlags(this MyEnum item, MyEnum query)
    {
        return ((item & query) == query);
    }
} 
```

这样我的代码看起来像：

```
MyEnum flags = MyEnum.FlagA;
if(flags.HasFlags(MyEnum.FlagA))
{
  // handle FlagA
} 
```

而不是：

```
MyEnum flags = MyEnum.FlagA;
if((flags & MyEnum.FlagA) == MyEnum.FlagA)
{
  // handle FlagA
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-02-06T23:27:16.200

老实说，我想说当它***不是***一个好主意时比当它是一个好主意时更容易解释。

我认为，扩展方法的主要好处是它们可能会***增加对您的方法的采用***。这是因为用户不必为了使用您的方法而实例化另一个类的实例，并且当开发人员正在为您正在扩展的类寻找方法时，智能感知会宣传您的方法。如果您试图让其他开发人员在您的公司中遵循新标准，这可能很重要。

在考虑是否创建扩展方法时，请记住**SOLID**原则。

> **单一**责任： - 你几乎总是至少用扩展方法弯曲单一责任原则，因为你正在处理已经是一个类的东西（你要么无法控制，要么太害怕触摸）。
> 
> **开放**/关闭原则： - 扩展方法不能被覆盖，这意味着您的方法可能没有充分“开放扩展”。
> 
> **L** iskov 替换原则： - 如果您有任何类型的继承结构，您将无法在子类型上使用扩展方法。
> 
> **接口隔离原则： -虽然**您可以“扩展”一个接口，但您必须为该扩展提供具体的实现。因此，您不能针对可以在不同上下文中以不同方式实现的接口进行编程（例如单元测试）
> 
> **依赖**倒置原则： - 如果您的代码有任何依赖项，您将如何为工厂和单元测试公开这些依赖项（依赖倒置原则）？

最后，扩展方法只是***穿着新衣服的静态方法***。因此，静态方法（如***线程安全、垃圾回收等***）的所有困难都伴随着扩展方法在您实现时出现。

因此，我会考虑将方法编写为扩展，并**重新考虑使用工厂和基本辅助**类。

如果您确实编写了扩展方法，请使其非常简单。尽量避免有任何依赖项（或将所有依赖项作为参数传递）。并注意在多线程环境中如何管理内存和锁定资源。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-07-08T17:05:29.523

什么是扩展方法？

扩展方法使您能够将方法添加到现有类型，而无需创建新的派生类型、重新编译或以其他方式修改原始类型。

扩展方法是一种特殊的静态方法，但它们被称为扩展类型的实例方法。

如何使用扩展方法？

扩展方法是静态类的静态方法，其中“this”修饰符应用于第一个参数。第一个参数的类型将是扩展的类型。

仅当您使用 using 指令将命名空间显式导入源代码时，扩展方法才在范围内。

使用扩展方法的要点：

1.扩展方法必须定义在顶级静态类中。

2.与实例方法同名和签名的扩展方法不会被调用。

3.扩展方法不能用于覆盖现有方法。

4.扩展方法的概念不能应用于字段、属性或事件。

5.过度使用扩展方法不是一种好的编程风格。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-30T18:08:30.693

当“Is-A”关系有意义时使用继承。继承在类之间创建了不需要的依赖关系。

当我觉得“如果 XYZ 类有 ABC 方法会有什么好处”时，我会使用扩展方法。

我记得最好的例子是当我需要将集合分成块时使用扩展方法。这是详细信息。

[https://www.codingcrest.com/extension-method-in-c/](https://www.codingcrest.com/extension-method-in-c/)

# code-metrics - 如何获得可维护性指标？

> ID：787328
> 
> 赞同：1
> 
> 时间：2009-04-24T19:56:40.340
> 
> 标签：code-metrics, ndepend, cql

如何使用 cql 创建可维护性索引？NDepend 是否计算这个数字？

谢谢！

亚历杭德拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-27T19:57:11.523

不知道CQL。SD 的 C# Metrics 工具直接计算 SEI 可维护性指数。请参阅 [C# 度量工具](http://www.semanticdesigns.com/Products/Metrics/CSharpMetrics.html)。

# python - 如何使用 Aptana Studio 在 mac os x 和 windows 上安装 Python？

> ID：787330
> 
> 赞同：2
> 
> 时间：2009-04-24T19:57:11.993
> 
> 标签：python, aptana

如何让 python 与 aptana studio 一起工作？

~~我已经下载了很多东西，但它们似乎都没有给我一个直接的文本编辑器，我可以在其中将代码解释为可执行类型的东西。我知道 IDLE 中有交互模式，但我想实际使用编辑器。所以我下载了 Aptana studio 的 pydev 扩展，但它要我配置一个 python 解释器（所以我猜它实际上没有）。我在哪里可以找到适用于此的直接 python 解释器？或其他IDE？~~

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T19:58:44.267

这比你想象的要容易。首先，默认情况下，您的机器上有一个 python 版本。不过，这有点过时了。

[MacPorts](http://macports.org)是获得很多好东西的好方法。

[ActiveState](http://ActiveState.com)有一个[Python Mac 包](http://www.activestate.com/activepython/)可免费下载。

[Python.org](http://Python.org)还将引导您选择其他一些选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-11T19:28:26.810

在 Mac 上添加当前的 Python 版本：

1.  通过 Aptana Studio 3/Preferences/PyDev/Interpreter-Python 添加新的解释器。
2.  给它命名（使用终端检查版本，然后`python`使用`/usr/bin/python`.
3.  然后添加路径（在我的情况下为 2.7）：`/System/Library/Frameworks/Python.framework/Versions/2.7/bin/python`

如果您安装自己的（在我的情况下为 2.6），请改用以下路径： `/Library/Frameworks/Python.framework/Versions/2.6/Resources/Python.app/Contents/MacOS/Python`

不要忘记点击“应用”按钮...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T20:10:42.400

Idle 有一个完整的文本编辑器——打开一个“新窗口”并输入。请务必在运行之前保存它。

您不喜欢 IDLE 编辑器的哪些方面？

另外，看看[Komodo Edit](http://www.activestate.com/komodo_edit/) for Mac OS X。非常好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T01:13:18.677

对于 Windows，我推荐前面提到的 ActivePython。主要是因为它带有 Python win32，无论如何你*最终都会*安装它。

其次，如果您来自 Java 和 C# 领域，您可能对 IDE 期望过高。我最终发现，更强大的 IDE 只会让事情变得比它们提供的帮助更困难。所以我的建议是尝试做一些简单的事情。换句话说，选择可以让你投入并开始编码的东西，而不是用很多你可能根本不需要的功能来打扰你。:-)

编辑：另一件事，找到并安装[pip](http://pip.openplans.org/)。它使安装 python 包变得更加容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T01:00:08.693

在 Mac OS X Leopard 和 Tiger 上，已经安装了 Python。

在 Mac 上，我尝试了一些编辑器。Textmate是我目前的选择。如果您正在寻找免费的，我真的很喜欢 Xcode。但是你必须从命令行运行你的脚本。

如果你想要一个跨平台的环境，你可以试试 Eclipse 和 pydev 扩展。因此，您不会在两个平台之间迷路。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-03-01T05:42:33.463

对于 Windows 操作系统，如果您想使用 Aptana Studio 使用 python。您必须使用解释器进行一些简单的基本设置。有关详细的分步指南。您可以按照此网站链接 [http://www.infoknol.com/aptana-python-setup-guide/](http://www.infoknol.com/aptana-python-setup-guide/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-24T20:07:40.550

Windows 列表中的许多站点都反映了 Mac 列表。

[Python.org](http://python.org/download/)有 Win32 和 Win64 安装程序。

ActiveState 有一个免费的[Python Win32 包](http://www.activestate.com/activepython/)可免费下载。没有 Win64 版本（还没有？）。

[PyWin32](http://sourceforge.net/projects/pywin32/)是一个 Python 包，带有用于与 Windows 交互的额外模块。 **这不是 Python 本身。** 不过，这些还没有针对 Python 3.0 进行更新。尽管有这个名字，但这个站点上有一个适用于 Python 2.6 的 Win64 版本。

# asp.net-mvc - 这是 CheckBox HtmlHelper 的意外行为吗？

> ID：787332
> 
> 赞同：2
> 
> 时间：2009-04-24T19:57:30.167
> 
> 标签：asp.net-mvc

我的视图页面包含一个按示例搜索的表单，其中包含以下复选框代码：

```
<td>
<label for="HasProcessErrors">Has Errors:</label>
<%= Html.CheckBox("HasProcessErrors", crit.HasProcessErrors) %>
</td> 
```

crit 对象 HasProcessErrors 属性是一个初始值为 false 的布尔值。当我查看渲染页面的源代码时，我看到帮助程序生成了以下 HTML：

```
<td>
<label for="HasProcessErrors">Has Errors:</label>
<input id="HasProcessErrors" name="HasProcessErrors" type="checkbox" value="true" /><input name="HasProcessErrors" type="hidden" value="false" />
</td> 
```

我是否在这里错误地使用了 CheckBox 助手，或者发生了什么奇怪的事情？似乎它应该生成一个带有checked =“”的复选框类型的输入。

感谢您的任何想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T20:18:12.693

是的，这是正确的。

复选框的语义与你想象的有点不同；一个选中的复选框不会发布一个指示其选中/未选中状态的值，而是发布其“值”属性中的任何内容，而未选中的复选框则不发布任何内容。

由于还有一个同名的隐藏字段，如果您调试表单提交，您会发现选中的复选框的值为“true,false”，而未选中的复选框的值为“false”

您可以通过测试是否包含“true”来确定是否选中了复选框。

```
公共 ActionResult（FormCollection 表单）
{
   bool check = form["checkbox_id"].ToString().Contains('true');
}

```

# visual-studio - 如何防止 Visual Studio 调试器可视化工具超时？

> ID：787334
> 
> 赞同：35
> 
> 时间：2009-04-24T19:57:58.280
> 
> 标签：visual-studio, debugging, debuggervisualizer

我已经成功制作了几个 Visual Studio 调试器可视化工具，它们运行良好，除了在某些对象上，当我尝试反序列化对象时出现超时错误`objectProvider.GetObject()`

```
System.Exception: Function evaluation timed out.
  at Microsoft.VisualStudio.DebuggerVisualizers.DebugViewerShim.PrivateCallback.MaybeDeserializeAndThrowException(Byte[] data) 
```

超时发生得相当快（可能在我单击可视化工具图标后大约一秒钟），即使我的其他一些可视化工具工作正常，即使大数据对象显示时间更长（5-10 秒）并且仍然没有暂停。

我已经制作了一个自定义对象源，以将序列化限制为我需要显示的字段。我还能做些什么来让数据反序列化而不会超时？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2009-07-31T11:38:07.437

```
HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\9.0\Debugger 
```

我认为这没有记录，但您可以尝试更改上述注册表项中的一些超时，然后重新启动 Visual Studio。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-25T13:52:09.903

I was recently hit by this in VS2012 and after googling I found [this](http://connect.microsoft.com/VisualStudio/feedback/details/614606/debug-visualizer-for-datatable-cause-debugger-to-crash-function-evaluation-timed-out):

> As the exception message says, this exception means the debugger visualizer for the datatable is timed out. In VS debugger, each expression evaluation windows(such as watch window, locals window, datatips, autos window etc..) has different default max expression evaluation timed out value. For datatip, we prefer to give a short time out value because otherwise it will provide a poor user expression. If you do want to use the visualizer functionality for that datatable, you may add the expression to a watch and try to visualize it.(Because watch window has a longer timeout value). If you do want to get rid of this timeout in datatip, you may try to increase the timeout value for datatip. The timeout value is a setting in "DataTipTimeout" registry key under: HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\10.0\Debugger Note: you should probe WOW64Node for 64bit OS. You can also see other windows' default timeout value under this key.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-31T20:03:14.117

要让 Visual Studio 调试器正常工作 - “WPF 可视化工具”中的“Locals”窗口（在 WPF 应用程序中测试），您需要在注册表中找到：HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\12.0\Debugger\ DWORD 参数“LocalsTimeout”和默认值(1000) 设置为足够大的值，例如 5000。

# java - BigDecimal：Java 编译器能否优化除以 1 的乘法？

> ID：787336
> 
> 赞同：0
> 
> 时间：2009-04-24T19:58:09.887
> 
> 标签：java, optimization, bigdecimal

在谈论 BigDecimal 时，Java 编译器是否会删除乘法 1？

我站在与此类似的地方：

```
BigDecimal bd = getBigDecimal();//get arbitrary bigDecimal, could be anyone.

bd = bd.multiply(new BigDecimal(getOneTwoOrThree()); 
```

getOneTwoOrThree 方法声明为：

```
/* 
 * Always returns Integers 1, 2 or 3.
 */
 Integer getOneTwoOrThree(){
     //some code
 } 
```

所以，基本上。

如果`getOneTwoOrThree()`返回 1，编译器会执行乘法吗？或者它会没有指令吗？
这有点存在疑问，但我想我在某种程度上处于早期优化阶段。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T20:00:08.540

No.`BigDecimal`是一个库类（它甚至不在`java.lang`），因此编译器将其视为任何其他类。

`BigDecimal` *可以*在内部对此进行特殊处理，但显然不是。

（**编辑：**我应该补充一点，JIT 编译器可能会发挥一些作用，但我必须做一些测试才能确定。）

我只建议您将代码更改为使用[`BigDecimal.valueOf()`](http://java.sun.com/javase/6/docs/api/java/math/BigDecimal.html#valueOf(long))，因为 1、2 和 3 是由`BigDecimal`.

```
bd = bd.multiply(BigDecimal.valueOf(getOneTwoOrThree()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-08-11T13:05:27.707

如果您的函数不是确定性的，则无论如何都无法在编译时对其进行优化。

# .net - 将 CLR 主机注入正在运行的进程中 - 可能吗？

> ID：787343
> 
> 赞同：3
> 
> 时间：2009-04-24T20:00:28.710
> 
> 标签：.net, x86, code-injection, clr-hosting

我知道，这条路很疯狂。

我有一个我想通过 .NET 扩展的可执行文件（我无权访问的源代码）。它是本机可执行文件，因此我需要注入 CLR 主机才能执行此操作。我的基本想法是通过 .NET 语言（例如 C#）提供类似脚本的功能，并在目标可执行文件中提供挂钩以供脚本操作，反之亦然。

我知道我需要使用各种技术来实现这一点 - DLL 注入、一些运行时 ASM 注入等，但我想知道的是：我所说的可能吗？更好的是 - 以前有人做过这样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T21:52:43.823

如果您的本机可执行文件能够使用 COM 对象，您可以使用 COM 互操作来执行此操作。如果您为互操作注册您的.NET 程序集，那么您的本机可执行文件可以使用您的.NET 类，就像“普通”COM 对象一样，当第一个对象被创建时，它将在本机进程中启动 CLR。同样，如果您可以从本机可执行文件中公开 COM 对象，那么如果您创建互操作程序集（或者甚至没有类型库，如果您只使用 IDispatch），您可以从您的 .NET 代码中使用它们。

基础很简单，但我只是触及表面 - 对于像这样的严肃项目，您需要认真的参考。我强烈推荐[.NET 和 COM，](https://rads.stackoverflow.com/amzn/click/com/067232170X) Adam Nathan 的完整互操作性指南。这是一本大书，没有多少未说的内容，而且它还提供了很多关于设计 .NET 和 COM 类以实现干净互操作的重要信息。它还解释了如何在本机应用程序中直接托管 CLR，但如果不访问源代码，该选项可能不切实际。我肯定会从 COM 互操作路由开始，如果您没有其他选择，则仅在本机托管 CLR。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-09T15:39:09.787

我们实际上为自动化框架做了一些非常相似的事情。您可能想查看 CodePlex 上的[EasyHook](http://easyhook.codeplex.com/ "易钩")项目。它有很多不错的功能，包括用于跨进程通信的内置 IPC Communicator。它需要一些腿部工作，但应该完全符合您的要求。

# wpf - XamlReader.Load(XmlReader)“堆栈空”XamlParseException

> ID：787344
> 
> 赞同：0
> 
> 时间：2009-04-24T20:00:47.540
> 
> 标签：wpf, exception, xaml, load, runtime

我正在尝试在运行时加载 xaml 文件。我的代码如下所示：

```
StringReader stringReader = new StringReader(xamlString);           
            XmlReader xmlReader = XmlReader.Create(stringReader);
            content = XamlReader.Load(xmlReader); 
```

它基本上是msdn的复制粘贴。XamlReader.Load 行引发 XamlParseException，内部异常为“Stack Empty at line...”。
它指向的行是在 xaml 字符串中找到的用户控件的结束标记，即字符串的最后一行。

Xaml基本结构如下

```
<UserControl>
    <UserControl.Resources>
    </UserControl.Resources>
    <Grid>
    </Grid>
</UserControl> 
```

谷歌搜索没有任何结果。非常感谢您在寻找解决方案方面的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-24T20:42:09.560

我刚开始从我的 xaml 中切块，直到错误消失。我能够将其缩小到在我的用户控件声明中找到的这一行

```
<UserControl
...
WPFManagement:ObjectReference.Declaration="{WPFManagement:ObjectReference thisPointer}"
...> 
```

不完全确定为什么会引发 Stack Empty 异常，但确实如此。

这是整个标题，罪魁祸首是粗体

```
<UserControl 
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
         xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
         xmlns:WPFManagement="clr-namespace:A;assembly=A"
         xmlns:WPFControls="clr-namespace:B;assembly=B"
         xmlns:ModuleUI="clr-namespace:C;assembly=C"
         xmlns:GeneralUI="clr-namespace:D;assembly=D"
         **WPFManagement:ObjectReference.Declaration="{WPFManagement:ObjectReference thisPointer}"**
         mc:Ignorable="d"
         WPFControls:UIExtension.Caption="Filler"
         WPFControls:UIExtension.Icon="Icon"
         d:DesignWidth="910"
         d:DesignHeight="730"> 
```

# ruby-on-rails - 具有不同数据库表的 ActiveRecord 继承

> ID：787349
> 
> 赞同：3
> 
> 时间：2009-04-24T20:01:49.363
> 
> 标签：ruby-on-rails, inheritance, activerecord, sti

我刚刚开始研究在 Rails 中使用更高级的模型。我经常使用的一个非常成功的模型是一个类访问多对多交叉引用关系的模型，该类本身是多对多关系中基类的子类。

这样，交叉引用类可以充当基类的替代品。

一个很好的例子是导航层次结构节点 (NavigationNode) 与用户角色交叉引用。在交叉引用点，一个类 (RoleNavigationNode) 可以从 NavigationNode 继承，并且仍然对用户角色有深入的了解。

我的问题是（在上述情况下）RoleNavigationNode 是否可以从 NavigationNode 继承，但可以访问交叉引用表，而不是 NavigationNode 访问的表——这当然是使用 ActiveRecord。

我没有研究多态关联，这可能更合适。

提前致谢...，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-02-29T22:05:34.347

这适用于 Rails 3：

```
class Common < ActiveRecord::Base
  @abstract_class = true
  def common
    "Foobar!"
  end
end

class Model < Common
end

class AnotherModel < Common
end 
```

如果没有设置，Rails 将在您的数据库中`abstract_class`查找一个名为的表。`commons`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-01T13:58:52.373

尝试`set_table_name`过子类？

另外，请查看`@abstract_class`模型类中的设置。

最后，您需要的可能只是一个包含在两个模型中的 Mixin。

无论如何，你正在尝试做的事情听起来相当非 ActiveRecord-ish。您可能想发布一个更清晰的示例来说明您要实现的目标，也许我们可以想出一些更简单的东西。

# regex - 如何检测正则表达式中的确切长度

> ID：787354
> 
> 赞同：13
> 
> 时间：2009-04-24T20:02:50.327
> 
> 标签：regex

我有两个正则表达式来验证输入的值。

一种允许任意长度的字母数字值：

```
@"^\s*(?<ALPHA>[A-Z0-9]+)\s*" 
```

而另一个只允许数值：

```
@"^\s*(?<NUM>[0-9]{10})" 
```

如何获得长度为 11 的数字字符串不会被`NUM`正则表达式捕获。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-24T20:08:50.623

我认为你想说的是你不想允许超过 10 位数字。因此，只需`$`在末尾添加一个来指定正则表达式的结尾。

例子：`@"^\s*(?[0-9]{10})$"`

* * *

这是我的原始答案，但我认为我读得太准确了。

```
string myRegexString = `@"(?!(^\d{11}$)` ... your regex here ... )"; 
```

上面写着“虽然前面不是，开始，11 位数字，结束”

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-24T20:10:38.780

如果它是单行，您可以指定您的匹配必须发生在行尾，就像在.net中这样......

```
^\s*([0-9]{10})\z 
```

这将接受 1234567890 但拒绝​​ 12345678901。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T03:17:39.127

您的意思是要匹配*最多*10 位数字？试试这个：

```
@"^\s*[0-9]{1,10}\s*$" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T20:15:47.737

如果您尝试仅匹配 10 位长的数字，只需使用 $ 添加尾随锚点，如下所示：

```
^\s*(?:[0-9]{10})\s*$ 
```

这将匹配任何正好 10 位数长的数字（两边都有可选空间）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-28T04:22:23.580

```
var pattern =/\b[0-9]{10}$\b/;

// the b modifier is used for boundary and $ is used for exact length
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-24T20:07:05.980

在长度为 10 的字符串之后匹配非数字的内容。我的 regex-foo 不是那么好，但我认为你已经在那里设置了它来捕获长度为 10 的数字字符串，但是由于你在那之后不匹配任何东西，长度为 11 的字符串也会匹配。尝试匹配超出数字的末尾，你会很好。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-24T20:07:07.570

可以换个试试？

```
^\s*(?\d{1,10}|\d{12,}) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-24T20:15:01.983

这应该只匹配 10 位数字，并允许在数字前后有任意数量的空格。

非捕获版本：（只匹配，不存储匹配的数字）

```
^\s*(?:\d{10})\s*$ 
```

捕获版本：（匹配的数字在子组 1 中可用，如 $1 或 \1）

```
^\s*(\d{10})\s*$ 
```

# monitoring - SNMP监控简介

> ID：787359
> 
> 赞同：9
> 
> 时间：2009-04-24T20:04:29.263
> 
> 标签：monitoring, snmp, zenoss

我的任务是为我公司的服务器软件编写一个监控程序，该程序通过 snmp 与 zenoss 集成。

简而言之，我无法从地面上得到任何东西。我认为我的第一个目标是找出编写 snmp 代理的正确方法（以任何语言开始，尽管最终会在 java 中）。有没有好的测试工具？我用过`snmptest`zenoss 附带的 ，但如果我不能让测试代理启动，这对我来说并没有多大好处。我所知道的 zenoss 手册有很多信息，但它似乎假定了对标准系统监控实践和工具的先验知识，我几乎无法理解它。

另外，使用 snmp 监控软件通常是一种好习惯吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-04-24T20:29:59.543

典型 SNMP 代理的简短描述：

1.  设置代理。这通常需要告诉它向哪个服务器发送警报。

2.  运行。

3.  当事情发生时，将适当的 SNMP 消息发送到配置的服务器。

4.  回复来自已配置服务器的请求。

所有请求/回复的内容都是使用 SNMP 消息完成的。如果您的公司没有为服务器软件专门设计/分配的 OID，您需要查看标准 MIB 定义以确定哪些 OID 是合适的。

MIB：管理信息块。这些有标准和定制口味。标准的由标准机构 (IETF?) 定义。定制的由供应商创建，以支持其产品特有的信息。MIB 基本上是 OID 的集合。

OID：对象标识符 - 这是一个点符号数字字符串，用于标识硬件/软件，以及您正在从中寻找的信息位 - 例如，以太网端口上的 TX 冲突数可能看起来像一些东西比如：1.5.82.316.8.4.3（虽然这不是一个有效的 OID，它只是一个虚构的例子）。

更多细节可在[Wikipedia](http://en.wikipedia.org/wiki/SNMP)上找到。下载免费的[MIB 浏览器](http://www.softlist.net/program/mib_browser-software.html)以了解 OID 的外观以及它们的详细程度。查看[RFC](http://en.wikipedia.org/wiki/SNMP#RFCs)以获取更多详细信息。看看 perl 的[Net-SNMP](http://www.net-snmp.org/)之类的东西——你甚至可以使用它附带的 snmpd 软件来完成大部分工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-24T20:40:47.757

SNMP 无疑是监控网络、设备和服务器的一种可接受的方式。因为它使用 UDP，所以它不会通过 TCP 重试等对网络施加过度压力（SNMP 客户端是或应该被设计为处理丢弃的数据包等）。此外，您将拥有大量客户端解决方案来监控您的系统并与之集成。

如果您设想使用 Java 的最终解决方案，请参阅[Java/SNMP 文档](http://java.sun.com/j2se/1.5.0/docs/guide/management/SNMP.html)和[SNMP4J](http://www.snmp4j.org/)

SNMP.com（由 SNMP 架构师之一 Jeffrey Case 创建）销售可扩展的 SNMP[代理](http://www.snmp.com/products/agents.shtml)。其中之一可能会为你拯救一个悲伤的世界。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T20:20:53.997

nSoftware 有一个[SNMP 代理](http://www.nsoftware.com/ipworks/v8/snmp.aspx)（不是免费的）。这可能比自己滚动更容易。

还可以查看[William Stalling 的书：SNMP](https://rads.stackoverflow.com/amzn/click/com/0201485346)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T20:09:01.247

Zenoss 相当复杂，并带有许多预定义的 SNMP 内容。您真的需要编写自己的 SNMP 代理吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-14T14:04:36.077

SNMP 是一个很大的话题，如果你深入了解协议和相关工具的所有细节和所有历史版本，它就会变得非常复杂。我建议拿起 Mauro 和 Schmidt 的[Essential SNMP](https://rads.stackoverflow.com/amzn/click/com/0596008406)的副本，它非常清楚地介绍了 SNMP 背后的基本思想以及如何开始使用它并与许多人一起使用它的实际示例不同的工具。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-02T19:01:22.280

你可以把目标放低，试试仙人掌 ( [http://www.cacti.net/](http://www.cacti.net/) )。

我也试过 Zenoss 但放弃了。仙人掌启动并运行得非常快。我只是监视全国相当多的路由器和许多交换机中的许多端口的带宽使用情况。但是有模板可以监控与单个服务器更相关的所有类型的事情（温度、风扇速度等）

BR。安德斯

# windows - Windows 窗体 - 验证 DataGridView 输入

> ID：787360
> 
> 赞同：1
> 
> 时间：2009-04-24T20:04:33.600
> 
> 标签：windows, validation, datagridview, dataset, strongly-typed-dataset

我有一个 Windows 窗体应用程序，其中一个窗体中有一个 DataGridView。DataGridView 可以通过 Visual Studio 生成的 Typed Data Set 插入和更新。

当用户没有填写必填字段或输入错误的数据类型等时，我想显示用户友好的错误消息，而不是默认显示的丑陋的巨大错误消息。

这个页面[在这里](http://tonesnotes.com/blog/2005/05/datagridview_validation.html)提供了一些指导。它建议我验证我的数据源属性设置器上的输入。

如何使用类型化数据集执行此操作？我习惯于使用生成部分类的 Linq To Sql，但我不确定类型化数据集。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-04-07T01:15:06.230

我使用以下代码为基本验证制作了一条通用的用户友好错误消息：

```
dataGrid.DataError += (s, e) =>
{
    if (e.Exception != null)
    {
        e.ThrowException = false;
        MessageBox.Show(this,
            String.Format("Invalid {0}",
                dataGrid.Columns[e.ColumnIndex].HeaderText),
            "Error");
    }
}; 
```

来自 MSDN：[演练：处理在 Windows 窗体 DataGridView 控件中输入数据期间发生的错误](http://msdn.microsoft.com/en-us/library/t4a23xx4.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T20:20:21.843

在 winforms 视觉反馈方面，我认为你应该看一个像[ErrorProvider](http://msdn.microsoft.com/en-us/library/system.windows.forms.errorprovider.aspx)这样的概念。

如果您只关注输入验证，例如将字符串转换为整数字段，这是一个很好的方法，但请注意，winform 的控件验证事件模型不应强制执行非平凡错误的真正验证！比如'EndDate < StartDate'，确实应该下推到业务层。

# flash - 我如何编写一个 Flash 应用程序来播放较大视频中的片段？

> ID：787364
> 
> 赞同：0
> 
> 时间：2009-04-24T20:05:30.320
> 
> 标签：flash, video, mpeg

我想编写一个 Flash 小程序（或任何其他可能的应用程序）嵌入到我的网站中，它将播放视频的一部分（例如：从 0:20 到 0:40）。视频为 MPEG 格式。我是 Flash 新手 - 关于如何开始这方面的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T20:10:34.160

好吧，如果您指的是**YouTube**视频，那么[Splicd](http://www.splicd.com/)是一种在线网络服务，可让您剪切您选择的视频部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T20:40:27.943

好吧，如果您是 flash 新手（如编辑所说；）），这可能有点太复杂，无法在这里解释，但您需要做的是使用 NetStream 编写自定义 flv 播放器，并制作确保您的 flv（或其他视频媒体）托管在 rtmp 服务器上（如果仅供个人使用，媒体殿堂有一个便宜的）然后您可以调用 netStream.play(flvName, startPosition); 并添加一个侦听器以在它到达您想要使用 cuePoint 停止它的点时停止它。

这里有一个例子： [http ://www.actionscript.org/forums/showthread.php3?p=875934](http://www.actionscript.org/forums/showthread.php3?p=875934)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T20:11:26.360

除非您仅提取该部分或编写一个工具来播放带有动作脚本的 FLV 文件（可以以编程方式在视频中移动），否则您无法做到这一点

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T20:28:45.303

Youtube 允许通过将其附加到您的链接来链接到视频中的特定时间点：“#t=1m45s”，例如：

```
http://www.youtube.com/watch?v=1bibCui3lFM#t=1m45s 
```

[这篇博](http://www.mydigitallife.info/2008/10/14/youtube-allows-you-to-start-playing-embed-video-at-specific-start-time/)文还展示了如何将其嵌入您的网站的示例，并具有指定的起始时间点：

```
<object width=”425″ height=”344″&gt;<param name=”movie” value=”http://www.youtube.com/v/Z_zxRAfAWug&hl=en&fs=1&start=20“&gt;</param><param name=”allowFullScreen” value=”true”&gt;</param><embed src=”http://www.youtube.com/v/Z_zxRAfAWug&hl=en&fs=1&start=20” type=”application/x-shockwave-flash” allowfullscreen=”true” width=”425″ height=”344″&gt;</embed></object> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-26T00:13:31.450

你有几个选择：

*   您可以将视频离线拆分为所需的片段，并通过 http 将它们提供给标准 FLVPlayback/VideoPlayer 组件。这非常简单，但不允许您选择如何动态分割视频（在服务时）。这是因为使用 HTTP，您必须从头开始下载视频。
*   您可以使用 Flash Media Server 或等效的开源软件（例如 Red5）通过 RTMP 流式传输视频，这将允许您从任何关键帧开始下载/播放视频。
*   正如其他答案所建议的那样，您可以使用 youtube。

# visual-studio-2008 - Silverlight Control Toolkit 调试符号

> ID：787366
> 
> 赞同：1
> 
> 时间：2009-04-24T20:06:20.490
> 
> 标签：visual-studio-2008, silverlight, debugging

Silverlight 控制工具包是否在任何地方都有可用的调试符号？我知道源是分布式的，我可以构建它并引用新构建的程序集及其符号，但这很蹩脚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-02T18:28:16.730

不幸的是，我们没有。我们打电话时认为，任何需要它们的人都可以简单地构建它们——这样他们就可以让源代码开放、工作并改善这种体验。

但我同意这是蹩脚的，知道有人实际上对符号感兴趣。我会看看我们是否不能至少在 Silverlight Toolkit 下一次发送它们。

# iphone - 调整 UIView 的大小以使其在 UIScrollView 中可滚动

> ID：787368
> 
> 赞同：1
> 
> 时间：2009-04-24T20:06:30.333
> 
> 标签：iphone, objective-c, uiview, uiscrollview

我在我的 appDelegate 中添加了一个 UIScrollView，然后做了

```
scrollView.contentSize = CGSizeMake(720, 480);
scrollView.showsHorizontalScrollIndicator = YES;
scrollView.showsVerticalScrollIndicator = YES;
scrollView.delegate = self;
[scrollView addSubview:viewController.view];
[window makeKeyAndVisible]; 
```

视图控制器加载 UIView 的位置。在 IB 中，我将 UIView 的大小设置为 720x480，但在我运行时它并没有显示得更大。我可以滚动我的 UIView 到 720x480 的空白区域，但我希望我的 UIView 也可以调整到这个大小。我检查了初始drawRect rect中的参数，它们仍然只有320x480，所以似乎我必须做其他事情来设置我的UIView的大小，而不是在IB中调整它的大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T00:10:06.643

我通过从 viewControllers ViewDidLoad 方法更改视图的帧大小来解决这个问题。显然控制器限制了 UIView 的大小，即使我在 IB 中将它设置为更大。

# windows - CreateObject 和 Wscript.CreateObject 有什么区别？

> ID：787369
> 
> 赞同：16
> 
> 时间：2009-04-24T20:06:46.433
> 
> 标签：windows, vbscript, wsh

有谁知道使用以下选项的原因：

```
Wscript.CreateObject("some.object") 
```

和

```
CreateObject("some.object") 
```

在 VBScript 中？当我找到使用 的文档或示例时`Wscript.CreateObject`，我通常使用 重写`CreateObject`，因为它似乎总是有效，然后我可以轻松地在 HTA 或 ASP 中重用代码。但我一直想知道为什么这个功能存在，如果你在 VBScript 中使用一种或另一种方式，它会产生什么不同。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-04-24T20:17:56.390

当您只用一个参数调用它们时，两者之间没有区别。做完全相同的事情。

仅当您使用两个参数调用时，两者之间的区别才会显现出来。声明

```
Wscript.CreateObject("some.object", "AnotherParam") 
```

和

```
CreateObject("some.object", "AnotherParam") 
```

做完全不同的事情：

> VBScript CreateObject 函数将第二个参数解释为远程计算机名称，并尝试在该远程计算机上创建命名的 COM 对象；在此示例中，它尝试在名为“AnotherParam”的远程计算机上实例化 ProgId 为“some.object”的对象实例。WScript CreateObject 方法将第二个参数解释为用于处理来自对象的事件的子例程前缀。这两个 GetObject 函数具有类似的相关性。

（改编自[TechNet](http://www.microsoft.com/technet/scriptcenter/guide/sas_wsh_lubv.mspx?mfr=true)，“将 VBScript CreateObject 和 GetObject 函数与 WSH 进行比较”一节。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-24T20:11:39.883

我猜这个`WScript`对象有这个`CreateObject`方法，所以任何 Windows 脚本语言都可以创建 COM 对象。

VBScript 作为全局函数具有这种能力，但其他 Windows Script 宿主语言可能没有。

例如，JScript 没有全局`CreateObject`函数（我相信）（但它有`var a = new ActiveXObject("...")`语法，因此您也不需要`WScript.CreateObject`在 JScript 中使用）。

我猜这两个功能之间没有区别。

**编辑**：有*区别*（但仅当您尝试在远程主机上实例化 DCOM 对象时），请参阅@Thomas Petersen 的答案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-03-09T00:13:46.940

JScript 没有全局 CreateObject 吗？WScript 不能使用 JScript 吗？

[来自 devGuru 的代码](http://www.devguru.com/technologies/wsh/17377)

```
// JScript
var objIE = WScript.CreateObject("InternetExplorer.Application","objIE_")
objIE.Visible = true

while (objIE.Visible){
    WScript.Sleep(500);
}

function objIE_NavigateComplete2(pDisp, URL){
    WScript.Echo("You just navigated to", URL)
} 

function objIE_OnQuit(){
    boolBrowserRunning = false ;
} 
```

# c# - 如果 C# 比 C++ 慢，为什么还要使用它？

> ID：787375
> 
> 赞同：37
> 
> 时间：2009-04-24T20:08:32.077
> 
> 标签：c#, c++, performance

我正在寻找一种新的语言来学习 C++ 和 Java。我本来打算尝试 C#，但是很多人说它真的很慢，因为它是一种高级语言。那么为什么有人会使用 C#？C++不是更快吗？它是否使开发更容易，但最终产品却更慢？

另外，C#可以用来做什么？您将它与 Windows 上的大量 .NET 内容以及 ASP.NET 一起使用，但还有哪些其他情况可以使用 C#？会不会有很多工作机会呢？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2009-04-24T20:11:56.403

这“一群人”究竟是谁？他们拿什么来比较？

对于绝大多数事情，C++*并不*比 C#“快得多”。它确实在各种情况下都有好处，特别是在您想要更多确定性内存处理的情况下，但根据我的经验，大多数应用程序的瓶颈不在 C++ 可以提​​供帮助的地方。正如 spoulson 所说，很多性能都在设计中，而不是在精确的实现中——在那里，它有助于能够轻松地尝试不同的设计。

当它比 C++ 慢一点*时*，我们为什么要使用 C# ？因为通常认为（即有些人不同意 :) 发展起来会容易得多，而不会让自己陷入困境。

至于C#可以用来做什么……你*想*用它做什么？除非您想开发驱动程序和内核，否则对您来说可能没问题。（甚至操作系统开发也有一些人使用 C#...）

工作机会？负载。

缺点？嗯，.NET 本身只能在 Microsoft 平台上使用。有[Mono](http://mono-project.com/Main_Page)，但它的可移植性程度不如 Java（毫无疑问，根据同一群人的说法，这是另一种“慢”语言）。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2009-04-24T20:11:26.267

用汇编编写的代码可以非常快。为什么不直接写汇编呢？

不要相信你听到的一切。对于我的所有项目，C# 的速度都非常快。通常，性能比原始平台性能更多地是设计因素。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2009-04-24T20:12:55.060

我不得不说与你交谈的人根本不知道他们在说什么。干净利落。

许多企业级应用程序都建立在 C# 和其他 .Net 语言之上。它们本质上并不慢。是的，启动时间**往往**较慢，但这几乎就是它结束的地方。

我注意到您在语言列表中提到了 Java。如果您对 Java 的速度感到满意，C# 不会出现任何问题。一般来说，在许多不同类型的基准测试中，C# 的性能至少与 Java 一样好。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2009-04-24T20:17:27.640

我的上一家公司是由 5 位 C++ 资深人士创立的，每个人都有 15 年以上的经验。他们花了一个多月的时间来构建某个 Windows 服务。其中一位发现并涉足了 C#。在一周之内，他比集体在他们一个月内取得的进展更进一步。不久之后，他们都切换到了 C#。

如果 C# 的执行速度可能较慢，为什么选择 C#：您对这种程度的快速开发付出了什么代价？

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-04-24T20:13:50.783

为什么要慢？事实上，C# 被编译为“中间语言”，它在运行时是 JIT 的，但这可以给你带来性能优势，因为运行时可以为代码运行的平台生成最优化的......

根据您要编写的应用程序，语言的“速度”会产生较小的影响。您的应用程序的性能主要取决于您设计应用程序的方式，如果您充分利用所使用的工具/技术等...当然，C# 不是灵丹妙药，有些项目您应该不要使用它，仅仅因为它不是工作的正确工具，但它对于大多数商业/企业应用程序来说都很好。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-04-24T20:56:49.450

我还没有发现很多 C# 不是很好的语言选择的例子，而 .Net（或 Mono）也不是一个像样的平台。值得注意的例外是内核级开发或驱动程序。有很多领域需要低水平和原始性能。对于大多数（如果不是全部）业务或企业应用程序，C# 是更好的开发选择之一。它得到很好的支持，可以与许多其他系统、库、通信渠道和已经可用的组件一起使用，更不用说它是一种相当不错的语言（尤其是 3.5）。

ASP.Net 不是一个糟糕的平台，我通常发现对象/控制堆栈是复杂交互的缺点之一。我认为 ASP.Net MVC 更适合可扩展的基于 Web 的应用程序。同样，它比我过去使用过的许多其他系统要好。

在服务层，甚至 GUI 开发方面，它都相当不错。与桌面 GUI 应用程序相比，我在基于 Web 的应用程序和服务/通信/业务层方面的经验要丰富得多，因此不能对此发表太多评论。我觉得很多 GUI 开发更多的是关于 IDE/Toolkit，而不是特定的语言。

至于慢，您专门列出了 Java，在大多数情况下，C#/.Net 与 Java 一样快或更快。恕我直言，使用 C# (Visual Studio) 在 Java (Eclipse) 上的开发特别顺畅。对于基于 Web 的应用程序，我更喜欢 ASP.Net MVC（甚至 ASP.Net）而不是 Swing。但这只是我。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-04-24T21:25:50.597

与您交谈的人不知道他们在说什么。总而言之，C# 是一种与 Java 非常相似的语言；它具有大多数相同的优点和缺点。它的工作方式非常相似（Java/C# 被编译成中间语言/字节码，被解释或 JIT 编译为本机代码，具有各种类似的优化，作为程序员，您无需担心）。它在许多与 Java 相同的情况下使用，并且确实针对相同的市场。它的发展速度更快，并且作为一种语言带来了很多创新，但它（在实践中）几乎仅限于 Windows，如果这是你的关注点的话。就业市场也类似。两者都是非常流行的语言。

至于要学习的语言，我会建议一些不同的东西。你说你懂 C++ 和 Java；C# 应该不难上手。潜在的雇主会知道这一点。试试 Scala 或 Python。两者都会给你一些关于事物的新观点（C# 没有那么多），并通过教你新的思考方式让你成为一个更好的程序员，而不仅仅是在你的盒子里添加另一个工具。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-04-24T20:12:05.843

C# 并不总是较慢 - 在许多情况下，它的性能与您列出的任何语言一样好。通常，算法与速度有关，而不是语言的选择。

然而，C# 非常有表现力，并且有一个很棒的基类库可供使用，并且编译速度超快。这意味着它非常易于使用，并且可以让您比许多其他语言（尤其是 C++）更有效率。例如，我刚刚有一个小项目，我会在 C++ 中为 1 人周预算，而我们在 C# 中不到一天就完成了，主要是因为基类库简化了很多任务。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-24T20:20:30.940

使用 C# 而不是 C++ 的一个重要原因.........看看 C++ 在人们接管您的机器时遇到的所有缓冲区溢出问题，因为他们在您的字符串中注入可执行代码或内存泄漏......垃圾收集器恕我直言，非常方便

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-24T20:33:27.647

即使 C++ 运行速度更快，但在今天的计算机上差异并不大。这就是为什么在 cpu 和内存相当有限的移动设备上，C/C++ 仍然被广泛使用。

但请考虑开发时间。如果使用 C++ 需要 2 个月，使用 C# 需要 1 个月，你会选择哪个？当需要进行大的修改/重构时，更高级的语言会显着更快、更容易！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-02-16T00:45:52.877

我肯定会使用 C#。它实际上是平均速度，如果你喜欢 java，它几乎完全一样，因为它们都是基于 C++ 的。

# regex - 如何确定一个字符串至少包含一个字母字符？

> ID：787377
> 
> 赞同：1
> 
> 时间：2009-04-24T20:08:33.917
> 
> 标签：regex

我正在尝试确定正则表达式以验证字符串是否具有至少一个字母字符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T20:09:33.383

试试这个

```
"^.*[a-zA-Z].*$" 
```

这将适用于大多数正则表达式引擎。但是，它仅限于 ASCII 字母字符。对于国际字符，我们需要知道所涉及的正则表达式引擎。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T20:10:16.173

这里是：

```
[a-zA-Z] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T20:20:23.373

不要忘记，世界各地对“字母字符”的定义并不相同。例如，在挪威，正确的正则表达式是`[a-zA-ZæøåÆØÅ]`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T20:12:13.860

字母字符的 POSIX 标准匹配是：

```
[[:alpha:]] 
```

`.net`等效的是

```
[\p{L}] 
```

这是 Unicode 的 5 个不同“字母”字符类的 MS 快捷方式，Java 也支持这些字符类：

```
[\p{Lu}\p{Ll}\p{Lt}\p{Lm}\p{Lo}] 
```

请注意，这也应该匹配*任何*字母字符，而不仅仅是通常的罗马字母的 " `[a-zA-Z]`" 集，因此也匹配重音字符等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T20:12:56.620

`[a-zA-Z]`或者即使`[a-z]`您将不区分大小写的选项传递给正则表达式引擎。

# wordpress - 如何在 IIS/ASP.NET 中支持自定义用户域（如 WordPress）

> ID：787383
> 
> 赞同：0
> 
> 时间：2009-04-24T20:09:57.533
> 
> 标签：wordpress, iis, dns, vps, domain-name

我想知道是否可以使用 IIS 和 ASP.NET（理想情况下可以在共享主机帐户上使用的东西，但这不是必需的）来模仿 WordPress.com 允许最终用户使用自己的能力域名。

WordPress 让拥有自己域的用户更改域的 DNS 设置以指向 WordPress 自己的 DNS。我的猜测是，这*不是*在共享主机帐户上能够完成的事情，因为它涉及为每个自定义用户域向 DNS 服务器表中添加一个条目。

但是，为了将来参考，这是否可以在 VPS 上以编程方式自动化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T20:30:47.343

> 我的猜测是这不是可以在共享主机帐户上完成的事情

你几乎是正确的。IIS 中的默认站点侦听端口 80 上的所有连接以获取默认 IP 地址。

您可以通过 3 种方式添加更多站点：

1.  添加侦听不同端口的新站点。如果您希望在端口 80 上运行“普通”站点，这并不完全实用。

2.  向框中添加更多 IP 地址（不太容易完成）并设置新的 IIS 站点以独立侦听新的 IP 地址。

3.  将新站点添加到服务器，以侦听不同的“主机标头”（您和我的域名），但使用相同的（默认）IP 地址。

所谓的“共享主机”通常使用选项 3，因为托管公司可以只使用一个 IP 地址来处理可能数百个站点。因此，您必须经历将每个主机标头添加到框中的繁琐过程，虽然我几乎可以肯定这可以使用 Wscript 完成，但我不是该领域的专家。

如果您真的想进入它，您可以编写一个 ISAPI 模块来拦截调用并设置一些巧妙的（ish）域名数据库/哈希表和目标文件夹作为不同站点的服务器。

底线是，有多种方法可以在 Windows 上实现这一目标。可能没有什么比在 *nix 平台上那么容易了，在这个平台上，一切都是超脚本的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T20:18:48.883

我们所做的是为我们的域设置一个通配符 DNS 条目。这样，用户输入的任何域都将解析到我们的网站，只要它以“.mydomain.com”结尾。然后我们的 .Net 代码只查看传入的“HOST”标头并提供与该域名匹配的内容。

# stored-procedures - SSRS 中的存储过程参数加倍

> ID：787399
> 
> 赞同：1
> 
> 时间：2009-04-24T20:12:26.933
> 
> 标签：stored-procedures, parameters, reportingservices-2005

使用 SSRS 和 SQL 2000 源，我有一个存储过程，它接受三个参数并返回一个结果集。

我有一个数据集，其中*命令类型*设置为*StoredProcedure*，过程名称在*Query String*中。

当我尝试在 Visual Studio/BIDS 中执行该过程时，“*定义查询参数*”对话框会显示该过程中列出的每个参数两次。为参数提供值并继续会导致`too many arguments specified`错误。

如何让 SSRS 识别并将正确数量的参数传递给存储过程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-06T14:13:47.133

我找到了解决此问题的方法：

*   将命令类型设置为“文本”
*   指定过程名称*和*参数：

    执行过程名称 @param1、@param2、@param3

“EXEC”*和*指定参数都是它工作的要求。参数可以任意命名，只要它们以“@”符号为前缀即可。必须表示所有需要值的参数。当然，如果报告要在内部引用它们或将它们作为参数呈现给用户，则必须在命令文本中表示任何可选参数（那些在 proc 中指定的默认值），但不必为proc 运行并返回结果集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T20:15:48.737

检查并确保您没有在报告中声明额外的参数，如果您确实删除了 2 个额外参数，并确保这些参数是传递给存储过程的参数。

还要仔细检查并确保您没有在存储过程中意外声明 4 个参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-07T10:41:18.480

所以我知道这很旧，但我确实找到了一种开始工作的方法，这是 SQL Server 2000 (8.0.2039) 存储过程和 SSRS 版本 13.0.4224.16

我做了一个表达式：

```
="DECLARE @Month int; " & "DECLARE @Year int; " & "DECLARE @Format int; "  & "DECLARE @SQL nvarchar(4000); " & "SET @Month = " & CStr(Parameters!iMonth.Value) & " ; " & "SET @Year = " & CStr(Parameters!iYear.Value) & " ; " & "SET @Format = " & CStr(Parameters!iFormat.Value) & " ; " & "SET @SQL = 'EXEC [dbo].[sp_MyProc] @Month = @Month, @Year = @Year, @Format = @Format'; EXECUTE sp_executesql @SQL , N'@Month int, @Year int, @Format int ', @Month , @Year , @Format" 
```

我几乎尝试了我发现的所有其他东西，它不会将参数链接到报告，直到我在上面为查询类型定义的数据集执行此操作：文本并使用函数表达式。

# silverlight - Silverlight Control Toolkit TreeView 不呈现项目

> ID：787408
> 
> 赞同：0
> 
> 时间：2009-04-24T20:14:26.400
> 
> 标签：silverlight, data-binding, xaml

我正在尝试构建一个带有 TreeView 的 SL 应用程序。这是我的 XAML：

```
<UserControl xmlns:controls="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls.Toolkit"
             xmlns:tkwin="clr-namespace:System.Windows;assembly=System.Windows.Controls.Toolkit"
             xmlns:basics="clr-namespace:System.Windows.Controls;assembly=System.Windows.Controls"             
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    x:Class="SL.MyApp.Page"
    Width="800" Height="600">
    <controls:DockPanel>        
        <controls:TreeView Name="siteTree" controls:DockPanel.Dock="Left" Width="150">
            <controls:TreeView.ItemTemplate>
                <tkwin:HierarchicalDataTemplate ItemsSource="{Binding Children}">
                    <StackPanel Orientation="Horizontal">                        
                        <TextBlock Text="{Binding Name}"/>
                    </StackPanel>
                </tkwin:HierarchicalDataTemplate>   
            </controls:TreeView.ItemTemplate>
        </controls:TreeView> 
        <basics:TabControl controls:DockPanel.Dock="Right" TabStripPlacement="Top">
            <basics:TabItem Header="Sites"></basics:TabItem>
            <basics:TabItem Header="Lists"></basics:TabItem>
            <basics:TabItem Header="Users"></basics:TabItem>
        </basics:TabControl>      
    </controls:DockPanel>
</UserControl> 
```

以及相关的代码隐藏：

```
namespace SL.MyApp
{
    public partial class Page : UserControl
    {
        private ObservableCollection<WebDescriptor> _webHierarchy = new ObservableCollection<WebDescriptor>(); 

        public Page(WebsSvc.WebsSoapClient websClient)
        {           
            InitializeComponent();

            siteTree.ItemsSource = _webHierarchy;

            websClient.GetWebCollectionCompleted 
                += new EventHandler<SL.SiteBuilder.WebsSvc.GetWebCollectionCompletedEventArgs>(websClient_GetWebCollectionCompleted);
            websClient.GetWebCollectionAsync();

            // TODO: some kind of spinner or progress bar needs to be started.
        }

        void websClient_GetWebCollectionCompleted(object sender, SL.SiteBuilder.WebsSvc.GetWebCollectionCompletedEventArgs e)
        {
            foreach (XElement xe in e.Result.Elements())
            {
                _webHierarchy.Add(ServiceObjectParser<WebDescriptor>.Parse(xe));
            }
        }      
    }
} 
```

更新：WebDescriptor 类：

```
public class WebDescriptor
{
    public string Title { get; set; }
    public string Url { get; set; }
    public List<WebDescriptor> Children { get; set; }
} 
```

我的问题是 TreeView 中根本没有呈现任何内容。我已经验证在 websClient_GetWebCollectionCompleted 中获得的结果是有效且正确的，但是....什么都没有。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-24T20:32:04.017

在 websClient_GetWebCollectionCompleted 中：

siteTree.ItemsSource = _webHierarchy;

此外，将 Treeview 中 TextBlock 上的绑定更改为 {Binding Title}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T04:13:18.010

查看绑定跟踪输出后，我终于意识到我正在尝试绑定到字段而不是属性。

嗬！

# java - 什么会导致 TCP/IP 丢弃数据包而不丢弃连接？

> ID：787415
> 
> 赞同：11
> 
> 时间：2009-04-24T20:16:17.050
> 
> 标签：java, http, tomcat, tcp

我有一个基于 Web 的应用程序和一个客户端，它们都是用 Java 编写的。值得一提的是，客户端和服务器都在 Windows 上。[客户端通过Apache HttpClient](http://hc.apache.org/httpclient-3.x/)发出 HTTP GET 。服务器最多阻塞一分钟，如果在那一分钟内没有消息到达客户端，则服务器返回 HTTP 204 No Content。否则，一旦为客户端准备好消息，就会返回带有 HTTP 200 OK 的正文。

**这让我感到困惑：** 对于特定的客户端子集——总是具有明显不稳定的网络连接的客户端——间歇性地发出 GET，服务器接收并处理 GET，但客户端永远存在。为客户端启用调试日志，我看到 HttpClient 仍在等待响应的第一行。

服务器上没有抛出异常，至少没有任何地方记录，不是由Tomcat，不是由我的webapp。根据调试日志，服务器成功响应客户端的各种迹象。但是，客户没有收到任何东西的迹象。[客户端在HttpClient.executeMethod](http://hc.apache.org/httpclient-3.x/apidocs/org/apache/commons/httpclient/HttpClient.html#executeMethod(org.apache.commons.httpclient.HttpMethod))中无限期挂起。这在会话超时并且客户端采取导致另一个线程发出 HTTP POST 的操作后变得很明显。当然，POST 失败是因为会话已过期。在某些情况下，会话到期和客户端发出 POST 并发现这一事实之间已经过去了*几个小时。*在这整个时间里，`executeMethod`仍在等待 HTTP 响应行。

当我使用 WireShark 查看线路级别的实际情况时，不会发生此故障。也就是说，对于特定客户端，此故障将在几个小时内发生，但是当 WireShark 在两端运行时，这些相同的客户端将运行一夜，14 小时，而不会出现故障。

有没有其他人遇到过这样的事情？到底是什么原因造成的？我认为即使在短期网络故障中，TCP/IP 也能保证数据包的传递。如果我设置了 SO_TIMEOUT 并在超时时立即重试请求，重试总是成功的。（当然，我首先[中止](http://hc.apache.org/httpclient-3.x/apidocs/org/apache/commons/httpclient/HttpMethod.html#abort())超时请求并释放连接以确保将使用新的套接字。）

想法？想法？是否有一些可用于 Java 的 TCP/IP 设置或 Windows 中的注册表设置，可以对丢失的数据包启用更积极的 TCP/IP 重试？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-04-25T03:11:00.813

您绝对确定服务器已成功将响应发送给似乎失败的客户端吗？我的意思是服务器已经发送了响应，并且客户端已经将该响应返回给服务器。您应该在服务器端使用wireshark 看到这一点。如果您确定这发生在服务器端并且客户端仍然没有看到任何东西，您需要从服务器进一步查看链。是否涉及任何代理/反向代理服务器或 NAT？

TCP 传输被认为是一种可靠的协议，但它不保证交付。您的操作系统的 TCP/IP 堆栈将非常努力地使用 TCP 重新传输将数据包发送到另一端。如果发生这种情况，您应该在服务器端的 wireshark 中看到这些。如果您看到过多的 TCP 重新传输，通常是网络基础设施问题 - 即硬件/接口错误或配置错误。TCP 重传适用于短暂的网络中断，但在中断时间较长的网络上表现不佳。这是因为 TCP/IP 堆栈只会在计时器到期后发送重传。该计时器通常在每次不成功的重传后加倍。这是为了避免重传淹没已经存在问题的网络而设计的。正如你可能想象的那样，

根据您的网络拓扑，您可能还需要将探针/wireshark/tcpdump 放置在网络中的其他中间位置。这可能需要一些时间才能找出数据包的去向。

如果我是你，我会一直使用wireshark进行监控，直到问题再次出现。它很可能会。但是，听起来您最终会发现的是您已经提到的——片状硬件。如果修复脆弱的硬件是不可能的，您可能只需要构建额外的应用程序级超时并重试以尝试在软件中处理问题。听起来你开始走这条路了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T21:05:46.820

我还没有看到这个本身，但我看到过类似的问题，大型 UDP 数据报导致 IP 碎片，导致拥塞并最终丢弃以太网帧。由于这是 TCP/IP，我不认为 IP 碎片是一个大问题，因为它是基于流的协议。

我要注意的一件事是**TCP 不保证交付！**它不能。它确实保证的是，如果您发送*字节 A*后跟*字节 B*，那么在收到字节 A之前您将永远不会收到*字节**B*。

话虽如此，我会将客户端机器和监控机器连接到集线器。在监控机器上运行 Wireshark，你应该可以看到发生了什么。我确实遇到了与 HTTP 请求之间的空白处理和不正确的 HTTP 块大小有关的问题。这两个问题都是由手写的 HTTP 堆栈引起的，因此只有在使用易碎堆栈时才会出现问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T00:29:39.220

忘记刷新或关闭主机端的套接字可能会间歇性地对短响应产生这种影响，具体取决于时间，这可能会受到任何监控机制的影响。

特别是忘记关闭将使套接字悬空，直到 GC 开始回收它并调用 finalize()。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-23T04:54:22.537

如果您正在使用长时间运行的 GET，您应该在客户端超时两倍于服务器超时，正如您所发现的那样。

在客户端发送消息并期望响应的 TCP 上，如果服务器崩溃并重新启动（让我们举例说明），那么客户端仍将在套接字上等待从服务器获得响应服务器不再监听该套接字。

客户端只有在该套接字上发送更多数据时才会发现该套接字在服务器端已关闭，并且服务器拒绝这些新数据并关闭该套接字。

这就是为什么您应该对请求进行客户端超时。

但是由于您的服务器没有崩溃，如果服务器是多线程的，并且该客户端的线程套接字关闭，但当时（持续时间分钟）客户端连接中断，那么与我握手的端套接字会丢失，并且由于您没有从客户端向服务器发送更多数据，因此您的客户端再次挂起。这将与您的剥落连接观察有关。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T20:42:29.077

这些计算机是否安装了病毒/恶意软件？使用 wireshark 会安装 winpcap ( [http://www.winpcap.org/](http://www.winpcap.org/) )，这可能会覆盖恶意软件所做的更改（或者恶意软件可能只是检测到它正在被监控，而不是尝试任何可疑的事情）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T01:18:10.960

如果您丢失数据，很可能是由于软件错误，无论是在读取库还是写入库中。

# c++ - 你为什么要写这样的东西？（故意不在数组上使用 delete []）

> ID：787417
> 
> 赞同：7
> 
> 时间：2009-04-24T20:16:22.667
> 
> 标签：c++, coding-style

我偶尔遇到过这种代码 - 我怀疑创建者是/害怕表删除会遍历表和“性价比”（恕我直言不会这样做）......有没有真正的不使用删除表在这里可能会得到/考虑/想象的好处？

```
myClass** table = new myClass* [size];
... //some code that does not reallocate or change the value of the table pointer ;)
delete table; // no [] intentionally 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-04-24T20:19:02.393

如果你这样做，你将得到 C++ 标准所称的未定义行为——任何事情都可能发生。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-24T20:18:45.390

那是内存泄漏。A`new []`必须与 a 匹配`delete []`。此外，由于`table`是指向指针数组的第一个元素的指针，因此任何数组成员，如果它本身是一个数组，则需要使用`delete []`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-24T20:20:05.747

不仅没有任何好处，而且代码完全是错误的——最好的情况是它会泄漏内存，最坏的情况是它可能会使您的程序崩溃或打开一个难以发现的安全漏洞。您必须始终匹配`new`和。总是。`delete``new[]``delete[]`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-04-24T20:22:04.057

这绝对是错误的，因为 new[] 需要与 delete[] 配对。如果不这样做，您将获得未定义的行为。

它可能（部分）起作用，因为大多数实现都使用 new 来实现 new[]。这种实现的唯一区别是它只会调用 1 个析构函数（用于第一个元素而不是所有析构函数。但避免它，因为它**不是合法的 c++**。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-04-27T12:59:10.647

真的没有理由这样写，也有一个严肃的理由永远不要这样做。

确实，对于具有琐碎析构函数的类型（例如您的情况下的原始指针），不需要知道数组中元素的实际数量，因此编译器可能决定将*new[]*和*delete[]*映射到*new*和*delete*以减少开销。如果它以这种方式决定，您将无法在不采取额外步骤的情况下停止它，因此此编译器优化将在您不通知的情况下进行，并且是免费的。

At the same time someone using your code might wish to overload the global operators *new* and *delete* (and *new[]* and *delete[]* as well). If that happens you run into big trouble because this is when you may really need the difference between the *delete* and *delete[]*.

Add to this that this compiler-dependent optimization is unportable.

So this is the case when you get no benefits displacing *delete[]* with *delete* but risk big time relying into undefined behaviour.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-24T20:46:38.677

理论上你应该调用delete []。

编辑：**以下仅适用于 Microsoft Visual C++**（我应该这么说）。

实际上，在 Microsoft Visual C++ 中，当数组中的对象没有析构函数时，使用哪个删除并不重要。因为你有一个指针数组，而指针不能有析构函数，你应该没问题。

但是，正如其他人所指出的那样，混合 new [] 和 delete 而没有 [] 是不正确的 C++。尽管在这种情况下它可能在 Visual C++ 中工作，但该代码不可移植并且在其他编译器中可能会失败。

但是回到 Visual C++ 的具体情况，即使你调用 delete []，编译器也会意识到当它是一个基本类型（如 int、char 或指针）的数组时，它不需要遍历调用析构函数的数组. 在这种情况下调用 delete 实际上有效并且不会破坏任何东西。做正确的事情并调用 delete [] 不会慢，但也不会更快。

事实上，在 MSVC++ 中，当 p 是指向简单类型或没有析构函数的指针时，delete[] p 立即调用常规运算符 delete(void *p)。

那些不相信我的人，将这段代码单步执行到 CRT 代码中，用于前两次对 delete[] 的调用。

```
#include "stdafx.h"
#include <malloc.h>
#include <iostream>
using namespace std;

class NoDestructor
{
    int m_i;
};

class WithDestructor
{
public:
    ~WithDestructor()
    {
        cout << "deleted one WithDestructor at " << (void *) this<< endl;
    }
};

int _tmain(int argc, _TCHAR* argv[])
{
    int **p = new int *[20];
    delete [] p;

    p = (int**) malloc(80);
    free(p);

    NoDestructor *pa = new NoDestructor[20];
    delete [] pa;

    WithDestructor *pb = new WithDestructor[20];
    delete [] pb;

    return 0;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-24T20:19:39.507

该语句将把数组中所有指针指向的所有 myClass 对象留在内存中。它还将指针数组留在内存中。没有任何帮助，因为它只释放 32 位内存，并且操作系统仍然认为您有（大小）myClasses 和指向每个正在使用的指针。这只是程序员没有正确清理自己的一个例子。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-04-25T01:27:31.730

请查看 [16.11] “如何分配/取消分配数组？”部分。及超越 C++ FAQ Lite，

[http://www.parashift.com/c++-faq-lite/freestore-mgmt.html#faq-16.11](http://www.parashift.com/c++-faq-lite/freestore-mgmt.html#faq-16.11)

他们解释说，创建数组时必须删除数组。

数组元素指向的 myClass 的实例也应该在创建它们的地方删除。

# windows - Windows 中用户配置文件的唯一标识符

> ID：787419
> 
> 赞同：1
> 
> 时间：2009-04-24T20:17:07.233
> 
> 标签：windows, language-agnostic, network-programming, registry, uniqueidentifier

对于客户端/服务器应用程序，我需要集中存储通常进入用户配置文件目录的部分配置信息。

客户端应用程序将首先使用将具有 GUID 的文件或注册表项写入当前配置文件。此 GUID 随后将用作服务器上配置数据库中的键。

现在我想知道 Windows 用户配置文件是否已经具有我可以使用的唯一标识符，而不是生成我自己的 GUID。

用户名不起作用，因为用户可能有多个配置文件。将其与计算机名称结合将不起作用，因为可能存在漫游配置文件。

**更新：**

我只是查看`HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\ProfileList`了同一域中两台计算机上的 SID。漫游未启用，因此我的用户帐户在每台计算机上都有单独的配置文件。两个配置文件都以相同的 SID 列出。这意味着我必须不断生成自己的 GUID。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T20:26:02.783

Windows 用户和组使用安全标识符 (SID)。

> 安全标识符 (SID) 是可变长度的唯一值，用于标识 Windows 操作系统中的安全主体或安全组。

有一个Windows 内置[的预定义 SID 列表。](http://support.microsoft.com/kb/243330)其他 SID 是通过将当前计算机的（随机生成的，96 位的）SID 与递增的数字组合来生成的。

在计算机上拥有帐户的用户的 SID 存储在注册表中`HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\ProfileList`

示例 SID（取自[Microsoft 关于 Windows XP 安装的磁盘复制的政策](http://support.microsoft.com/default.aspx?scid=kb;EN-US;314828)）：

以下示例显示四个本地用户帐户的 SID。请注意，随着新帐户的添加，只有最后四位数字会增加。

*   S-1-5-21-191058668-193157475-1542849698-500 管理员
*   S-1-5-21-191058668-193157475-1542849698-1000 用户 1
*   S-1-5-21-191058668-193157475-1542849698-1001 用户 2
*   S-1-5-21-191058668-193157475-1542849698-1002 用户 3

由于 SID 的生成方式，它们*应该*是唯一的。由于它们是 Windows 配置文件系统的一部分，因此漫游配置文件应在每个系统上具有相同的 SID。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T20:44:44.440

您可以使用用户配置文件的安全标识符 (SID)。

LookupAccountName [()](http://msdn.microsoft.com/en-us/library/aa379159(VS.85).aspx) Win32 API 将用户名和计算机名作为输入，并返回相关的 SID。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T10:12:02.673

R Bemrose 和 snowccrash 是正确的，帐户 SID 正是您所要求的。您是正确的，为了使此解决方案能够正常工作，您需要启用漫游配置文件；这就是为什么它们被称为漫游配置文件。

如果您不想使用域身份验证来识别用户，那么您的另一个选择是 WAS（Windows 身份验证服务）。这通常但不一定在无处不在的 ASPNETDB 数据库中的 Microsoft SQL Server 上实现。

WAS 是一个 dotnet 解决方案，对 ASP.NET 提供了详尽的支持，也可用于桌面软件。如果你也不喜欢这样，你可以自己动手，但在我看来，这似乎是资源的次优应用。如果您不构建 dotnet 软件，您仍然可以利用 WAS，但它不会那么方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T14:32:42.140

我可能会使用一个更以 LDAP 为中心的解决方案来解决这个问题，但对于您的应用程序来说可能需要做更多的工作。

AD 中有一些独特的字段供用户使用。您可以使用用户记录的整个 DN（即 DC=com,DC=example,CN=Users,DN=bob smith）。这就是唯一标识 AD 中记录的内容。但是，MS 也有一个名为 UPN 的字段，它看起来像一个电子邮件地址（有时是）并采用 user@domain 形式。

当然，此信息需要对 AD 的读取权限，这对您的应用程序可能不实用。

# web-applications - 如果有人想构建一个处理照片的网络应用程序 - 哪种语言最好？

> ID：787420
> 
> 赞同：0
> 
> 时间：2009-04-24T20:17:14.223
> 
> 标签：web-applications, image

对于旨在处理用户提交的图像的网络应用程序，是否有更好的网络语言？

本质上是一个网络应用程序，它将接受用户提交的图片并能够创建相册等。Flickr 或 Facebook Pics 的所有功能。

除了语言之外，设计用于处理图像的网络应用程序与只处理我应该从一开始就知道的文本的网络应用程序相比，还有什么不同的地方吗？

谢谢。

更新：

有没有一种方法可以在客户端处理图片大小调整，而不是 Java 小程序，这对于所有主要浏览器和主要操作系统都是通用的？

更新 2：

所以共识似乎是尝试各种语言和框架，看看我最喜欢哪个特定项目。对于初学者，我肯定会检查 RoR 和 Django，然后如果我没有看到任何我喜欢迁移到 PHP 和那里的一些框架的东西。感谢所有的建议家伙，感谢所有的答案和评论。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T20:29:11.170

几乎任何拥有良好开发者社区的语言都是不错的选择。如果您有任何编程经验，请选择与您已经熟悉的语法相似的东西。

如果您没有编程经验，请浏览一些有关 Rails、Django 和 PHP 框架的教程，看看哪个对您来说最自然。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T20:22:57.330

Flickr 和 Facebook 都是用 PHP 编写的。对于图像大小调整，他们会使用其他一些工具，而不是在 web 进程中完成所有工作，但它们也可以大部分从 PHP 运行。

正如我上面所说，所有较大的网站（我在自己的网站上）都会做的一件事是执行离线调整图像大小的繁重部分。即使是一个简单的照相手机现在也可以产生几兆字节大小的图像。在处理时（甚至减小大小），内存使用量可能会膨胀到 100MB+。因此，远离网络服务器执行调整大小任务是必不可少的。一种非常流行的传递文件的方法是使用某种形式的队列来保存，然后将文件名（以及它在磁盘上的位置）输出到专用进程。我自己用于此类排队的一种工具是[http://xph.us/software/beanstalkd/](http://xph.us/software/beanstalkd/) Facebook 和 Flickr 都有自己的。在基于 Mysql 的系统中使用 Zend_Queue 之类的东西来保存队列或工作也不难。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T20:19:24.750

我在 Ruby on Rails 上很幸运，制作网站的快速原型非常容易，并且有许多插件可以处理图像上传以及您可能想要对图像执行的其他操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T20:24:55.280

我们已经将它用于几个项目：[http ://albumdy.com/](http://albumdy.com/)

它拥有所有的花里胡哨，并且很容易为您想要添加或取出而定制。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T20:35:51.793

马卡百万，

在大多数情况下，所有语言和相关框架都几乎能够做同样的事情（que flamewar ...）。

你会发现他们都能够接受和上传照片，并且他们都有各种方式来操作、存储和显示这些照片。

如果我是你，我会花一点时间玩各种语言，看看哪一种感觉舒服。

做一些基础教程，弄清楚它们如何处理表单，它们如何与数据库交互。什么可以做，什么不能做。

然后从您喜欢的语言/框架的角度重新审视您的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T02:16:30.600

我建议使用 Ruby（在 Rails 上）。

有很多插件可以处理图像上传，例如[Paperclip](http://www.thoughtbot.com/projects/paperclip)（处理上传、缩略图生成）

也就是说，几乎所有语言都有类似的库（用于[Python/django](http://www.djangosnippets.org/snippets/20/)、[PHP/CodeIgniter](http://codeigniter.com/forums/viewthread/80610/)等）——使用您最熟悉或最有兴趣学习的语言。例如，我可能会使用 Python 和 Google App Engine 框架/服务来编写它，因为这是我想学习的东西。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-15T16:16:39.707

简要介绍在 Web 开发中突出的开源语言：Python、Ruby 或 Perl 都有有用的社区（顺便说一句，Perl 根本不必*写得*晦涩难懂，只是优秀的 Perl 程序员喜欢使用速记。还有很多高薪的[Perl 工作](http://jobs.perl.org/)，即使在 Google 也是如此）。PHP 很普遍，也有一些优秀的框架，但是网络上也有很多*糟糕*的PHP 代码和建议，所以要当心并找到一个合适的地方来提供 PHP 建议。此外，保持表示/样式、数据和逻辑分开（MVC 是目前的一种方法）。不要陷入 PHP/HTML 汤！

大多数语言都有一个用于在服务器端处理图像的模块。这个想法是提供一个客户端 (Javascript) 界面来在浏览器中直观地操作图像，问一个“你确定吗？” 一种问题，然后在服务器端进行处理并呈现结果。

就像大家说的，尝试几种语言，当你遇到困难时加入社区小组，测试他们的友好程度，看看你的感受。好消息是您也可以将许多所谓的“脚本”语言（即不需要编译的语言）用于其他工作，例如 Web/桌面混合应用程序。

# .net - WCF 是否适用于所有情况？

> ID：787426
> 
> 赞同：1
> 
> 时间：2009-04-24T20:18:36.000
> 
> 标签：.net, wcf, architecture, remoting

我正在构建一个应用程序，将其处理分配到一个农场。在我的基本设计中，我有两个服务：

一个“控制器”，它监视新工作、将其排队并管理结果。

绑定到特定控制器的“工人”。工作人员将从其控制器检查工作，并将结果推回。

在我对 WCF 的简要介绍中，它似乎暗示了 MEST 风格的消息传递 SOA。这种机制似乎与我将要做的沟通和协调类型不符。

我混淆了 WCF 是什么？这个世界上还有 .NET 远程处理的地方吗？或者我是在以侏罗纪、WCF 之前的心态思考这个问题。

编辑：
遗漏了一些细节。问题是我需要对工作进行时间限制。如果一个工作项被签出的时间太长，我应该能够把整个事情弄错。我见过的所有例子似乎都对传出的消息采取“发送并忘记”的立场。我需要在合理的时间范围内得到确定性的结果或错误。希望澄清。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T20:24:59.243

我不建议在大多数情况下进行远程处理；它是不可移植的，有时管理起来有点痛苦，而且`BinaryFormatter`很脆弱（版本不容忍）。

WCF 非常适合大多数情况；如果您在农场工作，您可能希望在没有会话等的情况下运行，但无论如何我都会这样做（为了性能） - 只需使用 http 基本配置文件。

我不完全理解你描述的场景。当然，您始终可以使用 xml/json/binary 滚动您自己的 RPC - 或使用任何其他预装通信堆栈...或 MSMQ 或 BizTalk 等中间件。

* * *

重新编辑；WCF 可以同步使用（阻止响应，（我相信）可配置的超时）。您可以使用分布式事务等做更复杂的事情（回滚等），但它会迅速增加复杂性。您需要权衡死区时间等的重要性。

如果时间范围比您希望等待调用的时间长，您还可以考虑工作流之类的东西 - 除了 WF 之外，还有一系列工作流产品。

# java - 在传递给 JSP 标记处理程序之前评估变量

> ID：787434
> 
> 赞同：3
> 
> 时间：2009-04-24T20:19:54.170
> 
> 标签：java, jsp, jsp-tags

在尝试使用自定义 JSP 标记库时，我在 JSP 中定义了一个变量，我希望在将其传递给标记库之前对其进行评估。但是，我似乎无法让它工作。这是我的 JSP 的简化版本：

```
<% int index = 8; %>

<foo:myTag myAttribute="something_<%= index %>"/> 
```

我的`doStartTag()`方法`TagHandler`使用pageContext的输出流根据输入的属性进行写入：

```
public int doStartTag() {
    ...
    out.println("Foo: " + this.myAttribute);
} 
```

但是，我在最终标记中看到的输出是：

```
Foo: something_<%= index %> 
```

而不是我想要的：

```
Foo: something_8 
```

我对该属性的标签库定义是：

```
<attribute>
    <name>myAttribute</name>
    <required>true</required>
</attribute> 
```

我曾尝试使用 和 配置属性`rtexprvalue`，`true`但`false`均未成功。有没有办法可以配置属性，以便在发送到处理程序之前对其进行评估？还是我完全错了？

我对 JSP 标签比较陌生，所以我对解决这个问题的替代方案持开放态度。另外，我意识到在 JSP 中使用 scriptlet 是不受欢迎的，但我在这里使用一些遗留代码，所以我现在有点坚持。

**编辑：**

我也试过：

```
<foo:myTag myAttribute="something_${index}"/> 
```

这也不起作用 - 它只是输出`something_${index}`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T20:35:02.573

我不相信您可以`<%= ... %>`在自定义标签的属性内使用 a ，除非您`<%= ... %>`是属性值的全部内容。以下内容对您有用吗？

```
<% int index = 8; %>
<% String attribValue = "something_" + index; %>

<foo:myTag myAttribute="<%= attribValue %>"/> 
```

编辑：我相信`<% ... %>`自定义标签属性内只能包含一个变量名。不是任何Java表达式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-06T11:13:12.937

为了使您的 JSP 代码保持干净整洁，请尽可能避免编写脚本。我认为这是首选的方法：

```
<foo:myTag >
  <jsp:attribute name="myAttribute">
    something_${index}
  </jsp:attribute>
</foo:myTag > 
```

如果您的标签还包含正文，则必须将其从

```
<foo:myTag myAttribute="<%= attribValue %>">
  body
</foo:myTag > 
```

到

```
<foo:myTag >
  <jsp:attribute name="myAttribute">
    something_${index}
  </jsp:attribute>
  <jsp:body>
    body
  </jsp:body>
</foo:myTag > 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T20:23:45.893

`<foo:myTag myAttribute="something_${index}"/>`

# wpf - 如何在 WPF 中将宽度设置为 100%

> ID：787436
> 
> 赞同：69
> 
> 时间：2009-04-24T20:20:11.940
> 
> 标签：wpf, width, autosize

有什么方法可以告诉**WPF**中的组件占用 100% 的可用空间？

像

```
width: 100%; 
```

在 CSS 中

我有这个 XAML，但我不知道如何强制 Grid 采用 100% 的宽度。

```
<ListBox Name="lstConnections">
  <ListBox.ItemTemplate>
    <DataTemplate>
      <Grid Background="LightPink">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <TextBlock Grid.Row="0" Grid.Column="0" Text="{Binding Path=User}" Margin="4"></TextBlock>
        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Path=Password}" Margin="4"></TextBlock>
        <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Text="{Binding Path=Host}" Margin="4"></TextBlock>
      </Grid>
    </DataTemplate>
  </ListBox.ItemTemplate>
</ListBox> 
```

结果看起来像

[替代文字 http://foto.darth.cz/pictures/wpf_width.jpg](http://foto.darth.cz/pictures/wpf_width.jpg)

我把它变成了粉红色，所以很明显它需要多少空间。我需要将粉色网格设为 100% 宽度。

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2009-04-24T20:26:57.070

`Grid`强加于其宽度的是容器。在这种情况下，这是 a `ListBoxItem`，默认情况下是左对齐的。您可以将其设置为拉伸，如下所示：

```
<ListBox>
    <!-- other XAML omitted, you just need to add the following bit -->
    <ListBox.ItemContainerStyle>
        <Style TargetType="ListBoxItem">
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
        </Style>
    </ListBox.ItemContainerStyle>
</ListBox> 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2013-06-10T22:58:59.607

你可以使用`HorizontalContentAlignment="Stretch"`如下：

```
<ListBox HorizontalContentAlignment="Stretch"/> 
```

# .net - 为什么我不能与在运行时动态加载到同一加载上下文中的程序集共享类型？

> ID：787444
> 
> 赞同：3
> 
> 时间：2009-04-24T20:22:04.930
> 
> 标签：.net, reflection, assemblies

在构建插件架构时，我遇到了一个并不少见的问题。

1.  程序集 A 是核心代码——框架。

2.  程序集 B 是该代码的插件，预计将在运行时动态加载并使代码可供程序集 A 使用。

在 Visual Studio 中，项目 B（生成程序集 B）具有对项目 A（生成程序集 A）的引用，因此它可以引用项目 A 中的类型并编译得很好。这两个项目都可以正确编译并生成 DLL。

但是，在运行时，我会遇到这样的强制转换异常：

```
'MyType' cannot be converted to type 'MyType' 
```

我开始明白，在一个项目中定义并在另一个项目中引用的类型在运行时被认为是不同的类型，即使它们在编译时解析得很好。

但是，我认为这可以通过将程序集 B 加载到正确的上下文中来解决。所以我从“Assembly.LoadFrom”切换到“Assembly.Load”并将Assembly B放在探测路径中。这个想法是，它将加载到与大会 A 相同的上下文中，他们将成为一个幸福的大家庭。

我下载了 Fusion 日志查看器并观看了程序集的加载。程序集 A 和程序集 B 都像这样加载：

> 程序集在默认加载上下文中加载。

所以，我确保它们都加载在*同一个加载上下文中*。

不过，我不能在两个程序集之间共享类型。当我尝试将对象（其类型在程序集 A 中定义）作为参数从程序集 A 中的代码传递到程序集 B 中对象的方法时，出现转换错误。

总结一下：

1.  MyType 在程序集 A 中定义

2.  从程序集 A，我在运行时使用“Assembly.Load”将程序集 B 加载到相同的加载上下文中

3.  在程序集 A 中，我使用反射在程序集 B 中的类上调用静态方法。我将此方法传递给 MyType 的对象作为参数（这是预期的，并且编译得很好）。

4.  失败：“MyType”无法转换为“MyType”类型

这是我用来调用该方法的代码，如果这很重要的话。此代码在程序集 A 中执行：

```
TypeFromAssemblyB.GetMethod("MyMethod").Invoke(null, new object[] { ObjectOfTypeDefinedInAssemblyA }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T20:49:09.233

我确信这应该像你描述的那样工作，所以我写了一个快速而肮脏的例子。我的入口程序集称为 PluginTest 并包含以下类：

```
namespace PluginTest
{
    public class MyType
    {
        public string Data { get; set; }
    }
} 
```

我的插件程序集称为插件。它引用了 Visual Studio 中的 PluginTest 项目，并且只包含这个类：

```
using System;
using PluginTest;

namespace Plugin
{
    public class Class1
    {
        public static void ShowData(MyType input)
        {
            Console.WriteLine(input.Data);
        }
    }
} 
```

最后回到 PluginTest（可执行文件）我在 Main 中有这段代码：

```
static void Main(string[] args)
        {
            Assembly pluginAssembly = Assembly.LoadFrom("Plugin.dll");

            Type pluginType = pluginAssembly.GetType("Plugin.Class1");

            MethodInfo mi = pluginType.GetMethod("ShowData");

            mi.Invoke(null, new object[]
            {
                new MyType {Data = "Hello World"}
            });

            Console.ReadLine();

        } 
```

正如预期的那样，这会弹出一个控制台窗口并向其写入“Hello World”。所以，原则上，你想做的事情*应该*有效......

（在预览中，我喜欢 Jonathan 的想法，它可能是版本不匹配 - 对整个解决方案进行干净的构建，并确保将所有 dll 复制到正确的文件夹中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T20:41:43.900

您是否有可能遇到版本不匹配问题？如果Assembly B 引用了Assembly A 的v1.0.xy，但是Assembly A 加载的版本是v1.0.wz，则类型不兼容。将它们加载到反射器（或类似工具）中应该允许您验证每个程序集的版本，以及从 B 到 A 的引用的版本。

我偶尔会遇到这种情况，我部署一个使用自动版本号的应用程序，然后进行重建（这会增加两个程序集上的版本），并且只重新部署一个新库。当然，就我而言，我并没有使用这种动态加载的东西或反射在它们之间进行调用，所以你可能在这里遇到了一个更复杂的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T20:44:02.490

这只是一个快速响应，因此可能会有一些漏洞。

我们一直在编写插件。在您描述的调用中，我希望 ObjectOfTypeDefinedInAssemblyA 是您在程序集 B 中声明的东西，没有命名冲突。它似乎严重违反了 OOP 的松耦合性质。

例如，我们的一个业务应用程序中的插件处理一种特殊类型的办公室间消息传递。我不希望程序集 A 知道/定义封装消息的对象。我希望程序集 B 将被调用以从程序集 A 实例化该对象；然后程序集 B 将通过调用将其传递回 A。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-29T17:30:17.040

可能是您的程序集同时被加载到“默认加载上下文”和其他一些上下文（或没有）中。Fusion 日志中是否还有其他条目表明正在发生这种情况？

[避免将程序集加载到](http://msdn.microsoft.com/en-us/library/dd153782.aspx#avoid_loading_into_multiple_contexts)MSDN 上的多个上下文中提供了更多详细信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-12-29T18:06:03.503

[此处](http://ayende.com/Blog/archive/2006/05/22/SolvingTheAssemblyLoadContextProblem.aspx)描述的技术将允许您强制将程序集加载到默认加载上下文中。

# java - 是否有相当于 Predicate 的 Java 1.5 .Net 中的方法？

> ID：787446
> 
> 赞同：8
> 
> 时间：2009-04-24T20:23:24.117
> 
> 标签：java, .net, collections, predicate

具体来说，我正在寻找与`Collection<T>.TrueForAll`/`Exists`等类似的干净符号。

必须编写一个 foreach 循环来检查每个对象上的方法的返回感觉很臭，所以我希望有一个更好的 Java 习惯用法。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-24T20:25:42.190

[谓词](http://google-collections.googlecode.com/svn/trunk/javadoc/com/google/common/base/class-use/Predicate.html)在[Google Collections](http://code.google.com/p/google-collections/)库中提供。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-25T03:17:10.767

[函数式 Java](http://functionaljava.org)提供一流的函数。谓词表示为`F<T, Boolean>`。例如，这是一个程序，它测试一个数组是否存在一个全为小写字母的字符串。

```
import fj.F;  
import fj.data.Array;  
import static fj.data.Array.array;
import static fj.function.Strings.matches;

public final class List_exists {  
  public static void main(final String[] args) { 
    final Array<String> a = array("Hello", "There", "how", "ARE", "yOU?");  
    final boolean b = a.exists(matches.f("^[a-z]*$"));  
    System.out.println(b); // true
  }  
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-24T20:25:58.633

据我所知，没有。但是 Apache [Commons Collections](http://commons.apache.org/collections/)有这样的东西：[`Predicate`](http://commons.apache.org/collections/api-release/org/apache/commons/collections/Predicate.html)

* * *

**编辑**：对，正如评论中所指出的，Commons Collections 来自前泛型世界，因此~~[Google Collections](https://stackoverflow.com/questions/787446/is-there-a-java-1-5-equivalent-to-the-predicatet-methods-in-net/787458#787458)~~（*更新*：[Guava](https://code.google.com/p/guava-libraries/)）现在似乎是一个明显更好的选择。尽管如此，Commons Collections 还是值得一提的，因为它是一个著名的图书馆，它可以做到这一点，而且人们也知道*为什么*不使用它。:)

我刚刚在对其主要开发人员的这次[精彩采访](http://www.javalobby.org/articles/google-collections/)中阅读了有关 Google Collections 的更多信息，并想引用一些专门针对“Google Collections vs. Apache Commons Collections”问题的内容：

> **你的方法有什么独特之处？例如，它与 Apache Commons Collection 有何不同？**
> 
> 凯文：“嗯，感谢上帝为 Apache Commons 提供了。如果没有这样的库，我们都会处于糟糕的状态。也就是说，很遗憾，在泛型之前的世界中，特定项目已经停滞不前。他们确实想采用泛型，但是他们认识到这将涉及一个非常重要且不兼容的重写。到目前为止，似乎没有人积极推动这样的努力。在谷歌，自 2005 年春天以来，我们一直在全公司范围内使用 Java 5。一个未通用的集合库对我们来说是一个交易破坏者，因为我们真的讨厌收到编译器警告。我还担心 Apache 集合不符合它们实现的 JDK 接口规范的许多地方。
> 
> [...]
> 
> Jared：“正如 Kevin 所暗示的，我们的库是我所知道的唯一一个在 JDK 之外使用 Java 5 特性构建的集合库：泛型、枚举、协变返回类型等。在编写 Java 5 代码时，您需要一个集合库充分利用了该语言。此外，我们付出了巨大的努力使该库完整、健壮并与 JDK 集合类保持一致。我们的集合类最初受到更多限制，但我们在过去两个中逐渐改进了它们多年来。由于所有库的使用都在 Google 的源代码控制系统中，因此我们可以灵活地修改公共接口。像 Apache Commons Collection 这样的开源项目在初始发布后没有改变其行为的自由。因为我们'一旦 Google Collections Library 1.0 发布，我们就会失去这种灵活性，我们现在渴望收到反馈，这样我们才能把事情做好。”

# c# - 将引用类型从 C++ 编组到 C#

> ID：787448
> 
> 赞同：1
> 
> 时间：2009-04-24T20:23:47.577
> 
> 标签：c#, c++, marshalling

我想从 C# 调用以下 C++ 函数（由 DLL 导出）：

```
void createVm( 
  const jace::VmLoader& loader, 
  const jace::OptionList& options, 
  bool ignoreUnrecognized = true ); 
```

我找到了将原语从 C++ 编组到 C# 的文档，但我不确定如何处理引用类型或非原始类型，例如 VmLoader 或 OptionList（它们都是类）。我正在尝试用 C# 层包装 C++ API，将实际方法实现委托给底层 C++ 代码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T20:29:00.747

AFAIK，不支持使用 C++ 构造调用函数。你可能可以让它工作，但我认为你会发现问题。

支持的是编写一个简单的 C 包装函数，该函数调用您的 C++ 函数。PInvoke 改为包装函数，这样就可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T21:44:08.523

假设 c++ DLL 正确导出通过引用传递的类型，您可以正确调用 dll 的轻量级托管 C++ 包装器。使用托管 c++，您可以直接调用本机 C/C++ 库和 dll，同时仍从生成的程序集中导出托管接口。其他 .Net 语言可以像调用任何其他程序集一样调用托管接口。这有点额外的开销，但它可能是完成它的最快方法。

# java - 在哪里可以找到和下载 Java Speech API？

> ID：787462
> 
> 赞同：1
> 
> 时间：2009-04-24T20:26:51.737
> 
> 标签：java, speech-recognition

请告诉我从哪里可以下载 JVM 1.4 和 Java Speech API？

### 也可以看看：

> [下载并安装 IBM 的 Speech for Java](https://stackoverflow.com/questions/783067/download-and-install-ibms-speech-for-java)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T20:32:57.447

来自[Desktop Java Java Speech API的链接指向](https://web.archive.org/web/20090227082336/http://java.sun.com/products/java-media/speech/)[FreeTTS](http://freetts.sourceforge.net/docs/index.php)的 SourceForge 页面。常见问题[解答说](https://www.oracle.com/technetwork/java/jsapifaq-135248.html)：

> Java Speech API (JSAPI) 不是 JDK 的一部分，Sun 没有提供 JSAPI 的实现。相反，我们与第三方语音公司合作，以鼓励多种实现的可用性。

[常见问题解答](https://www.oracle.com/technetwork/java/jsapifaq-135248.html#implementation)还列出并链接到更多实现：

*   [免费TTS](http://freetts.sourceforge.net/)
*   [云花园](https://web.archive.org/web/20090610064142/http://cloudgarden.com/)
*   [Lernout & Hauspie 的 TTS for Java Speech API](http://www.lhs.com/)（链接重定向到[http://www.nuance.com/](http://www.nuance.com/)，因此该应用程序可能仍然可用，也可能不可用）
*   [Conversa Web 3.0](http://www.conversa.com/)（现在链接到一家西班牙沉浸式培训公司）
*   [节日](http://www.cstr.ed.ac.uk/projects/festival/)
*   [Elan Speech Cube](http://www.elantts.com/products/fp_speechcube.html)（链接出现 HTTP 404 错误）

我自己没有调查过这些，但似乎有大量的第三方实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T20:34:05.260

[http://java.sun.com/j2se/1.4.2/download.html](http://java.sun.com/j2se/1.4.2/download.html)

# security - 网站管理 - 集成到主网站或单独的部分？

> ID：787471
> 
> 赞同：5
> 
> 时间：2009-04-24T20:30:42.757
> 
> 标签：security, usability, administration

从可用性的角度来看，在主网站上集成管理部分更好还是有一个单独的部分来管理内容？

任何想法都非常感谢。

编辑：该应用程序是非常非技术友好型员工的 CMS。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T20:37:35.533

恕我直言，这取决于您要管理的项目和部分。

例如，新闻帖子的评论应该在网站本身中通过为每条评论显示一个“删除”链接按钮来管理。否则，模组将不得不在管理部分中查找评论 => 对用户不太友好。

但总的来说，我认为单独的管理部分通常对您的客户来说更清楚。您希望他们像普通用户一样看到该站点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T20:32:34.623

至少我会建议将所有管理文件移动到一个单独的文件夹中。这样，如果您使用.NET 之类的平台，您可以通过基于角色和用户的 web.config 权限非常轻松地控制文件夹访问。

将您的管理文件全部隔离还可以让您轻松地做其他事情，例如如果您决定稍后将它们移动到另一台服务器，请删除它们。你也可以在你的 robots.txt 文件中排除它们（尽管将它放在 robots.txt 文件中你会告诉其他人这个部分存在，机器人不必介意这个文件）。

编辑：

考虑到你的问题，我觉得我的回答有点落伍了。当然，从可用性的角度来看，在线编辑比转到单独的页面更容易，但每当我听到将管理员用户与普通用户混合在一起时，我的脑海中就会响起巨大的警钟。

我认为这取决于网站的功能以及它对您的员工的干扰程度。他们在浏览网站时进行更改是否有意义，他们最终是否会对您的系统感到气馁，因为这会迫使他们在他们的流程中注入不必要的步骤？编辑需要多长时间？向管理员显示完全不同的界面是否有意义？我认为这个问题的答案需要更多地了解您要完成的特定功能，并且会因具体情况而异。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-24T20:37:22.443

我从不喜欢将管理页面添加到主站点中。似乎有人意外访问该网站的管理部分的风险太大。即使您一遍又一遍地检查安全性，也总是有可能发生一些意想不到的事情，并且清理起来是一个巨大的混乱（修改了什么，谁访问了什么等等）。在我看来，将其作为一个单独的站点是最简单的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T20:35:58.953

虽然能够以特权用户身份登录到站点的主要部分，然后单击页面的某些部分来编辑/更改它有一定程度的便利性，但将其置于单独的区域。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T20:36:23.523

我发现在网站上设置一个专门用于管理任务的单独部分可以使这些任务更易于组织和使用。看看 Wordpress（尤其是新的 2.7 版本）、Drupal（一个非常流行的 cms）和 Joomla（另一个非常流行的 cms）。如果您想测试这些功能以了解为什么我认为单独的部分更好，您可以访问[www.opensourcecms.com](http://www.opensourcecms.com)并测试 Drupal 和 Joomla。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-24T20:53:10.487

从可用性来看，集成度越高越好，但它往往会严重增加复杂性。如果您可以在它发生的上下文中执行操作，它总是最好的 - 锁定一个坏用户，修剪一个太大的日志等等。然而，由于这些往往会产生重大的副作用，所以安全方面在很多时候都胜过这一点出于恐惧。

我认为您需要考虑对将管理功能直接集成到应用程序中进行风险评估。

*   如果有人能够提升权限并获得对管理功能的访问权限，对系统会有什么影响。如果每个用户都被恶意锁定 - 对站点、声誉、SLA 等的损害？

*   管理员可以从本节执行哪些破坏性功能？删除大量数据？让应用崩溃？改变对用户/客户有重大影响的成本？

*   管理功能是集成在应用程序中还是隔离到特定的管理功能中？

*   应用程序是否具有公众形象，或者它是被假定为安全的 Intranet？

我个人从不放心将管理部分与网站集成，因为担心我的无能或我无法控制的安全漏洞，例如糟糕的默认设置、未修补的漏洞利用。然而，当客户写支票时，我倾向于做他们认为最好的事情。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-24T22:28:25.640

我来自可用性学校，它说“尽量减少猜测工作”。那么，您从用户组会话中获得了哪些信息？

请记住，您不是（我们也不是）系统的典型用户。我们所说的一切都将是猜测。更糟糕的是，这里显示的任何意见都可能不适合您的情况（但可能对他们的所作所为很棒）。您对做什么有明智的看法的唯一方法是走出去，以智能的方式询问您的用户。

因为这是一个安全问题，所以您的一些用户组合应该是专门从事安全工作的人。仅仅因为它更容易使用并不意味着它是最合适的。

# asp.net - 在设计视图中根据需要标记控件属性

> ID：787473
> 
> 赞同：2
> 
> 时间：2009-04-24T20:31:26.450
> 
> 标签：asp.net, visual-studio, custom-controls

我想强制控件的使用者在将控件放在页面上时给属性一个值。

在 VisualStudio 中，当您在用户控件上创建没有属性 SRC 或 ALT 的 < img > 标记时，它会带有下划线，表示 SRC 和 ALT 是必需的属性。我认为这只是编辑器对标签的特殊处理，但是有没有办法为控件定义类似的行为？

如果控件具有这样定义的属性：

```
public object AProperty
{
    get 
    {
        if (ViewState["AProperty"] == null)
        {
            throw new Exception("AProperty is a required property of this control");
        }
        return ViewState["AProperty"];
    }
    set { ViewState["AProperty"] = value; }
} 
```

有没有办法使用自定义属性或其他会在设计器中标记的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T21:14:21.527

您可以使用 Microsoft.Build.Framework.Required 属性。这将需要在构建时设置一个值，否则构建将失败并显示一条消息，指示该属性没有值。

我不相信有一个属性可以指示特定标签必须包含在服务器控件中（或者至少我在 System.Web.UI.HtmlControl.Image 类上看不到任何此类属性）。我相信小下划线是 IDE 的 HTML 验证的一部分。

您始终可以创建一个自定义属性，如果缺少某个属性，该属性会引发警告

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-30T23:46:35.397

虽然 Microsoft.Build.Framework.Required 可能是这里最好的答案，但对于其他偶然发现此问题且无法使用 .NET 4.0 的人，您也可以使用此方法：

[http://forums.asp.net/t/1238319.aspx](http://forums.asp.net/t/1238319.aspx)

# c++ - VC9下SQLite3的麻烦

> ID：787481
> 
> 赞同：0
> 
> 时间：2009-04-24T20:34:27.817
> 
> 标签：c++, sqlite

我将 sqlite3.c sqlite3.h 导入到我的项目中 - 我在编译它时遇到了麻烦。

错误：

```
1>c:\...\storage_manager.h(7) : error C2079: 'storage_manager::db' uses undefined struct 'sqlite3'
    1>storage_manager.cpp
    1>c:\...\storage_manager.h(7) : error C2079: 'storage_manager::db' uses undefined struct 'sqlite3'
    1>ui_manager.cpp
    1>c:\...\storage_manager.h(7) : error C2079: 'storage_manager::db' uses undefined struct 'sqlite3' 
```

代码：

```
#pragma once
#include "sqlite3.h"
class storage_manager
{
    sqlite3 db;
    sqlite3** db_pp;
public:
    void open()
    {
        sqlite3_open("data.db", db_pp);
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T20:42:49.357

我刚刚注意到您尝试创建一个名为*db的**sqlite3*类型的堆栈变量。那是行不通的，因为 sqlite3 是一个*句柄*，你只能有一个指针变量。然后您需要将该指针变量的地址传递给 sqlite3_open。

 **@Neil Butterworth 比我早一点发现它 :-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T20:53:58.567

您不应该创建 sqlite3 类型的对象，只能创建指针。删除行：

```
 sqlite3 db; 
```

一切都应该没问题。

# c# - 如何防止 Excel 互操作在插入图像时窃取焦点

> ID：787484
> 
> 赞同：2
> 
> 时间：2009-04-24T20:35:08.610
> 
> 标签：c#, excel, com, interop

我正在使用 Excel COM 互操作将图像（特别是 EPS）插入电子表格。图像插入得很好，但 Excel 会忽略所有可见/背景设置并窃取焦点，显示一个对话框，上面写着“导入图像”之类的内容。对话框只保留一小部分，但它会使屏幕闪烁，更糟糕的是，当我一次插入许多图像时，它可以独占系统几秒钟（包括从前台进程中窃取击键）。

我将背景选项设置如下：

```
Excel.Application xlApp = new Excel.Application();
xlApp.Visible = false;
xlApp.ScreenUpdating = false;
xlApp.DisplayAlerts = false;
Excel.Worksheet worksheet;
//....
worksheet.Pictures(Type.Missing).Insert(filename,Type.Missing); //steals focus 
```

我怎样才能让 Excel 像它所属的那样留在后台？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-01T03:15:50.547

我怀疑这是由 Microsoft 许可的一个行为不良的组件引起的。

处理这种情况的唯一方法是拦截适当的低级 Windows 消息并使用[Win32 挂钩阻止它](http://msdn.microsoft.com/en-us/library/ms997537.aspx)

最简单的方法是使用 CBT 钩子，相信我，它并不漂亮。CBT 代表“基于计算机的培训”。这是一项古老且几乎已过时的技术，旨在使创建培训应用程序成为可能，这些应用程序可以监视您正在做的事情并做出相应的反应。唯一有用的是在您无权访问的代码中挂钩和防止窗口激活。您可以拦截 HCBT_ACTIVATE 代码并阻止窗口激活。

这可能需要在 C 或 C++ 中完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-11T19:40:57.800

与常识相反，设置`xlApp.ScreenUpdating = true;`可以防止焦点窃取！（[来源](https://social.msdn.microsoft.com/Forums/office/en-US/7ec7ee04-9408-4205-a16e-741e624a8ab7/excel-automation-application-steals-focus?forum=exceldev)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-28T15:51:36.090

我不确定我对你的问题有一个很好的答案（我会留下评论，但显然我还没有足够的声誉），但如果它有帮助，我经常也会禁用事件

```
xlApp.EnableEvents = False 
```

显然，当您在代码中依赖 Excel 事件时，您必须对此设置敏感，但以防万一在您插入时触发了一些不需要的事件，这可能会有所帮助。

祝你好运！

# sql-server - SQL Server 2005 复制

> ID：787489
> 
> 赞同：6
> 
> 时间：2009-04-24T20:36:47.593
> 
> 标签：sql-server, database, sql-server-2005, replication

环境：SQL Server 2005 SP2 (9.0.3077) 事务发布（生产和测试版）

我有一种情况，我有两个不同的复制出版物设置，它们使用一些相同的文章。这些出版物中的每一个都为不同机器上的订阅者提供信息。这些共享文章之一是表格。在固定的时间间隔内，该表中的许多记录都会老化并且不再需要。这时会调用一个删除记录的存储过程。

为了节省资源并改善订阅者的延迟时间，我已将此存储过程的复制属性设置为“执行存储过程”，而不是默认的“仅存储过程定义”。这样，当存储过程删除 2,000,000 多条记录时，这些记录不会复制到订阅者。而是复制存储过程的执行，并在订阅者上执行相同的复制存储过程，并删除相同的 2,000,000+ 行。

我遇到的问题是我的第二个出版物。我不需要这种类型的行为，所以我将存储过程上的 article 属性设置为“仅存储过程定义”，并希望复制能够删除其他订阅者的行，但事实并非如此。订户的桌子不断获得记录。所以为了修复它，我将文章属性设置为“执行...”并称之为好。这可能是最好的解决方案，因此 beta 与生产相匹配，但它仍然感觉像是一个杂物，因为发布属性应该彼此独立工作。

问题：为什么“执行存储过程”文章属性优先并应用于其他发布，即使它在其他发布中设置为“仅存储过程定义”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-05T08:25:53.660

我们在公司中广泛使用复制，因为我们在多个国家/地区拥有 38 个仓库，所有仓库都复制回我们在伦敦的主服务器。

首先，您的复制过滤器应该使用视图，即使是简单的视图。这样，如果您需要调整过滤器（阅读 WHERE 子句），您只需要更改视图并完成。否则，您必须重新发布您的数据，并重新订阅每个人，这可能会很痛苦。

您提到您在订阅者和发布者上运行相同的删除以使它们保持同步。这让我脊背发凉。您最好将它们删除在一个地方并让服务器将所做的更改复制给订阅者。自 SQL Server 2005 以来，复制现在非常快速和高效。SQL 2000 的复制速度非常慢。如果您使用 SQL 2005/2008，只需确保您的兼容性级别（右键单击数据库、属性、选项）设置为 90 (2005) 或 100 (2008)。这会将 sql server 切换到快速高效的复制方法。

另一种方法是不删除数据，而是保留它并使用发布中的 where 子句将其过滤掉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-28T21:18:13.670

自从我主动管理复制以来已经有很长时间了，但我怀疑答案与日志阅读器的体系结构有关，并且您正在出版物之间共享一篇文章。我的理解是日志阅读器将遍历日志并查找对复制项目的操作。根据文章设置，对数据的个别更改可能会发布到分发数据库中的表中，或者将发布过程调用的记录。无论如何，这是文章的属性，而不是文章所属的出版物。我假设（但尚未测试和验证）您可以在同一个数据库对象之上创建多篇文章，并使用 @type='logbased' 复制另一篇文章，使用 @type='proc exec' 复制另一篇文章

对这一切持保留态度：虽然我现在在 SQL 2008 上进行开发，但我最后一次对复制做任何事情是 SQL 7。

pjjH

# algorithm - 计算热门话题或标签的最佳方法是什么？

> ID：787496
> 
> 赞同：206
> 
> 时间：2009-04-24T20:40:45.463
> 
> 标签：algorithm, tags, information-retrieval

许多网站提供一些统计数据，例如“过去 24 小时内最热门的话题”。例如，Topix.com 在其“新闻趋势”部分中显示了这一点。在那里，您可以看到提及次数增长最快的主题。

我也想为一个主题计算这样的“嗡嗡声”。我怎么能这样做？该算法应该对总是不太热的主题进行加权。通常（几乎）没有人提及的话题应该是最热门的话题。

Google 提供“Hot Trends”，topix.com 显示“Hot Topics”，fav.or.it 显示“Keyword Trends”——所有这些服务都有一个共同点：它们只向您展示当前异常热门的即将到来的趋势。

诸如“Britney Spears”、“weather”或“Paris Hilton”之类的词不会出现在这些列表中，因为它们总是热门且频繁出现。[这篇文章称之为“布兰妮斯皮尔斯问题”。](https://www.americanscientist.org/article/the-britney-spears-problem)

我的问题：您如何编写算法或使用现有算法来解决这个问题？拥有一个包含最近 24 小时搜索的关键字的列表，该算法应该向您显示 10 个（例如）最热门的关键字。

我知道，在上面的文章中，提到了某种算法。[我试图用 PHP 对其进行编码，](http://paste.bradleygill.com/index.php?paste_id=9117)但我认为它不会起作用。它只是找到大多数，不是吗？

我希望你能帮助我（编码示例会很棒）。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2009-05-05T19:22:20.503

这个问题需要一个 z 分数或标准分数，它会考虑到历史平均值，正如其他人提到的那样，还要考虑这个历史数据的标准偏差，使其比仅使用平均值更稳健。

在您的情况下，z 分数是通过以下公式计算的，其中趋势将是诸如观看次数/天之类的比率。

```
z-score = ([current trend] - [average historic trends]) / [standard deviation of historic trends] 
```

当使用z-score时，z-score越高或越低，趋势越异常，例如，如果z-score为高正则趋势异常上升，而如果z-score为高负则异常下降. 因此，一旦您计算了所有候选趋势的 z 分数，最高的 10 个 z 分数将与最异常增加的 z 分数相关。

有关 z 分数的更多信息，请参阅[Wikipedia](http://en.wikipedia.org/wiki/Standard_score)。

**代码**

```
from math import sqrt

def zscore(obs, pop):
    # Size of population.
    number = float(len(pop))
    # Average population value.
    avg = sum(pop) / number
    # Standard deviation of population.
    std = sqrt(sum(((c - avg) ** 2) for c in pop) / number)
    # Zscore Calculation.
    return (obs - avg) / std 
```

**样本输出**

```
>>> zscore(12, [2, 4, 4, 4, 5, 5, 7, 9])
3.5
>>> zscore(20, [21, 22, 19, 18, 17, 22, 20, 20])
0.0739221270955
>>> zscore(20, [21, 22, 19, 18, 17, 22, 20, 20, 1, 2, 3, 1, 2, 1, 0, 1])
1.00303599234
>>> zscore(2, [21, 22, 19, 18, 17, 22, 20, 20, 1, 2, 3, 1, 2, 1, 0, 1])
-0.922793112954
>>> zscore(9, [1, 2, 0, 3, 1, 3, 1, 2, 9, 8, 7, 10, 9, 5, 2, 4, 1, 1, 0])
1.65291949506 
```

**笔记**

*   如果您不想考虑太多历史记录，您可以将此方法与滑动窗口（即过去 30 天）一起使用，这将使短期趋势更加明显，并可以减少处理时间。

*   您还可以使用 z 分数来表示从一天到第二天的观看次数变化等值，以定位每天增加/减少观看次数的异常值。这就像使用每日视图的斜率或导数一样。

*   如果您跟踪人口的当前规模、人口的当前总数以及人口的当前总数 x^2，则无需重新计算这些值，只需更新它们，因此您只需将这些值保留为历史记录，而不是每个数据值。下面的代码演示了这一点。

    ```
     from math import sqrt

      class zscore:
          def __init__(self, pop = []):
              self.number = float(len(pop))
              self.total = sum(pop)
              self.sqrTotal = sum(x ** 2 for x in pop)
          def update(self, value):
              self.number += 1.0
              self.total += value
              self.sqrTotal += value ** 2
          def avg(self):
              return self.total / self.number
          def std(self):
              return sqrt((self.sqrTotal / self.number) - self.avg() ** 2)
          def score(self, obs):
              return (obs - self.avg()) / self.std() 
    ```

*   使用这种方法，您的工作流程将如下所示。为每个主题、标签或页面创建一个浮点字段，用于显示数据库中的总天数、查看次数总和以及查看次数平方和。如果您有历史数据，请使用该数据初始化这些字段，否则初始化为零。在每天结束时，使用当天的查看次数与存储在三个数据库字段中的历史数据计算 z 分数。具有最高 X z 分数的主题、标签或页面是您当天的 X 个“最热门趋势”。最后用当天的值更新 3 个字段中的每一个，并在第二天重复该过程。

**新增内容**

上面讨论的正常 z 分数不考虑数据的顺序，因此观察“1”或“9”的 z 分数与序列 [1, 1, 1, 1 , 9, 9, 9, 9]。显然，对于趋势发现，最新数据应该比旧数据具有更大的权重，因此我们希望“1”观察值比“9”观察值具有更大的量值分数。为了实现这一点，我提出了一个浮动平均 z 分数。应该清楚的是，这种方法不能保证在统计上是合理的，但应该对趋势发现或类似方法有用。标准 z-score 和浮动平均 z-score 的主要区别在于使用浮动平均数来计算平均人口值和平均人口值的平方。详情见代码：

**代码**

```
class fazscore:
    def __init__(self, decay, pop = []):
        self.sqrAvg = self.avg = 0
        # The rate at which the historic data's effect will diminish.
        self.decay = decay
        for x in pop: self.update(x)
    def update(self, value):
        # Set initial averages to the first value in the sequence.
        if self.avg == 0 and self.sqrAvg == 0:
            self.avg = float(value)
            self.sqrAvg = float((value ** 2))
        # Calculate the average of the rest of the values using a 
        # floating average.
        else:
            self.avg = self.avg * self.decay + value * (1 - self.decay)
            self.sqrAvg = self.sqrAvg * self.decay + (value ** 2) * (1 - self.decay)
        return self
    def std(self):
        # Somewhat ad-hoc standard deviation calculation.
        return sqrt(self.sqrAvg - self.avg ** 2)
    def score(self, obs):
        if self.std() == 0: return (obs - self.avg) * float("infinity")
        else: return (obs - self.avg) / self.std() 
```

**示例 IO**

```
>>> fazscore(0.8, [1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9]).score(1)
-1.67770595327
>>> fazscore(0.8, [1, 1, 1, 1, 1, 1, 9, 9, 9, 9, 9, 9]).score(9)
0.596052006642
>>> fazscore(0.9, [2, 4, 4, 4, 5, 5, 7, 9]).score(12)
3.46442230724
>>> fazscore(0.9, [2, 4, 4, 4, 5, 5, 7, 9]).score(22)
7.7773245459
>>> fazscore(0.9, [21, 22, 19, 18, 17, 22, 20, 20]).score(20)
-0.24633160155
>>> fazscore(0.9, [21, 22, 19, 18, 17, 22, 20, 20, 1, 2, 3, 1, 2, 1, 0, 1]).score(20)
1.1069362749
>>> fazscore(0.9, [21, 22, 19, 18, 17, 22, 20, 20, 1, 2, 3, 1, 2, 1, 0, 1]).score(2)
-0.786764452966
>>> fazscore(0.9, [1, 2, 0, 3, 1, 3, 1, 2, 9, 8, 7, 10, 9, 5, 2, 4, 1, 1, 0]).score(9)
1.82262469243
>>> fazscore(0.8, [40] * 200).score(1)
-inf 
```

**更新**

正如 David Kemp 正确指出的那样，如果给定一系列常数值，然后请求与其他值不同的观察值的 zscore，则结果可能应该是非零的。实际上返回的值应该是无穷大。所以我改变了这条线，

```
if self.std() == 0: return 0 
```

至：

```
if self.std() == 0: return (obs - self.avg) * float("infinity") 
```

此更改反映在 fazscore 解决方案代码中。如果不想处理无限值，则可接受的解决方案是将行改为：

```
if self.std() == 0: return obs - self.avg 
```

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2009-05-05T18:45:42.480

你需要一个算法来衡量一个话题的速度——或者换句话说，如果你用图表来展示那些以惊人的速度上升的话题。

这是趋势线的一阶导数，不难作为整体计算的加权因子。

**标准化**

您需要做的一项技术是规范化所有数据。对于您关注的每个主题，保留一个定义该主题基线的低通滤波器。现在，关于该主题的每个数据点都应该被标准化 - 减去它的基线，你会得到所有主题接近 0，在线上方和下方都有峰值。相反，您可能希望将信号除以其基线幅度，这将使信号达到 1.0 左右 - 这不仅使所有信号彼此一致（使基线标准化），而且使尖峰标准化。布兰妮的尖峰将比其他人的尖峰大几个数量级，但这并不意味着你应该注意它 - 相对于她的基线，尖峰可能非常小。

**派生**

将所有内容标准化后，找出每个主题的斜率。取两个连续的点，并测量差异。正差呈上升趋势，负差呈下降趋势。然后，您可以比较归一化的差异，并找出与其他主题相比，哪些主题的受欢迎程度正在上升——每个主题都根据自己的“正常”进行缩放，这可能与其他主题的数量级不同。

这确实是解决问题的第一步。您需要使用更高级的技术（主要是上述技术与其他算法的组合，加权以满足您的需求），但这应该足以让您入门。

**关于文章**

这篇文章是关于话题趋势的，但不是关于如何计算什么是热门和什么不是，而是关于如何处理这种算法必须在 Lycos 和 Google 等地方处理的大量信息。为每个主题提供一个计数器所需的空间和时间，并在对其进行搜索时找到每个主题的计数器是巨大的。本文是关于尝试此类任务时面临的挑战。它确实提到了布兰妮效应，但没有谈到如何克服它。

正如[Nixuz 指出的那样，](https://stackoverflow.com/questions/826330/britney-spears-problem-how-to-solve/826509#826509)这也称为 Z 或[标准分数](http://en.wikipedia.org/wiki/Standard_score)。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-05-05T19:34:51.830

Chad Birch 和 Adam Davis 是正确的，因为你必须向后看才能建立基线。如您所说，您的问题表明您只想查看过去 24 小时内的数据，而这并不完全可行。

在不必查询大量历史数据的情况下为数据提供一些内存的一种方法是使用[指数移动平均线。](http://en.wikipedia.org/wiki/Moving_average#Exponential_moving_average) 这样做的好处是您可以每个周期更新一次，然后刷新所有旧数据，因此您只需要记住一个值。因此，如果您的月经是一天，您必须为每个主题维护一个“每日平均”属性，您可以通过以下方式做到：

```
a_n = a_(n-1)*b + c_n*(1-b) 
```

哪里`a_n`是当天的移动平均`n`线，b 是介于 0 和 1 之间的某个常数（越接近 1，内存越长）并且`c_n`是当天的点击次数`n`。美妙之处在于，如果您在一天结束时执行此更新`n`，您可以刷新`c_n`和`a_(n-1)`.

需要注意的是，它最初会对您选择的初始值敏感`a`。

编辑

如果它有助于可视化这种方法，请采用`n = 5`、`a_0 = 1`和`b = .9`。

假设新值为 5,0,0,1,4：

```
a_0 = 1
c_1 = 5 : a_1 = .9*1 + .1*5 = 1.4
c_2 = 0 : a_2 = .9*1.4 + .1*0 = 1.26
c_3 = 0 : a_3 = .9*1.26 + .1*0 = 1.134
c_4 = 1 : a_4 = .9*1.134 + .1*1 = 1.1206
c_5 = 4 : a_5 = .9*1.1206 + .1*5 = 1.40854 
```

看起来不是很像平均水平吗？请注意该值如何保持接近 1，即使我们的下一个输入是 5。发生了什么？如果你扩展数学，你会得到什么：

```
a_n = (1-b)*c_n + (1-b)*b*c_(n-1) + (1-b)*b^2*c_(n-2) + ... + (leftover weight)*a_0 
```

我说的剩余重量是什么意思？好吧，在任何平均值中，所有权重都必须加到 1。如果 n 是无穷大并且 ... 可以永远持续下去，那么所有权重的总和将为 1。但是如果 n 相对较小，则剩下的权重很大在原始输入上。

如果你研究了上面的公式，你应该意识到关于这个用法的一些事情：

1.  所有数据都永远对平均值*有所贡献。*实际上，有一点贡献是非常非常小的。
2.  最近的价值观比旧价值观的贡献更大。
3.  b 越高，新值越不重要，而旧值越重要。但是，b 越高，需要稀释 a 的初始值的数据就越多。

我认为前两个特征正是您正在寻找的。为了给你一个简单的想法，这可以实现，这是一个 python 实现（减去所有数据库交互）：

```
>>> class EMA(object):
...  def __init__(self, base, decay):
...   self.val = base
...   self.decay = decay
...   print self.val
...  def update(self, value):
...   self.val = self.val*self.decay + (1-self.decay)*value
...   print self.val
... 
>>> a = EMA(1, .9)
1
>>> a.update(10)
1.9
>>> a.update(10)
2.71
>>> a.update(10)
3.439
>>> a.update(10)
4.0951
>>> a.update(10)
4.68559
>>> a.update(10)
5.217031
>>> a.update(10)
5.6953279
>>> a.update(10)
6.12579511
>>> a.update(10)
6.513215599
>>> a.update(10)
6.8618940391
>>> a.update(10)
7.17570463519 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-04-30T13:28:17.417

通常使用某种形式的指数/对数衰减机制来计算“嗡嗡声”。有关 Hacker News、Reddit 和其他人如何以简单的方式处理此问题的概述，请参阅[这篇文章](http://www.seomoz.org/blog/reddit-stumbleupon-delicious-and-hacker-news-algorithms-exposed)。

这并没有完全解决总是流行的事情。您正在寻找的内容似乎类似于 Google 的“[热门趋势](http://www.google.com/intl/en/trends/about.html#4)”功能。为此，您可以将当前值除以历史值，然后减去低于某个噪声阈值的值。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-05-05T18:49:02.110

我认为他们需要注意的关键词是“异常”。为了确定什么时候“异常”，你必须知道什么是正常的。也就是说，您将需要历史数据，您可以对其进行平均以找出特定查询的正常速率。您可能希望从平均计算中排除异常天数，但这需要已经有足够的数据，以便您知道要排除哪些天数。

从那里开始，您必须设置一个阈值（我敢肯定，这需要进行实验），如果超出阈值，例如比正常搜索次数多 50%，您可以将其视为“趋势”。或者，如果您希望能够像您提到的那样找到“Top X Trendiest”，您只需要按照它们与正常价格相差多远（按百分比）排序即可。

例如，假设您的历史数据告诉您，布兰妮斯皮尔斯通常会获得 100,000 次搜索，而帕丽斯·希尔顿通常会获得 50,000 次搜索。如果有一天他们俩的搜索量都比平时多 10,000 次，那么您应该认为巴黎比布兰妮“更热”，因为她的搜索量比平时增加了 20%，而布兰妮的搜索量仅增加了 10%。

天哪，我简直不敢相信我刚刚写了一段比较布兰妮斯皮尔斯和帕丽斯希尔顿的“辣度”。你对我做了什么？

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2013-05-27T04:48:28.830

我想知道在这种情况下是否可以使用常规的物理加速公式？

```
v2-v1/t or dv/dt 
```

我们可以将 v1 视为每小时最初的点赞/投票/评论计数，而将 v2 视为过去 24 小时内每小时的当前“速度”？

这更像是一个问题而不是一个答案，但似乎它可能只是工作。任何具有最高加速度的内容都将成为热门话题……

我相信这可能无法解决布兰妮斯皮尔斯的问题:-)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-04-24T20:41:56.957

可能一个简单的主题频率梯度会起作用——大的正梯度=受欢迎程度迅速增长。

最简单的方法是对每天搜索的数量进行分类，所以你有类似的东西

```
searches = [ 10, 7, 14, 8, 9, 12, 55, 104, 100 ] 
```

然后找出它每天变化了多少：

```
hot_factor = [ b-a for a, b in zip(searches[:-1], searches[1:]) ]
# hot_factor is [ -3, 7, -6, 1, 3, 43, 49, -4 ] 
```

并且只需应用某种阈值，以便增加 > 50 的日子被认为是“热”的。如果您愿意，您也可以使这变得更加复杂。而不是绝对差异，您可以采用相对差异，以便从 100 到 150 被认为是热的，但 1000 到 1050 不是。或更复杂的梯度，它考虑了不止一天到下一天的趋势。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-06-06T03:52:16.683

我曾参与过一个项目，我的目标是从实时 Twitter 流中找到热门话题，并对热门话题进行情感分析（找出热门话题是否正面/负面谈论）。我使用 Storm 来处理 Twitter 流。

我已将我的报告发布为博客：[http ://sayrohan.blogspot.com/2013/06/finding-trending-topics-and-trending.html](http://sayrohan.blogspot.com/2013/06/finding-trending-topics-and-trending.html)

我使用 Total Count 和 Z-Score 进行排名。

我使用的方法有点通用，在讨论部分中，我提到了我们如何为非 Twitter 应用程序扩展系统。

希望信息有所帮助。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-08-14T01:39:17.280

如果您只是查看推文或状态消息来获取您的主题，您会遇到很多噪音。即使您删除所有停用词。获得更好的主题候选子集的一种方法是仅关注共享 URL 的推文/消息，并从这些网页的标题中获取关键字。并确保您也应用 POS 标记来获取名词 + 名词短语。

网页的标题通常更具描述性，并包含描述页面内容的词语。此外，分享网页通常与分享突发新闻相关（即，如果像迈克尔杰克逊这样的名人去世，您将有很多人分享有关他去世的文章）。

我进行了实验，我只从标题中获取热门关键字，然后在所有状态消息中获取这些关键字的总数，它们肯定会消除很多噪音。如果你这样做，你不需要复杂的算法，只需对关键字频率进行简单的排序，你就成功了。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-05-04T19:03:04.643

您可以使用 log-likelihood-ratio 将当前日期与上个月或上一年进行比较。这在统计上是合理的（鉴于您的事件不是正态分布的，这是从您的问题中假设的）。

只需按 logLR 对所有术语进行排序，然后选择前十名。

```
public static void main(String... args) {
    TermBag today = ...
    TermBag lastYear = ...
    for (String each: today.allTerms()) {
        System.out.println(logLikelihoodRatio(today, lastYear, each) + "\t" + each);
    }
} 

public static double logLikelihoodRatio(TermBag t1, TermBag t2, String term) {
    double k1 = t1.occurrences(term); 
    double k2 = t2.occurrences(term); 
    double n1 = t1.size(); 
    double n2 = t2.size(); 
    double p1 = k1 / n1;
    double p2 = k2 / n2;
    double p = (k1 + k2) / (n1 + n2);
    double logLR = 2*(logL(p1,k1,n1) + logL(p2,k2,n2) - logL(p,k1,n1) - logL(p,k2,n2));
    if (p1 < p2) logLR *= -1;
    return logLR;
}

private static double logL(double p, double k, double n) {
    return (k == 0 ? 0 : k * Math.log(p)) + ((n - k) == 0 ? 0 : (n - k) * Math.log(1 - p));
} 
```

PS，TermBag 是单词的无序集合。为每个文档创建一袋术语。只计算单词的出现次数。然后该方法`occurrences`返回给定单词的出现次数，该方法`size`返回单词的总数。最好以某种方式规范化单词，通常`toLowerCase`就足够了。当然，在上面的示例中，您将创建一个包含今天所有查询的文档，以及一个包含去年所有查询的文档。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-05-05T18:45:40.327

这个想法是跟踪这些事情，并在它们与自己的基线相比显着跳跃时注意。

因此，对于超过某个阈值的查询，跟踪每个查询，当它变为其历史值的某个值（例如几乎翻倍）时，这是一个新的热门趋势。

# jquery - 为什么 jQuery Ajax 在 IE7 上这么慢？

> ID：787500
> 
> 赞同：12
> 
> 时间：2009-04-24T20:41:02.793
> 
> 标签：jquery, ajax, internet-explorer-7

我在 IE7 上遇到 jQuery AJAX 调用问题。这个简单的代码在 FF 和 Opera 上运行良好。但在 IE7 上需要 3-5 秒。- 这比 FF 慢 20 倍！加载内容是纯 HTML 和内联 JavaScript 代码。没有 JS 渲染。我什至关闭了内联 JavaScript 代码。卜还是慢。

```
$('#block').load('some url'); 
```

如何克服这个问题？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-04-24T20:44:24.673

> 如何克服这个问题？任何帮助将不胜感激。

在页面加载时检测 IE7，并提供不喜欢缓慢加载的用户应该升级的离散建议。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-04-24T21:03:18.527

我对慢速 jscript ie7 引擎也有同样的问题。我为人类添加了一个状态弹出窗口。当 JS 分块进行时，我会更新状态窗口。伪代码：

1.  使用您最喜欢的 js 库创建一个状态容器。我更喜欢YUI。查看他们的容器 api。
2.  做一些数据加载。-- 你首先需要把它分成块
3.  更新状态弹出窗口。（增加加载完成的百分比，增加条形指示器等）请注意，此时屏幕可能不会改变，因为您的 JS 线程仍在运行。
4.  接下来，调用

```
var t = setTimeout("next_step(2)", 0);
// 其中 arg 为 2 表示执行第二步
// 这将屈服于浏览器，然后显示将被更新。
// 如果你想在函数中保持“this”的值，那么做
// 就像是
var t = setTimeout("next_step.call(MyContext, 2)", 0);
// 使用调用来设置函数的上下文。
```

底线是用户会在屏幕上看到一些变化。请注意，相对而言，超时为 0 的让步步骤需要相当长的时间。所以我的代码测试浏览器，如果它不是 IE 的话，每个块做更多的工作。

向用户提供不断变化的反馈非常重要。否则，他们认为花费的时间比实际时间长。

高温下，

拉里

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-02T12:08:36.963

我必须查看实际代码，但遇到类似的问题，我必须摆脱*jQuery.load()*。相反，我使用带有“html”数据类型的**jQuery.get()并编写了我自己的回调，在那里我通过****.innerHTML**注入了数据。这样做，我还遇到了另一个错误（它是一个 <select> 标记，IE 不允许在其上使用 .innerHTML）所以我写了一个丑陋的解决方法。

结果代码是这样的：

```
// Fetch data (GET method allows me to use browser cache)
$.get(url, get, function(htmlValues, txtStatus){
   that.populateSelects(htmlValues, that.selectContainers);
}, "html");

// Create <select>
var select = $('<span><select disabled="disabled"></select></span>');
$("<option>").attr("value", "").text("Loading...").appendTo(select.find("select"));

// Populate <select>
that.populateSelects = function(values, selectContainers){
   var span, select, tags;

   for(var i=0, len=selectContainers.length; i<len; i++){
      span = selectContainers[i];

      if($.browser.msie){
         tags = span.innerHTML.match(/^(<select[^>]+>).*(<\/select>)$/i);
         span.innerHTML = tags[1] + values + tags[2];
         select = span.firstChild;
      }else{
         select = span.firstChild;
         select.innerHTML = values;
      }
      $(select).removeAttr("disabled");
   }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-24T20:45:15.717

你真的无能为力。IE 的 javascript 引擎比其他任何引擎都慢得多（事实上，它很烂）。你可以试试IE8。更好……*稍微*……

# asp.net - aspx 页面中的 Silverlight 未加载

> ID：787510
> 
> 赞同：5
> 
> 时间：2009-04-24T20:43:45.393
> 
> 标签：asp.net, silverlight

我开发了一个简单的 Silverlight 控件。我使用 VS 2008 中的 Silverlight 应用程序项目模板创建了这个，向我现有的网站添加了一个测试页面。

现在，我的控件在自动生成的 aspx 中完美运行，现在我已经让它按要求运行了。但是，当我尝试将控件放在新页面中时，它不会加载。调试表明代码正在执行，但是我希望看到的 UI 根本没有出现。

我最初在内容页面中尝试了此操作，使用正确的母版页进行站点布局，然后仅在不使用 MPs 的标准 ASPX 中尝试...同样的问题。

有没有其他人经历过类似的事情？我错过了一些简单的东西！？

如此令人沮丧，任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T06:00:27.503

您可以使用 Firebug 或 Internet Explorer 的开发人员工具栏（和 Fiddler）来查看是否正在请求 xap 文件以及呈现的对象标记是否具有正确的大小。如果使用控件检查任何 JavaScript 错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T14:36:48.370

右键单击 Silverlight 控件应该所在的区域，查看是否收到 Silverlight 选项提示。这将告诉您问题是在将 Silverlight 对象加载到页面中，还是在 Silverlight 插件加载之后。

# c# - 如何破译 MSDN 上的 Select 方法文档？

> ID：787512
> 
> 赞同：6
> 
> 时间：2009-04-24T20:44:03.613
> 
> 标签：c#, .net, linq

我正在努力了解 LINQ，并得出结论，搜索数十个示例直到找到一个与我自己在 C# 中的应用程序接近的示例并没有教我如何钓鱼。

所以回到我立即碰壁的文档。

有人可以帮我破译在 msdn [http://msdn.microsoft.com/en-us/library/bb548891.aspx](http://msdn.microsoft.com/en-us/library/bb548891.aspx)上提供的 Enumerable.Select 方法，并作为 Intellisense 的提示给出吗？

**Enumerable.Select(TSource, TResult) 方法 (IEnumerable(TSource>), Func(TSource, TResult))**

如果它有助于参考，这里是用行号分解的同一行：

1.  可枚举.Select
2.  （TSource，TResult）
3.  方法
4.  (IEnumerable(TSource>),
5.  功能
6.  （TSource，TResult））

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-24T21:42:16.047

从您参考的 MSDN 文章中查看 C# 中此方法的定义可能会有所帮助：

```
public static IEnumerable<TResult> Select<TSource, TResult>(
    this IEnumerable<TSource> source,
    Func<TSource, TResult> selector
) 
```

`<`尖括号表示这个`>`泛型方法的类型参数，我们可以通过查看类型参数的作用来开始探索该方法的用途。

我们首先查看泛型方法的名称：

```
Select<TSource, TResult> 
```

这告诉我们调用的方法`Select`处理两种不同的类型：

*   类型`TSource`；和
*   方式`TResult`

我们来看看参数：

1.  第一个参数是`IEnumerable<TSource> source`——一个源，提供一个`TSource`枚举。
2.  第二个参数是`Func<TSource, TResult> selector`- 一个选择器函数，它接受 a`TSource`并将其转换为 a `TResult`。（这可以通过探索 的定义来验证`Func`）

然后我们看它的返回值：

```
IEnumerable<TResult> 
```

我们现在知道这个方法会返回一个`TResult`枚举。

**总而言之**，我们有一个接受枚举的`TSource`函数，以及一个接受单个`TSource`项目并返回`TResult`项目的选择器函数，然后整个选择函数返回一个枚举`TResult`。

**一个例子：**

具体来说，可以说它`TSource`是类型`Person`（代表一个人的类，具有姓名、年龄、性别等），并且`TResult`是类型`String`（代表人名）。我们将给`Select`函数一个`Person`s 列表，以及一个函数，给定 a`Person`将只选择它们的名称。作为调用此`Select`函数的输出，我们将得到一个`String`仅包含人名的 s 列表。

**在旁边：**

原始方法签名的最后一块拼图，在顶部，是`this`第一个参数之前的关键字。这是定义[Extension Methods](http://msdn.microsoft.com/en-us/library/bb383977.aspx)语法的一部分，它本质上意味着您可以直接在枚举上调用 Select 方法，而不是调用静态 Select 方法（传入源枚举和选择器函数），就像如果它有一个`Select`方法（并且只传入一个参数——选择器函数）。

我希望这能让你更清楚？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-24T20:49:42.367

将 Select 视为映射序列的每个元素的方式。因此：

`Enumerable.Select<TSource, TResult>`: Select 方法由它的源和结果类型参数化（你正在映射的东西的类型和你正在映射到的类型）

`IEnumerable<TSource>`：要映射的事物的顺序

`Func<TSource, TResult>`：映射函数，将应用于源序列的每个元素

结果是`IEnumerable<TResult>`，一系列映射结果。

例如，您可以想象（作为一个简单的示例）将整数序列映射到字符串表示：

```
IEnumerable<string> strings = ints.Select(i => i.ToString()); 
```

这里 ints 是`IEnumerable<TSource>`( `IEnumerable<int>`) 并且`i => i.ToString()`是`Func<TSource, TResult>`( `Func<int, string>`)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T20:58:11.550

我认为[C# in Depth](http://www.manning.com/skeet/)的后续章节很好地解释了 LINQ 及其所有含义。此外，本书的其余部分还教授了许多其他非常有用的 C# 知识。

# c# - 将 c# 项目保存为一个文本文件？

> ID：787517
> 
> 赞同：2
> 
> 时间：2009-04-24T20:45:06.620
> 
> 标签：c#, visual-studio

是否可以将整个 C# 解决方案保存在一个文本文件中？我隐约记得有一个工具（VS 插件？）可以做到这一点，但我找不到它。

**警告**：这很可能是重复的，如果是这样，我很乐意删除该帖子，但我无法在 SO 中找到答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T21:26:25.523

我怀疑这是否可能。

解决方案由许多完全不同的文件类型组成，每种文件类型都有自己的格式，用途不同：

*   **解决方案文件**采用旧版（非 XML）文本格式，并通知您的 IDE（通常是 Visual Studio）作为解决方案一部分的所有不同项目，并将其指向与解决方案相关的其他文件，例如测试运行配置设置。
*   **现在的项目文件**是 XML 构建文件，它通知 MSBuild 哪些源文件要构建，以及如何构建。
*   **源文件**包含任意编程语言的代码。
*   **项目的其他文件**也可以有任何其他任意文本或二进制文件。（例如，嵌入的资源图像。）

所以我们至少有四种不同的文件格式：非 XML 文本、XML、纯文本和二进制。

也许您可以将所有这些不同的文件类型组合到一个文件中的唯一方法是使用某种机制从您的单个文件中神奇地提取所有单独的文件，将它们呈现给开发和构建工具，就好像一切正常，然后神奇地将它们重新组合回单个文件。

这大致相当于获取整个解决方案目录并通过 WinZip 运行它以生成单个文件（一个压缩文件，要启动！）尽管可能通过 Visual Studio 插件进行更无缝的集成。

# javascript - Javascript 新对象引用

> ID：787519
> 
> 赞同：4
> 
> 时间：2009-04-24T20:46:01.440
> 
> 标签：javascript

创建对象的新实例而不是指向原始对象的指针的正确语法是什么？这是我的例子：

```
var oItem = { element: null, colIndex: 0 };
var oInputs = { Qty: oItem, Tare: oItem, Rate: oItem, Total: oItem };
for (var oTitle in oInputs) {
    oInputs[oTitle].element = ... 
```

当我`oInputs[oTitle].element`为任何`oTitle`设置值时，它会设置所有值。我知道 javascript 通过引用传递对象，所以我假设这是因为它们都引用同一个对象。我试过这个，但显然是错误的。

```
var oInputs = { Qty: new oItem, Tare: new oItem, Rate: new oItem, Total: new oItem }; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-24T20:47:13.043

请执行下列操作：

```
function OItem() {
  this.colIndex = 0;
}

var oInputs = { Qty: new OItem(), Tare: new OItem(), Rate: new OItem(), Total: new OItem() }; 
```

然后设置你的属性：

```
for (var oTitle in oInputs) {
    oInputs[oTitle].element = ... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T05:40:09.783

这是创建构造函数的另一种方法：

```
function Item(element,colIndex){
   if (this instanceof Item){
       this.element = element || null;
       this.colIndex = colIndex || 0;
   } else {
       return new Item(element,colIndex);
   }
} 
```

现在，您不需要 new 运算符来创建 Item 的新实例。

```
var oInputs = { Qty: Item(), 
                Tare: Item(), 
                Rate: Item(), 
                Total: Item() }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-24T20:53:52.390

```
function oItem() { 
this.element= null; 
this.colIndex= 0; 
}
var oInputs = { Qty: new oItem(), Tare: new oItem(), Rate: new oItem(), Total: new oItem() }; 
```

# windows - 为什么 Cygwin 可以运行 .bat 脚本？

> ID：787522
> 
> 赞同：19
> 
> 时间：2009-04-24T20:47:42.200
> 
> 标签：windows, cygwin, batch-file

当我在 Cygwin 中从 bash 执行 .bat 脚本时，它通过什么机制运行？我知道，如果我运行 .EXE，它将启动，无论 .EXE 是来自 Cygwin 还是来自更传统的环境。我知道当我使用 #! 执行可执行脚本时 一开始，Cygwin 为其运行提供了魔力。

但是为什么 .bat 脚本可以工作？Cygwin 内部是否有一些组件知道 Windows .bat 脚本是什么以及如何处理它？还是在 Windows 下以某种方式不可能执行调用来启动 .EXE 文件，该文件不会自动也适用于 .bat 脚本？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-03-13T18:20:58.077

跑步

```
./test.bat params 
```

from bash 似乎等同于

```
cmd /c test.bat params 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-24T20:58:43.297

我相信 cygwin 中的 bash 将 bat 扩展视为标记为可执行文件（一个 cygwin hit-tip to windows 约定）。因此，它使用相关的解释器（cmd.exe，每个操作系统配置）加载并执行文件，就像它创建一个新的 bash 实例来运行你的 #! 脚本（每个 posix 标准）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-04T20:10:21.343

如果你想像 ShellScript 进程一样分叉一个 *.cmd 文件执行并将他的日志附加到一个文件中：

```
cmd /c test.bat > nohup.out & 
```

享受！

# asp.net-mvc - ASP.NET MVC Ajax.BeginForm 吃掉点击提交按钮的参数。看起来像bug

> ID：787523
> 
> 赞同：2
> 
> 时间：2009-04-24T20:47:44.570
> 
> 标签：asp.net-mvc, ajax

如果您使用带有多个提交按钮的 Ajax.BeginForm()，类似于：

```
// View.aspx
<% using (Ajax.BeginForm("Action", "Controller", 
           new AjaxOptions { UpdateTargetId = "MyControl",  }))
{ %>
    <span id="MyControl">
       <% Html.RenderPartial("MyControl"); %>
    </span>
<% } %>

//MyControl.ascx
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl" %>
<input name="prev" type="submit" value="prev" />
<input name="next" type="submit" value="next" />
//... 
```

一切都很好地提交给控制器，但是请求中没有单击的提交按钮的参数。换句话说，Request["next"] 和 Request["prev"] 始终为空。

我查看了 Microsoft.MvcAjax.js 中的 JavaScript，看起来函数 Sys_Mvc_MvcHelpers$_serializeForm 完全跳过了“提交”类型的输入。

这似乎根本不合逻辑。您还能如何找出单击了哪个按钮？

对我来说它看起来像一个错误。是否有任何逻辑理由跳过这些表单参数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-29T21:58:33.407

***更新：2009*** 年 11 月 21 日我下载了 MVC Release 2 Preview 2 并查看此问题是否已解决。我做了一个快速测试，发现与 MVC Release 2 Preview 1 相似的结果。我认为它还没有修复。

***更新：2009-08-07*** 我下载了 MVC Release 2 Preview 1 并查看此问题是否已解决。我在脚本 MicrosoftMvcAjax.debug.js 中看到了一个名为**_serializeSubmitButton**的新函数，我看到当 Ajax.BeginForm() 呈现输出时有一个 onclick 事件，但是当此事件触发时它会生成错误“Microsoft JScript 运行时错误：'Sys .Mvc.AsyncForm' 为 null 或不是对象”。

简而言之，它看起来像是尝试了修复，但它还没有工作，或者我需要做更多的事情。坏消息是，如果不是后者，那么在修复完成之前，每个人的 Ajax 表单都会被破坏。

***更新：2009-05-07*** 我今天收到来自 Microsoft 的反馈，确认这是一个错误。他们已经记录了这个缺陷，并表示他们希望在未来的版本中修复它。

*作为参考，我将留下我提交给 Microsoft 的调查细节。长篇文章的申请，但也许它对任何试图创造一个工作的人都有用..*

MVC 中的 Ajax 支持存在几个问题。为了说明这一点，请考虑网络上几个示例中说明的模式：

```
//===========
// View.aspx
//===========
<% using (Ajax.BeginForm("Action", "Controller", 
    new AjaxOptions { UpdateTargetId  = "MyControl", HttpMethod = "POST"}))
{ %>
    <span id="MyControl">
       <% Html.RenderPartial("MyControl"); %>
    </span>
<% } %>

//================
// MyControl.ascx
//================
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl" %>
<input name="startIndex" type="hidden" value="0" />
<%= Ajax.ActionLink("Prev", "PrevAction",
    new AjaxOptions() { UpdateTargetId="MyControl", HttpMethod="POST"}) %>
<%= Ajax.ActionLink("Next", "NextAction", 
    new AjaxOptions() { UpdateTargetId="MyControl", HttpMethod="POST"}) %>
//... 
```

**预期：**
*它只是一个列表，用户可以在不更新整个页面的情况下向前和向后翻页。*

鉴于此设置。我希望有 2 个链接标记为“上一个”和“下一个”。单击“Prev”应该会触发控制器中的 PrevAction 方法作为帖子，并且名为“startIndex”的隐藏字段中的值应该在请求参数中可用。单击 Next 链接时，我希望得到类似的结果。

**实际：**
实际情况是请求对象不包含任何表单参数，即使它显示它是作为 POST 进来的。

为了使用操作链接获取任何参数，必须通过包含参数的 ActionLink 变体显式提供它们。使用此参数时，参数将成为链接 URL 的一部分，这违背了 POST 的目的。

**那么为什么javascript是错误的呢？**
我深入研究了用于处理提交问题的示例的 javascript 代码，现在我更好地理解了为什么它不能处理它。原因似乎与他们连接事件的方式以及我认为 Internet Explorer 的一个缺点有关。

它当前的工作方式是 Ajax.BeginForm() 帮助程序类生成一个带有***onsubmit()***函数的表单标记来拦截表单提交事件。当用户单击提交按钮时，***onsubmit()***函数将触发并接收参数，其中之一是事件。

MicrosoftMvcAjax 脚本查看事件，捆绑应该提交的表单属性并将请求发送到服务器。问题是，根据 WC3 标准，只有*成功*的控件应该被发布。在提交按钮的情况下，这是实际单击的按钮。在 Internet Explorer 下，无法确定是哪个按钮实际触发了提交事件，因此脚本只会跳过所有提交按钮。

*（在 Firefox 中，该事件包含一个名为“explictOriginalTarget”的属性，该属性指向实际上首先导致该事件的按钮）*

**解决方法是什么？**
微软应该修复它。但是，如果我们需要更快的东西，我相信唯一的选择是破解 MicrosoftMvcAjax 脚本以不同的方式连接事件。我发现可以将表单连接到处理 mousedown 事件，其中单击的按钮可以保存在全局变量中，其中 onsubmit 处理程序可以将其插入到 post 参数中。

这是我正在测试的一些代码来说明这种技术。我已经确认它适用于 IE8 和 FireFox，但我还没有尝试将它破解到 MVC Ajax 脚本中......如果我有更多时间。我可以在这里发布结果。

```
 <script type="text/javascript">
     var _clicked = "";
     function onSubmit(e) {
       var targ;
       if (!e) var e = window.event;
       if (e.target) targ = e.target;
       else if (e.srcElement) targ = e.srcElement;
       if (targ.nodeType == 3) //defeat Safari bug
           targ = targ.parentNode;
       alert("OnSubmit:" + _clicked + " was clicked.");
       return false;
     }
     function Click(e) {
       var targ;
       if (!e) var e = window.event;
       if (e.target) targ = e.target;
       else if (e.srcElement) targ = e.srcElement;
       if (targ.nodeType == 3) //defeat Safari bug
           targ = targ.parentNode;
       _clicked = targ.name;
       return true;
   } 
```

```
   <form action="/Home/StandardForm" method="post"
    onsubmit="onSubmit(event)" onmousedown="Click(event)">
      <input type="submit" name="StdPrev" value="StdPrev" />
      <input type="submit" name="StdNext" value="StdNext" />
   </form>

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-26T04:44:02.780

为了使您的提交按钮成为符合规范的“成功”控件，它们必须在表单元素中定义：

[http://www.w3.org/TR/html401/interact/forms.html#successful-controls](http://www.w3.org/TR/html401/interact/forms.html#successful-controls)

如果您不能在表单中嵌套提交按钮，您可能需要使用 javascript（或 jquery）来提交您的表单并传递一个额外的参数来指示单击了哪个按钮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-10-09T04:24:20.167

我想这已经在 MVC 2 中修复（或者它从未被破坏）。只需确保您的 HTML 标记有效。以下示例应显示它有效。

**投票.aspx：**

```
<%@ Page Language="C#" Inherits="System.Web.Mvc.ViewPage" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >
<head runat="server">
    <title>Vote</title>
</head>
<body>

<%using (Ajax.BeginForm("Vote", "Voting", new AjaxOptions { UpdateTargetId = "message" }))
  { %>
    <%= Html.Hidden("itemId", "1")%>
    <p>I love ASP.NET MVC!</p>

    <input type="submit" name="voteValue" value="+" />
    <input type="submit" name="voteValue" value="-" />
<%} %>

<p id="message"><%= TempData["message"] %></p>

<script type="text/javascript" src="<%= Url.Content("~/Scripts/MicrosoftAjax.js")%>"></script>
<script type="text/javascript" src="<%= Url.Content("~/Scripts/MicrosoftMvcAjax.js")%>"></script>

</body>
</html> 
```

**投票控制器.aspx：**

```
using System.Web.Mvc;

namespace Examples.FormWithMultipleSubmitButtons.Controllers
{
    public class VotingController : Controller
    {
        public ViewResult Vote()
        {
            return View();
        }

        [HttpPost]
        public ActionResult Vote(int itemId, string voteValue)
        {
            switch(voteValue)
            {
                case "+":
                    TempData["message"] = "You voted up.";
                    break;
                case "-":
                    TempData["message"] = "You voted down.";
                    break;
                default:
                    TempData["message"] = "Your vote was not recognized.";
                    break;
            }

            if(Request.IsAjaxRequest())
            {
                return Content(TempData["message"].ToString());
            }
            else
            {
                return View();
            }
        }
    }
} 
```

我今天（2010 年 10 月 8 日）遇到了同样的问题，我的表单带有多个提交按钮。HTML 未验证。我把它清理干净了。它仍然没有验证（但比原来的错误更少），现在提交了单击按钮的值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-19T19:08:44.103

一种可能的解决方法是让每个按钮以单独的形式路由到控制器上的不同操作。不理想但可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-30T22:19:09.920

我做了以下事情：

```
 <input id="btnSubmit" name="btnSubmit" type="hidden" value="" />
            <input type="submit" name="btnSubmit" value="Delete" id = "btnDelete"  onclick="$('#btnSubmit').attr('value','Delete');"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <input type="submit" name="btnSubmit" value="Save New" id = "btnSaveNew"  onclick="$('#btnSubmit').attr('value','Save New');"/>
            <input type="submit" name="btnSubmit" value="Save" id = "btnSave" onclick="$('#btnSubmit').attr('value','Save');"/> 
```

即定义了一个隐藏的输入类型，其 id 为“btnSubmit”，并在每个按钮上添加了 onclick 事件为 onclick="$('#btnSubmit').attr('value','Delete');"。这似乎可行，因为我能够获得在控制器中单击的按钮的值：

公共 ActionResult SaveCreateBlot(string btnSubmit) {

}

# c# - C# 和接口 - 显式与隐式

> ID：787525
> 
> 赞同：10
> 
> 时间：2009-04-24T20:48:04.727
> 
> 标签：c#, .net, interface, casting, duck-typing

在 C# 中，如果一个类*具有接口的所有正确方法/签名*，但**没有**像这样显式实现它：

```
class foo : IDoo {} 
```

该类仍然可以转换为该接口吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-04-24T21:11:49.210

**鸭打字**

您所指的是“[鸭式打字](http://en.wikipedia.org/wiki/Duck_Typing)”（以“如果它看起来像鸭子，并且像鸭子一样嘎嘎，那么它一定是鸭子”的成语命名）。

使用鸭子类型，一旦您实现了相关成员（正如您所描述的那样），接口实现就是隐式的，但是.NET 目前对此没有任何广泛的支持。

有了为未来计划的新兴动态语言功能，如果在不久的将来运行时本机支持它，我不会感到惊讶。

同时，您可以通过反射合成鸭子类型，使用[这样的库](http://www.deftflux.net/blog/page/Duck-Typing-Project.aspx)，这将允许您执行如下所示的鸭子类型转换：`IDoo myDoo = DuckTyping.Cast<IDoo>(myFoo)`

**一些琐事**

有趣的是，今天在 C# 中使用鸭子类型的一个小地方 -`foreach`运算符。Krzysztof Cwalina[指出](http://blogs.msdn.com/kcwalina/archive/2007/07/18/DuckNotation.aspx)，为了被`foreach`运算符枚举，一个类必须：

> 提供一个不带参数并返回具有两个成员的类型的公共方法 GetEnumerator：a) 不带参数并返回 Boolean 的方法 MoveMext，以及 b) 具有返回 Object 的 getter 的属性 Current。

请注意，他没有提到`IEnumerable`nor `IEnumerator`。尽管在创建可枚举类时实现这些接口很常见，但如果您要删除接口但离开实现，您的类仍然可以通过`foreach`. 瞧！鸭打字！（[示例代码在这里](http://www.danielfortunov.com/software/%24daniel_fortunovs_adventures_in_software_development/2009/07/28/duck_typing)。）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-04-24T20:48:48.873

不，它不像 Objective-C 和其他一些语言。您应该显式声明接口实现。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-24T20:50:48.107

如果 IDoo 有任何成员，则此代码将无法编译。如果 IDoo 没有成员，那么是的，演员表是安全的（但显然用途有限）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-24T21:06:38.833

这基本上需要 Duck Typing 在 C# 中工作，这不会自动发生。

不过，有一些[库](http://www.deftflux.net/blog/post/Duck-Typing-version-0927-released.aspx)可以做到这一点。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-24T20:54:58.050

```
public class A
{
   public void DoSomething();
}

public interface IDoSomething
{
   void DoSomething();
}

public class B : A, IDoSomething
{ } 
```

B 通过从 A 继承满足 IDoSomething.DoSomething

# mdx - MDX - TopCount 加上“其他”或“其余”

> ID：787532
> 
> 赞同：2
> 
> 时间：2009-04-24T20:50:24.940
> 
> 标签：mdx, performancepoint

我创建了一个 MDX 查询，它计算 TOP 10 ZipCodes（根据我的 Patient Stay 衡量标准），如下所示：

```
WITH
MEMBER [Discharge Date].[Y-M-D].[ Aggregation] AS 'AGGREGATE( EXISTING { [Current Month] } )', SOLVE_ORDER = 0

SELECT
NON EMPTY { [Measures].[Patient Stays] }
ON COLUMNS,

TOPCOUNT({ ORDER( HIERARCHIZE( { [Patient].[ByZipcode].[All].CHILDREN } ), ( [Measures].[Patient Stays] ), BDESC ) }, 10)
ON ROWS

FROM [Patient Stay]

WHERE ( [Discharge Date].[Y-M-D].[ Aggregation], [Facility].[ByAffiliation].CURRENTMEMBER, [Facility].[ByRegion].CURRENTMEMBER ) 
```

此查询用于填充 PerformancePoint 100% 堆积条形图。客户要求，由于这是一个基于 !00% 的图表，我们将其余的邮政编码归为一个“其他”字段，这样应该有 11 个值：前 10 个对应一个，第 11 个对应一个是剩余邮政编码的总和。

我是 MDX 的新手，但这听起来应该是不可能的。有没有人有任何想法或建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T03:27:21.210

我会尽力使用未经测试的代码，所以这里是：

```
WITH
MEMBER [Discharge Date].[Y-M-D].[ Aggregation] AS 'AGGREGATE( EXISTING { [Current Month] } )', SOLVE_ORDER = 0

SET [Top10ZipCodes] AS 
    (TOPCOUNT({ ORDER( HIERARCHIZE( { [Patient].[ByZipcode].[All].CHILDREN } ), ( [Measures].[Patient Stays] ), BDESC ) }, 10))

MEMBER [Patient].[ByZipCode].[OtherZipCodes] AS 
    (AGGREGATE({EXCEPT([Patient].[ByZipCode].Members, [Patient].[ByZipCode].[Top10ZipCodes])}))

SELECT
NON EMPTY { [Measures].[Patient Stays] }
ON COLUMNS,

{[Top10ZipCodes], [Patient].[ByZipCode].[OtherZipCodes]}
ON ROWS

FROM [Patient Stay]

WHERE ( [Discharge Date].[Y-M-D].[ Aggregation], [Facility].[ByAffiliation].CURRENTMEMBER, [Facility].[ByRegion].CURRENTMEMBER ) 
```

这样做是创建一组您的前 10 个邮政编码，然后聚合（不同于总和！！！）所有邮政编码，但前 10 个邮政编码除外。

此外，如果这是一个常见的集合（前 10 个邮政编码），您可能希望在多维数据集上创建一个集合，您可以在其中重复使用它，而不必更改您拥有的每个 MDX 查询。

干杯，
埃里克

# c++ - #pragma once 是安全的包含守卫吗？

> ID：787533
> 
> 赞同：375
> 
> 时间：2009-04-24T20:50:35.157
> 
> 标签：c++, include-guards

我读过在使用时有一些编译器优化`#pragma once`可以加快编译速度。我认识到这是非标准的，因此可能会造成跨平台兼容性问题。

这是大多数现代编译器在非 Windows 平台 (gcc) 上支持的东西吗？

我想避免平台编译问题，但也想避免后备守卫的额外工作：

```
#pragma once
#ifndef HEADER_H
#define HEADER_H

...

#endif // HEADER_H 
```

我应该担心吗？我是否应该为此花费更多的精力？

* * *

## 回答 #1

> 赞同：360
> 
> 时间：2009-12-22T14:35:00.907

`#pragma once`确实有一个缺点（除了非标准），那就是如果你在不同的位置有相同的文件（我们有这个是因为我们的构建系统复制文件），那么编译器会认为这些是不同的文件。

* * *

## 回答 #2

> 赞同：237
> 
> 时间：2009-04-24T20:52:49.723

使用`#pragma once`应该适用于任何现代编译器，但我看不出有任何理由不使用标准`#ifndef`包含防护。它工作得很好。[需要注意的是 GCC 在3.4 版本](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=11569)`#pragma once`之前不支持。

我还发现，至少在 GCC 上，[它可以识别标准`#ifndef`include guard 并对其进行优化](http://gcc.gnu.org/onlinedocs/gcc-2.95.3/cpp_1.html#SEC8)，因此它不应该比`#pragma once`.

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2009-04-24T20:59:35.387

我希望`#pragma once`（或类似的东西）在标准中。包括警卫并不是什么大问题（但它们似乎确实有点难以向学习语言的人解释），但这似乎是一个可以避免的小烦恼。

事实上，由于 99.98% 的情况下，行为是期望的行为，如果防止头文件的多次包含由编译器自动处理，使用 a或其他东西来允许双重包含`#pragma once`，那就太好了。`#pragma`

但是我们有我们所拥有的（除了你可能没有`#pragma once`）。

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2009-04-24T20:52:46.150

我不知道任何性能优势，但它确实有效。我在所有 C++ 项目中都使用它（当然我使用的是 MS 编译器）。我发现它比使用更有效

```
#ifndef HEADERNAME_H
#define HEADERNAME_H
...
#endif 
```

它做同样的工作并且不会用额外的宏填充预处理器。

GCC[从 3.4 版开始](http://en.wikipedia.org/wiki/Pragma_once)`#pragma once`正式支持。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2013-08-28T12:41:19.250

GCC`#pragma once`自 3.4 起支持，请参阅[http://en.wikipedia.org/wiki/Pragma_once](http://en.wikipedia.org/wiki/Pragma_once)以获得更多编译器支持。

我看到使用而不是包含守卫的最大好处`#pragma once`是避免复制/粘贴错误。

让我们面对现实吧：我们大多数人几乎不会从头开始一个新的头文件，而只是复制一个现有的头文件并根据我们的需要对其进行修改。`#pragma once`使用而不是包含防护来创建工作模板要容易得多。我修改模板的次数越少，出错的可能性就越小。在不同的文件中使用相同的包含保护会导致奇怪的编译器错误，并且需要一些时间才能找出问题所在。

TL；DR：`#pragma once`更容易使用。

* * *

## 回答 #6

> 赞同：12
> 
> 时间：2009-04-25T13:32:36.013

我使用它并且对它很满意，因为我需要输入更少的内容来创建一个新的标题。它在三个平台上运行良好：Windows、Mac 和 Linux。

我没有任何性能信息，但我相信与解析 C++ 语法的速度相比，#pragma 和 include 防护之间的区别将毫无意义。这才是真正的问题。例如，尝试使用 C# 编译器编译相同数量的文件和行，以查看差异。

最后，使用警卫或pragma，根本不重要。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2009-04-24T20:54:07.973

使用 ' `#pragma once`' 可能没有任何效果（并非所有地方都支持它 - 尽管它越来越广泛地支持），所以无论如何您都需要使用条件编译代码，在这种情况下，为什么还要使用 ' `#pragma once`'？编译器可能无论如何都会对其进行优化。不过，它确实取决于您的目标平台。如果你所有的目标都支持它，那么继续使用它——但这应该是一个有意识的决定，因为如果你只使用 pragma 然后移植到不支持它的编译器，所有的地狱都会崩溃。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-04-24T21:04:31.287

性能优势在于一旦读取 #pragma once 就不必重新打开文件。使用警卫，编译器必须打开文件（这可能会花费大量时间）以获取不应再次包含其内容的信息。

这只是理论，因为某些编译器不会为每个编译单元自动打开没有任何读取代码的文件。

无论如何，并非所有编译器都是如此，因此理想情况下，跨平台代码必须避免使用 #pragma once，因为它根本不是标准的/没有标准化的定义和效果。但是，实际上，它确实比警卫好。

最后，在这种情况下，无需检查每个编译器的行为即可确保从编译器获得最佳速度的[更好建议是同时使用 pragma once 和警卫。](http://en.wikipedia.org/wiki/Pragma_once)

```
#ifndef NR_TEST_H
#define NR_TEST_H
#pragma once

#include "Thing.h"

namespace MyApp
{
 // ...
}

#endif 
```

这样您就可以充分利用两者（跨平台和帮助编译速度）。

由于打字时间较长，我个人使用一种工具来帮助以非常棒的方式生成所有这些内容（Visual Assist X）。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-04-11T13:36:58.940

不总是。

[http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52566](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52566)有一个很好的例子，两个文件都被包含在内，但由于时间戳和内容相同（文件名不同）而被错误地认为是相同的.

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-04-25T01:56:24.160

在非常大的树上使用 gcc 3.4 和 4.1（有时使用[distcc](http://distcc.samba.org/)），我还没有看到使用 #pragma 代替标准包含防护或与标准包含防护结合使用时有任何加速。

我真的看不出它有多么值得混淆旧版本的 gcc，甚至其他编译器，因为没有真正的节省。我还没有尝试过所有的各种 delinter，但我敢打赌这会让他们中的许多人感到困惑。

我也希望它早日被采用，但我可以看到这样的论点“当 ifndef 工作得非常好时，为什么我们需要它？”。鉴于 C 的许多黑暗角落和复杂性，包含守卫是最简单、自我解释的事情之一。如果您对预处理器的工作原理有一点了解，它们应该是不言自明的。

但是，如果您确实观察到显着加速，请更新您的问题。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-03-04T04:39:26.133

今天，老式的包括警卫和#pragma once 一样快。即使编译器没有特别对待它们，它仍然会在看到 #ifndef WHATEVER 和 WHATEVER 被定义时停止。今天打开文件非常便宜。即使有改进，也将是毫秒级的。

我只是不使用#pragma 一次，因为它没有任何好处。为避免与其他包含守卫发生冲突，我使用如下内容： CI_APP_MODULE_FILE_H --> CI = Company Initials; APP = 应用程序名称；其余的不言自明。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-12-17T12:52:52.437

主要区别在于编译器必须打开头文件才能读取包含保护。相比之下，pragma once 会导致编译器跟踪文件，并且在遇到同一文件的另一个包含时不执行任何文件 IO。虽然这听起来可以忽略不计，但它可以轻松扩展大型项目，尤其是那些没有良好标题的项目包括学科。

也就是说，现在的编译器（包括 GCC）足够聪明，可以处理一次像 pragma 这样的守卫。即他们不打开文件并避免文件IO惩罚。

在不支持编译指示的编译器中，我看到手动实现有点麻烦..

```
#ifdef FOO_H
#include "foo.h"
#endif 
```

我个人喜欢#pragma once 方法，因为它避免了命名冲突和潜在的拼写错误的麻烦。相比之下，它也是更优雅的代码。也就是说，对于可移植代码，除非编译器抱怨它，否则两者都应该没有什么坏处。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2013-09-14T12:39:08.413

如果我们使用 msvc 或 Qt（最高 Qt 4.5），由于 GCC（最高 3.4）、msvc 都支持`#pragma once`，我看不出没有不使用的理由`#pragma once`。

源文件名通常与类名相同，而且我们知道，有时我们需要*重构*，重命名类名，然后我们也不得不更改`#include XXXX`，所以我认为手动维护`#include xxxxx`不是一个聪明的工作。即使使用 Visual Assist X 扩展，维护“xxxx”也不是必要的工作。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-06-14T06:40:16.947

对那些认为总是需要自动一次性包含头文件的人的补充说明：几十年来，我使用双重或多重包含头文件来构建代码生成器。特别是对于协议库存根的生成，我发现拥有一个非常便携且功能强大的代码生成器非常舒适，无需额外的工具和语言。[正如博客 X-Macros](http://blog.brush.co.nz/2009/08/xmacros/)所示，我不是唯一使用此方案的开发人员。如果没有丢失的自动防护，这将是不可能的。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2021-05-28T20:57:46.027

我使用 #ifndef/#define 包含使用包含这样的*UUID*的符号的保护：

```
#ifndef ARRAY__H_81945CB3_AEBB_471F_AC97_AB6C8B220314
#define ARRAY__H_81945CB3_AEBB_471F_AC97_AB6C8B220314 /* include guard */

#endif 
```

我一直使用能够自动生成 UUID 的编辑器。这可以防止与其他库中具有相同基本名称的文件发生名称冲突，并检测完全相同的文件是否放置在文件系统内的多个位置。

不利的一面是增加了表的大小，因为符号要大得多，但我还没有看到它有问题。

# ruby-on-rails - Rails & SQLite3：日期不匹配

> ID：787542
> 
> 赞同：1
> 
> 时间：2009-04-24T20:53:22.017
> 
> 标签：ruby-on-rails, sqlite

Rails 从我的数据库记录中返回错误的日期。对于我的模型（“目标”），如果我在脚本/控制台中运行：

```
Target.find :all 
```

我从“ **2000-01-01** xx:xx:xx”中获取了所有带有“recorded_on”字段读取日期的记录。

如果我使用相同的数据库并在 sqlite3 控制台中运行：

```
SELECT * FROM targets; 
```

我从“ **2009-04-22** xx:xx:xx”中获取了“recorded_on”字段读取日期的所有记录，这是正确的日期。

两者之间的时间值似乎是正确的，只有日期值是关闭的。

这是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-24T22:01:13.723

rails 和您的数据库之间的可靠时间转换取决于[我没有耐心解决](https://stackoverflow.com/questions/319711/ruby-on-rails-and-active-record-standalone-scripts-disagree-on-database-values-fo)的许多 rails 和数据库配置巫术。

我的最终解决方案是停止将时间值作为时间存储在数据库中。我存储整数：

```
Modelname.time_column = Time.now().to_i 
```

（实际上，我在覆盖属性的 setter 中执行了 to_i 位，并在 getter 中反转了该过程：）

```
Time.at(read_attribute(:time_column)) 
```

这是一个 hack，但我对它的简单性以及在配置和开发机器之间移动它的简单程度感到满意。

缺点当然是，当你查询它时，sql 会给你一个老式的 int。MySQL 可能有转换的方法，但我怀疑 SQLite 会。

# html - ie8中的弹出窗口闪烁

> ID：787543
> 
> 赞同：0
> 
> 时间：2009-04-24T20:53:22.093
> 
> 标签：html, internet-explorer-8, popup, border

我们在 IE8 中发现了弹出窗口的奇怪行为。在 IE7 和 IE6 中，我们的弹出窗口如下所示：
[alt text http://img145.imageshack.us/img145/2318/normall.gif](http://img145.imageshack.us/img145/2318/normall.gif)
但在 IE8 中，它有奇怪的边框，“闪烁”了 5-6 次，看起来像这样：
[alt text http://img16.imageshack.us/img16/4677/bugo.gif](http://img16.imageshack.us/img16/4677/bugo.gif)
用于显示此弹出窗口的代码：

```
Browser.prototype.showPopup = function(someHtml) {

  ...

  var popup = doc.parentWindow.createPopup();

  for(var n = 0; n < doc.styleSheets.length; n++) {
    popup.document.createStyleSheet(document.styleSheets[n].href);
  }

  popup.document.body.innerHTML = "<div style=\"width:100%;height:100%;overflow:auto\">" + someHtml + "</div>";

  popup.document.parentWindow.Form = Form;
  popup.document.attachEvent("onselectstart", IEOnSelectStart);
  popup.document.attachEvent("oncontextmenu", IEOnContextMenu);

  ...

  popup.show(x, y, width, height, ctl);
  doc.popup = popup;
} 
```

我研究的内容：
1\. 我曾尝试订阅 onpropertychanged 事件。但它不会在边框更改时触发，而如果我尝试从代码中更改此属性，它会正常工作。
2\. 我写了一个简单的观察器，它每 100 毫秒查询一次弹出窗口并转储它的属性。这就是我发现有人将 body.style.borderStyle 设置为“inset”并在几秒钟后设置为开始（不是 styleName）的方式。
3\. 审查了所有的 JavaScript 代码，没有发现任何关于 inset 或 outset 值的引用。我有 99% 的把握，这不是我们的代码更改了边界。也许这是某种 IE 安全策略作为对我们某些行为的反应。
任何想法——什么会导致 IE8 中弹出边框的这种变化？

PS 另外，我无法在我们的环境之外重现此问题。
受信任区域中的 PPS 站点
PPPS IE 模式是怪癖 PPPPS 同一页面上的某些弹出窗口工作正常，但我找不到它们之间可能导致这种行为的区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-28T11:09:19.500

我已经重现了这段代码的问题：

```
<script type="text/javascript" >
    document.showInnerPopup = function(){
        alert("Inner popup");
    }

    function btnOnClick(){
        var popup = document.parentWindow.createPopup();
        popup.document.body.innerHTML = "<div style=\"border: 1px solid red;width: 100%; height:100%\" id=\"popupDiv\" onclick=\"javascript:document.showInnerPopup(this,event)\">Click to show another popup</div>";
        popup.document.showInnerPopup = function(obj, evt) {
            var doc = evt.srcElement.ownerDocument;

            var popup = doc.parentWindow.createPopup();
            popup.document.body.innerHTML = "<div style=\"border: 1px solid green;width: 100%; height:100%\">Nested popup</div>"
            popup.show(10, -20, 150, 150, doc.body);
        }

        popup.show(10, -20, 100, 100, document.getElementById("btn"));
        document.btn = document.getElementById("btn");
        document.popup = popup;
    }
</script>
<input type="button" value="Show Popup" onclick="btnOnClick()" id="btn" /> 
```

这种行为是因为 IE 设置“允许脚本启动的窗口没有大小或位置限制”，默认情况下即使对于受信任的区域也有值“禁用”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-28T11:15:39.123

也许 IE 开发团队已经决定变得优秀，让那些想要使用弹出窗口的人过得艰难 :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T19:10:08.617

每当我在 IE8 中使用 Google 并将鼠标放在搜索输入字段上时，我都会出现一种闪烁，这会阻止我输入，直到我将鼠标移开。但我的原因是 Tweakui 的“激活跟随鼠标”X-Mouse 功能。然而，关闭该功能并将鼠标悬停在搜索上时，仍然有一个“谷歌搜索”会闪烁。

这就是我避免使用 IE 的原因。还是那么坑。我不在乎 Tweakui 是否不受 MS 支持。为什么 MS 不完全重写 IE？

# sockets - 如何使用 std.socket 和 std.socketstream？（D 编程语言 2.x）

> ID：787548
> 
> 赞同：5
> 
> 时间：2009-04-24T20:55:50.013
> 
> 标签：sockets, networking, d

我想知道如何使用那些火卫一模块来使用网络？

或者您可以参考如何使用套接字（以类似于或几乎类似于D的方式）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T22:40:19.683

从记忆里

```
auto MyStream = new SocketStream(new Socket(new TcpAddress("stakoverflow.com", 80))); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T21:38:51.547

std.socket.Socket 本质上是围绕操作系统的本机套接字函数的半薄包装器。出于这个原因，我建议首先了解 C 中套接字编程的基础知识——有很多例子——然后，std.socket API 应该是微不足道的。

供参考：[http ://digitalmars.com/d/2.0/phobos/std_socket.html](http://digitalmars.com/d/2.0/phobos/std_socket.html)

# c# - 在 C# 中使用 Schematron/XSD 进行 XML 验证

> ID：787554
> 
> 赞同：11
> 
> 时间：2009-04-24T20:57:45.327
> 
> 标签：c#, .net, xml, xsd, schematron

我一直在寻找一种方法来对 XML 文档进行一些更高级的业务规则验证。到目前为止，Schematron 似乎能够做到，我需要什么。

我一直在环顾四周，我发现的几个库很旧，似乎不再受支持。Schematron 在 2002 年只是“热”吗？是否有任何库可以在 C# 中进行验证 - 或者我该怎么做？

或者是否还有其他可以进行高级验证并拥有 C# 库并进行标准化的？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-24T21:24:35.670

对于它的价值，这是我的经验......

我曾有过希望架构可以在业务规则验证方面做得更多的时候。但是，根据我的经验，有一个模式来定义数据协定（格式、类型等）……而**不是**强制执行业务规则。试图让它变得更多会遇到各种各样的问题，这可能就是为什么 Schematron 的受欢迎程度似乎已经下降（可能是我无法备份的错误假设）。

为了解决这个问题，通常可以采用两遍方法：

*   使用模式验证验证 xml 结构/数据类型等。
*   对 xml 应用业务规则检查（在普通的 c# 代码中）。

我了解您是否想要采用一体化的验证方法，但从长远来看，尝试为此使用模式会导致更多的麻烦。最后，您将通过隔离代码来更好地控制业务规则检查。

# php - 获取所有新闻和所有评论

> ID：787561
> 
> 赞同：0
> 
> 时间：2009-04-24T21:00:24.400
> 
> 标签：php, sql, mysql

我正在尝试编写一个查询来获取所有新闻和每个新闻的所有评论。我目前的查询是：

```
SELECT n.*,
       c.* AS comments
  FROM news n
       JOIN comments c ON (c.news_id = n.id) 
```

但是，当我将查询作为数组获取时，它通过评论给了我一个键，我想通过新闻和子数组中的所有评论获得一个键。

就像是：

```
Array
(
    [0] => Array
    (
        [id] => 1 // news' id
        ...       // rest of news' data
        [comments] = Array
        (
            [id] => 1 // comment's id
            ...       // rest of comments' data
        )
    ),
    ... // all other news
) 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T21:04:21.443

我假设它返回的是单个记录而不是数据结构。您将需要自己将这些记录分组到数据结构中。如果可能的话，我会保留一些示例代码，但这不能直接通过 SQL 完成。（因为您也没有直接从数据库中取回 PHP）

你在使用任何类型的 ORM 吗？您不妨考虑查看：

*   [Rocks](http://en.wikipedia.org/wiki/Rocks_(PHP))，用于 PHP 5.1 的开源 ORM 以及免费软件 (GNU LGPL)
*   [Doctrine](http://en.wikipedia.org/wiki/Doctrine_(PHP))，PHP 5.2.3 的开源 ORM，免费软件 (GNU LGPL)
*   [适用于 PHP 5 的Propel](http://en.wikipedia.org/wiki/Propel_(PHP))、ORM 和 Query-Toolkit，灵感来自 Apache Torque，免费软件 (GNU LGPL)
*   [EZPDO](http://www.ezpdo.net/)，适用于 PHP 5.0.4 或更新版本的开源 ORM，免费软件 (BSD)
*   [DABL](http://manifestwebdesign.com/developer-resources/database-abstraction-layer/)，数据库类创建者和查询生成器，受 Propel 启发但更易于安装，免费软件
*   [Data Shuffler](http://datashuffler.org/)数据映射器实现（新 BSD）
*   [适用于 PHP 5.1.6 或更高版本的Outlet](http://www.outlet-orm.org/site/)开源 ORM（测试版），使用类似于 Hibernate（新 BSD）的方法
*   [Coughphp](http://coughphp.com/) PHP5 的开源 ORM，使用代码生成（应该可以连接其他数据库驱动程序，但开箱即用只包括 MySQL 支持[。1](http://en.wikipedia.org/wiki/Rocks_(PHP))）（FreeBSD）

[http://en.wikipedia.org/wiki/List_of_object-relational_mapping_software#PHP](http://en.wikipedia.org/wiki/List_of_object-relational_mapping_software#PHP)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T21:05:14.373

您不能在一个查询中做到这一点 - 最好采用您所获得的查询并对结果答案进行后处理以获得您需要的数据结构。

进一步详细说明 - 任何 SQL 查询都只能返回一个二维数据数组 - 一维用于列，一维用于匹配行。在您的情况下，您实际上所追求的更像是一个三维表。

另请注意，在您编写的查询中，将`news`针对每篇文章的每条评论一遍又一遍地返回所有数据。这是对数据库服务器带宽和资源的低效使用。

这样做可能更有效（在伪代码中）：

```
SELECT * FROM news
...
foreach ($rows as $row) {
  $row['comments] = array();
  $news[$row['id']] = $row;
}

SELECT * FROM comments
...
foreach ($rows as $row) {
  $news[$row['news_id']]['comments'][] = $row;
} 
```

第一个查询获取所有新闻文章并将它们放入一个数组中。第二个查询获取评论，并在每篇新闻文章的结构中累积一个单独的数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T05:18:03.410

您可以使用内部联接在单个查询中获取结果。

假设您的数据库结构如下：

tab_news : news_id, 新闻

tab_cmt : cmt_id, news_id, cmt

现在编写如下查询：

select n.news, c.cmt from tab_news n inner join tab_cmt c on (c.news_id=n.news_id)

# python - 如何在 Python 中的日期时间值上添加秒数？

> ID：787564
> 
> 赞同：30
> 
> 时间：2009-04-24T21:01:16.037
> 
> 标签：python

我尝试修改第二个属性，但没有奏效。

基本上我想做：

```
datetime.now().second += 3 
```

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-04-24T21:06:58.957

你检查过timedeltas吗？

```
from datetime import datetime, timedelta
x = datetime.now() + timedelta(seconds=3)
x += timedelta(seconds=3) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T21:13:24.043

您不能将秒数添加到日期时间对象。从[文档](http://pypi.python.org/pypi/DateTime)：

> DateTime 对象应该被认为是不可变的；所有转换和数值操作都返回一个新的 DateTime 对象，而不是修改当前对象。

您必须创建另一个 datetime 对象，或使用现有对象和 timedelta 的乘积。

# flash - 创建多语言 ActionScript 3.0 站点

> ID：787567
> 
> 赞同：2
> 
> 时间：2009-04-24T21:01:50.123
> 
> 标签：flash, actionscript-3, actionscript, multilingual

我知道 Flash IDE 中的内置“字符串”面板，但是这是现在创建多语言 AS3 站点/应用程序的最佳方式吗？

是否有任何推荐的第 3 方 API/框架可用？理想情况下，我希望能够即时更改语言并支持尽可能多的字符集，我还将处理静态和动态文本内容。

我也想在不使用 Flex 的情况下实现这一点。

任何建议将不胜感激 - 谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-28T07:43:07.200

我的工作方式是拥有一个包含我所有副本的 xml 文件，我用它来填充 Translation 单例类。然后在每个 ui 类中，我有一个公共 translate() 方法，该方法从 Translation 类中获取适当的内容并显示它。您可以在构造函数中调用 translate() 方法，并且可以随时更改副本。您还可以在 Translation 上收听 CHANGE 事件，并在文本更改时再次调用 translate。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T21:15:21.667

如果您愿意使用 Flex，Flex 3 可以为每个语言环境创建资源包。- 这里有更多信息：[http ://www.herrodius.com/blog/123](http://www.herrodius.com/blog/123)

如果没有，我通常会创建包含所有文本内容和 fonts.swf 的巨大 xml 文件，但我想这与使用字符串面板没有太大区别。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T21:41:13.337

就 actionscript 3 而言，我使用的唯一 3rd 方 API 是[PureMVC](http://puremvc.org/) ，如果您对 Flex 3 持开放态度，您可能还想看看[swiz 框架](http://code.google.com/p/swizframework/)。它使用 IoC 模式，我认为它很像 spring 所以你也许能够注入你的字符集，这将是一些有趣的事情。swiz 框架确实很新，但我没有太多时间来研究它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-28T01:44:42.897

这是一个需要在几段答案中涵盖的广泛主题，因此我将尝试为您指明正确的方向。

FlashExtentions.com 的 Robert Taylor 就这个主题进行了几次会谈。我建议看看他的[Session notes](http://www.flashextensions.com/lecture.php)。确保下载**工作簿摘要 PDF**和**多语言 Flash 应用程序**的**材料 ZIP**。这些将使您对该主题有很好的理解。这些示例在 AS2 中，但我并不认为您的问题是基于语言的，而是一般的软件架构问题。

 **在处理其他语言时，字体是一个相当大的问题，因此请查看 WestBrents 在[这篇文章中的回答](http://www.ultrashock.com/forums/actionscript/multilingual-flash-fonts-question-86610.html)

希望有帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-28T18:01:33.830

我对静态文本使用属性文件（本地化内置 flex），对动态文本使用数据库，一切正常。

我唯一遇到的问题是：

*   将翻译转换为正确的字符编码。我使用 Notepad++ 来做这件事，我发现并丢失了一个更好的批处理工具
*   调整大小 - 毫不奇怪，有些语言比其他语言长很多

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-27T19:06:00.037

splinkresource 可能是您正在寻找的

# java - Windows 上的 IBM Websphere - OutOfMemoryError：无法创建线程

> ID：787578
> 
> 赞同：1
> 
> 时间：2009-04-24T21:05:35.073
> 
> 标签：java, windows, multithreading, websphere, out-of-memory

我有一个在 Windows 操作系统上的 IBM Websphere Application Server 上运行的 J2EE 应用程序。

有时我会在 javacore 文件中看到带有以下信息的 OutOfMemoryError 异常。

```
1TISIGINFO     Dump Event "systhrow" (00040000) Detail "java/lang/OutOfMemoryError":"Failed to create a thread: retVal -1073741830, errno 12" received 
```

Java 使用以下配置运行：-Xms512m -Xmx1350m -Xscmx50M

分析javacore文件，线程数只有124个。分析heap dump，heap占用的内存约500Mb。

鉴于相对正常的线程数和堆大小远低于最大值，我试图弄清楚为什么我会看到这个错误？

我不确定这是否有帮助，但这里是 javacore 文件的顶部...

```
NULL           ------------------------------------------------------------------------
0SECTION       TITLE subcomponent dump routine
NULL           ===============================
1TISIGINFO     Dump Event "systhrow" (00040000) Detail "java/lang/OutOfMemoryError":"Failed to create a thread: retVal -1073741830, errno 12" received 
1TIDATETIME    Date:                 1970/01/01 at 00:00:00
1TIFILENAME    Javacore filename:    d:\WebSphere\AppServer\profiles\AppSrv01\javacore.19700101.000000.652.0003.txt
NULL           ------------------------------------------------------------------------
0SECTION       GPINFO subcomponent dump routine
NULL           ================================
2XHOSLEVEL     OS Level         : Windows Server 2003 5.2 build 3790 Service Pack 2
2XHCPUS        Processors -
3XHCPUARCH       Architecture   : x86
3XHNUMCPUS       How Many       : 2
NULL           
1XHERROR2      Register dump section only produced for SIGSEGV, SIGILL or SIGFPE.
NULL           
NULL           ------------------------------------------------------------------------
0SECTION       ENVINFO subcomponent dump routine
NULL           =================================
1CIJAVAVERSION J2RE 5.0 IBM J9 2.3 Windows Server 2003 x86-32 build j9vmwi3223-20080315
1CIVMVERSION   VM build 20080314_17962_lHdSMr
1CIJITVERSION  JIT enabled - 20080130_0718ifx2_r8
1CIRUNNINGAS   Running as a standalone JVM
1CICMDLINE     d:/WebSphere/AppServer/java/bin/java -Declipse.security -Dwas.status.socket=4434 -Dosgi.install.area=d:/WebSphere/AppServer -Dosgi.configuration.area=d:\WebSphere\AppServer\profiles\AppSrv01/configuration -Dosgi.framework.extensions=com.ibm.cds -Xshareclasses:name=webspherev61,nonFatal -Xscmx50M -Dcom.ibm.nio.DirectByteBuffer.SilentRetry=true -Xbootclasspath/p:d:/WebSphere/AppServer/java/jre/lib/ext/ibmorb.jar;d:/WebSphere/AppServer/java/jre/lib/ext/ibmext.jar -classpath d:\WebSphere\AppServer\profiles\AppSrv01/properties;d:/WebSphere/AppServer/properties;d:/WebSphere/AppServer/lib/startup.jar;d:/WebSphere/AppServer/lib/bootstrap.jar;d:/WebSphere/AppServer/lib/j2ee.jar;d:/WebSphere/AppServer/lib/lmproxy.jar;d:/WebSphere/AppServer/lib/urlprotocols.jar;d:/WebSphere/AppServer/deploytool/itp/batchboot.jar;d:/WebSphere/AppServer/deploytool/itp/batch2.jar;d:/WebSphere/AppServer/java/lib/tools.jar -Dibm.websphere.internalClassAccessMode=allow -Xms512m -Xmx1350m -Dws.ext.dirs=d:/WebSphere/AppServer/java/lib;d:\WebSphere\AppServer\profiles\AppSrv01/classes;d:/WebSphere/AppServer/classes;d:/WebSphere/AppServer/lib;d:/WebSphere/AppServer/installedChannels;d:/WebSphere/AppServer/lib/ext;d:/WebSphere/AppServer/web/help;d:/WebSphere/AppServer/deploytool/itp/plugins/com.ibm.etools.ejbdeploy/runtime -Dderby.system.home=d:/WebSphere/AppServer/derby -Dcom.ibm.itp.location=d:/WebSphere/AppServer/bin -Djava.util.logging.configureByServer=true -Duser.install.root=d:\WebSphere\AppServer\profiles\AppSrv01 -Djavax.management.builder.initial=com.ibm.ws.management.PlatformMBeanServerBuilder -Dwas.install.root=d:/WebSphere/AppServer -Dpython.cachedir=d:\WebSphere\AppServer\profiles\AppSrv01/temp/cachedir -Djava.util.logging.manager=com.ibm.ws.bootstrap.WsLogManager -Dserver.root=d:\WebSphere\AppServer\profiles\AppSrv01 -Dappserver.platform=was61 -Ddeploymentmgr.rmi.connection=ensi-nd01.sistema-cni.org.br:9809 -Dappserver.rmi.host=ensi-nd01.sistema-cni.org.br -Duser.timezone=GMT-3 -Djava.security.auth.login.config=d:\WebSphere\AppServer\profiles\AppSrv01/properties/wsjaas.conf -Djava.security.policy=d:\WebSphere\AppServer\profiles\AppSrv01/properties/server.policy com.ibm.wsspi.bootstrap.WSPreLauncher -nosplash -application com.ibm.ws.bootstrap.WSLauncher com.ibm.ws.runtime.WsServer d:\WebSphere\AppServer\profiles\AppSrv01\config ensi-nd01Cell01 ensi-aplic01Node01 lumis4.0.11
1CIJAVAHOMEDIR Java Home Dir:   d:\WebSphere\AppServer\java\jre
1CIJAVADLLDIR  Java DLL Dir:    d:\WebSphere\AppServer\java\jre\bin
1CISYSCP       Sys Classpath:   d:/WebSphere/AppServer/java/jre/lib/ext/ibmorb.jar;d:/WebSphere/AppServer/java/jre/lib/ext/ibmext.jar;d:\WebSphere\AppServer\java\jre\lib\vm.jar;d:\WebSphere\AppServer\java\jre\lib\core.jar;d:\WebSphere\AppServer\java\jre\lib\charsets.jar;d:\WebSphere\AppServer\java\jre\lib\graphics.jar;d:\WebSphere\AppServer\java\jre\lib\security.jar;d:\WebSphere\AppServer\java\jre\lib\ibmpkcs.jar;d:\WebSphere\AppServer\java\jre\lib\ibmorb.jar;d:\WebSphere\AppServer\java\jre\lib\ibmcfw.jar;d:\WebSphere\AppServer\java\jre\lib\ibmorbapi.jar;d:\WebSphere\AppServer\java\jre\lib\ibmjcefw.jar;d:\WebSphere\AppServer\java\jre\lib\ibmjgssprovider.jar;d:\WebSphere\AppServer\java\jre\lib\ibmjsseprovider2.jar;d:\WebSphere\AppServer\java\jre\lib\ibmjaaslm.jar;d:\WebSphere\AppServer\java\jre\lib\ibmjaasactivelm.jar;d:\WebSphere\AppServer\java\jre\lib\ibmcertpathprovider.jar;d:\WebSphere\AppServer\java\jre\lib\server.jar;d:\WebSphere\AppServer\java\jre\lib\xml.jar;
1CIUSERARGS    UserArgs:
2CIUSERARG               -Xjcl:jclscar_23
2CIUSERARG               -Dcom.ibm.oti.vm.bootstrap.library.path=d:\WebSphere\AppServer\java\jre\bin
2CIUSERARG               -Dsun.boot.library.path=d:\WebSphere\AppServer\java\jre\bin
2CIUSERARG               -Djava.library.path=d:\WebSphere\AppServer\java\jre\bin;.;D:\WebSphere\AppServer\bin;D:\WebSphere\AppServer\java\bin;D:\WebSphere\AppServer\java\jre\bin;D:\programas\oracle\product\10.2.0\client_1\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;c:\Program Files\Intel\DMIX
2CIUSERARG               -Djava.home=d:\WebSphere\AppServer\java\jre
2CIUSERARG               -Djava.ext.dirs=d:\WebSphere\AppServer\java\jre\lib\ext
2CIUSERARG               -Duser.dir=d:\WebSphere\AppServer\profiles\AppSrv01
2CIUSERARG               _j2se_j9=70912 0x7E7A0BE8
2CIUSERARG               -Dconsole.encoding=Cp850
2CIUSERARG               vfprintf 0x00401145
2CIUSERARG               -Declipse.security
2CIUSERARG               -Dwas.status.socket=4434
2CIUSERARG               -Dosgi.install.area=d:/WebSphere/AppServer
2CIUSERARG               -Dosgi.configuration.area=d:\WebSphere\AppServer\profiles\AppSrv01/configuration
2CIUSERARG               -Dosgi.framework.extensions=com.ibm.cds
2CIUSERARG               -Xshareclasses:name=webspherev61,nonFatal
2CIUSERARG               -Xscmx50M
2CIUSERARG               -Dcom.ibm.nio.DirectByteBuffer.SilentRetry=true
2CIUSERARG               -Xbootclasspath/p:d:/WebSphere/AppServer/java/jre/lib/ext/ibmorb.jar;d:/WebSphere/AppServer/java/jre/lib/ext/ibmext.jar
2CIUSERARG               -Dibm.websphere.internalClassAccessMode=allow
2CIUSERARG               -Xms512m
2CIUSERARG               -Xmx1350m
2CIUSERARG               -Dws.ext.dirs=d:/WebSphere/AppServer/java/lib;d:\WebSphere\AppServer\profiles\AppSrv01/classes;d:/WebSphere/AppServer/classes;d:/WebSphere/AppServer/lib;d:/WebSphere/AppServer/installedChannels;d:/WebSphere/AppServer/lib/ext;d:/WebSphere/AppServer/web/help;d:/WebSphere/AppServer/deploytool/itp/plugins/com.ibm.etools.ejbdeploy/runtime
2CIUSERARG               -Dderby.system.home=d:/WebSphere/AppServer/derby
2CIUSERARG               -Dcom.ibm.itp.location=d:/WebSphere/AppServer/bin
2CIUSERARG               -Djava.util.logging.configureByServer=true
2CIUSERARG               -Duser.install.root=d:\WebSphere\AppServer\profiles\AppSrv01
2CIUSERARG               -Djavax.management.builder.initial=com.ibm.ws.management.PlatformMBeanServerBuilder
2CIUSERARG               -Dwas.install.root=d:/WebSphere/AppServer
2CIUSERARG               -Dpython.cachedir=d:\WebSphere\AppServer\profiles\AppSrv01/temp/cachedir
2CIUSERARG               -Djava.util.logging.manager=com.ibm.ws.bootstrap.WsLogManager
2CIUSERARG               -Dserver.root=d:\WebSphere\AppServer\profiles\AppSrv01
2CIUSERARG               -Dappserver.platform=was61
2CIUSERARG               -Ddeploymentmgr.rmi.connection=ensi-nd01.sistema-cni.org.br:9809
2CIUSERARG               -Dappserver.rmi.host=ensi-nd01.sistema-cni.org.br
2CIUSERARG               -Duser.timezone=GMT-3
2CIUSERARG               -Djava.security.auth.login.config=d:\WebSphere\AppServer\profiles\AppSrv01/properties/wsjaas.conf
2CIUSERARG               -Djava.security.policy=d:\WebSphere\AppServer\profiles\AppSrv01/properties/server.policy
2CIUSERARG               -Dinvokedviajava
2CIUSERARG               -Djava.class.path=d:\WebSphere\AppServer\profiles\AppSrv01/properties;d:/WebSphere/AppServer/properties;d:/WebSphere/AppServer/lib/startup.jar;d:/WebSphere/AppServer/lib/bootstrap.jar;d:/WebSphere/AppServer/lib/j2ee.jar;d:/WebSphere/AppServer/lib/lmproxy.jar;d:/WebSphere/AppServer/lib/urlprotocols.jar;d:/WebSphere/AppServer/deploytool/itp/batchboot.jar;d:/WebSphere/AppServer/deploytool/itp/batch2.jar;d:/WebSphere/AppServer/java/lib/tools.jar
2CIUSERARG               vfprintf
2CIUSERARG               _port_library 0x7E7A04F8
2CIUSERARG               -Xdump
NULL 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T07:22:42.087

好像你的本机内存用完了。请参阅[“感谢您的记忆”](http://www.ibm.com/developerworks/linux/library/j-nativememory-linux/index.html?ca=dgr-jw22Linux-JVM&S_TACT=105AGX59&S_CMP=grjw22)。

将堆空间减少到 1024m：

```
2CIUSERARG               -Xms512m
2CIUSERARG               -Xmx1350m 
```

你还有这个 OutOfMemoryExceptions 吗？

# iphone - NSURLRequest - 为 NSURLRequest POST 正文编码 url（iPhone 目标 C）

> ID：787582
> 
> 赞同：13
> 
> 时间：2009-04-24T21:06:40.953
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, http

我正在使用 NSURLRequest 发送帖子。

```
NSURL *url = [NSURL URLWithString:someUrlString];
NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:url];
NSString *msgLength = [NSString stringWithFormat:@"%d", [parameterString length]];
[theRequest addValue: msgLength forHTTPHeaderField:@"Content-Length"];
[theRequest setHTTPMethod:@"POST"];
[theRequest setHTTPBody: [parameterString dataUsingEncoding:NSUTF8StringEncoding]]; 
```

在请求的正文中，我正在对以下 NVP 进行编码：

returnURL= [http://someSite.com](http://someSite.com)

该帖子已成功通过，但我收到错误消息。该错误表明 URL 无效。

因此，我将其更改为：

returnURL=http:%2F%2FsomeSite.com

有同样的错误。

我还用 Todd Ditchendorf 的 HTTP 客户端仔细检查了它，结果相同。

我知道我一定是编码错了有人能告诉我我做错了什么吗？

谢谢科里

**更新：感谢那些回答。我在 NVP 值中遗漏了一个 & 符号。所以当然，一旦我修好了，一切都很好。我怀疑的是，帖子正文中的 url 编码不正确。我没有使用 ASIHTTPRequest 框架，但它确实帮助我解决了问题（对于我需要的东西来说太过分了）。**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-04-25T11:01:22.337

考虑使用 Ben Copsey 的[`ASIHTTPRequest`](http://allseeing-i.com/ASIHTTPRequest/How-to-use)框架来生成和发送同步和异步 HTTP 请求（POST 和 GET）：

```
ASIFormDataRequest *request = [[[ASIFormDataRequest alloc] initWithURL:@"http://someSite.com"] autorelease];
[request setPostValue:@"myValue1" forKey:@"myFormField1"];
[request setPostValue:@"myValue2" forKey:@"myFormField2"];
// etc.
[request start];
NSError *error = [request error];
if (!error)
  NSString *response = [request responseString]; 
```

他的框架是一个巨大的节省时间。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-26T05:12:55.923

我不知道这是否能解决你的问题，但是

```
[parameterString length] 
```

往往不等于长度

```
[parameterString dataUsingEncoding:NSUTF8StringEncoding] 
```

因为 UTF8 对具有不同字节数的字符进行编码。

# html - HTML 命名法

> ID：787588
> 
> 赞同：3
> 
> 时间：2009-04-24T21:09:43.957
> 
> 标签：html

是否有用于区分应该有结束标签和不应该有结束标签的 HTML 标签的术语？

例如，`<em>`and`<a>`应该有伴随的`</em>`和`</a>`标签。

另一方面，`<br />`不`<img ... />`应该。

第一组叫什么，第二组叫什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-24T21:13:16.850

我*相信*这`<foo />`是一个“空元素”，而不是......不是;-p顺便说一句，`<br />` *它不是*一个html元素-它是一个xhtml元素。IIRC 它应该是`<br>`真正的旧版 html。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-24T21:12:24.793

在 XHTML 中，文档必须[格式](http://www.w3.org/TR/xhtml1/#h-4.1)正确。这包括使用开始标签打开的每个元素都必须有相应的结束标签。除了它没有[内容](http://www.w3.org/TR/xml/#NT-content)（如其他元素或文本）。这样的元素被称为[空元素](http://www.w3.org/TR/xhtml1/#C_2)。

后者是空元素，因为它们没有任何内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T21:32:17.820

需要注意的是，在 HTML 4.01 中，一些标签（例如[<p>](http://www.w3.org/TR/html401/struct/text.html#h-9.3.1)和[<li>](http://www.w3.org/TR/html401/struct/lists.html#h-10.2)）可以有内容，但结束标签是可选的。

以下是有效的标记：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Title</title>
</head>
<body>
<p>Test
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T22:13:34.787

根据 HTML 4.01，元素和标签分为三个不同的组。

1.  *必须有*结束标签的元素。例如 <h1></h1>
2.  *可能没有*结束标签的元素。例如 <li>
3.  *可能没有*结束标签的元素。例如 <br> - HTML 4.01 的 W3C 验证器*警告*<br />

我在规范中查看了高低，在第三组中找不到用于描述标签的术语。

“空”一词仅表示标签之间当前没有任何*内容。*这适用于上述 1 和 2。

我的建议：尽管 W3C 没有对此发表任何评论，但据我所知，可能可以将像 <br> 这样的元素称为“**空白元素**”，因为它们被认为是空白，并且它们是元素。“空白字符”，例如 ，不是元素，因此不应混淆。有人看到这有什么问题吗？如果没有，也许我们应该向 W3C 提出建议。

# c - C的unicode你好世界？

> ID：787589
> 
> 赞同：10
> 
> 时间：2009-04-24T21:09:58.357
> 
> 标签：c, unicode, utf-8

我正在尝试从 C 中输出诸如안、蠀、☃ 之类的东西

```
#include <wchar.h>
int main()
{
    fwprintf(stdout, L"안, 蠀, ☃\n");
    return 0;
} 
```

输出是 ?, ?, ?

如何打印这些字符？

编辑：

```
#include <wchar.h>
#include <locale.h>
int main()
{
    setlocale(LC_CTYPE, "");
    fwprintf(stdout, L"안, 蠀, ☃\n");
    return 0;
} 
```

这成功了。输出是안，蠀，☃。除了汉字和雪人在我的 urxvt 中显示为框可能是因为我没有启用这些语言环境。

```
$ locale -a
C
en_US
en_US.iso88591
en_US.iso885915
en_US.utf8
ja_JP.utf8
ko_KR
ko_KR.euckr
ko_KR.utf8
korean
korean.euc
POSIX
zh_CN.utf8 
```

我必须另外启用哪个区域设置才能显示汉字和雪人？也许我需要字体？

上述程序可以在 Windows 上运行吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-04-24T21:17:41.800

您必须将输出终端设置为 Unicode 兼容。

在 Linux（使用 Bash shell）上，尝试：

```
$ LANG=en.UTF-8 
```

并确保您的终端仿真器实际上可以显示 Unicode 并配置为这样做。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-04-24T21:22:40.353

在获取 Unicode 输出的过程中有许多单独的阶段 - 所有这些阶段都必须正确配置。

首先，您是否在启用 unicode 支持的情况下进行编译？您需要在 Windows 下执行此操作（-D UNICODE -D __UNICODE）。

其次，您是否发送到支持 unicode 的命令行，原则上而且还有一个包含您正在发送的字符的字形的字体？

第三，您的编译器和命令行使用的 unicode 编码是否匹配？当你的命令行需要 UTF8 时，在你的二进制文件中使用 UCS2 是没有用的。

您基本上需要真正了解 Unicode 及其编码，才能做到这一点。不要以为它很简单，或者您不需要学习所有基本概念；这些东西不会偶然起作用，因为有太多东西必须完全正确。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-24T21:19:42.980

C`wchar_t`定义为：

> Type`wchar_t`是一种独特的类型，其值可以表示支持的语言环境 (22.1.1) 中指定的最大扩展字符集的所有成员的不同代码。[...]

多字节字符和 的区别`wchar_t`：

> 多字节字符对于给定字符可能需要多个字节，具体取决于编码（例如：UTF-8、UTF-16）

然而

> `wchar_t`有一个固定的大小，即 sizeof(wchar_t) 这是实现定义的。请注意，此宽度定义了您`wchar_t`可以支持的编码。因此，如果`sizeof(wchar_t) == 2`您无法使用 UTF-32 编码。

还要记住，`wchar_t`它本身没有编码感。您首先必须告诉编译器它必须对`wchar_t`数据使用哪种编码。错误的输出很可能是因为默认编码中处理的字符不能正确支持这些字符，并且匹配失败导致'notdef'样式'？输出。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T21:11:12.410

您必须配置系统以接受这些字符。你在用什么？窗户，Linux？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T22:38:05.883

正如 Alnitak 建议的那样，必须使用包含您要显示的字符的字符集/编码来指定语言环境。(Unicode/)UTF-8 应该涵盖所有 Unicode 字符。

您的终端应使用具有相应字形的字体。

Windows 的 CMD.EXE 在处理超过 8 位的字符集时是出了名的薄弱。也许，您需要一个 GUI 窗格而不是依赖标准输出。

# javascript - 在服务器端 Javascript 代码中获取对象预期错误

> ID：787592
> 
> 赞同：0
> 
> 时间：2009-04-24T21:11:01.660
> 
> 标签：javascript, object

我收到一条错误消息，指出下面的代码中需要一个对象。错误是：

```
Object Expected: this.regionalRankings[worldRegion][rankType] = this.getRankings(rankType, this.regionalRankingKey[worldRegion]); 
```

声明...

```
 this.regions = {};
    this.regions = ["US", "Europe", "Asia"];    
    this.regionalRankingKey = ["SP500", "GBE", "CNG"]; //this is the ranking model key for pulling up the rankings object.
    this.rankingTypes = ["gainers", "losers", "actives"];
    this.regionalRankings = {};
    this.rankingWSODIssues = [];

    marketSummary_data.prototype.initRankingsNew = function(){

    for(var worldRegion in this.regions){        

        for (var rankType in this.rankingTypes){

            //this is the line getting the error.
            this.regionalRankings[worldRegion][rankType] = this.getRankings(rankType, this.regionalRankingKey[worldRegion]);

            for(var i = 0; i < 5; i++){

                this.rankingWSODIssues.push(this.regionalRankings[worldRegion][rankType].value("Result[0].Row[" + i + "].WSODIssue"));

            }
        }    
    }

    for(var item in this.rankingWSODIssues){

        Response.Write("<p>" + item + ": " + rankingWSODIssues[item] + "</p>");

    }    
} 
```

该函数`this.getRankings`返回一个对象。

```
 marketSummary_data.prototype.getRankings = function(rankingType, rankingSet){
    //ranking types Epctchg+ (pct gainers) 
    //Epctchg- (pct losers) 
    //Edollar+ (net gainers) 
    //Edollar- (net losers) 
    //Evol+ (highest volume) 

    //rankingSets    

    if (rankingType == "gainers"){
        rankingType = "Epctchg+";
    }
    if (rankingType == "losers"){
        rankingType = "Epctchg-";
    }
    if (rankingType == "actives"){
        rankingType = "Evol+";
    }

   var rankings = User.CreateObject("WIT.Rankings.1")

       rankings.SetVariableName("Rankings")
       rankings.SetInput("Ranking.RT", 0)
       rankings.SetInput("Ranking.Type", rankingType)
       rankings.SetInput("Ranking.Set", rankingSet)
       rankings.SetInput("Ranking.Rows", 5)
       rankings.SetInput("Ranking.Symbolset", "BridgeStreet");
       rankings.SetInput("Ranking.MinPrice", 0);  // only want stocks trading higher> 0
       rankings.Retrieve();    

   return rankings;
} 
```

关于我在这里做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T21:50:43.937

问题在于，它`this.regionalRankings[worldRegion][rankType]`要求`this.regionalRankings[worldRegion]`是某物，但`this.regionalRankings`它是一个空对象，因此“需要对象”。

我想你打算做的是：

```
for(var worldRegion in this.regions){        
    this.regionalRankings[worldRegion] = {}; // Make it into an object.
    for (var rankType in this.rankingTypes){
        this.regionalRankings[worldRegion][rankType] = ...
     }
 } 
```

# c++ - 如何在 x86（奔腾及更高版本）上执行原子 64b 读取？

> ID：787598
> 
> 赞同：3
> 
> 时间：2009-04-24T21:13:17.070
> 
> 标签：c++, winapi, x86, multicore, atomic

我想在 x86 平台（保证奔腾或更高版本）上执行和原子读取 64b 对齐的 64b 数据。

有没有办法做到这一点？（不，我不想为此使用关键部分或互斥锁，我希望它是无锁的）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T21:16:59.133

[这个页面](http://www.niallryan.com/node/137)描述了如何做到这一点。基本上你只需要使用`lock cmpxchg8b`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T21:48:03.523

使用联锁操作，这里有一些示例代码：

```
LONGLONG AtomicRead(LONGLONG* p)
{
    return InterlockedCompareExchange64(p, 0, 0);
} 
```

这将与零进行比较交换，如果 p 已经等于零，则将 p 设置为零 - 即，这是一个 noop。InterlockedCompareExchange 返回 p 指向的原始 64 位值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T21:16:43.957

使用 Interlocked*() 函数。

本身没有读取 - 但您可以在添加 0 的位置发出 Add()。

# svn - 尝试在 Hudson 上设置 svn 密码时出错

> ID：787600
> 
> 赞同：3
> 
> 时间：2009-04-24T21:13:25.977
> 
> 标签：svn, hudson

填写存储库 URL、用户名和密码后，我收到以下错误。

有谁知道如何解决它？

未尝试进行身份验证。失败：svn：操作已取消

org.tmatesoft.svn.core.SVNCancelException：svn：在 hudson.scm.SubversionSCM$DescriptorImpl.doPostCredential(SubversionSCM.java:1317) 在 hudson.scm.SubversionSCM$DescriptorImpl.postCredential(SubversionSCM.java:1421) 取消操作.reflect.NativeMethodAccessorImpl.invoke0(Native Method) at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at org .kohsuke.stapler.Function$InstanceFunction.invoke(Function.java:160) at org.kohsuke.stapler.Function.bindAndInvoke(Function.java:76) at org.kohsuke.stapler.MetaClass$1.doDispatch(MetaClass.java: 73) 在 org.kohsuke.stapler.NameBasedDispatcher.dispatch(NameBasedDispatcher.java:30) 在 org.kohsuke.stapler.Stapler.invoke(Stapler.java:436) 在 org.kohsuke.stapler.MetaClass$6.doDispatch(MetaClass.java:186) 在 org.kohsuke.stapler.NameBasedDispatcher.dispatch(NameBasedDispatcher.java:30) 在 org.kohsuke.stapler.Stapler.invoke(Stapler. java:436) 在 org.kohsuke.stapler.Stapler.invoke(Stapler.java:354) 在 org.kohsuke.stapler.Stapler.service(Stapler.java:114) 在 javax.servlet.http.HttpServlet.service(HttpServlet .java:45) 在 winstone.ServletConfiguration.execute(ServletConfiguration.java:249) 在 winstone.RequestDispatcher.forward(RequestDispatcher.java:335) 在 winstone.RequestDispatcher.doFilter(RequestDispatcher.java:378) 在 hudson.util.PluginServletFilter $1.doFilter(PluginServletFilter.java:91) at hudson.util.PluginServletFilter.doFilter(PluginServletFilter.java:83) at winstone.FilterConfiguration.execute(FilterConfiguration.java:195) 在 winstone.RequestDispatcher.doFilter(RequestDispatcher.java:368) 在 hudson.security.ChainedServletFilter$1.doFilter(ChainedServletFilter.java:84) 在 hudson.security.ChainedServletFilter.doFilter(ChainedServletFilter.java:76) 在 hudson.security .HudsonFilter.doFilter(HudsonFilter.java:155) 在 winstone.FilterConfiguration.execute(FilterConfiguration.java:195) 在 winstone.RequestDispatcher.doFilter(RequestDispatcher.java:368) 在 winstone.RequestDispatcher.forward(RequestDispatcher.java:333)在 winstone.RequestHandlerThread.processRequest(RequestHandlerThread.java:244) 在 winstone.RequestHandlerThread.run(RequestHandlerThread.java:150) 在 java.lang.Thread.run(Unknown Source)doFilter(ChainedServletFilter.java:84) at hudson.security.ChainedServletFilter.doFilter(ChainedServletFilter.java:76) at hudson.security.HudsonFilter.doFilter(HudsonFilter.java:155) at winstone.FilterConfiguration.execute(FilterConfiguration.java:195 ) 在 winstone.RequestDispatcher.doFilter(RequestDispatcher.java:368) 在 winstone.RequestDispatcher.forward(RequestDispatcher.java:333) 在 winstone.RequestHandlerThread.processRequest(RequestHandlerThread.java:244) 在 winstone.RequestHandlerThread.run(RequestHandlerThread.java :150) 在 java.lang.Thread.run(Unknown Source)doFilter(ChainedServletFilter.java:84) at hudson.security.ChainedServletFilter.doFilter(ChainedServletFilter.java:76) at hudson.security.HudsonFilter.doFilter(HudsonFilter.java:155) at winstone.FilterConfiguration.execute(FilterConfiguration.java:195 ) 在 winstone.RequestDispatcher.doFilter(RequestDispatcher.java:368) 在 winstone.RequestDispatcher.forward(RequestDispatcher.java:333) 在 winstone.RequestHandlerThread.processRequest(RequestHandlerThread.java:244) 在 winstone.RequestHandlerThread.run(RequestHandlerThread.java :150) 在 java.lang.Thread.run(Unknown Source)RequestDispatcher.doFilter(RequestDispatcher.java:368) 在 winstone.RequestDispatcher.forward(RequestDispatcher.java:333) 在 winstone.RequestHandlerThread.processRequest(RequestHandlerThread.java:244) 在 winstone.RequestHandlerThread.run(RequestHandlerThread.java:150) 在java.lang.Thread.run（未知来源）RequestDispatcher.doFilter(RequestDispatcher.java:368) 在 winstone.RequestDispatcher.forward(RequestDispatcher.java:333) 在 winstone.RequestHandlerThread.processRequest(RequestHandlerThread.java:244) 在 winstone.RequestHandlerThread.run(RequestHandlerThread.java:150) 在java.lang.Thread.run（未知来源）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-09T20:50:29.980

请参阅 Hudson 问题[2073](http://issues.hudson-ci.org/browse/HUDSON-2073) Hudson 用户邮件列表将是获得帮助的更好地方。

# windows - 删除 NTFS 中的队列？

> ID：787608
> 
> 赞同：1
> 
> 时间：2009-04-24T21:15:45.707
> 
> 标签：windows, file, ntfs

在我的 Windows 2003 上的应用程序（VB6 和 C# 2008）中，我已经看到了关于删除包含文件的文件夹的类似行为。我的代码将构建一些临时文件夹并在该文件夹中生成文件以供后续处理。处理完成后，我的代码将尝试删除生成的临时文件夹。删除操作完成且没有错误。

但是，经过进一步检查，您可以看到该文件夹​​仍然存在于 Windows 资源管理器中。尝试浏览此文件夹会导致权限被拒绝错误。稍后应用程序将处理另一轮文件并尝试再次创建临时文件夹。不幸的是，之前的 Pending Delete 尚未完成，因此尝试再次创建该文件夹会导致权限被拒绝错误。在我关闭我的应用程序之前，该文件夹不会被真正删除。关闭应用程序后，该文件夹将被删除。为什么我的文件夹删除操作直到应用程序关闭才提交？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-24T21:26:12.607

我想知道-您是否可能不小心保留了对该目录的锁定？这可以解释为什么在您的应用程序离开之前无法删除该目录。

有一些工具——试试 SysInternals——会列出文件/目录锁。尝试您的应用程序，然后查看它是否保留锁定。我认为您可以然后强行删除该锁-然后查看目录是否立即消失。

# c# - 如何使用 WebService 将文件复制到 SharePoint？

> ID：787610
> 
> 赞同：7
> 
> 时间：2009-04-24T21:16:34.253
> 
> 标签：c#, web-services, sharepoint, file-upload

我正在编写一个 winforms c# 2.0 应用程序，该应用程序需要将 XML 文件放入 SharePoint 上的文档库中。

我想使用 WebService 而不是使用对象模型（此处没有要引用的 sharepoint.dll）

我目前正在使用[http://webserver/site/_vti_bin/copy.asmx](http://webserver/site/_vti_bin/copy.asmx)网络服务。

这是一些代码：

```
byte[] xmlByteArray;
using (MemoryStream memoryStream = new MemoryStream())
{
    xmlDocument.Save(memoryStream);
    xmlBytes = memoryStream.ToArray();
}

string[] destinationUrlArray = new string[] {"http://webserver/site/Doclib/UploadedDocument.xml"};

FieldInformation fieldInfo = new FieldInformation();
FieldInformation[] fields = { fieldInfo };

CopyResult[] resultsArray;

using (Copy copyService = new Copy())
{
    copyService.Credentials = CredentialCache.DefaultCredentials;
    copyService.Url = "http://webserver/site/_vti_bin/copy.asmx";

    copyService.Timeout = 600000;

    uint documentId = copyService.CopyIntoItems("", destinationUrlArray, fields, xmlByteArray, out resultsArray);
} 
```

当此代码运行时，我在 resultsArray out 参数中得到一个结果：

```
DestinationURL: "http://webserver/site/Doclib/UploadedDocument.xml"
ErrorCode: UnKnown
ErrorMessage: "Object reference not set to an instance of an object." 
```

从我的搜索中，我发现了一些可能的帮助。

*   [Microsoft](http://social.technet.microsoft.com/Forums/pt-BR/sharepointdevelopment/thread/5a1ce3c9-ebc7-4ec9-b0fb-b891d076591b) TechNet——“只有当源 URL 和目标 URL 位于同一个 SPWebApplication（站点集合）中时，copy.asmx copyintoitems 才会起作用。”

*   [Microsoft 社交](http://social.microsoft.com/Forums/zh-CN/sharepointdevelopment/thread/273528be-b207-48d9-b697-74777416638e)——“由于 SharePoint 无法识别该特定属性，因此发生对象引用未设置为对象实例错误。”

这让我相信我的源网址应该设置为某个值，但是什么？这源自客户端工作站并且没有源 URL。

任何帮助都会被应用。

谢谢你，
基思

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-04-22T15:34:10.460

我知道这是一个旧线程，但是当我在寻找解决同一问题的方法时，它不断出现。

检查 Steve Curran 在此线程[http://social.msdn.microsoft.com/Forums/en-SG/sharepointdevelopment/thread/833e38a8-f13c-490d-8ba7-b889b6b25e38](http://social.msdn.microsoft.com/Forums/en-SG/sharepointdevelopment/thread/833e38a8-f13c-490d-8ba7-b889b6b25e38)上的回答。看起来基本上请求失败，因为无法解析目标网址。

（新的 stackflow 用户的限制 - 不能发布多个链接。其余的请参阅我的评论）

拍

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T21:29:27.670

[SharePoint 响应普通的旧 HTTP PUT](http://blog.jonudell.net/2007/09/04/sharepoint-ironpython-and-another-lesson-in-the-virtue-of-laziness/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T23:49:34.603

您的代码很好，只需使用目标网址而不是空字符串。见下文：

```
byte[] xmlByteArray;
using (MemoryStream memoryStream = new MemoryStream())
{
    xmlDocument.Save(memoryStream);
    xmlBytes = memoryStream.ToArray();
}

string destinationUrl = “http://webserver/site/Doclib/UploadedDocument.xml”
string[] destinationUrlArray = new string[] { destinationUrl };

FieldInformation fieldInfo = new FieldInformation();
FieldInformation[] fields = { fieldInfo };

CopyResult[] resultsArray;

using (Copy copyService = new Copy())
{
    copyService.Credentials = CredentialCache.DefaultCredentials;
    copyService.Url = "http://webserver/site/_vti_bin/copy.asmx";

    copyService.Timeout = 600000;

    uint documentId = copyService.CopyIntoItems(destinationUrl , destinationUrlArray, fields, xmlByteArray, out resultsArray);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-27T18:50:55.607

这是目前的工作：

```
WebRequest request = WebRequest.Create(“http://webserver/site/Doclib/UploadedDocument.xml”);
request.Credentials = CredentialCache.DefaultCredentials;
request.Method = "PUT";
byte[] buffer = new byte[1024];
using (Stream stream = request.GetRequestStream())
{
    using (MemoryStream memoryStream = new MemoryStream())
    {
        dataFile.MMRXmlData.Save(memoryStream);
        memoryStream.Seek(0, SeekOrigin.Begin);
        for (int i = memoryStream.Read(buffer, 0, buffer.Length); i > 0;
            i = memoryStream.Read(buffer, 0, buffer.Length))
        {
            stream.Write(buffer, 0, i);
        }
    }
}

WebResponse response = request.GetResponse();
response.Close(); 
```

所以...是否有人认为这种“PUT”方法在 SharePoint 环境中是否比使用内置 Web 服务更好？

现在我不得不说“PUT”方法更好，因为它可以工作，我无法让 WebService 工作。

基思

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-02-16T14:51:07.567

当我使用默认凭据时，我会收到相同的消息。尝试用这个替换它们：

```
copyWebService.Credentials 
    = new NetworkCredential("Administrator", "pass", "MyDomain"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T01:34:51.387

这是我写了一段时间的一些代码（我很抱歉，我不得不把它拼凑起来，但希望你明白它的意思）

```
 // Create a request using a URL that can receive a post. 
WebRequest request = WebRequest.Create("http://sharepointsite/somefile.txt");

// Set the Method property of the request to POST.
request.Method = "PUT"

Stream dataStream;

// Set the ContentType property of the WebRequest.
request.ContentType = "multipart/form-data; charset=ISO-8859-1";

byte[] byteArray = File.ReadAllBytes(@"c:\somefile.txt");

// Set the ContentLength property of the WebRequest.
request.ContentLength = byteArray.Length;

// Get the request stream.
dataStream = request.GetRequestStream();

// Write the data to the request stream.
dataStream.Write(byteArray, 0, byteArray.Length);

// Close the Stream object.
dataStream.Close();

// Get the response.
HttpWebResponse response = (HttpWebResponse)request.GetResponse();
HttpStatusCode statCode = response.StatusCode;

// Get the stream containing content returned by the server.
dataStream = response.GetResponseStream();
// Open the stream using a StreamReader for easy access.
StreamReader reader = new StreamReader(dataStream);
// Read the content.
string responseFromServer = reader.ReadToEnd();

// Clean up the streams.
reader.Close();
dataStream.Close();
response.Close(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2011-09-24T03:08:40.983

我不确定它是否能解决您的问题，但是当您引用网络服务时，请不要使用 URL 的 [site] 部分。

请尝试：http://[server]/_vti_bin/[webservice]。

我不是 SP 方面的专家，但我很确定 web 服务属于主服务器，而不是特定站点。

希望能帮助到你。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-05T14:36:06.603

我有一个类似的问题，原来客户端配置为使用 NTLM 安全性，但没有附加 NTLM 标头。

我的情况是，因为我在 ASP.NET 应用程序的服务器端使用此代码，是为了启用 Windows 身份验证并设置

身份模拟=“真”

在 server.web 部分。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-05-28T16:52:25.777

如果您的共享点服务器是在场上构建的，请检查您的“备用访问映射”，看看是否有一个条目：yourwebserverurl Intranet yourwebserverurl 如果没有，请添加它。

就我而言，添加后，复制服务开始工作。

这可能与场负载平衡地址解析有关。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-04-26T15:08:22.653

我不明白，你为什么使用 Copy 而不是[UpdateListItems](http://msdn.microsoft.com/en-us/library/lists.lists.updatelistitems.aspx)。也许 UpdateListItems 会更好？

# c++ - C++ 画一棵树

> ID：787617
> 
> 赞同：3
> 
> 时间：2009-04-24T21:18:56.447
> 
> 标签：c++, data-structures, visualization

我在 C++ 中搜索了 Tree Visualization Framework 或类似的东西。我想知道我没有找到类似的东西。是否有任何（好的）框架来绘制树（或其他数据结构）？它应该在 C++ 中。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-24T21:22:08.000

对于简单的树，您可以使用 GUI 环境的标准树控件（Win32 API、Gtk、Qt 等）。如果需要跨平台，可以使用 wxWidgets 或 Qt。

如果您正在寻找更通用的东西，请查看[GraphViz](http://www.graphviz.org/)。

# c# - 我在 server1 上使用 Web 服务，如果 server1 失败（使用 C#），我如何更改为 server2

> ID：787620
> 
> 赞同：1
> 
> 时间：2009-04-24T21:21:15.380
> 
> 标签：c#, web-services

如果 server1 失败，我希望能够使用 server2，所以我有两个 Web 引用，但这会导致“不明确的引用”错误，因为它是两个服务器上的相同服务。

这是 C# 代码：

使用 App.org.weccrc.www；// 使用 App.org.weccrc.www2 的主服务器；// 备份服务器

有没有办法在“使用”语句之前检查 server1 上的服务是否可用？

这可以是条件语句吗？

或者有另一种方法来解决这个问题。

提前致谢

劳尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T21:38:54.667

我会做这样的事情

```
public R CallWebservice<T,R>(T service, IEnumerable<string> urls, Func<T,R> serviceCall)
    where T : SoapHttpClientProtocol, IDisposable
{
    foreach (var url in urls)
    {
        try {
            service.Url = url;
            return serviceCall(service);
        } catch (Exception ex) {
            // Log Error
            continue;
        } finally {
            service.Dispose();
        }
    }

    // throw exception here which means that all url's failed
} 
```

你可以称之为做这样的事情

```
Employee[] employees = CallWebService(
    new DownloadService(), 
    new string[] { "http://site1/service.asmx","http://site2/service.asmx" }, 
    service => service.DownloadEmployees()
); 
```

这将遍历指定的每个 URL 并调用 web 服务。如果失败，那么它只会尝试执行下一个 URL，直到成功执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T21:26:04.073

在您的 Web 参考中，将 URL 行为设置为动态。为 Web 参考生成的代码现在将具有控制位置的配置设置。当您检测到主服务出现故障时，您可以将 Url 属性设置为回退位置。

您如何检测到主要服务失败当然取决于您正在使用的服务。

# c# - 如何测量网页的响应和加载时间？

> ID：787622
> 
> 赞同：9
> 
> 时间：2009-04-24T21:21:22.307
> 
> 标签：c#, winforms, monitoring

我需要构建一个 Windows 窗体应用程序来测量完全加载网页所需的时间，最好的方法是什么？

这个小应用程序的目的是在预定的时间间隔内监控网站中的某些页面，以便能够提前知道网络服务器或数据库服务器是否出现问题。

**附加信息：**

我不能使用商业应用程序，我需要开发它以便能够将结果保存到数据库并根据此信息创建一系列报告。

webrequest 解决方案似乎是我将要使用的方法，但是，能够测量完全加载页面（图像、css、javascript 等）所需的时间会很好。知道怎么做吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-04-24T21:32:57.163

如果您只想记录获取基本页面源所需的时间，您可以将 HttpWebRequest 包裹在秒表周围。例如

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create(address);

System.Diagnostics.Stopwatch timer = new Stopwatch();
timer.Start();

HttpWebResponse response = (HttpWebResponse)request.GetResponse();

timer.Stop();

TimeSpan timeTaken = timer.Elapsed; 
```

但是，这不会考虑下载额外内容（例如图像）的时间。

[编辑] 作为替代方案，您可以使用 WebBrowser 控件并测量执行 .Navigate() 和触发 DocumentCompleted 事件之间的时间。我认为这还将包括额外内容的下载和渲染时间。但是，我没有大量使用 WebBrowser 控件，只是不知道如果您重复请求同一页面，是否必须清除缓存。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T21:39:16.820

根据您需要执行的频率，也许您可​​以尝试使用 Selenium（一种用于 Web 应用程序的自动化测试工具），因为它在内部使用 Web 浏览器，因此您将有一个非常接近的衡量标准。我认为从 .Net 应用程序中使用 Selenium API 不会太难（因为您甚至可以在单元测试中使用 Selenium）。

测量这种东西是很棘手的，因为网络浏览器在下载所有网页元素（JS、CSS、图像、iframe 等）时有一些特殊性——这种特殊性在这本优秀的书中有解释（[http://www. amazon.com/High-Performance-Web-Sites-Essential/dp/0596529309/](https://rads.stackoverflow.com/amzn/click/com/0596529309)）。

自制的解决方案可能编码起来太复杂，或者无法考虑其中的一些特殊性（测量下载 html 所花费的时间还不够好）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-24T23:56:49.657

您需要考虑的一件事是缓存。确保您测量的是从服务器下载而不是从缓存下载的时间。您需要确保已关闭客户端缓存。

还要注意服务器端缓存。假设你在上午 9:00 下载速度需要 15 秒，然后你在 9:05 下载它需要 3 秒，最后在 10:00 再次需要 15 秒。

可能发生的情况是，在 9 时，服务器必须完全呈现页面，因为缓存中没有任何内容。9:05 页面在缓存中，因此不需要再次渲染。最后到 10 点缓存已被清除，因此该页面需要由服务器再次呈现。

我强烈建议您查看 FireFox 的[YSlow](http://developer.yahoo.com/yslow/)插件，该插件将为您详细分析下载页面上每个项目所需的时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T21:32:22.547

像这样的东西可能会很好用：

```
System.Diagnostics.Stopwatch sw = new Stopwatch()
System.Net.HttpWebRequest req = (HttpWebRequest)HttpWebRequest.Create("http://www.example.com");
// other request details, credentials, proxy settings, etc...

sw.Start();
System.Net.HttpWebResponse res = (HttpWebResponse)req.GetResponse();
sw.Stop();

TimeSpan timeToLoad = sw.Elapsed; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-27T07:00:53.707

我曾经写过一个**实验** [程序](http://delambre.sourceforge.net/)，它下载一个 HTML 页面**和**它引用的对象（图像、iframe 等）。

比看起来更复杂，因为存在 HTTP 协商，因此，一些 Web 客户端将获得图像的 SVG 版本和一些 PNG 版本，它们的大小差异很大。同样的事情`<object>`。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-13T20:10:35.417

我经常遇到一个非常相似的问题。但是我采取了一种稍微不同的方法：首先，我为什么要关心静态内容？我的意思是，如果图像需要 2 分钟或 2 秒，这对用户来说当然很重要，但是在我完全开发页面之后，这不是我的问题。这些东西是开发时的问题，部署后不是静态内容，而是动态的东西通常会减慢速度（就像你在上一段中所说的那样）。接下来的事情是，你为什么相信这么多事情保持不变？如果您网络上的某个人启动了 p2p 程序，路由出错或您的 ISP 出现问题，您的服务器统计数据肯定会下降。对于生活在全球或只是使用不同 ISP 的用户，您的基准测试说明了什么？我要说的是，

为什么不让站点/服务器本身决定加载需要多长时间？这是一个用 PHP 编写的小例子：

```
function microtime_float()
{
  list($usec, $sec) = explode(" ", microtime());
  return ((float)$usec + (float)$sec);
}

function benchmark($finish)
{
  if($finish == FALSE){  /* benchmark start*/    
    $GLOBALS["time_start"] = microtime_float();
  }else{ /* benchmark end */    
    $time = microtime_float() - $GLOBALS["time_start"]; 
    echo '<div id="performance"><p>'.$time.'</p></div>';
  }
} 
```

它在页面末尾添加了构建时间（隐藏在 css 中）。每隔几分钟，我就会用一个正则表达式 grep 并解析它。如果这个时间增加，我知道有问题（包括静态内容！）并且通过 RSS-Feed 我得到通知并且我可以采取行动。

通过 firebug，我们知道网站加载所有内容（开发阶段）的“正常”性能。通过基准测试，我们可以获得当前的服务器情况（甚至在我们的手机上）。好的。接下来是什么？我们必须确保所有/大多数访问者都获得了良好的连接。我觉得这部分真的很难，并且愿意接受建议。但是，我尝试获取日志文件并 ping 几个 IP，以查看到达该网络需要多长时间。此外，在我决定使用特定的 ISP 之前，我会尝试阅读有关连接性和用户意见的信息......

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-24T21:28:59.340

你可以使用这样的软件：

[http://www.cyscape.com/products/bhawk/page-load-time.aspx](http://www.cyscape.com/products/bhawk/page-load-time.aspx)

[http://www.trafficflowseo.com/2008/10/website-load-timer-great-to-monitor.html](http://www.trafficflowseo.com/2008/10/website-load-timer-great-to-monitor.html)

谷歌将帮助您找到最适合您需求的那个。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-24T21:30:52.050

*   [http://www.httpwatch.com/](http://www.httpwatch.com/)
*   Firebug NET 选项卡

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-04-24T21:32:52.590

如果您使用的是 firefox，请安装[http://getfirebug.com](http://getfirebug.com)上的 firebug 扩展。从那里，选择 net 选项卡，它会让您知道页面上所有内容的加载/响应时间。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-01-29T21:57:14.830

# tl;博士

使用无头浏览器来测量加载时间。这样做的一个例子是[网站加载时间](https://github.com/rinogo/website-loading-time)。

# 长版

我遇到了您遇到的相同挑战，因此我创建了一个辅助项目来测量实际加载时间。它使用 Node 和 Nightmare 来操作无头（“不可见”）网络浏览器。加载所有资源后，它会报告完全加载页面所需的毫秒数。

对您有用的一项不错的功能是它重复加载网页并将结果提供给第三方服务。我将这些值输入 NIXStats 进行报告；您应该能够调整代码以将值输入您自己的数据库。

这是我们后端输入 NIXStats 后的结果值的屏幕截图： [![在此处输入图像描述](https://i.stack.imgur.com/HjAEd.png)](https://i.stack.imgur.com/HjAEd.png)

示例用法：

```
website-loading-time rinogo$ node website-loading-time.js https://google.com
1657
967
1179
1005
1084
1076
... 
```

此外，如果您的大部分代码必须使用 C#，您仍然可以利用此脚本/库。由于它是一个命令行工具，因此您可以从 C# 代码中调用它并处理结果。

[https://github.com/rinogo/website-loading-time](https://github.com/rinogo/website-loading-time)

披露：我是这个项目的作者。

# git - 大型团队如何使用 DVCS？

> ID：787638
> 
> 赞同：30
> 
> 时间：2009-04-24T21:28:04.583
> 
> 标签：git, version-control, mercurial, dvcs

我最近开始在一个个人项目上接触 Git，并且我可以看到 DVCS 如何使我们在工作中受益（这是一家大型企业软件公司，目前正在运行 Perforce）。例如，我团队中的功能工作主要由开发人员创建自己的分支组成；有时这些是在小型开发团队之间共享的。我认为在这种情况下使用 DVCS 会更有效。

不过，在更一般的情况下，我很想听听在工作中使用 DVCS 的人的意见，在大中型团队中。

1.  你如何处理 N 路合并？这甚至是一种常见的情况吗？Mercurial 仅通过执行 (N-1) 2 路合并来支持 N 路合并（并且[读到](http://code.google.com/p/support/wiki/DVCSAnalysis)这是其他 DVCS 中的首选解决方案），这对于即使是相对较小的 N 来说也是一个非常费力的过程。
2.  您使用单一的中央权威存储库，还是真正的 P2P？
3.  开发人员是否经常相互推拉代码，或者一切都通过中央存储库进行？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-04-25T04:23:23.307

我以前雇主的团队使用 Git，它对我们很有效。我们并没有那么大（可能有 16 个左右，可能有 8 个真正活跃的提交者？），但我有你的问题的答案：

1.  N-Way 合并并不是很常见。我们提出了一些关于分支命名的约定，允许我们编写简化“发布工程”过程的脚本（我使用吓人的引号，因为我们没有发布工程师），人们会创建私有功能分支，但我们很少合并两个以上的分支时遇到问题（请参阅下一个）。
2.  （和＃3）。我们在开发服务器上有一个中央存储库有三个原因：(a) 开发机器有 RAID5（更容错）和夜间备份（开发工作站不是夜间备份），(b) 生产版本是在开发服务器上构建的， (c) 有一个中央存储库简化的脚本。结果，N 路合并根本就没有发生。我们最接近 N 路的事情是当有人横向合并然后垂直合并时。

Git 对我们来说是一件非常棒的事情，因为它具有高度的灵活性。但是，我们确实必须建立一些约定（分支和标签名称、repo 位置、脚本等，流程），否则可能会有点混乱。一旦我们建立了约定，我们所拥有的灵活性就非常棒了。

更新：我们的约定基本上是这样的：

*   我们 NFS 服务器上的一个目录，其中包含所有中央存储库
*   我们有几个共享组件的项目，所以我们将它们分解为库，本质上，使用它们自己的存储库，而可交付的项目只是将它们作为 git 子模块包含在内。
*   上面有版本字符串和版本名称强加给我们，所以我们只是使用它们的变体作为分支名称
*   同样，对于标签，它们遵循流程指定的发布名称
*   可交付的项目包含一个属性文件，我将其读入 shell 脚本，这使我可以编写一个脚本来管理所有项目的发布过程，即使每个项目在过程上都有细微的变化——这些变化都被考虑在内在那些属性文件中
*   我编写了可以从任何标签重建可交付包的脚本
*   使用 git 允许我们使用 PAM 和/或普通用户权限（ssh 等）控制访问
*   还有其他约定更难放入项目符号列表中，例如何时应该发生合并。真的，我和另一个人有点像内部的“git 大师”，我们帮助每个人弄清楚如何使用分支以及何时合并。
*   让人们以小块的方式提交而不是在主分支中丢弃差异炸弹是一个挑战。一个人在一次提交中投入了大约两个星期的工作，我们最终不得不解开这一切。*非常*浪费时间，让所有人都感到沮丧。
*   与提交相关的信息丰富且详细的评论

随着您的团队经验丰富并学会相互合作，您还可以学到其他东西，但这足以让我们开始。

**更新**：到目前为止，任何关注此类事情的人都已经知道了，但是 Vincent Dreissen 使用 Git 编写了一个可靠且非常全面（但不详尽）[的分支和发布工程](http://nvie.com/posts/a-successful-git-branching-model/)。我强烈鼓励以他的过程为起点，因为有两个原因：

*   很多团队这样做或正在使用一些相近的变体（包括 Linux、Git 和许多其他 OSS 项目团队），这意味着这种方法已经过测试和调整，在大多数情况下都能成功。在此模型的约束下，您不太可能遇到尚未解决和解决的问题。
*   由于上述原因，几乎所有具有 Git 经验的工程师都会明白发生了什么。您不必编写有关发布过程基本性质的详细文档；您只需要记录特定于您的项目或团队的内容。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-26T00:35:45.873

[来自Whygitisbetterthanx](http://whygitisbetterthanx.com/#any-workflow)的工作流程模式：

[![带有集成管理器的 alt git 工作流程](https://i.stack.imgur.com/NPJ7f.png)](https://i.stack.imgur.com/NPJ7f.png)
[（来源：[whygitisbetterthanx.com](http://whygitisbetterthanx.com/images/workflow-b.png)）]

要将其扩展到更多的开发人员，您只需在集成管理器和开发人员之间添加另一层“受信任的副手”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-25T22:59:55.323

我已经使用[Darcs在](http://darcs.net/)[Glasgow Haskell Compiler](http://www.haskell.org/ghc)团队工作了几年。我最近（几个月）开始将 git 用于我自己的 repo 副本，以提高性能和提高我的教育水平。

1.  *你如何处理 N 路合并？*

    没有 N 路合并。每个开发人员都发起一个补丁流，并在每个 repo 中一次合并一个流。因此，如果 N 个开发人员同时进行更改，他们将成对合并。

2.  *您是否使用单一的中央权威存储库？*

    绝对地。这是分辨什么是 GHC 什么不是的唯一方法。

3.  *开发人员是否经常相互推拉代码，或者一切都通过中央存储库进行？*

    我认为这取决于您使用的开发人员和 VCS。在 GHC 项目中，我看到的几乎所有拉取和推送都是通过中央存储库进行的。但是有一个重量级（自我管理的）看门人负责推送到中央仓库，如果同事有我*现在*需要的错误修复，我会直接从他或她的仓库中提取它。使用 darcs 很容易只提取一个补丁（而不是 git 中的整个状态），而且我知道在 darcs 方面有更多经验的开发人员使用此功能的次数比我多得多——他们非常喜欢。

    有了`git`，当我与其他开发人员密切合作时，我会经常创建一个新分支，只是为了与其他人共享它。该分支永远不会命中中央回购。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-25T23:37:20.397

相当著名的“技术讲座：Linus Torvalds on git”解释了它是如何用于 Linux 的（与我能想到的团队一样大）

如果我没记错的话，它的用途被比作军事指挥链——每个模块都有一个维护者，负责处理来自开发人员的拉取请求，然后有一些“最受信任”的人负责从模块维护者那里拉取数据到官方 kernel.org git 存储库。

[“Linux：使用 'git' 管理内核源”](http://kerneltrap.org/node/4982)也对此进行了解释，尽管这又不是一个简明的解释。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T22:02:00.727

这是一个示例（绝不是“通用”示例）

我们有中央 VCS（ClearCase 或 SubVersion，取决于不同的项目），我们将它们用于“官方”开发工作（开发、补丁、修复），其中分支的数量有限且明确。

但是，对于涉及大量中间状态的重构开发，没有任何工作，以及许多开发人员需要拥有自己的基于活动的分支或*分支*，一些 Git 存储库以 P2P 方式在这些开发人员之间建立。
一旦工作达到某种 0.1 的稳定性，并且减少了合并，它就会重新导入 VCS，工作可以在其中以“有序”的中心方式进行。

由于[Windows 上的 Git 运行良好](https://stackoverflow.com/questions/783906/git-under-windows-msys-or-cygwin/784743#784743)（MSysGit），我们设法在这种方式下快速完成小的初始开发。

尽管如此，我们仍在评估 Git 以进行全面的项目开发。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-25T04:02:46.757

最好研究一下 linux 内核开发人员的工作方式。他们有一个相当复杂的工作流程，其中从许多来源提交更改，然后每个子系统的受信任开发人员（称为副手）拉入更改，当他们满意时将它们提交给 Linus，Linus 最终要么将它们拉入他的树中，要么拒绝他们。当然它比这更复杂，但这是一个总体概述。

# debugging - 断言式编程的好处

> ID：787643
> 
> 赞同：8
> 
> 时间：2009-04-24T21:30:06.390
> 
> 标签：debugging, assertions

将断言放入我们的代码有什么意义？断言式编程有什么好处？

```
private void WriteMessage(string message)
{
    Debug.Assert(message != null, "message is null");

    File.WriteAllText(FILE_PATH, message);
} 
```

例如，我们可以检查消息变量并在此处抛出异常。为什么我在这里使用断言？或者这是一个看到断言好处的错误例子？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-24T21:37:29.477

他们还支持快速失败的哲学，Jim Shore在[这篇文章中对此进行了解释。](http://www.martinfowler.com/ieeeSoftware/failFast.pdf)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-25T01:01:47.473

有些人会写：

```
/*
 * This can never happen
 */ 
```

写起来更实用：

```
assert(i != -1); 
```

我喜欢使用断言，因为它们很容易通过一个简单的编译时间常数关闭，或者可以用来做其他事情，比如准备错误报告。在发布某些内容时，我通常不会打开断言（至少，不是以通常的方式）。

使用它们使我免于在其他人的计算机上犯非常愚蠢的错误.. 那些喜欢测试我的 alpha 代码的勇敢灵魂。使用它们加上 valgrind 之类的工具有助于确保我在提交之前发现了一些可怕的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T00:27:24.887

要考虑的一个重要区别是您希望使用断言捕获哪些类型的错误。我经常使用断言来捕获编程错误（例如，调用带有空参数的方法）和处理验证错误的不同机制（例如，传递错误长度的社会安全号码）。对于断言捕获的编程错误，我想快速失败。对于验证错误，我希望反应不那么激烈，因为数据中出现错误可能是正常的（例如，用户进行某种数据输入）。在这些情况下，正确的处理可能是将错误报告给用户并继续运行。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T21:37:27.277

如果该方法有一个指定的前提条件来采用非空消息参数，那么您希望程序在前提条件不成立时立即失败，然后必须修复错误的根源。

我相信在开发安全关键型软件时，断言更为重要。当然，您更愿意在正式指定软件时使用断言。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T21:39:30.673

有关断言（以及与代码构造相关的许多其他主题）的精彩讨论，请查看Steve McConnel 的[Code Complete](https://rads.stackoverflow.com/amzn/click/com/0735619670)。他用一整章的时间来有效地使用断言。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-24T22:01:25.923

我使用它们来验证是否为我提供了有效的依赖类。例如，在构造函数 DI 中，您通常接受某种外部类，您依赖这些类来提供某些操作或服务。

所以你可以断言(classRef !- null,"classRef 不能为 null"); 而不是等待您将消息传递给 classRef 并获得其他一些异常，例如异常：访问冲突或同样模棱两可的东西，可能不会立即从查看代码中明显看出。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-01-03T17:24:43.380

测试我们的假设非常有用。断言不断确保不变量成立。简而言之，它用于以下目的，

*   它允许实现**快速故障**系统。
*   由于副作用，它**减少了错误传播。**
*   它禁止（某种健全性检查）系统由于用户数据或后续代码更改而进入不一致状态。

有时，当我们不想使用 try/catch/throw 时，我倾向于使用 assert_return()。

```
private void WriteMessage(string message)
{
    assert_return(message != null, "message is null"); // return when false
    File.WriteAllText(FILE_PATH, message);
} 
```

我建议 assert_return() 通过在测试构建中报告错误来停止应用程序。然后在生产系统中，它应该记录和错误并从函数返回，说它不能这样做。

# java - 在java中通过网络压缩和发送图像？

> ID：787644
> 
> 赞同：1
> 
> 时间：2009-04-24T21:30:19.523
> 
> 标签：java, image, networking, compression

我有一个服务器等待来自客户端的连接，然后使用 Socket 类将图像发送到该客户端。

几个客户端将在短时间内连接，所以我想在发送之前压缩图像。

这些图像是 1000 x 1000 像素的 BufferedImages，我目前发送它们的方法是遍历所有像素并发送该值，然后在另一侧重建它。我怀疑这不是做事的最佳方式。

任何人都可以就压缩和通过网络发送图像的更好方法提供任何建议吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T04:57:20.400

压缩对于课程来说非常重要：哪种方法实际上效果更好取决于您的图像首先来自哪里，以及您的要求是什么（主要是，您是否允许有损压缩，如果允许，您对其施加什么限制）。

首先，**尝试使用 ImageIO.write() 将 JPEG 或 PNG 格式的图像写入 ByteArrayOutputStream**，然后您可以将其生成的字节数组发送到套接字[1]。如果这给你一个可接受的结果，那么它的优势是它几乎不需要开发时间。

如果它们没有给出可接受的结果（因为您不能使用有损压缩或因为 PNG 压缩没有给出可接受的压缩比），那么您可能必须想出一些适合您的数据的自定义内容；在那时候。一天结束时只有您知道您的数据，但一般技术是尝试将您的数据转换为可以与 Deflater 或其他一些标准算法很好地配合使用的形式。因此，例如，使用 deflater 时，您可以转换/重新排序数据，以便重复模式和相似字节的运行可能会彼此靠近。这可能意味着发送所有像素的最高位，然后是所有下一个最高位，等等，如果它们实际上只是噪声，则实际上不发送每个组件的最低位。

不过，希望 JPEG/PNG 选项能够为您提供所需的结果，并且您不必再担心太多。

[1] 抱歉，应该说 - 如果您不需要首先查询长度，那么您显然可以使套接字输出流成为写入图像数据的流，采用哈希码......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T22:01:01.463

JPEG 是有损的，因此如果您需要在另一端完全相同的图像，您可以使用套接字 OutputStream 顶部的 GZIPOutputStream 发送压缩数据，并通过套接字 InputStream 顶部的 GZIPInputStream 在另一端接收它.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T21:41:48.250

很久没有用 Java 做任何图像处理了，但是你可以将图像保存在服务器上为 JPEG，然后给他们发送一个 URI，让他们自己检索。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T22:04:42.843

如果您在 Socket 上使用 getInputStream 和 getOutputStream 方法，请尝试使用 java.util.net.GZIPInputStream 和 java.util.net.GZIPOutputStream 包装流。

# c# - 如何在 Winform 和 C# 中使用 ASP.NET 角色和成员资格

> ID：787648
> 
> 赞同：0
> 
> 时间：2009-04-24T21:31:43.513
> 
> 标签：c#, winforms, roles

我试图在这里转换这个 VB.NET 示例 [http://www.theproblemsolver.nl/usingthemembershipproviderinwinforms.htm](http://www.theproblemsolver.nl/usingthemembershipproviderinwinforms.htm)

没有任何成功，任何人都可以知道一个例子吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-03-16T12:15:03.740

我刚开始接触 C#，我也在尝试开发一个 Windows 窗体应用程序。我正在使用 C# 2010 Express（目标框架 = .NET Framework 4）。这是我转换结果的示例。

程序.cs

```
using System;
using System.Security.Principal;
using System.Web;
using System.Web.Security;

class UserRoles
{

    static void Main(string[] args)
    {
    MembershipCreateStatus result;

    Membership.CreateUser("testuser", "Pass!", "test@test.com", "Hood", "Pine Hills", true, out result);
    Console.WriteLine(result.ToString());

    Roles.CreateRole("Developer");
    Roles.AddUserToRole("testuser", "Developer");

   if (Roles.IsUserInRole("testuser","developer")) 
       Console.WriteLine("Is a developer");
   else
       Console.WriteLine("Doesn't write code.");

    if (Membership.ValidateUser("testuser", "Pass!")) 
       Console.WriteLine("User Validated.");
   else
       Console.WriteLine("User Invalid");

   Console.ReadKey();
    }
} 
```

应用程序配置

```
<?xml version="1.0"?>
<configuration>
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup>

  <system.web>
    <roleManager enabled="true" />
    <membership>
      <providers>
           <remove name="AspNetSqlMembershipProvider"/>
        <add name="AspNetSqlMembershipProvider"
             type="System.Web.Security.SqlMembershipProvider, System.Web,
           Version=2.0.0.0, Culture=neutral,
           PublicKeyToken=b03f5f7f11d50a3a"
             connectionStringName="LocalSqlServer"
             enablePasswordRetrieval="false"
             enablePasswordReset="false"
             requiresQuestionAndAnswer="false"
             applicationName="/"
             requiresUniqueEmail="false"
             passwordFormat="Hashed"
             maxInvalidPasswordAttempts="3"
             minRequiredPasswordLength="4"
             minRequiredNonalphanumericCharacters="1"
             passwordAttemptWindow="10"
             passwordStrengthRegularExpression="" />
      </providers>
    </membership>
  </system.web>  
</configuration> 
```

这些是我试图解决的其他一些链接，但在游戏的这个阶段对我来说更难理解。

[客户应用服务](http://msdn.microsoft.com/en-us/library/bb384339.aspx)

[自定义 Fluent Nhibernate 成员资格和角色提供者](http://www.codeproject.com/Articles/55174/Custom-Fluent-Nhibernate-Membership-and-Role-Provi)

# c# - 强制在主线程上执行代码

> ID：787649
> 
> 赞同：6
> 
> 时间：2009-04-24T21:32:12.890
> 
> 标签：c#, wpf, multithreading

如何强制在我的主线程上执行一段代码？

这就是为什么我想知道：

我有一个自定义创建的消息框，有时会从不是主线程的线程中显示。但是，当调用消息框构造函数时，我得到一个 InvalidOperationException 说“调用线程必须是 STA，因为许多 UI 组件都需要这个。” 这是有道理的，UI 元素需要在主线程上处理。

我的 MessageBox.ShowMessage(...) 函数是一个静态函数，它创建我的自定义消息框的实例并显示它。我可以在 ShowMessage 中放入一些东西来强制创建消息框并在主线程上显示吗？在我的代码的其他地方，我使用 Control.BeginInvoke 来处理类似的问题，但由于它是一个静态函数，因此没有现有的 UI 元素可供我调用 BeginInvoke。

我是否必须使用 Control.BeginInvoke 调用 MessageBox.ShowMessage？我更喜欢从 ShowMessage 中调用 BeginInvoke（或类似的）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T21:36:08.450

这里有几个选项：

*   使第二个线程 STA（您只能为自己执行此操作`Thread`- 不能为`ThreadPool`线程执行此操作） - 通过`.SetApartmentState(ApartmentState.STA);`
*   查看是否[`SynchronizationContext.Current`](http://msdn.microsoft.com/en-us/library/system.threading.synchronizationcontext.current.aspx)为非空；如果是这样，请使用`Send`/`Post`
*   将表单/控件作为[`ISynchronizeInvoke`](http://msdn.microsoft.com/en-us/library/system.componentmodel.isynchronizeinvoke.aspx)实例传递（可能不适用于 WPF - 我不是 100% 确定）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-24T21:36:48.370

你的想法是正确的——为了让它正常工作，你需要从主线程中调用它。

最简单的方法？启动主窗体时，将引用保存在对 ShowMessage() 调用可见的静态变量中。然后，您的 ShowMessage 可以执行标准：

```
if(myForm.InvokeRequired)
{
     myForm.Invoke(() => ShowMessage(arg1,arg2,arg3));
     return;
}
.... other code here.... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T21:55:35.797

不要直接显示消息框，只需向主线程发送一条消息，这会通知主线程显示消息框。

# sql-server-2005 - SQL Server PIVOT 帮助

> ID：787650
> 
> 赞同：1
> 
> 时间：2009-04-24T21:32:15.870
> 
> 标签：sql-server-2005, pivot

源表：

```
Create Table ExamAnswers
{
   StudentID varchar(12),
   QuestionID int,
   Answer char(1)
} 
```

这将充满

```
Bob 1 a
Bob 2 c
...
Bob 100 b
Chris 1 c
Chris 2 d
...
Chris 100 null 
```

等，约500名学生。

Chris 没有完成考试，但是第 100 个问题存储为 null，因此可以保证每个学生正好有 100 行，但实际答案是 null 或字符。

如果有任何区别，答案在 {a,b,c,d,e,f}

此设置非常适合实际的考试应用程序，并且标记它是微不足道的。

现在我有一个报告要求，出于审计目的，我需要生成一个如下所示的表格：

```
ID    1 2 ... 100 
Bob   a c ... b
Chris c d ....null 
```

所以我花了半天时间阅读 PIVOT 功能，我就是不明白。

那一定是我读过的最难以理解的文档。

一方面，它需要和聚合函数——我到底应该在这里聚合什么？

我认为这只是可能存在的 PIVOT 函数的最简单用法，而且我在任何地方都找不到像样的示例。帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T23:57:40.637

看这篇文章： [使用 PIVOT 和 UNPIVOT](http://msdn.microsoft.com/en-us/library/ms177410.aspx)

引用：

```
The following is annotated syntax for PIVOT.

SELECT <non-pivoted column> ,

    [first pivoted column] AS <column name> ,

    [second pivoted column] AS <column name> ,

    ...

    [last pivoted column] AS <column name>

FROM 

    ( <SELECT query that produces the data> ) 

    AS <alias for the source query>

PIVOT 

( 

    <aggregation function>( <column being aggregated> )

FOR 

[<column that contains the values that will become column headers>] 

    IN ( [first pivoted column] , [second pivoted column] ,

    ... [last pivoted column] )

) AS <alias for the pivot table>

<optional ORDER BY clause> 
```

如您所见，必须有聚合函数（正在聚合的列）。因此，表中的答案列必须是整数（十进制等），而不是 char(1)。

编辑： MIN() 和 MAX() 适用于 char() 数据类型。

你的表可以是这样的：

```
Create Table ExamAnswers
(
   StudentID varchar(12) NOT NULL,
   QuestionID int NOT NULL,
   Answer int
) 
```

和 PIVOT 的 SELECT 语句，给出你需要的结果将是：

```
SELECT StudentID, [1] as Q1,  [2] as Q2, [3] as Q3, [4] as Q4, [5] as Q5 
FROM 
(
SELECT StudentID, QuestionID, Answer
FROM dbo.ExamAnswers
) AS piv
PIVOT
(
AVG(Answer)
 FOR QuestionID IN ([1], [2], [3], [4], [5])
) AS chld 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T15:04:27.540

好的解决了。MAX 或 MIN 将作用于 char 字段。所以：

```
Create Table ExamAnswers
{
   StudentID varchar(12),
   QuestionID int,
   Answer char(1)
} 
```

与最初创建的一样

进而

```
SELECT StudentID, [1] as Q1,  [2] as Q2, [3] as Q3, [4] as Q4, [5] as Q5 
FROM 
(
SELECT StudentID, QuestionID, Answer
FROM dbo.ExamAnswers
) AS piv
PIVOT
(
MAX(Answer)
 FOR QuestionID IN ([1], [2], [3], [4], [5])
) AS chld 
```

混淆在于选择没有合乎逻辑的理由聚合任何东西的聚合。我应该提到 StudentID 和 QuestionID 形成一个复合键，因此对于任何给定的 SID 和 QID 对只有一个可能的 Answer 值。

# java - 如何调整 hsqldb/hibernate 应用程序的性能

> ID：787655
> 
> 赞同：5
> 
> 时间：2009-04-24T21:33:50.793
> 
> 标签：java, hibernate, profiling, hsqldb

我有一个使用 Hibernate 和 HSQLDB 进行持久性的开源 Java 应用程序。在我所有的玩具测试中，一切都运行得很快，一切都很好。我有一个客户已经连续运行了几个月的软件，他们的数据库在那段时间里有了很大的增长，性能也逐渐下降。我终于想到数据库可能是问题所在。据我从日志语句中可以看出，服务器中的所有计算都发生得很快，所以这与数据库可能有问题的假设是一致的。

我知道如何对程序进行正常的分析，以找出热点在哪里以及什么占用了大量时间。但是我所知道的所有分析器都会监控程序中的执行时间，并且不会为您提供有关调用外部资源的任何帮助。人们使用什么工具来分析使用外部数据库调用的程序以找出优化性能的地方？

稍微盲目搜索一下已经发现了一些热点——我注意到一个调用，我正在枚举特定类的所有对象以找出是否有任何对象。对标准 [.setMaxResults(1)] 的一行更改将调用从半秒更改为几乎瞬时。我还看到我在单个事务中多次从数据库中提出相同问题的地方。我还没有想出如何缓存答案，但我真正想要的是一个工具来帮助我更系统地寻找这些东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T21:50:09.693

不幸的是，据我所知，没有工具可以做到这一点。

但是您可能需要检查一些事项：

*   您是否使用急切加载而不是延迟加载？根据您的问题描述，看起来您确实没有使用延迟加载...
*   您是否打开并正确配置了二级缓存？包括查询缓存？Hibernate 缓存机制非常强大和灵活。
*   您是否考虑过使用 Hibernate Search？根据您的查询，Apache Lucene 之上的 Hibernate Search Full Text 索引可以加快您的查询速度（因为它的索引系统非常强大）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T22:06:22.993

您在 HSQLDB 中存储了多少数据？我认为它在管理大量数据时表现不佳，因为它只是将所有内容存储在文件中......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-26T07:12:58.913

曾经有一个名为 IronGrid/IronEye/IronTrackSql 的工具可以满足您的需求。不幸的是，他们倒闭了。他们确实在最后一刻开源了他们的产品，但我已经有一段时间找不到源代码或二进制文件了。

我最近一直在使用[YourKit](http://www.yourkit.com/)进行分析，部分原因是你可以让它分析 SQL 时间来找到你调用次数最多的语句和运行时间最长的语句。它不像 IronGrid 那样详细，但它确实为您提供了有价值的信息。在我最新的数据库/休眠调整会话中，问题原来是休眠以及它如何以及何时进行急切与延迟加载，并在选择大量项目时添加一些明智的默认覆盖。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-26T18:06:22.867

这里有很多报道。我有一些结果，并且仍在寻找好的答案。

我找到了一些有用的工具：

[VisualVM](https://visualvm.dev.java.net/)（带有[BTrace](https://btrace.dev.java.net/visualvm_uc.html)或内置 Trace）声称有助于跟踪，但我找不到任何显示方法调用时间的工具。

YourKit 被认为是有用的；我已经申请了开源许可证。

我发现最有用的是 Hibernate 的内置统计信息。如果您 `hibernate.generate_statistics true`在属性中设置，您可以发送`sessionFactory.getStatistics()`并查看有关已存储和检索的对象以及缓存的影响的详细统计信息。我在 qeuryStatistics 中找到了我想要的答案之一，它报告了每个编译的查询、缓存命中和未命中、查询运行的次数、返回的行数以及平均、最大和最小执行时间。这些时间安排清楚地表明了时间的去向。

然后我做了一些关于缓存的阅读。Razenha的建议是正确的。[我现在将他的答案标记为正确。] 我添加`hibernate.cache.use_query_cache true`到我的属性中，并添加`query.setCacheable(true);`到我的大多数查询中。我还添加`<cache usage="read-write"/>`了一些 .hbm.xml 文件。现在我的大部分统计数据都显示缓存命中占主导地位，并且性能要好得多。

我仍然想要一些工具来帮助我跟踪执行时间，这样我就可以解决最严重的问题而不是最明显的问题，但这是一个很大的帮助。也许上面的跟踪工具之一会有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-11T07:18:55.990

在 Terracotta 3.1 中，您可以使用 Terracotta Developer Console 实时监控所有这些统计数据。您可以查看缓存统计信息的历史图表，并查看集群范围内或每个节点的休眠统计信息或缓存统计信息。

Terracotta 是开源的。更多细节和下载在[Terracotta for Hibernate](http://www.terracotta.org/web/display/orgsite/Hibernate)。

# c# - 最高效的媒体播放器内部数据库

> ID：787659
> 
> 赞同：2
> 
> 时间：2009-04-24T21:35:45.110
> 
> 标签：c#, .net, database

我目前正在学习 C# 和 .NET（来自 UNIX 背景），并且刚刚开始编写媒体播放器。我希望对存储歌曲内部数据库的最佳方式提出一些建议。SQL？某种文本文件？我在这方面没有任何经验，所以所有的点都会非常感激。

干杯!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T21:39:55.100

您可能应该使用 SQLite，并且可以在其上使用 LINQ 以充分利用 C# 3.5。

[http://www.codeproject.com/KB/linq/linqToSql_7.aspx](http://www.codeproject.com/KB/linq/linqToSql_7.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T21:42:50.990

还有 SQL Server Compact。Linq to Sql 也适用于此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T21:45:57.410

这里涉及到一系列要求，仅举几例：

*   多用户？
*   预期尺寸
*   你也想存储多媒体二进制文件吗？

对于复杂的结构化数据文本文件不会做得很好。

用于存储二进制文件，我不会使用 XML

所以它可能会是：使用什么 Sql 数据库？您可以搜索有关 SQLite、Sql Express、SqlCE 等的讨论。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T22:06:09.220

在我们继续推荐一种技术而不是另一种技术之前，可能应该问一个更基本的问题......

建筑学。从上面的简要描述来看，您正在构建的似乎是一个类似于 Windows Media Player 库的功能。如果是这种情况，SQL 数据库的建议可能看起来很合适，但是文件系统同步的复杂性（你不打算将要播放的媒体文件变成一个单一的数据存储，是吗？）

如果您只担心持久播放列表......基于文本的格式似乎是合适的。

播放列表可能希望是基于文本的（对我来说，它包括对象图的 XML 表示），但库信息似乎希望位于更健壮、更可查询的数据存储中。

对象数据库也可能是合适的，因为与其他建议相比，它可以让您使用更透明的持久性视图。在学习的同时隔离您正在处理的新主题的数量可能是管理学习曲线的重要方法。db4o 有一个我最近没有看过的 .Net 变体。

# visual-c++ - VC++ 2005 项目选项是否包含 stl？

> ID：787678
> 
> 赞同：1
> 
> 时间：2009-04-24T21:41:27.937
> 
> 标签：visual-c++, visual-studio-2005, stl

我正在开发一个使用 STL 的跨平台项目。其他编译器默认包含 STL 支持，但在 VS2005 中，我需要在使用 STL 项的类定义之前添加以下内容：

```
#include <cstdlib>
using namespace std; 
```

是否有 VS2005 选项可以自动设置？解决这个问题有点乏味。我只是想在源代码中避免大量#ifdefs -

**编辑：**另一个编译器是 ARM 926x 系列的 IAR 工作台。也许我应该让他们明确地做包含？

还有 - “std::map<>” 比“using namespace std; map<>” 更受欢迎吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T21:48:10.450

*所有编译器*都应该要求您包含这些行。如果他们不这样做，那么他们只是在鼓励您编写不可移植的代码，因为您依赖于自动包含某些标头，并且您依赖于某些名称隐含在范围内。

不过，我并不是说应该始终需要这两行。我的意思是，如果编写其余代码以使用*cstdlib*标头和`std`命名空间中声明的内容，那么这两行*需要*首先出现，并且编译器不应表现得好像它们确实存在不。

检查您的其他编译器是否有一些设置来禁用此隐式代码。如果没有，那么它可能是一个非常非常古老的编译器，您应该考虑不再使用它并且不再支持它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T21:45:10.220

尝试通过命名空间限定名称（即 std::vector）引用 STL 组件。

做一个全局的“使用命名空间标准”通常是个坏主意。

或者也许我不明白这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T22:14:27.407

IAR 编译器不支持`std`命名空间（我不知道为什么，因为如果我没记错的话，它通常支持命名空间）。

如果您查看 IAR 的运行时标头，您会发现他们做了一些宏操作来解决这个问题（运行时是从 Dinkumware 获得许可的，它为很多编译器提供运行时）。

如果你想让你的东西在多个环境中工作，你可能需要做类似的事情。一个可能的更简洁的替代方法是只包含“ `using namespace std;`”指令。我可能错了，但我认为 IAR 编译器基本上忽略了它（它不介意您使用的是它不知道的命名空间）。很多人会认为这很丑陋，但有时你必须做你所拥有的编译器想要你做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T22:25:11.607

一般来说，您应该避免“使用命名空间 X”，尤其是在头文件中（因为包含您的头文件的每个人也都会获得该命名空间，无论他们是否想要它），尤其是对于命名空间 std（因为它太大并且可能发生名称冲突很大）。

相反，在头文件中以完全限定的形式引用名称，例如：

```
// for plain functions
void foo(std::map<int> intMap);

// for classes
class person {
    std::string name_;
  public:
    person(std::string name);
    // ...
}; 
```

然后，在代码文件中，您可以“使用”，但更喜欢使用命名空间中的特定项目，而不是拉入整个命名空间。例如：

```
using std::map;
using std::string;

void foo(map<int> intMap) { ... };
person::person(string name) : name_(name) { ... }; 
```

等等。这样你就可以避免影响其他人，包括你的标题，并且避免引入可能导致与其他内容冲突的数以亿计的名称。

# php - 如何遍历包含从 MySQL 返回的数据的 PHP 数组？

> ID：787681
> 
> 赞同：2
> 
> 时间：2009-04-24T21:42:33.083
> 
> 标签：php, sql, loops

好的，我有一个包含几个字段的表。其中一个字段是`username`. 很多时候`username`是相同的，例如：

1.  *   用户名：鲍勃
    *   密码：鲍勃
    *   报告：1
2.  *   用户名：鲍勃
    *   密码：鲍勃
    *   报告：2

我做了一个 SQL 语句，`select * where username='bob';`但是当我执行以下 PHP 函数时，它只会返回最后一个结果：

```
$thisrow = mysql_fetch_row($result); 
```

我需要从每一行中获取每个字段。我该怎么做呢？

```
$mainsection="auth"; //The name of the table
$query1="select * from auth where username='$user'"; 
$result = mysql_db_query($dbname, $query1) or die("Failed Query of " . $query1);  //do the query
$thisrow=mysql_fetch_row($result);
echo "Study: " . $thisrow[1] . " - " . $thisrow[5]; 
```

对不起这么愚蠢的问题。我似乎无法让`while`不止一个领域的循环为我的生活工作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-24T21:45:20.643

`mysql_fetch_row`一次获取每一行。为了检索多行，您将使用这样的`while`循环：

```
while ($row = mysql_fetch_row($result))
{
    // code
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T21:48:06.580

使用循环，并使用`mysql_fetch_array()`而不是行：

```
while($row = mysql_fetch_array($result)) {
   echo "Study: " . $row[1] . " - " . $row[5];
   // but now with mysql_fetch_array() you can do this instead of the above
   // line (substitute userID and username with actual database column names)...
   echo "Study: " . $row["userID"] . " - " . $row["username"];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T22:06:19.920

我建议您阅读以下内容： [http](http://www.w3schools.com/php/php_mysql_select.asp) ://www.w3schools.com/php/php_mysql_select.asp 它将为您提供有关如何正确连接到 mysql、收集数据等的概述

对于您的问题，您应该使用循环：

```
while ($row = mysql_fetch_row($result)){//code} 
```

正如htw所说

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-24T22:08:26.407

您还可以像这样获取表中所有行的计数：

```
 $count = mysql_fetch_array(mysql_query("SELECT COUNT(*) AS count FROM table"));
    $count = $count["count"]; 
```

您还可以在上面的选择中附加一个普通的 WHERE 子句，并且只计算符合特定条件的行（如果需要）。然后你可以使用你的循环计数：

```
    $data = mysql_query("SELECT * WHERE username='bob'");
    对于 ($i = 0; $i
```

此外，mysql_fetch_array() 通常更易于使用，因为它将数据存储在关联数组中，因此您可以使用行名访问数据，而不是使用数字索引。

编辑：我的第二个代码块在发布后没有显示所有内容，出现了某种错误或某些事情。它在预览中显示良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T04:51:35.983

我喜欢将数据库逻辑与显示分开。我通常将我的结果放入一个可以在 HTML 代码中调用的数组中。纯属个人喜好；但这是我解决问题的方法：（我将 $sql 从生产中的错误消息中删除）

 `````
<?php
$sql="
  SELECT *
  FROM auth
  WHERE username='$user';
  ";
$result = mysql_query($sql)
  or die("Failed Query : ".mysql_error() . $sql);  //do the query

while ($ROW = mysql_fetch_array($result,MYSQL_ASSOC)) {
  $USERS[] = $ROW;
}
?>

HTML CODE

<? foreach ($USERS as $USER) { ?>

Study: <?=$USER['dbFieldName'];?> - <?=$USER['dbFieldName2'];?>

<? } //foreach $USER ?> 
````  `* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T05:12:08.960

$qry=mysql_query(select * where username='bob');

如果（mysql_num_rows（$qry））

{

```
 while($row=mysql_fetch_array($qry,MSQL_NUM))

 {

        echo $row[0]."&nbsp;&nbsp;".$row[1]."&nbsp;&nbsp;".$row[2]."<br>";

 } 
```

}

# wcf - WCF 和 PrincipalPermission

> ID：787683
> 
> 赞同：1
> 
> 时间：2009-04-24T21:42:53.253
> 
> 标签：wcf, security, authentication, windows-identity, principalpermission

我有许多服务将在 NT Authority\System 的安全上下文中作为 Windows 服务运行（这些服务是基于 NetTCP 的）。Active Directory 中存储的六个组将被允许访问这些服务：

用户 代理 审批者 管理员（三级管理员）

我知道我可以使用 ServiceSecurityContext.Current.WindowsIdentity.Name 获取连接到服务的用户。

我需要做的是在业务层中验证传入的用户上下文是否能够访问特定服务，并且我希望它遵循我公司支持的旧应用程序，该应用程序使用 PrincipalPermission 传递它一个角色并使用确保访问的 Demand() 方法。

我想我最初的问题是，如果我将 ServiceSecurityContext 用户名和相关角色（组）传递给 PrincipalPermission，它是否会自动知道在幕后点击 Active Directory，因为该服务是在同一域上的 AD 帐户的上下文中运行的？或者有什么特别的事情我应该做的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T21:45:31.813

对，当你要求一个角色时，它会调用 IPrincipal.IsInRole。这将使用主体拥有的任何实现。所以，如果它设置为 Windows，它会做所有的工作来命中 AD。

# build-process - 从 Makefile 设置 LD_LIBRARY_PATH

> ID：787684
> 
> 赞同：18
> 
> 时间：2009-04-24T21:43:49.553
> 
> 标签：build-process

如何从 Makefile 设置 LD_LIBRARY_PATH 环境变量？

我有一些链接到共享库的源代码，而共享库又链接到不同的共享库（超过 1 个）。用于构建应用程序的 Makefile 只知道第一个共享库。

如果我想构建它，我必须指定：（ `#export LD_LIBRARY_PATH=/path/to/the/shared/libs`对于 bash）并且效果很好。

但是，我想从 Makefile 本身执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-26T06:26:22.473

是的，“export”是正确使用的指令。它在[此处](http://www.gnu.org/software/make/manual/make.html#Variables_002fRecursion)详细记录。这与 make 本身用于将变量传播到子 make 的机制相同。缺点是您不能有选择地将变量传递给某些命令而不是其他命令。

我能想到的还有两个选择：

*   使用`.EXPORT_ALL_VARIABLES`（在某处指定为目标）会导致所有变量都导出到子命令的环境中。
*   在命令行中指定：

    ```
    foo:
        EXPORTEDVAR=somevalue gcc $< -o $@ 
    ```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-05-02T13:54:03.837

如果您不想在 makefile 中导出 LD_LIBRARY_PATH 变量（例如，因为您有所有添加到变量中的递归 Makefile），您可以将其绑定到对编译器和链接器的所有调用。

您可以将其直接添加到目标规则中的所有 gcc 和 ld 调用中，例如

```
my_target: my_target.o
    LD_LIBRARY_PATH=/my/library/path gcc -o my_target my_target.o 
```

或者您设置定义编译器的全局 make 变量包括路径，例如：

```
 CC=LD_LIBRARY_PATH=/my/library/path gcc
 CPP=LD_LIBRARY_PATH=/my/library/path gcc
 CXX=LD_LIBRARY_PATH=/my/library/path gcc 
```

我选择 gcc 作为编译器，当然你可以使用任何你喜欢的编译器。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-06-15T17:17:01.613

我有同样的问题，我必须像你一样导出 LD_LIBRARY_PATH ：

```
export LD_LIBRARY_PATH=/path/to/the/shared/libs ; my_command 
```

当 LD_LIBRARY_PATH 仅适用于一个命令时，我的朋友向我展示了另一种选择，请注意下面没有分号。

```
LD_LIBRARY_PATH=/path/to/the/shared/libs my_command 
```

这篇[文章](https://unix.stackexchange.com/questions/56444/how-do-i-set-an-environment-variable-on-the-command-line-and-have-it-appear-in-c)解释更多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-24T21:49:06.857

我曾尝试添加：

```
export LD_LIBRARY_PATH=/path/to/the/shared/libs 
```

这显然工作正常。

我收到错误是因为我的 /path/to/the/shared/libs 不正确。

仍然很高兴知道其他人为此做了什么和/如果有更好的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-07-07T18:59:31.287

如果你想为特定的 make 设置 LD_LIBRARY_PATH，试试这个 LD_LIBRARY_PATH=/path/to/the/shared/libs make。

# ruby-on-rails - 如何停止 ActiveRecord 查找表？

> ID：787691
> 
> 赞同：1
> 
> 时间：2009-04-24T21:46:44.337
> 
> 标签：ruby-on-rails, activerecord

我正在尝试创建一个没有表格的名为“搜索”的 ActiveRecord 模型。当我执行@search = Search.new 时，我不断收到此错误。

sql::Error: 表 'searchdemo_development.tablelesses' 不存在：SELECT * FROM`tablelesses`

我正在使用此评论中的想法：[Rails model without database](https://stackoverflow.com/questions/315850/rails-model-without-database/318919#318919)。我在做基本操作时也遇到了同样的错误：

```
class Search < ActiveRecord::Base

end 
```

如何让 ActiveRecord 停止查找表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T16:21:52.510

我可以想到一些你*可能*想做这样的事情的原因。也许您想在 ActiveRecord 上利用一些与数据库无关的方法，或者您想将您的对象传递给期望的对象和 ActiveRecord 实例。如果没有更多信息，就不可能说在这里使用 AR 的选择是正确的还是错误的。

无论如何，如果你想继续走这条路……

看看这个 Railscast [http://railscasts.com/episodes/121-non-active-record-model](http://railscasts.com/episodes/121-non-active-record-model)

并检查这个宝石：http: [//github.com/kennethkalmer/activerecord-tableless-models/tree/master](http://github.com/kennethkalmer/activerecord-tableless-models/tree/master)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T21:53:04.377

为什么以主的名义，您想要一个没有表的活动记录模型？活动记录模型的目的是与数据库进行通信。我假设没有数据库表就不可能有一个活动记录模型。

也许你想要一堂普通的课？

```
class Search
  # your methods here
end 
```

# php - 是否可以在 PHP 中重载运算符？

> ID：787692
> 
> 赞同：67
> 
> 时间：2009-04-24T21:46:53.523
> 
> 标签：php, operator-overloading

具体来说，我想创建一个 Array 类并想重载 [] 运算符。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2009-04-24T22:06:01.497

如果您使用的是 PHP5（并且应该使用），请查看[SPL ArrayObject](http://us3.php.net/manual/en/class.arrayobject.php)类。文档不太好，但我认为如果你扩展 ArrayObject，你就会有你的“假”数组。

编辑：这是我的快速示例；恐怕我没有有价值的用例：

```
class a extends ArrayObject {
    public function offsetSet($i, $v) {
        echo 'appending ' . $v;
        parent::offsetSet($i, $v);
    }
}

$a = new a;
$a[] = 1; 
```

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2011-12-15T09:06:42.430

其实最优方案是实现ArrayAccess接口的四个方法：http: [//php.net/manual/en/class.arrayaccess.php](http://php.net/manual/en/class.arrayaccess.php)

如果您还想在“foreach”的上下文中使用您的对象，则必须实现“迭代器”接口： [http ://www.php.net/manual/en/class.iterator.php](http://www.php.net/manual/en/class.iterator.php)

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-04-24T22:00:57.250

PHP 的重载和运算符概念（请参阅[重载](http://php.net/manual/en/language.oop5.overloading.php)和[数组运算符](http://php.net/manual/en/language.operators.array.php)）与 C++ 的概念不同。我不相信有可能重载 +、-、[] 等运算符。

**可能的解决方案**

*   实现[SPL ArrayObject](http://php.net/manual/en/class.arrayobject.php)（如[cbeer 所述](https://stackoverflow.com/users/87380/cbeer)）。
*   实现[迭代器](http://php.net/manual/en/class.iterator.php)（如果`ArrayObject`对你来说太慢了）。
*   使用[PECL 运算符](http://pecl.php.net/package/operator)扩展（如[Benson](https://stackoverflow.com/users/13816/benson)所述）。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2014-06-03T09:09:19.147

对于 PHP 5.0+ 中的简单干净的解决方案，您需要实现[`ArrayAccess`接口](https://www.php.net/manual/en/class.arrayaccess.php)并覆盖函数 offsetGet、offsetSet、offsetExists 和 offsetUnset。您现在可以像使用数组一样使用该对象。

示例（在 PHP7+ 中）：

```
<?php
class A implements ArrayAccess {
    private $data = [];

    public function offsetGet($offset) {
        return $this->data[$offset] ?? null;
    }

    public function offsetSet($offset, $value) {
        if ($offset === null) {
            $this->data[] = $value;
        } else {
            $this->data[$offset] = $value;
        }
    }

    public function offsetExists($offset) {
        return isset($this->data[$offset]);
    }

    public function offsetUnset($offset) {
        unset($this->data[$offset]);
    }
}

$obj = new A();
$obj[] = 'a';
$obj['k'] = 'b';
echo $obj[0], $obj['k']; // print "ab" 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-24T22:02:16.110

它似乎不是该语言的功能，请参阅此[错误](http://bugs.php.net/bug.php?id=9331)。但是，看起来有一个[包](http://pecl.php.net/package/operator)可以让您进行某种重载。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-25T02:45:54.600

简单地说，不；我建议如果你认为你需要 C++ 风格的重载，你可能需要重新考虑你的问题的解决方案。或者也许考虑不使用 PHP。

套用 Jamie Zawinski 的话说，“你有一个问题并想，'我知道！我将使用运算符重载！' 现在你有两个问题。”

# java - JPA Hibernate 一对一关系

> ID：787698
> 
> 赞同：62
> 
> 时间：2009-04-24T21:48:53.690
> 
> 标签：java, hibernate, jpa

我有一对一的关系，但是 hibernatetool 在生成模式时会抱怨。这是一个显示问题的示例：

```
@Entity
public class Person {
    @Id
    public int id;

    @OneToOne
    public OtherInfo otherInfo;

    rest of attributes ...
} 
```

Person 与 OtherInfo 是一对一的关系：

```
@Entity
public class OtherInfo {
    @Id
    @OneToOne(mappedBy="otherInfo")
    public Person person;

    rest of attributes ...
} 
```

人拥有 OtherInfo 的一面。OtherInfo 是拥有方，因此 person 用于`mappedBy`在 Person 中指定属性名称“otherInfo”。

使用 hibernatetool 生成数据库架构时出现以下错误：

```
org.hibernate.MappingException: Could not determine type for: Person, at table: OtherInfo, for columns: [org.hibernate.mapping.Column(person)]
        at org.hibernate.mapping.SimpleValue.getType(SimpleValue.java:292)
        at org.hibernate.mapping.SimpleValue.createIdentifierGenerator(SimpleValue.java:175)
        at org.hibernate.cfg.Configuration.iterateGenerators(Configuration.java:743)
        at org.hibernate.cfg.Configuration.generateDropSchemaScript(Configuration.java:854)
        at org.hibernate.tool.hbm2ddl.SchemaExport.<init>(SchemaExport.java:128)
        ... 
```

知道为什么吗？我做错了什么还是这是一个休眠错误？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-04-25T13:45:44.547

JPA 不允许在*OneToOne*或*ManyToOne*映射上使用*@Id*注释。**您正在尝试做的是与共享主键**的一对一实体关联。最简单的情况是与共享密钥的单向一对一：

 ****```
@Entity
public class Person {
    @Id
    private int id;

    @OneToOne
    @PrimaryKeyJoinColumn
    private OtherInfo otherInfo;

    rest of attributes ...
} 
```

这样做的主要问题是 JPA 不支持在*OtherInfo*实体中生成共享主键。Bauer 和 King的经典书籍[Java Persistence with Hibernate](https://rads.stackoverflow.com/amzn/click/com/1932394885)使用 Hibernate 扩展给出了以下解决方案：

```
@Entity
public class OtherInfo {
    @Id @GeneratedValue(generator = "customForeignGenerator")
    @org.hibernate.annotations.GenericGenerator(
        name = "customForeignGenerator",
        strategy = "foreign",
        parameters = @Parameter(name = "property", value = "person")
    )
    private Long id;

    @OneToOne(mappedBy="otherInfo")
    @PrimaryKeyJoinColumn
    public Person person;

    rest of attributes ...
} 
```

另外，请参见[此处](http://en.wikibooks.org/wiki/Java_Persistence/Identity_and_Sequencing#Primary_Keys_through_OneToOne_Relationships)。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2012-08-27T10:48:17.033

这也应该使用 JPA 2.0 @MapsId 注释而不是 Hibernate 的 GenericGenerator：

```
@Entity
public class Person {

    @Id
    @GeneratedValue
    public int id;

    @OneToOne
    @PrimaryKeyJoinColumn
    public OtherInfo otherInfo;

    rest of attributes ...
}

@Entity
public class OtherInfo {

    @Id
    public int id;

    @MapsId
    @OneToOne
    @JoinColumn(name="id")
    public Person person;

    rest of attributes ...
} 
```

在 Hibernate 4.1 文档中的 5.1.2.2.7 节下有更多详细信息。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-10-10T07:33:49.580

您只需要添加`@JoinColumn(name="column_name")`到 Host Entity 关系。column_name 是 person 表中的数据库列名。

```
@Entity
public class Person {
    @Id
    public int id;

    @OneToOne
    @JoinColumn(name="other_info")
    public OtherInfo otherInfo;

    rest of attributes ...
} 
```

Person 与 OtherInfo 是一对一的关系： mappedBy="var_name" var_name 是 Person 类中 otherInfo 的变量名。

```
@Entity
public class OtherInfo {
    @Id
    @OneToOne(mappedBy="otherInfo")
    public Person person;

    rest of attributes ...
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-25T06:12:36.320

我认为您仍然需要 OtherInfo 类中的主键属性。

```
@Entity
public class OtherInfo {
    @Id
    public int id;

    @OneToOne(mappedBy="otherInfo")
    public Person person;

    rest of attributes ...
} 
```

此外，您可能需要将 @PrimaryKeyJoinColumn 注释添加到映射的另一侧。我知道 Hibernate 默认使用这个。但是后来我没有使用 JPA 注释，这似乎需要您指定关联如何工作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-05-19T16:24:27.213

我有一个更好的方法来做到这一点：

```
@Entity
public class Person {

    @OneToOne(cascade={javax.persistence.CascadeType.ALL})
    @JoinColumn(name = "`Id_OtherInfo`")
    public OtherInfo getOtherInfo() {
      return otherInfo;
    }

} 
```

就这样

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-24T21:55:25.453

我不确定您是否可以在 Hibernate 中将关系用作 Id/PrimaryKey。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-25T05:40:14.760

尝试这个

```
@Entity

@Table(name="tblperson")

public class Person {

public int id;

public OtherInfo otherInfo;
@Id //Here Id is autogenerated
@Column(name="id")
@GeneratedValue(strategy=GenerationType.AUTO)
public int getId() {
    return id;
}
public void setId(int id) {
    this.id = id;
}

@OneToOne(cascade = CascadeType.ALL,targetEntity=OtherInfo.class)
@JoinColumn(name="otherInfo_id") //there should be a column otherInfo_id in Person
public OtherInfo getOtherInfo() {
    return otherInfo;
}
public void setOtherInfo(OtherInfo otherInfo) {
    this.otherInfo= otherInfo;
}
rest of attributes ...
}

@Entity

@Table(name="tblotherInfo")

public class OtherInfo {

private int id;

private Person person;

@Id

@Column(name="id")
@GeneratedValue(strategy=GenerationType.AUTO)
public Long getId() {
    return id;
}
public void setId(Long id) {
    this.id = id;
}

  @OneToOne(mappedBy="OtherInfo",targetEntity=Person.class)   
public College getPerson() {
    return person;
}
public void setPerson(Person person) {
    this.person = person;
}    
 rest of attributes ...
} 
```

# java - 如何使 2 个整数的除法产生一个浮点数而不是另一个整数？

> ID：787700
> 
> 赞同：175
> 
> 时间：2009-04-24T21:50:06.637
> 
> 标签：java

在另一个 Bruce Eckels 计算速度的练习中，`v = s / t`其中 s 和 t 是整数。我该如何做到这一点，以便部门产生浮动？

```
class CalcV {
  float v;
  float calcV(int s, int t) {
    v = s / t;
    return v;
  } //end calcV
}

public class PassObject {

  public static void main (String[] args ) {
    int distance;
    distance = 4;

    int t;
    t = 3;

    float outV;

    CalcV v = new CalcV();
    outV = v.calcV(distance, t);

    System.out.println("velocity : " + outV);
  } //end main
}//end class 
```

* * *

## 回答 #1

> 赞同：349
> 
> 时间：2009-04-24T21:53:11.140

只需先将两个操作数之一转换为浮点数。

```
v = (float)s / t; 
```

演员表的优先级高于除法，因此发生在除法之前。

编译器将有效地自动将另一个操作数转换为浮点数，因为规则说如果任何一个操作数是浮点类型，那么该操作将是浮点操作，即使另一个操作数是整数。 [Java 语言规范，§4.2.4](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.2.4)和[§15.17](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.17)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-04-24T21:53:32.323

尝试：

```
v = (float)s / (float)t; 
```

将整数转换为浮点数将允许进行浮点除法。

不过，你真的只需要投一个。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-24T21:53:53.540

将其中一个整数转换为浮点数以强制使用浮点数学来完成操作。否则整数数学总是首选。所以：

```
v = (float)s / t; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-04-24T11:26:13.050

为了减少对代码可读性的影响，我建议：

```
v = 1d* s/t; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-04-24T21:53:23.370

您可以将分子或分母转换为浮动...

int 操作通常返回 int，因此您必须更改其中一个操作数。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-04-24T21:54:28.797

您甚至可以只转换其中一个，但为了保持一致性，您可能需要明确地转换两者，这样 v = (float)s / (float)t 应该可以工作。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-04-14T04:19:22.083

将整数之一/两个整数强制转换为浮点数以强制使用浮点数学来完成操作。否则整数数学总是首选。所以：

```
1\. v = (float)s / t;
2\. v = (float)s / (float)t; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-02-15T15:09:02.380

**JLS 标准**

[JLS 7 15.17.2。除法运算符 /](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.17.2)说：

> 整数除法向 0 舍入。也就是说，在二进制数值提升（第 5.6.2 节）之后为整数的操作数 n 和 d 产生的商是一个整数值 q，其幅值尽可能大，同时满足 |d · q|。≤ |n|。此外，当 |n| 时 q 为正 ≥ |d| 并且 n 和 d 具有相同的符号，但是当 |n| 时 q 为负 ≥ |d| n 和 d 符号相反。

这就是为什么`1/2`不给出浮点数的原因。

[因为15.17.](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.17)将任何一个转换为浮动`(float)1/2`就足够了。[乘法运算符](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.17)说：

> 对操作数执行二进制数字提升

和[5.6.2。二进制数字促销](http://docs.oracle.com/javase/specs/jls/se7/html/jls-5.html#jls-5.6.2)说：

> *   如果任一操作数是 double 类型，则另一个操作数将转换为 double。
> *   否则，如果任一操作数为浮点类型，则将另一个转换为浮点

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-06-27T18:07:04.123

尝试这个：

```
class CalcV 
{
      float v;
      float calcV(int s, int t)
      {
          float value1=s;
          float value2=t;
          v = value1 / value2;
          return v;
      } //end calcV
} 
```

# python - Python 嵌入——如何从 C/C++ 中获取 if() 真值测试行为？

> ID：787711
> 
> 赞同：2
> 
> 时间：2009-04-24T21:55:15.797
> 
> 标签：python, embedded-language

我正在尝试编写一个函数来返回给定 PyObject 的真值。此函数应返回与 if() 真值测试相同的值——空列表和字符串为 False，等等。我一直在查看 python/include 标头，但没有发现任何似乎这样做的东西。我最接近的是 PyObject_RichCompare() ，其中 True 作为第二个值，但是对于“1”== True 返回 False 。是否有一个方便的功能可以做到这一点，或者我必须针对一系列类型进行测试并为每种可能的类型进行特殊情况测试？if() 的内部实现是做什么的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T22:00:07.550

这不是吗，在 object.h 中：

```
PyAPI_FUNC(int) PyObject_IsTrue(PyObject *); 
```

?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T22:12:23.557

采用

`int PyObject_IsTrue(PyObject *o)`
如果对象 o 被认为为真，则返回 1，否则返回 0。这相当于 Python 表达式 not not o。失败时，返回-1。

（来自[Python/C API 参考手册](http://docs.python.org/c-api/object.html)）

# javascript - 使用 Rails button_to_function 时向 js 函数传递一个值

> ID：787716
> 
> 赞同：2
> 
> 时间：2009-04-24T21:56:06.857
> 
> 标签：javascript, jquery, ruby-on-rails

我有一个我称之为资源的表，当用户连续单击按钮时，希望在 jquery 对话框中显示特定记录。

在我正在做的表中：

```
<td><%=button_to_function 'Show','showresource1()',:class =>"ui-button ui-state-default ui-corner-all", :id => resource.id %></td> 
```

然后在javascript中我想将resource.id传递给jQuery对话框并打开对话框：

```
<script type="text/javascript" charset="utf-8">
  function showresource1()
  {
    jQuery("#resource_details").load( 'http://localhost:3000/resources/show/4').dialog('open');    
  }
</script> 
```

我可以打开对话框并加载这个静态 URL，但我很难将 resource.id 从 button_to_function 传递到 js 函数。

button_to_function 是正确的方法吗？如果是，我如何获取在 js 中定义的 URL？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T10:37:35.750

它应该像下面的代码

```
<% for res_id in ids %>
<%=button_to_function "Show", "show_resource('#{res_id}')" %>
<% end %>

<script type="text/javascript" charset="utf-8">
  function show_resource(res_id)
  {
    jQuery("#resource_details").load( 'http://localhost:3000/resources/show/' + res_id).dialog('open');
  }
</script> 
```

# coding-style - 学习正确的编程风格？

> ID：787718
> 
> 赞同：5
> 
> 时间：2009-04-24T21:57:12.283
> 
> 标签：coding-style

在哪里可以找到关于什么被认为是正确的编程伦理或如何格式化代码、注释甚至变量名的方法的信息或只是相当好的想法，以便以后更容易阅读代码？

谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-04-24T21:59:31.717

[Code Complete 2](http://www.cc2e.com/)一书是良好编码实践的永恒参考。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-04-24T22:03:22.003

绝对的“必读”是[Robert C. Martin 的书 Clean Code](https://rads.stackoverflow.com/amzn/click/com/0132350882)。一定要试一试。它提出了一些很棒的观点。自从我 6 个月前购买它以来，我一直向所有人推荐。

**编辑**

我认为阅读[我的亚马逊评论](http://www.amazon.co.uk/review/R3V1L3L23H85II/ref=cm_cr_rdp_perm)会有所帮助:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T22:01:03.820

您要求的是特定于语言的编码标准。

对于 C#，请查看[IDesign C# 编码标准](http://www.idesign.net/idesign/DesktopDefault.aspx)（在页面中间的屏幕右侧）

对于一般的 .NET，请参阅[开发类库的设计指南](http://msdn.microsoft.com/en-us/library/ms229042.aspx)

对于 C++ 检查[这里](http://www.possibility.com/Cpp/CppCodingStandard.html)

对于 Java，请参阅 Sun 的[JavaTM 编程语言的资源代码约定](http://java.sun.com/docs/codeconv/html/CodeConvTOC.doc.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-24T22:13:43.430

对于 C++，我使用[C++ google style guide](http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T22:20:51.010

包括 Code Complete 和 Clean Code 我建议您阅读“实用程序员”和“Ship it！”。最后提到的书并没有太多关于如何格式化代码、注释等。而是关于开发人员和开发的最佳实践。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T06:55:06.530

我认为对于开始 OO 程序员来说必不可少的三本书。

1.  “重构：改进现有代码的设计”。

尽管现代 IDE 通常支持自动重构，但这本书仍然很有用。通过了解特定重构背后的原因（或代码味道），您可以努力在第一时间编写正确的代码。

2.  《务实的程序员》

丰富的最佳实践。

3.  “设计模式”

最先进的书，但仍然有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-25T07:04:38.770

Clean Code 无疑是一本好书。如果您想要一本更具体的 .NET 书籍，我推荐Martin 的*C# 中的敏捷原则、模式和实践。*

# iis-7 - iis 7 部署现有站点的新版本

> ID：787720
> 
> 赞同：0
> 
> 时间：2009-04-24T21:59:54.460
> 
> 标签：iis-7

我想自动化部署现有站点的新版本的过程，并允许我轻松地返回到站点的先前版本。到目前为止，我一直在将我的新版本复制到生产服务器，并将其放入一个文件夹中，并带有与之关联的版本号。通过 IIS 用户界面，我将停止站点，然后更改站点上的物理路径，将其指向我的新版本。如果出于某种原因我需要撤消更改，我只需返回 IIS 并停止该站点并将其指向以前的构建。

我知道在哪里可以使用 appcmd 来停止和启动站点。我只是找不到任何方法来更改站点上的物理路径属性。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-24T22:18:19.113

您可能可以使用 powershell [Intro to Power Shell for IIS7](http://learn.iis.net/page.aspx/161/an-introduction-to-windows-power-shell-and-iis7/)

编辑：[此页面](http://learn.iis.net/page.aspx/433/powershell-snap-in-creating-web-sites-web-applications-virtual-directories-and-application-pools/)包含使用 powershell 在 IIS 中创建网站和应用程序的示例。

根据样本，它应该是这样的：

```
Set-ItemProperty IIS:\sites\DemoSite\DemoApp -physicalPath C:\DemoSite\DemoApp -type Application 
```

# postgresql - PostgreSQL 自动增量

> ID：787722
> 
> 赞同：663
> 
> 时间：2009-04-24T22:00:42.133
> 
> 标签：postgresql, auto-increment

我正在从 MySQL 切换到 PostgreSQL，并且想知道如何执行自动增量值。我在 PostgreSQL 文档中看到了一个数据类型“serial”，但在使用它时出现语法错误（在 v8.0 中）。

* * *

## 回答 #1

> 赞同：777
> 
> 时间：2009-04-24T22:16:57.040

是的，SERIAL 是等效的功能。

```
CREATE TABLE foo (
    id SERIAL,
    bar varchar
);

INSERT INTO foo (bar) VALUES ('blah');
INSERT INTO foo (bar) VALUES ('blah');

SELECT * FROM foo;

+----------+
| 1 | blah |
+----------+
| 2 | blah |
+----------+ 
```

SERIAL 只是一个围绕序列的创建表时间宏。您不能将 SERIAL 更改为现有列。

* * *

## 回答 #2

> 赞同：247
> 
> 时间：2011-07-09T02:19:35.277

您可以使用任何其他[整数数据类型](http://www.postgresql.org/docs/9.1/static/datatype-numeric.html#DATATYPE-INT)，例如`smallint`.

例子 ：

```
CREATE SEQUENCE user_id_seq;
CREATE TABLE user (
    user_id smallint NOT NULL DEFAULT nextval('user_id_seq')
);
ALTER SEQUENCE user_id_seq OWNED BY user.user_id; 
```

最好使用自己的数据类型，而不是用户[串行数据类型](http://www.postgresql.org/docs/9.1/static/datatype-numeric.html#DATATYPE-SERIAL)。

* * *

## 回答 #3

> 赞同：119
> 
> 时间：2012-07-16T00:50:36.800

如果要将序列添加到已经存在的表中的 id 中，可以使用：

```
CREATE SEQUENCE user_id_seq;
ALTER TABLE user ALTER user_id SET DEFAULT NEXTVAL('user_id_seq'); 
```

* * *

## 回答 #4

> 赞同：58
> 
> 时间：2017-10-31T12:19:16.270

从 Postgres 10 开始，还支持 SQL 标准定义的标识列：

```
create table foo 
(
  id integer generated always as identity
); 
```

除非明确要求，否则创建一个不能被覆盖的标识列。以下插入将失败，列定义为`generated always`：

```
insert into foo (id) 
values (1); 
```

然而，这可以被否决：

```
insert into foo (id) overriding system value 
values (1); 
```

使用该选项时，这与现有实现`generated by default`的行为基本相同：`serial`

```
create table foo 
(
  id integer generated by default as identity
); 
```

当手动提供值时，也需要手动调整基础序列 - 与`serial`列相同。

* * *

默认情况下，标识列不是主键（就像`serial`列一样）。如果应该是一个，则需要手动定义主键约束。

* * *

## 回答 #5

> 赞同：55
> 
> 时间：2016-10-08T21:08:27.067

虽然看起来序列*等同*于 MySQL auto_increment，但有一些细微但重要的区别：

## 1.失败的查询增加序列/序列

serial 列在查询失败时递增。这会导致失败查询产生碎片，而不仅仅是行删除。例如，在 PostgreSQL 数据库上运行以下查询：

```
CREATE TABLE table1 (
  uid serial NOT NULL PRIMARY KEY,
  col_b integer NOT NULL,
  CHECK (col_b>=0)
);

INSERT INTO table1 (col_b) VALUES(1);
INSERT INTO table1 (col_b) VALUES(-1);
INSERT INTO table1 (col_b) VALUES(2);

SELECT * FROM table1; 
```

您应该得到以下输出：

```
 uid | col_b 
-----+-------
   1 |     1
   3 |     2
(2 rows) 
```

注意 uid 如何从 1 变为 3 而不是 1 变为 2。

如果您要手动创建自己的序列，这仍然会发生：

```
CREATE SEQUENCE table1_seq;
CREATE TABLE table1 (
    col_a smallint NOT NULL DEFAULT nextval('table1_seq'),
    col_b integer NOT NULL,
    CHECK (col_b>=0)
);
ALTER SEQUENCE table1_seq OWNED BY table1.col_a; 
```

如果您想测试 MySQL 的不同之处，请在 MySQL 数据库上运行以下命令：

```
CREATE TABLE table1 (
  uid int unsigned NOT NULL AUTO_INCREMENT PRIMARY KEY,
  col_b int unsigned NOT NULL
);

INSERT INTO table1 (col_b) VALUES(1);
INSERT INTO table1 (col_b) VALUES(-1);
INSERT INTO table1 (col_b) VALUES(2); 
```

你应该得到以下**没有碎片**：

```
+-----+-------+
| uid | col_b |
+-----+-------+
|   1 |     1 |
|   2 |     2 |
+-----+-------+
2 rows in set (0.00 sec) 
```

## 2\. 手动设置序列列值会导致以后的查询失败。

@trev 在之前的回答中指出了这一点。

为了模拟这一点，手动将 uid 设置为 4，这将在稍后“冲突”。

```
INSERT INTO table1 (uid, col_b) VALUES(5, 5); 
```

表数据：

```
 uid | col_b 
-----+-------
   1 |     1
   3 |     2
   5 |     5
(3 rows) 
```

运行另一个插入：

```
INSERT INTO table1 (col_b) VALUES(6); 
```

表数据：

```
 uid | col_b 
-----+-------
   1 |     1
   3 |     2
   5 |     5
   4 |     6 
```

现在，如果您运行另一个插入：

```
INSERT INTO table1 (col_b) VALUES(7); 
```

它将失败并显示以下错误消息：

> 错误：重复键值违反唯一约束“table1_pkey” 详细信息：键 (uid)=(5) 已存在。

相反，MySQL 会优雅地处理这个问题，如下所示：

```
INSERT INTO table1 (uid, col_b) VALUES(4, 4); 
```

现在插入另一行而不设置uid

```
INSERT INTO table1 (col_b) VALUES(3); 
```

查询没有失败，uid 只是跳转到 5：

```
+-----+-------+
| uid | col_b |
+-----+-------+
|   1 |     1 |
|   2 |     2 |
|   4 |     4 |
|   5 |     3 |
+-----+-------+ 
```

测试在 MySQL 5.6.33、Linux (x86_64) 和 PostgreSQL 9.4.9 上执行

* * *

## 回答 #6

> 赞同：36
> 
> 时间：2018-02-08T21:29:23.573

抱歉，重新讨论一个老问题，但这是 Google 上出现的第一个 Stack Overflow 问题/答案。

这篇文章（首先出现在 Google 上）讨论了使用更新的 PostgreSQL 10 语法： [https ://blog.2ndquadrant.com/postgresql-10-identity-columns/](https://blog.2ndquadrant.com/postgresql-10-identity-columns/)

这恰好是：

```
CREATE TABLE test_new (
    id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
); 
```

希望有帮助:)

* * *

## 回答 #7

> 赞同：17
> 
> 时间：2013-07-28T18:22:41.883

您必须注意不要直接插入到您的 SERIAL 或序列字段中，否则当序列达到插入值时，您的写入将失败：

```
-- Table: "test"

-- DROP TABLE test;

CREATE TABLE test
(
  "ID" SERIAL,
  "Rank" integer NOT NULL,
  "GermanHeadword" "text" [] NOT NULL,
  "PartOfSpeech" "text" NOT NULL,
  "ExampleSentence" "text" NOT NULL,
  "EnglishGloss" "text"[] NOT NULL,
  CONSTRAINT "PKey" PRIMARY KEY ("ID", "Rank")
)
WITH (
  OIDS=FALSE
);
-- ALTER TABLE test OWNER TO postgres;
 INSERT INTO test("Rank", "GermanHeadword", "PartOfSpeech", "ExampleSentence", "EnglishGloss")
           VALUES (1, '{"der", "die", "das", "den", "dem", "des"}', 'art', 'Der Mann küsst die Frau und das Kind schaut zu', '{"the", "of the" }');

 INSERT INTO test("ID", "Rank", "GermanHeadword", "PartOfSpeech", "ExampleSentence", "EnglishGloss")
           VALUES (2, 1, '{"der", "die", "das"}', 'pron', 'Das ist mein Fahrrad', '{"that", "those"}');

 INSERT INTO test("Rank", "GermanHeadword", "PartOfSpeech", "ExampleSentence", "EnglishGloss")
           VALUES (1, '{"der", "die", "das"}', 'pron', 'Die Frau, die nebenen wohnt, heißt Renate', '{"that", "who"}');

SELECT * from test; 
```

* * *

## 回答 #8

> 赞同：16
> 
> 时间：2012-04-26T10:57:14.697

在提出问题的上下文中并回复@sereja1c 的评论，创建`SERIAL`隐式创建序列，因此对于上面的示例 -

```
CREATE TABLE foo (id SERIAL,bar varchar); 
```

`CREATE TABLE`会隐式地`foo_id_seq`为 serial column创建序列`foo.id`。因此，`SERIAL`[4 Bytes] 有利于它的易用性，除非您的 id 需要特定的数据类型。

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2019-03-28T16:16:31.260

从 PostgreSQL 10 开始

```
CREATE TABLE test_new (
    id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    payload text
); 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2018-05-16T21:08:13.773

这种方式肯定会奏效，我希望它会有所帮助：

```
CREATE TABLE fruits(
   id SERIAL PRIMARY KEY,
   name VARCHAR NOT NULL
);

INSERT INTO fruits(id,name) VALUES(DEFAULT,'apple');

or

INSERT INTO fruits VALUES(DEFAULT,'apple'); 
```

您可以在下一个链接中查看详细信息： [http ://www.postgresqltutorial.com/postgresql-serial/](http://www.postgresqltutorial.com/postgresql-serial/)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-08-31T10:06:01.480

创建序列。

```
CREATE SEQUENCE user_role_id_seq
  INCREMENT 1
  MINVALUE 1
  MAXVALUE 9223372036854775807
  START 3
  CACHE 1;
ALTER TABLE user_role_id_seq
  OWNER TO postgres; 
```

并更改表

```
ALTER TABLE user_roles ALTER COLUMN user_role_id SET DEFAULT nextval('user_role_id_seq'::regclass); 
```

# c# - 对于 Web 项目，Asp.Net 仅检测 aspx 中的更改，而不检测 cs 文件中的更改

> ID：787727
> 
> 赞同：0
> 
> 时间：2009-04-24T22:01:17.750
> 
> 标签：c#, asp.net, assemblies, asp.net-2.0

Q1 - Asp.Net 能够检测您何时更改原始文件并在下一个请求到达时自动重新编译应用程序

A) 但是，对于 Web 站点，Asp.Net 似乎能够检测到更改，无论它们是发生在代码隐藏文件 (.cs) 中还是在 aspx 文件中，但对于 Web 项目，Asp.Net 只能检测到内部发生的更改aspx 文件，但它没有检测到 .cs 文件中的更改！这是为什么？

B) Asp.Net 还检测是否有任何新的 aspx 或 cs 文件添加到网站。但是，它会在下一次请求时只编译添加的文件，还是重新编译所有应用程序的文件？

C）如果 Web 服务器上的应用程序包含多个 asp 文件，其中一些由 Web 项目创建（因此它们的代码隐藏在单个程序集中）而其他 aspx 文件是通过网站项目创建的，Asp.Net 是如何计算的找出特定的 aspx 文件是否包含位于 Bin 目录中的程序集中的代码？

Q2 “Codebehind 属性仅由 Visual Studio Web 窗体设计器使用。该属性在运行时不使用。”</p>

*   我假设在运行时不使用 CodeBehind 属性，因为所有 .cs 文件都编译为单个程序集，因此只要 aspx 通过 Inherits 属性告诉类的名称，VS 定位类就没有问题？！

*   另一方面，模型背后的 Asp.Net 代码确实需要 src 属性，因为这里的 cs 文件被编译成单独的程序集，因此 asp.net 需要知道由 CodeFile 属性指定的文件的名称，所以它可以以某种方式找出该文件编译成的程序集的名称？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-24T22:12:29.440

Q1 a：这是因为网站是动态编译的，而 Web 应用程序是显式编译的。有关这两种类型的比较表，请参阅[本文。](http://msdn.microsoft.com/en-us/library/aa730880(VS.80).aspx)

Q1 b：默认情况下，一切都会重新编译。但是，.net 3.5 sp1（[知识库文章](http://support.microsoft.com/kb/961884)，[下载](http://blogs.msdn.com/davidebb/archive/2009/04/15/a-new-flag-to-optimize-asp-net-compilation-behavior.aspx)）发布了一个修补程序，允许您选择是要重新编译所有内容还是只编译更改的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T22:39:34.443

ASP.NET 仅在找不到完成现有程序集中的 ASPX 编译所需的类型时才查找代码隐藏文件。只有在为 ASPX 文件构建临时程序集时需要它时，才会创建对 cs 文件背后代码的依赖。

因此，在 Web 项目中，所有代码隐藏 cs 文件都被编译到单个程序集中，ASPX 临时程序集的编译不需要 cs 后面的代码，因为所需的类型已经存在于预构建的程序集中. 因此在临时程序集和 cs 文件之间没有创建依赖关系，因此更改 cs 文件不会使现有临时程序​​集无效。请注意，在部署中，cs 文件甚至不会出现。

在网站中，没有包含代码隐藏中所有类型的预构建程序集，因此需要代码隐藏文件来完成 ASPX 的临时程序集，进而将对 cs 文件的依赖添加到该临时文件中部件。因此，对 cs 文件的任何更改都会使临时程序集无效。

# .net - ASP.NET 页面授权...你是怎么做的？

> ID：787729
> 
> 赞同：4
> 
> 时间：2009-04-24T22:01:34.567
> 
> 标签：.net, asp.net, security, authorization

我目前正在研究 asp.net 中标准页面授权配置的替代解决方案。

如果您有需要相同访问策略的文件目录，则位置标签可以正常工作，但如果您有很多单独的访问策略，则位置标签很麻烦。我可以推出自己的自定义身份验证系统，但如果可以避免，那可能会更好。

目前，我们正在为页面内容使用类似 azman 的基于权限的授权系统，但我还没有找到一种将其与标准页面安全性集成的好方法。

关于如何做到这一点的任何建议？有没有集成 azman 和 asp.net 页面授权的解决方案？还有其他我应该注意的标准解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T03:52:24.613

我在一个巨大的应用程序中做了很多不同的权限和不同的角色，如下所示[我这里没有代码，所以我将尝试在这里重新创建它]：

我首先实现了一个名为 SecuredPage 的类，如下所示：

```
 public class SecuredPage : System.Web.UI.Page
{
    // Those Permissions are mandatory, so user needs to have all of them
    public List MandatoryPermissions { get; set; }

    // Those Permissions are optional, so if the user have at least one of them, he can access
    public List OptionalPermissions { get; set; }

    protected override void OnLoad(EventArgs e)
    {
        MyUser loggedUser = (MyUser) this.User;

        base.OnLoad(e);

        foreach (Permission mandatoryPermission in MandatoryPermissions)
        {
            // if the user don't have permission, we can redirect him
            if (!loggedUser.HasPermission(mandatoryPermission))
            {
                RedirectToDontHaveAccess();
                break;
            }
        }

        bool hasAccessToThePage = false;

        foreach (Permission optionalPermission in OptionalPermissions)
        {
            // If the user has at least one of the permissions, he can access
            if (loggedUser.HasPermission(optionalPermission))
            {
                hasAccessToThePage = true;
            }
        }

        if (!hasAccessToThePage)
        {
            RedirectToDontHaveAccess();
        }

    }

    private void RedirectToDontHaveAccess()
    {
        throw new NotImplementedException();
    }
} 
```

对于用户需要访问权限的所有页面，这将是我的 BasePage。`MandatoryPermissions`用户必须拥有所有这些权限才能访问该页面，并且是`OptionalPermissions`用户至少需要其中一个才能访问该页面的权限。没有必要在每个页面上都使用两者，因为如果你有`MandatoryPermissions`选项，是否有选项都没有关系。

权限是一个枚举：

```
 public enum Permission
{
    // Usually this enum will replicate a domain table from the database
    EditUser = 1,
    SearchUserByUsername = 2,
    SearchUserByEmail = 3

} 
```

并且`MyUser`是`MembershipUser`：

```
 public class MyUser : System.Web.Security.MembershipUser
{
    internal bool HasPermission(Permission permission)
    {
        //
        // TODO: Check on database if the user has the permission or not
        //
    }
} 
```

然后，您需要在页面中做的唯一一件事就是填充权限列表：

```
 public partial class EditUser : SecuredPage
{
    protected void Page_Load(object sender, EventArgs e)
    {
        MandatoryPermissions.Add(Permission.EditUser);
    }
} 
```

```
 public partial class SearchUser : SecuredPage
{
    protected void Page_Load(object sender, EventArgs e)
    {
        OptionalPermissions.Add(Permission.SearchUserByUsername);
        OptionalPermissions.Add(Permission.SearchUserByEmail);
    }
} 
```

好的，搜索示例不是那么好，但我想你明白了。

整个想法是`base.OnLoad(e);`在权限验证之前调用，所以你只需要在你的`Page_Load`.

我不确定这是否是最好的解决方案，但我相信它有很大帮助:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-08T11:05:38.887

如何将页面映射到数据库中的角色，然后让您的母版页在页面加载时检查数据库？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-24T22:17:57.507

您是否在应用程序的 Application_AuthenticateRequest 方法期间设置了 GenericIdentity 和 IPrincipal 对象？

我们目前使用我们的域在 SQL Server 数据库上进行身份验证和用户组/角色以提供授权。在 Application_AuthenticateRequest 方法中，我收集所有这些数据并基于它创建一个 FormsAuthenticationTicket 对象。

通过这样做，我现在可以通过在我的代码中执行一个简单的 User.IsInRole("RoleX") 命令来访问用户的角色，这使我可以轻松地锁定/解锁用户控件，甚至可以执行一个简单的 Response.Redirect()如果他们没有适当的授权，则转到“授权错误”页面。

这是我的 AuthenticateRequest 方法的样子（VB.NET）

```
Sub Application_AuthenticateRequest(ByVal sender As Object, _
                                       ByVal e As EventArgs)

      Dim formsAuthTicket As FormsAuthenticationTicket
      Dim httpCook As HttpCookie
      Dim objGenericIdentity As GenericIdentity
      Dim objMyAppPrincipal As CustomPrincipal
      Dim strRoles As String()

      httpCook = Context.Request.Cookies.Get("authCookieEAF")
      formsAuthTicket = FormsAuthentication.Decrypt(httpCook.Value)
      objGenericIdentity = New GenericIdentity(formsAuthTicket.Name)
      strRoles = formsAuthTicket.UserData.Split("|"c)
      objMyAppPrincipal = New CustomPrincipal(objGenericIdentity, strRoles)
      HttpContext.Current.User = objMyAppPrincipal    

   End Sub 
```

...同样，CustomPrincipal 对象如下所示：

```
Public Class CustomPrincipal
   Implements IPrincipal

   ''' <summary>
   '''    Identity object of user.
   ''' </summary>
   ''' <remarks></remarks>
   Private m_identity As IIdentity

   ''' <summary>
   '''    Roles(s) a user is a part of.
   ''' </summary>
   ''' <remarks></remarks>
   Private m_roles As String()

   ''' <summary>
   '''    Name of user.
   ''' </summary>
   ''' <remarks></remarks>
   Private m_userId As String

   ''' <summary>
   '''    Gets/Sets the user name.
   ''' </summary>
   ''' <value>m_userId</value>
   ''' <returns>Current name of user.</returns>
   ''' <remarks></remarks>
   Public Property UserId() As String
      Get
         Return m_userId
      End Get
      Set(ByVal value As String)
         m_userId = value
      End Set
   End Property

   ''' <summary>
   '''    Gets the identity object of the user.
   ''' </summary>
   ''' <value>m_identity</value>
   ''' <returns>Current identity of user.</returns>
   ''' <remarks></remarks>
   Public ReadOnly Property Identity() As System.Security.Principal.IIdentity Implements System.Security.Principal.IPrincipal.Identity
      Get
         Return m_identity
      End Get
   End Property

   ''' <summary>
   '''    Full constructor.
   ''' </summary>
   ''' <param name="identity">Identity to use with Custom Principal.</param>
   ''' <param name="roles">Roles for user.</param>
   ''' <remarks>Identity object contains user name when building constructor.</remarks>
   Public Sub New(ByVal identity As IIdentity, ByVal roles As String())

      m_identity = identity
      m_roles = New String(roles.Length) {}
      roles.CopyTo(m_roles, 0)
      Array.Sort(m_roles)
      m_userId = identity.Name

   End Sub

   ''' <summary>
   '''    Determines if the current user is in the role specified.
   ''' </summary>
   ''' <param name="role">Role to test against.</param>
   ''' <returns>Boolean variable indicating if role specified exists in user's m_roles array.</returns>
   ''' <remarks></remarks>
   Public Function IsInRole(ByVal role As String) As Boolean Implements System.Security.Principal.IPrincipal.IsInRole

      Dim boolResults As Boolean

      If Array.BinarySearch(m_roles, role) >= 0 Then
         boolResults = True
      Else
         boolResults = False
      End If

      Return boolResults

   End Function

End Class 
```

希望这为您提供了将其塑造到您的环境中所需的东西。

# struts2 - 如何在struts2迭代器标签中获取下一个项目

> ID：787733
> 
> 赞同：1
> 
> 时间：2009-04-24T22:02:43.300
> 
> 标签：struts2

我知道 stackoverflow 没有一个大的 struts2 社区。但我仍在尝试我的运气:)

我有这样的脚本代码：

```
<%
                ArrayList statisticsList = something.getStatistics();
                Iterator itr1 = statisticsList.iterator();

                while (itr1.hasNext())
                {
                 dvo3_a = (VerificationVO) itr1.next();
                 dvo3_b = (VerificationVO) itr1.next();
                 dvo3_c = (VerificationVO) itr1.next();
                 ....
                    ....
                }
%> 
```

dvo3_a、dvo_b、dvo_c 用于循环的每次迭代。请注意，iter1.next() 获取下一项。所以基本上在一次迭代中我得到了 3 个元素。

我正在尝试将上述内容转换为[struts2 迭代器标记](http://struts.apache.org/2.0.14/docs/iterator.html)但是，查看文档中提供的示例和信息，我认为这不可能吗？如果我必须更改我的数据集以克服 struts2 迭代器标记的这个缺点，我真的会非常讨厌并且会很糟糕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T06:50:34.387

Struts2 Iterator 不支持你想做的事情。你的代码很好，你想转移到struts迭代器的原因是什么。如果不是在您的 jsp 中使用 java 代码而是使用标签，那么您已经为迭代器编写了自己的自定义标签，它提供了您需要的功能。

# java - 什么是解析/解析？

> ID：787735
> 
> 赞同：36
> 
> 时间：2009-04-24T22:03:33.190
> 
> 标签：java, parsing

在 Java 中，解析到底是什么？为什么使用它们？

例如：`Integer.parseInt(...)`, 并解析一个字符串？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-04-24T22:10:32.923

您可以说*解析字符串*就是*分析该字符串以查找标记或项目，然后根据结果创建结构*。

在您的示例中，调用`Integer.parseInt`字符串正在*解析此字符串以查找 integer*。

所以，如果你有：

```
String someString = "123"; 
```

然后你调用：

```
int i = Integer.parseInt( someString ); 
```

你告诉 java 分析`"123"`字符串并在那里找到一个整数。

**其他示例：**

java 编译器在编译源代码时执行的操作之一是“解析”您的 .java 文件并创建与 java 语法匹配的标记。

当您未能正确编写源代码时（例如忘记`;`在语句末尾添加 a ），是解析器识别错误。

这里有更多信息：[http ://en.wikipedia.org/wiki/Parse](http://en.wikipedia.org/wiki/Parse)

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2009-04-24T22:07:16.610

解析是读取一个对象的值，将其转换为另一种类型。例如，您可能有一个值为“10”的字符串。该字符串在内部包含 Unicode 字符“1”和“0”而不是实际数字 10。方法 Integer.parseInt 采用该字符串值并返回一个实数。

```
String tenString = "10"

//This won't work since you can't add an integer and a string
Integer result = 20 + tenString;

//This will set result to 30
Integer result = 20 + Integer.parseInt(tenString); 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-04-24T22:06:37.237

来自[dictionary.reference.com](http://dictionary.reference.com/browse/parse)：

> 电脑。分析（一串字符）以便将字符组与基础语法的句法单元相关联。

定义的上下文是将程序文本或一般意义上的语言翻译成相对于已定义语法的组成部分——将程序文本转换为代码。但是，在特定语言关键字的上下文中，它通常意味着将基本数据类型的字符串值转换为该数据类型的内部表示。例如，字符串“10”变成数字（整数）10。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-11-26T13:37:19.827

解析可以被认为是“分解成小块”的同义词，然后分析那里的内容或以修改的方式使用它。在 Java 中，字符串被解析为十进制、八进制、二进制、十六进制等。如果您的应用程序以字符串的形式从用户那里获取输入，但您希望在应用程序的某个地方以整数或双精度类型。它与类型转换不同。对于类型转换，使用的类型应该是兼容的，以便进行转换，但在解析中则没有。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-15T12:42:28.787

解析是将文本划分为一组部分或标记。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-27T16:10:54.893

解析只是分析字符串并从该字符串中找到标记的过程，解析器是解释器和编译器的组件。它使用词法分析，然后进行句法分析。它解析它，然后在整个编译过程之后编译这段代码.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-01-22T07:42:46.670

**解析**意味着我们正在专门分析一个对象。例如，当我们在搜索引擎中输入一些关键字时，它们会解析关键字并通过搜索每个单词来返回结果。所以它基本上是从文件中获取一个字符串并对其进行处理以提取我们想要的信息。

`indexOf`使用来计算一个字符串在另一个字符串中的位置的解析示例：

```
String s="What a Beautiful day!";

int i=s.indexOf("day");//value of i would be 17
int j=s.indexOf("be");//value of j would be -1
int k=s.indexOf("ea");//value of k would be 8 
```

`paresInt`本质上将 a 转换`String`为 a `Integer`。

```
String s="9876543";
int a=new Integer(s);//uses constructor
System.out.println("Constructor method: " + a);
a=Integer.parseInt(s);//uses parseInt() method
System.out.println("parseInt() method: " + a); 
```

输出：

> ```
> Constructor method: 9876543
> 
> parseInt() method: 9876543 
> ```

# .net - SSIS 使用默认值读取注册表项

> ID：787737
> 
> 赞同：0
> 
> 时间：2009-04-24T22:03:53.373
> 
> 标签：.net, sql-server, ssis

我在 SSIS 包中有一个脚本任务，它应该从注册表中检索字符串值。如果注册表值存在并且其中有一个值，它似乎可以很好地返回该值。如果注册表项不存在或值为空，则由于某种原因我无法将其设置为默认值。我已经尝试了三种不同的方法，但无法让它发挥作用。
我尝试使用 Registry.GetValue 并指定默认值 Registry.LocalMachine.CreateSubKey 和 Registry.LocalMachine.GetValue。我什至尝试过明确检查 null 或 0 长度，似乎没有任何效果......我做错了吗？

```
Public Sub Main()
    'Dim strValue As String = DirectCast(Registry.LocalMachine.GetValue("SOFTWARE\MyComp\SSIS\IPSEmail\strLastDate", DateTime.Now.ToString("MMM dd, yyyy HH:mm:ss")), String)
    'Dim strValue As String = DirectCast(Registry.GetValue("HKEY_LOCAL_MACHINE\SOFTWARE\MyComp\SSIS\IPSEmail", "strLastDate", DateTime.Now.ToString("MMM dd, yyyy HH:mm:ss")), String)
    Dim strValue As String = DirectCast(Registry.LocalMachine.CreateSubKey("SOFTWARE\MyComp\SSIS\IPSEmail\strLastDate").GetValue("strLastDate", DateTime.Now.ToString("MMM dd, yyyy HH:mm:ss")), String)

    If (strValue = Nothing Or strValue.Length = 0) Then
        strValue = DateTime.Now.ToString("MMM dd, yyyy HH:mm:ss")
    End If

    Dts.ExecutionValue = strValue

    Dts.TaskResult = Dts.Results.Success
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T09:19:31.630

你试过`strValue Is Nothing`吗？

如果这不起作用，请在代码中放置一个断点，并在`strValue`声明它并且注册表项不存在时找出设置的内容。

# python - Python：电子邮件 get_payload 在遇到等号时解码失败？

> ID：787739
> 
> 赞同：8
> 
> 时间：2009-04-24T22:04:32.827
> 
> 标签：python, email

使用 get_payload 遇到奇怪：当它在它正在解码的消息中看到一个等号时，它似乎会崩溃。这是显示错误的代码：

```
import email

data = file('testmessage.txt').read()
msg  = email.message_from_string( data )
payload = msg.get_payload(decode=True)
print payload 
```

这是一个示例消息：[test message](http://parand.com/tmp/testmessage.txt)。

该消息仅在第一个 "=" 之前打印。其余部分省略。有人知道发生了什么吗？

带有“decode=False”的相同脚本会返回完整的消息，因此看起来解码对等号不满意。

这是在 Python 2.5 下。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-04-24T22:24:01.050

你有一个行尾问题。测试消息的正文使用不带换行符 (\n) 的裸回车符 (\r)。如果您在解析电子邮件之前修复了行尾，则一切正常：

```
import email, re
data = file('testmessage.txt').read()
data = re.sub(r'\r(?!\n)', '\r\n', data)  # Bare \r becomes \r\n
msg  = email.message_from_string( data )
payload = msg.get_payload(decode=True)
print payload 
```

# c# - DataGridView：当MultiSelect为真时如何选择当前行中的第一个单元格

> ID：787743
> 
> 赞同：1
> 
> 时间：2009-04-24T22:04:49.613
> 
> 标签：c#, datagridview

我正在创建从 DataGridView 继承的 DataGridViewEx 类。
我想创建一个方法来选择当前行中的第一个单元格，所以我写了这个：

```
 /// <summary>
    /// The method selects first visible cell in a current row.
    /// If current row is null, nothing is done. 
    /// If any cells are selected, they are unselected before selecting first cell.
    /// </summary>
    public void SelectFirstCellInCurrentRow()
    {
        if (CurrentRow == null) return;

        ClearSelection();
        foreach (DataGridViewCell cell in CurrentRow.Cells)
        {
            if (cell.Visible)
            {
                cell.Selected = true;
                return;
            }
        }
    } 
```

我想像这样使用它，例如：

```
 private void btnAdd_Click(object sender, EventArgs e)
        {
            bindingSource.Add(new Customer());
            bindingSource.MoveLast();
            grid.SelectFirstCellInCurrentRow();
            grid.BeginEdit(false);
        }
```

我的任务是在网格中添加一个新行并开始编辑它的第一个单元格。
如果grid.MultiSelect = false，此代码工作正常，但如果grid.MultiSelect = true，则无法按预期工作：取消选择所有单元格，选择最后一行的第一个单元格，但是！！！最后选择的列的最后一行中的单元格被编辑，而不是第一个单元格！

这是它的外观：
1）我选择了一些单元格：
_http://img13.imageshack.us/img13/2528/beforeadd.gif

2）按添加按钮后
：_http://img211.imageshack.us/img211/847/afteradd.gif

先感谢您。

PS。为什么我不能添加图片？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T07:29:00.507

代替

```
cell.Selected = true; 
```

尝试

```
CurrentCell = cell; 
```

# .net - 从 .net 中的 xsd 模式文件中提取枚举值

> ID：787745
> 
> 赞同：4
> 
> 时间：2009-04-24T22:05:56.177
> 
> 标签：.net, xsd, enumeration

如何使用.net以编程方式从xsd模式文件中提取元素的枚举约束值？

例如，我想从以下 xsd 中提取“Audi”、“Golf”和“BMW”：

```
<xs:element name="car">
  <xs:simpleType>
    <xs:restriction base="xs:string">
      <xs:enumeration value="Audi"/>
      <xs:enumeration value="Golf"/>
      <xs:enumeration value="BMW"/>
    </xs:restriction>
  </xs:simpleType>
</xs:element> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T22:24:39.113

有一[`XmlSchema`](http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschema.aspx)门课，但它看起来很漂亮......“有趣”的工作。

xml查询就够了吗？

```
XmlDocument doc = new XmlDocument();
doc.Load("Foo.xsd");            
XmlNamespaceManager mgr = new XmlNamespaceManager(doc.NameTable);
mgr.AddNamespace("xx", "http://www.w3.org/2001/XMLSchema");
foreach (XmlElement el in doc.SelectNodes("//xx:element[@name='car'][1]/xx:simpleType/xx:restriction/xx:enumeration", mgr))
{
    Console.WriteLine(el.GetAttribute("value"));
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-29T09:09:05.473

您还可以遍历架构中的所有项目。

以下代码对于从 XSD 模式中提取数据非常有用。基本上，它为 SOM 中的任何对象调用函数回调。您需要为检查类型是枚举并相应地处理它的回调提供一个实现。

```
 #region CallForEveryElement
    public delegate void SchemaObjectFunction(XmlSchemaObject xso);

    public static void CallForEveryElement(XmlSchema schema, SchemaObjectFunction function)
    {
        CallForEveryElementInternal(schema, function);
    }

    private static void CallForEveryElementInternal(XmlSchemaObject schemaObject, SchemaObjectFunction function)
    {
        if (schemaObject == null)
            return;

        function(schemaObject);

        if (schemaObject is XmlSchema)
        {
            CallForEveryElementInternal((schemaObject as XmlSchema).Includes, function);
            CallForEveryElementInternal((schemaObject as XmlSchema).Items, function);
        }
        if (schemaObject is XmlSchemaGroupBase)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaGroupBase).Items, function);
        }
        if (schemaObject is XmlSchemaAttribute)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaAttribute).SchemaType, function);
        }
        if (schemaObject is XmlSchemaAttributeGroup)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaAttributeGroup).AnyAttribute, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaAttributeGroup).Attributes, function);
        }
        if (schemaObject is XmlSchemaContentModel)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaContentModel).Content, function);
        }
        if (schemaObject is XmlSchemaComplexContentExtension)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexContentExtension).AnyAttribute, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexContentExtension).Attributes, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexContentExtension).Particle, function);
        }
        if (schemaObject is XmlSchemaComplexContentRestriction)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexContentRestriction).AnyAttribute, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexContentRestriction).Attributes, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexContentRestriction).Particle, function);
        }
        if (schemaObject is XmlSchemaComplexType)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexType).AnyAttribute, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexType).Attributes, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexType).AttributeWildcard, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexType).ContentModel, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexType).ContentTypeParticle, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaComplexType).Particle, function);
        }
        if (schemaObject is XmlSchemaElement)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaElement).Constraints, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaElement).ElementSchemaType, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaElement).SchemaType, function);
        }
        if (schemaObject is XmlSchemaGroup)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaGroup).Particle, function);
        }
        if (schemaObject is XmlSchemaGroupBase)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaGroupBase).Items, function);
        }
        if (schemaObject is XmlSchemaGroupRef)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaGroupRef).Particle, function);
        }
        if (schemaObject is XmlSchemaImport)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaImport).Annotation, function);
        }
        if (schemaObject is XmlSchemaInclude)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaInclude).Annotation, function);
        }
        if (schemaObject is XmlSchemaRedefine)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaRedefine).Items, function);
        }
        if (schemaObject is XmlSchemaSimpleContentExtension)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleContentExtension).AnyAttribute, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleContentExtension).Attributes, function);
        }
        if (schemaObject is XmlSchemaSimpleContentRestriction)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleContentRestriction).AnyAttribute, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleContentRestriction).Attributes, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleContentRestriction).BaseType, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleContentRestriction).Facets, function);
        }
        if (schemaObject is XmlSchemaSimpleType)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleType).Content, function);
        }
        if (schemaObject is XmlSchemaSimpleTypeList)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleTypeList).BaseItemType, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleTypeList).ItemType, function);
        }
        if (schemaObject is XmlSchemaSimpleTypeRestriction)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleTypeRestriction).BaseType, function);
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleTypeRestriction).Facets, function);
        }
        if (schemaObject is XmlSchemaSimpleTypeUnion)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaSimpleTypeUnion).BaseTypes, function);
        }
        if (schemaObject is XmlSchemaType)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaType).BaseXmlSchemaType, function);
        }
        if (schemaObject is XmlSchemaAnnotated)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaAnnotated).Annotation, function);
        }
        if (schemaObject is XmlSchemaAnnotation)
        {
            CallForEveryElementInternal((schemaObject as XmlSchemaAnnotation).Items, function);
        }
    }

    private static void CallForEveryElementInternal(XmlSchemaObjectCollection schemaObjectCol, SchemaObjectFunction function)
    {
        foreach (XmlSchemaObject xso in schemaObjectCol)
        {
            CallForEveryElementInternal(xso, function);
        }
    }

    #endregion 
```

# erlang - 如何将节点添加到 mnesia 集群？

> ID：787755
> 
> 赞同：24
> 
> 时间：2009-04-24T22:09:11.973
> 
> 标签：erlang, mnesia

我是 erlang 和 mnesia 新手..

如何将新的 disc_only_copies 节点添加到已经有模式的 mnesia 数据库？

谢谢

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2009-04-25T12:46:26.467

启动您的新节点 ( `b@node`) `erl -sname b -mnesia dir '"/path/to/storage"' -s mnesia`。这将启动一个名为 的新 ram_copies 节点`b@node`。

在您的原始节点 ( `a@node`) 上，在 erlang 提示符处执行`mnesia:change_config(extra_db_nodes, ['b@node']).`这将导致原始节点连接`b`到 mnesia 集群。此时，`b@node`已加入集群但只有模式的副本。

为了使新节点`b@node`能够存储磁盘副本，我们需要将模式表类型`b@node`从更改`ram_copies`为`disc_copies`。`mnesia:change_table_copy_type(schema, 'b@node', disc_copies).`在任何节点上运行。

`b@node`此时只有架构的副本。要将所有表复制`a@node`到`b@node`并维护表类型，您可以运行：

```
[{Tb, mnesia:add_table_copy(Tb, node(), Type)}
 || {Tb, [{'a@node', Type}]} <- [{T, mnesia:table_info(T, where_to_commit)}
                               || T <- mnesia:system_info(tables)]]. 
```

此命令可能需要一段时间才能执行，因为它将通过网络复制每个表的内容。

`b@node`现在是`a@node`. 您可以修改该语句 - 将调用中的`Type`变量替换为 to以复制表，但确保它们仅在磁盘上。`disc_only_copies``mnesia:add_table_copy/3`

[mnesia 文档](http://www.erlang.org/doc/man/mnesia.html)解释了如何使用我在这里展示的功能。

# java - SQL 迭代器

> ID：787756
> 
> 赞同：0
> 
> 时间：2009-04-24T22:09:30.850
> 
> 标签：java, sql, iterator

有谁知道我可以在哪里找到关于在 java 和任何其他语言中实现 SQL 迭代器/运算符的好来源？比你，-尼梅什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T09:29:20.670

我将采用 Elijah 的解释，Nimesh 实际上的意思是，“是否有可能为 ResultSet 制作一个包装器 Iterable。这是我准备的东西。它显然还没有准备好生产，但它确实给出了这个想法。因为没有标准（据我所知）ResultSetRow，它为每一行返回一个 Object[]。

这个概念有一些重要的问题，尤其是不允许抛出 Iterator，所以 SQLExceptions 被尽可能地“现场”处理。此外，ResultSet 是一个非常复杂且功能丰富的野兽（例如，请参见每种类型的重载方法）。这种复杂性*可以*部分利用，但不是。例如，可能有类似`getIntIterable(ResultSet rs)`返回 a 的方法`Iterable<int[]>`。该方法可以检查`getColumnType`ResultSetMetadata 对象的 s。这样，它可以在创建 Iterable 之前抛出（例如，如果不是所有列都是整数），其方法不能抛出。

```
public static class ResultSetIterable implements Iterable<Object[]>
{
private ResultSet rs;
private int columnCount;

public ResultSetIterable(ResultSet rs) throws SQLException
{
    this.rs = rs;
    columnCount = rs.getMetaData().getColumnCount();
}

public Iterator<Object[]> iterator()
{
    return new Iterator<Object[]>() 
    {
    private boolean moreRows;
    {
        try
        {
        moreRows = rs.first();
        }
        catch(SQLException e)
        {
        moreRows = false;
        }
    }

    public boolean hasNext()
    {
        boolean knownClosed = false;
        try
        {
        knownClosed = rs.isClosed();
        }
        catch(Throwable e)
        {
        // Ignore possible SQLException or AbstractMethodError or...
        }

        return !knownClosed && moreRows;
    }

    public Object[] next()
    {
        Object[] curRow = new Object[columnCount];
        for(int i = 1; i <= columnCount; i++)
        {
        try
        {
            curRow[i - 1] = rs.getObject(i);
        }
        catch(SQLException e)
        {
            curRow[i - 1] = null;
        }
        }
        try
        {
        moreRows = rs.next();
        }
        catch(SQLException e)
        {
        moreRows = false;
        }
        return curRow;
    }

    public void remove()
    {
        try
        {
        rs.previous();
        rs.deleteRow();
        }
        catch(SQLException e)
        {
        throw new UnsupportedOperationException("ResultSetIterable does not support remove for this ResultSet type.");
        }
    }
    };
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T06:44:24.030

看看 JDK 或开源 jdbc 驱动程序（如 mysql 的）的一些源代码怎么样？

# html - 如何确保相对位置 div 扩展为包含其中的所有绝对位置 div？

> ID：787757
> 
> 赞同：1
> 
> 时间：2009-04-24T22:09:32.877
> 
> 标签：html, css

说我有类似的东西

```
<body><div id="a"><div id="b">some content</div></div>more content<body> 
```

而且我不知道“某些内容”会有多少高度。但是我将#b 设置为位置：绝对和#a 设置为位置：相对所以#b 的位置相对于#a 的左上角。有什么方法可以让#a 扩展以包含#b 一些“更多内容”被推送的内容？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T16:57:56.533

您的示例存在缺陷，因为实际上不需要在 div#b 上设置 pos:abs，因为默认情况下该元素将设置在 div#a 的顶部/左侧。

使用 css 位置会将其应用的元素置于正常标记流之外，即使您要在 div#b 上使用 pos:rel 它只会增加 div#a 的高度，它不会考虑您可能也有的任何定位应用于它。

有一种方法可以实现你所追求的，但这将依赖于使用 JavaScript。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-04T11:02:50.100

用 relative 替换 absolute 可能会得到你想要的，就像在这个[jsFiddle](http://jsfiddle.net/zeWzB/)中一样。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T10:23:06.297

听起来#b 的相对位置可能是一个更好的解决方案。

由于#b 是#a 中的第一个元素，它自然会出现在#a 的左上角，因此相对位置将相对于与绝对位置相同的点进行定位。

另外，假设你想将#b 向下推 30px，然后你设置

```
#b{position:relative;top:30px;margin-bottom:30px;} 
```

内容将清除 #b 的底部，因为 position:relative 在内容流中留下一个等于 #b + 30px 高度的块；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T02:36:39.693

不会。绝对定位会从文档流中删除元素。它们的父标签和兄弟标签无法知道它们是否与绝对定位的元素重叠。

# .net - 如何汇总一个 IEnumerable

> ID：787772
> 
> 赞同：0
> 
> 时间：2009-04-24T22:15:42.193
> 
> 标签：.net, idisposable, rpc

我有一个`IEnumerable<IDisposable>`需要在给定时间处理的集合。问题在于，在某些情况下，所有对象都属于一种类型，并且需要通过从对象中收集一些数据并进行一次 RPC 调用来处理对象。在其他情况下，对象将是另一种类型，我只需要对它们中的每一个调用 Dispose。

我控制执行此操作的代码，但我不想将实现细节推入其中。

如果必须，我可以切换到这样的东西，但它似乎不优雅。

```
with(var rpc = new RPCDisposer())
{
    foreach (var item in Items)
    {
        rpc.Add(item);
        item.Dispose();
    }
} 
```

*编辑：*列表（现在）将只包含一种类型或另一种类型，从不包含两者。但我宁愿 Dispose 代码根本不需要知道 RPC 的东西，ei：

```
foreach (var item in Items)
    item.Dispose(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T22:25:02.777

如果这取决于项目类型，那么您可以检查您获得的项目类型，仅将那些特定类型的项目添加到 RPCDisposer。

```
using(var rpc = new RPCDisposer())
{
    foreach (var item in Items)
    {
        if (item is RPCItemType)
            rpc.Add(item);
        item.Dispose();
    }
} 
```

但如果您不在同一个列表中混合这些对象，那就更好了。您能否重构您的代码以将它们保存在两个不同的列表中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T22:36:41.097

OfType 方法可能会帮助您将项目分成两个列表......

```
var rpcItems = items.OfType<RPCItemType>();    
var normalItems = items.Where(x => !rpcItems.Contains(x)); 
```

# c# - C#中的高精度整数数学？

> ID：787773
> 
> 赞同：3
> 
> 时间：2009-04-24T22:15:55.407
> 
> 标签：c#, types

我需要计算一个非常大的数字，而 C# 中的任何内置数据类型都无法处理如此大的数字。

基本上我想解决这个问题：

**欧拉计划 16：**

> 2^15 = 32768，其数字之和为 3 + 2 + 7 + 6 + 8 = 26。
> 
> 2^1000的各位数字之和是多少？

我已经编写了代码，但是，如前所述，对于 c# 数据类型来说，这个数字太大了。该代码已经过小数字（例如 2^15）的测试和验证，并且运行良好。

```
using System;

namespace _16_2E1000
{
    class Program
    {
        static void Main(string[] args)
        {
            ulong sum = 0;
            ulong i = 1 << 1000;
            string s = i.ToString();
            foreach (char c in s)
            {
                sum += (ulong) Convert.ToInt64(c.ToString());
            }
            Console.WriteLine(sum);
            Console.ReadLine();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T22:18:14.917

首先回答您确切的问题，查找`BigInt`或`BigNum`输入

其次，根据我对 Project Euler 的了解，将会有一种很酷、很棘手的方法来做这件事，而且要容易得多。

作为第一个猜测，我会计算 2^1 -> 2^n 的回答者（对于你可以开始工作的任何 n）并寻找模式。还要在序列中寻找模式

```
V(0) = 2^p

V(n) = floor(V(n - 1) / 10)  
D(n) = V(n) % 10 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T22:29:54.343

您可以使用 J# 类中的 BigInteger。 [本文中的第一个问题](http://msdn.microsoft.com/en-us/magazine/cc163696.aspx)告诉你如何。b/c 有点痛苦，然后您必须在推出时提供[J# 可再](http://www.microsoft.com/downloads/details.aspx?familyid=f72c74b3-ed0e-4af8-ae63-2f0e42501be1&displaylang=en)发行组件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-25T00:23:34.367

我希望这不是一个家庭作业问题，但要得到 2^1000 的答案，你必须把它分成更小的块，

尝试类似的东西，

2^1000 = 2 * 2^999 = 2^999 + 2^999 = 2^ 998 + 2^ 998 + 2^ 998 + 2^ 998

分解成更小的部分，直到你解决一个问题，

Euler 项目的完整解决方案在以下链接上。

[http://blog.functionalfun.net/2008/07/project-euler-problem-16-calculating.html](http://blog.functionalfun.net/2008/07/project-euler-problem-16-calculating.html) [http://code.msdn.microsoft.com/projecteuler](http://code.msdn.microsoft.com/projecteuler)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-25T17:27:33.937

**没有必要`Big Integer`为了解决这个问题而拥有能力**。

*可以只使用以下属性*：

```
2^n = 2^(n-1) + 2^(n-1) 
```

如果其他任务确实需要 Big Integer，**我一直在我的 C# 程序中使用 F# 中的 BigInt 类，**并且对它很满意。

**必要的步骤**：

1.  安装[**F# CTP**](http://www.microsoft.com/downloads/details.aspx?FamilyID=61ad6924-93ad-48dc-8c67-60f7e7803d3c&displaylang=en)

2.  在您的 C#（或其他 .NET 语言）应用程序中添加对`FSharp.Core`dll 的引用。

3.  加：你`sing Microsoft.FSharp.Math;`

4.  在“类视图”窗口中熟悉两个类的成员：`BigInt`和`BigNum`

执行完这些步骤后，基本上就可以使用`BigInt`该类了。

**最后一个提示**：

*为了避免用不正确的名称声明变量来保存使代码不可读的常量*，我使用了一个以`_`（下划线）开头的名称，后跟整数常量。这样一来，就会有如下表达式：

```
N = _2 * N; 
```

显然比：

```
N = Two * N; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-25T17:37:37.093

这是您可以使用的 BigInteger（提供源代码）；但是，正如已经提到的，有比蛮力更有效的方法来做到这一点。

[Codeplex 上的 BigInteger](http://www.codeplex.com/biginteger "大整数")

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T20:28:52.487

实际上，虽然这里可能对 biginteger 实用程序感兴趣，但您不需要它，即使为此。是的，它看起来像，但你没有。事实上，使用大整数形式甚至可能会减慢速度。

由于我不想为你解决问题，我只是建议你以模块化的方式考虑这个问题。

# python - 在 OS/X 上的 python 中查找可用磁盘空间

> ID：787776
> 
> 赞同：25
> 
> 时间：2009-04-24T22:17:32.313
> 
> 标签：python, diskspace

我正在寻找我的 HD 上的可用字节数，但在 python 上这样做有困难。

我尝试了以下方法：

```
import os

stat = os.statvfs(path)
print stat.f_bsize * stat.f_bavail 
```

但是，在 OS/X 上，它给了我 17529020874752 字节，大约是 1.6 TB，这非常好，但不幸的是，这不是真的。

得到这个数字的最佳方法是什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-04-24T22:42:45.450

尝试使用`f_frsize`而不是`f_bsize`.

```
>>> s = os.statvfs('/')
>>> (s.f_bavail * s.f_frsize) / 1024
23836592L
>>> os.system('df -k /')
Filesystem   1024-blocks     Used Available Capacity  Mounted on
/dev/disk0s2   116884912 92792320  23836592    80%    / 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2011-09-02T15:10:15.893

在 UNIX 上：

```
import os
from collections import namedtuple

_ntuple_diskusage = namedtuple('usage', 'total used free')

def disk_usage(path):
    """Return disk usage statistics about the given path.

    Returned valus is a named tuple with attributes 'total', 'used' and
    'free', which are the amount of total, used and free space, in bytes.
    """
    st = os.statvfs(path)
    free = st.f_bavail * st.f_frsize
    total = st.f_blocks * st.f_frsize
    used = (st.f_blocks - st.f_bfree) * st.f_frsize
    return _ntuple_diskusage(total, used, free) 
```

用法：

```
>>> disk_usage('/')
usage(total=21378641920, used=7650934784, free=12641718272)
>>> 
```

对于 Windows，您可以使用[psutil](http://code.google.com/p/psutil/)。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-07-19T10:57:34.693

在 python 3.3 及更高版本中，shutil 为您提供相同的功能

```
>>> import shutil
>>> shutil.disk_usage("/")
usage(total=488008343552, used=202575314944, free=260620050432)
>>> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-05T09:25:10.150

也可以使用[Psutil 模块。](http://code.google.com/p/psutil/)

```
>>> psutil.disk_usage('/')
usage(total=21378641920, used=4809781248, free=15482871808, percent=22.5) 
```

文档可以在[这里](http://code.google.com/p/psutil/wiki/Documentation#Disks)找到。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-25T10:22:28.013

```
def FreeSpace(drive):
    """ Return the FreeSape of a shared drive in bytes"""
    try:
        fso = com.Dispatch("Scripting.FileSystemObject")
        drv = fso.GetDrive(drive)
        return drv.FreeSpace
    except:
        return 0 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-04-25T05:19:24.390

它不是独立于操作系统的，但这适用于 Linux，也可能适用于 OS X：

打印 commands.getoutput('df .').split('\n')[1].split()[3]

它是如何工作的？它得到“df”的输出。命令，它为您提供有关当前目录所属分区的磁盘信息，将其分成两行（就像它打印到屏幕上一样），然后取第二行（通过在后面附加 [1]首先 split())，然后*将该*行拆分为不同的以空格分隔的部分，最后为您提供该列表中的第 4 个元素。

```
>>> commands.getoutput('df .')
'Filesystem           1K-blocks      Used Available Use% Mounted on\n/dev/sda3             80416836  61324872  15039168  81% /'

>>> commands.getoutput('df .').split('\n')
['Filesystem           1K-blocks      Used Available Use% Mounted on', '/dev/sda3             80416836  61324908  15039132  81% /']

>>> commands.getoutput('df .').split('\n')[1]
'/dev/sda3             80416836  61324908  15039132  81% /'

>>> commands.getoutput('df .').split('\n')[1].split()
['/dev/sda3', '80416836', '61324912', '15039128', '81%', '/']

>>> commands.getoutput('df .').split('\n')[1].split()[3]
'15039128'

>>> print commands.getoutput('df .').split('\n')[1].split()[3]
15039128 
```

* * *

## 回答 #7

> 赞同：-5
> 
> 时间：2009-04-24T22:34:47.607

有什么问题

```
import subprocess
proc= subprocess.Popen( "df", stdout=subprocess.PIPE )
proc.stdout.read()
proc.wait() 
```

# c# - 我在哪里可以找到全球拥有机场的 IATA 城市列表？

> ID：787782
> 
> 赞同：1
> 
> 时间：2009-04-24T22:18:40.703
> 
> 标签：c#, service

我正在编写一个应用程序来显示城市之间的航班，并希望包含一个城市/国家和机场的组合供人们选择。然后我调用 GDS 网络服务来显示航班信息。但 GDS 并不能一次性为全球 IATA 城市/机场提​​供服务。有谁知道我可以获得此信息以将其放入 asp 组合中的合适来源？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-03-21T02:19:14.010

您可以从 OpenFlights 项目 (AGPL) 免费获取此类数据：http: [//openflights.org/data.html](http://openflights.org/data.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-24T22:29:20.567

[谷歌](http://www.google.com/search?q=IATA+city+list)给我找到了几个你正在寻找的链接：

*   [http://www.photius.com/wfb2001/airport_codes_alpha.html](http://www.photius.com/wfb2001/airport_codes_alpha.html)
*   [http://www.nationsonline.org/oneworld/IATA_Codes/airport_code_list.htm](http://www.nationsonline.org/oneworld/IATA_Codes/airport_code_list.htm)
*   [http://www.airport-technology.com/codes/](http://www.airport-technology.com/codes/)

并且可能是确定的，但您必须为此付费：

*   [http://www.iata.org/ps/publications/ccd.htm](http://www.iata.org/ps/publications/ccd.htm)

# iphone - 可以更改 iPhone 上某些像素的 alpha 值吗？

> ID：787783
> 
> 赞同：1
> 
> 时间：2009-04-24T22:19:33.960
> 
> 标签：iphone, opengl-es, cocos2d-iphone

是否可以仅更改 Sprite 的一部分 alpha 以响应用户交互？我的意思的一个很好的例子是 iFog 或 iSteam，用户可以在其中擦除 iPhone 屏幕上的“蒸汽”。由于用户可以触摸和移动的可能性非常多，因此交换图像是不可行的......

例如，假设你有一个简单的应用程序，它的背景是一堵砖墙，上面有涂鸦，所以会有两个精灵，一个是砖墙，一个是涂鸦，其 z 值高于砖墙。然后，根据用户触摸的位置（假设他们的触摸控制喷砂机），应该删除一些涂鸦，但不是全部，这可以通过更改涂鸦精灵的一部分的 alpha 值来完成。在 cocos2d-iphone 中有没有办法做到这一点？或者，我是否需要进入 openGL，如果需要，哪里是开始搜索如何完成此任务的好地方？

理想情况下，我想在 cocos2d-iphone Sprite 上完成此操作，但如果不可能，最好从哪里开始寻找？

在此先感谢，本

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-19T02:19:47.563

答案在这里： http: [//www.cocos2d-iphone.org/forum/topic/7921#post-46394](http://www.cocos2d-iphone.org/forum/topic/7921#post-46394)

但简短的回答：您必须覆盖 draw 方法并使用 openGL 方法。

我知道这个问题很老，但无论如何它都需要一个答案。

# twitter - 是否有人在他们的软件开发团队中使用 twitter（或 yammer 或 laconica）？想知道你的经历

> ID：787788
> 
> 赞同：0
> 
> 时间：2009-04-24T22:22:04.157
> 
> 标签：twitter, process

我想了解在他们的过程中使用 twitter（或 yammer 或 laconica）的软件开发团队。

你在报道什么？您是否有来自构建或测试机器的自动推文？

非常感谢您的回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T23:58:29.963

我们的开发团队都单独发布推文，但我们也有一个代表整个团队的 Twitter 帐户。用法尚未完全确定，但到目前为止我们已经尝试过：

*   宣布部署（“刚刚将 2.0.2737 推送到生产环境。详情请访问[http://tinyurl.org/12345](http://tinyurl.org/12345) ”）
*   长期运行工具的自动更新（“Phoenix 迁移已完成 23%，目前平均为 13 秒/单元。预计将于 2009 年 5 月 7 日完成”

我们努力关注客户关心的信息。一个有用的 Twitter 服务必须在信息太少和太多之间取得微妙的平衡。对于经常发生的事情，比如持续集成构建，我们只是在内部发送电子邮件。这是每个团队成员都*需要*知道的，而且受众是明确的，所以我们可以推动这一点。诸如生产推送之类的事情有更广泛的受众和广泛的兴趣水平，因此像 Twitter 这样的被动服务非常适合在方便的时候向关心的人提供这些信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-24T23:44:38.390

Russ Fustion（来自微软）在奥兰多（佛罗里达）代码训练营中展示了一个在自动构建完成时发送推文的示例。您可以观看[视频](http://channel9.msdn.com/toolshed/)。

基本上这个想法是，对于拥有定期重新构建整个应用程序的构建服务器的团队，构建服务器可以发送一条推文通知所有团队成员构建完成以及成功/失败状态。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-26T14:44:05.357

我开始在我们的 Intranet 上使用 Laconica 来捕获预定批处理作业的事件和 Subversion 提交的更新。我使用了一个使用 curl 的简单批处理文件。我在这里发布了示例：[SVN Post-Commit to Laconica](http://jimsloan.wordpress.com/2009/05/14/svn-post-commit-to-laconica/)

# css - 对 CSS 缩小器有什么建议吗？

> ID：787789
> 
> 赞同：291
> 
> 时间：2009-04-24T22:22:11.723
> 
> 标签：css, minify

对 CSS 缩小器有什么建议吗？

我会在谷歌周围扎根并尝试一些，但我怀疑聪明、精通和奇帅的 StackOverflow 社区可能已经评估了重量级人物的优缺点。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2009-04-24T22:34:20.477

[YUI Compressor](http://yui.github.io/yuicompressor/)非常棒。它适用于 JavaScript 和 CSS。一探究竟。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-07-07T00:30:35.760

YUI Compressor还有[一个 .NET 端口，](http://yuicompressor.codeplex.com/)可让您：-

*   将缩小/文件合并到 Visual Studio 构建后事件中
*   集成到 TFS 构建（包括 CI）
*   如果您只想在自己的代码中使用 dll（例如即时缩小）。

2011 年更新：[现在也可以通过 NuGet 获得](http://nuget.org/List/Packages/YUICompressor.NET):)

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2009-07-07T00:40:12.870

我喜欢[缩小](http://code.google.com/p/minify/)。在 PHP 中使用 CSS 或 JavaScript。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2011-10-04T04:28:38.330

[CSSO](https://github.com/css/csso)目前是最好的缩小器/优化器。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-11-17T01:47:09.503

如果您使用 Python，我会推荐[slimmer](http://pypi.python.org/pypi/slimmer/)，它可能不如 YUI Compressor 快，但与 csscompressor.net 不同，它不会因 CSS hacks 而窒息。

因为我写的更苗条，所以我有偏见，我目前正在评估 YUI Compressor 以了解它如何处理黑客攻击。如果您查看 crosstips.org 的来源，可以看到一个更苗条的示例

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-10-27T22:41:26.647

如果您正在寻找在线工具，请尝试以下操作：[https ://csscompressor.net/](https://csscompressor.net/)

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2011-04-04T15:55:01.410

查看 CSSTidy：[http ://csstidy.sourceforge.net/usage.php](http://csstidy.sourceforge.net/usage.php)

并在网上：[http ://cdburnerxp.se/cssparse/css_optimiser.php](http://cdburnerxp.se/cssparse/css_optimiser.php)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2010-02-08T13:02:21.060

我用 C# 编写了一个超快的 CSS 缩小器。该算法虽然不处理 Javascript。你这个：[http](http://www.ko-sw.com/Blog/post/An-Ultra-Fast-CSS-Minify-Algorithm.aspx) ://www.ko-sw.com/Blog/post/An-Ultra-Fast-CSS-Minify-Algorithm.aspx 。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2012-03-28T11:53:17.550

尝试[关闭样式表](http://code.google.com/p/closure-stylesheets)。

除了缩小**之外**，它还支持**linting**、**RTL 翻转**和**类重命名**。

 ******它还可以向 CSS添加**变量**、**函数**、**条件**和**混合。**

另请注意，其中一些功能依赖于其他[闭包工具](https://developers.google.com/closure)（它们本身非常强大）。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2011-03-14T19:11:35.620

Perl 有[CSS::Minifier](http://search.cpan.org/perldoc?CSS%3a%3aMinifier)（和一个 XS 版本以提高速度）。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2010-07-26T15:33:47.777

我发现 isoop 的[CSS SuperScrub](http://isnoop.net/tools/css.php)效果很好。它只能处理在线 CSS 的直接链接：/ 你可以通过使用首选的 pastebin 服务来保存 css 代码并只给 SuperScrub 原始链接来解决这个问题。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2010-02-18T06:10:23.027

如果您正在寻找 PHP 中的内容，请点击以下链接：-

[无脂肪缩小](http://razorsharpcode.blogspot.com/2010/02/lightweight-javascript-and-css.html "无脂肪缩小")

虽然它是 PHP Fat-Free Framework 的一部分，但它也可以单独使用。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2011-04-13T18:30:34.630

其他人提到了 YUI Compressor，然后是它的 .NET 端口，我将在链中添加另一个链接。[StyleManager](http://www.gstylemanager.com)是一个服务器控件，它封装了 YUI Compressor 的 .NET 端口，因此您可以像使用 ScriptManager 一样使用它。它还添加了许多其他不错的功能，例如 CSS 常量、波浪号 (~) 分辨率以及背景图像定义等。它很紧凑，有据可查，我在我最近的所有项目中都使用了它/一个问题。看看 - [gStyleManager.com](http://www.gstylemanager.com)

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2010-11-24T15:00:48.737

仍然“处于测试阶段”，但应该工作得相当好。我在每个项目中都使用它背后的代码：http: [//claudiu.phpfogapp.com/](http://claudiu.phpfogapp.com/)它是用 PHP 构建的，并且在相当长的时间内托管您的 *.css 文件，这足以让您使用缩小的CSS。（如果服务器上的空间变得拥挤，我只会删除旧的 css 文件）。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2010-11-11T02:32:52.837

如果您的网站在 ASP.NET 中，您可以让您的网站即时进行 CSS 缩小（因此您不必每次进行更改时都手动进行）。例如：

[http://www.codeproject.com/KB/aspnet/CombineAndMinify.aspx](http://www.codeproject.com/KB/aspnet/CombineAndMinify.aspx)

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2011-07-31T23:42:33.610

This is how I did it for MVC3: [http://mkramar.blogspot.com/2011/08/css-and-javascript-minify-and-combine.html](http://mkramar.blogspot.com/2011/08/css-and-javascript-minify-and-combine.html) The beauty of this approach is that it does it all on the fly and you don't have to pre-process files manually or configure post-build.

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2011-06-17T08:39:14.877

有一个 codeplex 项目将插入 .net 网站，该网站将缩小和压缩 CSS 和 JS 文件。Microsoft AJAX Minifier 和 YUI Compressor 之间也有一个比较，显示 YUI 稍微好一点。还有一个额外的变体，它结合了 Microsoft Minifier 和压缩，极大地压缩了文件。

无论如何，链接是 [http://xpedite.codeplex.com/wikipage?title=Minifier%20(CSS%2FJavaScript%20Minification%20Handlers](http://xpedite.codeplex.com/wikipage?title=Minifier%20(CSS%2FJavaScript%20Minification%20Handlers) )

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2010-09-23T02:31:24.790

一个在线工具（比 www.csscompressor.net 提升了我的 css 好得多）：[http](http://www.cssdrive.com/compressor/compress.php) ://www.cssdrive.com/compressor/compress.php做得很好。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-11-14T13:40:53.063

C# 示例：

```
css = css.Replace("\n", "");
css = Regex.Replace(css, @"\s+", " ");
css = Regex.Replace(css, @"\s*:\s*", ":");
css = Regex.Replace(css, @"\s*\,\s*", ",");
css = Regex.Replace(css, @"\s*\{\s*", "{");
css = Regex.Replace(css, @"\s*\}\s*", "}");
css = Regex.Replace(css, @"\s*\;\s*", ";"); 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2011-04-30T05:39:53.103

[zbugs.com](http://www.zbugs.com)对你来说是一个很好的在线工具，它会通过单击缩小你的 css

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2011-05-24T11:56:10.993

看看Paul Irish的最新[HTML5BoilerPlate - 它包含一个构建脚本，用于缩小所有资产（包括 PNG 和 JPG）。](https://github.com/paulirish/html5-boilerplate)[您可以在此处](http://www.youtube.com/watch?v=OXpCB3U_4Ig)观看演示视频。

# asp.net-mvc - ASP.NET MVC：如何在除一个视图之外的所有视图上呈现部分视图？

> ID：787790
> 
> 赞同：1
> 
> 时间：2009-04-24T22:22:45.013
> 
> 标签：asp.net-mvc, partial-views

我有一个名为 LogOnUserControl 的部分视图/用户控件，它显示在我网站的侧栏中（在 Site.Master 中定义）。我还有一个单独的 LogOn 视图，它也呈现 LogOnUserControl。

我不希望 LogOn 视图中有两个 LogOnUserControl 实例，因为这很容易混淆，所以我目前的想法是包含一个条件，例如

```
// Semi-pseudocode
if (!Request.IsAuthenticated) && View.Name != "LogOn") 
```

在 LogOnUserControl 中。

这感觉不对，因为局部视图现在知道 LogOn 视图。另外，我不知道如何获取视图的名称，这强化了我做错了什么的感觉！:-)

**编辑：** Site.Master 中的 LogOn 视图和侧边栏都使用相同的局部视图，这更加复杂。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-24T22:40:56.297

您是否考虑过在侧边栏中没有登录部分的情况下为您的登录视图使用不同的母版页？如果您担心 html 标记的重复，您可以使用嵌套母版页来避免该问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T03:13:10.590

在母版页上，用内容区域标签包装侧边栏区域的内容，并给它一个像 SideBarContentArea 之类的 id。这样做是创建一个新的内容区域，您可以选择在基于主页面的页面上覆盖它，并指定当您未在子页面上实现时将显示的默认内容。现在在登录页面上，您所要做的就是覆盖 SideBarContentArea 并且这次不包括登录控件。

八大兵！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-24T23:59:12.677

您可以在 ViewData 中存储一个标志来指示这一点。无论您是想对其进行强类型还是直接访问它都取决于您。所以在你的母版页上你可以有这个：

```
<% if (ViewData["HideLogOnUserControl"] == "Y") { %>
    Insert HTML here
<% } else { %>
    Insert HTML here
<% } %> 
```

# asp.net - 如何通过 jQuery 禁用 asp.net 单选按钮列表

> ID：787796
> 
> 赞同：0
> 
> 时间：2009-04-24T22:26:40.123
> 
> 标签：asp.net, javascript, jquery, radiobuttonlist

我有一个复选框和单选按钮列表，定义如下：

```
<asp:CheckBox id="chkChange" runat="server" text="Enable" />
<br />
<asp:RadioButtonList id="rblConsole" runat="server" cssclass="console">
    <asp:ListItem text="XBox 360" value="xbox" />
    <asp:ListItem text="Playstation 3" value="playstation" />
</asp:RadioButtonList> 
```

这些控件位于带有母版页的内容页中，因此实际呈现的 html 为：

```
<table id="ctl00_ContentPlaceHolder1_rblConsole" class="console" border="0">
    <tr>
        <td><input id="ctl00_ContentPlaceHolder1_rblConsole_0" type="radio" name="ctl00$ContentPlaceHolder1$rblConsole" value="xbox" /><label for="ctl00_ContentPlaceHolder1_rblConsole_0">XBox 360</label>
        </td>
    </tr>
    <tr>
        <td><input id="ctl00_ContentPlaceHolder1_rblConsole_1" type="radio" name="ctl00$ContentPlaceHolder1$rblConsole" value="playstation" /><label for="ctl00_ContentPlaceHolder1_rblConsole_1">Playstation 3</label>
        </td>
    </tr>
</table> 
```

在 javascript onclick 复选框上，我想禁用 rblConsole 单选按钮列表中的单选按钮。

我试图通过 jQuery endwith 选择器访问单选按钮：

```
function ToggleEnabled() {
        var isChecked = $("*[id$='chkChange']").is(":checked");
        if (isChecked) {
            $("*[name$='rblConsole'").removeAttr("disabled");
        } else {
            $("*[name$='rblConsole'").attr("disabled", "disabled");
        }
    } 
```

那么，如何通过 jQuery 禁用这些？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-24T22:42:18.430

首先，去掉属性选择器中的撇号

```
function ToggleEnabled() {
        var isChecked = $("*[id$='chkChange']").is(":checked");
        if (isChecked) {
            $("*[name$=rblConsole").removeAttr("disabled");
        } else {
            $("*[name$=rblConsole").attr("disabled", "disabled");
        }
    } 
```

其次，最好使用控件的 ClientID 属性来获取元素 id：

```
function ToggleEnabled() {
        var isChecked = $("#<%=chkChange.ClientID %>").is(":checked");
        if (isChecked) {
            $("#<%=rblConsole.ClientID %>").removeAttr("disabled");
        } else {
            $("#<%=rblConsole.ClientID %>").attr("disabled", "disabled");
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T23:54:03.483

我错过了选择器中的右方括号。它应该是：

```
$("*[name$='rblConsole']").attr("disabled", "disabled"); 
```

嗬！我的错。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-26T05:12:44.560

下面的代码对我有用，

禁用

```
$("table[id$=<%= rblConsole.ClientID %>] input").attr("disabled", "disabled"); 
```

对于启用

```
$("table[id$=<%= rblConsole.ClientID %>] input").removeAttr("disabled"); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-08-07T08:25:50.230

请检查：

```
$("input[type=radio][value=EIN]").prop("disabled", true); 
```

# git - 如何提交 git 标签？

> ID：787797
> 
> 赞同：15
> 
> 时间：2009-04-24T22:26:45.863
> 
> 标签：git, version-control, git-tag

我已成功地对中央 git 存储库进行、提交和推送更改。我现在意识到我想标记所有文件的当前版本。所以我这样做：

```
git tag -a 0.5 
```

那成功了。但现在我尝试 a `git push`，我被告知没有什么可以提交的。如何将我的新标签推送到中央存储库？

（请注意，`git tag`显示标签 0.5，但仅在本地显示）

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-04-24T22:28:36.950

我想你想要

```
git push --tags 
```

那样，好吧，推送你所有的标签:)

当然还有一些替代方案，这是 git 和 all（用您选择的 repo 替换 origin）：

```
git push origin tag 0.5 
```

或者

```
git push origin refs/tags/0.5:refs/tags/0.5 
```

有关详细信息，请参阅[git-push(1)](http://www.kernel.org/pub/software/scm/git/docs/git-push.html)。“ [git ready ” 在他们的](http://www.gitready.com/)[标签](http://www.gitready.com/beginner/2009/02/03/tagging.html)文章中也有一些有用的信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-23T08:51:21.303

从[git 1.8.3 (April 22d, 2013) 开始](https://github.com/git/git/blob/master/Documentation/RelNotes/1.8.3.txt#L131-L132)，尝试：

```
git push --follow-tags 
```

当你推送新的提交时，这些提交引用的任何标签也会被推送。*在您的情况下，已经*
推送 的提交引用的任何标签也应该被推送。

 *这允许您在推送提交*和*标签时始终使用一个命令。

# apache-flex - Flex、Ant 和 TeamCity

> ID：787798
> 
> 赞同：1
> 
> 时间：2009-04-24T22:27:07.233
> 
> 标签：apache-flex, ant, teamcity

是否有人使用 TeamCity 构建他们的 Flex 应用程序？我们将 .Net 用于我们的主站点代码和后端 flex 数据调用，我们将 flex 用于我们的应用程序。我有一个可用的 Ant 构建脚本，但我无法让它与 TeamCity Ant Runner 一起运行。我很好奇是否有人得到了这个工作，如果他们有，我可以潜在地看到你的构建脚本的样本吗？

由于某种原因，构建脚本不会为 Flex Ant 任务选择 FLEX_HOME 环境变量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-01T09:00:15.447

我不明白为什么它不应该工作。只需在 Ant 脚本的顶部声明 FLEX_HOME，然后指向 TeamCity 机器上的 sdk，例如：

```
<property name="FLEX_HOME" value="c:/adobe/flex/sdk/3.3"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T00:06:22.083

在我之前参与的一个项目中，我们的情况与您完全相同，它可以工作。尽管我们可能不得不在 TeamCity 配置中手动设置一些环境变量，但我不记得做了什么特别的事情来实现这一点。查看[TeamCity 文档](http://www.jetbrains.net/confluence/display/TCD4/6.Properties+and+environment+variables)，了解如何设置这些以及如何使用[它们](http://www.jetbrains.net/confluence/display/TCD4/Using+Properties)

您也可以尝试使用基本的命令行运行器来查看是否有效。在 TeamCity 中对环境变量问题进行故障排除时，我发现让构建过程的一部分运行 DOS*设置*命令（ Linux 的*env*）然后查看构建日志以查看实际环境是很有用的。

# python - threading.Thread 如何在 Python 中产生剩余的量子？

> ID：787803
> 
> 赞同：47
> 
> 时间：2009-04-24T22:29:18.820
> 
> 标签：python, multithreading, yield

我有一个正在轮询硬件的线程。

```
while not hardware_is_ready():
    pass
process_data_from_hardware() 
```

但是还有其他线程（和进程！）可能有事情要做。如果是这样，我不想烧毁 CPU 每隔一条指令检查一次硬件。自从我处理线程以来已经有一段时间了，当我处理线程时，它不是 Python，但我相信大多数线程库都有一个`yield`函数或允许线程告诉调度程序“给其他线程一个机会”的功能。

```
while not hardware_is_ready():
    threading.yield()          # This function doesn't exist.
process_data_from_hardware() 
```

但是我在线程文档中找不到对此类内容的任何引用。Python 确实有一个`yield`声明，但我很确定这完全是另一回事（与生成器有关）。

在这里做什么是正确的？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-04-26T04:39:41.263

`time.sleep(0)`足以产生控制 - 无需使用正 epsilon。实际上，`time.sleep(0)`意味着“屈服于任何其他可能准备好的线程”。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-04-24T22:31:16.740

阅读全局解释器锁 (GIL)。

例如：http: [//jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/](http://jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/)

另外： http: [//www.pyzine.com/Issue001/Section_Articles/article_ThreadingGlobalInterpreter.html](http://www.pyzine.com/Issue001/Section_Articles/article_ThreadingGlobalInterpreter.html)

如果您必须进行**忙碌等待**（例如轮询设备），请在您的代码中执行此操作。

```
time.sleep( 0.0001 ) 
```

这将屈服于线程调度程序。

[另外，我在http://homepage.mac.com/s_lott/iblog/architecture/C551260341/E20081031204203/index.html](http://homepage.mac.com/s_lott/iblog/architecture/C551260341/E20081031204203/index.html)中收集了一些笔记和参考资料

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-25T01:37:31.847

如果您在 *nix 上执行此操作，您可能会发现[select](http://docs.python.org/library/select.html)库很有用。 [Kamaela](http://www.kamaelia.org/Home)还有一些您可能会觉得有用的组件，但它可能需要进行一些范式更改。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-05-04T05:31:56.773

为什么产量`time.sleep(0)`可能不够：

我遇到了类似的问题，最终`time.sleep(0)`在所有情况下都没有工作`time.sleep(0.0001)`。在我的例子中，我使用标准的 vanilla cpython——可以在 python.org 找到。`sleep(0)`查看 C 代码中 sleep 函数的实现，调用和之间存在细微差别`sleep(something_other_than_null)`。

查看[timemodule.c 中的 pysleep，](https://github.com/python/cpython/blob/3.10/Modules/timemodule.c#L2052)您会看到在第一种情况下

```
if (ul_millis == 0 || !_PyOS_IsMainThread()) {
  Py_BEGIN_ALLOW_THREADS
  Sleep(ul_millis);
  Py_END_ALLOW_THREADS
  break;
} 
```

叫做。“允许线程”释放 GIL，`Sleep(0)`在这种情况下相当于`std::this_thread::yield()`，然后再次声明 GIL。在处理非零值的代码中，除了实际的睡眠/等待之外，还有对[PyErr_CheckSignals](https://docs.python.org/3/c-api/exceptions.html#c.PyErr_CheckSignals)的额外调用- 如其文档中所述，“检查信号是否已发送到进程，如果是，则调用相应的信号处理程序”。这可以解释为什么在某些情况下使用硬件 a`time.sleep(0)`是不够的。所以这可能是 cpython 实现方面的一个失误。这就是为什么`time.sleep(0.0001)`神奇地起作用的原因。

# javascript - 调用 jQuery 效果太快会破坏我的插件

> ID：787805
> 
> 赞同：0
> 
> 时间：2009-04-24T22:29:51.440
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins

我正在编写一个基于很棒的 jGrowl 插件的自定义 jQuery 插件。我只需要它做一些比它已经做的更多的事情。

基本上一切都按照我的需要工作（到目前为止只在 Firefox 中测试过），除了如果你调用插件的次数太快，它会停止并破坏一切

[http://jsbin.com/ofejo/edit](http://jsbin.com/ofejo/edit)

关于可能导致这种情况的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T03:41:33.750

听起来您需要实现回调功能并将额外的调用放入回调中，以确保插件在其他执行发生之前处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T03:02:02.503

它正在渲染并尝试计算放置块的位置，但由于动画已经发生而失败。（通常，动画会更改用于创建效果的显示样式的类型，这会导致诸如此类的计算出现异常）

您需要对效果进行排队，但我不确定您将如何处理它，因为您正在创建新元素，并且源代码比我现在愿意查看的要多。让我知道这是否有帮助。

*   [http://docs.jquery.com/Effects/queue](http://docs.jquery.com/Effects/queue)

# linq-to-sql - 将 LinqToSql DAL 转换为 EntityFramework

> ID：787807
> 
> 赞同：1
> 
> 时间：2009-04-24T22:30:23.653
> 
> 标签：linq-to-sql, entity-framework

我有一个刚刚超过 1 年的应用程序，但它仍在不断发展，并且可能会在中短期内越来越多地围绕不断增长的数据库模式展开。该应用程序是使用 LinqToSql 编写的，它很好地满足了我们的需求。我们遇到了一些痛点，但已经解决了这些问题。我目前认为这个应用程序对数据库的要求相当低。

既然 EntityFramework 似乎是微软正在推动人们走向的 ORM，我想知道我们是否不可避免地要朝那个方向迁移。

我听说过很多关于 EntityFramework 的好与坏。所以我想知道我是现在冒险还是等待 VS10 到来时等待 v2.0 更好？有什么想法吗？如果我现在这样做，我会失去任何功能吗？

如果我决定迁移，任何人都可以向我指出一些有关所涉及内容的资源吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-24T22:35:17.230

重新等待还是现在改变？就个人而言，我会等待（请参阅[您认为切换到实体框架是否有利？](https://stackoverflow.com/questions/276433/do-you-think-its-advantageous-to-switch-to-entity-framework)）对于 VS2010（至少） - 直到测试版发布之前，我无法检查我在 L2S 中使用的 EF 缺少的东西是否是尚未实施。

资源等问题可能是[How to move from Linq 2 SQL to Linq 2 Entities?](https://stackoverflow.com/questions/589906/how-to-move-from-linq-2-sql-to-linq-2-entities) ?

# c++ - 如何清理复杂的 QList？

> ID：787809
> 
> 赞同：1
> 
> 时间：2009-04-24T22:31:01.047
> 
> 标签：c++, qt, qlist, qhash

我在 QAbstractTableModel 的派生中使用了一个相当复杂的 QList 来存储数据：

```
class MyTableModel : public QAbstractTableModel {
     Q_OBJECT   
     QList<QHash<int, QHash<int, QVariant> *> *> m_data;
     /*...*/
};

MyTableModel::~TMusicTableModel() {
     /* Should I deallocate QList items? */
}

MyTableModel::setData(int row, int col, int type, QVariant value) {
    /* inserting a new data field */
    QHash<int, QHash<int, QVariant> *> *row_hash = new QHash<int, QHash<int, QVariant> *>();
    QHash<int, QVariant> *role_hash = new QHash<int, QVariant>();
    type_hash->insert(type, value);
    row_hash->insert(col, type_hash);
    m_data.insert(row, row_hash);
    return true;
} 
```

我想知道 QList 和 QHashes 是否会处理交易，或者我是否应该这样做。在这种情况下，文档的信息量不是很大。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T13:53:56.460

因为您正在使用“new”创建子项目，所以您必须自己解除分配它们。请参阅 qDeleteAll 函数以快速执行此操作。

您使用 new 来创建这些哈希是否有原因？（您的代码显然只是一个片段，因此可以在其他地方使用和传递指针。）通常，在堆栈上构造它们要简单得多，这样销毁就会自动发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T00:16:05.163

与几乎任何 C++ 库中的任何其他容器类一样，破坏它也会激活其中元素的析构函数。这对于简单`MyClass array[3]`的、STL`vector<MyClass>`和 QT都是如此`QList<MyClass>`。
为确保一切都被销毁，您需要确保 MyClass 有一个析构函数，它确实释放了所有资源。拥有指针的 QList 不遵循此规则，因为指针没有析构函数。相反，您可能想要使用 boost 的 shared_ptr 或编写自己的智能指针包装器。

# installation - 如何在 WiX 中为用户输入创建自定义对话框？

> ID：787811
> 
> 赞同：30
> 
> 时间：2009-04-24T22:31:18.973
> 
> 标签：installation, wix

我正在使用 WiX 为 Windows 服务创建安装程序。安装并显示在服务中的服务名称最好在安装时进行配置。

例如，这就是我的想法（wix xml snip）：

```
<ServiceInstall 
    Id="MyServiceInstaller" 
    Name="NAME_PASSED_FROM_DIALOG" 
    Type="ownProcess" 
    Start="auto" 
    ErrorControl="normal" 
    Description="My Service" 
    Account="localsystem"/> 

<ServiceControl
    Id="StartMyServiceInstaller" 
    Name="NAME_PASSED_FROM_DIALOG" 
    Start="install"
    Wait="no" />

<ServiceControl
    Id="StopMyServiceInstaller" 
    Name="NAME_PASSED_FROM_DIALOG" 
    Remove="uninstall"
    Stop="both"
    Wait="yes" /> 
```

NAME_PASSED_FROM_DIALOG 是我想连接到一个自定义对话框，该对话框被创建并显示给安装服务的人，以便他们可以设置/修改服务名称。我认为这与设置并传递给 WixUI_InstallDir 对话框集的 WIXUI_INSTALLDIR 属性非常相似。

我的问题是：

如何创建可以接受传递到安装程序运行时的用户输入的自定义 UI 对话框？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-04-24T22:41:28.947

玩得开心！

编辑：答案的原始链接不再存在。FireGiant（Wix 的维护者）为这个过程的一部分提供了[一些示例](https://www.firegiant.com/wix/tutorial/user-interface-revisited/)，但它并没有完全回答这个问题。还有[一个进一步的教程](https://web.archive.org/web/20171124135345/http://www.merlinia.com:80/mdt/WiXTutorial2.msl)（**2018 年 8 月更新**：从 Wayback Machine 复活的链接）在很大程度上回答了这个问题。

将要发生的事情的高级概述是：

1.  创建属性
2.  让 UI 控件设置此属性
3.  服务上的名称属性将引用该属性，即[ServiceNameProperty]。

然而，这很复杂，建议创建一个新的 UI 对话框的方法是获取一个现有对话框，对其进行克隆，然后使用新文本、控件进行编辑并使用它来填充属性。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-07-15T11:57:29.793

尝试使用 [WixEdit](http://wixedit.sourceforge.net/) ，它是创建 UI 的好工具

# python - 如何在 Ubuntu 8.10 上安装没有 python-gnome2-desktop 的 python-rsvg？

> ID：787812
> 
> 赞同：4
> 
> 时间：2009-04-24T22:32:09.190
> 
> 标签：python, librsvg, rsvg

我需要 Python 2.5.2 中的 rsvg 支持。看来我必须安装所有 199 个*deps*以及包 python-gnome2-desktop，这听起来一点也不好玩。

备择方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T00:37:04.130

不再相关。安装了整个软件包，并以这种方式获得了 rsvg。

# c - NaN 作为特殊参数

> ID：787828
> 
> 赞同：2
> 
> 时间：2009-04-24T22:40:58.263
> 
> 标签：c

我正在编写一个可以设置范围的小库；起点和终点是双打的。该库具有该范围的一些内置或计算的默认值，但是一旦它们由范围设置功能设置，就无法返回到默认值。

因此我喜欢做的是使用 NaN 值作为指标来使用默认值，但是我还没有找到 NaN 的任何标准定义，并且阅读 gcc 手册它说有些平台不支持 NaN .

我的问题是：

最近有没有不使用 IEEE 754 浮点数的平台？我不关心一些模糊的嵌入式设备，因为 lib 专注于具有 GUI 的平台，准确地说是 cairo。

第二个问题你会使用 NaN 值作为参数来达到这个目的吗？我在标题中的某个位置定义它没有问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-24T23:45:38.577

NaN 不等于任何数字，甚至不等于它自己。因此，将其用作指标将导致复杂的代码甚至错误。我不会以这种方式使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-24T23:44:12.620

我不会为此目的使用 NaN - 除了使用***哪个***NaN（并且有很多）的问题之外，最好添加一个函数调用 API 以重置为默认值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T23:46:23.427

NaN 在代码中处理起来有点奇怪，我当然不希望一个库将它们用于它们不是为了它们的目的。

编辑：我刚刚想到的另一个问题是，如果计算结果为 NaN，并且将其作为参数传递，则会出现意外行为。例如：

```
MyFunc(SomeCalculation()); //if SomeCalculation() is assumed to not be NaN,
                           //this will cause unintended behavior 
```

# html - 我如何在 XML 中存储富文本格式，这些格式会拉出到我的页面格式化

> ID：787835
> 
> 赞同：1
> 
> 时间：2009-04-24T23:36:04.887
> 
> 标签：html, xml, xslt

我在我的数据库中通过具有 wiki 样式格式（粗体*文本*，_text 下划线等）的表单存储用户输入。我计划使用 db 函数和一些页面代码将所有信息存储到 XML 中，并为包含的每个富文本字段提供正确的 html 格式。从那里 XML 被解析为 XSL 样式表。我无法弄清楚的一件事是如何让 HTML 显示为 HTML。我可以让它在屏幕上显示代码，但不能显示格式化的 html。

有谁知道 A) 获取 xml 文件中的 html 并将其作为格式化的 html 显示在屏幕上或 B) 如何使用 XSL 用 html 查找/替换我的 wiki 格式

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T00:35:14.027

所以，如果我理解正确，你有一些带有 html 格式的 xml，如下所示：

```
<foo><strong>blah <a href="/">bar</a></strong></foo> 
```

在 foo 中显示 html 的 xsl 是：

```
<xsl:template match="foo">
    <xsl:copy-of select="."/>
</xsl:template> 
```

# c++ - 如何开始基于nucleus RTOS的中国手机开发？(MTK)

> ID：787838
> 
> 赞同：19
> 
> 时间：2009-04-24T23:40:11.693
> 
> 标签：c++, mobile, embedded, mobile-phones

我注意到中国手机变得非常流行，也许是因为它们非常合理的价格和许多现代功能（触摸屏、高级多媒体、双卡等）。

我想知道作为独立开发者是否有任何方法可以为这款手机开发定制解决方案？如何获取工具包和文档？

我找到了一些资源，但主要是不一致的技术说明，通常只有中文。目前我知道，大多数中国手机都是基于联发科（MTK）的芯片，操作系统基于Nucleus RTOS和MMI（plutoMMI？）框架。不幸的是，没有可用的 Java RE（好吧，有一些带有 Java 的手机，但是，Java 不是我要找的东西）

是否有任何 SDK、文档、模拟器/模拟器、操作方法等可用？如何为 MTK 移动开发、部署和测试自定义应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-25T07:52:38.190

我是设计公司的工程师。我有MT系列手机的MTK开发平台，有英文解释。原始版本和手册是用英文编写的（大约 300mb pdf 文件）。SDK 有用 Visual C++ 编写的模拟器。在核 rtos 操作系统下工作的 MMI 接口。代码是 V++。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-11T01:42:11.017

我与很多中国手机制造商合作，因为我们从中国出口手机。我真的很想为这些基于 MTK 的设备构建一个新的应用程序，尤其是一个电子邮件程序。现在看 6225 平台有点晚了，因为 6235 平台似乎是我们将看到未来增长最多的地方。我知道的 6235 和 6225 之间的主要区别是 6235 支持 Wi-Fi，与 EDGE 配合使用，并且速度更快。

史蒂夫，你提到了 G2。我认为Android将成为中国手机制造的突破性操作系统。一旦他们的本地工程师和设计师掌握了它，大量荒谬和有用的应用程序和模型就会蓬勃发展，并且不会像我们现在看到的 Windows Mobile 设备那样出现重大的出口（海关）问题（因为中国人通常不'不提供许可软件）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-11T01:46:49.933

MTK 服务是收费的。您需要联系他们并支付芯片、软件 SDK、文档和技术支持的费用。

我不知道你从哪里得到“一些资源”，但它必须是他们的某个客户泄露的，因此使用这些资源将被视为非法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-02-14T23:47:49.133

对于平台来源，这可以是一个起点：

[https://www.mentor.com/embedded-software/downloads/nucleus-source-interest_reg](https://www.mentor.com/embedded-software/downloads/nucleus-source-interest_reg)

我对 RTOS 没有真正的经验，我是 GNU/Linux 人

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-08T05:32:44.717

我刚买了一台 SciPhone G2 Dream 并做了一些初步调查。这款特殊的手机运行 J2ME 应用程序，但我也想知道使用本机应用程序可以做什么（如果有的话）。理想情况下，我想让我的蓝牙 GPS 与这款手机配合使用。

[这个页面](http://amimjf.connectfree.co.uk/public2/compilers.html)讨论了让 GCC 与 Nucleus 一起工作，但我不确定这是否有用。

[Mentor](http://www.mentor.com/products/embedded_software/evaluate/edge)（Nucleus 的制造商）提供了他们的开发者套件的试用版。我刚刚申请了免费试用。该网站没有提及费用，这有点令人担忧。他们也有一个模拟器。

你得到了什么样的手机，你打算开发什么样的应用程序？

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-09-05T15:23:34.453

我和你一样，试图选择一款具有 WIFI 和可用 SDK 的智能手机，成本低（低于 40 美元）。也联系联发科没有结果。我可以给你一个建议，其实就是我现在正在做的事情。尝试与供应商协商批量采购以及访问 SDK 和文档。我之前使用基于 ARM 的 Thinclient 并工作过，但我必须购买 30 台。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-06T02:17:40.787

我不太清楚你所说的“中国”电话是什么意思。但是，您可能正在谈论 ODM 手机。大多数时候，这些手机是常规手机的系统克隆，并进行了一些定制。买一个然后拆开看看它在哪个平台上运行可能是个好主意。也许它使用 OMAP 或其他东西？在这种情况下，您可能对如何进行有更多的了解。也许它甚至与 Linux 兼容。

# html - 使用 CSS 按比例调整图像大小？

> ID：787839
> 
> 赞同：705
> 
> 时间：2009-04-24T23:40:17.793
> 
> 标签：html, css, image-resizing

有没有办法只使用 CSS 按比例调整（缩小）图像的大小？

我正在使用 JavaScript 方式，但只是想看看这是否可以通过 CSS 实现。

* * *

## 回答 #1

> 赞同：813
> 
> 时间：2010-04-26T08:28:25.797

要使用 CSS 按比例调整图像大小：

```
img.resize {
    width:540px; /* you can use % */
    height: auto;
} 
```

* * *

## 回答 #2

> 赞同：260
> 
> 时间：2013-03-19T14:17:58.030

控制大小并保持比例：

```
#your-img {
    height: auto; 
    width: auto; 
    max-width: 300px; 
    max-height: 300px;
} 
```

* * *

## 回答 #3

> 赞同：124
> 
> 时间：2013-12-20T17:30:56.107

如果是背景图片，请使用 background-size:contain。

示例 CSS：

```
#your-div {
  background: url('image.jpg') no-repeat;
  background-size:contain;
} 
```

* * *

## 回答 #4

> 赞同：86
> 
> 时间：2014-01-17T02:49:06.740

尝试

```
transform: scale(0.5, 0.5);
-ms-transform: scale(0.5, 0.5);
-webkit-transform: scale(0.5, 0.5); 
```

* * *

## 回答 #5

> 赞同：66
> 
> 时间：2016-09-08T16:19:46.783

您可以使用**对象拟合**属性：

```
.my-image {
    width: 100px;
    height: 100px;
    object-fit: contain;
} 
```

这将适合图像，而不会按比例改变。

* * *

## 回答 #6

> 赞同：54
> 
> 时间：2013-09-29T15:07:39.427

请注意，这`width:50%`会将其大小调整为图像**可用空间的 50%**，而`max-width:50%`将图像大小调整**为其自然大小的 50%**。在使用此规则进行移动网页设计时要考虑这一点非常重要，因此`max-width`应始终使用移动网页设计。

**更新：**这可能是一个旧的 Firefox 错误，现在似乎已经修复。

* * *

## 回答 #7

> 赞同：50
> 
> 时间：2013-12-10T18:01:29.503

通过保持图像的纵横比来缩放图像

尝试这个，

```
img {
  max-width:100%;
  height:auto;
} 
```

* * *

## 回答 #8

> 赞同：30
> 
> 时间：2012-01-12T17:43:41.680

Revisited in 2015:

```
<img src="http://imageurl" style="width: auto; height: auto;max-width: 120px;max-height: 100px"> 
```

I've revisited it as all common browsers now have working auto suggested by Cherif above, so that works even better as you don't need to know if image is wider than taller.

older version: If you are limited by box of 120x100 for example you can do

```
<img src="http://image.url" height="100" style="max-width: 120px"> 
```

* * *

## 回答 #9

> 赞同：26
> 
> 时间：2009-04-24T23:47:15.967

```
<img style="width: 50%;" src="..." /> 
```

对我来说工作得很好......或者我错过了什么？

**编辑：**但请参阅肖恩关于意外升迁的警告。

* * *

## 回答 #10

> 赞同：24
> 
> 时间：2009-04-24T23:49:01.233

css 属性 max-width 和 max-height**很好**用，但 IE6 不支持，我相信 IE7。您可能希望在高度/宽度上使用它，以免意外放大图像。您只想按比例限制最大高度/宽度。

* * *

## 回答 #11

> 赞同：19
> 
> 时间：2017-06-21T19:36:17.760

```
img{
    max-width:100%;
    object-fit: scale-down;
} 
```

为我工作。它会缩小较大的图像以适合盒子，但将较小的图像保留为原始大小。

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2018-07-23T23:21:44.393

我相信这是最简单的方法，也可以通过标签`style`内的 inline 属性使用。`<img>`

```
.scaled
{
  transform: scale(0.7); /* Equal to scaleX(0.7) scaleY(0.7) */
}

<img src="flower.png" class="scaled"> 
```

或者

```
<img src="flower.png" style="transform: scale(0.7);"> 
```

* * *

## 回答 #13

> 赞同：13
> 
> 时间：2014-07-01T14:28:29.713

使用这种简单的缩放技术

```
img {
    max-width: 100%;
    height: auto;
}
@media {
  img { 
    width: auto; /* for ie 8 */
  }
} 
```

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2013-05-21T05:43:19.993

```
img {
    max-width:100%;
}

div {
    width:100px;
} 
```

使用此代码段，您可以以更有效的方式进行操作

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2017-08-23T08:22:21.917

我们可以使用媒体查询和响应式设计原则在浏览器中使用 CSS 调整图像大小。

```
 @media screen and (orientation: portrait) {
img.ri {
    max-width: 80%;
  }
} 
```

```
@media screen and (orientation: landscape) {
  img.ri { max-height: 80%; }
}
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2014-06-24T08:30:27.487

你总是需要这样的东西

```
html
{
    width: 100%;
    height: 100%;
} 
```

在你的 css 文件的顶部

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2016-03-06T22:17:18.800

尝试这个：

```
div.container {
    max-width: 200px;//real picture size
    max-height: 100px;
}

/* resize images */
div.container img {
    width: 100%;
    height: auto;
} 
```

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2018-01-29T04:56:37.307

`image_tag("/icons/icon.gif", height: '32', width: '32')` 我需要将 height: '50px', width: '50px' 设置为图像标签，并且此代码从第一次尝试就可以使用 注意我尝试了上述所有代码但没有运气，所以这个可以工作，这是我的 _nav.html 中的代码。 erb：
`<%= image_tag("#{current_user.image}", height: '50px', width: '50px') %>`

# python - Python 字符串中的大小写不敏感

> ID：787842
> 
> 赞同：4
> 
> 时间：2009-04-24T23:42:44.807
> 
> 标签：python

我知道您可以使用 ctypes 库对字符串执行不区分大小写的比较，但是我也想执行不区分大小写的替换。目前我知道这样做的唯一方法是使用正则表达式，这样做似乎有点糟糕。

是否有不区分大小写的 replace() 版本？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-25T00:00:19.133

您可以将标志 re.IGNORECASE 提供给 re 模块中的函数，如[文档](http://docs.python.org/library/re.html)中所述。

```
matcher = re.compile(myExpression, re.IGNORECASE) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-25T15:19:17.287

`re`即使您认为它很复杂，使用也是最好的解决方案。

用 替换所有出现的`'abc'`, `'ABC'`,`'Abc'`等，`'Python'`例如：

```
re.sub(r'(?i)abc', 'Python', a) 
```

示例会话：

```
>>> a = 'abc  asd   Abc  asd  ABCDE    XXAbCXX'
>>> import re
>>> re.sub(r'(?i)abc', 'Python', a)
'Python  asd   Python  asd  PythonDE    XXPythonXX'
>>> 
```

请注意，在正则表达式开头的嵌入如何`(?i)`使其区分大小写。还要注意正`r'...'`则表达式的字符串文字（在这种特定情况下是多余的，但只要您的正则表达式中有反斜杠`(\)`，它就会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-24T23:59:12.707

最简单的方法是将其全部转换为小写，然后进行替换。但是，如果您想保留原始案例，显然是一个问题。

我会做一个正则表达式替换，你可以指示正则表达式引擎一起忽略大小写。

有关示例，请参[见此站点。](http://www.akeric.com/blog/?p=312)

# apache - Apache 资源使用 vs Mongoose 或其他轻量级 Web 服务器

> ID：787844
> 
> 赞同：2
> 
> 时间：2009-04-24T23:43:21.047
> 
> 标签：apache, resources, mongoose-web-server

Apache Web 服务器使用多少内存和/或其他资源？

轻量级服务器的效率高多少？说 appache vs. Mongoose Web Server

尼尔巴特沃斯你在外面吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T00:09:08.037

是的，轻量级服务器在内存和资源方面的效率更高，正如术语“轻量级”所表明的那样。nginx 是一个流行的。

Apache 的内存和资源使用在很大程度上取决于您正在使用它做什么——加载了哪些模块、您的 PHP 等脚本在做什么。没有单一的答案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-11T14:13:55.713

您必须考虑您的特定任务，以及几乎每个 Web 服务器都有某种专业化（利基）这一事实。Apache 是可配置且稳定的。nginx 非常快，但仅适用于静态上下文。lighttpd 体积小、速度快，可以同时处理静态和动态上下文。Mongoose 可嵌入、小巧且易于使用。

还有更多的 Web 服务器，我不会在这里列出整个列表。您需要确定您的任务需要哪些功能，并相应地做出选择。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-26T15:15:47.490

如果您需要通过各种 mod 提供的大量灵活性，Apache Httpd 非常棒。如果您正在寻找直接文件服务或代理，那么一些轻量级选项可能会更好。我管理每天获得数百万次点击的 Maven Central 存储库，并且我对 Nginx 有一些经验。

# python - python 2.5过时了吗？

> ID：787849
> 
> 赞同：2
> 
> 时间：2009-04-24T23:45:06.500
> 
> 标签：python

我只是在安装 python 2.5 的 ubuntu 8.04 机器上学习 python。2.5 是否过时了，无法继续学习？2.5版本中有多少在新版本中仍然是有效的python代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-24T23:50:10.217

基本上，python 代码，暂时将分为 python 2.X 代码和 python 3 代码。Python 3 打破了许多改变，以清理语言。大多数代码和库都是为 2.X 编写的。最好学习一个，并知道与另一个有什么不同。在 ubuntu 机器上，该`python3`包将安装 Python 3，它可以使用 command 运行`python3`，至少在我的 8.10 安装中。

要回答您的问题，学习 2.5 很好，只要记住 3 是一个重大变化，并学习这些变化 - 在编写代码时问自己，“如果有的话，在 3 中会有什么不同？”。

（顺便说一句，我确实希望 Ubuntu 能够升级到 2.6。它有一个很好的兼容模式，可以尝试并指出潜在的困难。但是 python 在现代 Linux 发行版上的使用非常广泛，要做出改变可能会很困难)

[这是一篇描述 2.6 -> 3 更改的文章](http://docs.python.org/3.0/whatsnew/3.0.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-24T23:51:54.067

Python 2.5 可以用于学习目的。出于学习的兴趣，您可能希望了解 python 3.0 引入的[差异](http://docs.python.org/3.0/whatsnew/3.0.html)，但我认为大多数 Python 社区仍在使用 Python 2，因为大多数库尚未移植。

如果你对 2.6 感兴趣，[这里](http://www.saltycrane.com/blog/2008/10/installing-python-26-source-ubuntu-hardy/)有一篇关于在 Hardy 上编译它的博客文章，甚至可能在互联网上的某个地方有一个包。

跟进，如果有一个包裹我找不到它。对于大多数事情来说，自编译非常简单，尽管我从未尝试过编译 Python。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T23:51:13.553

我不认为它使用起来“过时”，但 python 2.6 中有一些非常好的特性，值得更新。[本文](http://docs.python.org/whatsnew/2.6.html)将为您详细介绍。只要你能控制机器，就值得了。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-25T00:09:15.820

我没有任何统计数据，但我的印象是 Python 2.5 是当今使用最多的版本。它当然没有“过时”——我仍然使用 Python 2.5，并且我希望我会在未来几周或几个月内使用它。

但是，如果您有 Python 2.6，我建议您升级，因为它仍然与 Python 2.5 非常相似，但会让您在使用 Python 3 时处于更好的位置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-25T00:55:39.983

此外，现在 2.x 分支是最受支持的分支，所以我还要说从该版本开始是一个很好的理由。

当时机成熟时，您可以随时切换到 Python 3。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-04-25T01:18:56.637

Python 2.5*很好。* 仍然有很多人在使用 Python 2.4 和 2.3。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-25T00:02:52.700

关于 python 2.6 要记住的一件事是某些库可能无法正常工作。 [Numpy浮现](http://numpy.scipy.org/)在脑海中。

# python - 使用 PyOpenAL 时正确的清理方法是什么？

> ID：787850
> 
> 赞同：0
> 
> 时间：2009-04-24T23:45:17.593
> 
> 标签：python, openal

我正在使用 Python 寻找 PyOpenAL 的一些声音需求（显然）。文档很少（由一个演示脚本组成，未经修改就无法工作），但据我所知，有两层。OpenAL 调用的直接包装和轻量级的“pythonic”包装器——我关心的是后者。具体来说，如何正确清理？如果我们举一个小例子：

```
import time

import pyopenal

pyopenal.init(None)

l = pyopenal.Listener(22050)

b = pyopenal.WaveBuffer("somefile.wav")
s = pyopenal.Source()
s.buffer = b
s.looping = False

s.play()

while s.get_state() == pyopenal.AL_PLAYING:
    time.sleep(1)

pyopenal.quit() 
```

实际上，一条消息按照“一个源未删除，一个缓冲区未删除”的行打印到终端上。但我假设我们不能对这些对象使用本机 OpenAL 调用，那么我该如何正确清理呢？

编辑：

我最终放弃了 pyopenal 并在 OpenAL 和 alure 上编写了一个小的 ctypes 包装器（pyopenal 公开了直接的 OpenAL 函数，但我一直得到 SIGFPE）。仍然好奇我应该在这里做什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-17T11:05:42.880

```
#relese reference to l b and s
del l
del b
del s 
#now the WaveBuffer and Source should be destroyed, so we could:
pyopenal.quit() 
```

退出之前可能会析构 pyopenal 调用`quit()`，因此您不需要自己调用它。

# c# - 同一会话中的多个 WebRequest

> ID：787857
> 
> 赞同：17
> 
> 时间：2009-04-24T23:48:07.273
> 
> 标签：c#, asp.net, html

我正在尝试编写一个将网页（及其图像）保存为 html 页面的函数。我正在使用 HttpWebRequest 来请求网页的内容。我的功能看起来像

```
void SaveUrl(string sourceURL, string savepath)
{
    HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(sourceURL);
    HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse();
    StreamReader responseReader = new StreamReader(response.GetResponseStream());

    string sResponseHTML = responseReader.ReadToEnd();
    using (StreamWriter sw = new StreamWriter(savepath, false))
    {
        sw.Write(sResponseHTML);
    }

    string[] ImageUrl = GetImgLinks(sResponseHTML);
    foreach (string imagelink in ImageUrl)
    {
        HttpWebRequest imgRequest = (HttpWebRequest)WebRequest.Create(imagelink);
        HttpWebResponse imgresponse = (HttpWebResponse)imgRequest.GetResponse();
        //Code to save image
    }
} 
```

我的问题是我想在同一个会话中创建所有 webrequest，并且不想为每个 imgRequest 创建一个新会话，因为我网页上的许多图像都是动态生成的并且是临时存储的。所以只有当我在同一个会话中发出请求时才能获取这些图像。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-04-25T00:32:09.243

会话通常使用 cookie 工作。如果您希望所有请求都属于同一会话，则需要在请求之间保留 cookie。为此，您可以创建一个 CookieContainer 并将其提供给每个 HttpWebRequest 对象。

这是您的代码更新为使用 CookieContainer：

```
 void SaveUrl(string sourceURL, string savepath) {
        CookieContainer cookies = new CookieContainer();
        HttpWebRequest webRequest = (HttpWebRequest)WebRequest.Create(sourceURL);
        webRequest.CookieContainer = cookies;

        HttpWebResponse response = (HttpWebResponse)webRequest.GetResponse();
        StreamReader responseReader = new StreamReader(response.GetResponseStream());

        string sResponseHTML = responseReader.ReadToEnd();
        using (StreamWriter sw = new StreamWriter(savepath, false)) {
            sw.Write(sResponseHTML);
        }

        string[] ImageUrl = GetImgLinks(sResponseHTML);
        foreach (string imagelink in ImageUrl) {
            HttpWebRequest imgRequest = (HttpWebRequest)WebRequest.Create(imagelink);
            imgRequest.CookieContainer = cookies;
            HttpWebResponse imgresponse = (HttpWebResponse)imgRequest.GetResponse();
            //Code to save image
        }
    } 
```

# awk - 无法在 AWK 中创建阶乘函数

> ID：787858
> 
> 赞同：-1
> 
> 时间：2009-04-24T23:48:37.773
> 
> 标签：awk, factorial

**编码**

```
 #!/usr/bin/awk            

 # Sed and AWK by O'Reilly (p.179)

 # Example of what should happen: factorial 5 gives
 #   factorial
 #   Enter number: 3
 #   The factorial of 3 is 6

 BEGIN {
     printf("Enter number: ")
 }

 $1 ~ /^[0-9]+$/ {
     # assign value of $1 to number & fact
     number = $1 
     if (number == 0) 
         fact = 1
     else
         fact = number

     for (x = 1; x < number; x++)
         fact *=x
     printf("The factorial of %d is %g\n", number, fact)

     exit
 }

 # if not a number, prompt again.
 { printf("\nInvalid entry. Enter a number: ")
 } 
```

我通过以下方式运行命令失败

```
./factorial.awk 
```

我明白了

```
/usr/bin/awk: syntax error at source line 1
 context is
         >>>  <<< ./factorial.awk
/usr/bin/awk: bailing out at source line 1 
```

**错误信息是什么意思？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T15:59:17.410

我认为问题在于您正在编写一个 shell 脚本并将其传递给 awk 执行。以下是一个 shell 脚本，因此是`#! /bin/sh`, 所以它将被传递给 shell（在这种情况下与 Bourne 兼容）。

```
#! /bin/sh
awk 'BEGIN { printf("Hello world!\n"); exit }' 
```

she-bang (#!) 行告诉当前解释器将脚本传递给哪个解释器执行。您必须将脚本传递给`awk`解释器，因此您需要`awk`显式调用。这假设它`awk`在你的路径中的某个地方。

但是，以下是一个`awk`脚本。

```
#! /usr/bin/awk -f
BEGIN {
    printf("Hello world!\n");
    exit
} 
```

she-bang 调用`awk`并将脚本作为输入传递。在这种情况下，您不需要显式调用`awk`，也不必引用整个脚本，因为它直接传递给`awk`.

将 she-bang 想象为在 she-bang*后面加上文件名，然后执行它*。[维基百科](http://en.wikipedia.org/wiki/Shebang_(Unix))很好地描述了这种用法，包括一些解决[*解释器问题路径的*](http://en.wikipedia.org/wiki/Shebang_(Unix)#Solving_shebang_problems_with_the_env_program)常用方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-23T02:39:18.490

可能没那么复杂。

#!/usr/bin/awk ---------> #!/usr/bin/awk -f

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-04-24T23:51:37.593

可能是一个愚蠢的答案，但在我的终端中我必须输入：

```
./factorial.awk 
```

其中文件是 factorial.awk。

您可以编辑路径环境变量以包含 . 但是 ./ 我认为应该可以正常工作。并添加 . 在某些情况下，你会运行你没想到的代码，到 $PATH 可能会被证明是非常危险的。

那样有用吗？？

编辑：

./factorial.awk -bash: ./factorial.awk: /usr/bin/gawk: 错误的解释器：没有这样的文件或目录

这表示它运行了文件但找不到程序 gawk。请输入“which gawk”，然后输入“which awk”。

你的第一行应该是：

```
#!/usr/bin/awk 
```

另外，为了逗我开心，输入：

```
sudo apt-get install gawk 
```

这将确保您实际上对您的系统有 gawk。

EDIT2：我查看了您的代码，这就是我现在所拥有的。我删除了两个引号和一个破折号。

```
#!/usr/bin/gawk                                                                                                                                        

# I think we do not need these (p.179) so I comment them out, since I do not know where else to put them.
# The same bug occurs also with them.
#fact = number
#for (x = number -1 ; x > 1; x--)
#    fact *= x

awk # factorial: returns factorial of user-supplied number
    BEGIN {
    printf("Enter number: ")
    }

   $1 ~ /^[0-9]+$/ {
   # assign value of $1 to number & fact
   number = $1 
   if (number == 0) 
       fact = 1
   else
       fact = number
   #loop to multiply fact*x until x = 1
   for (x = number - 1; x > 1; x--)
       fact *= x
   printf("The factorial of %d is %g\n", number, fact)
   #exit -- saves user from typing ^-d
   exit
}

# if not a number, prompt again.
{ printf("\nInvalid entry. Enter a number: ")
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-25T00:02:48.347

检查是否有文件`/usr/bin/gawk`；如果没有，请使用 awk 的路径或 gawk 的正确位置。

另外，您是否使脚本可执行？

而且，您的 PATH 中是否有当前目录？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-25T21:59:59.180

我通过运行使脚本在 Ubuntu 和 OS X 中工作

```
awk -f factorial.awk 
```

尽管书上这样说，但您似乎无法按以下方式运行脚本

```
./factorial.awk 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-25T06:29:33.910

这是一个递归版本：

```
#!/usr/bin/awk -f
function f(x) {
    if (x <= 1) return 1
    return (f(x-1) *x)} 

BEGIN {
    printf("Enter number: ")
}

$1 ~ /^[0-9]+$/ {
    printf("The factorial of %d is %d\n", $1, f($1))
    exit
}

{ printf("\nInvalid entry. Enter a number: ")
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-04-17T17:46:44.997

这个问题是谷歌搜索短语“awk factorial”的热门问题，所以这里有一个在 awk 中打印阶乘的简单方法：

```
$ awk 'BEGIN{x=1;for(i=2;i<=6;i++)x*=i;print x}'
720 
```

作为一个 shell 函数（后面的空格`-v`是 macOS 自带的 nawk 需要的，但 gawk 不需要）：

```
$ fac(){ awk -v "n=$1" 'BEGIN{x=1;for(i=2;i<=n;i++)x*=i;print x}';}
$ fac 6
720 
```

作为计算 k 组合的 awk 函数：

```
$ awk 'function f(x){r=1;for(i=2;i<=x;i++)r*=i;return r}BEGIN{n=5;k=3;print f(n)/(f(k)*f(n-k))}'
10 
```

# c - 使用 C 预处理器重构的典型 C

> ID：787861
> 
> 赞同：2
> 
> 时间：2009-04-24T23:50:00.297
> 
> 标签：c, refactoring

我正在开发一个支持预处理器的 C 重构工具......我不知道大型 C 项目中涉及的重构类型，我想知道人们在重构 C 代码（和预处理器指令）时实际做了什么

我还想知道是否某些工具中不存在某些真正有趣的功能，因此必须完全手动完成重构...例如，我已经看到外部参照无法重构用作的宏迭代器（虽然不知道这到底是什么意思）......

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2010-03-10T20:42:01.843

任何对此感兴趣的人（特定于 C），可能想看看[coccinelle 工具](http://coccinelle.lip6.fr/)：

> Coccinelle 是一个程序匹配和转换引擎，它提供语言 SmPL（语义补丁语言）用于在 C 代码中指定所需的匹配和转换。Coccinelle 最初的目标是在 Linux 中执行附带演变。这种演变包括客户端代码中响应库 API 演变所需的更改，并且可能包括修改，例如重命名函数、添加其值在某种程度上依赖于上下文的函数参数以及重新组织数据结构。除了附带演变之外，Coccinelle 还成功地用于（我们和其他人）查找和修复系统代码中的错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T00:47:17.117

巨大的话题！

*   我需要清理的东西是扭曲的巢穴`#ifdefs`。重构工具会了解条件内容何时出现在参数列表（函数声明或定义）中，并对其进行改进。

*   如果它真的很好，它会认识到

    ```
    #if defined(SysA) || defined(SysB) || ... || defined(SysJ) 
    ```

    真的相当于：

    ```
    #if !defined(SysK) && !defined(SysL) 
    ```

    如果你做到了，我会感到惊讶。

*   它可以让我指定“现在定义了这个宏——哪些代码是可见的”（意思是对编译器可见）；它还允许我选择查看不可见的代码。

*   它将处理一个跨越 100 多个顶级目录的系统，这些目录下有不同级别的子目录。它将处理数以万计的文件，在某些地方长度为 20K 行。

*   它将识别宏定义来自makefile而不是头文件的位置（啊！）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T02:03:25.763

好吧，因为它是预处理器的一部分……#include 重构是一个巨大的话题，我不知道有什么工具可以做得很好。

工具可以解决的小问题：

*   在#includes 中强制使用一致的大小写和反斜杠
*   强制执行一致的标头保护约定，自动添加多余的外部保护等。

工具可以解决的更难的问题：

*   查找和删除虚假包含。
*   建议在可行的情况下使用预先声明。

对于宏...也许某种范围界定会很有趣，如果您在块内#define 一个宏，该工具将在块的末尾自动#undef 它。我能想到的其他快速的事情：

*   对宏安全性的快速分析可能会有所帮助，因为很多人仍然不知道使用 do { } while (0) 和其他技术。
*   或者，查找并标记带有副作用的表达式作为宏参数传递的位置。这可能对诸如......带有无意副作用的断言非常有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T00:48:37.410

宏通常会变得非常复杂，所以我不会尝试支持简单的重命名。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-24T23:59:29.027

我会诚实地告诉你，没有像 Java 那样重构 C++ 的好工具。其中大部分将是痛苦的搜索和替换，但这取决于实际任务。查看 Netbeans 和 Eclipse C++ 插件。

> 例如，我已经看到外部参照无法重构用作迭代器的宏（虽然不知道这意味着什么）

老实说，你可能有点不知所措——考虑一下你是否是这项任务的合适人选。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T01:55:51.023

如果您可以在具有任意复杂目录层次结构的大型项目上处理各种类型、变量和宏的**可靠重命名，我想使用您的产品。**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-06-17T08:06:35.443

刚刚发现了这个老问题，但我想提一下，我已经拯救了 Xrefactory for C 的免费版本，现在命名为[`c-xrefactory`](https://github.com/thoni56/c-xrefactory)，它设法在宏中进行一些重构，例如重命名宏、重命名宏参数。

# html - CSS相对定位的奇怪挑剔问题

> ID：787868
> 
> 赞同：1
> 
> 时间：2009-04-24T23:52:11.803
> 
> 标签：html, css

今天我在整理一个快速的“正在建设”类型的页面时注意到一个不寻常的问题，我正在使用相对定位将文本移动到图像上。（如果你关心的话，这个页面是由 SO 的离线页面“启发”的）

```
<html>
  <head>
    <title>Bronco Marching Band</title>
  </head>
  <body style="background-color: #888;">
    <div style="text-align: center;">
      <img src="standby.jpg" width="799px" height="600px" alt="Please Stand By"
       title="The Bronco Band website is down for a major upgrade. Please check back later." 
       style="width: 620px; height: 465px; opacity: 0.8;" />
      <div style="color: #C69C6D; font-size: 397%; font-weight: bold; font-family: sans, arial, helvetica; position: relative; top: -300px; left: 0px;">
        PLEASE STAND BY
      </div>
    </div>
  </body>
</html> 
```

似乎是以前相对定位的div所在的区域还在占用空间。即，如果没有定位，它会在 div 所在的图像下方留下空白。

有没有办法解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-25T00:03:35.130

相对定位的元素仍然占用空间。您实际上想要一个绝对定位的元素......您只希望它相对于容器绝对定位！

```
<div style="text-align: center;position:relative; zoom: 1;"> 
  <img src="standby.jpg" width="799px" height="600px" alt="Please Stand By" title="The Bronco Band website is down for a major upgrade. Please check back later." style="width: 620px; height: 465px; opacity: 0.8;" /> 
  <div style="color: #C69C6D; font-size: 397%; font-weight: bold; font-family: sans, arial, helvetica; position: absolute; top: 200px; left: 0px; width: 100%; text-align:center"> 
    PLEASE STAND BY 
  </div> 
</div> 
```

主要变化：

*   容器`div`有`position: relative`样式集
*   Child`div`具有`position: absolute`样式集，使其定位在*parent 内的*绝对坐标处。
*   我相对于父级的顶部定位，并使定位的`div`全宽允许`text-align: center`工作。

**编辑：** 为了让 IE6 正确定位，我使用了一个 hack 来强制容器 DIV 的布局：`zoom: 1`样式。如果不需要支持 IE6，可以省略此项。

*测试：FF3、IE6、Chrome1、Chromium2*

演示：http: [//jsbin.com/uqisa](http://jsbin.com/uqisa)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T00:02:23.433

而不是这样：

```
position: relative;
top: -300px; 
```

试试这个：

```
margin-top: -300px; 
```

另外，在您的`<img />`标签中，您还应该更改此内容：

```
width="799px" height="600px" 
```

对此：

```
width="799" height="600" 
```

# ruby-on-rails - 使用 form_for 的 RESTful 方式？

> ID：787869
> 
> 赞同：1
> 
> 时间：2009-04-24T23:52:12.320
> 
> 标签：ruby-on-rails, forms, rest, form-for

我正在尝试使用 form_for 来实现与我创建的无表搜索模型一起使用的搜索表单。搜索表单不断触发“索引”操作。我假设我应该使用“新”来创建表单并“创建”搜索查询的过程。查看日志，我的 POST 变成了 GET。这是我的代码：

/searches/new.html.erb：

```
<% form_for :searches, @search, :url => searches_path, :html => {:method => :post} do |f| %>
  <%= f.error_messages %>
  <p>
    <%= f.label :keywords %><br />
    <%= f.text_field :keywords %>
  </p>
  <p><%= f.submit "Submit" %></p>
<% end %> 
```

使用 form_for 触发“创建”操作的标准方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-27T07:28:44.700

`form_for`与模型一起使用。对于一个简单的搜索表单，我建议这样做：

```
<% form_tag posts_path, :method => :get do |f| %>
  <%= f.text_field :query %>
<% end %> 
```

你会得到`/posts?query=wtf`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T16:15:54.857

你在使用 RESTful`map.resources :searches`吗？
如果是这样，您不`:url`应该设置为`new_search_path`吗？

# java - 在 J2ME 中将缓冲区旋转到播放器的替代方法？

> ID：787870
> 
> 赞同：6
> 
> 时间：2009-04-24T23:53:59.087
> 
> 标签：java, streaming, java-me, mmapi

由于许多 J2ME 手机的（相当烦人的）限制，音频文件在完全下载之前无法播放。因此，为了播放实时流，我不得不一次下载块，并构建`ByteArrayInputStream`s，然后将其提供给玩家。

这很好用，除了每次流结束并且需要一个新的流时会有大约 1/4 秒的令人讨厌的间隙。有没有办法解决这个问题，或者上面的问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-27T12:49:28.893

使用 J2ME JSR135 播放长（3 分钟或更长时间）曲目的唯一好方法，适度可靠，在最大数量的手机上，是在创建播放器时使用“file://”url，或者输入流实际上来自 FileConnection。

最近的黑莓手机只有在有大的 Java 堆内存可用时才能使用 ByteArrayInputstream。

许多在 Symbian 操作系统上运行的手机将允许您将文件放在 J2ME 应用程序的私有区域中，同时仍然能够在同一位置播放曲目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-27T07:09:07.057

不幸的是，您无法摆脱这些差距，至少在我尝试过的任何设备上都没有。确实很烦人。您不能通过 HTTP 流式传输音频或视频，这是规范的一部分。

如果您想从服务器流式传输，唯一的方法是使用[RTSP](http://en.wikipedia.org/wiki/Real_Time_Streaming_Protocol)服务器，尽管您需要检查您的设备上对此的支持。

并且使用设备上的本地服务器（rtsp：// localhost ...）伪造RTSP也不起作用..我也试过了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T00:43:32.103

EDIT2：或者你可以看看这似乎正是你想要的：http: [//java.sun.com/javame/reference/apis/jsr135/javax/microedition/media/protocol/DataSource.html](http://java.sun.com/javame/reference/apis/jsr135/javax/microedition/media/protocol/DataSource.html)

我会创建两个 Player 类，并确保在开始播放它们之前我已经收到了足够的块。然后我会开始通过播放器一播放第一个块并将第二个块加载到播放器二中。然后我会使用 TimeBase 类来跟踪已经过去了多少时间，当我知道第一个块将结束时（你应该知道每个块必须播放多长时间）然后我会开始通过第二个播放器播放第二个块并且将第三个块加载到第一个块中，依此类推，直到没有更多块可以播放。

这里的关键是正确使用 TimeBase 类来知道何时进行转换。我认为这应该消除块之间烦人的 1/4 秒间隔赌注。我希望这行得通，如果行得通，请告诉我，因为这听起来很有趣。

编辑： Player.prefetch() 在减少延迟方面也可能有用。

# javascript - Safari 原生代码

> ID：787873
> 
> 赞同：2
> 
> 时间：2009-04-24T23:54:26.073
> 
> 标签：javascript, webkit

有人熟悉 OS X Safari（版本 3 和 WebKit）中的本机代码吗？我正在使用 Javascript 解析表单中的一些信息，我的输入之一被命名为“标签”。尝试使用以下方法获取该元素的值时：

```
// button is being passed through a function as a DOM object
var tags = button.form.elements["tags"].value; 
```

Safari 返回某种功能。我已经让它提醒诸如“function tags() { [native code] }”和节点树之类的值，但我就是不明白为什么我会遇到麻烦。如果有人有线索，请告诉我。我已经通过将输入的名称更改为其他名称以及遍历所有元素并使用 if () 语句来确定它是否是我想要的元素来使其工作，但我非常好奇为什么苹果会限制使用任何名为“标签”的表单元素...

PS - 这是测试并且在 Firefox 中运行良好。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T00:21:27.960

`[native code]`只是意味着它是内置在浏览器中的函数，而不是用 JavaScript 编写的。`tags` [似乎是](http://trac.webkit.org/browser/trunk/WebCore/html/HTMLCollection.cpp#L453)DOM 的 WebKit 扩展，允许您通过标签名称获取表单中的元素列表。例如，如果我在 StackOverflow 页面上运行它，我会得到答案文本区域：

```
document.getElementById('submit-button').form.elements.tags("textarea")[0] 
```

问题是 JavaScript 中集合的索引也会访问任何对象属性（包括方法），因此当您尝试访问命名元素`tags`时，您会得到`elements`WebKit 定义的对象上的方法。幸运的是，有一个解决方法；您可以调用元素列表以通过或[`namedItem`](http://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-21069976)获取项目：`id``name`

```
var tags = button.form.elements.namedItem("tags").value; 
```

**编辑**：请注意，`namedItem`即使在其他浏览器中，它也可能更好地使用，以防您需要检索名为`item`或`length`类似的元素；否则，如果您将它们用作`[]`运算符的索引，您将获得内置方法`item`或`length`代替您的元素。

# javascript - 我怎样才能找到光标所在的单词

> ID：787874
> 
> 赞同：1
> 
> 时间：2009-04-24T23:55:01.470
> 
> 标签：javascript, textarea, cursor

如何在 IE 中检测光标所在的单词？我试过这段代码：

```
window.setInterval(function () {
    var range = document.selection.createRange();
    range.expand('word');
    var wort = range.text.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
    document.getElementById("ausgabe").innerHTML = wort;
}, 100)
```

```
<textarea id="ta" rows="10" cols="40">At vero eos et accu-samus et iusto? Odio, dignissimos. ducimus qui bländitiis praeséntium voluptatèm deleniti atque corrupti quos</textarea>
<p>[<span id="ausgabe"></span>]</p>
```

但是当我将光标设置在 Textarea 的开头和结尾时，就会出现问题。它给了我完整的文本。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-31T10:28:00.463

我确信有更好的方法来解决这个问题，所以我希望其他人也能对这个问题有所了解。该解决方案使用一些试验和错误来移动范围 - 如果事情如此错误，它会恢复到原始状态。

我希望这有帮助！

这是代码：

```
<html>
<body>
<script>
    window.setInterval(
        function () {
            var selection = document.selection;
            var range = document.selection.createRange();

            var parentEl = range.parentElement();

            // Make a duplicate range to revert to if things go wrong.
            range2 = range.duplicate();

            range.moveStart('character', 1);
            if (range.parentElement() != parentEl) {
                // We've left the original parent (which is bad), so revert to the original range. We're probably at the end of the textarea.
                range = range2.duplicate();
            }
            range.moveStart('word', -1);

            // Make a new duplicate range to revert to.
            range2 = range.duplicate();

            // Move the end of the range one backwards, then forward to the end of the word.
            range.moveEnd('character', -1);
            range.moveEnd('word', 1);
            if (range.parentElement() != parentEl) {
                range = range2.duplicate();
                while (range2.parentElement() == parentEl) {
                    range.moveEnd('character', 1);
                    range2 = range.duplicate();
                }
            }

            var wort = range.text.replace(/^\s\s*$/, '').replace(/\s\s*$/, '');
            document.getElementById("ausgabe").innerHTML = wort;
        }, 100
    )
</script>

    <textarea id="ta" rows="10" cols="40">At vero eos et accu-samus et iusto? Odio, dignissimos. ducimus qui bländitiis praeséntium voluptatèm deleniti atque corrupti quos</textarea>

<p>[<span id="ausgabe"></span>]</p>
</body>
</html> 
```

# c# - c#：如何在数字格式字符串中强制尾随零？

> ID：787883
> 
> 赞同：16
> 
> 时间：2009-04-25T00:01:49.597
> 
> 标签：c#, devexpress

我需要将浮动显示为

```
1.00
1.50
1.55
1.60 
```

以下是我使用 f2 格式看到的。

```
1.
1.5
1.55
1.6 
```

有没有办法强制出现尾随 0？

（我正在使用 DevExpress SpinEdit 控件并尝试设置显示和编辑格式。）

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2009-04-25T00:09:09.843

```
yourNumber.ToString("N2"); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-04-25T00:08:52.093

您可以使用如下语法：

```
String.Format("{0:0.00}", n) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-04-25T00:58:26.433

在极少数情况下我需要格式化，我去这里：

[http://blog.stevex.net/index.php/string-formatting-in-csharp/](http://blog.stevex.net/index.php/string-formatting-in-csharp/)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-25T00:14:00.783

备查，

[http://www.csharp-examples.net/string-format-double/](http://www.csharp-examples.net/string-format-double/)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-04-25T03:19:54.287

```
spinEdit.Properties.DisplayFormat.FormatType = FormatType.Numeric;
spinEdit.Properties.DisplayFormat.FormatString = "C2"; 
```

不过，在未来，我建议搜索[Dev Express 的知识库](http://devexpress.com/Support/Center/KB/)或发送电子邮件支持 (support@devexpress.com)。他们将能够在大约一天内回答您的问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-10-25T15:04:16.867

您也可以使用字符串插值来执行此操作（请注意，这是 C# 6 及更高版本）：

```
double num = 98765.4;
Console.WriteLine($"{num:0.00}"); //Replace "0.00" with "N2" if you want thousands separators 
```

# gcc - 试图不操作指令

> ID：787884
> 
> 赞同：1
> 
> 时间：2009-04-25T00:02:12.280
> 
> 标签：gcc, compiler-construction, linker, assembly, binutils

是否可以使用 GNU 工具（gcc、binutils 等）将所有出现的汇编指令修改为无操作？具体来说，带有 -pg 选项的 gcc 会生成以下程序集 (ARM)：

```
 0x0: e1a0c00d    mov ip, sp
   0x4: e92dd800    stmdb   sp!, {fp, ip, lr, pc}
   0x8: e24cb004    sub fp, ip, #4  ; 0x4
   0xc: ebfffffe    bl  0 <mcount> 
```

我想记录最后一条指令的地址，然后将其更改为 nop，如下面的代码所示

```
 0x0: e1a0c00d    mov ip, sp
   0x4: e92dd800    stmdb   sp!, {fp, ip, lr, pc}
   0x8: e24cb004    sub fp, ip, #4  ; 0x4
   0xc: e1a00000    nop         (mov r0,r0) 
```

Linux 内核可以在运行时执行与此类似的操作，但我正在寻找构建时解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-04-25T01:18:54.840

您可以编译代码`gcc -S`以输出汇编程序列表，而不是完全编译成目标文件或可执行文件。然后，只需用 no-ops 替换所需的指令（例如 using `sed`），然后从那里继续编译。

如果您还想对没有原始源代码的目标文件或库执行此操作，则必须使用诸如[`objdump(1)`](http://linux.die.net/man/1/objdump)反汇编之类的工具并获取要替换的指令的地址。然后，解析目标文件头以找到这些指令在文件中的偏移量，然后直接在目标文件中用 no-ops 替换机器指令。这有点棘手，但可行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-25T00:49:18.813

使用 RISC-ish 固定长度指令格式，这肯定比 x86 更容易。

使用 libelf 应该相对简单（这里的教程很好：http: [//people.freebsd.org/~jkoshy/download/libelf/article.html](http://people.freebsd.org/~jkoshy/download/libelf/article.html)）或 libbfd（[http://sourceware.org/binutils/docs-2.19 /bfd/index.html](http://sourceware.org/binutils/docs-2.19/bfd/index.html) ) 打开目标文件，修改 .text 部分中的指令，并使用提供的 API 再次将其写出。是否值得努力将取决于非技术方面的考虑（虽然我有点好奇......）。

值得一提的是，如果需要在交叉开发环境中工作，使用 libelf 或 libbfd 可能会有一些问题。

# c# - 你如何使用 var 关键字？

> ID：787887
> 
> 赞同：0
> 
> 时间：2009-04-25T00:02:40.703
> 
> 标签：c#, c#-3.0

> ## 复制
> 
> [在 C# 中使用 var 关键字](https://stackoverflow.com/questions/41479/use-of-var-keyword-in-c)
> [C# - 你使用“var”吗？](https://stackoverflow.com/questions/633474/c-do-you-use-var)
> [在 C# 3.0 中我是否应该*始终*支持隐式类型的局部变量？](https://stackoverflow.com/questions/17032/)

您是否愿意像这样编写代码：

```
var myVar = new MyClass(); 
```

或者

```
MyClass myVar = new MyClass(); 
```

我不反对使用上面示例中的`var` *关键字*；但是，在下面的代码中，我不喜欢`var`.

```
var files = Files.GetFiles(); 
```

在这个例子中，类型变量将是什么并不明显`files`。

您对使用`var` *关键字*的偏好是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T00:04:24.037

我倾向于在阅读源代码时可以推断变量类型的地方使用“var”，而无需导航到源代码中的其他地方。

例如，每当我新建一个对象时：

```
var c = new Customer(); 
```

或者在调用返回类型明确的方法时：

```
var c = Customers.GetCustomerByID(5); 
```

此外，在匿名类型的情况下*必须*使用“var” ：

```
var t = new { Key = "One", Value = 1 }; 
```

当然，我也将它与 LINQ 一起使用：

```
var q = from c in Customers
        where c.CustomerID == 5
        select c; 
```

在上面的例子中，'q' 是 IQueryable 类型（假设客户是客户对象的枚举）。

'foreach' 语句也是如此——请使用'var'：

```
foreach (var i in intArray) { /* use i */ } 
```

我敢肯定，其他例子比比皆是——但这些涵盖了我最常见的用例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-25T00:15:08.690

如果这是一种可以工作的情况（不包括匿名类型情况），我会尝试使用任何能让代码在未来更容易理解的东西。有时这意味着如果使用范围很小或分配给的类型难以处理（例如，某种嵌套的泛型），则使用 var 重复并增加混乱。我也倾向于在大多数人期望看到的地方使用 var（例如作为 linq 查询的声明）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T00:04:13.523

我认为最好只`var`在创建新对象（使用`new`）和使用 LINQ（当然）时使用。恕我直言，这使代码更容易理解。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-25T00:05:56.483

我可以在任何地方使用它。我认为它使代码更加干净和可读。（我在开玩笑吗？我只是按照 resharper 告诉我的去做 :)

[这个 SO 线程](https://stackoverflow.com/questions/633474/c-do-you-use-var)上的更多内容。

# ruby-on-rails - Ruby-OpenID：需要来自 OpenID 提供商的电子邮件地址

> ID：787894
> 
> 赞同：10
> 
> 时间：2009-04-25T00:04:28.280
> 
> 标签：ruby-on-rails, ruby, openid, authlogic, ruby-openid

我正在使用[authlogic-example-app](http://github.com/binarylogic/authlogic_example/tree/with-openid)并且当我注册用户时，我无法从 OpenID 提供商（在我的情况下：谷歌和雅虎）获取电子邮件地址。我得到一个空的回复而不是一个电子邮件地址（检查下面代码中的评论）。

这就是我的用户模型的样子（其他一切看起来像上面提到的 authlogic-example-app 的“with_openid”分支）。除了丢失的“电子邮件”之外，openid-authentication-process 按预期工作：

```
class User < ActiveRecord::Base
  acts_as_authentic do |c| 
    # not needed because I use OpenID
    c.validate_login_field = false
    # avoid failed validation before OpenID request
    c.validate_email_field = false
    # this one sets 'openid.sreg.required=email'
    c.required_fields = [:email]
  end

  private

  # overwriting the existing method in '/lib/authlogic_openid/acts_as_authentic.rb'
  def map_openid_registration(registration)
    # this is my problem: 'registration' is an empty hash
    self.email ||= registration[:email] if respond_to?(:email) && !registration[:email].blank?
  end

end 
```

知道如何解决这个问题吗？[在使用authlogic](http://github.com/binarylogic/authlogic_openid/tree/master)之前这里有人做过吗？甚至更好：你有一个有效的例子吗？

**更新**：我检查了[Google Account Authentication API](http://code.google.com/apis/accounts/docs/OpenID.html)并将[authlogic](http://github.com/binarylogic/authlogic_openid/tree/master)提交的请求（使用[ruby​​-openid-gem](http://openidenabled.com/ruby-openid/)和[openid-authentication-plugin](http://github.com/rails/open_id_authentication/tree/master)）与Google Account Authentication API 文档上的[示例请求进行了比较：](http://code.google.com/apis/accounts/docs/OpenID.html#Samples)

* * *

**Google 验证和获取电子邮件地址的示例请求**：

```
https://www.google.com/accounts/o8/ud
?openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0
&openid.claimed_id=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select
&openid.identity=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select
&openid.return_to=http%3A%2F%2Fwww.example.com%2Fcheckauth
&openid.realm=http%3A%2F%2Fwww.example.com%2F
&openid.assoc_handle=ABSmpf6DNMw
&openid.mode=checkid_setup
&openid.ns.ext1=http%3A%2F%2Fopenid.net%2Fsrv%2Fax%2F1.0
&openid.ext1.mode=fetch_request
&openid.ext1.type.email=http%3A%2F%2Faxschema.org%2Fcontact%2Femail
&openid.ext1.required=email 
```

* * *

**我的申请提交的请求**：

```
https://www.google.com/accounts/o8/ud
?openid.assoc_handle=AOQobUcdICerEyK6SXJfukaz8ygXiBqF_gKXv68OBtPXmeafBSdZ6576
&openid.ax.mode=fetch_request
&openid.claimed_id=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select
&openid.identity=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select
&openid.mode=checkid_setup
&openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0
&openid.ns.ax=http%3A%2F%2Fopenid.net%2Fsrv%2Fax%2F1.0
&openid.ns.sreg=http%3A%2F%2Fopenid.net%2Fextensions%2Fsreg%2F1.1
&openid.realm=http%3A%2F%2Flocalhost%3A3000%2F
&openid.return_to=http%3A%2F%2Flocalhost%3A3000%2Faccount%3Ffor_model%3D1%26_method%3Dpost%26open_id_complete%3D1
&openid.sreg.required=email 
```

在调试整个设置时，我发现[openid-authentication-plugin](http://github.com/rails/open_id_authentication/tree/master)在从 openid 提供者收到的响应中从未收到电子邮件，这至少解释了为什么`registration`我的用户模型中的哈希为空......

**更新**：如果您正在使用 authlogic 和 openid，请不要忘记查看[有关此主题的最新 railscast](http://railscasts.com/episodes/170-openid-with-authlogic)！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-30T23:14:09.350

由于没有人可以帮助我，我帮助自己。:-)

我的问题的简短回答是：

```
c.required_fields = [:email,"http://axschema.org/contact/email"] 
```

使用此行，应用程序使用 sreg 和 ax（Google 支持的请求类型）请求电子邮件地址。

您可以在这里找到更详细的答案和使用[Javascript OpenID-Selector](http://code.google.com/p/openid-selector/)的 authlogic-openid 的工作实现：

[http://github.com/vazqujav/authlogic_openid_selector_example/](http://github.com/vazqujav/authlogic_openid_selector_example/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-07-11T02:46:22.743

虽然这为我指明了正确的方向，但我需要的是：

```
c.openid_required_fields = [:email,"http://axschema.org/contact/email"] 
```

这拉入电子邮件并设置它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-10-04T22:56:04.070

```
# fetch email by ax
c.openid_required_fields = [
                            "http://axschema.org/contact/email",
                            "http://axschema.org/namePerson/first",
                            "http://axschema.org/namePerson/last",
                            "http://axschema.org/contact/country/home",
                            "http://axschema.org/pref/language"
                           ] 
```

这会获取指定的多个值 @ [http://code.google.com/apis/accounts/docs/OpenID.html#Parameters](http://code.google.com/apis/accounts/docs/OpenID.html#Parameters)

虽然我仍然无法获取国家/地区名称......名称，电子邮件，语言完美无缺！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T13:26:11.643

针对您控制的 OpenID 服务器进行测试，因为它可以让您调试 OpenID 序列的每个部分。无法保证 Google 的 OpenID 提供程序做的是正确的事情。尝试检查 Verisign 的服务器，因为我很确定至少应该在该`openid.sreg.required=email`领域做正确的事情。

你的代码片段对我来说很合适。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-04T03:12:09.623

问题是我能够从提供者那里获取参数，但无法从响应中提取它们...我使用 OpenID::AX::FetchResponse.from_success_response(open_id_response) 作为保存响应的对象。 . 我用什么方法来提取电子邮件、昵称、国家等...

# c# - 表单提交后重置textarea的值

> ID：787895
> 
> 赞同：32
> 
> 时间：2009-04-25T00:05:32.350
> 
> 标签：c#, asp.net-mvc, forms

1.  我想通过转到 /MyController/Message/3 向 userID=3 发送消息
2.  这将执行`Message()`[get] 操作，我在文本区域中输入一些文本，然后单击保存以发布表单
3.  `Message()`[post] 操作保存更改，将 SomeText 的值重置为空字符串并返回到视图。

此时我希望文本区域为空，因为我已设置`ViewData["SomeText"]`为`string.Empty`.

**为什么发布操作后文本区域值未更新为空字符串？**

以下是操作：

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult Message(int ID)
{
  ViewData["ID"] = ID;
  return View();
}

[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Message(int ID, string SomeText)
{
  // save Text to database
  SaveToDB(ID, SomeText);

  // set the value of SomeText to empty and return to view
  ViewData["SomeText"] = string.Empty;
  return View();
} 
```

以及相应的视图：

```
<%@ Page Title="" Language="C#" MasterPageFile="~/Views/Shared/Site.Master"
    Inherits="System.Web.Mvc.ViewPage" %>
<asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server">
<% using (Html.BeginForm()) 
   { %>
      <%= Html.Hidden("ID", ViewData["ID"])%>
      <label for="SomeText">SomeText:</label>
      <%= Html.TextArea("SomeText", ViewData["SomeText"]) %>
      <input type="submit" value="Save" />
<% } %>
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-05-06T16:45:55.003

问题是您的 ModelState 重新填充了发布的值。

您可以做的是在具有 Post 属性的 Action 上清除它：

```
ModelState.Clear(); 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-05-06T16:58:03.413

问题是 HtmlHelper 正在检索 ModelState 值，该值填充了发布的数据。与其通过重置 ModelState 来解决这个问题，不如重定向回 [get] 操作。[post] 操作还可以设置一个临时状态消息，如下所示：

```
[AcceptVerbs(HttpVerbs.Post)]
public ActionResult Message(int ID, string SomeText)
{
  // save Text to database
  SaveToDB(ID, SomeText);

  TempData["message"] = "Message sent";
  return RedirectToAction("Message");
} 
```

在我看来，这似乎是更正确的行为。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-04-25T11:07:44.630

html 助手从 ModelState 中读取值。并且没有优雅的方法来覆盖这种行为。

但是如果你在之后添加这一行`SaveToDB(ID, SomeText)`，它应该可以工作：

```
ModelState["SomeText"].Value = 
    new ValueProviderResult("", "", CultureInfo.CurrentCulture); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-21T19:43:36.010

我尝试了一切，但只有在我做这样的事情时才有效：

```
ModelState.Clear();
//This will clear the address that was submited
viewModel.Address = new Address();
viewModel.Message = "Dados salvos com sucesso!";
return View("Addresses", ReturnViewModel(viewModel)); 
```

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-04T10:01:47.620

如果您愿意，您可以使用 ModelState.Remove("SomeText")，而不是使用清除整个模型状态的 ModelState.Clear()。或者在没有 htmlhelper-extensions 的情况下呈现输入。它们旨在从 ModelState 而不是 Model（或 viewdata）中获取值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-25T00:14:44.560

模型状态是否有可能因错误而更新？我相信如果模型状态无效，它将从模型状态而不是视图数据或模型中提取尝试值。

**编辑**：我在下面包含来自 TextArea HtmlHelper 扩展的[源代码的相关部分。](http://www.codeplex.com/aspnet)在我看来，它完全符合我的预期——如果出现模型错误，它会从模型状态中提取值，否则它会从 ViewData 中使用它。请注意，在您的 Post 方法中，“SomeText”键在您设置之前甚至不应该存在，即它不会从响应 GET 的代码版本中继承。

由于您明确地向 ViewData 提供了一个值，因此`useViewData`应该为 false，`attemptedValue`除非在模型状态中设置了错误，否则应该为 false。

```
 // If there are any errors for a named field, we add the css attribute.
    ModelState modelState;
    if (htmlHelper.ViewData.ModelState.TryGetValue(name, out modelState)) {
        if (modelState.Errors.Count > 0) {
            tagBuilder.AddCssClass(HtmlHelper.ValidationInputCssClassName);
        }
    }

    // The first newline is always trimmed when a TextArea is rendered, so we add an extra one
    // in case the value being rendered is something like "\r\nHello".
    // The attempted value receives precedence over the explicitly supplied value parameter.
    string attemptedValue = (string)htmlHelper.GetModelStateValue(name, typeof(string));
    tagBuilder.SetInnerText(Environment.NewLine + (attemptedValue ?? ((useViewData) ? htmlHelper.EvalString(name) : value)));
    return tagBuilder.ToString(TagRenderMode.Normal); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-25T00:18:17.157

这是客户端行为。我建议使用 javascript。如果你使用 JQuery，你可以这样做：

```
<script type="text/javascript">
$(function(){ $("#SomeText").val("");});
</script> 
```

我不再使用 Javascript，但我相信常规 JS 是这样的：

```
document.getElementById("SomeText").value = ""; 
```

（您可以在其中一个加载事件上执行此操作。

```
<body onload="..."> 
```

希望这可以帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-25T00:38:39.353

我相当确定 textarea 正在从引擎盖下的 Request.Form 中获取值，因为 ViewData["SomeText"] 是空的。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-10-18T13:49:24.127

做某事 像这样：

添加：

```
ModelState.Clear(); 
```

`return`在提交按钮操作方法的声明之前。为我工作。它可以为你工作。

# perl - 如何从相对位置使用 Perl 模块？

> ID：787899
> 
> 赞同：42
> 
> 时间：2009-04-25T00:06:24.780
> 
> 标签：perl, module

我有一个名为 的目录`foo`，其中我有`lib`and `bin`。`bin`需要的脚本在`lib`. 我做这样的事情：

```
#!perl
use strict;
use warnings;
use lib '../lib';
use Foo; # <-- comes from lib 
```

但这意味着我必须在`bin`目录中才能运行脚本。肯定有更好的方法。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-04-25T02:05:22.687

标准[`FindBin`](http://perldoc.perl.org/FindBin.html)模块做你想做的事。

```
use FindBin;
use lib "$FindBin::Bin/../lib"; 
```

`perldoc FindBin`更多。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-04-25T00:14:05.963

解析出您的`.pl` 通孔的完整路径，`__FILE__`并在最后添加`../lib`或弹出最后一个元素`split(/\//,__FILE__)`并添加`/lib`到其中。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-04-25T08:14:22.440

我一般使用这种技术。可悲的是，它的灵感来自我的 PHP 时代：

在您知道给定文件相对于当前文件的位置，并且不确定它可能被调用的入口点或调用时周围环境的情况下，它很*方便*。

但是，我通常*只会*将这种技术用于需要虚拟库来模拟事物的测试脚本。

```
use File::Basename ();
use Cwd            ();
my $base_dir;
my $relative_path; 
BEGIN {
    $relative_path = '../../' # Path to base of project relative to the current file
    $base_dir = Cwd::realpath( File::Basename::dirname(__FILE__) .'/' . $relative_path );
}

use lib "${base_dir}/lib";
use Foo; 
```

理想情况下，应该有一些模块可以做到这一点，如果没有，我很想写一个：

```
use Some::Module ();
use lib Some::Module::relative_self('../../lib', __FILE__ ); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-04-25T04:05:36.390

~~只有当 perl 脚本所在的目录位于系统 PATH 中时，“FindBin”模块才会起作用，否则它将失败。为了克服这个问题，~~您可以操纵该`$0`值以获取您的路径到 perl-module 信息并将该值传递给`use lib`.

像这样的东西-

```
BEGIN {
    use File::Spec::Functions qw(rel2abs);
    use File::Basename qw(dirname);

    #Covert the script path to absolute and get its directory name
    our $path = dirname( rel2abs($0) );

    #Replace the bin tag with lib to get module directory
    $path =~ s{bin/?$}{lib};
}

use lib $path; 
```

**编辑：** FindBin 模块工作得很好，可以按照[迈克尔的回答](https://stackoverflow.com/a/788074/446591)中的描述使用。我对其工作原理的理解是不完整的，因此导致我发表了我现在撤回的第一条评论。无论如何，我看不出为什么这种方法不应该工作的任何理由，尽管比使用 FindBin (TMTOWTDI) 可以实现的行多几行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-11-15T19:42:30.437

```
use lib './'; 
```

一直在 linux 机器上使用 Perl v5.14.2 为我工作，以将文件包含在与我的脚本相同的目录中。

也许将您的 lib 和 bin 目录移动到脚本的工作目录下并尝试使用它们来引用它们可能对您有用

```
use lib './bin/'; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-04-17T07:22:08.523

我的解决方案：

```
use lib substr(__FILE__, 0, rindex (__FILE__, "/")); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-28T00:55:39.940

只是为了在这个答案集合中添加我自己的两分钱，我通常使用以下方法来解决这个问题：

```
use lib do {
    use Cwd 'realpath';
    my ($dir) = __FILE__ =~ m{^(.*)/};  # $dir = path of current file
    realpath("$dir/../lib");            # path of '../lib' relative to $dir
}; 
```

我喜欢使用`do`积木，因为所需的一切都非常整齐地包含在其中。如果您需要复制/粘贴，或者稍后尝试理解您的代码，您不必寻找单独的`BEGIN`块或类似的东西。

上面的代码天真地假设它`/`被用作目录/文件名分隔符。

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2009-04-25T00:14:32.233

怎么样：

```
BEGIN: {
    push @INC, '/full/path/to/lib';
} 
```

做一个相对引用会假设你要把它保存在 bin 目录中，所以在那里插入相对引用。

# c++ - C++ 运算符重载解析歧义

> ID：787906
> 
> 赞同：1
> 
> 时间：2009-04-25T00:10:19.250
> 
> 标签：c++, templates, gcc

我正在尝试将一个古老的 C++ 代码库从 gcc 3.2 移动到 gcc 4.1，因为我遇到了一些问题。在所有问题中，以下问题让我一无所知（我想我在 Java 上花了太多时间，或者我可能忘记了 C++ 的基础知识：-P）。

我有一个模板类

```
template < class T > class XVector < T >
{
   ...
   template < class T > T
   XVector < T >::getIncrement ()
   {
       ...
   }  
   template < class T > int
   XVector < T >::getValue (size_t index, T& value)
   {
      ...
      //The problematic line
      value = (T) (first_value + getIncrement())
                  * (long) (index - first_index);
      ....
   }
} 
```

此类基于 STL std::vector。我有第二类 TypeValue，它的定义如下，它可以保存 int、long 及其无符号变体、float、double、std::string 之一。还重载了几乎所有可能的运算符。

```
class TypeValue
{
    union
    {
        long* _int_value;
        double* _real_value;
        string* _text_value;
    } _value;

    TypeValue();
    explicit TypeValue(long _long);
    explicit TypeValue(int _int);
    explicit TypeValue(unsigned long _ulong);
    ...
    //similarly for all the remaining supported types.
    TypeValue(const TypeValue& ) //Copy constructor

    virtual TypeValue& operator=(const TypeValue &rhs);
    TypeValue& operator+ (TypeValue& )const;
    TypeValue& operator* (TypeValue& )const;
    ...
    //For all the basic operators

    operator long() const;
    operator int() const;
    operator unsigned long() const;
    operator unsigned int() const;
    ...

} 
```

最后我有另一个类，我们称之为 build_breaker，它创建一个对象为`XVector < TypeValue > a_variable;`. 现在，当我在 gcc 3.2 上编译它时，它编译没有任何问题。`operator*`但是当我尝试在 gcc 4.1 上编译它时，我收到错误，说课堂上的重载模棱两可`XVector`，候选人正在

```
运算符*（长整数，长整数）
运算符*（整数，长整数）
运算符*（长无符号整数，长整数）
运算符*（无符号整数，长整数）
运算符*（双精度整数）
运算符*（浮点数，长整数）  

```

如果编译器说它在寻找 T * long 的匹配项时遇到问题，那是有道理的，但是，它为什么要尝试将其类型转换为本机类型，然后执行算术运算？请帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T00:25:49.960

第二个操作数类型是`long [int]`. 第一个是`TypeValue`，我希望，但没有运算符`*`可以采用这两种确切的类型。但是，该运算符还有许多其他类型组合，编译器可以通过对第一个操作数进行隐式转换来选择它们。该语言允许编译器这样做以尝试找到匹配项。

但它应该选择众多转换中的哪一个？编译器无法选择是否`int`优于`long int`. （您可能会争辩说，既然第二个操作数是`long int`，那应该是首选的转换目标，但这不是事情的工作方式。）

所以，一些建议：首先，不要提供这么多的隐式转换。由于该类只能保存`long`、`double`和`string`，因此我提供的只有三个转换。仅此一项可能无法解决您的问题，但它可能会减少错误输出的大小并使其他事情更易于管理。

与其转换`(index - first_index)`为 type `long`，不如考虑将其转换为 type `T`（即`TypeValue`），因为这似乎是您真正想要首先执行的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T00:34:59.923

我会将所有转换运算符更改为命名函数，以便：

```
operator long() const; 
```

变成

```
long ToLong() const; 
```

通过强制转换运算符进行隐式转换会导致各种问题，而我自己的编程标准禁止使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-25T00:24:50.523

我们需要知道什么是 T。看起来您正在使用某种类型（例如 unsigned char）来实例化 XVector，该类型可以转换为您看到的所有类型，并且编译器不知道该选择哪一个.

# java - 文本小部件是否可以在文本中间而不是末尾显示“...”溢出？

> ID：787907
> 
> 赞同：0
> 
> 时间：2009-04-25T00:10:50.277
> 
> 标签：java, swing, widget, overflow

我有一个 JComboBox ，其中包含一个 MRU 列表组合框和一个目录树面板。两者一起构成了我的 GUI 的左侧面板（MRU 在树面板上方），它是一个 JSplitPane，因此左侧面板是可调整大小的。

它有一个问题，目录文本总是比在树面板中查看该目录所需的宽度长，因此我必须将左侧窗格的大小设置为比树所需的宽得多才能停止组合-框中显示了一个截断的目录名称。

组合框在文件名的结尾被截断时不是很有用，但是使左窗格足够宽以容纳文件名通常会使其对于整个窗口（尤其是）来说太宽了。如果没有最大化运行。而且通常只有文件名的尾随部分才是有意义的。如果我只能让 JComboBox 以某种方式**显示“开始...结束”**而不是“开始...”，我的问题就会得到解决。

[屏幕截图 http://www.freeimagehosting.net/uploads/da9810ed86.png](http://www.freeimagehosting.net/uploads/da9810ed86.png)

* * *

**更新**：我有一个可行的解决方案（见下面的自我回答），但它并不完美。如果有人知道我可以如何改进它，那将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T00:41:19.673

mmHhh 也许提供自定义渲染器？...

我认为它是 listcell 渲染器或类似的东西。

据我了解，当没有足够的可用空间时，默认会被包装，通过创建/或修改呈现的单元格，您可以知道组件的可用宽度是多少，并根据您的意愿修改要呈现的文本。

嗯，我已经好几年没有接近那个 API（细胞渲染的东西）了，所以我可能有点困惑。

:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T08:01:19.680

根据 Oscar 使用 ListCellRenderer 的想法，我想出了一些几乎可以工作的东西......组件值被正确呈现，但列表的值需要一个丑陋的 hack。

之所以需要 hack，是因为对于列表项，渲染器的大小（来自 getSize()）反映了最长项的文本宽度，而不是可用于渲染值的空间的宽度。我尝试使用 JComboBox 本身，但它的宽度包括小下拉按钮，因此如果存在滚动条，则不考虑其宽度。hack 是如果渲染器的宽度小于组合框的宽度，则存储渲染器的宽度，如果渲染器的宽度大于组合框的宽度，则使用存储的宽度。这有一个极端情况，其中渲染器的宽度介于内部 JLabel 的宽度和组合框的宽度之间。

由于渲染空间将是组合框的宽度，减去滚动条和插图的宽度，如果有人对我如何知道列表有滚动条以及如何获取滚动条有任何建议，那么我可以提取宽度，我全是耳朵。也许我可以做 list.getParent() 并期望它是一个 JScrollPane （JComboBox 或 JList doco 确实声明它使用滚动窗格）。

欢迎提出其他更好的建议。

代码如下：

```
recentDirs.setRenderer(new ComboTextRenderer(recentDirs));

...

static private class ComboTextRenderer
extends DefaultListCellRenderer
implements SwingConstants
{
JComponent                          parent;
int                                 renderWidth;

ComboTextRenderer(JComponent par) {
    super();

    parent=par;
    renderWidth=-1;
    }

public void paint(Graphics gc) {
    String                          txt=getText();

    int                             len=txt.length();
    int                             wid=getSize().width;
    Insets                          ins=getInsets();
    FontMetrics                     met=gc.getFontMetrics();

    if(renderWidth==-1 || wid<parent.getSize().width) { renderWidth=wid; }
    else                                              { wid=renderWidth; }
    wid-=(ins.left+ins.right);

    if(met.stringWidth(txt)>wid) {
        String rpl=null;
        for(int xa=0,pfx=Math.min(15,((len/2)-1)),sfx=(pfx+2); pfx>0 && sfx<len; xa++) {
            rpl=(txt.substring(0,pfx)+" ... "+txt.substring(sfx));
            if(met.stringWidth(rpl)<=wid) { break; }
            rpl=null;
            if     ((len-sfx)>15) { sfx++; }
            else if((xa%2)==0   ) { pfx--; }
            else                  { sfx++; }
            }
        if(rpl!=null) { setText(rpl); }
        }

    super.paint(gc);
    }
} 
```

# c - 无法将 C 中的模拟放到网页中

> ID：787914
> 
> 赞同：3
> 
> 时间：2009-04-25T00:14:17.197
> 
> 标签：c, web-applications, simulation

我在 C 语言中对交通圈 [替代文本中的汽车进行了以下模拟 http://dl.getdropbox.com/u/175564/cars.png](http://dl.getdropbox.com/u/175564/cars.png)

例如，

```
7 <space> <enter> 
```

为模拟提供更多汽车，同时

```
s1 <enter> 
```

在进入的道路#1 上放置一个顶部标志。

我想将模拟放到一个互联网页面上，以便用户可以尝试。但是，我不知道我应该从哪里开始。

我了解 Joomla，对 Django 知之甚少。也许，它们可能有用。

**您如何将 C 程序放到网页**上，以便用户可以使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T00:34:24.637

CGI 就是你想要的；它可以让你将任何你想要的程序嵌入到一个网站中，它就是为此目的而制作的。然后也许用 PHP 和 HTML 嵌入更多选项将让用户通过网络将数据准确地输入到程序中。它不应该太难。

在这里查看更多信息：[http ://www.cs.tut.fi/~jkorpela/perl/cgi.html](http://www.cs.tut.fi/~jkorpela/perl/cgi.html)

我认为这是朝着正确方向的一个很好的指针。我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-04-25T00:46:18.663

您可以使用炼金术在 Flash 应用程序中运行 C 代码：

[http://labs.adobe.com/technologies/alchemy/](http://labs.adobe.com/technologies/alchemy/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T00:41:41.077

这是用 C 编写 CGI 的一个很好的介绍：[http ://www.cs.tut.fi/~jkorpela/forms/cgic.html](http://www.cs.tut.fi/~jkorpela/forms/cgic.html)

但是，由于您是初学者，我建议您将程序移植到[PHP](http://www.php.net/manual/en/)。这是一种非常容易上手的语言，而且它比用 C 编写 CGI 要容易得多。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-25T00:42:11.327

我假设 C 程序在运行时需要输入而不是通过命令行参数？如果我错了，你可以只使用 PHP 和 shell_exec() 来运行程序。该函数返回打印到标准输出的任何内容。

这样的页面可能如下所示：

```
 $sim = shell_exec("/path/to/binary -a 5 -b 6");
    echo $sim; 
```

传递给 shell_exec 的字符串正是您在命令行中键入的内容。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-04-26T08:51:09.643

如果您想要一个动态模拟，即在您观看时汽车移动的地方，您将需要一个小程序或闪存。

cgi 程序在每个 http GET/POST 上呈现页面（在重新加载、提交等时），这可能*不是*您想要的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-25T00:24:23.880

我将从 Flash 或 Java 小程序包装器开始。您可以通过 tcp 连接与您的应用程序进行通信，并在 flash 或 applet 中显示结果。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-04-25T00:52:49.723

我建议使用套接字。如果您的 C 程序可以设置和侦听本地或 Internet 套接字，则可以使用任何语言的套接字工具向其发送参数并获取输出。

如果这太痛苦了，让 php 执行程序，同时将输出定向到某个文件。然后，让 php 读取该文件。

查看程序的输出，我认为尝试打印 shell_exec() 的结果会导致输出被破坏。

因此，您可以 shell_exec("/bin/program -arguments > /tmp/prog-tmp.txt") ，然后阅读 prog-tmp.txt。

# java - 将 EditorKit 绑定到 JTextPane 的特定文档模型

> ID：787923
> 
> 赞同：0
> 
> 时间：2009-04-25T00:16:40.747
> 
> 标签：java, swing

我似乎无法找到一种方法让编辑器工具包仅适用于一个 JTextPane。每次我实现一个时，它总是对框架中的任何 JTextPane 起作用。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-26T06:15:00.190

为什么不`editorPane.setEditorKit(new MyKit(())`针对您的每个窗格？

# c# - 使用 C# 正则表达式删除 HTML 标签

> ID：787932
> 
> 赞同：143
> 
> 时间：2009-04-25T00:23:11.277
> 
> 标签：c#, html, regex, parsing

如何使用 C# 正则表达式替换/删除所有 HTML 标记，包括尖括号？有人可以帮我写代码吗？

* * *

## 回答 #1

> 赞同：168
> 
> 时间：2009-04-25T00:31:48.137

如前所述，您不应该使用正则表达式来处理 XML 或 HTML 文档。它们不能很好地处理 HTML 和 XML 文档，因为没有办法以一般方式表达嵌套结构。

您可以使用以下内容。

```
String result = Regex.Replace(htmlDocument, @"<[^>]*>", String.Empty); 
```

这适用于大多数情况，但在某些情况下（例如包含尖括号的 CDATA）这将无法按预期工作。

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2009-04-25T00:51:44.500

正确的答案是不要那样做，使用[HTML Agility Pack](https://html-agility-pack.net/?z=codeplex)。

编辑添加：

为了无耻地从 jesse 下面的评论中窃取信息，并避免在这么长时间后被指责回答问题不充分，这里有一个简单、可靠的片段，它使用 HTML 敏捷包，即使是最不完美、反复无常的 HTML 片段也能工作：

```
HtmlDocument doc = new HtmlDocument();
doc.LoadHtml(Properties.Resources.HtmlContents);
var text = doc.DocumentNode.SelectNodes("//body//text()").Select(node => node.InnerText);
StringBuilder output = new StringBuilder();
foreach (string line in text)
{
   output.AppendLine(line);
}
string textOnly = HttpUtility.HtmlDecode(output.ToString()); 
```

使用正则表达式解析 HTML 的辩护案例很少，因为如果没有上下文感知，即使在非传统的正则表达式引擎中也很难提供 HTML，因此无法正确解析 HTML。您可以使用 RegEx 部分实现，但您需要进行手动验证。

Html Agility Pack 可以为您提供一个强大的解决方案，该解决方案将减少手动修复因将 HTML 视为无上下文语法而可能导致的异常的需要。

一个正则表达式可能在大多数情况下都能得到你想要的，但在非常常见的情况下它会失败。如果你能找到比 HTML Agility Pack 更好/更快的解析器，那就去吧，但请不要让世界遭受更多破碎的 HTML 黑客攻击。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2009-04-25T02:59:16.240

这个问题太宽泛了，无法明确回答。您是在谈论从真实世界的 HTML 文档（如网页）中删除所有标签吗？如果是这样，您将不得不：

*   删除 <!DOCTYPE 声明或 <?xml 序言（如果存在）
*   删除所有 SGML 注释
*   删除整个 HEAD 元素
*   删除所有 SCRIPT 和 STYLE 元素
*   用 FORM 和 TABLE 元素做 Grabthar-knows-what
*   删除剩余的标签
*   从 CDATA 部分中删除 <![CDATA[ 和 ]]> 序列，但保留其内容

这只是我的想法——我相信还有更多。一旦你完成了所有这些，你最终会在某些地方出现单词、句子和段落，而在其他地方则出现大量无用的空白。

但是，假设您只使用一个片段并且您可以简单地删除所有标签，这是我将使用的正则表达式：

```
@"(?></?\w+)(?>(?:[^>'""]+|'[^']*'|""[^""]*"")*)>" 
```

在各自的备选方案中匹配单引号和双引号字符串足以处理属性值中的尖括号问题。我认为没有必要明确匹配标签内的属性名称和其他内容，就像 Ryan 回答中的正则表达式一样；第一个替代方案处理所有这些。

如果您想知道这些`(?>...)`构造，它们是[atomic groups](http://www.regular-expressions.info/atomic.html)。它们使正则表达式更有效率，但更重要的是，它们可以防止失控的回溯，当你像我所做的那样混合交替和嵌套量词时，你应该始终注意这一点。我真的不认为这会是一个问题，但我知道如果我不提及它，其他人会。;-)

当然，这个正则表达式并不完美，但它可能与您所需要的一样好。

* * *

## 回答 #4

> 赞同：27
> 
> 时间：2009-04-25T00:31:07.687

```
Regex regex = new Regex(@"</?\w+((\s+\w+(\s*=\s*(?:"".*?""|'.*?'|[^'"">\s]+))?)+\s*|\s*)/?>", RegexOptions.Singleline); 
```

[资源](http://haacked.com/archive/2005/04/22/Matching_HTML_With_Regex.aspx)

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2012-05-17T21:55:23.340

@JasonTrue 是正确的，不应该通过正则表达式来剥离 HTML 标签。

使用 HtmlAgilityPack 去除 HTML 标签非常简单：

```
public string StripTags(string input) {
    var doc = new HtmlDocument();
    doc.LoadHtml(input ?? "");
    return doc.DocumentNode.InnerText;
} 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-01-13T12:22:01.763

我想回应 Jason 的回应，尽管有时您需要天真地解析一些 Html 并提取文本内容。

我需要使用由富文本编辑器创建的一些 Html 来做到这一点，总是很有趣和游戏。

在这种情况下，您可能需要删除某些标签的内容以及标签本身。

在我的情况下，标签被扔进了这个组合中。有些人可能会发现我的（稍微）不太天真的实现是一个有用的起点。

```
 /// <summary>
    /// Removes all html tags from string and leaves only plain text
    /// Removes content of <xml></xml> and <style></style> tags as aim to get text content not markup /meta data.
    /// </summary>
    /// <param name="input"></param>
    /// <returns></returns>
    public static string HtmlStrip(this string input)
    {
        input = Regex.Replace(input, "<style>(.|\n)*?</style>",string.Empty);
        input = Regex.Replace(input, @"<xml>(.|\n)*?</xml>", string.Empty); // remove all <xml></xml> tags and anything inbetween.  
        return Regex.Replace(input, @"<(.|\n)*?>", string.Empty); // remove any tags but not there content "<p>bob<span> johnson</span></p>" becomes "bob johnson"
    } 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-07-11T13:28:01.797

在此 URL 尝试正则表达式方法：http: [//www.dotnetperls.com/remove-html-tags](http://www.dotnetperls.com/remove-html-tags)

```
/// <summary>
/// Remove HTML from string with Regex.
/// </summary>
public static string StripTagsRegex(string source)
{
return Regex.Replace(source, "<.*?>", string.Empty);
}

/// <summary>
/// Compiled regular expression for performance.
/// </summary>
static Regex _htmlRegex = new Regex("<.*?>", RegexOptions.Compiled);

/// <summary>
/// Remove HTML from string with compiled Regex.
/// </summary>
public static string StripTagsRegexCompiled(string source)
{
return _htmlRegex.Replace(source, string.Empty);
} 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2010-12-13T10:30:31.450

用这个..

```
@"(?></?\w+)(?>(?:[^>'""]+|'[^']*'|""[^""]*"")*)>" 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-09-04T16:56:09.583

添加`.+?`并`<[^>]*>`尝试此正则表达式（基于[此](http://www.systemtextregularexpressions.com/m1/get-all-html-tags-from-page)）：

```
<[^>].+?> 
```

[c# .net 正则表达式演示](http://www.systemtextregularexpressions.com/regex.replace?p=PFtePl0uKz8%2B&t=PGh0bWw%2BDQoJPGhlYWQ%2BDQoJCTx0aXRsZT5UZXh0PC90aXRsZT4NCgk8L2hlYWQ%2BDQoJPGJvZHk%2BDQoJCTxwIGNsYXNzPSJtYWluIj5TYW1wbGUgdGV4dCBhbmQgPGEgaHJlZj0iIyI%2BbGluazwvYT48L3A%2BDQoJCTxpbWcgc3JjPSJpbWFnZS5qcGciIC8%2BDQoJCTx0YWJsZT4NCgkJCTx0cj48dGQgY29sc3Bhbj0iMiI%2BMTwvdGQ%2BPC90cj4NCgkJCTx0cj48dGQ%2BMjwvdGQ%2BPHRkPjM8L3RkPjwvdHI%2BDQoJCTwvdGFibGU%2BDQoJPC9ib2R5Pg0KPC9odG1sPg%3D%3D) [![在此处输入图像描述](https://i.stack.imgur.com/fvMgG.png)](https://i.stack.imgur.com/fvMgG.png)

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2016-11-02T15:54:56.040

使用此方法删除标签：

```
public string From_To(string text, string from, string to)
{
    if (text == null)
        return null;
    string pattern = @"" + from + ".*?" + to;
    Regex rx = new Regex(pattern, RegexOptions.Compiled | RegexOptions.IgnoreCase);
    MatchCollection matches = rx.Matches(text);
    return matches.Count <= 0 ? text : matches.Cast<Match>().Where(match => !string.IsNullOrEmpty(match.Value)).Aggregate(text, (current, match) => current.Replace(match.Value, ""));
} 
```

# python - PayPal 的 Python 接口 - urllib.urlencode 非 ASCII 字符失败

> ID：787935
> 
> 赞同：20
> 
> 时间：2009-04-25T00:24:09.497
> 
> 标签：python, unicode, paypal, urllib2, urllib

我正在尝试实现 PayPal IPN 功能。基本协议如下：

1.  客户从我的网站重定向到 PayPal 的网站以完成付款。他登录他的帐户，授权付款。
2.  PayPal 在我的服务器上调用一个页面，将详细信息作为 POST 传递。详细信息包括一个人的姓名、地址和付款信息等。
3.  我需要从我的处理页面内部调用 PayPal 网站上的一个 URL，传回上面传递的所有参数，以及一个名为 'cmd' 的附加参数，其值为 '_notify-validate'。

当我尝试对 PayPal 发送给我的参数进行 urllib.urlencode 编码时，我得到：

```
While calling send_response_to_paypal. Traceback (most recent call last):
  File "<snip>/account/paypal/views.py", line 108, in process_paypal_ipn
    verify_result = send_response_to_paypal(params)
  File "<snip>/account/paypal/views.py", line 41, in send_response_to_paypal
    params = urllib.urlencode(params)
  File "/usr/local/lib/python2.6/urllib.py", line 1261, in urlencode
    v = quote_plus(str(v))
UnicodeEncodeError: 'ascii' codec can't encode character u'\ufffd' in position 9: ordinal not in range(128) 
```

我了解 urlencode 进行 ASCII 编码，在某些情况下，用户的联系信息可以包含非 ASCII 字符。这是可以理解的。我的问题是，如何使用 urllib2.urlopen(req) （或其他方法）对非 ASCII 字符进行编码以发布到 URL

**细节：**

我阅读了 PayPal 原始请求中的参数如下（GET 用于测试）：

```
def read_ipn_params(request):
    if request.POST:  
        params= request.POST.copy()  
        if "ipn_auth" in request.GET:
            params["ipn_auth"]=request.GET["ipn_auth"]
        return params
    else:  
        return request.GET.copy() 
```

我用于从处理页面将请求发送回 PayPal 的代码是：

```
def send_response_to_paypal(params):
    params['cmd']='_notify-validate'  
    params = urllib.urlencode(params)  
    req = urllib2.Request(PAYPAL_API_WEBSITE, params)  
    req.add_header("Content-type", "application/x-www-form-urlencoded") 
    response = urllib2.urlopen(req)  
    status = response.read()  
    if not status == "VERIFIED":  
        logging.warn("PayPal cannot verify IPN responses: " + status)
        return False

    return True 
```

显然，只有当某人的姓名或地址或用于 PayPal 支付的其他字段不属于 ASCII 范围时，才会出现问题。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2009-04-25T01:45:55.883

尝试先将 params 字典转换为 utf-8 ... urlencode 似乎比 unicode 更喜欢这样：

```
params = urllib.urlencode(dict([k, v.encode('utf-8')] for k, v in params.items())) 
```

当然，这假设您的输入是 unicode。如果您的输入不是 unicode，您需要先将其解码为 un​​icode，然后对其进行编码：

```
params['foo'] = my_raw_input.decode('iso-8859-1')
params = urllib.urlencode(dict([k, v.encode('utf-8')] for k, v in params.items())) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-02-08T09:03:21.390

与其编码为`utf-8`，不如将其编码为贝宝用于帖子的任何内容。它在贝宝发送的表单中的“字符集”键下可用。

所以下面的代码对我有用：

> `data = dict([(k, v.encode(data['charset'])) for k, v in data.items()])`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-07-19T16:34:28.787

我知道在这里插话有点晚了，但我发现最好的解决方案是甚至不解析他们回馈的内容。在 django（不知道您在使用什么）中，我能够获得他们发送的原始请求，我将其逐字传回。然后只需将 cmd 键放在上面即可。

这样，他们发送给您的编码无关紧要，您只需将其发送回来。

# ruby-on-rails - 什么属性应该属于一个页面，什么应该属于一个模型？

> ID：787940
> 
> 赞同：0
> 
> 时间：2009-04-25T00:27:05.153
> 
> 标签：ruby-on-rails, django, database-design, architecture

假设您有一个包含事件信息的事件模型。但是像 slug、标题和元描述这样的东西会进入 html 呢？

看起来这些东西正确地属于页面模型而不是事件模型的属性。

有没有正确的方法来做到这一点？一种方法相对于另一种方法的优缺点是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T01:50:27.853

一个事件有一些一流的属性和一些“派生的”属性。

让我们专注于 Django。

例如，您的模型可能有一个很长的标题和一个派生的 slug。

您可以轻松地为此派生数据定义类方法。

但是，在某些情况下，您需要对模型进行非规范化以使派生数据持久化。在这种情况下，您将拥有其他属性，并且您将通过 save() 方法设置这些属性。

“正确”是明确定义的——第三范式是正确的。如果不经常计算派生字段，您可以负担得起计算它们的费用。在某些情况下，您必须打破 3NF 并保留数据以提高性能。

# wpf - WPF 客户端通过网络与 WCF Windows 服务通信，可行吗？

> ID：787947
> 
> 赞同：2
> 
> 时间：2009-04-25T00:30:38.547
> 
> 标签：wpf, wcf, windows-services

在工作中，我想创建一个在网络服务器上运行的 WCF Windows 服务。然后我想创建一个可以安装在网络上各种机器上的 WPF 应用程序。此 WPF 应用程序需要能够与网络服务器上的 WCF Windows 服务进行通信。

这可行吗？有没有更好的方法来完成我想做的事情？有谁知道任何显示此示例的资源？我找到了一些教程如何在 Windows 服务中设置 WCF 服务，但我不确定如何通过网络与其通信。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T00:36:39.967

是的，WPF 应用程序可以像托管任何其他 .NET 应用程序一样（并且以相同的方式）托管 WCF 客户端。如果您的应用程序被打包为用于浏览器交付的 XBAP，您可能会遇到安全限制，但否则它应该都能正常工作。

同样，Windows 服务可以承载 WCF 服务。有关示例，请参阅[http://msdn.microsoft.com/en-us/library/ms733069.aspx](http://msdn.microsoft.com/en-us/library/ms733069.aspx)上的“如何在托管 Windows 服务中托管 WCF 服务” 。

然后，您可以通过创建客户端代理通过网络与它进行通信——最简单的方法是使用 Visual Studio 添加服务引用命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T13:21:55.947

我不明白你的问题。您说您看到了 WCF 服务器和客户端的示例，但不确定如何通过网络与其通信。但是您看到的所有示例都是关于通过网络进行通信的客户端和服务器！

您在示例中看到的内容与您想要自己完成的内容有什么区别？

# asp.net - 基于 Web 表单的 Web 应用程序 URL，没有像 stackoverflow.com 这样的“.aspx”

> ID：787961
> 
> 赞同：1
> 
> 时间：2009-04-25T00:37:12.867
> 
> 标签：asp.net, iis

我想知道是否可以在没有`.aspx`扩展名的情况下显示 Webforms 应用程序页面的 URL。

例如，`http://stackoverflow.com/questions/ask`而不是`http://stackoverflow.com/questions/ask.aspx`

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-25T00:38:45.920

stackoverflow使用的技术已经讨论过很多次了，你要找的是ASP.Net MVC Framework

[http://www.asp.net/mvc](http://www.asp.net/mvc)

[https://stackoverflow.com/questions/tagged/asp.net-mvc](https://stackoverflow.com/questions/tagged/asp.net-mvc)

这也可以使用 URL 重写器来完成

[http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx](http://weblogs.asp.net/scottgu/archive/2007/02/26/tip-trick-url-rewriting-with-asp-net.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-04-25T00:38:14.627

这可以通过使用**[ASP.NET MVC](http://www.asp.net/mvc)**或[路由引擎](http://msdn.microsoft.com/en-us/magazine/2009.01.extremeaspnet.aspx)本身来完成。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-25T01:45:51.267

你想要 Asp.Net 路由。最佳起点在这里： [http ://haacked.com/Tags/Routing/default.aspx](http://haacked.com/Tags/Routing/default.aspx)

如果您使用的是 IIS7，这很容易。IIS6 需要更多的工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T00:41:52.323

这通常使用框架中的路由引擎来完成。但是，如果您想为任意应用程序执行此操作，则实际上是使用 Apache 的 Mod_Rewrite 完成的。

# reporting-services - Reporting Services 2005 - 打印图表 - 打印过程中出错。(0x80004005)

> ID：787966
> 
> 赞同：2
> 
> 时间：2009-04-25T00:39:27.633
> 
> 标签：reporting-services, printing, reportingservices-2005

我正在尝试使用报告查看器打印包含条形图的报告，但遇到错误。我的报告服务器在 Windows Server 2003 SP2 上运行 SQL Server 2005 Reporting Services SP3。

以下是一些可以重现问题的步骤（至少对我而言）......

1.  在干净的机器上，我打开报告，它显示正常。
2.  然后单击打印按钮，系统会提示我安装 RSClientPrint ActiveX 控件。控件下载并安装正常。
3.  然后我再次单击打印按钮，出现打印对话框。
4.  我选择一台打印机，然后单击“确定”。
5.  将出现一个消息框，其中包含以下文本（包括拼写错误）...

> 打印过程中发生错误。(0x80004005)

我尝试打印的任何其他报告都可以正常工作。此报告与其他报告的唯一区别是它包含条形图。如果我从报告中删除图表，重新部署它，然后重新运行它，它会打印而不会出现该错误。

据我所知，它并不孤立于特定的机器。它发生在我与之交谈过的每个客户身上，以及办公室里的各种机器身上。

有没有人见过这样的事情？我在网上看到过类似的帖子，建议卸载报告服务器上的视频驱动程序（认为 GDI dll 已损坏），安装服务包等。我尝试了所有建议，但还没有找到好的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T16:50:43.143

我最终不得不为此使用付费的 Microsoft 事件，但现在已解决。问题是我的报告中有一个包含动态列的矩阵。根据您选择的具体日期范围，报告可能有 n 个列。在我的情况下，选择日期范围产生三个或更多这些动态列时，它会导致矩阵变得太大并且在报告的边缘之外运行。

如果矩阵太大，该报告将运行并显示正常，但无论何时打印或导出报告，都会显示令人难以置信的非描述性错误。

我通过减小报告中其他列的大小和整体字体大小解决了这个问题。这可以防止在生成三个动态列的日期范围的情况下矩阵超出页面。在一般情况下它不能解决它（四列或更多列会使其失败），但对于我目前的目的来说已经足够了。

Microsoft 没有针对一般情况的修复（例如使矩阵固定宽度的方法）。

我想我应该回答这个问题，以防其他人遇到它。

-大卫

# c# - 试图在 PageLoad 的 UpdatePanel 中设置视图

> ID：787973
> 
> 赞同：1
> 
> 时间：2009-04-25T00:44:03.270
> 
> 标签：c#, asp.net, updatepanel, multiview

我在使用 UpdatePanel 和 MultiView 的组合时遇到问题。

我的顶层有一个 UpdatePanel，里面有一堆图像按钮 - 它们的点击事件在 Multiview 上设置视图，每个视图内部都有一个带有我的绑定的 UpdatePanel。

一切都很好 - 但我正在尝试通过查询字符串设置视图，因此我可以将用户发送到特定视图。

当我尝试从 PageLoad 设置视图时 - 它说“对象不存在”。所以我想我会在 Page_LoadComplete 中尝试它，效果很好 - 但是我的图像按钮无法像原来那样切换视图。

我错过了什么！谢谢！

```
 void Page_LoadComplete()
    {
        tabSelect= Request.QueryString["tab"];

            if (tabSelect.Contains("Community"))
            {
                MultiView1.SetActiveView(Community);

                btnCommunity.ImageUrl = "images/tabCommunity_on.png";

            }
     }

<asp:ScriptManager id="ScriptManager1" runat="server"/>
<asp:UpdatePanel id="UpdatePanel1" childrenastriggers="true" updatemode="Always" runat="server">
  <ContentTemplate>
    <asp:ImageButton id="btnCommunity" onclick="" runat="server">

    <asp:MultiView ID="MultiView1" ActiveViewIndex="0" runat="server">
        <asp:View ID="Community" runat="server">
            <asp:UpdatePanel id="UpdatePanel1" childrenastriggers="true" updatemode="Always" runat="server">
             //data controls in here
           </asp:UpdatePanel>
        </asp:View>
        <asp:View id="tabFriends" runat="server">
           <asp:UpdatePanel id="UpdatePanel2" childrenastriggers="true" updatemode="Always" runat="server">
             //data controls in here
           </asp:UpdatePanel>
         </asp:View>
     </asp:MultiView>
  </ContentTemplate>
</asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T00:53:27.507

**更新：**在更详细地查看了您的代码之后，我相信已经找到了问题所在。

我对代码做了以下调整：

1.  如果未传递查询字符串，则设置`tabSelect`为空字符串，从而避免下一行出现空对象引用异常。

2.  将 ImageUrl 路径设置为包含 ~（对于根目录）。

请尝试以下代码：

```
void Page_LoadComplete()
{
    string tabSelect = Request.QueryString["tab"] ?? string.Empty;

    if (tabSelect.Contains("Community"))
    {
        MultiView1.SetActiveView(Community);
        btnCommunity.ImageUrl = "~/images/tabCommunity_on.png";
    }
} 
```

# javascript - 最好的 javascript 压缩器/编译器/混淆器？

> ID：787977
> 
> 赞同：1
> 
> 时间：2009-04-25T00:47:29.083
> 
> 标签：javascript

### 复制：

> *   [有没有 Javascript 静态分析工具？](https://stackoverflow.com/questions/534601/are-there-any-javascript-static-analysis-tools)
> *   [哪个 javascript 缩小库产生更好的结果？](https://stackoverflow.com/questions/360818/which-javascript-minification-library-produces-better-results)
> *   [最好的 javascript 压缩器](https://stackoverflow.com/questions/28932/best-javascript-compressor)
> *   [如何混淆 JavaScript？](https://stackoverflow.com/questions/194397/how-can-i-obfuscate-javascript)
> *   [什么是最好的 javascript 混淆器？](https://stackoverflow.com/questions/522064/what-is-the-best-javascript-obfuscator)
> *   其他（只需搜索）

* * *

他们应该执行以下功能： - 检查错误 - 优化代码 - 删除未使用的代码 - 打包管理 - 压缩它（将变量和属性名称重命名为更短的名称） - 混淆它（有时它与压缩它相同。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T00:51:45.623

我不得不说[雅虎的 YUI Compressor](http://developer.yahoo.com/yui/compressor/)。我已经用了一段时间了，真的很喜欢。当然，一旦我找到了我喜欢的一个，我就停止了寻找。

[javaflight](http://code.google.com/p/javaflight-code/)也值得一试，它是[YUI Compressor](http://developer.yahoo.com/yui/compressor/)的一个蚂蚁任务。

# javascript - Javascript XML 解析或替代

> ID：787982
> 
> 赞同：0
> 
> 时间：2009-04-25T00:49:45.753
> 
> 标签：javascript, html, xml, parsing

我正在为博客后端构建一个 Javascript 预览功能（很像这个网站上使用的那个），我希望能够解析一些通常由 PHP 解析的自定义标签。我想知道是否可以使用 JS XML 解析器来解析来自 textarea 的内容，如下所示：

```
<img=1>

Use for
<url=http://apwit.com>testing</url>
purposes only! 
```

我曾经在这里读到另一个问题，使用正则表达式来解析这样的事情是一个坏主意，因为可能会有很多例外。你怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-25T02:49:20.647

使用这个：[http ://www.w3schools.com/Xml/tryit.asp?filename=tryxml_parsertest2](http://www.w3schools.com/Xml/tryit.asp?filename=tryxml_parsertest2)

它从字符串中解析 xml，并使用浏览器中的快速原生 XML 解析引擎。

解释与讨论：

[http://www.w3schools.com/Xml/xml_parser.asp](http://www.w3schools.com/Xml/xml_parser.asp)

# ruby-on-rails - 在 Ruby 中解析（在 Rails 上）

> ID：787983
> 
> 赞同：4
> 
> 时间：2009-04-25T00:50:07.423
> 
> 标签：ruby-on-rails, ruby, parsing, poker

我想编写一个 Rails 应用程序来帮助我进行在线扑克。我在 PokerStars 打牌，每手牌都有可用的文本数据。它的格式是这样的：

```
PokerStars 游戏 #27457662450：锦标赛 #157033867，免费扑克无限注 - 级别 IV (50/100) - 2009/04/24 20:39:44 ET
表 '157033867 830' 9-max 座位 #1 是按钮
座位 1：DortheaV（筹码 7624）
座位 2：Currly234（筹码 3016）
座位 3：paolilla（筹码 3086）
座位 4： triumph888（筹码 1571）坐在外面
座位 5：Minchausti（筹码 1185）坐在外面
座位 6：madmike11847（筹码 1195）坐在外面
座位 7：alamodey（筹码 4038）
座位 8：whiskerbob（筹码 3365）
座位 9：SHpic76（筹码 1115）坐在外面
DortheaV: 下注 10
Currly234：发布赌注 10
paolilla: 发布 ante 10
triumph888: 发布 ante 10
Minchausti：张贴赌注 10
madmike11847: 发布赌注 10
alamodey: 发布 ante 10
胡须鲍勃：张贴赌注 10
SHpic76：张贴赌注 10
Currly234：发布小盲注 50
paolilla: 发布大盲注 100
*** 洞牌 ***
交易给 alamodey [8s Ks]
triumph888：折叠
Minchausti：褶皱
madmike11847：折叠
阿拉莫迪：拨打 100
胡须：褶皱
SHpic76：折叠
DortheaV：褶皱
Currly234：呼叫 50
保利拉：检查
*** 翻牌圈*** [5c 4h 6d]
Currly234：检查
保利拉：检查
阿拉莫迪：赌注 234
Currly234：折叠
paolilla：褶皱
未跟注 (234) 返回到 alamodey
alamodey 从锅中收集了 390
alamodey: 不显示手
*** 概括 ***
总底池390 | 耙 0
板 [5c 4h 6d]
座位 1：DortheaV（按钮）在翻牌前弃牌（没有下注）
座位 2： Currly234（小盲注）在翻牌圈弃牌
座位 3：paolilla（大盲注）在翻牌圈弃牌
座位 4： triumph888 在翻牌前弃牌（没有下注）
座位 5：Minchausti 在翻牌前弃牌（没有下注）
座位 6：madmike11847 在翻牌前弃牌（没有下注）
座位 7：收集了 alamodey (390)
座位 8：在翻牌前弃牌（没有下注）
座位 9：SHpic76 在翻牌前弃牌（没有下注）
```

是否有任何用于 Ruby 的解析库，或者我必须手动和 hackily 执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-25T00:57:21.710

这听起来像是 Regex 的工作！我怀疑使用任何库是否会使解析变得更容易，因为它是一种非常自定义的格式，您只需要破解它即可。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T00:59:50.800

您可能想查看[Treetop](http://treetop.rubyforge.org/)，这是一个基于[Parsing Expression Grammar](http://en.wikipedia.org/wiki/Parsing_expression_grammar)的 Ruby 解析器生成器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-04-25T06:31:05.073

此外，如果您只想要数据，您应该查看[PokerTracker](http://www.pokertracker.com)。PokerTracker 存储了 100% 的手牌信息，并拥有完善的架构和开放的 PostgreSQL 数据库。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-25T01:21:16.927

[Ragel](http://www.complang.org/ragel/)非常擅长写解析器。例如 Mongrel 的 http 解析器是用 ragel 生成的。

# java - Apache Felix：什么是扩展包？

> ID：787985
> 
> 赞同：2
> 
> 时间：2009-04-25T00:50:48.013
> 
> 标签：java, osgi, apache-felix

Apache Felix 具有“扩展包”的概念。这似乎是一个有助于系统捆绑的捆绑。还为他们注册了一个特殊的 URL “felix://extensions/”。

我什么时候需要使用扩展而不是常规捆绑包？

是否有使用这种方法的捆绑包示例？

这是 Felix 独有的功能还是 OSGi 规范的一部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-25T06:18:34.730

请阅读官方 OSGi 服务平台核心规范的第 3.15 段（扩展包）。你所有的问题都有答案。

以下是规范的引用：

扩展包可以提供框架实现的可选部分或提供必须驻留在引导类路径上的功能。这些包不能由正常的导入/导出机制提供。

引导类路径扩展是必要的，因为某些包实现假定它们位于引导类路径上或要求对所有客户端可用。引导类路径扩展的一个示例是 java.sql 的实现，例如 JSR 169。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-25T06:54:42.693

根据 felix[实现扩展包](https://issues.apache.org/jira/browse/FELIX-30)问题，扩展包*在 OSGi R4 规范的第 3.15 节中描述*- 所以它是 OSGi 规范的一部分。该问题和[规范](http://www.osgi.org/download/r4v41/r4.core.pdf)都回答了您关于何时使用它们的问题。例如，我会[检查 google](http://www.google.com/search?q=OSGi+extension+bundles+examples)。

# .net - Linq2Sql 中的默认列值

> ID：787991
> 
> 赞同：1
> 
> 时间：2009-04-25T00:54:31.687
> 
> 标签：.net, linq-to-sql

假设我有一个带有 CreatedBy Datetime 列的表，其默认值为 GETDATE()...

输入 LinqToSql

据我目前了解，我有两个选择：

*   在 linkToSql "insert" 语句中手动插入 DateTime.Now
*   将“自动生成的值”设置为 True，现在 Linq2Sql 将忽略我为 CreatedDate 提供的值

如果我想保留设置值的选项，但不被迫提供它（就像我在 T-SQL 中一样）怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-25T01:48:52.617

您是对的，对于给定的 DataContext，这些是您仅有的两个选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-25T01:05:02.237

让列可以为空。创建一个触发而不是插入的触发器，如果​​提供的值为空，则将其设置为当前日期。为该字段的属性更改方法提供部分方法，如果尝试将该字段设置为 null，则会引发异常。

这不会强迫您提供一个值，但如果您尝试设置它，您将无法将其清空。触发器将在插入时提供默认值，并且在任何更新时都应保证它具有一个值，因为属性更改方法不允许将其设置为 null。

**编辑**：如果您想避免触发并且不介意插入的实际时间和列值之间存在（可能很小）差异的可能性，您可以实现创建的部分方法并设置支持字段的日期直接地。通过不使用该属性，我认为您可以避免虚假更新，因为不会触发属性更改事件。您必须对此进行测试以查看它是否按您想要的方式工作。这样做的一个优点是它可以在不涉及数据库的情况下进行完全单元测试。

FWIW，我通常只是走自动生成的路线。我没有在任何情况下手动设置记录上的 CreatedDate。我可能会在紧急情况下进去手动更新，但我什至不记得我什么时候必须这样做。

# apache-flex - 在 Flex 中添加 LegendItems 水平放置而不是垂直放置（正如它应该的那样）

> ID：787993
> 
> 赞同：0
> 
> 时间：2009-04-25T00:55:16.443
> 
> 标签：apache-flex, actionscript-3, uicomponents, legend

我正在使用以下代码将 LegendItems 动态插入到 Legend 中：

```
signalLegend.removeAllChildren();
signalLegend.direction = "vertical";
for (var i:int = 0; i < numItems - 1; i++) {
    signalLegend.addChild(new LegendItem());
    legendItem = signalLegend.getChildAt(i) as LegendItem;
    legendItem.label = "Title here";
    legendItem.setStyle("fill", theColour);
} 
```

当图例方向设置为垂直时，所有项目都水平显示。

很烦人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-11T08:42:36.593

好的，我找到了解决方案。

```
 <mx:Legend id="nhLeg"
                       updateComplete="LegendPosition()"
                       direction="vertical"
                       width="80%"/> 
```

然后在 LegendPosition() 函数中：

```
 private function LegendPosition():void
        {

            nhLeg.direction="vertical";
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-18T12:07:59.663

这似乎是一个错误。如果在运行时添加 Legend 控件的子项，它们的位置会错误。将方向设置为“水平”，项目将垂直显示。:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-01T14:22:17.490

使用 labelPlacement 样式

# javascript - YUI 编辑器 (RTE)：插入 HTML 元素并将光标置于其中

> ID：787996
> 
> 赞同：3
> 
> 时间：2009-04-25T00:56:43.193
> 
> 标签：javascript, editor, yui, yui-editor

我有个问题。我已经尝试解决它一段时间了，我已经准备好爆发了。这是我的要求：
我在编辑器上方有一个外部工具栏（不是 YUI 的一部分），我想用它来插入 HTML 标记。用户应该能够单击工具栏上的链接，之后可能会发生一些事情：

1.  如果有任何选定的文本，则此文本将被包装到 HTML 标记中
2.  如果没有选定的文本，则在编辑器中插入一个空的 HTML 标记
3.  无论哪种情况，光标都必须放在新元素中，这样当用户输入更多文本时，它就会驻留在新元素中

该功能与在编辑器工具栏上按“B”或“U”按钮的功能非常相似（现在我正在使用这个编辑器，它也做得很好:-)）。它很好地保存了一切。到目前为止，我可以做 1 或 2，但不能做 3。第 3 步非常重要，因为没有它，用户体验会受到很大影响。我真的需要你的帮助来实施它。下面是执行插入的方法的简化版本（为简单起见，仅插入 DIV）。this._oEditor - YUI 编辑器的本地实例：

```
this._insertElement = function() {
var sSelection = this._oEditor._getSelection(); // Attempt to get selected text from the editor
if (sSelection == '') sSelection = '&nbsp;'; // If nothing was selected, insert a non-breaking space

var sNewElt = '<div>' + sSelection + '</div>';

this._oEditor.execCommand('inserthtml', sNewElt);

this._oEditor.focus(); // This gives the editor focus, but places cursor in the beginning!
} 
```

我必须做什么才能将光标放在正确的位置？甚至可能吗？另外，如果有更好的方法来实现这一点，我完全赞成。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-28T02:22:00.593

**这是完整的解决方案：**

```
this._insertElement = function() {
   var sSelection = this._oEditor._getSelection(); 
  if (sSelection == '') sSelection = ' '; 

  var sNewElt = '<div>' + sSelection + '</div>';

  this._oEditor.execCommand('inserthtml', sNewElt);

  var pos = 1000; //pos determines where to place the cursor. if greater than the length of characters, it will place at the end.
  if(this._oEditor.createTextRange) { //IE Specific code
        var range = this._oEditor.createTextRange();   
        range.move("character", pos);   
        range.select();   
    } else if(this._oEditor.selectionStart) {  //Works with Firefox and other browsers 

        this._oEditor.focus();   
        this._oEditor.setSelectionRange(pos, pos);   
  }  
  this._oEditor.focus(); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-28T01:33:04.657

放置光标需要针对不同的浏览器使用不同的方法。在 IE 中，您需要创建一个[TextRange](http://msdn.microsoft.com/en-us/library/ms535872.aspx)对象，在 Mozilla 中，您可以使用 window.find() 或[Selection](https://developer.mozilla.org/en/DOM/Selection)对象，webkit/safari/chrome 需要另一种方法。***********``******`**********