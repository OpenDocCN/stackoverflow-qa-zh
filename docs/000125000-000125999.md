# StackOverflow 问答 000125000-000125999

# environment - 切换到站立式办公桌

> ID：125016
> 
> 赞同：5
> 
> 时间：2008-09-24T02:09:18.697
> 
> 标签：environment, ergonomics

在工作中，我有一张标准办公桌（4 条腿，平坦的表面，你懂的）。一段时间以来，我一直在考虑转换为站立式办公桌。在有限的预算内解决这个问题的最佳方法是什么？我可以在现有的桌子上放置一些好的笔记本电脑/键盘支架吗？哪些是最好的？

我试图避免要求一张全新的办公桌，并尽可能保持简单。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T02:14:50.480

与职业治疗师交谈并获得他们的建议，因为您将在数小时内彻底改变自己的姿势。

帮助残疾人及其照顾者的机构（如果您在澳大利亚，请查看您所在城市的独立生活中心）将是一个良好的开端。如果他们有陈列室，您将能够测试各种模型，并从医疗专业人士而不是家具推销员那里获得建议。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-10-14T17:39:53.537

这已经出现在一些可能对大多数 SOers 很近且很重要的博客中：

*   [Lifehacker：最酷的工作空间竞赛：DIY Startup Desk](http://lifehacker.com/software/contest/coolest-workspace-contest--diy-startup-desk-170906.php)
*   [编码恐怖：计算机工作站人体工程学](http://www.codinghorror.com/blog/archives/000938.html)

我认为站立一天的一部分时间显然有一些好处。更好的是[跑步机办公桌](http://www.brainrules.net)（观看“锻炼增强脑力”电影，并在 3:09 左右注意）。

# python - 初学者正在寻找漂亮且具有指导意义的 Python 代码

> ID：125019
> 
> 赞同：14
> 
> 时间：2008-09-24T02:11:05.323
> 
> 标签：python

作为一个完全没有编程经验的初学者，我正在努力寻找漂亮的 Python 代码来学习和玩耍。请通过指向一个网站、一本书或一些软件项目来回答。

我有以下标准：

*   完整的代码清单（工作的、可破解的代码）
*   漂亮的代码（可读性强，简单但有效）
*   初学者教学（是的，需要手持）

我已经尝试学习如何编程太久了，从来没有达到橡胶上路的地步。[Nat Friedman 的“如何成为一名黑客](http://nat.org/blog/?p=773)”很好地说明了我的主要议程。

我知道 O'Reilly 的“Beautiful Code”，但认为它对于初学者来说太高级且令人困惑。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-09-24T02:20:16.457

购买[编程集体智能](https://rads.stackoverflow.com/amzn/click/com/0596529325)。基于挖掘数据的有趣 AI 算法的好书，所有示例都使用非常易于阅读的 Python。

另一本很棒的书是[Python 中的文本处理](https://rads.stackoverflow.com/amzn/click/com/0321112547)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-24T02:16:51.643

阅读 Python 库本身。他们正在工作，可破解，优雅且具有指导意义。有些简单，有些复杂。

最重要的是，当您下载 Python 本身时，您就得到了它。它在您的 Python 库目录中。除了开始四处闲逛之外，别无他法。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-24T03:46:44.767

去做就对了。

说真的，除非你写了一些程序，否则你永远学不会成为一名优秀的程序员。首先你会写出糟糕的程序，然后你会修复它们，然后你会写出更好的程序，等等……

如果你没有贪得无厌的动力去尝试编码，那么也许它不适合你。获得动力的一种方法是找到一份需要你编写代码的工作……对我来说，没有什么比让我的薪水和自豪感更能让我工作了:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-24T02:14:46.830

Python 项目本身维护着一份不错[的初学者指南列表](http://wiki.python.org/moin/BeginnersGuide)。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-24T02:17:38.803

美丽很难定义，这个问题没有真正的答案。遵循 Nat 在您链接的帖子中所说的最佳建议：

1.  将源代码下载到您要更改的程序中
2.  在硬盘上解压
3.  让它构建和运行
4.  在编辑器中打开源代码
5.  找到您需要更改的代码部分，以使程序执行您希望它执行的操作
6.  对代码进行所需的更改并对其进行测试以确保其正常工作
7.  运行 diff -u 命令并将输出通过电子邮件发送到邮件列表

寻找漂亮的代码是没有意义的。只需查看并修复您使用的项目中的错误（Django 和 Twisted 可能是不错的候选者）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T02:13:38.673

我在许多博客中看到[了如何像计算机科学家一样思考。](http://www.greenteapress.com/thinkpython/thinkCSpy/)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T02:22:31.303

我个人认为，除非你对这门语言，尤其是它的习语有深刻的理解，否则阅读好的代码是行不通的。首先，我推荐基本的 Wikibook“ [Non-Programmer's Tutorial for Python](http://en.wikibooks.org/wiki/Non-Programmer%27s_Tutorial_for_Python/Contents) ”作为入门。如果其中大部分是有道理的，那么您已经对基础知识有了很好的理解。

之后，我推荐[Dive into Python](http://www.diveintopython.net)。你会看到很多其他人推荐这本书，因为它全面且免费。您将在 Dive into Python 中学习很多特定于语言的习语，尤其是在前几章中。当你阅读它时，尝试使用 Mark Pilgrim 展示的技术来完成基本程序。

深入 Python 将在本书后面部分介绍特定模块。这可能会有点无聊，当它发生时，您可能想查看代码。我觉得没有资格对这些使用的代码进行排名，但[Django](http://www.djangoproject.com/)和[Deluge](http://deluge-torrent.org/)都是更大的项目，它们将向您展示大型程序的组织。尽管除非您花时间一次真正地攻击它们并获得坚定的理解，否则它们可能会让人不知所措。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-12-14T18:39:11.880

我从 O'Reilly 的*Python Cookbook*中学到了很多漂亮且有用的 Python 。 [http://oreilly.com/catalog/9780596001674/](http://oreilly.com/catalog/9780596001674/)

我还从 ActiveState 的 Python Recipe 的网页中学到了很多东西。[http://code.activestate.com/recipes/langs/python/](http://code.activestate.com/recipes/langs/python/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-24T03:25:05.943

我建议您查看适用于 linux 的 Exaile 音乐播放器。它包括很多实用的东西，比如插件、lambda、装饰器、设置管理器、gui（使用 GTK+）等等。

Exaile 源代码并不理想，但会为您提供足够有用的信息和基本的 Python 编码概念。

# php - 在 XP / IIS 5.1 上安装 PHP？

> ID：125022
> 
> 赞同：2
> 
> 时间：2008-09-24T02:11:34.933
> 
> 标签：php, windows-xp, installation, windows-installer

我正在尝试将 PHP 安装到我的开发盒 (XP SP3 / IIS 5.1) 我已经下载了 PHP 5.2.6 稳定版（MSI 安装程序包），我收到错误“找不到 httpd.conf”。之后安装似乎很快（比我预期的要快）并且当我尝试从我创建的本地主机测试目录中执行一个简单的 PHP 脚本时，我得到了一系列丢失的 DLL 错误。我已经看到那里的帖子表明它可能并且已经完成。我在 PHP.NET 支持中没有看到任何有关此 MSI 的错误报告。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T02:17:21.830

不确定你是否已经有了这个，但我使用来自[http://www.wampserver.com/en的 WAMP](http://www.wampserver.com/en)

它的设置简单易行，系统托盘中有一个图标，表明它处于活动状态，您可以通过单击图标并设置它使其上线或对外可用。我在第一次学习 PHP 时使用了它，因为它集所有功能于一体，无需设置任何其他服务，如 IIS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T02:27:25.050

可能安装程序没有配置您的服务器以正确使用 PHP。查看微软关于[在 IIS 上启用 PHP](http://www.iis.net/php)的页面，或者如果这是一个可行的选项，也可以切换到 Apache。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T02:33:30.823

我会看看我是否能正确记住它：

1.  将 PHP zip 文件解压缩到`c:\Program Files\php`（或运行安装程序）
2.  复制`php5ts.dll`到`c:\windows\system32`
3.  复制并重命名`php.ini.dist`为`c:\windows``php.ini`
4.  编辑`c:\windows\php.ini`并查找扩展目录 - 使其指向`c:\Program Files\php\extensions`（或您放置的任何位置）
5.  这就是我记忆模糊的地方：编辑您的 IIS 应用程序设置，为`.php`文件添加脚本映射，并将可执行文件设置为`php5ts.dll`
6.  利润！？！？？！？！

# svn - 将 SVN 提交发送到 RSS 提要

> ID：125028
> 
> 赞同：18
> 
> 时间：2008-09-24T02:13:25.600
> 
> 标签：svn, rss

所以我最喜欢的 Web 工具[Subtlety](http://subtlety.errtheblog.com)最近停产了，这意味着我不再能够轻松访问我关注的各种 SVN 项目的提交日志。是否有任何其他工具可以轻松地为公共 SVN 存储库提供提交的 RSS 提要？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-24T02:24:52.093

我也打算建议使用 Trac，直到我意识到您可能对相关存储库没有管理控制权。也许这个明显的解决方案对你有用？

[http://svnfeed.com/](http://svnfeed.com/)

它似乎适用于我尝试过的一个存储库，而且速度惊人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T02:24:27.197

[SvnFeed](http://svnfeed.com)

另请查看适用于 Windows 的[CommitMonitor](http://tools.tortoisesvn.net/CommitMonitor)，它具有非常出色的 diff 支持

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-18T08:50:13.247

我刚刚尝试[了 sventon](http://www.sventon.org)，效果很好。它是一个基于网络的 SVN 查看器，它的功能很合理，但在您想要订阅的任何级别都提供了一个很好的 RSS 提要。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T02:23:26.917

Atlassian Fisheye ( [http://www.atlassian.com/software/fisheye/](http://www.atlassian.com/software/fisheye/) ) 允许您在电子邮件和 RSS 上获得提交通知（作为奖励，您可以选择要订阅的目录/文件，并且只获得通知这些文件/目录更改）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-08-19T10:25:53.667

另一个工具是[http://sourceforge.net/projects/svn2rss/](http://sourceforge.net/projects/svn2rss/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T02:18:02.343

试试[Trac](http://trac.edgewall.org/)。除了提要，您还可以浏览存储库，它有一个不错的 Wiki。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T02:18:10.253

我喜欢[Trac](http://trac.edgewall.org/)，尽管它可能对您的需要有点过分。 [WebSVN](http://websvn.tigris.org/)也是一个很好的通过网络浏览存储库的工具。这两个都为日志提供 RSS 提要。您还可以仅订阅特定分支的日志等。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T02:27:35.970

我也在使用 Sublety。当它消失时，这真是令人沮丧。我最终推出了自己的解决方案。它基于 .NET，需要使用提交后挂钩脚本。它是免费的，我提供了二进制文件和源代码。

[Subversion C# RSS 提要挂钩脚本](http://www.systemwidgets.com/Downloads/FreeDownloads/SubversionChooks/tabid/82/Default.aspx)

[带有漂亮 xsl 模板的实时存储库 rss 提要](http://www.wheelmud.net/Development/DevelopmentLog/tabid/62/Default.aspx)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2008-09-24T02:22:07.013

有[subveRSSed](http://www.subversionary.org/projects/subverssed)，您只需将其放入您的提交后操作中。

# python - 使实例中的选定属性成为只读的最简单、最简洁的方法是什么？

> ID：125034
> 
> 赞同：8
> 
> 时间：2008-09-24T02:15:21.430
> 
> 标签：python, attributes, readonly

在 Python 中，我想让类的**选定**实例属性对类外的代码只读。我希望外部代码无法更改属性，除非间接通过调用实例上的方法。我希望语法简洁。什么是最好的方法？（我在下面给出我目前的最佳答案......）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-24T02:22:16.967

你应该使用`@property`装饰器。

```
>>> class a(object):
...     def __init__(self, x):
...             self.x = x
...     @property
...     def xval(self):
...             return self.x
... 
>>> b = a(5)
>>> b.xval
5
>>> b.xval = 6
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: can't set attribute 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T02:21:56.250

```
class C(object):

    def __init__(self):

        self.fullaccess = 0
        self.__readonly = 22 # almost invisible to outside code...

    # define a publicly visible, read-only version of '__readonly':
    readonly = property(lambda self: self.__readonly)

    def inc_readonly( self ):
        self.__readonly += 1

c=C()

# prove regular attribute is RW...
print "c.fullaccess = %s" % c.fullaccess
c.fullaccess = 1234
print "c.fullaccess = %s" % c.fullaccess

# prove 'readonly' is a read-only attribute
print "c.readonly = %s" % c.readonly
try:
    c.readonly = 3
except AttributeError:
    print "Can't change c.readonly"
print "c.readonly = %s" % c.readonly

# change 'readonly' indirectly...
c.inc_readonly()
print "c.readonly = %s" % c.readonly 
```

这输出：

$ python ./p.py
c.fullaccess = 0
c.fullaccess = 1234
c.readonly = 22
Can't change c.readonly
c.readonly = 22
c.readonly = 23

我的手指痒得能说

```
 @readonly
    self.readonly = 22 
```

即，在属性上使用装饰器。会很干净...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T06:49:36.107

就是这样：

```
class whatever(object):
  def __init__(self, a, b, c, ...):
    self.__foobar = 1
    self.__blahblah = 2

  foobar = property(lambda self: self.__foobar)
  blahblah = property(lambda self: self.__blahblah) 
```

（假设`foobar`和`blahblah`是您希望只读的属性。）在属性名称前添加**两个**下划线可以有效地将其隐藏在类外部，因此无法从外部访问内部版本。这**仅适用于从 object 继承的新型类，**因为它依赖于`property`.

另一方面......这是一件非常愚蠢的事情。保持变量私有似乎是来自 C++ 和 Java 的一种痴迷。您的用户应该使用您的类的公共接口，因为它设计得很好，而不是因为您强迫他们这样做。

编辑：看起来凯文已经发布了类似的版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T02:20:16.847

没有真正的方法可以做到这一点。有一些方法可以让它变得更“困难”，但没有完全隐藏、无法访问的类属性的概念。

如果不能信任使用您的课程的人遵循 API 文档，那么这是他们自己的问题。保护人们不做愚蠢的事情只是意味着他们会做更精细、更复杂和更具破坏性的愚蠢事情来尝试做他们一开始就不应该做的事情。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T02:49:37.477

您可以使用元类将遵循命名约定的方法（或类属性）自动包装到属性中（无耻地取自[Python 2.2 中的统一类型和类](http://www.python.org/download/releases/2.2/descrintro/#metaclasses)：

```
class autoprop(type):
    def __init__(cls, name, bases, dict):
        super(autoprop, cls).__init__(name, bases, dict)
        props = {}
        for name in dict.keys():
            if name.startswith("_get_") or name.startswith("_set_"):
                props[name[5:]] = 1
        for name in props.keys():
            fget = getattr(cls, "_get_%s" % name, None)
            fset = getattr(cls, "_set_%s" % name, None)
            setattr(cls, name, property(fget, fset)) 
```

这允许您使用：

```
class A:
    __metaclass__ = autosuprop
    def _readonly(self):
        return __x 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-04-24T11:37:38.000

我知道威廉凯勒是迄今为止最干净的解决方案..但这是我想出的东西..

```
class readonly(object):
    def __init__(self, attribute_name):
        self.attribute_name = attribute_name

    def __get__(self, instance, instance_type):
        if instance != None:
            return getattr(instance, self.attribute_name)
        else:
            raise AttributeError("class %s has no attribute %s" % 
                                 (instance_type.__name__, self.attribute_name))

    def __set__(self, instance, value):
        raise AttributeError("attribute %s is readonly" % 
                              self.attribute_name) 
```

这是使用示例

```
class a(object):
    def __init__(self, x):
        self.x = x
    xval = readonly("x") 
```

不幸的是，这个解决方案不能处理私有变量（__ 命名变量）。

# oop - 多态性和多分派有什么区别？

> ID：125050
> 
> 赞同：35
> 
> 时间：2008-09-24T02:20:08.923
> 
> 标签：oop, polymorphism, multiple-dispatch, double-dispatch

...或者它们是同一件事吗？我注意到每个都有自己的 Wikipedia 条目：[Polymorphism](http://en.wikipedia.org/wiki/Polymorphism_(computer_science))、[Multiple Dispatch](http://en.wikipedia.org/wiki/Multiple_dispatch)，但我无法看到这些概念的不同之处。

**编辑：**[重载](http://en.wikipedia.org/wiki/Overloaded)如何适应这一切？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2008-09-24T03:53:47.043

多态性是允许语言/程序在运行时根据发送到该方法的参数类型决定调用哪个方法的工具。

语言/运行时使用的参数数量决定了语言支持的多态性的“类型”。

单一调度是一种多态性，其中仅使用一个参数（消息的接收者 -`this`或`self`）来确定调用。

多重分派是一种多态性，其中使用多个参数来确定调用哪个方法。在这种情况下，接收者以及方法参数的类型用于告诉调用哪个方法。

所以你可以说多态是一个通用术语，而多次和单次调度是特定类型的多态。

附录：重载发生在编译期间。它使用编译期间可用的类型信息来确定要调用的方法类型。单/多分派发生在运行时。

示例代码：

```
using NUnit.Framework;

namespace SanityCheck.UnitTests.StackOverflow
{
    [TestFixture]
    public class DispatchTypes
    {
        [Test]
        public void Polymorphism()
        {
            Baz baz = new Baz();
            Foo foo = new Foo();

            // overloading - parameter type is known during compile time
            Assert.AreEqual("zap object", baz.Zap("hello"));
            Assert.AreEqual("zap foo", baz.Zap(foo));

            // virtual call - single dispatch. Baz is used.
            Zapper zapper = baz;
            Assert.AreEqual("zap object", zapper.Zap("hello"));
            Assert.AreEqual("zap foo", zapper.Zap(foo));

            // C# has doesn't support multiple dispatch so it doesn't
            // know that oFoo is actually of type Foo.
            //
            // In languages with multiple dispatch, the type of oFoo will 
            // also be used in runtime so Baz.Zap(Foo) will be called
            // instead of Baz.Zap(object)
            object oFoo = foo;
            Assert.AreEqual("zap object", zapper.Zap(oFoo));
        }

        public class Zapper
        {
            public virtual string Zap(object o) { return "generic zapper" ; }
            public virtual string Zap(Foo f) { return "generic zapper"; }
        }

        public class Baz : Zapper
        {
            public override string Zap(object o) { return "zap object"; }
            public override string Zap(Foo f) { return "zap foo"; }
        }

        public class Foo { }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T02:58:02.810

使用多重分派，一个方法可以有多个参数传递给它，并且使用哪个实现取决于每个参数的类型。评估类型的顺序取决于语言。在 LISP 中，它从头到尾检查每种类型。具有多重分派的语言使用泛型函数，它们只是函数声明，不像泛型方法，后者使用类型参数。

多重分派允许子类型化方法调用的参数[多态性。](http://en.wikipedia.org/wiki/Type_polymorphism#Subtyping_polymorphism_.28or_inclusion_polymorphism.29)

单一分派还允许一种更有限的多态性（对实现相同接口或继承相同基类的对象使用相同的方法名称）。这是多态性的经典示例，其中您的方法在子类中被覆盖。

除此之外，*泛型*还提供参数类型多态性（即，相同的泛型接口可用于不同类型，即使它们不相关——例如`List<T>`：它可以是任何类型的列表，并且无论如何都以相同的方式使用）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T02:25:49.190

Multiple Dispatch 更类似于函数重载（如在 Java/C++ 中所见），不同之处在于调用的函数取决于参数的运行时类型，而不是它们的静态类型。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-24T02:34:34.253

我以前从未听说过 Multiple Dispatch，但是在浏览了 Wikipedia 页面之后，当与方法的参数一起使用时，它看起来很像 MD 是一种多态性。

多态性本质上是一个对象可以被看作是它的基础的任何类型的概念。因此，如果您有 a`Car`和 a `Truck`，它们都可以被视为 a `Vehicle`。这意味着您可以`Vehicle`为任何一个调用任何方法。

多重分派看起来很相似，因为它允许您使用多种类型的参数调用方法，但是我在描述中没有看到某些要求。首先，它似乎不需要一个通用的基本类型（我无法想象没有 THAT 的实现`void*`），并且您可以涉及多个对象。

因此`Start()`，您可以调用在`StartObject(Object C)`其他地方定义的方法并对其进行编码以在运行时检查参数类型并适当地处理它，而不是在列表中的每个对象上调用该方法（这是一个经典的多态示例）。这里的区别在于`Start()`方法必须内置在类中，而`StartObject()`方法可以在类之外定义，因此各种对象不需要符合接口。

`Start()`如果需要使用不同的参数调用该方法，这可能会很好。也许`Car.Start(Key carKey)`对。`Missile.Start(int launchCode)`

但两者都可以称为`StartObject(theCar)`或`StartObject(theMissile)`

有趣的概念...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T02:40:25.580

如果您想要方法调用的概念等价物

```
(obj_1, obj_2, ..., obj_n)->method 
```

要依赖于元组中的每个特定类型，那么您需要多次调度。多态对应于 n=1 的情况，是 OOP 的必要特征。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T02:22:36.390

Multiple Dispatch 是一种多态性。在 Java/C#/C++ 中，通过继承和覆盖存在多态性，但这不是基于两个或多个参数的多分派（不仅仅是`this`，就像在 Java/C#/C++ 中那样）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T02:25:51.560

Multiple Dispatch 依赖于基于多态性。在 C++、C#、VB.NET 等中遇到的典型多态性使用单一调度——即被调用的函数仅依赖于单个类实例。多次调度依赖于多个类实例。

# .net - 将 DataSet 和 DataTables 与数据库同步

> ID：125074
> 
> 赞同：0
> 
> 时间：2008-09-24T02:26:02.230
> 
> 标签：.net, ado.net

我第一次将 ADO.net 与 DataSet 和 DataTables 一起使用，我遇到了一个非常重要的问题。每次更改数据库表定义中的任何内容时，似乎都没有一种简单的方法可以将这些更改同步到我的 DataSet 中的 DataTable 定义。

到目前为止，简单地删除我的 DataTable 对象并从服务器资源管理器中拖动一个新对象并重新创建我的查询已经很快了。但是随着我的应用程序的增长，这很快就会变得不可能。我也不想记录对数据库的每一次更改，并记住在任何受影响的 DataTables 的每个相应列中更改这些定义。

作为记录，我使用的是 VS 2008、MySQL 5.0、ASP.net。ADO.net 是我的数据提供者，我真的很后悔。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T02:32:41.340

更新：根据马修，这不起作用。将我的帖子留在这里，直到出现更好的解决方案。

似乎 DataTable 上下文菜单上有一个配置选项，它应该触发[模式刷新](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=428338&SiteID=1)。你可以试一试并告诉我们吗？

# project-management - 你经历过的最糟糕的项目失败是什么？

> ID：125081
> 
> 赞同：0
> 
> 时间：2008-09-24T02:27:42.897
> 
> 标签：project-management

最重要的是，为什么会失败？

我在这里寻找的是任何人，无论是新来的团队还是刚刚醒来的一天，都能发现的病态。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T02:52:32.853

我最近的项目失败了，因为所有开发人员都花时间在 Stack Overflow 上提问和回答问题，试图建立 Karma 积分 :-)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T03:52:44.987

阅读《[死亡行军](https://rads.stackoverflow.com/amzn/click/com/013143635X)》。这几乎总结了病理学等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T02:44:10.300

一个没有尽头的项目。没有人知道它什么时候完成。我们所知道的是，我们必须继续做我们正在做的事情。是的，可悲的是，它就像我解释的那样含糊不清。

有没有失败。在我看来，它确实做到了，因为我们从来没有看到最后发生了什么，我们被转移到另一个项目，你可以说它消失在夜里。

为什么？与 7 项目管理知识体系相反的一切。

# c++ - 在 C++ 中透明地交换指向字符数组的指针

> ID：125094
> 
> 赞同：2
> 
> 时间：2008-09-24T02:34:16.203
> 
> 标签：c++, pointers

我有一个 2D 字符数组：我想通过简单地写 where
`char nm[MAX1][MAX2] = { "john", "bob", "david" };`
来交换其中两个元素（不带）看起来像这样 `std::swap`
`swapPointers(nm[0], nm[1]);`
`swapPointers`

```
void swapPointers(char *&a, char *&b)  
{  
    char *temp = a;  
    a = b;  
    b = a;  
} 
```

但是，这不会编译（并且在添加强制转换使其编译时，指针最终指向错误/奇怪的位置）。

有人可以帮忙吗？
谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T04:44:46.623

Zan 很接近，但他的问题是他的“交换”函数可以获取任何指向字符的指针。如果使用不当，这可能会导致问题。这是一个更安全的版本：

```
void swap(char (&x)[MAX2], char (&y)[MAX2])
{
    char temp[MAX2];

    memcpy(temp, x, MAX2);
    memcpy(x, y, MAX2);
    memcpy(y, temp, MAX2);
} 
```

发帖人也有一个误解：‘nm’是一个二维的字符数组。没有指针。nm[0]、nm[2] 等...也不是指针——它们仍然是（一维）数组。一维数组可以隐式转换为指针这一事实在许多 C 和 C++ 程序员中引起了这种混淆。

为了交换二维数组中的数据，您必须交换大小为 MAX2 的内存块——正如我和 Zan 编写的“交换”函数所示。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T03:02:47.820

您不能通过重新分配指针来交换这些指针，因为这些指针指向二维字符数组。

nm[a] 和 nm[b] 非常强烈`const`，因为 nm 是一个真正的`const`对象。如果不是，您可以通过重新分配它们的名称来在 RAM 中移动 C 变量。

想想浩劫吧！所以你不能那样做。:-)

要交换这些指针指向的内容，您需要交换这些数组位置中的值。

```
swap(char *a, char *b)
{
  char temp[MAX1];
  memcpy(temp, a, MAX1);
  memcpy(b, a, MAX1);
  memcpy(a, temp, MAX1);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T03:25:47.127

您的`swapPointers()`交换指针，而您正在尝试将其传递给数组。

如果你改变

```
char nm[MAX1][MAX2] 
```

到

```
char *nm[MAX1] 
```

并修复`swapPointers()`（最后一行应该是`b = temp;`）中的小错误，它可以工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T05:25:43.547

真正的重点是，如果您使用的是 c++，那么您应该使用 std::string 的 std::vector 来代替：

```
std::vector<std::string> nm;
nm.push_back( "john" );
nm.push_back( "bob" );
nm.push_back( "david" );
std::swap( nm[0], nm[1] ); 
```

注意：未测试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T02:37:52.140

```
void swapPointers(char** ppa, char** ppb)
{
    char* ptemp = *ppa;
    *ppb = *ppa;
    *ppa = ptemp;
}

swapPointers(&nm[0], &nm[1]); 
```

# c# - 我可以在几个情况下关闭模拟吗

> ID：125096
> 
> 赞同：19
> 
> 时间：2008-09-24T02:34:40.477
> 
> 标签：c#, asp.net, impersonation

我有一个在整个过程中都使用模拟的应用程序。但是当用户以管理员身份登录时，一些操作需要他们写入服务器本身。现在，如果这些用户在实际服务器上没有权限（有些没有），它不会让他们写。

我想要做的只是关闭几个命令的模拟。

有没有办法做这样的事情？

```
using(HostingEnvironment.Impersonate.Off())
  //I know this isn't a command, but you get the idea? 
```

谢谢你。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-10-20T03:25:02.403

确保应用程序池确实具有您需要的适当权限。

然后，当您想要恢复到应用程序池身份时...运行以下命令：

```
private WindowsImpersonationContext context = null;
public void RevertToAppPool()
{
    try
    {
        if (!WindowsIdentity.GetCurrent().IsSystem)
        {
            context = WindowsIdentity.Impersonate(System.IntPtr.Zero);
        }
    }
    catch { }
}
public void UndoImpersonation()
{
    try
    {
        if (context != null)
        {
            context.Undo();
        }
    }
    catch { }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T03:14:19.837

我不确定这是否是首选方法，但是当我想这样做时，我新建了一个[WindowsIdentity](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx)实例并调用了[Impersonate](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.impersonate.aspx)方法。这允许后续代码模拟不同的 Windows 用户。它返回一个具有[Undo方法的](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext.undo.aspx)[WindowsImpersonationContext](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext.aspx) ，该方法可以再次恢复模拟上下文。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T03:43:14.853

您可以关闭页面的身份验证，然后在代码的其余部分手动模拟经过身份验证的用户。

[http://support.microsoft.com/kb/306158](http://support.microsoft.com/kb/306158)

这有对最后一部分的引用，但基本上你冒充 User.Identity

这意味着您必须在对页面的任何调用开始时模拟，在需要时将其关闭，然后在完成后重新打开，但这应该是一个可行的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T05:33:00.690

我刚刚将文件夹写入权限授予“经过身份验证的用户”

# algorithm - 控制坦克类车辆运动的公式？

> ID：125099
> 
> 赞同：6
> 
> 时间：2008-09-24T02:36:45.170
> 
> 标签：algorithm, language-agnostic

有人知道用于控制简单坦克式车辆运动的公式吗？

要“引导”它，您需要改变施加在左右“轮子”上的力。例如。两个轮子上的 1 个单位的力使它前进。两个轮子上的 -1 单位的力使它倒退。对一个轮子施加比另一个轮子更大的力，它就会转动。

您将如何计算两个轮子上将油箱转动一定度数所需的力？

还是我以错误的方式思考这个问题？

编辑：正如威廉凯勒所说，我错过了坦克的速度。假设两个车轮上的 1 个单位的力使坦克以每秒 1 个单位的速度向前移动。

对于任何感兴趣的人，我刚刚在 gamedev.net 上找到了这个帖子：http://66.102.9.104/search?q=cache:wSn5t58ACJwJ: [www.gamedev.net/community/forums/topic.asp%3Ftopic_id%3D407491+tank +track+radius+velocity&hl=en&ct=clnk&cd=1&gl=za&client=firefox-a](http://66.102.9.104/search?q=cache:wSn5t58ACJwJ:www.gamedev.net/community/forums/topic.asp%3Ftopic_id%3D407491+tank+track+radius+velocity&hl=en&ct=clnk&cd=1&gl=za&client=firefox-a)

另一个线程： [http ://www.physicsforums.com/showthread.php?t=220317](http://www.physicsforums.com/showthread.php?t=220317)

事实证明，找到公式的关键是知道正确的术语（“滑移”）：P

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T02:47:49.167

你想错了。问题是，轨道上不同的力不会使坦克转动一定的度数。相反，不同的力会改变*转弯速度*。

力和转弯速率之间的关系会因坦克的机械结构而异。油箱越宽，转动越慢。坦克越快，它转动的越快。

PS对此还有一些想法：我认为如果不基于真实世界的坦克，基于物理的答案是不可能的。一些答案解决了转弯的物理问题，但所有答案都隐含假设系统具有无限的能力。坦克真的可以在 1、-1 下运行吗？它能否立即达到那个速度——加速度也适用于转弯。

最后，胎面有长度和宽度。这意味着在任何转弯情况下，胎面都会发生一些侧滑，转弯越快，需要的滑移就越多。这将在急转弯中消耗能量，即使发动机有能力进行 1、-1 转，由于摩擦损失，它也不会像显示的那样快速转动。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-08-23T22:03:45.680

对于需要以内轮/履带的给定速度“Si”以半径“r”转弯的滑移转向车辆，外履带必须以速度“So”行驶：

```
So = Si * ((r+d)/r) 
```

**细节：**

在防滑转向中，外轮/履带比内轮/履带行驶更远的距离进行转弯。

此外，额外的行驶距离与内履带同时完成，这意味着外轮/履带必须跑得更快。

由“内”轨道外接的圆周：

```
c1 = 2*PI*r
'r' is radius of circle origin to track/wheel 
```

由“外”轨道外接的圆周：

```
c2 = 2*PI*(r+d)
'r' is radius of circle origin to inner track/wheel
'd' is the distance between the Inner and Outer wheels/track. 
```

此外，c2 = X * c1，表示 c2 按比例大于 c1

```
X = c2 / c1
X = 2*PI*(r+d) / 2*PI*r
X = (r+d)/r 
```

因此，对于需要以内轮/履带的给定速度“s”以半径“r”转弯的滑移转向车辆，外履带必须以：

```
So = Si * ((r+d)/r) 
```

在哪里：

```
'So' = Speed of outer track
'Si' = Speed of inner track
'r'  = turn radius from inner track
'd'  = distance between vehicle tracks.

               ********* <---------------- Outer Track
           ****    |    ****                     
        **         |<--------**----------- 'd' Distance between tracks
       *        *******<-------*---------- Inner Track
      *      ***   ^   ***      *  
     *      *      |<-----*------*-------- 'r' Radius of Turn
     *     *       |       *     * 
     *     *       O       *     * 
     *     *               *     * 
     *      *             *      * 
      *      ***       ***      *  
       *        *******        *   
        **                   **    
           ****         ****       
               ********* 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T02:55:16.950

```
Change in angle (in radians/sec) = (l-r)/(radius between treads)
Velocity = l+r 
```

对于 dtheta，假设您的两只手之间有一根木杆，并且您想根据您的手按的力度和方式计算它旋转了多少 - 您想弄清楚：

您每秒覆盖的杆子上的表面距离 -> 旋转数/秒 -> 弧度/秒（即乘以 2pi）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T02:45:17.660

好吧，请记住，您在这里也是在谈论持续时间。您需要找出考虑到坦克在 (1, -1) 处转动的速度的力。

即，如果坦克需要一秒钟在 (1, -1) 处旋转 360°，而您想在一秒钟内旋转 180°，则 (.5, -.5) 可以解决问题。如果您想在半秒内旋转相同的量，那么 (1, -1) 就可以了。

如果你使用 abs(lrate) != abs(rrate)，这一切都会变得更加复杂，在这种情况下，你可能需要拿出一支铅笔！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T03:00:36.907

以下是我将如何解决坦克问题。

坦克的中心可能会以左右轨道的平均速度移动。同时，坦克将围绕其中心顺时针旋转 ([left track speed] * -[right track speed]) / [width]。

这应该给你速度和方向向量。

免责声明：我没有测试过这个......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T02:50:12.983

我已经有一段时间没有做任何物理了，但我原以为两条轨道沿相反方向移动的相对力会导致围绕坦克质心的扭矩。

正是这个扭矩导致了坦克的角动量，这只是坦克开始旋转的另一种说法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T02:53:17.423

这不是力的问题 - 它取决于两侧之间的速度差异，以及这种差异持续多长时间（也是坦克的宽度，但这只是一个常数参数）。

基本上，您应该按照以下方式计算它：

*   两侧的速度比与半径比相同。
*   坦克的宽度是 2 个 rasiuses (sp?) 之间的实际差异。
*   使用这 2 个数字，找到半径的实际值。
*   将其中一侧的速度乘以它移动的时间，得到它行进的距离。
*   通过将其除以该圆圈的周长来计算它经过的完整圆圈的哪一部分。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T02:54:12.320

我会说你以错误的方式思考它。

增加两个踏板之间的速度差异不会导致转弯度数 - 它们与时间（不同速度下的距离）相结合会导致转弯度数。

胎面速度的差异越大，实现 X 度转弯所需的时间就越少。

因此，为了提出一个公式，您必须做出一些假设。要么以固定速率转弯，并将时间用作转弯 X 度的变量，要么设置固定的时间来完成转弯，并将轨道速度差用作变量。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-09-24T03:09:59.380

你可以这样看：每条轨道描述一个圆圈。如果一个轨道正在转向（比如说向左转）而另一条轨道没有转向，那么朝向将取决于左侧轨道转向多长时间和多远。

这个距离将是轨道的速度 x 时间。

现在用这个距离画一个三角形，用铅笔画出轴距，加上一些正弦和余弦方程和近似值，你可能会得到一个近似方程，如：

面对变化=轨道行驶的距离/轴距

然后你可以加入一些更现实的加速：更多的物理......

速度不是恒定的 - 它会加速（和减速）。

即在一段时间内，速度从 0 增加到 0.1 ... 0.2 ... 0.3 直到一个极限。

当然，随着速度的变化，面层的变化率也会发生变化 - 比速度（以及面层的变化率）完全恒定更现实一点。

换句话说，玩家不是控制速度，而是控制速度的*变化*。当玩家推动控制器时，这将使速度从 0 ... 0.02 ... 0.06 ... 0.1 等。减速也类似，但可能要快一点。

希望这可以帮助。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-24T03:14:28.200

我想每个人也应该注意坦克可以在零半径圆上转弯：通过在每条轨道上应用相同的速度但方向相反，坦克*可以*转弯一角钱。

# java - Java的免费/开源测试生成器？

> ID：125100
> 
> 赞同：16
> 
> 时间：2008-09-24T02:37:45.103
> 
> 标签：java, unit-testing, testing, open-source, code-generation

是否有任何 Java 库可以为现有代码生成单元测试或单元测试框架？我正在寻找类似于[pythoscope](http://pythoscope.org/)的东西。理想情况下，它将生成遵循 JUnit4 或 TestNG 约定的代码。

看起来[Agitar](http://www.agitar.com/)做了这样的事情，但我正在寻找免费的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T04:05:10.183

大多数 IDE 将为任何类生成测试方法存根。我知道 Eclipse 会的。

New->JUnit Class 然后你告诉它你正在测试哪个类以及你想测试什么方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-11T05:20:58.907

我的插件创建单元测试，它同时进行 JUnit 或 TestNG 测试。希望你喜欢。 [http://fast-code.sourceforge.net/](http://fast-code.sourceforge.net/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T02:41:34.173

Agitar 有一项免费服务允许您执行此操作（您必须准备好让它将您的代码发送到他们的服务器）。

如果您使用的是 scala，则有“scala check”-但我不确定它与 java 源代码的工作情况如何（即使它是所有字节码）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-05T12:17:53.697

我一直在尝试让 TestGen4j 运行，但它看起来还没有得到维护 :( 也许你试一试？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-07-23T06:16:57.323

来自谷歌的制造商：（[https://developers.google.com/java-dev-tools/codepro/doc/features/junit/test_case_generation](https://developers.google.com/java-dev-tools/codepro/doc/features/junit/test_case_generation)）

## CodePro 分析

CodePro JUnit 测试用例生成工具允许您自动创建全面的 JUnit 回归测试用例。给定一个输入类，该工具会为每个输入类方法创建一个相应的测试类，其中包含多个测试方法。该工具分析每个方法和输入参数，目的是生成执行每一行代码的测试用例

# javascript - 向文本子字符串添加新元素

> ID：125102
> 
> 赞同：2
> 
> 时间：2008-09-24T02:37:49.427
> 
> 标签：javascript, jquery, python, beautifulsoup

假设我有以下字符串：

```
"I am the most foo h4ck3r ever!!" 
```

我正在尝试编写一个 makeSpecial(foo) 函数，其中 foo 子字符串将被包装在一个新的 span 元素中，从而导致：

```
"I am the most <span class="special">foo></span> h4ck3r ever!!" 
```

BeautifulSoup 似乎是要走的路，但我无法让它发挥作用。

我也可以将它传递给浏览器并使用 javascript 来完成，但这似乎不是一个好主意。

对此的一些建议将非常有用，尤其是在 python 中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T02:46:54.350

这个怎么样：

```
Python 2.5.1 (r251:54863, Apr 18 2007, 08:51:08) [MSC v.1310 32 bit (Intel)] on
win32
Type "help", "copyright", "credits" or "license" for more information.
>>> def makeSpecial(mystring, special_substr):
...     return mystring.replace(special_substr, '<span class="special">%s</span>
' % special_substr)
...
>>> makeSpecial("I am the most foo h4ck3r ever!!", "foo")
'I am the most <span class="special">foo</span> h4ck3r ever!!'
>>> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T02:49:13.440

据我所知，你正在做一个简单的字符串替换。您将“foo”替换为“bar foo bar”。所以从[字符串](http://docs.python.org/lib/string-methods.html "字符串方法")你可以使用

```
replace(old, new[, count]) 
```

返回字符串的副本，其中所有出现的子字符串 old 都替换为 new。如果给定了可选参数 count，则仅替换第一个 count 出现。

所以对你来说，这将是：

```
myStr.replace("foo", "<span>foo</span>") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T02:51:15.027

如果你想用 javascript/jQuery 来做，看看这个问题：[Highlight a word with jQuery](https://stackoverflow.com/questions/119441/highlight-a-word-with-jquery)

# installation - 在哪里可以找到有关服务器端软件安装文档的模板？

> ID：125107
> 
> 赞同：0
> 
> 时间：2008-09-24T02:40:10.840
> 
> 标签：installation, documentation

我正在为我正在从事的项目寻找一个关于服务器端软件安装的好模板。

客户端非常简单。服务器端安装有点棘手。它由几个部分组成（服务、数据库连接、依赖项、需要畅通的端口等）。在最近的一次测试中，发现了几件未记录的碎片。现在，我需要为我们的灾难恢复计划和测试安装的方法创建安装文档，而不必使用“完整的”系统进行测试。

我真的很想建议我在哪里可以获得模板或此类文档的非常好的示例。我希望它是操作员可以在恢复的热度中阅读和理解的东西。

* * *

[编辑] 我们当前的文档主要来自我们的管理员在场外测试期间遇到的问题。在编写新代码时，我想确保提前编写文档。我一直在收集 VMWare 映像以开始测试，但一直在寻找一些好的示例。这是一家 Windows Server 商店（2000 和 2003 年）。Word 模板会很棒，但如果我能看到好的文档，我可以创建模板。关于应该测试什么的任何建议也很好。

* * *

[第二次编辑] 我从发布的答案中得到了几个好主意。改变我的谷歌搜索后，我想出了一些好的起点。它们并不完美，但它们是一个好的开始。

Microsoft Exchange - [http://technet.microsoft.com/en-us/library/bb125074(EXCHG.65).aspx](http://technet.microsoft.com/en-us/library/bb125074(EXCHG.65).aspx) iPhone - [http://manuals.info.apple.com/en_US/Enterprise_Deployment_Guide.pdf](http://manuals.info.apple.com/en_US/Enterprise_Deployment_Guide.pdf)

[http://www.novell.com/documentation/gwgateways/gw7_exch/index.html?page=/documentation/gwgateways/gw7_exch/data/ab32nt1.html](http://www.novell.com/documentation/gwgateways/gw7_exch/index.html?page=/documentation/gwgateways/gw7_exch/data/ab32nt1.html) [http://cregan.wordpress.com/2006/06/22/ exchange-2003-step-by-step-installation-instructions/](http://cregan.wordpress.com/2006/06/22/exchange-2003-step-by-step-installation-instructions/)

[http://technet.microsoft.com/en-us/magazine/cc160942.aspx](http://technet.microsoft.com/en-us/magazine/cc160942.aspx)

很好地涵盖了设计阶段的规划 - [http://www.onlamp.com/pub/a/onlamp/2004/04/08/disaster_recovery.html?page=2](http://www.onlamp.com/pub/a/onlamp/2004/04/08/disaster_recovery.html?page=2)

* * *

[编辑 10/29/2008]
这是我正在寻找的类型样本。它没有很多垃圾，但似乎足以解释为什么以及如何[http://wiki.alfresco.com/wiki/Installing_Labs_3_Nile](http://wiki.alfresco.com/wiki/Installing_Labs_3_Nile)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T02:59:47.437

我们提出的用于创建 DR 文档的最完整方法包括完成一个（或两个）完整的安装周期，并在此过程中记录每个步骤。

我意识到如果您没有用于创建文档的测试（或替代）系统，这可能会有点困难 - 但值得游说至少运行一次此周期。

（我推荐两次，第二次由不参与项目的人完成 - 这是您为未来的管理员测试文档的方式，他们可能对这个过程没有经验。）

上述的一个副作用是您的文档变得相当大 - 最后我不得不这样做，我相信我们数据库服务器的完整安装手册有 30 多页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T03:33:32.787

根据管理员的不同，自动化很有帮助。我有需要逐步说明的 Word 文档的 Windows 管理员和需要脚本的其他管理员。

然而，一些有用的东西要包括在内，可能是作为部分

*   数据库更改
    *   要运行的脚本
    *   验证他们工作
*   配置更改
    *   有什么变化
    *   新文件的版本在哪里（在我的情况下，他们区分了两者，这有助于减少有关生产特定值的错误）
*   一般验证
    *   从用户的角度来看应该有什么不同（功能变化）
*   对于网络场部署，拥有一份关于如何将服务器拉入和拉出池的协调文档可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T13:13:37.260

**应该测试什么？** 好吧，在网站的情况下，“你能访问该页面吗？” 包括一个 URL 作为起点，让管理员点击到某个点。管理员不必经历整个 QA 周期，只需确认您打算部署的内容确实是已部署的内容。

* * *

**其他想法** 此外，我们（我上一份工作的团队）对部署进行了 QA 测试。作为一名 QA 人员，他对细节并不熟悉，当他部署到 QA 时，我们能够获得关于哪里出了问题的反馈。

另一件有用的事情是在部署之前与管理员坐下来。仔细阅读说明并确保他们以与您相同的方式理解它们。

* * *

**模板？** 只需创建具有数据字段的部分，例如 DEV、QA 和 PROD 的 URL。当您写出说明时，您可以参考这些说明。只需明确正在部署的内容即可。

# winforms - winForms + DataGridView 绑定到列表

> ID：125109
> 
> 赞同：34
> 
> 时间：2008-09-24T02:40:43.367
> 
> 标签：winforms, data-binding

我正在尝试将 a 绑定`List<T>`到 DataGridView 控件，但我没有任何运气来创建自定义绑定。

我努力了：

```
gvProgramCode.DataBindings.Add(new Binding("Opcode",code,"Opcode")); 
```

它抛出一个异常，表示该属性名称没有找到任何内容。

有问题的列的名称是“操作码”。中的属性名称`List<T>`是 Opcode。

**回答编辑**：问题是我的类中没有可绑定字段作为属性，只有公共字段......显然它不会反映字段，只是属性。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-24T02:49:10.520

您是否也将网格上的属性绑定到 Opcode？.. 如果您想直接绑定到 List，您只需 DataSource = list. 数据绑定允许自定义绑定。您是否正在尝试做数据源以外的事情？

你得到一堆空行？自动生成的列有名称吗？您是否已验证数据在对象中（不仅仅是 string.empty）？

```
 class MyObject
    {
        public string Something { get; set; }
        public string Text { get; set; }
        public string Other { get; set; }
    }

    public Form1()
    {
        InitializeComponent();

        List<MyObject> myList = new List<MyObject>();

        for (int i = 0; i < 200; i++)
        {
            string num = i.ToString();
            myList.Add(new MyObject { Something = "Something " + num , Text = "Some Row " + num , Other = "Other " + num  });
        }

        dataGridView1.DataSource = myList;
    } 
```

这应该可以正常工作...

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-24T02:59:29.437

我无法真正说出您要对包含的示例进行什么操作，但是如果您只想列出对象，则绑定到通用对象列表相当简单：

```
 private BindingSource _gridSource;

    private BindingSource GridSource
    {
        get
        {
            if (_gridSource == null)
                _gridSource = new BindingSource();
            return _gridSource;
        }
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        List<FluffyBunny> list = new List<FluffyBunny>();
        list.Add(new FluffyBunny { Color = "White", EarType = "Long", Name = "Stan" });
        list.Add(new FluffyBunny { Color = "Brown", EarType = "Medium", Name = "Mike" });
        list.Add(new FluffyBunny { Color = "Mottled", EarType = "Short", Name = "Torvald" });

        GridSource.DataSource = list;
        dataGridView1.Columns["EarType"].Visible = false; //Optionally hide a column
        dataGridView1.DataSource = GridSource;

    } 
```

如果您只想显示列表类型的特定属性，您应该能够使不需要的列不可见。

从技术上讲，您实际上并不需要创建 BindingSource，但是如果我拥有它，我发现在进行更新或更改时会容易得多。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-03-26T17:03:24.430

有同样的问题......我显然有一个带有公共字段的结构。网格中没有任何内容。提供公共吸气剂，工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-11-13T12:36:20.640

我发现的另一个解决方案是使用 BindingList 集合。

```
 private void Form1_Load(object sender, EventArgs e)
{
   BindingList people= new BindingList {
    new Person {Name="John",Age=23},
    new Person {Name="Lucy",Age=16}
  };

   dataGridView1.DataSource= people;
} 
```

这对我来说可以，

# php - 将 MySQL 查询转换为 CSV 的 PHP 代码

> ID：125113
> 
> 赞同：135
> 
> 时间：2008-09-24T02:42:46.387
> 
> 标签：php, mysql, csv

请问在PHP中将MySQL查询转换为CSV的最有效方法是什么？

最好避免使用临时文件，因为这会降低可移植性（所需的目录路径和设置文件系统权限）。

CSV 还应包括最上面一行的字段名称。

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2008-09-24T02:47:44.113

```
SELECT * INTO OUTFILE "c:/mydata.csv"
FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
LINES TERMINATED BY "\n"
FROM my_table; 
```

（*这方面的文档在这里：[http](http://dev.mysql.com/doc/refman/5.0/en/select.html)* ://dev.mysql.com/doc/refman/5.0/en/select.html ）

或者：

```
$select = "SELECT * FROM table_name";

$export = mysql_query ( $select ) or die ( "Sql error : " . mysql_error( ) );

$fields = mysql_num_fields ( $export );

for ( $i = 0; $i < $fields; $i++ )
{
    $header .= mysql_field_name( $export , $i ) . "\t";
}

while( $row = mysql_fetch_row( $export ) )
{
    $line = '';
    foreach( $row as $value )
    {                                            
        if ( ( !isset( $value ) ) || ( $value == "" ) )
        {
            $value = "\t";
        }
        else
        {
            $value = str_replace( '"' , '""' , $value );
            $value = '"' . $value . '"' . "\t";
        }
        $line .= $value;
    }
    $data .= trim( $line ) . "\n";
}
$data = str_replace( "\r" , "" , $data );

if ( $data == "" )
{
    $data = "\n(0) Records Found!\n";                        
}

header("Content-type: application/octet-stream");
header("Content-Disposition: attachment; filename=your_desired_name.xls");
header("Pragma: no-cache");
header("Expires: 0");
print "$header\n$data"; 
```

* * *

## 回答 #2

> 赞同：91
> 
> 时间：2008-09-24T05:33:57.660

看看这个[问题/答案](https://stackoverflow.com/questions/81934/easy-way-to-export-a-sql-table-without-access-to-the-server-or-phpmyadmin#81951)。它比@Geoff 更简洁，并且还使用了内置的 fputcsv 函数。

```
$result = $db_con->query('SELECT * FROM `some_table`');
if (!$result) die('Couldn\'t fetch records');
$num_fields = mysql_num_fields($result);
$headers = array();
for ($i = 0; $i < $num_fields; $i++) {
    $headers[] = mysql_field_name($result , $i);
}
$fp = fopen('php://output', 'w');
if ($fp && $result) {
    header('Content-Type: text/csv');
    header('Content-Disposition: attachment; filename="export.csv"');
    header('Pragma: no-cache');
    header('Expires: 0');
    fputcsv($fp, $headers);
    while ($row = $result->fetch_array(MYSQLI_NUM)) {
        fputcsv($fp, array_values($row));
    }
    die;
} 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2008-09-24T02:46:23.743

查看有关 SELECT ... INTO OUTFILE 语法的[文档。](http://dev.mysql.com/doc/refman/5.0/en/select.html)

```
SELECT a,b,a+b INTO OUTFILE '/tmp/result.txt'
  FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
  LINES TERMINATED BY '\n'
  FROM test_table; 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2011-08-19T17:28:28.853

@jrgns 的更新（有一些细微的语法差异）解决方案。

```
$result = mysql_query('SELECT * FROM `some_table`'); 
if (!$result) die('Couldn\'t fetch records'); 
$num_fields = mysql_num_fields($result); 
$headers = array(); 
for ($i = 0; $i < $num_fields; $i++) 
{     
       $headers[] = mysql_field_name($result , $i); 
} 
$fp = fopen('php://output', 'w'); 
if ($fp && $result) 
{     
       header('Content-Type: text/csv');
       header('Content-Disposition: attachment; filename="export.csv"');
       header('Pragma: no-cache');    
       header('Expires: 0');
       fputcsv($fp, $headers); 
       while ($row = mysql_fetch_row($result)) 
       {
          fputcsv($fp, array_values($row)); 
       }
die; 
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-05-07T21:44:17.773

如果您希望将下载作为可以直接在 Excel 中打开的下载提供，这可能对您有用：（从我的一个未发布的旧项目中复制）

这些函数设置标题：

```
function setExcelContentType() {
    if(headers_sent())
        return false;

    header('Content-type: application/vnd.ms-excel');
    return true;
}

function setDownloadAsHeader($filename) {
    if(headers_sent())
        return false;

    header('Content-disposition: attachment; filename=' . $filename);
    return true;
} 
```

这个使用 mysql 结果将 CSV 发送到流

```
function csvFromResult($stream, $result, $showColumnHeaders = true) {
    if($showColumnHeaders) {
        $columnHeaders = array();
        $nfields = mysql_num_fields($result);
        for($i = 0; $i < $nfields; $i++) {
            $field = mysql_fetch_field($result, $i);
            $columnHeaders[] = $field->name;
        }
        fputcsv($stream, $columnHeaders);
    }

    $nrows = 0;
    while($row = mysql_fetch_row($result)) {
        fputcsv($stream, $row);
        $nrows++;
    }

    return $nrows;
} 
```

这个使用上述函数将 CSV 写入文件，由 $filename 给出

```
function csvFileFromResult($filename, $result, $showColumnHeaders = true) {
    $fp = fopen($filename, 'w');
    $rc = csvFromResult($fp, $result, $showColumnHeaders);
    fclose($fp);
    return $rc;
} 
```

这就是魔法发生的地方；）

```
function csvToExcelDownloadFromResult($result, $showColumnHeaders = true, $asFilename = 'data.csv') {
    setExcelContentType();
    setDownloadAsHeader($asFilename);
    return csvFileFromResult('php://output', $result, $showColumnHeaders);
} 
```

例如：

```
$result = mysql_query("SELECT foo, bar, shazbot FROM baz WHERE boo = 'foo'");
csvToExcelDownloadFromResult($result); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-24T02:46:06.177

```
// Export to CSV
if($_GET['action'] == 'export') {

  $rsSearchResults = mysql_query($sql, $db) or die(mysql_error());

  $out = '';
  $fields = mysql_list_fields('database','table',$db);
  $columns = mysql_num_fields($fields);

  // Put the name of all fields
  for ($i = 0; $i < $columns; $i++) {
    $l=mysql_field_name($fields, $i);
    $out .= '"'.$l.'",';
  }
  $out .="\n";

  // Add all values in the table
  while ($l = mysql_fetch_array($rsSearchResults)) {
    for ($i = 0; $i < $columns; $i++) {
      $out .='"'.$l["$i"].'",';
    }
    $out .="\n";
  }
  // Output to browser with appropriate mime type, you choose ;)
  header("Content-type: text/x-csv");
  //header("Content-type: text/csv");
  //header("Content-type: application/csv");
  header("Content-Disposition: attachment; filename=search_results.csv");
  echo $out;
  exit;
} 
```

# css - 圆角，这是 Mozilla 特有的吗？

> ID：125117
> 
> 赞同：1
> 
> 时间：2008-09-24T02:45:59.717
> 
> 标签：css

我正在研究一些网站是如何实现圆角的，而 CSS 有这些我以前从未真正见过的奇怪标签。

```
-moz-border-radius-topright: 5px;
-webkit-border-top-right-radius: 5px; 
-moz-border-radius-bottomright: 5px;
-webkit-border-bottom-right-radius: 5px; 
```

我用谷歌搜索，它们似乎是 Firefox 特定的标签？

**更新**

我正在查看的网站是 twitter，奇怪的是这样的网站会如何疏远他们的 IE 用户。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T02:48:11.117

`-moz-*`属性是 Gecko-only（Firefox、Mozilla、Camino），属性`-webkit-*`是 WebKit-only（Chrome、Safari、Epiphany）。供应商特定的前缀通常用于实现尚未被 W3C 标准化的 CSS 功能。

* * *

Twitter 并没有“疏远”他们的 IE 用户。只需为支持它的浏览器添加样式即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T02:48:54.437

-moz 是特定于 firefox 的，-webkit 是用于 safari、chrome 和其他一些使用该渲染引擎的浏览器。

这些是在 CSS3 中定义的属性的早期实现，因此它们将在未来不带前缀的情况下出现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T02:47:14.537

我建议从 IE 或其他浏览器浏览网站。我打赌你会得到不同的标记。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T02:48:57.917

这些适用于 Firefox（标记为 -moz-border）和 Safari（-webkit-border）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T02:49:11.503

是的，前面带有 -moz 的任何东西都只能在 Firefox 中使用。

-webkit 仅适用于基于 webkit 的浏览器，如 Safari、Chrome 或 Webkit。

有关仅使用普通 css 标签制作圆角的多种方法，请参见[此处。](http://www.google.com/search?hl=un&q=CSS+rounded+corners)

编辑：我不认为没有圆角是完全疏远的，只是 IE 的外观略有不同。

如果有人想知道，所有[-moz](http://developer.mozilla.org/En/Mozilla_CSS_Extensions)和[-webkit](http://qooxdoo.org/documentation/general/webkit_css_styles) css 样式的完整列表

# c++ - C++ 将选项传递给可执行文件

> ID：125124
> 
> 赞同：3
> 
> 时间：2008-09-24T02:47:23.910
> 
> 标签：c++, arguments

如何将选项传递给可执行文件？有没有比使选项布尔参数更简单的方法？

编辑：最后两个答案建议使用参数。我知道我可以编写这样一个可行的解决方案，但我宁愿让它们成为选项。

EDIT2：根据澄清请求，我将使用这个简单的示例：处理参数相当容易，因为它们会自动解析为数组。

```
./printfile file.txt 1000 
```

如果我想知道用户想要打印的文件的名称，我可以通过 argv[1] 访问它。

现在关于这种情况如何：

```
./printfile file.txt 1000 --nolinebreaks 
```

用户想要打印没有换行符的文件。这不是程序能够运行所必需的（因为要打印的文件名和行数），但是如果他/她愿意，用户可以选择使用。现在我可以使用：

```
./printfile file.txt 1000 true 
```

使用提示将通知用户第三个参数用于确定是否打印带有换行符的文件。然而，这似乎相当笨拙。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-24T02:51:04.853

命令行参数是要走的路。您可能需要考虑使用 Boost.ProgramOptions 来简化此任务。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T03:16:49.567

您似乎认为以“”开头的“选项”`--`和不以“”开头的“参数”之间存在一些根本区别。唯一的区别在于你如何解析它们。

看看 GNU 的`getopt()`/`getopt_long()`选项解析器可能值得您花时间。它支持使用诸如`--number-of-line-breaks 47`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T02:50:18.553

我使用两种方法传递信息：

1/ 使用命令行参数，使用特定库（如 getargs）更容易处理这些参数。

2/ 作为环境变量，使用 getenv。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T03:02:36.137

Pax 在这里有正确的想法。

如果您需要更彻底的双向通信，请使用管道打开进程并将内容发送到 stdin/listen on stdout。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T03:08:31.537

您还可以使用 Window 的 PostMessage() 函数。如果要将选项发送到的可执行文件已经在运行，这将非常方便。如果您对此技术感兴趣，我可以发布一些示例代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T02:55:52.113

关于上下文以及您正在尝试做什么的问题并不十分清楚 - 您的意思是从 C++ 程序中运行可执行文件？有几个标准 C 库函数，其名称如 execl()、execv()、execve() 等，它们将选项作为字符串或指向字符串数组的指针。还有 system() 它接受一个字符串，其中包含您在 bash 提示符下键入的任何内容、选项和所有内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T04:13:03.457

我喜欢popt库。它是 C，但在 C++ 中也可以正常工作。

不过，它似乎不是跨平台的。当我不得不为某些 Linux 软件的 Windows 端口破解我自己的 API 兼容版本时，我发现了这一点。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2008-09-24T03:03:23.437

您可以将选项放在 .ini 文件中，并使用[GetPrivateProfileXXX API](http://msdn.microsoft.com/en-us/library/ms724353(VS.85).aspx)创建一个类，该类可以从 .ini 中读取您正在寻找的程序选项的类型。

您还可以为您的应用程序创建一个交互式外壳，以实时更改某些设置。

编辑：从您的编辑中，您不能只解析每个选项以查找与该选项关联的“可选”的特殊关键字吗？

# windows-mobile - 适用于 Windows Mobile 表单应用程序的 WYSIWYG HTML 编辑器

> ID：125143
> 
> 赞同：2
> 
> 时间：2008-09-24T02:51:29.080
> 
> 标签：windows-mobile, compact-framework, wysiwyg

我正在使用 .NET CF 3.5 为 Windows Mobile 开发表单应用程序（不是 Web）。我需要一个 HTML 编辑器控件。我正在寻找类似于简单 FCKEditor 的东西，但要在表单应用程序 (EXE) 中使用。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-12-31T14:44:22.400

Pocket IE（Windows Mobile 附带的网络浏览器）与 Netscape 2 一样强大...没有 Javascript 支持。因此，使用基于浏览器的 HTML 编辑器将无法使用它。Opera 具有桌面版本的大部分功能（包括 DOM 和 Javascript 支持），但我不确定它是否在 Windows Mobile 上具有嵌入功能。这也意味着您的应用程序需要一个 Opera 副本才能工作，并且它是商业软件。

我建议您：稍微缩减您的计划并忘记所见即所得的 HTML 编辑。这是一个小屏幕的小设备——人们真的有必要在上面编辑网页内容吗？

或者：您从头开始编写自己的小型编辑器作为 Windows.Forms 控件。如果您只想支持人们在这些编辑器框中所做的字体、大小和颜色更改（占 90%），那并不会太难，但对于有经验的 .NET 表单开发人员来说，这仍然可能需要几周的时间.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T03:39:55.877

我不确定紧凑框架是否支持它，但您可以尝试通过反射在 WebBrowser 控件上设置设计模式并将其包装成一个简单的 WYSIWYG 编辑器..认为这是代码..

```
webBrowser1.Document.GetType().GetProperty("designmode").SetValue(webBrowser1.Document, true, null); 
```

* * *

## 回答 #3

> 赞同：-9
> 
> 时间：2008-10-17T21:52:09.580

我能建议的只有[Notepad++](http://notepad-plus.sourceforge.net/uk/site.htm)。我将它用于 Web 内容，但我相信它支持 30 多种语言，而且它是免费的，因此您可以在那里找到所需的内容。

# ruby-on-rails - 使用 ActiveRecord 将记录存储在数据库中的长时间运行的 ruby 进程

> ID：125146
> 
> 赞同：2
> 
> 时间：2008-09-24T02:52:05.803
> 
> 标签：ruby-on-rails, ruby

我正在尝试使用 Ruby on Rails 编写应用程序，并且正在尝试实现以下目标：

> 该应用程序需要接收来自特定端口的 UDP 消息（可能每秒 1 个或更多）并将它们存储在数据库中，以便我的 Rails 应用程序的其余部分可以访问它。

我正在考虑编写一个单独的守护程序来接收这些消息并在我的 rails 应用程序上使用一个 ruby​​ 脚本，该脚本将使用正确的模型将消息存储在数据库中。这种方法的问题是 ruby​​ 脚本会经常运行。如果我可以有一个长时间运行的 ruby​​ 进程，它可以不断接收 UDP 消息并将它们存储在数据库中，那么性能会更好。

这是正确的方法吗？Rails 框架中有什么可以帮助解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T03:02:23.017

您绝对不想为每个传入请求加载 Rails 堆栈——这太慢了；您将需要使用较低级别的东西来处理传入的连接。您可能会查看 Webrick 的内部结构，以查看用 ruby​​ 编码的简单服务器守护程序——或者，如果您想要更高性能的东西，请查看 Mongrel 或 Thin。

一般来说，整个 Rails 堆栈在这里不会对您有太大帮助——其中大部分是面向 Web 应用程序的，而不是直接从网络上保存东西。

Rails 中对您帮助最大的部分可能是 ActiveRecord——您很有可能希望使用它来将您的模型数据存储在数据库中。事实上，您应该能够使用`include`您的实际 Rails 模型并在您的 UDP 监控过程中使用它们。查看[ActiveRecord 文档](http://api.rubyonrails.org/classes/ActiveRecord/Base.html)以获取连接到 Rails 项目之外的数据库的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-31T05:10:07.920

我有一个应用程序可以执行与此类似的操作，即在端口上接收大量消息并将它们持久化到数据库中。我们在改进数据库设计时解决了许多问题，包括即使数据库由于某种原因不可用，我们也不能丢失消息这一事实。

出于性能原因并确保我们不会丢失消息，我们进行了两个阶段的过程。我们编写了一个小型处理程序来侦听消息，然后使用[Apache Active-MQ](http://activemq.apache.org/)将它们持久化到消息队列中。然后，我们在单独的 Rails 应用程序中使用[ActiveMessaging](http://code.google.com/p/activemessaging/wiki/ActiveMessaging)插件来使用队列中的消息并将它们持久化到数据库中。此方法可以轻松扩展侦听器，并将导致更高的消息传递吞吐量。

如果你要走这条路，那么你可能想看看 Active-MQ 的[Fuse 实现](http://fusesource.com/products/enterprise-activemq/)，它通常比 Apache 版本更进一步。

# sql-server - 1000 个地点有一个桌面应用程序，需要将他们的数据库的差异上传到中央商店

> ID：125153
> 
> 赞同：0
> 
> 时间：2008-09-24T02:54:59.447
> 
> 标签：sql-server, backup

实际上有数千个应用程序正在运行的位置（.net 桌面应用程序），并且要求将其数据库的更新（与上次上传的差异）发送到将存储所有位置数据的中央服务器.

在提出解决方案时我有哪些选择？

一个想法是生成一个包含自上次同步以来的所有行的 XML 文件，并将其上传到文件服务器，然后将其导入主数据库。

注意：更改的数据将是最小的，因为此过程将每隔几个小时运行一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T03:04:45.383

我可能会努力避免编写这段代码。这听起来像是数据库复制旨在解决的问题。这将取决于您在问题中未传达的标准，例如正在使用的数据库引擎、可用的传输、不同的位置更新是否会相互重叠、与键和唯一索引相关的数据库设计等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T03:08:27.323

由于有 1000 个位置，我建议每个桌面应用程序都向 Web 服务器发送一个 xml 字符串。Web 服务器应用程序可以在接收到字符串后更新数据库。

如果您在双方都使用 .NET，则可以使用框架的 Web 服务类来实现这一点。

# c# - WebConfig.ConnectionString 中的相对路径引用

> ID：125157
> 
> 赞同：14
> 
> 时间：2008-09-24T02:56:04.357
> 
> 标签：c#, sql-server

是否可以在 web.config 中的 connectionstring、attachDbFileName 属性中指定相对路径引用？

例如，在我的数据库位于 App_data 文件夹中，我可以轻松地将 AttachDBFilename 指定为|DataDirectory|\mydb.mdf 和|Datadirectory| 将自动解析到正确的路径。

现在，假设 web.config 文件位于 A 文件夹中，但数据库位于 B\App_data 文件夹中，其中 A 和 B 文件夹位于同一文件夹中。反正有没有使用相对路径引用来解析到正确的路径？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2010-03-26T09:25:48.310

我在以下场景中遇到了同样的问题：我想使用与集成测试中的应用程序相同的数据库。

我采用了以下解决方法：

在我的测试项目的 App.config 中，我有：

```
<appSettings>
  <add key="DataDirectory" value="..\..\..\BookShop\App_Data\"/>
</appSettings> 
```

在测试设置中，我执行以下代码：

```
 var dataDirectory = ConfigurationManager.AppSettings["DataDirectory"];  
   var absoluteDataDirectory = Path.GetFullPath(dataDirectory);  
   AppDomain.CurrentDomain.SetData("DataDirectory", absoluteDataDirectory); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-09-24T03:19:57.967

这取决于你的 '|DataDirectory|' 位于。如果 '|DataDirectory|' 的解析值 位于文件夹 A 中（web.config 所在的位置），然后否 - 您不能指定不是“|DataDirectory|”的已解析值的子文件夹的相对路径。

你*可以*做的是设置 '|DataDirectory|' 的值 **通过调用AppDomain.SetData**方法，在任何你想要的地方。

从 MSDN 在线文档：

> 使用 DataDirectory 时，在目录结构中生成的文件路径不能高于替换字符串指向的目录。例如，如果完全展开的 DataDirectory 是 C:\AppDirectory\app_data，则上面显示的示例连接字符串有效，因为它位于 c:\AppDirectory 之下。但是，尝试将 DataDirectory 指定为 |DataDirectory|..\data 将导致错误，因为 \data 不是 \AppDirectory 的子目录。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-04-11T21:29:20.027

将以下属性添加到测试方法：

```
[DeploymentItem("..\\TestSolutionDir\\TestProjedtDir\\TestDataFolder\\TestAutomationSpreadsheet.xlsx")]
[DataSource("System.Data.Odbc", "Dsn=Excel Files;dbq=|DataDirectory|\\TestAutomationSpreadsheet.xlsx", "SpreadsheetTabName$", DataAccessMethod.Sequential)] 
```

该`|DataDirctory|`变量由系统在运行测试时定义。DeploymentItem 将电子表格复制到那里。您指向电子表格和数据来自电子表格中的选项卡。右键单击选项卡以将其重命名为易于记忆的名称。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T03:24:08.533

在 IIS 中，您还可以创建一个虚拟目录，指向保存真实数据库的位置。然后您的连接字符串仅引用虚拟目录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-13T09:29:03.983

**网页配置**

```
 <appSettings>
    <add key="FilePath" value="App_Data\SavedFiles\"/>
  </appSettings> 
```

**路径.cs**

```
string filePath = AppDomain.CurrentDomain.BaseDirectory + (ConfigurationManager.AppSettings["FilePath"]); 
```

为我工作..!!

# regex - 在 Perl 中将正则表达式替换作为变量传递

> ID：125171
> 
> 赞同：23
> 
> 时间：2008-09-24T03:00:42.443
> 
> 标签：regex, perl

我需要将正则表达式替换作为变量传递：

```
sub proc {
    my $pattern = shift;
    my $txt = "foo baz";

    $txt =~ $pattern;
}

my $pattern = 's/foo/bar/';
proc($pattern); 
```

这当然行不通。我尝试评估替换：

```
eval("$txt =~ $pattern;"); 
```

但这也没有用。我在这里错过了什么非常明显的事情？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2008-09-24T03:30:35.273

> 我需要将正则表达式替换作为变量传递

你？为什么不传递代码参考？例子：

```
sub modify
{
  my($text, $code) = @_;
  $code->($text);
  return $text;
}

my $new_text = modify('foo baz', sub { $_[0] =~ s/foo/bar/ }); 
```

通常，当您想将“某事做某事”传递给子例程（在您的问题的情况下为“正则表达式替换”）时，答案是传递对一段代码的引用。 [Higher Order Perl](http://hop.perl.plover.com/)是一本关于该主题的好书。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-09-24T03:12:32.617

*好吧，您可以使用qr//*运算符预编译正则表达式。但是您不能传递运算符 (s///)。

```
$pattern = qr/foo/;

print "match!\n" if $text =~ $pattern; 
```

但是，如果您必须传递替换运算符，则只能传递代码或字符串：

```
proc('$text =~ s/foo/bar');

sub proc {
   my $code = shift;

   ...

   eval $code;
} 
```

或者，代码：

```
proc(sub {my $text = shift;  $text =~ s/foo/bar});

sub proc {
   my $code = shift;

   ...

   $code->("some text");
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-24T03:21:28.010

```
sub proc {
    my($match, $subst) = @_;
    my $txt = "foo baz";
    $txt =~ s/$match/$subst/;
    print "$txt\n";
}

my $matcher = qr/foo/;
my $sub_str = "bar";

proc($matcher, $sub_str); 
```

这相当直接地回答了你的问题。您可以做更多 - 但是当我使用 qr// 术语而不是 $sub_str 作为简单文字时，扩展的正则表达式被替换。

我最近需要为具有一些特殊（方言）SQL 类型的语句创建一个解析器（测试解析器），识别这样的行，将其拆分为三个类型名称：

```
input: datetime year to second,decimal(16,6), integer 
```

我用来演示的脚本使用了引用的正则表达式。

```
#!/bin/perl -w
use strict;
while (<>)
{
    chomp;
    print "Read: <$_>\n";
    my($r1) = qr%^input\s*:\s*%i;
    if ($_ =~ $r1)
    {
        print "Found input:\n";
        s%$r1%%;
        print "Residue: <$_>\n";
        my($r3) = qr%(?:year|month|day|hour|minute|second|fraction(?:\([1-5]\))?)%;
        my($r2) = qr%
                        (?:\s*,?\s*)?   # Commas and spaces
                        (
                            (?:money|numeric|decimal)(?:\(\d+(?:,\d+)?\))?   |
                            int(?:eger)?  |
                            smallint      |
                            datetime\s+$r3\s+to\s+$r3
                        )
                    %ix;
        while ($_ =~ m/$r2/)
        {
            print "Got type: <$1>\n";
            s/$r2//;
        }
        print "Residue 2: <$_>\n";
    }
    else
    {
        print "No match:\n";
    }
    print "Next?\n";
} 
```

我们可以争论 $r1 等名称的使用。但它完成了工作......它不是，也不是生产代码。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-24T16:51:10.543

`s///`不是正则表达式。因此，您不能将其作为正则表达式传递。

我不喜欢`eval`这个。它非常脆弱，有很多边框。

我认为最好采用类似于 JavaScript 采用的方法：传递正则表达式（在 Perl 中，即`qr//`）和代码引用以进行替换。例如，传递参数以获得相同的效果

```
s/(\w+)/\u\L$1/g; 
```

你可以打电话

```
replace($string, qr/(\w+)/, sub { "\u\L$1" }, 'g'); 
```

请注意，“g”修饰符实际上并不是正则表达式的标志（我认为将其附加到正则表达式是 JavaScript 中的设计错误），因此我选择将它传递给第三个参数。

一旦决定了 API，接下来就可以进行实施了：

```
sub replace {
    my($string, $find, $replace, $global) = @_;
    unless($global) {
        $string =~ s($find){ $replace->() }e;
    } else {
        $string =~ s($find){ $replace->() }ge;
    }
    return $string;
} 
```

让我们尝试一下：

```
print replace('content-TYPE', qr/(\w+)/, sub { "\u\L$1" }, 'g'); 
```

结果：

> 内容类型

这对我来说看起来不错。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-24T03:52:22.600

```
eval "$txt =~ $pattern"; 
```

这变成

```
eval "\"foo baz\" =~ s/foo/bar/" 
```

并且替换不适用于文字字符串。

这会起作用：

```
eval "\$txt =~ $pattern" 
```

但这不是很令人愉快。*eval*几乎从来都不是正确的解决方案。

[zigdon 的解决方案](https://stackoverflow.com/questions/125171/passing-a-regex-substitution-as-a-variable-in-perl/125212#125212)可以做任何事情，如果替换字符串是静态的， [Jonathan 的解决方案](https://stackoverflow.com/questions/125171/passing-a-regex-substitution-as-a-variable-in-perl/125240#125240)非常适合。如果您想要比第一个更结构化且比第二个更灵活的东西，我建议您使用混合：

```
sub proc {
    my $pattern = shift;
    my $code = shift;
    my $txt = "foo baz";
    $txt =~ s/$pattern/$code->()/e;
    print "$txt\n";
}

my $pattern = qr/foo/;
proc($pattern, sub { "bar" });   # ==> bar baz
proc($pattern, sub { "\U$&" });  # ==> FOO baz 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-24T10:50:15.093

也许你可能会重新考虑你的方法。

您想将正则表达式替换传递给函数，可能是因为该函数将从其他来源（从文件、套接字等读取）派生要操作的文本。但是您将正则表达式与*正则表达式替换*混为一谈。

在表达式 中`s/foo/bar/`，您实际上有一个正则表达式 ("/foo/") 和一个替换 ("bar") 应该替换表达式匹配的内容。在您迄今为止尝试过的方法中，您在尝试使用 时遇到了问题`eval`，主要是因为表达式中的特殊字符可能会在评估过程中干扰`eval`或被插值（即，吞噬）。

因此，请尝试向您的例程传递两个参数：表达式和替换：

```
sub apply_regex {
    my $regex = shift;
    my $subst = shift || ''; # No subst string will mean matches are "deleted"

    # Some setup and processing happens...

    # Time to make use of the regex that was passed in:
    while (defined($_ = <$some_filehandle>)) {
        s/$regex/$subst/g; # You can decide if you want to use /g etc.
    }

    # The rest of the processing...
} 
```

这种方法还有一个额外的好处：如果您的正则表达式模式*中没有*任何特殊字符，您可以直接将其传入：

```
apply_regex('foo', 'bar'); 
```

或者，如果是这样，您可以使用`qr//`quoting-operator 创建一个正则表达式对象并将其作为第一个参数传递：

```
apply_regex(qr{(foo|bar)}, 'baz');
apply_regex(qr/[ab]+/, '(one or more of "a" or "b")');
apply_regex(qr|\d+|); # Delete any sequences of digits 
```

最重要的是，您真的不需要`eval`或使用代码引用/闭包来完成此任务。这只会增加复杂性，可能会使调试变得比需要的更难。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-21T19:08:25.167

我有一个非常简单的批量文件重命名脚本，它使用了这个技巧：

```
#!/opt/local/bin/perl
sub oops { die "Usage : sednames s/old/new [files ..]\n"; }
oops if ($#ARGV < 0);

$regex = eval 'sub { $_ = $_[0]; ' . shift(@ARGV) . '; return $_; }';
sub regex_rename { foreach (<$_[0]>) {
    rename("$_", &$regex($_));
} }

if ($#ARGV < 0) {  regex_rename("*");  }
else {  regex_rename(@ARGV);  } 
```

任何修改`$_`like的 Perl 命令`s/old/new`都可以用来修改文件。

我决定使用`eval`这样正则表达式只需要编译一次。有一些不稳定，`eval`这`$_`使我无法简单地使用：

```
eval 'sub { ' . shift(@ARGV) . ' }'; 
```

虽然这`&$regex`确实会修改`$_`，但需要在调用之前`"$_"` 进行评估。是的，就像其他人所说的那样，它非常脆弱。`$_``rename``eval`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-11T22:07:20.193

我找到了一种可能更好的方法：

```
sub proc {
    my ($pattern, $replacement) = @_;
    my $txt = "foo baz";

    $txt =~ s/$pattern/$replacement/g;  # This substitution is global.
}

my $pattern = qr/foo/;  # qr means the regex is pre-compiled.
my $replacement = 'bar';

proc($pattern, $replacement); 
```

如果替换的标志必须是可变的，你可以使用这个：

```
sub proc {
    my ($pattern, $replacement, $flags) = @_;
    my $txt = "foo baz";

    eval('$txt =~ s/$pattern/$replacement/' . $flags);
}

proc(qr/foo/, 'bar', 'g'); 
```

请注意，您不需要`/`在替换字符串中转义。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2010-10-28T20:15:53.557

你是对的 - 你非常接近：

```
eval('$txt =~ ' . "$pattern;"); 
```

# javascript - 什么是支持 Javascript 的屏幕抓取的好工具？

> ID：125177
> 
> 赞同：29
> 
> 时间：2008-09-24T03:01:46.187
> 
> 标签：javascript, screen-scraping

是否有一个很好的测试套件或工具集可以自动化网站导航（支持 Javascript）并从页面收集 HTML？

当然，我可以用 BeautifulSoup 直接抓取 HTML。但这对需要 Javascript 的网站没有好处。:)

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2008-09-24T03:27:21.320

您可以使用[Selenium](http://selenium.openqa.org/)或[Watir](http://watir.com/)来驱动真正的浏览器。

还有一些基于 JavaScript 的无头浏览器：

*   [PhantomJS](http://www.phantomjs.org/)是一个无头 Webkit 浏览器。
    *   [pjscrape](http://nrabinowitz.github.com/pjscrape/)是一个基于 PhantomJS 和 jQuery 的抓取框架。
    *   [CasperJS](http://n1k0.github.com/casperjs/)是基于 PhantomJS 的导航脚本和测试实用程序，如果您需要做的不仅仅是指向要抓取的 URL。
*   [Node.js](http://nodejs.org)的[僵尸](http://zombie.labnotes.org/)

就我个人而言，我最熟悉 Selenium，它支持以多种语言编写自动化脚本，并且拥有更成熟的工具，例如优秀的 Firefox 的[Selenium IDE](http://selenium-ide.openqa.org/)扩展，可用于编写和运行测试用例，以及可以将测试脚本导出为多种语言。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-07-10T02:52:39.297

使用[HtmlUnit](http://htmlunit.sourceforge.net/)也是一种可能。

> HtmlUnit 是“Java 程序的无 GUI 浏览器”。它对 HTML 文档进行建模并提供一个 API，允许您调用页面、填写表单、单击链接等……就像您在“普通”浏览器中所做的一样。
> 
> 它具有相当好的 JavaScript 支持（不断改进），甚至能够使用非常复杂的 AJAX 库，根据您要使用的配置模拟 Firefox 或 Internet Explorer。
> 
> 它通常用于测试目的或从网站检索信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-12-30T08:38:51.337

Selenium 现在包装了 htmlunit，因此您不再需要启动浏览器。新的 WebDriver api 也很容易使用。[第一个例子使用 htmlunit 驱动](http://code.google.com/p/selenium/wiki/GettingStarted)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-24T03:19:24.380

编写一个适用于任何任意站点的解决方案将非常困难。每个导航菜单实现都可以是非常独特的。我在爬虫方面做了很多工作，如果你知道你想要定位的网站，这就是我的处理方法。

通常，如果您分析导航菜单中使用的特定 javascript，使用正则表达式来提取用于构建导航菜单的整个变量集是相当容易的。我从未使用过 Beautiful Soup，但从您的描述看来，它可能只适用于 HTML 元素，而不能在脚本标签内工作。

如果您仍然遇到问题，或者需要模拟一些表单 POST 或 ajax，请获取 Firefox 并安装[LiveHttpHeaders](http://livehttpheaders.mozdev.org/)插件。该插件将允许您手动浏览网站并捕获正在导航的 URL 以及在您手动浏览期间传递的任何 cookie。这就是您需要您的爬虫机器人发送请求以从目标网络服务器获得有效响应的内容。这也将捕获正在进行的任何 ajax 调用，并且在许多情况下，必须在您的爬虫中实现相同的 ajax 调用才能获得所需的响应。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-10-27T23:33:06.433

[Mozenda](http://www.mozenda.com/)也是一个很好的工具。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2011-12-17T03:06:53.283

[你可以试试Scrape.it](http://scrape.it)的开源屏幕刮板

[更新：截至 2013 年 4 月 4 日，Scrape.it Screen Scraper 在github](https://github.com/jjk3/scrape-it-screen-scraper)上是开源的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T03:03:51.330

请记住，javascript 的奇思妙想会扰乱浏览器的页面内部 DOM 模型，并且对原始 HTML 没有任何作用。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-24T03:27:50.383

我一直在为此使用 Selenium，它发现它效果很好。Selenium 在浏览器中运行，可与 Firefox、Webkit 和 IE 一起使用。 [http://selenium.openqa.org/](http://selenium.openqa.org/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-10-05T14:02:23.463

@insin Watir 不仅仅是 IE。

[https://stackoverflow.com/questions/81566#83387](https://stackoverflow.com/questions/81566#83387)

# pdf - Postscript 有表格的概念吗？

> ID：125188
> 
> 赞同：2
> 
> 时间：2008-09-24T03:03:52.983
> 
> 标签：pdf, postscript

我想要实现的是确定我正在解析的 Postscript 是否包含驻留在表（框）中的任何元素。

我问它是否有内置的方式来在页面上布置表格数据。我的猜测是 postscript 没有表格的概念，因为我在规范中的任何地方都找不到它。

我需要解决的问题是，我需要找到一种方法来知道某些后记是否位于表格内。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T03:28:40.067

听起来您正在尝试绘制某些东西并测试是否有任何部分在某个指定的框中绘制。您可以为要测试的东西创建一个路径（只是不要描边或填充它），并为框创建另一个路径（例如表格单元格）。将这两条路径留在堆栈上，并使用 inufill、inustroke 等运算符之一。

如果您碰巧有 Postscript Language Reference 第 3 版，那么这些好东西会列在第 3 页的“Insideness-Testing Operators”下。520，其后按字母顺序排列的部分有详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T03:18:03.963

简短的回答是否定的。它是一种用于描述将墨水放在页面上的位置的低级语言，除了连接放在堆栈上的 x、y 点的线、弧和贝塞尔曲线之外，没有组织它的概念。

就是说 - 我已经手工编写了后记，创建变量或 x 和 y 值的数组以用于对齐点会很聪明。数组在渲染内容和绘制边界线的 for 循环中特别有用。当心栅栏错误！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-08-12T02:47:28.040

不，您必须自己对表格进行编码。

很多年前我做过一次。在厌倦了 TeX 之后，我用 PostScript 写了一个解释器来做类似的事情。虽然从来没有发现它有多大用处。

# php - 在 Drupal 的 XML-RPC 和 BlogAPI 实现中我应该注意什么怪癖？

> ID：125190
> 
> 赞同：1
> 
> 时间：2008-09-24T03:04:24.337
> 
> 标签：php, drupal, file-upload, xml-rpc, blogs

我正在开始一个项目，该项目将访问站点`Drupal`以通过. 这包括文件上传，因为该项目是为了让人们能够以最少的麻烦将图片批量上传到网站。`XML-RPC``BlogAPI``Drupal``Drupal`

我想知道是否有任何需要注意的警告。有没有人有过定位的经验`Drupal's XML-RPC implementation`，或者执行任何`blogging APIs`由其支持的`BlogAPI module`？你会给其他走同样道路的人什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-26T00:38:37.167

虽然 XML-RPC 工具非常稳定且运行良好，但 BlogAPI 模块存在各种问题，尤其是在发现方面，这使得将它用于除普通博客之外的任何事情都很痛苦。目前，在生成的真正简单的发现文档中没有使用 blogIds（其中只有一个用于站点）或在 BlogAPI 中实现的博客 API。

哪个博客接收帖子由用户凭据决定，只要只有一种节点类型可通过 BlogAPI 访问，它就可以正常工作，但是当您尝试通过模块获得两种或更多节点类型时，事情往往会分崩离析。

查看 Drupal 的 HEAD on CVS 中 BlogAPI 的状态，我们可能最早要到 8.x 才能看到解决方案。然而，有几个人致力于将 BlogAPI 重新开发为第三方模块，可能会在以后合并回 Drupal 核心。如果您想使用著名的博客 API，最好参与他们的工作。但是，如果是别的东西，通过 hook_xmlrpc() 提供的 XML-RPC 工具在让您提供自己的 XML-RPC 接口方面做得很好。

# windows-vista - 重新安装/取消撤销数字证书

> ID：125191
> 
> 赞同：1
> 
> 时间：2008-09-24T03:04:24.870
> 
> 标签：windows-vista, digital-certificate

所以我在 Vista 中有一个问题，我无法以管理员身份运行某些应用程序（嗯，整个 MS 套件、Office、Visual Studio 等）。

从问题的外观来看，它是由数字证书引起的，并且它已被“撤销”。

所以现在我有一个问题，我如何取消撤销数字证书？或者，我从一位很好的同事那里得到了一份数字证书的副本。我已经尝试右键单击-> 安装证书，但它似乎没有改变任何东西，当我尝试为 Visual Studio/Office 安装证书时，我也无法弄清楚如何选择它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T15:12:12.503

如果微软的代码签名证书被吊销，我会感到非常惊讶。

我将首先检查您系统的日期和时间，以确保 Windows 不会认为证书尚未有效或已过期。然后我会检查您是否仍然拥有 Microsoft 根证书颁发机构根证书。

**更新 2013-05-23**：微软实际上已经发布了一些数字签名没有正确时间戳的组件，这意味着证书过期后它们将无法正确安装。有关详细信息，请参阅[Microsoft 安全公告 2749655 - 影响已签名 Microsoft 二进制文件的兼容性问题](http://technet.microsoft.com/en-US/security/advisory/2749655)。

# c++ - STL之类的容器typedef快捷方式？

> ID：125192
> 
> 赞同：1
> 
> 时间：2008-09-24T03:04:26.973
> 
> 标签：c++, stl

STL 容器的一个常见模式是：

```
map<Key, Value> map;
for(map<Key, Value>::iterator iter = map.begin(); iter != map.end(); ++iter)
{
  ...
} 
```

因此，为了避免编写模板参数的声明，我们可以在某处这样做：

```
typedef map<Key, Value> TNiceNameForAMap; 
```

但是，如果此映射仅用于单个函数或单个迭代，则这是一个令人讨厌的开销。

这个typedef有什么办法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-24T03:07:19.057

不确定您所说的“开销”是什么意思。如果它简化了您编写代码的方式，请使用它，否则请坚持使用速记。

如果它仅在受限范围内使用，请将 typedef 放在同一范围内。然后它就不需要发布、记录或出现在任何 UML 图上。例如（我并不认为这是在其他方面最好的代码）：

```
int totalSize() {
    typedef std::map<Key, Value> DeDuplicator;
    DeDuplicator everything;

    // Run around the universe finding everything. If we encounter a key
    // more than once it's only added once.

    // now compute the total
    int total = 0;
    for(DeDuplicator::iterator i = everything.begin(); i <= everything.end(); ++i) {
        total += i->second.size(); // yeah, yeah, overflow. Whatever.
    }
    return total;
} 
```

结合 Ferruccio 的建议（如果您正在使用 boost），循环变为：

```
BOOST_FOREACH(DeDuplicator::pair p, everything) {
    total += p.second.size();
} 
```

并结合 bk1e 的建议（如果您使用 C++0x 或具有其中的功能），并假设 BOOST_FOREACH 以我认为应该基于它通常可以处理兼容类型的隐式转换的方式与 auto 交互：

```
std::map<Key, Value> everything;
// snipped code to run around...
int total = 0;
BOOST_FOREACH(auto p, everything) {
    total += p.second.size();
} 
```

不错。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-09-24T03:13:41.837

您可以使用[Boost.Foreach](http://www.boost.org/doc/libs/1_36_0/doc/html/foreach.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T03:39:50.713

C++ 标准的未来版本（称为[C++0x](http://en.wikipedia.org/wiki/C%2B%2B0x)）将引入[关键字的](http://en.wikipedia.org/wiki/C%2B%2B0x#Type_determination)[新用途`auto`](http://en.wikipedia.org/wiki/C%2B%2B0x#Type_determination)，允许您编写如下内容：

```
map<Key, Value> map;
for(auto iter = map.begin(); iter != map.end(); ++iter)
{
  ...
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-24T03:14:05.360

我个人认为**MYMAP::iterator**比**map<int,string>::iterator**甚至**std::map<int, std::string>::iterator**更具可读性，所以我总是使用 typedef。唯一的开销是一行代码。

编译代码后，可执行文件的大小或速度将没有差异。这只是关于可读性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T03:58:22.383

如果 typedef 对于单个函数来说是本地的，它甚至不需要是一个*好听的*名字。使用 X 或 MAP，就像在模板中一样。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T04:59:58.943

C++0x 还将提供基于范围的 for 循环，这类似于其他语言中的迭代 for 循环。

不幸的是，GCC 还没有实现基于范围的 for（但*确实*实现了 auto）。

编辑：同时，还考虑对迭代器进行类型定义。它不能绕过一次性使用的 typedef（除非你把它放在头文件中，这始终是一个选项），但它使生成的代码缩短了一个 ::iterator。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T07:54:10.023

在过去的几年里，我真的试图摆脱使用手动编写的循环而不是使用 STL 算法。您上面的代码可以更改为：

```
struct DoLoopBody {
  template <typename ValueType>
  inline void operator()(ValueType v) const {
    // ...
  }
};

std::for_each (map.begin(), map.end(), DoLoopBody ()); 
```

不幸的是，DoLoopBody 类不能是本地类，这通常被强调为一个缺点。但是，我认为这是一个优势，因为现在可以单独对循环体进行单元测试。

# python - 从python中的MS word文件中提取文本

> ID：125222
> 
> 赞同：28
> 
> 时间：2008-09-24T03:15:13.627
> 
> 标签：python, linux, ms-word

为了在 python 中处理 MS word 文件，有 python win32 扩展，可以在 windows 中使用。我如何在linux中做同样的事情？有图书馆吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-12-30T12:17:09.493

使用本**机 Python docx 模块**。以下是如何从文档中提取所有文本：

```
document = docx.Document(filename)
docText = '\n\n'.join(
    paragraph.text for paragraph in document.paragraphs
)
print(docText) 
```

请参阅[Python DocX 站点](https://python-docx.readthedocs.org/en/latest/)

还可以查看提取表格等的[Textract 。](http://textract.readthedocs.org/en/latest/)

使用正则表达式解析 XML 会调用 cthulu。不要这样做！

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2008-09-24T04:13:03.270

您可以对[antiword](http://en.wikipedia.org/wiki/Antiword)进行子流程调用。Antiword 是一个 linux 命令行实用程序，用于从 word doc 中转储文本。适用于简单文档（显然它会丢失格式）。它可以通过 apt 获得，并且可能以 RPM 的形式提供，或者您可以自己编译。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-12-28T03:39:54.190

[本杰明](https://stackoverflow.com/users/209753/benjamin)的答案是一个很好的答案。我刚刚巩固了...

```
import zipfile, re

docx = zipfile.ZipFile('/path/to/file/mydocument.docx')
content = docx.read('word/document.xml').decode('utf-8')
cleaned = re.sub('<(.|\n)*?>','',content)
print(cleaned) 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-24T03:23:42.873

OpenOffice.org 可以使用 Python 编写脚本：[请参见此处](http://wiki.services.openoffice.org/wiki/Python)。

由于 OOo 可以完美地加载大多数 MS Word 文件，我认为这是您最好的选择。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-01-01T01:14:38.260

我知道这是一个老问题，但我最近试图找到一种从 MS Word 文件中提取文本的方法，到目前为止我发现的最佳解决方案是使用 wvLib：

[http://wvware.sourceforge.net/](http://wvware.sourceforge.net/)

安装库后，在 Python 中使用它非常简单：

```
import commands

exe = 'wvText ' + word_file + ' ' + output_txt_file
out = commands.getoutput(exe)
exe = 'cat ' + output_txt_file
out = commands.getoutput(exe) 
```

就是这样。几乎，我们正在做的是使用 commands.getouput 函数来运行几个 shell 脚本，即 wvText（从 Word 文档中提取文本，并使用 cat 读取文件输出）。之后，Word 文档中的整个文本将在 out 变量中，可供使用。

希望这将有助于将来遇到类似问题的任何人。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-24T03:17:26.960

看看[doc 格式是如何工作的](https://stackoverflow.com/questions/124869/how-does-the-doc-format-work "doc 格式的工作原理")，并[在 linux 中使用 PHP 创建 word 文档](https://stackoverflow.com/questions/124959/create-word-document-using-php-in-lunux "在linux中使用php创建word文档")。前者特别有用。[Abiword](http://www.abisource.com/ "abiword")是我推荐的工具。但是有一些[限制](http://www.abisource.com/wiki/Microsoft_Word_documents "Abiword 限制")：

> 但是，如果文档包含复杂的表格、文本框、嵌入的电子表格等，那么它可能无法按预期工作。开发好的 MS Word 过滤器是一个非常困难的过程，所以请耐心等待我们努力让 Word 文档正确打开。如果您有一个无法加载的 Word 文档，请打开一个 Bug 并包含该文档，以便我们改进导入器。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-08-11T05:38:51.560

（注意：我也在[这个问题](https://stackoverflow.com/questions/1184747/rtf-doc-docx-text-extraction-in-program-written-in-c-qt)上发布了这个，但在这里似乎相关，所以请原谅转发。）

现在，这很丑陋而且很hacky，但它似乎对我来说适用于基本的文本提取。显然，要在 Qt 程序中使用它，您必须为其生成一个进程等，但我一起破解的命令行是：

```
unzip -p file.docx | grep '<w:t' | sed 's/<[^<]*>//g' | grep -v '^[[:space:]]*$' 
```

所以那是：

*unzip -p file.docx* : -p == "解压到标准输出"

*grep '<w:t'*：仅抓取包含 '<w:t' 的行（据我所知，<w:t> 是“文本”的 Word 2007 XML 元素）

*sed 's/<[^<]* >//g'*：删除标签内的所有内容

*grep -v '^[[:space:]]* $'*: 删除空行

可能有一种更有效的方法可以做到这一点，但它似乎对我测试过的少数文档有用。

据我所知，unzip、grep 和 sed 都有适用于 Windows 和任何 Unix 的端口，所以它应该是合理的跨平台的。尽管有点丑陋的黑客;）

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-11-12T16:18:16.963

如果您打算使用纯 python 模块而不调用子进程，则可以使用 zipfile python modude。

```
content = ""
# Load DocX into zipfile
docx = zipfile.ZipFile('/home/whateverdocument.docx')
# Unpack zipfile
unpacked = docx.infolist()
# Find the /word/document.xml file in the package and assign it to variable
for item in unpacked:
    if item.orig_filename == 'word/document.xml':
        content = docx.read(item.orig_filename)

    else:
        pass 
```

但是，您的内容字符串需要清理，这样做的一种方法是：

```
# Clean the content string from xml tags for better search
fullyclean = []
halfclean = content.split('<')
for item in halfclean:
    if '>' in item:
        bad_good = item.split('>')
        if bad_good[-1] != '':
            fullyclean.append(bad_good[-1])
        else:
            pass
    else:
        pass

# Assemble a new string with all pure content
content = " ".join(fullyclean) 
```

但是肯定有一种更优雅的方式来清理字符串，可能使用 re 模块。希望这可以帮助。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-08-03T18:17:37.073

要读取 Word 2007 及更高版本的文件，包括 .docx 文件，您可以使用[python-docx](http://python-docx.readthedocs.io/en/latest/user/documents.html)包：

```
from docx import Document
document = Document('existing-document-file.docx')
document.save('new-file-name.docx') 
```

要从 Word 2003 及更早版本读取 .doc 文件，请对[antiword](http://www.winfield.demon.nl/)进行子进程调用。你需要先安装antiword：

```
sudo apt-get install antiword 
```

然后从你的 python 脚本中调用它：

```
import os
input_word_file = "input_file.doc"
output_text_file = "output_file.txt"
os.system('antiword %s > %s' % (input_word_file, output_text_file)) 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-24T03:19:53.460

我不确定如果不使用 COM，您是否会很幸运。.doc 格式非常复杂，在保存时通常被称为 Word 的“内存转储”！

在 Swati，那是在 HTML 中，这很好而且很漂亮，但是大多数 word 文档不是那么好！

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2012-05-16T11:35:57.933

Unoconv 也可能是一个不错的选择：[http ://linux.die.net/man/1/unoconv](http://linux.die.net/man/1/unoconv)

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2015-05-08T11:31:23.600

如果您安装了 LibreOffice，[您可以简单地从命令行调用它来将文件转换为 text](https://stackoverflow.com/questions/16516044/is-it-possible-to-read-word-files-doc-docx-in-python/30122239#30122239)，然后将文本加载到 Python 中。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2015-06-01T20:20:14.347

这是一个老问题吗？我相信这样的事情是不存在的。只有回答的和未回答的。如果您愿意，这个问题几乎没有答案，或者回答了一半。好吧，不使用 COM 互操作读取 *.docx（MS Word 2007 及更高版本）文档的方法都已涵盖。但是，仅使用 Python 从 *.doc (MS Word 97-2000) 中提取文本的方法缺乏。这很复杂吗？要做：不是真的，要理解：嗯，那是另一回事。

当我没有找到任何完成的代码时，我阅读了一些格式规范并挖掘了一些其他语言的建议算法。

MS Word (*.doc) 文件是一个 OLE2 复合文件。不要用很多不必要的细节来打扰您，将其视为存储在文件中的文件系统。它实际上使用了FAT结构，所以定义成立。（嗯，也许您可​​以在 Linux 中循环挂载它？？？）这样，您可以在一个文件中存储更多文件，例如图片等。在 *.docx 中也可以使用 ZIP 存档代替。PyPI 上有可以读取 OLE 文件的包。像（olefile，compoundfiles，...）我使用 Compoundfiles 包打开 *.doc 文件。但是，在 MS Word 97-2000 中，内部子文件不是 XML 或 HTML，而是二进制文件。由于这还不够，每个都包含关于另一个的信息，因此您必须阅读其中至少两个并相应地解开存储的信息。要完全理解，请阅读我从中获取算法的 PDF 文档。

下面的代码非常仓促地编写并在少量文件上进行了测试。据我所知，它按预期工作。有时会在开头出现一些乱码，而且几乎总是在文本的结尾。中间也可能有一些奇怪的字符。

那些只想搜索文本的人会很高兴。尽管如此，我还是敦促任何可以帮助改进此代码的人这样做。

```
 doc2text module:
"""
This is Python implementation of C# algorithm proposed in:
http://b2xtranslator.sourceforge.net/howtos/How_to_retrieve_text_from_a_binary_doc_file.pdf

Python implementation author is Dalen Bernaca.
Code needs refining and probably bug fixing!
As I am not a C# expert I would like some code rechecks by one.
Parts of which I am uncertain are:
    * Did the author of original algorithm used uint32 and int32 when unpacking correctly?
      I copied each occurence as in original algo.
    * Is the FIB length for MS Word 97 1472 bytes as in MS Word 2000, and would it make any difference if it is not?
    * Did I interpret each C# command correctly?
      I think I did!
"""

from compoundfiles import CompoundFileReader, CompoundFileError
from struct import unpack

__all__ = ["doc2text"]

def doc2text (path):
    text = u""
    cr = CompoundFileReader(path)
    # Load WordDocument stream:
    try:
        f = cr.open("WordDocument")
        doc = f.read()
        f.close()
    except: cr.close(); raise CompoundFileError, "The file is corrupted or it is not a Word document at all."
    # Extract file information block and piece table stream informations from it:
    fib = doc[:1472]
    fcClx  = unpack("L", fib[0x01a2l:0x01a6l])[0]
    lcbClx = unpack("L", fib[0x01a6l:0x01a6+4l])[0]
    tableFlag = unpack("L", fib[0x000al:0x000al+4l])[0] & 0x0200l == 0x0200l
    tableName = ("0Table", "1Table")[tableFlag]
    # Load piece table stream:
    try:
        f = cr.open(tableName)
        table = f.read()
        f.close()
    except: cr.close(); raise CompoundFileError, "The file is corrupt. '%s' piece table stream is missing." % tableName
    cr.close()
    # Find piece table inside a table stream:
    clx = table[fcClx:fcClx+lcbClx]
    pos = 0
    pieceTable = ""
    lcbPieceTable = 0
    while True:
        if clx[pos]=="\x02":
            # This is piece table, we store it:
            lcbPieceTable = unpack("l", clx[pos+1:pos+5])[0]
            pieceTable = clx[pos+5:pos+5+lcbPieceTable]
            break
        elif clx[pos]=="\x01":
            # This is beggining of some other substructure, we skip it:
            pos = pos+1+1+ord(clx[pos+1])
        else: break
    if not pieceTable: raise CompoundFileError, "The file is corrupt. Cannot locate a piece table."
    # Read info from pieceTable, about each piece and extract it from WordDocument stream:
    pieceCount = (lcbPieceTable-4)/12
    for x in xrange(pieceCount):
        cpStart = unpack("l", pieceTable[x*4:x*4+4])[0]
        cpEnd   = unpack("l", pieceTable[(x+1)*4:(x+1)*4+4])[0]
        ofsetDescriptor = ((pieceCount+1)*4)+(x*8)
        pieceDescriptor = pieceTable[ofsetDescriptor:ofsetDescriptor+8]
        fcValue = unpack("L", pieceDescriptor[2:6])[0]
        isANSII = (fcValue & 0x40000000) == 0x40000000
        fc      = fcValue & 0xbfffffff
        cb = cpEnd-cpStart
        enc = ("utf-16", "cp1252")[isANSII]
        cb = (cb*2, cb)[isANSII]
        text += doc[fc:fc+cb].decode(enc, "ignore")
    return "\n".join(text.splitlines()) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-02-12T09:25:30.153

只是一个不使用 COM 读取“doc”文件的选项：[miette](https://github.com/rembish/Miette)。应该在任何平台上工作。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2021-01-11T16:27:22.480

[Aspose.Words Cloud SDK for Python](https://products.aspose.cloud/words/python)是一个独立于平台的解决方案，用于将 MS Word/Open Office 文件转换为文本。它是一个商业产品，但免费试用计划提供每月 150 次 API 调用。

PS：我是 Aspose 的开发人员布道师。

```
# For complete examples and data files, please go to https://github.com/aspose-words-cloud/aspose-words-cloud-python
# Import module
import asposewordscloud
import asposewordscloud.models.requests
from shutil import copyfile

# Please get your Client ID and Secret from https://dashboard.aspose.cloud.
client_id='xxxxxxx-xxxx-xxxx-xxxxx-xxxxxxxxxx'
client_secret='xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'

words_api = asposewordscloud.WordsApi(client_id,client_secret)
words_api.api_client.configuration.host='https://api.aspose.cloud'

filename = 'C:/Temp/02_pages.docx'
dest_name = 'C:/Temp/02_pages.txt'
#Convert RTF to text
request = asposewordscloud.models.requests.ConvertDocumentRequest(document=open(filename, 'rb'), format='txt')
result = words_api.convert_document(request)
copyfile(result, dest_name) 
```

# mysql - MySQL搜索并替换字段中的一些文本

> ID：125230
> 
> 赞同：283
> 
> 时间：2008-09-24T03:18:13.447
> 
> 标签：mysql, sql, search, replace

什么 MySQL 查询将在表中的一个特定字段中进行文本搜索和替换？

即搜索`foo`并替换为`bar`这样一个记录，其中一个字段的值`hello foo`变为`hello bar`。

* * *

## 回答 #1

> 赞同：533
> 
> 时间：2008-09-24T03:23:46.867

更改`table_name`并`field`匹配您的表名和相关字段：

```
UPDATE table_name SET field = REPLACE(field, 'foo', 'bar') WHERE INSTR(field, 'foo') > 0; 
```

*   [替换](https://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_replace)（字符串函数）
*   [INSTR](https://dev.mysql.com/doc/refman/5.7/en/string-functions.html#function_instr)（字符串函数）

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2008-09-24T03:22:45.650

```
UPDATE table_name 
SET field = replace(field, 'string-to-find', 'string-that-will-replace-it'); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-07-08T10:53:37.730

```
 UPDATE table SET field = replace(field, text_needs_to_be_replaced, text_required); 
```

例如，如果我想用 Mark 替换所有出现的 John，我将在下面使用，

```
UPDATE student SET student_name = replace(student_name, 'John', 'Mark'); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-04-05T14:07:21.297

以我的经验，最快的方法是

```
UPDATE table_name SET field = REPLACE(field, 'foo', 'bar') WHERE field LIKE '%foo%'; 
```

`INSTR()`方法是第二快的，完全省略子句`WHERE`是最慢的，即使该列没有被索引。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-05-05T09:18:39.210

如果您想根据另一个字段的值进行搜索和替换，您可以执行 CONCAT：

```
update table_name set `field_name` = replace(`field_name`,'YOUR_OLD_STRING',CONCAT('NEW_STRING',`OTHER_FIELD_VALUE`,'AFTER_IF_NEEDED')); 
```

只是把这个放在这里，以便其他人立即找到它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T03:22:16.947

[替换](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_replace)字符串函数将执行此操作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-22T23:33:30.993

我使用上面的命令行如下： update TABLE-NAME set FIELD = replace(FIELD, 'And', 'and'); 目的是用 and 替换 And（“A”应该是小写的）。问题是它无法在数据库中找到“And”，但如果我使用“%And%”，那么它可以找到它以及作为单词一部分的许多其他 and，甚至是已经小写的那些。

# caching - Safari/WebKit 中是否有相当于 Ctrl-Shift-R 的功能？

> ID：125245
> 
> 赞同：2
> 
> 时间：2008-09-24T03:23:20.487
> 
> 标签：caching, safari, webkit

真正重新加载页面或资源的东西，忽略缓存中可能存在的任何内容。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T03:24:35.570

Safari 总是重新加载 (ctrl+r) 一个页面[，忽略缓存中可能存在的任何内容](http://docs.info.apple.com/article.html?artnum=306244 "苹果文档")。

正如 Athena 指出的那样，iframe 被缓存。它实际上不是 iframe 内容，而是缓存的*请求*。

> 在这些情况下，Safari 会缓存页面，然后无论您单击哪个链接，都会在刷新（或后退/前进）之前显示上次单击的 iframe。然后它会停留在该内容上，并为所有链接显示它。

这可以通过[在每个负载上分配不同的 iframe id](http://www.webdeveloper.com/forum/showthread.php?t=150101 "iframe 和 Safari")来克服：

> iframe.id = new Date().getTime();

# validation - 有没有办法验证 hAtom 微格式？

> ID：125262
> 
> 赞同：6
> 
> 时间：2008-09-24T03:28:49.553
> 
> 标签：validation, microformats

我已经在我的博客上实现了[hAtom 微格式。](http://microformats.org/wiki/hatom)至少，我想我有，但是我找不到任何验证器（或任何使用 hAtom 的软件）来确定我是否正确地完成了这项工作。[Google 搜索“hatom 验证器”](http://www.google.com/search?num=100&q=hatom+validator&btnG=Search)目前没有返回任何有用的信息。有谁知道确认它是否正确实施的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-10-10T18:33:55.990

[擎天柱](http://microformatique.com/optimus/)呢？

否则，您可以通过将其添加到[wild 中的 hAtom 示例](http://microformats.org/wiki/hatom-examples-in-wild)列表来缓慢验证它。偶尔有人会检查它们并将坏的移到“有一些问题的示例”列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T03:37:29.547

你可能会发现这些有用

[http://microformats.org/wiki/hatom#Examples](http://microformats.org/wiki/hatom#Examples)

[http://microformats.org/wiki/hatom#Implementations](http://microformats.org/wiki/hatom#Implementations)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-10-12T03:11:20.063

[将其转换为 Atom](http://microformats.org/wiki/hatom#Implementations)，[验证 Atom](http://feedvalidator.org/)并手动检查它是否包含您期望的所有数据。

有开源的[hCard 验证器](http://hcard.geekhood.net/)。也许有人可以调整它来验证 hAtom……</p>

# raku - Perl 6 如何评估真实性？

> ID：125265
> 
> 赞同：27
> 
> 时间：2008-09-24T03:30:00.190
> 
> 标签：raku, truthiness

在阅读有关 Perl 6 的文章时，我看到一个功能被吹捧，您不再需要这样做：

```
return "0 but true"; 
```

...但可以改为：

```
return 0 but True; 
```

如果是这样，真理在 Perl 6 中是如何工作的？在 Perl 5 中，这非常简单：0、"" 和 undef 为假，其他一切都为真。

Perl 6 中关于布尔上下文的规则是什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-09-24T07:38:08.923

Perl 6 现在通过向对象提问而不是查看其值来评估真相。值不是对象。这是我喜欢其他对象语言的地方，并且很高兴在 Perl 中拥有它：我可以决定对象如何响应并可以改变它。正如 ysth 所说，你可以在 Perl 5 中使用过载来做到这一点，但我总是觉得这样做后我必须洗手。:)

如果你不做任何改变，Perl 6 的行为方式与 Perl 5 相同，所以你得到的惊喜最少。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-24T03:47:51.427

参见[概要 12：角色](http://dev.perl.org/perl6/doc/design/syn/S12.html#Roles)。

规则是相同的，但“但是”复制了 0 并将角色应用于副本，使其在布尔上下文中为真。

你可以在 Perl 5 中对重载做同样的事情。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-09-24T07:44:00.000

真实性测试只是调用`.true`对象上的方法，因此“混合”操作`$stuff but True`只是（除其他外）覆盖该方法。

这是在[S02](http://perlcabal.org/syn/S02.html#Context)中指定的，一般枚举类型（其中 Bool 是其中之一）在[S12](http://perlcabal.org/syn/S12.html#Enums)中描述。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-24T03:42:13.950

根据 O'Reilly 的*[Perl 6 和 Parrot Essentials](http://books.google.com/books?id=NYgzEwH5tsQC&pg=PA37&lpg=PA36&ots=cjwHsY0ZrS&output=html)*，**false**为 0，undef 为空字符串，值标记为*false*。**其他的都是真的**。

此外，Perl 6 既有原始布尔类型，也有任何值都可以混合的 True 和 False**角色**（例如，您可以拥有“0 但为真”值或“1 但为假”值，或假列表包含元素，或为空的真实列表）。

请参阅[http://www.mail-archive.com/macosx@perl.org/msg09930.html](http://www.mail-archive.com/macosx@perl.org/msg09930.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-24T14:28:45.097

因此，结合我认为每个人的最佳答案：

当您在布尔上下文中评估变量时，将调用其 .true() 方法。对象使用的默认 .true() 方法对对象的值进行 Perl 5 样式的 <0, "", undef> 检查，但是当您说“但 True”或“但 False”时，此方法会被覆盖一个不看值的只是返回一个常数。

可以想象编写一个 true() 方法，例如，当值是偶数时返回真，当它是奇数时返回假。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-02T17:31:25.677

几乎在任何地方都被忽略的一个错误值是“0”。我最近痛苦地发现 PERL 5 中的“0”是**错误**的。哎呀。一个错误的非空字符串。我真的希望这会在 PERL6 中有所改变，但我想不会。

```
> if ( "0" ) { say "True" } else { say "False" }
False 
```

||= 成语破坏了一些我真的没想到的字符串：

```
$ perl -e '$x = "0"; $x ||= ""; print ">>$x<<\n";'
>><< 
```

# php - 在 PHP 中链接静态方法？

> ID：125268
> 
> 赞同：61
> 
> 时间：2008-09-24T03:32:13.147
> 
> 标签：php, oop, method-chaining

是否可以使用静态类将静态方法链接在一起？假设我想做这样的事情：

```
$value = TestClass::toValue(5)::add(3)::subtract(2)::add(8)::result(); 
```

. . . 显然我希望 $value 被分配数字 14。这可能吗？

**更新**：它不起作用（你不能返回“自我” - 它不是一个实例！），但这是我的想法带我去的地方：

```
class TestClass {
    public static $currentValue;

    public static function toValue($value) {
        self::$currentValue = $value;
    }

    public static function add($value) {
        self::$currentValue = self::$currentValue + $value;
        return self;
    }

    public static function subtract($value) {
        self::$currentValue = self::$currentValue - $value;
        return self;
    }

    public static function result() {
        return self::$value;
    }
} 
```

在解决了这个问题之后，我认为简单地使用类实例而不是尝试链接静态函数调用会更有意义（这看起来不可能，除非上面的示例可以以某种方式进行调整）。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-09-24T04:13:20.663

我喜欢上面 Camilo 提供的解决方案，本质上是因为您所做的只是更改静态成员的值，并且由于您确实想要链接（即使它只是语法糖），那么实例化 TestClass 可能是最好的方法.

如果您想限制类的实例化，我建议使用单例模式：

```
class TestClass
{   
    public static $currentValue;

    private static $_instance = null;

    private function __construct () { }

    public static function getInstance ()
    {
        if (self::$_instance === null) {
            self::$_instance = new self;
        }

        return self::$_instance;
    }

    public function toValue($value) {
        self::$currentValue = $value;
        return $this;
    }

    public function add($value) {
        self::$currentValue = self::$currentValue + $value;
        return $this;
    }

    public function subtract($value) {
        self::$currentValue = self::$currentValue - $value;
        return $this;
    }

    public function result() {
        return self::$currentValue;
    }
}

// Example Usage:
$result = TestClass::getInstance ()
    ->toValue(5)
    ->add(3)
    ->subtract(2)
    ->add(8)
    ->result(); 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2012-08-10T18:35:19.553

```
class oop{
    public static $val;

    public static function add($var){
        static::$val+=$var;
        return new static;
    }

    public static function sub($var){
        static::$val-=$var;
        return new static;
    }

    public static function out(){
        return static::$val;
    }

    public static function init($var){
        static::$val=$var;
        return new static;      
    }
}

echo oop::init(5)->add(2)->out(); 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2012-07-05T05:50:29.817

php5.3 上的小疯狂代码......只是为了好玩。

```
namespace chaining;
class chain
    {
    static public function one()
        {return get_called_class();}

    static public function two()
        {return get_called_class();}
    }

${${${${chain::one()} = chain::two()}::one()}::two()}::one(); 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2015-09-02T02:48:48.683

使用 php7，您将能够使用所需的语法，因为新的[统一变量语法](https://wiki.php.net/rfc/uniform_variable_syntax)

```
<?php

abstract class TestClass {

    public static $currentValue;

    public static function toValue($value) {
        self::$currentValue = $value;
        return __CLASS__;
    }

    public static function add($value) {
        self::$currentValue = self::$currentValue + $value;
        return __CLASS__;
    }

    public static function subtract($value) {
        self::$currentValue = self::$currentValue - $value;
        return __CLASS__;
    }

    public static function result() {
        return self::$currentValue;
    }

}

$value = TestClass::toValue(5)::add(3)::subtract(2)::add(8)::result();
echo $value; 
```

[演示](https://3v4l.org/XH42Y)

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2008-09-24T03:47:03.567

如果 toValue(x) 返回一个对象，你可以这样做：

```
$value = TestClass::toValue(5)->add(3)->substract(2)->add(8); 
```

提供该 toValue 会返回该对象的一个​​新实例，并且每个 next 方法都会对其进行变异，返回一个 $this 实例。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-09-02T12:23:01.847

这更准确、更容易、更易于阅读（允许代码完成）

```
class Calculator
{   
    public static $value = 0;

    protected static $onlyInstance;

    protected function __construct () 
    {
        // disable creation of public instances 
    }

    protected static function getself()
    {
        if (static::$onlyInstance === null) 
        {
            static::$onlyInstance = new Calculator;
        }

        return static::$onlyInstance;
    }

    /**
     * add to value
     * @param numeric $num 
     * @return \Calculator
     */
    public static function add($num) 
    {
        static::$value += $num;
        return static::getself();
    }

    /**
     * substruct
     * @param string $num
     * @return \Calculator
     */
    public static function subtract($num) 
    {
        static::$value -= $num;
        return static::getself();
    }

    /**
     * multiple by
     * @param string $num
     * @return \Calculator
     */
    public static function multiple($num) 
    {
        static::$value *= $num;
        return static::getself();
    }

    /**
     * devide by
     * @param string $num
     * @return \Calculator
     */
    public static function devide($num) 
    {
        static::$value /= $num;
        return static::getself();
    }

    public static function result()
    {
        return static::$value;
    }
} 
```

**例子：**

```
echo Calculator::add(5)
        ->subtract(2)
        ->multiple(2.1)
        ->devide(10)
    ->result(); 
```

**结果：0.63**

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2019-12-12T05:00:22.137

人们疯狂地把这件事复杂化了。

看一下这个：

```
class OopClass
{
    public $first;
    public $second;
    public $third;

    public static function make($first)
    {
        return new OopClass($first);
    }

    public function __construct($first)
    {
        $this->first = $first;
    }

    public function second($second)
    {
        $this->second = $second;
        return $this;
    }

    public function third($third)
    {
        $this->third = $third;
        return $this;
    }
} 
```

用法：

```
OopClass::make('Hello')->second('To')->third('World'); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-09-24T04:35:37.753

您始终可以将 First 方法用作静态方法，将其余方法用作实例方法：

```
$value = Math::toValue(5)->add(3)->subtract(2)->add(8)->result(); 
```

或者更好：

```
 $value = Math::eval(Math::value(5)->add(3)->subtract(2)->add(8));

class Math {
     public $operation;
     public $operationValue;
     public $args;
     public $allOperations = array();

     public function __construct($aOperation, $aValue, $theArgs)
     {
       $this->operation = $aOperation;
       $this->operationValue = $aValue;
       $this->args = $theArgs;
     }

     public static function eval($math) {
       if(strcasecmp(get_class($math), "Math") == 0){
            $newValue = $math->operationValue;
            foreach ($math->allOperations as $operationKey=>$currentOperation) {
                switch($currentOperation->operation){
                    case "add":
                         $newvalue = $currentOperation->operationValue + $currentOperation->args;
                         break;
                    case "subtract":
                         $newvalue = $currentOperation->operationValue - $currentOperation->args;
                         break;
                }
            }
            return $newValue;
       }
       return null;
     }

     public function add($number){
         $math = new Math("add", null, $number);
         $this->allOperations[count($this->allOperations)] &= $math;
         return $this;
     }

     public function subtract($number){
         $math = new Math("subtract", null, $number);
         $this->allOperations[count($this->allOperations)] &= $math;
         return $this;
     }

     public static function value($number){
         return new Math("value", $number, null);
     }
 } 
```

仅供参考。我在脑海中写下了这个（就在网站上）。因此，它可能无法运行，但这就是想法。我也可以对 eval 进行递归方法调用，但我认为这可能更简单。如果您希望我详细说明或提供任何其他帮助，请告诉我。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-10-21T04:42:49.367

从技术上讲，您可以`$object::method()`在 PHP 7+ 中调用实例上的静态方法，因此返回一个新实例应该可以替代`return self`. [确实有效。](https://3v4l.org/BspcC)

```
final class TestClass {
    public static $currentValue;

    public static function toValue($value) {
        self::$currentValue = $value;
        return new static();
    }

    public static function add($value) {
        self::$currentValue = self::$currentValue + $value;
        return new static();
    }

    public static function subtract($value) {
        self::$currentValue = self::$currentValue - $value;
        return new static();
    }

    public static function result() {
        return self::$currentValue;
    }
}

$value = TestClass::toValue(5)::add(3)::subtract(2)::add(8)::result();

var_dump($value); 
```

输出`int(14)`。

[这与其他答案](https://stackoverflow.com/a/49113525/93540)`__CLASS__`中使用的返回大致相同。我宁愿希望没有人决定实际使用这些形式的 API，但你要求它。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-24T03:39:01.837

简而言之……不。:) 解析运算符 (::) 将适用于 TetsClass::toValue(5) 部分，但之后的所有内容都只会给出语法错误。

一旦在 5.3 中实现了命名空间，您就可以拥有“链式”:: 运算符，但所有要做的就是向下钻取命名空间树；在这样的事情中间不可能有方法。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-08-20T19:41:41.380

**能做到的最好的**

```
class S
{
    public static function  __callStatic($name,$args)
    {
        echo 'called S::'.$name . '( )<p>';
        return '_t';
    }
}

$_t='S';
${${S::X()}::F()}::C(); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-24T03:40:25.063

不，这行不通。`::`操作员需要评估回一个类，所以在`TestClass::toValue(5)`评估之后，该方法`::add(3)`只能评估最后一个的答案。

所以如果`toValue(5)`返回整数 5，你基本上会调用`int(5)::add(3)`这显然是一个错误。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-06-13T13:43:10.863

我发现从类的新实例或静态方法链接方法的最简单方法如下。我在这里使用了后期静态绑定，我真的很喜欢这个解决方案。

我创建了一个实用程序，可以在 Laravel 中使用 tostr 在下一页发送多个用户通知。

```
<?php

namespace App\Utils;

use Session;

use Illuminate\Support\HtmlString;

class Toaster
{
    private static $options = [

        "closeButton" => false,

        "debug" => false,

        "newestOnTop" => false,

        "progressBar" => false,

        "positionClass" => "toast-top-right",

        "preventDuplicates" => false,

        "onclick" => null,

        "showDuration" => "3000",

        "hideDuration" => "1000",

        "timeOut" => "5000",

        "extendedTimeOut" => "1000",

        "showEasing" => "swing",

        "hideEasing" => "linear",

        "showMethod" => "fadeIn",

        "hideMethod" => "fadeOut"
    ];

    private static $toastType = "success";

    private static $instance;

    private static $title;

    private static $message;

    private static $toastTypes = ["success", "info", "warning", "error"];

    public function __construct($options = [])
    {
        self::$options = array_merge(self::$options, $options);
    }

    public static function setOptions(array $options = [])
    {
        self::$options = array_merge(self::$options, $options);

        return self::getInstance();
    }

    public static function setOption($option, $value)
    {
        self::$options[$option] = $value;

        return self::getInstance();
    }

    private static function getInstance()
    {
        if(empty(self::$instance) || self::$instance === null)
        {
            self::setInstance();
        }

        return self::$instance;
    }

    private static function setInstance()
    {
        self::$instance = new static();
    }

    public static function __callStatic($method, $args)
    {
        if(in_array($method, self::$toastTypes))
        {
            self::$toastType = $method;

            return self::getInstance()->initToast($method, $args);
        }

        throw new \Exception("Ohh my god. That toast doesn't exists.");
    }

    public function __call($method, $args)
    {
        return self::__callStatic($method, $args);
    }

    private function initToast($method, $params=[])
    {
        if(count($params)==2)
        {
            self::$title = $params[0];

            self::$message = $params[1];
        }
        elseif(count($params)==1)
        {
            self::$title = ucfirst($method);

            self::$message = $params[0];
        }

        $toasters = [];

        if(Session::has('toasters'))
        {
            $toasters = Session::get('toasters');
        }

        $toast = [

            "options" => self::$options,

            "type" => self::$toastType,

            "title" => self::$title,

            "message" => self::$message
        ];

        $toasters[] = $toast;

        Session::forget('toasters');

        Session::put('toasters', $toasters);

        return $this;
    }

    public static function renderToasters()
    {
        $toasters = Session::get('toasters');

        $string = '';

        if(!empty($toasters))
        {
            $string .= '<script type="application/javascript">';

            $string .= "$(function() {\n";

            foreach ($toasters as $toast)
            {
                $string .= "\n toastr.options = " . json_encode($toast['options'], JSON_PRETTY_PRINT) . ";";

                $string .= "\n toastr['{$toast['type']}']('{$toast['message']}', '{$toast['title']}');";
            }

            $string .= "\n});";

            $string .= '</script>';
        }

        Session::forget('toasters');

        return new HtmlString($string);
    }
} 
```

这将如下工作。

```
Toaster::success("Success Message", "Success Title")

    ->setOption('showDuration', 5000)

    ->warning("Warning Message", "Warning Title")

    ->error("Error Message"); 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2019-01-11T03:14:31.437

具有静态属性的方法链接的完整功能示例：

```
<?php

class Response
{
    static protected $headers = [];
    static protected $http_code = 200;
    static protected $http_code_msg = '';
    static protected $instance = NULL;

    protected function __construct() { }

    static function getInstance(){
        if(static::$instance == NULL){
            static::$instance = new static();
        }
        return static::$instance;
    }

    public function addHeaders(array $headers)
    {
        static::$headers = $headers;
        return static::getInstance();
    }

    public function addHeader(string $header)
    {
        static::$headers[] = $header;
        return static::getInstance();
    }

    public function code(int $http_code, string $msg = NULL)
    {
        static::$http_code_msg = $msg;
        static::$http_code = $http_code;
        return static::getInstance();
    }

    public function send($data, int $http_code = NULL){
        $http_code = $http_code != NULL ? $http_code : static::$http_code;

        if ($http_code != NULL)
            header(trim("HTTP/1.0 ".$http_code.' '.static::$http_code_msg));

        if (is_array($data) || is_object($data))
            $data = json_encode($data);

        echo $data; 
        exit();     
    }

    function sendError(string $msg_error, int $http_code = null){
        $this->send(['error' => $msg_error], $http_code);
    }
} 
```

使用示例：

```
Response::getInstance()->code(400)->sendError("Lacks id in request"); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-10-20T12:12:15.463

这是另一种不经过方法的`getInstance`方法（在 PHP 7.x 上测试）：

```
class TestClass
{
    private $result = 0;

    public function __call($method, $args)
    {
        return $this->call($method, $args);
    }

    public static function __callStatic($method, $args)
    {
        return (new static())->call($method, $args);
    }

    private function call($method, $args)
    {
        if (! method_exists($this , '_' . $method)) {
            throw new Exception('Call undefined method ' . $method);
        }

        return $this->{'_' . $method}(...$args);
    }

    private function _add($num)
    {
        $this->result += $num;

        return $this;
    }

    private function _subtract($num)
    {
        $this->result -= $num;

        return $this;
    }

    public function result()
    {
        return $this->result;
    }
} 
```

该类可以如下使用：

```
$res1 = TestClass::add(5)
    ->add(3)
    ->subtract(2)
    ->add(8)
    ->result();

echo $res1 . PHP_EOL; // 14

$res2 = TestClass::subtract(1)->add(10)->result();
echo $res2 . PHP_EOL; // 9 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2022-02-18T11:01:42.090

也可以作为：

```
ExampleClass::withBanners()->withoutTranslations()->collection($values) 
```

使用`new static(self::class);`

```
public static function withoutTranslations(): self
{
    self::$withoutTranslations = true;

    return new static(self::class);
}

public static function withBanners(): self
{
    return new static(self::class);
}

public static function collection(values): self
{
    return $values;
} 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2018-03-05T15:12:00.143

使用 PHP 7！如果您的网络提供商不能 --> 更改提供商！不要锁定过去。

```
final class TestClass {
    public static $currentValue;

    public static function toValue($value) {
        self::$currentValue = $value;
        return __CLASS__;
    }

    public static function add($value) {
        self::$currentValue = self::$currentValue + $value;
        return __CLASS__;
    }

    public static function subtract($value) {
        self::$currentValue = self::$currentValue - $value;
        return __CLASS__;
    }

    public static function result() {
        return self::$currentValue;
    }
} 
```

[并且非常简单的使用：](https://3v4l.org/iipko)

```
$value = TestClass::toValue(5)::add(3)::subtract(2)::add(8)::result();

var_dump($value); 
```

返回（或抛出错误）：

```
int(14) 
```

**完成的合同。**

规则一：最进化和可维护的总是更好。

# user-interface - 您将如何处理不阅读对话框的用户？

> ID：125269
> 
> 赞同：29
> 
> 时间：2008-09-24T03:32:20.653
> 
> 标签：user-interface, dialog

最近关于[Ars Technica](http://arstechnica.com/news.ars/post/20080923-study-confirms-users-are-idiots.html)的一篇文章讨论了北卡罗来纳州立大学心理学系最近进行的一项研究，该研究表明用户倾向于不惜一切代价摆脱对话框以回到他们手头的任务。他们中的大多数会单击“确定”或“是”，最小化对话框或关闭对话框，而不管显示的消息如何。显示的对话框有些是真实的，有些是假的（例如那些冒充防病毒警告的网页显示的弹出窗口）。响应时间表明这些用户并没有真正阅读这些对话框。

那么，知道了这一点，这将如何影响您的设计，以及您会尝试做些什么（如果有的话）？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-09-24T03:46:02.740

我尝试将应用程序设计为在面对意外时保持稳健——无论是滑倒（无意操作，例如单击错误的位置）或错误（认知错误，例如单击对话框上的确定与取消）。一些方法是：

1.  无限（或至少多步）撤消/重做
2.  通过动态工具提示和其他上下文相关的通信方式将文档与界面集成（一篇特别相关的论文是关于[“惊喜、解释、奖励”](http://loki.lokislabs.org/weblog/archives/2003/09/17/surpriseexplainreward.php)（直接链接：[SER](ftp://ftp.cs.orst.edu/pub/burnett/chi03.curiosity.pdf)）——使用对意外行为的典型心理反应来告知用户）
3.  将系统的状态整合到所述文档中（以当前用户的数据为例，并使用他们*现在*可以看到的数据使文档具体化）
4.  *预期*用户错误。如果有人在没有磁盘的情况下尝试写入 a:\，则执行超时，以便系统可以正常失败，并提示另一个位置。将数据保存在内存中，直到它在磁盘等上安全为止。

这归结为两个核心内容：（1）防御性编程，以及（2）尽可能让用户了解情况。如果系统的界面易于使用，并且行为符合他们的期望，那么当出现烦人的对话框时，他们更有可能*知道单击哪个按钮。*

我也非常非常努力地避免使用任何模式，因此用户*可以*忽略我必须使用的大多数对话框，至少在一段时间内（当他们真的需要注意它们时，他们有足够的信息知道如何处理它）。

使系统完全万无一失是不可能的，但我发现上述技术朝着正确的方向走了很长一段路。（并且它们已被纳入用于开发 Surprise Explain Reward 和其他经过广泛用户研究审查的工具的系统中。）

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-09-24T03:36:31.797

首先，颜色和图标的使用应该帮助用户在视觉上了解问题的严重性，红色表示异常，黄色表示警告，白色表示信息。

其次，[在对话按钮上使用动词可以](http://www.usabilitypost.com/2008/08/30/usability-tip-use-verbs-as-labels-on-buttons/)让用户了解他们在告诉系统做什么，即使他们没有阅读对话文本。

最后，如果您有兴趣研究完全不同的通知范例，请查看在 Firefox 和 Internet Explorer 中实现的信息栏或通知栏。StackOverflow 使用相同类型的机制在用户获得新徽章时通知他们。

信息栏不显眼，并停留在屏幕顶部等待用户注意。我认为这是一个很好的设计隐喻。

这里有几个实现教程：

*   [C＃](http://www.codeproject.com/KB/miscctrl/InformationBar.aspx)
*   [JavaScript](http://www.codeproject.com/kb/scripting/javascriptinfobar.aspx)

这是[微软关于对话框设计的指南](http://msdn.microsoft.com/en-us/library/bb545457.aspx)，它也涉及到信息栏的概念。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2008-09-24T03:36:12.140

立即想到史蒂夫克鲁格的书[不要让我思考](http://www.sensible.com/buythebook.html)。

在对话框的设计、返回给用户的状态消息等方面，最好使用图标和颜色提示来说明单词的实际含义。

因此，突出显示红色错误消息、黄色警告等。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2008-09-24T04:19:32.347

[Jef Raskin 的人性化界面](https://rads.stackoverflow.com/amzn/click/com/0201379376)值得一读。对话框是最后的手段，也是设计不佳的标志。大多数都是不必要的，正如您所发现的，用户都忽略了。

为什么会有对话框？解决这个问题——不要要求用户确认操作，而是让撤消操作变得容易。不要弹出一个宣布错误的对话框 - 无论如何都要进行任何恢复（或任何可能的恢复）。绝对不要显示只有一个结果的对话框（只有“确定”的框是魔鬼），在应用程序中不显眼地显示信息。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2008-09-24T03:36:34.620

几个建议

1.  仅在绝对必要时使用盒子。
2.  始终将默认选项设置为最不危险的选项

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2008-09-24T04:37:20.653

一个[.NET Rocks](http://www.dotnetrocks.com/about.aspx)插曲浮现在脑海中（我相信[第 338 集，“Mark Miller on the Science of Good UI”](http://www.dotnetrocks.com/default.aspx?showNum=338)) 讨论这个话题。我认为整个讨论的关键在于，这是基本的 UI 设计太过分了。模态曾经是一种可接受的通信方式，但我们现在发现它已成为编程失礼。用户明白，十分之六的信息没有足够的相关性让他们担心。结果，他们以同样的方式对待所有情态——习得性无助。如果出现一个模式并告诉我发生了应用程序错误 X 并且我只能单击“确定”——即使我认为它不是“确定”，我也会学习一种特定的行为。我将模态与我可能对它们无能为力的想法相关联，但如果我单击“确定/是”，那么我可以回到我需要的东西。

那么，为什么还在使用呢？也许开发人员试图避免这样一个事实，即应用程序开发不仅仅是一个基本界面，而用户需要流畅的 UI 设计——旧的备用设备很难放弃......

我认为这里的关键是要理解，好的 UI 设计现在表明中断（即使是对于最新手的计算机用户）也是一种烦恼，我们需要努力获得无缝的用户体验，其中应用程序的重点是用户——而不是通过提示和错误报告来满足应用程序的需求——不允许用户进入他们不关心的情况。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2008-09-24T03:41:03.830

开发人员经常使用模式对话框只是因为它易于编码。

但是，非模态通知通常更方便用户处理。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-24T05:15:02.153

一个建议：

1.  不要使用对话框。特别是模态的，确定/取消对话框。

有时这很难......你如何处理打开文件？有时这很容易……您真的需要警告用户他们将要覆盖文件吗？很有可能，如果我盲目地单击“确定”，我将不会注意任何警告。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-24T03:44:13.400

如果您必须使用对话框，请在对话框内的按钮上添加描述性标题。

例如，让他们说“发送发票”和“返回”，而不是“确定”和“取消”按钮，或者在对话上下文中适当的任何内容。

这样，文本就在他们的光标下，他们有很好的理解机会。

Mac OS X 大部分时间都是这样做的。 [这是一个示例图像。](http://www.completedigitalphotography.com/Features/ResizingFromiPhoto/fileExportDialog.png)

编辑：

[这是一个更好的图像](http://developer.apple.com/documentation/UserExperience/Conceptual/AppleHIGuidelines/art/wn_alertbadged.jpg)，我在 Apple Human Interface Guideline 网站上找到了它，这是一个很好的参考，并且非常易读。 [该网站上的这份文档都是关于 Dialogs 的。](http://developer.apple.com/documentation/UserExperience/Conceptual/AppleHIGuidelines/XHIGWindows/chapter_18_section_7.html)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-24T15:27:51.867

错误的问题。“你将如何处理用户”的开头是错误的。

正确的问题是“鉴于对话会分散用户对手头任务的注意力，还有什么更好的选择？”。

在为实现目标或完成任务而努力时，我们可以区分三种情况：

(1) 应用程序得出的结论是，它无法采取任何行动来使用户实现目标。弹出一条消息，用一个按钮将其关闭。你不在乎读者是否理解它，因为无论如何结果并不重要。

(2) 您只能采取一种行动，或者替代方案与用户无关。完全不要打扰他。

(3) 有两种或两种以上的方式来实现目标。让用户在这些之间进行选择。不要将此表述为是/否问题。（Vista 将其作为一个通用对话框提供，以替换消息框。）如果可能，请不要将此作为不可逆转的选择。

此规则的例外是用户*期望*是/否问题的情况。但实际上，如果是这样的话，那么为什么问题不是正常工作流程的一部分呢？对话框超出了正常的工作流程。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-24T03:37:22.933

您可以做的一件事是禁用“确定”按钮 3 秒钟。

Firefox 会在您安装扩展程序时执行此操作。

**编辑：**好吧，有些人觉得这很烦人。我仍然认为大约 1 秒就可以了。它会抑制人们（包括我自己）所具有的立即点击 OK 的本能，并强制进行双重拍摄。当然，如果你的对话不是他们真正需要阅读的内容，即使这样也会惹恼他们。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-24T03:37:32.107

我想您可能想阅读这篇论文： [“高强度协商式中断对最终用户调试的影响”](ftp://ftp.cs.orst.edu/pub/burnett/jvlc-interruptions-2006.pdf)，TJ Robertson、Joseph Lawrance 和 Margaret Burnett，Journal of Visual Languages and Computing 17(2), 187- 202，2006 年 4 月。

它问了一个类似的问题。结果是，让用户知道你想要他们的注意力，然后坐下来等待用户回应。但是不要打断用户，那不是他或她想要的。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2008-09-24T03:55:58.333

[Lightbox]( [http://en.wikipedia.org/wiki/Lightbox_(JavaScript))](http://en.wikipedia.org/wiki/Lightbox_(JavaScript)))模态对话框在某些情况下似乎是一种有效的技术（web 2.0 派生，但可以在其他上下文中实现）。

[还有一点：如果您可以放弃撤消](http://en.wikipedia.org/wiki/The_Humane_Interface)功能的对话框（Gmail 将这一概念视为标准的 webapp 行为），这是需要考虑的事情。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2008-09-24T05:24:59.710

上面有很多好的建议。我只是想在书中添加推荐——Joel Splosky 的《程序员的用户界面设计》这本书值得一读：

[http://www.amazon.com/User-Interface-Design-Programmers-Spolsky/dp/1893115941/ref=pd_bbs_sr_4?ie=UTF8&s=books&qid=1222233643&sr=8-4](https://rads.stackoverflow.com/amzn/click/com/1893115941)

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-09-24T06:52:05.913

如果您必须使用对话，请用有趣的同情甚至讽刺和*非常简短的*解释性文字奖励用户。如果你偶尔发布一些可笑的丑闻，他们会阅读*所有内容*。

> 用户的常识低得危险。请删除此用户并插入另一个用户。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-09-24T16:14:08.310

我对不阅读花费我大量时间和精力来开发的用户没有耐心：1）应用程序 2）说明除此之外，如果您不阅读并且只是“不惜一切代价”去做，那么您就是靠自己。我事先声明。我将我的应用程序设计为尽可能直观，但仍然有人会突然拨打支持电话，就像一个孩子在不应该在课堂上脱口而出一样。我对此无法容忍。阅读手册，阅读对话框——99% 的问题的答案就在那里。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2008-09-24T03:39:37.357

首先，愚蠢应该会受到伤害，但通常不会如此......

下一个最好的事情是包含一个试图传达问题严重性的图标。如果对话框的图标看起来不祥，那么一部分不阅读的人可能会改变他们的习惯。无论如何，一些百分比不会阅读它。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2008-09-24T04:06:53.893

在对话框的末尾包括一个多项选择测验，用户必须选择表明他们确实阅读并理解文本的答案。随机切换选项的顺序，这样他们就不能总是点击同一个。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-09-24T05:45:29.257

更改措辞和对话的工作方式会有所帮助。例如，拥有确定/取消按钮往往会让用户忽略大部分对话框。如果您删除普通按钮并将其替换为更冗长的命令链接，则用户更有可能阅读每个按钮，因为“快速，离开”选项不可用。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-09-24T07:36:44.107

我称之为“自动驾驶”问题。

1.  不要使用屏幕底部的确定、取消按钮。看看 Vista 试图强迫用户做出真正决定的方式。
2.  禁用按钮几秒钟，显示“思考时间”计时器/进度条。所以用户不能点击自动驾驶仪。用户往往会觉得这很烦人。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-09-24T07:48:55.217

不要使用确认（您确定吗？是/否），但使用撤消。

不要弹出会*阻塞*的警告，因为用户会尝试尽快重新开始工作，而忽略消息并单击它。使用 Internet Explorer 中的信息栏之类的东西，它不会阻止。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-09-24T16:04:08.973

您可以避免一起使用对话框！在某些程序中，有一个显示错误和警告的小缓冲区。除此之外，它还可能会问你一件事，你必须在哪里输入你想做的事情。这是一个非常干净和不错的解决方案，我更喜欢它而不是菜单栏。

但是如果你真的必须使用对话框，试试这个：

*   每个对话只有一句话
*   最多两个或三个按钮
*   使对话框内的文本可读（更大，黑底白字）
*   宁可使用一个对话框，也不要重复使用多个小对话框（提示：列表框）

我对对话框有什么看法？简而言之：它们是愚蠢而愚蠢的东西。使用它们的程序让我上路，并用它们愚蠢的无意义的问题拖慢我的速度。此外，通常使用对话框的程序相当愚蠢。

# version-control - 提交和推送单个文件的最简单方法是什么，同时保留其他修改？

> ID：125272
> 
> 赞同：72
> 
> 时间：2008-09-24T03:33:09.510
> 
> 标签：version-control, mercurial, merge, push

我对 Mercurial 比较陌生，我的团队现在正在尝试将它作为 Subversion 的替代品。

我如何提交单个文件并将其推送到另一个存储库，同时保留我的工作目录中的其他修改未提交（或至少不推送到另一个存储库）？

这发生在我们的数据库迁移中。我们希望将迁移提交到源代码控制，以便 DBA 可以在我们进行代码修改以进行数据库迁移时查看和编辑它。更改尚未准备好进行，因此我们不想将所有更改都推出。

在颠覆中，我会简单地做：

```
svn add my_migration.sql  
# commit only the migration, but not the other files I'm working on
svn commit -m "migration notes" my_mygration.sql 
```

并继续在本地工作。

这不适用于 mercurial，因为当我将其推送到另一个存储库时，如果我没有拉下它的更改，它希望我将它们拉下，合并它们，并将合并提交到存储库。合并后的提交不允许您省略文件，因此它会强制您提交本地存储库中的所有内容。

我能想到的最简单的事情是将文件提交到我的本地存储库，克隆我的本地存储库，从实际存储库中获取任何新更改，合并它们并提交该合并，然后它们将我的更改推送出去。

```
hg add my_migration.sql 
hg commit -m "migration notes" my_migration.sql 
cd ..
hg clone project project-clone
cd project-clone
hg fetch http://hg/project
hg push  http://hg/project 
```

这可行，但感觉就像我错过了一些更简单的东西，某种方式告诉 mercurial 忽略我的工作目录中已经存在的文件，只需进行合并并将文件一起发送。我怀疑 mercurial 队列可以做到这一点，但我还没有完全理解 mq。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2010-07-13T17:33:39.953

自从我最初提出这个问题以来已经快 2 年了。我现在会采取不同的做法（正如我在上述问题上方的评论中提到的那样）。我现在要做的是将我的更改提交到本地存储库中的一个文件（您可以使用 hg 记录扩展名仅提交文件的一部分）：

```
hg commit -m "commit message" filename 
```

然后直接推出。

```
hg push 
```

如果由于对我需要首先合并的 repo 进行了其他更改而发生冲突，我将更新到父版本（使用“hg parents -r”查看。如果你不知道它是什么），提交我在那里的其他变化，所以我有2个头。然后恢复到原始的单个文件提交并将更改拉/合并到该版本中。然后推出更改

```
hg push --rev . 
```

仅推出单个文件并合并该修订。然后你可以合并你在本地得到的两个头。

这种方式摆脱了 mq 的东西和被拒绝的大块的可能性，并通过源代码控制跟踪所有内容。如果您以后决定不想要它们，您也可以“删除”修订。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-09-24T03:41:32.393

Mercurial 有一个实现搁置和取消搁置命令的功能，它为您提供了一种交互式方式来指定要存储到以后的更改：[搁置](http://www.selenic.com/mercurial/wiki/index.cgi/ShelveExtension)。

然后，您可以`hg shelve`临时`hg unshelve`存储更改。它使您可以在“补丁大块”级别工作，以挑选要搁置的项目。它似乎没有搁置列出的要添加的文件，只有已经在 repo 中有修改的文件。

它作为“扩展”包含在 Mercurial 中，这意味着您必须在 hg 配置文件中启用它。

* * *

真正旧版本的 Mercurial 的注意事项（在 shelve 包含之前 - 这不再需要）：

我没有通过谷歌搜索看到任何很好的安装说明，所以这是我用来让它工作的组合内容：

得到它：

```
hg clone http://freehg.org/u/tksoh/hgshelve/ hgshelve 
```

项目中唯一的文件（当前）是 hgshelve.py 文件。

修改你的 ~/.hgrc 以添加搁置扩展，指向你克隆 repo 的位置：

```
[extensions] 
hgshelve=/Users/ted/Documents/workspace/hgshelve/hgshelve.py 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-02-20T12:39:22.010

tl;dr：我最初的解释看起来很复杂，但我希望它完全解释了如何使用补丁队列。这是简短的版本：

```
$ hg qnew -m "migration notes" -f migration my_migration.sql
$ hg qnew -f working-code
# make some changes to your code
$ hg qrefresh # update the patch with the changes you just made
$ hg qfinish -a # turn all the applied patches into normal hg commits 
```

* * *

Mercurial Queues 使这种事情变得轻而易举，它使更复杂的变更集操作成为可能。值得学习。

在这种情况下，首先您可能希望在下拉更改之前保存当前目录中的内容：

```
# create a patch called migration containing your migration
$ hg qnew -m "migration notes" -f migration.patch my_migration.sql
$ hg qseries -v # the current state of the patch queue, A means applied
0 A migration.patch
$ hg qnew -f working-code.patch # put the rest of the code in a patch
$ hg qseries -v
0 A migration.patch
1 A working-code.patch 
```

现在让我们对工作代码做一些额外的工作。为了明确起见，我将继续这样做`qseries`，但是一旦您建立了补丁队列的心理模型，您就不必继续查看列表。

```
$ hg qtop # show the patch we're currently editing
working-code.patch
$ ...hack, hack, hack...
$ hg diff # show the changes that have not been incorporated into the patch
blah, blah
$ hg qrefresh # update the patch with the changes you just made
$ hg qdiff # show the top patch's diff 
```

因为您的所有工作现在都保存在补丁队列中，所以您可以取消应用这些更改并在拉入远程更改后恢复它们。通常要取消应用所有补丁，只需执行`hg qpop -a`. 只是为了显示对补丁队列的影响，我将一次将它们弹出一个。

```
$ hg qpop # unapply the top patch, U means unapplied
$ hg qseries -v
0 A migration.patch
1 U working-code.patch
$ hg qtop
migration.patch
$ hg qpop
$ hg qseries -v
0 U migration.patch
1 U working-code.patch 
```

此时，就好像您的目录中没有任何更改。做`hg fetch`. 现在您可以将您的补丁队列更改推送回去，如果有任何冲突，可以合并它们。这在概念上有点类似于 git 的变基。

```
$ hg qpush # put the first patch back on
$ hg qseries -v
0 A migration.patch
1 U working-code.patch
$ hg qfinish -a # turn all the applied patches into normal hg commits
$ hg qseries -v
0 U working-code.patch
$ hg out
migration.patch commit info... blah, blah
$ hg push # push out your changes 
```

此时，您已在保留其他本地更改的同时推出了迁移。您的其他更改在队列中的补丁中。我的大部分个人开发工作都是使用补丁队列来帮助我更好地构建我的更改。如果您想摆脱补丁队列并恢复正常样式，则必须导出更改并以“正常” mercurial 重新导入它们。

```
$ hg qpush
$ hg qseries -v
0 A working-code.patch
$ hg export qtip > temp.diff
$ rm -r .hg/patches # get rid of mq from the repository entirely
$ hg import --no-commit temp.diff # apply the changes to the working directory
$ rm temp.diff 
```

* * *

我非常沉迷于修补队列以进行开发，并且`mq`是那里最好的实现之一。同时进行多个更改的能力确实提高了您的提交的集中度和清洁度。需要一段时间才能习惯，但它与 DVCS 工作流程配合得非常好。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-10T01:35:31.860

如果您不想依赖扩展，另一种选择是在本地保留上游存储库的克隆，仅用于这些类型的集成任务。

在您的示例中，您可以简单地将更改拉入/合并到集成/上游存储库中，并将其直接推送到远程服务器。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-02-03T22:00:14.390

我通常使用的是用于提交单个文件：

```
 hg commit -m "commit message" filename 
```

万一以后，我有一个合并冲突，我还没有准备好提交我的更改，请按照以下步骤操作：

1) 创建补丁文件。

```
hg diff > changes.patch 
```

2) 仅在检查补丁文件后恢复所有未提交的更改。

```
hg revert --all 
```

3) 拉取、更新和合并到最新版本

```
hg pull -u
hg merge
hg commit -m "local merge" 
```

4) 现在只需导入您的补丁并获取您的更改。

```
hg import --no-commit changes.patch 
```

请记住在自动提交更改时使用 -no-commit 标志。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-12-21T19:42:18.410

既然你说最简单，`hg commit -i`即使提交整个文件，我也经常使用 (--interactive) 。您只需`--interactive`选择您想要的文件，而不是在命令行上输入它们的整个路径。作为额外的奖励，您甚至可以有选择地在文件中包含/排除块。

然后只是`hg push`推送新创建的提交。

我`hg commit --interactive`在此答案中提供了有关使用的更多详细信息：[https ://stackoverflow.com/a/47931672/255961](https://stackoverflow.com/a/47931672/255961)

# string - 如何从 Bash 中的路径字符串中删除文件后缀和路径部分？

> ID：125281
> 
> 赞同：467
> 
> 时间：2008-09-24T03:37:00.517
> 
> 标签：string, bash, filenames

给定一个字符串文件路径，例如`/foo/fizzbuzz.bar`，我将如何使用 bash 仅提取`fizzbuzz`所述字符串的一部分？

* * *

## 回答 #1

> 赞同：671
> 
> 时间：2008-09-24T03:54:28.167

以下是如何使用 Bash 中的 # 和 % 运算符来完成此操作。

```
$ x="/foo/fizzbuzz.bar"
$ y=${x%.bar}
$ echo ${y##*/}
fizzbuzz 
```

`${x%.bar}`也可以`${x%.*}`是删除一个点之后的所有内容或`${x%%.*}`删除第一个点之后的所有内容。

例子：

```
$ x="/foo/fizzbuzz.bar.quux"
$ y=${x%.*}
$ echo $y
/foo/fizzbuzz.bar
$ y=${x%%.*}
$ echo $y
/foo/fizzbuzz 
```

文档可以在[Bash 手册](https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html#Shell-Parameter-Expansion)中找到。寻找`${parameter%word}`和`${parameter%%word}`尾随部分匹配部分。

* * *

## 回答 #2

> 赞同：274
> 
> 时间：2008-09-24T03:38:03.663

查看 basename 命令：

```
NAME="$(basename /foo/fizzbuzz.bar .bar)" 
```

指示它删除后缀`.bar`，导致`NAME=fizzbuzz`

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2014-05-06T14:20:03.097

纯 bash，在两个单独的操作中完成：

1.  从路径字符串中删除路径：

    ```
    path=/foo/bar/bim/baz/file.gif

    file=${path##*/}  
    #$file is now 'file.gif' 
    ```

2.  从路径字符串中删除扩展名：

    ```
    base=${file%.*}
    #${base} is now 'file'. 
    ```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2014-04-11T17:07:04.220

使用 basename 我使用以下内容来实现此目的：

```
for file in *; do
    ext=${file##*.}
    fname=`basename $file $ext`

    # Do things with $fname
done; 
```

这不需要文件扩展名的先验知识，即使您的文件名在其文件名中包含点（在其扩展名前面）也可以工作；虽然它确实需要该程序`basename`，但这是 GNU coreutils 的一部分，因此它应该随任何发行版一起提供。

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2008-09-24T03:40:06.123

basename 和 dirname 函数是您所追求的：

```
mystring=/foo/fizzbuzz.bar
echo basename: $(basename "${mystring}")
echo basename + remove .bar: $(basename "${mystring}" .bar)
echo dirname: $(dirname "${mystring}") 
```

有输出：

```
basename: fizzbuzz.bar
basename + remove .bar: fizzbuzz
dirname: /foo 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2008-09-24T03:39:05.130

纯 bash 方式：

```
~$ x="/foo/bar/fizzbuzz.bar.quux.zoom"; 
~$ y=${x/\/*\//}; 
~$ echo ${y/.*/}; 
fizzbuzz 
```

此功能在“参数扩展”下的 man bash 中进行了解释。非 bash 方式比比皆是：awk、perl、sed 等等。

编辑：适用于文件*后缀*中的点并且不需要知道后缀（扩展名），但*不适*用于*名称*本身中的点。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2008-09-24T05:07:37.880

使用`basename`假设您知道文件扩展名是什么，不是吗？

而且我相信各种正则表达式建议无法处理包含多个“。”的文件名。

以下似乎应对双点。哦，还有包含“/”的文件名（只是为了好玩）

套用 Pascal 的话说，“抱歉这个脚本太长了。我没有时间把它缩短”

```
 #!/usr/bin/perl
  $fullname = $ARGV[0];
  ($path,$name) = $fullname =~ /^(.*[^\\]\/)*(.*)$/;
  ($basename,$extension) = $name =~ /^(.*)(\.[^.]*)$/;
  print $basename . "\n"; 
```

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2018-10-24T22:01:38.080

除了[此答案](https://stackoverflow.com/a/125287/3266847)中使用的[符合 POSIX 的语法](http://pubs.opengroup.org/onlinepubs/9699919799/utilities/basename.html)外，

```
basename *string* [*suffix*]
```

如在

```
basename /foo/fizzbuzz.bar .bar 
```

[GNU`basename`](https://www.gnu.org/software/coreutils/manual/coreutils.html#basename-invocation)支持另一种语法：

```
basename -s .bar /foo/fizzbuzz.bar 
```

结果相同。`-s`区别和优势在于`-a`，它支持多个参数：

```
$ basename -s .bar /foo/fizzbuzz.bar /baz/foobar.bar
fizzbuzz
foobar 
```

这甚至可以通过使用该选项将输出与 NUL 字节分隔开来使文件名安全`-z`，例如对于这些包含空格、换行符和全局字符的文件（由 引用`ls`）：

```
$ ls has*
'has'$'\n''newline.bar'  'has space.bar'  'has*.bar' 
```

读入一个数组：

```
$ readarray -d $'\0' arr < <(basename -zs .bar has*)
$ declare -p arr
declare -a arr=([0]=$'has\nnewline' [1]="has space" [2]="has*") 
```

`readarray -d`需要 Bash 4.4 或更高版本。对于旧版本，我们必须循环：

```
while IFS= read -r -d '' fname; do arr+=("$fname"); done < <(basename -zs .bar has*) 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-24T03:39:34.317

```
perl -pe 's/\..*$//;s{^.*/}{}' 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-24T11:12:06.803

如果您不能按照其他帖子中的建议使用 basename，则始终可以使用 sed。这是一个（丑陋的）例子。它不是最好的，但它通过提取想要的字符串并用想要的字符串替换输入来工作。

```
echo '/foo/fizzbuzz.bar' | sed 's|.*\/\([^\.]*\)\(\..*\)$|\1|g' 
```

这将为您提供输出

> > 嘶嘶声

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-06-19T10:35:04.550

注意建议的 perl 解决方案：它会删除第一个点之后的任何内容。

```
$ echo some.file.with.dots | perl -pe 's/\..*$//;s{^.*/}{}'
some 
```

如果你想用 perl 来做，这可以：

```
$ echo some.file.with.dots | perl -pe 's/(.*)\..*$/$1/;s{^.*/}{}'
some.file.with 
```

但是，如果您使用的是 Bash，则使用`y=${x%.*}`（或者`basename "$x" .ext`如果您知道扩展名）的解决方案要简单得多。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-11-15T00:47:41.193

基本名称会这样做，删除路径。如果给定后缀，并且它与文件的后缀匹配，它还将删除后缀，但您需要知道赋予命令的后缀。否则，您可以使用 mv 并以其他方式找出新名称应该是什么。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-08-20T18:30:44.667

将评分最高的答案与第二名的答案相结合，以获得没有完整路径的文件名：

```
$ x="/foo/fizzbuzz.bar.quux"
$ y=(`basename ${x%%.*}`)
$ echo $y
fizzbuzz 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2021-07-19T08:35:02.493

您可以使用

```
mv *<PATTERN>.jar "$(basename *<PATTERN>.jar <PATTERN>.jar).jar" 
```

例如：- 我想`-SNAPSHOT`从我的文件名中删除。对于下面使用的命令

```
 mv *-SNAPSHOT.jar "$(basename *-SNAPSHOT.jar -SNAPSHOT.jar).jar" 
```

# iphone - 如何使用 iPhone 将照片上传到服务器？

> ID：125306
> 
> 赞同：74
> 
> 时间：2008-09-24T03:43:06.117
> 
> 标签：iphone, cocoa-touch, cocoa, networking

我正在编写一个 iPhone 应用程序，它会拍照然后将其上传到服务器。如何使用 Cocoa 将照片上传到服务器？我想我在某处使用 NSUrl。

谢谢！

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2008-09-25T22:11:01.423

标题：

```
@interface EPUploader : NSObject {
    NSURL *serverURL;
    NSString *filePath;
    id delegate;
    SEL doneSelector;
    SEL errorSelector;

    BOOL uploadDidSucceed;
}

-   (id)initWithURL: (NSURL *)serverURL 
            filePath: (NSString *)filePath 
            delegate: (id)delegate 
        doneSelector: (SEL)doneSelector 
       errorSelector: (SEL)errorSelector;

-   (NSString *)filePath;

@end 
```

主要的：

```
#import "EPUploader.h"
#import <zlib.h>

static NSString * const BOUNDRY = @"0xKhTmLbOuNdArY";
static NSString * const FORM_FLE_INPUT = @"uploaded";

#define ASSERT(x) NSAssert(x, @"")

@interface EPUploader (Private)

- (void)upload;
- (NSURLRequest *)postRequestWithURL: (NSURL *)url
                             boundry: (NSString *)boundry
                                data: (NSData *)data;

- (NSData *)compress: (NSData *)data;
- (void)uploadSucceeded: (BOOL)success;
- (void)connectionDidFinishLoading:(NSURLConnection *)connection;

@end

@implementation EPUploader

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader initWithURL:filePath:delegate:doneSelector:errorSelector:] --
 *
 *      Initializer. Kicks off the upload. Note that upload will happen on a
 *      separate thread.
 *
 * Results:
 *      An instance of Uploader.
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

- (id)initWithURL: (NSURL *)aServerURL   // IN
         filePath: (NSString *)aFilePath // IN
         delegate: (id)aDelegate         // IN
     doneSelector: (SEL)aDoneSelector    // IN
    errorSelector: (SEL)anErrorSelector  // IN
{
    if ((self = [super init])) {
        ASSERT(aServerURL);
        ASSERT(aFilePath);
        ASSERT(aDelegate);
        ASSERT(aDoneSelector);
        ASSERT(anErrorSelector);

        serverURL = [aServerURL retain];
        filePath = [aFilePath retain];
        delegate = [aDelegate retain];
        doneSelector = aDoneSelector;
        errorSelector = anErrorSelector;

        [self upload];
    }
    return self;
}

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader dealloc] --
 *
 *      Destructor.
 *
 * Results:
 *      None
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

- (void)dealloc
{
    [serverURL release];
    serverURL = nil;
    [filePath release];
    filePath = nil;
    [delegate release];
    delegate = nil;
    doneSelector = NULL;
    errorSelector = NULL;

    [super dealloc];
}

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader filePath] --
 *
 *      Gets the path of the file this object is uploading.
 *
 * Results:
 *      Path to the upload file.
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

- (NSString *)filePath
{
    return filePath;
}

@end // Uploader

@implementation EPUploader (Private)

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader(Private) upload] --
 *
 *      Uploads the given file. The file is compressed before beign uploaded.
 *      The data is uploaded using an HTTP POST command.
 *
 * Results:
 *      None
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

- (void)upload
{
    NSData *data = [NSData dataWithContentsOfFile:filePath];
    ASSERT(data);
    if (!data) {
        [self uploadSucceeded:NO];
        return;
    }
    if ([data length] == 0) {
        // There's no data, treat this the same as no file.
        [self uploadSucceeded:YES];
        return;
    }

//  NSData *compressedData = [self compress:data];
//  ASSERT(compressedData && [compressedData length] != 0);
//  if (!compressedData || [compressedData length] == 0) {
//      [self uploadSucceeded:NO];
//      return;
//  }

    NSURLRequest *urlRequest = [self postRequestWithURL:serverURL
                                                boundry:BOUNDRY
                                                   data:data];
    if (!urlRequest) {
        [self uploadSucceeded:NO];
        return;
    }

    NSURLConnection * connection =
    [[NSURLConnection alloc] initWithRequest:urlRequest delegate:self];
    if (!connection) {
        [self uploadSucceeded:NO];
    }

    // Now wait for the URL connection to call us back.
}

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader(Private) postRequestWithURL:boundry:data:] --
 *
 *      Creates a HTML POST request.
 *
 * Results:
 *      The HTML POST request.
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

- (NSURLRequest *)postRequestWithURL: (NSURL *)url        // IN
                             boundry: (NSString *)boundry // IN
                                data: (NSData *)data      // IN
{
    // from http://www.cocoadev.com/index.pl?HTTPFileUpload
    NSMutableURLRequest *urlRequest =
    [NSMutableURLRequest requestWithURL:url];
    [urlRequest setHTTPMethod:@"POST"];
    [urlRequest setValue:
     [NSString stringWithFormat:@"multipart/form-data; boundary=%@", boundry]
      forHTTPHeaderField:@"Content-Type"];

    NSMutableData *postData =
    [NSMutableData dataWithCapacity:[data length] + 512];
    [postData appendData:
     [[NSString stringWithFormat:@"--%@\r\n", boundry] dataUsingEncoding:NSUTF8StringEncoding]];
    [postData appendData:
     [[NSString stringWithFormat:
       @"Content-Disposition: form-data; name=\"%@\"; filename=\"file.bin\"\r\n\r\n", FORM_FLE_INPUT]
      dataUsingEncoding:NSUTF8StringEncoding]];
    [postData appendData:data];
    [postData appendData:
     [[NSString stringWithFormat:@"\r\n--%@--\r\n", boundry] dataUsingEncoding:NSUTF8StringEncoding]];

    [urlRequest setHTTPBody:postData];
    return urlRequest;
}

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader(Private) compress:] --
 *
 *      Uses zlib to compress the given data.
 *
 * Results:
 *      The compressed data as a NSData object.
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

- (NSData *)compress: (NSData *)data // IN
{
    if (!data || [data length] == 0)
        return nil;

    // zlib compress doc says destSize must be 1% + 12 bytes greater than source.
    uLong destSize = [data length] * 1.001 + 12;
    NSMutableData *destData = [NSMutableData dataWithLength:destSize];

    int error = compress([destData mutableBytes],
                         &destSize,
                         [data bytes],
                         [data length]);
    if (error != Z_OK) {
        NSLog(@"%s: self:0x%p, zlib error on compress:%d\n",__func__, self, error);
        return nil;
    }

    [destData setLength:destSize];
    return destData;
}

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader(Private) uploadSucceeded:] --
 *
 *      Used to notify the delegate that the upload did or did not succeed.
 *
 * Results:
 *      None
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

- (void)uploadSucceeded: (BOOL)success // IN
{
    [delegate performSelector:success ? doneSelector : errorSelector
                   withObject:self];
}

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader(Private) connectionDidFinishLoading:] --
 *
 *      Called when the upload is complete. We judge the success of the upload
 *      based on the reply we get from the server.
 *
 * Results:
 *      None
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

- (void)connectionDidFinishLoading:(NSURLConnection *)connection // IN
{
    NSLog(@"%s: self:0x%p\n", __func__, self);
    [connection release];
    [self uploadSucceeded:uploadDidSucceed];
}

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader(Private) connection:didFailWithError:] --
 *
 *      Called when the upload failed (probably due to a lack of network
 *      connection).
 *
 * Results:
 *      None
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

- (void)connection:(NSURLConnection *)connection // IN
  didFailWithError:(NSError *)error              // IN
{
    NSLog(@"%s: self:0x%p, connection error:%s\n",
            __func__, self, [[error description] UTF8String]);
    [connection release];
    [self uploadSucceeded:NO];
}

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader(Private) connection:didReceiveResponse:] --
 *
 *      Called as we get responses from the server.
 *
 * Results:
 *      None
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

-(void)       connection:(NSURLConnection *)connection // IN
      didReceiveResponse:(NSURLResponse *)response     // IN
{
    NSLog(@"%s: self:0x%p\n", __func__, self);
}

/*
 *-----------------------------------------------------------------------------
 *
 * -[Uploader(Private) connection:didReceiveData:] --
 *
 *      Called when we have data from the server. We expect the server to reply
 *      with a "YES" if the upload succeeded or "NO" if it did not.
 *
 * Results:
 *      None
 *
 * Side effects:
 *      None
 *
 *-----------------------------------------------------------------------------
 */

- (void)connection:(NSURLConnection *)connection // IN
    didReceiveData:(NSData *)data                // IN
{
    NSLog(@"%s: self:0x%p\n", __func__, self);

    NSString *reply = [[[NSString alloc] initWithData:data
                                             encoding:NSUTF8StringEncoding]
                       autorelease];
    NSLog(@"%s: data: %s\n", __func__, [reply UTF8String]);

    if ([reply hasPrefix:@"YES"]) {
        uploadDidSucceed = YES;
    }
}

@end 
```

用法：

```
 [[EPUploader alloc] initWithURL:[NSURL URLWithString:@"http://yourserver.com/uploadDB.php"]
                                                     filePath:@"path/to/some/file"
                                                     delegate:self
                                                 doneSelector:@selector(onUploadDone:)
                                                errorSelector:@selector(onUploadError:)]; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2011-06-29T13:00:16.200

希望以下代码片段对您有用。我每次都使用 NSDateFormatter 和 NSDate 来获取图像的唯一名称。

注意：`'ImageUploadURL'`#define 是带有基本 url 的字符串，您需要将其替换为您的服务器 url。

//图像名称的日期格式...

```
NSDateFormatter *format = [[NSDateFormatter alloc] init];
    [format setDateFormat:@"yyyyMMddHHmmss"];

NSDate *now = [[NSDate alloc] init];

NSString *imageName = [NSString stringWithFormat:@"Image_%@", [format stringFromDate:now]];

[now release];
[format release];

NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
[request setURL:[NSURL URLWithString:ImageUploadURL]];
[request setHTTPMethod:@"POST"];

/*
 Set Header and content type of your request.
 */
NSString *boundary = [NSString stringWithString:@"---------------------------Boundary Line---------------------------"];
NSString *contentType = [NSString stringWithFormat:@"multipart/form-data; boundary=%@",boundary];
[request addValue:contentType forHTTPHeaderField: @"Content-Type"];

/*
 now lets create the body of the request.
 */
NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];    
[body appendData:[[NSString stringWithFormat:@"Content-Disposition: form-data; name=\"userfile\"; filename=\"%@.jpg\"\r\n", imageName] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithString:@"Content-Type: application/octet-stream\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[NSData dataWithData:UIImageJPEGRepresentation(image, 90)]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithFormat:@"geotag=%@&", [self _currentLocationMetadata]] dataUsingEncoding:NSUTF8StringEncoding]];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];

// set body with request.
[request setHTTPBody:body];
[request addValue:[NSString stringWithFormat:@"%d", [body length]] forHTTPHeaderField:@"Content-Length"];

// now lets make the connection to the web
[NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil]; 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T21:59:49.780

Create an NSURLRequest and then use NSURLConnection to send it off to your server.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-10-20T01:12:17.087

看起来[Three20](http://github.com/joehewitt/three20)库支持将图像发布到 HTTP 服务器。

见[TTURLRequest.m](http://github.com/joehewitt/three20/blob/master/src/TTURLRequest.m)

它是在 Apache 2.0 许可下发布的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-05-09T10:42:43.917

```
- (void) uploadImage :(NSString *) strRequest
{
if([appdel checkNetwork]==TRUE)
{

NSString *urlString =[NSString stringWithFormat:@"Enter Url........."];
    NSLog(@"Upload %@",urlString);
// setting up the request object now

isUploadImage=TRUE;
totalsize=[[strRequest dataUsingEncoding:NSUTF8StringEncoding]length];

NSMutableURLRequest *request = [[[NSMutableURLRequest alloc] init] autorelease];
[request setURL:[NSURL URLWithString:urlString]];
[request setHTTPMethod:@"POST"];

NSString *boundary = [NSString stringWithString:@"_1_19330907_1317415362628"];
NSString *contentType = [NSString stringWithFormat:@"multipart/mixed; boundary=%@",boundary];
[request setValue:contentType forHTTPHeaderField: @"Content-Type"];
[request setValue:@"text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2" forHTTPHeaderField:@"Accept"];
[request setValue:@"2667" forHTTPHeaderField:@"Content-Length"];

/*
 now lets create the body of the post
 */
NSMutableData *body = [NSMutableData data];
[body appendData:[[NSString stringWithFormat:@"\r\n--%@\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];    

[body appendData:[[NSString stringWithString:@"Content-Type: application/json\r\n\r\n"] dataUsingEncoding:NSUTF8StringEncoding]];

//[body appendData:[NSData dataWithData:imageData]];

[body appendData:[strRequest dataUsingEncoding:NSUTF8StringEncoding]];

[body appendData:[[NSString stringWithFormat:@"\r\n--%@--\r\n",boundary] dataUsingEncoding:NSUTF8StringEncoding]];

// setting the body of the post to the reqeust
[request setHTTPBody:body];

theConnection=[[NSURLConnection alloc] initWithRequest:request delegate:self];
if (theConnection) 
    webData = [[NSMutableData data] retain];
else 
    NSLog(@"No Connection");    
}

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-02T06:43:51.547

如果你想上传多张图片，那么[这个演示](http://iphoneapp-dev.blogspot.com/2011/05/this-example-shows-how-to-upload-images.html)是不错的选择。

# firefox - 如何将可编写脚本的 Mozilla 插件实例与其 NObject 关联？

> ID：125308
> 
> 赞同：1
> 
> 时间：2008-09-24T03:43:15.400
> 
> 标签：firefox, plugins, npapi

我在将正在编写的插件中调用的方法与适当的插件实例相关联时遇到了问题。[http://developer.mozilla.org/en/Gecko_Plugin_API_Reference/Scripting_plugins](http://developer.mozilla.org/en/Gecko_Plugin_API_Reference/Scripting_plugins)上的文档没有提供足够的信息来真正有用。

简而言之，我试图了解插件应该返回哪个可编写脚本的对象，以响应对 NPP_GetValue 的调用，其变量参数等于 NPPpluginScriptableNPObject。我猜测插件的每个实例都应该有一个 NPObject 实例，但是 NPClass 中的 invoke() 方法应该如何从作为参数给出的可编写脚本的 NPObject 中找到插件实例（NPP）？我想我可以实现一个查找表来做到这一点，但我觉得我缺少一些明显的东西。

我将指向 C++ 类实例的指针（该实例实现插件的功能）存储在 NPP 的 pdata 成员中，在 NPP_New() 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T16:39:29.137

我想我正在回答我自己的问题......

我找到的解决方案（我仍然希望对其有效性发表评论，特别是如果您认为有更好的方法）是分配一个 NPObject 派生结构，该结构在我公开的 allocate() 函数中具有指向我的实现类的指针从我的插件到 Firefox。然后，我在 NPP_New() 的 NPP 的 pdata 成员中存储指向该 NPObject 的指针。

在invoke() 中，我将获得的NPObject 指针转换为派生结构的附加成员，以便获得指向实现类实例的指针。

据我所知，这就是设计的意图 - NPObject 对象是它们指向的 NPClass 的实例，它们通过处理这些实体的 NPClass 函数指针实现方法和属性，并且任何私有数据都应该由实现分配和释放，其格式未指定。

它看起来像这样：

```
 static NPClass refObject = {
    NP_CLASS_STRUCT_VERSION,
    My_Allocate,
    My_Deallocate,
    NULL,
    My_HasMethod,
    My_Invoke,
    My_InvokeDefault,
    My_HasProperty,
    My_GetProperty,
    NULL,
    NULL,
};

class MyImplClass {
    // Implementation goes here
};

struct MyNPObject : public NPObject {
    MyImplClass *my_impl_instance;
};

// This is just a bit of memory management - Mozilla wants us to allocate our own memory:
NPObject *My_Allocate(NPP inst, NPClass *)
{
    // We initialize the structure in NPP_New() below
    return (NPObject *)malloc(sizeof(MyNPObject));
}

NPError NPP_New( NPMIMEType pluginType, NPP instance, uint16 mode, int16 argc,
             char* argn[], char* argv[], NPSavedData* saved )
{
    NPObject *scriptable_object = npnfuncs->createobject(instance, &refObject);
    npnfuncs->retainobject(scriptable_object);
    MyImplClass *new_player = new MyImplClass(); 

    instance->pdata = scriptable_object;
    ((MyNPObject*)instance->pdata)->my_impl_instance = new_player;
    return NPERR_NO_ERROR; 
```

}

# java - 如何在 Windows 下以低优先级从 Eclipse 启动？

> ID：125313
> 
> 赞同：6
> 
> 时间：2008-09-24T03:46:24.720
> 
> 标签：java, eclipse, taskmanager

我正在从 Eclipse（在 Windows 上）运行占用大量 CPU 时间的程序。为了避免让我的整个机器陷入困境，我使用任务管理器将优先级设置为低。然而，这是一个繁琐的手动过程。Eclipse 有没有办法自动设置这个优先级？

编辑：我意识到每个特定的启动器（Java、Python 等）都有自己的配置方法，所以我将把这个问题限制在 Java 领域，这是我最需要的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-12-08T18:33:07.150

我在 Windows 上遇到了同样的问题——启动使用所有 CPU（线程并行作业）的子进程，但我希望在我的 Windows 开发环境中具有良好的响应能力。

**解决方案**：启动多个作业后：

DOS命令>> `wmic process where name="javaw.exe" CALL setpriority "below normal"`

不，这不会影响 eclipse.exe 进程。

**Java 解决方案**：将此代码插入 CPU 密集型程序以降低它们自己的 Windows 优先级：

```
public static void lowerMyProcessPriority() throws IOException {
    String pid = ManagementFactory.getRuntimeMXBean().getName();
    int p = pid.indexOf("@");
    if (p > 0) pid = pid.substring(0,p);
    String cmd = "wmic process where processid=<pid> CALL setpriority".replace("<pid>", pid);
    List<String> ls = new ArrayList<>(Arrays.asList(cmd.split(" ")));
    ls.add("\"below normal\"");
    ProcessBuilder pb = new ProcessBuilder(ls);
    pb.start();
} 
```

是的，经过测试。适用于Win7。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T20:04:46.023

我假设您使用外部工具启动这些程序。如果是这样，那么您可以修改启动命令以使用`start /low`前面描述的 hack。但是，如果这些应用程序具有特殊的启动类型（如 Java 应用程序或类似的），那么您就有麻烦了。真正改变这一点的唯一方法是打开 Eclipse 的源代码，找到该启动类型及其调度任务的位置，然后将其修改为使用`start /low`. 抱歉，但我认为没有简单的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-11T19:18:55.067

I spent some time a while back to investigate this. There is no method *inside* Java to lower the priority (as far as I could see), so you need to employ the "start /min" approach. I didn't try to get that working.

Instead I got a multi-kernel processor. This gives room for other stuff, even if a Java program runs amok on one kernel.

Strongly recommended.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T03:51:24.053

更好的选择是配置 Eclipse 将使用的内存量：http: [//www.eclipsezone.com/eclipse/forums/t61618.html](http://www.eclipsezone.com/eclipse/forums/t61618.html)

并在谷歌上搜索 JVM 的 -Xmx 和 -Xms 参数（您可以在 Eclipse中为运行*者配置）。*

亲切的问候

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-05-11T17:49:47.253

我也想要这个，奇怪的是这是不可能的，真的。我知道您可以设置线程优先级，但我认为在 Windows 领域，线程都被安排在进程优先级“内部”，可以这么说。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-01-31T06:39:31.740

我在 Linux 中遇到了同样的问题并发现了这个： [http ://tech.stolsvik.com/2010/01/linux-java-thread-priorities-workaround.html](http://tech.stolsvik.com/2010/01/linux-java-thread-priorities-workaround.html)

有趣的一点是关于如何将 Java 线程优先级转换为 OS 优先级。这已经解决了我的问题，它也可以帮助你。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-11-08T21:30:14.577

使用操作系统工具或伪造的 java.exe 来捕获 eclipse 启动器生成的非常长的 javaw.exe 命令。

绕过 eclipse.exe 并直接启动 javaw.exe。

一旦你有 javaw.exe 直接正确启动。

> START /BELOWNORMAL \path\javaw.exe 大量参数到加载工作区

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2010-09-01T08:01:19.413

If you need it only in development you can set the priority of all other processes to high...

# testing - Internet Explorer 中的 Selenium 远程控制 HTML 源提取

> ID：125314
> 
> 赞同：2
> 
> 时间：2008-09-24T03:46:28.497
> 
> 标签：testing, selenium

Selenium Remote Control 有一个“get_html_source”方法，它以字符串的形式返回当前页面的源。

AFAIK，此方法适用于 Firefox 和 Safari 的所有情况。但是当它在 Internet Explorer 中调用时，它会返回一个不正确的源。

有谁知道这是否是 Selenium 或 Internet Explorer 的错误，是否有修复？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T04:03:27.597

我 99% 确定 get_html_source 使用浏览器的 innerHTML 属性。InnerHTML 返回浏览器对文档的内部表示，并且在平台之间总是不一致和“不稳定”。

您可以通过临时将以下 onload 属性添加到页面的 body 标记来测试这一点。

```
onload="var oArea = document.createElement('textarea');oArea.rows=80;oArea.cols=80;oArea.value = document.getElementsByTagName('html')[0].innerHTML;document.getElementsByTagName('body')[0].appendChild(oArea)" 
```

这将使用文档的 innerHTML 在页面底部添加一个文本区域。如果您看到相同的“不正确”HTML 源代码，您就知道 IE 是这里的罪魁祸首。

如果您使用有效标记，可能的解决方法是通过 HTML Tidy 或其他一些清洁器运行源代码。我不知道有什么可以在浏览器之间为您提供一致的渲染。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T19:37:31.210

谢谢艾伦。事实证明，这是不同浏览器实现 innerHTML 的问题。

对于与列表有关的标签，例如

*   , 结束标签是可选的。

    safari 和 firefox 等浏览器使用各自的 innerHTML 方法获取结束标记，但 Internet Explorer 的 innerHTML 方法会忽略它们。

    因为列表是结构化的，例如

    *   苹果
    *   梨

    html 源字符串上的正则表达式替换应该可以解决问题。

# c# - 'using' 指令应该在命名空间内部还是外部？

> ID：125319
> 
> 赞同：2282
> 
> 时间：2008-09-24T03:49:50.173
> 
> 标签：c#, .net, namespaces, stylecop, code-organization

我一直在通过一些 C# 代码运行[StyleCop](http://en.wikipedia.org/wiki/StyleCop)，它不断报告我的`using`指令应该在命名空间内。

`using`将指令放在命名空间内部而不是外部是否有技术原因？

* * *

## 回答 #1

> 赞同：2307
> 
> 时间：2008-09-30T02:33:54.337

两者之间实际上存在（细微的）差异。假设您在 File1.cs 中有以下代码：

```
// File1.cs
using System;
namespace Outer.Inner
{
    class Foo
    {
        static void Bar()
        {
            double d = Math.PI;
        }
    }
} 
```

现在假设有人将另一个文件（File2.cs）添加到项目中，如下所示：

```
// File2.cs
namespace Outer
{
    class Math
    {
    }
} 
```

编译器在查看命名空间之外的`Outer`那些指令之前进行搜索，因此它会找到而不是. 不幸的是（或者幸运的是？），没有成员，所以 File1 现在坏了。`using``Outer.Math``System.Math``Outer.Math``PI`

如果您将`using`命名空间声明放在内部，则会发生这种情况，如下所示：

```
// File1b.cs
namespace Outer.Inner
{
    using System;
    class Foo
    {
        static void Bar()
        {
            double d = Math.PI;
        }
    }
} 
```

现在编译器在 search ， finds`System`之前搜索，一切都很好。`Outer``System.Math`

有些人会争辩说，`Math`这对于用户定义的类来说可能是一个坏名字，因为 ; 中已经有一个了`System`。这里的重点只是存在*差异*，它会影响代码的可维护性。

`Foo`注意到如果在 namespace 中会发生什么也很有趣`Outer`，而不是`Outer.Inner`. 在这种情况下，添加`Outer.Math`File2 会破坏 File1，无论去哪里`using`。这意味着编译器在查看任何`using`指令之前会搜索最里面的封闭命名空间。

* * *

## 回答 #2

> 赞同：526
> 
> 时间：2013-04-18T21:00:08.257

这个线程已经有一些很好的答案，但我觉得我可以通过这个额外的答案带来更多细节。

首先，请记住带有句点的命名空间声明，例如：

```
namespace MyCorp.TheProduct.SomeModule.Utilities
{
    ...
} 
```

完全等同于：

```
namespace MyCorp
{
    namespace TheProduct
    {
        namespace SomeModule
        {
            namespace Utilities
            {
                ...
            }
        }
    }
} 
```

如果您愿意，您可以`using`在所有这些级别上放置指令。（当然，我们希望`using`s 只在一个地方，但根据语言这是合法的。）

解析隐含类型的规则可以大致如下表述：**首先在最里面的“范围”中搜索匹配项，如果没有找到匹配项，则转到下一级范围并在那里搜索，依此类推**，直到找到匹配项。如果在某个级别找到多个匹配项，如果其中一种类型来自当前程序集，则选择该类型并发出编译器警告。否则，放弃（编译时错误）。

现在，让我们在一个包含两个主要约定的具体示例中明确说明这意味着什么。

**(1) 外用：**

```
using System;
using System.Collections.Generic;
using System.Linq;
//using MyCorp.TheProduct;  <-- uncommenting this would change nothing
using MyCorp.TheProduct.OtherModule;
using MyCorp.TheProduct.OtherModule.Integration;
using ThirdParty;

namespace MyCorp.TheProduct.SomeModule.Utilities
{
    class C
    {
        Ambiguous a;
    }
} 
```

在上述情况下，要找出是什么类型`Ambiguous`，搜索按以下顺序进行：

1.  内部嵌套类型`C`（包括继承的嵌套类型）
2.  当前命名空间中的类型`MyCorp.TheProduct.SomeModule.Utilities`
3.  命名空间中的类型`MyCorp.TheProduct.SomeModule`
4.  输入`MyCorp.TheProduct`
5.  输入`MyCorp`
6.  *空*命名空间（全局命名空间）中的类型
7.  输入`System`, `System.Collections.Generic`, `System.Linq`, `MyCorp.TheProduct.OtherModule`, `MyCorp.TheProduct.OtherModule.Integration`, 和`ThirdParty`

另一个约定：

**(2) 里面有 usings：**

```
namespace MyCorp.TheProduct.SomeModule.Utilities
{
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using MyCorp.TheProduct;                           // MyCorp can be left out; this using is NOT redundant
    using MyCorp.TheProduct.OtherModule;               // MyCorp.TheProduct can be left out
    using MyCorp.TheProduct.OtherModule.Integration;   // MyCorp.TheProduct can be left out
    using ThirdParty;

    class C
    {
        Ambiguous a;
    }
} 
```

`Ambiguous`现在，按以下顺序搜索类型：

1.  内部嵌套类型`C`（包括继承的嵌套类型）
2.  当前命名空间中的类型`MyCorp.TheProduct.SomeModule.Utilities`
3.  输入`System`, `System.Collections.Generic`, `System.Linq`, `MyCorp.TheProduct`, `MyCorp.TheProduct.OtherModule`, `MyCorp.TheProduct.OtherModule.Integration`, 和`ThirdParty`
4.  命名空间中的类型`MyCorp.TheProduct.SomeModule`
5.  输入`MyCorp`
6.  *空*命名空间（全局命名空间）中的类型

（请注意，这`MyCorp.TheProduct`是“3.”的一部分，因此在“4.”和“5.”之间不需要。）

**结束语**

无论您将 usings 放在命名空间声明内部还是外部，总有可能有人稍后将具有相同名称的新类型添加到具有更高优先级的命名空间之一。

此外，如果嵌套命名空间与类型同名，则可能会导致问题。

将 usings 从一个位置移动到另一个位置总是很危险的，因为搜索层次结构会发生变化，并且可能会找到另一种类型。因此，选择一种约定并坚持下去，这样您就不必移动 usings 了。

默认情况下，Visual Studio 的模板将 usings放在命名空间*之外*（例如，如果您让 VS 在新文件中生成新类）。

*在外部*使用 usings 的一个（微小）优势是您可以将 using 指令用于全局属性，例如，`[assembly: ComVisible(false)]`而不是`[assembly: System.Runtime.InteropServices.ComVisible(false)]`.

* * *

## 回答 #3

> 赞同：206
> 
> 时间：2008-09-24T03:52:23.973

将它放在命名空间中会使声明成为文件的该命名空间的本地声明（如果文件中有多个命名空间），但如果每个文件只有一个命名空间，那么无论它们是放在外面还是放在外面都没有太大区别命名空间内。

```
using ThisNamespace.IsImported.InAllNamespaces.Here;

namespace Namespace1
{ 
   using ThisNamespace.IsImported.InNamespace1.AndNamespace2;

   namespace Namespace2
   { 
      using ThisNamespace.IsImported.InJustNamespace2;
   }       
}

namespace Namespace3
{ 
   using ThisNamespace.IsImported.InJustNamespace3;
} 
```

* * *

## 回答 #4

> 赞同：64
> 
> 时间：2008-09-24T03:53:21.787

根据[Hanselman - Using Directive and Assembly Loading...](http://www.hanselman.com/blog/BackToBasicsDoNamespaceUsingDirectivesAffectAssemblyLoading.aspx)和其他此类文章在技术上没有区别。

我的偏好是将它们放在命名空间之外。

* * *

## 回答 #5

> 赞同：59
> 
> 时间：2009-09-14T15:17:10.533

根据 StyleCop 文档：

SA1200: Using DirectivesMustBePlacedWithinNamespace

原因 AC# using 指令放置在命名空间元素之外。

规则描述 当 using 指令或 using-alias 指令放置在命名空间元素之外时，将违反此规则，除非文件不包含任何命名空间元素。

例如，以下代码将导致两次违反此规则。

```
using System;
using Guid = System.Guid;

namespace Microsoft.Sample
{
    public class Program
    {
    }
} 
```

但是，以下代码不会导致任何违反此规则的行为：

```
namespace Microsoft.Sample
{
    using System;
    using Guid = System.Guid;

    public class Program
    {
    }
} 
```

此代码将编译干净，没有任何编译器错误。但是，尚不清楚分配的是哪个版本的 Guid 类型。如果将 using 指令移到命名空间内，如下所示，将出现编译器错误：

```
namespace Microsoft.Sample
{
    using Guid = System.Guid;
    public class Guid
    {
        public Guid(string s)
        {
        }
    }

    public class Program
    {
        public static void Main(string[] args)
        {
            Guid g = new Guid("hello");
        }
    }
} 
```

代码因以下编译器错误而失败，在包含的行中找到`Guid g = new Guid("hello");`

CS0576：命名空间“Microsoft.Sample”包含与别名“Guid”冲突的定义

该代码为 System.Guid 类型创建了一个别名，称为 Guid，并且还创建了自己的类型，称为 Guid，具有匹配的构造函数接口。稍后，代码会创建一个 Guid 类型的实例。要创建此实例，编译器必须在 Guid 的两个不同定义之间进行选择。当 using-alias 指令放在命名空间元素之外时，编译器将选择本地命名空间内定义的 Guid 的本地定义，而完全忽略命名空间外定义的 using-alias 指令。不幸的是，这在阅读代码时并不明显。

但是，当 using-alias 指令位于命名空间内时，编译器必须在两个不同的、冲突的 Guid 类型之间进行选择，这两种类型都定义在同一个命名空间内。这两种类型都提供了匹配的构造函数。编译器无法做出决定，因此它会标记编译器错误。

将 using-alias 指令放在命名空间之外是一种不好的做法，因为在这种情况下可能会导致混淆，在这种情况下，实际使用的是哪个版本的类型并不明显。这可能会导致可能难以诊断的错误。

在命名空间元素中放置 using-alias 指令可以消除此错误的来源。

2.  多个命名空间

在单个文件中放置多个命名空间元素通常不是一个好主意，但如果这样做了，最好将所有 using 指令放置在每个命名空间元素中，而不是全局放置在文件顶部。这将严格限定命名空间，也有助于避免上述行为。

重要的是要注意，当使用放置在命名空间之外的 using 指令编写代码时，在命名空间内移动这些指令时应小心，以确保这不会改变代码的语义。如上所述，在命名空间元素中放置 using-alias 指令允许编译器以在将指令放置在命名空间之外时不会发生的方式在冲突类型之间进行选择。

如何修复违规 要修复违反此规则的行为，请在命名空间元素中移动所有 using 指令和 using-alias 指令。

* * *

## 回答 #6

> 赞同：37
> 
> 时间：2012-10-10T18:47:48.190

当您希望使用别名时，在命名空间内放置 using 语句会出现问题。别名不能从前面的`using`语句中受益，并且必须是完全限定的。

考虑：

```
namespace MyNamespace
{
    using System;
    using MyAlias = System.DateTime;

    class MyClass
    {
    }
} 
```

相对：

```
using System;

namespace MyNamespace
{
    using MyAlias = DateTime;

    class MyClass
    {
    }
} 
```

如果您有一个冗长的别名，例如以下（这就是我发现问题的方式），这可能会特别明显：

```
using MyAlias = Tuple<Expression<Func<DateTime, object>>, Expression<Func<TimeSpan, object>>>; 
```

使用`using`命名空间内的语句，它突然变成：

```
using MyAlias = System.Tuple<System.Linq.Expressions.Expression<System.Func<System.DateTime, object>>, System.Linq.Expressions.Expression<System.Func<System.TimeSpan, object>>>; 
```

不漂亮。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2019-06-05T09:25:22.507

我遇到的一个皱纹（其他答案中没有涉及）：

假设您有这些命名空间：

*   东西。其他
*   父母.某事.其他

当您在 a 之外使用时`using Something.Other` *，*`namespace Parent`它指的是第一个（Something.Other）。

但是，如果您*在*该命名空间声明中使用它，它指的是第二个（Parent.Something.Other）！

有一个简单的解决方案：添加“ `global::`”前缀：[docs](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/namespaces/how-to-use-the-global-namespace-alias)

```
namespace Parent
{
   using global::Something.Other;
   // etc
} 
```

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2016-09-17T10:32:55.697

正如 Jeppe Stig Nielsen[所说](https://stackoverflow.com/a/16092975/2707705)，这个线程已经有了很好的答案，但我认为这个相当明显的微妙之处也值得一提。

`using`在命名空间内指定的指令可以缩短代码，因为它们不需要像在外部指定时那样完全限定。

以下示例有效，因为类型`Foo`和`Bar`都在同一个全局命名空间中，`Outer`.

假设代码文件*Foo.cs*：

```
namespace Outer.Inner
{
    class Foo { }
} 
```

和*Bar.cs*：

```
namespace Outer
{
    using Outer.Inner;

    class Bar
    {
        public Foo foo;
    }
} 
```

这可能会省略`using`指令中的外部命名空间，简而言之：

```
namespace Outer
{
    using Inner;

    class Bar
    {
        public Foo foo;
    }
} 
```

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2018-08-24T15:28:53.650

我认为其他答案未涵盖的另一个微妙之处是当您有一个具有相同名称的类和命名空间时。

当您在命名空间内进行导入时，它将找到该类。如果导入在命名空间之外，那么导入将被忽略，并且类和命名空间必须是完全限定的。

```
//file1.cs
namespace Foo
{
    class Foo
    {
    }
}

//file2.cs
namespace ConsoleApp3
{
    using Foo;
    class Program
    {
        static void Main(string[] args)
        {
            //This will allow you to use the class
            Foo test = new Foo();
        }
    }
}

//file2.cs
using Foo; //Unused and redundant    
namespace Bar
{
    class Bar
    {
        Bar()
        {
            Foo.Foo test = new Foo.Foo();
            Foo test = new Foo(); //will give you an error that a namespace is being used like a class.
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2018-06-03T12:38:41.897

技术原因在答案中进行了讨论，我认为最终涉及个人喜好，因为差异并不*大*，并且两者都有权衡。Visual Studio 用于创建`.cs`文件的默认模板使用`using`命名空间之外的指令，例如

可以通过在项目文件的根目录中`using`添加文件来调整 stylecop 以检查命名空间之外的指令：`stylecop.json`

```
{
  "$schema": "https://raw.githubusercontent.com/DotNetAnalyzers/StyleCopAnalyzers/master/StyleCop.Analyzers/StyleCop.Analyzers/Settings/stylecop.schema.json",
    "orderingRules": {
      "usingDirectivesPlacement": "outsideNamespace"
    }
  }
} 
```

您可以在解决方案级别创建此配置文件并将其作为“现有链接文件”添加到您的项目中，以便在您的所有项目中共享配置。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-07-31T13:48:21.170

通常，外部`using`指令（例如 System 和 Microsoft 命名空间）应放在指令之外*。***除非另有说明，否则**`namespace`它们是应在所有情况下应用的默认值。这应该包括您自己组织的任何不属于当前项目的内部库，或引用同一项目中其他主要命名空间的指令。任何引用当前项目和命名空间中其他模块的指令都应该放在**指令内**。这有两个特定的功能：**`using``using`**`namespace`****

 *****   它提供了本地模块和“其他”模块之间的视觉区别，即其他所有模块。
*   它将本地指令的范围限定为**优先**于全局指令应用。

后一个原因很重要。这意味着更难引入不明确的参考问题，而这些问题可能由不比**重构代码**更重要的更改引入。也就是说，您将一个方法从一个文件移动到另一个文件，然后突然出现一个以前不存在的错误。通俗地说，一个“heisenbug”——在历史上极其难以追踪。

* * *

## 回答 #12

> 赞同：-7
> 
> 时间：2014-10-14T21:30:07.603

如果源解决方案中使用的**默认**使用即“*引用*”应该在命名空间之外，而那些**“新添加的引用”**是一个很好的做法，那么最好将其放在命名空间内。这是为了区分正在添加的引用。

# java - 如何使用固定数量的工作线程实现简单线程

> ID：125333
> 
> 赞同：50
> 
> 时间：2008-09-24T03:52:45.253
> 
> 标签：java, multithreading, concurrency

我正在寻找实现以下内容的最简单、最直接的方法：

*   主程序实例化工作线程来执行任务。
*   只有`n`任务可以同时运行。
*   达到时`n`，将不再启动任何工作线程，直到运行线程数回落到`n`.

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2008-09-24T04:00:24.080

我认为[Executors.newFixedThreadPool](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html#newFixedThreadPool(int))符合您的要求。有许多不同的方法可以使用生成的 ExecutorService，这取决于您是否希望将结果返回到主线程，或者任务是否完全独立，以及您是否有一组任务要预先执行，或者任务是否排队以响应某些事件。

```
 Collection<YourTask> tasks = new ArrayList<YourTask>();
  YourTask yt1 = new YourTask();
  ...
  tasks.add(yt1);
  ...
  ExecutorService exec = Executors.newFixedThreadPool(5);
  List<Future<YourResultType>> results = exec.invokeAll(tasks); 
```

或者，如果您有一个新的异步任务要执行以响应某个事件，您可能只想使用 ExecutorService 的简单`execute(Runnable)`方法。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2008-09-24T09:54:02.543

```
/* Get an executor service that will run a maximum of 5 threads at a time: */
ExecutorService exec = Executors.newFixedThreadPool(5);
/* For all the 100 tasks to be done altogether... */
for (int i = 0; i < 100; i++) {
    /* ...execute the task to run concurrently as a runnable: */
    exec.execute(new Runnable() {
        public void run() {
            /* do the work to be done in its own thread */
            System.out.println("Running in: " + Thread.currentThread());
        }
    });
}
/* Tell the executor that after these 100 steps above, we will be done: */
exec.shutdown();
try {
    /* The tasks are now running concurrently. We wait until all work is done, 
     * with a timeout of 50 seconds: */
    boolean b = exec.awaitTermination(50, TimeUnit.SECONDS);
    /* If the execution timed out, false is returned: */
    System.out.println("All done: " + b);
} catch (InterruptedException e) { e.printStackTrace(); } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2008-09-24T04:02:11.640

[Executors.newFixedThreadPool(int)](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html#newFixedThreadPool(int))

```
Executor executor = Executors.newFixedThreadPool(n);

Runnable runnable = new Runnable() {
 public void run() {
  // do your thing here
 }
}

executor.execute(runnable); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-24T03:59:04.207

使用 Executor 框架；即[newFixedThreadPool(N)](http://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html#newFixedThreadPool(int))

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-31T17:55:29.210

1.  如果您的任务队列不是无限的并且任务可以在更短的时间间隔内完成，您可以使用`Executors.newFixedThreadPool(n)`; 正如专家建议的那样。

    此解决方案的唯一缺点是任务队列大小不受限制。你无法控制它。任务队列中的大量堆积会降低应用程序的性能，并且在某些情况下可能会导致内存不足。

2.  如果您想使用`ExecutorService`和启用***`work stealing`***空闲工作线程通过窃取任务队列中的任务来分担繁忙工作线程的工作负载的机制。它将返回 ForkJoinPool 类型的 Executor Service。

    > 公共静态`ExecutorService newWorkStealingPool`（int 并行性）
    > 
    > 创建一个线程池来维护足够的线程来支持给定的并行级别，并且可以使用多个队列来减少争用。并行度级别对应于主动参与或可参与任务处理的最大线程数。实际线程数可能会动态增长和收缩。工作窃取池不保证提交任务的执行顺序。

3.  我更喜欢`ThreadPoolExecutor`API 的灵活性来控制许多参数，这些参数控制流任务的执行。

    ```
    ThreadPoolExecutor(int corePoolSize, 
                           int maximumPoolSize, 
                           long keepAliveTime, 
                           TimeUnit unit, 
                           BlockingQueue<Runnable> workQueue, 
                           ThreadFactory threadFactory,
                           RejectedExecutionHandler handler) 
    ```

在您的情况下，同时设置`corePoolSize and maximumPoolSize as N`. 在这里，您可以控制任务队列大小，定义自己的自定义线程工厂和拒绝处理程序策略。

查看相关的 SE 问题以动态控制池大小：

[动态线程池](https://stackoverflow.com/questions/32527078/dynamic-thread-pool/32527532#32527532)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T04:05:55.923

如果你想自己动手：

```
private static final int MAX_WORKERS = n;
private List<Worker> workers = new ArrayList<Worker>(MAX_WORKERS);

private boolean roomLeft() {
    synchronized (workers) {
        return (workers.size() < MAX_WORKERS);
    }
}

private void addWorker() {
    synchronized (workers) {
        workers.add(new Worker(this));
    }
}

public void removeWorker(Worker worker) {
    synchronized (workers) {
        workers.remove(worker);
    }
}

public Example() {
    while (true) {
        if (roomLeft()) {
            addWorker();
        } 
    }
} 
```

Worker 是扩展 Thread 的类。每个工人将调用这个类的 removeWorker 方法，将自己作为参数传入，当它完成它的事情时。

话虽如此，Executor 框架看起来好多了。

编辑：任何人都愿意解释为什么这很糟糕，而不是仅仅降低它？

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T04:14:34.683

正如其他人在这里提到的那样，最好的办法是使用[Executors](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/Executors.html)类创建一个线程池：

但是，如果你想自己动手，这段代码应该让你知道如何继续。基本上，只需将每个新线程添加到线程组，并确保组中的活动线程永远不会超过 N：

```
Task[] tasks = getTasks(); // array of tasks to complete
ThreadGroup group = new ThreadGroup();
int i=0;
while( i<tasks.length || group.activeCount()>0 ) {
    if( group.activeCount()<N && i<tasks.length ) {
        new TaskThread(group, tasks[i]).start();
        i++;
    } else {
        Thread.sleep(100);
    }
} 
```

# c# - 您如何在 .NET 中进行模拟？

> ID：125341
> 
> 赞同：146
> 
> 时间：2008-09-24T03:55:09.147
> 
> 标签：c#, .net, impersonation

是否有一种简单的开箱即用方式来模拟 .NET 中的用户？

到目前为止，我一直在使用[代码项目](http://www.codeproject.com/KB/cs/zetaimpersonator.aspx)中的这个类来满足我的所有模拟要求。

使用 .NET Framework 是否有更好的方法？

我有一个用户凭据集（用户名、密码、域名），它代表我需要模拟的身份。

* * *

## 回答 #1

> 赞同：320
> 
> 时间：2011-08-30T21:39:17.017

.NET 空间中的“模拟”通常意味着在特定用户帐户下运行代码。与通过用户名和密码访问该用户帐户相比，这是一个有点不同的概念，尽管这两个想法经常结合在一起。我将描述它们，然后解释如何使用我的[SimpleImpersonation](https://github.com/mj1856/SimpleImpersonation)库，它在内部使用它们。

## 冒充

用于模拟的 API 在 .NET 中通过`System.Security.Principal`命名空间提供：

*   较新的代码（.NET 4.6+、.NET Core 等）通常应该使用[`WindowsIdentity.RunImpersonated`](https://docs.microsoft.com/dotnet/api/system.security.principal.windowsidentity.runimpersonated)，它接受用户帐户令牌的句柄，然后是要执行的代码的`Action`或。`Func<T>`

    ```
    WindowsIdentity.RunImpersonated(tokenHandle, () =>
    {
        // do whatever you want as this user.
    }); 
    ```

    或者

    ```
    var result = WindowsIdentity.RunImpersonated(tokenHandle, () =>
    {
        // do whatever you want as this user.
        return result;
    }); 
    ```

*   较早的代码使用该[`WindowsIdentity.Impersonate`](https://docs.microsoft.com/dotnet/api/system.security.principal.windowsidentity.impersonate)方法来检索`WindowsImpersonationContext`对象。这个对象实现`IDisposable`了，所以通常应该从一个`using`块中调用。

    ```
    using (WindowsImpersonationContext context = WindowsIdentity.Impersonate(tokenHandle))
    {
        // do whatever you want as this user.
    } 
    ```

    虽然此 API 在 .NET Framework 中仍然存在，但通常应避免使用，并且在 .NET Core 或 .NET Standard 中不可用。

## 访问用户帐户

在 Windows 中使用用户名和密码访问用户帐户的 API 是[`LogonUser`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa378184.aspx)- 这是一个 Win32 本机 API。目前没有用于调用它的内置 .NET API，因此必须求助于 P/Invoke。

```
[DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Unicode)]
internal static extern bool LogonUser(String lpszUsername, String lpszDomain, String lpszPassword, int dwLogonType, int dwLogonProvider, out IntPtr phToken); 
```

这是基本的调用定义，但是在生产中实际使用它需要考虑更多：

*   使用“安全”访问模式获取句柄。
*   适当地关闭本机句柄
*   代码访问安全 (CAS) 信任级别（仅在 .NET Framework 中）
*   当您可以通过`SecureString`用户击键安全地收集一个时通过。

为说明所有这些而编写的代码量超出了 StackOverflow 答案中的内容，恕我直言。

## 一种更简单的组合方法

与其自己编写所有这些，不如考虑使用我的[SimpleImpersonation](https://github.com/mj1856/SimpleImpersonation)库，它将模拟和用户访问结合到一个 API 中。它在现代和旧代码库中都运行良好，具有相同的简单 API：

```
var credentials = new UserCredentials(domain, username, password);
Impersonation.RunAsUser(credentials, logonType, () =>
{
    // do whatever you want as this user.
}); 
```

或者

```
var credentials = new UserCredentials(domain, username, password);
var result = Impersonation.RunAsUser(credentials, logonType, () =>
{
    // do whatever you want as this user.
    return something;
}); 
```

请注意，它与 API 非常相似`WindowsIdentity.RunImpersonated`，但不需要您了解有关令牌句柄的任何信息。

这是 3.0.0 版的 API。有关更多详细信息，请参阅项目自述文件。另请注意，该库的早期版本使用带有该`IDisposable`模式的 API，类似于`WindowsIdentity.Impersonate`. 较新的版本更安全，并且两者仍在内部使用。

* * *

## 回答 #2

> 赞同：62
> 
> 时间：2008-09-24T04:01:16.917

这是 .NET 模拟概念的一些很好的概述。

*   [Michiel van Otegem：WindowsImpersonationContext 变得简单](https://web.archive.org/web/20150613031724/http://michiel.vanotegem.nl/2006/07/windowsimpersonationcontext-made-easy/)
*   [WindowsIdentity.Impersonate 方法（查看代码示例）](http://msdn.microsoft.com/en-us/library/chf6fbt4.aspx)

基本上，您将利用 .NET 框架中开箱即用的这些类：

*   [WindowsImpersonationContext](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext.aspx)
*   [Windows 身份](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsidentity.aspx)

不过，代码通常会变得很长，这就是为什么您会看到许多示例，例如您引用的示例，这些示例试图简化流程。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2008-09-24T04:04:15.740

这可能是你想要的：

```
using System.Security.Principal;
using(WindowsIdentity.GetCurrent().Impersonate())
{
     //your code goes here
} 
```

但我真的需要更多细节来帮助你。您可以使用配置文件进行模拟（如果您尝试在网站上执行此操作），或者如果它是 WCF 服务，则可以通过方法装饰器（属性）进行模拟，或者通过......您明白了。

此外，如果我们正在谈论模拟调用特定服务（或 Web 应用程序）的客户端，您需要正确配置客户端，以便它传递适当的令牌。

最后，如果您真正想要做的是委派，您还需要正确设置 AD，以便信任用户和机器进行委派。

**编辑：**
查看[**此处**](http://msdn.microsoft.com/en-us/library/chf6fbt4.aspx)以了解如何模拟不同的用户，并获取更多文档。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2014-11-11T19:11:52.530

这是我的马特约翰逊答案的 vb.net 端口。我为登录类型添加了一个枚举。`LOGON32_LOGON_INTERACTIVE`是第一个适用于 sql server 的枚举值。我的连接字符串只是受信任的。连接字符串中没有用户名/密码。

```
 <PermissionSet(SecurityAction.Demand, Name:="FullTrust")> _
  Public Class Impersonation
    Implements IDisposable

    Public Enum LogonTypes
      ''' <summary>
      ''' This logon type is intended for users who will be interactively using the computer, such as a user being logged on  
      ''' by a terminal server, remote shell, or similar process.
      ''' This logon type has the additional expense of caching logon information for disconnected operations; 
      ''' therefore, it is inappropriate for some client/server applications,
      ''' such as a mail server.
      ''' </summary>
      LOGON32_LOGON_INTERACTIVE = 2

      ''' <summary>
      ''' This logon type is intended for high performance servers to authenticate plaintext passwords.
      ''' The LogonUser function does not cache credentials for this logon type.
      ''' </summary>
      LOGON32_LOGON_NETWORK = 3

      ''' <summary>
      ''' This logon type is intended for batch servers, where processes may be executing on behalf of a user without 
      ''' their direct intervention. This type is also for higher performance servers that process many plaintext
      ''' authentication attempts at a time, such as mail or Web servers. 
      ''' The LogonUser function does not cache credentials for this logon type.
      ''' </summary>
      LOGON32_LOGON_BATCH = 4

      ''' <summary>
      ''' Indicates a service-type logon. The account provided must have the service privilege enabled. 
      ''' </summary>
      LOGON32_LOGON_SERVICE = 5

      ''' <summary>
      ''' This logon type is for GINA DLLs that log on users who will be interactively using the computer. 
      ''' This logon type can generate a unique audit record that shows when the workstation was unlocked. 
      ''' </summary>
      LOGON32_LOGON_UNLOCK = 7

      ''' <summary>
      ''' This logon type preserves the name and password in the authentication package, which allows the server to make 
      ''' connections to other network servers while impersonating the client. A server can accept plaintext credentials 
      ''' from a client, call LogonUser, verify that the user can access the system across the network, and still 
      ''' communicate with other servers.
      ''' NOTE: Windows NT:  This value is not supported. 
      ''' </summary>
      LOGON32_LOGON_NETWORK_CLEARTEXT = 8

      ''' <summary>
      ''' This logon type allows the caller to clone its current token and specify new credentials for outbound connections.
      ''' The new logon session has the same local identifier but uses different credentials for other network connections. 
      ''' NOTE: This logon type is supported only by the LOGON32_PROVIDER_WINNT50 logon provider.
      ''' NOTE: Windows NT:  This value is not supported. 
      ''' </summary>
      LOGON32_LOGON_NEW_CREDENTIALS = 9
    End Enum

    <DllImport("advapi32.dll", SetLastError:=True, CharSet:=CharSet.Unicode)> _
    Private Shared Function LogonUser(lpszUsername As [String], lpszDomain As [String], lpszPassword As [String], dwLogonType As Integer, dwLogonProvider As Integer, ByRef phToken As SafeTokenHandle) As Boolean
    End Function

    Public Sub New(Domain As String, UserName As String, Password As String, Optional LogonType As LogonTypes = LogonTypes.LOGON32_LOGON_INTERACTIVE)
      Dim ok = LogonUser(UserName, Domain, Password, LogonType, 0, _SafeTokenHandle)
      If Not ok Then
        Dim errorCode = Marshal.GetLastWin32Error()
        Throw New ApplicationException(String.Format("Could not impersonate the elevated user.  LogonUser returned error code {0}.", errorCode))
      End If

      WindowsImpersonationContext = WindowsIdentity.Impersonate(_SafeTokenHandle.DangerousGetHandle())
    End Sub

    Private ReadOnly _SafeTokenHandle As New SafeTokenHandle
    Private ReadOnly WindowsImpersonationContext As WindowsImpersonationContext

    Public Sub Dispose() Implements System.IDisposable.Dispose
      Me.WindowsImpersonationContext.Dispose()
      Me._SafeTokenHandle.Dispose()
    End Sub

    Public NotInheritable Class SafeTokenHandle
      Inherits SafeHandleZeroOrMinusOneIsInvalid

      <DllImport("kernel32.dll")> _
      <ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)> _
      <SuppressUnmanagedCodeSecurity()> _
      Private Shared Function CloseHandle(handle As IntPtr) As <MarshalAs(UnmanagedType.Bool)> Boolean
      End Function

      Public Sub New()
        MyBase.New(True)
      End Sub

      Protected Overrides Function ReleaseHandle() As Boolean
        Return CloseHandle(handle)
      End Function
    End Class

  End Class 
```

您需要使用 with`Using`语句来包含一些模拟运行的代码。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-02-16T07:51:40.717

从我之前的回答中查看更多详细信息 我创建了一个 nuget 包 [Nuget](https://www.nuget.org/packages/UserImpersonation/)

[Github](https://github.com/michelcedric/UserImpersonation/blob/master/UserImpersonation/UserImpersonation.cs)上的代码

示例：您可以使用：

```
 string login = "";
           string domain = "";
           string password = "";

           using (UserImpersonation user = new UserImpersonation(login, domain, password))
           {
               if (user.ImpersonateValidUser())
               {
                   File.WriteAllText("test.txt", "your text");
                   Console.WriteLine("File writed");
               }
               else
               {
                   Console.WriteLine("User not connected");
               }
           } 
```

查看完整代码：

```
using System;
using System.Runtime.InteropServices;
using System.Security.Principal;

/// <summary>
/// Object to change the user authticated
/// </summary>
public class UserImpersonation : IDisposable
{
    /// <summary>
    /// Logon method (check athetification) from advapi32.dll
    /// </summary>
    /// <param name="lpszUserName"></param>
    /// <param name="lpszDomain"></param>
    /// <param name="lpszPassword"></param>
    /// <param name="dwLogonType"></param>
    /// <param name="dwLogonProvider"></param>
    /// <param name="phToken"></param>
    /// <returns></returns>
    [DllImport("advapi32.dll")]
    private static extern bool LogonUser(String lpszUserName,
        String lpszDomain,
        String lpszPassword,
        int dwLogonType,
        int dwLogonProvider,
        ref IntPtr phToken);

    /// <summary>
    /// Close
    /// </summary>
    /// <param name="handle"></param>
    /// <returns></returns>
    [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
    public static extern bool CloseHandle(IntPtr handle);

    private WindowsImpersonationContext _windowsImpersonationContext;
    private IntPtr _tokenHandle;
    private string _userName;
    private string _domain;
    private string _passWord;

    const int LOGON32_PROVIDER_DEFAULT = 0;
    const int LOGON32_LOGON_INTERACTIVE = 2;

    /// <summary>
    /// Initialize a UserImpersonation
    /// </summary>
    /// <param name="userName"></param>
    /// <param name="domain"></param>
    /// <param name="passWord"></param>
    public UserImpersonation(string userName, string domain, string passWord)
    {
        _userName = userName;
        _domain = domain;
        _passWord = passWord;
    }

    /// <summary>
    /// Valiate the user inforamtion
    /// </summary>
    /// <returns></returns>
    public bool ImpersonateValidUser()
    {
        bool returnValue = LogonUser(_userName, _domain, _passWord,
                LOGON32_LOGON_INTERACTIVE, LOGON32_PROVIDER_DEFAULT,
                ref _tokenHandle);

        if (false == returnValue)
        {
            return false;
        }

        WindowsIdentity newId = new WindowsIdentity(_tokenHandle);
        _windowsImpersonationContext = newId.Impersonate();
        return true;
    }

    #region IDisposable Members

    /// <summary>
    /// Dispose the UserImpersonation connection
    /// </summary>
    public void Dispose()
    {
        if (_windowsImpersonationContext != null)
            _windowsImpersonationContext.Undo();
        if (_tokenHandle != IntPtr.Zero)
            CloseHandle(_tokenHandle);
    }

    #endregion
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-11-07T16:11:05.100

我知道我参加聚会已经很晚了，但我认为[Phillip Allan-Harding](https://web.archive.org/web/20150317040700/http://uk.linkedin.com/in/phillipharding)的图书馆对于这种情况和类似情况来说是最好的。

您只需要像这样的一小段代码：

```
private const string LOGIN = "mamy";
private const string DOMAIN = "mongo";
private const string PASSWORD = "HelloMongo2017";

private void DBConnection()
{
    using (Impersonator user = new Impersonator(LOGIN, DOMAIN, PASSWORD, LogonType.LOGON32_LOGON_NEW_CREDENTIALS, LogonProvider.LOGON32_PROVIDER_WINNT50))
    {
    }
} 
```

并添加他的课程：

[.NET (C#) 模拟网络凭据](https://web.archive.org/web/20150315063000/https://platinumdogs.me/2008/10/30/net-c-impersonation-with-network-credentials/)

如果您要求模拟登录具有网络凭据，则可以使用我的示例，但它有更多选项。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-09-04T09:19:08.813

您可以使用此解决方案。（使用 nuget 包）源代码在：Github： [https ://github.com/michelcedric/UserImpersonation](https://github.com/michelcedric/UserImpersonation)

更多细节 [https://michelcedric.wordpress.com/2015/09/03/usurpation-didentite-dun-user-c-user-impersonation/](https://michelcedric.wordpress.com/2015/09/03/usurpation-didentite-dun-user-c-user-impersonation/)

# .net - 插件不适用于 vb.net express

> ID：125352
> 
> 赞同：0
> 
> 时间：2008-09-24T03:59:56.903
> 
> 标签：.net, visual-studio, add-in

哪些插件不能与 vb c# studio express 一起使用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-24T04:00:32.673

Express 版本不支持 Visual Studio 插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T04:03:49.907

Microsoft 不希望用户在使用 Express 版本时替换 Visual Studio 中的所有 Standard+ 功能，因为这类似于饿死自己。因此，决定在 Express 版本中不支持插件。

如果有一些插件你不能没有，购买标准版的许可证并不是太多钱，而且他们几乎总是在新版本 Visual Studio 的发布活动中免费赠送标准的副本。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T04:06:51.223

有一些方法可以在快速版中制作插件，但这不值得微软愤怒。这就是[TestDriven.NET](http://www.testdriven.net/)发生的事情。为什么不直接获得 VB.NET 的专业版？如果成本是一个问题，您可以尝试让您的一个朋友仍在大学，购买学术版本。

您也可以尝试使用[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)。它带有许多有用的插件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T04:39:04.750

学生有资格获得[免费的 Microsoft 软件](https://downloads.channel8.msdn.com/)，其中包括 Visual Studio Pro。

# java - 在 Web 应用程序中处理上下文的任何巧妙方法？

> ID：125359
> 
> 赞同：39
> 
> 时间：2008-09-24T04:02:20.330
> 
> 标签：java, jsp, servlets, contextpath

在 Java 中，Web 应用程序被捆绑到 WAR 中。默认情况下，许多 servlet 容器将使用 WAR 名称作为应用程序的上下文名称。

因此 myapp.war 被部署到[http://example.com/myapp](http://example.com/myapp)。

问题是 webapp 认为它的“根”是“根”，或者只是“/”，而 HTML 会认为应用程序的根是“/myapp”。

Servlet API 和 JSP 具有帮助管理这一点的工具。例如，如果在 servlet 中执行：response.sendRedirect("/mypage.jsp")，则容器将添加上下文并创建 url：[http](http://example.com/myapp/mypage.jsp) ://example.com/myapp/mypage.jsp "。

但是，您不能使用 HTML 中的 IMG 标签来做到这一点。如果你这样做 <img src="/myimage.gif"/> 你可能会得到一个 404，因为你真正想要的是“/myapp/myimage.gif”。

许多框架也具有上下文感知的 JSP 标记，并且有不同的方法可以在 JSP 中生成正确的 URL（没有一种特别优雅）。

对于编码人员来说，跳出何时使用“应用程序相对”网址而不是绝对网址是一个棘手的问题。

最后，还有需要动态创建 URL 和 CSS 中嵌入 URL（用于背景图像等）的 Javascript 代码问题。

我很好奇其他人使用什么技术来缓解和解决这个问题。许多人只是简单地对它进行平底船和硬编码，无论是服务器根目录还是他们碰巧使用的任何上下文。我已经知道那个答案了，这不是我要找的。

你做什么工作？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-09-24T08:24:51.090

您可以使用 JSTL 创建 url。

例如，`<c:url value="/images/header.jpg" />`将为上下文根添加前缀。

使用 CSS，这对我来说通常不是问题。

我有一个这样的网络根结构：

/css
/图像

在 CSS 文件中，您只需要使用相对 URL (../images/header.jpg)，它不需要知道上下文根。

至于 JavaScript，对我有用的是在页面标题中包含一些常见的 JavaScript，如下所示：

```
<script type="text/javascript">
var CONTEXT_ROOT = '<%= request.getContextPath() %>';
</script> 
```

然后您可以在所有脚本中使用上下文根（或者，您可以定义一个函数来构建路径 - 可能更灵活一些）。

显然，这一切都取决于您使用 JSP 和 JSTL，但我将 JSF 与 Facelets 一起使用，并且所涉及的技术是相似的——唯一真正的区别是以不同的方式获取上下文根。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2011-02-10T11:39:37.137

对于 HTML 页面，我只是设置了 HTML`<base>`标签。每个相对链接（即不是以 scheme 或 开头`/`）都将变得相对于它。没有干净的方法可以立即获取它 `HttpServletRequest`，所以我们在这里几乎不需要 JSTL 的帮助。

```
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<c:set var="req" value="${pageContext.request}" />
<c:set var="url">${req.requestURL}</c:set>
<c:set var="uri">${req.requestURI}</c:set>

<!DOCTYPE html>
<html lang="en">
  <head>
    <base href="${fn:substring(url, 0, fn:length(url) - fn:length(uri))}${req.contextPath}/" />
    <link rel="stylesheet" href="css/default.css">
    <script src="js/default.js"></script>
  </head>
  <body>
    <img src="img/logo.png" />
    <a href="other.jsp">link</a>
  </body>
</html> 
```

然而，这反过来有一个警告：锚（`#identifier`URL）也将相对于基本路径。如果您有其中任何一个，您希望将其设为相对于请求 URL (URI)。所以，改变像

```
<a href="#identifier">jump</a> 
```

到

```
<a href="${uri}#identifier">jump</a> 
```

* * *

在 JS 中，`<base>`只要您想将相对 URL 转换为绝对 URL，就可以从 DOM 中访问元素。

```
var base = document.getElementsByTagName("base")[0].href; 
```

或者如果你做 jQuery

```
var base = $("base").attr("href"); 
```

* * *

在 CSS 中，图像 URL 是相对于样式表本身的 URL。因此，只需将图像放在相对于样式表本身的某个文件夹中。例如

```
/css/style.css
/css/images/foo.png 
```

并按如下方式引用它们

```
background-image: url('images/foo.png'); 
```

如果您更喜欢将图像放在与 CSS 文件夹相同级别的某个文件夹中

```
/css/style.css
/images/foo.png 
```

然后使用`../`转到公共父文件夹

```
background-image: url('../images/foo.png'); 
```

### 也可以看看：

*   [是否推荐使用`<base>`html 标签？](https://stackoverflow.com/questions/1889076/is-it-recommended-to-use-the-base-html-tag)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-02-10T09:46:31.960

我同意**tardate**。我也关注过滤器，并在[UrlRewriteFilter](http://www.tuckey.org/urlrewrite/)项目面前找到了解决方案。简单的配置如下：

```
<rule>
    <from>^.+/resources/(.*)$</from>
    <to>/resources/$1</to>
</rule> 
```

有助于将所有对 */resources 路径的请求转发到 /resources 传递（包括上下文路径前缀）。因此，我可以简单地将所有**图像**和**CSS**文件放在**资源**文件夹下，并继续在我的样式中使用相对 URL 来处理背景图像和其他情况。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-10-04T04:16:23.240

> Servlet API 和 JSP 具有帮助管理这一点的工具。例如，如果在 servlet 中执行：response.sendRedirect("/mypage.jsp")，则容器将添加上下文并创建 url： [http](http://example.com/myapp/mypage.jsp) ://example.com/myapp/mypage.jsp "。

啊，也许，也许不是——这取决于你的容器和 servlet 规范！

从[Servlet 2.3 开始：公开的新功能](http://java.sun.com/developer/technicalArticles/Servlets/servletapi2.3/index.html)：

> 最后，经过一组专家的长时间辩论，Servlet API 2.3 已经一劳永逸地阐明了 res.sendRedirect("/index.html") 调用在非根上下文中执行的 servlet 会发生什么。问题是 Servlet API 2.2 需要像“/index.html”这样的不完整路径才能由 servlet 容器翻译成完整路径，但没有说明如何处理上下文路径。如果进行调用的 servlet 位于路径“/contextpath”的上下文中，则重定向 URI 应该相对于容器根 ( [http://server:port/index.html](http://server:port/index.html) ) 还是上下文根 ( [http://服务器：端口/上下文路径/index.html](http://server:port/contextpath/index.html))? 为了获得最大的可移植性，必须定义行为；经过长时间的争论，专家们选择了相对于容器根的翻译。对于那些想要上下文相关的人，您可以将 getContextPath() 的输出添加到您的 URI 中。

所以不，在 2.3 中，您的路径**不会**自动转换为包含上下文路径。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T06:47:29.293

我使用了**帮助类**来生成 img 标签等。这个帮助类负责使用应用程序的 contextPath**为路径添加前缀。**（这行得通，但我不太喜欢它。如果有人有更好的选择，请告诉。）

对于 css 文件中的路径等。我使用**Ant 构建脚本**，该脚本在生产环境中使用 site.production.css 作为 site.css，在开发环境中使用 site.development.css。

或者，我有时会使用 Ant 脚本，**将 @token@**标记替换为不同环境的适当数据。在这种情况下，@contextPAth@ 标记将替换为正确的上下文路径。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T07:03:34.777

一种选择是尽可能使用“平面”应用程序结构和相对 URL。

“平面”是指您的应用程序根目录下没有子目录，可能只有几个静态内容目录为“images/”。您所有的 JSP、动作 URL、servlet 都直接位于根目录下。

这并不能完全解决您的问题，但会大大简化它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T17:36:38.640

Vilmantas 在这里说对了：相对 URL。

您在 IMG 中需要做的就是使用

```
<img src="myimage.gif"/> 
```

代替

```
<img src="/myimage.gif"/> 
```

它将与应用程序上下文相关（因为浏览器正在解释要访问的 URL）

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-24T17:59:50.940

除了特殊情况，我建议不要以这种方式使用绝对 URL。曾经。*当另一个 web 应用*程序指向您的 web 应用程序中的某些内容时，绝对 URL 非常有用。在内部——当一个资源指向同一上下文中的第二个资源时——资源应该知道它所在的位置，因此它应该能够表达到第二个资源的相对路径。

当然，您将编写模块化组件，它们不知道包含它们的资源。例如：

```
/myapp/user/email.jsp:
Email: <a href="../sendmail.jsp">${user.email}</a>

/myapp/browse/profile.jsp:
<jsp:include page="../user/email.jsp" />

/myapp/home.jsp:
<jsp:include page="../user/email.jsp" /> 
```

那么，如何`email.jsp`知道 的相对路径`sendmail.jsp`？很明显，链接将在其中一个`/myapp/browse/profile.jsp`或它会中断`/myapp/home.jsp`。答案是，将所有 URL 保存在同一个平面文件路径空间中。也就是说，每个 URL 在`/myapp/`.

这很容易实现，只要您在 URL 和生成内容的实际文件之间有某种映射。（例如在 Spring 中，使用 DispatcherServlet 将 URL 映射到 JSP 文件或视图。）

有特殊情况。例如，如果您正在用 Javascript 编写浏览器端应用程序，那么维护平面文件路径空间会变得更加困难。`<%= request.getContextPath() %>`在那种情况下，或者在其他特殊情况下，或者只是如果您有个人喜好，使用创建绝对路径并不是什么大不了的事。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-25T07:22:53.943

您可以使用 request.getContextPath() 来构建未硬编​​码到特定上下文的绝对 URL。正如之前的回答所指出的，对于 JavaScript，您只需在 JSP 的顶部（或者最好在模板中）设置一个变量，并将其作为上下文的前缀。

这不适用于 CSS 图像替换，除非您想动态生成 CSS 文件，否则可能会导致其他问题。但是，由于您知道 CSS 文件与图像相关的位置，因此您可以摆脱相对 URL。

出于某种原因，我在 IE 处理相对 URL 时遇到了麻烦，不得不回退到使用将 JavaScript 变量设置为上下文的表达式。我只是将我的 IE 图像替换拆分到他们自己的文件中，并使用 IE 宏来提取正确的。这没什么大不了的，因为无论如何我已经不得不这样做来处理透明的 PNG。它不漂亮，但它有效。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-26T04:30:36.750

我已经使用了大部分这些技术（除了 XSLT 体系结构）。

我认为问题的症结（和共识）是有一个可能包含多个目录的站点。

如果您的目录深度（因为没有更好的术语）是恒定的，那么您可以在 CSS 之类的东西中依赖相对 url。

请注意，布局不必完全平坦，只要保持一致即可。

例如，我们已经完成了像 /css、/js、/common、/admin、/user 这样的层次结构。将适当的页面和资源放在适当的目录中。拥有这样的结构非常适合基于容器的身份验证。

我还将 *.css 和 *.js 映射到 JSP servlet，并使它们动态化，以便我可以即时构建它们。

我只是希望还有一些我可能错过的东西。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-24T04:29:30.967

我*绝不*声称以下是一个优雅的问题。事实上，事后看来，考虑到（最有可能的）性能下降，我不会推荐这个问题。

我们的 Web 应用程序的 JSP 是严格的 XML 原始数据。然后将这些原始数据发送到应用正确 CSS 标记的 XSL（服务器端），并输出 XHTML。

我们有一个单独的 template.xsl，它将被我们为网站的不同组件拥有的多个 XSL 文件继承。我们的路径都定义在一个名为 paths.xml 的 XSL 文件中：

```
<?xml version="1.0" encoding="UTF-8"?>
<paths>
    <path name="account" parent="home">Account/</path>
    <path name="css">css/</path>
    <path name="home">servlet/</path>
    <path name="icons" parent="images">icons/</path>
    <path name="images">images/</path>
    <path name="js">js/</path>
</paths> 
```

内部链接将在 XML 中，如下所示：

```
<ilink name="link to icons" type="icons">link to icons</ilink> 
```

这将由我们的 XSL 处理：

```
<xsl:template match="ilink">
    <xsl:variable name="temp">
        <xsl:value-of select="$rootpath" />
        <xsl:call-template name="paths">
            <xsl:with-param name="path-name"><xsl:value-of select="@type" /></xsl:with-param>
        </xsl:call-template>
        <xsl:value-of select="@file" />
    </xsl:variable>
        <a href="{$temp}" title="{@name}" ><xsl:value-of select="." /></a>
</xsl:template> 
```

`$rootPath`被传递到每个文件中，`${applicationScope.contextPath}`我们背后的想法是使用 XML 而不是将其硬编码到 JSP/Java 文件中，我们不想重新编译。

同样，该解决方案根本不是一个好的解决方案……但我们确实使用过一次！

**编辑**：实际上，我们的问题之所以复杂，是因为我们无法在整个视图中使用 JSP。为什么有人不直接使用`${applicationScope.contextPath}`来检索上下文路径？那时对我们来说效果很好。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-27T03:28:14.027

从头开始创建网站时，我支持@Will——目标是一致且可预测的 url 结构，以便您可以坚持使用相对引用。

但是，如果您将最初构建为直接在站点根“/”（简单 JSP 站点非常常见）下工作的站点更新为正式的[Java EE](http://java.sun.com/javaee/5/docs/api/)打包（其中上下文根将是根下的某个路径），事情会变得非常混乱）。

这可能意味着大量的代码更改。

如果您想避免或推迟代码更改，但仍要确保正确的上下文根引用，我测试过的一种技术是使用 servlet 过滤器。过滤器可以在不更改任何内容（web.xml 除外）的情况下放入现有项目中，并将出站 HTML 中的任何 url 引用重新映射到正确的路径，并确保正确引用重定向。

此处提供示例站点和可用代码：[EnforceContextRootFilter-1.0-src.zip](http://github.com/tardate/sources/tree/master%2FEnforceContextRootFilter-1.0-src.zip?raw=true) 注意：实际映射规则在 servlet 类中实现为正则表达式，并提供了一个非常通用的包罗万象 - 但您可能需要针对特定​​情况进行修改。

*顺便说一句，我提出了一个稍微不同的问题来解决将[现有代码库从“/”迁移到非根上下文路径的问题](https://stackoverflow.com/questions/142965/handling-context-path-refs-when-migrating-site-to-java-ee-packaging)*

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-09-08T15:27:53.190

我倾向于编写一个属性作为我的核心 JavaScript 库的一部分。我不认为它是完美的，但我认为这是我设法达到的最好的。

首先，我有一个模块，它是我的应用程序核心的一部分，它始终可用

```
(function (APP) {
  var ctx;
  APP.setContext = function (val) {
    // protect rogue JS from setting the context.
    if (ctx) {
      return;
    }
    val = val || val.trim();
    // Don't allow a double slash for a context.
    if (val.charAt(0) === '/' && val.charAt(1) === '/') {
      return;
    }
    // Context must both start and end in /.
    if (val.length === 0 || val === '/') {
      val = '/';
    } else {
      if (val.charAt(0) !== '/') {
        val = '/' + val;
      }
      if (val.slice(-1) !== '/') {
        val += '/';
      }
    }
    ctx = val;
  };
  APP.getContext = function () {
    return ctx || '/';
  };
  APP.getUrl = function (val) {
    if (val && val.length > 0) {
      return APP.getContext() + (val.charAt(0) === '/' ? val.substring(1) : val);
    }
    return APP.getContext();
  };
})(window.APP = window.APP || {}); 
```

然后，我使用具有公共标头的 apache 磁贴，该标头始终包含以下内容：

```
<script type="text/javascript">
  APP.setContext('${pageContext.request['contextPath']}');
  // If preferred use JSTL cor, but it must be available and declared.
  //APP.setContext('<c:url value='/'/>');
</script> 
```

现在我已经初始化了我可以`getUrl(path)`从任何地方（js 文件或 jsp/html 中）使用的上下文，它将返回上下文中给定输入字符串的绝对路径。

请注意，以下两者都是有意等效的。`getUrl`将始终返回绝对路径，因为相对路径不需要您首先知道上下文。

```
var path = APP.getUrl("/some/path");
var path2 = APP.getUrl("some/path"); 
```

# programming-languages - 动态类型语言与静态类型语言

> ID：125367
> 
> 赞同：207
> 
> 时间：2008-09-24T04:05:00.947
> 
> 标签：programming-languages, dynamic-languages, type-systems

与静态类型语言相比，动态类型语言的优点和局限性是什么？

**另请参阅**：[对动态语言的热爱是什么](https://stackoverflow.com/questions/42934/whats-with-the-love-of-dynamic-languages)（一个更具争议性的线程......）

* * *

## 回答 #1

> 赞同：139
> 
> 时间：2008-09-24T04:10:22.073

解释器推断类型和类型转换的能力使开发时间更快，但它也可能引发运行时故障，而在静态类型语言中您无法在编译时捕获它们。但是最近（并且很长一段时间以来）社区中正在热烈讨论哪个更好（或者即使这总是正确的）。

对这个问题的一个很好的看法来自微软的 Erik Meijer 和 Peter Drayton 的[《Static Typing Where possible, Dynamic Typing When Needed: The End of the Cold War Between Programming Languages》 ：](http://www.ics.uci.edu/~lopes/teaching/inf212W12/readings/rdl04meijer.pdf)

> 静态类型的拥护者认为静态类型的优点包括更早地检测编程错误（例如防止将整数添加到布尔值），更好的类型签名形式的文档（例如，在解析名称时合并参数的数量和类型），更多编译器优化的机会（例如，当接收器的确切类型静态已知时，用直接调用替换虚拟调用），提高运行时效率（例如，并非所有值都需要携带动态类型），以及更好的设计时开发人员体验（例如知道接收器的类型，IDE 可以显示所有适用成员的下拉菜单）。静态类型狂热者试图让我们相信“类型良好的程序不会出错”。虽然这听起来确实令人印象深刻，这是一个相当空洞的陈述。静态类型检查是程序运行时行为的编译时抽象，因此它必然只是部分合理且不完整。这意味着程序仍然可能由于类型检查器未跟踪的属性而出错，并且有些程序虽然不会出错，但无法进行类型检查。正如“幻像类型”[11] 和“摇摆类型”[10] 等概念所证明的那样，使静态类型变得不那么部分和更完整的冲动导致类型系统变得过于复杂和奇异。这就像试图跑一场马拉松，腿上绑着一个球和链子，然后得意洋洋地大喊你几乎成功了，即使你在第一英里后跳了出来。静态类型检查是程序运行时行为的编译时抽象，因此它必然只是部分合理且不完整。这意味着程序仍然可能由于类型检查器未跟踪的属性而出错，并且有些程序虽然不会出错，但无法进行类型检查。正如“幻像类型”[11] 和“摇摆类型”[10] 等概念所证明的那样，使静态类型变得不那么部分和更完整的冲动导致类型系统变得过于复杂和奇异。这就像试图跑一场马拉松，腿上绑着一个球和链子，然后得意洋洋地大喊你几乎成功了，即使你在第一英里后跳了出来。静态类型检查是程序运行时行为的编译时抽象，因此它必然只是部分合理且不完整。这意味着程序仍然可能由于类型检查器未跟踪的属性而出错，并且有些程序虽然不会出错，但无法进行类型检查。正如“幻像类型”[11] 和“摇摆类型”[10] 等概念所证明的那样，使静态类型变得不那么部分和更完整的冲动导致类型系统变得过于复杂和奇异。这就像试图跑一场马拉松，腿上绑着一个球和链子，然后得意洋洋地大喊你几乎成功了，即使你在第一英里后跳了出来。因此它必然只是部分健全和不完整的。这意味着程序仍然可能由于类型检查器未跟踪的属性而出错，并且有些程序虽然不会出错，但无法进行类型检查。正如“幻像类型”[11] 和“摇摆类型”[10] 等概念所证明的那样，使静态类型变得不那么部分和更完整的冲动导致类型系统变得过于复杂和奇异。这就像试图跑一场马拉松，腿上绑着一个球和链子，然后得意洋洋地大喊你几乎成功了，即使你在第一英里后跳了出来。因此它必然只是部分健全和不完整的。这意味着程序仍然可能由于类型检查器未跟踪的属性而出错，并且有些程序虽然不会出错，但无法进行类型检查。正如“幻像类型”[11] 和“摇摆类型”[10] 等概念所证明的那样，使静态类型变得不那么部分和更完整的冲动导致类型系统变得过于复杂和奇异。这就像试图跑一场马拉松，腿上绑着一个球和链子，然后得意洋洋地大喊你几乎成功了，即使你在第一英里后跳了出来。并且有些程序虽然不会出错，但无法进行类型检查。正如“幻像类型”[11] 和“摇摆类型”[10] 等概念所证明的那样，使静态类型变得不那么部分和更完整的冲动导致类型系统变得过于复杂和奇异。这就像试图跑一场马拉松，腿上绑着一个球和链子，然后得意洋洋地大喊你几乎成功了，即使你在第一英里后跳了出来。并且有些程序虽然不会出错，但无法进行类型检查。正如“幻像类型”[11] 和“摇摆类型”[10] 等概念所证明的那样，使静态类型变得不那么部分和更完整的冲动导致类型系统变得过于复杂和奇异。这就像试图跑一场马拉松，腿上绑着一个球和链子，然后得意洋洋地大喊你几乎成功了，即使你在第一英里后跳了出来。
> 
> 动态类型语言的拥护者认为静态类型过于死板，动态语言的柔软性使其非常适合用于具有变化或未知需求的原型系统，或者与其他不可预测的变化系统交互（数据和应用程序集成）。当然，动态类型语言对于处理真正动态的程序行为是必不可少的，例如方法拦截、动态加载、移动代码、运行时反射等。在所有关于脚本的论文之母 [16] 中，John Ousterhout 认为静态类型系统与动态类型的脚本语言相比，编程语言降低了代码的可重用性、更冗长、更不安全、更缺乏表现力。这个论点被许多动态类型脚本语言的支持者照搬。我们认为这是一个谬误，并且与声称声明式编程的本质是消除分配属于同一类别。或者正如 John Hughes 所说的 [8]，通过省略特性来使语言更强大在逻辑上是不可能的。捍卫将所有类型检查延迟到运行时是一件好事的事实，是在玩鸵鸟策略，即应在开发过程中尽早发现错误。通过省略特性来使语言更强大在逻辑上是不可能的。捍卫将所有类型检查延迟到运行时是一件好事的事实，是在玩鸵鸟策略，即应在开发过程中尽早发现错误。通过省略特性来使语言更强大在逻辑上是不可能的。捍卫将所有类型检查延迟到运行时是一件好事的事实，是在玩鸵鸟策略，即应在开发过程中尽早发现错误。

* * *

## 回答 #2

> 赞同：119
> 
> 时间：2008-09-24T05:19:58.117

静态类型系统试图以静态方式消除某些错误，在不运行程序的情况下检查程序并尝试在某些方面证明其合理性。一些类型系统能够比其他类型系统捕获更多的错误。例如，如果使用得当，C# 可以消除空指针异常，而 Java 则没有这种能力。Twelf 有一个类型系统，它实际上[保证证明将终止](http://www.cs.cmu.edu/~twelf/guide-1-2/twelf_7.html)，“解决”[停止问题](http://en.wikipedia.org/wiki/Halting_problem)。

然而，没有类型系统是完美的。为了消除特定类别的错误，他们还必须拒绝某些违反规则的完全有效的程序。这就是为什么 Twelf 并没有真正解决停止问题，它只是通过抛出大量恰好以奇怪方式终止的完全有效的证明来避免它。同样，Java 的类型系统拒绝 Clojure 的`PersistentVector`实现，因为它使用了异构数组。它在运行时工作，但类型系统无法验证它。

出于这个原因，大多数类型系统都提供“转义”，即覆盖静态检查器的方法。对于大多数语言，这些采用强制转换的形式，尽管有些（如 C# 和 Haskell）具有标记为“不安全”的完整模式。

主观上，我喜欢静态类型。正确实施（提示：*不是*Java），静态类型系统可以极大地帮助在错误使生产系统崩溃之前清除它们。动态类型语言往往需要更多的单元测试，这在最好的时候是乏味的。此外，静态类型语言可能具有某些在动态类型系统中不可能或不安全的特性（[隐式转换](http://www.codecommit.com/blog/ruby/implicit-conversions-more-powerful-than-dynamic-typing)浮现在脑海中）。这都是需求和主观品味的问题。我不会再用 Ruby 构建下一个 Eclipse，就像我不会尝试用 Assembly 编写备份脚本或使用 Java 修补内核一样。

哦，那些说“ *x*打字比*y*打字效率高 10 倍”的人简直是在冒烟。在许多情况下，动态类型可能“感觉”更快，但一旦你真正尝试让你的花哨的应用程序*运行*，它就会失去基础。同样，静态类型似乎是一个完美的安全网，但一看 Java 中一些更复杂的泛型类型定义，大多数开发人员都会眼花缭乱。即使有类型系统和生产力，也没有灵丹妙药。

最后一点：在比较静态类型和动态类型时，不要担心性能。V8 和 TraceMonkey 等现代 JIT 正在危险地接近静态语言性能。此外，Java 实际上编译为一种固有的动态中间语言这一事实​​应该暗示，在大多数情况下，动态类型并不是某些人认为的巨大的性能杀手。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2010-07-06T11:54:12.010

嗯，两者都是非常非常非常非常被误解的，也是两个完全不同的东西。**这不是相互排斥的**。

静态类型是语言语法的限制。严格来说，静态类型语言可以说不是上下文无关的。一个简单的事实是，在不将所有数据简单地视为位向量的上下文无关语法中理智地表达一种语言变得不方便。静态类型系统是语言语法的一部分，如果有的话，它们只是比上下文无关语法限制更多，因此语法检查实际上是在源代码的两次传递中发生的。静态类型对应于类型论的数学概念，数学中的类型论只是限制了某些表达式的合法性。就像，我不能`3 + [4,7]`在数学中说，这是因为它的类型论。

因此，静态类型不是从理论角度“防止错误”的方法，它们是语法的限制。确实，只要 +、3 和区间具有通常的集合理论定义，如果我们删除类型系统，就会`3 + [4,7]`有一个非常明确的结果，那就是集合。“运行时类型错误”理论上不存在，类型系统的实际用途是防止*对人类*没有意义的操作。当然，操作仍然只是位的移位和操作。

对此的问题是，类型系统无法决定是否允许运行此类操作。例如，将所有可能的程序集精确地划分为那些会出现“类型错误”的程序，以及那些不会出现“类型错误”的程序。它只能做两件事：

1：证明程序中会发生类型错误
2：证明程序中不会发生类型错误

这似乎是我在自相矛盾。但是 C 或 Java 类型检查器所做的是将程序拒绝为“不合语法”，或者如果它*不能*在 2 处成功，则将其称为“类型错误”。它不能证明它们不会发生，这并不意味着它们不会发生，它只是意味着它无法证明它。一个没有类型错误的程序很可能被拒绝，因为它不能被编译器证明。一个简单的例子是`if(1) a = 3; else a = "string";`，当然因为它总是正确的，else-branch 永远不会在程序中执行，也不会发生类型错误。但是它不能以一般的方式证明这些案例，所以它被拒绝了。这是许多静态类型语言的主要弱点，在保护您免受自己侵害时，您也必须在不需要它的情况下受到保护。

但是，与普遍认为的相反，也有静态类型语言按照原则 1 工作。他们简单地拒绝所有可以证明会导致类型错误的程序，并通过所有他们不能证明的程序。因此，它们可能允许程序中有类型错误，一个很好的例子是 Typed Racket，它是动态和静态类型的混合体。有些人会争辩说，在这个系统中你可以两全其美。

静态类型的另一个优点是类型在编译时是已知的，因此编译器可以使用它。如果我们在 Java 中使用`"string" + "string"`or `3 + 3`，则文本中的两个`+`标记最后都代表完全不同的操作和数据，编译器知道单独从类型中选择哪一个。

现在，我将在这里发表一个非常有争议的声明，但请耐心等待：**“动态类型”不存在**。

听起来很有争议，但确实如此，动态类型语言从理论角度来看是*untyped*。它们只是只有一种类型的静态类型语言。或者简单地说，它们是实际上由上下文无关语法在语法上生成的语言。

为什么他们没有类型？因为每个操作都定义并允许在每个操作符上，所以究竟什么是“运行时类型错误”？它来自一个理论示例，纯粹是*副作用*。如果doing `print("string")`which prints a string是一个操作，那么也是`length(3)`，前者有写入标准输出的副作用`string`，后者简单`error: function 'length' expects array as argument.`，就是这样。从理论的角度来看，没有动态类型语言这样的东西。它们没有*类型*

好吧，“动态类型”语言的明显优势是表达能力，类型系统只不过是表达能力的限制。一般来说，如果类型系统被忽略，那么具有类型系统的语言确实会为所有那些不允许的操作定义一个结果，结果对人类来说是没有意义的。许多语言在应用类型系统后失去了图灵完整性。

明显的缺点是可能发生的操作会产生对人类无意义的结果。为了防止这种情况，动态类型语言通常会重新定义这些操作，而不是产生无意义的结果，而是将其重新定义为产生写出错误的副作用，并可能完全停止程序。这根本不是“错误”，实际上，语言规范通常暗示这一点，从理论的角度来看，这与打印字符串一样多的语言行为。因此，类型系统迫使程序员对代码流进行推理，以确保不会发生这种情况。或者确实，有理由这样*做*在调试的某些点上发生也很方便，表明它根本不是“错误”，而是语言的一个明确定义的属性。实际上，大多数语言所拥有的“动态类型”的唯一残余就是防止被零除。这就是动态类型，没有类型，没有比零与所有其他数字不同的类型更多的类型。人们所说的“类型”只是数据的另一个属性，例如数组的长度或字符串的第一个字符。许多动态类型语言还允许您写出诸如`"error: the first character of this string should be a 'z'"`.

另一件事是动态类型语言在运行时具有可用的类型，并且通常可以检查并处理它并从中做出决定。当然，理论上它与访问数组的第一个字符并查看它是什么没有什么不同。事实上，您可以制作自己的动态 C，只使用一种类型，如 long long int 并使用它的前 8 位来存储您的“类型”并相应地编写函数来检查它并执行浮点或整数加法。您有一种具有一种类型的静态类型语言，或者一种动态语言。

在实践中，这一切都表明，静态类型语言通常用于编写商业软件的上下文中，而动态类型语言倾向于用于解决某些问题和自动化某些任务的上下文中。用静态类型语言编写代码需要很长时间并且很麻烦，因为你不能做你知道会好的事情，但是类型系统仍然可以保护你免受你没有犯的错误。许多编码人员甚至没有意识到他们这样做是因为它在他们的系统中，但是当您使用静态语言进行编码时，您通常会绕过这样一个事实，即类型系统不会让您做不会出错的事情，因为它不能证明它不会出错。

正如我所指出的，“静态类型”通常意味着案例 2，在被证明无罪之前是有罪的。但是有些语言根本没有从类型理论派生出它们的类型系统，它们使用规则 1：在被证明有罪之前是无辜的，这可能是理想的混合体。所以，也许 Typed Racket 适合你。

另外，好吧，举一个更荒谬和极端的例子，我目前正在实现一种语言，其中“类型”确实是数组的第一个字符，它们是数据，“类型”的数据，“类型”本身一个类型和数据，唯一一个将自己作为类型的数据。类型不是有限的或静态有界的，但可以基于运行时信息生成新类型。

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2010-04-19T18:09:37.443

也许动态类型的最大“好处”是更浅的学习曲线。没有要学习的类型系统，也没有用于极端情况（例如类型约束）的非平凡语法。这使得更多人可以使用动态类型，并且对于许多无法使用复杂的静态类型系统的人来说是可行的。因此，动态类型在教育环境（例如 MIT 的 Scheme/Python）和非程序员的领域特定语言（例如[Mathematica](http://www.ffconsultancy.com/products/CWT/?so)）中流行起来。动态语言也在竞争很少或没有竞争的领域（例如 Javascript）中流行起来。

最简洁的动态类型语言（例如 Perl、APL、J、K、[Mathematica](http://www.ffconsultancy.com/products/CWT/?so) ）是特定领域的，并且在它们设计的领域中比最简洁的通用静态类型语言（例如[OCaml](http://www.ffconsultancy.com/products/ocaml_for_scientists/?so) ）要简洁得多.

动态类型的主要缺点是：

*   运行时类型错误。

*   要达到相同水平的正确性可能非常困难甚至几乎不可能，并且需要更多的测试。

*   没有经过编译器验证的文档。

*   由于依赖于复杂的优化，性能不佳（通常在运行时，但有时在编译时，例如斯大林方案）和不可预测的性能。

就个人而言，我是在动态语言上长大的，但除非没有其他可行的选择，否则我不会以 40 英尺的杆数作为专业人士接触它们。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2008-09-24T04:10:23.337

来自 Artima 的*[打字：强与弱，静态与动态](http://www.artima.com/weblogs/viewpost.jsp?thread=7590)*文章：

> 强类型可防止不匹配类型之间的混合操作。为了混合类型，您必须使用显式转换
> 
> 弱类型意味着您可以混合类型而无需显式转换

在 Pascal Costanza 的论文*[Dynamic vs. Static Typing — A Pattern-Based Analysis](http://p-cos.net/documents/dynatype.pdf)* (PDF) 中，他声称在某些情况下，静态类型比动态类型更容易出错。一些静态类型语言迫使您手动模拟动态类型以执行“正确的事情”。它在[Lambda the Ultimate](http://lambda-the-ultimate.org/node/986)上进行了讨论。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-11-30T21:47:27.700

这取决于上下文。有很多好处适用于动态类型系统以及强类型。我认为动态类型语言的流程更快。动态语言不受类属性和编译器思考代码中发生的事情的限制。你有一些自由。此外，动态语言通常更具表现力，并且代码更少，这很好。尽管如此，它更容易出错，这也是有问题的，并且更多地依赖于单元测试覆盖。它是具有动态语言的简单原型，但维护可能会成为噩梦。

静态类型系统的主要优点是 IDE 支持和代码的静态分析器。每次代码更改后，您都会对代码更有信心。有了这些工具，维护就很轻松了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T04:34:15.013

关于静态和动态语言有很多不同的东西。对我来说，主要区别在于动态语言中的变量没有固定类型。相反，类型与值相关联。因此，要执行的确切代码直到运行时才确定。

在早期或幼稚的实现中，这是一个巨大的性能拖累，但现代 JIT 非常接近通过优化静态编译器可以获得的最佳性能。（在某些边缘情况下，甚至比这更好）。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T05:47:49.313

这一切都与工作的正确工具有关。100％的时间都不是更好。这两个系统都是人为创造的，都有缺陷。对不起，但我们很糟糕，制作完美的东西。

我喜欢动态类型，因为它不适合我，但是运行时错误可能会出现，这是我没有计划的。静态类型可以修复上述错误，但会让新手（使用类型化语言）程序员疯狂地尝试在常量字符和字符串之间进行转换。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2013-06-27T07:12:52.890

**静态类型：** Java 和 Scala 等语言是静态类型的。

变量在代码中使用之前必须定义和初始化。

例如。诠释 x; x = 10;

System.out.println(x);

**动态类型：** Perl 是一种动态类型语言。

变量在代码中使用之前不需要初始化。

y=10；在后面的代码中使用这个变量

# .net - 添加对 GACed DLL 的 Web 引用

> ID：125369
> 
> 赞同：4
> 
> 时间：2008-09-24T04:05:10.213
> 
> 标签：.net, sharepoint, events, moss, gac

我在 SharePoint 中编写事件处理程序时遇到了这个问题。我的事件处理程序有一个网络参考。当我创建此 Web 引用时，Web 服务的 URL 将添加到程序集的 .config 文件中。如果我必须更改网络参考 URL，我只需更改配置文件中的链接。

当我尝试对 dll 进行 GAC 时，问题就来了。当我对 DLL 进行 GAC 时，配置文件无法与 dll 一起被 GAC，因此，我无法更新 Web 参考。

我发现的一种解决方法是修改构造函数方法 Reference.cs 类，该类在我添加引用时由 Visual Studio 自动生成，以便构造函数从其他位置读取 Web 服务 url，例如注册表或某些 XML 文件预定位置。但这有时会带来问题，因为当我使用 Visual Studio 更新 Web 参考时，此 Reference.cs 文件会重新生成，并且我的所有修改都会丢失。

有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T04:18:47.140

SharePoint 托管的任何应用程序都使用位于 IIS 中 SharePoint 网站根目录的 web.config。您需要做的是将 Web/Service Reference 向导生成的配置添加到您的 web.config。

大致是这样工作的：

*   SharePoint 应用程序池加载您的 DLL
*   您的 DLL 在当前应用程序配置文件中查找服务信息
*   您的 DLL 找到 web.config 并在那里查找配置信息

基本上，不会使用在您的 DLL 中生成的 app.config。因为本例中的应用程序是托管 SharePoint 应用程序的应用程序池 (w3wp.exe)。对于 SharePoint，app.config 实际上被命名为 web.config，并且存在于 SharePoint 网站的根目录中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T04:07:23.220

如果您有 Visual Studio 2008，请使用服务引用而不是 Web 引用，这将生成部分类，您可以使用这些类来覆盖功能，而您的代码不会被生成器覆盖。

对于 Visual Studio 2005，您只需将*partial*关键字添加到 Reference.cs 中的类，并使用您自己的分部类保留一个单独的文件：

```
public partial class WebServiceReference
 { public WebServiceReference(ExampleConfigurationClass config) 
    { /* ... */
    }
 }

WebServiceReference svc = new WebServiceReference(myConfig); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-26T13:13:50.587

我通过使我的类库的 web 引用动态化，然后将包含 web 引用的 applicationSettings 配置部分从 app.config 文件复制到我的 Sharepoint 站点 web.config 来解决这个问题。

请注意，您还需要将 applicationSettings 的条目复制到您的 web.config 中，因为它通常不在其中。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-09-24T04:24:21.090

您可以试试这个：与其使用动态 Web 引用，不如将其设为静态引用，这样 Reference.cs 中的代码就不会在 .config 文件中为 url 寻找值。然后对生成的 Web 服务客户端代码进行子类化，并在该派生类中添加您自己的逻辑来设置 .Url 属性。然后 VS.NET 可以重新生成所有它喜欢的 Reference.cs，并且您的 url 设置代码将保留。当然，您必须更新任何下游代码以使用您的派生类，但这应该是一个简单的全局替换。

# java - 是否可以定义一个 Java 类加载器，将完全不同的类返回给请求的类？

> ID：125377
> 
> 赞同：2
> 
> 时间：2008-09-24T04:07:35.543
> 
> 标签：java, reflection, classloader

我试过这个，但调用时得到一个 ClassNotFoundException ：

```
Class.forName("com.AClass", false, mySpecialLoader) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T06:22:58.200

ClassLoader 必须调用 defineClass 来获取 Class。根据defineClass的JavaDoc：

> 如果 name 不为 null，则它必须等于字节数组指定的类的二进制名称。

如果名称为空，它将从字节码中获取。所以你可以返回任何你想要的类，只要它叫做 com.AClass。换句话说，您可以拥有多个版本的 com.AClass。您甚至可以使用 JavaAssist 之类的东西动态创建一个类。

但这并不能解释 ClassNotFoundException - 听起来你的类加载器没有返回任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-10-22T21:57:59.503

不可能返回一个名称与请求名称不同的类。但是，可以使用 ASM 之类的字节码操作工具自动将要返回的类重命名为请求的类。

# maven-2 - 从自定义 mojo 访问 maven 插件的运行时配置的最佳方式？

> ID：125389
> 
> 赞同：15
> 
> 时间：2008-09-24T04:13:50.070
> 
> 标签：maven-2, maven-plugin

我正在编写一个自定义的 maven2 MOJO。我需要从这个 MOJO 访问另一个插件的运行时配置。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-07-02T10:06:20.067

您可以使用以下步骤获取当前在构建中使用的插件列表：

首先，您需要让 Maven 将当前项目注入到您的 mojo 中，您使用下面定义的类变量来获取它。

```
/**
 * The maven project.
 * 
 * @parameter expression="${project}"
 * @readonly
 */
 private MavenProject project; 
```

然后，您可以使用以下内容获取此构建中使用的插件列表。

```
mavenProject.getBuildPlugins() 
```

您可以遍历此列表，直到找到要从中提取配置的插件。

最后，您可以获得配置为 Xpp3Dom。

```
plugin.getConfiguration() 
```

注意：如果您更改其他插件配置（而不仅仅是提取信息），它只会在当前阶段而不是后续阶段保持更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-25T00:54:34.983

使用属性当然是一种方法，但并不理想。它仍然需要用户在整个 pom.xml 中的多个位置定义 ${propertyName}。我想让我的插件在不修改用户的 pom 的情况下工作，除了插件定义本身。

我不认为访问另一个 MOJO 的运行时属性是过于紧密的耦合。如果在构建层次结构中的任何位置定义了另一个 MOJO，我希望我的 MOJO 尊重相同的配置。

我目前的解决方案是：

```
private Plugin lookupPlugin(String key) {

    List plugins = getProject().getBuildPlugins();

    for (Iterator iterator = plugins.iterator(); iterator.hasNext();) {
        Plugin plugin = (Plugin) iterator.next();
        if(key.equalsIgnoreCase(plugin.getKey())) {
            return plugin;
        }
    }
    return null;
}

/**
 * Extracts nested values from the given config object into a List.
 * 
 * @param childname the name of the first subelement that contains the list
 * @param config the actual config object
 */
private List extractNestedStrings(String childname, Xpp3Dom config) {

    final Xpp3Dom subelement = config.getChild(childname);
    if (subelement != null) {
        List result = new LinkedList();
        final Xpp3Dom[] children = subelement.getChildren();
        for (int i = 0; i < children.length; i++) {
            final Xpp3Dom child = children[i];
            result.add(child.getValue());
        }
        getLog().info("Extracted strings: " + result);
        return result;
    }

    return null;
} 
```

这适用于我测试过的少数小型构建。包括多模块构建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T21:46:36.310

我不确定您将如何做到这一点，但在我看来，这可能不是最好的设计决策。如果可能的话，您应该致力于将您的 Mojo 与任何其他插件分离。

相反，我建议使用自定义属性来排除单独插件配置中的任何重复。

您可以使用属性部分在 pom 中设置自定义属性“foo”：

```
<project>
  ...
  <properties>
    <foo>value</foo>
  </properties>
  ...
</project> 
```

现在可以使用美元符号 + 花括号符号在 pom 中的任何位置访问属性 foo：

```
<somePluginProperty>${foo}</somePluginProperty> 
```

# exception - 中断和异常

> ID：125394
> 
> 赞同：22
> 
> 时间：2008-09-24T04:17:40.527
> 
> 标签：exception, terminology, interrupt

我在这里看到了几个关于[异常](https://stackoverflow.com/questions/tagged/exception?sort=votes)的问题，其中一些暗示将[中断作为异常](https://stackoverflow.com/search?s=interrupt+exception)，但没有一个能明确连接。

*   什么是中断？

*   什么是例外？（请说明您知道的每种语言的例外情况，因为存在一些差异）

*   什么时候异常是中断，反之亦然？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-09-24T05:44:21.957

您的处理器将有许多外部中断引脚。通常，这些引脚连接到硬件并用于指示某些外部事件何时发生。例如，如果您使用的是串行端口，UART 将提升连接到处理器上的中断引脚之一的引脚，以指示已接收到一个字节。

定时器、USB 控制器等其他外设也会根据一些外部事件产生中断。

当处理器在它的一个外部中断引脚上接收到信号时，它将立即跳转到内存中的某个指定位置并开始执行。执行的代码通常称为 ISR 或中断服务程序。除非您正在实施驱动程序或执行某种嵌入式软件，否则您不太可能遇到 ISR。

不幸的是，关于异常的问题的答案不太清楚 - 本页的其他答案中列出了 3 种不同的含义。

Ron Savage 的回答是指软件结构。这纯粹是一个应用程序级异常，其中一段代码能够指示可以被其他一些代码检测到的错误。这里根本没有硬件参与。

然后是任务所见的异常。这是一个操作系统级别的构造，用于在任务执行非法操作时终止任务 - 例如除以 0、非法访问内存等。

第三，存在硬件异常。就行为而言，它与中断相同，因为处理器将立即跳转到某个指定的内存位置并开始执行。异常与中断的不同之处在于异常是由处理器检测到的某些非法活动引起的。例如，处理器上的 MMU 会检测到非法内存访问并引发异常。这些硬件异常是操作系统执行其清理任务的初始触发器（如上段所述）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2008-09-24T06:11:04.217

中断由 CPU 外部的设备（定时器滴答、磁盘操作完成、网络数据包到达等）生成，并且与程序执行**异步。**异常与程序执行**同步**（例如被零除，访问无效地址）。

除非您的程序在没有操作系统的情况下执行（或者您正在开发操作系统），否则它永远不会看到原始异常/中断。它们被操作系统捕获并由它处理（中断），或者在被反射回用户程序之前转换为其他形式（例如 UNIX 上的信号，Windows 上的结构化异常处理（SEH）），在那里它有机会处理它。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-09-24T04:25:02.007

中断是由硬件或特定 CPU 指令生成的 CPU 信号。这些会导致中断处理程序被执行。来自 I/O 硬件的 I/O 信号等事物会产生中断。

异常可以被认为是中断的软件版本，它只影响其进程。

我不确定确切的细节，但是*可以*通过中断来实现异常。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2008-09-24T12:23:07.723

中断表明处理器内核外部的某些东西需要引起注意。它中断程序的正常流程，执行中断服务程序 (ISR)，并通常返回到中断发生之前的位置。

这个基本主题有很多变化：中断可能由软件生成，另一个任务可能在 ISR 之后获得 CPU，等等。关键是中断可能随时发生，原因是代码/CPU**没有控制**。

定义异常有点棘手，因为它可能具有三个层次的含义：

**硬件异常**

某些处理器（例如 PowerPC）定义异常以指示发生了某种异常情况：系统重置、无效地址、某些虚拟地址转换缓存未命中等...

这些异常也用于实现断点和系统调用。在这种情况下，它们的行为几乎就像中断。

**操作系统异常**

一些硬件异常将由操作系统处理。例如，您的程序访问无效内存。这将导致硬件异常。操作系统有一个针对该异常的处理程序，并且很可能操作系统会向您的应用程序（例如 SIGSEGV）发送一个**信号**，表示存在问题。

如果您的程序安装了信号处理程序，则信号处理程序将运行并有望处理这种情况。如果您没有信号处理程序，则可以终止或暂停程序。

我认为窗口的结构化异常处理程序 (SEH) 就是这种类型的异常。

**软件异常**

Some languages like Java, C++ and C# have the concept of software exceptions, where the language provides for the handling of unforeseen or unusual conditions *related to the operation of the program*. In this case, an exception is raised at some point in the code and some code higher up on the program execution stack would "catch" the exception and execute. This is what try/catch blocks do.

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-24T04:57:41.227

我将详细说明什么是中断，因为目前还没有人处理过一种关键类型的中断：计时器。

但首先，让我备份。当您收到中断时，您的中断处理程序（位于内核空间中）运行，通常禁用中断，查看任何待处理的业务（处理刚刚到达网络的数据包，处理击键等）然后（记住我们'此时仍在内核中）确定下一个应该运行的进程（可能是同一个进程，可能是不同的进程，取决于调度程序）然后运行它。

在任何给定时间，只有一个进程在处理器上运行。当您使用多任务操作系统时，它在它们之间切换的方式称为上下文切换 - 基本上处理器的寄存器被转储到内存中，流传递到新进程，当进程完成时，您将上下文切换到某些东西别的。

因此，假设我编写了一个简单的 C 程序来计算所有数字、斐波那契数列或其他东西而不会停止。甚至更好：除了在 while(1) 循环内旋转之外什么都不做。系统上的其他进程如何获得运行的机会？如果没有任何事情发生导致中断怎么办？

答案是您有一个不断中断的计时器设备。它是防止旋转过程破坏整个系统的原因。虽然我会注意到中断处理程序禁用中断，所以如果你做一些无限期阻塞的事情，你可以关闭整个系统。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2008-09-24T05:19:27.353

## 例外

一个例外是处理器执行不在其正常路径上的代码。这是正常操作的“例外”，它本质上是通过代码和控制结构进行的线性移动。不同的语言支持各种类型的异常，通常用于处理程序运行期间的错误。

## 打断

中断是硬件级别的异常（通常）。中断是处理器中的一个物理信号，它告诉 CPU 存储其当前状态并跳转到中断（或异常）处理程序代码。一旦处理程序完成，原始状态就会恢复并且可以继续处理。

中断总是例外，即使它是有意的。中断可能表明：

*   错误，例如内存访问冲突
*   操作系统需要执行操作以支持正在运行的程序，例如软件中断或内存分页请求
*   需要注意的硬件设备，例如收到的网络数据包或空的传输缓冲区

这些总是迫使处理器暂停其当前活动以处理引发的异常，只有在中断处理程序完成后才会恢复。

## 陷阱

在中断方面，常见的陷阱是竞争条件。例如，您可能有一个周期性地增加全局实时时钟的中断。在 32 位机器上，时钟可能是 64 位。

如果程序正在读取时钟，并获得第一个 32 位字，则中断发生，一旦中断处理程序退出，该进程将获得第二个 32 位字，数据将不连贯——这两个字可能不同步. 如果您尝试使用互斥锁或信号量来锁定进程中的变量，那么中断将挂起等待锁定并停止系统（死锁），除非处理程序和使用数据的进程都非常仔细地编写。写中断时很容易遇到麻烦。

可重入函数也是另一个问题。如果您在程序代码中执行 funcA，请使用一个也执行 funcA 的中断，您可能会因共享变量（静态或堆变量、类等）而导致意外后果。您通常希望在中断处理程序中执行尽可能少的代码，并经常让它设置一个标志，以便该进程稍后可以完成实际工作，而不必担心冲突。

在某些方面，这类似于为多处理器开发，这也是为什么内核编程仍然被许多人认为是黑魔法的原因之一。

-亚当

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-09-24T04:36:04.633

预计中断会定期发生（尽管有时它们不是定期发生的）。它们会**中断**cpu，因为刚刚发生了一些重要的事情，需要立即处理。

例外应该是规则的**例外**；这些是由软件抛出的，因为发生了意想不到的事情，这是您尝试对此做些什么的机会，或者至少可以优雅地崩溃。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-24T04:25:08.637

当您谈论中断和异常时，您通常会接近硬件级代码，并且中断和异常通常部分由硬件实现，部分由软件实现。

中断是硬件中的事件（或在程序集中手动触发），它与可用于处理中断事件的处理程序向量相关联，例如 IO 完成、IO 错误（磁盘内存故障）、IO 事件（鼠标移动）例如）。当某些意外中断发生时，中断通常会引发异常。

异常是一种意料之外的行为，通常在使用硬件时，这些异常来自中断，并使用中断处理程序在软件中单独处理。我们看到的编程语言几乎总是将其伪装成某种控制结构。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-24T04:28:20.860

通常，中断是某种硬件实现的陷阱。您为特定中断注册一个处理程序（除以 0，外设上可用的数据，定时器到期），当该事件发生时，所有处理系统范围的暂停，您快速处理中断，然后事情继续。这些通常在设备驱动程序或内核中实现。

异常是一种处理代码错误的软件实现方式。您为特定（或一般）异常设置处理程序。当发生异常时，语言运行时将开始展开堆栈，直到它到达该特定处理程序的处理程序。此时，您可以处理异常并继续，或退出您的程序。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2008-09-24T04:28:41.623

中断基本上是硬件驱动的，例如您的打印机指示它“缺纸”或网卡指示它已失去连接。

异常只是程序中的错误条件，由 try / catch 块检测到。像：

```
Try
   {
   ... various code steps that "throw exceptions" on error ...
   }
catch (exception e)
   {
   print 'Crap! Something bad happened.' + e.toString()
   } 
```

这是捕获代码块中发生的“任何错误”的便捷方法，因此您可以以类似的方式处理它们。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-24T07:01:28.637

保持简单...

当你处理完一个中断后，你（通常）会回到你被打断之前正在做的事情。

处理异常涉及丢弃您当前正在处理的连续层，直到您冒泡到可以处理（捕获）异常的地步。

在处理中断时，您可能会决定抛出异常，但这并不意味着您必须将中断本身视为异常。异常不会“打断”（因为这意味着有可能回到你被打断之前正在做的事情）；而是他们“中止”（某些子集）您当前的活动。

而且，正如已经多次提到的，中断通常由硬件或用户等外部实体触发（例如鼠标单击或 CTRL-C 之类的击键），而异常由软件检测到“问题”或“特殊情况”。

# c# - 如何在不重新编译的情况下在 .NET 中动态切换 Web 服务地址？

> ID：125399
> 
> 赞同：71
> 
> 时间：2008-09-24T04:20:36.340
> 
> 标签：c#, visual-studio, web-services, url, wsdl

我有引用 Web 服务的代码，我希望该 Web 服务的地址是动态的（从数据库、配置文件等读取），以便轻松更改。它的一个主要用途是部署到机器名称和 IP 地址不同的多个环境中。Web 服务签名在所有部署中都是相同的，只是位于其他位置。

也许我刚刚被 Visual Studio“添加 Web 引用”向导宠坏了——不过，这似乎应该是相对容易的事情。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2008-09-24T04:24:55.363

当您生成 Web 引用并单击解决方案资源管理器中的 Web 引用时。在属性窗格中，您应该会看到如下内容：

![Web 参考属性](https://www.codeproject.com/KB/XML/WSDLDynamicURL/URL_Behavior_Dynamic.GIF)

将值更改为动态将在您的 app.config 中添加一个条目。

这是包含更多信息的[CodePlex 文章。](http://www.codeproject.com/KB/XML/wsdldynamicurl.aspx)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2008-09-24T14:56:22.973

如果你真的是动态设置它，你应该设置你正在调用的代理类实例的 .Url 字段。

在程序中设置 .config 文件中的值：

1.  是一个烂摊子;

2.  在下一个应用程序启动之前可能不会被读取。

如果每次安装只需要完成一次，我会同意其他海报并使用 .config 文件和动态设置。

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2016-11-30T14:55:33.830

我知道这是一个老问题，但我们的解决方案比我在这里看到的要简单得多。我们将它用于 VS2010 及更高版本的 WCF 调用。字符串 url 可以来自应用设置或其他来源。在我的情况下，它是用户选择服务器的下拉列表。TheService 是通过 VS 添加服务引用配置的。

```
private void CallTheService( string url )
{
   TheService.TheServiceClient client = new TheService.TheServiceClient();
   client.Endpoint.Address = new System.ServiceModel.EndpointAddress(url);
   var results = client.AMethodFromTheService();
} 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-06-27T12:51:11.507

我已经为这个问题苦苦挣扎了几天，最后灯泡发出了咔嗒声。能够在运行时更改 Web 服务的 URL 的关键是覆盖构造函数，我使用部分类声明进行了此操作。如上所述，将 URL 行为设置为 Dynamic 也必须完成。

这基本上创建了一个 Web 服务包装器，如果您必须在某个时候重新加载 Web 服务，通过添加服务引用，您不会丢失您的工作。Microsoft 对 Partial 类的帮助特别指出，这种构造的部分原因是创建 Web 服务包装器。 [http://msdn.microsoft.com/en-us/library/wa80x488(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/wa80x488(v=vs.100).aspx)

```
// Web Service Wrapper to override constructor to use custom ConfigSection 
// app.config values for URL/User/Pass
namespace myprogram.webservice
{
    public partial class MyWebService
    {
        public MyWebService(string szURL)
        {
            this.Url = szURL;
            if ((this.IsLocalFileSystemWebService(this.Url) == true))
            {
                this.UseDefaultCredentials = true;
                this.useDefaultCredentialsSetExplicitly = false;
            }
            else
            {
                this.useDefaultCredentialsSetExplicitly = true;
            }
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-09-24T04:22:43.697

将 URL 行为更改为“[动态](http://www.codeproject.com/KB/XML/wsdldynamicurl.aspx)”。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-24T05:31:11.910

只要 Web 服务方法和底层公开的类没有改变，它就相当简单。在 Visual Studio 2005（及更高版本）中，添加 Web 引用会创建一个包含此 URL 的 app.config（或 web.config，对于 Web 应用程序）部分。您所要做的就是编辑 app.config 文件以反映所需的 URL。

在我们的项目中，我们的简单方法是根据环境类型（开发、测试、生产）对 app.config 条目进行注释。因此，我们只需取消注释所需环境类型的条目。那里不需要特殊编码。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-24T06:13:31.047

只是关于静态和动态之间差异的说明。

*   **静态**：每次调用 Web 服务时都必须设置 URL 属性。这是因为如果 Web 服务位于代理类构造函数中，则为基本 URL。
*   **动态**：将在您的*web.config*文件中为您创建一个特殊的配置密钥。默认情况下，代理类将从此键读取 URL。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-24T04:30:18.033

如果您从数据库中获取 URL，您可以手动将其分配给 Web 服务代理类 URL 属性。这应该在调用 web 方法之前完成。

如果您想使用配置文件，可以将代理类 URL 行为设置为动态。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-24T15:19:52.963

绝对使用 Url 属性是要走的路。是否将其设置在 app.config、数据库或第三个位置取决于您的配置需求。有时您不希望应用程序在您更改 Web 服务位置时重新启动。您可能没有负载均衡器来扩展后端。您可能正在热修补 Web 服务错误。您的实现也可能存在安全配置问题。无论是生产数据库用户名和密码，还是 ws 安全身份验证信息。适当的职责分离可以让您进入一些更复杂的配置设置。

如果您在代理生成的类周围添加一个包装器类，则可以在每次创建包装器类以调用 Web 方法时以某种统一的方式设置 Url 属性。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-02-22T21:08:23.300

打开孤岛探索者

右键单击 Web 服务将 URL 行为更改为动态

单击解决方案资源管理器中的“显示所有文件”图标

在网络参考中编辑 Reference.cs 文件

更改构造函数

```
public Service1() {
        this.Url = "URL"; // etc. string  variable this.Url = ConfigClass.myURL
      } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-05-11T13:02:59.073

对我来说，对 WebService 的引用是

> 服务参考

.

无论如何，这很容易。正如有人所说，您只需更改 web.config 文件中的 URL。

```
<system.serviceModel>
    <bindings>
      <basicHttpBinding>
        <binding name="YourServiceSoap" />
      </basicHttpBinding>
    </bindings>
    <client>
        **** CHANGE THE LINE BELOW TO CHANGE THE URL **** 
        <endpoint address="http://10.10.10.100:8080/services/YourService.asmx"
          binding="basicHttpBinding" bindingConfiguration="YourServiceSoap"
          contract="YourServiceRef.YourServiceSoap" name="YourServiceSoap" />
    </client> 
```

# c# - 通用 LINQ 查询谓词？

> ID：125400
> 
> 赞同：19
> 
> 时间：2008-09-24T04:20:38.023
> 
> 标签：c#, .net, sql, linq, lambda

不确定这是否可行，或者我是否正确表达了我正在寻找的内容，但我的库中反复有以下代码，并且想练习一些 DRY。我有一组基于用户提供的简单搜索字段 ala Google 查询的 SQL Server 表。我正在使用 LINQ 根据搜索字符串中的内容编写最终查询。我正在寻找一种使用泛型并传入 lambda 函数的方法来创建一个可重用的例程：

```
string[] arrayOfQueryTerms = getsTheArray();

var somequery = from q in dataContext.MyTable
                select q;

if (arrayOfQueryTerms.Length == 1)
{
    somequery = somequery.Where<MyTableEntity>(
        e => e.FieldName.StartsWith(arrayOfQueryTerms[0]));
}
else
{
    foreach(string queryTerm in arrayOfQueryTerms)
    {
        if (!String.IsNullOrEmpty(queryTerm))
        {
            somequery = somequery 
                        .Where<MyTableEntity>(
                            e => e.FieldName.Contains(queryTerm));
        }
    }
} 
```

我希望创建一个带有签名的通用方法，看起来像：

```
private IQueryable<T> getQuery(
    T MyTableEntity, string[] arrayOfQueryTerms, Func<T, bool> predicate) 
```

我在所有表中都使用相同的搜索策略，因此唯一真正不同的用法是搜索的 MyTable 和 MyTableEntity 以及搜索的 FieldName。这有意义吗？LINQ 有没有办法在 where 子句中动态传递要查询的字段名称？或者我可以将其作为谓词 lambda 传递吗？

```
e => e.FieldName.Contains(queryTerm) 
```

我意识到在 SQL 中有一百万种方法可以做到这一点，可能更容易，但我很乐意为这个保留 LINQ 家族中的所有内容。另外，我觉得泛型应该对这样的问题很方便。有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-09-24T04:29:11.123

听起来您正在寻找 Dynamic Linq。看看[这里](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)。这允许您将字符串作为参数传递给查询方法，例如：

```
var query = dataSource.Where("CategoryID == 2 && UnitPrice > 3")
                      .OrderBy("SupplierID"); 
```

编辑：关于这个主题的另一组帖子，使用 C# 4 的动态支持：[第 1](http://weblogs.asp.net/davidfowler/archive/2010/08/04/dynamic-linq-a-little-more-dynamic.aspx)部分和[第 2 部分](http://weblogs.asp.net/davidfowler/archive/2010/08/19/dynamic-linq-part-2-evolution.aspx)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-24T04:25:59.603

听起来你基本上想要一个条件谓词构建器..

我希望你能把它塑造成你想要的东西，祝你好运！

[http://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-24T04:32:46.730

您可能想查看表达式树：

```
IQueryable<T> getQuery<T>(T myTableEntity, string[] arrayOfQueryTerms, Expression<Func<T, bool>> predicate)
 { var fieldOrProperty = getMemberInfo(predicate);
   /* ... */
 }

MemberInfo getmemberInfo<T>(Expression<Func<T,bool> expr)
 { var memberExpr = expr as MemberExpression;
   if (memberExpr != null) return memberExpr.Member;
   throw new ArgumentException();
 }

var q = getQuery<FooTable>(foo, new[]{"Bar","Baz"}, x=>x.FieldName); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-08T21:16:58.320

我最近不得不做同样的事情。您将需要[Dynamic Linq](http://talesfromthebleedingedge.blogspot.com/2008/10/linq-to-entities-dynamic-linq-to.html) [这里](http://talesfromthebleedingedge.blogspot.com/2008/10/linq-to-entities-dynamic-linq-to.html)是一种保持这种强类型的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-18T13:00:48.873

我建议尝试使用**[Gridify](https://github.com/alirezanet/Gridify)**库。它更容易使用，也有更好的性能。

用法示例：

```
query = dataSource.ApplyFiltering("FiledName=John"); 
```

这是动态 LINQ 库之间的性能比较。 [![在此处输入图像描述](https://i.stack.imgur.com/rj3az.png)](https://i.stack.imgur.com/rj3az.png)

# java - 如何远程更新 Java 应用程序？

> ID：125409
> 
> 赞同：28
> 
> 时间：2008-09-24T04:24:53.613
> 
> 标签：java, release-management

我们有一个运行在多台计算机上的 Java 服务器应用程序，所有计算机都连接到 Internet，其中一些位于防火墙后面。我们需要从一个中心站点远程更新 JAR 文件和启动脚本，而不会对应用程序本身造成明显的中断。

该过程必须是无人值守和万无一失的（即，我们不能因为不及时的互联网中断而破坏应用程序）。

过去，我们使用各种外部脚本和实用程序来处理类似的任务，但由于它们有自己的依赖关系，结果更难维护且可移植性较差。在制作新东西之前，我想从社区获得一些意见。

有没有人已经找到了一个好的解决方案？有什么想法或建议吗？

*澄清一下：这个应用程序是一个服务器，但不适用于 web 应用程序（这里没有 webapp 容器或 WAR 文件）。它只是一个自主的 Java 程序。*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-24T05:18:29.150

您没有指定服务器应用程序的类型 - 我将假设您没有运行 Web 应用程序（因为部署 WAR 已经完成了您所说的操作，并且您很少需要 Web 应用程序来执行拉取类型如果您谈论的是 Web 应用程序，则以下讨论仍然适用 - 您只需为 WAR 文件而不是单个文件实现更新检查和 ping-pong）。

您可能想看看 jnlp - WebStart 基于此（这是一种客户端应用程序部署技术），但我很确定它可以定制为执行服务器类型应用程序的更新。无论如何，jnlp 在提供描述符方面做得很好，可用于下载所需 JAR 的所需版本......

对此的一些一般想法（我们在同一个存储桶中有几个应用程序，并且正在考虑自动更新机制）：

1.  考虑在启动应用程序之前拥有一个能够读取 jnlp 文件并下载所需/更新的 jar 的 bootstrap.jar 文件。

2.  JAR 文件即使在应用程序运行时*也*可以更新（至少在 Windows 上，这是最有可能锁定运行文件的操作系统）。如果您使用自定义类加载器，或者您有一堆可能随时加载或卸载的 JAR，您可能会遇到问题，但是如果您创建机制来防止这种情况，那么覆盖 JAR 然后重新启动应用程序应该是足以更新。

3.  即使可以覆盖 JAR，您也可能需要考虑为您的 lib 路径使用 ping-pong 方法（如果您尚未将应用启动器配置为自动读取 lib 文件夹中的所有 jar 文件并将它们添加到类路径，那么这就是你真正想做的事情）。以下是乒乓球的工作原理：

应用程序启动并查看 lib-ping\version.properties 和 lib-pong\version.properties 并确定哪个更新。假设 lib-ping 有更高版本。启动器搜索 lib-ping*.jar 并在启动期间将这些文件添加到 CP。当您进行更新时，您将 jar 文件下载到 lib-pong 中（或者如果您想节省带宽并且 JAR 并没有实际更改，则从 lib-ping 复制 jar 文件 - 不过，这很少值得付出努力！）。将所有 JAR 复制到 lib-pong 后，您要做的最后一件事是创建 version.properties 文件（这样可以检测并清除导致部分 lib 文件夹的中断更新）。最后，您重新启动应用程序，引导程序会发现 lib-pong 是所需的类路径。

4.  如上所述的 ping-pong 允许回滚。如果你设计得当，你可以拥有一个你测试的应用程序，然后永远不要更改该检查以查看它是否应该回滚给定版本。这样，如果您确实搞砸并部署了破坏应用程序的东西，您可以使版本无效。这部分应用程序只需从坏的 lib-* 文件夹中删除 version.properties 文件，然后重新启动。保持这部分污垢简单很重要，因为它是您的故障保险。

5.  您可以拥有超过 2 个文件夹（例如，而不是 ping/pong，只拥有 lib-yyyymmdd 并清除除最新的 5 个以外的所有文件夹）。这允许对 JAR 进行更高级（但更复杂！）的回滚。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-24T06:27:49.293

您绝对应该看看 OSGi，它是为这些情况（尤其是嵌入式产品）而创建的，并且被大量公司使用。您可以在应用程序运行时更新 jar“捆绑包”、添加和删除它们。我自己没有使用过，所以我不知道开源框架/服务器的质量，但这里有一堆有用的链接可以帮助你入门：

[http://www.osgi.org/Main/HomePage](http://www.osgi.org/Main/HomePage)
[http://www.aqute.biz/Code/Bnd](http://www.aqute.biz/Code/Bnd)
[http://blog.springsource.com/2008/02/18/creating-osgi-bundles/](http://blog.springsource.com/2008/02/18/creating-osgi-bundles/)
[http: //blog.springsource.com/](http://blog.springsource.com/)
[http://www.knopflerfish.org/](http://www.knopflerfish.org/)
[http://felix.apache.org/site/index.html](http://felix.apache.org/site/index.html)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-24T04:29:13.823

我推荐 Capistrano 进行多服务器部署。虽然它是为部署 Rails 应用程序而构建的，但我已经看到它成功地用于部署 Java 应用程序。

链接： [Capistrano 2.0 不仅适用于 Rails](http://www.oreillynet.com/ruby/blog/2007/04/capistrano_20_not_just_for_rai.html "Capistrano 2.0 不仅仅适用于 Rails")

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-24T06:04:58.243

使更新原子化非常困难，特别是如果您有任何数据库更新要做。

但是，如果您不这样做，您可以做的是首先确保您的应用程序可以从相对路径运行。也就是说，您可以将您的应用程序放在某个目录中，并且所有重要文件都相对于该位置找到，因此您的实际安装位​​置并不重要。

接下来，复制您的安装。现在，您拥有“运行”版本和“新”版本。

使用您喜欢的任何技术（FTP、rsync、纸带、任何您喜欢的技术）更新“新”版本。

验证您的安装（校验和、快速单元测试，无论您需要什么——如果您愿意，甚至可以在测试端口上启动它）。

当您对新安装感到满意时，关闭原始运行实例，重命名原始目录（mv application application_old），重命名 NEW 目录（mv application_new application），然后重新启动它。

您的停机时间减少到服务器关闭和启动时间（因为重命名是“免费的”）。

如果您偶然发现一个严重错误，您的原始版本仍然存在。停止新服务器，将其重命名，重新启动旧服务器。非常快的回落。

另一件好事是您的服务基础设施是静态的（如您的 rc 脚本、cron 作业等），因为它们指向“应用程序”目录，并且它不会改变。

它也可以通过软链接而不是重命名目录来完成。无论哪种方式都很好。

但是该技术很简单，如果您的应用程序配合使用，则几乎是无懈可击的。

现在，如果您有数据库更改，那将是完全不同的讨厌问题。理想情况下，如果您可以使您的数据库更改“向后兼容”，那么希望旧的应用程序版本可以在新模式上运行，但这并不总是可能的。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-24T04:30:04.397

当 JVM 在其上运行时，无法修改 Jars，这将导致错误。我已经尝试过类似的任务，我想出的最好的方法是复制更新的 Jar 并将启动脚本转换为查看该 Jar。一旦你有了更新的 Jar，启动它并等待旧 Jar 在发出信号后结束。不幸的是，这意味着在几秒钟内丢失 GUI 等，但是在 java 中序列化大多数结构很容易，并且当前的 GUI 可以在实际关闭之前转移到更新的应用程序（尽管有些东西可能无法序列化！）。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-07-21T18:04:42.083

我会使用 ansible 将 jar 分发到多个服务器并运行更新脚本。

对于用户来说不明显的更新，应用程序必须停止旧实例并快速启动一个新实例，其中 Java 应用程序不是很好。

有很多方法可以在不停机的情况下进行更新，但它们都不是免费的。选择一个解决方案时，您应该考虑您可以接受的停机时间以及实现它的成本。

我看到两个选项：

1.  滚动更新，这意味着每次更新时都会使用新版本启动一个实例，然后验证它是否正常工作，如果是，则终止旧版本。此解决方案将需要某种代理（例如 haproxy），它将流量引导到有效实例。
2.  优化应用程序启动时间。

正如 Will Hartung 提到的，您还必须考虑外部依赖项，例如您可能还想更新的数据库模式。为了获得无缝更新，您可能还希望对数据库进行滚动更新。它要求您不要在应用程序的任何两个连续版本之间引入任何重大更改。例如。当您要删除列时，在第一个版本中，您删除应用程序中对该列的所有引用，在下一个版本中，您可以删除数据库中的列。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-24T05:25:55.247

我相信如果您使用像[SpringSource dm Server](http://www.springsource.com/products/suite/dmserver)这样的基于 OSGi 的应用服务器，您可以热部署 JAR 文件。我自己从未使用过它，但知道 Spring 产品组合的一般质量，我相信它值得一看。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-09-24T07:36:44.747

我们使用的是OSGi的更新系统Eclipse，体验非常好。

受到推崇的！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-01T16:03:27.077

最新版本的 Java Web Start 允许在本地缓​​存中注入应用程序而无需实际调用程序，并且可以将其标记为“离线”。由于缓存是用来调用程序的，它只会在下次运行时更新。为此，您很可能需要名称中带有版本号的 jar（例如 our-library-2009-06-01.jar）。

# php - PHP 和 Dreamweaver 集成

> ID：125427
> 
> 赞同：0
> 
> 时间：2008-09-24T04:31:10.760
> 
> 标签：php, dreamweaver

这是我在设计网站时遇到的问题。我正在为站点使用基于模板的设计，因此当访问页面时，页面上的信息会被放入模板中。显示的信息会根据作为 GET 请求传入的页面属性而变化。

因此，要将信息实际加载到页面的正文区域，给定的 PHP 脚本需要在结束时将该信息放在 $bodyout 变量中。这很好，但是信息随后在 Dreamweaver 中显示为一个可爱的黄色框，从而无法对站点进行 WYSIWYG 编辑。

理想情况下，对于站点上的大多数页面，我希望我的秘书能够进入 Dreamweaver 中编辑页面，因为她根本不懂 PHP。有没有一种优雅的方式让 PHP 脚本显示它将在 Dreamweaver 中输出的数据？（特别是如果该数据是静态的）

*编辑*我应该澄清：通过基于模板的设计，我不是指任何特定的程序。我只是在一个脚本中包含“布局”HTML/CSS，并且该脚本会用内容填充自己。到目前为止，整个事情都是 PHP，没有涉及第三方程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T04:57:06.313

简而言之，没有。但是，如果您使用的程序能够使用不同的模板引擎，它至少可以生成不会导致 Dreamweaver 崩溃的有效 HTML。听起来您可能不是生成模板的应用程序的开发人员，但如果您有兴趣，[这个网站](http://www.phpwact.org/pattern/template_view)解释了一堆关于模板的不同想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T05:11:14.830

我做了一个非常相似的事情，最后我只是设置了一个基于 Web 的可视化编辑器。客户端可以在线编辑一些页面的主体。这可能是你最好的解决方案。不幸的是，我不记得我可以设置为仅编辑页面的某些部分的编辑器的名称。当我找到它时，我会再次回复。
您的另一个选择是使用 Dreamweaver 模板并将 PHP 设置为加载整个页面、标题和所有内容。尽管 Dreamweaver 模板相当脆弱，我也遇到过问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T06:29:59.803

Dreamweaver 永远不会很好地集成到这种情况中，但听起来它可能无论如何都无法满足您的需求，因为它确实更适合页面布局类型的工作。

从您所说的来看，带有像[TinyMCE](http://tinymce.moxiecode.com/)（或其他）这样的内联编辑器的简单内容管理系统可能就足够了。

# vba - 保护 Excel 中的单元格，但允许通过 VBA 脚本修改这些单元格

> ID：125449
> 
> 赞同：63
> 
> 时间：2008-09-24T04:43:02.713
> 
> 标签：vba, excel

我正在使用 Excel，其中某些字段允许用户输入，而其他单元格将受到保护。我使用了工具保护表，但是在这样做之后我无法更改 VBA 脚本中的值。我需要限制工作表以停止用户输入，同时允许 VBA 代码根据某些计算更改单元格值。

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2008-09-24T08:29:55.833

尝试使用

```
Worksheet.Protect "Password", UserInterfaceOnly := True 
```

如果 UserInterfaceOnly 参数设置为 true，则 VBA 代码可以修改受保护的单元格。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2008-09-24T12:14:33.843

您可以通过执行这些操作通过代码修改工作表

*   取消保护
*   调整
*   保护

在代码中，这将是：

```
Sub UnProtect_Modify_Protect()

  ThisWorkbook.Worksheets("Sheet1").Unprotect Password:="Password"
'Unprotect

  ThisWorkbook.ActiveSheet.Range("A1").FormulaR1C1 = "Changed"
'Modify

  ThisWorkbook.Worksheets("Sheet1").Protect Password:="Password"
'Protect

End Sub 
```

这种方法的**弱点**是，如果代码被中断并且错误处理没有捕获它，工作表可能会处于不受保护的状态。

可以通过采取这些措施来**改进**代码

*   重新保护
*   调整

执行此操作的代码是：

```
Sub Re-Protect_Modify()

ThisWorkbook.Worksheets("Sheet1").Protect Password:="Password", _
 UserInterfaceOnly:=True
'Protect, even if already protected

  ThisWorkbook.ActiveSheet.Range("A1").FormulaR1C1 = "Changed"
'Modify

End Sub 
```

此代码更新工作表上的保护，但将“UserInterfaceOnly”设置为 true。这允许 VBA 代码修改工作表，同时保护工作表免受用户通过 UI 输入的影响，即使执行被中断。

关闭并重新打开工作簿时，此设置将**丢失。**仍然保持工作表保护。

因此，“重新保护”代码需要包含在任何尝试修改工作表的过程的开头，或者可以在打开工作簿时运行一次。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-02-10T16:36:48.747

一个基本但易于理解的答案：

```
Sub Example()
    ActiveSheet.Unprotect
    Program logic...
    ActiveSheet.Protect
End Sub 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-24T05:04:59.430

~~我不认为您可以将工作表的任何部分设置为只能由 VBA 编辑~~，但您可以做一些具有基本相同效果的事情 - 您可以在需要进行更改之前取消保护 VBA 中的工作表：

```
wksht.Unprotect() 
```

完成后重新保护它：

```
wksht.Protect() 
```

编辑：看起来这种解决方法可能已经解决了 Dheer 的直接问题，但是对于以后遇到这个问题/答案的任何人来说，我的答案的第一部分是错误的，正如乔在下面指出的那样。您*可以*保护工作表仅可由 VBA 编辑，但似乎只有在代码中调用“Worksheet.Protect”时才能设置“UserInterfaceOnly”选项。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-02-22T01:45:02.193

作为一种解决方法，您可以创建一个**隐藏的工作表**，它将保存更改的值。可见的受保护工作表上的单元格应使用简单公式显示隐藏工作表中的值。

您将能够**通过隐藏的工作表更改显示的值**，而您的用户将无法对其进行编辑。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-05-12T06:42:38.243

我在 sheet1 中选择了我想要锁定的单元格，并将建议的代码放在 open_workbook() 函数中，并像魅力一样工作。

```
ThisWorkbook.Worksheets("Sheet1").Protect Password:="Password", _
UserInterfaceOnly:=True 
```

# domain-driven-design - 使用 Linq to Sql 和 C# 的 Repository 模式的实现示例

> ID：125453
> 
> 赞同：11
> 
> 时间：2008-09-24T04:44:31.023
> 
> 标签：domain-driven-design, repository-pattern

我正在为我的 ASP.net MVC 应用程序寻找遵循域驱动设计原则的存储库模式实现示例/资源。有没有人可以分享一个很好的例子或学习资源？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-24T20:08:21.740

这不是一个没有争议的实现，但是 Rob Conery 的 Web 店面项目已经通过 Linq to Sql 在 C# 中实现了存储库。

[http://blog.wekeroad.com/](http://blog.wekeroad.com/)

来源可用。

他并没有做严格的 DDD，但他的 TDD 通常会将他派往那个方向。需要注意的是，他有多个没有聚合根的存储库，因此它远非教科书示例。此外，存储库的早期实现返回 IQueryable，因此存储库上没有域边界，这是他的设计产生的大部分噪音的来源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T05:04:27.093

Eric Evans 的 Domain Driven Design 是了解存储库模式等的好地方。[http://dddcommunity.org/books/](http://dddcommunity.org/books/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-09-03T16:09:48.367

这是一篇描述使用 Linq to SQL 实现存储库模式的文章。完整代码是开源的，可在@github 获得。

[http://www.macskeptic.com/living/by/the/code/c/2009/07/02/the-repository-pattern/](http://www.macskeptic.com/living/by/the/code/c/2009/07/02/the-repository-pattern/)

# sql-server - 连接到另一个 SQL Server 的 T-SQL 语法是什么？

> ID：125457
> 
> 赞同：61
> 
> 时间：2008-09-24T04:45:49.040
> 
> 标签：sql-server, tsql, stored-procedures, ssms

如果我需要将存储过程 (SP) 从一个 SQL Server 复制到另一个，我右键单击 SSMS 中的 SP 并选择脚本存储过程作为 > 创建到 > 新查询编辑器窗口。然后我通过右键单击该窗口并选择 Connection > Change Connection... 来更改连接，然后选择新服务器和 F5 以在新服务器上运行创建。

所以我的问题是“连接到另一个 SQL Server 的 T-SQL 语法是什么？” 这样我就可以将其粘贴到创建脚本的顶部并按 F5 来运行它，它会切换到新服务器并运行创建脚本。

在输入问题时，我意识到如果我为您提供我正在尝试做的事情的背景，您可能会想出一个更快更好的方法来完成此任务。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2010-06-30T21:05:54.120

在 SQL Server Management Studio 中，从“查询”菜单打开 SQLCMD 模式。然后在脚本的顶部，输入以下命令

```
:Connect server_name[\instance_name] [-l timeout] [-U user_name [-P password] 
```

如果要连接多台服务器，请务必`GO`在连接之间插入；[否则，您的 T-SQL 将不会在您认为它会执行的服务器上执行。](http://www.sqlmatters.com/Articles/Changing%20the%20SQL%20Server%20connection%20within%20an%20SSMS%20Query%20Windows%20using%20SQLCMD%20Mode.aspx)

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2008-09-24T05:04:02.460

此外，请确保在编写涉及链接服务器的查询时，包括这样的括号：

```
SELECT * FROM [LinkedServer].[RemoteDatabase].[User].[Table] 
```

我发现至少在 2000/2005 年，[] 括号是必要的，至少在服务器名称周围是必需的。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2008-09-24T04:52:15.123

更新：要连接到另一个 sql server 并执行 sql 语句，您必须使用[sqlcmd Utility](http://msdn.microsoft.com/en-us/library/ms162773.aspx)。这通常在批处理文件中完成。如果您想在管理工作室中执行它，您可以将它与[xmp_cmdshell结合使用。](http://msdn.microsoft.com/en-us/library/aa260689(SQL.80).aspx)

* * *

一种方法是配置[链接服务器](http://msdn.microsoft.com/en-us/library/aa259589(SQL.80).aspx)。然后您可以将链接服务器和数据库名称附加到表名称中。（从linkedserver.database.dbo.TableName中选择*）

```
USE master
GO
EXEC sp_addlinkedserver 
    'SEATTLESales',
    N'SQL Server'
GO 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2008-09-24T05:06:46.040

如果我要解释这个问题 - 是否可以选择服务器上下文以在 DDL 中执行查询 - 答案是否定的。只能使用 USE 以编程方式选择数据库上下文。（已经在外部预先选择了服务器上下文）

链接服务器和 OPEN QUERY 可以提供对 DDL 的访问权限，但需要对代码进行一些重写以封装为字符串——这使得开发/调试变得困难。

或者，您可以求助于外部驱动程序来获取 SQL 文件，以通过 OPEN QUERY 发送到远程服务器。但是，在大多数情况下，您最好在第一处直接连接到服务器来评估 DDL。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2011-11-18T12:02:06.587

每当我们尝试从另一台服务器检索任何数据时，我们都需要两个步骤。

第一步：

```
-- Server one scalar variable
DECLARE @SERVER VARCHAR(MAX)
--Oracle is the server to which we want to connect
EXEC SP_ADDLINKEDSERVER @SERVER='ORACLE' 
```

第二步：

```
--DBO is the owner name to know table owner name execute (SP_HELP TABLENAME)    
SELECT * INTO DESTINATION_TABLE_NAME 
FROM ORACLE.SOURCE_DATABASENAME.DBO.SOURCE_TABLE 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-04-07T16:03:27.047

如果您要连接到多个服务器，则应在切换服务器之前添加“GO”，否则您的 sql 语句将针对错误的服务器运行。

例如

```
:CONNECT SERVER1
Select * from Table
GO
enter code here
:CONNECT SERVER1
Select * from Table
GO 
```

[http://www.sqlmatters.com/Articles/Changing%20the%20SQL%20Server%20connection%20within%20an%20SSMS%20Query%20Windows%20using%20SQLCMD%20Mode.aspx](http://www.sqlmatters.com/Articles/Changing%20the%20SQL%20Server%20connection%20within%20an%20SSMS%20Query%20Windows%20using%20SQLCMD%20Mode.aspx)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-09-24T04:51:14.767

尝试创建一个链接服务器（您可以使用[sp_addlinkedserver](http://msdn.microsoft.com/en-us/library/ms190479.aspx)来完成），然后使用[OPENQUERY](http://msdn.microsoft.com/en-us/library/ms188427.aspx)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-06-20T07:44:20.387

在我的 C 盘上，我首先创建一个 txt 文件来创建一个新表。你可以在这个文本文件中使用你想要的任何东西

在这种情况下，文本文件称为“Bedrijf.txt”

内容：

```
Print 'START(A) create table'

GO 1

If not EXISTS
(
    SELECT *
    FROM INFORMATION_SCHEMA.TABLES
    WHERE TABLE_NAME = 'Bedrijf'
)
BEGIN
CREATE TABLE [dbo].[Bedrijf] (
[IDBedrijf] [varchar] (38)   NOT NULL ,
[logo] [varbinary] (max) NULL ,
[VolledigeHandelsnaam] [varchar] (100)  NULL 
) ON [PRIMARY] 
```

保存

然后我创建另一个名为“Bedrijf.bat”和扩展名 bat 的 txt 文件。它的内容：

```
OSQL.EXE  -U Username -P Password -S IPaddress -i C:Bedrijf.txt -o C:Bedrijf.out -d myDatabaseName 
```

保存并从资源管理器中双击执行

结果将保存在 C 盘上名为“Bedrijf.out”的 txt 文件中

表明

```
1> 2> 3> START(A) create table 
```

如果一切顺利

就是这样

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-02-12T14:29:41.510

尝试 PowerShell 类型，如：

```
$cn = new-object system.data.SqlClient.SQLConnection("Data Source=server1;Initial Catalog=db1;User ID=user1;Password=password1");
$cmd = new-object system.data.sqlclient.sqlcommand("exec Proc1", $cn);
$cn.Open();
$cmd.CommandTimeout = 0
$cmd.ExecuteNonQuery()
$cn.Close(); 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2010-06-17T20:11:46.093

如果可能，请查看 SSIS（SQL Server 集成服务）。我只是用这个工具包弄湿了我的脚，但已经在循环超过 40 台服务器并准备造成各种破坏；）

# matrix - Xbox 360 上的 GPU 编程

> ID：125462
> 
> 赞同：7
> 
> 时间：2008-09-24T04:47:26.103
> 
> 标签：matrix, gpu, xbox360

我正在寻找有关 Xbox 360 上 XNA 的一些见解，主要是是否可以在其 GPU 上运行基于矢量的浮点数学？

如果有办法，你能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T05:28:07.487

我并不声称自己是这方面的专家，但希望这可以为您指明一个有用的方向。

是否可以？是的。您可能已经知道 GPU 擅长此类计算（因此提出了问题），并且您确实可以使用 XNA 控制 GPU。它是否适合您的需求是另一回事。

要使用 GPU，您可能想要使用 HLSL 编写着色器。在[Reimers](http://www.riemers.net/eng/Tutorials/XNA/Csharp/Series3/HLSL_introduction.php)的 XNA 环境中，您可能想通过它对 HLSL 进行了不错的介绍。值得注意的是，该教程侧重于让 GPU 进行与图形相关的运算，但您在着色器中编写的内容取决于您。如果您的基于矢量的浮点数学用于渲染（因此可以留在 GPU 域中），那么您很幸运，可以在这里停下来。

可能在屏幕上渲染不是您所追求的。现在，就进行数学运算而言，您在 HLSL 中拥有相当大的灵活性。然而，将结果输出到 CPU 并不是系统的设计方式。这对我来说变得越来越模糊，但 Shawn Hargreaves（XNA 开发人员）[不止一次](http://forums.xna.com/forums/t/13567.aspx)表示从 GPU 获取输出（除了在屏幕上渲染）是非常重要的，并且[会](http://forums.xna.com/forums/t/15390.aspx)影响性​​能。检索数据涉及对 GetData 的调用，这将[导致管道停顿](http://blogs.msdn.com/shawnhar/archive/2008/04/14/stalling-the-pipeline.aspx)。

所以可以做到。XNA 框架将允许您为 360 编写着色器（支持 Shader Model 3.0 以及一些扩展），并且*可以*得到这些结果，尽管它可能不足以满足您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-26T21:20:10.963

如上所述 - XBox360 完全能够进行任何 HLSL 计算，具体而言，它可以处理顶点和像素着色器模型 3 指令，并具有特定于平台的增强指令集。

由于 HLSL 实际上是基于矢量的，因此您拥有所需的所有工具 - 点、交叉、矢量运算和矩阵计算。如果您想将计算发送到 GPU 并在 CPU 上编辑/使用结果，您可以写入纹理，然后在 CPU 端获取它并对其进行解码 - 将其用于粒子或物理交互（例如水）很少您可能想要这样做的场合。

# oop - 糟糕的 OO 设计问题 - 我需要 Java 中的一些通用功能，但不知道如何实现它

> ID：125463
> 
> 赞同：2
> 
> 时间：2008-09-24T04:47:56.383
> 
> 标签：oop, interface, uml

我正在用 Java 开发一个小型 UML 类编辑器，主要是一个个人项目，如果我有时间在上面创建一个项目，它可能最终会出现在 SourceForge 上。

该项目非常先进：我可以创建类、移动它们、创建接口、创建链接等。

我正在处理的是用于设置类/接口属性和创建新类/接口的对话框。

例如，我有一个扩展 JDialog 的类。这是编辑类和接口的主要“窗口”（好吧，每个都有一个类）。它包含一个 JTabbedPane，而 JTabbedPane 又包含 JPanel。

这个 JPanel 实际上是自定义的。我创建了一个扩展 JPanel 的抽象类。此类使用组件（由其子类定义）并将它们的值添加到 JTable（也包含在 JPanel 中）。

例如，如果我想编辑一个类的属性，JPanel 将包含一个用于输入属性名称的 JTextField 以及另一个用于输入其类型的 JTextField。还有一组按钮用于处理在这些字段中输入的数据。当我单击“保存”时，我在 JTextFields 中输入的数据被添加到 JTable 中（à la Enterprise Architect）。扩展抽象类的具体类负责定义控制并决定当从 JTable 中添加或删除行时如何处理数据。然而，JTable 管理是抽象类的职责。

这是我的问题：在 OO 中，类有方法，接口也有方法。我告诉自己：我可以使用相同的具体自定义 JPanel（AttributesPanel（它扩展了我创建的抽象 JPanel 类））来存储类或接口的方法。

但是，该类需要保留我正在处理的类或接口的副本（作为属性）。这样，当向其中添加方法时，我可以调用editedClass.addMethod()（或editedInterface.addMethod()）。问题是我无法判断我是在使用类还是在接口上工作。

我找到的解决方案很丑：在 AttributesPanel 类中保留一个属性editedClass 和一个属性editedInterface。根据我是在编辑类还是接口，其中一个属性将为空，而另一个则不会。

如果你问我，这很丑陋。事实上，我可以听到我的软件工程老师在地狱的第九圈燃烧（实际上，冻结）时痛苦地尖叫。

解决此设计问题的快速方法是创建一个名为“ObjectWithMethods”的接口，我的 Class 和 Interface 类将实现该接口。这样，我只需在我的 AttributesPanel 类中放置一个 ObjectWithMethods 参数。

但这是否意味着我应该创建一个名为“ObjectWithAttributes”或“ObjectWithBlahBlah”的类？我在这里看到了一些很好的“TheDailyWTF”潜力......此外，我认为我不应该修改我的域对象（类、接口、注释、关系（对于我的 UML 编辑器））或创建一个新接口只是为了一些 UI 考虑....

你怎么看？

我你需要更多的澄清（因为我现在很累，而且在这种心态下我往往做得很糟糕（尤其是英语 - 我的母语是法语）......），请问我会编辑这个问题。

干杯，

纪尧姆。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T05:01:23.043

当我阅读您的问题时，您似乎真的在描述一个使用[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)的地方。

访问者模式应该在这里工作的原因是一种称为双重调度的想法。您的 UI 代码将进行调用并传递对自身的引用，然后类或接口最终会调用原始调用者。由于类或接口是调用方法的对象，因此它知道自己的类型以及如何执行特定于其类型的工作。

当然，我的描述不足以实现这种技术，因此您需要阅读它。我认为这是有据可查的。例如，我在 java 中大约 2 秒内发现了这应该让你开始：[http ://www.javaworld.com/javaworld/javatips/jw-javatip98.html](http://www.javaworld.com/javaworld/javatips/jw-javatip98.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-07-01T14:07:47.027

`if( .. instanceof ..)`通常，当我开始在我的代码中看到太多类似结构时，我只会做最直接的事情，并开始考虑分解接口。使用现代 IDE 代码重构功能并不会花费我太多。

在您的特定情况下，我会考虑实现[UML 规范](http://www.omg.org/spec/UML/)中提供的图表，因为它们非常友好地使用 UML 表示法指定 UML！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-07-01T17:03:52.803

你有一个应用程序。在那个应用程序中。您的代表，并编辑一些数据。

该数据表示编程语言类或编程语言接口。

当你为一些数据做编辑器时，有时你必须添加额外/补充信息，例如，每个类图表可能有不同的线条颜色，与你类的属性或方法无关。

指示您是在编辑类还是接口的字段或属性也是如此。

我建议做一些事情。

将表示的数据与程序的代码或逻辑分开：

如果你有类似的东西：

```
// all code, classes, mixed up
public class JCustomPanel:  {

    protected ChartClass Charts;
    protected ArrayList<String> MyClassAttributes;
    protected ArrayList<String> MyClassMethods;

    void PanelDoSomeThing();
    void ClassDoSomeThing();
    void InterfaceDoSomeThing();

    // ...
} // class JCustomPanel 
```

改成这样：

```
// things related to a single class or interface,
// nothing to do with the chart

public class JClassRepresentation:  {

    ArrayList<String> Attributes;
    ArrayList<String> Methods;

    bool IsInterface;

    void ClassDoSomeThing();
    void InterfaceDoSomeThing();

    // ...
} // class JCustomPanel

// things related to the editor,
// contains the classes and interfaces,
// but, as separate stuff
public class JCustomPanel:  {

    ArrayList<JClassRepresentation> Classes;

    int PagesCount;

    void InterfaceDoSomeThing();

    // ...
} // class JCustomPanel 
```

干杯。

# image - 移动页面：动态创建的图像零星加载

> ID：125465
> 
> 赞同：1
> 
> 时间：2008-09-24T04:49:39.217
> 
> 标签：image, mobile

我有一个小型移动站点的页面，该页面具有通过 getImage.aspx 方法设置其 src 值的图像，其中动态构建图像并返回到图像标记。大多数时候它工作得很好。但是，有些时候图像在第一次拍摄时就无法加载。在大多数情况下，点击刷新会有所帮助，但我希望每次都加载此图像。其他人有这个问题并超越它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T04:52:10.740

我从来没有遇到过在没有代码错误的情况下无法加载动态图像的问题。一个建议是将图像生成移动到处理程序而不是页面以避免额外的开销。可能是移动设备上的异步请求受到限制。

# dns - 使用 glibc，为什么在 I/DHCP 更改 DNS 服务器后我的 gethostbyname 失败？

> ID：125466
> 
> 赞同：6
> 
> 时间：2008-09-24T04:50:30.980
> 
> 标签：dns, glibc, dhcp

如果我们的服务器（在设备上运行）在获得 DHCP 租约之前启动，那么它永远无法使用主机名进行连接。

如果发生这种情况，它可以通过 IP 地址而不是 DNS 找到主机。

我最初认为 Curl DNS 缓存有问题，因为 curl 连接失败。但是我使用 CURLOPT_DNS_CACHE_TIMEOUT 来防止 curl 缓存地址，但连接仍然失败。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-24T04:58:27.667

事实证明，glibc gethostbyname_r 不会在配置发生更改时自动重新加载它的配置。您必须手动调用 res_init。请参阅下面的[错误报告](http://sources.redhat.com/bugzilla/show_bug.cgi?id=3675)。

注意：gethostbyname_r 和 rer_init 的手册页都没有提到这个限制。

我的解决方案非常具体。它适用于我们长期运行的服务器，但它不是我理想的解决方案。

我有一个函数可以检查 /etc/resolv.conf 的 mtime 与最后一个已知的 mtime（DNE 为 0）。如果这两个 mtime 不同，那么我调用 res_init。这个函数在程序启动时被调用，然后周期性地重新加载配置。

* * *

glibc[错误报告](http://sources.redhat.com/bugzilla/show_bug.cgi?id=3675)

> libc 永远缓存 resolv.conf
> 
> ...
> 
> 这就是 res_init() 的用途，称之为。

# ruby-on-rails - 条件重定向的最佳方法？

> ID：125467
> 
> 赞同：6
> 
> 时间：2008-09-24T04:50:42.960
> 
> 标签：ruby-on-rails, ruby, model-view-controller, redirect

使用 Rails v2.1，假设您有一个可从多个位置访问的控制器操作。例如，在 Rails 应用程序中，您有一个链接可以从两个不同的视图编辑用户，一个在用户索引视图上，另一个来自另一个视图（假设来自每个页面的导航栏）。

我想知道根据他们单击的链接将用户重定向回正确位置的最佳方法是什么。例如：

示例 1：

1.  列出所有用户
2.  在列表中的用户上单击“编辑”
3.  用户点击表单上的“保存”，控制器重定向回 1。

示例 2：

1.  用户可以在应用程序的任何页面上，导航栏显示编辑当前用户的链接
2.  用户点击链接进行编辑
3.  用户单击表单上的“保存”，当用户单击导航栏中的“编辑”链接时，控制器将重定向回他们所在的任何页面。

我在过去看到它是通过以下方式完成的：

1.  将参数放置在原始编辑链接上，并带有链接出现的原始控制器/动作。为了使这更干燥，您可以在帮助程序中使用@controller.controller_name 和@controller.action_name。
2.  控制器将参数保存到会话变量中。
3.  一旦控制器保存了记录，它就会重定向到会话变量。

我不特别喜欢这个解决方案的是需要将参数添加到视图中的每个适用链接。我想知道是否有办法将这一切都构建到控制器中。

我想的一种更好的方法是：

1.  在“编辑”操作上放置一个 before_filter 以将引用者（这是否足够可靠？）保存到会话中。
2.  当点击“更新”时，控制器将重定向到会话变量，然后删除会话变量。

对最好的方法有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T08:15:35.853

**Flash**：您将仅用于下一个请求的数据可以存储在闪存中。然后你不必去自动清除它。它适用于您确定只需要一次的有限应用程序上下文，而不仅仅是错误消息！

**我知道你上一次 HTTP 访问做了什么**：如果你只需要将人们重定向到他们上一次访问的 URL，那么就这样做。对于大多数不阻止信息的浏览器，request.referer 会为您提供此人的最后一个 URL。

```
#in edit controller
...
flash[:page_to_redirect_to] = request.referer || "/my/default/path"
...

#in save controller
redirect_to flash[:page_to_redirect_to] || "/my/default/path" 
```

顺便说一句，我不建议对它们进行硬编码。

**before_filter**：我看到很多 Rails 开发人员使用它作为他们最喜欢的锤子，并将其他所有东西都变成钉子。当您想要向控制器中的所有或几乎所有方法公开功能时，过滤器很有用。我不知道这里一定是这种情况，但是您的里程可能会有所不同。如果有必要，您可以将过滤器与上述两个技巧结合使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T05:02:08.003

我认为在编辑操作上使用 before_filter 是最不突兀的。

推荐人应该足够可靠......只需在没有推荐人可用的情况下设置一个默认值（例如：有人为编辑页面添加了书签），您应该没问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-01-02T15:15:34.967

另一种方法是在叠加层中加载表单，例如[http://flowplayer.org/tools/overlay/index.html](http://flowplayer.org/tools/overlay/index.html)，然后在 ajax 提交时关闭叠加层。我结合自动完成来提供“添加新”选项。提交覆盖表单后，我会以 json 格式返回一些数据，用于填充自动完成。（我制作了自己的[插件](https://github.com/dgm/jquery_autocomplete_helper)来帮助解决所有这些问题）

这需要更多的工作，但它确实对最终用户很有效。

# svn - 如何使SVN只更新文件而不添加新文件

> ID：125468
> 
> 赞同：0
> 
> 时间：2008-09-24T04:50:48.403
> 
> 标签：svn

我有一个彼此无关但对多个项目通用的文件存储库。每个项目可能只需要这些文件的一个子集。例如：

```
/myRepo:
    /jquery.js
    /jquery.form.js
    /jquery.ui.js 
```

项目 A 需要`jquery.js`and `jquery.form.js`，而项目 B 需要`jquery.js`and`jquery.ui.js`

我可以检查`myRepo`两个项目，但这会在两个项目中添加很多不必要的文件。我想要的是某种方式让每个项目只获取它需要的文件。我认为可能的一种方法是，如果我只将所需的文件放入每个项目中，然后在其`svn update`上运行，但以某种方式阻止 SVN 将新文件添加到每个目录。他们仍然会得到对现有文件的修改，但不会添加不必要的文件。

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T04:56:36.033

不要让自己复杂化。要么拉出所有文件（这样做的缺点是什么？还有几百 Ks 的空间？），或者将文件分成几个目录，只检查相关项目中需要的目录（使用'externals'属性） .

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T04:56:33.397

如果我正确理解了您的问题，您想跨项目共享代码吗？如果是这样，请查看 svn:externals 属性。

[Subversion 红皮书中解释的外部](http://svnbook.red-bean.com/en/1.4/svn.advanced.externals.html)

[svn：Windows 中的外部](http://www.systemwidgets.com/Support/SubversionArticles/SharedRepositoriesusingsvnexternals/tabid/81/Default.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T05:14:56.943

K，这并不完美，但可以。最大的问题是它会单独更新每个文件：

```
find . -print | grep -v '\.svn' | xargs svn update 
```

我相信有更多 find mojo 的人可以找到更好的方法来处理 svn 目录排除。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T05:15:24.163

在我们公司，我们将所有项目存储在同一个存储库中，但在它们自己的项目文件夹中。然后，如果需要共享代码，我们将其移出库文件夹。这有助于可重用性，并且不违反 DRY 原则。

因此，就服务器而言，您可以将所有库导出到一个中心位置，并将您的项目导出到任何地方，而不会重叠。

# .net - 需要创建一个动态的 ConfigurationSection 也持有该类型

> ID：125470
> 
> 赞同：2
> 
> 时间：2008-09-24T04:51:36.547
> 
> 标签：.net, configurationsection, system.configuration

我需要创建一个配置部分，它能够将键值对存储在 app.config 文件中，并且无论它们的类型如何，都可以在运行时添加键值对。值保持其原始类型也很重要。我需要扩展以下接口

```
public interface IPreferencesBackend
{
    bool TryGet<T>(string key, out T value);
    bool TrySet<T>(string key, T value); 
} 
```

在运行时，我可以这样说：

```
My.Foo.Data data = new My.Foo.Data("blabla");
Pref pref = new Preferences();
pref.TrySet("foo.data", data); 
pref.Save();

My.Foo.Data date = new My.Foo.Data();
pref.TryGet("foo.data", out data); 
```

我尝试使用 System.Configuration.Configuration.AppSettings，但问题在于它将键值对存储在字符串数组中。

我需要的是实现 System.Configuration.ConfigurationSection，我可以在其中控制单个设置的序列化方式。我注意到 Visual Studio 生成的设置就是这样做的。它使用反射来创建所有设置键。我需要的是动态地做这个运行时。

```
[System.Configuration.UserScopedSettingAttribute()]
[System.Diagnostics.DebuggerNonUserCodeAttribute()]
[System.Configuration.DefaultSettingValueAttribute("2008-09-24")]
public global::System.DateTime DateTime {
   get {
        return ((global::System.DateTime)(this["DateTime"]));
       }
   set {
        this["DateTime"] = value;
       }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T04:56:34.427

Phil Haack 有一篇关于[创建自定义配置部分的精彩文章](http://haacked.com/archive/2007/03/12/custom-configuration-sections-in-3-easy-steps.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-28T06:11:28.493

我在 codeproject.com 上发现了两篇很棒的文章，它们非常详细地解释了这些问题。

揭开 .NET 2.0 配置之谜 [http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration.aspx](http://www.codeproject.com/KB/dotnet/mysteriesofconfiguration.aspx)

应用的用户设置 [http://www.codeproject.com/KB/dotnet/user_settings.aspx?display=PrintAll&fid=1286606&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2647446&fr=26](http://www.codeproject.com/KB/dotnet/user_settings.aspx?display=PrintAll&fid=1286606&df=90&mpp=25&noise=3&sort=Position&view=Quick&select=2647446&fr=26)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T04:59:55.870

这就是您在 ASCII 文本文件中获得的全部内容 - 字符串。:-)

但是，您可以对“值”字符串进行编码以包含类型参数，例如：

```
<key="myParam" value="type, value" /> 
```

例如：

```
<key="payRate" value="money,85.79"/> 
```

然后让您的应用进行转换...

# membership - 如何在 ASP.NET 中将用户与他们各自的文件夹联系起来？

> ID：125473
> 
> 赞同：4
> 
> 时间：2008-09-24T04:53:10.427
> 
> 标签：membership, roles, asp.net-profiles

当用户A上传文件时，他的文件将上传到文件夹A，当用户B时，将上传到文件夹B，依此类推。ASP.NET 中的角色/配置文件。文件夹将是预先存在的。任何人？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T04:55:29.047

您可能需要手动编写代码。ASP.NET 没有任何内在的管理用户文件的功能。但是，这样做的代码应该相对容易。假设用户名是唯一的并且永远不会更改，您可以将用户名与路径组合（使用 Path.Combine）并上传到该位置。我还将锁定该位置，以便其他人无法访问它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T05:11:47.543

我过去的做法是使用基本上传文件夹（比如上传），并在该文件夹中使用数据库中的用户 ID 创建一个文件夹。因此，对于用户 ID 为 145 的用户，结构将是 ..\uploads\145。

我的代码做的第一件事是检查文件夹是否存在，如果不存在，则在上传之前调用 Directory.Create() （或任何语法）来创建文件夹。

您可能会发现有用的更多信息：我还使用 GUID 重命名文件，如果他们上传 2 个具有相同名称的文件，可以避免名称冲突。缺点是您通常需要维护一个包含原始文件名和物理 (GUID) 文件名的表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T04:56:07.737

您可以检查文件夹是否存在，如果不存在则为用户创建它，但这会带来安全隐患。您可能还想尝试将数据存储在数据库中并将其绑定到用户..这取决于您让用户上传的内容我猜。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T05:01:45.850

有几种方法可以做到这一点：

**使用表单身份验证**

如果您使用表单身份验证，您可以设置一个约定，其中用户的用户名或 ID 可以作为服务器中用户可以上传文件的路径的基础。请注意，您的用户将无法直接访问该文件夹：用户也应该能够通过您的 Web 应用程序从您的服务器下载文件。

**使用 Windows 身份验证**

如果您使用 Windows（例如 ActiveDirectory）身份验证，您可以为用户提供对文件夹的物理位置和通过 Web 应用程序的访问。

PS - 很高兴在这里见到你，马龙！

# ruby-on-rails - 存储为空或零的 MySql 上的 Rails 复选框

> ID：125496
> 
> 赞同：7
> 
> 时间：2008-09-24T05:01:50.000
> 
> 标签：ruby-on-rails, ruby

在我的 Rails 应用程序上，我有一个项目列表（如任务列表），每个项目都有几个复选框来设置参数。

当我提交表单时，选中的框在 DB 上存储为零，未选中的为空。

问题是：有没有办法配置它？将数据存储在更传统的 0 或 1 上，因为我认为将 null 存储为 false 并将 0 存储为 true 有点令人困惑，特别是如果另一个应用程序（如 C 应用程序）需要读取数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T15:02:10.417

假设您正在使用的属性是`club_member`“您是俱乐部成员吗？”。

请注意，在 Ruby/Rails 中，按照现在的工作方式，`if model.club_member`如果未选中（值为 null 或在 Ruby 中为 nil），则返回 false，如果选中（值为 0）则返回 true。

总的来说，我强烈建议不要让其他应用程序（如 C 应用程序）直接访问您的数据，而应该在 Ruby/Rails 中构建一个 API，以将应用程序中的数据公开给外部实体。通过这种方式，您将更好地封装应用程序的内部结构，而不必担心此类事情。

* * *

但是，话虽如此，这是您的答案：

采用：

```
value="1" 
```

...属性在您的复选框 HTML 标记中，并将**布尔**属性的默认值（在您的迁移中）设置为 0。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T05:09:46.707

造成这种情况的潜在原因有很多：

*   确保数据库中的列在迁移中属于“布尔”类型
*   为布尔值设置默认值
*   在表单上使用“check_box”，而不是“check_box_tag”
*   某些版本的 Rails 在生成的脚手架上有这种行为，我认为设置默认值可以解决这个问题，但我不太记得了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-04-08T12:52:14.020

关于什么：

`value.to_i.zero?`

```
>> a=nil
=> nil
>> a.to_i.zero?
=> true
>> a=0
=> 0
>> a.to_i.zero?
=> true
>> a=3
=> 3
>> a.to_i.zero?
=> false 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-09-04T07:37:08.103

从 Rails 文档中：

如果对象为假、空或空白字符串，则该对象为空。例如，“”、“”、nil、[] 和 {} 为空白。

这简化了：如果 !address.nil? && !address.empty?

…to: if !address.blank?

# ruby-on-rails - 如何在 Rails 中更改“3 个错误禁止保存此 foobar”验证消息？

> ID：125512
> 
> 赞同：8
> 
> 时间：2008-09-24T05:08:08.673
> 
> 标签：ruby-on-rails, ruby, validation

在我的 Rails 应用程序中，我在活动记录对象中使用验证助手，它们很棒。当出现问题时，我会在我的网页上看到标准的“3 个错误禁止保存此 foobar”以及个别问题。

有什么办法可以用我自己的方法覆盖这个默认消息吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-24T14:45:13.297

`error_messages_for`您用来显示错误的帮助程序接受一个`:header_message`允许您更改默认标题文本的选项。如：

> `error_messages_for 'model', :header_message => "You have some errors that prevented saving this model"`

RubyOnRails [API](http://api.rubyonrails.org/classes/ActionView/Helpers/ActiveRecordHelper.html#M001673)是您的朋友。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T05:29:54.113

模型中的 "validates_" 方法通常都可以传递一个**:message => "My Validation Message"**参数。

我通常将错误包装成这样：

```
<% if(!@model.errors.empty?) %>
<div id="error_message">        
  <h2>
    <%= image_tag("error.png", :align => "top", :alt => "Error") -%>
    Oops, there was a problem editing your information.
  </h2>
  <%= short_error_messages_for(:model) %>
</div>
<% end %> 
```

然后在我的**application_helper**中迭代错误并生成一个简单的列表：

```
 def short_error_messages_for(object_name)
    object = instance_variable_get("@#{object_name}")
    if object && !object.errors.empty?
       content_tag("ul", object.errors.full_messages.collect { |msg| content_tag("li", msg) } )     
    else
        ""
    end
  end 
```

这段代码已经很老了，可能不是我现在写 Ruby 的方式，但你明白了要点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T05:12:03.797

您可以自己迭代 model.errors 哈希，而不是使用错误帮助器。

# c# - 科学计算软件的托管语言

> ID：125516
> 
> 赞同：5
> 
> 时间：2008-09-24T05:09:45.440
> 
> 标签：c#, java, scientific-computing

科学计算是算法密集型的，也可能是数据密集型的。它通常需要使用大量内存来运行分析并在继续下一个之前释放它。有时它还使用内存池为每次分析回收内存。托管语言在这里很有趣，因为它可以让开发人员专注于应用程序逻辑。由于它可能需要处理庞大的数据集，因此性能也很重要。但是我们如何使用托管语言来控制内存和性能呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-09-24T07:18:30.123

[Python](http://www.python.org/)最近在科学计算领域变得相当大。它是一种托管语言，因此您不必记住释放内存。同时，它具有科学和数值计算包（[NumPy](http://numpy.scipy.org/)、[SciPy](http://www.scipy.org/)），可以为您提供类似于编译语言的性能。此外，Python 可以很容易地与 C 代码集成。

Python 是一种表达能力很强的语言，它比许多传统语言更容易编写和阅读。它在某些方面也类似于 MATLAB，比 C++ 或 Fortran 更易于科学家使用。

奥斯陆[大学](http://www.uio.no/)最近开始向信息学系以外的所有理科学生（仍在学习 Java）教授 Python 作为默认语言。

专注于科学计算、偏微分方程等的[Simula 研究实验室广泛使用 python。](http://simula.no/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-24T05:17:17.187

你在问一个根本有缺陷的问题。托管语言的全部意义在于您不处理内存。这是由垃圾收集器处理的，虽然您可以采取某些措施来更好地让它以有效的方式完成其工作，但完成它的工作不是您的工作。

在一个性能不受您控制的世界中，您可以做些什么来提高性能，这很简单。确保你不要持有你不需要的参考资料。如果您需要对情况进行更多控制，请使用基于堆栈的变量。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-24T05:19:06.667

F# 似乎有点针对这些受众。实际上有一本书叫[F# 给科学家](http://www.ffconsultancy.com/products/fsharp_for_scientists/?fsb)。

在 Lambda the Ultimate 上也有人问过这个[问题。](http://lambda-the-ultimate.org/node/2720)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-09-24T05:25:34.780

您可能会对为此使用 Matlab 的人数感到惊讶，因为它可以被视为一种编程语言，并且当然可以管理自己的内存（支持巨大的数据集等），因此在这里应该认真考虑将其作为一种解决方案.

此外，它会生成程序代码（可能需要一个单独的插件？），所以一旦你找到一个你想要打包的算法，你就可以让它生成 C 代码来执行你最初​​在 M 脚本或 simulink 模型中所做的工作。

-亚当

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-24T05:15:27.907

不完全确定问题是什么，但您可能想查看[Fortress](http://projectfortress.sun.com/Projects/Community)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-24T05:39:58.847

我想我会通过说.NET 内存管理器能够处理科学计算的内存管理工作来解释这个问题，而传统的手动调整例程已被用于提高内存性能，特别是对于非常大（GByte）的矩阵？

这篇文章的作者当然相信它是： [Harness the Features of C# to Power Your Scientific Computing Projects](http://msdn.microsoft.com/en-us/magazine/cc163995.aspx)

正如其他人所指出的，托管代码的一个重点是您不需要自己处理内存管理任务。这是一个主要优势，因为它可以让您专注于算法。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T14:25:14.000

最好的选择是带有 NumPy/SciPy/IPython 的 Python。它具有出色的性能，因为核心数学发生在用高度优化的 C 和 Fortran 编写的库中。由于您使用 Python 与它进行交互，因此从您的角度来看，一切都是干净的，并且通过极其简洁、可读的代码和垃圾收集进行管理。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-24T14:17:49.383

由 Oberon microsystems 开发的 BlackBox Component Builder 是编程语言“Component Pascal”的基于组件的开发环境。

由于其稳定性、性能和简单性，BlackBox 非常适合科学和工程应用。

[http://www.oberon.ch/blackbox.html](http://www.oberon.ch/blackbox.html)

（披露：我为 Oberon 微系统工作）

问候，坦伯格

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-24T05:22:14.490

我认为函数式语言最适合这种类型的任务。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-07-31T15:42:46.810

简短的回答是，您可以通过选择合适的语言（如[OCaml](http://www.ffconsultancy.com/products/ocaml_journal/free/introduction.html?so)或[F#](http://www.ffconsultancy.com/products/fsharp_journal/free/introduction.html?so)）并学习如何优化该语言来控制以托管语言编写的程序的内存和性能。长答案需要一本关于您正在使用的特定语言的书，例如[OCaml for Scientists](http://www.ffconsultancy.com/products/ocaml_for_scientists/?so)或[Visual F# 2010 for Technical Computing](http://www.ffconsultancy.com/products/fsharp_for_technical_computing/?so)。

您需要学习的主题是算法优化、低级优化、数据结构和所选语言中类型的内部表示。如果您正在编写并行算法，那么了解缓存也特别重要。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-09-24T05:23:58.340

使用托管语言，您不会那么容易获得这种控制。这些语言的重点是处理 malloc、垃圾等。每种托管语言都会以不同的方式处理它。

Perl 内存不足被认为是致命错误。您可以使用 $^M 通过一些小措施来节省一天的时间，但这仅在您的编译器已使用该功能编译并为其添加代码规定的情况下。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-09-24T05:49:32.397

由于它的开销，.NET 应用程序将导致相对于非托管应用程序的性能损失。然而，因为这个开销或多或少是一个与应用程序的整体大小无关的常数（*警告：过度简化*），所以应用程序越大，它的惩罚就越小。

所以我会选择.NET（只要它为您提供所需的库）。管理记忆是一件痛苦的事，你必须做很多事情才能擅长它。在 .NET 中，选择您最熟悉的任何语言，只要它不是 J# 或 VB.NET 而是 C#。

# ruby-on-rails - 按子属性对 Activerecord 查询进行分组

> ID：125523
> 
> 赞同：2
> 
> 时间：2008-09-24T05:12:04.390
> 
> 标签：ruby-on-rails, activerecord, grouping

是否可以使用孩子的属性对查询进行分组？

```
Post.find(:all, :include => [ :authors, :comments ], :group=>'authors.city') 
```

不起作用。

但是，我可以将其`author.city`用作条件的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-26T03:56:06.287

解决方案是强制进行必要的连接，以便 ActiveRecord 可以解析“authors.city”：

```
Post.find(:all, :include => [ :author, :comments ], :joins=>"INNER JOIN authors ON posts.author_id=authors.id", :group=>'authors.city') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T05:19:37.680

如果这就是您正在使用的，那么 :group 参数的语法是错误的，它应该是：

```
Post.find(:all, :include => [ :author, :comments ], :group=>'authors.city') 
```

确保您的 :author 和 :comments 关联是正确的。如果 'authors' 是实际的表名，那么在 Post 模型和 Author 模型中需要一个 'has_one :author' 关联。

关联也需要正确：

```
 class Post < AR:Base
   belongs_to :author
   has_many :comments
 end

 class Author < AR:Base
   has_many :posts
 end

 class Comment < AR:Base
   belongs_to :post
 end 
```

和数据库模式：

```
 posts
   id
   author_id
 authors
   id
 comments
   id
   post_id 
```

这将使查询正确运行，但是，现在*我*的结果出现错误......使用 :include 时似乎没有应用 :group 子句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T05:24:49.103

查看日志文件中生成的查询 - 您通常可以将查询粘贴到您最喜欢的 MySQL 工具中以获得更详细的错误。

您实际上可能需要提供一个聚合函数来使数据库正确分组（这发生在 MySQL 中，而不是有时语法错误）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T11:50:38.863

作者是否应该包括复数形式？

```
Post.find(:all, :include => [ :authors, :comments ], :group=>'authors.city') 
```

# assembly - 为什么我不能更改段寄存器的值？(MASM)

> ID：125532
> 
> 赞同：8
> 
> 时间：2008-09-24T05:18:53.860
> 
> 标签：assembly, x86, masm

我决定自学汇编语言。

我意识到如果我尝试更改任何段寄存器的值，我的程序将无法编译。

我发现的每一篇文章都说我确实可以改变至少 4 个段寄存器的值，那么给出了什么？

我真的只对为什么在这一点上感兴趣，我没有任何真正的目的来更改这些地址。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-20T08:48:20.893

你说你对为什么感兴趣，所以：

在实模式下，段是物理内存的 64K“窗口”，这些窗口相隔 16 个字节。在保护模式下，段是物理或虚拟内存的窗口，其大小和位置由操作系统确定，并且它具有许多其他属性，包括进程必须具有什么特权级别才能访问它。

从这里开始，我所说的一切都是指保护模式。

内存中有一个称为全局描述符表 (GDT) 的表，其中保存了有关这些窗口大小和位置以及其他属性的信息。每个进程也可能有本地描述符表，它们的工作方式类似，所以我只关注 GDT。

加载到段寄存器中的值称为*段选择器*。它是 GDT 或 LDT 的索引，带有一些额外的安全信息。自然，如果程序试图加载超出 GDT 边界的描述符，就会发生异常。此外，如果进程没有足够的权限来访问该段，或者其他内容无效，则会发生异常。

当异常发生时，内核会处理它。这种异常可能会被归类为分段错误。所以操作系统会杀死你的程序。

最后一个警告：在 x86 指令集中，您不能将立即值加载到段寄存器中。您必须使用中间寄存器或内存操作数或 POP 进入段寄存器。

```
MOV DS, 160 ;INVALID - 无法组装

MOV AX, 160 ;VALID - 汇编，但可能会导致
MOV DS, AX ;异常，从而导致你的程序死亡

```

我认为应该指出的是，该架构允许大量的段。但是 AFAIK，当涉及到主流 x86 操作系统时，段寄存器仅用于几个目的：

*   安全机制，例如防止用户空间进程相互损害或损害操作系统
*   处理多核/多核处理器
*   线程本地存储：作为优化，一些操作系统（包括 Linux 和 Windows）使用段寄存器进行线程本地存储（TLS）。由于线程共享相同的地址空间，因此线程很难在不使用系统调用或浪费寄存器的情况下“知道”其 TLS 区域的位置……但由于段寄存器实际上是无用的，因此“浪费”没有害处他们是为了快速 TLS。请注意，在进行设置时，操作系统可能会跳过段寄存器并直接写入描述符缓存寄存器，这些寄存器是“隐藏”寄存器，用于缓存由对段寄存器的引用触发的 GDT/LDT 查找，在这种情况下，如果您尝试从段寄存器中读取你不会看到它。

除了 TLS 的每个线程一个段之外，实际上只有少数段（处理器数量的倍数）被使用，并且仅由操作系统使用。应用程序可以*完全*忽略段寄存器。

这是由于操作系统设计，而不是任何技术限制。可能有嵌入式操作系统需要用户空间程序来处理段寄存器，尽管我不知道。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T05:30:33.427

你在写windows可执行文件吗？

在保护模式 (Win32) 中，不再使用段寄存器。

[参考](http://www.codebreakers-journal.com/content/view/141/104/)：

> 内存模型也与过去的 16 位世界截然不同。在Win32下，我们不再需要关心内存模型或段了！只有一种内存模型：平面内存模型。不再有 64K 段。内存是4 GB的大连续空间。这也意味着您不必使用段寄存器。您可以使用任何段寄存器来寻址内存空间中的任何点。这对程序员来说是一个很大的帮助。这就是使 Win32 汇编编程像 C 一样简单的原因。

# wpf - 具有简单算术运算的 WPF DataBinding？

> ID：125536
> 
> 赞同：16
> 
> 时间：2008-09-24T05:19:29.707
> 
> 标签：wpf, data-binding

我想在传入的绑定整数上添加一个常量值。事实上，我有几个地方想要绑定到相同的源值但添加不同的常量。所以理想的解决方案是这样的......

```
<TextBox Canvas.Top="{Binding ElementName=mySource, Path=myInt, Constant=5}"/>
<TextBox Canvas.Top="{Binding ElementName=mySource, Path=myInt, Constant=8}"/>
<TextBox Canvas.Top="{Binding ElementName=mySource, Path=myInt, Constant=24}"/> 
```

（注意：这是一个展示这个想法的例子，我的实际绑定场景不是TextBox的canvas属性。但这更清楚地展示了这个想法）

目前，我能想到的唯一解决方案是公开许多不同的源属性，每个属性都将不同的常量添加到相同的内部值。所以我可以做这样的事情......

```
<TextBox Canvas.Top="{Binding ElementName=mySource, Path=myIntPlus5}"/>
<TextBox Canvas.Top="{Binding ElementName=mySource, Path=myIntPlus8}"/>
<TextBox Canvas.Top="{Binding ElementName=mySource, Path=myIntPlus24}"/> 
```

但这非常严峻，因为将来我可能需要继续为新常量添加新属性。此外，如果我需要更改添加的值，我需要更改源对象，这很糟糕。

一定有比这更通用的方法吗？任何 WPF 专家有任何想法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2011-08-20T17:34:04.130

我使用`MathConverter`我创建的 a 来进行所有简单的算术运算。转换器的代码在[这里](http://rachel53461.wordpress.com/2011/08/20/the-math-converter/)，它可以像这样使用：

```
<TextBox Canvas.Top="{Binding SomeValue, 
             Converter={StaticResource MathConverter},
             ConverterParameter=@VALUE+5}" /> 
```

您甚至可以将它与更高级的算术运算一起使用，例如

```
Width="{Binding ElementName=RootWindow, Path=ActualWidth,
                Converter={StaticResource MathConverter},
                ConverterParameter=((@VALUE-200)*.3)}" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-09-24T05:36:50.883

我相信您可以使用价值转换器来做到这一点。这是一篇[博客文章](http://weblogs.asp.net/marianor/archive/2007/09/18/using-ivalueconverter-to-format-binding-values-in-wpf.aspx)，介绍了将参数传递给 xaml 中的值转换器的问题。[这个博客](http://blogs.msdn.com/bencon/archive/2006/05/10/594886.aspx)给出了一些实现值转换器的细节 。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-09-24T10:56:31.740

使用值转换器是解决该问题的好方法，因为它允许您在绑定到 UI 时修改源值。

我在几个地方使用了以下内容。

```
public class AddValueConverter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
    {
        object result = value;
        int parameterValue;

        if (value != null && targetType == typeof(Int32) && 
            int.TryParse((string)parameter, 
            NumberStyles.Integer, culture, out parameterValue))
        {
            result = (int)value + (int)parameterValue;
        }

        return result;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        throw new NotImplementedException();
    }
} 
```

例子

```
 <Setter Property="Grid.ColumnSpan"
         Value="{Binding 
                   Path=ColumnDefinitions.Count,
                   RelativeSource={RelativeSource AncestorType=Grid},
                   Converter={StaticResource addValueConverter},
                   ConverterParameter=1}"
  /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T05:40:34.057

我从未使用过 WPF，但我有一个可能的解决方案。

您的绑定路径可以映射到地图吗？如果是这样，那么它应该能够接受一个参数（密钥）。您需要创建一个实现 Map 接口的类，但实际上只返回您初始化“Map”并添加到键的基值。

```
public Integer get( Integer key ) { return baseInt + key; }  // or some such 
```

如果没有从标签传递数字的能力，我看不出你将如何让它从原始值返回不同的增量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-24T01:27:04.700

我会使用多重绑定转换器，例如以下示例：

C#代码：

```
namespace Example.Converters
{
        public class ArithmeticConverter : IMultiValueConverter
        {            
            public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)
            {
                double result = 0;

                for (int i = 0; i < values.Length; i++)
                {
                    if (!double.TryParse(values[i]?.ToString(), out var parsedNumber)) continue;

                    if (TryGetOperations(parameter, i, out var operation))
                    {
                        result = operation(result, parsedNumber);
                    }
                }

                return result;
            }

            public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)
            {
                return new[] { Binding.DoNothing, false };
            }

            private static bool TryGetOperations(object parameter, int operationIndex, out Func<double, double, double> operation)
            {
                operation = null;
                var operations = parameter?.ToString().Split(',');

                if (operations == null || operations.Length == 0) return false;

                if (operations.Length <= operationIndex)
                {
                    operationIndex = operations.Length - 1;
                }

                return Operations.TryGetValue(operations[operationIndex]?.ToString(), out operation);
            }

            public const string Add = "+";
            public const string Subtract = "-";
            public const string Multiply = "*";
            public const string Divide = "/";

            private static IDictionary<string, Func<double, double, double>> Operations = new Dictionary<string, Func<double, double, double>>
            {
                { Add, (x, y) => x + y },
                { Subtract, (x, y) => x - y },
                { Multiply, (x, y) => x * y },
                { Divide, (x, y) => x / y }
            };
        }
} 
```

XAML 代码：

```
<UserControl 
     xmlns:converters="clr-namespace:Example.Converters">
    <UserControl.Resources>
                    <converters:ArithmeticConverter x:Key="ArithmeticConverter" />
    </UserControl.Resources> 
```

...

```
<MultiBinding Converter="{StaticResource ArithmeticConverter}" ConverterParameter="+,-">
            <Binding Path="NumberToAdd" />
            <Binding Path="NumberToSubtract" />
</MultiBinding> 
```

# .net - 部署多个报告服务实例或连接到多个版本的 DLL

> ID：125540
> 
> 赞同：1
> 
> 时间：2008-09-24T05:21:03.683
> 
> 标签：.net, sql-server, ssrs-2008

SSRS2008 中是否有任何方法可以部署多个运行单独代码集的 ReportServer 实例？

我正在开发一个非常具体的报告服务部署，其中插入了许多自定义扩展。但是，我的公司通常会在同一台服务器上同时部署多个版本的发布。我有点不知道用报告服务做到这一点的好方法。

我知道我有几个选择：

*   使用不同的代码集运行多个 Reporting Services 实例

这样做的缺点是升级有点让人头疼，我宁愿没有报告数据库的多个实例。如果他们针对相同的数据库，我不确定他们是否会一起玩得很好。

*   通过读取 HTTPRequest 变量，按需调用/包含特定于版本的 DLL。(Assembly.LoadFile)

我有一种感觉，这可能会出现性能问题，而且听起来也像是潜在的调试噩梦。我以前也没有使用过 Assembly.LoadFile，我不确定我必须编写多少没有版本控制的代码来控制版本控制系统。

有没有人有这方面的经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-12-09T19:25:09.197

您可以将多个 RS 前端安装到一个数据库后端。

它运作良好。我们用它来拥有 2 个主 RS 盒（负载平衡）和第 3 个 BCP/DR 热备用盒。他们都在农场里。

您也可以在同一个盒子上有多个实例。

[如何：配置报表服务器横向扩展部署（Reporting Services 配置）](http://msdn.microsoft.com/en-us/library/ms159114(SQL.90).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-26T14:03:43.993

FWIW 我一直在针对相同的数据库运行两个单独的报表服务器安装，没有问题。数量相当低。

# reporting-services - 如何在多页 SSRS 2005 报告的标题中显示数据？

> ID：125541
> 
> 赞同：3
> 
> 时间：2008-09-24T05:22:04.727
> 
> 标签：reporting-services, header, report

[这个问题](https://stackoverflow.com/questions/63938/how-do-i-show-data-in-the-header-of-a-sql-2005-reporting-services-report)很有帮助，但是我的报告中有一个列表控件，当报告超过 1 页时，页眉中的数据只显示在报告的最后一页。

显然，隐藏的文本框必须在报告的每一页上，标题才能正常工作。我怎么做？我在列表中拥有的唯一控件是一个文本框，其中包含超过 1 页的文本。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2011-05-30T14:02:27.257

虽然 SSRS 不允许我们在页眉中使用 DataSet 字段，但它允许我们引用报表项。因此，我们可以在报表正文的任何​​位置放置一个文本框（从 DataSet 字段中获取其值）并将其`Hidden`属性设置为 true。

然后，我们可以很容易地使用如下表达式引用页眉中的那个文本框：`=ReportItems!TextBox1.Value`我们就完成了。请注意，被引用的文本框应该出现在每一页上，否则标题将打印一个空值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T06:03:04.160

sExchange 网站来救援！！！

我需要做的就是将报表参数与我的数据集中的查询值一起使用；然后在报告标题的文本框中引用 =Parameters!Name.Value。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-14T07:02:03.173

选择报表参数，添加新参数并选中隐藏，允许空值和允许空值。

如果您要从数据库中检索值：

## 在可用值下：

选中“来自查询”单选按钮并提供数据集、值字段和标签字段。

## 在默认值下：

选中“来自查询”单选按钮并提供数据集、值字段。

现在为页脚/页眉中的文本框提供值`=Parameters!Footer.Value`（`Footer`是参数名称）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-29T11:37:17.610

隐藏的文本框可以放置在一个矩形内，该矩形是一个 repeatwith 属性设置为您的列表项。

# algorithm - 对于井字游戏，我可以使用什么算法来确定 AI 的“最佳移动”？

> ID：125557
> 
> 赞同：63
> 
> 时间：2008-09-24T05:26:27.960
> 
> 标签：algorithm, artificial-intelligence, tic-tac-toe

在井字游戏的实现中，我想具有挑战性的部分是确定机器要玩的最佳动作。

可以追求的算法有哪些？我正在研究从简单到复杂的实现。我将如何解决这部分问题？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2008-09-24T05:43:13.753

来自维基百科的完美游戏策略（每次获胜或平局）似乎是简单的伪代码：

> **引用自[维基百科（井字游戏#Strategy）](http://en.wikipedia.org/wiki/Tic-tac-toe)**
> 
> 玩家可以玩完美的井字游戏（赢或至少平局），如果他们从以下列表中选择第一个可用的移动，每轮，如纽厄尔和西蒙的 1972 井字游戏中使用的那样[6]
> 
> 1.  赢：如果您连续获得两个，则玩第三个以获得连续三个。
>     
>     
> 2.  阻挡：如果对手连续有两个，则使用第三个来阻挡他们。
>     
>     
> 3.  叉子：创造一个可以通过两种方式获胜的机会。
>     
>     
> 4.  阻止对手的叉子：
>     
>     
>     
>     选项 1：连续制造两个以迫使对手防守，只要这不会导致他们制造分叉或获胜。例如，如果“X”有角球，“O”有中锋，而“X”也有对角角，则“O”必须不打角球才能获胜。（在这种情况下打角球会为“X”赢得一个分叉。）
>     
>     
>     
>     选项 2：如果存在对手可以分叉的配置，则阻止该分叉。
>     
>     
> 5.  中锋：打中锋。
>     
>     
> 6.  对角：如果对手在角，打对角。
>     
>     
> 7.  空角：打一个空角。
>     
>     
> 8.  空方：播放空方。

可以按照建议以蛮力方式识别“分叉”情况的样子。

**注意：一个“完美”的对手是一个很好的练习，但最终不值得“玩”。但是，您可以更改上述优先级，以将特征弱点赋予对手个性。**

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2008-09-24T07:40:27.153

您需要的（对于井字游戏或像国际象棋这样更困难的游戏）是[极小极大算法](http://en.wikipedia.org/wiki/Minimax)，或者它稍微复杂一点的变体，[alpha-beta pruning](http://en.wikipedia.org/wiki/Alpha-beta_pruning)。不过，对于像井字游戏这样的搜索空间很小的游戏，普通的幼稚极小极大也可以。

简而言之，您要做的不是寻找可能对您产生最佳结果的举动，而是寻找最坏结果尽可能好的举动。如果你假设你的对手打得最好，你必须假设他们会采取对你最不利的行动，因此你必须采取使他们的最大收益最小化的行动。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2008-09-24T05:31:26.980

生成每一个可能的棋盘并根据随后在树的下方产生的棋盘对其进行评分的蛮力方法不需要太多内存，尤其是当您认识到 90 度棋盘旋转是多余的，垂直翻转也是如此，水平轴和对角轴。

一旦达到这一点，树形图中就会有不到 1k 的数据来描述结果，因此是计算机的最佳选择。

-亚当

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-07-13T18:16:58.987

tic-tac-toe 的典型算法应如下所示：

Board ：代表棋盘的九元素向量。我们存储 2（表示空白）、3（表示 X）或 5（表示 O）。Turn：一个整数，表示将要进行游戏的哪一步。第一步将由 1 表示，最后由 9 表示。

算法

主要算法使用三个函数。

Make2：如果棋盘的中心正方形是空白的，即如果 ，则返回 5 `board[5]=2`。否则，此函数返回任何非角正方形`(2, 4, 6 or 8)`。

`Posswin(p)`：如果玩家`p`下一步无法获胜，则返回 0；否则，它返回构成获胜棋步的方格数。此功能将使程序既能获胜又能阻止对手获胜。该功能通过检查每一个行、列和对角线来运行。通过将整个行（或列或对角线）的每个正方形的值相乘，可以检查获胜的可能性。如果产品是`18`（`3 x 3 x 2`），则`X`可以获胜。如果产品是`50`( `5 x 5 x 2`)，那么 O 可以获胜。如果找到获胜行（列或对角线），则可以确定其中的空白方格，并通过此函数返回该方格的数量。

`Go (n)`: 在方格 n 中移动。如果 Turn 为奇数，此过程将 board 设置`[n]`为 3，如果 Turn 为偶数，则将 board 设置为 5。它也增加一圈。

该算法对每一步都有一个内置的策略。如果它下 ，它会走奇数步`X`，如果它下 O，它会走偶数步。

```
Turn = 1    Go(1)   (upper left corner).
Turn = 2    If Board[5] is blank, Go(5), else Go(1).
Turn = 3    If Board[9] is blank, Go(9), else Go(3).
Turn = 4    If Posswin(X) is not 0, then Go(Posswin(X)) i.e. [ block opponent’s win], else Go(Make2).
Turn = 5    if Posswin(X) is not 0 then Go(Posswin(X)) [i.e. win], else if Posswin(O) is not 0, then Go(Posswin(O)) [i.e. block win], else if Board[7] is blank, then Go(7), else Go(3). [to explore other possibility if there be any ].
Turn = 6    If Posswin(O) is not 0 then Go(Posswin(O)), else if Posswin(X) is not 0, then Go(Posswin(X)), else Go(Make2).
Turn = 7    If Posswin(X) is not 0 then Go(Posswin(X)), else if Posswin(X) is not 0, then Go(Posswin(O)) else go anywhere that is blank.
Turn = 8    if Posswin(O) is not 0 then Go(Posswin(O)), else if Posswin(X) is not 0, then Go(Posswin(X)), else go anywhere that is blank.
Turn = 9    Same as Turn=7. 
```

我已经用过了。让我知道你们的感受。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2008-09-24T05:33:20.830

由于您只处理可能位置的 3x3 矩阵，因此只需编写搜索所有可能性而不会对您的计算能力征税是非常容易的。对于每个开放空间，在标记该空间之后计算所有可能的结果（我会说是递归的），然后使用具有最大获胜可能性的移动。

优化这将是浪费精力，真的。虽然一些简单的可能是：

*   首先检查另一支球队可能获胜的情况，阻止你找到的第一个（如果仍然有 2 场比赛结束）。
*   如果中心是开放的（并且之前的规则没有候选人），请始终选择中心。
*   在边前拐角（再次，如果之前的规则是空的）

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-06-19T14:41:52.553

不使用运动场的尝试。

1.  赢（你的双倍）
2.  如果没有，不要输（对手的双打）
3.  如果没有，你是否已经有一个叉子（有一个双倍）
4.  如果没有，如果对手有叉子

    1.  在阻塞点中搜索可能的双分叉（最终获胜）
    2.  如果不是在阻塞点搜索叉子（这给对手最大的失败可能性）
    3.  如果不只是阻塞点（不输）
5.  如果不搜索 double 和 fork（最终获胜）
6.  如果不是只寻找给对手最失败的可能性的叉子
7.  如果不是只搜索一个双
8.  如果不是死胡同，平手，随机。
9.  如果不是（这意味着你的第一步）

    1.  如果这是游戏的第一步；

        1.  给对手最多输的可能性（算法只产生角球，给对手7分的可能性）
        2.  或者只是随机地打破无聊。
    2.  如果这是游戏的第二步；

        1.  只找到不失分的（提供更多选择）
        2.  或在此列表中找到最有可能获胜的点（这可能很无聊，因为它只会导致所有角落或相邻的角落或中心）

注意：当你有加倍和分叉时，检查你的加倍是否给了对手一个加倍。如果给了，检查你的新强制点是否包含在你的分叉列表中。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-24T05:37:42.020

您可以让 AI 在一些示例游戏中发挥自己的作用以供学习。使用监督学习算法来帮助它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-24T05:28:33.073

用数字分数对每个方格进行排名。如果选择了一个正方形，则继续下一个选择（按等级降序排列）。您将需要选择一种策略（首先有两个主要策略，其次是三个（我认为））。从技术上讲，您可以对所有策略进行编程，然后随机选择一个。这将使对手变得更难预测。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-04-12T17:20:34.050

这个答案假设您了解为 P1 实现完美算法，并讨论如何在与普通人类玩家的情况下取得胜利，普通人类玩家会比其他人更容易犯一些错误。

如果双方球员发挥最佳，比赛当然应该以平局结束。在人类水平上，P1 在角落里打球的几率要高得多。无论出于何种心理原因，P2 都被诱使认为打中锋并不重要，这对他们来说是不幸的，因为这是唯一不会为 P1 创造获胜游戏的反应。

如果 P2*确实*在中路正确阻挡，P1 应该打对面的角，因为无论出于何种心理原因，P2 都会更喜欢打角的对称性，这又会为他们带来一个失败的棋盘。

对于 P1 可能为开始移动而做出的任何移动，如果两个玩家之后都发挥最佳，P2 可能会移动将为 P1 创造胜利。从这个意义上说，P1 可以在任何地方播放。边缘移动是最弱的，因为对该移动的最大可能响应产生平局，但仍有一些响应将为 P1 创造胜利。

经验上（更准确地说，传闻）最好的 P1 起始动作似乎是第一个角，第二个中心和最后一个边缘。

您可以亲自或通过 GUI 添加的下一个挑战是不显示板。一个人肯定可以记住所有状态，但是增加的挑战导致了对对称板的偏好，这需要更少的努力来记住，这导致了我在第一个分支中概述的错误。

我知道，我在聚会上很有趣。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-01-06T14:15:23.347

## 井字游戏适应 min max 算法

```
let gameBoard: [
    [null, null, null],
    [null, null, null],
    [null, null, null]
]

const SYMBOLS = {
    X:'X',
    O:'O'
}

const RESULT = {
    INCOMPLETE: "incomplete",
    PLAYER_X_WON: SYMBOLS.x,
    PLAYER_O_WON: SYMBOLS.o,
    tie: "tie"
} 
```

我们需要一个可以检查结果的函数。该函数将检查连续的字符。无论棋盘的状态如何，结果都是 4 个选项之一：不完整、玩家 X 赢、玩家 O 赢或平局。

```
function checkSuccession (line){
    if (line === SYMBOLS.X.repeat(3)) return SYMBOLS.X
    if (line === SYMBOLS.O.repeat(3)) return SYMBOLS.O
    return false 
}

function getResult(board){

    let result = RESULT.incomplete
    if (moveCount(board)<5){
        return result
    }

    let lines

    //first we check row, then column, then diagonal
    for (var i = 0 ; i<3 ; i++){
        lines.push(board[i].join(''))
    }

    for (var j=0 ; j<3; j++){
        const column = [board[0][j],board[1][j],board[2][j]]
        lines.push(column.join(''))
    }

    const diag1 = [board[0][0],board[1][1],board[2][2]]
    lines.push(diag1.join(''))
    const diag2 = [board[0][2],board[1][1],board[2][0]]
    lines.push(diag2.join(''))

    for (i=0 ; i<lines.length ; i++){
        const succession = checkSuccesion(lines[i])
        if(succession){
            return succession
        }
    }

    //Check for tie
    if (moveCount(board)==9){
        return RESULT.tie
    }

    return result
}
```

我们的 getBestMove 函数将接收棋盘的状态，以及我们想要为其确定最佳可能移动的玩家的符号。我们的函数将使用 getResult 函数检查所有可能的移动。如果是胜利，它会给它1分。如果它是松散的，它会得到-1分，平局将得到0分。如果不确定，我们将使用新状态调用getBestMove函数板和相反的符号。由于下一步是对手，他的胜利是当前玩家的失败，并且得分将被否定。最后，可能的移动获得 1,0 或 -1 的分数，我们可以对移动进行排序，并返回得分最高的移动。

```
const copyBoard = (board) => board.map( 
    row => row.map( square => square  ) 
)

function getAvailableMoves (board) {
  let availableMoves = []
  for (let row = 0 ; row<3 ; row++){
    for (let column = 0 ; column<3 ; column++){
      if (board[row][column]===null){
        availableMoves.push({row, column})
      }
    }
  }
  return availableMoves
}

function applyMove(board,move, symbol) {
  board[move.row][move.column]= symbol
  return board
}

function getBestMove (board, symbol){

    let availableMoves = getAvailableMoves(board)

    let availableMovesAndScores = []

    for (var i=0 ; i<availableMoves.length ; i++){
      let move = availableMoves[i]
      let newBoard = copyBoard(board)
      newBoard = applyMove(newBoard,move, symbol)
      result = getResult(newBoard,symbol).result
      let score
      if (result == RESULT.tie) {score = 0}
      else if (result == symbol) {
        score = 1
      }
      else {
        let otherSymbol = (symbol==SYMBOLS.x)? SYMBOLS.o : SYMBOLS.x
        nextMove = getBestMove(newBoard, otherSymbol)
        score = - (nextMove.score)
      }
      if(score === 1)  // Performance optimization
        return {move, score}
      availableMovesAndScores.push({move, score})
    }

    availableMovesAndScores.sort((moveA, moveB )=>{
        return moveB.score - moveA.score
      })
    return availableMovesAndScores[0]
  }
```

[算法在行动](https://carpben.github.io/TicTacToe/)，[Github](https://github.com/carpben/TicTacToe/blob/ea8a67918f0ab97bca40e4383839e95695da803f/tictactoe.js#L59)，[更详细的解释过程](https://medium.freecodecamp.org/building-an-ai-algorithm-for-the-tic-tac-toe-challenge-29d4d5adee07)

# sql - SQL 作业状态

> ID：125570
> 
> 赞同：2
> 
> 时间：2008-09-24T05:31:55.827
> 
> 标签：sql, sql-server, stored-procedures

我实际上是在 SQL 2005 中研究 SP。使用 SP 我正在创建一个作业并将其安排在特定的时间。由于数据库非常庞大，这些作业至少需要 5 到 10 分钟才能完成。但我不知道如何检查作业的状态。我想知道它是否已成功完成或执行中是否有任何错误。在异常情况下，我还会返回正确的错误代码。但我不知道在哪里可以检查此错误代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T06:48:10.667

这是我能找到的，也许它可以解决你的问题：

1.  SP 获取当前工作活动。

> ```
>  exec msdb.dbo.sp_help_jobactivity  @job_id = (your job_id here) 
> ```

您可以执行此 SP 并将结果放在临时表中并从那里获取所需的结果。

否则看看这些表：

*   msdb.dbo.sysjobactivity

*   msdb.dbo.sysjobhistory

运行以下命令以查看这些表之间的关联。

> 执行 sp_helptext sp_help_jobactivity

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-21T08:31:07.403

--在查询分析器中复制并正确格式化，以便您轻松理解 --使用查询执行任务（作业） exec msdb.dbo.sp_start_job @job_name ='作业名称'，@server_name =服务器名称 --执行后查询是否已完成 声明 @JobId 为 varchar(36) 选择 @JobId = job_id from sysjobs where name = 'Your Job Name' Declare @JobStatus as int set @JobStatus = -1 While @JobStatus <= -1 Begin --根据您的 Job 提供 TimeDelay select @JobStatus = isnull(run_status ,-1) from sysjobactivity JA,sysjobhistory JH where JA.job_history_id = JH.instance_id and JA.job_id = @JobId End select @JobStatus

null = 运行 1 = Fininshed 成功 0 = 错误完成

--一旦你的工作完成，你就会得到结果

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-09-30T13:04:47.443

我从[这里得到了更好的代码](http://www.sqlservercentral.com/scripts/Miscellaneous/30916/)

```
Use msdb
go

select distinct j.Name as "Job Name", j.description as "Job Description", h.run_date as LastStatusDate, 
case h.run_status 
when 0 then 'Failed' 
when 1 then 'Successful' 
when 3 then 'Cancelled' 
--when 4 then 'In Progress' 
end as JobStatus
from sysJobHistory h, sysJobs j
where j.job_id = h.job_id and h.run_date = 
(select max(hi.run_date) from sysJobHistory hi where h.job_id = hi.job_id)
order by 1 
```

# .net - .NET ODBC 连接池

> ID：125577
> 
> 赞同：3
> 
> 时间：2008-09-24T05:33:51.797
> 
> 标签：.net, odbc, connection-pooling

我打开一个这样的连接：

```
Using conn as New OdbcConnection(connectionString)
    conn.Open()
    //do stuff
End Using 
```

如果启用了连接池，则连接不会在物理上关闭，而是释放到池中并且将被重用。如果它被禁用，它将被物理关闭。

有没有办法以**编程方式知道** *是否*启用了连接池？以及当前在池中打开的已使用和未使用的连接数？

**编辑：**我需要从程序中获取此信息，我无法在将部署该程序的每台 PC 上手动检查它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T05:36:14.193

MSDN 作为[对此的深入指导](http://msdn.microsoft.com/en-us/library/ms810829.aspx)

> **从数据源管理员配置连接池**
> 
> [剪辑]
> 
> 或者，您可以在运行提示符处启动 ODBC 数据源管理器。在任务栏上，**单击开始，单击运行，然后键入 Odbcad32。**
> 
> 用于管理连接池的选项卡位于 ODBC 3.5 及更高版本的 ODBC 数据源管理器对话框中。从注册表配置连接池
> 
> 对于 ODBC 核心组件 3.5 版本之前的版本，您需要直接修改注册表来控制连接池的 CPTimeout 值。

池始终由数据服务器软件处理。重点在于，在 .NET 中您不必担心它（例如，这就是为什么在使用 SQL Server 时应该始终使用 SqlConnection 的原因——部分原因是它启用了连接池）。

## 更新

在 Vista 上，只需在开始菜单中键入“ODBC”，它就会为您找到该应用程序。

## OP澄清后更新

关于确定是否在每台机器上启用了连接池，请查看[MSDN 指南](http://msdn.microsoft.com/en-us/library/ms810829.aspx)，我会说最好检查注册表值（有关注册表访问的指针，请参阅[本文](http://www.csharphelp.com/archives2/archive430.html)）。

TBH 不过，除非客户端机器真的很糟糕，否则我什至可能不会打扰.. AFAIK 默认情况下启用它，并且在客户端机器上打开连接（根据我的经验）从来都不是什么大问题。*只有在开仓*时，它才会真正成为一件大事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T06:16:25.873

看起来您可以只读取此注册表项：

[HKEYLOCALMACHINE]\SOFTWARE\ODBC\ODBCINST.INI\SQL Server\CPTimeout

（或其中的一些变体，取决于您的操作系统和用户帐户）。如果值为 0，则禁用连接池。如果它是任何高于 0 的值，则启用它。

看：

[http://msdn.microsoft.com/en-us/library/ms810829.aspx](http://msdn.microsoft.com/en-us/library/ms810829.aspx)

我不确定是否要获得打开的连接数。只是好奇：为什么你需要知道这个数字？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-08T07:07:56.093

要确定每个数据库上打开的连接数，试试这个 sql - 我从互联网上的文档中得到它

```
select  db_name(dbid) , count(*) 'connections count'
  from master..sysprocesses
 where spid > 50 and spid  @@spid
 group by  db_name(dbid)
 order by count(*) desc 
```

Spids <=50 由 sqlserver 使用。所以上面的 sql 会告诉你程序使用的连接。

# c++ - 使用 C++ Boost 库有哪些优势？

> ID：125580
> 
> 赞同：133
> 
> 时间：2008-09-24T05:35:23.680
> 
> 标签：c++, boost

所以，我一直在通读，似乎 Boost 库在实践中得到了很多使用（虽然不是在我的商店）。为什么是这样？是什么让它如此美妙？

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2008-09-24T05:48:59.980

[Boost](http://www.boost.org/)被广泛使用是因为：

*   它是开源的并经过同行评审。
*   它提供了STL 错过的[广泛](http://www.boost.org/doc/libs)的平台无关功能。
*   它是对 STL 的补充而不是替代。
*   许多 Boost 开发人员都是 C++ 标准委员会的成员。事实上，Boost 的很多部分都被认为包含在下一个 C++ 标准库中。
*   它记录得很好。
*   它的[许可证](http://en.wikipedia.org/wiki/Boost_Software_License)允许包含在开源和闭源项目中。
*   它的功能*通常*不相互依赖，因此您可以只链接您需要的部分。[[卢克·赫米特](https://stackoverflow.com/users/15934/luc-hermitte)的评论]

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2008-09-24T07:54:57.417

从主页：

> “......世界上最受推崇和专业设计的 C++ 库项目之一。” — Herb Sutter 和 Andrei Alexandrescu，C++ 编码标准
> 
> “第55条：熟悉Boost。” — Scott Meyers，Effective C++，第 3 版。
> 
> “对于大多数程序员来说，显而易见的解决方案是使用一个库，该库提供一个优雅而高效的平台，独立于所需的服务。例如 BOOST……” — Bjarne Stroustrup，C++ 中的抽象、库和效率

所以，它是一系列广泛使用和接受的库，但你为什么需要它呢？

如果你需要：

*   正则表达式
*   函数绑定
*   拉姆达函数
*   单元测试
*   智能指针
*   不可复制，可选
*   序列化
*   通用日期
*   可移植文件系统
*   循环缓冲区
*   配置工具
*   通用图像库
*   TR1
*   线程
*   uBLAS

当您使用 C++ 编写代码时，请查看[Boost](http://www.boost.org/)以及[更多](http://www.boost.org/doc/libs/1_36_0)内容。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2008-09-24T05:43:08.403

因为他们在标准库中添加了许多缺失的东西，所以其中一些被包含在标准中。

[Boost人](http://www.boost.org/users/index.html)没有说谎：

> 为什么组织应该使用 Boost？
> 
> 一句话，生产力。使用像 Boost 这样的高质量库可以加速初始开发，减少错误，减少轮子的重新发明，并降低长期维护成本。而且由于 Boost 库倾向于成为事实上或法律上的标准，许多程序员已经熟悉它们。
> 
> C++ 标准库的 TR1 中包含 10 个 Boost 库，因此计划在以后进行完全标准化。更多 Boost 库正在为 TR2 准备中。使用 Boost 库可以让组织在采用新技术方面处于领先地位。
> 
> 许多组织已经使用通过 Boost 实现的程序，例如 Adob​​e Acrobat Reader 7.0。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2008-09-24T06:59:36.253

一些 Boost 类非常有用（shared_ptr），但我认为它们对 Boost 中的特征和概念有点疯狂。编译时间和巨大的二进制大小对于 Boost 来说是完全疯狂的，就像任何模板繁重的代码一样。必须有一个平衡。我不确定Boost是否找到了它。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2011-01-21T05:02:48.640

BOOST 的库集合满足了许多 C++ 项目的共同需求。一般来说，他们确实优先考虑正确性、可重用性、可移植性、运行时性能和空间效率，而不是 BOOST 实现代码的可读性，或者有时是编译时间。它们往往不涵盖完整的高级功能需求（例如应用程序框架），而是（谢天谢地）提供可以更自由组合的构建块，而无需指定或支配应用程序设计。

考虑使用 BOOST 的重要原因包括：

*   大多数库都经过了很好的测试和设计：与在同一问题空间中具有自制解决方案的人相比，它们通常得到一些优秀程序员的合理评价，并且广泛用于收集广泛的实际反馈
*   它已经写好了，你的解决方案可能不是
*   它非常便携（但每个库都不同）
*   C++ 社区中的更多人将在帮助您编写代码方面处于领先地位
*   BOOST 通常是引入 C++ 标准的试验场，因此您在重写代码以与未来标准兼容时无需 BOOST 即可完成更少的工作
*   由于社区需求，编译器供应商更有可能使用 BOOST 测试和应对正确性问题
*   熟悉 boost 库将帮助您在其他项目中做类似的工作，可能在其他公司，您现在可能编写的任何代码都可能无法重用

这些库在这里用一两行描述：http: [//www.boost.org/doc/libs/](http://www.boost.org/doc/libs/)。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2008-09-24T06:39:16.863

它添加了允许更现代的 C++ 编程方法的库。

根据我的经验，许多 C++ 程序员实际上是 1990 年代早期的 C++ 程序员，他们几乎都在编写 C++ 类，而不是大量使用泛型。更现代的方法使用泛型以更像动态语言的方式组合软件，但最终您仍然可以获得类型检查/性能。看起来有点难看。但是一旦你克服了语法问题，它真的很不错。Boost 为您提供了许多轻松编写内容所需的工具。智能指针、函数、lambdas、绑定等。然后是 boost 库，它们利用这种新的 C++ 编写方式来提供诸如网络、正则表达式等之类的东西......

如果您正在编写大量 for 循环、手动滚动函数对象或进行内存管理，那么您绝对应该检查 boost。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-09-24T05:38:38.150

因为 C++ 标准库并不是那么*完整*。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2008-09-24T07:46:15.423

应注意任何与[Kevlin Henney相关的事情。](http://www.two-sdg.demon.co.uk/curbralan/kevlin.html)

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-09-24T06:17:43.517

Boost 基本上是标准将成为什么的概要，除了 Boost 获得的所有同行评审和使用，您可以非常确定您的依赖项获得了相当大的收益。

但是大多数商店不使用 Boost，因为它是外部依赖项。实际上，减少外部依赖也非常重要。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-09-24T06:56:22.907

Boost 之于 C++ 有点像 .NET Framework 之于 C#，但规模可能更小。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-09-24T05:37:10.367

我使用文件系统库退出了一点，boost::shared_ptr 非常漂亮。我听说它也做其他事情。

# c++ - 增强 C++ 开源项目的依赖性？

> ID：125597
> 
> 赞同：30
> 
> 时间：2008-09-24T05:44:09.913
> 
> 标签：c++, boost, standard-library

Boost 旨在成为每个 C++ 用户都可以使用**的**标准非标准 C++ 库。假设它可用于开源 C++ 项目是否合理，或者它是一个太大的依赖关系？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2008-09-24T07:22:18.570

基本上，您的问题归结为“将 [free library xyz] 作为 C++ 开源项目的依赖项是否合理。”</p>

现在考虑一下 Stroustrup 的以下引用，答案真的很简单：

> 如果没有一个好的库，大多数有趣的任务都很难在 C++ 中完成；但是如果有一个好的库，几乎任何任务都可以轻松完成

假设这是正确的（根据我的经验，它是正确的），那么编写一个*没有*依赖关系的大小合理的 C++ 项目是完全不合理的。

进一步发展这一论点，在（开发人员的）客户端系统上可以合理预期的*一个*C++ 依赖项（除了系统库）是 Boost 库。我*知道*他们不是，但这并不是一个软件制作的不合理假设。

如果一个软件甚至不能依赖 Boost，它就不能依赖*任何*库。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2008-09-24T07:19:21.013

看看[http://www.boost.org/doc/tools.html](http://www.boost.org/doc/tools.html)。具体来说，如果您想将 boost-dependencies 嵌入到您的项目中，那么*bcp实用程序会派上用场。*网站摘录：

> “bcp 实用程序是一种用于提取 Boost 子集的工具，它对于希望将其库与 Boost 分开分发的 Boost 作者以及希望将 Boost 子集与他们的应用程序一起分发的 Boost 用户非常有用。
> 
> bcp 还可以报告您的代码依赖于 Boost 的哪些部分，以及这些依赖项使用了哪些许可证。”

当然，这可能有一些缺点——但至少你应该意识到这样做的可能性。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2008-09-24T06:12:03.980

过去我对向系统引入依赖关系非常谨慎，但现在我发现依赖关系并不是什么大问题。现代操作系统带有包管理器，这些包管理器通常可以自动解决依赖关系，或者至少可以让管理员轻松安装所需的内容。例如，Boost 在 Gentoo-Postage 下作为 dev-libs/boost 可用，在 FreeBSD 端口下作为 devel/boost 可用。

现代开源软件在其他系统上构建了很多东西。在[最近的一项研究](http://www.spinellis.gr/pubs/jrnl/2007-JSS-api-verify/html/SL07b.html)中，通过跟踪 FreeBSD 包的依赖关系，我们确定在我们的 FreeBSD 4.11 系统中的 12,357 个端口包，总共有 21,135 个库依赖项；即，他们需要一个库，而不是作为基本系统一部分的 52 个库，以便编译。库依赖包含 688 个不同的库，而单个项目使用的不同外部库的数量在 1 到 38 之间变化，众数值为 2。此外，5,117 个项目使用了至少一个外部库，405 个项目使用了 10 个或更多.

最后，您的问题的答案将来自成本与收益分析。重用成熟、广泛使用、经过审查和测试的库（如 Boost）的好处是否大于依赖项的低成本和不断下降的成本？对于 Boost 工具的任何重要用途，答案是您应该继续使用 Boost。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-24T06:02:20.230

KDE 也依赖于 Boost。

然而，这主要取决于您的目标，甚至更多取决于您的目标受众，而不是您的项目范围。例如 TinyJSON（非常小的项目），几乎是 100% Boost，但这很好，因为它提供的 API 类似于 Boost，并且针对需要 JSON 绑定的 Boost 程序员。然而，许多其他 JSON 库不使用 Boost，因为它们针对的是其他受众。

另一方面，我不能在工作中使用 Boost，而且我知道很多其他开发人员（在他们的日常工作中）都在同一条船上。所以我想你可以说如果你的目标是开源的，并且一个使用 Boost 的小组，请继续。如果您的目标是企业，您可能需要考虑一下，并从 Boost 中复制粘贴必要的部分（并承诺他们的支持），以使您的项目能够正常工作。

*   **编辑：**我们不能在工作中使用它的原因是因为我们的软件必须可移植到大约 7 个不同的平台和 4 个编译器。所以我们不能使用 boost，因为它没有被证明与我们所有的目标兼容，所以原因是技术问题。（我们对 OpenSource 和 Boost License 部分很好，因为我们有时将 Boost 用于其他事情）

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-09-24T07:14:27.857

这取决于。如果您在 Boost 中使用仅定义类模板的头文件 - 那么可以继续使用它，因为它不会吸收任何 Boost 共享库，因为所有代码都是在编译时生成的，没有外部依赖项。版本控制问题对于任何共享的 c++ 库来说都是一个痛苦，而 Boost 也不能​​幸免于此，所以如果你可以完全避免这个问题，那是一件好事。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-09-24T10:56:43.097

在编写 C++ 代码时使用 boost 的好处大大超过了分发开源代码的额外复杂性。

I work on [Programmer's Notepad](http://pnotepad.org/) and the code takes a dependency on boost for test, smart pointers, and python integration. There have been a couple of complaints due to the requirement, but most will just get on with it if they want to work on the code. Taking the boost dependency was a decision I have never regretted.

To make the complexity slightly less for others, I include versioned pre-built libraries for boost python so that all they need to do is provide boost in their include directories.

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-09-24T05:54:05.757

我会说是的。Mandriva （[基于](http://en.wikipedia.org/wiki/Mandriva_Linux)[Red Hat](http://en.wikipedia.org/wiki/Red_Hat_Linux)）和 Ubuntu（基于[Debian](http://en.wikipedia.org/wiki/Debian)）都有用于 Boost 库的软件包。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-24T07:28:26.217

我认为 Boost 提供的广泛功能，正如您所说，它是标准的非标准 C++ 库，证明它是一个依赖项。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-09-24T06:01:42.243

不幸的是，对于 ubuntu，它们很容易获得，但对于 RHEL 4&5，我几乎总是最终用 tarball 制作它们。它们是很棒的图书馆，真的很大……就像有时你真正需要的只是一个图钉时使用一个铁轨钉。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-24T07:26:11.870

这完全取决于您使用 Boost 的方式。正如 Diomidis 所说，如果您要使用 Boost 的一些重要设施，那就继续吧。使用图书馆不是犯罪。

当然，也有很多人不喜欢使用 Boost，因为引入新的依赖总是有一些缺点和额外的担忧，但是在一个开源项目中......我认为如果你只是想学习，使用它们甚至可以他们或提高你对他们的技能。

# c# - C# / ASP.NET - Web 应用程序锁定

> ID：125606
> 
> 赞同：2
> 
> 时间：2008-09-24T05:49:07.750
> 
> 标签：c#, asp.net, synchronization, locking

我正在开发一个 C#/ASP.NET Web 应用程序，并且在许多情况下我需要进行锁定。理想情况下，我希望锁独立运行，因为它们彼此无关。我一直在考虑`[MethodImpl(MethodImplOptions.Synchronized)]`和一些使用方法`lock()`，但我有一些问题/疑虑。

看起来像 MethodImplOptions.Synchronized `will essentially do`lock(this)`。如果是这种情况，似乎一个线程进入任何同步方法都会阻止*所有其他*线程进入*任何*同步方法。那正确吗？如果是这样，这还不够细化。在这一点上，我似乎还不如使用 Application.Lock。（但如果我错了，请纠正我。）

关于`lock()`，我试图弄清楚我应该传入什么。我是否应该专门为此目的创建一组对象，并将每个对象用于不同的锁？有没有更好的办法？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T05:58:21.067

我的偏好是专门为锁创建一个对象。

```
private object lockForSomeResource = new object(); 
```

在管理有争议的资源的类中。Jeff Richter 发表了[一篇](http://msdn.microsoft.com/en-us/magazine/cc188793.aspx)我前段时间读过的文章，推荐了这一点。

如果锁中有任何代码需要另一个锁，您需要仔细考虑将它们设计为层次结构。确保您始终以相同的顺序请求它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T07:10:49.333

我在这个论坛上发布了一个类似的问题，这可能会对你有所帮助。以下是链接

[在 .NET 的 Web 服务中写入单个文件的问题](https://stackoverflow.com/questions/119548/problem-in-writing-to-single-file-in-web-service-in-net)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T05:53:27.537

您可以公开一些静态引用或单例，然后 lock() 。

也许您可以解释一下为什么需要这种锁定以及将其用于什么用途？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T05:56:18.077

在静态/应用程序级别创建离散对象实例是纯排他锁定的最佳方式。

还应该考虑应用程序级别的读/写锁实例是否也有助于提高应用程序的并发性，例如读取和更新列表、哈希等。

# c# - 如何超链接到不在我的 Web 应用程序中的文件？

> ID：125610
> 
> 赞同：0
> 
> 时间：2008-09-24T05:49:50.213
> 
> 标签：c#, asp.net

好的，我的 Web 应用程序位于**C:\inetpub\wwwroot\website**

我要链接的文件在**S:\someFolder**

我可以在 webapp 中**创建指向 someFolder**中文件的链接吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T05:51:47.447

如果它在服务器上的不同驱动器上，则需要在 IIS中创建一个[虚拟目录。](http://www.zerog.com/ianetmanual/IISVDirs_O.html)然后，您将链接到“ `/virtdirect/somefolder/`”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T05:53:21.687

您必须通过您的网络服务器将其专门映射到某个 URL。否则，任何猜到 URL 的人都可以访问您的所有文件，而您不希望这样......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T05:54:47.673

您是否有另一个指向 s:\someFolder 的虚拟目录/应用程序？如果是这样，它只是一个简单的链接。

您是否正在尝试流式传输文件？如果是这样，请查看 Response.TransmitFile 和 Response.WriteFile。

否则，也许您可​​以创建一个处理程序 (.ashx) 来获取指定文件并将其内容流回？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T06:02:56.173

我认为只有两种方法 1）创建一个指向下载目录的虚拟路径 2）调用您的 aspx/ashx 处理程序，在本地加载文件并将其发送到客户端。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T06:46:02.573

在操作系统级别而不是网络服务器级别工作的解决方案是创建符号链接。

[Vista 支持](http://technet.microsoft.com/en-us/library/cc753194.aspx)文件链接， [Win2000](http://support.microsoft.com/kb/205524)及更高版本支持文件夹链接（“联结”）。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-24T05:54:40.590

这取决于您的 Web 服务器的配置。可能不是。您不希望 Web 服务器能够访问硬盘驱动器上的任何文件（即您的密码文件），因此只有那些在 Web 服务器的配置文件中配置为可访问的文件才可访问并可以链接到。通常这些都保存在一个目录下。当然，您可以复制 someFolder 并将其放在您的 Web 目录下，这样就可以访问它，或者如果您确定它是安全的，请更改您的 Web 服务器的配置以允许访问该文件夹。

# asp.net - 如何将 css 应用于二级菜单项？

> ID：125612
> 
> 赞同：1
> 
> 时间：2008-09-24T05:52:29.660
> 
> 标签：asp.net, css, sitemap

我有一个从站点地图运行的菜单，其中一个 SiteMapNode 如下所示：

```
<siteMapNode title="Gear" description="" url="">
  <siteMapNode title="Armor" description="" url="~/Armor.aspx" />
  <siteMapNode title="Weapons" description="" url="~/Weapons.aspx" />
</siteMapNode> 
```

我还有一个皮肤应用于 asp:menu，它使用以下 css 定义：

```
.nav-bar {
  z-index: 2;
  margin-top: -5%;
  position: absolute;
  top: 281px;
  font-family: Jokewood;
  font-style: italic;
} 
```

当我运行网站并将鼠标悬停在 Gear 链接上时，Jokewood 字体未应用于这些项目，如何将 css 应用于 Armor 和 Weapons 标题？

**更新**
我应该提到字体在所有非嵌套的 siteMapNodes 上都正确显示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T06:01:27.267

您可以通过按顺序列出 CSS 命令来嵌套它们

siteMapNode siteMapNode { .... css code ... } 将应用于内部节点。

例如，

#menu ul ul { ... }

将应用于
<ul> <-- 不在这里
<li>
</li>
</ul>
<div id="menu">
<ul> <-- 不在这里
<ul> <----**在这里**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T06:15:59.307

Firefox 的[Web Developer (](https://addons.mozilla.org/en-US/firefox/addon/60) [https://addons.mozilla.org/en-US/firefox/addon/60](https://addons.mozilla.org/en-US/firefox/addon/60) ) 插件是 firebug 的一个很好的替代品/伴侣。更**容易用于 CSS 调试**(IMO)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T06:32:01.827

您应该像这样绑定样式（对于静态和动态菜单项）：

```
<asp:Menu ID="Menu1" runat="server" >
    <StaticMenuStyle CssClass="nav-bar" />
    <DynamicMenuStyle CssClass="nav-bar" />
</asp:Menu> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T06:51:52.683

皮肤通过 .skin 模板应用。

```
<asp:Menu runat="server" CssClass="nav-bar" /> 
```

# ios - 如何在我的应用程序运行时防止 iPhone 屏幕变暗或关闭？

> ID：125619
> 
> 赞同：122
> 
> 时间：2008-09-24T05:55:29.577
> 
> 标签：ios, uiapplication

我正在开发一个不需要用户输入的应用程序，但我不希望 iPhone 进入省电模式。

是否可以从应用程序禁用省电功能？

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2008-09-24T06:07:02.217

**Objective-C**

```
[[UIApplication sharedApplication] setIdleTimerDisabled:YES]; 
```

**迅速**

```
UIApplication.shared.isIdleTimerDisabled = true 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-03-27T07:02:41.310

在**swift**中，您可以将其用作

```
UIApplication.sharedApplication().idleTimerDisabled = true 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-11-29T13:19:36.630

**斯威夫特 3：**

```
UIApplication.shared.isIdleTimerDisabled = true 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-17T17:56:42.790

我已经将这行代码放在我的视图控制器中，但我们仍然让客户说屏幕会变暗或关闭，直到有人触摸屏幕。我看过其他帖子，您不仅以编程方式设置

```
UIApplication.sharedApplication().idleTimerDisabled = true 
```

为 true 但您必须先将其重置为 false

```
UIApplication.sharedApplication().idleTimerDisabled = false
UIApplication.sharedApplication().idleTimerDisabled = true 
```

遗憾的是，这仍然不起作用，客户的屏幕仍然变暗。我们有 Apple Configurator 配置文件，可防止设备进入睡眠状态，但仍有一些设备的屏幕变暗，客户需要按下主页按钮才能唤醒屏幕。我现在将这段代码放入每 2.5 小时触发一次以重置空闲计时器的计时器中，希望这会起作用。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-05T15:40:17.823

我们遇到了同样的问题。原来是我们的 MDM 服务器上的一个流氓进程，它在我们的帐户中被删除，但服务器上仍在发送命令来调暗我们的设备。

# algorithm - 将几张图片拼成一张大图

> ID：125620
> 
> 赞同：7
> 
> 时间：2008-09-24T05:55:45.223
> 
> 标签：algorithm, packing

我正在尝试将几张图像放在一个大图像中，并且正在寻找一种算法来确定最佳位置。图像无法旋转或调整大小，但结果图像中的位置并不重要。

编辑：添加没有调整大小约束

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T06:02:14.817

可能您正在寻找这样的东西：[自动杂志布局](http://www.alistapart.com/articles/magazinelayout)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T08:13:22.083

显然它被称为“打包问题”，这是游戏编程中经常使用的问题。对于那些感兴趣的人，这里有一些建议的实现：

[打包光照贴图](http://www.blackpawn.com/texts/lightmaps/default.html)、 [矩形打包](http://www.nuclex.org/pages/framework/rectangle-packing)和 [矩形放置](http://www.flipcode.com/archives/Rectangle_Placement.shtml)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-10T17:02:35.943

最佳包装很难，但根据您的问题域的详细信息，您可能会得到简化。一些想法：

1.  如果您可以将位图分割成大小相同的图块，那么打包是微不足道的。然后，根据需要，您将从图块中重新组合位图。

2.  将图像从大到小排序，然后，对于每个图像，使用贪婪分配器来选择适合图像的第一个可用子矩形。

3.  使用遗传算法。从几个随机选择的布局开始。根据包装的紧密程度对它们进行评分。混合得分最高的解决方案，并进行迭代，直到获得可接受的分数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T08:04:11.357

我为此创建了一个算法，它实际上是[NP-Hard](http://en.wikipedia.org/wiki/NP-hard) [Bin 打包](http://en.wikipedia.org/wiki/Bin_packing_problem)问题的一个变体，但具有无限的 bin 大小。

您可以尝试查找一些关于它的文章并尝试优化您的算法，但最终它仍将是尝试所有可能性并尝试最小化生成的 bin 大小的蛮力方法。

如果您不需要最佳解决方案，而只需要一种解决方案，则可以避免暴力破解所有组合。我创建了一个程序，它也做过一次。

描述：

```
Images: array of the input images
ResultMap: 2d array of Booleans
FinalImage: large image 
```

1.  对图像数组进行排序，使最大的图像位于顶部。
2.  计算图像的总大小并初始化 ResultMap，使其大小为图像总大小的 1.5 倍（您可以使这一步更智能，以提高内存使用率和性能）。使 ResultMap 的大小相同，并用 False 值填充它。
3.  然后在 FinalImage 左侧添加第一个图像，并将 ResultMap 中的所有布尔值设置为 true，从 0,0 到 ImageHeight、ImageWidth。

ResultMap 用于快速检查您是否可以在当前 FinalImage 上适合图像。您可以对其进行优化以使用 int32 并将每个位用于一个像素。这将减少内存并提高性能，因为您可以一次检查 32 位（使用掩码）。但这将变得更加困难，因为您必须考虑为图像边缘制作所需的蒙版。

现在我将描述“算法”的真正循环。

1.  对于数组中的每个图像，尝试找到一个合适的位置。您可以编写一个循环，该循环将通过 ResultMap 数组查找并查找错误值，然后开始查看它是否在两个方向上都为要放置的图像大小的错误。
    *   如果找到一个地方，将图像复制到 FinalImage 并在 ResultMap 中更新正确的布尔值
    *   如果你能找到一个地方，将 FinalImage 的大小增加得恰到好处（因此请查看需要最少额外空间的边缘）并将其与 ResultMap 同步
2.  转到 1 :)

它不是最佳的，但它可以以合理的最佳方式解决问题（特别是如果最后有一些较小的图像来填补空白）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2008-09-24T06:08:09.980

您可能正在寻找[SIFT](http://en.wikipedia.org/wiki/Scale-invariant_feature_transform)

[http://www.cs.ubc.ca/~lowe/keypoints/](http://www.cs.ubc.ca/~lowe/keypoints/)

[http://user.cs.tu-http://www.cs.ubc.ca/~lowe/keypoints/.de/~nowozin/autopano-sift/technicaldetails.html](http://user.cs.tu-http://www.cs.ubc.ca/~lowe/keypoints/.de/~nowozin/autopano-sift/technicaldetails.html)

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2008-09-24T10:51:07.057

以非编程方式，您可以使用 MS Paint 功能“粘贴自”，即将 (JPEG) 文件粘贴到 mspaint 图像区域。使用它，您可以排列单个图像，并创建最终的大图像并将其保存为 JPEG/GIF/Raw-BMP 格式。

-广告。

# sql-server - 您将在 SQL Server/Reporting Services 中使用哪些图表工具/控件？

> ID：125626
> 
> 赞同：0
> 
> 时间：2008-09-24T06:00:28.720
> 
> 标签：sql-server, reporting-services, charts

除了像 Dundas 这样的商业工具外，是否有任何开源或更便宜（和体面的）第三方图表工具/控件用于报告服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T14:40:16.367

您可以尝试使用 ChartFX for ReportingServices。它不太贵。

[http://www.softwarefx.com/sfxSqlProducts/cfxReportingServices/](http://www.softwarefx.com/sfxSqlProducts/cfxReportingServices/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-01-13T04:50:09.923

微软图表控件很好。我曾在我的一个项目中使用过它。

阅读更多： http: [//parasdoshi1989.wordpress.com/2010/10/03/how-to-include-charts-in-visual-studio-2008-express-edition-using-microsoft-chart-control/](http://parasdoshi1989.wordpress.com/2010/10/03/how-to-include-charts-in-visual-studio-2008-express-edition-using-microsoft-chart-control/)

# .net - 如何在没有 Web 参考的情况下调用 Web 服务？

> ID：125627
> 
> 赞同：6
> 
> 时间：2008-09-24T06:00:30.890
> 
> 标签：.net, visual-studio-2008, web-services

我想调用一个网络服务，但直到运行时我才知道 URL。

什么是获取网络参考的最佳方式，而无需实际提交 url。

让 1 个客户端在 10 个不同的域上访问相同的 Web 服务怎么样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T06:04:17.103

创建 Web 引用，并将 Web 服务转换为动态 Web 服务。动态 Web 服务允许您修改 URL。

您现在需要创建 Web 引用以确保您的应用程序理解可用的接口。通过切换到动态 Web 服务，您可以在代码中初始化 Web 引用后修改 .Url 属性。

```
service = new MyWebService.MyWebService();
service.Url = myWebServiceUrl; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T06:06:02.233

您可以更改 Web 引用向导生成的类的 Url 属性。

这是一个非常相似的问题；[如何在不重新编译的情况下在 .NET 中动态切换 Web 服务地址？](https://stackoverflow.com/questions/125399/how-can-i-dynamically-switch-web-service-addresses-in-net-without-a-recompile)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T06:08:33.960

您可以通过一个简单的 http 请求调用您的网络服务：示例：

[http://serverName/appName/WSname.asmx/yourMethod](http://serverName/appName/WSname.asmx/yourMethod)？参数1=val1¶m2=val2;

如果通过 Http 调用，http 响应将是序列化结果。

但是，如果您使用 Web 引用，则始终可以通过 Web 服务代理类中的 Url 属性更改 Url。URL 通常会存储在您的 web.config 中

我希望我能帮助你

# url - 是否可以使用 URL 参数链接到 PDF 中的书签？

> ID：125632
> 
> 赞同：83
> 
> 时间：2008-09-24T06:02:15.363
> 
> 标签：url, pdf, hyperlink, bookmarks

在网站上提供指向 PDF 文件的链接时，是否可以在 URL（请求参数）中包含信息，这将使 PDF 浏览器插件（如果使用）跳转到特定的书签，而不仅仅是在开头打开？

像：[http](http://www.somehost.com/user-guide.pdf?bookmark=chapter3) ://www.somehost.com/user-guide.pdf?bookmark=chapter3 ？

如果不是书签，是否可以转到特定页面？

我假设如果有答案，它可能特定于 Adob​​e 的 PDF 阅读器插件或其他东西，并且可能有版本限制，但我最感兴趣的是该技术是否存在。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-09-24T06:09:55.187

是的，您可以按编号或指定位置链接到特定页面，**如果用户的浏览器使用 Adob​​e Reader 作为查看 PDF 文件的插件，**这将始终有效。

对于按编号的特定页面：

```
<a href="http://www.domain.com/file.pdf#page=3">Link text</a> 
```

对于命名位置（目的地）：

```
<a href="http://www.domain.com/file.pdf#nameddest=TOC">Link text</a> 
```

要使用 Acrobat 在 PDF 中创建目标：

1.  手动浏览 PDF 以找到所需位置
2.  转到视图 > 导航选项卡 > 目的地
3.  在选项下，选择扫描文档
4.  完成后，从选项菜单中选择新目的地并输入适当的名称

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2008-09-24T07:16:16.480

[RFC 3778 第 3 节](https://www.rfc-editor.org/rfc/rfc3778#section-3)指定可用于 PDF 文件的“片段标识符”，其中包括 nameddest 和 page。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-06-27T08:44:24.873

可以处理多个查询参数。完整列表如下：

[来源](http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/pdf_open_parameters.pdf#page=5&zoom=auto,-169,394)

```
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| Syntax                  | Description                                                                                  | Example                                              |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| nameddest=destination   | Specifies a named destination in the PDF document                                            | http://example.org/doc.pdf#Chapter6                  |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| page=pagenum            | Specifies a numbered page in the document, using an integer                                  | http://example.org/doc.pdf#page=3                    |
|                         | value. The document’s first page has a pagenum value of 1\.                                   |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| comment=commentID       | Specifies a comment on a given page in the PDF document. Use                                 | #page=1&comment=452fde0e-fd22-457c-84aa-             |
|                         | the page command before this command.                                                        | 2cf5bed5a349                                         |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| collab=setting          | Sets the comment repository to be used to supply and store                                   | #collab=DAVFDF@http://review_server/Collab           |
|                         | comments for the document. This overrides the default comment                                | /user1                                               |
|                         | server for the review or the default preference. The setting is of the                       |                                                      |
|                         | form store_type@location, where valid values for store_type are:                             |                                                      |
|                         | ● DAVFDF (WebDAV)                                                                            |                                                      |
|                         | ● FSFDF (Network folder)                                                                     |                                                      |
|                         | ● DB (ADBC)                                                                                  |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| zoom=scale              | Sets the zoom and scroll factors, using float or integer values. For                         | http://example.org/doc.pdf#page=3&zoom=200,250,100   |
| zoom=scale,left,top     | example, a scale value of 100 indicates a zoom value of 100%.                                |                                                      |
|                         | Scroll values left and top are in a coordinate system where 0,0                              |                                                      |
|                         | represents the top left corner of the visible page, regardless of                            |                                                      |
|                         | document rotation                                                                            |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| view=Fit                | Set the view of the displayed page, using the keyword values                                 | http://example.org/doc.pdf#page=72&view=fitH,100     |
| view=FitH               | defined in the PDF language specification. For more information,                             |                                                      |
| view=FitH,top           | see the PDF Reference.                                                                       |                                                      |
| view=FitV               | Scroll values left and top are floats or integers in a coordinate                            |                                                      |
| view=FitV,left          | system where 0,0 represents the top left corner of the visible                               |                                                      |
| view=FitB               | page, regardless of document rotation.                                                       |                                                      |
| view=FitBH              | Use the page command before this command.                                                    |                                                      |
| view=FitBH,top          |                                                                                              |                                                      |
| view=FitBV              |                                                                                              |                                                      |
| view=FitBV,left         |                                                                                              |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| viewrect=left,top,wd,ht | Sets the view rectangle using float or integer values in a                                   |                                                      |
|                         | coordinate system where 0,0 represents the top left corner of the                            |                                                      |
|                         | visible page, regardless of document rotation.                                               |                                                      |
|                         | Use the page command before this command.                                                    |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| pagemode=bookmarks      | Displays bookmarks or thumbnails.                                                            | http://example.org/doc.pdf#pagemode=bookmarks&page=2 |
| pagemode=thumbs         |                                                                                              |                                                      |
| pagemode=none           |                                                                                              |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| scrollbar=1|0           | Turns scrollbars on or off                                                                   |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| search=wordList         | Opens the Search panel and performs a search for any of thewords in the specified word list. | #search="word1 word2"                                |
|                         | The first matching word ishighlighted in the document.                                       |                                                      |
|                         | The words must be enclosed in quotation marks and separated byspaces.                        |                                                      |
|                         | You can search only for single words. You cannot search for a string of words.               |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| toolbar=1|0             | Turns the toolbar on or off.                                                                 |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| statusbar=1|0           | Turns the status bar on or off.                                                              |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| messages=1|0            | Turns the document message bar on or off.                                                    |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| navpanes=1|0            | Turns the navigation panes and tabs on or off.                                               |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| highlight=lt,rt,top,btm | Highlights a specified rectangle on the displayed page. Use the                              |                                                      |
|                         | page command before this command.                                                            |                                                      |
|                         | The rectangle values are integers in a coordinate system where                               |                                                      |
|                         | 0,0 represents the top left corner of the visible page, regardless of                        |                                                      |
|                         | document rotation                                                                            |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+
| fdf=URL                 | Specifies an FDF file to populate form fields in the PDF file beingopened.                   | #fdf=http://example.org/doc.fdf                      |
|                         | Note: The fdf parameter should be specified last in a URL.                                   |                                                      |
+-------------------------+----------------------------------------------------------------------------------------------+------------------------------------------------------+ 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-08-27T20:22:08.403

值得补充的是，[韦恩的解决方案](https://stackoverflow.com/a/125650/2693875)也**适用**于：

*   Chrome（自 2011 年第 14 版以来，请参阅[本期](https://code.google.com/p/chromium/issues/detail?id=65851)了解详细信息）（在第 87 版和第 44 版上测试），
*   Firefox（在 v. 84.0.1 和 v. 40 上测试），
*   Opera（在第 73 节和第 31 节测试），
*   Safari（在 v. 14.0.2 上测试，在 v. 8 上*不起作用*），

**（更新为截至 2021 年 1 月**的当前版本。）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-05-21T18:44:38.093

[PDF Open Parameters](http://www.adobe.com/content/dam/Adobe/en/devnet/acrobat/pdfs/pdf_open_parameters.pdf#page=5&zoom=auto,-169,394 "PDF 打开参数")记录了您可以使用的可用 URL 片段。

# sql-server - 使用 Reporting Services 学习图表的书籍/资源推荐

> ID：125636
> 
> 赞同：0
> 
> 时间：2008-09-24T06:03:29.040
> 
> 标签：sql-server, reporting-services, charts, business-intelligence, dashboard

您会推荐哪些书籍或在线资源来学习如何使用 Reporting Services 进行高级图表和仪表板设计？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T06:53:09.703

虽然不是特定于 SSRS[定量信息的视觉显示](http://www.edwardtufte.com/tufte/books_vdqi)是开始的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-25T07:06:13.250

我非常偏爱[信息仪表板设计：数据的有效视觉传达](https://rads.stackoverflow.com/amzn/click/com/0596100167)。读过那本书后，我还发现[COLOURLovers](http://www.colourlovers.com/)是获得非常漂亮的 colo(u)rs 调色板的好地方，这是书中推荐的一部分。

就个人而言，我不确定 SSRS 是否非常适合仪表板应用程序（我曾致力于 SSRS 的实现），尽管 SSAS 从报告/仓库方面恕我直言肯定很棒，但 SSRS 的故事似乎不适合......只是我的轶事意见。

这是一个很大的话题，祝你好运！

理查德

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-15T21:37:22.653

对于仪表板，我可以推荐[性能仪表板：衡量、监控和管理您的业务](http://best-gear.org/performance-dashboards-measuring-monitoring-and-managing-your-business/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-28T16:08:12.583

SSRS 可能不是仪表板的最佳方法，尽管它提供了出色的报告功能。

您可能想看看 Microsoft PerformancePoint 2007。它可以用 SSRS、SQL、Excel 等数据制作仪表板和小部件，并在 Sharepoint 上直观地显示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-28T16:22:23.773

我已经阅读了市场上的大多数 SSRS 2008 书籍，并强烈推荐两本——它们都有大量关于图表和仪表的内容

应用 Microsoft SQL Server 2008 报告服务，作者 Teo Lachev [http://www.amazon.com/Applied-Microsoft-Server-Reporting-Services/dp/0976635313/ref=pd_bbs_sr_1?ie=UTF8&s=books&qid=1233159590&sr=8-1](https://rads.stackoverflow.com/amzn/click/com/0976635313)

Microsoft® SQL Server 2008 报告服务，作者 Brian Larson [http://www.amazon.com/Microsoft%C2%AE-Server-Reporting-Services-Microsoft/dp/0071548084/ref=pd_bbs_sr_2?ie=UTF8&s=books&qid=1233159590&sr= 8-2](https://rads.stackoverflow.com/amzn/click/com/0071548084)

# wpf - 在运行时动态创建 WPF ItemTemplate

> ID：125638
> 
> 赞同：4
> 
> 时间：2008-09-24T06:04:27.947
> 
> 标签：wpf, listview

在运行时，我想在 WPF ListView 中动态构建网格列（或其他显示布局）。我事先不知道列的数量和名称。

我希望能够做到：
MyListView.ItemSource = MyDataset;
MyListView.CreateColumns();

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-15T06:05:10.683

您可以使用附加属性将列动态添加到 ListView。查看**CodeProject**上的这篇文章，它准确地解释了......

[WPF DynamicListView - 绑定到 DataMatrix](http://www.codeproject.com/KB/WPF/WPF_DynamicListView.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-16T12:15:03.500

来自 MSDN：

```
 MyListBox.ItemsSource = view;
    ListView myListView = new ListView();

    GridView myGridView = new GridView();
    myGridView.AllowsColumnReorder = true;
    myGridView.ColumnHeaderToolTip = "Employee Information";

    GridViewColumn gvc1 = new GridViewColumn();
    gvc1.DisplayMemberBinding = new Binding("FirstName");
    gvc1.Header = "FirstName";
    gvc1.Width = 100;
    myGridView.Columns.Add(gvc1);
    GridViewColumn gvc2 = new GridViewColumn();
    gvc2.DisplayMemberBinding = new Binding("LastName");
    gvc2.Header = "Last Name";
    gvc2.Width = 100;
    myGridView.Columns.Add(gvc2);
    GridViewColumn gvc3 = new GridViewColumn();
    gvc3.DisplayMemberBinding = new Binding("EmployeeNumber");
    gvc3.Header = "Employee No.";
    gvc3.Width = 100;
    myGridView.Columns.Add(gvc3);

    //ItemsSource is ObservableCollection of EmployeeInfo objects
    myListView.ItemsSource = new myEmployees();
    myListView.View = myGridView;
    myStackPanel.Children.Add(myListView); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T16:08:22.863

我会尝试以下方法：

A）您需要让列表框显示网格视图 - 我相信您已经完成了
B）为 GridViewColumnHeader 定义样式：

```
 <Style TargetType="{x:Type GridViewColumnHeader}" x:Key="gridViewColumnStyle">
            <EventSetter Event="Click" Handler="OnHeaderClicked"/>
            <EventSetter Event="Loaded" Handler="OnHeaderLoaded"/>
        </Style> 
```

就我而言，我设置了一大堆其他属性，但在基本场景中 - 你需要 Loaded 事件。单击 - 如果您想添加排序和过滤功能，这很有用。

C）在您的列表视图代码中，将模板与您的网格视图绑定：

```
 public MyListView()
    {
        InitializeComponent();
        GridView gridViewHeader = this.listView.View as GridView;
        System.Diagnostics.Debug.Assert(gridViewHeader != null, "Expected ListView.View should be GridView");
        if (null != gridViewHeader)
        {
            gridViewHeader.ColumnHeaderContainerStyle = (Style)this.FindResource("gridViewColumnStyle");
        }
    } 
```

D）然后在您的 OnHeaderLoaded 处理程序中，您可以根据列的数据设置适当的模板

```
 void OnHeaderLoaded(object sender, RoutedEventArgs e)
    {
        GridViewColumnHeader header = (GridViewColumnHeader)sender;
        GridViewColumn column = header.Column; 
```

//在此处选择并应用您的数据模板。

```
 e.Handled = true;
    } 
```

E）我猜你还需要获取 ItemsSource 依赖属性的所有权并处理它的更改事件。

```
 ListView.ItemsSourceProperty.AddOwner(typeof(MyListView), new PropertyMetadata(OnItemsSourceChanged));

        static void OnItemsSourceChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
        {
            MyListView view = (MyListView)sender;
            //do reflection to get column names and types
            //and for each column, add it to your grid view:
            GridViewColumn column = new GridViewColumn();
            //set column properties here...
            view.Columns.Add(column);
        } 
```

GridViewColumn 类本身没有太多属性，因此您可能希望使用附加属性在其中添加一些信息 - 即像唯一的列标记 - 标题很可能会用于本地化，并且您不会中继这个。

一般来说，这种方法虽然相当复杂，但可以让您轻松扩展列表视图功能。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T06:47:20.607

有一个**DataTemplateselector**来选择一个预定义的模板（相同的 DataType）并将选择器应用于 ListView。您可以拥有尽可能多的具有不同列的 DataTemplate。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-10-16T15:18:57.440

您可以使用**DataTemplateSelector**返回您在代码中动态创建的 DataTemplate。但是，这比使用 XAML 中的预定义有点繁琐且复杂，但仍然可以。看看这个例子：[http ://dedjo.blogspot.com/2007/03/creating-datatemplates-from-code.html](http://dedjo.blogspot.com/2007/03/creating-datatemplates-from-code.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-23T20:20:51.767

根据经验，如果您能提供帮助，我建议您不要使用动态数据模板……而是使用此处给出的建议来明确创建 ListView 列，而不是尝试动态创建 DataTemplate。

原因是 FrameworkElementFactory（或用于在运行时生成 DataTemplates 的任何类名）使用起来有些笨拙（并且不推荐使用 XAML 来支持动态模板）——无论哪种方式都会对性能造成影响。

# internationalization - Smarty 模板 i18n

> ID：125646
> 
> 赞同：1
> 
> 时间：2008-09-24T06:07:40.560
> 
> 标签：internationalization, smarty

我只是想知道在 Smarty 模板中制作 i18n 的简单方法。我已经在我的 PHP 脚本中使用了类似 gettext() 的东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T06:20:57.050

我最近尝试使用 intSmarty ( [http://code.google.com/p/intsmarty/](http://code.google.com/p/intsmarty/) ) 没有成功——在我看来 intSmarty 类与最新的 Smarty 代码不兼容，这并不奇怪，因为intSmarty 设计通过覆盖私有方法打破了封装。

这个： [http](http://blog.piins.com/2008/03/first-piins-os-release-smarty-i18n.html) ://blog.piins.com/2008/03/first-piins-os-release-smarty-i18n.html 听起来很有趣，但我发现缺少文档。我已经进行了测试安装，并且正在尝试对示例代码进行足够的破译，以查看它是否真的有用。

我还没有评估过[http://sourceforge.net/projects/smarty-gettext/](http://sourceforge.net/projects/smarty-gettext/)，但计划这样做。

也喜欢看看其他人发现了什么

# design-patterns - 设计模式的类别

> ID：125656
> 
> 赞同：3
> 
> 时间：2008-09-24T06:11:25.590
> 
> 标签：design-patterns, poeaa

经典的“设计模式：可重用的面向对象软件的元素”实际上向我们大多数人介绍了设计模式的概念。

然而，这些天来，我发现 Martin Fowler 的“企业应用程序架构模式”（POEA）之类的书在我的日常工作中更加有用。

在与其他开发人员的讨论中，许多人（公平）指出，像 .NET 这样的框架正在慢慢开始提供 GOF 书中的许多模式，那么为什么要重新发明轮子呢？

似乎许多开发人员认为 GOF 书是唯一值得参考的设计模式。所以他们的逻辑是，因为框架（.NET 等）为我们提供了许多 GOF 模式，所以模式已经过时并且不再那么重要。

令人惊讶的是（至少对我来说）当我提到 POEA 中描述的模式时，我经常会遇到茫然的目光。

POEA 证明模式不仅仅是交互器、单例、命令等。我还要说 GOF 中的模式实际上只是模式的一个独特“类别”，适用于不同（非重叠）设计级别，而不是那些在 POEA。

那么，您的开发中还应用了哪些其他“类别”的模式？这些模式适用于什么级别的设计？它们通常在开发过程的哪个阶段使用？这些模式是否有书籍或参考资料？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-24T06:24:29.490

[Ward wiki 上的CategoryPatterns](http://c2.com/cgi/wiki?CategoryPattern)包含一个分类的模式列表。

前三个是GoF模式

*   创造的
*   结构
*   行为的

然后有问题具体问题

*   安全
*   并发
*   即时的

Fowler 的模式是企业应用程序模式。还有[企业集成模式](http://www.amazon.com/exec/obidos/tg/detail/-/0321200683)。UI 模式也存在……等等……

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-25T15:59:13.733

我只是添加一个答案，因为我对这个问题的回答有所不同。根据 POSA（面向模式的软件架构系列书籍），模式分为三个层次：

*   架构模式（*例如层、MVC、P2P*）
*   设计模式（*例如 GoF 模式*）
*   成语（*例如语言特定的模式，如 C++ 中的 Pimpl、RAII*）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T07:13:24.567

GoF 模式也严格适用于代码。Fowler 的模式不仅适用于代码，还适用于数据和系统组件的排列和互连方式。

此外，如果某些模式已经在编程语言中烘焙，则它们不是必需的。在某些语言中，它们只是成语。有人实际上提出了这样的论点：设计模式是编程语言缺陷的标志。

# c++ - 什么时候应该使用 _aligned_malloc()？

> ID：125663
> 
> 赞同：11
> 
> 时间：2008-09-24T06:13:50.887
> 
> 标签：c++, visual-c++

我一直在阅读遗留代码，其中涉及定制的内存池系统，然后我发现代码使用了_aligned_malloc。我想知道这个功能是什么，我什么时候必须使用它。

* * *

感谢大家。

我确实读过 MSDN，但我想要的答案是“想要某种对齐的原因的一个例子是在 x86 上使用带有 SSE 指令集的数据，其中数据必须对齐到 16 倍数”。

我终于明白这些代码的含义了。再次感谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2008-09-24T06:31:05.557

当内存分配的对齐对您很重要时，此功能很有用。

对齐是指返回的指针的数值必须能被某个数整除，即。`((unsigned int)ptr) % alignment`应评估为 0。

需要某种对齐的一个示例是在 x86 上将数据与 SSE 指令集一起使用，其中数据必须与 16 的倍数对齐。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-28T11:49:49.430

这是您可能涉及的一个用例。在我 17 年的 C/C++ 开发中，我只需要一次`_aligned_malloc()`（WinOS 实现）和`memalign`（POSIX 实现）内核函数，那是在编写低级磁盘 I/O 时。这样做的原因是，当不使用 OS I/O 缓冲区（例如在 WinOS`openfile()`中使用`FILE_FLAG_NO_BUFFERING`标志调用）和读/写磁盘时，操作系统需要内存块与磁盘扇区大小对齐；如果磁盘扇区大小为 512 字节，并且您想将 1234 字节写入磁盘，我会执行以下操作：

```
_aligned_malloc(1234, 512); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T06:17:42.393

你检查过 MSDN 文档吗？[您可以在此处](http://msdn.microsoft.com/en-us/library/8z34s9c6(VS.80).aspx)找到相应的条目 。

# exit - 我如何编写一个程序来告诉我的其他程序何时结束？

> ID：125664
> 
> 赞同：2
> 
> 时间：2008-09-24T06:14:22.883
> 
> 标签：exit, halt

我如何编写一个程序来告诉我的其他程序何时结束？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-24T06:28:36.937

在不是由您自己生成的程序上执行 waitpid() 或 waitid() 的唯一方法是通过 ptrace'ing 成为它的父级。

这是一个示例，说明如何在 posix 操作系统上使用 ptrace 临时成为另一个进程的父进程，然后等到该程序退出。作为副作用，您还可以获得退出代码，以及导致该程序退出的信号。：

```
#include <sys/ptrace.h>
#include <errno.h>
#include <stdio.h>
#include <signal.h>
#include <unistd.h>
#include <sys/wait.h>

int main(int argc, char** argv) {

    int pid = atoi(argv[1]);
    int status;
    siginfo_t si;

    switch (ptrace(PTRACE_ATTACH, pid, NULL)) {
        case 0:
            break;
        case -ESRCH:
        case -EPERM:
            return 0;
        default:
            fprintf(stderr, "Failed to attach child\n");
            return 1;
    }
    if (pid != wait(&status)) {
        fprintf(stderr, "wrong wait signal\n");
        return 1;
    }
    if (!WIFSTOPPED(status) || (WSTOPSIG(status) != SIGSTOP))  {
        /* The pid might not be running */
        if (!kill(pid, 0)) {
            fprintf(stderr, "SIGSTOP didn't stop child\n");
            return 1;
        } else {
            return 0;
        }
    }
    if (ptrace(PTRACE_CONT, pid, 0, 0)) {
        fprintf(stderr, "Failed to restart child\n");
        return 1;
    }

    while (1) {
        if (waitid(P_PID, pid, &si, WSTOPPED | WEXITED)) {
            // an error occurred.
            if (errno == ECHILD)
                return 0;
            return 1;
        }
        errno = 0;

        if (si.si_code & (CLD_STOPPED | CLD_TRAPPED)) {
            /* If the child gets stopped, we have to PTRACE_CONT it
             * this will happen when the child has a child that exits.
             **/
            if (ptrace(PTRACE_CONT, pid, 1, si.si_status)) {
                if (errno == ENOSYS) {
                    /* Wow, we're stuffed. Stop and return */
                    return 0;
                }
            }
            continue;
        }

        if (si.si_code & (CLD_EXITED | CLD_KILLED | CLD_DUMPED)) {
            return si.si_status;
        }
        // Fall through to exiting.
        return 1;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T06:22:11.790

在 Windows 上，我使用的一种技术是创建一个全局命名对象（例如使用 CreateMutex 的互斥锁），然后让监控程序打开同名的互斥锁并等待它（使用 WaitForSingleObject）。第一个程序一退出，第二个程序就获得互斥体并知道第一个程序退出。

在 Unix 上，解决这个问题的常用方法是让第一个程序将其 pid (getpid()) 写入文件。第二个程序可以监视这个 pid（使用 kill(pid, 0)）来查看第一个程序是否已经消失。这种方法受制于竞争条件，无疑有更好的方法来解决它。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-24T06:41:27.513

如果您想生成另一个进程，然后在它运行时什么都不做，那么大多数高级语言已经内置了执行此操作的方法。例如，在 Perl 中，有两个`system`和反引号用于运行进程并等待它们完成，而[IPC::System::Simple](http://search.cpan.org/perldoc?IPC::System::Simple)等模块可以更容易地判断程序是如何终止的，以及你是快乐还是悲伤关于那件事的发生。使用为您处理所有事情的语言功能比尝试自己做要容易得多*。*

如果您使用的是 Unix 风格的系统，那么您分叉的进程的终止将生成一个 SIGCHLD 信号。这意味着您的程序可以执行您的子进程正在运行的其他事情。

捕捉 SIGCHLD 信号取决于您的语言。在 Perl 中，您可以像这样设置信号处理程序：

```
use POSIX qw(:sys_wait_h);

sub child_handler {

    while ((my $child = waitpid(-1, WNOHANG)) > 0) {
         # We've caught a process dying, its PID is now in $child.
         # The exit value and other information is in $?
    }

    $SIG{CHLD} \&child_handler;  # SysV systems clear handlers when called,
                                 # so we need to re-instate it.
}

# This establishes our handler.
$SIG{CHLD} = \&child_handler; 
```

几乎可以肯定，CPAN 上的模块比上面的示例代码做得更好。您可以使用`waitpid`特定的进程 ID（而不是全部 -1），`WNOHANG`如果您想让程序休眠直到其他进程完成，则无需使用。

请注意，当您在信号处理程序中时，可能会发生各种奇怪的事情。可能会出现另一个信号（因此我们使用 while 循环来捕获所有死进程），并且根据您的语言，您可能正在执行另一个操作！

如果您在 Windows 上使用 Perl，那么您可以使用[Win32::Process](http://search.cpan.org/perldoc?Win32::Process)模块来生成一个进程，并调用`->Wait`生成的对象以等待它终止。我不熟悉 的所有内容`Win32::Process`，但是您应该能够等待一段时间`0`（或`1`一毫秒）来检查进程是否已经死亡。

在其他语言和环境中，您的里程可能会有所不同。请确保当您的其他进程死亡时，您检查它是*如何*死亡的。由于用户杀死它而导致子进程死亡通常需要与它成功完成任务而退出不同的响应。

一切顺利，

保罗

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-09-24T07:56:41.297

你在 Windows 上吗？如果是这样，以下应该可以解决问题 - 您需要传递进程 ID：

```
 bool WaitForProcessExit( DWORD _dwPID )
  { 
     HANDLE hProc = NULL;
     bool bReturn = false;

     hProc = OpenProcess(SYNCHRONIZE, FALSE, _dwPID);

     if(hProc != NULL)
     {
       if ( WAIT_OBJECT_0 == WaitForSingleObject(hProc, INFINITE) )
       {
         bReturn = true;
       }
     }

     CloseHandle(hProc) ;
  }

  return bReturn;
} 
```

注意：这是一个阻塞功能。如果您想要非阻塞，那么您需要将 INFINITE 更改为较小的值并在循环中调用它（可能保持 hProc 句柄打开以避免在相同 PID 的不同进程上重新打开）。

另外，我没有时间测试这段源代码，但我从我的一个可以工作的应用程序中提取了它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T06:25:35.213

大多数操作系统通常是同一类的东西....

您记录相关程序的进程 ID，并通过定期查询活动进程来监控它

至少在 Windows 中，您可以触发事件来执行此操作...

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2008-09-24T06:28:45.423

嗯，你不能，鉴于它的性质，这是一项不可能完成的任务。

假设您有一个程序 foo，它将另一个程序 foo-sub 作为输入。

```
Foo {
 func Stops(foo_sub) { run foo_sub; return 1; }
} 
```

这一切的问题都是相当简单的设计，如果 foo-sub 是一个永远不会结束的程序，那么 foo 本身就永远不会结束。没有办法从外部判断是 foo-sub 还是 foo 是导致程序停止的原因，以及是什么决定了您的程序是否只需要一个世纪才能运行？

本质上，这是计算机无法回答的问题之一。要获得更完整的概述，维基百科有一篇关于[此](http://en.wikipedia.org/wiki/The_halting_problem "维基百科：停机问题")的文章。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2008-09-24T06:18:35.010

这被称为“停机问题”并且无法解决。见[http://en.wikipedia.org/wiki/Halting_problem](http://en.wikipedia.org/wiki/Halting_problem)

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2008-09-24T06:21:02.120

如果您想在不执行的情况下分析一个程序，那将是无法解决的问题。

# obfuscation - 代码混淆？

> ID：125666
> 
> 赞同：0
> 
> 时间：2008-09-24T06:15:53.347
> 
> 标签：obfuscation

所以，我喜欢复活节彩蛋……这可以追溯到我成为复活节彩蛋档案馆的发现社区的一员。

不过，我也做了很多开源编程。

我想知道的是，您认为系统地和有条理地混淆代码的最佳方法是什么。

首选 PHP/Python/C/C++ 中的示例，但如果方法解释正确，其他语言也可以。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T07:11:39.703

1.  使用完全优化编译代码。完全剥离二进制文件。
2.  对代码使用反编译器。

我可以保证结果将完全不可读，你甚至无法阅读它；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T06:50:09.850

在这种情况下，您应该使用/编写“混淆器”。为您完成工作的程序。

Salamander 混淆器可用于混淆 .Net 程序，但更多的是防止反编译，因此不完全符合您的需要。

了解 C 混淆的好地方是[International Obfuscated C Code Contest](http://www.ioccc.org/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-04-08T09:57:46.227

本着重命名符号的精神：通过用相同的名称命名不同的变量来过度使用范围和可见性规则。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-04-08T09:47:33.727

对于代码的系统化和有条理的混淆，你无法击败 Perl。如果你想要编译成二进制的东西，总是有 APL。

如果您的目标是 .NET 框架，请将您的复活节彩蛋源代码作为二进制十六进制字符串放入资源文件中。然后，您可以让您的初始化例程之一获取它，对其进行解码并将其编译到内存中。您可以使用反射来调用它。

如果您在编译到内存和调用生成的程序集的技术方面需要帮助，我可以给您我编写的库和使用它的示例程序。

您可以使用此技术加载插件，这在初始化程序中是合法且合理的。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T06:54:38.683

问题是如何在不看起来执行另一个功能的情况下创建看似非混淆的代码（开源）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T06:55:21.210

一些明显的方法：

*   在不破坏内容的情况下，尽可能多地删除评论和空格
*   连接线
*   将变量和函数重命名为无意义（最好是 1 个字符）

# php - PHP 应用程序 URL 路由

> ID：125677
> 
> 赞同：19
> 
> 时间：2008-09-24T06:20:58.593
> 
> 标签：php, url, routing, url-routing

所以我正在编写一个框架，我想在这个框架上构建一些我正在开发的应用程序（框架在那里，所以我有一个可以使用的环境，以及一个可以让我使用单个登录）

我想制作这个框架，它拥有的应用程序使用面向资源的架构。

现在，我想创建一个 URL 路由类，可由 APP 编写者（也可能由 CMS App 用户扩展，但这是未来的 WAYYYY），我试图通过查看找出最好的方法来做到这一点其他应用程序是如何做到的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-24T17:44:40.417

我更喜欢使用 reg ex 而不是制作自己的格式，因为这是常识。我写了一个我使用的小类，它允许我嵌套这些 reg ex 路由表。我曾经使用通过继承实现的类似东西，但它不需要继承，所以我重写了它。

我在一个键上做一个 reg ex 并映射到我自己的控制字符串。以下面的例子为例。我访问`/api/related/joe`了，我的路由器类创建了一个新对象`ApiController`并调用它的方法`relatedDocuments(array('tags' => 'joe'));`

```
// the 12 strips the subdirectory my app is running in
$index = urldecode(substr($_SERVER["REQUEST_URI"], 12)); 

Route::process($index, array(
    "#^api/related/(.*)$#Di"    => "ApiController/relatedDocuments/tags",

    "#^thread/(.*)/post$#Di"    => "ThreadController/post/title",
    "#^thread/(.*)/reply$#Di"   => "ThreadController/reply/title",
    "#^thread/(.*)$#Di"         => "ThreadController/thread/title",

    "#^ajax/tag/(.*)/(.*)$#Di"  => "TagController/add/id/tags",
    "#^ajax/reply/(.*)/post$#Di"=> "ThreadController/ajaxPost/id",
    "#^ajax/reply/(.*)$#Di"     => "ArticleController/newReply/id",
    "#^ajax/toggle/(.*)$#Di"    => "ApiController/toggle/toggle",

    "#^$#Di"                    => "HomeController",
)); 
```

为了减少错误并简化您​​的表格，您可以细分表格。这样您就可以将路由表放入它控制的类中。以上面的示例为例，您可以将三个线程调用合并为一个。

```
Route::process($index, array(
    "#^api/related/(.*)$#Di"    => "ApiController/relatedDocuments/tags",

    "#^thread/(.*)$#Di"         => "ThreadController/route/uri",

    "#^ajax/tag/(.*)/(.*)$#Di"  => "TagController/add/id/tags",
    "#^ajax/reply/(.*)/post$#Di"=> "ThreadController/ajaxPost/id",
    "#^ajax/reply/(.*)$#Di"     => "ArticleController/newReply/id",
    "#^ajax/toggle/(.*)$#Di"    => "ApiController/toggle/toggle",

    "#^$#Di"                    => "HomeController",
)); 
```

然后你定义 ThreadController::route 是这样的。

```
function route($args) {
    Route::process($args['uri'], array(
        "#^(.*)/post$#Di"    => "ThreadController/post/title",
        "#^(.*)/reply$#Di"   => "ThreadController/reply/title",
        "#^(.*)$#Di"         => "ThreadController/thread/title",
    ));
} 
```

您还可以在右侧为您的路由字符串定义您想要的任何默认值。只是不要忘记记录它们，否则你会混淆人们。如果您没有在右侧包含函数名称，我目前正在调用 index 。[这](http://pastie.org/278748)是我当前的代码。您可能希望更改它以处理您喜欢的错误和/或默认操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-04-16T21:01:23.510

又一个框架？ - 反正...

路由的诀窍是将其全部传递给您的路由控制器。

您可能想要使用类似于我在此处记录的内容：

[http://www.hm2k.com/posts/friendly-urls](http://www.hm2k.com/posts/friendly-urls)

第二种解决方案允许您使用类似于 Zend Framework 的 URL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T07:18:15.133

使用正则表达式列表来匹配我应该使用的对象

例如

```
^/users/[\w-]+/bookmarks/(.+)/$
^/users/[\w-]+/bookmarks/$
^/users/[\w-]+/$ 
```

优点：很好很简单，让我直接定义路线缺点：必须订购，不容易添加新东西（很容易出错）

这就是，afaik，Django 是如何做到的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T11:53:07.843

我认为很多框架结合使用 Apache 的 mod_rewrite 和前端控制器。使用 mod_rewrite，您可以将这样的 URL：/people/get/3 转换为：index.php?controller=people&method=get&id=3。Index.php 将实现您的前端控制器，该控制器根据给定的参数路由页面请求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-07-01T09:28:18.057

正如您所料，有很多方法可以做到这一点。

例如，在[Slim Framework](http://www.slimframework.com/)中，路由引擎的示例可能如下（基于模式`${OBJECT}->${REQUEST METHOD}(${PATTERM}, ${CALLBACK})`）：

```
$app->get("/Home", function() {
    print('Welcome to the home page');
}

$app->get('/Profile/:memberName', function($memberName) {
    print( 'I\'m viewing ' . $memberName . '\'s profile.' );
}

$app->post('/ContactUs', function() {
    print( 'This action will be fired only if a POST request will occure');
} 
```

因此，初始化的实例 ( `$app`) 为每个请求方法（例如 get、post、put、delete 等）获取一个方法，并将路由作为第一个参数，将回调作为第二个参数。

路由可以获得令牌——这是“变量”，它会在运行时根据一些数据（例如成员名称、文章 ID、组织位置名称或其他任何东西——你知道，就像在每个路由控制器中一样）发生变化。

就个人而言，我确实喜欢这种方式，但我认为它对于高级框架来说不够灵活。

由于我目前正在与 ZF 和 Yii 合作，因此我确实有一个路由器示例，它是我为我正在工作的公司创建的一个框架的一部分：

路由引擎基于正则表达式（类似于@gradbot 的），但有双向对话，因此如果您的客户端无法运行 mod_rewrite（在 Apache 中）或在他或她的服务器上添加重写规则，他或她仍然可以使用带有查询字符串的传统 URL。

该文件包含一个数组，其中的每一项，每一项都类似于此示例：

```
$_FURLTEMPLATES['login']    =   array(
    'i' => array( // Input - how the router parse an incomming path into query string params
        'pattern' => '@Members/Login/?@i',
        'matches' => array( 'Application' => 'Members', 'Module' => 'Login' ),
    ),
    'o' => array( // Output - how the router parse a query string into a route
        '@Application=Members(&|&amp;)Module=Login/?@' => 'Members/Login/'
    )
); 
```

您还可以使用更复杂的组合，例如：

```
$_FURLTEMPLATES['article']  =   array(
    'i' => array(
        'pattern' => '@CMS/Articles/([\d]+)/?@i',
        'matches' => array( 'Application' => "CMS",
            'Module' => 'Articles',
            'Sector' => 'showArticle',
            'ArticleID' => '$1' ),
    ),
    'o' => array(
     '@Application=CMS(&|&amp;)Module=Articles(&|&amp;)Sector=showArticle(&|&amp;)ArticleID=([\d]+)@' => 'CMS/Articles/$4'
    )
); 
```

底线，我认为，可能性是无穷无尽的，它只取决于你希望你的框架有多复杂以及你希望用它做什么。

例如，如果它只是打算成为一个 Web 服务或简单的网站包装器 - 只需使用 Slim 框架的写作风格 - 非常简单且美观的代码。

但是，如果您希望使用它开发复杂的网站，我认为正则表达式是解决方案。

祝你好运！:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-28T12:43:57.807

您应该查看 Pux [https://github.com/c9s/Pux](https://github.com/c9s/Pux)

这里是概要

```
<?php
require 'vendor/autoload.php'; // use PCRE patterns you need Pux\PatternCompiler class.
use Pux\Executor;

class ProductController {
    public function listAction() {
        return 'product list';
    }
    public function itemAction($id) { 
        return "product $id";
    }
}
$mux = new Pux\Mux;
$mux->any('/product', ['ProductController','listAction']);
$mux->get('/product/:id', ['ProductController','itemAction'] , [
    'require' => [ 'id' => '\d+', ],
    'default' => [ 'id' => '1', ]
]);
$mux->post('/product/:id', ['ProductController','updateAction'] , [
    'require' => [ 'id' => '\d+', ],
    'default' => [ 'id' => '1', ]
]);
$mux->delete('/product/:id', ['ProductController','deleteAction'] , [
    'require' => [ 'id' => '\d+', ],
    'default' => [ 'id' => '1', ]
]);
$route = $mux->dispatch('/product/1');
Executor::execute($route); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2008-09-24T13:41:34.993

Zend 的 MVC 框架默认使用类似的结构

```
/router/controller/action/key1/value1/key2/value2 
```

路由器文件在哪里`router`（通过 映射`mod_rewrite`，`controller`来自控制器动作处理程序，该控制器动作处理程序由派生`Zend_Controller_Action`并`action`引用控制器中名为 的方法的类定义`actionAction`。键/值对可以按任何顺序排列并且可用于动作方法作为关联数组。

我过去在自己的代码中使用过类似的东西，到目前为止它运行得相当好。

* * *

## 回答 #8

> 赞同：-4
> 
> 时间：2008-09-24T10:11:11.223

尝试看看[MVC](http://en.wikipedia.org/wiki/Model-view-controller)模式。
Zend Framework 使用它，例如 CakePHP、CodeIgniter、...

我个人不喜欢 MVC 模型，但它大部分时间都是作为“Web 视图”组件实现的。

这个决定很大程度上取决于偏好......

# .net - WCF 应用程序缓存实现

> ID：125697
> 
> 赞同：0
> 
> 时间：2008-09-24T06:28:19.170
> 
> 标签：.net, web-services

我只是想知道.net wcf 应用程序缓存是如何实现的？是单线程还是多线程？？如果它是多线程，我们如何将应用程序缓存强制为单线程。谢谢你 ：）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T07:04:27.257

WCF 没有自己的缓存实现。您可以自行使用，例如 ASP.NET 附带的 Cache 对象，或者如果您想使用第三方工具或 Microsoft 的缓存应用程序块。

# trac - 从 Trac 获取“数据库已锁定”错误消息

> ID：125701
> 
> 赞同：3
> 
> 时间：2008-09-24T06:29:30.757
> 
> 标签：trac

想知道是否有人从 Trac 获得了臭名昭著的“数据库已锁定”错误以及您是如何解决的。它开始越来越频繁地发生在我们身上。我们真的必须硬着头皮迁移到不同的数据库后端，还是有其他方法？

有关详细信息，请参阅这两个 Trac 错误条目：

[http://trac.edgewall.org/ticket/3446](http://trac.edgewall.org/ticket/3446)

[http://trac.edgewall.org/ticket/3503](http://trac.edgewall.org/ticket/3503)

**编辑 1**感谢您的回答和建议，这似乎证实了我们的怀疑，即迁移到 PostgreSQL 似乎是最佳选择。SQLite 到 PostgreSQL 脚本在这里：[http](http://trac-hacks.org/wiki/SqliteToPgScript) ://trac-hacks.org/wiki/SqliteToPgScript这里什么都没有......

**编辑 2（已解决）**迁移非常顺利，我希望我们不会再看到锁了。据我所知，速度并没有明显好转，但至少锁已经消失了。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T06:37:09.677

这是当前 SQLite 适配器的问题。有一些脚本可以迁移到 postgres，我真的可以推荐，postgres 对于 trac 来说要快得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-09-14T19:14:29.017

他们刚刚在 9 月 10 日修复了这个问题，修复程序将在 0.11.6 中进行。

[http://trac.edgewall.org/ticket/3446#comment:39](http://trac.edgewall.org/ticket/3446#comment:39)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-05-11T21:24:56.733

我认为这还没有 100% 修复。我们每天会遇到几十次这个错误。在我们的案例中，我们有 30 多人*不断*更新 Trac ，因为我们使用它来跟踪几乎所有内容，而不仅仅是错误。从票 #3446 开始：

> 很明显，这是 [...] 由于我们的数据库访问模式...目前将我们的并发限制为每几秒最多一次写入访问

# python - 如何修改文本文件？

> ID：125703
> 
> 赞同：205
> 
> 时间：2008-09-24T06:30:56.650
> 
> 标签：python, file, text

我正在使用 Python，并且想在不删除或复制文件的情况下将字符串插入文本文件。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2008-09-24T06:57:21.907

不幸的是，没有办法在不重写文件的情况下插入文件的中间。正如之前的海报所指出的，您可以使用 seek 附加到文件或覆盖文件的一部分，但如果您想在开头或中间添加内容，则必须重写它。

这是操作系统的事情，而不是 Python 的事情。在所有语言中都是一样的。

我通常做的是从文件中读取，进行修改并将其写入一个名为 myfile.txt.tmp 或类似的新文件。这比将整个文件读入内存要好，因为文件可能太大了。临时文件完成后，我将其重命名为与原始文件相同。

这是一种很好、安全的方法，因为如果文件写入因任何原因崩溃或中止，您仍然拥有未触及的原始文件。

* * *

## 回答 #2

> 赞同：123
> 
> 时间：2008-09-24T06:35:51.053

取决于你想做什么。要附加，您可以使用“a”打开它：

```
 with open("foo.txt", "a") as f:
     f.write("new line\n") 
```

如果你想预先准备一些东西，你必须先从文件中读取：

```
with open("foo.txt", "r+") as f:
     old = f.read() # read everything in the file
     f.seek(0) # rewind
     f.write("new line\n" + old) # write the new line before 
```

* * *

## 回答 #3

> 赞同：82
> 
> 时间：2009-11-28T07:25:54.560

[**`fileinput`**](https://docs.python.org/2/library/fileinput.html)如果使用 inplace=1 参数，Python 标准库的模块将就地重写文件：

```
import sys
import fileinput

# replace all occurrences of 'sit' with 'SIT' and insert a line after the 5th
for i, line in enumerate(fileinput.input('lorem_ipsum.txt', inplace=1)):
    sys.stdout.write(line.replace('sit', 'SIT'))  # replace 'sit' and write
    if i == 4: sys.stdout.write('\n')  # write a blank line after the 5th line 
```

* * *

## 回答 #4

> 赞同：33
> 
> 时间：2008-09-24T10:27:45.520

就地重写文件通常是通过使用修改后的名称保存旧副本来完成的。Unix 人添加一个`~`来标记旧的。Windows 人员会做各种各样的事情——添加 .bak 或 .old——或完全重命名文件或将 ~ 放在名称的前面。

```
import shutil
shutil.move(afile, afile + "~")

destination= open(aFile, "w")
source= open(aFile + "~", "r")
for line in source:
    destination.write(line)
    if <some condition>:
        destination.write(<some additional line> + "\n")

source.close()
destination.close() 
```

代替`shutil`，您可以使用以下内容。

```
import os
os.rename(aFile, aFile + "~") 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-09-25T00:41:01.617

Python 的 mmap 模块将允许您插入文件。以下示例显示了如何在 Unix 中完成它（Windows mmap 可能不同）。请注意，这并不能处理所有错误情况，您可能会损坏或丢失原始文件。此外，这不会处理 unicode 字符串。

```
import os
from mmap import mmap

def insert(filename, str, pos):
    if len(str) < 1:
        # nothing to insert
        return

    f = open(filename, 'r+')
    m = mmap(f.fileno(), os.path.getsize(filename))
    origSize = m.size()

    # or this could be an error
    if pos > origSize:
        pos = origSize
    elif pos < 0:
        pos = 0

    m.resize(origSize + len(str))
    m[pos+len(str):] = m[pos:origSize]
    m[pos:pos+len(str)] = str
    m.close()
    f.close() 
```

也可以在没有 mmap 的情况下使用以 'r+' 模式打开的文件执行此操作，但它不太方便且效率较低，因为您必须从插入位置读取文件内容并将其临时存储到 EOF - 这可能是巨大的。

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2012-11-19T23:24:50.203

正如亚当所提到的，您必须先考虑您的系统限制，然后才能决定是否有足够的内存将其全部读入内存替换部分并重新写入。

如果您正在处理一个小文件或没有内存问题，这可能会有所帮助：

**选项1）** 将整个文件读入内存，对整个或部分行进行正则表达式替换，并将其替换为该行加上额外的行。您需要确保“中间行”在文件中是唯一的，或者如果每行都有时间戳，这应该是非常可靠的。

```
# open file with r+b (allow write and binary mode)
f = open("file.log", 'r+b')   
# read entire content of file into memory
f_content = f.read()
# basically match middle line and replace it with itself and the extra line
f_content = re.sub(r'(middle line)', r'\1\nnew line', f_content)
# return pointer to top of file so we can re-write the content with replaced string
f.seek(0)
# clear file content 
f.truncate()
# re-write the content with the updated content
f.write(f_content)
# close file
f.close() 
```

**选项2）** 找出中间线，并将其替换为该线加上额外的线。

```
# open file with r+b (allow write and binary mode)
f = open("file.log" , 'r+b')   
# get array of lines
f_content = f.readlines()
# get middle line
middle_line = len(f_content)/2
# overwrite middle line
f_content[middle_line] += "\nnew line"
# return pointer to top of file so we can re-write the content with replaced string
f.seek(0)
# clear file content 
f.truncate()
# re-write the content with the updated content
f.write(''.join(f_content))
# close file
f.close() 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-02-02T09:42:12.877

写了一个小班来干净地做到这一点。

```
import tempfile

class FileModifierError(Exception):
    pass

class FileModifier(object):

    def __init__(self, fname):
        self.__write_dict = {}
        self.__filename = fname
        self.__tempfile = tempfile.TemporaryFile()
        with open(fname, 'rb') as fp:
            for line in fp:
                self.__tempfile.write(line)
        self.__tempfile.seek(0)

    def write(self, s, line_number = 'END'):
        if line_number != 'END' and not isinstance(line_number, (int, float)):
            raise FileModifierError("Line number %s is not a valid number" % line_number)
        try:
            self.__write_dict[line_number].append(s)
        except KeyError:
            self.__write_dict[line_number] = [s]

    def writeline(self, s, line_number = 'END'):
        self.write('%s\n' % s, line_number)

    def writelines(self, s, line_number = 'END'):
        for ln in s:
            self.writeline(s, line_number)

    def __popline(self, index, fp):
        try:
            ilines = self.__write_dict.pop(index)
            for line in ilines:
                fp.write(line)
        except KeyError:
            pass

    def close(self):
        self.__exit__(None, None, None)

    def __enter__(self):
        return self

    def __exit__(self, type, value, traceback):
        with open(self.__filename,'w') as fp:
            for index, line in enumerate(self.__tempfile.readlines()):
                self.__popline(index, fp)
                fp.write(line)
            for index in sorted(self.__write_dict):
                for line in self.__write_dict[index]:
                    fp.write(line)
        self.__tempfile.close() 
```

然后你可以这样使用它：

```
with FileModifier(filename) as fp:
    fp.writeline("String 1", 0)
    fp.writeline("String 2", 20)
    fp.writeline("String 3")  # To write at the end of the file 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2018-11-02T18:43:45.887

如果你知道一些 unix，你可以尝试以下方法：

注：$ 表示命令提示符

假设您有一个 my_data.txt 文件，其内容如下：

```
$ cat my_data.txt
This is a data file
with all of my data in it. 
```

然后使用该`os`模块，您可以使用常用`sed`命令

```
import os

# Identifiers used are:
my_data_file = "my_data.txt"
command = "sed -i 's/all/none/' my_data.txt"

# Execute the command
os.system(command) 
```

如果您不了解 sed，请查看它，它非常有用。

# .net - 如何以编程方式操作任何 Windows 应用程序的常用对话框？

> ID：125710
> 
> 赞同：5
> 
> 时间：2008-09-24T06:33:57.097
> 
> 标签：.net, filedialog

我的最终目标是编写一个实用程序，让我可以在*任何*对话框中快速设置文件夹，从预设的“收藏夹”列表中进行选择。由于我只是一个业余爱好者，而不是专业人士，我更喜欢使用 .NET，因为这是我最了解的。我确实意识到其中一些东西可能需要比我在 C# 中做的更多的东西。

[我已经看到一些应用程序能够通过向工具栏添加按钮（例如： Dialog Box Assistant](http://www.win-utilities.com/dba/index.html)）或通过在标题栏旁边的标题栏中放置额外的按钮来扩展通用对话框（特别是另存为..和文件打开）最小化、最大化和/或关闭按钮。尽管我不知道从哪里开始，但两者都是不错的选择。

我尝试过的一种方法是将文件夹名称从我写的应用程序中“拖动”到对话框上的文件名文本框中，使用我从 Corneliu Tusnea 的[Hawkeye Runtime Object Editor](http://readify.net/tech-zone/tech-tools/hawkeye-the-net-runtime-object-editor/Default.aspx)中获得的鼠标钩子技术突出显示它，然后预先添加通过使用 WM_SETTEXT 调用 SendMessage 来获取路径名。它（有点）有效，但感觉有点笨拙。

对此技术或实施的任何建议将不胜感激。或者，如果现有的实用程序已经这样做了，请告诉我！

**更新**：当一切都说完了，我想我可能会得到一个现有的实用程序。但是，我想知道是否有*办法*以编程方式执行此操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T06:38:58.753

对我来说，这听起来像是[AutoHotkey](http://www.autohotkey.com)的工作。

我是一个“专业人士”（至少我通过编程获得报酬），但我会首先考虑使用 AutoHotkeys 的许多经过良好测试的功能来访问窗口，而不是深入研究 C#/.NET 并且最喜欢通过 PInvoke 的 WinAPI。

AutoHotkey 甚至提供了一些基本的用户界面控件并且是免费的。

这是一个与您要求的非常相似的[AutoHotkey 脚本。](http://www.autohotkey.com/docs/scripts/FavoriteFolders.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T14:11:09.773

对于这样的事情，您可能会沉迷于 Win32 API 调用。在 .Net 上工作意味着进行大量的 pinvokes。恐怕我帮不了你太多，但我记得有一本书叫做[“用 Visual Basic 进行子类化和挂钩”](http://oreilly.com/catalog/9780596001186/)可能会有所帮助。它主要是为 VB 6 编写的，但我相信其中包含一些 VB.Net 内容。

此外，[PInvoke.Net](http://www.pinvoke.net)是一个包含许多 pinvoke 签名的 wiki，您可以复制和粘贴这些签名，这可能会有所帮助。

归根结底，您可能需要更多地了解 Windows 如何在内部运行（消息传递等）以实现您的目标。

Spy++ 也可能是你的朋友。

# project-management - 项目转让

> ID：125711
> 
> 赞同：3
> 
> 时间：2008-09-24T06:34:05.397
> 
> 标签：project-management

当你需要接管别人的软件项目时，我想知道你的经验——尤其是当最初的软件开发人员已经辞职时。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T06:37:39.163

我们在这方面取得的最大成功就是“维基”所有内容。在通知期间，请离开的开发人员帮助您记录团队/公司 wiki 中的所有内容，看看您是否可以与他/她一起进行代码审查，并在进行解释部分的审查时向代码添加注释。最适合“接管”的开发者在离开者的监督下写代码中的注释。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T07:08:12.833

原始开发人员在移交项目之前离开的情况总是最有趣的：您被困在未知状态的代码库中。我总是觉得有趣的是，新开发人员经常尽最大努力评论代码设计的糟糕程度：他们忘记了旧开发人员可能受到的约束，他们可能被迫做出的捷径。谚语总是*Old dev == bad dev*。你们怎么看：我什至认为这是一种官方的坏习惯：对我们之前的人说坏话。

我尝试尽可能多地采取务实的方法：学习代码库，四处逛逛。尝试理解需求和代码之间的关系，甚至根本没有明确的初始关系。当你意识到他们为什么以这种或那种方式做某事时，总会有“啊哈时刻”。如果您仍然确信某些事情是以错误的方式实现的，请尽可能进行重构。并隔离您无法更改的代码片段：使用模拟框架对它们进行单元测试。

向维护开发人员致敬。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T10:35:47.327

我曾经加入过一个团队，该团队被外包给了一堆热气腾腾的废话。最初的项目 - 基于 Java、Struts、Hibernate|Oracle 的多媒体内容管理器 - 结构良好（似乎是几个人的工作，结对编程，明智地使用设计模式，一些单元测试）。然后其他人继承了该项目并无休止地复制粘贴功能，放松业务规则，修补，分支，直到它变成一个巨大的意大利面条怪物，其中包含精心制作的代码，例如：

```
List<Stuff> stuff = null; 
if (LOG.isDebugEnabled())
{
    stuff = findStuff();
    LOG.debug("Yeah, I'm a smart guy!");
    for (Stuff stu : stuff)
    {
        LOG.debug("I've got this stuff: " + stu);
    }
} 
methodThatUsesStuff(stuff); 
```

隐藏在其他辉煌的独创性之中。

我通过耐心的重构（多次提取方法和类）驯服了这头野兽，不时地评论代码，重新组织所有内容，直到代码库缩小 30%，随着时间的推移变得越来越易于​​管理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-29T14:50:21.407

我不得不多次接管别人的不同质量的代码。因此提示：

*   努力从第一分钟开始对任何重要信息进行结构化记录：利益相关者的姓名、业务规则、代码和文档位置等。最好专门使用一个新的螺旋笔记本，这样你可以在必要时撕掉页面。

*   使用市场上更好的免费索引和桌面搜索工具之一（Google 桌面搜索、MS Windows 搜索都可以）。将所有文档、电子邮件、代码位置添加到其中。

*   在开发任何东西之前进行文档分析：找到所有可以在网络上以电子方式获得的东西并打印出文档，努力简单地阅读它。即使在未完成的草稿中，也有许多有用的信息。

*   随心所欲地对代码、架构等进行思维导图。

*   由于记录和维护较少的系统，您不可避免地会感到绝望，这可能会使您陷入拖延模式。尤其是在你的第一天或第一周，你的大脑必须消化大量的新信息。在这些时候，很高兴有人提醒你（或自己做）放轻松，首先专注于重要的事情，然后重新采取更小的步骤来试图获得理解，而不是试图向前飞跃。

*   不断记笔记、制作图表、绘制丰富的图片、思维导图。它确实有助于消化大量的新信息，这些信息大多是杂乱无章的。

嘿，祝你好运！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T06:56:09.883

我们实际上有一组指定的“可交付成果”，我们必须在场才能接管一个项目。

如果我们有机会，我们首先会尝试在开发项目的团队中推动我们的一个人。这样我们就可以在我们的团队接管代码之前获得一些第一手的知识。（在@Guy 写的那一行）

话虽如此，对我来说最重要的部分是：

*   某种代码的高级概述（绘图？）。
*   轻松访问向实际编写代码的人提问

这对我来说是接管代码和项目时的阿尔法欧米茄

# c# - DataGridView 编辑列名

> ID：125719
> 
> 赞同：11
> 
> 时间：2008-09-24T06:38:56.350
> 
> 标签：c#, datagridview, names, columnname

有没有办法在 DataGridView 中编辑列名？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2008-09-24T06:59:53.023

您还可以使用以下方法更改列名：

```
myDataGrid.Columns[0].HeaderText = "My Header" 
```

但是`myDataGrid`will 需要绑定到一个`DataSource`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-27T13:23:55.653

您可以直接编辑标题：

```
dataGridView1.Columns[0].HeaderCell.Value = "Created";
dataGridView1.Columns[1].HeaderCell.Value = "Name"; 
```

依此类推，你有多少列。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2011-09-20T15:19:39.793

@Dested 如果您从 DataReader 填充 DataGrid，您可以更改查询中的列名称

例如

```
select ID as "Customer ID", CstNm as "First Name", CstLstNm as "Last Name"
from Customers 
```

这样，在您的数据网格中，您将看到客户 ID 而不是 ID 等等。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2008-09-24T06:43:11.613

我认为不编写自定义代码就没有办法做到这一点。我将实现一个 ColumnHeaderDoubleClick 事件处理程序，并在列标题的顶部创建一个 TextBox 控件。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-24T06:45:47.550

我猜你想要的是编辑列的 HeaderText 属性：

```
myDataGrid.TableStyles[0].GridColumnStyles[0].HeaderText = "My Header" 
```

**来源**：[http ://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=186908&SiteID=1](http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=186908&SiteID=1)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-24T06:56:49.320

您也可以在不知道上面发布的任何内容的情况下直接编辑：

```
protected void gvCSMeasureCompare_RowDataBound(object sender, GridViewRowEventArgs e)
{
    if (e.Row.RowType == DataControlRowType.Header)
        e.Row.Cells[0].Text = "New Header for Column 1";
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2014-06-02T04:54:11.203

试试这个

```
myDataGrid.Columns[0].HeaderText = "My Header"
myDataGrid.Bind() ; 
```

# com - IDL 枚举未显示在类型库中

> ID：125725
> 
> 赞同：7
> 
> 时间：2008-09-24T06:42:45.873
> 
> 标签：com, idl

我有一个使用 MS ATL 库编写的 COM 对象。我在 IDL 中声明了一堆枚举，但在使用 MS COM 对象查看器工具查看类型库时它们不会出现。问题似乎是缺少的枚举实际上并没有被任何 COM 方法用作参数 - 我怎样才能强制这些枚举出现？

例如，在 IDL 中：

```
// Used by Foo method, so appears in the type library
typedef enum FOO
{
    FOO_1,
    FOO_2,
} FOO;

// Not used by any method, so won't appear in the type library
typedef enum BAR
{
    BAR_1,
    BAR_2,
} BAR;

[id(1)] HRESULT Foo([in] FOO eFoo); 
```

即使有问题的枚举没有被任何方法直接使用，它们仍然对使用该对象的任何人有用，但我无法让它们导出。

有没有人见过这个？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-09-24T06:54:37.873

你把它们放在`library`IDL 的部分了吗？只有本`library`节中提到的类型才会进入 TLB。

```
library MyLib {
    // ...
    enum BAR; 
```

# php - 交互式 SVG - 学习资源？

> ID：125726
> 
> 赞同：5
> 
> 时间：2008-09-24T06:42:46.107
> 
> 标签：php, mysql, svg, vector-graphics, php-gtk

有没有人学习如何使用 php/mysql（可能还有 php-gtk）实现 SVG 的资源？我正在考虑制作一个自上而下的花园设计师，使用拖放预定义元素（如树木/灌木）和可定义的种植区域（圆形/正方形）。然后，园丁可以随着时间的推移跟踪某个区域的种植效果。

我真的不想进入flash...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T06:53:14.273

我正在寻找类似的解决方案，这里的两个相关问题是[Scripting SVG](https://stackoverflow.com/questions/33347/scripting-svg)和[Displaying vector graphics in a browser](https://stackoverflow.com/questions/9615/displaying-vector-graphics-in-a-browser)。

但是，它们都没有带来太大希望，因为每个浏览器都有不同的矢量功能。 [Dojox.gfx](http://dojotoolkit.org/book/dojo-book-0-9/part-3-programmatic-dijit-and-dojo/drawing-gfx)似乎是一个跨浏览器的 javascript 图形库，它可以完成您需要的一切，但它不一定在 SVG 中完成。Canvas 获得了很多支持和兴趣。

-亚当

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T10:04:58.930

这是我在其他问题中发现的，但不确定。

[拉斐尔](http://raphaeljs.com/index.html)

这是一个用于处理 svg 的 JavaScript 库。
有一个[例子](http://raphaeljs.com/github/dots.html)，但是尝试使用[browsershots](http://browsershots.org/)看看你是否真的对浏览器的支持感到满意（例如 IE 没有原生 svg 支持）。

我个人决定不使用 svg，而是实施图像 + js 解决方案，因为我认为现在对 svg 的支持不够。

# ruby-on-rails - 为什么在使用 mongrel_rails 启动 ruby on rails 应用程序时出现错误

> ID：125730
> 
> 赞同：1
> 
> 时间：2008-09-24T06:44:49.940
> 
> 标签：ruby-on-rails, ruby, mongrel

为什么在尝试使用 ruby​​ on rails 应用程序启动时会出现以下错误

```
mongrel_rails 开始
```

?

```

C:\RailsTest\cookbook2>mongrel_rails 开始
** 警告：Win32 不支持守护程序模式。
** 守护进程，所有打开的文件都被关闭。查看 log/mongrel.pid 和 log/mongr
el.log 获取信息。
** 在 0.0.0.0:3000 开始 Mongrel 监听
c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/../lib/mongrel/t
cphack.rb:12:in `initialize_without_backlog': 每个套接字地址只有一次使用
ess（协议/网络地址/端口）通常是允许的。- 绑定(2) (Errno::EAD
饮用）
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/../
lib/mongrel/tcphack.rb:12:在“初始化”中
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/../
lib/mongrel.rb:93:在“新”中
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/../
lib/mongrel.rb:93:在“初始化”中
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/../
lib/mongrel/configurator.rb:139:in `new'
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/../
lib/mongrel/configurator.rb:139:in `listener'
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/mon
grel_rails:99:in `cloaker_'
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/../
lib/mongrel/configurator.rb:50:in `call'
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/../
lib/mongrel/configurator.rb:50:in `initialize'
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/mon
grel_rails:84:在“新”中
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/mon
grel_rails:84:在“运行”中
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/../
lib/mongrel/command.rb:212:在“运行”中
        来自 c:/ruby/lib/ruby/gems/1.8/gems/mongrel-1.1.5-x86-mswin32-60/bin/mon
grel_rails:281
        来自 c:/ruby/bin/mongrel_rails:19:in `load'
        来自 c:/ruby/bin/mongrel_rails:19

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T06:54:12.227

我自己不在 Windows 上使用 mongrel，但我猜这个错误相当于 Linux 的“使用中的端口”错误。您是否尝试将服务器绑定到其他已经在侦听的端口？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T12:18:48.000

您已经有一个进程正在侦听端口 3000（mongrel 的默认端口）。

尝试：

```
mongrel_rails start -p 3001 
```

看看你是否得到类似的错误。

如果您尝试安装多个 Rails 应用程序，则需要将每个 mongrel 分配到一个单独的端口并相应地编辑您的 apache conf。

如果您不想这样做，那么杀死所有杂种的最直接方法是打开 Windows 任务管理器并杀死所有“红宝石”进程。

请注意，如果您将 mongrel 安装为自动启动的服务

```
mongrel_rails install::service ... 
```

...红宝石进程将自动重新生成。在这种情况下，您必须通过 Windows 服务面板编辑进程属性。如果您需要更多信息，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-08-19T18:47:08.513

在 Windows 上，我找到了两种可能的方法来解决这个问题：

1.  解决方法：在另一个端口启动 mongrel Web 服务器
2.  解决方法：在任务管理器中找到ruby.exe进程并完成

# javascript - JavaScript cookie 的误解

> ID：125735
> 
> 赞同：0
> 
> 时间：2008-09-24T06:47:10.183
> 
> 标签：javascript, cookies

我正在使用以下代码设置/获取删除 cookie：

```
function get_cookie(cookie_name)
{
    var results = document.cookie.match('(^|;) ?' + cookie_name + '=([^;]*)(;|$)');

    if (results)
        return ( decodeURI(results[2]) );
    else
        return null;
}

function set_cookie(name, value, exp_y, exp_m, exp_d, path, domain, secure)
{
    var cookie_string = name + "=" + encodeURI(value);

    if (exp_y)
    {
        var expires = new Date(exp_y, exp_m, exp_d);
        cookie_string += "; expires=" + expires.toGMTString();
    }

    if (path)
        cookie_string += "; path=" + encodeURI(path);

    if (domain)
        cookie_string += "; domain=" + encodeURI(domain);

    if (secure)
        cookie_string += "; secure";

    document.cookie = cookie_string;
}

function delete_cookie(cookie_name)
{
    var cookie_date = new Date();  // current date & time
    cookie_date.setTime(cookie_date.getTime() - 1);
    document.cookie = cookie_name += "=; expires=" + cookie_date.toGMTString();
} 
```

但我得到的结果不一致。例如，在起始页 (www.example.com/start) 上设置的 cookie 不会总是显示在后续页面 (www.example.com/foo/thing.jsp) 上。我正在使用设置页面的 cookie“onUnload”

```
set_cookie("beginrequest", (new Date()).getTime(), null, null, null, "/"); 
```

并通过“onLoad”检索+删除它

```
loadDur = (new Date()).getTime() - get_cookie("beginrequest");
delete_cookie("beginrequest"); 
```

测量页面加载所花费的总时间。

使用萤火虫时，我经常看到“剩余的”beginrequest-cookies 和多个带有过去时间戳的 beginrequest 实例。

我怎样才能在每个页面上只看到一个 beginrequest-cookie？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-10-15T11:06:47.403

回应对方的建议，在服务器端做一些工作——我过去做过：

1）在服务器端捕获请求的时间，并在页面中包含一个带有时间变量的脚本标签：

```
<script type="text/javascript"> var start = 1224068624230;</script> 
```

2) 在页面的最后，在 JavaScript 中，获取一个新的时间并计算总时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T09:47:46.567

如果您收到旧 cookie，可能是因为您的页面包含大量内容，并且在 onunload 之前未调用 onload（因为页面未完成加载）。因此，通过从 onload 和 onunload 中调用类似的内容来删除 cookie：

```
var deleted_cookie = false;
function delete_timestamp() {
    if(!deleted_cookie) delete_cookie("beginrequest");
    deleted_cookie = true;
} 
```

如果您加载下一页的速度足够快以至于 'delete_cookie' cookie 没有正确过期，并且您的 get_cookie 实现正在拾取它，您可能还会遇到竞争条件。因此，尝试更改 get_cookie 中的正则表达式以仅获取具有值的 cookie：

```
var results = document.cookie.match('(^|;) ?' + cookie_name + '=([^;]+)(;|$)'); 
```

此外，如果您在多个窗口（或选项卡）中查看该网站，他们的 cookie 可能会混淆，所以不要这样做。但是尝试使用全局正则表达式来获取所有值，并且只使用最新的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T09:01:34.620

您的 set_cookie、get_cookie 和 delete_cookie 代码似乎是正确的。以及您的使用情况。

我认为你应该把它移到你的 Java 代码中——对我来说，这似乎比通过 cookie 破解它更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-10-08T04:55:20.710

我在这两个方面都同意 amix：您的代码乍一看还不错，这可能会更好地由服务器端的某些东西处理。

无论如何，猜测一下，我会说您目前遇到的问题很可能是事件没有按照您认为的方式触发。有两种方法可以清除正在发生的事情，一种是让事件在视觉上很明显正在触发，另一种是增加输出的详细程度。任何数量的东西都可能会干扰实际触发的事件：插件、插件、按键等。如果您在 onload 和 onunload 事件触发时打开一个新窗口（或警报或其他），您将能够告诉确定正在调用这些函数。同样，如果您在 cookie 中存储更多数据，例如原始 URL 等，您将能够更好地确定哪些页面正在生成额外的 cookie。

我猜您的 Firefox 扩展之一间歇性地干扰 onunload 事件。

# language-agnostic - 摆脱低级锁定的技术

> ID：125743
> 
> 赞同：3
> 
> 时间：2008-09-24T06:52:03.853
> 
> 标签：language-agnostic, design-patterns, locking

我想知道并且需要可用于减少低级锁定的策略。然而，这里的问题是这不是服务器应用程序的新代码（具有数万行 C++ 代码），所以我不能只重写整个事情。

我担心现在可能无法解决这个问题（为时已晚）。但是，我想听听其他人使用过的好模式。

现在有太多的锁，没有那么多的冲突，所以这是一个偏执引起的硬件性能问题。描述代码的最佳方式是单线程代码突然充满了锁。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T12:33:49.413

为什么需要消除低级锁定？你有死锁问题吗？你有性能问题吗？还是缩放问题？锁通常是争用的还是非争用的？

你用的是什么环境？例如，C++ 中的答案与 Java 中的答案不同。例如，Java 6 中的非竞争同步块实际上在性能方面相对便宜，因此只需升级您的 JRE 可能会让您解决任何您试图解决的问题。通过切换到不同的编译器或锁定库，C++ 中可能会有类似的性能提升。

一般来说，有几种策略可以让您减少获得的互斥锁数量。

首先，任何只能从单个线程访问的东西都不需要互斥体。

其次，任何不可变的东西都是安全的，只要它是“安全发布的”（即以这样一种方式创建，即部分构造的对象对另一个线程永远不可见）。

第三，现在大多数平台都支持原子写入——当需要保护一个原始类型（包括指针）时，这会有所帮助。这些工作与数据库中的乐观锁定非常相似。您还可以使用原子写入来创建无锁算法来替换更复杂的类型，包括 Map 实现。然而，除非你非常非常优秀，否则最好借用别人的调试实现（java.util.concurrent 包包含很多很好的例子）——众所周知，在编写自己的算法时很容易意外引入错误。

第四，扩大互斥锁的范围会有所帮助——要么简单地保持打开互斥锁的时间更长，而不是不断地锁定和解锁它，要么锁定一个“更大”的项目——对象而不是它的一个属性，例如. 但是，这必须非常小心；您可以通过这种方式轻松引入问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T07:06:04.100

程序的线程模型必须在编写一行之前确定。任何模块，如果与程序的其余部分不一致，都可能导致应用程序崩溃、死锁损坏。

如果您有机会重新开始，请尝试确定程序中可以并行完成的大型功能，并使用线程池来安排任务。提高效率的诀窍是尽可能避免互斥体，并（重新）对您的应用程序进行编码，以避免高级别资源争用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T15:31:23.747

当您寻找在没有显式锁的情况下以原子方式更新共享状态的方法时，您可能会在[此处](https://stackoverflow.com/questions/92455/how-can-i-write-a-lock-free-structure)和[此处](https://stackoverflow.com/questions/120937/what-is-test-and-set-used-for#120976)找到一些答案。

# c# - 在 EPiServer 中设置默认语言？

> ID：125756
> 
> 赞同：1
> 
> 时间：2008-09-24T06:56:14.077
> 
> 标签：c#, .net, episerver

我正在寻找一种方法来为首次访问在 EPiServer 中构建的站点的访问者设置默认语言。不仅是后端的管理员/编辑，还有访问公共站点的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T10:05:06.993

取决于你的设置。

如果要在不同域下更改站点语言，您可以这样做。添加到 web.config 中的配置 -> configSections 节点：

```
<sectionGroup name="episerver">
  <section name="domainLanguageMappings" allowDefinition="MachineToApplication" allowLocation="false" type="EPiServer.Util.DomainLanguageConfigurationHandler,EPiServer" /> 
```

..并将其添加到 web.config 中的 episerver 节点：

```
 <domainLanguageMappings>
    <map domain="site.com" language="EN" />
    <map domain="site.se" language="SV" />
  </domainLanguageMappings> 
```

否则你可以做这样的事情。添加到 web.config 中的 appSettings：

```
<add name="EPsDefaultLanguageBranch" key="EN"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T10:11:22.080

我在 EPiServer CMS5 上有这个：

```
<globalization culture="sv-SE" uiCulture="sv" requestEncoding="utf-8" responseEncoding="utf-8" resourceProviderFactoryType="EPiServer.Resources.XmlResourceProviderFactory, EPiServer" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-17T22:27:48.687

在 EPiServer CMS 5 中，将以下设置添加到您的 web.config：

```
<site description="Example Site">
    <siteHosts>
         <add name="www.site.se" language="sv" />
         <add name="www.site.no" language="no" />
         <add name="www.site.co.uk" language="en-GB" />
         <add name="*" />
    </siteHosts> 
```

为起始页选择的语言取决于请求中的主机标头。

如果您`pageUseBrowserLanguagePreferences="true"`在 web.config 中的 siteSettings 标记中设置属性，则浏览器请求可用于选择起始页的语言。

# excel - Excel VBA的密码哈希函数

> ID：125785
> 
> 赞同：39
> 
> 时间：2008-09-24T07:13:05.927
> 
> 标签：excel, vba, hash, sha1

我需要一个用 Excel VBA 编写的函数，该函数将使用 SHA-1 等标准算法对密码进行哈希处理。具有简单界面的东西，例如：

```
Public Function CreateHash(Value As String) As String
...
End Function 
```

该功能需要在安装了 Excel 2003 的 XP 工作站上运行，否则不得使用第三方组件。它可以引用和使用 XP 提供的 DLL，例如 CryptoAPI。

有谁知道实现此散列功能的示例？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-27T02:29:32.813

这是一个用于计算 SHA1 哈希的模块，可用于 Excel 公式，例如。'=SHA1HASH（“测试”）'。要使用它，请创建一个名为“module_sha1”的新模块并将其全部复制并粘贴到其中。这是基于[http://vb.wikia.com/wiki/SHA-1.bas](http://vb.wikia.com/wiki/SHA-1.bas)中的一些 VBA 代码，并进行了更改以支持将它传递给一个字符串，并且可以从 Excel 单元格中的公式执行。

```
' Based on: http://vb.wikia.com/wiki/SHA-1.bas
Option Explicit

Private Type FourBytes
    A As Byte
    B As Byte
    C As Byte
    D As Byte
End Type
Private Type OneLong
    L As Long
End Type

Function HexDefaultSHA1(Message() As Byte) As String
 Dim H1 As Long, H2 As Long, H3 As Long, H4 As Long, H5 As Long
 DefaultSHA1 Message, H1, H2, H3, H4, H5
 HexDefaultSHA1 = DecToHex5(H1, H2, H3, H4, H5)
End Function

Function HexSHA1(Message() As Byte, ByVal Key1 As Long, ByVal Key2 As Long, ByVal Key3 As Long, ByVal Key4 As Long) As String
 Dim H1 As Long, H2 As Long, H3 As Long, H4 As Long, H5 As Long
 xSHA1 Message, Key1, Key2, Key3, Key4, H1, H2, H3, H4, H5
 HexSHA1 = DecToHex5(H1, H2, H3, H4, H5)
End Function

Sub DefaultSHA1(Message() As Byte, H1 As Long, H2 As Long, H3 As Long, H4 As Long, H5 As Long)
 xSHA1 Message, &H5A827999, &H6ED9EBA1, &H8F1BBCDC, &HCA62C1D6, H1, H2, H3, H4, H5
End Sub

Sub xSHA1(Message() As Byte, ByVal Key1 As Long, ByVal Key2 As Long, ByVal Key3 As Long, ByVal Key4 As Long, H1 As Long, H2 As Long, H3 As Long, H4 As Long, H5 As Long)
 'CA62C1D68F1BBCDC6ED9EBA15A827999 + "abc" = "A9993E36 4706816A BA3E2571 7850C26C 9CD0D89D"
 '"abc" = "A9993E36 4706816A BA3E2571 7850C26C 9CD0D89D"

 Dim U As Long, P As Long
 Dim FB As FourBytes, OL As OneLong
 Dim i As Integer
 Dim W(80) As Long
 Dim A As Long, B As Long, C As Long, D As Long, E As Long
 Dim T As Long

 H1 = &H67452301: H2 = &HEFCDAB89: H3 = &H98BADCFE: H4 = &H10325476: H5 = &HC3D2E1F0

 U = UBound(Message) + 1: OL.L = U32ShiftLeft3(U): A = U \ &H20000000: LSet FB = OL 'U32ShiftRight29(U)

 ReDim Preserve Message(0 To (U + 8 And -64) + 63)
 Message(U) = 128

 U = UBound(Message)
 Message(U - 4) = A
 Message(U - 3) = FB.D
 Message(U - 2) = FB.C
 Message(U - 1) = FB.B
 Message(U) = FB.A

 While P < U
     For i = 0 To 15
         FB.D = Message(P)
         FB.C = Message(P + 1)
         FB.B = Message(P + 2)
         FB.A = Message(P + 3)
         LSet OL = FB
         W(i) = OL.L
         P = P + 4
     Next i

     For i = 16 To 79
         W(i) = U32RotateLeft1(W(i - 3) Xor W(i - 8) Xor W(i - 14) Xor W(i - 16))
     Next i

     A = H1: B = H2: C = H3: D = H4: E = H5

     For i = 0 To 19
         T = U32Add(U32Add(U32Add(U32Add(U32RotateLeft5(A), E), W(i)), Key1), ((B And C) Or ((Not B) And D)))
         E = D: D = C: C = U32RotateLeft30(B): B = A: A = T
     Next i
     For i = 20 To 39
         T = U32Add(U32Add(U32Add(U32Add(U32RotateLeft5(A), E), W(i)), Key2), (B Xor C Xor D))
         E = D: D = C: C = U32RotateLeft30(B): B = A: A = T
     Next i
     For i = 40 To 59
         T = U32Add(U32Add(U32Add(U32Add(U32RotateLeft5(A), E), W(i)), Key3), ((B And C) Or (B And D) Or (C And D)))
         E = D: D = C: C = U32RotateLeft30(B): B = A: A = T
     Next i
     For i = 60 To 79
         T = U32Add(U32Add(U32Add(U32Add(U32RotateLeft5(A), E), W(i)), Key4), (B Xor C Xor D))
         E = D: D = C: C = U32RotateLeft30(B): B = A: A = T
     Next i

     H1 = U32Add(H1, A): H2 = U32Add(H2, B): H3 = U32Add(H3, C): H4 = U32Add(H4, D): H5 = U32Add(H5, E)
 Wend
End Sub

Function U32Add(ByVal A As Long, ByVal B As Long) As Long
 If (A Xor B) < 0 Then
     U32Add = A + B
 Else
     U32Add = (A Xor &H80000000) + B Xor &H80000000
 End If
End Function

Function U32ShiftLeft3(ByVal A As Long) As Long
 U32ShiftLeft3 = (A And &HFFFFFFF) * 8
 If A And &H10000000 Then U32ShiftLeft3 = U32ShiftLeft3 Or &H80000000
End Function

Function U32ShiftRight29(ByVal A As Long) As Long
 U32ShiftRight29 = (A And &HE0000000) \ &H20000000 And 7
End Function

Function U32RotateLeft1(ByVal A As Long) As Long
 U32RotateLeft1 = (A And &H3FFFFFFF) * 2
 If A And &H40000000 Then U32RotateLeft1 = U32RotateLeft1 Or &H80000000
 If A And &H80000000 Then U32RotateLeft1 = U32RotateLeft1 Or 1
End Function
Function U32RotateLeft5(ByVal A As Long) As Long
 U32RotateLeft5 = (A And &H3FFFFFF) * 32 Or (A And &HF8000000) \ &H8000000 And 31
 If A And &H4000000 Then U32RotateLeft5 = U32RotateLeft5 Or &H80000000
End Function
Function U32RotateLeft30(ByVal A As Long) As Long
 U32RotateLeft30 = (A And 1) * &H40000000 Or (A And &HFFFC) \ 4 And &H3FFFFFFF
 If A And 2 Then U32RotateLeft30 = U32RotateLeft30 Or &H80000000
End Function

Function DecToHex5(ByVal H1 As Long, ByVal H2 As Long, ByVal H3 As Long, ByVal H4 As Long, ByVal H5 As Long) As String
 Dim H As String, L As Long
 DecToHex5 = "00000000 00000000 00000000 00000000 00000000"
 H = Hex(H1): L = Len(H): Mid(DecToHex5, 9 - L, L) = H
 H = Hex(H2): L = Len(H): Mid(DecToHex5, 18 - L, L) = H
 H = Hex(H3): L = Len(H): Mid(DecToHex5, 27 - L, L) = H
 H = Hex(H4): L = Len(H): Mid(DecToHex5, 36 - L, L) = H
 H = Hex(H5): L = Len(H): Mid(DecToHex5, 45 - L, L) = H
End Function

' Convert the string into bytes so we can use the above functions
' From Chris Hulbert: http://splinter.com.au/blog

Public Function SHA1HASH(str)
  Dim i As Integer
  Dim arr() As Byte
  ReDim arr(0 To Len(str) - 1) As Byte
  For i = 0 To Len(str) - 1
   arr(i) = Asc(Mid(str, i + 1, 1))
  Next i
  SHA1HASH = Replace(LCase(HexDefaultSHA1(arr)), " ", "")
End Function 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2018-06-28T16:23:05.413

如今，您可以利用 VBA 中的 .NET 库。以下内容在 Excel 2016 中适用于我。将哈希返回为大写十六进制。

```
Public Function SHA1(ByVal s As String) As String
    Dim Enc As Object, Prov As Object
    Dim Hash() As Byte, i As Integer

    Set Enc = CreateObject("System.Text.UTF8Encoding")
    Set Prov = CreateObject("System.Security.Cryptography.SHA1CryptoServiceProvider")

    Hash = Prov.ComputeHash_2(Enc.GetBytes_4(s))

    SHA1 = ""
    For i = LBound(Hash) To UBound(Hash)
        SHA1 = SHA1 & Hex(Hash(i) \ 16) & Hex(Hash(i) Mod 16)
    Next
End Function 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-03-26T05:24:06.813

这是插入到名为“module_md5”的 Excel 模块中的 MD5 代码：

```
 Private Const BITS_TO_A_BYTE = 8
    Private Const BYTES_TO_A_WORD = 4
    Private Const BITS_TO_A_WORD = 32

    Private m_lOnBits(30)
    Private m_l2Power(30)

    Sub SetUpArrays()
        m_lOnBits(0) = CLng(1)
        m_lOnBits(1) = CLng(3)
        m_lOnBits(2) = CLng(7)
        m_lOnBits(3) = CLng(15)
        m_lOnBits(4) = CLng(31)
        m_lOnBits(5) = CLng(63)
        m_lOnBits(6) = CLng(127)
        m_lOnBits(7) = CLng(255)
        m_lOnBits(8) = CLng(511)
        m_lOnBits(9) = CLng(1023)
        m_lOnBits(10) = CLng(2047)
        m_lOnBits(11) = CLng(4095)
        m_lOnBits(12) = CLng(8191)
        m_lOnBits(13) = CLng(16383)
        m_lOnBits(14) = CLng(32767)
        m_lOnBits(15) = CLng(65535)
        m_lOnBits(16) = CLng(131071)
        m_lOnBits(17) = CLng(262143)
        m_lOnBits(18) = CLng(524287)
        m_lOnBits(19) = CLng(1048575)
        m_lOnBits(20) = CLng(2097151)
        m_lOnBits(21) = CLng(4194303)
        m_lOnBits(22) = CLng(8388607)
        m_lOnBits(23) = CLng(16777215)
        m_lOnBits(24) = CLng(33554431)
        m_lOnBits(25) = CLng(67108863)
        m_lOnBits(26) = CLng(134217727)
        m_lOnBits(27) = CLng(268435455)
        m_lOnBits(28) = CLng(536870911)
        m_lOnBits(29) = CLng(1073741823)
        m_lOnBits(30) = CLng(2147483647)

        m_l2Power(0) = CLng(1)
        m_l2Power(1) = CLng(2)
        m_l2Power(2) = CLng(4)
        m_l2Power(3) = CLng(8)
        m_l2Power(4) = CLng(16)
        m_l2Power(5) = CLng(32)
        m_l2Power(6) = CLng(64)
        m_l2Power(7) = CLng(128)
        m_l2Power(8) = CLng(256)
        m_l2Power(9) = CLng(512)
        m_l2Power(10) = CLng(1024)
        m_l2Power(11) = CLng(2048)
        m_l2Power(12) = CLng(4096)
        m_l2Power(13) = CLng(8192)
        m_l2Power(14) = CLng(16384)
        m_l2Power(15) = CLng(32768)
        m_l2Power(16) = CLng(65536)
        m_l2Power(17) = CLng(131072)
        m_l2Power(18) = CLng(262144)
        m_l2Power(19) = CLng(524288)
        m_l2Power(20) = CLng(1048576)
        m_l2Power(21) = CLng(2097152)
        m_l2Power(22) = CLng(4194304)
        m_l2Power(23) = CLng(8388608)
        m_l2Power(24) = CLng(16777216)
        m_l2Power(25) = CLng(33554432)
        m_l2Power(26) = CLng(67108864)
        m_l2Power(27) = CLng(134217728)
        m_l2Power(28) = CLng(268435456)
        m_l2Power(29) = CLng(536870912)
        m_l2Power(30) = CLng(1073741824)
    End Sub

    Private Function LShift(lValue, iShiftBits)
        If iShiftBits = 0 Then
            LShift = lValue
            Exit Function
        ElseIf iShiftBits = 31 Then
            If lValue And 1 Then
                LShift = &H80000000
            Else
                LShift = 0
            End If
            Exit Function
        ElseIf iShiftBits < 0 Or iShiftBits > 31 Then
            Err.Raise 6
        End If

        If (lValue And m_l2Power(31 - iShiftBits)) Then
            LShift = ((lValue And m_lOnBits(31 - (iShiftBits + 1))) * m_l2Power(iShiftBits)) Or &H80000000
        Else
            LShift = ((lValue And m_lOnBits(31 - iShiftBits)) * m_l2Power(iShiftBits))
        End If
    End Function

    Private Function RShift(lValue, iShiftBits)
        If iShiftBits = 0 Then
            RShift = lValue
            Exit Function
        ElseIf iShiftBits = 31 Then
            If lValue And &H80000000 Then
                RShift = 1
            Else
                RShift = 0
            End If
            Exit Function
        ElseIf iShiftBits < 0 Or iShiftBits > 31 Then
            Err.Raise 6
        End If

        RShift = (lValue And &H7FFFFFFE) \ m_l2Power(iShiftBits)

        If (lValue And &H80000000) Then
            RShift = (RShift Or (&H40000000 \ m_l2Power(iShiftBits - 1)))
        End If
    End Function

    Private Function RotateLeft(lValue, iShiftBits)
        RotateLeft = LShift(lValue, iShiftBits) Or RShift(lValue, (32 - iShiftBits))
    End Function

    Private Function AddUnsigned(lX, lY)
        Dim lX4
        Dim lY4
        Dim lX8
        Dim lY8
        Dim lResult

        lX8 = lX And &H80000000
        lY8 = lY And &H80000000
        lX4 = lX And &H40000000
        lY4 = lY And &H40000000

        lResult = (lX And &H3FFFFFFF) + (lY And &H3FFFFFFF)

        If lX4 And lY4 Then
            lResult = lResult Xor &H80000000 Xor lX8 Xor lY8
        ElseIf lX4 Or lY4 Then
            If lResult And &H40000000 Then
                lResult = lResult Xor &HC0000000 Xor lX8 Xor lY8
            Else
                lResult = lResult Xor &H40000000 Xor lX8 Xor lY8
            End If
        Else
            lResult = lResult Xor lX8 Xor lY8
        End If

        AddUnsigned = lResult
    End Function

    Private Function F(x, y, z)
        F = (x And y) Or ((Not x) And z)
    End Function

    Private Function G(x, y, z)
        G = (x And z) Or (y And (Not z))
    End Function

    Private Function H(x, y, z)
        H = (x Xor y Xor z)
    End Function

    Private Function I(x, y, z)
        I = (y Xor (x Or (Not z)))
    End Function

    Private Sub FF(a, b, c, d, x, s, ac)
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(F(b, c, d), x), ac))
        a = RotateLeft(a, s)
        a = AddUnsigned(a, b)
    End Sub

    Private Sub GG(a, b, c, d, x, s, ac)
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(G(b, c, d), x), ac))
        a = RotateLeft(a, s)
        a = AddUnsigned(a, b)
    End Sub

    Private Sub HH(a, b, c, d, x, s, ac)
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(H(b, c, d), x), ac))
        a = RotateLeft(a, s)
        a = AddUnsigned(a, b)
    End Sub

    Private Sub II(a, b, c, d, x, s, ac)
        a = AddUnsigned(a, AddUnsigned(AddUnsigned(I(b, c, d), x), ac))
        a = RotateLeft(a, s)
        a = AddUnsigned(a, b)
    End Sub

    Private Function ConvertToWordArray(sMessage)
        Dim lMessageLength
        Dim lNumberOfWords
        Dim lWordArray()
        Dim lBytePosition
        Dim lByteCount
        Dim lWordCount

        Const MODULUS_BITS = 512
        Const CONGRUENT_BITS = 448

        lMessageLength = Len(sMessage)

        lNumberOfWords = (((lMessageLength + ((MODULUS_BITS - CONGRUENT_BITS) \ BITS_TO_A_BYTE)) \ (MODULUS_BITS \ BITS_TO_A_BYTE)) + 1) * (MODULUS_BITS \ BITS_TO_A_WORD)
        ReDim lWordArray(lNumberOfWords - 1)

        lBytePosition = 0
        lByteCount = 0
        Do Until lByteCount >= lMessageLength
            lWordCount = lByteCount \ BYTES_TO_A_WORD
            lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE
            lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(Asc(Mid(sMessage, lByteCount + 1, 1)), lBytePosition)
            lByteCount = lByteCount + 1
        Loop

        lWordCount = lByteCount \ BYTES_TO_A_WORD
        lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE

        lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(&H80, lBytePosition)

        lWordArray(lNumberOfWords - 2) = LShift(lMessageLength, 3)
        lWordArray(lNumberOfWords - 1) = RShift(lMessageLength, 29)

        ConvertToWordArray = lWordArray
    End Function

    Private Function WordToHex(lValue)
        Dim lByte
        Dim lCount

        For lCount = 0 To 3
            lByte = RShift(lValue, lCount * BITS_TO_A_BYTE) And m_lOnBits(BITS_TO_A_BYTE - 1)
            WordToHex = WordToHex & Right("0" & Hex(lByte), 2)
        Next
    End Function

    Public Function MD5(sMessage)

        module_md5.SetUpArrays

        Dim x
        Dim k
        Dim AA
        Dim BB
        Dim CC
        Dim DD
        Dim a
        Dim b
        Dim c
        Dim d

        Const S11 = 7
        Const S12 = 12
        Const S13 = 17
        Const S14 = 22
        Const S21 = 5
        Const S22 = 9
        Const S23 = 14
        Const S24 = 20
        Const S31 = 4
        Const S32 = 11
        Const S33 = 16
        Const S34 = 23
        Const S41 = 6
        Const S42 = 10
        Const S43 = 15
        Const S44 = 21

        x = ConvertToWordArray(sMessage)

        a = &H67452301
        b = &HEFCDAB89
        c = &H98BADCFE
        d = &H10325476

        For k = 0 To UBound(x) Step 16
            AA = a
            BB = b
            CC = c
            DD = d

            FF a, b, c, d, x(k + 0), S11, &HD76AA478
            FF d, a, b, c, x(k + 1), S12, &HE8C7B756
            FF c, d, a, b, x(k + 2), S13, &H242070DB
            FF b, c, d, a, x(k + 3), S14, &HC1BDCEEE
            FF a, b, c, d, x(k + 4), S11, &HF57C0FAF
            FF d, a, b, c, x(k + 5), S12, &H4787C62A
            FF c, d, a, b, x(k + 6), S13, &HA8304613
            FF b, c, d, a, x(k + 7), S14, &HFD469501
            FF a, b, c, d, x(k + 8), S11, &H698098D8
            FF d, a, b, c, x(k + 9), S12, &H8B44F7AF
            FF c, d, a, b, x(k + 10), S13, &HFFFF5BB1
            FF b, c, d, a, x(k + 11), S14, &H895CD7BE
            FF a, b, c, d, x(k + 12), S11, &H6B901122
            FF d, a, b, c, x(k + 13), S12, &HFD987193
            FF c, d, a, b, x(k + 14), S13, &HA679438E
            FF b, c, d, a, x(k + 15), S14, &H49B40821

            GG a, b, c, d, x(k + 1), S21, &HF61E2562
            GG d, a, b, c, x(k + 6), S22, &HC040B340
            GG c, d, a, b, x(k + 11), S23, &H265E5A51
            GG b, c, d, a, x(k + 0), S24, &HE9B6C7AA
            GG a, b, c, d, x(k + 5), S21, &HD62F105D
            GG d, a, b, c, x(k + 10), S22, &H2441453
            GG c, d, a, b, x(k + 15), S23, &HD8A1E681
            GG b, c, d, a, x(k + 4), S24, &HE7D3FBC8
            GG a, b, c, d, x(k + 9), S21, &H21E1CDE6
            GG d, a, b, c, x(k + 14), S22, &HC33707D6
            GG c, d, a, b, x(k + 3), S23, &HF4D50D87
            GG b, c, d, a, x(k + 8), S24, &H455A14ED
            GG a, b, c, d, x(k + 13), S21, &HA9E3E905
            GG d, a, b, c, x(k + 2), S22, &HFCEFA3F8
            GG c, d, a, b, x(k + 7), S23, &H676F02D9
            GG b, c, d, a, x(k + 12), S24, &H8D2A4C8A

            HH a, b, c, d, x(k + 5), S31, &HFFFA3942
            HH d, a, b, c, x(k + 8), S32, &H8771F681
            HH c, d, a, b, x(k + 11), S33, &H6D9D6122
            HH b, c, d, a, x(k + 14), S34, &HFDE5380C
            HH a, b, c, d, x(k + 1), S31, &HA4BEEA44
            HH d, a, b, c, x(k + 4), S32, &H4BDECFA9
            HH c, d, a, b, x(k + 7), S33, &HF6BB4B60
            HH b, c, d, a, x(k + 10), S34, &HBEBFBC70
            HH a, b, c, d, x(k + 13), S31, &H289B7EC6
            HH d, a, b, c, x(k + 0), S32, &HEAA127FA
            HH c, d, a, b, x(k + 3), S33, &HD4EF3085
            HH b, c, d, a, x(k + 6), S34, &H4881D05
            HH a, b, c, d, x(k + 9), S31, &HD9D4D039
            HH d, a, b, c, x(k + 12), S32, &HE6DB99E5
            HH c, d, a, b, x(k + 15), S33, &H1FA27CF8
            HH b, c, d, a, x(k + 2), S34, &HC4AC5665

            II a, b, c, d, x(k + 0), S41, &HF4292244
            II d, a, b, c, x(k + 7), S42, &H432AFF97
            II c, d, a, b, x(k + 14), S43, &HAB9423A7
            II b, c, d, a, x(k + 5), S44, &HFC93A039
            II a, b, c, d, x(k + 12), S41, &H655B59C3
            II d, a, b, c, x(k + 3), S42, &H8F0CCC92
            II c, d, a, b, x(k + 10), S43, &HFFEFF47D
            II b, c, d, a, x(k + 1), S44, &H85845DD1
            II a, b, c, d, x(k + 8), S41, &H6FA87E4F
            II d, a, b, c, x(k + 15), S42, &HFE2CE6E0
            II c, d, a, b, x(k + 6), S43, &HA3014314
            II b, c, d, a, x(k + 13), S44, &H4E0811A1
            II a, b, c, d, x(k + 4), S41, &HF7537E82
            II d, a, b, c, x(k + 11), S42, &HBD3AF235
            II c, d, a, b, x(k + 2), S43, &H2AD7D2BB
            II b, c, d, a, x(k + 9), S44, &HEB86D391

            a = AddUnsigned(a, AA)
            b = AddUnsigned(b, BB)
            c = AddUnsigned(c, CC)
            d = AddUnsigned(d, DD)
        Next

        MD5 = LCase(WordToHex(a) & WordToHex(b) & WordToHex(c) & WordToHex(d))
    End Function 
```

# c - .NET 开发人员*真的*应该花时间学习 C 以进行低级接触吗？

> ID：125791
> 
> 赞同：14
> 
> 时间：2008-09-24T07:15:21.350
> 
> 标签：c, clr, il

当 Joel Spolsky 和 ​​Jeff Atwood 在他们的播客中开始就程序员是否应该学习 C 产生分歧时，无论他们的行业和交付平台如何，它在开发人员社区内引发了一场相当爆炸性的辩论，今天可能仍在某些群体中肆虐。我一直在阅读一些程序员博主的文章，他们对此事的看法。**双方的论点当然很重要，但我没有发现从只专注于 .NET Framework**的开发人员的角度来看，这是一个独特的视角。几乎所有人都在评论一般程序员的观点。

我想达到什么目的？回想一下 Jeff Atwood 的观点，即处于如此高水平的开发人员将花费的大部分时间都花在学习*业务/领域*上，而不是学习满足这些领域需求的技术所需的一切。以我的工作经验，这是对许多工作生活的非常准确的描述。现在假设 .NET 开发人员可以花时间进行“课外”学习，*那*应该是 C 吗？

作为记录，我自己在学校就学过 C，我完全可以理解和欣赏支持者的推理。但是，仔细考虑之后，我个人认为 .NET 开发人员不应该直接研究 C。因为，我希望更多的开发人员花一些时间来学习 - **MSIL**和**CLR**。

也许我被一群不寻常的同事困住了，我不知道，但在我看来，很多人并没有*意识到*他们的 C# 或 VB 代码在 JIT 进入并使其成为原始机器之前首先在 IL 中编译代码。大多数人不了解 IL，并且对 CLR 如何*准确*处理他们编写的代码不感兴趣。通过 C#阅读 Jeffrey Richter 的**CLR**在很多方面都让我感到震惊。很高兴我读了它，尽管同事们认为它“水平太低”。我不是 IL 专家，但有了基础知识，我发现自己更容易理解他的文字，因为我已经熟悉了 IL 的堆栈行为。我发现自己在反汇编程序集，以查看当我编写某些代码时 IL 的结果。

我学习 CLR 和 MSIL 因为我知道那是*我下面*的直接层。允许我执行自己的工作的层。C，实际上是进一步下降。更接近我们“现实”的是CLR和MSIL。这就是为什么我会建议其他人尝试这些，因为我没有看到足够多的人深入研究这一层。或者，您的团队是否已经全部熟悉 MSIL？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2008-09-24T07:19:31.307

你当然应该。变得过度专业化和专心致志（并且相应地，具有有限的适销技能）的最好方法是只使用一种类型的语言并避开所有其他“与您当前的任务无关”的语言。

每个程序员都应该对现代 JIT 的 OO 语言（C#/Java）、较低级别的简单语言（C、FORTRAN 等）、非常高级的解释语言（Python、Ruby 等）和函数式语言（Scheme、Lisp、Haskell 等）。即使您不每天都使用它们，这些知识所赋予的拓宽您的思维过程也是非常有用的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-24T07:50:26.240

我已经知道 C，这在 1.1 天帮助了我，在 .NET 基础库中还没有很多东西，我必须从 Platform SDK 中 P/Invoke 一些东西。

我的看法是，我们应该总是分配时间来学习我们还不知道的东西。为了回答你的问题，我认为学习 C 对你来说不是必须的，但如果你有空闲时间，C 是一种很好的学习语言，并且与其他任何语言一样有效。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-09-24T07:19:54.163

诚然，C 远低于链条。了解 MSIL 可以帮助开发人员了解如何更好地优化他们的应用程序。至于学习 C 或 MSIL，为什么不两者兼而有之？:)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-09-24T13:56:26.830

.NET 开发人员应该了解 CLR。但他们也应该学习 C。如果不了解裸机上发生的情况，我看不出任何人如何真正理解 CLR 的工作原理。

花时间学习更高层次的概念当然是有益的，但如果你过多地专注于高层而忽略了低层次，你就有可能成为那些可以在白板上画框和线的“架构师”之一但是谁无法编写任何实际代码。

你通过学习 C 所学到的东西将对你的职业生涯的剩余部分有用。随着微软改变他们的平台，你对 CLR 的了解将变得过时。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-09-24T07:25:31.713

我的看法是学习一些编译语言和汇编是**必须**的。否则，您将无法获得在语言和堆栈之间切换所需的多功能性。

更具体地说——我认为任何优秀/伟大的程序员都必须通过直接经验了解这些事情：

*   寄存器和变量有什​​么区别？
*   什么是 DMA？
*   如何将像素放在屏幕上（低电平）？
*   什么是中断？
*   ...

**了解这些事情是使用您了解**的系统和使用您所知道的通过魔术工作的系统之间的区别。:)

*解决一些评论*

您最终会拥有两种不同类型的开发人员：

*   可以用一种或两种语言以 10 种方式做一件事的人
*   可以用 10 种不同语言以一种或两种方式做一件事的人

我强烈认为第二组是整体上更好的开发人员。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-09-24T13:44:25.347

我是这样想的：

1.  程序员可能实际上应该使用适当的最高级别语言*工作*。什么是合适的取决于你的场景。设备驱动程序或嵌入式系统与 CRUD 桌面应用程序或网页属于不同的类。
2.  您希望您的程序员尽可能多地练习他们所使用的语言。
3.  由于大多数程序员最终都在使用通用桌面和 Web 应用程序，因此您希望编程学生在学校期间尽快进入更高级别的语言。
4.  然而，高级语言混淆了一些基本的编程问题，比如指针。如果我们也应用我们的使用适合学生的原则，那些高级语言可能不适合一年级学生。这抛出了 Java、.Net、Python 和许多其他语言。
5.  所以学生应该在学校的第一年或第二年使用 C（或者更好：C++，因为它是“更高级别”并且涵盖大部分相同的概念）来涵盖基本概念，但很快就会升级到更高级别的语言来学习更早地启用更困难的程序。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-11-04T19:30:33.160

为了在编写 C# 方面足够先进，您需要了解 C 中的概念，即使您没有正确学习该语言。

不过，更一般地说，如果您对**任何**技能都很认真，您应该知道在您的主要工作级别之下至少一个抽象级别发生了什么。

*   使用 jQuery 编码应该与对 JavaScript 的理解相结合
*   设计电路需要了解物理学
*   任何优秀的篮球运动员都会了解肌肉、骨骼和营养
*   小提琴手将了解松香、摩擦、弓毛、弦和木材干燥度的相互作用

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2008-09-24T07:28:24.453

我喜欢每年学习一门新语言。不一定要掌握它，而是强迫我的大脑以不同的方式思考。

我觉得学习 C 是一种很好的语言，可以学习低级概念，而无需在汇编中进行编码。

然而，我觉得从 Haskell、python 甚至可以说是正则表达式（不完全是一种语言，但你明白我的意思吗？）等语言中学习课程与从 C 中收集的课程一样重要。

所以我说，如果那是您所在的地区，请在工作中了解 CLR 和 MSIL，并在您的业余时间尝试每隔一段时间学习一次不同的语言。如果今年恰好是 C，对你有好处，喜欢玩指针；）

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2008-09-24T17:15:01.190

我看不出他们应该有什么理由。Java 和 C# 等语言的设计使您不必担心底层细节。这就像询问 WinForms 开发人员是否应该花时间学习 Win32 API 一样，因为这就是下面发生的事情。

虽然学习它并没有什么坏处，但您可能会从花更多时间学习您熟悉的语言和平台中获得更多收益，除非非常需要学习低级技术细节。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-09-24T07:24:53.027

学习 MSIL 并不是一个坏主意，但在某种程度上，它只是另一种 .NET 语言，但语法很糟糕。不过，它是另一层，我认为人们至少应该对所有层有一些模糊的理解。

C 有点像具有更好语法的汇编语言，是一种很好的方式来了解在相当低的级别上发生的事情（尽管有些事情仍然对你隐藏）。

另一方面，我认为每个人都应该了解一些类似 Haskell 或 Lisp 的知识，以了解更高级的东西（并以更简洁的形式看到 C# 3 中引入的一些想法）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-09-24T13:54:55.787

如果你认为自己是一名程序员，我会说是的，学习 C。

许多编写代码的人并不认为自己是程序员。我可能每天工作 3 个小时编写 .NET 应用程序，但我不给自己贴上“程序员”的标签。我做了很多与编程无关的事情。

如果你整天都在编程或思考编程，并且你打算让你的整个职业生涯都围绕着编程，那么你最好确保你知道你的东西。学习 C 可能有助于建立一个知识基础，如果您要深入了解编程技能，这将很有帮助。

对于任何事情，都有取舍。你学习的语言越多，你花在技术上的时间越多，你学习其他技能的时间就越少。例如，学习 C 或阅读有关项目管理的书籍会更好吗？这取决于你的目标。你想成为最好的程序员EVAR？学习 C。花费数小时编写代码并全身心投入到这门手艺中。你曾经想管理别人而不是整天编码吗？利用您将投入编程的时间并找到提高您的软技能的方法。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2008-09-24T17:05:25.737

.net 开发人员应该学习 C 吗？我会说“不一定”，但我们应该始终涉足我们专业范围之外的某种语言，因为每种语言都会带来一种思考问题的新方式。在我作为 .net（以及在此之前，VB 2-6）开发人员的职业生涯中，我用 Pascal、LISP、C、C++、PHP、JavaScript、Ruby 和 Python 编写了一些小项目，目前正在涉足 Lua 和珀尔。

除了 C++，我没有在我的简历中列出任何一个，因为我不想成为其中任何一个的专业人士。相反，我从他们每个人那里带回有趣的想法，用于我基于 .net 的工作中。

C 语言的有趣之处在于它确实让您接近操作系统，但这并不是成为一名优秀程序员所需了解的唯一级别。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2008-09-24T07:19:23.587

**CLR**是一个**虚拟**机，所以如果您只了解这些，那么您只知道在虚拟级别发生了什么。

就内存使用而言，学习**C**将教你更多关于**物理**机器的知识，正如你所提到的，这是 CLR 在下面使用的。学习 CLR 的工作原理不会像学习 C 那样让您对垃圾收集等方面有更多的了解。使用 C 语言，您会*真正*体会到内存管理所涉及的内容。

另一方面，学习**CIL比学习****C**更能告诉您在 .NET 中的执行。尽管如此，在很大程度上， **IL**如何映射到机器语言仍然是一个谜，因此了解一些高级操作码，比如用于转换类型的操作码，对于理解它们的实际情况并没有太大帮助。大部分是不透明的。然而，学习**C**和指针会在其中一些方面对您有所启发。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2008-09-24T17:27:15.293

问题是学习 C 还是 MSIL，还是更基础？我想说的是，一般来说，更多的开发人员可以更多地了解**计算机**（物理的或虚拟的）是如何工作的。一个人只需了解一种语言和 API 就可以成为一个相当称职的程序员。为了让这个职业更上一层楼，我觉得开发人员真的需要了解整个堆栈。不一定要详细，但要足够概括以帮助解决问题。

这里讨论的很多这些技能可以通过更多地了解编译器和语言设计来获得。您可能需要学习 C 才能做到这一点（哎呀，偷偷摸摸），但是编译器编写是学习 C 的绝佳环境。Steve Yegge在他的博客上[谈到了这一点](http://steve-yegge.blogspot.com/2007/06/rich-programmer-food.html)，我在这一点上基本同意他的观点。我在大学里的编译器写作课程是我上过的最让人大开眼界的课程之一，我真希望它是一门 200 级的课程，而不是 400 级的课程。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2008-09-24T18:07:40.953

我在另一个线程上发布了这个，但它适用于：

我相信你需要一个良好的基础，但将大部分时间花在学习你将使用的东西上。

*   学习足够的汇编程序将两个数字相加并在控制台上显示结果。您将对计算机实际发生的事情有更好的理解，并且我们为什么使用二进制/十六进制是有意义的。（这可以在一天内完成，并且可以通过[cmd.exe 进行调试](http://www.armory.com/~rstevew/Public/Tutor/Debug/debug1.htm)）。
*   学习足够多的 C 语言必须分配一些内存并使用指针。一个简单的[链表](http://www.friedspace.com/cprogramming/linkedlists.php)就足够了。（这可以在一两天内完成）。
*   花更多时间学习你将要使用的语言。我会让你的兴趣引导你进入哪种语言（C#、Java、Ruby、Python 等）。

# spring - 如何使用 Spring AOP（或 AspectJ）定义/配置多个方面的优先级

> ID：125794
> 
> 赞同：6
> 
> 时间：2008-09-24T07:16:21.457
> 
> 标签：spring, aop, spring-aop

我已经能够在业务服务类上使用 Spring AOP（结合 AspectJ 注释）定义多个方面（一个是 @Before，另一个是 @Around）。

目前，他们被一一（按顺序）调用。但是我想知道如何定义调用方面的优先级以及在哪里。

请就 Spring AOP 指导我。请注意，我使用的是 Spring 2.5.3 框架。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T08:37:40.513

我找到了这个问题的答案。

可以使用@Order 注释来指定特定Aspect 类（用@Aspect 注释的类）的顺序/顺序。

或者方面类可以实现 org.springframework.core.Ordered 接口，为 Spring 框架提供订单值。

# sharepoint - 如何在服务器上找到 Sharepoint 文档库源页面？

> ID：125805
> 
> 赞同：5
> 
> 时间：2008-09-24T07:19:36.190
> 
> 标签：sharepoint

我正在使用 Sharepoint 文档库，并且正在尝试查找文档库页面的源。我正在使用 Sharepoint 服务器。就是找不到，应该放在哪里？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T13:31:38.433

SharePoint 不会将页面直接存储在文件系统中。该机制有点不那么简单。

要理解这种机制，您必须了解 Ghosting/Unghhosting 和 ASP.NET Virtual Path Provider 的概念。SharePoint 将数据库中的页面存储为 BLOBS，并使用 ASP.NET 虚拟路径提供程序为它们提供服务。

ASP.NET 虚拟路径提供程序提供了 ASP.NET 和 FileSystem 之间的抽象。提供程序不是直接从文件系统获取 System.IO.FileStream 对象，而是使用 MapPathBasedVirtualPathProvider 和 MapPathBasedVirtualFile 类来获取 FileStream 对象。

这种抽象允许 ASP.NET 从任何地方提供页面，而不必将页面存储在实际的文件系统中。这个概念用于实现重影/非重影，这基本上意味着拥有一个页面副本，并将它们作为不同的页面提供服务。

SharePoint 利用 ASP.NET 2.0 中的这一新功能以及 SQL Server 2005 中改进的 BLOB 存储功能来提供页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-09-24T08:07:16.310

你的问题不是很清楚...

您是指文档库页面的“源”代码吗？这取决于您是否使用 SharePoint Designer 对其进行了编辑。如果不是，它们应该位于 12 hive 下（c:\program files\common files\microsoft shared\web server extensions\12）。如果使用 SPD2007 进行了任何修改，文件将存储在内容数据库中。

...还是您指的是存储文件的“源”？保存在文档库中的所有文件都作为 AllUserData 表中的 blob 存储在内容数据库中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T08:11:53.833

您的页面显示为“aspx”页面，它们不会作为 aspx 页面存储在服务器上的任何位置。所有页面要么作为 BLOB 存储在 DB 中，要么在运行时根据存储在 DB 中的信息“放在一起”。SharePoint 是一个奇怪的怪物 :)

如果要编辑外观，有几个选项：

*   SharePoint Designer（我讨厌这个应用程序）
*   制作另一个“Web 部件页面”，其中包含其中的文档库，同时更改其周围的内容（最简单和最好的方法 IMO）
*   制作一个专门的 Web 部件（最难）

SharePoint 需要一段时间才能完全掌握……这很奇怪。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T13:41:21.030

当您从“12 个配置单元”创建文档库模板文件时，它们会[幻影](https://web.archive.org/web/20090123213350/http://www.bluedoglimited.com:80/SharePointThoughts/ViewPost.aspx?ID=4)到 SharePoint 内容数据库 (SQL) 中。此时编辑这些页面的唯一正确方法是使用[Microsoft SharePoint Designer](https://web.archive.org/web/20100607203002/http://office.microsoft.com:80/en-us/sharepointdesigner/FX100487631033.aspx)。

打开 SharePoint Designer 并打开相关的 SharePoint 网站，您将在文件资源管理器中看到您的文档库。在您的文档库下，您将看到一个 Forms 文件夹，该 Forms 文件夹包含呈现给浏览器的源文件。

这是一个屏幕截图：

[![SharePoint 设计器](https://i.stack.imgur.com/2Sogr.jpg)](https://i.stack.imgur.com/2Sogr.jpg)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T08:38:26.657

如果我理解 Sacha 和 Naspinski 的意思，当我创建一个新的文档库时，页面的外观会从 12 个配置单元中检索并存储（幻影？）到数据库中。该页面不再存储在 12 个配置单元中，因为对于每个文档库，我将有一个以某种方式“自定义页面”。

真的吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-08-07T07:12:24.177

SharePoint2010中有两种页面类型。应用页面和网站页面。SharePoint直接在文件系统中存储应用页面。对于网站页面，如果页面处于幻影状态，则页面存储在文件系统中。如果页面有已定制，然后将文件存储在内容数据库中。

# c++ - 在 Linux 中捕获输入

> ID：125806
> 
> 赞同：5
> 
> 时间：2008-09-24T07:19:47.563
> 
> 标签：c++, linux

首先，是的，我知道[这个问题](https://stackoverflow.com/questions/50182/linuxx11-input-library-without-creating-a-window)，但我正在寻找更多信息。实际上，我有一个非常相似的问题，因为我需要能够捕获鼠标/键盘/操纵杆的输入，并且我还想尽可能避免使用 SDL。我或多或少想知道是否有人知道我在哪里可以获得一些关于在 Linux 中处理来自设备的输入的不错的入门书，甚至可能是一些教程。SDL 非常适合跨平台输入处理，但我根本不会使用 SDL 的任何其他东西，所以我想完全取消它。建议，评论和帮助都表示赞赏。谢谢！

为清楚起见进行编辑：

重点是捕捉游戏的鼠标运动、键盘按下/释放、鼠标点击和潜在的操纵杆处理。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T16:52:22.710

使用下面的链接查看函数 void kGUISystemX::Loop(void)

这是我在 Linux 上使用 X Windows 通过键盘和鼠标获取输入的主要循环。

[http://code.google.com/p/kgui/source/browse/trunk/kguilinux.cpp](http://code.google.com/p/kgui/source/browse/trunk/kguilinux.cpp)

这是一个片段：

```
 if(XPending(m_display))
    {
        XNextEvent(m_display, &m_e);
        switch(m_e.type)
        {
        case MotionNotify:
            m_mousex=m_e.xmotion.x;
            m_mousey=m_e.xmotion.y;
        break;
        case ButtonPress:
            switch(m_e.xbutton.button)
            {
            case Button1:
                m_mouseleft=true;
            break;
            case Button3:
                m_mouseright=true;
            break;
            case Button4:/* middle mouse wheel moved */
                m_mousewheel=1;
            break;
            case Button5:/* middle mouse wheel moved */
                m_mousewheel=-1;
            break;
            }
        break;
        case ButtonRelease:
            switch(m_e.xbutton.button)
            {
            case Button1:
                m_mouseleft=false;
            break;
            case Button3:
                m_mouseright=false;
            break;
            }
        break;
        case KeyPress:
        {
            XKeyEvent *ke;
            int ks;
            int key;

            ke=&m_e.xkey;
            kGUI::SetKeyShift((ke->state&ShiftMask)!=0);
            kGUI::SetKeyControl((ke->state&ControlMask)!=0);
            ks=XLookupKeysym(ke,(ke->state&ShiftMask)?1:0);
...... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T07:58:59.060

如果您知道您的项目只能在 Linux（而不是 Windows 甚至是其中一种 BSD）下运行，您应该查看 Linux 内核的输入系统。下载[内核源码](http://kernel.org/pub/linux/kernel/v2.6/linux-2.6.26.5.tar.bz2)并阅读`Documentation/input/input.txt`，特别是`evdev`系统描述。

对于更高级别（和更便携）的解决方案，[请阅读 Xlib](http://users.actcom.co.il/~choo/lupg/tutorials/xlib-programming/xlib-programming.html)。显然它需要一个正在运行的 X 服务器，但它的优点是继承了用户的键盘设置。不幸的是，不包括操纵杆事件，您可能需要为这些事件使用内核操纵杆 API。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T07:27:56.030

您可以从阅读[本教程](http://tldp.org/LDP/khg/HyperNews/get/devices/devices.html)表格开始，[即 Linux 文档项目](http://tldp.org/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T07:38:14.617

你没有说明你的应用程序的目的，但是从输入设备读取原始数据很少是你想要的，除非你只是为了好玩（或学校项目或其他）

如果您正在编写 GUI 应用程序（在 X11 图形环境中运行的应用程序），您可以依赖图形工具包（或原始 X）输入驱动程序。

如果您正在编写文本模式客户端，那么[readline](http://tiswww.case.edu/php/chet/readline/rltop.html)甚至[ncurses](http://en.wikipedia.org/wiki/Ncurses)可能是不错的选择。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-24T01:33:08.450

您可以从 /dev/input 中的文件获得直接输入。这是最简单的方法，您不需要任何额外的软件。

# c# - 在多线程工作队列处理器中管理线程池饥饿？

> ID：125812
> 
> 赞同：3
> 
> 时间：2008-09-24T07:22:40.787
> 
> 标签：c#, .net, multithreading

我正在研究工作队列处理器的设计，其中 QueueProcessor 从队列中检索命令模式对象并在新线程中执行它。

我试图解决一个潜在的队列锁定场景，其中嵌套命令可能导致死锁。

例如

FooCommand 对象被放置到队列中，然后 QueueProcessor 在其自己的线程中执行该对象。

正在执行的 FooCommand 将 BarCommand 放入队列中。

假设最大允许线程只有 1 个线程，QueueProcessor 将处于死锁状态，因为 FooCommand 无限等待 BarCommand 完成。

如何管理这种情况？队列对象是作业的正确对象吗？是否有任何制衡措施可以解决这个问题？

非常感谢。（应用程序使用 C# .NET 3.0）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T07:28:41.613

您可以重新设计一些东西，以便 FooCommand 不使用队列来运行 BarCommand 而是直接运行它，或者您可以将 FooCommand 分成两部分，并在排队 BarCommand 后立即停止前半部分，然后让 BarCommand 排队 FooCommand 的第二部分它完成了它的工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T07:29:19.490

排队隐含地假定了一个异步执行模型。通过等待命令退出，您正在同步工作。

也许您可以将命令分成三部分：FooCommand1 执行直到必须发送 BarCommand，BarCommand 最后是 FooCommand2，它在 BarCommand 完成后继续执行。这三个命令可以分别排队。当然，BarCommand 应该确保 FooCommand2 已排队。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T07:27:15.453

对于像这样的简单情况，可以按需分拆更多线程的附加监视线程很有帮助。

基本上每 N 秒检查一次是否有任何作业已完成，如果没有，则添加另一个线程。

这不一定会处理更复杂的死锁问题，但它会解决这个问题。

对于较重的问题，我的建议是将等待限制在新生成的进程，换句话说，您只能等待您启动的某些内容，这样您就永远不会遇到死锁，因为在这种情况下不可能出现循环。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T07:30:45.087

如果您自己构建 Queue 对象，您可以尝试以下方法：

1.  动态添加新的服务线程。如果可用线程计数为零太久，请使用计时器并添加线程。
2.  如果一个命令试图将另一个命令排队并等待结果，那么您应该在同一个线程中同步执行第二个命令。如果第一个线程只是等待第二个线程，那么无论如何您都不会获得并发优势。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T07:59:52.693

我假设您想对 BarCommand 进行排队，以便它能够与 FooCommand 并行运行，但 BarCommand 稍后将需要结果。如果是这种情况，那么我建议使用 Parallel Extensions 库中的 Future。

Bart DeSmet 对此有一篇[很好的博客文章](http://community.bartdesmet.net/blogs/bart/archive/2008/07/03/parallel-extensions-using-futures-to-calculate-pi-in-hexadecimal.aspx)。基本上你想做：

```
 public void FooCommand()
{
    Future<int> BarFuture = new Future<int>( () => BarCommand() );

    // Do Foo's Processing - Bar will (may) be running in parallel

    int barResult = BarFuture.Value;

    // More processing that needs barResult
} 
```

使用 Parallel Extensions 之类的库，我会避免“滚动你自己的”调度。

# javascript - 如何确定 JavaScript 中的操作系统路径分隔符？

> ID：125813
> 
> 赞同：99
> 
> 时间：2008-09-24T07:23:24.950
> 
> 标签：javascript, file, directory

如何在 JavaScript 中判断运行脚本的操作系统中使用了什么路径分隔符？

* * *

## 回答 #1

> 赞同：195
> 
> 时间：2013-02-23T00:25:45.910

使用[`path`](http://nodejs.org/docs/latest/api/path.html)module in`node.js`返回特定于平台的文件分隔符。
例子

```
path.sep  // on *nix evaluates to a string equal to "/" 
```

编辑：根据下面 Sebas 的评论，要使用它，您需要在 js 文件的顶部添加它：

```
const path = require('path') 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2008-09-24T07:26:28.733

公平地说，您始终可以使用 / 作为路径分隔符，即使在 Windows 上也是如此。

引自[http://bytes.com/forum/thread23123.html](http://bytes.com/forum/thread23123.html)：

> 因此，情况可以简单地概括为：
> 
> *   自 DOS 2.0 以来的所有 DOS 服务和所有 Windows API 都接受正斜杠或反斜杠。一直有。
>     
>     
> *   标准命令 shell（CMD 或 COMMAND）都不接受正斜杠。甚至上一篇文章中给出的“cd ./tmp”示例也失败了。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-02-06T20:41:57.080

# 正确答案

**是**的，无论您如何传入分隔符，所有操作系统都接受 CD ../ 或 CD ..\ 或 CD ..。但是，如何阅读一条回去的路。你怎么知道它是否说是“windows”路径，`' '`并且`\`允许。

# 明显的“呃！” 问题

例如，当您依赖于安装目录时会发生什么`%PROGRAM_FILES% (x86)\Notepad++`。举个例子。

```
var fs = require('fs');                             // file system module
var targetDir = 'C:\Program Files (x86)\Notepad++'; // target installer dir

// read all files in the directory
fs.readdir(targetDir, function(err, files) {

    if(!err){
        for(var i = 0; i < files.length; ++i){
            var currFile = files[i];

            console.log(currFile); 
            // ex output: 'C:\Program Files (x86)\Notepad++\notepad++.exe'

            // attempt to print the parent directory of currFile
            var fileDir = getDir(currFile);

            console.log(fileDir);  
            // output is empty string, ''...what!?
        }
    }
});

function getDir(filePath){
    if(filePath !== '' && filePath != null){

       // this will fail on Windows, and work on Others
       return filePath.substring(0, filePath.lastIndexOf('/') + 1);
    }
} 
```

### 发生了什么！？

`targetDir`被设置为索引之间的子字符串`0`，并且`0`( `indexOf('/')`is `-1`in `C:\Program Files\Notepad\Notepad++.exe`)，导致空字符串。

# 解决方案...

这包括以下帖子中的代码：[如何使用 Node.js 确定当前操作系统](https://stackoverflow.com/questions/8683895/how-do-i-determine-the-current-operating-system-with-node-js)

```
myGlobals = { isWin: false, isOsX:false, isNix:false }; 
```

操作系统的服务器端检测。

```
// this var could likely a global or available to all parts of your app
if(/^win/.test(process.platform))     { myGlobals.isWin=true; }
else if(process.platform === 'darwin'){ myGlobals.isOsX=true; }
else if(process.platform === 'linux') { myGlobals.isNix=true; } 
```

操作系统的浏览器端检测

```
var appVer = navigator.appVersion;
if      (appVer.indexOf("Win")!=-1)   myGlobals.isWin = true;
else if (appVer.indexOf("Mac")!=-1)   myGlobals.isOsX = true;
else if (appVer.indexOf("X11")!=-1)   myGlobals.isNix = true;
else if (appVer.indexOf("Linux")!=-1) myGlobals.isNix = true; 
```

获取分隔符的辅助函数

```
function getPathSeparator(){
    if(myGlobals.isWin){
        return '\\';
    }
    else if(myGlobals.isOsx  || myGlobals.isNix){
        return '/';
    }

    // default to *nix system.
    return '/';
}

// modifying our getDir method from above... 
```

获取父目录的辅助函数（跨平台）

```
function getDir(filePath){
    if(filePath !== '' && filePath != null){
       // this will fail on Windows, and work on Others
       return filePath.substring(0, filePath.lastIndexOf(getPathSeparator()) + 1);
    }
} 
```

`getDir()`必须足够聪明才能知道它在寻找哪个。

如果用户通过命令行输入路径等，您甚至可以变得非常光滑并检查两者。

```
// in the body of getDir() ...
var sepIndex = filePath.lastIndexOf('/');
if(sepIndex == -1){
    sepIndex = filePath.lastIndexOf('\\');
}

// include the trailing separator
return filePath.substring(0, sepIndex+1); 
```

如果你想加载一个模块来完成这个简单的任务，你也可以使用如上所述的“路径”模块和 path.sep。就个人而言，我认为只需检查您已经可用的流程中的信息就足够了。

```
var path = require('path');
var fileSep = path.sep;    // returns '\\' on windows, '/' on *nix 
```

## 这就是所有人！

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-12-10T16:11:29.740

正如这里已经回答的那样，您可以找到操作系统特定的路径分隔符`path.sep`来手动构建您的路径。但是您也可以让`path.join`工作，这是我在处理路径构造时首选的解决方案：

**例子：**

```
const path = require('path');

const directory = 'logs';
const file = 'data.json';

const path1 = `${directory}${path.sep}${file}`;
const path2 = path.join(directory, file);

console.log(path1); // Shows "logs\data.json" on Windows
console.log(path2); // Also shows "logs\data.json" on Windows 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2008-09-24T07:25:46.393

只需使用“/”，据我所知，它适用于所有操作系统。

# visual-studio-2008 - Windows CE 5.0 映像构建：没有 Platform Builder 可能吗？

> ID：125815
> 
> 赞同：1
> 
> 时间：2008-09-24T07:24:38.877
> 
> 标签：visual-studio-2008, visual-studio-2005, windows-ce, platform-builder

是否可以在不使用 Platform Builder 的情况下从 VS2005/VS2008 创建 Windows CE 5.0 映像（即：nk.bin）？如果是这样，怎么做？WinCE 5 的供应商 BSP 可以加载到 VS2005/2008 中吗？是否有可以从 Microsoft 下载的部件（即：SDK），或者您必须从“特殊经销商”购买特殊位（la PB）？

我知道可以使用 VS 为 WinCE 5.0 构建二进制文件（.dll、.exe），我的问题是为嵌入式平台创建整个可引导的 CE 5.0 映像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T07:32:02.637

不，不可能从 Visual Studio 构建实际的操作系统映像。

您可以从命令行构建它，而无需实际运行 Platform Builder IDE，但您仍然需要安装它。

简单地说，Platform Builder 安装包含构建操作系统所需的所有公共/驱动程序源代码和私有库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T07:46:30.290

恐怕没有。

是的，您可以使用 Visual Studio 构建应用程序、静态和动态库、Activex 控件。

但要构建可启动映像，您应该使用 Platform Builder。哦..这就是他们这么称呼它的原因；）

并且不可能升级或使用插件来拥有平台构建器功能！

# asp.net - 在 ASP.Net 中实现动态 URL 重写的最佳方法是什么？

> ID：125826
> 
> 赞同：2
> 
> 时间：2008-09-24T07:27:00.760
> 
> 标签：asp.net, routing, url-rewriting

我目前正在使用[Intelligencia.UrlRewriter](http://dotnetguts.blogspot.com/2008/07/url-rewriting-with-urlrewriternet.html)有人有更好的建议吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-09-24T10:37:45.043

[System.Web.Routing](http://msdn.microsoft.com/en-us/library/system.web.routing.aspx)是**.NET 3.5 SP1 的一部分，**您可以将它用于 ASP.NET WebForm 应用程序和 MVC 应用程序。

**ASP.NET 官方站点**有一个很好的关于System.Web.Routing的[**快速入门教程。**](http://quickstarts.asp.net/3-5-extensions/mvc/ASPNETRouting.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T07:33:21.073

[ISAPI_Rewrite](http://www.isapirewrite.com/)也是一个很好的通用解决方案 - 不仅适用于 ASP.NET，而且适用于任何其他系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-09-24T07:49:00.363

要考虑的另一种方法是[URL**路由**](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)。这与重写不同（重写涉及将一个 URL 更改为另一个，而路由涉及将动态 URL 直接映射到应用程序的不同部分）并且对于现有项目来说实现起来并不容易，但是如果您从一个项目开始从头开始，根据您的确切要求，您可能会发现这是一种更好的方法。另一方面，它可能对你一点用都没有，但至少你可以做出明智的决定！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-09-24T10:58:13.543

按照 Seb Nilsson 的建议，我在谷歌上搜索了一下，发现了这些很好的例子：

*   [aspnet 路由再见 url 重写](http://chriscavanagh.wordpress.com/2008/03/11/aspnet-routing-goodbye-url-rewriting/)
*   [使用独立于 mvc 的 asp.net 路由](http://blogs.msdn.com/mikeormond/archive/2008/05/14/using-asp-net-routing-independent-of-mvc.aspx)
*   [使用独立于 mvc 传递参数的 asp.net 路由](http://bbits.co.uk/blog/archive/2008/05/19/using-asp.net-routing-independent-of-mvc---passing-parameters-to.aspx)

使用 IIS 6 时，请务必查看此[博客](http://blogs.msdn.com/scothu/archive/2008/06/24/how-to-add-dynamic-data-to-an-existing-web-application.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T07:31:00.563

IIS 7 带有一个[重写模块](http://blogs.iis.net/bills/archive/2008/05/31/urlrewrite-module-for-iis7.aspx)

[您可以在此](http://en.wikipedia.org/wiki/Rewrite_engine#IIS)维基百科文章中找到更多链接

# c++ - 以最佳方式从 system() 命令捕获标准输出

> ID：125828
> 
> 赞同：57
> 
> 时间：2008-09-24T07:27:35.343
> 
> 标签：c++, c, system, stdout

`system()`我正在尝试通过- 例如，启动外部应用程序`system("ls")`。我想在它发生时捕获它的输出，以便我可以将它发送到另一个函数进行进一步处理。在 C/C++ 中做到这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2008-09-24T07:37:59.843

从弹出手册：

```
#include <stdio.h>

FILE *popen(const char *command, const char *type);

int pclose(FILE *stream); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2008-09-24T07:39:10.997

试试 popen() 函数。它执行一个命令，如 system()，但将输出定向到一个新文件。返回指向流的指针。

```
 FILE *lsofFile_p = popen("lsof", "r");

  if (!lsofFile_p)
  {
    return -1;
  }

  char buffer[1024];
  char *line_p = fgets(buffer, sizeof(buffer), lsofFile_p);
  pclose(lsofFile_p); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-09-24T07:36:59.910

编辑：将问题误读为想要将输出传递给另一个程序，而不是另一个函数。popen() 几乎可以肯定是你想要的。

系统使您可以完全访问外壳。如果你想继续使用它，你可以通过 system("ls > tempfile.txt") 将它的输出重定向到一个临时文件，但是选择一个安全的临时文件是很痛苦的。或者，您甚至可以通过另一个程序重定向它：system("ls | otherprogram");

有些人可能会推荐 popen() 命令。如果您可以自己处理输出，这就是您想要的：

```
FILE *output = popen("ls", "r"); 
```

这将为您提供一个 FILE 指针，您可以从中读取命令的输出。

您还可以使用 pipe() 调用创建连接，结合 fork() 创建新进程，dup2() 更改它们的标准输入和输出，exec() 运行新程序，wait()在主程序中等待他们。这只是像 shell 一样设置管道。有关详细信息和示例，请参见 pipe() 手册页。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-03-07T20:05:38.750

函数`popen()`等不会重定向 stderr 等；我为此写作[`popen3()`](http://sites.google.com/site/williamedwardscoder/popen3)。

这是我的 popen3() 的一个保龄球版本：

```
int popen3(int fd[3],const char **const cmd) {
        int i, e;
        int p[3][2];
        pid_t pid;
        // set all the FDs to invalid
        for(i=0; i<3; i++)
                p[i][0] = p[i][1] = -1;
        // create the pipes
        for(int i=0; i<3; i++)
                if(pipe(p[i]))
                        goto error;
        // and fork
        pid = fork();
        if(-1 == pid)
                goto error;
        // in the parent?
        if(pid) {
                // parent
                fd[STDIN_FILENO] = p[STDIN_FILENO][1];
                close(p[STDIN_FILENO][0]);
                fd[STDOUT_FILENO] = p[STDOUT_FILENO][0];
                close(p[STDOUT_FILENO][1]);
                fd[STDERR_FILENO] = p[STDERR_FILENO][0];
                close(p[STDERR_FILENO][1]);
                // success
                return 0;
        } else {
                // child
                dup2(p[STDIN_FILENO][0],STDIN_FILENO);
                close(p[STDIN_FILENO][1]);
                dup2(p[STDOUT_FILENO][1],STDOUT_FILENO);
                close(p[STDOUT_FILENO][0]);
                dup2(p[STDERR_FILENO][1],STDERR_FILENO);
                close(p[STDERR_FILENO][0]);
                // here we try and run it
                execv(*cmd,const_cast<char*const*>(cmd));
                // if we are there, then we failed to launch our program
                perror("Could not launch");
                fprintf(stderr," \"%s\"\n",*cmd);
                _exit(EXIT_FAILURE);
        }

        // preserve original error
        e = errno;
        for(i=0; i<3; i++) {
                close(p[i][0]);
                close(p[i][1]);
        }
        errno = e;
        return -1;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-10-03T11:22:19.863

最有效的方法是`stdout`直接使用文件描述符，绕过`FILE`流：

```
pid_t popen2(const char *command, int * infp, int * outfp)
{
    int p_stdin[2], p_stdout[2];
    pid_t pid;

    if (pipe(p_stdin) == -1)
        return -1;

    if (pipe(p_stdout) == -1) {
        close(p_stdin[0]);
        close(p_stdin[1]);
        return -1;
    }

    pid = fork();

    if (pid < 0) {
        close(p_stdin[0]);
        close(p_stdin[1]);
        close(p_stdout[0]);
        close(p_stdout[1]);
        return pid;
    } else if (pid == 0) {
        close(p_stdin[1]);
        dup2(p_stdin[0], 0);
        close(p_stdout[0]);
        dup2(p_stdout[1], 1);
        dup2(::open("/dev/null", O_WRONLY), 2);

        /// Close all other descriptors for the safety sake.
        for (int i = 3; i < 4096; ++i) {
            ::close(i);
        }

        setsid();
        execl("/bin/sh", "sh", "-c", command, NULL);
        _exit(1);
    }

    close(p_stdin[0]);
    close(p_stdout[1]);

    if (infp == NULL) {
        close(p_stdin[1]);
    } else {
        *infp = p_stdin[1];
    }

    if (outfp == NULL) {
        close(p_stdout[0]);
    } else {
        *outfp = p_stdout[0];
    }

    return pid;
} 
```

要读取*子*用途的输出，`popen2()`如下所示：

```
int child_stdout = -1;
pid_t child_pid = popen2("ls", 0, &child_stdout);

if (!child_pid) {
    handle_error();
}

char buff[128];
ssize_t bytes_read = read(child_stdout, buff, sizeof(buff)); 
```

写入和读取：

```
int child_stdin = -1;
int child_stdout = -1;
pid_t child_pid = popen2("grep 123", &child_stdin, &child_stdout);

if (!child_pid) {
    handle_error();
}

const char text = "1\n2\n123\n3";
ssize_t bytes_written = write(child_stdin, text, sizeof(text) - 1);

char buff[128];
ssize_t bytes_read = read(child_stdout, buff, sizeof(buff)); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T07:37:55.460

在 Windows 中，不使用 system()，而是使用 CreateProcess，将输出重定向到管道并连接到管道。

我猜这也可能以某种 POSIX 方式实现？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T07:41:35.700

功能`popen()`和`pclose()`可能是您正在寻找的。

以[glibc 手册](http://www.gnu.org/software/libc/manual/html_mono/libc.html#Pipe-to-a-Subprocess)为例。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-12-19T16:19:19.670

实际上，我刚刚检查过，并且：

1.  popen 是有问题的，因为该过程是分叉的。因此，如果您需要等待 shell 命令执行，那么您就有可能错过它。就我而言，我的程序甚至在管道开始工作之前就关闭了。

2.  我最终在 linux 上使用带有 tar 命令的*系统调用。**system*的返回值是*tar*的结果。

所以：**如果你需要返回值**，那么不仅不需要使用popen，它可能不会做你想要的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2014-10-03T10:42:18.863

在此页面中：[capture_the_output_of_a_child_process_in_c](http://www.microhowto.info/howto/capture_the_output_of_a_child_process_in_c.html#idp146944)描述了使用 popen 与使用 fork/exec/dup2/STDOUT_FILENO 方法的局限性。

我在[使用 popen](https://stackoverflow.com/questions/26177333/capturing-tshark-standard-output-with-popen-in-c)[捕获**tshark**](https://stackoverflow.com/questions/26177333/capturing-tshark-standard-output-with-popen-in-c)输出时遇到问题。

我猜这个限制可能是我的问题：

> 它返回一个 stdio 流，而不是原始文件描述符，后者不适合异步处理输出。

如果我有其他方法的解决方案，我会回到这个答案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-09-24T07:34:56.200

我不完全确定它在标准 C 中是否可行，因为两个不同的进程通常不共享内存空间。我能想到的最简单的方法是让第二个程序将其输出重定向到一个文本文件（程序名> textfile.txt），然后将该文本文件读回进行处理。但是，这可能不是最好的方法。

# web-services - 如何快速了解 SOA？

> ID：125831
> 
> 赞同：9
> 
> 时间：2008-09-24T07:28:08.323
> 
> 标签：web-services, architecture, soa

我的任务是为我的客户奠定 SOA 的基础。目标是以独立于终端客户的方式开放各种流程，并使数据可离线使用，例如访问客户的代表。

我确实在 J2EE (Websphere) 和 Web 服务方面拥有丰富的经验，但我希望能得到有关如何构建这样一个 SOA 的建议。

陷阱在哪里？安全呢？服务的粒度应该有多细？等等

指向教程和书籍推荐的链接也很有用。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T07:44:12.247

**陷阱**

*   版本控制/向后兼容性：一旦拥有大量客户端，就很难更改合同。我已经看到许多网站通过在 URL 中引入版本来对 API 进行版本化

**粒度**

*   每个服务都应该是独立的（不要指望人们在得到他们需要的东西之前做 3 次调用）

**平台独立性**

*   尝试提供不止一种访问 API 的方式（WS、JSON、REST...）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T08:29:35.803

人们无法就 SOA 的实际含义达成一致。

[http://martinfowler.com/bliki/ServiceOrientedAmbiguity.html](http://martinfowler.com/bliki/ServiceOrientedAmbiguity.html)

（尽管自编写以来共识可能已经增长）

我建议对您的客户进行测验，以确切了解他们的意思——如果有的话。然后给他们一些*真正提供业务价值*的东西，同时勾选任何可能与该努力相一致的 SOA 框。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-25T22:09:26.167

称我为 SOA 怀疑论者。福勒的哀叹似乎仍然正确。

我将关注更普遍的问题：您的客户有 2 个或更多必须一起协作的应用程序。看看老派的整合模式。

[![EIP 映像](https://i.stack.imgur.com/mFt37.jpg)](http://www.eaipatterns.com/)
[（来源：[amazon.com](http://rcm-images.amazon.com/images/I/51tVn4YqQUL._SL110_.jpg)）]

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-24T11:28:50.147

找到了这本 IBM 红皮书[(#sg246303](http://www.redbooks.ibm.com/redbooks/pdfs/sg246303.pdf?bcsi_scan_77D14932094FE69C=0&bcsi_scan_filename=sg246303.pdf) )，它很好地介绍了 SOA 的基础知识。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-09-29T10:09:13.593

正如 Alan 所说，我会开始阅读[Enterprise Integration Patterns 这本书](http://www.enterpriseintegrationpatterns.com/)。有许多方法可以直接使用消息传递系统（如 JMS）或使用开源项目（如[Apache Camel](http://activemq.apache.org/camel/) ）来实现它们，例如查看[模式目录](http://activemq.apache.org/camel/enterprise-integration-patterns.html)。

我还想了解如何使用 JAX-RS 和[Jersey](http://jersey.java.net/)构建良好的 RESTful 服务，作为一种简单的方法，可以轻松地将系统资源从任何语言/平台向网络上的任何人公开，而不会陷入 SOAP/WS-* 死星:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-09-24T08:13:03.177

获得 ESB（企业服务总线）：Mulesource 是一个不错的选择（开源、成熟、但前沿）。一旦你理解了它，你就会理解 SOA。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T16:54:02.847

> 目标是以独立于终端客户的方式开放各种流程，并使数据可离线使用，例如访问客户的代表。

后半部分并不是真正的 SOA 主题，它更多的是复制到移动设备的问题。我会远离尝试实施流行语并专注于您所说的问题。Web 服务是向客户端独立方式开放流程的好方法。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-05-08T08:31:02.153

到目前为止，我发现的最好的书是[SOA Compass](http://www.ibm.com/developerworks/dwbooks/soacompass/index.html)也可以在[亚马逊上找到](https://rads.stackoverflow.com/amzn/click/com/0131870025)

# visual-studio - Visual Studio 上下文菜单快捷方式

> ID：125838
> 
> 赞同：10
> 
> 时间：2008-09-24T07:29:54.513
> 
> 标签：visual-studio, keyboard-shortcuts

有谁知道 Visual Studio 中打开上下文菜单的键盘快捷键？即相当于右键单击。谢谢。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2008-09-24T07:32:00.247

`Shift`+`F10`适用于大多数 Windows 应用程序，但我没有 Visual Studio。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T07:33:32.350

当然，如果你有那个键，你也可以按下键盘上的快捷键。`Shift`+`F10`也可以。

# sql-server - MS-SQL Server 2005：使用备用快照位置初始化合并订阅

> ID：125849
> 
> 赞同：3
> 
> 时间：2008-09-24T07:33:39.747
> 
> 标签：sql-server, synchronization, replication, snapshot

一年前我们开始了一些海外合并复制，到目前为止一切都很好。我的问题是，我们的系统中现在有如此多的数据，以至于订阅者的服务器上的任何崩溃都将是一场灾难：以标准方式重新初始化订阅将需要几天时间（我们的连接肯定很慢，但已经非常非常昂贵）！我一直在跟进的想法如下：

1.  制作原始数据库的副本，冻结它，通过飞机将文件发送给订阅者，然后在没有快照的情况下启动复制：这是传统上使用旧版本 SQL 完成的事情，但对我来说听起来有点混乱：我将不得不将我的发布者的数据置于只读模式并停止所有复制，直到操作完成。
2.  制作数据快照，将快照文件发送到国外，将它们安装在订阅服务器上，并在复制属性中将新快照位置指示为备用位置。这对我来说听起来很公平（没有必要暂停正在进行的复制，没有数据冻结），但是，在这一点上，微软的帮助没有......帮助。

我相信你们中的一些人已经经历过这样的情况。你的选择是什么？

编辑：当然，有人可以说“你为什么不尝试一下你的想法”，但这需要几个小时（sql-servers、虚拟机和所有这些东西的多个实例......），而我以为做这件事的人只需要 2 分钟就可以解释他的想法。如果有人愿意腾出 2 分钟的时间来为我节省数小时的辛勤工作，我将是最幸福的人……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T21:01:05.000

我们刚刚经历了这样的事情，它并不漂亮。尽管涉及的所有服务器都是本地的，但仍然需要很长时间。

只是为了让事情变得更加困难，至少对于 SQL 2000，如果压缩的 cab 超过 4 Gig，快照将失败。

我能提供的最佳建议是确保每个站点都有可用的良好备份。这样一来，至少不必将数据随身携带给订户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-06T08:01:26.397

在将数据从加利福尼亚州洛杉矶复制到中国时，我不得不做类似的事情。使用正常方法加载快照需要 44 天。

我所做的是将 SQL 复制配置为使用快照的本地路径。然后我禁用了事务工作（在你的情况下是合并工作）。然后我运行了快照。我将快照压缩并将文件从加利福尼亚通过 FTP 传输到中国。当他们到达中国时，我将它们解压缩并将它们放在我在加利福尼亚使用的相同文件夹路径中。

然后我从中国服务器上的命令行运行 distrib.exe。这会将数据加载到中国的表中。加载快照后，我关闭了中国服务器上的分销商并启动了加利福尼亚服务器上的普通分销商。

这种方法只用了大约 28 小时，而不是一个多月。

如果您的数据需要几天时间才能到达目的地，那么您将需要编辑发布并增加可以排队的数据量，否则订阅者将超时并且需要创建新快照采取。

# apache - 调整 Apache mod_rewrite RewriteRule 不作用于物理目录

> ID：125850
> 
> 赞同：1
> 
> 时间：2008-09-24T07:34:55.000
> 
> 标签：apache, mod-rewrite

我有这个 RewriteRule 效果很好:-)

```
RewriteRule ^([^/]*)/$ /script.html?id=$1 [L] 
```

这条规则的坏处是它还匹配我不想要的物理目录。

如何告诉`mod_rewrite`忽略物理目录并仅在匹配的目录不存在时应用上述规则？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T07:38:19.873

看看[RewriteCond](http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html#rewritecond)。将以下内容放在您的规则之前以排除目录和文件

```
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T07:45:59.263

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]*)/$ /script.html?id=$1 [L] 
```

# c# - .NET TreeView 不会显示图像

> ID：125857
> 
> 赞同：5
> 
> 时间：2008-09-24T07:37:29.690
> 
> 标签：c#, .net, winforms

获取 TreeView 控件以显示节点图像时出现问题。下面的代码有时有效，但在其他时间无法显示任何图像。

```
 private TreeNode AddNodeForCore(TreeNode root, Core c) {
    string key = GetImageKey(c);
    TreeNode t = root.Nodes.Add(c.Name, c.Name, key, key);
    t.Tag = c;
    return t;
} 
```

请注意，当它失败时，TreeView 无法显示任何节点的任何图像。TreeView 确实有一个 ImageList 分配给它，并且图像键肯定在图像集合中。

编辑：
我的 google-fu 很弱。不敢相信我自己没有找到那个答案。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-09-24T07:51:11.373

上面的谷歌帖子的有用之处实际上是：

“这是 Windows XP 视觉样式实现中的一个已知错误。某些控件，如 ImageList，在应用程序调用 Application.EnableVisualStyles() 之前创建时未正确初始化。C# 中的正常 Main() 实现Program.cs 避免了这种情况。感谢您回帖！

所以基本上，确保在初始化图像列表之前调用 Application.EnableVisualStyles()。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T07:40:00.370

快速谷歌搜索找到了这个答案： http://forums.microsoft.com/MSDN/ShowPost.aspx?siteid=1& [PostID=965968](http://forums.microsoft.com/MSDN/ShowPost.aspx?siteid=1&PostID=965968)

**从该页面**引用：****

 **> 如果包含 TreeView 的 Form 在如下外接程序启动函数中被实例化，就会出现图标！

```
public partial class ThisApplication
{
    Form1 frm;

    private void ThisApplication_Startup(object sender, System.EventArgs e)
    {
        frm  = new Form1();
        frm.Show();

    } 
```

> 但是，如果用类实例化，如下所示：

```
public partial class ThisApplication
{
    Form1 frm = new Form1();

    private void ThisApplication_Startup(object sender, System.EventArgs e)
    {
                    frm.Show();

    } 
```

> 然后他们不会出现。此外，如果禁用“VisualStyles”（XP 中的新功能），则图标在两种情况下都有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-09-24T07:58:42.663

根据 MSDN 库中的 [添加方法部分]( [http://msdn.microsoft.com/en-us/library/ydx6whxs(VS.80).aspx)](http://msdn.microsoft.com/en-us/library/ydx6whxs(VS.80).aspx))，您需要同时填写这两个参数`TreeView.ImageList`，`TreeView.SelectedImageList`因为第四个参数是指第二个列表。

如果在您选择节点时发生此错误，请不要再犹豫了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-20T20:58:31.590

Yossarian 发布的解决方案和流行的“在 Application.EnableVisualStyles() 和 Application.Run() 之间调用 Application.DoEvents()”对我有用。

经过多次挥舞、咬牙切齿和谷歌搜索，[Addy Santo](http://blogs.msdn.com/asanto/archive/2004/08/18/216825.aspx)发布的解决方案成功了。

# .net - 使用 C# 更改 Windows 服务凭据的最佳方法是什么

> ID：125875
> 
> 赞同：6
> 
> 时间：2008-09-24T07:41:28.477
> 
> 标签：.net, configuration, service

我需要使用 C# 更改现有 Windows 服务的凭据。我知道有两种不同的方法可以做到这一点。

1.  ChangeServiceConfig，请参阅[pinvoke.net 上的 ChangeServiceConfig](http://www.pinvoke.net/default.aspx/advapi32.ChangeServiceConfig)
2.  ManagementObject.InvokeMethod 使用 Change 作为方法名称。

两者似乎都不是一种非常“友好”的方式，我想知道我是否错过了另一种更好的方式来做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T11:16:01.693

这是使用 System.Management 类的一种快速而肮脏的方法。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.Management;

namespace ServiceTest
{
  class Program
  {
    static void Main(string[] args)
    {
      string theServiceName = "My Windows Service";
      string objectPath = string.Format("Win32_Service.Name='{0}'", theServiceName);
      using (ManagementObject mngService = new ManagementObject(new ManagementPath(objectPath)))
      {
        object[] wmiParameters = new object[11];
        wmiParameters[6] = @"domain\username";
        wmiParameters[7] = "password";
        mngService.InvokeMethod("Change", wmiParameters);
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T22:01:47.220

ChangeServiceConfig 是我过去的做法。WMI 可能有点不稳定，我只有在别无选择时才想使用它，尤其是在访问远程计算机时。

# database - Versioning Database Persisted Objects, How would you?

> ID：125877
> 
> 赞同：42
> 
> 时间：2008-09-24T07:41:40.833
> 
> 标签：database, database-design, versioning, auditing

(Not related to versioning the database schema)

Applications that interfaces with databases often have domain objects that are composed with data from many tables. Suppose the application were to support versioning, in the sense of CVS, for these domain objects.

For some arbitry domain object, how would you design a database schema to handle this requirement? Any experience to share?

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-09-24T08:29:15.557

Think carefully about the requirements for revisions. Once your code-base has pervasive history tracking built into the operational system it will get very complex. [Insurance](http://www.xchanging.com/Sectors/Software.htm) [underwriting](http://www.roomsolutions.net/insurance-software/policy-administrator-system/subscribe.aspx) [systems](http://www.intechsolutions.co.uk/London_Market.htm) are particularly bad for this, with schemas often running in excess of 1000 tables. Queries also tend to be quite complex and this can lead to performance issues.

If the historical state is really only required for reporting, consider implementing a 'current state' transactional system with a data warehouse structure hanging off the back for tracking history. [Slowly Changing Dimensions](http://en.wikipedia.org/wiki/Slowly_changing_dimension) are a much simpler structure for tracking historical state than trying to embed an ad-hoc history tracking mechanism directly into your operational system.

Also, [Changed Data Capture](http://en.wikipedia.org/wiki/Changed_data_capture) is simpler for a 'current state' system with changes being done to the records in place - the primary keys of the records don't change so you don't have to match records holding different versions of the same entity together. An effective CDC mechanism will make an incremental warehouse load process fairly lightweight and possible to run quite frequently. If you don't need up-to-the minute tracking of historical state (almost, but not quite, and oxymoron) this can be an effective solution with a much simpler code base than a full history tracking mechanism built directly into the application.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2008-09-24T07:49:35.823

A technique I've used for this in that past has been to have a concept of "generations" in the database, each change increments the current generation number for the database - if you use subversion, think revisions. Each record has 2 generation numbers associated with it (2 extra columns on the tables) - the generation that the record starts being valid for, and the generation the it stops being valid for. If the data is currently valid, the second number would be NULL or some other generic marker.

So to insert into the database:

1.  increment the generation number
2.  insert the data
3.  tag the lifetime of that data with valid from, and a valid to of NULL

If you're updating some data:

1.  mark all data that's about to be modified as valid to the current generation number
2.  increment the generation number
3.  insert the new data with the current generation number

deleting is just a matter of marking the data as terminating at the current generation.

To get a particular version of the data, find what generation you're after and look for data valid between those generation versions.

Example:

Create a person.

```
|Name|D.O.B  |Telephone|From|To  |
|Fred|1 april|555-29384|1   |NULL| 
```

Update tel no.

```
|Name|D.O.B  |Telephone|From|To  |
|Fred|1 april|555-29384|1   |1   |
|Fred|1 april|555-43534|2   |NULL| 
```

Delete fred:

```
|Name|D.O.B  |Telephone|From|To  |
|Fred|1 april|555-29384|1   |1   |
|Fred|1 april|555-43534|2   |2   | 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T07:59:43.910

An alternative to strict versioning is to split the data into 2 tables: current and history.

The current table has all the live data and has the benefits of all the performance that you build in. Any changes first write the current data into the associated "history" table along with a date marker which says when it changed.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-08-12T08:11:40.383

If you are using Hibernate [JBoss Envers](http://jboss.org/envers) could be an option. You only have to annotate classes with `@Audited` to keep their history.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-09-24T07:57:10.577

You'll need a master record in a master table that contains the information common among all versions.

Then each child table uses master record id + version no as part of the primary key.

It can be done without the master table, but in my experience it will tend to make the SQL statements a lot messier.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T08:31:21.807

A simple fool-proof way, is to add a version column to your tables and store the Object's version and choose the appropriate application logic based on that version number. This way you also get backwards compatibility for little cost. Which is always good

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T08:32:48.183

ZoDB + ZEO implements a revision based database with complete rollback to any point in time support. Go check it.

Bad Part: It's Zope tied.

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-06-03T10:29:19.963

Once an object is saved in a database, we can modify that object any number of times right, If we want to know how many no of times that an object is modified then we need to apply this versioning concept.

When ever we use versioning then hibernate inserts version number as zero, when ever object is saved for the first time in the database. Later hibernate increments that version no by one automatically when ever a modification is done on that particular object. In order to use this versioning concept, we need the following two changes in our application

```
Add one property of type int in our pojo class.

In hibernate mapping file, add an element called version soon after id element 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-11-22T00:07:09.053

I'm not sure if we have the same problem, but I required a large number of 'proposed' changes to the current data set (with chained proposals, ie, proposal on proposal).

Think branching in source control but for database tables.

We also wanted a historical log but this was the least important factor - the main issue was managing change proposals which could hang around for 6 months or longer as the business mulled over change approval and got ready for the actual change to be implemented.

The idea is that users can load up a Change and start creating, editing, deleting the current state of data without actually applying those changes. Revert any changes they may have made, or cancel the entire change.

The only way I have been able to achieve this is to have a set of common fields on my versioned tables:

**Root ID**: Required - set once to the primary key when the first version of a record is created. This represents the primary key across all of time and is copied into each version of the record. You should consider the Root ID when naming relation columns (eg. PARENT_ROOT_ID instead of PARENT_ID). As the Root ID is also the primary key of the initial version, foreign keys can be created against the actual primary key - the actual desired row will be determined by the version filters defined below.

**Change ID**: Required - every record is created, updated, deleted via a change

**Copied From ID**: Nullable - null indicates newly created record, not-null indicates which record ID this row was cloned from when updated

**Effective From Date/Time**: Nullable - null indicates proposed record, not-null indicates when the record became current. Unfortunately a unique index cannot be placed on Root ID/Effective From as there can be multiple null values for any Root ID. (Unless you want to restrict yourself to a single proposed change per record)

**Effective To Date/Time**: Nullable - null indicates current/proposed, not-null indicates when it became historical. Not technically required but helps speed up queries finding the current data. This field could be corrupted by hand-edits but can be rebuilt from the Effective From Date/Time if this occurs.

**Delete Flag**: Boolean - set to true when it is proposed that the record be deleted upon becoming current. When deletes are committed, their Effective To Date/Time is set to the same value as the Effective From Date/Time, filtering them out of the current data set.

The query to get the current state of data according to a change would be;

```
SELECT * FROM table WHERE (CHANGE_ID IN :ChangeId OR (EFFECTIVE_FROM <= :Now AND (EFFECTIVE_TO IS NULL OR EFFECTIVE_TO > :Now) AND ROOT_ID NOT IN (SELECT ROOT_ID FROM table WHERE CHANGE_ID IN :ChangeId))) 
```

(The filtering of change-on-change multiples is done outside of this query).

The query to get the current state of data at a point in time would be;

```
SELECT * FROM table WHERE EFFECTIVE_FROM <= :Now AND (EFFECTIVE_TO IS NULL OR EFFECTIVE_TO > :Now) 
```

Common indexes created on (ROOT_ID, EFFECTIVE_FROM), (EFFECTIVE_FROM, EFFECTIVE_TO) and (CHANGE_ID).

If anyone knows a better solution I would love to hear about it.

# java - Java，NetBean：从 Web 服务方法访问 web.xml 上下文参数？

> ID：125878
> 
> 赞同：2
> 
> 时间：2008-09-24T07:42:05.527
> 
> 标签：java, web-services, netbeans

我是java新手，所以请原谅我的蹩脚问题:)

我正在尝试在 Java NetBeans 6.1 中构建 Web 服务，但我在配置参数方面遇到了一些问题（例如 .net 中的 .settings）。

在 Java Web 服务中保存和访问此类设置的正确方法是什么。

有没有办法在 web 方法中从 web.xml 读取上下文参数？

如果没有，存储配置变量（如路径名）的替代方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-09-24T15:04:34.730

> 有没有办法在 web 方法中从 web.xml 读取上下文参数？

不，使用开箱即用的设备不容易做到这一点。Web 服务系统 (JAX-WS) 对 Servlet 引擎 (Tomcat) 的认识极少。它们被设计为隔离的。

如果您想使用上下文参数，您的 Web 服务类将需要实现 ServletContextListener 并在初始化参数中检索所需的参数（或保存上下文以供以后使用）。由于 Servlet 引擎和 JAX-WS 都将具有不同的对象实例，因此您需要将值保存到静态成员。

正如 Lars 所提到的，Properties API 或 JNDI 是您最好的选择，因为它们包含在 Java 中，并且是相当知名的检索选项的方法。使用 Classloader.getResource() 在 Web 上下文中检索属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T08:03:35.617

如果您使用的是 servlet，您可以在 web.xml 中配置参数：

```
<servlet>
  <servlet-name>jsp</servlet-name>
  <servlet-class>org.apache.jasper.servlet.JspServlet</servlet-class>
    <init-param>
      <param-name>fork</param-name>
      <param-value>false</param-value>
     </init-param>
</servlet> 
```

这些属性将在 ServletConfig 对象中传递给您的 servlet 的“init”方法。

另一种方法是读取系统的环境变量

```
System.getProperty(String name); 
```

但是除了小程序和测试之外，不建议这样做。

如果您想使用“.properties”文件，还有属性 API。 [http://java.sun.com/javase/6/docs/api/java/util/Properties.html](http://java.sun.com/javase/6/docs/api/java/util/Properties.html)

最后，我相信在开发现代 Web 服务应用程序时，使用 JNDI 查找配置非常普遍，Netbeans 和应用程序容器对此提供了很好的支持。去谷歌上查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-10-12T05:50:52.120

```
MessageContext ctx = MessageContext.getCurrentThreadsContext();       
Servlet wsServlet = (Servlet) ctx.getProperty(HTTPConstants.MC_HTTP_SERVLET);         
ServletConfig wsServletConfig = wsServlet.getServletConfig();                 
ServletContext wsContext = wsServletConfig.getServletContext(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-20T09:12:54.863

我认为正确的答案是......一如既往......“这取决于”。如果您只是在单个服务器上运行一个小型实现，那么它很大程度上取决于您要使用的 WS 技术。有些使 servlet 上下文和上下文参数易于访问，有些则不，在这种情况下，从属性文件访问属性可能更容易。您是否将在具有高流量的负载平衡环境中拥有一组服务器，其中更新所有服务器的设置必须是即时和集中的，以防故障转移？如果是这种情况，那么您真的要更新场中所有服务器的配置文件吗？您如何将这些更改同步到所有这些服务器？这对你重要吗？如果你' 将路径名重新存储在配置文件中，那么您可能希望能够将路径名更新到另一台主机，以防某些主机出现故障（“\file_server_host\doc_store”->“\backup_file_server_host\doc_store”），其中实际上，使用 DNS 进行故障转移可能会更好。变数太多了。这真的取决于设计；需要；应用程序的规模。

* * *

为简单起见，如果您只想要一个简单的 .settings 文件等价物，那么您需要一个 .properties 文件。这是我最近在一个项目中使用它的一个例子：[https ://github.com/sylnsr/docx4j-ws/blob/master/src/docx4j/TextSubstitution.java](https://github.com/sylnsr/docx4j-ws/blob/master/src/docx4j/TextSubstitution.java)

# c++ - 谁能推荐一个 C++ std::map 替换容器？

> ID：125880
> 
> 赞同：10
> 
> 时间：2008-09-24T07:43:42.467
> 
> 标签：c++, stdmap

地图非常适合轻松完成任务，但它们会占用内存并且存在缓存问题。当你有一个关键循环中的地图时，这可能会很糟糕。

所以我想知道是否有人可以推荐另一个具有相同 API 但使用向量或哈希实现而不是树实现的容器。我的目标是交换容器，而不必重写所有依赖于地图的用户代码。

更新：性能方面最好的解决方案是在 std::vector 上测试地图外观

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-09-24T08:00:40.273

您可以使用 std::tr1::unordered_map，它已经存在于大多数 STL 实现中，并且是 C++0x 标准的一部分。

这是它的当前签名：

```
template <class Key,
          class T,
          class Hash = std::tr1::hash<Key>,
          class Pred = std::equal_to<Key>,
          class Alloc = std::allocator<std::pair<const Key, T> > >
class unordered_map; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-09-24T08:25:47.233

也许[Google SparseHash](http://code.google.com/p/google-sparsehash/)可以帮助你？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-09-24T07:49:26.557

请参阅[Loki::AssocVector](http://loki-lib.sourceforge.net/)和/或 hash_map（大多数 STL 实现都有这个）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-09-24T07:59:30.260

如果您的密钥是一种可以非常快速地比较的简单类型，并且您的条目不超过几千个，那么只需将您的配对放入 an`std::vector`并迭代以找到您的值，您就可以获得更好的性能。

# c++ - C++ 函数列表

> ID：125885
> 
> 赞同：1
> 
> 时间：2008-09-24T07:45:36.957
> 
> 标签：c++, function, maintainability

我正在做一个相当复杂的项目，如果你愿意的话，一个自定义加密例程（只是为了好玩）我在设计我的代码布局时遇到了这个问题。

我有许多我希望能够按索引调用的函数。具体来说，我需要能够为加密过程随机调用一个，然后通过解密过程中的特定索引来解决它。

我正在考虑一个经典的函数数组，但我主要担心的是函数数组很难维护，而且有点难看。（目标是将每个函数对放在一个单独的文件中，以减少编译时间并使代码更易于管理。）有没有人有更优雅的 C++ 解决方案来替代函数数组？速度不是真正的问题，我更担心可维护性。

-尼古拉斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-09-24T07:52:52.773

函数数组有什么问题？

您需要按索引调用函数。*因此，它们必须以某种方式*放入某种“可按索引索引”的结构中。数组可能是最适合这种需求的最简单的结构。

示例（从我的脑海中输入，可能无法编译）：

```
struct FunctionPair {
   EncodeFunction encode;
   DecodeFunction decode;
};
FunctionPair g_Functions[] = {
   { MyEncode1, MyDecode1 },
   { MySuperEncode, MySuperDecode },
   { MyTurboEncode, MyTurboDecode },
}; 
```

上述方法中的“丑陋”或“难以维护”是什么？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-09-24T08:00:09.760

你可以这样写：

```
class EncryptionFunction
{
public:
    virtual Foo Run(Bar input) = 0;
    virtual ~MyFunction() {}
};

class SomeSpecificEncryptionFunction : public EncryptionFunction
{
    // override the Run function
};

// ...

std::vector<EncryptionFunction*> functions;

// ...

functions[2]->Run(data); 
```

如果您愿意，可以使用`operator()`而不是`Run`作为函数名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T07:50:35.460

定义了 operator() 方法的对象可以像函数一样工作，但通常更易于使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-09-24T08:05:11.137

多态可以解决问题：您可以遵循策略模式，考虑每个策略来实现您的一个功能（或其中一对）。

然后创建一个策略向量，并使用这个而不是函数列表。

但坦率地说，我没有看到函数数组的问题。您可以轻松创建 typedef 以简化可读性。实际上，在使用策略模式时，您最终会得到完全相同的文件结构。

```
// functiontype.h
typedef bool (*forwardfunction)( double*, double* );

// f1.h
#include "functiontype.h"
bool f1( double*, double* );

// f1.c
#include "functiontype.h"
#include "f1.h"
bool f1( double* p1, double* p2 ) { return false; }

// functioncontainer.c    
#include "functiontype.h"
#include "f1.h"
#include "f2.h"
#include "f3.h"

forwardfunction my_functions[] = { f1, f2, f3 }; 
```

*   函数声明和定义在单独的文件中 - 编译时间没问题。
*   函数分组在一个单独的文件中，仅依赖于声明

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-09-24T08:15:13.997

您可以查看[Boost.Signals 库](http://www.boost.org/doc/libs/1_36_0/doc/html/signals.html)。我相信它有能力使用索引来调用它的注册函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-09-24T08:30:07.037

试试 Loki::Functor 类。[CodeProject.com](http://www.codeproject.com/KB/cpp/genfunctors.aspx)上的更多信息

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-09-24T09:39:00.647

如果你查看`boost::signals`库，你会看到一个非常漂亮的例子，非常优雅：
假设你有 4 个函数，比如：

```
void print_sum(float x, float y)
{
  std::cout << "The sum is " << x+y << std::endl;
}

void print_product(float x, float y)
{
  std::cout << "The product is " << x*y << std::endl;
}

void print_difference(float x, float y)
{
  std::cout << "The difference is " << x-y << std::endl;
}

void print_quotient(float x, float y)
{
  std::cout << "The quotient is " << x/y << std::endl;
} 
```

然后，如果您想以优雅的方式调用它们，请尝试：

```
boost::signal<void (float, float)> sig;

sig.connect(&print_sum);
sig.connect(&print_product);
sig.connect(&print_difference);
sig.connect(&print_quotient);

sig(5, 3); 
```

输出是：

```
The sum is 8
The product is 15
The difference is 2
The quotient is 1.66667 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-06-24T15:58:14.460

您需要使用一组函数指针。唯一的问题是所有函数必须具有基本相同的原型，只有函数名称和传递的参数名称可以不同。返回类型和参数类型（以及参数的数量和顺序）必须相同。

```
int Proto1( void );
int Proto2( void );
int Proto3( void );

int (*functinPointer[3])( void ) =
{
   Proto1,
   Proto2,
   Proto3
}; 
```

然后你可以做这样的事情：

```
int iFuncIdx = 0;
int iRetCode = functinPointer[iFuncIdx++](); 
```

# markdown - 保存 WMD 编辑器控件的内容

> ID：125911
> 
> 赞同：11
> 
> 时间：2008-09-24T07:51:52.040
> 
> 标签：markdown, wmd-editor

我正在尝试实现 StackOverflow 上使用的 WMD 编辑器来创建一些基本的 Wiki 风格的功能。我已经到了保存到数据库的时间了，但我不确定我应该保存什么。

如果我保存生成的 HTML，那么我可以正确检索并显示它，但在重新编辑时，我面临的是编辑 HTML，而不是 Markdown。但是，如果我保存 Markdown，我看不到任何将其转换回 HTML 以显示的方式，并且查看 StackOverflow 它会发送浏览器 HTML。

我猜我不需要保存两者，所以我错过了什么简单的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-09-24T08:37:30.247

绝对保存用户输入的 Markdown 代码。

然后，您将需要一个 Markdown 转换器，将其转换为 HTML 以显示它。

[你会在http://en.wikipedia.org/wiki/Markdown#Converters](http://en.wikipedia.org/wiki/Markdown#Converters)
和[http://markdown.infogami.com/](http://markdown.infogami.com/)找到一堆这样的

我会投票反对在您的情况下使用 JS。似乎有一个[.NET 实现](http://www.aspnetresources.com/blog/markdown_announced.aspx)，但我不能告诉你它有多好。

在渲染页面时，您必须将 Markdown 代码传递给上述转换器，然后输出返回的 HTML。

如果性能是一个问题，您还可以考虑将 Markdown 代码（供以后编辑）和 HTML 代码（用于显示）保存在数据库中。这样它只会被转换一次。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-09-24T07:58:20.887

我建议将准确输入的文本保存到数据库中，以便使用原始降价或 HTML 进行编辑。

当您检索要显示的文本时，您会在服务器端对其进行解析并在必要时转换为 HTML

[编辑]评论：如果我正确理解您的问题，您似乎已经有一种解析和转换为 HTML 的方法。这里讲一下生成的 HTML。

> 如果我保存生成的 HTML，那么我可以正确检索和显示它，但是在重新编辑时，我面临的是编辑 HTML，而不是 Markdown

# events - VisualBasic 中的 MSWinsock.Winsock 事件处理

> ID：125921
> 
> 赞同：6
> 
> 时间：2008-09-24T07:54:35.437
> 
> 标签：events, excel, winsock, vba

我正在尝试使用以下代码处理 Winsock_Connect 事件（实际上我在 Excel 宏中需要它）：

```
Dim Winsock1 As Winsock 'Object type definition

Sub Init()
    Set Winsock1 = CreateObject("MSWinsock.Winsock") 'Object initialization
    Winsock1.RemoteHost = "MyHost"
    Winsock1.RemotePort = "22"
    Winsock1.Connect

    Do While (Winsock1.State <> sckConnected)
        Sleep 200
    Loop
End Sub

'Callback handler
Private Sub Winsock1_Connect()
    MsgBox "Winsock1::Connect"
End Sub 
```

但它永远不会进入 Winsock1_Connect 子例程，尽管 Winsock1.State 是“已连接”。我想使用标准 MS 库，因为我在我的 PC 上没有管理权限，而且我无法注册一些自定义库。谁能告诉我，我错在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T08:12:01.197

你还在使用 MSWinsock 吗？
[这](http://www.ostrosoft.com/oswinsck/oswinsck_reference.aspx)是一个使用自定义 winsock 对象的站点/教程。

另外...您需要在“类”模块中声明 Winsock1 **WithEvents ：**

```
Private WithEvents Winsock1 As Winsock 
```

最后，确保您引用了 winsock ocx 控件。
工具 -> 参考 -> 浏览 -> %SYSEM%\MSWINSCK.OCX

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-08T15:54:10.653

**有关Winsock 控制**的文档：http :
[//msdn.microsoft.com/en-us/library/aa228119%28v=vs.60%29.aspx](http://msdn.microsoft.com/en-us/library/aa228119%28v=vs.60%29.aspx)
此处示例：http:
[//support.microsoft.com/kb/163999/en -我们](http://support.microsoft.com/kb/163999/en-us)

我在 VBscript 中进行事件处理的简短示例：

```
Dim sock
Set sock = WScript.CreateObject("MSWinsock.Winsock","sock_")
sock.RemoteHost = "www.yandex.com"
sock.RemotePort = "80"
sock.Connect

Dim received
received = 0

Sub sock_Connect()
    WScript.Echo "[sock] Connection Successful!"
    sock.SendData "GET / HTTP/1.1"& vbCrLf & "Host: " & sock.RemoteHost  & vbCrLf & vbCrLf
End Sub

Sub sock_Close()
    WScript.Echo "[sock] Connection closed!"
End Sub

Sub sock_DataArrival(Byval b)
    Dim data
    sock.GetData data, vbString
    received = received + b
    WScript.Echo "---------------------------------------"
    WScript.Echo " Bytes received: " & b  & " ( Total: " & received & " )"
    WScript.Echo "---------------------------------------"
    WScript.Echo data
End Sub

'Wait for server close connection
Do While sock.State <> 8
    rem WScript.Echo sock.State
    WScript.Sleep 1000
Loop 
```

输出将是：

`cscript /nologo sockhttp.vbs`

```
[sock] Connection Successful!
-------------------------------
 Bytes received: 1376 ( Total: 1376 )
-------------------------------
HTTP/1.1 200 Ok
Date: Mon, 08 Dec 2014 15:41:36 GMT
Content-Type: text/html; charset=UTF-8
Cache-Control: no-cache,no-store,max-age=0,must-revalidate
Expires: Mon, 08 Dec 2014 15:41:36 GMT
... 
```

# architecture - UML 连接器方向

> ID：125930
> 
> 赞同：1
> 
> 时间：2008-09-24T07:57:17.863
> 
> 标签：architecture, uml, sequence-diagram

在 UML 组件图中对架构进行建模时，如何同时显示连接器的各种属性？喜欢

*   业务对象信息流（A->B、B->A、A<->B）
*   请求/响应方向
*   同步/异步行为

我知道其他图表类型，如序列图。但是，让这些信息在组件图中可见是有价值的。

除了关联（仅显示组件已连接）或“棒棒糖”（请求/响应）之外，还有什么可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-09-24T08:08:52.093

首先，**不要**尝试使用类图上的连接器来解释这些动态协作。

类图上箭头连接器的方向只是指定*谁知道谁*。这意味着，类之间的依赖关系。使用这些箭头，您可以传达哪些类需要哪些其他类，但您不必解释这些类之间的协作动态*如何。*这就是 UML 动态图的用途。

从你的类图开始，这是系统的*静态*视图，然后添加一些动态图。

作为动态图，连同最常见的序列图，您还可以使用：

*   活动图
*   状态图
*   协作图

每个都有自己的兴趣点，主要策略是重用类图中定义的一些对象来描述特定场景。

对于系统上的每个“有趣”场景，您应该制作这些动态图之一来描述您在类图中指定的对象之间发生的情况。

通常，每个用例将由一个类图和一个或多个动态图来描述。所有这些设计信息一起称为*用例实现*，因为它们描述了在构建代码时将使您的用例*真实*的设计。

查看[Fowler 的 UML Distilled](https://rads.stackoverflow.com/amzn/click/com/020165783X)以获得对使用 UML 的设计工作流程的简明但出色的解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T22:51:38.853

您可以使用信息流关系，如 UML 上层结构的第 17.2 节所述：

> 信息流以一般的方式描述了系统中信息的流通。它们没有指定信息的性质（类型、初始值），也没有指定传递此信息的机制（消息传递、信号、公共数据存储、操作参数等）。它们也没有指定序列或任何控制条件。其目的是，在详细建模的同时，表示和实现链接将能够指定哪个模型元素实现指定的信息流，以及如何传达信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T07:59:17.220

您可能希望使用[序列图](http://www.agilemodeling.com/artifacts/sequenceDiagram.htm)而不是类（即组件）图。

如果你想坚持静态图，你可能还想考虑将 << sterotypes>> 添加到各种连接器，甚至使用[关联类](http://www.devx.com/enterprise/Article/28576)。

如果可能，您可以使用序列图中的连接器来连接组件图中的分类器（例如，同步/异步消息传递箭头）。

# c# - System.Diagnostics.Process.Start 奇怪的行为

> ID：125934
> 
> 赞同：8
> 
> 时间：2008-09-24T07:58:56.737
> 
> 标签：c#, .net, asynchronous

我正在编写一个应用程序来启动和监视 C# 中的其他应用程序。我正在使用 System.Diagnostics.Process 类来启动应用程序，然后使用 Process.Responding 属性监视应用程序，以每 100 毫秒轮询一次应用程序的状态。如果应用程序没有响应，我使用 Process.CloseMainWindow 来停止应用程序或 Process.Kill 来杀死它。

我注意到一个奇怪的行为，有时进程对象进入响应属性始终返回 true 的状态，即使底层进程挂在循环中并且它不响应 CloseMainWindow。

重现它的一种方法是在启动流程实例后立即轮询 Responding 属性。所以例如

```
_process.Start();
bool responding = _process.Responding; 
```

将重现错误状态，同时

```
_process.Start();
Thread.Sleep(1000);
bool responding = _process.Responding; 
```

将工作。将睡眠周期减少到 500 将再次引入错误状态。

启动后调用 _process.Responding 太快似乎会阻止对象获取正确的 Windows 消息队列处理程序。我想我需要等待 _process.Start 完成它的异步工作。有没有比调用 Thread.Sleep 更好的方法来等待这个？我不太相信 1000 毫秒就足够了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-09-24T08:19:46.700

现在，我需要稍后检查一下，但我确信有一种方法可以告诉线程等待，直到它准备好输入。您是否仅监控 GUI 进程？

[Process.WaitForInputIdle](http://msdn.microsoft.com/en-us/library/kcdbkyt4.aspx)对您没有任何帮助吗？还是我错过了重点？:)

## 更新

在 Twitter 上与 Mendelt 闲聊（或 tweet-tweet？）后，我认为我应该更新我的答案，以便社区充分了解..

*   `WaitForInputIdle`仅适用于具有 GUI 的应用程序。
*   您指定等待的时间，如果进程在该时间范围内达到空闲状态，则该方法返回一个布尔值，您显然可以在需要时使用它来循环，或根据需要进行处理。

希望有帮助:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-09-24T08:08:20.737

我认为增强对 _process.Responding 的检查可能会更好，以便仅在 Responding 属性返回 false 超过 5 秒时才尝试停止/终止进程（例如）。

我想您可能会经常发现，应用程序在进行更密集的处理时可能会在一瞬间“没有响应”。

我相信更宽松的方法会更好地工作，允许进程在短时间内“不响应”，只有在它反复“不响应”几秒钟（或多长时间）时才采取行动。

进一步说明：Microsoft 文档指出 Responding 属性专门与用户界面相关，这就是为什么新启动的进程可能不会让其 UI 立即响应的原因。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-09-24T09:08:04.870

感谢您的回答。这

```
_process.Start();
_process.WaitForInputIdle(); 
```

似乎可以解决问题。这仍然很奇怪，因为 Responding 和 WaitForInputIdle 应该都在幕后使用相同的 win32 api 调用。

一些更多的背景信息
GUI 应用程序有一个带有消息队列的主窗口。响应和 WaitForInputIdle 通过检查进程是否仍在处理来自此消息队列的消息来工作。这就是为什么它们只适用于 GUI 应用程序。不知何故，调用响应太快似乎会干扰进程获取该消息队列的句柄。调用 WaitForInputIdle 似乎可以解决这个问题。

我将不得不深入反射器，看看我是否能理解这一点。

*更新*
似乎在启动后检索与进程关联的窗口句柄足以触发奇怪的行为。像这样：

```
_process.Start();
IntPtr mainWindow = _process.MainWindowHandle; 
```

我检查了 Reflector，这就是 Responding 在幕后所做的。似乎如果您过早获得 MainWindowHandle，您会得到错误的句柄，并且它会在进程的剩余生命周期中使用这个错误的句柄，或者直到您调用 Refresh();

*update*
调用 WaitForInputIdle() 有时只能解决问题。每次阅读 Responding 属性时调用 Refresh() 似乎效果更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-10-18T01:50:11.160

我也在大约 2 年前的一个项目中注意到了这一点。在请求某些道具值之前，我调用了 .Refresh() 。当我需要调用 .Refresh() 时，它是一种反复试验的方法。

# linux - 创建网站截图的命令行程序（在 Linux 上）

> ID：125951
> 
> 赞同：66
> 
> 时间：2008-09-24T08:03:46.427
> 
> 标签：linux, screenshot

在 Linux 上创建网站截图的好命令行工具是什么？我需要在没有人工交互的情况下自动生成网站截图。我发现的唯一工具是[khtml2png](http://khtml2png.sourceforge.net/)，但我想知道是否还有其他不基于 khtml 的工具（即具有良好的 JavaScript 支持，...）。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2008-09-27T06:52:37.593

更多细节可能有用...

在 X 会话中启动 firefox（或其他浏览器），无论是在您的控制台上还是使用 vncserver。您可以使用`--height`和`--width`选项将窗口大小设置为全屏。另一个 firefox 命令可用于设置在第一个 firefox 窗口中显示的 URL。现在您可以使用几个命令之一来获取屏幕图像，例如 Imagemagick 包中的“import”命令，或者使用 gimp、fbgrab 或 xv。

```
#!/bin/sh

# start a server with a specific DISPLAY
vncserver :11 -geometry 1024x768

# start firefox in this vnc session
firefox --display :11

# read URLs from a data file in a loop
count=1
while read url
do
    # send URL to the firefox session
    firefox --display :11 $url

    # take a picture after waiting a bit for the load to finish
    sleep 5
    import -window root image$count.jpg

    count=`expr $count + 1`
done < url_list.txt

# clean up when done
vncserver -kill :11 
```

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-07-12T19:30:13.190

试试漂亮的小工具[CutyCapt](http://cutycapt.sourceforge.net/)，它只依赖于 Qt 和 QtWebkit。;)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-06-05T13:25:07.733

看看[**PhantomJS**](http://phantomjs.org/)，它似乎是一个运行在 Linux、OSX 和 Windows 上的免费可编写 Webkit 引擎。[自从我们目前使用Browshot](https://browshot.com/) （商业解决方案）以来，我没有使用它，但是当我们所有的积分用完时，我们将认真地拥有它（因为它是免费的并且可以在我们的服务器上运行）

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-10-02T20:57:39.440

[scrot](http://freshmeat.net/projects/scrot/)是一个用于截屏的命令行工具。请参阅[手册页](http://pwet.fr/man/linux/commandes/scrot)和本[教程](http://www.freesoftwaremagazine.com/columns/how_to_take_screenshots_with_scrot)。

您可能还想查看为浏览器编写脚本。有一些 Firefox 附加组件可以截取屏幕截图，例如[screengrab](https://addons.mozilla.org/en-US/firefox/addon/1146)（如果您愿意，它可以捕获整个页面，而不仅仅是可见部分），然后您可以使用[greasemonkey](http://en.wikipedia.org/wiki/Greasemonkey)编写浏览器脚本来截取屏幕截图。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-27T19:15:21.533

请参阅[Webkit2png](http://www.paulhammond.org/webkit2png/)。

我想这是我过去使用的。

**编辑**我发现我没有使用上述内容，但发现[此页面](http://www.techmaze.net/take-webpage-screenshot-from-command-line-in-ubuntu-linux/)包含许多不同程序和技术的评论。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-09-24T08:19:46.017

我知道它不是命令行工具，但您可以轻松编写脚本以使用[http://browsershots.org/](http://browsershots.org/)对于未托管在外部 IP 上的应用程序而言这不是很有用。

一个很棒的工具。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2008-09-24T08:20:50.490

我不知道任何定制的东西，我敢肯定壁虎引擎可以做一些事情来渲染到 png 文件而不是屏幕......

或者，您可以在专用 VNC 服务器实例中以全屏模式启动 firefox，并使用屏幕截图抓取器截取屏幕截图。全屏 = 最小的 chrome，VNC 服务器实例 = 没有可见的 UI + 你可以选择你的分辨率。

使用 xinit 和 Xvnc 作为 X 服务器来执行此操作 - 您需要阅读所有手册页。

缺点是截图总是一样的大小，不会根据网页调整大小...

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-09-24T09:05:13.003

有**导入**命令，但您需要 X 和一个打开浏览器窗口的小 bash 脚本，然后截取屏幕截图并关闭浏览器。

[你可以在这里](http://www.linux.com/articles/113595)找到更多信息，或者只是在 shell 中输入**import --help ；）**

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-02-04T05:45:36.303

[http://khtml2png.sourceforge.net/](http://khtml2png.sourceforge.net/)

deb 文件

*   [http://sourceforge.net/projects/khtml2png/files/khtml2png2/2.7.6/khtml2png_2.7.6_i386.deb/download](http://sourceforge.net/projects/khtml2png/files/khtml2png2/2.7.6/khtml2png_2.7.6_i386.deb/download)

安装 libkonq4 后在我的 Ubuntu 上工作......但您可能必须涵盖其他依赖项。

我认为现在对 javascript 的支持可能会更好！

斯蒂芬

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-02-17T09:02:37.267

不适用于命令行，但至少用于批量操作以获取更大的 URL 集，您可以使用 firefox 及其插件 fireshot（许可版本？）。

1.  为您的集合中的所有 url 打开标签（例如“打开此文件夹中所有书签的标签...”）。
2.  然后在fireshot启动“捕获所有标签”
3.  然后在编辑窗口中调用“选择所有镜头->保存所有镜头”

在以一组漂亮的截图文件结束之前设置截图属性（大小、文件格式等）。

史蒂芬

# nginx - nginx设置问题

> ID：125957
> 
> 赞同：8
> 
> 时间：2008-09-24T08:05:30.497
> 
> 标签：nginx, lighttpd

我知道这不是直接的编程问题，但 stackoverflow 上的人似乎能够回答任何问题。

我有一台运行 Centos 5.2 64 位的服务器。相当强大的双核 2 服务器，具有 4GB 内存。它主要提供静态文件、flash 和图片。当我使用 lighttpd 时，它很容易提供超过 80 MB/秒的速度，但是当我使用 nginx 进行测试时，它下降到低于 20 MB/秒。

我的设置非常简单，使用默认设置文件，并且添加了以下内容

```
user  lighttpd;
worker_processes  8;
worker_rlimit_nofile 206011;
#worker_rlimit_nofile 110240;

error_log   /var/log/nginx/error.log;
#error_log  /var/log/nginx/error.log  notice;
#error_log  /var/log/nginx/error.log  info;

pid        /var/run/nginx.pid;

events {
    worker_connections  4096;
}

http {
....

keepalive_timeout  2;
....
} 
```

而且我认为 nginx 应该至少同样强大，所以我一定没有做任何事情。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-10-01T08:01:10.250

当你重新加载你的 nginx (kiil -HUP) 你会在你的错误日志中得到类似的东西

```
2008/10/01 03:57:26 [通知] 4563#0：收到信号 1 (SIGHUP)，重新配置
2008/10/01 03:57:26 [通知] 4563#0：重新配置
2008/10/01 03:57:26 [通知] 4563#0：使用“epoll”事件方法
2008/10/01 03:57:26 [通知] 4563#0：启动工作进程
2008/10/01 03:57:26 [通知] 4563#0：启动工作进程 3870

```

你的 nginx 编译使用什么事件方法？

你在做任何 access_log'ing 吗？考虑添加 buffer=32k，这将减少对日志文件写锁的争用。

考虑减少工作人员的数量，这听起来违反直觉，但工作人员需要相互同步才能进行系统调用，如 accept()。尝试减少工人的数量，理想情况下我建议 1。

您可以尝试在侦听套接字上显式设置读写套接字缓冲区，请参阅[http://wiki.codemongers.com/NginxHttpCoreModule#listen](http://wiki.codemongers.com/NginxHttpCoreModule#listen)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-09-24T20:44:48.517

也许 lighttpd 正在使用某种缓存？[这里](http://www.igvita.com/2008/02/11/nginx-and-memcached-a-400-boost/)有一篇很棒的文章，描述了如何使用 nginx 设置 memcached，以实现 400% 的性能提升。

memcached 模块上的 nginx 文档在[这里](http://wiki.codemongers.com/NginxHttpMemcachedModule)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-10-12T20:35:24.183

建议： - 每个处理器使用 1 个工作人员。- 检查各种 nginx 缓冲区设置

# c# - 调试 Windows 服务的更简单方法

> ID：125964
> 
> 赞同：342
> 
> 时间：2008-09-24T08:08:37.010
> 
> 标签：c#, debugging, windows-services

有没有比通过 Windows 服务控制管理器启动服务然后将调试器附加到线程更简单的方法来单步执行代码？这有点麻烦，我想知道是否有更直接的方法。

* * *

## 回答 #1

> 赞同：277
> 
> 时间：2008-09-24T08:24:47.453

如果我想快速调试该服务，我只需插入`Debugger.Break()`其中。当到达那条线时，它会让我回到 VS。完成后不要忘记删除该行。

**更新：**作为`#if DEBUG`pragma 的替代方法，您还可以使用`Conditional("DEBUG_SERVICE")`属性。

```
[Conditional("DEBUG_SERVICE")]
private static void DebugMode()
{
    Debugger.Break();
} 
```

在您的 上`OnStart`，只需调用此方法：

```
public override void OnStart()
{
     DebugMode();
     /* ... do the rest */
} 
```

在那里，代码只会在调试构建期间启用。当您使用它时，为服务调试创建单独的构建配置可能会很有用。

* * *

## 回答 #2

> 赞同：218
> 
> 时间：2008-09-24T09:13:59.800

我还认为有一个单独的“版本”用于正常执行和作为服务是要走的路，但是否真的需要为此目的专用一个单独的命令行开关？

你不能这样做：

```
public static int Main(string[] args)
{
  if (!Environment.UserInteractive)
  {
    // Startup as service.
  }
  else
  {
    // Startup as application
  }
} 
```

这将具有“好处”，您可以通过双击启动您的应用程序（确定，如果您真的需要），并且您可以`F5`在 Visual Studio 中点击（无需修改项目设置以包含该`/console`选项）。

从技术上讲，`Environment.UserInteractive`检查是否为当前窗口站设置了标志，但是除了作为（非交互式）服务运行之外，`WSF_VISIBLE`还有其他原因会返回吗？`false`

* * *

## 回答 #3

> 赞同：134
> 
> 时间：2012-05-31T17:12:43.753

几周前，当我建立一个新的服务项目时，我发现了这篇文章。虽然有很多很好的建议，但我仍然没有找到我想要的解决方案：无需对服务类进行任何修改即可调用服务类`OnStart`和方法的可能性。`OnStop`

`Environment.Interactive`正如这篇文章的其他答案所建议的那样，我提出的解决方案使用了选择运行模式。

```
static void Main()
{
    ServiceBase[] servicesToRun;
    servicesToRun = new ServiceBase[] 
    {
        new MyService()
    };
    if (Environment.UserInteractive)
    {
        RunInteractive(servicesToRun);
    }
    else
    {
        ServiceBase.Run(servicesToRun);
    }
} 
```

`RunInteractive`助手使用反射来调用受保护的和`OnStart`方法`OnStop`：

```
static void RunInteractive(ServiceBase[] servicesToRun)
{
    Console.WriteLine("Services running in interactive mode.");
    Console.WriteLine();

    MethodInfo onStartMethod = typeof(ServiceBase).GetMethod("OnStart", 
        BindingFlags.Instance | BindingFlags.NonPublic);
    foreach (ServiceBase service in servicesToRun)
    {
        Console.Write("Starting {0}...", service.ServiceName);
        onStartMethod.Invoke(service, new object[] { new string[] { } });
        Console.Write("Started");
    }

    Console.WriteLine();
    Console.WriteLine();
    Console.WriteLine(
        "Press any key to stop the services and end the process...");
    Console.ReadKey();
    Console.WriteLine();

    MethodInfo onStopMethod = typeof(ServiceBase).GetMethod("OnStop", 
        BindingFlags.Instance | BindingFlags.NonPublic);
    foreach (ServiceBase service in servicesToRun)
    {
        Console.Write("Stopping {0}...", service.ServiceName);
        onStopMethod.Invoke(service, null);
        Console.WriteLine("Stopped");
    }

    Console.WriteLine("All services stopped.");
    // Keep the console alive for a second to allow the user to see the message.
    Thread.Sleep(1000);
} 
```

这是所需的所有代码，但我还编写了带有解释的[演练。](http://coding.abel.nu/2012/05/debugging-a-windows-service-project/)

* * *

## 回答 #4

> 赞同：54
> 
> 时间：2012-10-08T14:00:59.143

**有时分析服务启动期间**发生的情况很重要。附加到进程在这里没有帮助，因为在服务启动时附加调试器的速度不够快。

简短的回答是，我使用以下**4 行代码**来执行此操作：

```
#if DEBUG
    base.RequestAdditionalTime(600000); // 600*1000ms = 10 minutes timeout
    Debugger.Launch(); // launch and attach debugger
#endif 
```

这些被插入到`OnStart`服务的方法中，如下所示：

```
protected override void OnStart(string[] args)
{
    #if DEBUG
       base.RequestAdditionalTime(600000); // 10 minutes timeout for startup
       Debugger.Launch(); // launch and attach debugger
    #endif
    MyInitOnstart(); // my individual initialization code for the service
    // allow the base class to perform any work it needs to do
    base.OnStart(args);
} 
```

对于那些以前没有做过的人，我在**下面提供了详细的提示**，因为你很容易被卡住。以下提示适用于*Windows 7x64*和*Visual Studio 2010 Team Edition*，但也应适用于其他环境。

* * *

**重要提示：以***“手动”模式*部署服务（使用`InstallUtil`VS 命令提示符中的实用程序或运行您准备的服务安装程序项目）。**在启动服务之前**打开 Visual Studio并加载包含服务源代码的解决方案 - 根据需要在 Visual Studio 中设置额外的断点 - 然后通过*服务控制面板启动服务。*

由于`Debugger.Launch`代码的原因，这将导致对话框“ *Servicename.exe*中发生未处理的 Microsoft .NET Framework 异常”。出现。如截图所示点击：**`[![Elevate](https://i.stack.imgur.com/4j4ua.jpg)](https://i.stack.imgur.com/4j4ua.jpg) Yes, debug *Servicename.exe*`**
![框架异常](https://i.stack.imgur.com/raMT9.jpg)

之后，尤其是在 Windows 7 UAC 中，可能会提示您输入管理员凭据。输入它们并继续**`Yes`**：

![UAC 提示](https://i.stack.imgur.com/7bsxR.jpg)

之后，著名的**Visual Studio Just-In-Time Debugger 窗口**就会出现。它会询问您是否要使用 delected 调试器进行调试。**在您单击 之前`Yes`，**选择您**不想打开新实例**（第二个选项） - 在这里新建实例没有帮助，因为不会显示源代码。因此，您选择之前打开的 Visual Studio 实例： ![VSDebuggerPrompt](https://i.stack.imgur.com/pHQTm.jpg)

**单击`Yes`后**，Visual Studio 将在`Debugger.Launch`语句所在的行右侧显示黄色箭头，并且您可以调试代码（方法`MyInitOnStart`，其中包含您的初始化）。 ![VSDebugger断点](https://i.stack.imgur.com/LXJAC.png)

**按`F5`立即继续执行，**直到到达您准备的下一个断点。

**提示：**要保持服务运行，请选择**Debug -> Detach all**。这允许您在服务正确启动并完成调试启动代码后运行与服务通信的客户端。如果按**`Shift`+`F5`**（停止调试），这将终止服务。而不是这样做，您应该使用*服务控制面板*来停止它。

**请**注意****

 ***   如果你构建了一个**Release，**那么**调试代码会被自动移除**，并且服务会正常运行。

*   我正在使用**`Debugger.Launch()`**，它**启动并附加一个调试器**。我也进行了测试**`Debugger.Break()`**，但**没有成功**，因为在服务启动时还没有附加调试器（导致*“错误 1067：进程意外终止。”*）。

*   **`RequestAdditionalTime`****为服务的启动**设置更长的超时时间（它**不会**延迟代码本身，而是会立即继续执行该`Debugger.Launch`语句）。否则，启动服务的默认超时时间太短，如果您`base.Onstart(args)`从调试器调用的速度不够快，则启动服务会失败。实际上，10 分钟的超时可避免您在调试器启动后立即看到消息“*服务未响应...” 。*

*   一旦习惯了，这种方法就非常简单，因为它只需要你在现有的服务代码中**添加 4 行代码，让你快速获得控制和调试。**

* * *

## 回答 #5

> 赞同：40
> 
> 时间：2008-09-24T08:14:07.200

我通常做的是将服务的逻辑封装在一个单独的类中，并从一个“跑步者”类开始。这个运行器类可以是实际的服务或只是一个控制台应用程序。所以你的解决方案有（至少）3个项目：

```
/ConsoleRunner
   /....
/ServiceRunner
   /....
/ApplicationLogic
   /.... 
```

* * *

## 回答 #6

> 赞同：30
> 
> 时间：2013-09-10T21:15:43.750

[Fabio Scopel 的](http://www.youtube.com/watch?v=uM9o8GsO_u4)这个YouTube 视频解释了如何很好地调试 Windows 服务......实际的操作方法从视频中的 4:45 开始......

这是视频中解释的代码...在您的 Program.cs 文件中，为“调试”部分添加内容...

```
namespace YourNamespace
{
    static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        static void Main()
        {
#if DEBUG
            Service1 myService = new Service1();
            myService.OnDebug();
            System.Threading.Thread.Sleep(System.Threading.Timeout.Infinite);
#else
            ServiceBase[] ServicesToRun;
            ServicesToRun = new ServiceBase[]
            {
                new Service1()
            };
            ServiceBase.Run(ServicesToRun);
#endif

        }
    }
} 
```

在您的 Service1.cs 文件中，添加 OnDebug() 方法...

```
 public Service1()
    {
        InitializeComponent();
    }

    public void OnDebug()
    {
        OnStart(null);
    }

    protected override void OnStart(string[] args)
    {
        // your code to do something
    }

    protected override void OnStop()
    {
    } 
```

> 这个怎么运作

基本上，您必须创建一个`public void OnDebug()`调用 的，`OnStart(string[] args)`因为它受到保护且无法在外部访问。该`void Main()`程序添加了`#if`带有`#DEBUG`.

Visual Studio 定义`DEBUG`项目是否在调试模式下编译。这将允许调试部分（如下）在条件为真时执行

```
Service1 myService = new Service1();
myService.OnDebug();
System.Threading.Thread.Sleep(System.Threading.Timeout.Infinite); 
```

它将像控制台应用程序一样运行，一旦一切顺利，您可以更改模式`Release`，常规`else`部分将触发逻辑

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2008-09-24T08:59:11.117

**更新**

这种方法是迄今为止最简单的：

[http://www.codeproject.com/KB/dotnet/DebugWinServices.aspx](http://www.codeproject.com/KB/dotnet/DebugWinServices.aspx)

我将我的原始答案留在下面以供后代使用。

* * *

我的服务往往有一个封装 Timer 的类，因为我希望服务定期检查是否有任何工作要做。

我们新建类并在服务启动期间调用 StartEventLoop()。（这个类也可以很容易地从控制台应用程序中使用。）

这种设计的一个很好的副作用是，您设置 Timer 的参数可用于在服务实际开始工作之前有一个延迟，以便您有时间手动附加调试器。

> ps[如何手动将调试器附加](http://msdn.microsoft.com/en-us/library/c6wf8e4z.aspx)到正在运行的进程...？

```
using System;
using System.Threading;
using System.Configuration;    

public class ServiceEventHandler
{
    Timer _timer;
    public ServiceEventHandler()
    {
        // get configuration etc.
        _timer = new Timer(
            new TimerCallback(EventTimerCallback)
            , null
            , Timeout.Infinite
            , Timeout.Infinite);
    }

    private void EventTimerCallback(object state)
    {
        // do something
    }

    public void StartEventLoop()
    {
        // wait a minute, then run every 30 minutes
        _timer.Change(TimeSpan.Parse("00:01:00"), TimeSpan.Parse("00:30:00");
    }
} 
```

我也曾经做过以下事情（在以前的答案中已经提到过，但使用条件编译器 [#if] 标志来帮助避免它在发布版本中触发）。

我不再这样做了，因为有时我们会忘记在 Release 中构建并在客户端演示上运行的应用程序中出现调试器中断（尴尬！）。

```
#if DEBUG
if (!System.Diagnostics.Debugger.IsAttached)
{
    System.Diagnostics.Debugger.Break();
}
#endif 
```

* * *

## 回答 #8

> 赞同：13
> 
> 时间：2008-09-29T21:43:46.123

* * *

```
static void Main()
{
#if DEBUG
                // Run as interactive exe in debug mode to allow easy
                // debugging.

                var service = new MyService();
                service.OnStart(null);

                // Sleep the main thread indefinitely while the service code
                // runs in .OnStart

                Thread.Sleep(Timeout.Infinite);
#else
                // Run normally as service in release mode.

                ServiceBase[] ServicesToRun;
                ServicesToRun = new ServiceBase[]{ new MyService() };
                ServiceBase.Run(ServicesToRun);
#endif
} 
```

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2008-09-24T08:13:20.400

您还可以通过命令提示符 (sc.exe) 启动服务。

就个人而言，我会在调试阶段将代码作为独立程序运行，当大多数错误解决后，更改为作为服务运行。

* * *

## 回答 #10

> 赞同：10
> 
> 时间：2008-09-24T08:13:57.793

我以前做的是有一个命令行开关，可以将程序作为服务或常规应用程序启动。然后，在我的 IDE 中，我将设置开关，以便我可以单步执行我的代码。

使用某些语言，您实际上可以检测它是否在 IDE 中运行，并自动执行此切换。

您使用什么语言？

* * *

## 回答 #11

> 赞同：9
> 
> 时间：2013-06-11T07:35:59.067

使用[TopShelf](https://github.com/Topshelf/Topshelf)库。

创建一个控制台应用程序，然后在您的 Main 中配置设置

```
class Program
    {
        static void Main(string[] args)
        {
            HostFactory.Run(x =>
            {

                // setup service start and stop.
                x.Service<Controller>(s =>
                {
                    s.ConstructUsing(name => new Controller());
                    s.WhenStarted(controller => controller.Start());
                    s.WhenStopped(controller => controller.Stop());
                });

                // setup recovery here
                x.EnableServiceRecovery(rc =>
                {
                    rc.RestartService(delayInMinutes: 0);
                    rc.SetResetPeriod(days: 0);
                });

                x.RunAsLocalSystem();
            });
        }
}

public class Controller
    {
        public void Start()
        {

        }

        public void Stop()
        {

        }
    } 
```

要调试您的服务，只需在 Visual Studio 中按 F5。

要安装服务，请输入 cmd "console.exe install"

然后您可以在 Windows 服务管理器中启动和停止服务。

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2008-09-24T08:14:42.127

我认为这取决于您使用的操作系统，由于会话之间的分离，Vista 更难附加到服务。

我过去使用的两个选项是：

*   使用 GFlags（在 Windows 调试工具中）为进程设置永久调试器。这存在于“图像文件执行选项”注册表项中，非常有用。我认为您需要调整服务设置以启用“与桌面交互”。我将它用于所有类型的调试，而不仅仅是服务。
*   另一种选择是将代码分开一点，以便服务部分可以与正常的应用程序启动互换。这样，您可以使用简单的命令行标志，并作为进程（而不是服务）启动，这使得调试变得更加容易。

希望这可以帮助。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2011-07-01T17:20:33.753

我希望能够调试我的服务的各个方面，包括 OnStart() 中的任何初始化，同时仍然在 SCM 框架内以完整的服务行为执行它……没有“控制台”或“应用程序”模式。

为此，我在同一个项目中创建了第二个服务，用于调试。调试服务在正常启动时（即在服务 MMC 插件中）创建服务主机进程。即使您尚未启动真正的服务，这也为您提供了一个附加调试器的过程。将调试器附加到进程后，启动你的真实服务，你可以在服务生命周期的任何地方闯入它，包括 OnStart()。

因为它需要极少的代码侵入，调试服务可以轻松地包含在您的服务设置项目中，并且可以通过注释掉一行代码并删除单个项目安装程序轻松地从您的生产版本中删除。

**细节：**

1）假设您正在实施`MyService`，也创建`MyServiceDebug`. 像这样将两者都添加到`ServiceBase`数组中`Program.cs`：

```
 /// <summary>
    /// The main entry point for the application.
    /// </summary>
    static void Main()
    {
        ServiceBase[] ServicesToRun;
        ServicesToRun = new ServiceBase[] 
        { 
            new MyService(),
            new MyServiceDebug()
        };
        ServiceBase.Run(ServicesToRun);
    } 
```

2）将真实服务和调试服务添加到服务项目的项目安装程序中：

![在此处输入图像描述](https://i.stack.imgur.com/1Jbm5.png)

当您将服务项目输出添加到服务的设置项目时，这两个服务（真实和调试）都会包含在内。安装后，这两个服务都会出现在 service.msc MMC 插件中。

3）在MMC中启动调试服务。

4) 在 Visual Studio 中，将调试器附加到由调试服务启动的进程。

5）启动真正的服务，享受调试。

* * *

## 回答 #14

> 赞同：5
> 
> 时间：2008-09-24T08:16:00.283

当我编写一个服务时，我将所有服务逻辑放在一个 dll 项目中，并创建两个调用这个 dll 的“主机”，一个是 Windows 服务，另一个是命令行应用程序。

我使用命令行应用程序进行调试，并将调试器附加到实际服务中，仅针对我无法在命令行应用程序中重现的错误。

我使用这种方法只是记住，您必须在真实服务中运行时测试所有代码，而命令行工具是一个很好的调试辅助工具，它是一个不同的环境，它的行为与真实服务不完全相同。

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2008-09-24T08:17:38.673

在开发和调试 Windows 服务时，我通常通过添加 /console 启动参数并检查它来将其作为控制台应用程序运行。让生活更轻松。

```
static void Main(string[] args) {
    if (Console.In != StreamReader.Null) {
        if (args.Length > 0 && args[0] == "/console") {
            // Start your service work.
        }
    }
} 
```

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2008-09-24T08:18:22.493

第一行的 Debugger.Break() 怎么样？

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2008-09-24T13:30:19.793

为了调试 Windows 服务，我结合了 GFlags 和一个由 regedit 创建的 .reg 文件。

1.  运行 GFlags，指定 exe-name 和 vsjitdebugger
2.  运行 regedit 并转到 GFlags 设置选项的位置
3.  从文件菜单中选择“导出密钥”
4.  将该文件以 .reg 扩展名保存在某处
5.  任何时候要调试服务：双击 .reg 文件
6.  如果要停止调试，请双击第二个 .reg 文件

或者保存以下片段并将 servicename.exe 替换为所需的可执行文件名称。

* * *

debugon.reg：

```
Windows 注册表编辑器版本 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\servicename.exe]
“全球标志”=“0x00000000”
"调试器"="vsjitdebugger.exe"
```

* * *

debugoff.reg：

```
Windows 注册表编辑器版本 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\servicename.exe]
“全球标志”=“0x00000000”
```

* * *

## 回答 #18

> 赞同：2
> 
> 时间：2017-01-04T13:20:38.543

这是我用来测试服务的简单方法，没有任何额外的“调试”方法和集成的 VS 单元测试。

```
[TestMethod]
public void TestMyService()
{
    MyService fs = new MyService();

    var OnStart = fs.GetType().BaseType.GetMethod("OnStart", BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance | BindingFlags.Static);

    OnStart.Invoke(fs, new object[] { null });
}

// As an extension method
public static void Start(this ServiceBase service, List<string> parameters)
{
     string[] par = parameters == null ? null : parameters.ToArray();

     var OnStart = service.GetType().GetMethod("OnStart", BindingFlags.NonPublic | BindingFlags.Public | BindingFlags.Instance | BindingFlags.Static);

     OnStart.Invoke(service, new object[] { par });
} 
```

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2008-09-24T08:15:24.497

对于常规的小东西编程，我做了一个非常简单的技巧来轻松调试我的服务：

在服务启动时，我检查命令行参数“/debug”。如果使用此参数调用服务，我不执行通常的服务启动，而是启动所有侦听器并仅显示消息框“调试中，按确定结束”。

因此，如果我的服务以通常的方式启动，它将作为服务启动，如果它以命令行参数 /debug 启动，它将像普通程序一样运行。

在 VS 中，我只需添加 /debug 作为调试参数并直接启动服务程序。

这样我就可以轻松调试大多数小问题。当然，有些东西仍然需要作为服务进行调试，但是对于 99% 来说这已经足够了。

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2008-11-24T07:49:37.530

```
#if DEBUG
    System.Diagnostics.Debugger.Break();
#endif 
```

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-04-27T23:27:33.040

我使用了 JOP 答案的变体。使用命令行参数，您可以在 IDE 中使用项目属性或通过 Windows 服务管理器设置调试模式。

```
protected override void OnStart(string[] args)
{
  if (args.Contains<string>("DEBUG_SERVICE"))
  {
    Debugger.Break();
  }
  ...
} 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-05-19T23:02:36.613

对于现有 Windows 服务程序的故障排除，请按照其他人的建议使用“Debugger.Break()”。

对于新的 Windows 服务程序，我建议使用 James Michael Hare 的方法[http://geekswithblogs.net/BlackRabbitCoder/archive/2011/03/01/c-toolbox-debug-able-self-installable-windows-service-template- redux.aspx](http://geekswithblogs.net/BlackRabbitCoder/archive/2011/03/01/c-toolbox-debug-able-self-installable-windows-service-template-redux.aspx)

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2016-03-01T05:33:24.197

只需将调试器午餐放在任何地方并在启动时附加 Visualstudio

```
#if DEBUG
    Debugger.Launch();
#endif 
```

此外，您需要以管理员身份启动 VS，并且您需要允许一个进程可以由不同的用户自动调试（如此[处](http://blogs.msdn.com/b/dsvc/archive/2012/12/30/jit-debugging-using-visual-studio-may-fail-when-trying-to-debug-a-session-0-process-on-windows-8.aspx "这里")所述）：

```
reg add "HKCR\AppID{E62A7A31-6025-408E-87F6-81AEB0DC9347}" /v AppIDFlags /t REG_DWORD /d 8 /f 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2016-05-02T09:38:10.933

使用 Windows 服务模板 C# 项目创建新的服务应用程序[https://github.com/HarpyWar/windows-service-template](https://github.com/HarpyWar/windows-service-template)

自动检测到控制台/服务模式，服务的自动安装程序/卸载程序以及几个最常用的功能。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2018-03-14T09:41:35.003

```
static class Program
{
    static void Main()
    {
        #if DEBUG

        // TODO: Add code to start application here

        //    //If the mode is in debugging
        //    //create a new service instance
        Service1 myService = new Service1();

        //    //call the start method - this will start the Timer.
        myService.Start();

        //    //Set the Thread to sleep
        Thread.Sleep(300000);

        //    //Call the Stop method-this will stop the Timer.
        myService.Stop();

         #else
        ServiceBase[] ServicesToRun;
        ServicesToRun = new ServiceBase[] 
        { 
            new Service1() 
        };

        ServiceBase.Run(ServicesToRun);
         #endif
    }
} 
```

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2015-07-21T08:19:22.640

您有两个选项可以进行调试。

1.  创建一个日志文件：我个人更喜欢单独的日志文件，比如文本文件，而不是使用应用程序日志或事件日志。但这会花费你很多时间，因为仍然很难确定我们的确切错误位置在哪里
2.  将应用程序转换为控制台应用程序：这将为您提供我们可以在 VS 中使用的所有调试工具。

请参阅我为该主题创建的[这篇博文。](http://sandaruwmp.blogspot.com/2015/07/debug-windows-service-application_21.html)

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-03-16T09:59:02.083

只需粘贴

```
Debugger.Break(); 
```

你代码中的任何地方。

例如 ，

```
internal static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        private static void Main()
        {
            Debugger.Break();
            ServiceBase[] ServicesToRun;
            ServicesToRun = new ServiceBase[]
            {
                new Service1()
            };
            ServiceBase.Run(ServicesToRun);
        }
    } 
```

`Debugger.Break();`当你运行你的程序时它会命中。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2018-03-16T06:36:28.603

最好的选择是使用“ **System.Diagnostics** ”命名空间。

将您的代码包含在调试模式和发布模式的 if else 块中，如下所示，以便在 Visual Studio 中的调试和发布模式之间切换，

```
#if DEBUG  // for debug mode
       **Debugger.Launch();**  //debugger will hit here
       foreach (var job in JobFactory.GetJobs())
            {
                //do something 
            }

#else    // for release mode
      **Debugger.Launch();**  //debugger will hit here
     // write code here to do something in Release mode.

#endif 
```

# sql-server - 如何使用 T-SQL 判断 SQL 服务器数据库的 TRUSTWORTHY 属性是否设置为 on 或 off

> ID：125976
> 
> 赞同：16
> 
> 时间：2008-09-24T08:12:56.373
> 
> 标签：sql-server

如何使用 T-SQL 判断 SQL 服务器数据库的 TRUSTWORTHY 属性是否设置为 on 或 off

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2008-09-24T08:19:39.680

在 SSMS 中：

右键单击数据库，属性，杂项下的选项最后一条记录

在 T-SQL 中：

```
select is_trustworthy_on from sys.databases  where name = 'dbname' 
```

# java - 什么是 java.lang.UnsatisfiedLinkError ...（操作失败：14）

> ID：125994
> 
> 赞同：2
> 
> 时间：2008-09-24T08:17:28.813
> 
> 标签：java, windows-mobile, mobile, rcp

我正在尝试在 Windows CE5 Professional 设备上部署我们的 eRCP（嵌入式富客户端平台）应用程序。虽然 eRCP 演示应用程序在启动我们的应用程序时在 J9 VM 上运行良好，但出现以下异常：

```
!ENTRY org.eclipse.osgi 4 0 2008-09-24 11:01:15.088
!MESSAGE An error occurred while automatically activating bundle org.eclipse.ercp.swt (63).
!STACK 0
org.osgi.framework.BundleException: Exception in org.eclipse.ercp.swt.Activator.start() of bundle org.eclipse.ercp.swt.
[...]
Caused by: java.lang.UnsatisfiedLinkError: \eRCP\plugins\org.eclipse.ercp.swt.wince5_1.2.0\os\win32\arm\eswt-converged.dll (Operation Failed: 14)
at java.lang.ClassLoader.loadLibraryWithPath(Unknown Source)
at java.lang.ClassLoader.loadLibraryWithClassLoader(Unknown Source)
at java.lang.System.loadLibrary(Unknown Source)
at org.eclipse.ercp.swt.Activator.start(Unknown Source)
at org.eclipse.osgi.framework.internal.core.BundleContextImpl$2.run(Unknown Source)
at java.security.AccessController.doPrivileged(Unknown Source)
... 33 more 
```

我在网上找不到任何“操作失败：14”的含义。我想这可能是本机函数的一些返回值，但不能确定。DLL*存在*于指定的位置，我也尝试将它放在 \j9\bin 目录中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-09-24T08:24:39.170

是的，java 异常包装了来自 JNI 调用的本机异常，该调用失败了。由于某种原因，DLL 可能无法在您的设备上正确加载或执行。操作系统版本错误？损坏的DLL文件？不正确的读取/执行权限？很多可能的原因。

编辑 - 似乎其他人也有类似的问题。也许是 SWT 错误？看看你能不能从这里的开发者那里得到任何东西：http: [//www.eclipsezone.com/eclipse/forums/t111726.html](http://www.eclipsezone.com/eclipse/forums/t111726.html)

# c# - 如何同时启用/禁用 MenuItem 和 ToolButton

> ID：125997
> 
> 赞同：0
> 
> 时间：2008-09-24T08:18:17.640
> 
> 标签：c#, .net

我是 C# 的新手，但我是经验丰富的 Delphi 开发人员。在 Delphi 中，我可以使用 TAction.OnExecute 事件对 MenuItem 和 ToolButton 使用相同的代码，并且可以使用 TAction.OnUpdate 事件一起禁用/启用 MenuItem 和 ToolButton。在 C# 中是否有类似的方法可以在不使用外部库的情况下执行此操作？或更多 - C# 开发人员如何在不同控件之间共享代码？

* * *

好的，可能是我用错误的方式写了我的问题。我想不知道要使用的女巫属性（我知道 Enabled 属性），但我想知道如果我想启用/禁用多个控件，我应该附加到女巫事件。Delphi TAction.OnUpdate 事件在 Application 空闲时发生 - C# 中是否有类似事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-09-24T13:44:55.953

尝试修改命令模式：

```
public abstract class ToolStripItemCommand
{
    private bool enabled = true;
    private bool visible = true;
    private readonly List<ToolStripItem> controls;

    protected ToolStripItemCommand()
    {
        controls = new List<ToolStripItem>();
    }

    public void RegisterControl(ToolStripItem item, string eventName)
    {
        item.Click += delegate { Execute(); };
        controls.Add(item);
    }

    public bool Enabled
    {
        get { return enabled; }
        set
        {
            enabled = value;
            foreach (ToolStripItem item in controls)
                item.Enabled = value;
        }
    }

    public bool Visible
    {
        get { return visible; }
        set
        {
            visible = value;
            foreach (ToolStripItem item in controls)
                item.Visible = value;
        }
    }

    protected abstract void Execute();
} 
```

此命令的实现可以是有状态的，以支持视图的状态。这也使您能够在表单中构建“撤消”。这是一些使用它的玩具代码：

```
private ToolStripItemCommand fooCommand;

private void wireUpCommands()
{
    fooCommand = new HelloWorldCommand();
    fooCommand.RegisterControl(fooToolStripMenuItem, "Click");
    fooCommand.RegisterControl(fooToolStripButton, "Click");            
}

private void toggleEnabledClicked(object sender, EventArgs e)
{
    fooCommand.Enabled = !fooCommand.Enabled;
}

private void toggleVisibleClicked(object sender, EventArgs e)
{
    fooCommand.Visible = !fooCommand.Visible;
} 
```

HelloWorld 命令：

```
public class HelloWorldCommand : ToolStripItemCommand
{
    #region Overrides of ControlCommand
    protected override void Execute()
    {
        MessageBox.Show("Hello World");
    }
    #endregion
} 
```

不幸的是，Control 和 ToolStripItem 不共享一个公共接口，因为它们都具有“启用”和“可见”属性。为了支持这两种类型，您必须为这两种类型组合一个命令，或者使用反射。这两种解决方案都违反了简单继承所提供的优雅。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-09-24T08:22:59.127

[您可以通过设置控件的Enabled 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.enabled.aspx)来启用或禁用控件及其所有子项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-09-24T10:04:33.703

您可以在同一处理程序中挂钩 MenuItem 和 ToolButton 的代码。例如：
menuItem.Click += HandleClick;
toolbarButton.Click += handleClick;
这样，同时单击 MenuItem 和 Button 将执行相同的代码并提供相同的功能。********