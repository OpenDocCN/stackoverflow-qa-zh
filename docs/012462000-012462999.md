# StackOverflow 问答 12462000-12462999

# jquery - 在 jQuery 中使用数字值隐藏“DIV”元素

> ID：12462002
> 
> 赞同：1
> 
> 时间：2012-09-17T14:59:38.823
> 
> 标签：jquery, html

当价值小于 120 美元时，我试图隐藏一个`DIV`命名。一直隐藏`#cart-total`。`DIV`我还需要在价值低于 120 美元时同时显示另一个`DIV`命名。`#minOrder`该值将在页面加载或重新加载时设置。

```
<script type="text/javascript">

$(document).ready(function() {
  var x = $("1,196.00").text();
  if (+x < 120)
    $("div#cart-total").hide();
});

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:02:20.067

`var x = $("1,196.00")`正在尝试从 HTML 标记创建 jQuery 对象。代替

```
var x = $("1,196.00").text(); 
```

你应该只需要

```
var x = "1196.00"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:04:07.653

您首先应该将您的号码转换为`int`.

我现在不记得了，但其中之一是正确的：

```
var intvalue = Math.floor( floatvalue );
var intvalue = Math.ceil( floatvalue ); 
var intvalue = Math.round( floatvalue ); 
```

那么您将拥有轻松的生活。

# java - 选择 * 从之间 和 编辑4： 我不知道为什么，但是我在下面使用的结构不起作用。我不得不修改我在 java2s 网站上找到的一个文件，它叫做 TableFromDatabase，然后将 JTextFields 设为公共静态，然后在 FrmMovimento 等中实例化 TableFromDatabase 类： TableFromDa 问问题 问问题 2012-09-17T14:59:42.543 1742 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 编辑4： 我不知道为什么，但是我在下面使用的结构不起作用。我不得不修改我在 java2s 网站上找到的一个文件，它叫做 TableFromDatabase，然后将 JTextFields 设为公共静态，然后在 FrmMovimento 等中实例化 TableFromDatabase 类： TableFromDatabase frame = new TableFromDatabase(); jDesktopPane2.add(frame); frame.show(); 我还修改了 TableFromDatabase 行 frame.setDefaultCloseOperation( EXIT_ON_CLOSE_ ); 到 frame.setDefaultCloseOperation( DISPOSE_ON_CLOSE ); 原帖： 在这部分程序中，JInternalFrame 文件 FrmMovimento，我制作了一个名为 Visualizar（“视图”）的按钮。根据我们在文本字段中键入的内容，它必须显示用户定义的间隔。 有这些 JTextField： 代码来自：_到：_ 资产：_ 还有这些 JFormattedTextFields： 日期从：_到：_ 例如，如果我使用另一个 SELECT 语句选择所有寄存器，则 JInternalFrame FrmListarMov 的 JDesktopPane 中已经出现了寄存器。但如果我像在标题中那样输入： public List <movimentovo>Lista() throws ErroException, InformacaoException{ List <movimentovo>listaMovimento = new ArrayList<> (); try { MySQLDAO.getInstancia().setAutoCommit(false); try (PreparedStatement stmt = MySQLDAO.getInstancia().prepareStatement( "SELECT * FROM Cadastro2 WHERE Codigo BETWEEN "+ txtCodDeMov +" AND "+ txtCodAteMov +";") { ResultSet registro = stmt.executeQuery(); while(registro.next()){ MovimentoVO Movimento = new MovimentoVO(); Movimento.setCodDeMov(registro.getInt(1)); Movimento.setCodAteMov(registro.getInt(2)); Movimento.setAtivoMov(registro.getString(3)); Movimento.setDataDeMov(registro.getString(4)); Movimento.setDataAteMov(registro.getString(5)); listaMovimento.add(Movimento); } } } catch (SQLException ex) { throw new ErroException(ex.getMessage()); } catch (InformacaoException ex) { throw ex; } return listaMovimento; } 在 SELECT 行中，txtCodDeMov 是我如何命名“Code from”的 JTextField，而 txtCodAtemov 是我如何命名第一个“To”的 JTextField。 哦，我在 Linux Mint 12 64 位中使用 NetBeans 7.1.2（内部版本 201204101705）和 MySQL Ver 14.14 Distrib 5.1.63。 编辑：实际上，它是 MovimentoVO2、MovimentoDAO2 等，因为我做了两个文件，一个带有 setCodDeMov 和 setCodAteMov 等，另一个只有 setCodigo、setAtivo 和 setData。抱歉，我在使用这些技术方面还是有点菜鸟。 从表 Cadastro2 中，只有主键 Codigo 将用于查询。稍后我们将创建另一个表，我们将在其中注册资产的买卖，因此它们将具有资产类型和移动日期，这将被添加到 SELECT ... BETWEEN ... AND 我们需要。到目前为止，我只需要了解 Java 如何获取我在 JTextField 中键入的值并将其放入 SELECT 命令中。 EDIT2：在客户端注册屏幕中，查询按钮工作100％，如下所示。但这是另一种情况，因为在这种情况下，如果找到具有指定代码（表 Cadastro2 中的主键）的寄存器，则按钮事件会使所有 JTextField 完成。现在我要做的是生成一个包含间隔中所有寄存器的表。 EDIT3：我认为正确的术语是报告生成。我听说过 iReport 和 Jasper Reports，但我从未使用过它们。考虑到这个项目必须在 12 月在大学里提交，有时间学习这两个工具吗？当我还在学习 Java 时，这会是一个糟糕的举动吗？起初我认为是，所以我只在 Netbeans 上做所有事情。 假设 txtCodDeMo 和 txtCodAteMov 是日期，它们应该是单引号。 SELECT * FROM Cadastro2 WHERE Codigo BETWEEN '"+ txtCodDeMov +"' AND '"+ txtCodAteMov +"'"; 注意：此语法易受 SQL 注入攻击。 如果可能，请使用 PreparedStatement。 javaselectviewjtextfieldbetween 4 4 回答 4 This answer is useful 2 不要使用动态sql，它会导致SQL注入。使用参数。 代替 "SELECT * FROM Cadastro2 WHERE Codigo BETWEEN "+ txtCodDeMov +" AND "+ txtCodAteMov +";" 到 "SELECT * FROM Cadastro2 WHERE Codigo BETWEEN ? AND ?" // without semicolon in query ... stmt.setString(1, txtCodDeMov); // depends of 'Codigo' type, it may be stmt.setLong(1, txtCodDeMov); stmt.setString(2, txtCodAteMov); ResultSet registro = stmt.executeQuery(); 编辑：如果您未在查询中指定字段顺序，则不要按索引获取字段值。您可以稍后更改数据库中的字段顺序，您的函数将返回不正确的结果。按字段名称获取值或指定字段顺序。 于 2012-09-17T15:30:25.313 回答 This answer is useful 1 我可能有点被误导了，但除了考虑使用@user1516873 所说的参数或像@nambari 所说的那样添加'。我相信您在每个 JTextfields 中都缺少 getText() 方法，并且 + 运算符隐式调用 toString 方法。 于 2012-09-17T16:10:00.173 回答 This answer is useful 0 尝试使用 JTextField.getText() 来获取这些值。您还应该考虑对准备好的语句进行参数化。 你会做这样的事情。 “从 Cadatro2 中选择 * 在 Codigo 之间？和？；” stmt.setInt(1,1); stmt.setInt(2,2); 您可以将 .setInt 更改为您需要的任何数据类型。第一个参数是“？” 位置。第一个 .setInt 将设置第一个 ? 到值（对于该方法，它是一）。 于 2012-09-17T15:06:52.023 回答 This answer is useful 0 假设 txtCodDeMo 和 txtCodAteMov 是日期，它们应该是单引号。 SELECT * FROM Cadastro2 WHERE Codigo BETWEEN '"+ txtCodDeMov +"' AND '"+ txtCodAteMov +"'"; 注意：此语法易受 SQL 注入攻击。 如果可能，请使用 PreparedStatement。 于 2012-09-17T15:02:10.190 回答 Related 1 javascript - 触发动态弹出 HTML 表单的密码自动填充 0 ios - IOS：带有导航控制器的纵向窗口 4 javascript - 使用 id 动态显示/隐藏 div 元素 1 php - 第一次尝试登录被拒绝，但第二次尝试成功 1 user-interface - 如何明确指出某些属性不能在编辑操作中修改 1 android - AsyncTask 中的 IOException 3 shell - 找到所有的压缩包，并在原地解压 - Unix 1 javascript - HighChart 中 y 轴的起始值 3 internet-explorer - internet explorer 10 - 如何应用灰度过滤器？ 4 regex - sed 正则表达式中的布尔 OR Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</movimentovo></movimentovo>

> ID：12462005
> 
> 赞同：0
> 
> 时间：
> 
> 标签：java, select, view, jtextfield, between

编辑4：

我不知道为什么，但是我在下面使用的结构不起作用。我不得不修改我在 java2s 网站上找到的一个文件，它叫做 TableFromDatabase，然后将 JTextFields 设为公共静态，然后在 FrmMovimento 等中实例化 TableFromDatabase 类：

```
TableFromDatabase frame = new TableFromDatabase();
jDesktopPane2.add(frame);
frame.show(); 
```

我还修改了 TableFromDatabase 行

```
frame.setDefaultCloseOperation( EXIT_ON_CLOSE_ ); 
```

到

```
frame.setDefaultCloseOperation( DISPOSE_ON_CLOSE ); 
```

原帖：

在这部分程序中，JInternalFrame 文件 FrmMovimento，我制作了一个名为 Visualizar（“视图”）的按钮。根据我们在文本字段中键入的内容，它必须显示用户定义的间隔。

有这些 JTextField： 代码来自：***_***到：***_*** 资产：***_***

还有这些 JFormattedTextFields： 日期从：***_***到：***_***

例如，如果我使用另一个 SELECT 语句选择所有寄存器，则 JInternalFrame FrmListarMov 的 JDesktopPane 中已经出现了寄存器。但如果我像在标题中那样输入：

```
public List<MovimentoVO> Lista() throws ErroException, InformacaoException{
    List<MovimentoVO> listaMovimento = new ArrayList<> ();
    try {

        MySQLDAO.getInstancia().setAutoCommit(false);
        try (PreparedStatement stmt = MySQLDAO.getInstancia().prepareStatement(
             "SELECT * FROM Cadastro2 WHERE Codigo BETWEEN "+ txtCodDeMov +" AND "+ txtCodAteMov +";") {

            ResultSet registro = stmt.executeQuery();

            while(registro.next()){

                MovimentoVO Movimento = new MovimentoVO();

                Movimento.setCodDeMov(registro.getInt(1));
                Movimento.setCodAteMov(registro.getInt(2));
                Movimento.setAtivoMov(registro.getString(3));
                Movimento.setDataDeMov(registro.getString(4));
                Movimento.setDataAteMov(registro.getString(5));

                listaMovimento.add(Movimento);
            }
        }
    } catch (SQLException ex) {            
          throw new ErroException(ex.getMessage());
     } catch (InformacaoException ex) {  
          throw ex;
    }
    return listaMovimento;
} 
```

在 SELECT 行中，txtCodDeMov 是我如何命名“Code from”的 JTextField，而 txtCodAtemov 是我如何命名第一个“To”的 JTextField。

哦，我在 Linux Mint 12 64 位中使用 NetBeans 7.1.2（内部版本 201204101705）和 MySQL Ver 14.14 Distrib 5.1.63。

编辑：实际上，它是 MovimentoVO2、MovimentoDAO2 等，因为我做了两个文件，一个带有 setCodDeMov 和 setCodAteMov 等，另一个只有 setCodigo、setAtivo 和 setData。抱歉，我在使用这些技术方面还是有点菜鸟。

从表 Cadastro2 中，只有主键 Codigo 将用于查询。稍后我们将创建另一个表，我们将在其中注册资产的买卖，因此它们将具有资产类型和移动日期，这将被添加到 SELECT ... BETWEEN ... AND 我们需要。到目前为止，我只需要了解 Java 如何获取我在 JTextField 中键入的值并将其放入 SELECT 命令中。

EDIT2：在客户端注册屏幕中，查询按钮工作100％，如下所示。但这是另一种情况，因为在这种情况下，如果找到具有指定代码（表 Cadastro2 中的主键）的寄存器，则按钮事件会使所有 JTextField 完成。现在我要做的是生成一个包含间隔中所有寄存器的表。

EDIT3：我认为正确的术语是报告生成。我听说过 iReport 和 Jasper Reports，但我从未使用过它们。考虑到这个项目必须在 12 月在大学里提交，有时间学习这两个工具吗？当我还在学习 Java 时，这会是一个糟糕的举动吗？起初我认为是，所以我只在 Netbeans 上做所有事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:30:25.313

不要使用动态sql，它会导致SQL注入。使用参数。

代替 `"SELECT * FROM Cadastro2 WHERE Codigo BETWEEN "+ txtCodDeMov +" AND "+ txtCodAteMov +";"`

到

```
"SELECT * FROM Cadastro2 WHERE Codigo BETWEEN ? AND ?" // without semicolon in query
...
stmt.setString(1, txtCodDeMov); // depends of 'Codigo' type, it may be stmt.setLong(1, txtCodDeMov);
stmt.setString(2, txtCodAteMov);
ResultSet registro = stmt.executeQuery(); 
```

编辑：如果您未在查询中指定字段顺序，则不要按索引获取字段值。您可以稍后更改数据库中的字段顺序，您的函数将返回不正确的结果。按字段名称获取值或指定字段顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T16:10:00.173

我可能有点被误导了，但除了考虑使用@user1516873 所说的参数或像@nambari 所说的那样添加'。我相信您在每个 JTextfields 中都缺少 getText() 方法，并且 + 运算符隐式调用 toString 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:06:52.023

尝试使用 JTextField.getText() 来获取这些值。您还应该考虑对准备好的语句进行参数化。

你会做这样的事情。

“从 Cadatro2 中选择 * 在 Codigo 之间？和？；”

stmt.setInt(1,1); stmt.setInt(2,2);

您可以将 .setInt 更改为您需要的任何数据类型。第一个参数是“？” 位置。第一个 .setInt 将设置第一个 ? 到值（对于该方法，它是一）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T15:02:10.190

假设 txtCodDeMo 和 txtCodAteMov 是日期，它们应该是单引号。

```
SELECT * FROM Cadastro2 WHERE Codigo BETWEEN '"+ txtCodDeMov +"' AND '"+ txtCodAteMov +"'"; 
```

**注意：此语法易受 SQL 注入攻击。**

如果可能，请使用 PreparedStatement。

# java - 使用 simpledateformatter 进行日期解析

> ID：12462010
> 
> 赞同：1
> 
> 时间：2012-09-17T15:00:02.163
> 
> 标签：java, android, parsing, date, format

我试图解析以下日期：

```
 Wed Aug 27 13:08:45 +0000 2008 
```

（适用于 Twitter API 1.1）

我制作以下格式：

```
/**
 * Large twitter date format sample: "Wed Aug 27 13:08:45 +0000 2008"
 */
private static final String LARGE_TWITTER_DATE_FORMAT = "EEE MMM dd HH:mm:ss Z yyyy"; 
```

但它说：

```
java.text.ParseException: Unparseable date: "Sun Dec 25 14:49:28 +0000 2011" (at offset 0)
     at java.text.DateFormat.parse(DateFormat.java:626) 
```

我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:19:24.797

我认为这是语言环境问题。在我的机器上运行该代码给了我预期的结果，无一例外。

提示：解析`ENGLISH`语言环境**效果很好**

```
 String LARGE_TWITTER_DATE_FORMAT = "EEE MMM dd HH:mm:ss Z yyyy";
 String twiDate = "Wed Aug 27 13:08:45 +0000 2008";
 new SimpleDateFormat(LARGE_TWITTER_DATE_FORMAT, Locale.ENGLISH)
       .parse(twiDate).getHours()); 
```

解析法国会导致您遇到`locale` **相同的错误**

```
String LARGE_TWITTER_DATE_FORMAT = "EEE MMM dd HH:mm:ss Z yyyy";
String twiDate = "Wed Aug 27 13:08:45 +0000 2008";
System.out.println(new SimpleDateFormat(LARGE_TWITTER_DATE_FORMAT, Locale.FRANCE)
                .parse(twiDate).getHours()); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T15:20:31.840

以下对我有用

```
import java.text.ParseException;
import java.text.SimpleDateFormat;

public class Test {

    private static final String LARGE_TWITTER_DATE_FORMAT = "EEE MMM dd HH:mm:ss Z yyyy";

    /**
     * @param args
     */
    public static void main(String[] args) {
        SimpleDateFormat df = new SimpleDateFormat(LARGE_TWITTER_DATE_FORMAT);

        try {
            System.out.println(df.parse("Wed Aug 27 13:08:45 +0000 2008 "));
        } catch (ParseException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

# ios - iOS 编程是否会使用 Clang 和 llvm 进行虚拟化？

> ID：12462016
> 
> 赞同：0
> 
> 时间：2012-09-17T15:00:36.287
> 
> 标签：ios, compiler-construction, virtual, llvm, clang

我不明白整个 Clang 和 llvm 的事情。我问自己代码是在 iOS 设备上运行时在 VM 中运行，还是在编译时通过“VM”，用于编译时优化等等？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:02:47.373

LLVM 不是*这个*意义上的虚拟机。问题是 LLVM 是一个代码生成器，有助于统一编译器、语言和目标处理器/操作系统。LLVM 仅对编译器开发人员有用。事实上，在 Clang 编译器中，它起着主要作用，但这完全是内部的——从 Clang 中产生的是纯的、原生的 ARM/iOS 机器代码。

# ruby - 无法从 lib 文件夹加载类

> ID：12462019
> 
> 赞同：0
> 
> 时间：2012-09-17T15:00:42.350
> 
> 标签：ruby, ruby-on-rails-3.2

我想从**lib/info_test加载我的类****fine.rb**，但它不起作用。我更改了以下类**config/application.rb**如下：

 ****```
config.autoload_paths += %W(#{config.root}/lib)
config.autoload_paths += %W(#{config.root}/lib/info_test) 
```

如果我将课程直接保存在**lib**文件夹中，它可以工作，但不在**lib/info_test 中**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:14:17.103

它应该有效，并且对我有用。检查值

```
<application_name>::Application.config.autoload_paths 
```

在`rails c`

**更新**

然后尝试

```
config.autoload_paths += %W(#{config.root}/lib #{config.root}/lib/info_test) 
```

在 application.rb 中。****

# javascript - 使用javascript将html插入div

> ID：12462021
> 
> 赞同：3
> 
> 时间：2012-09-17T15:00:44.243
> 
> 标签：javascript, html

我在使用 javascript 更新 div 时遇到问题。

```
<script>
document.getElementById('advertisingBrandValues').innerHTML = "<p>The Mac is the most powerful   creative tool in the world, giving users unbridled potential to make everything from     bespoke family albums to industry-standard pop songs – iCreate is the key to unlocking that potential. Accessible, smart and authoritative, the iCreate brand thrives on the mantra ‘instruct, inform, inspire’, helping thousands of Mac users realise their creative ambitions.</p>";                   

</script>

<div id="advertisingBrandValues"></div> 
```

我不断收到以下错误：

**未终止的字符串文字** ，它表明错误与第一个 P 标记有关

我需要对传递给 innerHTML 函数的 HTML 做一些事情吗？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T15:04:25.213

`Unterminated string literal`通常意味着你试图做这样的事情：

```
var str = "Blah blah blah
  more blah that should be part of the string
  even more blah."; 
```

您不能在 JavaScript 中执行此操作，您必须结束字符串并附加下一行：

```
var str = "Blah blah blah\n"
  +"more blah that should be part of the string\n"
  +"even more blah."; 
```

或者您可以转义换行符（不确定这是否完全标准）：

```
var str = "Blah blah blah\
  more blah that should be part of the string\
  even more blah."; 
```

另请注意，您尝试修改的元素尚未定义。确保`<div>`您尝试修改的内容在`<script>`或推迟脚本或其内容（`window.onload`或类似内容）之前

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:07:57.293

问题可能是您使用的花哨的引号（'和'）。尝试用 '.

由于大量的解析错误和潜在的 XSS 漏洞，像这样将 HTML 插入页面通常不是好的做法。考虑创建内部元素`document.createElement()`并在子元素中附加文本内容。它有点冗长，但假设结构保持不变，修改起来会更加无缝。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:04:44.540

看起来文本中有回车符。

如果你有机会，也许在分配之前把它们换成休息时间

```
stringWithReturnsIn.replace(/[\n\r]/g, '<br />'); 
```

br 如果你想保留回报，否则

```
stringWithReturnsIn.replace(/[\n\r]/g, ' '); 
```

# html - 来自 iframe 的 HTML 刷新页面

> ID：12462022
> 
> 赞同：0
> 
> 时间：2012-09-17T15:00:50.093
> 
> 标签：html, ajax, iframe

我有一个简单的网页，分为三个 iframe A、B、C。

iframe B 执行 Ajax 请求，它应该刷新页面以重定向到我的登录页面。显然，登录页面只出现在 iframe B 中。有没有办法重定向整个页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:03:40.640

对 top.location 的简单检查不会起作用吗？

```
<script type="text/javascript">
    <!--
        if (top.location!= self.location) {
            top.location = self.location.href
        }
    //-->
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:04:33.527

这应该有效。

```
<script>
    Window.top.location = 'new url';
</script> 
```

# ms-access - 将数据从 Microsoft Access 表文件子集导出为纯文本

> ID：12462025
> 
> 赞同：0
> 
> 时间：2012-09-17T15:00:56.080
> 
> 标签：ms-access, export-to-excel, export-to-csv

我在从 Microsoft Access 导出数据时遇到问题。我有一个由多行和多列组成的 Access 文件，如下所示：

![数据表主要数据](../Images/ae9a21efae4e1967217ff193f6b4980d.png)

每行都包含一个数据子集，可以通过单击“+”按钮来观察：

![数据表子集](../Images/d170fe75524fb5a09bbefa3da855dacd.png)

我想导出所有这些数据（主表和子集），但是有问题。当我点击外部数据 -> 导出 -> 文本文件时，Ms Access 只导出主表数据（图 1），而完全省略子集的数据（图 2）。

**我如何导出所有这些数据（主表和子集）？**

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:22:04.873

创建一个查询，以您想要的方式对您想要的数据进行非规范化，然后将其导出到 Excel。

# xml - 如何序列化 Delphi TObjectList 使用 TJvAppXMLFileStorage 键入 XML？

> ID：12462029
> 
> 赞同：5
> 
> 时间：2012-09-17T15:01:03.887
> 
> 标签：xml, delphi, serialization, xml-serialization, jedi

以前，为了保存某些应用程序的设置，我使用了：

*   A`TSettings = class(TPersistent)`为容器
*   在已发布属性中序列化的每个数据
*   对象列表为**TCollection**和**TCollectionItem**类型
*   **TJvAppXMLFileStorage**组件用单行保存所有内容：

    JvAppXMLFileStorage.WritePersistent(...);

**但是**现在，我使用 TObjectList 作为 TSettings 类中的属性。
所以我放弃了 TCollection/TCollectionItem 以支持**泛型**......
当序列化它时，**没有项目列表**......我认为这是因为 TObjectList 不是来自 TPersistent。

如何使用**TJvAppXMLFileStorage序列化我的****TObjectList<>**？

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T07:29:46.063

我已经成功地通过调用几行代码序列化了我的通用列表`JvAppXMLFileStorage.WriteList`。

首先，这就是我**序列化 list 的**方式。下面详细介绍该`WriteGenericsObjectListItem<TMyClass>`方法。

```
JvAppXMLFileStorage.WriteList('mylist',TObject(MyGenericList), MyGenericList.Count, WriteGenericsObjectListItem<TMyClass>); 
```

然后，我只需要定义**如何序列化**通用列表的每个项目。为此，我创建了一个通用方法：

```
procedure TMySerializer.WriteGenericsObjectListItem<T>(Sender: TJvCustomAppStorage;
  const Path: string; const List: TObject; const Index: Integer; const ItemName: string);
begin
  if(List is TObjectList<T>) then
    if Assigned(TObjectList<T>(List)[Index]) then
      Sender.WritePersistent(Sender.ConcatPaths([Path, Sender.ItemNameIndexPath (ItemName, Index)]), TPersistent(TObjectList<T>(List)[Index]));
end; 
```

而已！
我没有修改 JCL/JVCL 代码，只是将这些添加到我的程序中。
我想我会向 JCL/JVCL 团队提交一个补丁，以添加与所有泛型容器的兼容性。

我希望这可以帮助你！**

# java - Spring jee：jdni 使用默认值抛出异常

> ID：12462031
> 
> 赞同：1
> 
> 时间：2012-09-17T15:01:09.140
> 
> 标签：java, spring, exception, jndi

我正在尝试使用带有默认值的 Spring jee 命名空间 JNDI 查找并遇到一些烦人的堆栈跟踪。我使用 Spring 3.1 和 tomcat 7 作为我的部署环境。有时 JNDI 变量可能没有在 context.xml 中设置，所以我希望能够使用 jee:jndi 标记的默认值属性。默认值实际上有效，但是每次达到默认值时它都会在日志中抛出一个堆栈跟踪。这是日志中的一个片段：

```
2012-09-17 08:39:21,099 [main] DEBUG org.springframework.jndi.JndiObjectFactoryBean - JNDI lookup failed - returning specified default object instead
javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at javax.naming.spi.NamingManager.getInitialContext(NamingManager.java:645)
    at javax.naming.InitialContext.getDefaultInitCtx(InitialContext.java:288)
    at javax.naming.InitialContext.getURLOrDefaultInitCtx(InitialContext.java:325)
    ...
2012-09-17 08:39:21,113 [main] DEBUG org.springframework.beans.factory.support.DefaultListableBeanFactory - Finished creating instance of bean 'coreURL' 
```

我通过用于创建此 bean 的 spring 类进行了一些调试，并查看了 NoInitialContextException 被捕获的位置并触发它使用默认值。但是，我觉得如果有这个堆栈跟踪不应该打印到日志的默认值。我在这个假设中不正确吗？是否有一些设置可以用来消除此错误？这是我对 bean 的 spring 配置：

```
<jee:jndi-lookup id="coreURL" expected-type="java.lang.String" jndi-name="java:comp/env/my.prop" default-value="http://myserver.com/core"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:35:16.030

将 LOG LEVEL 设置为`org.springframework.jndi.JndiObjectFactoryBean`INFO，您将看不到此 DEBUG 信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-06T11:01:59.677

对我来说 default-value="" 似乎也失败了。您必须输入一个非空字符串值。

# jquery - 使用jquery将foreignObject动态插入svg

> ID：12462036
> 
> 赞同：10
> 
> 时间：2012-09-17T15:01:29.307
> 
> 标签：jquery, svg

鉴于这个 html+svg

```
<div id="svg" style="width: 300px; height: 300px">
    <svg xmlns="http://www.w3.org/2000/svg"  width="300" height="300">
        <svg x='10' y='10' id='group'>
           <rect id="rect" x='0' y='0' width='100' height='100'  fill='#f0f0f0'/>
        </svg>
        <svg x='100' y='100' id='group2'>
           <rect id="rect2" x='0' y='0' width='100' height='100' fill='#f00000'/>
           <foreignobject x='0' y='0' width='100' height='100' >
                <body>
                    <div>manual</div>
                </body>
           </foreignobject>
        </svg>
    </svg>
</div> 
```

我想在#group 中插入一个foreignObject（最好使用jquery，因为它使操作更简单）。我试过（代码从头开始很粗略）

```
$("#group").append("<foreignobject x='0' y='0' width='100' height='100'><body><div>auto</div></body></foreignobject>") 
```

无济于事可能是因为“身体”被剥夺了。我已经尝试了几种创建 body 元素的奇异方法，并且尽我所能 - firebug 不再使插入的 foreignObject 元素变灰，但它仍然不可见。

所以要么我没有看到明显的东西，要么有一种奇怪的方法可以做到这一点。

想法？

**更新最终解决方案** 这是我想出的最短的

```
var foreignObject = document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject' );
var body = document.createElement( 'body' ); // you cannot create bodies with .apend("<body />") for some reason
$(foreignObject).attr("x", 0).attr("y", 0).attr("width", 100).attr("height", 100).append(body);
$(body).append("<div>real auto</div>");
$("#group").append(foreignObject); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T15:28:24.717

SVG 区分大小写，您想要的元素名称称为 foreignObject。要使用您将调用的 dom 创建它

```
document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject') 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T15:09:08.543

jQuery 不太适合 SVG 文档。

但是你仍然可以将纯 JS 与 jQuery 结合使用：

```
var foreignObject = document.createElement( 'foreignobject' );

/* add further child elements and attributes to foreignObject */

document.getElementById( 'group' ).appendChild( foreignObject ); 
```

# vba - VBA - 仅在一列中运行宏

> ID：12462038
> 
> 赞同：1
> 
> 时间：2012-09-17T15:01:48.167
> 
> 标签：vba

我的代码完全按照我想要的方式工作，但是我不希望它跳到另一列。我只想让我的宏在 C 列内运行然后退出。我是 excel 中的 VBA 新手，所以请原谅我的错误。任何帮助将非常感激。提前致谢。

```
 Sub CopyValuetoRange()
'
' CopyValuetoRange Macro

Dim search_range As Range, Block As Range, last_cell As Range
  Dim first_address$
  Set search_range = ActiveSheet.UsedRange
  Set Block = search_range.Find(what:="*", _
    after:=search_range.SpecialCells(xlCellTypeLastCell), _
    LookIn:=xlValues, searchorder:=xlColumns, searchdirection:=xlDown)
  If Block Is Nothing Then Exit Sub

  Set Block = Block.CurrentRegion
  first_address$ = Block.Address
  Do
    Block.Select
    Selection.End(xlDown).Select
    ActiveCell.CurrentRegion.Rows(2).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.FormulaR1C1 = "=R[-1]C"

    'MsgBox "Next Block Range"
    Set last_cell = Block.Cells(Block.Rows.Count)
    Set Block = search_range.FindNext(after:=last_cell).CurrentRegion
  Loop Until Block.Address = first_address$ 'ActiveSheet.Range("C26").End(xlDown).Row

End Sub 
```

这是我从我发现基本上会做同样事情的东西中修改的东西，但是它将第一个单元格值放入范围内的所有单元格中。而这个宏实际上保留在 C 列中，因为我最近发现它不是一个区域，而是一个范围。

有没有办法更改以下内容以将公式添加到指向范围中第一个单元格的范围内的所有单元格？

```
Sub Macro5()

    Dim Rng As Range
    Dim RngEnd As Range
    Dim rngArea As Range

        Set Rng = Range("C1")
        Set RngEnd = Cells(Rows.Count, Rng.Column).End(xlDown)
        If RngEnd.Row < Rng.Row Then Exit Sub

        Set Rng = Range(Rng, RngEnd)

        On Error GoTo ExitSub
        Set Rng = Rng.SpecialCells(xlCellTypeConstants)

        For Each rngArea In Rng.Areas
            rngArea.Value = rngArea.Cells(Rng.Rows.Count, 1).Value
        Next rngArea

ExitSub:
    ' Macro will exit here if the range is empty.

End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:31:24.627

您如何更改您的 search_range，以便您只搜索 C 列？

```
 Set search_range = ActiveSheet.Range("C:C")
  Set Block = search_range.Find(what:="*", _
    LookIn:=xlValues, searchorder:=xlColumns, searchdirection:=xlDown) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T18:13:10.973

这就是我所拥有的，它不漂亮，但它有效。我在两侧添加了一列，然后在宏遍历整个列后将其删除：

```
Sub CopyFirstCellInRangeInOneColumn()
'
' CopyValuetoRange Macro
Dim search_range As Range, Block As Range, last_cell As Range
  Dim first_address$
  ''
    Columns("C:C").Select
    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
    Columns("E:E").Select
    Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromLeftOrAbove
  ''
  Set search_range = ActiveSheet.Range("D:D")
  Set Block = search_range.Find(what:="*", _
    LookIn:=xlValues, searchorder:=xlColumns, searchdirection:=xlDown)

  'Set search_range = ActiveSheet.UsedRange
  'Set Block = search_range.Find(What:="*", _
  '  After:=search_range.SpecialCells(xlCellTypeLastCell), _
  '  LookIn:=xlValues, SearchOrder:=xlColumns, SearchDirection:=xlDown)

  If Block Is Nothing Then Exit Sub

  Set Block = Block.CurrentRegion
  first_address$ = Block.Address
  Do
    Block.Select
    Selection.End(xlDown).Select
    ActiveCell.CurrentRegion.Rows(2).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.FormulaR1C1 = "=R[-1]C"

    MsgBox "Next Block Range"
    Set last_cell = Block.Cells(Block.Rows.Count)
    Set Block = search_range.FindNext(After:=last_cell).CurrentRegion
  Loop Until Block.Address = first_address$ 'ActiveSheet.Range("C26").End(xlDown).Row

    Columns("C:C").Select
    Selection.Delete Shift:=xlToLeft
    Columns("D:D").Select
    Selection.Delete Shift:=xlToLeft

End Sub 
```

# api - 如何使用 ImageJ API 向图像添加颗粒

> ID：12462040
> 
> 赞同：1
> 
> 时间：2012-09-17T15:02:07.700
> 
> 标签：api, imagej

我是 ImageJ 的新手，我正在寻求使用 ImageJ 的编程 API 向图像**添加颗粒**（定义如下：[http ://en.wikipedia.org/wiki/Film_grain）。](http://en.wikipedia.org/wiki/Film_grain)

*   是否可以？如果有怎么办？
*   关于使用 ImageJ 向图像添加颗粒的相关文档/Javadocs 在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-25T20:30:50.153

我会从[*ImageJ 用户指南：§29.6 Noise*](http://rsbweb.nih.gov/ij/docs/guide/146-29.html#toc-Subsection-29.6)`Process > Noise`中描述的开始。您必须决定现有的实现是否可以满足您的要求。[](http://rsbweb.nih.gov/ij/docs/guide/146-29.html#toc-Subsection-29.6)

 *> *我可以在哪里找到有关如何使用实际 API 而不是 UI 来实现此目的的文档*。

正如[*ImageJ 宏语言*](http://rsbweb.nih.gov/ij/developer/macro/macros.html)中所讨论的，一种简单的方法是启动`Plugin > Macros > Record`然后操作所需的 GUI 命令。这将显示宏命令名称和任何设置，例如：

```
run("Add Noise");
run("Add Specified Noise...", "standard=16"); 
```

您可以使用`-batch`命令行选项将此类宏应用于多个文件。

如果您想直接使用 Java 中的功能，请参阅[*ImageJ 编程教程*](http://albert.rierol.net/imagej_programming_tutorials.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-29T19:28:10.650

我看到没有语言标签，所以我选择用 Scala 写一个例子。下面的代码将读取两次 lena.png 图像，并创建两个 ImagePlus 对象并向其中一个对象添加噪声。

我有点猜测 API 注释与软件库 ImageJ 而不是图形用户界面/程序 ImageJ 有关。

ImagePlus 有一个处理器（类型为 ij.process.ImageProcessor），您可以使用 getProcessor() 方法获得对它的引用

（getProcessor() 是这里的一个方法，作用于对象 lenaWithNoise 并返回对当前 ImageProcessor 的引用（附加到 lenaWithNose））。

方法噪声作用于ImageProcessor处理的图像，没有返回值（void方法或scala单位）

```
import ij._

object Noise {
  def main(args: Array[String]): Unit = {
    val lenaNoiseFree:ImagePlus = IJ.openImage("src/test/scala/images/lena.png")
    val lenaWithNoise:ImagePlus = IJ.openImage("src/test/scala/images/lena.png")
    lenaNoiseFree.show()
    lenaWithNoise.getProcessor().noise(10.0)
    lenaWithNoise.show()
 }
} 
```*

# php - 我可以在我的网络应用程序中使用开放图吗

> ID：12462044
> 
> 赞同：0
> 
> 时间：2012-09-17T15:02:16.823
> 
> 标签：php, facebook-opengraph

我想通过阅读 og 标签来解析发布的链接中的标题、图像等信息，就像 facebook 一样。这件事合法吗……我的意思是，如果我这样做，facebook会有任何反对意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:03:33.990

是的，您可以在 Web 应用程序中使用 Open Graph。不，Facebook 不会有任何异议。毕竟它*被*称为*Open* Graph。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:08:40.827

[http://ogp.me/](http://ogp.me/)

页面底部：Open Graph 协议最初是在 Facebook 创建的，其灵感来自 Dublin Core、link-rel canonical、Microformats 和 RDFa。此页面上描述的规范可在 Open Web Foundation 协议版本 0.9 下获得。这个网站是开源的。最后更新于 2012 年 7 月 5 日

# sharepoint - SharePoint 字段值有哪些限制？

> ID：12462046
> 
> 赞同：1
> 
> 时间：2012-09-17T15:02:19.263
> 
> 标签：sharepoint

可以存储在单个 SharePoint 字段中的数据量是否有任何限制？如果有，它们是什么？

例如，可以存储为单个字段的值的字节数或字符串长度是否有限制？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:28:11.583

SharePoint 将列表项存储在名为 的 SQL Server 表中`AllUserData`，因此最大值由列的数据类型决定。

[您可以在此处](http://msdn.microsoft.com/en-us/library/dd358229.aspx)找到完整的结构。但是，我找不到任何讨论 SharePoint 字段类型和 SQL Server 列类型之间映射的资源；可能是因为强烈建议不要直接访问 SharePoint 表。不过这不是什么大问题——查询表格，查看结果，您将能够匹配字段和列（例如`nvarchar1`，对应于第一个“单行文本”字段）。

# java - 如何手动使 Spring Batch 作业失败？

> ID：12462047
> 
> 赞同：5
> 
> 时间：2012-09-17T15:02:25.487
> 
> 标签：java, spring, spring-batch

这是我出于测试目的需要做的事情。我需要一种方法来根据某些预设条件（例如处理的项目数）随时使 Spring Batch 作业失败。但是，到目前为止，我还没有找到类似的东西。

我发现 Spring Batch 有这样的东西 -

```
<step id="step1" parent="s1" next="step2">

<step id="step2" parent="s2">
    <fail on="FAILED" exit-code="EARLY TERMINATION"/>
    <next on="*" to="step3"/>
</step>

<step id="step3" parent="s3"> 
```

但我正在寻找的是这样的 -

```
public void myJobFailingMethod()
 {
    if(conditionsMatch())
     {
        // fail the job 
     }  
 } 
```

这个怎么做？

更新：作业也可能在步骤之外失败。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T18:46:35.747

```
public void myJobFailingMethod()
{
    if(conditionsMatch())
    {
        throw new CustomJobFailingException(); // create this exception class.
                                               // It will fail the job.
    }  
} 
```

# java - 使用 Apache POI 更改单元格格式会导致数据丢失和意外行为。

> ID：12462050
> 
> 赞同：0
> 
> 时间：2012-09-17T15:02:28.380
> 
> 标签：java, excel, formatting, apache-poi, openxml

我正在使用 Apache POI 创建、访问和修改 *.xlsx 和 *.xls 文件。我一直在更改单元格格式（不要与样式混淆）。

```
Workbook wb = new XSSFWorkbook();
Sheet sheet = wb.createSheet();
Row row = sheet.createRow(0);
Cell cell = row.createCell(0);
cell.setCellValue(100); // setting cell value with double makes it numeric -> 100 aligned to the right
cell.setCellType(1); // changing cell format to text -> 100.0 aligned to the left
cell.setCellType(0); // changing cell format back to numeric -> 0 aligned to the right
FileOutputStream fos = new FileOutputStream("test.xlsx");
wb.write(fos); 
```

有人可能认为在文本和数字格式之间进行更改会导致数据被 0 替换。但是对更多单元格尝试相同的操作会产生一些更意想不到的结果：

```
Workbook wb = new XSSFWorkbook();
Sheet sheet = wb.createSheet();
for(int i=0;i<10;i++){
  Row row = sheet.createRow(i);
  for(int j=0;j<10;j++){
    Cell cell = row.createCell(j);
    cell.setCellValue(i*j);
    cell.setCellType(1);
    cell.setCellType(0);
  }
}
FileOutputStream fos = new FileOutputStream("test.xlsx");
wb.write(fos); 
```

预期的输出是乘法表。嗯……不是的。实际上改变 i 和 j 的范围会影响相同单元格地址的结果。

这是 Apache POI 中的错误吗？也许是由于OOXML规范，实际上是微软的错误？或者我的电脑出了什么问题，你的输出文件看起来应该是这样的？

# iphone - iOS6 上的 YouTube 视频播放中断（在 iOS5 上运行良好）

> ID：12462052
> 
> 赞同：13
> 
> 时间：2012-09-17T15:02:40.250
> 
> 标签：iphone, ios, youtube, ios6

在我的应用程序中，我有一个按钮，按下该按钮后，您可以观看 youtube 视频（电影预告片）。在应用程序内，无需启动 safari。您可以在下面看到一个代码片段。此代码在 iOS5 下运行良好。但是，在 iOS 6 中，findButtonInView 中的 UIButton 始终为 nil。任何想法可能是什么原因？

```
youtubeWebView.delegate = self;
youtubeWebView.backgroundColor = [UIColor clearColor];

NSString* embedHTML = @" <html><head> <style type=\"text/css\"> body {background-color: transparent;  color: white; }</style></head><body style=\"margin:0\"><embed id=\"yt\" src=\"%@?version=3&app=youtube_gdata\" type=\"application/x-shockwave-flash\"width=\"%0.0f\" height=\"%0.0f\"></embed></body></html>";

NSURL *movieTrailer;

if(tmdbMovie) movieTrailer = tmdbMovie.trailer;

else movieTrailer = [NSURL URLWithString:movie.trailerURLString];

NSString *html = [NSString stringWithFormat:embedHTML,
                                            movieTrailer,
                                            youtubeWebView.frame.size.width,
                                            youtubeWebView.frame.size.height];

[youtubeWebView loadHTMLString:html baseURL:nil];

[self addSubview:youtubeWebView];

- (void)webViewDidFinishLoad:(UIWebView *)_webView {

    isWatchTrailerBusy = NO;

    [manager displayNetworkActivityIndicator:NO];

    //stop the activity indicator and enable the button

     UIButton *b = [self findButtonInView:_webView];

    //TODO this returns null in case of iOS 6, redirect to the youtube app

    if(b == nil) {

        NSURL *movieTrailer;

        if(tmdbMovie) {
            movieTrailer = tmdbMovie.trailer;
        } else {
            movieTrailer = [NSURL URLWithString:movie.trailerURLString];
        }

        [[UIApplication sharedApplication] openURL:movieTrailer];

    } else {
        [b sendActionsForControlEvents:UIControlEventTouchUpInside];
    }
}

- (UIButton *)findButtonInView:(UIView *)view {

    UIButton *button = nil;
    if ([view isMemberOfClass:[UIButton class]]) {
        return (UIButton *)view;
    }

    if (view.subviews && [view.subviews count] > 0) {

        for (UIView *subview in view.subviews) {
            button = [self findButtonInView:subview];
            if (button) return button;
        }
    }

     return button;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-20T01:12:54.623

Apple 改变了 iOS6 中处理 YouTube 视频的方式。我也在使用 findButtonInView 方法，但它不再有效。

我发现以下似乎可行（在 iOS < 6 中未经测试）：

```
- (void)viewDidLoad 
{
    [super viewDidLoad];
    self.webView.mediaPlaybackRequiresUserAction = NO;
}

- (void)playVideo
{
    self.autoPlay = YES;
    // Replace @"y8Kyi0WNg40" with your YouTube video id
    [self.webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:[NSString stringWithFormat:@"%@%@", @"http://www.youtube.com/embed/", @"y8Kyi0WNg40"]]]];
}

// UIWebView delegate
- (void)webViewDidFinishLoad:(UIWebView *)webView {
    if (self.autoPlay) {
        self.autoPlay = NO;
        [self clickVideo];
    }
}

- (void)clickVideo {
    [self.webView stringByEvaluatingJavaScriptFromString:@"\
        function pollToPlay() {\
            var vph5 = document.getElementById(\"video-player\");\
            if (vph5) {\
                vph5.playVideo();\
            } else {\
                setTimeout(pollToPlay, 100);\
            }\
        }\
        pollToPlay();\
     "];
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-05T15:24:23.770

dharmabruce 解决方案在 iOS 6 上运行良好，但为了使其在 iOS 5.1 上运行，我不得不将 javascript click() 替换为 playVideo()，并且我必须将 UIWebView 的 mediaPlaybackRequiresUserAction 设置为 NO

这是修改后的代码：

```
- (void)viewDidLoad 
{
    [super viewDidLoad];
    self.webView.mediaPlaybackRequiresUserAction = NO;
}

- (void)playVideo
{
    self.autoPlay = YES;
    // Replace @"y8Kyi0WNg40" with your YouTube video id
    [self.webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:[NSString stringWithFormat:@"%@%@", @"http://www.youtube.com/embed/", @"y8Kyi0WNg40"]]]];
}

// UIWebView delegate
- (void)webViewDidFinishLoad:(UIWebView *)webView {
    if (self.autoPlay) {
        self.autoPlay = NO;
        [self clickVideo];
    }
}

- (void)clickVideo {
    [self.webView stringByEvaluatingJavaScriptFromString:@"\
        function pollToPlay() {\
            var vph5 = document.getElementById(\"video-player-html5\");\
            if (vph5) {\
                vph5.playVideo();\
            } else {\
                setTimeout(pollToPlay, 100);\
            }\
        }\
        pollToPlay();\
     "];
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-08T13:00:14.147

我已经解决了**dharmabruce**和**JimmY2K**的问题。解决方案，事实上它只在第一次播放视频时才有效，正如**Dee所提到的**

这是代码（包括视频结束时的事件）：

```
- (void)embedYouTube:(NSString *)urlString frame:(CGRect)frame {
    videoView = [[UIWebView alloc] init];
    videoView.frame = frame;
    videoView.delegate = self;

    [videoView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:urlString]]];// this format: http://www.youtube.com/embed/xxxxxx
    [self.view addSubview:videoView];

    //https://github.com/nst/iOS-Runtime-Headers/blob/master/Frameworks/MediaPlayer.framework/MPAVController.h
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(playbackDidEnd:)
                                                 name:@"MPAVControllerItemPlaybackDidEndNotification"//@"MPAVControllerPlaybackStateChangedNotification"
                                               object:nil];

}

- (void)webViewDidFinishLoad:(UIWebView *)webView {
    //http://stackoverflow.com/a/12504918/860488
    [videoView stringByEvaluatingJavaScriptFromString:@"\
                                    var intervalId = setInterval(function() { \
                                        var vph5 = document.getElementById(\"video-player\");\
                                        if (vph5) {\
                                            vph5.playVideo();\
                                            clearInterval(intervalId);\
                                        } \
                                    }, 100);"];
}

- (void)playbackDidEnd:(NSNotification *)note
{
    [videoView removeFromSuperview];
    videoView.delegate = nil;
    videoView = nil;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-26T07:11:20.237

未经测试，不确定这是否是问题所在，因为我不知道您使用的 URL。但是我偶然发现了以下内容：

> 从 iOS 6 开始，嵌入的 YouTube URL`http://www.youtube.com/watch?v=oHg5SJYRHA0`将不再有效。这些 URL 用于查看 YouTube 网站上的视频，而不是用于嵌入网页。相反，此处描述了应使用的格式：[https](https://developers.google.com/youtube/player_parameters) ://developers.google.com/youtube/player_parameters 。

来自[http://thetecherra.com/2012/09/12/ios-6-gm-released-full-changelog-inside/](http://thetecherra.com/2012/09/12/ios-6-gm-released-full-changelog-inside/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-02T13:48:40.977

我发现下面的代码适用于 iOS5 和 iOS6。在我的示例中，我有一个包含视频 url 的文本字段。我首先将格式转换为相同的起始字符串“http://m...”。然后我检查格式是否是带有 'watch?v=' 的旧格式，然后用新格式替换它. 我已经在 iOS5 的 iPhone 和 iOS5 和 iOS6 的模拟器中测试了这个：

```
-(IBAction)loadVideoAction {
    [activityIndicator startAnimating];

    NSString *urlString = textFieldView.text;
    urlString = [urlString stringByReplacingOccurrencesOfString:@"http://www.youtube" withString:@"http://m.youtube"];
    urlString = [urlString stringByReplacingOccurrencesOfString:@"http://m.youtube.com/watch?v=" withString:@""];
    urlString = [NSString stringWithFormat:@"%@%@", @"http://www.youtube.com/embed/", urlString];
    [webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:urlString]]];
}

- (void)webViewDidFinishLoad:(UIWebView *)webView
{
    [activityIndicator stopAnimating];
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-01T17:52:01.423

我正在解决同样的一般问题，我将分享我提出的方法。对于我的特殊情况，我还有一些问题需要解决，但一般方法可能对您有用，具体取决于您的 UI 要求。

如果您构建 HTML 嵌入代码以使 YouTube 播放器覆盖 UIWebView 的整个边界，则 UIWebView 有效地成为一个大播放按钮 - 触摸它表面上的任何位置都会使视频启动到本机媒体播放器中。要创建您的按钮，只需使用将 userInteractionEnabled 设置为 NO 的 UIView 覆盖 UIWebView。在这种情况下 UIWebView 的大小是否重要？不是真的，因为无论如何视频都会在本机播放器中打开。

如果您希望用户将 UI 的某个区域视为视频将要“播放”的位置，那么您可以从 YouTube 获取视频的缩略图并将其放置在任何位置。如果需要，您可以在该视图后面放置第二个 UIWebView，因此如果用户触摸该视图，视频也会启动 - 或者只是将另一个 UIWebView 展开，使其位于这两个视图的“后面”。

如果您发布您的 UI 的屏幕截图，我可以提出一些更具体的建议，但基本想法是通过在 UIWebView 前面放置一个禁用用户交互的视图来将其变成一个按钮。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-20T04:46:32.057

我相信问题是当 webViewDidFinishLoad 被触发时， UIButton 还没有添加到视图中。在回调返回后，我实现了一个小的延迟来找到按钮，它适用于我在 ios5 和 ios6 上。缺点是延迟后无法保证 UIButton 已准备好被找到。

```
- (void)autoplay {
    UIButton *b = [self findButtonInView:webView];
    [b sendActionsForControlEvents:UIControlEventTouchUpInside]; }

- (void)webViewDidFinishLoad:(UIWebView *)_webView {
    [self performSelector:@selector(autoplay) withObject:nil afterDelay:0.3]; } 
```

我不得不使用网址[http://www.youtube.com/watch?v=videoid](http://www.youtube.com/watch?v=videoid)这是它对我有用的唯一方法

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2012-09-24T06:54:06.330

```
- (void) performTapInView: (UIView *) view {
    BOOL found = NO;
    if ([view gestureRecognizers] != nil) {
        for (UIGestureRecognizer *gesture in  [view gestureRecognizers]) {
            if ([gesture isKindOfClass: [UITapGestureRecognizer class]]) {
                if ([gesture.view respondsToSelector: @selector(_singleTapRecognized:)]) {
                    found = YES;
                    [gesture.view performSelector: @selector(_singleTapRecognized:) withObject: gesture afterDelay: 0.07];
                    break;
                }
            }
        }
    }

    if (!found) {
        for (UIView *v in view.subviews) {
            [self performTapInView: v];
        }
    }
}
#pragma mark - UIWebViewDelegate methods
- (void) webViewDidFinishLoad: (UIWebView *) webView {
    if (findWorking) {
        return;
    }
    findWorking = YES;
    [self performTapInView: webView];
} 
```

# java - 找不到符号：Java

> ID：12462057
> 
> 赞同：-1
> 
> 时间：2012-09-17T15:02:56.040
> 
> 标签：java, oop, symbols

如果这是一个奇怪的问题，我很抱歉，但我刚刚开始 OOP 并遇到了这个问题，因为我应该制作一个简单的菜单驱动数学程序。我清除了编译器给我的所有错误，但现在它给了我大约 14 个新错误，其中大部分被描述为“找不到符号”。这是我的代码：

```
import java.util.Scanner;

public class MathMenu
{

//MENU METHOD
private static void menu(String args[])
{
int choice;

System.out.printf("Enter '1' to add");
System.out.printf("Enter '2' to subtract");
System.out.printf("Enter '3' to exit");

System.out.printf("\nPlease enter your choice: ");

choice=input.nextInt();

if (choice==1)
sum(n,m);

if (choice==2)
dif(n,m);

else if(choice==3)
return;

}

//SUM
private static int sum(int a, int b)
{
return n+m;
}

//DIFFERENCE 
private static int dif(int a, int b)
{
if(n<m)
return m-n;

else
return n-m;
}

public static void main(String args[])
{

int n=15;
int m=8;

Scanner input = new Scanner(System.in);

menu();

}

} 
```

这是新的编译器输出：

```
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Users\Shahraiz Tabassam>cd c:\java\bin

c:\java\bin>javac MathMenu.java
MathMenu.java:7: error: no suitable constructor found for Scanner()
private static Scanner input = new Scanner();
                               ^
    constructor Scanner.Scanner(ReadableByteChannel,String) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(ReadableByteChannel) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(String) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(Path,Charset) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(Path,String) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(Path) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(File,CharsetDecoder) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(File,String) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(File) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(InputStream,String) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(InputStream) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(Readable) is not applicable
      (actual and formal argument lists differ in length)
    constructor Scanner.Scanner(Readable,Pattern) is not applicable
      (actual and formal argument lists differ in length)
MathMenu.java:64: error: method menu in class MathMenu cannot be applied to give
n types;
menu();
^
  required: String[]
  found: no arguments
  reason: actual and formal argument lists differ in length
2 errors

c:\java\bin> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:04:41.217

您的所有函数都获取名为**a & b 的**参数，但可以使用**n & m**。改变其中之一。例如：

```
private static int sum(int n, int m)
{
    return n+m;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:04:49.097

您没有`input`在程序中定义，而是调用

> 选择=输入.nextInt();

假设你想从用户那里得到输入，你需要有

```
Scanner input = new Scanner(System.in) 
```

就在之前`choice=input.nextInt();`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:06:32.520

你从来没有`input`在方法体中定义你的变量`menu`。尝试`Scanner input = new Scanner(System.in)`在`menu`方法中添加。简单地定义变量 in`main`并**不能**`menu`访问它。如果您想避免`Scanner`多次创建实例，您可以执行类似的操作

```
import java.util.Scanner;

public class MathMenu {
    private static Scanner input = new Scanner(System.in);
    ...
} 
```

然后你可以使用你`input`所有的方法。

* * *

**编辑**：我刚刚注意到与和类似的东西`m`：`n`您必须在使用它们的方法中定义它们，或者使它们成为`static`字段。如果由我决定，我会这样做：

```
import java.util.Scanner;

public class MathMenu {
    private static Scanner input = new Scanner(System.in);
    private static int n = 15;
    private static int m = 8;

    // ...
    // your other methods unchanged
    // ...

    public static void main(String[] args) {
        menu(args);  // or just "menu()" if you remove the arguments from the menu method declaration.
    }
} 
```

# java - 媒体播放器和完成（）方法

> ID：12462069
> 
> 赞同：0
> 
> 时间：2012-09-17T15:03:35.867
> 
> 标签：java, android

我只是在 android 中测试媒体播放器，我在 onCreate 方法中启动了一个流，并且我有一个调用 finish() 方法的按钮。单击按钮后，即使活动已关闭，我仍然可以听到流播放的声音，我想知道这是否是某种泄漏，我必须在调用 finish() 方法之前先停止播放器，或者如果 finish()方法实际上并没有完全杀死应用程序以释放资源。感谢您阅读

```
 public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.activity_main);
            Button add_function,exit_btn;   
            add_function = (Button) findViewById(R.id.view_chat);
            exit_btn = (Button) findViewById(R.id.exit_btn);

            MediaPlayer mp = new MediaPlayer();
            String URL_OF_FILE = "http://stream.radiosai.net:8002/";
    try {
        mp.setDataSource(URL_OF_FILE);
         mp.prepare();
    } catch (IllegalArgumentException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (SecurityException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IllegalStateException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

            mp.start();

        exit_btn.setOnClickListener(new View.OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                finish();
            }
        });
             }// EOF ONCREATE 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:12:56.077

调用`finish()`不会杀死应用程序，它只会破坏`Activity`您正在完成的电流。尽管我认为完成 Activity 会停止`MediaPlayer`，但在这种情况下您可能应该做的是 override `onDestroy()`，并在那里释放您的`MediaPlayer`对象。例如：

```
@Override
public void onDestroy() {
    if(mediaPlayer != null) mediaPlayer.release();
    super.onDestroy();
} 
```

# java - 用于验证内置 XSD 类型的正则表达式或库？

> ID：12462072
> 
> 赞同：4
> 
> 时间：2012-09-17T15:03:43.163
> 
> 标签：java, xml, regex, xsd

XML Schema 规范定义了许多内置数据类型[http://www.w3.org/TR/xmlschema-2/#built-in-datatypes](http://www.w3.org/TR/xmlschema-2/#built-in-datatypes)是否有 Java 库可以回答有关天气的问题，值是特定数据类型。顺其自然。

```
if(XSDValidator.isXSDDate("2012-06-12") == false) { 
    // return error 
} 
```

***更新：*** 这个用例不是在 XML 的上下文中，而是在我有一个我想要符合其中一种 XSD 类型的字符串并且我想要一种标准方法来检查它是否符合的情况下。例如，字符串可以是我从传入的 JSON 请求中提取的值，也可以是从 URL 或任何其他地方提取的值……等等。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T23:29:27.530

以下是您可能使用的 JDK/JRE 中可用的一些类：

**javax.xml.datatype.XMLGregorianCalendar**

对于日期/时间类型，您可以使用`javax.xml.datatype.XMLGregorianCalendar`自 Java SE 5 起包含在 JDK/JRE 中的日期/时间类型。

```
DatatypeFactory df = DatatypeFactory.newInstance();
XMLGregorianCalendar xgc = df.newXMLGregorianCalendar("2012-06-18");
return DatatypeConstants.DATE.equals(xgc.getXMLSchemaType()); 
```

**javax.xml.bind.DatatypeConveter**

还有`javax.xml.bind.DatatypeConveter`一个会抛出一个`IllegalArgumentException`错误的值：

```
DatatypeConverter.parseDate("2012-06-18"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T22:24:25.283

这是一个使用[Xerces](http://xerces.apache.org/)解析器/验证器的解决方案。但是它使用`.impl`类。这些不是公共 API 的一部分，可能会发生变化。但如果你坚持某个版本，你应该没问题。

一、依赖：

```
<dependency>
    <groupId>xerces</groupId>
    <artifactId>xerces</artifactId>
    <version>2.4.0</version>
</dependency> 
```

这是一个像你描述的那样工作的小程序：

```
import org.apache.xerces.impl.dv.InvalidDatatypeValueException;
import org.apache.xerces.impl.dv.xs.DateDV;

public class XSDValidator {

    public static void main(final String[] args) {
        System.out.println(isXSDDate("2012-09-18"));
        System.out.println(isXSDDate("Hello World"));
    }

    private static boolean isXSDDate(final String string) {
        try {
            new DateDV().getActualValue(string);
            return true;
        } catch(final InvalidDatatypeValueException e) {
            return false;
        }
    }
} 
```

输出：

```
true
false 
```

您自己要做的就是为每种数据类型创建方法。您应该能够在[org.apache.xerces.impl.dv.xs](http://xerces.apache.org/xerces2-j/javadocs/xerces2/org/apache/xerces/impl/dv/xs/package-summary.html)包中找到所有必需的类。

同样，这有点滥用 Xerces 库，因为这些类不是公共 API 的一部分。因此，如果您找到另一个更清洁的解决方案，请告诉我们。

# python - Python argparse：从参数创建 timedelta 对象？

> ID：12462074
> 
> 赞同：7
> 
> 时间：2012-09-17T15:03:55.203
> 
> 标签：python, argparse, timedelta

我正在尝试使用`argparse`将参数转换为`timedelta`对象。我的程序读取用户提供的字符串并将它们转换为各种`datetime`对象以供以后使用。我无法`filter_length`正确处理参数。我的代码：

```
import datetime
import time
import argparse

def mkdate(datestring):
    return datetime.datetime.strptime(datestring, '%Y-%m-%d').date()

def mktime(timestring):
    return datetime.datetime.strptime(timestring, '%I:%M%p').time()

def mkdelta(deltatuple):
    return datetime.timedelta(deltatuple)

parser = argparse.ArgumentParser()
parser.add_argument('start_date', type=mkdate, nargs=1)
parser.add_argument('start_time', type=mktime, nargs=1, )
parser.add_argument('filter_length', type=mkdelta, nargs=1, default=datetime.timedelta(1))#default filter length is 1 day. 
```

我运行程序，`1`作为`timedelta`值传递（我只希望它是一天）：

```
> python program.py 2012-09-16 11:00am 1 
```

但我收到以下错误：

```
>>> program.py: error: argument filter_length: invalid mkdelta value: '1' 
```

我不明白为什么该值无效。如果我自己调用 mkdelta 函数，如下所示：

```
mkdelta(1)
print mkdelta(1) 
```

它返回：

```
datetime.timedelta(1)
1 day, 0:00:00 
```

这正是我正在寻找的价值。有人可以帮我弄清楚如何正确使用这种转换`argparse`吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T15:07:13.883

`'1'`注意到错误消息中的引号了吗？您将一个字符串传递给 mkdelta，而在您的测试代码中，您传递一个整数。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-17T15:06:04.463

您的函数不处理字符串参数，而 argparse 正在处理它；调用`int()`它：

```
def mkdelta(deltatuple):
    return datetime.timedelta(int(deltatuple)) 
```

如果您需要支持超过几天，则必须找到一种方法来解析传入 timedelta 参数的参数。

例如，您可以支持、`d`或后缀来表示天、小时、分钟或秒：`h``m``s`

```
_units = dict(d=60*60*24, h=60*60, m=60, s=1)
def mkdelta(deltavalue):
    seconds = 0
    defaultunit = unit = _units['d']  # default to days
    value = ''
    for ch in list(str(deltavalue).strip()):
        if ch.isdigit():
            value += ch
            continue
        if ch in _units:
            unit = _units[ch]
            if value:
                seconds += unit * int(value)
                value = ''
                unit = defaultunit
            continue
        if ch in ' \t':
            # skip whitespace
            continue
        raise ValueError('Invalid time delta: %s' % deltavalue)
    if value:
        seconds = unit * int(value)
    return datetime.timedelta(seconds=seconds) 
```

现在您的`mkdelta`方法接受更完整的增量，甚至仍然是整数：

```
>>> mkdelta('1d')
datetime.timedelta(1)
>>> mkdelta('10s')
datetime.timedelta(0, 10)
>>> mkdelta('5d 10h 3m 10s')
datetime.timedelta(5, 36190)
>>> mkdelta(5)
datetime.timedelta(5)
>>> mkdelta('1')
datetime.timedelta(1) 
```

默认单位是天。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-17T17:14:34.617

您可以使用自定义操作来收集所有剩余的 args 并将它们解析为`timedelta`.

这将允许您编写 CLI 命令，例如

```
% test.py 2012-09-16 11:00am 2 3 4 5
datetime.timedelta(2, 3, 5004)   # args.filter_length 
```

您还可以为 , 等提供可选参数`--days`，`--seconds`因此您可以编写 CLI 命令，例如

```
% test.py 2012-09-16 11:00am --weeks 6 --days 0
datetime.timedelta(42)           # args.filter_length

% test.py 2012-09-16 11:00am --weeks 6.5 --days 0
datetime.timedelta(45, 43200) 
```

* * *

```
import datetime as dt
import argparse

def mkdate(datestring):
    return dt.datetime.strptime(datestring, '%Y-%m-%d').date()

def mktime(timestring):
    return dt.datetime.strptime(timestring, '%I:%M%p').time()

class TimeDeltaAction(argparse.Action):
    def __call__(self, parser, args, values, option_string = None):
        # print '{n} {v} {o}'.format(n = args, v = values, o = option_string)
        setattr(args, self.dest, dt.timedelta(*map(float, values)))

parser = argparse.ArgumentParser()
parser.add_argument('start_date', type = mkdate)
parser.add_argument('start_time', type = mktime)
parser.add_argument('--days', type = float, default = 1)
parser.add_argument('--seconds', type = float, default = 0)
parser.add_argument('--microseconds', type = float, default = 0)
parser.add_argument('--milliseconds', type = float, default = 0)
parser.add_argument('--minutes', type = float, default = 0)
parser.add_argument('--hours', type = float, default = 0)
parser.add_argument('--weeks', type = float, default = 0)
parser.add_argument('filter_length', nargs = '*', action = TimeDeltaAction)

args = parser.parse_args()
if not args.filter_length:
    args.filter_length = dt.timedelta(
        args.days, args.seconds, args.microseconds, args.milliseconds,
        args.minutes, args.hours, args.weeks)
print(repr(args.filter_length)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-11T10:30:27.973

这个要点似乎解决了你的问题：[https ://gist.github.com/jnothman/4057689](https://gist.github.com/jnothman/4057689)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-22T12:40:58.527

以防万一有人来到这里希望将 a 添加`pandas.Timedelta`到参数解析器（就像我刚才所做的那样），结果证明以下工作正常：

```
parser = argparse.ArgumentParser()
parser.add_argument('--timeout', type=pd.Timedelta) 
```

然后：

```
>>> parser.parse_args(['--timeout', '24 hours'])
Namespace(timeout=Timedelta('1 days 00:00:00')) 
```

# java - struts 2 多文件上传保存路径到数据库

> ID：12462075
> 
> 赞同：1
> 
> 时间：2012-09-17T15:03:56.353
> 
> 标签：java, file-upload, struts2

我有一个巨大的表格，其中正在上传多个不同类型的文档。在 Struts 2 中使用 struts 的多文件上传逻辑执行相同的操作。

```
private File[] upload;

private String[] uploadFileName; 
```

这些是我的类（动作）的参数。根据类，表单字段的名称必须是“上传”。

```
<s:file name="upload" type="file" id="file_photo"/>
<s:file name="upload" type="file" id="resume"/>
<s:file name="upload" type="file" id="result1"/>
<s:file name="upload" type="file" id="result2"/>
<s:file name="upload" type="file" id="result3"/> 
```

（某些字段可能是可选的上传）使用 copyFile 正确上传文件。但是在上传 [] 数组中，我如何知道哪个文件属于哪个参数，因为它们具有相同的名称“上传”，因为我需要将文件名保存到数据库。

请指教。

# java - Toolkit.getDefaultToolkit() 的使用

> ID：12462076
> 
> 赞同：0
> 
> 时间：2012-09-17T15:04:06.327
> 
> 标签：java

这段代码是用来设置JFrame的图标的

```
this.setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/Eserver/Dictionaryicon.png"))); 
```

这里 Toolkit.getDefaultToolkit() 有什么用

# c++ - 我怎么知道两个功能的成本？

> ID：12462078
> 
> 赞同：-4
> 
> 时间：2012-09-17T15:04:08.723
> 
> 标签：c++

如何计算 2 功能的成本：例如执行功能的时间和内存大小、功能 1 的保留和可用性以及功能 2 的相同

假设我使用了这段代码：

```
#include<iostream>

using namespace std;
    int factorial(int n);
    int factorial2(int n);

    int main ()
    {
                int n1,fact,fact2;
                cout <<"Enter the number whose factorial has to be calculated" <<  endl;
                cin >> n1;
                fact=factorial(n1);
                fact2=factorial2(n2);
                cout << "The factorial of " << n1 << "  is : " << fact << endl;
                return(0);      

    }

    int factorial(int n){
                int i=0,fact=1;
                if(n<=1)
                {
                            return(1);
                }
                else
                {
                            for(i=1;i<=n;i++)
                            {
                                        fact=fact*i;
                            }
                            return(fact);
                }
    }
    int factorial2(int n){
                int i=0,fact=1;
                if(n<=1)
                {
                            return(1);
                }
                else
                {
                            for(i=1;i<=n;i++)
                            {
                                        fact=fact*i;
                            }
                            return(fact);
                }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:14:11.147

[根据本文](http://rosettacode.org/wiki/Time_a_function#C)的描述，您可以使用该`clock_gettime()`函数来测量执行时间。

# java - 通过 varargs 参数可能造成的堆污染

> ID：12462079
> 
> 赞同：509
> 
> 时间：2012-09-17T15:04:12.357
> 
> 标签：java, eclipse, generics, variadic-functions

我知道在使用泛型类型的可变参数时，Java 7 会发生这种情况；

但我的问题是..

当 Eclipse 说“它的使用可能会污染堆”时，它到底是什么意思？

和

`@SafeVarargs`新注释如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：297
> 
> 时间：2012-09-17T15:16:02.623

堆污染是一个技术术语。它指的是类型不是它们指向的对象的超类型的引用。

```
List<A> listOfAs = new ArrayList<>();
List<B> listOfBs = (List<B>)(Object)listOfAs; // points to a list of As 
```

这可能导致“无法解释” `ClassCastException`。

```
// if the heap never gets polluted, this should never throw a CCE
B b = listOfBs.get(0); 
```

`@SafeVarargs`根本不阻止这一点。但是，有些方法可以证明不会污染堆，编译器无法证明。以前，此类 API 的调用者会收到令人讨厌的警告，这些警告完全没有意义，但必须在每个调用站点都被抑制。现在 API 作者可以在声明站点将其禁止一次。

但是，如果该方法实际上*不安全*，则将不再警告用户。

* * *

## 回答 #2

> 赞同：286
> 
> 时间：2013-05-05T04:25:46.737

当你声明

`public static <T> void foo(List<T>... bar)`编译器将其转换为

`public static <T> void foo(List<T>[] bar)`然后到

`public static void foo(List[] bar)`

然后就会出现危险，您会错误地将不正确的值分配到列表中，并且编译器不会触发任何错误。例如，如果`T`是 a`String`那么下面的代码将编译没有错误，但会在运行时失败：

```
// First, strip away the array type (arrays allow this kind of upcasting)
Object[] objectArray = bar;

// Next, insert an element with an incorrect type into the array
objectArray[0] = Arrays.asList(new Integer(42));

// Finally, try accessing the original array. A runtime error will occur
// (ClassCastException due to a casting from Integer to String)
T firstElement = bar[0].get(0); 
```

如果您查看了该方法以确保它不包含此类漏洞，那么您可以对其进行注释`@SafeVarargs`以抑制警告。对于接口，使用`@SuppressWarnings("unchecked")`.

如果您收到此错误消息：

> Varargs 方法可能会导致不可具体化的 varargs 参数造成堆污染

并且您确定您的使用是安全的，那么您应该使用它`@SuppressWarnings("varargs")`。请参阅[@SafeVarargs 是此方法的适当注释吗？](https://stackoverflow.com/q/30130262/14731)和[https://stackoverflow.com/a/14252221/14731](https://stackoverflow.com/a/14252221/14731)很好地解释了第二种错误。

参考：

*   [http://docs.oracle.com/javase/7/docs/technotes/guides/language/non-reifiable-varargs.html](http://docs.oracle.com/javase/7/docs/technotes/guides/language/non-reifiable-varargs.html)
*   [http://docs.oracle.com/javase/tutorial/java/generics/nonReifiableVarargsType.html#heap_pollution](http://docs.oracle.com/javase/tutorial/java/generics/nonReifiableVarargsType.html#heap_pollution)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-17T15:14:33.780

`@SafeVarargs`不会阻止它的发生，但是它要求编译器在编译使用它的代码时更加严格。

[http://docs.oracle.com/javase/7/docs/api/java/lang/SafeVarargs.html](http://docs.oracle.com/javase/7/docs/api/java/lang/SafeVarargs.html)更详细地解释了这一点。

堆污染是当您`ClassCastException`在泛型接口上执行操作时得到一个，并且它包含另一种类型而不是声明的类型。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-09-17T15:21:56.513

当您使用可变参数时，它可能会导致创建一个`Object[]`来保存参数。

由于逃逸分析，JIT 可以优化掉这个数组创建。（我发现它的少数几次之一）它不能保证被优化掉，但我不会担心它，除非你在你的内存分析器中看到它的问题。

AFAIK`@SafeVarargs`禁止编译器发出警告，并且不会更改 JIT 的行为方式。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-26T23:05:58.950

原因是可变参数提供了使用非参数化对象数组调用的选项。因此，如果您的类型是 List < A > ... ，也可以使用 List[] 非可变参数类型调用它。

这是一个例子：

```
public static void testCode(){
    List[] b = new List[1];
    test(b);
}

@SafeVarargs
public static void test(List<A>... a){
} 
```

如您所见， List[] b 可以包含任何类型的消费者，但此代码可以编译。如果你使用可变参数，那么你很好，但是如果你在类型擦除之后使用方法定义 - void test(List[]) - 那么编译器将不会检查模板参数类型。@SafeVarargs 将禁止显示此警告。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-01-07T12:03:40.833

`@SafeVarargs`当您可以控制方法的调用方式（例如类的私有方法）时，向方法添加注释是相当安全的。您必须确保仅将声明的泛型类型的实例传递给该方法。

如果将方法作为库暴露在外部，就很难捕捉到这样的错误。在这种情况下，最好避免使用此注释并使用集合类型（例如`Collection<Type1<Type2>>`）输入而不是 varargs ( `Type1<Type2>...`) 重写解决方案。

至于命名，在我看来，*堆污染*现象这个词颇具误导性。在[文档](https://docs.oracle.com/javase/tutorial/java/generics/nonReifiableVarargsType.html)中没有提到实际的 JVM*堆。*软件工程有一个[问题](https://softwareengineering.stackexchange.com/questions/155994/java-heap-pollution)，其中包含一些关于这种现象命名的有趣想法。

# html - 有没有办法在 iPad 上使用 CSS 设置 optgroup 样式？

> ID：12462081
> 
> 赞同：0
> 
> 时间：2012-09-17T15:04:14.997
> 
> 标签：html, css, ipad

有没有办法使用 CSS 设置 HTML 元素“optgroup”的样式？样式出现在 iPad 的移动 iOS 浏览器上尤为重要。

HTML 是：

```
 <optgroup label="Great Britain">
    <option value="EUROPE_ENGLAND">England</option>
    <option value="EUROPE_SCOTLAND">Scotland</option>
    <option value="EUROPE_WALES">Wales</option>
 </optgroup> 
```

CSS是：

```
optgroup {
  color: red;
} 
```

顺便说一句，我什至不确定是否可以设置 iPad 的 optgroup 样式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:10:16.883

不幸的是，没有办法做到这一点。iPad Safari 完全控制样式选择列表的内部内容。这是验证的参考：[little link](https://stackoverflow.com/questions/3006647/list-of-known-safari-on-ipad-differences-over-desktop-safari)。

实现此目的的一种方法是使用 JavaScript 模拟下拉/选择菜单。这不是很可取，但是如果您需要更改默认样式，那么恐怕这是唯一的方法；这是一个演示，可以让您了解如何进行模拟：[另一个小链接](http://jsfiddle.net/glee/963ax/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:06:37.967

您可以通过 css 对其进行样式设置：

```
 optgroup {
  font-style: italic;
 } 
```

[http://jsfiddle.net/9VzV6/](http://jsfiddle.net/9VzV6/)

如果需要，您还可以向每个 optgroup 标记添加类/ID。

# javascript - 在 Ruby on Rails 中显示 AJAX 页面的“加载时间”秒数

> ID：12462084
> 
> 赞同：0
> 
> 时间：2012-09-17T15:04:24.540
> 
> 标签：javascript, ajax, ruby-on-rails-3

我的页面由一个非常简单的表组成，该表从数据库中提取数据。我拥有的页面加载时间在我拥有的应用程序控制器中

```
def set_start_time
  @start_time = Time.now.usec
end 
```

然后在我的页面上

> 页面渲染：<%= sprintf('%.3f', (Time.now.usec - @start_time).abs / 1000000.0) %> 秒

但是，因为表格与页面分开加载，所以我无法获得我想要的实际加载时间的数字。IE 用户加载 100 条记录需要多长时间（无需查看服务器日志）。我怎样才能做到这一点？

理想情况下，我想将其显示在页面顶部

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:42:36.877

我不确定您是否想通过 ruby​​ 执行此操作，您可以使用 ajax 轻松完成此操作。

```
var start_time = new Date.getTime();  // getTime gives you timestamp
$.ajax({
  url: YOUR_URL,
  success: function() {
   // Do what you want on succee of this function 
  }
  error: function(){
  // Do what you want on error
  }
  complete: function(){
  // This function is triggered on completion of ajax call
  end_time = new Date.getTime();
  diff_time = end_time -start_time;
  $(selector).html(diff_time);  // selector is place where you want to display time
  }
}); 
```

我想这会对你有所帮助。

谢谢

# ruby-on-rails - NoMethodError（未定义的方法“body”用于# ):

> ID：12462086
> 
> 赞同：0
> 
> 时间：2012-09-17T15:04:28.077
> 
> 标签：ruby-on-rails, ruby, callback, mongoid, activeresource

得到一个源自 ActiveResource 标准 Rails 库的模糊错误。Rails 中导致此问题的行与输出一起在下面给出。请问如何解决这个问题？

```
class Search < ActiveResource::Nestful::Base

  self.collection_name = "search"

  schema do
    string :type
    object :event
  end

def self.query(params)
   find(:all, :params => params)
end

def self.per_page
  3
end

def record
  attributes[attributes["type"]]
end
end 
```

输出

```
Started GET "/search?utf8=%E2%9C%93&q=Hammersmith&location=&commit=Search" for 127.0.0.1         at 2012-09-17 15:10:53 +0100
Processing by SearchController#index as HTML
Parameters: {"utf8"=>"✓", "q"=>"Hammersmith", "location"=>"", "commit"=>"Search"}
Completed 500 Internal Server Error in 2343247ms

NoMethodError (undefined method `body' for #<Hash:0xbc3ee74>):
 activeresource (3.2.8) lib/active_resource/base.rb:901:in `find_every'
 activeresource (3.2.8) lib/active_resource/base.rb:814:in `find'
 app/models/search.rb:12:in `query'
 app/controllers/search_controller.rb:14:in `index'
 actionpack (3.2.8) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
 actionpack (3.2.8) lib/abstract_controller/base.rb:167:in `process_action'
 actionpack (3.2.8) lib/action_controller/metal/rendering.rb:10:in `process_action'
 actionpack (3.2.8) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
 activesupport (3.2.8) lib/active_support/callbacks.rb:426:in `block in      _run__1005704495__process_action__837521650__callbacks'
 activesupport (3.2.8) lib/active_support/callbacks.rb:215:in `block in _conditional_callback_around_208'
 app/controllers/application_controller.rb:55:in `block in with_oauth'
 /home/jaygemang/.rvm/gems/ruby-1.9.3-p194/bundler/gems/activeresource-nestful-3b28ffcfe788/lib/active_resource/nestful.rb:15:in `oauth' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:07:50.263

我会进去看看`app/models/search.rb:12:in `query'`

# macos - 使用 Homebrew 在 OSX Mountain Lion 上配置 PHPMyAdmin

> ID：12462087
> 
> 赞同：0
> 
> 时间：2012-09-17T15:04:28.427
> 
> 标签：macos, phpmyadmin, homebrew

我正在 OSX Mountain Lion 上设置本地 Web 服务器。我目前正在使用 OSX 附带的 PHP 版本，并且已经使用 Homebrew ( [http://mxcl.github.com/homebrew/](https://brew.sh/) ) 安装了 MySQL 和 Apache。

服务器运行良好，但我很难安装 PHPMyAdmin。Homebrew 似乎已将 PHPMyAdmin 文件下载到`/usr/local/Cellar/phpmyadmin/3.5.2.1/share/phpmyadmin`，但尽管遵循了几个教程，但我无法`http://localhost/~jim/phpmyadmin`（`http://localhost/~jim/`是我的 webroot）指向该目录。

我猜这个问题与 httpd.conf 或虚拟主机配置文件有关，但我不确定如何配置这些以获得我想要的结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-25T06:31:15.253

运行后请阅读自制程序输出`homebrew install phpmyadmin` 的消息消息输出实际上告诉您该怎么做。这是消息的相关部分。

```
Webserver configuration example (add this at the end of
your /etc/apache2/httpd.conf for instance) :

Alias /phpmyadmin /usr/local/share/phpmyadmin
<Directory /usr/local/share/phpmyadmin/>
Options Indexes FollowSymLinks MultiViews
AllowOverride All
Order allow,deny
Allow from all
</Directory>

Then, open http://localhost/phpmyadmin

More documentation : file:///usr/local/Cellar/phpmyadmin/4.0.4/share/phpmyadmin/Documentation.html 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-30T16:18:37.167

试试`http://localhost/phpMyAdmin`。默认情况下，它不应安装在您的主目录中。

# c# - 使 XslCompiledTransform 忽略脚本

> ID：12462090
> 
> 赞同：1
> 
> 时间：2012-09-17T15:04:35.510
> 
> 标签：c#, xml, exception, xslt

有一个包含以下内容的 XSL 文件：

```
<xsl:stylesheet version="2.0" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:XQHeaderFunc="java:com.sonicsw.xq.service.xform.HeaderExtension"
    xmlns:saxon="http://saxon.sf.net/"
    exclude-result-prefixes="XQHeaderFunc saxon">

    <saxon:script language="java" implements-prefix="XQHeaderFunc" src="java:com.sonicsw.xq.service.xform.HeaderExtension" /> 
```

稍后在文件中：

```
<xsl:variable name="processId" select="XQHeaderFunc:getProperty(XQHeaderFunc:new(),'processId',-1)" /> 
```

当我现在尝试进行转换时，出现此错误：

> 找不到与命名空间“java:com.sonicsw.xq.service.xform.HeaderExtension”关联的脚本或扩展对象。

这是我不关心的一些 SonicMQ 特定的东西。有没有办法我可以以某种方式忽略它？

* * *

我目前做这样的转换：

```
var readerSettings = new XmlReaderSettings
{
    ConformanceLevel = ConformanceLevel.Document,
    IgnoreWhitespace = true,
    IgnoreComments = true,
    IgnoreProcessingInstructions = true,
    CheckCharacters = true,
};

var writerSettings = new XmlWriterSettings
{
    Encoding = Encoding.UTF8,
    ConformanceLevel = ConformanceLevel.Document,
    NewLineHandling = NewLineHandling.Replace,
    OmitXmlDeclaration = false,
    NewLineChars = "\r\n",
    Indent = true,
    IndentChars = "  ",
    CloseOutput = false,
};

var xsl = new XslCompiledTransform(System.Diagnostics.Debugger.IsAttached);
using (var stylesheet = XmlReader.Create(xslFile, readerSettings))
    xsl.Load(stylesheet);

using (var result = new MemoryStream())
{
    using (var xml = XmlReader.Create(xmlFile, readerSettings))
    using (var xmlWriter = XmlWriter.Create(result, writerSettings))
    {
        xsl.Transform(xml, xmlWriter);
    }

    // Deal with result
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T16:44:08.297

XSLT 文件是动态提供的，还是您可以手动修改的单个文件？

如果是后者，可以用这个来防止自定义函数报错：

```
<xsl:variable name="processId">
  <xsl:if test="function-available('XQHeaderFunc:getProperty') and function-available('XQHeaderFunc:new)">
    <xsl:value-of select="XQHeaderFunc:getProperty(XQHeaderFunc:new(),'processId',-1)" />
  </xsl:if>
</xsl:variable> 
```

如果函数不可用，这将导致 processId 为空。要替换默认值，您可以这样做

```
<xsl:variable name="processId">
  <xsl:choose>
    <xsl:when test="function-available('XQHeaderFunc:getProperty') and function-available('XQHeaderFunc:new)">
      <xsl:value-of select="XQHeaderFunc:getProperty(XQHeaderFunc:new(),'processId',-1)" />
    </xsl:when>
    <xsl:otherwise>
      Default Value
    </xsl:otherwise>
  </xsl:choose>
</xsl:variable> 
```

# extjs - 在 ExtJS 中，惰性实例化的反义词叫什么？

> ID：12462099
> 
> 赞同：1
> 
> 时间：2012-09-17T15:04:52.670
> 
> 标签：extjs

我不知道如何在 ExtJS 中调用对象的“非惰性”实例化......它可以称为标准实例化吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:07:24.223

惰性初始化的相反术语是**急切初始化**。

急切初始化本质上是在您要求时计算任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-04T15:47:02.803

渴望实例化用于将数据加载到选项卡中。如果以及当用户单击选项卡时，具有选项卡面板的应用程序将加载选项卡。此时，建议在加载选项卡时使用急切初始化。

# c# - 实体框架迁移中必填字段的默认值？

> ID：12462100
> 
> 赞同：94
> 
> 时间：2012-09-17T15:04:53.567
> 
> 标签：c#, asp.net-mvc, entity-framework, ef-code-first

我已将数据注释添加到[ASP.NET MVC 应用程序](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/adding-validation-to-the-model)`[Required]`中的一个模型中。创建迁移后，运行命令会导致以下错误：`Update-Database`

> 无法将值 NULL 插入列“导演”，表“MOVIES_cf7bad808fa94f89afa2e5dae1161e78.dbo.Movies”；列不允许空值。更新失败。该语句已终止。

这是由于某些记录在其`Director`列中具有 NULL。如何自动将这些值更改为某个默认值（比如“John Doe”）导演？

这是我的模型：

```
 public class Movie
    {
        public int ID { get; set; }
        [Required]
        public string Title { get; set; }

        [DataType(DataType.Date)]
        public DateTime ReleaseDate { get; set; }

        [Required]
        public string Genre { get; set; }

        [Range(1,100)]
        [DataType(DataType.Currency)]
        public decimal Price { get; set; }

        [StringLength(5)]
        public string Rating { get; set; }

        [Required]     /// <--- NEW
        public string Director { get; set; }
    } 
```

这是我最新的迁移：

```
public partial class AddDataAnnotationsMig : DbMigration
{
    public override void Up()
    {
        AlterColumn("dbo.Movies", "Title", c => c.String(nullable: false));
        AlterColumn("dbo.Movies", "Genre", c => c.String(nullable: false));
        AlterColumn("dbo.Movies", "Rating", c => c.String(maxLength: 5));
        AlterColumn("dbo.Movies", "Director", c => c.String(nullable: false));
    }

    public override void Down()
    {
        AlterColumn("dbo.Movies", "Director", c => c.String());
        AlterColumn("dbo.Movies", "Rating", c => c.String());
        AlterColumn("dbo.Movies", "Genre", c => c.String());
        AlterColumn("dbo.Movies", "Title", c => c.String());
    }
} 
```

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2013-04-09T18:05:30.967

除了来自@webdeveloper 和@Pushpendra 的回答之外，您还需要手动向迁移添加更新以更新现有行。例如：

```
public override void Up()
{
    Sql("UPDATE [dbo].[Movies] SET Title = 'No Title' WHERE Title IS NULL");
    AlterColumn("dbo.Movies", "Title", c => c.String(nullable: false,defaultValue:"MyTitle"));
} 
```

这是因为`AlterColumn`生成 DDL 以将列的默认值设置为表规范中的某个特定值。DDL 不会影响数据库中的现有行。

您实际上同时进行了两项更改（设置默认值并使列 NOT NULL）并且它们中的每一个都单独有效，但是由于您同时进行了这两项更改，因此您可以期望系统'智能地'实现您的意图并将所有`NULL`值设置为默认值，但这并不是一直期望的。

假设您只是设置列的默认值，而不是使其变为 NOT NULL。您显然不希望使用您提供的默认值更新所有 NULL 记录。

所以，在我看来，这不是一个错误，我不希望 EF 以我没有明确告诉它这样做的方式更新我的数据。开发人员负责指示系统如何处理数据。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2012-09-17T15:19:39.150

如果我没记错的话，这样的事情应该可以工作：

```
AlterColumn("dbo.Movies", "Director", c => c.String(nullable: false, defaultValueSql: "'John Doe'")); 
```

注意：defaultValueSql 参数值被视为逐字 SQL 语句，因此如果所需的值实际上是一个字符串，如 John Doe 示例，则需要在值周围加上单引号。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-09-17T17:40:25.487

```
public partial class AddDataAnnotationsMig : DbMigration
{
    public override void Up()
    {
        AlterColumn("dbo.Movies", "Title", c => c.String(nullable: false,defaultValue:"MyTitle"));
        AlterColumn("dbo.Movies", "Genre", c => c.String(nullable: false,defaultValue:"Genre"));
        AlterColumn("dbo.Movies", "Rating", c => c.String(maxLength: 5));
        AlterColumn("dbo.Movies", "Director", c => c.String(nullable: false,defaultValue:"Director"));

    }

    public override void Down()
    {       
        AlterColumn("dbo.Movies", "Director", c => c.String());
        AlterColumn("dbo.Movies", "Rating", c => c.String());
        AlterColumn("dbo.Movies", "Genre", c => c.String());
        AlterColumn("dbo.Movies", "Title", c => c.String());       
    }
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-09-09T00:58:34.887

不确定此选项是否始终存在，但遇到了类似的问题，发现我能够设置默认值，而无需使用以下命令运行任何手动更新

`defaultValueSql: "'NY'"`

当提供的值是我得到一个错误`"NY"`然后我意识到他们期待一个 SQL 值，就像`"GETDATE()"`我尝试过`"'NY'"`的那样，这就是诀窍

整条线看起来像这样

`AddColumn("TABLE_NAME", "State", c => c.String(maxLength: 2, nullable: false, defaultValueSql: "'NY'"));`

感谢[这个答案](https://stackoverflow.com/a/9062974/546411)，让我走上了正确的道路

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-03-11T11:07:58.427

从 EF Core 2.1 开始，您可以[`MigrationBuilder.UpdateData`](https://docs.microsoft.com/en-us/dotnet/api/microsoft.entityframeworkcore.migrations.migrationbuilder.updatedata?view=efcore-2.1)在更改列之前使用来更改值（比使用原始 SQL 更清晰）：

```
protected override void Up(MigrationBuilder migrationBuilder)
{
    // Change existing NULL values to NOT NULL values
    migrationBuilder.UpdateData(
        table: tableName,
        column: columnName,
        value: valueInsteadOfNull,
        keyColumn: columnName,
        keyValue: null);

    // Change column type to NOT NULL
    migrationBuilder.AlterColumn<ColumnType>(
        table: tableName,
        name: columnName,
        nullable: false,
        oldClrType: typeof(ColumnType),
        oldNullable: true);
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-01-10T00:47:05.613

许多其他响应集中在如何在这些问题发生时进行手动干预。

> 生成迁移后，对迁移执行以下任一更改：
> 
> 1.  修改 Column 定义以包含 defaultValue 或 defaultSql 语句：
>     `AlterColumn("dbo.Movies", "Director", c => c.String(nullable: false, default: ""));`
>     
>     
> 2.  在 AlterColumn 之前注入一条 SQL 语句以预填充现有列：
>     `Sql("UPDATE dbo.Movies SET Director = '' WHERE Director IS NULL");`

请记住，如果您重新构建迁移，将覆盖应用于迁移脚本的手动更改。对于第一个解决方案，扩展 EF 以在迁移生成过程中自动定义字段的默认值非常容易。

> 注意：EF 不会自动为您执行此操作，因为每个 RDBMS 提供程序的默认值实现会有所不同，而且还因为默认值在纯 EF 运行时中的意义较小，因为每个行插入都会为每个属性提供当前值，即使它是空的，所以默认值约束永远不会被评估。
> 这个 AlterColumn 语句是唯一一次使用默认约束，我想这对于设计 SQL Server 迁移实现的团队来说是一个较低的优先级。

以下解决方案结合了属性表示法、模型配置约定和列注释，以将元数据传递到自定义迁移代码生成器。如果您不使用属性表示法，则可以将步骤 1 和 2 替换为每个受影响字段的流畅表示法。
这里有很多技巧在玩，随意使用部分或全部，希望对这里的每个人都有价值

* * *

1.  **声明默认值**
    创建或重新定义现有属性以定义要使用的默认值，在本例中，我们将创建一个名为 DefaultValue 的新属性，该属性继承自 ComponentModel.DefaultValueAttribute，因为它的用法很直观，并且有可能存在代码库已经实现了这个属性。使用此实现，您只需要使用此特定属性来访问 DefaultValueSql，这对于日期和其他自定义场景很有用。

    ***执行***

    ```
    [DefaultValue("Insert DefaultValue Here")]
    [Required]     /// <--- NEW
    public string Director { get; set; }

    // Example of default value sql
    [DefaultValue(DefaultValueSql: "GetDate()")]
    [Required]
    public string LastModified { get; set; } 
    ```

    ***属性定义***

    ```
    namespace EFExtensions
    {
        /// <summary>
        /// Specifies the default value for a property but allows a custom SQL statement to be provided as well. <see cref="MiniTuber.Database.Conventions.DefaultValueConvention"/>
        /// </summary>
        public class DefaultValueAttribute : System.ComponentModel.DefaultValueAttribute
        {
            /// <summary>
            /// Specifies the default value for a property but allows a custom SQL statement to be provided as well. <see cref="MiniTuber.Database.Conventions.DefaultValueConvention"/>
            /// </summary>
            public DefaultValueAttribute() : base("")
            {
            }

            /// <i
            /// <summary>
            /// Optional SQL to use to specify the default value.
            /// </summary>
            public string DefaultSql { get; set; }

            /// <summary>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class using a Unicode character.
            /// </summary>
            /// <param name="value">
            /// A Unicode character that is the default value.
            /// </param>
            public DefaultValueAttribute(char value) : base(value) { }

            /// <summary>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class using an 8-bit unsigned integer.
            /// </summary>
            /// <param name="value">
            /// An 8-bit unsigned integer that is the default value.
            /// </param>
            public DefaultValueAttribute(byte value) : base(value) { }

            /// <summary>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class using a 16-bit signed integer.
            /// </summary>
            /// <param name="value">
            /// A 16-bit signed integer that is the default value.
            /// </param>
            public DefaultValueAttribute(short value) : base(value) { }

            /// <summary>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class using a 32-bit signed integer.
            /// </summary>
            /// <param name="value">
            /// A 32-bit signed integer that is the default value.
            /// </param>
            public DefaultValueAttribute(int value) : base(value) { }

            /// <summary>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class using a 64-bit signed integer.
            /// </summary>
            /// <param name="value">
            /// A 64-bit signed integer that is the default value.
            /// </param>
            public DefaultValueAttribute(long value) : base(value) { }

            /// <summary>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class using a single-precision floating point number.
            /// </summary>
            /// <param name="value">
            /// A single-precision floating point number that is the default value.
            /// </param>
            public DefaultValueAttribute(float value) : base(value) { }

            /// <summary>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class using a double-precision floating point number.
            /// </summary>
            /// <param name="value">
            /// A double-precision floating point number that is the default value.
            /// </param>
            public DefaultValueAttribute(double value) : base(value) { }

            /// <summary>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class using a System.Boolean value.
            /// </summary>
            /// <param name="value">
            /// A System.Boolean that is the default value.
            /// </param>
            public DefaultValueAttribute(bool value) : base(value) { }

            /// <summary>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class using a System.String.
            /// </summary>
            /// <param name="value">
            /// A System.String that is the default value.
            /// </param>
            public DefaultValueAttribute(string value) : base(value) { }

            /// <summary>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class.
            /// </summary>
            /// <param name="value">
            /// An System.Object that represents the default value.
            /// </param>
            public DefaultValueAttribute(object value) : base(value) { }

            /// /// <inheritdoc/>
            /// Initializes a new instance of the System.ComponentModel.DefaultValueAttribute
            /// class, converting the specified value to the specified type, and using an invariant
            /// culture as the translation context.
            /// </summary>
            /// <param name="type">
            /// A System.Type that represents the type to convert the value to.
            /// </param>
            /// <param name="value">
            /// A System.String that can be converted to the type using the System.ComponentModel.TypeConverter
            /// for the type and the U.S. English culture.
            /// </param>
            public DefaultValueAttribute(Type type, string value) : base(value) { }
        }
    } 
    ```

2.  **创建约定以将默认值注入列注释**
    列注释用于将有关列的自定义元数据传递给迁移脚本生成器。
    使用约定来执行此操作展示了属性表示法背后的强大功能，可以简化如何为许多属性定义和操作流畅的元数据，而不是为每个字段单独指定它。

    ```
    namespace EFExtensions
    {

        /// <summary>
        /// Implement SQL Default Values from System.ComponentModel.DefaultValueAttribute
        /// </summary>
        public class DefaultValueConvention : Convention
        {
            /// <summary>
            /// Annotation Key to use for Default Values specified directly as an object
            /// </summary>
            public const string DirectValueAnnotationKey = "DefaultValue";
            /// <summary>
            /// Annotation Key to use for Default Values specified as SQL Strings
            /// </summary>
            public const string SqlValueAnnotationKey = "DefaultSql";

            /// <summary>
            /// Implement SQL Default Values from System.ComponentModel.DefaultValueAttribute
            /// </summary>
            public DefaultValueConvention()
            {
                // Implement SO Default Value Attributes first
                this.Properties()
                        .Where(x => x.HasAttribute<EFExtensions.DefaultValueAttribute>())
                        .Configure(c => c.HasColumnAnnotation(
                            c.GetAttribute<EFExtensions.DefaultValueAttribute>().GetDefaultValueAttributeKey(),
                            c.GetAttribute<EFExtensions.DefaultValueAttribute>().GetDefaultValueAttributeValue()
                            ));

                // Implement Component Model Default Value Attributes, but only if it is not the SO implementation
                this.Properties()
                        .Where(x => x.HasAttribute<System.ComponentModel.DefaultValueAttribute>())
                        .Where(x => !x.HasAttribute<MiniTuber.DataAnnotations.DefaultValueAttribute>())
                        .Configure(c => c.HasColumnAnnotation(
                            DefaultValueConvention.DirectValueAnnotationKey, 
                            c.GetAttribute<System.ComponentModel.DefaultValueAttribute>().Value
                            ));
            }
        }

        /// <summary>
        /// Extension Methods to simplify the logic for building column annotations for Default Value processing
        /// </summary>
        public static partial class PropertyInfoAttributeExtensions
        {
            /// <summary>
            /// Wrapper to simplify the lookup for a specific attribute on a property info.
            /// </summary>
            /// <typeparam name="T">Type of attribute to lookup</typeparam>
            /// <param name="self">PropertyInfo to inspect</param>
            /// <returns>True if an attribute of the requested type exists</returns>
            public static bool HasAttribute<T>(this PropertyInfo self) where T : Attribute
            {
                return self.GetCustomAttributes(false).OfType<T>().Any();
            }

            /// <summary>
            /// Wrapper to return the first attribute of the specified type
            /// </summary>
            /// <typeparam name="T">Type of attribute to return</typeparam>
            /// <param name="self">PropertyInfo to inspect</param>
            /// <returns>First attribuite that matches the requested type</returns>
            public static T GetAttribute<T>(this System.Data.Entity.ModelConfiguration.Configuration.ConventionPrimitivePropertyConfiguration self) where T : Attribute
            {
                return self.ClrPropertyInfo.GetCustomAttributes(false).OfType<T>().First();
            }

            /// <summary>
            /// Helper to select the correct DefaultValue annotation key based on the attribute values
            /// </summary>
            /// <param name="self"></param>
            /// <returns></returns>
            public static string GetDefaultValueAttributeKey(this EFExtensions.DefaultValueAttribute self)
            {
                return String.IsNullOrWhiteSpace(self.DefaultSql) ? DefaultValueConvention.DirectValueAnnotationKey : DefaultValueConvention.SqlValueAnnotationKey;
            }

            /// <summary>
            /// Helper to select the correct attribute property to send as a DefaultValue annotation value
            /// </summary>
            /// <param name="self"></param>
            /// <returns></returns>
            public static object GetDefaultValueAttributeValue(this EFExtensions.DefaultValueAttribute self)
            {
                return String.IsNullOrWhiteSpace(self.DefaultSql) ? self.Value : self.DefaultSql;
            }
        }

    } 
    ```

3.  **将约定添加到 DbContext**
    有很多方法可以实现这一点，我喜欢将约定声明为我的 ModelCreation 逻辑中的第一个自定义步骤，这将在您的 DbContext 类中。

    ```
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);
        // Use our new DefaultValueConvention
        modelBuilder.Conventions.Add<EFExtensions.DefaultValueConvention>();

        // My personal favourites ;)
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
        modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>();

    } 
    ```

4.  **覆盖 MigrationCodeGenerator**
    既然这些注释已应用于模型中的列定义，我们需要修改迁移脚本生成器以使用这些注释。为此，我们将继承自 ，`System.Data.Entity.Migrations.Design.CSharpMigrationCodeGenerator`因为我们只需要注入最少量的更改。
    一旦我们处理了我们的自定义注解，我们需要将它从列定义中移除，以防止它被序列化到最终输出。

    > 查看基类代码以探索其他用法：[http ://entityframework.codeplex.com/sourcecontrol/latest#src/EntityFramework/Migrations/Design/CSharpMigrationCodeGenerator.cs](http://entityframework.codeplex.com/sourcecontrol/latest#src/EntityFramework/Migrations/Design/CSharpMigrationCodeGenerator.cs)

    ```
    namespace EFExtensions
    {
        /// <summary>
        /// Implement DefaultValue constraint definition in Migration Scripts.
        /// </summary>
        /// <remarks>
        /// Original guide that provided inspiration for this https://romiller.com/2012/11/30/code-first-migrations-customizing-scaffolded-code/
        /// </remarks>
        public class CustomCodeGenerator : System.Data.Entity.Migrations.Design.CSharpMigrationCodeGenerator
        {
            /// <summary>
            /// Inject Default values from the DefaultValue attribute, if the DefaultValueConvention has been enabled.
            /// </summary>
            /// <seealso cref="DefaultValueConvention"/>
            /// <param name="column"></param>
            /// <param name="writer"></param>
            /// <param name="emitName"></param>
            protected override void Generate(ColumnModel column, IndentedTextWriter writer, bool emitName = false)
            {
                var annotations = column.Annotations?.ToList();
                if (annotations != null && annotations.Any())
                {
                    for (int index = 0; index < annotations.Count; index ++)
                    {
                        var annotation = annotations[index];
                        bool handled = true;

                        try
                        {
                            switch (annotation.Key)
                            {
                                case DefaultValueConvention.SqlValueAnnotationKey:
                                    if (annotation.Value?.NewValue != null)
                                    {
                                        column.DefaultValueSql = $"{annotation.Value.NewValue}";
                                    }
                                    break;
                                case DefaultValueConvention.DirectValueAnnotationKey:
                                    if (annotation.Value?.NewValue != null)
                                    {
                                        column.DefaultValue = Convert.ChangeType(annotation.Value.NewValue, column.ClrType);
                                    }
                                    break;
                                default:
                                    handled = false;
                                    break;
                            }
                        }
                        catch(Exception ex)
                        {
                            // re-throw with specific debug information
                            throw new ApplicationException($"Failed to Implement Column Annotation for column: {column.Name} with key: {annotation.Key} and new value: {annotation.Value.NewValue}", ex);
                        }

                        if(handled)
                        {
                            // remove the annotation, it has been applied
                            column.Annotations.Remove(annotation.Key);
                        }
                    }
                }
                base.Generate(column, writer, emitName);
            }

            /// <summary>
            /// Generates class summary comments and default attributes
            /// </summary>
            /// <param name="writer"> Text writer to add the generated code to. </param>
            /// <param name="designer"> A value indicating if this class is being generated for a code-behind file. </param>
            protected override void WriteClassAttributes(IndentedTextWriter writer, bool designer)
            {
                writer.WriteLine("/// <summary>");
                writer.WriteLine("/// Definition of the Migration: {0}", this.ClassName);
                writer.WriteLine("/// </summary>");
                writer.WriteLine("/// <remarks>");
                writer.WriteLine("/// Generated Time: {0}", DateTime.Now);
                writer.WriteLine("/// Generated By: {0}", Environment.UserName);
                writer.WriteLine("/// </remarks>");
                base.WriteClassAttributes(writer, designer);
            }

        }
    } 
    ```

5.  **注册 CustomCodeGenerator**
    最后一步，在 DbMigration 配置文件中我们需要指定要使用的代码生成器，默认在 Migration 文件夹中查找 Configuration.cs...

    ```
    internal sealed class Configuration : DbMigrationsConfiguration<YourApplication.Database.Context>
    {
        public Configuration()
        {
            // I recommend that auto-migrations be disabled so that we control
            // the migrations explicitly 
            AutomaticMigrationsEnabled = false;
            CodeGenerator = new EFExtensions.CustomCodeGenerator();
        }

        protected override void Seed(YourApplication.Database.Context context)
        {
            //   Your custom seed logic here
        }
    } 
    ```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-04-10T09:52:19.813

我发现仅在实体属性上使用 Auto-Property Initializer 就足以完成工作。

例如：

```
public class Thing {
    public bool IsBigThing { get; set; } = false;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-06-15T09:03:43.390

出于某种原因，我无法解释自己，批准的答案不再适用于我。

它适用于另一个应用程序，而我正在使用的应用程序却没有。

因此，另一种但**效率很低**的解决方案是覆盖 SaveChanges() 方法，如下所示。这个方法应该在 Context 类上。

```
 public override int SaveChanges()
    {
        foreach (var entry in ChangeTracker.Entries().Where(entry => entry.Entity.GetType().GetProperty("ColumnName") != null))
        {
            if (entry.State == EntityState.Added)
            {
                entry.Property("ColumnName").CurrentValue = "DefaultValue";
            }
        } 
```

# shopify - 通过 shopify API 推送更改

> ID：12462104
> 
> 赞同：1
> 
> 时间：2012-09-17T15:05:16.873
> 
> 标签：shopify

我一直在查看 Shopify API，并且我看到了一些非常酷的 RESTful API 在查询时获取数据，但我一直在寻找可以推送数据更改的应用程序、服务、API 或某种插件当前产品以某种方式：通过帖子、肥皂电话或任何其他方式。存在这样的东西吗？我环顾四周，但找不到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:42:03.430

您正在寻找网络挂钩。基本上，您可以注册以接收到特定主题的给定端点的 POST 请求。

这是我们的技术文档：[http ://api.shopify.com/webhook.html](http://api.shopify.com/webhook.html)

这是一个指南：[http ://wiki.shopify.com/WebHook](http://wiki.shopify.com/WebHook)

# wpf - 数据触发器绑定问题（使用 Int 和 Enum）

> ID：12462106
> 
> 赞同：2
> 
> 时间：2012-09-17T15:05:33.457
> 
> 标签：wpf, xaml, data-binding

全部 -

需要对这个问题有所了解。我创建了一个示例项目来隔离我的一个项目的问题。我正在尝试根据模型中的某个值（Int/String/Enum）设置我的边框背景。

我遇到的问题是：

1）我相信正在设置 DataTrigger 绑定中的源 - 但我仍然收到此错误： *在“对象”“字符串”上找不到 personId 属性。绑定表达式：路径=personId；DataItem='String' (HashCode=1896530089); 目标元素是 'Border' (Name=''); 目标属性是“NoTarget”（类型“对象”）*

2）我在 int （或字符串）上这样做只是为了使这个概念起作用。但实际上我需要使这个 Enum 值。对此的任何建议也将有所帮助。

以下是代码片段：

个人.cs

```
public class Person
{
    public int personId { get; set; }
    public string personName { get; set; }
    public Gender personType { get; set; }

    public enum Gender
    {
        Male,
        Female
    }
} 
```

PersonViewModel.cs

```
public class PersonViewModel
{
    private ObservableCollection<Person> _people;

    public ObservableCollection<Person> people
    {
        get
        {
            return _people;
        }
    }

    public PersonViewModel()
    {
        _people = new ObservableCollection<Person>()
        {
            new Person()
            {
                personId = 1,
                personName = "John",
                personType = Person.Gender.Male
            },

            new Person()
            {
                personId = 1,
                personName = "Mary",
                personType = Person.Gender.Female
            },
        };
    }
} 
```

PersonView.xaml.cs

```
public PersonView()
    {
        InitializeComponent();
         var personvm = new PersonViewModel();
        DataContext = personvm;
    } 
```

PersonView.xaml

```
 <Window.Resources>
    <Style x:Key="BorderGradient" TargetType="{x:Type Border}">
        <Style.Triggers>
            <DataTrigger Binding="{Binding Source=people, Path=personId}" Value="1">
                <Setter Property="Background">
                    <Setter.Value>
                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.511,0.957">
                            <GradientStop Color="LightGray" Offset="0.55" />
                            <GradientStop Color="Black" Offset="1.3" />
                        </LinearGradientBrush>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
            <DataTrigger Binding="{Binding Source=people, Path=personId}" Value="2">
                <Setter Property="Background">
                    <Setter.Value>
                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.511,0.957">
                            <GradientStop Color="LightGray" Offset="0.55" />
                            <GradientStop Color="Yellow" Offset="1.3" />
                        </LinearGradientBrush>
                    </Setter.Value>
                </Setter>
            </DataTrigger>
        </Style.Triggers>
    </Style>
</Window.Resources>

<Border CornerRadius="15,15,15,15" Style="{StaticResource BorderGradient}" >
    <Grid Width="Auto" MinWidth="750" Height="Auto" MinHeight="600">

<!-- Logic in VM where visibility would be set through VM -->

        <StackPanel Grid.Row="0" HorizontalAlignment="Center" VerticalAlignment="Top" Visibility="To be set" >
            <loc:MaleView/>
        </StackPanel>

        <StackPanel Grid.Row="1" HorizontalAlignment="Center"  Visibility=" to be set">
            <loc:FemaleView />
        </StackPanel>
    </Grid>
</Border> 
```

![在此处输入图像描述](../Images/9b1e5af0964f09d804517c7ac05375e5.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T15:10:30.000

people 是一个可观察的集合，这是您在数据触发器中绑定的集合。ObservableCollection 没有名为“personId”的属性。

为您的 PersonViewModel 提供一个 DataTemplate 可能会更好

```
<DataTemplate DataType={x:Type vm:PersonViewModel}">

   <Grid Background="Red">
         .. Template For PersonViewModel Here ..
   </Grid>

   <DataTemplate.Triggers>
      <DataTrigger Binding="{Binding Path=personId}" Value="1">
         .... do stuff
      </DataTrigger>
   </DataTemplate.Triggers>
</DataTemplate> 
```

# perl - Try::Tiny：try-catch 的奇怪行为与否？

> ID：12462109
> 
> 赞同：5
> 
> 时间：2012-09-17T15:05:48.553
> 
> 标签：perl, exception-handling, try-catch, cpan, weak-typing

我正在使用`Try::Tiny`try-catch。

代码如下：

```
use Try::Tiny;

try {
    print "In try";
    wrongsubroutine();  # undefined subroutine
}
catch {
    print "In catch";
}

somefunction(); 
```

...

```
sub somefunction {
    print "somefunction";
} 
```

当我执行它是这样的：

```
somefunction
In Try
In catch 
```

输出序列在我看来是错误的。这是错的吗？还是这是正常行为？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-17T15:33:54.327

就像忘记一个分号一样

```
print
somefunction(); 
```

导致输出`somefunction`传递给`print`而不是`$_`，缺少分号导致输出`somefunction`作为参数传递给`catch`。

```
try {
   ...
}
catch {
   ...
};      <--------- missing
somefunction(); 
```

* * *

`try`并且`catch`是`&@`原型的子程序。这意味着

```
try { ... } LIST
catch { ... } LIST 
```

是相同的

```
&try(sub { ... }, LIST)
&catch(sub { ... }, LIST) 
```

所以你的代码是一样的

```
&try(sub { ... }, &catch(sub { ... }, somefunction())); 
```

`catch`如您所见，块后缺少的分号导致`somefunction`在之前被调用`catch`（它返回一个告诉`try`异常时要做什么的对象）和`try`.

代码应该是

```
&try(sub { ... }, &catch(sub { ... })); somefunction(); 
```

这是通过在 try-catch 调用之后放置分号来实现的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T15:11:32.220

你期望什么顺序？你的代码真的错过了`catch`代码后面的分号吗？

# android - Android 拦截 VoIP 通话时长

> ID：12462110
> 
> 赞同：1
> 
> 时间：2012-09-17T15:06:03.660
> 
> 标签：android, sip, voip

我需要拦截从我的设备发出和接收的所有 VOIP 呼叫，并计算总通话时长。

你能推荐阅读材料来研究吗？

谢谢，巴凯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T13:55:57.247

如果您想检查每个打来的电话，您可以扩展 BroadcastReceiver 和`@Override`方法`onReceive`。在您的清单文件中，您必须为`PHONE_STATE`意图过滤器注册广播接收器。这意味着每次`PHONE_STATE`更改都会触发您的接收器。

然后，在您的`onReceive`方法中，您可以获得一个`TelephonyManager`实例，并检查`CALL_STATE_RINGING`其他状态以确定从响铃到摘机再到空闲的时间。这将使您了解通话的持续时间。

这是文档：[BroadcastReceiver](http://developer.android.com/reference/android/content/BroadcastReceiver.html)

这是您的清单示例

```
 <receiver android:name=".receivers.PhoneBroadcastReceiver" >
        <intent-filter>
            <action android:name="android.intent.action.PHONE_STATE" />
        </intent-filter>
    </receiver> 
```

这是广播接收器的示例

```
@Override
public void onReceive(Context context, Intent intent) {
    TelephonyManager telephonyManager = (TelephonyManager) context.getSystemService(Context.TELEPHONY_SERVICE);
    int callState = telephonyManager.getCallState();
    Bundle extras = intent.getExtras();

    if (extras == null) {
        return;
    }

    String incomingNumber = extras.getString("incoming_number");

    Log.d(TAG, "Receiving callStateChange: " + callState + " number: " + incomingNumber);

    switch (callState) {
        case TelephonyManager.CALL_STATE_RINGING :
            processIncomingNumber(context, incomingNumber);
            break;
        case TelephonyManager.CALL_STATE_IDLE :
            NotificationManager nm = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);
            nm.cancelAll();
            break;
    }
} 
```

# xml - 使用 XSLT 的特定节点值的唯一记录计数

> ID：12462112
> 
> 赞同：1
> 
> 时间：2012-09-17T15:06:09.777
> 
> 标签：xml, xslt, tibco

当特定节点值为 ERROR 时如何计算唯一值。下面是xml源。有不同的数据集，如 SellOut、SellIn 和 Inventory，但我希望 RECORD_TYPE=ERROR 有一个唯一的记录计数，而与数据集类型无关

```
<SellOutErrorRecord>
    <RECORD_TYPE>WARNING</RECORD_TYPE>
    <ERROR_DESC>record 1:location id is invalid</ERROR_DESC>
    <RECORD_NO>1</RECORD_NO>
    <LOCATION_NAME>XYZ el</LOCATION_NAME>
    <PRODUCT_NUMBER>336549R-001</PRODUCT_NUMBER>
    <PRODUCT_OPTION>0D1</PRODUCT_OPTION>
    <PRODUCT_LINE>LA</PRODUCT_LINE>
</SellOutErrorRecord>
<SalesInErrorRecord>
    <RECORD_TYPE>ERROR</RECORD_TYPE>
    <ERROR_DESC>record 1:location id is invalid</ERROR_DESC>
    <RECORD_NO>1</RECORD_NO>
    <LOCATION_NAME>XYZ el</LOCATION_NAME>
    <PRODUCT_NUMBER>336549R-001</PRODUCT_NUMBER>
    <PRODUCT_OPTION>0D1</PRODUCT_OPTION>
    <PRODUCT_LINE>LA</PRODUCT_LINE>
    <PRODUCT_LINE_TYPE>C</PRODUCT_LINE_TYPE>
</SalesInErrorRecord>
<SellOutErrorRecord>
    <RECORD_TYPE>ERROR</RECORD_TYPE>
    <ERROR_DESC>record 2:SO:invoiced net amount is invalid</ERROR_DESC>
    <RECORD_NO>2</RECORD_NO>
    <LOCATION_NAME>XYZ el</LOCATION_NAME>
    <PRODUCT_NUMBER>3X-KN73C-DB</PRODUCT_NUMBER>
    <PRODUCT_OPTION>0D1</PRODUCT_OPTION>
    <PRODUCT_LINE>HA</PRODUCT_LINE>
    <PRODUCT_LINE_TYPE>E</PRODUCT_LINE_TYPE>
</SellOutErrorRecord>
<SellOutErrorRecord>
    <RECORD_TYPE>ERROR</RECORD_TYPE>
    <ERROR_DESC>record 3:SO:transaction currency is invalid</ERROR_DESC>
    <RECORD_NO>3</RECORD_NO>
    <LOCATION_NAME>XYZ el</LOCATION_NAME>
    <PRODUCT_NUMBER>339112-B25</PRODUCT_NUMBER>
    <PRODUCT_OPTION>0D1</PRODUCT_OPTION>
    <PRODUCT_LINE>J3</PRODUCT_LINE>
    <PRODUCT_LINE_TYPE>E</PRODUCT_LINE_TYPE>
</SellOutErrorRecord>
<SalesInErrorRecord>
    <RECORD_TYPE>WARNING</RECORD_TYPE>
    <ERROR_DESC>record 3:SI:buy quantity is zero</ERROR_DESC>
    <RECORD_NO>3</RECORD_NO>
    <LOCATION_NAME>XYZ el</LOCATION_NAME>
    <PRODUCT_NUMBER>339112-B25</PRODUCT_NUMBER>
    <PRODUCT_OPTION>0D1</PRODUCT_OPTION>
    <PRODUCT_LINE>J3</PRODUCT_LINE>
    <PRODUCT_LINE_TYPE>E</PRODUCT_LINE_TYPE>
</SalesInErrorRecord>
<SalesInErrorRecord>
    <RECORD_TYPE>ERROR</RECORD_TYPE>
    <ERROR_DESC>record 3:SI:transaction document id is invalid</ERROR_DESC>
    <RECORD_NO>3</RECORD_NO>
    <LOCATION_NAME>XYZ el</LOCATION_NAME>
    <PRODUCT_NUMBER>339112-B25</PRODUCT_NUMBER>
    <PRODUCT_OPTION>0D1</PRODUCT_OPTION>
    <PRODUCT_LINE>J3</PRODUCT_LINE>
    <PRODUCT_LINE_TYPE>E</PRODUCT_LINE_TYPE>
</SalesInErrorRecord>
<SellOutErrorRecord>
    <RECORD_TYPE>WARNING</RECORD_TYPE>
    <ERROR_DESC>record 4:SO:invoiced net amount is invalid</ERROR_DESC>
    <RECORD_NO>4</RECORD_NO>
    <LOCATION_NAME>XYZ el</LOCATION_NAME>
    <PRODUCT_NUMBER>445860-B21</PRODUCT_NUMBER>
    <PRODUCT_OPTION>0D1</PRODUCT_OPTION>
    <PRODUCT_LINE>MV</PRODUCT_LINE>
    <PRODUCT_LINE_TYPE>C</PRODUCT_LINE_TYPE>
</SellOutErrorRecord>
<SalesInErrorRecord>
    <RECORD_TYPE>ERROR</RECORD_TYPE>
    <ERROR_DESC>record 5:SI:transaction currency is null or invalid</ERROR_DESC>
    <RECORD_NO>5</RECORD_NO>
    <LOCATION_NAME>XYZ el</LOCATION_NAME>
    <PRODUCT_NUMBER>339112-B25</PRODUCT_NUMBER>
    <PRODUCT_OPTION>0D1</PRODUCT_OPTION>
    <PRODUCT_LINE>J3</PRODUCT_LINE>
    <PRODUCT_LINE_TYPE>E</PRODUCT_LINE_TYPE>
</SalesInErrorRecord>
<InventoryErrorRecord>
    <RECORD_TYPE>ERROR</RECORD_TYPE>
    <ERROR_DESC>record 6:product id is invalid</ERROR_DESC>
    <RECORD_NO>6</RECORD_NO>
    <LOCATION_NAME>XYZ XYZ</LOCATION_NAME>
    <PRODUCT_NUMBER>331184-B21</PRODUCT_NUMBER>
    <PRODUCT_OPTION>0S1</PRODUCT_OPTION>
    <PRODUCT_LINE>R8</PRODUCT_LINE>
    <PRODUCT_LINE_TYPE>E</PRODUCT_LINE_TYPE>
</InventoryErrorRecord>
<SellOutErrorRecord>
    <RECORD_TYPE>ERROR</RECORD_TYPE>
    <ERROR_DESC>record 6:SO:invoiced net amount is invalid</ERROR_DESC>
    <RECORD_NO>6</RECORD_NO>
    <LOCATION_NAME>XYZ el</LOCATION_NAME>
    <PRODUCT_NUMBER>339112-B25</PRODUCT_NUMBER>
    <PRODUCT_OPTION>0D1</PRODUCT_OPTION>
    <PRODUCT_LINE>J3</PRODUCT_LINE>
    <PRODUCT_LINE_TYPE>E</PRODUCT_LINE_TYPE>
</SellOutErrorRecord> 
```

输出必须是 record_count=5。谢谢你的帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:32:12.910

在 XSLT 1.0 中，区分是相当[不直观](https://stackoverflow.com/questions/153156/xslt-how-to-count-distinct-values-in-a-node)的。我假设根节点是`xml`，并且使记录唯一的是`RECORD_NO`.

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="text" indent="no"/>

    <xsl:template match="/xml">
        record_count=<xsl:value-of select="count(*[RECORD_TYPE='ERROR' and not(following::*[RECORD_TYPE='ERROR']/RECORD_NO/text() = RECORD_NO/text())])" />
    </xsl:template>
</xsl:stylesheet> 
```

# sql - 将 Sproc 结果发送到 SQL Server 中的电子邮件

> ID：12462113
> 
> 赞同：1
> 
> 时间：2012-09-17T15:06:11.060
> 
> 标签：sql, sql-server-2008, tsql, sql-server-2008-r2

我正在尝试发送 Sproc 结果的电子邮件。我试过这样做：

```
EXEC msdb.dbo.sp_send_dbmail  
    @recipients = 'Testemail@XYZ.com',
    @query = 'EXEC test_email' ,
    @subject = 'Sample Data',
    @attach_query_result_as_file = 1 ; 
```

它给了我以下错误：

> 消息 15281，级别 16，状态 1，过程 sp_send_dbmail，第 0 行
> SQL Server 阻止访问组件“数据库邮件 XPs”的过程“dbo.sp_send_dbmail”，因为该组件作为该服务器安全配置的一部分被关闭。系统管理员可以使用 sp_configure 启用“数据库邮件 XP”。有关启用“数据库邮件 XP”的详细信息，请参阅 SQL Server 联机丛书中的“表面区域配置”。

有没有其他方法可以做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-24T06:50:28.900

恐怕没有其他使用 DBMail 的方法。需要使用以下命令启用数据库邮件： EXEC sp_configure 'Database Mail XPs', 1 但此外，需要使用适当的配置文件和帐户配置数据库邮件。

我为策略不启用邮件的服务器使用的一种解决方法是让存储过程调用一个运行查询并发送电子邮件的 SSIS 包。这完全绕过了数据库邮件，并且 SSIS 包自己连接到 SMTP 服务器。

我通常设置的方式是运行 sp_startjob 来调用服务器代理作业，然后运行 ​​SSIS 包。

希望这可以帮助。

皮特

# android - Android - 活页夹

> ID：12462115
> 
> 赞同：2
> 
> 时间：2012-09-17T15:06:19.777
> 
> 标签：android, ipc, android-binder

我读了一篇关于 android 的活页夹的文章。文章说进程交换共享内存中的对象引用并且它比编组和解组更有效......但实际上在IPC机制中是否存在编组和解组？我有点困惑……

任何人都可以解释活页夹机制或链接到详细文章吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T07:01:07.047

Binder 是一种在内核中运行的优化编组方法。

关于它的几个链接：

[http://www.cubrid.org/blog/dev-platform/binder-communication-mechanism-of-android-processes/](http://www.cubrid.org/blog/dev-platform/binder-communication-mechanism-of-android-processes/) [http://lukejin.wordpress.com/2011/03/13/android%E4%B8% AD%E7%9A%84binder/](http://lukejin.wordpress.com/2011/03/13/android%E4%B8%AD%E7%9A%84binder/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-28T02:43:09.893

[http://marakana.com/s/post/1340/Deep_Dive_Into_Binder_Presentation.htm](http://marakana.com/s/post/1340/Deep_Dive_Into_Binder_Presentation.htm)

此链接提供了关于 Binder 如何作为架构工作的非常有用的概述，还提供了用于利用与应用程序开发人员相关的 Binder 的各个方面（Intents、Messenger、AIDL）的示例代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-22T15:47:48.243

古老的问题，但值得一个最新的答案：

Binder 工具使用了句柄，这使得处理对象变得更快、更容易。在某些情况下，不必编组整个对象，而是只返回对象句柄，之后可以通过其方法对其进行操作。这意味着对象的大部分（可能非常大）根本不需要编组 - 节省 CPU 和开销。

例如，考虑如何执行屏幕捕获。（屏幕截图实用程序的 qv 源），或（作为另一个示例）MediaPlayer 的工作方式。Binder 将获取远程对象的句柄，但该对象实际上并没有“通过网络”。调用“创建”方法

```
 virtual sp<IMediaPlayer> create(const sp<IMediaPlayerClient>& client,
            audio_session_t audioSessionId = AUDIO_SESSION_ALLOCATE) 

flame:/ $ service call media.player 1
Result: Parcel(
  0x00000000: 73682a85 00000113 00000002 00000000 '.*hs............'
  0x00000010: 00000000 00000000 0000000c          '............    ' 
```

'*hs'（实际上是 *sh）是一个 Binder STRONG HANDLE，这意味着与其关联的描述符（在本例中为 '2'）可以在后续直接调用中使用，以调用 IMediaPlayer 功能。如果随后针对其接口探测返回的描述符，则可以证明这一点：

```
flame:/ $ /data/local/tmp/bdsm call media.player 1                                                                                     
Got handle to android.media.IMediaPlayerService
Object 0 (desc 2) is a handle to android.media.IMediaPlayer 
```

这是预期的（sp）。这意味着现在可以直接调用 IMediaPlayer 实例的方法。

顺便说一句，虽然 Binder 确实不使用共享内存，但上述关于 ashmem 的回复并不完全准确。ashmem 将匿名共享内存映射到文件描述符，然后该文件描述符通过 Binder 从进程 A 移动到 B（它可以像 UN*X 域套接字一样移动文件描述符）。此外，每当您看到 IBinderToken 项目“编组”到它时，Parcels 都可以持有这些 *SH（强句柄）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-11T20:40:20.373

> 文章说进程交换共享内存中的对象引用

Binder 不使用共享内存（ashmem 或 pmem）。它使用具有固定大小缓冲区的内核驱动程序。将数据复制进和复制出内核是一种安全的方式。也许这篇文章松散地使用了“共享内存”。

我认为混淆是在Binder 协议和Android 的“Binder” RPC 机制之间。就原型而言，它只是被复制进出的字节。Android 平台使用 Binder 内核驱动程序实现了类似 OO 的 RPC 机制。这当然会将对象“编组”为字节，并在另一侧将它们解组回对象。这是在`Parcel`类和`Parcelable`接口的帮助下完成的。

# apache - Ant build 无法识别西班牙语字符

> ID：12462123
> 
> 赞同：3
> 
> 时间：2012-09-17T15:06:44.720
> 
> 标签：apache, ant, selenium

我有一个使用 Apache ANT 执行测试的 Selenium 项目。

在某些情况下，我需要验证一些西班牙语文本，例如“eBay España”，即带有重音字符的文本。

当我从 IntelliJ IDEA IDE 正常执行测试时，它会正常运行并适当地验证西班牙语字符。

但是当我尝试从 IDE 中的 Apache ANT 控制台执行测试时，它无法识别西班牙重音字符。

检查 O/P

*   **正常执行 -**

    信息 [main] (VerifySpanishCharacters.java:45) - FIRE FOX 驱动程序实例化信息 [main] (VerifySpanishCharacters.java:46) - SELENIUM 驱动程序实例化信息 [main] (VerifySpanishCharacters.java:47) - [https://login.salesforce .com/](https://login.salesforce.com/) com.cognizant.automation.resources.ExcelSheetUtil.SheetReader@149b290 eBay España áéíóú INFO [main] (VerifySpanishCharacters.java:61) - selenium 驱动程序已关闭

*   **Apache ANT 执行**

    已记录消息 [testng] 信息 [pool-2-thread-1] (VerifySpanishCharacters.java:45) - 已记录 FIRE FOX 驱动程序实例化消息 [testng] 信息 [pool-2-thread-1] (VerifySpanishCharacters.java:46) -已记录 SELENIUM 驱动程序实例化消息 [testng] 信息 [pool-2-thread-1] (VerifySpanishCharacters.java:47) - [https://login.salesforce.com/](https://login.salesforce.com/) 已记录消息 [testng] com.cognizant.automation.resources.ExcelSheetUtil .SheetReader@7bc899 MESSAGE LOGGED [testng] eBay Espa. MESSAGE LOGGED [testng] ���� MESSAGE LOGGED [testng] INFO [pool-2-thread-1] (VerifySpanishCharacters.java:61) - selenium 驱动程序已关闭

您能否提供一个可能的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T15:06:01.387

您可以使用以下链接将文本更改为 UTF8/UTF-16M 字符，您可以使用该字符而不是带有一些转义序列的文本

[http://macchiato.com/unicode/convert.html](http://macchiato.com/unicode/convert.html)

转到此链接，在输入框编辑器中输入您的文本，然后在输出框编辑器的下拉列表中选择 UTF-16M，然后单击输入和输出框编辑器之间的按钮，您可以在输出中获得所需的值框编辑器。您可以在代码中使用带有转义序列的值。

例如，对于文本“eBay España”，您将得到输出为“0065 0042 0061 0079 0020 0045 0073 0070 0061 00F1 0061”，您可以将此值与转义序列一起使用为“\u0065 \u0042 \u0061 \u0079 \u0020 \ u0045 \u0073 \u0070 \u0061 \u00F1 \u0061”。

试试这个...

# ios - iPad 上最快的图像格式是什么？

> ID：12462127
> 
> 赞同：1
> 
> 时间：2012-09-17T15:07:05.307
> 
> 标签：ios, uiimage, cgimage

假设如下：

*   您在 ipad 应用程序中从 Internet 下载图像
*   您可以以任何您想要的方式对图像进行后处理，所花费的时间并不重要（下载数据时需要进行 1 次操作）。设备上的实际表示也不重要。
*   您可以以任何方式编写该图像的加载代码，只要它产生 UIImage

问题是：在 iPad 上存储图像的最佳格式是什么，以便尽可能少地加载它？CG的某种原始转储...上下文位图内存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T21:11:22.313

与此同时，我想我已经弄清楚了：

为了保存 UIImage 我在一个类别中添加了这个方法：

```
typedef struct
{
    int width;
    int height;
    int scale;

    int bitsPerComponent;
    int bitsPerPixel;
    int bytesPerRow;
    CGBitmapInfo bitmapInfo;
} ImageInfo;

-(void)saveOptimizedRepresentation:(NSString *)outputPath
{
    NSData * pixelData = (__bridge_transfer NSData *)CGDataProviderCopyData(CGImageGetDataProvider(self.CGImage));
    CGSize size;
    size.width = CGImageGetWidth(self.CGImage);
    size.height = CGImageGetHeight(self.CGImage);
    int bitsPerComponent = CGImageGetBitsPerComponent(self.CGImage);
    int bitsPerPixel = CGImageGetBitsPerPixel(self.CGImage);
    int bytesPerRow = CGImageGetBytesPerRow(self.CGImage);
    int scale = self.scale;
    CGBitmapInfo bitmapInfo = CGImageGetBitmapInfo(self.CGImage);

    ImageInfo info;
    info.width = size.width;
    info.height = size.height;
    info.bitsPerComponent = bitsPerComponent;
    info.bitsPerPixel = bitsPerPixel;
    info.bytesPerRow = bytesPerRow;
    info.bitmapInfo = bitmapInfo;
    info.scale = scale;

    //kCGColorSpaceGenericRGB
    NSMutableData * fileData = [NSMutableData new];

    [fileData appendBytes:&info length:sizeof(info)];
    [fileData appendData:pixelData];

    [fileData writeToFile:outputPath atomically:YES];
} 
```

为了加载它，我添加了这个：

```
+(UIImage *)loadOptimizedRepresentation:(NSString *)inputPath
{
    FILE * f = fopen([inputPath cStringUsingEncoding:NSASCIIStringEncoding],"rb");
    if (!f) return nil;

    fseek(f, 0, SEEK_END);
    int length = ftell(f) - sizeof(ImageInfo);
    fseek(f, 0, SEEK_SET);

    ImageInfo info;
    fread(&info, 1, sizeof(ImageInfo), f);

    CGColorSpaceRef cs = CGColorSpaceCreateDeviceRGB();

    CGContextRef bitmapContext = CGBitmapContextCreate(NULL,
                                                       info.width,
                                                       info.height,
                                                       info.bitsPerComponent,
                                                       info.bytesPerRow,
                                                       cs,
                                                       info.bitmapInfo
                                                       );

    void * targetData = CGBitmapContextGetData(bitmapContext);
    fread(targetData,1,length,f);

    fclose(f);

    CGImageRef decompressedImageRef = CGBitmapContextCreateImage(bitmapContext);

    UIImage * result = [UIImage imageWithCGImage:decompressedImageRef scale:info.scale orientation:UIImageOrientationUp];

    CGContextRelease(bitmapContext);
    CGImageRelease(decompressedImageRef);
    CGColorSpaceRelease(cs);

    return result;
} 
```

# java - 如何正确实现@ManyToMany 映射？

> ID：12462128
> 
> 赞同：0
> 
> 时间：2012-09-17T15:07:05.603
> 
> 标签：java, hibernate, orm, many-to-many, relational-database

我不明白，Hibernate 是否应该自动工作？

我有`Category`编码如下的实体：

```
@Entity
public class Category {

@Id
public String Url;

@OneToMany
@JoinTable(name = "category_childs")
private Set<Category> childs = new HashSet<Category>();

@OneToMany
@JoinTable(name = "category_parents")
private Set<Category> parents = new HashSet<Category>();

@OneToMany(cascade=CascadeType.ALL)
private Set<Person> persons = new HashSet<Person>();

public String Title;

public boolean Done; 
```

这会导致创建下表

```
CREATE TABLE
category_parents
(
    Category_Url VARCHAR(255) NOT NULL,
    parents_Url VARCHAR(255) NOT NULL,
    PRIMARY KEY (Category_Url, parents_Url),
    CONSTRAINT FK9BB292C83275D6D7 FOREIGN KEY (Category_Url) REFERENCES category (Url) ,
    CONSTRAINT FK9BB292C8569C2962 FOREIGN KEY (parents_Url) REFERENCES category (Url),
    CONSTRAINT parents_Url UNIQUE (parents_Url), 
```

这是不正确的，因为`parents_Url`不应该是唯一的（应该允许多行具有相同的父级）。

如果我在没有@JoinTable 规范的情况下编码

```
@Entity
public class Category {

@Id
public String Url;

@ManyToMany(cascade=CascadeType.ALL)
//@JoinTable(name = "category_childs")
private Set<Category> childs = new HashSet<Category>();

@ManyToMany(cascade=CascadeType.ALL)
//@JoinTable(name = "category_parents")
private Set<Category> parents = new HashSet<Category>();

@OneToMany(cascade=CascadeType.ALL)
private Set<Person> persons = new HashSet<Person>();

public String Title;

public boolean Done; 
```

那么我将有以下

```
CREATE TABLE
category_category
(
    Category_Url VARCHAR(255) NOT NULL,
    parents_Url VARCHAR(255) NOT NULL,
    childs_Url VARCHAR(255) NOT NULL,
    PRIMARY KEY (Category_Url, childs_Url),
    CONSTRAINT FK8635931F3275D6D7 FOREIGN KEY (Category_Url) REFERENCES category (Url) ,
    CONSTRAINT FK8635931F569C2962 FOREIGN KEY (parents_Url) REFERENCES category (Url) ,
    CONSTRAINT FK8635931F6ADF3430 FOREIGN KEY (childs_Url) REFERENCES category (Url), 
```

如何让 Hibernate 创建具有两个字段的关系表？

如下：

```
CREATE TABLE
category_category
(
    parents_Url VARCHAR(255) NOT NULL,
    childs_Url VARCHAR(255) NOT NULL,
    PRIMARY KEY (parents_Url, childs_Url),
    CONSTRAINT FK8635931F569C2962 FOREIGN KEY (parents_Url) REFERENCES category (Url) ,
    CONSTRAINT FK8635931F6ADF3430 FOREIGN KEY (childs_Url) REFERENCES category (Url), 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:19:19.883

Hibernate 在第一种情况下创建了一个唯一列，因为您正在使用`@OneToMany`它告诉 hibernate 一个类别最多有一个父级。在您注释掉的代码中，`@JoinTable`您也更改`@OneToMany`为`@ManyToMany`. 这就是为什么 hibernate 在这种情况下不会创建唯一约束的原因。

我想该类别的孩子将类别本身作为父母。`mappedBy`在这种情况下，必须使用in将孩子或父母定义为关系的另一方`@ManyToMany`：

```
@ManyToMany
@JoinTable(name = "category_childs")
private Set<Category> childs = new HashSet<Category>();

@ManyToMany(mappedBy="childs")
private Set<Category> parents = new HashSet<Category>(); 
```

# ruby-on-rails - rails 路由约束正则表达式是否具有隐式锚点？

> ID：12462136
> 
> 赞同：2
> 
> 时间：2012-09-17T15:07:29.580
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes

我的应用程序中有一条如下所示的路线：

```
match '/:id' => 'controller#action', :constraints => { :id => VALID_IDS } 
```

其中 VALID_IDS 是一个正则表达式白名单，例如

```
/(good_id|another_good_id|a_valid_id)/ 
```

现在看来，uri

```
/good_id_one 
```

不匹配这个约束，即使

```
1.9.2p318 :004 > "good_id_one".match /^(good_id|another_good_id|a_valid_id)/
 => #<MatchData "good_id" 1:"good_id"> 
```

这是为什么？我有一个怀疑。[本指南](http://guides.rubyonrails.org/routing.html#segment-constraints)说

> :constraints 采用正则表达式，但不能使用正则表达式锚。但是，请注意，您不需要使用锚点，因为所有路线都在开始时锚定。

rails 在正则表达式的*末尾*添加一个锚也是这种情况吗？这可以解释我所看到的，因为

```
1.9.2p318 :006 > "good_id_one".match /^(good_id|another_good_id|a_valid_id)$/
 => nil 
```

但是，我不确定这种怀疑是否正确。谁能证实或否认我的假设？

(ps, `Rails 3.0.11, Ruby 1.9.2`)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-09-17T15:13:38.693

这不是因为隐含的锚点，而是因为 / 在你的表达式末尾。

尝试：

```
/(good_id|another_good_id|a_valid_id) 
```

# c# - 使用 Linq 同时查询两个集合

> ID：12462140
> 
> 赞同：2
> 
> 时间：2012-09-17T15:07:42.407
> 
> 标签：c#, .net, linq, collections

如果我有 2 个对象集合，是否可以在一个查询中有效地加入它们并从它们中进行选择？

例如：

```
var collection1 = GetSomeData();
var collection2 = GetSomeMoreData();

var myResult = from x in collection1
               from y in collection2
               where x.SomeProperty = "Yes"
               where y.SomeProperty = "Yes"
               select x, select y; 
```

`GetSomeData`, 并且`GetSomeMoreData`都返回`IEnumerable<MyType>`

显然这不会编译......但希望它能够说明我正在尝试做这个想法......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T15:09:33.420

我想你想要[`Enumerable.Concat`](http://msdn.microsoft.com/en-us/library/bb302894.aspx)：

```
var myResult = collection1.Concat(collection2)
                          .Where(x => x.SomeProperty == "Yes"); 
```

或在查询语法中：

```
var myResult = from x in collection1.Concat(collection2)
               where x.SomeProperty == "Yes"
               select x; 
```

请注意，在 LINQ 的上下文中，您使用的“加入”一词通常是指根据某个键在两个序列之间查找（和配对/分组）公共元素。那不是你打算做的，是吗？

# c# - 为什么我的代码获取不到当前进程的MainModule？

> ID：12462144
> 
> 赞同：3
> 
> 时间：2012-09-17T15:08:02.920
> 
> 标签：c#, .net, process, windows-server-2008, access-denied

我有以下代码正在从属于`Users`组的本地用户下运行：

```
String processName = System.Diagnostics.Process.GetCurrentProcess().MainModule.ModuleName; 
```

使用以下堆栈`System.ComponentModel.Win32Exception`声明失败：`Access is denied`

```
System.Diagnostics.ProcessManager.OpenProcess(Int32 processId, Int32 access, Boolean throwIfExited)
System.Diagnostics.NtProcessManager.GetModuleInfos(Int32 processId, Boolean firstModuleOnly)
System.Diagnostics.Process.get_MainModule() 
```

现在[MSDN 文章](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.mainmodule%28v=vs.90%29.aspx)在页面底部有“社区内容”，说当代码被提升的进程或其他用户调用时会观察到这种行为，因为它会尝试打开进程。

好的，它尝试打开该进程，但代码在属于`Users`组的用户下运行，为什么拒绝访问打开该进程？

# java - DataNucleus、HBase、JDO：“必须指定名为 javax.jdo.PersistenceManagerFactoryClass 的属性”

> ID：12462146
> 
> 赞同：1
> 
> 时间：2012-09-17T15:08:11.467
> 
> 标签：java, hbase, jdo, datanucleus

我在尝试遵循[DataNucleus HBase 教程](http://www.datanucleus.org/products/datanucleus/guides/jdo/tutorial_hbase.html)时遇到异常（“必须指定名为 javax.jdo.PersistenceManagerFactoryClass 的属性”） 。

我的 datanucleus.properties 文件（如下）没有指定这样的属性，但是教程也没有，[DataNucleus HBase 示例](http://sourceforge.net/projects/datanucleus/files/datanucleus-samples/3.1/)也没有。

找到 3.1 样本后编辑：

**src/main/resources/datanucleus.properties**

```
javax.jdo.option.ConnectionURL=hbase:hx1:60010
javax.jdo.option.Mapping=hbase

datanucleus.metadata.validate=false
datanucleus.autoCreateSchema=true
datanucleus.validateTables=false
datanucleus.validateConstraints=false 
```

**src/main/java/hbase-site.xml**

```
<?xml version="1.0"?>

<configuration> 
  <property>
    <name>hbase.zookeeper.quorum</name>
    <value>hx1:2181</value>
    <description>The host and port that the HBase master runs at.
    </description>
  </property>
</configuration> 
```

**src/main/com.business.model/package-hbase.xml**

```
<?xml version="1.0"?>
<!DOCTYPE orm PUBLIC 
    "-//Sun Microsystems, Inc.//DTD Java Data Objects Metadata 2.0//EN" 
    "http://java.sun.com/dtd/orm_2_0.dtd">
<orm>
    <package name="com.business.model">
        <class name="Recommendation" table="Recommendations">
            <field name="id" column="ID"/>
            <field name="documents" column="DOCUMENTS"/>
        </class>

        <class name="Document">
            <field name="id" column="ID"/>
            <field name="title" column="TITLE"/>
        </class>
    </package>
</orm> 
```

有什么我想念的想法吗？在与 JPA 合作了几年之后，我是 JDO 的新手。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T12:24:52.377

我从未尝试过 HBase 教程，但您必须定义 javax.jdo.PersistenceManagerFactoryClass 属性。我的在 persistence.xml 文件（src/main/resources）中定义。属性定义：

```
<property name="javax.jdo.PersistenceManagerFactoryClass"
            value="org.datanucleus.api.jdo.JDOPersistenceManagerFactory" /> 
```

您也可以在创建 PMF 时定义此属性。

更多细节在：[http ://db.apache.org/jdo/pmf.html](http://db.apache.org/jdo/pmf.html)

# asp-classic - INNER 附近的 SQL SERVER/ASP 语法错误

> ID：12462148
> 
> 赞同：0
> 
> 时间：2012-09-17T15:08:28.537
> 
> 标签：asp-classic, sql-server-2008-r2

我在不同的 SQL 服务器上有两个数据库。它们已在 SQL Server 中链接。我无法将数据库移动到同一台服务器。

我正在尝试使用内部连接来显示一小组特定信息。基本上，如果 VisitID = 数据库 B 中的帐号，我需要显示数据库 A（NurQueryResults）中的一列。我已经成功地在 asp 页面中使用单独的连接字符串单独连接到两个数据库（使用连接字符串）。我已经验证了每个数据库中的列名。我的 SQL 代码出现语法错误。这是我尝试使用的代码：

```
 SELECT Response, VisitID, QueryID, RowUpdateTime FROM [dbo].NurQueryResults WHERE QueryID = FALL.RISK1

INNER JOIN [dbo].View_CareProviderWithPatientAtLocation
ON [dbo].NurQueryResult.VisitID = [dbo].View_CareProviderWithPatientAtLocation.AccountNumber    

ORDER BY RowUpdateDateTime DESC 
```

我正在使用 Dreamweaver。该页面是.asp，我一直在使用插入记录集命令。这就是我试图输入上述代码的区域。当我尝试记录集窗口中的“测试”按钮时出现语法错误。

我尝试列出数据库 B 的服务器/数据库名称/表名称，但仍然收到语法错误。SQL代码中有什么不正确的吗？还是您认为这与我与链接服务器的连接有关？还是我应该采取完全不同的方法来获取这些数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:10:53.733

```
SELECT Response, VisitID, QueryID, RowUpdateTime 
FROM [dbo].NurQueryResults     
INNER JOIN [dbo].View_CareProviderWithPatientAtLocation
ON [dbo].NurQueryResult.VisitID = [dbo].View_CareProviderWithPatientAtLocation.AccountNumber    
WHERE QueryID = FALL.RISK1
ORDER BY RowUpdateDateTime DESC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:11:09.930

```
SELECT Response, VisitID, QueryID, RowUpdateTime 
FROM [dbo].NurQueryResults 

INNER JOIN [dbo].View_CareProviderWithPatientAtLocation
ON [dbo].NurQueryResult.VisitID = [dbo].View_CareProviderWithPatientAtLocation.AccountNumber    

WHERE QueryID = FALL.RISK1
ORDER BY RowUpdateDateTime DESC 
```

# javascript - chrome 扩展命令行通信

> ID：12462150
> 
> 赞同：5
> 
> 时间：2012-09-17T15:08:35.953
> 
> 标签：javascript, google-chrome, google-chrome-extension

无论如何，我是否可以从命令行\其他进程与我的 chrome 扩展进行通信？如果我的扩展程序可以从脚本\命令行获取可以调用我的扩展程序上的函数的命令，我需要我的扩展程序。我正在寻找类似套接字的东西，但由于扩展是用 javascript 构建的，这似乎是不可能的（并且在 chrome 中传递的整个类似套接字的消息只允许您在自己的页面或其他扩展之间进行通信，而不是其他进程）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:18:33.977

HTML5 公开了一个称为[Web 套接字](http://www.websocket.org/index.html)的 JavaScript 套接字接口，它允许您从任何进程与您的扩展进行通信。Chrome 支持网络套接字。

# mongodb - MongoDB - 最适合复合索引？

> ID：12462155
> 
> 赞同：1
> 
> 时间：2012-09-17T15:08:44.563
> 
> 标签：mongodb

我正在向我的 MongoDB 数据库添加索引，并希望确保我以最佳方式完成所有工作。我有很多查询，我将根据 _id 字段选择一个文档，但随后还需要通过查询他们的用户 ID 来验证该文档是否属于当前用户。

例如：

`'_id'=>"123", "user_id"=>10`

我不确定我应该把索引放在哪里。哪个是索引的最佳解决方案..

*   就在_id
*   _id 和 user_id 的复合索引
*   别的东西

我真的应该将 customer_id 作为查询字段传递，还是应该从 MongoDB 返回客户 ID 并使用 PHP 代码检查它？即，如果查询只是查找_id 而不是_id 和customer_id，查询会执行得更快吗？在 PHP 中通过 if 语句检查客户 ID 是否比通过 MongoDB 中的查询更快。

任何想法将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:41:56.593

如果您`_id`的查询中有一个，默认`_id`索引就足够了（您不需要创建它）。这是一个独特的查找。你不需要过滤更多！如果您有其他字段要过滤，则查询不应运行得更慢。

# sql - Oracle 认为更改期间表不存在

> ID：12462156
> 
> 赞同：3
> 
> 时间：2012-09-17T15:08:46.347
> 
> 标签：sql, oracle, oracle11g

我正在尝试使用以下语法更改表上的列：

```
ALTER TABLE MY_SCHEMA.latest_workspace MODIFY (short_name VARCHAR2(10) NOT NULL); 
```

这是我得到的错误：

> 从命令的第 1 行开始出错：ALTER TABLE MY_SCHEMA.latest_workspace MODIFY (short_name VARCHAR2(10) NOT NULL) 错误报告：SQL 错误：ORA-00942：表或视图不存在 00942.00000 -“表或视图不存在" *原因：
> *措施：

但是，我可以在物理上很好地查看该表并使用以下命令对其进行查询：

```
SELECT short_name FROM MY_SCHEMA.latest_workspace; 
```

此外，所有正确的权限都授予我登录的用户。还有什么我忘记的东西会导致 ALTER 发生这种情况吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:20:42.493

它看起来`MY_SCHEMA.latest_workspace`不是一张桌子。它可能是一个视图，也可能是其他模式中对象的同义词。试试这个查询来找出：

```
select object_type
from   user_objects
where object_name = 'LATEST_WORKSPACE'; 
```

您随后需要采取的行动取决于结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-11T11:51:36.553

我发现解决此问题的唯一方法是重新创建表。（重命名、删除约束和索引、重新创建原始表、插入记录）。

找不到原因，但听起来我像一个错误。

# visual-studio - 如何更改“。” 到 vb 6 中的 ","

> ID：12462157
> 
> 赞同：1
> 
> 时间：2012-09-17T15:08:48.037
> 
> 标签：visual-studio, vb6

我正在修改 vb 6 中的旧应用程序（对于我的工作），它将数据读入数据库，然后将这些数据写入 csv 文件。

我读取数据没有问题，但是当我将它们写入csv文件时，整个部分和小数部分用“。”分隔。但我需要用“，”分隔这些

你能帮我建立一个小功能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:14:18.723

您可以使用内置函数`Replace`来执行此操作：

```
 new_string = replace(old_string, ".", ",") 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T15:14:30.393

```
mystring = Replace(sourceString, ".", ",") 
```

有关更多信息，请参见[此处](http://www.tek-tips.com/faqs.cfm?fid=418)和[此处](http://msdn.microsoft.com/en-us/library/bt3szac5%28v=vs.80%29.aspx)。

# c# - 为什么这个 SQL insert into table 语句在 C# 中不起作用？

> ID：12462159
> 
> 赞同：0
> 
> 时间：2012-09-17T15:08:57.690
> 
> 标签：c#, sql, insert, oracle11g

当 ExcuteNonQuery 执行时，我得到一个 ORAC 0936。我想我的问题是我的 SQL 的 VALUES 部分。在此先感谢您的帮助

```
public int NewFunction(int UserID, string fName, string fDescription, string connectionStr)
        {
            OracleConnection connection = new OracleConnection(connectionStr);
            try
            {
                //PLease Note that User ID and  fDescription are passed into the function as  
//parameters
                connection.Open();

                OracleCommand command = connection.CreateCommand();

                OracleTransaction transaction = connection.BeginTransaction();
                command.Transaction = transaction;
                        string LoadedFileName = @WfName;//Fd.FileName;
               //read the xaml content from file 
                command.CommandText = "INSERT INTO XYZ(ID, NAME , F_SCRIPT) VALUES (@UserID, @fDescription, EMPTY_CLOB())";

                command.ExecuteNonQuery();
                transaction.Commit();
               } 
```

///////////////////////////////////////// ///////////////// // ***** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** *** //好的，谢谢大家的回复。这就是我使用stackckoverflow的其他帖子解决其他问题的方式。请注意 fDescription 和 USerID 被传递给函数。

command.CommandText = "INSERT INTO IMS_Workflow (ID, NAME , F_SCRIPT) VALUES ('" + UserID + "', '" + WfDescription + "', EMPTY_CLOB())";

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:12:57.107

我可能遗漏了一些东西，但我看不到您将参数 @UserID 或 @fDescription 添加到命令对象的参数集合的位置。添加这些，我怀疑你应该没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T16:29:41.367

您的原始代码看起来像是在尝试使用参数化 SQL：

```
command.CommandText = "INSERT INTO XYZ(ID, NAME , F_SCRIPT) VALUES (@UserID, @fDescription, EMPTY_CLOB())"; 
```

...但您从未设置参数的*值*，并且它使用 SQL Server 样式名称（`@`前缀而不是`:`）。您需要正确声明参数，并给它们赋值，例如

```
command.CommandText = "INSERT INTO XYZ(ID, NAME , F_SCRIPT) VALUES (:UserID, :fDescription, EMPTY_CLOB())";
command.Parameters.Add("UserId", OracleType.Number).Value = userId;
command.Parameters.Add("fDescription", OracleType.NVarChar).Value = fDescription; 
```

（前缀 of 也可能`@`会起作用；我只是通过文档中的示例进行说明。）

您的解决方法是将值直接嵌入到您的 SQL 中。**不要这样做**。您正在邀请[SQL 注入攻击](http://bobby-tables.com)。

# scala - Scala 编程的清单 10.9

> ID：12462163
> 
> 赞同：0
> 
> 时间：2012-09-17T15:09:06.777
> 
> 标签：scala, inheritance, abstract-class

我正在阅读“Scala 编程”中的第 10 章（组合和继承），我对代码清单 10.9 有点困惑。作者的代码清单如下：

```
abstract class Element{
  def contents:Array[String]
  def width: Int = if(height==0)0elsecontents(0).length
  def height: Int = contents.length
  def above(that: Element): Element =
      new ArrayElement(this.contents ++ that.contents)
  def beside(that: Element): Element=
              new ArrayElement(
                 for(
                   (line1, line2)<-this.contents zip that.contents
                ) yield line1+line2
              )
  override def toString = contents mkString "\n"
} 
```

我的困惑在于“上面”和“旁边”方法，这些方法是从抽象基类 Element 实例化一个子类 ArrayElement。这实际上是正确的还是我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:11:38.180

是的，你是对的。必须有某个类`AbstractElement`定义为 的子类`Element`。这两个方法是实例化这个类并返回新实例化的对象。

# excel - 将指定的行和列复制到包含自动求和功能的新工作簿

> ID：12462165
> 
> 赞同：0
> 
> 时间：2012-09-17T15:09:09.587
> 
> 标签：excel, vba

首先我不得不说我绝对没有编程的粘合剂。我什至不明白如何在这里做一个文本看起来像一个 Excel 列表。对此感到抱歉。我的问题是我必须将我们公司每个成员的电话单插入 Access-Database，并将 excle 文件也分发给每个成员。我每周都会收到一个名为 vodafone AUG_12（Vodafone 实际月份）的 Excel 工作表，其中包含超过 50000 行和几列。第一列包含几个电话号码，最后一列 (I) 包含从第一列中的号码每次拨打的费用。例如：

```
PhoneNu 日期时间整数。代码 城市 代码 目的地 描述 持续时间 成本

123456789 20120829 08:15:00 0049 431 12456 基尔 00:02:15 02.95
123456789 20120829 08:17:00 0049 431 12456 基尔 00:19.95 17.45
234567890 20120829 09:15:22 0031 21 5632145 里斯本 00:00:28 0.10
234567890 20120829 17:25:00 0031 21 5632145 里斯本 00:00:59 0.28
345678901 20120829 00:13:31 00351 91 5896 服务 00:03:45 2.58
345678901 20120829 06:45:13 00351 91 5896 服务 01:25:13 12.85
```

等等

有没有办法复制具有数字名称的新工作簿中每个数字的行，并将成本总和保存在与原始工作簿相同的文件夹中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T08:53:23.890

谁对它感兴趣，您可以在下面查看我的解决方案。我的数据文件运行大约 20 分钟。得出这个结果需要时间。通过重新复制复制的宏并记录/调整它们。

```
Sub delete_0()
    'change directory
Workbooks.Open Filename:= _
    "G:\01_Phone_Bills\extbills\v_201212\Vodafone_Dec_12.csv" 

   'delete all rows which contains 0 in column 15 in the original invoice
   Dim i As Long
Application.ScreenUpdating = False
For i = Cells(Rows.Count, 15).End(xlUp).Row To 1 Step -1
  If Cells(i, 15) = "0" Then Rows(i).Delete
Next i
Application.ScreenUpdating = True
'startthe next macros
 Application.Run "'make it readable.xlsm'!delete_member_PhoneNumbers"
Application.Run "'make it readable.xlsm'!delete_Tx_Easy_Roaming"
Application.Run "'make it readable.xlsm'!Make_it_readable"
Application.Run "'make it readable.xlsm'!renamesheet"
Application.Run "'make it readable.xlsm'!delete_non_user_phone_numbers"
 ChDir "G:\01_Phone_Bills\extbills\v_201212"
ActiveWorkbook.SaveAs Filename:= _
    "G:\01_Phone_Bills\extbills\v_201212\Vodafone_Dec_12.xlsm", FileFormat:= _
    xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False
Application.Run "'make it readable.xlsm'!Autosum_insert"
Application.Run "'make it readable.xlsm'!copy_amount"
Application.Run "'make it readable.xlsm'!delete_Bill_summery_0"
Application.Run "'make it readable.xlsm'!MakeMultipleXLSfromWB"
End Sub

Sub delete_member_PhoneNumbers()

 'delete all rows which contains phone number ... in column 10
 'in the original invoice, user have not to pay for that calls 

Dim a As Long
Application.ScreenUpdating = False
For a = Cells(Rows.Count, 10).End(xlUp).Row To 1 Step -1
  If Cells(a, 10) = "123456789" Then Rows(a).Delete
 Next a
 Application.ScreenUpdating = True

 End Sub

 Sub delete_Tx_Easy_Roaming()

'delete all rows which contains Tx Easy Roaming in column 11
'in the original invoice, user have not to pay for that fee     

Dim i As Long
Application.ScreenUpdating = False
For i = Cells(Rows.Count, 11).End(xlUp).Row To 1 Step -1
  If Cells(i, 11) = "Tx Easy Roaming" Then Rows(i).Delete
Next i
Application.ScreenUpdating = True
End Sub

 Sub Make_it_readable()
 '
 ' Convert the original invoice into a readable excel format

 ' Replace all file names

 '

 Rows("1:3").Select
 Selection.Delete Shift:=xlUp
 Cells.Select
 Cells.EntireColumn.AutoFit
 Columns("A:A").Select
 Selection.Delete Shift:=xlToLeft
 Columns("B:D").Select
 Selection.Delete Shift:=xlToLeft
 Columns("I:J").Select
 Selection.Delete Shift:=xlToLeft
 Columns("I:I").Select
 Selection.NumberFormat = "#,##0.00"
 Columns("J:L").Select
 Selection.Delete Shift:=xlToLeft
 Range("A1").Select
 ActiveCell.FormulaR1C1 = "PhoneNu"
 Range("B1").Select
 ActiveCell.FormulaR1C1 = "Date"
 Range("C1").Select
 ActiveCell.FormulaR1C1 = "Time"
 Range("D1").Select
 ActiveCell.FormulaR1C1 = "Country Code"
 Range("E1").Select
 ActiveCell.FormulaR1C1 = "City Code"
 Range("F1").Select
 ActiveCell.FormulaR1C1 = "Destination"
 Columns("F:F").Select
 Selection.NumberFormat = "0"
 Range("G1").Select
 ActiveCell.FormulaR1C1 = "Description"
 Range("H1").Select
 ActiveCell.FormulaR1C1 = "Duration"
 Range("I1").Select
 ActiveCell.FormulaR1C1 = "Cost"
 Range("J1").Select
 ActiveCell.FormulaR1C1 = "Total amount"
 Cells.Select
 Cells.EntireColumn.AutoFit
 Cells.Select
 ActiveWorkbook.Worksheets("Vodafone_Dec_12").Sort.SortFields.Clear 'replace "Voda..."
 ActiveWorkbook.Worksheets("Vodafone_Dec_12").Sort.SortFields.Add Key:=Range( _
    "A2:A50000"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
    xlSortNormal
 With ActiveWorkbook.Worksheets("Vodafone_Dec_12").Sort 'replace "Voda..."
    .SetRange Range("A1:R50000")
    .Header = xlYes
    .MatchCase = False
    .Orientation = xlTopToBottom
    .SortMethod = xlPinYin
    .Apply
 End With
 Columns("A:A").Select
 Selection.NumberFormat = "## #######"
 ActiveSheet.Name = "Bill Summery"

  'create the number of sheets which you need
    Dim lnumber As String
    Dim i As Long
     Anf:
    lnumber = InputBox("How often should the macro run ?", , 3)

     'check the input for a figure
   If IsNumeric(lAnzahl) Then
    For i = 1 To CLng(lnumber)
        Range("A:A:J:J").Select
        Selection.Copy
        Sheets.Add After:=Sheets(Sheets.Count)
        ActiveSheet.Paste

     Next i
  Else
     MsgBox "Please enter a figure !", vbInformation
    GoTo Anf
End If

End Sub

Sub renamesheet()
'
' renames each sheet
'

 '

Sheets("Sheet1").Name = "Tel 123456789"
Sheets("Sheet2").Name = "Tel 234567890"
Sheets("Sheet3").Name = "Tel 345678901"

Public Sub delete_non_user_phone_numbers()

'delte all pfone numbers without that from the user

'Sheet activation
 Sheets("Tel 123456789").Select
 'find last row
 lz = Cells(Rows.Count, 1).End(xlUp).Rows.Row
 'check all rows
 For t = lz To 2 Step -1 'count back to row 2
 'check if ther is "..."in the first column
 If Not Cells(t, 1).Value = "123456789" Then
    Rows(t).Delete Shift:=xlUp
  End If
 Next t
 'Sheet activation
 Sheets("Tel 234567890").Select
      lz = Cells(Rows.Count, 1).End(xlUp).Rows.Row
 For t = lz To 2 Step -1 
 If Not Cells(t, 1).Value = "234567890" Then
    Rows(t).Delete Shift:=xlUp
End If
 Next t
'Sheet activation
 Sheets("Tel 345678901").Select
 lz = Cells(Rows.Count, 1).End(xlUp).Rows.Row
 For t = lz To 2 Step -1 
 If Not Cells(t, 1).Value = "345678901" Then
    Rows(t).Delete Shift:=xlUp
 End If
 Next t

  Sub Autosum_insert()

'do the autosum in each sheet column I and fill it in J2

ActiveWindow.ScrollWorkbookTabs Position:=xlFirst
Sheets("Bill Summery").Select
Columns("A:J").Select
Selection.Delete Shift:=xlToLeft
ActiveWindow.ScrollWorkbookTabs Position:=xlLast
Sheets(Array("Bill Summery", "Tel 123456789", "Tel 234567890", "Tel 345678901")).Select
Sheets("Bill Summery").Activate

Dim intI As Integer
For intI = 2 To ThisWorkbook.Worksheets.Count
Range("J2").Select
ActiveCell.FormulaR1C1 = "=SUM(RC[-1]:R[1111]C[-1])"

Next intI
End Sub

 Sub copy_amount()
 '
 ' copy_amount Macro
 '
 'copy A1 and J2 from every sheet in Bill Summery
 '
 Sheets("Tel 123456789").Select
 Range("J2,A2").Select
 Selection.Copy
 Sheets("Bill Summery").Select
 Range("A1:B1").Select
 ActiveSheet.Paste

 Sheets("Tel 234567890").Select
 Range("J2,A2").Select
 Selection.Copy
 Sheets("Bill Summery").Select
 Range("A2:B2").Select

 ActiveSheet.Paste
 Sheets("Tel 345678901").Select
 Range("J2,A2").Select
 Selection.Copy
 Sheets("Bill Summery").Select
 Range("A3:B3").Select
 ActiveSheet.Paste

 End Sub

 Sub delete_Bill_summery_0()

 'delete all rows in sheet Bill summery which have a 0 printed in column2

 Sheets("Bill Summery").Select
 Dim i As Long
 Application.ScreenUpdating = False
 For i = Cells(Rows.Count, 2).End(xlUp).Row To 1 Step -1
  If Cells(i, 2) = "0" Then Rows(i).Delete
  Next i
 End Sub

 Option Explicit

 Sub MakeMultipleXLSfromWB()

 'Split worksheets in current workbook into
 ' many separate workbooks  D.McRitchie, 2004-06-12
 'Close each module  AND the VBE before running to save time
 ' provides a means of seeing how big sheets really are
 'Hyperlinks and formulas pointing to other worksheets within
 ' the original workbook will usually be unuseable in the new workbooks.
  Dim CurWkbook As Workbook
 Dim wkSheet As Worksheet
 Dim newWkbook As Workbook
 Dim wkSheetName As String
 Dim shtcnt(3) As Long
 Dim xpathname As String, dtimestamp As String
 dtimestamp = Format(Now, "yyyymmdd_hhmmss")
 'change the directory
 xpathname = "G:\01_Phone_Bills\extbills\v_201212\D" & dtimestamp & "\"
 MkDir xpathname
 Set CurWkbook = Application.ActiveWorkbook

 shtcnt(2) = ActiveWorkbook.Sheets.Count
 Application.ScreenUpdating = False
 Application.Calculation = xlCalculationManual
 For Each wkSheet In CurWkbook.Worksheets
  shtcnt(1) = shtcnt(1) + 1
  Application.StatusBar = shtcnt(1) & "/" & shtcnt(2) & _
      "  " & wkSheet.Name
  wkSheetName = Trim(wkSheet.Name)
  If wkSheetName = Left(Application.ActiveWorkbook.Name, _
     Len(Application.ActiveWorkbook.Name) - 4) Then _
     wkSheetName = wkSheetName & "_D" & dtimestamp
  Workbooks.Add
  ActiveWorkbook.SaveAs _
     Filename:=xpathname & wkSheetName & ".xls", _
     FileFormat:=xlNormal, Password:="", _
     WriteResPassword:="", CreateBackup:=False, _
     ReadOnlyRecommended:=False
  Set newWkbook = ActiveWorkbook

  Application.DisplayAlerts = False
  newWkbook.Worksheets("sheet1").Delete
  On Error Resume Next
  newWkbook.Worksheets(wkSheet.Name).Delete
  On Error GoTo 0
  Application.DisplayAlerts = True

  CurWkbook.Worksheets(wkSheet.Name).Copy Before:=newWkbook.Sheets(1)
  'no duplicate sheet1 because they begin with "a"
  ActiveWorkbook.Save
  ActiveWorkbook.Close
 Next wkSheet
 Application.StatusBar = False      'return control to Excel
 Application.Calculation = xlCalculationAutomatic
 Application.ScreenUpdating = True
 End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:15:14.740

您想将这 50000 条记录拆分为单个否，然后为每个唯一的否创建一个包含所有详细信息的工作表/工作簿，然后计算成本吗？

如果是

--> 为了让它更快，我会使用 c# 并通过 ado 链接到 excel，但你说编程不是你的最佳点：D

--> 使用 vba（需要一些时间才能完成）循环遍历这些行，然后简单地将整行复制到具有电话号码名称的新工作表中。完成循环后，通过工作表并设置总和：获取成本下方的最后一个单元格并使用 setformula 输入总和。

# mongodb - mongodb - 无法使用默认配置启动副本集

> ID：12462167
> 
> 赞同：0
> 
> 时间：2012-09-17T15:09:18.060
> 
> 标签：mongodb, replication

我正在按照[本](http://docs.mongodb.org/manual/tutorial/deploy-replica-set/)教程部署副本集。当我执行时，`rs.initiate()`我收到错误“所有成员和种子必须可以访问才能启动设置”，这很奇怪，因为唯一的成员是 localhost。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T12:01:33.050

我有同样的错误。就我而言，这帮助了我：

```
cfg=rs.conf()
rs.reconfig(cfg,{force:true}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T16:01:32.173

您不能仅使用一个成员启动副本集（您在哪里复制数据？！）。本教程告诉您需要三个活动的 mongod 实例。

> 要求：三个不同的系统，以便每个系统都可以运行自己的 mongod 实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T19:28:33.477

出于测试目的，您**可以**在同一台物理机器上拥有给定副本集的三个成员（教程提到：“对于临时测试和本指南的目的，您可以在 GNU Screen 的单独窗口中运行 mongod 实例。” ) 您只需要在您机器上的三个不同端口上运行三个不同的 mongod 实例。从您收到的错误来看，似乎一个或另一个*端口*无法访问。只需检查您的端口是否已被其他应用程序使用。如果是这样，那么相应的 mongod 一开始就不会成功启动。因此， rs.initiate() 会失败。

# asp.net - 有没有办法让 DESCryptoServiceProvider 不使用加号等特殊字符？

> ID：12462172
> 
> 赞同：0
> 
> 时间：2012-09-17T15:09:52.160
> 
> 标签：asp.net, asp.net-mvc-3, base64, url-encoding

创建加密字符串时：

```
 using(var cryptoProvider = new DESCryptoServiceProvider())
    {
      cryptoProvider.Key = Convert.FromBase64String(Key);
      cryptoProvider.IV = Convert.FromBase64String(Key);

      var encryptedString = cryptoProvider
        .CreateEncryptor()
        .TransformFinalBlock(serializedBytes, 0, serializedBytes.Length);

      return Convert.ToBase64String(encryptedString); 
```

有没有办法阻止它使用某些字符？实际引起问题的字符是“+”号。当 asp.net 解码并且（例如）+ 号变成空格时，问题就很明显了。

可能还有其他字符会落入同一问题，但 + 号似乎是我遇到的唯一一个问题。有没有办法让加密不使用某个字符，或者在我的加密逻辑中防止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:12:04.503

不，但您可以只调用`Url.Encode()`生成的字符串。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:12:43.567

这与加密和 DES 完全无关。

Base64 负责生成这些字符。由于只有 62 个字母数字 ASCII 字符，因此需要另外两个字符才能获得完整的 64 个字符。按照惯例，这两个字符是`+`和`/`，用于填充它使用`=`.

现在，您可以根据需要替换一些其他字符`+`，或者您可以在输出中使用 url 编码。`/``string.Replace`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T17:47:07.133

因此，在我在 url 中使用加密值的特殊情况下，为了避免提到的 url 编码/解码管理噩梦，使用

```
HttpUtilityServer.UrlTokenEncode / UrlTokenDecode 
```

处理 To64BaseString() 使用的填充 Ascii 值带来的所有问题。

# java - Spring MVC 3 JSON

> ID：12462173
> 
> 赞同：0
> 
> 时间：2012-09-17T15:10:02.773
> 
> 标签：java, json, jsp, spring-mvc

我被这个问题困扰了很长时间。我查看了 Internet 上的资源，但找不到我哪里出错了。我已将 Spring MVC 配置为发送和接收 JSON。当我从 Web 浏览器为 @ResponseBody 调用 RESTful 服务时，返回的对象以 JSON 形式返回。但是，当尝试调用 @RequestBody 时，我无法做到。

下面是代码：

web.xml

```
<?xml version="1.0" encoding="UTF-8"?> 
     <display-name>WebApp</display-name>

     <context-param>
        <!-- Specifies the list of Spring Configuration files in comma     separated format.-->
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/history-service.xml</param-value>
     </context-param>

     <listener>
        <!-- Loads your Configuration Files-->
        <listener-    class>org.springframework.web.context.ContextLoaderListener</listener-class>
     </listener>

     <servlet>
        <servlet-name>history</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
     </servlet>

     <servlet-mapping>
        <servlet-name>history</servlet-name>
        <url-pattern>/</url-pattern>
     </servlet-mapping>

     <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
     </welcome-file-list> 
```

历史服务.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<beans>     
    <context:component-scan base-package="com.web"/>

    <mvc:annotation-driven/>

    <context:annotation-config/>

    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping"/>

    <bean id="jacksonMessageChanger" class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter">
        <property name="supportedMediaTypes" value="application/json"/>
    </bean>

    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
        <property name="messageConverters">
            <list>
                <ref bean="jacksonMessageChanger"/>
            </list>
        </property>
    </bean>

    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix" value="/WEB-INF/jsp/"/>
        <property name="suffix" value=".jsp"/>
    </bean>

    <!-- <bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">
        <property name="mediaTypes">
            <map>
                <entry key="json" value="application/json"/>
            </map>
        </property>
    </bean>--> 
```

控制器类

```
 @Controller
   @RequestMapping("/history/*")
   public class ControllerI {

@RequestMapping(value = "save", method = RequestMethod.POST, headers = {"content-            type=application/json"})
public @ResponseBody UserResponse save(@RequestBody User user) throws Exception {
    UserResponse userResponse = new UserResponse();
    return userResponse;
}

@RequestMapping(value = "delete", method = RequestMethod.GET)
public @ResponseBody UserResponse delete() {
    System.out.println("Delete");
    UserResponse userResponse = new UserResponse();
    userResponse.setSuccess(true);
    return userResponse;
} 
```

调用 /webapp/history/delete 时，我可以收到 JSON。

索引.jsp

```
 <%@page language="java" contentType="text/html"%>
 <html>
 <head>
 </head>
 <body>
 <h2>WebApp</h2>
<form action="/webapp/history/save" method="POST" accept="application/json">
    <input name="userId" value="Hello">
    <input name="location" value="location">
    <input name="emailAddress" value="hello@hello.com">
    <input name="commitMessage" value="I">
    <input type="submit" value="Submit">
</form>
</body>
</html> 
```

但是，在调用 /save 时出现以下错误：

```
org.springframework.web.servlet.mvc.support.DefaultHandlerE
xceptionResolver handleNoSuchRequestHandlingMethod
WARNING: No matching handler method found for servlet request: path '/history/sa
ve', method 'POST', parameters map['location' -> array<String>['location'], 'use
rId' -> array<String>['Hello'], 'emailAddress' -> array<String>['hello@hello.com'], 'commitMessage' -> array<String>['I']] 
```

我不确定我哪里出错了。我要做的就是通过 JSP 将 JSON 发送到 Spring MVC 控制器，这样@RequestBody 就可以从 JSON 反序列化为 Java。

我希望你能帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:21:07.093

您没有发布 JSON 数据。您必须使用 javascript 或其他东西将表单输入转换为 JSON。Jquery 对此非常有用。或更改您的控制器以接受

```
headers = "content-type=application/x-www-form-urlencoded" 
```

仅供参考，您可以在提交表单时使用 FF 或 Chrome 的开发人员工具查看标题。特别是网络面板（适用于 Chrome）。 [https://developers.google.com/chrome-developer-tools/docs/network](https://developers.google.com/chrome-developer-tools/docs/network)

我相信它是 Firefox 中的 Web 控制台。[https://developer.mozilla.org/en-US/docs/Tools/Web_Console?redirectlocale=en-US&redirectslug=Using_the_Web_Console](https://developer.mozilla.org/en-US/docs/Tools/Web_Console?redirectlocale=en-US&redirectslug=Using_the_Web_Console)

使用 Jquery 发布表单输入：

```
<script type="text/javascript">
   $(function() {
     var frm = $("#MyForm); // In the JSP/HTML give your form an id (<form id="MyForm" ...)
     var dat = JSON.stringify(frm.serializeArray());

     $.ajax({
          type: 'POST',
          url: url,
          data: dat,
          success: function(hxr) {
              alert("Success: " + xhr);
          }

          dataType: 'json'
       });
     );
 });
</script> 
```

更多信息在这里： [http ://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:42:23.083

在 HTML 表单上将accept **="application/json"**更改为**enctype="application/json"**。

Spring 无法解析您发布的数据，因为您没有设置当前标题。使用 @RequestBody 时，默认接受 enctype 是 application/json。尝试其中之一：

1.  在您的 html 表单或 js 发布功能上设置 post headers="content-type=application/json"。
2.  将您的控制器设置为接受 headers="content-type=application/x-www-form-urlencoded"。

编辑

enctype 必须与标头相同。好的，代码现在看起来像其中之一：

```
// the one
@RequestMapping(value = "save", method = RequestMethod.POST)
public @ResponseBody UserResponse save(@RequestBody User user) throws Exception {
    UserResponse userResponse = new UserResponse();
    return userResponse;
}

</form>
<form action="/webapp/history/save" method="POST" enctype="application/x-www-form-urlencoded">
    <input name="userId" value="user">
    <input name="location" value="location">
    <input name="emailAddress" value="hello@hello.com">
    <input name="commitMessage" value="I">
    <input type="submit" value="Submit">
</form>

// the other
@RequestMapping(value = "save", method = RequestMethod.POST, headers = {"content-type=application/x-www-form-urlencoded"})
public @ResponseBody UserResponse save(@RequestBody User user) throws Exception {
    UserResponse userResponse = new UserResponse();
    return userResponse;
}

</form>
<form action="/webapp/history/save" method="POST" enctype="application/json">
    <input name="userId" value="user">
    <input name="location" value="location">
    <input name="emailAddress" value="hello@hello.com">
    <input name="commitMessage" value="I">
    <input type="submit" value="Submit">
</form> 
```

尝试上述之一。

> 我收到以下错误：
> 
> HTTP 错误 415：服务器拒绝此请求，因为请求实体的格式不受所请求方法 () 的请求资源支持。

# gwt - Requestfactory 克隆代理到新的上下文

> ID：12462174
> 
> 赞同：2
> 
> 时间：2012-09-17T15:10:12.690
> 
> 标签：gwt, requestfactory

我正面临 gwt 问题 5794：[http ://code.google.com/p/google-web-toolkit/issues/detail?id=5794](http://code.google.com/p/google-web-toolkit/issues/detail?id=5794)

我看到有一个 8 个月大的补丁，但它没有包含在 gwt 2.5 RC1 [http://gwt-code-reviews.appspot.com/1620804/](http://gwt-code-reviews.appspot.com/1620804/)

有谁知道这个补丁是否会包含在 gwt 2.5 rc2 或最终版本中？

如果没有，有人可以向我解释一下解决该问题的最佳方法是什么。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T02:37:54.127

我从 AbstractRequestContext 的 copyBeanAndCollections 方法中想出了这个。它似乎完成了我想要将代理克隆到具有新上下文的另一个代理的工作。这本质上要求您首先创建一个新代理或使用新上下文编辑代理，但我不再需要使用复制构造函数将属性迭代地复制到新代理。我仍在测试，但我创建了一个简单的 GWTTestCase，它似乎工作正常。

**快速更新**

我解决了请求工厂实体定位器无法解析类型的问题，因此我添加了 stableid 和 version 标签以进行克隆。这可能是个坏主意，当我确定稳定 ID 是否用于对原始对象的实际引用的类类型时，我会更新。我的猜测是它用于解析服务器端的类型。

```
public class ProxyUtils {

    public static <T extends BaseProxy> AutoBean<T> cloneBeanProperties(final T original, final T clone, final RequestContext toContext) {

        AutoBean<T> originalBean = AutoBeanUtils.getAutoBean(original);
        AutoBean<T> cloneBean = AutoBeanUtils.getAutoBean(clone);

        return cloneBeanProperties(originalBean, cloneBean, toContext);
    }

    /**
     * Shallow-clones an autobean and makes duplicates of the collection types.
     * A regular {@link AutoBean#clone} won't duplicate reference properties.
     */
    public static <T extends BaseProxy> AutoBean<T> cloneBeanProperties(final AutoBean<T> toClone, final AutoBean<T> clone, final RequestContext toContext) {
        // NOTE: This may be a bad idea, i don't know if the STABLE_ID is the type or if it is the
        // actual server side reference to this object. Don't want it to update my original object.
        // I added this back in because I was getting an InstantionException in the locator I am
        // pretty sure this is because request factory server side could not resolve the class type. 
        // Maybe someone could shed some light on this one, if you know what the stable id is really
        // used for. 
        clone.setTag(STABLE_ID, toClone.getTag(STABLE_ID));
        clone.setTag(Constants.VERSION_PROPERTY_B64, toClone.getTag(Constants.VERSION_PROPERTY_B64));
        clone.accept(new AutoBeanVisitor() {
            final Map<String, Object> values = AutoBeanUtils.getAllProperties(toClone);

            @Override
            public boolean visitCollectionProperty(String propertyName, AutoBean<Collection<?>> value, CollectionPropertyContext ctx) {
                // javac generics bug
                value = AutoBeanUtils.<Collection<?>, Collection<?>> getAutoBean((Collection<?>) values.get(propertyName));
                if (value != null) {
                    Collection<Object> collection;
                    if (List.class == ctx.getType()) {
                        collection = new ArrayList<Object>();
                    } else if (Set.class == ctx.getType()) {
                        collection = new HashSet<Object>();
                    } else {
                        // Should not get here if the validator works correctly
                        throw new IllegalArgumentException(ctx.getType().getName());
                    }

                    if (isValueType(ctx.getElementType()) || isEntityType(ctx.getElementType())) {
                        /*
                         * Proxies must be edited up-front so that the elements
                         * in the collection have stable identity.
                         */
                        for (Object o : value.as()) {
                            if (o == null) {
                                collection.add(null);
                            } else {
                                collection.add(editProxy(toContext, (Class<T>) ctx.getType(), (T) o));
                            }
                        }
                    } else {
                        // For simple values, just copy the values
                        collection.addAll(value.as());
                    }

                    ctx.set(collection);
                }
                return false;
            }

            @Override
            public boolean visitReferenceProperty(String propertyName, AutoBean<?> value, PropertyContext ctx) {
                value = AutoBeanUtils.getAutoBean(values.get(propertyName));
                if (value != null) {
                    if (isValueType(ctx.getType()) || isEntityType(ctx.getType())) {
                        /*
                         * Value proxies must be cloned upfront, since the value
                         * is replaced outright.
                         */
                        @SuppressWarnings("unchecked")
                        AutoBean<BaseProxy> valueBean = (AutoBean<BaseProxy>) value;
                        ctx.set(editProxy(toContext, (Class<T>) ctx.getType(), (T) valueBean.as()));
                    } else {
                        ctx.set(value.as());
                    }
                }
                return false;
            }

            @Override
            public boolean visitValueProperty(String propertyName, Object value, PropertyContext ctx) {
                ctx.set(values.get(propertyName));
                return false;
            }
        });
        return clone;
    }

    /**
     * Take ownership of a proxy instance and make it editable.
     */
    private static <T extends BaseProxy> T editProxy(RequestContext ctx, Class<T> clazz, T object) {
        AutoBean<T> toClone = AutoBeanUtils.getAutoBean(object);

        // Create editable copies
        AutoBean<T> parent = toClone;

        AutoBean<T> clone = (AutoBean<T>) ctx.create(clazz);
        AutoBean<T> cloned = cloneBeanProperties(toClone, clone, ctx);

        cloned.setTag(Constants.PARENT_OBJECT, parent);
        return cloned.as();
    }

    private static boolean isEntityType(Class<?> clazz) {
        return isAssignableTo(clazz, EntityProxy.class);
    }

    private static boolean isValueType(Class<?> clazz) {
        return isAssignableTo(clazz, ValueProxy.class);
    }

    public static boolean isAssignableTo(Class<?> thisClass, Class<?> assignableTo ) {
        if(thisClass == null || assignableTo == null) {
          return false;
        }

        if(thisClass.equals(assignableTo)) {
            return true;
        }

        Class<?> currentSuperClass = thisClass.getSuperclass();
        while(currentSuperClass != null) {
            if(currentSuperClass.equals(assignableTo)) {
                return true;
            }
            currentSuperClass = thisClass.getSuperclass();
        }
        return false;
    }
} 
```

这是我成功完成的简单单元测试。我确实有一些错误，我必须在 isAssignableFrom 方法中进行调查。

```
 public void testCloneProxy() {
        DaoRequestFactory requestFactory = GWT.create(DaoRequestFactory.class);
        RequestContext fromContext = requestFactory.analyticsTaskRequest();

        AnalyticsOperationInputProxy from = fromContext.create(AnalyticsOperationInputProxy.class);

        from.setDisplayName("DISPLAY 1");
        from.setInputName("INPUT 1");

        RequestContext toContext = requestFactory.analyticsTaskRequest();

        AnalyticsOperationInputProxy to = toContext.create(AnalyticsOperationInputProxy.class);

        ProxyUtils.cloneBeanProperties(from, to, toContext);

        System.out.println("Cloned output " + to.getDisplayName());
        System.out.println("Cloned output " + to.getInputName());

        Assert.assertTrue("Display name not equal" , from.getDisplayName().equals(to.getDisplayName()));
        Assert.assertTrue("Input name not equal" , from.getInputName().equals(to.getInputName()));

    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-24T20:31:30.610

好吧，我认为 Chris Hinshaw 编写了一个很棒的代码来克隆代理，但我会更改一行以使其更好，避免第 129 行出现无限循环

```
public class ProxyUtils {

public static <T extends BaseProxy> AutoBean<T> cloneBeanProperties(final T original, final T clone, final RequestContext toContext) {

    AutoBean<T> originalBean = AutoBeanUtils.getAutoBean(original);
    AutoBean<T> cloneBean = AutoBeanUtils.getAutoBean(clone);

    return cloneBeanProperties(originalBean, cloneBean, toContext);
}

/**
 * Shallow-clones an autobean and makes duplicates of the collection types.
 * A regular {@link AutoBean#clone} won't duplicate reference properties.
 */
public static <T extends BaseProxy> AutoBean<T> cloneBeanProperties(final AutoBean<T> toClone, final AutoBean<T> clone, final RequestContext toContext) {
    // NOTE: This may be a bad idea, i don't know if the STABLE_ID is the type or if it is the
    // actual server side reference to this object. Don't want it to update my original object.
    // I added this back in because I was getting an InstantionException in the locator I am
    // pretty sure this is because request factory server side could not resolve the class type. 
    // Maybe someone could shed some light on this one, if you know what the stable id is really
    // used for. 
    clone.setTag(STABLE_ID, clone.getTag(STABLE_ID));
    clone.setTag(Constants.VERSION_PROPERTY_B64, toClone.getTag(Constants.VERSION_PROPERTY_B64));
    clone.accept(new AutoBeanVisitor() {
        final Map<String, Object> values = AutoBeanUtils.getAllProperties(toClone);

        @Override
        public boolean visitCollectionProperty(String propertyName, AutoBean<Collection<?>> value, CollectionPropertyContext ctx) {
            // javac generics bug
            value = AutoBeanUtils.<Collection<?>, Collection<?>> getAutoBean((Collection<?>) values.get(propertyName));
            if (value != null) {
                Collection<Object> collection;
                if (List.class == ctx.getType()) {
                    collection = new ArrayList<Object>();
                } else if (Set.class == ctx.getType()) {
                    collection = new HashSet<Object>();
                } else {
                    // Should not get here if the validator works correctly
                    throw new IllegalArgumentException(ctx.getType().getName());
                }

                if (isValueType(ctx.getElementType()) || isEntityType(ctx.getElementType())) {
                    /*
                     * Proxies must be edited up-front so that the elements
                     * in the collection have stable identity.
                     */
                    for (Object o : value.as()) {
                        if (o == null) {
                            collection.add(null);
                        } else {
                            collection.add(editProxy(toContext, (Class<T>) ctx.getType(), (T) o));
                        }
                    }
                } else {
                    // For simple values, just copy the values
                    collection.addAll(value.as());
                }

                ctx.set(collection);
            }
            return false;
        }

        @Override
        public boolean visitReferenceProperty(String propertyName, AutoBean<?> value, PropertyContext ctx) {
            value = AutoBeanUtils.getAutoBean(values.get(propertyName));
            if (value != null) {
                if (isValueType(ctx.getType()) || isEntityType(ctx.getType())) {
                    /*
                     * Value proxies must be cloned upfront, since the value
                     * is replaced outright.
                     */
                    @SuppressWarnings("unchecked")
                    AutoBean<BaseProxy> valueBean = (AutoBean<BaseProxy>) value;
                    ctx.set(editProxy(toContext, (Class<T>) ctx.getType(), (T) valueBean.as()));
                } else {
                    ctx.set(value.as());
                }
            }
            return false;
        }

        @Override
        public boolean visitValueProperty(String propertyName, Object value, PropertyContext ctx) {
            ctx.set(values.get(propertyName));
            return false;
        }
    });
    return clone;
}

/**
 * Take ownership of a proxy instance and make it editable.
 */
private static <T extends BaseProxy> T editProxy(RequestContext ctx, Class<T> clazz, T object) {
    AutoBean<T> toClone = AutoBeanUtils.getAutoBean(object);

    // Create editable copies
    AutoBean<T> parent = toClone;

    AutoBean<T> clone = (AutoBean<T>) ctx.create(clazz);
    AutoBean<T> cloned = cloneBeanProperties(toClone, clone, ctx);

    cloned.setTag(Constants.PARENT_OBJECT, parent);
    return cloned.as();
}

private static boolean isEntityType(Class<?> clazz) {
    return isAssignableTo(clazz, EntityProxy.class);
}

private static boolean isValueType(Class<?> clazz) {
    return isAssignableTo(clazz, ValueProxy.class);
}

public static boolean isAssignableTo(Class<?> thisClass, Class<?> assignableTo ) {
    if(thisClass == null || assignableTo == null) {
      return false;
    }

    if(thisClass.equals(assignableTo)) {
        return true;
    }

    Class<?> currentSuperClass = thisClass.getSuperclass();
    if(currentSuperClass != null) {
        if(currentSuperClass.equals(assignableTo)) {
            return true;
        }
    }
    return false;
} 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:59:53.423

它不会。

从第一次审查（恰好是我自己）：

> 简而言之：这个补丁还不够，它打破了很多规则（“交叉流”），测试被打破了。

如果您无法使用问题中建议的序列化/反序列化解决方法，我相信有一种方法可以使用`AutoBeanVisitor`.

当前的“在给定时间只有一个 RequestContext 可以编辑给定代理（由其 stableId 标识）”真的很烦人，而且不是很合理（至少不再是；它在请求工厂的早期迭代中）。这是我想在未来摆脱的东西，但我们还有一些其他的大事要先做。

# sql - 将 SQL 案例语句显示为不同的列

> ID：12462176
> 
> 赞同：2
> 
> 时间：2012-09-17T15:10:30.417
> 
> 标签：sql, oracle, case

是否可以将`WHEN`case语句中的每个都输出到自己的列中？我试过了，但没有运气。下面是我最接近我想要的东西。

我目前有一个查询如下：

```
select BH.BATCH                 as batch_number, 
       BS.TBS_DESCRIPTION       as batch_description,
       BH.NUM_VOUCHERS          as "NUM_VOUCHERS(BATCH)",
       case when VS.TVS_CODE = 1 then count(*) else 0 end as in_stock,
       case when VS.TVS_CODE = 3 then count(*) else 0 end as terminate,
       case when VS.TVS_CODE = 5 then count(*) else 0 end as in_progress,
       case when VS.TVS_CODE = 6 then count(*) else 0 end as used,
       case when VS.TVS_CODE = 8 then count(*) else 0 end as deactivate
from BATCH_HIST   bh,
     BATCH_STATUS bs,
     VOUCH_HIST   vh,
     VOUCH_STATUS vs
where substr(BH.ALLOCAT_DATE, 1, 6) = 201207
and   to_char(BH.STATUS) = BS.TBS_CODE
and   BH.BATCH = VH.BATCH
and   to_char(VH.STATUS) = VS.TVS_CODE
group by BH.BATCH,
         BS.TBS_DESCRIPTION,
         BH.NUM_VOUCHERS,
         VS.TVS_CODE
order by 1,2,3; 
```

这给了我以下输出，每个输出都是`STATUS`不同的记录：

```
BATCH_NUMBER  | BATCH_DESCRIPTION  | NUM_VOUCHERS(BATCH)  | IN_STOCK  | TERMINATE  | IN_PROGRESS  | USED  | DEACTIVATE
------------------------------------------------------------------------------------------------------------------------------
4413565       |  Allocate          |  100                 |  67       |  0         |  0           |  0    |  0
4413565       |  Allocate          |  100                 |  0        |  0         |  0           |  33   |  0
4413566       |  Allocate          |  100                 |  63       |  0         |  0           |  0    |  0
4413566       |  Allocate          |  100                 |  0        |  0         |  0           |  37   |  0 
```

我希望将其组合在一起，以便每个有一个记录`BATCH_NUMBER`：

```
BATCH_NUMBER  | BATCH_DESCRIPTION  | NUM_VOUCHERS(BATCH)  | IN_STOCK  | TERMINATE  | IN_PROGRESS  | USED  | DEACTIVATE
------------------------------------------------------------------------------------------------------------------------------
4413565       |  Allocate          |  100                 |  67       |  0         |  0           |  33   |  0
4413566       |  Allocate          |  100                 |  63       |  0         |  0           |  37   |  0 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T15:17:19.990

正如您所写的，表达式需要 group by，但如果您对匹配项求和，则可以从 group by 中消除 tvs_code：

```
select BH.BATCH                 as batch_number, 
       BS.TBS_DESCRIPTION       as batch_description,
       BH.NUM_VOUCHERS          as "NUM_VOUCHERS(BATCH)",
       sum (case when VS.TVS_CODE = 1 then 1 else 0 end) as in_stock,
       sum (case when VS.TVS_CODE = 3 then 1 else 0 end) as terminate,
       sum (case when VS.TVS_CODE = 5 then 1 else 0 end) as in_progress,
       sum (case when VS.TVS_CODE = 6 then 1 else 0 end) as used,
       sum (case when VS.TVS_CODE = 8 then 1 else 0 end) as deactivate
from BATCH_HIST   bh,
     BATCH_STATUS bs,
     VOUCH_HIST   vh,
     VOUCH_STATUS vs
where substr(BH.ALLOCAT_DATE, 1, 6) = 201207
and   to_char(BH.STATUS) = BS.TBS_CODE
and   BH.BATCH = VH.BATCH
and   to_char(VH.STATUS) = VS.TVS_CODE
group by BH.BATCH,
         BS.TBS_DESCRIPTION,
         BH.NUM_VOUCHERS
order by 1,2,3; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:22:08.683

这包装了您当前的查询。也许这可以帮助你。

```
SELECT  subQuery.BATCH_NUMBER,
        subQuery.BATCH_DESCRIPTION,
        subquery."NUM_VOUCHERS(BATCH)",
        MAX(subquery.in_stock) AS in_stock,
        MAX(subquery.terminate) AS terminate,
        MAX(subquery.in_progress) AS in_progress,
        MAX(subquery.used) AS used,
        MAX(subquery.deactivate) AS deactivate
FROM
(
    select BH.BATCH                 as batch_number, 
           BS.TBS_DESCRIPTION       as batch_description,
           BH.NUM_VOUCHERS          as "NUM_VOUCHERS(BATCH)",
           case when VS.TVS_CODE = 1 then count(*) else 0 end as in_stock,
           case when VS.TVS_CODE = 3 then count(*) else 0 end as terminate,
           case when VS.TVS_CODE = 5 then count(*) else 0 end as in_progress,
           case when VS.TVS_CODE = 6 then count(*) else 0 end as used,
           case when VS.TVS_CODE = 8 then count(*) else 0 end as deactivate
    from BATCH_HIST   bh,
         BATCH_STATUS bs,
         VOUCH_HIST   vh,
         VOUCH_STATUS vs
    where substr(BH.ALLOCAT_DATE, 1, 6) = 201207
    and   to_char(BH.STATUS) = BS.TBS_CODE
    and   BH.BATCH = VH.BATCH
    and   to_char(VH.STATUS) = VS.TVS_CODE
    group by BH.BATCH,
             BS.TBS_DESCRIPTION,
             BH.NUM_VOUCHERS,
             VS.TVS_CODE
) AS subQuery
GROUP BY subQuery.BATCH_NUMBER,
        subQuery.BATCH_DESCRIPTION,
        subquery."NUM_VOUCHERS(BATCH)" 
```

# c++ - 为什么这种删除文件夹内文件的方法不起作用？

> ID：12462178
> 
> 赞同：3
> 
> 时间：2012-09-17T15:10:44.690
> 
> 标签：c++, winapi, directory, delete-file

```
std::wstring inxmpath ( L"folder" );
HANDLE hFind;
BOOL bContinue = TRUE;
WIN32_FIND_DATA data;
hFind = FindFirstFile(inxmpath.c_str(), &data); 
// If we have no error, loop through the files in this dir
int counter = 0;
while (hFind && bContinue) {
        std::wstring filename(data.cFileName);
        std::string fullpath = "folder/";
        fullpath += (const char* )filename.c_str();
        if(remove(fullpath.c_str())!=0) return error;
    bContinue = FindNextFile(hFind, &data);
    counter++;
}
FindClose(hFind); // Free the dir 
```

我不明白为什么它不起作用，我认为它与 wstring 和 string 之间的转换有关，但我不确定。我有一个包含一些 .txt 文件的文件夹，我需要使用 C++ 删除所有这些文件。里面没有文件夹什么都没有。这有多难？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:16:32.990

其次，根据MSDN关于`FindFirstFile`功能：

“在目录中搜索名称与特定名称匹配的文件或子目录（如果使用通配符，则为部分名称）。”

我在您的输入字符串中看不到通配符，所以我只能猜测它会查找在当前执行目录中`FindFirstFile`命名的文件。`"folder"`

尝试寻找`"folder\\*"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T21:16:19.177

试试这个：

```
std::wstring inxmpath = L"c:\\path to\\folder\\"; 
std::wstring fullpath = inxmpath + L"*.*";

WIN32_FIND_DATA data; 
HANDLE hFind = FindFirstFileW(fullpath.c_str(), &data);  
if (hFind != INVALID_HANDLE_VALUE)
{
    // If we have no error, loop through the files in this dir 
    BOOL bContinue = TRUE; 
    int counter = 0; 
    do
    { 
        if ((data.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY) == 0)
        {
            fullpath = inxmpath + data.cFileName; 
            if (!DeleteFileW(fullpath.c_str()))
            {
                FindClose(hFind);
                return error; 
            }
            ++counter; 
            bContinue = FindNextFile(hFind, &data); 
        }
    }
    while (bContinue);
    FindClose(hFind); // Free the dir 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:20:06.640

我可以看到2个问题：

1）如果你需要的话，我只会坚持使用宽弦。尝试改为调用[DeleteFile](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363915%28v=vs.85%29.aspx "删除文件")（假设您的项目是 UNICODE），您可以传递一个宽字符串。

2）您正在使用相对路径，其中绝对路径会更健壮。

# vba - 如何找到包含特定文本的列？(VBA)

> ID：12462181
> 
> 赞同：0
> 
> 时间：2012-09-17T15:10:59.017
> 
> 标签：vba

我在单元格 O12 或 R12 中有文本“投资收入”，我想知道 vba 代码是什么来确定文本是在列 O 还是列 R？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:39:56.173

这是一个非常基本的方法。它不会检查值是否在两个单元格中：

```
If InStr(Range("O12").Value, "Investment Income") Then
    MsgBox "It's in O12"
ElseIf InStr(Range("R12").Value, "Investment Income") Then
    MsgBox "It's in R12"
Else
    MsgBox "It's not in either of them."
End If 
```

# javascript - Xpages 部分刷新停止工作

> ID：12462187
> 
> 赞同：1
> 
> 时间：2012-09-17T15:11:22.327
> 
> 标签：javascript, xpages, partial-page-refresh, xpages-ssjs

我有一个显示可用联系人列表的 dijit。选定的联系人然后显示在视图面板中，该面板通过部分刷新进行更新，直到我添加了一些代码来检查是否没有选择重复的联系人。现在面板不会刷新。有任何想法吗？

这是检查重复项的 SSJS。抱歉，如果我没有正确解释这一点，或者对于这个“问题”有一个非常简单的解决方案 - 这里完全是菜鸟。

```
var viewPanel=getComponent("viewPanel1");
var docIDs=viewPanel.getSelectedIds();

for(i=0 ; i  <  docIDs.length ; i++){

    var docId = docIDs[i];

    var doc:NotesDocument = database.getDocumentByID(docId);
        // Get Contact Details from document
    var FName = doc.getItemValueString("Org_Con_FirstName");
    var LName = doc.getItemValueString("Org_Con_SurName");
    var FullName = FName + " " + LName;
    var Phone = doc.getItemValueString("Org_Con_Phone");
    var Email = doc.getItemValueString("Org_Con_Email");
    var Unid = doc.getUniversalID();

    var checkView = database.getView("oppContacts");
    var checkCollection  = checkView.getAllDocumentsByKey(sessionScope.oppKey);
    var checkCount = checkCollection.getCount();
    var counter = 0;
    if(checkCount != 0 ){
        var checkDoc = checkCollection.getFirstDocument();
        while(checkDoc!=null){
            var checkEmail = checkDoc.getItemValueString("Email")
            if(checkEmail==Email) counter = counter + 1;
            var tempDoc = checkCollection.getNextDocument();
            checkDoc.recycle();
            checkDoc = tempDoc;
        }
    }

    if(counter==0){
        var oppContact = database.createDocument();

        oppContact.replaceItemValue("Form","oppContact");
        oppContact.appendItemValue("ContactName",FullName);
        oppContact.appendItemValue("Email", Email);
        oppContact.appendItemValue("Phone", Phone);
        oppContact.appendItemValue("FullContact",Unid);
        oppContact.appendItemValue("OpportunityKey", sessionScope.oppKey);

        oppContact.save();

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T10:08:49.350

尝试在脚本结束时返回 true，以继续使用部分刷新面板的服务器选项。如果它遇到错误，那么它将返回 false。

`enter code here` // 在代码的开头 var bResult = false;

```
// inside if-statement : if (counter==0){ 
bResult = oppContact.save();

// at the end check bResult by setting sessionScope (using debug toolbar :-)
sessionScope.bResult = bResult;
// return true, hopefully
return bResult; 
```

您的代码会生成新文档吗？希望这可以帮助...

# grails - Grails 从哪里查询静态上下文？

> ID：12462189
> 
> 赞同：0
> 
> 时间：2012-09-17T15:11:27.490
> 
> 标签：grails, grails-orm

根据 Grails (2.1.1) 文档，我应该能够创建预定义的 where 查询，如下所示：

```
class Person {
    String firstName
    String lastName

    static simpsons = where {
         lastName == "Simpson"
    }
    …
} 
```

并像这样使用它：

```
Person.simpsons.each {
    println it.firstName
} 
```

但是无论我尝试什么，Grails/Java 一直告诉我，我无法从我理解的静态引用中访问非静态内容:) 但是我怎样才能实现文档中描述的内容？我通常使用 namedQueries，但我真的很喜欢定义 where 查询的易用性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T14:07:29.207

查看[文档](http://grails.org/doc/latest/ref/Domain%20Classes/where.html)，[在这里](http://grails.org/doc/latest/guide/single.html#whereQueries)他们没有说什么关于静态 where 子句的特别之处，您正试图从静态内容访问非静态*firstName*属性，这就是编译器试图告诉您的。

您可能对[namedQueries](http://grails.org/doc/latest/ref/Domain%20Classes/namedQueries.html)非常感兴趣，这可能就是您正在寻找的。

```
static namedQueries = {
       simpsons {
           eq(lastName,"Simpson")
       }
} 
```

接着：

```
Person.simpsons.list().each {
    println it.firstName
} 
```

# zend-framework - 使用 Zend Framework 提供两种语言的路由

> ID：12462196
> 
> 赞同：0
> 
> 时间：2012-09-17T15:12:04.313
> 
> 标签：zend-framework, routing

我正在将 PHP 应用程序从“自己的”“框架”移植到 Zend 框架（1.11.11）以及 Doctrine2。这一切都很顺利，除了该应用程序有两种语言版本，荷兰语和德语。我正在寻找一种使两个 URL 可访问的方法：

我用 Regex 路由尝试了这个，但它并不好，因为现在组装时必须始终给出“page”参数：

```
resources.router.routes.viewreviews.type = "Zend_Controller_Router_Route_Regex"
resources.router.routes.viewreviews.route = "(klantbeoordelingen|kundenbewertung)[/]?([0-9]*)"
resources.router.routes.viewreviews.reverse = "%s/%d"
resources.router.routes.viewreviews.defaults.module = "default"
resources.router.routes.viewreviews.defaults.controller = "review"
resources.router.routes.viewreviews.defaults.action = "index"
resources.router.routes.viewreviews.map.name = 1
resources.router.routes.viewreviews.map.page = 2 
```

关键是我必须有可能允许现在不可能的页面参数。我可以制作两条正则表达式路线，但这不是一个好方法。因为我会得到很多看起来几乎一样的路线。

我想我不是在寻找链式路由，因为 URL 中不包含该语言。语言由您访问的域名（.nl 或 .de）定义。

有什么想法吗？尖端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T09:00:37.027

经过一番研究，有一个解决方案。我所做的是以下内容：

*   我在 routes.xml 文件中重写了我的路线。例子：

    ```
    <viewreviews>
        <type>BestBuy_Router_Route</type>
        <route>@klantbeoordelingen/:page</route>
        <translate>klantbeoordelingen</translate>
        <defaults>
            <module>default</module>
            <controller>review</controller>
            <action>index</action>
            <page>0</page>
        </defaults>
    </viewreviews> 
    ```

注意路由配置中的@。这将导致它被翻译。然后我添加了一个无意义的（用于 ZF）标签“翻译”，以便 Poedit 将其拾取。

*   我编辑我的 .po 文件并在 poedit 中执行以下操作：[poedit 和 xml 文件](https://stackoverflow.com/questions/3307612/poedit-and-xml-files)

*   然后我用 poedit 抓取我的 XML 文件，它会找到标签并要求你翻译它们。

*   翻译完这些后，请确保在路由器中设置了正确的翻译器。我在自己编写的前端控制器插件中的 routeStartup 周期中执行此操作：

    ```
     Zend_Controller_Router_Route::setDefaultLocale($translate->getLocale());
        Zend_Controller_Router_Route::setDefaultTranslator($translate); 
    ```

$translate 是一个 Zend_Translate 对象。

这应该适合你。翻译后的路由*只*适用于 Zend_Controller_Router_Route。我扩展了这个类并改进了（BestBuy_Router_Route），因为我希望所有路由都组装成小写等。

干杯!

# php - 发送图片到页面事件

> ID：12462197
> 
> 赞同：0
> 
> 时间：2012-09-17T15:12:22.233
> 
> 标签：php, facebook-graph-api, post, file-upload, curl

我已经在网上看到过这个问题的提问和回答，但是没有一个答案对我有用。要么它必须意味着它们已经过时或不正确。

基本上，我已经设法制作了一个脚本，该脚本创建了一个具有正确日期、名称、描述等的新活动。但我终其一生都无法弄清楚如何发送活动的图片，以便将其上传到活动中。我试过解析

```
'file.jpg' => '@/path/to/file.jpg'
'file' => '@/path/to/file.jpg'
'@file.jpg' => '@/path/to/file.jpg'
'@ile.jpg' => '@/path/to/file.jpg'
'photo' => '@/path/to/file.jpg'
'picture' => '@/path/to/file.jpg'
'source' => '@/path/to/file.jpg' 
```

似乎没有一个可以解决问题。我错过了什么？

在前面的示例中，将其作为后数组与所有其他值一起发送就足够了。

这有什么新的术语吗？再一次，我在[Facebook 的文档](https://developers.facebook.com/docs/reference/api/page/#events)中找不到任何解释。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T17:41:58.117

`'file' => '@/path/to/file.jpg'`是正确的格式。

直接在 cURL 中是

```
curl -F 'access_token=xxx' \
-F 'name=Sandbox' \
-F 'description=Nothing to see here' \
-F 'start_time=2013-12-01T12:00:00+0000' \
-F 'file=@/path/to/your.jpg' \
https://graph.facebook.com/EVENT_ID/events 
```

# java - Eclipse 包括 Java 源代码文件和 WAR 中的类文件

> ID：12462200
> 
> 赞同：2
> 
> 时间：2012-09-17T15:12:32.267
> 
> 标签：java, eclipse, war

当我选择将 Eclipse (Juno) 中的动态 Web 项目导出为 WAR 文件的选项时，所有 .java 文件都将与 .class 文件一起部署到 WEB-INF/classes 中。我以前从未注意到这种情况发生，所以我想知道我需要做些什么来阻止这种情况发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:15:03.990

我无法在 Juno 上重现这一点，但我注意到有一个名为“导出源文件”的复选框，我假设你没有选中它，但如果没有，那么可能就是它。

![在此处输入图像描述](../Images/f76572f50be5f65c277ede1db0218e22.png)

# sharepoint-2010 - 如何在使用 web 服务更新列表时将自定义字段作为参数传递

> ID：12462204
> 
> 赞同：0
> 
> 时间：2012-09-17T15:12:33.447
> 
> 标签：sharepoint-2010

我有一个名为 projectlist 的自定义列表。我想通过基于条件的 web 服务来更新这个列表，比如更新 projectlist 列说 project completedDate where projectname="Sharepoint" 和 Status="Completed"。

为了更新这个列表，我使用了从 msdn 站点获得的以下技术：

```
System.Xml.XmlDocument xmlDoc = new System.Xml.XmlDocument();
System.Xml.XmlElement elBatch = xmlDoc.CreateElement("Batch");
elBatch.SetAttribute("OnError", "Continue");
elBatch.SetAttribute("ListVersion", "1");
elBatch.SetAttribute("ViewName", projectlistviewName);

string strBatch = "<Method ID='1' Cmd='Update'>" +
"<Field Name='ID'>" +RowID + "</Field>" +
"<Field Name='ProjectCompletedDate'>ProjectCompletionDatevalue</Field></Method>" +
"<Method ID='1' Cmd='Update'><Field Name='ID' >" +RowID + "</Field>" +
"<Field Name='ProjectDescription'>"Project Description Value"</Field></Method>"; 

elBatch.InnerXml = strBatch;
XmlNode nreturn = ListReference.UpdateListItems("projectlist", elBatch); 
```

上述方法根据 RoWId 更新列表项，但要根据项目名称或状态字段等自定义字段更新列表项（如果我将 ID 字段替换为任何自定义字段），我收到此错误：

**“提供的 URL 包含无效的命令或值。请再次检查 URL。”**

我的目标是更新 projectname="Sharepoint" 和 Status="Completed" 的列表项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:52:11.310

据我所知，您必须提供项目 ID - 无论您从何处获取行 ID - 尝试获取项目 ID - 否则您可能必须构建一个自定义服务方法来过滤数据。问候，KS

# grails - GORM 的“静态瞬态”和“瞬态类型 aField”声明之间有什么区别吗？

> ID：12462205
> 
> 赞同：12
> 
> 时间：2012-09-17T15:12:40.803
> 
> 标签：grails, persistence, grails-orm, transient

让我们考虑两个 Grails 域示例类。

**第一类：**

```
class Person {

    String name
    Integer counter = 0

    static transients = ['counter']
} 
```

**第二类：**

```
class Vehicle {

    String name
    transient Integer counter = 0
} 
```

*Person*和*Vehicle类之间的**Integer 计数器*字段的 GORM 持久性或域类行为会有什么不同吗？

 **编辑：我知道*Person*类是 Grails 文档引用的好方法。但是，我更喜欢*Vehicle*类的方式，因为它似乎更明显，并且在阅读代码时更容易不被忽视。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-17T17:49:04.253

这两种机制定义了不同类型的“瞬态”。`static transients`定义不应由 Hibernate 映射到数据库的 bean 属性，而`transient`关键字表示不应由 Java 对象序列化机制保存的字段（例如，当使用 webflow 时）。它们在不同的情况下都有各自的用途。**

# c# - LINQ 表达式投影到匿名类型

> ID：12462208
> 
> 赞同：1
> 
> 时间：2012-09-17T15:12:49.503
> 
> 标签：c#, linq, expression

我创建了一个 LINQ 表达式，它将一个序列投影到新的匿名类型序列中，正如我在这里找到的[LINQ expression tree with anonymous types](https://stackoverflow.com/questions/606104/how-to-create-linq-expression-tree-with-anonymous-type-in-it)。

这是我想要执行的表达式：

```
Document doc = ....;
doc.AllStatements.Select(s => new { field = s.Amount }); 
```

这是括号内选择器的运行时表示：

```
{t => new field;Decimal;() {field = t.Amount}} 
```

这是整个表达式的运行时表示。

```
{System.Linq.Enumerable+<UnionIterator>d__88`1[SISTEM.Models.Statement].Select(t => new field;Decimal;() {field = t.Amount})} 
```

当我尝试在调试期间枚举它时，我得到了这个：

```
") expected" 
```

如果我尝试使用这样的多个字段匿名类型：

```
doc.AllStatements.Select(s => new { field = s.Amount, field2 = s.Account }); 
```

我明白了：

```
{System.Linq.Enumerable+<UnionIterator>d__88`1[SISTEM.Models.Statement].Select(t => new field;Decimal;field1;Nullable`1;() {field = t.Amount, field1 = t.Account})} 
```

然后运行时错误是：

```
"Unexpected character '`'" 
```

有人可以帮我解码吗？

更新：

这是我的实际调用：

```
var res = Expressions.DoExpression(typeof(Document), doc, "AllStatements.Select(new field=Amount, field1=Account)"); 
```

但是，DoExpressions 函数背后有很多解析和 LINQ 表达式（大约 500 行代码）

更新 2：

首先是代码片段：

```
Dokument doc = db.Dokumenti.First(); // Proper document, entity object;
var res = Expressions.DoExpression(
    typeof(Dokument), 
    doc, 
    "SviFinStavovi.Select(new id=Iznos, dsc=Opis)"
); 
```

SviFinStavovi 是 Dokument 的 Navigational Property，Iznos 和 Opis 是 SviFinStavovi 底层类型的属性。

但是，这两行代码不会引发异常。只有当我尝试枚举 res 时才会抛出异常。你有上面的那些。

如果我放了 SviFinStavovi.Select(Iznos)，那就可以了。

这是 DoExpression：

```
public static object DoExpression(Type t, object obj, string expression){
ParameterExpression pe = Expression.Parameter(obj.GetType(), "objekat");
Expression SelectExpr = Expressions.ResolveCompleteExpression(pe, expression.Prepare());
return Expression.Lambda(SelectExpr, pe).Compile().DynamicInvoke(obj);} 
```

ResolveCompleteExpression 解析整个事情。

现在，这是我从这个网站获得的功能，上面的链接，我添加了，它会导致麻烦：

```
 public static Expression SelectDynamic(Expression expr, IEnumerable<string> fieldNames)
    {
        Type source = expr.Type.GetGenericArguments()[0];
        Dictionary<string, PropertyInfo> sourceProperties = new Dictionary<string, PropertyInfo>();
        foreach (string arg in fieldNames) sourceProperties.Add(arg.Split('=')[0].Trim(), source.GetProperty(arg.Split('=')[1].Trim()));                       
        Type dynamicType = LinqRuntimeTypeBuilder.GetDynamicTypeWrapper(sourceProperties);

        ParameterExpression sourceItem = Expression.Parameter(source, "t");
        IEnumerable<MemberBinding> bindings = dynamicType.GetFields().Select(p => Expression.Bind(p, Expression.Property(sourceItem, sourceProperties[p.Name]))).OfType<MemberBinding>();
        Expression selector = Expression.Lambda(Expression.MemberInit(
            Expression.New(dynamicType.GetConstructor(Type.EmptyTypes)), bindings), sourceItem);
        return Expression.Call(typeof(Queryable), "Select", new Type[] { source, dynamicType }, expr, selector);
    } 
```

此时 expr 将（正确地）表示 doc.SviFinStavovi，并且字段名称将是 ["id=Iznos"] ["dsc=Opis"]。

现在，这不是我的代码，我只是稍微调整一下以适合我。这实际上是上面代码片段的最后执行的代码行。仅用于展开堆栈并进行编译。

对不起，如果这可能没有任何意义。如果您需要任何澄清，请询问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:01:50.520

我认为选择需要在 new 之后的字段周围加上括号。

```
 Select("new(<property1>,<property2>,...)");

var res = Expressions.DoExpression(typeof(Document), doc, "AllStatements.Select(new (field=Amount, field1=Account))"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T18:29:15.473

好吧，我无法进行匿名投影，但我创建了小班并进行了投影：

```
public class LookupModel
{
    public LookupModel(int id, string dsc)
    {
        ID = id;
        DSC = dsc;
    }

    public int ID { get; set; }
    public string DSC { get; set; }
} 
```

所以使用这个：

```
function LINQSelectNew(Expression expr, string[] args)
{
Type type = expr.Type.GetGenericArguments()[0];
ParameterExpression parameter = Expression.Parameter(type, type.Name);

List<Expression> lista = new List<Expression>();                    
foreach (string s in args) lista.Add(Expressions.ResolveCompleteExpression(parameter, s.Prepare()));

Expression New = Expression.New(typeof(LookupModel).GetConstructor(lista.Select(e => e.Type).ToArray()), lista.ToArray());

return Expression.Call(
    typeof(Queryable),
    "Select",
    new Type[] { type, New.Type },
    expr,
    Expression.Lambda(New, new ParameterExpression[] { parameter }));
} 
```

我可以做这个：

```
var res = Expressions.DoExpression(
    typeof(Dokument), 
    doc, 
    "SviFinStavovi.Select(new LookupModel(amount, amount.ToString()))"
); 
```

希望这可以帮助某人...

# c# - 如何检查服务应用程序的权限？

> ID：12462209
> 
> 赞同：1
> 
> 时间：2012-09-17T15:12:51.307
> 
> 标签：c#, sharepoint, sharepoint-2010

我正在尝试检查特定用户是否对特定服务应用程序具有权限，但我运气不佳。到目前为止，我已经设法检查当前用户是否具有类似于以下代码的权限：

```
SPCentralAdministrationSecurity security = serviceApp.GetAdministrationAccessControl();
var acl = security.ToAcl();
bool hasAccess = acl.DoesUserHavePermissions(SPCentralAdminRights.FullControl); 
```

但是，就像我说的，我需要检查特定用户的权限，不一定是当前用户。有谁知道实现这一目标的方法？

编辑：

我不知何故没有意识到 acl 实际上是一个列表。我通过它循环查找服务应用程序的管理员，这是成功的一半！但我仍然需要找到权限下列出的帐户，以查看哪些帐户有权调用服务应用程序。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T14:37:22.417

经过一番研究，我找到了答案！下面是详细代码：

```
foreach (SPService service in SPFarm.Local.Services)
{
    if (service.Name.Equals("ServiceName"))
    {
        foreach (SPServiceApplication serviceApp in service.Applications)
        {
            //This gets the service app administrators
            SPCentralAdministrationSecurity serviceAppSecurity = serviceApp.GetAdministrationAccessControl();
            SPAcl<SPCentralAdministrationRights> adminAcl = serviceAppSecurity.ToAcl();

            foreach (SPAce<SPCentralAdministrationRights> rights in adminAcl)
            {
                //Handle users
            }

            //This gets the users that can invoke the service app
            SPIisWebServiceApplication webServiceApp = (SPIisWebServiceApplication) app;
            SPIisWebServiceApplicationSecurity webServiceAppSecurity = webServiceApp.GetAccessControl();
            SPAcl<SPIisWebServiceApplicationRights> invokerAcl = webServiceAppSecurity.ToAcl();

            foreach (SPAce<SPIisWebServiceApplicationRights> rights in invokerAcl)
            {
                //Handle users
            }
        }
    }
} 
```

# xml - 如何维护一个全局列表以在 XSLT 中唯一循环

> ID：12462210
> 
> 赞同：0
> 
> 时间：2012-09-17T15:12:53.950
> 
> 标签：xml, xslt, loops

我需要过滤一些重复的节点中的操作（在一个键上）以下是我的数据文件。

数据.xml

```
<root>
    <node name="item1" />
    <node name="item2" />
    <node name="item3" />
    <node name="item4" />
</root> 
```

在文件 item1.xml

```
<item>
 <group>A</group>
</item> 
```

item2.xml

```
<item>
 <group>B</group>
</item> 
```

item3.xml

```
<item>
 <group>B</group>
</item> 
```

item4.xml

```
<item>
 <group>D</group>
</item> 
```

XSLT 文件

```
<xsl:for-each select="/root/node">
     <xsl:variable name="itemName"   select="@name"/>
     <xsl:variable name="groupName"  select="document($itemName)/item/group"/>
     <xsl:value-of select="concat('Group ',$groupName)"/>
</xsl:for-each> 
```

输出

> A组 B组 B组 C组

期望的输出

> A组 B组 C组

这里第 2 项和第 3 项根据它们的组属性属于同一组，所以我只需要打印其中任何一个的组名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-21T11:15:50.053

```
<root>
    <node name="item1" group="A"/>
    <node name="item2" group="B"/>
</root> 
```

如果组名本身可以以某种方式作为属性放在主 XML 文件中，则可以按如下方式找到不同的节点

```
 <xsl:for-each select="/root/node[not(@group = preceding-sibling::node/@group)]">
   </xsl:for-each> 
```

上面的选择表达式将忽略之前遇到的任何节点（属于前面的节点之一）

PS：这不是涉及多个 XML 文件的问题的解决方案。该行中的任何答案都会很有用。

# hadoop - hadoop fsck 不起作用

> ID：12462213
> 
> 赞同：1
> 
> 时间：2012-09-17T15:12:59.427
> 
> 标签：hadoop, mapreduce, hdfs

我尝试使用 hadoop fsck 实用程序，但它不起作用。在这台机器上安装了 CDH3（通过 cloudera manager）。但是使用 ssh 我可以连接到 mynamenode。日志如下：

```
[18:54]hdfs@datanode2:~$ hadoop fsck -fs "hdfs://namenode:8020/" /
12/09/17 18:55:01 ERROR security.UserGroupInformation: PriviledgedActionException as:hdfs (auth:SIMPLE) cause:java.net.ConnectException: Connection refused
Exception in thread "main" java.net.ConnectException: Connection refused
        at java.net.PlainSocketImpl.socketConnect(Native Method)
        at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
        at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:198)
        at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
        at java.net.Socket.connect(Socket.java:579)
        at java.net.Socket.connect(Socket.java:528)
        at sun.net.NetworkClient.doConnect(NetworkClient.java:180)
        at sun.net.www.http.HttpClient.openServer(HttpClient.java:388)
        at sun.net.www.http.HttpClient.openServer(HttpClient.java:483)
        at sun.net.www.http.HttpClient.<init>(HttpClient.java:213)
        at sun.net.www.http.HttpClient.New(HttpClient.java:300)
        at sun.net.www.http.HttpClient.New(HttpClient.java:316)
        at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:992)
        at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:928)
        at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:846)
        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1296)
        at org.apache.hadoop.hdfs.tools.DFSck$1.run(DFSck.java:141)
        at org.apache.hadoop.hdfs.tools.DFSck$1.run(DFSck.java:110)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAs(Subject.java:415)
        at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1177)
        at org.apache.hadoop.hdfs.tools.DFSck.run(DFSck.java:110)
        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)
        at org.apache.hadoop.hdfs.tools.DFSck.main(DFSck.java:182)
[18:55]hdfs@datanode2:~$ ssh namenode
Last login: Thu Jul 19 18:57:29 2012 from 10.162.72.241

Appliance:      cloudera-demo-vm appliance 3.0
Hostname:       namenode
IP Address:     10.162.72.240

[18:55]hdfs@namenode:~$ 
```

而且我不明白如何调试这个问题......我希望有人能帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T06:58:32.757

我认为您是从 Datanode 或任何 DFS 客户端运行它，从 Namenode 运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-17T20:39:40.630

您需要给出`hadoop.sh fsck /`或`haddop.sh fsck /hbase`（例如）

# java - Android 中来自 java.lang.management 的 ManagementFactory

> ID：12462215
> 
> 赞同：1
> 
> 时间：2012-09-17T15:13:01.003
> 
> 标签：java, android, cpu-usage

为什么 java.lang.management 在 android 中不可用？（至少我知道）

我需要使用`getCurrentThreadCpuTime`“ `ThreadMXBean`”类中的“”，但我需要`ManagementFactory`检索它。

android中有那个类的替代品吗？

我需要我的线程花费的 cpu 时间。

提前感谢莱昂纳多

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:26:20.850

Android 运行在 linux 上，因此您可以从文件 /proc/$pid/stat 中获取线程信息。

您可以阅读和分析文件 /proc/$pid/stat 以获取所需的信息。

```
public void getTotalMemory() {
String path = "/proc/$pid/stat";
String info="";
try {
    FileReader fr = new FileReader(path);
    BufferedReader localBufferedReader = new BufferedReader(fr, 8192);
    while ((info = localBufferedReader.readLine()) != null) {
        //analyse 
        System.out.println("ThreadInfo:" + info);
    }
    // close...
    } catch (IOException e) {
    }
} 
```

[如何分析线程状态](http://www.kernel.org/doc/man-pages/online/pages/man5/proc.5.html)

# php - ./__swift/library/TemplateEngine/class.SWIFT_TemplateEngine.php:1091 中提供的数据无效22

> ID：12462217
> 
> 赞同：1
> 
> 时间：2012-09-17T15:13:08.723
> 
> 标签：php

尝试将 Kayako 升级到 4.50。下载并安装了engage_stable_sourceobf_4_50_1636.tar.gz。按照 HOWTO 配置：[http ://wiki.kayako.com/display/DOCS/Upgrading+your+helpdesk](http://wiki.kayako.com/display/DOCS/Upgrading+your+helpdesk)

但是，当我转到新站点时，出现以下错误。

```
Uncaught Exception
Invalid data provided22 in ./__swift/library/TemplateEngine/class.SWIFT_TemplateEngine.php:1091
=================================================================================================================================

#0 ./__swift/library/TemplateEngine/class.SWIFT_TemplateEngine.php(113): SWIFT_TemplateEngine->LoadTemplateGroup(false)
#1 ./__swift/library/TemplateEngine/class.SWIFT_TemplateEngine.php(803): SWIFT_TemplateEngine->__construct(1)
#2 ./__swift/library/class.SWIFT.php(16): SWIFT_TemplateEngine::LoadEngine()
#3 ./__swift/library/class.SWIFT.php(16): SWIFT->Initialize()
#4 ./__swift/swift.php(16): SWIFT::GetInstance()
#5 ./index.php(28): require_once('/home/redpocket...')
#6 {main} 
```

有没有人遇到过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:01:24.127

找到答案：

升级时，您需要通过设置链接 http:///setup/，而不是主链接 http:///。

# php - 将特殊字符从 PHP 插入 Microsoft SQL Server

> ID：12462218
> 
> 赞同：1
> 
> 时间：2012-09-17T15:13:14.720
> 
> 标签：php, sql-server, sql-server-2008

我刚刚创建了一个 MSSQL 数据库。排序规则是 SQL_Latin1_General_CP1_CS_AS。我在使用 freetds 的 Linux-Apache-PHP 服务器上使用它。当我从 Web 表单接收文本并尝试插入包含特殊字符的文本（例如咖啡厅）时，我收到错误消息。

```
<?php
ini_set('display_errors', '1') ;
$MyConn = mssql_connect( "MSPROD", "one", "1a!logas1" ) ;
mssql_select_db( "SIAM", $MyConn ) ;
if ( isset( $_GET['arg'] ) )
    {
    $arg = $_GET['arg'] ;
    print "Inserting '$arg'<br>\n" ;
    for ( $i = 0 ; $i < strlen( $arg ) ; $i ++ )
        {
        print dechex( ord( $arg{$i} ) ) . ' ' ;
        }
    mssql_query( "INSERT mytest VALUES('$arg')" ) ;
    }
?>
<form action=badchars.php method=get>
<input type=text name=arg>
</form> 
```

这是错误：

> 插入“café” 63 61 66 e9 警告：mssql_query()：Sybase：服务器消息：字符串“caf”后的引号未闭合。（严重性 15，过程 N/A）在第 13 行的 /www/one/mytest/badchars.php 中警告：mssql_query()：Sybase：服务器消息：“caf”附近的语法不正确。（严重性 15，过程 N/A）在 /www/one/mytest/badchars.php 第 13 行

它提到 Sybase 的事实是因为最初为它安装了服务器，但我的理解是 Sybase 和 Mssql 功能是相同的，所以应该没关系。如果我尝试将文本 strainght 放入引号中，我仍然会收到相同的错误：

```
mssql_query( "INSERT mytest VALUES('café')" ) ; 
```

但是，如果我在 SQL Server 管理器中运行相同的查询，它就可以工作！这有效：

```
mssql_query( "INSERT mytest VALUES('caf' + char(233) )" ) ; 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:23:54.957

我强烈建议您停止使用 php_mssql，而是使用 get `Microsoft Drivers for PHP for SQL Server`，我们在 php_mssql 中遇到的几乎所有问题都将得到解决，您在使用 php_mssql 向 SQL Server 发送和从 SQL Server 获取 UTF-8 数据时会**遇到很多麻烦。**

在选择 Text 和 Varchar 时，您必须 CAST nText 和 nVarchar，因为 php_mssql 仅支持旧的 SQL Server 驱动程序...

如果你真的需要使用 php_mssql，你必须使用`iconv`并且可能`utf8_decode`. 这是我编写的 2 个函数，用于在 SQL Server 中存储和获取 UTF-8 波斯语/阿拉伯语数据。

```
function persian_sql_to_php($str){
    if(mb_detect_encoding($str) == 'UTF-8' AND mb_check_encoding($str, 'UTF-8')){
        $str = utf8_decode($str);
    }
    $str = iconv('Windows-1256', 'UTF-8', $str);
    return $str;
}

function persian_php_to_sql($str){
    $str = iconv('UTF-8', 'Windows-1256', $str);
    return $str;
} 
```

根据您使用的语言，您需要将 Windows-1256 更改为其他内容。也可以单独尝试`utf8_decode`，也许它们适合您的情况。`utf8_encode`

**更新：**

由于您使用的是 FreeTDS，因此情况可能与我在上面解释的关于 UTF-8 的问题的主要 php_mssql 略有不同......

**更新 2：** 我刚刚在 Windows 上尝试了这段代码，它似乎可以工作，你也可以试试，也许它也适合你？

```
<?php

mssql_connect('127.0.0.1', 'sa', '123456');
mssql_select_db('test');

$val = 'café';

$val = iconv('UTF-8', 'ISO-8859-1', $val);

mssql_query('INSERT INTO mytest (test) VALUES (\''.$val.'\');');

?> 
```

# symfony - 将 Symfony 2 项目迁移到托管的步骤？

> ID：12462220
> 
> 赞同：13
> 
> 时间：2012-09-17T15:13:26.837
> 
> 标签：symfony

我已经阅读了很多关于在生产服务器上部署 Symfony 2 项目的文章和问题，但仍然不清楚。Symfony 项目的部署看起来就像一个地狱——没有人知道如何正确地做到这一点。我想我看到的最好的主题是[部署一个 Symfony2 项目](https://stackoverflow.com/questions/9855922/deploying-a-symfony2-project)，但仍然有很多不清楚的地方。我读了它，发现在那个问题中，有人将他自己的 IP 添加到允许 IP 的列表中，但这意味着只有这个 IP 可以访问这个站点，但我需要允许每个人使用它。

以及如何使站点使用 path `www.mydomen.com`，而不是`www.mydomen.com/web/app_dev.php/index`（我可以通过 Symfony 更正路径，但它可以在托管之后`app_dev.php`和通过托管，但它如何在 / 之前工作`app_dev.php`？似乎 app-dev.php 应该始终在我的路径中）。

那么我应该如何正确地将开发的项目从本地服务器逐步转移到生产服务器呢？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-20T08:09:08.697

好的，我了解了如何在共享主机上正确部署应用程序。这里是：

1.  这取决于您拥有的托管类型：如果您有 SSH 控制台，那么您可以在第 2 步之后在托管上进行，如果您还没有，则在本地进行：运行命令`php app/console cache:clear --env=prod`。
2.  假设您有托管文件夹`youdomain/public_html`，因此 `public_html`必须位于所有 Web 文件中。您必须从 Symfony 项目上传所有内容（文件夹：app、src、vendors、bin；文件：deps、deps.lock），文件夹`web`中的文件夹除外`youdomain`。文件夹中的所有内容`web`都应上传到文件夹`public_html`。
3.  检查文件夹 app/cache 和 app/logs 的 CHMOD，应该有写访问权限。
4.  如果没有文件`.htaccess`，`public_html`则创建它并在其中添加这样的代码：[https ://raw.github.com/symfony/symfony-standard/master/web/.htaccess](https://raw.github.com/symfony/symfony-standard/master/web/.htaccess)
5.  现在您应该使用您在本地使用`youdomain.com/index`的而不是 `youdomain.com/app_dev.php/index`,。

如果您的站点仍然无法运行，您可以打开文件`web/config.php`并找到执行 IP 检查的代码，您会发现那里只有 IP 127.0.0.1，将您当前的 IP 添加到此列表并在服务器上上传新配置。然后你可以打开路径`yourdomain/config.php`并检查有什么问题。如果`config.php`显示一切正常，但您的站点仍然无法运行，您可以启用`app_dev.php`调试：打开`app/app_dev.php`并将您的 IP 添加到列表中，就像之前`config.php`所做的那样。现在您可以使用`app_dev.php`.

# groovy - TestNG Groovy 依赖方法

> ID：12462221
> 
> 赞同：3
> 
> 时间：2012-09-17T15:13:38.093
> 
> 标签：groovy, annotations, testng

有什么方法可以在我的 TestNG 注释中使用*dependsOnMethods来进行用 groovy 编写的测试吗？*

```
class WarehouseBehavior {
    @Test
    void shouldHaveWarehouse() {
        def warehouse = registry.getService Warehouse.class
        assertNotNull warehouse
    }
    @Test(dependsOnMethods = ['shouldHaveWarehouse'])
    void shouldStoreDataInWarehouse() {
        def warehouse = registry.getService Warehouse.class
        warehouse.store(['a': 'b', 'c': 'd'])
    }
} 
```

我要么在这里遗漏了一些东西，要么 groovy 只是不支持这种类型的注释，因为类似的代码在 Java 中运行良好，而在 groovy 中运行它会给我以下错误

```
WarehouseBehavior.shouldStoreDataInWarehouse() is depending on method public void WarehouseBehavior.shouldHaveWarehouse(), which is not annotated with @Test 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:29:23.680

`Test`方法具有包范围。

明确声明`public`为：

```
@Test
public void shouldHaveWarehouse() {
    // .....
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-26T10:04:48.390

**注意**：这不是（完整的）IMO 答案，但它更多的是解决方法。只需在此处添加它，以防有人可以改进此答案并提供更多见解。

面对与 Groovy 测试相同的问题，到目前为止我能找到的唯一解决方法是将这两种方法放在同一个组中，然后它就可以工作。所以像这样

```
class WarehouseBehavior {
    @Test(groups =['somegroup'])
    void shouldHaveWarehouse() {
        def warehouse = registry.getService Warehouse.class
        assertNotNull warehouse
    }
    @Test(groups =['somegroup'], dependsOnMethods = ['shouldHaveWarehouse'])
    void shouldStoreDataInWarehouse() {
        def warehouse = registry.getService Warehouse.class
        warehouse.store(['a': 'b', 'c': 'd'])
    }
} 
```

# php - 在 php 中使用来自已编译 python 的 Cython 扩展？

> ID：12462227
> 
> 赞同：0
> 
> 时间：2012-09-17T15:13:58.620
> 
> 标签：php, python, cython

这可以做到吗？

不知道 Cython`.so`扩展是否可以从 php 脚本动态加载，还是需要任何额外的管理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:30:24.280

最简洁的答案是不。Cython 扩展使用 Python C API，因此不能直接从 PHP 加载和调用。它们通常会将 PyObject 结构作为参数（Python 对象）接受并返回。您需要一个 Python <-> PHP 绑定来加载 .so 并进行对象转换。

# python - 如何使用 GAE 上的参数调用 gs.listdir()，以在 Google Cloud Storage 上列出存储桶

> ID：12462238
> 
> 赞同：1
> 
> 时间：2012-09-17T15:14:41.163
> 
> 标签：python, google-app-engine, google-cloud-storage

根据[官方文档](https://developers.google.com/appengine/docs/python/googlestorage/functions)，可以使用一些可选参数调用 Google App Engine 上的[gs.listdir() ，如包含的示例所示...](https://developers.google.com/appengine/docs/python/googlestorage/functions#listdir)

```
files.gs.listdir('/gs/mybucket',prefix='/mysubdir/backups', max_keys=20) 
```

但是，当我尝试仅使用普通的 Google Cloud Storage 路径（它工作得很好）之外的任何东西来调用它时，我会收到这样的错误......

```
TypeError: listdir() got an unexpected keyword argument 'prefix' 
```

根据要求，这是回溯...

```
Traceback (most recent call last):
    File "/base/python_runtime/python_lib/versions/1/google/appengine/ext/webapp/_webapp25.py", line 710, in __call__
        handler.get(*groups)
    File "/base/data/home/apps/s~foo/1.361822114540385125/app_main.py", line 123, in get
        test = files.gs.listdir( '/gs/bar', prefix = '/folder' )
TypeError: listdir() got an unexpected keyword argument 'prefix' 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:53:19.747

抱歉，这是应用引擎文档中的错误。

它应该是 files.listdir 的 doc，而不是 files.gs.listdir。

files.listdir 接受任意关键字参数，files.gs.listdir 接受单个关键字参数字典。因此类型错误。

所以请按照记录的方式使用 files.listdir。该错误将尽快修复。

谢谢你。

# php - 如何区分 PHP 与 Silex 和 Symfony2？

> ID：12462239
> 
> 赞同：0
> 
> 时间：2012-09-17T15:14:43.263
> 
> 标签：php, symfony, config, silex

所以，首先，总的来说，我对编程真的有点陌生（我是一名 CS 学生实习生）。

我的任务是从`config.php`文件中删除一些 Symfony2 和 Silex。显然，我们的网站不需要这两个框架来工作（它们曾经是必需的，但现在我们正在对网站在服务器上的方式进行一些更改）。

最大的问题是我刚开始学习PHP。我过去的大部分工作都是在 Java 中完成的。老实说，我以前什至没有使用过框架，所以我什至不知道 Symfony2 和 Silex 到底负责什么。

有什么我可以走的捷径（要寻找的东西）或资源来帮助我吗？

我只需要删除任何与 Silex/Symfony 相关的内容。我觉得学习所有关于框架的知识会过于耗时。你们有什么感想？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T08:29:38.997

从现有工作项目中删除框架依赖项 - 这可能会导致从头重写整个站点。“如何删除框架？”这个问题没有简单的答案。

> 我什至不知道 Symfony2 和 Silex 到底负责什么

这实际上是这里最重要的问题。并且没有通用答案，这取决于您的项目。这可能是路由、数据库抽象、处理和验证、错误处理、安全等。所以你必须自己挖掘代码来识别它。为此，您必须了解有关框架（Silex）的一些知识，否则您无法识别项目代码的这一部分或那部分是否与框架相关。

下一步：如果你想删除任何与 Silex/Symfony2 相关的东西，你必须用你自己的实现重写（替换）已删除的功能。作为 PHP 世界的新手，这对你来说会很困难。一般来说，编写自己的所有这些已经在框架中完成的事情的实现并不是一个好主意。

如果您的老板要求您删除 Silex/Symfony2 而您无法更改 - 您处境艰难。

如果您主动删除 Silex/Symfony2 - 我建议您首先确定工作范围并衡量所有优势/劣势。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:19:28.360

看看包括。他们的路径名中有 Silex 或 Symfony 吗？如果是这样，请删除它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:22:07.217

究竟是什么样的配置文件？如果它是纯 PHP 并且你只需要摆脱一些函数，它应该没问题：你可以在 Eclipse/任何你使用的 IDE 中打开你的文件，如果这些函数在 Symfony 包中，请使用 ctrl+clic 检查......

你能给我们举一些例子吗？

# android - Android扫描二维码的方法或类？

> ID：12462241
> 
> 赞同：0
> 
> 时间：2012-09-17T15:14:54.880
> 
> 标签：android, junaio

我正在使用适用于 android 的 junaio 模板（增强现实），我添加了一个名为“扫描”的按钮，它将扫描二维码。我需要知道我必须在 android 上实现什么方法/函数/类或 API 才能使该操作起作用。安卓有这个吗？

预先感谢！。

PS：我听说过 Zxing，但如果我没记错的话，该应用程序需要安装在手机上，我不想这样做，因为我正在开发自己的应用程序，我打算用它来完成整个工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:21:28.633

我不知道，但你可以研究 ZXing 源代码他们是如何做到的[http://code.google.com/p/zxing/source/checkout](http://code.google.com/p/zxing/source/checkout)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T08:15:13.770

为了在junaio中实现扫描功能，您必须设置跟踪配置“arel.Tracking.BARCODE_QR”（[http://dev.junaio.com/arel/documentationArelJS/symbols/arel.Tracking.html](http://dev.junaio.com/arel/documentationArelJS/symbols/arel.Tracking.html)）

每次扫描二维码时，都会通过 onTrackingEvent 回调获得回调。在该回调中，您可以决定要执行的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-22T14:12:16.750

好的，情况就是这样，我对代码进行了一些建议的更改，以便它可以扫描二维码。我对文件夹 arel 内的 index.php 文件所做的更改。

```
<script type="text/javascript">

        arel.sceneReady(function()
        {
            //start with arel here  
            arel.Scene.setTrackingConfiguration(arel.Tracking.BARCODE_QR);          
            //set a listener to tracking to get information about when the image is tracked
            arel.Events.setListener(arel.Scene, function(type, param){trackingHandler(type, param);});          
             //if the user holds the device over the pattern already, when the scene starts
            arel.Scene.getTrackingValues(function(trackingValues){receiveTrackingStatus(trackingValues);});         

        }); 

        function trackingHandler(type, param)
            {
                //check if there us tracking information avaialbe
                if(param[0] !== undefined)
                {
                    //if the pattern is found, hide the information to hold your phone over the pattern
                    if(type && type == arel.Events.Scene.ONTRACKING && para[0].getState() == arel.Tracking.STATE_TRACKING)
                    {
                         $('#info').fadeOut("fast");
                      }                     
                    //if the pattern is lost tracking, show the information to hold your phone over the pattern
                      else if(type && type == arel.Events.Scene.ONTRACKING && param[0].getState() == arel.Tracking.STATE_NOTTRACKING)
                      {
                         $('#info').fadeIn("fast");
                      } 

                }
            };

            function receiveTrackingStatus(trackingValues)
            {
               if(trackingValues[0] === undefined)
                  $('#info').fadeIn("fast");

            };  

        </script> 
```

这里的问题是它不扫描任何代码，我把手机扫描代码并没有任何反应......有人知道我在这里做错了什么吗？......我会感谢任何帮助。

谢谢。

伊格纳西奥。

# c++ - GetProcessImageFileName 未链接

> ID：12462244
> 
> 赞同：6
> 
> 时间：2012-09-17T15:15:04.920
> 
> 标签：c++, visual-studio-2008

我正在尝试使用 GetProcessImageFileName。我已经包含了 Psapi.h 但是当我尝试 ti compile 我得到

```
error LNK2019: unresolved external symbol _GetProcessImageFileNameA@12 referenced in function "bool __cdecl FindProcesses(char const *,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> > *)" (?FindProcesses@@YA_NPBDPAV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@@Z)99>G:\Test\main\Tests.exe : fatal error LNK1120: 1 unresolved externals 
```

该函数出现在 Itellisense 中，所以谁能告诉我为什么它不能编译？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T15:17:46.093

这是一个链接器故障（它确实编译）并且与包含`Psapi.h`. 您*可能*需要链接到`Psapi.lib`.

有关链接哪个库的具体说明，请参阅参考页面中的*库*部分：[`GetProcessImageFileName()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683217%28v=vs.85%29.aspx)

```
Windows 7 和 Windows Server 2008 R2 上的 Kernel32.lib；
Windows 7 和 Windows Server 2008 R2 上的 Psapi.lib（如果 PSAPI_VERSION=1）；
Psapi.lib 在 Windows Server 2008、Windows Vista、Windows Server 2003、
和 Windows XP

```

# java - 使用 Java 对 BlazeDS 进行方法调用

> ID：12462245
> 
> 赞同：0
> 
> 时间：2012-09-17T15:15:13.607
> 
> 标签：java, apache-flex, concurrency, remoting, blazeds

我有一个应用程序对 BlaseDS 服务器进行远程方法调用，该服务器使用 Java 连接到第 3 方数据系统。它需要进行 2 个远程方法调用`method_A()`和`method_B()`.

`method_A()`在 5 秒的计时器上调用java 。

java`method_B()`由用户发起的操作调用。

如果计时器完成并且应用程序调用`method_A()`并且之前`method_A()`能够返回任何数据`method_B()`，则这将导致`method_A()`返回任何数据。然后`method_B()`抛出一个错误。

`method_A()`抛出错误后，任何更多的调用都可以正常工作，但在错误`method_B()`后将无法正常工作。

有什么方法可以配置 BlazeDS 以确保`method_A()`完成之前`method_B()`的操作或 if `method_A()`and `method_B()`and 被同时调用而不会出现任何错误？还是我应该重构服务以符合命令模式？

预先感谢您提供的任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:49:51.770

据我所知，没有包含这样的并发功能。唯一的并发特性是“并发”变量，它只影响对同一方法的调用

如您所想，解决方案是使用命令模式

# php - 所有客户的共同项目

> ID：12462246
> 
> 赞同：0
> 
> 时间：2012-09-17T15:15:14.240
> 
> 标签：php, project, webshop

我开发了一个 PHP webshop 项目，它为每个客户独立工作。这意味着每个客户都安装自己的网店源文件 php.ini。

我发现这是维护许多网站的杀手，所以我决定将网上商店的源文件放在服务器的一个公共位置，并在 apache 服务器上创建一个别名，以便所有 www 客户都可以访问它。

然后每个客户在他们自己的 www 文件夹中都有自己的配置文件、日志文件夹、模板文件夹等。

我设法完成了上面所有的事情。但我的问题是网址。

URL 如下所示： [http ://www.exampleshop.com/webshop/v1/index.php](http://www.exampleshop.com/webshop/v1/index.php)

我需要在 url 中隐藏 webshop/v1，使其如下所示： [http ://www.exampleshop.com/index.php](http://www.exampleshop.com/index.php)

我玩了 url rewrite mod 但它一直告诉 index.php 不存在，因为它确实在 exampleshop.com 的根目录中查找不正确的文件，它位于 /webshop/v1

有任何想法吗？备择方案。

希望有人可以提供帮助:-)

* * *

我设法通过以下方式完成了上述工作:-)

```
RewriteEngine On
#for admin pages redirection
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$/admin/index\.php$ /webshop/v1/admin/$1 [L]

#for webshop pages redirection
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /webshop/v1/$1 [L] 
```

以上工作，但唯一的问题是它无法识别索引文件。当我在没有指定页面的情况下转到 url 时，它不起作用，因为索引文件不起作用。我必须输入完整的 url，例如 webshop.com/index.php 才能让它工作。

有没有办法删除扩展名:-)

无需在 url 中指定 index.php 也可以工作的解决方案

```
#if no file specified, forward to index
RewriteRule ^$   webshop/v1/   [L]
#if no file specified, forward to index
RewriteRule ^admin/$   webshop/v1/admin/   [L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /webshop/v1/$1 [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:17:52.097

`VirtualHost`或`Alias`指令应该修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:18:18.377

我会根据主机将请求路由到应用程序级别。

假设您在服务器上安装了文件，以及指向该服务器的各个域，即 customer1.com、customer2.com、customer3.com 等。然后，在您的`index.php`文件中，只需检测文件从哪个域访问并切换根据需要进行配置设置。

您可以有一个将设置映射到域的数据库表，因此如果您不想使用基于文件的配置，则可以执行数据库查询和获取设置。

**更新**

那么，在这种情况下，您需要一个 .htaccess 规则。请在你的根**.htaccess**中这样做：

```
<IfModule mod_rewrite.c>
    RewriteEngine on
    RewriteRule ^$   webshop/v1/   [L]
    RewriteRule (.*) webshop/v1/$1 [L]
</IfModule> 
```

这在您的**/webshop/v1/**目录中：

```
<IfModule mod_rewrite.c>
    RewriteEngine On

    # for admin pages redirection
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^admin/(.*)$ /webshop/v1/admin/$1 [L]

    # for webshop pages redirection
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ /webshop/v1/$1 [L]
</IfModule> 
```

# version-control - 使用网络存储签入位置实施源代码控制

> ID：12462248
> 
> 赞同：2
> 
> 时间：2012-09-17T15:15:20.503
> 
> 标签：version-control, tfs, windows-server-2008, iis-7.5

让我首先解释一下我所处场景的基本背景。

我需要为我工作的 Web 开发公司实施源代码控制解决方案。我们当前的开发模型是 Windows 服务器上所有文件的共享网络位置，针对数据驱动器运行 IIS7，并且没有源代码控制。网络位置备份得很好，但这显然不是一个好的设置（所以，如果你只是在这里抨击缺乏源代码控制，请不要打扰回复......这就是我要解决的问题）

我正在寻找一个源代码控制解决方案（使用 Team Foundation Server 2012 Express），但这不会是一个即时过程。我们有数百个站点，并且不会在一夜之间为所有站点推出此解决方案。我们还有许多需要修改的程序，这需要时间，所以我正在寻找一个可以一次推出一点点的解决方案。

我的主要问题是，是否有可能获得一个源代码控制解决方案，允许我的团队在 VS2010 中进行本地开发，但将文件签入现有网络位置？

网络位置是我们的开发服务器，在此更改由项目经理和客户批准，然后再推送到生产环境。更改该过程将严重损害我能够完全实施源代码控制解决方案的机会。（显然这不好）

我正在尝试在 TFS2012 Express 中设置此模型，但我似乎找不到任何有关如何执行此操作的信息。主仓库正在正常工作；我能够按预期进行分支、合并……，但我不知道如何强制将所有签入的文件推送到网络文件夹。（我可能在搜索错误的术语）

有谁知道如何做到这一点？

我并不完全依赖于 TFS，但它是我最熟悉的，而且我们处于一个 windows 环境中，其中有几个不是命令行专家的设计师。我实施的解决方案必须易于他们使用，这意味着集成到 Visual Studio。

同样，请不要把它变成另一个源代码控制咆哮页面。这样的人太多了。我真的在寻找解决我面临的问题的方法，我需要尽可能顺利地引入源代码控制，否则它很有可能根本不会发生......这对每个人都不利. :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:41:54.937

如您所知，TFS 将所有源代码存储在 SQL DB 中。我的一个提示是
查看[自定义 TFS 构建配置文件](http://msdn.microsoft.com/en-us/library/ms400710%28v=vs.100%29.aspx)。我不是 100% 确定，但应该可以将任务添加到构建配置，您可以在其中将所有文件从 TFS 工作区复制到网络存储。因此，每当有人将源代码检入 TFS 时，您都可以让 TFS 触发 CI-Build，该 CI-Build 会承担必要的复制任务。

# objective-c - Objective-C 写入消息

> ID：12462250
> 
> 赞同：1
> 
> 时间：2012-09-17T15:15:30.243
> 
> 标签：objective-c, macos, share, messages

我希望能够写信给`messages`. 如果更准确 - 直接分享照片`messages`，就像这样`preview`做。示例照片：

![在此处输入图像描述](../Images/f8455b798f80cd35026ae3b42afe8690.png)
![在此处输入图像描述](../Images/8d8c73991b643fa7a98144fee7de8d70.png)

甚至可能吗？因为我还没有找到任何关于分享到的信息`messages`，甚至`mail`。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:29:19.163

[NSSharingService](http://developer.apple.com/library/Mac/#documentation/AppKit/Reference/NSSharingService_Class/Reference/Reference.html)和[NSSharingServicePicker](http://developer.apple.com/library/Mac/#documentation/AppKit/Reference/NSSharingServicePicker_Class/Reference/Reference.html)类提供您需要的功能。您可以从苹果的[SharingServices](http://developer.apple.com/library/mac/#samplecode/SharingServices/Introduction/Intro.html)示例开始了解如何使用它们。

另请注意，该功能从 OSX 10.8 开始可用

# java - 如何获取重定向页面

> ID：12462252
> 
> 赞同：0
> 
> 时间：2012-09-17T15:15:40.157
> 
> 标签：java, wicket

我有两个页面：

```
@AuthorizeInstantiation(Roles.ADMIN)
public class AdminPage extends BasePage {
...

@AuthorizeInstantiation(Roles.USER)
public class UserPage extends BasePage {
... 
```

当没有任何用户登录时，他将被重定向到登录页面。是否有一些选项如何获取重定向页面？因此，如果用户进入管理页面，则登录页面 println 管理页面。如果用户进入用户页面，则登录页面 println 用户页面，当用户进入登录页面时，登录页面 println null

更新：

访问受保护页面时的策略

```
 getApplicationSettings().setAccessDeniedPage(LoginPage.class); 
```

什么不够清楚？当用户想要访问 UserPage 或 AdminPage 时，他会被重定向到 LoginPage。我想在 loginPage 中打印它是哪个页面

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:25:53.783

我不知道它是否正是你要找的，但你可以看看

```
RestartResponseAtInterceptPageException.InterceptData.get(); 
```

InterceptData 包含有关触发重定向的页面的一些信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-18T08:49:22.443

您尚未描述如何重定向到登录页面。我猜你实现了 IAuthorizationStrategy 和 IUnauthorizedComponentInstantiationListener？在 onUnauthorizedInstantiation() 的实现中，您可以检查传入的组件（也称为您的页面）上存在哪个注释，并根据此将参数传递给登录页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-19T09:05:44.873

好，我知道了：

我创建了未授权的ComponentInstantiationListener：

```
 getSecuritySettings().setUnauthorizedComponentInstantiationListener(
            new IUnauthorizedComponentInstantiationListener() {
                public void onUnauthorizedInstantiation(final Component component) {
                    if (component instanceof Page) {
                        // Redirect to index
                        if (component instanceof AdminPage) {
                            redirectionPage = ((AdminPage) component);
                        } else if (component instanceof BalancerPage) {
                            redirectionPage = ((UserPage) component);
                        }
                        throw new RestartResponseAtInterceptPageException(LoginPage.class);
                        // Or you can just throw the original UnauthorizedInstantiationException
                    } else {
                        component.setVisible(false);
                    }
                }
            }); 
```

并在应用程序中设置变量。

然后就在我打电话的登录页面中，`Application.getRedirectionPage()`所以我知道它是哪个页面

# iphone - 如何在新的 XCode 4.5 GM 的模拟器中设置 iPhone 5？

> ID：12462253
> 
> 赞同：26
> 
> 时间：2012-09-17T15:15:40.200
> 
> 标签：iphone, xcode, ios-simulator, iphone-5, xcode4.5

我在为新 iPhone 运行/测试我的应用程序时遇到了一些麻烦。

当使用这个较新版本的 XCode 运行模拟器时，iPhone 4" 在硬件-> 设备下不可见（不再）。

我是禁用它还是我的 XCode 以某种方式损坏。

编辑：

通过右键单击 XCode 4.5 运行我的应用程序时，我的 Xcode 没有运行最新的 Beta 版本（即使它已列出）。

通过 developerportal 的安装文件 (.dmg) 运行 XCode 时，我能够运行 iPhone 4" (iPhone 5) 模拟器。

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-09-18T15:44:44.227

下载并安装 Xcode 4.5（或更新版本），在其中打开您的项目，在 iPhone **6.0** Simulator 中运行，然后：

![在此处输入图像描述](../Images/207a3c477eb2f70bbcdbc6d2cc753ea9.png)

# java - 打印数组中“x”以下的所有数字

> ID：12462257
> 
> 赞同：3
> 
> 时间：2012-09-17T15:15:59.257
> 
> 标签：java, arrays, for-loop

我正在尝试打印出扫描数字下方的数字 (x)。我不知道如何，到目前为止，我所拥有的只是如何仅打印数组的最低数量。不知道如何将 x 包含到我的最后一个循环中。所以如果我输入 x = 13，我希望它打印出 11、7、5、3、2。

```
import java.util.Scanner;

class Test {
    public static void main(String[] args) {

        Scanner scan = new Scanner(System.in);

        //1

        int[] num= {2, 3, 5, 7, 11, 13, 17, 19};

        for(int i=0; i<num.length; i++) {

        System.out.println("Num: " + num[i]);
        }

        // 2
        System.out.print("\n Type a number: ");

        int x = scan.nextInt();

        x = num[0];
        for (int i=1; i>=num.length; i++) {
        if(num[i] < x) {
            x = num[i];
        }
        }
        System.out.println("Numbers below" + x);
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T15:20:40.413

你没有在 for 循环中打印任何东西，即使你是，for 循环本身看起来也有点奇怪。你的意思是`i < num.length`？`x`你为什么要重新分配`num[0]`？试试这个：

```
for (int i = 0 ; i < num.length ; i++)
    if (num[i] < x)
        System.out.println(num[i]); 
```

（确保删除该`x = num[0]`行。）

请注意，您还可以使用 for-each 循环：

```
for (int a : num)
    if (a < x)
        System.out.println(a); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-17T15:20:05.677

你可以这样做：

```
System.out.println("Numbers below " + x);
for (int i = 0; i < num.length; i++) {
    if (num[i] < x) {
        System.out.println(num[i]);
    }
} 
```

这是一个`List`带有 foreach 循环的版本：

```
 List<Integer> list = new ArrayList<Integer>();
    for (int n: num) {
       if (n < x) {
          list.add(n);
       }
    }
    System.out.println("Numbers below " + x + ": " + list); 
```

输出：

```
Numbers below 13: [2, 3, 5, 7, 11] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-17T15:53:15.043

问题在于这一行`System.out.println("Numbers below" + x);`，这必须在 if 块内的 for 循环中，但有一些更改，`System.out.println(num[i]);`因为您想打印由 num[i] 访问的数组元素，而不是您的选择`x`。

**假设您想按照您提到的顺序打印数组中的元素**.... `So if i type x = 13, i want it to print out 11, 7, 5, 3, 2.`，下面的代码将执行此操作。

```
import java.util.Scanner;

class Test {
    public static void main(String[] args) {

        Scanner scan = new Scanner(System.in);
        int[] num = { 2, 3, 5, 7, 11, 13, 17, 19 };

        for (int i = 0; i < num.length; i++) {

            System.out.println(num[i]);
        }

        System.out.print("Type a number: ");

        int x = scan.nextInt();
        // Removing the below statement as it makes no sense.
        // x = num[0];

        // Looping in this sense after supposing you need to print the number in
        // reverse order as per the question.

        System.out.println("Numbers below");

        //looping in the reverse order to meet the requirement
        for (int i = num.length-1; i >= 0; i--) {
            if (x > num[i]) {
                System.out.println(num[i]);
            }
        }
        // Moving this line in for loop within if block, but instead of x, we print num[i]
        //System.out.println("Numbers below" + x);

    }

} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T15:20:30.827

你的代码看起来不错。除非您必须遍历数组的所有项目（在输入数字之后）。

您的代码正在评估`i>=num.length` **，但它必须是`i<num.length`**因为它与前一个循环相同（迭代所有项目）。

起始值也应该是 0，因为数组中的第一个位置是 0。

所以，你应该这样做：

```
for (int i=0; i<num.length; i++) {
    if (num[i] < x) { // if this value is lower than the entered value (x)
       System.out.println(num[i]); // then I print it
} 
```

请注意，**您不必重新分配 x**。x 是您不想更改的输入值。您需要它知道数组的每个项目是否低于它。

# vba - 基于 Excel 中的列值聚合数据

> ID：12462258
> 
> 赞同：-1
> 
> 时间：2012-09-17T15:15:59.947
> 
> 标签：vba, excel, report

我正在完全编辑这个问题，因为现在想要的结果有所改变。另外，我同意，这个问题没有正确地提出给你们。

我有一个电子表格，即主电子表格，其中包含列出的活动/行。我想通知受让人他们将要执行的活动以及日期。我可以编写电子邮件发送宏，但问题是要达到那个阶段！我们如何排序，然后确保收件人只有1个人是受让人，并且他的名字在“TO”字段中不超过一次。（应用`for`循环会产生痛苦！）

主要电子表格：

```
Date    Assignee    Activity
08/01   Player X    Activity 1
08/01   Player Y    Activity 1
08/02   Player X    Activity 2
08/02   Player Y    Activity 2
08/02   Player Z    Activity 1 
```

要计算的报告：

```
Assignee    Activity List
Player X    Activity 1
Player X    Activity 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T16:48:44.693

您可以使用 For 循环并将活动（和/或任何其他相关信息）分配给特定于个人的数组。然后使用数组填充电子邮件。

这不是很优雅，但它运行在您提供的示例数据上。您可以使用数组数据（并遍历项目）或使用逗号分隔的字符串让玩家填充电子邮件。

```
Public Sub ReportToPeople()
    Dim i As Integer, j As Integer
    Dim arrPlayerX()
    Dim arrPlayerY()
    Dim arrPlayerZ()
    Dim strPlayerX As String
    Dim strPlayerY As String
    Dim strPlayerZ As String

    ReDim arrPlayerX(1 To 1)
    ReDim arrPlayerY(1 To 1)
    ReDim arrPlayerZ(1 To 1)

    ' No clue how large your dataset is...
    For i = 2 To 100
        If Cells(i, 1).Value = vbNullString Then Exit For
        Select Case Cells(i, 2).Value
            Case "Player X"
                Call fArrIncrementAndAdd(arrPlayerX, Cells(i, 3).Value, strPlayerX)
            Case "Player Y"
                Call fArrIncrementAndAdd(arrPlayerY, Cells(i, 3).Value, strPlayerY)
            Case "Player Z"
                Call fArrIncrementAndAdd(arrPlayerZ, Cells(i, 3).Value, strPlayerZ)
        End Select
    Next i
    Call MsgBox(strPlayerX) 'or use Debug.Print strPlayerX
End Sub

Public Function fArrIncrementAndAdd(ByRef arrTheArray, ByVal strValueToAdd, ByRef strWholeString)
    Dim c As Integer

    c = UBound(arrTheArray)
    If arrTheArray(c) <> vbNullString Then ReDim Preserve arrTheArray(1 To (c + 1))
    arrTheArray(c) = strValueToAdd
    strWholeString = strWholeString & "," & strValueToAdd
    If UBound(arrTheArray) = 1 Then strWholeString = Replace(strWholeString, ",", "") ' removes leading comma on first item

End Function 
```

# c# - 如何使用静态类实现 MVVM

> ID：12462261
> 
> 赞同：-1
> 
> 时间：2012-09-17T15:16:05.213
> 
> 标签：c#, wpf, mvvm, datacontext, inotifypropertychanged

我有一堂这样写的课

```
public class AudioPlayer : INotifyPropertyChanged
{

    public event PropertyChangedEventHandler PropertyChanged;
    // This method is called by the Set accessor of each property. 
    // The CallerMemberName attribute that is applied to the optional propertyName 
    // parameter causes the property name of the caller to be substituted as an argument. 
    private void NotifyPropertyChanged([CallerMemberName] String propertyName = "")
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
    [...]
    private static AudioPlayer instance = new AudioPlayer();

    public static AudioPlayer Instance { get { return instance; } }

    private Track currentTrack = null;

    // the pointer to the current track selected
    // it is useful to retrieve its new position when playlist got updates
    public Track CurrentTrack { get { return currentTrack; } 
        private set 
        { 
            currentTrack = value;
            NotifyPropertyChanged();
        } 
    }
    public class Track : ICloneable
    {
            public string Title { get; set; }
    } 
```

这是xml：

```
 <StackPanel DataContext="{Binding Source={x:Static audiocontroller:AudioPlayer.Instance}}">
        <Label Name="lbl_bind" Content="{Binding CurrentTrack.Title}"></Label>
        <Button Name="btn" Click="btn_Click" Height="20" ></Button>
    </StackPanel> 
```

并且代码有效！

现在我希望使用 ModelView 控制器来组建 AudioPlayer。这个怎么做 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T06:10:48.103

假设“AudioPlayer”是您的“ViewModel”，您可以这样实现：

```
<UserControl x:Class="YourNamespace.AudioPlayerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:YourNamespace">

    <UserControl.DataContext>
        <local:AudioPlayer/>
    </UserControl.DataContext>

    <StackPanel>
        <Label Name="lbl_bind" Content="{Binding CurrentTrack.Title}"></Label>
        <Button Name="btn" Click="btn_Click" Height="20" ></Button>
    </StackPanel>
</UserControl> 
```

我建议避免命名控件，除非您实际上是在编写代码隐藏（对于 MVVM，这应该是不必要的）。我还建议从“Click”处理程序切换到“Command”处理程序，并使用“DelegateCommand”之类的东西来处理按钮事件。

# tomcat - Tomcat 性能负载

> ID：12462263
> 
> 赞同：0
> 
> 时间：2012-09-17T15:16:11.127
> 
> 标签：tomcat, benchmarking, load-testing, performance

我们目前正在对我们的应用程序进行负载测试，这是一个 java rest services webapp。乍一看性能很差，但我们没有可比性。

**环境：** - Amazon micro EC2 实例上的 ubuntu 12.04 服务器 - tomcat 7，maxThreads=500，Xmx=450m - java 6，默认安装。

**webapp / service：** 一个简单的 webapp，带有名为“getVersion”的服务。它返回一个字符串“1”——没有处理（数据库、文件等）——只返回“1”。

**测试：** 我们使用 multimechanize 对其进行负载测试：100 个并发用户 60 秒。我们每秒有 76 个请求。

**结果：** 在 0,X 和 5 秒之间做出响应。大约每 10 个请求出现 5 秒。

我们认为 Tomcat 可以轻松处理这么多并发请求。这是正常的吗？除了内存 maxThreads 还有什么可以调整的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:47:04.553

> 结果：在 0,X 和 5 秒之间做出响应。大约每 10 个请求出现 5 秒。

基于以上，我将附加一个分析器（例如 jvisualvm）并观察 GC 周期，尝试设置并行 GC，或者只是增加堆大小并查看它是否有影响，450m 应该足够了，但是每个请求的膨胀并且有许多用户可能会导致频繁的 GC 循环，只是一个猜测，但值得一试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-24T21:02:49.723

我会先在您的本地笔记本电脑上尝试相同的负载测试，以排除微型实例的问题（如果它是一个死的简单应用程序，如您所说，那应该不难）。

然后运行 ​​jvisualvm 并进行一些概要分析也很容易。偶尔非常缓慢的异常值闻起来像 GC 问题。

（如果有帮助的话，这些数字听起来很可怕。我希望像这样的虚拟应用程序能够处理的远不止这些）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-10T03:59:27.820

您的问题可能是由于微实例方法：

它们最多有 2 个 ECU，但它们不保持这种处理能力。如果您滥用您的 cpu 份额，您的实例会在一段时间内得到较少的处理。

# android - 动态壁纸中标题栏的高度

> ID：12462266
> 
> 赞同：2
> 
> 时间：2012-09-17T15:16:25.097
> 
> 标签：android, height, live-wallpaper, titlebar

我知道如何从 android LiveWallpaper 中检索标题栏的高度？

我知道如何从活动中做到这一点：[状态栏的高度？](https://stackoverflow.com/questions/3355367/height-of-statusbar)：

```
Rect rectgle= new Rect();
Window window= getWindow();
window.getDecorView().getWindowVisibleDisplayFrame(rectgle);
int StatusBarHeight= rectgle.top;
int contentViewTop= 
window.findViewById(Window.ID_ANDROID_CONTENT).getTop();
int TitleBarHeight= contentViewTop - StatusBarHeight;

Log.i("*** Jorgesys :: ", "StatusBar Height= " + StatusBarHeight + " , TitleBar Height = " + TitleBarHeight); 
```

但是从 WallpaperService.Engine，我不知道如何访问 getWindow()。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T21:54:32.820

我看不到直接从服务中找到 getWindow() 的方法。作为一种解决方法，您可以创建一个透明的活动，只需获取条形高度并自行完成。您可以在首次创建引擎服务时启动此活动。这不是理想的，但应该可以正常工作。

# c++ - 将绑定函数分配给 std::function

> ID：12462271
> 
> 赞同：0
> 
> 时间：2012-09-17T15:16:44.490
> 
> 标签：c++, templates, vector, compiler-errors

这不会为我编译：

```
int i = 1;
std::function<void(std::vector<int>&)> execute = std::bind(append<int>, _1, std::ref(i)); 
```

append 有签名的地方：

```
template<class T>
void append(std::vector<T>& container, const T& valueToAppend) 
```

我做错了什么很明显吗？

编译器错误是：

```
error C2664: 'void (std::vector<_Ty> &,const T &)' : cannot convert parameter 1 from 'boost::arg<I>' to 'std::vector<_Ty> &'
1>          with
1>          [
1>              _Ty=int,
1>              T=int
1>          ]
1>          and
1>          [
1>              I=1
1>          ]
1>          and
1>          [
1>              _Ty=int
1>          ] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:20:02.547

你需要

```
using namespace std::placeholders; 
```

# internet-explorer-9 - css 不透明度导致 IE9 中的布局问题

> ID：12462272
> 
> 赞同：8
> 
> 时间：2012-09-17T15:16:48.653
> 
> 标签：internet-explorer-9, opacity, css

我在 IE9 中遇到了一个非常有趣的问题。在包装 div 上使用 filter: alpha(opacity=) 或 -ms-filter css 属性时，内部块元素的框模型会损坏。换句话说，垂直边距的折叠被禁用，而是添加了垂直边距。我只在 IE9 中遇到这个问题。IE7/8 不受影响。

这是一个带有孤立问题的[jsFiddle 。](http://jsfiddle.net/9CrQG/3/)使用触发器锚激活包含过滤器的类：包装 div 上的 alpha。（仅限 IE9）

任何想法为什么会发生这种情况？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T08:27:57.563

任何过滤器似乎都可以做到这一点（[jsfiddle.net/7BFd7](http://jsfiddle.net/7BFd7)）。

我只能假设它为什么会这样做。似乎使用过滤器将元素设置为使用一些不进行边距折叠的未知显示或位置模式（如绝对位置、内联块和浮动或清除元素）。

无论如何.. 如果你只是想隐藏那个元素，你可以使用`visibility: hidden`，它具有相同的效果`opacity: 0`并且在任何地方都受支持。

如果要为不透明度设置动画，则必须通过条件注释或 Normalizr 进行浏览器嗅探，并`opacity`在 IE9 中进行动画处理，并在较旧的 IE 版本中应用过滤器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-01T23:14:40.863

仅使用 CSS 在 IE9 中“取消设置”文件管理器同时允许它在 IE8 及更低版本中应用的一种方法是以下仅针对 IE9 的代码：

```
.css-selector {
    filter:value;
    opacity:value;
}
@media all and (min-width:0) { /* the min-width query hides below IE9 */ 
    .css-selector { 
        filter:none; 
    } 
} 
```

这样，您将只使用 opacity:value 而不是在 IE9 中过滤该元素。

# javascript - 如何在 Mozilla Firefox 中手动调整 iFrame 大小

> ID：12462275
> 
> 赞同：0
> 
> 时间：2012-09-17T15:17:02.000
> 
> 标签：javascript, html, iframe

我在弹出窗口中使用了两个 iframe。在 IE 中，我可以手动拉伸第一帧，但在 Firefox 中是不可能的。我怎样才能使这项工作？

第一个 iFrame 的代码（我需要能够手动拉伸）：

```
<iframe name="iframeContent" id="iframeContent" scrolling="no" frameborder="no"
        style="width:100%;height:100%;border-right:0px;border-top:0px;border-left:5px solid #cccccc;border-bottom:5px solid #cccccc;"
        src="help.html" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T10:26:00.917

问题是您将 iframe 设置为 100% 的高度，但数量是多少？100% 什么？它始终是元素的父级，因此 iframe 的父级是设置为 100% 的主体，但那是什么值？

body 的父级是`html`什么 html 设置为？这就是问题所在。Html 的父级是视口，将 html 的高度设置为 100% 将为您提供视口高度的实际尺寸值，该值将向下级联到 iframe 并为您提供实际尺寸值。

就此而言，您还可以将这些父项中的任何一个设置为实际值，例如 200px。

# asp.net - 使用自定义工厂测试 ServiceStack 服务

> ID：12462276
> 
> 赞同：3
> 
> 时间：2012-09-17T15:17:03.030
> 
> 标签：asp.net, httpcontext, servicestack

我在[这里](http://www.richardfawcett.net/2012/02/29/accessing-asp-net-session-from-servicestack/)阅读了关于从 ServiceStack 访问 ASP.NET 会话的优秀文章。

它似乎工作得很好，但我不知道如何为需要直接访问 HttpContext 的服务创建“传递”UT（Nunit），因为 Nunit 不使用 Web.config 和我的自定义工厂配置，并且无法创建我的定制工厂。

```
<httpHandlers>
<add path="api*" type="SomeNamespace.SessionHttpHandlerFactory" verb="*" />
</httpHandlers> 
```

所以，我在 HttpContext.Current 有一个空引用

```
class SomeService : RestServiceBase<SomeDto>
{
    public override object OnGet(SomeDto request)
    {
            var context = HttpContext.Current;
            return something;

    }

    IRequestContext RequestContext { get; set; }
} 
```

我也尝试过以这种方式模拟会话，但仍然无法正常工作

```
 HttpWorkerRequest _wr = new SimpleWorkerRequest("/dummyWorkerRequest", @"c:\inetpub\wwwroot\dummy", "default.aspx", null, new StringWriter());
        HttpContext.Current = new HttpContext(_wr);
        HttpSessionStateContainer sessionContainer = new HttpSessionStateContainer("id", new SessionStateItemCollection(), new HttpStaticObjectsCollection(), 10, true, HttpCookieMode.AutoDetect, SessionStateMode.InProc, false);
        SessionStateUtility.AddHttpSessionStateToContext(HttpContext.Current, sessionContainer); 
```

如何在 UT 创建我的自定义工厂？

抱歉英语不好。

# c# - 无法再从 Visual Studio 设计视图编辑控件

> ID：12462281
> 
> 赞同：0
> 
> 时间：2012-09-17T15:17:22.030
> 
> 标签：c#, .net, visual-studio-2010, visual-studio

我正在开发一个控件，并且一直在从 VS 设计视图中编辑它的视图。我没有编辑 Designer.cs 文件，只有 .cs 文件。但是，突然之间（星期一）我再也看不到设计视图中的控件了。什么会导致这种情况发生？我该如何解决？

编辑：这是我尝试过的。我读到用户控件`this.DesignMode`总是错误的，因此应该像我在这里所做的那样在 Load 事件中检查它，但我仍然无法使用设计视图。想法？

```
 this.Load += (sender, args) =>
                         {
                             if (this.DesignMode)
                                 return;

                             try
                             {
                                 DateTime timeWhenLoaded = DateTime.Now;
                                 this.LoadLayouts();
                                 this.LoadScheduleView(timeWhenLoaded);
                             }
                             catch (Exception ex)
                             {
                                 log.Warn("Something went wrong while setting up the Layout Scheduler", ex);
                             }
                             finally
                             {
                                 this.FormIsOpening = false;
                             }
                         }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-24T20:34:21.383

这个特定的控件有一个 DataGridView，它使用一个特殊的扩展类来创建一个 CalendarColumn。这是一个内部类。为了便于阅读，我将这个内部类放在了一个区域，位于正在设计的类的声明之上。一旦我将它移回正在设计的类的声明下方，设计器就会立即弹出查看！

# jquery - 递归鼠标悬停过多

> ID：12462283
> 
> 赞同：0
> 
> 时间：2012-09-17T15:17:49.517
> 
> 标签：jquery, map, mouseover

我有以下代码来突出显示地图的不同区域（例如，当一个状态被财政分离，并且用户在状态的一部分上进行鼠标悬停时，必须突出显示整个状态）：

```
$(function() {
$('#area-a').mouseover(function(e) {
    $('#area-b').mouseover();
    $('#area-c').mouseover();
}).mouseout(function(e) {
    $('#area-b').mouseout();
    $('#area-c').mouseout();
});

$(function() {
$('#area-b').mouseover(function(e) {
    $('#area-a').mouseover();
    $('#area-c').mouseover();   
}).mouseout(function(e) {
    $('#area-a').mouseout();
    $('#area-c').mouseout();
}); 
```

});

所以，我得到了太多递归错误，我知道为什么会这样，我发现 event.stopPropagation() 是解决它的方法，但是如果我把它放在函数的开头，它不会突出显示所有这些地区，所以我被困住了。这是突出显示不同区域的正确方法还是应该将 stopPropagation 事件放在其他地方？

# background - SVG 背景图案使用全局而非局部坐标系

> ID：12462286
> 
> 赞同：3
> 
> 时间：2012-09-17T15:18:06.140
> 
> 标签：background, path, svg, design-patterns

目前我正在使用 svg 图形来显示拼接的“地图”。当我尝试以图案（图像）为背景绘制矩形或路径时，该图案不会使用绘制的矩形/路径的局部坐标系，而是使用全局坐标系。

这就是我在 svg 文档中定义模式的方式：

```
<defs>
    <pattern preserveAspectRatio="true" patternUnits="userSpaceOnUse" height="24" width="50" y="0" x="0" id="black_h">
         <image height="24" width="50" y="0" x="0" xlink:href="http://newlini.lokal/img/svg/black_h.png"/>
    </pattern>
</defs> 
```

这就是我将模式应用于路径的方式：

```
<path style="fill: url(#black_h)" d="M324 0 L324 375 L348 375 L348 0"> 
```

所以我期望的行为是，模式从路径的左上角开始，并在两个方向上重复。但在我的示例中，模式从 svg 文档的左上角开始，因此只有当 y 坐标是 24 的倍数时，路径才会看起来不错。

你知道我被困在哪里了吗？

提前致谢，

托比

编辑1：

这是我在 jsfiddle 上的问题的一个小例子：http: [//jsfiddle.net/E3wBn/](http://jsfiddle.net/E3wBn/)

编辑2：

我使用了 robertc 的建议并将我的示例 svg 更改为：

[http://jsfiddle.net/2DKXn/](http://jsfiddle.net/2DKXn/)

我还上传了一个示例 jpg，它显示了它以后的样子。

[http://www.img-share.net/uploads/oi1IcdPBVk.jpg](http://www.img-share.net/uploads/oi1IcdPBVk.jpg)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T11:49:39.947

相关的属性和值是[`patternContentUnits="objectBoundingBox"`](https://developer.mozilla.org/en-US/docs/SVG/Attribute/patternContentUnits)，但它可能不会完全符合您的预期。当您指定此值时，您必须将您使用的坐标调整为如下所示：

```
<defs>
    <pattern preserveAspectRatio="true" patternContentUnits="objectBoundingBox" height="0.5" width="1" y="0" x="0" id="black_h">
         <image height="0.5" width="1" y="0" x="0" xlink:href="http://newlini.lokal/img/svg/black_h.png"/>
    </pattern>
</defs> 
```

然后，所有内容都将按比例放大以适应其应用的对象。我无权访问您使用的图像，因此无法直接测试上述代码，但我做了[这个类似的示例](http://jsfiddle.net/robertc/HBZHM/)。请注意，使用这种方法，您基本上会得到固定数量的重复，而不是固定大小的图像平铺。

在 Mozilla Developer Network 上有[一篇关于 SVG 模式的较长](https://developer.mozilla.org/en-US/docs/SVG/Tutorial/Patterns)文章，我将那篇文章中的两个示例放入[这个 JSFiddle](http://jsfiddle.net/robertc/3uzXR/)以方便实验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T10:14:31.403

行。这个问题的一个可能的解决方案是为每个模式创建一个 svg，然后将其包含在“main”svg 中。我从未尝试过，但也许这适合。

尽管如此，由于时间压力，我们（设计师和我）还是决定使用 LinearGradients：

```
<linearGradient id="black_h" y2="100%" x2="0%" y1="0%" x1="0%">
     <stop style="stop-color:#555555;stop-opacity:1" offset="0%">
     <stop style="stop-color:#1E1E1E;stop-opacity:1" offset="100%">
</linearGradient> 
```

它就像一个魅力:)

谢谢大家的建议和帮助！

# magento - 用外键保存两个模型

> ID：12462287
> 
> 赞同：3
> 
> 时间：2012-09-17T15:18:10.323
> 
> 标签：magento

我很好奇这是否可能。

基本上我有两个相关的模型。我想知道是否可以将两个模型保存为事务，并使用第一个模型的新插入 ID 自动填充第二个模型的外键。

我知道这可以通过单独保存模型来完成，但我的问题是它是否可以作为一个保存来完成。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-19T14:02:58.970

我最终通过使用后/前保存和修改数据来做到这一点。我使用注册表传递了 id。

* * *

**我的解决方案**

```
//after first model save
public function _afterSave(){
    Mage::unregister('id');
    Mage::register('id', $this->getData('id'));
}

//before second model save
public function _beforeSave(){
    if (Mage::registry('id') && !$this->getData('id')) {
        $this->setData('id', Mage::registry('id'));
    }
} 
```

# java - 如何在此应用程序中使用 Java 反射

> ID：12462288
> 
> 赞同：0
> 
> 时间：2012-09-17T15:18:14.473
> 
> 标签：java, reflection

我想在我的 Application 中使用反射 API。我有一个接口及其实现类，所有方法声明如图所示。

请让我知道如何对上述代码使用反射。

我已经开始编写客户端类，但我不确定这是否正确？？请让我知道如何调用该方法

请帮助我

```
public interface DataHandler extends Remote {

    public abstract String logon(String  message) throws RemoteException;
    public abstract String logoff(String message) throws RemoteException;
    public abstract String userinformation(String message) throws RemoteException;
    public abstract String updateUser(String message) throws RemoteException; 
} 
```

**以及上述接口的实现类如图**

```
public class CodeHandler implements DataHandler
{
    public  String logon(String  message) throws RemoteException {}
    public  String logoff(String  message) throws RemoteException {}
    public  String userinformation(String  message) throws RemoteException {}
    public  String updateUser(String  message) throws RemoteException {}
} 
```

**我有一个如图所示的客户端类**

```
public class Client
{
    public static void main(String args[])
    {
        callMethod("logon"); 
    }

    private Object callMethod(String  message) {
        String methodName = message ;
        Method method = DataHandler.class.getDeclaredMethod(methodName, null);
        method.setAccessible(true);
        // How to use method.invoke in this case ??
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:25:27.027

我可以看到您的接口 extends `java.rmi.Remote`，所以我想您必须在这里使用 RMI 工具而不是反射，但是如果您*真的*需要使用反射，请尝试以下操作：

```
private Object callMethod(CodeHandler codeHandler, String methodName, String message) {
    try {
        Method method = DataHandler.class.getDeclaredMethod(methodName, String.class);
        method.setAccessible(true);

        return method.invoke(codeHandler, message);
    } catch (NoSuchMethodException e) {
        handle(e);
    } catch (IllegalAccessException e) {
        handle(e);
    } catch (InvocationTargetException e) {
        handle(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:26:49.413

login(String message) 是您示例中的实例方法；如果不首先创建 CodeHandler 的实例，您就无法调用它（请参阅 Saintali 的答案以了解如何）。如果您声明该方法是静态的，那么您可以通过以下方式调用它：

```
method.invoke(null, message); 
```

有关详细信息，请参阅[方法 API 。](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Method.html#invoke%28java.lang.Object,%20java.lang.Object...%29)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:22:52.320

```
 private Object callMethod(String methodName, CodeHandler object, String strParamForMethod)
   {
      try
      {
         Method method = DataHandler.class.getDeclaredMethod(methodName, null);
         method.setAccessible(true);
         method.invoke(object, strParamForMethod);
      }
      catch (NoSuchMethodException | IllegalAccessException | InvocationTargetException e)
      {
      }
   } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T15:25:38.747

在您提到的评论中，您只想在类 CodeHandler 中调用方法登录。所以你不应该使用反射，而是这样做：

```
public class Client {

   public static void main(String args[]) {
      callMethod("logon"); 
   }

   private Object callMethod(String  message) {
      CodeHandler codeHandler = new CodeHandler();
      codeHandler.logon(message);
   }
} 
```

# r - 在 R 中强制逻辑模型中的参考类别

> ID：12462289
> 
> 赞同：4
> 
> 时间：2012-09-17T14:28:05.453
> 
> 标签：r, interaction

使用 R，我正在运行一个逻辑模型，并且需要以下列方式包含一个交互项，其中 A 是分类的，B 是连续的。

```
Y ~ A + B + normalized(B):A 
```

我的问题是，当我这样做时，参考类别与

```
Y ~ A + B + A:B 
```

这使得模型的比较变得困难。我确信有一种方法可以强制参考类别始终相同，但似乎无法找到一个直截了当的答案。

为了说明，我的数据如下所示：

```
income                      ndvi        sga
30,000$ - 49,999$        -0,141177617        0
30,000$ - 49,999$        -0,170513257        0
>80,000$                 -0,054939323        1
>80,000$                 -0,14724104         0
>80,000$                 -0,207678157        0
missing                  -0,229890869        1
50,000$ - 79,999$         0,245063253        0
50,000$ - 79,999$         0,127565529        0
15,000$ - 29,999$        -0,145778357        0
15,000$ - 29,999$        -0,170944338        0
30,000$ - 49,999$        -0,121060635        0
30,000$ - 49,999$        -0,245407291        0
missing                  -0,156427532        0
>80,000$                  0,033541238        0 
```

输出如下所示。第一组结果是模型 Y ~ A*B 的形式，第二组是 Y ~ A + B + A:normalized(B)

```
 Estimate Std. Error z value Pr(>|z|)    
(Intercept)                            -2.72175    0.29806  -9.132   <2e-16 ***
ndvi                                    2.78106    2.16531   1.284   0.1990    
income15,000$ - 29,999$                -0.53539    0.46211  -1.159   0.2466    
income30,000$ - 49,999$                -0.68254    0.39479  -1.729   0.0838 .  
income50,000$ - 79,999$                -0.13429    0.33097  -0.406   0.6849    
income>80,000$                         -0.56692    0.35144  -1.613   0.1067    
incomemissing                          -0.85257    0.47230  -1.805   0.0711 .  
ndvi:income15,000$ - 29,999$           -2.27703    3.25433  -0.700   0.4841    
ndvi:income30,000$ - 49,999$           -3.76892    2.86099  -1.317   0.1877    
ndvi:income50,000$ - 79,999$           -0.07278    2.46483  -0.030   0.9764    
ndvi:income>80,000$                    -3.32489    2.62000  -1.269   0.2044    
ndvi:incomemissing                     -3.98098    3.35447  -1.187   0.2353 

                                         Estimate Std. Error z value Pr(>|z|)    
(Intercept)                              -3.07421    0.30680 -10.020   <2e-16 ***
ndvi                                     -1.19992    2.56201  -0.468    0.640    
income15,000$ - 29,999$                  -0.33379    0.29920  -1.116    0.265    
income30,000$ - 49,999$                  -0.34885    0.26666  -1.308    0.191    
income50,000$ - 79,999$                  -0.12784    0.25124  -0.509    0.611    
income>80,000$                           -0.27255    0.27288  -0.999    0.318    
incomemissing                            -0.50010    0.31299  -1.598    0.110    
income<15,000$:normalize(ndvi)            0.40515    0.34139   1.187    0.235    
income15,000$ - 29,999$:normalize(ndvi)   0.17341    0.35933   0.483    0.629    
income30,000$ - 49,999$:normalize(ndvi)   0.02158    0.32280   0.067    0.947    
income50,000$ - 79,999$:normalize(ndvi)   0.39774    0.28697   1.386    0.166    
income>80,000$:normalize(ndvi)            0.06677    0.30087   0.222    0.824    
incomemissing:normalize(ndvi)                  NA         NA      NA       NA 
```

所以在第一个模型中，类别“收入<15,000”是参考类别，而在第二个模型中，发生了一些不同的事情，我还不是很清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-08T13:08:33.537

假设我们想对这个方程进行回归![](../Images/4ae3cc96d28f3a53bdf10897af35e0a3.png)。

我们尝试使用`model.matrix`. 但是下面的结果说明了一些自动化问题。**有没有更好的方法来实现它？**. 更具体地说，假设 X_1 是一个连续变量，而 X_2 是一个虚拟变量。

基本上交互项的解释是相同的，除了主要项 X_2 将在 X_1 处于其平均值时进行评估。（见[本文初稿](http://www.google.fr/url?sa=t&rct=j&q=&esrc=s&source=web&cd=4&ved=0CDwQFjAD&url=http://www.uh.edu/~bsorense/interactionOct18_2011.pdf&ei=QxeUU4_iGcWY1AXZtICIDA&usg=AFQjCNGRUSv8NjDRui-v2HIpILzCyr6f6Q&sig2=suUvWxe34FGFGLcd2xIsqQ&bvm=bv.68445247,d.d2k&cad=rja)）

这里有一些数据来说明我的观点：（*这不是 glm 但我们可以将相同的方法应用于 glm*）

```
library(car)
str(Prestige)
# some data cleaning
Prestige <- Prestige[!is.na(Prestige$type),] 

# interaction the usual way.
lm1 <- lm(income ~ education+ type + education:type, data = Prestige); summary(lm1)

# interacting with demeaned education
Prestige$education_ <- Prestige$education-mean(Prestige$education) 
```

当使用正则公式方法时，事情并没有按照我们想要的方式发展。由于公式没有将任何变量作为参考

```
lm2 <- lm(income ~ education+ type + education_:type, data = Prestige); summary(lm2)

# Using model.matrix to shape the interaction
cusInt <- model.matrix(~-1+education_:type,data=Prestige)[,-1];colnames(cusInt)
lm3 <- lm(income ~ education+ type + cusInt, data = Prestige); summary(lm3)

compareCoefs(lm1,lm3,lm2) 
```

结果在这里：

```
 Est. 1  SE 1 Est. 2  SE 2 Est. 3  SE 3
(Intercept)                -1865  3682  -1865  3682   4280  8392
education                    866   436    866   436    297   770
typeprof                   -3068  7192   -542  1950   -542  1950
typewc                      3646  9274  -2498  1377  -2498  1377
education:typeprof           234   617                          
education:typewc            -569   885                          
cusInteducation_:typeprof                 234   617             
cusInteducation_:typewc                  -569   885             
typebc:education_                                      569   885
typeprof:education_                                    803   885
typewc:education_ 
```

所以基本上在使用 model.matrix 时，我们必须进行干预以设置参考变量。另外变量名前面还出现了一些custInt，所以当有很多表要比较时格式化结果是相当繁琐的。

# mysql - PDO 和 IS NOT NULL 函数

> ID：12462291
> 
> 赞同：4
> 
> 时间：2012-09-17T15:18:20.090
> 
> 标签：mysql, null, pdo, prepared-statement

我是 PDO 的新手，我想知道是否有与 mysql 语句等效的检查参数是否不为空的语句，例如：

```
SELECT * FROM table
WHERE param IS NOT NULL 
```

我试过这个：

```
$pdo->prepare('SELECT * FROM ' . $tablename . ' WHERE ' . $field . ' = :' . $field . 'AND param IS NOT NULL'); 
```

没有任何成功。我也在网上看了，但没有找到任何相关的东西，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:23:43.863

您可以在 pdo 中使用可以直接在 mysql 中使用的任何查询，但是您这样做的方式首先违背了使用 PDO 的目的，您应该将查询表述为

```
$q = $pdo->prepare("SELECT * FROM $tablename WHERE field = :field AND param IS NOT NULL");
$q->execute(array('field' => $field)); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-17T15:20:52.197

是……</p>

```
$sql = "SELECT * FROM `tablename` WHERE :field IS NOT NULL";
$stmt = $pdo->prepare($sql);
$stmt->bindParam(':field', $field); 
```

…你在找什么？

# php - Codeigniter - 从单个查询创建两个或多个结果对象

> ID：12462292
> 
> 赞同：0
> 
> 时间：2012-09-17T15:18:21.160
> 
> 标签：php, database, codeigniter, mysqli

请看这段代码：

```
$query = $this->db->query("SELECT * FROM comments c LEFT JOIN users u ON u.user_id = c.user_id");
foreach ($query->result('Comment') as $comment)
{
// $comment holds all data from both tables
} 
```

所以，我想要的是有两个对象`$comment`（只有评论表中的列作为对象属性）和`$user`那个评论。**有什么简单的方法可以得到吗？**

请注意，这是一般问题，我需要两个表中的所有列，有时一个表中的列可以将名称作为其他表中的列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T20:26:39.563

在该 foreach 中，您可以执行以下操作：

```
foreach ($query->result('Comment') as $comments)
{
    $comment[$comments->getCommentId()] = $comments->getCommentInfo();
    $user[$comments->getCommentId()] = $comment->getUserInfo();

} 
```

在评论类上，您应该创建一个返回所有用户特定数据的方法和另一个用于特定评论信息的方法，您还可以在调用该方法时从当前实例中清除该信息。
这样，您将在单独的变量中获得您想要的内容，作为每个评论的数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T10:08:09.960

我发现解决方案 whitch 现在对我来说非常有效。我所需要的就是使用 PDO。这是我现在的代码：

```
$this->db->conn_id->setAttribute(PDO::ATTR_FETCH_TABLE_NAMES, 1);
$query = $this->db->query("SELECT * FROM comments c LEFT JOIN users u ON u.user_id = c.user_id");
foreach ($query->result_array() as $row)
{
    $comment = row2object($row, 'Comment', 'c');
    $comment->user = row2object($row, 'User', 'u');

    $comments[] = $comment;
} 
```

和 row2object() 助手：

```
/**
 * Row to object
 * application/helpers/row2object_helper.php
 *
 * @param array $row
 * @param string $class
 * @param string $from_table alias of table name
 */
function row2object(&$row, $class, $from_table)
{
    $object = new $class;

    foreach($row as $key => $value)
    {
        list($table, $column) = explode(".", $key);

        if($table == $from_table)
        {
            $object->{$column} = $value;
            unset($row[$key]);
        }
        elseif ($table == "" && substr($key, 1, strlen($from_table)) == $from_table)
        {
            $column = substr($key, strlen($from_table) + 2);
            $object->{$column} = $value;
            unset($row[$key]);
        }
    }

    return $object;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T13:54:07.633

这里描述的方法更好：[https](https://stackoverflow.com/a/10803244/385402) ://stackoverflow.com/a/10803244/385402因为它涉及通过延迟加载（按需）获取相关对象

# cocos2d-iphone - 我可以将带有 CCMenuItemSprite 的 CCMenu 添加到 spritebatchnode 吗？

> ID：12462293
> 
> 赞同：1
> 
> 时间：2012-09-17T15:18:24.140
> 
> 标签：cocos2d-iphone, ccsprite, ccmenuitem

我可以将带有 CCMenuItemSprite 的 CCMenu 添加到 spritebatchnode 吗？

就如此容易。

代码片段：

```
-(void) setUpPauseMenu
{
    CCMenuItemSprite *p = [CCMenuItemSprite itemWithNormalSprite:[CCSprite spriteWithSpriteFrameName:@"emptyCircle.png"] selectedSprite:[CCSprite spriteWithSpriteFrameName:@"emptyCircle.png"] target:self  selector:@selector(pauseGameScene)];

    p.position = CGPointMake(50.0f, 440.0f);
    p.anchorPoint = CGPointMake(0.5f, 0.5f);

    //[spritebatchnodereference addChild:p];
    **//CAN I ADD p TO SPRITEBATCHNODE?** 

    CCLabelTTF *pauseText = [CCLabelTTF labelWithString:@"II" fontName:@"Marker Felt" fontSize:20];
    pauseText.position = CGPointMake(22.0f, 28.0f);
    pauseText.anchorPoint = CGPointMake(0.5f, 0.5f);
    [p addChild:pauseText];

    //Create pause menu
    CCMenu *pauseMenu = [CCMenu menuWithItems: p, nil];
    pauseMenu.anchorPoint = CGPointMake(0.5f, 0.5f);
    pauseMenu.position = CGPointMake(50.0f, 440.0f);
    pauseMenu.visible=TRUE;
    [self addChild:pauseMenu];

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T08:36:44.217

不。

CCSpriteBatchNode 只接受 CCSprite 作为孩子。

# date - 在 CouchDB 中计算日期

> ID：12462294
> 
> 赞同：0
> 
> 时间：2012-09-17T15:18:28.230
> 
> 标签：date, couchdb

我在 CouchDB 中有一些文档，其中包含一个名为 expire 的值。例如：

```
"expire": "2014-11-23T16:01:00+00:00". 
```

我正在尝试创建一个视图，显示从现在到 X 天数和年数之间的所有文档，直到“过期”值。X（以天/年为单位）需要通过查询 URL 传递。

我已经为此苦苦挣扎了一段时间，任何示例/指针都将不胜感激。

卡尔斯基

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T15:21:52.020

好的，我设法解决了这个问题！解决方案是使用 javascript 函数。例如

```
Date.parse(doc.expire) 
```

然后我可以使用它来确定我的视图返回了哪些文档（基于日期）。

# vb.net - 在对象列表上使用 removeall 时，对象是否完全从内存中删除？

> ID：12462296
> 
> 赞同：2
> 
> 时间：2012-09-17T15:18:33.603
> 
> 标签：vb.net

我正在设置的应用程序中遇到一些内存问题，该应用程序经常在自定义对象列表上使用“removeall”。在运行此函数以清理任何混乱之前，是否应该对每个要删除的对象进行处理？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:26:16.810

RemoveAll 将从您的收藏中删除它们。如果有任何其他对对象的引用，那么它们将继续存在。

您还可能正在使用一些需要清理的非托管资源。通常，如果您正在实现 IDisposable，您会将这些放在 Dispose 方法中，并且还会放在 Finalize 方法中以确保它们被清理。

否则，垃圾收集器将清理所有托管资源。这可能导致的唯一问题（这是非常罕见的）是垃圾收集器以较低的优先级运行，如果您的处理器严重挂钩，它可能没有足够的周期来清理内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:20:12.743

一般来说，没有。让垃圾收集器完成它的工作。

如果对象实现了`IDisposable`，您可能会提出调用`Dispose`它们的理由，但前提是您知道它们没有在其他任何地方使用。

如果列表非常大，则列表本身可能与您的问题有关。大列表是[大对象堆碎片](https://www.google.com/#hl=en&output=search&q=large+object+heap+fragmentation)的常见原因。在这种情况下，您无需关心列表中包含的对象。

如果你更详细地描述你的记忆问题，你可能会得到一个更有帮助的答案。

# jquery - 选择更改事件不保留最后选择

> ID：12462298
> 
> 赞同：1
> 
> 时间：2012-09-17T15:18:38.820
> 
> 标签：jquery, select

在一个页面上有 5 个选择控件，每个控件具有相同的选项值，当我在第一个下拉列表中选择一个值时，不应允许我在其他下拉列表中再次选择相同的值。我尝试了类似下面的方法。

```
$("#div").find(".selectClass").live("change", function (e) {
    var selectedValue = $(this).val();
    var controlId = $(this).attr("id");
    var isPropertyAlreadySelected = false;

    $("#div").find(".selectClass").each(function () {
        var currentSelect = $(this);
        if (controlId != currentSelect.attr("id") && currentSelect.val() == selectedValue) {
            isPropertyAlreadySelected = true;
        }
    });

    e.preventDefault();
    return false;
}); 
```

**编辑：删除了对标志“isPropertyAlreadySelected”的检查；但我仍然可以选择其他下拉值。**

即使我执行“return false”或“e.preventDefault()”，该值仍会在其他下拉列表中被选中。请指出我正确的方向。提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:27:35.247

正如其他人所提到的，这似乎是不可能的，因为价值已经改变了。

请参阅此相关问题和解决方案：[jQuery prevent change for select](https://stackoverflow.com/questions/5426387/jquery-prevent-change-for-select)

这是[jsFiddle中问题的最小重现](http://jsfiddle.net/eranmedan/vL5JY/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:39:35.587

您遇到的问题是，当您的更改事件触发时，选择的值已经更改。

您需要有一个当前选定值的列表并在此处重置更改的选项：

```
if (isPropertyAlreadySelected) {
    // Reset here
} 
```

只需使用在页面加载时选择的值填充一个数组，并在每次选择一个选项时更新此数组。

我刚刚测试了 mousedown 事件。这个在选项真正被选中之前触发。在这里试试：http: [//jsfiddle.net/g3rsF/1/](http://jsfiddle.net/g3rsF/1/)

这不会解决所有情况，因为用户也可以通过按键进行选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:46:13.647

将当前选定的项目保存在下拉列表中并使用这个小助手:)

```
<select id="s1" class="selectClass">
    <option>1</option>
    <option>2</option>
    <option>3</option>
</select>

<select id="s2" class="selectClass">
    <option>1</option>
    <option>2</option>
    <option>3</option>
</select>​ 
```

.

```
$(document).on("change", ".selectClass", function(ev) {
    var cur = $(this),
        text = cur.find("option:selected").text(),
        isAlreadySelected;

    isAlreadySelected = $(".selectClass").not("#" + this.id).filter(function() {
        return $(this).find("option:selected").text() === text;
    });

    if (isAlreadySelected.length) {
        cur.prop("selectedIndex", cur.prop("selIdx") || 0);
    }

    cur.data("selIdx", cur.prop("selectedIndex"));
});​ 
```

[例子](http://jsfiddle.net/4pBc3/)

# sql - 更新后触发并更新到 SQL Server 中的行

> ID：12462300
> 
> 赞同：4
> 
> 时间：2012-09-17T15:18:53.993
> 
> 标签：sql, sql-server, sql-server-2008

这是保持对数据库行更改的简单跟踪的最佳方式：

```
ALTER TRIGGER [dbo].[trg_121s] 
ON  [dbo].[121s]
  AFTER UPDATE
AS 
BEGIN
-- SET NOCOUNT ON added to prevent extra result sets from
-- interfering with SELECT statements.
SET NOCOUNT ON;

-- Insert statements for trigger here

update dbo.[121s]
set modified=getdate()
where id in 
(select distinct ID from Inserted)

END 
```

因此，对 [121s] 中行的任何更新都会导致**修改后**的列被更新。

它有效，但我不确定这是否是实现这一目标的最佳方式。

我对这条线有点困惑：

```
(select distinct ID from Inserted) 
```

...以及它如何知道它获得了正确的行 ID。

感谢您的任何确认/澄清，

标记

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-17T15:25:57.683

`inserted`是一个伪表，它肯定包含受该`UPDATE`语句影响的所有正确行（`DISTINCT`如果主键，我认为不是必需`ID`的 - 尽管很难分辨名称为 的表是什么`121s`）。在应用修改后的日期/时间之前，您可以考虑验证它们是否都实际*更改了*值。除此之外，我可能会这样做：

```
ALTER TRIGGER [dbo].[trg_121s] 
ON [dbo].[121s]
AFTER UPDATE
AS 
BEGIN
  SET NOCOUNT ON;

  UPDATE t SET modified = CURRENT_TIMESTAMP
   FROM dbo.[121s] AS t
   WHERE EXISTS (SELECT 1 FROM inserted WHERE ID = t.ID);
   -- WHERE EXISTS is same as INNER JOIN inserted AS i ON t.ID = i.ID;
END
GO 
```

如果您想要 100% 万无一失地保证它们都使用相同的时间戳进行更新（尽管我不知道在这个用例中是否见过多个值）：

```
ALTER TRIGGER [dbo].[trg_121s] 
ON [dbo].[121s]
AFTER UPDATE
AS 
BEGIN
  SET NOCOUNT ON;

  DECLARE @ts DATETIME;
  SET @ts = CURRENT_TIMESTAMP;

  UPDATE t SET modified = @ts
   FROM dbo.[121s] AS t
  INNER JOIN inserted AS i 
  ON t.ID = i.ID;
END
GO 
```

`foo`如果您想确保仅在列更改值时才发生更新，您可以说：

```
 UPDATE t SET modified = @ts
   FROM dbo.[121s] AS t
   INNER JOIN inserted AS i
   ON t.ID = i.ID
   AND t.foo <> i.foo; 
```

这是一般模式，但如果它可以为空，它会变得更加复杂`foo`，因为 SQL Server 将无法匹配一侧有值而另一侧没有值（或两者都没有）的行。在这种情况下，你会这样做：

```
 AND 
   (
     t.foo <> i.foo
     OR (t.foo IS NULL AND i.foo IS NOT NULL)
     OR (t.foo IS NOT NULL AND i.foo IS NULL)
   ); 
```

有些人会说“我可以使用 COALESCE 或 ISNULL 来对抗一些魔法值”，如下所示：

```
WHERE COALESCE(t.foo, 'magic') <> COALESCE(i.foo, 'magic') 
```

...我会警告你不要这样做，因为你会不断地寻找一些在数据中不存在的神奇值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T15:22:41.367

Inserted 是一个表，其中包含受触发触发器（插入/更新）的操作影响的行。所以你这里的触发器是正确的。如果 Id 是主键，那么您不需要 distinct（从 Inserted 中选择 id 就足够了）。如果 Id 不是主键，那么您的触发器是错误的，因为您最终可能会更新更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:24:08.387

虽然很多人，不仅在 Stackoverflow 上，而且在世界各地都会告诉你触发器是邪恶的，但我要说的是，当它们没有被滥用时，它们是有价值的。在这里，如果您想使用此触发器，它似乎是有效的，并且该`Inserted`表包含由触发此触发器的语句更新的行 - 它是正确的，但如果是主键`DISTINCT`则可能会被删除。`ID`

但是，如果您有灵活性，另一种选择是使用`timestamp`列。但是，不要混淆，该`timestamp`列与日期和时间**无关。**因此，如果您需要日期和时间，请坚持使用那里的内容。

# symfony - 资产的动态时间戳？

> ID：12462301
> 
> 赞同：0
> 
> 时间：2012-09-17T15:18:55.547
> 
> 标签：symfony, assetic

现在我有：

```
templating:
    engines: ['twig']
    assets_version:      ~
    assets_version_format:  %%s?%%s 
```

还有我的`javascripts`标签

```
assetic:
    debug:            false
    use_controller:   false
    read_from:        %kernel.root_dir%/../web
    write_to:         %kernel.root_dir%/../web
    ..... 
```

你猜怎么着 ？每次我运行时文件的名称都不会改变

```
php app/console assetic:dump --env=prod 
```

我按照[文档](http://symfony.com/doc/current/cookbook/assetic/asset_management.html)没有任何成功...

我显然不想要的是在 config.yml 中**手动**指定资产的版本。我想要文件名或在文件编译文件发生更改时（或当我运行转储命令时）**自动**生成的特殊查询字符串

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T16:00:10.050

该`assets_version`参数不控制资产生成的文件的名称。`asset()`它只是一个查询参数，当您使用twig 中的函数输出资产时添加到资产的 url 。这会生成这样的网址：

```
/images/logo.png?v2 
```

其中 v2 是`assets_version`参数的值。问题是您必须在每次更新资产时手动更新此值，因为没有自动方法可以做到这一点。

至于当您重新运行assetic:dump 时资产文件的名称不会改变，这是一个已知问题。但是你很幸运！就在三天前，一个新的[拉取请求](https://github.com/kriswallsmith/assetic/pull/297)被合并到仅提供此功能的资产代码中:-)。因此，您只需更新到最新版本的资产，您就可以使用此功能。

# c++ - 在应用程序运行时禁用 WER

> ID：12462302
> 
> 赞同：1
> 
> 时间：2012-09-17T15:19:01.877
> 
> 标签：c++, windows-error-reporting

我正在开发一个不断打开 IE、执行任务、关闭它然后重复的应用程序。但是，如果 IE 在执行期间崩溃，系统准备继续进行下一次迭代，但是错误报告保持打开状态并且不允许进程完全关闭。这意味着它会继续占用内存，直到用户单击对话框说忽略错误。

目前我正在研究两种解决方案，使用 VectoredExceptionHandlers，以及完全禁用 WER 的能力。

我对 VectoredExceptionHandlers 的理解是，它们会拦截我的应用程序抛出的任何异常，并在它们进入 WER 之前对其进行处理。但是，由于崩溃实际上发生在我的应用程序启动的 IE 进程中，我不确定这些处理程序是否仍然能够阻止 WER 接收异常。

我也不希望像 StackOverflow 上的其他问题所建议的那样在系统上完全禁用 WER，我只希望在我的应用程序运行时禁用它。

有没有人对这些选项有更多的了解或有更好的方法来处理这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T13:18:04.390

MSDN的[WER 设置](http://msdn.microsoft.com/en-us/library/windows/desktop/bb513638%28v=vs.85%29.aspx)页面可能是您想要查看的内容。注册表中有一个部分用于排除的应用程序。您似乎可以调用这个[WerAddExcludedApplication](http://msdn.microsoft.com/en-us/library/windows/desktop/bb513617%28v=vs.85%29.aspx)函数。[从Vectored Exception Handling](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681420%28v=vs.85%29.aspx)的页面来看，它可能不会帮助您从不同的应用程序中捕获异常。

# wpf - 需要在应用所有绑定之后但在渲染之前引发 Window 的事件

> ID：12462304
> 
> 赞同：2
> 
> 时间：2012-09-17T15:19:09.087
> 
> 标签：wpf, window

有时 WPF 会变成 WTF =)

来自 MSDN：

[FrameworkElement.Loaded 事件](http://msdn.microsoft.com/en-us/library/system.windows.frameworkelement.loaded.aspx) 在元素布局、**呈现**并准备好交互时发生。

[对象生命周期事件](http://msdn.microsoft.com/en-us/library/ms754221.aspx#intro) Loaded 事件**在最终渲染之前**引发，但在布局系统计算出所有必要的渲染值之后。

应用所有绑定后，我需要在代码后面调整窗口屏幕位置。现在这是在 Loaded 事件处理程序中完成的。我看到窗户是如何跳动的，这不是很令人赏心悦目。

**更新1**

```
private void DialogViewLoaded(object sender, RoutedEventArgs e)
        {
            MaxHeight = SystemParameters.FullPrimaryScreenHeight * 0.8;
            MaxWidth = SystemParameters.FullPrimaryScreenWidth * 0.8;
            SizeToContent = SizeToContent.WidthAndHeight;
            SizeToContent = SizeToContent.Manual;
            MaxHeight = double.PositiveInfinity;
            MaxWidth = double.PositiveInfinity;

            WindowHelper.CenterWindowOnScreen(this);
        } 
```

此代码实现了我想在 XAML 中实现的功能。 [灵活的仅 XAML 布局。可能吗？](https://stackoverflow.com/questions/12299273/flexible-xaml-only-layout-is-it-possible)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T15:06:46.700

```
 public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        CompositionTarget.Rendering += new EventHandler(OnRendering); 
    }
    void OnRendering(object sender, EventArgs e)
    {
        MaxHeight = SystemParameters.FullPrimaryScreenHeight * 0.8;
        MaxWidth = SystemParameters.FullPrimaryScreenWidth * 0.8;
        SizeToContent = SizeToContent.WidthAndHeight;
        SizeToContent = SizeToContent.Manual;
        MaxHeight = double.PositiveInfinity;
        MaxWidth = double.PositiveInfinity;
    }
} 
```

CompositionTarget.Rendering 在合成树中的对象被渲染之前发生。我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-07T11:00:13.997

您可以使用来自 Window 中 hostet 的 UserControl 中的 DesiredSize.Height 和 DesiredSize.Width。高度和宽度在加载事件之前是已知的。

# mysql - MySQL 选择多个 order by

> ID：12462310
> 
> 赞同：4
> 
> 时间：2012-09-17T15:19:25.830
> 
> 标签：mysql

所以我得到了这张桌子：

```
+----+---------------------+-----+---------------- +
| 身份证 | 何时 | 关闭 | （其他..东西）|
+----+---------------------+-----+---------------- +
| 1 | 2012-09-17 17:00:00 | 0 | 任何东西1 |
| 2 | 2012-09-17 18:00:00 | 0 | 什么2 |
| 3 | 2012-08-31 21:00:00 | 1 | blabla321 |
| 4 | 2012-08-31 18:30:00 | 1 | blab32121 |
+----+---------------------+-----+---------------- +

```

我想选择所有键，但是：

*   off = 0 的键应该在 ASC 时排序，并且应该首先显示
*   带 off = 1 的键应按 DESC 时排序，并应显示在（最后）之后

我试过这样的事情：

```
(SELECT * FROM `table` WHERE `off` = 0 ORDER BY `when` ASC)
UNION
(SELECT * FROM `table` WHERE `off` = 1 ORDER BY `when` DESC) 
```

但它不起作用。

另请查看：http: [//i.imgur.com/81Hzq.jpg](http://i.imgur.com/81Hzq.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:21:24.203

试试这个：

```
(SELECT * FROM table WHERE off = 0 ORDER BY `when` ASC) 
UNION 
(SELECT * FROM table WHERE off = 1 ORDER BY `when` DESC); 
```

我认为 WHEN 是一个关键字，必须引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:21:02.583

```
SELECT * 
FROM table 
ORDER BY CASE WHEN off = 0 THEN `when` END ASC,
         CASE WHEN off = 1 THEN `when` END DESC 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T22:22:26.233

```
select *
from `table`
order by `off`,
    case `off`
        when 0 then timestampdiff(second, current_timestamp, `when`)
        when 1 then timestampdiff(second, `when`, current_timestamp)
    end 
```

# linux-kernel - 如何确定内核堆栈大小

> ID：12462313
> 
> 赞同：5
> 
> 时间：2012-09-17T15:19:35.933
> 
> 标签：linux-kernel, kernel, kernel-module

我需要确定内核模块内正在运行的 Linux 内核的堆栈大小。我知道宏 THREAD_SIZE 给出了给定架构的堆栈大小，但我不能使用它。由于编译和运行机器不同。有什么办法可以通过 proc 接口、内核 api 或导出的符号来做到这一点？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:28:34.703

尝试这个

```
system("getconf _POSIX_THREAD_ATTR_STACKSIZE"); 
```

`getconf -a`在控制台中可能会输出系统变量列表

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-14T06:39:31.193

我认为您可以在架构的 thread_info.h 中找到它。通常内核堆栈为 2 页 (8KB)，但这取决于您的配置。

# javascript - 在 Javascript 中的对象数组中查找值

> ID：12462318
> 
> 赞同：539
> 
> 时间：2012-09-17T15:19:51.683
> 
> 标签：javascript, arrays

我知道以前有人问过类似的问题，但这个问题有点不同。我有一个未命名对象数组，其中包含一个命名对象数组，我需要获取“名称”为“字符串 1”的对象。这是一个示例数组。

```
var array = [
    { name:"string 1", value:"this", other: "that" },
    { name:"string 2", value:"this", other: "that" }
]; 
```

**更新：**我应该早点说这个，但是一旦我找到它，我想用一个编辑过的对象替换它。

* * *

## 回答 #1

> 赞同：1174
> 
> 时间：2012-09-17T15:24:48.013

### 查找数组元素：

```
let arr = [
    { name:"string 1", value:"this", other: "that" },
    { name:"string 2", value:"this", other: "that" }
];

let obj = arr.find(o => o.name === 'string 1');

console.log(obj);
```

* * *

### 替换数组元素：

```
let arr = [
    { name:"string 1", value:"this", other: "that" },
    { name:"string 2", value:"this", other: "that" }
];

let obj = arr.find((o, i) => {
    if (o.name === 'string 1') {
        arr[i] = { name: 'new string', value: 'this', other: 'that' };
        return true; // stop searching
    }
});

console.log(arr);
```

* * *

## 回答 #2

> 赞同：307
> 
> 时间：2012-09-17T15:23:36.437

您可以遍历数组并测试该属性：

```
function search(nameKey, myArray){
    for (var i=0; i < myArray.length; i++) {
        if (myArray[i].name === nameKey) {
            return myArray[i];
        }
    }
}

var array = [
    { name:"string 1", value:"this", other: "that" },
    { name:"string 2", value:"this", other: "that" }
];

var resultObject = search("string 1", array); 
```

* * *

## 回答 #3

> 赞同：202
> 
> 时间：2016-07-21T09:34:37.427

在**ES6**中你可以`Array.prototype.find(predicate, thisArg?)`这样使用：

```
array.find(x => x.name === 'string 1') 
```

[http://exploringjs.com/es6/ch_arrays.html#_searching-for-array-elements](http://exploringjs.com/es6/ch_arrays.html#_searching-for-array-elements) [https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Array/find](https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Array/find)

然后替换所述对象（并使用另一种很酷的**ES6**方法`fill`），您可以执行以下操作：

```
let obj = array.find(x => x.name === 'string 1');
let index = array.indexOf(obj);
array.fill(obj.name='some new string', index, index++); 
```

* * *

## 回答 #4

> 赞同：75
> 
> 时间：2017-05-18T12:56:03.417

根据 ECMAScript 6，您可以使用该`findIndex`函数。

```
array[array.findIndex(x => x.name == 'string 1')] 
```

* * *

## 回答 #5

> 赞同：60
> 
> 时间：2017-12-13T10:30:31.163

```
var array = [
    { name:"string 1", value:"this", other: "that" },
    { name:"string 2", value:"this", other: "that" }
];

var foundValue = array.filter(obj=>obj.name==='string 1');

console.log(foundValue); 
```

* * *

## 回答 #6

> 赞同：58
> 
> 时间：2018-02-10T08:52:48.997

考虑到您有以下代码段：

```
var array = [
    { name:"string 1", value:"this", other: "that" },
    { name:"string 2", value:"this", other: "that" }
]; 
```

您可以使用以下功能来搜索项目

```
const search = what => array.find(element => element.name === what); 
```

您可以检查是否找到了该项目。

```
if (search("string 1")) {
    console.log(search.value, search.other);
} else {
    console.log('No result found');
} 
```

* * *

## 回答 #7

> 赞同：25
> 
> 时间：2017-05-04T09:19:40.673

使用 foreach：

```
let itemYouWant = null;
array.forEach((item) => {
    if (item.name === 'string 1') {
        itemYouWant = item;
    }
});
console.log(itemYouWant); 
```

或者使用地图更好：

```
const itemYouWant = array.map((item) => {
    if (item.name === 'string 1') {
        return item;
    }
    return null;
});
console.log(itemYouWant); 
```

* * *

## 回答 #8

> 赞同：22
> 
> 时间：2012-09-17T15:24:24.733

要么使用一个简单的`for`循环：

```
var result = null;
for (var i = 0; i < array.length; i++) { 
  if (array[i].name === "string 1") { 
    result = array[i];
    break;
  } 
} 
```

或者，如果可以，也就是说，如果您的浏览器支持它，请使用[`Array.filter`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/filter)，这更简洁：

```
var result = array.filter(function (obj) {
  return obj.name === "string 1";
})[0]; 
```

* * *

## 回答 #9

> 赞同：22
> 
> 时间：2015-07-31T14:16:29.157

使用`underscore.js`findWhere 方法：

```
var array = [
    { name:"string 1", value:"this", other: "that" },
    { name:"string 2", value:"this", other: "that" }
];

var result = _.findWhere(array, {name: 'string 1'});

console.log(result.name); 
```

在[JSFIDDLE中看到这个](https://jsfiddle.net/kb9b63zv/)

* * *

## 回答 #10

> 赞同：19
> 
> 时间：2017-11-09T04:43:20.083

一行回答。您可以使用过滤功能来获得结果。

```
var array = [
    { name:"string 1", value:"this", other: "that" },
    { name:"string 2", value:"this", other: "that" }
];

console.log(array.filter(function(arr){return arr.name == 'string 1'})[0]);
```

* * *

## 回答 #11

> 赞同：13
> 
> 时间：2015-10-13T08:05:31.350

# 新答案

我将 prop 添加为参数，以使其更通用和可重用

```
/**
 * Represents a search trough an array.
 * @function search
 * @param {Array} array - The array you wanna search trough
 * @param {string} key - The key to search for
 * @param {string} [prop] - The property name to find it in
 */

function search(array, key, prop){
    // Optional, but fallback to key['name'] if not selected
    prop = (typeof prop === 'undefined') ? 'name' : prop;    

    for (var i=0; i < array.length; i++) {
        if (array[i][prop] === key) {
            return array[i];
        }
    }
} 
```

用法：

```
var array = [
    { 
        name:'string 1', 
        value:'this', 
        other: 'that' 
    },
    { 
        name:'string 2', 
        value:'this', 
        other: 'that' 
    }
];

search(array, 'string 1');
// or for other cases where the prop isn't 'name'
// ex: prop name id
search(array, 'string 1', 'id'); 
```

摩卡测试：

```
var assert = require('chai').assert;

describe('Search', function() {
    var testArray = [
        { 
            name: 'string 1', 
            value: 'this', 
            other: 'that' 
        },
        { 
            name: 'string 2', 
            value: 'new', 
            other: 'that' 
        }
    ];

    it('should return the object that match the search', function () {
        var name1 = search(testArray, 'string 1');
        var name2 = search(testArray, 'string 2');

        assert.equal(name1, testArray[0]);
        assert.equal(name2, testArray[1]);

        var value1 = search(testArray, 'this', 'value');
        var value2 = search(testArray, 'new', 'value');

        assert.equal(value1, testArray[0]);
        assert.equal(value2, testArray[1]);
    });

    it('should return undefined becuase non of the objects in the array have that value', function () {
        var findNonExistingObj = search(testArray, 'string 3');

        assert.equal(findNonExistingObj, undefined);
    });

    it('should return undefined becuase our array of objects dont have ids', function () {
        var findById = search(testArray, 'string 1', 'id');

        assert.equal(findById, undefined);
    });
}); 
```

测试结果：

```
Search
    ✓ should return the object that match the search
    ✓ should return undefined becuase non of the objects in the array have that value
    ✓ should return undefined becuase our array of objects dont have ids

  3 passing (12ms) 
```

# 旧答案 - 由于不良做法而被删除

如果您想了解更多为什么这是不好的做法，请参阅这篇文章：

[为什么扩展本机对象是一种不好的做法？](https://stackoverflow.com/questions/14034180/why-is-extending-native-objects-a-bad-practice)

~~进行数组搜索的原型版本：~~

 ~~```
Array.prototype.search = function(key, prop){
    for (var i=0; i < this.length; i++) {
        if (this[i][prop] === key) {
            return this[i];
        }
    }
} 
```~~ 

用法：

```
var array = [
    { name:'string 1', value:'this', other: 'that' },
    { name:'string 2', value:'this', other: 'that' }
];

array.search('string 1', 'name'); 
```

 ~~* * *

## 回答 #12

> 赞同：7
> 
> 时间：2012-09-17T15:21:18.717

你可以用一个简单的循环来做到这一点：

```
var obj = null;    
for (var i = 0; i < array.length; i++) {
    if (array[i].name == "string 1") {
        obj = array[i];
        break;
    }
} 
```

* * *

## 回答 #13

> 赞同：4
> 
> 时间：2016-06-09T20:53:47.960

另一种方法（帮助@NullUserException 和@Wexoni 的评论）是在数组中检索对象的索引，然后从那里开始：

```
var index = array.map(function(obj){ return obj.name; }).indexOf('name-I-am-looking-for');
// Then we can access it to do whatever we want
array[index] = {name: 'newName', value: 'that', other: 'rocks'}; 
```

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2015-11-20T11:35:51.627

与以前的答案类似，我使用了以下内容：

```
 Array.prototype.getIemtByParam = function(paramPair) {
      var key = Object.keys(paramPair)[0];
      return this.find(function(item){return ((item[key] == paramPair[key]) ? true: false)});
    } 
```

用法：

```
myArray.getIemtByParam(
    {name: 'Sasha'}
); 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2014-06-17T12:05:35.833

这是搜索和替换的解决方案

```
function searchAndUpdate(name,replace){
    var obj = array.filter(function ( obj ) {
        return obj.name === name;
    })[0];
    obj.name = replace;
}

searchAndUpdate("string 2","New String 2"); 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-03-19T19:56:20.043

> 您是否在对象列表中的项目中寻找通用搜索（过滤器）而不指定项目键

**输入**

```
var productList = [{category: 'Sporting Goods', price: '$49.99', stocked: true, name: 'Football'}, {category: 'Sporting Goods', price: '$9.99', stocked: true, name: 'Baseball'}, {category: 'Sporting Goods', price: '$29.99', stocked: false, name: 'Basketball'}, {category: 'Electronics', price: '$99.99', stocked: true, name: 'iPod Touch'}, {category: 'Electronics', price: '$399.99', stocked: false, name: 'iPhone 5'}, {category: 'Electronics', price: '$199.99', stocked: true, name: 'Nexus 7'}]
function customFilter(objList, text){
if(undefined === text || text === '' ) return objList;
return objList.filter(product => {
    let flag;
    for(let prop in product){
        flag = false;
        flag = product[prop].toString().indexOf(text) > -1;
        if(flag)
        break;
    }
return flag;
});} 
```

**执行**

```
customFilter(productList, '$9'); 
```

[![在此处输入图像描述](../Images/8eeec99957640975e781a77f24850798.png)](https://i.stack.imgur.com/LNycm.png)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2016-05-27T18:16:09.930

如果您使用 jQuery，请尝试 $.grep()。

[http://api.jquery.com/jquery.grep/](http://api.jquery.com/jquery.grep/)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-08-05T09:41:06.193

您可以使用来自 npm[的查询对象。](https://github.com/Avocarrot/query-objects)您可以使用过滤器搜索对象数组。

```
const queryable = require('query-objects');

const users = [
    {
      firstName: 'George',
      lastName: 'Eracleous',
      age: 28
    },
    {
      firstName: 'Erica',
      lastName: 'Archer',
      age: 50
    },
    {
      firstName: 'Leo',
      lastName: 'Andrews',
      age: 20
    }
];

const filters = [
    {
      field: 'age',
      value: 30,
      operator: 'lt'
    },
    {
      field: 'firstName',
      value: 'Erica',
      operator: 'equals'
    }
];

// Filter all users that are less than 30 years old AND their first name is Erica
const res = queryable(users).and(filters);

// Filter all users that are less than 30 years old OR their first name is Erica
const res = queryable(users).or(filters); 
```

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2014-12-12T12:07:38.647

```
function getValue(){
    for(var i = 0 ; i< array.length; i++){
        var obj = array[i];
        var arr = array["types"];
        for(var j = 0; j<arr.length;j++ ){
            if(arr[j] == "value"){
                return obj;
            }
        }

    }
} 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2017-07-27T16:08:28.030

这个答案适用于 typescript / Angular 2、4、5+

我在上面的@rujmah 答案的帮助下得到了这个答案。他的回答带来了数组计数......然后找到该值并将其替换为另一个值......

这个答案所做的只是获取可能通过另一个模块/组件在另一个变量中设置的数组名称......在这种情况下，我构建的数组有一个 css 名称，即stay-dates。所以它所做的是提取该名称，然后允许我将其设置为另一个变量并像这样使用它。就我而言，它是一个 html css 类。

`let obj = this.highlightDays.find(x => x.css); let index = this.highlightDays.indexOf(obj); console.log('here we see what hightlightdays is ', obj.css); let dayCss = obj.css;`~~

# c# - Microsoft 不推荐的实体框架自我跟踪实体

> ID：12462319
> 
> 赞同：18
> 
> 时间：2012-09-17T15:19:55.327
> 
> 标签：c#, .net, entity-framework, self-tracking-entities

在查看 Microsoft 的网站时，我发现他们不再推荐使用 Self-Tracking Entities。

下面的每个链接都是提到不使用 STE 的 MS 资源：

*   显示实体框架团队可用的模板： [EF 设计器代码生成模板](http://msdn.microsoft.com/en-US/data/JJ613116)

*   [自我追踪实体](http://msdn.microsoft.com/en-us/data/jj613924)

*   [N 层应用的推荐技术](http://msdn.microsoft.com/en-us/data/jj613668)

有谁知道为什么微软不再推荐使用 STE？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-17T16:32:31.443

（注意：由于我不为 MS 工作，这都是基于他们的公开声明和过去历史的*推测）。*

您发布的第一篇文章“有点”解释了原因，尽管不是很清楚：他们希望您使用更好的替代方案，并且无意修复或改进 STE。微软正在将 STE 放入“早期失败的实验”中，类似于 RDO、Remoting 或 LINQ2SQL——他们拿出一些东西来看看它工作得如何，但实际上并没有。

总的来说，微软总是承认 STE 是解决实际业务问题的第一步，但它们显然是不完整的。特别是，它们在将对象图附加到共享实体方面***非常糟糕***，它们不支持延迟加载，并且还有许多其他杂项限制。

MS 显然已经决定他们不会尝试清理它们（请注意，出于类似的原因，他们也弃用了 POCO 模板）。由于他们不打算修复或改进模板，他们希望人们停止将其用于新项目并转向更好的替代方案：

[MSDN 数据库](http://msdn.microsoft.com/en-US/data/JJ613116/)

> **数据库上下文生成器**
> 
> 此模板将生成简单的 POCO 实体类和派生自 DbContext 的上下文。这是推荐的模板，除非您有理由使用下面列出的其他模板之一。

STE 的存在主要是为了支持实体断开连接并重新连接到其上下文的情况，尤其是在序列化场景（例如 WCF 或 Web 服务）中。在“标准”实体框架对象中，所有更改跟踪都是在上下文中完成的，将现有实体附加到上下文是有问题的。STE 使该过程变得更容易，但代价是使几乎所有其他事情变得非常困难。

从我所见和经验来看，`DbContext`它应该是解决这个问题的更好选择，尽管它实际上并没有*复制*STE 所做的事情。EF 的重度用户之间的普遍共识似乎是，端到端序列化您的 EF 实体是一个非常糟糕的主意。相反，您应该使用 DTO 和[AutoMapper](http://automapper.org/)之类的东西在 DTO 和 EF 对象之间进行映射。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-18T13:30:23.233

我创作了 Trackable Entities 作为 STE 的替代品：[https](https://trackable.codeplex.com) ://trackable.codeplex.com 。它部署为一组 NuGet 包和 Visual Studio 扩展。有一组项目模板，包括用于 ASP.NET Web API 脚手架的 T4 模板，以及用于生成 WCF 服务的项模板。

这是我写的一篇博文，比较了 TE 和 STE：[http](http://blog.tonysneed.com/2013/11/18/trackable-entities-versus-self-tracking-entities) ://blog.tonysneed.com/2013/11/18/trackable-entities-versus-self-tracking-entities 。

干杯，托尼·斯尼德

# msmq - 为什么这个简单的 MSMQ 事务升级为 DTC？

> ID：12462321
> 
> 赞同：3
> 
> 时间：2012-09-17T15:20:00.920
> 
> 标签：msmq, message-queue, transactionscope

我已经减少了以下示例代码所面临的问题：

```
var inQueue = ".\private$\testqueue";
using (var ts = new TransactionScope())
{
    using (var q = new MessageQueue(inQueue, QueueAccessMode.Send))
    {
        for (var i = 0; i < 100000; ++i)
        {
            var msg = new Message(i);
            q.Send(msg, MessageQueueTransactionType.Automatic);
        }
    }
    ts.Complete();
} 
```

如您所见，它使用 TransactionScope 模式将 100,000 个整数写入（事务性、本地）队列。我的理解是这种类型的操作不会升级为 DTC 交易。

但是，如果我在运行时打开组件服务，我可以在本地 DTC > 事务列表中看到该事务。这意味着交易已经升级，对吧？

为什么会发生这种情况？我被另一个程序中的糟糕性能提示了这一点，并且似乎将 DTC 用于这样一个简单的事务可能是一个因素。无论如何，我只是想了解原因。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-18T12:37:56.410

来自[http://geekswithblogs.net/dotnetrodent/archive/2008/04/16/121279.aspx](http://geekswithblogs.net/dotnetrodent/archive/2008/04/16/121279.aspx)

> 如果您只需要做与消息队列相关的事务工作，而没有任何其他需要在事务上下文中的资源（如数据库），请不要使用 TransactionScope，而应使用[MessageQueueTransaction 类](http://msdn.microsoft.com/en-us/library/system.messaging.messagequeuetransaction.aspx)。与使用由 DTC 控制的完整分布式事务相比，使用此类控制仅与消息队列相关的事务的性能损失较小。

# asp.net-mvc - 在 asp.net mvc 中跨域打开 kmz 文件

> ID：12462327
> 
> 赞同：0
> 
> 时间：2012-09-17T15:20:15.007
> 
> 标签：asp.net-mvc, google-earth, kmz

我在通过 google earth api 打开 kmz 文件时遇到问题。当我提供到服务器上文件的静态链接时，它工作正常：

```
google.earth.fetchKml(ge, 'http://10.122.150.183:8008/test.kmz', checkForCoordinates); 
```

但是，当我将链接更改为另一个域（即 WCF 服务）上的文件时：`'https://10.122.150.183:4431/Uploads/1/test.kmz'`，文件不会在谷歌地球中打开。我尝试了另一种解决方案：从 ASP.Net MVC 控制器动态提供 kmz 文件，返回：

```
return File(fileStream, "application/vnd.google-earth.kmz kmz", fileName); 
```

如果我尝试从浏览器的地址栏中获取它，它工作正常，但是当我在`fetchKml`方法中提供指向操作的链接时，该操作甚至不会调用。

关于如何从另一个域打开 kmz 文件的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T00:20:54.867

我认为您通过分配 MIME 类型走在正确的轨道上。已查看此页面上的信息 [https://developers.google.com/kml/documentation/kml_tut#kml_server](https://developers.google.com/kml/documentation/kml_tut#kml_server)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T06:19:42.703

我已经在 wcf 中实现了 Kmz 文件生成器。该服务返回流类型对象，传出响应内容类型设置为“application/vnd.google-earth.kmz”。

代码看起来像这样

```
public class Kmz
{
    public static Stream Generate(string stringKml, string fileName)
    {
        MemoryStream stream = new MemoryStream();
        using (ZipFile zip = new ZipFile())
        {
            zip.AddEntry(fileName, stringKml);
            zip.Save(stream);
        }

        WebOperationContext.Current.OutgoingResponse.ContentType = "application/vnd.google-earth.kmz";

        stream.Position = 0;
        return stream;
    }
} 
```

希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-17T04:05:42.423

您还可以使用javascript的iframe或脚本方式加载kml内容，这两种方式允许您从不同的域加载资源，然后使用parseKml函数解析kml内容并将其添加到您的地球中。

希望它有所帮助。

# .net - 如何在 Windows 8 中自动运行需要管理员权限的应用程序

> ID：12462328
> 
> 赞同：3
> 
> 时间：2012-09-17T15:20:20.943
> 
> 标签：.net, vb.net, windows-8, autorun, elevated-privileges

我有一个应用程序需要在具有提升权限的 Windows 8 上自动运行。我已经嵌入了包含 requestExecutionLevel 的 requireAdministrator 属性的清单，当通过鼠标单击运行时它可以正常工作，但是我需要应用程序自动运行。

这在 vista 和 windows 7 上运行良好，但在 windows 8 上运行良好......它根本无法运行。如何让它执行并提示用户许可？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T08:04:20.773

我没有任何可用于测试的 Windows 8 安装，但在 Click Once 部署（不允许使用清单）中需要管理员权限时遇到了类似的问题。

通过让应用程序在启动时检查它是否以管理员身份运行来解决它，如果它不是以管理员身份运行，它会以管理员身份重新启动。

这是我使用的代码（稍作修改）：

```
public static bool IsRunningAsAdministrator()
{
    var wi = WindowsIdentity.GetCurrent();
    var wp = new WindowsPrincipal(wi);

    return wp.IsInRole(WindowsBuiltInRole.Administrator);
}

public static void StartAsAdmin(StartupEventArgs e)
{
    if (IsRunningAsAdministrator())
        return;

    // It is not possible to launch a ClickOnce app as administrator directly, so instead we launch the app as administrator in a new process.
    var processInfo = new ProcessStartInfo(Assembly.GetEntryAssembly().CodeBase);

    // The following properties run the new process as administrator
    processInfo.UseShellExecute = true;
    processInfo.Verb = "runas";

    // Start the new process
    Process.Start(processInfo);

    // Shut down the current process
    Application.Current.Shutdown();
} 
```

**在多台机器上测试后更新：**我在使用此解决方案时遇到的一个问题是防病毒软件经常将此视为可疑行为并阻止启动。

我最终将安装程序 + 自动更新从 Click Once 更改为[WiX Toolset](http://wix.sourceforge.net/) + [NAppUpdate](https://github.com/synhershko/nappupdate)并`requestedExecutionLevel="requireAdministrator"`改为运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T08:16:00.467

> 我需要应用程序自动运行。

我不确定您所说的“自动运行”是什么意思，但我假设您希望您的应用程序在用户登录、特定时间或满足其他触发条件时运行。您可以使用任务计划程序来实现这一点。如果用户具有管理权限，您可以请求任务计划程序以“最高”权限运行应用程序。为此，您必须在任务的属性中选中“以最高权限运行”：

![任务属性](../Images/e00f5ecac5ac4863f2affb06e63354d6.png)

请注意，当任务计划程序执行该任务时，即使它以管理权限执行，也不会向用户显示 UAC 提示。

# c++ - 使用特征强制类型定义

> ID：12462335
> 
> 赞同：1
> 
> 时间：2012-09-17T15:20:45.420
> 
> 标签：c++, traits

我编写了这些代表图形的类：

```
class Node{

  public:
    typedef std::vector<Node>::iterator iterator;
    iterator begin() {return neigh.begin();}
    iterator end() {return neigh.end();}

  public:
    Node(std::string n) : name(n) {}

    std::string getName() {return name; }

    void addNeigh(Node n){
      neigh.push_back(n);
    } 

  private:
    std::string name;
    std::vector<Node> neigh;
};

class Map{

  public:
    typedef std::vector<Node>::iterator iterator;
    iterator begin() {return nodes.begin();}
    iterator end() {return nodes.end();}

  public:
    Map(std::string n) : map_name(n) {}

    void addNode(Node n){
      nodes.push_back(n);
    }

    std::string getName() { return map_name; }
    int getNumNodes() {return nodes.size();}

  private:
    std::string map_name;
    std::vector<Node> nodes;

}; 
```

然后我想编写一个`printGraph`使用特征打印一些图形信息的函数：

```
template<typename T>
struct GraphTraits{

};

template<>
struct GraphTraits<Map>{

  typedef Map::iterator node_iterator;

  static node_iterator node_begin(Map map){ return map.begin();}
  static node_iterator node_end(Map map) { return map.end();}

  static std::string getName(Map m) {return m.getName();}

};

template<typename T>
void printGraph(T t){
  std::cout << std::endl 
            << "--------------------------------------" << std::endl  
            << "|             printGraph             |" << std::endl  
            << "--------------------------------------" << std::endl;
  std::cout << "Graph name: " << GraphTraits<T>::getName(t) << std::endl;

  for(GraphTraits<T>::node_iterator it = GraphTraits<T>::node_begin(t), e = GraphTraits<T>::node_end(t);
        it != e; ++it) {
          std::cout<< (*it).getName() << std::endl; }
} 
```

如果我尝试编译此代码，我会收到以下错误：

```
grafo.cpp:75:37: error: expected ';' in 'for' statement specifier
  for(GraphTraits<T>::node_iterator it = GraphTraits<T>::node_begin(t), e = GraphTraits<T>::node_end(t);
                                    ^
grafo.cpp:75:37: error: use of undeclared identifier 'it'
grafo.cpp:75:73: error: use of undeclared identifier 'e'
  for(GraphTraits<T>::node_iterator it = GraphTraits<T>::node_begin(t), e = GraphTraits<T>::node_end(t);
                                                                        ^
grafo.cpp:76:9: error: use of undeclared identifier 'it'
        it != e; ++it) {
        ^
grafo.cpp:76:15: error: use of undeclared identifier 'e'
        it != e; ++it) {
              ^
grafo.cpp:76:16: error: expected ')'
        it != e; ++it) {
               ^
grafo.cpp:75:6: note: to match this '('
  for(GraphTraits<T>::node_iterator it = GraphTraits<T>::node_begin(t), e = GraphTraits<T>::node_end(t);
     ^
grafo.cpp:76:20: error: use of undeclared identifier 'it'
        it != e; ++it) {
                   ^
grafo.cpp:75:23: error: unexpected type name 'node_iterator': expected expression
  for(GraphTraits<T>::node_iterator it = GraphTraits<T>::node_begin(t), e = GraphTraits<T>::node_end(t);
                      ^
grafo.cpp:104:3: note: in instantiation of function template specialization 'printGraph<Map>' requested here
  printGraph(mappa);
  ^ 
```

我可以解决并成功编译替换：

```
for(GraphTraits<T>::node_iterator.... 
```

和：

```
for(GraphTraits<Map>::node_iterator.... 
```

但这使得`printGraph`它失去了普遍性。

有人可以给我一些提示来解决问题吗？

一般来说，是否可以使用 Traits 来强制定义数据类型？我是说：

```
template<typename T>
struct ATraits{
 -> type "iterator" must be defined
}; 
```

这样每个专业都必须定义：

```
typedef ..something.. iterator; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:26:54.610

您忘记使用`typename`关键字。

在`GraphTraits<Map>::node_iterator`中，编译器知道`GraphTraits`使用的是什么特化，并且可以找出这`node_iterator`是一个 typedef。

在`GraphTraits<T>::node_iterator`中，它不知道将使用什么专业化，因为`T`还不知道。所以它假设它`node_iterator`是一个成员变量，而不是一个类型。你必须纠正这个假设。说`typename GraphTraits<T>::node_iterator`

要要求每个专业化都`GraphTraits`提供 typedef，您需要“概念”，这是为 C++11 提出的，但必须推迟到未来的版本。所以今天在 C++ 中是不可能的。但是，无论何时您实际使用`printGraph`（正式地，在函数模板的每个模板函数实例的实例化期间`printGraph<T>`），编译器都会仔细检查它是否`GraphTraits<T>::node_iterator`真的是一个类型（因为现在它知道`T`并且可以执行重载决议）。

# php - 在本地站点为 root 的服务器上引用子文件夹

> ID：12462339
> 
> 赞同：0
> 
> 时间：2012-09-17T15:20:58.480
> 
> 标签：php

这可能是一项简单的任务，但我在本地用 php 构建站点，然后将它们上传到子文件夹以供客户批准。这一切都很好，但是当我构建站点时，我使用对根的引用，例如：

```
<link rel="stylesheet" type="text/css" href="/stylesheets/css/custom.css"> 
```

当这被发布到网站上时，它显然是一个低水平。什么是最好的方式（主要是为了我的生活方便）只需上传文件而不必记住更改路径。

我确实用过

`<? $root = "subfolder/"; ?> <link rel="stylesheet" type="text/css" href="<?php echo $root;?>/stylesheets/css/custom.css">`

但它似乎有点笨拙......希望这是有道理的......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:24:19.370

您可以获得对您正在使用的文件的引用`__FILE__`... 或使用`__DIR__`. 这些可以帮助您设置一个常量或类似的指向您的“根”，然后您可以在整个代码中使用与此相关的引用。

参考[PHP 魔术常量](http://php.net/manual/en/language.constants.predefined.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:31:03.593

一个非常简单的解决方案，你可能没有想到：

只需将其更改`/stylesheets/css/custom.css`为`stylesheets/css/custom.css`（删除第一个斜杠），然后如果您将其上传到子文件夹，它就不会搞砸了..

发生这种情况的原因是，当您输入`/`路径的第一个时，它会自动转到根目录。因此，如果您的网站位于根目录上，那么您可能没有问题，但如果它位于子文件夹中，那么它会搞砸......

# character-encoding - \377\376 附加到文件（Windows -> Unix）

> ID：12462340
> 
> 赞同：3
> 
> 时间：2012-09-17T15:21:00.223
> 
> 标签：character-encoding, ssis, solaris, dos2unix

我有一个执行以下操作的 SSIS 包。

1.  运行 SQL 脚本
2.  将结果导出到平面文件（UTF-8 编码，; 分隔，和 \n 用于新行）
3.  FTP结果到solaris机器（二进制格式）

问题是，当文件显示在我的 solaris 盒子上时，文件开头有以下内容。

> \377\376

我已经尝试过dos2unix，但仍然没有纠正这个问题。事实上，它将\377\376 更改为\227\226，不是很有帮助。

我的问题，有什么方法可以从我的文件中删除这些字符？当他们在那里时，他们会使用 grep 和其他 unix 工具，如 head。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-20T13:28:30.867

默认情况下，任何 SSIS 或 windows 编码文件都是 UCS-2-LITTLE-ENDIAN 编码的。最简单的方法是使用以下命令在您的 unix 服务器上对文件进行编码。

1.  使用 iconv 切换到 UTF-8（或您需要的任何编码）

    iconv -f UCS-2-LITTLE-EDIAN -t UTF-8 输入 > 输出

2.  删除 ms 添加到留置权末尾的回车。

    unix2dos -ascii utf-8-file 输出文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T09:15:10.447

Dos2unix 6.0 及更高版本可以将 Windows Unicode UTF-16 文件转换为 Unix UTF-8。它还将删除字节顺序标记 (BOM)。在此处获取[最新的 dos2unix](http://waterlan.home.xs4all.nl/dos2unix.html)

有可用的 Windows 版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-08T16:21:23.840

正如预览答案所述，使用[dos2unix](https://waterlan.home.xs4all.nl/dos2unix.html#DOS2UNIX)完成了这项工作，就我而言，我使用了：

```
dos2unix.exe -r -v -f -D utf8 <FileName> 
```

其中：

> -r, --remove-bom 删除字节顺序标记（默认）
> 
> -v, --verbose 详细操作
> 
> -f, --force 强制转换二进制文件
> 
> -D, --display-enc 设置显示文本信息编码 ansi, unicode, utf8, 默认为ansi

并且删除了[BOM](https://en.wikipedia.org/wiki/Byte_order_mark)字符

# python - 使用 Q 对象过滤多个 ForeignKey 匹配

> ID：12462341
> 
> 赞同：2
> 
> 时间：2012-09-17T15:21:00.117
> 
> 标签：python, django, django-orm, django-1.3, django-q

我在一个名为`main`Django 1.3 的应用程序中使用以下数据初始化了这些模型：

```
from django.db.models import Model, FloatField, CharField, ForeignKey, Q

class Customer(Model):
    name = CharField(max_length=64)

class Order(Model):
    customer = ForeignKey(Customer)
    order_total = FloatField() 
```

```
c = Customer(name="John Smith")
c.save()

Order(customer=c, order_id=9).save()
Order(customer=c, order_id=13).save() 
```

如何使用`Q()`对象构造查询以查找拥有订单 9 和订单 13 的客户？

在不使用`Q()`对象的情况下，我可以使用该`.filter()`方法两次来获得我想要的结果。如您所见，它使用两个`JOIN`s 来查找两个外键：

```
queryset = Customer.objects.filter(order__order_id=9).filter(order__order_id=13)

return HttpResponse("%s\n\n%s" % (queryset, queryset.query), content_type="text/plain") 
```

```
[<Customer: Customer object>]

SELECT "main_customer"."id", "main_customer"."name"
FROM "main_customer"
INNER JOIN "main_order" ON ("main_customer"."id" = "main_order"."customer_id")
INNER JOIN "main_order" T3 ON ("main_customer"."id" = T3."customer_id")
WHERE ("main_order"."order_id" = 9  AND T3."order_id" = 13 ) 
```

我尝试使用`Q()`以下对象做同样的事情。它没有理解我指的是两个不同的订单，一个 ID 为 9，一个 ID 为 13，而是认为我正在寻找一个 ID 为 9 和 13 的订单。这显然是不可能的，因此它不返回任何结果：

```
q = Q(order__order_id=9) & Q(order__order_id=13)
queryset = Customer.objects.filter(q)

return HttpResponse("%s\n\n%s" % (queryset, queryset.query), content_type="text/plain") 
```

```
[]

SELECT "main_customer"."id", "main_customer"."name"
FROM "main_customer"
INNER JOIN "main_order" ON ("main_customer"."id" = "main_order"."customer_id")
WHERE ("main_order"."order_id" = 9  AND "main_order"."order_id" = 13 ) 
```

我希望 Django 的引擎能够等效地解释这两个查询，但显然`Q()`对象的处理方式不同。如何使用对象通过多个外键引用过滤对象，而不是多次`Q()`调用？`.filter()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-09-20T13:19:18.150

我想我找到了解决这种情况的方法：

使用`filter( ~(~Q(A) | ~Q(B)) )`而不是`filter(Q(A) & Q(B))`似乎产生了预期的结果。

这是基于这样一个事实，`A and B`即等效于`not ( not(A) or not(B) )`并启用对多个`ForeignKey`仅使用`Q`对象的过滤（最终传递给单个对象`filter`）。它相当丑陋，但最终仍然只使用一个数据库查询。

如上所述，最初的问题来自`.filter(A).filter(B)`and的不同行为`filter(A & B)`（参见[文档](https://docs.djangoproject.com/en/dev/topics/db/queries/#spanning-multi-valued-relationships)中的示例），并且`filter(Q(A) & Q(B))`仅复制了其中一种用途。

在我的案例中生成的 SQL 查询过于复杂，无法确保此解决方法完美运行，但我想我会分享这个想法，因为我的测试证明它有效。如果您确定证明/打破它，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-18T17:33:17.793

我[在 Django 文档中找到了对此的解释](https://docs.djangoproject.com/en/2.0/topics/db/queries/#spanning-multi-valued-relationships)。我观察到的行为是预期的行为；如果将多值关系的查询词应用于同一调用`.filter()`/`.exclude()`与应用于不同调用时，它们的处理方式将有所不同。

如果我在同一个`.filter()`调用中应用这两个查询词......

```
queryset = Customer.objects.filter(Q(order__order_id=9) & Q(order__order_id=13))
# or equivalently: .objects.filter(Q(order__order_id=9), Q(order__order_id=13)) 
```

...然后它只返回`Customer`s 拥有满足两个约束的任何订单，`order_id=9 AND order_id=13`。`Order`这些术语在任何给定时间都必须指代相同的术语。

另一方面，如果我使用两个不同的`.filter()`调用来应用查询术语......

```
queryset = Customer.objects.filter(order__order_id=9).filter(order__order_id=13) 
```

...他们不需要引用相同的`Order`. 这可以看作是一个两步操作：所有`Customer`s 的集合被过滤到拥有任何`Order`满足 s 的那些`order_id=9`。然后将该结果集进一步过滤到那些`Customer`也拥有任何`Order`满意的 s `order_id=13`。在这两种情况下可能是相同`Order`的。没关系; 这些步骤彼此隔离。

*可能*有一些方法可以`Q()`通过一次调用从对象中获取此行为`.filter()`，但看起来这不是 Django 的 ORM 的使用方式。

# xml - 优化 XSLT 转换的最佳方法是什么？

> ID：12462343
> 
> 赞同：0
> 
> 时间：2012-09-17T15:21:03.563
> 
> 标签：xml, saxon, xslt

我正在使用下面给出的代码进行 XSLT 转换。我使用输入和输出流进行此转换。这里 xsltIn 和 xmlIn 是输入流。我用

```
System.setProperty("javax.xml.transform.TransformerFactory","net.sf.saxon.TransformerFactoryImpl"); 
```

将撒克逊人设置为绑定。所以我的问题是优化处理的最佳方法是什么。我听说过一种叫做 Streaming Templates 的东西。

```
javax.xml.transform.Result xmlResult = new javax.xml.transform.stax.StAXResult(XMLOutputFactory
    .newInstance().createXMLStreamWriter(new FileWriter(fileName)));javax.xml.transform.Source xsltSource = new javax.xml.transform.stream.StreamSource(xsltIn);
javax.xml.transform.Source source = new javax.xml.transform.stream.StreamSource(xmlIn);

javax.xml.transform.TransformerFactory transFact = javax.xml.transform.TransformerFactory
    .newInstance();
javax.xml.transform.Transformer trans = transFact.newTransformer(xsltSource);
trans.transform(source, xmlResult); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T17:49:44.090

专注于测量。衡量性能，评估影响性能的因素（例如源文档大小），一旦你了解了你得到的性能，你就可以开始考虑如何改进它。有多少端到端性能花费在源文档解析、样式表编译、转换、序列化上？如果您不知道，那么您需要找出答案。

了解你的目标。您需要什么性能，目前距离它还有多远？您准备投入多少精力/时间/金钱来实现所需的性能？

您可以做很多事情来提高性能。例如，您可以放入 Saxon-EE 以利用其改进的优化器和字节码生成。或者你可以购买更快的硬件。或者您从 XSLT 专家那里购买咨询服务。从问题的表述方式来看，这些事情是否会给你带来良好的投资回报是不可能的。

# mysql - MySQL 5.0 显示创建触发器

> ID：12462349
> 
> 赞同：0
> 
> 时间：2012-09-17T15:21:23.757
> 
> 标签：mysql, triggers

show create trigger 语句仅在 MySQL 5.1 中引入有谁知道我如何在 MySQL 5.0 中获取触发器的原始 SQL（创建）

我命令 show triggers 有效，但它不包含 create 语句。

干杯，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:30:02.253

从 中读取信息`Information_schema`。`triggers`table：触发器的主体和其他选项；然后自己构建 CREATE TABLE 或编写一个可以自动完成的程序。

此外，您可以使用[dbForge Studio for MySQL](http://www.devart.com/dbforge/mysql/studio/)（免费快速版）中的对象可视化编辑器来查看和编辑触发器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:51:29.297

mysqldump 将以正确的格式输出触发器。

# image - 光标指向电子邮件通讯中图像上的指针

> ID：12462352
> 
> 赞同：1
> 
> 时间：2012-09-17T15:21:33.273
> 
> 标签：image, email, newsletter, mouse-cursor

当我制作包含链接图像的时事通讯时，css 样式 cursor:pointer; 不适用于图像。任何想法如何解决这个问题？我认为当人们看到“手形光标”时，他们更有可能点击它。

```
<tbody>
<table width="100%">
    <tr align="center">
        <td colspan="2"><a id="poster" style="cursor:pointer;cursor:hand;" href="http://www.example.com/"><img width="600" border="0" src="http://www.example.com/newsletter/images/0917-newsletter.jpg"></a></td>
    </tr>   
</table>
</tbody> 
```

只是为了更加清楚。光标在浏览器中有效，但在电子邮件中复制和粘贴后，收到的时事通讯不显示光标。

先感谢您！

# wpf - 如何检查滚动条的可见性？

> ID：12462356
> 
> 赞同：0
> 
> 时间：2012-09-17T15:21:51.057
> 
> 标签：wpf, xaml, c#-4.0, .net-4.0, datagrid

DataGrid 中是否有一个属性表示当前滚动条是否可见。我想使用该属性来控制其他 System.Windows.Control 的可见性。

我经历了一个类似的[问题](https://stackoverflow.com/questions/3987028/how-to-check-if-a-scroll-is-currently-visible-in-wpf-datagrid)，但解决方案必须处理代码隐藏。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:30:14.547

DataGrid 中是否有一个属性表示当前滚动条是否可见。**不，那里没有。**

我想使用该属性来控制其他 System.Windows.Control 的可见性。 **子类化 DataGid 并添加您的属性。**

# css - 为什么lessc 将文件编码为UCS-2 Little Endian？

> ID：12462363
> 
> 赞同：4
> 
> 时间：2012-09-17T15:22:08.353
> 
> 标签：css, less, filesize, endianness, ucs2

在带有 Node 的 Windows 平台上运行以下命令

`lessc style.less > style.css -x --yui-compress`

以“UCS-2 Little Endian”格式输出 style.css。通常我不会在意，但我注意到我编译的样式表有很大的文件大小（经过检查，正好是两倍）。出于某种原因，在 Windows 资源管理器中查看时，这种编码会使文件大小加倍。

将文件转换为 UTF8 可将文件大小减半。跳过 -x 和 --yui-compress 不会影响这一点。

有任何想法吗？我很在意，因为我不想在构建过程中使用某种编码转换器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:43:14.210

尝试避免使用 > 并仅指定 in 和 out 的 2 个参数。使用管道 (>) 时，我认为是环境决定了文本格式。

例如

```
lessc -x --yui-compress style.less style.css 
```

# c# - 试图将 foreach 转换为 linq 等价物

> ID：12462366
> 
> 赞同：1
> 
> 时间：2012-09-17T15:22:10.477
> 
> 标签：c#, linq

> **可能重复：**
> [是否可以在不使用 foreach 的情况下重新创建此语句？](https://stackoverflow.com/questions/12461058/is-it-possible-to-recreate-this-statement-without-using-a-foreach)

我有 2 个类共享一个基类

```
DealBookmarkWrapper : BookmarkWrapper
StoreBookmarkWrapper : BookmarkWrapper 
```

我也有以下说法：

```
// 1 - This works
List<BookmarkWrapper> bm = new List<BookmarkWrapper>();
foreach(var d in deals)
{
    bm.Add(new DealBookmarkWrapper(d));
}

// 2 - This does not work
List<BookmarkWrapper> bm2 = deals.Select(d => new DealBookmarkWrapper(d)).ToList(); 
```

1) 像它一样工作，但 2 需要演员才能工作。我不确定我是否做错了什么，或者在第二种情况下是否真的需要演员表。

有人对此有所了解吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T15:28:05.980

您的问题有两个方面：

*   的类型参数`T`由`ToList<T>`编译器推断为`DealBookmarkWrapper`，因此`List<DealBookmarkWrapper`产生了 >。
*   由于`List<T>`不是协变类型，因此无法从`List<DealBookmarkWrapper`> 到进行保留表示的转换`List<BookmarkWrapper>`。有关为什么会这样的更多信息，请参阅[此问题](https://stackoverflow.com/q/2033912/412770)。

您已经发现在`Select`投影中添加演员表是一种解决方法。另一种方法是，在 C# 4 + .NET 4.0（或更高版本）中，显式指定类型参数并依赖于`IEnumerable<T>`：

```
deals.Select(d => new DealBookmarkWrapper(d))
     .ToList<BookmarkWrapper>() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T15:27:47.150

```
List<BookmarkWrapper> bm2 = deals.Select(d => new DealBookmarkWrapper(d)).Cast<BookmarkWrapper>().ToList(); 
```

或者

```
List<BookmarkWrapper> bm2 = deals.Select(d => (BookmarkWrapper)(new DealBookmarkWrapper(d))).ToList(); 
```

您拥有的代码创建一个`List<DealBookmarkWrapper>`，它不能转换为`List<BookmarkWrapper>`. 列表的类型由 C# 的类型推断算法确定。

上面的两个选项都创建`DealBookmarkWrapper`对象，但将引用转换为`BookmarkWrapper`，因此类型推断将类型解析为`List<BookmarkWrapper>`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:31:13.873

你没有做错任何事。`List<T>`不是[协变](https://stackoverflow.com/questions/5832094/covariance-and-ilist)的，因此您需要显式转换对象。更多信息[在这里](http://msdn.microsoft.com/en-us/library/dd799517%28v=vs.100%29.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T15:26:12.190

第二种情况需要强制转换，因为您的 LINQ 表达式投影到派生对象列表 ( `List<DealBookmarkWrapper>`)。但是，您想要的是创建一个基础对象列表 ( `List<BookmarkWrapper>`)。由于您希望编译器“丢失”某些类型信息，因此您需要明确说明它。

最好的解决方案是在调用`Cast<BookmarkWrapper>`之前插入 a `.ToList`，使其明确并保持语法可读：

```
var bm2 = deals.Select(d => new DealBookmarkWrapper(d))
               .Cast<BookmarkWrapper>()
               .ToList(); 
```

# xml - 将 xml 产品列表导入 Magento

> ID：12462368
> 
> 赞同：0
> 
> 时间：2012-09-17T15:22:24.157
> 
> 标签：xml, magento, import

只是一个快速的问题，什么是或在哪里可以找到 magento 产品目录的产品属性名称？

例如，描述也是表中的字段名称吗？表格中价格字段的“价格”名称是什么？SKU还？我很抱歉，但我不知道在哪个表中搜索...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:37:48.863

Sku 位于 catalog_product_entity。其他字段在 catalog_product_entity_xyz 中。例如，描述在catalog_product_entity_text 中，价格可能在_decimal 中。您必须在 eav_attribute 中查找属性 ID。您需要的大多数属性都应该在您商店的平面表中。

应该注意的是，您永远不需要按名称引用表。

# scala - Scala：覆盖类型方法

> ID：12462369
> 
> 赞同：2
> 
> 时间：2012-09-17T15:22:28.697
> 
> 标签：scala

我有一个`object`包含定义的Scala `type`。我现在愿意通过重写它的`equals`方法来改变类型的行为。有可能吗？

我现在拥有的代码如下：

```
object CallGraph {
type CallTree = LinkedTree[Enter]
} 
```

我想覆盖该类型的`equal`方法`CallTree`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:29:05.703

您在这里拥有的不是类型定义，而是类型声明。类似的东西`type SomeName = SomeType`只是一个别名。除了像这里所做的那样给出一个别名之外，类型声明还可以包含一个类型参数，也可以用来声明一个类型的上限和下限。为了更改覆盖方法，您确实需要使用 Luigi Plinge 已经指出的类来定义新类型。

# c# - 在 Windows Phone 异步服务中捕获服务器端异常

> ID：12462370
> 
> 赞同：2
> 
> 时间：2012-09-17T15:22:30.713
> 
> 标签：c#, wcf, web-services, windows-phone-7.1

如果复制粘贴有任何错误，此代码工作很抱歉

```
public class SyncTicketsDown
{
    SR.WsTicketSyncSoapClient client = Tools.ServiceManager.GetConnection();

    public void ResolveTicket(int TicketID)
    {
        client.ResolveTicketAsync(TicketID)
    }

    void client_ResolveCompleted(object sender, SR.ResolveTicketCompletedEventArgs e)
    {
         if (e.Result > 0)
         {
             Tools.IOSettings.DeleteTicket(e.Result);
         }
    }  
} 
```

如果 Ticket ID 不是服务器端的有效 id，服务器会抛出异常，我该如何捕捉这个异常？我们正在谈论我在这个应用程序上运行大约 40 种不同的服务，并且由 Visual Studio 创建的服务引用有 5000 行（Reference.cs），当抛出异常时，调试器将在对此类服务的引用上爆炸不在我的课上。

当您尝试到达一个很远的地方时，我也遇到了与 bing 路由服务相同的问题。

必须有一个标准的方法来捕捉这些异常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:08:27.973

我实际上发现，即使调试器在 Reference.cs 上爆炸，它也会将错误缩放到 Complete 事件，我可以在那里管理错误，这有点令人困惑，因为调试器在 reference.cs 上停止

所有服务器端错误都将反映在完整事件中

这不是同一个问题，但答案相似

[Windows phone 7，silverlight - 调用异步 Web 服务时如何捕获 EndpointNotFoundException？](https://stackoverflow.com/questions/4285586/windows-phone-7-silverlight-how-to-catch-endpointnotfoundexception-when-calli)

# ssis - 由于 BIDS 2008 只有 32 位，我们如何开发 64 位？

> ID：12462372
> 
> 赞同：0
> 
> 时间：2012-09-17T15:22:41.130
> 
> 标签：ssis, 64-bit, driver, bids, dsn

我正在努力让我的包在 SSIS 2008 64 位上运行。我的 pacakges 使用了 DSN，所以我制作了 64 位 DSN.. 但由于 BIDS 只有 32 位，我遇到了如下错误。

![在此处输入图像描述](../Images/1acea80db04a080bc4f489252d7a56d6.png)

我认为 .Net Provider\Odbc Data Provider 是 32 位的（因为它是 BIDS 32 位的一部分），但我的 DSN 是 64 位，所以错误。有什么办法可以解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:35:00.023

由于 BIDS 是 32 位应用程序，您需要使用 Windows\SysWOW64 文件夹中的 odbc 管理员应用程序创建一个 32 位 DSN。

我喜欢这篇文章...

[http://timlaqua.com/2011/11/ssis-bids-and-64bit-system-dsns-whos-on-first/](http://timlaqua.com/2011/11/ssis-bids-and-64bit-system-dsns-whos-on-first/)

# android - 如何在Android中从相机保存为jpeg之前检查图像的物理尺寸？

> ID：12462373
> 
> 赞同：0
> 
> 时间：2012-09-17T15:22:43.143
> 
> 标签：android

我使用以下代码保存捕获的图像：

```
Bitmap bm = BitmapFactory.decodeByteArray(data, 0, data.length);
FileOutputStream fos = new FileOutputStream(pictureFile);
bm.compress(Bitmap.CompressFormat.JPEG, 100, fos); 
```

由于我将有进一步的实现，我想检查位图保存在 SD 卡中时的物理大小。
如果大小超过 1mb，我想在将其保存为 jpeg 之前对其进行缩放。
怎么做？
请举例。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:39:50.360

`bm.compress`在写入之前不知道元素的大小。您可以做的是将其写入字节输出流，然后检查大小并采取相应措施

# eclipse - 如何更改 EGit 中的默认拉取策略

> ID：12462374
> 
> 赞同：5
> 
> 时间：2012-09-17T15:22:46.310
> 
> 标签：eclipse, git, egit

如何在 Eclipse 中更改 git pull 策略（rebase / merge / none）？

看来我只能在签出新分支时进行设置，但之后无法更改。

这看起来很奇怪，还是不允许更改现有分支上的拉取策略？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T15:36:42.330

1.  打开 Git 存储库视图
2.  展开有问题的存储库
3.  展开分支机构 → 本地
4.  右键单击分支并选择*配置分支*
5.  切换*Rebase*标志或更改*上游分支*

如果*配置分支*不可用，请将 EGit 更新到至少 2.0，或使用[每晚更新站点](http://download.eclipse.org/egit/updates-nightly)。

# php - 在不知道关联字段的情况下循环遍历多维数组

> ID：12462376
> 
> 赞同：0
> 
> 时间：2012-09-17T15:22:53.257
> 
> 标签：php, multidimensional-array, foreach

我正在填充一个多维数组，但我不知道其中的内容，但我正在尝试访问数据。基本上这就是我所拥有的。

```
while (some condition) {
     $data[] = $stuff;
} 
```

然后我试图像这样访问它。

```
for ($i = 0; $i < count($data); $i++) {
     foreach ($data[$i] as $key => $value) {
          echo $key . " => " . $value;
     }
} 
```

但它不起作用，这就是我在这里问的原因。

我也尝试过存储`$data[$i]`到临时数组中并循环它，但它也失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:34:29.470

```
foreach ($data AS $datum) {
   if(is_array($datum)){
      foreach ($datum as $key => $value) {
           echo $key . " => " . $value;
      }
   }else{
       echo 'Sorry mate your $stuff is fcked up';
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:26:29.120

你是什​​么意思“它不工作”？你得到什么错误？您是否尝试过该`var_dump`命令来查看 $data[$i] 是否包含任何内容？

基本上，如果你不知道 $stuff 中有什么……你需要做更多的错误和类型检查。例如，如果 $data[$i] 不是数组，则 foreach 循环可能会失败。考虑使用该`is_array`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:37:26.537

我可能会这样做

```
foreach ($data as $dkey=>$stuffs) 
  {
    foreach ($stuffs as $skey => $value) 
      {
        echo $dkey.' '.$skey . " => " . $value;      
      }
  } 
```

看看你得到了什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T15:53:40.580

你可以这样做吗？

```
function show_data($data)
{
    if (is_array($data))
    {
        foreach($data as $key=>$value)
        {
            //do something
            show_data($value);
        }
    } else {
                // do something
        echo $data;
    }
} 
```

# go - 从 Golang 中的函数列表中选择一个函数

> ID：12462377
> 
> 赞同：7
> 
> 时间：2012-09-17T15:22:54.657
> 
> 标签：go, reflection, go-reflect

基本上，如果我有一个任意函数的切片或数组，我怎样才能只选择返回 int 的那些，或者只选择那些带 int 的？

我想我需要使用反射包，但是仅仅阅读文档并不能真正帮助我弄清楚如何去做。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-17T15:40:42.263

该程序打印采用`int`as 参数或返回 的函数`int`：

```
package main

import (
    "fmt"
    "reflect"
)

func main() {
    funcs := make([]interface{}, 3, 3) // I use interface{} to allow any kind of func
    funcs[0] = func (a int) (int) { return a+1} // good
    funcs[1] = func (a string) (int) { return len(a)} // good
    funcs[2] = func (a string) (string) { return ":("} // bad
    for _, fi := range funcs {
        f := reflect.ValueOf(fi)
        functype := f.Type()
        good := false
        for i:=0; i<functype.NumIn(); i++ {
            if "int"==functype.In(i).String() {
                good = true // yes, there is an int among inputs
                break
            }
        }
        for i:=0; i<functype.NumOut(); i++ {
            if "int"==functype.Out(i).String() {
                good = true // yes, there is an int among outputs
                break
            }
        }
        if good {
            fmt.Println(f)
        }
    }
} 
```

我认为代码是不言自明的

# javascript - 我不理解 Handlebars.js 自述文件中的这个“块助手”示例

> ID：12462381
> 
> 赞同：1
> 
> 时间：2012-09-17T15:23:03.643
> 
> 标签：javascript, ember.js, handlebars.js

[https://github.com/wycats/handlebars.js/#registering-helpers](https://github.com/wycats/handlebars.js/#registering-helpers)

在之前的“注册助手”部分中，他们演示了如何创建单标签助手：

```
Handlebars.registerHelper('link_to', function(context) {
  return "<a href='" + context.url + "'>" + context.body + "</a>";
});
{{#posts}} <li>{{{link_to this}}}</li> {{/posts}} 
```

请注意，“context”被传入，他们可以通过说“context.url”、“context.body”等轻松访问它的属性。

[https://github.com/wycats/handlebars.js/#block-helpers](https://github.com/wycats/handlebars.js/#block-helpers)

好吧，在“块助手”部分，他们有一个类似的例子，但它似乎不必要地令人费解：

```
Handlebars.registerHelper('link', function(context, fn) {
  return '<a href="/people/' + this.__get__("id") + '">' + fn(this) + '</a>';
});
{{#people}} <li>{{{#link}}}{{name}}{{/link}}</li> {{/people}} 
```

首先，这次他们没有在开始标签中传递“this”，那么助手如何接收“context”参数？如果 Handlebars 自动传递它是为了方便，那么为什么它不为单标签助手也这样做呢？那么第一个示例可以只使用“{{link_to}}”而不是“{{link_to this}}”。我错过了什么？

其次，如果块助手接收到一个“上下文”参数，那么为什么它不能像单标签助手一样使用它呢？为什么它不能说“context.id”而不是可怕的“this”。**得到**（“id”）'？我错过了什么？

我希望这看起来不像是在文档中挑剔。比较和对比是我学会真正理解事物本质的方式。帮助我用理解代替困惑。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T18:26:15.567

我相信 README.md 中的示例已经过时，有一个关于它的问题[#234](https://github.com/wycats/handlebars.js/issues/234)到今天仍然开放。

看看[http://handlebarsjs.com/block_helpers.html](http://handlebarsjs.com/block_helpers.html)上的 Block Helpers 示例……乍一看似乎是最新的。

# objective-c - 什么是 CCRibbon 跟踪精灵动画背后路径的好替代品

> ID：12462382
> 
> 赞同：0
> 
> 时间：2012-09-17T15:23:04.410
> 
> 标签：objective-c, ios, cocos2d-iphone, kobold2d

这是[My X-code cannot find CCRibbon](https://stackoverflow.com/questions/8583780/my-xcode4-cannot-find-ccribbon)的后续。

似乎在 Cocos2d 的 v2 中已经弃用了 CCRibbon 类。我想基本上使用这个确切的功能。我有一个围绕场景动画的精灵，我想要一条线来跟随精灵的动作（类似于 LOGO pen up/pen down）。

目前我正在覆盖我的动画的更新方法以返回它的开始和结束位置。然后我绘制一条线（基于 1x1 纹理）并在每次动画更新时将其添加到 CCSpriteBatchNode。（如果有人感兴趣，我可以添加更多示例代码）。

我目前的解决方案工作正常，但它的开销很高，而且并不总是很一致。在着手改进它之前，我想看看是否有针对此类事情的已知最佳实践。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T22:03:13.640

您可以为此使用 CCMotionStreak。

我发现这个教程听起来和你想做的很相似。 [http://www.supersuraccoon-cocos2d.com/2011/11/03/ensimple-line-follow-demo-ccmotionstreakzh-ccmotionstreakja-ccmotionstreak/](http://www.supersuraccoon-cocos2d.com/2011/11/03/ensimple-line-follow-demo-ccmotionstreakzh-ccmotionstreakja-ccmotionstreak/)

# jquery - jQuery：值未定义

> ID：12462384
> 
> 赞同：0
> 
> 时间：2012-09-17T15:23:22.960
> 
> 标签：jquery

我在 php 中使用 Ajax 调用渲染一个选择框，输出就像

```
 <select onchange = 'addtolist(this.val)' name='select_val' id='select_val' class= 'required'>
<option  value='xzvfxcv'>xzvfxcv</option>
<option  value='dfscs'>dfscs</option>
</select> 
```

好的，这是我的函数 addtolist

```
function addtolist(id){
  alert(id);

} 
```

现在在更改选择框时，我得到了`undefined`

请帮我解决我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:24:48.513

`val`不是您必须使用的 javascript 元素的有效属性`value`，

**[现场演示](http://jsfiddle.net/rajaadil/sNFVb/)**

```
<select onchange = 'addtolist(this.value);' name='select_val' id='select_val' class= 'required'>
     <option  value='xzvfxcv'>xzvfxcv</option>
     <option  value='dfscs'>dfscs</option>
</select> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:27:43.860

您可以`onchange`根据需要使用，但我认为这在很大程度上已被将脚本保持在一起所取代。完全摆脱，`onchange`只需更新您的 JavaScript：

```
$("#select_val").on('change', function () {
   //or alert() if you must
   console.log($(this).val());
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:28:15.340

尝试这个

```
<select onchange = 'addtolist(this);' name='select_val' id='select_val' class= 'required'>
<option  value='xzvfxcv'>xzvfxcv</option>
<option  value='dfscs'>dfscs</option>
</select>​ 
```

和

```
function addtolist(id) {
    alert(id.value);
}​ 
```

# iphone - 无法下载应用程序， 此时无法安装

> ID：12462385
> 
> 赞同：27
> 
> 时间：2012-09-17T15:23:24.580
> 
> 标签：iphone, objective-c, ios, xcode, code-signing

尝试将应用程序安装到设备时出现此错误。过去 3 天我一直在处理代码签名错误，现在是这个。

我的应用程序正在使用分发证书和移动配置文件。它被上传到构建服务器，在那里它作为成功的构建传递，没有代码签名错误。服务器生成一个应用程序下载链接，我在设备上使用该链接下载应用程序，但出现错误：

`Unable to download application, <app-name> could not be installed at this time`

*   我的应用正在使用有效的分发证书
*   我的应用正在使用有效的分发配置文件
*   构建服务器通过了应用程序，没有代码签名错误

据我了解，该应用程序应该能够在使用分发证书和配置文件的任何设备上运行。我使用过的其他应用程序可以使用这种方法正常工作。有谁知道为什么我的应用程序无法安装？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2014-02-03T20:58:38.707

> ## Most common causes of this issue:
> 
> *   *Device storage* is full
> *   The *provisioning profile* is a developer provisioning profile
> *   The ad hoc distribution provisioning profile is *corrupted* and the device is having an issue with it.
> *   The device was *restored from a backup* and is causing a conflict for over-the-air distribution
> *   There was a *network timeout*
> *   Architecture *settings of the build and the device* are incompatible ( can sometimes happen when "Build Active Architecture Only" is on when building).
> *   Not Using *Mobile Safari*.
> 
> ## To find out the exact cause of this issue:
> 
> *   Connect the device with *iMac*.
> *   Open *Organizer* then choose *devices*.
> *   Choose your *Connected device* from *sidebar*.
> *   Choose *Console* inside the *chosen device*.
> *   Now *install the app* it will show the *exact cause of problem*

[Reference](https://stackoverflow.com/a/15259206/730807)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-17T15:27:57.603

您的应用程序是否使用有效的企业/内部分发配置文件/证书构建？

如果是这样：将设备连接到您的 Mac 并启动 xcode。然后打开管理器（CMD + SHIFT + 2）并在安装应用程序时读取设备的控制台。也许这可以解决问题

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-03-03T17:33:05.160

确保您的**iOS 版本**与您正在安装的应用程序兼容。

当用户在**iOS 7**设备上安装仅限**iOS 8的应用程序时，我看到了这个问题。**

 **此外，如果您尝试在 iOS 7 上安装该应用程序，但由于版本不兼容而失败，然后您升级到 iOS 8，您需要执行以下操作：

1.  下载 iExplorer ( [http://www.macroplant.com/iexplorer/](http://www.macroplant.com/iexplorer/) )
2.  插入您的设备
3.  删除“媒体 > 下载”中的所有文件
4.  重启设备

有一个 iOS 错误，它会留下捆绑包 ID，并且会在升级后静默失败，不允许您安装应用程序。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-21T15:18:39.797

最近遇到这个问题，发疯了。iOS 版本、设备类型（iPhone、iPad）的设置是正确的......仍然无法下载/安装应用程序。

### 一个简单的重启解决了它！

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-17T15:28:40.083

Apple 确实需要处理配置文件。

在文档中，它说应用程序必须首先使用开发配置文件进行签名，然后在归档文件以进行分发时使用分发配置文件进行签名。但是，我发现它可以通过使用代码签名和存档签名的开发配置文件来代替。

您确实需要使用配置文件，看看哪些适合您。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-03-16T19:09:51.027

您可以通过尝试将 .IPA**上传到 iTunes Connect**并观察它是否在验证期间不允许上传来确定 .IPA 的问题（忽略有关商店所需的丢失图像/资产的任何错误）。

就我而言，通过 HockeyApp 部署的 Xamarin 应用程序出现错误。因为我没有在 Xcode 中开发项目，所以我使用 Application Loader 尝试将 IPA 上传到 iTunes Connect。验证失败，出现关于 info.plist 中缺少必需设置的错误。一旦我解决了这个问题，我通过 HockeyApp 重新部署并且该应用程序能够运行。

应用程序加载器的说明可以在这里找到： [https ://help.swiftic.com/hc/en-us/articles/201574452-Upload-Your-App-to-iTunes-Connect-using-the-Application-Loader](https://help.swiftic.com/hc/en-us/articles/201574452-Upload-Your-App-to-iTunes-Connect-using-the-Application-Loader)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-12-11T07:32:06.123

最后，经过很多麻烦，我能够解决这个问题。

我正在与 Xamarin 合作。为我的应用启用推送通知后出现此问题，导致配置文件损坏。

我未选中 entitlements.plist 中的推送通知（不禁用推送通知）

我一直在清理项目并删除配置文件

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-09-05T07:17:04.423

对我来说，当我将我的应用程序作为 inHouse App 分发时发生了这个错误，

错误的原因是在导出 ipa 文件时，我使用了选项
**save for Ad Hoc Deployment**但实际上应该**为 Enterprise Deployment 保存**

而且从 iOS 10 开始，您需要提供一些字符串以获得权限，例如，对于“*隐私 - 相机使用说明*”，将字符串添加为“*此应用需要访问相机。* ”

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-09-17T15:32:59.280

嗯，我以前有这个问题。我会首先遵循@max_ 的建议。但是，尽管这听起来微不足道，但请确保与您的 .ipa 关联的 plist 文件在其 ipa 的超链接中具有正确的大小写。它区分大小写。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-10T16:16:55.413

在 .plist 文件中

你的 URL 标签是否包含 http://

如果您使用“www.somelink.com/.....”填写 URL 标签，它将下载但收到消息“此时无法下载”

您应该填写“ [http://www.somelink.com/](http://www.somelink.com/) ....”

也在显示图像和全尺寸图像中

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-26T12:51:16.890

My app's code signing and provisioning profile was fine too. However I fixed the problem from occurring on iOS10 devices by removing it's embedded app extensions. They did not have valid certificates but were not detected as invalid until I disabled the auto-xcode management for their targets.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-10-28T21:39:37.577

我想我有一个和你一样的案例`xcodebuild`。您可能希望在构建设置和 Apple 开发人员门户（以及配置文件中）中检查捆绑标识符是否完全相同（区分大小写！）

您将[在此处](https://stackoverflow.com/a/33401762/1346231)找到更详细的说明和更多修复选项。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-07-05T05:20:43.400

对于那些使用 dropbox 进行 https 下载的用户，只需检查链接是否正确……我忘了使用像这样的正确格式[https://dl.dropboxusercontent.com/s/xxxxxxxxxxxxx/appname.ipa](https://dl.dropboxusercontent.com/s/xxxxxxxxxxxxx/appname.ipa) 你不应该使用 www.dropbox.com.......我刚刚改变了这个，它工作得很好

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-09-29T07:40:20.613

在我们的例子中，我们的分发配置文件已经过期。在您的 Apple 开发者/会员中心查看。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-06-22T14:44:37.837

有时您只需要删除所有具有相同 bundleId 的应用程序。就我而言，我有一个从代码安装的应用程序，在配置 CI 后，我无法从 CI 安装构建。修复只是删除从 Xcode 安装的应用程序。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-04-20T09:37:52.990

只需通过将手机与mac连接来修复它，然后在xcode中运行该应用程序

猜测苹果供应系统可能存在一些错误**

# mysql - mysqldump --lock-all-tables

> ID：12462394
> 
> 赞同：4
> 
> 时间：2012-09-17T15:23:58.590
> 
> 标签：mysql, database, backup

我一直在阅读如何进行 mysql 转储/备份。听起来要确保您获得所有数据，您确实应该使用选项--lock-all-tables 运行。我不清楚的是我之后是否需要运行任何东西来解锁？

我将尝试运行以下命令：

> mysqldump --lock-all-tables -u root -p DATABASENAME > nameofdumpfile.sql

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:26:09.680

一旦转储命令完成，它就会断开它的连接，如果没有明确地完成，也会隐式地断开任何锁。所以不，你不需要做任何单独的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:50:29.093

你没有提到你正在使用的引擎。尝试带有 --single-transaction 标志的 InnoDB。

# php - 打开图形对象的自定义 URL

> ID：12462395
> 
> 赞同：1
> 
> 时间：2012-09-17T15:24:00.647
> 
> 标签：php, facebook, redirect, facebook-opengraph

当他单击我的对象的标题时，我试图将用户重定向到特定的 URL。

所以我试着这样做：

```
<meta property="og:url" content="http://www.mywebsite.com/myPage" /> 
```

而不是这个：

```
<meta property="og:url" content="<?php echo strip_tags(curPageURL());?>" /> 
```

但是 Facebook 无法获取元数据，因为它似乎使用了这个 URL。

有没有办法重定向到任何其他 URL？我无法在特定页面上添加元数据，因为它不是我的。

# php - 多文件上传 Joomla

> ID：12462397
> 
> 赞同：2
> 
> 时间：2012-09-17T15:24:04.877
> 
> 标签：php, file, file-upload, joomla, joomla2.5

我可以使用 PHP 在我的 Joomla 组件中上传多个文件吗？如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T20:19:26.350

多个文件上传已经是核心 Joomla 2.5 中的媒体管理器和 JFormFieldMedia 的一部分，如果站点启用了 Flash 上传器，则在 1.5/2.5 中有 Flash 上传器。所以我会说扩展它或复制代码来实现。

# php - Code Igniter 中多语言管理员的 linux 权限问题

> ID：12462401
> 
> 赞同：2
> 
> 时间：2012-09-17T15:24:09.213
> 
> 标签：php, linux, codeigniter, permissions, user-permissions

我已经创建了一个管理面板来为 CI 应用程序添加新的语言......

这是必需的，因为客户需要放置大约 20 种语言，他已经提供了需要使用不同语言的所有页面文本，并且它们大多是信息性文本，将来可能会发生变化。

所以，我创建了管理面板来加载所有现有目录的列表，`Language directory`并且有一个简单的 CRUD 来创建新的语言 php 文件。

一切正常，但问题是我`apache user`在服务器上的与 不同`FTP user`，我无法从 ftp.xml 中删除文件/文件夹。为此，我有几件事要考虑：

1.  CHMOD 将新文件夹和语言 PHP 文件更改为 777 {虽然我这样做是为了编写但在文件写入后将其更改为 755}
2.  将新的语言文件夹/文件放在应用程序文件夹之外的其他位置，这样我就可以 777 它而不会造成任何伤害.. { 寻找它但找不到任何帮助}
3.  不知道该怎么办...

我已经设置`777`为`language directory`让 Apache 用户在目录中写入

我有一个解决方案来更改项目的所有者，`ftp user to apache`但是，然后将无法从 ftp 访问文件，所以我要求我的网络人员将 apache 用户添加到同一个组，以便我可以将权限更改为 775 但他不是确定它是否会工作并且不会更改 apache 用户的组。

现在主要关心的是制造`...application/language`和`...application/language/*/*`777好不好？

如果有任何其他替代方案，请告诉我，如果它可以工作，我可以改变整个过程

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T01:23:37.753

离开777不会有问题。黑客仍然需要在服务器上的任何位置进行 FTP 或写入访问才能编辑任何文件。只要您正确验证每个操作并在 CodeIgniter 中使用 CSRF 保护，您就可以了。

此外，您可能希望添加与其他 CodeIgniter 目录中相同的 index.html，说明“不允许直接访问”。

我已经多次使用这些方法，它们可以完成您所需要的，而不会让自己面临威胁。

# javascript - 谷歌地图多个标记在地理编码上显示相同的标题和信息窗口

> ID：12462402
> 
> 赞同：1
> 
> 时间：2012-09-17T15:24:12.020
> 
> 标签：javascript, jquery, google-maps

我正在尝试使用带有地理编码的 JSON 显示多个标记。我的代码在正确的位置显示所有标记，但没有在它们上显示正确的信息窗口或正确的标题。我知道这与闭包有关。但我不明白。请帮我编辑我的代码并解释为什么需要编辑它？请帮忙！！

```
points = data.POINTS;
var geocoder;
//var map;

geocoder = new google.maps.Geocoder();
var latlng = new google.maps.LatLng(41.2324, - 98.4160);
var mapOptions = {
    zoom: 4,
    center: latlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
}
map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

var infoWindow = new google.maps.InfoWindow();

for (var i = 0, length = points.length; i < length; i++) {
    data = points[i],
    address = data[1] + ", " + data[2] + ", " + data[3] + ", " + data[4] + ", " + data[5];

    geocoder.geocode({
        'address': address
    }, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            map.setCenter(results[0].geometry.location);
            //Creating a marker and putting it on the map
            var marker = new google.maps.Marker({
                map: map,
                position: results[0].geometry.location,
                title: data[4],
                animation: google.maps.Animation.DROP
            });
            // Creating a closure to retain the correct data, notice how I pass the current data in the loop into the closure (marker, data)
            (function (marker, points) {
                // Attaching a click event to the current marker
                //console.log(data[6]);
                google.maps.event.addListener(marker, "click", function (e) {
                    infoWindow.setContent(data[6] + " " + data[0]);
                    infoWindow.open(map, marker);
                });
            })(marker, data);
        } else {
            //alert("Geocode was not successful for the following reason: " + status);
        }
    });

}

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T12:53:37.193

答案如下：
我需要的是在循环之外调用添加标记函数。感谢您对我的问题的所有善意考虑。希望我的解决方案对其他人有所帮助。

```
points = data.POINTS;
var geocoder;
//var map;
geocoder = new google.maps.Geocoder();
var latlng = new google.maps.LatLng(41.2324, - 98.4160);
var mapOptions = {
    zoom: 4,
    center: latlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
}
map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
infoWindow = new google.maps.InfoWindow();
for (var i = 0; i < points.length; i++) {
    var myLoc = points[i];
    var geoOptions = {
        address: myLoc[1] + "," + myLoc[2] + "," + myLoc[3] + "," + myLoc[4] + "," + myLoc[5]
    }
    geocoder.geocode(geoOptions, addMarkers(myLoc[6]));
}

function addMarkers(myTitle) {
    return function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            var marker = new google.maps.Marker({
                map: map,
                position: results[0].geometry.location,
                title: myTitle,
                zIndex: i
            });
            (function (marker, myTitle) {

                // Attaching a click event to the current marker
                //console.log(data[6]);
                google.maps.event.addListener(marker, "click", function (e) {
                    infoWindow.setContent(myTitle);
                    infoWindow.open(map, marker);
                });
            })(marker, myTitle);
        }
    };
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T17:43:13.477

这是因为您总是将内容设置为 data[6] + data[0]。

当您遍历标记时，您需要为每次迭代更改信息窗口的内容。

```
infoWindow.setContent(data[i] + " " + data[i]); 
```

像上面这样的东西应该可以解决问题，但我不知道你想要什么数据。高温高压

...您对所在区域的标题有同样的问题，总是将其设置为 title[4]

# css - 字体权重

> ID：12462407
> 
> 赞同：3
> 
> 时间：2012-09-17T15:24:24.500
> 
> 标签：css, font-face

我正在使用购买字体（Museo Sans）作为我正在开发的应用程序中的自定义字体。我购买时提供给我的文件包含不同权重的网络字体文件：MuseoSans100Regular、MuseoSans300Regular 等。@font-face 中有没有办法指定用于不同权重的文件，以便我可以这样做：

```
font-family: MuseoSans;
font-weight: 300; 
```

而不是这样：

```
font-family: MuseoSans300; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-17T15:41:48.867

`font-weight`是的，您必须在两个不同的`@font-face`定义中指定哪个文件：

```
@font-face {
    font-family: 'MuseoSans';
    src: url('../font/museo_sans_100.woff');
    font-weight: 100;
    font-style: normal;
}
@font-face {
    font-family: 'MuseoSans';
    src: url('../font/museo_sans_300.woff');
    font-weight: 300;
    font-style: normal;
}

h1, p {
    font-family: MuseoSans;
}

h1 {
    font-weight: 300; /* uses museo_sans_300.woff */
}

p {
    font-weight: 100; /* uses museo_sans_100.woff*/
} 
```

# python - 使用 xml.dom.minidom python 向 xml 添加属性和值

> ID：12462409
> 
> 赞同：0
> 
> 时间：2012-09-17T15:24:31.207
> 
> 标签：python, xml, minidom

如何使用`xml.dom.minidom`Python 向 XML 文档添加属性和值。

我的XML如下

```
<?xml version="1.0" encoding="utf-8"?>

<PackageInfo xmlns="http://someurlpackage">

<data ID="http://someurldata1">data1</data >
<data ID="http://someurldata2">data2</data >
<data ID="http://someurldata3">data3</data >
</PackageInfo> 
```

我想添加一个新的“数据”标签，它的 id 为“ [http://someurldata4](http://someurldata4) ”，值为 data4。这样生成的 xml 将如下所示。抱歉，我不想使用 xml.etree.ElementTree

```
<?xml version="1.0" encoding="utf-8"?>

<PackageInfo xmlns="http://someurlpackage">
<data ID="http://someurldata1">data1</data >
<data ID="http://someurldata2">data2</data >
<data ID="http://someurldata3">data3</data >
<data ID="http://someurldata4">data4</data >
</PackageInfo> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:44:56.503

[使用方法](http://docs.python.org/library/xml.dom.html#xml.dom.Element.setAttribute)创建新的 DOM 元素，可以使用[`Document.createElement()`方法](http://docs.python.org/library/xml.dom.html#xml.dom.Document.createElement)添加新的 DOM 属性：[`Element.setAttribute()`](http://docs.python.org/library/xml.dom.html#xml.dom.Element.setAttribute)

```
newdata = doc.createElement(u'data')
newdata.setAttribute(u'ID', u'http://someurldata4') 
```

然后，您必须创建一个文本节点并将其作为子节点添加到`newdata`元素中，使用[`Document.createTextNode()`](http://docs.python.org/library/xml.dom.html#xml.dom.Document.createTextNode)和[`Node.appendChild()`](http://docs.python.org/library/xml.dom.html#xml.dom.Node.appendChild)方法：

```
newdata.appendChild(doc.createTextNode(u'data4')) 
```

现在您可以将新元素添加到文档根目录：

```
doc.documentElement.appendChild(newdata) 
```

换句话说，使用[DOM API 的 Python 实现](http://docs.python.org/library/xml.dom.html#xml.dom.Node.appendChild)。

# python - 首先要做什么：特征选择还是模型参数设置？

> ID：12462410
> 
> 赞同：13
> 
> 时间：2012-09-17T15:24:36.793
> 
> 标签：python, machine-learning, scikit-learn, feature-selection

这更像是一个“理论”问题。我正在使用 scikit-learn 包来执行一些 NLP 任务。Sklearn 提供了许多方法来执行特征选择和模型参数的设置。我想知道我应该先做什么。

如果我使用[单变量特征选择](http://scikit-learn.org/stable/modules/feature_selection.html#univariate-feature-selection)，很明显我应该先进行特征选择，然后使用所选特征调整估计器的参数。

但是如果我想使用[递归特征消除](http://scikit-learn.org/stable/modules/feature_selection.html#recursive-feature-elimination)呢？[我应该先使用所有原始特征通过网格搜索](http://scikit-learn.org/stable/modules/grid_search.html)设置参数，然后再执行特征选择吗？或者我应该先选择特征（使用估计器的默认参数），然后使用所选特征设置参数？

提前感谢您能给我的任何帮助。

**编辑**

我遇到了[这里](http://www.mail-archive.com/scikit-learn-general@lists.sourceforge.net/msg02355.html)所说的几乎相同的问题。到那时，还没有解决办法。有谁知道它现在是否存在？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-18T08:22:52.430

就我个人而言，我认为 RFE 在大多数情况下过于矫枉过正且过于昂贵。如果您想对线性模型进行特征选择，请使用单变量特征选择，例如使用 chi2 测试或具有网格搜索正则化参数的 L1 或 L1 + L2 正则化模型（通常命名为`C`或`alpha`在 sklearn 模型中）。

对于具有大量样本的高度非线性问题，您应该尝试`RandomForestClassifier`，`ExtraTreesClassifier`或 GBRT 模型和网格搜索参数选择（可能使用 OOB 分数估计）并使用`compute_importances`开关按重要性查找特征排名并将其用于特征选择。

对于样本很少的高度非线性问题，我认为没有解决方案。你一定是在做神经科学:)

# asp.net-mvc-3 - 为什么 HttpContext.Current 不起作用？

> ID：12462412
> 
> 赞同：-1
> 
> 时间：2012-09-17T15:24:40.710
> 
> 标签：asp.net-mvc-3

我通过以下语法将一些信息存储在我的网站（mvc3-.net4-iis7）中：

```
HttpContext.Current.Application.Add(appKey, value); 
```

并通过这个读取数据：

```
 HttpContext.Current.Application[appKey]; 
```

它工作正常，但在很短的时间（大约 20 分钟）后它不起作用并且找不到 [appKey]，我想知道它是否有一些设置要做或者它是否过期？

我在 web.config 中将我的 cookie 过期时间更改为 7 天，但还没有工作。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:26:40.663

这些值存储在内存中。如果应用程序被 IIS 回收，AppDomain 将关闭，并且您存储在内存中的所有内容都会丢失。不要忘记 IIS 可以随时回收您的应用程序。例如，如果满足某些内存/CPU 阈值。因此，如果您在应用程序被回收后尝试读取该值而不设置它，它将不存在。

因此，您应该考虑使用更持久的位置来存储这些信息，而不是将其存储在内存中。

> 我在 web.config 中将我的 cookie 过期时间更改为 7 天，但还没有工作。

您存储在应用程序状态中的值与 cookie 无关。它们存储在服务器上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:28:44.390

这与您的 cookie 无关，HttpContext.Current 由您的会话确定，默认为 20 分钟。

您可以通过在 web.config 中设置来增加时间：

```
<configuration>
… some config here …
<system.web>
  <sessionState timeout="XXX" />
…some more config
</system.web>
</configuration> 
```

正如达林所说，值得注意的是，你的方法是否真的是你应该做的。

# c# - 为什么条件（三元）运算符看起来明显更快？

> ID：12462418
> 
> 赞同：5
> 
> 时间：2012-09-17T15:24:56.623
> 
> 标签：c#, stopwatch

**编辑**

如果我`Stopwatch`正确使用并将迭代次数增加两个数量级，我会得到

> 三进制耗时 22404ms
> 
> 正常耗时 21403ms

这些结果更接近我的预期，让我觉得世界上一切都很好（如果不是我的代码的话。）

三元/条件运算符实际上稍微慢一些。

* * *

继[这个问题](https://stackoverflow.com/q/12457432/659190)之后，我已经部分[回答](https://stackoverflow.com/a/12458395/659190)了。

我在 x64 发布模式下编译了这个控制台应用程序，并进行了优化，并在没有附加调试器的情况下从命令行运行它。

```
using System; 
using System.Diagnostics;

class Program
{
    static void Main()
    {
        var stopwatch = new Stopwatch();

        var ternary = Looper(10, Ternary);
        var normal = Looper(10, Normal);

        if (ternary != normal)            {
            throw new Exception();
        }

        stopwatch.Start();
        ternary = Looper(10000000, Ternary);
        stopWatch.Stop();
        Console.WriteLine(
            "Ternary took {0}ms", 
            stopwatch.ElapsedMilliseconds);

        stopwatch.Start();
        normal = Looper(10000000, Normal);
        stopWatch.Stop();
        Console.WriteLine(
            "Normal took {0}ms", 
            stopwatch.ElapsedMilliseconds);

        if (ternary != normal)            {
            throw new Exception();
        }

        Console.ReadKey();
    }

    static int Looper(int iterations, Func<bool, int, int> operation)
    {
        var result = 0;
        for (int i = 0; i < iterations; i++)
        {
            var condition = result % 11 == 4;
            var value = ((i * 11) / 3) % 5;
            result = operation(condition, value);
        }

        return result;
    }

    static int Ternary(bool condition, in value)
    {
        return value + (condition ? 2 : 1);
    }

    static int Normal(int iterations)
    {
        if (condition)
        {
            return = 2 + value;
        }

        return = 1 + value;
    }
} 
```

我没有遇到任何异常，控制台的输出也很接近，

> 三进制耗时 107ms
> 
> 正常耗时 230ms

当我分解两个逻辑函数的 CIL 时，我得到了这个，

```
... Ternary ...
{
     : ldarg.1      // push second arg
     : ldarg.0      // push first arg
     : brtrue.s T   // if first arg is true jump to T
     : ldc.i4.1     // push int32(1)
     : br.s F       // jump to F
    T: ldc.i4.2     // push int32(2)
    F: add          // add either 1 or 2 to second arg
     : ret          // return result
}

... Normal ...
{
     : ldarg.0      // push first arg
     : brfalse.s F  // if first arg is false jump to F
     : ldc.i4.2     // push int32(2)
     : ldarg.1      // push second arg
     : add          // add second arg to 2
     : ret          // return result
    F: ldc.i4.1     // push int32(1)
     : ldarg.1      // push second arg
     : add          // add second arg to 1
     : ret          // return result
} 
```

虽然`Ternary`CIL 有点短，但在我看来，通过 CIL 执行任一函数的路径需要 3 次加载和 1 或 2 次跳转和返回。为什么`Ternary`函数看起来快两倍。

我知道，在实践中，它们都非常快，而且确实足够快，但是，我想了解其中的差异。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T15:30:45.790

两者花费的时间几乎完全相同。

你的结果是关闭的，因为你根本没有`Stopwatch`正确使用。“正常”的测量包括*两个*弯针所用的时间。

如果你改变第二个

```
stopwatch.Start(); 
```

到

```
stopwatch.Restart(); 
```

然后你会得到正确的结果。

* * *

顺便说一句，为了获得更公平的比较，您可能应该执行

```
 return (condition ? value + 2 : value + 1); 
```

代替

```
 return value + (condition ? 2 : 1); 
```

使其完全等同于其他功能。否则，您*不仅*要测量条件运算符。

# c++ - 复制大对象，C++

> ID：12462424
> 
> 赞同：2
> 
> 时间：2012-09-17T15:25:38.760
> 
> 标签：c++, assignment-operator, copying

我确信这已经得到解答，但我不是程序员，无法找到/理解适当的答案。假设我有一个庞大的类`big`想要重载一个二元运算符，比如`operator +`.

1.  有没有一种理智的方法可以`big X=Y+Z`将总和直接构建到`X`中，而不是创建临时对象，将其复制到`X`然后销毁临时对象？
2.  我想到的唯一一件事就是包装`big`到另一个类中，该类`small`将包含指向 big 的指针`big`并添加`int use;`对 big 的引用数量，以便`big`对象在`use==0`. 并添加另一个赋值运算符，例如`<=`实际复制。我试图实现它（下）。它似乎有效，但我没有经验，而且我很难预见会出现什么问题。不应该有更简单的解决方案吗？

代码：

```
#include <iostream>

// print and execute cmd
#define Do(cmd) cout << "\n\n\t"<< ++line << ".\t" << #cmd << ";\n" << endl; cmd;

// print small object: name(small.id[big.id,u=big.use,x=big.x])
#define Show(avar) cout << #avar << "(" << (avar).id << "[" << ((avar).data==NULL?0:(avar).data->id) << ",u=" << ((avar).data==NULL?0:(avar).data->use) << ",x=" << ((avar).data==NULL?0:(avar).data->x) << "])" 

using namespace std;

class big{
public:
  static int N;   // biggest id in use
  int id;         // unique id for each object
  int use;        // nuber of references to this object
  int x;          // data
  big() __attribute__((noinline))
  {
    id=++N;
    use=1;
    x=0;
    cout << "big.constructor.def: [" << id << ",u=" << use << ",x="<<x<<"]" << endl;
  }
  big(const int& y) __attribute__((noinline))
  {
    id=++N;
    x=y;
    use=1;
    cout << "big.constructor.int: [" << id << ",u=" << use << ",x="<<x<<"]" << endl;
  }
  big(const big& b) __attribute__((noinline))
  {
    id=++N;
    use=1;
    x=b.x;
    cout << "big.constructor.copy: [" << id << ",u=" << use << ",x="<<x<<"]" << endl;
  }
  ~big() __attribute__((noinline))
  {
    if(use>0) throw 99; // destroing referenced data!
    cout << "big.destructor: [" << id << ",u=" << use << ",x="<<x<<"]" << endl;
  }
  friend class small;
};

class small{
public:
  static int N;      // biggest id in use
  int id;            // unique id
  big * data;        // reference to the actual data
  small() __attribute__((noinline))
  {
    id=++N;        
    data=NULL;       // contains no data
    cout << "small.constructor.def: ";
    Show(*this)<< endl;
  }
  small(const int& y) __attribute__((noinline))
  {
    id=++N;
    data=new big (y);  // relies on the big constructor
    cout << "small.constructor.int: ";
    Show(*this)<<endl;
  }
  small(const small& y) __attribute__((noinline))
  {
    id=++N;
    data=y.data;      // new object refers to the same data!!
    if(data!=NULL) 
      ++(data->use);  // new reference added;
    cout << "small.constructor.copy: "; 
    Show(y) << "-->";
    Show(*this) << endl;
  }
  ~small(){
    cout << "small.destructor: ";
    Show(*this)<< endl;
    if(data!=NULL){       // is there data?
      --(data->use);      // one reference is destroyed
      if(data->use == 0)  // no references left, kill the data
    delete data;
    }
  }
  const small& operator= (const small& b) __attribute__((noinline))
  {
    cout << "equal: ";
    Show(*this) << " = ";
    Show(b)<<endl;
    if(data != NULL){     // is there data in the target?
      --(data->use);      // one reference is destroyed
      if(data->use == 0)  // no references left, 
    delete data;      // kill the data
    }
    data=b.data;          // target referenses the same data as the source!
    if(data!=NULL) 
      ++(data->use);      // new references added
    cout << "Done equal: "<<endl;    
    return *this;
  }
  // <= will be used for actual copying the data
  const small& operator<= (const small& b) __attribute__((noinline))
  {
    cout << "Copy: ";
    Show(*this) << " <= ";
    Show(b)<<endl;
    if(data != NULL){     // is there data in the target?
      --(data->use);      // one reference is destroyed
      if(data->use == 0)  // no references left, 
    delete data;      // kill the data
    }
    if(b.data==NULL)     // source has no data
      data=NULL;
    else
      data = new big(*(b.data)); // make new copy of the data 
                                 // via big's copy constructor
    cout << "Done copy: "<<endl;    
    return *this;
  }
  small operator+ (const small& b) __attribute__((noinline))
  {
    cout << "Plus: "; 
    Show(*this) << " + ";
    Show(b)<< endl;
    if(this->data == NULL | b.data == NULL) throw 99; // missing data for +
    small ret(data->x);
    ret.data->x += b.data->x;
    cout << "Return: "; Show(ret)<<endl;
    return ret;
  }
};

int big::N=0;
int small::N=0;

main(){
  int line=0;

  Do(small X(5); small Y(6); small Z(7); small W(X));
  Show(X) << endl;
  Show(Y) << endl;
  Show(Z) << endl;
  Show(W) << endl;

  Do(X=Y; Z<=Y);
  Show(X)<<endl;  
  Show(Y)<<endl;  // X and Y refer to the same data
  Show(Z)<<endl;  // Z has a copy of data in Y

  Do(X=Z; Y=Z);
  Show(X)<<endl;
  Show(Y)<<endl;
  Show(Z)<<endl;  // data previosly in X,Y destroyed

  Do(small* U=new small (17); small* T=new small (*U));
  Show(*U) << endl;
  Show(*T) << endl; // U and T refer to the same big

  Do(delete U);
  Show(*T) << endl; // big stays since there is another reference to it

  Do(delete T);     // big destroyed

  Do(X=(Y+Z)+W);
  Show(X)<<endl;
  Show(Y)<<endl;
  Show(Z)<<endl;  // no extra copying of data occures

  cout << "\n\tEND\n" << endl;
} 
```

输出：

```
1\.  small X(5); small Y(6); small Z(7); small W(X);

big.constructor.int: [1,u=1,x=5]
small.constructor.int: *this(1[1,u=1,x=5])
big.constructor.int: [2,u=1,x=6]
small.constructor.int: *this(2[2,u=1,x=6])
big.constructor.int: [3,u=1,x=7]
small.constructor.int: *this(3[3,u=1,x=7])
small.constructor.copy: y(1[1,u=2,x=5])-->*this(4[1,u=2,x=5])
X(1[1,u=2,x=5])
Y(2[2,u=1,x=6])
Z(3[3,u=1,x=7])
W(4[1,u=2,x=5])

    2\.  X=Y; Z<=Y;

equal: *this(1[1,u=2,x=5]) = b(2[2,u=1,x=6])
Done equal: 
Copy: *this(3[3,u=1,x=7]) <= b(2[2,u=2,x=6])
big.destructor: [3,u=0,x=7]
big.constructor.copy: [4,u=1,x=6]
Done copy: 
X(1[2,u=2,x=6])
Y(2[2,u=2,x=6])
Z(3[4,u=1,x=6])

    3\.  X=Z; Y=Z;

equal: *this(1[2,u=2,x=6]) = b(3[4,u=1,x=6])
Done equal: 
equal: *this(2[2,u=1,x=6]) = b(3[4,u=2,x=6])
big.destructor: [2,u=0,x=6]
Done equal: 
X(1[4,u=3,x=6])
Y(2[4,u=3,x=6])
Z(3[4,u=3,x=6])

    4\.  small* U=new small (17); small* T=new small (*U);

big.constructor.int: [5,u=1,x=17]
small.constructor.int: *this(5[5,u=1,x=17])
small.constructor.copy: y(5[5,u=2,x=17])-->*this(6[5,u=2,x=17])
*U(5[5,u=2,x=17])
*T(6[5,u=2,x=17])

    5\.  delete U;

small.destructor: *this(5[5,u=2,x=17])
*T(6[5,u=1,x=17])

    6\.  delete T;

small.destructor: *this(6[5,u=1,x=17])
big.destructor: [5,u=0,x=17]

    7\.  X=(Y+Z)+W;

Plus: *this(2[4,u=3,x=6]) + b(3[4,u=3,x=6])
big.constructor.int: [6,u=1,x=6]
small.constructor.int: *this(7[6,u=1,x=6])
Return: ret(7[6,u=1,x=12])
Plus: *this(7[6,u=1,x=12]) + b(4[1,u=1,x=5])
big.constructor.int: [7,u=1,x=12]
small.constructor.int: *this(8[7,u=1,x=12])
Return: ret(8[7,u=1,x=17])
equal: *this(1[4,u=3,x=6]) = b(8[7,u=1,x=17])
Done equal: 
small.destructor: *this(8[7,u=2,x=17])
small.destructor: *this(7[6,u=1,x=12])
big.destructor: [6,u=0,x=12]
X(1[7,u=1,x=17])
Y(2[4,u=2,x=6])
Z(3[4,u=2,x=6])

    END

small.destructor: *this(4[1,u=1,x=5])
big.destructor: [1,u=0,x=5]
small.destructor: *this(3[4,u=2,x=6])
small.destructor: *this(2[4,u=1,x=6])
big.destructor: [4,u=0,x=6]
small.destructor: *this(1[7,u=1,x=17])
big.destructor: [7,u=0,x=17] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:27:54.750

有，它被称为[复制省略](http://en.wikipedia.org/wiki/Copy_elision)。与这种情况特别相关的是 [命名的返回值优化 (RVO) 和返回值优化 (NRVO)](http://en.wikipedia.org/wiki/Return_value_optimization)。这意味着允许编译器在某些情况下返回值时省略副本。实现一个简单的加法运算符可能会导致 RVO。

请注意，这是*允许*编译器进行的优化，但不保证会发生。但是 C++ 具有移动语义，它提供了一种正式的方法，通过该方法可以将一个（通常是临时的）对象的底层数据“移动”到另一个对象，而不会产生不必要的副本。[这里](http://www.cprogramming.com/c++11/rvalue-references-and-move-semantics-in-c++11.html)有一篇关于移动语义的文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:41:21.983

如果总和是一个复合值，另一种方法是`big::operator+`返回一个`sumOfBig`类的实例，该实例保留指向 Y 和 Z 的指针或引用。

`sumOfBig`可能包含在需要时动态计算总和成分的成员函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:41:50.847

考虑`+=`在这种情况下定义和使用：

```
Big a, b, c; 
```

代替：

```
a = b + c; 
```

做：

```
a=b;
a+=c; 
```

的示例定义`+=`：

```
Big& Big::operator += (const Big& other)
{
   this->a += other.a;
   // ...
   return *this;
} 
```

你可以让你`operator +`的基础`operator +=`使他们在逻辑上做同样的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T16:02:10.383

首先，打开优化，看看你的编译器*实际上*做了什么：你可以根据 juanchopanza 的回答免费获得 (N)RVO。

如果您的编译器无法做到这一点，那么根据 Piotr 的回答明确删除中间副本可能会改善问题。

如果您确实需要推迟对任意复杂算术表达式的评估，则需要表达式模板（正如 Nicola 和我在评论中提到的那样）：如果您有可变源对象，则可能需要表达式模板*和*写时复制。这些都不是微不足道的。如果你真的需要它们，并且真的找不到已经满足你需要的库......好吧，一旦你研究了它们并开始了，我会寻找关于你的表达式模板实现的问题。

# java - web.xml 之外的环境条目？

> ID：12462426
> 
> 赞同：0
> 
> 时间：2012-09-17T15:25:40.507
> 
> 标签：java, web.xml

是否有可能在 web.xml 之外定义一个“env-entry”？也许在 .txt 文件上？或 .xml 文件？

如果我可以在项目之外的 Windows 目录中定义它，那就更好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:29:06.697

您可以在 context.xml 或 server.xml 中定义它

有关详细信息，请参阅[此链接](http://wiki.metawerx.net/wiki/Web.xml.EnvEntry)

# c# - Spring.NET - 不建议使用 ContextRegistry.GetContext？

> ID：12462428
> 
> 赞同：0
> 
> 时间：2012-09-17T15:25:46.420
> 
> 标签：c#, asp.net-mvc-3, inversion-of-control, spring.net

我正在构建一个 MVC 3 站点，并希望使用 Spring 提供我的 Web 服务适配器的运行时注入，以便我可以在模拟服务调用中存根，而不是调用真正的交易。

```
var ctx = ContextRegistry.GetContext();
var serviceAdapter = (IServiceAdapter) ctx[Constants.C_ServiceAdapter];
...
serviceAdapter.doSomething(); 
```

我之前一直在 Spring 线程安全上被刺痛，其中单例不是“假的”，所以查看了 Spring 源代码以仔细检查上述是否是线程安全的。

消息来源在评论中有这个：

```
/// A singleton implementation to access one or more application contexts.  Application
/// context instances are cached.
/// </p>
/// <p>Note that the use of this class or similar is unnecessary except (sometimes) for
/// a small amount of glue code.  Excessive usage will lead to code that is more tightly
/// coupled, and harder to modify or test.  Consider refactoring your code to use standard
/// Dependency Injection techniques or implement the interface IApplicationContextAware to
/// obtain a reference to an application context.</p> 
```

我的问题：为什么使用这个不明智？仅仅是因为我们不需要的2行样板吗？AFAIK 我仍在声明最终将在配置中创建什么对象，所以看不到它如何使它更紧密地耦合？

注意：我真的不想走使用 Spring.Web dll 并通过配置完成所有 DI 的路线，如果我能提供帮助的话！

非常感谢邓肯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:33:34.253

这是一个坏主意，因为您没有使用依赖注入。这不是因为 GetContext 方法的任何线程安全考虑。您正在使用被认为是不好的做法的服务定位器模式 - 类不应该负责查询 DI 容器以获取依赖项，这些依赖项应该被注入。

作为最佳实践，您应该考虑编写基于 Spring.NET的自定义[依赖解析器。](http://bradwilson.typepad.com/blog/2010/10/service-location-pt5-idependencyresolver.html)这样，依赖项将自动注入控制器和其他类。

# glassfish - GlassFish ASADMIN 部署命令 使用 --name 指定上下文根？

> ID：12462429
> 
> 赞同：0
> 
> 时间：2012-09-17T15:25:49.540
> 
> 标签：glassfish, asadmin

我目前正在配置我们的开发环境以从开源 glassfish v3.1 升级到开源 glassfish 3.1.2，并注意到使用 asadmin 命令的版本之间的这种差异：

v3.1

部署 --name test:beta-1.0 "c:\tmp\my-long-test-app-war-name.war"

这可以通过 http:\\localhost:8080\test 访问

v3.1.2

部署 --name test:beta-1.0 "c:\tmp\my-long-test-app-war-name.war"

这只能通过 http:\\localhost:8080\my-long-test-app-war-name 访问

我注意到新版本中的 --contextroot 被描述为：

```
 --contextroot
      Valid only if the  archive  is  a  web  module.  It  is
      ignored  for  other archive types; defaults to filename
      without extension. 
```

并且 --name 为：

```
 --name
      Name of the deployable component.

      The name can include an  optional  version  identifier,
      which  follows  the name and is separated from the name
      by a colon (:). The version identifier must begin  with
      a letter or number. It can contain alphanumeric charac-
      ters plus underscore (_),  dash  (-),  and  period  (.)
      characters.  For  more  information  about  module  and
      application versions, see "Module and Application  Ver-
      sions"  in  Oracle GlassFish Server Application Deploy-
      ment Guide. 
```

因此，对于较新的版本（或在 3.1 以上更改时），部署命令应变为：

部署 --name test:beta-1.0 --contextroot test "c:\tmp\my-long-test-app-war-name.war"

干杯，克雷格

ps 目前正试图关闭 v3.1.2.2 来测试它，但公司防火墙是残酷的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-22T14:59:24.187

I think both --contextroot and --name are corresponding to when you use the admin panel from the browser. They are independent to each other. Use --contextroot only if you want to change the default contextroot to a different one.

# mysql - mysql日期时间索引不适用于某些特定日期范围

> ID：12462433
> 
> 赞同：0
> 
> 时间：2012-09-17T15:26:06.777
> 
> 标签：mysql, indexing, date-range

我有一个具有此架构的表 -

```
CREATE TABLE `ox_data_summary_device_hourly` (
  `data_summary_device_hourly_id` bigint(20) NOT NULL AUTO_INCREMENT,
  `date_time` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  ...

  ...
  PRIMARY KEY (`data_summary_device_hourly_id`),
  KEY `ox_data_summary_device_daily_date_time` (`date_time`),
  KEY `ox_data_summary_device_daily_ad_country_date_time` (`ad_id`,`date_time`),
  KEY `ox_data_summary_device_daily_zone_id_date_time` (`zone_id`,`date_time`)
) ENGINE=InnoDB AUTO_INCREMENT=3478837682 DEFAULT CHARSET=latin1 
```

因此，在表上设置了以下索引 -

```
 KEY `ox_data_summary_device_daily_date_time` (`date_time`),
 KEY `ox_data_summary_device_daily_ad_country_date_time` (`ad_id`,`date_time`),
 KEY `ox_data_summary_device_daily_zone_id_date_time` (`zone_id`,`date_time`) 
```

我在这个表上有这个解释查询，带有过滤器`date_time`-

```
explain SELECT *

FROM ox_data_summary_device_hourly data_hourly 

WHERE 
data_hourly.date_time >= '2012-09-01 00:00:00' AND data_hourly.date_time < '2012-09-15 13:00:00' 

GROUP BY data_hourly.type ORDER BY data_hourly.type DESC 
```

这是显示`ox_data_summary_device_daily_date_time`索引未应用的输出 -

![在此处输入图像描述](../Images/03848d1397152e3f56c52e951c40ed69.png)

但是，如果我将上述查询中的日期过滤器更改为以下内容 -

`data_hourly.date_time >= '2012-09-01 00:00:00' AND data_hourly.date_time < '2012-09-14 13:00:00'`

即，如果我查询 9 月 1 日至 14 日而不是 1 日至 15 日，则`ox_data_summary_device_daily_date_time`索引适用。我进一步检查，如果范围的结束日期在 之后`15 sep`，则索引不适用。

我很困惑。我检查了表格中是否有日期范围 >= 9 月 15 日的数据。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:42:01.200

我不确定为什么没有使用索引，但您可以通过添加`FORCE INDEX`选项来解决这个问题：

```
SELECT *
FROM ox_data_summary_device_hourly data_hourly 
FORCE INDEX (ox_data_summary_device_daily_date_time)
WHERE 
data_hourly.date_time >= '2012-09-01 00:00:00' AND 
data_hourly.date_time < '2012-09-15 13:00:00' 
GROUP BY data_hourly.type ORDER BY data_hourly.type DESC 
```

此外，您可能会发现使用`BETWEEN`运算符更容易阅读，甚至可能表现得更好：

```
SELECT *
FROM ox_data_summary_device_hourly data_hourly 
FORCE INDEX (ox_data_summary_device_daily_date_time)
WHERE 
data_hourly.date_time BETWEEN 
    '2012-09-01 00:00:00' AND 
    '2012-09-15 13:00:00' - INTERVAL 1 SECOND
GROUP BY data_hourly.type ORDER BY data_hourly.type DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:48:29.170

对我来说听起来像是优化器 - 它认为查询检查的行太多，无法使索引有用。这就解释了为什么它也适用于较小的范围。

我认为您可以查询较小的日期范围或使用 DATE 而不是 DATETIME。

运行 ANALYZE 或 OPTIMIZE 也可能有所帮助。这是一篇不错的[概述文章](http://www.pythian.com/news/1114/mysql-back-to-basics-analyze-check-optimize-and-repair/)

祝你好运。

# php - 显示链接图片

> ID：12462434
> 
> 赞同：0
> 
> 时间：2012-09-17T15:26:08.120
> 
> 标签：php, drupal, hyperlink

下面是我在 drupal 的 template.php 中使用的一段代码来显示 facebook 链接

```
$links = array();
        $links['facebook'] = array(
              'title' => 'facebook',
              'href' => "http://facebook.com",

              'html' => TRUE,
          ); 
```

这会在网站上显示标题“facebook”，但我想要 facebook 图标而不是标题需要添加哪些代码..??

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:29:46.870

如果您将其更改为，`<img src='http://www.ok.gov/ltgovernor/images/Facebook-icon.png' />`则它可能会起作用，但如果其他 php 将标题放在这里`<a title=$links[''title]`，那么`<a>$links['title']</a>`它将不起作用。

# java - statement.isClose() 因为语句关闭而引发 IllegalAccess 异常？

> ID：12462435
> 
> 赞同：1
> 
> 时间：2012-09-17T15:26:08.337
> 
> 标签：java, database, jdbc

我有下面的代码。相当标准的东西。但是，我在 if(!stmt.isClose()) 行上遇到非法访问异常......该错误表明这是因为该语句已关闭。这不是该方法调用的重点吗？有人对此有什么想法吗？

```
Connection conn = dataSource.getConnection();
conn.setAutoCommit(false);
Statement stmt = conn.createStatement();
try {
    stmt.executeUpdate(updateQuery1);
    stmt.executeUpdate(updateQuery2);
    stmt.executeUpdate(updateQuery3);
    conn.commit();
    try {
        if (!stmt.isClosed()) {
            stmt.close();
        }
        if (!conn.isClosed()) {
            conn.close();
        }
    } catch (Throwable ignored) {
} catch(Throwable ignored) {
} 
```

`499285 java.lang.IllegalAccessError: org.apache.tomcat.dbcp.dbcp.DelegatingStatement.isClosed()Z 499286 at com.millennialmedia.enterprise.services.impl.CampaignUtilServiceImpl.resetExceptionCampaign(CampaignUtilServiceImpl.java:80) 499287 at com.millennialmedia.rest.services.CampaignUtilRESTService$1.process(CampaignUtilRESTService.java:55) 499288 at com.millennialmedia.rest.services.CampaignUtilRESTService$1.process(CampaignUtilRESTService.java:49) 499289 at com.millennialmedia.services.util.Processor.doProcess(Processor.java:98) 499290 at com.millennialmedia.rest.services.CampaignUtilRESTService.resetExceptionCampaign(CampaignUtilRESTService.java:49) 499291 at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 499292 at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 499293 at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) 499294 at java.lang.reflect.Method.invoke(Method.java:597) 499295 at com.sun.jersey.spi.container.JavaMethodInvokerFactory$1.invoke(JavaMethodInvokerFactory.java:60) 499296 at com.sun.jersey.server.impl.model.method.dispatch.AbstractResourceMethodDispatchProvider$ResponseOutInvoker._dispatch(AbstractResourceMethodDispatchPro 499297 at com.sun.jersey.server.impl.model.method.dispatch.ResourceJavaMethodDispatcher.dispatch(ResourceJavaMethodDispatcher.java:75) 499298 at com.sun.jersey.server.impl.uri.rules.HttpMethodRule.accept(HttpMethodRule.java:288) 499299 at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147) 499300 at com.sun.jersey.server.impl.uri.rules.ResourceClassRule.accept(ResourceClassRule.java:108) 499301 at com.sun.jersey.server.impl.uri.rules.RightHandPathRule.accept(RightHandPathRule.java:147) 499302 at com.sun.jersey.server.impl.uri.rules.RootResourceClassesRule.accept(RootResourceClassesRule.java:84) 499303 at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1469) 499304 at com.sun.jersey.server.impl.application.WebApplicationImpl._handleRequest(WebApplicationImpl.java:1400) 499305 at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1349) 499306 at com.sun.jersey.server.impl.application.WebApplicationImpl.handleRequest(WebApplicationImpl.java:1339) 499307 at com.sun.jersey.spi.container.servlet.WebComponent.service(WebComponent.java:416) 499308 at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:537) 499309 at com.sun.jersey.spi.container.servlet.ServletContainer.service(ServletContainer.java:699) 499310 at javax.servlet.http.HttpServlet.service(HttpServlet.java:717) 499311 at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290) 499312 at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 499313 at com.millennialmedia.instrumentation.MethodInvocationFilter._doFilter(MethodInvocationFilter.java:20) 499314 at com.millennialmedia.instrumentation.MethodInvocationFilter.doFilter(MethodInvocationFilter.java:31) 499315 at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) 499316 at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 499317 at com.millennialmedia.session.BaseAuthenticatedUserFilter.doFilter(BaseAuthenticatedUserFilter.java:249) 499318 at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) 499319 at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 499320 at com.millennialmedia.session.HibernateSessionRequestFilter.doFilter(HibernateSessionRequestFilter.java:57) 499321 at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235) 499322 at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206) 499323 at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233) 499324 at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191) 499325 at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:433) 499326 at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128) 499327 at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) 499328 at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) 499329 at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286) 499330 at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:845) 499331 at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T10:04:33.920

我知道这篇文章已经过时了，但是由于我今天遇到了这个问题，我想我可以抽出一些时间。您收到此错误的原因是您使用的是 Java 6 之前（和 JDBC-4 之前）的 Tomcat 版本，其中

```
java.sql.Statement.isClosed() 
```

不是接口**的**一部分：

[http://docs.oracle.com/javase/1.5.0/docs/api/java/sql/Statement.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/sql/Statement.html)

但在 Java 6 中，它是：

[http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#isClosed%28%29](http://docs.oracle.com/javase/6/docs/api/java/sql/Statement.html#isClosed%28%29)

在此处查看 isClosed() 的方法可见性

[http://www.jarvana.com/jarvana/view/org/apache/tomcat/dbcp/6.0.20/dbcp-6.0.20.jar!/org/apache/tomcat/dbcp/dbcp/DelegatingStatement.class?classDetails =好的](http://www.jarvana.com/jarvana/view/org/apache/tomcat/dbcp/6.0.20/dbcp-6.0.20.jar!/org/apache/tomcat/dbcp/dbcp/DelegatingStatement.class?classDetails=ok)

与这里：

[http://www.jarvana.com/jarvana/view/org/apache/tomcat/tomcat-dbcp/7.0.23/tomcat-dbcp-7.0.23.jar!/org/apache/tomcat/dbcp/dbcp/DelegatingStatement .class?classDetails=ok](http://www.jarvana.com/jarvana/view/org/apache/tomcat/tomcat-dbcp/7.0.23/tomcat-dbcp-7.0.23.jar!/org/apache/tomcat/dbcp/dbcp/DelegatingStatement.class?classDetails=ok)

当前 DelegatingStatement 的 isClose() 的评论说：

```
/*
* Note was protected prior to JDBC 4
* TODO Consider adding build flags to make this protected unless we are
*      using JDBC 4.
*/
public boolean isClosed() throws SQLException {
    return _closed;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:50:58.043

我不明白你为什么还要测试它。该语句此时不可能关闭，所以不要测试它，只需关闭它。同上连接。事实上，如果已经关闭，这两种关闭方法都被指定为不执行任何操作。

不要给百合镀金。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-14T17:48:37.217

问题是由于您的数据源为您提供的 PreparedStatement 的实现。如果您查看您提供的跟踪，您可以看到：

**499285 java.lang.IllegalAccessError：org.apache.tomcat.dbcp.dbcp.DelegatingStatement.isClosed()Z**

这意味着您使用的 PreparedStatement 的实现是类 org.apache.tomcat.dbcp.dbcp.DelegatingStatement 的实例。如果您查看[1.2.2](https://commons.apache.org/proper/commons-dbcp/api-1.2.2/org/apache/commons/dbcp/DelegatingStatement.html#isClosed())版本，方法**isClosed()**受到保护，因此任何访问此方法的尝试都会导致 java.lang.IllegalAccessError。该库的其他版本（1.3 及更高版本）将此修饰符公开，因此您只需更改库版本即可解决此问题。

# c# - 如何在特定时间通过 C# 运行 SQL 存储过程？

> ID：12462447
> 
> 赞同：0
> 
> 时间：2012-09-17T15:26:49.400
> 
> 标签：c#, sql, tsql, stored-procedures

我现在正在为图书馆建立一个网站，我需要每天同时检查是否有人需要在接下来的五天内还书并通过电子邮件向他们发送提醒。

我的问题是正确的方法是什么？

我需要完成的是，当一天中的特定时间到来时，我需要运行一个 sql 存储过程，并通过 Visual Studio 2010 或任何其他方式检查存储过程是否返回了我需要通过电子邮件发送的任何结果。

有没有办法在 C# 上不断检查系统时间而不是作为触发事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:31:12.813

我想最简单的方法是在 SQL Server 代理中创建一个新作业来每天调用您的存储过程，而不是尝试在您编写的应用程序中实现这一点。

[有关创建 SQL 作业](http://msdn.microsoft.com/en-us/library/ms190268.aspx)的更多信息，请参阅以下链接

编辑 -**对不起**，我真的不应该在做其他工作的同时尝试回答 SO 帖子。我完全错过了你想发送电子邮件的事实，并让我想到你想在屏幕上报告逾期记录。呃。

要在每天的某个时间发送过期的电子邮件，我猜 Windows 服务肯定会完成这项工作，但似乎有点过头了，你需要完全控制它运行的服务器。

您可以改为设置一个计划任务来每天调用一个 sendOverdueMail.aspx 网页来完成这项工作？[像这样](https://stackoverflow.com/questions/1987345/recommended-method-for-loading-a-url-via-a-scheduled-task-on-windows)

显然也有 SQL Server 代理电子邮件选项，尽管我不确定您对将产生的电子邮件格式有多少控制权。

最后，[本教程](http://www.codeproject.com/Articles/12117/Simulate-a-Windows-Service-using-ASP-NET-to-run-sc)通过挂钩到 ASP.net 服务器上的缓存到期事件，逐步创建计划任务类型效果，然后允许您调用电子邮件代码。

```
private const string DummyCacheItemKey = "GagaGuguGigi";
protected void Application_Start(Object sender, EventArgs e)
{
    RegisterCacheEntry();
}

private bool RegisterCacheEntry()
{ 
    if( null != HttpContext.Current.Cache[ DummyCacheItemKey ] ) return false;

        HttpContext.Current.Cache.Add( DummyCacheItemKey, "Test", null, 
        DateTime.MaxValue, TimeSpan.FromMinutes(1), 
        CacheItemPriority.Normal,
        new CacheItemRemovedCallback( CacheItemRemovedCallback ) );

    return true;
}

public void CacheItemRemovedCallback( string key, 
        object value, CacheItemRemovedReason reason)
{
    Debug.WriteLine("Cache item callback: " + DateTime.Now.ToString() );

    // send reminder emails here
    DoWork();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:33:03.427

要比较日期，请使用 T-SQL 中的 DATEDIFF 函数。例如，您有一个表，其中包含行 ID、书名、学生姓名、借阅日期和到期日期。借用日期和到期日期都有 DateTime 类型。

查询 x 天到期的书籍；根据您的规范，这是 5 天，这样查询

从 dbo.Borrowers WHERE DATEDIFF(day, DateBorrowed, DueDate) >= 5 中选择 RowID、BookName、StudentName、DateBorrowed、DueDate

这将查询所有到期提醒的书籍。

然后使用 SQL 查询作业触发将附加到另一个表的操作，该表将包含需要提醒的学生的电子邮件列表。可以从将使用该列表作为电子邮件队列的 Windows 服务读取此表。或者，您可以将 SQL 配置为直接发送电子邮件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:42:23.270

使用windows计划任务调用网站页面，该页面执行运行存储过程和发送邮件的任务。

尽管 C# 中没有特定的方法可以为您提供这样的结果。

如果您无权访问计划任务或无法运行 Windows 服务，即您拥有共享主机，则还有另一种选择。

有一些服务可用于监控我们网站的正常运行时间。他们定期提出要求。您可以使用此请求来完成您的任务。这里给出的一些链接

[网站正常运行时间](http://www.siteuptime.com/)

[王国](https://www.pingdom.com/)

我已经多次使用它们，它们非常可靠。最重要的是，它们不要求您具有系统管理员访问权限来执行计划任务。

# javascript - Javascript拖放同一对象的多个实例

> ID：12462451
> 
> 赞同：2
> 
> 时间：2012-09-17T15:27:00.303
> 
> 标签：javascript, drag-and-drop

我想开发一个 javascript 拖放应用程序，就像您[在这里](http://www.compago.it/ajax/ID-48149.HeadA.Hack_54.html)看到的那样，您可以在其中选择和对象并将其拖动到另一个区域。但我想用一个转折来做到这一点。我希望能够多次拖动同一个对象，而不是将对象从书架移动到篮子，我想将对象的一个​​实例拖到书架上并且仍然在书架上保留对象。

这就像购买同一个对象的多个实例，每次我将对象从书架拖到篮子时，我都会将该对象的另一个实例添加到篮子中。

关于如何实现这种效果的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T15:32:33.013

您执行与常规拖放相同的操作，但不是删除拖动的对象，而是克隆它。

实现拖放有点棘手，像 jQuery 这样的库确实可以为您节省大量时间和精力。[jQuery UI 的 draggable](http://jqueryui.com/demos/draggable/)有一个`helper: clone`选项可以将拖动的对象留在原地，而是克隆它。然后，当使用[jQuery UI Droppable](http://jqueryui.com/demos/droppable/)定义放置区域时，您可以对放置的元素做任何您想做的事情，例如创建一个代表篮子项目的新元素，而拖动的项目保持不变。因此，如果使用 jQuery 是一种选择，那根本不难做到。

**[更新：这是一个快速演示](http://jsfiddle.net/QGdCv/)**

HTML

```
<div id="list">
    <div class="productItem">product 1</div>
    <div class="productItem">product 2</div>
    <div class="productItem">product 3</div>
</div>

<div id="basket">
</div>​ 
```

JS

```
$(".productItem").draggable({
    helper: 'clone',
    handle: "productItem"
});

$("#basket").droppable({
    accept: ".productItem",
    drop: function(event, ui){
        $("<div></div>")
            .html(ui.draggable.text())
            .appendTo($(this));
    }
}); 
```

​</p>

# c# - 我可以将 Neo4J 查询结果作为图表返回吗？

> ID：12462452
> 
> 赞同：1
> 
> 时间：2012-09-17T15:27:11.473
> 
> 标签：c#, neo4j

我正在使用 Neo4j 为我的组织进行概念验证。例如，我选择对公司管理层次结构（谁管理谁，谁由 X 管理等）进行建模。看起来它在图表中效果很好，但我找不到任何方法以我想要显示的方式从 Neo4j 中取回数据。

我需要的查询是：**告诉我向 X 汇报的每个人，一直向下。**这意味着，每个直接向 X 报告的人以及向他们报告的任何人等。

我看到我可以在 Cypher 中做到这一点，但它会返回一个扁平的 2d 结果。但这不是很有帮助，因为它没有描述结果的管理结构。

看来我真正想要的是一个人的图表。这可以在不对每个管理级别进行查询的情况下完成吗？

我正在使用 C# Neo4JClient，但此时我对任何解决方案都感兴趣。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T23:44:13.710

您可以将所有路径返回到`X`结构的根目录。

```
start x=node:people(name='foo')
match path = x<-[:REPORTS_TO*]-person
return path 
```

您还可以在路径集合上返回`nodes(path)`或`rels(path)`使用任何表达式`filter`,或谓词, `length`, 。`extract``ALL``ANY``SINGLE``NONE`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-26T11:27:03.910

这是我提取树的解决方案：

注意：此解决方案适用于我的项目，但我必须针对您的问题对其进行更改，因为我们还有一些其他不必要的限制。

找到所有要提取的根实体后，

```
With entity as rootEntity 
```

我已将这些匹配项添加到查询中：

```
match
    rootEntity-[*0..]->subEntity, 
    parentEntity-->subEntity 
```

这在哪里：

```
where rootEntity = subEntity or (rootEntity-[*0..]->parentEntity) 
```

然后，我返回（不同）数据如下：

```
id(rootEntity), 
id(parentEntity),
id(entity),
subEntity 
```

其余的解决方案是 C#：

首先需要一些数据修复，因为 NEO4J 将多次返回根实体（每个传入关系一个）：

```
results.ForEach(
        x =>
        {
            if (x.Id == x.RootId)
                x.ParentId = 0;
        }); 
```

并按 ID 区分：

```
results =
    results
    .GroupBy(x => x.Id)
    .Select(x => x.First())
    .ToList(); 
```

然后，我们可以构建树：

```
 ....
    var trees = results
        .GroupBy(x => x.RootId)
        .Select(singleTreeEntities => GenerateSingleEntity(singleTreeEntities.Key, singleTreeEntities))

    return trees;
}

private Entity GenerateSingleEntity(long id, IEnumerable<Entities> treeEntities)
{
    var currEntity = treeEntities.SingleOrDefault(x => x.Id == id);

    return new Entity
    {
        Id = id,
        SomeData = currEntity.SubEntity.SomeData,
        SomeOtherData = currEntity.SubEntity.SomeOtherData,
        ChildEntities =
            treeEntities
                .Where(x => x.ParentId == id)
                .Select(x => GenerateSingleEntity(x.Id, treeEntities)))
    };
} 
```

# php - 将谷歌地图 v2 转换为谷歌地图 v3

> ID：12462453
> 
> 赞同：1
> 
> 时间：2012-09-17T15:27:15.733
> 
> 标签：php, mysql, google-maps

我的网站目前正在运行 Google 地图 API v2。我想转换为新的 Google 地图 API v3。下面的代码需要做哪些修改？最近我收到一条消息，说 v2 已禁用。所以我需要用当前的功能修改现有的脚本。

```
 <?php
include ("includes/config.php");
$z=0;
$fcontent='

var maprecent;
function init_maprecent() {
function createMarker(point, myHtml) { var marker = new GMarker(point); GEvent.addListener(marker, "click", function() { maprecent.openInfoWindowHtml(point, myHtml, {maxWidth:200}); }); return marker; }
var markerindex = 0; var markers = new Array();
function animate_marker() {if (markerindex==markers.length) {markerindex=0;} GEvent.trigger(markers[markerindex], "click"); markerindex++; setTimeout(animate_marker, 5000);}
var bottomLeft = new GControlPosition(G_ANCHOR_BOTTOM_LEFT);
maprecent = new GMap2(document.getElementById("smallmaprecent"));
maprecent.addControl(new GSmallZoomControl());
maprecent.addControl(new GMapTypeControl(), bottomLeft);
maprecent.setCenter(new GLatLng(34.051072,-118.259961), 5);
';

$db = mysql_connect($config['DB_Host'], $config['DB_User'],$config['DB_Passwd']);
mysql_select_db($config['DB_Name'],$db);
$result = mysql_query("SELECT * from project_master  WHERE location != '' ORDER BY project_id",$db);
while ($myrow = mysql_fetch_row($result)) {
    $ce=$myrow[6];
    $linkid=$myrow[0];
    $link1=str_replace(" ","-",$ce);
    $link2=strtolower($link1);
$zipcode="$myrow[29]";

     $cine=$myrow[1];
     $result2 = mysql_query("SELECT mem_address,mem_zip_code from member_master WHERE user_login_id='$cine' LIMIT 1",$db);
while ($myrow2 = mysql_fetch_row($result2)) {
     //$zipcode="$myrow2[0]";
}

   $result2 = '';

for ($i=0; $i<strlen($link2); $i++) {
if (preg_match('([0-9]|[a-z]|_|-)', $link2[$i])) {
$result2 = $result2 . $link2[$i];
}
}
$finallink=$result2;
$mainlink="http://abcd.com/project_".$linkid."_".$finallink.".html";

$cine=$myrow[1];
//print "$cine $zipcode $ce $mainlink<br>";

//print "Zipcode $zipcode";

$longitude = "";
$latitude = "";
$precision = "";

//Three parts to the querystring: q is address, output is the format (
$key = "";
$address = urlencode("$zipcode");
$url = "http://maps.google.com/maps/geo?q=".$address."&output=json&key=".$key;

$ch = curl_init();

curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HEADER,0);
curl_setopt($ch, CURLOPT_USERAGENT, $_SERVER["HTTP_USER_AGENT"]);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

$data = curl_exec($ch);
curl_close($ch);

$geo_json = json_decode($data, true);

//print_r($geo_json);

if ($geo_json['Status']['code'] == '200') {

$precision = $geo_json['Placemark'][0]['AddressDetails']['Accuracy'];
$latitude = $geo_json['Placemark'][0]['Point']['coordinates'][0];
$longitude = $geo_json['Placemark'][0]['Point']['coordinates'][1];

//echo "Precision: $precision \n";
//echo "Latutide: $latitude \n";
//echo "Longitude: $longitude \n";

} else {
//echo "Error in geocoding! Http error ".substr($data,0,3);
}

$zipcode=stripslashes($zipcode);
$zipcode=substr($zipcode,0,30);

if ($longitude!="")
{

$fcontent.= "

var m$z = createMarker(new GLatLng($longitude,$latitude), '<b>$ce</b><br>$cine<br><a href=$mainlink>View project</a><br>$zipcode  ');
maprecent.addOverlay(m$z);
markers.push(m$z);
maprecent.addOverlay(new GPolygon([new GLatLng($longitude,$latitude), new GLatLng($longitude,$latitude), new GLatLng($longitude,$latitude), new GLatLng($longitude,$latitude), new GLatLng($longitude,$latitude)], \"#000000\", 1, 0.5, \"#444488\", 0.1));
";
$z++;
}

}

$fcontent.="animate_marker();
}";
//print $fcontent;
$fcontent=trim($fcontent);
$myFile = "recent.js";
$fh = fopen($myFile, 'w') or die("can't open file");
fwrite($fh, $fcontent);
fclose($fh);

?>

var maprecent;
function init_maprecent() {
function createMarker(point, myHtml) { var marker = new GMarker(point); GEvent.addListener(marker, "click", function() { maprecent.openInfoWindowHtml(point, myHtml, {maxWidth:200}); }); return marker; }
var markerindex = 0; var markers = new Array();
function animate_marker() {if (markerindex==markers.length) {markerindex=0;} GEvent.trigger(markers[markerindex], "click"); markerindex++; setTimeout(animate_marker, 5000);}
var bottomLeft = new GControlPosition(G_ANCHOR_BOTTOM_LEFT);
maprecent = new google.maps.Map(document.getElementById("smallmaprecent"));
maprecent.addControl(new GSmallZoomControl());
maprecent.addControl(new GMapTypeControl(), bottomLeft);
maprecent.setCenter(new GLatLng(34.051072,-118.259961), 5);

var m0 = createMarker(new GLatLng(34.016919,-118.5010608), '<b>test</b><br>demo<br><a href=http://www.abcd.com/project_47_test.html>View project</a><br>London   ');
maprecent.addOverlay(m0);
markers.push(m0);
maprecent.addOverlay(new GPolygon([new GLatLng(34.016919,-118.5010608), new GLatLng(34.016919,-118.5010608), new GLatLng(34.016919,-118.5010608), new GLatLng(34.016919,-118.5010608), new GLatLng(34.016919,-118.5010608)], "#000000", 1, 0.5, "#444488", 0.1));
animate_marker();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:33:43.253

这不是一个真正的问题。阅读[文档](https://developers.google.com/maps/documentation/javascript)并重写您的代码。我想没有人愿意做你的工作。如果您在重写后仍有问题，您可以回来问一个问题，为什么您的应用程序没有与以前相同的行为。

# url-rewriting - 使用 Lighttpd 将 IP 地址添加到“GET”请求

> ID：12462455
> 
> 赞同：0
> 
> 时间：2012-09-17T15:27:27.963
> 
> 标签：url-rewriting, lighttpd

使用 mod_rewite，我想将发出请求的 IP 地址作为“GET”参数发送到我的目的地，例如

```
rewrite-once = (".*" => ".*?ip=$HTTP[remoteip]") 
```

我试过用`%a`, `%h`, `".*?ip=" + $HTTP[remoteip]`.

有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T19:11:53.880

试试这个配置：

```
$HTTP["remoteip"] =~ "^(.*)$" {
    url.rewrite-once = ("^(.*)$" => "$1?ip=%1")
} 
```

您可以使用`%`反向引用来替换条件中的匹配项。

# ffmpeg - 循环图像ffmpeg HLS

> ID：12462456
> 
> 赞同：3
> 
> 时间：2012-09-17T15:27:29.023
> 
> 标签：ffmpeg, http-live-streaming

尝试循环图像以获得分段的 HLS 输出。

```
ffmpeg -loop 1 -i image.png -vcodec libx264 -acodec aac -map 0 -f segment -segment_time 5 -segment_list /seg.m3u8  /200_%06d.ts

  Metadata:
    encoder         : Lavf54.26.101
    Stream #0:0: Video: h264, yuv444p, 1344x840, q=-1--1, 90k tbn, 25 tbc
Stream mapping:
  Stream #0:0 -> #0:0 (png -> libx264)
Press [q] to stop, [?] for help
Failed to open bitstream filter h264_mp4toannexb for stream 0 with codec libx264: Invalid argument
[mpegts @ 0x7fe91a615600] H.264 bitstream malformed, no startcode found, use the h264_mp4toannexb bitstream filter (-bsf h264_mp4toannexb)
av_interleaved_write_frame(): Invalid argument 
```

添加过滤器似乎没有帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-20T20:37:28.990

如错误消息中所示（但未真正解释），将 h.264 视频数据转换为 MPEG2 传输流时存在问题。在默认的 h.264 容器 (MPEG4) 中，事物是以长度为前缀的，而在 MPEG2 传输流中，则使用起始码。映射在 h.264 规范的附件中进行了描述，即提到的附件 2。文档：[http ://git.videolan.org/?p=ffmpeg.git;a=blob;f=doc/bitstream_filters.texi](http://git.videolan.org/?p=ffmpeg.git;a=blob;f=doc/bitstream_filters.texi)

因此，要正确创建 MPEG2 TS，您需要添加`-vbsf h264_mp4toannexb`到命令行。您可能还需要添加以下参数`-flags -global_header`。这是为了确保某些编解码器参数包含在带内（在传输流中）。

# programming-languages - 学习 Ada 而不是其他语言 [c++, c#] 值得吗？

> ID：12462461
> 
> 赞同：21
> 
> 时间：2012-09-17T15:27:43.987
> 
> 标签：programming-languages, ada, robotics

如果我要制作机器人，你推荐我哪种语言？在我们的大学里，我们可以选择多种语言。大多数学生选择Ada只是因为我们的老师使用它。

经过一番研究，我发现 ada 是旧的。你怎么认为？值得学习吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-09-18T02:23:19.630

是的。非常如此，在我看来。

Ada 在其他编程语言中经常被忽视的两点非常出色：

*   通用系统：包、函数和过程都可以是通用的。这对于根深蒂固的 DRY [ `Don't Repeat Yourself`] 原则特别有效。是的，你*可以*过度使用泛型，但我在（其他语言）项目中看到的是剪切和粘贴编程似乎更常见。[如果需要在该代码点修复错误，那只会引入多个故障点。]
*   原生多任务处理。语言级任务处理功能的一大优点是多线程不会让人觉得“粘在上面”，也不是笨拙的扩展，而是集成到语言中。

也就是说，学习/使用 Ada 还有其他充分的理由。一个是挑剔的编译器，由于如此挑剔，它迫使你开始以自然减少编程错误的方式思考。（就像禁止`and`和`or`在同一个条件。）

另一个是子类型的概念；子类型与 OOP 中的对象相反，不是扩展您进行的进一步的衍生，而是缩小类型（它是可接受的值），您越远离基本类型。{用适当的集合来考虑它；Integer 是您的基本类型，Natural 是您的非负整数，Positive 是您的正整数......并且使用 Ada 2012，您可以对您的子类型进行有趣的排除，例如 Primes 是 Positives 的子类型（对不起最后一点有点含糊；我还在学习 2012 年的东西）。}

使用 Ada 2012，您还可以在子程序上设置前置条件和后置条件；仅此一项就可以使您的库更加稳定。（与空排除指针一样。）

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-09-18T00:02:19.837

Peter Norvig 的建议可能与此相关：

> 当被问到“我应该使用什么操作系统，Windows、Unix 还是 Mac？”时，我的回答通常是：“使用你朋友使用的任何操作系统。” 你从朋友那里学到的优势将抵消操作系统之间或编程语言之间的任何内在差异。

[十年自学编程](http://norvig.com/21-days.html)

整篇文章很好读。

顺便说一句，Ada 是我学习的第一门语言。学习 Ada 首先有一个主要优势：没有人使用 Ada，所以我被迫在做任何其他事情之前学习另一种语言，从而获得洞察力。初级程序员可能遇到的最糟糕的问题之一是认为用他们的第一语言完成事情的方式就是完成事情的方式。学习一门新语言很容易，而且非常有价值。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-09-18T07:59:20.807

如果您的老师和大多数同学都使用 Ada，那么最好使用 Ada。它是一种非常好的语言，适用于小型和大型程序。它非常易读，它（在某种程度上）保护你免受许多常见错误的影响。

Ada 用于软件*工程*。正如 darkestkhan 所说，这不是一种“黑客和希望最好的”语言。

Paul Stansifer 的建议非常好：学习几种语言。确保您有大量工具可供使用——不要将自己限制在一种语言上。你从学习不同的语言中获得的观点是非常有价值的。给猫剥皮的方法肯定不止一种——比如看看 Haskell。您将获得关于如何解决问题的全新视角。

语言语法是学习如何编程的最少部分。困难的部分是学习如何将复杂的现实世界问题建模成在非常有限的编程语言范围内有意义的东西。凭借其强大的类型系统、任务模型、泛型和用于实时和并发编程的可靠工具，Ada 非常适合这项工作。

由于您要专门询问机器人技术，因此一本好书可能是 John W. McCormick、Frank Singhoff 和 Jerome Hugues 的“Building Parallel, Embedded, and Real-Time Applications with Ada”。这是一本非常好的读物。

[http://www.cambridge.org/gb/knowledge/isbn/item5659578/?site_locale=en_GB](http://www.cambridge.org/gb/knowledge/isbn/item5659578/?site_locale=en_GB)

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-09-18T05:00:25.133

艾达绝对值得。除了 Shark8 写的两件事之外，还必须补充一点，几乎所有的语言都专注于写作而不是阅读的容易性（而且大多数情况下你会写一次，读很多次）。此外，围绕 Ada 的文化与主流文化完全不同——专注于程序的正确工作和源代码的可读性，而不是“破解并使其工作，同时指望运气不会引入错误”。

至于年龄 - 哦，拜托 - C 甚至更老。语言时代本身有什么如此重要？在谈论年龄问题之前，您应该先看看 Ada 83 中的内容（提示：主流语言在 90 年代后半期开始达到 Ada 83 的功能集，许多功能 [特别是子类型] 仍然没有主流）。除了最新的 Ada 标准是从 2012 年开始的 - 如果你可以称之为旧的，那么我不知道什么是“新的”。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-09-18T14:01:19.347

C++ 并不完全是你所知道的春鸡。我认为这一切都比艾达年轻十岁。

更糟糕的是，C++ 和 C# 都从 C 中派生出它们语言的核心，而 C 实际上比 Ada*早了十年。*

在 16KB 是很多 RAM 并且硬盘驱动器与工业空调一样大的时代，C 旨在使编译器的构建更容易（*而不是程序员的工作）。*C++ 基本上是从 60 年代后期的 C 语言开始的，带有 OO 特性，而 C# 本质上是微软对 C++ 的调整，使其更像 Java。**从本质上讲，C# 和 C++ 实际上比 Ada 更老。**

有很多时髦的新语言需要学习（在某些时候你应该学习它们）。但是，C++ 和 C# 不是它们。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-09-22T00:30:01.887

虽然 Shark8 对 Ada 作为一门语言有一些非常好的观点，但这个问题专门针对机器人技术。在这方面，我会说“不要打扰”。在从事从乐高到最先进的机器人手臂和手等各种机器人技术的 10 多年经验之后，我从未见过使用 Ada 的机器人系统。

归根结底，机器人技术很难。如此之难，以至于您无法独自解决所有问题。这意味着要利用大量现有的库和框架。这意味着您将使用他们的语言、界面等。您的机器人系统可能包含大量代码，其中只有一小部分是为您的特定应用程序定制的。虽然可以在 Ada 中编写您的小部分并做一些包装器或接口，以便它可以与其余代码配合使用。但我想你会发现这是一项工作量很大却收效甚微的工作。

在开始一个新的机器人项目时，我采取务实的方法。我查看现有的工具、库和实用程序，然后选择最适合我需要的一种。然后我使用它使用的任何语言。95% 的时间是 C++ 或 Python。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2020-02-10T23:52:50.717

与大多数其他语言相比，Ada 更注重工程。与普通的编程语言不同，Ada 提供了强大的数据工程能力。也就是说，在 Ada 开发人员甚至开始开发算法之前，她/他就设计（工程）数据。

Ada 类型模型允许设计精确的数据。一个简单的例子是：类型 Channel 是范围 1..135；

这里整数数据类型的每个实例都属于该预先约束的值范围。这极大地简化了使用此类实例的算法。

基本原则是，当数据被精确地设计时，相关的算法就会变得不那么复杂。此功能在其他语言中很少见。在 Ada 中，这是常见的做法。

通过支持将数据工程这一概念作为整个软件工程过程的子集，我们可以显着降低整体软件设计的圈复杂度。

我的示例只是对 Ada 中全方位数据工程能力的一个小尝试。然而，正是这种数据工程能力使其成为安全关键型软件的理想选择，在这个 21 世纪的软件环境中，这是它现在最常用的利基市场。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-09-17T15:30:57.467

这取决于你想用这种语言做什么。Lisp 甚至比 Ada 还要古老，并且在人工智能中被广泛使用。学你想学的语言，学你容易学的语言，容易理解它的概念。然后你可以走得更远，学习更多的语言。

# android - 将我的arraylist中的对象转换为android中的字符串数组

> ID：12462463
> 
> 赞同：-1
> 
> 时间：2012-09-17T15:27:47.043
> 
> 标签：android, xml, string, object, arraylist

我正在使用 XML 解析器，结果我的`ArrayList`对象得到了一个：

```
ArrayList <Datapoint> itemsList = parseXML(); 
```

一个 Datapoint 对象由以下字符串组成：

```
name: a
stateBased: b
mainNumber: c
dptID: d
groupadress: e
priority: f 
```

我已经能够使用以下代码显示所有对象：

```
for(int i=0;i<itemsList.size();i++)
{
    item = itemsList.get(i);
    parsedData = parsedData + "----->\n";
    String name = parsedData + "Name: " + item.getName() + "\n";
    String stateBased = parsedData + "stateBased: " + item.getStateBased() + "\n";
    String mainNumber = parsedData + "mainNumber: " + item.getMainNumber() + "\n";
    String dptID = parsedData + "dptID: "+ item.getDptID() + "\n";
    String groupadress = parsedData + "Groupadress: "+ item.getGroupadress() + "\n";
    String priority = parsedData + "priority: "+ item.getPriority() + "\n";
} 
```

例如，将 5 个字符串数组作为我的 ArrayList 中的一个对象，包括上面显示的字符串，那就太好了。

```
String [] Object 1 = {name = a, stateBased = b, dptID =c, ..}
String [] Object 2 = {name = d, stateBased = e, dptID =f, ..}
String [] Object 3 = {name = g, stateBased = h, dptID =i, ..} 
```

但是我如何以编程方式在每次迭代中创建一个 StringArray 呢？像这样的东西：

```
for(int i=0;i<itemsList.size();i++)
{
    item = itemsList.get(i);
    String [] [i] = new String [itemsList.size()];
    //insert strings to the array
} 
```

我怎样才能意识到这一点或有什么替代方案？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T09:03:38.300

我可以使用以下代码解决问题：

```
ArrayList <Datapoint> itemsList = parseXML();
String[itemsList.size()][4] = new String();

for(int i=0;i<itemsList.size();i++)
{
     item = itemsList.get(i);      
     String [i] [0] = item.getName();
     String [i] [1] = item.getStateBased();
     String [i] [2] = item.getMainNumber();
     String [i] [3] = item.getGroupadress();
     String [i] [4] = item.getPriority();
} 
```

并且`private static String[][] String = null;`被定义为全局变量。

# mysql - 表列是否会增加 select 语句的执行时间

> ID：12462465
> 
> 赞同：1
> 
> 时间：2012-09-17T15:27:55.217
> 
> 标签：mysql, performance

我有 2 个表，相同的结构，相同的行，相同的数据，但第一个有更多的列（字段）。

例如：

我从它们中选择相同的 3 个字段（从 mytable1 中选择 a、b、c，然后从 mytable2 中选择 a、b、c）

我试图对 100,000 条记录（每个表）运行这些查询，但最后我得到了相同的执行时间（0.0006 秒）你知道列数（以及最后一张表的大小）吗比另一个大）与查询执行时间有关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:32:34.290

从逻辑上讲，它会影响执行时间，如果具有更多列的表上的数据更大，您可能会看到差异。前任。表1：500mb，表2：40mb。性能下降，特别是如果数据集索引不再适合内存。然后磁盘性能介入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:36:03.030

国际海事组织。仅选择正确的列会影响交付时间（从数据库服务器到应用程序服务器）并影响内存，因为应该存储和传输更多数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:42:06.470

在您的示例中，您从表中选择相同的三列。有几种方法我可以想到有额外的列（但不选择它们）会产生很小/没有影响：

1.  如果您选择的所有列都在索引中，MySQL 就不必从磁盘读取底层行。
2.  如果新列是 VARCHAR，我相信页面大小将基本保持不变（因为 VARCHAR 确实是指针）。
3.  如果新列很小（例如，TINYINT 只有 1 个字节）。

一般来说，更窄的表会给你更好的性能。

如果您想尝试一个示例，请加入一些大的 CHAR（不是 VARCHAR），然后在测试查询中选择这些列。我预计情况会更糟。

希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-17T15:29:53.560

它会影响执行时间，但我认为列/行大小的线性增加会产生边际效应。由于 MySQL 仍然必须处理/显示额外的数据，所以它不可能有零效应。

关键点（在我看来）是*只选择您***需要**选择的列和行。

# javascript - 当我创建一个对象数组时，我得到了未定义

> ID：12462472
> 
> 赞同：0
> 
> 时间：2012-09-17T15:28:08.823
> 
> 标签：javascript

我的[代码](http://jsfiddle.net/Hqh3b/)：

```
var listaIDOrdine = new Array();
for (i = 0; i < 10; i++) {
    listaIDOrdine[i] == new CoppiaIDOrdine(1, 1);
    console.log(listaIDOrdine[i]);
}

function CoppiaIDOrdine(id, ordine) {
    this.id = id;
    this.id = ordine;
} 
```

但我得到 10 个未定义的！怎么了？我希望在每个 console.log() 中都有“一对”项目。

也尝试过，`console.log(listaIDOrdine[i].id);`但似乎 id 未定义？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T15:29:45.840

`==`当您应该使用`=`（赋值运算符）时，您正在使用（比较运算符）：

```
listaIDOrdine[i] = new CoppiaIDOrdine(1, 1); 
```

此外，您可以[`Array#push`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/push)改为使用向数组添加元素：

```
listaIDOrdine.push(new CoppiaIDOrdine(1, 1)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:29:53.237

您正在执行相等性检查而不是分配。

# .net - 为什么某些 MSIE 用户代理在从 .NET 应用程序中单击时未向我们显示 .NET？

> ID：12462473
> 
> 赞同：0
> 
> 时间：2012-09-17T15:28:07.650
> 
> 标签：.net, user-agent

我们有一个已部署到某些系统的 .NET 应用程序。我们还有一个 URL，我们假设它仅通过我们的 .NET 应用程序发布，并且在任何其他页面上都不知道。我们正在跟踪带有 MSIE 的用户代理，并将它们发送到文件中。当我们检查文件时，是的，其中大部分在用户代理字符串中都有 .NET。但其中一些没有。例如：

```
Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; BOIE9;ESMX)
Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0)
Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0) 
```

我想我们只能从中得出两个结论。一种是我们假设注册页面可以从网络上的其他链接访问（就像谷歌发现的那样）。另一个是有人用一些工具/插件/扩展更改了他们的用户代理字符串。还有一个可能是某些 IE 版本，即使安装了 .NET，也不会在用户代理中宣布它们的 .NET。

我们向您提出的问题是——是否存在安装 .NET 且 MSIE 在用户代理中的情况，如果我们假设有人没有更改其用户代理字符串，它不会向我们发送 .NET 版本用假字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:14:55.283

微软在下面的链接中指出，从 IE9 开始，他们停止在用户代理中放置 .NET 的功能令牌，因为他们说这会破坏某些 Web 服务器上的功能。

[http://msdn.microsoft.com/en-us/library/ms537503(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/ms537503(v=vs.85).aspx)

...但是正如上面提到的另一位用户，代理和防病毒软件有时也可以更改用户代理字符串，一些插件/插件/扩展也可以。

# java - 命令提示符中行尾的字符

> ID：12462474
> 
> 赞同：0
> 
> 时间：2012-09-17T15:28:12.957
> 
> 标签：java, command-line

我想提示用户输入一个百分比，并且我希望百分比符号在用户键入时位于该提示的末尾。这可能吗？如果有怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:44:12.120

在纯 Java 中，您只能在输入整个like 后才能响应输入。

你可以做的是写类似

```
System.out.print("Enter a percentage:      %\u0008\u0008\u0008\u0008"); 
```

这可能会将光标定位到`:`离开`%`提示之后。这取决于使用的控制台类型。

如果要在键入时获取每个字符或控制其显示方式，则需要使用 GUI 界面，例如 Swing。

# spring - Spring Ehcache：通过像 endDate > now 这样的条件删除条目

> ID：12462475
> 
> 赞同：1
> 
> 时间：2012-09-17T15:28:13.983
> 
> 标签：spring, scala, caching, ehcache, spring-el

我想使用 Spring over Ehcache 提供的注释删除满足条件的条目（例如：删除条目 endDate > now），可能使用 SpEl 表达式。

类似的东西：

```
 @CacheEvict(value = Array("intensities"), condition = "samples.end > now")
 def save(samples: Samples[Intensity]) = {
   ...
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:43:48.157

更高级的驱逐功能特定于底层 Ehcache 实现，因此它们无法通过 Spring 提供的基本抽象进行配置。请参阅部分`28.5.2`和[Spring 文档](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/cache.html)`28.7`中的部分。

`ehcache.xml`您可以在文件中配置 Ehcache 的驱逐行为。虽然与您的代码试图实现的不完全相同，但该`timeToLiveSeconds`属性可能是您正在寻找的那个。有关更多详细信息，请参阅[Ehcache 文档](http://ehcache.org/documentation/configuration/data-life#24283)。

# 更新

再想一想，以下 SpEL 表达式完全符合您的意图，而无需触及 Ehcache 特定设置：

```
@CacheEvict(
    value = Array("intensities"),
    condition = "samples.end.after(new java.util.Date())")
def save(samples: Samples[Intensity]) = {
   ...
} 
```

# ruby-on-rails - 将 RoR 服务器作为守护进程启动会使 File.read 失败

> ID：12462477
> 
> 赞同：0
> 
> 时间：2012-09-17T15:28:21.813
> 
> 标签：ruby-on-rails, daemon

我有一个 RoR 应用程序在服务器正常启动时按预期工作（`rails s`），但是当我将服务器作为守护程序启动时，运行时出现错误`File.read (<filename>)`：

```
Errno::ENOENT (No such file or directory - <filename> 
```

该文件显然存在，因为它在未作为守护程序启动时工作。

我应该如何解决这个问题，以便我可以将开发服务器作为守护进程启动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T19:28:01.593

我想通了-为了使路径正确，我必须这样做：

```
Rails.root.join(<filename>) 
```

然后它起作用了！

# r - R ggplot2 - 简单绘图 - 无法指定对数轴限制

> ID：12462479
> 
> 赞同：5
> 
> 时间：2012-09-17T15:28:24.217
> 
> 标签：r, ggplot2, kernel-density

我正在尝试在 ggplot2 中的 R 中创建一个简单的密度图。这是我的代码，效果很好。

```
d <-  ggplot(result, aes(x=result$baseMeanA)) 
d + geom_density(colour="darkgreen", size=2, fill="darkgreen") + 
scale_x_log10() + scale_y_continuous(limits = c(0, 0.45)) 
```

问题是我无法将 x 轴调整为负数。

```
scale_x_log10(limits= c(1, 10000)) 
```

效果很好，但是

```
scale_x_log10(limits= c(-1, 10000)) 
```

根本不起作用！它给了我这个错误：

> if (zero_range(range)) { 中的错误：需要 TRUE/FALSE 的缺失值

请帮忙！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T18:33:00.880

如果限制的范围应部分低于零，您可以对变量进行 log10 转换并指定连续比例的限制：

```
ggplot(result, aes(x=log10(baseMeanA))) +
   geom_density(colour="darkgreen", size=2, fill="darkgreen") + 
   scale_x_continuous(limits = c(-1, 10000) + 
   scale_y_continuous(limits = c(0, 0.45)) + 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T15:34:09.660

您尝试做的事情没有多大意义，不是吗？负数的对数不是我们可以在 R 中表示的

```
R> log(-1)
[1] NaN
Warning message:
In log(-1) : NaNs produced 
```

那么R应该将轴绘制到哪里？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-12T12:35:23.150

e^y 不能为负数。指数常数 e 是正数，而 y 只是一个指数。根据数学定义：

log(x) = y <==> x = e^y

这正是为什么如果 x 为负，R 无法计算 log(x) 的原因。它只是违背了数学定义。

我希望这有助于理解为什么这个情节给你带来了麻烦。

# git - git push origin 和 git push origin master 有什么区别

> ID：12462481
> 
> 赞同：58
> 
> 时间：2012-09-17T15:28:24.313
> 
> 标签：git, git-push, git-remote

将本地 git 存储库的主分支推送到名为 origin with`git push origin master` 或 with的远程存储库的主分支有什么区别`git push origin`？

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-09-17T16:17:45.653

`git push`和的默认操作自版本`git push origin`以来已更改：`git``1.7.11`

*   之前`1.7.11`，`git push`默认推送所有远程存在的同名分支。

*   因为`1.7.11`，`git push`默认情况下将当前分支推送到同名的远程分支。

在 version 之前和之后`1.7.11`，可以使用`push.default`配置选项配置默认行为。此配置选项已在`git`版本中引入`1.6.3`。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2012-09-17T15:29:51.423

```
git push origin master 
```

这只会将您的主分支推送到原点

```
git push origin 
```

将所有分支推到原点

更新 - 自编写此答案以来，Git 的行为发生了变化。 `git push origin`默认情况下，在 Git >=2.0 上会将当前分支推送到同名的匹配分支，但可以通过以下方式覆盖此行为`git config`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-03-27T13:48:11.197

虽然`git push origin`在 Git >=2.0 上确实默认将当前分支推送到同名的匹配分支，但文档是错误的！
所述文档已使用 Git 2.32（2021 年第二季度，8 年后）修复：

请参阅[Taylor Blau ( ) 的](https://github.com/ttaylorr)[提交 4c8e3dc](https://github.com/git/git/commit/4c8e3dca6eab37c8149160d54a845439d33ce391)（2021 年 3 月 8 日[）](https://github.com/ttaylorr)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 c6617d1](https://github.com/git/git/commit/c6617d1e4f462405e6e237a21026c1cf3b557ec0))^(中，2021 年 3 月 24 日）)[`ttaylorr`](https://github.com/ttaylorr)
^([`gitster`](https://github.com/gitster))

> ## [`Documentation/git-push.txt`](https://github.com/git/git/commit/4c8e3dca6eab37c8149160d54a845439d33ce391): 正确的配置错误
> 
> ^(报告人：Adam Sharafeddine)
> ^(报告人：Fabien Terrani)
> ^(签字人：Taylor Blau)
> ^(审核人：Jonathan Nieder)

> 在“示例”部分中，`git-push`表示 ' [`git push origin`](https://github.com/git/git/blob/4c8e3dca6eab37c8149160d54a845439d33ce391/Documentation/git-push.txt)' ^(( [man](https://git-scm.com/docs/git-push) ))将当前分支推送到 ' `remote.origin.merge`' 配置的值。
> 
> 这个措辞（可以追溯到[b2ed944](https://github.com/git/git/commit/b2ed944af79041b4da151a432064c3b1c1b82fc5)（`push`：switch default from , 2013-01-04, Git v2.0.0-rc0 -- [merge](https://github.com/git/git/commit/009055f3ecd8d9b4eb140429cb5ce5d2088174c7)）（push: switch default from " `matching`" to " `simple`", 2013-01-04)）是不正确。
> 没有' `remote.<name>.merge`'这样的配置。
> 这可能原本打算改为“ `branch.<name>.merge`”。
> 
> 实际上，当 ' `push.default`' 是 ' `simple`' （这是默认值，并且根据“无需额外配置”适用于此场景）时，`setup_push_upstream()`如果分支的本地名称与 ' ' 不匹配，则会死掉`branch.<name>.merge`。
> 
> 更正这个长期存在的错字，以解决最近对该示例预期行为的一些混淆。

`git push`现在在其[手册页](https://github.com/git/git/blob/4c8e3dca6eab37c8149160d54a845439d33ce391/Documentation/git-push.txt#L603)中包含：

> ## `git push origin`：
> 
> 在没有额外配置的情况下，如果当前分支与当前分支同名，则将当前分支推送到配置的上游（`branch.<name>.merge`配置变量），否则会出错而不推送。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-18T03:43:32.920

```
git push origin 
```

git push origin 会将所有本地分支的更改推送到源远程的匹配分支。

```
git push origin master 
```

git push origin master 会将更改从本地 master 分支推送到远程 master 分支。

# tsql - 如何有目的地测试交易中的错误？

> ID：12462482
> 
> 赞同：0
> 
> 时间：2012-09-17T15:28:25.030
> 
> 标签：tsql, sybase

我有一个存储过程，它在一个循环中有几个事务：

```
WHILE @COUNT < @MY_NUM
BEGIN
  BEGIN TRANSACTION
  -- DO STUFF HERE

  IF(@@ERROR != 0)
  BEGIN
    ROLLBACK TRANSACTION
    BREAK
  END

  COMMIT TRANSACTION
END 
```

我现在想通过在一定次数的运行后故意向循环引入错误并查看数据来测试我的逻辑是否有效`ROLLBACK TRANSACTION`。`BREAK`

此外，我从一个 shell 脚本运行这些存储过程。所以，我想通过`Ctrl + C`在运行中间使用来测试。这行得通吗？如果没有，我怎么能故意引入错误？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:52:15.960

您可以执行以下操作之一：

1.  故意导致错误，例如除以零
2.  使用[RaiseError()](http://msdn.microsoft.com/en-us/library/ms178592.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T20:31:29.907

您可以使用`print`：

```
WHILE @COUNT < @MY_NUM
BEGIN
  BEGIN TRANSACTION
  print 'BEGIN TRANSACTION'
  -- DO STUFF HERE
  print '-- DO STUFF HERE'
  IF(@@ERROR != 0)
  BEGIN
    ROLLBACK TRANSACTION
    print 'ROLLBACK TRANSACTION @MY_NUM: %1!',convert(varchar,@MY_NUM)
    BREAK
  END

  COMMIT TRANSACTION
  print 'COMMIT TRANSACTION'
END 
```

[这](http://manuals.sybase.com/onlinebooks/group-as/asg1250e/sqlug/@Generic__BookTextView/40446;pt=40544)是文档的链接。

# sql-server - 如何查找 SQL Server 代理作业中的作业数？

> ID：12462488
> 
> 赞同：0
> 
> 时间：2012-09-17T15:28:39.617
> 
> 标签：sql-server, sql-server-2008

我们是否有办法找到当前 SQL Server 代理中的作业数量和名称。我可以手动计数，但我正在寻找一个脚本来给我数字和名称。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:31:14.657

这将返回`n`行及其名称：

```
SELECT name FROM msdb.dbo.sysjobs; 
```

# java - 如何通过 CLI 客户端获取 jboss 用户列表

> ID：12462491
> 
> 赞同：4
> 
> 时间：2012-09-17T15:28:49.540
> 
> 标签：java, jakarta-ee, jboss, command-line-interface, jboss7.x

我没有在[Management API ref](https://docs.jboss.org/author/display/AS7/Management+API+reference)或[CLI guide](https://community.jboss.org/wiki/CommandLineInterface)中找到任何合适的东西。

我对检索管理领域用户的猜测是

```
ls core-service=management/security-realm=ManagementRealm/authentication=properties 
```

但它什么也不返回。我确实有一个管理用户。

我正在使用 Jboss-7.1.1.Final

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-02T11:51:37.247

如果您的用户存储在属性文件中，则无法使用管理界面获取他们的列表。

添加身份管理操作（包括列出和修改用户）将在以后的版本中考虑。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-10-21T11:01:49.903

用记事本打开以下文件，找到用户列表：

```
$HOME_wildfly-Final\standalone\configuration\mgmt-groups.properties 
```

# python-2.7 - 测试 python 配方

> ID：12462494
> 
> 赞同：0
> 
> 时间：2012-09-17T15:29:07.573
> 
> 标签：python-2.7

我想运行我找到的 python 配方，但我不知道它是如何从另一个导入的！例如，我想[在这里测试代码](http://code.activestate.com/recipes/119466-dijkstras-algorithm-for-shortest-paths/)。我已经下载了它，并且在使用它时也下载[了这个](http://code.activestate.com/recipes/117228/)。

那么如何通过传递所需的参数来测试此代码，如下所示？！

```
>>> G = {'s':{'u':10, 'x':5}, 'u':{'v':1, 'x':2}, 'v':{'y':4}, 'x':{'u':3, 'v':9, 'y':2}, 'y':{'s':7, 'v':6}}
>>> Dijkstra.Dijkstra(G,'s','v') 
```

我已在其中一个 python 路径中添加了这两个文件，并同时导入了这两个文件，但仍然出现错误您能否给我一些关于测试此代码的简单方法的建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T05:09:18.107

如果你只是在测试，你真的应该把文件放在你的当前目录中，而不是把它们放进去，`/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/`因为那个路径是为 Python 标准库保留的。

似乎需要将第二个配方，即优先级词典放入一个名为的文件中，`priodict.py`因为 Dijkstra 代码从`priodict`. 因此，您的当前目录中应该有以下文件：`Dijkstra.py`, `priodict.py`. 然后你可以启动 Python 并做`import Dijkstra`，它应该可以工作。

另外，不要修改 Dijkstra 代码以删除`import`您显然所做的...

# android - 如何在 android 模拟器 >= API 级别 14 (x86/ARM) 上预安装 Scala 库

> ID：12462496
> 
> 赞同：1
> 
> 时间：2012-09-17T15:29:10.787
> 
> 标签：android, scala, android-emulator

我正在尝试将我的 android 开发环境切换到基于 scala 的开发环境，但是周转时间（由于仅使用 ProGuard 将 scala 库剥离到使用过的部分而导致）正在扼杀我。

有一些关于通过创建新的 ramdisk 映像并将库添加到所谓的`BOOTCLASSPATH`. 结果应该是，我不再需要将 scala 库集成到我的调试版本中，因此可以显着减少周转时间（[此处](http://lampwww.epfl.ch/~michelou/android/emulator-android-sdk.html)提供了一个这样的教程）。

我已经按照这些教程进行操作，它适用于 android 2.3.x（API 级别 10），但是当将其应用于 ICS 模拟器（API 级别 14/15）或 Jelly Bean 模拟器（API 级别 16）时，它们会卡在修改后的引导循环。ICS 仿真器对我来说尤其重要，因为我正在使用带有硬件加速仿真的 x86 映像，因为它比 ARM 映像快得多。

关于如何在 ICS 仿真器或更高版本上预安装 scala 库的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:29:10.787

在搜索了一段时间后，我偶然发现了[Android-Scala-Installer](https://github.com/jbrechtel/Android-Scala-Installer)，它允许在有根的 android 设备上预安装 scala 库。它使用另一种机制：它定义了额外的权限，而不是调整`BOOTCLASSPATH`它，然后可以在您的`AndroidManifest.xml`using`<uses-library />`语句中引用这些权限。

不幸的是，安装程序不能在模拟器上运行，但我已经应用了通用机制并创建了一个 scala 脚本，它可以完全自动化您选择的模拟器的整个安装过程，并且适用于 x86 和 ARM 映像——只需调用脚本，它将启动模拟器并完成所有安装工作，您就完成了。目前该脚本仅在 Windows 上运行。

该脚本当前捆绑了 scala 2.9.2 和 2.10.0-M7 库，可以[在 github](https://github.com/svenwiegand/scala-libs-for-android-emulator)上找到。

**提示：**为了避免`AndroidManifest.xml`在调试和发布版本之间切换时进行调整，我将我的应用程序拆分为一个 android 库项目，其中包含应用程序的所有代码和两个应用程序项目——两者都引用库项目。其中一个应用程序项目用于调试构建并包含相关`<uses-library />`语句，另一个项目用于发布构建并将 scala 库包含到构建过程中，因此它们是交付的 APK 的一部分。

希望这对其他人也有用。

# string - 如何计算字符串中的字符，不包括某些类型？

> ID：12462500
> 
> 赞同：5
> 
> 时间：2012-09-17T15:29:36.417
> 
> 标签：string, delphi, counting

我需要确定文本框中的字符总数并在标签中显示值，但需要排除所有空格。

这是代码：

```
var     
sLength : string;
i : integer;
begin
     sLength := edtTheText.Text;
     slength:= ' ';
     i := length(sLength);

     //display the length of the string
     lblLength.Caption := 'The string is ' +  IntToStr(i)  + ' characters long'; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-17T15:46:17.353

您可以像这样计算非空白字符：

```
uses
  Character;

function NonWhiteSpaceCharacterCount(const str: string): Integer;
var
  c: Char;
begin
  Result := 0;
  for c in str do
    if not Character.IsWhiteSpace(c) then
      inc(Result);
end; 
```

这用于[`Character.IsWhiteSpace`](http://docwiki.embarcadero.com/Libraries/en/System.Character.IsWhiteSpace)确定字符是否为空格。根据 Unicode 规范，当且仅当字符被归类为空格时才`IsWhiteSpace`返回。`True`因此，制表符算作空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T20:39:58.033

如果您使用的是 Ansi 版本的 Delphi，您还可以使用查找表，例如

```
NotBlanks: Array[0..255] Of Boolean 
```

如果匹配字符不是空白，则设置数组中的 Bool。然后在循环中你只需增加你的计数器

```
Count := 0;
For i := 1 To Length(MyStringToParse) Do
  Inc(Count, Byte(NotBlanks[ Ord(MyStringToParse[i]])) ); 
```

以同样的方式，您可以使用一组：

```
For i := 1 To Length(MyStringToParse) Do
If Not (MyStringToParse[i] In [#1,#2{define the blanks in this enum}]) Then 
  Inc(Count). 
```

其实你有很多方法可以解决这个问题。

# java - Apache CXF Maven 发行版和 CXF 发行版之间的区别

> ID：12462503
> 
> 赞同：1
> 
> 时间：2012-09-17T15:29:41.067
> 
> 标签：java, apache, maven, cxf

我需要在我当前的项目中使用 Apache CXF 和 Maven。当我从 Apache 站点下载 CXF 时，我注意到发行版中有一组 Jars。但是当我将 cxf-rt-frontend-jaxws 依赖项添加到 pom.xml 并发出`mvn package`命令时，lib 文件夹中有一些不同的文件，例如 cxf-api-2.2.7.jar

两种分布（如果有的话）有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T19:37:50.670

一般来说，如果使用 Maven，则根本不需要下载的发行版。下载的发行版确实提供了一些有用的示例等......这可能会有所帮助，但是要构建应用程序，您并不需要它。

但是，下载中的 lib 目录使用“cxf-bundle”jar（重命名为 cxf-VERSION.jar）而不是单独的 jar。如果您使用 maven，您可能会使用各个模块（如 cxf-rt-frontend-jaxws）。您可以删除 lib/cxf-VERSION.jar 并将所有 jar 从 modules/*.jar 复制到 lib 并通过下载完成几乎相同的事情。不过，那只是一堆罐子。

注意：你真的应该使用 CXF 2.6.2，而不是 2.2.7。2.2.x 不受支持，并且存在各种安全问题，这些问题已在较新版本中得到修复。

# wordpress - 使用 Google Analytics 跟踪 WordPress 注册

> ID：12462504
> 
> 赞同：0
> 
> 时间：2012-09-17T15:29:42.487
> 
> 标签：wordpress, google-analytics

我想使用 Google Analytics 跟踪 WordPress 用户注册/注册。

我以前在其他平台上做过这个，但由于某些原因它不适用于 WordPress。

1- 我将我的目标 URL 设置为：/wp-login.php?checkemail=registered（这是成功注册的登陆 URL）

2-匹配类型：“完全匹配”

3- 目标漏斗第 1 步：/wp-login.php?action=register（这是注册表单 URL）

我最近有几个注册，但谷歌分析没有跟踪它们。

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T22:10:53.330

检查您的 GA 代码是否在注册页面上？即使我在所有页面的标题中都有我的 GA 代码，WP 也将其遗漏了，我不得不手动将其添加到注册页面。

# nhibernate - Nhibernate QueryOver - .SelectCount() 与谓词

> ID：12462514
> 
> 赞同：0
> 
> 时间：2012-09-17T15:30:04.420
> 
> 标签：nhibernate, queryover

我需要选择有条件的行数：

查询以收集完整计数：

```
var searchs = searchQuery.SelectList
                    (list => list

                                .SelectGroup(order => order.Id).WithAlias(() => groupResult.GlobalId)
                                .SelectCount(() => _transaction.ReturnStatus).WithAlias(() => groupResult.DeclineCount)
                    ) 
```

我需要等于 201 的交易计数。这样的事情：

```
.SelectCount(() => _transaction.ReturnStatus == 201).WithAlias(() => groupResult.DeclineCount) //runtime error 
```

提前致谢！

PS：原始SQL查询：

```
SELECT TOP 100
        globalOrd.ID AS GlobalId ,
        SUM(CASE WHEN transact.returnStatus = 201 THEN 1
                 ELSE 0
            END) AS DeclineCount
FROM    Orders.Global globalOrd
        INNER JOIN Orders.TransactionDetail transactDet ON globalOrd.ID = transactDet.DetailID
        INNER JOIN Orders.[Transaction] transact ON transactDet.TransactionID = transact.ID
GROUP BY globalOrd.ID 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:09:28.023

如果您不需要同一查询中的总计数，您可以简单地在 SelectList 之前添加限制：

```
var searchs = searchQuery.SelectList
    (list => list
                .Where(() => _transaction.ReturnStatus == 201)
                .SelectGroup(order => order.Id).WithAlias(() => groupResult.GlobalId)
                .SelectCount(() => _transaction.ReturnStatus).WithAlias(() => groupResult.DeclineCount)
    ) 
```

但是，如果您想要总数和限制计数，则必须使用 SqlProjection 为后者执行以下操作：

```
 SUM(CASE {alias}.ReturnStatus WHEN 201 THEN 1 ELSE 0 END) 
```

# javascript - 关于 Chrome 扩展的存储权限

> ID：12462515
> 
> 赞同：2
> 
> 时间：2012-09-17T15:30:10.457
> 
> 标签：javascript, google-chrome, google-chrome-extension, chrome-web-store

关于 Chrome 扩展的存储权限的两个问题。

1.  我有一个已发布的扩展。如果我向 manifest.json 添加存储权限，是否会为当前用户禁用扩展程序（即 Chrome 会询问用户是否要允许新权限），还是会在不询问他们的情况下继续运行？

2.  chrome.storage 从哪个版本的 Chrome 中可用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-18T07:39:10.890

1.  试试看或[阅读文档](http://developer.chrome.com/extensions/permission_warnings.html#nowarning)：

    > 以下权限不会导致警告：(...)
    > 
    > *   “贮存”

2.  [第 20 版](http://developer.chrome.com/extensions/whats_new.html#20)。

# c# - 添加到组时在本地计算机上创建用户真的很慢

> ID：12462525
> 
> 赞同：2
> 
> 时间：2012-09-17T15:30:53.940
> 
> 标签：c#

我有以下代码，它接受用户名和密码，然后在机器上创建用户并将它们添加到两个特定组中。当我进入小组部分时，它真的很慢，我不知道为什么。根据我的日志文件，我上次运行时说将用户添加到用户组需要 7 分钟，但 IIS_IUSRS 速度非常快。

下面是我的初始代码，它调用执行实际工作的方法。我曾尝试使用一项任务来帮助加快检查组的过程，但它的运行速度仍然非常慢。

```
public void Apply(Section.User.User user, Action<string> status)
    {
        #region Sanity Checks

        if (user == null)
        {
            throw new ArgumentNullException("user");
        }

        if (status == null)
        {
            throw new ArgumentNullException("status");
        }
        #endregion
        _logger.Debug(string.Format("Starting to apply the user with name {0}", user.UserName));
        status(string.Format("Applying User {0} to the system.", user.UserName));

        using (PrincipalContext pc = new PrincipalContext(ContextType.Machine))
        {

            UserPrincipal userPrincipal = UserPrincipal.FindByIdentity(pc, user.UserName);
            try
            {
                _logger.Debug("Checking if user already exists");
                if (userPrincipal == null)
                {
                    userPrincipal = CreateNewUser(user, pc);
                }

                _logger.Debug("Setting user password and applying to the system.");
                userPrincipal.SetPassword(user.UserPassword);
                userPrincipal.Save();

                Task<PrincipalSearchResult<Principal>> groups =
                    Task<PrincipalSearchResult<Principal>>.Factory.StartNew(userPrincipal.GetGroups);

                _logger.Debug("Adding user to the groups.");
                AddUserToGroups(pc, userPrincipal, groups, user.UserType.Equals(UserType.WorkerProcess.ToString()) ? "Administrators" : "Users", "IIS_IUSRS");
                AddCurrentUser(user);
            }
            finally
            {
                if (userPrincipal != null)
                {
                    userPrincipal.Dispose();
                }
            }

        }

    } 
```

如果用户不存在，这是我用来创建用户的私有方法。

```
private UserPrincipal CreateNewUser(Section.User.User user, PrincipalContext principal)
    {
        _logger.Debug("User did not exist creating now.");
        UserPrincipal newUser = new UserPrincipal(principal)
            {
                Name = user.UserName,
                Description = user.UserDescription,
                UserCannotChangePassword = false,
                PasswordNeverExpires = true,
                PasswordNotRequired = false
            };
        _logger.Debug("User created.");
        return newUser;
    } 
```

以下是分组的逻辑。我在每次使用调试器时都会挂在的有问题的代码上方发表了评论。此外，调试日志条目也始终是我在挂起之前获得的最后一个条目。

```
private void AddUserToGroups(PrincipalContext principal, UserPrincipal user, Task<PrincipalSearchResult<Principal>> userGroups, params string[] groups)
    {
        groups.AsParallel().ForAll(s =>
            {
                using (GroupPrincipal gp = GroupPrincipal.FindByIdentity(principal, s))
                {
                    _logger.Debug(string.Format("Checking if user is alread in the group."));
                    if (gp != null && !userGroups.Result.Contains(gp))
                    {
                        _logger.Debug(string.Format("The user was not a member of {0} adding them now.", gp.Name));
                        //This is the point that the 7 minute hang starts
                        gp.Members.Add(user);
                        gp.Save();

                        _logger.Debug(string.Format("User added to {0}.", gp.Name));
                    }
                }
            });
    } 
```

对此项目的任何帮助将不胜感激，因为该项目预计将于 10 月发布，但在创建用户时我无法在 7 分钟挂起的情况下发布。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:46:20.247

有同样的问题。看起来

```
 gp.Members.Add( user ); 
```

很慢，因为它首先**枚举**组（获取`Members`），然后才添加到集合中（这又增加了速度）。

解决方案是让它像：

```
 UserPrincipal user = this is your user;
    GroupPrincipal group = this is your group;

    // this is fast
    using ( DirectoryEntry groupEntry = group.GetUnderlyingObject() as DirectoryEntry )
    using ( DirectoryEntry userEntry = user.GetUnderlyingObject() as DirectoryEntry )
    {         
      groupEntry.Invoke( "Add", new object[] { userEntry.Path } ); 
    }

    //group.Members.Add(user); // and this is slow!
    //group.Save(); 
```

只是一个提示 - 创建密码`SetPassword`对我们来说也非常慢。解决方案是遵循“The .NET Developer's Guide to Directory Services Programming”中的方法，他们使用低级密码设置`LdapConnection`from `System.DirectoryServices.Protocols`。

我们发现的最后一个瓶颈是由`User.GetGroups()`方法引起的。

无论如何，如果将用户添加到组的代码对您有所帮助，请记下。另请注意，您实际上并不需要并行执行此操作 - 我知道这是您加快代码速度的方法，但您并不需要这样做。

# r - 在 R 的箱线图中添加不同的百分位数

> ID：12462529
> 
> 赞同：5
> 
> 时间：2012-09-17T15:31:03.427
> 
> 标签：r, boxplot, ggplot2, percentile

我对 R 很陌生，最近用它来制作一些箱线图。我还在箱线图中添加了平均值和标准差。我想知道我是否也可以在不同的百分位数中添加某种刻度线或圆圈。假设我想在每个 HOUR 箱形图中标记第 85、第 90 个百分位数，有没有办法做到这一点？我的数据包含一年中每小时 MW 的负载，我的输出包含每个月每小时的 24 个箱线图。我每个月一次做一次，因为我不确定是否有办法一次运行所有 96 个（每个月，工作日/周末，4 个不同区域）箱线图。提前感谢您的帮助。

```
JANWD <-read.csv("C:\\My Directory\\MWBox2.csv")
JANWD.df<-data.frame(JANWD)
JANWD.sub <-subset(JANWD.df, MONTH < 2 & weekend == "NO")

KeepCols <-c("Hour" , "Houston_Load")
HWD <- JANWD.sub[ ,KeepCols]

sd <-tapply(HWD$Houston_Load, HWD$Hour, sd)
means <-tapply(HWD$Houston_Load, HWD$Hour, mean)

boxplot(Houston_Load ~ Hour, data=HWD, xlab="WEEKDAY HOURS", ylab="MW Differnce", ylim= c(-10, 20), smooth=TRUE ,col ="bisque", range=0)

points(sd, pch = 22, col= "blue")
points(means, pch=23, col ="red")

#Output of the subset of data used to run boxplot for month january in Houston 
str(HWD)
'data.frame':   504 obs. of  2 variables:
 `$ Hour        : int  1 2 3 4 5 6 7 8 9 10 ...'
 `$ Houston_Load: num  1.922 2.747 -2.389 0.515 1.922 ...'

#OUTPUT of the original data
str(JANWD)
'data.frame':   8783 obs. of  9 variables:
 $ Date        : Factor w/ 366 levels "1/1/2012","1/10/2012",..: 306 306 306 306 306 306 306 306 306 306 ...
 `$ Hour        : int  1 2 3 4 5 6 7 8 9 10 ...'
` $ MONTH       : int  8 8 8 8 8 8 8 8 8 8 ...'
 `$ weekend     : Factor w/ 2 levels "NO","YES": 1 1 1 1 1 1 1 1 1 1 ...'
 `$ TOTAL_LOAD  : num  0.607 5.111 6.252 7.607 0.607 ...'
 `$ Houston_Load: num  -2.389 0.515 1.922 2.747 -2.389 ...'
 `$ North_Load  : num  2.95 4.14 3.55 3.91 2.95 ...'
 `$ South_Load  : num  -0.108 0.267 0.54 0.638 -0.108 ...'
 `$ West_Load   : num  0.154 0.193 0.236 0.311 0.154 ...' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T15:48:57.580

这是一种方法，`quantile()`用于为您计算相关的百分位数。我使用添加标记`rug()`。

```
set.seed(1)
X <- rnorm(200)
boxplot(X, yaxt = "n")

## compute the required quantiles
qntl <- quantile(X, probs = c(0.85, 0.90))

## add them as a rgu plot to the left hand side
rug(qntl, side = 2, col = "blue", lwd = 2)

## add the box and axes
axis(2)
box() 
```

**更新**：为了响应 OP 提供的`str()`输出，这里有一个类似于 OP 必须提供的数据的示例：

```
set.seed(1) ## make reproducible
HWD <- data.frame(Hour = rep(0:23, 10),
                  Houston_Load = rnorm(24*10)) 
```

现在让我假设你想要每个百分位数的第 85 和第 90 个刻度`Hour`？如果是这样，我们需要按照我之前展示的方式拆分数据`Hour`并计算：`quantile()`

```
quants <- sapply(split(HWD$Houston_Load, list(HWD$Hour)),
                 quantile, probs = c(0.85, 0.9)) 
```

这使：

```
R> quants <- sapply(split(HWD$Houston_Load, list(HWD$Hour)),
+                  quantile, probs = c(0.85, 0.9))
R> quants
            0         1        2         3         4         5        6
85% 0.3576510 0.8633506 1.581443 0.2264709 0.4164411 0.2864026 1.053742
90% 0.6116363 0.9273008 2.109248 0.4218297 0.5554147 0.4474140 1.366114
            7         8        9       10        11        12       13       14
85% 0.5352211 0.5175485 1.790593 1.394988 0.7280584 0.8578999 1.437778 1.087101
90% 0.8625322 0.5969672 1.830352 1.519262 0.9399476 1.1401877 1.763725 1.102516
           15        16        17        18       19        20       21
85% 0.6855288 0.4874499 0.5493679 0.9754414 1.095362 0.7936225 1.824002
90% 0.8737872 0.6121487 0.6078405 1.0990935 1.233637 0.9431199 2.175961
          22        23
85% 1.058648 0.6950166
90% 1.145783 0.8436541 
```

现在我们可以在箱线图的 x 位置绘制标记

```
boxplot(Houston_Load ~ Hour, data = HWD, axes = FALSE)
xlocs <- 1:24 ## where to draw marks
tickl <- 0.15 ## length of marks used
for(i in seq_len(ncol(quants))) {
    segments(x0 = rep(xlocs[i] - 0.15, 2), y0 = quants[, i],
             x1 = rep(xlocs[i] + 0.15, 2), y1 = quants[, i],
             col = c("red", "blue"), lwd = 2)
}
title(xlab = "Hour", ylab = "Houston Load")
axis(1, at = xlocs, labels = xlocs - 1)
axis(2)
box()
legend("bottomleft", legend = paste(c("0.85", "0.90"), "quantile"),
       bty = "n", lty = "solid", lwd = 2, col = c("red", "blue")) 
```

结果图应如下所示：

![扩展箱线图示例](../Images/269497736dd8d11e3a94999bc3117284.png)

# c - 短路和可读性

> ID：12462530
> 
> 赞同：2
> 
> 时间：2012-09-17T15:31:08.753
> 
> 标签：c, if-statement, conditional, readability, short-circuiting

在这一行

`if ((last_search == NULL) || (last_search != NULL && total_results != 0))`

我知道 C 的短路评估规则说，只有`last_search`不是 null 才会尝试评估 的右侧`||`，因此它相当于写作

`if ((last_search == NULL) || (total_results != 0))`

有人建议我使用后者，但前者不是更具可读性吗？编译器也不会优化冗余`last_search != NULL`吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-17T15:32:53.393

这是主观的，但不，第一个变体不是更具可读性，因为还有更多要阅读的内容。最易读的代码（也是最少的错误！）是不存在的代码。试想一下，如果您想一次检查 3 或 4 个条件会发生什么。

还有另一个反例：你会写这样的代码吗？

```
if (number < 0) {
}
else if(number >= 0) {
    // why not just "else"?
} 
```

至于性能：编译器可能会优化冗余调用，但撤销性能下降无助于可读性下降。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-17T15:32:38.980

不，这不对。第二个更具可读性。不管编译器是否会优化它，你为什么要保留冗余检查？

第一个版本告诉您这`last_search`不是`NULL`因为它到达了那里，但是如果您不能从第一个条件（`last_search == NULL`失败）中看出这一点，那么您可能遇到的问题比可读性更大。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:37:20.083

不仅短路评估使其不可读，而且还使用了多余的比较。

```
if ( !last_search || total_results) 
```

比您建议的任何内容都更容易阅读。

# opengl - 缩放和平移的平移和缩放顺序

> ID：12462534
> 
> 赞同：0
> 
> 时间：2012-09-17T15:31:22.330
> 
> 标签：opengl

我要做的第一件事是平移到屏幕的中心并从那里绘制所有对象。然后我想应用 tranlsate 平移和缩放缩放。我想相对于中心点进行缩放！那么它们的顺序应该如何才能起作用呢？

```
glTranslatef(width/2, height/2, 0); 
gltranslate(centerX,centerY); // go to center point
glscale(zoom);
glTranslatef(offset.x/zoom, offset.y/zoom, offset.z/zoom); // pan 
```

我尝试了上面的顺序，但它没有到达中心点，它总是相对于（0,0）缩放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T00:00:22.197

我想您正在绘制一个 x 和 y 都在 0,1 之间的正方形。

首先，您必须转换为缩放对象应为的点：

```
glTranslate3f(centerX,centerY,0);
glScale(zoom);
glTranslatef(-0.5f, -0.5f,0); // to the middle
draw stuff 
```

opengl 以相反的顺序执行转换，因为它是一个管道。以自下而上的方向阅读上述序列将给出关键。

# jquery-hover - 悬停时只显示一个元素而不是全部

> ID：12462537
> 
> 赞同：0
> 
> 时间：2012-09-17T15:31:37.857
> 
> 标签：jquery-hover

我有多个 div 元素，我想在悬停时添加一个功能，但现在显示在所有 div 元素上。

如何在鼠标悬停时仅设置一个元素。预先感谢您的帮助

```
$('.box .line').hide();
// toggles the slickbox on clicking the noted link  
$('.box > div').hover(function() {
$('.box .line').toggle('fast');
return false; 
```

});

安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:37:36.163

```
$('.box > div').hover(function() {
    $(this).find('.line').toggle('fast');
}); 
```

# git - 如何grep git diff？

> ID：12462538
> 
> 赞同：93
> 
> 时间：2012-09-17T15:31:38.540
> 
> 标签：git, grep, diff

有没有办法显示按给定模式过滤的 git-diff。

就像是

```
git grepdiff pattern

changed file
+++ some sentence with pattern
changed file 2
--- some other pattern 
```

不幸的是，最简单的解决方案还不够好

```
git diff | grep pattern 

+++ some sentence with pattern
--- some other pattern
# not an option as doesn't put the filename close to the match 
```

我使用 awk 提供了一种解决方法

```
git diff | awk "/\+\+\+/{f = \$2}; /PATTERN/ {print f \$0} " 
```

但很想知道有一个命令。

* * *

## 回答 #1

> 赞同：113
> 
> 时间：2012-09-17T15:41:57.387

不确定，但`git diff -G <regex>`标志不行吗？

> -G <正则表达式>
> 
> ```
> Look for differences whose added or removed line matches the given <regex>. 
> ```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-17T15:49:05.467

你试过了吗`git diff -S<string>`？`git diff -G".*string.*"`请注意，它们不是等效的，请参阅[有关镐的文档](http://git-scm.com/docs/gitdiffcore.html#_diffcore-pickaxe%3a_for_detecting_addition/deletion_of_specified_string)以了解 -S 的作用。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-09-17T15:56:59.567

另一种可能性是查看整个差异并使用普通`less`命令（类型`/`然后是模式）搜索输出。

当您使用`less`配置为在匹配之前显示一些行时`--jump-target=N`，这非常有用。试试这样：

```
PAGER="/usr/bin/less --jump-target=10" git diff 
```

这意味着匹配应该显示在第 10 行（上面显示 9 行上下文），这可能足以同时看到文件名。

您还可以使用 eg`--jump-target=.5`将匹配项放置在屏幕中间。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-09-17T15:42:43.193

我使用`git log -p`，它打开较少（但可配置），而它又可以用`/`. 还有`git log -S <searchword>`。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2018-05-28T15:55:34.850

我认为您对“grep”`diff`输出的方法是最好的解决方法。

您可以使用 sed 改进您的 awk 脚本：

```
colored="(^[\[[0-9;]*[a-zA-Z])"
marker="^$colored+diff"
pattern="^$colored+.*(\+|\-).*PATTERN"
git diff --color | sed -rn -e "/$marker/! H; /$marker/ ba; $ ba; b; :a; x; /$pattern/ p" 
```

*   `colored`: 正则表达式匹配终端彩色线
*   `marker`：标记以匹配来自不同`diff`大块的划分，以彩色“diff”开头的行
*   `pattern`：要搜索的模式，以彩色“+”或“-”开头并包含“PATTERN”的行

这将打印完整的差异大块，添加或删除 PATTERN，同时保持有用的彩色输出。

请注意，`^[`in`colored`应该是实际的字面量`^[`。您可以通过按`Ctrl`+ `V`，`Ctrl`+在 bash 中键入它们`[`

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-09-02T17:17:50.103

这是一个自定义 diff 工具，它允许 grepping 内部更改（但不是上下文）：

**用法**

`GIT_EXTERNAL_DIFF="mydiff --grep foo" git diff`

这将输出您的更改中包含的那些行`foo`（包括`foo`由于您的更改而消失的行）。可以使用任何 grep 模式来代替`foo`.

每个输出行都以以下前缀开头：

```
filename: oldlinenum: newlinenum| 
```

该脚本也可以在没有`--grep`选项的情况下使用，在这种情况下，它只是如上所述格式化完整差异（即提供完整上下文）。

**我的差异**

```
#!/bin/bash

my_diff()
{
    diff --old-line-format="$1"':%6dn:      |-%L'     \
         --new-line-format="$1"':      :%6dn|+%L'     \
         --unchanged-line-format="$1"':%6dn:%6dn| %L' \
         $2 $3
}

if [[ $1 == '--grep' ]]
then
    pattern="$2"
    shift 2
    my_diff "$1" "$2" "$5"|grep --color=never '^[^|]\+|[-+].\+'"$pattern"'.*'
else
    my_diff "$1" "$2" "$5"
fi

exit 0 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-09-16T19:09:15.073

我一直非常满意地使用它:)

```
grep -ri <MY_PATTERN> $(git diff 790e26393d --name-only) 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-01T11:22:07.217

在 Windows 上，一个简单的解决方案是：

```
git diff -U0 | findstr string 
```

如果要按文件名分组，请使用此

```
FOR /F "usebackq delims==" %i IN (`git diff --name-only`) do git diff -U0 %~fi | findstr string 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-03-07T16:52:33.060

这为我完成了工作，我希望它可以帮助某人：

```
git diff | grep  -P '^\+|^\-' 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-20T22:50:20.473

提供的解决方案并不完全符合我的需求，这解决*了我的*问题。

```
(
    START_DIFF=abc123
    END_DIFF=123dcf 

    # loop over all the files that have changed inside the diff
    # you can add a `| grep '<ext>$'` to the end of `--name-only`
    # if you need to be more aggresive with the filtering / or 
    # make it go faster...
    for file in $(git diff $START_DIFF $END_DIFF --name-only); do
        # loop over every line of the diff FOR that file.
        while IFS= read -r line; do
            # prepend the file name to every line
            echo "$file:$line"
        done < <(git diff $START_DIFF $END_DIFF $file)
    done
) | grep what-youre-looking-for 
```

我无法让行号工作，但我真的不需要它们来让它们工作。附加的文件名对我来说已经足够了。

* * *

我的确切问题：

在 70 多个文件中查找添加了 a`from __future__ import ..`或 a的所有文件。`-*- coding: utf-8 -*-`

```
(
    START_DIFF=branch-a
    END_DIFF=HEAD
    for file in $(git diff $START_DIFF $END_DIFF --name-only); do
        while IFS= read -r line; do
            echo "$file:$line"
        done < <(git diff $START_DIFF $END_DIFF $file)
    done
) | grep ':+' | awk '(/import/ && /__future/) || (/coding/)' 
```

输出如下所示：

```
....
app/tests/test_views.py:+# -*- coding: utf-8 -*-
app/tests/test_views.py:+from __future__ import absolute_import
app/tests/test_views.py:+from __future__ import division
app2/tests/test_views.py:+from __future__ import division
... 
```

# typo3 - 为什么用户看不到 fileadmin 之外的文件挂载？

> ID：12462540
> 
> 赞同：2
> 
> 时间：2012-09-17T15:31:45.953
> 
> 标签：typo3, user-permissions

我试图创建一个文件挂载来为用户设置访问权限。

目录：

```
 typoroot/uploads/ 
```

我已将文件挂载设置为绝对路径，并带有该目录的绝对路径。没有尾随的前导斜杠。

然后我为该用户设置文件挂载。

文件装载对用户不可见。另一个文件挂载以相同的方式创建，但在 fileadmin 文件夹中有效。

*为什么在 fileadmin 之外挂载的文件不起作用？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:31:45.953

我已经搜索了几个小时来解决这个问题：

要使文件挂载在 fileadmin 文件夹之外工作，您必须在 Typo3 的安装工具中设置一个配置变量。

显示完整配置并搜索：

```
 "lockRootPath" 
```

然后输入您想要锁定用户的目录的绝对路径。大多数情况下，您需要使用 Typo3 安装的根目录。

# wpf - 如何将没有属性值的 XML 数据绑定到 TreeView 控件？

> ID：12462541
> 
> 赞同：1
> 
> 时间：2012-09-17T15:31:46.433
> 
> 标签：wpf, xml, binding, tags, treeview

我需要仅使用标记名将 xml 数据绑定到树视图。例子：

```
 <Tools>
     <Bin>
          <EAN128u.dll /> 
          <NetSet.dll /> 
          <MaxicodeWizardu.dll /> 
          <HIBC.dll /> 
      </Bin> 
```

我有一个描述 TreeView 控件视图的 xml。所以 TreeView 节点必须有标签的名称。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:37:46.753

[http://www.codeproject.com/Articles/317766/Displaying-XML-in-a-WPF-TreeView](http://www.codeproject.com/Articles/317766/Displaying-XML-in-a-WPF-TreeView)

本教程介绍如何将 XML 数据添加到树视图。

# javascript - 我不明白范围

> ID：12462544
> 
> 赞同：2
> 
> 时间：2012-09-17T15:32:04.560
> 
> 标签：javascript

1 - 为什么当我运行下面的代码时，我得到了**undefind**而不是**"a=1"**？

```
function f1(){a=1; f2();}
function f2(){return a;}
var a= 5;
a = f1();
​alert(a);​ 
```

像这个例子一样，结果是**"a=1"**。

```
function f1(){a=1; f2();}
function f2(){alert(a);}
var a= 5;
f1(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T15:34:48.620

和

```
a = f1(); 
```

您正在分配调用`f1`到的结果`a`。然而，`f1`不返回任何东西，它评估为`undefined`. 你需要使用一个`return`语句：

```
function f1(){a=1; return f2(); } 
```

顺便说一句，这不是范围问题。您的函数没有任何本地变量，所有内容都访问相同的`a`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:34:52.893

您可能忘记了返回语句来获取您的值

```
function f1(){a=1; return f2();}
function f2(){return a;}
var a= 5;
a = f1();
​alert(a);​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:34:53.933

`f1`不返回任何东西，这就是为什么尝试以下

```
function f1(){a=1; return f2();}
function f2(){return a;}
var a= 5;
a = f1();
​alert(a);​ 
```

即使没有多大意义

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T15:35:11.190

您需要显式地从`f1`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T15:35:11.653

第一个示例中的函数 f1 没有返回任何值，这就是原因

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-17T15:35:14.617

在行期间 a = f1(); f1 函数没有返回任何内容，因此 a 被设置为未定义。

我不肯定您要做什么；如果你添加更多，我可以就如何让它做你想做的事情提出建议。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-17T15:36:25.500

`f1()`不返回任何值。不返回任何内容与返回 undefined 相同。

# python - numpy.getbuffer 和 numpy.frombuffer

> ID：12462547
> 
> 赞同：6
> 
> 时间：2012-09-17T15:32:24.870
> 
> 标签：python, numpy, buffer

我正试图围绕 PEP3118 的 numpy 实现。缓冲区访问在 numpy 中究竟是如何工作的？

```
>>> p = numpy.getbuffer(numpy.arange(10))
>>> p
<read-write buffer for 0x1003e5b10, size -1, offset 0 at 0x1016ab4b0>
>>> numpy.frombuffer(p)
array([  0.00000000e+000,   4.94065646e-324,   9.88131292e-324,
     1.48219694e-323,   1.97626258e-323,   2.47032823e-323,
     2.96439388e-323,   3.45845952e-323,   3.95252517e-323,
     4.44659081e-323]) 
```

所以我得到了意想不到的回报。我希望看到一个包含 0-9 的 10 个元素的数组。我可以进入数组并读/写。

```
>>> j = numpy.frombuffer(p)
>>> j
array([  0.00000000e+000,   4.94065646e-324,   9.88131292e-324,
     1.48219694e-323,   1.97626258e-323,   2.47032823e-323,
     2.96439388e-323,   3.45845952e-323,   3.95252517e-323,
     4.44659081e-323])
>>> j += 1
>>> j
array([ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.]) 
```

所以看起来缓冲区正在初始化为全零，然后我可以写入。我期望的功能是能够使用 getbuffer 将数组（使用 arange 或 asarray）直接构建到缓冲区。那不可能吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-17T15:38:19.737

你有一个简单的`dtype`问题。您创建的缓冲区

```
np.getbuffer(np.arange(10)) 
```

有`dtype=int`, 因为默认`np.arange`使用`dtype=int`。

然后，当您尝试使用

```
np.frombuffer(p) 
```

您实际上使用的`dtype=float`是`np.frombuffer`. 相反，使用

```
np.frombuffer(p, dtype=int) 
```

等等，你得到了

```
array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9]) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-09-17T23:11:39.173

让我对皮埃尔的出色现有[答案添加一些评论。](https://stackoverflow.com/a/12462633/1499402)

`getbuffer`仅当您必须切片时才需要：您可以通过属性`ndarray`检索与整个数组关联的 python 缓冲区对象`data`

```
>>> import numpy as np
>>> a = np.arange(10)
>>> a.data == np.getbuffer(a)
True 
```

相反，您不需要将实际的缓冲区对象传递给`frombuffer`函数，每个暴露`buffer`接口的对象都是好的。

```
>>> np.frombuffer(a, a.dtype)
array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
>>> np.frombuffer(a)
array([  0.00000000e+000,   4.94065646e-324,   9.88131292e-324,
         1.48219694e-323,   1.97626258e-323,   2.47032823e-323,
         2.96439388e-323,   3.45845952e-323,   3.95252517e-323,
         4.44659081e-323])
>>> import array
>>> c = array.array('i', range(10))
>>> np.frombuffer(c, np.int32)
array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=int32)
>>> np.frombuffer(c)
array([  2.12199579e-314,   6.36598737e-314,   1.06099790e-313,
         1.48539705e-313,   1.90979621e-313]) 
```

*解码*缓冲区对象时，您必须知道正确`dtype`的，如上面的示例所示。更准确地说，缓冲区对象没有`dtype`: 它们只是二进制数据流。相反，`ndarray`对象有一个`dtype`指示如何解释底层二进制数据的 。

回答您的问题：每个 numpy 都`ndarray`公开缓冲区接口。您可以通过`data`描述符或`getbuffer`函数访问缓冲区或缓冲区的一部分。您可以通过该函数`ndarray`从暴露缓冲区接口的对象创建's。`frombuffer`由于缓冲区（相对于`ndarrays`）没有`dtype`信息，因此您应该始终明确指定缓冲区必须如何通过`dtype`参数来解释`frombuffer`。

# python - PIL 图像模式“P”->“RGBA”

> ID：12462548
> 
> 赞同：15
> 
> 时间：2012-09-17T15:32:25.490
> 
> 标签：python, python-imaging-library, converter, mode

这是我的问题：

```
import Image
im = Image.open("1.png")
im.show()
print im.mode
im.convert("RGBA").save("2.png") 
```

好吧，通过我的图像，您可以看到不同之处。
我的问题是：如何正确转换它？

图片：![原来的](../Images/dcf7d7e03dba7aa8eec581d77217c4b2.png)

结果：![结果](../Images/47a501425bf3392a0166de6cc6b609af.png)

注意：原始图像有一个半透明的辉光，结果有一个纯绿色的“辉光”

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T18:35:43.483

此处报告了此问题：

[https://bitbucket.org/effbot/pil-2009-raclette/issue/8/corrupting-images-in-palette-mode](https://bitbucket.org/effbot/pil-2009-raclette/issue/8/corrupting-images-in-palette-mode)

2012 年 3 月，一条评论说它现在已在 PIL 的开发版本中修复。最新发布的版本是 1.1.7，因此在 1.2 发布之前无法使用此修复程序。PIL 更新**非常**缓慢，所以不要指望它很快就会出来。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-17T18:01:06.937

不幸的是，您的 PNG 图像是 PIL 不能很好处理的一种类型 - 带有 alpha 通道的调色板图像。当您打开图像时，alpha 会被丢弃，并且无法取回。

这不同于通常的调色板透明度，其中调色板的一个索引用于表示完全透明的像素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-07T20:07:45.597

你可以使用[`scipy.misc.imread`](https://docs.scipy.org/doc/scipy/reference/generated/scipy.misc.imread.html)：

```
img = scipy.misc.imread(filename, mode='RGBA')
img = Image.fromarray(img) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T16:44:27.427

您的问题是您没有提供有关 PIL 应用作 ALPHA 通道来源的信息。

PIL 不会单独为您的图像添加透明度。

您希望图像的哪一部分透明？

# sql - 使用 except 语句更新

> ID：12462560
> 
> 赞同：0
> 
> 时间：2012-09-17T15:33:32.287
> 
> 标签：sql, tsql, select, except

这是我的查询

```
SELECT PageVisit_ID,TargetSite_ID FROM [A].Datawarehouse.mi.ctb_PageEvent WITH (NOLOCK)
 EXCEPT 
 SELECT PageVisit_ID ,TargetSite_ID FROM [B].Datawarehouse.mi.ctb_PageEvent WITH (NOLOCK) 
```

这两个表来自两台服务器。我需要更新 仅与上述查询结果匹配`targetsite_id`的`[A].Datawarehouse.mi.ctb_PageEvent`记录。`[B].Datawarehouse.mi.ctb_PageEvent`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:46:06.067

试试这个

```
DECLARE @SummaryOfChanges TABLE(Change VARCHAR(20));

MERGE INTO [A].Datawarehouse.mi.ctb_PageEvent AS Target
USING ( SELECT PageVisit_ID ,TargetSite_ID FROM [B].Datawarehouse.mi.ctb_PageEvent WITH (NOLOCK)) AS SOURCE
ON Target.TargetSite_ID = Source.TargetSite_ID 
WHEN MATCHED THEN
    //UPDATE OR do nothing
WHEN NOT MATCHED BY TARGET THEN
    //INSERT 
OUTPUT $action INTO @SummaryOfChanges; 
```

请参阅[SQL SERVER - 合并操作 - 单次执行中的插入、更新、删除](http://blog.sqlauthority.com/2010/06/08/sql-server-merge-operations-insert-update-delete-in-single-execution/)。我的解决方案只是给出了如何做到这一点的基本想法。它最初可能无法 100% 工作。一旦你理解了逻辑，只需调整它

# pyqt4 - 如何在 QLineEdit 中插入按钮

> ID：12462562
> 
> 赞同：5
> 
> 时间：2012-09-17T15:33:33.487
> 
> 标签：pyqt4, qt4, pyside, qlineedit, qtoolbutton

我需要帮助在里面插入一个`QLineEdit`可以调用函数的按钮。

例如，像这个谷歌图片：

![行编辑中的按钮](../Images/31cfbe191cc5fe265d3bd11d9e2e5a50.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-17T23:18:08.440

下面是来自[这里](https://web.archive.org/web/20130613105442/http://blog.qt.digia.com/blog/2007/06/06/lineedit-with-a-clear-button)的 Qt 代码的几乎直接翻译。

差异：

*   按钮始终可见
*   点击按钮发出`buttonClicked(bool)`信号

代码：

```
from PyQt4 import QtGui, QtCore

class ButtonLineEdit(QtGui.QLineEdit):
    buttonClicked = QtCore.pyqtSignal(bool)

    def __init__(self, icon_file, parent=None):
        super(ButtonLineEdit, self).__init__(parent)

        self.button = QtGui.QToolButton(self)
        self.button.setIcon(QtGui.QIcon(icon_file))
        self.button.setStyleSheet('border: 0px; padding: 0px;')
        self.button.setCursor(QtCore.Qt.ArrowCursor)
        self.button.clicked.connect(self.buttonClicked.emit)

        frameWidth = self.style().pixelMetric(QtGui.QStyle.PM_DefaultFrameWidth)
        buttonSize = self.button.sizeHint()

        self.setStyleSheet('QLineEdit {padding-right: %dpx; }' % (buttonSize.width() + frameWidth + 1))
        self.setMinimumSize(max(self.minimumSizeHint().width(), buttonSize.width() + frameWidth*2 + 2),
                            max(self.minimumSizeHint().height(), buttonSize.height() + frameWidth*2 + 2))

    def resizeEvent(self, event):
        buttonSize = self.button.sizeHint()
        frameWidth = self.style().pixelMetric(QtGui.QStyle.PM_DefaultFrameWidth)
        self.button.move(self.rect().right() - frameWidth - buttonSize.width(),
                         (self.rect().bottom() - buttonSize.height() + 1)/2)
        super(ButtonLineEdit, self).resizeEvent(event) 
```

用法：

```
import sys
from PyQt4 import QtGui

def buttonClicked():
    print 'You clicked the button!'

if __name__ == '__main__':
    app = QtGui.QApplication(sys.argv)

    main = ButtonLineEdit('/path/to/my_fancy_icon.png')
    main.buttonClicked.connect(buttonClicked)
    main.show()

    sys.exit(app.exec_()) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-01-15T16:09:14.950

这是可运行的代码：

![在此处输入图像描述](../Images/71e0771b94329062870b4716bdff4a9c.png)

```
from PyQt4.QtGui import *
from PyQt4.QtCore import *
from sys import argv, exit

class ButtonInLineEdit(QLineEdit):
    def __init__(self,parent=None):
        QLineEdit.__init__(self,parent)

        self.ButtonShowKeyboard = QToolButton(self)
        self.ButtonShowKeyboard.setCursor(Qt.PointingHandCursor)

        self.ButtonShowKeyboard.setFocusPolicy(Qt.NoFocus)
        self.ButtonShowKeyboard.setIcon(QIcon("icons/myIcon.png"))
        self.ButtonShowKeyboard.setStyleSheet("background: transparent; border: none;")

        layout = QHBoxLayout(self)
        layout.addWidget(self.ButtonShowKeyboard,0,Qt.AlignRight)

        layout.setSpacing(0)
        layout.setMargin(5)

        self.ButtonShowKeyboard.setToolTip(QApplication.translate("None", "Show virtual keyboard", None, QApplication.UnicodeUTF8))

def MyFunction(arg=None):
    print "MyFunction() called: arg = %s"%arg

a=QApplication(argv)
LineEdit = ButtonInLineEdit()
LineEdit.connect(LineEdit.ButtonShowKeyboard, SIGNAL("clicked()"), MyFunction)
LineEdit.show()
exit(a.exec_()) 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-03-02T11:04:43.840

从 Qt 5.2 开始，有[QLineEdit.addAction()](http://doc.qt.io/qt-5/qlineedit.html#addAction)这是一种内置的方法。此外[QLineEdit.setClearButtonEnabled()](http://doc.qt.io/qt-5/qlineedit.html#clearButtonEnabled-prop)在右侧添加一个十字按钮（如在某些 OSX 控件上）以清除小部件的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-20T07:20:10.003

## 感谢我们的同事，Avaris，但他的例子并没有说服我，我决定让另一个更容易和更少的代码。去学习吧！

```
#this code for example in btninlineedit.py

from PyQt4.QtGui import *
from PyQt4.QtCore import Qt
from PyQt4 import QtCore, QtGui
#Andrey Zhuk.
#####
try:
    _fromUtf8 = QtCore.QString.fromUtf8
except AttributeError:
    _fromUtf8 = lambda s: s

class ButtonInLineEdit(QLineEdit):
    def __init__(self,parent=None):
        QLineEdit.__init__(self,parent)

        self.ButtonShowKeyboard = QToolButton(self)
        self.ButtonShowKeyboard.setCursor(Qt.PointingHandCursor)
        #self.ButtonShowKeyboard.show()
        self.ButtonShowKeyboard.setFocusPolicy(Qt.NoFocus)
        self.ButtonShowKeyboard.setIcon(QtGui.QIcon("images/YourIcon.svg"))
        self.ButtonShowKeyboard.setStyleSheet("background: transparent; border: none;")

        layout = QHBoxLayout(self)
        layout.addWidget(self.ButtonShowKeyboard,0,Qt.AlignRight)

        layout.setSpacing(0)
        layout.setMargin(5)
        # ToolTip 
        self.ButtonShowKeyboard.setToolTip(QtGui.QApplication.translate("None", "Show virtual keyboard", None, QtGui.QApplication.UnicodeUTF8))

#this code for example in main.py            
class main(/////****///**/): 
    def __init__(self):
     #blablablablaaaa

        self.KeyboardShow = False

self.connect(self.LineEdit.ButtonShowKeyboard, QtCore.SIGNAL("clicked()"), self.KeyboardShowHide)

def KeyboardShowHide(self):
    try:
        if self.KeyboardShow:
            self.KeyboardShow = False
            self.WidgetKeyboard.hide()
        else:
            self.KeyboardShow = True
            self.WidgetKeyboard.show()
    except:
            debug ("ошибка при вызове функции скрытые или показа клавиатуры (Main Window)")
#this code for example in btninlineedit.py

from forms.btninlineedit import ButtonInLineEdit

        self.LineEdit = ButtonInLineEdit() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-09T01:56:57.247

在 qt C++ 中，我可以`pushButton`在`LineEdit`. 之后，我只需要使用以下代码进行`styleSheet`设置`LineEdit`：

```
int FramWidth = lineEdit->style()->pixelMetric(QStyle::PM_DefaultFrameWidth);

lineEdit->setStyleSheet(QString("QLineEdit{padding-right: %1px; }").arg(ui->pushButton->sizeHint().width() + FramWidth +5)); 
```

它对我有用。希望它可以提供帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-01-29T20:41:02.437

```
class LineEditFileDialogWidget(QtWidgets.QLineEdit):
    def __init__(self, parent=None):
        super(LineEditFileDialogWidget, self).__init__(parent)
        self.setReadOnly(True)

        icon = QtWidgets.QApplication.style().standardIcon(QtWidgets.QStyle.SP_DirIcon)
        self.action = self.addAction(icon, QtWidgets.QLineEdit.TrailingPosition)
        self.action.triggered.connect(some function) 
```

这是一个将图标与 QLineEdit 一起使用的示例

# c# - 如何从 SQL 中的存储过程中选择到 Linq

> ID：12462564
> 
> 赞同：2
> 
> 时间：2012-09-17T15:33:46.623
> 
> 标签：c#, sql-server, linq-to-sql, stored-procedures

这可能吗？

```
...
Int32? Id = 1;
QDataContext qDataContext = new QDataContext();
var q= from p in qDataContext.GetProcedurePersonas(Id) 
       select p.name, p.last;
... 
```

当我运行它时，我得到一个错误：

> 找不到源类型“System.Data.Linq.ISingleResult WcfService1.GetProcedurePersonasResult”的查询模式的实现。
> 未找到“选择”。您是否缺少对“System.Core.dll”的引用或“System.Linq”的 using 指令？

我也有这个并且可以完美地工作

```
...
Int32? Id = 1;
QDataContext qDataContext = new QDataContext();
var q= qDataContext.GetProcedurePersonas(Id);
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:18:50.307

如果你已经有了

```
QDataContext qDataContext = new QDataContext();
var q= qDataContext.GetProcedurePersonas(Id); 
```

例如，您想从 q 中选择特定的东西，您可能会这样做。

```
var specific=(from c in q where c.columnvalue == yourValue select c.columnvalue).ToList(); 
```

序列化为 json 你可以使用

```
 JavaScriptSerializer jss = new JavaScriptSerializer();
    string json = jss.Serialize(specific); 
```

# android - 为所有平台（如 windows、Mac、IOS、Android 等）建议一个通用数据库

> ID：12462567
> 
> 赞同：0
> 
> 时间：2012-09-17T15:33:53.840
> 
> 标签：android, ios, windows, macos, platform

请为所有平台（如 Windows、Mac、IOS、Android 等）建议一个通用数据库......我的目标是构建一个应用程序来离线和在线谈论所有这些媒体。要在离线模式下存储数据，我需要知道如何在所有这些介质中维护存储（即，通用存储，以便无需为每种介质编写代码）。

请帮忙。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T15:35:50.307

[SQLite](http://www.sqlite.org/)是显而易见的解决方案。它在 iOS 和 Android SDK 中原生可用，也可用于 Mac 和 Windows。

# java - 使用 JSON 路径从数组中提取值

> ID：12462569
> 
> 赞同：3
> 
> 时间：2012-09-17T15:34:08.083
> 
> 标签：java, json, jsonpath

我在下面有这样的Json

```
{"pd":"{\"e\":{\"h\":{\"ak\":\"120\",\"at\":\"app\"},\"b\":[{\"ts\":1319549658547,\"tz\":-400,\"s\":\"StartUpScreen\",\"et\":8,\"ev\":\"sessionStart\",\"si\":\"19477682-de55-414f-82c9-19bec331dc33\",\"tt\":{\"day\":\"Tuesday\"}},{\"ts\":132,\"tz\":-400,\"s\":\"StartUpScreen\",\"et\":3,\"ev\":\"AutomaticFeedRefresh\",\"si\":\"19477682-de55-414f-82c9-19bec331dc33\",\"tt\":{}},{\"ts\":131,\"tz\":-400,\"s\":\"MainScreen\",\"et\":3,\"ev\":\"MainScreen Event\",\"si\":\"19477682-de55-414f-82c9-19bec331dc33\",\"tt\":{}}],\"tt\":{\"OSV\":\"7.10\"}}}","serverPayload":{"httpHeaders":{"x-bluecoat-via":["35D3468EFF4D5F18"],"content-type":["application\/x-www-form-urlencoded"]},"senderIp":["101.100.000.100"]}} 
```

我只需要 和的`ak`值。现在我有 2 个问题，如何提取 'b' 和 'senderIp' 中的所有 'ts' 属性。我已将以下代码用于 ak、ts 和 si。我不确定我是如何得到“tt”的，当我运行这段代码时，我得到一个如下所示的异常`b [ts,si and tt[day]]``senderIp`

```
 String pd = JsonPath.read(jsonString, "$.pd");
    String ak = JsonPath.read(pd, "$e.h.ak");
    String ak = JsonPath.read(pd, "$e.h.b[0]");
//    String b = JsonPath.read(pd,"$.e.b[0][0]");
//    String b = JsonPath.read(pd,"$.e.b[0][5]");
    System.out.println("value of ak: "+ak); 
```

线程“main”中的异常 `java.lang.ClassCastException: net.minidev.json.JSONObject cannot be cast to java.lang.String`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T17:18:38.087

`$.e.h.b[0]`看起来像一个 JavaScript 对象（字段包括“ts”和“tz”），而不是字符串。因此，您的 JSON 解析器将其视为 JSONObject 而不是字符串是合理的。可能您需要深入`$.e.h.b[0].ts`研究或您感兴趣的任何领域。像这样的东西：

```
long ts = JsonPath.read(pd, "$e.h.b[0].ts"); 
```

我假设这是您的第二`String ak =`行导致异常。我无法理解您关于“ts”属性的其他问题。也许您可以格式化 JSON 字符串以便于阅读？

# ruby-on-rails - 如何使用 Ruby(on Rails) 计算两个地理位置之间的公路距离？

> ID：12462572
> 
> 赞同：3
> 
> 时间：2012-09-17T15:34:11.713
> 
> 标签：ruby-on-rails, ruby, geocoding, google-geocoding-api

我已经建立了一个系统，可以使用 [http://www.rubygeocoder.com/](http://www.rubygeocoder.com/ "红宝石地理编码器")计算两个位置之间的距离，但是，为了能够计算我需要的（免税）公里成本（例如旅行补偿）通过公路获取距离，例如使用谷歌。

这怎么做最好？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T17:21:15.113

您可以使用[https://developers.google.com/maps/documentation/directions/](https://developers.google.com/maps/documentation/directions/)。

例如请求：

```
http://maps.googleapis.com/maps/api/directions/json?origin=Toronto&destination=Montreal&sensor=false 
```

将为您提供从多伦多到蒙特利尔的路线以及总距离。

[https://github.com/apneadiving/Google-Maps-for-Rails](https://github.com/apneadiving/Google-Maps-for-Rails)封装了方向 API，因此您可能会发现它让您的生活更轻松。您可能还会发现在这种情况下它是多余的，因为我们只讨论一个请求。

# jquery - jQuery 收回使用会影响其他 div 标签

> ID：12462573
> 
> 赞同：-1
> 
> 时间：2012-09-17T15:34:15.947
> 
> 标签：jquery, html, css

我正在尝试使用 jquery 显示一个下拉框。它运作良好。我还实现了在打开列表后单击页面的任何其他位置时隐藏下拉列表的选项。为此，我使用了以下 jQuery。

```
$('div.selectBox').each(function(){
    $(this).children('span.selected').html($(this).children('div.selectOptions').children('span.selectOption:first').html());
    $(this).attr('value',$(this).children('div.selectOptions').children('span.selectOption:first').attr('value'));
    $(this).children('span.selected,span.selectArrow').click(function(){
        if($(this).parent().children('div.selectOptions').css('display') == 'none'){
            $(this).parent().children('div.selectOptions').css('display','block');
        }
        else
        {
            $(this).parent().children('div.selectOptions').css('display','none');
        }
    });
    $(document).unbind('click');
    $(document).click(function(event){
        if($(event.target).closest('div.selectBox').length == 0) {
             $('.selectOptions').hide();                
        }
    });
    $(this).find('span.selectOption').click(function(){
        $(this).parent().css('display','none');
        $(this).closest('div.selectBox').attr('value',$(this).attr('value'));
        $(this).parent().siblings('span.selected').html($(this).html());
    });
}); 
```

当我们点击网站的任何其他部分时，它会完美关闭或隐藏。但问题是其他一些`<div>`标签正在隐藏或`display:none;`在执行此操作后。

请告诉我一个解决方案。您可以在上面的 url 中看到它完全影响。如果您需要任何其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T16:04:31.550

```
$(this).toggleClass('open').next().toggle(); 
```

这条线分散在您的代码中的各个地方似乎是导致问题的原因。我不确定它最初打算完成什么。它可能需要修改或直接删除，具体取决于它的意图。

**编辑**

在玩完你的 jsFiddle 之后，我可以看到它的意图是切换嵌套的子元素，需要更改才能`$(this).toggleClass('open');`正常工作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T16:01:49.413

# [jsFiddle](http://jsfiddle.net/SpYk3/m6vak/)

[^(***更新于 2012 年 9 月 21 日，以反映其他一些用途，包括第二个菜单，而无需同时打开 2 个***)](http://jsfiddle.net/SpYk3/m6vak/)

长话短说，我不包括您的所有其他工作，但对于 BASE 功能，您只需要以下内容：

```
$(function() {
    // This will ensure it closes when clicked anywhere not on the element or its children
    $(document).click(function(e) {
        $(".open").removeClass("open");
    });

// the simple task of adding class
$(".createNew, .username, .notes").click(function(e) {
    var $this = $(this);
    // This next line ensures not having 2 open at once
    $(".open").filter(function(i){ return $this[0] != $(this)[0]; }).removeClass("open");
    e.stopPropagation(); // this prevents it closing via document.click
    $this.toggleClass("open");
});
}); 
```

如果您想在 diff 类名的多个元素上使用：

```
$(function() {
    $(document).click(function(e) {
        $(".createNew, .username, .notes").removeClass("open");
    });

    // the simple task of adding class
    $(".createNew, .username, .notes").click(function(e) {
        e.stopPropagation(); // this prevents it closing via document.click
        $(this).toggleClass("open");
    });

    // the rest
    $(".textbox").css({width:'100px', height: '33px'})
        .focus(function(e) {
            $(this).animate({width: '200px', height: '33px'});
        })
        .blur(function(e) {
            $(this).animate({width: '100px', height: '33px'});
        });
}); 
```

# c - 如何将 webkit 嵌入到 gtk+ 程序中

> ID：12462582
> 
> 赞同：1
> 
> 时间：2012-09-17T15:34:56.187
> 
> 标签：c, webkit, gtk, dev-c++

我已经下载了 webkitgtk+ ，但不知道接下来我要做什么。我的想法是制作一个网络浏览器。我使用 dev-c++ 作为 IDE。我第一次尝试用 fltk 来做这件事，但后来我意识到 gtk+ 有一个端口，所以我学会了 gtk+.Pls。帮助

# jquery - jQuery .submit() 的问题

> ID：12462584
> 
> 赞同：1
> 
> 时间：2012-09-17T15:34:59.457
> 
> 标签：jquery, html

我在使用 jQuery 提交表单时遇到问题`submit()`。

我的页面上没有任何名称为`name="submit"`or的元素`name="Submit"`，ID 也是如此。

我的 jQuery 代码如下：

```
 $(document).ready(function () {

    $(document).on('click', "#appSubmit",function(e){

            e.preventDefault();
            var value = $("#time").val();
            if(value == "--"){
                $( "#err-time" ).dialog( "open" );
            }else{
                alert("1");
                var dummy = $("#appSubmit").val();
                alert(dummy);
                $("#appSubmit").submit();
                alert("2");
            }

    });
}); 
```

所有警报都正常工作，甚至`alert(dummy);`打印出正确的值。打印出来了`alert("2");`，所以它甚至没有打破`$("#appSubmit").submit();`

我的提交按钮是

```
<input type="submit" name="appSubmit" id="appSubmit" value="Apply"> 
```

任何想法将不胜感激，谢谢。

编辑：

对不起，我忘了发布一个实际问题。`$("#appSubmit").submit();`当它到达我的代码中的行时，表单没有提交。它也不会破裂。

在 jQuery 站点上，他们给出的示例将事件附加到`<i+n+p+u+t type="submit">`，但我已经尝试通过尝试将事件附加到表单的 id 并且我仍然得到相同的行为。通过线没有任何中断。

我可以让它工作的唯一方法是如果我使用基本的javascript提交调用`document.applySubmit.submit();`

这很好，并且可以完成工作。但我仍然想弄清楚这一点。

编辑2：

我将尝试 .closest 方法。直到现在我才知道那是什么。谢谢你。如果它有效，我会发布。

编辑3：

这个问题是我发了 3 次吗？如果是这样，我很抱歉。我一定无法找到自己的问题，并假设我从未完成整个问题提交过程并尝试第二次/第三次正确发布它。

编辑：Blazemonger 的建议奏效了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-17T15:36:37.420

你不是`.submit()`一个按钮，你`.submit()`是一个表格。尝试：

```
$("#appSubmit").closest('form').submit(); 
```

或者更好：

```
$(this).closest('form').submit(); 
```

# backbone.js - 根据数据中的变量分配视图模板？

> ID：12462586
> 
> 赞同：0
> 
> 时间：2012-09-17T15:35:01.897
> 
> 标签：backbone.js, marionette

我正在使用骨干和木偶，我想根据数据中的变量渲染视图。this.model.template 我在想可以从我的数据中提取（返回 myTemplate 和 myOtherTemplate），然后我可以在渲染函数中进行一些操作，但它不起作用。有什么建议么？。可以让视图知道模型吗？

```
var graph = [{
    nodeName: "1st level item",
    template: "myTemplate",
    nodes: [{
        nodeName: "2nd level item",
        template: "myOtherTemplate"
    }]
}];

TreeView = Backbone.Marionette.CompositeView.extend({
    tagName: "ul",
    initialize: function(){
        this.collection = this.model.nodes;
    },
    appendHtml: function(collectionView, itemView){
        collectionView.$("li:first").append(itemView.el);
    },
    render: function(){
        var that = this;
        console.log('Loading template name: ' + name + ' template: ' + this.template + ' data: ' + this.model.template);
        TemplateManager.get(this.template, function(template){
            var html = $(template).tmpl();
            that.$el.html(html);
        });
        return this;
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-18T00:06:24.760

你是如何初始化视图的？

视图通常期望模型是 Backbone 模型。访问模型属性时，您应该使用`mymodel.get('attributeName')`. 单个属性不能直接在模型上使用。它们在`mymodel.attributes`（例如，`mymodel.attributes.template`）中可用，但`attributes`不应直接使用，除非调试除外，因为属性的存储和访问方式将来可能会发生变化，或者如果您使用任何插件，也会被各种插件更改。

另请注意，在大多数情况下，您不需要重写该`render`方法。相反，请查看`beforeRender`and `onRender`。

# google-app-engine - 为什么我的静态文件可以与 dev_appserver.py 一起使用，但不能在 GAE 上使用？

> ID：12462588
> 
> 赞同：0
> 
> 时间：2012-09-17T15:35:06.850
> 
> 标签：google-app-engine

我的静态文件在开发服务器上运行良好，但是当我通过 appcfg.py 部署我的应用程序时，我的主题不会加载。`Error: Not Found`当我尝试使用以下 url 访问我的 .css 文件时，GAE 会返回。

```
http://sprucepress.appspot.com/static/default/css/bootstrap-responsive.css 
```

我已经下载了我的源代码的副本并验证了这些文件实际上是在 GAE 上。我还验证了一切都在我的本地 dev_appserver.py 上运行。

您可以[在 GitHub 上查看当前部署的版本](https://github.com/jwogrady/sprucepress)。

我的目录结构...

*   应用程序.yaml
*   静态的.py
*   主题
    *   默认
        *   行政
            *   编辑.html
            *   索引.html
            *   发布的.html
        *   资产
            *   css
            *   ico
            *   图像
            *   js
        *   base.html
        *   列表.html
        *   post.html
    *   简单的
        *   默认
        *   行政
            *   编辑.html
            *   索引.html
            *   发布的.html
        *   资产
            *   css
            *   ico
            *   图像
            *   js
        *   base.html
        *   列表.html
        *   post.html

我的 app.yaml。

```
application: sprucepress
version: 1
runtime: python27
api_version: 1
threadsafe: yes

handlers:

- url: /admin/.*
  script: admin.app
  login: admin

- url: /static/([^/]+)/(.*)
  static_files: themes/\1/assets/\2
  upload: themes/[^/]+/static/.*

- url: .*
  script: static.app

builtins:
- remote_api: on

libraries:
- name: webapp2
  version: "2.5.1"

- name: jinja2
  version: latest 
```

HTML 不起作用的示例..

```
<link href="/static/default/css/bootstrap.css" rel="stylesheet" /> 
```

实时站点位于[http://sprucepress.appspot.com](http://sprucepress.appspot.com)

**更新 1** - 我尝试重新部署，但这并没有解决问题。

**更新 2** - 这是我的 appcfg.py 输出。

```
john@ogradylan-lap01:~$ appcfg.py update google_projects/sprucepress
09:27 AM Host: appengine.google.com
09:27 AM Application: sprucepress; version: 1
09:27 AM 
Starting update of app: sprucepress, version: 1
09:27 AM Getting current resource limits.
Email: <ny email>
Password for <ny email>: 
09:27 AM Scanning files on local disk.
09:27 AM Cloning 117 application files.
09:27 AM Cloned 100 files.
09:27 AM Compilation starting.
09:27 AM Compilation completed.
09:27 AM Starting deployment.
09:27 AM Checking if deployment succeeded.
09:27 AM Will check again in 1 seconds.
09:27 AM Checking if deployment succeeded.
09:27 AM Will check again in 2 seconds.
09:27 AM Checking if deployment succeeded.
09:27 AM Will check again in 4 seconds.
09:27 AM Checking if deployment succeeded.
09:27 AM Will check again in 8 seconds.
09:27 AM Checking if deployment succeeded.
09:27 AM Deployment successful.
09:27 AM Checking if updated app version is serving.
09:27 AM Will check again in 1 seconds.
09:27 AM Checking if updated app version is serving.
09:27 AM Will check again in 2 seconds.
09:28 AM Checking if updated app version is serving.
09:28 AM Will check again in 4 seconds.
09:28 AM Checking if updated app version is serving.
09:28 AM Will check again in 8 seconds.
09:28 AM Checking if updated app version is serving.
09:28 AM Completed update of app: sprucepress, version: 1
09:28 AM Uploading index definitions. 
```

**更新 3** 我已经下载了应用程序来验证文件实际上是在服务器上。一切似乎都已正确上传。

```
appcfg.py download_app -A sprucepress sp3
09:37 AM Host: appengine.google.com
09:37 AM Fetching file list...
Email: <my email>
Password for <my email>: 
09:37 AM Fetching files...
09:37 AM [1/117] themes/default/assets/ico/apple-touch-icon-114-precomposed.png
09:37 AM [2/117] themes/default/assets/js/bootstrap-carousel.js
09:37 AM [3/117] themes/default/assets/css/bootstrap.css
09:37 AM [4/117] lib/wtforms/ext/django/templatetags/wtforms.py
09:37 AM [5/117] themes/default/assets/img/glyphicons-halflings.png
09:37 AM [6/117] lib/wtforms/fields/__init__.py
09:37 AM [7/117] themes/default/assets/img/examples/bootstrap-example-fluid.jpg
09:37 AM [8/117] themes/default/assets/css/bootstrap-responsive.css
09:37 AM [9/117] lib/wtforms/ext/i18n/__init__.py
09:37 AM [10/117] themes/default/assets/js/bootstrap-modal.js
09:37 AM [11/117] lib/wtforms/compat.py
09:37 AM [12/117] lib/wtforms/widgets/__init__.py
09:37 AM [13/117] static.py
09:37 AM [14/117] themes/default/assets/js/bootstrap-tooltip.js
09:37 AM [15/117] themes/default/assets/img/grid-baseline-20px.png
09:37 AM [16/117] themes/default/listing.html
09:37 AM [17/117] lib/wtforms/fields/simple.py
09:37 AM [18/117] themes/default/assets/img/bs-docs-masthead-pattern.png
09:37 AM [19/117] themes/default/assets/js/bootstrap-alert.js
09:37 AM [20/117] lib/wtforms/ext/i18n/messages/pl/LC_MESSAGES/wtforms.mo
09:37 AM [21/117] themes/default/assets/img/bs-docs-bootstrap-features.png
09:37 AM [22/117] themes/default/assets/ico/apple-touch-icon-72-precomposed.png
09:37 AM [23/117] app.yaml
09:37 AM [24/117] themes/default/assets/js/jquery.js
09:37 AM [25/117] lib/wtforms/ext/__init__.py
09:37 AM [26/117] lib/wtforms/ext/sqlalchemy/__init__.py
09:37 AM [27/117] lib/wtforms/ext/django/templatetags/__init__.py
09:37 AM [28/117] themes/default/assets/js/bootstrap.min.js
09:37 AM [29/117] lib/aetycoon/app.yaml
09:37 AM [30/117] themes/default/assets/img/examples/bootstrap-example-hero.jpg
09:37 AM [31/117] themes/default/assets/js/bootstrap-button.js
09:38 AM [32/117] favicon.ico
09:38 AM [33/117] lib/wtforms/ext/django/i18n.py
09:38 AM [34/117] lib/wtforms/ext/i18n/form.py
09:38 AM [35/117] themes/default/assets/img/example-sites/jshint.png
09:38 AM [36/117] themes/default/assets/img/responsive-illustrations.png
09:38 AM [37/117] themes/default/assets/ico/favicon.ico
09:38 AM [38/117] themes/default/admin/index.html
09:38 AM [39/117] themes/default/assets/js/google-code-prettify/prettify.js
09:38 AM [40/117] lib/wtforms/validators.py
09:38 AM [41/117] themes/default/assets/css/docs.css
09:38 AM [42/117] themes/default/admin/edit.html
09:38 AM [43/117] lib/wtforms/ext/csrf/form.py
09:38 AM [44/117] lib/wtforms/ext/i18n/messages/pl/LC_MESSAGES/wtforms.po
09:38 AM [45/117] lib/wtforms/ext/django/orm.py
09:38 AM [46/117] admin.py
09:38 AM [47/117] themes/default/assets/ico/apple-touch-icon-144-precomposed.png
09:38 AM [48/117] lib/wtforms/ext/i18n/messages/en/LC_MESSAGES/wtforms.po
09:38 AM [49/117] themes/default/assets/img/examples/bootstrap-example-starter.jpg
09:38 AM [50/117] handlers.py
09:38 AM [51/117] lib/wtforms/ext/i18n/messages/es/LC_MESSAGES/wtforms.po
09:38 AM [52/117] themes/default/assets/js/bootstrap-scrollspy.js
09:38 AM [53/117] themes/default/assets/js/bootstrap-tab.js
09:38 AM [54/117] lib/aetycoon/README
09:38 AM [55/117] lib/wtforms/ext/i18n/messages/fa/LC_MESSAGES/wtforms.mo
09:38 AM [56/117] lib/wtforms/ext/i18n/messages/fa/LC_MESSAGES/wtforms.po
09:38 AM [57/117] themes/default/assets/test.jpg
09:38 AM [58/117] themes/default/assets/js/README.md
09:38 AM [59/117] lib/wtforms/ext/i18n/messages/wtforms.pot
09:38 AM [60/117] lib/wtforms/ext/sqlalchemy/fields.py
09:38 AM [61/117] themes/default/assets/js/google-code-prettify/prettify.css
09:38 AM [62/117] themes/default/admin/published.html
09:38 AM [63/117] lib/wtforms/ext/csrf/fields.py
09:38 AM [64/117] models.py
09:38 AM [65/117] lib/wtforms/ext/i18n/messages/en/LC_MESSAGES/wtforms.mo
09:38 AM [66/117] lib/wtforms/ext/i18n/messages/es/LC_MESSAGES/wtforms.mo
09:38 AM [67/117] themes/default/assets/img/bootstrap-mdo-sfmoma-03.jpg
09:38 AM [68/117] themes/default/assets/ico/apple-touch-icon-57-precomposed.png
09:38 AM [69/117] themes/default/assets/js/bootstrap-popover.js
09:38 AM [70/117] lib/wtforms/ext/dateutil/fields.py
09:38 AM [71/117] lib/wtforms/fields/core.py
09:38 AM [72/117] config.py
09:38 AM [73/117] lib/wtforms/ext/appengine/fields.py
09:38 AM [74/117] themes/default/assets/img/bs-docs-twitter-github.png
09:38 AM [75/117] themes/default/assets/js/bootstrap.js
09:38 AM [76/117] lib/wtforms/ext/i18n/messages/README.txt
09:38 AM [77/117] lib/wtforms/ext/i18n/messages/zh/LC_MESSAGES/wtforms.po
09:38 AM [78/117] themes/default/assets/img/less-logo-large.png
09:38 AM [79/117] themes/default/assets/img/example-sites/soundready.png
09:39 AM [80/117] themes/default/assets/img/example-sites/kippt.png
09:39 AM [81/117] lib/wtforms/widgets/core.py
09:39 AM [82/117] themes/default/base.html
09:39 AM [83/117] lib/wtforms/ext/i18n/messages/it/LC_MESSAGES/wtforms.mo
09:39 AM [84/117] utils.py
09:39 AM [85/117] themes/default/assets/js/bootstrap-affix.js
09:39 AM [86/117] lib/wtforms/ext/csrf/__init__.py
09:39 AM [87/117] index.yaml
09:39 AM [88/117] lib/wtforms/ext/django/fields.py
09:39 AM [89/117] themes/default/assets/js/bootstrap-typeahead.js
09:39 AM [90/117] lib/wtforms/ext/csrf/session.py
09:39 AM [91/117] generators.py
09:39 AM [92/117] lib/wtforms/ext/sqlalchemy/validators.py
09:39 AM [93/117] README.md
09:39 AM [94/117] lib/wtforms/ext/i18n/messages/zh/LC_MESSAGES/wtforms.mo
09:39 AM [95/117] themes/default/assets/js/bootstrap-transition.js
09:39 AM [96/117] themes/default/assets/img/bootstrap-mdo-sfmoma-02.jpg
09:39 AM [97/117] listing.html
09:39 AM [98/117] lib/wtforms/ext/i18n/utils.py
09:39 AM [99/117] themes/default/assets/js/bootstrap-dropdown.js
09:39 AM [100/117] themes/default/assets/js/bootstrap-collapse.js
09:39 AM [101/117] themes/default/assets/js/application.js
09:39 AM [102/117] lib/wtforms/ext/appengine/db.py
09:39 AM [103/117] lib/wtforms/ext/i18n/messages/it/LC_MESSAGES/wtforms.po
09:39 AM [104/117] themes/default/assets/img/example-sites/fleetio.png
09:39 AM [105/117] lib/wtforms/ext/sqlalchemy/orm.py
09:39 AM [106/117] fix_path.py
09:39 AM [107/117] lib/wtforms/form.py
09:39 AM [108/117] themes/default/post.html
09:39 AM [109/117] lib/wtforms/ext/appengine/__init__.py
09:39 AM [110/117] lib/wtforms/__init__.py
09:39 AM [111/117] themes/default/assets/img/bs-docs-responsive-illustrations.png
09:39 AM [112/117] lib/wtforms/ext/django/__init__.py
09:39 AM [113/117] lib/wtforms/ext/dateutil/__init__.py
09:39 AM [114/117] themes/default/assets/img/bootstrap-mdo-sfmoma-01.jpg
09:39 AM [115/117] themes/default/assets/img/glyphicons-halflings-white.png
09:39 AM [116/117] main.py
09:39 AM [117/117] lib/aetycoon/__init__.py 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T16:37:56.240

该`upload`值应为`themes/[^/]+/assets/.*`. 您在主题中没有静态文件夹。

# c++ - C++ 堆栈实现硬件错误

> ID：12462593
> 
> 赞同：0
> 
> 时间：2012-09-17T15:35:15.757
> 
> 标签：c++, makefile, compiler-errors, stack

我有 C++ 方面的经验，但最近一直在工作中专门使用 python，我很生疏。下面列出了每个文件：

主文件

```
#include "stack.h"

int main(int argc, char** argv){
    return 0;
} 
```

堆栈.h

```
#ifndef STACK_H
#define STACK_H

#define NULL 0

template <class elementType>
class stack{

    struct node
    {
        elementType data;
        node* next;
    };

    node* top;

public:

    stack(){
        top = NULL;
    }

    ~stack(){
        node temp = top;
        while (top != NULL){
            top = top->next;
            delete temp;
        }
    }

    void push(elementType x){
        node temp = new node();
        temp.data = x;
        temp.next = top;
        top = temp;
    }

    elementType pop(){
        node temp = top;
        top = top->next;
        return temp;
    }

    bool isEmpty(){
        return top == NULL;
    }
};

#endif //STACK_H 
```

生成文件

```
a.out : main.o stack.o
    gcc -o a.out main.o stack.o

main.o : main.cpp stack.h 
    gcc -O -c main.cpp

stack.o : stack.h
    gcc -O -c stack.h

clean :
    rm main.o stack.o 
```

所以，当我`cd`进入项目目录并输入时，`make`我得到：

```
gcc -O -c main.cpp
gcc -O -c stack.h
stack.h:7:10: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘&lt;’ token
make: *** [stack.o] Error 1 
```

我一直在寻找解决方案，但据我所知，我的代码是正确的。我不是在寻求实际堆栈实现的帮助，我意识到这段代码实际上不会对空的 main 做任何事情，但我似乎无法修复这个编译错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:38:30.713

使用 g++ 编译 C++，而不是 gcc。此外，您不需要编译标头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T15:37:43.817

在 C++ 中，您不编译头文件，只编译源文件。

你用 g++ 编译 C++，而不是 gcc。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:51:02.883

`gcc -c stack.cpp`可以正常工作：gcc 将 .cpp 识别为 C++ 的扩展，并将文件编译为 C++。问题发生在`gcc stack.h`; 正如其他人所说，不要编译标题。但错误的原因是 gcc 似乎将文件视为 C 文件，而不是 C++（不是不合理，但我没有查过它的作用）。

但是，当您链接时，您必须使用`g++`或指定正确的 C++ 运行时库。在这里更容易使用`g++`。

哦，还有一个错误`stack.h`。`pop`返回`temp`，但应该返回`temp.data`。

另外，在定义一个名为`NULL`. 它可能与标准库中的定义冲突。这里不是问题，因为代码不使用标准库中的任何头文件，但这是人为的。

# android - 在 ICS 中创建可同步日历

> ID：12462595
> 
> 赞同：2
> 
> 时间：2012-09-17T15:35:51.897
> 
> 标签：android, calendar

我在 ICS 中创建新日历时遇到问题。日历应该与谷歌日历同步。我尝试以下：

```
 Uri calendarUri = CalendarContract.Calendars.CONTENT_URI;
        calendar.put(CalendarContract.Calendars.ACCOUNT_NAME, sync_account);
        calendar.put(CalendarContract.Calendars.ACCOUNT_TYPE, "com.google");

        calendar.put(CalendarContract.Calendars.NAME, name);
        calendar.put(CalendarContract.Calendars.CALENDAR_DISPLAY_NAME, displayName);
        calendar.put(CalendarContract.Calendars.CALENDAR_COLOR, 0xFF008080);
        calendar.put(CalendarContract.Calendars.CALENDAR_ACCESS_LEVEL, CalendarContract.Calendars.CAL_ACCESS_OWNER);
        calendar.put(CalendarContract.Calendars.OWNER_ACCOUNT, true);
        calendar.put(CalendarContract.Calendars.VISIBLE, 1);
        calendar.put(CalendarContract.Calendars.SYNC_EVENTS, 1);

        calendarUri = calendarUri.buildUpon()
            .appendQueryParameter(CalendarContract.CALLER_IS_SYNCADAPTER, "true")
            .appendQueryParameter(CalendarContract.Calendars.ACCOUNT_NAME, sync_account)
            .appendQueryParameter(CalendarContract.Calendars.ACCOUNT_TYPE, "com.google") // CalendarContract.ACCOUNT_TYPE_LOCAL
            .build();
        Uri result = activity.getContentResolver().insert(calendarUri, calendar); 
```

我总是得到这个错误（编辑：不再）：

```
 09-17 17:11:30.278: E/AndroidRuntime(13243): FATAL EXCEPTION: CalendarSyncAdapterAccountMonitor
09-17 17:11:30.278: E/AndroidRuntime(13243): java.lang.IllegalArgumentException: the name must not be empty: null
09-17 17:11:30.278: E/AndroidRuntime(13243):    at android.accounts.Account.<init>(Account.java:48)
09-17 17:11:30.278: E/AndroidRuntime(13243):    at com.google.android.syncadapters.calendar.CalendarSyncAdapter.onAccountsUpdated(CalendarSyncAdapter.java:1129)
09-17 17:11:30.278: E/AndroidRuntime(13243):    at android.accounts.AccountManager$11.run(AccountManager.java:1279)
09-17 17:11:30.278: E/AndroidRuntime(13243):    at android.os.Handler.handleCallback(Handler.java:605)
09-17 17:11:30.278: E/AndroidRuntime(13243):    at android.os.Handler.dispatchMessage(Handler.java:92)
09-17 17:11:30.278: E/AndroidRuntime(13243):    at android.os.Looper.loop(Looper.java:137)
09-17 17:11:30.278: E/AndroidRuntime(13243):    at android.os.HandlerThread.run(HandlerThread.java:60)
09-17 17:11:30.293: E/android.os.Debug(1989): !@Dumpstate > dumpstate -k -t -n -z -d -o /data/log/dumpstate_app_error 
```

我可以用 CalendarSyncAdapterAccountMonitor 做什么，它不为空？

提前致谢。

**编辑**

我忘了插入时区，而不是我根本没有收到错误：

```
calendar.put(CalendarContract.Calendars.CALENDAR_TIME_ZONE, TimeZone.getDefault().getID()); 
```

**如果我创建可同步日历（上面的代码片段），只需注意发生，没有错误，也没有创建日历。**

如果我将其更改为 lokal（见下文），则可以毫无错误地创建日历，甚至可以添加事件。我该怎么做才能创建可同步的日历？

```
 Uri calendarUri = CalendarContract.Calendars.CONTENT_URI;

        calendar.put(CalendarContract.Calendars.ACCOUNT_NAME, sync_account);//
        //calendar.put(CalendarContract.Calendars.ACCOUNT_TYPE, "com.google");
        calendar.put(CalendarContract.Calendars.ACCOUNT_TYPE, CalendarContract.ACCOUNT_TYPE_LOCAL);
        calendar.put(CalendarContract.Calendars.NAME, name);
        calendar.put(CalendarContract.Calendars.CALENDAR_DISPLAY_NAME, name);
        calendar.put(CalendarContract.Calendars.CALENDAR_COLOR, 0xFF008080);
        calendar.put(CalendarContract.Calendars.CALENDAR_ACCESS_LEVEL, CalendarContract.Calendars.CAL_ACCESS_OWNER);
        calendar.put(CalendarContract.Calendars.OWNER_ACCOUNT, sync_account);// true 
        calendar.put(CalendarContract.Calendars.VISIBLE, 1);
        calendar.put(CalendarContract.Calendars.SYNC_EVENTS, 1); // 1 for syncable, 0 for local
        //calendar.put(CalendarContract.Calendars.DIRTY, 0);
        calendar.put(CalendarContract.Calendars.CALENDAR_TIME_ZONE, TimeZone.getDefault().getID());

        calendarUri = calendarUri.buildUpon()
            .appendQueryParameter(CalendarContract.CALLER_IS_SYNCADAPTER, "true")
            .appendQueryParameter(CalendarContract.Calendars.ACCOUNT_NAME, sync_account)//
            .appendQueryParameter(CalendarContract.Calendars.ACCOUNT_TYPE, CalendarContract.ACCOUNT_TYPE_LOCAL) //  "com.google"
            .build();
        Uri result = activity.getContentResolver().insert(calendarUri, calendar); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T09:20:02.907

您还可以手动创建一个新日历并在您的应用程序中解析日历：

```
Uri.parse("content://com.android.calendar/calendars",null, null, null, null); 
```

找到正确的日历 ID 后，您可以在其中添加/更新事件。此事件将是可同步的。

# c# - WCF 客户端 - 最佳实践

> ID：12462596
> 
> 赞同：2
> 
> 时间：2012-09-17T15:35:51.967
> 
> 标签：c#, wcf

我只是想听听您对 WCF 客户端实现的看法。

我有一个提供多种服务的服务器，例如 SecurityManager。该服务在接口 ISecurityManager 中定义并在类 SecurityManager 中实现。

到目前为止一切都很好。在客户端，我想通过一个单独的类来实现服务调用。我的问题是我是否也在实现相同 ISecurityManager 接口的 SecurityManager 类中执行此操作？

这里最好的做法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:41:55.977

我建议使用通用包装器进行 WCF 调用。因此，每次您需要进行 WCF 调用时，您都可以这样做：

```
var invoker = new ServiceInvoker();
        var result = invoker.InvokeService<ISecurityManager, MyObjectReturnType>(
            proxy => proxy.DoSomething(myParameters));
        return result; 
```

我使用 ServiceInvoker 创建通道并管理内部可能发生的任何异常。它使用 ISecurityManager 合约创建一个通道，返回类型为 MyObjectReturnType 和操作 DoSomething（来自 ISecurityManager 合约的方法）。您可以将此解决方案与您的所有接口一起使用，而无需任何额外的类实现！

InvokeService 将是这样的：

```
public TResult InvokeService<TServiceContract, TResult>(Func<TServiceContract, TResult> invokeHandler) where TServiceContract : class
    {
        ICommunicationObject communicationObject;
        var arg = CreateCommunicationObject<TServiceContract>(out communicationObject);
        var result = default(TResult);
        try
        {
            result = invokeHandler(arg);
        }
        catch (Exception ex)
        {
            Logger.Log(ex);
            throw;
        }

        finally
        {
            try
            {
                if (communicationObject.State != CommunicationState.Faulted)
                    communicationObject.Close();
            }
            catch
            {
                communicationObject.Abort();
            }
        }
        return result;
    }

private TServiceContract CreateCommunicationObject<TServiceContract>(out ICommunicationObject communicationObject)
        where TServiceContract : class
    {
        //Create the Channel
        // ICommunicationObject is an out parameter for disposing purposes 
        return channel;
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T15:54:57.727

## Visual Studio 生成器

您可以要求 Visual Studio 为您构建一个客户端，右键单击您的客户端项目并添加一个`Service Reference`. 有一个对话框，您可以在其中键入您的服务 url 或从解决方案中发现它。

## 创建客户端

您可以构建继承自`ClientBase<ISecurityManager>, ISecurityManager`. 作为此客户端类的操作示例：

```
public void ExampleMethod(int id)
{
   Channel.ExampleMethod(id);
} 
```

## 就像一个真正的男人一样

或者没有任何客户端类，只需调用它：

```
ServiceInvokerinvoker invoker = new ServiceInvoker(); 
var result = invoker.InvokeService<ISecurityManager, ReturnType>(     proxy => proxy.ExampleMethod(1) ); 
```

最后两个选项假设您已经配置了`ISecurityManager`客户端：

```
<client>     
<endpoint name="ServiceName" 
address="http://ServiceName.test/Service" 
binding="basicHttpBinding"   
contract="ISecurityManager" /> 
</client> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:53:35.923

要“通过单独的类”实现服务调用，您只需使用 svcutil.exe 或 Visual Studio 从正在运行的服务实例生成服务引用。

这将从您的服务合同中生成一组类型，这些类型将与包含您的服务合同和实施的程序集完全“分离”。

# c# - 我可以阻止 Uri 在 WebRequest.Create 中对 url 进行解编码吗？

> ID：12462597
> 
> 赞同：4
> 
> 时间：2012-09-17T15:35:56.380
> 
> 标签：c#, httpwebrequest, uri

代码本身并不复杂，只是无法正常工作：

```
Uri uri = new Uri("https://www.google.com/webmasters/tools/feeds/sites/http%3A%2F%2Fwww.mydomain.co.uk%2F");
WebRequest.Create(uri); 
```

我从服务器收到“错误请求”，经过大量挖掘，发现 Uri 正在变成

> [https://www.google.com/webmasters/tools/feeds/sites/http%3A//www.mydomain.co.uk/](https://www.google.com/webmasters/tools/feeds/sites/http%3A//www.mydomain.co.uk/)

这不是我要求的，所以它在抱怨

有没有办法阻止这种情况？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T15:54:49.147

在这里找到答案：[https ://stackoverflow.com/a/10415482/159341](https://stackoverflow.com/a/10415482/159341)

根据Microsoft Connect 上[此问题的错误报告](https://connect.microsoft.com/VisualStudio/feedback/details/511010/erroneous-uri-parsing-for-encoded-reserved-characters-according-to-rfc-3986)，此行为是设计使然，但您可以通过将以下内容添加到 app.config 或 web.config 文件来解决此问题：

```
<uri>
  <schemeSettings>
    <add name="http" genericUriParserOptions="DontUnescapePathDotsAndSlashes" />
  </schemeSettings>
</uri> 
```

（由于 WebRequest.Create(string) 只是委托给 WebRequest.Create(Uri)，因此无论调用哪种方法，都需要使用此解决方法。）

# c# - 使用报表查看器，如何从两个单独的数据集中提取

> ID：12462611
> 
> 赞同：3
> 
> 时间：2012-09-17T15:37:03.543
> 
> 标签：c#, reportviewer, rdlc

我有两个需要从中提取的数据集，一个是两个报告都使用的基础，然后是一个单独的一个，只有一个报告从中提取。我得到错误

> 错误 12 文本框“Textbox9”的值表达式引用字段“名称”。报表项表达式只能引用当前数据集范围内的字段，或者如果在聚合内，则只能引用指定的数据集范围。

我最好的猜测是我必须将它们与正确的数据集相关联，但我无法找到任何关于此的文档。

编辑：我正在尝试访问我为报告文档上的字段创建的属性文件。

有人可以告诉我`rdlc`我需要在文档中的哪个位置编写类似`name.value`“dataset1”或类似内容的代码吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T18:22:50.280

在 RLDC 中创建表时，必须在 Tablix 属性（选择行或列）中关联一个 DataSet。

之后，您必须在每个单元格中写入您将使用的字段（在数据集中）的名称。当您将鼠标放在单元格上时，您可以通过单击单元格中的“小表格”来执行此操作

在图像中（带有`Visual Studio 2010`）

![Tablix 属性](../Images/29aeced29c918e455e70e2d8e6006077.png)

![选择数据集](../Images/60d66e3d66b1145c39d43fdcd725b679.png)

![设置要显示的字段](../Images/448fea425afe04b7d528806e7c91b45e.png)

如果您在列表中看不到数据集，则必须添加它。为此，请单击查看菜单 -> 报告数据。然后，在 中`DummyDataSource`，单击`Add Dataset..`

![添加新的 DummyDataSource](../Images/e9ce46d35c0741fc16c250358fcec356.png)

并从列表中选择它，或者以相同的形式创建一个新的。 ![在此处输入图像描述](../Images/57b1d431d7b15b0cf017b1d56f781de6.png)

如果这不起作用，我不知道哈哈

如果两个数据集具有相同的结构，那么您可以只使用一个，并在代码中将其分配给数据源

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T16:17:12.713

我遇到了同样的错误，解决它的唯一方法是关闭并重新打开 BIDS，然后刷新存储过程中的字段（右键单击数据集 -> 数据集属性 -> 查询 -> 刷新字段）。

感谢您提供故障排除提示！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T18:23:03.970

如果您尝试将一个集合的结果嵌入到使用另一个数据集的表中，您是否考虑过子报表？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T20:23:06.153

经过一些仔细的研究和错误检查后，我发现我必须创建我的基本模型属性文件，并且当我将实际数据点拖到我的表单上时，我必须将它们与其正确的集合相关联：

![在此处输入图像描述](../Images/cdc8b4b62eb682d52f884252a4e3bf2d.png)

我单击了该值并关联了正确的数据集。

# actionscript-3 - EnterFrame 处理程序仅在时间轴在某个帧上停止时运行

> ID：12462613
> 
> 赞同：1
> 
> 时间：2012-09-17T15:37:18.697
> 
> 标签：actionscript-3, flash, actionscript

我在一个框架中有一些代码。基本上是

```
this.addEventListener(Event.ENTER_FRAME, handleUpdate);
function handleUpdate(e:Event):void
{...} 
```

我希望代码仅在该帧上执行。但是，即使我不在那个框架内，handleUpdate 函数也会不断被调用。

时间线在此帧上停止，我希望 handleUpdate 连续运行，直到时间线移出该帧。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:22:27.920

如果您打算在相关框架上使用此代码，那么您可以这样做：

```
 var tmpCurFrame:int = currentFrame; //store the current frame
        this.addEventListener(Event.ENTER_FRAME, handleUpdate)

        function handleUpdate(e:Event):void {
            if (tmpCurFrame != currentFrame) { //if the frame has changed, stop the frame handler
                this.removeEventListener(Event.ENTER_FRAME, handleUpdate);
                return;
            }
            //do your code
        }

        handleUpdate(null); 
```

顺便说一句，拥有一个文档类和其他类文件来管理这类事情而不是使用框架脚本要干净得多。但是，如果您正在寻找的只是对现有代码的快速而肮脏的调整，那么这应该可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T18:03:26.080

你没听说过[addFrameScript](http://www.as3dp.com/2009/09/a-closer-look-using-movieclipaddframescript/)吗？它非常适合您的需求。

```
var desiredFrame = 25;  // Timeline frame (starts from 1)
this.addFrameScript(desiredFrame-1, onFrame25);  // 1st param is zero-based

function onFrame25():void
{
    trace("I'm on frame", desiredFrame);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-20T17:46:47.900

您的方法应考虑以下几点：

*   在您关心的帧上添加一个 ENTER_FRAME 侦听器会在您进入该帧之后发生，因此如果正在播放影片剪辑，您将不会收到 ENTER_FRAME 事件，直到下一帧（此时它可能已移出该帧）。

*   请注意，每次播放头进入该帧时都会执行帧上的代码，并且您应该小心在适当的内存泄漏目的时删除侦听器。

因此，一种方法是将此代码放在有问题的框架上 - 请注意，它也很好地删除了它的侦听器：

```
var thisFrame:int = currentFrame;
function handleUpdate(e:Event) {
  if (currentFrame==thisFrame) {
    // your code here...
  } else {
    // remove listener if we moved off the frame
    removeEventListener(Event.ENTER_FRAME, handleUpdate);
  }
}
// call it now because the listener won't fire until next frame
handleUpdate(null);

// add listener in prep for next ENTER_FRAME, though note that
// if we move off this frame, then the listener is removed above
addEventListener(Event.ENTER_FRAME, handleUpdate); 
```

另一种方法是在第 1 帧添加以下代码，因此侦听器始终运行并且永远不会被清理，并且仅在第 12 帧时执行代码：

```
addEventListener(Event.ENTER_FRAME, handleUpdate);
function handleUpdate(e:Event):void
{
  if (currentFrame==12) {
    // your code here...
  }
} 
```

# c - 如何在 C 中正确设置、访问和释放多维数组？

> ID：12462615
> 
> 赞同：24
> 
> 时间：2012-09-17T15:37:19.610
> 
> 标签：c, dynamic, multidimensional-array, malloc

我已经看到几十个关于 C 中多维数组的“我的代码有什么问题”的问题。出于某种原因，人们似乎无法理解这里发生的事情，所以我决定回答这个问题作为对其他人的参考：

如何在 C 中正确设置、访问和释放多维数组？

如果其他人有有用的建议，请随时一起发布！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-09-17T15:45:58.900

在自 C99 以来的 C 中，即使是动态多维数组也可以轻松地一次性分配`malloc`和释放`free`：

```
double (*A)[n] = malloc(sizeof(double[n][n]));

for (size_t i = 0; i < n; ++i)
  for (size_t j = 0; j < n; ++j)
      A[i][j] = someinvolvedfunction(i, j);

free(A); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-09-17T15:50:14.850

在 C89 中创建或模拟多维数组至少有四种不同的方法。

一个是“分别分配每一行”，由 Mike 在他的回答中描述。它*不是*一个多维数组，它只是模仿一个（特别是它模仿访问元素的语法）。在每行具有不同大小的情况下它可能很有用，因此您不是表示矩阵，而是表示具有“参差不齐的边缘”的东西。

一种是“分配一个多维数组”。它看起来像这样：

```
int (*rows)[NUM_ROWS][NUM_COLS] = malloc(sizeof *rows);
...
free(rows); 
```

那么访问元素 [i,j] 的语法是`(*rows)[i][j]`. 在 C89 中，两者`NUM_COLS`和都`NUM_ROWS`必须在编译时知道。这是一个真正的二维数组，并且`rows`是指向它的指针。

一种是“分配行数组”。它看起来像这样：

```
int (*rows)[NUM_COLS] = malloc(sizeof(*rows) * NUM_ROWS);
...
free(rows); 
```

那么访问元素 [i,j] 的语法是`rows[i][j]`. 在 C89 中，`NUM_COLS`必须在编译时知道。这是一个真正的二维数组。

一种是“分配一维数组并假装”。它看起来像这样：

```
int *matrix = malloc(sizeof(int) * NUM_COLS * NUM_ROWS);
...
free(matrix); 
```

那么访问元素 [i,j] 的语法是`matrix[NUM_COLS * i + j]`. 这（当然）不是真正的二维数组。在实践中，它具有相同的布局。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-09-17T15:37:53.757

**从静态上讲**，这很容易理解：

```
int mtx[3][2] = {{1, 2},
                 {2, 3},
                 {3, 4}}; 
```

这里没有什么复杂的。3行2列；第一列数据：`1, 2, 3`; 第二列中的数据：`2, 3, 4`。我们可以通过相同的构造访问元素：

```
for(i = 0; i<3; i++){
    for(j = 0; j<2; j++)
        printf("%d ", mtx[i][j]);
    printf("\n");
}
//output
//1 2
//2 3
//3 4 
```

**现在让我们从Pointers**的角度来看这个：

方括号是一个非常好的结构，可以帮助简化事情，但是当我们需要在动态环境中工作时它并没有帮助，所以我们需要从指针的角度来考虑这一点。如果我们想存储整数的“行”，我们需要一个数组：

```
int row[2] = {1,2}; 
```

你知道吗？我们可以像指针一样访问它。

```
printf("%d, %d\n",*row,*(row+1));   //prints 1, 2
printf("%d, %d\n",row[0],row[1]);   //prints 1, 2 
```

现在，如果我们不知道一行中的值的数量，如果我们有一个指向 int 的指针，我们可以使这个数组成为动态长度，并且我们给它一些内存：

```
int *row = malloc(X * sizeof(int));  //allow for X number of ints
*row = 1;        //row[0] = 1
*(row+1) = 2; //row[1] = 2
…
*(row+(X-1)) = Y; // row[x-1] = Some value y 
```

所以现在我们有一个动态的一维数组；单行。但是我们想要很多行，而不仅仅是一个，而且我们不知道有多少。这意味着我们需要另一个动态的一维数组，该数组的每个元素都是指向一行的指针。

```
//we want enough memory to point to X number of rows
//each value stored there is a pointer to an integer
int ** matrix = malloc(X * sizeof(int *));

//conceptually:
(ptr to ptr to int)     (pointer to int)
   **matrix ------------> *row1 --------> [1][2]
                          *row2 --------> [2][3]
                          *row3 --------> [3][4] 
```

现在剩下要做的就是编写将执行这些动态分配的代码：

```
int i, j, value = 0;

//allocate memory for the pointers to rows
int ** matrix = malloc(Rows * sizeof(int*));

//each row needs a dynamic number of elements
for(i=0; i<Rows; i++){
    // so we need memory for the number of items in each row… 
    // we could call this number of columns as well
    *(matrix + i) = malloc(X * sizeof(int));

     //While we’re in here, if we have the items we can populate the matrix
    for(j=0; j<X; j++)
        *(*(matrix+i)+j) = value; // if you deference (matrix + i) you get the row
                                  // if you add the column and deference again, you
                                  // get the actual item to store (not a pointer!)
} 
```

现在要做的最重要的事情之一是确保我们在完成后释放内存。每个级别`malloc()`应该有相同的`free()`调用次数，并且调用应该是 FILO 顺序（malloc 调用的逆向）：

```
for(i=0; i<Rows; i++) 
    free(*(matrix + i));
free(matrix);

//set to NULL to clean up, matrix points to allocated memory now so let’s not use it!
matrix = NULL; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-10T06:45:05.757

如果你想使用 typedef 的数组，那就更简单了。

假设您的代码中有`typedef int LabeledAdjMatrix[SIZE][SIZE];`

然后你可以使用：

```
LabeledAdjMatrix *pMatrix = malloc(sizeof(LabeledAdjMatrix)); 
```

然后你可以写：

```
for (i=0; i<SIZE; i++) {
    for (j=0; j<SIZE; j++) (*parr)[i][j] = k++; /* or parr[0][i][j]... */
} 
```

因为`pArr`是指向您的矩阵的指针，并且`*`优先级低于`[]`;

这就是为什么模式常见的习惯用法是 typedef 行：

```
typedef int LabeledAdjRow[SIZE]; 
```

然后你可以写：

```
LabeledAdjRow *pMatrix = malloc(sizeof(LabeledAdjRow) * SIZE);
for (i=0; i<SIZE; i++) {
    for (j=0; j<SIZE; j++) parr[i][j] = k++;
} 
```

您可以`memcpy`直接进行所有操作：

```
LabeledAdjRow *pOther = malloc(sizeof(LabeledAdjRow) * SIZE);
memcpy(pOther, pMatrix, sizeof(LabeledAdjRow) * SIZE); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-22T18:14:41.350

离开 Jen 的回答，如果你想为 3D 数组分配空间，以同样的方式，你可以做

```
int(*A)[n][n] = malloc(sizeof(int[num_of_2D_arrays][n][n]));

for (size_t p = 0; p < num_of_2D_arrays; p++)
  for (size_t i = 0; i < n; i++)
    for (size_t j = 0; j < n; j++)
      A[p][i][j] = p;

for (size_t p = 0; p < num_of_2D_arrays; p++)
    printf("Outter set %lu\n", p);
    for (size_t i = 0; i < n; i++)
      for (size_t j = 0; j < n; j++)
        printf(" %d", A[p][i][j]);
      printf("\n");

free(A); 
```

# django - 在 Django 中查找相关对象的关系字段

> ID：12462616
> 
> 赞同：0
> 
> 时间：2012-09-17T15:37:24.000
> 
> 标签：django, django-models

假设我有这两个模型：

```
class Project(models.Model):
    name = models.CharField('Name', max_length=250)

class ProjectUpdate(models.Model):
    project = models.ForeignKey(Project)
    title = models.CharField('Title', max_length=250) 
```

假设在我的代码中我使用了一个项目实例，但我不能假设我正在使用的对象是一个项目实例。我只能假设它上面有一个或多个我需要处理的相关模型。

现在我设法使用相关管理器（project_obj.projectupdate_set）获取相关类名。但我现在需要知道哪个字段创建了关系。在这种情况下，这将是 ProjectUpdate 上的“项目”字段。

我找到引用它的唯一地方是`core_filters`相关经理的属性，它给了我：{'project__id': 1}

我可能可以使用它，但感觉不对。

任何想法 ？

**编辑**：

这是 RelatedManager 的属性：

```
['__class__', '__delattr__', '__dict__', '__doc__', '__format__', 
 '__getattribute__', '__hash__', '__init__', '__module__', '__new__', 
 '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', 
 '__str__', '__subclasshook__', '__weakref__', '_copy_to_model', '_db', 
 '_inherited', '_insert', '_set_creation_counter', '_update', 'add', 
 'aggregate', 'all', 'annotate', 'bulk_create', 'clear', 'complex_filter',
 'contribute_to_class', 'core_filters', 'count', 'create', 'creation_counter',
 'dates', 'db', 'db_manager', 'defer', 'distinct', 'exclude', 'exists', 
 'extra', 'filter', 'get', 'get_empty_query_set', 'get_or_create', 
 'get_prefetch_query_set', 'get_query_set', 'in_bulk', 'instance', 'iterator', 
 'latest', 'model', 'none', 'only', 'order_by', 'prefetch_related', 'raw',
 'remove', 'reverse', 'select_for_update', 'select_related', 'update', 'using',
 'values', 'values_list'] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:58:27.870

一种解决方法是添加以下内容[`related_name`](https://docs.djangoproject.com/en/dev/ref/models/fields/#django.db.models.ForeignKey.related_name)：

```
project = models.ForeignKey(Project, related_name='project') 
```

然后`project_obj.project`毫不奇怪 ProjectUpdate 的字段与哪个字段相关。所以通常添加一个`related_name`与字段名称相同的名称。

# python - Jenkins：获取配置时出现 HTTP 错误 403

> ID：12462620
> 
> 赞同：1
> 
> 时间：2012-09-17T15:37:38.333
> 
> 标签：python, jenkins

我尝试以编程方式更新 Jenkins 作业的配置，[python Jenkins api](http://packages.python.org/jenkinsapi/index.html)看起来不错，但由于 HTTP 错误 403（禁止），我无法检索配置：

```
from jenkinsapi import api
j = api.Jenkins('https://server.test.com/hudson', 'fp12210', 'xxxxxxxx')
job = j.get_job('BBB-100-CheckStatusAll')
conf = job.get_config()

Traceback (most recent call last):
  ...
  File "C:\Python27\lib\urllib2.py", line 521, in http_error_default
    raise HTTPError(req.get_full_url(), code, msg, hdrs, fp)
HTTPError: HTTP Error 403: Forbidden 
```

[如另一篇 SO post 中所述](https://stackoverflow.com/questions/7427557/jenkins-and-github-webhook-http-403)，在 URL 中添加用户和密码也失败了：

```
 j = api.Jenkins('https://fp12210:xxxxxxxx@server.test.com/hudson')

Traceback (most recent call last):
  ...
  File "build\bdist.win32\egg\jenkinsapi\utils\retry.py", line 39, in retry_function
    raise e
InvalidURL: nonnumeric port: 'xxxxxxxx@server.test.com/hudson' 
```

你有什么主意吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T10:03:00.477

这个[SO post](https://stackoverflow.com/questions/635113/python-urllib2-basic-http-authentication-and-tr-im)是解决方案。我现在收到错误 500，但这是另一个故事......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-04T22:51:58.313

[python jenkins](http://packages.python.org/jenkinsapi/index.html) api使用`urllib2`.

您可以看到这个答案：[https](https://stackoverflow.com/a/24048578/1733117) ://stackoverflow.com/a/24048578/1733117用于使用抢先式基本身份验证，或者在您获得时重试基本身份验证`403`（例如匿名用户的访问权限有限）。

# bash - 如何使用 awk 或 bash 打印文件夹中的所有文件名？

> ID：12462625
> 
> 赞同：1
> 
> 时间：2012-09-17T15:37:50.710
> 
> 标签：bash, awk

我想打印文件夹中的所有文件名。如何使用 awk 或 bash 执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-18T12:15:02.093

```
ls -l /usr/bin | awk '{ print $NF }' 
```

:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T16:00:02.210

```
find . -type f -maxdepth 1 
```

如果您还想对子目录进行递归，请排除 -maxdepth 部分

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-10-30T09:15:44.710

以下是纯 AWK 选项：

```
gawk '
    BEGINFILE {
        print "Processing " FILENAME
    };
' * 
```

如果您想将它用作处理多个文件的更大的 AWK 脚本的一部分并且想要记录当前正在处理的文件，这可能会有所帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-17T15:35:58.600

此命令将打印所有文件名：

```
for f in *; do echo "$f"; done 
```

或（甚至更短）

```
printf '%s\n' * 
```

或者，如果你想打印特定的文件类型（例如，`.txt`），你可以试试这个：

```
for f in *.txt; do echo "$f"; done 
```

或（甚至更短）

```
printf '%s\n' *.txt 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T16:01:26.340

/bin/ls 为您完成这项工作，您可以从 bash 中调用它。

```
$> /bin/ls
[.. List of files..] 
```

解释您的问题，您可能有兴趣遍历此目录中的每个文件。这也可以使用 bash 来完成：

```
for f in `ls`; do
   echo $f;
done 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-21T20:42:30.440

```
for f in *; do var=`find "$f" | wc -l`; echo "$f: $var"; done 
```

这将打印目录的名称和其中的文件数。`wc -l`这里返回文件数+1（包括目录）

样本输出：

```
aa: 4 
bb: 4 
cc: 1 
test2.sh: 1 
```

# regex - 正则表达式：如果宽度或高度小于 100 像素，则匹配标签

> ID：12462626
> 
> 赞同：2
> 
> 时间：2012-09-17T15:37:52.433
> 
> 标签：regex, nsregularexpression

我很想通过使用 Apples NSRegularExpressions 匹配和删除它们来摆脱 rssfeed 中的一些小图像。

```
<img src="somepic" height="1" width="1"> should be matched for removal
<img src="somepic" height="50" width="100"> -> should also be matched
<img src="somepic" height="100" width="100"> -> this one should not be matched 
```

我目前的方法还没有奏效

```
<img(\s*[height|width]\s*=\s*"([0-9]|[1-9][0-9])"\s*+|[^>]+?)*> 
```

我的猜测是捕获组存在一些问题（可能根本不需要）。有没有人暗示它为什么不工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:52:05.703

试试这个正则表达式：

```
<img[^>]*(?:height|width)\s*=\s*"[1-9]?[0-9]"[^>]*> 
```

它解决了 Mattias Buelens 在评论中提到的小问题。

见[红字](http://www.rubular.com/r/1HPUxNUQtV)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T16:01:05.823

这是`c#`正则表达式

```
(?<=<img).*?(height="([0-9]|[1-9][0-9])".*?width="([0-9]|[1-9][0-9])"|width="([0-9]|[1-9][0-9])".*?height="([0-9]|[1-9][0-9])").*?(?=>) 
```

希望这可以帮助..

# c# - c#：如何在出现任何特殊字符组合的前面快速插入一个字符？

> ID：12462629
> 
> 赞同：0
> 
> 时间：2012-09-17T15:38:02.973
> 
> 标签：c#, string, insert

我有一个字符串，我需要在其中转义任何出现的特殊字符组合。换句话说，我需要在任何此类组合的任何出现的前面加上一个“\”。大多数组合实际上是单个字符（例如双引号或反斜杠），但有些组合是多字符（例如“&&”）。一种方法是使用这些组合创建一个字符串数组，循环它们并运行 a `String.Replace()`，最后检查反斜杠以避免递归转义。但是有没有更好（更优雅/更快/等）的方法呢？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:42:45.563

使用您的 Replace 想法，但使用[StringBuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)代替（[更好的性能](http://www.dotnetperls.com/replace)）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:46:58.453

您可以为此使用[Regex.Replace 。](http://msdn.microsoft.com/en-us/library/xwewhkd1.aspx)

```
var input = @"abc'def&&aa\cc""ff";
var output = Regex.Replace(input, @"'|&&|""|\\", m => @"\" + m); // => "abc\'def\&&aa\\cc\"ff" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:44:29.780

您可以只取整个字符串并为您想要执行的每种替换类型运行 String.Replace()，据我所知，这是最快/最优雅的方法。这就是为什么它是一种内置方法。

# java - 私有集是什么 uniqueAuthors 在java代码段中指示？

> ID：12462631
> 
> 赞同：-2
> 
> 时间：2012-09-17T15:38:07.713
> 
> 标签：java, string, code-snippets

`private Set<String> uniqueAuthors;`java代码片段中的指示是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:39:00.563

它表明存在`Set`仅接受`Strings`命名为`uniqueAuthors`

这是Java 5 中引入的[泛型语法](http://docs.oracle.com/javase/tutorial/java/generics/)

# iphone - 检查框架是否在预编译时链接

> ID：12462632
> 
> 赞同：0
> 
> 时间：2012-09-17T15:38:11.640
> 
> 标签：iphone, objective-c, cocoa, frameworks, precompile

是否有一个预编译器指令来检查框架是否链接到 Obj-C/Cocoa 项目中？

例如，我有一类有用的类别和一些 MapKit 类别。但是，如果 MapKit 未链接到框架，则这些类别将无法编译。

有没有类似的东西：

```
#ifdef MAPKIT
....
// Only compiles if MapKit framework is linked to the current project
....
#endif 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-18T21:18:40.960

MapKit 还需要一个头文件。MKFoundation.h 定义`MK_EXTERN`. 你可以检查一下。

`#ifdef MK_EXTERN`

`#endif`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-18T20:16:17.193

不会。预处理和编译发生在一个构建阶段——*链接*是一个单独的阶段。

Xcode 没有为您提供一种简单的方法来访问/枚举与源文件中的链接相关的构建设置。

# python - Loaddata 未正确处理时间戳和时区

> ID：12462634
> 
> 赞同：6
> 
> 时间：2012-09-17T15:38:23.923
> 
> 标签：python, django, yaml

我正在使用启用了 mysql 和时区的 django 1.4.1。我向 yaml 做了一个转储数据，修改了一些字段以创建一些测试数据，并试图将其重新加载。然而，即使指定了 tz，Django 仍然抱怨天真的日期时间

具体来说，我的 loaddata 有：

```
fields: {created_date: !!timestamp '2012-09-15 22:17:44+00:00', ... 
```

但 loaddata 给出了错误：

```
RuntimeWarning: DateTimeField received a naive datetime (2012-09-15 22:17:44) while time zone support is active. 
```

这对我来说没有多大意义，因为它：

1.  UTC 时间戳
2.  Django 使用 dumpdata 导出的完全相同的格式

有什么方法可以告诉 django 这是一个 UTC 日期吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-04T20:28:29.000

问题源于 PyYAML。当 loaddata 将 datetime 交给 PyYAML 时，它会采用感知 datetime，将时间调整为 UTC，然后返回一个 naive datetime，它会生成警告。

有一张[Django 票](https://code.djangoproject.com/ticket/18867)，以及一张关于该问题的[PyYAML 票。](http://pyyaml.org/ticket/202)两者都对上述意外行为进行了更详细的介绍。从门票中的评论来看，这个问题似乎不太可能很快得到解决。

您是否`TIME_ZONE = 'UTC'`在项目的 settings.py 中进行了设置，您将在正确的时间加载，但您仍然会收到警告。如果您的时区设置为其他任何时间，Django 会将日期时间视为本地时间，并将其调整为 UTC，这可能是不希望的。

避免这种情况的最好方法是使用 JSON 作为序列化格式。

希望有帮助。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-15T18:35:32.103

从[文档](https://docs.djangoproject.com/en/dev/topics/i18n/timezones/#fixtures)...

> 序列化感知日期时间时，包括 UTC 偏移量，如下所示：
> 
> ```
> "2011-09-01T13:20:30+03:00" 
> ```
> 
> 对于一个天真的日期时间，它显然不是：
> 
> ```
> "2011-09-01T13:20:30" 
> ```

......所以而不是......

```
created_date: !!timestamp '2012-09-15 22:17:44+00:00' 
```

...任何一个...

```
created_date: '2012-09-15T22:17:44+00:00' 
```

...或者...

```
created_date: '2012-09-15T22:17:44Z' 
```

...将工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-09-08T13:43:46.400

您可以将 django/core/serializers/pyyaml.py 复制到您的项目目录中，并替换以下代码（对于 ver.1.9.9 可能是 78-79 行）

```
for obj in PythonDeserializer(yaml.load(stream, Loader=SafeLoader), **options):
    yield obj 
```

至

```
output = yaml.load(stream, Loader=SafeLoader)
for a_model in output:
    for key, value in a_model.items():
        if key == 'fields':
            for vkey, vvalue in value.items():
                if isinstance(vvalue, datetime.datetime):
                    value[vkey] = vvalue.replace(tzinfo=pytz.utc)
for obj in PythonDeserializer(output, **options):
    yield obj 
```

当然 pytz 已经安装并且

```
import pytz 
```

是需要的。

此代码会将所有原始日期时间值转换为 UTC 感知。

要覆盖默认序列化程序，请在 settings.py 中添加 SERIALIZATION_MODULES：

```
SERIALIZATION_MODULES = {'yaml': 'yourproj.pyyaml'} 
```

我希望这个猴子补丁能正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-01-08T19:49:21.120

我想继续使用 YAML 而不是 JSON 固定装置，以便我可以在数据中添加评论。这里的解决方法为我解决了这个问题：[https ://code.djangoproject.com/ticket/18867](https://code.djangoproject.com/ticket/18867)

即，手动更改 YAML 夹具，使其：

*   不使用 !!timestamp YAML 标签
*   用引号将时间戳值括起来
*   在时间戳值中包含时区信息

...显然这会触发 Django 的时间戳解析逻辑，而不是损坏的 PyYAML 逻辑。

# windows-phone-7 - 无法在 wp7 中对导航执行更新

> ID：12462636
> 
> 赞同：0
> 
> 时间：2012-09-17T15:38:28.453
> 
> 标签：windows-phone-7

我想在 wp7 中创建一个简单的数据库。在主页面中，我只需在数据库中添加记录，我有另一个按钮**视图**，用于导航到另一个页面，其中 gridview 控件可以显示数据库中已经完成的数据。在第二页中，我有两个按钮删除和更新，我有一个文本框，用户可以在其中输入 id，并基于该*id*可以完成删除和更新过程。我完成了删除操作，但我不知道如何更新选择的 id 因为点击更新按钮它应该导航到主页，并且必须在相应的字段中填写它们的相应值。当我尝试使用**onnavigated**获取所选 id 记录的方法，如果页面在启动期间加载，它会在行中抛出异常“no key was found”

> var n = PhoneApplicationService.Current.State ["list"];

如何使应用程序加载，使其不考虑密钥。请帮我解决这个问题。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:28:02.490

只需先检查密钥是否存在：

```
if (PhoneApplicationService.Current.State.ContainsKey("list") == true)
{
    n = PhoneApplicationService.Current.State["list"];
    PhoneApplicationService.Current.State.Remove("list");
} 
```

在尝试加载它之前。

# magento-1.4 - Magento->过滤集合中的产品可见性

> ID：12462637
> 
> 赞同：3
> 
> 时间：2012-09-17T15:38:28.987
> 
> 标签：magento-1.4

我们使用这个 Magento 代码来获取出版物列表，以便从中选择 2 显示在书店部分。

```
$collection = Mage::getModel('catalog/category')->getCollection();
$collection->addAttributeToSelect('url_key')
    ->addAttributeToSelect('name')
    ->addAttributeToSelect('id')
    ->addAttributeToSelect('description')
    ->addAttributeToSelect('is_anchor')
    ->addAttributeToFilter('is_active', 1)
    ->joinUrlRewrite()
    ->load(); 
```

如何添加要选择的属性以使其不包括设置为“不单独显示”的出版物？

如果我添加这个：

```
->addAttributeToFilter('visibility', 4) // Only catalog, search visiblity 
```

代码失败并显示消息“无效的属性名称：可见性”

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-02T22:25:51.480

知名度是产品属性，而不是类别属性。要获取只有可见性为 4 的*产品*，您需要获取产品集合并遍历它以获取最终的类别列表：

```
$categories = array();
$products = Mage::getModel('catalog/product')->getCollection()->addAttributeToFilter('visibility', 4);
foreach($products as $product){ 
  foreach($product->getCategoryIds() as $cat){
     $categories[] = $cat;
  }
}

$categories = array_values(array_unique($categories)); 
```

现在，`$categories`用我们唯一的类别列表填充数组，我们可以只加载这些类别：

```
$cat = Mage::getModel('catalog/category')->getCollection()->addIdFilter($categories); 
```

# sqlalchemy - sqlalchemy：会话提交时出错-“SessionMaker”对象没有属性“_model_changes”

> ID：12462638
> 
> 赞同：3
> 
> 时间：2012-09-17T15:38:29.293
> 
> 标签：sqlalchemy, flask, flask-sqlalchemy

我是 SqlAlchemy 的新手。我们主要使用 Flask，但在特定情况下，我需要手动连接数据库。所以我启动了一个新的数据库连接，如下所示：

```
write_engine = create_engine("mysql://user:pass@localhost/db?charset=utf8")
write_session = scoped_session(sessionmaker(autocommit=False,
    autoflush=False,bind=write_engine))

nlabel = write_session.query(Label).filter(Label.id==label.id).first() # Works
#Later in code
ms = Message("Some message")
write_session.add(ms) # Works fine
write_session.commit() # Errors out 
```

错误看起来像“AttributeError：'SessionMaker'对象没有属性'_model_changes'”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T17:05:42.397

从[文档中](http://docs.sqlalchemy.org/en/rel_0_7/orm/session.html?highlight=scoped%20session#sqlalchemy.orm.scoped_session)我认为您可能缺少 Session 对象的初始化。

尝试：

```
Session = scoped_session(sessionmaker(autocommit=False, autoflush=False,bind=write_engine))
write_session = Session() 
```

这是在黑暗中的一枪——我对 SQLAlchemy 并不十分熟悉。祝你好运！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-13T21:10:47.920

您的问题是您缺少这一行：

```
db_session._model_changes = {} 
```

# javascript - 如何从 URL 地址读取和存储 CGI 脚本生成的 XML

> ID：12462642
> 
> 赞同：0
> 
> 时间：2012-09-17T15:38:39.300
> 
> 标签：javascript, jquery, xml, cgi, cross-domain

我在读取由 CGI 生成的 XML 文件时遇到问题

假设我有一个这样的 url 地址：

```
http://test.mywebsite.com/cgi-bin/generateXML.cgi?listxml=1&oid=10037&bidderid=6217&aid=25731&tote= 
```

如果我在浏览器中打开它，它会返回一个 xml 文件并在浏览器中显示。

现在我需要做的是使用 javascript 和 jQuery 来检索这个地址生成的这个 XML 文件。

我尝试了如下代码：

```
$(document).ready(function()
{
    alert("HELLO!");

    var self = this;
    var target;

     $.get("http://test.mywebsite.com/cgi-bin/generateXML.cgi?listxml=1&oid=10037&bidderid=6217&aid=25731&tote=", function(d){  
        $(d).find("sale").each(function(){
         target = ($(this).find("target").text());
         alert(target);
        });
    });

}); 
```

但这不起作用。无法获取 XML。

另外我需要提一下，代码现在在我的本地计算机上，并且 URL 地址、cgi 文件在另一台服务器上。所以我想可能有一些跨域限制？

我只是不知道从哪里开始。谁能帮我？谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:50:32.923

> 所以我想可能有一些跨域限制？

是的。如果您可以控制另一台服务器，则必须为cgi 响应设置一些[CORS标头，例如](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)

```
Access-Control-Allow-Origin: localhost 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:42:19.153

可能更好的方法是使用 jQuery.parseXML()

[http://api.jquery.com/jQuery.parseXML/](http://api.jquery.com/jQuery.parseXML/)

# javascript - 使用 Google Maps API 从一组位置查找最小总行程距离的点

> ID：12462645
> 
> 赞同：1
> 
> 时间：2012-09-17T15:39:02.223
> 
> 标签：javascript, google-maps, distance

我有一个地址列表，我想找到一个到列表中所有地址的总**行驶距离**最短的点（通过使用 Google 距离矩阵服务获得）。

例如：我有一份所有员工地址的列表，我想为新办公室找个地方。从所有员工家到新办公室的总行车距离应该最短。

我想尝试每个道路交叉点然后比较结果，但我不知道如何获取附近的道路交叉点列表。

如何使用 Google Maps API 做到这一点？非常感谢！

# cocoa - 实时清除数据容器的内容

> ID：12462646
> 
> 赞同：0
> 
> 时间：2012-09-17T15:39:03.657
> 
> 标签：cocoa, concurrency, real-time, nsmutabledata

下面的架构最好地解释了我的问题![在此处输入图像描述](../Images/8fccdf761e450ba38f67e0a01d0b686b.png)

基本上，我必须`NSMutableData`实时清除对象（或任何其他对象）的内容，即，我不能阻止其包含的线程。有没有办法/API来做到这一点？

**更新：**正如下面评论中[提到](https://stackoverflow.com/a/12465372/766570)的..我正在将音频包实时接收到主线程并立即将其路由到专用的音频池线程..（我有这么多线程的原因是 b/ci 没有控制传入数据包的接收..它们是实时的+播放速度比接收数据的速度慢很多..因此单独的音频池线程和阅读器线程）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:48:17.900

[循环缓冲区（又称环形缓冲区）](http://en.wikipedia.org/wiki/Circular_buffer)与 NSMutableData 很好地配合使用，因为您可以直接将字节数组用作缓冲区。

查看设计，我不明白为什么需要这么多缓冲区。似乎一个线程和两个缓冲区太多了。为什么不只拥有一个环形缓冲区，将其填满（它是“自我清除”）并在单独的线程中读取呢？设计是你的（即可以改变）还是强加给你的？

无论如何，请尝试为您的音频池使用环形缓冲区。

# php - 无法在 PHP 的 if 块中设置变量的值

> ID：12462647
> 
> 赞同：1
> 
> 时间：2012-09-17T15:39:07.473
> 
> 标签：php, if-statement

有人可以解释为什么在调用 header($URL) 时，此代码中的 $URL 变量总是设置为“Location：unknown.php”吗？：如果我在第一行中注释掉声明/初始化，则代码有效，但我收到一个变量未声明的警告（如果我在 if 块之前声明 $URL 而不初始化它，我也会收到这些警告）。

```
$URL = 'Location: unknown.php';
if ($spring){
    if (($leaves)&&(!$stem)&&(!$root)&&(!$head)&&(!$whole)){$URL = 'Location: snow-mold.php';}
} else if ($other) {
    if ((!$leaves)&&(!$stem)&&(!$root)&&($head)&&(!$whole)){$URL = 'Location: o01.php';}
    if (($whole) || ($root) ){$URL = 'Location: o02.php';}
    if (($leaves)&&($stem)&&(!$root)&&($head)&&(!$whole)){$URL = 'Location: o03.php';}
    if (($leaves)&&($stem)&&(!$root)&&(!$head)&&(!$whole)){$URL = 'Location: o04.php';}
    if ((!$leaves)&&($stem)&&(!$root)&&($head)&&(!$whole)){$URL = 'Location: o03.php';}
    if (($leaves)&&(!$stem)&&(!$root)&&($head)&&(!$whole)){$URL = 'Location: o05.php';}
    if ((!$leaves)&&($stem)&&(!$root)&&(!$head)&&(!$whole)){$URL = 'Location: o06.php';}
    if (($leaves)&&(!$stem)&&(!$root)&&(!$head)&&(!$whole)){$URL = 'Location: o07.php';}
}
header($URL); 
```

好的，我已经简化了代码以突出显示问题...

```
$spring = (isset($_POST['season']) && strcmp($_POST['season'],'spring') == 0);
$URL = 'Location: unknown.php';
if ($spring){
    $URL = 'Location: snow-mold.php';
}
header($URL); 
```

总是重定向到 unknown.php。If I change `$URL = 'Location: unknown.php'`to `$URL;`, the code redirects to snow-mold.php if and only if spring is selected, But I get a $URL undefined warning.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:02:32.007

好吧，您可以使用一系列`if-elsif`构造重写您的代码 - 例如，您的穷人`leaves`将不会在该`$other`分支中被检查 7 次。

但我建议另一种方法：实现一个（某种）散列函数，将所有这些树部分作为参数（或者，更好的是，将这些值作为键的单个关联数组）：

```
function happy_tree_hash($leaves, $stem, $root, $head, $whole) {
    // assuming each of this can be only TRUE or FALSE,
    // a bit mask should suffice:
    return (bool)$leaves << 4 
        | (bool)$stem << 3 
        | (bool)$root << 2 
        | (bool)$head << 1 
        | (bool)$whole;
} 
```

...然后`$url`从一个简单的关联数组为您的变量赋值：

```
$locations = array(
  5 => 'o02.php',  // whole and root
  16 => 'o07.php', // leaves only 
  ... 
);
...
$key = happy_tree_hash($leaves, $stem, $root, $head, $whole);
if (isset($locations[$key])) {
    $url = $locations[$key];
} else {
    $url = 'unknown.php'; 
}
header("Location: $url"); 
```

# java - lucene：如何执行增量索引并避免“删除和重做”

> ID：12462652
> 
> 赞同：3
> 
> 时间：2012-09-17T15:39:20.453
> 
> 标签：java, lucene

我有一个包含大约 500 个文件的文件夹（MY_FILES），每天都有一个新文件到达并放置在那里。每个文件的大小约为 4Mb。

我刚刚开发了一个简单的“void main”来测试我是否可以在这些文件中搜索特定的通配符。它工作得很好。

问题是我正在删除旧的 indexed_folder 并再次重新索引。这需要很多时间，而且显然效率低下。我正在寻找的是“增量索引”。意思是，如果索引已经存在 - 只需将新文件添加到索引中。

我想知道 Lucene 是否有某种机制来检查“doc”是否在尝试索引之前被索引。像 writer.isDocExists 这样的东西？

谢谢！

我的代码如下所示：

```
 // build the writer
       IndexWriter writer;
       IndexWriterConfig indexWriter = new IndexWriterConfig(Version.LUCENE_36, analyzer);
       writer = new IndexWriter(fsDir, indexWriter);
       writer.deleteAll();  //must - otherwise it will return duplicated result 
       //build the docs and add to writer
       File dir = new File(MY_FILES);
       File[] files = dir.listFiles();
       int counter = 0;
       for (File file : files) 
       { 
           String path = file.getCanonicalPath();
           FileReader reader = new FileReader(file);
           Document doc = new Document();  
           doc.add(new Field("filename", file.getName(), Field.Store.YES, Field.Index.ANALYZED));
           doc.add(new Field("path", path, Field.Store.YES, Field.Index.ANALYZED));
           doc.add(new Field("content", reader));  

           writer.addDocument(doc);
           System.out.println("indexing "+file.getName()+" "+ ++counter+"/"+files.length);
       } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-17T22:06:25.077

首先，您应该使用`IndexWriter.updateDocument(Term, Document)`而不是`IndexWriter.addDocument`更新文档，这将防止您的索引包含重复的条目。

要执行增量索引，您应该将`last-modified`时间戳添加到索引的文档中，并且只索引较新的文档。

**编辑：**有关增量索引的更多详细信息

您的文档应至少包含两个字段：

> *   文件的路径
> *   最后一次修改文件时的时间戳。

在开始索引之前，只需在索引中搜索最新的时间戳，然后爬取目录以查找时间戳比索引的最新时间戳更新的所有文件。

这样，您的索引将在每次文件更改时更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T15:44:19.967

如果您想检查您的文档是否已经存在于索引中，一种方法可能是生成关联的 Lucene 查询，您将使用它`IndexSearcher`来搜索 Lucene 索引。

例如，在这里，您可以使用 fields 构建查询`filename`，`path`并`content`检查文档是否已存在于索引中。

您将需要一个`IndexSearcher`除了您的`IndexWriter`并遵循 ​​Lucene 查询语法来生成您将提供给 Lucene 的全文查询（例如

```
 filename:myfile path:mypath content:mycontent 
```

）。

```
IndexSearcher indexSearcher = new IndexSearcher(directory);

String query = // generate your query

indexSearcher.search(query, collector); 
```

在上面的代码中，`collector`包含一个回调方法 collect 如果索引中的某些数据与查询匹配，它将使用文档 ID 调用该方法。

# android - 在android中以编程方式为webview设置代理

> ID：12462657
> 
> 赞同：1
> 
> 时间：2012-09-17T15:39:53.860
> 
> 标签：android, proxy, android-webview

如何以编程方式为 webview 设置代理，该代理适用于 android 中的所有 api。任何示例代码或来源都会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:51:13.793

检查这个：[WebView android 代理](https://stackoverflow.com/questions/4488338/webview-android-proxy)

HttpHost 可以像这样创建：

```
HttpHost proxy = new HttpHost("someproxy", 8080); 
```

并传递给链接中写的方法。

希望能帮助到你，

# svn - 使用 Eclipse 提交 SVN

> ID：12462661
> 
> 赞同：0
> 
> 时间：2012-09-17T15:39:59.147
> 
> 标签：svn

我目前正在 Eclipse 中使用 SVN。

我切换到我的项目的旧版本并开始对该旧版本进行更改。现在，如果我提交，更改会记录为新版本还是会更改旧版本而不形成新版本？

示例：我的最新版本是 70。切换到 68。进行了更改。它会创建新版本'71'吗？还是改变了'68'？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:43:59.843

Subversion 将要求您执行更新以将您的更改与最新版本合并，然后再让您提交它们。新版本将是 71。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:44:28.977

您需要创建一个分支并从该版本开始工作。

分支意味着在存储库位置创建新的开发线。这在不同的情况下可能很有用，例如，如果不同的客户希望获得相同的产品，但在功能上有一些差异。

# jquery - AJAX 调用后关闭颜色框

> ID：12462663
> 
> 赞同：0
> 
> 时间：2012-09-17T15:40:25.607
> 
> 标签：jquery, ajax, colorbox

我有以下问题。我打开一个带有外部脚本的颜色框​​。

我在打开的脚本中编辑一个字段，然后按一个将输入保存在数据库中的按钮。这是通过 AJAX 完成的。AJAX 成功返回后，我将一些内容写入主网页并想关闭颜色框。但最后一件事不会发生。

这是我的脚本

```
$.ajax({
            type: "POST",  
            url: "./editfield_AJAX.php",
            data: {"q_table": q_table, "q_field": q_field, "q_idfield": q_idfield, "q_id": q_id, "waarde":$waarde},
            dataType: "text",
            success:function(data){

                window.parent.$("#" + q_table+q_field).html(data);

                //location.reload(true);
                // Reload the parent and close Cbox
                window.parent.$.colorbox.close();

        }
    }); 
```

只有当我禁用 location.reload(true) 命令时，颜色框才会关闭。但这不是我想要的，因为这样父级将被重新加载。

我在这里阅读了很多解决方案，但我不知道为什么它不起作用。

希望有人可以帮助我。

谢谢，弗兰克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:59:57.680

您是否尝试将`onClosed`事件处理程序添加到颜色框初始化代码并将`location.reload(true);`调用移到那里：

```
$('selector').colorbox({
    onClosed: function() {
        location.reload(true);
    }
}); 
```

这样，您`$.colorbox.close();`就可以调用 ajax 成功，并且仅在颜色框关闭后才应启动重新加载。

# excel - Excel将给定数字拆分为其他数字的总和

> ID：12462665
> 
> 赞同：2
> 
> 时间：2012-09-17T15:40:40.000
> 
> 标签：excel, excel-formula, vba

我正在尝试编写将给定数字拆分为其他 4 个数字之和的公式。

其他数字是 100,150,170 和 200，因此公式为 **x = a*100+b*150+c*170+d*200**其中 x 是给定数字，a,b,c,d 是整数。

我的电子表格设置为 col B 是 x 值，C、D、E、F 分别是 a、b、c、d（见下文）。

```
 B  |  C  |  D  |  E  |  F  |
  100    1     0     0     0
  150    0     1     0     0   
  200    0     0     0     1  
  250    1     1     0     0  
  370    0     0     1     1   
  400    0     0     0     2 
```

我需要 C、D、E、F 列的公式（公式中为 a、b、c、d）

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-13T23:48:17.570

**更新**：

根据以下研究，对于大于 730 的输入数字和/或所有实际可整除的输入数字，请使用以下公式：

```
100s: =CHOOSE(MOD(ROUNDUP([@number]/10;0); 20)+1;
       0;1;1;0;1;1;0;1;0;0;1;0;0;1;0;0;1;0;1;1)
150s: =CHOOSE(MOD(ROUNDUP([@number]/10;0); 10)+1;
       0;0;1;1;0;1;1;0;0;1)
170s: =CHOOSE(MOD(ROUNDUP([@number]/10;0); 5)+1;
       0;3;1;4;2)
200s: =CEILING(([@number]-930)/200;1) + 
       CHOOSE(MOD(ROUNDUP([@number]/10;0); 20)+1;
       4;1;2;0;2;3;1;3;1;2;4;2;3;0;2;3;0;3;0;1) 
```

*   `MOD(x; 20)`将返回数字 0 - 19，`CHOOSE(x;a;b;...)`将根据第一个参数返回第 n 个参数（1=>第二个参数，...）
*   查看[有关 CHOOSE 的更多信息](http://office.microsoft.com/en-us/excel-help/choose-HP005209013.aspx)
*   使用`,`而不是`;`基于您的 Windows 语言和区域设置

* * *

让我们首先假设您希望最好使用**200s 超过 170s 超过 150s 超过 100s** - 即`300=200+100`，而不是`300=2*150`遵循逻辑结论：

1.  结果集最多只能包含**1 个`100`**，**最多 1 个`150`**，**最多 4 个`170s`**，并且数量不限`200s`（*我从 9 开始，`170s`因为 1700=8x200+100，但实际上最多有 4 个*）

2.  (100s, 150s, 170s) 只有 20 个可能的子集 - 2*2*5 个选项

3.  `200s`930 是结果集中没有任何的最大输入数

4.  根据对数据点的观察，子集会定期重复
    `number = 740*k + 10*l, k>1, l>0`- 我不是从数据中反向猜测周期函数的专家，但这是我正在进行的工作*（图表数据点来自底部的表格回答）*

![面额的周期函数](../Images/d7f6a671f04e4072c55fe7166b9b85f4.png)

*   功能可能更复杂，如果我设法让它们正确，我会更新答案

*   无论如何，对于小于 740 的数字，需要对公式或查找表进行更多调整*（例如，无法获得 730，因此结果应该与 740 相同）*

* * *

这是我基于查找公式的解决方案： ![匹配+索引公式](../Images/60bbe3f145efe310d4a13c69c6ac89b8.png)

以下是我用来以csv 格式生成数据点、图片中的**公式**和**60 行表本身的****python 脚本***（按**函数需要排序）*：*****`match`*****

 ****```
headers = ("100s", "150s", "170s", "200s")
table = {}
for c200 in range(30, -1, -1):
    for c170 in range(9, -1, -1):
        for c150 in range(1, -1, -1):
            for c100 in range(1, -1, -1):
                nr = 200*c200 + 170*c170 + 150*c150 + 100*c100
                if nr not in table and nr <= 6000:
                    table[nr] = (c100, c150, c170, c200)
print("number\t" + "\t".join(headers))
for r in sorted(table):
    c100, c150, c170, c200 = table[r]
    print("{:6}\t{:2}\t{:2}\t{:2}\t{:2}".format(r, c100, c150, c170, c200))
__________

=IF(E$1<740; 0; INT((E$1-740)/200))
=E$1 - E$2*200
=MATCH(E$3; table[number]; -1)
=INDEX(table[number]; E$4)
=INDEX(table[100s]; E$4)
=INDEX(table[150s]; E$4)
=INDEX(table[170s]; E$4)
=INDEX(table[200s]; E$4) + E$2
__________

number,100s,150s,170s,200s
940,0,0,2,3
930,1,1,4,0
920,0,1,1,3
910,0,0,3,2
900,1,0,0,4
890,0,1,2,2
880,0,0,4,1
870,1,0,1,3
860,0,1,3,1
850,1,1,0,3
840,1,0,2,2
830,0,1,4,0
820,1,1,1,2
810,1,0,3,1
800,0,0,0,4
790,1,1,2,1
780,1,0,4,0
770,0,0,1,3
760,1,1,3,0
750,0,1,0,3
740,0,0,2,2
720,0,1,1,2
710,0,0,3,1
700,1,0,0,3
690,0,1,2,1
680,0,0,4,0
670,1,0,1,2
660,0,1,3,0
650,1,1,0,2
640,1,0,2,1
620,1,1,1,1
610,1,0,3,0
600,0,0,0,3
590,1,1,2,0
570,0,0,1,2
550,0,1,0,2
540,0,0,2,1
520,0,1,1,1
510,0,0,3,0
500,1,0,0,2
490,0,1,2,0
470,1,0,1,1
450,1,1,0,1
440,1,0,2,0
420,1,1,1,0
400,0,0,0,2
370,0,0,1,1
350,0,1,0,1
340,0,0,2,0
320,0,1,1,0
300,1,0,0,1
270,1,0,1,0
250,1,1,0,0
200,0,0,0,1
170,0,0,1,0
150,0,1,0,0
100,1,0,0,0
0,0,0,0,0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T17:57:44.840

假设您想要尽可能多的最高值（所以 500 将是 2*200 + 100）尝试这种方法，假设要在 B2 中拆分的数字向下：

在 C1:F1 范围内插入包含 4 个数字的标题行，例如 100、150、170 和 200

现在在 F2 中使用这个公式：

`=INT(B2/F$1)`

并在 C2 中复制到 E2

`=INT(($B2-SUMPRODUCT(D$1:$G$1,D2:$G2))/C$1)`

现在您可以将 C2:F2 中的公式复制到所有列中

那应该从你的表中给出结果****

# java - 实例化 Java 对象时发生异常 (ColdFusion)

> ID：12462666
> 
> 赞同：2
> 
> 时间：2012-09-17T15:40:39.647
> 
> 标签：java, coldfusion, itext

前段时间我发现了这个[添加到 pdf 的链接的解决方案。](https://stackoverflow.com/questions/2226993/how-to-adding-link-in-to-a-pdf-whis-coldfusion-and-itext)如果偶尔使用它就像一个魅力（在每次使用之间重新启动服务器）。我发现由于某种原因（我对 java 和 iText 不是很熟悉），在尝试第二次运行此脚本（无需重新启动）时，ColdFusion 返回错误：

> 对象实例化异常。
> 
> 实例化 Java 对象时发生异常。该类不能是接口或抽象类。错误： ''。

ColdFusion 然后指示导致错误的行似乎在：

```
pdfReader = createObject("java","com.lowagie.text.pdf.PdfReader").init(inputPath); 
```

谁对此了解更多，有解决方案或可以解释为什么会发生这种情况？我认为以某种方式创建的 java 对象在 java 中“存活”，但当然不能在 CF 中存活。

堆栈跟踪 ：

```
java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at coldfusion.runtime.java.JavaProxy.CreateObject(JavaProxy.java:166)
    at coldfusion.runtime.java.JavaProxy.invoke(JavaProxy.java:80)
    at coldfusion.runtime.CfJspPage._invoke(CfJspPage.java:2360)
    at cfSched_PushJobs2MultiPress32ecfm1907554548._factor16(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm:549)
    at cfSched_PushJobs2MultiPress32ecfm1907554548._factor17(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm:547)
    at cfSched_PushJobs2MultiPress32ecfm1907554548._factor45(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm:543)
    at cfSched_PushJobs2MultiPress32ecfm1907554548._factor25(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm)
    at cfSched_PushJobs2MultiPress32ecfm1907554548._factor49(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm:512)
    at cfSched_PushJobs2MultiPress32ecfm1907554548._factor51(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm:509)
    at cfSched_PushJobs2MultiPress32ecfm1907554548._factor53(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm:461)
    at cfSched_PushJobs2MultiPress32ecfm1907554548._factor58(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm:213)
    at cfSched_PushJobs2MultiPress32ecfm1907554548._factor129(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm:207)
    at cfSched_PushJobs2MultiPress32ecfm1907554548._factor146(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm:102)
    at cfSched_PushJobs2MultiPress32ecfm1907554548.runPage(E:\Inetpub\DashBoards\MultiPress\Sched_PushJobs2MultiPress3.cfm:1)
    at coldfusion.runtime.CfJspPage.invoke(CfJspPage.java:231)
    at coldfusion.tagext.lang.IncludeTag.doStartTag(IncludeTag.java:416)
    at coldfusion.filter.CfincludeFilter.invoke(CfincludeFilter.java:65)
    at coldfusion.filter.ApplicationFilter.invoke(ApplicationFilter.java:360)
    at coldfusion.filter.MonitoringFilter.invoke(MonitoringFilter.java:40)
    at coldfusion.filter.PathFilter.invoke(PathFilter.java:94)
    at coldfusion.filter.ExceptionFilter.invoke(ExceptionFilter.java:70)
    at coldfusion.filter.BrowserDebugFilter.invoke(BrowserDebugFilter.java:79)
    at coldfusion.filter.ClientScopePersistenceFilter.invoke(ClientScopePersistenceFilter.java:28)
    at coldfusion.filter.BrowserFilter.invoke(BrowserFilter.java:38)
    at coldfusion.filter.NoCacheFilter.invoke(NoCacheFilter.java:46)
    at coldfusion.filter.GlobalsFilter.invoke(GlobalsFilter.java:38)
    at coldfusion.filter.DatasourceFilter.invoke(DatasourceFilter.java:22)
    at coldfusion.filter.CachingFilter.invoke(CachingFilter.java:62)
    at coldfusion.CfmServlet.service(CfmServlet.java:200)
    at coldfusion.bootstrap.BootstrapServlet.service(BootstrapServlet.java:89)
    at jrun.servlet.FilterChain.doFilter(FilterChain.java:86)
    at coldfusion.monitor.event.MonitoringServletFilter.doFilter(MonitoringServletFilter.java:42)
    at coldfusion.bootstrap.BootstrapFilter.doFilter(BootstrapFilter.java:46)
    at jrun.servlet.FilterChain.doFilter(FilterChain.java:94)
    at jrun.servlet.FilterChain.service(FilterChain.java:101)
    at jrun.servlet.ServletInvoker.invoke(ServletInvoker.java:106)
    at jrun.servlet.JRunInvokerChain.invokeNext(JRunInvokerChain.java:42)
    at jrun.servlet.JRunRequestDispatcher.invoke(JRunRequestDispatcher.java:286)
    at jrun.servlet.ServletEngineService.dispatch(ServletEngineService.java:543)
    at jrun.servlet.jrpp.JRunProxyService.invokeRunnable(JRunProxyService.java:203)
    at jrunx.scheduler.ThreadPool$DownstreamMetrics.invokeRunnable(ThreadPool.java:320)
    at jrunx.scheduler.ThreadPool$ThreadThrottle.invokeRunnable(ThreadPool.java:428)
    at jrunx.scheduler.ThreadPool$UpstreamMetrics.invokeRunnable(ThreadPool.java:266)
    at jrunx.scheduler.WorkerThread.run(WorkerThread.java:66)
Caused by: java.io.IOException: Map failed
    at sun.nio.ch.FileChannelImpl.map(FileChannelImpl.java:758)
    at com.lowagie.text.pdf.MappedRandomAccessFile.init(Unknown Source)
    at com.lowagie.text.pdf.MappedRandomAccessFile.<init>(Unknown Source)
    at com.lowagie.text.pdf.RandomAccessFileOrArray.<init>(Unknown Source)
    at com.lowagie.text.pdf.RandomAccessFileOrArray.<init>(Unknown Source)
    at com.lowagie.text.pdf.PRTokeniser.<init>(Unknown Source)
    at com.lowagie.text.pdf.PdfReader.<init>(Unknown Source)
    at com.lowagie.text.pdf.PdfReader.<init>(Unknown Source)
    ... 48 more
Caused by: java.lang.OutOfMemoryError: Map failed
    at sun.nio.ch.FileChannelImpl.map0(Native Method)
    at sun.nio.ch.FileChannelImpl.map(FileChannelImpl.java:755)
    ... 55 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:04:33.607

错误给出了问题。转到第一个“Caused by”行：

```
java.lang.OutOfMemoryError: Map failed     at sun.nio.ch.FileChannelImpl.map0(Native Method) 
```

根本原因是您的内存不足。尝试增加 JVM 的可用内存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T16:44:02.217

这不是一个巨大的文件，但很大程度上取决于可用的服务器内存以及其他进程正在使用多少。您可能想尝试使用 a [`RandomAccessFileOrArray`](http://www.coderanch.com/how-to/javadoc/itext-2.1.7/com/lowagie/text/pdf/RandomAccessFileOrArray.html#RandomAccessFileOrArray%28java.lang.String,%20boolean,%20boolean%29)for reader 并缓冲 writer 输出。看看是否有帮助。此外，请确保您正在关闭压模和输出流。

```
// use random access when reading 
raf = createObject("java", "com.lowagie.text.pdf.RandomAccessFileOrArray").init(inputPath, false, true);
pdfReader = createObject("java", "com.lowagie.text.pdf.PdfReader").init( raf, javacast("null", ""));
... 
// buffer the output
fos = createObject("java", "java.io.FileOutputStream");
outStream = createObject("java", "java.io.BufferedOutputStream").init( fos.init( outputPath ) );
pdfStamper = createObject("java", "com.lowagie.text.pdf.PdfStamper").init( pdfReader, outStream ); 
```

# c# - 如何使 DataGridView 立即提交编辑？

> ID：12462667
> 
> 赞同：4
> 
> 时间：2012-09-17T15:40:39.357
> 
> 标签：c#, datagridview, master-detail, undo

我有一个主细节布局，其中包含一部分弹出菜单（详细信息）和一个包含行的 DataGridView 部分。

当 DataGridView 中的选定行发生更改时，弹出菜单状态将更新，并且当弹出菜单更改时，DGV 的选定行中的状态应更新。

*除了*DataGridView 中的行在我更改弹出菜单的值时不会立即更新之外，所有这些都有效。我必须选择不同的行才能看到我的编辑。

我假设这是因为在选择更改之前尚未提交编辑。

我的问题是：如何使对弹出窗口的更改立即反映在 DataGridView 中？

我已经尝试在弹出菜单的 SelectionChangeCommitted 处理程序中调用 EndEdit() ，但这没有效果。我对一种允许我创建 DataGridView 的技术感兴趣，该技术的行为就像一开始就没有撤消机制一样。理想情况下，该解决方案将是通用的并且可移植到其他项目。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-02-09T02:18:30.967

看起来现有答案适用于[`BindingSource`](https://msdn.microsoft.com/library/system.windows.forms.bindingsource(v=vs.110).aspx). 就我而言， where[`DataTable`](https://msdn.microsoft.com/library/system.data.datatable(v=vs.110).aspx)直接用作 a [`DataSource`](https://msdn.microsoft.com/library/system.windows.forms.datagridview.datasource(v=vs.110).aspx)，由于某种原因它们不起作用。

```
// Other answers didn't work in my setup...
private DataGridView dgv;

private Form1()
{
   var table = new DataTable();
   // ... fill the table ...
   dgv.DataSource = table;
} 
```

经过一番拉扯后，我在不添加`BindingSource`间接的情况下让它工作：

```
// Add this event handler to the DataGridView
private void dgv_CellEndEdit(object sender, DataGridViewCellEventArgs e)
{
    dgv.BindingContext[dgv.DataSource].EndCurrentEdit();
}

private Form1()
{
   dgv.CellEndEdit += dgv_CellEndEdit;
   // ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T19:14:30.090

这就是发生的事情。答案在于`ComboBox`实例的属性。我需要将它们`DataSourceUpdateMode`从更改`OnValidation`为`OnPropertyChanged`。这是有道理的。`DataGridView`很可能显示数据的当前状态。只是数据还没有被编辑，因为焦点没有离开`ComboBox`，验证输入。

感谢大家的回复。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-05T00:38:50.127

这对我很有效：

```
private void CurrentCellDirtyStateChanged(object sender, EventArgs e)
{
    var dgw = (DataGridView) sender;
    dgw.CommitEdit(DataGridViewDataErrorContexts.Commit);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-31T07:39:49.327

使用此扩展方法。它适用于所有列类型，而不仅仅是组合框：

```
 public static void ChangeEditModeToOnPropertyChanged(this DataGridView gv)
        {
            gv.CurrentCellDirtyStateChanged += (sender, args) =>
            {
                gv.CommitEdit(DataGridViewDataErrorContexts.Commit);
                if (gv.CurrentCell == null)
                    return;
                if (gv.CurrentCell.EditType != typeof(DataGridViewTextBoxEditingControl))
                    return;
                gv.BeginEdit(false);
                var textBox = (TextBox)gv.EditingControl;
                textBox.SelectionStart = textBox.Text.Length;
            };
        } 
```

此方法在更改完成后提交所有更改。

当我们有一个文本列时，在键入一个字符后，它的值将提交给 DataSource 并且单元格的编辑模式将结束。

因此，当前单元格应返回编辑模式，并将光标位置设置为文本末尾，以使用户能够继续输入文本提示。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T17:30:30.740

调用[DataGridView.EndEdit](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.endedit.aspx)方法。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-02-09T11:41:09.923

以下将起作用

```
_dataGrid.EndEdit() 
```

设置值后就可以了。

# spring-aop - Spring AOP - 填充模型数据

> ID：12462669
> 
> 赞同：0
> 
> 时间：2012-09-17T15:40:49.333
> 
> 标签：spring-aop

问题 1：在 portlet MVC 环境中使用 Spring AOP 填充/创建模型是一种好习惯吗？我们已经广泛使用 Spring AOP 从外部源填充\创建模型对象。当非常广泛地用于查询执行等事情时，AOP 在性能方面是否代价高昂？我被告知 AOP 有利于横切关注点，并且填充模型数据似乎不是横切关注点，而是主要关注点。我将不胜感激在这方面的任何指导。

问题2：我有一个这样的切入点：

```
@Pointcut("execution(* getSomething(..))") 
```

我有这样的课：

```
 Class Aclass extends ASuper{

     Somedata getSomething(String str){
         super.getSomething(str);
      }
    } 
```

ASuper 也有 getSomething 方法，切入点的切面会执行多少次？我想了两次，但在这里有点困惑，因此提出了这个问题。感谢您的澄清。

# jquery - 动态生成的 HTML 不起作用

> ID：12462673
> 
> 赞同：1
> 
> 时间：2012-09-17T15:41:00.810
> 
> 标签：jquery, struts

我正在使用 JQuery 在我的 DIV 元素中插入 HTML 我的 JSP 页面中有以下代码

```
<div id="definitionsDiv">
    <s:select id="typeDropdown" list="types" listKey="id" listValue="value" value="3" onchange="getWordList()"/>        
</div> 
```

HTML看起来像

```
<div id="definitionsDiv">
  <select id="typeDropdown" onchange="getWordList()" name="">
    <option value="1">Adverb</option>
    <option value="2">Adjective</option>
    <option selected="selected" value="3">Noun</option>
    <option value="4">Other</option>
  </select>
</div> 
```

这可以正常工作并显示一个下拉列表，其中包含从我的 Struts 操作中的“类型”字段检索到的值。但是，我想动态生成这个 HTML，所以我在我的文档加载方法中调用了以下内容......

```
function buildDefinitionsHTML()
{
    $("#definitionsDiv").empty();
    $("#definitionsDiv").append('<s:select id="typeDropdown" list="types" listKey="id"     listValue="value" value="1" onchange="getWordList()"/>');
} 
```

现在我生成的 HTML 看起来像

```
<div id="definitionsDiv">
  <s:select id="typeDropdown" onchange="getWordList()" value="1" listvalue="value"     listkey="id" list="types"></s:select>
</div> 
```

当我将静态 HTML 留在我的页面中时，似乎没有回叫我填充选项列表的操作。任何想法如何让它发挥作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:47:36.690

客户端 JavaScript 不可能将服务器端代码添加到页面。您需要做的是在服务器端创建两个 HTML 块并隐藏其中一个。

JSP 不是我的领域，但这可能有效。JSP/HTML：

```
<div id="definitionsDiv">
    <s:select id="typeDropdown" list="types" listKey="id" listValue="value" value="3" onchange="getWordList()"/>        
</div>
<div id="definitionsDiv2" style="display:none">
  <s:select id="typeDropdown" onchange="getWordList()" value="1" listvalue="value"     listkey="id" list="types"></s:select>
</div> 
```

jQuery：

```
function buildDefinitionsHTML() {
    $("#definitionsDiv").empty().append($('#definitionsDiv2').children()); 
} 
```

以`.append()`这种方式使用会将现有的 DOM 元素从隐藏的 DIV 移动到所需的目标 DIV。

但是，使用`display:none`只隐藏页面中的第二个 DIV；它不会删除它。因此，您可能希望移出`definitionsDiv2`您的`<form>`标签，以免它与`definitionsDiv`.

# sql-server - SQL Server 返回错误“用户 'NT AUTHORITY\ANONYMOUS LOGON' 登录失败。” 在 Windows 应用程序中

> ID：12462674
> 
> 赞同：72
> 
> 时间：2012-09-17T15:41:04.363
> 
> 标签：sql-server, security, sqlconnection

一个一直正常工作的应用程序（并且在大约 6 个月左右的时间里没有对其进行任何积极的开发）最近开始无法连接到数据库。运营管理员无法说出可能导致问题的更改。

客户端应用程序使用 Integrated Security=True 的硬编码连接字符串，但是当应用程序尝试创建与数据库的连接时，它会抛出 SQLException 提示“用户'NT AUTHORITY\ANONYMOUS LOGON 登录失败”。

我可以在这个帐户上通过 Management Studio 毫无问题地登录到数据库。我在这个问题上看到的所有东西都是针对 ASP.NET 项目的，显然是“双跳问题”，作为客户端应用程序最好不要成为问题。任何帮助将不胜感激。

## 编辑

客户端机器和服务器机器以及用户帐户在同一个域中。当 Windows 防火墙关闭时会发生这种情况。

领先的理论是：服务器在大约一周前重新启动，并且未能注册服务主体名称 (SPN)。未能注册 SPN 可能会导致集成身份验证回退到 NTLM 而不是 Kerberos。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-18T03:00:30.880

如果您的问题与链接服务器有关，则需要查看一些事项。

首先，您的用户需要启用委派，如果唯一改变了，他们很可能会这样做。否则，您可以取消选中“帐户敏感且无法委派”复选框是 AD 中的用户属性。

其次，必须信任您的服务帐户才能进行委派。由于您最近更改了服务帐户，我怀疑这是罪魁祸首。( [http://technet.microsoft.com/en-us/library/cc739474(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc739474%28v=ws.10%29.aspx) )

您提到您可能有一些 SPN 问题，因此请务必为两个端点设置 SPN，否则您将无法在 AD 中看到委派选项卡。还要确保您处于“Active Directory 用户和计算机”的高级视图中。

如果您仍然看不到委派选项卡，即使在更正您的 SPN 之后，请确保您的域不在 2000 模式下。如果是，您可以“提升领域功能级别”。

此时，您现在可以将该帐户标记为受信任的委托：

> 在详细信息窗格中，右键单击您希望委托信任的用户，然后单击“属性”。
> 
> 单击委派选项卡，选中帐户受信任以进行委派复选框，然后单击确定。

最后，您还需要将所有机器设置为受信任的委派。

完成此操作后，重新连接到您的 sql 服务器并测试您喜欢的服务器。他们应该工作。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-07-10T15:01:02.237

首先：我的问题与您的问题不完全相同，但这篇文章是`Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON'`我写这篇文章时谷歌出现的第一个错误。该解决方案可能对搜索此错误的人有用，因为我在网上的任何地方都没有找到这个特定的解决方案。

就我而言，我使用 Xampp/Apache 和 PHP sqlsrv 尝试使用 Windows 身份验证连接到 MSSQL 数据库并收到`Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON'`您描述的错误。我终于发现问题是在用户“本地服务”下运行的 Apache 服务本身，而不是我登录的用户帐户。换句话说，它实际上是在使用匿名帐户。解决方案是进入 services.msc，右键单击 Apache 服务，转到属性，转到登录选项卡，然后输入用户的凭据。这符合您与 SPN 相关的问题，因为您的 SPN 设置为从域上的特定用户运行。因此，如果没有运行正确的 SPN，Windows 身份验证将默认使用错误的用户（可能是“本地服务”用户）并给您匿名错误。

这是与您的问题不同的地方。本地网络上的所有计算机都不在域上，它们仅在工作组上。要将 Windows 身份验证与工作​​组一起使用，具有服务器的计算机（在我的情况下为 MSSQL Server）和具有服务请求数据的计算机（在我的情况下为 Apache）都需要有一个具有相同名称和相同密码的用户。

总而言之，`Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON'`我们这两种情况下的错误似乎都是由服务未运行和/或不在正确的用户身上引起的。确保正确的 SPN 或其他服务正在运行并且在正确的用户下应该解决问题的匿名部分。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-17T16:10:49.130

我认为用于对数据库进行身份验证的 AD 组一定有一些变化。将格式为 domain\webservername$ 的 Web 服务器名称添加到有权访问数据库的 AD 组。此外，还尝试将 web.config 属性设置为“false”。希望能帮助到你。

**编辑**：按照您编辑的内容进行。它很可能表明您的 SQL Server 的身份验证协议已从 Kerberos（默认，如果您使用 Windows 集成身份验证）退回到 NTLM。要使用 Kerberos 服务主体名称 (SPN)，必须在 Active Directory 目录服务中注册。服务主体名称 (SPN) 是在服务器上运行的服务的唯一标识符。将使用 Kerberos 身份验证的每个服务都需要为其设置一个 SPN，以便客户端可以识别网络上的服务。它以计算机帐户或用户帐户在 Active Directory 中注册。虽然 Kerberos 协议是默认的，但如果默认失败，将尝试使用 NTLM 进行身份验证过程。

在您的场景中，客户端必须建立 tcp 连接，并且它很可能在 LocalSystem 帐户下运行，并且没有为 SQL 实例注册 SPN，因此使用 NTLM，但是，LocalSystem 帐户继承自 System Context 而不是真正的用户因此，基于上下文的上下文失败为“匿名登录”。

要解决此问题，如果您的 SQL Server 在域用户帐户下运行，请您的域管理员手动注册 SPN。以下链接可能对您有更多帮助：http:
[//blogs.msdn.com/b/sql_protocols/archive/2005/10/12/479871.aspx](http://blogs.msdn.com/b/sql_protocols/archive/2005/10/12/479871.aspx)
[http://support.microsoft.com/kb/909801](http://support.microsoft.com/kb/909801)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-05-22T06:11:36.150

您可能只需要在连接字符串中提供用户名和密码并设置 Integrated Security=false

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-08-12T14:42:02.873

我的一项 SQL 作业也有同样的问题。它涉及将数据从一台服务器上传到另一台服务器。发生错误是因为我使用的是 sql Server 代理服务帐户。我使用所有服务器通用的 UserId（使用 Window 身份验证）创建了一个凭据。然后使用此凭据创建代理。在 sql server 作业中使用了代理，它运行良好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-12-17T06:32:11.220

尝试在连接字符串中设置“Integrated Security=False”。

```
<add name="YourContext" connectionString="Data Source=<IPAddressOfDBServer>;Initial Catalog=<DBName>;USER ID=<youruserid>;Password=<yourpassword>;Integrated Security=False;MultipleActiveResultSets=True" providerName="System.Data.SqlClient"/> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-02-05T15:50:22.287

**解决了一个类似的案例：**

在我们的例子中，我们希望使用 cnames 和登录当前安全上下文来设置链接服务器。

我们检查了运行 SQL Server 的服务帐户是否设置了正确的 spns，以及 AD 对象是否受信任以进行委派。但是，虽然我们能够直接连接到 cname，但在调用其 cname 上的链接服务器时仍然存在问题：`Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON'.`

我们花了很长时间才意识到我们使用的 cnames 用于 A 记录 [A]，它设置在更高的 dns 级别，而不是在其自己的域 AD 级别中。最初，我们将 cname 指向 [A].example.com 而不是（应该在哪里）指向：[A].domain.ad.example.com

当然，我们有这些关于匿名登录的错误。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-06-07T02:19:07.243

FWIW，在我们的例子中，在 IIS 上运行的 (PHP) 网站在尝试连接到数据库时显示此消息。

解决方案是编辑该网站上的匿名身份验证以使用应用程序池身份（我们将应用程序池条目设置为使用为该网站设计的服务帐户）。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-09-14T19:50:42.697

知道了！解决了在 SQL Server 的安全会话中修改用户属性的问题。在 SQL Server 管理中，进入安全 -> 登录 -> 选择用于数据库连接的用户并进入他的属性。转到“Securators”选项卡并查找“Connect SQL”行，标记“Grant”选项并尝试一下。这个对我有用！

问候

# php - 解析 AndroidManifest 属性

> ID：12462675
> 
> 赞同：0
> 
> 时间：2012-09-17T15:41:08.767
> 
> 标签：php, android, android-manifest

我用 PHP 制作了一个简单的 apk 上传器，我想解析清单属性表单`AndroidManifest.xml`，但出现以下错误，有什么想法！？

```
Fatal error: Call to a member function xpath() on a non-object in E:\AppServ\www\apkUploader\mainApi.php on line 21 
```

***第 21 行 =*** `$versionName = $xml->xpath('/manifest/@android:versionName');`

***源代码 ：***

```
/* For Apk File */

if (($_FILES["mFile"]["type"] == "application/vnd.android.package-archive") || ($_FILES["mFile"]["type"] == "application/octet-stream"))
{
    if ($_FILES["mFile"]["error"] > 0)
      {
          echo "Return Code: " . $_FILES["mFile"]["error"] . "<br />";
      }
    else
      {
          echo "Upload: " . $_FILES["mFile"]["name"] . "<br />";
          echo "Type: " . $_FILES["mFile"]["type"] . "<br />";
          echo "Size: " . ($_FILES["mFile"]["size"] / 1024) . " Kb<br />";
          echo "Temp file: " . $_FILES["mFile"]["tmp_name"] . "<br />";
          error_reporting(E_ERROR | E_PARSE);
          $dom = new DOMDocument();
          $dom->load('AndroidManifest.xml');
          $xml = simplexml_import_dom($dom);
          $versionName = $xml->xpath('/manifest/@android:versionName');
          $versionCode =$xml->xpath('/manifest/@android:versionCode');
          $package = $xml->xpath('/manifest/@package');
          echo "VERSION NAME :".$versionName[0]->versionName."<br/>";
          echo "VERSION CODE :".$versionCode[0]->versionCode."<br/>";
          echo "VERSION PAC :".$package[0]->package."<br/>";
          if (file_exists("upload/" . $_FILES["mFile"]["name"]))
            {
              echo $_FILES["mFile"]["name"] . " already exists. ";
            }
          else
            {
              move_uploaded_file($_FILES["mFile"]["tmp_name"],
              "upload/" . $_FILES["mFile"]["name"]);
              echo "Stored in: " . "upload/" . $_FILES["mFile"]["name"];
            }
      }
  }
else
  {
      echo "Invalid file";
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:34:05.970

看起来`$xml = simplexml_import_dom($dom);`没有返回有效对象。这通常意味着无法加载或解析文件。

不要忘记检查是否有错误：

```
$xml = simplexml_import_dom($dom);
if (!$xml)
{
    // An error occurred
} 
```

# playframework-2.0 - playframework 使用 nexus 服务器的凭据解析工件

> ID：12462676
> 
> 赞同：1
> 
> 时间：2012-09-17T15:41:16.070
> 
> 标签：playframework-2.0, credentials, nexus, resolver

我开始了一个新的游戏项目：xyz。我想添加对 customGroupId:customArtifactId:0.10 的依赖项，该依赖项托管在主机 nexus.xyz.com 上的 nexus 存储库中，但只能通过用户名和密码访问。

所以，我编辑了 xyz\project\Build.scala

```
import sbt._
import Keys._
import PlayProject._

object ApplicationBuild extends Build {

    val appName         = "xyz"
    val appVersion      = "1.0-SNAPSHOT"

    val appDependencies = Seq(
      "customGroupId" % "customArtifactId" % "0.10"
    )

    val main = PlayProject(appName, appVersion, appDependencies, mainLang = JAVA).settings(
      credentials += Credentials("realm1", "nexus.xyz.com", "myUser", "myPassword"),

      resolvers += "realm1" at "https://nexus.xyz.com/svn/eessi/maven2/releases"
    )

} 
```

然后我在xyz跑了。

```
play
run 
```

我明白了

```
play! 2.0.3, http://www.playframework.org
[xyz] $ run
[info] Updating {file:/C:/Users/grigocn/work/xyz/}xyz...
[warn]  module not found: customGroupId#customArtifactId;0.10
[warn] ==== local: tried
[warn]   c:\Users\grigocn\apps\play\framework\..\repository/local/customGroupId/customArtifactId/0.10/ivys/ivy.xml
[warn] ==== Typesafe Releases Repository: tried
[warn]   http://repo.typesafe.com/typesafe/releases/customGroupId/customArtifactId/0.10/customArtifactId-0.10.pom
[warn] ==== realm1: tried
[warn]   https://webgate.ec.europa.eu/CITnet/svn/eessi/maven2/releases/customGroupId/customArtifactId/0.10/customArtifactId-0.10.pom
[warn] ==== public: tried
[warn]   http://repo1.maven.org/maven2/customGroupId/customArtifactId/0.10/customArtifactId-0.10.pom
[warn]  ::::::::::::::::::::::::::::::::::::::::::::::
[warn]  ::          UNRESOLVED DEPENDENCIES         ::
[warn]  ::::::::::::::::::::::::::::::::::::::::::::::
... 
```

PS。我试图遵循这一点，但没有奏效：[Play framework and sbt:passing credentials to a nexus passowrd protected repo](https://stackoverflow.com/questions/10905695/play-framework-and-sbt-passing-credentials-to-a-nexus-passowrd-protected-repo)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T15:30:57.243

你检查域名是否正确？我的关系领域（我认为是默认领域）例如是

> Sonatype Nexus 存储库管理器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T14:19:40.133

我发现/记得领域不是我可以用来引用服务器的唯一标识符，而是当您进行身份验证时服务器显示的文本。

在这种情况下，领域是“PROXY_INTERNET” ![领域认证](../Images/e49d53aba259c350d62fa084ed4439b0.png)

所以现在我的有效配置如下。请注意，“eessi-releases”不是服务器的领域或 id。

```
import sbt._
import Keys._
import PlayProject._
import com.github.play2war.plugin._

object ApplicationBuild extends Build {

    val appName         = "reliable-transport-ui"
    val appVersion      = "1.0-SNAPSHOT"
    val bmServerVersion = "0.113"

    //val mySubProject = Project("transport-server", file("../reliable-transport-server/src/main/java")) 
    //val mySubProject2 = Project("transport-server", file("../reliable-transport-server/src/main/resources")) 

    val appDependencies = Seq(
      javaCore,
      javaJdbc,
      // Add your project dependencies here,
      "commons-io" % "commons-io" % "1.4"
    )

    import com.typesafe.sbteclipse.core.EclipsePlugin._

    import play.Project._ 

    val main = play.Project(appName, appVersion, appDependencies).settings(defaultScalaSettings:_*).settings(
        //Subversion is the realm - the text displayed by server when it asks for username/password. Don't change it from <Subversion>
        credentials += Credentials("Subversion", "webgate.ec.europa.eu", "grigocn", "<pass>")

        ,resolvers += "eessi-releases" at "https://webgate.ec.europa.eu/CITnet/svn/eessi/maven2/releases"

        ,resolvers += "eessi-thirdparty" at "https://webgate.ec.europa.eu/CITnet/svn/eessi/maven2/thirdparty"

        ,resourceDirectory in Test <<= baseDirectory(_ / "test-resources")

        ,EclipseKeys.createSrc := EclipseCreateSrc.Default + EclipseCreateSrc.Resource

        ,EclipseKeys.withSource := true 
    )
) 
```

# wix - 有没有办法让热量使用由热量生成的文件作为指南的来源？

> ID：12462679
> 
> 赞同：2
> 
> 时间：2012-09-17T15:41:32.013
> 
> 标签：wix, wix3.6

我刚刚开始再次查看 wix，因为看起来安装程序项目将从 VisualStudio 中弃用。我们有一个“通过 xcopy 安装”的第三方应用程序，这使我们很难跟踪版本控制，因此我们想为其创建一个 msi。有数百个文件是安装的一部分。

我想使用 heat 为安装程序创建文件列表，但我听说使用 heat 使用 autoguids 多次创建 wxs 文件并不好，因为那样你的安装程序会出现问题。

我想知道在 wix 3.6 中是否有一个用于 heat 的命令行参数，它将以前生成的 wxs 文件作为 guid 的源？我希望 heat 为任何新文件自动生成 guid，但使用 heat 的先前输出作为现有文件的数据库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T06:41:02.143

如果您使用该`-ag`标志，这将设置在编译时生成的 guid，并且只要路径不更改，编译器将为每个组件保留相同的 guid。与其使用命令行进行收集，不如编辑`*.wixproj`文件并添加[HeatDirectory](http://wix.sourceforge.net/manual-wix3/msbuild_task_reference_heatdirectory.htm)元素。

# jquery - 使用数据表对行重新排序时 IE 中的滚动条问题

> ID：12462693
> 
> 赞同：0
> 
> 时间：2012-09-17T15:42:03.753
> 
> 标签：jquery, datatables

我们正在使用流行的 JQuery Datatables 插件以及相应的[Row Reordering](http://jquery-datatables-row-reordering.googlecode.com/svn/trunk/index.html)插件。

我们的数据表包含一个滚动条。

IE8 中出现了一个问题，即当您尝试将一行从底部拖动到顶部时，滚动条不会移动。这在 Chrome 和 Firefox 中运行良好，并且在 IE 中不会产生任何 JS 控制台错误。我对如何解决这个问题有点不知所措，所以如果有任何关于如何开始的建议，我将不胜感激？

以下是我的数据表设置：

```
 <%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <%@ taglib prefix="spring" uri="http://www.springframework.org/tags" %>
    <%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>
    <%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
    <%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.blockUI.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.cookie.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.ui.core.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.ui.widget.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.ui.tabs.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.ui.accordion.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.ui.autocomplete.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.ui.position.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.dataTables.js"></script>    
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.ui.sortable.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.ui.custom.js"></script>
    <script type="text/javascript" src="<%=request.getContextPath()%>/javascript/jquery/jquery.dataTables.rowReordering.js"></script>
<title>Test reordering</title>
</head>
<body>
    <body onload="setupTables() ;">
    <div id="myDiv" style="height:250px; border:1px; color: blue">
        <table id="myTable">
            <thead>
                <tr>
                    <th>Element Heading</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Element 1</td>
                </tr>
                <tr>
                    <td>Element 2</td>
                </tr>
                <tr>
                    <td>Element 3</td>
                </tr>
                <tr>
                    <td>Element 4</td>
                </tr>
                <tr>
                    <td>Element 5</td>
                </tr>
                <tr>
                    <td>Element 6</td>
                </tr>
                <tr>
                    <td>Element 7</td>
                </tr>
                <tr>
                    <td>Element 8</td>
                </tr>
                <tr>
                    <td>Element 9</td>
                </tr>
                <tr>
                    <td>Element 10</td>
                </tr>
            </tbody>    
        </table>
    </div>
    <script type="text/javascript"> 
        function setupTables() {
            /* $('#myTable').dataTable({
                "sScrollY":"10px",
                "sScrollX":"10px",
                "bScrollCollapse":false,
                "bRetrieve":false,
                "bProcessing":false,
                "bDestroy":true,
                "bServerSide":false,
                "bPaginate":false,
                "bLengthChange":true,
                "bFilter":false,
                "bSort":true,
                "bInfo":false,
                "bAutoWidth":true,
                "bJQueryUI":true,
                "aoColumns":[
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null,
                    null ]
            });*/ 
            $('#myTable').dataTable({
                "sScrollY":"200px",
                "sScrollX":"1050px",
                "bScrollCollapse":false,
                "bRetrieve":false,
                "bProcessing":false,
                "bDestroy":true,
                "bServerSide":false,
                "bPaginate":false,
                "bLengthChange":true,
                "bFilter":false,
                "bSort":true,
                "bInfo":false,
                "bAutoWidth":true,
                "bJQueryUI":true

            }).rowReordering();
        } 

    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:54:09.630

如果您提供一些代码示例或样式表，将会有所帮助。也许它不是javascript，而是你的CSS。

div 元素上的滚动条需要定义宽度和高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-21T20:36:46.343

对于这个问题，我能找到的唯一“解决方案”是包含[滚动器插件](http://datatables.net/extras/scroller/)，然后滚动在 IE 中正常工作。将在错误跟踪器上打开一个问题

# android - AppWidgetManager getAppWidgetIds 返回旧的 Widget id

> ID：12462696
> 
> 赞同：18
> 
> 时间：2012-09-17T15:42:09.590
> 
> 标签：android, android-appwidget

我正在尝试获取我的小部件的所有 ACTIVE 实例的列表。在我的 AppWidgetProvider 的 OnUpdate 方法中，我正在执行以下操作：

```
// Get all ids
ComponentName thisWidget = new ComponentName(context, this.getClass());
int[] lastWidgetIds = appWidgetManager.getAppWidgetIds(thisWidget); 
```

问题是，如果您将小部件添加到主屏幕然后将其删除，getAppWidgetIds 仍会返回一个列表，其中包含您刚刚删除的小部件的 ID。

有没有办法只检索主屏幕上活动的小部件的 ID？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-09T12:20:44.170

我也遇到了这个。我猜 getAppWidgetIds 被简单地编程为始终获取与该小部件提供程序关联的所有 ID。为了解决这个问题，我必须将 Widget ID 保存到我的共享首选项中，方法是将 id 保存在方法中并在我的 AppWidgetProvider`onUpdate`的方法中删除它。`onDelete`

```
public class MyProvider extends AppWidgetProvider {
    public void onUpdate(Context context, AppWidgetManager appWidgetManager, int[] appWidgetIds) { 
        // Update your widget as normal

        // If the Id isn't already saved to your db/app preference, save it now
    }

    public void onDeleted (Context context, int[] appWidgetIds) {
        // Remove each id passed in through appWidgetIds 
        // "un-save" them from your db or app preferences
    }
} 
```

# java - 使用排序列表实现优先队列

> ID：12462702
> 
> 赞同：0
> 
> 时间：2012-09-17T15:42:37.670
> 
> 标签：java

刚刚用`LinkedList`. 我知道这是一个初学者的实现。肯定有很多错误。我只想知道是否有人可以告诉我该`insert(K key, V value)`方法最坏情况的成本。我应该留在 O(n) 吗？

`addLast()`使用和中的`getLast()`方法进行编辑，`LinkedList`并使用`ListIterator`而不是`Iterator`.

公共类 SortedListPriorityQueue 实现 PriorityQueue {

```
protected List<Entry<K,V>> entries;
protected Comparator<K> c;

private static class MyEntry<K,V> implements Entry<K,V>{

    protected K key;
    protected V value;

    public MyEntry(K key, V value){
        this.key = key;
        this.value = value;
    }

    @Override
    public K getKey() {
        return this.key;
    }

    @Override
    public V getValue() {
        return this.value;
    }
}

/**
 * Crea la coda con il comparatore DefaultComparator
 */
public SortedListPriorityQueue() {
    entries = new LinkedList<Entry<K,V>>();
    c = new DefaultComparator<K>();
}

/* Utilizza un comparatore specifico
 public SortedListPriorityQueue(Comparator<K> comp) {}
*/

@Override
public int size() {
    return entries.size();
}

@Override
public boolean isEmpty() {
    return entries.isEmpty();
}

@Override
public Entry<K, V> min() {
    if(entries.isEmpty()) throw new RuntimeException("Priority queue is empty");
    else return entries.get(0);
}

@Override
public Entry<K, V> removeMin() {
    if(entries.isEmpty()) throw new RuntimeException("Priority queue is empty");
    else return entries.remove(0);

}

@Override
public Entry<K, V> insert(K key, V value) {
    Entry<K,V> new_entry = new MyEntry<K,V>(key, value);

    insertEntry(new_entry);
    return new_entry;
}

private void insertEntry(Entry<K, V> e) {
    //caso base1: lista vuota
    if(entries.isEmpty()){
        entries.add(e);
        return;
    }

    // caso base2: inserisce alla fine della lista
    else if(c.compare(e.getKey(), ((LinkedList<Entry<K, V>>) entries).getLast().getKey()) > 0){
        ((LinkedList<Entry<K,V>>) entries).addLast(e);
        return;
    }

    ListIterator<Entry<K,V>> it = entries.listIterator();
    Entry<K,V> current = null;

    while(it.hasNext()){
        current = it.next();
        if(c.compare(e.getKey(), current.getKey()) < 0){
            it.add(e);
            return;
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:49:19.833

是的，您最坏的插入时间是`O(n)`- 插入出现在列表末尾附近的内容。您花`O(n)`时间找到正确的索引，然后花`O(n)`时间在里面`LinkedList.add`插入它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:50:04.677

优先队列可以通过使用堆实现的 O(log n) 插入来实现

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:57:21.450

是的，它是`O(n)`。

但请注意，常数的乘数`n`不是最优的，因为 `get(int)`和`add(int, T)`for`LinkedList`也是`O(n)`如此，但您可以将它们替换为`O(1)`操作-`getLast()`和。也就是说，现在它需要一些步骤来找到一个新条目的位置并实际插入它，但是您可以修改您的实现以找到一个位置并插入.`addLast()``ListIterator.add()``O(n)``O(n)``O(n)``O(1)`

这样的替换不会改变算法的渐近复杂度（它仍然是`O(n)`），但会提高算法的典型实际性能。

`O(ln n)`当然，对于实际使用，最好使用提供插入和删除的基于堆的实现（例如内置实现） 。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T15:50:20.370

最坏情况的成本是线性的，它取决于您拥有的条目数量 -1 ，因为这是您必须在列表中的最后一个元素之前插入的时候。所以它是O（n）。

# php - htaccess 重写规则来欺骗脚本的服务器路径？

> ID：12462703
> 
> 赞同：0
> 
> 时间：2012-09-17T15:42:39.100
> 
> 标签：php, .htaccess, mod-rewrite, path, amazon-s3

我有一个像这样工作的 PHP 照片库脚本：

```
$image_path        = "../images/11/mycoolphotos/md"; 
```

如果脚本和照片在同一台服务器上，那就完美了！

但是，我们只是将所有图像传输到 Amazon S3 —— 所以路径是这样的：

```
$image_path        = "https://s3.amazonaws.com/mywebsite/images/11/mycoolphotos/md"; 
```

但它不起作用！它不会读取 LIST 或 ../ Path 之类的文件？我可以包含一个“订单文件路径”并且它可以工作，但我们有 8000 个照片库！太多的工作 ？

```
$order_file_path  = "https://s3.amazonaws.com/mywebsite/images/11/mycoolphotos.txt";
// this works, but it would take too much time. This just lists the image names, like 1.jpg, 2.jpg,.. so on for that gallery 
```

我想知道我们是否在读取时欺骗服务器（不知道如何 .htaccess 重写这个）

```
https://s3.amazonaws.com/mywebsite/images/ 
```

作为

```
../ 
```

如果它会工作？

否则，我不确定从这里去哪里？

提前非常感谢！

编辑更新：我找到了 PATH 读取功能：有人可以解码吗？我尝试了以下建议，但没有运气....？

```
/**
 * Check for image order file. In case it does not
 * exists, read the image directory.
 */
  if (is_file($order_file_path . '/' . $order_file_name)) {

  $fp  = fopen($order_file_path . '/' . $order_file_name, "r");
    $row = '';
    $use_order_file = 'true';

    while ($data = fgetcsv ($fp, 1000, ';')) {
        $image_data[] = trim($data[0]);
        $image_file_names[trim($data[0])] = trim($data[0]);
        $num = count($data);
        $row++;

        for ($j = 0; $j < $num; $j++) {
            $content_data_temp['field_' . $j] = $data[$j];
        } 

        $content_data[] = $content_data_temp;
        $content_data_temp = '';
    } 
    fclose ($fp);
} else if (is_dir($image_path)) {
    $content_data = '';
    $handle = opendir($image_path);

    while ($file = readdir($handle)) {
        if (preg_match("/^\.{1,2}$/i", $file)) {
            continue;
        } 
        if (preg_match("/\.[a-z]{3}$/i", $file)) {
            $image_data[] = $file;
            $image_file_names[$file] = $file;
        } 
    } 
    closedir($handle);
} else {
    echo 'Working on older photos, please check back.';
    exit;
} 

$image_number = count ($image_data); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:21:49.597

You could use mod_rewrite in proxy mode for that:

```
 RewriteEngine on
   RewriteRule ^images/(.*)$ https://s3.amazonaws.com/mywebsite/images/$1 [P] 
```

Cheers.

# solr - solr 使用 edismax 分页时返回重复记录

> ID：12462704
> 
> 赞同：2
> 
> 时间：2012-09-17T15:42:40.357
> 
> 标签：solr, pagination

我正在使用 solr 3.5 并在分页时遇到奇怪的行为。分页时 solr 返回了一些相同的记录/文档；例如，我在第一页得到一个文档，在第三页得到相同的文档。故障排除后，我意识到 Solr 在使用`edismax`查询解析器时的行为是这样的。使用默认解析器时分页效果很好。任何想法为什么？

下面是每个分页页面的解码查询

第 1 页

```
spellcheck=true&spellcheck.onlyMorePopular=false&spellcheck.extendedResults=true&spellcheck.count=1&spellcheck.collate=true&q=coffee AND countryId:1&defType=edismax&start=0&rows=10&fl=outletId,outletPhone1,outletPhone2,outletPhone3,outletUrl,outletGpsLatitude,outletGpsLongitude,outletAddress,outletPrimaryName,outletSecondaryName,brateCount,brateit_review,views,outletAvarageRating,outletRatingId,outletRatingValue,poBox,locatedInOutletId,locatedInOutletPrimaryName,locatedInOutletSecondaryName,locatedInName,floor,addressPlaceId,addressPlaceName_en,streetId,streetName_en,areaId,areaName_en,cityId,cityName_en,countryId,countryCode,countryName_en,plsId,plsName_en,categoryId,categoryName_en,ratingId,ratingName_en,primaryCategoryId,primaryCategoryName_en,primaryIndustryId,primaryIndustryName_en&facet=true&facet.limit=-1&facet.sort=count&facet.mincount=1&facet.field=facetCityName_en&facet.field=facetPoolCategory_en&facet.field=facetAreaName_en&sort=score desc, outletAvarageRating desc,brateCount desc,views desc,random_1347951132109 desc 
```

第2页

```
spellcheck=true&spellcheck.onlyMorePopular=false&spellcheck.extendedResults=true&spellcheck.count=1&spellcheck.collate=true&q=coffee AND countryId:1&defType=edismax&start=10&rows=10&fl=outletId,outletPhone1,outletPhone2,outletPhone3,outletUrl,outletGpsLatitude,outletGpsLongitude,outletAddress,outletPrimaryName,outletSecondaryName,brateCount,brateit_review,views,outletAvarageRating,outletRatingId,outletRatingValue,poBox,locatedInOutletId,locatedInOutletPrimaryName,locatedInOutletSecondaryName,locatedInName,floor,addressPlaceId,addressPlaceName_en,streetId,streetName_en,areaId,areaName_en,cityId,cityName_en,countryId,countryCode,countryName_en,plsId,plsName_en,categoryId,categoryName_en,ratingId,ratingName_en,primaryCategoryId,primaryCategoryName_en,primaryIndustryId,primaryIndustryName_en&facet=true&facet.limit=-1&facet.sort=count&facet.mincount=1&facet.field=facetCityName_en&facet.field=facetPoolCategory_en&facet.field=facetAreaName_en&sort=score desc, outletAvarageRating desc,brateCount desc,views desc,random_1347951219828 desc 
```

第 3 页

```
spellcheck=true&spellcheck.onlyMorePopular=false&spellcheck.extendedResults=true&spellcheck.count=1&spellcheck.collate=true&q=coffee AND countryId:1&defType=edismax&start=20&rows=10&fl=outletId,outletPhone1,outletPhone2,outletPhone3,outletUrl,outletGpsLatitude,outletGpsLongitude,outletAddress,outletPrimaryName,outletSecondaryName,brateCount,brateit_review,views,outletAvarageRating,outletRatingId,outletRatingValue,poBox,locatedInOutletId,locatedInOutletPrimaryName,locatedInOutletSecondaryName,locatedInName,floor,addressPlaceId,addressPlaceName_en,streetId,streetName_en,areaId,areaName_en,cityId,cityName_en,countryId,countryCode,countryName_en,plsId,plsName_en,categoryId,categoryName_en,ratingId,ratingName_en,primaryCategoryId,primaryCategoryName_en,primaryIndustryId,primaryIndustryName_en&facet=true&facet.limit=-1&facet.sort=count&facet.mincount=1&facet.field=facetCityName_en&facet.field=facetPoolCategory_en&facet.field=facetAreaName_en&sort=score desc, outletAvarageRating desc,brateCount desc,views desc,random_1347951286359 desc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-06T09:43:42.057

问题出在我的排序实现上。我按每页上的随机字段排序，导致文档在页面之间不断移动。

```
String randomField = random_"+ (new Date()).getTime(); 
```

# windows-phone-7 - 如何让闹钟只在周一和周二响？

> ID：12462706
> 
> 赞同：1
> 
> 时间：2012-09-17T15:42:42.247
> 
> 标签：windows-phone-7

windows phone 7.5 (mango) 内置闹钟，可以设置时钟只在特定时间重复（例如星期一，星期二....）。我想实现相同的功能，但据我所知，“警报”/“提醒”的属性并没有给我足够的支持。所以我想知道是否有人可以帮助我解决这个问题？感谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:15:50.687

您可以将闹钟的 BeginTime 设置为下周一，将 RecurrenceType 设置为每周

# sql - Oracle 外连接未给出预期结果（行为类似于内连接）

> ID：12462709
> 
> 赞同：1
> 
> 时间：2012-09-17T15:42:45.770
> 
> 标签：sql, oracle11g, inner-join, outer-join

这个查询：

```
select *
from table_a
, table_b
where table_a.id = table_b.id(+)
   and table_b.name = 'BENEFICIARY' 
```

返回我没有记录。table_b 没有 name='BENEFICIARY' 的记录。但是外连接应该返回 table_a 中的所有记录。不？以下查询按预期从 table_a 返回记录：

```
select *
from table_a
, (select *
   from table_b
   where table_b.name = 'BENEFICIARY') AS table_b1
where table_a.id = table_b1.id(+) 
```

为什么第一个查询不返回记录？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T16:25:22.890

旧式语法查询

```
select *
 from table_a
    , table_b
where table_a.id = table_b.id(+)
  and table_b.name = 'BENEFICIARY' 
```

与 ANSI 查询相同

```
select *
 from table_a
      left outer join table_b on (table_a.id = table_b.id)
where table_b.name = 'BENEFICIARY' 
```

在这两种情况下，谓词`table_b.name = 'BENEFICIARY'`都在连接之后应用，而不是作为连接的一部分，这违背了进行外连接的目的。为了确保谓词是连接操作的一部分，使用旧语法，您需要

```
select *
 from table_a
    , table_b
where table_a.id = table_b.id(+)
  and table_b.name(+) = 'BENEFICIARY' 
```

而使用 ANSI 语法，你会想要

```
select *
 from table_a
      left outer join table_b on (    table_a.id = table_b.id 
                                  and table_b.name = 'BENEFICIARY') 
```

通常，如果您使用旧语法，则任何您希望成为连接条件的一部分的谓词而不是在连接之外应用的谓词都需要将`(+)`运算符应用于它。同样，当您使用 ANSI 语法时，您希望成为连接条件的一部分的谓词需要成为`ON`子句的一部分。

在这种情况下，ANSI 语法除了更易于移植之外，可能更易于解释，因此通常是首选。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:46:18.283

在第一个查询中，过滤器在连接之后应用于结果。

尝试

```
select * 
from table_a
     left join table_b 
     on table_a.id=table_b.id
     and table_b.name='BENEFICIARY' 
```

# ruby-on-rails - 用于图像的 Rails 资产管道有什么好处

> ID：12462712
> 
> 赞同：1
> 
> 时间：2012-09-17T15:42:55.540
> 
> 标签：ruby-on-rails, asset-pipeline

资产管道由 3 个过程组成 - 预编译、连接和缩小。

我知道 JavaScript 和 CSS 可以从中受益。但是，我想不出图像有什么好处。

你能解释一下吗？

谢谢。

山姆

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:47:05.223

假设您对图像使用 Rails 助手（例如`image_tag`），版本控制/指纹识别是主要好处。

指纹有助于破坏缓存（从 CDN 和浏览器的角度来看）。

请参阅此[导轨部分](http://guides.rubyonrails.org/asset_pipeline.html#what-is-fingerprinting-and-why-should-i-care)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:49:33.587

通过 Rails 资产管道传递图像的一个好处是利用资产指纹，它允许您设置未来的缓存标头并在资产更改时破坏缓存。

> 当文件名是唯一的并且基于其内容时，可以设置 HTTP 标头以鼓励各处的缓存（无论是在 CDN、ISP、网络设备还是 Web 浏览器中）以保留自己的内容副本。当内容更新时，指纹会发生变化。这将导致远程客户端请求内容的新副本。这通常称为缓存清除。（来自[Ruby on Rails 指南：资产管道](http://guides.rubyonrails.org/asset_pipeline.html#what-is-fingerprinting-and-why-should-i-care "Ruby on Rails 指南：资产管道")）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-04-20T13:00:50.950

### 在 Ruby CSS 文件中渲染 SVG 文件时

```
Example
.benefits__icon::after {
  content: "";
  background: url("learn-investment-investxd.svg") no-repeat;
  background-size: 52px;
} 
```

使用**assets.rb**文件

```
 Rails.application.config.assets.precompile += %w( application.css dashboard.css dashboard.js)` with no other configuration. 
```

`http://localhost:3001/learn-investment-investxd.png`上面的示例，即使我将**图像**文件`learn-investment-investxd.png`放在我的**assets/images**文件夹中，背景 url 也会恢复。

### 我的解决方法

> 我添加`assets`到**url**。

```
.benefits__icon::after {
  content: "";
  background: url("assets/learn-investment-investxd.svg") no-repeat;
  background-size: 52px;
} 
```

**这行得通。** 可以改进

# node.js - 与节点 REPL 中的应用程序代码交互

> ID：12462713
> 
> 赞同：3
> 
> 时间：2012-09-17T15:43:03.793
> 
> 标签：node.js, read-eval-print-loop

像 Rails 这样的框架的乐趣之一是能够在命令行上与模型进行交互。作为 node.js 的新手，我经常发现自己将应用程序代码块粘贴到 REPL 中以使用对象。这个不干净。

是否有更有经验的节点开发人员使用灵丹妙药从`node`提示中访问他们的应用程序特定内容？解决方案是将整个应用程序或应用程序的一部分打包成模块`require()`吗？我仍然生活在一个大文件的土地上，所以把所有东西都拿出来，虽然不可避免，但有点令人生畏。

提前感谢您提供的任何有用的提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T17:43:58.613

One-big-ol'-file 土地实际上是您想要做的事情的好地方。Nodejs 也可以`require`在代码本身中进行 REPL，这样可以节省您的复制和粘贴。

这是我的一个项目中的一个简单示例。在文件顶部附近执行类似以下操作：

```
function _cb() {
  console.log(arguments)
}

var repl = require("repl");
var context = repl.start("$ ").context;
context.cb = _cb; 
```

现在只需在整个代码中添加上下文。_cb 是一个虚拟回调，用于处理需要一个的函数调用（并查看它们将返回什么）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-05T17:02:52.133

似乎 REPL API 发生了很大变化，这段代码对我有用：

```
 var replServer = repl.start({
    prompt: "node > ",
    input: process.stdin,
    output: process.stdout,
    useGlobal: true
  });
  replServer.on('exit', function() {
    console.log("REPL DONE");
  }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-18T12:25:53.947

你也可以看看这个答案[https://stackoverflow.com/a/27536499/1936097](https://stackoverflow.com/a/27536499/1936097)。如果文件直接从节点运行并自动将所有声明的方法和变量添加到上下文中，则此代码将自动加载 REPL。

# java - 表达式的非法开始 public boolean setTuitionFees;(double fee);{

> ID：12462717
> 
> 赞同：-2
> 
> 时间：2012-09-17T15:43:17.247
> 
> 标签：java

我正在尝试创建一种方法，以便可以将“tuitionFees”和“scholarships”设置为程序用户个人资料的双倍。我不确定我是否设置正确。

```
 import java.util.Scanner;
    /**
    StudentInvoice.java
    Defines StudentInvoice objects
    @author: Evan Fravert
    */
    public class StudentInvoice {
    // declare instance variables here
    // constructor
    // methods
    // toString method (for String output)
       private String studentName;
       private String studentNumber;
       private double tuitionFees;
       private double scholarships;

    public String toString() {
     String output = "Name: " + studentName + "\n";
     output += "Student ID Number: " + studentNumber + "\n";
     output += "Tuition & Fees: " + tuitionFees + "\n";
     output += "Scholarship: " + scholarships + "\n";
     return output;
     }

    public StudentInvoice(String name, String number, double fees, double scholarship){
     studentName = name;
     studentNumber = number;
     tuitionFees = fees;
     scholarships = scholarship;
     }
    public boolean setStudentName(String name){
     if(name.length() == 0)
     {
     return false;
     }
     else
     {
     studentName = name;
     return true;
     }
     }
    public boolean setStudentNumber(String number){
     if(number.length() == 0)
     {
     return false;
     }
     else
     {
     studentNumber = number;
     return true;
     }  
    public boolean setTuitionFees(double fees){
     if(fees < 0.0) {
 return false;
 }
 else {
 tuitionFees = fees;
 return true;
 }
 }
 public boolean setScholarships (double scholarship){
 if(scholarship < 0.0) {
 return false;
 }
 else {
 Scholarships = scholarship;
 return true;
 }
    }
    }
    } 
```

我的班级与互动：

```
 public class StudentInvoiceApp {
    public static void main (String[] args) {
    StudentInvoice Evan = new StudentInvoice("Evan Fravert");
    Evan.setName("Evan Fravert");
    Evan.setNumber(01234);
    Evan.setTuitionFees(0.00);
    Evan.setScholarship(0.00);
    System.out.print(Evan);
    }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:52:04.643

在尝试编辑您的帖子时，我发现您在`setStudentNumber`. 具有正确格式的更正代码如下。在任何编程语言中，格式化代码对于理解其含义都很重要。人们写了整本关于如何格式化代码的书，这是有充分理由的。使用良好的格式，您可能会注意到缺少的大括号。

搜索“如何格式化 Java 代码”会产生几个有用的约定，包括来自 Oracle 的关于如何格式化 Java 代码的文档。如有疑问，大多数 IDE 也提供格式化代码的快捷方式。在 Eclipse 中，它是. `Ctrl+Shift+F`，而在 NetBeans 中，它是`Alt+Shift+F`.

```
import java.util.Scanner;

/**
 * StudentInvoice.java Defines StudentInvoice objects
 * 
 * @author: Evan Fravert
 */
public class StudentInvoice {
    // declare instance variables here
    // constructor
    // methods
    // toString method (for String output)
    private String studentName;
    private String studentNumber;
    private double tuitionFees;
    private double scholarships;

    public String toString() {
        String output = "Name: " + studentName + "\n";
        output += "Student ID Number: " + studentNumber + "\n";
        output += "Tuition & Fees: " + tuitionFees + "\n";
        output += "Scholarship: " + scholarships + "\n";
        return output;
    }

    public StudentInvoice(String name, String number, double fees,
            double scholarship) {
        studentName = name;
        studentNumber = number;
        tuitionFees = fees;
        scholarships = scholarship;
    }

    public boolean setStudentName(String name) {
        if (name.length() == 0) {
            return false;
        } else {
            studentName = name;
            return true;
        }
    }

    public boolean setStudentNumber(String number) {
        if (number.length() == 0) {
            return false;
        } else {
            studentNumber = number;
            return true;
        }
    }

    public boolean setTuitionFees(double fees) {
        if (fees < 0.0) {
            return false;
        } else {
            tuitionFees = fees;
            return true;
        }
    }

    public boolean setScholarships(double scholarship) {
        if (scholarship < 0.0) {
            return false;
        } else {
            scholarships = scholarship;
            return true;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:47:32.197

将您的 setStudentNumber 方法更改为此

```
 public boolean setStudentNumber(String number){
 if(number.length() == 0)
 {
 return false;
 }
 else
 {
 studentNumber = number;
 return true;
 }
 } 
```

你错过了一个闭括号 else

# iphone - 无法访问 UIImageView 图像

> ID：12462718
> 
> 赞同：0
> 
> 时间：2012-09-17T15:43:19.633
> 
> 标签：iphone, objective-c, ios

当前尝试访问 的`UIImage`属性`UIImageView`以实例化另一个`UIImage`对象。只是我正在尝试这样做。

```
UIImage *myImage = myExistingView.image; 
```

但是，该属性不会设置。我不断得到 myImage 的 nil 值。

我想复制图像，最终做类似的事情

```
UIImageView *newImageView = [[UIImageView alloc] initWithImage:myImage]; 
```

但我似乎无法理解。建议？

编辑。最近的尝试没有奏效。

```
UIImageView *newView = [[UIImageView alloc] initWithImage:[[UIImage alloc] initWithData:UIImagePNGRepresentation(myImageView.image)]]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:40:27.770

这样做是为了访问图像

```
UIImageView *newImageView = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"imageName"]]; 
```

它将显示图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T17:22:11.383

我这样做了，它有效..

```
UIImageView *someNewImageView = [[UIImageView alloc] initWithImage:yourExistingView.image];
someNewImageView.frame = CGRectMake(50, 50, 150, 150);

[self.view addSubview:someNewImageView];
[someNewImageView release]; 
```

请注意，这`yourExistingView`是`UIImageView`在界面生成器中添加的属性。

你检查过你的新框架`UIImageView`吗？你把图片设置进去了`yourExistingView`吗？？你添加了新的图像视图来查看吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T16:03:38.523

你必须以这种方式初始化你的 UIImage`UIImage *myImage = [UIImage imageNamed: @"imgCheckSelected.png"];`

在您将 myImage 传递给 newImageView 之后。我不确定您是否可以将 UiImage 保存在另一个 UIImage 中。

# java - 将字符串转换为二进制 64 位块

> ID：12462719
> 
> 赞同：-1
> 
> 时间：2012-09-17T15:43:24.100
> 
> 标签：java

我想将字符串转换为二进制 64 位块，就像输入字符串 testing 123 那样，输出必须是 64 位块的二进制等价物。如果任何小于 64 位的块比附加一些随机位到它.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:55:16.623

*apache-commons*中的*net*包包含一个名为 Base64 的类，它有一个方法*decode()*似乎可以满足您的要求：

 **```
byte[]  decode(String pArray)
      Decodes a String containing containing characters in the Base64 alphabet. 
```

以下是 API 的链接：

[http://commons.apache.org/net/api-3.1/org/apache/commons/net/util/Base64.html](http://commons.apache.org/net/api-3.1/org/apache/commons/net/util/Base64.html)

该库的 Maven 依赖项是：

```
 <dependency>
        <groupId>commons-net</groupId>
        <artifactId>commons-net</artifactId>
        <version>3.1</version>
    </dependency> 
```**

# javascript - stopPropgation 是否会阻止事件在捕获阶段传播？

> ID：12462721
> 
> 赞同：20
> 
> 时间：2012-09-17T15:43:27.303
> 
> 标签：javascript, dom-events, event-bubbling, event-propagation

我正在查看[http://www.quirksmode.org/js/events_order.html](http://www.quirksmode.org/js/events_order.html)，这部分内容含糊不清：

> 在 Microsoft 模型中，您必须将事件的`cancelBubble`属性设置为`true`。
> 
> ```
> window.event.cancelBubble = true 
> ```
> 
> 在 W3C 模型中，您必须调用事件的`stopPropagation()`方法。
> 
> ```
> e.stopPropagation() 
> ```
> 
> **这会在冒泡阶段停止事件的所有传播。**

所以我的问题是：

*   当事件监听器设置为在捕获阶段监听时，它是否会自动不继续传播到内部元素？
*   或者如果它确实继续传播，调用会`e.stopPropagation()`阻止它，还是只对泡沫阶段有效？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2015-10-26T15:44:14.607

简短的回答：顺序是：

1.  捕获（下）
2.  目标
3.  冒泡）。

如果您`e.stopPropagation()`在捕获阶段调用（通过将`addEventListener()`的**第三个参数**设置为**`true`**），它将在 1 处停止，因此 2 和 3 无法接收它。

如果您`e.stopPropagation()`在冒泡阶段调用（通过将`addEventListener()`的**第三个参数**设置为**`false`**或不分配它），则 1 和 2 已经完成，因此它只是防止事件从您调用的级别冒泡`stopPropagation()`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-17T15:53:45.617

不，事件侦听器不会阻止任何事件的传播，除非您明确告诉它这样做。您所指的部分专门处理泡沫阶段。IE 的模型不支持事件捕获 - 句号。捕获阶段是冒泡阶段之前的阶段：

```
Top of the DOM --->event--->traverses--->to--->[target]+[event]-| (capture phase)
      /\                                                       \/
      |------------------------to--------back up-----------------  (bubble up) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-16T08:00:55.917

stopPropagation() 不会阻止捕获的事件处理程序被调用。stopPropagation() 将阻止冒泡事件处理程序被调用。

[提琴手](http://jsfiddle.net/gravi2/kjav6dar/)

```
var outputDiv = document.getElementById('output');

function log(msg) {
  outputDiv.insertAdjacentHTML('afterend', msg + '<br>');
}

/////////////////////
//Bubbling listeners
/////////////////////
document.getElementById('row1').addEventListener('click', function(e) {
  log('Bubbling row1 listener called');
  e.stopPropagation();
}, false);

document.getElementById('row2').addEventListener('click', function(e) {
  log('Bubbling row2 listener called');
  //NO stopPropagation on this one.
}, false);

document.getElementById('table').addEventListener('click', function() {
  log('Bubbling table listener called');
}, false);

document.addEventListener('click', function() {
  log('Bubbling document listener called');
}, false);

/////////////////////
//Capturing listeners
/////////////////////
document.addEventListener('click', function() {
  log('Capturing document listener called');
}, true);

document.getElementById('table').addEventListener('click', function() {
  log('Capturing table listener called');
}, true);
```

```
#outputwrapper {
  border: 1px solid black;
  height: 300px;
  overflow: scroll;
}
```

```
<table id="table" border="1">
  <tbody>
    <tr>
      <td id="row1">
        This row has stopPropagation
      </td>
    </tr>
    <tr>
      <td id="row2">
        This row does not have stopPropagation
      </td>
    </tr>
  </tbody>
</table>
<br>Output
<br>
<div id="outputwrapper">
  <div id="output"></div>
</div>
```

# telerik-mvc - 从 Telerik 上传控件将图像添加到数据库

> ID：12462722
> 
> 赞同：0
> 
> 时间：2012-09-17T15:43:33.533
> 
> 标签：telerik-mvc

我正在使用带有 Telerik 控件的 MVC3 我有一种情况，我需要在单击屏幕上的注册/更新按钮时将图像添加到数据库。我正在使用以下代码来执行此操作。

```
<fieldset class="fieldsetattachment">
<legend>@Html.LabelFor(model => model.Image)</legend>
<div class="editor-field">
@(Html.Telerik().Upload()
.Name("attachments")
.Multiple(false)
.Async(async => async
.AutoUpload(false)
.Save("Create","Employee")    
)
)
</div> 
```

问题是我需要在按下屏幕上的创建按钮而不是按下 Telerik 上传上的上传按钮时开始上传过程。另外我想隐藏telerik的上传按钮。

任何帮助深表感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:52:37.633

Y0,

由于没有 API 允许您使用 JavaScript 调用提交文件，您可以在文档准备好时隐藏这样的按钮：

```
$('.t-upload-selected').hide(); 
```

当您点击自定义按钮提交表单时，您需要以编程方式触发点击。

```
$('.t-upload-selected').click(); 
```

当然，如果您在页面上有多个上传小部件，您将需要更具体地使用选择器。

# c# - 企业网络服务目录

> ID：12462726
> 
> 赞同：1
> 
> 时间：2012-09-17T15:43:55.960
> 
> 标签：c#, wcf, web-services, asmx, soa

我使用的 .NET 企业系统到处都有不同的 Web 服务。
其中一些带有测试存根/工作台和出色的维护……而其他许多则没有。

目标是将所有 Web 服务（asmx 和 svc）聚合在一起，并将它们放在带有冒烟测试和单元测试的实时测试台下，以确保它们的功能。最好也以自动化方式。

.NET 中是否有适合这方面的服务聚合软件/系统？最好的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-21T18:19:10.710

您需要查看[SO-AWARE](http://www.google.com/url?sa=t&rct=j&q=soaware&source=web&cd=1&cad=rja&ved=0CB8QFjAA&url=http://www.tellagostudios.com/products/so-aware%25E2%2584%25A2&ei=GK9cUKT7HIWD0QGUvYCwDw&usg=AFQjCNECcwx6NYkqqRQUfVh3Cbw7LARn7w)。它是一个 Web 服务管理工具，可以在您的组织中管理基于 SOAP 或 REST WCF 的服务。此外，它还有一个测试工作台！

这里有几个视频也可以展示它：

*   [第1部分](http://channel9.msdn.com/Shows/Endpoint/endpointtv-Meet-SO-Aware-Part-1)
*   [第2部分](http://channel9.msdn.com/Shows/Endpoint/endpointtv-Meet-SO-Aware-Part-2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-24T21:04:05.120

我不确定.net中是否有类似的东西。您所有的服务都是由不同的技术 asmx、wcf、rest ......以及不同的业务组成的。

首先，您必须能够完全隔离（代码、引用、bdd）所有这些服务以进行测试。

**Visual Studio Virtual Labs**可以解决您的问题：实验室环境是虚拟机和物理机的集合，您可以使用它们来开发和测试应用程序。它可以包含测试多层应用程序所需的多个角色，例如工作站、Web 服务器和数据库服务器。您还可以在您的实验室环境中使用构建-部署-测试工作流来自动化在您的应用程序上构建、部署和运行自动化/负载测试的过程（与 TFS 完全兼容）

一个好的开始是[msdn](http://msdn.microsoft.com/en-us/library/dd997438.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T23:53:54.513

一种选择是在所有单独的 Web 服务之前放置一个外观 Web 服务。它可以作为主传递服务以编程方式完成，甚至可以为此使用 WCF 中继绑定。我还建议看一下 BizTalk。您应该能够设置规范的 Web 服务，通过适当的映射映射到内部 Web 服务。您甚至可以设置由多个内部服务方法组成的精心设计和编排的 Web 服务方法。安全策略和日志记录也可以集中应用。

对于测试，我会认真考虑使用 SOAPUI PRO。我对这个产品非常满意。唯一的缺点是它不支持 net.tcp 绑定。但是您可以在测试环境中将所有服务公开为 basicHttpBinding 并运行测试用例。

# java - 刷新Android中的按钮

> ID：12462728
> 
> 赞同：0
> 
> 时间：2012-09-17T15:44:02.620
> 
> 标签：java, android

我在 Android 中设置了一个内容视图：

```
setContentView(R.layout.activity_main); 
```

现在单击其中一个按钮后，将执行以下代码以启用另一个按钮：

```
ok.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                buttonPause.setEnabled(true);
... 
```

这将启用按钮。但仅在一分钟左右之后。

我需要刷新按钮或布局吗？或者这是不好的做法？我想知道是什么导致了这种延迟。我已经阅读过 notifyDataSetChanged()，但我认为这不是正确的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:12:06.627

`notifyDataSetChanged()`与 无关`Buttons`，但与`Adapters`。

`buttonPause.invalidate()`启用后是否尝试添加权限？

# php - 单击按钮时的 sql 查询

> ID：12462730
> 
> 赞同：0
> 
> 时间：2012-09-17T15:44:05.287
> 
> 标签：php

我不知道我的代码有什么问题。PHP 有点新

这是我的html代码

```
<html>
<body>
<form action="sample2.php" method="POST">
<input type="submit" value="occupied" id="occupied">
<input type="submit" value="reserved" id="reserved">

<a name="slot1" style="background-color: green; width:100px; height:100px; border-top-right-radius:0px; border: 2px 
            solid Black;float:left; position:absolute; top:400px; left:441px;">

</form>
</body>
</html> 
```

PHP代码在这里

```
<?php

$con=mysql_connect("localhost","root","");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }
mysql_select_db("sample");

if(isset($_POST['occupied'])){
$query="UPDATE reservation SET status='occupied' where status='vacant'";
echo "<a style=background-color: red; width:100px; height:100px; border-top-right-radius:0px; border: 2px 
            solid Black;float:left; position:absolute; top:400px; left:441px;>";
}
?> 
```

我的问题是每当我点击被占用的按钮时，框的颜色不会从绿色变为红色，它只会将我引导到一个空白页面。帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:46:49.630

尝试这个：

```
<input type="submit" value="occupied" name="occupied">
<input type="submit" value="reserved" name="reserved"> 
```

表单提交带有“名称”的控件，因为这些控件没有名称属性，所以它们不会被提交到您的 PHP 脚本。

阅读有关[成功控制](http://www.w3.org/TR/html401/interact/forms.html#successful-controls)的信息以了解更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:48:12.883

您必须将 id 和名称一起设置为如下形式：

```
<html>
<body>
<form action="sample2.php" method="POST">
<input type="submit" value="occupied" id="occupied" name="occupied">
<input type="submit" value="reserved" id="reserved" name="reserved">

<a name="slot1" style="background-color: green; width:100px; height:100px; border-top-right-radius:0px; border: 2px 
            solid Black;float:left; position:absolute; top:400px; left:441px;"></a>

</form>
</body>
</html> 
```

# windows-8 - 是否可以为 ARM 模拟 Windows 8？

> ID：12462733
> 
> 赞同：1
> 
> 时间：2012-09-17T15:44:12.727
> 
> 标签：windows-8, arm, emulation, windows-runtime

我有一些程序我真的很想在 Windows 8 for ARM 上进行测试。我没有任何 Windows 8 ARM 硬件。是否可以在某种 ARM 模拟器或类似的模拟器中安装 Windows 8？

是的，我知道如果它在 WinRT 上编译，它应该“正常工作”，但我真的很想测试它，不仅要看它是否有效，还要测试相对性能（可以从模拟器中猜到很多）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T17:28:51.117

没有办法，如何以“ARM 模式”启动 x86 PC，或以 ARM 模式启动模拟器。WinRT 旨在弥合差异或这些平台，因此您无需担心它，您可以进行开发。我现在能想到的就是尝试联系您所在地区的当地 Microsoft 代表 - 如果他们有任何 ARM 平板电脑进行测试，他们可能会在这方面为您提供帮助，但如果您的应用程序没有真正的缺陷或计算能力要求不高，请不要不用担心 ARM 平台 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T21:29:16.567

[现在看来，使用新的 WinRT 应用程序认证套件（](http://msdn.microsoft.com/en-US/windows/desktop/hh852363)似乎包括 ARM 仿真）是有可能的（尚未测试） 。

编辑：这不是模拟器，它只能在 ARM WinRT 设备上运行。我想没有 ARM 仿真器，尽管该页面提到了 ARM 和仿真

# oracle - ORA-14551 插入 GTT 时

> ID：12462735
> 
> 赞同：1
> 
> 时间：2012-09-17T15:44:23.837
> 
> 标签：oracle, plsql, temp-tables

我有以下代码：

```
CREATE OR REPLACE FUNCTION repeatable_rand_text(ftype    IN VARCHAR2
                                              , in_val   IN VARCHAR2)
    RETURN VARCHAR2 IS
    workval         VARCHAR2(64);
    insert_needed   BOOLEAN := FALSE;
BEGIN
    BEGIN
        SELECT new_name
        INTO   workval
        FROM   ps_dt_mixnames_preserve
        WHERE  name_type = ftype AND old_name = in_val;

    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            workval := rand_text(ftype);
            insert_needed := TRUE;
    END;

    IF insert_needed THEN
        INSERT INTO ps_dt_mixnames_preserve(name_type, old_name, new_name)
        VALUES      (ftype, in_val, workval);
    END IF;

    RETURN workval;
END repeatable_rand_text; 
```

此例程的目的是在数据库中屏蔽名称，作为从生产环境创建开发数据库的准备工作的一部分。

我们想要屏蔽名称，但我们希望它们是可重复的，以便我们的结果类似于：（左侧输入；右侧输出）

```
JOHN JONES  -> STEEL POTATO
SAM JONES   -> LARGE POTATO
MARY JONES  -> WHITE POTATO
SUE SMITH   -> LARGE CARROT
FRED JONES  -> RED POTATO
JOHN SMITH  -> GREEN CARROT 
```

您可能明白了：姓氏更改为随机值，但再次遇到时会重复。给定的名称只是随机的。这里关心的是姓氏。

数组和其他非永久性解决方案对我们来说效果不佳，因为这实际上将作为一大系列 UPDATE 语句在同一个会话中执行。GTT 似乎非常适合这种类型的东西。

最终，我们将要执行类似于以下内容的更新：

```
UPDATE MY_TABLE
SET ORIG_NAME = repeatable_rand_text('last', ORIG_NAME) 
```

但为了“证明这个例程的结果，我们执行以下 SQL：

```
SELECT ORIG_NAME, repeatable_rand_text('last',ORIG_NAME)
FROM MY_TABLE 
```

现在，显然该函数中的 INSERT 将作为 SELECT 的结果执行，这是一个禁忌。（如果无法做到这一点，我们不愿意尝试自然跟随的更新。据我们所知，它可能会失败并显示类似的消息。）问题是，有没有合理的方法来解决这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-25T17:55:44.937

我终于使用了一个自治块。这些很少是一个好主意，但在这种情况下，我认为这只是门票。这是它的外观：

```
function repeatable_rand_text(ftype IN VARCHAR2, in_val IN VARCHAR2)
    -- The idea is to assign random values to an entity (such as family name),
    -- and to repeat that value each time that entity is seen again.  In this
    -- manner, we can assign random values without losing associations such as
    -- (again) family NAMES.
    --     JONES  -> POTATO
    --     SMITH  -> CARROT
    --     DOE    -> ONION
    --     JONES  -> POTATO
    --
    -- Parameters:
    --    field-type  ('ADJ'  'NOUN'   'BOTH')
    --    field-value
    --
    RETURN VARCHAR2
    DETERMINISTIC IS
    PRAGMA AUTONOMOUS_TRANSACTION;
    workval         VARCHAR2(64);
    insert_needed   BOOLEAN := FALSE;
BEGIN
    BEGIN
        SELECT new_name
        INTO   workval
        FROM   ps_dt_mixnames_preserve
        WHERE  name_type = UPPER(ftype) AND old_name = UPPER(in_val);
    EXCEPTION
        WHEN NO_DATA_FOUND THEN
            workval := rand_text(ftype);
            insert_needed := TRUE;
    END;

    IF insert_needed THEN
        INSERT
        INTO   ps_dt_mixnames_preserve(name_type, old_name, new_name)
        VALUES (UPPER(ftype), UPPER(in_val), UPPER(workval));

        COMMIT;
    END IF;

    RETURN workval;
END repeatable_rand_text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T16:21:24.667

Not particularly pretty, but you could use an anonymous block:

```
set serveroutput on
declare
    cursor c is
        SELECT ORIG_NAME
        FROM MY_TABLE;
begin
    for r in c loop
        dbms_output.put_line(r.orig_name || ' -> ' ||
            repeatable_rand_text('last', r.orig_name));
    end loop;
end;
/ 
```

Depending on the data volume this may not be practical. And you could pad the values to make them align I suppose.

Shouldn't you be calling `rand_text(in_val)` rather than `rand_text(ftype)`? This will always get a randomised version of `'last'`, though to be fair it will still be different for each value of `in_val`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T17:29:09.467

您可以尝试使用 md5 哈希进行屏蔽。这样，表就包含了不能转换为原始（实际）名称的哈希值。我还假设您的查询通常会通过 emp_id 或类似键加入，而不是实际名称。

因此，为所有名称更新一次您的开发表：

```
update my_table
set lastname = rawtohex(dbms_crypto.hash(utl_i18n.string_to_raw(lastname,'AL32UTF8'),2));

commit; 
```

请注意，这对姓氏区分大小写，但如果您愿意，可以使用大写（姓氏）。希望有帮助。

# oauth - 在混合身份验证中恢复访问令牌

> ID：12462739
> 
> 赞同：2
> 
> 时间：2012-09-17T15:44:30.687
> 
> 标签：oauth, access-token, hybridauth

我在我的数据库中保存了访问令牌（使用此方法：getAccessToken ()），但现在我想将此值恢复为一个对象。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-11T02:48:14.047

这在 hybridauth 用户手册中使用以下代码进行了解释：

> ```
>  // get the stored hybridauth data from your storage system
>    $hybridauth_session_data = get_sorted_hybridauth_session( $current_user_id ); 
> ```

Get_sorted_hybridauth_session 是您获取存储数据的内部函数。不管您是否将数据存储在名为“external_token”的字段中的表中，通过普通的 sql 查询获取它，然后将其提供给以下函数：

> ```
>  // then call Hybrid_Auth::restoreSessionData() to get stored data
>    $hybridauth->restoreSessionData( $hybridauth_session_data );
> 
>    // call back an instance of Twitter adapter
>    $twitter = $hybridauth->getAdapter( "Twitter" ); 
> 
>    // regrab te user profile
>    $user_profile = $twitter->getUserProfile(); 
> ```

$hybridauth->restoreSessionData($hybridauth_session_data); 将恢复序列化的会话对象，然后它将为它保存的任何提供者获取一个适配器。最好将提供者名称（在本例中为 Twitter）与 external_provider 之类的东西保存在同一个数据库表中，然后您可以通过 sql auery 获取它并将其提供给 getAdapter 函数。那应该做你需要做的。

手动示例如下：

[http://hybridauth.sourceforge.net/userguide/HybridAuth_Sessions.html](http://hybridauth.sourceforge.net/userguide/HybridAuth_Sessions.html)

==============

作为补充信息 - 我在测试中看到的是，以这种方式保存会话不会阻止混合身份验证用户登录，即使用户同时撤销了应用程序的访问权限。即，如果用户已经登录并获得授权，但单独访问应用程序并撤销了访问权限（例如 google），则 hybridauth 仍会将用户登录到您的系统。我目前正试图找到一种方法来确保用户也登录到远程系统。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-28T13:53:31.490

晚了，但我认为这会有所帮助：

以下代码验证并从 HybridAuth 中删除用户未真正登录的那些提供程序：

```
$providers = $this->hybridauthlib->getConnectedProviders();

foreach( $providers as $connectedWith ){
    $p = $this->hybridauthlib->getAdapter( $connectedWith );
    try {
        $p->getUserProfile();
    } catch (Exception $e) {
        $p->logout();
    }
} 
```

# c# - 将单声道连接到 oracle 错误 libclntsh.so

> ID：12462740
> 
> 赞同：1
> 
> 时间：2012-09-17T15:44:32.877
> 
> 标签：c#, asp.net, mono, oracle11g

我是 linux ubuntu 和单声道运行时的新手，我尝试像通常在 windows 中那样连接到 oracle 11G **（我在 windows 中尝试了 System.Data.OracleClient 和 Oracle.OracleClient 并且都运行良好）** 但我在 ubuntu 中遇到了这个问题: System.DllNotFoundException: libclntsh.so 这是堆栈跟踪：

```
 libclntsh.so

Description: HTTP 500\. Error processing request.

Stack Trace:

System.DllNotFoundException: libclntsh.so
  at (wrapper managed-to-native) System.Data.OracleClient.Oci.OciCalls/OciNativeCalls:OCIEnvCreate (intptr&,System.Data.OracleClient.Oci.OciEnvironmentMode,intptr,intptr,intptr,intptr,int,intptr)
  at System.Data.OracleClient.Oci.OciCalls.OCIEnvCreate (System.IntPtr& envhpp, OciEnvironmentMode mode, IntPtr ctxp, IntPtr malocfp, IntPtr ralocfp, IntPtr mfreep, Int32 xtramem_sz, IntPtr usrmempp) [0x00000] in <filename unknown>:0 
  at System.Data.OracleClient.Oci.OciEnvironmentHandle..ctor (OciEnvironmentMode mode) [0x00000] in <filename unknown>:0 
  at System.Data.OracleClient.Oci.OciGlue.CreateConnection (OracleConnectionInfo conInfo) [0x00000] in <filename unknown>:0 
  at System.Data.OracleClient.OracleConnectionPoolManager.CreateConnection (OracleConnectionInfo info) [0x00000] in <filename unknown>:0 
  at System.Data.OracleClient.OracleConnectionPool.CreateConnection () [0x00000] in <filename unknown>:0 
  at System.Data.OracleClient.OracleConnectionPool.GetConnection () [0x00000] in <filename unknown>:0 
  at System.Data.OracleClient.OracleConnection.Open () [0x00000] in <filename unknown>:0 
  at example.Default.button1Clicked (System.Object sender, System.EventArgs args) [0x0000d] in /home/danar/Projects/example/example/Default.aspx.cs:18 
  at System.Web.UI.WebControls.Button.OnClick (System.EventArgs e) [0x00000] in <filename unknown>:0 
  at System.Web.UI.WebControls.Button.RaisePostBackEvent (System.String eventArgument) [0x00000] in <filename unknown>:0 
  at System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent (System.String eventArgument) [0x00000] in <filename unknown>:0 
  at System.Web.UI.Page.RaisePostBackEvent (IPostBackEventHandler sourceControl, System.String eventArgument) [0x00000] in <filename unknown>:0 
  at System.Web.UI.Page.RaisePostBackEvents () [0x00000] in <filename unknown>:0 
  at System.Web.UI.Page.ProcessRaiseEvents () [0x00000] in <filename unknown>:0 
  at System.Web.UI.Page.InternalProcessRequest () [0x00000] in <filename unknown>:0 
  at System.Web.UI.Page.ProcessRequest (System.Web.HttpContext context) [0x00000] in <filename unknown>:0 
```

这是我到 oracle 的连接字符串，我使用了 System.data.oracleclient

```
string oradb = "Data Source=(DESCRIPTION="
                        + "(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=localhost)(PORT=1521)))"
                        + "(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=orcl)));"
                        + "User Id=hr;Password=hr;";
            OracleConnection conn = new OracleConnection(oradb);
            conn.Open();
            OracleCommand command=new OracleCommand();
            command.Connection=conn;
            command.CommandText="select * from employee";
            OracleDataReader reader=command.ExecuteReader();
            while(reader.Read())
            {
                Response.Write(reader[0]+"<br>");
            }
            conn.Close();
            command=null;
            reader.Close();
            reader=null; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-03T23:47:42.720

更新，因为原来的答案是 2 岁。

只需使用 Oracle 的托管驱动程序。你只需要那个，没有别的。然后，您可以使用简单的连接字符串直接连接到数据库。

```
<system.data>
  <DbProviderFactories>
    <remove invariant="Oracle.ManagedDataAccess.Client" />
    <!-- If any should be in the machine.config -->
    <add name="Oracle Data Provider for .NET" invariant="Oracle.ManagedDataAccess.Client" description="Oracle Data Provider for .NET" type="Oracle.ManagedDataAccess.Client.OracleClientFactory, Oracle.ManagedDataAccess, Version=4.121.1.0, Culture=neutral" />
  </DbProviderFactories>
</system.data>
<connectionStrings>
  <clear />
  <add name="OracleContext" providerName="Oracle.ManagedDataAccess.Client" connectionString="DATA SOURCE=<IP_ADDRESS>:1521/XE;PASSWORD=<PASSWORD>;USER ID=<USER_ID>;Connection Timeout=600;Validate Connection=true" />
</connectionStrings> 
```

我使用 ServiceStack 的 OrmLite 作为 ORM，但如果您不想使用 ORM 或其他任何 ORM，它也可以直接正常工作。您只需要确保您的 ORM 库也在使用托管驱动程序，而不是旧驱动程序。我写了一篇关于 hack 的博客文章，我不得不更改 ServiceStack.OrmLite.Oracle 以使用新的托管驱动程序。这解决了我所有的问题。

*   博文：http: [//peter.grman.at/how-to-connect-mono-in-linux-to-oracle/](http://peter.grman.at/how-to-connect-mono-in-linux-to-oracle/)
*   ServiceStack.OrmLite.Oracle.Managed NuGet 包：[https ://www.nuget.org/packages/ServiceStack.OrmLite.Oracle.Managed/](https://www.nuget.org/packages/ServiceStack.OrmLite.Oracle.Managed/)
*   GitHub 中的变化：[https ://github.com/Grman-IT-Solutions/ServiceStack.OrmLite/tree/OracleManagedDataAccess](https://github.com/Grman-IT-Solutions/ServiceStack.OrmLite/tree/OracleManagedDataAccess)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T20:30:32.440

[根据文档](http://www.mono-project.com/Oracle)，您需要安装[OCI](http://www.oracle.com/technetwork/database/features/oci/index.html)。另外，请记住，不再支持 Oracle 数据客户端（在 Mono 和 Microsoft .NET 中），因此您最安全的选择是[使用商业提供商](https://stackoverflow.com/a/7120183/3205)。你已经为数据库支付了好几美元，几百美元有什么区别？

# android - 从 APK 获取某种 KeyStore 信息

> ID：12462746
> 
> 赞同：1
> 
> 时间：2012-09-17T15:45:01.107
> 
> 标签：android, macos, keystore

我认为我的 KeyStore 在我的 Mac 上的某个地方，但我似乎找不到在哪里。我已经使用该 KeyStore 签署了以前的 APK，但后来却不可思议地丢失了它。我使用了 Find Any File 之类的程序无济于事。有什么方法可以从 APK 中获取有关密钥库的任何信息？例如名称、创建日期等......

# python - python中使用sympy的真值表

> ID：12462747
> 
> 赞同：6
> 
> 时间：2012-09-17T15:45:10.593
> 
> 标签：python, symbolic-computation

我正在尝试创建一个程序，该程序使用 sympy 获取一组变量并在这些变量的域上评估符号逻辑表达式。问题是在它吐出真值表后，我无法让 python 来评估表达式。

这是代码：

```
 from sympy import *
from sympy.abc import p, q, r

def get_vars():
    vars = []
        print "Please enter the number of variables to use in the equation"
        numVars = int(raw_input())
    print "please enter each of the variables on a newline"
        for i in xrange(numVars):
        vars.append(raw_input())
    return vars

def get_expr():
    print "Please enter the expression to use"
    return str(raw_input())

def convert_to_expr(inputStr):
    return eval(inputStr)

def main():
    vars = get_vars()
    expr = get_expr()

    print("recieved input: " + str(vars) + " expr " + str(expr))

    print "Truth table for " + str(len(vars)) + "variable(s)"
    for i in enumerate(truth_table(vars, expr)):
        print i

def fixed_table(numvars):
    """
    Generate true/false permutations for the given number of variables.
    So if numvars=2
    Returns (not necessarily in this order):
        True, True
        True, False
        False, False
        False, True
    """
    if numvars is 1:
        yield [True]
        yield [False]
    else:
        for i in fixed_table(numvars-1):
            yield i + [True]
            yield i + [False]

def truth_table(vars, expr):
    """
    Takes an array of variables, vars, and displays a truth table
    for each possible value combination of vars.
    """
    for cond in fixed_table(len(vars)):
        values=dict(zip(vars,cond))
        yield cond + [eval(expr)]   

if __name__ == "__main__":
    main() 
```

如果我执行以下操作，输出如下：

```
 Please enter the number of variables to use in the equation
3
please enter each of the variables on a newline
p
q
r
Please enter the expression to use
p&q&r
recieved input: ['p', 'q', 'r'] expr p&q&r
Truth table for 3variable(s)
(0, [True, True, True, And(p, q, r)])
(1, [True, True, False, And(p, q, r)])
(2, [True, False, True, And(p, q, r)])
(3, [True, False, False, And(p, q, r)])
(4, [False, True, True, And(p, q, r)])
(5, [False, True, False, And(p, q, r)])
(6, [False, False, True, And(p, q, r)])
(7, [False, False, False, And(p, q, r)]) 
```

如果存在执行此任务的某些软件，我真的很想知道它:-)

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T16:10:38.363

你真的很亲近！一旦你有了`And(p, q, r)`你的真值表，你就可以使用该`subs`方法将你的`values`dict 推送到表达式中：即

```
 yield cond + [eval(expr).subs(values)] 
```

给

```
p&q&r
recieved input: ['p', 'q', 'r'] expr p&q&r
Truth table for 3variable(s)
(0, [True, True, True, True])
(1, [True, True, False, False])
(2, [True, False, True, False])
(3, [True, False, False, False])
(4, [False, True, True, False])
(5, [False, True, False, False])
(6, [False, False, True, False])
(7, [False, False, False, False]) 
```

但我认为有一种更简单的方法可以做到这一点。该`sympify`函数已经可以从字符串生成表达式：

```
In [7]: expr = sympify("x & y | z")

In [8]: expr
Out[8]: Or(z, And(x, y)) 
```

我们也可以得到变量：

```
In [9]: expr.free_symbols
Out[9]: set([x, z, y]) 
```

plus`itertools.product`可以生成值（并且`cartes`是它的别名`sympy`）：

```
In [12]: cartes([False, True], repeat=3)
Out[12]: <itertools.product at 0xa24889c>

In [13]: list(cartes([False, True], repeat=3))
Out[13]: 
[(False, False, False),
 (False, False, True),
 (False, True, False),
 (False, True, True),
 (True, False, False),
 (True, False, True),
 (True, True, False),
 (True, True, True)] 
```

结合这些，基本上只是`sympify`用来获取表达式和避免`eval`，使用内置的笛卡尔积，并添加`.subs()`到使用你的`values`字典，我们得到：

```
def explore():
    expr_string = raw_input("Enter an expression: ")
    expr = sympify(expr_string)
    variables = sorted(expr.free_symbols)
    for truth_values in cartes([False, True], repeat=len(variables)):
        values = dict(zip(variables, truth_values))
        print sorted(values.items()), expr.subs(values) 
```

这使

```
In [22]: explore()
Enter an expression: a & (b | c)
[(a, False), (b, False), (c, False)] False
[(a, False), (b, False), (c, True)] False
[(a, False), (b, True), (c, False)] False
[(a, False), (b, True), (c, True)] False
[(a, True), (b, False), (c, False)] False
[(a, True), (b, False), (c, True)] True
[(a, True), (b, True), (c, False)] True
[(a, True), (b, True), (c, True)] True 
```

这比你的短，但它完全使用你的方法。

# jquery - wordpress + jquery 语法错误

> ID：12462749
> 
> 赞同：1
> 
> 时间：2012-09-17T15:45:22.633
> 
> 标签：jquery, wordpress, syntax, syntax-error

我在这里得到了这个代码......

```
<script type="text/javascript">
    $('document').ready(function() {
        alert($('.thickbox'));
    });
</script> 
```

我把这段代码放在我的 wordpress 主题 footer.php 文件的底部。当我转到我的页面时，警报没有出现，我检查了我的错误控制台并发现了这个错误

```
TypeError: $ is not a function  

$('document').ready(function() { 
```

是什么赋予了？我的 jquery 文件在标题中，所以这应该可以工作......或者是否有将 jquery 放入 wordpress 的特定方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T15:47:36.550

Wordpress 打包的 jQuery 默认为[`noConflict`](http://api.jquery.com/jQuery.noConflict/)mode、use`jQuery('document')`或 wrap your code like

```
(function($) { 
    // Code that uses jQuery's $ can follow here.
})(jQuery); 
```

或在您的文档中像这样准备好：

```
jQuery(document).ready(function($) {
    // Code that uses jQuery's $ can follow here.
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:47:34.023

尝试 jQuery 而不是 $

```
jQuery('document').ready(function($){
    alert($('.thickbox'));
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:47:51.783

'$' 只是 'jQuery' 的别名。如果`$('document')`不起作用，请尝试`jQuery('document')`

# ios - 外部显示器drawRect问题

> ID：12462754
> 
> 赞同：0
> 
> 时间：2012-09-17T15:45:43.697
> 
> 标签：ios, drawrect

我有一个显示连接图节点的应用程序。当用户触摸一个节点时，我通过在节点后面显示一个 clearColor“连接”视图来突出显示到相邻节点的路径，该视图的大小可以包含感兴趣的节点。此视图包含每个路径的子视图，并且每个路径视图都有一个 drawRect 方法，该方法绘制一条出现在源节点和每个相邻节点后面的线。一切都很好，这种方法打开了在未来用路径做有趣事情的潜力。

但是，我最近添加了代码来检测外部显示器，其想法是主显示器将是滚动视图内的放大视图，而外部显示器将显示所有节点的全局视图。在我将连接视图添加到外部显示器以显示通过触摸主显示器选择的内容之前，它工作正常。据我所知，我的路径视图（以及它们的父视图和祖父视图）是相同的，在调用 setNeedsDisplay 之后，它们的 drawRect 方法永远不会被调用，它们的主视图表亲也是如此。它们都在相同的位置以相同的方式初始化。

我已经尝试了几十（几百？）的事情来隔离问题，但还没有找出问题所在。如果我将通用 UIView 添加到连接视图，它会出现在两个地方，但是我的路径视图（通过添加 drawRect 来扩展 UIView）只会在我的主显示器上调用，而不会在我的外部显示器上调用。

我已经没有想法了。有没有人对问题的原因有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T00:42:43.617

我正在拉头发试图弄清楚这一点。比较两种视图的状态并没有显示出任何差异。几天前，我终于决定编写一些 python 例程在 LLDB 中运行，它会转储对象的状态，然后对两个视图进行比较。事实证明，他们试图显示相同的子视图！

为了尽量减少对象的创建，我将路径子视图填充到一个数组中，以避免创建比我需要的更多并在不使用时隐藏它们。但是，我愚蠢地在 @interface 块之外声明了这个数组，并且无意中将它变成了一个全局的，所以两个视图都使用了最后一组定义的子视图。当然，一个视图不能是多个父视图的子视图。将声明移到正确的位置解决了这个问题。

愚蠢的错误！但也许这会给其他有类似问题的人带来一些好处。

# javascript - 如何包含我的 javascript 文件而不单独列出它们？

> ID：12462755
> 
> 赞同：1
> 
> 时间：2012-09-17T15:45:44.973
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3.2, assets

我们有一个`conf/environments/production.rb`单独列出所有 js 文件的文件，例如

```
conf.assets.precompile += %w (highcharts.js)
conf.assets.precompile += %w (schedule.js)
conf.assets.precompile += %w (new_event.js)
conf.assets.precompile += %w (old_event.js)
conf.assets.precompile += %w (event_controls.js)
conf.assets.precompile += %w (other_stuff.js)
... 
```

每次我有一个新的 js 文件时，我都必须在此处手动添加一个条目。

如何在无需手动维护此文件的情况下将它们全部包含在内？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T18:08:14.093

从技术上讲，您是从错误的方向解决问题。您的 config.assets.precompile 应该只引用几个中央清单类型文件（例如 application.js），然后清单文件会根据需要引用 js 文件。

例如，您的 application.js 可能如下所示：

```
//= require highcharts.js
//= require schedule.js
//= require new_event.js
//= require old_event.js
//= require event_controls.js
//= require other_stuff.js 
```

像这样设置，所有列出的文件都将包含在 application.js 的预编译版本中，而 application.js 是您需要包含在布局中的唯一文件。

要自动添加新文件，您可以改用

```
//= require_tree . 
```

这将包括与 application.js 相同目录中的每个 .js 文件，以及所有子目录中的文件。

在实践中，一个包含应用程序中每个 js 文件的 application.js 文件有点多。您可以将文件分解为一组中央清单。例如，charts.js、events.js、misc.js。将这些文件添加到您的 config.assets.precompile。然后，当需要新文件时，更新清单文件而不是 production.rb 文件。

# python - 如何遍历目录中的 csv 文件并将值写入二维列表？

> ID：12462758
> 
> 赞同：1
> 
> 时间：2012-09-17T15:45:50.777
> 
> 标签：python

我是一个绝对的编程新手，试图使用一些 csv 文件。虽然我总体上想要做的事情更复杂，但我目前被困在这个问题上：

我拥有的 csv 文件包含固定数量的“列”和可变数量的行。我想要做的是打开目录中的每个 csv 文件，同时在内存中将文件值存储到 2d 列表中，然后从该列表中提取一个“列”数据。通过循环执行此操作，我可以附加一个列表，其中包含来自每个 csv 文件的一列数据。

当我对单个文件执行此操作时，它可以工作：

```
csvFile = 'testdata.csv'
currentFile = csv.reader(open(csvFile), delimiter=';')
errorValues = []

    for data in currentFile:

        rows = [r for r in currentFile] #Store current csv file into a 2d list           
        errorColumn = [row[34] for row in rows] #Get position 34 of each row in 2D list
        errorColumn = filter(None, errorColumn) #Filter out empty strings
        errorValues.append(errorColumn) #Append one 'column' of data to overall list 
```

当我尝试为目录中的所有文件循环它时，我收到“列表索引超出范围”错误：

```
dirListing = os.listdir(os.getcwd())    
errorValues = []

for dataFile in dirListing:
    currentFile = csv.reader(open(dataFile), delimiter=';')        

    for data in currentFile:

        rows = [r for r in currentFile] #Store current csv file into a 2d list           
        errorColumn = [row[34] for row in rows] #Get position 34 of each row in 2D list
        errorColumn = filter(None, errorColumn) #Filter out empty strings
        errorValues.append(errorColumn) #Append one 'column' of data to overall list

    errorColumn = [] #Clear out errorColumn for next iteration 
```

错误发生在“errorColumn = [row[34] for row in rows]”处。我尝试了各种方法来做到这一点，总是未能出现索引超出范围错误。问题不在于我的 csv 文件，因为我使用工作脚本一一测试它们。可能是什么问题呢？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:49:35.207

我有点惊讶你提到的错误是在`[r for r in currentFile]`. 在最坏的情况下，您的`rows`列表将是空的...

您是否 100% 确定您的**所有**行至少有 35 列？你在某处没有空行吗？最后？值得检查是否

```
errorColumn = [row[34] for row in rows if row] 
```

仍然给出错误。前提是您先摆脱了这`for data in currentFile`条线（您不使用，更重要的是消耗了您的`currentFile`，留给您`rows==[]`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:56:40.163

循环遍历 CSV 文件的`for`行。阅读器将每一行转换为元素的行。这样，`data`循环中的 in 已经是行了。下一个构造也遍历打开的文件。这是错误的。

您的`open()`. 该文件必须以二进制模式打开（在 Python 2 中）。

尝试以下（我没有把你想要的所有东西都放在里面）：

```
dirListing = os.listdir(os.getcwd())    
errorValues = []

rows = []                  # empty array of rows initially

for fname in dirListing:
    f = open(fname, 'rb')  # open in binary mode (see the doc)
    reader = csv.reader(f, delimiter=';')        

    errorColumn = []       # initialized for the file

    for row in reader:
        rows.append(row) #Store current csv file into a 2d list           
        if len(row) > 34:
            errorColumn.append(row[34]) #Get position 34 of each row in 2D list

    errorValues.append(errorColumn)

    f.close()              # you should always close your files 
```

谨防！还返回子目录的`os.listdir()`名称。尝试添加

```
if os.path.isfile(fname):
    ... 
```

顺便说一句，你应该清楚地描述你的实际目标是什么。可能有更好的方法来解决它。您可能会在精神上固定在您首先想到的解决方案上。利用这种媒体有更多的眼睛和更多的头脑来提出解决方案。

# javascript - Firefox 中的 offsettop 和 clientHeight

> ID：12462767
> 
> 赞同：0
> 
> 时间：2012-09-17T15:46:17.500
> 
> 标签：javascript, html, css, internet-explorer, firefox

我正在将 IE 支持的网页更新为可在 Firefox 中运行的代码。

我有一段代码将页面上的某些表格放置在某些位置。它在 IE 中有效，但似乎在 Firefox`.clientHeight .offsetTop .style.posTop`中`.style.posLeft`不起作用。火狐浏览器有替代品吗？

这是我正在查看的一段代码：

```
 var tableHeight = table1.clientHeight;
    var yLocation = table2.offsetTop - tableHeight / 4;

    table3.style.posTop = Math.max(table2.offsetTop + 2);
    table3.style.posLeft = + table2.offsetLeft  + 80; 
```

# symfony - 如何在 Symfony 中注入验证器

> ID：12462770
> 
> 赞同：9
> 
> 时间：2012-09-17T15:46:31.057
> 
> 标签：symfony, dependency-injection

有人可以告诉我如何使用依赖注入将验证器注入到常规类中。

在我的控制器中，我有：

```
use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Form;

class FormController extends Controller {
    public function indexAction()
    {
        $form = new Form();
        $email = $request->request->get('email');
        $valid = $form->isValid($email);
    }
} 
```

我想使用这个自定义类 - 但我需要它可以访问验证器。

```
class Form {
    public function isValid($value)
    {
        // This is where I fail
        $validator = $this->get('validator'); 
        ... etc
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-17T16:07:20.207

为此，您的自定义类需要定义为服务，并且您将从控制器访问它，`$form = $this->get('your.form.service');`而不是直接实例化它。

定义服务时，请确保注入验证器服务：

```
your.form.service:
    class: Path\To\Your\Form
    arguments: [@validator] 
```

然后，您需要在 Form 服务的构造方法中处理此问题：

```
/**
 * @var \Symfony\Component\Validator\Validator
 */
protected $validator;

function __construct(\Symfony\Component\Validator\Validator $validator)
{
    $this->validator = $validator;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-03T12:19:00.503

从 Symfony2.5 开始

`Validator`如此称呼`RecursiveValidator`，用于注射

```
use Symfony\Component\Validator\Validator\RecursiveValidator;
function __construct(RecursiveValidator $validator)
{
    $this->validator = $validator;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-06-26T10:35:30.003

在 Symfony 4+ 中，如果您使用默认配置（启用自动连接），最简单的方法是注入一个`ValidatorInterface`.

例如：

```
<?php

use Symfony\Component\Validator\Validator\ValidatorInterface;

class MySuperClass
{
    private $validator;

    public function __construct(
        ValidatorInterface $validator
    ) {
        $this->validator = $validator;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T16:14:05.200

您的 Form 类可以继承自 ContainerAware (Symfony\Component\DependencyInjection\ContainerAware)。然后您将可以访问容器，并且您将能够像这样获得验证器服务：

```
$validator = $this->container->get('validator'); 
```

# php - Codeinigter PHP + Twitter 登录

> ID：12462771
> 
> 赞同：1
> 
> 时间：2012-09-17T15:46:34.880
> 
> 标签：php, codeigniter, oauth, twitter

我正在尝试在我的 Codeigniter 页面上实现 Twitter 登录。

首先，我从[Twitter Simon Emms下载了 Twitter 库](http://www.simonemms.com/2012/02/22/twitter-for-codeigniter/)

然后我正确放置了文件并编辑了**config/twitter.php**

```
'_tokens' => array(
    'consumer_key' => 'mykey',
    'consumer_secret' => 'mykeymykey', 
```

ETC...

然后当调用**twitter_test 控制器**并尝试登录时，我只是被重定向到[http://api.twitter.com/oauth/authenticate?](http://api.twitter.com/oauth/authenticate?)

我究竟做错了什么？

感谢帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T01:54:27.630

我自己很多次都被这个抓住了。这实际上是在 Twitter API 设置中，您需要指定回调 URL。它是什么并不重要，因为您将在代码中指定回调 URL。我建议将根页面放入您的站点（与 site_url() 生成的相同）

# c++ - 连续调用后 g++ 崩溃

> ID：12462774
> 
> 赞同：1
> 
> 时间：2012-09-17T15:46:50.507
> 
> 标签：c++, g++, opencl, ld

我正在开发一个工具，它可以多次调用 g++，以便编译和执行原始 C++ 程序的不同版本。或多或少，此调用是在循环内进行的（它不是真正的“循环”，但调用是在作为迭代算法的一部分的函数内进行的）。

对于算法的短期执行，一切都很顺利，所有 g++ 调用都正确完成（我准备好执行二进制文件）。然而，算法执行的时间越长，工具就越有可能崩溃。

此崩溃是由于 g++ 调用的后续崩溃，而不是返回预期的编译二进制文件，而是返回以下错误：

```
Compiling test_oclopts_23_14_6_6000.cpp...
g++ -O3 -L/opt/AMDAPP/lib -lOpenCL -I/opt/AMDAPP/include test_oclopts_23_14_6_6000.cpp -o test_oclopts_23_14_6_6000
/usr/bin/ld: cannot find /usr/lib/i386-linux-gnu/libc_nonshared.a
/usr/bin/ld: cannot find /lib/i386-linux-gnu/ld-linux.so.2
collect2: ld returned 1 exit status 
```

我已经用谷歌搜索了一些关于此错误消息的信息，但我不明白它们如何应用于我的问题：据称缺少的库确实已很好地安装在系统中（以前的 g++ 调用正常）。

任何想法？此外，如果您知道在 C++ 程序中编译 C++ 源代码而不是使用 system() 的更好方法，我接受建议，:)

非常感谢你，

乔治。

# c++ - 嵌套类继承自嵌套类

> ID：12462781
> 
> 赞同：4
> 
> 时间：2012-09-17T15:47:12.070
> 
> 标签：c++, inheritance

我希望 C 类从 A 类继承其虚函数，而 D 类（C 类中的嵌套类）从 B 类（A 类中的嵌套类）继承其数据字段，这就是我所拥有的。

文件1.h

```
class A{
 public:
     virtual void foo()=0;
     class B{
       public:
         int data;
     };
}; 
```

文件2.h

```
class C : public A{
 public:
     class D : public A::B{

     };    
}; 
```

文件2.cpp

```
void C::foo(){//code}
C::D::D():data(0){//Bad initialization list, error being data is not a member of C::D even it should inherits from its base class
 data = 0; //good! compiler can see data is a member of A::B,and C::D inherits from it
} 
```

我有两个问题，第一个是我正在做的正确方法来实现这种继承。其次，正如我所评论的，为什么编译器可以在手动初始化过程中看到数据来自 A::B 而不是在初始化列表中？他们不应该在同一个范围内吗？非常感谢你

**编辑1**：

因此，如果类 C::D(foo) 不直接继承自 A::B(foo)，而是 C 继承自 A，我的看法是，由于 C 继承自 A 及其所有公共字段，包括其内部类 A ::B(foo), D(foo) 与 A::B(foo) 具有完全相同的名称，并且是 C 的内部类，就像这样，即 foo 用于两个内部类

```
class A{
 public:
     class foo{
       public:
         int data;
     };
};

class C : public A{
 public:
     class foo{

     };    
}; 
```

当我直接调用 C::foo 时，编译器会感到困惑吗？因为范围内有两个具有名称的构造函数？或者它选择调用“最近的”，例如 C:foo？而不是爬上继承链？非常感谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:50:37.780

1.  是的，您的方法是实现这种继承的正确方法。

2.  初始化列表用于控制传递给构造函数的参数。您可以将参数传递给 B 的构造函数，但不能直接初始化 B 的成员（这是其构造函数的工作）。如果没有为基类或成员指定构造函数，则使用默认构造函数。在您的情况下，将构造函数添加到 B 以实现您想要的。

    ```
    class A {
    public:
        class B{
        public:
            B(int i) : data(i) {}
            int data;
        };
    }; 

    class C : public A {
        class D : public A::B {
        };
    };

    C::D::D() :B(0) { } 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T15:49:19.920

从*句法的角度来看，它是正确的*(*1)。当然，除了初始化列表。您只能在初始化列表中初始化当前类成员（而不是基类成员）。这与嵌套无关。

```
class X
{
public: 
   int x;
};
class Y : X
{
   Y() : x(0) {} //still illegal
}; 
```

[我说句法 POV 是因为这是一件很奇怪的事情……我相信有一种更简洁的方法可以实现您真正想要的。]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:50:24.850

您从嵌套类继承的语法是正确的。

初始化列表用于初始化该类的成员；基类成员应该在基类构造函数中初始化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-06T12:14:52.297

从语法上讲，接受的答案很好地回答了您的问题。这是我在与机制相关的设计方面的两分钱：在您的示例中，抽象类 A 本质上是一个接口。接口应该只定义行为和行为。话虽如此，我认为在接口中有一个嵌套类是没有意义的。

1）接口没有任何数据成员可以由嵌套类操作，就像您的示例一样。这首先消除了对嵌套类的需要。

2）嵌套类不是行为。所以它不应该出现在界面中。

现在您可能会争辩说您的示例只是一个快速演示，实际上您会有数据成员供嵌套操作，即 A 类不是纯接口。您只是想为嵌套的 B 类提供一个默认实现，并让 C 类决定他想如何将 B 类自定义为他自己的 D 类。如果是这样的话，恐怕设计会更糟。

3）考虑迭代器模式。A类本质上是一个不能被实例化的抽象容器（因为你里面有一个纯虚函数）——让我们把它映射到我们脑海中的IContainer。现在你创建了一个类 C，它有一个向量/数组实现，他自己的迭代器 D 指向数组中的某个元素。

然后你想创建另一个类 E，它有一个哈希映射实现，她自己的迭代器 F 指针指向哈希映射中的某个对。

**这是灾难：**在包含类（C，E ...）的实现中，您通常无法在所有迭代器类（D，F ...）中拥有统一的接口 - 很可能（考虑赋值运算符`BIterator operator=(const BIterator& other);`：） , D 类有一个接受 D 类对象作为参数的函数`DIterator operator=(const DIterator& other)`：F 类有一些接受 F 类对象作为参数的函数`FIterator operator=(const FIterator& other)`：

另一方面，这是行不通的，因为 DIterator 和 FIterator 都是 BIterator 的子类 - 您不能使用“更窄”（或“更具体”）参数覆盖函数，因为它违反了参数类型的逆变性（ C++ 不允许逆变参数，因此它需要匹配参数类型；所以从技术上讲，您可以`FIterator operator=(const BIterator& other)`为类 F 并执行从 BIterator 到 FIterator 的运行时动态转换——但这很丑陋而且没有意义：一个具体的苹果有一个赋值运算符，将抽象的“水果”分配给自身）。你只是让自己陷入了两难境地。

**综上所述，由于 1) 2) 和 3) 的原因，不要在接口/抽象基类中包含嵌套类。**迭代器模式只是一个示例，只要嵌套类与包含类交互，就可能在很多情况下让您自责。如果不是，那么一开始就没有嵌套类。

# performance - 无法在合理的运行时间内创建随机组

> ID：12462782
> 
> 赞同：0
> 
> 时间：2012-09-17T15:47:12.977
> 
> 标签：performance, math, random

我有一个正在处理的个人项目，但我有一个似乎无法解决的问题（好吧，我无法快速解决）。

假设我有一组`x[1..|x|]`人，一组`x`元素。

我想创建 x 个组（组号`i`用于 person number `i`），并且在每个组中都有`y`不同的元素。

例如：如果我有 10 个人和 10 个元素，并且我希望每个组都有 2 个元素：

```
|   0   |1  |2  |3  |4  |5  |6  |7  |8  |9  |
|___________________________________________|
|   7   |4  |0  |6  |2  |8  |3  |1  |9  |5  |
|   6   |9  |5  |8  |7  |0  |2  |3  |1  |4  | 
```

顶行代表人`(0..9)`；
每个人下面的两个数字表示他有哪些元素。
注意：每个元素只出现两次（不多也不少）。
还要注意 person number`i`不能有元素 number `i`。
例如：人号 3 不能有元素号 3。

我的问题是如何（快速）创建这些组。
到目前为止，我发现的最佳解决方案是创建一个包含`x`列和`y`行的矩阵；
取一个 size 的数组`x`，将其随机播放，然后查看是否无法将其插入矩阵。如果可以，请移至下一行；如果我不能再次洗牌，看看现在是否可以插入。

问题是，即使数量很少（1000 人/元素，每组 50 个元素），代码也很慢。
问题在于洗牌，当它试图找到与行（~13）的匹配时，它需要重新洗牌很多次，直到找到可以放在矩阵内的行。

有谁知道如何快速完成这件事？任何想法都会受到欢迎！！

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T18:24:27.943

用数学术语来说，你想要的是生成一个没有固定点的随机排列。这被称为一个这被称为一个紊乱（有关更多详细信息，包括随机排列成为紊乱的概率，请参见[此处）。](http://en.wikipedia.org/wiki/Derangement)如果你用谷歌搜索“生成随机紊乱”或类似的东西，你会发现几个实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T17:38:58.680

您可以遍历人员，将每个该数字的 y 元素放入未满的随机组中。只需有一个包含空组的数组，并在它们填满时将其删除，当然还可以从随机选择中排除当前组。

# c++ - 散列函数和随机排列

> ID：12462783
> 
> 赞同：2
> 
> 时间：2012-09-17T15:47:26.173
> 
> 标签：c++, algorithm, hash, permutation

看完[这个](https://stackoverflow.com/q/12460532/942596)问题。我想知道是否有可能使用 O(1) 空间我们可以使用双散列之类的方法生成具有均匀分布的序列 [1...n] 的随机排列？

我用序列 [1,2,3,4,5] 的一个小例子尝试了这个，它可以工作。但它无法用于更大的集合。

```
int h1(int k) {
    return 5 - (k % 7);
}

int h2(int k) {
    return (k % 3) + 1;
}

int hash(int k, int i) {
    return (h1(k) + i*h2(k)) % size;
}

int main() {
    for(int k = 0; k < 10; k++) {
        std::cout << "k=" << k <<  std::endl;
        for(int i = 0; i < 5; i++) {
            int q = hash(k, i);
            if(q < 0) q += 5;
            std::cout << q;
        }
        std::cout << std::endl;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:56:05.390

您可以尝试另一种方法。

1.  取任意整数 P，`GCD(P, N) == 1`它`GCD(P, N)`是和的[最大公约数](http://en.wikipedia.org/wiki/Greatest_common_divisor)（例如， ）。`P``N``GCD(70, 42) == 14``GCD(24, 35) == 1`
2.  获取序列`K[i] ::= (P * i) mod N + 1`，`i`从`1`到`N`
3.  事实证明，序列`K[i]`枚举了 1 到 N 之间的所有数字，没有重复（实际上`K[N + 1] == K[1]`，但这不是问题，因为我们只需要前 N 个数字）。

如果您可以使用[欧几里德算法](http://en.wikipedia.org/wiki/Euclidean_algorithm)`P`以 O(log(N)) 复杂度计算 GCD，从而有效地生成具有均匀分布的此类数字（例如，具有良好的随机函数），您将得到您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:55:23.663

如果没有一些随机性，就不可能生成“随机”排列。这甚至没有意义。您的代码每次都会生成相同的排列。

我怀疑您打算每次都选择不同的两个随机散列函数。但即使这样也不能使用像你这样的散列函数（`a +/- k%b`对于随机选择的 a，b），因为你需要`O(n log n)`一些随机性来指定一个排列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:55:49.130

我不确定问题是什么。如果你想要一个随机排列，你想要一个随机数生成器，而不是一个散列函数。哈希函数是（并且必须是）确定性的，因此它不能用于“随机”排列。哈希*不是*任何事物的排列。

我不认为随机排列可以是 O(1) 空间。您必须以某种方式跟踪已使用的元素。

# eclipse - 当我提交一个项目时，会创建一个额外的项目目录

> ID：12462784
> 
> 赞同：7
> 
> 时间：2012-09-17T15:47:26.300
> 
> 标签：eclipse, git, github, egit

[我使用以下步骤](http://www.vogella.com/articles/EGit/article.html#respository)在 github 上提交了一个项目：

> 右键单击您的项目，选择团队 -> 共享项目 -> Git。选择建议的行并按“创建存储库”。按完成。
> 
> 右键单击您的项目并选择“团队”->“推送”。弹出一个对话框。维护以下数据。调整突出显示的行，以便您使用您的用户和项目名称。

但是当我在 github 上查看我的项目时，这是我的项目结构：myproject -> myproject -> src

什么时候应该是：myproject -> src

因此，在 github 上创建了一个带有项目名称的额外级别。我是否正确地提交了项目？

当我尝试通过启用“在项目的父文件夹中使用或创建存储库”共享项目时，项目路径为“c:\homedir\git\egit-test1\egit-test1”应该不是“c:\homedir\ git\egit-test1\" ？

附截图： ![在此处输入图像描述](../Images/9acac70ab851c604df3289eaacc8792a.png)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-17T19:25:11.420

如果您不想在 git 存储库中添加额外的目录级别，则需要在“配置 Git 存储库”对话框（团队 -> 共享项目）最顶部启用“在项目的父文件夹中使用或创建存储库”选项...-> Git）。

但是，这将直接在您的工作空间中创建存储库，而不是在默认存储库文件夹中创建存储库，不推荐这样做。但是您可以将项目移动到正确的位置，然后在第二步将其重新导入您的工作区。

![在项目的父文件夹中创建存储库](../Images/75d26cf9362177f2f6cdbd49e38b7684.png)

另一种选择是首先在 github 上创建存储库。之后，您可以克隆 github 存储库并将代码移动到其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-11-06T20:47:56.953

i）在本地存储库中提取代码。

ii) 将代码复制到单独的文件夹中。

iii）删除所有隐藏文件和 .git 。

iv) 在您的本地存储库中再次复制代码。

v) 提交和推送

# sql-server - SSRS 中的分组表

> ID：12462789
> 
> 赞同：0
> 
> 时间：2012-09-17T15:47:40.653
> 
> 标签：sql-server, reporting-services

我正在制作一份报告，该报告是要打印的注册表。它在框中打印客户信息，并且还列出了可以购买的可用许可证。现在我的问题是首先显示每个客户的信息，然后最后只显示一次许可证。我希望它在每一页上都打印客户和许可证标签。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-19T19:16:34.037

我认为您需要使用一个 tablix 并设置父（客户信息）和子分组。你说的有点含糊。您是否有两个 tablixes 和客户信息在一个与许可证在另一个？

# c - 试验 SSL 连接

> ID：12462791
> 
> 赞同：1
> 
> 时间：2012-09-17T15:47:56.720
> 
> 标签：c, ssl, openssl, client, certificate

我已经从网上找到的一些教程中编写了一组简单的 SSL 客户端/服务器程序 - 这些工作正常。我无法理解的是事物的客户端（见下文）

从客户端连接到 SSL 服务器的代码来看，它似乎盲目地接受了它提供的证书，然后使用它来加密/解密发送到和从该对发送的数据。

不应该有客户端验证服务器证书以供使用吗？我的意思是我可以用任何新的证书更改/交换服务器端证书，并让它连接起来而不需要太多的wimper？这是一种安全的连接方法吗？（或者我 - 我怀疑 - 错过了什么）

非常感谢

FR

```
void LoadCertificates(SSL_CTX* ctx, char* CertFile, char* KeyFile);
int OpenConnection(const char *hostname, int port);
void ShowCerts(SSL* ssl);
SSL_CTX* InitCTX(void);

int main(int count, char *strings[]) {

    char *hostname, *portnum;
    char buf[1024];
    SSL_CTX *ctx;
    SSL *ssl;
    int server;
    int bytes;

    if ( count != 3 ) {

        printf("usage: %s <hostname> <portnum>\n", strings[0]);
        exit(0);

    } // if

    hostname=strings[1];
    portnum=strings[2];

    printf("\nSSL Client 0.1\n~~~~~~~~~~~~~~~\n\n");

    // Init. the SSL lib
    SSL_library_init();
    ctx = InitCTX();

    printf("Client SSL lib init complete\n");

    // Open the connection as normal
    server = OpenConnection(hostname, atoi(portnum));

    // Create new SSL connection state
    ssl = SSL_new(ctx);

    // Attach the socket descriptor
    SSL_set_fd(ssl, server);

    // Perform the connection
    if ( SSL_connect(ssl) != FAIL ) {

        char *msg = "Here is some data";

        printf("Connected with %s encryption\n", SSL_get_cipher(ssl));

        // Print any certs
        ShowCerts(ssl);

        // Encrypt & send message */
        SSL_write(ssl, msg, strlen(msg));

        // Get reply & decrypt
        bytes = SSL_read(ssl, buf, sizeof(buf));

        buf[bytes] = 0;
        printf("Received: '%s'\n\n", buf);

        // Release connection state
        SSL_free(ssl);

    } // if

    else ERR_print_errors_fp(stderr);

    // Close socket
    close(server);

    // Release context
    SSL_CTX_free(ctx);
    return 0;

} // main

SSL_CTX* InitCTX(void) {

    SSL_METHOD const *method;
    SSL_CTX *ctx;

    // Load cryptos, et.al.
    OpenSSL_add_all_algorithms();

    // Bring in and register error messages
    SSL_load_error_strings();

    // Create new client-method instance
    method = SSLv3_client_method();

    // Create new context
    ctx = SSL_CTX_new(method);

    if ( ctx == NULL ) {

        ERR_print_errors_fp(stderr);
        abort();

    } // if

    return ctx;

} //InitCTX

int OpenConnection(const char *hostname, int port) {

    int sd;
    struct hostent *host;
    struct sockaddr_in addr;

    if ( (host = gethostbyname(hostname)) == NULL ) {

        perror(hostname);
        abort();

    } // if

    sd = socket(PF_INET, SOCK_STREAM, 0);
    bzero(&addr, sizeof(addr));
    addr.sin_family = AF_INET;
    addr.sin_port = htons(port);
    addr.sin_addr.s_addr = *(long*)(host->h_addr);

    if ( connect(sd, (struct sockaddr*)&addr, sizeof(addr)) != 0 ) {

        close(sd);
        perror(hostname);
        abort();

    } // if

    return sd;

} // OpenConnection

void ShowCerts(SSL* ssl) {

    X509 *cert;
    char *line;

    cert = SSL_get_peer_certificate(ssl); /* get the server's certificate */

    if ( cert != NULL ) {

        printf("\nServer certificate:\n");
        line = X509_NAME_oneline(X509_get_subject_name(cert), 0, 0);
        printf("Subject: %s\n", line);

        // Free the malloc'ed string
        free(line);
        line = X509_NAME_oneline(X509_get_issuer_name(cert), 0, 0);
        printf("Issuer: %s\n", line);

        // Free the malloc'ed string
        free(line);

        // Free the malloc'ed certificate copy
        X509_free(cert);

    } // if

    else printf("No certificates.\n");

} // ShowCerts 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T20:24:56.350

“安全连接”可以被视为由两件事组成：

1 身份验证：确保连接到期望连接的伙伴（这里：服务器）

2 加密：保护数据（由连接传输）在传输过程中不被读取

从服务器收到的证书可以用来完成1。证书不一定参与2。

关于如何将服务器证书的验证添加到您的客户端，您可能想查看这个 SO 答案：[https](https://stackoverflow.com/a/12245023/694576) ://stackoverflow.com/a/12245023/694576 （无论如何您都可以首先完成... ;->)

有关 TLS（SSL 的继任者和前 SSL 3.x）的详细信息，请参见此处：[http ://en.wikipedia.org/wiki/Transport_Layer_Security](http://en.wikipedia.org/wiki/Transport_Layer_Security)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:53:43.070

你是对的。连接是安全的（不被窃听），具有完整性（防止注入、截断和修改）和身份验证（对等方是他在证书中说的那个人），所有这些都是由传输自动为您完成的，但它仍然缺乏授权（这是我想与之交谈的人吗？这个人在我的应用程序中究竟被允许做什么）。本质上，只有应用程序才能做到这一点，因此您可以获取对等证书、获取其 SubjectDN、将其与某个本地用户数据库相关联、检查是否存在、检查其角色等。

# python - 在没有显示的情况下运行 PyQt4 脚本

> ID：12462796
> 
> 赞同：0
> 
> 时间：2012-09-17T15:48:17.033
> 
> 标签：python, qt4, pyqt4

我想运行一个 Python 脚本，该脚本通常通过没有 X11 转发的连接远程打开 Qt 窗口。有什么方法可以创建某种可以将窗口绘图发送到的虚拟显示器？（某些 x11 等效于 /dev/null）。这样做的目的是检查脚本是否与 PyQt4 的 API 一起用于不同版本的 PyQt4，但我希望能够在没有显示的服务器上远程运行它。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T06:21:45.360

您可以安装 xvfb 实用程序

```
sudo apt-get install xvfb 
```

然后将 python 脚本启动为：

```
xvfb-run python myscript.py 
```

或者如果需要从代码启动虚拟显示，仍然需要安装xvfb，另外获取pyvirtualdisplay python包

```
pip install pyvirtualdisplay 
```

然后在创建任何 qt 组件实例之前，添加以下内容：

```
from pyvirtualdisplay import Display
display = Display(visible=False, size=(1024, 768), color_depth=24)
display.start() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:54:33.707

在机器上运行一个VNC服务器；它将启动一个实例`Xfb`，即 X 服务器的内存版本。

# c# - 创建时间线和 SQL 存储

> ID：12462798
> 
> 赞同：1
> 
> 时间：2012-09-17T15:48:23.367
> 
> 标签：c#, asp.net, sql-server

语言：C#
编译器：Visual Studio 2012
操作系统：Windows 7 Home Premium

这是一个关于许多问题的问题，并且经过了几次辩论。
我知道目前有针对功能时间线的临时 .net 控件，以及有关如何完成流程的提示和技巧，但我（到目前为止）还没有找到关于维护良好的 SQL 存储时间线系统的完整教程.

我需要记录我的网站几乎所有的变化。从增加用户声誉，到加入/创建和最终提交成员、部落游戏等。
据我所知，应该避免使用 SQL 数据库中的**DateTime**，尤其是大量使用。

时间线的实施、过程和最终输出是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T19:14:18.287

您所描述的有时被称为“审计历史” - 它通常使用单个非规范化表来实现，但是当您失去强类型时，许多数据库纯粹主义者会反对它。

该表如下所示：

```
AuditTable( EventId bigint, DateTime datetime, Subject nvarchar, Table varchar, Column varchar, TablePK bigint, OldValueInt bigint nullable, OldValueStr nvarchar nullable )
-- add more nullable columns for more types, if necessary 
```

每次更改值时，例如增加用户的声誉，您将在此表中添加一行，例如：

```
INSERT INTO AuditTable( Now(), N'User reputation increased', 'Users', 'Reputation', @userId, 100 ) 
```

您只需要存储旧值（更改前的值），因为新（即当前）值将在实际表行中。

使用 SQL Server 表触发器可以完全自动添加到审计表。

要查看用户的信誉历史记录，您可以执行以下操作：

```
SELECT * FROM AuditTable WHERE Table = 'Users' AND Column = 'Reputation' AND TablePK = @userId 
```

现在正如我所说，这种设计更多的是用于审核而不是维护易于用户访问的历史记录，这些是缺点：

*   您无法对表进行语义索引，因此查找和列表总是很慢
*   您将数据库元数据存储为字符串，因此有很多开销
*   没有参照完整性（这可能是一件好事，因为如果您重新构建原始表，数据将保留，例如从用户表中删除 Reputation 字段）

如果你想更“纯粹”，那么你真的必须设计一个直接支持你想要构建的历史跟踪的表结构。您不需要为每个字段创建历史记录表 - 即使 Stackoverflow 也不会存储所有内容的历史记录。例如：

```
 UserReputationHistory ( UserId bigint, ReputationChange int, DateTime when, Subject nvarchar ) 
```

当然，必须维护这些不同的 FooHistory 表确实会使您的代码复杂化。

您评论的原始问题中的其他内容，例如成员的加入日期不需要历史记录表，您可以从`DateJoined`成员自己的数据库行中的字段中获取。

# node.js - Node.JS MongoDB 排序/过滤功能是否在数据库之外可用？

> ID：12462799
> 
> 赞同：0
> 
> 时间：2012-09-17T15:48:24.140
> 
> 标签：node.js, mongodb, sorting, filter, filtering

`MongoDB`排序功能非常整洁。您可以在与数据库本身无关的对象和/或数组上使用它们吗？

```
var mongo       = require('mongodb'),
    Server      = mongo.Server,
    Db          = mongo.Db,
    sortingFun  = mongo.internalSortFilterFunction(); // By the miracle of imagination, this is a made-up line. 
```

例如，有[一个很棒的小节点项目](https://github.com/crcn/sift.js)，名为`sift`：*MongoDB 启发的数组过滤*。但是有更多类似的工具，不同的意见，以及合并和消失的项目。

考虑到它的受欢迎程度，`MongoDB`很可能会流连忘返。出于这个原因，加上完全相似而不是非常相似的额外好处，我想知道 node-mongodb 中的特定对象/模型/函数是否可以从`require('mongodb')`专门链接到使用自定义对象/数组上的排序和过滤函数.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:00:54.170

排序是在 mongo 服务器中完成的，而不是在客户端。它也不是特别快——大集合应该预先排序，但这是另一个问题。

mongo 服务器是用 C++ 编写的 afaik，使用自定义类型，与 JS 引擎分开，称为 BSON。

因此，如果客户端上没有 javascript 的排序实现，这将是一个荒谬的功能，您就不能使用服务器排序。

编辑：如果你真的想使用排序，性能该死，你可以将 js 对象插入数据库，在 mongo 集合中有效地将它们转换为 BSON。然后对其进行排序并从数据库中提取。每次调用该函数都需要重新创建索引等。Mongodb 也拒绝为无索引的大集合进行排序（我相信限制在 1000 左右）

PS。我没有读过源码。我无法想象与 MongoDB 的排序速度相匹配的 JS 实时、无索引排序。分布（分片）时。但是你可以用 C++ 编写 node.js 模块，如果 BSON 与 V8 JS 对象足够相似（不这么认为），你也许可以移植它。我不会走这条路，因为与在 JS 中重新实现它相比，它可能不会有很大的速度提升，这种重新实现将更容易创建和维护。

# ruby-on-rails - NameError: 未初始化的常量 ::Nokogiri

> ID：12462801
> 
> 赞同：4
> 
> 时间：2012-09-17T15:48:28.340
> 
> 标签：ruby-on-rails, ruby, rspec, nokogiri

我为模型编写了测试：

```
describe Video do
  describe 'searching youtube for video existence' do
    it 'should return true if video exists' do
      Video.video_exists?("http://www.youtube.com/watch?v=KgfdlZuVz7I").should be_true
    end
  end  
end 
```

这是模型代码：

```
class Video < ActiveRecord::Base
  attr_accessible :video_id

  def self.video_exists?(video_url)
    video_url =~ /\?v=(.*?)&/
    xmlfeed = Nokogiri::HTML(open("http://gdata.youtube.com/feeds/api/videos?q=#{$1}"))
    if xmlfeed.at_xpath("//openSearch:totalResults").content.to_i == 0
      return false
    else
      return true
    end
  end
end 
```

但它失败并出现错误：

```
Failures:

  1) Video searching youtube for video existence should return true if video exists
     Failure/Error: Video.video_exists?("http://www.youtube.com/watch?v=KgfdlZuVz7I").should be_true
     NameError:
       uninitialized constant Video::Nokogiri
     # ./app/models/video.rb:6:in `video_exists?'
     # ./spec/models/video_spec.rb:6:in `block (3 levels) in <top (required)>'

Finished in 0.00386 seconds
1 example, 1 failure 
```

我不知道如何解决这个问题，可能是什么问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-18T02:32:36.340

问题是因为我没有添加`gem nokogiri`到 Gemfile。

添加它后，我`require 'nokogiri'`从`require 'open-uri'`模型中删除了它，它可以工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T16:41:27.517

听起来你不需要 Nokogiri，所以你需要这样做。

```
uninitialized constant Video::Nokogiri 
```

是赠品。Ruby 知道“Nokogiri”是一个常数，但不知道在哪里可以找到它。

在您的代码中，Nokogiri 依赖 Open-URI 来检索内容，因此您也需要这样做`require 'open-uri'`。Nokogiri 读取 Open-URI`open`返回的文件句柄。

本节可以写得更简洁：

```
if xmlfeed.at_xpath("//openSearch:totalResults").content.to_i == 0
  return false
else
  return true
end 
```

作为：

```
!(xmlfeed.at_xpath("//openSearch:totalResults").content.to_i == 0) 
```

或者：

```
!(xmlfeed.at("//openSearch:totalResults").content.to_i == 0) 
```

# ios - xcdatamodel 中的错误

> ID：12462803
> 
> 赞同：4
> 
> 时间：2012-09-17T15:48:32.040
> 
> 标签：ios, xcode, xcdatamodel

我在 Xcode 中的 xcdatamodel 文件似乎表现得很奇怪。

当我第一次构建我的项目时，它给出了一个错误

```
"Unable to write VersionInfo.plist for the versioned model at <Path>" 
```

和

```
"Compilation failed for data model at path <Path>" 
```

但是当我再次运行它时，它运行没有错误。然后过了一段时间，当我再次构建时，错误再次弹出并再次消失。有时我会收到一条不同的错误消息，上面写着

无法删除现有模型

有任何想法吗 ？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-06T22:41:46.990

I was getting this same error, then eventually also got the error mentioned in [this other question/answer](https://stackoverflow.com/questions/14230297/could-not-create-bundle-folder-for-versioned-model#answer-16139661 "this answer"). After following the suggestion in this answer, the error seems to have gone away:

**Solution 1:**

**Delete the following directory:**

```
/Users/john/Library/Developer/Xcode/DerivedData/name-of-app-gfofxrkhgcfgcfecjrnbbgyowlnf 
```

I later got the same error where this first solution didn't work. This time the following solution worked instead:

**Solution 2:**

**Recursively set the permissions to 777 for this directory:**

```
chmod -R 777 /Users/john/Library/Developer/Xcode/DerivedData/name-of-app-gfofxrkhgcfgcfecjrnbbgyowlnf 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-06T07:06:48.707

**1.**删除派生数据： **Windows** >**项目**>**选择您的项目**>**派生数据**>**删除**

**2.**清理你的项目。

它应该工作。如果还是不行，

**3.**持续运行项目（这实际上对我有用..）

希望它有效！

# ios - 使用 GPUImage 对视频进行色度过滤？

> ID：12462805
> 
> 赞同：3
> 
> 时间：2012-09-17T15:48:39.583
> 
> 标签：ios, video, transparency, gpuimage

我正在尝试`RGB: 0x00FF00`使用@BradLarson 很棒的[GPUImage](https://github.com/BradLarson/GPUImage)工具包使用透明度键（或全绿色）在我的应用程序中显示具有透明度的视频文件。但是，我在使用`GPUImageChromaKeyFilter`过滤器时遇到了一些困难，我不太明白为什么。

我的源视频文件在我的 Dropbox 中可用[（](https://dl.dropbox.com/u/25258177/personal/sample.m4v) 12 KB，3 秒长，全绿色背景，屏幕上只是一个正方形），

我使用了名为`SimpleVideoFilter`.

这是我尝试使用的代码（我只是替换了`-viewDidLoad`）：

```
NSURL *sampleURL = [[NSBundle mainBundle] URLForResource:@"sample" withExtension:@"m4v"];
movieFile = [[GPUImageMovie alloc] initWithURL:sampleURL];

filter = [[GPUImageChromaKeyFilter alloc] init];
[filter setColorToReplaceRed:0 green:1 blue:0];
[filter setEnabled:YES];

[movieFile addTarget:filter];

GPUImageView *filterView = (GPUImageView *)self.view;
[filter addTarget:filterView];

[movieFile startProcessing]; 
```

根据文档（这是稀疏的），这*应该*具有替换视频中所有绿色的效果。相反，我将其作为输出：

![视频截图](../Images/1d7074903d63d1a9a7c387859851b0a1.png)

这告诉我视频正在播放（因此它正在复制到应用程序），但它似乎没有进行任何色度键控。为什么会这样？我是否需要手动设置平滑值和阈值？我不应该，因为源只包含两种颜色（`0x00FF00`和`0x000000`）。

我也在设备上对此进行了测试，但无济于事。我尝试使用的几乎所有其他过滤器都可以工作，例如`GPUImageRGBFilter`,`GPUImageSepiaFilter`等。会`GPUImageChromaKeyFilter`被破坏吗？

对此的任何帮助将不胜感激，因为此时我正在刮擦桶的底部以获得视频的透明度。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-23T12:30:11.607

与原始问题类似，我想将绿屏视频放在自定义视图层次结构的顶部，包括。现场视频。事实证明，使用标准 GPUImage ChromaKey 过滤器是不可能的。它不是 alpha 混合，而是将绿色像素与背景像素混合。例如，红色背景变成黄色，蓝色变成青色。

让它工作的方法包括两个步骤：

**1）确保filterview具有透明背景：**

```
filterView.backgroundColor=[UIColor clearColor]; 
```

**2）修改GPUImageChromaKeyFilter.m**

```
old: gl_FragColor = vec4(textureColor.rgb, textureColor.a * blendValue);
new: gl_FragColor = vec4(textureColor.rgb * blendValue, 1.0 * blendValue); 
```

现在，视频中的所有键控（例如绿色）像素都变得透明，并显示过滤器视图下方的任何内容，包括。（现场）视频。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T19:17:27.200

我通过使用**GPUImageChromaKeyBlendFilter**并设置背景图像使其工作。我想知道我们是否可以在不设置背景的情况下做到这一点。当我不设置背景时，电影显示为白色，但添加背景渲染良好......

```
filter = [[GPUImageChromaKeyBlendFilter alloc] init];
[(GPUImageChromaKeyBlendFilter *)filter setColorToReplaceRed:0.0 green:1.0 blue:0.0];
[(GPUImageChromaKeyBlendFilter *)filter setThresholdSensitivity:0.4];

UIImage *inputImage = [UIImage imageNamed:@"background.png"];
sourcePicture = [[GPUImagePicture alloc] initWithImage:inputImage smoothlyScaleOutput:YES];
[sourcePicture addTarget:filter];
[sourcePicture processImage]; 
```

# php - 使用不会删除标签的技术限制用户使用特定标签

> ID：12462814
> 
> 赞同：0
> 
> 时间：2012-09-17T15:49:01.533
> 
> 标签：php, wordpress, tags, limit, restrict

我运行一个包含数千个帖子的多作者 Wordpress 网站。为了突出好帖子，我按只有管理员可以设置的特定标签过滤它们。例如`featured`，`front page`等等。

为了避免作者自己选择这些标签，我使用以下脚本。如果用户选择了一个禁止标签，一旦他们点击发布按钮，它就会被删除。评论是为了方便：

```
add_action('save_post', 'remove_tags_function', 10, 1); //whenever a post is saved, run the below function

function remove_tags_function( $post_id ){
    if(!current_user_can('manage_options')){ // if the logged in user cannot manage options (only admin can)
        $post_tags = wp_get_post_terms( $post_id, 'post_tag', array( 'fields'=>'names' ) ); //grab all assigned post tags
        $pos = array_search( 'tag-to-be-deleted', $post_tags ); //check for the prohibited tag
        if( false !== $pos ) { //if found
            unset( $post_tags[$pos] ); //unset the tag
            wp_set_post_terms ($post_id, $post_tags, 'post_tag'); //override the posts tags with all prior tags, excluding the tag we just unset
        }
    }//end if. If the current user CAN manage options, the above lines will be skipped, and the tag will remain
} 
```

此解决方案存在一个主要问题。帖子发布后，管理员会给它一个`featured`标签 - 但是，如果原作者对他们的帖子进行任何更新，该标签就会消失。你明白这个问题吗？

很多作者喜欢修改自己的帖子，尤其是在评论中收到反馈的时候，还有就是新闻相关的帖子，需要经常更新。

**您能提出什么解决方案来解决这种情况？**管理员需要能够提供特色标签，如果作者更新他们的帖子，标签应该保留。什么谜...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T15:53:47.530

您必须区分用户添加的标签和管理员添加的标签并分别处理它们。将标志列添加到标签或将用户和管理员的标签保存在单独的表格中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T16:02:34.607

我建议您根本不为您的管理属性使用标签。本质上，您要做的就是用某些属性标记某些帖子。

为此，我可能会建议使用自定义分类法。

See the linked article, especially the "Using Labels For Taxonomies" section to give you some ideas on how to add custom handling for your attributes, that could be kept separate from the tag system altogether.

[The Link](http://new2wp.com/pro/wordpress-custom-post-types-and-taxonomies-done-right/)

# android - Android：注册意图过滤器以使用我的应用程序打开电子邮件附件

> ID：12462816
> 
> 赞同：7
> 
> 时间：2012-09-17T15:49:08.467
> 
> 标签：android, email, android-intent, filter, attachment

我有一个生成自定义文件类型 (.sor) 的应用程序。在应用程序中，我有一个功能可以发送附有这些文件之一的电子邮件。我还有一个意图过滤器，允许应用程序显示在可以打开此类文件的应用程序列表中。这允许我（有时）直接从手机上的用户电子邮件客户端使用应用程序打开文件。

但是，这仅在电子邮件来自 PC 电子邮件客户端时有效，并且在从电话接收电子邮件时不起作用。例如，如果我生成其中一个 .sor 文件，然后使用我的应用程序向我自己的电子邮件帐户发送电子邮件，我将在手机上收到电子邮件，但无法使用我的应用程序打开附件...但是，如果我将电子邮件发送到同一个帐户并在我的 PC（使用 Thunderbird）而不是手机上打开它，然后转发它或将其作为新电子邮件发送到我的手机，我将能够使用相同的电子邮件应用程序在手机上用我的应用程序打开附件......我在这里只谈论一个电子邮件帐户，唯一的区别是电子邮件是从哪里发送的，我的手机或我的 Windows 7 PC。

我唯一能想到的是，当我从手机发送电子邮件时，附件中嵌入了不同的 mime 类型，而不是我从 PC 上的 Thunderbird 发送电子邮件时......我将 mime 类型指定为“应用程序/ octet-stream" 当我从我的应用程序发送电子邮件时，我有一个意图过滤器来查找这种 mime 类型......但它不能正常工作。

我的意图过滤器：

```
<intent-filter>
  <action android:name="android.intent.action.VIEW" />
  <category android:name="android.intent.category.DEFAULT" />
  <data android:mimeType="application/octet-stream" />
  <data android:scheme="file" />
</intent-filter> 
```

从手机发送电子邮件附件中的文件时，我传递给手机电子邮件客户端的意图：

```
Intent sendIntent = new Intent(Intent.ACTION_SEND);
sendIntent.setType("application/octet-stream");
sendIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file://" + fullPathString));
sendIntent.putExtra(Intent.EXTRA_SUBJECT, "FiberDroid OTDR Trace File: \"" + ContextMenuFileName + "\"");
sendIntent.putExtra(Intent.EXTRA_TEXT, "This e-mail was sent from the TTI FiberDroid Android application.");
startActivity(Intent.createChooser(sendIntent, "Select E-Mail Application")); 
```

同样，带有附件的电子邮件的发送工作正常......如果我从 PC 电子邮件客户端（如 Outlook 或 Thunderbird）将相同的文件通过电子邮件发送回手机，那么我可以使用我的应用程序打开文件直接从手机电子邮件应用程序。问题是，如果我在电话上打开电子邮件而不通过我的电脑作为中间人，我将无法打开附件，我得到的唯一选项是“保存到 SD 卡”......

回顾一下，我的手机上有两封相同的电子邮件，附有相同的文件，并且最初都是从我的应用程序发送到同一个帐户（也都是从同一个帐户收到的），但附件中的附件通过了我的电脑作为不必要的中间人可以正常工作，而直接从我的手机发送和接收的电脑则不能。

有任何想法吗？先感谢您。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-18T13:09:19.213

我已经解决了这个问题，主要是通过在黑暗中拍摄并且没有真正理解为什么我做了什么解决了它，但这是我现在在清单中为我的意图过滤器所拥有的，其中“.sor”是我的自定义文件的扩展名类型。这适用于我尝试过的所有电子邮件和文件管理应用程序，包括 K-9 邮件和 Astro：

```
<!-- For email attachments -->
<intent-filter>
   <action android:name="android.intent.action.VIEW" />
   <category android:name="android.intent.category.DEFAULT" />
   <data android:mimeType="application/*" host="*" android:pathPattern=".*.sor" android:scheme="content" />
</intent-filter>

<!--  For file browsers -->
<intent-filter>
   <action android:name="android.intent.action.VIEW"/>
   <category android:name="android.intent.category.DEFAULT"/>
   <data android:mimeType="application/*" host="*" android:pathPattern=".*.sor" android:scheme="file" />
</intent-filter> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-29T15:25:07.820

Tim Autin 对这个问题的示例[Android Intent filter not working](https://stackoverflow.com/questions/39300649/android-intent-filter-not-working?noredirect=1&lq=1)对我有用。他使用了三个意图过滤器：

*   一种用于支持的 mime 类型
*   一种用于具有通配符 mime 类型的文件扩展名`<data android:mimeType="*/*" />`
*   一种用于完全没有 mime 类型标签的文件扩展名

mime 类型和文件扩展名的组合受到限制，最终与我的文件扩展名完全不匹配

# php - Firefox中损坏的GD库Pngs

> ID：12462817
> 
> 赞同：1
> 
> 时间：2012-09-17T15:49:09.280
> 
> 标签：php, gd

我使用 PHP 和 GD 库创建了自己的自定义蜘蛛图生成器。基本上，用户回答一系列问题，并根据问题的答案生成蜘蛛图。

总的来说，一切都很好。生成的图表在数学上是准确的（不过，测验需要完全改写），而且它似乎运行得足够快。但是，我注意到，当我尝试从 Firefox（Snowleopard 上的版本 15.0.1）保存图像时，图像本身无法打开。从任何其他浏览器保存图像会生成可以在任何图像编辑器中打开的工作图像。

我发现特别有趣的是它何时破裂。我会看看我是否可以准确地解释这一点。

完整的工作版本是 [**不再在这里**]，这里是图表本身的处理和生成所涉及的所有相关代码位：

**chart.php**（处理 POST 数据）

```
$r = 300; //Radius
//Processing of information passed from the previous form yields an array $cargs
//$cargs contains key value pairs. Values are of type float with a range 0-$r

$chart = new Chart($r); //Generates Canvas and Circle
$chart->generate($cargs); //Generates Polygon based on $cargs

header("Content-type: image/png");
imagesavealpha($chart->image, true);
imagepng($chart->image);
imagedestroy($chart->image);
?> 
```

**SS_Chart.php**（图表对象）

```
class Chart
{
    public $radius;
    public $diameter;
    public $image;

    private $_labels;
    private $_values;
    private $_n;

    public function Chart($r=300)
    {
        $this->radius = $r;
        $this->diameter = 2*$r;
        $this->image = $this->_get_transparent_canvas($this->diameter, $this->diameter);
        $this->_draw_circle();
    }
    public function generate($arr)
    {
        if(count($arr)>2)
        {
            $red = imagecolorallocate($this->image, 255, 0, 0);
            $this->_n = count($arr);
            $this->_labels = array_keys($arr);
            $this->_values = array_values($arr);

            $coors = array();
            for($i=0;$i<$this->_n;$i++)
            {
                //Generate coordinates....
            }
            imagefilledpolygon($this->image, $coors, $this->_n, $red);
        }
        else
            trigger_error('Number of $key=>$value pairs in arguments must be 3 or greater', E_USER_ERROR);
    }
    private function _get_transparent_canvas($w, $h)
    {
        $canvas = imagecreatetruecolor($w, $h);
        imagealphablending($canvas, true);
        $transparent = imagecolorallocatealpha($canvas, 0, 0, 0, 127);
        imagefill($canvas, 0, 0, $transparent);

        return $canvas;
    }
    private function _draw_circle()
    {
        $white = imagecolorallocate($this->image, 255, 255, 255);
        imagearc($this->image, $this->radius, $this->radius, $this->diameter, $this->diameter,  0, 360, $white);
    }
} 
```

有趣的地方在于：当`$chart->generate($cargs);`在 chart.php 中注释掉时，Firefox 将根据尺寸生成一个可工作且可编辑的透明 png，以及一个白色圆圈。

但是，如果我注释掉`public function generate`SS_Chart.php 中的所有内容并保持未`$chart->generate($cargs);`注释（基本上会导致方法运行，但实际上不执行任何操作），则无法再打开生成的 png。

**这怎么可能？？**

除了这里和那里的奇怪论坛描述了让 Firefox 与 GD 库合作的一些困难之外，我在这个问题上没有找到太多的东西，但这是我第一次遇到这样的事情。

*   如果我的代码有问题，那么这个问题不会在所有浏览器中普遍存在吗？
*   这是否与范围界定以及主要 GD 函数在对象中使用的事实有更多关系？
*   此外，这个问题是否会发生在其他人身上？
*   有没有人遇到过这样的问题？
*   这甚至是一个*已知*问题吗？

这实际上更像是一个好奇心，而不是一个真正的“问题”，但任何对此事的洞察力将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T15:01:39.437

查看该**保存**图像的来源

```
<br />
<b>Fatal error</b>:  Number of $key=>$value pairs in arguments must be 3 or greater in <b>/home/mattmaio/public_html/dev/assets/classes/SS_Chart.php</b> on line <b>38</b><br /> 
```

当您将其保存在 Firefox 中时，fireox 不会保存您看到的内容。它的作用是 - 它在保存时发出另一个 GET 请求。

```
GET http://dev.mattmaiorano.com/chart.php HTTP/1.1
Host: dev.mattmaiorano.com
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:15.0) Gecko/20100101 Firefox/15.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-gb,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive
Referer: http://dev.mattmaiorano.com/chart.php 
```

显然，所有 POST 数据都丢失了，因此出现了错误。我不确定你评论的事情，但我想就是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-05T11:33:00.703

我在这里看到 2 个问题

*   保存
*   破圈

### 保存

你应该做的是保存图像，然后用`readfile`这种方式输出它，文件不必重新生成，它也适用于 Firefox

> 不必一直生成图像也有助于节省带宽

示例代码

```
$r = 300; // $cargs
$tempDir = "xxx";
session_start();

__flush($tempDir);

if (isset($_POST) || ! isset($_SESSION['file'])) {
    $_SESSION['file'] = $tempDir . DIRECTORY_SEPARATOR . sha1(serialize($_POST)) . ".png";
}

header("Content-type: image/png");
$file = $_SESSION['file'];

if (file_exists($file)) {
    readfile($file);
} else {
    $chart = new Chart($r); // Generates Canvas and Circle
    $chart->generate(array("A" => array(40,50),"B" => array(20,240),"C" => array(60,60),"D" => array(240,20),"E" => array(50,40),"F" => array(10,10))); // Generates

    imagesavealpha($chart->image, true);
    imagepng($chart->image, $file);
    imagedestroy($chart->image);
} 
```

### 破圈

破碎的圆圈`has nothing to do with Firefox`..在我的初步调查中，当我使用自己的变量运行您的代码时，它生成了以下图像..

![在此处输入图像描述](../Images/84d36848671b0d04b6795b8a3e2b9ede.png)

问题

从上图中，`green`制造商显示了虚线。当以下情况属实时，我必须发现此错误：

> 画布宽度 = 圆直径

您这样称呼它的代码是哪种形式：

```
imagearc($this->image, $this->radius, $this->radius, $this->diameter, $this->diameter, 0, 360, $white); 
```

解决方案

你应该做的是用这样的东西稍微减小圆的直径

```
 imagearc($this->image, $this->radius, $this->radius, ceil(0.9 * $this->diameter), ceil(0.9 * $this->diameter), 0, 360, $white); 
```

你会得到一个完美的圆圈

![在此处输入图像描述](../Images/28bed7a8a4800e589fe96949302c83d3.png)

### 使用的代码

```
$r = 300; // $cargs
$tempDir = "xxx";
session_start();

__flush($tempDir);

if (isset($_POST) || ! isset($_SESSION['file'])) {
    $_SESSION['file'] = $tempDir . DIRECTORY_SEPARATOR . sha1(serialize($_POST)) . ".png";
}

header("Content-type: image/png");
$file = $_SESSION['file'];

if (file_exists($file)) {
    readfile($file);
} else {
    $chart = new Chart($r); // Generates Canvas and Circle
    $chart->generate(array("A" => array(40,50),"B" => array(20,240),"C" => array(60,60),"D" => array(240,20),"E" => array(50,40),"F" => array(10,10))); // Generates

    imagesavealpha($chart->image, true);
    imagepng($chart->image, $file);
    imagedestroy($chart->image);
}

function __flush($tempDir) {
    $expire = 300; // 5mins
    $iterator = new DirectoryIterator($tempDir);
    foreach ( $iterator as $fileinfo ) {

        if ($fileinfo->isDot())
            continue;

        if ((time() - $fileinfo->getMTime()) > $expire) {
            @unlink($iterator->getPath());
        }
    }
}

class Chart {
    public $radius;
    public $diameter;
    public $image;
    private $_labels;
    private $_values;
    private $_n;

    public function Chart($r = 300) {
        $this->radius = $r;
        $this->diameter = 2 * $r;
        $this->image = $this->_get_transparent_canvas($this->diameter, $this->diameter);
        $this->_draw_circle();
    }

    public function generate($arr) {
        if (count($arr) > 2) {
            $red = imagecolorallocate($this->image, 255, 0, 0);
            $this->_n = count($arr);
            $this->_labels = array_keys($arr);
            $this->_values = array_values($arr);

            $coors = array();
            foreach ( $this->_values as $key => $value ) {
                $coors = array_merge($coors, $value);
            }
            imagefilledpolygon($this->image, $coors, $this->_n, $red);
        } else
            trigger_error('Number of $key=>$value pairs in arguments must be 3 or greater', E_USER_ERROR);
    }

    private function _get_transparent_canvas($w, $h) {
        $canvas = imagecreatetruecolor($w, $h);
        imagealphablending($canvas, true);
        $transparent = imagecolorallocatealpha($canvas, 0, 0, 0, 127);
        imagefill($canvas, 0, 0, $transparent);

        return $canvas;
    }

    private function _draw_circle() {
        $white = imagecolorallocate($this->image, 255, 255, 255);
        imagearc($this->image, $this->radius, $this->radius, ceil(0.9 * $this->diameter), ceil(0.9 * $this->diameter), 0, 360, $white);
        // imagearc($this->image, $this->radius, $this->radius,
    // $this->diameterCycle, $this->diameterCycle, 0, 360, $white);
    }
} 
```

# script# - 脚本# 是否有更新的手册/文档/帮助文件？

> ID：12462819
> 
> 赞同：1
> 
> 时间：2012-09-17T15:49:15.300
> 
> 标签：script#

在网上搜索了一段时间，寻找某种关于 Script# 的综合参考资料时，我只能找到 2007 年的手册： [http ://code.google.com/p/extsharp/downloads/detail ?name=ScriptSharp-v0.4.2.pdf&can=2&q=](http://code.google.com/p/extsharp/downloads/detail?name=ScriptSharp-v0.4.2.pdf&can=2&q=)

有什么更新的可用吗？

我在网站[http://scriptsharp.com/](http://scriptsharp.com/)上看到，上面写着“敬请期待……更新网站，即将推出更多信息和文档！”

不幸的是，没有什么可说的，什么时候写的消息，所以我不知道它已经在那里多久了，或者“很快”可能是什么时候。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-21T17:09:22.447

是的，我正在努力……挑战是我也在努力进行一些重大改变以改进它。

不过，我完全意识到对文档的需求。如果您在某些事情上被阻止，是否有一个特定的问题我可以帮助解决？

# android - Textview 正确显示编码文本

> ID：12462820
> 
> 赞同：0
> 
> 时间：2012-09-17T15:49:18.337
> 
> 标签：android, encoding, character-encoding

我有一个读取加载文本文件并显示文本的应用程序。现在，文本文件可以是英文、中文或任何语言。我的问题是，如何正确显示字符而不显示乱码。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:06:17.180

参考这个链接。

[如何在 Textview 上显示韩文？](https://stackoverflow.com/questions/7632568/how-to-display-korean-text-on-textview)

您需要 True Type 字体（ttf）文件来支持您希望的语言。将相应的字体文件包含到您的资产文件夹中并尝试此代码。

```
TextView text = (TextView) findViewById(R.id.textView1);
Typeface font=Typeface.createFromAsset(activity.getAssets(), "your-choice-font.ttf");
holder.text.setTypeface(font);
holder.text.setText(content_read_from_TxtFile); 
```

# c# - 如何使用 AForge 从 ip camera 录制和保存视频？

> ID：12462823
> 
> 赞同：2
> 
> 时间：2012-09-17T15:49:21.223
> 
> 标签：c#, asp.net, aforge

我尝试使用 AForge 做一个录制功能，其中源来自 C# 中的 IP 摄像机，但我不能真正理解编码，因为我是一个新学习者。录制的视频将保存在我的计算机中。
据我所知，此功能是编写/创建视频并将其保存在我的存储中。

```
AVIWriter writer = new AVIWriter("DIB ");
// create new AVI file and open it
writer.Open(@"C:\test.avi", 768, 576);
// create frame image
Bitmap image = new Bitmap(768, 576);

for (int i = 0; i < 240; i++)
{
// update image
image.SetPixel(i, i, Color.Red);
// add the image as a new frame of video file
writer.AddFrame(image);
}
writer.Close(); 
```

但是如何读取 mjepg 格式的源文件（IP cam）并将其传递给 AVIWriter？有人可以指导我如何实现这一目标

新手，请指导我....

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T16:24:14.747

您需要参考 AForge.video AForge.video.VFW

如果您的相机提供 MJPEGstream 则（对不起，它在 VB 中）

```
Imports AForge.Video
Imports AForge.Video.VFW
'…
Dim VideoStream As MJPEGStream = New MJPEGStream("<your MJPEG URL>")
Dim VFWriter = New AVIWriter(("your compression codec 4CC ex:xvid>"))
VFWriter.FrameRate = <framerate>

AddHandler VideoStream.NewFrame, AddressOf NewStreamFrame '<Your Handler>

'…

Public Sub StartRecording()
VFWriter.Open("<destinationFile.avi>", <FrameSize.Width>, <FrameSize.Height>)
‘FrameSize.Width and height must correspond to what your camera is sending
       VideoStream.Start()
End Sub

Public Sub StopRecording()
        VFWriter.Close()
End Sub

Private Sub NewStreamFrame(sender As System.Object, e As NewFrameEventArgs)
        VFWriter.AddFrame(e.Frame)
End Sub 
```

代码不完整我删除了错误处理和其他装饰。此代码将读取和保存视频而不显示它如果您已经有一个 VideoSourcePlayer，播放器也可以使用图像帧作为参数触发一个 NewFrame 事件。在这种情况下，您不需要手动添加处理程序。

# object - 经典 ASP 对象

> ID：12462827
> 
> 赞同：2
> 
> 时间：2012-09-17T15:49:53.473
> 
> 标签：object, asp-classic

可以在 Classic ASP 中动态创建“空”对象并创建对象属性吗？

以这个 JavaScript 示例为例：

```
var sample = new Object();
sample.prop = "Object property";
sample.prop2 = "Another property"; 
```

什么是经典 ASP 等价物？我必须用 getter 和 setter 编写一个类吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T15:53:16.047

是的，您需要为此创建一个类

看一下

[http://www.codeguru.com/csharp/.net/net_asp/tutorials/article.php/c19317/Object-Oriented-ASP-Using-Classes-in-Classic-ASP.htm](http://www.codeguru.com/csharp/.net/net_asp/tutorials/article.php/c19317/Object-Oriented-ASP-Using-Classes-in-Classic-ASP.htm)

# java - Camel Throwing MethodNotFound 用于存在且公开的方法

> ID：12462833
> 
> 赞同：2
> 
> 时间：2012-09-17T15:50:16.253
> 
> 标签：java, apache-camel, routes, exists, methodnotfound

我正在测试骆驼回合，但是当我有路由尝试访问 bean 中的特定方法时，它一直说没有找到这样的方法。来源：

```
public class CommunicatorTest
{
    FakeMessageConverter converter;
    CamelContext context;
    ProducerTemplate template;
    String producerEndpoint = "seda:messagesFound";
    long test = 123456789;

    static final Logger logger = Logger.getLogger(CommunicatorTest.class);

    public CommunicatorTest()
    {

    }

    @Before
    public void setUp() throws Exception
    {
        converter = new FakeMessageConverter();
        SimpleRegistry registry = new SimpleRegistry();
        registry.put("converter", converter);
        context = new DefaultCamelContext(registry);
        template = context.createProducerTemplate();
        context.addRoutes(new CommunicatorRoute());

        logger.info("Done creating context");

        context.start();
    }

    @After
    public void tearDown() throws Exception
    {
        context.stop();
    }

    @Test
    public void testExistanceOfBean()
    {
        Object lookup = context.getRegistry().lookup("converter");
        assertTrue("Object not a MessageConverter", lookup instanceof FakeMessageConverter);
    }

    @Test
    public void testRoute()
    {
        Message msg = new Message();
        msg.setHeader(new MessageHeader());
        msg.getHeader().setSourceId(test);

        logger.info("Sending data");
        template.sendBody(producerEndpoint, msg);

        assertEquals("value not the same", test, converter.getSid());
        logger.info("Done Sending");
    }

    private static class FakeMessageConverter
    {

        private long sid;
        private boolean edited = false;

        public FakeMessageConverter()
        {
        }

        public void processMessage(Message msg)
        {
            sid = msg.getHeader().getSourceId();
            edited = true;
            logger.info("The sid"+sid);
        }

        /**
         * @return the sid
         */
        public long getSid()
        {
            return sid;
        }

        /**
         * @param sid the sid to set
         */
        public void setSid(long sid)
        {
            this.sid = sid;
        }
    }

} 
```

路线如下：

```
public class CommunicatorRoute extends RouteBuilder
{

    @Override
    public void configure() throws Exception
    {
        from("seda:messagesFound").bean("converter", "processMessage");
    }

} 
```

例外情况如下：

```
ERROR [org.apache.camel.component.seda.SedaConsumer] - Error processing exchange. Exchange[Message: net.package.Message@f593af]. Caused by: [org.apache.camel.component.bean.MethodNotFoundException - Method with name: processMessage not found on bean: converter. Exchange[Message: net.package.message.Message@f593af]] 
```

org.apache.camel.component.bean.MethodNotFoundException：方法名称：在 bean 上找不到 processMessage：转换器。交流[留言：com.saic.jswe.common.cdif.message.Message@f593af]

我对骆驼还很陌生，所以如果我犯了一些非常简单的错误，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T18:54:59.417

你的类是私有静态的。它必须是公共静态的，以便 Camel 可以访问它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-19T13:20:22.857

所以我想通了，这是一个简单的错误。路由构建器使用了不起作用的行`from("seda:messagesFound").bean("converter", "processMessage");`。但是通过改变路由`from("seda:messagesFound").beanref("converter", "processMessage");`和（正如克劳斯提到改变内部类对公共的访问）它工作得很好。只需将类更改为 public 而不是 private 只会改变它看起来的错误。

问题的症结在于 .bean() 方法不查看注册表，所以当我传递它时，`converter`我以为我给它的是要使用的 bean 的名称，但唯一适合的 .bean() 变体是`public Type bean(Object bean, String method)`。所以当然骆驼找不到方法：它试图找到方法“processMessage”，而不是在我的转换器中，而是在我传递的字符串中。

# javascript - 确保脚本仅包含在某些页面中

> ID：12462834
> 
> 赞同：2
> 
> 时间：2012-09-17T15:50:18.927
> 
> 标签：javascript, web-services, security, api

# 问题

我有一项向用户推送内容的服务。为了向他们的用户提供这些内容，客户将在他们的网站上包含一个脚本。他们的脚本向我的服务器发送一个令牌以识别它是哪个客户，但问题是：如果有人从用户的站点复制脚本，他们可以接收此实时内容，并且客户需要为不在其站点上的用户付费. 那么，有没有办法确保脚本只包含在他们的网站上？谷歌分析是如何做到这一点的？

我有一个想法，但我不知道这是否完全安全。

1.  客户告诉我他们想在其中包含我的脚本的任何域（包括子域）。
2.  我给用户一个非常小的文本文件，他们存储在他们的服务器上。
3.  加载我的脚本后，它会检查 window.location.host，并尝试从托管域的根目录中获取文本文件。
4.  如果找到文件，并且内容与我给客户文件时生成的内容相匹配，我将激活服务。

这行得通吗？

# 为什么我不能使用 window.location

假设我的脚本读取 window.location，并将其发送到 url`mydomain.com?token=ABC&locationhost=goodcustomer.com`

现在 baduser.com 的所有者想要滥用 gooduser.com 的帐户，所以他包含了 gooduser.com 的脚本。该脚本现在发送一个 ajax 请求到`mydomain.com?token=ABC&locationhost=badcustomer.com`

这不会启动服务，因为 badservice.com 不是 goodcustomer.com 的所有者在注册时输入的域。这很容易绕过，因为 badcustomer.com 的所有者可以查看我的脚本，注意到它正在发送验证 url 的请求，然后发送他自己的请求。所以他会向 发送请求`mydomain.com?token=ABC&locationhost=goodcustomer.com`。我的服务器看到此请求，将 locationhost 与与令牌关联的域进行比较，并开始将针对 goodcustomer.com 的用户的内容提供给 badcustomer.com 的用户。我的服务器无法知道请求是由我自己的脚本发送的，还是由试图冒充实际客户的用户发送的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:08:43.810

您不能仅使用在最终用户浏览器中运行的脚本来为此提供安全的解决方案。想要模仿您的客户网站的人总是能够通过创建您发送到浏览器的每个脚本或文件的副本来做到这一点。您将需要在您的客户服务器上做一些事情。也就是说，您的客户必须拥有某种未发送到浏览器的秘密。

一种方法是为客户提供一个生成一次性令牌的服务器端脚本。让您的脚本调用此服务器端脚本以获取令牌并将此令牌包含在对您的服务器的请求中。您的服务器必须在生成数据之前检查令牌是否正确。

可以通过向每位客户发送一个 20 个字符长的密码来制作一次性令牌。让服务器端脚本读取密码，添加日期和时间并使用 SHA-256 对这个值进行散列。如果您不知道密码，则很难创建虚假令牌。如果在服务器端脚本中添加一个计数器会更好。让计数器为每个请求增加一个。但是，如果您站点上的计数器与客户站点上的计数器不同步，计数器会引入一些同步问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T16:02:50.267

您可以建立一个用户将托管脚本的域的数据库，然后当用户加载脚本时，它将发送`window.location`到您的服务器，然后如果窗口位置与数据库中的位置匹配，您的服务器将发送内容。

# php - 数组被 ajax 帖子截断。Ajax 发帖限制？

> ID：12462840
> 
> 赞同：8
> 
> 时间：2012-09-17T15:50:34.397
> 
> 标签：php, jquery, ajax, arrays, multidimensional-array

我有一个多维数组，它由 426 个较小的数组组成，它还包含 4 个属性。下面是 426 个数组之一的示例...

```
 array( //Main array
          0 => array( //1 of 426 arrays
               'name' => 'Danny', 
               'email' => 'your@email.com', 
               'picture_url' => 'http://www.website.com', 
                'score' => 89
          ),
    ) 
```

我将这个带有 jquery ajax 函数的数组发布到一个 php 文件中，然后将它们添加到一个数据库中......我的问题是，当它发布到 php 文件时，该数组似乎被截断了。只有大约一半的数组实际上到达了 php 文件......

这使我相信通过 ajax 发布时可能存在文件大小限制。但是，我的数组的大小似乎相对较小..

我在 WAMP 上运行我的应用程序..

任何人都可以阐明可能发生的事情吗？

更新：

我像这样发布我的数组：

```
$.ajax({
  type: "POST",
  url: "invite_friends.php",
  data: {
    theID: me.id,
    friends: multidimensional_array //This is the array <---
  },
  success: function(data, textStatus, jqXHR) {
    return console.log(data);
  },
  error: function(jqXHR, textStatus, errorThrown) {
    return alert("Error: Oops, there has been a problem");
  }
}); 
```

我像这样检索我的数组（在invite_friends.php中）..

```
if($_POST['friends']) {
    $friends = $_POST['friends'];   
} else {
    $friends = FALSE;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-13T20:46:18.300

您需要打开`php.ini`文件并设置（或创建）这一行：

`max_input_vars = 1000000`

`max_input_vars`默认值为 1000，这将在 1000 个元素处截断一个数组。只需将其更改为一个非常高的数字（在我的情况下，我需要将其设置为一百万）。

来自 PHP 手册：

> 可以接受多少个输入变量（限制分别应用于 $_GET、$_POST 和 $_COOKIE 超全局变量）。使用该指令可以降低使用哈希冲突的拒绝服务攻击的可能性。如果输入变量多于该指令指定的数量，则会发出 E_WARNING，并从请求中截断更多输入变量。***此限制仅适用于多维输入数组的每个嵌套级别。***

**请记住：**正如手册所述，设置此默认限制是为了防止拒绝服务攻击。

希望这会有所帮助，即使这是一个老问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-07-03T12:18:01.987

您应该在客户端将所有数据转换为 json 格式并将其作为文本发送。

```
var jsonDataString = JSON.stringify(data)
//data - array, associative array, any other variables

$.ajax({
...
    data: {
        friends: jsonDataString,
    }
...
}); 
```

在服务器端只需解码 json 文件。

```
<?php
...
$friendsJsonString = $_POST['friends'];
$friends = json_decode($friendsJsonString);
... 
```

由于安全风险，更改 php.ini 不是一个好主意。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-14T23:01:46.897

我有完全一样的问题。

```
$.ajax({data:{x:x,y:y}}); 
```

最后事实证明，其中一些值是日期格式（对象）。当它们转换为简单类型（字符串或整数）时，问题就解决了。希望这能有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T16:04:38.213

尝试在 .htaccess 和 max_input_time 中将 php_value post_max_size 设置为至少 16M，以免超时。

```
php_value post_max_size 16M
php_value max_input_time 4000 
```

# spring - org.apache.tomcat.jdbc.pool.DataSource 不再在 tomcat 7 dbcp jar 中？

> ID：12462842
> 
> 赞同：6
> 
> 时间：2012-09-17T15:50:37.263
> 
> 标签：spring, tomcat, pooling

我正在尝试使用 7.0.30 版的 tomcat-dbcp.jar 为 tomcat-dbcp 创建一个弹簧管理的独立池

然而，Tomcat 的文档（http://tomcat.apache.org/tomcat-7.0-doc/jdbc-pool.html#Standalone）中似乎提到了 org.apache.tomcat.jdbc.DataSource 类

```
<bean id="dataSource" class="org.apache.tomcat.jdbc.pool.DataSource"
    destroy-method="close">
    <property name="factory"
        value="org.apache.tomcat.jdbc.pool.DataSourceFactory" />
    <property name="type" value="javax.sql.DataSource" />
    <property name="driverClassName" value="com.mysql.jdbc.Driver" />
    <property name="url" value="jdbc:mysql://localhost:3306/ym" />
    <property name="username" value="admin" />
    <property name="password" value="admin" />
    <property name="initialSize" value="5" />
    <property name="maxActive" value="10" />
</bean> 
```

所以这个spring bean定义根据Tomcat doc是正确的，但是当我启动应用程序时，我得到CNF异常：

```
Caused by: org.springframework.beans.factory.CannotLoadBeanClassException: Cannot find class [org.apache.tomcat.jdbc.pool.DataSource] for bean with name 'dataSource' defined in class path resource [application-context.xml]; nested exception is java.lang.ClassNotFoundException: org.apache.tomcat.jdbc.pool.DataSource 
```

我是不是超级愚蠢，在这里错过了明显的东西？？？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T16:49:12.513

类`org.apache.tomcat.jdbc.pool.DataSource`包含在 tomcat-jdbc.jar 中，而不是 tomcat-dbcp.jar。[Tomcat JDBC连接池](http://tomcat.apache.org/tomcat-7.0-doc/jdbc-pool.html)是commons-dbcp的替代品，其中tomcat-dbcp只是一个重命名的版本。

jar 文件 tomcat-jdbc.jar 不包含在所有 Tomcat 安装中（例如，它不包含在标准 Debian/Ubuntu 软件包中）。[您可以从Maven Central](http://search.maven.org/#search%7Cga%7C1%7Ctomcat-jdbc)下载它，也可以在[Tomcat 二进制分发](http://tomcat.apache.org/download-70.cgi)存档中找到它。

# authentication - cakephp - 认证注销重定向

> ID：12462844
> 
> 赞同：0
> 
> 时间：2012-09-17T15:50:42.773
> 
> 标签：authentication, redirect, login, cakephp-2.0, logout

在 cakephp2.0 中，我有**domain.com**但是当我注销时（url 是**domain.com/logout**），它被重定向到**domain.com/app/login**。我不希望它重定向到**domain.com/app/login**而是重定向到**domain.com/logout**。这些是我在我的 UsersController 和我的 AppController 中的代码

```
class AppController extends Controller {
public $helpers = array ('Html', 'Form', 'Js' => array('Jquery'), 'Session');

public $components = array(
    'Session',
    'Auth' => array(
        'loginRedirect' => array('controller' => 'posts', 'action' => 'index'),
        'logoutRedirect' => array('controller' => 'users', 'action' => 'login'),
         'authorize' => array('Controller') // Added this line
    )
);
} 
```

**用户控制器**

```
class UsersController extends AppController {
public $components = array(

    'Auth' => array(
        'loginRedirect' => array('controller' => 'posts', 'action' => 'index'),
        'logoutRedirect' => array('controller' => 'users', 'action' => 'login'),
         'authorize' => array('Controller') // Added this line
    )
);

public function beforeFilter() {
    parent::beforeFilter();
    $this->Auth->allow('add', 'logout', 'login');
    $this->Auth->deny('view');
}

public function login() {
    if ($this->request->is('post')) {
        if ($this->Auth->login()) {

            $this->redirect('http://domain.com/thankyou');
        } else {
            $this->Session->setFlash(__('Invalid username or password, try again'));
        }
    }
}

public function logout() {
    $this->redirect($this->Auth->logout());
}
} 
```

任何帮助都会很棒。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-19T19:11:09.667

我最终在我的 logout() 函数中使用了它

```
$this->Auth->logout();
$this->redirect(some url); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T21:18:21.463

您有注销页面的视图吗？您在注销后尝试显示的内容？可能发生的情况是用户已注销，但 Cake 无法显示注销页面，因为它是安全的，因此 Cake 重定向到登录页面。

如果您启用了安全性并且您希望向未登录的用户显示页面，则需要在其控制器中包含以下内容：

```
public function beforeFilter() {
    parent::beforeFilter();
    $this->Auth->allow('login','logout');
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-18T23:48:51.190

你检查了吗？

```
'Auth' => array(
    'loginRedirect' => array('controller' => 'posts', 'action' => 'index'),
    'logoutRedirect' => array('controller' => 'users', 'action' => 'login'),
) 
```

和

```
public function logout() {
    //$this->redirect($this->Auth->logout());
    //Change for :
    //I suppose that you have a logout.ctp view in your View/Pages
    $this->redirect(array('controller' => 'pages', 'action' => 'display', 'logout')
} 
```

然后在你的根

```
Router::connect('/logout', array('controller' => 'pages', 'action' => 'display', 'logout')); 
```

当然不要忘记

```
$this->Auth->allow('display' 
```

# javascript - 无法在 EditorTemplate 中获取元素

> ID：12462846
> 
> 赞同：0
> 
> 时间：2012-09-17T15:51:04.097
> 
> 标签：javascript, jquery, asp.net-mvc

以下 EditorTemplate 无法正常工作；

```
<%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl<SHP.Models.BusinessUnitSelected>" %>

<tr>
    <td><%: Model.BusinessUnit.BusinessUnitName %></td>
    <td><%: Html.CheckBoxFor(model => model.Selected, 
        new { onclick = "SaveSelection(" + Model.EmployeeId + ", " + Model.BusinessUnit.BusinessUnitId + ", " + Convert.ToInt32(Model.Selected) + ", " + this.ClientID + ")" }) %>
    </td>
</tr> 
```

我想获取复选框的 ID，而 this.ClientID 无法做到这一点。此 EditorTemplate 在表中形成行网格。当一个人点击复选框时，会执行 SaveSelection javascript；

```
 function SaveSelection(employeeId, businessUnitId, selectedFlag, elementId) {
        //var tempFlag = selectedFlag === "0";

        var element = document.getElementById(elementId);
        if (selectedFlag === null) {
            selectedFlag = true;
        } else {
            selectedFlag = !selectedFlag;
        }

        var url = '<%: Url.Action("AddBusinessUnitForEmployee", "DataService")%>';
        dataService.saveSelection(employeeId, businessUnitId, selectedFlag, elementId, SavedSetting, url);
    }

    SavedSetting = function(data) {
        $('#' + data.ElementId).after('<span class="error">' + data.Message + '</span>');
    }; 
```

我想要的是在服务器调用后在复选框旁边显示一条消息。那么我该怎么做呢？Upticks 将获得有关如何改进此代码的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:08:49.567

您可以使用 HTML5`data-*`属性：

```
<%@ Control 
    Language="C#" 
    Inherits="System.Web.Mvc.ViewUserControl<SHP.Models.BusinessUnitSelected>" 
%>

<tr>
    <td><%: Model.BusinessUnit.BusinessUnitName %></td>
    <td>
        <%= Html.CheckBoxFor(
            x => x.Selected,
            new { 
                data_url = Url.Action("AddBusinessUnitForEmployee", "DataService"),
                data_employeeId = Model.EmployeeId,
                data_businessUnitId = Model.BusinessUnit.BusinessUnitId
            }
       ) %>
    </td>
</tr> 
```

然后在一个单独的 javascript 文件中不显眼地订阅`.click()`这些复选框的事件，然后从`data-*`属性中获取所需的信息：

```
$(function() {
    $('tr input[type="checkbox"]').click(function() {
        var elementId = $(this).attr('id');
        var url = $(this).data('url');
        var employeeId = $(this).data('employeeId');
        var businessUnitId = $(this).data('businessUnitId');
        var selectedFlag = !$(this).is(':checked');

        dataService.saveSelection(
            employeeId, 
            businessUnitId, 
            selectedFlag, 
            elementId, 
            SavedSetting, 
            url
        );
    });
}); 
```

备注：我不完全记得 ASP.NET MVC 2 是否支持`data_`语法以便将其重写为`data-`生成标记中的语法。这在 ASP.NET MVC 3 及更高版本中得到明确支持。如果它对您不起作用，您可以使用不同的重载`RouteValueDictionary`：

```
<%= Html.CheckBoxFor(
    x => x.Selected,
    new RouteValueDictionary
    {
        { "data-url", Url.Action("AddBusinessUnitForEmployee", "DataService") },
        { "data-employeeId", Model.EmployeeId },
        { "data-businessUnitId", Model.BusinessUnit.BusinessUnitId }
    }
) %> 
```

# c# - Http 400 请求 .net

> ID：12462847
> 
> 赞同：0
> 
> 时间：2012-09-17T15:51:05.927
> 
> 标签：c#, .net, http

当我输入一个 url 来系统类似`http://localhost:2055/test/5*5*5.html`. 它抛出 http 400 请求。这是什么原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T15:55:59.417

尝试查看您的 Windows 事件查看器。由于路径中的字符无效，它很可能会引发错误。无效字符将是星号`*`。

如果您绝对需要，您可以在路径中允许无效字符，但不建议这样做，并且会变得非常棘手：

请参阅 Scott Hanselman 的帖子：

[http://www.hanselman.com/blog/ExperimentsInWackinessAllowingPercentsAnglebracketsAndOtherNaughtyThingsInTheASPNETIISRequestURL.aspx](http://www.hanselman.com/blog/ExperimentsInWackinessAllowingPercentsAnglebracketsAndOtherNaughtyThingsInTheASPNETIISRequestURL.aspx)

# c# - 如何在某个日期之前隐藏 div

> ID：12462852
> 
> 赞同：1
> 
> 时间：2012-09-17T15:51:21.780
> 
> 标签：c#, html, date

我有一个 div 需要隐藏到 10 月 12 日，然后从 10 月 13 日开始显示。该站点是用 C# .NET 构建的，因此我可以在 HTML 页面的代码隐藏中添加一个 if 语句。不确定这是否可行，或者我是否需要一个 jQuery 解决方案（我对此一无所知）。任何帮助，将不胜感激。

这是 HTML 中的代码：

```
<p style="bold">SHOW THROUGH 10/12!!!<p>
<p>Every day from now until Metastatic Breast Cancer Awareness Day (Oct. 13), a new video will be featured. Please check-in every day to hear a new story and come back on Oct. 13 to see the new, complete video wall.</p>

<div id="mbcRadioList">
    <p style="bold">BUILD BUT HIDE UNTIL 10/13!!!<p>
    <p><strong>Want to learn more?</strong> Select a video topic to better understand the varied experiences of people living with MBC and their family and friends.</p>
    <div class="checkBoxesColumn">
        <label><input name="videoWallRadio" type="radio" id="" value="" />View All</label>
        <label><input name="videoWallRadio" type="radio" id="" value="" checked />My MBC Journey</label>
        <label><input name="videoWallRadio" type="radio" id="" value="" />Challenges</label>
        <label><input name="videoWallRadio" type="radio" id="" value="" />Positive Outlooks &amp; Advice</label>
        <label><input name="videoWallRadio" type="radio" id="" value="" />Giving Thanks</label>
        <label><input name="videoWallRadio" type="radio" id="" value="" />Family / Friend Perspective</label>
    </div>
</div> 
```

`<div id="mbcRadioList">`如果有办法做到这一点，我在列表周围添加了一个句柄来控制代码隐藏。如果它是 jQuery 解决方案，我可以将其删除。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T16:14:52.120

按照其他人的建议做：

1) 将 div 设置为`runat="server"`

2) 将 div 设置为`visible="false"`

3) 在`Page_Load`您的代码隐藏中，添加一个`if`检查日期的语句，然后更改`visible`为`true`

aspx 标记：

```
<div id="mbcRadioList" runat="server" visible="false">
    <p style="bold">BUILD BUT HIDE UNTIL 10/13!!!<p>
    <p><strong>Want to learn more?</strong> Select a video topic to better understand the varied experiences of people living with MBC and their family and friends.</p>
    <div class="checkBoxesColumn">
        <label><input name="videoWallRadio" type="radio" id="" value="" />View All</label>
        <label><input name="videoWallRadio" type="radio" id="" value="" checked />My MBC Journey</label>
        <label><input name="videoWallRadio" type="radio" id="" value="" />Challenges</label>
        <label><input name="videoWallRadio" type="radio" id="" value="" />Positive Outlooks &amp; Advice</label>
        <label><input name="videoWallRadio" type="radio" id="" value="" />Giving Thanks</label>
        <label><input name="videoWallRadio" type="radio" id="" value="" />Family / Friend Perspective</label>
    </div>
</div> 
```

代码隐藏：

```
protected void Page_Load(object sender, EventArgs e)
    {
        // ..... your other code

                    if(DateTime.Now >= new DateTime(2012, 10, 13) ){
                          mbcRadioList.Visible = true;
                    }
    } 
```

正如其他人所建议的那样，如果需要，请确保考虑时区。

# android - AndEngine 增强现实缺少 .jar 文件 - Android 依赖项错误

> ID：12462853
> 
> 赞同：0
> 
> 时间：2012-09-17T15:51:23.023
> 
> 标签：android, andengine, augmented-reality

我的团队目前正在与 AndEngine GLES2 一起在 Android 中开发游戏。我们正在使用扩展 AndEngine 增强现实。我的问题是有这个错误，我找不到任何好的答案来修复它。所以这是错误：

```
The container 'Android Dependencies' references non existing library 'C:\Users\Asdfghjkl\workspace\nicolasgramlich-AndEngineAugmentedRealityExtension-8e9a644\bin\nicolasgramlich-andengineaugmentedrealityextension-8e9a644.jar' 
```

谁能帮我这个？请使其成为易于遵循的修复指南。谢谢你！实际上，我复制了增强现实的代码并将其粘贴到我自己命名的类中。

PS 我在这里使用 Eclipse IDE :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:01:13.020

您应该将其“内部”添加到项目中，而不是添加到路径的链接。只需转到安装库的位置，然后查找 jar。假设您使用 Eclipse 作为 IDE：

0º检查文件夹libs，你应该在那里添加那个jar，删除它。

1º 将 JAR 复制到您的 Android 项目中的文件夹“libs”中。

2º android 依赖将被更新，您可以在项目树的“Android Dependencies”中查看它

希望能帮助到你

# r - R-Project 中的条形图均值 /w SD

> ID：12462855
> 
> 赞同：-1
> 
> 时间：2012-09-17T15:51:34.723
> 
> 标签：r, boxplot, mean, standard-deviation

听起来很简单，但一些研究并没有提出一个优雅的解决方案：我有一个由分类变量（GROUP）和连续读出变量（血压）构成的数据框。如何制作一个简单的箱线图，显示每个组的平均值及其标准差？有多个组：A、B、C、D 如何在数据框中执行 ANOVA 事后分析。它如何与 Mann-Whitney-U-Test 一起使用？我可以在条形图中标记显着性水平吗？如何将此操作简化为多个连续变量（dia_bloodpressure、sys_bloodpressure、mean_bloodpressure）和 sink() 不同文件中的输出（按变量名称）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T17:40:40.693

经过一番研究，我想出了 agricolae 包。这个提供了多组比较。生成的对象可以通过管道传输到一个不错的绘图函数中，用于分组条形图 +/- SD 或 SEM。不幸的是，没有办法在图中的组之间使用显着性标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T16:42:23.960

在 R 中进行了更多编程之后，我偶然发现了另一个适合医学研究的好包：psych。考虑到上述问题，`describe()`获取`describeBy()`数据框的统计概览并按分组变量对其进行排序。该功能`error.bars.by()`是平均值 +/- SD 的高级绘图功能。该软件包提供了许多协变量分析功能，这些功能在心理学研究中很有用，但也可能有助于医学和营销研究。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-05T17:08:42.723

一个可能的代码片段：

```
library(psych)

x<-c(1,2,3,4,5,6,7,8,9,NA)
y<-c(2,3,NA,3,4,NA,2,3,NA,2)
group<-rep((factor(LETTERS[1:2])),5)
df<-data.frame(x,y,group)
df

by(df$x,df$group,summary)
by(df$x,df$group,mean)

sd(df$x) #result: NA
sd(df$x, na.rm=TRUE) #result: 2.738613

v = c("x", "y")#or
v = colnames(df)[1:2]
sapply(v, function(i) tapply(df[[i]], df$group, sd, na.rm=TRUE))

describeBy(df$x, df$group)

error.bars.by(df$x, df$group, bars=TRUE) 
```

# ruby-on-rails - 在 Rails 中为现有模型添加验证

> ID：12462858
> 
> 赞同：3
> 
> 时间：2012-09-17T15:52:03.203
> 
> 标签：ruby-on-rails, ruby

我想向 Rails 中的模型添加 :presence 和 :uniqueness 验证。我正在使用 MongoDB 和 Mongoid gem。

我有一个已经在使用的模型，并且在数据库中有现有记录。我想添加一个新的 :field ，然后为该字段添加 :presence 和 :uniqueness 的验证。

我知道默认情况下，任何现有记录都将简单地添加：字段，结果将为空，除非我指定：默认值。

我的问题是，由于我希望这个新的 :field 是唯一的，这是否会导致数据库中现有记录为空的错误？我会丢失这些记录还是 Rails 只是将验证应用于新记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:14:54.123

Rails/ *AciveRecord*不会忽略或删除您的旧记录...

验证的工作方式如下：它们仅在您尝试将内容写入数据库时​​使用/检查，例如，当您创建新记录或更新记录时。因此，在您的情况下，当您尝试更新旧记录而不添加新的必填字段时，您将收到验证错误。

我建议您在添加新字段时尝试清理数据库（意味着为新的必填字段的旧记录添加合理的默认值）。

# jquery - 带有 ASP.NET MVC 的 jQuery Mobile - UI 遵循执行 JavascriptResult 操作后的发布目标

> ID：12462859
> 
> 赞同：0
> 
> 时间：2012-09-17T15:52:02.320
> 
> 标签：jquery, asp.net-mvc-3, jquery-mobile

我正在为现有的 ASP.NET MVC 3 网站创建一个移动站点，并选择使用 jQuery mobile。到目前为止一切都很好，但是当我尝试将我的一个执行 Ajax 发布到返回 JavaScriptResult 的操作的视图中重用时，UI 最终会跟随发布 URL，而不仅仅是运行返回的 JavaScript。

由于这是一个重用操作，并且对于桌面站点，所有浏览器只执行 JavaScript 并按预期保留在页面上，我只能假设 jQuery mobile 中的某些东西会导致导致浏览器跟随 URL 的附加行为。

谁能告诉我什么，以及如何阻止浏览器跟踪帖子 URL？

```
@using (Ajax.BeginForm("DoSomething", "Controller", null, new AjaxOptions { LoadingElementId = "AjaxLoadGif" }))
{

    ... form elements etc

    <input id="btn" class="btn" type="submit" name="" value="Click Me"/>
} 
```

目标动作看起来像......

```
public JavaScriptResult DoSomething(SomeInfo info)
{

    return JavaScript('showValidationErrorHtml(); return false;');

} 
```

浏览器最终位于[http://site.com/Controller/DoSomething](http://site.com/Controller/DoSomething)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:51:26.813

您必须明确告诉 jQuery Mobile 不要劫持表单提交。您可以通过在标签上设置`data-ajax="false"`属性来做到这一点：`<form>`

```
<form data-ajax="false" ...>
    ...
</form> 
```

像这样设置表单意味着您必须自己处理表单的 AJAX 提交。我不熟悉 ASP.net MVC 3，但如果这还没有完成，那么这里是一个例子：

```
$(document).on('submit', '#my-form-id', function () {
    //handle form submission, most likely with $.ajax([OPTS]);
    return false;
}); 
```

# node.js - nodejs 和 expressjs

> ID：12462862
> 
> 赞同：1
> 
> 时间：2012-09-17T15:52:06.497
> 
> 标签：node.js, express

```
app.get('/', function(req, res) {
    res.set('Content-Type', 'text/html');
    res.send('Yo');
    setTimeout(function(){
        res.send("Yo");
    },1000);
}); 
```

看起来“发送”结束了请求。我怎样才能让这个写`Yo`在屏幕上，然后 1 秒后（我猜有点像长轮询）写另一个`Yo`来获得`YoYo`？除了发送还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:06:52.140

用于`res.write`分段生成输出，然后使用 完成响应`res.end`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T16:06:21.127

我认为您尝试做的事情是不可能的。发送响应后，客户端-服务器连接将关闭。

查看套接字（尤其是[socket.io](http://socket.io/)）以保持连接打开并在其上发送多条消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T16:07:02.360

node.js 的问题在于它依赖于***异步***“样式”。因此，如果您引入类似“等待”功能的东西，***您将失去异步执行方式的所有好处***。

我相信您可以通过以下方式实现与您想要的类似的东西：

1.  （*异步方式*）包括打印第二个“Yo”作为对第一个函数（或）的回调的函数
2.  （*经典的等待（同步）*）在呈现第二个“哟”之前引入一个“大”循环。

例如：

```
for(i=0; i < 100000000; i++) {
    //do something
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-18T17:10:27.373

如果您想将结果作为单个块发送，请尝试

```
app.get('/', function(req, res) {
    res.set('Content-Type', 'text/html');
    res.write('Yo');
    setTimeout(function(){
        res.end("Yo");
    },1000);
}); 
```

或类似的东西

```
app.get('/', function(req, res) {
    res.set('Content-Type', 'text/html');
    var str = 'yo';
    setTimeout(function(){
        res.end(str + 'yo');
    },1000);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T19:34:56.270

尝试使用 JQuery+JSON。发送响应，然后使用 JQuery 和 JSON 更新您需要的内容。

这是 expressjs 的一个很好的[教程](http://dreamerslab.com/blog/en/write-a-todo-list-with-express-and-mongodb/)，包括 DB 的东西（mongodb）。

# c# - 您如何实现 Any<> 以在数据库中查找某些内容（最好不区分大小写）？

> ID：12462863
> 
> 赞同：0
> 
> 时间：2012-09-17T15:52:06.687
> 
> 标签：c#, sql-server-2008, entity-framework

我在互联网上到处找。我发现人们使用 Entity 的框架与数据库进行通信。这个框架中有一个名为 Any<> 的函数，它模仿 Contains() SQL 方法。我试图实现 ANY<> 方法，但它不起作用。它不断给我转换类型错误。

所以我的问题是……实现 ANY<> 函数的正确方法是什么。希望有高手能尽快解答。提前致谢！

- 所以只是在某些情况下，我有这样的事情：

```
 public static List<PhotoAlbumDto> searchAlbumsFromDA(string inputName)
    {
        EzPrintsEntities db = new EzPrintsEntities();
        List<PhotoAlbum> albums = db.PhotoAlbums.ToList().Any(b => b.NAME == inputName);
    } 
```

第二个赞会给我一个：

错误 14 无法将类型 'bool' 隐式转换为 'System.Collections.Generic.List' C:\Users\cding\Documents\Visual Studio 2010\Projects\ConsoleApplication6\EZP.Album.Data\PhotoAlbumDA.cs 22 39 EZP.Album 。数据

我想我知道这给我一个错误的原因，但我不知道如何解决它。我只是想在数据库中搜索与某个名称匹配的任何 PhotoAlbum 对象。

编辑：新问题：您如何使用 Where<> 搜索与其部分匹配的内容？

例如：

用户想搜索：搞笑

然后我的搜索功能将返回任何包含“funny”一词的内容，例如funnygirls、funnydogs、funnypeople、funnybikes 等...

我实现了 Where<>，但我没有执行上述功能？有任何修复吗？或任何替代品？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T15:54:23.587

您需要使用 where 代替：

```
db.PhotoAlbums.Where(b => b.NAME == inputName) 
```

在调用其他方法之前也不要使用 ToList ，它将整个表移动到应用程序的内存中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:54:30.900

Any() 与实体框架无关。

Any() 是一种 LINQ 扩展方法，它试图告诉您是否存在 a) 集合中的任何对象或 b) 集合中符合条件的任何反对。

[http://msdn.microsoft.com/en-us/library/system.linq.enumerable.any.aspx](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.any.aspx)

您可能在“Where()”之后，而不是 Any()。Any 返回一个布尔值，Where() 将返回另一个满足您传入的条件的集合。

使用 Any 的正确方法是：

```
List<string> listOfCars = new List<string>() { "Yellow Car", "Blue Car", "Big Car" };
bool hasYellowCar = listOfCars.Any(c => c == "Yellow Car"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T15:54:48.713

> 我只是想在数据库中搜索与某个名称匹配的任何 PhotoAlbum 对象。

你为什么要使用任何？任何将返回一个布尔值，数据库中是否有任何与此匹配的内容？可以这样想：

任何：我列表中的任何内容与此匹配吗？

哪里：给我列表中与此匹配的任何内容。

我认为您实际上想要在哪里：

```
db.PhotoAlbums.Where(b => b.NAME == inputName).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-17T15:55:32.853

这应该工作

```
List<PhotoAlbum> albums = db.PhotoAlbums.Where(b => b.NAME == inputName).ToList(); 
```

# php - 为 PHP 应用程序创建子域

> ID：12462864
> 
> 赞同：0
> 
> 时间：2012-09-17T15:52:11.580
> 
> 标签：php, apache

我正在尝试使用以下场景来创建为注册用户提供自己的站点子域。我不想为每个用户添加 DNS 记录，但如果用户 jon 注册我希望他看到 jon.website.com 的 URL。[从我读过](https://stackoverflow.com/questions/183928/how-to-let-php-to-create-subdomain-automatically-for-each-user)的其他问题看来，这是可能的。

然而，我的实施和缺乏理解阻碍了我。这是我到目前为止所做的。

**为域添加了 DNS 通配符 A 记录**

*.website.com --> 网站前的 IP。12.2.3.4

**在 www.website.com/application/ 中的 .htaccess 文件中添加了以下代码**

```
<VirtualHost *:80>
  ServerName server.website.com
  ServerAlias *.website.com
  UseCanonicalName Off
</VirtualHost> 
```

**使用 PHP 查找子域**

```
preg_match('/([^.]+)\.example\.org/', $_SERVER['SERVER_NAME'], $matches);
if(isset($matches[1])) {
    $subdomain = $matches[1];
} 
```

我如何看待这项工作是，当用户注册时，会创建一个带有子域名的目录，如 www.website.com/application/subdomainName/ - 我可以处理这个问题 - 然后成功登录用户然后被定向到 www.website.com/application/jon/

我在这方面朝着正确的方向前进吗？如果是，那么我如何从我所在的地方到达我需要去的地方？这个比我的工资等级高很多！感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:01:42.360

你的起步步骤是正确的，方向是正确的。我不明白你为什么要创建目录。

您只需要确保您的网站适用于任何域。因此，请确保所有指向资源的 URL 和链接都使用绝对路径。

我猜你会想要为每个用户定制体验。因此，您需要针对每个注册用户存储一些元数据，以便他们的网站具有不同的外观和感觉。最简单的方法是将元数据存储在数据库中的子域中。只需查看您的网站正在运行的当前子域并加载相应的用户即可确定该网站的外观。

# c# - Image.Save 到相对路径不会保存在预期的位置

> ID：12462865
> 
> 赞同：0
> 
> 时间：2012-09-17T15:52:15.480
> 
> 标签：c#, image, file, path, filepath

文档没有解释传入“myFile_temp.jpg”等路径时的行为，但我认为它会保存应用程序目录，因为这是一个相对路径，相对于我们当前正在运行的应用程序。

我认为可以通过将当前应用程序目录添加到我的临时文件名来解决问题， `string appPath = Path.GetDirectoryName(Application.ExecutablePath);` 当然有很多方法可以做到，但这应该可以。

我的问题是我想知道为什么会发生这种情况，而不是只是在上面打一个补丁并将其寄回给用户。

代码是 WPF，使用 .NET 4.0 和 Visual Studio 2010 编译的 C# 项目，可在许多不同的机器上运行。大多数是 32 位 XP，而开发机器是 64 位 Windows 7。

**任何人都可以解释这种行为以及它发生的原因吗？**

* * *

**编辑**

这些文件有时会保存到用户从中选择要操作的文件的目录中。他们调整它们的大小，程序跟踪每个文件路径的大小百分比。当用户完成后，他们将单击完成，程序将遍历每个文件路径，创建一个副本，调整图像大小，然后在最后保存一个 _temp。

请注意，它并不总是这样做，并且当它这样做时，它不会对他们接触的所有文件都这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-02-13T19:05:06.857

它按预期工作。你只是没想到有效的行为。假设您的应用程序位于 c:/superapps/myapp.exe 中。你打开了命令行，你在`C:\`这意味着这是你当前的工作目录。

您仍然可以通过 ./superapps/myapp 运行您的应用程序，但您的工作目录仍然是`C:\`. 在这种情况下，这将是您的应用程序的工作目录，而不是您放置二进制文件的目录。

这就是为什么它可能没有权限或将数据保存在您意想不到的位置。您应该始终认为您的应用程序可以像 dir 之类的任何其他命令一样运行。它将在用户当前站立的地方（他当前的工作目录）而不是在它的二进制文件存储的地方工作

# windows - ftp命令“再见”后如何返回执行cmd命令？

> ID：12462868
> 
> 赞同：2
> 
> 时间：2012-09-17T15:52:51.067
> 
> 标签：windows, ftp, cmd

我有 .bat 文件。看起来像下一个

```
....many commands1
ftp -i -s:copy.txt
...many commands2 
```

copy.txt 包含下一个命令

```
open ...
login
password
get file
bye 
```

当我执行我的 .bat 文件时，它接下来会起作用

```
many commands1
ftp commands 
```

但是许多命令2仍然没有执行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-18T13:28:44.067

**听起来**您的一个`command2`命令可能正在调用（启动）批处理文件而不使用该`CALL`命令。（底部有两张流程图，解释了使用和不使用`CALL`的后果。）请参阅**使用和不使用的后果`CALL`。

* * *

如果我最初的预感不正确，您需要开始采取措施来调试您的批处理文件。

注释掉任何`@ECHO OFF`语句并将一些`PAUSE`甚至`ECHO`语句放入您的批处理文件中。这将帮助您找到错误。`CALL`另外，请记住，如果您希望代码执行批处理文件，则需要使用该命令，然后在执行`CALL`完`CALL`ed 批处理文件后继续执行 ing 批处理文件。另外，请注意，如果您`CALL`的任何批处理文件包含`ECHO OFF`语句，即使在控制权返回到ing 文件后，该语句`ECHO OFF`也会继续执行。`CALL`例如：

```
:: For debugging porpuses we leave `ECHO` in it's default `ON` state
REM @echo off

:: Execute your leading commands:
commands1

:: If you prefer, because you know that your problem comes after this point;
:: You can, if you want, leave the leading `ECHO OFF` command alone, and
:: instead, put an `ECHO ON` statement here:
echo on

ftp -i -s:copy.txt
ECHO Back from FTPing...
pause

:: Calling command2.1.exe
command2.1.exe
echo Back from command2.1.exe
pause

:: Calling command2.2.bat
CALL command2.2.bat

:: Since Command2.2.bat contains an ECHO OFF statement
:: we'll turn `ECHO` back on again for debugging purposes.
ECHO ON

echo Back from command2.2.bat
pause 
```

* * *

## 使用和不使用的后果`CALL`。

假设这两个批处理文件：

`RUN.BAT`

```
@ECHO OFF
ECHO Starting: RUN.BAT
(Misc commands)

:: 'Calling' SECOND.BAT without useing `CALL`
SECOND.BATCH

:: Back from SECOND.BAT
ECHO Back from second.bat 
```

`SECOND.BAT`

```
@echo off
ECHO Running: SECOND.BAT 
```

没有语句的执行流程`CALL`将像这样移动：

```
C:\> RUN.BAT<kbd>ENTER</kbd>
      |
     \|/
      v
@echo off
echo Running
(misc commands)
      |
     \|/
      v
SECOND.BAT   ---->   @echo off
                     echo Running Seond.bat
                     (misc commands)
                      |
                     \|/
                      v
                     END 
```

但是如果你将文件中`SECOND.BAT`的 line更改为，则执行流程将如下所示：`RUN.BAT``CALL SECOND.BAT`

```
C:\> RUN.BAT<kbd>ENTER</kbd>
      |
     \|/
      v
@echo off
echo Running
(misc commands)
      |
     \|/
      v
SECOND.BAT   ---->   @echo off
                     echo Running Seond.bat
                     (misc commands)
                            |
                           \|/
                            v
:: Back from SECOND.BAT  <--+
      |
     \|/
      v
ECHO Back from second.bat
      |
     \|/
      v
     END 
```

# django - forloop 为无序列表生成输出

> ID：12462872
> 
> 赞同：0
> 
> 时间：2012-09-17T15:53:14.267
> 
> 标签：django, django-templates

我正在尝试为我的 css 选项卡界面生成一个无序列表。我几乎采用了给我的示例并插入了适当的行来生成代码，但是选项卡标题只创建一次。我期望使用 forloop 有 4 个选项卡标题，如果我使用标准表，它会起作用。

这就是输出最终的样子：http: [//imgur.com/a/WVRXX](http://imgur.com/a/WVRXX)

预期的输出如下所示：http: [//imgur.com/8xptd](http://imgur.com/8xptd)

这是生成的 HTML 输出：http: [//pastebin.com/jLf1cvYM](http://pastebin.com/jLf1cvYM)

如何让 forloop 生成我的预期结果？我在这里不知所措。

```
<div class="standard-tabs">
{% for vdev in pool.vdevs.all %}
{% for disk in vdev.disks.all %}

        <!-- Tabs Headings -->  
        <ul class="tabs">
        {% if forloop.first %}
                <li><a href="#{{ vdev.name }}">{{ vdev.name }}</a></li>
        {% else %}
        {% endif %}
        </ul>

        <!-- Tab Content -->
        <div class="tabs-content">
                <div id="#{{ vdev.name }}" class="with-padding">
                        {{ disk.serial }}
                </div>

{% endfor %}
{% endfor %}
</div> 
```

这是我一直在研究的例子：

```
<!-- Wrapper, set tabs style class here -->
<div class="standard-tabs">

    <!-- Tabs -->
    <ul class="tabs">
        <li class="active"><a href="#tab-1">Selected tab</a></li>
        <li><a href="#tab-2">Another tab</a></li>
        <li><a href="#tab-3">Another tab</a></li>
        <li class="disabled"><a href="#tab-4">Disabled tab</a></li>
        <li>Non-active</li>
    </ul>

<!-- Content -->
<div class="tabs-content">

    <div id="tab-1" class="with-padding">

        Selected tab

    </div>

    <div id="tab-2" class="with-padding">

        Alternate tab

    </div>

    <div id="tab-4" class="with-padding">

        Disabled tab

    </div>

    </div>

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:21:39.233

这只是肮脏的修复..它可能不起作用，但我可以看到你有一个错误。下面更正的模板：

```
<!-- language-all: lang-html -->
<div class="standard-tabs">
        <!-- Tabs Headings -->  
        <ul class="tabs">
{% for vdev in pool.vdevs.all %}
        {% if forloop.first %}
                <li class="active"><a href="#{{ vdev.name }}">{{ vdev.name }}</a></li>
        {% else %}
                <li><a href="#{{ vdev.name }}">{{ vdev.name }}</a></li>
        {% endif %}
{% endfor %}
        </ul>

        <!-- Tab Content -->
        <div class="tabs-content">
            {% for vdev in pool.vdevs.all %}
                <div id="#{{ vdev.name }}" class="with-padding">
                    {% for disk in vdev.disks.all %}
                        {{ disk.serial }} <br />
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
</div> 
```

# c# - c# 是否可以在需要接口时提供 lambda？

> ID：12462879
> 
> 赞同：18
> 
> 时间：2012-09-17T15:53:22.107
> 
> 标签：c#, interface, lambda

在某个类方法 A 中，我需要调用一个库方法 B，它以 an`IProgress<Object>`作为参数。

通常，我可能会`IProgress<Object>`作为 A 所在类的一部分实现，然后将“this”传递给方法 B。或者我可能会创建一个新类，其唯一目的是`IProgress<Object>`正确实现和处理它——那么在这种情况下，我d 创建该类的实例并将其传递给 B。

但我真正想要的是让我的实现`IProgress<Object>`出现在我调用 B 的方法中，这样调用代码和`IProgress<Object>`实现之间的视觉断开就会减少。（我认为我的 IProgress 实现是调用方法的一种私有的、非共享的细节，因此我不希望我的实现`IProgress<Object>`在一个完全独立的方法中，可能是另一个类）。

我一直在尝试做的是使用一个 lambda，我将在其中定义我的短进度处理，然后以某种方式将此 lambda 传递给 B，如下所示：

```
method in class A {
...
Action<Object> Report = (m) => { // do something useful with m };

B(Report)
}

method B(IProgress<Object> reporter) {
   reporter.Report(some object)
} 
```

当然，我知道为什么这不能按原样工作 - B 想要一个实现的对象，`IProgress<Object>`而我将它交给一个 Action 对象。

有什么方法可以实现我想要实现的目标吗？`IProgress<Object>`（如果出现在方法 A 中，IE 有我的实现吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-17T16:01:42.313

代表不能（直接）实现接口。

想到两个不错的选择：

1.  更改您要调用的方法的定义以采用委托类型而不是`IProgress`类型。（如果可能；这将是更可取的选择）

2.  创建一个实现所需接口的新类型，并将委托作为参数来实现该功能。

#2 的示例虽然依赖于接口，但可能看起来像这样：

```
interface IProgress<T>
{
    void doStuff(T param);
}

class LambdaProgress<T> : IProgress<T>
{
    Action<T> action;
    public LambdaProgress(Action<T> action)
    {
        this.action = action;
    }

    public void doStuff(T param)
    {
        action(param);
    }
} 
```

那么您就可以执行以下操作：

```
B(new LambdaProgress<Object>(obj => ...)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T16:27:58.043

不，当需要接口时，您不能提供 lambda。[但是您可以使用impromptu-interface](https://github.com/ekonbenefits/impromptu-interface)
提供匿名对象。

此示例来自其项目页面：

```
//Anonymous Class
var anon = new
{
    Prop1 = "Test",
    Prop2 = 42L,
    Prop3 = Guid.NewGuid(),
    Meth1 = Return<bool>.Arguments<int>(it => it > 5)
}

var myInterface = anon.ActLike<IMyInterface>(); 
```

在您的示例中，这可以是：

```
A
{
    // Create an anonymous object.
    var anonymous = new
    {
        // Define a method that needs an "object" parameter and returns nothing.
        Report = Return.Arguments<object>(m =>
        {
            // Do whatever you want to do when Report is called.
        })
    }

    // Get your anonymous object as an IProgress<Object>.
    var obj = anonymous.ActLike<IProgress<Object>>

    // Call B.
    B(obj);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T16:00:21.373

假设您的`IProgress<object>`接口只有一个`void Report(object)`方法，并且您控制 API，您可以简单地重新定义当前需要类型参数的方法，`IProgress<object>`而不是需要新的委托类型：

```
public delegate void ProgressReportDelegate(object someObject); 
```

然后您的示例可以更改为：

```
method in class A {
...
Action<Object> Report = (m) => { // do something useful with m };

B(Report)
}

method B(ProgressReportDelegate reporter) {
   reporter(someObject);
} 
```

对于更复杂的接口，或者您不控制 API（因此无法更改方法以获取委托而不是在实现该接口的对象上），这不是一个真正的选择，但它似乎可以工作在你的情况下。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-12-22T20:56:43.987

我相信何塞是这里唯一有效的答案，并帮助我解决了同样的问题。

从问题迈克尔想要调用方法“B”但使用 lambda 而不是实现 IProgress 接口：

```
method B(IProgress<Object> reporter) {
   reporter.Report(some object)
} 
```

要在不创建需要实现 IProgress 接口的新类的情况下执行此操作，可以使用[Progress类，因为它已经实现了 IProgress 接口。](https://docs.microsoft.com/en-us/dotnet/api/system.progress-1?redirectedfrom=MSDN&view=net-6.0)只需创建一个看起来像这样的 lambda 并将其传递到您的方法中：

```
var reporter = new Progress<int>((x) => 
{
   // call your own methods that use the reported value here
   MyProgressMethod.SetProgress(x);
}); 
```

现在您可以按照上面的问题在您的方法中使用它：

```
B(reporter); 
```

或者，如果您想在一行中执行此操作：

```
B(new Progress<int>((x) => { progress.SetProgress(action, x); })); 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2016-06-22T10:08:35.607

使用 .NET 4.5，您可以使用[Progress](https://msdn.microsoft.com/en-us/library/hh193692(v=vs.110).aspx)类

例子：

```
var reporter = new Progress<Object>((m) => {
  // do something useful with m
});

B(reporter); 
```

# php - Magento：如何获得缩略图？

> ID：12462880
> 
> 赞同：1
> 
> 时间：2012-09-17T15:53:28.457
> 
> 标签：php, magento, csv, datafeed

我下载了一个脚本来创建我的产品的 CSV 数据馈送，并且我还想在缩略图中包含一个 url。该代码已经具有产品图片网址的以下内容：

`$product_data['ImageURL']=Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_MEDIA).'catalog/product'.$product->getImage();`

所以我试图将其调整为：

`$product_data['ThumbnailURL']=Mage::getBaseUrl(Mage_Core_Model_Store::URL_TYPE_MEDIA).'catalog/product'.$product->getThumbnail();`

它显示完全相同的图像网址（不是拇指）。我将如何解决这个问题？

我做了一个`var_dump($product);`，结果是：

`["image"]=> string(18) "/f/i/file_2_18.png" ["small_image"]=> string(18) "/f/i/file_2_18.png" ["thumbnail"]=> string(18) "/f/i/file_2_18.png"`

我还需要获取产品的子类别，但我不知道如何调用它。如何查看哪些变量是可能的？例如`$product->getPrice`或`$product->getName`？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-17T16:04:34.763

我最近也需要这样做......这就是我的方法：

```
$_product->getMediaGalleryImages()->getItemByColumnValue('label', 'LABEL_NAME')->getUrl(); 
```

**或者另一个例子**

为此，您应该使用目录产品媒体配置模型。

```
<?php

//your code ...

echo Mage::getModel('catalog/product_media_config')
            ->getMediaUrl( $product->getImage() ); //getSmallImage(), getThumbnail() 
```

**在您发表评论后编辑。**

**更新答案**

**见以下网址**

[让所有商店图像成为 Magento 中的基本图像、小图像和缩略图图像？](https://stackoverflow.com/questions/4349592/make-all-store-images-the-base-small-and-thumbnail-images-in-magento)

**试试看**

```
$products = Mage::getModel('catalog/product')->getCollection()->addAttributeToSelect('*');
foreach ($products as $product) {
    if (!$product->hasImage()) continue;
    if (!$product->hasSmallImage()) $product->setSmallImage($product->getImage());
    if (!$product->hasThumbnail()) $product->setThumbnail($product->getImage());
    $product->save();
} 
```

希望对你有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T08:52:38.137

如果您想查看可以访问哪些数据，可以尝试以下操作：

```
<?php var_dump(array_keys($product->getData())); ?> 
```

然后，您可以使用两种方法来获取此数据：

```
<?php $product->getAttributeName() // Use CamcelCase ?> 
```

或者

```
<?php $product->getData('attribute_name') // underscores ?> 
```

# sql - 如何访问插入到 Rails 应用程序中的数据？（初学者）

> ID：12462887
> 
> 赞同：0
> 
> 时间：2012-09-17T15:53:51.437
> 
> 标签：sql, ruby-on-rails, postgresql, pg

有人可以帮我在谷歌上搜索如何访问插入到 Rails 应用程序中的数据的教程。

```
group :development do
  gem 'sqlite3'
end
group :production do
  gem 'pg'
end 
```

我知道这是存储它的地方，只是找不到一个好的分步教程。谢谢，大黄蜂

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:14:20.623

这取决于“访问”对您意味着什么，而您忘记提及您的操作系统。

对于检查您创建的行之类的事情，您可以按照此处的建议使用 rails 控制台：

[如何访问默认的 Rails sqlite db？](https://stackoverflow.com/questions/10171673/how-to-access-default-rails-sqlite-db)

如果您想查看数据库表，您也可以尝试查看这里

[如何在 Windows 7 上查看 PostgreSQL 数据库？](https://stackoverflow.com/questions/3284824/how-to-view-postgresql-database-on-windows-7)

这建议 pgAdmin 用于 Postgresql

如果您想访问 sqlite 数据库，您可以尝试

SQLite 浏览器 [http://sourceforge.net/projects/sqlitebrowser/](http://sourceforge.net/projects/sqlitebrowser/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T16:12:34.337

我建议您查看[railscasts.com](http://railscasts.com)，因为有很多 Rails 初学者指南。

# r - 在r中重新编码数据

> ID：12462888
> 
> 赞同：5
> 
> 时间：2012-09-17T15:53:54.580
> 
> 标签：r, dataframe, data.table

我有一个巨大的 1000 x 100000 数据框，如下所示，可以重新编码为数字值。

```
myd <- data.frame (v1 = sample (c("AA", "AB", "BB", NA), 10, replace = T),
                   v2 = sample (c("CC", "CG", "GG", NA), 10, replace = T),
                   v3 = sample (c("AA", "AT", "TT", NA) , 10, replace = T),
                   v4 = sample (c("AA", "AT", "TT", NA) , 10, replace = T),
                   v5 = sample (c("CC", "CA", "AA", NA) , 10, replace = T)
                   )
myd
     v1   v2   v3   v4   v5
1    AB   CC <NA> <NA>   AA
2    AB   CG   TT   TT   AA
3    AA   GG   AT   AT   CA
4  <NA> <NA> <NA>   AT <NA>
5    AA <NA>   AA <NA>   CA
6    BB <NA>   TT   TT   CC
7    AA   GG   AA   AT   CA
8  <NA>   GG <NA>   AT   CA
9    AA <NA>   AT <NA>   CC
10   AA   GG   TT   AA   CC 
```

每个变量可能有四个唯一值。

```
unique(myd$v1)

[1] AB   AA   <NA> BB  
Levels: AA AB BB

unique(myd$v2)

[1] CC   CG   GG   <NA>
  Levels: CC CG GG 
```

这样的唯一值可以是任何组合，但是由两个字母组成（- NA 除外）。例如，“A”、“B”在第一种情况下将组合成“AA”、“AB”、“BB”。这些的数字代码分别为 1、0、-1。类似地，对于第二种情况，字母“C”、“G”组成“CC”、“CG”、“GG”，因此数字代码分别为 1、0、-1。因此，上面的 myd 需要重新编码为：

```
 myd
         v1   v2   v3    v4      v5
    1    0   1     <NA>  <NA>    1
    2    0   0     -1    -1      1
    3    1   -1     0    0       0
    4  <NA>  <NA>  <NA>   0     <NA>
    5    1  <NA>    1  < NA>      0
    6   -1  <NA>    -1    -1      -1
    7    1   -1    1      0        0
    8  <NA>   -1   <NA>   0        0
    9    1  <NA>    0    <NA>     -1
    10   1   -1    -1     1       -1 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T23:53:59.253

我将发布一个不同的解决方案——（跳至`data.table`超快方法！）

如果你想重新编码`AA, AB, BB`，`1,0,-1`等等，你可以使用索引（以及数字解决方案的因子）。如果您愿意，这将使您有不同的重新编码！

# 自制重新编码功能

```
simple_recode <- function(.x, new_codes){
  new_codes[as.numeric(.x)]
 }

as.data.frame(lapply( myd, simple_recode, new_codes = 1:-1)) 
```

# 利用`factor`

`factor`您可以通过调用新级别来简单地重新标记字母`labels`

```
as.data.frame(lapply(myd, factor, labels = 1:-1)) 
```

# `data.table`为了效率

如果您的数据很大，那么我建议采用`data.table`一种节省内存和时间的方法。

```
library(data.table)
DT <- as.data.table(myd)
as.data.table(DT[,lapply(.SD, simple_recode, new_codes = 1:-1))]) 
```

或者，更高效

```
as.data.table(DT[, lapply(.SD, setattr, 'levels', 1:-1)]) 
```

或者，**甚至更有效**（修改适当的级别，并避免 as.data.table 调用）

```
 for(name in names(DT)){
    setattr(DT[[name]],'levels',1:-1)
     } 
```

`setattr`通过引用修改，所以没有复制。

# 使用 data.table 和 setattr 的几乎瞬时方法

正如这个*大*数据集所展示的

```
# some big data (100 columns, 1e6 rows)
big  <- replicate(100, factor(sample(c('AA','AB','BB', NA), 1e6, T)), simplify = F)
bigDT <- as.data.table(big)

system.time({
  for(name in names(big)){
    setattr(big[[name]],'levels',1:-1)
     }
  }))

##  user  system elapsed 
##    0        0       0 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-17T16:06:01.657

您可以利用您的数据是因子的事实，这些因子下面有数字索引。

例如：

```
> as.numeric(myd$v1)
 [1]  2  2  1 NA  1  3  1 NA  1  1 
```

数值对应于`levels()`因子的：

```
> levels(myd$v1)
[1] "AA" "AB" "BB" 
```

所以 1 == `AA`, 2 == `AB`, 3 == `BB`...等等。

因此，您可以简单地将数据转换为数字，并应用必要的数学运算来让您的数据按您想要的方式缩放。所以我们可以减去 2，然后乘以 -1 得到你的结果：

```
(sapply(myd, as.numeric) - 2) * -1
#-----
      v1 v2 v3 v4 v5
 [1,]  0  1 NA NA  1
 [2,]  0  0 -1 -1  1
 [3,]  1 -1  0  0  0
 [4,] NA NA NA  0 NA
 [5,]  1 NA  1 NA  0
 [6,] -1 NA -1 -1 -1
 [7,]  1 -1  1  0  0
 [8,] NA -1 NA  0  0
 [9,]  1 NA  0 NA -1
[10,]  1 -1 -1  1 -1 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-18T00:21:33.303

If you set up an assignment so the LHS has the proper structure, you can use the implicitly coerced values of the factors as indices into the values you want:

```
> myd[] <- c(-1,0,1)[data.matrix(myd)]
> myd
   v1 v2 v3 v4 v5
1  NA  0  0  0  1
2  -1  1  0  0 -1
3   0 NA  1  0  0
4  NA -1 -1  0 -1
5  -1  0  1 -1 NA
6   0 NA  0  1 NA
7  NA  0  1 NA -1
8   0  0  0 -1  1
9  -1 NA  1 -1 NA
10  0  1  1 NA NA 
```

# amazon-ec2 - 连接到 AWS 上的 Windows Server 服务总线

> ID：12462894
> 
> 赞同：3
> 
> 时间：2012-09-17T15:54:27.550
> 
> 标签：amazon-ec2, amazon-web-services, servicebus, azureservicebus

我正在使用新的 Windows Server Service Bus 1.0 Beta 开始一个新项目的工作。我正在尝试在 AWS EC2 虚拟机上设置测试环境。

我已经在 AWS EC2 上运行的 Windows Server 2008 R2 实例上安装了服务总线，并根据 MSDN 文档中的示例设置了新的农场、容器和主机。我在服务器上打开了所有正确的端口（4443 和 9354）。我还按照 [this page][1] 中的说明将自行生成的证书导出到我的客户端计算机上。

我有一个非常简单的 C# 程序，它创建一个队列、对消息进行排队并接收它。当我将可执行文件复制到 VM 并在那里运行时，该程序运行良好，因此我相信我正确使用了 API。但是，当我从指向 AWS 服务器的本地开发框运行程序时，我会遇到安全异常。

我的代码如下所示：

```
var servername = "X.X.X.X"; // <-- An IP Address, not FQDN
var sbNamespace = "MyNamespace";
var httpPort = 4446;
var tcpPort = 9354;

//create SB uris
var rootAddressManagement = ServiceBusEnvironment.CreatePathBasedServiceUri("sb", sbNamespace, string.Format("{0}:{1}", servername, httpPort));
var rootAddressRuntime = ServiceBusEnvironment.CreatePathBasedServiceUri("sb", sbNamespace, string.Format("{0}:{1}", servername, tcpPort));

var tokenProvider = TokenProvider.CreateWindowsTokenProvider(new List<Uri>() { rootAddressManagement });
var namespaceManager = new NamespaceManager(rootAddressManagement, 
    new NamespaceManagerSettings()
    {
        TokenProvider = tokenProvider
    });
var factory = MessagingFactory.Create(rootAddressRuntime,
    new MessagingFactorySettings()
    {
        TokenProvider = tokenProvider,
        //OperationTimeout = TimeSpan.FromMinutes(30)
    });

if (!namespaceManager.QueueExists("OrderQueue")) <-- EXCEPTION OCCURRS HERE
{
    // Code to create a queue that is never reached.
} 
```

我的异常跟踪如下所示：

```
[Microsoft.ServiceBus.Messaging.ServiceBusResourceOperations+GetAsyncResult`1[[Microsoft.ServiceBus.Messaging.QueueDescription, Microsoft.ServiceBus, Version=1.6.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35]]] IteratorAsyncResult failed to move to the next step due to an exception; System.UnauthorizedAccessException: The token provider was unable to provide a security token while accessing 'https://107.23.15.5:4446/APIHealthcare/$STS/Windows/'. Token provider returned message: 'The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel.'. ---> System.IdentityModel.Tokens.SecurityTokenException: The token provider was unable to provide a security token while accessing 'https://107.23.15.5:4446/APIHealthcare/$STS/Windows/'. Token provider returned message: 'The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel.'. ---> System.Net.WebException: The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel. ---> System.Security.Authentication.AuthenticationException: The remote certificate is invalid according to the validation procedure.
   at System.Net.Security.SslState.StartSendAuthResetSignal(ProtocolToken message, AsyncProtocolRequest asyncRequest, Exception exception)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ForceAuthentication(Boolean receiveFirst, Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessAuthentication(LazyAsyncResult lazyResult)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Net.TlsStream.ProcessAuthentication(LazyAsyncResult result)
   at System.Net.TlsStream.Write(Byte[] buffer, Int32 offset, Int32 size)
   at System.Net.PooledStream.Write(Byte[] buffer, Int32 offset, Int32 size)
   at System.Net.ConnectStream.WriteHeaders(Boolean async)
   --- End of inner exception stack trace ---
   at System.Net.HttpWebRequest.GetRequestStream(TransportContext& context)
   at System.Net.HttpWebRequest.GetRequestStream()
   at Microsoft.ServiceBus.TokenProviderHelper.GetWindowsAccessTokenCore(IEnumerator`1 stsUris, Func`2 uriBuilder, String requestToken, TimeSpan timeout, DateTime& expiresIn)
   --- End of inner exception stack trace ---
   at Microsoft.ServiceBus.TokenProviderHelper.ThrowException(Uri requestUri, WebException exception)
   at Microsoft.ServiceBus.TokenProviderHelper.GetWindowsAccessTokenCore(IEnumerator`1 stsUris, Func`2 uriBuilder, String requestToken, TimeSpan timeout, DateTime& expiresIn)
   at Microsoft.ServiceBus.WindowsTokenProvider.OnBeginGetWebToken(String appliesTo, String action, TimeSpan timeout, AsyncCallback callback, Object state)
   at Microsoft.ServiceBus.TokenProvider.GetWebTokenAsyncResult..ctor(TokenProvider tokenProvider, String appliesTo, String action, Boolean bypassCache, TimeSpan timeout, AsyncCallback callback, Object state)
   at Microsoft.ServiceBus.TokenProvider.BeginGetWebToken(String appliesTo, String action, Boolean bypassCache, TimeSpan timeout, AsyncCallback callback, Object state)
   at Microsoft.ServiceBus.TokenProviderUtility.GetMessagingWebToken(ITokenProvider tokenProvider, String appliesTo, String action, Boolean bypassCache, TimeSpan timeout)
   --- End of inner exception stack trace ---
   at Microsoft.ServiceBus.TokenProviderUtility.GetMessagingWebToken(ITokenProvider tokenProvider, String appliesTo, String action, Boolean bypassCache, TimeSpan timeout)
   at Microsoft.ServiceBus.Messaging.HttpWebRequestExtensions.AddAuthorizationHeader(HttpWebRequest request, ITokenProvider tokenProvider, Uri baseAddress, String action)
   at Microsoft.ServiceBus.Messaging.ServiceBusResourceOperations.GetAsyncResult`1.<GetAsyncSteps>d__c.MoveNext()
   at Microsoft.ServiceBus.Messaging.IteratorAsyncResult`1.MoveNextStep()
A first chance exception of type 'System.UnauthorizedAccessException' occurred in Microsoft.ServiceBus.dll
System.UnauthorizedAccessException: The token provider was unable to provide a security token while accessing 'https://107.23.15.5:4446/APIHealthcare/$STS/Windows/'. Token provider returned message: 'The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel.'. ---> System.IdentityModel.Tokens.SecurityTokenException: The token provider was unable to provide a security token while accessing 'https://107.23.15.5:4446/APIHealthcare/$STS/Windows/'. Token provider returned message: 'The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel.'. ---> System.Net.WebException: The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel. ---> System.Security.Authentication.AuthenticationException: The remote certificate is invalid according to the validation procedure.
   at System.Net.Security.SslState.StartSendAuthResetSignal(ProtocolToken message, AsyncProtocolRequest asyncRequest, Exception exception)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessReceivedBlob(Byte[] buffer, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartReceiveBlob(Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.StartSendBlob(Byte[] incoming, Int32 count, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ForceAuthentication(Boolean receiveFirst, Byte[] buffer, AsyncProtocolRequest asyncRequest)
   at System.Net.Security.SslState.ProcessAuthentication(LazyAsyncResult lazyResult)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean preserveSyncCtx)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Net.TlsStream.ProcessAuthentication(LazyAsyncResult result)
   at System.Net.TlsStream.Write(Byte[] buffer, Int32 offset, Int32 size)
   at System.Net.PooledStream.Write(Byte[] buffer, Int32 offset, Int32 size)
   at System.Net.ConnectStream.WriteHeaders(Boolean async)
   --- End of inner exception stack trace ---
   at System.Net.HttpWebRequest.GetRequestStream(TransportContext& context)
   at System.Net.HttpWebRequest.GetRequestStream()
   at Microsoft.ServiceBus.TokenProviderHelper.GetWindowsAccessTokenCore(IEnumerator`1 stsUris, Func`2 uriBuilder, String requestToken, TimeSpan timeout, DateTime& expiresIn)
   --- End of inner exception stack trace ---
   at Microsoft.ServiceBus.TokenProviderHelper.ThrowException(Uri requestUri, WebException exception)
   at Microsoft.ServiceBus.TokenProviderHelper.GetWindowsAccessTokenCore(IEnumerator`1 stsUris, Func`2 uriBuilder, String requestToken, TimeSpan timeout, DateTime& expiresIn)
   at Microsoft.ServiceBus.WindowsTokenProvider.OnBeginGetWebToken(String appliesTo, String action, TimeSpan timeout, AsyncCallback callback, Object state)
   at Microsoft.ServiceBus.TokenProvider.GetWebTokenAsyncResult..ctor(TokenProvider tokenProvider, String appliesTo, String action, Boolean bypassCache, TimeSpan timeout, AsyncCallback callback, Object state)
   at Microsoft.ServiceBus.TokenProvider.BeginGetWebToken(String appliesTo, String action, Boolean bypassCache, TimeSpan timeout, AsyncCallback callback, Object state)
   at Microsoft.ServiceBus.TokenProviderUtility.GetMessagingWebToken(ITokenProvider tokenProvider, String appliesTo, String action, Boolean bypassCache, TimeSpan timeout)
   --- End of inner exception stack trace ---

Server stack trace: 
   at Microsoft.ServiceBus.TokenProviderUtility.GetMessagingWebToken(ITokenProvider tokenProvider, String appliesTo, String action, Boolean bypassCache, TimeSpan timeout)
   at Microsoft.ServiceBus.Messaging.HttpWebRequestExtensions.AddAuthorizationHeader(HttpWebRequest request, ITokenProvider tokenProvider, Uri baseAddress, String action)
   at Microsoft.ServiceBus.Messaging.ServiceBusResourceOperations.GetAsyncResult`1.<GetAsyncSteps>d__c.MoveNext()
   at Microsoft.ServiceBus.Messaging.IteratorAsyncResult`1.MoveNextStep()
   at Microsoft.ServiceBus.Messaging.IteratorAsyncResult`1.EnumerateSteps(CurrentThreadType state)
   at Microsoft.ServiceBus.Messaging.IteratorAsyncResult`1.Start()

Exception rethrown at [0]: 
   at Microsoft.ServiceBus.Common.AsyncResult.End[TAsyncResult](IAsyncResult result)
   at Microsoft.ServiceBus.Messaging.IteratorAsyncResult`1.End(IAsyncResult asyncResult)
   at Microsoft.ServiceBus.Messaging.ServiceBusResourceOperations.EndGet[TEntityDescription](IAsyncResult asyncResult)
   at Microsoft.ServiceBus.NamespaceManager.OnEndQueueExists(IAsyncResult result)
   at Microsoft.ServiceBus.NamespaceManager.EndQueueExists(IAsyncResult result)
   at Microsoft.ServiceBus.NamespaceManager.QueueExists(String path)
   at ServiceBusSandbox.ServiceBusSampleApp.CreateAQueue(NamespaceManager namespaceManager) in c:\Users\cent049\Documents\Visual Studio 2012\Projects\ServiceBusSandbox\ServiceBusSandbox\ServiceBusSampleApp.cs:line 15
   at ServiceBusSandbox.ServiceBusSampleApp.Main(String[] args) in c:\Users\cent049\DocumentThe thread 'vshost.RunParkingWindow' (0x2608) has exited with code 0 (0x0). 
```

我有一种预感，问题是我使用虚拟机的 IP 地址而不是 FQDN 进行连接，但是我不知道如何确认，也不知道如何为我的 AWS 服务器获取域名。服务器有一个机器名称，但只是在工作组“WORKGROUP”上，而不是在域上。

任何和所有的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-18T16:33:38.087

使用 CreateOAuthTokenProvider 而不是 CreateWindowsTokenProvider。

1.  首先，您需要在机器中创建一个帐户：rootAddressManagement。
2.  将新创建的帐户添加为命名空间的管理用户。Set-SBNamespace -Name "YourNamespace" -Manage YourUser
3.  由于您使用的是 IP 地址，因此请在调用 SB 之前添加证书验证代码。ServicePointManager.ServerCertificateValidationCallback = new RemoteCertificateValidationCallback((s, cert, chain, ssl) => {return true; });
4.  三、使用 TokenProvider.CreateOAuthTokenProvider(new List() { rootAddressManagement }, new NetworkCredential("YouUser", "YouPassword"));

注意：不要将机器名称指定为 YourUser 的一部分

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-17T22:56:00.300

我得到了坏消息和好消息。坏消息是无法使用 microsoft.servicebus.dll 方法发送消息。对我来说，我无法使用 microsoft windows.servicebus.dll 连接 Windows 服务总线。当我尝试发送消息时，我卡在了 sendmessage 操作上，无法继续进行。我怀疑问题是 [通过代理后面的 http 发布到 Azure 服务总线，](https://stackoverflow.com/questions/12281570/publish-to-azure-service-bus-over-http-behind-proxy) 这是当前版本中的一个错误。

好消息是我设法使用 rest api 完成所有服务总线操作。

首先是使用 microsft 提供的以下代码示例获取身份验证令牌。

[http://msdn.microsoft.com/en-us/library/windowsazure/jj193003%28v=azure.10%29.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/jj193003%28v=azure.10%29.aspx)

一旦您获得令牌，其余操作（创建队列、发送消息、接收消息）与 Windows azure 服务总线相同。请参阅有关服务总线操作的 microsoft 文档的详细信息。

[http://msdn.microsoft.com/en-us/library/windowsazure/hh690927.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh690927.aspx) 希望这有帮助。谢谢。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-18T16:36:22.127

是的，你的预感是正确的。您遇到了该问题，因为服务器使用的证书颁发给机器的 FQDN，并且使用 IP 将导致证书名称不匹配。

短期内，您可以通过使用 CertificateValidation 回调忽略错误来解决此问题：http: [//msdn.microsoft.com/en-us/library/system.net.servicepointmanager.servercertificatevalidationcallback.aspx](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.servercertificatevalidationcallback.aspx)

从长远来看，您可能想要检查如何获取 VM 的外部名称，并使用与之匹配的证书。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-15T23:23:03.560

我陷入了同样的错误。我按照第二篇文章中描述的步骤进行操作。但最终以“这让我更进一步。我的应用程序确实连接并创建了队列，但在尝试将消息放入队列时失败了。我现在收到的消息是：System.IdentityModel.Tokens。 SecurityTokenValidationException: X.509 证书 CN= **MACHINE_NAME**不在受信任的人员存储中。X.509 证书 CN= **MACHINE_NAME**链构建失败。使用的证书具有无法验证的信任链。更换证书或更改certificateValidationMode。吊销功能无法检查证书的吊销。

# php - 在多个 PHP 文件中连接 MySQL 的最有效方式

> ID：12462895
> 
> 赞同：0
> 
> 时间：2012-09-17T15:54:28.643
> 
> 标签：php, mysql

我有通过 mySQL 查询动态添加内容的页面。这些页面大部分都使用 php 文件包含，因此我的页眉、导航、正文和页脚位于单独的文件中。我的 MySQL 连接代码也在一个单独的文件中。目前我正在连接到我的数据库、查询内容、回显内容并关闭每个文件中的数据库。

我的问题是：是否有任何理由支持或反对在每个文件（页眉、导航、正文和页脚）中包含我的连接脚本和打开和关闭数据库，因为它们都是同一页面的一部分？还是我所有连接到数据库的 PHP 代码都应该在同一个文件中？

我是自学成才的，这种理论从未在我从中学到的任何资料中得到真正的解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:00:24.157

两个特定[的最佳实践](http://docforge.com/wiki/Best_practices)适用：

*   将您的数据库连接抽象到一个公共类或一组函数。这将让您稍后更改实施细节，并帮助您追踪问题。例如，如果您想在应用程序级别开始记录所有查询，您可以将其添加到您的一个数据库类中。更重要的是，这将使您始终如一地捕获数据库错误。
*   不要在多个地方复制代码。仅在一处管理相同的逻辑。例如，您的数据库连接逻辑应该只实现一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T16:00:24.500

> 还是我所有连接到数据库的 PHP 代码都应该在同一个文件中？

这是你应该瞄准的。在每个文件中打开和关闭数据库连接违反了[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)原则。

# php - 无法从本地主机使用 PHP ftp_connect 连接到 FTP

> ID：12462898
> 
> 赞同：6
> 
> 时间：2012-09-17T15:54:39.460
> 
> 标签：php, apache, ftp, centos

我一直在尝试制作一些脚本来通过 FTP 从我在 CentOS 中的本地 Apache 下载文件，但我无法让它工作！

我正在使用的代码是任何基本 ftp 请求所使用的代码：

```
<?php
$ip= FTP_IP_HERE;
$port='21';
$timeout='90';
$un='username';
$pw='password';

// Connect to ftp
$conn_id = ftp_connect($ip,$port,$timeout);

// Open a session to an external ftp site
$login_result = ftp_login ($conn_id, $un, $pw);

// Check open
if ((!$conn_id) || (!$login_result)) {
    print "FTP connection failed!";
    exit();
}

// turn on passive mode transfers
if (ftp_pasv($conn_id, true) == FALSE) {
    print "Passive FTP connection failed!";
    exit();
} 
```

我在远程服务器上尝试了相同的脚本，它成功了！我不确定是要完成任何 apache 配置，还是 PHP 限制本身。

**更新**：

这是错误日志：

```
Warning: ftp_login() expects parameter 1 to be resource, boolean given in /var/www/html/ftp/FTP.php on line 16

Warning: ftp_get() expects parameter 1 to be resource, boolean given in /var/www/html/ftp/FTP.php on line 22
Falha ao enviar o arquivo test.pdf<br />Array
(
    [type] => 2
    [message] => ftp_get() expects parameter 1 to be resource, boolean given
    [file] => /var/www/html/ftp/FTP.php
    [line] => 22
)

Warning: ftp_close() expects parameter 1 to be resource, boolean given in /var/www/html/ftp/FTP.php on line 30 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-04-24T15:26:34.397

好的，我遇到了同样的问题，我找到了适合我的案例的解决方案。在这里发布以帮助他人。

我的 PHP 脚本会失败，但我可以通过命令行轻松 FTP。我确认我的防火墙没有阻止脚本，并且我的日志中没有出现任何 PHP 错误...

四处搜索后，我的问题似乎是`SELinux`. 我不想关闭它，所以我检查了`httpd_can_network_connect`.

通过运行检查您的状态：

```
getsebool httpd_can_network_connect 
```

如果你得到：

```
httpd_can_network_connect --> off 
```

这可能是你的问题。

**笔记：**

如果你已经有了这个`on`：

```
httpd_can_network_connect --> on 
```

或者

```
SELinux is disabled 
```

那么这不会解决你的问题......祝你找到你的解决方案好运。

**修复**

`httpd_can_network_connect`通过运行启用：

```
setsebool httpd_can_network_connect=1 
```

再次测试您的脚本，看看它是否有效。这对我有用，所以我确保设置一个政策来保持这个启用。

```
setsebool -P httpd_can_network_connect=1 
```

注意：`-P`设置策略，使其在重新启动后仍然存在

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-17T16:04:32.640

首先确保这不是您的本地防火墙或其他东西的问题。尝试从任何其他工具进行 FTP，例如

```
wget --user=username --password='password' ftp://FTP_IP_HERE/file_to_download 
```

如果 wget 也无法连接，则说明您的网络设置有问题。

如果 wget 通过测试，您还可以尝试启用详细错误报告，通过将其放在代码顶部来查看您的 PHP 尝试有什么问题：

```
<?php
ini_set('display_errors',1);
error_reporting(E_ALL|E_STRICT); 
```

最后，这可能也与您的情况有关：[Cannot connect with FTP server with PHP , ftp_connect()](https://stackoverflow.com/questions/6536435/cannot-connect-with-ftp-server-with-php-ftp-connect)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-18T21:48:06.270

尝试“127.0.0.1”而不是“localhost”

```
ftp_connect('127.0.0.1', 21); 
```

# php - 表格每一行上的 PHP 按钮

> ID：12462899
> 
> 赞同：1
> 
> 时间：2012-09-17T15:54:43.057
> 
> 标签：php, mysql, html

我在 PHP 中制作了一些申请表。

我将从数据库返回的所有信息放入一个表中。

现在我想在每一行上创建一个按钮，以更改该行的数据库中的某些内容。

但我不知道这样做：S

谢谢！

```
echo "<table border='1'>
<tr>
<th>Id</th>
<th>Name</th>
<th>Email</th>
<th>age</th>
<th>position</th>
<th>experience</th>
<th>motivation</th>
<th>date</th>
<th>status</th>
<th>test</th>
</tr>";

while($row = mysql_fetch_array($result))
    {
        echo "<tr>";
    echo "<td>" . $row['id'] . "</td>";
    echo "<td>" . $row['name'] . "</td>";
    echo "<td>" . $row['email'] . "</td>";
    echo "<td>" . $row['age'] . "</td>";
    echo "<td>" . $row['position'] . "</td>";
    echo "<td>" . $row['exp'] . "</td>";
    echo "<td>" . $row['motivation'] . "</td>";
    echo "<td>" . $row['date'] . "</td>";
    echo "<td>" . $row['status'] . "</td>";
    echo "<td>" . '<input type="submit" name="submit" value="accept">' . "</td>";
    echo "</tr>";

}
    echo "</table>"; 
```

编辑：使用另一个脚本让它工作：

```
echo "<td><a href=\"edit.php?id=".$row['id']."&status=app\">Approve</a></td>"; 
```

和edit.php：

```
<?php
include("dbconnect.php");
$member_id = $_GET['id'];
$status = $_GET['status'];
echo $member_id;
echo $status;
if ($status == 'app')
    $query = "update apps set status = 'approved' where id = $member_id";
mysql_query($query) or die (mysql_error());  
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:24:07.807

在您希望按钮执行某项操作的单元格中创建带有参数的小表单。这是最简单的方法（刷新方法）。

另一种解决方案是在按钮单击并将操作转发到某个端点时使用 AJAX。这样，它将是动态的，并且可能是您想要实现的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-15T11:59:32.127

```
echo "<table border='1'>
<tr>
<th>Id</th>
<th>Name</th>
<th>Email</th>
<th>age</th>
<th>position</th>
<th>experience</th>
<th>motivation</th>
<th>date</th>
<th>status</th>
<th>test</th>
</tr>";

while($row = mysql_fetch_array($result))
    {
        echo "<tr>";
    echo "<td>" . $row['id'] . "</td>";
    echo "<td>" . $row['name'] . "</td>";
    echo "<td>" . $row['email'] . "</td>";
    echo "<td>" . $row['age'] . "</td>";
    echo "<td>" . $row['position'] . "</td>";
    echo "<td>" . $row['exp'] . "</td>";
    echo "<td>" . $row['motivation'] . "</td>";
    echo "<td>" . $row['date'] . "</td>";
    echo "<td>" . $row['status'] . "</td>";
    echo "<td>" . '<form type="POST"><input type="hidden" name="whatever" value="$row['id']"><input type="submit" name="submit_btn" value="accept"></form>' . "</td>";
    echo "</tr>";

}
    echo "</table>"; 
```

这样，您可以在表格的每一行中获得一个表格。现在，您只需要使用 php POST 功能。

```
if(isset($_POST['submit_btn']))
{
//whatever u need to do
} 
```

# c# - 使用反射识别类的泛型

> ID：12462900
> 
> 赞同：0
> 
> 时间：2012-09-17T15:54:45.173
> 
> 标签：c#, reflection

有什么方法可以检测类的泛型参数中指定的类型？

例如，我有以下三个类：

```
public class Customer
{ }

public class Repository<T>
{ }

public class CustomerRepository : Repository<Customer>
{ }

public class Program
{
    public void Example()
    {
        var types = Assembly.GetAssembly(typeof(Repository<>)).GetTypes();
        //types contains Repository, and CustomerRepository
        //for CustomerRepository, I want to extract the generic (in this case, Customer)
    }
} 
```

对于每个带回的存储库对象，我希望能够知道指定了什么类型。
那可能吗？

编辑

感谢@CuongLe，得到了这个工作，但看起来很乱......（也来自 resharper 的帮助；））

```
var types = Assembly.GetAssembly(typeof(Repository<>))
 .GetTypes()
 .Where(x => x.BaseType != null && x.BaseType.GetGenericArguments().FirstOrDefault() != null)
 .Select(x => x.BaseType != null ? x.BaseType.GetGenericArguments().FirstOrDefault() : null)
 .ToList(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:36:29.283

假设您现在通过从类型列表中选择来持有`CustomerRepository`类型：

```
var customerType = typeof(CustomerRepository).BaseType
                          .GetGenericArguments().First(); 
```

**编辑：**您不需要100%*信任*Re-Sharper。既然`Where`选择了所有不是的类型，`BaseType`就`null`不用再签入了`Select`。更多，`FirstOrDefault`实际上是 return `null`，这段代码被优化了：

```
 Assembly.GetAssembly(typeof(Repository<>))
                  .GetTypes()
                  .Where(x => x.BaseType != null)
                  .Select(x => x.BaseType.GetGenericArguments().FirstOrDefault())
                  .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T15:58:02.977

尝试使用[`GetGenericArguments`](http://msdn.microsoft.com/en-us/library/system.type.getgenericarguments.aspx).

# jquery - 测试某个 div 是否存在于另一个中

> ID：12462903
> 
> 赞同：1
> 
> 时间：2012-09-17T15:54:51.850
> 
> 标签：jquery

这可能很容易，但我遇到了问题，

如何测试 div comWF 是否在 comW 中至少出现一次？

例如：

```
<div class="comW">
   <div class="comWF"></div>
</div> 
```

如果我做：

```
if($(".comWF").length>=1)) doSomething; 
```

它不是特别在每个 comW 中对墙体进行测试。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T15:57:06.847

jQuery 为这个任务提供了一个专用的静态方法 - [`$.contains()`](http://api.jquery.com/jQuery.contains/)：

```
if ( $.contains( divW, divWF ) ) {
    // do your thing
} 
```

其中`divW`和`divWF`是对这些 DIV 的 DOM 引用。

**现场演示：http:** [//jsfiddle.net/8SadD/](http://jsfiddle.net/8SadD/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-17T15:55:57.703

尝试这个，

```
if($('.comW .comWF').length > 0)
{
   //comWF is present in comW
} 
```

应 OP 的要求更新所有满足标准的 html 部分。

```
$('.comW .comWF').each(function(){

    var comWFobj = $(this);
    var comWobj = $(this).closest('.comW');

    alert(comWFobj.attr('class'));
    alert(comWobj.attr('class'));

}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-17T15:56:08.823

```
var present = $('.comW .comWF').length > 0 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-17T16:04:43.717

```
$('.comW').each(function(){
 var hasElem = $('.comWF', this).length;
 if( hasElem ){
    // do something
 }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-17T15:57:51.577

你也可以试试这个

```
if ($('.comW').find('.comWF').length > 0){
// Put your code here
} 
```

谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-17T16:03:03.720

## *[jsBin 演示](http://jsbin.com/ovilip/6/edit)*

```
if($('.comW').find('.comWF').length){
   // found!
} 
```

或更好：

```
$('.comW').each(function(){
  var $myChild = $(this).find('.comWF');
  if($myChild.length){
     // DO SOMETHING
  }
}); 
```

# php - Zend Framework .htaccess 重写规则

> ID：12462906
> 
> 赞同：0
> 
> 时间：2012-09-17T15:55:04.600
> 
> 标签：php, apache, .htaccess, zend-framework

我看到了一个 .htaccess 文件，其内容如下

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d

RewriteRule ^.*$ - [NC,L]
RewriteRule ^.*$ /index.php [NC,L] 
```

据我了解，重写条件表明，如果请求的 url 用于大小非零的文件、符号链接或目录，则什么也不做。这是通过 , 完成的 `RewriteRule ^.*$ - [NC,L]`，意味着如果上述条件为真，则立即停止处理；否则调用`/index.php`并使用`RewriteRule ^.*$ /index.php [NC,L]`.

我的疑问是，

1.In the tutorial ( [Survive the deep end](http://survivethedeepend.com/zendframeworkbook/en/1.0/a.not.so.simple.hello.world.tutorial#zfbook.a.not.so.simple.hello.world.tutorial.introduction) ) 我正在阅读，说：

> 即如果 URL 引用文件（大小大于零）、目录或符号链接。这确保您的 javascript、css 和其他非 PHP 文件可以直接提供服务，即使集中在其他地方并且仅由符号链接引用。

由于所有 .php 文件都是非零大小，那么 apache 怎么知道 php 文件和非 php 文件之间的区别？

2.请求的 url 将作为参数传递给 /index.php 还是只调用 /index.php ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:02:45.810

检查请求的文件/目录/符号链接是否存在的是 REQUEST_FILENAME 条件。回答您的问题：

> 由于所有 .php 文件都是非零大小，那么 apache 怎么知道 php 文件和非 php 文件之间的区别？

Apache 不需要知道其中的区别。无论文件类型如何，应用程序公用文件夹中的任何文件都按原样提供。所有 Zend Framework 文件和您的应用程序代码都存在于公用文件夹之外。

> 请求的 url 将作为参数传递给 /index.php 还是只调用 /index.php ？

请求的 URL 仍将存在于环境变量中，例如`$_SERVER['REQUEST_URI']`，因此 ZF（和大多数框架）使用它来确定应用程序的哪个部分应该为请求提供服务。

# android - Android 多按钮点击

> ID：12462910
> 
> 赞同：-2
> 
> 时间：2012-09-17T15:55:21.297
> 
> 标签：android, button

Android 多按钮点击

我有一个按钮，我想在按钮的第一次单击时显示一个东西，然后在第二个按钮上显示另一个等等。

我有一个按钮，希望它有 11 次点击 .. 第一次点击`Num.settext("First");` 第二次点击`Num.settext("Second");` 等 .. 直到第十次点击 .. 然后在第 11 次点击它`Num.settext("0");`并从开始重置..

喜欢 ..

```
1,2,3,4,5,6,7,8,9,10,11(0) 1,2,3,4,5,6,7,8,9,10,11(0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:00:31.267

如果将点击次数存储在变量中会不会更容易？

例如：

```
 //...
    int clickNumber = 0;
    //...

    public void onClick() {

       if(clickNumber > 10) {//reset variable
         clickNumber = 0;
       }           

       if(clickNumber == 0) {
         Num.setText("First");
         clickNumber++;
       }
       else if(clickNumber == 1) {
         Num.setText("Second");
         clickNumber++;
       }
       //...

    }
//... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:59:59.860

维护一个称为循环的字段和一个文本数组。

然后点击：

```
Num.setText(texts[cycle]);
cycle=(cycle + 1)%texts.length; 
```

# c# - 如何导出 c# dll 函数以便能够从另一个应用程序访问它们

> ID：12462911
> 
> 赞同：0
> 
> 时间：2012-09-17T15:55:22.310
> 
> 标签：c#

我想知道如何导出 dll 函数，因为我有一个程序需要函数导出才能使用它们。

我可以在 c# 中完成这个吗？

PS：使用该dll的程序不是O.Source，我无法将引用添加到其中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-14T06:56:47.843

可能，最接近您要求的选项是使用[Unmanaged Exports](https://sites.google.com/site/robertgiesecke/Home/uploads/unmanagedexports)。

有关其他选项，请参见[此处](https://stackoverflow.com/a/4818940/908336)和[此处](https://stackoverflow.com/a/6613770/908336)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T15:57:28.980

1 您可以使用`MEF Framework`- 基于`Export, Import`和`Catalog`

链接：http: [//msdn.microsoft.com/en-us/library/dd460648.aspx](http://msdn.microsoft.com/en-us/library/dd460648.aspx)。

2 您也可以通过使用在您的网络上公开 `WCF`

链接： http: [//msdn.microsoft.com/en-us/library/ms735119 (v=vs.90).aspx](http://msdn.microsoft.com/en-us/library/ms735119(v=vs.90).aspx)

注意：您还有另一种可能性，这取决于您的选择和技术限制

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-17T15:58:15.030

如果另一个应用程序是 .NET 应用程序，它可以添加对您的程序集 (DLL)的*引用*`public`，并使用程序集中定义的任何类型。这使它可以完全访问您的代码。

如果您需要与 C# 代码一起使用的本机 API，那么这将变得更加困难。有几个选项：

1.  使用 COM。您可以[将类型标记为 ComVisible](http://msdn.microsoft.com/en-us/library/ms182157%28v=vs.80%29.aspx)并注册程序集。这允许通过 COM 访问您的代码。
2.  使用 C++/CLI 围绕托管类型构建本机包装器。这将需要一个单独的程序集 (DLL) 来提供本机导出，并在内部使用托管类型。

这里的最佳选择实际上取决于“其他应用程序”需要如何访问您的代码。如果它不是 .NET 应用程序，COM 通常是最简单（通常也是最好的）选项。

# arrays - 具有交替递增和递减值的最长子序列

> ID：12462916
> 
> 赞同：4
> 
> 时间：2012-09-17T15:55:42.233
> 
> 标签：arrays, algorithm, language-agnostic, dynamic-programming

给定一个数组，我们需要找到具有交替递增和递减值的最长子序列的长度。

例如，如果数组是 ， `7 4 8 9 3 5 2 1`那么`L = 6`for`7,4,8,3,5,2`或`7,4,9,3,5,1`等。

也可能是首先我们有小元素然后大元素。

什么是最有效的解决方案？我想到了一个 DP 解决方案。如果我们要使用蛮力来做到这一点，我们会怎么做（O（n ^ 3）？）？

这不是作业问题。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-09-17T16:06:12.250

您确实可以在这里使用动态编程方法。为了简单起见，假设我们只需要找到这样的序列**seq**的最大长度（很容易调整解决方案来找到序列本身）。

对于每个索引，我们将存储 2 个值：

*   在最后一步增加的那个元素处结束的交替序列的最大长度（例如，**incr** [i]）
*   在最后一步减少的那个元素处结束的交替序列的最大长度（例如，**decr** [i]）

同样根据定义，我们假设`incr[0] = decr[0] = 1`

然后可以递归地找到每个 incr[i] ：

```
incr[i] = max(decr[j])+1, where j < i and seq[j] < seq[i]
decr[i] = max(incr[j])+1, where j < i and seq[j] > seq[i] 
```

所需的序列长度将是两个数组中的最大值，这种方法的复杂度是 O(N*N) 并且需要 2N 的额外内存（其中 N 是初始序列的长度）

c中的简单示例：

```
int seq[N]; // initial sequence
int incr[N], decr[N];

... // Init sequences, fill incr and decr with 1's as initial values

for (int i = 1; i < N; ++i){
    for (int j = 0; j < i; ++j){
         if (seq[j] < seq[i]) 
         {
             // handle "increasing" step - need to check previous "decreasing" value
             if (decr[j]+1 > incr[i])  incr[i] = decr[j] + 1;
         }
         if (seq[j] > seq[i]) 
         {
             if (incr[j]+1 > decr[i])  decr[i] = incr[j] + 1;
         }
    }
}

... // Now all arrays are filled, iterate over them and find maximum value 
```

算法将如何工作：

**第 0 步**（初始值）：

```
seq  = 7   4 8 9 3 5 2 1
incr = 1   1 1 1 1 1 1 1
decr = 1   1 1 1 1 1 1 1 
```

**第 1 步**在索引 1 ('4') 处取值并检查以前的值。7 > 4 所以我们使“从索引 0 到索引 1 的递减步长，新的序列值：

```
incr = 1 1   1 1 1 1 1 1
decr = 1 2   1 1 1 1 1 1 
```

**步骤 2.**取值 8 并迭代先前的值：

7 < 8，增加步长：incr[2] = MAX(incr[2], decr[0]+1):

```
incr = 1 1 2   1 1 1 1 1
decr = 1 2 1   1 1 1 1 1 
```

4 < 8，增加步长：incr[2] = MAX(incr[2], decr[1]+1)：

```
incr = 1 1 3   1 1 1 1 1
decr = 1 2 1   1 1 1 1 1 
```

ETC...

# c# - MVC3 项目中的目录

> ID：12462918
> 
> 赞同：2
> 
> 时间：2012-09-17T15:55:52.143
> 
> 标签：c#, asp.net-mvc-3, routing

我目前正在处理的 MVC3 站点有一个“工具”区域。我在需要在虚拟目录中运行的站点上集成的工具之一。在 /Tools 文件夹下设置虚拟目录对应用程序本身来说效果很好，但对于导航到 /Tools/，我得到“不允许目录列表”。如何告诉 IIS 让 MVC 路由处理此 URL？

我们将在生产中使用 IIS6，因此使用它很重要。

提前致谢。

**编辑**：为清楚起见，这是设置：

*   /工具/RoutedTool1
*   /工具/ToolInVirtualDirectory
*   /工具/RoutedTool2
*   /工具/

路由工具的路由工作正常，但由于我必须在根目录下创建一个目录来设置“ToolInVirtualDirectory”，IIS 正在劫持“/Tools/”请求并尝试将其发送到目录，忽略路由。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T17:05:22.217

您应该`routes.RouteExistingFiles = true`在 Global.asax.cs 中设置。

请记住，由于此属性在全局级别播放，因此在设置此属性之前，您必须忽略 css 文件和您不需要由路由基础结构处理的其他内容。有关更多想法，请参阅此[帖子](http://prideparrot.com/blog/archive/2012/6/authorizing_folders_using_routeexistingfiles)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T16:00:59.443

在 Global.asax 的 RegisterRoutes 部分中，添加路由系统忽略的忽略路由。配置中应该已经有 .axd 的示例。

# r - 使用 R 进行反卷积（decon 和 deamer 包）

> ID：12462919
> 
> 赞同：2
> 
> 时间：2012-09-17T15:55:52.467
> 
> 标签：r, distribution, fft, noise, convolution

我有一个形式的模型：y = x + 噪声。我知道“y”和噪声的分布，并希望得到“x”的分布。所以我尝试用 R 对分布进行去卷积。我发现了 2 个包（decon 和 deamer），我认为这两种方法应该或多或少相同，但我不明白为什么用 DeconPdf 去卷积会给我一个类似于正态分布的东西和用 deamerKE 去卷积给了我一个均匀的分布。这是一个示例代码：

```
library(fitdistrplus) # for rweibull
library(decon) # for DeconPdf
library(deamer) # for deamerKE

set.seed(12345)
y <- rweibull(10000, shape=5.780094, scale=0.00204918)
noise <- rnorm(10000, mean=0.002385342, sd=0.0004784688)
sdnoise <- sd(noise)

est <- deamerKE(y, noise.type="Gaussian", 
                mean(noise), sigma=sdnoise)
plot(est)

estDecon <- DeconPdf(y, sdnoise, error="normal", fft=TRUE)
plot(estDecon) 
```

* * *

**编辑**（回应[Julien Stirnemann](https://stackoverflow.com/a/12464936/1635321)）：

我不确定重新参数化。我的实际问题是：我有反应时间 (RT)，理论上可以描述为 f(RT) = g(辨别时间) + h(选择时间)，其中 f,g 和 h 可以是这些时间值的转换。我的数据集中有“RT”和“辨别时间”值。我对选择时间或 h（选择时间）感兴趣。通过核密度估计，我发现威布尔分布最适合 1/RT 值，而正态分布最适合 1/（判别时间）。这就是为什么我可以将我的问题写成 1/RT = 1/（鉴别时间）+ h（选择时间）或 y = x + 噪声（我认为噪声是 1/（鉴别时间））。模拟这些反应时间给了我以下具有以下参数的分布：

```
y <- rweibull(10000, shape=5.780094, scale=0.00204918)
noise <- rnorm(10000, mean=0.002385342, sd=0.0004784688) 
```

重新参数化是什么意思？使用不同的值，例如比例参数？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T18:14:58.147

你的帖子有几个问题。第一：在非参数反卷积问题中，您通常不“知道”“y”的分布。相反，您有一个假设用加性噪声观察到的“y”样本，“x”是未观察到的。不对“y”或“x”做任何假设，而只对“噪声”做任何假设。您的演示文稿似乎暗示您正在考虑一个参数问题（对于这个问题，deamer 或 decon 都没有任何帮助）。第二：小心，你正在考虑一个非中心的噪音...... deamer 可以处理但不能处理。这是一个代码示例：

```
library(decon) # for DeconPdf
library(deamer) # for deamerKE

set.seed(12345)
shape=5; scale=1; mu=0; sd=0.2

x <- rweibull(5000, shape=shape, scale=scale)
noise <- rnorm(5000, mean=mu, sd=sd)
y=x+noise
curve(dweibull(x,shape,scale),lwd=2, from = 0, to = 2)

est <- deamerKE(y, noise.type="Gaussian", mu=mu, sigma=sd, from=0, to=2)
lines(est)

estDecon <- DeconPdf(y, sd, error="normal", fft=TRUE)
lines(estDecon, lty=2)

legend('topright', lty=c(1,1,2), lwd=c(2,1,1), 
    legend=c("true", "deamerKE", "DeconPdf")) 
```

正如您从图中看到的那样，即使使用中心噪声（在我的示例中为 mu=0），使用 deamer 的估计效果更好：这是因为自适应估计。虽然你可能使用 decon 获得类似的结果，但是你必须使用包中提供的函数来调整带宽参数。关于您提供的参数，傅里叶变换非常“平坦”。这使得任何通用实现都很难选择适当的带宽参数（在 deamer 中自适应地或在 decon 中使用估计）。在 deconPdf 中使用带宽参数也无济于事，可能是因为数字限制。您的问题需要对 deamer 函数的代码进行一些微调，以允许探索更大的模型集合。这也将显着增加估计时间。您是否应该考虑以某种方式重新参数化您的问题？

最佳，朱利安·斯特内曼

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-18T15:54:31.443

作为对您上一条评论的回答：错误改变了观察值。我猜你希望去卷积的信号在 0 到 0.3 之间。这是一些使用deamer的代码：

```
library(actuar) # for rinvweibull
library(deamer)
set.seed(123)
RT <- rinvweibull(30000, shape=5.53861156, scale=488)/1000
RT <- RT[RT<1.5]
noise <- 1/rnorm(30000, mean=0.0023853421, sd=0.0004784688)/1000
noise <- noise[noise<1.5]

ST <- deamerSE(RT, errors=noise, from=0, to=0.3)
plot(ST) 
```

这就是使用非参数反卷积（无论实现、包等）所获得的结果。仅供参考，您的信噪比极低……您观察到的实际上几乎只是噪声。这会对您感兴趣的密度估计产生很大影响，尤其是在使用非参数方法时，就像大海捞针一样。您应该重新考虑估计密度，而不是尝试只获得少数感兴趣的数量......

祝你好运，朱利安·斯特内曼

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T22:44:53.540

在您的第二篇文章之后：我不确定我是否完全理解您的问题。但是，据我了解，有两种可能性：

1）不使用任何变换函数，选择时间=RT-判别时间。如果在数据集的每个个体上都观察到 RT 和辨别时间，则选择时间是确定性已知的——这与反卷积无关。

2）如果在一个独立同分布样本中观察到 RT，而在另一个**独立**样本中观察到选择时间，那么是的，唯一的出路是考虑去卷积密度估计。但是，尽管您使用拟合方法做出了一些参数假设，但您确实不知道 RT 或 DT 的密度。将 DT 视为噪声，您的问题是：RT = ST + 噪声，以及由您的判别时间样本给出的 iid 噪声辅助样本。您希望估计未观察到的 ST 的密度。在这种情况下，唯一可以执行反卷积的包是带有 deamerSE 功能的 deamer（据我所知）。如果我正确地陈述了您的问题，您应该查看手册中的示例。我还建议使用未经转换的原始数据（至少在第一次分析中）。一个例子：

```
deamerSE(RT, errors=DT) 
```

在这里，您的错误再次没有居中（它是积极的），因此您将不得不调整从和到，以解释错误产生的转变......这也在 deamer 手册的示例中。

最佳，朱利安·斯特内曼

# wordpress - 从 bash 重新生成 Wordpress 缩略图

> ID：12462923
> 
> 赞同：2
> 
> 时间：2012-09-17T15:56:04.273
> 
> 标签：wordpress, bash, thumbnails

更改设置 > 媒体 > 缩略图大小后，我有没有一种简单的方法可以重新生成图像缩略图？

我知道有这方面的插件，但我有超过 30k 的图像。即使是 ajax 也需要永远完成。

我在 VPS CentOS 上，所以我可以运行 iconv、ffmpegthumbs 等东西，所以我有办法从 bash 完成这项任务吗？

**更新 1。**

这是我为完成这项工作而编写的脚本。我需要在包含图像的文件夹中才能运行它。

```
#! /bin/bash
# Copyright Synvi Group (http://www.synvigroup.com)
# Custom script to generate wordpress thumbnails for smokingd
# Dependencies: Imagemagick, rename, coreutils
echo Checking if sgthumbs already exists...
rm -rf sgthumb &
wait
echo Checking if list file already exists...
rm -f  list &
wait
echo Generate list of files...
ls -1 --file-type | grep -v -e -[0-9][0-9][0-9]x[0-9][0-9][0-9] | grep -v -e -[0-9][0-9][0-9][0-9]x[0-9][0-9][0-9] | grep -v -e -[0-9][0-9][0-9]x[0-9][0-9][0-9][0-9] | grep -v -e -[0-9][0-9][0-9][0-9]x[0-9][0-9][0-9][0-9] | grep -v -e -[0-9][0-9][0-9]x[0-9][0-9] | grep -v -e -[0-9][0-9]x[0-9][0-9][0-9] | grep -v -e -[0-9][0-9]x[0-9][0-9] > list &
wait
echo Create sgthumb directory...
mkdir sgthumb &
wait
echo Copying files...
xargs -a list cp -t sgthumb/ &
wait
cd sgthumb
echo Generating thumbnails...
echo Processing jpg files..
mogrify -resize '610x200^' -gravity center -crop 610x200+0+0 +repage *.jpg &
wait
echo Processing png files..
mogrify -resize '610x200^' -gravity center -crop 610x200+0+0 +repage *.png &
wait
echo Appending the new size to filenames...
rename .jpg -610x200.jpg *.jpg &
wait
rename .png -610x200.png *.png &
wait
echo Fixing permissions...
chown smokingd:smokingd *
wait
chmod 777 *
wait
echo Moving thumbnails to main directory...
cp -p *.jpg ../
wait
cp -p *.png ../
wait
echo Cleaning up..
cd .. 
wait
rm -rf sgthumb
wait
rm list
wait
echo Done! 
```

其中 USER 是拥有文件的用户，PERMISSIONS 是文件的正确用户。

现在我需要更新数据库，以便旧帖子使用新的缩略图。旧帖子使用 150x150 的缩略图，并且使用的缩略图在其名称后附加了 -150x150。

**更新 2。**

以下查询运行良好：

```
UPDATE wp_postmeta SET meta_value = REPLACE (  
meta_value,  
'-150x150.jpg";s:5:"width";s:3:"150";s:6:"height";s:3:"150";}',  
'-610x200.jpg";s:5:"width";s:3:"610";s:6:"height";s:3:"200";}'); 
```

假设原始缩略图大小为 150x150，新大小为 610x200。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T17:41:56.453

看看imagemagick

它带有一个叫做转换的东西

转换 $path/$file -resize x150 -define jpeg:extent=28kb $output/$file

所以

```
sudo yum install imagemagick 
```

或者

```
sudo apt-get install imagemagick 
```

**步骤 1.** tar 包含所有备份图像的现有文件夹

```
tar -cvzf images-backup.tar.gz images 
```

**第2步**

```
mkdir /opt/image-test
cd /original/path/containing/images/
find . -type d -exec mkdir -p /opt/images/test/{} \; 
```

以上是在新的 image-test 文件夹中创建当前路径中存在的所有文件夹

```
#!/bin/bash

    path="/path/to/current-images"
    output="/opt/image-test/images"

       for files in `find $path -name \*.\* -print`
       do
        convert $path/$file -resize x150 -define jpeg:extent=28kb $output/$file
       done 
```

我没有对此进行测试，但是您将图像解压缩到 /opt/images 然后使用原始源来转换图像的原因是因为我假设图像也都在子文件夹中，这就是为什么解压缩会创建相同的目录结构和输出结果将用缩略图结果覆盖 /opt/images-backup/images 中的文件

您可能需要调整混乱，但应该可以正常工作

# sql - SQL server - 单个单元格的拆分和总和

> ID：12462926
> 
> 赞同：0
> 
> 时间：2012-09-17T15:56:08.867
> 
> 标签：sql, sql-server

我有一个 nvarchar(max) 类型的表格单元格，通常如下所示： A03 B32 Y660 P02

例如，一个字母后跟一个数字，用空格分隔。我想要做的是在 SQL 过程中得到所有这些数字的总和。在其他语言中相当简单的东西，但我对 SQL 相当陌生，而且在我看来，它似乎是一种相当笨拙的语言来处理字符串。Aaanyway，我想它会是这样的：

1）创建一个临时表并使用拆分函数填充它

2）剥离每个单元格的第一个字符

3）将数据转换为int

4) 更新目标 table.column 设置为所述临时表的总和。

所以我做到了这一点：

```
CREATE PROCEDURE [dbo].[SumCell] @delimited nvarchar(max), @row int
AS
BEGIN
declare @t table(data nvarchar(max))

declare @xml xml 
set @xml = N'<root><r>' + replace(@delimited,' ','</r><r>') + '</r></root>' 

insert into @t(data) 
select  
    r.value('.','varchar(5)') as item 
from @xml.nodes('//root/r') as records(r) 

UPDATE TargetTable
SET TargetCell = SUM(@t.data) WHERE id = @row
END 
```

显然，缺少第一个 char 剥离和转换为 int 部分，最重要的是，我收到“必须声明标量变量@t”错误...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:29:50.290

问题不是很清楚，因此假设您的文本位于单个单元格中，例如**A3 B32 Y660 P20**以下代码段可用于获取总和。

```
DECLARE @Cell NVARCHAR(400), @Sum INT, @CharIndex INT

SELECT @Cell = 'A3 B32 Y660 P20',@Sum=0

WHILE (LEN(LTRIM(@Cell))>0)
BEGIN
    SELECT @CharIndex =  CHARINDEX(' ',@Cell,0)

    SELECT @Sum = @Sum + 
       SUBSTRING(@Cell,2,CASE WHEN @CharIndex>2 THEN @CharIndex-2 ELSE LEN(@Cell)-1 END )

    SELECT @Cell = SUBSTRING(@Cell,@CharIndex+1,LEN(@Cell))

    IF NOT (@CharIndex >0) BREAK;
END
--@Sum has the total of cell numbers
SELECT @Sum 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T22:20:58.060

我假设您真的希望能够在分隔列表中找到值的总和，以完整选择表格。因此，我相信您问题中最复杂的部分是拆分值。我倾向于使用的方法需要一个数字表，所以我将从它开始：

```
--If you really want to use a temporary numbers table don't use this method!
create table #numbers(
  Number int identity(1,1) primary key
)
declare @counter int
set @counter = 1
while @counter<=10000
 begin
    insert into #numbers default values
    set @counter = @counter + 1
 end 
```

我还将创建一些测试数据

```
create table #data(
  id int identity(1,1),
  cell nvarchar(max)
)
insert into #data(cell) values('A03 B32 Y660 P02')
insert into #data(cell) values('Y72 A12 P220 B42') 
```

然后，我将拆分功能放入 CTE 以保持清洁：

```
;with split as (
    select d.id,
        [valOrder] = row_number() over(partition by d.cell order by n.Number),
        [fullVal] = substring(d.cell, n.Number, charindex(' ',d.cell+' ',n.Number) - n.Number),
        [char] = substring(d.cell, n.Number, 1),
        [numStr] = substring(d.cell, n.Number+1, charindex(' ',d.cell+' ',n.Number) - n.Number)
    from #data d
        join #numbers n on substring(' '+d.cell, n.Number, 1) = ' '
    where n.Number <= len(d.cell)+1
)
select id, sum(cast(numStr as int))
from split
group by id 
```

# css - HTML CSS 溢出不起作用

> ID：12462927
> 
> 赞同：0
> 
> 时间：2012-09-17T15:56:10.763
> 
> 标签：css, overflow

![在此处输入图片描述][1]我想在我的文字后面画一条水平线。

它没有隐藏从 div (#line) 出来的内容，而是根本不显示它。#line div 必须比`#textline`div 大，因为我不知道文本 div 的大小。

编辑：这是 Jfiddle [http://jsfiddle.net/wakary/8tTzz/2/](http://jsfiddle.net/wakary/8tTzz/2/)

放 #line {width: 100;} 看看我想要完成什么。

编辑：（我想要达到的，标题改变了）：

![](../Images/d0e3d23509dd5b9c73db80152f73755f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:25:34.050

删除容器元素的宽度是可行的。

[**演示**](http://jsfiddle.net/8tTzz/4/)

**HTML**

```
<div id="textline">
    <div id="text">Text</div>
    <div id="line">
        <div id="upspace"></div>
        <div id="ll"></div>    
    </div>
</div> 
```

**CSS**

```
#textline
{
    height: 36px;
    margin-left: 20px;

}
#text
{
    float: left;
    color: green;
    height: 36px;
}
#line
{
    float: left;
    height: 36px;
    width: 400px;    
}
#upspace
{
    height: 10px;
}
#ll
{
    height: 1px;
    background-color: green;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T16:31:33.643

嗨，我对您的代码做了一些小改动

```
#textline{
position: relative;
width: 400px;
height: 36px;
margin-left: 20px;
overflow: hidden;
}
#text{
position: absolute;
color: green;
height: 36px;
background:white;
padding-right:10px;
}
#line{   
position: absolute;
height: 10px;
width: 80%;  
border-bottom: 1px solid green;
} 
```

像这样的HTML

```
<div id="textline">
    <div id="line"></div>
    <div id="text">Text</div>
</div> 
```

因此，在这种情况下，您将有一个 div 覆盖另一个，该行将覆盖它的所有容器，并且文本将隐藏该行的某些部分。

# django - 在 Django 查询中动态放置一个值

> ID：12462929
> 
> 赞同：0
> 
> 时间：2012-09-17T15:56:23.620
> 
> 标签：django

我有以下代码：

```
hotels = models.Hotel.objects.filter(
            wed=True,
            county=hotel_main.county.id,
            subscriptions__end_date__gte=datetime.date.today(),
            subscriptions__enquiry_count__lte=F('subscriptions__tier__enquiry_limit'),
        ).filter(Q(x=TRUE|Q(y=True)).distinct() 
```

我有一个清单`test = ['x','y','z','w']`

过滤器的值动态变化，所以我使用类似的东西：

```
filter(Q(test[0]=TRUE|Q(test[3]=True)) 
```

它动态变化，但是当我这样做时，出现以下错误：

```
Keyword can't be an expression 
```

我知道我不能在那里使用它，但让我知道如何实现这一点......谢谢！

### 编辑

我按照克里斯的建议做了：

```
test[1] = {x: True} 
```

在我的过滤器中，我做了如下

```
filter(Q(test[1])). 
```

它给了我以下错误：

```
need more than 1 value to unpack 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:03:38.553

使用字典设置键，然后将其扩展为 kwargs `**`，即：

```
Q(**{test[0]: True}) 
```

# database - 数据库默认列

> ID：12462931
> 
> 赞同：0
> 
> 时间：2012-09-17T15:56:29.853
> 
> 标签：database, default

只是一个关于数据库结构的快速问题。我必须管理多个角色，但只需要一个默认角色，即自动分配用户。

你将如何在数据库中存储这个默认的 tole？类似的东西？

```
ID     |   Name   | IsDefault
-----------------------------
1      |   Admin  | no
2      |   User   | yes 
```

如果是这样，您如何检查是否只有一个角色被标记为默认角色？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:09:16.070

例如，对于 Oracle，您可以检查`IsDefault`列上的约束，因此它可以只是`yes`or `no`。然后

`CREATE UNIQUE INDEX IDXU_TABLE1_ISDEFAULT ON table1(CASE WHEN IsDefault ='yes' THEN IsDefault ELSE NULL END);`

# html - 如何将内部标签定位在不同的位置？

> ID：12462932
> 
> 赞同：0
> 
> 时间：2012-09-17T15:56:29.487
> 
> 标签：html, css, menu

我之前问了一个更基本的问题（[如何将内部标签定位在不同的位置？](https://stackoverflow.com/questions/12458787/how-can-i-position-an-inner-tag-at-different-position)），它得到了完美的回答。但是我忘记了更深的子级别..基本问题是顶级项目在页面上的显示位置与子级项目不同..

所以结构现在看起来像这样：

```
<div id="menu">
    <div class="body-menu">
        <ul>
            <li class="current"><div class="body-menu">
                <a href="bla">Item1</a>
                <ul>
                    <li class="current"><div class="body-menu">
                        <a href="bla">Item 1.1</a>
                        <ul>
                            <li class=""><div class="body-menu">
                                <a href="bla">Item 1.1.1</a>
                            </div></li>
                            <li class="current deepest-menu"><div class="body-menu">
                                <a href="bla">Item 1.1.2</a>
                            </div></li>
                        </ul>
                    </div></li>
                    <li class=""><div class="body-menu">
                        <a href="bla">Item 1.2</a>
                    </div></li>
                </ul>
            </div></li>
            <li class=""><div class="body-menu">
                <a href="bla">Item 2</a>
            </div></li>
        </ul>
    </div>
    <div class="menu-background"></div>
</div> 
```

我使用此代码解决了在左侧菜单中显示子级别并在其原始位置（顶部菜单）显示顶层的基本问题

```
.body-menu > ul > li {
 position:relative;
 padding-bottom: 1em;
}
.body-menu ul ul {
 position:absolute;
 left:10px;
 top:30px;
} 
```

但现在 1.1.1 级的项目显示在 1.1 级之上...

有一个简单的解决方案吗？

在任何情况下都感谢您的帮助！——克里斯勒

* * *

# 更新

css 东西 [http://jsfiddle.net/crisler/wZrVS/](http://jsfiddle.net/crisler/wZrVS/)（简单） [http://jsfiddle.net/crisler/pMTHX/1/](http://jsfiddle.net/crisler/pMTHX/1/)（更多项目..）有点拥挤，因为大部分来自大学 css文件..希望我得到了一切

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-18T07:19:07.797

请改用此 CSS：

```
.body-menu ul ul.second-level {
    position:absolute;
    left:10px;
    top:30px;
} 
```

并将一个`second-level`类添加到`ul`第一级项目之后立即嵌套的所有 s （即*Item 1*，*Item 2*，...）：

```
<a href="bla">Item1</a>
    <ul class="second-class"> 
```

问题是您将该 CSS 规则应用于代码中的*所有*子列表。通过此更改，它只会影响第二级列表，其余的将正常运行。

这是结果：

![嵌套列表](../Images/aec73725847b2b2a88d38ba67a641c55.png)

这是编辑过的小提琴（有更多项目的）：http: [//jsfiddle.net/pMTHX/2/](http://jsfiddle.net/pMTHX/2/)

# android - 如何在没有 root 权限的情况下以编程方式截取其他应用程序的屏幕截图，例如 Screenshot UX Trial？

> ID：12462944
> 
> 赞同：55
> 
> 时间：2012-09-17T15:57:18.610
> 
> 标签：android, android-ui

如何在没有 root 权限的情况下以编程方式截取其他应用程序的屏幕截图，例如 Screenshot UX Trial？

1.  我知道我可以在我的应用程序中捕获根视图的位图。但是当我的应用程序在后台运行时，我无法获得其他应用程序的根视图

    `bitmap = Bitmap.createBitmap(rootview.getDrawingCache());`

2.  Manifest: 中有捕获当前帧缓冲区的权限`android.permission.READ_FRAME_BUFFER`。但是有些网站说它仅适用于签名应用程序。

    [检查 Android 权限 - 保护级别](http://rupertrawnsley.blogspot.hk/2011/11/android-permissions-protection-levels.html)

在尝试了 Screenshot UX Trial 之后，我阅读了许可：

*   INTERNET：用于连接到 localhost 屏幕截图服务器以获取 root 手机。
*   SYSTEM_ALERT_WINDOW：用于最顶部的相机按钮。
*   振动：用于振动反馈。
*   WRITE_EXTERNAL_STORAGE：保存屏幕截图。
*   GET_TASKS：用于检测非 root 和非预加载捕获方法的前台开发设置活动。

似乎要么`SYSTEM_ALERT_WINDOW`允许`GET_TASKS`应用程序截取屏幕截图。我对它的工作原理有两个猜测：

1.  它可能能够访问`Activity`前台活动，它获取的根视图`Activity`，捕获其屏幕截图。
2.  打电话`glreadpixels`

如果您尝试我的猜测之一，请告诉我结果。

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2013-02-05T22:59:09.900

这是极其困难的。我花了几年的时间试图做到这一点。我最终成功了，但任何解决方案都将涉及商业和技术工作。

* * *

# 2015 年 3 月更新

下面的大部分内容不再是最新的。经过这么多年，现在有一个`android.media.projection`包 [https://developer.android.com/reference/android/media/projection/package-summary.html](https://developer.android.com/reference/android/media/projection/package-summary.html) 终于可以满足您的需求了！

* * *

# 捕获您自己的应用程序的屏幕图像

为了完整起见，我想包含您自己的评论，您可以使用`Bitmap.createBitmap(rootview.getDrawingCache());`类似机制捕获您自己的应用程序的图像。

# 在后台捕获另一个应用程序的屏幕

## 使用`READ_FRAMEBUFFER`权限

首先，您是对的，普通应用程序无法使用该`READ_FRAMEBUFFER`权限，因为它是“签名”级别的。这意味着您必须使用与 Android 系统 ROM 相同的密钥进行签名，才能截取这样的屏幕截图。

我觉得这有点难过，所以早在 2009 年，我提交了一个 Android 开源项目，要求将其开放[1](https://android-review.googlesource.com/#/c/8866/)。Android 架构师 Dianne Hackborn 的回应是：

> 不。绝对不会。

那么，事情进展顺利！因此，此权限至今仍为`signature`- 级别。

但是，如果您有此权限，则可以调用[2](http://androidxref.com/4.1.1/xref/frameworks/native/include/gui/ISurfaceComposer.h#123)`captureScreen`的成员。您需要使用 Android NDK 和一些未记录的 API 编写一些本机代码来访问此功能。但是，这是可能的。`ISurfaceComposer`

在 Android 图形子系统内部，它使用`glReadPixels`调用将像素从 GPU 检索回 CPU。（GPU 用于 Android 上的大部分合成。事实上，Android 4.0+ 支持额外的硬件合成器，Surface Flinger 必须做更多的工作才能将这些像素拉回 CPU。）

这个调用很好用，除了一些小问题：

*   使用可能随时中断的不受支持的 API 的风险；
*   在 C++ 中调用它的麻烦
*   它会导致 GPU 流水线停止，这可能会让 GPU 设计人员感到不安，但实际上并不会真正造成问题
*   它依赖于从 GPU 到 CPU 的大*带宽*。这有时是有问题的，因为内存架构被设计为以相反的方向发送数据。但是，我似乎记得所有现代 Android 芯片组架构都直接在 GPU 和 CPU 之间共享内存，除了一个（可能是 Broadcom？ - 我不记得了），这可能会导致这种机制非常缓慢。

...还有一个大问题...

*   最重要的是，作为一个普通的应用程序编写者，由于需要签名级别的权限，您甚至无法调用此 API。

尽管如此，在大多数 Android 设备上，您仍然可以获得每秒 10 帧的速度。*更好的是，这个 API 实际上支持在 GPU 上的硬件中*缩放生成的图像，所以如果你很聪明，你可以在像素到达 CPU 之前将图像预缩放到你需要的大小。所以它可以是极高的性能。

当然，请注意，您作为应用程序编写者无法调用`glReadPixels`，因为您无权访问相关的 OpenGL 上下文。它归表面抛油环所有。

## 使用`/dev/graphics/fb0`和类似

有些人很想尝试读取这些代表帧缓冲区的 Linux 设备文件。但是，存在三个问题：

*   你需要根。
*   有时他们甚至都不在那里。
*   通常，它们并不代表真实的屏幕图像。请记住，在 Android 上，图形是在 GPU 上合成的。因此，CPU 没有理由访问完整合成屏幕图像的副本，而且通常没有。该文件有时包含撕裂（最好的情况）和垃圾图像（最坏的情况）。有趣的是，一些root手机的工具确实使用了这种方法，我认为这是一个错误。如果你有 root 权限，那么根据定义，你拥有所有 Android 权限，因此可以调用上述`captureScreen`API 来获取正确的图像。

## 使用硬件合作伙伴

现在我们进入需要商业行动的解决方案。

与 Android 芯片组制造商交谈通常会提供解决方案。由于他们设计了硬件，因此他们可以访问帧缓冲区——而且他们通常能够通过直接访问他们的自定义内核驱动程序来提供完全避免 Android 权限模型的库。

如果您针对特定的手机型号，这通常是一个很好的前进方向。当然，您可能需要与手机制造商以及硅制造商合作。

有时这可以提供*出色*的结果。例如，我听说在某些硬件上可以将电话硬件帧缓冲区直接传送到电话硬件 H.264 视频编码器中，并检索电话屏幕上任何内容的预编码视频流。杰出的。（不幸的是，我只*知道*这在 TI OMAP 芯片上是可能的，它正在逐渐退出手机市场[3](http://www.gsmarena.com/texas_instruments_backtracks_from_smartphones_goodbye_omap-news-4861.php)）。

## 使用安全漏洞

Android 严格执行其权限模型，并且几乎没有安全漏洞。然而，Android OEM 有时可能会更加粗心。

例如，一家名称以 S 开头的主要 OEM 实施了一种使用击键来捕获屏幕的方法。它将它保存到 SD 卡上的世界可读文件中。假设您可能能够找到拦截这些密钥的内容并查看它是如何工作的。也许你可以做类似的事情。

也许对于另一个名称也以 S 开头的主要 OEM 来说，还有一种方法。

不，我不会在本节中详细介绍。要弄清楚如何做这些事情，我需要有逆向工程软件，这可能是非法的。不过，祝你好运。

## 与手机制造商合作

如前所述，电话制造商可以随时访问有效的*API*。并且电话制造商具有`signature`所需的级别权限。

因此，您需要做的就是安排让手机制造商对您的软件进行签名。

然而，这*很难*。通过签署软件，手机制造商可以保证其质量——因此他们应该审核您的源代码。此外，由于 Android 的性质 - 如果他们签署了软件，他们需要成为分发它的人。如果它是由其他人签名的，则不能将其投放市场。

但是，OEM 不需要将其包含在 ROM 中 - 他们仍然可以在 Android 市场上分发它。但你不能。

一个好的解决方案是，如果每个供应商都签署一个小型库，然后可以通过通用 SDK 访问该库。这导致我...

## 与已经解决此问题的软件合作伙伴合作

我对此了解很多，因为我曾经在 RealVNC 工作过。我们与所有主要的 Android 手机供应商合作，以访问这些签名级 API。我不能过分强调实现这一目标所需的许多人年的努力（商业上和技术上）。一些原始设备制造商已经宣传了这项工作，例如[4](http://developer.sonymobile.com/2012/02/29/new-remote-control-service-on-xperia-smartphones-video/) .

我*不再*在 RealVNC 工作，所以我从宣传他们的软件中得不到任何好处。但是，如果您*真的*希望能够在多个 Android 设备上捕获屏幕，您可能希望与他们联系以重新使用他们的 Remote Control Service 或 Android VNC SDK [5](http://www.realvnc.com/services/mobile.html)。它不是开源的，因此您应该期望付费，并且相信我，考虑到与所有这些 Android OEM 合作所涉及的巨大努力，这已经足够公平了。

为了平衡起见，我应该指出其他供应商也在这方面与手机制造商合作 - 例如 Soti。但我相信它们都提供特定的设备管理解决方案，而不是通用的远程控制/事件注入 SDK。

## 通过 USB

另一种选择 -`adb`通过 USB 侦听调试连接的守护程序比普通应用程序具有稍多的特权，这就是它能够抓取屏幕的原因（您可以使用该`ddms`工具查看其图像）。如果您能够运行任何命令，`adb`那么您也可以获得这些权限（根据之前链接的 android-screenshot-library）。

## 为 Android 开源项目做出贡献

最终，这个问题让我化为尘土，我去了更绿色的牧场，这并不涉及试图从 Android 手机中挤出像素。

不过，在我离开 RealVNC 之前，我们再次尝试将这些 API 贡献给 Android 开源项目。这次我们得到了更积极的反应[6](https://android-review.googlesource.com/#/c/13953/)。简而言之，有人认为我们的安全方法几乎是正确的，但图形系统太混乱了，无法接受我们的补丁。好消息是图形系统不再处于混乱状态——事实上它现在有了`captureScreen`API，这意味着不需要对图形系统进行任何更改。因此，可以围绕这个 API 向 AOSP 提交一个新的安全机制，最终解决这个问题。

祝你好运！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T18:00:40.337

也许[android-screenshot-library](http://code.google.com/p/android-screenshot-library/)可以提供帮助。但是在他们的使用页面中，它说它需要一个以 adb 开头的本机服务（来自 android sdk）。

PS：请记住，屏幕截图 UX 并不适用于所有无根手机。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T20:20:03.437

我不认为 Android 将允许您访问另一个应用程序的帧缓冲区。这只是 Android 安全性的一部分。每个应用程序都应保留自己的资源。

如果您真的需要获取任何应用程序的屏幕截图，我建议您使用本机屏幕抓取“手势”。例如，对于[Nexus 7](http://www.cultofandroid.com/14447/how-to-take-a-screenshot-on-your-nexus-7-tablet/)，只需“......同时按住电源按钮和降低音量按钮大约 2 秒钟。”

谷歌搜索通常会在您的设备上找到诀窍。

# iphone - 在 iPhone 中提前 1 年获取月份和年份

> ID：12462946
> 
> 赞同：0
> 
> 时间：2012-09-17T15:57:21.327
> 
> 标签：iphone, ios, nsdate, nsdateformatter, nsdatecomponents

在我的应用程序中，我需要获取下一年的月份名称和年份并存储在数组中。我的意思是假设今天是 2012 年 9 月，我需要到 2013 年 8 月的月份名称和年份。

你能告诉我如何得到月份和年份吗？提前感谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-17T16:40:33.953

将 NSMonthCalendarUnit 用于当前日历的 components 参数，以获取当前月份的编号，例如 9 月，然后 NSYearCalendarUnit 为当年，例如 2012。然后在使用模数运算的 for 循环中使用这些来环绕到下一年。

如果 for 循环中的月份数小于当前月份，则使用当前年份加 1 作为下一年，否则使用当前年份。

请注意，使用 NSMonthCalendarUnit 时返回的月份编号从 1 开始，而 monthSymbols 的索引编号从 0 开始。这意味着即使我们从九月的 9 开始，我们从这个数组中得到的月份是十月，也就是我们想要的下一个月。

```
/*
 next 12 months after current month
 */

NSDateFormatter  *dateFormatter   = [[NSDateFormatter alloc] init];
NSDate           *today           = [NSDate date];
NSCalendar       *currentCalendar = [NSCalendar currentCalendar];

NSDateComponents *monthComponents = [currentCalendar components:NSMonthCalendarUnit fromDate:today];
int currentMonth = [monthComponents month];

NSDateComponents *yearComponents  = [currentCalendar components:NSYearCalendarUnit  fromDate:today];
int currentYear  = [yearComponents year];
int nextYear     = currentYear + 1;

int months  = 1;
int year;
for(int m = currentMonth; months < 12; m++){

    int nextMonth = m % 12;

    if(nextMonth < currentMonth){
        year = nextYear;
    } else {
        year = currentYear;
    }

    NSLog(@"%@ %i",[[dateFormatter monthSymbols] objectAtIndex: nextMonth],year);

    months++;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-17T16:06:50.363

NSDateFormatter 是任何类型的日期（NSDate）格式化等的关键

```
int monthNumber = 09;   //September
NSDateFormatter *df = [[[NSDateFormatter alloc] init] autorelease];
NSString *monthName = [[df monthSymbols] objectAtIndex:(monthNumber-1)]; 
```

打印日期如 2012 年 9 月 17 日

```
NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setDateStyle:NSDateFormatterLongStyle]; 
[df setTimeStyle:NSDateFormatterNoStyle];  
NSString *dateString = [df stringFromDate:[NSDate date]]; 
[df release]; 
```

# iphone - 只是无法弄清楚如何使用 navigationController 在 UITableView 中重新加载数据

> ID：12462957
> 
> 赞同：0
> 
> 时间：2012-09-17T15:58:02.793
> 
> 标签：iphone, ios, xcode, uitableview, uinavigationcontroller

这是我第一次提出问题并发布代码，所以我希望我已经包含了所有必要的内容。

在我的其他几个应用程序中，我已经能够成功地在 UITableView 中重新加载数据，但由于某种原因，我无法让它在这里工作。

我正在使用 navigationController 并在 UITableView 中向下钻取几个级别，直到加载一个新类，该类现在只有两个按钮，可以在 2 个相似的 plist 文件之间切换，所以我可以知道 tableView 实际上正在重新加载（Data.plist & Data2.列表）

这最终将成为一种时间表类型的应用程序，其中列出了各个工作，并且用户（司机）将使用 In/Out 按钮打一个时钟。现在，我想要向下钻取并单击加载另一个 plist 的按钮，然后返回以显示新的 plist 数据已加载。我的问题是我根本无法让 tableView 重新加载。我尝试将 [self.tableView reloadData] 和 [myTableView reloadData]（我也通过 IB 连接）的不同变体放在各处，但它们都不起作用。我目前正在从 detailViewController（按钮所在的位置）调用 rootViewController（tableView 所在的位置）中的一个方法，并且当没有使用 navigationController 时，该基本过程在其他应用程序中适用于我。在这个应用程序中，navigationController 似乎让我失望了。我希望可以找到一个简单的解决方案。到目前为止，我的代码如下所示：

AppDelegate.m

```
- (void)applicationDidFinishLaunching:(UIApplication *)application {    
    [window addSubview:[navigationController view]];
    [window makeKeyAndVisible];
} 
```

根视图控制器.m

```
- (void)viewDidLoad {    
    [super viewDidLoad];
    //THIS ESTABLISHES WHICH PLIST TO LOAD BASED ON THE BUTTON CLICKED
    plistToUse = [[NSUserDefaults standardUserDefaults] objectForKey:@"plistToUse"];
    if (plistToUse == @"Data.plist") {
        NSString *Path = [[NSBundle mainBundle] bundlePath];
        NSString *DataPath = [Path stringByAppendingPathComponent:@"Data.plist"];
        NSDictionary *tempDict = [[NSDictionary alloc] initWithContentsOfFile:DataPath];
        self.data = tempDict;
        [tempDict release];
    } else if (plistToUse == @"Data2.plist") {
        NSString *Path = [[NSBundle mainBundle] bundlePath];
        NSString *DataPath = [Path stringByAppendingPathComponent:@"Data2.plist"];
        NSDictionary *tempDict = [[NSDictionary alloc] initWithContentsOfFile:DataPath];
        self.data = tempDict;
        [tempDict release];
    } else  {
        NSString *Path = [[NSBundle mainBundle] bundlePath];
        NSString *DataPath = [Path stringByAppendingPathComponent:@"Data.plist"];
        NSDictionary *tempDict = [[NSDictionary alloc] initWithContentsOfFile:DataPath];
        self.data = tempDict;
        [tempDict release];
    }

    if(CurrentLevel == 0) {            
        NSArray *tempArray = [[NSArray alloc] init];
        self.tableDataSource = tempArray;
        [tempArray release];            
        self.tableDataSource = [self.data objectForKey:@"Rows"];            
        self.navigationItem.title = @"Choose Driver";
    } else if (CurrentLevel == 1) {
        self.navigationItem.title = @"Choose Day";
    } else if (CurrentLevel == 2) {
        self.navigationItem.title = @"Choose Job";
    } else if (CurrentLevel == 3) {
        self.navigationItem.title = @"Job Details";
    } else {
        self.navigationItem.title = CurrentTitle;
    }         
}

-(void)update {
    dvController.labelHelper.text = @"UPDATED"; //USED TO SEE IF A LABEL IN THE BUTTON CLASS WILL UPDATE        
    NSArray *tempArray = [[NSArray alloc] init];
    self.tableDataSource = tempArray;
    [tempArray release];        
    self.tableDataSource = [self.data objectForKey:@"Rows"];
    self.navigationController.navigationItem.title = @"Choose Driver";
    self.navigationController.title = @"THE TITLE";        
    [myTableView reloadData];    
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    unsortedIndex=1;
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [self.tableDataSource count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:CellIdentifier] autorelease];
    }

    dictionary = [self.tableDataSource objectAtIndex:indexPath.row];
    cell.textLabel.text = [dictionary objectForKey:@"Title"];

    NSArray *Children = [dictionary objectForKey:@"Children"];
    if ([Children count] == 0) {
        Titles = [dictionary objectForKey:@"Title"];
        in1 = [[NSUserDefaults standardUserDefaults] objectForKey:@"InTime1"];
        cell.detailTextLabel.text = [NSString stringWithFormat:@"%@", in1];
    }
    in1 = [[NSUserDefaults standardUserDefaults] objectForKey:@"InTime1"];
    out1 = [[NSUserDefaults standardUserDefaults] objectForKey:@"OutTime1"];
    cell.detailTextLabel.text = [NSString stringWithFormat:@"%@:%@", in1, out1];

    return cell;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    dictionary = [self.tableDataSource objectAtIndex:indexPath.row];
    NSArray *Children = [dictionary objectForKey:@"Children"];
    DetailViewController *dvController = [[DetailViewController alloc] initWithNibName:@"DetailView" bundle:[NSBundle mainBundle]];
    if([Children count] == 0) {     
        [self.navigationController pushViewController:dvController animated:YES];
        dvController.labelSiteName.text = [dictionary objectForKey:@"Company"];
        dvController.labelSiteAddress.text = [dictionary objectForKey:@"Address"];
        dvController.labelSiteNotes.text = [dictionary objectForKey:@"Notes"];
        [dvController.mapView setMapType:MKMapTypeStandard];
        [dvController.mapView setZoomEnabled:YES];
        [dvController.mapView setScrollEnabled:YES];
        dvController.mapView.showsUserLocation = YES;
        [dvController release];
    }
    else {        
        RootViewController *rvController = [[RootViewController alloc] initWithNibName:@"RootViewController" bundle:[NSBundle mainBundle]];
        rvController.CurrentLevel += 1;
        rvController.CurrentTitle = [dictionary objectForKey:@"Title"];
        [self.navigationController pushViewController:rvController animated:YES];
        rvController.tableDataSource = Children;
        [rvController release];
    }

} 
```

DetailViewController.m 这两个按钮应该使用 Data.plist 或 Data2.plist 重新加载 tableView

```
-(IBAction)getInTime1:(id)sender {   
    plistToUse = @"Data.plist";
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:plistToUse forKey:@"plistToUse"];
    [defaults synchronize];
    [rvController update];
}

-(IBAction)getOutTime1:(id)sender {
    plistToUse = @"Data2.plist";
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    [defaults setObject:plistToUse forKey:@"plistToUse"];
    [defaults synchronize];
    [rvController update];
} 
```

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T06:00:20.073

将您从`plist`代码中获取的数据添加到您的`viewDidAppear`or`viewWillAppear`方法中，以便每次视图出现时，数据都会从 plist 加载。

另请注意，您的数组仅分配一次。

这对你有用。

# asp.net-mvc - 删除和更新 Asp.Net MVC 4 中的对象列表

> ID：12462958
> 
> 赞同：0
> 
> 时间：2012-09-17T15:58:07.357
> 
> 标签：asp.net-mvc, asp.net-mvc-4, edit

我有一个表单，在页面顶部有一个输入部分，在下半部分它显示了已添加对象的列表。我需要能够编辑和删除这些对象，但我不确定从哪里开始或如何做。

此代码显示对象列表。

```
 @if (Model.ListOfRecipients != null)
            {
                for (int i = 0; i < Model.ListOfRecipients.Count; i++)
                {

                <div class='recipient-wrapper'>
                    <div class='decision_block'>
                        <table class='recipient'>
                            <tr>
                                <td class='recipient-title'>
@Html.HiddenFor(model=>model.ListOfRecipients[i].RecipientId)
                                    <h3>
                                        @Html.DisplayTextFor(model => model.ListOfRecipients[i].RecipientName)
                                        @Html.HiddenFor(model => model.ListOfRecipients[i].RecipientName)
                                    </h3>

                                    <div class='delivery-type'>
                                        Delivery Type: @Html.DisplayTextFor(model => model.ListOfRecipients[i].DeliveryType)
                                                       @Html.HiddenFor(model => model.ListOfRecipients[i].DeliveryType)
                                    </div>
                                </td>
                                <td class='na express'>
                                    @Html.CheckBoxFor(model => model.ListOfRecipients[i].ExpressIndicator)
                                    @Html.HiddenFor(model => model.ListOfRecipients[i].ExpressIndicator)
                                </td>
                                <td class='quantity'>
                                    <h3>
                                      Qty @Html.DisplayTextFor(model => model.ListOfRecipients[i].Quantity)
                                          @Html.HiddenFor(model => model.ListOfRecipients[i].Quantity)
                                    </h3>
                                </td>
                                <td class='action'>
                                    <input class='button edit_recipient' type='button' value='Edit' />
                                    <input class='button delete_recipient' type='button' value='Delete' />
                                </td>
                            </tr>
                        </table>

                            <input class='button update_recipient' type='button' value='Update' />
                            <a class='cancel_update' href='#'>Cancel</a>
                        </div>
                    </div>
                </div>

                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:10:21.547

您可以创建一个删除控制器和一个编辑控制器，在上面的视图中，每个控制器旁边都有一个删除和编辑，它接收对象 id，每个按钮都转到它自己的视图，在那里他们可以编辑或删除

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T16:13:47.800

您需要在控制器中编写 Edit 和 Delete 操作方法，然后设置两个按钮以调用适当的方法。

操作方法的代码将取决于几个因素，这些因素可能会在这里广泛讨论。

使用 Razor 语法 - 抱歉其他人使用了错误的标记:(

```
<input class='button edit_recipient' type='button' value='Edit' 
       onclick="location.href='@Url.Action("Edit", "Controller", new { id = Model.Id } )'" /> 
```

# android - sencha Touch 2 + PhoneGap 的正确路径

> ID：12462959
> 
> 赞同：2
> 
> 时间：2012-09-17T15:58:11.417
> 
> 标签：android, mobile, cordova, sencha-touch-2

我想用 sencha Touch 2 + Phonegap 创建一个移动应用程序。

我发现，我必须使用 *file:///android_asset/www/* 作为路径。

**/assets/www/index.html**

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title></title>

    <link rel="stylesheet" href="file:///android_asset/www/app/app.css" type="text/css">

    <script type="text/javascript" src="file:///android_asset/www/sdk/sencha-touch.js"></script>
    <script type="text/javascript" src="file:///android_asset/www/all-classes.js"></script>
    <script type="text/javascript" src="file:///android_asset/www/app.js"></script>
</head>
<body>T5</body>
</html> 
```

运行应用程序后，我收到如下错误：未捕获错误：[Ext.Loader] Failed loading 'app/view/home/main.js'，请验证文件是否存在于 file:///android_asset/www/sdk/ sencha-touch.js:7914

所以我添加了“file:///assets/www/”，但我仍然得到：未捕获的错误：[Ext.Loader] Failed loading 'file:///assets/www/app/view/home/main.js' ，请验证文件是否存在于 file:///android_asset/www/sdk/sencha-touch.js:7914

路径有问题。路径应该如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T21:02:03.410

您基本上是在 webview 中运行网站，因此它们都与您的 index.html 文件相关，因此您应该能够如下定义路径：

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title></title>

    <link rel="stylesheet" href="app/app.css" type="text/css">

    <script type="text/javascript" src="sdk/sencha-touch.js"></script>
    <script type="text/javascript" src="all-classes.js"></script>
    <script type="text/javascript" src="app.js"></script>
</head>
<body>T5</body>
</html> 
```

# java - MVC - 我需要在视图中使用控制器吗？

> ID：12462964
> 
> 赞同：7
> 
> 时间：2012-09-17T15:58:36.330
> 
> 标签：java, model-view-controller, view, model, controller

正如我所知，在 MVC 的标准实现中，我们将 Controller 和 Model 传递给 View

但我有点不同意这个想法。我不希望我的视图同时了解控制器和模型（哦不。也许有时视图需要模型，但我确信他可以在不了解控制器的情况下生活）

我认为Controller应该管理View和Model，而Model不需要知道Controller和View；视图不需要知道控制器（我不排除模型，因为视图的某些实现需要知道模型才能监听模型的变化）。所以我的想法是**view 不需要知道 controller**。

**1.**这是一个例子：

```
public class MyView implements ButtonClickListener {

    private Controller myController;
    private Button myButton;

    // I commented out the model because we dont need it now 
    // we are talking about using controller in the view

    public MyView(Controller c/*, Model m*/) {
        myController  = c;
        myButton      = new Button(); // lets say that it is "register" button
        myButton.setOnButtonClickListener(this);
    }

    public void setRegisterButtonText(String text) {
        myButton.setText(text);
    }

    @Override
    public void onClick() {
        myController.tellToModelToDoSomething();
    }

} 
```

和控制器：

```
public MyController implements Controller {

     private Model model;
     private View view;

     public MyController(Model model) {

          this.model = model;
          this.view  = new MyView(this);

     }

     public void tellToModelToDoSomething() {
          model.doSomeActions();
     }

} 
```

**2.**现在我如何在不通过控制器的情况下查看此实现：

我的观点：

```
public class MyView {

    private Button myButton;

    public MyView() {
        myButton = new Button();
    }

    public void setRegisterButtonText(String text) {
        myButton.setText(text);
    }

    public void setOnRegisterButtonClick(final Command command) {
        myButton.setOnButtonClickListener(new ButtonClickListener() {
                            @Override
                            public void onClick() {
                                command.execute();
                            }
                         });
    }

} 
```

“命令”界面：

```
public interface Command {

     void execute(/*also can handle extra params*/);

} 
```

和控制器：

```
public MyController implements Controller {

 private Model model;
 private View view;

 public MyController(Model model) {

      this.model = model;
      this.view  = new MyView();

      view.setOnRegisterButtonClick(command);

 }

 public void tellToModelToDoSomething() {
      model.doSomeActions();
 }

 private Command command = new Command() {

     public void execute() {
          tellToModelToDoSomething();
     }

 }; 
```

}

那么为什么我认为在视图中使用控制器**并不好**：

我们正在混合控制器和视图实现，建立新的依赖关系。

另外我认为 View 应该只包含 VIEWS 和它们的操作（并且使用控制器和他的一些方法已经看起来像逻辑）。

在第一个示例中，视图告诉控制器该做什么。你同意吗？看起来视图控制控制器！

在第二个示例中，控制器控制要做什么，并告诉视图如果单击某个按钮（只有视图知道它将是什么按钮）要做什么

我总是使用第二种方案，但是在阅读了一本关于 mvc 的新书后，说我们需要将控制器传递给视图，我有点困惑。

你能帮我理解为什么我错了并给我看一些例子吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-17T16:34:44.420

没有 MVC 标准，因为有很多实现。这是许多教科书中对 MVC 的一种解释：

在这个解释中控制器的定义是它处理来自视图的事件，所以视图必须使用控制器。

在标准 MVC 中，模型包含并公开数据，控制器操作模型并接受来自视图的事件，视图呈现模型并为控制器生成事件。

MVC 被认为是一个事务系统，其中事务由事件发起。交易通常如下所示：

1.  在视图上生成一个事件（例如单击按钮）。
2.  事件信息从视图传递到控制器。
3.  控制器调用模型上的方法来更改它（设置器和其他可能更新某些数据库的操作方法）。

这些第一步代表 VC 链接和 MC 链接。VC 的存在是因为事件从视图传递到控制器以进行处理，而不是视图直接处理它们。存在 MC 链接是因为控制器根据触发的事件更新模型。

从这里开始，有两条路。第一个：

1.  交易结束。
2.  另外，模型会触发自己的事件以指示它已更改。
3.  视图正在侦听模型并接收事件，并更新其模型表示以反映更改。

这第一条路径代表了对 MV 链接的一种解释。MV 链接是 1) 视图从模型中获取其数据的信息，以及 2) 模型告诉视图在修改后进行更新。

第二条路径只有一步：一旦控制器处理了事件，视图会立即更新，只需刷新其所有 UI 元素。对 MV 链接的这种解释是，模型只是将其信息提供给视图，与上面第一条路径中来自 MV 链接的点 #1 相同。

这是针对我描述的 MVC 架构修改的一些代码：

```
public class MyView implements View, ModelListener {

    private Button myButton;
    private Controller controller;

    public MyView(Controller controller, Model model) {
        myButton = new Button();
        myButton.setOnButtonClickListener(new ButtonClickListener() {
            @Override
            public void onClick() {
                controller.onRegisterButtonClick();
            }
        });
        this.controller = controller;
        model.addModelListener(this);
    }

    public void setRegisterButtonText(String text) {
        myButton.setText(text);
    }

    public void modelUpdated(Model model) {
        // Update view from model
    }
} 
```

和控制器：

```
public MyController implements Controller {

    private Model model;
    private View view;

    public MyController(Model model) {
        this.model = model;
        this.view  = new MyView(this, model);
    }

    private void manipulateModel() {
        model.doSomeActions();
    }

    public void onRegisterButtonClick() {
        maniuplateModel();
    }
} 
```

然后是模型：

```
public class MyModel implements Model {
    private List<ModelListener> modelListeners = new ArrayList<ModelListener>();

    public void addModelListener(ModelListener ml) {
        if (!modelListeners.contains(ml)) {
            modelListeners.add(ml);
        }
    }

    public void removeModelListener(ModelListener ml) {
        modelListeners.remove(ml);
    }

    public void doSomeActions() {
        // Do something
        fireUpdate();
    }

    private void fireUpdate() {
        // Iterates backwards with indices in case listeners want to remove themselves
        for (int i = modelListeners.size() - 1; i >= 0; i-- {
            modelListener.modelUpdated(this);
        }
    }
} 
```

`ModelListener`很简单：

```
public interface ModelListener {
    void modelUpdated(Model model);
} 
```

这只是一种解释。如果您想在不同部分之间进一步解耦，您应该查看[演示、抽象、控制 (PAC) 模式](http://en.wikipedia.org/wiki/Presentation%E2%80%93abstraction%E2%80%93control)。它比 MVC 更解耦，也非常适合分布式系统。对于简单的 Web、移动、桌面应用程序来说，它是多余的，但是一些客户端/服务器应用程序和大多数云应用程序可以从这种方法中受益。

在 PAC 中，您拥有三个部分，表示、抽象和控制，但抽象和表示（模型和视图）不相互交互。相反，信息只进出控制模块。此外，您可以拥有多个 PAC 子模块，这些子模块只能通过它们的控件相互交互，从而为分布式系统提供良好的模式。基本上，控制模块是任何数据传输的主要枢纽。

本质上，您对 MVC 的解释可能与我或他们的不同。重要的是您选择一种架构模式并遵循它以保持您的代码在未来可维护。你是对的，有一些方法可以进一步解耦 MVC。实际上，您的示例有点像 PAC，但不是删除 VC 链接，而是删除了 MV 链接。

无论如何，遵循一个架构，*记录*你的架构（这样人们就知道你的解释是什么），不要偏离那个方向。

# mysql - 使用 CSV 文件中的数据更新 SQL 数据库中的字段

> ID：12462966
> 
> 赞同：2
> 
> 时间：2012-09-17T15:58:40.367
> 
> 标签：mysql, sql, csv, cart, zen

首先，如果这个问题已经得到解答，我深表歉意。我见过很多类似的问题，但没有一个能完整回答我的问题。

首先，我充其量只是一个 SQL 新手。自从建立我的在线商店以来，我已经学到了很多东西，但我对其中的大部分内容仍然知之甚少。

好的，我的网络服务器上有一个用于在线商店的数据库。我卖的东西也可以直接发货。我可以每隔几分钟从我的分销商处下载更新的 CSV 格式的库存文件。此文件包含两列，第一行中没有字段名称。我要更新的表是 zen_products。CSV 文件中的第一列对应于列 products_model 并且是唯一的。CSV 文件中的第二列对应于列 products_quantity。CSV 文件中会有 SQL 表中不存在的记录。我不想创建新记录；我只想使用 CSV 文件中的值更新 products_quantity 列。

好的，就目前而言，我可以通过我的购物车软件的管理部分使用附加组件来执行此操作，但我必须编辑 CSV 文件以输入特定的字段名称。这不是问题，因为它非常简单，但编辑文件、登录、上传和处理文件确实需要几分钟。其实很简单；但是我想找到一种方法来完全自动化这个过程，这样如果可能的话，我可以每 15-30 分钟自己完成一次。正如你所想象的那样，需要 5 分钟的事情是可以的，但如果每 15 分钟需要 5 分钟，那么一整天的时间就很多了。即使在我很忙或不在的时候，如果能够让它发生，那就太好了。

如有必要，我也愿意为一个有效的、完全自动化的解决方案支付合理的费用。此外，CSV 文件只能通过 FTP 访问。仅供参考，我使用 Zen Cart 作为我的购物车。

任何帮助将不胜感激。谢谢。

**更新：**根据 JKirchartz 的帮助（谢谢，顺便说一句，你很高兴），我有这个每次运行时似乎都可以工作：

```
DELETE FROM zen_temp;

load data local infile '/home/somedude/public_html/somefolder/somefile.csv' into table zen_temp
fields terminated by ','
enclosed by '"'
lines terminated by '\n'
(products_model, products_quantity);

UPDATE zen_products SET `products_quantity` = ( SELECT products_quantity FROM zen_temp WHERE zen_products.products_model = zen_temp.products_model )
WHERE EXISTS ( SELECT products_model FROM zen_temp WHERE zen_products.products_model = zen_temp.products_model ); 
```

现在我的问题是，我怎样才能把它变成我可以用很少的输入轻松完成的事情？有没有办法可以轻松地安排它或从任何地方运行它？再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-17T16:31:17.670

您可以使用以下命令直接导入 CSV：

```
load data local infile 'uniq.csv' into table tblUniq fields terminated by ','
enclosed by '"'
lines terminated by '\n'
(uniqName, uniqCity, uniqComments) 
```

要更新，您必须`LOAD DATA LOCAL INFILE`进入另一个表，然后使用存储过程或查询`INSERT`和`UPDATE`（而不是`REPLACE`）您想要的表

# c# - MSMQ in .NET: synchronous vs asynchronous?

> ID：12462967
> 
> 赞同：1
> 
> 时间：2012-09-17T15:58:41.583
> 
> 标签：c#, .net, msmq, messaging

When and which approach to use?

Is there any reason to use asynchronous methods, if for synchronous is dedicated separate thread?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:01:55.747

You use the asynchronous method to prevent blocking the calling thread. Also, it is preferable to use this approach as opposed to creating your own dedicated thread that will use the sync method. This is .NET general-purpose advice, better to let .NET do the async work, than to create your own dedicated threads.

EDIT: [Here is one question](https://stackoverflow.com/questions/582550/c-sharp-begin-endreceive-how-do-i-read-large-data) that might be of interest to you regarding MSMQ and EndReceive, which is part of the asynchronous model for MSMQ in .NET.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-20T12:43:04.303

I suggest to use the **asychronous** approach when using the MSMQ.

One of the main purposes of MSMQ is to provide a solution to send data between **decoupled** systems. In other words, ideally both publisher and subscriber **should not know anything** about each other, as long as they know how to handle the message contents.

This includes that the sender should not need to worry about whenever the receiver handles the sent message. It could be handled right away or after a few thousand other messages that are already piled in the receiver's queue.

Or think about a receiver that is offline for hours or even days. When using transactional queues, your messages would even then be delivered as soon as the receivers comes back online, but would you want to wait synchronously for so long? :-)

As always, it depends on **what you want to do**.

If you want to, say, guarantee that the messages are handled in a certain order, using a synchronous approach might be helpful. But I guess that there are more situation in which do do not care, or that are too complex to make any guarantees.

Some examples to make clearer what I mean:

*   Just imagine an architecture that involves a load **balancer/dispatcher**. When that balancer spreads the received messages over multiple services or threads, you cannot rely on aspects like order and timing. IMHO, you would not want to do this synchronously.

*   Another common practice is having **multiple** subscribers to a **single** publisher. An easy example could be a chat server that wants to send the latest chat message to a couple of hundred chat clients. Again, you would not want to do this synchronously.

Coming back to the question, you are **not giving away anything** to use async right from the begining. Instead you gain **flexibility** and **scalability** the more **decoupled** you implement its usage.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-22T21:06:08.250

Sometime after...

*Async* read does not hold a reading thread. It registers a callback and when a message is fully read, it returns to the original callee with this message. This is wonderful if you need your thread to do some other work.

What I actually found, was that a *sync* read to be twice as fast as async. Because there is no callbacks involved and possibly fewer threading overhead, a single thread was reading double the number of messages from a queue.

I'd recommend to measure this on your platform, instead of blindly follow async-await pattern (which is really good in most other cases)

# c# - 绑定数据网格时出现数据库异常

> ID：12462969
> 
> 赞同：0
> 
> 时间：2012-09-17T15:58:44.763
> 
> 标签：c#, mysql

```
public void FillGrid()
{
    string connString = "Server =localhost;Port = 3306; Database =lbmtcs; UID =serverUser; Password =";
    MySqlConnection Pathway = new MySqlConnection(connString);

    string gridView = "SELECT PIN, Status, Cert_Title_No, Owner_Name, Co_Owner, Street, Barangay FROM landrecord"
                        +"WHERE PIN = @pin, Status = @Stat AND Cert_Title_No = @Cert AND Owner_Name = @Owner AND Co_Owner = @CO AND Street = @St AND Barangay = @Bar";
    MySqlCommand grid = new MySqlCommand(gridView, Pathway);
    MySqlDataAdapter MyDA = new MySqlDataAdapter();
    MySqlCommandBuilder cmd = new MySqlCommandBuilder(MyDA);
    MyDA.SelectCommand = grid;

    DataTable table = new DataTable();
    MyDA.Fill(table);

    BindingSource bSource = new BindingSource();
    bSource.DataSource = table;
    dGrid.DataSource = bSource;

} 
```

MySqlException 未处理：

> 命令执行期间遇到致命错误。

代码有什么问题？

我正在选择一些列来显示在我的数据网格中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:04:40.300

@pin 和 Status 之间应该是 AND 而不是 ,

# label - gnuplot中的网络轴

> ID：12462970
> 
> 赞同：1
> 
> 时间：2012-09-17T15:58:51.207
> 
> 标签：label, gnuplot

我想通过绘制一个 x 轴表示磁盘上使用的采样时间点和 y 轴存储的图形来显示磁盘上已用空间的变化。但是，目前使用的存储是以字节为单位记录的，当值超过 GB 时，这是不可读的。

那么，我可以在 gnuplot 中重新定义轴吗？就我而言，我可以将值更改`100000000`为`100MB`吗？

谢谢和最好的问候。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-17T16:21:17.250

您有两个主要选择。第一个（可能也是最简单的）是在绘图时缩放：

```
plot 'datafile' using 1:($2/1e6) title 'Usage in MB' 
```

这将绘制文件中的第二个数据列，`datafile`每个值除以 1e6，与时间（第一列）的关系。

您也可以重新调整坐标轴，但这不太通用。

```
set ytics ("100" 1e8) 
```

另一种选择是在 y 轴上使用科学记数法（就像我在上面对这些大数字所做的那样）。为此，命令是

```
set format y '%.2e' 
```

这将使用科学记数法打印 y 抽动，小数点后有 2 位数字。你也可以试试

```
set format y '%.2g' 
```

这将打印更紧凑的科学记数法或正常记数法。

# jquery - 检测哪个视图在移动设备上处于活动状态

> ID：12462977
> 
> 赞同：0
> 
> 时间：2012-09-17T15:59:43.610
> 
> 标签：jquery, css, mobile

我需要知道其手机或 Pad 上的用户是否正在查看网站 Verticaly 或 Horizo​​ntaly 以切换我的图像比例。

例子：

如果用户正在水平查看页面，我的图像的样式以查看它的全尺寸将是

```
img{width:100%; height:auto;} 
```

但如果它是垂直的，则需要将 css 切换到

```
img{width:auto; height:100%;} 
```

那么我怎样才能在 jQuery 或 Javascript 或媒体查询中实现这样的事情......等等，这样我就可以根据用户在其移动设备或 iPad 上查看页面的视图来采取良好的风格？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:02:38.067

您可以使用一些 javascript 检测方向，例如：

```
detectOrientation();
    window.onorientationchange = detectOrientation;
    function detectOrientation(){
        if(typeof window.onorientationchange != 'undefined'){
            if ( orientation == 0 ) {
                 //Do Something In Portrait Mode
            }
            else if ( orientation == 90 ) {
                 //Do Something In Landscape Mode
            }
            else if ( orientation == -90 ) {
                 //Do Something In Landscape Mode
            }
            else if ( orientation == 180 ) {
                 //Do Something In Landscape Mode
            }
        }
    } 
```

来自[http://www.devinrolsen.com/javascript-mobile-orientation-detection/](http://www.devinrolsen.com/javascript-mobile-orientation-detection/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-17T16:42:46.603

你不能只使用带有某些断点的响应式 css 吗？

有点像这样：

```
@media screen and (max-width: 123px /* your value */ ) {
  img{width:auto; height:100%;}
} 
```

# blackberry - BlackBerry - 从 changeListener 事件设置 EditField 的文本宽度

> ID：12462978
> 
> 赞同：0
> 
> 时间：2012-09-17T15:59:46.010
> 
> 标签：blackberry, java-me

如果返回的长度`input.getText()`大于 13，则用户输入的最后一个字符不应出现在编辑字段中。如果第 13 个字符是“，”，则程序应允许在“，”之后增加 2 个字符。这样，编辑字段的最大长度将为 16。

像这样限制 EditField 的文本宽度的选项是什么？

```
input = new BorderedEditField();

input.setChangeListener(new FieldChangeListener() {             
    public void fieldChanged(Field field, int context) {
        if(input.getText().length() < 13)
            input.setText(pruebaTexto(input.getText()));
        else
            //do not add the new character to the EditField
    }
});

public static String pruebaTexto(String r){
    return r+"0";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-18T13:19:38.997

我编写了一个简单`BorderedEditField`的扩展类[`EditField`](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/component/EditField.html)。[`protected boolean keyChar(char key, int status, int time)`](http://www.blackberry.com/developers/docs/5.0.0api/net/rim/device/api/ui/component/BasicEditField.html#keyChar%28char,%20int,%20int%29)此类的方法被修改，以便可以操纵`EditField`的默认行为。如果您发现此示例有帮助，那么您可以改进实现。

```
import net.rim.device.api.system.Characters;
import net.rim.device.api.ui.component.EditField;
import net.rim.device.api.ui.container.MainScreen;

public final class MyScreen extends MainScreen {
    public MyScreen() {
        BorderedEditField ef = new BorderedEditField();
        ef.setLabel("Label: ");

        add(ef);
    }
}

class BorderedEditField extends EditField {
    private static final int MAX_LENGTH = 13;
    private static final int MAX_LENGTH_EXCEPTION = 16;

    private static final char SPECIAL_CHAR = ',';

    protected boolean keyChar(char key, int status, int time) {
        // Need to add more rules here according to your need.
        if (key == Characters.DELETE || key == Characters.BACKSPACE) {
            return super.keyChar(key, status, time);
        }
        int curTextLength = getText().length();
        if (curTextLength < MAX_LENGTH) {
            return super.keyChar(key, status, time);
        }
        if (curTextLength == MAX_LENGTH) {
            char spChar = getText().charAt(MAX_LENGTH - 1);
            return (spChar == SPECIAL_CHAR) ? super.keyChar(key, status, time) : false;
        }
        if (curTextLength > MAX_LENGTH && curTextLength < MAX_LENGTH_EXCEPTION) {
            return super.keyChar(key, status, time);
        } else {
            return false;
        }
    }
} 
```

# jquery-ui - 在jqueryUI selectmenu上找不到css类来改变宽度

> ID：12462979
> 
> 赞同：-1
> 
> 时间：2012-09-17T15:59:46.633
> 
> 标签：jquery-ui, select-menu, jquery-ui-selectmenu

使用 jqueryUI 选择菜单插件。

我找不到合适的类来修改下拉菜单的宽度。我不知道是什么 css 类使菜单更短，并选择它上面的元素。欢迎任何想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T15:32:23.453

假设您使用的是我的 Selectmenu fork (https://github.com/fnagel/jquery-ui/tree/selectmenu)，您需要使用选项 menuWidth。请注意，您需要以任何方式设置宽度，通过选项或使用 CSS。不支持自动宽度！

请参阅 wiki 了解更多信息：[https ://github.com/fnagel/jquery-ui/wiki/Selectmenu](https://github.com/fnagel/jquery-ui/wiki/Selectmenu)

# heroku - Heroku 和 Proximo 插件 bin/proximo：第 36 行：执行：/app/vendor/dante/bin/socksify：无法执行：权限被拒绝

> ID：12462990
> 
> 赞同：2
> 
> 时间：2012-09-17T16:00:04.593
> 
> 标签：heroku

我已经按照[官方推荐](https://devcenter.heroku.com/articles/proximo)安装了 Proximo 插件，但是由于以下原因它无法正常工作：

使用命令`bin/proximo bundle exec thin start java -Xmx384m -Xss512k -XX:+UseCompressedOops -Dspring.profiles.active=prod -jar frontend/target/dependency/webapp-runner.jar --port 5231 frontend/target/*.war` 2012-09-17T14:50:33+00:00 app[web.1] 启动进程：代理通过 Proximo 主机 23.21.47.211:1080 2012-09-17T14:50:33 绑定到 0.0.0.0/0 的流量+00:00 app[web.1]：bin/proximo：第 33 行：/app/vendor/dante/bin/socksify：权限被拒绝 2012-09-17T14:50:33+00:00 app[web.1] ：bin/proximo：第 33 行：执行：/app/vendor/dante/bin/socksify：无法执行：权限被拒绝

请帮帮我，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T20:19:05.247

您是否尝试过`heroku addons:remove proximo`然后重新安装`heroku addons:add proximo`？

您还需要转发所有出站流量，还是仅将其用于您在后端进行的某些特定 API 调用？

瘦服务 Java 应用程序吗？你也许可以做

`bin/proximo java -Xmx384m -Xss512k -XX:+UseCompressedOops -Dspring.profiles.active=prod -jar frontend/target/dependency/webapp-runner.jar --port 5231 frontend/target/*.war`

# android - 自定义 CursorAdapter setText() 不更新 android

> ID：12462991
> 
> 赞同：0
> 
> 时间：2012-09-17T16:00:05.280
> 
> 标签：android, android-cursoradapter, settext

我正在开发一个带有 ListView 的 Android 应用程序，使用自定义 CursorAdapter 从 SQLite 数据库中检索数据。下面提供了适配器的（缩减）代码，问题是在该`onClick()`方法中，该`pillButton01.setText(Integer.toString(test));`行实际上并未更新 UI 中的按钮文本，有什么建议吗？提前致谢

```
public class PillTrackerAdapter extends CursorAdapter implements OnClickListener {

    @Override
    public void bindView(View view, Context context, Cursor cursor) 
    {
        pillButton01 = (Button) view.findViewById(R.id.pillButton1); 
        pillButton01.setTag(0);
        pillButton01.setOnClickListener(this);
    }

    @Override
    public void onClick(View v) 
    {
        int tag = (Integer) v.getTag();

        switch(tag) {
            case 0: pillButton01.setText(Integer.toString(test)); 
                    test++;
                break;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-17T16:07:50.160

这是有道理的。pillButton01 设置为最后一个绑定视图。（它一直在变化。您需要找出您在哪个 listItem 上并根据该项目的视图采取行动

# php - 尝试创建数组时出现内存问题

> ID：12462993
> 
> 赞同：1
> 
> 时间：2012-09-17T16:00:08.837
> 
> 标签：php

我有一个我的公司用来根据输入动态创建一些文件的表格。我有一个文本区域`$fileString`，他们可以输入文件名，然后是硬回车。我接受它并创建一个数组，`$list`. 我想要做的是，如果他们在文本区域中输入两个文件名，如下所示：

```
item1

item2 
```

它将创建一个包含 6 个值而不是两个值的数组，如下所示：

`$genList = array(item1_f, item1_b, item1_i, item2_f, item2_b, item2_i);`

但是当我运行我的代码时，我收到了这个错误：

```
Fatal error: Allowed memory size of 268435456 bytes exhausted (tried to allocate 24 bytes) in /home/dcolor/public_html/dev/create.php on line 18 
```

第 18 行是：

```
array_push($genList, $list[0] . "_f", $list[0] . "_b", $list[0] . "_i"); 
```

我在这里做错了什么？下面的代码

```
 $fileString = $_POST['fileList'];
    $unique = $_POST['unique'];
    $size = $_POST['size'];
    $generateArray = $_POST['generateArray'];
    $list = explode("\r\n",$fileString);

    if ($generateArray == "yes") {      
        if ($size == "5x7inimpos") {
            $genList = array();
            while (!empty($list)) {             
                array_push($genList, $list[0] . "_f", $list[0] . "_b", $list[0] . "_i");                    
            }
        }
        print_r($genlist);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T16:05:25.310

```
while (!empty($list)) {             
        array_push($genList, $list[0] . "_f", $list[0] . "_b", $list[0] . "_i");                    
} 
```

`$list`永远不会被清空，您永远不会退出 while 循环。

您只想遍历列表：

```
foreach($list as $element)
{

    array_push($genList, $element . "_f", $element . "_b", $element . "_i");                    

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-17T16:06:28.587

问题是

```
while (!empty($list)) {             
    array_push($genList, $list[0] . "_f", $list[0] . "_b", $list[0] . "_i");                    
} 
```

因为`$list`永远不会为空，从而导致无限循环。PHP 会尝试将越来越多的元素推入`$genList`，直到超过内存限制。

您可能想要删除循环中的元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-17T16:05:16.933

对我来说，这看起来像是一个无限循环。为什么会`$list`永远变得空虚？

```
while (!empty($list)) {             
    array_push($genList, $list[0] . "_f", $list[0] . "_b", $list[0] . "_i");                    
} 
```

因此，您将分配内存，`array_push`直到达到 [256MB] 内存限制。

# c - 在Linux上销毁C中的信号量时如何防止错误？

> ID：12462994
> 
> 赞同：1
> 
> 时间：2012-09-17T16:00:08.570
> 
> 标签：c, linux, semaphore

我正在使用信号量做一个小任务。一旦程序完成，我想销毁信号量，但每次我尝试它都会给我一个错误：“无效参数”。我已经遵循了几个确实有效的示例，但我看不出我在做什么不同。这是我的代码：

```
#include <stdio.h>
#include <unistd.h>
#include <sys/wait.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/sem.h>

void display(char *str) {
  char *tmp;
  for (tmp=str;*tmp;tmp++) {
    write(1,tmp,1);
    usleep(100);
  }
}

int main() {
  struct sembuf up = {0,1,0};
  struct sembuf down = {0,-1,0};
  int i, my_sem;

  my_sem = semget(IPC_PRIVATE, 1, 0600); /*create semaphore*/
  if(my_sem<0){
    perror("Error getting semaphore:");
  }

  if(semop(my_sem, &up, 1)){perror("error changing semaphore:");}; /*set to 1*/

  if (fork()) {
    for (i=0;i<10;i++) {
      if(semop(my_sem, &down, 1)){perror("error changing semaphore:");}; 
      display("Hello world\n");
      if(semop(my_sem, &up, 1)){perror("error changing semaphore:");}; 
    }
    wait(NULL);
  }
  else {
    for (i=0;i<10;i++) {
      if(semop(my_sem, &down, 1)){perror("error changing semaphore:");};
      display("Bonjour monde\n");
      if(semop(my_sem, &up, 1)){perror("error changing semaphore:");}; 
    }
  }

  if(semctl(my_sem,0,IPC_RMID)){perror("error destroying semaphore:");}  /*destroy the semaphore*/

  return 0;
} 
```

这将产生以下输出：

```
Hello world
Bonjour monde
Hello world
Bonjour monde
Hello world
Bonjour monde
Hello world
Bonjour monde
Hello world
Bonjour monde
Hello world
Bonjour monde
Hello world
Bonjour monde
Hello world
Bonjour monde
Hello world
Bonjour monde
Hello world
Bonjour monde
error destroying semaphore:: Invalid argument 
```

谁能告诉我为什么？！

谢谢！

莱纳斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-17T16:12:07.657

这是因为你在两个线程中都破坏了它。第二次尝试失败。`if`将该语句放在`wait`.

# c# - Mini Profiler 与 SqlConnection 集成

> ID：12462996
> 
> 赞同：7
> 
> 时间：2012-09-17T16:00:18.677
> 
> 标签：c#, sql-server, mvc-mini-profiler

我想与[mini profiler](http://miniprofiler.com/)集成的网络表单应用程序中有一个现有的数据库连接功能。我在应用程序上安装并运行了迷你分析器，但我似乎无法正确连接数据库部分。下面是我们连接到数据库的部分代码。

```
public override IEnumerable<IDataRecord> Execute()
{
    using( SqlConnection conn = new SqlConnection( ConnectionString ) ) {
        using( SqlCommand command = new SqlCommand( CommandText, conn ) ) {
            command.CommandType = SQLCommandType;
            foreach( SqlParameter p in ParamsToAdd ) {
                command.Parameters.Add( p );
            }
            conn.Open();
            SqlDataReader rdr;
            try {
                rdr = command.ExecuteReader();
            } catch( Exception ex ) {
                //log error
            }
            using( rdr ) {
                while( rdr.Read() ) {
                    yield return (IDataRecord)rdr;
                }
            }
        }
    }
} 
```

我可以像这样轻松地绕过 ExecuteReader() ：

```
using( MiniProfiler.Current.Step( command.CommandText ) ) {
    rdr = command.ExecuteReader();
} 
```

但这使得迷你分析器与跟踪一样有用，我希望获得网站上显示的查询功能。有什么帮助吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-19T18:36:06.333

您可以尝试使用此代码 - 基于`ProfiledDbConnection`类

```
var connection = MiniProfiler.Data.ProfiledDbConnection.Get(new SqlConnection(str));
var cmd = connection.CreateCommand();
var param = connection.CreateParameter(); 
```

链接：[https ://github.com/ServiceStack/ServiceStack/tree/master/src/ServiceStack/MiniProfiler/Data](https://github.com/ServiceStack/ServiceStack/tree/master/src/ServiceStack/MiniProfiler/Data)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-19T19:39:30.267

@aghilas 的答案是使用其他一些库，但足以指出我以前似乎无法弄清楚的错误。

我最终不得不从使用 SqlConnection 更改为使用 DbConnection，对于 SQLCommand => DbCommand 和 SQLDataReader => DbDataReader 也是如此。这允许 ProfiledDbConnection 正确连接。

```
...
using StackExchange.Profiling;
using StackExchange.Profiling.Data;
...
using( DbConnection conn = new ProfiledDbConnection( new SqlConnection( ConnectionString ), MiniProfiler.Current ) ) {
        using( DbCommand command = conn.CreateCommand() ) {
            command.CommandText = CommandText;
            command.Connection = conn;
            command.CommandType = SQLCommandType;
            foreach( SqlParameter p in ParamsToAdd ) {
                command.Parameters.Add( p );
            }
            conn.Open();
            DbDataReader rdr;
            try {
                rdr = command.ExecuteReader();
            } catch( Exception ex ) {
                //log error
            }
            using( rdr ) {
                while( rdr.Read() ) {
                    yield return (IDataRecord)rdr;
                }
            }
        }
    } 
```

# sql - 如何创建一个新的、不可为空的列，其初始数据将只是从另一列的数据克隆而来？

> ID：12462998
> 
> 赞同：1
> 
> 时间：2012-09-17T16:00:19.787
> 
> 标签：sql, sql-server, sql-server-2008, tsql

假设在 SQL Server 2008 中有一个包含两列的表：id 和 name。现在假设您要在表中添加一个不可为空的列，称为“description”，并且在添加此列的过程中，您希望将name 中的数据用作description 中的原始批次数据。有没有办法直接做到这一点，即不删除表并重新创建它或在添加后手动填充值或其他什么？如果有办法，怎么做？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-17T16:04:12.140

您可以将您所要求的内容作为计算列，但随后您将无法独立修改描述。

您可以做些什么来尽量减少对日志等的影响，将其添加为可为空，然后批量更新值，然后将其更改为不可为空。

```
ALTER TABLE dbo.foo ADD description VARCHAR(whatever) NULL;

SELECT 1;
BEGIN TRANSACTION;

WHILE @@ROWCOUNT > 0
BEGIN
    COMMIT TRANSACTION;
    BEGIN TRANSACTION;

    UPDATE TOP (1000) dbo.foo 
      SET description = name
      WHERE description IS NULL;
END

ALTER TABLE dbo.foo ALTER COLUMN description VARCHAR(whatever) NOT NULL;

COMMIT TRANSACTION; 
```

或者按照 Dems 的建议，将其添加为不可为空的默认值，然后删除默认约束。