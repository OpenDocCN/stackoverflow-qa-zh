# StackOverflow 问答 10843000-10843999

# javascript - .load() 一个网页到一个网站？

> ID：10843005
> 
> 赞同：0
> 
> 时间：2012-06-01T00:29:04.880
> 
> 标签：javascript, jquery, navigation

我正在创建一个站点，其中不同`.load()`的页面由#contentspace 虽然）。我当前的代码没有加载任何内容，我确定我做错了几件事，我只需要知道从哪里开始。我需要为此使用php吗？

```
//load page into contentspace by default?
var defaultpage = "blog.php";
$(document).ready(function() {
$("#contentspace").load(defaultpage);
)}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T00:39:29.917

关闭 $(document).ready `)};`for one 时出现语法错误。正如您在我的演示中看到的那样：http: [//jsfiddle.net/n1ck/NNpqq/9/](http://jsfiddle.net/n1ck/NNpqq/9/)它正在请求`blog.php`文件。

```
//load page into contentspace by default?
var defaultpage = "blog.php";
$(document).ready(function() {
    $("#contentspace").load(defaultpage);
});​ 
```

# authentication - 一个月后，Valence API 返回 http 403

> ID：10843011
> 
> 赞同：0
> 
> 时间：2012-06-01T00:29:44.740
> 
> 标签：authentication, desire2learn

我已经成功使用 D2L Valence API 大约一个月了，但是上周末，所有 API 调用都返回 403 错误。我联系了负责我们 D2L 服务器的支持团队，但他们说周末没有任何变化。他们仍在调查这个问题。我尝试了 3 个具有不同权限设置的不同用户，但都失败了。你知道是什么原因造成的吗？是否有某种垃圾邮件过滤或每小时请求限制？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T00:32:51.523

403 可能有额外的主体来指示更多信息。如果您要保存用户 ID 和用户密钥，则正文可能是“令牌已过期”。这是一个可能的原因，因为某些服务器的有效期为 30 天。

如果您使用的是交互式应用程序，则可以使用带有“Token Expired”的 403 来重新提示用户进行身份验证（如果您使用的是库，它会告诉您需要在 translateResult() 调用中重新验证。）应用程序还需要能够在密码重置的情况下执行此操作，因为重置密码时令牌已过期。

如果您不使用交互式应用程序（或者如果您希望避免重新授权），Desire2Learn 支持可以将令牌到期更新为无限期（您的机构支持团队可以通过 Desire2Learn 支持打开票证以进行更改：d2l.Security.API。 TokenTimeout 应该变为 -1)。

# html - 每个 DOM 元素的 HTML5 数据元素 ID 是否太过分了？

> ID：10843012
> 
> 赞同：0
> 
> 时间：2012-06-01T00:29:45.023
> 
> 标签：html, dom, custom-data-attribute

为了跟踪几乎完全动态的 DOM 布局，我正在考虑使用 HTML5 数据属性来跟踪元素。

在每个 DOM 元素上放置一个会开始影响加载性能，还是会对其他搜索机制产生负面影响，例如`getElementById`or `$(#Selector)`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T03:33:06.167

它不会影响任何其他搜索机制。就负载性能而言，如果您要将其测量到微秒，当然……渲染的标记越多，它就会越慢。如果您谈论的是数据属性，则差异可能可以忽略不计。

# keyboard - Pascal 中的键盘管理

> ID：10843016
> 
> 赞同：2
> 
> 时间：2012-06-01T00:30:18.653
> 
> 标签：keyboard, pascal, freepascal

我是 Pascal 的初学者，我正在开发一个小型 WIngraph 游戏。在游戏的某个时刻，角色（即一个方块）必须躺下（方块得到其原始高度的一半）。我希望在按住向下箭头键时发生这种情况，但我实现它的方式实际上并没有奏效。我遇到的另一个问题是我不知道如何同时读取键（例如，向右跑和跳跃时需要这样做）。

这就是我尝试编写它的方式：

```
procedure joystick;
begin
  key:=readkey;
  case key of 
  #0:begin  
  key:=readkey;  
    case key of  
    #80:with block do  
       begin  
        y1:=y2-100; //make it get half of its height  
        repeat  
         moveblock; //these are the drawing routines.   
         moveball;  //they are in another procedure, which is the 'main loop'   
         collisioncheck;  
         draw;      //i expected the code to run inside here with the block's  
         alternateball; //height changed, and as soon as the arrow key gets released  
         updateGraph(updateNow);  //it should go back to the 'main loop'  
         killball;  
         delay(10);  
        until keypressed = false; //<--thats what i think is not working  
        y1:=y2-200; //this would make the block get normal again  
       end;  
     end;  
   end;      
 end; 
```

我希望代码在按键被按下时运行良好，一旦它被释放，块应该得到它的正常高度，然后程序将根据它的主循环运行，但在这个过程之外。

一切正常，除了那个拿钥匙的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T19:19:05.527

它不起作用，因为在每个之后`keypressed()`你应该有一个`readkey()`. 该函数`keypressed()`返回 true，直到您`readkey()`再次调用。

演示：

```
uses crt;
var c:char;
    i:longint;
begin
while c<>#27 do
  begin
  while not keypressed() do
    begin
    clrscr;
    writeln('not pressing anything');
    delay(500);
    end;
  i:=0;
  while keypressed() do
    begin
    clrscr;
    c:=readkey();
    if(c=#0) then
      c:=readkey();
    inc(i);
    writeln(c,' ',i);
    delay(300);
    end;
  end
end. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-02T10:01:41.030

如果你使用 freepascal/Lazarus：

*   不要将 unit *crt*与 wingraph 一起使用，而是使用*wincrt*。Wingraph 挂钩到 win32 GUI 事件，而 (win32) crt 通过控制台 API 调用挂钩到作品。Wincrt 挂钩到 GUI（消息泵）事件。
*   最好不要使用 *crt，但**最好使用单位键盘**
*   看看 Free Pascal 示例，它包含几个小游戏（**俄罗斯方块**和相同游戏实现），它们也可以选择使用 wingraph 和单位键盘。甚至还有一些用于高分的单元，以及在键盘和 wingraph 之上的简单行编辑程序。

下次，请提供有关您使用的开发平台（和版本）的更准确的详细信息。

# java - JasperReports 神秘的获取价值

> ID：10843018
> 
> 赞同：0
> 
> 时间：2012-06-01T00:30:30.450
> 
> 标签：java, jasper-reports, ireport

JasperReports/iReport 有一个非常烦人的错误。我最近从 3.6.1 版本升级到 4.5.1 版本，它仍然存在。

`DataSource`我有一份报告，它通过执行存储过程的 jdbc 从 MS SQL 服务器数据库中提取一些信息。问题是我得到的随机数据行只有一个值，如下所示：

```
ID    Name        Marketing_Preferences
1     John        Y
2     James       N
3     Daniel      Y
                  Y
4     Tim         N 
```

我一遍又一遍地查看原始数据，执行此操作的行没有什么不同或特别之处。

相关的 iReport xml 定义为：

```
<field name="Marketing_Preferences" class="java.lang.String"/>

<staticText>
    <reportElement isPrintRepeatedValues="false" x="504" y="41" width="101" height="15" isPrintWhenDetailOverflows="true">
        <printWhenExpression><![CDATA[new Boolean( $V{PAGE_NUMBER}.intValue() == 1 )]]></printWhenExpression>
    </reportElement>
    <textElement>
        <font size="9"/>
    </textElement>
    <text><![CDATA[Marketing_Preferences]]></text>
</staticText>

<textField isBlankWhenNull="true">
    <reportElement x="504" y="3" width="101" height="15" isPrintWhenDetailOverflows="true"/>
    <textElement>
        <font size="8"/>
    </textElement>
    <textFieldExpression><![CDATA[$F{Marketing_Preferences}]]></textFieldExpression>
</textField> 
```

通过反复试验并使用条件打印表达式，我发现双倍向上绑定到一个输出行，所以如果我告诉`Marketing_Preferences`不打印，`ID = 3`那么两个值都不会打印。

首先，有谁知道这会如何发生或为什么会发生？正如我所说，我已经多次检查原始数据，找不到任何原因，运行存储过程根本不会产生上述情况。

其次，有谁知道我可以解决它的方法吗？如果 iReport 认为它是一个列表，或者限制为每个结果仅一行，则可以通过某种方式告诉 iReport 不要打印下一个值。我不能使用“打印重复值”，因为这不会打印有效的重复值。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T01:05:49.390

我认为这是因为你有你的`Marketing_Preferences`文本字段`isPrintWhenDetailOverflows="true"`

这是来自的 javadoc`JRElement`

> isPrintWhenDetailOverflows() 如果设置为 true，则如果带不适合当前页面，则元素将在下一页重新打印。

# opengl - OpenGL程序用完所有内存然后关闭

> ID：10843020
> 
> 赞同：-2
> 
> 时间：2012-06-01T00:31:15.840
> 
> 标签：opengl

我制作了一个用 OpenGL 编写的程序，当我运行它时，程序会填满所有的 ram，然后在大约 3300/4000 Mb 的 ram 处关闭。这是我的程序：

```
#include <iostream>
#include <stdlib.h>
#include <fstream>
#include <windows.h>
#include <gl/gl.h>
#include <gl/glut.h>
#include <gl/GLU.h>
#include <gl/glaux.h>

using namespace std;

GLuint texture;

AUX_RGBImageRec* LoadImage (char* file) {

return auxDIBImageLoad (file);
}

int LoadTexture (char* file) {
AUX_RGBImageRec* Textureimage;

Textureimage = LoadImage (file);
glGenTextures (1, &texture);
glBindTexture (GL_TEXTURE_2D, texture);
glTexImage2D (GL_TEXTURE_2D,
0,
GL_RGB,
Textureimage->sizeX,
Textureimage->sizeY,
0,
GL_RGB,
GL_UNSIGNED_BYTE,
Textureimage->data
);
glTexParameteri (GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameteri (GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
delete Textureimage;
return 0;
}

void exitkey (unsigned char key, int x, int y) {
switch (key) {
case 27:
exit (0);
}
}

void Render3d () {
glEnable (GL_DEPTH_TEST);

glEnable (GL_NORMALIZE);

glEnable (GL_LIGHTING);

glEnable (GL_LIGHT0);

glEnable (GL_LIGHT1);

glEnable (GL_TEXTURE_2D);

}

void incaseofresize (int w, int h) {
glViewport (0, 0, w, h);
glMatrixMode (GL_PROJECTION);
glLoadIdentity ();
gluPerspective (90.0, (double)w / (double)h, 0.7, 300.0);
}

double theangle = 30.0;

void draw () {
glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
glMatrixMode (GL_MODELVIEW);
glLoadIdentity ();
glTranslatef (0.0, 0.0, -6.0);
glPushMatrix ();

glRotatef (theangle, 0.0, 1.0, 0.0); 

GLfloat ambientlightcolor [] = { 0.0, 0.0, 0.0, 1.0 };
GLfloat light0color [] = { 0.5, 0.5, 0.0, 1.0 };
GLfloat light1color [] = { 1.0, 0.0, 0.0, 1.0 };
GLfloat light0position [] = { 2.0, 0.0, 3.0, 1.0 };
GLfloat light1position [] = { -2.0, 0.0, 3.0, 1.0 };

glLightModelfv (GL_LIGHT_MODEL_AMBIENT, ambientlightcolor);
glLightfv (GL_LIGHT0, GL_DIFFUSE, light0color);
glLightfv (GL_LIGHT0, GL_POSITION, light0position);
glLightfv (GL_LIGHT1, GL_DIFFUSE, light1color);
glLightfv (GL_LIGHT1, GL_POSITION, light1position);

LoadTexture ("me.bmp");

glBegin (GL_QUADS);
//Drawing shape
glColor3f (1.0, 1.0, 1.0);
//Left side
glNormal3f (0.0, 0.0, 1.0);
glTexCoord2f (0.0, 0.0);
glVertex3f (-1.5, -1.0, -1.5);
glTexCoord2f (1.0, 0.0);
glVertex3f (0.0, -1.0, 1.5);
glTexCoord2f (1.0, 1.0);
glVertex3f (0.0, 1.0, 1.5);
glTexCoord2f (0.0, 1.0);
glVertex3f (-1.5, 1.0, -1.5);

glEnd ();

LoadTexture ("mom.bmp");

glBegin(GL_QUADS);

//Right side
glNormal3f (0.0, 1.0, 1.0);
glTexCoord2f (0.0, 0.0);
glVertex3f (0.0, -1.0, 1.5);
glTexCoord2f (1.0, 0.0);
glVertex3f (1.5, -1.0, -1.5);
glTexCoord2f (1.0, 1.0);
glVertex3f (1.5, 1.0, -1.5);
glTexCoord2f (0.0, 1.0);
glVertex3f (0.0, 1.0, 1.5);

glEnd ();

glBegin (GL_QUADS);

//Back right side
glNormal3f (0.0, 1.0, 0.0);
glVertex3f (1.5, -1.0, -1.5);
glVertex3f (0.0, -1.0, -4.5);
glVertex3f (0.0, 1.0, -4.5);
glVertex3f (1.5, 1.0, -1.5);
glEnd ();

glBegin (GL_QUADS);

glNormal3f (0.0, 1.0, 0.0);
glVertex3f (0.0, -1.0, -4.5);
glVertex3f (-1.5, -1.0, -1.5);
glVertex3f (-1.5, 1.0, -1.5);
glVertex3f (0.0, 1.0, -4.5);

glEnd ();

glutSwapBuffers ();
}

void rotate (int value) {
theangle += 1.5;
if (theangle > 360) {
theangle -=360;
}
glutPostRedisplay ();
glutTimerFunc (50, rotate, 0);
}

int main (int argcpp, char** argv) {
glutInit (&argcpp, argv);
glutInitDisplayMode (GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH);
glutInitWindowSize (720, 480);

glutCreateWindow ("OpenGL");
Render3d ();

glutDisplayFunc (draw);
glutKeyboardFunc (exitkey);
glutReshapeFunc (incaseofresize);
glutTimerFunc (50, rotate, 0);

glutMainLoop ();

return 0; 
```

}

我认为它的 LoadTexture 函数会在每个循环中一遍又一遍地重新加载图像，我找不到在每个循环后删除图像数据的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T00:58:43.107

每次您的程序迭代显示函数时，它都会将图像加载到新的纹理对象中，而不是释放先前创建的对象。

规范的方法是只加载*一次*纹理。OpenGL 在所谓的纹理对象中组织纹理，由所谓的名称 ID 标识。LoadTexture 确实返回此 ID。您通过调用使用这样的纹理`glBindTexture(GL_TEXTURE_2D, theTextureID);`

# jquery - MySQL 或 jQuery 来执行这些计算？

> ID：10843023
> 
> 赞同：0
> 
> 时间：2012-06-01T00:32:16.863
> 
> 标签：jquery, mysql

让我先说我对 mysql / php / jquery 非常陌生，这是我从头开始创建的第一个应用程序。这不是最严格的代码，但对我来说是一个起点。话虽如此...

我一直在为梦幻足球网站开发数据库应用程序。管理员输入球员并每周更新统计数据。在前端，用户可以查看和排序结果。很容易。

[http://digitaldemo.net/kickass/projections-table.php](http://digitaldemo.net/kickass/projections-table.php)是当前状态的链接。它不完整，但我想要一个在线的工作示例供您查看。我正在使用 Jquery 的 tablesorter 进行排序功能。

接下来需要发生的事情，这就是让我撕心裂肺的原因，页面需要使用默认公式加载（例如，每 10 码通过 2 分，每通过 TD 6 分，等等......以及总数将被加载到每个玩家的 TFP 列中。

此外，用户将能够使用上面 URL 的 QB 选项卡上的（当前非功能性的）下拉框更改点值和增量，然后单击按钮并重新计算 TFP 分数。

使用 jquery 或 mysql 更容易做到这一点以及如何做到这一点？我看了几十个教程，我所做的只是让自己感到沮丧。我知道如果我可以让它为 QB 选项卡工作，我可以将它推断到其他选项卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T00:45:10.297

通常，您希望在最高级别进行计算，并且仍然获得所需的功能/安全性：客户端 > 服务器 > 数据库。这听起来像是您可以使用 javascript/jQuery 在客户端中执行的操作，所以我将从那里开始。

如果您对如何自己进行计算有更具体的问题，我会用一个具体的例子和数据提出另一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T00:51:00.203

如果你可以使用 javascript 计算它，然后使用客户端计算（Javascript/jQuery），它会更快，你也可以节省很多内存。:)

干杯!

# iphone - 在 NSString 中保存字符串格式说明符（%@、%d 等）以供将来占位符使用？

> ID：10843028
> 
> 赞同：2
> 
> 时间：2012-06-01T00:33:15.583
> 
> 标签：iphone, objective-c, macos, cocoa

我有一个长字符串，我想从 URL 中检索并在应用启动时存储。稍后，我想将单个值插入该字符串。

我想做这样的事情：

```
NSString *numberLine = @"1 %@ 3 %@ 5 %@";

//... (later) ...

NSString *final = [NSString stringWithFormat:numberLine, @"two", @"four", @"six"]; 

NSLog(@"%@", final); //Should output "1 two 3 four 5 six" 
```

我希望`@"two"`将 插入到`%@`之前保存到`numberLine`.

有没有一种好方法来完成这样的事情？

到目前为止，我唯一的想法是做类似的事情：

```
NSString *script = @"width = PLACEHOLDERpx";
script = [script stringByReplacingOccurrencesOfString:@"PLACEHOLDER" withString:@"12"]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T00:47:59.123

你所描述的是一个模板。您希望将占位符留在将用数据填充的字符串中。虽然您可以通过字符串使用 %@ 和 %d ，但随着字符串变得越来越复杂，这会变得很困难。您可能想要使用像[Mustache](http://mustache.github.com/)之类的模板库for [Objective-C](https://github.com/groue/GRMustache)。这将使您可以编写如下表达式：

```
Hello {{SomeVariable}} 
```

您所要做的就是传入`NSDictionary`与您要呈现的数据相对应的 with 键。因此，对于上面的示例，您可以执行以下操作：

```
NSString *result = [GRMustacheTemplate renderObject:[NSDictionary dictionaryWithObject:@"World" forKey:@"SomeVariable"];
                                         fromString:@"Hello {{SomeVariable}}"
                                              error:NULL]; 
```

这将产生一个`result`字符串`Hello World`。

# delphi - 谷歌地图非网络访问

> ID：10843029
> 
> 赞同：7
> 
> 时间：2012-06-01T00:33:34.133
> 
> 标签：delphi, google-maps

我需要能够从非 Web 应用程序访问 Google Maps API。我在 Google 地图的常见问题解答中看到这是可能的。但是，我找不到任何关于从基于 PC 的应用程序访问 API 的参考。有人可以指出我正确的方向吗？

（如果有帮助，我想从 Delphi 应用程序访问 API。）

提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-06-01T03:57:16.583

前段时间我写了一系列关于使用 Delphi 的 Google maps API v3 的文章，基本上你需要一个[TWebBrowser](http://docwiki.embarcadero.com/Libraries/en/SHDocVw.TWebBrowser)组件并使用 JavaScript 代码加载一个 HTML 页面来处理[`Google Maps JavaScript API v3`](https://developers.google.com/maps/documentation/javascript/). 从这里使用[IHTMLWindow2.execScript](http://msdn.microsoft.com/en-us/library/aa741364%28v=vs.85%29.aspx)和[MSHTML 接口](http://msdn.microsoft.com/en-us/library/hh801967%28v=vs.85%29)等函数，您可以与来自 Delphi 的 JavaScript 代码和 Google Maps API 响应进行交互。

*   [使用 Delphi 的 Google Maps API V3 – 第一部分 基本功能](http://theroadtodelphi.wordpress.com/2010/08/07/using-the-google-maps-api-v3-from-delphi-part-i-basic-functionality/)
*   [使用 Delphi 的 Google Maps API V3 – Part II Styled Maps](http://theroadtodelphi.wordpress.com/2010/08/09/using-the-google-maps-api-v3-from-delphi-part-ii-styled-maps/)
*   [使用 Delphi 的 Google Maps API V3 – Part III 获取鼠标点击的纬度和经度](http://theroadtodelphi.wordpress.com/2011/06/24/using-the-google-maps-api-v3-from-delphi-%E2%80%93-part-iii-getting-the-latitude-and-longitude-of-a-mouse-click/)
*   [在没有 TWebBrowser 的情况下使用 Google 地图（静态地图）](http://theroadtodelphi.wordpress.com/2010/08/11/using-google-maps-static-maps-without-twebbrowser/)

也看看这些项目

*   [德尔菲地图](http://code.google.com/p/delphimaps/)
*   [GMLib – 谷歌地图库](http://www.cadetill.com/?page_id=365)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-08T09:12:34.693

如果您正在寻找在 Delphi 中使用 Google Maps API 的完整解决方案，我强烈推荐**Delphi Framework for Google Maps**。它**无需**一行**HTML**或**JavaScript即可使用****所有**API 函数。

 ******例如：

```
procedure TForm1.FormShow(Sender: TObject);
begin
  with Script(WebBrowser1) do
    if not APILoaded
      then LoadAPIAsync(InitMap);
end;

procedure TForm1.InitMap(Sender: TObject);
var
  MapOptions: TMapOptions;
begin
  with Sender as TScript do
  begin
    MapOptions:=New(Google.Maps.MapOptions);
    with MapOptions do
    begin
      Zoom:=8;
      Center:=New(Google.Maps.LatLng(-34.397,150.644));
      MapTypeID:=Google.Maps.MapTypeID.Roadmap;
    end;
    New(Google.Maps.Map(MapOptions));
  end;
end; 
```

路线规划器也很容易获得。有一些演示。

不幸的是，您目前仍必须从[德国论坛](http://www.delphipraxis.net/157004-google-maps-ueber-com-component-object-model.html)下载它。一个单独的网站正在建设中。如果注册或下载有问题，我可以发送一封包含框架的电子邮件。

问候

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-06-01T07:52:12.087

如果您在这方面有认真的计划：
**忘掉 Google Maps API，改用[OpenLayers](http://www.openlayers.org)。**

相信我，我有这方面的实践经验。我创建了无数交互式地图网站和应用程序，并且我编写了将 Google 地图功能包装到 Delphi 组件中的代码。您可以在 Google 代码上找到它们：[http ://code.google.com/p/delphimaps/](http://code.google.com/p/delphimaps/)

您还可以在此处找到我使用这些组件的早期版本制作的一些示例应用程序：[使用我的 Delphi 应用程序中的 Googlemap？](https://stackoverflow.com/questions/558686/use-googlemap-from-my-delphi-application/559725#559725)

OpenLayers 更加通用，它是完全开源的，并且它背后有一个完整的社区。它甚至可以使用 Google Maps，但您可以轻松切换到 OpenStreetMaps、Yahoo、Bing 或您自己的 GIS 系统。

网上有很多例子，你不受谷歌强加的愚蠢规则的束缚。例如，如果您想通过安全 (HTTPS) 连接使用 Google 地图，则必须付费。我再也没有直接使用 Google Maps API，而且自从我开始使用 OpenLayers 以来，我的 GIS 网站变得更好了。

也许有一天我应该将 OpenLayers 包装到 Delphi 组件中，但我现在用 JavaScript 做大部分事情，并且只在真正需要时与我的 Delphi 应用程序通信，所以即使使用包含地图的 Delphi 应用程序，也没有太多的 GIS 工作在德尔福。事实证明，这更容易维护。

..

此外，OpenLayers 不需要任何互联网连接。它可以在您的离线浏览器中 100% 运行。谷歌地图要求你有互联网连接，因为它会动态下载部分代码，并且总是想从谷歌下载地图。******

# xml - 如何修复 XSLT 中的这种消除转换？

> ID：10843032
> 
> 赞同：0
> 
> 时间：2012-06-01T00:35:13.003
> 
> 标签：xml, xslt

我有这个输入：

```
<root>
    <sector>
        <nodeA id="a">
            <section id="i">
                <item1 id="1" method="delete"/>

                <item1 id="1" method="create"> 
                    <somechild>a</somechild>
                </item1>
                <item1 id="1" method="change"> 
                    <somechild>a</somechild>
                </item1>
            </section>
            <section id="i">
                <item1 id="1" method="change"> 
                    <somechild>a</somechild>
                </item1>
            </section>
            <section id="i">
                <item1 id="1" method="delete"/>
                <item1 id="1" method="create">
                    <somechild>a</somechild>
                </item1>
            </section>
        </nodeA>
    </sector> 
</root> 
```

我的 XSL 是：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="*[not(.//*[@id!=''])][@method='delete']">
        <xsl:if test="not(following::*[not(.//*[@id!=''])][@id=current()/@id][../@id = current()/../@id][generate-id(../..) = generate-id(current()/../..)])"/>       
    </xsl:template>    

    <xsl:template match="*[not(.//*[@id!=''])][@method!='delete']">
        <xsl:if test="not(following::*[not(.//*[@id!=''])][@method='delete'][@id=current()/@id][../@id = current()/../@id][generate-id(../..) = generate-id(current()/../..)])"/>
    </xsl:template>    

    <xsl:template match="@*|node()" name="identity">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

我的输出：

```
<root>
    <sector>
        <nodeA id="a">
            <section id="i">
            </section>
            <section id="i">
            </section>
            <section id="i">
            </section>
        </nodeA>
    </sector>
</root> 
```

**预期输出：**

```
<root>
    <sector>
        <nodeA id="a">
            <section id="i">
                <item1 id="1" method="delete"/> <!-- leave this node -->
            </section>
            <section id="i">
            </section>
            <section id="i">
                <item1 id="1" method="create"> <!-- leave this node -->
                    <somechild>a</somechild>
                </item1>
            </section>
        </nodeA>
    </sector> 
</root> 
```

这个想法是我想**删除**元素节点的组合

*   **一种**方法创建，然后是**一种或多种**修改，然后是**一种**删除方法，其余的保持不变。
*   例如，它必须是相同的元素名称，`<item1>`并且`@id`在相同的父级下`<section id=1>`。

任何人都可以帮助我进行转型吗？

谢谢。约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T08:53:54.670

好吧，这并不容易，但它适用于 xslt 1.0！

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    version="1.0">
<!--
    copies all nodes with id
    if there first preceding delete followed by the first preceding create
    -->
    <xsl:template match="*[not(.//*[@id!=''])]">
        <xsl:variable name="id" select="@id"/>
        <xsl:variable name="parentId" select="../@id"/>
        <xsl:variable name="precedings" select="preceding::*[@id=$id][../@id=$parentId]"/>
        <xsl:variable name="lastDelete" select="($precedings[@method='delete'])[last()]"/>
        <xsl:variable name="lastCreate" select="($precedings[@method='create'])[last()]"/>
        <xsl:variable name="openCreate" select="$lastDelete[following::* = $lastCreate] or (not($lastDelete) and $lastCreate)"/>
        <xsl:if test="not(following::*[@id=$id][../@id=$parentId][@method='delete'] and $openCreate)">
            <xsl:copy>
                <xsl:apply-templates select="@*"/>
                <xsl:apply-templates select="node()"/>
            </xsl:copy>
        </xsl:if>
    </xsl:template>

    <!--
    copies all deletes, if they have no preceding creates
    -->
    <xsl:template match="*[not(.//*[@id!=''])][@method='delete']" priority="10">
        <xsl:variable name="id" select="@id"/>
        <xsl:variable name="parentId" select="../@id"/>
        <xsl:variable name="precedings" select="preceding::*[@id=$id][../@id=$parentId]"/>
        <xsl:variable name="precCreate" select="$precedings[@method='create']"/>
        <xsl:if test="not($precCreate)">
            <xsl:copy>
                <xsl:apply-templates select="@*"/>
                <xsl:apply-templates select="node()"/>
            </xsl:copy>
        </xsl:if>
    </xsl:template>

<!--
    copies all creates, if they have no following deletes
    -->

    <xsl:template match="*[not(.//*[@id!=''])][@method='create']" priority="10">
        <xsl:variable name="id" select="@id"/>
        <xsl:variable name="parentId" select="../@id"/>
        <xsl:variable name="followings" select="following::*[@id=$id][../@id=$parentId]"/>
        <xsl:variable name="followDelete" select="$followings[@method='delete']"/>
        <xsl:if test="not($followDelete)">
            <xsl:copy>
                <xsl:apply-templates select="@*"/>
                <xsl:apply-templates select="node()"/>
            </xsl:copy>
        </xsl:if>
    </xsl:template>

    <!--
        copies all nodes
    -->
    <xsl:template match="node() | @*">
        <xsl:copy>
            <xsl:apply-templates select="@*"/>
            <xsl:apply-templates select="node()"/>
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

测试它...没有保证！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:36:40.273

约翰，我有一个你可能喜欢也可能不喜欢的解决方案。我做了一个“优化”来简化一些事情。我认为，由于您将这些`section`节点`@id`视为相同的*相同*，您可能不介意在结果文档中看到它们全部合并为一个。看看这是否可以接受。

以下**XSLT 2.0**转换：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes"/>

    <xsl:template match="@*|node()" name="identity">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="nodeA">
        <xsl:copy>
            <xsl:apply-templates select="@*"/>
            <xsl:for-each-group select="*" group-by="concat(name(), '|', @id)">
                <xsl:copy>
                    <xsl:apply-templates select="@*"/>
                    <xsl:variable name="merged">
                        <xsl:for-each-group select="current-group()/*"
                                            group-by="concat(name(), '|', @id)">
                            <xsl:copy-of select="current-group()"/>
                        </xsl:for-each-group>
                    </xsl:variable>
                    <xsl:apply-templates select="$merged/*"/>
                </xsl:copy>
            </xsl:for-each-group>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="*[@method = 'create']
                          [following-sibling::*[@method = 'change']
                                               [following-sibling::*[@method = 'delete']]]"/>
    <xsl:template match="*[@method = 'change']
                          [preceding-sibling::*[@method = 'create']]
                          [following-sibling::*[@method = 'delete']]"/>

    <xsl:template match="*[@method = 'delete']
                          [preceding-sibling::*[@method = 'change']
                                               [preceding-sibling::*[@method = 'create']]]"/>

</xsl:stylesheet> 
```

当应用于您的输入文档时会产生：

```
<root>
    <sector>
      <nodeA id="a">
         <section id="i">
            <item1 id="1" method="delete"/>
            <item1 id="1" method="create">
                    <somechild>a</somechild>
                </item1>
         </section>
      </nodeA>
    </sector>
</root> 
```

我认为将这些`item1`节点折叠成一个扁平的有序列表会更容易，然后才过滤掉你想要删除的序列。我必须将它们复制到一个变量中以从原始文档树中“分离”，否则这些`sibling`轴将在原始父节点中查找。一旦你有一个来自“相同”父节点的“相同”节点的平面列表`item1`，过滤创建-更改-删除序列真的是小菜一碟。我刚刚将您的规则直接翻译成 XPath 谓词 - 一个表示`create`后跟`change`a `delete`，另一个表示`change`before`create`和后跟 a `delete`，最后一个表示`delete`beforeed `change`by `create`。他们都是“已知的”`name()``@id`并且来自同一个 (`name()`和`@id`) 父级，因此我们不必检查该部分。

# php - 显示更多按钮，带有变量的 div id

> ID：10843035
> 
> 赞同：0
> 
> 时间：2012-06-01T00:35:33.670
> 
> 标签：php, javascript, ajax, html

我正在制作一个小脚本，在显示 10 个条目的最后一个显示更多按钮。这是代码

```
<div id="more<?=$lastid;?>">
   <a onclick="showmore(<?=$lastid;?>);">More</a>
</div> 
```

脚本是

```
function showmore(lastid) {

    $.post("/ajax/showmore.php", {
        lastid: lastid,

    }, function(response) {
        $("#more" + lastid).show();
        setTimeout("finishAjax('more' + lastid, '" + escape(response) + "')", 300);
    });

    return false;
}

function finishAjax(a, b) {
    $("#" + a).html(unescape(b));
    $("#" + a).fadeIn(1e3)
}​ 
```

但脚本不起作用？这里有什么问题 ？

我用恒定的 div id 测试了脚本，它运行良好，但是当我为 div 添加 $lastid 并在脚本端添加 $("#more" + lastid) 时，它不起作用

任何想法使 DIV ID 可变？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T00:45:42.293

而不是将 id 附加到更多，这有点难看，为什么不给 div 一个“更多”类

```
 <div id="<?=$lastid;?>" class="more">
       <a onclick="showmore(<?=$lastid;?>);" >More</a>
  </div> 
```

那么你的 jquery 选择器可以是这样的：

```
 $("div.more#" + id).show() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T00:50:02.883

您在 setTimeout() 的字符串中引用 lastid。你应该使用闭包来解决这个问题。然而，这是一个干净的版本：

```
function showmore(lastid) {
    $.post("/ajax/showmore.php",
        { lastid:lastid },
        resultHandler);

    return false;

    function resultHandler(response) {
        $("#more" + lastid).html(response).fadeIn(1e3);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T00:54:38.683

谢谢你们

我发现了错误

它在这条线上

```
 setTimeout("finishAjax('more' + lastid, '"+escape(response)+"')", 300); 
```

我将其更正为

```
 setTimeout("finishAjax('more"+lastid+"', '"+escape(response)+"')", 300); 
```

感谢您的回答

# php - android模拟器是否能够将文件上传到服务器

> ID：10843038
> 
> 赞同：0
> 
> 时间：2012-06-01T00:36:31.427
> 
> 标签：php, android, file-upload, emulation

我在任何地方都找不到这个。android 模拟器是否能够将文件上传到网络服务器？我在过去一个小时左右一直在测试，只是意识到这甚至不可能。有人知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T00:45:08.630

是的，有可能。发布代码有点复杂，但基本上你会使用 File 类来查找要上传的文件，然后使用 apache HttpClient 库进行多格式发布。现在，如果您认为它不起作用，因为您不知道用户将使用什么界面来查找文件。有一种方法可以发送 Intent 打开文件。

[发送一个 Intent 让用户在 Android 上选择一个文件](https://stackoverflow.com/questions/5322915/send-an-intent-for-the-user-to-select-a-file-on-android)

但剩下的只是编写代码来执行上传。

# javascript - 评估是我唯一的选择吗？

> ID：10843047
> 
> 赞同：0
> 
> 时间：2012-06-01T00:38:24.340
> 
> 标签：javascript

我想知道 Eval() 是否是我在服务器上调用脚本并在这些文件上执行 javascript 时真正拥有的唯一选项。

我在每个地方都看到了 Eval 的安全问题，人们不推荐它——那么有什么安全的方法可以用 javascript 请求文件并执行那个 JS 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T00:40:47.840

我在 asp.net mcv3 Web 应用程序中广泛执行此操作，以使用[jQuery.load()动态加载脚本化的部分视图](http://api.jquery.com/load/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T00:40:49.193

只需将脚本写入页面即可。然后客户端的浏览器会为你做这件事，你几乎可以忽略它的安全方面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T00:41:08.623

不，您不必评估，但如果您相信输入，这样做是可以的。最好只传输数据而不是运行代码。

您可以动态创建脚本标签：

```
var script = document.createElement('script');
script.src = 'path/to/javascript/to/run';
document.body.appendChild(script); 
```

# android - 旋转android手机时如何处理webview的输入字段？

> ID：10843048
> 
> 赞同：2
> 
> 时间：2012-06-01T00:38:24.587
> 
> 标签：android, webview, lifecycle

我有一个显示 Web 登录页面的应用程序，我使用 WebView 来完成它。用户输入一些用户名/密码文本后，当用户旋转手机时，活动将重新创建，用户名/密码消失，用户必须重新输入。

有没有办法可以为用户保留输入文本。

顺便说一句，我发现浏览器可以优雅地处理这种情况。

# javascript - 有没有办法只使用子指令作为占位符来保存内容？

> ID：10843052
> 
> 赞同：1
> 
> 时间：2012-06-01T00:38:58.447
> 
> 标签：javascript, angularjs

我是 angularjs 的新手。想看看是否有任何方法可以只使用子指令作为占位符来保存内容但真正呈现？

我不想在子指令中进行渲染，因为我想让父母做所有事情。所以我可以在父指令中有一些其他的特殊逻辑。

```
angular.module('components', []).
directive('tabs', function() {
  return {
    restrict: 'E',
    transclude: true,
    scope: {},
    controller: function($scope, $element) {
      var panes = $scope.panes = [];

      $scope.select = function(pane) {
        angular.forEach(panes, function(pane) {
          pane.selected = false;
        });
        pane.selected = true;
      }

      $scope.createPane = function() {
        var pane = panes[panes.length - 1];
        var clonedPane = Angular.copy(pane);
        panes.push(clonedPane);
      }

      this.addPane = function(pane) {
        if (panes.length == 0) $scope.select(pane);
        panes.push(pane);
      }
    },
    template: '<div class="tabbable tabs-left">' +
      '<ul class="nav nav-tabs">' +
      '<li ng-repeat="pane in panes" ng-class="{active:pane.selected}">' +
      '<a href="" ng-click="select(pane)">{{pane.title}}</a>' +
      '</li>' +
      '<li ng-class="addLink"><a ng-click="createPane()"><i class="icon-plus"></i> tab</a></li>' +
      '</ul>' +
      '<div class="tab-content">' +
      '<div ng-repeat="pane in panes" class="tab-pane" ng-class="{active: selected},{{pane.pclass}}" id="{{pane.id}}">' +
      '{{ pane.content }}' +
      '</div>' +
      '</div>' +
      '</div>',
    replace: true
  };
}).
directive('pane', function() {
  return {
    require: '^tabs',
    restrict: 'E',
    scope: {
      title: 'bind',
      pclass: 'bind',
      id: 'bind'
    },
    link: function(scope, element, attrs, tabsCtrl) {
      var text = element.text();
      tabsCtrl.addPane({
        title: scope.title,
        pclass: scope.pclass,
        id: scope.id,
        content: text
      });
    }
  };
}) 
```

*对应的html代码：*

```
<tabs>
  <pane title="tab 1" id="tab1" pclass="tab">
    hello
  </pane>
  <pane title="tab 2" id="tab2" pclass="tab">
    world
  </pane>
</tabs> 
```

我尝试了类似上面的方法，但没有任何东西被推入窗格。似乎永远不会调用子指令（窗格）的链接函数。因此，仅显示添加选项卡的链接。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-02T03:20:40.540

解决这个问题的最简单（虽然有点烦人）的方法是为每个窗格设置一个模板。

在 html 中：

```
<tabs>
  <pane title="tab 1" id="tab1" pclass="tab" template="pane1-templ">
  </pane>
  <pane title="tab 2" id="tab2" pclass="tab" template="pane2-templ">
  </pane>
</tabs>
<script type="text/ng-template" src="pane1-template">hello</script>
<script type="text/ng-template" src="pane2-template>wolrd</script> 
```

在您的指令中：

```
'<div class="tab-content">' + 
    '<div ng-repeat="pane in panes" class="tab-pane" ng-class="{active: selected},{{pane.pclass}}" id="{{pane.id}}">' + 
         '<div ng-include src="pane.template"></div>' +
    '</div>' +
'</div>' 
```

或者..您是否尝试过这样做来解决它？

在窗格中：

```
var html = elm.html();
//...
pane.html = html; 
```

在选项卡中：

```
<div ng-bind-html-unsafe="pane.html"></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T09:48:32.047

也许它不起作用的原因是因为在您的子指令中您没有模板。没有模板，指令不知道在哪里以及如何呈现指令。

你可以做的是有这样的事情：

```
template : '<div style="display:none;" ng-transclude></div>' 
```

在您的子模板中..

你`element.text()`应该仍然可以工作！

如果没有模板，链接函数将永远无法获得，`element`因此您的子指令将在那里失败。

使用上面的模板应该可以工作。

# grails - 无法将 java jar 文件导入 STS Grails 项目

> ID：10843054
> 
> 赞同：3
> 
> 时间：2012-06-01T00:39:25.307
> 
> 标签：grails, groovy, jar

我已经建立了一个新的基本 grails 项目。我有一个基本的 java 对象，我在 grails 之外编写了一个，并且很不爽。我已经将 jar 文件添加到 grails 项目中，通过**`properties > Java build path > Libraries tab > Add Jars`**.

然后我尝试在 grails 控制器中访问它，并得到一个*class def not found error*。

我究竟做错了什么？

* * *

**测试控制器.groovy**

```
package testproject

import test.TestClass

class TestController {
    def index() { 
        def testClass = new TestClass()
        render 'Index page'
    }
} 
```

和：

在罐子里，**TestClass.java**

```
package test;

public class TestClass {
    private String string;

    public void setString(String string)
    {
        this.string = string;
    }

    public String getString()
    {
        return string;
    }
} 
```

* * *

错误是：

> C:\Users\One\TestProject\grails-app\controllers\testproject\TestController.groov y: 3: 无法解析类 test.TestClass @ line 3, column 1\. import test.TestClass

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T01:12:56.783

从 Grails 类路径生成的 STS 类路径，但它是单向的。在 STS 中添加项目对 Grails 没有影响。

将 jar 文件放入您的 lib 目录并运行`grails compile --refresh-dependencies`. 然后通过右键单击树中的项目节点并运行 Grails Tools | 从 Grails 重新同步 STS。刷新依赖。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:04:01.530

您仍然需要在 Grails 控制器中导入它。

```
import your.java.ClassName 
```

# vim - Vim 代码调试器建议（逐步执行等）

> ID：10843057
> 
> 赞同：1
> 
> 时间：2012-06-01T00:39:53.220
> 
> 标签：vim, gdb

我是一个相当新的 Web 开发人员，我的大部分工作都是在 JavaScript / CSS 中完成的，但我很快就会在 PHP 中工作，我想在调试软件方面抢占先机。

我选择的编辑器是 Vim，所以我正在寻找调试器工作流程的建议，无论是 Vim 插件还是单独的程序，最好是可以匹配 Eclipse 或 Visual Studio 的功能集的东西，但如果不存在我想知道。

我在网上找到了几个 Vim 插件：
- [VimDebug](http://www.vim.org/scripts/script.php?script_id=663 "Vim调试")看起来不错，但只支持 Python、Perl 和 Ruby。
- [vdb](http://www.vim.org/scripts/script.php?script_id=1703 "虚拟数据库")看起来很有希望但也令人困惑（至少对我来说）
- [VimDebugger](https://github.com/taxilian/VimDebugger "Vim调试器")处于早期阶段

我还找到了[gdb](http://sources.redhat.com/gdb/ "GNU 项目调试器")，这是我找到的唯一非 IDE 调试工具（如果有人找到其他工具，我很想听听他们的消息！），还有[vim-debug](http://jaredforsyth.com/projects/vim-debug/ "vim 调试")，尽管开发似乎已经停滞不前了。

简而言之，是否有人对上述工具有任何工作经验？或者有更好的建议？有人有使用 Vim 的工作流程调试代码吗？

提前非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-20T19:44:03.883

还有比较新的和积极开发的Vdebug：
[https ://github.com/joonty/vdebug](https://github.com/joonty/vdebug)

它与支持 DBGp 协议（包括带有 Xdebug 的 PHP 以及许多其他动态语言）的调试器对话。

# mysql - MySQL：使用索引对大表执行更新

> ID：10843058
> 
> 赞同：2
> 
> 时间：2012-06-01T00:40:07.447
> 
> 标签：mysql, database-design, database-indexes, database-optimization

晚上，

我有一个大而简单的表，有近 3000 万行。该表具有大多数列的索引。对其执行任何更新需要很长时间，我想知道在完成对表的更改后删除索引并重新构建它们是否是个好主意？

我问的原因是因为我在这里阅读了一些帖子，人们无法在大表上重新构建索引。但是，我不明白为什么会这样，因为我可以在 20 分钟内从 2.2GB 文本文件中导入此表。

该表由几个小整数和 varchars 组成。

我运行的更新查询如下：

```
UPDATE census SET rCo = 11470 WHERE rCo = 'Zet'; 
```

它们并不太慢，但我目前正在将其中一个字段从 varchar(4) 更改为 varchar(8)，这需要很长时间。

我从命令行 (Linux) 运行更新查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T00:52:25.890

我认为您应该保留索引，因为您在 where 子句中使用它。

另一方面，我很确定您应该建立一个全新的表：

```
CREATE TABLE census_2 (...) 
SELECT ..., IF(rCo = 'Zet', 11470, rCo) FROM census 
```

然后删除旧的，+ 在新的 AFTERWARDS 之后重新创建索引。

# django - 与 Django 模型类似的接口行为 - 覆盖 models.Field

> ID：10843061
> 
> 赞同：0
> 
> 时间：2012-06-01T00:40:30.213
> 
> 标签：django, interface, abstract

我正在尝试设计一个包含字段的抽象模型。子类模型将具有此字段，但它们将具有各种字段类型。

例子

```
class AbsModel(models.Model):
    data = models.??? #I want subclasses to choose this

    def __unicode__(self):
        return data.__str__()

    class Meta:
        abstract = True

class TimeModel(AbsModel):
    data = models.TimeField()
    ...

class CharModel(AbsModel):
    data = models.CharField(...)
    ... 
```

我正在寻找一种方法来强制数据字段的存在，以便我可以为所有对象编写一次**unicode 。**

如果这不可能，我如何在调用超类的**unicode时引用子类的“数据”字段**

我觉得第二个问题有一个我想念的明显答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T08:46:51.683

你可以这样写：

```
class AbsModel(models.Model):
    def __unicode__(self):
        if hasattr(self, "data") and isinstance(self.data, models.Field):
            return data.__str__()
        return u"Unknown" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T08:53:19.023

你[不能在 Django 中这样做](https://docs.djangoproject.com/en/dev/topics/db/models/#field-name-hiding-is-not-permitted)：

> 在正常的 Python 类继承中，允许子类覆盖父类的任何属性。在 Django 中，这对于作为实例的属性是不允许的`Field`（至少目前不允许）。如果基类有一个名为 author 的字段，则不能在从该基类继承的任何类中创建另一个名为 author 的模型字段。
> 
> 覆盖父模型中的字段会导致诸如初始化新实例（指定正在初始化的字段`Model.__init__`）和序列化等领域的困难。这些是普通 Python 类继承不必以完全相同的方式处理的特性，因此 Django 模型继承和 Python 类继承之间的区别不是任意的。
> 
> [...]
> 
> `FieldError`如果您覆盖任何祖先模型中的任何模型字段，Django 将引发 a 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T08:58:41.663

无法覆盖字段类型为 models.Field 的超类字段。

[https://docs.djangoproject.com/en/1.4/topics/db/models/#field-name-hiding-is-not-permitted](https://docs.djangoproject.com/en/1.4/topics/db/models/#field-name-hiding-is-not-permitted)

您可以通过在超类中定义另一种类型的字段来解决此问题，然后在子类中覆盖它（可能包括一个`__str__()`方法，以防数据字段未被覆盖）。

```
from django.db import models

class AbsDataField:
    def __str__(self):
        return "undefined"

class AbsModel(models.Model):
    data = AbsDataField

    def __unicode__(self):
        return self.data.__str__()

    class Meta:
        abstract = True

class TimeModel(AbsModel):
    data = models.TimeField()
    #...

class CharModel(AbsModel):
    data = models.CharField(max_length=32)
    #... 
```

# javascript - javascript中的顺序算术运算

> ID：10843062
> 
> 赞同：2
> 
> 时间：2012-06-01T00:40:35.080
> 
> 标签：javascript, jquery

例如，我有一个文本输入，用户将编写一个字符串`10+20-10-2*2+4/2`，我想按顺序进行算术运算，这意味着我想要`(10+20)-(10)-(2)*(2)+(4)/(2)`并且结果应该`20`根据上面的示例。

换句话说，我想从左边依次进行算术运算。任何人都可以帮我解决这个问题，或者可能有一些想法也会很好。谢谢。

**请询问我是否需要更多信息。**

```
$('#calculation').on('blur', function(e){
    e.preventDefault();
    var pattern=/^[-*/+0-9]+$/;
    value=$(this).val();
    if(value.match(pattern))
    {

        $(this).closest('tr').find('span.error').html('');
        //$('#total').val(eval(value));
        // No idea what to do

    }
    else
    {
        $(this).closest('tr').find('span.error').html('Invalid character');
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T01:11:28.863

## [**试试这个：**](http://jsfiddle.net/8CgWu/)

```
var str = '10+20-10-2*2+4/2';
var numbers = str.replace(/ /g, '').split(/[-+*\/]/g);
var operators = str.replace(/ /g, '').split(/\d*/g);
operators.shift();

var result = +numbers[0];

for (var i = 0; i < operators.length - 1; i++) {
    result = eval( result + operators[i] + numbers[i + 1] );
}

alert(result)​; 
```

### [演示](http://jsfiddle.net/8CgWu/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:19:48.580

如何使用 eval 来计算值。

```
$('#calculation').on('blur', function(e){
    e.preventDefault();
    var pattern=/^[-*/+0-9]+$/;
    value=$(this).val();
    if(value.match(pattern))
    {

        $(this).closest('tr').find('span.error').html('');
        //$('#total').val(eval(value));
        alert(eval(value));
        $('span.result').html(eval(value));

    }
    else
    {
        $(this).closest('tr').find('span.error').html('Invalid character');
    }
});​ 
```

见演示[http://jsfiddle.net/gineshkumar/gRc9r/](http://jsfiddle.net/gineshkumar/gRc9r/)

# tomcat - 服务器一夜之间空闲后的 GSP 渲染问题

> ID：10843070
> 
> 赞同：1
> 
> 时间：2012-06-01T00:41:12.050
> 
> 标签：tomcat, grails, tomcat7, gsp

几个星期以来，我一直间歇性地遇到一个难以复制的问题。似乎（即我还不能确定）如果 Grails 应用程序没有在一夜之间被触及，那么可能会卸载某些东西导致：

GSP 使用以下值呈现：

```
<meta http-equiv="org.apache.commons.lang.StringUtils@72cd722b" content="org.apache.commons.lang.StringUtils@4e520b18">

<link href="/appname/static/bundle-bundle_application_head.css" type="org.apache.commons.lang.StringUtils@31da0262" rel="org.apache.commons.lang.StringUtils@774121fe" media="org.apache.commons.lang.StringUtils@6008482c" />

<body style="org.apache.commons.lang.StringUtils@49533701">

<a href="/appname/register/forgotPassword" name="org.apache.commons.lang.StringUtils@815a651" class="org.apache.commons.lang.StringUtils@5689bde">Forgotten Password?</a> 
```

这发生在独立部署到 Tomcat 上，并且曾经让 Grails 在 IntelliJ 中过夜运行。

它不会每天晚上都发生，但在大多数情况下，我还无法找出工作和不工作之间的区别。

应用程序或 Tomcat 的日志中都没有提供线索。

此时我想知道它是否与资源插件有关。但是任何关于看什么的想法都值得赞赏

环境：

```
 OS Win7 x64 and Redhat 5
Tomcat 7.0.x (also was occuring on latest Glassfish)
Grails 2.0.4
Plugins: 
plugins.cache=1.0.0.RC1
plugins.cache-headers=1.1.5
plugins.compress=0.4
plugins.console=1.1
plugins.executor=0.3
plugins.export=1.3
plugins.fields=1.1
plugins.google-visualization=0.5.2
plugins.grails-melody=1.13
plugins.joda-time=1.4
plugins.mail=1.0
plugins.p6spy=0.5
plugins.quartz-monitor=0.2
plugins.spring-security-core=1.2.7.3
plugins.springcache=1.3.1
plugins.zipped-resources=1.0 
```

**更新#1：**

本周末再次发生，在使用 Tomcat 管理器重新加载 webapp 时失败并显示以下消息**，但这不会在 Tomcat 重新启动时发生**：

```
 INFO: Initializing Spring root WebApplicationContext
Jun 3, 2012 7:53:01 PM org.apache.catalina.core.StandardContext listenerStart
SEVERE: Exception sending context initialized event to listener instance of class org.codehaus.groovy.grails.web.context.GrailsContextLoaderListener
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'grailsApplication' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.ExceptionInInitializerError
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.ExceptionInInitializerError
    at java.lang.Class.forName(Class.java:247)
    ... 3 more
Caused by: groovy.lang.MissingMethodException: No signature of method: static org.joda.time.DurationFieldType.hour() is applicable for argument types: () values: []
Possible solutions: hours(), wait(), days(), eras(), years(), any()
    at grails.plugin.jodatime.taglib.PeriodTagLib$_getPeriodTypeForFields_closure3.doCall(PeriodTagLib.groovy:87)
    at grails.plugin.jodatime.taglib.PeriodTagLib.getPeriodTypeForFields(PeriodTagLib.groovy:87)
    at grails.plugin.jodatime.taglib.PeriodTagLib.<clinit>(PeriodTagLib.groovy:84)
    ... 4 more 
```

我不相信，因为 jodaTime 插件中的代码看起来不错：

```
 Line 84: private static final PeriodType DEFAULT_PERIOD_TYPE = getPeriodTypeForFields("hours,minutes,seconds")

    private static PeriodType getPeriodTypeForFields(String fields) {
    Line 87:    def fieldTypes = fields.split(/\s*,\s*/).collect { DurationFieldType."$it"() } as DurationFieldType[] 
```

**更新#2**

旋律显示慢慢地所有的物理内存都被吞噬了

如果重新加载应用程序，则可能与这些日志条目相关（并且始终强制 Tomcat 关闭并从挂起的 Java 进程开始被杀死）

```
SEVERE: The web application [/appname] appears to have started a thread named [Timer-1] but has failed to stop it. This is very likely to create a memory leak.
May 31, 2012 6:04:51 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads
SEVERE: The web application [/appname] appears to have started a thread named [DefaultQuartzScheduler_Worker-1] but has failed to stop it. This is very likely to create a memory leak.
May 31, 2012 6:04:51 PM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads 
```

或者是这样的：[http ://wiki.apache.org/tomcat/MemoryLeakProtection#cclThreadSpawnedByCommonClassLoader](http://wiki.apache.org/tomcat/MemoryLeakProtection#cclThreadSpawnedByCommonClassLoader)

**更新#3**

物理内存问题已解决，应用程序仍然损坏，看起来与原始帖子一样。这次空闲时间少了（几个小时）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-06T09:30:01.333

问题是在 Bootstrap.groovy 中有这一行：

```
String.metaClass.mixin StringUtils 
```

我最终删除了它，并且在通常导致问题的所有条件下已经测试了超过 24 小时。

这是我很久以前从这里发布的：[Groovy GDK 等效于 Apache Commons StringUtils.capitalize(str) 或 Perl 的 ucfirst(str)](https://stackoverflow.com/questions/681807/groovy-gdk-equivalent-of-apache-commons-stringutils-capitalizestr-or-perls-uc)

错误和代码中存在某种关系，但老实说，随着时间的推移，我仍然对 mixin 中发生的事情感到茫然……回到我的书本上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-11T14:46:48.250

奇怪的。不幸的是，我也遇到了这个问题，但关于原因的信息很少；我能提供的最好的是它没有发生在 Grails 1.1 中，确实发生在 Grails 2.2.0 中，并且已归档为[http://jira.grails.org/browse/GRAILS-10462](http://jira.grails.org/browse/GRAILS-10462)。

# vim - autotag-vim 插件在保存时不索引标签

> ID：10843075
> 
> 赞同：1
> 
> 时间：2012-06-01T00:42:14.440
> 
> 标签：vim

我已经安装了最新版本的 autotag-vim 插件。静态编译的标签在我的项目中有效。每当我对文件进行更改并保存时，`tags`文件都不会更新。

我有一个名为 home_controller.rb 的文件，如下所示

```
class HomeController < ApplicationController
  def index
    foo  # CTRL+] jumps to implementation
  end

private

  def foo
  end
end 
```

如果我修改文件以添加新功能并保存标签导航不适用于新功能。

```
class HomeController < ApplicationController

  def index
    foo
    bar  # CTRL+] does not jump to implementation after save
  end

private

  def foo
  end

  def bar
  end

end 
```

我通过调用启用了调试缓冲区`:call AutoTagDebug()`，我注意到标记正在按预期发生。但该`tags`文件没有得到更新。

```
source = "C:\Users\user1\My Projects\test1\app\controllers\home_controller.rb"
drive = "C:", file = "\Users\user1\My Projects\test1\app\controllers"
tagsFile "C:\Users\user1\My Projects\test1\app\controllers\tags"
drive = "C:", file = "\Users\user1\My Projects\test1\app"
tagsFile "C:\Users\user1\My Projects\test1\app\tags"
drive = "C:", file = "\Users\user1\My Projects\test1"
tagsFile "C:\Users\user1\My Projects\test1\tags"
Stripping tags for test1/app/controllers/home_controller.rb from tags file C:\Users\user1\My Projects\test1\tags 
```

# postgresql - Flyway 和 Postgres 元命令

> ID：10843079
> 
> 赞同：2
> 
> 时间：2012-06-01T00:42:57.560
> 
> 标签：postgresql, flyway

我想在 flyway 中使用 psql 元命令（http://www.postgresql.org/docs/9.1/static/app-psql.htm）。但是，当我做类似的事情时

```
\set foo bar 
```

我得到这个例外：

```
[flyway:migrate] com.googlecode.flyway.core.exception.FlywayException: Error executing statement at line 4: \set foo bar
[flyway:migrate] Caused by org.postgresql.util.PSQLException: ERROR: syntax error at or near "\"
[flyway:migrate]   Position: 1 
```

我想 psql 解释器没有运行。那是对的吗？有没有办法使用元命令之类的东西？我应该更广泛地使用飞行路占位符吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T15:08:19.757

psql 命令只能通过 psql 客户端工作。客户端驱动程序不执行这些命令。

# android - R.raw 是（坏的）......我不能用它引用任何东西。安卓 2.2

> ID：10843085
> 
> 赞同：1
> 
> 时间：2012-06-01T00:43:50.140
> 
> 标签：android, eclipse

当我尝试通过 R 类引用 //res/raw/ 中的任何文件时，它就像我在项目中没有“原始”目录一样。我检查了项目文件以及 Eclipse IDE - 它肯定存在。
这里：

`MediaPlayer mp = MediaPlayer.create(Project.this, R.raw.Gunshot);`

这段代码阻止我编译...... Eclipse 说“原始无法解析或不是一个字段。

我已经重新启动、刷新并构建了没有该代码的项目，但它不会消失。帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-03T17:19:56.393

我想到了。我正在查看记录器，但没有在控制台中看到“原始”文件夹中的文件名必须是小写的。我认为它也不会构建“原始”对象，直到里面有文件。因此，它似乎永远不会生成该对象。多谢你们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:30:13.460

找到“ `import android.R`”并删除它们。然后`Clean`你的项目和`Build`它。

这将是 Eclipse Android 中最常见的问题。

看看[这个](https://stackoverflow.com/questions/885009/r-cannot-be-resolved-android-error)，你可以在这里找到很多解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T00:48:48.560

项目>清理和重建项目怎么样？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-16T16:37:51.013

在 Android Studio 4.0 之后：

*   清洁和重建
*   将原始文件重命名为小写 az、0-9 和下划线

**仅在使缓存无效并重新启动**AS后才解决引用。

# file-io - macruby open() 不工作

> ID：10843096
> 
> 赞同：0
> 
> 时间：2012-06-01T00:45:38.433
> 
> 标签：file-io, macruby

当然，以下示例不是我的整个应用程序。我已经提供了引发错误的部分：

```
#!/usr/local/bin/macruby

require 'open-uri'
framework 'ScriptingBridge'

system "mkdir -p ~/.myApp"
system "cp ~/Desktop/image.png ~/.myApp/image.png"

var = open('~/.myApp/image.png', 'w') 
```

错误是：

```
open: No such file or directory - open() failed (Errno::ENOENT) 
```

我错过了图书馆还是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T06:29:54.013

这应该有效： `File.open File.expand_path('~/image.png'), 'w'`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T22:47:31.100

我不知道为什么，但如果你提供路径而不使用“~”它会起作用。

# c# - 这里有一个神秘的异常：XamlParseException

> ID：10843100
> 
> 赞同：0
> 
> 时间：2012-06-01T00:46:18.747
> 
> 标签：c#, wpf, xaml, xamlparseexception

这是我的代码：

```
 public partial class MainWindow : Window
{
    List<Cliente> CContent;
    string mainPath = @"D:\70-536\Clientes.dat";

    public MainWindow()
    {
        InitializeComponent();
        Do();
    }

    private void Do()
    {

        FileInfo fi = new FileInfo(mainPath);
        if (fi.Exists)
        {
            CContent = ReturnListOfPersistentFile<Cliente>(mainPath);
        }
        else
        {
            CContent = new List<Cliente>();
        }
    }

    public List<T> ReturnListOfPersistentFile<T> (string Filename)
    {
        SoapFormatter sf = new SoapFormatter();

        using (Stream fStream = new FileStream(Filename,FileMode.Open, FileAccess.Read,FileShare.None))
        {
            List<T> list = new List<T>();
            list = (List<T>)sf.Deserialize(fStream);

            return list;
        }

    } 
```

这是我的内部异常的堆栈跟踪：

> en System.Xml.XmlTextReaderImpl.Throw(Exception e) en System.Xml.XmlTextReaderImpl.Throw(String res, String arg) en System.Xml.XmlTextReaderImpl.ThrowUnclosedElements() en System.Xml.XmlTextReaderImpl.ParseAttributes() en System. Xml.XmlTextReaderImpl.ParseElement() 和 System.Xml.XmlTextReaderImpl.ParseDocumentContent() 和 System.Xml.XmlTextReaderImpl.Read() 和 System.Xml.XmlTextReader.Read() 和 System.Runtime.Serialization.Formatters.Soap.SoapParser。 ParseXml()
> en System.Runtime.Serialization.Formatters.Soap.SoapParser.Run() en System.Runtime.Serialization.Formatters.Soap.ObjectReader.Deserialize(HeaderHandler handler, ISerParser serParser) en System.Runtime.Serialization.Formatters.Soap.SoapFormatter。 Deserialize(Stream serializationStream, HeaderHandler handler) zh System.Runtime.Serialization.Formatters.Soap.SoapFormatter.Deserialize(Stream serializationStream) zh Solution1.MainWindow.ReturnListOfPersistentFile[T](String Filename) en c:\users\u201114160\documents\visual studio 2010\Projects\Solution1\Solution1\MainWindow.xaml.cs:línea 99 en Solution1.MainWindow.Do() en c:\users\u201114160\documents\visual studio 2010\Projects\Solution1\Solution1\MainWindow.xaml.cs :linea 45
> zh Solution1.MainWindow..ctor() zh c:\users\u201114160\documents\visual studio 2010\Projects\Solution1\Solution1\MainWindow.xaml.cs:linea 36

它让我发疯，一些想法？这个异常是因为“ReturnListOfPersistentFile”泛型方法而引发的，但是为什么？

提前致谢。

**解答：** 我试图用 SOAP 格式化程序序列化一个通用列表，但 SOAP 格式化程序不支持通用列表。

我在[forums.microsoft.com 上遇到了这个帖子。](http://social.msdn.microsoft.com/forums/en-US/netfxremoting/thread/ee4a7a63-290e-432f-bd45-44f4cb7a3467/)让我引用微软员工的话：

> 我们决定不为 Whidbey 的 SoapFormatter 投资任何重要的新功能工作

谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:30:39.510

查看您的堆栈跟踪，我注意到 ThrowUnclosedElements 方法。这让我认为您的文件已损坏或格式错误。

正如您自己所指出的，SOAP 序列化不支持通用列表。据我了解，这意味着您尝试序列化 List ，结果您得到了一个无法反序列化的文件。这已经在[此处](https://stackoverflow.com/questions/1657654/net-remoting-problems-with-listt)讨论过，也在[这里](http://social.msdn.microsoft.com/forums/en-US/netfxremoting/thread/ee4a7a63-290e-432f-bd45-44f4cb7a3467/)（您自己引用）等其他地方讨论过。

一个解决方案可能是使用非通用的、老式的、被遗忘的[ArrayList](http://msdn.microsoft.com/en-us/library/system.collections.arraylist)。当然，您必须访问这些项目并将它们转换为适当的类型，这可以通过包装类来完成。

另一种方法是序列化每个对象的对象，而不是序列化列表。

# data-structures - 在代码中表示结？

> ID：10843101
> 
> 赞同：3
> 
> 时间：2012-06-01T00:46:22.770
> 
> 标签：data-structures, graph, planar-graph

所以我最近一直在阅读一些关于图论和结理论关系的论文，这让我想到了在代码中表示结。

我目前对这个问题的直觉是将结视为本质上的平面图，其中每个顶点位于任何交叉点。然后，我们还将存储任何给定顶点的交叉点是如何定向的。

这几乎是如何完成的，还是有更好的方法？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T12:18:10.660

结形成一个单子，因此您可以从该世界中窃取一些表示。

*   [http://blog.sigfpe.com/2009/05/trace-diagrams-with-monads.html](http://blog.sigfpe.com/2009/05/trace-diagrams-with-monads.html)
*   [http://blog.sigfpe.com/2008/08/untangling-with-continued-fractions.html](http://blog.sigfpe.com/2008/08/untangling-with-continued-fractions.html)

# javascript - $（这个）。方法（js 或 jquery）

> ID：10843108
> 
> 赞同：0
> 
> 时间：2012-06-01T00:48:01.297
> 
> 标签：javascript, jquery

我查看了一些 js/jquery 代码，并在这里看到了这一行：
`$(this).`

**怎样才能找出在这个东西上调用什么方法。**有没有类似于 js 的 javadocs 的东西？

这段代码是 js 还是 jquery？

注意：这可能与那些回复的人有关，我写后端代码并且从未做过前端（不超过简单的html）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T00:51:09.013

该`$`方法只是该方法的别名[`jQuery`](http://api.jquery.com/jQuery/)。它将包装元素（或对象）并公开框架可用的方法。许多其他 javascript 库`$`也用作别名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T00:51:34.270

在这种情况下，`this`指的是一个 DOM 元素，并且`$(this)`指的是该元素变成了一个 jQuery 集合。

然后它拥有所有常用的 jQuery 函数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T00:50:55.893

这是 jQuery

$(this) 用于当您要对选定的选择器进行操作时

例如

如果您想获取带有“email”类的文本框元素的值，这就是代码的编写方式

```
$('email').blur(function(){
  var email = $(this).val();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T00:54:10.087

由于您提供的信息有限，这可能是任何事情。我会设置一个调试点`$(this).`并在其上创建一个监视以查看它是什么以及它公开了哪些方法。Firebug 非常擅长展示这一点。

# java - 莲花笔记使用Java api按日期搜索

> ID：10843113
> 
> 赞同：3
> 
> 时间：2012-06-01T00:49:08.187
> 
> 标签：java, date, lotus-notes

我正在尝试从 Lotus Notes 数据库中按日期选择记录，但在正确格式化日期时遇到了麻烦。

以下是相关代码：

```
public void runNotes()  {
    Session s;
    try {
        s = NotesFactory.createSession((String)null, (String)null, "mypassword");
        Database hkDB = 
            s.getDatabase("NBHDH001/YNM", "H\\DHH00001.nsf", false);
        DocumentCollection docs = hkDB.search("[Date]>[2012/03/20]"); 
```

日期是记录中的一个字段，当我（使用 FTSearch）查找记录时，日期以上述格式返回：[yyyy/mm/dd]。

搜索的参数就是我这里需要的。即我应该放什么而不是“[Date]>[2012/03/20]”

我用 Calendar 和 DateFormat 尝试了各种结构，但它没有结合在一起......

有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T01:32:04.357

您应该去掉字段名称上的方括号。搜索方法需要一个注释公式，就像您放入视图选择公式中的内容一样：

```
"Date > [03/20/2012]" 
```

可能还需要日期为 mm/dd/yyyy 格式，但如果您在非美国地区，我不能 100% 确定。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T02:31:12.060

您提到您一直在数据库中进行全文搜索，因此绝对值得一提...如果数据库确实有全文索引，那么您可能要考虑使用 NotesDatabase.FTSearch() 方法而不是NotesDatabase.Search()。对于大型数据库，FTSearch 方法会快得多。

FTSearch 的语法与 Search 的语法不同。您可以使用“FIELD Date > 03/20/2012”或“[Date] > 03/20/2012”。

# windows-phone-7 - 多次快速滑动后，Windows Phone 7 枢轴控件不断更改枢轴项目

> ID：10843114
> 
> 赞同：0
> 
> 时间：2012-06-01T00:49:15.307
> 
> 标签：windows-phone-7

我有一个带有 3 个枢轴项目的枢轴控制 WP7 应用程序。我看到的问题是，如果您连续多次快速滑动应用程序（例如 10 次或更多次），枢轴会不断循环。

有什么方法可以检测到我正在滑动而不处理当前的滑动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T00:54:50.397

这是 Windows Phone 操作系统的“功能”。任何带有 Pivot 的应用程序都会执行此操作。

要覆盖它，您可能必须编写一个基于 Pivot 的自定义控件，并使其在更改视图时忽略轻弹手势。

# hadoop - Pig DUMP 卡在 GROUP

> ID：10843117
> 
> 赞同：2
> 
> 时间：2012-06-01T00:50:11.937
> 
> 标签：hadoop, apache-pig

我是 PIG 初学者（使用 pig 0.10.0），我有一些简单的 JSON，如下所示：

测试.json：

```
{
  "from": "1234567890",
  .....
  "profile": {
      "email": "me@domain.com"
      .....
  }
} 
```

我在猪中进行了一些分组/计数：

```
>pig -x local 
```

使用以下 PIG 脚本：

```
REGISTER /pig-udfs/oink.jar;
REGISTER /pig-udfs/json-simple-1.1.jar;
REGISTER /pig-udfs/guava-12.0.jar;
REGISTER /pig-udfs/elephant-bird-2.2.3.jar;

users = LOAD 'test.json' USING com.twitter.elephantbird.pig.load.JsonLoader('-nestedLoad=true') as (json:map[]);

domain_user = FOREACH users GENERATE oink.EmailDomainFilter(json#'profile'#'email') as email, json#'from' as user_id;
DUMP domain_user; /* Outputs: (domain.com,1234567890) */

grouped_domain_user = GROUP domain_user BY email;
DUMP grouped_domain_user; /* Outputs: =stuck here= */ 
```

基本上，当我尝试转储 grouped_domain_user 时，pig 卡住了，似乎在等待地图输出完成：

```
2012-05-31 17:45:22,111 [Thread-15] INFO  org.apache.hadoop.mapred.Task - Task 'attempt_local_0002_m_000000_0' done.
2012-05-31 17:45:22,119 [Thread-15] INFO  org.apache.hadoop.mapred.Task -  Using ResourceCalculatorPlugin : null
2012-05-31 17:45:22,123 [Thread-15] INFO  org.apache.hadoop.mapred.ReduceTask - ShuffleRamManager: MemoryLimit=724828160, MaxSingleShuffleLimit=181207040
2012-05-31 17:45:22,125 [Thread-15] INFO  org.apache.hadoop.io.compress.CodecPool - Got brand-new decompressor
2012-05-31 17:45:22,125 [Thread-15] INFO  org.apache.hadoop.io.compress.CodecPool - Got brand-new decompressor
2012-05-31 17:45:22,125 [Thread-15] INFO  org.apache.hadoop.io.compress.CodecPool - Got brand-new decompressor
2012-05-31 17:45:22,126 [Thread-15] INFO  org.apache.hadoop.io.compress.CodecPool - Got brand-new decompressor
2012-05-31 17:45:22,126 [Thread-15] INFO  org.apache.hadoop.io.compress.CodecPool - Got brand-new decompressor
2012-05-31 17:45:22,128 [Thread for merging on-disk files] INFO  org.apache.hadoop.mapred.ReduceTask - attempt_local_0002_r_000000_0 Thread started: Thread for merging on-disk files
2012-05-31 17:45:22,128 [Thread for merging in memory files] INFO  org.apache.hadoop.mapred.ReduceTask - attempt_local_0002_r_000000_0 Thread started: Thread for merging in memory files
2012-05-31 17:45:22,128 [Thread for merging on-disk files] INFO  org.apache.hadoop.mapred.ReduceTask - attempt_local_0002_r_000000_0 Thread waiting: Thread for merging on-disk files
2012-05-31 17:45:22,129 [Thread-15] INFO  org.apache.hadoop.mapred.ReduceTask - attempt_local_0002_r_000000_0 Need another 1 map output(s) where 0 is already in progress
2012-05-31 17:45:22,129 [Thread for polling Map Completion Events] INFO  org.apache.hadoop.mapred.ReduceTask - attempt_local_0002_r_000000_0 Thread started: Thread for polling Map Completion Events
2012-05-31 17:45:22,129 [Thread-15] INFO  org.apache.hadoop.mapred.ReduceTask - attempt_local_0002_r_000000_0 Scheduled 0 outputs (0 slow hosts and0 dup hosts)
2012-05-31 17:45:28,118 [communication thread] INFO  org.apache.hadoop.mapred.LocalJobRunner - reduce > copy > 
2012-05-31 17:45:31,122 [communication thread] INFO  org.apache.hadoop.mapred.LocalJobRunner - reduce > copy > 
2012-05-31 17:45:37,123 [communication thread] INFO  org.apache.hadoop.mapred.LocalJobRunner - reduce > copy > 
2012-05-31 17:45:43,124 [communication thread] INFO  org.apache.hadoop.mapred.LocalJobRunner - reduce > copy > 
2012-05-31 17:45:46,124 [communication thread] INFO  org.apache.hadoop.mapred.LocalJobRunner - reduce > copy > 
2012-05-31 17:45:52,126 [communication thread] INFO  org.apache.hadoop.mapred.LocalJobRunner - reduce > copy > 
2012-05-31 17:45:58,127 [communication thread] INFO  org.apache.hadoop.mapred.LocalJobRunner - reduce > copy > 
2012-05-31 17:46:01,128 [communication thread] INFO  org.apache.hadoop.mapred.LocalJobRunner - reduce > copy > 
.... repeats .... 
```

欢迎就为什么会发生这种情况提出建议。

谢谢！

**更新**

克里斯为我解决了这个问题。我正在将 .etc 设置`fs.default.name`为正确的值`pig.properties`，但是我也将`HADOOP_CONF_DIR`环境变量设置为指向我的本地 Hadoop 安装，这些相同的值设置为`<final>true</final>`.

很棒的发现，非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T10:26:11.630

将此问题标记为已回答，以及将来遇到此问题的人：

在本地模式下运行时（无论是通过 用于 pig`pig -x local`还是向本地作业运行器提交 map reduce 作业，如果您看到 reduce 阶段“挂起”，特别是如果您在日志中看到类似于以下内容的条目：

```
2012-05-31 17:45:22,129 [Thread-15] INFO  org.apache.hadoop.mapred.ReduceTask - 
      attempt_local_0002_r_000000_0 Need another 1 map output(s) where 0 is already in progress 
```

然后你的工作，虽然是在本地模式下开始的，但可能已经切换到“集群”模式，因为该`mapred.job.tracker`属性在你的 $HADOOP/conf/mapred-site.xml 中被标记为“最终”：

```
<property>
    <name>mapred.job.tracker</name>
    <value>hdfs://localhost:9000</value>
    <final>true</final>
</property> 
```

您还应该检查`fs.default.name`core-site.xml 中的属性，并确保它没有被标记为 final

这意味着您无法在运行时设置此值，甚至可能会看到类似于以下内容的错误消息：

```
12/05/22 14:28:29 WARN conf.Configuration: 
    file:/tmp/.../job_local_0001.xml:a attempt to override final parameter: fs.default.name;  Ignoring.
12/05/22 14:28:29 WARN conf.Configuration: 
    file:/tmp/.../job_local_0001.xml:a attempt to override final parameter: mapred.job.tracker;  Ignoring. 
```

# php - php中的“俚语”大数字？

> ID：10843126
> 
> 赞同：-4
> 
> 时间：2012-06-01T00:52:08.487
> 
> 标签：php

像这样的东西：

```
echo somefn(2800000000); // outputs '2,8B' for 2,8 billion
echo somefn(2000000); // outputs '2M' for 2 million
echo somefn(5400); // outputs '5,4K' for 5,400
echo somefn('blabla') // outputs 'blabla' as it is because it isn't a number
echo somefn(5) // outputs 5, nothing to simplify 
```

我知道它一定是非常简单的代码，但我想知道是否有其他人有一些东西可以解释可能其他情况现在不会出现在我脑海中的情况。

**/Edit**我正在寻找更通用的内置 PHP 函数（或类似的函数）。几乎相同的方式`strtotime()`可以处理诸如“周”或“月”之类的事情。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T01:05:25.507

我不知道您可以调用任何现成的功能。这是一种可能的解决方案：

```
function number_abbr($number) {
  if (!is_numeric($number) || $number < 1000)
    return $number;

  $postfix = array("K", "M", "B", "T");
  while ($number >= 1000 && count($postfix) > 0) {
    $number /= 1000;
    $append = array_shift($postfix);
  }

  // if the number is still greater than 1000...
  if ($number > 1000)
    return "a lot";

  // return the output
  return sprintf("%1.1f" . $append, $number);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T01:08:57.827

这似乎工作得很好：

```
function somefn( $num) {
    if( !is_numeric( $num)) return $num;
    $num = floatval( $num);
    $suffix = '';
    if( $num / 1000000000 > 1) {
        $num = $num / 1000000000;
        $suffix = 'B';
    }
    elseif( $num / 1000000 > 1) {
        $num = $num / 1000000;
        $suffix = 'M';
    }
    elseif( $num / 1000 > 1) {
        $num = $num / 1000;
        $suffix = 'K';
    }
    return number_format( $num, 1, ',', ',') . ' ' . $suffix;
} 
```

这输出：

```
2,8 B
2,0 M
5,4 K
blabla
5,0 
```

您当然可以调整它以精确匹配所需的输出。[这是一个演示](http://codepad.viper-7.com/1rHxyP)，展示了它的实际效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T02:21:29.817

无循环。

```
function abbr_number($size,$decimals=2,$sizes = array("","K","M","B","T")) {
    if(!is_numeric($size) || $size==0) return ($size); 
    if(!is_numeric($decimals) || $decimals<0) $decimals=2;

    $size=abs($size);
    $n = ($size/pow(1000,($i = floor(log($size, 1000)))))*
        (isset($sizes[$i])?1:pow(1000,$i-(count($sizes)-1)).end($sizes));

    return ($size<=0?'-':'').($size>0 ? round($n*pow(10,$decimals))/pow(10,$decimals):$n).
        (isset($sizes[$i])?$sizes[$i]:array_pop($sizes));
}

echo(implode('<br />',array(
    abbr_number(2800000000),
    abbr_number(2000000),
    abbr_number(5400),
    abbr_number('blabla'),
    abbr_number(5),
    abbr_number(pow(rand(),rand(1,5)))
))); 
```

# android - Android，我的应用在竖屏上看起来不错，但在平板电脑（宽屏）上尺寸都变形了

> ID：10843130
> 
> 赞同：0
> 
> 时间：2012-06-01T00:53:42.700
> 
> 标签：android

当我的 android 应用程序在平板电脑或宽屏模拟器（wasvga、wxcage800 和我的平板电脑）上绘制时，它会从 drawblw-ldpi 文件夹（低分辨率）而不是 drawl-hdpi 文件夹中绘制图形图像。我正在使用位图按钮。它们在桌子上都非常小（因为正在绘制最小的图像），但正确的图像会在所有垂直屏幕上绘制。

为什么是这样？？？？有办法解决吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T04:27:45.940

默认文件夹是 mdpi 文件夹。如果另一个文件夹不存在，或者没有你的图像，android 会从 drawable-mdpi 获取它。把你的图片放在那里，让我们知道它是否有效。

# node.js - 将 socket.io 切换到端口 80 导致传输切换到 xhr 轮询

> ID：10843133
> 
> 赞同：4
> 
> 时间：2012-06-01T00:54:36.317
> 
> 标签：node.js, socket.io

我已经在端口 3000 上运行了一个 socket.io 服务器，运行良好。所有 socket.emit 和其他操作都通过 websocket 连接工作。

但是，一旦我尝试在端口 80 上运行服务器，更改

```
app.listen(3000) to app.listen(80) 
```

并进行了所有必要的客户端更改，socket.io 停止使用 websocket 并切换到 xhr 轮询

```
warn  - websocket connection invalid
info  - transport end
debug - set close timeout for client 1830609591747620770
debug - cleared close timeout for client 1830609591747620770
debug - cleared heartbeat interval for client 1830609591747620770
debug - setting request GET /socket.io/1/websocket/1830609591747620770
debug - set heartbeat interval for client 1830609591747620770
warn  - websocket connection invalid
info  - transport end
debug - set close timeout for client 1830609591747620770
debug - cleared close timeout for client 1830609591747620770
debug - cleared heartbeat interval for client 1830609591747620770
debug - setting request GET /socket.io/1/xhr-polling/1830609591747620770?t=1338511205390
debug - setting poll timeout
debug - client authorized for 
debug - clearing poll timeout
debug - xhr-polling writing 1::
debug - set close timeout for client 1830609591747620770
debug - setting request GET /socket.io/1/xhr-polling/1830609591747620770?t=1338511205500
debug - setting poll timeout
debug - discarding transport 
```

关于为什么它切换到 xhr 轮询以及我可以尝试什么的任何想法？

谢谢

编辑:: 我也在运行快速网络服务器和网络套接字服务器这一事实是否会成为问题？因为在我的代码中，我已经启动并运行了。如果这导致了问题，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-13T04:53:43.717

我还没有弄清楚为什么它会切换到 XHR 轮询，但为了我只想让 websocket 服务器在端口 80 上工作，我解决问题的方法是使用 node-http-proxy 包[https://github.com /nodejitsu/node-http-proxy](https://github.com/nodejitsu/node-http-proxy)

我保持我的代码相同，但让代理在端口 80 上侦听，并将其路由到我的 websocket 正在侦听的端口 3000。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:31:45.680

警告“websocket 连接无效”似乎表明防火墙/防病毒安全阻止端口 80 上的 web 套接字存在问题。有关此类问题的完整列表，请查看[Socket.io 和防火墙软件](https://github.com/LearnBoost/socket.io/wiki/Socket.IO-and-firewall-software)

[使用http://websocketstest.com/](http://websocketstest.com/)上的测试/诊断页面检查您的网络兼容性。

希望这可以帮助。

# flash - Flash 影片 (SWF) 中的文本元素可以使用网络字体吗？

> ID：10843137
> 
> 赞同：2
> 
> 时间：2012-06-01T00:55:21.357
> 
> 标签：flash, webfonts

是否可以从 SWF 引用 Web 字体，并以该 Web 字体的样式呈现该 Flash 电影中的文本？

例如，假设我有：

```
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="impact_label.css">
    </head>
    <body>
        <!-- The SWF object -->
    </body>
</html> 
```

在那个样式表中，我有：

```
/* Generated by Font Squirrel */

@font-face {
    font-family: 'ImpactLabel';
    src: url('Impact_Label-webfont.eot');
    src: url('Impact_Label-webfont.eot?#iefix') format('embedded-opentype'),
         url('Impact_Label-webfont.woff') format('woff'),
         url('Impact_Label-webfont.ttf') format('truetype'),
         url('Impact_Label-webfont.svg#ImpactLabelRegular') format('svg');
    font-weight: normal;
    font-style: normal;
} 
```

假设 SWF 由一个文本元素组成。我可以链接到样式表，或者它包含的任何字体文件，并将我的电影中文本元素的字体系列设置为外部字体的字体系列吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T01:48:12.353

不，字体需要采用 Flash 的特殊格式。

如果要动态加载字体，则必须将其嵌入到 swf 中，例如`Impact_Label-webfont.swf`. [您可以在此博客](http://nochump.com/blog/archives/20)上找到完整的说明。

# mysql - 在 RedHat 上安装 MySQL 5.5.25-1 源码包失败

> ID：10843140
> 
> 赞同：0
> 
> 时间：2012-06-01T00:55:45.760
> 
> 标签：mysql, rpm, gperf

我正在尝试在 RedHat 机器上安装 MySQL-5.5.25-1.linux2.6.src.rpm 包，但是在执行 rpmbuild 时出现错误。

它提示需要gperf，但我已经安装了gperf 3.0.4。

我应该怎么做才能解决这个问题？

```
[root@localhost ~]# rpm -ivh MySQL-5.5.25-1.linux2.6.src.rpm 
  1:MySQL                  warning: user pb2user does not exist - using root
########################################### [100%]
warning: user pb2user does not exist - using root

[root@localhost /]# cd /usr/src
[root@localhost src]# cd redhat
[root@localhost redhat]# cd SPECS
[root@localhost SPECS]# ls
mysql.5.5.25.spec
[root@localhost SPECS]# rpmbuild -bp mysql.5.5.25.spec 
error: Failed build dependencies:
    gperf is needed by MySQL-5.5.25-1.linux2.6.i386
[root@localhost SPECS]# gperf --version
GNU gperf 3.0.4
Copyright (C) 1989-1998, 2000-2004, 2006-2009 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Written by Douglas C. Schmidt and Bruno Haible. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T19:51:45.440

您的 gperf 是作为 RPM 安装的还是构建的？

如果是 RPM，请尝试使用 rpm --rebuilddb 重建 RPM 数据库。

# ruby-on-rails - 如何获得设计会话超时回调？

> ID：10843146
> 
> 赞同：2
> 
> 时间：2012-06-01T00:56:58.770
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1, devise

当用户的会话与设计超时时，有没有办法获得回调/处理某些操作？

覆盖 DeviseSessionsController 的普通旧版本不起作用：

```
class SessionsController < Devise::SessionsController

  def destroy
    #do something
    super
  end

end 
```

这仅在用户注销时有效，这是有道理的，因为在会话超时时似乎不会调用控制器。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T05:04:39.107

我发现做 Warden.before_logout 是最好的解决方案：

```
# app/models/user.rb

Warden::Manager.before_logout do |user, auth, opts|
  #fdsafdsafdsa
end 
```

不幸的是，纯粹的设计似乎没有任何方法可以做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:29:24.690

```
before_filter :destroy_custom, :only => [ :destroy ]

def destroy_custom 
    # Do your thang
end 
```

我能够用新方法做到这一点。我猜想破坏也可以做同样的事情。回调可以在 devise_custom 内部调用，或者 devise_custom 本身可能是您要在销毁之前执行某些操作的方法。

# java - Java中的复数加法

> ID：10843147
> 
> 赞同：0
> 
> 时间：2012-06-01T00:57:19.707
> 
> 标签：java, addition, complex-numbers

我一直在试图弄清楚如何设置这个方程来为 Java 添加两个复数。有两种方法，但我不明白第一种方法要求我做什么。是说我需要做（real1 + imag1）而不是（real1 + real2）吗？如果是这种情况，那么我将如何让该结果进入 c1？我也无法使用第二种方法结果来保存总和并返回它。

```
 /*Method for adding the real and imaginary parts of two complex numbers,
 *which returns the result in a new complex number
 */
public static ComplexNumber addComplexNumbers(double real1, double imag1, double real2, double imag2){ 
    ComplexNumber result = ComplexNumber.addComplexNumbers(real1, imag1, real2, imag2);
    result.setReal(real1 + real2);
    result.setImag(imag1 + imag2);
    return result;
    }

//Method for adding two complex numbers
public static ComplexNumber addComplexNumbers(ComplexNumber c1, ComplexNumber c2){ 
    ComplexNumber result = new ComplexNumber();
    result = (c1.real + c2.real) + (c1.imag + c2.imag);

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T00:59:41.193

```
final public class Complex {

    private final double real; 
    private final double imag; 

    public Complex() {
        this(0.0, 0.0);
    }

    public Complex(double r) {
        this(r, 0.0);
    }

    public Complex(double r, double i) {
         this.real = r;
         this.imag = i;
    }

    public Complex add(Complex addend) {
        return new Complex((this.real + addend.real), (this.imag + addend.imag));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-03T13:32:44.637

虽然这已经得到回答，但我认为人们可能会受益于下面的类，它执行了许多与复数相关的功能。

这已在 MIT 许可下发布，GitHub 项目在[这里](https://github.com/abdulfatir/jcomplexnumber/)。

```
/**
 * <code>ComplexNumber</code> is a class which implements complex numbers in Java. 
 * It includes basic operations that can be performed on complex numbers such as,
 * addition, subtraction, multiplication, conjugate, modulus and squaring. 
 * The data type for Complex Numbers.
 * <br /><br />
 * The features of this library include:<br />
 * <ul>
 * <li>Arithmetic Operations (addition, subtraction, multiplication, division)</li>
 * <li>Complex Specific Operations - Conjugate, Inverse, Absolute/Magnitude, Argument/Phase</li>
 * <li>Trigonometric Operations - sin, cos, tan, cot, sec, cosec</li>
 * <li>Mathematical Functions - exp</li>
 * <li>Complex Parsing of type x+yi</li>
 * </ul>
 * 
 * @author      Abdul Fatir
 * @version     1.1
 * 
 */
public class ComplexNumber
{
    /**
    * Used in <code>format(int)</code> to format the complex number as x+yi
    */
    public static final int XY = 0;
    /**
    * Used in <code>format(int)</code> to format the complex number as R.cis(theta), where theta is arg(z)
    */
    public static final int RCIS = 1;
    /**
    * The real, Re(z), part of the <code>ComplexNumber</code>.
    */
    private double real;
    /**
    * The imaginary, Im(z), part of the <code>ComplexNumber</code>.
    */
    private double imaginary;
    /**
    * Constructs a new <code>ComplexNumber</code> object with both real and imaginary parts 0 (z = 0 + 0i).
    */
    public ComplexNumber()
    {
        real = 0.0;
        imaginary = 0.0;
    }

    /**
    * Constructs a new <code>ComplexNumber</code> object.
    * @param real the real part, Re(z), of the complex number
    * @param imaginary the imaginary part, Im(z), of the complex number
    */

    public ComplexNumber(double real, double imaginary)
    {
        this.real = real;
        this.imaginary = imaginary;
    }

    /**
    * Adds another <code>ComplexNumber</code> to the current complex number.
    * @param z the complex number to be added to the current complex number
    */

    public void add(ComplexNumber z)
    {
        set(add(this,z));
    }

    /**
    * Subtracts another <code>ComplexNumber</code> from the current complex number.
    * @param z the complex number to be subtracted from the current complex number
    */

    public void subtract(ComplexNumber z)
    {
        set(subtract(this,z));
    }

    /**
    * Multiplies another <code>ComplexNumber</code> to the current complex number.
    * @param z the complex number to be multiplied to the current complex number
    */

    public void multiply(ComplexNumber z)
    {
        set(multiply(this,z));
    }
    /**
    * Divides the current <code>ComplexNumber</code> by another <code>ComplexNumber</code>.
    * @param z the divisor
    */  
    public void divide(ComplexNumber z)
    {
        set(divide(this,z));
    }
    /**
    * Sets the value of current complex number to the passed complex number.
    * @param z the complex number
    */
    public void set(ComplexNumber z)
    {
        this.real = z.real;
        this.imaginary = z.imaginary;
    }
    /**
    * Adds two <code>ComplexNumber</code>.
    * @param z1 the first <code>ComplexNumber</code>.
    * @param z2 the second <code>ComplexNumber</code>.
    * @return the resultant <code>ComplexNumber</code> (z1 + z2).
    */
    public static ComplexNumber add(ComplexNumber z1, ComplexNumber z2)
    {
        return new ComplexNumber(z1.real + z2.real, z1.imaginary + z2.imaginary);
    }

    /**
    * Subtracts one <code>ComplexNumber</code> from another.
    * @param z1 the first <code>ComplexNumber</code>.
    * @param z2 the second <code>ComplexNumber</code>.
    * @return the resultant <code>ComplexNumber</code> (z1 - z2).
    */  
    public static ComplexNumber subtract(ComplexNumber z1, ComplexNumber z2)
    {
        return new ComplexNumber(z1.real - z2.real, z1.imaginary - z2.imaginary);
    }
    /**
    * Multiplies one <code>ComplexNumber</code> to another.
    * @param z1 the first <code>ComplexNumber</code>.
    * @param z2 the second <code>ComplexNumber</code>.
    * @return the resultant <code>ComplexNumber</code> (z1 * z2).
    */  
    public static ComplexNumber multiply(ComplexNumber z1, ComplexNumber z2)
    {
        double _real = z1.real*z2.real - z1.imaginary*z2.imaginary;
        double _imaginary = z1.real*z2.imaginary + z1.imaginary*z2.real;
        return new ComplexNumber(_real,_imaginary);
    }
    /**
    * Divides one <code>ComplexNumber</code> by another.
    * @param z1 the first <code>ComplexNumber</code>.
    * @param z2 the second <code>ComplexNumber</code>.
    * @return the resultant <code>ComplexNumber</code> (z1 / z2).
    */      
    public static ComplexNumber divide(ComplexNumber z1, ComplexNumber z2)
    {
        ComplexNumber output = multiply(z1,z2.conjugate());
        double div = Math.pow(z2.mod(),2);
        return new ComplexNumber(output.real/div,output.imaginary/div);
    }

    /**
    * The complex conjugate of the current complex number.
    * @return a <code>ComplexNumber</code> object which is the conjugate of the current complex number
    */

    public ComplexNumber conjugate()
    {
        return new ComplexNumber(this.real,-this.imaginary);
    }

    /**
    * The modulus, magnitude or the absolute value of current complex number.
    * @return the magnitude or modulus of current complex number
    */

    public double mod()
    {
        return Math.sqrt(Math.pow(this.real,2) + Math.pow(this.imaginary,2));
    }

    /**
    * The square of the current complex number.
    * @return a <code>ComplexNumber</code> which is the square of the current complex number.
    */

    public ComplexNumber square()
    {
        double _real = this.real*this.real - this.imaginary*this.imaginary;
        double _imaginary = 2*this.real*this.imaginary;
        return new ComplexNumber(_real,_imaginary);
    }
    /**
    * @return the complex number in x + yi format
    */
    @Override
    public String toString()
    {
        String re = this.real+"";
        String im = "";
        if(this.imaginary < 0)
            im = this.imaginary+"i";
        else
            im = "+"+this.imaginary+"i";
        return re+im;
    }
    /**
    * Calculates the exponential of the <code>ComplexNumber</code>
    * @param z The input complex number
    * @return a <code>ComplexNumber</code> which is e^(input z)
    */
    public static ComplexNumber exp(ComplexNumber z)
    {
        double a = z.real;
        double b = z.imaginary;
        double r = Math.exp(a);
        a = r*Math.cos(b);
        b = r*Math.sin(b);
        return new ComplexNumber(a,b);
    }
    /**
    * Calculates the <code>ComplexNumber</code> to the passed integer power.
    * @param z The input complex number
    * @param power The power.
    * @return a <code>ComplexNumber</code> which is (z)^power
    */
    public static ComplexNumber pow(ComplexNumber z, int power)
    {
        ComplexNumber output = new ComplexNumber(z.getRe(),z.getIm());
        for(int i = 1; i < power; i++)
        {
            double _real = output.real*z.real - output.imaginary*z.imaginary;
            double _imaginary = output.real*z.imaginary + output.imaginary*z.real;
            output = new ComplexNumber(_real,_imaginary);
        }
        return output;
    }
    /**
    * Calculates the sine of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the sine of z.
    */
    public static ComplexNumber sin(ComplexNumber z)
    {
        double x = Math.exp(z.imaginary);
        double x_inv = 1/x;
        double r = Math.sin(z.real) * (x + x_inv)/2;
        double i = Math.cos(z.real) * (x - x_inv)/2;
        return new ComplexNumber(r,i);
    }
    /**
    * Calculates the cosine of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the cosine of z.
    */
    public static ComplexNumber cos(ComplexNumber z)
    {
        double x = Math.exp(z.imaginary);
        double x_inv = 1/x;
        double r = Math.cos(z.real) * (x + x_inv)/2;
        double i = -Math.sin(z.real) * (x - x_inv)/2;
        return new ComplexNumber(r,i);
    }
    /**
    * Calculates the tangent of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the tangent of z.
    */
    public static ComplexNumber tan(ComplexNumber z)
    {
        return divide(sin(z),cos(z));
    }
    /**
    * Calculates the co-tangent of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the co-tangent of z.
    */
    public static ComplexNumber cot(ComplexNumber z)
    {
        return divide(new ComplexNumber(1,0),tan(z));
    }
    /**
    * Calculates the secant of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the secant of z.
    */
    public static ComplexNumber sec(ComplexNumber z)
    {
        return divide(new ComplexNumber(1,0),cos(z));
    }
    /**
    * Calculates the co-secant of the <code>ComplexNumber</code>
    * @param z the input complex number
    * @return a <code>ComplexNumber</code> which is the co-secant of z.
    */
    public static ComplexNumber cosec(ComplexNumber z)
    {
        return divide(new ComplexNumber(1,0),sin(z));
    }
    /**
    * The real part of <code>ComplexNumber</code>
    * @return the real part of the complex number
    */
    public double getRe()
    {
        return this.real;
    }
    /**
    * The imaginary part of <code>ComplexNumber</code>
    * @return the imaginary part of the complex number
    */
    public double getIm()
    {
        return this.imaginary;
    }
    /**
    * The argument/phase of the current complex number.
    * @return arg(z) - the argument of current complex number
    */
    public double getArg()
    {
        return Math.atan2(imaginary,real);
    }
    /**
    * Parses the <code>String</code> as a <code>ComplexNumber</code> of type x+yi.
    * @param s the input complex number as string
    * @return a <code>ComplexNumber</code> which is represented by the string.
    */
    public static ComplexNumber parseComplex(String s)
    {
        s = s.replaceAll(" ","");
        ComplexNumber parsed = null;
        if(s.contains(String.valueOf("+")) || (s.contains(String.valueOf("-")) && s.lastIndexOf('-') > 0))
        {
            String re = "";
            String im = "";
            s = s.replaceAll("i","");
            s = s.replaceAll("I","");
            if(s.indexOf('+') > 0)
            {
                re = s.substring(0,s.indexOf('+'));
                im = s.substring(s.indexOf('+')+1,s.length());
                parsed = new ComplexNumber(Double.parseDouble(re),Double.parseDouble(im));
            }
            else if(s.lastIndexOf('-') > 0)
            {
                re = s.substring(0,s.lastIndexOf('-'));
                im = s.substring(s.lastIndexOf('-')+1,s.length());
                parsed = new ComplexNumber(Double.parseDouble(re),-Double.parseDouble(im));
            }
        }
        else
        {
            // Pure imaginary number
            if(s.endsWith("i") || s.endsWith("I"))
            {
                s = s.replaceAll("i","");
                s = s.replaceAll("I","");
                parsed = new ComplexNumber(0, Double.parseDouble(s));
            }
            // Pure real number
            else
            {
                parsed = new ComplexNumber(Double.parseDouble(s),0);
            }
        }
        return parsed;
    }
    /**
    * Checks if the passed <code>ComplexNumber</code> is equal to the current.
    * @param z the complex number to be checked
    * @return true if they are equal, false otherwise
    */
    @Override
    public final boolean equals(Object z) 
    {
        if (!(z instanceof ComplexNumber))
            return false;
        ComplexNumber a = (ComplexNumber) z;
        return (real == a.real) && (imaginary == a.imaginary);
    }
    /**
    * The inverse/reciprocal of the complex number.
    * @return the reciprocal of current complex number.
    */
    public ComplexNumber inverse()
    {
        return divide(new ComplexNumber(1,0),this);
    }
    /**
    * Formats the Complex number as x+yi or r.cis(theta)
    * @param format_id the format ID <code>ComplexNumber.XY</code> or <code>ComplexNumber.RCIS</code>.
    * @return a string representation of the complex number
    * @throws IllegalArgumentException if the format_id does not match.
    */
    public String format(int format_id) throws IllegalArgumentException
    {
        String out = "";
        if(format_id == XY)
            out = toString();
        else if(format_id == RCIS)
        {
            out = mod()+" cis("+getArg()+")";
        }
        else
        {
            throw new IllegalArgumentException("Unknown Complex Number format.");
        }
        return out;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-11T05:30:22.020

看看这个简单的程序。

```
class Com{
        int real,img;
        Com (int r, int i){
            real = r;
            img  = i;
        }
        void add(Com c){
            real = real + c.real;
            img = img + c.img;
        }
        void print(){
            System.out.println(real+" +i"+img);
        }
    }
    public class complex {
        public static void main(String [] args){
            Com c1 = new Com(10,20);
            c1.print();
            Com c2 = new Com(20,10);
            c1.add(c2);
            c1.print();
        }
    } 
```

# python - ImportError，在谷歌应用引擎中使用 pytz

> ID：10843148
> 
> 赞同：1
> 
> 时间：2012-06-01T00:57:23.883
> 
> 标签：python, google-app-engine, pytz

我正在尝试在我的网络应用程序中使用 pytz 将时区应用于日期时间对象。首先我尝试像这样导入pytz

```
from pytz import timezone 
```

然后它引发了一个 ImportError 说模块“pytz”不存在。我在 IDLE 中尝试了相同的代码行，它运行良好。然后我在网上看到了一些关于 gae-pytz 的东西。所以我将代码更改为如下所示：

```
from pytz.gae import pytz
from pytz import timezone 
```

就像网页上说的那样。它仍然有 ImportError。它说：

```
ImportError: No module named pytz.gae 
```

我认为问题可能是我使用的是 python 2.5 的 gae 版本。有人知道出了什么问题吗？或者也许有人知道 pytz 的替代方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T01:25:17.680

我使用 gae-pytz，效果很好。看起来你可能有路径问题。pytz 目录是否在您的应用引擎项目的根目录中？那是它应该在的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T12:26:56.963

pytz 或 pytz.gae 均未包含在默认 App Engine SDK 中。

如果您想使用 pytz.gae 模块，您需要下载它并将其复制到您的应用程序文件夹中。

下面的导入行假定您在 appengine 应用程序源的根文件夹下的“pytz”文件夹中拥有 gae.py 文件。

您可以从这里下载 pytz.gae 模块： [https ://code.google.com/p/gae-pytz/](https://code.google.com/p/gae-pytz/)

我将它与 Python 2.7 GAE 应用程序一起使用，它运行良好。

# c# - 如何在不刷新的情况下打开新窗口？

> ID：10843151
> 
> 赞同：0
> 
> 时间：2012-06-01T00:58:18.927
> 
> 标签：c#, asp.net, visual-studio-2010

我在我的应用程序中实现了这段代码，但是每当我点击链接时，它确实可以帮助我打开一个新窗口。但原来的页面是“刷新”的，它一直回到顶部。我该如何解决这个问题？

代码：

```
 Response.Write("<script>window.open('" + url + "')</script>"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T01:04:58.610

据我了解，每次单击链接时，页面都会发送到处理事件的服务器（使用一些 C#）。如果你这样做，服务器将把整个页面发回。

您可能想在客户端使用一些 Javascript 来控制它。

也就是说，您可能正在寻找的是链接的属性目标：

```
<a href="url" target="_blank">something</a> 
```

当用户单击链接时，这将告诉浏览器您要打开另一个选项卡或窗口，然后在该选项卡或窗口中请求由 url 指定的页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:02:04.463

听起来你想要 Response.Redirect(myURL)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T01:02:25.570

当你点击链接并在后面的代码中处理它时，这意味着链接是在服务器端运行的，所以它必须回发，这看起来像是在“刷新”，但实际上是在回发。
您需要通过 Javascript 在客户端处理打开新窗口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T01:03:19.780

如果您将其写入您的页面，这会将您重定向到您想要的网址

```
Response.Write("<script>;location.href='" + url + "'</script>"); 
```

# jquery - 更改名为 fancybox 的 jquery 插件的背景透明度

> ID：10843152
> 
> 赞同：0
> 
> 时间：2012-06-01T00:58:22.297
> 
> 标签：jquery, css, fancybox, transparency

我正在使用 fancybox 作为图片库。我目前正在尝试设置它，以便图像更改时的背景框是半透明的。我想出了如何为css添加不透明度，但它也使图片半透明。

这就是我改变css的方式：

```
.fancybox-skin {
    position: relative;
    padding: 0;
    margin: 0;
    /*background: #f9f9f9;*/
    background: #111111;
    opacity:0.6;
    color: #444;
    text-shadow: none;
    -webkit-border-radius: 4px;
       -moz-border-radius: 4px;
            border-radius: 4px;
} 
```

谢谢，

营汤1988

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T01:20:16.083

最简单的方法是仅通过设置 alpha 通道背景为 CSS3 浏览器更改它：

```
background: rgba(17,17,17,0.6); /* equals #111111 at 60% opacity */ 
```

并删除你的`opacity: 0.6`. 该`opacity`属性导致元素及其所有子元素具有不透明度并且无法从中恢复。

# php - Zend __construct 致命错误

> ID：10843157
> 
> 赞同：0
> 
> 时间：2012-06-01T00:58:48.990
> 
> 标签：php, zend-framework

我正在尝试集成`Zend_Acl`到我的应用程序中：

```
class AuthController extends Zend_Controller_Action
{
    public function __construct (Zend_Auth $auth, Zend_Acl $acl)
    {
        $this->_auth = $auth;
        $this->_acl  = $acl;
    }
} 
```

但我收到了这个错误：

> AuthController::__construct() 的声明必须与 Zend_Controller_Action_Interface::__construct() 的声明兼容......

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T10:58:41.257

你可以使用一个插件：

```
//This class effectively extends Zend_Controller_Front
//This plugin will dispatch with every request and provide user access control
//based on credentials provided at login.
class MY_Controller_Plugin_Acl extends Zend_Controller_Plugin_Abstract
{
    public function preDispatch(Zend_Controller_Request_Abstract $request) {
        parent::preDispatch($request);
        //setup ACL
        $acl = new Zend_Acl();
        //add Roles
        $acl->addRole('guest');
        //add Resources
        $acl->add(new Zend_Acl_Resource('default'));
        //set up access rules, everyone has access to the index page and the error page.
        $acl->allow(NULL, array('index', 'error'));
        $acl->allow(NULL, array('index', 'index'));
        //a guest can only read content and login
        $acl->allow('guest', 'page', array('index'));
        //more ...
        //fetch current user, $auth is set in loginAction()
        $auth = Zend_Auth::getInstance();
        if ($auth->hasIdentity()) {
            $identity = $auth->getIdentity();
            $role = strtolower($identity->role);
        } else {
            $role = 'guest';
        }
        $module = $request->getModuleName();
        $controller = $request->getControllerName();
        $action = $request->getActionName();

        if (!$acl->isAllowed($role, $module, $controller, $action)) {
            if ($role == 'guest') {
                $request->setControllerName('user');
                $request->setActionName('login');
            } else {
                $request->setControllerName('error');
                $request->setActionName('noauth');
            }
        }
    }
} 
```

在 application.ini 中注册插件：

```
resources.frontController.plugins.acl = "My_Controller_Plugin_Acl" 
```

这只是一个（简单）实现，有很多方法可以给这只猫剥皮。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T07:10:25.027

你永远不会启动控制器实例，因为它的工作是 Zend_Controller_Front 为你做这件事，因此你不能使用它的构造函数。但是你可以做的是使用 Zend_Registry

在您的 Bootstrap.php 中

```
Zend_Registry::set('acl',$acl);
Zend_Registry::set('auth',$auth); 
```

在您的控制器中

```
public function init()
{
  $this->_acl = Zend_Registry::get('acl');
  $this->_auth = Zend_Registry::get('auth');
} 
```

这个 init 函数充当构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T01:04:38.550

`Zend_Controller_Action_Interface`对于构造函数看起来像这样：

```
public function __construct(Zend_Controller_Request_Abstract $request,
                            Zend_Controller_Response_Abstract $response,
                            array $invokeArgs = array()); 
```

这意味着您的类必须具有相同的构造函数声明

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T01:15:54.423

由于您无法更改构造函数，因此您必须以不同的方式传递 ACL。另请记住，您可以`Zend_Auth`随时通过调用访问`Zend_Auth::getInstance()`。

要访问您的 ACL，您可以使用`Zend_Registry`. 如果您在引导程序中定义 ACL，请将其放在注册表中。然后，您可以通过注册表访问它，甚至可以编写一个新类 extends `Zend_Controller_Action`，它提供了一种检索 ACL 的方法。

# xpath - XQuery 输入错误：WSO2 ESB 的预期元素的文档节点类型

> ID：10843159
> 
> 赞同：0
> 
> 时间：2012-06-01T00:58:56.877
> 
> 标签：xpath, wso2, xquery, wso2esb, esb

我在我的 WSO2 ESB 上定义了一个代理服务，它使用 XQuery 转换传入的消息（我正在关注[Sample 390](http://wso2.org/project/esb/java/4.0.3/docs/samples/advanced_mediation_samples.html#Sample390)）。

问题在于 ESB 将定义为 的变量转换`payload`为定义为`ELEMENT`的 XQuery 变量`document-node()`。但是，我的 XQuery 只接受`element`() ：

```
declare variable $payload as element(ns:payload) external; 
```

有什么方法可以定义 ESB 变量或修改变量表达式以便输入到 XQuery 中`element`？

我试过 ：

```
<xquery key="xquery-key-req">
<variable xmlns:nms="http://my.nms.com" name="payload" expression="$body/nms:payload" type="ELEMENT" />
</xquery> 
```

但这会返回以下错误：

```
Required item type of first argument of xf:xqueryRequest() is element({http://my.nms.com}payload); supplied value has item type document-node(element({http://my.nms.com}payload)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T08:05:59.247

好吧，您要么必须更改查询以期望文档节点，要么必须更改查询的客户端以提供元素。我不知道 ESB，所以我不知道如何在那里进行更改，但是更改查询很容易：

```
declare variable $payloadDoc as document-node(element(ns:payload)) external;
declare variable $payload as element(ns:payload) := $payloadDoc/ns:payload; 
```

# objective-c - 是否可以在 Objective C 的更新过程中隐藏按钮？

> ID：10843160
> 
> 赞同：1
> 
> 时间：2012-06-01T00:58:57.303
> 
> 标签：objective-c, xcode

我有以下问题：我希望用户在按下按钮时进行下载。在此下载过程中，我想隐藏其他按钮（这将打开下载的文件，因此我想确保在更新尚未完成时没有人尝试打开文件）。在此过程中是否可以隐藏这些按钮？

所以到目前为止我所尝试和经历的：

*   我总是在最后更改按钮（当不再需要时，因为更新完成）。

我尝试了以下（伪代码）：

```
-(void)updatingprogress
{
    buttona.hidden=TRUE;
}

-(void)updatingfinished
{
    buttona.hidden=FALSE;
}

updateFiles()
{
[self updatingprogress]
... make downloads...
[self updatingfinished]
} 
```

因此，通过记录我看到，我可以在我想要的那一刻进入我的功能，但是在“更新进度”期间没有完成按钮的更改。任何想法如何解决这个问题？谢谢和最好的问候！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T01:05:55.037

一个常见问题是您试图在后台线程上更新 UI 元素。如果您的`updateFiles`方法发生在不同的线程上，您的按钮可能无法正确隐藏。要将方法分派到主线程，您可以使用`NSOperationQueue`API 或`GCD`API。

NSOperationQueue：

```
[[NSOperationQueue mainQueue] addBlockOperation:^ {
    buttona.hidden = YES;
}]; 
```

GCD：

```
dispatch_async(dispatch_get_main_queue(), ^ {
    buttona.hidden = YES;
}); 
```

这两个 API 都做同样的事情。我通常会尝试使用[尽可能高的抽象](http://eschatologist.net/blog/?p=232)，所以在这种情况下我会使用该`NSOperationQueue`方法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:33:57.123

另一种可能性是您正在主线程上完成所有工作，但没有考虑到这样一个事实：通常，UIKit 更改在您下拉到运行循环之前不会生效。

背景逻辑是您不希望部分更改可见，例如，如果您写：

```
// okay, set to success
label.textColor = [UIColor greenColor];  // was previously red
label.text = @"Success";                 // previously said 'Failure' 
```

您明确不希望“失败”一词以绿色显示，然后将“成功”一词更改为“成功”。您希望这两个更改以原子方式发生。Apple 通过将 UIKit 更新批处理并在您计划的任何方法之外影响它们来实现这一点。

因此，如果您在主线程上有一个函数，它做了一些 UI 更改，做了一些工作，然后撤消了 UI 更改，但在任何时候都没有退出到 runloop，那么这些更改将永远不会被看到。

最快的解决方案是：

```
- (void)updateFiles
{
    [self updatingProgress];
    [self performSelector:@selector(doFileUpdate) withObject:nil afterDelay:0.0];

    // what does the above achieve? It schedules doFileUpdate on the runloop, to
    // occur as soon as possible, but doesn't branch into it now. So when this
    // method returns UIKit will update your display
}

- (void)doFileUpdate
{
    /* heavy lifting here */
    [self updatingFinished];
} 
```

# facebook - 寻找一种在我的文章上有一个 facebook “Like Gate” 的方法

> ID：10843162
> 
> 赞同：0
> 
> 时间：2012-06-01T00:59:30.607
> 
> 标签：facebook, wordpress

我希望在我的文章中添加一个 Like Gate，类似于在此博客上看到的内容：

[http://www.wetpaint.com/the-bachelorette/articles/reality-steve-on-bachelor-pad-3-two-of-emilys-guys-join-the-cast-plus-whos-returning](http://www.wetpaint.com/the-bachelorette/articles/reality-steve-on-bachelor-pad-3-two-of-emilys-guys-join-the-cast-plus-whos-returning)

谁能指出我可以实现这一点的方向？是插件还是自定义代码？任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:00:47.570

参考站点所拥有的是一个模式对话框，该对话框被其中一个链接上的 onClick 事件解除。其中一个链接会让您喜欢 Facebook。还有另一个“不，谢谢”链接仅显示内容。

页面底部的 Facebook 弹出窗口是[Facebook 推荐栏](https://developers.facebook.com/docs/reference/plugins/recommendationsbar/)。该链接将您带到官方文档。这允许您的网站向访问者的新闻提要发布“*您*刚刚阅读了*本网站*上的*一些文章”。*

 *不再允许使用真正的门。Facebook 已经弃用了大多数使类似门成为可能的方法。请参阅[Facebook 平台政策第 IV 部分。第 1 点](https://developers.facebook.com/policy/#integration)说“你不能……在……Facebook 社交渠道后面屏蔽内容……”“不，谢谢”链接使它们符合 TOS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:04:16.427

您可能正在寻找 Facebook 的网站。你可以在这里阅读更多... [http://developers.facebook.com/docs/guides/web/](http://developers.facebook.com/docs/guides/web/)*

# android - Android AdMob 无法设置为测试模式

> ID：10843164
> 
> 赞同：0
> 
> 时间：2012-06-01T01:00:24.490
> 
> 标签：android

行 adView.setTesting(true); 给 ea 错误说方法不退出，代码 blocksetTesting adView = new AdView(this, AdSize.BANNER, "a14e10cb6b18825"); ad = new AdView(this, AdSize.BANNER, "a14e10cb6b18825");

```
 // Lookup your LinearLayout assuming it’s been given
    // the attribute android:id="@+id/mainLayout"
    LinearLayout layout = (LinearLayout)findViewById(R.id.mainLayout);

    // Add the adView to it
    layout.addView(adView);

    // Initiate a generic request to load it with an ad
    adView.setTesting(true);

    adView.loadAd(new AdRequest()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T01:28:26.730

我对`setTesting()`api调用不熟悉。在我的 AdMob 代码中，我使用

```
AdRequest adRequest = new AdRequest();
adRequest.addTestDevice(MY_TEST_DEVICE_ID);
adView.loadAd(adRequest); 
```

当我运行代码并且我没有指定测试设备时，我通常会在`LOGCAT`告诉我使用`addTestDevice`api添加我的设备 ID 时看到一条日志消息

# c# - 使用三重 DES 解密数据在原文末尾添加“\0\0\0\0\0\0\0\0”

> ID：10843166
> 
> 赞同：0
> 
> 时间：2012-06-01T01:00:39.373
> 
> 标签：c#, php, encryption

我正在使用 Triple DES 算法使用 PHP 加密数据。然后，我使用 C# Windows 窗体应用程序对其进行解密。

有了一些数据，当我解密它时，我发现`\0\0\0\0\0\0\0\0`原始文本的末尾是用 PHP 加密的。可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T01:03:42.250

加密算法要求数据是一定字节数的倍数。如果数据的长度不正确，则会添加空字符来填充数据。这是你解密后看到的。这是意料之中的，您只需要剥离它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:05:24.023

`mcrypt_encrypt`默认情况下使用零填充的错误选择。[而是使用 PKCS7 填充，如mcrypt_encrypt](http://www.php.net/manual/en/function.mcrypt-encrypt.php)页面上的用户评论中所述。

# javascript - 动态、异步加载 JS 和 IE 6 内存泄漏

> ID：10843169
> 
> 赞同：1
> 
> 时间：2012-06-01T01:01:41.390
> 
> 标签：javascript, internet-explorer, memory-leaks

我选择了一个项目来实现按需脚本加载器（在本例中，用于 HTML5/Flash 视频播放器）。我不想使用库，也不想 XHR/AJAX 它。（一些库的常见选择，例如当前版本的 jQuery - 即，`getScript`。）我引用了几段代码，包括旧版本的 jQuery，它`getScript`用于`document.createElement("script")`创建抓取代码的 DOM 元素。看着它，他们做了一些奇怪的事情，其中​​最大的就是设置元素`null`的`onload`和`onreadystatechange`属性。`script`他们也会`script`从 DOM 中删除/移除元素。

我理解为什么第一件事是必要的，以防止 IE 6 的引用计数问题，而不是在 DOM 元素或事件处理函数已经使用时进行垃圾收集。但是也删除`script`元素......有必要吗？即使`script`元素已被删除，脚本以及其中尚未执行的任何代码仍会运行吗？我想它会的；我从来没有删除过`script`任何类型的元素，无论是最初是文档的一部分（静态）还是动态插入（动态）。

# python - Numpy.select 从 3D 数组

> ID：10843171
> 
> 赞同：0
> 
> 时间：2012-06-01T01:02:01.780
> 
> 标签：python, numpy, iteration

假设我有以下 numpy 数组：

```
>>a
array([[0, 0, 2],
       [2, 0, 1],
       [2, 2, 1]])
>>b
array([[2, 2, 0],
       [2, 0, 2],
       [1, 1, 2]]) 
```

然后我垂直堆叠

```
c=np.dstack((a,b)) 
```

导致：

```
>>c
array([[[0, 2],
        [0, 2],
        [2, 0]],

       [[2, 2],
        [0, 0],
        [1, 2]],

       [[2, 1],
        [2, 1],
        [1, 2]]]) 
```

由此我希望，对于 c 的每个第三维，检查该子数组中存在哪个组合，然后使用列表匹配的索引对其进行相应的编号。我尝试了以下方法，但它不起作用。该算法使用双 for 循环很简单，但由于 c 非常大，因此速度非常慢。

```
classes=[(0,0),(2,1),(2,2)]
out=np.select( [h==c for h in classes], range(len(classes)), default=-1) 
```

我想要的输出是

```
out = [[-1,-1,-1],
       [3,  1,-1],
       [2,  2,-1]] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:00:21.990

这个怎么样：

```
(np.array([np.array(h)[...,:] == c for h in classes]).all(axis = -1) *
         (2 + np.arange(len(classes)))[:, None, None]).max(axis=0) - 1 
```

它返回，你真正需要什么

```
array([[-1, -1, -1],
       [ 3,  1, -1],
       [ 2,  2, -1]]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T02:02:35.913

您可以像这样分别测试 a 和 b 数组：

```
clsa = (0,2,2)
clesb = (0,1,2)

np.select ( [(ca==a) & (cb==b) for ca,cb in zip (clsa, clsb)], range (3), default = -1) 
```

得到你想要的结果（除了返回 0,1,2 而不是 1,2,3）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T05:59:51.543

这是获得您想要的东西的另一种方法，我想我会发布它以防它对任何人有用。

```
import numpy as np

a = np.array([[0, 0, 2],
              [2, 0, 1],
              [2, 2, 1]])
b = np.array([[2, 2, 0],
              [2, 0, 2],
              [1, 1, 2]])
classes=[(0,0),(2,1),(2,2)]

c = np.empty(a.shape, dtype=[('a', a.dtype), ('b', b.dtype)])
c['a'] = a
c['b'] = b
classes = np.array(classes, dtype=c.dtype)
classes.sort()
out = classes.searchsorted(c)
out = np.where(c == classes[out], out+1, -1)
print out
#array([[-1, -1, -1]
#       [ 3,  1, -1]
#       [ 2,  1, -1]]) 
```

# javascript - socket.io 从两个房间加入客户端

> ID：10843175
> 
> 赞同：4
> 
> 时间：2012-06-01T01:02:31.113
> 
> 标签：javascript, node.js, chat, socket.io

我想将两个房间的客户加入一个新房间。有没有办法做到这一点？像：

```
io.sockets.clients(room1 , room2).join(room 3); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T06:11:57.507

```
var rooms = ['room1', 'room2', room3]; // list of rooms

socket.join('room1'); // assign the room on connection

var clients = io.sockets.clients(rooms[0]); // list of all clients in room1

for (client in clients)
    {
        clients[client].leave(rooms[0]); // leave room1
        clients[client].join(rooms[2]); // join room3
    } 
```

对房间 2 重复相同的操作。希望这可以帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-30T04:55:50.657

**对于使用 socket.IO 1.0 或更高版本的人，这可能不起作用。**尝试以下代码。

```
var clients = io.sockets.adapter.rooms['Current Room Name'];

for (var clientId in clients ) {

     //this is the socket of each client in the room.
     var clientSocket = io.sockets.connected[clientId];

     //If you want, you can remove the client form the first(current) room
     //clientSocket.leave('current room');

     clientSocket.join('new room to join');   

} 
```

# c++ - 使用与位置无关的代码按值和指针传递

> ID：10843176
> 
> 赞同：3
> 
> 时间：2012-06-01T01:02:34.700
> 
> 标签：c++, gcc, copy, fpic

我一直在尝试找出与位置无关代码有关的一些事情，特别是使用 gcc 和`-fpic`.

我编写了一个函数，该函数测量多次在堆栈中传递指针所花费的时间，然后通过传递副本来执行相同的操作。在我的示例中，我看到的效果仅适用于没有继承或虚函数的结构或简单类。

为什么使用 PIC 时指针会变慢（一点点）？和没有 PIC 的情况相比，为什么副本会变得更快？

我`-03`也在编译。

```
class basicClass
{
    private:
    char ar[2000];
};

void PassCopy(basicClass cpy)
{
    static long count = 0;
    count++;
    if(count < 100000)
    PassCopy(cpy);
}

void PassPtr(basicClass * ptr)
{
    static long count = 0;
    count++;
    if(count < 100000)
        PassRegPtr(ptr);
}

void RunCopyTest()
{
    basicClass c;

    timeval tv1, tv2;

    gettimeofday(&tv1, NULL);
    PassCopy(c);
    gettimeofday(&tv2, NULL);

    long long diff1 = (tv2.tv_sec * MICROSECONDS_PER_SEC + tv2.tv_usec)
                    - (tv1.tv_sec * MICROSECONDS_PER_SEC + tv1.tv_usec);

    basicClass *pc= new basicClass();
    gettimeofday(&tv1, NULL);
    PassRegPtr(pc);
    gettimeofday(&tv2, NULL);
    delete pc;

    long long diff2 = (tv2.tv_sec * MICROSECONDS_PER_SEC + tv2.tv_usec)
                    - (tv1.tv_sec * MICROSECONDS_PER_SEC + tv1.tv_usec);

    std::cout << "Diff 1 = " << diff1 << " Diff 2 = " << diff2 << std::endl;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-04T03:43:38.557

您的代码使用尾递归，因此在 处`-O3`，代码被优化为 while 循环。因此，您的代码实际上是在衡量带有和不带有`-fPIC`.

`-fPIC`当您尝试优化共享库（标志的最常见用法）时，需要考虑很多事情。如果您还没有这样做，请参阅 Ulrich Drepper 的优秀文章“如何编写共享库”。

# android - Android - 在 html webview 中添加图像

> ID：10843178
> 
> 赞同：4
> 
> 时间：2012-06-01T01:02:49.740
> 
> 标签：android, html, android-webview

好的，所以我使用的图像称为 test.png，我有一个 java 类 (Cherry.java) 和一个 xml 类 (cherry.xml) 我在 /res/raw 文件夹中有一个名为 htmltest.html 的 html 文件. 我想要做的是当用户单击上一页上的按钮然后将它们带到cherry.xml 时，它只是一个webview。现在在 java 类中它只是打开了 htmltest 文件，而在 html 文件中只是一个普通的基于 web 的布局。我想在 html 文件中显示图像，以便在可绘制文件夹中显示图像或类似的图像，而无需使用互联网。（不希望使用互联网权限）。以下是我拥有的 3 个文件的代码。

樱桃.xml

```
<WebView 
    android:id="@+id/webviewHelp"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"  /> 
```

樱桃.java

```
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import android.app.Activity;
import android.os.Bundle;
import android.webkit.WebView;

public class Cherry extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.cherry);

        WebView webview = (WebView) findViewById(R.id.webviewHelp);
        webview.loadData(readTextFromResource(R.raw.htmltest), "text/html", "utf-8");   

    }

    private String readTextFromResource(int resourceID)
    {
        InputStream raw = getResources().openRawResource(resourceID);
        ByteArrayOutputStream stream = new ByteArrayOutputStream();
        int i;
        try
        {
            i = raw.read();
        while (i != -1)
        {
            stream.write(i);
            i = raw.read();
        }
        raw.close();
         }
         catch (IOException e)
         {
        e.printStackTrace();
         }
        return stream.toString();
    }

} 
```

htmltest.html

```
<html>
<body>

<h1>My First Heading</h1>

<p>My first paragraph.</p>

<h2>Pictures</h2>
<img border="0" src="file:///android_drawable/test.png" alt="nothing" width="304" height="228" />

</body>
</html> 
```

任何更多的问题只是问，我会尽快回复。一切正常，只是我无法显示的图像。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T03:59:14.300

首先欢迎来到stackoverflow。

现在将您的 html 和图像等放入 Assets 文件夹中。并使用以下代码。

樱桃.java

```
WebView webview = (WebView) findViewById(R.id.abtus_webView);
webview.loadUrl("file:///android_asset/index.html"); 
```

htmltest.html

```
<img src="images/abc.png"> 
```

我已将图像放入 Assets 文件夹中的图像文件夹中。这对我有用，希望对您有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T02:25:11.080

创建这个目录`assets/www`

然后将您的 html 和图像等放在`www`文件夹中。并使用以下代码。

樱桃.java

```
webview.loadUrl("file:///android_asset/www/htmltest.html"); 
```

htmltest.html

```
<img border="0" src="../res/drawable-hdpi/test.png" alt="nothing" width="304" height="228" /> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-17T10:08:54.793

修改图片路径即可

从：

`file:///android_drawable/test.png`

到：

`file:///android_res/drawable/test.png`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-20T22:17:20.160

如果您的图像很小。将它们转换为 Base64 编码。

在这里解释：http: [//dean.edwards.name/my/base64-ie.html](http://dean.edwards.name/my/base64-ie.html)

# python - Python 函数参数的命名法

> ID：10843183
> 
> 赞同：1
> 
> 时间：2012-06-01T01:03:28.470
> 
> 标签：python

```
args = [4,5]
kwargs = {'x': 7}
func(a, b=2, *args, **kwargs) 
```

指代 a、b、args 和 kwargs 的公认命名法是什么？

具体来说，请在此处填写空白：

```
'a' is a (_blank_) positional argument
'args' contains (_blank_) positional arguments
'b' is a (_blank_) keyword argument
'kwargs' contains (_blank_) keyword arguments 
```

我正在寻找类似**（*空白*）= {正式/任意长度/实际/可变位置/固定}的东西**

如果我在上面说错了，也请纠正我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T01:29:56.763

正如 Edward Loper 已经描述的那样，您的条款是正确的。你只能更具体：

1.  'a' 是*第一个必需的*位置参数。
2.  'args' 传递*非法*的位置参数。（你知道，因为你在关键字参数之后使用它。）
3.  'b' 是一个*可选*的关键字参数……命名为*b* ……，默认值为 2。
4.  'kwargs' 传递*任意*关键字参数。

    ```
    def punk(a, b, *args, **kwargs):
        print a
        print b
        print args
        print kwargs

    a=1; b=2; args = [4,5]; kwargs={'x':7}
    punk(a, b=b, *args, **kwargs)
    Traceback (most recent call last):
        File "<stdin>", line 1, in <module>
    TypeError: punk() got multiple values for keyword argument 'b' 
    ```

如果您`args`合法使用，您可以说它用于传递可能需要的任意位置参数。

```
>>> punk(a, *args)
1
4
(5,)
{} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:27:57.897

您正在寻找的大部分内容都可以在[Python 教程](http://docs.python.org/tutorial/controlflow.html#defining-functions)中找到。

从左到右：

*   `a`是一个位置参数。
*   `b=3`是一个位置参数，默认值为 3。
*   `*args`是一个任意参数列表，解包为一个元组。
*   `**kwargs`是一个关键字参数，解压缩为字典。

# mongodb - MongoDB中如何存储需要两端访问的数据（双向）

> ID：10843185
> 
> 赞同：0
> 
> 时间：2012-06-01T01:03:31.097
> 
> 标签：mongodb

我有很多球员和球队。球队是由很多球员组成的。玩家可以属于多个团队。我需要找到给定球队的哪些球员或给定球员在哪些球队。

最好使用 DBRefs，一个带有嵌入式团队的玩家集合，一个带有嵌入式玩家的团队集合，两个集合，或者其他什么，或者 MongoDB 在这里根本不是一个好的选择？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T04:54:49.113

我希望您已阅读[此页面](http://www.mongodb.org/display/DOCS/Schema+Design)以及有关 MongoDB 模式设计的多个其他讨论 - 查看类似示例以及其他人正在考虑的内容会非常有帮助。

话虽如此，听起来您的数据集不会很大 - 是吗？如果是这种情况，它对性能的影响可能并不大，您可能应该首先努力设计，以使您的应用程序更清晰和易于访问。

我认为拥有一组球队和一组球员是合理的，然后决定是否要在每个球队中嵌入一组球员来代表该球队中的谁，或者在每个球员文档中嵌入一组球队指示他们所在的团队。该数组可以是 ID 或 ID 和名称等的数组。

无论您选择上述哪个，查询都很容易 - 如果您在球员中嵌入了球队数组，要找出特定球队中的所有球员，您只需查询数组中包含该球队的所有球员。查询可能类似于：

db.players.find({"teams.name":"TeamRocky"})

这将返回在其“团队”数组中具有该团队名称的玩家的所有玩家文档（这只是一个示例，您的实际实现可能完全不同）。如果您在每个团队文档中嵌入播放器数组，那将同样简单。

在决定这一点时要考虑的事情可能不仅包括您将如何查询数据，还包括您希望更新数据的方式和频率——球员是否会从一个团队转移到另一个团队？团队会解散吗？如果是，您是否必须跟踪他们的历史信息等？

我鼓励您尝试一些架构并构建一个小型原型，然后查看看起来有问题的地方并随着您对应用程序需求的熟悉而更改/改进架构。

# php - 使用 Apache 将站点迁移到 IIS7 后，jumpmenus 会输出带有 unicode 而不是所需字符的 URL。如何恢复所需的行为？

> ID：10843186
> 
> 赞同：1
> 
> 时间：2012-06-01T01:03:35.117
> 
> 标签：php, mysql, windows, iis-7

将站点从 Apache 迁移到 IIS7 (Windows Server 2008 R2) 后，Javascript jumpmenus 输出 "%2F" 而不是 "/" 和 "%3A" 而不是 ":" 。以下还显示为 URL "?stage2=" 中的输出。在 Apache 上时，URL 很好。请帮忙..？。.....?...?

```
<form name="doublecombo" target="_parent">
                In:
                <select style="position: relative; top: -58px; left: 55px;" class="jumpmenu" size="1" onChange="redirect(this.options.selectedIndex)">
                  <option>select a category...</option>
                  <option>Grow Stores</option>
                  <option>Dispensaries</option>
                  <option>Cannibas Clubs</option>
                  <option>Physicians</option>
                  <option>State Marijuana Laws</option>
                </select>
                <br>
                <select style="position: relative; top: -64px; left: 55px;" name="stage2" size="1" class="jumpmenu" >
                  <option value="">select a state...</option>
                  <option value="http://mymedicinalgarden.org/alabama-grow-stores" >Alabama</option>
                  <option value="http://mymedicinalgarden.org/alaska-grow-stores">Alaska</option>
                  <option value="http://mymedicinalgarden.org/arizona-grow-stores">Arizona</option>
                  <option value="http://mymedicinalgarden.org/arkansas-grow-stores">Arkansas</option>
                  <option value="http://mymedicinalgarden.org/california-grow-stores">California</option>
                  <option value="http://mymedicinalgarden.org/colorado-grow-stores">Colorado</option>
                  <option value="http://mymedicinalgarden.org/connecticut-grow-stores">Connecticut</option>
                  <option value="http://mymedicinalgarden.org/delaware-grow-stores">Delaware</option>
                  <option value="http://mymedicinalgarden.org/district-of-columbia-grow-stores">District of Columbia</option>
                  <option value="http://mymedicinalgarden.org/florida-grow-stores">Florida</option>
                  <option value="http://mymedicinalgarden.org/georgia-grow-stores">Georgia</option>
                  <option value="http://mymedicinalgarden.org/hawaii-grow-stores">Hawaii</option>
                  <option value="http://mymedicinalgarden.org/idaho-grow-stores">Idaho</option>
                  <option value="http://mymedicinalgarden.org/illinois-grow-stores">Illinois</option>
                  <option value="http://mymedicinalgarden.org/indiana-grow-stores">Indiana</option>
                  <option value="http://mymedicinalgarden.org/iowa-grow-stores">Iowa</option>
                  <option value="http://mymedicinalgarden.org/kansas-grow-stores">Kansas</option>
                  <option value="http://mymedicinalgarden.org/kentucky-grow-stores">Kentucky</option>
                  <option value="http://mymedicinalgarden.org/louisiana-grow-stores">Louisiana</option>
                  <option value="http://mymedicinalgarden.org/maine-grow-stores">Maine</option>
                  <option value="http://mymedicinalgarden.org/maryland-grow-stores">Maryland</option>
                  <option value="http://mymedicinalgarden.org/massachusetts-grow-stores">Massachusetts</option>
                  <option value="http://mymedicinalgarden.org/michigan-grow-stores">Michigan</option>
                  <option value="http://mymedicinalgarden.org/minnesota-grow-stores">Minnesota</option>
                  <option value="http://mymedicinalgarden.org/mississippi-grow-stores">Mississippi</option>
                  <option value="http://mymedicinalgarden.org/missouri-grow-stores">Missouri</option>
                  <option value="http://mymedicinalgarden.org/montana-grow-stores">Montana</option>
                  <option value="http://mymedicinalgarden.org/nebraska-grow-stores">Nebraska</option>
                  <option value="http://mymedicinalgarden.org/nevada-grow-stores">Nevada</option>
                  <option value="http://mymedicinalgarden.org/new-hampshire-grow-stores">New Hampshire</option>
                  <option value="http://mymedicinalgarden.org/new-jersey-grow-stores">New Jersey</option>
                  <option value="http://mymedicinalgarden.org/new-mexico-grow-stores">New Mexico</option>
                  <option value="http://mymedicinalgarden.org/new-york-grow-stores">New York</option>
                  <option value="http://mymedicinalgarden.org/north-carolina-grow-stores">North Carolina</option>
                  <option value="http://mymedicinalgarden.org/north-dakota-grow-stores">North Dakota</option>
                  <option value="http://mymedicinalgarden.org/ohio-grow-stores">Ohio</option>
                  <option value="http://mymedicinalgarden.org/oklahoma-grow-stores">Oklahoma</option>
                  <option value="http://mymedicinalgarden.org/oregon-grow-stores">Oregon</option>
                  <option value="http://mymedicinalgarden.org/pennsylvania-grow-stores">Pennsylvania</option>
                  <option value="http://mymedicinalgarden.org/rhode-island-grow-stores">Rhode Island</option>
                  <option value="http://mymedicinalgarden.org/south-carolina-grow-stores">South Carolina</option>
                  <option value="http://mymedicinalgarden.org/south-dakota-grow-stores">South Dakota</option>
                  <option value="http://mymedicinalgarden.org/tennessee-grow-stores">Tennessee</option>
                  <option value="http://mymedicinalgarden.org/texas-grow-stores">Texas</option>
                  <option value="http://mymedicinalgarden.org/utah-grow-stores">Utah</option>
                  <option value="http://mymedicinalgarden.org/vermont-grow-stores">Vermont</option>
                  <option value="http://mymedicinalgarden.org/virginia-grow-stores">Virginia</option>
                  <option value="http://mymedicinalgarden.org/washington-grow-stores">Washington</option>
                  <option value="http://mymedicinalgarden.org/west-virginia-grow-stores">West Virginia</option>
                  <option value="http://mymedicinalgarden.org/wisconsin-grow-stores">Wisconsin</option>
                  <option value="http://mymedicinalgarden.org/wyoming-grow-stores">Wyoming</option>
                </select>
                <div style="position: relative; top: -58px; left: 70px;">
                  <div class="div38-160">
                    <input type="image" class="sprite38" src="http://mymedicinalgarden.org/buttons/go/go.gif" ONCLICK="go()" />
                  </div>
                </div>
              </form>
              <script>
<!--

var groups=document.doublecombo.example.options.length
var group=new Array(groups)
for (i=0; i<groups; i++)
group[i]=new Array()

group[0][0]=new Option("select state...","")

group[1][0]=new Option("Alabama","http://mymedicinalgarden.org/alabama-grow-stores/")
group[1][1]=new Option("Alaska","http://mymedicinalgarden.org/alaska-grow-stores/")
group[1][2]=new Option("Arizona","http://mymedicinalgarden.org/arizona-grow-stores/")
group[1][3]=new Option("Arkansas","http://mymedicinalgarden.org/arkansas-grow-stores/")
group[1][4]=new Option("Arizona","http://mymedicinalgarden.org/arizona-grow-stores/")
group[1][5]=new Option("California","http://mymedicinalgarden.org/california-grow-stores/")
group[1][6]=new Option("Colorado","http://mymedicinalgarden.org/colorado-grow-stores/")
group[1][7]=new Option("Connecticut","http://mymedicinalgarden.org/connecticut-grow-stores/")
group[1][8]=new Option("Delaware","http://mymedicinalgarden.org/delaware-grow-stores/")
group[1][9]=new Option("District of Columbia","http://mymedicinalgarden.org/district-of-columbia-grow-stores/")
group[1][10]=new Option("Florida","http://mymedicinalgarden.org/florida-grow-stores/")
group[1][11]=new Option("Georgia","http://mymedicinalgarden.org/georgia-grow-stores/")
group[1][12]=new Option("Hawaii","http://mymedicinalgarden.org/hawaii-grow-stores/")
group[1][13]=new Option("Idaho","http://mymedicinalgarden.org/idaho-grow-stores/")
group[1][14]=new Option("Illinois","http://mymedicinalgarden.org/illinois-grow-stores/")
group[1][15]=new Option("Indiana","http://mymedicinalgarden.org/indiana-grow-stores/")
group[1][16]=new Option("Iowa","http://mymedicinalgarden.org/iowa-grow-stores/")
group[1][17]=new Option("Kansas","http://mymedicinalgarden.org/kansas-grow-stores/")
group[1][18]=new Option("Kentucky","http://mymedicinalgarden.org/kentucky-grow-stores/")
group[1][19]=new Option("Louisiana","http://mymedicinalgarden.org/louisiana-grow-stores/")
group[1][20]=new Option("Maine","http://mymedicinalgarden.org/maine-grow-stores/")
group[1][21]=new Option("Maryland","http://mymedicinalgarden.org/maryland-grow-stores/")
group[1][22]=new Option("Massachusetts","http://mymedicinalgarden.org/massachusetts-grow-stores/")
group[1][23]=new Option("Michigan","http://mymedicinalgarden.org/michigan-grow-stores/")
group[1][24]=new Option("Minnesota","http://mymedicinalgarden.org/minnesota-grow-stores/")
group[1][25]=new Option("Mississippi","http://mymedicinalgarden.org/mississippi-grow-stores/")
group[1][26]=new Option("Missouri","http://mymedicinalgarden.org/missouri-grow-stores/")
group[1][27]=new Option("Montana","http://mymedicinalgarden.org/montana-grow-stores/")
group[1][28]=new Option("Nebraska","http://mymedicinalgarden.org/nebraska-grow-stores/")
group[1][29]=new Option("Nevada","http://mymedicinalgarden.org/nevada-grow-stores/")
group[1][30]=new Option("New Hampshire","http://mymedicinalgarden.org/new-hampshire-grow-stores/")
group[1][31]=new Option("New Jersey","http://mymedicinalgarden.org/new-jersey-grow-stores/")
group[1][32]=new Option("New Mexico","http://mymedicinalgarden.org/new-mexico-grow-stores/")
group[1][33]=new Option("New York","http://mymedicinalgarden.org/new-york-grow-stores/")
group[1][34]=new Option("North Carolina","http://mymedicinalgarden.org/north-carolina-grow-stores/")
group[1][35]=new Option("North Dakota","http://mymedicinalgarden.org/north-dakota-grow-stores/")
group[1][36]=new Option("Ohio","http://mymedicinalgarden.org/ohio-grow-stores/")
group[1][37]=new Option("Oklahoma","http://mymedicinalgarden.org/oklahoma-grow-stores/")
group[1][38]=new Option("Oregon","http://mymedicinalgarden.org/oregon-grow-stores/")
group[1][39]=new Option("Pennsylvania","http://mymedicinalgarden.org/pennsylvania-grow-stores/")
group[1][40]=new Option("Rhode Island","http://mymedicinalgarden.org/rhode-island-grow-stores/")
group[1][41]=new Option("South Carolina","http://mymedicinalgarden.org/south-carolina-grow-stores/")
group[1][42]=new Option("South Dakota","http://mymedicinalgarden.org/south-dakota-grow-stores/")
group[1][43]=new Option("Tennessee","http://mymedicinalgarden.org/tennessee-grow-stores/")
group[1][44]=new Option("Texas","http://mymedicinalgarden.org/texas-grow-stores/")
group[1][45]=new Option("Utah","http://mymedicinalgarden.org/utah-grow-stores/")
group[1][46]=new Option("Vermont","http://mymedicinalgarden.org/vermont-grow-stores/")
group[1][47]=new Option("Virginia","http://mymedicinalgarden.org/virginia-grow-stores/")
group[1][48]=new Option("Washington","http://mymedicinalgarden.org/washington-grow-stores/")
group[1][49]=new Option("West Virginia","http://mymedicinalgarden.org/west-virginia-grow-stores/")
group[1][50]=new Option("Wisconsin","http://mymedicinalgarden.org/wisconsin-grow-stores/")
group[1][51]=new Option("Wyoming","http://mymedicinalgarden.org/wyoming-grow-stores/")

group[2][0]=new Option("Alaska","http://mymedicinalgarden.org/alaska-dispensaries/")
group[2][1]=new Option("Arizona","http://mymedicinalgarden.org/arizona-dispensaries/")
group[2][2]=new Option("California","http://mymedicinalgarden.org/california-dispensaries/")
group[2][3]=new Option("Colorado","http://mymedicinalgarden.org/colorado-dispensaries/")
group[2][4]=new Option("Delaware","http://mymedicinalgarden.org/delaware-dispensaries/")
group[2][5]=new Option("Hawaii","http://mymedicinalgarden.org/hawaii-dispensaries/")
group[2][6]=new Option("Maine","http://mymedicinalgarden.org/maine-dispensaries/")
group[2][7]=new Option("Michigan","http://mymedicinalgarden.org/michigan-dispensaries/")
group[2][8]=new Option("Montana","http://mymedicinalgarden.org/montana-dispensaries/")
group[2][9]=new Option("Nevada","http://mymedicinalgarden.org/nevada-dispensaries/")
group[2][10]=new Option("New Jersey","http://mymedicinalgarden.org/new-jersey-dispensaries/")
group[2][11]=new Option("New Mexico","http://mymedicinalgarden.org/new-mexico-dispensaries/")
group[2][12]=new Option("Oregon","http://mymedicinalgarden.org/oregon-dispensaries/")
group[2][13]=new Option("Rhode Island","http://mymedicinalgarden.org/rhode-island-dispensaries/")
group[2][14]=new Option("Vermont","http://mymedicinalgarden.org/vermont-dispensaries/")
group[2][15]=new Option("Washington","http://mymedicinalgarden.org/washington-dispensaries/")
group[2][16]=new Option("","------------------------------------------------------------------")
group[2][17]=new Option("District of Columbia","http://mymedicinalgarden.org/distsrict-of-columbia-dispensaries/")

group[3][0]=new Option("Alaska","http://mymedicinalgarden.org/alaska-cannabis-clubs/")
group[3][1]=new Option("Arizona","http://mymedicinalgarden.org/arizona-cannabis-clubs/")
group[3][2]=new Option("California","http://mymedicinalgarden.org/california-cannabis-clubs/")
group[3][3]=new Option("Colorado","http://mymedicinalgarden.org/colorado-cannabis-clubs/")
group[3][4]=new Option("Delaware","http://mymedicinalgarden.org/delaware-cannabis-clubs/")
group[3][5]=new Option("Hawaii","http://mymedicinalgarden.org/hawaii-cannabis-clubs/")
group[3][6]=new Option("Maine","http://mymedicinalgarden.org/maine-cannabis-clubs/")
group[3][7]=new Option("Michigan","http://mymedicinalgarden.org/michigan-cannabis-clubs/")
group[3][8]=new Option("Montana","http://mymedicinalgarden.org/montana-cannabis-clubs/")
group[3][9]=new Option("Nevada","http://mymedicinalgarden.org/nevada-cannabis-clubs/")
group[3][10]=new Option("New Jersey","http://mymedicinalgarden.org/new-jersey-cannabis-clubs/")
group[3][11]=new Option("New Mexico","http://mymedicinalgarden.org/new-mexico-cannabis-clubs/")
group[3][12]=new Option("Oregon","http://mymedicinalgarden.org/oregon-cannabis-clubs/")
group[3][13]=new Option("Rhode Island","http://mymedicinalgarden.org/rhode-island-cannabis-clubs/")
group[3][14]=new Option("Vermont","http://mymedicinalgarden.org/vermont-cannabis-clubs/")
group[3][15]=new Option("Washington","http://mymedicinalgarden.org/washington-cannabis-clubs/")
group[3][16]=new Option("","------------------------------------------------------------------")
group[3][17]=new Option("District of Columbia","http://mymedicinalgarden.org/distsrict-of-columbia-cannabis-clubs/")

group[4][0]=new Option("Alaska","http://mymedicinalgarden.org/alaska-physicians/")
group[4][1]=new Option("Arizona","http://mymedicinalgarden.org/arizona-physicians/")
group[4][2]=new Option("California","http://mymedicinalgarden.org/california-physicians/")
group[4][3]=new Option("Colorado","http://mymedicinalgarden.org/colorado-physicians/")
group[4][4]=new Option("Delaware","http://mymedicinalgarden.org/delaware-physicians/")
group[4][5]=new Option("Hawaii","http://mymedicinalgarden.org/hawaii-physicians/")
group[4][6]=new Option("Maine","http://mymedicinalgarden.org/maine-physicians/")
group[4][7]=new Option("Michigan","http://mymedicinalgarden.org/michigan-physicians/")
group[4][8]=new Option("Montana","http://mymedicinalgarden.org/montana-physicians/")
group[4][9]=new Option("Nevada","http://mymedicinalgarden.org/nevada-physicians/")
group[4][10]=new Option("New Jersey","http://mymedicinalgarden.org/new-jersey-physicians/")
group[4][11]=new Option("New Mexico","http://mymedicinalgarden.org/new-mexico-physicians/")
group[4][12]=new Option("Oregon","http://mymedicinalgarden.org/oregon-physicians/")
group[4][13]=new Option("Rhode Island","http://mymedicinalgarden.org/rhode-island-physicians/")
group[4][14]=new Option("Vermont","http://mymedicinalgarden.org/vermont-physicians/")
group[4][15]=new Option("Washington","http://mymedicinalgarden.org/washington-physicians/")
group[4][16]=new Option("","------------------------------------------------------------------")
group[4][17]=new Option("District of Columbia","http://mymedicinalgarden.org/distsrict-of-columbia-organizations/")

group[5][0]=new Option("Alaska","http://mymedicinalgarden.org/marijuana-law-alaska/")
group[5][1]=new Option("Arizona","http://mymedicinalgarden.org/marijuana-law-arizona/")
group[5][2]=new Option("California","http://mymedicinalgarden.org/marijuana-law-california/")
group[5][3]=new Option("Colorado","http://mymedicinalgarden.org/marijuana-law-colorado/")
group[5][4]=new Option("Delaware","http://mymedicinalgarden.org/marijuana-law-delaware/")
group[5][5]=new Option("Hawaii","http://mymedicinalgarden.org/marijuana-law-hawaii")
group[5][6]=new Option("Maine","http://mymedicinalgarden.org/marijuana-law-maine/")
group[5][7]=new Option("Michigan","http://mymedicinalgarden.org/marijuana-law-michigan/")
group[5][8]=new Option("Montana","http://mymedicinalgarden.org/marijuana-law-montana/")
group[5][9]=new Option("Nevada","http://mymedicinalgarden.org/marijuana-law-nevada/")
group[5][10]=new Option("New Jersey","http://mymedicinalgarden.org/marijuana-law-new-jersey/")
group[5][11]=new Option("New Mexico","http://mymedicinalgarden.org/marijuana-law-new-mexico/")
group[5][12]=new Option("Oregon","http://mymedicinalgarden.org/marijuana-law-oregon/")
group[5][13]=new Option("Rhode Island","http://mymedicinalgarden.org/marijuana-law-rhode-island/")
group[5][14]=new Option("Vermont","http://mymedicinalgarden.org/marijuana-law-vermont/")
group[5][15]=new Option("Washington","http://mymedicinalgarden.org/marijuana-law-washington/")
group[5][16]=new Option("","------------------------------------------------------------------")
group[5][17]=new Option("District of Columbia","http://mymedicinalgarden.org/marijuana-law-distsrict-of-columbia/")

var temp=document.doublecombo.stage2

function redirect(x){
for (m=temp.options.length-1;m>0;m--)
temp.options[m]=null
for (i=0;i<group[x].length;i++){
temp.options[i]=new Option(group[x][i].text,group[x][i].value)
}
temp.options[0].selected=true
}

function go(){
location=temp.options[temp.selectedIndex].value  

}

//-->
</script> 
```

# c# - 模拟 Excel.worksheet 时如何避免使用动态？

> ID：10843188
> 
> 赞同：10
> 
> 时间：2012-06-01T01:03:53.197
> 
> 标签：c#, excel, mocking, vsto, nsubstitute

我正在尝试使用 NSubstitute 或其他模拟框架和 MSTest (Visual Studio 2010) 模拟 Excel 电子表格。我不确定是否有比这更好的方法——这对测试不太有效：

这是一个例子（这是现在所有的原型代码，不是很干净）：

```
int[] lowerBounds = { 1, 1 };
int[] lengths = { 2, 2 };

//Initialize a 1-based array like Excel does:
object[,] values = (object[,])Array.CreateInstance(typeof(object), lengths, lowerBounds);
values[1,1] = "hello";
values[2,1] = "world";      

//Mock the UsedRange.Value2 property
sheet.UsedRange.Value2.Returns(values); 

//Test:   
GetSetting(sheet, "hello").Should().Be("world");  //FluentAssertions 
```

到目前为止，一切顺利：如果 GetSetting 方法与我的测试**在同一个项目中，则通过。**但是，当 GetSetting 在我的 VSTO Excel-Addin 项目中时，它会在 GetSetting 函数的第一行出现以下错误：

```
System.MissingMethodException: Error: Missing method 'instance object [MyExcel.AddIn] Microsoft.Office.Interop.Excel.Range::get_Value2()' from class 'Castle.Proxies.RangeProxy'. 
```

作为参考，GetSetting 从工作表中的 columnA 中获取一个值，并返回 columnB 中的值。

```
public static string GetSetting(Excel.Worksheet sheet, string settingName) {
  object[,] value = sheet.UsedRange.Value2 as object[,];
  for (int row = 1; row <= value.GetLength(1); row++) {
    if (value[1, row].ToString() == settingName)
      return value[2, row].ToString();
  }
  return "";
} 
```

最后一个有趣的部分是如果我重新定义我的方法的签名如下：
*public static string GetSetting( **dynamic** sheet, string settingName)*
它在 VSTO 项目中工作。

那么发生了什么，做这样的事情的最好方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-25T04:41:45.340

**VS2012 更新：起订量** [和互操作类型：在 VS2012 中有效，在 VS2010 中失败？](https://stackoverflow.com/questions/13202120/moq-interop-types-works-in-vs2012-fails-in-vs2010)

**首先：发生了一些变化：** [在模拟 Excel.worksheet 时如何避免使用动态？](https://stackoverflow.com/questions/10843188/how-do-i-avoid-using-dynamic-when-mocking-an-excel-worksheet)

我在使用 NSubstitute 模拟 Excel 对象时遇到了同样的问题。正如您提到的那样，动态解决了问题。但是我想找到根本原因。

* * *

当您的项目有对您的引用时，`Microsoft.Office.Interop.Excel.Extensions.dll`您需要检查 Embed Interop Types 属性是否可见。如果是这样，则意味着您的目标是 .Net 4.0（我可以从 dynamic 关键字中猜到）。

> 您可以离开面向 .Net 4.0 的测试项目，但您需要将 VSTO 项目 .Net 框架改回 3.5。然后你可能需要做一些明确的转换并完全限定事情来摆脱这些错误：

**C# Office Excel 互操作“对象不包含定义”错误**，这里有几个例子：

**.Net 4.0：**

```
if (tmpsheetName == xlApp.ActiveSheet.Name) 
```

**.Net 3.5 等效**

```
Worksheet activeSheet = (Worksheet)xlApp.ActiveSheet;
if (tmpsheetName == activeSheet.Name) 
```

另一个例子：

```
rn.Select(); 
```

**.Net 4.0**

```
xlApp.Selection.HorizontalAlignment = Constants.xlCenter; 
xlApp.Selection.Font.Bold = true;
xlApp.Selection.Merge(); 
```

**.Net 3.5 等效**

```
rn.HorizontalAlignment = Constants.xlCenter;
rn.Font.Bold = true;
rn.Merge(); 
```

* * *

按照上述示例继续修复所有 .Net 3.5 vs 4.0 语法错误。不要忘记删除`dynamic`参数类型并将其替换为原始`Worksheet`. 最后再次启动测试，它会通过！！！

*鉴于我在此[线程](https://stackoverflow.com/questions/9816243/mocked-object-doesnt-have-all-properties-shown-in-intellisense-in-one-project)中对 Microsoft.CSharp.DLL 所经历的所有悲痛，我认为使用 Mocking Frameworks 测试 VSTO .Net 4.0 项目不起作用。*

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-20T18:47:25.097

事实证明，使用任何基于城堡的框架（nsubstitute、ninject 等）模拟非常复杂的 COM 互操作对象（例如 Excel 对象或 InDesign 对象）并不能提供足够的性能提升。测试的运行时间仍然可以以秒为单位进行测量。（将其乘以数十或数百个测试会使单元测试仍然太慢而无法在 TDD 不断测试的原则下运行。）

测试 Excel 逻辑应该被认为是一个集成测试，因此，针对实际的 Excel 对象运行应该没问题，这使得模拟在这种情况下不是很有用。结果将是针对实际对象的更有用的测试。

测试放置在 Excel 和应用程序之间的抽象层将允许快速测试应用程序逻辑。并且在集成测试下测试抽象层到 Excel 应该足以彻底测试应用程序。

# python - 在 python 和 sqlite3 中缓存数据

> ID：10843191
> 
> 赞同：0
> 
> 时间：2012-06-01T01:04:31.447
> 
> 标签：python, sqlite, fastcgi, lighttpd

1.  在服务器上使用 python(fastcgi)、lighttpd、sqlite3
2.  每个周末更新 sqlite3 的数据。
3.  这意味着，每个用户在周末之前从服务器获取相同的数据，并且服务器为每个用户的请求查询数据库。我的问题是：有没有办法为用户缓存数据，服务器在更新数据之前使用缓存数据来响应所有用户，而不是每次都查询数据库。就像使用一个全局变量一周，直到更新它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T01:46:24.317

您可以使用诸如 memcached 之类的缓存来存储它。

# java - 旋转移动精灵

> ID：10843193
> 
> 赞同：1
> 
> 时间：2012-06-01T01:04:37.037
> 
> 标签：java, android, andengine

我有一个汽车的精灵图像，

我想以某个角度移动。我如何设置它以我想要的角度移动？我想沿旋转方向移动精灵。

有任何想法吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T01:06:49.110

你可以做 box2d body 并使用这个函数 body.setTransform(target,angle);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-06T06:03:56.077

使用 RotationModifier 类，您可以对精灵应用旋转。既然你有一个 initialX, initialY 以及 fatalX, fatalY; 你可以得到 difX 和 difY（destinyX-initialX 和 fortuneY-initialY）。您要应用的角度与这些值有关（角度的切线是 difY/difX）。记住这一点，数学是你的朋友。

由于此解决方案不需要 box2d 扩展，因此您的应用程序会更轻巧。

# c# - 是否有一个预先存在的函数将根据基数和“偏移量”返回一组数字？

> ID：10843198
> 
> 赞同：6
> 
> 时间：2012-06-01T01:05:13.823
> 
> 标签：c#, algorithm, int

我不想重新发明轮子：如果我想从给定的数字中获取 N 范围内的每个整数，那么最有效的方法是什么？

我的意思是这样的：

```
public List<int> getIntsWithinN(int BaseInt, int Offset) 
```

...所以如果传入的参数是 7 和 3，结果将是 4..10；如果传入的 args 是 42 和 7，则结果将是 35..49，等等。

## 更新

好的，我终于开始尝试实现这一点。但我不知道我是否应该像这样将我的 List 传递给 ToList()：

```
List<int> listInts = new List<int>();
. . .
Enumerable.Range(lineNum - Offset, Offset * 2 + 1).ToList(listInts); 
```

...或者这样做：

```
listInts = Enumerable.Range(lineNum - Offset, Offset * 2 + 1).ToList(); 
```

...但我需要做的是多次调用它，所以 Intellisense 描述似乎不是我真正需要的。它说，*“创建一个......列表......”*

但我不希望每次都创建一个新列表，我想附加到现有列表中，最好同时忽略重复项。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-06-01T01:07:35.110

我不认为会有一个函数来解决这个问题，但我认为这是最短和最简单的：

```
Enumerable.Range(BaseInt - Offset, Offset * 2 + 1).ToList() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T22:17:33.810

> 最好同时忽略重复

在那你应该考虑`HashSet<int>`。

```
var hashSet = new HashSet<int>();
hashSet.UnionWith(Enumerable.Range(lineNum - offset, offset * 2 + 1)); 
```

如果你想要一个列表，你可以打电话`ToList()`到`hashSet`最后。您可能还想在转换为列表时对其进行排序，因为`HashSet<T>`将项目保持在未定义的顺序中。

```
var list = hashSet.OrderBy(i=>i).ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T22:33:54.287

你可以制作这样的方法：

```
public static IEnumerable<int> getIntsWithinN(int BaseInt, int Offset)
{
    return getIntsWithinN(Enumerable.Empty<int>(), BaseInt, Offset);
}
public static IEnumerable<int> getIntsWithinN(this IEnumerable<int> source, int BaseInt, int Offset)
{
    return source.Concat(Enumerable.Range(BaseInt - Offset, Offset * 2 + 1));
} 
```

像这样使用：

```
var myBigList = Extensions.getIntsWithinN(7, 3).getIntsWithinN(42, 7); 
```

然后取决于你从那里想要它的方式，例如

```
var withDupsRemoved = new HashSet<int>(myBigList);
var withDupsRemoved = new HashSet<int>(myBigList).OrderBy(x => x).ToList(); 
```

如果插入范围的顺序很重要，但您不希望重复，则可以制作如下列表：

```
var withDupsRemoved = new List<int>();
foreach (var i in myBigList)
    if (!withDupsRemoved.Contains(i))
        withDupsRemoved.Add(i); 
```

如果这成为一个问题，而不是使用 LINQ 的 Concat，您可以滚动您自己的存储范围边界的类，并且当附加两个或更多时，如果存在重叠，则适当地调整范围。

# ruby-on-rails - 如何检查 Rails 中的 URL 或路径？

> ID：10843200
> 
> 赞同：2
> 
> 时间：2012-06-01T01:05:24.807
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个 Rails 应用程序，其中有一个`show`带有表单的操作。此`show`操作使用相应检查`if user_type == "admin"`和显示部分的视图。对于这个`show`视图，只能`if user_type = admin`访问它。

提交表单后，它会触发同一控制器 ( `store`) 中的另一个操作。我遇到的问题是，当提交出现错误时，会在不参考用户的情况下`store`呈现`show`，因此部分不会出现，因为 user_type 不等于 admin（因为它找不到用户）。但是，由于对“show”的访问受到保护，我想知道是否有办法检查 url。

示例：表格在：

```
http://foo.com/bars/4/users/3 
```

但是，当它失败时，渲染 url 变为：

```
http://foo.com/bars/4/users/store 
```

show.html.erb 视图有这个：

```
<%= form_for([:bar,@user], :url => store_bar_users_path(params[:bar_id]), :html => {:name=>"users_form",:multipart => true,:class=> "standardForm"}) do |user| %>

<%= render :partial => "users/admin_options" if @user.user_type == "admin" %> 
```

在`store`控制器的动作中：

```
 if !@user.save
  render :action  => "show" ,:layout => 'application'
 else 
```

所以我想知道是否可以更改条件：

```
<%= render :partial => "users/admin_options" if @user.user_type == "admin" %> 
```

还要以某种方式检查 url`store_bar_users_path`或类似的东西 - 或者`store`操作中的渲染可能不正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:57:42.193

将用户类型存储在会话变量中，在用户登录时设置。然后您不必一直加载它，它对所有控制器、视图和助手都是可见的。使用此变量来确定是否要显示部分。

# javascript - 使用下拉菜单在 jquery 中进行可变计算

> ID：10843203
> 
> 赞同：0
> 
> 时间：2012-06-01T01:05:47.580
> 
> 标签：javascript, jquery, drop-down-menu

jQuery 新手需要帮助。我正在为一个梦幻足球网站编写一个数据库应用程序。它从数据库中提取玩家信息并将其显示在前端的表格中以供查看者查看。你可以在这里看到它的半功能版本：

[http://digitaldemo.net/kickass/projections-table.php](http://digitaldemo.net/kickass/projections-table.php)

我很难使用的一项功能是 TFP（总幻想点数）计算。在上述链接的第一个选项卡中，有一系列下拉菜单。有些是选择点值（例如 2 分），有些是选择增量（例如每 10 码）。

首次加载页面时，需要使用默认值预先选择这些下拉菜单，并且 TFP 列会根据初始计算填充总计。

然后，用户可以更改这些值，点击 Get TFP Scores 按钮，TFP 列中的总分就会发生变化。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T04:21:50.030

Cynthia，您需要将 id 添加到各种 HTML 元素，然后添加一些 javascript，如下所示：

```
$(function(){
    function calcTFP(e) {
        if(e) e.preventDefault();

        var $tds, Pass_Yds, Pass_TDs, Int, Rush_Yds, Rush_TDs, Overall_Pts, TFP;

        $("tbody#qb tr").each(function() {
            $tds = $(this).find("td");
            Pass_Yds = Number($tds.eq(2).text());
            Pass_TDs = Number($tds.eq(3).text());
            Int = Number($tds.eq(4).text());
            Rush_Yds = Number($tds.eq(5).text());
            Rush_TDs = Number($tds.eq(6).text());

            TFP = Number($s_pass_yds_pts.val()) * Math.floor(Pass_Yds / Number($s_pass_yds_yds.val()));
            TFP += Number($s_pass_tds_pts.val()) * Pass_TDs; 
            //TFP += ........; //for Rushing yds, based on Passing yds.
            //TFP += ........; //for Rushing TDs, based on Passing TDs.
            //TFP += ........; //for Ints Thrown, based on Passing TDs.

            $tds.eq(8).text(TFP);//display calculated points in row's TFP column
        });
    }

    //Passing Yds
    var $s_pass_yds_pts = $("#s_pass_yds_pts").on('change', calcTFP);
    var $s_pass_yds_yds = $("#s_pass_yds_yds").on('change', calcTFP);

    //Passing TDs
    var $s_pass_tds_pts = $("#s_pass_tds_pts").on('change', calcTFP);

    //Rushing Yds
    //add code here based on Passing Yds

    //Rushing TDs
    //add code here based on Passing TDs

    //Int Thrown
    //add code here based on Passing TDs

    $("#b_get_TFP_scores").on('click', calcTFP);//attach calcTFP as click handler to "get_TFP_scores" button

    calcTFP();//initial calculation on page load
}) 
```

演示[在这里](http://jsfiddle.net/MG5cx/)

您会看到代码只是部分完成了，但那里应该有足够的内容，包括注释，以便您弄清楚如何编写其余部分。一旦你对正在发生的事情有所了解，添加额外的代码将是非常机械的。

您还将看到 [Get TFP Scores] 按钮是多余的，因为计算是自动执行的 (a) 页面加载和 (b) 响应对选择菜单所做的更改。但是，我已将按钮留在原处。

## 编辑：

五分量计算分为两类：

*   [通过Yds和Rashing Yds]，一般公式为`pts = s1 * score / s2`。
*   [传球、冲球和拦截]，其中一般公式为`pts = s1 * score`。

上面我已经完成了两个示例计算（用于通过 Yds 和通过 TDs），即。每个类别中的一个。您需要根据适当的样本处理其他三个。

如果您还没有这样做，请记住还要添加（如在演示中）：

*   `<select>`您和`<tbody>`元素的唯一 ID ，
*   元素的值属性`<option>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:51:40.407

首先，要预先选择您必须拥有服务器的值，或者您必须对它们进行硬编码才能进行预先选择。如果您的服务器正在输出它们（即从数据库中），那么您应该通过后端将选择设置为正确的值。

现在让我们进入代码：

```
function calcTfp() {
   // here you are doing your calcuation
   $('tr').each(function(i) {
       var tfp = 1+2+3; // this is for you to define
       $('td:eq(8)', this).val(tfp);
   });
} 
```

如果要在客户端预选值，只需添加以下内容：

```
function Preselect() {
   $('#passingYds').val('1 pt');  // these values depend on your implementation
   $('#passingTds').val('4 pts'); 
   // etc
 }

$(document).ready(function() {
  // preSelect();  // If you want to preset values on client side
  calTfp();  // on page load do all the tfp calcs

  // when the button is clicked do the tfp calcs
  $('#btnTfp').click(function(e) {
     e.preventDefault();
     calcTfp();
  });

}); 
```

# django - Django - 权限 api - 我应该加密数据库中的权限令牌以确保安全吗？

> ID：10843207
> 
> 赞同：0
> 
> 时间：2012-06-01T01:06:36.973
> 
> 标签：django, security, encryption

我正在构建一个使用公共 api 的应用程序。该 api 允许我们使用权限代表不同应用程序的用户执行操作；`token`我们以 a和 a的形式从用户那里收集权限`secret`，我们用来代表他们进行身份验证和执行操作。

我们将`token`and存储`secret`在我们的数据库中。它们是专门为我们的 api 应用程序生成的，所以每当我们需要使用 api 为用户执行操作时，我们还需要提供自己的 api 凭据；所以类似于：

```
from myapp.settings import API_APPID, API_PASS
user.perform_action(api_appid=API_APPID, api_pass=API_PASS, permissions_token=user.permissions_token, permissions_secret=user.permissions_secret) 
```

（实际上，我们使用权限令牌/秘密生成身份验证标头）。

我想知道我们是否应该在我们的数据库中加密权限令牌/秘密？我最初的想法是不，因为没有我们自己的 api 凭据（存储在我们的 settings.py 中），权限令牌和密码是无用的

如果我们要加密令牌，无论如何我们都会将私钥存储在 settings.py 中，这意味着应用程序的安全性将同样取决于我们的设置文件的保密性。

有什么想法吗？是否有充分的理由加密这些令牌，还是我认为它是多余的？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T05:16:22.620

并不真地。如果有人破坏了您的应用程序服务器，他们将拥有获取令牌所需的密钥，并且无论如何都能够（作为服务器）查询数据库。

如果您不需要单独的 API 密钥，它可以防止简单的 SQL 注入。但是，正如您所说，API 意味着学习令牌的攻击者不会学到任何有用的东西。当然，这是假设令牌不包含诸如用户密码之类的敏感信息。

# git - 使用root（哑）安装Gitolite，将自己锁定在ssh之外

> ID：10843209
> 
> 赞同：1
> 
> 时间：2012-06-01T01:07:03.973
> 
> 标签：git, ssh, telnet, gitolite, nas

我尝试按照本指南设置我的 Synology DS212J NAS： http: [//www.bluevariant.com/2012/05/comprehensive-guide-git-gitolite-synology-diskstation/](http://www.bluevariant.com/2012/05/comprehensive-guide-git-gitolite-synology-diskstation/)

我最初尝试使用用户“git”进行安装，但遇到了很多权限/访问被拒绝错误，所以我在 root 中尝试了它。这似乎很成功。

但是，现在我不再能够通过 ssh 登录到我的服务器（因为 Gitolite 阻止了 ssh）。

有没有办法撤消这个？

我还启用了 Telnet，我似乎可以使用以下方式登录：

```
telnet iptonas 
```

我得到：

```
Escape character is '^]'.
SSH-2.0-OpenSSH_5.8p1-hpn13v11 
```

但是 Telnet 对我来说完全陌生。有没有人有任何建议可以为我指明正确的方向？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T04:09:01.333

正如[brepro](https://stackoverflow.com/users/809452/brepro)评论的那样，如果 telnet 访问给您一个提示，您将获得一个双向交互式文本导向通信设施，这意味着您可以再次安装 Gitolite。

您将需要首先删除为 root 帐户生成的强制命令，如上[一个问题](https://superuser.com/questions/430903/cannot-login-to-ssh-after-installing-gitolite-pty-allocation-request-failed-on)中所述。
然后，您可以再次按照[安装过程](http://www.bluevariant.com/2012/05/comprehensive-guide-git-gitolite-synology-diskstation/)进行操作，但请确保在键入时使用与 root 不同的帐户：

```
/volume1/homes/git/gitolite/install -ln 
```

（对于普通用户，默认为 $HOME/bin）

使用`root`将再次修改帐户`authorized_keys`文件，`root`强制命令（再次）使任何交互式 shell ssh 连接变得不可能。

# sql - Rails 模型中不区分大小写的搜索 ReWorded

> ID：10843210
> 
> 赞同：0
> 
> 时间：2012-06-01T01:07:05.647
> 
> 标签：sql, ruby-on-rails, postgresql, search

是的，有一个几乎完全一样的问题，但我认为它没有以一种轨道的方式得到回答。它是如此不干燥，它伤害 [了 Rails 模型中不区分大小写的搜索](https://stackoverflow.com/questions/2220423/case-insensitive-search-in-rails-model)

我想在我的 postgresql 数据库中搜索基于名称的产品。我也可能想在同一个数据库中搜索客户。

所以我利用了上一个问题中的建议。我的产品表 Product.find_by_name #takes the name and finds 正如前面的答案所暗示的那样，我在我的产品表中有一个函数。

轻松如！现在客户怎么...

```
Customer.find_by_contact_name
Customer.find_by_email_address
Customer.find_by_company_name
Customer.find_by_phone
Customer.find_by_contact_name_and_phone
Customer.find_by_industry_id_and_contact_name  #the insdustry_id is not text so it can't be found. 
# Ahh snot I forgot a few.
Customer.find_by_contact_name_and_company_name
Customer.find_by_contact_name_and_email_address
Customer.find_by_contact_name_and_phone
Customer.find_by_industry_id_and_email_address
... 
```

每一个都必须进行硬编码。当我需要另一个时，我必须打开客户，复制代码，然后创建一个新函数。因为我不知道这些值是整数、字符串还是日期。

我正在寻找一种方法，不必为每个模型和每次搜索迭代都实现这一点，我可能希望在未来的某个时候进行。

我想说谢谢你对另一个问题的回答。他们只是看起来不像“Rails”，我希望有更多的东西。手指交叉，有超过 4 个月的人，可以指出一个真正的 DRY。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-25T00:45:28.367

您是否尝试同时搜索所有这些属性？如果是这样，您可能想尝试使用像[Thinking Sphinx这样的搜索引擎](http://freelancing-god.github.com/ts/en/ "思考狮身人面像")

# c - 如何在 C 中使用特殊字符？

> ID：10843211
> 
> 赞同：4
> 
> 时间：2012-06-01T01:07:05.740
> 
> 标签：c, internationalization

我意识到我的程序必须能够处理日语或中文等特殊字符。但我知道内置类型`char`还远远不够。那么如何在 C 程序中使用这些特殊字符呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T01:24:55.887

像这样在 Windows VS :)

```
#include <tchar.h>
typedef struct _我的结构{
    int 数据;
    TCHAR 字符串指针[100];
}我的结构;
int main(int argc,char** argv){
    我的结构 我的变量 = {1, _T("字符串123abc")};
    _tprintf(_T("%s, %d"),我的变量.字符串指针,我的变量.字符串指针);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-06-01T01:14:10.500

如果您可以接受一个字节 != 一个 unicode 字符这一事实，您可以使用 UTF-8 编码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T01:09:57.000

对于 unicode 类型语言，您可以使用 wchar_t 而不是 char

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-01T01:10:17.117

您需要使用[宽字符](http://en.wikipedia.org/wiki/Wide_character)。

它们是 Unicode 所需要的，它们几乎可以处理你扔给它的每个字符，它可以做到这一点，因为 - 这就是问题所在：它消耗更多字节（两倍；听起来很多但在大多数情况下，它真的不是）。

注意：在 Windows 编程中，您使用`TEXT("")`宏来选择您的字符是 Unicode 还是 ANSI。它将根据您的项目设置进行选择。
如果您坚持使用 Unicode，您可以使用`L`字母前缀编写字符串，如下所示：`L"Unicode String"`

使用宽字符的头文件是`wchar.h`.

# eclipse - 使用eclipse core/JDT编程分析Java源码

> ID：10843213
> 
> 赞同：3
> 
> 时间：2012-06-01T01:07:29.093
> 
> 标签：eclipse, code-analysis, static-code-analysis

我正在尝试编写一个程序来分析 Java 源代码，例如，检查某个方法的所有调用者。由于 eclipse IDE 提供了这种功能强大且令人印象深刻的功能，我想知道它们是否提供了一些 API，以便我也可以在我的程序中使用这些功能。

我在网上查了一些资料。但是我能找到的文档几乎都是和eclipse插件开发相关的，这不是我想要的。我想在独立程序中使用它们（也许作为编译链的一部分来进行自定义样式检查）。

这可能吗？如果是这样，任何作为我开始研究的入口点的链接将不胜感激。如果没有，我可以尝试其他替代方法吗？（我曾经考虑过使用ANTLR，但它只是一个离源代码分析器几步之遥的解析器）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:19:12.623

如果您决定喜欢 JDT，那么开发一个 Eclipse RCP 应用程序就不会（非常）困难，该应用程序仅使用带有 JDT 的基本 Eclipse 内容并用作标准命令行应用程序。有许多关于 Eclipse RCP 的教程和论文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:51:42.337

我不了解 Eclipse 本身，但这里有一些替代方案：

一、相对轻量级：

*   [查找错误](http://findbugs.sourceforge.net/)。如果您是一个体面的 Java 程序员，编写自己的分析相对简单。
*   [PMD](http://pmd.sourceforge.net/pmd-5.0.0/)。我自己没有使用过它，但看起来很容易编写 Java 分析加上 - 额外的好处 - 它们支持源代码 AST 的 XPath 样式查询。

这些可能是矫枉过正，但 Java 分析的重炮是[来自 McGill U. 的 Soot](http://www.sable.mcgill.ca/soot/) 和[来自 IBM 的 WALA](http://wala.sourceforge.net/wiki/index.php/Main_Page)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-06T09:28:08.403

如果您想做“真正的”静态分析，我建议您使用现有的框架之一，例如[Soot](http://www.sable.mcgill.ca/soot/)或[Chord](http://pag.gatech.edu/chord/)。您需要的分析很可能已经在那里实现（尽管这些工具通常更喜欢字节码）。另一方面，尤其是“查找所有调用者”分析已经存在于 Eclipse 中；你可以从`CallHierarchyViewPart`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-06T08:20:36.273

作为 Eclipse/ANTLR 的替代方案，请参阅我们的[DMS 软件重组工具包](http://www.semanticdesigns.com/Products/DMS/DMSToolkit.html)及其[Java 前端](http://www.semanticdesigns.com/Products/FrontEnds/JavaFrontEnd.html)。DMS 提供通用解析/树构建/模式匹配/源重写能力；前端自定义 DMS 以了解语法、符号表和流分析等语言细节（对于 Java，目前仅限于方法）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-11T00:22:10.923

如果您想创建一个简单的独立程序来进行静态代码分析，那么您似乎走上了使用 ANTLR 的正确道路。

[Checkstyle](https://github.com/checkstyle/checkstyle)还使用 ANTLR 执行静态代码分析。ANTLR 将帮助您创建抽象语法树 (AST)。但是随后您将不得不编写代码来执行您想要的不同类型的检查。您可以使用 ANTLR 准备的 AST 的“walk”模式来访问所有令牌，然后有一个逻辑来执行它并存储或打印结果。首先，这是一个[非常简单的独立示例](http://itsallbinary.com/do-your-own-static-code-analysis-programmatically-in-java-similar-to-checkstyle-pmd/)，用于对抽象类执行类名检查，以确保它以“抽象”开头。

# android - 没有简单的方法在新屏幕中显示 PreferenceFragment？

> ID：10843214
> 
> 赞同：4
> 
> 时间：2012-06-01T01:07:31.370
> 
> 标签：android, android-fragments

我正在尝试使用 PreferenceFragment 而不是 PreferenceActivity，因为我不喜欢在我的代码中使用“弃用”这个词。

我已经建立了我的首选项布局和 PreferenceFragment 类都可以。现在我只需要在用户单击菜单中的“设置”时启动它。显然，我希望他们为此被带到一个新的页面。使用 PreferenceActivity，这很容易 - 只需使用 Intent 调用 startActivity。

使用 PreferenceFragment，我必须创建一个新 Activity，然后在其中设置首选项。如果我只是在我当前的活动中替换（android.R.id.content，片段），片段会与 setContentView() 中设置的当前布局重叠或重叠。这似乎只是为了显示一个简单的设置片段而做的大量工作。如果我要创建一个新的活动来保存片段，我不妨先使用 PreferenceActivity。

那么我在这里错过了什么吗？我要做的就是在新屏幕中显示我漂亮的 PreferenceFragment。没有简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T01:49:41.513

您可以将整个主布局设置为框架布局，而不是在其中硬编码片段。

这将使您可以毫无问题地交换片段。

我一直认为在 XML 中硬编码片段违背了片段的性质和目的。

# php - 使用php上传多个文件

> ID：10843218
> 
> 赞同：0
> 
> 时间：2012-06-01T01:08:04.253
> 
> 标签：php, file-upload

我正在尝试使用一个表单帖子上传两个文件，但是我的表单只会上传第一个文件，并且不会遍历第二个文件并上传。知道为什么吗？我正在使用的代码如下。

```
<?php

$upload = $_POST['upload'];
$enteredPassword = $_POST['password'];
$uploadedFiles = $_FILES;
$password = "************";

// Where the file is going to be placed 
$target_path = "";

//interger count
$i = 0;

//upload the files
if ($upload == true && $enteredPassword == $password) {
foreach($uploadedFiles as $uploadedFile) {
    $target_path = $target_path . $uploadedFile['name'][$i]; 

    if(move_uploaded_file($uploadedFile['tmp_name'][$i], $target_path)) {
        echo "<p>The file ".  $uploadedFile['name'][$i]. 
        " has been uploaded.</p>";
    } else{
        echo "<p>There was an error uploading the {$uploadedfile['name']}, please try again!</p>";
    }
    $i++;
}
}
?>

<ul>
<form enctype="multipart/form-data" action="" method="post">
    <input type="hidden" name="upload" value="true" />
    <li>Choose a file to upload:</li>
    <li><input name="userfile[]" type="file" size="40" /></li>
    <li><input name="userfile[]" type="file" size="40" /></li>
    <li>Enter password for file upload:</li>
    <li><input name="password" type="password" size="40" /></li>
    <li><input type="submit" value="Upload File" /></li>
</form>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:44:48.577

如果您愿意，可以使用此插件进行多张图片上传。它对我很有用... [http://www.plupload.com/example_queuewidget.php](http://www.plupload.com/example_queuewidget.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:55:42.413

试试，uploadify 有很好的 api 和回调的多次上传。 [http://www.uploadify.com/](http://www.uploadify.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T14:17:50.747

这种行为是意料之中的，因为您的 $_FILES 数组中只有一个元素是 $_FILES["userfile"]。你可以尝试这样的事情来实现你想要的：

```
<?php
if(isset($_POST["submit"]))
{
    $upload = $_POST['upload'];
    $enteredPassword = $_POST['password'];
    $uploadedFiles = $_FILES["userfile"];
    $password = "12345";

    // Where the file is going to be placed 
    $base_path = "upload/";

    //upload the files
    if ($upload == true && $enteredPassword == $password) {
        foreach(array_combine($uploadedFiles["name"], $uploadedFiles["tmp_name"]) as $name => $tmp_name) {
            $target_path = $base_path .$name; 

            if(move_uploaded_file($tmp_name, $target_path)) {
                echo "<p>The file ".  $name." has been uploaded.</p>";
            }
            else
            {
                echo "<p>There was an error uploading the {$name}, please try again!</p>";
            }
        }
    }
}
?>

<ul>
<form enctype="multipart/form-data" action="" method="post">
    <input type="hidden" name="upload" value="true" />
    <li>Choose a file to upload:</li>
    <li><input name="userfile[]" type="file" /></li>
    <li><input name="userfile[]" type="file" /></li>
    <li>Enter password for file upload:</li>
    <li><input name="password" type="password" size="40" /></li>
    <li><input type="submit" name="submit" value="Upload File" /></li>
</form>
</ul> 
```

# memory - 物理地址和逻辑地址

> ID：10843220
> 
> 赞同：2
> 
> 时间：2012-06-01T01:08:27.393
> 
> 标签：memory, memory-address

我想问一下为什么我们必须不直接获取物理地址（如果将其放置在逻辑地址中），而是首先从该段中获取段和该物理地址（在线性地址空间中）。为什么不直接来自Logical？是否不可能将 Dir|Table|Offset 地址仅放置在逻辑地址远指针中？ ![在此处输入图像描述](../Images/2a8559a724da21930d4c9f4622f08ade.png)

# python - App Engine/Python BadValueError：成员实例必须具有完整的键

> ID：10843222
> 
> 赞同：0
> 
> 时间：2012-06-01T01:08:59.090
> 
> 标签：python, google-app-engine

这是我的代码。我跳过了一些部分。

```
class Members(db.Model):
    author = db.UserProperty()
    username = db.StringProperty()

class Events(db.Model):
    author = db.ReferenceProperty(Members)

class MainPage(webapp.RequestHandler):
    def get(self):
        user = users.get_current_user()
        if user:
            member = Members()
            member.author = user
            member.username = ''
            member.put()

class AddEvent(webapp.RequestHandler):
    def post(self):
        event = Events()
        event.author = Members(author=users.get_current_user())
        event.put()
        self.redirect('/add')
    def get(self):
        path = os.path.join(os.path.dirname(__file__), 'templates', 'add_event.html')
        self.response.out.write(template.render(path, None)) 
```

添加新事件时，我收到此错误**BadValueError: Members instance must have a complete key before it can be stored as a reference**。我做了一些搜索，当我们不保存实体实例（put（））时发生了这个错误。所以我添加了将用户保存到数据存储区的代码，但我得到了同样的错误。当我将代码保存在 AddEvent 类中时，它就可以工作了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T01:18:59.507

我认为您想将您的 post() 更改为这样的内容（未经测试）：

```
def post(self):
    member = Members.all().filter("author =", users.get_current_user()).get()
    event = Events()
    event.author = member
    event.put()
    self.redirect('/add') 
```

您不想创建新的 Members 实体，而是想检索您已经创建的实体。

# ruby - Rubygame：尝试启用传递参数来定义游戏屏幕大小

> ID：10843223
> 
> 赞同：0
> 
> 时间：2012-06-01T01:09:35.343
> 
> 标签：ruby, string, arguments, rubygame

rubygame 教程有一个基本的屏幕创建部分，后面跟着一个 excersize 来修改代码以允许传递定义屏幕大小的命令行参数。我能够使用谷歌拼凑一些我认为可行的东西：

```
#! /usr/bin/ruby -w

# require 'rubygame'

screenx = ""
screeny = ""

# Rubygame.init

ARGV.each do |a|
    if a.scan("x=")
            screenx = a["x="] = ""
    end
    if a.scan("y=")
            screeny = a["y="] = ""
    end
end

puts screenx
puts screeny

# screen = Rubygame::Screen.new [screenx, screeny]
# loop {} 
```

如果没有评论，我会收到[一大堆](http://pastie.org/4005138)我不理解的错误，并且在 Google 上发现的任何结果都很少。

随着评论我得到不同的错误：如果我给它一个无意义的参数，它会输出“字符串不匹配”如果我给它一个格式正确的请求，我会得到“无法修改冻结的字符串”

我不确定这是否是从参数中提取 x 和 y 值的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T01:18:54.183

看看[`OptionParser`](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/optparse/rdoc/OptionParser.html)：

```
options = {}

OptionParser.new do |opts|
  opts.on '-w', '--width WIDTH', 'Screen width' do |width|
    options[:width] = width
  end

  opts.on '-h', '--height HEIGHT', 'Screen height' do |height|
    options[:height] = height
  end
end.parse!

# options is now filled with values 
```

[为此有不同的宝石](https://www.ruby-toolbox.com/categories/CLI_Option_Parsers)——我是其中一个的作者。然而，由于你的游戏不是一个成熟的命令行应用程序，我认为你真的不需要额外的依赖。

# wcf - 可以将 WCF 服务配置为可通过不同协议使用吗？

> ID：10843226
> 
> 赞同：0
> 
> 时间：2012-06-01T01:10:27.920
> 
> 标签：wcf, protocols

我正在阅读 WCF 4.0 Cookbook，对 WCF 的统一协议能力印象深刻，我只是想出了这个问题：

托管服务是否使用 1 个协议，例如 HTTP\命名管道？或者托管服务可以同时被不同的协议客户端（如 HTTP、命名管道）使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T01:27:44.683

如果您使用多个绑定设置服务，那么是的，它可以侦听和响应不同的传输协议。

显然，如果您在 http 上启动通信，那么您将通过相同的传输获得响应。

此 msdn 链接提供了有关何时选择不同传输的详细信息。 [http://msdn.microsoft.com/en-us/library/ms733769.aspx](http://msdn.microsoft.com/en-us/library/ms733769.aspx)

# wordpress - 如何让仪表板与子主题一起正常工作？

> ID：10843228
> 
> 赞同：0
> 
> 时间：2012-06-01T01:10:52.093
> 
> 标签：wordpress, wordpress-theming

我已经安装了 Wordpress 并安装了一个基于 211 的子主题。我已将三个模板文件添加到包含子主题的目录中。他们是：

样式.css

```
/*
Theme Name: Cinema Verde
Theme URI: http://wordpress.org/extend/themes/twentyeleven
Author: Arthur Ianuzzi - Omicron Marketing
Author URI: http://www.omicron-marketing.com
Description: Theme for Cinema Verde, child theme based on TwentyEleven
Version: 1.0
License: GNU General Public License
License URI: license.txt
Tags: dark, black, gray,  two-columns,  right-sidebar, fixed-width, custom-background, custom-colors, custom-header, custom-menu, editor-style, featured-image-header, featured-images, full-width-template, microformats, post-formats, rtl-language-support, sticky-post, theme-options, translation-ready
Template: twentyeleven
*/
@import url('../twentyeleven/style.css'); 
```

自定义样式.css

```
 #access { background: #000; border-top: 2px solid #84E41F; border-bottom: 2px solid #84E41F; }

#access a { color: #fff; }

#access a:focus { color: #fff;} 

#access ul ul :hover a { background: #000; color: #fff; }

#access li:hover a {color: #84E41F; background: #000; border-bottom: 0 ;  }

#branding #searchform {display:none; }

h1.entry-title {color: #84E41F;} 
```

和functions.php

```
 <?php

/** Tell WordPress to run post_theme_setup() when the 'after_setup_theme' hook is run. */
add_action( 'after_setup_theme', 'post_theme_setup' );

if ( !function_exists( 'post_theme_setup' ) ):
function post_theme_setup() {

/* Add our new styles after all stylesheets have loaded */
function twentyeleven_enqueue_child_style() {
wp_enqueue_style( 'child_style', get_stylesheet_directory_uri() . '/custom-style.css', array(), null );
do_action( 'twentyeleven_enqueue_child_style', 'child_style' );
}
add_action( 'wp_enqueue_scripts', 'twentyeleven_enqueue_child_style', 11 );
}
endif;

?> 
```

一切正常，除了当我在仪表板中并更改某些内容时，确认页面出现空白。例如，如果我写了一篇新文章，然后单击“发布”，我会得到一个空白页面，而不是显示我刚刚写的文章的页面。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T09:38:03.727

你在一个函数中运行一个函数，你的代码被破坏了......
打开[wp_debug](http://codex.wordpress.org/Editing_wp-config.php#Debug)，你会看到错误。

```
/** Tell WordPress to run post_theme_setup() when the 'after_setup_theme' hook is run. */
add_action( 'after_setup_theme', 'post_theme_setup' );

if ( !function_exists( 'post_theme_setup' ) ):
function post_theme_setup() {

    wp_enqueue_style( 'child_style', get_stylesheet_directory_uri() . '/custom-style.css', array(), null );
    do_action( 'twentyeleven_enqueue_child_style', 'child_style' );

    add_action( 'wp_enqueue_scripts', 'twentyeleven_enqueue_child_style', 11 );
}
endif;

?> 
```

旁注：
您知道包含多个样式表会使您的网站变慢吗？
很好，您正在使用 enqueue btw

# html - rails haml span 正在“提前”结束 - 为什么？

> ID：10843230
> 
> 赞同：1
> 
> 时间：2012-06-01T01:10:57.890
> 
> 标签：html, ruby-on-rails, ruby, haml

为什么我的“footer_links”跨度提前结束（在我的删除 button_to 之前）：

```
%p
  %br
  %span.footer_links
    = link_to 'Edit', edit_link_path(@link)
    |
    = button_to 'Delete', @link, :confirm => 'Are you sure?', :method => :delete 
```

正在生产这个：

```
<p>
<br/>
<span class="footer_links">
<a href="/links/354/edit">
<a href="/links/354/edit">
 | 
</span>
</p>
<form method="post" action="/links/354" class="button_to">
<div>
<input name="_method" type="hidden" value="delete"/>
<input data-confirm="Are you sure?" type="submit" value="Delete"/>
<input name="authenticity_token" type="hidden" value="MvN6K03y5WcqSZRt4Au3zj+xsKhfZ9EEtkf2M7YCGhk="/>
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T02:47:04.170

基于“mu太短”的答案，将您的`p`和`span`元素更改为`div`（或其他有效的HTML）：

```
%div
  %br
  .footer_links
    = link_to 'Edit', root_path
    |
    = button_to 'Delete', current_user, :confirm => 'Are you sure?', :method => :delete 
```

我猜你是从你的 Chrome（或 Safari 或 Firefox/Firebug）开发工具中的 Elements（又名 DOM）浏览器获得的“源代码”。这与查看 HAML 呈现的原始源不同。浏览器解析你的（无效的）源，它会尝试构建它可以使用的最好的 DOM，当你浏览 DOM 时，开发者控制台会将它作为文本转储出来。

开发者控制台中的文本表示很少会与原始源代码相同，尤其是在您的源代码无效的情况下。当您尝试调试渲染错误时，不要盯着这么多层纱布。从浏览器的菜单中选择“查看源代码”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T01:41:18.187

我猜你的 HAML 实际上正在产生这样的东西：

```
<p>
  <br/>
  <span class="footer_links">
    <a href="/links/354/edit">...</a>
     | 
    <form method="post" action="/links/354" class="button_to">
      <div>
        <input name="_method" type="hidden" value="delete"/>
        <input data-confirm="Are you sure?" type="submit" value="Delete"/>
        <input name="authenticity_token" type="hidden" value="MvN6K03y5WcqSZRt4Au3zj+xsKhfZ9EEtkf2M7YCGhk="/>
      </div>
    </form>
  </span>
</p> 
```

但这不是有效的 HTML：[你](https://stackoverflow.com/a/10763952/479863)[不能在`<div>``<form>``<p>`](https://stackoverflow.com/a/10763952/479863). 因此，当浏览器尝试解析 HTML 时，它会注意到它不是有效的 HTML，并尽最大努力更正您的 HTML。最简单的更正方法是将有问题的`<form>`元素推到外部`<p>`并关闭`<span>`and`<p>`元素，这将产生一个（有效的 HTML）结构，如下所示：

```
<p>...</p>
<form><div>...</div></form> 
```

这看起来很像你所看到的。

解决方案是使用有效的 HTML，也许您可​​以使用`<div class="p">`而不是最外层`<p>`并调整 CSS 以使其`div.p`看起来像`p`. 您还必须替换`<span>`since[`<span>`只能包含短语内容](http://www.w3.org/TR/html-markup/span.html)，就像`<p>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T01:20:55.937

完全是猜测，但是您是否在缩进中混合了空格和制表符？看起来 HAML 将 button_to 标记解释为与 %p 标记在同一级别缩进，所以我想知道是否有一个选项卡可能被解释为空格。

HAML 文档说您不能在缩进中混合制表符和空格，但它没有说明这是否会引发错误或显示为意外行为。

# django - 获取tastepie中的对象列表（在另一个视图中）

> ID：10843232
> 
> 赞同：3
> 
> 时间：2012-06-01T01:11:15.253
> 
> 标签：django, tastypie

我试图得到一个可口的响应以在另一个视图中使用。我在食谱上看过[食谱](http://django-tastypie.readthedocs.org/en/latest/cookbook.html#using-your-resource-in-regular-views)。问题是，我想获得列表视图。就我而言，`/api/v1/source/`. 这是我到目前为止所得到的：

```
sr = SourceResource()
objs = sr.get_object_list(request) # two objects returned
bun = sr.build_bundle(data=objs, request=request)

jsondata = sr.serialize(None, sr.full_dehydrate(bun), 'application/json') 
```

当然，这一切都崩溃了。`bun.data`没有所需的特征（单个对象）。那么，有没有人成功地做到了这一点？它是如何完成的？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T02:25:40.850

这就是我想出的。我不特别喜欢请求和 QueryDict 都被复制，但我现在想不出其他任何东西，除了复制大部分[美味的代码](https://github.com/toastdriven/django-tastypie/blob/master/tastypie/resources.py#L1051)。

```
from copy import copy

from django.views.generic import TemplateView

from incremental.sources.resources import SourceResource
resource = SourceResource()

class AppView(TemplateView):
    'Base view for the Source parts of the app'
    template_name = 'sources/base.html'

    def get_context_data(self, **data):
        'get context data'
        tmp_r = copy(self.request)
        tmp_r.GET = tmp_r.GET.copy()
        tmp_r.GET['format'] = 'json'

        data.update({
            'seed': resource.get_list(tmp_r).content
        })
        return data 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-24T14:39:32.450

为了避免请求复制内容，您可以将 json 设置为默认格式，例如在您的 Resource 中，您可以重载以下方法：

```
SourceResource(Resource):
  def determine_format(self, request):
    return "application/json" 
```

# mysql - 在 MySQL 中使用变量/函数作为动态列名

> ID：10843233
> 
> 赞同：2
> 
> 时间：2012-06-01T01:11:23.793
> 
> 标签：mysql

是否可以使用函数或变量作为 MySQL 中列的标签？

因此，例如，如果您想包含日期，例如：

```
select 
  sum(P.AMOUNT) AS monthname(date_sub(CURDATE(), INTERVAL 1 MONTH))
from
  PAYMENT P
WHERE
  P.CREATED_DATE > (date_sub(CURDATE(), INTERVAL 1 MONTH)); 
```

这失败了，因为它不是 AS 别名的正确语法。我也试过这个：

```
SET @s = monthname(date_sub(CURDATE(), INTERVAL 1 MONTH));

select 
  sum(P.AMOUNT) AS @s
from
  PAYMENT P
WHERE
  P.CREATED_DATE > (date_sub(CURDATE(), INTERVAL 1 MONTH)); 
```

这也不起作用...

有任何想法吗？

编辑 - 通过上面的例子，我意识到你实际上可以只使用一个额外的列来返回日期信息。问题是我有几列具有不同的日期范围，如下所示：

```
select
  sum(IF((P.CREATED_DATE BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) and DATE_SUB(CURDATE(), INTERVAL 0 MONTH)),P.amount,0)) AS 'Month 0',
  sum(IF((P.CREATED_DATE BETWEEN DATE_SUB(CURDATE(), INTERVAL 2 MONTH) and DATE_SUB(CURDATE(), INTERVAL 1 MONTH)),P.amount,0)) AS 'Month -1',
  sum(IF((P.CREATED_DATE BETWEEN DATE_SUB(CURDATE(), INTERVAL 3 MONTH) and DATE_SUB(CURDATE(), INTERVAL 2 MONTH)),P.amount,0)) AS 'Month -2'
from
  PAYMENT P
WHERE
  P.AMOUNT < 100000; 
```

所以这是我希望用函数/查询替换的“第 0 个月”等。

# r - 如何在 R - lattice - bwplot 中设置异常值的颜色

> ID：10843235
> 
> 赞同：1
> 
> 时间：2012-06-01T01:11:30.730
> 
> 标签：r, graphics, statistics, lattice

例如当我得到这个时：

[http://i.stack.imgur.com/cWTIm.jpg](http://i.stack.imgur.com/cWTIm.jpg)

看来我必须分别为每个异常值设置颜色......

这是我对代码的（部分）猜测：

```
...,par.settings = list(...,box.rectangle = list(col= c("red","blue")),...) ),... 
```

thx 已经提前了！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T07:27:05.247

公平的问题，但请不要发布“代码的分数猜测”；要求其他人生成示例问题是不公平的。

这是示例代码，它确认了您发现的内容：

```
library(lattice)
d = data.frame(x=c(rnorm(90),20*runif(16)),group=letters[1:2])
cols = list(col=c("red","blue"),pch=c(1,16,13))
bwplot(group~x,data=d,  
       par.settings = list(
                           plot.symbol=cols,
                           box.rectangle = cols,
                           box.dot = cols,
                           box.umbrella=cols 
                           )) 
```

![未回收的符号](../Images/a5811c5170ae5f6710e299766a176e64.png)

这是显示异常值 pch/col/alpha/cex 未分组的代码，因此被错误地回收。

来自 panel.bwplot：

```
panel.points(x = rep(levels.fos, sapply(blist.out, length)), 
             y = unlist(blist.out), pch = plot.symbol$pch, col = plot.symbol$col, 
             alpha = plot.symbol$alpha, cex = plot.symbol$cex, 
             fontfamily = plot.symbol$fontfamily, ...... 
```

这意味着这是 lattice 中缺少的功能（我不会称其为错误）。

# c# - 如何在 EF 中获取表列的列表？

> ID：10843239
> 
> 赞同：0
> 
> 时间：2012-06-01T01:12:35.680
> 
> 标签：c#, linq, entity-framework, linq-to-sql

我需要 EF 中一个表的 ColumnName，我有它的 ID。我的表是这样的：

# 零售商

```
[RetailerId] [int] IDENTITY(1,1) NOT NULL,
[RetailerName] [varchar](50) NOT NULL,
[StateName1] [bit] NOT NULL,
[StateName2] [bit] NOT NULL,
[StateName3] [bit] NOT NULL, 
```

# 状态

```
 [SId] [int] IDENTITY(1,1) NOT NULL,
   [StateName] [varchar](50) Not Null 
```

我从一个函数收到一个**SId**，需要选择位于该州的所有零售商。就像是：

```
var listOfRetailers = (from m in db.Retailers where m.[a column that it's id is equal to SId] == true select m ).toList(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T02:06:31.080

根据您的评论，我认为这就是您要寻找的。但是明智的设计你所做的很糟糕。我将很快解释。

```
var listOfRetailers;
if(SId == 1)
{
listOfRetailers = db.Retailers.select(r=> r.StateName1.Equals(true)).ToList();
}
else if(SId == 2)
{
listOfRetailers  = db.Retailers.select(r=> r.StateName2.Equals(true)).ToList();
}
else if(SId == 3)
{
listOfRetailers  = db.Retailers.select(r=> r.StateName3.Equals(true)).ToList();
} 
```

**编辑**

从技术上讲，这是一个糟糕的设计。因为您假设您的 States 表将有 3 条记录

```
1 - ACT
2 - NSW
3 - NT 
```

对于每个州，您在零售商表 StateName1、StateName2、StateName3 中都有相应的列

假设您要引入第 4 个状态（例如`4 - VIC`）。现在您需要`StateName4`在您的零售商表中引入一个名为的新列。（这样做会有代码级别和数据库级别的更改）

此外，您还可以通过新列引入额外无意中听到的未使用/冗余数据。

因为这是一种`many-to-many`情况（一个州可以有很多零售商，一个零售商可以在很多州），最好的方法是创建 3 个表（Retailer、State、RetailerState），其中 by `RetailerState`table 将扮演映射条目的角色`State`,`Retailer`表

```
Retailer
---------
[RetailerId] 
[RetailerName]

State
------
[SId] 
[StateName]

RetailerState
--------------
[RetailerId] 
[SId] 
```

# python - Python多处理设计

> ID：10843240
> 
> 赞同：18
> 
> 时间：2012-06-01T01:12:46.253
> 
> 标签：python, iteration, multiprocessing, gdal

我编写了一个算法，该算法采用地理空间数据并执行多个步骤。输入数据是大型栅格研究区域（约 1.5 亿像素）的多边形和协变量栅格的 shapefile。步骤如下：

1.  shapefile 多边形内的采样点
2.  对于每个采样点，从协变量栅格中提取值
3.  在采样点上建立预测模型
4.  提取目标网格点的协变量
5.  将预测模型应用于目标网格
6.  将预测写入一组输出网格

整个过程需要迭代多次（比如 100 次），但当前每次迭代需要一个多小时的时间进行串行处理。对于每次迭代，最耗时的部分是第 4 步和第 5 步。由于目标网格非常大，我一直在一次处理一个块（比如 1000 行）。

我有一个 6 核 CPU 和 32 Gb RAM，所以在每次迭代中，我尝试使用 Python 的`multiprocessing`模块和一个`Pool`对象同时处理多个块（步骤 4 和 5），然后写入输出（预测）使用调用全局输出写入函数的回调函数到公共输出网格集。这似乎可行，但并不比串行处理每个块更快（实际上，它可能更慢）。

所以我的问题是，有没有更有效的方法来做到这一点？我对多处理模块的`Queue`类感兴趣，但我不确定它是如何工作的。例如，我想知道让一个执行步骤 4 和 5 然后将结果传递到执行步骤 6 的另一个队列是否更有效。或者这甚至是 Queue 的用途吗？

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-20T14:24:49.880

Python 的多处理能力的当前状态对于 CPU 绑定处理来说并不是很好。我害怕告诉您，使用该模块无法使其运行得更快，`multiprocessing`也不是您使用该模块`multiprocessing`的问题。

真正的问题是 Python 仍然受[GlobalInterpreterLock(GIL)](http://www.dabeaz.com/GIL/)规则的约束（我强烈建议使用[幻灯片](http://www.dabeaz.com/python/UnderstandingGIL.pdf)）。围绕 GIL 开展工作取得了一些令人兴奋的理论和[实验进展。](http://mail.python.org/pipermail/pypy-dev/2012-May/009901.html)Python 3.2 事件包含一个新的 GIL，它解决了一些问题，但引入了其他问题。

目前，使用单个串行线程执行多个 Python 进程比尝试在一个进程中运行多个线程要快。这将允许您避免在线程之间获取 GIL 的问题（通过有效地拥有更多 GIL）。然而，这只有在 Python 进程之间的 IPC 开销不超过处理的好处时才有用。

Eli Bendersky 写了一篇不错的[概述文章](http://eli.thegreenplace.net/2012/01/16/python-parallelizing-cpu-bound-tasks-with-multiprocessing/)，讲述了他尝试通过多处理使受 CPU 限制的进程运行得更快的经验。

值得注意的是，[PEP 371](http://python.org/dev/peps/pep-0371/)希望通过引入`multiprocessing`模块（以前是一个名为 的非标准封装`pyProcessing`）来“回避” GIL。然而，GIL 似乎仍然在 Python 解释器中扮演了太大的角色，无法使其与 CPU 绑定算法一起工作。许多不同的人都致力于删除/重写 GIL，但没有足够的牵引力使其成为 Python 版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-15T22:31:13.670

python.org 上的一些多处理示例不是很清楚 IMO，很容易从有缺陷的设计开始。这是我为开始一个项目而制作的一个简单示例：

```
import os, time, random, multiprocessing
def busyfunc(runseconds):
    starttime = int(time.clock())
    while 1:
        for randcount in range(0,100):
            testnum = random.randint(1, 10000000)
            newnum = testnum / 3.256
        newtime = int(time.clock())
        if newtime - starttime > runseconds:
            return

def main(arg):
    print 'arg from init:', arg
    print "I am " + multiprocessing.current_process().name

    busyfunc(15)

if __name__ == '__main__':

    p = multiprocessing.Process(name = "One", target=main, args=('passed_arg1',))
    p.start()

    p = multiprocessing.Process(name = "Two", target=main, args=('passed_arg2',))
    p.start()

    p = multiprocessing.Process(name = "Three", target=main, args=('passed_arg3',))
    p.start()

    time.sleep(5) 
```

这应该使 3 个处理器运行 15 秒。修改它应该很容易。也许这将有助于调试您当前的代码并确保您真正生成多个独立进程。

如果由于 RAM 限制而必须共享数据，那么我建议这样做： http: [//docs.python.org/library/multiprocessing.html#sharing-state-between-processes](http://docs.python.org/library/multiprocessing.html#sharing-state-between-processes)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-20T08:32:33.730

由于 python 并不是真的要进行密集的数字计算，我通常会开始将 python 程序的时间关键部分转换为 C/C++ 并大大加快速度。

此外，python 多线程也不是很好。Python 一直在为各种事情使用全局信号量。因此，即使您使用 python 提供的线程，事情也不会变得更快。线程对于应用程序很有用，其中线程通常会等待诸如 IO 之类的事情。

在制作 C 模块时，您可以在处理数据时手动释放全局信号量（当然，不再访问 python 值）。

使用 C API 需要一些练习，但它的结构清晰且比 Java 原生 API 更容易使用。

请参阅 python 文档中的“扩展和嵌入”。

通过这种方式，您可以在 C/C++ 中制作时间关键部分，而在 python 中使用更快的编程工作的较慢部分......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-11T05:52:53.850

我建议您首先检查代码的哪些方面花费的时间最多，因此您必须对其进行分析，尽管它成功地使用了[http://packages.python.org/line_profiler/#line-profiler](http://packages.python.org/line_profiler/#line-profiler)确实需要cython。

至于队列，它们主要用于共享数据/同步线程，尽管我很少使用它。我确实一直在使用多处理。

我主要遵循 map reduce 哲学，它简单而干净，但它有一些主要开销，因为在应用 map 函数时，值必须打包到字典中并在每个进程中复制......

您可以尝试分割您的文件并将您的算法应用于不同的集合。

# c# - 如何在没有其他 Windows 进程的情况下在 Windows 窗体中自托管 WCF

> ID：10843243
> 
> 赞同：1
> 
> 时间：2012-06-01T01:13:53.323
> 
> 标签：c#, winforms, wcf

我有一个 Windows 应用程序并希望在其中自托管 WCF。这篇[MSDN 文章](http://msdn.microsoft.com/en-us/library/ms731758.aspx)将向您介绍如何在控制台中自托管 WCF。[Jason Henderson 的文章](http://www.codeproject.com/Articles/18789/A-Quick-and-Dirty-WCF-Service-and-Client-Using-WCF)演示了如何调用该服务。但问题是，我不想在另一个 Windows 进程中托管我的服务。我想将它托管在我的客户端应用程序中。这是我的方法：

1.  Ctrl + F5 运行服务
2.  将服务引用添加到我的客户端应用程序

然后我可以像这样在我的客户端启动服务

```
static void Main()
{
    ServiceHost host = new ServiceHost(typeof(MyService));
    host.Open();
    Application.Run(new Form1());
    host.Close();
} 
```

有用。但是这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T18:47:26.297

这正是微软推荐的：

在 Windows 服务中托管 [http://msdn.microsoft.com/en-us/library/bb332338.aspx](http://msdn.microsoft.com/en-us/library/bb332338.aspx)

# php - Kohana ORM has_many belongs_to

> ID：10843246
> 
> 赞同：0
> 
> 时间：2012-06-01T01:14:04.227
> 
> 标签：php, orm, kohana

假设我有 3 个模型，一个、两个和三个。

模型一有很多三，模型二有很多三，三属于一和二。

楷模：

```
class Model_One extends ORM {

protected $_primary_key = 'one_id';

protected $_has_many = array(
    'threes'=> array(
        'model' => 'three',                
        'through' => 'ones_threes',   
        'far_key' => 'three_id',       
        'foreign_key' => 'one_id'   
        ),
    );
}

class Model_Two extends ORM {

protected $_primary_key = 'two_id';

protected $_has_many = array(
    'threes'=> array(
        'model' => 'three',                
        'through' => 'twos_threes',   
        'far_key' => 'three_id',       
        'foreign_key' => 'two_id'   
        ),
    );
}

class Model_Three extends ORM {

protected $_primary_key = 'three_id';

protected $_belongs_to = array(
    'ones'=> array(
        'model' => 'one',                
        'through' => 'ones_threes',    
        'far_key' => 'one_id',       
        'foreign_key' => 'three_id'   
        ),

'twos'=> array(
        'model' => 'two',                
        'through' => 'twos_threes',    
        'far_key' => 'two_id',       
        'foreign_key' => 'three_id'   
        ),
);
} 
```

我显示一，二，三。

```
$getTwos=ORM::factory('two')->find_all(); 

foreach($getTwos as $getTwo)
{
   echo $getTwo->two_category_title;
   foreach($getTwo->three->find_all() as $getThree)
   {
       echo $getThree->three_title;
       echo $getThree->one->one_author; 
   }
} 
```

假设我有作者 A 和 B 以及 Title 1、Title 2、Title 3 和 Title 4。A 有 Title 1、2、3，B 有 Title 4。

问题是 echo $getThree->one->one_author; 将回显 A、B、NULL、NULL。

如何正确回显信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T05:31:57.067

您的模型中有不正确的关系定义`Three`。似乎`One`拥有并属于许多`Threes`（HABTM 或“拥有许多通过”），`Two`模型也是如此。这是您需要的：

```
class Model_Three extends ORM {

protected $_primary_key = 'three_id';

protected $_has_many = array(
    'ones'=> array(
        'model' => 'one',                
        'through' => 'ones_threes',    
        'far_key' => 'one_id',       
        'foreign_key' => 'three_id'   
        ),

    'twos'=> array(
        'model' => 'two',                
        'through' => 'twos_threes',    
        'far_key' => 'two_id',       
        'foreign_key' => 'three_id'   
        ),
    );
} 
```

**附言**。`foreign_key`是可选的，因为您已经在`$_primary_key`属性中定义了它。

**聚苯乙烯**。这是“帖子仅属于一个用户”关系的示例：

```
class Model_User extends ORM {

   protected $_has_many = array(
      'posts' => array(),
   );
}

class Model_Post extends ORM {

   protected $_belongs_to = array(
      'author' => array(
          'model'       => 'user',
          // ignore if you have a `author_id` foreign key
          'foreign_key' => 'user_id', 
      ),
   );

   protected $_has_many = array(...);
}

// usage
$post = ORM::factory('post', 1);
echo $post->author->username;
$post->author = ORM::factory('user', 1);
$user = ORM::factory('user', 1);
foreach($user->posts->where('published', '=', 1)->find_all() as $posts) {
    echo $post->title;
} 
```

# jquery - 在 jQuery 的 .text() 返回的长输出中插入逗号或空格

> ID：10843250
> 
> 赞同：1
> 
> 时间：2012-06-01T01:14:33.517
> 
> 标签：jquery

我正在尝试制作一个书签，它将吐出具有一类作者的所有链接的文本。到目前为止，我有这个：

```
/// Stuff to load jQuery into the bookmarklet
    var authors = $(".author");var names = authors.text();alert(names); 
```

唯一的问题是它会返回一长串废话，

```
JohnDoeMaryDoeEddieDoe 
```

我需要在每个作者姓名的末尾附加一个逗号或空格，但我不确定该怎么做。

```
$(".author"); + ","; 
```

只需将逗号附加到整个字符串的末尾，而不是单个作者/姓名，如下所示：

```
authors.text() + "," 
```

无论如何我可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T01:20:39.390

问题是您正在检索与选择器匹配的每个元素的内容。根据以下文档`.text`：

> .text() 方法的结果是一个**包含所有匹配元素的组合文本的**字符串。

您可以使用 遍历每个元素[`.map`](http://api.jquery.com/map)，检索元素的文本，然后使用 加入结果数组[`.join`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array/join)：

```
var names = $(".author").map(function () {
    return $(this).text();
}).get().join(", "); 
```

**示例：http:** [//jsfiddle.net/E3ba9/](http://jsfiddle.net/E3ba9/)

# ubuntu - 如何在 ubuntu 中安装 Hoop

> ID：10843251
> 
> 赞同：0
> 
> 时间：2012-06-01T01:14:46.943
> 
> 标签：ubuntu, hadoop, installation

我尝试在 ubuntu 桌面 12.04 中安装 Hoop。我已经安装了 hadoop-1.0.2。我的安装遵循[http://cloudera.github.com/hoop/docs/latest/ServerSetup.html](http://cloudera.github.com/hoop/docs/latest/ServerSetup.html) 我安装了 maven 3.0.4，git 箍。然而，当我这样做时，问题就来了，

```
hoop $ mvn clean package site assembly:single 
```

问题是：

```
[FATAL] Non-parseable POM /home/pc/.m2/repository/com/sun/jersey/jersey-project/1.4/jersey-project-1.4.pom: end tag name </body> must match start tag name <hr> from line 5 (position: TEXT seen ...</center>\r\n</body>... @6:8)  @ /home/pc/.m2/repository/com/sun/jersey/jersey-project/1.4/jersey-project-1.4.pom, line 6, column 8 
```

和

```
[ERROR] /home/pc/hoop/hoop-server/src/main/java/com/cloudera/hoop/Hoop.java:[222,23] error: cannot find symbol
[ERROR] class Hoop

[WARNING] Unable to create Maven project from repository.
org.apache.maven.project.InvalidProjectModelException: Some problems were encountered while processing the POMs:
[ERROR] Invalid packaging for parent POM [unknown-group-id]:[unknown-artifact-id]:   [unknown-version], must be "pom" but is "jar" @ [unknown-group-id]:[unknown-artifact-id]:[unknown-version]
[ERROR] 'groupId' is missing. @ line 44, column 99
[ERROR] 'version' is missing. @ line 44, column 99

[INFO] Hoop Project POM .................................. SUCCESS [7.774s]
[INFO] Hoop TestNG ....................................... SUCCESS [12:16.761s]
[INFO] Hoop Server ....................................... FAILURE [1.161s]
[INFO] Hoop WebApp ....................................... SKIPPED
[INFO] Hoop Client ....................................... SKIPPED
[INFO] Hoop Docs ......................................... SKIPPED
[INFO] Hoop Distro ....................................... SKIPPED
[INFO] Hoop Main ......................................... SKIPPED 
```

我该怎么办？

我将maven更改为maven2，我做到了

```
rm -rf ~/.m2/repository/com/sun/jersey
rm -rf ~/.m2/repository/org/glassfish/packager
rm -rf ~/.m2/repository/jersey 
```

正如丹尼尔·巴克蒂尔所说。但是现在又出现了新问题

```
[INFO] Scanning for projects...
[INFO] Reactor build order: 
[INFO]   Hoop Project POM
[INFO]   Hoop TestNG
[INFO]   Hoop Server
[INFO]   Hoop WebApp
[INFO]   Hoop Client
[INFO]   Hoop Docs
[INFO]   Hoop Distro
[INFO]   Hoop Main
[INFO] ------------------------------------------------------------------------
[INFO] Building Hoop Project POM
[INFO]    task-segment: [clean, package, site, assembly:single]
[INFO] ------------------------------------------------------------------------
[INFO] [enforcer:enforce {execution: clean}]
[WARNING] Rule 0: org.apache.maven.plugins.enforcer.RequireMavenVersion failed with     message:
Detected Maven Version: 2.2.1 is not in the allowed range [3.0.0,).
[INFO] ------------------------------------------------------------------------
[ERROR] BUILD ERROR
[INFO] ------------------------------------------------------------------------
[INFO] Some Enforcer rules have failed. Look above for specific messages explaining why the rule failed.
[INFO] ------------------------------------------------------------------------
[INFO] For more information, run Maven with the -e switch
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1 second
[INFO] Finished at: Fri Jun 01 15:51:06 CST 2012
[INFO] Final Memory: 13M/141M
[INFO] ------------------------------------------------------------------------ 
```

我现在该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T06:39:50.250

由于代理 (nginx) 的间歇性中断，您的本地 Maven 2 存储库被搞砸了。因为该文件不是有效的 .pom 文件，所以 Maven 2 无法继续。

你应该做的是先删除它。

```
rm -rf ~/.m2/repository/com/sun/jersey
rm -rf ~/.m2/repository/org/glassfish/packager
rm -rf ~/.m2/repository/jersey 
```

之后，再次运行 Maven mvn 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T05:45:23.917

maven2.0 在箍安装中不起作用。关于maven3.0.4的问题，可以尝试用官方文件更新pom.xml。只需在 google 中搜索 jersey-project-1.4.pom 即可。

# objective-c - 回退时程序崩溃并且调度队列有动画方法

> ID：10843260
> 
> 赞同：1
> 
> 时间：2012-06-01T01:16:15.487
> 
> 标签：objective-c, ios5, uiscrollview, grand-central-dispatch, segue

Ok so i have a uitableview and when an item is selected it segues to a new view controller to show an image (inside of a uiscrollview). 图像开始从 prepareforsegue 的 dispatch_queue 中下载。需要明确的是，我正在主队列中进行所有 UI 更新。问题是，如果我足够快地点击后退按钮，那么我的程序会因 exc_bad_address 崩溃。我认为问题必须处理 zoomToRect 动画：是的，因为当我将动画设置为 NO 时，我无法让它崩溃。加上下面的调用堆栈处理动画。解决此问题的最佳方法是什么，是否有更好的方法来完成我需要做的事情？

同样在调试问题时打印“块已完成”，然后不久后崩溃。

[堆栈跟踪](http://i49.tinypic.com/23qxc0m.jpg)

这是调用的方法。它在 prepareForSegue 中目标控制器的设置器中调用。

```
-(void) updateDisplay {
dispatch_queue_t queue = dispatch_queue_create("Load Flickr Photo", NULL);

    UIActivityIndicatorView *spinner = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
    self.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc] initWithCustomView:spinner];
    [spinner startAnimating];

    dispatch_async(queue, ^{

        UIImage *image = [FlickrFetcher imageForPhoto:self.currentPhoto format:FlickrPhotoFormatLarge];

        dispatch_async(dispatch_get_main_queue(), ^{

            self.navigationItem.rightBarButtonItem = nil;
            self.imageView.image = image;
            self.title = [FlickrFetcher titleForPhoto:self.currentPhoto];    
            CGAffineTransform transform = CGAffineTransformMakeScale(1.0, 1.0);
            self.imageView.transform = transform;

            self.imageView.frame = CGRectMake(0, 0, self.imageView.image.size.width, self.imageView.image.size.height);

            self.scrollView.maximumZoomScale = 4.0;
            self.scrollView.minimumZoomScale = .2;
            self.scrollView.zoomScale = 1;
            self.scrollView.contentSize = self.imageView.bounds.size;

            //i think problem is here
            [self.scrollView zoomToRect:self.imageView.frame animated:YES];
            NSLog(@"Block completed");
        });
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-07-03T11:20:22.530

我认为一个潜在的问题可能是，当您的块`self`在队列中处于活动状态时保留您的视图控制器......

如果您 send `-zoomToRect:animated:NO`，该块仍将处于活动状态并在调用时阻塞，从而确保所有对象在内存中仍然有效。

如果您发送`-zoomToRect:animated:YES`，该块将退出可能会产生一个竞争条件，您的视图控制器将被释放，因为当您返回 segue 时，情节提要也会释放您的视图控制器，使其有效保留计数为零。

# javascript - 如何在css中进行图像颜色混合？

> ID：10843268
> 
> 赞同：0
> 
> 时间：2012-06-01T01:17:35.637
> 
> 标签：javascript, html, css

我有一个 png 图像，其中一些像素是透明的。图像全是白色的。给定十六进制代码，如何使用 css 或 javascript 将颜色混合到另一种颜色？

我正在寻找类似的东西（这只是伪代码）

```
<img src="test.png" style="color-blend:#ffea6e;"/> 
```

所以这样做的效果是，图像（因为它是白色的）新颜色将完全是给定的颜色。透明的像素不应受到影响（即保持透明）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T01:29:48.510

使用 CSS 渐变可以实现这种效果。只要确保混合部分具有正确的“停止”设置。

一个伟大的 CCS 梯度生成器：http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

您可以看到已经包含透明度的预设渐变来帮助您入门。

<canvas> 元素对于您要完成的工作似乎有点过头了，它是 HTML5 标记，仅受 IE9+ 支持（以及几乎所有其他浏览器；）。

# wpf - x：静态是什么意思

> ID：10843270
> 
> 赞同：0
> 
> 时间：2012-06-01T01:17:58.683
> 
> 标签：wpf, xaml

> **可能重复：**
> [“{x:Static}”在 XAML 中是什么意思？](https://stackoverflow.com/questions/507942/what-does-xstatic-mean-in-xaml)

在 xaml 文件中有：

```
Command="{x:Static src:CustomCommands.Create}" 
```

x：静态是什么意思？如果我将其删除，则在加载 xaml 时会引发错误，提示“无法创建未知类型的 CustomCommands.Create”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T01:20:51.767

[http://msdn.microsoft.com/en-us/library/ms742135.aspx](http://msdn.microsoft.com/en-us/library/ms742135.aspx)

上面来自 MSDN 的链接提到：

> 引用以符合公共语言规范 (CLS) 的方式定义的任何静态按值代码实体。引用的静态属性可用于在 XAML 中提供属性的值。

# c++ - C ++，转换字符串，使连续下划线序列变为单个下划线

> ID：10843271
> 
> 赞同：2
> 
> 时间：2012-06-01T01:18:03.330
> 
> 标签：c++, string

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-01T01:42:49.013

Using `erase/unique` and a C++11 lambda.

```
#include <algorithm>
#include <iostream>
#include <string>

int main()
{
    std::string text("_hello___world__");

    text.erase(
        std::unique(
            text.begin(),
            text.end(),
            [](char a, char b){ return (a == b) && (a == '_'); }
        ),
        text.end()
    );

    std::cout << text << '\n';

    return 0;
} 
```

If you don't want to use a lambda you could define a functor like:

```
class both_equal_to
{
    char value;
public:
    both_equal_to(char ch) : value(ch) {}

    bool operator()(char first, char second) const
    {
        return (first == second) && (first == value);
    }
}; 
```

and then replace the lambda with `both_equal_to('_')`.

If you are only using `char*` and don't want to pay the cost of constructing a `std::string` the following code is closer to RolandXu's code.

```
char *convert_underscores(char *str)
{
    if (str)
    {
        size_t length = strlen(str);
        char *end = std::unique(str, str + length, both_equal_to('_'));
        *end = '\0';
    }
    return str;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T01:47:15.157

without the libraries:

```
#include <stdio.h>
char *RemoveUnderScore(char *src)
{
    char* readIndex;
    char* writeIndex;
    if (src==NULL) return NULL;
    readIndex = writeIndex = src;

    while (*readIndex != '\0')
    {
        while(*readIndex !='_' && *readIndex != '\0')
            *writeIndex++ = *readIndex++;

        if (*readIndex != '\0')
            *writeIndex++ = *readIndex++;

        while (*readIndex == '_')
            readIndex++;
    }

    *writeIndex = '\0';
    return src;
}

int main(int argc,char** argv){
    char str[] = "_hello___worl__d___";
    printf(RemoveUnderScore(str));
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-01T03:58:11.693

**This post compares the speed of the methods submitted on this page. I ran the function a million times on a 40 char string and timed how long each algorithm took.**

**Time Required | Algorithm Used**

**0.2 seconds** | RolandXu's version using char*, juggling pointers to chars.

**0.4 seconds** | Blastfurnace's version part two, functor, without string.

**2.7 seconds** | Blastfurnace's version part one with the functor and string.

**8.7 seconds** | Eric L's version looping over the string doing find __ replace with _.

**11.0 seconds** | Eric L's version looping over each char and assembling a string.

**11.8 seconds** | Jerry Coffin's version with remove_copy_if.

**C++ code to Prove the above benchmarks and timings:**

```
#include <iostream>
#include <cstdio>
#include <ctime>
#include <cstring>
#include <algorithm>

using namespace std;
string convert_underscores_by_EricL_using_string_replace(string str){

    //Cons:
        //This is the very slowest algorithm because the complexity of this operation
        //is O(n^2) and possibly higher with the overhead of string conversions.
    //Pros:
        //This is the function is the most concise, needing only 3 lines of code.

    while(str.find("__") != string::npos){
        str = str.replace(str.find("__"), 2, "_");
    }
    return str;
}

string convert_underscores_EricL_loop_over_a_string_and_remove_repeats(string str){

    //CONS:
        //Using a string really slows things down. Algorithm is too slow.
        //Not the most concise solution, 8 lines.
        //Has lots of ugly conditionals, x, and x-1, confusing to look at.
    //PROS:
        //Fastest function of those tested.  

    int len = str.length();
    string result = "";
    if (len < 2) return str;
    result += str[0];
    for(int x = 1; x < len; x++){
        if (str[x] != str[x-1] || str[x] != '_')
            result += str[x];
    }
    return result;
}

class repeated_by_jerry_coffin {
char prev;
char val;
public:
    repeated_by_jerry_coffin(char ch) : val(ch), prev(0) {}
    bool operator()(char ch) {
        bool ret = prev == val && ch == val;
        prev = ch;
        return ret;
    }
};
string convert_underscores_jerry_coffins_with_remove_copy_if(string str){

    //CONS:
        //Algorithm is the 2nd slowest algorithm.
    //PROS:
        //Concise, intuitive, needing only 4 lines.
        //Offloads the heavy lifting to std builtin methods: std::remove_copy_if and std::back_inserter

    string result = "";
    std::remove_copy_if(str.begin(), str.end(),
        std::back_inserter(result),
        repeated_by_jerry_coffin('_'));

    return result;
}

char* convert_underscores_by_RolandXu_using_char_stars_and_pointers(char *src){

    //CONS:
        //You have to get your hands dirty with C++ pointers.
    //PROS:
        //Fastest function of those tested.  

    char* readIndex;
    char* writeIndex;
    if (src==NULL) return NULL;
    readIndex = writeIndex = src;

    while (*readIndex != '\0')
    {
        while(*readIndex !='_' && *readIndex != '\0')
            *writeIndex++ = *readIndex++;

        if (*readIndex != '\0')
            *writeIndex++ = *readIndex++;

        while (*readIndex == '_')
            readIndex++;
    }
    *writeIndex = '\0';
    return src;
}

class both_equal_to__blastfurnace_version1{
char value;
public:
    both_equal_to__blastfurnace_version1(char ch) : value(ch) {}
    bool operator()(char first, char second) const{
        return (first == second) && (first == value);
    }
};
string convert_underscores_blastfurnace_version1_with_functor(string str){

    //CONS:
        //You have to create an entirely new class that overloads an operator.  
        //The speed is harmed by the usage of string.
    //PROS:
        //Don't need to roll your own loops with pointers.

    str.erase(
        std::unique(
            str.begin(),
            str.end(),
            both_equal_to__blastfurnace_version1('_')
        ),
        str.end()
    );

    return str;
}

class both_equal_to_blastfurnace_version2{
char value;
public:
    both_equal_to_blastfurnace_version2(char ch) : value(ch) {}
    bool operator()(char first, char second) const{
        return (first == second) && (first == value);
    }
};
char *convert_underscores_blastfurnace_version2_std_unique_and_no_string(char *str){
    //CONS:
        //No problems.
    //PROS:
        //More concise/intuitive than the fastest version and nearly as fast.  Winner!

    if (str){
        size_t length = strlen(str);
        char *end = std::unique(str, str + length, both_equal_to_blastfurnace_version2('_'));
        *end = '\0';
    }
    return str;
}

void assertCharStarEquals(char* a, char* b, string msg){
    if (strcmp(a, b) == 0) cout<<"passed" << endl;
    else cout << "Failed" << msg << " should be: '" << a << "'  it returned: '" << b << "'" << endl;
}
void assertStringEquals(string a, string b, string msg){
    if (a == b) cout<<"passed" << endl;
    else cout << "Failed" << msg << " should be: '" << a << "'  it returned: '" << b << "'" << endl;
}

void test01_convert_underscores_by_RolandXu_using_char_stars_and_pointers(int numtests, string str){
    char mystr[str.length()];
    strcpy(mystr, str.c_str());

    clock_t start = clock();
    int x = 0;
    while(x < numtests){
        char* s = convert_underscores_by_RolandXu_using_char_stars_and_pointers(mystr);
        x++;
    }
    double diff = (std::clock() - start) / (double)CLOCKS_PER_SEC;
    cout <<  diff << "   RolandXu's version using char*. " << '\n';

}

void test02_convert_underscores_blastfurnace_version2_std_unique_and_no_string(int numtests, string str){

    char mystr[str.length()];
    strcpy(mystr, str.c_str());

    clock_t start = clock();
    int x = 0;
    while(x < numtests){
        char* val = convert_underscores_blastfurnace_version2_std_unique_and_no_string(mystr);
        x++;
    }
    double diff = (std::clock() - start) / (double)CLOCKS_PER_SEC;
    cout << diff << "   Blastfurnace's version part two, functor, without string. " <<endl;
}

void test03_convert_underscores_blastfurnace_version1_with_functor(int numtests, string str){

    clock_t start = clock();
    int x = 0;
    while(x < numtests){
        string s = convert_underscores_blastfurnace_version1_with_functor(str);
        x++;
    }
    double diff = (std::clock() - start) / (double)CLOCKS_PER_SEC;
    cout << diff << "   Blastfurnace's version part one with the functor and string. " <<endl;
}
void test04_convert_underscores_by_EricL_using_string_replace(int numtests, string str){

    char mystr[str.length()];
    strcpy(mystr, str.c_str());

    clock_t start = clock();
    int x = 0;
    while(x < numtests){
        string s = convert_underscores_by_EricL_using_string_replace(mystr);
        x++;
    }
    double diff = (std::clock() - start) / (double)CLOCKS_PER_SEC;
    cout<<  diff << "   Eric L's version looping over the string doing find double underscore replace with single underscore. " <<endl;
}

void test05_convert_underscores_EricL_loop_over_a_string_and_remove_repeats(int numtests, string str){

    char mystr[str.length()];
    strcpy(mystr, str.c_str());

    clock_t start = clock();
    int x = 0;
    while(x < numtests){
        string s = convert_underscores_EricL_loop_over_a_string_and_remove_repeats(mystr);
        x++;
    }
    double diff = (std::clock() - start) / (double)CLOCKS_PER_SEC;
    cout <<  diff << "   Eric L's version looping over each char and assembling a string. "<< endl;
}

void test06_convert_underscores_jerry_coffins_with_remove_copy_if(int numtests, string str){
    clock_t start = clock();
    int x = 0;
    while(x < numtests){
        string s = convert_underscores_jerry_coffins_with_remove_copy_if(str);
        x++;
    }
    double diff = (std::clock() - start) / (double)CLOCKS_PER_SEC;
    cout<<  diff << "   Jerry Coffin's version with remove_copy_if. " <<endl;
}

int main(){
    cout << "GO!\n";

    int numtests = 1000000;
    string test_string = "__aa_a_aaa_--__&___aa_234______3)_!___<_";
    cout << "Time | Algorithm Used.\n";

    test01_convert_underscores_by_RolandXu_using_char_stars_and_pointers(numtests, test_string);

    test02_convert_underscores_blastfurnace_version2_std_unique_and_no_string(numtests, test_string);

    test03_convert_underscores_blastfurnace_version1_with_functor(numtests, test_string);

    test04_convert_underscores_by_EricL_using_string_replace(numtests, test_string);

    test05_convert_underscores_EricL_loop_over_a_string_and_remove_repeats(numtests, test_string);

    test06_convert_underscores_jerry_coffins_with_remove_copy_if(numtests, test_string);

    //Produces the following output:

    //Extra assertion testing to make sure everyone's algorithm is correct:
    char in[30];
    char out[30];
    strcpy(in, "a__");
    strcpy(out, "a_");
    assertCharStarEquals(out, convert_underscores_by_RolandXu_using_char_stars_and_pointers(in), "01");
    strcpy(in, "a_");
    strcpy(out, "a_");
    assertCharStarEquals(out, convert_underscores_by_RolandXu_using_char_stars_and_pointers(in), "02");
    strcpy(in, "_______");
    strcpy(out, "_");
    assertCharStarEquals(out, convert_underscores_by_RolandXu_using_char_stars_and_pointers(in), "03");
    strcpy(in, "__a");
    strcpy(out, "_a");
    assertCharStarEquals(out, convert_underscores_by_RolandXu_using_char_stars_and_pointers(in), "04");
    strcpy(in, "_hello___world__");
    strcpy(out, "_hello_world_");
    assertCharStarEquals(out, convert_underscores_by_RolandXu_using_char_stars_and_pointers(in), "05");
    strcpy(in, "");
    strcpy(out, "");
    assertCharStarEquals(out, convert_underscores_by_RolandXu_using_char_stars_and_pointers(in), "06");
    strcpy(in, "  __  ");
    strcpy(out, "  _  ");
    assertCharStarEquals(out, convert_underscores_by_RolandXu_using_char_stars_and_pointers(in), "07");
    strcpy(in, "U+221E");
    strcpy(out, "U+221E");
    assertCharStarEquals(out, convert_underscores_by_RolandXu_using_char_stars_and_pointers(in), "08");
    strcpy(in, "__\u00b2__");
    strcpy(out, "_\u00b2_");
    assertCharStarEquals(out, convert_underscores_by_RolandXu_using_char_stars_and_pointers(in), "09");

    cout<< "OK\n";

    strcpy(in, "a__");
    strcpy(out, "a_");
    assertCharStarEquals(out, convert_underscores_blastfurnace_version2_std_unique_and_no_string(in), "01");
    strcpy(in, "a_");
    strcpy(out, "a_");
    assertCharStarEquals(out, convert_underscores_blastfurnace_version2_std_unique_and_no_string(in), "02");
    strcpy(in, "_______");
    strcpy(out, "_");
    assertCharStarEquals(out, convert_underscores_blastfurnace_version2_std_unique_and_no_string(in), "03");
    strcpy(in, "__a");
    strcpy(out, "_a");
    assertCharStarEquals(out, convert_underscores_blastfurnace_version2_std_unique_and_no_string(in), "04");
    strcpy(in, "_hello___world__");
    strcpy(out, "_hello_world_");
    assertCharStarEquals(out, convert_underscores_blastfurnace_version2_std_unique_and_no_string(in), "05");
    strcpy(in, "");
    strcpy(out, "");
    assertCharStarEquals(out, convert_underscores_blastfurnace_version2_std_unique_and_no_string(in), "06");
    strcpy(in, "  __  ");
    strcpy(out, "  _  ");
    assertCharStarEquals(out, convert_underscores_blastfurnace_version2_std_unique_and_no_string(in), "07");
    strcpy(in, "U+221E");
    strcpy(out, "U+221E");
    assertCharStarEquals(out, convert_underscores_blastfurnace_version2_std_unique_and_no_string(in), "08");
    strcpy(in, "__\u00b2__");
    strcpy(out, "_\u00b2_");
    assertCharStarEquals(out, convert_underscores_blastfurnace_version2_std_unique_and_no_string(in), "09");

    cout<< "OK\n";

    string in_s = "a__";
    string out_s = "a_";
    assertStringEquals(out_s, convert_underscores_blastfurnace_version1_with_functor(in_s), "01");
    in_s = "a_";
    out_s = "a_";
    assertStringEquals(out_s, convert_underscores_blastfurnace_version1_with_functor(in_s), "02");
    in_s = "_______";
    out_s = "_";
    assertStringEquals(out_s, convert_underscores_blastfurnace_version1_with_functor(in_s), "03");
    in_s = "__a";
    out_s = "_a";
    assertStringEquals(out_s, convert_underscores_blastfurnace_version1_with_functor(in_s), "04");
    in_s = "_hello___world__";
    out_s = "_hello_world_";
    assertStringEquals(out_s, convert_underscores_blastfurnace_version1_with_functor(in_s), "05");
    in_s = "";
    out_s = "";
    assertStringEquals(out_s, convert_underscores_blastfurnace_version1_with_functor(in_s), "06");
    in_s = "  __  ";
    out_s = "  _  ";
    assertStringEquals(out_s, convert_underscores_blastfurnace_version1_with_functor(in_s), "07");
    in_s = "U+221E";
    out_s = "U+221E";
    assertStringEquals(out_s, convert_underscores_blastfurnace_version1_with_functor(in_s), "08");
    in_s = "__\u00b2__";
    out_s = "_\u00b2_";
    assertStringEquals(out_s, convert_underscores_blastfurnace_version1_with_functor(in_s), "09");

    cout<< "OK\n";

    in_s = "a__";
    out_s = "a_";
    assertStringEquals(out_s, convert_underscores_by_EricL_using_string_replace(in_s), "01");
    in_s = "a_";
    out_s = "a_";
    assertStringEquals(out_s, convert_underscores_by_EricL_using_string_replace(in_s), "02");
    in_s = "_______";
    out_s = "_";
    assertStringEquals(out_s, convert_underscores_by_EricL_using_string_replace(in_s), "03");
    in_s = "__a";
    out_s = "_a";
    assertStringEquals(out_s, convert_underscores_by_EricL_using_string_replace(in_s), "04");
    in_s = "_hello___world__";
    out_s = "_hello_world_";
    assertStringEquals(out_s, convert_underscores_by_EricL_using_string_replace(in_s), "05");
    in_s = "";
    out_s = "";
    assertStringEquals(out_s, convert_underscores_by_EricL_using_string_replace(in_s), "06");
    in_s = "  __  ";
    out_s = "  _  ";
    assertStringEquals(out_s, convert_underscores_by_EricL_using_string_replace(in_s), "07");
    in_s = "U+221E";
    out_s = "U+221E";
    assertStringEquals(out_s, convert_underscores_by_EricL_using_string_replace(in_s), "08");
    in_s = "__\u00b2__";
    out_s = "_\u00b2_";
    assertStringEquals(out_s, convert_underscores_by_EricL_using_string_replace(in_s), "09");

    cout<< "OK\n";

    in_s = "a__";
    out_s = "a_";
    assertStringEquals(out_s, convert_underscores_EricL_loop_over_a_string_and_remove_repeats(in_s), "01");
    in_s = "a_";
    out_s = "a_";
    assertStringEquals(out_s, convert_underscores_EricL_loop_over_a_string_and_remove_repeats(in_s), "02");
    in_s = "_______";
    out_s = "_";
    assertStringEquals(out_s, convert_underscores_EricL_loop_over_a_string_and_remove_repeats(in_s), "03");
    in_s = "__a";
    out_s = "_a";
    assertStringEquals(out_s, convert_underscores_EricL_loop_over_a_string_and_remove_repeats(in_s), "04");
    in_s = "_hello___world__";
    out_s = "_hello_world_";
    assertStringEquals(out_s, convert_underscores_EricL_loop_over_a_string_and_remove_repeats(in_s), "05");
    in_s = "";
    out_s = "";
    assertStringEquals(out_s, convert_underscores_EricL_loop_over_a_string_and_remove_repeats(in_s), "06");
    in_s = "  __  ";
    out_s = "  _  ";
    assertStringEquals(out_s, convert_underscores_EricL_loop_over_a_string_and_remove_repeats(in_s), "07");
    in_s = "U+221E";
    out_s = "U+221E";
    assertStringEquals(out_s, convert_underscores_EricL_loop_over_a_string_and_remove_repeats(in_s), "08");
    in_s = "__\u00b2__";
    out_s = "_\u00b2_";
    assertStringEquals(out_s, convert_underscores_EricL_loop_over_a_string_and_remove_repeats(in_s), "09");

    cout<< "OK\n";

    in_s = "a__";
    out_s = "a_";
    assertStringEquals(out_s, convert_underscores_jerry_coffins_with_remove_copy_if(in_s), "01");
    in_s = "a_";
    out_s = "a_";
    assertStringEquals(out_s, convert_underscores_jerry_coffins_with_remove_copy_if(in_s), "02");
    in_s = "_______";
    out_s = "_";
    assertStringEquals(out_s, convert_underscores_jerry_coffins_with_remove_copy_if(in_s), "03");
    in_s = "__a";
    out_s = "_a";
    assertStringEquals(out_s, convert_underscores_jerry_coffins_with_remove_copy_if(in_s), "04");
    in_s = "_hello___world__";
    out_s = "_hello_world_";
    assertStringEquals(out_s, convert_underscores_jerry_coffins_with_remove_copy_if(in_s), "05");
    in_s = "";
    out_s = "";
    assertStringEquals(out_s, convert_underscores_jerry_coffins_with_remove_copy_if(in_s), "06");
    in_s = "  __  ";
    out_s = "  _  ";
    assertStringEquals(out_s, convert_underscores_jerry_coffins_with_remove_copy_if(in_s), "07");
    in_s = "U+221E";
    out_s = "U+221E";
    assertStringEquals(out_s, convert_underscores_jerry_coffins_with_remove_copy_if(in_s), "08");
    in_s = "__\u00b2__";
    out_s = "_\u00b2_";
    assertStringEquals(out_s, convert_underscores_jerry_coffins_with_remove_copy_if(in_s), "09");

    return 0;
} 
```

**What did we learn?**

1.  With c++ string, 'str.length()' is really heavy, as the compiler dutifully steps one-by-one though the memory of the string, locating the end of the string in memory, counting as it goes. Don't use string, and don't use str.length();

2.  Using str.end() invokes an O(n) performance hit as well, same as item 1\. Don't use str.end();

3.  Using std::unique on a char array is optimized and lightning fast. An order of magnitude faster than a for loop with string concatenation.

4.  In C++, doing a mystring[x] results in a memory lookup of that slot in memory, which takes a long time and is much slower than using a pointer and adding 1 to the pointer. Do not put mystring[x] inside a loop that iterates on x.

5.  If you must use a string, do not put mystring += anotherstring[x]; string has to step one-by-one through the entire string each time you run this line.

6.  DO NOT concatenate strings, grab a chunk of memory, define a pointer, and place characters in the pointer, and increment the pointer. Loops and concatenation with strings invokes O(n) complexity.

Much learning has occurred on this day, great songs will be sung.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-01T01:19:10.880

**In C++, what I gave, very inefficiently:**

```
string convert_underscores(string str){
    int len = str.length();   
    //bad, str.length() incurs O(n) complexity.

    string result = "";
    //bad, don't use string.  string makes everything slow.

    if (len < 2) return str;  
    result += str[0];
    //bad bad bad, string concatenation incurs O(n) complexity.

    for(int x = 1; x < len; x++){  
        //This for loop incurs unnecessary management overhead.

        if (str[x] != str[x-1] || str[x] != '_'){
            result += str[x];  
            //concatenation extremely evil here: costs O(n)
            //A lookup on str[x] costs time.  
        }
    }

    return result;  
    //returning a string bad, the entire memory is moved 
    //instead of just a pointer to the first slot.
} 
```

**or even less efficient with str.replace.**

```
string convert_underscores(string str){
    while(str.find("__") != string::npos){ 
        str = str.replace(str.find("__"), 2, "_");
    }
    return str;
}
//find incurs unnecessary O(n) complexity. string copy incurs 
//a full memory movement on contents of string.  
//n passes are required over the string. 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-06-01T02:18:42.517

I think I'd use `std::remove_copy_if`, something like this:

```
char prev;

std::remove_copy_if(input.begin(), input.end(), 
    std::back_inserter(result), 
    [&prev] (char ch) ->bool { 
        bool ret=prev=='_' && ch == '_'; 
        prev=ch; 
        return ret;
}); 
```

Or, if you're stuck with C++03, you can do the same with an explicit functor instead of a lambda:

```
class repeated { 
    char prev;
    char val;
public:
    repeated(char ch) : val(ch), prev(0) {}

    bool operator()(char ch) { 
        bool ret = prev == val && ch == val; 
        prev = ch;
        return ret;
    }
};

std::remove_copy_if(input.begin(), input.end(), 
                    std::back_inserter(result), 
                    repeated('_')); 
```

Either way, it only copies each character from input to output (at most) once, where using `std::string::replace` copies each character as often as the number of repeated underscores to its left.

Edit: though looking at @blastfurnace's answer, I'm not sure I really would use this -- `std::unique` probably is better suited to this job.

# django - django 我如何在 listview url 中混合 order_by 和 get？

> ID：10843273
> 
> 赞同：0
> 
> 时间：2012-06-01T01:18:56.570
> 
> 标签：django

所以我想创建：

select * from Post where Post.is_chosen = true order_by create_date

我希望这发生在 urls.py 中（也就是说，不必定义任何东西，只需将其粘贴在 ListView 参数中）

我该怎么做呢？

我目前有：

```
url(r'^$',ListView.as_view(
    queryset=Post.objects.get(is_chosen = True).order_by('-pub_date')[:20],
    context_object_name='latest_post_list',
    template_name='posts/index.html')), 
```

但这有一个错误 - 我不能在“get”的返回对象上调用 order_by 这是有道理的，但我该怎么做？

如果无法在 url 定义中执行，我愿意从定义的函数调用命令！

更新：啊，我是个白痴。

“get”只返回一项，所以“order_by”当然不能处理它。我现在改用过滤器！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T01:44:17.750

就像[文档](https://docs.djangoproject.com/en/dev/ref/models/querysets/#filter)说的那样，`.filter()`改用。

# php - 下面最快的MYSQL结构？

> ID：10843275
> 
> 赞同：1
> 
> 时间：2012-06-01T01:19:04.657
> 
> 标签：php, mysql

当前存储有关人名的 3 位信息。

```
name,nicename,searchname = ("Mr.Joe bloggs", "Mr-Joe-bloggs", "mrjoebloggs") 
```

用于用户显示名称的名称，用于 url 的 nicename 和用于实时搜索数据库的 searchname（因此速度是必须的，毫秒很重要！）

目前一个表包含所有 3 个字段，但是将每个字段存储在单独的表中会更有效吗？并通过 id 关联所有内容？

还是会浪费额外的选择将它们相互关联？DB 将有超过 1 亿条记录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T01:39:01.810

如果您坚持保留这三个字段，您将与每条数据建立一对一的关系。将它们全部放在同一行中是有意义的。

但是，您可能会发现只存储名称会更好。当您需要“好名字”时，您可以使用正则表达式将句点和空格（以及其他字符）替换为连字符（或删除它们）。当用户搜索“mr joe bloggs”时，您可以通过将三个单词分开并使用 LIKE 子句来制作一个简单的搜索算法。

# php - 如何使用请求 url 提取值

> ID：10843279
> 
> 赞同：2
> 
> 时间：2012-06-01T01:19:18.413
> 
> 标签：php, html

我`$_SERVER['REQUEST_URI']`的类似于 /advt/upload/siteid/1。我需要从指定的路径中检索那个“1”。我怎样才能进行预赛或其他任何事情？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T01:23:33.407

你想要最后一个路径段吗？简单的！

```
$lastPathSegment = basename($_SERVER['REQUEST_URI']); 
```

[键盘](http://codepad.org/N37TJ0mh)。

您可能想要使用`rtrim($_SERVER['REQUEST_URI'], '/')`以确保路径没有尾部斜杠。

还有很多其他方法可以做到这一点。假设`$uri = rtrim($_SERVER['REQUEST_URI'], '/')`...

```
$lastPathSegment = end(explode("/", $uri)); 
```

[键盘](http://codepad.org/na6kxRIM)。

```
$lastPathSegment = ltrim(strrchr($uri, "/"), "/"); 
```

[键盘](http://codepad.org/4eJHAyQi)。

```
$lastPathSegment = substr($uri, 1 + strrpos($uri, "/")); 
```

[键盘](http://codepad.org/D3J3mTVx)。

```
$lastPathSegment = preg_replace('/^.+\//', '', $uri); 
```

[键盘](http://codepad.org/dLSwRIgL)。

...还有很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:26:01.767

如果你想要最后一段：

```
$endSegment = basename($_SERVER['REQUEST_URI']); 
```

否则如果不是最后一个，但你知道值的索引

```
$pieces = explode("/", $_SERVER['REQUEST_URI']);

$selectedSegment = $pieces[3]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T01:29:18.490

您可以使用拆分功能，即

```
list($sec1,$sect2,$sect3,$sect4) = explode("/", $_SERVER['REQUEST_URI']); 
```

其中 $sect4 是您的号码，或者只是一个直接数组

```
$uri = explode("/", $_SERVER['REQUEST_URI']);

$num = $uri[3]; 
```

您可能还想查看正则表达式

```
preg_match('/(?P<sect1>\w+)\(?P<sec2>\w+)\(?P<sect3>\w+)\ (?P<digit>\d+)/', $_SERVER['REQUEST_URI'], $matches);

print_r($matches); 
```

有关 preg 匹配的更多信息，请参见此链接[preg_match](http://php.net/manual/en/function.preg-match.php)

# c# - 想要来自 SQL 表搜索 C# 的布尔结果

> ID：10843284
> 
> 赞同：0
> 
> 时间：2012-06-01T01:20:09.097
> 
> 标签：c#

我正在尝试使用 C# SQL 搜索，然后获得有关是否找到该项目的布尔结果。我的搜索语句有效，但布尔结果部分无效。

例如：如果我有一个名为 @Names 的列的表，其名称为 A、B、C，但我搜索名称 D，我如何或可以获得布尔结果返回并将 false 保存在布尔变量中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T01:28:11.000

您可以尝试这种方法：

```
string query = @"
select case when exists (
    select 1
    from MyTable
    where Name='D' -- This is the condition you are checking
) then 1 else 0 end";

bool exists;
using(var command = new SqlCommand(query, connection))
{
     exists = Convert.ToBoolean(command.ExecuteScaler());
} 
```

您现在可以使用该[`ExecuteScalar`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executescalar.aspx)方法，并将结果转换`bool`为查询结果。

# c# - 使用 C# 修改 word doc 中的多个标题

> ID：10843287
> 
> 赞同：0
> 
> 时间：2012-06-01T01:20:36.660
> 
> 标签：c#, ms-word

我目前正在使用 C# 中的 Word 引用来打开和修改 Word 文档。一些需要修改的内容在标题中，并且正在使用以下代码来说明这一点。

```
foreach(Range rng in doc.StoryRanges){
   rng.Find.Execute(ref findVar, ref isTrue, ref isTrue, ref isFalse, 
   ref isFalse, ref isFalse, ref isTrue, ref isOne, 
   ref isFalse, ref replaceVar, ref isTwo, ref isFalse, 
   ref isFalse, ref isFalse, ref isFalse);
} 
```

问题是我的文档有两个唯一的标题。第一个由前 4 页组成，然后在第 5 页是不同的页眉。它在 Word 中标记为“标题 - 第 2 节-”。我无法找到允许我在第二个标题中进行任何修改的代码片段。

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T16:54:42.773

我能够在此站点上找到一个代码片段，它能够在整个文档中进行查找和替换：[http ://www.wwco.com/~wls/blog/2010/07/03/find-and-使用 c-net 替换单词/](http://www.wwco.com/~wls/blog/2010/07/03/find-and-replace-in-word-using-c-net/)

这将遍历文档的所有部分，因此不会遗漏任何部分。

# objective-c - 如何让 doubleValue 返回超过六位的十进制数？

> ID：10843292
> 
> 赞同：0
> 
> 时间：2012-06-01T01:21:12.697
> 
> 标签：objective-c

执行以下操作时：

NSString *scratchString = @".123456789";

CGFloat scratchNum = [scratchString doubleValue];

scratNum 包含 0.123457

如何让 scratchNum 包含所有数字？无论我尝试什么，它都会四舍五入到 6 个位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T01:29:59.430

`CGFloat`是一个浮点数—— a`float`或 a `double`（取决于`typedef`编译器选择哪个）。

没有浮点数不“包含所有数字”的概念。它们的内部表示各不相同，但在这种情况下，您的 C`float`由[IEEE 754 标准](http://en.wikipedia.org/wiki/IEEE_754-2008)表示。

在这种情况下，您的“四舍五入”是采用该浮点数并将其从二进制形式转换为文本形式的结果。这可能是 Xcode IDE 本身（例如在调试器中可视化值），或者您可能正在使用一条`printf`语句并指定了特定的格式。

# audio - DirectSound 通常支持回声消除和降噪吗？

> ID：10843294
> 
> 赞同：0
> 
> 时间：2012-06-01T01:21:33.253
> 
> 标签：audio, voip, directsound, aec

我目前正在使用 waveInOpen 一组 Windows API 函数来录制 VOIP 应用程序的音频。我现在被要求添加回声消除，可能还有降噪和增益控制。我对 DirectSound 一无所知，但是在 Google 上搜索“回声消除”时，我在 MSDN 上发现了对 DirectSound 的引用，例如[CaptureAcousticEchoCancellationEffect](http://msdn.microsoft.com/en-us/library/windows/desktop/bb280852%28v=vs.85%29.aspx)。

如果我切换到 DirectSound，我会“免费”获得其中一些功能吗？是否仅在硬件支持的情况下才支持它们？如果支持，该硬件在普通消费者 PC 中出现的频率如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T05:43:41.587

从 Windows Vista 开始，Microsoft 提供了一个单独的组件[Voice Capture DSP](http://msdn.microsoft.com/en-us/library/windows/desktop/ff819492%28v=vs.85%29.aspx)：

> 语音捕获 DMO 包括以下 DSP 组件：
> 
> ```
> Acoustic echo cancellation (AEC)
> Microphone array processing
> Noise suppression
> Automatic gain control
> Voice activity detection 
> ```
> 
> 应用程序可以单独打开和关闭每个组件。

您可以在 DSP 应用程序中使用它来利用软件中实现的 EAC 和 NS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T05:37:13.693

据我所知，这些功能在 DirectSound 中不受专业支持。支持这些功能的硬件设备通常配备一个特殊的处理器/DSP，并且比标准硬件设备的成本要高得多。

# c# - 尝试将 struct 转换为 byte[] 时的方法访问期望

> ID：10843295
> 
> 赞同：3
> 
> 时间：2012-06-01T01:21:49.603
> 
> 标签：c#, asp.net, struct, bytearray

我需要将以下结构转换为字节数组：

```
[Serializable]
public struct newLeads
{
    public string id;
    public string first_name;
    public string last_name;
} 
```

我正在尝试使用以下代码转换为字节数组：

```
public class ConvertStruct
{
    public static byte[] StructureToByteArray(object obj)
    {
        int Length = Marshal.SizeOf(obj);
        byte[] bytearray = new byte[Length];
        IntPtr ptr = Marshal.AllocHGlobal(Length);
        Marshal.StructureToPtr(obj, ptr, false);
        Marshal.Copy(ptr, bytearray, 0, Length);
        Marshal.FreeHGlobal(ptr);
        return bytearray;
    }
} 
```

我在网上遇到了异常：

```
IntPtr ptr = Marshal.AllocHGlobal(Length); 
```

> 例外：通过安全透明方法 'Classes.ConvertStruct.ConvertStruct.StructureToByteArray(System.Object)' 尝试访问安全关键方法 'System.Runtime.InteropServices.Marshal.AllocHGlobal(Int32)' 失败。"}

我的问题是？如何解决此问题以避免异常并将我的简单结构转换为`byte[]`?

提前致谢！

更新：我在控制台应用程序中尝试了这个并且它有效。我从一个 asp.net 页面代码隐藏中调用它，所以它一定与它有关，但我不知道是什么！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T01:57:10.193

1.  检查结构的大小，不要装箱。
2.  为字符串设置一个适当的封送处理（从[goric的](https://stackoverflow.com/users/940/goric)[答案](https://stackoverflow.com/a/10843370/402022)中获取），除此之外，您将得到的是字节数组中字符串的内存地址（不是一件好事）。

    ```
    [Serializable]
    public struct newLeads
    {
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 5000)]
        public string id;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 5000)]
        public string first_name;
        [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 5000)]
        public string last_name;
    }

    [SecurityPermission(SecurityAction.Demand, UnmanagedCode = true)]
    public static byte[] ToByteArray(newLeads value)
    {
        int length = Marshal.SizeOf(typeof(newLeads));
        var result = new byte[length];
        IntPtr sourcePtr = Marshal.AllocHGlobal(length);
        Marshal.StructureToPtr(value, sourcePtr, false);
        Marshal.Copy(sourcePtr, result, 0, length);
        Marshal.FreeHGlobal(sourcePtr);
        return result;
    } 
    ```

* * *

在您的评论中，您说此代码会更快失败。好吧，它使用安全权限需求（如 .NET 4 推荐的那样），每次调用该方法时都会检查特定权限。您可以尝试在没有它的情况下执行它，而预期的结果就是您一开始得到的结果。

* * *

## 真正的答案

您必须在受限环境中运行，可能是某种沙箱或不支持指针的平台。在这种情况下，我们可能需要通过其他方式进行转换。

你说的是 ASP.NET？就是这样了。

为了在没有指针的情况下进行转换，请尝试以下技术：

```
//You will have to decide an encoding.
//If nto ASCII, try UTF8Encoding, UnicodeEncoding or (Hopefully not) UTF7Encoding
void Main()
{
    Encoding encoding = new ASCIIEncoding();
    newLeads target = GetNewLeads();
    byte[] id = EncodeString(target.id, encoding);
    byte[] first_name = EncodeString(target.first_name, encoding);
    byte[] last_name = EncodeString(target.last_name, encoding);
}

byte[] EncodeString(string str, Encoding encoding)
{
    byte[] data;
    if (ReferenceEquals(str, null))
    {
        data = new byte[0];
    }
    else
    {
        data = encoding.GetBytes(str);
    }
    return data;
} 
```

在这一点上，我需要更多地了解您的情况，以便为您提供更好的解决方案，特别是谁或什么将读取该字节数组？无论如何，您可以对字符串的长度进行编码，如下所示（为 null 保留 -1）：

```
byte[] EncodeString(string str, Encoding encoding)
{
    byte[] data;
    byte[] data_length;
    Union union = new Union();
    if (ReferenceEquals(str, null))
    {
        data = new byte[0];
        union.data = -1;
    }
    else
    {
        data = encoding.GetBytes(str);
        union.data = str.Length;
    }
    data_length = new byte[]{union.a, union.b, union.c, union.c};
    int length = data.Length;
    byte[] result = new byte[4 + data.Length];
    System.Buffer.BlockCopy(data_length, 0, result, 0, 4);
    System.Buffer.BlockCopy(data, 0, result, 4, length);
    return result;
}

//I hope endianess doesn't bite
[StructLayout(LayoutKind.Explicit)] 
struct Union
{
    [FieldOffset(0)]
    public int data;
    [FieldOffset(0)] 
    public byte a;
    [FieldOffset(1)] 
    public byte b;
    [FieldOffset(2)] 
    public byte c;
    [FieldOffset(3)] 
    public byte d;
} 
```

最后，我们需要加入这些数组。我知道这可以进一步优化......（使用 MemoryStream 和 StreamWriter 的一个好主意）无论如何，这是我的第一个实现 [测试]：

```
byte[] ToByteArray(newLeads value)
{
    Encoding encoding = new ASCIIEncoding(); //Choose some encoding
    byte[] id = EncodeString(value.id, encoding);
    byte[] first_name = EncodeString(value.first_name, encoding);
    byte[] last_name = EncodeString(value.last_name, encoding);
    byte[] result = new byte[id.Length + first_name.Length + last_name.Length];
    System.Buffer.BlockCopy(id, 0, result, 0, id.Length);
    System.Buffer.BlockCopy
        (
            first_name,
            0,
            result,
            id.Length,
            first_name.Length
        );
    System.Buffer.BlockCopy
        (
            last_name,
            0,
            result,
            id.Length + first_name.Length,
            last_name.Length
        );
    return result;
}

byte[] EncodeString(string str, Encoding encoding)
{
    byte[] data;
    byte[] data_length;
    Union union = new Union();
    if (ReferenceEquals(str, null))
    {
        data = new byte[0];
        union.data = -1;
    }
    else
    {
        data = encoding.GetBytes(str);
        union.data = str.Length;
    }
    data_length = new byte[]{union.a, union.b, union.c, union.c};
    int length = data.Length;
    byte[] result = new byte[4 + data.Length];
    System.Buffer.BlockCopy(data_length, 0, result, 0, 4);
    System.Buffer.BlockCopy(data, 0, result, 4, length);
    return result;
}

//I hope endianess doesn't bite
[StructLayout(LayoutKind.Explicit)] 
struct Union
{
    [FieldOffset(0)]
    public int data;
    [FieldOffset(0)] 
    public byte a;
    [FieldOffset(1)] 
    public byte b;
    [FieldOffset(2)] 
    public byte c;
    [FieldOffset(3)] 
    public byte d;
} 
```

注意：我没有使用以空字符结尾的字符串，因为我不知道你最终会使用什么编码。

**优化**

相同的逻辑，但用流实现（联合没有改变）[测试]。

```
byte[] ToByteArray(newLeads value)
{
    Encoding encoding = new ASCIIEncoding(); //Choose some encoding
    var stream = new MemoryStream();
    EncodeString(value.id, stream, encoding);
    EncodeString(value.first_name, stream, encoding);
    EncodeString(value.last_name, stream, encoding);
    int length = (int)stream.Length;
    byte[] result = new byte[(int)stream.Length];
    System.Buffer.BlockCopy(stream.GetBuffer(), 0, result, 0, length);
    stream.Close();
    return result;
}

void EncodeString(string str, Stream stream, Encoding encoding)
{
    Union union = new Union();
    if (ReferenceEquals(str, null))
    {
        union.data = -1;
        stream.Write(new byte[]{union.a, union.b, union.c, union.c}, 0, 4);
    }
    else
    {
        union.data = str.Length;
        stream.Write(new byte[]{union.a, union.b, union.c, union.c}, 0, 4);
        var tmp = encoding.GetBytes(str);
        stream.Write(tmp, 0, tmp.Length);
    }
} 
```

* * *

## 把琴弦拉回来

为了取回数据，我们首先读取字符串的长度（使用相同的 Union 类型）：

```
var newLeads = GetNewLeads();
var z= ToByteArray(newLeads); //we have the byteArray in z

var data = new MemoryStream(z); //Create an stream for convenience
//Use the union to get the length
var union = new Union()
    {
        a = (byte)data.ReadByte(),
        b = (byte)data.ReadByte(),
        c = (byte)data.ReadByte(),
        d = (byte)data.ReadByte()
    };
Console.WriteLine(union.data); //the length of the first string 
```

我们的下一步是读取那么多字符，为此我们将使用 StreamReader：

```
var newLeads = GetNewLeads();
var z = ToByteArray(newLeads);

var data = new MemoryStream(z);
var union = new Union()
    {
        a = (byte)data.ReadByte(),
        b = (byte)data.ReadByte(),
        c = (byte)data.ReadByte(),
        d = (byte)data.ReadByte()
    };
var encoding = new ASCIIEncoding();
string result = null;
if (union.data != -1)
{
    char[] finalChars = new char[union.data];
    var reader = new StreamReader(data, encoding);
    reader.Read(finalChars, 0, union.data);
    result = new string(finalChars);
}
Console.WriteLine(result); 
```

有了这个，我们构建了一个解码字符串的方法：

```
string DecodeString(Stream data, Encoding encoding)
{   
    //TODO: You may want to validate that data and encoding are not null
    //or make this private
    var union = new Union()
    {
        a = (byte)data.ReadByte(),
        b = (byte)data.ReadByte(),
        c = (byte)data.ReadByte(),
        d = (byte)data.ReadByte()
    };
    string result = null;
    if (union.data != -1)
    {
        char[] finalChars = new char[union.data];
        var reader = new StreamReader(data, encoding);
        reader.Read(finalChars, 0, union.data);
        result = new string(finalChars);
    }
    return result;
}

//Convenience method, not needed:

string DecodeString(byte[] data, Encoding encoding)
{
    //TODO: You may want to validate that data and encoding are not null
    //or make this private
    return DecodeString(new MemoryStream(data), encoding);
} 
```

最后是恢复 newLeads 的方法（再次使用相同的 Union 类型）[已测试]：

```
newLeads FromByteArray(byte[] data)
{
    //TODO: Validate that data is not null
    Encoding encoding = new ASCIIEncoding(); //Choose the same encoding
    newLeads result = new newLeads();
    var reader = new StreamReader(new MemoryStream(data), encoding);
    result.id = DecodeString(reader);
    result.first_name = DecodeString(reader);
    result.last_name = DecodeString(reader);
    reader.Close();
    return result;
}

//Changed to reuse StreamReader...
//Because closing it will close the underlying stream
string DecodeString(StreamReader reader)
{
    //TODO: You may want to validate that reader is not null
    //or make this private
    var data = reader.BaseStream;
    var union = new Union()
    {
        a = (byte)data.ReadByte(),
        b = (byte)data.ReadByte(),
        c = (byte)data.ReadByte(),
        d = (byte)data.ReadByte()
    };
    string result = null;
    if (union.data != -1)
    {
        char[] finalChars = new char[union.data];
        reader.Read(finalChars, 0, union.data);
        result = new string(finalChars);
    }
    return result;
}

//Convenience method, not needed:

string DecodeString(byte[] data, Encoding encoding)
{
    //TODO: You may want to validate that data and encoding are not null
    //or make this private
    return DecodeString(new StreamReader(new MemoryStream(data), encoding));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:33:25.327

`MarshalAs`在您的结构中，用适当的属性标记您的字符串（ [MSDN 参考](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx)）：

```
[Serializable]
public struct newLeads
{
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 5000)]
    public string id;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 5000)]
    public string first_name;
    [MarshalAs(UnmanagedType.ByValTStr, SizeConst = 5000)]
    public string last_name;
} 
```

确保该`SizeConst`值足够大，可以覆盖您将要使用的最大数据长度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T01:48:47.510

看起来您可以将您的方法标记为`SecurityCritical`

[http://msdn.microsoft.com/en-us/library/bb264475.aspx](http://msdn.microsoft.com/en-us/library/bb264475.aspx)

# javascript - 在 jQuery 的 Deferred 对象中引发错误

> ID：10843297
> 
> 赞同：13
> 
> 时间：2012-06-01T01:21:53.757
> 
> 标签：javascript, error-handling, jquery-deferred, promise

我有一个[`$.ajax`](http://api.jquery.com/jQuery.ajax/)承诺，想检查我的（语法上有效的）响应是否包含错误，在这种情况下触发拒绝状态。

我使用过我自己的 Promise 库，它可以轻松处理此类任务。我不太喜欢 jQuery 的[Promise](http://wiki.commonjs.org/wiki/Promises/A) ( [cache](http://webcache.googleusercontent.com/search?q=cache:wiki.commonjs.org/wiki/Promises/A) ) 实现及其[`Deferred`对象](http://api.jquery.com/category/deferred-object/)，并且可能忽略了一些东西，因为我很少使用它。我认为要走的路就是使用[`.then()`](http://api.jquery.com/deferred.then/)，这似乎相当复杂：

```
return $.ajax(...).then(function success(response) {
    var problem = hasError(response);
    if (problem) {
        var error = new $.Deferred;
        error.reject(problem);
        return error;
    } else
        return response;
}); 
```

这应该返回一个在网络错误或响应出现问题的情况下被拒绝的承诺。但是返回被拒绝的延迟真的是[唯一|最佳|最短]的方法吗？

我也会就如何在 ajax 选项本身中处理此类“错误抛出响应处理程序”提供帮助，但我找不到关于它们的良好文档。

* * *

免责声明：不，我无法更改服务器响应。问题检测方法是同步的。我不想使用其他库，我对 jQuery 解决这个问题的方式特别感兴趣。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-06-01T01:35:35.437

**现在更新为 jQuery 1.8+**

解决这个问题的最简单方法是根据数据的成功或失败运行过滤器`$.ajax`的响应。`.then`

```
$.ajax()
    .then(function (response) {
        return $.Deferred(function (deferred) {
            var problem = hasError(response);

            if (problem) {
                return deferred.reject(problem)
            }

            deferred.resolve(response);
        }).promise();
    }); 
```

然后，您可以将此新承诺返回给任何调用代码将使用它：

```
var request = function () {
    return $.ajax()
        .then(function (response) {
            return $.Deferred(function (deferred) {
                var problem = hasError(response);

                if (problem) {
                    return deferred.reject(problem)
                }

                deferred.resolve(response);
            }).promise();
        });
};

request()
    .done(function (response) {
        // handle success
    })
    .fail(function (problem) {
        // handle failure
    }); 
```

# jquery - 如何使用 jQuery 淡入/淡出五个 CSS 背景图像

> ID：10843299
> 
> 赞同：0
> 
> 时间：2012-06-01T01:22:21.020
> 
> 标签：jquery, css, image, background, rotation

我目前正在使用它，它会旋转到下一个图像并重复 1-5

```
jQuery( function( $ ) {
    var images = [ "redesign/slides/Big_1.jpg", "redesign/slides/Big_2.jpg", "redesign/slides/Big_3.jpg", "redesign/slides/Big_4.jpg", "redesign/slides/Big_5.jpg"  ];
    var currentImage = 0;

    function changeBackground() {
        $( '#body_container' ).css( { backgroundImage: 'url(' + images[ ++currentImage ] + ')' } );
        if ( currentImage >= images.length - 1 ) {
            currentImage -= images.length;
        }
    }
    setInterval( changeBackground, 2000 );  
}); 
```

但是如何让图像淡入/淡出到下一张图像？

您可以在此处查看完整的主页： [http ://www.arcolacovenant.org/redesign_index](http://www.arcolacovenant.org/redesign_index)

另外，当显示图像时，如何使每个图像可链接到不同的页面？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T01:35:11.733

如果您想要滑块，请使用滑块。字面上有成千上万。[尼沃](http://nivo.dev7studios.com/)

如果你真的想自己做一个，只是为了学习如何，甚至有成千上万的教程。有很多关于如何制作滑块[的文章，所有文章都有综述文章](http://naldzgraphics.net/tutorials/25-must-learn-slider-tutorials-with-jquery/)。

# javascript - 检测使用 javascript 动态分配的 css 样式/属性

> ID：10843300
> 
> 赞同：1
> 
> 时间：2012-06-01T01:22:29.847
> 
> 标签：javascript, css, dynamic

我正在使用 Jquery Cycle 插件进行幻灯片放映，并且我想在某个幻灯片处于活动状态时添加一个事件。Cycle 插件通过在某个 div 中添加和删除图像的不透明度来实现这一点，如下所示：

```
<div style="position: absolute; top: 0px; z-index: 9; display: none; opacity: 0;"> 
```

当图像处于活动状态或当前幻灯片时，不透明度变为 1，显示变为“块”。

现在我尝试使用不同的方法，从检测 div 的 css 样式/属性到为所述 div 分配一个类，然后做一些事情：

```
if($("#slideshow > div:nth-child(2)").hasClass('fadeOut') == 1) {
    alert('Hello');
} 
```

或者

```
if($("#slideshow > div:nth-child(2)").css('opacity') == 1) {
    alert('Hello');
} 
```

乃至

```
if($(".fadeOut").css('opacity') == 1) {
    alert('Hello');
} 
```

问题是当使用 Cycle 插件动态应用时，JS 没有检测到“opacity: 1”样式。另一方面，当在css文件中内联应用样式时，它确实有效，当然，这不起作用，因为事件在页面加载的那一刻触发，我想要的是事件在何时触发并且仅当第二张图像是活动图像时，换句话说，当它的“不透明度”设置为 1 或“显示”设置为阻止时，似乎无法弄清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T01:47:58.007

像这样的东西对你有用吗？

html

```
<p></p>
<div class="slideshow">
    <img id="1" src="http://davealger.info/i/1.jpg" />
    <img id="2" src="http://davealger.info/i/2.bmp" />
    <img id="3" src="http://davealger.info/i/3.png" />
</div> 
```

css

```
.slideshow { position:relative; }
.slideshow img { position:absolute; left:0; top:0; }​ 
```

js

```
$(function(){
    $('.slideshow img:gt(0)').hide();
    setInterval(function(){
        var me=$('.slideshow :first-child');

        if ( me.attr('id') === '1' )
            $("p:last").html('getting ready to load slide 2');
        else
            $("p:last").html('');

        me.fadeOut(2000).next('img').fadeIn(2000).end().appendTo('.slideshow');
    }, 4000);
});​ 
```

下面的演示链接

[http://jsfiddle.net/DaveAlger/CWkYt/](http://jsfiddle.net/DaveAlger/CWkYt/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:29:24.830

您应该能够使用所有方法确定元素的当前状态。我想问题是在正确的时间查找它们。

只是：您无法检测到样式属性或类属性何时更改。捕捉它的唯一方法是监听[DOMModification 事件](https://stackoverflow.com/q/4561845/1048572)——一种相当丑陋的方式。

所以：使用另一个插件。将有幻灯片插件在更改图像时触发元素上的 [自定义] 事件。

# facebook - Facebook Graph - 获取我的照片

> ID：10843302
> 
> 赞同：1
> 
> 时间：2012-06-01T01:22:35.040
> 
> 标签：facebook, facebook-graph-api

我正在寻找最快的方法来获取我与特定人一起标记的所有照片。

至于现在我需要检查“我的照片”，然后是“其他人的照片”，然后是我所有朋友的相册中的照片。

它需要永远。

我需要一种方法（我想这是一个 FQL 请求）来获取我和特定朋友一起标记的**所有照片？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:17:46.500

使用FQL 查询轻松获取**一些照片：**

```
SELECT object_id, src, owner, caption, created 
     FROM photo 
     WHERE object_id IN (SELECT object_id FROM photo_tag WHERE subject = me())
       AND object_id IN (SELECT object_id FROM photo_tag WHERE subject = 'MY_FRIENDS_ID') 
```

（在本例`MY_FRIENDS_ID`中也可以是事件 ID 或组 ID）

Facebook 对 FQL 查询返回的对象数量有限制。要获取所有项目，您必须编写一个附加`AND created < {OLDEST_DATE_RETURNED_BY_LAST_QUERY}`到 FQL 的脚本并重复查询，直到没有数据返回。

在此处对您标记的照片进行演示查询：[https ://developers.facebook.com/tools/explorer?method=GET&path=fql%3Fq%3DSELECT%20object_id%2C%20src%2C%20owner%2C%20caption%2C% 20created%20FROM%20photo%20WHERE%20object_id%20IN%20(SELECT%20object_id%20FROM%20photo_tag%20WHERE%20subject%20%3D%20me())](https://developers.facebook.com/tools/explorer?method=GET&path=fql%3Fq%3DSELECT%20object_id%2C%20src%2C%20owner%2C%20caption%2C%20created%20FROM%20photo%20WHERE%20object_id%20IN%20(SELECT%20object_id%20FROM%20photo_tag%20WHERE%20subject%20%3D%20me()))

# c# - c# winForm为texbox中的数字添加值

> ID：10843303
> 
> 赞同：3
> 
> 时间：2012-06-01T01:22:43.000
> 
> 标签：c#, winforms, button, textbox

在我的程序中，我有几个带有对应名称的 texbox 和按钮（例如 TextBox1 - buttonPlus1），如图所示

![在此处输入图像描述](../Images/d4f514c5d0465c9015639e0c226f6c75.png)

但是里面充满了从文本文件中加载的数字。我想编写允许我按下按钮 + 并从文本框中放大（添加固定数字，例如 100）值的函数。到目前为止，我已经完成了：

```
 private void buttonPlus1_Click(object sender, EventArgs e)
    {
        AddValue(sender,e);
    }

    private void AddValue(object sender, EventArgs e)
    {
        if (!(sender is Button))
            return;

        string controlName = (sender as Button).Name;
        string textBoxName = controlName.Replace("buttonPlus", "textBox");

        TextBox textBox = this.Controls.Find(textBoxName, false)[0] as TextBox;
        int step = 100;

    } 
```

但我不知道如何从 textBox 中获取值（作为数字）并添加该步骤。有人能帮帮我吗？我试图以多种不同的方式自己解决它，但它不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T01:27:02.813

获取值：

```
Convert.ToInt32(textBox.Text) 
```

将它保存到一个变量中，加 100 并像往常一样设置它。

PS你也可以使用`Int32.Parse("")`

```
textBox.Text = Convert.ToInt32(textBox.Text) + 100; 
```

（你可能需要`.ToString()`它）

编辑：正如 ltiong_sh 提到的，你应该使用 TryParse 而不是 Parse：

```
int somevalue;
if(Int32.TryParse(textBox.Text, out somevalue))
{
    textBox.Text = somevalue + 100;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-08T00:40:32.813

在按钮中单击获取文本框值并将其转换为整数格式并添加 100。之后将文本框值重置为修改后的值。这是你需要的。

```
private void buttonPlus1_Click(object sender, EventArgs e)
{
   try
   {
       int txtValue = Convert.ToInt32(textBox.Text) + 100;
       textBox.Text = txtValue.ToString();
   }
   catch(Exception ex)
   {
     MessageBox.Show(ex.Message.ToString());
   }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T01:36:33.847

确保验证文本字段中的文本。否则在解析时会抛出异常。

你可以这样做

```
int value = 0;
if(Int32.TryParse(textBox.Text, out value))
{
   value += step;
   textBox.Text = value.ToString();
}
else
{
   //inform user to enter int
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T01:26:51.850

这就是您要查找的内容：

```
int newValue = Convert.ToInt32(textBox.Text) + step; 
```

要将值放回文本框中，您可以执行以下操作：

```
textBox.Text = newValue.ToString(); 
```

**编辑：**

正如其他人所提到的，您应该使用 Int32.TryParse 来防止引发错误。

```
if(Int32.TryParse(textBox.Text, out newValue))
{
    newValue += step;
    textBox.Text = newValue.ToString();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-06-01T01:28:50.200

您需要***将字符串转换为整数***

```
int txtValue = Convert.ToInt32(textBox.Text) + 100; 
```

# c++ - pthread_once() 中的竞争条件？

> ID：10843304
> 
> 赞同：15
> 
> 时间：2012-06-01T01:22:53.930
> 
> 标签：c++, c++11, pthreads, future, promise

我有`std::future`一个线程正在等待`std::promise`在另一个线程中设置。

**编辑：** *用一个将永远阻塞的示例应用程序更新了问题：*

**更新：**如果我改用 a `pthread_barrier`，下面的代码不会**阻塞**。

我创建了一个测试应用程序来说明这一点：

基本上类`foo`创建一个在它的运行函数`thread`中设置一个`promise`，并在构造函数中等待它`promise`被设置。一旦设置，它会增加一个`atomic`计数

然后我创建了一堆这样的`foo`对象，把它们拆掉，然后检查我的`count`.

```
#include <iostream>
#include <thread>
#include <atomic>
#include <future>
#include <list>
#include <unistd.h>

struct foo
{
    foo(std::atomic<int>& count)
        : _stop(false)
    {
        std::promise<void> p;
        std::future <void> f = p.get_future();

        _thread = std::move(std::thread(std::bind(&foo::run, this, std::ref(p))));

        // block caller until my thread has started 
        f.wait();

        ++count; // my thread has started, increment the count
    }
    void run(std::promise<void>& p)
    {
        p.set_value(); // thread has started, wake up the future

        while (!_stop)
            sleep(1);
    }
    std::thread _thread;
    bool _stop;
};

int main(int argc, char* argv[])
{
    if (argc != 2)
    {
        std::cerr << "usage: " << argv[0] << " num_threads" << std::endl;
        return 1;
    }
    int num_threads = atoi(argv[1]);
    std::list<foo*> threads;
    std::atomic<int> count(0); // count will be inc'd once per thread

    std::cout << "creating threads" << std::endl;
    for (int i = 0; i < num_threads; ++i)
        threads.push_back(new foo(count));

    std::cout << "stopping threads" << std::endl;
    for (auto f : threads)
        f->_stop = true;

    std::cout << "joining threads" << std::endl;
    for (auto f : threads)
    {
        if (f->_thread.joinable())
            f->_thread.join();
    }

    std::cout << "count=" << count << (num_threads == count ? " pass" : " fail!") << std::endl;
    return (num_threads == count);
} 
```

如果我在一个有 1000 个线程的循环中运行它，它只需要执行几次，直到发生竞争并且其中一个`futures`永远不会被唤醒，因此应用程序会永远卡住。

```
# this loop never completes
$ for i in {1..1000}; do ./a.out 1000; done 
```

如果我现在`SIGABRT`使用该应用程序，则生成的堆栈跟踪显示它卡在`future::wait` 堆栈跟踪如下：

```
// main thread
    pthread_cond_wait@@GLIBC_2.3.2 () from /lib64/libpthread.so.0
    __gthread_cond_wait (__mutex=<optimized out>, __cond=<optimized out>) at libstdc++-v3/include/x86_64-unknown-linux-gnu/bits/gthr-default.h:846
    std::condition_variable::wait (this=<optimized out>, __lock=...) at ../../../../libstdc++-v3/src/condition_variable.cc:56
    std::condition_variable::wait<std::__future_base::_State_base::wait()::{lambda()#1}>(std::unique_lock<std::mutex>&, std::__future_base::_State_base::wait()::{lambda()#1}) (this=0x93a050, __lock=..., __p=...) at include/c++/4.7.0/condition_variable:93
    std::__future_base::_State_base::wait (this=0x93a018) at include/c++/4.7.0/future:331
    std::__basic_future<void>::wait (this=0x7fff32587870) at include/c++/4.7.0/future:576
    foo::foo (this=0x938320, count=...) at main.cpp:18
    main (argc=2, argv=0x7fff32587aa8) at main.cpp:52

// foo thread
    pthread_once () from /lib64/libpthread.so.0
    __gthread_once (__once=0x93a084, __func=0x4378a0 <__once_proxy@plt>) at gthr-default.h:718
    std::call_once<void (std::__future_base::_State_base::*)(std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()>&, bool&), std::__future_base::_State_base* const, std::reference_wrapper<std::function<std::unique_ptr<std::__future_base::_Result_base, std::__future_base::_Result_base::_Deleter> ()> >, std::reference_wrapper<bool> >(std::once_flag&, void (std::__future_base::_State_base::*&&)(std::function<std::unique_ptr<std::__future_base::_Result_base, ...) at include/c++/4.7.0/mutex:819
    std::promise<void>::set_value (this=0x7fff32587880) at include/c++/4.7.0/future:1206
    foo::run (this=0x938320, p=...) at main.cpp:26 
```

我很确定我的代码没有做错任何事情，对吧？

这是 pthread 实现还是 std::future/std::promise 实现的问题？

我的图书馆版本是：

```
libstdc++.so.6
libc.so.6 (GNU C Library stable release version 2.11.1 (20100118))
libpthread.so.0 (Native POSIX Threads Library by Ulrich Drepper et al Copyright (C) 2006) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-07-12T08:57:48.463

`promise`确实，本地对象的析构函数（在构造函数的末尾和从线程的调用之间）存在竞争条件`set_value()`。也就是说，`set_value()`唤醒主线程，接下来会销毁 promise 对象，但`set_value()`函数没有尚未完成，并且死锁。

阅读 C++11 标准，我不确定是否允许您使用：

> `void promise<void>::set_value();`
> 
> 效果：以原子方式将值 r 存储在共享状态中并使该状态准备就绪。

但在其他地方：

> set_value、set_exception、set_value_at_thread_exit 和 set_exception_at_thread_exit 成员函数的行为就像它们在更新 Promise 对象时获取与 Promise 对象关联的**单个互斥锁。**

`set_value()`对于其他函数，例如析构函数，调用是否应该是原子的？

恕我直言，我会说不。效果相当于在其他线程仍在锁定互斥锁时销毁互斥锁​​。结果未定义。

解决方案是使`p`线程寿命更长。我能想到的两个解决方案：

1.  `p`正如迈克尔伯尔在另一个答案中建议的那样，成为班级成员。

2.  将承诺移动到线程中。

在构造函数中：

```
std::promise<void> p;
std::future <void> f = p.get_future();
_thread = std::thread(&foo::run, this, std::move(p)); 
```

顺便说一句，您不需要调用`bind`, （线程构造函数已经重载）或调用来`std::move`移动线程（正确的值已经是 r 值）。但是，对承诺的调用`std::move`是强制性的。

并且线程函数没有收到引用，而是收到了移动的承诺：

```
void run(std::promise<void> p)
{
    p.set_value();
} 
```

我认为这正是 C++11 定义两个不同类的原因：`promise`和`future`: 你将 promise 移动到线程中，但你保留 future 来恢复结果。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-07-12T07:37:04.930

尝试移动，`std::promise<void> p;`以便它不是构造函数的本地成员，而是`struct foo`：

```
struct foo
{
    foo(std::atomic<int>& count)
        : _stop(false)
    {
        // std::promise<void> p;    // <-- moved to be a member
        std::future <void> f = p.get_future();

        // ...same as before...
    }
    void run(std::promise<void>& p)
    {
        // ... same ...
    }

    std::promise<void> p;   // <---
    std::thread _thread;
    bool _stop;
}; 
```

我相信可能发生的事情是你进入了一场比赛，`p`在构造函数中被破坏，同时`p.set_value()`对那个的引用起作用`promise`。`set_value()`在完成/清理时内部发生了一些事情；对已销毁的引用进行操作正在破坏库`std::promise`中的某些状态`pthread`。

这只是猜测 - 我目前无法访问重现问题的系统。但是创建`p`一个成员将确保它的生命周期远远超过`set_value()`调用完成。

# c# - Richtextbox 行限制问题

> ID：10843305
> 
> 赞同：0
> 
> 时间：2012-06-01T01:23:07.600
> 
> 标签：c#, asp.net, .net, vb.net

根据`RichTextBox_TextChanged`事件，我有

```
 if RichTextBox.Lines.Count() > 2
   {
      //Message Box to display the user that you are typing more than 2 lines
    } 
```

所以我发生的是当我有这些数据时

```
 [0] - "East coast road"
 [1]- "New York" 
```

富文本框，当我单击 Enter 时，似乎进入了这种状态

```
 [0] - "East coast road"
   [1]- "New York"
   [2] -"" 
```

我收到消息弹出框说不能超过 2 行，但是最后一行只是一个空行？

> 我如何处理富文本框中的行限制，或者如何确保当用户单击输入时我不会移动到下一行，并且只有在富文本框中有 1 行时才移动到下一行？

这将返回计数为 3，其中应该只有 2，我如何消除下一行的空白？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T01:56:56.853

您已经对可用的标签进行了枪击。但这应该让你知道如何去做。该[`KeyDown`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.keydown.aspx)事件发生在 TextChanged 事件之前。所以我会拦截击键，检查 Enter 键，如果行数为 2 或更大，我会处理它。像这样的 C# winforms 示例：

```
private void richTextBox1_KeyDown(object sender, KeyEventArgs e)
{
    if (e.KeyCode == Keys.Enter && richTextBox1.Lines.Length >= 2)
        e.Handled = true;
} 
```

* * *

回答您关于[`Handled`](http://msdn.microsoft.com/en-us/library/system.windows.forms.keyeventargs.handled.aspx)物业的问题。

来自链接：

> Windows 窗体中的不同控件以不同方式实现处理。对于像 TextBox 这样的子类本机 Win32 控件的控件，它被解释为意味着不应将关键消息传递给底层本机控件。如果在 TextBox 上将 Handled 设置为 true，则该控件不会将按键事件传递给底层 Win32 文本框控件，但仍会显示用户键入的字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:50:59.007

试试这个

```
String[] myLines = RichTextBox.Text.Split("\n".ToCharArray(), StringSplitOptions.RemoveEmptyEntries) 
```

这将用换行符分割你的文本并删除所有空格，需要注意的是，它不仅会删除最后一个空行，还会删除中间的任何空行

或者你可以使用这个方法

```
int lCount = RichTextBox.Lines.Count();
if(String.IsNullOrEmpty(RichTextBox.Lines[lCount-1]))
    lCount--;

if lCount > 2
{
  //Message Box to display the user that you are typing more than 2 lines
} 
```

# ruby-on-rails - 为什么 Bundler 无法获取 gem 元数据？

> ID：10843308
> 
> 赞同：3
> 
> 时间：2012-06-01T01:23:23.060
> 
> 标签：ruby-on-rails, gem, bundler, fedora

对rails非常陌生。我设法在*Fedora 17上安装了**ruby*​​ 和*rails 框架*。

 *以下是我安装 ruby​​ 和 rails 框架的步骤摘要：

1.  `yum install make openssh-clients gcc libxml2 libxml2-devel libxslt libxslt-devel python-devel`

2.  `sudo bash -s stable < <(curl -sk https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer)`

3.  `source /etc/profile.d/rvm.sh`

4.  `rvm install ruby-1.9.2-p290 --with-openssl`

5.  `rvm use ruby-1.9.2-p290 --default`

6.  `rvm all do gem update --system`

7.  `rvm all do gem install rails`

嗯..到目前为止一切顺利..只是想测试安装是否完美。我创建了一个 hello world 示例（*test.rb*）来测试 ruby​​ 安装

```
#!/usr/bin/env ruby

puts "hello World" 
```

并用它运行`./test.rb`它工作正常。

现在，当我通过使用创建一个新项目来测试 Rails 框架安装时

```
rails new demo 
```

我收到错误

```
Fetching gem metadata from https://rubygems.org/.Unfortunately, a fatal error has occurred. Please see the Bundler
troubleshooting documentation at http://bit.ly/bundler-issues. Thanks! 
```

我在这里想念什么？或者我还做了什么我不应该做的事情？查看了[https://github.com/carlhuda/bundler/blob/master/ISSUES.md](https://github.com/carlhuda/bundler/blob/master/ISSUES.md)。想不通。有没有人遇到过类似的问题并找到了解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T02:19:56.840

仔细检查您是否安装了这些软件包...

`git-core curl make bzip2 gcc-c++ patch readline readline-devel zlib zlib-devel libyaml-devel libffi-devel libxslt-devel sqlite sqlite-devel openssl openssl-devel`

您可能想查看此博客[文章](http://jaysonrowe.blogspot.com/2012/04/installing-ruby-and-rails-on-fedora.html)，看看它是否对您有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T20:14:24.350

您是否有机会使用 Xcode 4.1？似乎很多人在升级到 Lion 后遇到了捆绑程序问题（但也忽略了升级 Xcode ......）。

正如在这个[线程](https://stackoverflow.com/questions/6753000/nokogiri-error-failed-to-build-gem-native-extension)中。*

# redis - ServiceStack Redis 客户端中带有验证的事务性创建

> ID：10843311
> 
> 赞同：2
> 
> 时间：2012-06-01T01:23:38.523
> 
> 标签：redis, servicestack

用户具有 DisplayName，并且对于用户来说是唯一的。

我想创建用户，但首先我必须检查显示名称（不能为用户复制显示名称）

我检查了 ServiceStack 示例，但看不到带有验证检查的事务性插入/更新。

我该如何执行它。我不想为 redis db 编写“验证任务”。我不希望数据库中的不一致。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T01:54:45.120

可以执行redis事务。更多信息[在这里](http://redis.io/topics/transactions)

```
WATCH mykey
test = EXIST mykey
MULTI
SET mykey $val
EXEC 
```

使用 PHP 有更好的例子：[这里](https://stackoverflow.com/questions/7291333/calling-redis-get-inside-a-loop-to-display-forum-post-view-data)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T04:52:21.420

[ServiceStack.Redis](https://github.com/ServiceStack/ServiceStack.Redis/)客户端确实支持 Redis 的[WATCH](http://redis.io/commands/watch)和这些 Redis 命令的[事务：](http://redis.io/topics/transactions)

```
WATCH mykey
test = EXIST mykey
MULTI
SET mykey $val
EXEC 
```

可以通过以下方式完成：

```
var redis = new RedisClient();
redis.Watch("mykey");
if (!redis.ContainsKey("mykey")) return;

using (var trans = redis.CreateTransaction()) {
    trans.QueueCommand(r => r.Set("mykey", "val"));
    trans.Commit();
} 
```

# php - mysql_fetch_assoc($查询)

> ID：10843312
> 
> 赞同：-1
> 
> 时间：2012-06-01T01:23:59.600
> 
> 标签：php, mysql

我目前在使用时遇到此错误`mysql_fetch_assoc($query);`

```
Warning: mysql_fetch_assoc(): supplied argument is not a valid MySQL result resource in /home/a6461923/public_html/index.html on line 111 
```

这是我的查询：

```
$query = mysql_query("SELECT * FROM users WHERE email='$email' AND password='$encripted_password'"); 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T01:30:18.183

> 我的查询不起作用……</p>

问这个问题之前的步骤（再次）：

1.  验证您与数据库的连接。
2.  确保您的查询没有错误。

您可以通过以下方式做到这一点：

*   **使用代码中使用的相同凭据**连接到 PHP 之外的数据库。
*   输出您的查询 ( `echo $query;`) 然后直接针对数据库运行它（例如通过 PHPMyAdmin 或 mysql CLI）：
*   在您的代码中使用[`mysqli_error()`](http://php.net/manual/en/mysqli.error.php)和之类的函数。[`mysqli_num_rows()`](http://php.net/mysqli_num_rows)

关于常见 PHP/MySQL 编程的一些额外提示：

*   阅读[SQL 注入](http://php.net/manual/en/security.database.sql-injection.php)。
*   熟悉何时在 MySQL中转义和引用[文字值。](http://dev.mysql.com/doc/refman/5.0/en/literals.html)
*   请注意不要过早关闭 MySQL 连接。PHP 实际上会在脚本结束时自动执行此操作。
*   正如**Jared**所评论的，您应该使用[MySQLi](http://php.net/manual/en/book.mysqli.php)或[PDO](http://php.net/manual/en/book.pdo.php)，而不是[现在已弃用](http://news.php.net/php.internals/53799)的MySQL 扩展。
*   还要查看[Prepared Statements](http://php.net/manual/en/mysqli.prepare.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:35:40.987

这可能意味着查询`mysql_query()`出错了。PHP 说错误是`mysql_fetch_assoc()`因为它试图读取查询的结果。如果结果不是有效的结果集，则会引发警告。

`die($query);`在构建字符串之后尝试类似的`$query`操作以查看是否有任何问题（缺少变量，每个人都会发生一次）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T01:27:27.003

我相信您需要运行以下内容：

```
$result = mysql_query($query);
$row = mysql_fetch_assoc($result); 
```

有关更完整的示例，请参阅[此链接。](http://php.net/manual/en/function.mysql-fetch-assoc.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T01:28:09.920

请阅读手册。`mysql_fetch_assoc`不接受字符串参数。它需要您通过将查询传递给`mysql_query`.

[http://jp2.php.net/manual/en/function.mysql-query.php](http://jp2.php.net/manual/en/function.mysql-query.php)

[http://php.net/manual/en/function.mysql-fetch-assoc.php](http://php.net/manual/en/function.mysql-fetch-assoc.php)

# c# - 是否可以在程序中以任何形式访问 bool/string/int/etc？

> ID：10843313
> 
> 赞同：1
> 
> 时间：2012-06-01T01:24:35.310
> 
> 标签：c#, variables

我对全局变量进行了一些研究，并提出静态变量应该能够解决我的问题的事实。不过，我不明白如何制作这些。我该怎么做？另外，如果静态变量不能解决我的问题，我应该使用什么？

我希望能够从另一个表单访问我的主要表单中的字符串、bool 和 int。帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T01:30:21.557

静态变量（或者更好的是，属性）可能会起作用。您可以将其声明为：

```
// In Form1 (could be internal or public)
public static bool SomeBool { get; set; } 
```

然后，要访问，您将使用`Form1.SomeBool = true;`or`if (Form1.SomeBool) {`等​​。

话虽如此，不鼓励这样的“全局”数据是有原因的——通常有一些更好的方法来处理这个问题。例如，您可能希望创建一个自定义类来保存您的数据，并在创建新表单时将对该类实例的引用传递给新表单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:30:05.233

不仅是静态的，它必须是`public static`. 您可以像任何其他变量一样简单地声明它，如`public static int x = 1;`. 然后您可以像 一样访问它`ClassFoo.x`，但您也必须处于静态上下文中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T01:36:25.913

如果您希望每个表单实例（对象）保存此信息，那么您不想使用静态字段。另一方面，如果您想要获得一些可以从您的班级形式的任何实例（它是共享的）访问的信息，或者换句话说，您只想拥有这些信息一次......那么是的，使用静态字段。

你想要做的是这样的：

```
//partial because I take you are using a form designer.
//and also because the class is gonna have more things than those showed here.
//in particular the example call a method "UseFields" that I did not define.
public partial class MyForm: form
{
    private static bool boolField;
    private static string stringField;
    private static int intField;

    private void Method()
    {
         //Do something with the fields
         UseFields(boolField, stringField, intField);
         UseFields(IsBoolFieldSet, SomeString, SharedInformation.SomeInt);
    }

    //You can also wrap them in a property:
    public static bool IsBoolFieldSet
    {
        get
        {
            return boolField;
        }
        //Don't put a set if you want it to be read only
        set
        {
            return boolField;
        }
    }

    //Or declare an static property like so:
    public static string SomeString { get; set; }
}

//Another good option is to have this information in a separate class
public class SharedInformation
{
    public static int SomeInt { get; set; }        
} 
```

Please take care with shared state, in particular in a multithreaded enviroment, because this information may be changed without notice by another object that also has access.

# eclipse - 关于 Eclipse 自动完成的可用性问题

> ID：10843320
> 
> 赞同：0
> 
> 时间：2012-06-01T01:26:15.643
> 
> 标签：eclipse, netbeans, usability

最近，我需要使用 Eclipse 而不是 Netbeans。

我发现以下问题对我来说很烦人。说，我输入了以下错误的方法名称。

![在此处输入图像描述](../Images/88d23b55680622790f659aa7023e04f0.png)

所以，我倾向于通过删除错误的方法名称（但不是参数，因为我知道我想传递`true`）来修复错误，包括点。我再次键入点，Eclipse 自动完成将提示我方法列表

![在此处输入图像描述](../Images/8138cfa240a85694e40dbdfd71ca89c0.png)

我对这个建议很满意。我按 ENTER。然而，这就是我得到的。

![在此处输入图像描述](../Images/fda6b21cff191cc71165fe3e9b122467.png)

现在，我需要手动删除 uselesss **(checked)**。这很烦人，尤其是当该方法接受 4 到 5 个参数时。我必须一个一个地删除它们。

我认为这是一个可用性缺陷。我在 Netbeans 中没有这样的问题。你们中的任何人都知道解决此可用性问题的任何解决方法吗？有什么可以打开或关闭的选项吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-03T19:07:25.530

您也可以按 Ctrl+Enter 插入补全，这将“替换”错误键入的单词。

[在http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.jdt.doc.user/tips/jdt_tips.html](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.jdt.doc.user/tips/jdt_tips.html)中查找“在插入和替换内容辅助之间切换”

# webgl - WebGL 着色器输出是否应该针对伽玛进行调整？

> ID：10843321
> 
> 赞同：10
> 
> 时间：2012-06-01T01:26:23.240
> 
> 标签：webgl, color-space, gamma

WebGL 片段着色器是否应该输出`gl_FragColor`线性的 RGB 值，或者输出¹ ⁄<sub> *γ*功率以校正显示伽马？如果是后者，是否有要使用的特定值或必须可配置完整的应用程序？

[WebGL 规范](http://www.khronos.org/registry/webgl/specs/latest/)目前不包含“gamma”、“γ”或“linear”的相关用法，并且`GL_ARB_framebuffer_sRGB`扩展[在 WebGL 中不可用](http://www.khronos.org/registry/webgl/extensions/)。还有其他适用的规范吗？如果未指定，当前的实现会做什么？一个来源良好的答案将不胜感激。

（假设我们已成功加载或程序生成线性颜色值；也就是说，纹理图像的伽马不存在问题。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-07-02T20:47:28.083

这是一个艰难的问题，但从我能够挖掘的内容（主要来自[这个电子邮件线程](https://www.khronos.org/webgl/public-mailing-list/archives/1009/msg00000.html)）看来，当前的行为似乎是在加载线性色彩空间图像（例如 PNG）时对其进行伽玛校正。JPEG 之类的内容无需任何形式的转换即可加载，因为它们已经经过伽马校正。（来源：[https](https://www.khronos.org/webgl/public-mailing-list/archives/1009/msg00013.html) ://www.khronos.org/webgl/public-mailing-list/archives/1009/msg00013.html ）这表明纹理可能会在非线性空间中传递给WebGL，这将是有问题的。我不确定自 2010 年底以来情况是否发生了变化。

[在该线程](https://www.khronos.org/webgl/public-mailing-list/archives/1009/msg00018.html)的其他地方，非常清楚的是，所需的行为应该是从 WebGL 输入和输出的所有内容都应该在线性颜色空间中。除此之外发生的事情超出了 WebGL 规范的范围（这就是它对这个问题保持沉默的原因）。

抱歉，如果这不能权威地回答你的问题，我只是在挖掘我能做的事情。至于您是否应该在着色器中进行校正，我会说答案似乎是“不”，因为 WebGL 输出将被假定为线性的，并且尝试自我校正可能会导致到颜色空间的双重变换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-02T20:57:22.257

[当我在Freenode](http://freenode.net/) #webgl（2012 年 6 月 29 日）上提到这个问题时， [Florian Boesch](http://codeflow.org/)强烈表示几乎所有用户的系统在 gamma 方面都存在无可救药的错误配置，因此获得良好结果的唯一方法是提供 gamma WebGL 应用程序中的选项，即使 WebGL 为帧缓冲区数据指定了颜色空间（无论是线性还是非线性），它也不会为监视器正确转换。

# javascript - 获取 img.src 值（路径名）

> ID：10843322
> 
> 赞同：6
> 
> 时间：2012-06-01T01:26:27.523
> 
> 标签：javascript, html, forms

我有一个注册页面的表格。该表单包含一个图像，该图像会根据情况更改其 src。在提交表单时激活的脚本中，如果该图像具有特定的 src，我希望表单调用警报，因此我需要一种检索和比较值的方法。

HTML：

```
<form action="register_submit.php" method="post" name="mainform" enctype="multipart/form-data" onSubmit="return checkForm(this);return false;"> 
```

JS：

```
 function checkForm(f)
    {if ([image src value] == "pictures/apic.png")
       {
          alert("error picture is apic");
          return false;
       }
     else
       {
          f.submit();
          return false;
       }
    } 
```

这是完整的相关代码：

```
 <script type="text/javascript">
            function checkForm(f)
            {if ([image src value] == "pictures/apic.png")
               {
                  alert("error picture is apic");
                  return false;
               }
             else
               {
                  f.submit();
                  return false;
               }
            }
    </script>

    <form action="register_submit.php" method="post" name="mainform" enctype="multipart/form-data" onSubmit="return checkForm(this);return false;">

    <div class="required">
    <label for="first_name">*First Name:</label>
    <input type="text" name="first_name" id="first_name" class="inputText" onkeyup="checkFName(this.value);" onblur="checkFName(this.value);" maxlength="20" size="10" value="" />
    <img id="FName_Status" name="FName_Status" src="/pictures/bad.png" style="margin-left:5px; position:absolute;" alt="FName_Status" />
    </div>

    (OTHER OBJECTS)
    </form>

<input type="submit"  name="sub" class="inputSubmit" value="Submit &raquo;"/> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-06-01T01:29:42.307

用这个：

```
if (document.getElementById('FName_Status').getAttribute('src') == "pictures/apic.png") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:32:18.587

为您的图像添加一个 ID 标签（如果还没有），例如：

```
<img src="pictures/apic.png" id="imageId" /> 
```

然后您可以按如下方式引用它：

```
if (document.getElementById("imageId").src == "pictures/apic.png")
{
    ...
} 
```

**编辑**

这里的工作示例：http: [//jsfiddle.net/2Wtkn/2/](http://jsfiddle.net/2Wtkn/2/)

# php - 使用 PHP 查看 S3 中是否存在对象

> ID：10843327
> 
> 赞同：45
> 
> 时间：2012-06-01T01:27:39.843
> 
> 标签：php, amazon-s3

我正在使用 PHP，并且正在使用 S3 API 上传文件，但我想确保在上传之前这个确切的文件名不存在于存储桶中。

我在网上找到了一些使用“file_get_contents”的示例，但这是否意味着您必须先下载整个文件？通常，这些文件大约 10 mb，所以理想情况下，我真的不想这样做。

有没有办法在不下载文件的情况下使用“file_get_contents”？

或者更好的是，也许我可以使用 API 请求来查看文件名是否存在？

内容或文件大小是否相同对我来说并不重要，只是文件名。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-09-10T10:51:42.333

获取指定的 Amazon S3 对象是否存在于指定的存储桶中。

[亚马逊S3`doesObjectExist`](http://docs.aws.amazon.com/aws-sdk-php/v3/api/class-Aws.S3.S3ClientInterface.html#_doesObjectExist)

```
$s3 = new AmazonS3();
$bucket = 'my-bucket' . strtolower($s3->key);

$response = $s3->doesObjectExist($bucket, 'test1.txt');

// Success? (Boolean, not a CFResponse object)
var_dump($response); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-12-03T02:33:19.883

尝试使用下面的代码：

```
$s3 = new S3();

$info = $s3->getObjectInfo($bucket, $filename);
if ($info)
{
    echo 'File exists';
}
else
{
    echo 'File does not exists';
} 
```

从亚马逊下载 S3 SDK for php。有一个类叫S3；创建 S3 的对象。该对象将允许调用 getObjectInfo() 方法。传递您的 S3 存储桶名称和文件名（通常文件名称为键）。如果文件存在，getObjectInfo() 方法将返回一些信息，否则该方法将返回 FALSE。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-11-08T17:44:18.883

请注意，其他建议基于适用于 PHP 的 AWS 开发工具包版本 1。对于版本 2，您需要熟悉此处的最新指南：

[http://docs.aws.amazon.com/aws-sdk-php/guide/latest/index.html](http://docs.aws.amazon.com/aws-sdk-php/guide/latest/index.html)

上面链接中的“入门”部分将帮助您安装和设置 SDK，因此如果您还没有这样做，请务必花时间阅读这些文档。完成设置后，您需要熟悉此处的流包装器方法：

[http://docs.aws.amazon.com/aws-sdk-php/guide/latest/feature-s3-stream-wrapper.html](http://docs.aws.amazon.com/aws-sdk-php/guide/latest/feature-s3-stream-wrapper.html)

最后，下面是一个简短的真实示例，说明如何在代码流中使用它。

```
require('vendor/autoload.php');

// your filename
$filename = 'my_file_01.jpg';
// this will use AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY from env vars
$s3 = Aws\S3\S3Client::factory();
// S3_BUCKET must also be defined in env vars
$bucket = getenv('S3_BUCKET')?: die('No "S3_BUCKET" config var in found in env!');
// register stream wrapper method
$s3->registerStreamWrapper();
// does file exist
$keyExists = file_exists("s3://".$bucket."/".$filename);
if ($keyExists) {
    echo 'File exists!';
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-06-01T01:35:22.793

如果您有或有能力安装 PECL 扩展[HTTP](http://www.php.net/manual/en/book.http.php)，那么您可以使用[http_head](http://php.net/manual/en/function.http-head.php)轻松发出 head 请求并检查响应是 200 还是 404。

# javascript - 如何在sqlite中获取最后插入的行ID

> ID：10843332
> 
> 赞同：4
> 
> 时间：2012-06-01T01:28:10.790
> 
> 标签：javascript, sqlite, titanium, appcelerator, rowid

```
function insertToProject(cast, pName)
{
    db.execute('INSERT INTO project (cd, pn) VALUES (?,?)', cast, pName);
        var x = last_insert_rowid();
        return x;
} 
```

我一直在尝试在钛 appcelerator 中使用 javascript。谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-29T11:02:18.853

For this you can use the `lastInsertRowId` property of **database object**.

You can use like:

```
var x = db.lastInsertRowId; 
```

### lastInsertRowId

> `lastInsertRowId` : Number
> 
> The identifier of the last populated row

Please check this link for more details : [Titanium.Database.DB](http://docs.appcelerator.com/titanium/2.1/#!/api/Titanium.Database.DB)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-16T11:27:59.467

你也可以这样做：

```
 db.transaction(function(tx) {
      tx.executeSql("INSERT INTO project (cd, pn) VALUES (?,?)", cast, 
                function(tx, res) {
                    var id = res.insertId;
                });
      }); 
```

因此，获取成功插入的结果，然后获取其属性**insertId**

# php - 这是活动日志的实用概念吗？

> ID：10843334
> 
> 赞同：1
> 
> 时间：2012-06-01T01:28:14.637
> 
> 标签：php, mysql

我想使用一个 InnoDB MySQL 表为我的 PHP 站点创建一个“活动日志”。任何访问该网站的人都会在表中插入一条新记录，该记录将记录...

*   他们的IP地址
*   他们登录的帐户的 ID（如果未登录，则为 null）
*   他们向服务器发出的请求
*   收到请求的日期和时间
*   发送的用户代理，但**前提**是 PHP 脚本确定它是机器人（否则为空）

同时，我可以用桌子来...

*   确定每个页面每年/每月/每天/等收到的点击量
*   确定每年/月/日/等的唯一身份访问者数量
*   **如果可行，**请使用 PHP 脚本即时检索以前的信息，如果我愿意，可以过滤掉机器人请求

对于我想到的下表，我有一些问题（和一些推理）：

```
CREATE TABLE `activity` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `ip` varchar(50) COLLATE utf8_unicode_ci NOT NULL,
  `account` int(11) unsigned DEFAULT NULL,
  `request` varchar(100) COLLATE utf8_unicode_ci NOT NULL,
  `time` time NOT NULL,
  `year` year(4) NOT NULL,
  `month` tinyint(2) unsigned NOT NULL,
  `day` tinyint(2) unsigned NOT NULL,
  `bot` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  PRIMARY KEY (`id`)
) 
```

1.  这种记录方式实用吗？实际意义插入和选择可以在毫秒内执行。我意识到可以通过这种方式生成*大量*记录，但我不完全确定是否有更好的方法来完成我想做的所有事情。

2.  此外，选择“今天”的点击次数并将其放在所服务的每个页面的底部是否可行？我对使用大型数据库还比较陌生，我仍在学习哪些查询会很快，哪些查询会很痛苦。

3.  我应该保留主键吗？我可以使用它返回并随心所欲地编辑我想要的任何行（由于一个重要原因，我真的看不到自己在做什么），但是它会显着减慢我的 INSERT 速度吗？有什么优势吗？同样，出于同样的原因，我不应该再添加任何索引——对吧？包括外键（用于帐户列）？

4.  我捕获当前日期和时间的替代方法实用吗？我首先从一个 DATETIME 列开始这个表，但在某处读到这样的表可能会受益于划分日期信息的列；例如，如果我想计算“今天”的点击次数，我可以将结果限制为...

    ```
    WHERE year="2012" AND month="02" AND day="16" 
    ```

    ……与……相反

    ```
    WHERE date > "2012-02-15 23:59:59" 
    ```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T01:42:05.680

到目前为止，您的日志表似乎是合理的。但是，我肯定会使用只有四个字节的列，而不是`time`列。然后为该列添加索引。`year``month``day``TIMESTAMP`

如果您有范围搜索的查询，您应该获得良好的响应时间。

```
WHERE created >= "2011-01-01 00:00:00"
    AND created < "2012-01-01 00:00:00" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T04:05:45.763

这种日志记录方式很实用，但您可以从使用分区（和子分区）中受益：http: [//dev.mysql.com/doc/refman/5.1/en/partitioning.html](http://dev.mysql.com/doc/refman/5.1/en/partitioning.html)

由于您正在存储活动日志，因此随着时间的推移，您可能会拥有非常大的数据集。分区可能特别有用，因为您想查看特定的月份和年份。

例如，如果日期列的数据类型是 DATE 或 DATETIME，您可以执行以下操作：

```
PARTITION BY RANGE (MONTH(the_date))
(PARTITION p0 VALUES LESS THAN (0),
 PARTITION p1 VALUES LESS THAN (1),
 PARTITION p2 VALUES LESS THAN (2),
...[and so on up to 12]); 
```

这将为您提供每个月数据的分区。使用不同的分区进行测试后，尝试使用“explain partitions select * from...”运行查询，您将能够看到查询是如何执行的以及扫描了哪些分区。分区的最佳方法可能需要围绕您最常见的查询进行定制。例如，您是否主要查看最近 30 天的数据？每月快照？自定义日期范围？这些都可能对分区的结构产生影响。

更进一步，您可以在每个分区中有子分区。为此，可以使用哈希分区：http: [//dev.mysql.com/doc/refman/5.1/en/partitioning-hash.html](http://dev.mysql.com/doc/refman/5.1/en/partitioning-hash.html)

您的主键问题也会受到分区的影响。表中的主键（和任何唯一键）必须使用分区中使用的每一列。

# iphone - iOS：当应用程序崩溃时，如何捕获所有错误数据？

> ID：10843353
> 
> 赞同：4
> 
> 时间：2012-06-01T01:30:13.167
> 
> 标签：iphone, ios, ipad

除了在 main 方法中记录所有 NSExceptions 之外，我还应该在哪里捕获所有错误消息？例如，如果我的应用程序由于访问过度释放的对象而崩溃，我如何获取有关崩溃的所有可用信息并将其写入设备上的本地文件？我知道如何在 XCode 中执行此操作，但需要从非现场 QA 测试人员那里获取此信息。

当这些内存错误发生时，它们似乎并没有被 main 方法捕获。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:55:10.050

真正做好这件事实际上是相当具有挑战性的。您正处于崩溃之中，这意味着系统处于未定义状态。小错误可能导致完全死锁（例如，如果您在堆被锁定时崩溃，然后您尝试分配更多内存）。除非您正在寻找构建和调试它的学习经验，否则您应该重用现有框架。最好的 IMO 是[PLCrashReporter](http://code.google.com/p/plcrashreporter/)，它经过多次迭代才达到当前状态。它甚至可以与[QuincyKit](http://quincykit.net/)很好地集成，以便在您自己的服务器上进行崩溃报告管理（以及几个商业解决方案）。

如果你决定自己写（我有没有提到你不应该？），首先研究 PLCrashReporter 看看他们是如何做到的。如果我有一个最重要的规则，那就是：在崩溃期间尽可能少做，然后在下一次启动期间处理任何复杂的处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:51:49.950

[这篇文章](http://cocoawithlove.com/2010/05/handling-unhandled-exceptions-and.html)中的信息可能会对您有所帮助。基本上，您可以在objective-c中设置一个函数，以便在遇到未处理的异常或信号时调用

看起来像这样：

```
NSSetUncaughtExceptionHandler(&HandleException);
signal(SIGABRT, SignalHandler);
signal(SIGILL, SignalHandler);
signal(SIGSEGV, SignalHandler);
signal(SIGFPE, SignalHandler);
signal(SIGBUS, SignalHandler);
signal(SIGPIPE, SignalHandler); 
```

文章的其余部分将描述如何设置这些方法（HandleException 和 SignalHandler）。

# ember.js - 我应该如何绑定到 Ember 视图中的窗口函数？

> ID：10843362
> 
> 赞同：10
> 
> 时间：2012-06-01T01:31:54.070
> 
> 标签：ember.js

我有一个 mixin，它会在页面调整大小时自动重新计算并设置 div 的高度。

它可以工作，但对我来说绑定到 jQuery 事件并在每次调用时手动触发 Ember 事件似乎很愚蠢。

有没有办法直接在 Ember 中绑定到窗口事件？

我在[这里有一个简化的 JSFiddle](http://jsfiddle.net/kGhrx/1/)

这是代码：

```
App.windowWrapper = Ember.Object.create(Ember.Evented,
  resizeTimer: null
  init: ->
    @_super()
    object = this
    $(window).on 'resize', ->
      window.clearTimeout(object.resizeTimer)
      object.resizeTimer = setTimeout( App.windowWrapper.resize, 100)
      true

  resize: ->
    App.windowWrapper.fire('resize')
) 
```

以及调用它的mixin。

```
App.Scrollable = Ember.Mixin.create
  classNames: "scrollable"
  init: ->
    Ember.assert("Scrollable must be mixed in to a View", this instanceof Ember.View)
    @_super()

  didInsertElement: ->
    @_super()
    @calculateHeight()
    App.windowWrapper.on('resize', this, 'calculateHeight')

  willDestroyElement: ->
    App.windowWrapper.off('resize', this, 'calculateHeight')
    @_super()

  calculateHeight: ->
    offset       = @$().offset().top
    windowHeight = $(window).height()
    @$().css('height', windowHeight - offset) 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-10-19T09:46:27.763

我知道我迟到了几年，但我一直在寻找解决同一问题的方法并发现了这一点：

```
jQuery(window).on('resize', Ember.run.bind(this, this.handleResize)); 
```

（来源：[Ember.js 官方](http://emberjs.com/blog/2014/02/12/ember-1-4-0-and-ember-1-5-0-beta-released.html)）

**** PS关于这个小技巧的实现 - 我不知道是否可以在控制器方法中使用它并在初始化时触发（正如denis.peplin评论的那样），我实际上是在路由中绑定事件“设置控制器”功能。我不知道这是否是最佳实践，但它在我的应用程序中就像一个魅力。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-02T23:22:27.827

使用 jQuery 为类似的事情注册自己的事件处理程序没有任何问题。

Ember 目前没有任何窗口事件处理。

我还建议尝试提出一个不依赖全局变量的解决方案。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-07T06:45:39.103

`Itay Hamashmid`以及答案的示例代码：

```
App.ApplicationController = Ember.Controller.extend({
  handleResize: function() {
    console.log('resized');
  },
  bindResizeEvent: function() {
    jQuery(window).on('resize', Ember.run.bind(this, this.handleResize));
  }.on('init')
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-02T23:16:07.607

我认为 Ember.js 不可能 - 它提供内置 DOM 事件处理的唯一地方是 Ember.View （单击等），也许在其他与视图相关的类中。

我们还对您的解决方案使用了类似的方法来处理此类特殊情况！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-16T16:35:20.490

对于那些通过最新答案搜索或只是摆脱 jquery 的人......

就我而言，我只想知道窗口是否调整为计算元素的宽度。

```
import Component from '@ember/component';

export default Component.extend({
  size: window.innerWidth,

  init() {
    this._super(...arguments);

    window.addEventListener('resize', ()=> this.set('size', window.innerWidth));
  }
}); 
```

是啊，我知道这种匿名函数是没有办法解绑的，但是我搜索了，也没有找到好的答案……

我想重构它以使用 jquery，但在有限的范围内，例如：

```
import Component from '@ember/component';
import $ from 'jquery';

export default Component.extend({
  size: window.innerWidth,

  init() {
    this._super(...arguments);

    $(document.querySelector('#something'))
              .on('resize', (e)=> this.set('size', e.target.innerWidth));
  }
}); 
```

这将监听器将一直存在，直到该组件存在！

# ios - IBAForms：如何创建不可编辑的 IBATextFormField？

> ID：10843365
> 
> 赞同：0
> 
> 时间：2012-06-01T01:32:20.720
> 
> 标签：ios, uitableview

我正在使用 IBAForms 来收集用户输入，在某些情况下某些字段是可编辑的而其他字段是不可编辑的，是否有任何不可变或禁用的 IBAFormField，或任何其他方式来实现这一点？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T22:22:28.503

你可以使用 IBAReadonlyFormField

# jquery - 如何使用 jQuery 使滑块图像占浏览器窗口大小的百分比？

> ID：10843366
> 
> 赞同：0
> 
> 时间：2012-06-01T01:32:33.063
> 
> 标签：jquery, html, css

我已经尝试在这里和许多其他地方搜索以提出解决方案，但似乎还没有找到任何东西。基本上我有一个大约 1800px 宽 x 500px 高的图像。我需要这张图片来适应所有的分辨率。而不是显示为特定的，它需要显示为浏览器窗口大小的百分比。

理想情况下，它占据浏览器窗口宽度的 80%...

关于如何使用 jQuery 完成此任务的任何想法。大多数情况下，它取决于第一次打开时浏览器窗口的大小。如果有人决定缩小浏览器的窗口大小，它不一定要越来越小。

我知道这是一个奇怪的球，所以任何帮助都会非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:02:23.107

你可以在 CSS 中非常有效地做到这一点：

```
#image {
  width: 80%;
  content: url('./pinkfloyd.gif');
} 
```

或者，如果必须在 jQuery 中完成，您可以使用[fullbg](http://bavotasan.com/demos/fullbg/)

# xcode4.3 - “在设备上运行应用程序时，设备无法识别此主机消息”

> ID：10843368
> 
> 赞同：8
> 
> 时间：2012-06-01T01:32:42.260
> 
> 标签：xcode4.3, iphone-3g

> **可能重复：**
> [在 iPad 上运行 Instruments 时出现问题](https://stackoverflow.com/questions/8152739/trouble-running-instruments-on-ipad)

当我尝试从 Xcode 在设备上运行我的应用程序时，我得到一个对话框，显示以下消息：

![在此处输入图像描述](../Images/40dea9d0b12fd106059c31d0c1de6ea9.png)

然后我按下 OK 按钮，应用程序运行正常，但我想知道发生了什么，因为这是我第一次遇到这个问题。

# html - 100% 高度块与垂直文本

> ID：10843380
> 
> 赞同：14
> 
> 时间：2012-06-01T01:36:03.350
> 
> 标签：html, css, css-transforms, vertical-text

我有一个可变高度的块，我想在其中放置另一个具有 100% 高度和垂直文本（从下到上方向）的块并将其堆叠到外部块的左侧。有没有办法通过 CSS 转换但在 JS 中没有宽度和高度计算来实现它？

![草图](../Images/c1c2e59b020cd91fab210cce1773bb2e.png)

这是我到目前为止所能得到的：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<style type="text/css">
.block1 {
    border: 4px solid #888;
    height: 120px;
    width: 200px;
}
.block2 {
    height: 100%;
    border: 4px solid red;
}
.msg {
    display: inline-block;
    white-space: nowrap;
    font-family: Verdana;
    font-size: 14pt;
    -moz-transform: rotate(-90deg);
    -moz-transform-origin: center center;
    -webkit-transform: rotate(-90deg);
    -webkit-transform-origin: center center;
    -ms-transform: rotate(-90deg);
    -ms-transform-origin: center center;
}
</style>
</head>
<body>
    <div class="block1">
        <table class="block2">
        <tr>
            <td>
                <div class="msg">Hi there!</div>
            </td>
        </tr>
        </table>
    </div>
</body>
</html> 
```

![我的测试](../Images/64ccfe3611af33732c1d4e8fdc64a661.png)

您可以看到内部块的计算宽度与旋转前的文本宽度相同。

**更新：**

这是我最终想要得到的图片：

![在此处输入图像描述](../Images/35acc0d92253f4c5b53cccb0c989e042.png)

它是一个水平条纹，项目左侧堆叠，并带有一个垂直标题块。Stripe 的高度是可变的，因此项目应该适应并且标题的文本应该保持居中。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-06-06T04:35:04.653

我相信您只使用 a 是`<table>`因为它似乎是实现您正在寻找的最简单的方法，所以我将它从等式中剔除并改用语义 HTML。如果还有其他原因，我提前道歉，您应该能够将样式移植到使用 a`<table>`代替。

请参阅[jsFiddle 演示](http://jsfiddle.net/hKp7f/4/)以查看实际代码。或者，继续代码：

## HTML

```
<section class="wrapper">
    <header><h1>Test</h1></header>
    <article>Text.</article><!--
    --><article>More text.</article><!--
    --><article>Photos of cats.</article><!--
    --><article>More photos of cats.</article>
</section> 
```

## CSS

```
.wrapper {
    margin:1em;
    position:relative;
    padding-left:2em; /* line-height of .wrapper div:first-child span */
    background:#fed;
}
.wrapper header {
    display:block;
    position:absolute;
    top:0;
    left:0;
    bottom:0;
    width:2em; /* line-height of .wrapper div:first-child span */
    overflow:hidden;
    white-space:nowrap;
}
.wrapper header h1 {
    -moz-transform-origin:0 50%;
    -moz-transform:rotate(-90deg) translate(-50%, 50%);
    -webkit-transform-origin:0 50%;
    -webkit-transform:rotate(-90deg) translate(-50%, 50%);
    -o-transform-origin:0 50%;
    -o-transform:rotate(-90deg) translate(-50%, 50%);
    -ms-transform-origin:0 50%;
    -ms-transform:rotate(-90deg) translate(-50%, 50%);
    transform-origin:0 50%;
    transform:rotate(-90deg) translate(-50%, 50%);
    position:absolute;
    top:0;
    bottom:0;
    height:2em; /* line-height of .wrapper div:first-child span */
    margin:auto;
    font-weight:bold;
    font-size:1em;
    line-height:2em; /* Copy to other locations */
}
.wrapper article {
    display:inline-block;
    width:25%;
    padding:1em 1em 1em 0;
    vertical-align:middle;
    -moz-box-sizing:border-box;
    -webkit-box-sizing:border-box;
    -ms-box-sizing:border-box;
    -o-box-sizing:border-box;
    box-sizing:border-box;
} 
```

## 这个怎么运作

设置为的`<header>`高度，`.wrapper`并将其`width`设置为（的`2em`值）。然后，垂直对齐（其中[也来自]）。一旦垂直对齐，它就会在左侧中间逆时针旋转 90 度。为了使其再次可见，它被垂直平移（将其水平拉回到屏幕上）和水平平移（垂直对齐）。是的，措辞是正确的——一旦你旋转 [-]90 度，一切都会变得混乱；）`line-height``<h1>``<h1>``top:0;bottom:0;height:2em;margin:auto;``2em``line-height``<h1>``<h1>``50%``-50%`

## 陷阱

*   仅支持静态“高度” `<h1>`。在这种情况下，仅支持 1 行。
*   包装将不起作用（在此示例中我实际上已禁用它），因此任何不适合的`height`内容都`.wrapper`将被隐藏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T01:06:54.347

在更彻底地查看变换样式后，它看起来并非如此。您需要知道外层的精确高度`div`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-05T17:04:00.237

我能想到的最好的是：http: [//jsfiddle.net/EwgtT/](http://jsfiddle.net/EwgtT/)

block1 的可变高度不会有问题，但是您的消息的可变高度是；它总是从底部开始。

**编辑：** 已更新，因此在 FF 和 IE 中运行良好：http: [//jsfiddle.net/EwgtT/2/](http://jsfiddle.net/EwgtT/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-05T17:08:28.000

我想出了这个：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<style type="text/css">
.block2 {
    width: 100%;
    border: 4px solid red;
}
.msg {
    display: inline-block;
    white-space: nowrap;
    font-family: Verdana;
    font-size: 14pt;
}
.block1 {
    border: 4px solid #888;
    -moz-transform: rotate(-90deg);
    -moz-transform-origin: right top;
    -webkit-transform: rotate(-90deg);
    -webkit-transform-origin: right top;
    -ms-transform: rotate(-90deg);
    -ms-transform-origin: right top;
    text-align:center;
}
</style>
</head>
<body>
    <div class="block1">
        <table class="block2">
        <tr>
            <td>
                <div class="msg">Hi there!</div>
            </td>
        </tr>
        </table>
    </div>
<style>
.block1{
width:500px;
margin-left:-500px;
}
</style>
</body>
</html> 
```

*   将转换切换到外部元素，
*   然后使用宽度属性来定义页面底部的高度（当你玩它时，你实际上是在玩那里的高度。）
*   对于旋转后可见的左侧空白空间，我使用可变宽度（高度）作为负边距。

你可以在这里看到它：http: [//pastehtml.com/view/c0hl7zxci.html](http://pastehtml.com/view/c0hl7zxci.html)

# c# - C# 泛型——为什么 lambda 可以工作，而简单的方法却不行？

> ID：10843382
> 
> 赞同：18
> 
> 时间：2012-06-01T01:36:06.427
> 
> 标签：c#, generics, type-inference

我无法理解为什么 C# 编译器可以推断类型

```
Array.ConvertAll(new int[1], i => Convert.ToDouble(i)); 
```

但不是为了

```
Array.ConvertAll(new int[1], Convert.ToDouble); 
```

当看起来前者比后者更复杂的推论时。

有人可以解释为什么会这样吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-06-01T03:33:51.713

这个（存档的）博客文章很好地涵盖了这个问题：http: [//blogs.msdn.com/b/ericlippert/archive/2007/11/05/c-3-0-return-type-in​​ference -does-不工作的成员-groups.aspx](http://blogs.msdn.com/b/ericlippert/archive/2007/11/05/c-3-0-return-type-inference-does-not-work-on-member-groups.aspx)

总而言之，据我了解（如果链接消失了）；这是 C# 3.0 中的一个有意识的设计决定，因为在方法组（您的第二个示例）上执行类型推断是不合适的。

我猜很多人不喜欢这样，所以这个问题在 C# 4.0 中得到了解决（从 Visual Studio 2010 开始）；

“在 C# 4.0 中，当方法组可以明确地与从委托推导出的一组完全固定的参数类型相关联时，返回类型推断适用于方法组参数。一旦与方法组关联的参数类型已知，则重载决议可以明确地确定方法组中的哪个方法与委托形式参数相关联；然后我们可以从特定方法到委托返回类型进行返回类型推断。”

# java - 为什么有时我们必须在 Android 中调用 super ？

> ID：10843383
> 
> 赞同：45
> 
> 时间：2012-06-01T01:36:15.947
> 
> 标签：java, android, inheritance, overriding

有时，当我覆盖方法时，第一次调用它时会出现异常，如下所示：

```
05-31 21:32:04.266: E/AndroidRuntime(28471): android.support.v4.app.SuperNotCalledException: 
Fragment AnalFragment{41795860 #1 id=0x7f070002} did not call through to super.onDestroy() 
```

为什么我们被迫打电话`super.method()`？父类有义务是有道理的，但更重要的是，我们如何知道一个方法需要`super`被调用，而不是等待它崩溃？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-06-01T01:49:13.817

> 为什么我们被迫调用 super.method()？

构成 Android SDK 的类可能非常复杂。例如，Activity 和 Fragment 都必须执行许多操作才能正常运行（即管理生命周期、优化内存使用、将布局绘制到屏幕上等）。要求客户端调用基类（通常在方法的开头）确保这些操作仍然执行，同时仍然为开发人员提供合理的抽象级别。

> 我们怎么知道~~函数~~ **方法**需要调用 super 呢？

文档应该告诉您是否需要这样做。如果不是，我会在 Google 上搜索一些示例代码（或查看 API 演示......或者更好的是，查看源代码！）。弄清楚应该不会太难。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-12-02T18:50:44.860

我知道这不是 OP 的真正意图，他确实问了这个问题，我不相信它得到了一个很好的答案，所以，如果有人想知道“为什么我必须打电话给超级？！？如果他们会要求的，他们为什么不为我做呢！！！”。以下是这些问题的答案......

基本上，如果您要覆盖必须调用的东西，则必须调用 super() ，这通常是相当复杂的代码。现在，他们不只是为你做它并在你的函数之前调用它的原因主要是为了让你有控制权！:-D

更具体地说，您无法控制调用 super() 的 IF，但是，您可以控制 WHEN！所以，假设你有一些特定的代码需要在 super() 被调用之前发生，你现在可以自由地调用 super() 只有在运行你的代码之后。或者...假设您需要 super() 已经运行以使您的代码不会崩溃，您现在可以选择在运行代码之前运行 super()，从而确保为您设置了所有内容。哎呀，您甚至可以在技术上覆盖超类核心并编写自己的方法来处理 super() 本身，并使其不必调用 super()，但 99.9% 的时间理智的人不需要去做这个！:-P

因此，“为什么我必须调用 super()”的简短回答是……这样您就可以控制何时调用它并在 super() 运行之前或之后执行操作。:-)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-01T02:41:09.207

**super**关键字有两个主要用途

**1.**调用超类的构造函数。

**2.**访问被子类成员隐藏的超类成员。

那么，为什么有时需要用户超级关键字呢？答案是 android 属于 4GL 语言，这意味着它有许多现成的功能。当我们为自定义覆盖这些方法时，我们使用 super 关键字。

看看在 android 中 super 关键字的非常简单的用法（我们大多数时候都这样做）。

```
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    .
    .
    .
} 
```

super() 必须始终是在子类的构造函数中执行的第一条语句。当子类调用 super() 时，它正在调用其直接超类的构造函数。super 的第二种形式最适用于子类的成员名称隐藏超类中同名的成员的情况。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-06-01T01:43:48.113

该要求通常直接在 API 文档中指定。例如，参见 android.widget.ListView.onFinishInflate：

> 受保护的无效 onFinishInflate ()
> 
> ...
> 
> 即使子类重写了onFinishInflate，它们也应该始终确保调用超级方法，以便我们被调用。

不幸的是，我个人的经验是 Android 文档的质量参差不齐。因此，我怀疑在某些情况下需要调用但未记录在案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-06-08T07:12:15.137

重要的是要注意，一旦您覆盖了一个方法，您基本上会忽略父类中的所有内容，而是在子类中拥有您自己的自定义实现（实际上是覆盖它）！

在我们的例子中，我们不想丢弃父实现。我们实际上想继续使用原来的方法，并为每个子类单独添加额外的检查。

这就是我们使用“super”关键字的地方！

您可以通过使用“super”关键字，后跟一个点，然后是方法名称来重用子类中的父方法：

例如：isValidMove(position) 是棋子的方法并检查移动有效性并在 8x8 棋盘中绑定。

super.isValidMove(位置);

在这里使用关键字 super 意味着我们要从“this”类的实现内部运行超级（或父）类中的实际方法。

这意味着在每个子类中，在您检查自定义移动之前，您可以检查 super.isValidMove(position) 是否返回 false。如果是，则无需进行任何检查并立即返回 false；否则，继续检查。

Rook 类的新实现如下所示：

```
class Rook extends Piece{
   boolean isValidMove(Position newPosition){
      // First call the parent's method to check for the board bounds
  if(!super.isValidMove(position)){
     return false;
  }
  // If we passed the first test then check for the specific rock movement
  if(newPosition.column == this.column && newPosition.row == this.row){
     return true;
  }
  else{
     return false;
      }
   }
} 
```

您还可以使用 super() 调用父级的构造函数。这通常在实现子构造函数时完成。通常，您希望首先在父构造函数中运行所有内容，然后在子构造函数中添加更多代码：

```
class Rook extends Piece{
   // default constructor
   public Rook(){
    super(); // this will call the parent's constructor
    this.name = "rook";
   }
} 
```

注意：如果子构造函数没有使用 super 显式调用父构造函数，Java 编译器会自动插入对父类的默认构造函数的调用。如果父类没有默认构造函数，你会得到一个编译时错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-18T19:14:14.730

作为基础，super 是一种用于引用主超类字段/方法的方法，从该字段/方法完成类扩展（在初始类定义中使用扩展）或创建其实例。

当我们需要一个最基本的定义来改变超类的方法/字段来解决我们的目的时。

例如

java.lang.Object（有很多方法和字段）>android.view.View>android.view.ViewGroup>android.widget.LinearLayout

但是，如果您需要更改/使用它，因为它是对象类的方法，那么您需要 Super 方法来引用 LinearLayout 类中对象类中第一次创建的方法。

# asp.net - ASP.net / HTMLAgilityPack：在 div 中获取 span 的值

> ID：10843386
> 
> 赞同：1
> 
> 时间：2012-06-01T01:36:39.873
> 
> 标签：asp.net, html-agility-pack

```
Dim myHtml As New HtmlWeb
    Dim myPage As HtmlDocument = myHtml.Load("http://www.mysite.com")
    Dim myNode As HtmlAgilityPack.HtmlNode

    myNode = myPage.DocumentNode.SelectSingleNode("//div[@id='olpDivId']") 
```

在 olpDivid 内部有具有相同类的跨度

```
<span class="blah><a href="fsdfs1>1</a></span>
<span class="blah><a href="fsdfs1>2</a></span>
<span class="blah><a href="fsdfs1>3</a></span> 
```

问题是在我的 olpDivId 内部有三个具有相同类的跨度，我需要从第二个内部获取文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T09:58:12.010

我想你正在寻找这个。

```
var myNode = myPage.DocumentNode.SelectSingleNode("//div[@id='olpDivId']/span[2]/a");

if (myNode != null)
{
    string value = myNode.InnerText.Trim();
} 
```

我用下面的 html 片段测试了这段代码

```
<div id="olpDivId">
    <span class="blah"><a href="fsdfs1">1</a></span> <span class="blah"><a href="fsdfs1">
        2</a></span> <span class="blah"><a href="fsdfs1">3</a></span>
</div> 
```

# java - Android AsyncTask 和对象传递

> ID：10843389
> 
> 赞同：3
> 
> 时间：2012-06-01T01:37:00.167
> 
> 标签：java, android, android-asynctask

我需要一些关于登录过程代码基本架构的帮助。我正在实施 Async Http 处理以使事情适用于 ICS。

此代码的目标是登录我的应用程序。

*   从 UI 提交登录表单 (Login.java)
*   连接到我们的服务器并通过 http 传递用户名/密码获取 XML 结果
*   将 XML 结果解析为数组。(ParseXML.java)
*   在 UI 中显示结果反馈。

现在这一切都在我的程序中起作用了，但是在尝试使用强制 Asyc HTTP 连接的 ICS 进行测试后，我很快意识到了我的问题并让我怀疑我的整个设计......

它目前工作的基本方式：

**登录.java：**

```
 class Login {
    ...
    ParseXML myXMLParser = new ParseXML();  
    myXMLParser.doLogin(username, password, Login.this);    

    public doFinished(result) {
      // update UI
    }
    ...
  } 
```

**ParseXML.java：**

```
 class ParseXML {
    // class variable to hold login object for async to access
    public Login loginObj;
    ...
    public void doLogin(String _username, String _password, Login _l) {
      loginObj = (Login) _l;
      ...

      // create loginUrl string to run through async
      ...
      new DownloadFilesTask().execute(loginUrl);
    }

    class DownloadFilesTask extends AsyncTask<a, b, c> {
      doInBackground() {
        // do stuff
        // download result of http call
        // parse XML
      }

      onPostExecute(result) {        
        // call the public class variable of login object i have and tell it to update the UI
        // pass back the result array.
        loginObj.doFinished(result);
      }
    }
  } 
```

I'm mostly concerned that its bad design to be doing things this way and I should simply move the XML and http connection code within my Login.java file so its all included (UI, HTTP, XML Parsing, Asyc).

*Particularly i'm concerned with calling back to Login.doFinished()* from onPostExecute(). is this bad for memory? I'm worried that would cause the ParseXML object to avoid garbage collection because it is now going back to Login Activity which will continue running once the user is logged in in turn holding ParseXML open.

I come from a PHP background so I have been trying to keep all my XML parsing and HTTP processing within the `ParseXML` "module" so that i know where to look for changes to this.

At the moment `ParseXML` handles all http work, ie, `getUsers`, `getChannels`, `addUser`, `delUser`, `doLogin` etc. But Should I try moving all the code to handle XML and HTTP connections (async) within the relevant screen/ activity so they are self contained?

I really appreciate any help on this

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T04:53:14.923

I would Use interface in this case

**DownloadHelper.java**

```
public interface DownloadHelper 
{
   public void OnDownloadFinish(String Response);
   public void OnDownloadFailed(String Response); 
} 
```

**Login.java**

```
class Login {

    DownloadHelper helper=new DownloadHelper()
    {
      public void OnDownloadFinish(String Response)
       {
           // update UI

       } 

      public void OnDownloadFailed(String Response)
       {
           //Take Action
       }     
    };  

    new ParseXMLTask(this,helper).execute(username, password);
} 
```

**ParseXMLTask.java**

```
class ParseXMLTask extends AsyncTask<Object,Object,Object>
{
    DownloadHelper helper;
    public ParseXMLTask (Context context,DownloadHelper helper)
    {
       this.helper=helper;
    }   
    public void onPreExecute(){}

    public Object DoInBackground(Object object)
    {
       // do stuff
      // download result of http call
     // parse XML
     return parsed response
    }  

   public void onPostExceute(Object object)
    {

       helper.OnDownloadFinish((String)object);
       or
        helper.OnDownloadFailed((String)object);

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T04:24:41.293

From your post I assume that you have a LoginActivity that creates a ParseXML which then has a LoginObject (can you call that "LoginCallback"?) to return the result to the LoginActivity that displays the result. This should work, it's a callback pattern that is used a lot. A callback is generally defined as an interface, not a class.

Another approach would be to start an AsyncTask in LoginActivity, that calls ParseXML in its doInBackground, and returns the result directly to LoginActivity in onPostExecute.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T05:58:01.420

### I should simply move the XML and http connection code within my Login.java file so its all included (UI, HTTP, XML Parsing, Asyc).

This is exactly what we trying to avoid in an OO design, a big damn class contains everything (UI stuff, business logic and etc).

Based on your requirement, a good OO deisgn IMO is:

1.  Create interface IBusniessDAO define all method signatures (getUsers, getChannels and etc).
2.  Create a POJO (AKA. Plain Old Java Object) class XmlParser implements IBusinessDAO, in this class, write you method implementation normally and do not handle any asynchronous execution here (that is not the job of Business POJO). where and how these methods are intended to be used (synchronously or asynchronously) is determined in the caller class (i.e. Activity). If says in the future, you want to replace XmlParser with JsonParser, simple create JsonParser implements IBusinessDAO and replace XmlParser.
3.  AsyncTask always stay with Activity (as an inner class), if an Activity requires network functions, simply initialize you IbusinessDAO object in this Activity and call the network-related method properly in AsyncTask.doInBackground() method, and update the UI stuff managed by this activity directly in AsyncTask.onPostExecute() method.

Check out the sample code I written in this [answer](https://stackoverflow.com/questions/8295003/best-way-to-manage-the-progressdialog-from-asynctask/8317071#8317071) before, hope this helps.

# playframework - 如何防止带有 ID 的隐藏字段被黑客入侵

> ID：10843390
> 
> 赞同：7
> 
> 时间：2012-06-01T01:37:10.680
> 
> 标签：playframework

我正在构建一个简单的 CRUD 应用程序（不使用 CRUD 模块）。

我的模型是一个具有一个属性的简单类。id 隐式继承自 Model。

```
@Entity
public class Account extends Model {

    @Required
    public String domain;
} 
```

观点如下。请注意带有 id 的隐藏字段。

```
<form class="form-horizontal" action="@{Application.save}" method="POST">
<fieldset>
    <legend>Settings</legend>
    <input type="hidden" name="account.id" value="${account?.id}">

    #{field 'account.domain'}
    <div class="control-group #{if field.error != null} error #{/if}">
        <label class="control-label" for="${field.id}">&{field.name}</label>
        <div class="controls">
            <input type="text" class="input-xlarge" id="${field.id}" value="${field.value}" name="${field.name}">
            <span class="help-inline">${field.error}</span>
        </div>        
    </div>
    #{/field}        

    <div class="form-actions">
        <input class="btn btn-primary" type="submit" value="Save">
    </div>

</fieldset> 
```

我已经能够构建一个保存、更新工作的场景。

完成更新的方式是我从隐藏字段中读取 ID，并更新记录。如果 ID 不可用，则会创建一条新记录。

**所以问题是：** ID 是否可以被破解，即修改，以便我将 1 更改为 2，并假设存在 2 的记录，它会被覆盖。（我想使用 firebug 或其他插件应该不难）。

我该如何防止这种情况？我想到的一个选项是读取具有给定 ID 的记录，如果允许用户修改它，我允许更新，否则不允许。这仍然不是万无一失的，因为虽然可以允许用户，但可以修改“错误”记录。

我想这是一个已知问题，希望有一个已知的解决方案。

感谢您花时间回答我的问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-06-01T16:45:37.990

> 所以问题是：ID 是否可以被破解，即修改，以便我将 1 更改为 2，并假设存在 2 的记录，它会被覆盖。（我想使用 firebug 或其他插件应该不难）。
> 
> 我该如何防止这种情况？我想到的一个选项是读取具有给定 ID 的记录，如果允许用户修改它，我允许更新，否则不允许。这仍然不是万无一失的，因为虽然可以允许用户，但可以修改“错误”记录。

当然，攻击者可以更改记录的 id。

有几种方法可以最大限度地减少这种攻击的影响。

1）最简单的方法 -**对象获取**：

**从数据库中获取对象并检查它是否属于相关用户。**这将防止其他用户弄乱不属于他们的对象，但不会阻止用户更改属于他的另一个对象。在大多数情况下，这是一种简单且足够的方法。

2）更复杂：**签名**：

这里的想法是对**您提供给模板的常量进行签名，并在表单提交后检查哈希是否仍然匹配。** 这与 play 对其会话所做的非常相似。攻击者不可能弄乱常量（例如 id）并提供最大的安全性。但是，您将有更多工作要做。

例子：

```
 public static void someActionDisplayingForm(){
  SomeObject o = ....
  SomeOtherObject o2 = ....
      String constants = o.id + "|" + o2.id;
      String hash = Crypto.sign(constants);
       render(o, o2, hash);
} 
```

在您拥有的模板中

```
 #{form ...}
   <input type='hidden' name='id1' value='${o.id}' />
   <input type='hidden' name='id2' value='${o2.id}' />
   <input type='hidden' name='hash' value='${hash}' /> 
```

在处理表格的方法中你会做

```
 public static void processing(String id1, String id2, String hash, String otherValues, ...){
   String constants = id1 + "|" + id2;
   String checkHash = Crypto.sign(constants);
    if(!checkHash.equals(hash))
     badRequest();
   ... 
} 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T02:03:16.257

> ID 是否可以被破解，即修改，以便我将 1 更改为 2，并假设存在 2 的记录，它会被覆盖。（我想使用 firebug 或其他插件应该不难）。

你是对的。编辑这些内容就像在 Chrome 控制台中检查和编辑元素一样简单。记住; 客户端所做的任何事情都是不安全的，并且可以由用户修改。始终进行服务器端检查，**始终**.

> 我该如何防止这种情况？

一种可能的解决方法是将记录链接到用户，即，在用户和名为“recordAccess”的记录之间创建一个桥接表（或任何您的命名约定导致您调用它）。这个桥接表将有一个用户 ID 列和一个记录 ID 列。服务器将对照此表检查用户 ID 和记录 ID，并且仅当数据库中有匹配的行时才允许更改。如何向此表添加行取决于您的应用程序的工作方式，但应该不难解决。

为了防止用户编辑错误的记录，您可以在此桥接表中添加一个名为“current”（或者，再次，任何您喜欢的）的附加列，它是一个简单的布尔值。当用户去编辑他/她被允许编辑的记录时，该值将被设置为“true”，并且与该用户关联的所有其他行将被设置为“false”。然后，当用户提交编辑时，如果该行中的值设置为“true”，则该行成功更新并且值变回“false”。否则，所有值都设置为“false”并拒绝更新。

希望这能给你一些想法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T01:54:13.023

是的，可以修改。这样做不需要真正的知识或技能。在任何情况下，来自用户的信息在您进行其他验证之前都不得被信任。

为此，您需要某种服务器端逻辑。在许多情况下，这只是在服务器上链接到用户对象的会话，它允许您执行授权（您确保记录是他们可以修改的记录；哪个不太重要，并且是用户故意引起的错误，而不是安全风险）。

只要您可以将请求绑定回用户，然后确保允许用户执行请求，就可以了。最简单的方法通常是会话，但空间很大。

# objective-c - 如何关闭 NSWindow 并从停靠菜单中删除应用程序图标

> ID：10843392
> 
> 赞同：6
> 
> 时间：2012-06-01T01:37:38.040
> 
> 标签：objective-c, macos, cocoa, statusbar

如果您在 MacBook 上使用 DropBox，您必须在我们完成注册过程后看到这一点。它关闭主窗口应用程序并将其从停靠项中自行删除，但应用程序正在从状态菜单运行。

* * *

## 视觉的：

![在此处输入图像描述](../Images/3a803c814e62d220618dbfd184346e46.png)

* * *

## 到目前为止我做了什么：

*   我的应用程序与 show NSWindow 完美运行
*   当我从我的前端应用程序窗口登录时，我可以创建一个带有弹出框的状态菜单图标
*   **在这一步中，我想删除 NSWindow 和 Dock 图标，但应用程序应该可以从状态菜单访问。**

如何做到这一点？

**仅供参考：我不期待任何代码，只是理解或快速提示。我会弄清楚其余的:)**

* * *

## 我指的资源，

稍后我将为[launchd](https://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPSystemStartup/Articles/CustomLogin.html)配置我的应用程序。所以在系统启动时它可以启动并在状态菜单中显示它自己。现在我正在寻找一个很好的资源（当然它很好，因为它的 Apple Doc）但是由于我是一个天真的程序员，有没有人有一个很好的示例链接？这显示了如何在启动时添加应用程序？

## 编辑：

我将按照本[教程](http://cocoatutorial.grapewave.com/tag/lssharedfilelist-h/)添加到启动中，以后用户可以根据需要更改他们的偏好，他们可以选择打开我的应用程序或关闭启动

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T01:53:25.573

要将您的应用程序仅作为状态菜单运行，请将以下键之一添加到 info.plist 文件中：

`Application is agent (UIElement)`

或者：

`Application is background only`

至于在两者之间切换，我不确定最好的方法，但我建议将设置过程设为自己的应用程序。（带有图标和窗口的应用程序）您可以将应用程序包含在菜单项应用程序中，并在用户启动程序时自动启动它......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T08:38:37.553

正如柚木所说，您希望 info.plist 中的“应用程序是代理 (UIElement)”键。这个键意味着你不会有一个停靠图标......这就是你想要的。但是，无需使用“Application is background only”键。此键可防止您在屏幕上放置任何不必要的窗口。所以我会留下这把钥匙。

通常设置您的应用程序，以便在启动时不会自动显示窗口。在启动时进行某种检查以查看是否需要配置。如果是，则使您的配置窗口可见。你甚至可以在你的状态菜单中有一个“配置...”菜单项，这样你的用户就可以在任何需要的时候弹出打开配置窗口。这真的很简单，但不要使用“Application is background only” info.plist 键。

顺便说一句，要让窗户出现在前面有点困难。诀窍是让您的应用程序首先像这样......

```
[NSApp activateIgnoringOtherApps:YES];
[someWindow makeKeyAndOrderFront:nil]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-17T09:36:11.753

通常，dropbox 示例中提到的情况使用两个单独的应用程序来解决，一个用于菜单，一个用于另一个 ui 部分（具有提到的停靠图标 fe），并且两个进程通过 fe ipc 协作。

在一个应用程序中做同样的事情有点棘手，你可以在这里找到我的详细信息

[Cocoa - 以编程方式进入前台/后台](https://stackoverflow.com/questions/12948539/cocoa-go-to-foreground-background-programmatically/12981068#12981068)

# java - Android 应用程序的 HashMap 替代方案

> ID：10843393
> 
> 赞同：4
> 
> 时间：2012-06-01T01:37:46.007
> 
> 标签：java, android, hashmap, out-of-memory

我在使用 java.util HashMap 时遇到 OOM 问题，因此我正在寻找标准 Java Hashmap 的内存友好 HashMap 替代品。我尝试了 Trove，它有所改善，但仍不时出现 OOM。如果内存有效，我可以适应一些速度损失。

我不是在寻找数据库。基于文件的 HashMap 实现也可以，只要它们离线工作。我正在存储像 int 和 byte 这样的原语。

另外，请说明您是否有任何经验以及您在记忆方面的进步程度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T01:54:39.223

我可以想到两个对您有用的选项——最好的选项完全取决于您的应用程序。第一种是使用 Wea​​kReference 或 SoftReference。现在请记住，从 Android 2.3 开始，VM 变得更加激进，因此收集 VM 可能会更频繁地收集这些类型的引用。就个人而言，我不是出于这个唯一原因使用这些类型的参考资料的超级粉丝，但有些人可能会提出不同的看法。第二种选择，也是我推荐的一种选择，是查看 LRU 缓存。您可以使用 LinkedHashMap 实现自己的 LRU 缓存。但是，如果您使用地图来存储位图，我强烈建议您查看包含位图缓存的 Android 兼容包提供的位图缓存。以下是一些您可以用来阅读的链接：

[弱引用](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/ref/WeakReference.html)

[软引用](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/ref/SoftReference.html)

[使用 LinkedHashMap 的 LRU 缓存](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedHashMap.html)

[Android 位图缓存以及为什么应该避免弱/软引用](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-08-17T06:55:04.150

你应该看看[ArrayMap](https://developer.android.com/reference/android/util/ArrayMap.html)和[SparseArray](http://developer.android.com/reference/android/util/SparseArray.html)。这些是在 android 中使用 HashMap 的内存高效替代方案。

# javascript - 是否可以从 three.js 中的字节数组加载图像和模型？

> ID：10843394
> 
> 赞同：3
> 
> 时间：2012-06-01T01:38:12.163
> 
> 标签：javascript, three.js

我知道在three.js中，我们可以使用ImageUtils直接从服务器加载图像，并使用JSONLoader将模型作为.js文件加载，但是是否可以直接从字节数组加载图像和模型？（例如，下载一个压缩文件，在 javascript 中提取它并将字节数组直接输入到加载器中？）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T02:14:59.427

好吧，我找到了答案。

可以通过将我们自己的扩展方法添加到相关对象来完成。对于纹理加载，我们可以通过向 imageutils 添加一个新方法来加载二进制数组，如下所示：

```
THREE.ImageUtils.prototype.loadTextureBinary = function ( data, mapping, callback ) {

    var image = new Image(), texture = new THREE.Texture( image, mapping );

    image.onload = function () { texture.needsUpdate = true; if ( callback ) callback( this ); };
    image.crossOrigin = this.crossOrigin;
    image.src = "data:image/png;base64," + Base64.encode(data);

    return texture;
}; 
```

要加载字符串 JSON，请提取数据并将其转换为字符串并将其传递给 JSONLoader 的这个新扩展方法：

```
THREE.JSONLoader.prototype.loadJson = function ( data, callback, texturePath ) {

    var worker, scope = this;

    texturePath = texturePath ? texturePath : this.extractUrlBase( url );

    this.onLoadStart();
    var json = JSON.parse( data );
    context.createModel( json, callback, texturePath );
}; 
```

注意：以上代码适用于 Three.js r49。如果较新版本有代码更改，请将其添加到上述方法中以符合要求。

# javascript - 每次刷新页面时随机链接？

> ID：10843395
> 
> 赞同：1
> 
> 时间：2012-06-01T01:38:36.983
> 
> 标签：javascript, html, random, logic

我试图弄清楚如何制作一个锚标记，当页面从我拥有的列表中随机刷新时，该标记每次都会改变。

说我有这个清单

```
<a href="http://testpage.com/">This is the first one</a>
<a href="http://testpage.com/">This is the second one</a>
<a href="http://testpage.com/">This is the third one</a> 
```

这是第一个 这是第二个 这是第三个

它就像 Adsense 拥有的链接单元广告，但我只是希望它做简单的随机而不做任何额外的工作，比如检查是否与主题相关或不像 adsense 那样。

请告诉我我能做什么。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T01:46:04.800

```
<a href="http://testpage.com/">
<script type="text/javascript">
    // This script will replace itself with a random one of these phrases
    var phrases = [
        'This is the first one',
        'This is the second one',
        'This is the third one'
    ];

    var scripts = document.getElementsByTagName('script');
    var this_script = scripts[scripts.length - 1];
    this_script.parentNode.replaceChild(document.createTextNode(phrases[Math.floor(Math.random()*phrases.length)]), this_script);
</script>
</a>​ 
```

[**JSFiddle**](http://jsfiddle.net/Paulpro/vpAHz/)

* * *

**分解**

创建一个包含三个字符串的数组文字：

```
var phrases = [
    'This is the first one',
    'This is the second one',
    'This is the third one'
]; 
```

获取页面上所有[脚本元素的](https://developer.mozilla.org/en/HTML/Element/script)[NodeList](https://developer.mozilla.org/En/DOM/NodeList)（因为页面已经加载到这一点，所以之前和包括这个的所有脚本）：

```
var scripts = document.getElementsByTagName('script'); 
```

将该列表中的最后一个脚本（即，此脚本元素）存储在`this_script`：

```
var this_script = scripts[scripts.length - 1]; 
```

我将把下一行分成更小的部分。
[Math.random](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/random)给出一个介于（包括）和（不包括）之间的[数字](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Number)。将它乘以 3 会在(inclusive) 和(exclusive) 之间得到均匀分布，并且[Math.floor](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Math/floor)会截断它。这给出了一个介于两者之间的随机整数。如果将元素添加到数组中，它将更新，因为它在计算中使用了phrases.length，而不是文字 3：`0``1``0``3``0``2`

```
Math.floor(Math.random()*phrases.length) 
```

[document.createTextNode](https://developer.mozilla.org/en/DOM%3adocument.createTextNode)创建并返回一个实现 Text 接口的新节点，它的数据就是传入的值。在这种情况下，它是短语数组中的一个随机元素：

```
document.createTextNode(phrases[Math.floor(Math.random()*phrases.length)]) 
```

[Node.parentNode](https://developer.mozilla.org/en/DOM/Node.parentNode)是不言自明的，在这种情况下，脚本元素的父级将是[HTMLAnchorElement](https://developer.mozilla.org/en/DOM/HTMLAnchorElement)（由`<a>`树中脚本上方的标记表示）。[Node.replaceChild](https://developer.mozilla.org/en/DOM/Node.replaceChild)接受两个参数， a`new_child`和 an `old_child`。我们为 传递了新的文本节点`new child`，并为 传递了这个脚本`old_child`，这导致该脚本从 DOM 中删除并替换为文本节点：

```
this_script.parentNode.replaceChild(document.createTextNode(phrases[Math.floor(Math.random()*phrases.length)]), this_script); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T01:58:53.103

你可以像这样使用php：

```
<?php $linkName = mt_rand(1,3);
 if ($linkName == 1) echo '<a href="http://testpage.com/">This is the first one</a>';
 if ($linkName == 2) echo '<a href="http://testpage.com/">This is the second one</a>';
 if ($linkName == 3) echo '<a href="http://testpage.com/">This is the third one</a>';
?> 
```

# jquery - 使用 jquery 验证插件验证数组输入

> ID：10843399
> 
> 赞同：13
> 
> 时间：2012-06-01T01:39:04.507
> 
> 标签：jquery, jquery-plugins, jquery-validate

我有以下表格。我正在尝试使用 jquery 验证插件来验证输入。我尝试了一些代码，但它不起作用。当我单击提交按钮时，它只是进入表单的操作。

```
<form name="voucherform" action="something" method="post">
  <input type="text" name="reg_number[]" value="" />
  <input type="text" name="reg_number[]" value="" />
  <input type="text" name="reg_number[]" value="" />
  <input type="submit" name="submit" value="submit" /> 
```

您能否告诉我如何使用 jquery 验证插件来验证上述表单？

谢谢 ：）

我的jQuery代码：

```
 <script type="text/javascript" src="<?php echo base_url();?>support/datepicker/js/jquery-1.7.2.min.js"></script>
 <script type="text/javascript" src="<?php echo base_url();?>support/js/jquery.validate.js"></script>

 <script>
  $(document).ready(function() {

// validate signup form on keyup and submit
var validator = $("#voucherform").validate({
    showErrors: function(errorMap, errorList) {
        $(".errormsg").html($.map(errorList, function (el) {
            return el.message;
        }).join(", "));
    },
    wrapper: "span",
    rules: {

        reg_number[]: {
            required: true,
            minlength: 2,
            remote: {
                url: '<?php echo base_url();?>sales/invoice_check', async: false,
                type: 'post'
            },

        }
    },
    messages: {

        reg_number[]: {
            required: "Enter Reg Number",
            minlength: jQuery.format("Enter at least {0} characters"),
            remote: jQuery.format("{0} is already in use")
        },
    }
    });
    });
   </script> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-01T02:13:27.350

你有两个问题：

1.  您没有`form`正确选择元素。

    您正在寻找`form`带有`id`“voucherform”的标签，而您的标记不包含。您可能希望将选择器更改为：

    ```
    $("form[name='voucherform']").validate({ ... }); 
    ```

2.  括号 ( `[]`) 在 JavaScript 标识符中无效。这意味着您的脚本没有被正确解析。要解决这个问题，只需将那些带有括号的字段用引号括起来，即，`'reg_number[]'`而不是`reg_number[]`.

调整验证代码：

```
var validator = $("form[name='voucherform']").validate({
    showErrors: function(errorMap, errorList) {
        $(".errormsg").html($.map(errorList, function(el) {
            return el.message;
        }).join(", "));
    },
    wrapper: "span",
    rules: {
        'reg_number[]': {
            required: true,
            minlength: 2,
            remote: {
                url: '<?php echo base_url();?>sales/invoice_check',
                async: false,
                type: 'post'
            }

        }
    },
    messages: {
        'reg_number[]': {
            required: "Enter Reg Number",
            minlength: jQuery.format("Enter at least {0} characters"),
            remote: jQuery.format("{0} is already in use")
        }
    }
}); 
```

**示例：http:** [//jsfiddle.net/hfrhs/](http://jsfiddle.net/hfrhs/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-25T22:05:35.783

您可以在这里找到一个很好的答案：[jquery-validation-for-array-of-input-elements](http://www.codeboss.in/web-funda/2009/05/27/jquery-validation-for-array-of-input-elements/)。在 jquery.validate.js 中，我们可以找到一个名为 checkForm 的函数，我们要修改它如下：

```
checkForm: function() {
  this.prepareForm();
  for ( var i = 0, elements = (this.currentElements = this.elements()); elements[i]; i++ ) {
   if (this.findByName( elements[i].name ).length != undefined && this.findByName( elements[i].name ).length > 1) {
     for (var cnt = 0; cnt < this.findByName( elements[i].name ).length; cnt++) {
       this.check( this.findByName( elements[i].name )[cnt] );
     }
    } else {
     this.check( elements[i] );
    }
   }
  return this.valid();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T13:38:25.697

这是我的方式

```
 'reg_number[]':{ 
    required:function(){
      return $("input[name='reg_number[]']").filter(function(){
        return $.trim($(this).val()).length>0
      }).length==0
    }
 } 
```

希望对你有一点帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-10T05:33:37.643

只需共享一种方法来验证带有索引的复选框，并且只有其中一个是强制性的。

```
<input type="checkbox" value="0" name="is_appraisal[0]" class="is_appraisal_f siblingcheckbox" id="is_appraisal_f">

<input type="checkbox" value="1" name="is_appraisal[1]" checked="checked" class="is_appraisal_s siblingcheckbox" id="is_appraisal_s"> 
```

对此的 Jquery 验证：

```
 $.validator.addMethod("onechecked", function (value, elem, param) {
            if ($(".siblingcheckbox:checkbox:checked").length > 0) {
                return true;
            } else {
                return false;
            }
        }, "You must select at least one!");

        $.validator.addClassRules("siblingcheckbox", {
            onechecked: true
        }); 
```

# android - Android虚线可绘制潜在ICS错误

> ID：10843402
> 
> 赞同：33
> 
> 时间：2012-06-01T01:39:37.893
> 
> 标签：android, xml-drawable, shapedrawable

下面是一条虚线，在 XML 中定义为 ShapeDrawable：

```
<shape
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="line">

    <size
        android:height="2dp"
        android:width="700dp" />

    <stroke
        android:width="1dp"
        android:color="@android:color/black"
        android:dashWidth="1dp"
        android:dashGap="2dp" />

</shape> 
```

这将在几部姜饼手机上画出一条漂亮的虚线。然而，在 Galaxy Nexus 上，破折号似乎被忽略了，形状被绘制成一条连续的线。更奇怪的是，运行 ICS 的模拟器会用破折号正确渲染它，这只是物理设备搞砸了。

我错过了一些明显的东西吗？或者这真的是 Android 4.0 的错误吗？这条线在几个地方使用。这是一个示例 ImageView：

```
<ImageView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginLeft="@dimen/observation_observe_side_margin"
    android:layout_marginRight="@dimen/observation_observe_side_margin"
    android:layout_marginTop="16dp"
    android:contentDescription="@string/dotted_line_description"
    android:src="@drawable/dotted_line" /> 
```

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2012-11-28T16:50:21.887

记录在[http://code.google.com/p/android/issues/detail?id=29944](http://code.google.com/p/android/issues/detail?id=29944)的问题有一条评论，将以下内容应用于您的视图：

```
view.setLayerType(View.LAYER_TYPE_SOFTWARE, null) 
```

这对我有用。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-06-11T15:27:14.057

此问题记录在这里[http://code.google.com/p/android/issues/detail?id=29944](http://code.google.com/p/android/issues/detail?id=29944)关闭硬件加速将显示虚线。

# javascript - 对象的价值和原型问题

> ID：10843405
> 
> 赞同：1
> 
> 时间：2012-06-01T01:40:27.280
> 
> 标签：javascript

我正在尝试创建一个新类，但它似乎不起作用。这是代码：

```
<script>
var myClass = function(arg){
    return new init(arg);
}
var init = function(arg){
    return arg;
}
init.prototype.prop = true;
</script> 
```

问题是它`myClass('foo')`没有`'foo'`按预期返回。相反，它返回`init`. 然后我尝试了这段代码：

```
var init = function(arg){
    return [arg];//Now init returns an array
} 
```

`myClass('foo')`回报，`['foo']`而后`myClass('foo').prop`变成`undefined`。有谁知道如何解决它？

编辑：我想或多或少地像 jQuery 那样创建这个类。例如：`$('div')`直接返回一个值（如果是所有 div 标签），而不是具有存储该值的属性的对象

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T02:03:27.910

当您调用`new init()`并在`init()`其中返回一个非对象时，它会产生一个实例`init`而不是返回值。

如果你从你的`init()`函数返回一个数组，它会被返回；但是 Array 没有考虑您的`init`原型:)

另请参阅：[https ://stackoverflow.com/a/1978474/1338292](https://stackoverflow.com/a/1978474/1338292)

如果你想成为一个数组，你可以这样做：

```
function myClass(arg) {
    return new init(arg);
}
function init(arg) {
    this.push(arg);
}
init.prototype = [];
init.prototype.foo = true;

var x = new init('foo');
console.log(x) // ["foo"]
console.log(x.foo) // true 
```

它`init`从`Array`原型（即`[]`）继承。之后，您可以根据需要向`init`原型添加更多属性和方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T02:32:12.063

在你的代码中：

```
> <script>
> var myClass = function(arg) {
>   return new init(arg);
> }
> var init = function(arg){
>   return arg;
> }
>
> init.prototype.prop = true;
> </script>
> 
```

> 问题是 myClass('foo') 没有按预期返回 'foo'。相反，它返回 init。然后我尝试了这段代码：

如果编写为函数声明（更常见），您的代码可能会更清晰：

```
function myClass(arg) {
  return new init(arg);
}

function init(arg) {
  return arg;
} 
```

当您调用 时`myClass('foo')`，您将一个字符串传递给`init`，该字符串被称为构造函数。然后该函数尝试返回字符串，但是作为构造函数调用的函数将始终返回一个对象。如果您尝试返回原语，它将改为返回其*this*对象。[在ECMA-262](http://es5.github.com/#x8.6.2)中没有很清楚地说明。但它就在那里。

> 然后我尝试了这段代码：
> 
> var init = function(arg) { return [arg]; //现在init返回一个数组

因为数组是一个对象，所以这就是返回的内容。

```
> }
> 
```

> myClass('foo') 返回 ['foo']，但随后 myClass('foo').prop 变为未定义。有谁知道如何解决它？

因为您的构造函数返回一个数组，而不是它的*this*对象。返回的数组继承自`Array.prototype`，而不是`init.prototype`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T01:44:02.720

如果你从一个函数返回一个值并尝试使用`new`关键字，返回值将不是一个新实例化的对象，而是`return`. 因此，在您的情况下，返回的是 'foo' 字符串，而不是您期望的新对象。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-06-01T01:46:58.040

如果您想创建一个新类，您可能需要考虑这种模式：

```
var MyClass =function(arg) {
    this.init(arg);
};
MyClass.prototype = {
    init: function(arg) {
        // Do something with that arg
        this.someArg = arg;
    },
    myProperty: 'Hell world',
    someArg: null   
};

var myVar = new MyClass('Some arg'); 
```

测试结束：

```
console.log(myVar.myProperty);
console.log(myVar.someArg); 
```

看看：http: [//jsfiddle.net/4zwpm/](http://jsfiddle.net/4zwpm/)

# java - 使用正则表达式验证重复的特殊字符

> ID：10843407
> 
> 赞同：0
> 
> 时间：2012-06-01T01:40:42.177
> 
> 标签：java, regex, validation, email

我正在尝试在 Java 中验证电子邮件字符串，但是当这个字符串有两个或多个特殊字符时，我很难验证，这不是有效的电子邮件。

如果这样做，我的验证如下：

```
if (email.matches("(._\'!#$%&*+-\\/=?{|}~`^_-)\\1+")) {
    return false;
} 
```

输出示例：

> this_e-mail's_valid@domain.com - 返回真（正确）
> 
> this_e-mail_isn''t_valid@domain.com - 返回真（错误）

显然我的正则表达式有问题。

但是我在互联网上到处寻找答案，但没有成功。

我刚刚读到在表达式之前使用“\1+”，它应该进行此验证，但显然它没有。

提前感谢您的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T01:59:18.443

好的，首先你的正则表达式试图检测一些特殊字符。$ 表示行尾，而 \$ 表示美元符号。每当你需要一个特殊字符时，你需要在它之前用 \ 转义它所以，我相信你想要检测 $、花括号、管道、星号、问号和加号。这些只是您需要转义的众多特殊字符中的一小部分。

要检测一堆可能出现零次或多次的特殊字符，您需要使用 [] 和 * 指令，如下所示：

```
[#'&!?]* 
```

这将匹配任意数量的 # 或 ' 或 ! 或者 ？

使用 \W 可以变得更酷，这意味着任何不是您在单词中找到的字符。

我希望这有助于解决您的问题。听起来你会从这个链接中受益：http: [//docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:51:12.150

我完全不确定你的要求。电子邮件验证应该不止于此。

但是，如果要检测字符串是否连续有 2 个特殊字符，可以使用

```
!string.matches("^.*([._\'!#$%&*+\\\\/=?{|}~`\\^-])\\1.*$") // It will invalidate the case that 2 consecutive characters are the same. e.g. not__valid, but it will give OK for va+-lid
OR
!string.matches("^.*[._\'!#$%&*+\\\\/=?{|}~`\\^-]{2}.*$") // Any sequence of consecutive special characters will be invalidate. e.g. not_+valid 
```

请注意，我在逻辑上否定了结果。如果字符串包含连续字符，我将匹配该字符串。

我已经测试并纠正了早期版本中的错误。

# php - 如何将 Symfony2 操作嵌入 WordPress？

> ID：10843410
> 
> 赞同：7
> 
> 时间：2012-06-01T01:41:52.300
> 
> 标签：php, wordpress, symfony

我一直在研究它并尝试它，但我有点难过。

我想在 WordPress 中建立一个站点，这对另一个和我一起工作的人很有帮助。该网站将宣传我们的产品并提供信息。然后用户可以通过一系列表格进行注册。我想在 Symfony2 中编写这个自定义部分（表单等），因为它不需要绑定到 WordPress，并且在用户注册后它会有可重用的 Doctrine2 实体来显示数据（无论如何显示都发生在 WordPress 之外） ）。

但是，在设计方面，我们希望整个过程不会中断并且具有相同的外观和感觉。所以表单实际上应该在 WordPress 页面中呈现。我们正在使用一个自定义的、非免费的主题，我不想只是将一堆 WordPress CSS 和标题复制粘贴到 Symfony 视图中。

理想情况下，我只想在 WordPress 中定义可以呈现 Symfony2 操作的页面。因此，这些操作本身可能会显示和处理表单（应该独立于 WordPress 工作，例如[http://example.com/app.php/signup](http://example.com/app.php/signup)），但它们通常应该显示在 WordPress 站点中（例如在类似的页面中）[http://example.com/index.php?page_id=2](http://example.com/index.php?page_id=2)或永久链接）。

我一直在研究 LowPress 作为一种集成方式 (http://www.lowpress.com/)，但通过完全删除 WordPress 主题并用 Twig 主题替换它们，它比我想要的要多。我试图从中借鉴一些想法，所以现在我在`web`Symfony 项目的文件夹中有 WordPress，并且在我的`wp-config.php`：

```
// ...code omitted
define('WP_DEBUG', true);

define('SYMFONY_DIR', __DIR__.'/../app/');

require_once SYMFONY_DIR.'/bootstrap.php.cache';
require_once SYMFONY_DIR.'/AppKernel.php';
//require_once SYMFONY_DIR.'/AppCache.php';

use Symfony\Component\EventDispatcher\Event;
use Symfony\Component\HttpFoundation\Request;

$kernel = new AppKernel((WP_DEBUG) ? 'dev' : 'prod', WP_DEBUG);
$kernel->loadClassCache();
$kernel->boot();
$GLOBALS['sf2_kernel'] = $kernel;
// save request before WordPress messes with it
$GLOBALS['sf2_request'] = Request::createFromGlobals();

$doctrine = $kernel->getContainer()->get('doctrine');
$conn = $doctrine->getConnection($doctrine->getDefaultConnectionName());

// ** MySQL settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define('DB_NAME',       $conn->getDatabase());

/** MySQL database username */
define('DB_USER',       $conn->getUsername());

/** MySQL database password */
define('DB_PASSWORD',   $conn->getPassword());

/** MySQL hostname */
define('DB_HOST',       $conn->getHost());

/** Database Charset to use in creating database tables. */
define('DB_CHARSET', 'utf8');

/** The Database Collate type. Don't change this if in doubt. */
define('DB_COLLATE', '');

// ...code omitted 
```

所以我现在所拥有的只是通过`parameters.ini`Symfony 中的共享数据库配置。接下来我一直在尝试制作一个使用简码的简单插件，这样我就可以在 WordPress 页面中呈现 Symfony2 操作。到目前为止，这是我的一个想法（它取决于上面的引导，它是不完整的）：

```
use Symfony\Component\HttpFoundation\Request;

class Symfony2Page
{
    public function render($atts)
    {
        extract(shortcode_atts(array(
            'controller' => 'CroltsMainBundle:Default:index',
        ), $atts));
        $kernel = $GLOBALS['sf2_kernel'];
        $request = $GLOBALS['sf2_request'];
        $request->headers->set('X-Php-Ob-Level', ob_get_level());
        $attributes = array();
        // @TODO fix this

        $kernel->getContainer()->enterScope('request');
        $kernel->getContainer()->set('request', $request, 'request');

        try {
            $response = $kernel->getContainer()->get('http_kernel')->render($controller, $attributes)->getContent();
        } catch (\Exception $e) {
            $kernel->getContainer()->leaveScope('request');

            throw $e;
        }

        $kernel->getContainer()->leaveScope('request');

        return $response;
    }
}

add_shortcode('sf_action', array('Symfony2Page', 'render')); 
```

我的第一个问题是我不知道如何实际渲染一些可能有参数的 Symfony2 路由，而给定的路由`$request`没有我需要的信息。另一个问题是，如果我想提交表单，它可能无法工作，因为它会将用户重定向到 WordPress 之外，而实际上我可能想要一系列都存在于 WordPress 页面中的表单。同时，我希望表单独立于 WordPress，以便它们独立工作。

所以我想知道这是否只是一个行不通的坏主意/骇人听闻的想法，或者是否有某种方法可以让它发挥作用。

我还考虑使用 AJAX 在 WordPress 中加载 Symfony2 代码（假设我所有的用户都启用了 Javascript）。作为后备，该页面可以仅转到仅 Symfony2 的应用程序，而不是位于 WordPress 页面中。那会更好/更容易吗？我能看到的唯一缺点是我必须让 ajax 代码与我的 Symfony2 代码保持同步。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-24T12:24:59.293

由于您不想“..只是将一堆 WordPress CSS 和页眉复制粘贴到 Symfony 视图中”，我建议您以编程方式将 WordPress 页眉和页脚嵌入到所有 Symfony 视图中。

还可以看看[Silex](http://silex.sensiolabs.org/)，因为它的开销比 Symfony 低，并且适用于 Symfony 表单。

1.  安装 Symfony2 或 Silex
2.  将 WordPress 文件放在您的 web/ 文件夹中
3.  wp-config.php 可以在 composer.json 旁边放置一个文件夹，[无论如何这对安全性更好](https://wordpress.stackexchange.com/questions/58391/is-moving-wp-config-outside-the-web-root-really-beneficial)
4.  将您的 Symfony 或 Silex 前端控制器移动到一个子文件夹，在您的情况下可能命名为 signup/
5.  修复前端控制器顶部的 require / include 路径
6.  在前端控制器的顶部添加一行以包含父文件夹中的 wp-load.php - 此文件启动 WordPress 并使所有 WordPress 功能对您可用 - 请注意，它必须包含在全局范围内，而不是从函数内部
7.  在您的前端控制器中调用 WordPress 方法`get_header();`和`get_footer();`Symfony 或 Silex 代码的上方和下方。在 Silex 中，就在上面和下面`$app->run();`

您的文件结构应如下所示：

```
vendor/
  |-- Third party libraries 
web/
  |-- WordPress files
  |-- signup/
       |-- Symfony2 or Silex front controller
composer.json
wp-config.php 
```

受这篇[文章的](http://wpengineer.com/1038/embed-wordpress-functions-outside-wordpress/)启发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-22T07:25:24.597

Symfony 2 允许使用框架的一部分而不使用整体。

该表单是一个可拆卸的组件，您可以在此处找到：

[http://symfony.com/components](http://symfony.com/components)

可悲的是，还没有太多文档，因此您必须自己发现它...

编辑：路由等也是如此。如果您希望能够使用 symfony 路由来识别路径/要做的事情，您必须包含 HttpFoundation 组件，显然还有路由。

# jquery - jQuery Animate 方法 - 持续时间不起作用

> ID：10843416
> 
> 赞同：0
> 
> 时间：2012-06-01T01:43:02.600
> 
> 标签：jquery, scroll, duration

我有一个 jQuery 滚动设置，但持续时间不能正常工作。在 Wordpress 网站的“关于页面”上，我想使用 jQuery，以便在单击照片时，它会向下滚动到相应的 div。滚动正在工作，但是，持续时间不是。滚动大约需要 1/4 秒，我设置持续时间的速度无关紧要。我所指的网站可以在以下位置看到：[http ://teamcoding.ca/corporate/about-test/](http://teamcoding.ca/corporate/about-test/)

下面是 jQuery 滚动的源代码。

```
$(function(){
    $('a[href*=.staff_photos_indiv]').click(function() {
        if (location.pathname.replace(/^\//,") == this.pathname.replace(/^\//,") && location.hostname == this.hostname) {
            var $target = $target;
            $target = $(this.hash);
            $target = $target.length && $target || $('[name=' + this.hash.slice(1) +']');
            if ($target.length) {
                var targetOffset = $target.offset().top;
                $('html,body').animate({scrollTop: targetOffset}, {easing:'easeInOutExpo',duration:1600});
                return false;
            }
        }
    }); 
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:01:26.897

我的猜测是您没有`'easeInOutExpo'`定义缓动函数，因为一般操作适用于以下代码：

```
$(document.body).animate(
    {scrollTop: "400px"}, {easing: "swing", duration: 1600}
); 
```

而且，您可以在这里看到它的工作原理：http: [//jsfiddle.net/jfriend00/UbnUh/](http://jsfiddle.net/jfriend00/UbnUh/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:53:22.817

您在 jQuery 选择器中有错误。

`Uncaught Error: Syntax error, unrecognized expression: [href*=.staff_photos_indiv]`

这就是为什么`click`事件甚至没有触发。你所看到的只是`a href="#...`以正常方式行事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T01:58:39.427

调试的方法是在chrome中打开页面，右键单击并选择最后一个菜单选项“Inspect Element”。

选择右侧最后一个选项卡，控制台，您将看到 JavaScript 中是否存在任何错误：

```
Uncaught Error: Syntax error, unrecognized expression: [href*=.staff_photos_indiv] 
```

相反，尝试一个更简单的选择器：

```
$('.staff_photos_indiv').click( ... 
```

# android - 使用 ZXing 在 Android 中提取二维码返回类型

> ID：10843417
> 
> 赞同：0
> 
> 时间：2012-06-01T01:43:04.020
> 
> 标签：android, qr-code

我有一个应用程序，可以通过向 ZXing 制作的 Barcode Scanner App 发送 Intent 来成功检索 QR 码返回的数据。

但是，我想通过能够破译二维码的格式是否是电话号码来使应用程序变得更好。是否也可以获取二维码的格式（即URL、SMS、电话号码、文本）？

我需要这个，因为我不希望像创建自己的二维码这样的漏洞来扫描。我为被要求创建的系统创建的二维码具有电话号码格式。人们可能能够伪造以文本为格式的二维码。我希望应用程序能够区分格式，这样可以避免这种情况。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T10:07:44.170

如果你真的是指条形码格式，这也会在`Intent`. 看看额外的`SCAN_RESULT_FORMAT`，它会有一个像“QR_CODE”这样的字符串。这些是枚举值的名称`BarcodeFormat`。

如果您的意思是要像 Barcode Scanner 那样解析扫描结果，请`ResultParser`使用`core/`.

不过，我看不出这会如何阻止您制作自己的条形码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-01-21T14:25:21.077

尝试使用这个：

```
String codeType = ResultParser.parseResult(result).getType().toString(); 
```

该`ResultParser`课程将为您提供 QR 码结果的类型，即：URL、TEXT、MSG 等。

您可以使用以下代码来比较类型：

```
if(ResultParser.parseResult(result).getType() == ParsedResultType.ADDRESSBOOK) {
    // Implement your logic
} 
```

相反，总是感谢您使用枚举类型而不是字符串，即使用 `ParsedResultType.ADDRESSBOOK`而不是`String type = "addressbook"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T06:59:32.490

您可以使用以下方式获取二维码类型：

```
String type = resultHandler.getResult().getType().toString(); 
```

这为您提供了 QR 码的类型。例如 URI、TEL、SMS 等。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-06-01T04:13:34.620

我会使用正则表达式来测试格式。根据您要测试的字符串类型，网上应该有大量示例。以下是有关正则表达式的更多信息：[http](http://www.regular-expressions.info/reference.html) ://www.regular-expressions.info/reference.html Java (Android) 具有内置的正则表达式函数（“matcher”和“pattern”）

# c# - 从 Modal PopUp Extender 获取 Dynamic Textboxes 的值

> ID：10843419
> 
> 赞同：0
> 
> 时间：2012-06-01T01:43:36.587
> 
> 标签：c#, asp.net, gridview, textbox, modalpopupextender

我有一个 Modal Popup Extender(MPE) ，它具有动态构建的文本框，取决于用户输入的数量，例如用户输入“6”然后在 MPE 中生成 6 个文本框，现在我的问题是，如何我要获得这些文本框的价值并将其放入 gridview 吗？

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T09:19:58.690

将生成的每个文本框的值放入数组或字符串列表中，然后将其放入 ViewState 中，然后从代码中访问它们。

# php - 将节点导入 DOMDocument 现有命名空间

> ID：10843424
> 
> 赞同：2
> 
> 时间：2012-06-01T01:44:21.740
> 
> 标签：php, domdocument, xml-namespaces

我正在尝试使用 php 动态创建 xml 模式，但我在使用命名空间时遇到了问题。我想要做的是有一个函数返回 xsd:elements 并将它们添加到 xsd:sequence 节点。

我在函数的临时 DOMDocument 中创建 xsd:element 节点，我需要指定 xsd 命名空间 "xmlns:xsd="http://www.w3.org/2001/XMLSchema" 否则 'xsd:' 位是删除。然后我从临时文档中提取所需的节点并使用 importNode() 复制到存在的 DOMDocument。问题是完整的 xmlns 字符串附加到从创建元素的函数返回的每个节点上。

初始 DOMDocument

```
<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <xsd:complexType name="UserType">
    <xsd:sequence>
    // add elements here
    </xsd:sequence>
 </xsd:complexType>
</xsd:schema> 
```

我用来收集字段的临时 DOMDocument

```
<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <xsd:element type="xsd:string" name="Field1"/>
    <xsd:element type="xsd:string" name="Field2"/>
    <xsd:element type="xsd:string" name="Field3"/>
</xsd:schema> 
```

我得到了什么

```
<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"/>
  <xsd:complexType name="UserType"/>
    <xsd:sequence/>
      <xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" type="xsd:string" name="Field1"/>
      <xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" type="xsd:string" name="Field2"/>
      <xsd:element xmlns:xsd="http://www.w3.org/2001/XMLSchema" type="xsd:string" name="Field3"/>
    </xsd:sequence/>
  </xsd:complexType/>
</xsd:schema/> 
```

如何导入现有的命名空间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T06:01:30.493

我需要做的是确保我在第一个 DOMDocument 中创建了**_ *ALL* _元素：**

```
createElementNS('http://www.w3.org/2001/XMLSchema','xsd:sequence') 
```

而不是：

```
createElement('xsd:sequence') 
```

我只是在需要 xmlns 声明的第一个元素上使用 createElementNS 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T04:32:20.623

似乎工作？ [http://codepad.viper-7.com/SueilL](http://codepad.viper-7.com/SueilL)

```
<?php header('content-type: text/plain;charset=utf-8'); 

$s1 = '<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <xsd:complexType name="UserType">
    <xsd:sequence>
    </xsd:sequence>
 </xsd:complexType>
</xsd:schema>

';
$s2 = '<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <xsd:element type="xsd:string" name="Field1"/>
    <xsd:element type="xsd:string" name="Field2"/>
    <xsd:element type="xsd:string" name="Field3"/>
</xsd:schema>
';

$ns = 'http://www.w3.org/2001/XMLSchema';

$doc = new DOMDocument();
$doc->loadXML($s1);
$seqElem = $doc->getElementsByTagNameNS($ns, "sequence")->item(0);

$d = new DOMDocument();
$d->loadXML($s2);
foreach ($d->getElementsByTagNameNS($ns, "*") as $e) {
    $seqElem->appendChild($doc->importNode($e));
}

echo $doc->saveXML(); 
```

# grails - 一个与多个复选框

> ID：10843425
> 
> 赞同：0
> 
> 时间：2012-06-01T01:44:31.557
> 
> 标签：grails, params

我想有一些`<g:checkBox name="bob" value="${i}" />`形式并在它们中迭代`params`：

```
def blah = params.bob.collect { Bob.get(it) } 
```

当表单上有多个复选框并选中时，它似乎工作正常（`params.bob`是`List`某种类型的）。但是，如果表单上只显示一个复选框并且选中`params.bob`的是 a`String`而不是其中`List`包含一个`String`的 a。

处理这个问题的最佳方法是什么？我现在正在做这样的事情：

```
if (params.bob instanceof String) {
    blah = [Bob.get(params.bob)]
}
else {
    blah = params.bob.collect { Bob.get(it) }
} 
```

有没有办法强制`params`做一个`List`for`bob`这样我就不必这么讨厌了`if`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T04:11:45.863

您是否尝试过：`params.list('bob')` [请参阅处理多参数](http://grails.org/doc/latest/guide/theWebLayer.html#typeConverters)

# android - Restlet一遍又一遍地重新启动内部http客户端

> ID：10843426
> 
> 赞同：2
> 
> 时间：2012-06-01T01:44:48.393
> 
> 标签：android, performance, http, restlet

我正在使用带有 的 Restlet 2.1 RC 4 `org.restlet.ext.httpclient`，`org.restlet.ext.jackson`并`org.restlet.ext.json`从远程服务器获取数据。但是，对于仅 6 个对象，通过房屋内的无线数据连接需要 6 秒。

如您所见，除了 GC 之外，还有许多消息，例如`Starting the internal [HTTP/1.1] client`和`Stopping the internal[HTTP/1.1] client`。这对应于需要花费大量时间的大型 GC。

```
06-01 03:21:46.913: RestletTrip(2653): Querying: [SOMEURL/SOMENUMBER]
06-01 03:21:46.933: I/org.restlet(2653): Starting the internal [HTTP/1.1] client
06-01 03:21:47.053: D/dalvikvm(2653): GC_CONCURRENT freed 708K, 34% free 9214K/13831K, external 576K/1020K, paused 3ms+3ms
06-01 03:21:47.053: I/org.restlet(2653): Stopping the internal[HTTP/1.1] client
06-01 03:21:47.103: D/dalvikvm(2653): GC_FOR_MALLOC freed 4924K, 61% free 5523K/13831K, external 576K/1020K, paused 31ms
06-01 03:21:47.173: D/dalvikvm(2653): GC_CONCURRENT freed 95K, 53% free 6574K/13831K, external 576K/1020K, paused 2ms+3ms
06-01 03:21:47.253: D/dalvikvm(2653): GC_CONCURRENT freed 46K, 43% free 8012K/13831K, external 576K/1020K, paused 2ms+3ms
06-01 03:21:47.734: I/global(2653): Loaded time zone names for en_US in 397ms.
06-01 03:21:48.014: RestletTrip(2653): Querying: [SOMEURL/SOMENUMBER]
06-01 03:21:48.124: D/dalvikvm(2653): GC_CONCURRENT freed 1225K, 38% free 8688K/13831K, external 576K/1020K, paused 3ms+3ms
06-01 03:21:48.124: I/org.restlet(2653): Stopping the internal[HTTP/1.1] client
06-01 03:21:48.134: I/org.restlet(2653): Starting the internal [HTTP/1.1] client
06-01 03:21:48.184: D/dalvikvm(2653): GC_FOR_MALLOC freed 5022K, 62% free 5341K/13831K, external 576K/1020K, paused 31ms
06-01 03:21:48.244: D/dalvikvm(2653): GC_CONCURRENT freed 96K, 55% free 6307K/13831K, external 576K/1020K, paused 2ms+3ms
06-01 03:21:48.314: D/dalvikvm(2653): GC_CONCURRENT freed 44K, 45% free 7663K/13831K, external 576K/1020K, paused 3ms+4ms
06-01 03:21:48.795: I/global(2653): Loaded time zone names for en_US in 405ms.
06-01 03:21:49.015: D/dalvikvm(2653): GC_CONCURRENT freed 695K, 37% free 8736K/13831K, external 576K/1020K, paused 3ms+3ms
06-01 03:21:49.155: RestletTrip(2653): Querying: [SOMEURL/SOMENUMBER]
06-01 03:21:49.165: I/org.restlet(2653): Starting the internal [HTTP/1.1] client
06-01 03:21:49.225: D/dalvikvm(2653): GC_FOR_MALLOC freed 672K, 30% free 9778K/13831K, external 576K/1020K, paused 34ms
06-01 03:21:49.225: I/org.restlet(2653): Stopping the internal[HTTP/1.1] client
06-01 03:21:49.265: D/dalvikvm(2653): GC_FOR_MALLOC freed 4902K, 61% free 5637K/14343K, external 576K/1020K, paused 32ms
06-01 03:21:49.325: D/dalvikvm(2653): GC_CONCURRENT freed 97K, 54% free 6703K/14343K, external 576K/1020K, paused 3ms+4ms
06-01 03:21:49.395: D/dalvikvm(2653): GC_CONCURRENT freed 54K, 44% free 8167K/14343K, external 576K/1020K, paused 3ms+3ms
06-01 03:21:49.876: I/global(2653): Loaded time zone names for en_US in 407ms.
06-01 03:21:50.136: RestletTrip(2653): Querying: [SOMEURL/SOMENUMBER]
06-01 03:21:50.156: I/org.restlet(2653): Starting the internal [HTTP/1.1] client
06-01 03:21:50.236: D/dalvikvm(2653): GC_CONCURRENT freed 1295K, 38% free 8905K/14343K, external 576K/1020K, paused 3ms+4ms
06-01 03:21:50.236: I/org.restlet(2653): Stopping the internal[HTTP/1.1] client
06-01 03:21:50.286: D/dalvikvm(2653): GC_FOR_MALLOC freed 4991K, 61% free 5636K/14343K, external 576K/1020K, paused 32ms
06-01 03:21:50.346: D/dalvikvm(2653): GC_CONCURRENT freed 52K, 53% free 6748K/14343K, external 576K/1020K, paused 2ms+4ms
06-01 03:21:50.386: D/dalvikvm(2653): GC_FOR_MALLOC freed 50K, 43% free 8249K/14343K, external 576K/1020K, paused 30ms
06-01 03:21:50.867: I/global(2653): Loaded time zone names for en_US in 400ms.
06-01 03:21:51.107: RestletTrip(2653): Querying: [SOMEURL/SOMENUMBER]
06-01 03:21:51.127: I/org.restlet(2653): Starting the internal [HTTP/1.1] client
06-01 03:21:51.207: D/dalvikvm(2653): GC_CONCURRENT freed 1290K, 38% free 9006K/14343K, external 576K/1020K, paused 2ms+4ms
06-01 03:21:51.207: I/org.restlet(2653): Stopping the internal[HTTP/1.1] client
06-01 03:21:51.257: D/dalvikvm(2653): GC_FOR_MALLOC freed 4937K, 60% free 5791K/14343K, external 576K/1020K, paused 32ms
06-01 03:21:51.317: D/dalvikvm(2653): GC_CONCURRENT freed 106K, 52% free 6900K/14343K, external 576K/1020K, paused 2ms+4ms
06-01 03:21:51.387: D/dalvikvm(2653): GC_CONCURRENT freed 54K, 42% free 8448K/14343K, external 576K/1020K, paused 3ms+4ms
06-01 03:21:51.868: I/global(2653): Loaded time zone names for en_US in 406ms.
06-01 03:21:52.118: RestletTrip(2653): Querying: [SOMEURL/SOMENUMBER]
06-01 03:21:52.128: I/org.restlet(2653): Starting the internal [HTTP/1.1] client
06-01 03:21:52.218: D/dalvikvm(2653): GC_CONCURRENT freed 1297K, 36% free 9198K/14343K, external 576K/1020K, paused 3ms+3ms
06-01 03:21:52.218: I/org.restlet(2653): Stopping the internal[HTTP/1.1] client 
```

我使用的代码是（为了更快理解而被剥离）：

```
public List<Trip> getTrips() {

    // All the ids for the different trips
    List<Long> ids = new ArrayList<Long>;
    ids.add(new Long(14));
    ids.add(new Long(45));
    ids.add(new Long(34));
    ids.add(new Long(11));
    ids.add(new Long(33));
    ids.add(new Long(17));

    // All the Trips
    List<Trip> result = new ArrayList<Trip>();

    for (Long tripID : ids) {
        Trip trip = getTrip(tripID);            

        // Add trip to the list
        if (trip != null) {
            result.add(trip);
        }
    }
    return result;
}

public Trip getTrip(ISettings settings, Long tripID) throws GetTripException, NoSuchElementException {

    // Create resource
    final TripsResource tripResource = getClientResource(ServerPaths.getTrip(tripID), TripsResource.class);

    // Get trip from server
    return tripResource.getTrip();
} 
```

我正在使用的引擎设置是

```
import org.restlet.engine.Engine;
import org.restlet.ext.httpclient.HttpClientHelper;
import org.restlet.ext.jackson.JacksonConverter;
import org.restlet.ext.json.JsonConverter;
import org.restlet.Client;
import org.restlet.data.Protocol;

protected void setupEngine() {
    final Engine engine = Engine.getInstance();

    engine.getRegisteredClients().add(new HttpClientHelper(new Client(Protocol.HTTP)));
    engine.getRegisteredConverters().add(new JacksonConverter());
    engine.getRegisteredConverters().add(new JsonConverter());
} 
```

因此，由于 GC，检索速度非常慢。我怎样才能提高性能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T07:16:51.623

您确实在一遍又一遍地重新创建 HTTP 客户端连接器。

解决方案是创建一个实例： myClient = new Client(Protocol.HTTP);

然后，为您通过 myClientResource.setNext(myClient) 创建的每个 ClientResource 设置它；

顺便说一句，如果您使用的是父 Restlet 组件和应用程序，这将自动为您完成。

# javascript - Javascript 正则表达式中的 [^] 是什么意思？

> ID：10843428
> 
> 赞同：18
> 
> 时间：2012-06-01T01:45:21.930
> 
> 标签：javascript, regex

`[^a]`表示除 之外的任何字符`a`，我们知道，但是`[^]`（没有以下字符）是什么意思？就像`-`在诸如 的情况下失去其字符范围的含义一样`[-]`，我认为这`[^]`将匹配插入符号。我花了太长时间调试这个问题，才发现至少在 Chrome 19 中它似乎匹配任何东西——换句话说，相当于`.`. 这里是否有适用的规范或预期的行为是什么？

是的，我知道我可以并且可能应该使用`[\^]`. 这个问题更多地是病态的好奇心。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-01T02:29:08.180

根据 JavaScript 规范（ES3 和 ES5），`[^]`匹配任何单个代码单元，与`[\s\S]`, `[\0-\uffff]`,相同`(.|\s)`（不要使用它；与其他不同，它依赖回溯）等。不同之处`.`在于点不' t 匹配四个换行代码点（`\r`、`\n`、`\u2028`和`\u2029`）。

我不建议使用`[^]`or `[]`，因为它们不能始终如一地跨浏览器工作，并且它们会阻止您的正则表达式在其他编程语言中工作。IE <= 8 和旧版本的 Safari 对空字符类使用传统的（非 JavaScript）正则表达式行为。旧版本的 Opera 反转了正确的 JavaScript 行为，因此它`[]`匹配任何代码单元并且`[^]`永远不会匹配。传统的正则表达式行为是将`]`字符类中的前导未转义字符视为文字字符并且不会结束字符类。

如果您使用[XRegExp](http://xregexp.com/)库，`[]`并且`[^]`可以正确且一致地跨浏览器工作。XRegExp 还添加了（又名 dotall 或 singleline）标志，使点匹配任何代码单元（与正确遵循 JavaScript 规范的浏览器中`s`的相同）。`[^]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T01:49:32.150

插入符号`^`有很多含义 - 与正则表达式语法中的大多数字符一样。此外，所有角色都严重依赖于他们的上下文。更复杂的是，一些字符和语法依赖于底层引擎（Perl、Java）。

让我们分开`[^]`：

`[]`是一个字符类。

`[^`是个：

> 字符类的否定，匹配字符类中未列出的字符。

您**没有**在字符类中定义任何字符。~~所以行为是*未定义*~~的。这意味着没有*什么*可以否定的，因此它匹配*任何东西*。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T01:48:38.703

意思是对后面的否定。因此，这里没有任何内容：

> 除了什么都没有=一切

但是，大多数其他 RegEx 引擎在表达式中抛出错误：

*   `ereg(): REG_EBRACK`
*   `preg_match(): Compilation failed: missing terminating ]`

# delphi - Delphi VirtualKey 到 WideString

> ID：10843429
> 
> 赞同：3
> 
> 时间：2012-06-01T01:45:32.943
> 
> 标签：delphi, winapi, keyboard, delphi-7

我想将虚拟键转换为 WideString。这就是我到目前为止...

```
function VKeytoWideString (Key : Word) : WideString;
var
 WBuff         : array [0..255] of WideChar;
 KeyboardState : TKeyboardState;
 UResult       : Integer;
begin
 GetKeyBoardState (KeyboardState);
 UResult := ToUnicode(key, MapVirtualKey(key, 0), KeyboardState, WBuff, 0,0);
 Result  := WBuff;
 case UResult of
  0 : Result := '';
  1 : SetLength (Result, 1);
  2 :;
  else
   Result := '';
 end;
end; 
```

它总是返回 0 但为什么呢？请帮忙。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T01:58:08.413

您将`cchBuff`参数 of设置`ToUnicode()`为 0 而不是实际缓冲区大小，因此该函数无法存储它转换的任何字符。

试试这个：

```
function VKeytoWideString (Key : Word) : WideString; 
var 
  WBuff         : array [0..255] of WideChar; 
  KeyboardState : TKeyboardState; 
  UResult       : Integer;
begin 
  Result := '';
  GetKeyBoardState (KeyboardState); 
  ZeroMemory(@WBuff[0], SizeOf(WBuff));
  UResult := ToUnicode(key, MapVirtualKey(key, 0), KeyboardState, WBuff, Length(WBuff), 0); 
  if UResult > 0 then
    SetString(Result, WBuff, UResult)
  else if UResult = -1 then
    Result := WBuff;
end; 
```

# python - 如何制作“功能字典”？

> ID：10843430
> 
> 赞同：1
> 
> 时间：2012-06-01T01:45:41.373
> 
> 标签：python, syntax, programming-languages

我有很多函数，如果我有一个数组，`[echo, "Bob is Good"]`我想用整个数组的参数运行 echo 函数。因此，它`arr[0]`使用整个数组的参数获取并运行该函数。现在我只有 if 语句，例如：

```
...
elif arr[0] == 'echo':
    echo(arr)
elif arr[0] == 'var':
    var(arr) 
```

另外，最好现在我的函数设置为 cmd 前缀。例如，echo 函数将被称为 echocmd，所以如果有一种方法可以实现它，那就太好了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T01:47:33.570

显而易见的方式。

```
funcdict = {
  'echo': echocmd,
  'var': varcmd,
   ...
}

 ...

funcdict.get(arr[0], invalidcmd)(arr) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T01:53:27.710

您可以将函数直接存储在列表中（它们不是数组；在 Python 中，这意味着不同的东西）：

```
def echocmd(foo, bar, baz):
    print foo, bar, baz # for testing

my_data = [echocmd, 'spam', 'and', 'eggs']
my_data[0](*my_data[1:]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T01:53:34.413

两种方式：

*   传递一个代表值，即与您要运行的函数相对应的字符串或整数。使用字典将该值索引到实际函数。

*   传递对实际函数的引用，并使用该引用来调用它。

第二个更通用 - 你可以组成你喜欢的任何功能并传递它。第一个可以让您“沙箱”您的解释器，限制允许的功能，并且还可能更容易在外部存储。

# ajax - json和淘汰赛

> ID：10843433
> 
> 赞同：1
> 
> 时间：2012-06-01T01:46:17.453
> 
> 标签：ajax, json, knockout.js

我有一个“应该”与 json 结果绑定的表，但它不起作用，可能是什么错误？

```
<table>
<thead>
    <tr>
        <th>
            Id
        </th>
        <th>
            Number
        </th>
        <th>
            Name
        </th>
        <th>
            Password
        </th>
        <th>
            Role
        </th>
    </tr>
</thead>
<tbody data-bind="foreach: model.Employees">
    <tr>
        <td>
            <span data-bind="text: EmployeeId"></span>
        </td>
        <td>
            <span data-bind="text: EmployeeNumber"></span>
        </td>
        <td>
            <span data-bind="text: EmployeeName"></span>
        </td>
        <td>
            <span data-bind="text: EmployeePassword"></span>
        </td>
        <td>
            <span data-bind="text: EmployeeRole"></span>
        </td>
    </tr>
</tbody> 
```

我的淘汰赛脚本是这样的：

```
<script type="text/javascript">
$(document).ready(function () {
    var viewModel = {};
    var data = $.getJSON("Employees.json", function (data) {
        viewModel= ko.mapping.fromJSON(data);
        ko.applyBindings(viewModel);
    }
    );
});
</script> 
```

这是我返回的 json 数据示例：

```
 {"Employees":[{"EmployeeId":1,"EmployeeName":X","EmployeeNumber":"1","EmployeePassword":"x","EmployeeRole":"User"},{"EmployeeId":10,"EmployeeName":"S","EmployeeNumber":"21","EmployeePassword":"s","EmployeeRole":"Admin"}]} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T02:03:49.433

如果您打开浏览器的错误控制台，我敢打赌您会看到如下内容：

> 未捕获的错误：无法解析绑定。消息：ReferenceError：未定义员工；绑定值：foreach：员工

`Employees`上没有定义`viewModel`。但是，它是在 上定义的`viewModel.model`。如果您有以下任何一种情况，事情应该会奏效：

1.  `data-bind`foreach`model.Employees`改为：

    ```
    <tbody data-bind="foreach: model.Employees"> 
    ```

    **示例：http:** [//jsfiddle.net/Ze2Zs/](http://jsfiddle.net/Ze2Zs/)

2.  将 AJAX 请求的结果直接分配给`viewModel`而不是`viewModel.model`：

    ```
    viewModel = ko.mapping.fromJSON(data); 
    ```

    **示例：http:** [//jsfiddle.net/wHXeP/](http://jsfiddle.net/wHXeP/)

`var data = $.getJSON(...)`另外作为旁注，由于响应由回调函数处理，因此无需分配：

```
var viewModel = {};
$.getJSON("Employees.json", function (data) {
    viewModel.model = ko.mapping.fromJSON(data);
    ko.applyBindings(viewModel);
}); 
```

# c - getdomainname() 在 MPI 下返回错误地址（测试 PETSc 库）

> ID：10843436
> 
> 赞同：1
> 
> 时间：2012-06-01T01:46:39.760
> 
> 标签：c, macos, mpi, mpich, unistd.h

我正在尝试在我的笔记本电脑（MacBook Pro 10.5.8，MPICH2-1.1）上安装 PETSc-3.2，并且在运行测试时遇到了一些困难：它从`getdomainname()`返回错误地址的系统调用中出错。

```
[-1]PETSC ERROR: --------------------- Error Message ------------------
[-1]PETSC ERROR: Error in system call!
[-1]PETSC ERROR: getdomainname()!
[-1]PETSC ERROR: ------------------------------------------------------ 
```

为了进行调查，我编写了以下测试代码来检查`getdomainname()`使用和不使用 MPI 的功能：

单处理器：

```
#include <unistd.h>
#include <stdio.h>
#include <errno.h>
#include <string.h>
#include <limits.h>
#include <stdlib.h>

int main(int argc, char **argv)
{
  char *name;
  int namelen = CHAR_MAX;
  name = (char*) calloc (namelen,sizeof(char));
  int err = getdomainname(name,namelen);
  printf("%s\n",strerror(errno));
  printf("Domain name: %s\n",name);
  return err;
} 
```

平行线：

```
/* Headers */
#include "mpi.h"

int main(int argc, char **argv)
{
  MPI_Init(&argc,&argv);

  int myrank;
  char *mpi_name;
  int mpi_namelen = MPI_MAX_PROCESSOR_NAME;
  mpi_name = (char*) calloc (mpi_namelen,sizeof(char));

  MPI_Comm_rank(MPI_COMM_WORLD,&myrank);
  int mpi_err = MPI_Get_processor_name(mpi_name,&mpi_namelen);
  printf("MPI_Get_processor_name [%d]: %s\n",mpi_err,mpi_name);

  char *name;
  int namelen = CHAR_MAX;
  name = (char*) calloc (namelen,sizeof(char));
  int err = getdomainname(name,namelen);
  printf("%s\n",strerror(errno));
  printf("Domain name: %s\n",name);
  return err;

  MPI_Finalize();
} 
```

单处理器代码正常工作，并行代码获取处理器的正确名称，但在调用时返回错误地址，`getdomainname()`即使使用`mpirun -np 1`.

有没有人遇到过这样的问题？是否需要进行某种配置，`mpirun`以便为 MPI 生成的每个进程设置域名？提前致谢！

# 更新：

对于那些使用 PETSc 遇到此问题的人，请使用选项`--with-debugging=0`. 似乎在一些 PETSc 调试消息等中，他们使用调用`getdomainname()`而不是`MPI_Get_processor_name()`. 在不调试的情况下编译会禁用库中的这个分支。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T13:29:27.620

尝试更新版本的 MPICH2，1.1 很旧。除非您要求，否则当前版本不应添加任何`-m32`/`-m64`参数。`mpicc`（我也不确定旧版本是否这样做，但这是可能的）

# apache - mod_rewrite 出现 403 错误

> ID：10843437
> 
> 赞同：0
> 
> 时间：2012-06-01T01:46:41.623
> 
> 标签：apache, mod-rewrite, http-status-code-403

我有一个看起来像这样的 .htaccess 文件。如果文件或目录存在并且也生成了 403 错误，我想做的是将请求传递到 index.php。

也就是说，如果服务器上存在“/foo/bar”，但生成了 403，我希望将“/foo/bar”传递到 index.php，就好像目录“/foo/bar”不存在一样服务器。

可能的？

```
<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /

  #Make sure the physical file doesn't exist
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d

  RewriteRule . /index.php [L]
</IfModule> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T02:17:15.263

错误条件的处理是通过 执行的[`ErrorDocument`](http://httpd.apache.org/docs/2.2/mod/core.html#errordocument)。

# php - PHP - 减少字符串 ID

> ID：10843439
> 
> 赞同：0
> 
> 时间：2012-06-01T01:47:14.280
> 
> 标签：php, string

我在减少字符串 ID 时遇到问题。情况是这样的：

```
// given $row[0]['orderid'] = "ORD00389" (varchar)
$nextID = $row[0]['orderid'];
$prevID = $row[0]['orderid'];
$nextID++; // echo 'ORD00390'
$prevID--; // echo 'ORD00388' 
```

到目前为止，我学到的是这段可爱的段落：

> PHP 在处理字符变量而不是 C 的算术运算时遵循 Perl 的约定。例如，在 PHP 和 Perl 中 $a = 'Z'; $a++; 将 $a 变成 'AA'，而在 C 中 a = 'Z'; 一个++；将 a 转换为 '['（'Z' 的 ASCII 值是 90，'[' 的 ASCII 值是 91）。请注意，字符变量可以递增但不能递减，即使如此，也仅支持纯 ASCII 字符（az 和 AZ）。增加/减少其他字符变量没有效果，原字符串不变。

有没有有效的方法（内置函数）来减少 PHP 中的字符串？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T01:49:55.360

如果每次可以摆脱 ORD 时它都以 ORD 结尾，则减 1，然后将其重新组合在一起。

```
$id_num = intval( str_replace( 'ORD', '', $str ) );
$nextID = 'ORD' . ($id_num+1);
$prevID = 'ORD' . ($id_num-1); 
```

如果不是每次都以 ORD 开头，则可以替换所有非数字

```
$id_num = intval( preg_replace( '~\D~', '', $str ) ); 
```

# objective-c - 访问不同类中的 sqlite3 变量

> ID：10843453
> 
> 赞同：0
> 
> 时间：2012-06-01T01:49:21.940
> 
> 标签：objective-c, database, sqlite, global-variables

我的项目中有多个课程。当应用程序启动时，会在应用程序委托中创建一个数据库。我需要在另一个类中访问这个数据库，所以我在这个另一个类中创建了一个应用程序委托的对象（称为委托）。通常，要打开数据库，我会做类似的事情

```
if(sqlite3_open([Delegate.databasePath UTF8String], &database) == SQLITE_OK) 
```

但是，在这种情况下，变量数据库是全局的并且不在其父类中。在这种情况下如何打开我的数据库？我试过了

```
if(sqlite3_open([Delegate.databasePath UTF8String], &Delegate->database) == SQLITE_OK) //error: instance variable  database is protected 
```

和

> if (sqlite3_open([Delegate.databasePath UTF8String], &Delegate.database) == SQLITE_OK) //错误：请求的属性表达式的地址

但这些都不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:25:58.897

将您的数据库实例变量放在应用程序委托中或使用“单例模式”。

（但我猜你可能对“数据库”操作数的性质感到困惑。它`sqlite3 **`在方法声明中被声明为 a ，并且应该是`sqlite3 *`指针的地址。你传递参数的尝试被阻止了，因为 Objective- 的字段C类通常不是公共的，您不能获取属性的地址。对于您的情况，解决此问题的最简单（尽管有些粗略）的方法是使用一个方法来返回`sqlite3 *`变量的地址（例如，`return &mySqlite3Variable`）你的 Delegate 类存储它的任何地方。）

# php - 在此过程中上传文件而不会导致服务器端错误

> ID：10843454
> 
> 赞同：6
> 
> 时间：2012-06-01T01:49:25.263
> 
> 标签：php, upload

我不断地对我的软件进行调整并将其上传到服务器。由于我的客户一直在使用我的在线软件，如果当客户单击链接（例如在 1 秒标记处）时部分上传了 PHP 文件（假设上传需要 3 秒），他们会收到错误，因为文件还在上传中……

```
Parse error: syntax error, unexpected $end in /inc/functions.php on line 475 
```

当我在澳大利亚时，我们的互联网......嗯......“不是很快”是一种很好的表达方式。

上传文件时是否使用了任何技术，以免客户使用该软件时出错？

我唯一能做的就是上传文件到另一个目录，然后运行一个 PHP 脚本，以超快的速度复制文件……但是有更好的解决方案吗？

**最终代码**

感谢下面的格雷格，我能够找出做事的最佳方式。以为我会分享我的最终代码。这有点粗糙，但可以解决问题......希望它可以帮助某人

```
<?php

// root path
define('ABSPATH', dirname(__FILE__) . '/');

// messages
$GLOBALS['copied'] = array();
$GLOBALS['failed'] = array();
$GLOBALS['folders'] = array();

// you have to submit the form (added security)
if (isset($_POST['copy'])) {

    $GLOBALS['devuploads_folder'] = '_devuploads';

    function find_files($dir) {
        if ($dh = opendir(ABSPATH . $dir)) {
            while (($file = readdir($dh)) !== false) {

                // ignore files
                if ($file === '.' || $file === '..')
                    continue;

                // delete temporary files (optional)
                if ($file == '.DS_Store') {
                    unlink(ABSPATH . $dir . $file);
                    continue;
                }

                // determine paths                  
                $live_path = str_replace($GLOBALS['devuploads_folder'] . '/', '', $dir . $file);                
                $dev_file = $dir . $file;                   
                $live_file = $live_path;
                $dev_file_path = ABSPATH . $dir . $file;                    
                $live_file_path = ABSPATH . $live_path;

                // it's a file
                if (is_file(ABSPATH . $dir . $file)) {  

                    // check if the file has been updated or it's a brand newy
                    $updated_file = $new_file = false;
                    if (file_exists($live_file_path)) {                                 
                        $dev_file_modified = filemtime($dev_file_path);     
                        $live_file_modified = filemtime($live_file_path);                                               
                        if ($dev_file_modified > $live_file_modified)
                            $updated_file = true;                       
                    } else {
                        $new_file = true;
                    }

                    // move the file
                    if ($updated_file || $new_file) {
                        if (copy($dev_file_path, $dev_file_path . '.bak')) {
                            if (rename($dev_file_path . '.bak', $live_file_path))
                                if ($new_file)
                                    $GLOBALS['copied'][] = '<strong>New File:</strong> ' . $dev_file . ' moved to ' . $live_file;   
                                else
                                    $GLOBALS['copied'][] = $dev_file . ' moved to ' . $live_file;   
                            else
                                $GLOBALS['failed'][] = '<strong>Rename failed:</strong> ' . $dev_file . ' to ' . $live_file;
                        } else {
                            $GLOBALS['failed'][] = '<strong>Copy failed:</strong> ' . $dev_file . ' to ' . $dev_file . '.bak';
                        }
                    }

                // it's a folder
                } else if (is_dir(ABSPATH . $dir . $file)) {

                    // create new folder if it doesn't exist
                    if (!is_dir($live_file_path)) {
                        $GLOBALS['folders'][] = '<strong>Created:</strong> ' . $live_file;  
                        mkdir($live_file_path, 0755);   
                    }

                    // keep digging
                    find_files($dir . $file . '/');

                }

            }
            closedir($dh);
        }
    }

    find_files($GLOBALS['devuploads_folder'] . '/');

}

?>
<!DOCTYPE HTML>
<html>
<head>
    <title>Copy Changes</title>
    <style type="text/css">
    h1 {
        font: normal 20px Arial, Helvetica, sans-serif;
        line-height: 24px;
        }
    p, li {
        font: normal 14px Arial, Helvetica, sans-serif;
        line-height: 20px;
        }
    </style>
</head> 
<body>

<?php   
if (!empty($GLOBALS['failed'])) {
    echo '<h1>Errors</h1>';
    echo '<ul>';
    foreach($GLOBALS['failed'] AS $message) {
        echo '<li>' . $message . '</li>';
    }
    echo '</ul>';
}

if (!empty($GLOBALS['folders'])) {
    echo '<h1>New Folders</h1>';
    echo '<ul>';
    foreach($GLOBALS['folders'] AS $message) {
        echo '<li>' . $message . '</li>';
    }
    echo '</ul>';
}

if (!empty($GLOBALS['copied'])) {
    echo '<h1>Copied</h1>';
    echo '<ul>';
    foreach($GLOBALS['copied'] AS $message) {
        echo '<li>' . $message . '</li>';
    }
    echo '</ul>';
}

if (empty($GLOBALS['failed']) && empty($GLOBALS['folders']) && empty($GLOBALS['copied']))
    echo '<p>No updates made.</p>';
?>

<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
<input type="hidden" name="copy" value="1" />
<p><input type="submit" value="Copy Files" /></p>
</form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T01:51:25.807

如果您的服务器是 Linux（或其他 Unix 变体），那么该`mv`命令是*原子*的并且可以进行这种即时更新。先将文件复制到一个临时名称（如`file.php.new`），然后登录服务器并

```
mv file.php.new file.php 
```

（即使`file.php`存在也有效，它将被新的取代）。

# jquery - 如何使用 jQuery 对本地 Web 服务进行 RESTful 调用

> ID：10843459
> 
> 赞同：2
> 
> 时间：2012-06-01T01:50:03.350
> 
> 标签：jquery, ajax, rest

我是一个应用程序的开发者，除了它的主要用途之外，它还包含一个 RESTful Web 服务，以允许外部应用程序与之交互。我还提供了一个 Web UI 作为应用程序的一部分，用于配置和使用目的。我想使用内置的 Web 服务在 Web UI 和使用 ajax 调用的应用程序之间进行交互。问题是我不能在我的 jquery 代码中调用 Web 服务，因为用户可以从任何地方访问 Web UI，并且如果不手动编辑代码就不会知道 Web 服务的正确地址？有没有克服这个障碍的好方法？让 Web UI 通过 javascript 与应用程序的内置 Web 服务进行通信一定很常见。

这是我目前正在使用的 Web 服务调用的示例：

```
$.getJSON('http://localhost:8732/api/objects/type/place?callback=?', null, function (data) {
      //$('#callback').html(data);
      $("#callback").append('<ul id="places" data-role="listview" data-theme="g">');
      $.each(data,function(i,obj){
         $("#places").append('<li><a href="#" onclick="openPlace(\''+obj.Name+'\');" >'+obj.Name+'</a></li>');
      });
      $('#places').listview();
  }); 
```

如您所见，我刚刚将 localhost 作为 Web 服务的地址，但这仅在我从与服务相同的机器访问 Web UI 时才有效。我还有什么其他方法可以做到这一点？不要求助于使用某种服务器端脚本吗？这就是我希望通过使用 jquery 和 restful web 服务来避免的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T01:58:45.107

'localhost' 只是 127.0.0.1 的别名，它是您的本地计算机。您的计算机还有一个真实的 IP 地址，可以在您的本地网络上识别它。这可能看起来像 192.168.xx 您可以使用该计算机的实际地址与 Web 服务通信：

'http://192.168.xx:8732/api/objects/type/place?callback=?...'

（当然，这仅在您从同一网络连接到该计算机时才有效。）

如果您希望将其提供给“其他”人，您必须像发布网站一样发布您的网络服务..即从该路由器将端口转发到该计算机..并使用您的外部 IP 地址和/或 dns去打它。

**更新：**

你是如何提供 html 的？如果您的应用程序类似于路由器，其中管理界面是基于 Web 的，您可以保存/使用主机名并在您的服务调用中使用。连接到管理员 webapp 是您的客户的责任。所以他们可以使用 localhost、127.0.0.1、192.168.1.x、//someservername 或其他一些别名方法。您应该关心的只是主机？

```
var host = window.location.hostname;
$.getJSON('http://' + host + ':8732/api/objects/type/place?callback=?', ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T02:08:07.510

使用相对 URL 而不是绝对 URL。当您公开您的服务并且其主机名、域或 IP 地址发生更改时，这些 URL 将保持有效。

```
$.getJSON('/api/objects/type/place?callback=?', // ... 
```

当浏览器解释此地址时，它将使用该 URL 的上下文（当前页面的地址）进行解析，并自动在其前面加上适当的协议、主机名/IP 和端口。

# python - 如果字典键不存在，则创建字典键的速记方法

> ID：10843466
> 
> 赞同：6
> 
> 时间：2012-06-01T01:52:16.607
> 
> 标签：python

我有一本动物园动物字典。我想将它放入嵌套字典中的字典中，但得到一个 KeyError，因为该特定物种尚未添加到字典中。

```
def add_to_world(self, species, name, zone = 'retreat'):
    self.object_attr[species][name] = {'zone' : zone} 
```

是否有快捷方式来检查该物种是否在字典中，如果不在则创建它，还是我必须做很长的路要走，然后手动检查该物种是否已添加？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-06-01T01:57:22.610

```
def add_to_world(self, species, name, zone = 'retreat'):
    self.object_attr.setdefault(species, {})[name] = {'zone' : zone} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-06-01T01:59:40.517

这是一个使用带有字典作为值的 defaultdict 的示例。

```
>>> from collections import defaultdict
>>> d = defaultdict(dict)
>>> d["species"]["name"] = {"zone": "1"}
>>> d
defaultdict(<type 'dict'>, {'species': {'name': {'zone': '1'}}})
>>> 
```

如果您想进一步嵌套，您需要创建一个函数来返回*defaultdict(dict)*。

```
def nested_defaultdict():
    return defaultdict(dict)

# Then you can use a dictionary nested to 3 levels
d2 = defaultdict(nested_defaultdict)
d2["species"]["name"]["zone"] = 1 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-06-01T01:55:32.400

字典值的自动激活可以通过[`collections.defaultdict`](http://docs.python.org/dev/library/collections.html#collections.defaultdict).

# firefox - 使用具有非 Google 凭据的 Firefox Poster 扩展程序

> ID：10843468
> 
> 赞同：0
> 
> 时间：2012-06-01T01:52:25.447
> 
> 标签：firefox, oauth, firefox-addon, yql, poster

有谁知道是否可以将 Firefox [Poster 扩展程序](https://addons.mozilla.org/addon/poster/)用于具有“用户身份验证：”非 Google 凭据的宁静 Web 服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T07:21:20.843

Poster 扩展目前仅支持 HTTP 基本身份验证和 Google 登录授权。对于 OAuth，您需要自己获取访问令牌并`Authorization`手动添加标头 - 这并非易事，尤其是对于 OAuth 1.0。随意向扩展作者询问 OAuth 支持或（更好）自己提出一个实现。

# c# - C#条件格式excel

> ID：10843470
> 
> 赞同：2
> 
> 时间：2012-06-01T01:52:54.180
> 
> 标签：c#, excel, formatting, excel-2007, excel-interop

在我的项目中，我有代码根据单元格值条件格式化单元格的背景颜色，如下所示：

```
//if value is 1 than colorIndex is 3;
Excel.FormatCondition condition = colorRange.FormatConditions.Add(
    Type: Excel.XlFormatConditionType.xlTextString, 
    Operator: Excel.XlFormatConditionOperator.xlEqual,
    Formula1: "=1");
condition5.Interior.ColorIndex = 3; 
```

此条件工作正常，但以下代码中的条件不起作用：

```
//if value is Red Color than colorIndex is 3;
Excel.FormatCondition condition = colorRange.FormatConditions.Add(
    Type: Excel.XlFormatConditionType.xlTextString, 
    Operator: Excel.XlFormatConditionOperator.xlEqual,
    Formula1: "=Red Color");
condition5.Interior.ColorIndex = 3; 
```

我收到的错误消息是“参数不正确”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T05:47:51.423

我认为错误来自您传递的 Formula1 参数是一个公式。这意味着它应该像您在 Excel 单元格中手动编写的公式一样编写。这意味着当您将“红色”作为参数写入时，Excel 会尝试将其转换为公式，但语法错误并且会出现错误。

您可以尝试只输入“=Red”（不带字符串的颜色部分），它不会给您错误，但无论如何它都不起作用，因为它会将您单元格中的值与那个值进行比较包含在名为 Red 的单元格中（我想您的工作表中没有这样的单元格）。

解决方案是以这种方式将 " 放在你的字符串周围：

```
Excel.FormatCondition condition = colorRange.FormatConditions.Add(
    Type: Excel.XlFormatConditionType.xlTextString, 
    Operator: Excel.XlFormatConditionOperator.xlEqual,
    Formula1: "=\"Red Color\""); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-28T12:23:12.847

你可以试试这个。这段代码为我提供了解决方案

```
 Excel.FormatCondition condition = colorRange.FormatConditions.Add(
     XlFormatConditionType.xlCellValue, 
     XlFormatConditionOperator.xlEqual,
     "=\"Red Color\"", 
     Type.Missing, 
     Type.Missing, 
     Type.Missing, 
     Type.Missing, 
     Type.Missing); 
```

# c# - Appharbor 部署“不包含测试”

> ID：10843475
> 
> 赞同：2
> 
> 时间：2012-06-01T01:53:31.537
> 
> 标签：c#, wcf, appharbor

我有一个 WCF 项目，我正在尝试部署到[AppHarbor](https://appharbor.com/)。该服务在本地运行良好，所有测试在本地通过，基本上本地没有问题。当我推动部署它时，它构建得很好，但会出现“构建不包含测试”。我什至删除了我编写的所有现有测试，并在那里放了一个保证通过的假人（基本上只是`Assert.IsTrue(0 == 0)`）。

在日志（“详细信息”）中，我得到：

```
Build succeeded. 
```

但是，我也得到：

```
5 Warning(s)
0 Error(s) 
```

但这只是“e 未定义”（我还没有在 catch 内为 try/catch 做任何事情，那会来的，我只是想让它启动并运行。

我已经在 AppHarbor 网站上搜索并搜索了一些对此的见解，但我什么也没找到。有没有人见过这样的事情？

** 使用 Visual Studio 的内置测试框架 (Microsoft.VisualStudio.QualityTools.UnitTestFramework.dll)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T14:32:42.530

最新版本的 AppHarbor 现在可以正确处理我正在使用的问题。我不知道发生了什么变化（这绝对不是我的代码，我在几个不同的项目上陷入了困境，但我回到了原来的项目，它现在可以在 appharbor 上运行）。

# spring - 使用 Spring 处理多个文件

> ID：10843477
> 
> 赞同：0
> 
> 时间：2012-06-01T01:53:49.670
> 
> 标签：spring

我有几个 HTML 文件上传。

```
<label for="app_snapshot_image_1">SNAPSHOT_1</label>
<input type="file" name="app_snapshot_image_1" id="app_snapshot_image_1" />
<label for="app_snapshot_image_2">SNAPSHOT_2</label>
<input type="file" name="app_snapshot_image_2" id="app_snapshot_image_2" />
<label for="app_snapshot_image_2">SNAPSHOT_3</label>
<input type="file" name="app_snapshot_image_3" id="app_snapshot_image_3" /> 
```

* * *

这是处理来自WEB的多部分请求的spring控制器。

```
@RequestMapping(value="/apps/addOrModify/", method=RequestMethod.POST)
      public String testUpload(
            @RequestParam(required=false) MultipartFile app_snapshot_image_1,
            @RequestParam(required=false) MultipartFile app_snapshot_image_2,
            @RequestParam(required=false) MultipartFile app_snapshot_image_3) {
...
} 
```

* * *

但是上面的控制器只能处理名为app_snapshot_image_1到3的3个文件；但这不是我想要的。我想使用控制器处理无限的文件。

希望你能理解我的问题，并为我的小英语感到抱歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T02:24:00.477

您需要创建一个具有如下字段的模型类。

```
List<MultipartFile> files = LazyList.decorate(new ArrayList<MultipartFile>(),
                    FactoryUtils.instantiateFactory(MultipartFile.class)); 
```

用它的 getter 和 setter。现在你需要像`@ModelAttribute`在jsp中一样传递这个模型，你有一个用于文件上传的表单。

在 JSP 中，您需要为用户创建一个新输入以使用 javascript 上传新文件，并在您创建的输入标签的 name 属性中指定值，如`files[some int value]`方括号中的值，指定用户在 jsp 中添加的文件控件的计数。

当您发布包含多个文件的表单时，在您的控制器中，您可以使用相同的`@ModelAttribute`字段来获取包含多个文件的列表。

希望这对您有所帮助。

干杯。

# java - 理解 Java 代码背后的数学：2D 二进制空间分区

> ID：10843486
> 
> 赞同：1
> 
> 时间：2012-06-01T01:55:27.553
> 
> 标签：java, math, geometry, computational-geometry, coordinate-transformation

我试图了解[此处](http://www.theparticle.com/javadata2.html#Binary_Space_Partition_Trees)给出的二进制空间分区方法实现（此代码也可作为小程序[在此处](http://www.theparticle.com/javadata_dog3d.html)获得）。大部分代码我都看懂了，但是看不懂方法：

```
public void renderLine(int[] l){
        double x1=l[2];
        double y1=l[3];
        double x2=l[0];
        double y2=l[1];
        double pCos = Math.cos(eye_angle);
        double pSin = Math.sin(eye_angle);
        int[] x = new int[4];
        int[] y = new int[4];
        double pD=-pSin*eye_x+pCos*eye_y; //What is this line doing?
        double pDp=pCos*eye_x+pSin*eye_y; //And this?
        double rz1,rz2,rx1,rx2;
        int Screen_x1=0,Screen_x2=0;
        double Screen_y1,Screen_y2,Screen_y3,Screen_y4;
        rz1=pCos*x1+pSin*y1-pDp;     //perpendicular line to the players
        rz2=pCos*x2+pSin*y2-pDp;     //view point
        if((rz1<1) && (rz2<1))
            return;
        rx1=pCos*y1-pSin*x1-pD;
        rx2=pCos*y2-pSin*x2-pD;
        double pTan = 0;
        if((x2-x1) == 0)
            pTan = Double.MAX_VALUE;
        else
            pTan = (y2-y1)/(x2-x1);
        pTan = (pTan-Math.tan(eye_angle))/(1+
            (pTan*Math.tan(eye_angle)));
        if(rz1 < 1){
            rx1+=(1-rz1)*pTan;
            rz1=1;
        }if(rz2 < 1){
            rx2+=(1-rz2)*pTan;
            rz2=1;
        }
        double z1 = m_width/2/rz1;
        double z2 = m_width/2/rz2;
        Screen_x1=(int)(m_width/2-rx1*z1);
        Screen_x2=(int)(m_width/2-rx2*z2);
        if(Screen_x1 > m_width)
            return;
        if(Screen_x2<0)
            return;
        int wt=88;
        int wb=-40;
        Screen_y1=(double)m_height/2-(double)wt*z1;
        Screen_y4=(double)m_height/2-(double)wb*z1;
        Screen_y2=(double)m_height/2-(double)wt*z2;
        Screen_y3=(double)m_height/2-(double)wb*z2;
        if(Screen_x1 < 0){
            Screen_y1+=(0-Screen_x1)*(Screen_y2-Screen_y1)
                /(Screen_x2-Screen_x1);
            Screen_y4+=(0-Screen_x1)*(Screen_y3-Screen_y4)
                /(Screen_x2-Screen_x1);
            Screen_x1=0;
        }if(Screen_x2 > (m_width)){
            Screen_y2-=(Screen_x2-m_width)*(Screen_y2-Screen_y1)
                /(Screen_x2-Screen_x1);
            Screen_y3-=(Screen_x2-m_width)*(Screen_y3-Screen_y4)
                /(Screen_x2-Screen_x1);
            Screen_x2=m_width;
        }if((Screen_x2-Screen_x1) == 0)
            return;
        x[0] = (int)Screen_x1;
        y[0] = (int)(Screen_y1);
        x[1] = (int)Screen_x2;
        y[1] = (int)(Screen_y2);
        x[2] = (int)Screen_x2;
        y[2] = (int)(Screen_y3);
        x[3] = (int)Screen_x1;
        y[3] = (int)(Screen_y4);
        double_graphics.setColor(new Color(l[4]));
        double_graphics.fillPolygon(x,y,4);
    } 
```

我无法掌握实施此方法背后的坐标几何。你能给我解释一下吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:10:20.403

前半部分计算线相对于虚拟眼睛应该在的位置的角度。它还使用切线计算它是否完全可见。第二部分调整线条的大小以与屏幕成比例。在我看来，他们将坐标系的原点设置在屏幕中间。

我只是浏览了代码，所以其中一些细节可能会被关闭。

看看这个。它可能会让你朝着正确的方向前进 [http://www.cs.uic.edu/~jbell/CourseNotes/ComputerGraphics/2DTransforms.html](http://www.cs.uic.edu/~jbell/CourseNotes/ComputerGraphics/2DTransforms.html)

# html - 文件上传输入字段的字符限制是多少？

> ID：10843488
> 
> 赞同：2
> 
> 时间：2012-06-01T01:55:40.257
> 
> 标签：html

我们正在使用一个输入字段（具有“多个”属性）来上传相当多的文件。

```
<input id="" multiple="multiple" name="" type="file" /> 
```

有人可以告知这是否有字符限制吗？（如果没有在 HTML 中明确声明）？

从我们的角度来看，我们不想有限制。安全性并不是真正的问题，因为这是针对内部 Web 应用程序的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T05:42:40.757

HTML 规范没有施加限制。服务器上发生的事情取决于服务器和表单处理程序尝试执行的操作（例如尝试将文件存储在磁盘上）。强大的服务器端表单处理程序当然应该检查诸如写入文件之类的操作是否成功。

你在评论中写道：“与我交谈过的人似乎认为这是 1000 个字符。” 这一定是个误会。人们经常上传兆字节。*这种误解可能反映了一个真正的限制——如果*使用 GET 方法发送整个表单数据的大小（尽管该限制约为 2,000 个字符并且仅适用于某些浏览器）。但是包含文件字段的表单当然必须使用 POST 方法发送，因此限制不适用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-01T02:03:42.120

服务器设置大小限制，您可以使用 javascript 和文件 api 在客户端强制执行它。我认为“无限制”是将服务器限制设置为高值，并且在客户端什么都不做。

（或者您的意思是限制您可以添加到该`multiple`字段的文件数量？）

# html - CSS3箭头不显示

> ID：10843495
> 
> 赞同：0
> 
> 时间：2012-06-01T01:57:40.923
> 
> 标签：html, css, shapes

我正在尝试在其右中心创建一个带有箭头的框。到目前为止，我有以下代码，但它没有显示和想法？

**CSS：**

```
 .pageHelp{
    float:right;
    margin:10px 20px 0 0;
    width:85px;
    height:25px;
    border-radius:3px;
    background-color:#354E69;
}
.pageHelp p{
    color:#000;
    padding:5px;
    text-align:center;
}
.pageHelp .arrow{
    width:0;
    height:0;
    border-top:3px solid transparent;
    border-bottom:3px solid transparent;
    border-left:3px solid #354E69;
} 
```

**HTML：**

```
<div class="pageHelp arrow"><p>In Page Help</p></div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T02:14:03.157

你应该看看[css3arrowsplease](http://cssarrowplease.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T02:09:16.837

以下内容应该适合您：

**CSS：**

```
.pageHelp{
    float:right;
    margin:10px 20px 0 0;
    width:85px;
    height:50px;
    border-radius:3px;
    background-color:#354E69;
    position:relative;
}

.pageHelp p{
    color:#000;
    padding:5px;
    text-align:center;
}

.pageHelp:after {
    content: ' ';
    height: 0;
    position: absolute;
    left:10px;
    width: 0;

    border: 10px solid transparent;
    border-left-color: #354E69;
    left: 100%;
    top: 50%;
    margin-top: -10px;
}​ 
```

**HTML：**

```
<div class="pageHelp"><p>In Page Help</p></div>​ 
```

[现场演示](http://jsfiddle.net/fcaP3/1/)

查看以下博客文章以了解其工作原理：[http ://www.yuiblog.com/blog/2010/11/22/css-quick-tip-css-arrows-and-shapes-without-markup/](http://www.yuiblog.com/blog/2010/11/22/css-quick-tip-css-arrows-and-shapes-without-markup/)

# java - 安装 org.apache.commons.io？

> ID：10843498
> 
> 赞同：3
> 
> 时间：2012-06-01T01:58:15.990
> 
> 标签：java, apache, apache-commons

我有一个程序正在尝试使用 org.apache.commons.io.FileUtils 静态方法

```
readFileToString() 
```

我已经从 Apache 网站下载了 commons.io 包，但我不知道如何让我的程序找到该包。我目前没有使用 IDE，但正在使用 Notepad ++ 并使用一个简单的批处理文件进行编译，并使用另一个批处理文件来运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:03:59.607

您必须在两者中设置类路径

1.  编译过程（javac）和
2.  运行时（Java）

看到类似的[话题](https://stackoverflow.com/questions/2096283/including-jars-in-classpath-on-commandline-javac-or-apt)。

# php - 看不到php标头

> ID：10843499
> 
> 赞同：0
> 
> 时间：2012-06-01T01:58:29.073
> 
> 标签：php, header

我正在自学如何为网站创建 php 页眉，当我尝试在谷歌浏览器中预览它时，我看不到我的页眉、导航或页脚。由于我是新手，我不确定我是否遗漏了我的编码中明显重要的东西或一些简单的东西。有人可以看看我的新 php 编码并告诉我是否做错了吗？下面列出的索引和标题代码。

**我的标题代码是：**

```
 <!--==============================header=================================-->

    <div id="header">

        <div class="inner">

            <div class="meta-info">

            <div class="extra-wrap">

            <ul class="social-links">

            <li><a href="index.html">English</a></li>

            <li><a href="esp-index.html">Espa&#xF1;ol</a></li>

            <li><a href="contactus.html">Contact Us</a></li>
            </ul>

            <form id="main-search" action="search.php"  >

            <input type="text" name="search"  style="background-color:#CCCCCC" >

            <a class="search-submit" onClick="document.getElementById('main-search').submit()" ></a>
            </form>
            </div>

            <br><br><br><a href="supportus.html" class="button3">Donate</a>  <a href="apply.html" class="button4">Apply</a>     </div>

            <a class="logo" href="index.html"></a>        </div>

    </div> 
```

----------结束头代码

* * *

**我的索引代码是：**

```
<!DOCTYPE html>

<html lang="en">

<head>

    <title>Creative Minds International PCS</title>

    <meta charset="utf-8">

    <meta name="description" content="Your description">

    <meta name="keywords" content="Your keywords">

    <meta name="author" content="Your name">

    <link rel="stylesheet" href="css/style.css">

    <link href='http://fonts.googleapis.com/css?family=Vollkorn' rel='stylesheet' type='text/css'>

    <script src="site/js/jquery-1.6.4.min.js"></script>

    <script src="site/js/script.js"></script>

    <script src="site/js/flashobject.js"></script>

    <!--[if lt IE 7]>

        <div class='aligncenter'><a href="http://www.microsoft.com/windows/internet-explorer/default.aspx?ocid=ie6_countdown_bannercode"><img src="http://storage.ie6countdown.com/assets/100/images/banners/warning_bar_0000_us.jpg"border="0"></a></div>  

    <![endif]-->

    <!--[if lt IE 9]>

        <script src="js/html5.js"></script>

        <link rel="stylesheet" href="css/ie.css"> 

    <![endif]-->

    <script type="text/javascript">

<!--

var image1=new Image()

image1.src="../slideshow3.jpg" 

var image2=new Image()

image2.src="../slideshow2.jpg"

var image3=new Image()

image3.src="../slideshow4.jpg"

var image4=new Image()

image4.src="../slideshow1.jpg"

//-->

</script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-28106351-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

    </head>

<body id="page2">

<div class="main-bg">

<?php include('Includes/header.php'); ?>

<?php include('Includes/nav.php'); ?>    

        <div class="clear"></div>

        </div>

        <div class="flash">

        <div id="head">

        <div class="aligncenter"><img src="slideshow3.jpg"  id="slide" alt="Creative Minds Slideshow" width="990" height="450">   <script>

        <!--

        //variable that will increment through the images

        var step=1

        function slideit(){

        //if browser does not support the image object, exit.

        if (!document.images)

        return

        document.images.slide.src=eval("image"+step+".src")

        if (step<4)

        step++

        else

        step=1

        //call function "slideit()" every 2.5 seconds

        setTimeout("slideit()",6000)

        }

        slideit()

        //-->

        </script>             

        </div></div>

    </div>  

</header>

    <!--==============================content================================-->

    <section id="content">

        <div class="container_12">

            <div class="wrapper">

               <div class="grid_8" id="welcome" class="editable">

        <article class="a4">

                      <h4>Welcome to Creative Minds</h4>

                      <div class="wrapper">

                      <figure class="img-indent">                          </figure>

                          <p class="p2">                        </p>

                          <p class="p2">

                              <strong>Creative Minds International Public Charter School is a new, tuition-free school for children in Washington, D.C.</strong>  <br><Br>We are the only public school in the District of Columbia that offers the International Primary Curriculum, a highly engaging, diverse curriculum with project- and arts-based activities that foster creativity, self motivation, social and emotional development, and academic excellence. Our goal is to provide students with the foundational skills required for successful participation in a global society. <br><br>Our program’s unique combination of child-centered, international, and developmental approaches to education is based on extensive research into various aspects of schooling that have the greatest positive affects on academic achievement.

<br> <a href="programs.html">Read More</a><br><br>

                                                        </p>

                      </div>

                  </article>

                  <article class="a2">

                                        <div class="wrapper">

                        <div class="grid_4 alpha">

                            <div class="box-1">

                            <h4><a href="careers.html" class="button2">Careers</a> <a href="requestmoreinfo.php" class="button2">Request More Info</a> <a href="apply.html" class="button2">Apply</a></h4>

                                                                                    </div>

                        <div class="grid_4 alpha">

                            <div class="box-2">                            </div>

                        </div>

                    </div></div>

                  </article>

               </div>

            <div class="grid_4"><div class="grid_6" id="newsandevents" class="editable">

                         <h4 class="hp-2">News and Events</h4>

The Enrollment Lottery took place on Tuesday, April 17, 2012\.  Emails were sent to families of students who were selected through the lottery<br> on April 18, 2012\.  Enrollment packets were mailed to your address on April 20, 2012.<br><br>

If your child is on the waitlist, you will receive a postcard in the mail indicating his/her number on the waitlist.  We will continue to move through our waitlists until October 2012 and contact you as spaces become available.<br><br>

FOR STUDENTS WHO WERE ADMITTED THROUGH THE LOTTERY, <strong>PLEASE REMEMBER MAY 14, 2012 IS THE DEADLINE</strong> FOR SUBMITTING YOUR CHILD’S ENROLLMENT PACKET TO ENABLE US TO RESERVE HIS/HER SPACE.  
<br><br>

<img src="site/images/guitar2.jpg" align="left" alt="Guitar Logo">              

                 </article>           

                                </div>

            </div>

        </div>

    </div></section>

</div>

<?php include('Includes/footer.php'); ?> 

<div id="dialog6" class="disable_masking"></div>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:51:31.420

我唯一能做的就是检查文件名/目录大小写（上下等）和/或路径。就个人而言，我不惜一切代价避免混合字母大小写并将它们全部小写。

在某些服务器（例如 Unix/Linux）上，带有大写字母的“**包含**”与带有小写字母的“**包含**”不同，因为它们使用显式（文件/文件夹）命名约定，所以这可能是您的问题。`I`**`i`**

# android - Eclipse 未检测到 MapActivity 类

> ID：10843500
> 
> 赞同：0
> 
> 时间：2012-06-01T01:58:33.613
> 
> 标签：android, android-maps

我无法让地图工作。事实上，根据Eclipse，“com”下没有“google”包。我为 API 级别 15 安装了 Google API。虽然我已经设置`minSdkVersion="10"`，但我的构建目标是 15。

这是我的清单。我是否需要添加一些 .jar 才能使其工作？

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.arn.log"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="10" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"></uses-permission>
<uses-permission android:name="android.permission.INTERNET"></uses-permission>
    <application
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name" 
        android:theme="@android:style/Theme.DeviceDefault" >

        <uses-library android:name="com.google.android.maps" />

        <activity
            android:name=".LActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    <activity
            android:name=".Map"
            android:label="@string/app_name2" />

    </application>

</manifest> 
```

我的活动，没有被编译。即使在导入 MapActivity 时，Ecilpse 也会显示错误。

```
package com.arn.log;
import android.os.Bundle;
import com.google.android.maps.MapActivity;

public class Map extends MapActivity {
    @Override
    protected boolean isRouteDisplayed() {
        return false;
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.map);
        MapView mapView = (MapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(true);
    }
} 
```

我已经为 API 15 安装了 2 版的谷歌 API。它让一个 DOS 窗口永久打开了很长时间。当我关闭它时，它显示了一些错误，但现在，SDK 经理说 Google API 已“安装”。我如何确保这不是一个错误的安装？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T02:29:46.343

我必须将目标设置为 Google API 而不是 Android-14。

# qt - 根据 Qt 中的固定小部件调整视频大小

> ID：10843501
> 
> 赞同：2
> 
> 时间：2012-06-01T01:58:38.243
> 
> 标签：qt, video, widget

我在 Qt Creator 中设计了一个表单。我有三个控件。

*   Group Box（底部控件）
*   Widget（中间控件）
*   标签（最上面的控件）

我在标签上显示/播放视频的帧（可能不是正确的方式，但我是 Qt 的新手，所以暂时它对我有用）。

我的控件是固定大小的。

我的问题是如何根据我的控件（即小部件或标签）调整视频大小？我希望所有视频都以与我的小部件或标签相同的大小播放（它们都具有相同的大小）。

为了更清楚，我有我的程序的两个快照。

我希望第二个视频（较小的）与第一个视频播放相同的视频。或者，如果视频大于 Widget，则必须将其缩小到标签的大小，一种拉伸和收缩或其他方式。

您可以在两个视频中看到我的小部件的边框。

任何解决方案将不胜感激。提前致谢

![第一个视频（普通视频）](../Images/eafe0304f99f0c3c7ecb4a21ea1abc0e.png)

![这是第二个视频（小）](../Images/620faf867631bdfbff676a56a9fe7f7a.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T06:40:12.393

`myLabel.setScaledContents(true)`应该这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T14:49:55.333

我在我的代码中发现了问题。我在不知不觉中调整了我不应该这样做的标签的大小。删除那行代码后，我解决了我的问题。

我的代码如下：

```
 std::string fileName = QFileDialog::getOpenFileName(this,tr("Open Video"), ".",tr("Video Files (*.mp4 *.avi)")).toStdString();

 cv::VideoCapture capture(fileName);

 if (!capture.isOpened())
 {
     QMessageBox msgBox;
     msgBox.setWindowTitle("Error");
     msgBox.setIcon(QMessageBox::Critical);
     msgBox.setButtonText(2,"OK");
     msgBox.setText("The video was not loaded!");
     msgBox.exec();
 }

 Mat cur_frame, pre_frame; // current video frame

 capture.read(imgsize);

 cv::Mat out(imgsize.rows,imgsize.cols,CV_8SC1);
 cv::Mat out2(imgsize.rows,imgsize.cols,CV_8SC1);

     Mat cur_frame_gray(imgsize.rows,imgsize.cols,CV_8SC1);

if (!paused) {
         // read next frame if any
         if (!capture.read(cur_frame)) break;

         cvtColor(cur_frame,cur_frame_gray,CV_RGB2GRAY);

         QCoreApplication::processEvents();

         //read second frame if any
         if(!capture.read(pre_frame)) break;
         cvtColor(pre_frame,pre_frame_gray,CV_RGB2GRAY);

         QCoreApplication::processEvents();

         Mat resizedframe1,resizedframe2,resizedframe3,resizedframe4; // to contain resized image

         cvtColor(cur_frame,cur_frame,CV_BGR2RGB);

        // here I am dividing the rows and columns of the frames by 2 to make them smaller. 
         cv::resize(cur_frame,resizedframe1,cv::Size(cur_frame.cols/2,cur_frame.rows/2));

         IplImage  myFrame=resizedframe4;

        Mat matFrame=&myFrame;

         QImage img1= QImage((const unsigned char*)(resizedframe1.data),resizedframe1.cols,resizedframe1.rows,QImage::Format_RGB888);

         //display on label
         //the label stretches and shrinks according to the frame of the video.

         ui->label->setScaledContents(true);
         ui->label->setPixmap(QPixmap::fromImage(img1));

}
// resize the label to fit the image
         // The problem was here, I was resizing the label but I shouldn't have to do it.
         // by removing the following line of code, my problem was solved :)
           ui->label->resize(ui->label->pixmap()->size());

         QCoreApplication::processEvents();

         waitKey(delay);

 }

         // Close the video file
         capture.release();

} 
```

# c# - BitmapImage 构造函数（Uri）在 Windows Phone 7 上不起作用

> ID：10843514
> 
> 赞同：0
> 
> 时间：2012-06-01T01:59:59.780
> 
> 标签：c#, uri, windows-phone-7.1, bitmapimage

```
BitmapImage tempBitmap = new BitmapImage(onlineImageLocation); 
```

相当简单的代码。OnlineImageLocation 指的是[http://dantonybrown.com/brownsoft/SweepyCleaner.png](http://dantonybrown.com/brownsoft/SweepyCleaner.png)

但在构建位图图像后不包含填充字段。甚至 PixelWidth 和 PixelHeight 都是 0。

有任何想法吗？

丹尼

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-07T20:17:12.770

For instance like this?

```
 BitmapImage bmpImage = new BitmapImage(new Uri("http://dantonybrown.com/brownsoft/SweepyCleaner.png"));
    MessageBox.Show(bmpImage.PixelWidth.ToString()); 
```

That makes perfect sense. The image is loaded on demand, and on the background. You have multiple options here:

1.  Assign the BitmapImage to an Image control. You can access the properties after the ImageLoaded event occured:

    ```
     BitmapImage bmpImage = new BitmapImage(new Uri("http://dantonybrown.com/brownsoft/SweepyCleaner.png"));
        bmpImage.ImageOpened += (sender, args) => Dispatcher.BeginInvoke(() => MessageBox.Show(
            bmpImage.PixelWidth.ToString(CultureInfo.InvariantCulture)));
        imageCtrl.Source = bmpImage; 
    ```

2.  Load the BitmapImage with CreateOptions.None. This will still load the image in the background, but you don't have to assign the image to a control before it starts loading:

    ```
     BitmapImage bmpImage = new BitmapImage(new Uri("http://dantonybrown.com/brownsoft/SweepyCleaner.png"))
                                   {CreateOptions = BitmapCreateOptions.None};
        bmpImage.ImageOpened += (sender, args) => Dispatcher.BeginInvoke(() => MessageBox.Show(
            bmpImage.PixelWidth.ToString(CultureInfo.InvariantCulture))); 
    ```

# ruby-on-rails - Rails 模型生成中的外键

> ID：10843519
> 
> 赞同：0
> 
> 时间：2012-06-01T02:00:34.010
> 
> 标签：ruby-on-rails, ruby

有没有办法在 Rails 中生成包含外键和级联删除的模型？我想要一个模型“游戏”，根据两个用户玩，它有两个用户。如何将这两个用户创建为外部用户对象，以便它们 a) 在我加载游戏对象时加载，b) 如果其中一个用户被删除，它们将自动被删除？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T04:25:11.257

可能是这样的：

用户型号：

```
class User < ActiveRecord::Base
  has_many :games, :dependent => :destroy
end 
```

还有你的游戏模型：

```
class Game < ActiveRecord::Base
  belongs_to :user1, :class_name => "User", :foreign_key => "user1_id"
  belongs_to :user2, :class_name => "User", :foreign_key => "user2_id"
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T11:17:07.177

如果要使用数据库外键，可以使用：

[https://github.com/matthuhiggins/foreigner](https://github.com/matthuhiggins/foreigner)

使用就像：

```
add_foreign_key(:games, :users, :column => 'user1_id', :dependent => :delete)
add_foreign_key(:games, :users, :column => 'user2_id', :dependent => :delete) 
```

# php - 在 PHP 数组中搜索

> ID：10843520
> 
> 赞同：1
> 
> 时间：2012-06-01T02:00:44.993
> 
> 标签：php, arrays, search

我有一个 PHPArray ：

```
$fullData = array ( 
        array ( 'id' => 23123, 'name'=>'a', number =>...),
            array()....
); 
```

这个完整的数据集显示给用户。但是，如果他来自表单页面，我会发布数据以更改此数组。

我需要针对用户字段搜索数组字段。因此，如果未填写任何 POST 数据，我将默认值设置为全部。

```
if( $resetData == 1) {
    foreach ($params as $i=>$k) {
        if($k!='all') {
            $fields[][$i] = $k;
        }
    }... 
```

`fields`从而在数组中获取用户填充的数据。现在如何以 SQL AND 格式搜索用户填充的数据。示例：name == 'aaditi' **AND** profile == 'student'，将列出具有学生个人资料的名称为 aaditi 的所有数据

我尝试了各种功能，例如`array_search`and `strstr`，以及有关 stackoverflow 的其他一些问题，但它们大多仅限于单个键值搜索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T02:13:57.850

我会逐行搜索数据数组，找到所有与传递的过滤器匹配的东西。将您的字段数组作为键 => 值，其中键是列名，值是想要的值，

```
$outputArray = array();
foreach($fullData as $row) {
    $addToOutput = true;
    foreach ($fields as $field) {
        foreach($field as $key => $value) {
            if (!isset($row[$key]) || $row[$key] != $value) {
                $addToOutput = false;
            }
        }
    }
    if ($addToOutput == true) {
        $outputArray[] = $row;
    }
} 
```

这不是最有效的解决方案，我相信可以找到更好的解决方案，但这应该可以正常工作，至少对于不是非常庞大的数据集（>100,000 行，每行 10 列）。您也可以在没有参数的情况下运行相同的算法，并且所有数据都应该出来。

# css - cssstickyfooter.com 的 CSS 页脚无法正常工作

> ID：10843522
> 
> 赞同：1
> 
> 时间：2012-06-01T02:00:52.557
> 
> 标签：css, footer, sticky-footer

我从[http://www.cssstickyfooter.com/](http://www.cssstickyfooter.com/)获得了一些简单的 CSS，以获取无论内容多长时间都始终保持不变的页脚。现在，这实际上不起作用。这个页脚有两个不同的问题，但我要在这里问他们两个，因为我怀疑它们是相关的。

首先是该网站的css：

```
html, body {height: 100%;}

#wrap {min-height: 100%;}

#main {overflow:auto;
    padding-bottom: 150px;}  /* must be same height as the footer */

#footer {position: relative;
    margin-top: -150px; /* negative value of footer height */
    height: 150px;
    clear:both;} 
```

这是我用于整个页面的 HTML：

```
<html>
    <head>
        <title>{$title_text}</title>
        <link rel="stylesheet" type="text/css" href="/global/global.css" />
    </head>
    <body>
        <div id="wrap">
            {$navbar}<hr><div id="content">{$body}</div>
        </div>
        <div id="footer">
            {$footer}
        </div>
    </body>
</html> 
```

如您所见，有一些变量格式为`{$variable}`. 这些是从另一个文件/字符串中提取的。

### 问题1：

页脚太高，与页面上的其他内容重叠。看起来是这样的：

![这个页脚是重叠的！](../Images/cb7a29a295ad421ed9d48deb22f8234c.png)

为了解决这个问题，我在 ID 的 div 中添加了 200px 的填充，`wrap`就在页脚之前（参见上面的 HTML）。这将解决您在图片中看到的问题。但这会导致另一个问题：现在在内容很少的页面上，页脚仍然向下移动了 200 像素，您必须向下滚动才能看到它。我得到这个 CSS 代码的网站说这不应该发生。

### 问题2：

页脚没有到达浏览器窗口的边缘。这就是我所说的：

![在此处输入图像描述](../Images/f5398872630b2ee35db2dbc152603fd8.png)

页脚应该“接触”窗口的左右两侧，但正如您所看到的，似乎有一个小的边距。老实说，我不知道如何开始解决这个问题。但我不认为这是一个错误，因为它在 Chrome、Firefox 中的呈现方式相同，我认为甚至在 Internet Explorer 中也是如此。

欢迎任何意见。感谢您的关注！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:09:20.093

您的 html 似乎与您的 css 不匹配。您的 css 包含一个“#main”，但您的主要内容出现在

```
<div id="content">...</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T02:16:24.043

1）尝试改变

```
#footer { position: relative; } 
```

至`#footer {position: absolute; }`

2）添加到您的代码

`html, body { padding: 0; margin: 0; }`防止页脚周围出现空格

# ruby-on-rails - 在 Rails 中将 EST 转换为 UTC？

> ID：10843523
> 
> 赞同：0
> 
> 时间：2012-06-01T02:00:56.493
> 
> 标签：ruby-on-rails

我有一个工具，其中所有内容都保存为 UTC，而 GUI 端仅反映 EST（特别是东部时间的 EST，它对 UTC 是静态的 - 5.hours 并且不遵循夏令时。

因此，如果用户“选择”时间，他们会选择 EST 时间，我正在尝试找出将 EST 转换为 UTC 的最佳方法。看起来“in_time_zone”只有 1 个东部区域，我假设“复活节时间（美国和加拿大）”实际上是 EDT（不是 EST）：

```
 ActiveSupport::TimeZone.us_zones.map(&:name) 
    => ["Hawaii", "Alaska", "Pacific Time (US & Canada)", "Arizona", 
"Mountain Time (US & Canada)", "Central Time (US & Canada)",
 "Eastern Time (US & Canada)", "Indiana (East)"] 
```

最好的办法就是将 5 小时（+ 5.hours）添加到用户选择的 EST 时间以存储为 UTC 吗？

谢谢！

导轨 2.3.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:19:58.390

在 config/application.rb

```
config.time_zone = 'Eastern Time (US & Canada)' 
```

存储时，使用这个：

```
in_time = (params[:in] + ' Eastern Time (US & Canada)'
          ).to_datetime.in_time_zone('Eastern Time (US & Canada)').to_s
if in_time.match('-0400')
  clock.in = (params[:in] + ' -4:00').to_datetime.in_time_zone('UTC') if params[:in] != ''
elsif in_time.match('-0500')
  clock.in = (params[:in] + ' -5:00').to_datetime.in_time_zone('UTC') if params[:in] != ''
else
  <HANDLE ERROR> "ERROR: CANNOT FIGURE OUT TIMEZONE IN #{params[:in]}."
end 
```

# .htaccess - 如果 URL 中存在字符串，.htaccess 重定向一级

> ID：10843527
> 
> 赞同：2
> 
> 时间：2012-06-01T02:01:21.350
> 
> 标签：.htaccess

如果 URL 末尾存在某些字符串，任何人都可以向我指出一个教程或文章，或者给出一个解决方案（带有一些解释）如何重定向一个级别。

例如

[http://www.example.com/s/texas/hello-world/](http://www.example.com/s/texas/hello-world/)

应该重定向到

[http://www.example.com/s/texas/](http://www.example.com/s/texas/)

假设字符串是“hello-world”，我有 100 个不同的 url

即/s/佛罗里达/你好世界

/c/boston/massachusetts/hello-world 等

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:05:04.710

下面的表达式捕获了`hello-world`inside `(.*)`as之前的所有内容`$1`并重定向到它。使`/?`尾部斜杠可选。

```
RewriteEngine On
RewriteRule ^(.*)hello-world/?$ $1 [L,R=301,QSA] 
```

# ubuntu - 如何在 Ubuntu 中同时使用 4.5 和 4.6 版本的 arm gcc？

> ID：10843529
> 
> 赞同：0
> 
> 时间：2012-06-01T02:01:52.200
> 
> 标签：ubuntu, arm, cross-compiling

使用 Ubuntu 12 交叉编译 arm 代码提供了 2 个 gcc 版本，4.5 和 4.6。安装两者都会创建从工具到 4.6 版本的符号链接（例如 arm-linux-gnueabi-gcc -> arm-linux-gnueabi-gcc-4.6）。有没有一种简单的方法可以从 gcc 符号链接到 4.5 或 4.6 来回切换？我可以编写破解符号链接的脚本，但我希望已经有一种 Ubuntu 方法可以做到这一点。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:13:26.587

[替代系统](http://segfault.in/2010/04/using-the-debian-alternatives-system/)允许您拥有一个可以随意摆动的符号链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-04T22:01:34.050

恕我直言（以及我所做的）更好和更清洁的方法是：

1.  获取存档版本，（不要使用apt）

2.  将其提取到您的家中或 /usr/share

3.  在您的 ~/.bashrc 中创建一些别名，例如

    ```
    alias sourcery2009 = 'CROSS_COMPILE=/usr/share/arm-2009q3/bin/arm-none-eabi-'
    alias sourcery2010 = 'CROSS_COMPILE=/usr/share/arm-2010q1/bin/arm-none-eabi-' 
    ```

4.  编译（linux）时，使用make zImage sourcery2009，这一步变化很大，具体取决于您正在编译的项目以及他们如何获取您希望他们使用的工具链的位置/前缀，对于许多具有简单makefile的项目，您' d 必须在 makefile 中进行编辑以更改路径或使其将工具链路径作为 arg。

# ios - 不使用 UINavigationController 的可见视图控制器？

> ID：10843531
> 
> 赞同：1
> 
> 时间：2012-06-01T02:02:05.900
> 
> 标签：ios, uiviewcontroller, uinavigationcontroller, visible

在我的应用程序中，我只是使用典型的 UIViewController 方法来切换视图。我没有使用 UINavigationController。但是，我确实需要使用 UINavigationController 拥有的 visibleViewController API。

不，我也无法将我的项目转换为使用 UINavigationController。有什么方法可以检查我的应用程序中的另一个 UIViewController 是否是当前可见的控制器？

我现在使用 addSubview 和 hidden 属性切换视图。（我知道这不是切换视图的正确方法）。

无论如何，在我的情况下，是否可以做类似于 visibleViewController 的事情？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T02:28:06.993

如果您使用 addSubview:，则只有一种方法可以确定视图层次结构中的顶视图。您可以通过探索根视图的子视图数组属性来确定顶视图

UIView *topview = [[rootview subviews] lastObject];

如果你想获得类似于 visibleViewController 的东西，你应该存储一个地图来保持 UIView 和 UIViewController 之间的关系。所以可以通过先获取topview，再获取对应的view controller来获取visibleViewController。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:50:10.917

有2种方式：

1.  将子视图添加到视图控制器中，然后使用以下方法将其置于前面：

    [self.view带来SubviewToFront：aView]；

2.  您可以在 appDelegate 中保留视图控制器的实例，然后使用以下代码将其中之一设置为 rootViewController：

    self.window.rootViewController = self.viewController;

# powershell - 批量编辑文件创建日期

> ID：10843534
> 
> 赞同：2
> 
> 时间：2012-06-01T02:02:26.913
> 
> 标签：powershell, batch-file

有人在相机设置中设置了错误的日期，现在有几百张以 2013 年为年份的照片。有没有办法通过将年份减 1 来批量编辑创建日期？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T07:14:56.193

[在这里](http://chrisjwarwick.wordpress.com/2011/11/08/modify-date-taken-values-on-photos-with-powershell-the-update-exifdatetaken-script-cmdlet/)，您可以找到 2 个用于照片的 powershell`get`脚本`set` `Exif Date Taken`。

仔细阅读 Chris 在他的博客中写的内容。

`jpeg`在购买**LightRoom**之前，我已经使用这个脚本来解决你的问题，因为它可以很容易地进行 EXIF 编辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T18:42:00.833

我相信您也可以在 PowerShell [Wia.ImageFile](http://msdn.microsoft.com/en-us/library/ms630506%28VS.85%29.aspx)中使用 ComObject来操作信息。[PowerShell 团队在这里](http://blogs.msdn.com/b/powershell/archive/2009/03/31/image-manipulation-in-powershell.aspx)写了一篇关于它的博客文章。他们提供了一个您可能可以使用的模块。我加载了一个文件，并在 $image 变量的 Properties 属性下的“DateTime”值中找到了 DateTaken，如果按照博客文章中的示例完成。

我认为您也可以在 Windows 资源管理器的 GUI 中执行此操作。我拿了两个我用佳能拍摄的文件并选择了它们并进入了属性。在详细信息选项卡下，我刚刚更改了年份值。月份、日期和时间保持不变。我在两个文件上做了这个并且它有效，虽然如果你谈论数百个不知道它会如何执行。 ![在此处输入图像描述](../Images/b3578020b1d18d14b01f370b50843eba.png)

# haskell - Snap Monad、LiftIO 和 ghc 7.4.1

> ID：10843547
> 
> 赞同：2
> 
> 时间：2012-06-01T02:05:31.137
> 
> 标签：haskell, haskell-snap-framework

我试图让一些在 ghc 7.0.4 中工作的代码与 7.4.1 一起工作。

在我看来，从 Snap mo 内部访问 IO 的旧方式不再进行类型检查。

在 ghc 7.0.4 中，记录的访问 IO 的方式已编译。

```
a :: Snap ()
a = liftIO fireTheMissiles 
```

[http://hackage.haskell.org/packages/archive/snap-core/0.8.1/doc/html/Snap-Core.html](http://hackage.haskell.org/packages/archive/snap-core/0.8.1/doc/html/Snap-Core.html)

在 GHC 7.4.1 中，

```
No instance for (MonadIO Snap)
  arising from a use of `liftIO'
Possible fix: add an instance declaration for (MonadIO Snap) 
```

我很好奇一个有吸引力的工作会是什么。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T09:04:32.130

我的猜测是您的某些软件包的版本存在冲突（可能`transformers`）。当您尝试使用 0.3 版本时，Snap 可能是针对不同版本（可能是 0.2.2）构建的。结果，没有`MonadIO`您在范围内的实例（从 0.3 开始）。这只是一个猜测，但我已经看到同样的事情发生了很多次。

避免这种情况的最简单方法之一是对代码进行 cabalize。如果您尝试使用同一软件包的不同版本，cabal 会警告您。

# python - 在 Python 中求解 5 个线性方程

> ID：10843549
> 
> 赞同：0
> 
> 时间：2012-06-01T02:05:46.040
> 
> 标签：python, equation-solving

我试过使用矩阵，但失败了。我查看了外部模块和外部程序，但都没有奏效。如果有人可以分享一些有用的提示或代码，谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T02:10:08.317

当您说矩阵方法不起作用时，我不确定您的意思。这是解决这类问题的标准方法。

从线性代数的角度来看，求解 5 个线性方程是微不足道的。它可以使用任意数量的方法来解决。您可以使用[高斯消元](http://en.wikipedia.org/wiki/Gaussian_elimination)法、求[逆](http://en.wikipedia.org/wiki/Invertible_matrix)法、[克莱默法则](http://en.wikipedia.org/wiki/Cramer%27s_rule)等。

如果你很懒惰，你总是可以求助于图书馆。[Sympy](http://sympy.org/en/index.html)和[Numpy](http://numpy.scipy.org/)都可以轻松求解线性方程组。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-01T02:20:44.507

```
import numpy
import scipy.linalg

m = numpy.matrix([
    [1, 1, 1, 1, 1],
    [16, 8, 4, 2, 1],
    [81, 27, 9, 3, 1],
    [256, 64, 16, 4, 1],
    [625, 125, 25, 5, 1]
])

res = numpy.matrix([[1],[2],[3],[4],[8]])

print scipy.linalg.solve(m, res) 
```

返回

```
[[ 0.125]
 [-1.25 ]
 [ 4.375]
 [-5.25 ]
 [ 3\.   ]] 
```

（a、b、c、d、e 的解系数）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T02:14:05.317

也许您以错误的方式使用矩阵。

矩阵就像列表中的列表。

```
[[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1],[1,1,1,1,1,1]] 
```

上述代码将创建一个列表，您可以`mylist[y][x]`在交换轴时访问该列表。

# java - 如何从 Quartz 作业中执行 Struts 2 Action。如何获得容器？

> ID：10843550
> 
> 赞同：1
> 
> 时间：2012-06-01T02:05:54.390
> 
> 标签：java, struts2, quartz-scheduler

我正在尝试从 Quartz 作业内部执行 Struts2 Action - 从任何不处理 HTTP 请求的上下文进行概括。

我从这里开始[http://struts.apache.org/2.0.6/docs/how-can-we-schedule-quartz-jobs.html](http://struts.apache.org/2.0.6/docs/how-can-we-schedule-quartz-jobs.html)但该文档似乎已经过时了。

我相信（但我可能错了）我把它归结为需要获得一个 Container 对象：

```
import java.util.HashMap;
import com.opensymphony.xwork2.ActionProxy;
import com.opensymphony.xwork2.DefaultActionProxyFactory;

...

HashMap ctx = new HashMap();
DefaultActionProxyFactory factory= new DefaultActionProxyFactory();
factory.setContainer(HOW DO I GET THE CONTAINER??);
ActionProxy proxy = factory.createActionProxy("", "scheduled/myjob", ctx); 
```

一种解决方案是针对 localhost 发出 http 请求（通过 TCP）。我宁愿避免这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T23:34:37.747

我有点担心提供这个答案可能会鼓励某些人这样做，但作为概念证明，并为任何可能出于任何原因可能的人提供解决方案（也许他们正在继承一些需要这样做的被破坏的应用程序？） ，需要在正常请求上下文之外执行 Struts2 操作。

但是，这是一个原始的（它作为起点提供，而不是最佳实现），但有效的解决方案：

首先，将这三个类添加到名为 com.stackoverflow.struts2.quartz 的包中：

一个简单的作业，它只要求给定作业上下文的代理并执行它：

```
package com.stackoverflow.struts2.quartz;

import org.quartz.Job;
import org.quartz.JobExecutionContext;
import org.quartz.JobExecutionException;

public class ActionJob implements Job {

    @Override
    public void execute(JobExecutionContext context) throws JobExecutionException {

        try {
            QuartzActionProxyFactory.getActionProxy(context).execute();
        } catch (Exception e) {
            e.printStackTrace();
            throw new JobExecutionException(e);
        }

    }

} 
```

一些用于传递动作细节的常量：

```
package com.stackoverflow.struts2.quartz;

public class QuartzActionConstants {

    public static final String NAMESPACE = "struts.action.namespace";
    public static final String NAME = "struts.action.name";
    public static final String METHOD = "struts.action.method";

} 
```

可以从 ActionJob 静态访问的自定义 ActionProxyFactory：

```
package com.stackoverflow.struts2.quartz;

import java.util.HashMap;
import java.util.Map;

import org.apache.struts2.impl.StrutsActionProxyFactory;
import org.quartz.JobExecutionContext;
import org.quartz.JobExecutionException;

import com.opensymphony.xwork2.ActionContext;
import com.opensymphony.xwork2.ActionProxy;
import com.opensymphony.xwork2.ActionProxyFactory;

public class QuartzActionProxyFactory extends StrutsActionProxyFactory {

    private static ActionProxyFactory actionProxyFactory;

    public QuartzActionProxyFactory() {
        actionProxyFactory = this;
    }

    public static ActionProxy getActionProxy(JobExecutionContext context) throws JobExecutionException {

        ActionProxy actionProxy = null;

        try {
            @SuppressWarnings("unchecked")
            Map<String, Object> actionParams = context.getJobDetail().getJobDataMap();
            Map<String, Object> actionContext = new HashMap<String, Object>();
            actionContext.put(ActionContext.PARAMETERS, actionParams);

            actionProxy = actionProxyFactory.createActionProxy(
                    (String) actionParams.get(QuartzActionConstants.NAMESPACE),
                    (String) actionParams.get(QuartzActionConstants.NAME), 
                    (String) actionParams.get(QuartzActionConstants.METHOD), 
                    actionContext, 
                    false, //set to false to prevent execution of result, set to true if this is desired 
                    false);

        } catch (Exception e) {
            throw new JobExecutionException(e);
        }

        return actionProxy;
    }

} 
```

然后，在您的 struts.xml 中，添加：

```
<bean name="quartz" type="com.opensymphony.xwork2.ActionProxyFactory" class="com.stackoverflow.struts2.quartz.QuartzActionProxyFactory"/>
<constant name="struts.actionProxyFactory" value="quartz"/> 
```

然后，您可以使用一些简单的代码安排操作执行：

```
SchedulerFactory sf = new StdSchedulerFactory();
Scheduler scheduler = sf.getScheduler();
scheduler.start();
JobDetail jobDetail = new JobDetail("someActionJob", Scheduler.DEFAULT_GROUP, ActionJob.class);

@SuppressWarnings("unchecked")
Map<String, Object> jobContext = jobDetail.getJobDataMap();
jobContext.put(QuartzActionConstants.NAMESPACE, "/the/action/namespace");
jobContext.put(QuartzActionConstants.NAME, "theActionName");
jobContext.put(QuartzActionConstants.METHOD, "theActionMethod");

Trigger trigger = new SimpleTrigger("actionJobTrigger", Scheduler.DEFAULT_GROUP, new Date(), null, SimpleTrigger.REPEAT_INDEFINITELY, 1000L);
scheduler.deleteJob("someActionJob", Scheduler.DEFAULT_GROUP);
scheduler.scheduleJob(jobDetail, trigger); 
```

就是这样。这段代码将导致动作无限期地每秒执行一次，拦截器将全部触发并注入依赖项。当然，任何依赖于 Servlet 对象（如 HttpServletRequest）的逻辑或拦截器都不会正常运行，但是无论如何在 servlet 上下文之外安排这些操作是没有意义的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T06:29:27.877

您不需要 HttpServletRequest 在 freemarker 中格式化电子邮件。请参阅以下答案。

[通过 Spring 3 JavaMail 以 MIME 格式 Freemarker 模板创建多部分消息](https://stackoverflow.com/questions/4581541/create-multi-part-message-in-mime-format-freemarker-template-via-spring-3-javama)

对于发送邮件，您可以使用 spring 将邮件组件注入到您的 Quartz 作业中。即使有一个 RequestContextHolder 类来检索 HttpServlet 请求，您也不会从 Quartz 作业中获得 HttpServletRequest。

# image - blobstore 服务是否保留文件创建日期（不是上传日期）？

> ID：10843551
> 
> 赞同：0
> 
> 时间：2012-06-01T02:06:11.787
> 
> 标签：image, google-app-engine, date, blobstore, creation

如何捕获已上传到 blobstore 的图像文件的原始文件创建日期？

所有类似的问题/答案似乎都是指图像的*上传*日期。我对（在这种情况下）照片的拍摄日期感兴趣。

顺便说一句，如果这是一个全新的问题，我很抱歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T12:00:50.017

上传图像时浏览器不会发送文件创建日期，因此您不会在服务器端拥有它（无论您是否使用 AppEngine/Blobstore）。

但对于照片，相机通常将日期保存在文件中，作为 EXIF 元数据（或 IPTC 或 XMP）。我不知道 AppEngine 中是否有任何 API 可以让您访问 EXIF 元数据。

# macos - Cocoa：通过供应商 ID 检测 USB 设备

> ID：10843559
> 
> 赞同：8
> 
> 时间：2012-06-01T02:07:11.033
> 
> 标签：macos, cocoa, usb, foundation, iokit

我正在为 Mac 编写一个 Foundation 工具，并尝试检测 Apple 设备何时通过 USB 连接和断开连接。我在[这篇文章](https://stackoverflow.com/questions/7567872/how-to-create-a-program-to-list-all-the-usb-devices-in-a-mac)和[USBPrivateDataSample](http://developer.apple.com/library/mac/#samplecode/USBPrivateDataSample/Introduction/Intro.html#//apple_ref/doc/uid/DTS10000456-Intro-DontLinkElementID_2)中找到了一些帮助——但它似乎只有在我同时提供供应商 ID 和产品 ID 时才有效。我想消除产品 ID 并找到检测 Apple 设备上的所有 USB 事件（供应商 ID 1452）。这里有什么帮助吗？

这是我的代码，似乎没有检测到任何设备：

```
#include <CoreFoundation/CoreFoundation.h>

#include <IOKit/IOKitLib.h>
#include <IOKit/IOMessage.h>
#include <IOKit/IOCFPlugIn.h>
#include <IOKit/usb/IOUSBLib.h>

#define kMyVendorID 1452

int list_devices(void);

int list_devices(void){
    CFMutableDictionaryRef matchingDict;
    io_iterator_t iter;
    kern_return_t kr;
    io_service_t device;
    CFNumberRef numberRef;
    long usbVendor = kMyVendorID;

    /* set up a matching dictionary for the class */
    matchingDict = IOServiceMatching(kIOUSBDeviceClassName);    // Interested in instances of class
    // IOUSBDevice and its subclasses
    if (matchingDict == NULL) {
        fprintf(stderr, "IOServiceMatching returned NULL.\n");
        return -1;
    }

    // We are interested in all USB devices (as opposed to USB interfaces).  The Common Class Specification
    // tells us that we need to specify the idVendor, idProduct, and bcdDevice fields, or, if we're not interested
    // in particular bcdDevices, just the idVendor and idProduct.  Note that if we were trying to match an 
    // IOUSBInterface, we would need to set more values in the matching dictionary (e.g. idVendor, idProduct, 
    // bInterfaceNumber and bConfigurationValue.

    // Create a CFNumber for the idVendor and set the value in the dictionary
    numberRef = CFNumberCreate(kCFAllocatorDefault, kCFNumberSInt32Type, &usbVendor);
    CFDictionarySetValue(matchingDict, 
                         CFSTR(kUSBVendorID), 
                         numberRef);
    CFRelease(numberRef);
    numberRef = NULL;    

    /* Now we have a dictionary, get an iterator.*/
    kr = IOServiceGetMatchingServices(kIOMasterPortDefault, matchingDict, &iter);
    if (kr != KERN_SUCCESS)
        return -1;

    /* iterate */
    while ((device = IOIteratorNext(iter)))
    {
        io_name_t       deviceName;
        CFStringRef     deviceNameAsCFString;   

        /* do something with device, eg. check properties */
        /* ... */
        /* And free the reference taken before continuing to the next item */

        // Get the USB device's name.
        kr = IORegistryEntryGetName(device, deviceName);
        if (KERN_SUCCESS != kr) {
            deviceName[0] = '\0';
        }

        deviceNameAsCFString = CFStringCreateWithCString(kCFAllocatorDefault, deviceName, 
                                                         kCFStringEncodingASCII);

        // Dump our data to stderr just to see what it looks like.
        fprintf(stderr, "deviceName: ");
        CFShow(deviceNameAsCFString);

        IOObjectRelease(device);
    }

    /* Done, release the iterator */
    IOObjectRelease(iter);

    return 1;
}

int main(int argc, char* argv[])
{
    while(1){
        list_devices();
        sleep(1);
    }
    return 0;
} 
```

注意：如果我将产品 ID 添加到 matchingDict 并插入这样的设备，它会发现设备没有问题（不更改供应商 ID）。但我无法单独使用供应商 ID 找到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-09T06:42:46.577

要获取属于特定供应商的所有产品列表，您可以在产品 ID 字段中使用通配符。示例匹配条件如下：

```
 long vid = 1452; //Apple vendor ID
        CFNumberRef refVendorId = CFNumberCreate (kCFAllocatorDefault, kCFNumberIntType, &vid);
        CFDictionarySetValue (matchingDict, CFSTR ("idVendor"), refVendorId);
        CFRelease(refVendorId);
        //all product by same vendor
        CFDictionarySetValue (matchingDict, CFSTR ("idProduct"), CFSTR("*")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-18T19:46:02.867

创建仅包含 VID 条目的字典过滤器应匹配该供应商的所有 PID。我建议注册设备插入回调，而不是在您自己的代码中轮询。让操作系统处理检测并异步通知您的应用程序。

这段代码对我有用：

```
#import "IOKit/hid/IOHIDManager.h"
#include <IOKit/usb/IOUSBLib.h>

@implementation MyApp

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification {

    IOHIDManagerRef HIDManager = IOHIDManagerCreate(kCFAllocatorDefault,
                                                    kIOHIDOptionsTypeNone);
    CFMutableDictionaryRef matchDict = CFDictionaryCreateMutable(
                                                    kCFAllocatorDefault,
                                                    2,
                                                    &kCFTypeDictionaryKeyCallBacks,
                                                    &kCFTypeDictionaryValueCallBacks);
    int vid = 0x1234; // ToDo: Place your VID here
    CFNumberRef vid_num = CFNumberCreate(kCFAllocatorDefault, kCFNumberIntType, &vid);
    CFDictionarySetValue(matchDict, CFSTR(kUSBVendorID), vid_num);
    CFRelease(vid_num);

    IOHIDManagerSetDeviceMatching(HIDManager, matchDict);
    // Here we use the same callback for insertion & removal.
    // Use separate handlers if desired.
    IOHIDManagerRegisterDeviceMatchingCallback(HIDManager, Handle_UsbDetectionCallback, (__bridge void*)self);
    IOHIDManagerRegisterDeviceRemovalCallback(HIDManager, Handle_UsbDetectionCallback, (__bridge void*)self);
    IOHIDManagerScheduleWithRunLoop(HIDManager, CFRunLoopGetCurrent(), kCFRunLoopDefaultMode);
    IOHIDManagerOpen(HIDManager, kIOHIDOptionsTypeNone);
}

// New USB device specified in the matching dictionary has been added (callback function)
static void Handle_UsbDetectionCallback(void *inContext, IOReturn inResult, void *inSender, IOHIDDeviceRef inIOHIDDeviceRef) {
    //ToDo: Code for dealing with the USB device
}

@end 
```

# clojure - 康达, 康迪, 康德, 康杜

> ID：10843563
> 
> 赞同：31
> 
> 时间：2012-06-01T02:08:39.647
> 
> 标签：clojure, scheme, clojure-core.logic, minikanren, reasoned-schemer

我正在阅读[Reasoned Schemer](http://mitpress.mit.edu/catalog/item/default.asp?ttype=2&tid=10663)。

我对如何`conde`工作有一些直觉。

但是，我找不到///做什么的`conde`正式定义`conda`。`condu``condi`

我知道[https://www.cs.indiana.edu/~webyrd/](https://www.cs.indiana.edu/~webyrd/)但这似乎有例子而不是定义。

某处有`conde`, `conda`, `condi`,的正式定义吗？`condu`

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-06-01T10:51:04.557

用 Prolog 的话来说，

*   **`condA`**是*“软切”*又名**`*->`**，哪里`A *-> B ; C`像`(A, B ; not(A), C)`，只有*更好* ；然而

*   **`condU`**是*“承诺的选择”*，是`once`和软切的组合，因此`(once(A) *-> B ; false)`表示`(A, !, B)`（带有*切入*）：

```
condA:     A        *->  B  ;  C        %  soft cut,
                                        %     (A ,    B ; not(A) , C)
condU:     once(A)  *->  B  ;  C        %  committed choice,
                                        %     (A , !, B ; not(A) , C) 
```

（分别带有*“或”*的**`;`**意思*和“和”*的意思，即目标的*分离*和*结合*）。***`,`***

 ***在**`condA`**中，如果目标`A`成功，则将所有解决方案传递给第一个子句，并且不尝试`B`替代子句。`C`

In **`condU`**,`once/1`允许其参数目标仅成功一次（仅保留一个解决方案，如果有的话）。

**`condE`**是连词的简单析取，并且**`condI`**是在其成分的解之间*交替的析取，**交错*其流。

* * *

这是一个尝试将本书的代码忠实地翻译成 18 行 Haskell 代码，不包括逻辑变量和统一，这主要是一个*带有语法*的惰性 Lisp 。^( * ^)看看这是否澄清了一些事情：

*   顺序流组合（**`mplus`**书上的“”）：

```
 (1)   []     ++: ys  =  ys
    (2)   (x:xs) ++: ys  =  x : (xs ++: ys) 
```

*   交替流组合（“ **`mplusI`**”）：

    ```
     (3)   []     ++/ ys  =  ys
      (4)   (x:xs) ++/ ys  =  x : (ys ++/ xs) 
    ```

*   顺序供稿（“ **`bind`**”）：

    ```
     (5)   []     >>: g  =  []
      (6)   (x:xs) >>: g  =  g x ++: (xs >>: g) 
    ```

*   交替进纸（“ **`bindI`**”）：

    ```
     (7)   []     >>/ g  =  []
      (8)   (x:xs) >>/ g  =  g x ++/ (xs >>/ g) 
    ```

*   “ `OR`”*目标*组合（“ **`condE`**”）：

    ```
     (9)   (f ||: g) x  =  f x ++: g x 
    ```

*   “交替`OR`”目标组合（“ **`condI`**”）：

    ```
     (10)  (f ||/ g) x  =  f x ++/ g x 
    ```

*   “ `AND`”目标组合（“ **`all`**”）：

    ```
     (11)  (f &&: g) x  =  f x >>: g 
    ```

*   “交替`AND`”目标组合（“**`allI`**书”）：

    ```
     (12)  (f &&/ g) x  =  f x >>/ g 
    ```

*   特殊目标

    ```
     (13)  true  x  =  [x]  -- a sigleton list with the same solution repackaged
      (14)  false x  =  []   -- an empty list, meaning the solution is rejected 
    ```

*给定问题的（可能部分）解决方案，*目标会产生（可能是更新的）解决方案的流（可能是空的）。**

 *重写规则为**`all`**：

```
(all)      =  true
(all  g1)  =  g1
(all  g1 g2 g3 ...)  =  (\x -> g1 x >>: (all g2 g3 ...))
                     =  g1 &&: (g2 &&: (g3 &&: ... ))
(allI g1 g2 g3 ...)  =  (\x -> g1 x >>/ (allI g2 g3 ...))
                     =  g1 &&/ (g2 &&/ (g3 &&/ ... )) 
```

重写规则为**`condX`**：

```
(condX)  =  false
(condX (else g1 g2 ...))  =  (all g1 g2 ...)  =  g1 &&: (g2 &&: (...))
(condX (g1 g2 ...))       =  (all g1 g2 ...)  =  g1 &&: (g2 &&: (...))
(condX (g1 g2 ...) (h1 h2 ...) ...)  =  (ifX g1 (all g2 ...) 
                                          (ifX h1 (all h2 ...) (...) )) 
```

为了得到最终的**`condE`**and**`condI`**的翻译，没有必要实现本书的**`ifE`**and **`ifI`**，因为它们进一步简化为简单的运算符组合，所有运算符都被认为是*右结合的*：

```
(condE (g1 g2 ...) (h1 h2 ...) ...)  =
     (g1 &&: g2 &&: ... )  ||:  (h1 &&: h2 &&: ...)  ||:  ...
(condI (g1 g2 ...) (h1 h2 ...) ...)  =
     (g1 &&: g2 &&: ... )  ||/  (h1 &&: h2 &&: ...)  ||/  ... 
```

所以在 Haskell 中不需要任何特殊的“语法”，简单的二进制中缀运算符就足够了。任何组合都可以在任何地方使用，`&&/`而不是`&&:`根据需要。但另一方面**`condI`**，也可以将其实现为接受要实现的目标集合（列表、树等）的函数，这将使用一些智能策略来选择最有可能或最需要的目标等，而不仅仅是`||/`运算符（或**`ifI`**书本）中的简单二元交替。

接下来，这本书**`condA`**可以由*两个*新的运算符`~~>`和`||~`一起建模。我们可以以自然的方式使用它们，例如

```
g1 ~~> g2 &&: ...  ||~  h1 ~~> h2 &&: ...  ||~  ...  ||~  gelse 
```

可以直观地理解为“ `IF g1 THEN g2 AND ... OR-ELSE IF h1 THEN ... OR-ELSE gelse`”：

*   " `IF-THEN`" 目标组合是产生一个*“尝试”*目标，必须用失败-继续目标来调用它：

    ```
     (15)  (g ~~> h) f x  =  case g x of [] -> f x  ;  ys -> ys >>: h 
    ```

*   " `OR-ELSE`" 一个*try*目标和一个简单目标的目标组合只是将它的*try*目标与第二个失败时目标一起调用，因此它只不过是一种用于操作数自动分组的便捷语法：

    ```
     (16)  (g ||~ f) x  =  g f x 
    ```

由于“ `OR-ELSE`”`||~`运算符的绑定能力低于“ `IF-THEN`”`~~>`运算符并且也具有右关联性，并且`~~>`运算符的绑定能力仍小于`&&:`等，因此自动生成上述示例的合理分组为

```
(g1 ~~> (g2 &&: ...))  ||~  ( (h1 ~~> (h2 &&: ...))  ||~  (...  ||~  gelse ...) ) 
```

因此，链中的最后一个目标`||~`必须是一个简单的目标。这实际上没有限制，因为**`condA`**form 的最后一个子句无论如何都等同于简单`AND`的 " " - 其目标的组合（或者`false`也可以使用简单的）。

就这样。如果我们愿意，我们甚至可以有更多类型的*try*目标，由不同类型的 " " 运算符表示：`IF`

*   **`condAI`**在成功的子句中使用交替提要（如果书中有一个可以称为的模型）：

    ```
     (17)  (g ~~>/ h) f x  =  case g x of [] -> f x  ;  ys -> ys >>/ h 
    ```

*   *仅使用一次*成功的解决方案流来产生*剪切*效果，以建模**`condU`**：

    ```
     (18)  (g ~~>! h) f x  =  case g x of [] -> f x  ;  (y:_) -> h y 
    ```

**`condA`**因此，最后，**`condU`**本书的重写规则很简单：

```
(condA (g1 g2 ...) (h1 h2 ...) ...)  = 
      g1 ~~> g2 &&: ...  ||~  h1 ~~> h2 &&: ...  ||~  ... 

(condU (g1 g2 ...) (h1 h2 ...) ...)  = 
      g1 ~~>! g2 &&: ...  ||~  h1 ~~>! h2 &&: ...  ||~  ... 
```

* * *

^( * ^)即：

*   简单的*并列*是*柯里化函数应用*，
    `f a b c =~= (((f a) b) c) =~= f(a, b, c)`
*   `(\ a -> b )`是*lambda 函数，* `(lambda (a) b)`
*   `foo x = y`是捷径`foo = (\ x -> y )`
*   `a @@ b = y``(@@) a b = y`是中缀运算符定义的快捷方式`@@`
*   括号`(` `)`仅用于分组
*   `[]`是空列表，*并且*
*   `:`表示*cons* - 作为构造函数（*惰性*，因为整个语言都是*惰性*的，即按需*调用*），在定义的*右侧*`=`；并作为解构模式，在*左侧*（或在模式匹配`case`表达式中）。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-06-01T12:34:35.790

Reasoned Schemer 涵盖**conda**（软切）和**condu**（承诺选择）。您还可以在 William Byrd[关于 miniKanren 的优秀论文](https://scholarworks.iu.edu/dspace/bitstream/handle/2022/8777/Byrd_indiana_0093A_10344.pdf?sequence=1)中找到对他们行为的解释。您已将此帖子标记为关于 core.logic。需要明确的是，core.logic 是基于 miniKanren 的更新版本，而不是 The Reasoned Schemer 中介绍的版本。miniKanren 总是交错分离目标 - condi**和**交错变体不再存在。**conde现在** *是* **condi**。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-31T18:08:05.200

例如，使用 core.logic：

conde 将运行每个组，如果至少一个组成功，则成功，并**返回所有成功组的所有结果。**

```
user>  (run* [w q]
                (conde [u#]
                       [(or* [(== w 1) (== w 2)])
                        (== q :first)]
                       [(== q :second)]))
([_0 :second] [1 :first] [2 :first]) 
```

conda 和 condu：都将在第一个成功组后停止（从上到下）

conda**仅返回第一个成功组的所有结果。**

```
user> (run* [w q]
                (conda [u#]
                       [(or* [(== w 1) (== w 2)])
                        (== q :first)]
                       [(== q :second)]))
([1 :first] [2 :first]) 
```

condu**仅从第一个成功组返回一个结果。**

```
user> (run* [w q]
                (condu [u#]
                       [(or* [(== w 1) (== w 2)])
                        (== q :first)]
                       [(== q :second)]))
([1 :first]) 
```

不知道 condi 做了什么。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-12T14:48:40.413

根据 ISO Prolog 核心标准，控制结构如 (,)/2、(;)/2 和 (->)/2 是透明的。(*->)/2 在 ISO Prolog 核心标准中找不到，但通常 Prolog 系统实现它也很透明。

这意味着无法翻译：

```
once(A) *-> B;C 
```

进`A, !, B; C`。因为后者可能嵌入在其他控制结构中，如果它们之间存在分离，这些选择点也会被切掉。另一方面，似乎是合理的，将其视为`A -> B; C`，

简称为 ISO Prolog 核心标准**if-then-else**。如此定义的剪切行为例如对于打破重复循环很有用，而不会引发异常。通常的编程模式更难以使用 if-then-else 归档。****

# html - 如何使用 CSS 精灵表作为背景？

> ID：10843564
> 
> 赞同：2
> 
> 时间：2012-06-01T02:08:52.593
> 
> 标签：html, css

我想使用图像的一部分（CSS 精灵表）作为背景，但我认为没有办法定义它。

例如，我有一个`<a>`100 像素宽和 30 像素高的标签。我想使用一个图标作为精灵表中的背景图像。尽管我可以正确定位它，但我无法“修剪”精灵表以仅包含该图标，但它会继续显示精灵表的其余部分，因为该图标只有 16x16 像素并且`<a>`标签要大得多。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T02:16:14.927

您必须在工作表中为其保留一些空间并使其透明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:23:03.377

一种方法是`span`在您的内部创建一个`a`.

制作`span`一个`inline-block`元素，然后将其`width`和设置`height`为精灵的元素。

另一种方法是使用 css`clip`属性。你可以在这里找到一个很好的概述：http: [//css-tricks.com/css-sprites-with-inline-images/](http://css-tricks.com/css-sprites-with-inline-images/)

# c# - 需要 && 一起使用不定数量的 Func

> ID：10843565
> 
> 赞同：6
> 
> 时间：2012-06-01T02:09:02.627
> 
> 标签：c#, delegates, lambda

我正在尝试找到一种将最多 5 个 Func 累积应用于同一个 IEnumerable 的好方法。这是我想出的：

```
private Func<SurveyUserView,bool> _getFilterLambda(IDictionary<string, string> filters)
{
    Func<SurveyUserView, bool> invokeList = delegate(SurveyUserView surveyUserView)
    { 
        return surveyUserView.deleted != "deleted"; 
    };

    if (filters.ContainsKey("RegionFilter"))
    {
        invokeList += delegate(SurveyUserView surveyUserView)
        {
            return surveyUserView.Region == filters["RegionFilter"];
        };
    }

    if (filters.ContainsKey("LanguageFilter"))
    {
        invokeList += delegate(SurveyUserView surveyUserView)
        {
            return surveyUserView.Locale == filters["LanguageFilter"];
        };
    }

    if (filters.ContainsKey("StatusFilter"))
    {
        invokeList += delegate(SurveyUserView surveyUserView)
        { 
            return surveyUserView.Status == filters["StatusFilter"]; 
        };
    }

    if (filters.ContainsKey("DepartmentFilter"))
    {
        invokeList += delegate(SurveyUserView surveyUserView)
        {
            return surveyUserView.department == filters["DepartmentFilter"];
        };
    }

    return invokeList;
} 
```

我认为它会以累积的方式应用这些，但是，我可以从结果中看到它实际上只是应用了最后一个（DepartmentFilter）。

有 2^4 种可能的组合，所以如果/否则，蛮力是行不通的。（仅当字典中存在相应的键时，我才想使用特定的 lambda。）

编辑：这是我接受的解决方案，但在评估时会导致 StackOverflowException 。有人知道为什么吗？

```
private Func<SurveyUserView,bool> _getFilterLambda(IDictionary<string, string> filters )
    {

        Func<SurveyUserView, bool> resultFilter = (suv) => suv.deleted != "deleted";                                                        

        if (filters.ContainsKey("RegionFilter"))
        {
            Func<SurveyUserView, bool> newFilter =
                (suv) => resultFilter(suv) && suv.Region == filters["RegionFilter"];
            resultFilter = newFilter;
        }

        if (filters.ContainsKey("LanguageFilter"))
        {
            Func<SurveyUserView, bool> newFilter =
                 (suv) => resultFilter(suv) && suv.Locale == filters["LanguageFilter"];
            resultFilter = newFilter;
        }

        if (filters.ContainsKey("StatusFilter"))
        {
            Func<SurveyUserView, bool> newFilter =
                (suv) => resultFilter(suv) && suv.Status == filters["StatusFilter"];
            resultFilter = newFilter;
        }

        if (filters.ContainsKey("DepartmentFilter"))
        {
            Func<SurveyUserView, bool> newFilter =
                (suv) => resultFilter(suv) && suv.department == filters["DepartmentFilter"];
            resultFilter = newFilter;
        }

        return resultFilter;
    } 
```

编辑：这是一个很好的解释，为什么这会导致朋友和导师 Chris Flather 的 StackOverflowException -

The important thing to understanding why the infinite recursion occurs is understanding when the symbols in a lambda are resolved (i.e. at runtime and not at definition).

Take this simplified example:

```
Func<int, int> demo = (x) => x * 2;
Func<int, int> demo2 = (y) => demo(y) + 1;
demo = demo2;
int count = demo(1); 
```

If it were resolved statically at definition this would work and be the same as:

```
Func<int, int> demo2 = (y) => (y * 2) + 1;
Int count = demo2(1); 
```

But it doesn’t actually attempt to figure out what the demo embedded in demo2 does until runtime – at which time demo2 has been redefined to demo. Essentially the code now reads:

```
Func<int, int> demo2 = (y) => demo2(y) + 1;
Int count = demo2(1); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T02:13:51.677

Instead of trying to combine the delegates this way, you could build new delegates that use the existing one with your AND condition:

```
Func<SurveyUserView, bool> resultFilter = (suv) => true;

if (filters.ContainsKey("RegionFilter"))
{
    var tmpFilter = resultFilter;
    // Create a new Func based on the old + new condition
    resultFilter = (suv) => tmpFilter(suv) && suv.Region == filters["RegionFilter"];
}

if (filters.ContainsKey("LanguageFilter"))
{
   // Same as above...

//... Continue, then:

return resultFilter; 
```

That being said, it may be easier to pass your original `IQueryable<SurveyUserView>` or `IEnumerable<SurveyUserView>` into this method, and just add `.Where` clauses directly to filter. You could then return the final query without executing it, with the filters added on.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T02:18:23.190

I would think that using the `Where(...)` extension on what is, presumably, an `IQueryable<SurveyUserView>` and return a `IQueryable<SurveyUserView>` instead of a `Func<...>`:

```
// Assuming `q` is a `IQueryable<SurveyUserView>`

if(filters.ContainsKeys["Whatever"])
{
  q = q.Where(suv => suv.Status == filters["Whatever"];
} 
```

The `And`ing is implicit.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T03:01:40.767

```
 private Func<SurveyUserView, bool> _getFilterLabda(IDictionary<string, string> filters)
    {
        Func<SurveyUserView, bool> invokeList = surveyUserView => surveyUserView.deleted != "deleted");

        if (filters.ContainsKey("RegionFilter"))
        {
            invokeList += surveyUserView => surveyUserView.Region == filters["RegionFilter"]);
        }

        if (filters.ContainsKey("LanguageFilter"))
        {
            invokeList += surveyUserView => surveyUserView.Locale == filters["LanguageFilter"];
        }

        if (filters.ContainsKey("StatusFilter"))
        {
            invokeList += surveyUserView => surveyUserView.Status == filters["StatusFilter"];
        }

        if (filters.ContainsKey("DepartmentFilter"))
        {
            invokeList += surveyUserView => surveyUserView.department == filters["DepartmentFilter"]);
        }

        return invokeList;
    }
    ...
    Func<SurveyUserView, bool> resultFilter = suv => _getFilterLabda(filters)
         .GetInvocationList()
         .Cast<Func<SurveyUserView, bool>>()
         .All(del => del(suv)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-15T05:59:29.357

Here is my favorite method of accomplishing what you are asking for.

```
private Func<SurveyUserView, bool> _getFilterLambda(IDictionary<string, string> filters)
{
    List<Func<SurveyUserView, bool>> invokeList = new List<Func<SurveyUserView, bool>>();

    invokeList.Add((SurveyUserView surveyUserView) => surveyUserView.deleted != "deleted");

    if (filters.ContainsKey("RegionFilter"))
    {
        invokeList.Add((SurveyUserView surveyUserView) => surveyUserView.Region == filters["RegionFilter"]);
    }

    if (filters.ContainsKey("LanguageFilter"))
    {
        invokeList.Add((SurveyUserView surveyUserView) => surveyUserView.Locale == filters["LanguageFilter"]);
    }

    if (filters.ContainsKey("StatusFilter"))
    {
        invokeList.Add((SurveyUserView surveyUserView) => surveyUserView.Status == filters["StatusFilter"]);
    }

    if (filters.ContainsKey("DepartmentFilter"))
    {
        invokeList.Add((SurveyUserView surveyUserView) => surveyUserView.department == filters["DepartmentFilter"]);
    }

    return delegate (SurveyUserView surveyUserView)
    {
        bool unfiltered = true;

        foreach(var filter in invokeList)
        {
            unfiltered = unfiltered && filter(surveyUserView);
        }

        return unfiltered;
    };
} 
```

We build a list of each of the delegates you want to apply; and then return another seperate delegate that iterates over that list combining each of the filters with a simple logical AND.

This works because the delegate we're returning closes over invokeList; creating a kind of private variable that stores all of our new delegates that travels with our returned delegate.

An alternative which is slightly closer syntactically to your original is:

```
private Func<SurveyUserView, bool> _getFilterLambda(IDictionary<string, string> filters)
{
    Func<SurveyUserView, bool> invokeList = (SurveyUserView surveyUserView) => surveyUserView.deleted != "deleted";

    if (filters.ContainsKey("RegionFilter"))
    {
        invokeList += (SurveyUserView surveyUserView) => surveyUserView.Region == filters["RegionFilter"];
    }

    if (filters.ContainsKey("LanguageFilter"))
    {
        invokeList += (SurveyUserView surveyUserView) => surveyUserView.Locale == filters["LanguageFilter"];
    }

    if (filters.ContainsKey("StatusFilter"))
    {
        invokeList += (SurveyUserView surveyUserView) => surveyUserView.Status == filters["StatusFilter"];
    }

    if (filters.ContainsKey("DepartmentFilter"))
    {
        invokeList += (SurveyUserView surveyUserView) => surveyUserView.department == filters["DepartmentFilter"];
    }

    return delegate (SurveyUserView surveyUserView)
    {
        bool unfiltered = true;

        // implicit cast from Delegate to Func<SurveyUserView, bool> happening on next line
        foreach (Func<SurveyUserView, bool> filter in invokeList.GetInvocationList())
        {
            unfiltered = unfiltered && filter(surveyUserView);
        }

        return unfiltered;
    };
} 
```

In this version we're really just using invokeList as a list for the delegates; we call GetInvocationList() (a method on the Delegate class Func derives from) to get a list of all the delegates that are combined to make the multi-cast delegate.

I personally prefer the first version because it is clearer what is happening behind the scenes.

Both of these are really the same as [Jacob Seleznev's answer](https://stackoverflow.com/questions/10843565/need-to-together-an-indeterminate-number-of-functentity-bool/10843862#10843862) which I somehow missed before responding. They just bring the final delegate inside the method so that the method itself still satisfies Trey's original contract.

Finally, if all of the filters are order-independent with no side-effects we can write a version that will run the filters in parallel.

```
private Func<SurveyUserView, bool> _getFilterLambdaParallel(IDictionary<string, string> filters)
{
    List<Func<SurveyUserView, bool>> invokeList = new List<Func<SurveyUserView, bool>>();

    invokeList.Add((SurveyUserView surveyUserView) => surveyUserView.deleted != "deleted");

    if (filters.ContainsKey("RegionFilter"))
    {
        invokeList.Add((SurveyUserView surveyUserView) => surveyUserView.Region == filters["RegionFilter"]);
    }

    if (filters.ContainsKey("LanguageFilter"))
    {
        invokeList.Add((SurveyUserView surveyUserView) => surveyUserView.Locale == filters["LanguageFilter"]);
    }

    if (filters.ContainsKey("StatusFilter"))
    {
        invokeList.Add((SurveyUserView surveyUserView) => surveyUserView.Status == filters["StatusFilter"]);
    }

    if (filters.ContainsKey("DepartmentFilter"))
    {
        invokeList.Add((SurveyUserView surveyUserView) => surveyUserView.department == filters["DepartmentFilter"]);
    }

    return delegate (SurveyUserView surveyUserView)
    {
        int okCount = 0;
        Parallel.ForEach(invokeList, delegate (Func<SurveyUserView, bool> f)
        {
            if (f(surveyUserView))
            {
                System.Threading.Interlocked.Increment(ref okCount);
            }
        });
        return okCount == invokeList.Count;
    };
} 
```

We use Parallel.ForEach to execute the filters in parallel. There is a slight complication that prevents us from using our simple boolean AND - there is no guarantee that the logical AND will happen atomically creating a nasty race condition.

To fix that we simply count the number of filters that were passed through using Interlocked.Increment which is guaranteed to be atomic. If all the filters passed through successfully then we know we can return true; otherwise the and would have failed.

The equivalent for doing a logical OR here would have to check with okCount was more than zero.

# python - Python：从文本文件中删除行的最有效方法

> ID：10843566
> 
> 赞同：-2
> 
> 时间：2012-06-01T02:09:02.907
> 
> 标签：python, string, list

如何进行 for 循环并更改列表中的条目？就像 , 的等价物`[line.strip() for line in lines]`，除了`line.strip()`保存回行列表。

这是必需的，因为我使用的是存储在列表中的大型数据集。该数据集将用于机器训练以训练分类器。具体来说，使用 NLTK 库的自然语言处理。因此，阵列的复制是不可行的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:11:31.263

这个怎么样：

```
lines = [line.strip() for line in lines] 
```

它创建了另一个列表（尽管它都存储在内存中，这可能是很多行的问题）。

*或者*，您可以使用[生成器表达式](http://docs.python.org/reference/expressions.html#generator-expressions)来避免潜在的内存问题，并按需创建行：

```
lines = (line.strip() for line in lines) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T02:13:06.143

使用生成器表达式，则不会同时保留所有行。

```
glines = (line.strip() for line in lines) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T02:16:27.730

您是否要将结果存储到同一个实例中`lines`（而不是替换为新的列表实例）？

```
lines[:] = [line.strip() for line in lines] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T02:19:22.523

如果我理解正确，您是在尝试从文件*中*删除行，而不是创建一个全新的列表。问题是在 Python 中[字符串是不可变的](https://stackoverflow.com/a/1538685/631586)，所以你不能就地修改一个字符串，你必须创建一个新的。

正如其他人所建议的那样，生成器表达式将按需生成剥离的字符串，而不是将它们全部存储在新列表中，从而减少内存需求。如果您*真的*想将字符串剥离到位，那么这样的事情就可以完成：

```
for i, line in enumerate(lines): lines[i] = line.strip() 
```

但无论如何，创建一个新列表可能会更快。

# sql-server - SQL Server 错误：字符串或二进制数据将被截断

> ID：10843567
> 
> 赞同：15
> 
> 时间：2012-06-01T02:09:10.193
> 
> 标签：sql-server, sql-server-2005

我的桌子：

```
log_id                 bigint
old_value                  xml
new_value                  xml
module                 varchar(50)
reference_id           bigint
[transaction]          varchar(100)
transaction_status         varchar(10)
stack_trace                ntext
modified_on                datetime
modified_by                bigint 
```

插入查询：

```
INSERT INTO [dbo].[audit_log]
           ([old_value],[new_value],[module],[reference_id],[transaction]
           ,[transaction_status],[stack_trace],[modified_on],[modified_by])
     VALUES
            ('asdf','asdf','Subscriber',4,'_transaction',
            '_transaction_status','_stack_trace',getdate(),555) 
```

错误 ：

```
Msg 8152, Level 16, State 14, Line 1
String or binary data would be truncated.
The statement has been terminated. 
```

这是为什么 ？？？

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-06-01T02:24:16.327

您正在尝试写入比特定列可以存储更多的数据。根据每个字段的大小检查您尝试插入的数据的大小。

在这种情况下，transaction_status 是一个 varchar(10) 并且您尝试将 19 个字符存储到它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-22T09:20:31.607

这种类型的错误通常发生在您必须放置的字符或值超过您在数据库表中指定的数量时，例如在这种情况下：您指定 `transaction_status varchar(10)` 但您实际上尝试存储
`_transaction_status` 包含 19 个字符的字符或值。这就是为什么您在此代码中遇到此类错误的原因..

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-06-05T09:07:34.273

在其中一列是 VARCHAR 或 CHAR 数据类型且插入值的长度大于列长度的表中插入记录时，通常会遇到此错误。

我不满意微软如何决定用这个“干巴巴的”响应消息来通知，而没有任何地方可以寻找答案。

# javascript - 如何使用 const 关键字创建 Javascript 常量作为对象的属性？

> ID：10843572
> 
> 赞同：55
> 
> 时间：2012-06-01T02:09:44.403
> 
> 标签：javascript, object, properties, constants

为什么不能将常量设置为本身就是变量的对象的属性？

```
const a  = 'constant' // all is well
// set constant property of variable object
const window.b = 'constant' // throws Exception
// OR
var App = {};  // want to be able to extend
const App.goldenRatio= 1.6180339887  // throws Exception 
```

又是如何通过引用传递的常量突然变成变量的呢？编辑：我知道 App 不会（或者更确切地说......不应该）是可变的；这只是一个观察...

```
(function() {
    const App;
    // bunch of code
    window.com_namespace = App;
}());
window.com_namespace; // App
window.com_namespace = 'something else';
window.com_namespace; // 'something else' 
```

一个组织良好、可扩展、面向对象、包含常量的单一命名空间的库如何在这些限制下创建？

编辑：我相信 zi42，但我只需要问[为什么](https://stackoverflow.com/questions/10843809/why-is-it-impossible-to-assign-constant-properties-of-javascript-objects-using-t)

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-06-01T02:14:14.063

你不能用常量来做到这一点。做某事的行为如你所愿但不使用常量的唯一可能方法是定义一个不可写属性：

```
var obj = {};
Object.defineProperty( obj, "MY_FAKE_CONSTANT", {
  value: "MY_FAKE_CONSTANT_VALUE",
  writable: false,
  enumerable: true,
  configurable: true
}); 
```

关于为什么`const`传递给函数的问题变成变量，答案是因为它是通过值而不是通过引用传递的。该函数正在获取一个与常量具有相同值的新变量。

**编辑**：感谢@pst 注意到javascript中的对象文字实际上不是“通过引用传递”，而是使用[共享调用](https://en.wikipedia.org/wiki/Evaluation_strategy#Call_by_sharing)：

> 尽管该术语在 Python 社区中广泛使用，但在其他语言（如 Java 和 Visual Basic）中，相同的语义通常被描述为按值调用，其中值暗示为对对象的引用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-08-02T03:19:54.583

```
const person = {
    name: "Nicholas"
};

// works
person.name = "Greg";

console.log(person) //Greg 
```

这就是为什么使用 Object.defineProperty

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-07-15T10:10:25.493

有一种更简单的方法可以做到这一点。我喜欢这种模式。简单的对象。

```
window.Thingy = (function() {

    const staticthing = "immutable";

    function Thingy() {

        let privateStuff = "something";

        function get() {
            return privateStuff;
        }

        function set(_) {
            privateStuff = _;
        }
        return Object.freeze({
            get,
            set,
            staticthing
        });
    }

    Thingy.staticthing = staticthing;
    return Object.freeze(Thingy);
})();

let myThingy = new Thingy();

Thingy.staticthing = "fluid";

myThingy.staticthing = "fluid";

console.log(Thingy.staticthing); // "immutable"
console.log(myThingy.staticthing); // "immutable" 
```

Object.freeze 在这里做的工作

[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze)

如果您愿意，可以通过将静态属性从构造函数返回的对象字面量中删除，从而将静态属性从实例中删除。

const 只会使其成为只读引用。一旦你分配它，就像这里的对象字面量一样，它就成为构造对象的属性。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-06-09T15:58:00.237

```
var obj = {};
Object.defineProperty( obj, "MY_FAKE_CONSTANT", {
  value: "MY_FAKE_CONSTANT_VALUE",
  writable: false,
  enumerable: true,
  configurable: false // instead of true
}); 
```

我们还应该将可**配置**设置为***false***，这样它就可以防止从 obj 中删除该属性

```
delete obj.MY_FAKE_CONSTANT; 
```

**配置**为***true***后，我们不再有MY_FAKE_CONSTANT*了*。

[参考](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/getOwnPropertyDescriptor%20%22%22)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-08-04T16:39:08.060

您不应该忘记[const 声明](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const)“创建对值的只读引用。这并不意味着它所持有的值是不可变的，只是不能重新分配变量标识符”

const 关键字的工作方式与 'let' 类似，因此您可以在另一个块中重新声明它

```
const MyConst = 5;
console.log('global MyConst =', MyConst); //global MyConst = 5
if(true){
  const MyConst = 99
  console.log('in if block, MyConst =', MyConst); //in if block, MyConst = 99
}
console.log('global MyConst still 5 ?', MyConst===5); //global MyConst still 5 ? true 
```

就像@ziad-saab 一样，如果你想要一个对象属性而不是像一个常量一样，你必须将它定义为一个不可写的属性。

如果您的常量是一个对象并且属性不应更改，请使用[Object.freeze()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze)使该对象不可变。

```
(function(){
  var App = { };
  // create a "constant" object property for App
  Object.defineProperty(App , "fixedStuff", {
    value: Object.freeze({ prop:6 }),
    writable: false,
    enumerable: true,
    configurable: true
  });

  Object.defineProperty(window, "com_namespace", {
    value: App,
    writable: false,
    enumerable: true,
    configurable: true
  });
})()

com_namespace.newStuff = 'An extension';
com_namespace.fixedStuff.prop = 'new value'; // do nothing!
console.log(com_namespace.fixedStuff.prop); //6 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-03-05T23:20:14.650

我认为您应该在属性中定义一个常量，使 Object.defineProperty 中的可配置：false 和可写：false，如果您离开可配置：true，那么您仍然可以对属性进行更改

例如：当您在 Object.defineProperty 中设置 configure:true 时

```
cosnt obj = {name: 'some name'};
Object.defineProperty(obj, 'name', {
  enumerable: true,
  configurable: true,
  writable: false
}); 
```

有了这个，你就可以让 obj.name 'constant' 但是你可以做到

```
Object.defineProperty(obj, 'name', {
  enumerable: true,
  configurable: true,
  writable: true // <-- you can set to true because configurable is true
}) 
```

但是，如果您将可配置设置为 false，那么您将永远无法编辑可写属性。

```
Object.defineProperty(obj, 'name', {
  enumerable: true,
  configurable: false, // <-- with this you never could edit writable property
  writable: false
}) 
```

对于所有属性，您可以使用 Object.freeze

```
Object.freeze(obj); 
```

Object.freeze 将仅迭代可枚举的属性

# java - 具有不同图像的 Android Button Blinkin 动画

> ID：10843575
> 
> 赞同：0
> 
> 时间：2012-06-01T02:10:01.767
> 
> 标签：java, android, animation, button

我正在开发一个 android 应用程序，我需要做一个按钮动画。

我是按钮的两个不同图像，我希望按钮的 setBackground 与这 2 个图像以 500 毫秒的延迟交替它们，总共只有 2 秒。

当我运行它们时，我怎么能做到这一点并让程序等待动画结束？

我的按钮有背景和文字。我想要这个顺序：单击按钮->警报对话框->如果是，退出对话框->调用动画（所有活动都等待这个动画）->在动画结束时调用另一个函数并继续程序

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T04:51:44.793

将下面的 xml 放在名称为“frame”的drawable中（例如，frame0 和 frame1 是两个不同的 umage）

```
<animation-list android:id="@+id/my_animation"
    android:oneshot="true" xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@drawable/frame0" android:duration="500" />
    <item android:drawable="@drawable/frame1" android:duration="500" />
    <item android:drawable="@drawable/frame0" android:duration="500" />
    <item android:drawable="@drawable/frame1" android:duration="500" />
</animation-list> 
```

将以下代码放入您的布局 xml

```
 <ImageButton
        android:id="@+id/imageView"
        android:src="@drawable/frame"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" /> 
```

在 oncreate() 方法中使用下面的代码

```
 ImageButton img = (ImageButton)findViewById(R.id.imageView);
        AnimationDrawable frameAnimation =    (AnimationDrawable)img.getDrawable();
        frameAnimation.setCallback(img);
        frameAnimation.setVisible(true, true);
        frameAnimation.start(); 
```

# ruby-on-rails - 如何在 Rails 中计算“有记录的天数”？

> ID：10843577
> 
> 赞同：2
> 
> 时间：2012-06-01T02:10:09.863
> 
> 标签：ruby-on-rails

Rails 为新记录添加并填充一`created_at`列。

如何使用 来计算在指定时间范围内有记录的天数？（注：计算天数，不计算记录）。

例如，假设我有一个 Post 模型，我如何计算去年有多少天有一个 Post？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T02:21:26.390

由于您要求使用 ruby​​ 方式，因此它是：

```
Post.where('created_at >= ?', 1.year.ago).map { |p| p.created_at.beginning_of_day }.uniq.size 
```

**更新**

您可以将以下内容放入您的 Post 模型中

```
def self.number_of_days
  where('created_at >= ?', 1.year.ago).map { |p| p.created_at.beginning_of_day }.uniq.size
end 
```

然后在您的控制器中，您可以执行以下操作

```
@user.posts.number_of_days 
```

这是一种将大部分工作委托给数据库的更有效方式（MySQL，不确定它是否适用于其他数据库）：

```
Post.where('created_at >= ?', 1.year.ago).group('DATE(created_at)').length 
```

# uiwebview - UISplitViewController 中断媒体查询。解决方法？

> ID：10843580
> 
> 赞同：1
> 
> 时间：2012-06-01T02:10:20.423
> 
> 标签：uiwebview, uisplitviewcontroller, media-queries

似乎 UIWebView 包含在拆分视图控制器中的视图控制器中，Web 视图报告自己处于纵向模式，从 CSS3 媒体查询的角度来看具有 768 像素宽的视口。

我已经构建了几个最小测试用例应用程序来重现此错误/功能。当 Web 视图位于作为窗口根视图的视图控制器中时，它不存在。如果拆分视图控制器位于选项卡栏控制器内，它也不存在。您甚至可以将 web-view-bearing 视图控制器放置在拆分视图控制器的详细信息窗格内的选项卡栏控制器内，并避免此错误。

但是，我想简单地拥有一个拆分视图控制器，它是窗口的根视图，并包含一个详细视图控制器，它仍然正确地尊重媒体查询。有谁知道实现这一目标的方法？

我试过了：

*   覆盖细节视图控制器的`parentViewController`属性（返回`nil`）
*   覆盖详细视图控制器的`splitViewController`属性（同上）
*   覆盖详细视图控制器的`didRotateToInterfaceOrientation`方法
*   覆盖详细视图控制器的`willRotateToIntefaceOrientation`方法

我正在调查：

*   使用不同的媒体查询
*   使用第三方拆分视图替换（例如 MGSplitViewController）
*   使用 JavaScript 手动注入适当的样式表

如果有人遇到此问题并找到解决方案，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:22:10.570

事实证明，导致纵向/横向混淆的不是拆分视图控制器*本身*（或标签栏控制器）。

基本上，如果 UIWebView 的高度大于宽度，则操作系统会将其视为纵向模式，如果宽度大于高度，则操作系统会将其视为横向模式。

标签栏控制器的存在足以使高度 (768 - 20 - 49 = 699) 小于宽度 (1024 - 320 - 1 (gutter) = 703)。

# multithreading - _ReadWriteBarrier 是否确保跨线程动态分配的缓冲区的可见性？

> ID：10843582
> 
> 赞同：2
> 
> 时间：2012-06-01T02:10:53.757
> 
> 标签：multithreading, visual-c++, memory-barriers

我正在使用 Visual C++ 和 Windows 7 和 XP。我在一个程序中有两个线程，在创建两个线程之后，一个线程动态创建一个缓冲区并将其地址分配给一个全局指针，然后将数据写入该缓冲区。调用 _ReadWriteBarrier 会保证该数据对第二个线程的可见性吗？

例如：

```
char *buff;
HANDLE EventObject;

main()
{
    // Create an event object so we can signal the second thread
    // when it is time to read the buffer.

    EventObject = CreateEvent(NULL, TRUE, FALSE, NULL);

    // Create the second thread.

    CreateThread(NULL, 0, ThreadProc, NULL, 0);

    // Allocate the buffer.

    buff = (char*)malloc(100);

    // Write some data to the buffer.

    buff[50] = rand() % 256;

    // Set the fence here.

    _ReadWriteBarrier();

    // Signal the other thread that data is ready.

    SetEvent(EventObject);

    // Go on our merry way in this thread.
    .
    .
    .
}

ThreadProc(void* p)
{

    // Wait for the signal that data is ready.

    WaitForSingleObject(EventObject, INFINITE);

    // Read the data written to the buffer.

    printf("%d\n", buff[50]);
} 
```

我相信从保证地址可见性的[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/f20w0x5e%28v=vs.85%29.aspx)中，就像一个全局变量一样。但它是否也保证了创建的*缓冲区本身*的可见性？甚至有必要吗？`_ReadWriteBarrier``buff``buff`*`main`*

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T07:13:43.993

如果使用`SetEvent`，则根本不需要屏障。该事件会解决这个问题。

通常，要使屏障产生明显的效果，您需要在两侧（写入和读取侧）使用它们。因为`SetEvent`/`WaitForSingleObject`都充当障碍，所以你很好。*

# jruby - 在 Solaris 上使用 JRuby 的 Rails 3.2

> ID：10843587
> 
> 赞同：2
> 
> 时间：2012-06-01T02:12:11.513
> 
> 标签：jruby, ruby-on-rails-3.2, solaris-10

有没有人设法让 Rails 3.2 使用 JRuby 在 Solaris-10 上工作？

我们似乎陷入了一个令人讨厌的依赖漩涡。Rails 3.2 需要 JRuby 1.6.6 或更高版本，根据：[Using JRuby with Rails 3.2](https://stackoverflow.com/questions/9072070/using-jruby-with-rails-3-2)

但是 JRuby 1.6.5 是最后一个可以在 Solaris 上成功安装 gems 的版本：http: [//jira.codehaus.org/browse/JRUBY-6494](http://jira.codehaus.org/browse/JRUBY-6494)

有没有可能有补丁或者我们没有想到的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-05T14:11:38.093

我们有一个在 Solaris 上运行的 Rails 3.2.2 应用程序。我们使用的是 JRuby 1.6.5.1 和最新的莺，但我相信我们不得不将 jruby-rack 降级到 1.1.5。

不工作的是资产编译，因为我们还没有找到一个工作的 JavaScript 运行时。Node.js 不支持 Solaris Sparc，并且 therubyracer 存在编译问题，我们没有花太多时间尝试解决。因此，我们目前在本地开发工作站 (Windows) 上预编译资产。我们并没有真正使用资产管道（而且我不相信将其设置为 Rails 默认值是个好主意），因此我们可以禁用它，以便我们可以在 Solaris 上运行 CI 构建。

这是 gemfile.lock：

```
GEM
  remote: https://rubygems.org/
  specs:
    actionmailer (3.2.2)
      actionpack (= 3.2.2)
      mail (~> 2.4.0)
    actionpack (3.2.2)
      activemodel (= 3.2.2)
      activesupport (= 3.2.2)
      builder (~> 3.0.0)
      erubis (~> 2.7.0)
      journey (~> 1.0.1)
      rack (~> 1.4.0)
      rack-cache (~> 1.1)
      rack-test (~> 0.6.1)
      sprockets (~> 2.1.2)
    activemodel (3.2.2)
      activesupport (= 3.2.2)
      builder (~> 3.0.0)
    activerecord (3.2.2)
      activemodel (= 3.2.2)
      activesupport (= 3.2.2)
      arel (~> 3.0.2)
      tzinfo (~> 0.3.29)
    activerecord-jdbc-adapter (1.2.2)
    activerecord-jdbcsqlite3-adapter (1.2.2)
      activerecord-jdbc-adapter (~> 1.2.2)
      jdbc-sqlite3 (~> 3.7.2)
    activerecord-oracle_enhanced-adapter (1.4.1)
    activeresource (3.2.2)
      activemodel (= 3.2.2)
      activesupport (= 3.2.2)
    activesupport (3.2.2)
      i18n (~> 0.6)
      multi_json (~> 1.0)
    arel (3.0.2)
    bouncy-castle-java (1.5.0146.1)
    builder (3.0.0)
    coffee-rails (3.2.2)
      coffee-script (>= 2.2.0)
      railties (~> 3.2.0)
    coffee-script (2.2.0)
      coffee-script-source
      execjs
    coffee-script-source (1.2.0)
    erubis (2.7.0)
    execjs (1.3.0)
      multi_json (~> 1.0)
    hike (1.2.1)
    i18n (0.6.0)
    jdbc-sqlite3 (3.7.2)
    journey (1.0.3)
    jquery-rails (2.0.1)
      railties (>= 3.2.0, < 5.0)
      thor (~> 0.14)
    jruby-openssl (0.7.6.1)
      bouncy-castle-java (>= 1.5.0146.1)
    json (1.6.5)
    json (1.6.5-java)
    mail (2.4.3)
      i18n (>= 0.4.0)
      mime-types (~> 1.16)
      treetop (~> 1.4.8)
    mime-types (1.17.2)
    multi_json (1.1.0)
    polyglot (0.3.3)
    rack (1.4.1)
    rack-cache (1.2)
      rack (>= 0.4)
    rack-ssl (1.3.2)
      rack
    rack-test (0.6.1)
      rack (>= 1.0)
    rails (3.2.2)
      actionmailer (= 3.2.2)
      actionpack (= 3.2.2)
      activerecord (= 3.2.2)
      activeresource (= 3.2.2)
      activesupport (= 3.2.2)
      bundler (~> 1.0)
      railties (= 3.2.2)
    railties (3.2.2)
      actionpack (= 3.2.2)
      activesupport (= 3.2.2)
      rack-ssl (~> 1.3.2)
      rake (>= 0.8.7)
      rdoc (~> 3.4)
      thor (~> 0.14.6)
    rake (0.9.2.2)
    rdoc (3.12)
      json (~> 1.4)
    sass (3.1.15)
    sass-rails (3.2.4)
      railties (~> 3.2.0)
      sass (>= 3.1.10)
      tilt (~> 1.3)
    sprockets (2.1.2)
      hike (~> 1.2)
      rack (~> 1.0)
      tilt (~> 1.1, != 1.3.0)
    therubyrhino (1.73.1)
    thor (0.14.6)
    tilt (1.3.3)
    treetop (1.4.10)
      polyglot
      polyglot (>= 0.3.1)
    tzinfo (0.3.32)
    uglifier (1.2.3)
      execjs (>= 0.3.0)
      multi_json (>= 1.0.2) 
```

我希望 JRuby 团队会花一些时间让 JRuby 1.7 在 Solaris 上运行。否则我们将不得不加快向 linux 的迁移……

# dependency-injection - 如何使用 Func 注册通用接口（servicestack fork）

> ID：10843588
> 
> 赞同：2
> 
> 时间：2012-06-01T02:12:37.063
> 
> 标签：dependency-injection, servicestack

```
container.Register <IRep<T>>(c => new Rep<T>())); /// Exception :)

container.RegisterAllTypesOf<IRep> (....) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T05:51:23.993

Funq 不支持开箱即用，请参阅所有者的此评论 -[如何注册通用服务](http://funq.codeplex.com/discussions/79357)。您最好的选择是利用您提供自己容器的能力。我知道 Autofac 支持这一点 - [Autofac Open Generics](http://code.google.com/p/autofac/wiki/OpenGenerics)

# jenkins - 如何通过 Jenkins 凭据？

> ID：10843589
> 
> 赞同：1
> 
> 时间：2012-06-01T02:12:43.263
> 
> 标签：jenkins

我正在尝试[通过 Web API 遵循 Set Hudson Build Description](https://stackoverflow.com/questions/4870187/set-hudson-build-description-via-web-api)中给出的建议，但我收到 403 大概是因为必须对请求进行身份验证。由于脚本是从经过身份验证的 Jenkins 会话中运行的，我如何传递这些凭据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T08:22:23.500

看起来您需要在请求中传递用户和 api 令牌。[这是一个示例](https://wiki.jenkins-ci.org/display/JENKINS/Authenticating+scripted+clients)（不是在 Python 中，但我想您可以管理翻译）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T22:39:43.133

使用在同一 VM 中执行的“执行系统 ​​Groovy 脚本”构建任务，因此您不必重新验证或手动传递令牌或凭据。

# php - 有没有办法阻止 HTMLPurifier/CSStidy 强制输入 CSS 全部小写？

> ID：10843600
> 
> 赞同：1
> 
> 时间：2012-06-01T02:15:09.700
> 
> 标签：php, codeigniter, case-insensitive, htmlpurifier, csstidy

像这样使用 PHP/Codeigniter/HTMLPurifier/CSStidy：

```
require_once 'extra/htmlpurifier-4_4_0/library/HTMLPurifier.auto.php';
require_once 'extra/csstidy-1_3/class.csstidy.php';

$input_css = $this->input->post('input_css');

$config = HTMLPurifier_Config::createDefault();
$config->set('Filter.ExtractStyleBlocks', TRUE);

// Create a new purifier instance
$purifier = new HTMLPurifier($config);

// Wrap our CSS in style tags and pass to purifier. 
// we're not actually interested in the html response though
$html = $purifier->purify('<style>'.$input_css.'</style>');

// The "style" blocks are stored seperately
$output_css = $purifier->context->get('StyleBlocks');

// Get the first style block
$unClean_css = $input_css;
$clean_css = $output_css[0]; 
```

...有没有办法关闭 HTMLPurifier 或 CSStidy 中导致`$clean_css`强制转换为小写的任何内容？就大小写而言，我需要单独留下输出。我只是不使用 CSStidy，但它在安全性和压缩等方面工作得很好。只是考虑到区分大小写，它还占用了一些（例如背景图像）文件路径。我无法从头开始解决问题（即我不能只强制全部小写）......所以我按照我的方式提出问题。也许是配置设置？（我希望）......我一直在寻找，但还没有看到一个能做到这一点的人。

**更新**：正如 nickb 指出的那样，CSStidy 中有一个配置选项可以控制这一点，所以问题就变成了：如何在 HTMLpurifier 的上下文中将该选项设置为 FALSE？

还是那个`lowercase_s`CSSTidy 配置选项甚至是罪魁祸首？我不知道，因为到目前为止我无法以一种或另一种方式停止小写。例如，我想要这样的输入：

```
.zzzzzz {
    background:transparent url("images/tmpl_Btn1_CSSdemo.jpg") no-repeat right top;
} 
```

...**不会**变成（就像现在一样）：

```
.zzzzzz {
    background:transparent url("images/tmpl_btn1_cssdemo.jpg") no-repeat right top;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:29:11.237

您需要将`lowercase_s`CSSTidy 配置选项设置为`false`. 否则，它将小写所有选择器以包含在 XHTML 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-02T15:18:49.213

实际上，这是一个 HTML Purifier 错误，而不是 CSS Tidy 错误。我正在修复。

请应用此补丁：[http](http://repo.or.cz/w/htmlpurifier.git/commit/f38fca32a9bad0952df221f8664ee2ab13978504) ://repo.or.cz/w/htmlpurifier.git/commit/f38fca32a9bad0952df221f8664ee2ab13978504 （只有在库/文件中的补丁才是真正需要的）

# c++ - zeromq 套接字的 MPI 传输

> ID：10843603
> 
> 赞同：0
> 
> 时间：2012-06-01T02:15:20.127
> 
> 标签：c++, mpi, amqp, zeromq

我在网上阅读

“ØMQ 比 MPI 高级得多，至少理论上你可以为 ØMQ 套接字实现 MPI 传输”

我想看看是否有其他人试图实现这一点

在我盲目开始之前，我还想看看是否有人可以提供一些关于实施此的建议或咨询

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-01T22:44:21.603

我对 0MQ 比​​ MPI 更高级别的观点提出异议。MPI 支持低级通信库中没有的广泛功能，包括集合和数据类型。0MQ 是否支持 MPI-3 中的所有集合操作？它有没有办法使用分布式图符号来描述应用程序通信拓扑？它是否支持任意用户定义的数据类型？

请注意，我并不是说 MPI 比 0MQ 更高级别，因为 0MQ 似乎使某些事情比 MPI 更容易。

我喜欢 0MQ 的想法，并且在许多方面设计更好（无状态特性解决了多线程的许多问题），但我认为任何人说一个比另一个更高或更低的级别是不谨慎的.

# orm - 关于JPA2中的关系管理

> ID：10843604
> 
> 赞同：0
> 
> 时间：2012-06-01T02:15:52.987
> 
> 标签：orm, jpa-2.0, eclipselink

我对管理关系中的实体感到困惑。根据PRO JPA2一书，关系应该在关系的两端手动配置和分配。

现在，考虑这种关系。

```
@Entity
public class Employee {
    ..
    @ManyToOne(cascade=CascadeType.PERSIST)
    private Department department;
    ..
}
@Entity
public class Department {
    ..
    @OneToMany(mappedBy="department")
    private Set<Employee> employees = new HashSet<Employee>();

    public void addEmployee(Employee e){
        getEmployees().add(e);
        e.setDepartment(this);
    }
} 
```

我做了一个简单的测试用例，涉及到这行代码来验证这一点。

```
Department dept1 = new Department();
dept1.setName("MARKETING");

Employee e1 = new Employee();
e1.setName("JOHN DOE");

e1.setDepartment(dept1); //[1]
//dept1.addEmployee(e1); //[2] 
```

**考虑第 [1] 行：**

我认为这不会使用正确的部门 ID 正确更新 Employee 表，但我检查了 Derby，它能够正确执行更新。

**考虑第 [2] 行：**

这是书本上的正确方法。

Eclipselink/德比/JPA2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:04:54.030

如果你像第 [1] 行那样做，Employee 'e1' 将存储在数据库中，FK ok，但是......如果你得到 Department dept1 并调用 getEmployees(); 员工“e1”将不在此列表中。即使您进行新查询以再次从数据库中获取该部门；它不会有 Employee 'e1' （至少在您重新部署应用程序之前不会）。这就是为什么您应该始终以 [2] 的方式进行操作。
当我开始使用 JPA2 时，我并不知道这一点。并且在 [1] 中持续存在实体。我几乎要疯了，试图确定为什么最近持久化的实体没有被 JPA 读取，而是实际存储在数据库中。

# mysql - SQL：列出表中字段的唯一子字符串

> ID：10843605
> 
> 赞同：0
> 
> 时间：2012-06-01T02:15:53.680
> 
> 标签：mysql

我正在运行查询以从列中的字符串中检索第一个单词，如下所示..

```
SELECT SUBSTRING_INDEX( `field` , ' ', 1 ) AS `field_first_word`FROM `your_table` 
```

但这允许重复，我需要在语句中添加什么来获取唯一的单词列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:18:03.853

[`DISTINCT`](http://dev.mysql.com/doc/refman/5.0/en/select.html)

例如：

```
SELECT DISTINCT SUBSTRING_INDEX( `field` , ' ', 1 ) AS `field_first_word` FROM `your_table` 
```

**注意：**对`DISTINCT`. 但是，在您的情况下，纯 MySQL 替代品可能有限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T02:18:08.527

要删除`SELECT`语句中的重复项，请更改为`SELECT DISTINCT column`。在这种情况下：

```
SELECT DISTINCT SUBSTRING_INDEX( `field` , ' ', 1 ) AS `field_first_word`FROM `your_table` 
```

# emacs - 在 emacs 中创建“Mx”命令快捷方式？

> ID：10843613
> 
> 赞同：1
> 
> 时间：2012-06-01T02:17:38.493
> 
> 标签：emacs, elisp

里面的一些命令输入`emacs`得太长了。

尽管如此，我还是希望它们作为`M-x`命令（而不是键盘快捷键），因为我有这么多，我会开始偶然发现它们。

而且，旧的不应该被删除。适应新的需要一段时间。

我能想到的唯一方法，就是这样一个一个地做。更好的方法？

```
(defun icd (dict) "Alias for ispell-change-dictionary"
  (interactive "sDictionary: ")
  (ispell-change-dictionary (downcase dict))) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T02:37:57.303

使用`defalias`：

```
(defalias 'bc 'emacs-lisp-byte-compile) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T07:39:12.177

在为每个命令定义别名之前，您应该使用*ido-mode*

见这里：[EmacsWiki](http://emacswiki.org/emacs/InteractivelyDoThings)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T20:08:14.637

如果你把

```
(setq completion-styles (append completion-styles '(initials)))
(define-key minibuffer-local-completion-map
            [?\M-\t] 'minibuffer-force-complete) 
```

在您的 .emacs 中，然后 Mx icd M-TAB M-TAB 将为您提供 ispell-change-directory。下一次，一个 M-TAB 就足够了（因为自行车更喜欢在历史中找到的条目）。

# ios5 - iPhone4 iOS5 传感器融合用于短距离惯性导航

> ID：10843615
> 
> 赞同：1
> 
> 时间：2012-06-01T02:18:01.070
> 
> 标签：ios5, gps, sensors, iphone-4, inertial-navigation

我环顾四周，关于iOS5惯性导航的演讲或例子并不多。我知道iOS5引入了一些很酷的传感器融合算法：

```
 motionQueue = [[NSOperationQueue alloc] init];
    [motionQueue setMaxConcurrentOperationCount:1];

    motionManager = [[CMMotionManager alloc] init];
    motionManager.deviceMotionUpdateInterval = 1/20.0;

[motionManager startDeviceMotionUpdatesUsingReferenceFrame:CMAttitudeReferenceFrameXTrueNorthZVertical toQueue:motionQueue withHandler:^(CMDeviceMotion *motion, NSError *error) {

}]; 
```

我看过来自 WWDC 的两个视频，它们处理上面的块。

生成的 CMDeviceMotion 包含一个设备姿态向量，以及与用户引起的加速度分开的加速度。

是否有任何专门针对 iOS 5 的开源惯性导航项目可以利用这种新的传感器融合？我说的是进一步将这些数据与 GPS 和磁力计输出集成，以获得更准确的 GPS 位置。

一个额外的问题：从硬件的角度来看，这种融合是否可能？如果我开始长时间对所有可用传感器数据进行 20hz 处理，我会融化我的 iPhone4 吗？

我已经准备好开始修改这些了，但我希望得到比上面的空块更坚实的东西:)

感谢您的任何指点！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T20:22:50.703

我正在为水肺潜水员编写一个应用程序，并希望添加惯性导航，因为 GPS 和其他基于无线电的导航在水下不可用。我做了很多研究，发现 iPhone 上的传感器数据抖动太多，无法进行准确的惯性导航。我做了一个快速的实验，发现即使设备完全静止，由于信号中的噪声引起的“漂移”表明设备在几分钟后“移动”了很多米。这是我在实验中使用的代码。如果你能看到我做错了什么，请告诉我。否则，我想要我的下午回来！

```
- (void)startCoreMotion {
CMMotionManager *manager = [[CMMotionManager alloc] init];
if ([manager isAccelerometerAvailable]) {
    manager.deviceMotionUpdateInterval = 1.0/updateHz;
    [manager startDeviceMotionUpdatesToQueue:[NSOperationQueue mainQueue] withHandler:^(CMDeviceMotion *motion, NSError *error) {
        xVelocity += (( 9.8 * motion.userAcceleration.x ) / updateHz);
        yVelocity += (( 9.8 * motion.userAcceleration.y ) / updateHz);
        zVelocity += (( 9.8 * motion.userAcceleration.z ) / updateHz);

        xPosition += ( xVelocity * ( 1 / updateHz ));
        yPosition += ( yVelocity * ( 1 / updateHz ));
        zPosition += ( zVelocity * ( 1 / updateHz ));

        self.xPositionLabel.text = [NSString stringWithFormat:@"x = %f m", xPosition];
        self.yPositionLabel.text = [NSString stringWithFormat:@"y = %f m", yPosition];
        self.zPositionLabel.text = [NSString stringWithFormat:@"z = %f m", zPosition];

        self.xVelocityLabel.text = [NSString stringWithFormat:@"vx = %f m/s", xVelocity];
        self.yVelocityLabel.text = [NSString stringWithFormat:@"vy = %f m/s", yVelocity];
        self.zVelocityLabel.text = [NSString stringWithFormat:@"vz = %f m/s", zVelocity];

        self.distanceLabel.text = [NSString stringWithFormat:@"dist = %f m", sqrt( pow(xPosition, 2) + pow(yPosition, 2) + pow(zPosition, 2))];

    }];
} 
```

}

# greedy - 我该如何解决这个问题？

> ID：10843623
> 
> 赞同：0
> 
> 时间：2012-06-01T02:18:51.163
> 
> 标签：greedy

给定一个无向加权图 G = (V,E)。每个顶点代表一个城市，连接 a 和 b 的边的权重是完成在城市 a 和城市 b 之间建立高速路线所需的年数。描述一种算法，该算法将找到一个人可以在图中任意两个城市之间旅行的最少年数。路线是同时建立的，所以如果我们有三个城市 a、b 和 c 以及 a 和 b 之间的一条边，权重为 1，b 和 c 之间的另一条边，权重为 2，那么输出应该是 2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:28:56.277

上面的评论为您指出了正确的答案，在我看来，这听起来像是一个经典的 Prim 算法问题。[http://en.wikipedia.org/wiki/Prim's_algorithm](http://en.wikipedia.org/wiki/Prim%27s_algorithm)

# ruby-on-rails - 为什么 ActiveRecord 查询返回不明确的列引用？

> ID：10843627
> 
> 赞同：2
> 
> 时间：2012-06-01T02:19:24.373
> 
> 标签：ruby-on-rails

在 Rails 应用程序中，我正在设置嵌套路由

```
resource Country do
  resource State
  resource City
  resource User
  resource Post
end 
```

我现在想显示在一个国家/地区发布的用户`../country/1/users`

在用户控制器中，我有：

```
def index 
  @user = User.includes(:posts, :city, :state, :country)
  @user = @users.where("states.country_id = ?", params[:country_id]) if params[:country_id]
  @active_users = @users.where('posts_count > ?', 0).ranked_scope
end 
```

我越来越：

```
PG::Error: ERROR:  column reference "posts_count" is ambiguous
LINE 1: ...untry_id" WHERE (states.country_id = '1') AND (posts_co... 
```

我不确定这是不是因为：

1.  有一个`posts_count`关于用户、城市、州、国家模型的列，查询不知道要使用哪个。如果是这样，指定表的正确语法是什么？
2.  我错误地将两个 where 子句串在一起。
3.  还有什么……？

我会很感激任何建议或想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T02:33:46.707

尝试：

```
@active_users = @users.where('users.posts_count > ?', 0).ranked_scope 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-02T06:33:46.113

好的，我最终明白了这一点。以下查询不正确

```
@users = @users.where("states.country_id = ?", params[:country_id]) if params[:country_id] 
```

Post 属于 User，Post 通过 State 有一个 Country。如果 USer 和 Country 之间没有一个方向的直接关系，我将查询修改为

```
@users = @users.where(id: Country.find(params[:country_id]).users.uniq if params[:country_id] 
```

（并仔细检查了我所有的模型关系都已正确配置）。

作品！

但是，错误消息对于跟踪这一点并没有多大帮助！

# c++ - 即使检查了两个索引的边界，动态二维数组也存在奇怪的访问冲突

> ID：10843631
> 
> 赞同：0
> 
> 时间：2012-06-01T02:20:13.120
> 
> 标签：c++, arrays, access-violation

我有一个奇怪的问题。我有一个动态创建的二维数组 Content，它的高度为 _h，宽度为 _w（在我的实现中，行是第一个参数，列是第二个参数，这在上下文中是有意义的）。两个索引可能超出范围，这是设计使然，如果是这样，那么索引将“环绕”数组：

```
Content[v.iget()%_h][u.iget()%_w]; 
```

v 和 u 是我自己班级的对象；它们内部有一个 __int64 值，而 iget() 如下所示：

```
return value>>precision; 
```

它返回一个通常的 32 位 int。我用 % 按高度或宽度“包装”这个 int 值，显然余数总是 0 <= r < max。所以这个 % 操作还可以防止任何可能的越界情况，但我有时会在这条线上得到访问冲突。当我查看 v 和 u 的值时，它们类似于 -7753978124 - 实际上，在我的上下文中不应该发生负数（所以我还没有寻找导致它的原因），但无论如何，. iget() 应该把它变成一个普通的整数，%_h 或 %_w 应该把它放在边界内，但是我得到了访问冲突。这怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T02:38:25.820

> 应该把它变成一个正常的整数

没有。 `(-1 % 2) == -1`

所以表达式`x % max`将返回（-max..max）范围内的值。

这是第一个问题。

第二个问题是这样的：

```
__int64 a = 0xffffffff00000000;
int b = a >> 32;
printf("%d\n", b); 
```

`0xffffffff00000000 >> 32`is `0xffffffff`，它是一个负数`-1`（对于带符号的 32 位 int，即）。

您可以使用如下表达式来解决此问题：

`((x % width) + width)%width`

或者您可以使用 if/else 修复索引：

```
x %= width;
if (x < 0)
    x += width; 
```

或者，您可以使 iget() return `unsigned int`，**但这**不会正确地环绕所有不是 2 次幂的宽度和高度的负索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T04:04:14.723

为了绝对确保您没有遇到负值，您可以像下面这样实现索引。它也应该比计算模更快，如果你的语句发生在一个紧密的循环中，这将是一个重要的考虑因素。

```
__int64 v = v.iget();
__int64 u = u.iget();
Content[v < 0 ? 0 : v > _h ? _h : v][u < 0 ? 0 : u > _w ? _w : u]; 
```

# iphone - 在objective-c中声明重用协议的位置

> ID：10843632
> 
> 赞同：6
> 
> 时间：2012-06-01T02:20:21.117
> 
> 标签：iphone, objective-c

如果我想重用一个协议来通知主视图控制器何时关闭详细视图控制器，例如： [UIView notification when modal UIImagePickerController isdismissed?](https://stackoverflow.com/questions/3730617/uiview-notification-when-modal-uiimagepickercontroller-is-dismissed)

我在哪里声明这个协议？将协议保存在单独的文件中是最佳实践吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:34:24.097

通常，我（复制 Apple 的方法）在将与该协议的委托进行交互的类的标头上声明协议。（例如，UIActionSheet 头文件包含 UIActionSheetDelegate 的协议声明。）只要您没有声明的循环引用，在技术上声明协议的位置并不重要`#import`。这通常不会发生，因为与协议交互的类这样做是为了避免需要`#import`现在将实现协议的所有其他类。（UIActionSheet 在通过协议解除时向您的类发送消息，因此不需要 #import 您的任何类。）

如果您有一个协议，并且几个不相关的类将与该协议的委托进行交互，那么将协议放在自己的文件中将是一个很好的指标，因为该协议并没有真正与一个特定的类相关联。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T02:46:46.127

我认为您应该在单独的文件中声明 UIImagePickerController 的类别。像 ImagePickerCtrlCatagory.h 和 ImagePickerCtrlCatagory.m 在 ImagePickerCtrlCatagory.h 中，这样做

```
 #import <Foundation/Foundation.h>
    @protocol ImagePickerCtrlDelegate;
    @interface UIImagePickerController (DissappearDelegate){
        id <ImagePickerCtrlDelegate> delegate;
}
        @end 
```

# java - 如何在无状态 Wicket 应用程序中使用 FeedbackPanel？

> ID：10843633
> 
> 赞同：1
> 
> 时间：2012-06-01T02:20:37.103
> 
> 标签：java, wicket, feedback, stateless

我有一个应用程序使用 FeedbackPanel 向用户显示发布表单的结果。

在无状态页面上调用 Component#info(String) 时，Wicket 似乎确实将该字符串放入 FeedbackMessages 会话中。但是后来，FeedbackPanel 尝试查找消息并且似乎根本找不到任何消息，即使当我在调试器中查看所有这些消息时它们似乎仍然在会话中。

此外，当这种情况发生时，WicketTester 发誓该消息正在显示，这使得 WicketTester 基本上无法用于测试反馈消息（我现在在我的列表中有一个 TODO 来用标记本身的断言替换它的使用。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-19T04:35:14.803

用我自己的解决方案回答我的问题。在我们的`StatelessWebSession`中，重写一个附加方法：

```
private static final IFeedbackMessageFilter renderedMessagesForComponents =
    new IFeedbackMessageFilter()
    {
        @Override
        public boolean accept(FeedbackMessage message)
        {
            return message.getReporter() != null && message.isRendered();
        }
    };

@Override
protected void cleanupComponentFeedbackMessages()
{
    // deliberately not calling the method in the superclass because it
    // clears all messages for components.
    getFeedbackMessages().clear(renderedMessagesForComponents);
} 
```

这样，它只会清除组件的*渲染*消息，而不是组件的*所有*消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T07:05:52.197

Wicket 1.5.6 中有一个错误：[https](https://issues.apache.org/jira/browse/WICKET-4536) ://issues.apache.org/jira/browse/WICKET-4536 。否则这应该只是工作。[您可以在http://www.wicket-library.com/wicket-examples-1.4.x/stateless/?wicket:bookmarkablePage=:org.apache.wicket.examples.stateless.StatelessPage](http://www.wicket-library.com/wicket-examples-1.4.x/stateless/?wicket:bookmarkablePage=:org.apache.wicket.examples.stateless.StatelessPage)看到 1.4.20 的演示

# python - 嵌套if的替代品？

> ID：10843635
> 
> 赞同：0
> 
> 时间：2012-06-01T02:21:00.217
> 
> 标签：python, function, syntax, built-in

我正在制作一种语言，每次有人想要访问一个变量时，它都带有一个 $ 符号。但是，在每个函数上我都必须有一个 if，看看它的第一个字母是否是 $，并且每次传递一个参数时，对于每个参数我都必须这样做。它变得混乱。我不想嵌套 if，但是拥有它，以便我可以轻松地对其应用函数并访问它。这有点难以解释，但我会用一些代码来解释。

```
def varcmd(cmd, variables):
    if cmd.__len__() < 4:
        print "Too little arguments! str <var> = <string>"
    else:
        if cmd[2] == "=":
            if cmd[3][:1] == "$":
                variables[cmd[1]] = variables[cmd[3][1:]]
            else:
                variables[cmd[1]] = cmd[3]
        else:
            print "Incorrect syntax! str <var> = <string>" 
```

当我不断添加这个函数时，if 将呈指数增长，实际上每个函数都可以接受变量，所以每个函数都会有大量的 if。基本上，我想要这样的东西：

```
def varcmd(cmd, variables):
    if cmd.__len__() < 4:
        print "Too little arguments! str <var> = <string>"
    else:
        if cmd[2] == "=":
            variables[cmd[1]] = auto_convert_if_var.cmd[3][1:]
        else:
            print "Incorrect syntax! str <var> = <string>" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T02:25:44.080

看起来您的需求已经变得足够复杂，需要构建一个[解析器](http://wiki.python.org/moin/LanguageParsing)。

# r - 摆脱 R 中的行标识符

> ID：10843638
> 
> 赞同：2
> 
> 时间：2012-06-01T02:21:24.893
> 
> 标签：r, matrix

我的程序正确输出了两个`data.frame`s的结果

```
Browse[2]> Mismatch
    Num.Residue PDB.Residue Canonical.Residue
1          61           H                 Q 
```

和

```
Browse[2]> PDBXPoly$Diffs.Matrix
   PDB.Residue Canonical.Residue Position
19           H                 Q       61 
```

我的问题是，如何摆脱“1”和“19”？它们是`data.frame`我从中提取输出的较大的人工制品。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:30:26.967

那些是矩阵还是数据框？它们看起来像数据框。

1 和 19 是行名。如果这些是矩阵，您可以使用

```
row.names(Mismatch) = NULL 
```

如果这些是数据框，则不能“删除”row.names，但上面的行会将它们变成连续的行名（如果您不想从更大的数据框中保留它们）。

ETA：您可以打印没有行名的数据框，如下所示：

```
print(Matrix, row.names=FALSE)
print(PDBXPoly$Diffs.Matrix, row.names=FALSE) 
```

# jquery - 过度使用 jQuery 的 on 方法？

> ID：10843645
> 
> 赞同：0
> 
> 时间：2012-06-01T02:23:11.610
> 
> 标签：jquery

我在一个有点复杂的代码库上使用 Google Analytic 的事件标记。我没有遍历每个文件并查找所有必要事件的位置，而是考虑使用 jQuery 的 on 方法创建新事件来委派它们。沿着这条路线走，我是否应该担心任何潜在的性能问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:53:32.150

在一般说明中（我假设是因为我只是使用您共享的内容），当使用委托而不是绑定时，您根本不应该担心性能。甚至有人认为在公平竞争环境中委托比绑定更好，但我不会对此进行详细介绍。

但是，您会发现委托最突出的性能缺陷是，根据它们的工作性质，您的事件必须在实际事件触发之前冒泡到委托元素。

现在，如果您的代码足够复杂（正如您所建议的那样），并且如果您的 DOM 树足够深（我假设因为您正在考虑使用委托作为*包罗万象的*内容），那么您的事件将不得不在事件触发之前冒出相当远的距离。

触发延迟是否足以让您担心？它会影响代码中其他事件的异步排序（如果这很重要的话）？你知道你的代码，所以你可以说得最好。

# c# - Telerik 和 jQuery：RadGrid 和 Fancybox

> ID：10843647
> 
> 赞同：0
> 
> 时间：2012-06-01T02:23:20.887
> 
> 标签：c#, fancybox, telerik-grid

我正在使用 Telerik radgrid 显示图像并使用 jquery fancybox 在用户控件（ascx 文件）中弹出图像。问题是在第一页fancybox 工作正常。在网格的下一页，fancybox 无法正常工作。以下脚本粘贴在 ascx 文件中。

```
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4/jquery.min.js"></script>
    <script type="text/javascript" src="../../Scripts/fancybox/jquery.easing-1.3.pack.js"></script>
    <script type="text/javascript" src="../../Scripts/fancybox/jquery.mousewheel-3.0.4.pack.js"></script>
    <script type="text/javascript" src="../../Scripts/fancybox/jquery.fancybox-1.3.4.js"></script>
    <link rel="stylesheet" type="text/css" href="../../Scripts/fancybox/jquery.fancybox-1.3.4.css" media="screen" />

    <script type="text/javascript">
    $(document).ready(function() {

        $("a.img_group").fancybox({
            'transitionIn' : 'none',
            'transitionOut' : 'none',
            'titlePosition' : 'over',
            'titleFormat' : function(title, currentArray, currentIndex, currentOpts) {
            return '<span id="fancybox-title-over">' + (title.length ? ' &nbsp; ' + title : '') + '</span>';
    }
    }); 

    });

</script> 
```

在网格

```
<a  class="img_group" runat="server" title='Photo_Title' href='imageURL'>
   <img runat="server" alt="image" src='imgSource'  Width="120" Height="95" id="imgOne" />
</a> 
```

我很感激任何帮助。谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T05:27:45.823

RadGrid 插件最有可能将来自第一个页面以外的其他页面的图像动态添加到 DOM。您使用的是 fancybox v1.3.4，它不支持动态添加的元素。

我在[这里发布了一个解决方法](https://stackoverflow.com/a/9084293/1055987)。您可能只需要调整脚本以匹配您父母的容器选择器。

Eventually, you may upgrade to [fancybox v2.x](http://fancyapps.com/fancybox/) and won't have any further to do (that version supports existing and dynamically added elements.)

# css - 粘滞页脚没有到达浏览器窗口的左右两侧

> ID：10843657
> 
> 赞同：0
> 
> 时间：2012-06-01T02:25:30.003
> 
> 标签：css, footer, sticky-footer

从 cssstickyfooter.com的[CSS 页脚继续无法正常工作](https://stackoverflow.com/questions/10843522/css-footer-from-cssstickyfooter-com-not-working-correctly#10843570)

[这个来自http://www.cssstickyfooter.com/](http://www.cssstickyfooter.com/)的页脚没有到达浏览器窗口的边缘：

![糟糕的页脚](../Images/f5398872630b2ee35db2dbc152603fd8.png)

页脚应该“接触”窗口的左右两侧，但正如您所看到的，似乎有一个小的边距。老实说，我不知道如何开始解决这个问题。但我不认为这是一个错误，因为它在 Chrome、Firefox 中的呈现方式相同，我认为甚至在 Internet Explorer 中也是如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:31:57.030

添加到您的代码

```
html, body { padding: 0; margin: 0; } 
```

防止页脚周围出现空格

# c# - JQuery - 将元素的坐标传递给后面的 ASP.NET 代码？

> ID：10843662
> 
> 赞同：2
> 
> 时间：2012-06-01T02:26:00.940
> 
> 标签：c#, jquery, asp.net, html, jquery-ui

我正在尝试创建一个简单的 ASP.NET 站点，该站点将使用JQuery 提供的`offset`or函数通过按钮的方法将元素的坐标传递给后面的 ASP.NET 代码。`position``<div>``OnClick`

我已经搜索并找到[了这个例子](http://forums.asp.net/post/5005609.aspx)，但它似乎没有按预期工作，点击后没有返回坐标。

如何获取给定`<div>`元素的坐标并将其传递给 ASP.NET 按钮的`OnClick`方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-12T06:13:33.540

**第 1 部分**
要获取元素的位置，您可以使用[offset()](http://api.jquery.com/offset/)或[position()](http://api.jquery.com/position/)

小提琴：http: [//jsfiddle.net/XFfLP/](http://jsfiddle.net/XFfLP/)

```
function test() {
    var p = $("#testID");
    var position = p.offset();//p.position()
    $("#Field1").val(position.top);
    $("#Field2").val(position.left);
}​ 
```

**第 2 部分**
要将数据从页面传递到服务器代码隐藏，您可以使用`Web-Methods`

文章： http: [//blog.nitinsawant.com/2011/09/draft-sending-client-side-variables-to.html](http://blog.nitinsawant.com/2011/09/draft-sending-client-side-variables-to.html)

**1.** Web-Method示例代码：

```
[System.Web.Services.WebMethod]
 public static string AcceptData(object jsonData)
 {
     Customer newCust =(Customer)JsonConvert.DeserializeObject(jsonData.ToString(),typeof(Customer));
     return "Server response: Hello "+newCust.FirstName;
 } 
```

**2.JS**示例代码：

```
var newCustomer = {
    "FirstName": $("#txtFirstName").val(),
    "LastName": $("#txtLastName").val(),
    "Telephone": $("#txtTelephone").val()
}

var jsonData = "{'jsonData':'" + JSON.stringify(newCustomer) + "'}";//create string representation of the js object

        //post data to server
        $.ajax({
            type: "POST",
            url: 'Test.aspx/AcceptData',
            data: jsonData,
            contentType: "application/json; charset=utf-8",
            dataType: ($.browser.msie) ? "text" : "json",
            success: function(msg) {
                //call successfull
                var obj = msg.parseJSON();
                alert(obj.d); //d is data returned from web services

                //The result is wrapped inside .d object as its prevents direct execution of string as a script
            },
            error: function(xhr, status, error) {
                //error occurred
                alert(xhr.responseText);
            }
        }); 
```

# iphone - 位于 UINavigationConroller 内的 UIViewController 内的 UINavigationController

> ID：10843664
> 
> 赞同：1
> 
> 时间：2012-06-01T02:26:31.577
> 
> 标签：iphone, ios, uiviewcontroller, uinavigationcontroller

我有一个导航应用程序，其中有一个视图控制器。我现在正在尝试将另一个 NavigationController 加载到该 ViewController 中，但是我遇到了问题。

我正在尝试以编程方式执行此操作，因为我不确定如何在 InterfaceBuilder 中执行此操作，但是新的导航控制器显示很奇怪..就像它认为上面有一个信息栏..所以有一个空白..

正如你在这里看到的。

![在此处输入图像描述](../Images/2466ca07ca56b4cb3f21458164021377.png)

这就是我正在做的所有事情以获得这个^当前的外观......

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.

    UINavigationController *newNav = [[UINavigationController alloc] init];
    [self.view addSubview:newNav.view];

    newNav.navigationItem.title=@"Navigation Controller Example";
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T02:33:50.410

正如你所说，你只有一个基于 Navi 的应用程序，所以如果你想在你的应用程序中添加另一个 NavigationController，你应该隐藏新的 NavigationController 栏。以下是代码。

```
[newNav setNavigationBarHidden:YES animated:YES]; 
```

# php - PHP-如何在表单字段中显示当前选定的值

> ID：10843669
> 
> 赞同：0
> 
> 时间：2012-06-01T02:27:19.900
> 
> 标签：php, mysql, html, sorting

嗨，我已经设置了一个基于PHP的表单提交方法，用于在选择下拉菜单中每个页面排序行，它正常工作，我可以根据选择的值对行进行排序，但是我的问题是选择一个**值**以进行排序的值不会在表单选定字段中显示为**当前选择**的内容。

我的意思是，当在下拉菜单中**选择**一个值以对行进行排序时，它应该在选择框中显示**为当前作为****默认值**，如果没有选择任何内容，则**默认行**值应该显示**为当前**。

please **see** here [here](http://download.cnet.com/windows/antivirus-software/?tag=rb_content;main) at the sorting method, it shows current(10) as default rows and when a value is selected it becomes as current on page reloads after querying database.

这是我的表单字段的**html代码：**

```
<form action="is-test.php" method="get">
<select name="rpp" onchange="this.form.submit()">
<option selected value="">show</option><!-- i want default & current selected value here -->
<option value="10">10</option>
<option value="20">20</option>
<option value="30">30</option>
</select>
</form> 
```

这种排序的**php代码**是：

```
$rowsperpage = '';
if (isset($_GET['rpp'])&& is_numeric($_GET['rpp'])) {
$rowsperpage = (int) mysql_real_escape_string($_GET['rpp']);
}else{
$rowsperpage='5';
} 
```

对此的**mysql查询**是：

```
$sql2 = "SELECT * FROM $tablename ORDER BY $orderby $sortby LIMIT $rowsperpage OFFSET $offset"; 
```

请向我推荐一种将所选值设置为当前值的方法。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T02:30:33.813

```
<option selected value="<?php echo $rowsperpage; ?>"><?php echo $rowsperpage; ?></option> 
```

一个*可能*更好的方法是使用循环：

```
for ($i = 10, $i <= 30; $i +=10) {
    $selected = ($i == $rowsperpage) ? ' selected="selected"' : '';
    echo sprintf('<option value="%d"%s>%d</option>', $i, $selected, $i);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:34:16.333

在您的`<option>`标签中，您应该执行如下检查：

```
<option value="10" <?php if ($rowsperpage == 10) echo 'selected="selected"' ?>>10</option>
<option value="20" <?php if ($rowsperpage == 20) echo 'selected="selected"' ?>>20</option>
<option value="30" <?php if ($rowsperpage == 30) echo 'selected="selected"' ?>>30</option> 
```

因此，如果您选择`20`，它将显示为当前值`<select>`

```
<option value="10">10</option>
<option value="20" selected="selected">20</option>
<option value="30">30</option> 
```

为了使事情更简单，只需`for`像这样使用循环：

```
for ($i = 10; $i <= 30; $i+= 10) {
  echo "<option value=\"$i\" ".($rowsperpage == $i ? 'selected="selected"' : '').">$i</option>";
} 
```

# c++ - 如何使用 Windows API 正确检查对文件的有效读/写访问？

> ID：10843673
> 
> 赞同：4
> 
> 时间：2012-06-01T02:28:14.493
> 
> 标签：c++, winapi, acl, file-permissions

我尝试使用 来执行此操作`GetEffectiveRightsFromAcl`，但它没有为由于我所属的组而被拒绝的文件返回正确的访问掩码。

例如，我有一个文件`unreadable.txt`. 如果我拒绝`unreadable.txt`当前用户的写访问权限，访问掩码会正确显示我没有写访问权限。但是，如果我改为拒绝“经过身份验证的用户”组的写访问权限，则访问掩码意味着我具有完全访问权限（我没有）。

我的替代方法是手动迭代 Ace 列表并将我的 SID 与每个条目进行比较，但我无法找到一种干净或简单的方法来检查 Ace 是否用于某个组，以及当前用户是否属于该组。

作为扩展，该文件可能不存在（即它是一个新文件，即将被写入），在这种情况下，需要检查对目录的访问。

有什么好的解决办法吗？似乎应该存在一种更简单的方法来执行此操作，而无需实际尝试读取/写入相关文件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:46:13.940

请改用[AccessCheck ，正如](http://msdn.microsoft.com/en-us/library/windows/desktop/aa374815%28v=vs.85%29.aspx)[有关 GetEffectiveRightsFromAcl API](http://support.microsoft.com/kb/262278)的限制的知识库文章所建议的那样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T02:44:58.250

只需尝试使用所需的模式打开文件[`CreateFile`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858.aspx)- 如果成功，您就知道您拥有访问权限。您实际上不必向文件中写入任何内容，只需立即将其关闭即可。

# apache - 为什么 RewriteRule 仅适用于不存在的文件？

> ID：10843676
> 
> 赞同：0
> 
> 时间：2012-06-01T02:29:03.393
> 
> 标签：apache, .htaccess, mod-rewrite

这是一个常见问题，对此有很多常见的答案，但我有一个不起作用的特定小细节，阅读文档并不能帮助我理解原因。

所以，问题来了：我想`www.`从域名中删除。我`.htaccess`与 mod_rewrite 一起使用。这是代码：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www\.swedish\-cloud\.com$
RewriteRule ^(.*)$ "http\:\/\/swedish\-cloud\.com\/$1" [R=301,L] 
```

它有效，如果我只输入`http://www.swedish-cloud.com`. 它将其更改为`http://swedish-cloud.com`.

但是，如果我输入，例如：`http://www.swedish-cloud.com/index.html`，它不会*将*URL 更改为`http://swedish-cloud.com/index.html`

但是，如果我键入一个不存在文件的路径，例如`http://www.swedish-cloud.com/index2.html`，它会将 URL 更改为`http://swedish-cloud.com/index2.html`显示*404 Not Found*错误。

你能让我明白我错过了什么吗？谢谢你。

PS：我没有对服务器的root访问权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T13:37:01.993

让我们给你正确的答案。您的 cond 语法错误但并不严重，并且规则的语法也错误。尝试：

```
RewriteCond %{HTTP_HOST} =www.swedish-cloud.com
RewriteRule ^.*          http://swedish-cloud.com/$0   [R=301,L] 
```

如果您想要这样做，请在 cond 中使用相等运算符，然后您不需要转义匹配字符串。

替换字符串不需要引号或转义，既然你想要整个 URI，为什么不直接使用 $0 （整个匹配模式）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:39:50.537

您看到的 404 错误是标准错误。重写不适用于 www.example.com/something.html 的原因是它与正则表达式不匹配，因为您拥有的行尾锚。swedish-cloud.com$ 之后的 $。这意味着 www.swedish-cloud.com 之后不会被重写，因为此时您基本上已经终止了正则表达式。

尝试：

```
RewriteCond %{HTTP_HOST} ^www.example\.com
RewriteRule ^(.*)$ http://example.com/$1   [R=301,L] 
```

# html - 水平方向的瓷砖是否可以在 CSS 中拉伸其父级的宽度？

> ID：10843682
> 
> 赞同：0
> 
> 时间：2012-06-01T02:29:53.487
> 
> 标签：html, css

如果我在 HTML 中有这个布局：

```
<div>
    <ul>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
    </ul>
</div> 
```

使用这个 CSS：

```
div
{
    width: 200px;
    overflow: hidden;
}

ul
{
    list-style: none;
    height: 100px;
}

li
{
    display: block;
    width: 100px;
    height: 100px;
    float: left;
} 
```

我希望将`<ul>`其拉伸到其内容的大小（400px），而不是将两个`<li>`元素包裹到下一行。

这可能与 CSS 吗？我一直只是`<li>`用 JavaScript 计算元素并设置`<ul>`宽度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:37:11.780

这应该这样做（[见小提琴](http://jsfiddle.net/c4Y6A/)；当然，它隐藏了一些因为你`overflow: hidden`在 div 上，[删除它，你会看到它正在工作](http://jsfiddle.net/c4Y6A/1/)）：

```
ul
{
    list-style: none;
    height: 100px;
    white-space: nowrap;
}

li
{
    display: inline-block;
    width: 100px;
    height: 100px;
} 
```

尽管要真正获得`ul`拉伸的大小（[它不仅仅使用上面的代码](http://jsfiddle.net/c4Y6A/2/)），它还需要具有`display: inline-block`（[参见小提琴](http://jsfiddle.net/c4Y6A/3/)）或`float`应用（[参见小提琴](http://jsfiddle.net/c4Y6A/4/)）以使其具有其内容的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:42:56.177

当你`<li>`像那样漂浮时，你有效地将它从`<ul>`. 你确定那是你想做的吗？为什么不只是浮动整个列表？

# php - php include /require 路径规范格式

> ID：10843684
> 
> 赞同：1
> 
> 时间：2012-06-01T02:30:02.487
> 
> 标签：php

这很简单，但大多数时候很混乱..

我需要知道当我们通过以下模式包含文件时意味着什么（我在很多地方看到的可能不止这些）

这是什么意思 ？

```
"./path" 

"/path"

"../path"

dirname(__FILE__)

basename(dirname(dirname(__FILE__)));

require dirname(__FILE__) . DIRECTORY_SEPARATOR;

pathinfo()

define('BASE_PATH',realpath('.'));

define('BASE_URL', dirname($_SERVER["SCRIPT_NAME"])); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T03:40:19.270

> “。/小路”

点指的是工作目录。这是在命令行上键入“pwd”时打印的目录。这可能是脚本本身的目录，也可能是首先运行的脚本的目录，但并非总是如此。

> “/小路”

以斜杠开头的路径是相对于最顶层目录的。这通常是服务器的根目录，但也可以是挂载点、您的用户目录，或者可能是您的 Web 根目录，具体取决于服务器的配置方式。

> “../小路”

“..”是指工作目录上一层的目录。所以如果工作目录是/foo/bar，那么“..”就是“/foo”，“../path”指的是“/foo/path”

> 目录名（__FILE__）

dirname() "返回父目录的路径。" __FILE__ 是一个魔术常量，它指的是使用它的文件的完整路径。因此，如果您在 /foo/bar/baz/file.php 有一个脚本，则 __FILE__ 将是“/foo/bar/baz/file.php”，而 dirname(__FILE__) 将是“/foo/bar/baz”

> 基本名称（目录名（目录名（__FILE__）））；

basename() "返回路径的尾随名称组件"。相同的规则适用于 dirname()，因此上一个示例中的 dirname(__FILE__) 是“/foo/bar/baz”，而 dirname(dirname(__FILE__)) 将是“/foo/bar”。此路径的尾随组件是“bar”，因此对于此 __FILE__ ， basename(dirname(dirname(__FILE__))) 将是“bar”。

> 需要 dirname(__FILE__) 。DIRECTORY_SEPARATOR；

DIRECTORY_SEPARATOR 是一个我不知道的常量，但显然它是在文件系统扩展名中定义的。如果 __FILE__ 是“/foo/bar/baz/file.php”，那么路径就是“/foo/bar/baz/”。所以这个说法似乎是不完整的。require() 与 include() 类似，只是如果找不到文件会出错。路径从不引用文件，因此该语句没有多大意义。

> 路径信息（）

pathinfo() 解析路径。将路径传递给它，它将给出一个关联数组，其中包含 dirname、basename、extension 和 filename 键以及解析路径的各个部分。

> 定义('BASE_PATH',realpath('.'));

realpath() 将采用相对路径并将其变形为绝对路径。如前所述，“。” 指的是工作目录，如果是 "/foo/bar/baz" 那么 realpath(".") 将返回 "/foo/bar/baz"。define() 将生成一个常量，因此这具有将 BASE_PATH 常量设置为脚本工作目录的效果。如果在脚本过程中工作目录发生变化，或者如果您在子目录中包含文件，这可能很有用，他们可以使用常量来引用 Web 应用程序的顶层。

> 定义('BASE_URL', 目录名($_SERVER["SCRIPT_NAME"]));

与define() 和dirname() 相同。这里的新东西是 $_SERVER["SCRIPT_NAME"]。如果加载脚本的地址是 example.com/foo/file.php，那么这将是“/foo/file.php”，并且 dirname() 是“/foo”。设置此常量可能有助于 Web 应用程序中的页面相互引用。

# html - 复选框的图像替换

> ID：10843687
> 
> 赞同：2
> 
> 时间：2012-06-01T02:30:27.890
> 
> 标签：html, css

我正在尝试为复选框使用自定义图像，如本问题所述：

[纯 CSS 复选框图像替换](https://stackoverflow.com/questions/3772273/pure-css-checkbox-image-replacement)

我的复选框出现在网格中，因此不需要与它们关联的标签。但是，我发现如果标签不存在，则该问题中讨论的技术不起作用。

例如，这是相关的 css：

```
input[type=checkbox] {
    opacity: 0;
}

input[type=checkbox]  {
    height: 17px;
    width: 17px;
    background: url('/resources/img/checkBox-unchecked.png') 0 0px no-repeat;
}

input[type=checkbox]:checked {
    background: url('/resources/img/checkBox-checked.png') 0 0px no-repeat;
    height: 17px;
    width: 17px;
    padding: 0 0 0 0px;
} 
```

声明一个简单的`input`并不会渲染图像：

```
<input type="checkbox"> 
```

但是，如果我修改 css，附加`+ label`，并将标签附加到标记，如解决方案中所述，它可以工作：

```
input[type=checkbox] {
    opacity: 0;
}

input[type=checkbox] + label {
    height: 17px;
    width: 17px;
    background: url('/resources/img/checkBox-unchecked.png') 0 0px no-repeat;
}

input[type=checkbox]:checked + label  {
    background: url('/resources/img/checkBox-checked.png') 0 0px no-repeat;
    height: 17px;
    width: 17px;
    padding: 0 0 0 0px;
}

<input type="checkbox"><label></label> 
```

这按预期呈现。

为什么第一个解决方案不起作用？

我怎样才能在不添加不需要的标签的情况下实现这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:42:12.367

您在第一个示例中留下了以下内容：

```
input[type=checkbox] {
    opacity: 0;
} 
```

这将使它*“不渲染”。*

现在，去掉那个微不足道的小风格，你可能会问

> 好的，控件现在出现了……那么，为什么背景图像没有出现？

这是因为您无法真正控制单选按钮、复选框、组合框、文件上传控件等的样式。标签解决方案之所以有效，是因为您可以愉快地为标签设置完整的 CSS 样式。我提到的控件？没那么多...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:46:44.477

我不是专家，但是，如果您将所有输入复选框设置为 0 不透明度，是否会有效地隐藏整个复选框？也许尝试这篇文章中提到的方法：[http ://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/](http://ryanfait.com/resources/custom-checkboxes-and-radio-buttons/)

# android - 方法总是返回 true

> ID：10843691
> 
> 赞同：-1
> 
> 时间：2012-06-01T02:31:02.093
> 
> 标签：android, string, boolean

我有一种检查成就的方法，我正试图让它正常工作。它需要一个 String 并将其转换为 long ，然后检查数据库中的 String 值（转换为 long ）

这是代码：

```
public boolean checkAchievements(String timeString) {   
    long timeInt = Long.parseLong(timeString);
    boolean newAchievement = false;
    SQLiteDatabase db = this.getWritableDatabase();

    Cursor cursor = db.rawQuery("SELECT millis FROM records ORDER BY CAST(millis as SIGNED) DESC", null);
    cursor.moveToFirst();
    long topTime = Long.parseLong(cursor.getString(0));
    cursor.close();

    if (timeInt > topTime) {
        db.rawQuery("update achievements set completed='yes' where name='Beat top record'", null);
        newAchievement = true;
    }

    db.close();

    return newAchievement;
} 
```

ihe`timeString`是从日历中抓取并从 long 转换为字符串的当前时间（以毫秒为单位）。我不知道为什么这个函数会一直返回 true，尤其是当我知道 timeInt 不大于 topTime 的事实时。

此外，即使这个函数正在返回`true`，该更新查询甚至没有运行，因为我检查了数据库并且完成的值仍然是“no”，其中 name="Beat top record"。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T03:02:45.873

您的方法正在返回`true`，根据条件正确。让我详细解释一下。

正如您在问题中所说，您的 timeString 变量包含当前毫秒，这是自 1900 年 1 月 1 日以来的毫秒长值。您在数据库中的时间值比当前时间旧（我假设，因为您没有给出它有问题的价值）。因此，假设您的最高时间是昨天（即 2012 年 5 月 31 日）。现在，当您将此值与今天的当前时间进行比较时，您的方法将返回`true`本身正确的方法。

为了检查错误值，我建议您存储一些未来时间，例如大于今天的日期（即 2012 年 6 月 1 日）并执行该方法，它肯定会返回`false`值。

# php - SQL 表单提交结果

> ID：10843695
> 
> 赞同：0
> 
> 时间：2012-06-01T02:31:52.850
> 
> 标签：php, sql, forms

我想显示一条消息，例如：“恭喜！您已注册”。但是该消息出现在页面的左上角。我想在“提交按钮”下方的同一页面中显示它。这是我的代码：

```
if($result)
    {
        //send the email

        $to = "xyz@abc.com";
        $subject = "New order for Weaving Hope";

        //headers and subject
        $headers  = "MIME-Version: 1.0\r\n";
        $headers .= "Content-type: text/html; charset=iso-8859-1\r\n";
        $headers .= "From: ".$name." <".$email.">\r\n";

        $body = "New contact<br />";
        $body .= "Name: ".$name."<br />";
        $body .= "Email: ".$email."<br />";
        $body .= "Contact No.: ".$contact."<br />";
        $body .= "Item Id: ".$itemid."<br />";
        $body .= "Quantity: ".$itemquantity."<br />";
        $body .= "Comment: ".$comment."<br />";
        $body .= "IP: ".$ip."<br />";

        mail($to, $subject, $body, $headers);

        //ok message

        echo "Congrats!";
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T02:45:53.460

这个页面应该很容易理解，它会告诉你该怎么做。 [http://net.tutsplus.com/tutorials/javascript-ajax/submit-a-form-without-page-refresh-using-jquery/](http://net.tutsplus.com/tutorials/javascript-ajax/submit-a-form-without-page-refresh-using-jquery/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:51:16.047

如果您需要在没有 AJAX 的情况下执行此操作，那么您需要在将表单发送到浏览器的同一 PHP 页面中处理表单数据，并设置一个标志来确定数据提交是否成功。

例如：

```
<?php // Call this page register.php

$success = false;
if( $result)
{
    // .. Your code from above
    $success = true;
}

?>
<form action="register.php" method="post">
    <!-- Output the form for submission here -->
    <input type="submit" name="register" value="Register" />
    <?php if( $success): ?>
        <span>Congrats, you are registered!</span>
    <?php endif; ?>
</form> 
```

# python - Flask:Python - 如何检查请求的 IP 地址

> ID：10843700
> 
> 赞同：2
> 
> 时间：2012-06-01T02:32:35.080
> 
> 标签：python, flask

> **可能重复：**
> [使用 Python 获取访问者的 IP 地址（特别是 Flask 微框架）](https://stackoverflow.com/questions/3759981/get-ip-address-of-visitors-using-python-specifically-flask-micro-framework)

我正在用烧瓶创建 REST api。我只想允许来自一个（或以后更多）IP 地址的请求。如何在我的视图中检查 IP 地址？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T02:50:46.827

从[传入的请求数据](http://flask.pocoo.org/docs/api/#incoming-request-data)中获取标头并找到`REMOTE_ADDR`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T03:02:41.457

如果您使用的是谷歌应用引擎，您将使用 self.request.remote_addr

# ruby-on-rails - 将 Wicked 与 Devise 一起用于注册向导

> ID：10843703
> 
> 赞同：2
> 
> 时间：2012-06-01T02:33:17.477
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, wizard

我正在使用带有 wicked 的设计来创建注册向导，但我不确定我在创建配置文件时遇到的问题。在用户提供他们的电子邮件和密码后，他们将被转发到一个步骤，以根据他们是否指定他们是托运人或承运人来创建配置文件。但是我不确定控制器中的代码应该是什么以及一般创建配置文件的表单。这是我的应用程序代码：

步数控制器：

```
class UserStepsController < ApplicationController
  include Wicked::Wizard
  steps :carrier_profile, :shipper_profile

 def create
   @user = User.last
   case step
   when :carrier_profile
     @profile = CarrierProfile.create!(:dot => params[:dot])
     if @profile.save
        render_wizard @user
     else
        flash[:alert] = "Record not saved"
     end
   when :shipper_profile
     @profile = ShipperProfile.create!(params[:shipper_profile)
     if @profile.save
        render_wizard @user
     else
        flash[:alert] = "Record not saved"
     end
   end
 end 
```

结束结束

```
 def show
    @user = User.last
    @carrier_profile = CarrierProfile.new
    @shipper_profile = ShipperProfile.new
    case step
    when :carrier_profile
      skip_step if @user.shipper?
    when :shipper_profile
      skip_step if @user.carrier?
    end
    render_wizard
  end
end 
```

承运人资料表格：

```
<% form_for @carrier_profile , url: wizard_path, method: :post do |f| %>
  <div>
    <%= f.label :dot, "Please enter your DOT Number:" %>
    <%= f.text_field :dot %>
  </div>

  <%= f.submit "Next Step", class: "btn btn-primary" %>
<% end %> 
```

托运人资料表格：

```
<% form_for @shipper_profile , url: wizard_path, method: :post do |f| %>
  <div>
    <%= f.label :company_name, "What is your company name?" %>
    <%= f.text_field :company_name %>
  </div>

  <%= f.submit "Next Step", class: "btn btn-primary" %>
<% end %> 
```

用户模型：

```
class User < ActiveRecord::Base
  has_one :carrier_profile
  has_one :shipper_profile
end 
```

我将如何编写一个通用的 new 和 create 方法来处理创建两个配置文件？使用当前代码，它表明 user_steps 控制器没有 POST 方法，尽管如果我运行 rake 路由，我发现这是不正确的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T09:42:50.240

# 添加一个步骤 :profile_select 以查找应创建的配置文件

```
class UserStepsController < ApplicationController
  include Wicked::Wizard
  steps :profile_select, :carrier_profile, :shipper_profile

  def update
    @user = current_user
    case step
    when :profile_select
      if params[:user][:profile_type] == 'carrier'
        @profile = current_user.carrier_profile.build 
      else
        @profile = current_user.shipper_profile.build 
      end
    when :carrier_profile
      current_user.carrier_profile.update_attributes(params[:carrier_profile])
      when :shipper_profile
      current_user.shipper_profile.update_attributes(params[:shipper_profile])
    end
    render_wizard @user
  end

  def show
    @user = current_user
    case step
    when :carrier_profile
      skip_step if @user.shipper?
    when :shipper_profile
      skip_step if @user.carrier?
    end
    render_wizard
  end
end 
```

# 意见/user_steps/profile_select.html.erb：

# 注意：方法 :put 以便为所有步骤调用更新

```
<%= form_for current_user, url: wizard_path, method: :put do |f| %>
  <%= f.label :profile_type %>
  <%= f.text_field :profile_type %>
  <%= f.submit "Next Step", class: "btn btn-primary" %>
<% end %> 
```

# 意见/user_steps/carrier_profile.html.erb：

```
<% form_for @profile, url: wizard_path, method: :put do |f| %>
  <div>
    <%= f.label :dot, "Please enter your DOT Number:" %>
    <%= f.text_field :dot %>
  </div>

  <%= f.submit "Next Step", class: "btn btn-primary" %>
<% end %> 
```

# 意见/user_steps/shipper_profile.html.erb：

```
<% form_for @profile, url: wizard_path, method: :put do |f| %>
  <div>
    <%= f.label :company_name, "What is your company name?" %>
    <%= f.text_field :company_name %>
  </div>

  <%= f.submit "Next Step", class: "btn btn-primary" %>
<% end %> 
```

# php - 数据未使用 AJAX 发布在 $_POST 变量中

> ID：10843710
> 
> 赞同：1
> 
> 时间：2012-06-01T01:37:02.743
> 
> 标签：php, ajax

我的一个脚本有问题。服务器在 php 中运行，我使用 AJAX 发布数据。这是我的脚本。

PHP 脚本：

```
<?php

include './connConf.php';

if (isset($_POST['pStr'])){
    $preStr=$_POST['pStr'];
    $query="SELECT * FROM advisory WHERE projname in (SELECT projname FROM advisorydata WHERE prefixStr LIKE '%$preStr')";
    $result=mysql_query($query);
    $num=mysql_numrows($result);
    if ($num > 0){
        echo "<font style=\"font-size:12px\" color=\"#FF6820\" face=\"Century Gothic\"><b>Search Result :</b></font><br><br>";
        for ($x=0;$x<$num;$x+=1){
            echo "<font style=\"font-size:12px\" color=\"#FFFFFF\" face=\"Century Gothic\">Project Name:&nbsp&nbsp&nbsp</font><font style=\"font-size:11px\" color=\"#C0FFFF\" face=\"Century Gothic\"><b>".mysql_result($result,$x,"projname")."</b></font><br>";
            echo "<font style=\"font-size:12px\" color=\"#FFFFFF\" face=\"Century Gothic\">APMS ID:&nbsp&nbsp&nbsp</font><font style=\"font-size:11px\" color=\"#C0FFFF\" face=\"Century Gothic\"><b>".mysql_result($result,$x,"apmsid")."</b></font><br>";
            echo "<font style=\"font-size:12px\" color=\"#FFFFFF\" face=\"Century Gothic\">Prefix/es:&nbsp&nbsp&nbsp</font><font style=\"font-size:11px\" color=\"#C0FFFF\" face=\"Century Gothic\"><b>".mysql_result($result,$x,"projprefix")."</b></font><br>";
            echo "<font style=\"font-size:12px\" color=\"#FFFFFF\" face=\"Century Gothic\">Usage Type:&nbsp&nbsp&nbsp</font><font style=\"font-size:11px\" color=\"#C0FFFF\" face=\"Century Gothic\"><b>".mysql_result($result,$x,"usagetype")."</b></font><br>";
            echo "<font style=\"font-size:12px\" color=\"#FFFFFF\" face=\"Century Gothic\">Rate:&nbsp&nbsp&nbsp</font><font style=\"font-size:11px\" color=\"#C0FFFF\" face=\"Century Gothic\"><b>".mysql_result($result,$x,"projrate")."</b></font><br>";
            echo "<font style=\"font-size:12px\" color=\"#FFFFFF\" face=\"Century Gothic\">Offer Details:&nbsp&nbsp&nbsp</font><font style=\"font-size:11px\" color=\"#C0FFFF\" face=\"Century Gothic\"><b>".mysql_result($result,$x,"offerdetails")."</b></font><br><br>";
        }
    }else{
        echo "<font style=\"font-size:12px\" color=\"#FFFFFF\" face=\"Century Gothic\">No results found ...</font>";
    }
}else{
    echo "<font style=\"font-size:12px\" color=\"#FFFFFF\" face=\"Century Gothic\">Problems encountered while processing the data ...</font>";
}
?> 
```

JS脚本：

```
function QueryPrefix()
{
    var xmlhttp;
    var pStr = document.getElementById('Editbox2');
    var htmlHolder = document.getElementById('Html1');
    var butStr = document.getElementById('Button1');

    if (pStr.value.length == 0){
        alert("Please enter a value on the box provided!");
        return; 
    }
    pStr.value="";

    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4)
            {
                htmlHolder.innerHTML=xmlhttp.responseText;
                butStr.disabled=false;
            }
    }
    butStr.disabled=true;

    xmlhttp.open("POST","searchutype.php",false);
    xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    xmlhttp.send("pStr=" + pStr.value);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T02:56:06.000

我尝试重现问题，它似乎对我有用，使用 Chrome 作为客户端和服务器上的 PHP 5.2。但是我确实注意到您没有将 Content-Length 标头作为标头发送，这可能是问题所在。尝试添加：

```
var post = "pStr=" + pStr.value;
xmlhttp.setRequestHeader("Content-length",post.length); 
```

当然，您还必须在发布之前对 pStr.value 进行 URL 编码。正如nickb之前所说，为什么不直接使用jquery之类的框架库呢？

# php - PHP exec 捕获文本

> ID：10843714
> 
> 赞同：0
> 
> 时间：2012-06-01T02:34:28.767
> 
> 标签：php, text, exec, capture

当我对只打印大量文本的 perl 脚本进行 exec 调用时，我遇到了捕获文本的问题。当我运行以下代码时会发生什么，我得到一个 1 个字的结果：“数组”。我需要能够捕获结果，以便我可以稍微改变它们。这是代码：

```
<?php 
    $lastline = exec("perl parseOutput.pl",$retVal);
    echo $retVal;
?> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T02:38:05.960

您有一个输出的文本行数组。

做这样的事情：

```
echo implode( "\n", $retVal); 
```

或者

```
echo implode( "<br />\n", $retVal); 
```

您将看到 perl 脚本生成的所有输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:44:20.707

只需使用[shell_exec](http://www.php.net/shell_exec) ()

```
$fullResult = shell_exec("perl parseOutput.pl");
echo $fullResult; 
```

# c++ - CPP中原始数据类型的构造函数初始化

> ID：10843715
> 
> 赞同：2
> 
> 时间：2012-06-01T02:34:37.523
> 
> 标签：c++, initialization

在 cpp 中，我们可以将原始数据类型初始化为

```
int a(32); 
```

这个构造函数初始化是如何工作的？C++ 是否将其视为对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:46:28.190

最好的描述如下：

**C++03 8.5 初始化器**
**第 12 和 13 段：**

> .......
> 在 new 表达式 (5.3.4)、static_cast 表达式 (5.2.9)、函数符号类型转换 (5.2.3) 以及基类和成员初始化程序 (12.6.2) 中发生的初始化被调用
> *直接初始化*，等价于形式
> 
> Tx(a);
> 
> 如果 T 是标量类型，则声明形式为
> 
> ```
> T x = { a }; 
> ```
> 
> 相当于
> 
> ```
> T x = a; 
> ```

在问题中，类型是`int`标量类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T02:42:39.557

这就是所谓的直接初始化。在 C++ 中，整数不是对象，您在此处编写的表达式也不是构造函数。它只是将 a 初始化为 32 的值。

# css - ul 和 child 的 z-index 优先级

> ID：10843716
> 
> 赞同：1
> 
> 时间：2012-06-01T02:34:53.290
> 
> 标签：css, z-index, css-position

基本上我想要一个相对元素在 z 计划中隐藏它的绝对子元素。

```
ul {z-index:10; position:relative;}
ul ul {z-index:-10; position:absolute;} 
```

它们被定位在彼此之上。第一个应该隐藏它的孩子，但它不是那样发生的。

见[小提琴](http://jsfiddle.net/Qajp6/2)。我试着让红色部分消失在蓝色部分下面。

任何帮助都非常感谢

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T06:42:43.683

您尝试做的特定事情无法完成。通过`z-index`在父 ul 上设置 a，您可以使该元素成为新的堆叠上下文，根据[规范](http://www.w3.org/TR/CSS2/visuren.html#propdef-z-index)，这意味着它的背景和边框将始终位于其所有子元素的下方。

`z-index`如果您从父 ul 中删除设置，您想要的效果可能仍然可以实现。这并不意味着您必须调整页面中其余的 z-index 来进行补偿；您所要做的就是提供另一个元素作为上下文 - 例如，父 ul 的父元素。要使该元素成为堆叠上下文，您只需给它一个 z-index 值 - 任何 z-index 值，只要它是一个数字。

# php - 为什么我在 PHP 中的函数和变量前面看到下划线前缀？

> ID：10843718
> 
> 赞同：2
> 
> 时间：2012-06-01T02:35:26.243
> 
> 标签：php, naming-conventions

这是某种约定吗？我正在查看一些代码，起初我认为它可能是针对私有作用域的，但似乎并非如此。我知道双下划线是 PHP 的魔术方法，但我不确定为什么这个 Recurly 库（https://github.com/recurly/recurly-client-php）的作者在函数和变量前面使用下划线。有人可以向我解释一下吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T02:36:47.537

这是一个约定，意味着方法/属性是私有的

PS：只要它只是一个**约定**，它就可以应用于受保护的和其他任何东西

**编辑 5/2016**

现在**不**推荐了，看[这个](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-2-coding-style-guide.md#42-properties)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T02:48:35.337

看起来他几个月前才使用“var”，最近开始努力用“public/private/protected”替换那些。据我了解，他的代码并不一致。

但是对于历史来说，下划线 (_) 是一种约定，用于指定此方法或变量是私有的还是受保护的。

# c - 在 c 中表示内存

> ID：10843720
> 
> 赞同：3
> 
> 时间：2012-06-01T02:36:26.607
> 
> 标签：c, pointers, memory-management

我正在尝试用 C 编写指令集模拟器来模拟运行 ARM 的机器。我需要能够有效地表示 4GB 内存，经过一番挖掘后，我找到了创建一个由 1024 个指针组成的数组的解决方案，每个指针指向一个 4MB 的块，该块在首次使用时动态分配

```
#define MEMSIZE 1024    //1024 * 2Mb = 4Gb
#define PAGESIZE 4194304    //4 Mb
#define PAGEEXP 22      //2^PAGEEXP = PAGESIZE

uint32_t* mem[MEMSIZE]; 
```

我的问题是如何访问某个内存地址？

我尝试将地址分解为索引和偏移量，如下所示，但这似乎只为索引和偏移量返回 0。（memAdd 是我要访问的地址）

```
memIdx = memAdd >> PAGEEXP;
memOfs = memAdd & PAGESIZE; 
```

获得地址后，我用来读/写的功能如下：

```
void memWrite(uint32_t idx, uint32_t ofs, uint32_t val)
{
    if(mem[idx] == 0)
        mem[idx] = malloc(PAGESIZE);
    *(mem[idx] + ofs) = *(mem[idx] + ofs) & val;
}

uint32_t memRead(uint32_t idx, uint32_t ofs)
{
    if(mem[idx] == 0)
        return 0;
    else
        return *(mem[idx] + ofs);
} 
```

这些在我的脑海中似乎是正确的，但是我仍然不是 100% 对指针感到满意，所以这可能是错误的。

抱歉，如果这已经在某处讨论过，但我找不到任何与我需要的东西相关的东西（我的关键字非常广泛）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T03:26:38.987

开始从逻辑上而不是在位级别上查看它。

每个页面有 4,194,304 字节。

然后，从算术上讲，要将线性地址转换为（页，偏移量）对，除以 4,194,304 得到页码，然后取余数得到页的偏移量。

```
page = address / PAGESIZE;
offset = address % PAGESIZE; 
```

由于您想有效地执行此操作并且这些是 2 的幂，因此您可以用 PAGESIZE 的以 2 为底的对数（即 22）右移替换除以 PAGESIZE：

```
page = address >> PAGEEXP; 
```

所以你的那部分代码是正确的。但是，要获得偏移量，您想要做的是屏蔽除刚刚移出页码的位之外的所有位。为此，您必须与`PAGESIZE - 1`.

```
offset = address & (PAGESIZE - 1); 
```

这是因为在二进制中，您开始使用的是一个看起来像这样的数字（其中 p 是页码位，o 是偏移位）：

```
address = ppppppppppoooooooooooooooooooooo 
```

您想自己获取页码和偏移量。您显然想右移 22 位以获取页码：

```
page = addresss >> 22 = 0000000000000000000000pppppppppp 
```

但是，如果您使用页面大小（二进制中的 00000000010000000000000000000000），则答案中最多只有一个 1 位，它只会告诉您页码是奇数还是偶数。没用处。

你想要的 AND 比那个少一点，即二进制 00000000001111111111111111111111，因此：

```
 ppppppppppoooooooooooooooooooooo 
& 00000000001111111111111111111111
-----------------------------------
= 0000000000oooooooooooooooooooooo 
```

这就是您获得偏移量的方式。

这是一个通用规则：如果 N 是 2 的整数幂，则除以 N 与通过 log(N)/log(2) 右移相同，并且这种除法的余数通过与 ( N-1)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T03:32:32.320

这将做你想要的。我用过更小的尺寸。为了清楚起见，我省略了错误检查。它使用您使用索引器数组的方案。

```
#include <cstdlib>
#include <cstdio>
#include <stdint.h>

#define NUMPAGE 1024
#define NUMINTSPERPAGE 4

uint32_t* buf;
uint32_t* idx[NUMPAGE];

void InitBuf()
{
    buf = (uint32_t*) calloc(NUMPAGE, NUMINTSPERPAGE * sizeof uint32_t );
    for ( size_t i = 0; i < NUMPAGE; i++ )
    {
        idx[i] = &buf[i * NUMINTSPERPAGE * sizeof uint32_t];
    }
}

void memWrite(size_t i, size_t ofs, uint32_t val)
{
    idx[i][ofs] = val;
}
uint32_t memRead(size_t i, size_t ofs)
{
    return idx[i][ofs];
}
int main()
{
    InitBuf();
    uint32_t val = 1243;
    memWrite(1, 2, val);
    printf("difference = %ld", val - memRead(1, 2));
    getchar();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T03:35:14.697

如果`PAGESIZE`是 2 的幂，则它只设置了 1 位。因此，将其与另一个值进行与运算只能在结果中设置零或一个位。两个可能的值。但是您将它用作数组索引。

此外，您的`memWrite(uint32_t idx, uint32_t ofs, uint32_t val)`函数总是 AND 的值`val`。因此，例如，如果对这个函数`val`的`uint32_max`任何调用都将无效。

最后，您不仅不检查`malloc()`失败的结果，也不初始化返回的内存块。

尝试这样的方法（不幸的是我无法测试它，我现在没有编译器）。

```
enum { SIM_PAGE_BITS = 22 };   // 2^22 = 4MiB
enum { SIM_MEM_PAGES = 1024 }; // 1024 * 4MiB = 4GiB
enum { SIM_PAGE_SIZE = (1<<SIM_PAGE_BITS) };
enum { SIM_PAGE_MASK = SIM_PAGE_SIZE-1 };
enum { UNINITIALISED_MEMORY_CONTENT = 0 };
enum { WORD_BYTES = sizeof(uint32_t)/sizeof(unsigned char) };

#define PAGE_OFFSET(addr) (SIM_PAGE_MASK & (uint32_t)addr)
// cast to unsigned type to avoid sign extension surprises if addr<0
#define PAGE_NUM(addr) (((uint32_t)addr) >> SIM_PAGE_BITS)
#define IS_UNALIGNED(addr) (addr & (WORD_BYTES-1))

unsigned char* mem[MEMSIZE];

uint32_t memRead(uint32_t addr) {
    if (IS_UNALIGNED(addr)) return handle_unaligned_read(addr);
    const uint32_t page = PAGE_NUM(addr);
    if (mem[page]) {
        const unsigned char *p = mem[page] + PAGE_OFFSET(addr);
        return *(uint32_t*)p;
    } else {
        return UNINITIALISED_MEMORY_CONTENT;
    }
}

void memWrite(uint32_t addr, uint32_t val) {
    if (IS_UNALIGNED(addr)) return handle_unaligned_write(addr, val);
    const uint32_t page = PAGE_NUM(addr);
    if (!mem[page]) {
        if (val == UNINITIALISED_MEMORY_CONTENT) {
            return;
        }
        mem[page] = malloc(SIM_PAGE_SIZE);
        if (!mem[page]) {
            handle_out_of_memory();
        }
        // If UNINITIALISED_MEMORY_CONTENT is always 0 we can 
        // use calloc instead of malloc then memset.
        memset(mem[page], UNINITIALISED_MEMORY_CONTENT, SIM_PAGE_SIZE);
    } 
    const unsigned char *p = mem[page] + PAGE_OFFSET(addr);
    *(uint32_t*)p = val;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T03:14:32.247

我不相信 的值`memOfs`被正确计算。例如，`4194304`表示的十进制值`PAGESIZE`是`0x400000`十六进制的，这意味着在按位与运算之后，您只得到原始地址的第 22 位，而不是低 22 位。将该值添加到 4MB 页面数组指针实际上会使您超出堆上已分配数组的末尾。将偏移量计算的掩码更改为`0x3FFFFF`，然后将其与原始内存地址按位与，以便计算到页面的正确偏移量。例如：

```
memIdx = memAdd >> PAGEEXP;
memOfs = memAdd & 0x3FFFFF;  //value of memOfs will be between 0 and 4194303 
```

# vb.net - 没有返回记录时的 VB.NET LINQ to EF Sum 函数错误

> ID：10843723
> 
> 赞同：0
> 
> 时间：2012-06-01T02:37:24.257
> 
> 标签：vb.net, linq-to-entities

看过一些 C# 的解决方案，但不知道如何在 VB.NET 中解决问题。

询问：

```
Dim Query = (From t In myEntities.Bookings
Where(t.Ref = Someid)
Select t.People).Sum() 
```

`t.Ref`场是一个`Int`，所以是`t.People`。

该`SomeId`值是相关表的主键。这个问题是`Bookings`表中并不总是有 Ref 值为 Someid 的记录 - 因此查询会引发以下错误。

我已经看到其他人通过捕获错误解决了这个问题，但是通过阅读这个并根据错误信息，似乎应该有一个解决方案（在 VB.NET 中）来转换查询或其中的某些字段查询可空类型？

错误如下：

`The cast to value type 'Int32' failed because the materialized value is null. Either the result type's generic parameter or the query must use a nullable type.`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:19:32.243

您的 Sum() 正在处理整数，而您真正想要的是一个可为空的整数。

`Dim Query = (From t In myEntities.Bookings Where(t.Ref = Someid) Select t.People).Sum(Function(x) CType(x, Integer?))`

见这里：[Linq query with nullable sum](https://stackoverflow.com/questions/696431/linq-query-with-nullable-sum-problem)

# c# - 找不到请求的 .Net Framework 数据提供程序

> ID：10843728
> 
> 赞同：2
> 
> 时间：2012-06-01T02:38:03.220
> 
> 标签：c#, mysql, asp.net-mvc-3, razor

我使用 Visual Studio 2010 Ultimate，项目是 c# MVC3 Razor

我有一个项目在本地机器上运行没有任何问题，使用 MySql（来自在线服务器）数据库就好了，但是当我上传它并且当它到达需要从 MySql 服务器获取数据的部分时，它给了我这个错误：

> 找不到请求的 .Net Framework 数据提供程序。它可能没有安装。

这是我在 Web.config for MySql 中的连接字符串，当我在本地调试项目时，它运行良好。从表格中读取信息并在页面上显示。

```
<add name="istakipDBContext" 
connectionString="Server=xxx.xxx.xxx.xxx; Database=xxx; Uid=xxx;
Pwd=xxx;"  providerName="MySql.Data.MySqlClient" /> 
```

这是整个堆栈跟踪：

> “/”应用程序中的服务器错误。找不到请求的 .Net Framework 数据提供程序。它可能没有安装。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.ArgumentException：找不到请求的 .Net Framework 数据提供程序。它可能没有安装。
> 
> 源错误：
> 
> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。
> 
> 堆栈跟踪：
> 
> [ArgumentException：找不到请求的 .Net Framework 数据提供程序。它可能没有安装。]
> System.Data.Common.DbProviderFactories.GetFactory(String providerInvariantName) +1420503
> System.Data.Entity.Internal.LazyInternalConnection.TryInitializeFromAppConfig(String name) +393
> System.Data.Entity.Internal.LazyInternalConnection.Initialize () +47
> System.Data.Entity.Internal.LazyInternalConnection.get_ConnectionHasModel() +9 System.Data.Entity.Internal.LazyInternalContext.InitializeContext() +262 System.Data.Entity.Internal.InternalContext.GetEntitySetAndBaseTypeForType(类型 entityType) + 17
> System.Data.Entity.Internal.Linq.InternalSet 1.GetEnumerator() +15 System.Data.Entity.Infrastructure.DbQuery`1.Initialize() +63
> System.Data.Entity.Internal.Linq.InternalSet`
> `1.System.Collections.Generic.IEnumerable<TResult>.GetEnumerator() +40 System.Collections.Generic.List`1..ctor(IEnumerable `1 collection) +315 System.Linq.Enumerable.ToList(IEnumerable`1 source) +58 onlinetercume.Controllers.istakiplerController.Index() in C:\wwwroot\nps\nps\Controllers\istakiplerController.cs:21 lambda_method(Closure , ControllerBase , Object[] ) +62
> System .Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase 控制器, Object[] 参数) +17
> System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary 2 参数) +27 System.Web.Mvc.<> *c_DisplayClass15.b* _12() +55 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter 过滤器，ActionExecutingContext preContext，Func 1 过滤器，ActionDescriptor actionDescriptor，IDictionary 1.b__7(IAsyncResult `2 parameters) +208
> System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`
> *`1 continuation) +263
> System.Web.Mvc.<>c__DisplayClass17.<InvokeActionMethodWithFilters>b__14() +19 System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList``2 parameters) +191
> System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +343
> System.Web.Mvc.Controller.ExecuteCore() +116
> System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +97 System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10
> System.Web.Mvc.<>c__DisplayClassb.<BeginProcessRequest>b__5() +37
> System.Web.Mvc.Async.<>c__DisplayClass1.<MakeVoidDelegate>b__0() +21
> System.Web.Mvc.Async.<>c__DisplayClass8`*) +12 System.Web.Mvc.Async.WrappedAsyncResult`1.End() +62 System.Web.Mvc.<>c* _DisplayClasse.b_d *() +50
> System.Web.Mvc.SecurityUtil.b* _0(动作 f ) +7 System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(动作动作) +22 System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +60
> System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult结果）+9
> System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8970061 System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +184*
> 
>  *版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272*

 ** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:42:43.870

错误很明显，找不到 MySQL 数据提供者

如果您部署到生产服务器，可能您还没有部署 MySQL 组件，请检查您是否已将 MySQL dll 部署到应用程序的 bin 文件夹中

一个常见问题是，当您在开发沙箱中的 GAC 中安装了组件并且它们不存在于生产服务器中时，请验证 dll 是否在 GAC 中：

全局程序集缓存 (GAC) 位于：`%windir%\assembly`

*您可以通过将程序集的始终复制*属性选择为 true 来强制将项目中的引用部署到生产服务器，但是，如果将其配置为解析来自 GAC 的引用，那么最好将组件安装在 GAC 中在生产箱中：

![在此处输入图像描述](../Images/4280b3d116bb458c44af4c045abac198.png)

![在此处输入图像描述](../Images/64932cb2d1bd9efa8eb59745468e7c99.png)

这些是在 GAC 中安装 MySQL 数据提供程序的步骤

[http://blog.jeffreymcmanus.com/555/installing-the-mysql-adonet-connector-into-the-global-assembly-cache/](http://blog.jeffreymcmanus.com/555/installing-the-mysql-adonet-connector-into-the-global-assembly-cache/)

作为总结：

*   解决方案1：

    运行以下命令在 GAC 中注册 MySQL 数据提供者（这样您的 MySQL 数据提供者的版本将被全局安装，可供服务器中的所有应用程序使用）

    "C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\gacutil.exe" /i MySql.Data.dll

*   解决方案2：

    将`MySql.Data.dll`dll 复制到应用程序的*bin目录中*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-29T04:34:48.517

对于 Microsoft Visual Studio Professional 2012 中的这个特定错误，只需检查 ProviderName ：

```
 <providerName="System.Data.SqlClient"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-07T13:02:20.847

提供程序需要在分层配置文件之一中注册。例如，我在 machine.config 文件中注册了 oracle 提供程序（这似乎是在我使用 setup instaler 安装 odac 时自动完成的）。

我的 machine.config 看起来像这样：

```
<system.data>
<DbProviderFactories>
  <add name="Oracle Data Provider for .NET" invariant="Oracle.DataAccess.Client" description="Oracle Data Provider for .NET" type="Oracle.DataAccess.Client.OracleClientFactory, Oracle.DataAccess, Version=4.112.2.0, Culture=neutral, PublicKeyToken=89b483f429c47342" />
  <add name="ODP.NET, Managed Driver" invariant="Oracle.ManagedDataAccess.Client" description="Oracle Data Provider for .NET, Managed Driver" type="Oracle.ManagedDataAccess.Client.OracleClientFactory, Oracle.ManagedDataAccess, Version=4.121.2.0, Culture=neutral, PublicKeyToken=89b483f429c47342" />
  <add name="Microsoft SQL Server Compact Data Provider 4.0" invariant="System.Data.SqlServerCe.4.0" description=".NET Framework Data Provider for Microsoft SQL Server Compact" type="System.Data.SqlServerCe.SqlCeProviderFactory, System.Data.SqlServerCe, Version=4.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91" />
</DbProviderFactories> 
```

要小心，因为在 Asp.Net 应用程序中，层次结构中有另一个名为 aslo web.config 的配置文件。它与 machine.config 位于同一文件夹中。在此链接中解释了 Asp.Net 的配置层次结构：[msdn](https://msdn.microsoft.com/en-us/library/ms178685.aspx?f=255&mspperror=-2147217396#Anchor_1)

如果提供程序未在该文件之一中注册，则会引发报告的错误。在这种情况下，我认为解决它的最佳方法是直接在您的 asp.net 应用程序 web.config 文件中添加配置。类似的东西：

```
<system.data>
<DbProviderFactories>
  <remove invariant="Oracle.DataAccess.Client" />
  <add name="Oracle Data Provider for .NET"
          invariant="Oracle.DataAccess.Client"
          description="Oracle Data Provider for .NET"
          type="Oracle.DataAccess.Client.OracleClientFactory,
              Oracle.DataAccess,
              Version=2.111.7.20,
              Culture=neutral,
              PublicKeyToken=89b483f429c47342" />
</DbProviderFactories> 
```*

# python - 如何根据 James Bennett 的文章《So you want a dynamic form》动态创建 ModelForm？

> ID：10843733
> 
> 赞同：2
> 
> 时间：2012-06-01T02:38:34.220
> 
> 标签：python, django, django-forms, django-views

在 James Bennett 的文章[“So you want a dynamic form”](http://www.b-list.org/weblog/2008/nov/09/dynamic-forms/)（2008 年 11 月 9 日）中，他写道，要创建动态表单，您可以执行以下操作：

```
def make_contact_form(user):
    fields = { 'name': forms.CharField(max_length=50),
               'email': forms.EmailField(),
               'message': forms.CharField(widget=forms.Textarea) }
    if not user.is_authenticated():
        fields['captcha'] = CaptchaField()
    return type('ContactForm', (forms.BaseForm,), { 'base_fields': fields }) 
```

但是你会如何做同样的事情`forms.ModelForm`呢？

到目前为止，我只是在做这样的事情（我不知道如何使用`type`内部类'Meta'）

```
def make_order_edit_form(include_fields):
    class _OrderEditForm(forms.ModelForm):
        if 'fa_date' in include_fields:
            fa_date = CustomDateTimeField(label="first appointment time")

        class Meta:
            model = Order
            fields = include_fields
            widgets = custom_widgets

    return _OrderEditForm 
```

`include_fields`我要显示的字段元组在哪里。

但是，即使我写了正确的`make_order_edit_form`，我该如何使用它`views.py`呢？具体来说，如何将 POST 请求和订单实例都传递给它？通常我会做类似的事情

```
order = Order.objects.get(pk=pk)

order_form = OrderEditForm(data=request.POST, instance=order) 
```

**奖金问题：**

为什么 Bennett 创造了`ContactForm`out of`forms.BaseForm`而不是`forms.Form`？（我假设这就是为什么也调用这些字段的原因`base_fields`。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T04:59:17.303

`make_order_edit_form`返回一个`ModelForm`类，因此你可以

```
form_cls = make_order_edit_form(fields)
order_form = form_cls(request.POST, instance=order) 
```

对于奖金问题，请检查`Form`代码：

```
class Form(BaseForm):
    "A collection of Fields, plus their associated data."
    # This is a separate class from BaseForm in order to abstract the way
    # self.fields is specified. This class (Form) is the one that does the
    # fancy metaclass stuff purely for the semantic sugar -- it allows one
    # to define a form using declarative syntax.
    # BaseForm itself has no way of designating self.fields.
    __metaclass__ = DeclarativeFieldsMetaclass 
```

有一个自定义的`Form`元类`DeclarativeFieldsMetaclass`，它自动收集用声明性语法编写的表单字段，如果你使用`Form`in `type()`，它看起来像（以 Bennett 的例子）

```
type('ContactForm', (forms.Form,), {
    'name': forms.CharField(max_length=50),
    'email': forms.EmailField(),
    'message': forms.CharField(widget=forms.Textarea)}
# instead of
type('ContactForm', (forms.BaseForm,), { 'base_fields': fields }) 
```

*更新*

建立`ModelForm`使用`type`，没有太大的不同

```
def make_order_edit_form(include_fields):
    d = {}
    class Meta:
        model = Order
        fields = include_fields
        widgets = custom_widgets 
    d = {'Meta':Meta}
    if 'fa_date' in include_fields:
        d['fa_date'] = CustomDateTimeField(label="first appointment time")
    return type('OrderEditForm', (forms.ModelForm,), d) 
```

# javascript - 使用 javascript:window.close() 关闭 UIWebView；

> ID：10843736
> 
> 赞同：6
> 
> 时间：2012-06-01T02:39:01.713
> 
> 标签：javascript, ios, ios5, uiwebview

这个问题听起来很奇怪，但这是我的情况。

我的（由完成）中有一个`UIWebView`占据`UIView`全屏的`[self.view addSubview:webView];`内容。它故意隐藏点击动作`UIView`之前的。`UIWebView``javascript:window.close();`

如何将`UIWebView`页面中`UIView`的 JavaScript 与操作相关联，例如`[webView removeFromSuperView];`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T13:47:46.347

这个有可能：

在 url 中使用您自己的方案设置位置，即

document.location.href = "myscheme://DoSomething"

这将导致 UIWebViewDelegate 方法 shouldStartLoadWithRequest: 使用方案为“myscheme”的 NSURLRequest 参数调用。因此，您查找此方案并提取 DoSomething，然后对 DoSomething 采取行动，在您的情况下，这将是从 superView 中调用 remove。

（在 UIWebView dealloc 中可能需要确保调用 stopLoading）

# php - 通过 ssl 连接到 phpmyadmin xampp mysql 服务器

> ID：10843737
> 
> 赞同：1
> 
> 时间：2012-06-01T02:39:06.647
> 
> 标签：php, mysql, ssl, phpmyadmin, xampp

我正在使用 xampp 在我的 Mac 上设置本地服务器，但是当我需要为我的站点设置 ssl 时遇到了问题。我设置了 php 端以启用可以正常工作的 ssl，我可以访问“https://localhost/”，它加载了 xampp 欢迎页面。现在，当涉及到 mysql 并将其设置为使用 ssl 时，我无法让它使用 ssl。当我进入 phpmyadmin 并检查变量时，它说 ssl 没有打开并且没有指定密码。

我尝试进入 config.inc.php 并添加以下行：

```
 $cfg['Servers'][$i]['ssl'] = true;
    $cfg['ForceSSL'] = TRUE; 
```

然后我通过 xampp 重新启动了 apache 和 mysql 服务器，但这并没有改变。然后我生成了自己的证书，将它们放在一个文件夹中，并将以下内容添加到同一个 config.inc.php 文件中：

```
 $cfg['Servers'][$i]['ca'] = '/Applications/XAMPP/xamppfiles/etc/ssl/ca-cert.pem';
    $cfg['Servers'][$i]['cert'] = '/Applications/XAMPP/xamppfiles/etc/ssl/client-cert.pem';
    $cfg['Servers'][$i]['key'] = '/Applications/XAMPP/xamppfiles/etc/ssl/client-key.pem'; 
```

这也没有改变mysql的ssl设置。我只是想使用 ssl 在 php 中连接到 mysql。我的 php 代码如下所示：

```
 error_reporting(E_ALL);
   ini_set("display_errors", "1");
   $link = mysqli_init();
   mysqli_ssl_set($link,'/Applications/XAMPP/xamppfiles/etc/ssl/server-key.pem','/Applications/XAMPP/xamppfiles/etc/ssl/server-cert.pem','/Applications/XAMPP/xamppfiles/etc/ssl/ca-cert.pem',null, null);
   mysqli_real_connect($link,$dbhost, $dbuser, $dbpass, $dbname); 
```

我无法连接上面的代码，它给了我一个 ssl 错误。有没有人可以帮助我设置它以便我可以使用 ssl？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2022-02-26T22:44:50.307

XAMPP 中的 MySQL 实际上是一个 MardiaDB 二进制版本。该版本不支持 SSL (TSL)。

试试这个：[如何在 XAMPP 中将 MariaDB 更改为 MySQL？](https://stackoverflow.com/questions/39654428/how-can-i-change-mariadb-to-mysql-in-xampp)

# php - 在最后一个斜杠之后忽略 URL 中的最后一个字符串

> ID：10843740
> 
> 赞同：0
> 
> 时间：2012-06-01T02:39:56.440
> 
> 标签：php, apache, .htaccess, url-rewriting

例如：当用户输入 时`www.website.com/site/blue`，我希望他们进入`www.website.com/site/index.php`网络浏览器。这样做的原因是我想使用php从URL中抓取蓝色并将其放入`www.website.com/site/index.php`

所以当有人输入......`www.website.com/site/blue`他们应该看到`"Hello blue!!!"``www.website.com/site/index.php`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T03:19:34.017

听起来您需要使用 htaccess 文件和 Apache 的 mod_rewrite。如果您被允许在您的服务器上执行此操作，请在目录中创建一个名为`.htaccess`的`site`文件。

```
RewriteEngine on
RewriteRule ^(.*)$ index.php?color=$1 
```

这会将每个请求重写为查询字符串以`index.php`供您解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:26:39.947

试试这个 htaccess 配置：

```
RewriteEngine on
RewriteCond $1 !^(index\.php|resources|robots\.txt)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L,QSA] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T02:51:20.387

基本上，您可以在“/”处拆分页面 URL，它将为您提供 URL 部分的数组。在您的示例中，最后一个部分将是“蓝色”。尝试以下操作：

```
var parts = document.URL.split("/");
var foo = parts.pop();
var url = parts.join("/") + "/index.php";
window.location.href = url; 
```

然后变量`foo`就是您要查找的变量“蓝色”。

# email - Magento - 如何在“存储电子邮件地址”中格式化电子邮件地址？

> ID：10843741
> 
> 赞同：0
> 
> 时间：2012-06-01T02:40:28.343
> 
> 标签：email, magento, formatting, magento-1.5

我要做的是像这样格式化电子邮件地址，`Foo Bar <foo@bar.com>`以便电子邮件客户端（包括基于 web 的 gmail）将发件人显示为“Foo Bar”而不仅仅是“foo”，因为这是电子邮件的前缀。

这在 Magento 1.5 中可行吗？如果我尝试将格式设置在字段本身中，我会收到一条错误消息。

![在此处输入图像描述](../Images/065f57fe21849b9a1aa468d40259d373.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T13:45:37.837

这就是发件人姓名字段的作用。这就是我的设置和 Thunderbird 中的设置（我的 webmail 客户端的格式也类似）：

![图片](../Images/18584080a901509a81627d06545e107b.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T13:37:34.613

您可以查看`code/core/Mage/Core/Model/Email.php`实际的邮件实现。您可能会注意到它使用`Zend_Mail`. 现在，这是问题所在：

```
For security reasons, Zend_Mail filters all header fields to prevent header 
injection with newline (\n) characters. Double quotation is changed to single 
quotation and angle brackets to square brackets in the name of sender and recipients. 
If the marks are in email address, the marks will be removed. 
```

您可以做的是制作一个模块来重写当前类`Mage_Core_Model_Email`并覆盖`send()`函数。[我之前在这个问题的答案](https://stackoverflow.com/questions/10622791/getting-a-product-attribute-from-within-another-product-attribute/10624517#10624517)中介绍了重写课程。然后，在这个重写的新类中，您可以使用 PHPmailer、调用 shell 邮件命令或任何您碰巧知道的允许这种行为的 PHP 库。

祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-02T15:48:52.063

我不确定它是否可以工作。在 magento 里面是一个 Zend_Validate，它对这些电子邮件地址进行验证。而且我不认为像“Foo Bar”这样的电子邮件是有效的。但我认为客户电子邮件客户端中的显示取决于客户端，不是吗？

# ruby-on-rails-3 - url_for 在 Rails 3.2 中向查询字符串添加控制器和操作

> ID：10843745
> 
> 赞同：0
> 
> 时间：2012-06-01T02:41:22.750
> 
> 标签：ruby-on-rails-3, actionmailer

我正在尝试在 actionmailer 模板中生成一个 url。如果我要生成的 url 是一个示例

```
http://0.0.0.0:3000/users/confirm/lNbQxzFukYtEEw2RMCA 
```

最后一段是用于识别用户的哈希

但是，当我使用这个

```
<%= url_for(:controller => 'users', :action => 'confirm', :id => @user.confirmhash, :only_path => false) %> 
```

它生成这个

```
http://0.0.0.0:3000/assets?action=confirm&controller=users&id=ZOR3dNMls8533T8hJUfCJw 
```

我怎样才能让它正确格式化？我不知道“资产”从何而来。

有没有更简单的方法来使用我缺少的命名路由？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:17:53.247

我找到了答案。由于我仍在学习，我错过了创建命名路线的选项。所以这就是我所走的路。

在 config/routes.rb

```
match 'user/confirm/:id' => 'users#confirm', :as => :confirm_account 
```

然后在我使用的动作邮件模板中

```
<%= link_to "Confirm your account", confirm_account_url(@user.confirmhash) %> 
```

它将 :id 传递给控制器​​操作。

# html - 用于客户端文件的基于 Web 的音乐播放器

> ID：10843747
> 
> 赞同：1
> 
> 时间：2012-06-01T02:41:26.067
> 
> 标签：html, web, audio-player

我希望创建一个基于网络的音乐播放器来娱乐。我希望访问本地文件系统。客户端用户应该能够选择一个目录并在其中播放歌曲。

我知道它不是一个好的设计，通常客户端语言无法访问本地文件系统。但是随着网络操作系统和其他东西的出现，应该有一些技术可以在用户同意的情况下实现这一点。

我现在考虑使用 vaadin，但如果需要，我不介意改变我的开发环境。

# facebook - 使用 Facebook Graphs API 发布照片并标记朋友

> ID：10843749
> 
> 赞同：2
> 
> 时间：2012-06-01T02:42:00.047
> 
> 标签：facebook, facebook-graph-api

我有这个发布到用户墙上的代码：

```
FB.api('/me/photos', 'post', {
        message:'photo description',
        url:imgURL        
    }, function(response){
        console.log(response);
        if (!response || response.error) {
            console.log(response);
        }else{
            FB.api(response.id+'/tags/me', {
                to: $("#recipientID").val()
            }, function(response){
                console.log(response)
            });
        }
    }); 
```

第一部分完美运行我只是不知道如何将朋友标记到其中，我的标记调用给了我一个空数组。Facebook 文档真的很难理解，而且它并没有给出任何如何做到这一点的例子，所以请不要只给我他们文档的链接，因为我已经阅读了他们所拥有的任何相关内容，但我仍然可以'不要这样做。

也试过这个没有成功：

```
FB.api('/me', function(response){
                var userId = response.id;
                FB.api('/'+response.id+'/tags/'+userId, {
                    to: $("#recipientID").val()
                }, function(response){
                    console.log(response)
                });
            }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T04:51:40.047

我终于设法破解了它，这与我使用的调用不同：

```
FB.api('/me/photos', 'post', {
    message:'Checking tags',
    url:imgURL
}, function(response){
    if (!response || response.error) {
       console.log(response);
    }else{
      //tags friend     
      var postId = response.id;
      FB.api(postId+'/tags?to='+friendID, 'post', function(response){
         if (!response || response.error) {
            console.log(response);
         }
      });
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T04:28:49.777

你不能在同一个通话中上传和标记朋友，你必须先上传，然后标记朋友。如果有更多的朋友，那么你必须使用循环一个一个地标记它们，否则它将不起作用，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T02:28:30.920

我从这篇文章中的代码开始，在一张照片中标记多个人。它在我的代码库中工作，我试图提炼它，但它可能需要更多的工作，不确定。认为它可能会帮助尝试做同样事情的人。

如果有人有任何改进的想法，我会全力以赴：

```
//Set empty array of Friend ID's
var friendIds = []

//Get friend ID's
getFriendById = function(id) {
    var i, len;
    id = id.toString();
    for (i = 0, len = friends.length; i < len; i += 1) {
        if (friends[i].id === id) {
            return friends[i];
        }
    }

    friendIds.push(friends);
};

var postToWall = function(){

    //Assign Friends to variables
    var name1 = getFriendById(friendIds[0]);
    var name2 = getFriendById(friendIds[1]);
    var name3 = getFriendById(friendIds[2]);

    //Set empty array for tags  
    var tags = [];

    //Loop through friends and make an array ready for posting
    $.each(selectfriends, function(i,friend){
        var new_tag = {tag_uid: friend};
        tags.push(new_tag);
    })

    //Post photo to wall
    FB.api('/me/photos', 'post', {
        message:'Enter custom message',
        url: 'link/to/photo.jpg'
    }, function(response){
        console.log(response)
        if (!response || response.error) {
            console.log('error');
        } else {
            //Tag Friends
            var postId = response.id;
            //Use stringify to send the array in string to facebook
            FB.api(postId+'/tags?tags='+JSON.stringify(tags), 'post', function(response){
                if (!response || response.error) {
                    console.log('error');
                }
            });
        }
    });
} 
```

# graph-theory - “钻石”有向无环图的正确术语是什么？

> ID：10843765
> 
> 赞同：6
> 
> 时间：2012-06-01T02:44:59.577
> 
> 标签：graph-theory, directed-acyclic-graphs

我想谈谈有向无环图中从节点节点到另一个节点有多条路径的地方。这不是一个“循环”，我应该怎么称呼它？我使用的是“钻石”一词，但这意味着只有四个节点，这是不对的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-06T11:32:48.483

正如您所说，正确的术语不太可能是菱形图，它已经具有相似但略有不同的[含义](http://en.wikipedia.org/wiki/Diamond_graph)。

这很难看，但是您所指的图是偶极[图的](http://en.wikipedia.org/wiki/Dipole_graph)[同胚](http://en.wikipedia.org/wiki/Homeomorphism_%28graph_theory%29)。也就是说，您可以通过收缩任何边的入度和出度为 1 来简化图形。

根据过去的经验，图论术语可能很难。如果您有数学家的朋友或同事，在这种情况下，他们应该始终是您的第一站。如果你有时间，你可以使用一个很好的图论参考。我推荐Bondy 和 Murty 的[Graph Theory](https://rads.stackoverflow.com/amzn/click/com/3642142788)[或](https://rads.stackoverflow.com/amzn/click/com/1846289696)Diestel 的 Graph Theory。如果两者都不可用，您可以随时尝试[wikipedia](http://en.wikipedia.org/wiki/Glossary_of_graph_theory)或与数学相关的 stackexchange 站点之一。

# javascript - 如何在 knockout.js 中编写此表达式？

> ID：10843766
> 
> 赞同：0
> 
> 时间：2012-06-01T02:45:09.660
> 
> 标签：javascript, jquery, knockout.js

编写数据绑定表达式很简单，例如：

```
<span data-bind="text: userName"></span> 
```

但我想在 userName 之前包含 Hello ，因此跨度应如下所示：

你好世界

World 是用户名在哪里

我怎样才能在数据绑定表达式中写这个？

**注意：**请不要建议我把Hello移出span，静态写：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:47:54.730

Knockout 也可以绑定表达式：

```
<span data-bind="text: 'hello ' + userName()"></span> 
```

# javascript - 在 Apps 脚本中，如何在自定义函数中包含可选参数

> ID：10843768
> 
> 赞同：21
> 
> 时间：2012-06-01T02:45:44.160
> 
> 标签：javascript, google-apps-script, google-sheets, custom-function

我想编写一个自定义函数，它有一些强制参数，但也可以接受一些可选参数。我找不到任何关于此的文档。有人知道吗？它类似于 Javascript 吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-06-04T14:12:42.840

自定义函数没有必填字段和可选字段的概念，但您可以使用如下逻辑模拟该行为：

```
function foo(arg1, opt_arg2) {
  if (arg1 == null) {
    throw 'arg1 required';
  }
  return 'foo';
} 
```

约定使用前缀“opt_”作为可选参数，但这不是必需的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2020-05-10T12:12:14.127

是的，它是 JavaScript（对 JsDoc 的支持也有限），所以你可以有一个带有默认值的可选参数：

```
/**
 * This is myFunction.
 * @param {number} arg1 - Some number.
 * @param {string} arg2 - Some string.
 * @param {number} arg3 - [OPTIONAL] Additional numbers or ranges to add to value1.
 * @customFunction
**/
function myFunction(arg1, arg2, arg3=false) {
  return arg3;
} 
```

然后您可以使用以下任一方法在电子表格中调用它：

```
=myFunction(1, "somestring", true) 
```

或者没有可选参数：

```
=myFunction(1, "somestring") 
```

由于 JavaScript 动态处理参数列表。

# java - OpenGL JOGL 纹理轮廓

> ID：10843773
> 
> 赞同：1
> 
> 时间：2012-06-01T02:46:29.587
> 
> 标签：java, opengl, textures, jogl

我在 OpenGL (JOGL) 中绘制了一些点，如下所示：

```
BufferedImage image = loadMyTextureImage();
Texture tex = TextureIO.newTexture(image, false);
tex.setTexParameteri(GL.GL_TEXTURE_MIN_FILTER, GL.GL_LINEAR);
tex.setTexParameteri(GL.GL_TEXTURE_MAG_FILTER, GL.GL_LINEAR);
tex.bind();

gl.glColor4f(r,g,b,a);        
gl.glBegin(GL_POINTS);
for ( int i = 0; i < numPoints; i++ ) {
   // compute x,y,z
   gl.glVertex3f(x,y,z);
}
gl.glEnd(); 
```

我`image`的是白色图像，所以我可以重复使用相同的纹理并使用 对其进行着色`gl.glColor4f`，但我想用不同的颜色在它周围绘制轮廓。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T03:13:16.443

如果您使用纹理来确定点的形状，那么绘制轮廓的明显方法是添加第二个纹理以在顶部绘制点的轮廓。

轮廓纹理也将是白色的，因此您可以以相同的方式将其着色为您喜欢的任何颜色。

根据您使用的 alpha 混合模式，这也可用于提供“发光”边缘效果。

# etl - 使用 pentaho 数据集成的 SQL 标识列插入

> ID：10843774
> 
> 赞同：3
> 
> 时间：2012-06-01T02:46:30.810
> 
> 标签：etl, pentaho, data-integration

我是 Pentaho 数据集成工具的新手。我正在尝试将数据从源表移动到目标表......两者都是 SQL Server。这些表是相同的并且有一个标识列。

尝试了很多选项，但是......每次说“Indentity insert is set to OFF”时都会出错

尝试在中间引入一个跃点以执行 SQL 语句到“SET identity_insert tblname ON”.. 仍然有效。

任何建议将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-11T07:43:48.970

把它放在一个跳跃中肯定行不通，因为 PDI/kettle 每一步都使用一个连接。您需要将该设置放在数据库连接的高级选项中，然后就可以了 - 然后它将用于该数据库连接的所有实例。

还要确保您“共享”您的数据库连接，否则如果您在每次转换中手动创建它们，您需要将该设置应用于每个转换中的每个数据库连接。（除非您使用的是数据库或 EE 存储库，在这种情况下连接是集中的，所以您没问题）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-14T02:41:56.267

您应该在建立数据库连接后添加一个命令。

![图片](../Images/a49342274e2f5fceb2765a5867bbe52e.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-05T03:21:57.740

您可以尝试的另一件事是从您用来从源传递到目标的选择中删除标识列。

这样，您将确保 SQL 将为尝试插入它们的每一行创建一个新标识，

# c - # 和 ## 运算符在 C 中的作用是什么？

> ID：10843777
> 
> 赞同：1
> 
> 时间：2012-06-01T02:47:00.000
> 
> 标签：c

#NAME 或 ##NAME 之类的东西。它们在 C 中是什么意思？我在关于宏的 GCC 文档中看到了它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:52:57.597

从描述[C 预处理器](http://en.wikipedia.org/wiki/C_preprocessor#Token_concatenation)的维基百科页面：

> ## 运算符将两个标记连接成一个标记，如下例所示：

```
#define DECLARE_STRUCT_TYPE(name) typedef struct name##_s name##_t
DECLARE_STRUCT_TYPE(g_object); // Outputs typedef struct g_object_s g_object_t; 
```

运算符向 C 预处理器发送其他指令，`#`例如：`#include, #define, #undef, #error, #if, #ifdef, #ifndef, #else, #elif, #endif`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T02:53:54.050

以 开头的代码语句`#`表示后面是预处理器指令，应由预处理器扩展。

`##`称为令牌***[粘贴或令牌连接宏](http://gcc.gnu.org/onlinedocs/cpp/Concatenation.html)***。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T11:48:58.143

运算符 ## 连接两个参数，它们之间没有空格。

```
 #define printe(a,b) a ## b
   printe(c,out) << "testing"; 
```

输出是：测试

并且单个 # 用于使用字符串参数替换参数，例如

```
#define  st(x)  #x
 cout<<st(tesing); //  equivalent to  cout<<"testing"; 
```

和 # 也是一个预处理器指令..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T03:02:03.157

'#' 实际上不是运算符，它们是预处理器指令，而'##' 仅用于函数宏定义。

* * *

C中有许多预处理器指令：

对于宏定义，有：

```
#define
#undef 
```

对于有条件的包含，有：

```
#ifdef
#ifndef
#if
#endif
#else
#elif 
```

对于线路控制，有：

```
#line 
```

对于错误，有：

```
#error 
```

对于源文件包含，有：

```
#include 
```

对于 Pragma 指令，有：

```
#pragma 
```

* * *

有关更多信息，请阅读此[http://www.cplusplus.com/doc/tutorial/preprocessor/](http://www.cplusplus.com/doc/tutorial/preprocessor/)

# javascript - Chrome 没有执行 jQuery 动画回调中的所有行

> ID：10843778
> 
> 赞同：0
> 
> 时间：2012-06-01T02:47:01.573
> 
> 标签：javascript, jquery, google-chrome, callback, cross-browser

我有一些代码可以为`<div>`. 当动画完成后，有几件事需要发生（主要是对各种元素的 CSS 操作），所以我很自然地将它们放在 jQuery 的 .animate() 提供的回调中；

它在 Firefox 中的行为与预期的一样。我不知道这是否是 IE 中的问题，因为仍然有一些 CSS 问题阻止它在那里正确显示 - 我不知道它是 CSS 还是我在 Chrome 中遇到的相同问题。无论如何，目前，我专注于 Chrome。

`console.log`需要注意的一件事是，如果我在未执行的行之前做一个正确的事情，它就不会发生。如果我插入断点然后让它继续，则相同。

```
 $sliders.animate($thisSlideConfig, 250, function() {

            $newPg.removeAttr('style');

            $curPg = $newPg;
            $curPgInf = plugin.getPgInf($curPg);
            plugin.setIndTxt();
            load2nav();
            plugin.adjustNavState();

            doCleanup();

        }); 
```

这条线也没有运行是`$newPg.removeAttr('style');`

我在块中的哪个位置放置该行或如何选择似乎并不重要`$newPg`。

哦，是的，我使用的是 Chrome 19.0.1084.52。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T02:51:05.467

删除该`style`属性是不可靠的。它可能不会触发页面的重绘（而控制台日志或断点会强制它）。相反，请尝试手动调用：

```
$newPg.style.XYZ = ""; 
```

对于您定义的每个样式属性，如果您可以列出它们。如果没有，试试这个：

```
for( var x in $newPg.style) $newPg.style[x] = ""; 
```

这些将触发正确的重绘，并有望阻止问题。

# git - Gitolite：添加用户不起作用，并且在克隆为 root 时被 fallthru 拒绝？

> ID：10843781
> 
> 赞同：6
> 
> 时间：2012-06-01T02:47:38.213
> 
> 标签：git, clone, gitolite

我设法在我的 NAS 上初始化了一个空的 git repo，我尝试通过生成一个新的公钥“foo.pub”并将其复制+粘贴到 keydir/ 并提交并将其推送到 NAS 来添加一个新用户.

**首先，文件：**

这是我的 ~/.ssh/config 文件：

```
Host root
    HostName iptonas
    User root
    Port 123        

Host foo
    HostName iptonas
    User foo
    Port 123
    identityfile ~/.ssh/foo 
```

从 NAS 获取 gitolite-admin 的副本：

```
git clone ssh://root/gitolite-admin 
```

我得到：

```
Cloning into 'gitolite-admin'...
remote: Counting objects: 12, done.
remote: Compressing objects: 100% (9/9), done.
remote: Total 12 (delta 1), reused 0 (delta 0)
Receiving objects: 100% (12/12), done.
Resolving deltas: 100% (1/1), done. 
```

这是我的 gitolite.conf 文件：

```
repo gitolite-admin
    RW+     =   git

repo testing
    RW+     =   @all

repo newrepo
    RW+     =   foo
    RW+     =   bar 
```

当我使用以下命令推送我的 gitolite-admin 副本时：

```
git push root:gitolite-admin 
```

我得到：

```
Counting objects: 10, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (5/5), done.
Writing objects: 100% (6/6), 1.02 KiB, done.
Total 6 (delta 0), reused 0 (delta 0)
remote: Initialized empty Git repository in /root/repositories/newrepo.git/
To root:gitolite-admin
   897113c..e7e2daf  master -> master 
```

**现在，当我尝试推送到新的仓库时**

当我尝试运行时：

```
git clone foo:newrepo 
```

我得到：

```
Cloning into 'newrepo'...
foo@iptonas's password: 
fatal: 'newrepo' does not appear to be a git repository
fatal: The remote end hung up unexpectedly 
```

当我尝试运行时：

```
git clone root:newrepo 
```

我得到：

```
Cloning into 'newrepo'...
FATAL: R any newrepo git DENIED by fallthru
(or you mis-spelled the reponame)
fatal: The remote end hung up unexpectedly 
```

我不确定我做错了什么？

我遵循这些说明： [http](http://www.nineproductions.com/linux/53-gitolite-hosting.html) ://www.nineproductions.com/linux/53-gitolite-hosting.html 在“添加存储库和用户”下

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-01T04:00:33.217

这些说明提到`id_rsa.pub`使用安装 Gitolite 时使用密钥的用户进行克隆。

因此，在声明“ ”用户（这是唯一能够克隆repo 的用户）时，您的帐户中必须包含gitolite 使用`~/.ssh`的`id_rsa`和键。`id_rsa.pub``git``gitolite-admin`

现在，要添加用户，您不仅必须在`gitolite.conf`文件中声明所述用户（您已经这样做了），还必须将他的公钥添加到本地`gitolite-admin`repo ' `keys`' 目录。

> *   我让 Steve Franko 使用“<code>ssh-keygen -t dsa”</li> 生成一个新的公钥/私钥对
> *   我让 Steve Franko 将他刚刚生成的 PUBLIC 密钥发送给我
> *   我将公钥重命名`id_dsa.pub`为`sfranko.pub`
> *   `sfranko.pub`我将密钥复制到`gitolite-admin/keydir`目录中

如果您在 push back 之前执行了这两项操作`gitolite-admin`，那么 Gitolite 将声明该新用户，并且您`git clone foo:newrepo`将工作。

请注意，如果您`git`按照我之前推荐的帐户进行 Gitolite 安装，您的配置文件中应该有：

```
Host git
    HostName iptonas
    User git
    Port 123
    Identityfile ~/.ssh/git 
```

去一个`git clone git:gitolite-admin`。

您应该看到/使用的唯一时间`root`是在服务器端安装开始时，以便声明/添加`git`帐户。
在那之后，我真的建议您不要`root`在流程中的任何地方使用/查看。

* * *

> 实际上我确实生成了两个密钥集，所以我的`~/.ssh`文件夹目前有：`id_rsa`, `id_rsa.pub`, `id_foo`,`id_foo.pub`

您的`~/.ssh`文件夹应包含：

`git`, `git.pub`, `id_foo`,`id_foo.pub`

**Gitolite 的授权机制基于在公钥名称之后进行的身份验证**。

`/tmp/git.pub`再说一遍：在服务器端，您必须以 'git' 之类的用户身份进行 gitolite 安装，并以 a (not `/tmp/id_rsa.pub`)作为参数

* * *

让我们回顾一下，因为这里有很多混乱。**Gitolite 基于 ssh**。
这意味着您在服务器端（将是您的 Gitolite 服务器）需要一个帐户（此处为“git”），其中一个`~git/.ssh/authorized_keys`文件将记录所有 Gitolite 管理员/用户公钥。

在客户端（您的用户 foo），您需要（至少对于您的第一个用户）来自 git 的公钥和私钥，以及来自 foo 的公钥和私钥。

您的`~foo/.ssh/config`文件将包含：

```
Host gitadmin
    HostName iptonas
    User git
    Port 123        
    identityfile ~/.ssh/git

Host foo
    HostName iptonas
    User git
    Port 123
    identityfile ~/.ssh/foo 
```

请注意，**任何 ssh 通信的用户始终是 git**！您总是通过 ssh 地址联系 Gitolite 服务器，例如`ssh://git@iptonas:123/arepo`.
除了，因为你有多个 SSH 密钥可供选择，你可以输入：

*   `git clone gitadmin:gitolite-admin`， 或者
*   `git clone foo:newRepo`

第一个命令将允许您克隆`gitolite-admin`repo（因为您使用 git public 和 private ssh 密钥执行此操作，因此您有权执行此操作）。
您可以使用该本地克隆放入`foo.pub`目录，并在文件`keys`中声明 a 。 然后你推回那个 repo（Gitolite 会发挥它的魔力，创建一个新的 repo，为你添加to的内容，使用强制命令脚本来拦截由 发出的任何 ssh 命令）。`newRepo``config`
`foo.pub``~git/.ssh/authorized_keys``foo`

（我更喜欢将 ssh 快捷方式命名为 ' `gitadmin`' 而不是 git，即使公钥/私钥被命名为 ' `git.xxx`'，因为 ' `gitadmin`' 更好地传达了您将使用它执行的 ssh 命令的*意图*：您将管理 git 访问权限）

第二个命令允许您克隆您的`newRepo`并对其进行处理。

注意：

*   `ssh gitadmin`， 或者
*   `ssh foo`

将显示 gitolite 版本以及与文件中定义的每个 ssh 快捷方式 ' `gitadmin`' 和 ' ' 使用的 ssh 键相关联的权限。`foo``~foo/.ssh/config`

# events - Google Fusion Table 双击 (dblClick)

> ID：10843783
> 
> 赞同：1
> 
> 时间：2012-06-01T02:47:55.093
> 
> 标签：events, google-maps, click, google-fusion-tables

我正在使用融合表来覆盖某些州的县。只需单击一下，我就会显示一个弹出窗口，显示该县的详细措施。我被要求深入了解有关 dblclick 事件的更多信息（深入到另一个报告/地图）。我知道地图会一直触发 dblclick 事件，除非 dblclick 位于标记或叠加层上。现在有了这么长的介绍......任何人都可以帮我获得 dblclick

```
google.maps.event.addListener(ftLayer, 'dblclick', function(e) {
        var url ="http://the_URL";
        window.location.href = url;
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-08T22:28:47.080

dblclick 当前未在 Fusion Tables 图层上启用。请随时打开功能请求：

[http://code.google.com/p/gmaps-api-issues/issues/list](http://code.google.com/p/gmaps-api-issues/issues/list)

# perl - Perl：无法检查 Net::Appliance::Session 主机名的有效性

> ID：10843784
> 
> 赞同：1
> 
> 时间：2012-06-01T02:48:18.970
> 
> 标签：perl, ssh, module, cisco

当我尝试传递无效的主机名时，代码将进入无限循环。

```
my $s = Net::Appliance::Session->new({
personality => 'ios',
transport => 'SSH',
host => $ip
}); 
```

有没有办法克服这个错误？

编辑：这是我的完整代码：我使用子程序下载我的网络设备的配置文件。当我在 download_config 中传入无效的 IP 地址时，它将进入无限循环。

```
sub download_config
{
    my ($ip) = @_;
    my $s = Net::Appliance::Session->new({
     personality => 'ios',
     transport => 'SSH',
     host => $ip,
     Timeout => 1
    });

$s->set_global_log_at('debug'); # maximum debugging

    eval {
        $s->connect({ username => $username, password => $password });
        $s->begin_privileged({ password => $enable_password });

        #get hostname to set the file name
        $hostname_result = $s->cmd('sh run | inc hostname');
        $hostname_result =~ m/hostname (.*)/;
        $hostname = $1;

        #download the file
        my @running_config = $s->cmd('sh run');
        @running_config = @running_config[ 2 .. (@running_config -1)];#remove header and footer of the file
        open(FH, "> temp/".$hostname.".txt") or die("Cannot open config file : $!");
        print FH @running_config;
        close FH;
        $s->end_privileged;
    };
    if ($@) {
    #when the login details are wrong
        print redirect('../../na/unauthorised.html');
    }
    $s->close;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-07T05:25:30.247

开发人员已修复该错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T09:29:34.130

你确定吗？

您是否使用您的主机名尝试了此示例代码？

[http://cpansearch.perl.org/src/OLIVER/Net-Appliance-Session-3.120560/examples/example-1.pl](http://cpansearch.perl.org/src/OLIVER/Net-Appliance-Session-3.120560/examples/example-1.pl)

如果是，您可以创建一个 RT 票，或者您可以尝试联系作者。

我已经破解了代码，并没有发现任何（太）讨厌的东西。

问候，

# javascript - 如何获取隐藏溢出并在悬停时显示完整内容的链接？

> ID：10843786
> 
> 赞同：0
> 
> 时间：2012-06-01T02:48:47.360
> 
> 标签：javascript, jquery, html, css

我正在尝试获取一个链接以加载以一定宽度截断的文本。然后当用户将鼠标悬停在上面时，它会显示锚标记的全部内容。我在[http://jsfiddle.net/GCXsq/564/](http://jsfiddle.net/GCXsq/564/)有一个小提琴，但它最初显示了链接的全部内容，它还使悬停时的链接宽度为 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T02:57:20.227

[http://jsfiddle.net/GCXsq/565/](http://jsfiddle.net/GCXsq/565/)

你的主要问题是你的悬停元素没有（元素）孩子，所以你总是从 0 宽度开始制作动画。

# php - 使用 jQuery 从 php 循环中选择元素的 id

> ID：10843788
> 
> 赞同：1
> 
> 时间：2012-06-01T02:48:51.220
> 
> 标签：php, javascript, jquery, select, loops

我有两个包含客户信息的下拉列表。使用 PHP for 循环，我允许一次输入 5 个客户的详细信息。

```
for($i=1; $i<6; $i++)
{
   echo "<tr><td><select id=\"customer_" . $i . "_class\"></select></td>";
   echo "<td><select id=\"customer_" . $i . "_age\"></select></td></tr>";
} 
```

现在我想以这样的方式执行一个 jQuery 函数，例如，如果 customer_2_class 发生变化，它会执行一些函数到其对应的 customer_2_age。

```
$("#customer_?_clas").change(function()
{
   //some function to execute on corresponding customer_?_age
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:55:26.230

将类添加到您的`<select>`并将 id 移动到另一个属性，例如`data`：

```
echo "<tr>";
echo "<td><select class=\"customer_class\" data-id=\"$i\"></select></td>";
echo "<td><select class=\"customer_age\" data-id=\"$i\"></select></td>";
echo "</tr>"; 
```

在你的 javascript 中：

```
$('.customer_class').change(function() {
  var id = $(this).attr('data-id');
  // process customer_class with this id
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T02:57:05.560

您可以使用[属性 end-with selector](http://api.jquery.com/attribute-ends-with-selector/)：

```
$('select[id$="_class"]').change(function() { 
```

浏览[完整的 jQuery 选择器列表](http://api.jquery.com/category/selectors/)可能是值得的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T03:09:03.277

```
$('select').
   filter(function() { 
       return /^customer_[0-9]_class$/.test(this.id); // filter on select 
                                                      // based on id format
   }) 
   . change(function() {                              // binding change 
                                                      // to filtered select
       var num = this.id.match(/\d/)[0];              // get numerical value 
                                                      // of select box on change

       $('#customer_' + num + '_age')                 // point to target select 
            .css('background', '#f00');               // do something
   }); 
```

**[工作样本](http://jsfiddle.net/thecodeparadox/QStkd/94/)**

# git - 将 .gitattributes 文件中的合并规则应用于 git rebase 调用

> ID：10843789
> 
> 赞同：3
> 
> 时间：2012-06-01T02:49:10.330
> 
> 标签：git, rebase, git-merge, gitattributes

我之前已经阅读并应用了[这个优秀答案](https://stackoverflow.com/questions/928646/how-do-i-tell-git-to-always-select-my-local-version-for-conflicted-merges-on-a-s)中关于在 git 中为特定文件类型设置合并策略的说明。这非常适合合并。但是，当我执行 a 时`git rebase`，不会应用合并策略。

是否可以设置`git rebase`为应用类似的合并策略来自动解决某些冲突？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-13T09:19:26.260

您可以强制 rebase 对重命名的文件应用相同的规则（也会导致问题）与合并

```
 git rebase --merge 
```

它也可能适用于您的问题。当您想在变基时应用 eol 转换时，它不起作用。

# javascript - 为什么在 Javascript 中使用空的 for 循环——for(;;)？

> ID：10843790
> 
> 赞同：3
> 
> 时间：2012-06-01T02:49:27.613
> 
> 标签：javascript, performance, syntax

我现在忘记了在哪里，但我在某个地方读到`for(;;){...}`了和说一样的东西`while(1){...}`。[这个答案](https://stackoverflow.com/questions/4740979/empty-for-loop-for)证实了这是真的，并解释了为什么会`for(;;)`起作用。但是，它没有详细说明它为什么有用，而且我似乎找不到空`for`循环而不是循环的任何基准`while`。

它相当令人困惑（尽管公认非常聪明），但它*更*短。Google 的 Closure Compiler 转换`while(true)`为空的 for 循环，所以一定是有原因的。

**tl；博士**：为什么我应该在循环上使用空的 for`while(1)`循环？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-01T02:51:02.773

打字更短。这真的是唯一的原因。很多人都是这样编程长大的，这是一个习惯问题。

我依稀记得有一个时间和语言`for(;;)`更快。但这在过去大体上都是过去的，现在有任何半体面的优化编译器/解释器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T02:59:47.340

它稍微更惯用，大概是因为它的打字时间更短，而且在那个时代，它比代码可读性更重要。我读过的软件工程书籍`for(;;)`比 更容易跳出意味着“无限循环” `while(1)`，所以如果这是一个约定，最好坚持下去。不过，这绝不是一个强大的约定，它们在我能想到的任何方面在技术上都是等效的。

# java - 另一个 Android Activity 还是一个迭代的 JAVA 方法？

> ID：10843791
> 
> 赞同：0
> 
> 时间：2012-06-01T02:49:28.487
> 
> 标签：java, android, android-activity

我是 Android 应用程序开发的新手，正在尝试找到一种方法来处理一系列接受用户输入的屏幕。我正在制作一个小型数学游戏，用户将在其中回答基本的两个整数加法问题。至此主菜单创建完成。它有一个新游戏按钮，可以启动我的 GameActivity，它对于一个数学问题运行得很好。但是，在用户输入他们对简单数学问题的答案后，一旦用户回答了当前问题并且该方法将返回正确/不正确的值，我希望能够继续处理另一个数学问题。最初我想在 GameActivity 中做一个基本的 FOR 循环：

```
 for(int i = 0; i < 10; i++){ gameMethod(); } 
```

gameMethod() 是一种 JAVA 方法，它简单地生成 2 个随机数，将它们相加以获得正确答案，然后使用 EditText 字段提示用户输入他们的猜测。它使用在 XML 布局文件中创建的 TextView 框显示随机数和答案。

至少我认为，每次调用 gameMethod 都会将随机数字重新输入到每次迭代时屏幕上显示的 TextView 字段中。我真的不在乎以前的数字是什么，所以我想我会覆盖它们。不过，我无法获得执行此操作的代码。我输入一两个 Log.d() 语句，发现 FOR 循环实际上正确运行了 10 次，但它在触发下一个 gameMethod() 之前没有等待用户输入。

在环顾四周时，我发现了 startActivityForResult() 并想知道这是否是一种更合适的方法。因此，通过这种方式，我预见到有三个活动，主菜单调用 GameActivity 然后迭代，比如说 10 次，每次迭代调用另一个活动 GameScreenActivity，它实际上会将数字放在屏幕上，读取用户输入和然后返回 1 表示正确答案，返回 0 表示错误答案。到目前为止，在阅读 StarActivityForResult() 时，我对这个过程感到有些困惑，并想知道这是否是一条可行的探索之路。

同样，我对这个 Android 编程非常陌生，并且感谢我能得到的任何和所有帮助。

谢谢你。

很抱歉最初没有包含 gameMethod()，我在下面添加了它。

```
// Create and initialize arrays of integers
    int[] a = {0,1,2,3,4,5,6,7,8,9,10};
    int[] b = {0,1,2,3,4,5,6,7,8,9,10};

    // Creates random number generator
    Random randy = new Random();

    // Generates two random values to add
    int r1 = randy.nextInt(10);
    int r2 = randy.nextInt(10);

    // Calculates correct answer
    int an = a[r1] + a[r2]; 

    // Displays 1st number
    TextView number1 = (TextView) findViewById(R.id.firstNumber);
    number1.setText(Integer.toString(a[r1]));

    // Displays 2nd number 
    TextView number2 = (TextView) findViewById(R.id.secondNumber);
    number2.setText(Integer.toString(b[r2]));

    // Displays correct answer 
    TextView answer1 = (TextView) findViewById(R.id.answerNumber);

    //hide answer until user puts in theirs
    answer1.setVisibility(View.INVISIBLE);
    answer1.setText(Integer.toString(an));

    //hide the answer place holder value
    TextView uAnswerDisplay = (TextView) findViewById(R.id.userAnswerNumber);
    uAnswerDisplay.setVisibility(View.INVISIBLE);

    //Get the EditText field that the user will input their answer to
    EditText inputText = (EditText) findViewById(R.id.userInput);

    //set up a listener to run once the ENTER key is hit after their answer has been entered
    inputText.setOnKeyListener(new EditText.OnKeyListener(){
        public boolean onKey(View v, int keyCode, KeyEvent event){

    //only go on the ENTER key when pressed DOWN
    if((event.getAction() == KeyEvent.ACTION_DOWN) &&
          (keyCode ==  KeyEvent.KEYCODE_ENTER)){

    EditText innerInputText = (EditText) findViewById(R.id.userInput); //get the EditText box reference
                TextView innerUAnswerDisplay = (TextView) findViewById(R.id.userAnswerNumber); //get the TextView box that the answer will go in
                String inputString = innerInputText.getText().toString(); //capture the user's input

                int uAnswer = Integer.parseInt(inputString); //parse user answer to an integer
                int cAnswer = Integer.parseInt((((TextView) findViewById(R.id.answerNumber)).getText()).toString());
                innerUAnswerDisplay.setText(Integer.toString(uAnswer)); //display the string after converting from integer

                //change colors of text based on correctness
                if (uAnswer == cAnswer){ innerUAnswerDisplay.setTextColor(Color.GREEN); } //green for correct
                else { innerUAnswerDisplay.setTextColor(Color.RED); } //red for incorrect

                innerUAnswerDisplay.setVisibility(View.VISIBLE); //make the user input answer visible

                TextView innerAnswer1 = (TextView) findViewById(R.id.answerNumber);
                innerAnswer1.setVisibility(View.VISIBLE); //hide answer until user puts in theirs
            } //end of if
            return false; //return false 
        } //end of onKey

    }); //end of setOnKeyListener 
```

抱歉所有的编辑，我无法让编辑包含代码并正确发布，所以我把它分成几块，一次添加一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:46:54.447

根据您的说法，我会考虑两种让用户回答问题的方法：

1.  在触发新循环的输入 EditText 上有一个 onclick 侦听器；
2.  有一个在循环开始时开始的对话活动，提示用户输入新答案，您的游戏活动将通过其 onActivityResult 接收答案。

# entity-framework-4 - 如何让asp.net成员提供者和实体框架共享同一个数据库

> ID：10843793
> 
> 赞同：0
> 
> 时间：2012-06-01T02:49:43.007
> 
> 标签：entity-framework-4, asp.net-membership, sql-server-ce

我有一个干净的 MVC 3 项目，并为安全帐户使用 SqlCe 成员资格提供程序。

当我在连接字符串中指定成员资格提供程序和实体框架使用相同的“数据库”时，我会在 EF Code First 模型中得到一个未找到表的错误

```
<connectionStrings>
    <add name="DefaultConnection" connectionString="Data Source=|DataDirectory|db.sdf" providerName="System.Data.SqlServerCE.4.0" />
    <add name="SqlDbContext" connectionString="Data Source=|DataDirectory|db.sdf" providerName="System.Data.SqlServerCE.4.0" />
  </connectionStrings> 
```

但是，如果我指定不同的数据库名称，那么我会完美地工作 - 尽管它会创建两个单独的 SDF 文件。以下连接字符串有效：

```
<connectionStrings>
    <add name="DefaultConnection" connectionString="Data Source=|DataDirectory|aspnet.sdf" providerName="System.Data.SqlServerCE.4.0" />
    <add name="SqlDbContext" connectionString="Data Source=|DataDirectory|db.sdf" providerName="System.Data.SqlServerCE.4.0" />
  </connectionStrings> 
```

为什么它只在我指定两个单独的 SDF 表时才有效？以及如何将单个 SDF 数据库用于会员提供者和 ef 模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T10:28:02.547

您的问题的原因是用于表创建的代码优先内部逻辑。除 EF 5.0 RC 之外的所有版本都将仅与数据库一起创建表。如果数据库存在并且您没有使用能够删除数据库的初始化策略，则不会创建您的表。反过来，如果您使用删除数据库的策略，您将丢失您的成员表。

您可以创建[自定义数据库初始化程序](http://blogs.microsoft.co.il/blogs/gilf/archive/2011/05/30/creating-a-code-first-database-initializer-strategy.aspx)，在现有数据库中创建表，或者自定义数据库初始化程序将执行 DDL 脚本以在 Seed 方法中创建成员表，或者您可以尝试[EF 5.0 RC](http://blogs.msdn.com/b/adonet/archive/2012/05/15/ef5-release-candidate-available-on-nuget.aspx)，它应该能够在现有数据库中创建表盒子。

或者，您也可以让代码先创建数据库，然后手动添加成员表，但每次您让代码先重新创建数据库（不使用迁移时）时，它都会删除您的成员表，您必须再次手动添加它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-05T15:51:29.173

我正在为我正在开发的网站滚动我自己的会员/角色/个人资料管理员并遇到了这个问题。这个问题我有点晚了，但如果你还在研究这个问题，这个链接应该会对你有所帮助：http: [//imar.spaanjaars.com/563/using-entity-framework-code-first-and-aspnet -会员-在一起](http://imar.spaanjaars.com/563/using-entity-framework-code-first-and-aspnet-membership-together)

高温高压

# wcf - 在自定义 userNamePasswordValidationMode 方法中授权用户后如何使用 PrincipalPermission 属性？

> ID：10843796
> 
> 赞同：1
> 
> 时间：2012-06-01T02:49:53.417
> 
> 标签：wcf

我有一个 WCF REST 服务，它*成功*调用自定义方法来验证客户端使用基本身份验证发送的凭据。像这样的配置：

```
 <userNameAuthentication userNamePasswordValidationMode="Custom"
 customUserNamePasswordValidatorType="RESTfulSecuritySH.CustomUserNameValidator,
 RESTfulSecuritySH" /> 
```

现在，在调用该方法后，我的用户得到了验证，并且以下*内容*填充了所有用户的信息 *：

```
Thread.CurrentPrincipal.Identity 
```

然而，一旦这个方法完成并且控制传递给*最初请求的 RESTful 方法*（即 GetData 或其他方法），`Thread.CurrentPrincipal.Identity`则不会填充 in 中的值。因为它*没有*被填充，所以我不能随意使用`[PrincipalPermission]`方法上的任何属性。

但是填充了我`OperationContext.Current.ServiceSecurityContext.PrimaryIdentity` *的*用户的凭据信息（名称，IsAuthenticated），但这似乎没有映射到`Thread.CurrentPrincipal.Identity`属性`[PrincipalPermission]`。我知道我可以在 in 代码中四处`ServiceSecurityContext`寻找来确定用户是否被授权，但如果可能的话，我想在方法上使用一个属性。

因此，如果我应用任何`[PrincipalPermission]`属性，它总是会失败并显示消息：**“请求主体权限失败。”** 这是有道理的，因为`Thread.CurrentPrincipal.Identity`不再有人居住。我的猜测是在对我的自定义`Validate`方法的调用完成后，线程丢失了它的上下文。

无论如何，我的总体问题是`[PrincipalPermission]`在调用 customUserNamePasswordValidatorType 方法后可以以某种方式使用吗？

# iphone - UINavigationBar 未显示在模态视图中

> ID：10843797
> 
> 赞同：0
> 
> 时间：2012-06-01T02:49:55.580
> 
> 标签：iphone, uistoryboard

我有一个如图所示的故事板： ![在此处输入图像描述](../Images/91d1ac0d263ecec62b0e106b2b951ba4.png)

从表格视图单元格中，我模态地展示了一个新的视图控制器，它是 UITableViewController 的子类。在 RHS 的场景中，我有一个 UINavigationBar。但是当我的观点被提出时，它没有。这是为什么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T03:34:47.453

您需要将您希望以模态方式呈现在 UINavigationController 中的 UITableViewController 的子类嵌入。

为此，请单击您想要在 Storyboard 中以模态方式呈现的视图，然后转到 Editor>Embed In>Navigation Controller。

# mysql - MYSQL - 引用多个表的一列

> ID：10843800
> 
> 赞同：5
> 
> 时间：2012-06-01T02:50:13.510
> 
> 标签：mysql, sql, database-design, data-modeling, referential-integrity

表中的单个列可以引用到多个表吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2018-07-15T15:17:39.467

一个很晚的答案，但对于任何想知道和谷歌搜索的人。

**是**的，这可以做到，但这**不是**一个好的做法，即使它很简单，如果你不是很清楚自己在做什么，它可能会*在你的脸上炸开。*不建议。

但是，我可以看到用途。例如，您有一个包含数百万条记录的大表，并且您希望在特殊情况下链接到未知或多个表（在这种情况下最好是*many*）。对于多个表，如果您为所有表创建一个外键，那么您的数据库大小将是一个巨大的膨胀。例如，在技术支持系统中可能存在未知表，您希望链接到可能存在问题的表中的记录，这可能是（几乎）数据库中的所有表，包括未来的表。

当然，您将需要**两个**字段来链接：一个外键字段和它链接到的表的名称。让我们打电话给`foreignId`他们`linkedTable`

`linkedTable`可以是枚举或字符串，最好是枚举（更少的空间），但这只有在您要链接到的不同表是固定的情况下才有可能。

让我们举一个非常愚蠢的例子。您有一个巨大的用户表`users`，其中一些用户可以将**一**组个人数据添加到他们的个人资料中。这可以是关于爱好、宠物、他们从事的运动*或*他们的职业。现在，此信息在所有四种情况下都不同。（实际上 4 个可能的表*不足以*证明这种结构的合理性）

现在假设`linkedTable`是一个具有可能值`pets`、和的枚举`hobbies`，它们是四个不同结构表的名称。假设是所有四个中的 pkey。`sports``professions``id`

例如，您加入如下：

```
SELECT * FROM users 
    LEFT JOIN  pets        ON linkedTable = 'pets'        AND foreignId = pets.id
    LEFT JOIN  hobbies     ON linkedTable = 'hobbies'     AND foreignId = hobbies.id
    LEFT JOIN  sports      ON linkedTable = 'sports'      AND foreignId = sports.id
    LEFT JOIN  professions ON linkedTable = 'professions' AND foreignId = professions.id 
```

这只是开个基本的玩笑。由于您可能只在极少数情况下需要链接，因此当您循环访问用户（没有加入）时，您更有可能使用您的编程语言（如 PHP）进行查找。

想试试吗？您可以自己尝试构建此测试数据库（确保使用测试数据库）：

```
CREATE TABLE IF NOT EXISTS `users` (
    `id` INT NOT NULL AUTO_INCREMENT , 
    `name` VARCHAR(100) NOT NULL , 
    `linkedTable` ENUM('pets','hobbies','sports','professions') NULL DEFAULT NULL , 
    `foreignId` INT NULL DEFAULT NULL , 
  PRIMARY KEY (`id`), INDEX (`linkedTable`)
) ;

CREATE TABLE  IF NOT EXISTS `pets` ( 
    `id` INT NOT NULL AUTO_INCREMENT , 
    `animalTypeId` INT NOT NULL , 
    `name` VARCHAR(100) NOT NULL , 
    `colorId` INT NOT NULL , 
  PRIMARY KEY (`id`), INDEX (`animalTypeId`), INDEX (`colorId`)
) ;

CREATE TABLE  IF NOT EXISTS `hobbies` ( 
    `id` INT NOT NULL AUTO_INCREMENT , 
    `hobbyTypeId` INT NOT NULL , 
    `hoursPerWeekSpend` INT NOT NULL , 
    `websiteUrl` VARCHAR(300) NULL , 
  PRIMARY KEY (`id`), INDEX (`hobbyTypeId`)
) ;

CREATE TABLE  IF NOT EXISTS `sports` ( 
    `id` INT NOT NULL AUTO_INCREMENT , 
    `sportTypeId` INT NOT NULL , 
    `hoursPerWeekSpend` INT NOT NULL , 
    `nameClub` VARCHAR(100) NULL , 
    `professional` TINYINT NOT NULL DEFAULT 0, 
  PRIMARY KEY (`id`), INDEX (`sportTypeId`)
) ;

CREATE TABLE  IF NOT EXISTS `professions` ( 
    `id` INT NOT NULL AUTO_INCREMENT , 
    `professionId` INT NOT NULL , 
    `hoursPerWeek` INT NOT NULL , 
    `nameCompany` VARCHAR(100) NULL , 
    `jobDescription` VARCHAR(400) NULL, 
  PRIMARY KEY (`id`), INDEX (`professionId`)
) ;

INSERT INTO `users` (`id`, `name`, `linkedTable`, `foreignId`) 
   VALUES 
   (NULL, 'Hank', 'pets', '1'), 
   (NULL, 'Peter', 'hobbies', '2'), 
   (NULL, 'Muhammed', 'professions', '1'), 
   (NULL, 'Clarice', NULL, NULL), 
   (NULL, 'Miryam', 'professions', '2'), 
   (NULL, 'Ming-Lee', 'hobbies', '1'), 
   (NULL, 'Drakan', NULL, NULL), 
   (NULL, 'Gertrude', 'sports', '2'), 
   (NULL, 'Mbase', NULL, NULL);

INSERT INTO `pets` (`id`, `animalTypeId`, `name`, `colorId`) 
VALUES (NULL, '1', 'Mimi', '3'), (NULL, '2', 'Tiger', '8');

INSERT INTO `hobbies` (`id`, `hobbyTypeId`, `hoursPerWeekSpend`, `websiteUrl`) 
VALUES (NULL, '123', '21', NULL), (NULL, '2', '1', 'http://www.freesoup.org');

INSERT INTO `sports` (`id`, `sportTypeId`, `hoursPerWeekSpend`, `nameClub`, `professional`) 
VALUES (NULL, '2', '3', 'Racket to Racket', '0'), (NULL, '12', '34', NULL, '1');

INSERT INTO `professions` (`id`, `professionId`, `hoursPerWeek`, `nameCompany`, `jobDescription`) 
VALUES (NULL, '275', '40', 'Ben & Jerry\'s', 'Ice cream designer'), (NULL, '21', '24', 'City of Dublin', 'Garbage collector'); 
```

然后运行第一个查询。

有趣的讨论笔记：你会如何*索引*这个？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:07:34.137

如果您的意思是“一个表中的列可以用作多个表中的外键”，那么答案是**YES**。这是关系数据库的重点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T03:18:01.723

是的，你可以这样做。这是有关如何执行此操作的示例：

这是具有将由多个表引用的列（CountryID）的表：

```
CREATE TABLE DLAccountingSystem.tblCountry
(
    CountryID       INT             AUTO_INCREMENT NOT NULL PRIMARY KEY,
    CountryName     VARCHAR(128)    NOT NULL,
    LastEditUser    VARCHAR(128)    NOT NULL,
    LastEditDate    DATETIME        NOT NULL
) ENGINE=INNODB; 
```

以下是要引用列（CountryID）的表：

```
CREATE TABLE DLAccountingSystem.tblCity
(
    CityID          INT             AUTO_INCREMENT NOT NULL PRIMARY KEY,
    CountryID       INT             NOT NULL,
    CityName        VARCHAR(128)    NOT NULL,
    LastEditUser    VARCHAR(128)    NOT NULL,
    LastEditDate    DATETIME        NOT NULL
) ENGINE=INNODB;

CREATE TABLE DLAccountingSystem.tblProvince
(
    ProvinceID      INT             AUTO_INCREMENT NOT NULL PRIMARY KEY,
    CountryID       INT             NOT NULL,
    ProvinceName    VARCHAR(128)    NOT NULL,
    LastEditUser    VARCHAR(128)    NOT NULL,
    LastEditDate    DATETIME        NOT NULL
) ENGINE=INNODB; 
```

以下是创建对列的引用的方法：

```
 ALTER TABLE DLAccountingSystem.tblCity
 ADD CONSTRAINT fk_tblcitycountryid FOREIGN KEY CountryID (CountryID)
 REFERENCES DLAccountingSystem.tblCountry (CountryID)
 ON DELETE NO ACTION
 ON UPDATE NO ACTION

 ALTER TABLE DLAccountingSystem.tblProvince
 ADD CONSTRAINT fk_tblprovincecountryid FOREIGN KEY CountryID (CountryID)
 REFERENCES DLAccountingSystem.tblCountry (CountryID)
 ON DELETE NO ACTION
 ON UPDATE NO ACTION 
```

这是一个表，其中的列引用了（CountryID，ProvinceID，CityID）多个表中的不同列（我个人不建议这种表结构方式。只是我的意见没有冒犯；））

```
CREATE TABLE DLAccountingSystem.tblPersons
(
    PersonID       INT          AUTO_INCREMENT NOT NULL PRIMARY KEY,
    PlaceID        INT          NOT NULL,
    PlaceTypeID    INT          NOT NULL, -- this property refers to what table are you referencing.
 //Other properties here.....
) ENGINE=INNODB; 
```

您还应该有一个包含 PlaceType 的查找表：

```
CREATE TABLE DLAccountingSystem.tblPlaceType
(
    PlaceTypeID       INT          AUTO_INCREMENT NOT NULL PRIMARY KEY,
    PlaceTypeName        INT          NOT NULL
 //Other properties here.....
) ENGINE=INNODB; 
```

这是您获取它的方式：

```
SELECT p1.PersonID,
       tcity.CityName,
       tprov.ProvinceName,
       tcoun.CountryName
FROM DLAccountingSystem.tblPersons p1 
LEFT JOIN (SELECT p2.PersonID, p2.PlaceTypeID, c.CityName FROM DLAccountingSystem.tblPersons p2 INNER JOIN DLAccountingSystem.tblCity c ON p2.ObjectID = c.CityID WHERE PlaceTypeID = @CityTypeID) tcity ON p1.PersonID = tcity.PersonID
LEFT JOIN (SELECT p2.PersonID, p2.PlaceTypeID, c.ProvinceName FROM DLAccountingSystem.tblPersons p2 INNER JOIN DLAccountingSystem.tblProvince c ON p2.ObjectID = c.ProvinceID WHERE PlaceTypeID = @ProvinceTypeID) tprov ON p1.PersonID = tprov.PersonID
LEFT JOIN (SELECT p2.PersonID, p2.PlaceTypeID, c.CountryName FROM DLAccountingSystem.tblPersons p2 INNER JOIN DLAccountingSystem.tblCountry c ON p2.ObjectID = c.CountryID WHERE PlaceTypeID = @CountryTypeID) tcoun ON p1.PersonID = tcoun.PersonID 
```

您可以从其他表格中进行选择，例如

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T09:56:00.427

同一列或一组列可以充当一个或多个外键的父端点和/或子端点。

# css - CSS div 框宽度

> ID：10843802
> 
> 赞同：0
> 
> 时间：2012-06-01T02:50:27.997
> 
> 标签：css, layout

目前我有这个：

![在此处输入图像描述](../Images/8d0b4ae26f81035eb302842bdf632003.png)

我的问题是黑色边框`.textMessage`需要与`.alertMessage`宽度上方的框对齐。我已经尽一切努力让它对齐。

**HTML：**

```
<div class="scheduledCenter">
    <p class ="alertMessage"><span class="bold">Important:</span> Your Account is set to Pacific/Auckland Time.  The Time is now <span class="bold">9:30AM</span> on <span class="bold">29th May 2012</span></p> <span class="close"></span>
    <div class="userInformation">
        <span class="userImage"><img src="_assets/images/ava.png" width="46" height="45" alt="Ava"></span>
        <span class="bold">FROM:</span>
        <p class="userDetails">123456789XXX</p>
    </div>
    <div class="textMessage">
        <div class="innerBar">
            <div class="innerTo">
                <form action="#" method="get">
                    <label for="recipients">TO: </label><input type="search" name="recipients" id="recipients" placeholder="Recipients Names">
                </form>
            </div>
            <div class="innerReplies">
                <form action="#" method="get">
                    <label for="replies">Replies: </label><p class="forward">Forward to | 0212133263</p><input type="search" name="replies" id="replies" placeholder="filename.png">
                </form>
            </div>
        </div>
    </div>
</div> 
```

**CSS：**

```
.scheduledCenter{
    width:100%;
    min-height:100%;
    padding:10px 0px 0 0px;
}
.scheduledCenter .alertMessage{
    width:100%;
    height:15px;
    color:#3385B2;
    background: #D1DEE8 url('../images/close.png') no-repeat 99% 8px;
    border:3px solid #8099B4;
    border-radius:3px;
    padding:5px;
}
.scheduledCenter .alertMessage .bold{
    font-weight:bold;
}
.scheduledCenter .userInformation{
    float:left;
    width:50px;
    height:100%;
    min-height:100%;
    margin:10px 15px 0 0;
}
.scheduledCenter .userInformation .bold{
    font-weight:bold;
}
.scheduledCenter .userInformation .userDetails{
    padding:10px 0 0 0;
}
.scheduledCenter .userInformation .userImage img{
    margin:0 0 10px 0;
}
.textMessage {
    margin:0 0 0 90px;
    position: relative;
    background: #FFF;
    border: 5px solid #000;
}
.textMessage:after, textMessage:before {
    right: 100%;
    border: solid transparent;
    content: " ";
    height: 0;
    width: 0;
    position: absolute;
    pointer-events: none;
}

.textMessage:after {
    border-right-color: #FFF;
    border-width: 10px;
    top: 50%;
    margin-top: -10px;
}
.textMessage:before {
    border-right-color: #000;
    border-width: 17px;
    top: 50%;
    margin-top: -17px;
}
.innerBar{
    width:100%;
    height:60px;
    background-color:#F5F5F5;
}
.innerBar .innerTo{
    width:200px;
    padding:5px 0 0 15px;
    display:block;
    float:left;
}
.innerBar .innerTo label{
    margin:0 15px 0 0;
    font-size:14px;
    font-weight:bold;
    color:#666666;
}
.innerBar .innerTo input[type=search] {
    color: red;
}
.innerBar .innerReplies{
    width:150px;
    padding:5px 0 0 15px;
    background:purple;
    display:block;
    float:right;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:26:03.193

删除选择器`width: 100%;`中的声明`.selectedCenter .alertMessage`。
[这是您想要的代码版本。](http://jsfiddle.net/AcJ67/1/)

* * *

**解释：**

由于您将其宽度设置为 100% 的元素已经是块级元素，它会自动占据其容器的整个宽度，但通过将其宽度设置为 100%，它不会占用执行此操作时将其边距/填充/边框考虑在内，因此，将这些属性中的任何一个设置为 >1，额外的宽度将从其父级突出。

```
.scheduledCenter .alertMessage {
    background: url("../images/close.png") no-repeat scroll 99% 8px #D1DEE8;
    border: 3px solid #8099B4;
    border-radius: 3px 3px 3px 3px;
    color: #3385B2;
    height: 15px;
    padding: 5px;
    /* width: 100%; <-- This is what's causing the problem */
} 
```

# cakephp - CakePHP 控制器中的 json 响应

> ID：10843803
> 
> 赞同：1
> 
> 时间：2012-06-01T02:50:28.197
> 
> 标签：cakephp, response

我的代码看起来像这样：

```
if ($this->request->is('ajax')) {
    $this->Comment->Save();
    $this->set('comment', $this->Comment->read());
    $this->set('_serialize', array('comment');
} 
```

我没有使用 Ajax 响应，而是收到一个视图丢失的错误。还有其他需要用json响应的东西吗？我认为这是使用响应助手“自动”处理的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:33:45.203

```
By enabling RequestHandlerComponent in your application, and enabling support for the xml 
and or json extensions, you can automatically leverage the new view classes. 
```

所以你仍然需要启用一些东西：

添加

```
public $components = array('RequestHandler'); 
```

并在 routes.php

```
Router::parseExtensions(array('json')); 
```

你可能必须让你的 url 看起来像 controller/action.json 才能让 automagic 工作。不过，您可以在控制器中添加 $this->viewClass = 'Json' （不是 100% 确定）。

# javascript - 为什么不能使用 const 关键字来分配 JavaScript 对象的常量属性？

> ID：10843809
> 
> 赞同：2
> 
> 时间：2012-06-01T02:51:10.390
> 
> 标签：javascript, object, properties, constants, variable-assignment

首先，我问是否有可能：[如何使用 const 关键字创建 Javascript 常量作为对象的属性？](https://stackoverflow.com/questions/10843572/how-to-create-javascript-constants-as-properties-of-objects-using-const-keyword)

现在，我要问：为什么？我的答案似乎是“只是因为”，但这样做会非常有用：

```
var App = {};  // want to be able to extend
const App.goldenRatio= 1.6180339887  // throws Exception 
```

为什么在激活对象上设置的常量可以工作，但在设置时却不能在任何其他对象上设置？

如果可能，会造成什么样的损害？

`const`如果不是为了防止公共 API 被更改，那么这样做的目的是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T03:30:13.470

如果您想在现代浏览器中使用不可更改的值，请使用[`defineProperty`](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Object/defineProperty)创建不可写（也称为只读）属性：

```
var App = {};
Object.defineProperty(App,'goldenRatio',{value:1.6180339887});
console.log( App.goldenRatio ); // 1.6180339887
App.goldenRatio = 42;
console.log( App.goldenRatio ); // 1.6180339887
delete App.goldenRatio;         // false
console.log( App.goldenRatio ); // 1.6180339887 
```

*如果您不`writable:true`将选项传递给`defineProperty`它，则默认为`false`，因此会默默地忽略您尝试对该属性进行的任何更改。此外，如果您不通过`configurable:true`，则默认为`false`并且您可能不会删除该属性。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-19T18:04:38.997

`const`除了支持和不支持跨浏览器的事实（它是 ES6 功能）之外，`const App.goldenRatio= 1.6180339887`由于相同的原因`var App.goldenRatio= 1.6180339887`不起作用：您正在设置一个对象属性，所以在它前面加上一个`var`或是一个语法错误`const`关键词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T03:10:40.423

var MY_CONSTANT = "一些值"; 您可以使用 ALL_CAPS 之类的约定来表明不应修改某些值

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T03:12:20.250

将回答您要问的问题并说 never use `const`。解释器对它不做任何事情。它所做的只是误导开发人员认为他/她可以假设值永远不会改变，这与`const`关键字不存在的可能性差不多。

# c# - 尝试从名称匹配\包含特定字符串的单个目录中删除多个文件

> ID：10843810
> 
> 赞同：0
> 
> 时间：2012-06-01T02:51:12.597
> 
> 标签：c#, asp.net

我想删除图像文件。文件被命名为`somefile.jpg`和`somefile_t.jpg`，最后带有 的文件`_t`是缩略图。通过此删除操作，我希望删除缩略图和原始图像。

代码一直运行到`foreach`循环，该`GetFiles`方法不返回任何内容。string.Substring 操作成功地只返回没有扩展名的文件名，也没有`_t`eg: `somefile`。

我要删除的文件名中没有无效字符。代码对我来说看起来不错，我唯一能想到的就是我没有正确使用 searchpattern 函数。

```
filesource = "~/somedir/somefile_t.jpg" 
```

* * *

```
var dir = Server.MapPath(filesource);

            FileInfo FileToDelete = new FileInfo(dir);

            if (FileToDelete.Exists) 
            { 
                var FileName = Path.GetFileNameWithoutExtension(FileToDelete.Name);

                foreach(FileInfo file in FileToDelete.Directory.GetFiles(FileName.Substring(0, FileName.Length - 2), SearchOption.TopDirectoryOnly).ToList())
               {
                   file.Delete();
               }

            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:14:47.893

[DirectoryInfo.GetFiles 方法（字符串，SearchOption）](http://msdn.microsoft.com/en-us/library/ms143327.aspx)

您需要确保第一个参数*searchPattern*是正确的。在您的情况下，您正在提供`FileName.Substring(0, FileName.Length - 2)`，这将是**"somefile"**。该方法不返回任何内容的原因是因为您正在查找名称为 somefile 的文件。您的意思是在基本文件名之外使用通配符：`String.Concat(FileName.Substring(0, FileName.Length - 2), "*")`，这将是**"somefile*"** ...至少我认为您正在寻找该*searchPattern*而不是任何其他人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T03:24:10.587

这段代码对我有用：

```
 var file_path = @"K:\Work\IoCToy\IoCToy\image.jpg";
        var dir = Path.GetDirectoryName(file_path);
        var fileNameWithoutExtension = Path.GetFileNameWithoutExtension(file_path);
        var files = Directory.EnumerateFiles(dir, string.Format("{0}*", fileNameWithoutExtension), SearchOption.TopDirectoryOnly); 
```

当然，您必须通过返回的文件名删除文件。我在这里假设您的文件夹仅包含以“图像”子字符串开头的图像和缩略图文件。

# .net - IIS .Net HttpModule 高级日志记录字段

> ID：10843811
> 
> 赞同：3
> 
> 时间：2012-06-01T02:51:15.927
> 
> 标签：.net, iis, logging, iis-7, httpmodule

我正在尝试找到一种方法来记录用于匹配来自 MVC3 的路由的正则表达式（即`/api/person/{personid}/address/{addressid}`）

我发现您可以使用它来在 IIS 日志中的**cs-uri-query**`HttpResponse.AppendToLog`上附加一些内容，但这非常棘手，并且使处理日志成为一个 pita。这导致我使用IIS7 高级日志记录。**`HttpModules`**

 **我目前的理解是，我可以从`HttpModule`. 所以我应该能够在 中查找 Route 对象使用的正则表达式，`HttpContext`并将其公开为 Advanced Logging 可以使用和记录的字段。

**我的问题是我在弄清楚如何将数据公开为`HttpModule`高级日志记录可以使用的自定义字段时遇到问题。**

我需要有一个事件处理程序`LogRequest`吗？如果我这样做，我应该在事件处理程序中做什么以使其可用于高级日志记录？

任何指针、代码示例和/或文档链接将不胜感激。

顺便说一句，如果您知道任何解释/列出 IIS7 中安装的默认模块中可用的“已发布”字段的文档，我将不胜感激链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T20:54:05.663

好的，我最终处理这个问题的方法是创建一个`HttpModule`将从 中提取路由模式`HttpContext`并作为`URL_PATTERN`.

一旦它在`server_variables`IIS7 中高级日志记录可以得到它并保存它。如果当前请求没有路由，它将只使用 url 的正常本地部分（因此它将匹配日志中的**cs-uri-stem**）。

**现在 sql/log 解析查询：**

```
select url_pattern,count(url_pattern) from (yourlogs) where timestamp between (start/end) group by url_pattern order by count(url_pattern) desc 
```

会给我返回我的应用程序中每个端点的命中数。

这显然可以在 fubu 一种行为中完成，但我们有一堆经典的 asp 和 MVC3 运行（*我知道我知道......*），这将处理所有这些。

此外，您显然可以使用`RaiseTraceEvent`IIS7 高级日志记录从模块中“发布”一个字段，然后可以使用它，但它让我很想弄清楚它，所以我只是用我所拥有的。

我已经在所有地方发布了这个问题，引用了 fubu 和 MVC3，但我几乎没有兴趣，这真的让我感到惊讶。如果您无法轻松确定正在使用的路线，人们如何在他们的日志中查找信息。

[https://gist.github.com/2854760](https://gist.github.com/2854760)

我就把这个留在这里....还有几个 unanwsered 部分，所以我会离开这个帖子，但不要将它标记为 anwser。**

# android - 这个 Android sqlite 插入有什么问题？

> ID：10843815
> 
> 赞同：-1
> 
> 时间：2012-06-01T02:51:18.620
> 
> 标签：android, database, sqlite, initialization

这是我在 Dbadatper 的 oncreate 方法中创建的表

```
String CREATE_EXERCISES_TABLE = "CREATE TABLE IF NOT EXISTS " + TABLE_EXERCISES+"("
        + KEY_ROWID + " INTEGER PRIMARY KEY, " 
        + KEY_EXER_NAME + " TEXT, "
        + KEY_DEFAULTMANWEIGHT + " INTEGER, "
        + KEY_DEFAULTWOMANWEIGHT + " INTEGER, "
        + KEY_WEIGHTS_FILT + " INTEGER, "
        + KEY_OLYMPIC_FILT + " INTEGER, "
        + KEY_EQUIPNEED_FILT + " INTEGER, "
        + KEY_UPPERBODY_FILT + " INTEGER, "
        + KEY_LOWERBODY_FILT + " INTEGER, "
        + KEY_LARGEAREA_FILT + " INTEGER);";
db.execSQL(CREATE_EXERCISES_TABLE); 
```

这是我插入练习的插入代码

```
public void addExercise(Exercise exer) {
    SQLiteDatabase db = this.open();

    ContentValues values = new ContentValues();
    values.put(KEY_EXER_NAME, exer.getName()); 
    values.put(KEY_DEFAULTMANWEIGHT, exer.getDefaultManWeight());
    values.put(KEY_DEFAULTWOMANWEIGHT, exer.getDefaultWomanWeight());
    values.put(KEY_WEIGHTS_FILT, exer.getWeightFilt());
    values.put(KEY_OLYMPIC_FILT, exer.getOlympicFilt()); 
    values.put(KEY_EQUIPNEED_FILT, exer.getEquipFilt()); 
    values.put(KEY_UPPERBODY_FILT, exer.getUpperBodyFilt()); 
    values.put(KEY_LOWERBODY_FILT, exer.getLowerBodyFilt()); 
    values.put(KEY_LARGEAREA_FILT, exer.getLargeAreaFilt()); 

    // Inserting Row
    db.insert(TABLE_EXERCISES, null, values);
    db.close(); // Closing database connection
} 
```

这是我的实际插入

```
ExerTable db= new ExerTable(ctx);
Exercise pushups =new Exercise("Pushups",0,0,0,0,0,1,0,1);
db.addExercise(pushups); 
```

我已经为此困扰了很长一段时间，每当我尝试运行它时，我都会收到此错误

```
05-31 19:33:27.107: ERROR/Database(413): Error inserting upperbody_filter=1 olympic_filter=0 default_man_weight=0 default_woman_weight=0 weights_filter=0 lowerbody_filter=0 exername=Pullups large_area_filter=1 equipment_need_filter=1

05-31 19:33:27.107: ERROR/Database(413): android.database.sqlite.SQLiteException: table Exercises has no column named lowerbody_filter: , while compiling: INSERT INTO Exercises(upperbody_filter, olympic_filter, default_man_weight, default_woman_weight, weights_filter, lowerbody_filter, exername, large_area_filter, equipment_need_filter) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:05:40.500

一切对我来说看起来都不错，所以我最好的猜测是您使用的是实际上没有`lowerbody_filter`列的旧版本的数据库。如果您在开发早期创建了没有该列的表，并且没有正确设置模式版本号和`SQLiteOpenHelper.onUpgrade()`，那么您仍将使用旧版本。如果是这种情况，应显示快速卸载/重新安装。如果是这样，那么您的解决方案是确保每次更改架构时始终增加架构版本号，并使用`SQLiteOpenHelper.onUpgrade()`或其他方式确保在必要时始终升级数据库。

# sql-server - SQL Server 中的触发器 - 获取为审计表完成的事务类型

> ID：10843817
> 
> 赞同：0
> 
> 时间：2012-06-01T02:51:22.113
> 
> 标签：sql-server, sql-server-2005, triggers

我正在编写将记录插入`Audit`表中的触发器。

每当我的目标表中的数据发生变化时，触发器都会将旧值、新值更新到审计表

此外，还有一些列称为`Transaction`和`Transaction_Status`

`Transaction`列定义事务的类型。可以是`INSERT`，`UPDATE`或`DELETE`。
`Transaction_Status`列表示`SUCCESS`或`FAILURE`

如何做到这一点？

我的触发器：

```
Alter Trigger TR_test
ON subscribers
FOR UPDATE
AS BEGIN
DECLARE @OldValue xml,@NewValue xml, @changedby varchar(50), @ReferenceId int
-----------------------------------------------------------------------------
SELECT @OldValue=b.username, @NewValue=a.username, 
       @ReferenceId = a.user_id, @changedby = a.modified_by
FROM inserted a, deleted b;
----------------------------------------------------------------------------- 
INSERT INTO [dbo].[audit_log]
           ([old_value],[new_value],[module],[reference_id],[transaction]
           ,[transaction_status],[stack_trace],[modified_on],[modified_by])
     VALUES
(@OldValue,@NewValue,'Subscriber',@ReferenceId,'_transaction',
'_transaction_status','_stack_trace',getdate(),555)

-----------------------------------------------------------------------------
END 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-06-01T02:59:43.247

一旦您修复触发器以涵盖所有三个操作，

```
IF EXISTS (SELECT 1 FROM inserted)
BEGIN
  IF EXISTS (SELECT 1 FROM deleted)
  BEGIN
    SET @action = 'UPDATE';
  END
  ELSE
  BEGIN
    SET @action = 'INSERT';
  END
ELSE
BEGIN
  SET @action = 'DELETE';
END 
```

另一种选择是三个单独的触发器，每个动作一个。

[`MERGE`](https://sqlblog.org/merge)如果您正在使用它，[请小心……或者当您迁移到 SQL Server 2008 或更高版本时，请做好准备。](https://sqlblog.org/merge)

**编辑**

我认为你可能追求的是一个`INSTEAD OF`触发器（多么讽刺）。这是一个例子。让我们考虑一个非常简单的表，其中包含一个 PK 列和一个唯一列：

```
CREATE TABLE dbo.foobar(id INT PRIMARY KEY, x CHAR(1) UNIQUE);
GO 
```

还有一个简单的日志表来捕捉活动：

```
CREATE TABLE dbo.myLog
(
    foobar_id INT, 
    oldValue  XML, 
    newValue  XML, 
    [action]  CHAR(6), 
    success   BIT
);
GO 
```

以下`INSTEAD OF`触发器将拦截`INSERT/UPDATE/DELETE`命令，尝试复制他们将完成的工作，并记录它是失败还是成功：

```
CREATE TRIGGER dbo.foobar_inst
ON dbo.foobar
INSTEAD OF INSERT, UPDATE
AS
BEGIN
  SET NOCOUNT ON;

  DECLARE @action  CHAR(6), @success BIT;

  SELECT @action  = 'DELETE', @success = 1;

  IF EXISTS (SELECT 1 FROM inserted)
  BEGIN
    IF EXISTS (SELECT 1 FROM deleted)
      SET @action = 'UPDATE';
    ELSE
      SET @action = 'INSERT';
  END

  BEGIN TRY
    IF @action = 'INSERT'
      INSERT dbo.foobar(id, x) SELECT id, x FROM inserted;

    IF @action = 'UPDATE'
      UPDATE f SET x = i.x FROM dbo.foobar AS f
        INNER JOIN inserted AS i ON f.id = i.id;

    IF @action = 'DELETE'
        DELETE f FROM dbo.foobar AS f
          INNER JOIN inserted AS i ON f.id = i.id;
  END TRY
  BEGIN CATCH
    ROLLBACK; -- key part here!

    SET @success = 0;
  END CATCH

  IF @action = 'INSERT'
    INSERT dbo.myLog SELECT i.id, NULL, 
      (SELECT * FROM inserted WHERE id = i.id FOR XML PATH),
      @action, @success FROM inserted AS i;

  IF @action = 'UPDATE'
    INSERT dbo.myLog SELECT i.id, 
      (SELECT * FROM deleted  WHERE id = i.id FOR XML PATH),
      (SELECT * FROM inserted WHERE id = i.id FOR XML PATH),
      @action, @success FROM inserted AS i;

  IF @action = 'DELETE'
    INSERT dbo.myLog SELECT d.id, 
      (SELECT * FROM deleted  WHERE id = d.id FOR XML PATH),
      NULL, @action, @success FROM deleted AS d;
END
GO 
```

让我们尝试一些非常简单的隐式事务语句：

```
-- these succeed:

INSERT dbo.foobar SELECT 1, 'x';
GO
INSERT dbo.foobar SELECT 2, 'y';
GO

-- fails with PK violation:

INSERT dbo.foobar SELECT 1, 'z';
GO

-- fails with UQ violation:

UPDATE dbo.foobar SET x = 'y' WHERE id = 1;
GO 
```

检查日志：

```
SELECT foobar_id, oldValue, newValue, action, success FROM dbo.myLog; 
```

结果：

```
foobar_id oldValue                      newValue                      action success
--------- ----------------------------- ----------------------------- ------ -------
1         NULL                          <row><id>1</id><x>x</x></row> INSERT 1
2         NULL                          <row><id>2</id><x>y</x></row> INSERT 1
1         NULL                          <row><id>1</id><x>z</x></row> INSERT 0
1         <row><id>1</id><x>x</x></row> <row><id>1</id><x>y</x></row> UPDATE 0 
```

当然，您可能想要日志表中的其他列，例如用户、日期/时间，甚至可能是原始语句。这并不是一个完全全面的审计解决方案，只是一个例子。

正如 Mikael 指出的那样，这依赖于外部批处理是启动隐式事务的单个命令这一事实。如果外部批次是显式的多语句事务，则必须测试该行为。

另请注意，在 UPDATE 影响零行的情况下，这不会捕获“失败”。因此，您需要明确定义“失败”的含义——在某些情况下，您可能需要在外部代码中构建自己的失败处理，而不是在触发器中。

# android - Android - 加载参数化查询 - 如何正确编码

> ID：10843824
> 
> 赞同：0
> 
> 时间：2012-06-01T02:53:05.880
> 
> 标签：android, sanitization

我使用 XML 文件作为数据库，它从 MySQL 数据库中获取条目。要添加一个新条目，我有一个页面，该页面对名称、日期、位置等进行参数化查询，并将数据输入数据库，前提是信息以正确的格式提供。

例如，我想输入名称，我这样编码：

```
String name = "Mark" // Just for demonstration
String nameEn = URLEncoder.encode(name, "UTF-8"); 
```

这就是我进行初步消毒的方式。为了获得额外的保护，我在之后尝试了这个：

```
UrlQuerySanitizer sanitizer = new UrlQuerySanitizer();
sanitizer.setAllowUnregisteredParamaters(true);
sanitizer.parseUrl(url); //Url being the total url with parameters 
```

但是，有时它只是不插入新行。当我使用逗号或撇号时会发生这种情况，所以我猜它与消毒有关。

我究竟做错了什么？谢谢。

**编辑：更具体**

我有一个 php 文件，它将插入带有参数化查询的数据库条目，如下所示： `www.example.com/newentry.php?name=thename&location=thelocation1`

我想将 url 字符串连接在一起`thename`并`thelocation`（作为输入）进行清理，以便它们在 url 中工作。如果我使用逗号或撇号之类的东西，它无法插入该条目，因为我假设这一点，它没有正确清理那些输入的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T04:00:41.370

你看错地方了。

一个 url 包含`,`or`'`是一个有效的，所以问题必须在您的服务器端。

我猜您使用这些`$_GET["parameter"]`值，因此请确保您`mysql_real_escape_string($_GET["parameter"])`在尝试将这些值插入数据库之前执行必要的操作。

对于更深层次的知识搜索`SQL Injections`。这也可能让你免费偏执：）

# ruby - Facebook Canvas 应用程序在 Internet Explorer 中不起作用

> ID：10843827
> 
> 赞同：0
> 
> 时间：2012-06-01T02:53:31.470
> 
> 标签：ruby, facebook, sinatra, p3p

我正在开发一个使用 Sinatra 用 Ruby 编写并托管在 Heroku 上的 Facebook 画布应用程序。

我将此作为我的代码的一部分：

```
before do
  response.headers['P3P'] = 'CP="We have no P3P policy."' 
end 
```

我已经为此尝试了其他值，包括 CP="HONK" （如 facebook 开发网站上所推荐的那样）。

我的应用程序在 Firefox 和 Chrome 中运行良好，但在 IE 或 Safari 中它的行为非常奇怪。它将无限刷新，刷新一次并停止，或者只是不加载（画布是空的，它是白色的）。有时，或者在某些计算机上，它可以正常工作，但这种情况很少见。

我的页面和 facebook 页面的内容类型值相同。

很可能在授权重定向中重新加载。我使用内置的 sinatra`session[]`来存储一些东西，比如当前用户 ID。我猜这些 cookie 没有被设置，而且我知道如果禁用 3rd 方 cookie，那么我的应用程序将无法正常工作。但是，由于我有 P3P 设置，它应该可以在接受 3rd 方 cookie 的浏览器中运行（我的所有浏览器都设置为这样做）。

我怎样才能让它在 IE 中工作？

编辑：我在根目录中也有一个 channel.html 文件，它`channelUrl : "<%= url_no_scheme('/channel.html') %>"`是我的 FB.init 的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-09T19:04:41.040

可能的修复：

禁用 channel.html 文件？

默认情况下，Facebook 使用 CSS display:none 加载一个空文件并调用 parent.onchanneliframeready()。

看起来这个调用没有完成。

# php - 在php中执行程序

> ID：10843830
> 
> 赞同：3
> 
> 时间：2012-06-01T02:54:24.010
> 
> 标签：php, apache, mobile, lamp

有没有办法在服务器上执行程序，例如：Firefox、Gimp 等。

我的概念是能够在我的手机上登录我的本地 LAMP 服务器，在文本框中输入命令（例如：/usr/bin/firefox）并按下一个按钮，该按钮使用 post 方法将命令字符串发送到另一个在我的服务器上启动程序的 PHP 脚本。这会很好，所以当我在路上并想要启动“firefox [http://www.blahblah.net](http://www.blahblah.net) ”并打开firefox回到我的电脑时。是的，我知道安全问题，但这只是一个概念验证。

我已经尝试了 exec() 和 system() 命令，但它们似乎不起作用....我做错了什么吗？

```
#!/usr/bin/env ruby

require 'rubygems'
require 'sinatra'

disable :protection # not needed on something this simple
set :port, 11111    # think 1APPX

get '/' do
# this handles both apps (via ?app=...) and files (via ?file=...)

if params[:app] then
    # as a side effect, this also happens to actually run the app, which is
    # pretty much what we wanted in the first place
    @fn = params[:app][1..-2];
    `/usr/bin/env #{@fn}`
elsif params[:file] then
    # bugfix, remove quotes...
    @fn = params[:file][1..-2];
    # xdg-open anyone?
    puts "DEBUG /usr/bin/env xdg-open #{@fn}";
    `"/usr/bin/env xdg-open #{@fn}"`
else
    # nothing...
    404
end

end

not_found do
status 404
"Application #{@fn} not found. Usage: /?app=\"[appname]\" or /?file=\"[filename]\""
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T02:57:45.400

不要为此使用 Web 应用程序。安全障碍很多，需要广泛的 Linux 系统管理知识才能实现。

我的建议是为您的手机获取一个 SSH 客户端——它们适用于 Android 和 iOS，并通过 SSH 连接到您的计算机。您还可以为这两个平台获取 VNC 客户端，这样您就可以直接在 GUI 上进行操作，而无需诱使 X11 在您实际上并未查看的显示器上启动应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T03:27:24.123

首先，您应该使用将要登录的用户来运行您的 apache 服务器。接下来，您应该执行：

```
<?php
system("export DISPLAY=:0; /usr/bin/firefox;"); 
```

我在这里测试并工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T02:58:07.320

我会考虑编写一个“userland”守护程序，它在系统托盘中运行，侦听 HTTP（或 HTTPS）请求并打开相应的程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-06-01T03:00:12.390

您需要指定完整路径

```
exec('/full/path/to/firefox http://google.com'); 
```

# c# - 是什么导致线程挂起并且即使在 20 小时后也不抛出任何东西

> ID：10843832
> 
> 赞同：0
> 
> 时间：2012-06-01T02:54:57.333
> 
> 标签：c#, multithreading, .net-4.0

我在线程中有线程，最后一个子线程只是挂起，现在 20 小时没有抛出任何东西。我的代码是这样的：

```
bool end = false;

var t1 = new Thread(() =>
{
    // ...

    var t2 = new Thread(() =>
    {
        try
        {
            foreach(Data data in datas2)
            {
                foreach(SubData subdata in data.SubDatas)
                {
                    var t3 = new Thread(() =>
                    {
                        this.SaveData(subdata.RetrieveData());
                    }); t3.Start();

                    if (!t3.Join(1800000))
                    {
                        t3.Abort();
                        throw new TimeoutException("The execution of method is taking too long.");
                    }
                }
            }
        } catch { throw; }
        finally { end = true; }
    }); t2.Start();
}); t1.Start(); 
```

它永远不会通过`finally`块，`t2`也不会抛出任何错误。这里发生了什么？

我的代码在 C# 框架 4 中，在 Visual Studio 2010 Pro 中构建。

请帮忙。提前致谢。

* * *

**编辑：**
感谢大家的帮助。我找到了答案，它是

> **一个无限循环。**

由于这个愚蠢的错误，我们的生产停了一周。啊。似乎我们的系统上有一个验证，它只为某些数据创建一个无限循环。感谢大家热心解答这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:00:49.053

我不知道这是否是你的问题....

但是， Thread.Abort 引发了一个异常（一个特殊的异常，即使您捕获它，一旦捕获并最终完成它会自动重新抛出自身，除非您清除 abort ）。如果 SaveData 和 RetriveData 中的代码捕获到异常，然后在捕获中或最终被阻塞，它不会中止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:58:45.463

SaveData 或 RetrieveData 中可能发生了一些我们不知道的事情。您可能正在执行我们不知道的非常长/重复的 I/O。

此外，我不认为这段代码正在做你认为它正在做的事情。见我的//注意：下面：

```
 foreach(SubData subdata in data1.SubDatas)
            {
                var t3 = new Thread(() =>
                {
                    this.SaveData(subdata.RetrieveData());
                }); t3.Start();

                // NOTE: Here you are blocking each iteration of T2 
                // while T3 runs.  There is no reason to be running 
                // another thread here- just call SaveData/RetrieveData 
                // from T2\.  Additionally, because this is executing in 
                // a double-nested loop, you might be doing this many, 
                // many times.  I'd suggest looking into ThreadPool or TPL.

                if (!t3.Join(1800000))
                {
                    t3.Abort();
                    throw new TimeoutException("The execution of method is taking too long.");
                }
            } 
```

# java - 测试 JLabel 是否需要更改大小

> ID：10843838
> 
> 赞同：2
> 
> 时间：2012-06-01T02:56:15.667
> 
> 标签：java, swing, text, resize, jlabel

如果一个具有设定大小的 JLabel 不能显示它设置为显示的所有文本，如何测试？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T03:00:53.777

1.  制作另一个您未设置其大小的标签。
2.  将相同的文本添加到第二个标签。
3.  要求首选尺寸。
4.  如果它大于设置的大小，您的文本将被截断。

但最明智的解决方案是不要一开始就设置标签的大小。

* * *

另请参阅[此示例](https://stackoverflow.com/a/3597688/418556)。

![](../Images/9bc86af7157a3e22fb7bd981dfe55d81.png)

# ruby - watchr：当文件停止更改时，是否可以做一些事情？

> ID：10843840
> 
> 赞同：0
> 
> 时间：2012-06-01T02:56:19.910
> 
> 标签：ruby, watchr

下面是`debounce`Underscore.js 中函数的描述：

> 创建并返回传递函数的新去抖动版本，该版本将推迟其执行，直到自上次调用以来等待毫秒过去后。对于实现仅在输入停止到达后才应发生的行为很有用。例如：渲染 Markdown 注释的预览，在窗口停止调整大小后重新计算布局等等。

有没有一种简单的方法可以使用 watchr 来实现这种行为？我正在编辑数据库文件，所以我无法控制它何时保存。当我完成编辑时，我想用 ruby​​ 做一些事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:22:36.887

不是那么简单的解决方案 - 使用`Thread`：

```
class Debouncer                                         
  def initialize(seconds, &block)                       
    @seconds = seconds                                  
    @block = block                                      
  end                                                   

  def register_event                                    
    Thread.kill(@thread) unless @thread.nil?            
    @thread = Thread.new do                             
      sleep @seconds                         
      @block.call                                       
    end                                                 
  end                                                   

end                                                     

debouncer = Debouncer.new(30) { do_thing } 
watch( 'venus/database/(.*)' )   {|md| debouncer.register_event()} 
```

# css - 禁用ie8剪辑矩形

> ID：10843850
> 
> 赞同：0
> 
> 时间：2012-06-01T02:59:19.650
> 
> 标签：css, internet-explorer-8

非常简单。我`clip : rect`在我的css中使用过，但我不想将它用于ie8。IE8 有自己的样式表，但我不知道如何撤消`clip:rect`。有任何想法吗？

我试过的：

普通样式表

```
#thing{
    clip : rect(0 30px 255px 30px);
} 
```

IE 样式表

```
#thing{
    clip : none;
    clip : rect(0 1000px 1000px 1000px);
} 
```

这两个是我能想到的，一个都没有让它好像`clip:rect`从来没有被调用过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:01:52.623

使用条件显示注释将`clip`样式应用于除 IE8 之外的所有内容：

```
<!--[if !IE 8]>--><style>#thing {clip: rect(0 30px 255px 30px);}</style><!--<![endif]--> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:11:05.280

将右侧和底部设置为`absolute`元素的实际尺寸，将其他两个设置为零。假设大小为 400px x 400px，那么...

```
clip: rect(0 400p 400px 0); 
```

...将剪辑设置为左上角和右下角，这基本上没有剪辑。

**更新**您也可以尝试...

```
clip: auto; 
```

...因为这显然是默认值。

# perl - 如何从 Perl 运行没有文件的 node.js 脚本？

> ID：10843853
> 
> 赞同：2
> 
> 时间：2012-06-01T03:00:07.433
> 
> 标签：perl

我在 Perl 程序中生成一个 node.js 脚本，我想通过 node.js 运行它，作为一个 JavaScript 解释器。如何运行节点`$script`而不将其写入磁盘然后调用节点，然后捕获输出。

我正在使用该`system`命令，我认为这对这个目的很有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:10:34.270

使用`open`代替`system`

```
#!/usr/bin/perl
open(FOO, "|node");
print FOO "console.log('hello world');"; 
```

或者，如果您不需要从 perl 脚本中执行此操作，只需从您的 shell：

```
$ ./myscript.pl | node 
```

打印javascript`myscript.pl`代码后退出的位置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T08:37:39.300

使用[IPC::Run](http://p3rl.org/IPC%3a%3aRun)或[IPC::Open3](http://p3rl.org/IPC%3a%3aOpen3)。

```
use strictures;
use IPC::Run qw(run);
use autodie qw(:all run);

my $in = '… JavaScript goes here …';
my $out;
run ['node'], \$in, \$out; 
```

# java - 使用属性动态读取/添加值到 conf 文件的参数

> ID：10843855
> 
> 赞同：5
> 
> 时间：2012-06-01T03:00:42.257
> 
> 标签：java, properties

我的 conf 文件中有如下消息。

`text.message = Richard`必须进入/ `School`。`01/06/2012``1days`

所有突出显示的字段都是可变的。

我想读取这个`text.me`字符串并使用属性从我的 java 中插入值。

我知道如何使用 Prop 读取整个字符串，但不知道如何像上面的 String 那样读取。

`text.message = #name#`必须在#date# / #days# 中前往#place#。

1.  如何使用 Properties 从 conf 中读取上述字符串并动态插入数据？

2.  它可以是字符串中的日期或天数。我如何在这些参数之间打开和关闭？

提前谢谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-06-01T03:19:16.087

您可以[`MessageFormat`](http://docs.oracle.com/javase/7/docs/api/java/text/MessageFormat.html)为此使用 API。

开球示例：

```
text.message = {0} has to go to {1} in {2,date,dd/MM/yyyy} / {3} 
```

和

```
String message = properties.getProperty("text.message");
String formattedMessage = MessageFormat.format(message, "Richard", "School", new Date(), "1days");
System.out.println(formattedMessage); // Richard has to go to School in 31/05/2012 / 1days 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T03:18:52.863

您可以使用[`MessageFormat`](http://docs.oracle.com/javase/7/docs/api/java/text/MessageFormat.html)该类，它将字符串中的动态占位符替换为所需的值。

例如，下面的代码...

```
String pattern = "{0} has to go to {1} in {2,date} / {3,number,integer} days.";
String result = MessageFormat.format(pattern, "Richard", "school", new Date(), 5);
System.out.println(result); 
```

...将产生以下输出：

```
Richard has to go to school in 31-May-2012 / 5 days. 
```

您可以简单地从您的`Properties`对象中获取模式，然后应用 MessageFormat 转换。

# ruby-on-rails - 无需第二次查询即可获得 Rails 记录计数

> ID：10843863
> 
> 赞同：5
> 
> 时间：2012-06-01T03:01:47.757
> 
> 标签：ruby-on-rails, activerecord

我有一个 Rails ActiveRecord 查询，可以找到名称为某个标记的所有记录。

```
records = Market.where("lower(name) = ?", name.downcase );
rec = records.first;
count = records.count; 
```

服务器显示调用`.first`和`.count`都在访问数据库。

```
←[1m←[35mCACHE (0.0ms)←[0m  SELECT "markets".* FROM "markets" WHERE (lower(nam
e) = 'my market') LIMIT 1

←[1m←[36mCACHE (0.0ms)←[0m  ←[1mSELECT COUNT(*) FROM "markets" WHERE (lower(na
me) = 'my market')←[0m 
```

为什么它可以使用已经查询的结果时去数据库获取计数？

我担心未来的表现。今天有1000条记录。当该表包含 800 万行时，执行两次查询，一次查询数据，一次查询计数，这将是昂贵的。

如何从集合而不是数据库中获取计数？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T03:05:50.410

RactiveRecord 使用惰性查询从数据库中获取数据。如果你想简单地统计记录，你只能调用重新运行数组的大小。

```
records = Market.where("lower(name) = ?", name.downcase ).all
records.size 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-06-01T03:08:38.343

所以，`records`是一个`ActiveRelation`. 您会认为这是符合您标准的所有市场记录的数组`where`，但事实并非如此。每次您引用类似`first`或`count`关于该关系的内容时，它都会执行查询以检索您所要求的内容。

要将实际记录放入数组中，只需添加`.all`到关系中即可实际检索它们。喜欢：

```
records = Market.where("lower(name) = ?", name.downcase).all
count = records.count 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-01T23:14:27.423

对于 Rails 6.0.1 和 Ruby 2.6.5

您需要使用`to_a`.

```
records = Market.where("lower(name) = ?", name.downcase).to_a 
```

这将创建 SQL 查询并将结果存储在数组中`records`。

然后，当您调用其中一个时，它只会返回数据或进行计算，而不是重新运行查询`records.first`。`records.count`这对于`records.size`和是一样的`records.length`。

**另一个例子**

我需要为我正在开发的博客这样做。我试图运行查询以查找与帖子关联的所有标签，并且我想计算有多少标签。在我遇到`to_a` 后缀之前，这会导致多次查询。

因此，我的 SQL 查询如下所示：

```
@tags = TagMap.where(post_id: @post).joins(:tag).select(:id, '"tags"."name"').to_a 
```

这会在我的 TagMap 表中查找与我正在查看的帖子`post_id`相同的所有记录。`id`然后它连接到标签表并从标签表中只提取`id`TagMap 记录和标签名称。然后它将它们全部放入一个数组中。然后我可以运行`@tags.count`，它将返回该帖子的 TagMap 记录数，而无需进行其他查询。

我希望这可以帮助任何使用 Rails 6+ 的人

# email - 如何在电子邮件中嵌入开放社交小工具？

> ID：10843868
> 
> 赞同：0
> 
> 时间：2012-06-01T03:02:36.767
> 
> 标签：email, xpages, opensocial

我正在尝试将 opensocial 小工具嵌入到电子邮件中。但我不知道从哪里开始。我搜索了 opensocial wiki，但找不到我的答案。我仍然很困惑谁将负责在电子邮件中呈现小工具以及它是如何工作的，以及如何处理小工具或容器中的 javascript 跨域问题（如果需要）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-19T17:57:39.863

（抱歉所有奇怪的链接，但 StackOverflow 不允许我在一篇文章中引用超过 2 个链接。）

从小工具的角度了解这个用例如何工作的最佳去处是 OpenSocial Wiki[1]。在 OpenSocial 中，我们将您描述的功能称为嵌入式体验。嵌入式体验教程[2] 对您的帮助最大。您还想通读 OpenSocial Spec[3] 的嵌入式体验部分。基本上，为了在电子邮件中嵌入 OpenSocial 小工具，您需要做的是在您的多部分 MIME 电子邮件中添加另一个 MIME 部分，MIME 类型为 application/embed+json 或 application/embed+xml，然后放入 XML 或 JSON 数据该 MIME 部分正文中的规范中描述的模型。

支持嵌入式体验的邮件客户端将查找这些 MIME 类型，然后可以呈现 OpenSocial 小工具。显然，邮件客户端需要考虑与在电子邮件中嵌入小工具相关的各种安全问题，但如何解决这些问题将因容器而异，并且小工具本身不应该关心这些问题。Apache Shindig 项目[4] 为嵌入式体验提供了参考实现。OpenSocial Spec 组[5] 和 Apache Shindig 邮件列表[6] 可能是未来就该主题提出问题的最佳场所。

我制作了一些演示视频，展示了 IBM Lotus Notes 和 iNotes[7] 以及 OpenSocial 2.0 Sandbox[8] 中的嵌入式体验。

1.)http://docs.opensocial.org

2.)http://docs.opensocial.org/display/OSREF/Embedded+Experiences+Tutorial

3.)http://opensocial-resources.googlecode.com/svn/spec/2.0.1/Core-Gadget.xml#Embedded-Experiences

4.)http://shindig.apache.org/

5.) https://groups.google.com/forum/?fromgroups#!forum/opensocial-and-gadgets-spec

6.)http://shindig.apache.org/mail-lists.html

8.)http://www.youtube.com/watch?v=-IaBzt-9_TM

9.)http://sandbox.opensocial2.org:8080/collabapp/index.html

# c# - 使用实体框架 foreach 一组 where 条件

> ID：10843873
> 
> 赞同：1
> 
> 时间：2012-06-01T03:03:38.243
> 
> 标签：c#, entity-framework

我正在尝试做这样的事情，并得到编译器错误：

```
var query = from ev in dataConnection.event_info
                       where ev.isdeleted == 0
                       select ev;
foreach (System.Linq.Expressions.Expression whereCond in whereConditionsList)
{
    query.Where(whereCond);
} 
```

错误：

**`'System.Linq.IQueryable<JsonApplicationServices.event_info>' does not contain a definition for 'Where' and the best extension method overload 'System.Linq.Enumerable.Where<TSource>(System.Collections.Generic.IEnumerable<TSource>, System.Func<TSource,int,bool>)' has some invalid arguments C:\Users\jzumbrum\perforce_jzumbrum_laptop\jzumbrum_laptop\SlamRun\WCFService\Events.cs 31 21 WCFService`**

如何创建`where`条件集合，然后`foreach`对其进行处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:10:08.483

你可以试试这个：

```
// query defined earlier...

foreach (System.Linq.Expressions.Expression whereCond in whereConditionsList)
{
    query = query.Where(whereCond);
} 
```

但这`Expression`件事似乎很有趣……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-05T14:16:56.037

所以我没有弄清楚如何在 where 条件上进行 foreach，但我确实知道如何附加到我的 where 条件，以及我在这里以不同的方式提出的问题： [stackoverflow answer](https://stackoverflow.com/questions/10875547/combine-predicates-in-linq-to-entities)

要点是您需要添加 query.AsExpandable.Where()

# ruby-on-rails - 从活动记录中的组中选择最小值

> ID：10843874
> 
> 赞同：2
> 
> 时间：2012-06-01T03:04:05.407
> 
> 标签：ruby-on-rails, ruby, activerecord

我需要像中标一样获取出价，并且出价可以针对不同的日期（不要问为什么），因此我需要选择每天最低出价的出价。

这是我的模型

```
Leilao
  has_many :bids

Bid
  belongs_to :leilao
  #winner_name
  #price
  #date 
```

我已经尝试了一个解决方案并且接近了我需要的。问题是，在某些情况下，当我创建一个价格较低的新出价时，我不知道为什么结果没有改变。

```
Leilao.find(1).bids.having('MIN("bids"."price")').group('date').all 
```

这似乎可行，但正如我所说，在某些情况下，当我创建新出价时它不起作用。但它曾经正常工作过。所以，如果你知道可能会发生什么，请告诉我。

然后我搜索了一些方法来做到这一点，我得到了以下

```
Leilao.find(1).bids.minimum(:price, :group => :date) 
```

这可以正常工作，但是有了这个，我只需要获取日期和价格，我需要所有的出价数据。

我可以通过这样做得到它，但对我来说感觉真的很糟糕

```
winner_bids = Leilao.find(1).bids.minimum(:price, :group => :date)
winners_data = []
winner_bids.each do |date, price|
  winners_data << Leilao.find(1).bids.where(price: price, date: date).first
end
winners_data 
```

任何想法更好的方法来做到这一点？或者我的第一种方法有什么问题？

性能不是问题，因为这只是为了学术建议，但对我来说感觉很讨厌

还有那些 Leilao.find(1) 只是在这里解释它，我不是到处使用它，不是。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T05:57:09.433

看到这个

```
mysql> select * from bids;
+----+-------------+-------+------------+-----------+
| id | winner_name | price | date       | leilao_id |
+----+-------------+-------+------------+-----------+
|  1 | A           |   1.1 | 2012-06-01 |         1 |
|  2 | A           |   2.2 | 2012-06-01 |         1 |
|  3 | A           |   3.3 | 2012-05-31 |         1 |
|  4 | A           |   4.4 | 2012-05-31 |         1 |
+----+-------------+-------+------------+-----------+
4 rows in set (0.00 sec)

mysql> select * from bids where leilao_id = 1 group by date order by price asc;
+----+-------------+-------+------------+-----------+
| id | winner_name | price | date       | leilao_id |
+----+-------------+-------+------------+-----------+
|  1 | A           |   1.1 | 2012-06-01 |         1 |
|  3 | A           |   3.3 | 2012-05-31 |         1 |
+----+-------------+-------+------------+-----------+
2 rows in set (0.00 sec) 
```

在铁轨上

```
1.9.2-p290 :013 > Leilao.find(1).bids.order(:price).group(:date).all
[
    [0] #<Bid:0x00000003553838> {
                 :id => 1,
        :winner_name => "A",
              :price => 1.1,
               :date => Fri, 01 Jun 2012,
          :leilao_id => 1
    },
    [1] #<Bid:0x00000003553518> {
                 :id => 3,
        :winner_name => "A",
              :price => 3.3,
               :date => Thu, 31 May 2012,
          :leilao_id => 1
    }
] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-06T11:14:42.203

正如 Amol 所说，它不起作用，SQL 看起来像

```
SELECT "whatever".* FROM "whatever" GROUP BY date ORDER BY price 
```

但`group_by`将在之前应用`order_by`

当我有存储不同类型记录的市场表时遇到了这个问题，我通过编写一个类方法解决了这个问题，也许不是最好的方法，但可以工作

```
def self.zobraz_trh(user)
  markets = []
  area = self.group(:area).all.map &:area
  area.each do |market|
      markets <<  self.where(["area = ? and user_id != ?", market,user]).order(:price).first
  end
    markets
end 
```

其中 self 是 Market 类

# oauth - 对旧 Google Data AP、新 Google API 和 Google Apps Marketplace 的困惑

> ID：10843876
> 
> 赞同：0
> 
> 时间：2012-06-01T03:04:49.610
> 
> 标签：oauth, google-api, google-data-api, google-apps-marketplace, google-admin-settings-api

目前，Google 正在将其[旧的 Google Data API](https://developers.google.com/gdata/)迁移到新的 Google API。

当我们对旧的 Google Data API 进行 API 查询时，我们通常使用 Zend Framework 和给定的使用者密钥/秘密来执行 authen/auth，这很好。

问题是，是否可以使用给定的消费者密钥/秘密（来自 Google Apps Marketplace 列表）和新的[OAuth 2 库](http://code.google.com/p/google-api-php-client/wiki/OAuth2)来调用 API？我遇到的是错误消息`redirect_uri mismatched`问题，显然 Google Apps Marketplace 无法更改此值。尽管他们为我们提供了从列表页面转到 API 控制台的链接，但我在我的 API 访问页面中根本看不到 OAuth 2.0 选项。

我错过了什么吗？

如果假设我需要使用[Google Apps Admin Settings API](https://developers.google.com/google-apps/admin-settings/)，是否意味着我需要在 API 控制台中单独创建一个新的 OAuth 2.0 API 访问，然后，当我需要访问用户数据时，我需要进行身份验证流程再次使用这个新的消费者密钥/秘密/重定向？我无法在清单清单中设置此权限？（不支持？）

感谢您的澄清！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-03T19:48:39.230

Google Apps 管理员设置尚未迁移到新的 google-api、AFAICS。查看此列表：[http](http://code.google.com/p/google-api-java-client/wiki/APIs) ://code.google.com/p/google-api-java-client/wiki/APIs ；

但是，您可以使用新的 google-api 客户端库，但您必须为给定的 API 推出自己的 XML 模型，这并不难，[我为 Contact API 做了类似的事情](https://groups.google.com/forum/?fromgroups=#!searchin/google-api-java-client/updated-min/google-api-java-client/kr8UHSQCw_0/ZecTnkEs2JMJ)；

如果范围足够大，消费者/密钥秘密可以正常重复使用。[根据我的记忆](https://groups.google.com/forum/?fromgroups=#!searchin/google-apps-marketplace-api/api%2420console/google-apps-marketplace-api/l1BaiNPpGw8/8JRxBmxzJFkJ)，您的市场应用程序的相关项目会自动在 Google Api 控制台中创建..

# javascript - 如何编写依赖于动态选择器的函数？

> ID：10843877
> 
> 赞同：2
> 
> 时间：2012-06-01T03:04:55.010
> 
> 标签：javascript, jquery, jquery-ui

我正在编写一个函数来动态加载带有内容的 jQuery UI 手风琴叶子。我知道（认为）AJAX 部分可以工作，因为我从另一个工作的 AJAX 加载程序中取出它，但是整个功能不起作用。

编码：

```
 function load_leaf(link){
    var link = link;
    $.ajax({
            cache : false,
            type : 'POST',
            async: false,
            url : 'includes/'+ link +'.php?'+ new Date().getTime(),
            dataType : 'text',
            data: {
                owner : '$user_id'
            },
            success: function(msg){
                $("#" + link).html(msg);
                console.log('Can\'t see me in Chrome, but ok in firefox !')
            },
            error: function() {
                console.log($.makeArray(arguments));
            },
            complete: function() {
                console.log($.makeArray(arguments));
            }

    });
};
$(function(){
    $('.accordian').click(function(){
        var link = this.getAttribute("link");
        load_leaf(link);
    });
}); 
```

无论出于何种原因，这都行不通。断点似乎是这一行
`$("#" + link).html(msg);`
特别是选择器，因为硬编码的选择器可以完美地工作。链接变量已正确填充我知道这一点，因为我可以正确地提醒该值。链接不是问题，因为我用一个简单的添加类替换了整个 ajax 函数，但它仍然不起作用，它也在选择器处损坏。

编辑：
这是 php 打印的 div：

```
<h3 class="accordian" id="'.$tab_id.'" link="'.$tab_link.'" >
 <a href="#">'.$tab_name.'</a>
</h3>
<div id="'.$tab_link.'"><p>Hi</p></div> 
```

第一个的html是：

```
 <h3 class="accordian" id="accordian_manage.php" link="accordian_manage.php" ><a href="#">Manage Images</a></h3><div id="accordian_manage.php"><p>Hi</p></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:31:53.333

您的 ID 中有一个句`.`点，jQuery 将其解释为链式类选择器。

您可以更改链接/ID，或使用此 hack：

```
$("[id='" + link + "']"); 
```

**[现场演示](http://jsfiddle.net/ult_combo/983e3/5/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:09:50.397

我想你的问题是 Jquery 没有找到加载 msg 的 div ..发布手风琴 div 以便我可以给你正确的选择器

# python - django-social-auth：如何获取 facebook 的个人资料图片并将其保存在 media/mudshots/ 文件夹中

> ID：10843878
> 
> 赞同：1
> 
> 时间：2012-06-01T03:04:56.477
> 
> 标签：python, django, facebook, django-socialauth

我`from social_auth.signals import socialauth_registered`在我的项目中使用新注册用户。我注意到当我尝试在 facebook 上注册我的项目时。我的项目没有获得我的 facebook 的个人资料图片，而是获得了我的`gravatar.com`帐户的个人资料图片。

这是我的代码：

```
from django.db import models
from django.utils.translation import ugettext_lazy as _
from django.contrib.auth.models import User
from userena.models import *
from social_auth.signals import pre_update
from social_auth.backends.facebook import FacebookBackend
from social_auth.backends import google
from social_auth.signals import socialauth_registered
import datetime

def new_users_handler(sender, user, response, details, **kwargs):
    user.is_new = True
    print "hello"
    if user.is_new:
        print "world"
        if "id" in response:
            print "police"
            from urllib2 import urlopen, HTTPError
            from django.template.defaultfilters import slugify
            from django.core.files.base import ContentFile

            try:
                url = None
                if sender == FacebookBackend:
                    url = "http://graph.facebook.com/%s/picture?type=large" \
                                % response["id"]
                elif sender == google.GoogleOAuth2Backend and "picture" in response:
                    url = response["picture"]

                print url
                if url:
                    avatar = urlopen(url)
                    #profile = UserProfile(user=user)
                    print "again"
                    print user
                    fileName = "media/mugshots/"+ str(user) + ".jpg"
                    print "okss"
                    print fileName

                    try:
                        profile = Profile.objects.get(user=user)
                    except:
                        profile = Profile.objects.create(user=user)                

                    localFile = open(fileName, 'w')
                    localFile.write(avatar.read())
                    localFile.close()
                    profile.mugshot = fileName
                    print "save=ing profile"
                    #profile.mugshot.save(slugify(user.username + " social") + '.jpg', 
                    #       ContentFile(avatar.read()))              

                    profile.save()

            except HTTPError:
                pass

    return False

socialauth_registered.connect(new_users_handler, sender=None) 
```

但我的代码无法将 facebook 个人资料图片保存到“media/mudshots/dir”。

我的问题是，如何获取 facebook 帐户的个人资料图片并将其保存`media/mudshots/`在我的 django 项目的目录中？

任何人都可以帮助我处理我的情况吗？

提前致谢 ..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:37:49.857

我明白了...我用这个..

```
import datetime
import urllib
import string
import random
import os
avatar = urlopen(url)

try:
    profile = Profile.objects.get(user=user)
except:
    profile = Profile.objects.create(user=user)

print profile
print "sdfffffffffffffffffffff"
filename_charset = string.ascii_letters + string.digits
filename_length = 10
file_save_dir = 'media/mugshots/'

filename = ''.join(random.choice(filename_charset)
                   for s in range(filename_length))

urllib.urlretrieve (url, os.path.join(file_save_dir, filename + '.png'))

profile.mugshot = 'mugshots/'+filename + '.png'

profile.save() 
```

# css - css3按钮背景颜色无限过渡

> ID：10843880
> 
> 赞同：19
> 
> 时间：2012-06-01T03:05:25.533
> 
> 标签：css, css-transitions, css-animations

有没有办法只使用css3使按钮的背景颜色从灰色变为蓝色然后再变回灰色？一个很好的例子是默认操作按钮是可可吗？我知道这可以在 javascript 中完成，但我宁愿只使用 css。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-06-01T05:52:35.270

嗨，我已经通过 CSS3 动画制作了按钮，请看一下，我希望它接近你的问题：-

**HTML**

```
<input type="submit" value="submit" class="button" /> 
```

**CSS**

```
.button {
    width:100px;
    height:20px;
    background:red;
    animation:myfirst 5s;
    -moz-animation:myfirst 5s infinite; /* Firefox */
    -webkit-animation:myfirst 5s infinite; /* Safari and Chrome */
}

@-moz-keyframes myfirst /* Firefox */ {
    0% {background:red;}
    50% {background:yellow;}
    100% {background:red;}
}

@-webkit-keyframes myfirst /* Safari and Chrome */ {
    0% {background:red;}
    50% {background:yellow;}
    100% {background:red;}
} 
```

查看演示：- [http://jsbin.com/osohak/7/edit](http://jsbin.com/osohak/7/edit)

阅读更多关于 CSS3 过渡和动画[http://css3.bradshawenterprises.com/cfimg/](http://css3.bradshawenterprises.com/cfimg/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-06-01T05:57:28.280

如果您需要淡入淡出动画`hover`或类似的东西，[CSS3 过渡属性](http://www.w3schools.com/css3/css3_transitions.asp)是您的解决方案。

编辑：

```
.btn {
  background-color: lightblue;
  -webkit-transition: all 0.3s ease-out;  /* Saf3.2+, Chrome */
     -moz-transition: all 0.3s ease-out;  /* FF4+ */
      -ms-transition: all 0.3s ease-out;  /* IE10 */
       -o-transition: all 0.3s ease-out;  /* Opera 10.5+ */
          transition: all 0.3s ease-out;
}  

.btn:hover {
  background-color: lightgreen;  
} 
```

# cakephp - CAKEPHP 在控制器中删除和查看

> ID：10843883
> 
> 赞同：0
> 
> 时间：2012-06-01T03:05:45.517
> 
> 标签：cakephp, view

[http://pastebin.com/TPDcNaAp](http://pastebin.com/TPDcNaAp)

更清洁的粘贴箱。 [http://webdesign4.georgianc.on.ca/~100141468/comp2084/todo/Employees](http://webdesign4.georgianc.on.ca/~100141468/comp2084/todo/Employees)

我正在尝试使用 cake 以便能够在不使用脚手架的情况下添加/删除/编辑和查看。我似乎无法让删除和查看正常工作。那是我在 pastebin 中的代码，有人看到我做错了什么吗？该文件是EmployeesController.php。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:11:49.280

对于您的观点，您尚未创建文件：

```
Error: Confirm you have created the file: /home/100141468/public_html/comp2084/todo/app/View/Employees/view.ctp 
```

将您的视图代码更改为如下所示：

```
$this->set('employee', $this->Employee->read(null, $id)); 
```

您的视图将看起来像您想要的任何内容，使用您需要的任何 html 标记来显示数据，无论是表格、div、列表等。在您的视图中，您将拥有`$employee`可用的变量，执行 a`debug($employee);`以查看其内容。

前任：`<div><b>Name:</b> <?php echo $employee['Employee']['name']; ?></div>`

您可能还想首先检查记录是否存在以重定向回上一页并让用户知道该记录不存在（设置一个闪烁消息）。

对于您的删除，您正在通过 GET 访问它，但不允许在代码中使用它：

```
 if ($this->request->is('get')) {
    throw new MethodNotAllowedException();
 } 
```

如果您想通过访问 url`/employees/delete/{id}`删除该代码块。

# jquery - 停止编码“？” JSON跨域请求期间

> ID：10843888
> 
> 赞同：1
> 
> 时间：2012-06-01T03:06:37.273
> 
> 标签：jquery, json, jsonp

如何防止跨域 jQuery`getJSON`请求对回调问号进行编码：

```
$.getJSON(searchResultsURL, {
        token: jSONAPItoken,
        callback: '?'
    }, function(data){
        ……
    }) 
```

最终发送请求： `http://example.com/xxx?token=tokenxxx&callback=%3F`

它在哪里编码`?`to `%3f`。我怎样才能防止这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T03:08:28.253

你误用了`getJSON`.

`$.getJSON`要求`callback`参数在 URL 中，而不是`data`参数中。

您需要添加`?callback=?`到 URL 字符串；然后 jQuery 将`?`用自动生成的回调函数名称替换 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:08:10.607

`?`不是查询字符串中的有效字符，必须进行编码。但是，服务器在将其传递给您的服务器端之前对其进行解码（例如，在 PHP`$_GET['callback']`中将等于`?`）

您不应该担心这一点，因为它只是格式化您的 URL 的静默操作，因此它实际上可以工作。

# excel - 禁用 Excel UserForm 淡入淡出动画

> ID：10843889
> 
> 赞同：1
> 
> 时间：2012-06-01T03:06:41.507
> 
> 标签：excel, vba, user32, userform

在 Excel 2007（和 2010）中使用 VBA，有没有办法在显示和隐藏用户窗体时禁用标准的淡入和淡出动画。特别是淡出对于我正在尝试创建的用户界面来说太慢了。

也许该`user32`功能[`AnimateWindow`](http://msdn.microsoft.com/en-us/library/ms632669%28VS.85%29.aspx)有一个可以作废的设置，但我还没有弄清楚。

**编辑**：这是一个审美目标；没有性能问题。由操作系统处理的淡出`Me.Hide`需要大约 1/2 秒，我想知道它是否可以被立即覆盖。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T17:47:51.887

VBA 在加载/卸载时没有任何内置的用户窗体动画属性。

它由操作系统处理。您是否尝试[关闭视觉效果](http://windows.microsoft.com/en-us/windows7/Optimize-Windows-7-for-better-performance)以查看响应是否更好？（提示：调整以获得最佳性能）

如果这不是问题，那么发布导致问题的代码会有所帮助。（假设它不仅仅是*Me.Hide*或*Unload Me*）

# c - C中的函数strtol超出范围......或不是

> ID：10843891
> 
> 赞同：2
> 
> 时间：2012-06-01T03:06:57.710
> 
> 标签：c, std, strtol

我尝试使用 strtol() 从字符串中读取一个数字，它返回 LONG_MAX 数字，当数字超出范围时应该返回该数字，但我的数字不是那么大

```
main(){
    char linea[30]={"110111010111111000000000"};
    long num=strtol(linea,NULL,0);
    printf("%s\n%X",linea,num);
} 
```

实际结果：
110111010111111000000000
7FFFFFFF

需要的结果：
110111010111111000000000
DD7C00

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-06-01T03:13:12.847

根据 strtol 的手册页，您给出的 '0' 参数意味着“使用您的最佳判断”，在这种情况下是*decimal*。如果您希望它转换*二进制*数，正如您指定的“需要的结果”所建议的那样，不要使用“0”，使用“2”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:10:07.040

可能是因为你传入基数 0

尝试：

```
int main(){
    char linea[30] = {"110111010111111000000000"};
    long num       = strtol(linea, NULL, 10);
    printf("%s\n%X", linea, num);
} 
```

**编辑** 显然 base 0 是该`strtol`函数的特殊值：

> 如果 base 的值为 0，则主题序列的预期形式是十进制常量、八进制常量或十六进制常量，其中任何一个都可以以“+”或“-”符号开头。

所以我猜你可以使用0，抱歉怀疑你。

# hadoop - 为 Hadoop 下载大数据

> ID：10843892
> 
> 赞同：38
> 
> 时间：2012-06-01T03:07:09.673
> 
> 标签：hadoop, download

我需要一个大数据（超过 10GB）来运行 Hadoop 演示。谁知道哪里可以下载。请告诉我。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-06-01T05:12:55.527

我建议您从以下网站下载百万首歌曲数据集：

[http://labrosa.ee.columbia.edu/millionsong/](http://labrosa.ee.columbia.edu/millionsong/)

Millions Songs Dataset 的最佳之处在于，您可以将 1GB（约 10000 首歌曲）、10GB、50GB 或约 300GB 的数据集下载到您的 Hadoop 集群并进行任何您想要的测试。我喜欢使用它，并且使用这个数据集学到了很多东西。

首先，您可以从 AZ 下载以任意一个字母开头的数据集，范围从 1GB 到 20GB。您也可以使用 Infochimp 网站：

[http://www.infochimps.com/collections/million-songs](http://www.infochimps.com/collections/million-songs)

在我的以下博客之一中，我展示了如何下载 1GB 数据集并运行 Pig 脚本：

[http://blogs.msdn.com/b/avkashchauhan/archive/2012/04/12/processing-million-songs-dataset-with-pig-scripts-on-apache-hadoop-on-windows-azure.aspx](http://blogs.msdn.com/b/avkashchauhan/archive/2012/04/12/processing-million-songs-dataset-with-pig-scripts-on-apache-hadoop-on-windows-azure.aspx)

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-12-03T05:54:10.987

Tom White mentioned about a sample weather data set in his Book(Hadoop: the definitive guide).

`http://hadoopbook.com/code.html`

Data is available for more than 100 years.

I used `wget` in linux to pull the data. For the year 2007 itself the data size is 27 GB.

It is hosted as an `FTP` link. So, you can download with any FTP utility.

[ftp://ftp.ncdc.noaa.gov/pub/data/noaa/](ftp://ftp.ncdc.noaa.gov/pub/data/noaa/)

For complete details please check my blog:

[http://myjourneythroughhadoop.blogspot.in/2013/07/how-to-download-weather-data-for-your.html](http://myjourneythroughhadoop.blogspot.in/2013/07/how-to-download-weather-data-for-your.html)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-06-01T16:08:44.903

[亚马逊上有可用的公共数据集： http](http://aws.amazon.com/publicdatasets/) ://aws.amazon.com/publicdatasets/
我建议考虑在那里运行演示集群 - 从而节省下载。
Common Crawl 也有很好的 crowned web 数据集，它也可以在 amazon s3 上找到。[http://commoncrawl.org/](http://commoncrawl.org/)

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2012-06-03T13:34:47.083

您可能会感兴趣的一篇文章“[使用 Hadoop 分析使用 WikiHadoop 的完整 Wikipedia 转储文件](http://www.mappian.com/blog/hadoop/using-hadoop-to-analyze-the-full-wikipedia-dump-files-using-wikihadoop/)”。

如果您**关注 Wikipedia page view statistics**，那么[这](http://dumps.wikimedia.org/other/pagecounts-raw/)可能会有所帮助。您可以下载从 2007 年到当前日期的 pagecount 文件。只是为了了解文件的大小，**一天 1.9 GB**（*这里我选择 2012-05-01*）分布在 24 个文件中。

目前，31 个国家/地区拥有以各种格式提供公共数据的网站，[http://www.data.gov/opendatasites](http://www.data.gov/opendatasites)。此外，世界银行在[http://data.worldbank.org/data-catalog上提供数据](http://data.worldbank.org/data-catalog)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-02-20T07:16:32.830

如果您对国家指标感兴趣，我发现的最佳来源是 worldbank.org。他们提供的数据可以导出为 CSV，这使得在 Hadoop 中使用变得非常容易。如果您使用的是 .NET，我写了一篇博文[http://ryanlovessoftware.blogspot.ro/2014/02/creating-hadoop-framework-for-analysing.html](http://ryanlovessoftware.blogspot.ro/2014/02/creating-hadoop-framework-for-analysing.html)，您可以在其中查看数据的外观，如果您下载来自 gidhub [https://github.com/ryan-popa/Hadoop-Analysis](https://github.com/ryan-popa/Hadoop-Analysis)的代码，你已经有了字符串解析方法。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-03-19T13:52:06.137

“2012 年互联网人口普查”怎么样，通过对整个互联网进行分布式扫描收集的数据：

公告：[http ://seclists.org/fulldisclosure/2013/Mar/166](http://seclists.org/fulldisclosure/2013/Mar/166)

资料：http: [//internetcensus2012.bitbucket.org/](http://internetcensus2012.bitbucket.org/)

整个数据为 7TB，（显然）只能通过 torrent 获得。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-01T04:40:25.390

生成数据可能比下载和放置数据要快。这样做的好处是让您可以控制问题域并让您的演示对观看的人有意义。

# android - Android - fill_parent 在RelativeLayout 中的行为不符合预期

> ID：10843893
> 
> 赞同：2
> 
> 时间：2012-06-01T03:07:14.403
> 
> 标签：android, layout, button, center, android-relativelayout

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/frameLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/background_gradient" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:gravity="center" >

        <ImageButton
            android:id="@+id/buttonLog"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="@drawable/log"
            android:onClick="log" />

    </RelativeLayout>

</FrameLayout> 
```

我期待我的按钮出现在**屏幕中央**。但是，它出现在屏幕的 TOP 中心（即按钮水平居中，而不是垂直居中）。

在我看来，RelativeLayout 的行为就像是用“wrap_content”而不是“fill_parent”定义的。

有趣的是，如果我为我的 RelativeLayout 高度属性 (android:layout_height) 赋予一个实际值，例如：

```
<RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="100dp"
        android:gravity="center" > 
```

然后按钮行为正确（即按钮也垂直居中）。但我不想使用实际值。我想使用fill_parent！为什么它不适用于“fill_parent”？

有人知道发生了什么吗？

先感谢您！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T03:34:21.940

RelativeLayout 要求您指定元素在 Layout 中的位置。我没有看到任何 layout_below 或 layout_toLeftOf 标签。重力适用于线性布局。一般来说，LinearLayouts 更容易使用，并且它们可以更好地扩展到不同的屏幕尺寸。我建议您将 RelativeLayout 替换为 LinearLayout，并将 FrameLayout 替换为 LinearLayout。如果您想使用多个重叠布局，您通常会使用 FrameLayout，但您不会这样做。

我建议您阅读 Android sdk 参考文档中的使用布局，例如：http: [//bit.ly/djmn7](http://bit.ly/djmnn7)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-06-01T03:43:27.527

您为您的和指定`fill_parent`了，因此它填充了它的父视图。默认情况下，无论您使用大小，相对布局都会将其子级排列到左上角。`layout_width``layout_height``RelativeLayout``fill_parent`

您应该通过利用`RelativeLayout's`自己的属性集来实现所需的方面，这有助于您将子视图**相**对于彼此或它们的父视图排列：

```
<ImageButton
    android:id="@+id/buttonLog"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerInParent="true"
    android:background="@drawable/log"
    android:onClick="log" /> 
```

使用`android:layout_centerInParent`你可以实现这一点。如果此属性设置为 true，则该子项在其父项中水平和垂直居中。

# android - android上sqlite中的关系表

> ID：10843895
> 
> 赞同：8
> 
> 时间：2012-06-01T03:07:50.333
> 
> 标签：android, database, sqlite

你能帮我了解一下sqlite中两个表之间的关系吗？

我做了插入、删除和更新步骤，但我现在必须支持两个表之间的关系。我猜
之前完成的所有代码步骤都会被更改对吗？您是否有任何链接或示例来解释表关系和关系后的任何活动？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-06-01T04:02:54.593

要在两个表之间建立关系，可以使用[外键](http://en.wikipedia.org/wiki/Foreign_key)。外键是关系表中与另一个表的[候选键匹配的字段。](http://en.wikipedia.org/wiki/Candidate_key)

例如，假设我们有两个表，一个包含所有客户数据的 CUSTOMER 表和一个包含所有客户订单的 ORDER 表。此处的目的是所有订单都必须与已在 CUSTOMER 表中的客户相关联。为此，我们将在 ORDER 表中放置一个外键，并使其与 CUSTOMER 表的主键相关。

在SQLite中，可以通过以下方式添加 [外键约束::](http://sqlite.org/foreignkeys.html)

编辑:: 你可以设计 item_order 表像 ::

```
CREATE TABLE customer(
         id INTEGER,
         firstName TEXT,
         middleName TEXT,
         lastName   TEXT,
         address TEXT,
         contactNum TEXT
);

 CREATE TABLE item(
        id INTEGER,
        name TEXT,
        description TEXT
 );

 CREATE TABLE order(
        id INTEGER,
        customerID INTEGER,
        date TEXT,
        FOREIGN KEY(customerId) REFERENCES customer(id)
 );

 CREATE TABLE item_order(
        id INTEGER,
        orderID INTEGER,
        itemId  INTEGER,
        quantity INTEGER,
        FOREIGN KEY(orderId) REFERENCES order(Id),
        FOREIGN KEY(itemId) REFERENCES item(Id)
 ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-07T23:00:26.943

好的示例 [http://www.androidhive.info/2013/09/android-sqlite-database-with-multiple-tables/](http://www.androidhive.info/2013/09/android-sqlite-database-with-multiple-tables/)

```
// Table Create Statements
// Todo table create statement
private static final String CREATE_TABLE_TODO = "CREATE TABLE "
        + TABLE_TODO + "(" + KEY_ID + " INTEGER PRIMARY KEY," + KEY_TODO
        + " TEXT," + KEY_STATUS + " INTEGER," + KEY_CREATED_AT
        + " DATETIME" + ")";

// Tag table create statement
private static final String CREATE_TABLE_TAG = "CREATE TABLE " + TABLE_TAG
        + "(" + KEY_ID + " INTEGER PRIMARY KEY," + KEY_TAG_NAME + " TEXT,"
        + KEY_CREATED_AT + " DATETIME" + ")";

// todo_tag table create statement
private static final String CREATE_TABLE_TODO_TAG = "CREATE TABLE "
        + TABLE_TODO_TAG + "(" + KEY_ID + " INTEGER PRIMARY KEY,"
        + KEY_TODO_ID + " INTEGER," + KEY_TAG_ID + " INTEGER,"
        + KEY_CREATED_AT + " DATETIME" + ")"; 
```

SELECT * FROM todos td, tags tg, todo_tags tt WHERE tg.tag_name = 'Watchlist' AND tg.id = tt.tag_id AND td.id = tt.todo_id;

```
/*
 * getting all todos under single tag
 * */
public List<Todo> getAllToDosByTag(String tag_name) {
    List<Todo> todos = new ArrayList<Todo>();

    String selectQuery = "SELECT  * FROM " + TABLE_TODO + " td, "
            + TABLE_TAG + " tg, " + TABLE_TODO_TAG + " tt WHERE tg."
            + KEY_TAG_NAME + " = '" + tag_name + "'" + " AND tg." + KEY_ID
            + " = " + "tt." + KEY_TAG_ID + " AND td." + KEY_ID + " = "
            + "tt." + KEY_TODO_ID;

    Log.e(LOG, selectQuery);

    SQLiteDatabase db = this.getReadableDatabase();
    Cursor c = db.rawQuery(selectQuery, null);

    // looping through all rows and adding to list
    if (c.moveToFirst()) {
        do {
            Todo td = new Todo();
            td.setId(c.getInt((c.getColumnIndex(KEY_ID))));
            td.setNote((c.getString(c.getColumnIndex(KEY_TODO))));
            td.setCreatedAt(c.getString(c.getColumnIndex(KEY_CREATED_AT)));

            // adding to todo list
            todos.add(td);
        } while (c.moveToNext());
    }

    return todos;
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-06-01T03:29:43.910

我想您应该阅读有关基本 sql 数据库编程的书或网站。您可以通过将一个表的键（或字段）添加到另一个表中来创建两个表之间的关系。但实际上，您应该先熟悉 sql。完成后，您可以创建关系，或者您会发现使用 Ormlite 很方便。

# java - 输入后退出 Java 程序

> ID：10843896
> 
> 赞同：0
> 
> 时间：2012-06-01T03:07:56.117
> 
> 标签：java, loops, if-statement, exit

该程序让用户输入一个数字并检查该数字是否为素数。但是，如果希望程序在用户输入“q”时退出。我已经尝试了几件事（做一会儿，如果），但似乎没有一种方法有效。这是如何引起的，我该如何解决？

下面是源代码：

```
// Test for primes 2
import java.io.*;
class FindPrime2    {
public static void main(String args[])  
throws IOException  {

//      int num;
    boolean isPrime;
    String str;

    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));

    System.out.println("\nFINDING PRIME NUMBERS v0.1");
    System.out.print("\nPlease enter a number: ");

    str = br.readLine();
    if(str == "q") System.exit(1);

    int num = Integer.valueOf(str);

    System.out.println("You have picked: " + num);

    if(num < 2) isPrime = false;
    else isPrime = true;

    for(int i=2; i <= num/i; i++)   {
        if((num % i) == 0)  {
            isPrime = false;
            break;
        }
    }

    if(isPrime) System.out.println(num +" is Prime.");
    else System.out.println(num + " is not Prime.");
} 
```

}

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T03:11:23.803

你不能`==`在字符串上使用。你必须使用`.equals()`; 如果您不关心区分大小写，可以使用`.equalsIgnoreCase ()`

`==`运算符比较while`REFERENCES`比较`.equals ()`字符串`CONTENTS`

关于`==`：

比较运算符`==`不仅适用于布尔值。会发生什么：

```
 int a = 5;
 int b = 5;

 //What will this display?
 a == b ? System.out.print (” True”) : System.out.print (” false”); 
```

在以下情况下使用`.equals()`：

*明确检查相等的值

*当您想检查 ; 的相等性`objects`时 但前提是该对象覆盖并定义了该`.equals ()`方法。

# drupal - Drupal6 option_images 模块：上传但不显示某些属性集的图像

> ID：10843897
> 
> 赞同：1
> 
> 时间：2012-06-01T03:08:04.420
> 
> 标签：drupal, drupal-6, drupal-modules

这是一个非常具体且极具挑战性的问题。我知道我找到其他有此问题的人的机会很小，但我必须尝试。我难住了。

我正在使用 Drupal 6、Ubercart 和 Option Images 模块。我希望它在选择不同的属性时切换产品图像。

这适用于某些图像，但不适用于其他图像。它似乎与属性集有关，与图像文件无关——我在许多属性集上尝试过相同的图像。我还尝试创建不同的属性集，看看我是否可以弄清楚属性的哪些方面导致 option_images 不起作用。到目前为止没有运气。

**问题**

*   对于某些属性组，选项图像将上传，但它们不会显示在产品页面上。

**我学到的东西**

*   即使对于显示损坏 option_images 行为的产品，也会上传图像。我在文件表和文件系统的数据库中看到它们。
*   我可以在产品页面上看到一个数组：'$node->option_images'。该数组是为工作产品页面填充的，而不是为不显示选项图像的产品页面填充的。
*   当我打开数据库调试器时，我可以看到正在查询数据库（uc_option_image_load）。但是，在损坏的页面上，它会查询错误产品的图像。（例如：当它在瑞士杏仁页面上时，它会寻找锋利的切达干酪选项图像）这些产品使用不同的属性集。

**截图**

![看，图片上传正常。](../Images/57db12ca9d54d0bf77b593ec706e0f52.png) ![但它不会在产品页面上显示选项图像（注意空白数组）](../Images/1e9167138eb8351e311cf260ca2e9e4b.png) ![错误产品的数据库查询](../Images/1f1002cc79606a4a9eeb75345bd8944a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T03:43:22.703

我找到了。它允许我上传和预览 option_images 的事实让我走错了路。它实际上是一个启用和禁用选项图像属性的设置。

设置在这里：admin/store/settings/attributes

我认为这是一个可用性错误，因为让我上传禁用属性的图像让我很困惑。但不管怎么说。解决了。

现在严重质疑 Drupal 的方式。

# objective-c - 为什么数组通过引用传递，但结构在C中隐式传递值？

> ID：10843904
> 
> 赞同：5
> 
> 时间：2012-06-01T03:08:51.173
> 
> 标签：objective-c, c, linux

他们为什么要这样设计？我很困扰。

更新：我真的很想知道这个问题的答案。我用谷歌搜索，但我找不到任何有用的东西。

我觉得可能有两个原因：

**一**：技术。也许编译器很难实现（结构通过引用传递）。如果答案是这个。请解释一下。

**二**：适合使用（编程）。我认为，如果 struct 通过引用传递，它会更优雅（或更漂亮？）。我找不到一些显示优势的例子（strut pass by value）。我的编程生涯并不长。在实践中，我更喜欢将 struct 作为指针传递给函数（指针在堆栈上占用的空间更少）。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-06-01T03:13:42.563

您可以将数组想象为一个包含连续内存位置的集合，其中数组的名称作为指向该集合的第一个内存地址的指针。

所以现在应该很明显了，当您通过数组的名称传递数组时，实际上是在传递该内存地址的副本。

然而，结构是一组对象，因此当您传递结构名称时，您传递的是该集合中对象的副本。

PS：这是一个非常基本的 C 概念和一个明显的疑问，最好阅读一本好的 C 书籍以进一步清除您的概念。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-06-01T03:22:01.847

数组传递，其实就是按值传递地址。在 c 中，没有通过引用传递。

我认为不传递数组的整个值的原因是

首先，性能。

其次，由于我们可以将指针用作数组，编译器无法知道指针指向的内存大小，因此无法将数组中的所有值传递给函数。C绝对可以设计为知道数组的确切大小，并传递数组的值。但是，我们不能以数组方式使用指针，我们不能使用任何malloc数组。

# pubnub - PubNub 在两个私人频道之间发布消息

> ID：10843909
> 
> 赞同：18
> 
> 时间：2012-06-01T03:09:53.883
> 
> 标签：pubnub

我正在使用 PHP 和 MySQL。

我刚刚注册了 pubnub 推送 API，并使用 Pubnub 提供的 PHP 推送 API 成功发出了我的第一个推送通知。我是这种实时技术的新手，所以我提出了一些我觉得难以理解的问题。我用谷歌搜索了很多次，并在stackoverflow上进行了搜索。我在其他地方没有得到任何相关的建议或问题，所以我在这里写下我的问题，寻求您的建议和专业知识的帮助。

Pubnub 表示，为每个客户创建两个以上的频道并不是一件好事。因此，在我的应用程序中，我需要创建两个以上的频道来收听我网站上各处发生的通知，但我将为每个登录用户使用两个频道，正如 Pubnub 建议的那样。

1.  登录用户收听 Channel1-Public

2.  登录的用户收听私有的 UsersOwnDynamic-Channel 以接收相关的通知，并且只针对他。

仅供参考：[PubNub 中的此链接说有关创建 LongChannel 名称以避免 Channel Snooping](https://help.pubnub.com/entries/21115547-how-do-i-allow-only-certain-users-to-subscribe-to-certain-channels)

我的问题如下：
A. 每次登录网站时，我是否总是需要创建一个新的私人动态频道名称。如果是这样，其他用户如何知道如何向我的私人频道发送通知。或者，我是否只需要在数据库表中存储一个静态频道名称，以便其他经过身份验证的用户查询该表并获取我的私人频道向我发送通知的名称。如果是这样，你不认为如果黑客掌握了某些用户的一些私人频道名称，他们将能够收听该频道吗？

BI 正在使用 PHP 和 MySQL，所以我仍然无法想出办法或想出一个解决方案来将消息发送到另一个用户的私人频道。
让我们以一个简单的好友请求系统为例。
- UserA 向 UserB 发送好友请求。
- UserB 正在收听他自己的名为 DynamicPrivateChannelB 的动态私人频道名称
（UserA 将如何找到 UserB 的私人频道名称？我认为唯一的方法是 UserB 的私人频道应该存储在每个数据库表中登录用户查询。我的想法是否正确？）

```
<?php 

    //first way. How can i possibly achieve this.
    $sqlquery = "sent friend request from userA to userB"; 
    require('Pubnub.php'); 
    $pubnub = new Pubnub( 'pubkey', 'subkey' );
    $pubnub->publish( array(
        'channel' => 'how do i find the private channel name for userB to sent this notification?', 
                    'message' => array('friend_request' => 'A friend request') ) 
                    );

  //2nd way ? Is this the right way ?
    $sqlquery = "sent friend request from userA to userB"; 
    $privatechannelofuserB = "get the channel name of userB from the db table";
    require('Pubnub.php'); 
    $pubnub = new Pubnub( 'pubkey', 'subkey' );
    $pubnub->publish( array(
        'channel' => '$privatechannelofuserB', 
                    'message' => array('friend_request' => 'A friend request') ) 
                    );
?> 
```

C. 如果我们总是生成动态私有频道名称，存储在数据库表中，每当生成新的动态频道名称时进行更新。我认为这会导致问题，因为某些消息不会被传递，因为新的动态私人频道名称会替换旧的。

D. 所以，我有很多通知要发送到一个单一的频道，比如新朋友请求、新私人消息回复、新礼物请求和许多其他类似的。如何将所有这些数据发送到通道以及如何找出和解析传入的新通知数据。我知道 JSON 是发送的格式，但我不确定发送的格式。

根据[此链接](https://help.pubnub.com/entries/21115547-how-do-i-allow-only-certain-users-to-subscribe-to-certain-channels)，单个 Pubnub 频道最多只能包含 100 条消息。这是否意味着如果 200 条消息同时发送到单个通道，则前 100 条消息被传递，其余消息在队列中？如果 10,000 条消息同时发送到一个频道会怎么样？是否所有剩余的消息都留在队列中？如果是这样，它如何实时交付给订户？

让我给出另一个我想要实现的简单场景。

> *   **UserA**已通过身份验证并登录到网站。
>     
> *   **UserA**生成自己的动态频道名称，**UserAx732dsw3efsdfsdfsdf**
>     
> *   **UserA**开始收听他新创建的频道**UserAx732dsw3efsdfsdfsdf**
>     （现在​​，userA 应该开始接收来自其他人的消息）
>     
> 
> - **UserB向****userA**发送私人消息。
> （现在，只有 userA 应该在他的私人频道上收到关于新私人消息的通知，userB 或系统如何**找到** 频道**名称**UserAx732dsw3efsdfsdfsdf**因为**，这是一个由**userA**动态生成的私人频道，**系统**或 **userB**都没有访问过同样的事情也发生在**userB 身上**，如果**userB**应该被任何其他实体或系统再次通知，应该有办法找出**userB**的动态频道名称。
> 
> 另一个问题是这种情况是，如果用户每次登录网站时都动态生成频道名称。发送到动态通道的所有消息会发生什么？pubnub 是否将所有创建的频道名称保存在其服务器上？有没有什么方法可以让系统或用户找出频道名称是否仍然是自己的，并且至少有一个用户正在收听频道？
> 
> 我很想知道这一点，因为我有以下概念：
> 
> *   **UserA在****凌晨 1**点登录网站时创建了**dynamicChannelA**。
> ***   UserA 开始收到大量通知推送到他的动态频道**dynamicChannelA**
>     *   现在，**UserA在****凌晨 1:30**从网站注销，许多其他仍在向他的**dynamicChannelA推送通知的用户会发生什么，因为当****UserA**下次 登录网站时，**UserA**将监听不同的动态频道名称。**UserA**不会收听他以前的频道**dynamicChannelA**。**

 **我正在考虑使用从数据库表中检索特定用户的频道名称的方法。是否有任何方法或方法可以防止未经授权的频道订阅？因为任何人都可以订阅频道名称，只要他们有订阅密钥和频道名称，无论频道名称有多长。我只是好奇，因为所有订阅都发生在客户端，并且订阅密钥和频道名称是可见的。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-06-04T18:48:17.703

没有一种方法可以解决您遇到的问题。我们的客户使用了各种各样的设计模式来处理它们。我自己在构建 PubNub 应用程序时遇到过这种类型的事情，我会尽可能地帮助你。

> Pubnub 表示，为每个客户创建两个以上的频道并不是一件好事。因此，在我的应用程序中，我需要创建两个以上的频道来收听我网站上各处发生的通知，但我将为每个登录用户使用两个频道，正如 Pubnub 建议的那样。
> 
> 登录的用户收听 Channel1-Public 登录的用户收听私有的 UsersOwnDynamic-Channel 以接收相关的通知，并且只针对他。

这是一个很好的方法，我们的许多大规模客户都是这样做的。一个全球频道和一个私人的、仅限用户的频道。

# 一个。

> 每次登录网站时，我总是需要创建一个新的私人动态频道名称吗？

不一定，虽然这是一个好方法。您可以`PUBNUB.uuid()`在客户端的 JavaScript 中使用来执行此操作。或者，使用 PHP 在服务器端生成它并将其呈现给客户端。也许您可以将其设置为 cookie，以便客户端始终可以访问它。

> 如果是这样，其他用户怎么知道如何向我的私人频道发送通知。

他们可以从 PHP 服务器获取 id；通过他们正在收听的全局频道或用户自己的私人频道。

> 或者，我是否只需要在数据库表中存储一个静态频道名称，以便其他经过身份验证的用户查询该表并获取我的私人频道名称以向我发送通知。

你也可以这样做。您可能拥有用户可以发送的全局频道，而不是他们正在收听的全局频道。只有服务器具有**该**订阅密钥。因此，经过身份验证的用户向服务器发送一条消息，告诉它“我需要适当的用户密钥”，然后服务器进行查询并在该用户的私人频道上发回一条消息。

> 如果是这样，你不认为如果黑客掌握了某些用户的一些私人频道名称，他们将能够收听该频道吗？

如果您在全局发送通道上保留订阅密钥，则只有服务器可以看到该通道上的聊天。

# B.

> 我使用 PHP 和 mysql，所以我仍然想不出办法或想出一个解决方案来将消息发送到另一个用户的私人频道。让我们以一个简单的好友请求系统为例。- UserA 向 UserB 发送好友请求。- UserB 正在收听他自己的名为 DynamicPrivateChannelB 的动态私人频道名称（UserA 将如何找到 UserB 的私人频道名称？我认为唯一的方法是 UserB 的私人频道应该存储在每个数据库表中登录用户查询。我的想法是否正确？）

这与您之前的问题非常相似。没有一种方法可以做到这一点，但我上面概述的设计模式应该可以工作。回顾一下这个设计模式：

## 服务器端

*   在 Global-user-send-channel 上侦听用户消息。服务器是唯一拥有此订阅密钥的实体
*   可以查询db获取user-ids，然后随意发送到各个ids
*   也可以在所有客户端都在监听的 Global-user-receive-channel 上发送。服务器是唯一拥有此发布密钥的实体。

## 客户端

*   在 Global-user-receive-channel 上收听。这就是它获得大量服务器广播的方式。无法在此频道上发送（只有订阅密钥）
*   在 Global-user-send-channel 上发送服务器消息。无法在此频道上接收（只有发布密钥）
*   收听私人用户频道。这就是用户获取私人消息的方式。它还可以将其用于客户端到客户端的通信。
*   通过在所有私人消息中附加一个存储在服务器上并在初始页面加载期间提供的每个用户的私有密钥来防止滥用。这样，客户端就知道声称来自服务器的消息是否合法。

# C。

> 如果我们总是生成动态私有频道名称，存储在数据库表中，每当生成新的动态频道名称时进行更新。我认为这会导致问题，因为某些消息不会被传递，因为新的动态私人频道名称会替换旧的。

如果您在生成新频道名称时很小心，这应该不是问题。请记住，客户总是可以在 Global-user-send-channel 上说“嘿，我在这里！这是我的身份证。让我更新'。我通常将我的应用程序设计为让客户每 30 秒左右自动喊出这一点。

# D.

> 所以，我有许多通知要发送到单个频道，例如新朋友请求、新私人消息回复、新礼物请求和许多其他类似的通知。我如何将所有这些数据发送到通道以及如何找出和解析传入的新通知数据。我知道 JSON 是发送的格式，但我不确定发送的格式。

JSON 适合发送和接收。我这样做的方法是拥有一个名为“name”的属性，它定义了它是什么类型的消息。例如：

```
{
    "id"   : "blah_blah_unique_id",    // sender_client_id 
    "name" : "friend_request",         // type of message
    "data" : {                         // the data itself
               "requested_friend_id" : "blah_blah_some_other_unique_id" 
             }
} 
```

您实际上可以使用您想要的任何格式，但是当它通过 PubNub 推送时，我们会将它包装在 JSON 中（通常这意味着只用引号括起来）。

希望这可以帮助！

## 新问题

> 根据[此链接](https://help.pubnub.com/entries/21115547-how-do-i-allow-only-certain-users-to-subscribe-to-certain-channels)，单个 Pubnub 频道最多只能包含 100 条消息。这是否意味着如果 200 条消息同时发送到单个通道，则前 100 条消息被传递，其余消息在队列中？如果 10,000 条消息同时发送到一个频道会怎么样？是否所有剩余的消息都留在队列中？如果是这样，它如何实时交付给订户？

100 条消息限制与 PubNub.history 相关。如果有人订阅了 200 条消息，他们将收到全部 200 条消息。

> （现在，只有 userA 应该在他的私人频道上收到关于新私人消息的通知，userB 或系统如何找到频道名称 UserAx732dsw3efsdfsdfsdf 因为，这是一个由 userA 动态生成的私人频道，系统或 userB 都没有访问过同样的事情也发生在 userB 身上，如果 userB 应该被任何其他实体或系统再次通知，应该有办法找出 userB 的动态频道名称。

这个问题没有万能的解决方案，但我要做的是让服务器在页面加载时生成该唯一 ID，并在您的初始 HTTP 请求中将其呈现给客户端。

> 另一个问题是这种情况是，如果用户每次登录网站时都动态生成频道名称。发送到动态通道的所有消息会发生什么？pubnub 是否将所有创建的频道名称保存在其服务器上？

您不必每次都动态生成。您可以....但是您还设置了具有该唯一 ID 的 cookie，或者将其从数据库中提取并在页面加载时将其呈现给客户端（这就是我要做的）。我们不保存频道名称。

> 有没有什么方法可以让系统或用户找出频道名称是否仍然是自己的，并且至少有一个用户正在收听频道？

不是开箱即用，但您可以轻松实现。只需让您的服务器发送一个 ping 并将您的客户端设置为在他们正在收听时始终响应 ping。

> 现在，UserA 在凌晨 1 点 30 分从网站退出，许多其他仍在向他的 dynamicChannelA 推送通知的用户会发生什么，因为当 UserA 下次登录网站时，UserA 将监听不同的动态频道名称.UserA 不会收听他之前的频道 dynamicChannelA 。

您可以防止这种情况的方法是定期（每 30 秒？）来自服务器的 ping，如果用户仍然在那里，谁可以跟踪。顺便说一句，在接下来的几个月里，我们将推出一个在线状态 API 来自动执行此操作。

> 我正在考虑使用从数据库表中检索特定用户的频道名称的方法。是否有任何方法或方法可以防止未经授权的频道订阅？因为任何人都可以订阅频道名称，只要他们有订阅密钥和频道名称，无论频道名称有多长。我只是好奇，因为所有订阅都发生在客户端并且订阅密钥和频道名称是可见的

主要方式是战略性地保留发布/订阅密钥。你是对的，任何有适当细节的人都可以收听——这是纯客户端系统的一个大问题。目前，您必须想出一些创造性的方法来解决它。**

# android - 简单的安卓活动

> ID：10843913
> 
> 赞同：0
> 
> 时间：2012-06-01T03:10:09.127
> 
> 标签：android, eclipse

我正在eclipse中创建一个android应用程序，出于某种原因，.AgainActivity总是启动而不是.Splash。我删除了 .AgainActivity 并在模拟器中运行它并且 .Splash 工作，但是当两个活动都存在时它不会首先运行。

有谁知道我需要做什么？

AndroidManifest XML：

```
<application
    android:icon="@drawable/test_logo"
    android:label="@string/app_name" >
    <activity
        android:label="@string/app_name" 
        android:name=".Splash">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <activity
        android:label="@string/app_name" 
        android:name=".AgainActivity">
        <intent-filter>
            <action android:name="again.we.practice.AgainActivity" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>

</application> 
```

飞溅Java：

```
package again.we.practice;

import android.app.Activity;
import android.os.Bundle;

public class Splash extends Activity{

@Override
protected void onCreate(Bundle National) {
    // TODO Auto-generated method stub
    super.onCreate(National);
    setContentView(R.layout.splash);
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:20:05.270

在您拥有的第一个活动标签的 xml 文件顶部

```
 android:name = ".splash" 
```

将其更改为

```
 android:name = ".AgainActivity" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:28:09.837

`AndroidManifest.xml`根据它，您是正确的，Splash`Activity`应该首先显示，因为它是主要的。

或者只是尝试删除如下`<intent-filter>`，`AgainActivity`

```
<activity android:name=".AgainActivity"
          android:label="@string/app_name">
</activity> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T03:59:27.013

只需从 AgainActivity 中删除意图：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="again.we.practice"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="15" />
<application
    android:icon="@drawable/test_logo"
    android:label="@string/app_name" >
    <activity
        android:label="@string/app_name" 
        android:name=".Splash">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <activity
        android:label="@string/app_name" 
        android:name=".AgainActivity">
     </activity>

</application>
</manifest> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-06-01T04:00:46.390

试试这个

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="again.we.practice"   //package name
android:versionCode="1"
android:versionName="1.0" >
<uses-sdk android:minSdkVersion="8" /> //your minsdkversion level
<application
    android:icon="@drawable/ic_launcher" android:label="@string/app_name" >        
      <activity
        android:label="@string/app_name"  android:name=".Splash"   
        android:theme="@android:style/Theme.NoTitleBar.Fullscreen">    

        <intent-filter >
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>            
        </activity>    
        <activity android:name = ".AgainActivity" />                         
</application> 
```

# c# - 使用 C# P/Invoke 方法在 Struct 内编组数组

> ID：10843920
> 
> 赞同：0
> 
> 时间：2012-06-01T03:11:19.530
> 
> 标签：c#, c++, c, pinvoke, marshalling

我用C写了一个这样的结构

```
struct IMAGE {
    unsigned int    x, y;
    unsigned char   **data;
}; 
```

谁能告诉我如何编组这个结构以在 C# 中使用？

我的解决方案不起作用。

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public class IMAGE
{
            public UInt32 x;
            public UInt32 y;

            public byte[][] data;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:53:59.803

托管数组不同于指针。托管数组需要数组的大小，如果您尝试编组结构，则需要固定大小才能直接编组。

您可以使用[属性](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx)`SizeConst`的参数来设置封送数据时的大小。[`MarshalAs`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx)

但我猜这是图像的尺寸，尺寸`x`取决于这些变量。这里最好的解决方案是将其编组为 an并在需要时访问数据：`y``data``IntPtr`

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public class IMAGE
{
    public UInt32 x;
    public UInt32 y;

    private IntPtr data;

    public byte[][] Data
    {
        get
        {
            byte[][] newData = new byte[y][];

            for(int i = 0; i < y; i++)
            {
                newData[i] = new byte[x];
                Marshal.Copy(new IntPtr(data.ToInt64() + (i * x)), newData[i], 0, x);
            }

            return newData;
        }

        set
        {
            for (int i = 0; i < value.Length; i++)
            {
                Marshal.Copy(value[i], 0, new IntPtr(data.ToInt64() + (i * x)), value[i].Length);
            }
        }
    }
} 
```

如果您被允许使用不安全的代码，您可以将其更改`IntPtr`为 a`byte**`并直接使用它。

使用 setter，您可能希望在盲目写入非托管内存之前验证值的维度。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-06-01T03:53:10.050

我的猜测是：

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public class IMAGE
{
            public UInt32 x;
            public UInt32 y;

            public ref IntPtr data;
}; 
```

一个非常方便的参考是 p/invoke[备忘](http://khason.net/blog/pinvoke-cheat-sheet/)单。

# graph - Cypher Query 从两个关系中获取连接的节点

> ID：10843922
> 
> 赞同：0
> 
> 时间：2012-06-01T03:11:24.427
> 
> 标签：graph, nodes, neo4j, cypher

我是 Neo4j/GraphDB 的新手，并创建了以下简单图表

node[1]user1 是 node[2]user2 和 node[3]user3 的“朋友”，上面的所有 3 个用户也有“post”节点连接到它们。

问题是如何获取 user1 的已连接朋友及其帖子？

以下查询仅返回 user1 的朋友和他的帖子...

```
START user1=node(2) MATCH user1-->all_node RETURN all_node 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T04:46:20.597

根据您选择的关系类型，这样的事情应该有效：

```
START user1=node(2) 
MATCH user1-[:FRIEND]->friend-[:POST]->post 
RETURN friend,post 
```

# ios - flash.display.Loader class on iOS

> ID：10843923
> 
> 赞同：0
> 
> 时间：2012-06-01T03:11:25.670
> 
> 标签：ios, actionscript-3, flash, air, flash-cs5

**Intro** - I am working on a iOS game using Flash CS5.5\. In my game i am loading a image via the camera roll, and gonna use the image in the gameplay. I want the image to load back in when the user restarts the game.

**Question** - Is there a way to access such image again without having to open up the camera roll interface.

Can i use the flash.display.Loader class? Is there any special things i need to do or set? Or is there another way?

I've tried just saving the file, given from the MediaEvent dispatched when you select an image.

But i have no luck using the URL given in the loader object. I am using the example from this page as my base: [http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/CameraRoll.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/CameraRoll.html).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T07:22:50.480

是的，这是可能的。您需要使用 File 类将图像保存到应用程序文档目录中，如下所示：（这使用 Adob​​e JPGEncoder 类）

```
f = File.documentsDirectory.resolvePath("logo.jpg"); 

stream = new FileStream();
stream.open(f, FileMode.WRITE);                                         

j = new JPGEncoder(80);
var bytes:ByteArray = j.encode(visualLogo.bitmapData);
stream.writeBytes(bytes,  0, bytes.length);
stream.writeBytes(bytes, 0, bytes.bytesAvailable);
stream.close();

//I read the file back in to test that it has been successfully written 
stream.openAsync(f, FileMode.READ); 
stream.addEventListener(Event.COMPLETE, bringBoardOn, false, 0, true); 
```

然后使用以下内容将其加载回：

```
f = File.documentsDirectory.resolvePath ("logo.jpg");

if (f.exists == true) {

var _urlRequest:URLRequest = new URLRequest(f.url);
loader=new Loader;
loader.load(_urlRequest);
loader.addEventListener(IOErrorEvent.IO_ERROR, function(e:IOErrorEvent):void{ trace(e) });
loader.contentLoaderInfo.addEventListener(Event.COMPLETE, ImageLoaded, false, 0, true);     
_urlRequest = null;

} 
```

# python - 在 appengine 中测试 error_handlers

> ID：10843927
> 
> 赞同：2
> 
> 时间：2012-06-01T03:12:26.507
> 
> 标签：python, google-app-engine

我在应用引擎 app.yaml 文件中添加了以下错误处理程序：

```
error_handlers:
- file: default_error.html 
```

然后我计划用强制 DeadlineExceededError 对其进行测试

所以我有一个请求处理程序：

```
class Timeout(webapp.RequestHandler):
  def get(self):
    count=100
    if self.request.get('count'):
        count=int(self.request.get('count'))
    time.sleep(count) 
```

我打电话给[http://20-social.race-timing-failsafe.appspot.com/timeout?count=100](http://20-social.race-timing-failsafe.appspot.com/timeout?count=100)我希望我的 default_error.html 文件被显示。

相反，我看到：

```
A server error occurred.  Please contact the administrator. 
```

这可能是由于通过 time.sleep 超过了人为的最后期限造成的。它似乎适用于语法错误情况和“实际”期限超过消息（例如，写入数据存储时超时），并希望超过配额。

是什么导致了`A server error occurred. Please contact the administrator.`消息？它来自哪里？我搜索了google appengine sdk python代码，没有找到。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-10T02:24:04.477

该错误消息不是原始的 Google 错误消息，因此看起来您的堆栈中的其他内容正在捕获异常并给出响应。

只有在应用程序的任何地方都没有捕获到异常时，才会提供默认错误处理程序。

例如，在你启动任何 webapp 之前粘贴一个 raise StringError 看看会发生什么;-)

# c# - 使用 Linq to SQL 更新对象

> ID：10843928
> 
> 赞同：0
> 
> 时间：2012-06-01T03:12:31.903
> 
> 标签：c#, asp.net, sql, linq, linq-to-sql

我正在尝试为 asp.net 应用程序编写一些业务层逻辑来插入或更新对象。我从业务层中获取一个对象，然后将其传回以保存到数据库中。数据上下文包含在业务层中，我认为这是导致异常的原因。

例外情况是“已尝试附加或添加一个不是新的实体，可能是从另一个 DataContext 加载的。不支持。”

我确定我错过了一些小设置，但我不确定是什么。

这是进行插入和更新的代码....

```
public static void Save(Order order)
{
        using (TicketInformationDataContext db = new TicketInformationDataContext())
        {                
            if (order.OrderID <= 0)
                db.Orders.InsertOnSubmit(order);
            else
            {
                db.ObjectTrackingEnabled = true;
                ITable table = db.GetTable(typeof(Order));
                table.Attach(order, true);
                db.Orders.Attach(order, true);
            }
            db.SubmitChanges();
        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T05:09:32.597

我相信您的问题是您正在创建单独的上下文来加载订单并稍后保存它。

您应该设计您的存储库以针对您可以在构建期间传递的上下文工作（或者最好通过 IoC 注入）。这样，两个操作都将针对相同的上下文工作。

请记住，实体绑定到它们的上下文，尝试混合它们会导致各种问题，尤其是延迟初始化或关联实体。

请参阅[此类似问题](https://stackoverflow.com/questions/2473795/linq-to-sql-add-update-in-different-methods-with-different-datacontexts)的已接受回复，其中讨论了存储库设计和工作单元设计模式。

# python - 使用 Python 进行元组和列表操作。缩短元组生成

> ID：10843929
> 
> 赞同：2
> 
> 时间：2012-06-01T03:12:48.333
> 
> 标签：python, list, variables, tuples

在我的家庭作业中真的遇到了这个问题。

`' '`一切正常，但是当`p`. 我需要停止创建`can`.

例如，如果我提交：

```
rankedVote("21 4", [('AB', '132'), ('C D', ''), ('EFG', ''), ('HJ K', '2  1')]) 
```

我想拥有：

```
['C D', 'AB'] 
```

回来了，而不是`[]`像现在这样。

代码如下：

```
def rankedVote(p,cs):
    candsplit = zip(*cs)
    cand = candsplit[0]
    vote = list(p)
    ppl = vote
    can = list(p)
    for i in range(len(vote)):
        if ' ' in vote[i-1]:
            return []
        else:
            vote[i] = int(vote[i])
            can[vote[i]-1] = cand[i]

    for i in range(len(vote)):
        for j in range(len(vote)):
            if i != j:
                if vote[i] == vote[j]:
                    return []
    return can 
```

**编辑：**

在示例中：

```
rankedVote("21 4", [('AB', '132'), ('C D', ''), ('EFG', ''), ('HJ K', '2  1')]) 
```

这意味着第 1`AB`个变成第 2 个，第 2 个`C D`变成第 1 个，它应该停止，因为第 3 个不存在。

假设它不是`21 4`，而是`2143`。这意味着第三个`EFG`将是第四个，第四个`HJ K`将是第三个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-01T03:35:23.593

代码按照您的指示执行。看下面的代码块：

```
if ' ' in vote[i-1]:
            return [] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T22:41:31.007

我知道这个问题很老，但我发现它很有趣。

就像[之前的答案](https://stackoverflow.com/a/10844070/590904)所说的那样，您直到那时还没有返回列表，您正在返回`[]`.

你应该做的是：

```
if ' ' in vote[i]:
    return can[:i] 
```

此外，由于您似乎知道如何使用`zip`，您也可以这样做：

```
def rankedVote(p,cs):
    cand = zip(*cs)[0]

    # get elements before ' ' 
    votes = p.split()[0] # '21'

    # map votes index order with corresponding list order
    # (number of `cands` is determined by length of `votes`)
    cans = zip(votes, cand) # [('2', 'AB'), ('1', 'C D')]

    # Sort the results and print only the cands
    result = [can for vote, can in sorted(cans)] # ['C D', 'AB']
    return result 
```

输出：

```
>> rankedVote("21 4", [('AB', '132'), ('C D', ''), ('EFG', ''), ('HJ K', '2  1')])
['C D', 'AB']
>> rankedVote("2143", [('AB', '132'), ('C D', ''), ('EFG', ''), ('HJ K', '2  1')])
['C D', 'AB', 'HJ K', 'EFG'] 
```

# c++ - 在线游戏的会话通常如何存储？

> ID：10843935
> 
> 赞同：1
> 
> 时间：2012-06-01T03:13:40.590
> 
> 标签：c++, tcp

目前，我的游戏是这样工作的。

用户使用 TCP 连接到服务器。此时，服务器尚未分配播放器对象并将其分配给 TCP 客户端对象。

当用户发送带有用户名和密码哈希的 LOGIN 消息时，服务器会检查数据库以查看所有内容是否相加，如果相加，则发送 LOGIN_ATTEMPT_RESULT 消息为 true。然后服务器分配一个玩家，然后向玩家发送大厅的状态，从那时起，当服务器从该用户那里收到消息时，它会处理它并进行通信。

我不保留会话 ID 或任何东西，因为它似乎没有必要。

这基本上是这样的游戏如何进行身份验证和通信，还是我错过了一些重要的东西？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T03:21:56.597

保留会话 ID 很好，因为它使 TCP 数据包注入攻击（序列猜测）更加困难，并且即使 TCP 连接由于某种原因丢失，它也允许登录的连续性。这样，“会话”和“连接”是不同的，后者可以根据需要重新建立。此外，如果您扩展到多台机器，会话 ID 可以用作在主机之间传递的一种方式（将重新创建连接，但会话仍然存在）。最后，会话 ID 可以用作数据库键（同样，用于在服务器之间传递）。

如果您不需要这些，那么您可以放弃会话层。不过，似乎节省不了多少。

# iphone - iOS - PayPal 集成 - “无效参数小计”错误

> ID：10843942
> 
> 赞同：2
> 
> 时间：2012-06-01T03:15:45.660
> 
> 标签：iphone, ios, paypal

我试图将 PayPal 集成到我的 iPhone 应用程序中。但是，当我点击沙盒环境的“使用贝宝付款”按钮时，如果总金额大于 10,000 美元，则会显示显示“无效参数 subTotal”的警报。

如果总金额小于 10,000 美元，则应用程序会正确显示 PayPal 的视图。

任何人都可以请提出这个问题的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-02T05:46:33.110

PayPal 将拒绝任何 10,000 美元的交易。限制因国家/地区而异，还取决于用户是否经过“验证”。显然，您甚至不能使用 PayPal 在 eBay 上进行超过 10,000 美元的交易。

# algorithm - Moravec角检测器的伪代码

> ID：10843943
> 
> 赞同：1
> 
> 时间：2012-06-01T03:16:19.743
> 
> 标签：algorithm, computer-vision, pseudocode

我正在为 Moravec 角检测器寻找一些伪代码。

我希望将伪代码作为理解算法工作原理的一种手段。

代码的语法并不重要，但是解释每个组件正在做什么的注释会很有用。我希望清楚地说明该算法。

假设图像 im[y,x] 由 y(row) 和 x(column) 索引。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-03T19:36:10.750

您应该查看为[JFeatureLib](http://code.google.com/p/jfeaturelib/)实现的[Moravec.java](http://code.google.com/p/jfeaturelib/source/search?q=moravec&origq=moravec&btnG=Search%20Trunk)。

# javascript - 验证字段长度

> ID：10843945
> 
> 赞同：0
> 
> 时间：2012-06-01T03:17:01.933
> 
> 标签：javascript

我希望我的卷号长度应该等于 4 并且插入的数据只能是整数..

怎么可能通过java脚本

我正在尝试此代码，但它只是在检查它，如果卷号大于 4，则会显示错误，但也会插入卷号

```
function rollnumber(elem, min, max){

    var uInput = elem.value;
    if(uInput.length >= min && uInput.length <= max){
        return true;
    }else{
        alert(" nter between " +min+ " and " +max+ " characters");
        elem.focus();
        return false;
    }

}
rollnumber(document.getElementById('rollnumber'), 1, 4);

return true; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:53:37.370

1.  它混淆了javascript`rollnumber`既是函数名又是元素ID。
2.  该功能需要在提交时在表单上执行，否则它将继续提交而不是停止
3.  这是固定代码。经测试。

    ```
    <form onsubmit="e_rollnumber()">
        <input type="text" id="rollnumber" />
        <input type="submit" value="Click here to roll the number" />
    </form>

    <script type="text/javascript">
        function e_rollnumber(){
            var len = {min:1,max:4};
            var input = document.getElementById('rollnumber');

            if(input.value.length>=len.min && input.value.length<=len.max) return true;
            alert("Please enter between " +len.min+ " and " +len.max+ " characters");
            input.focus();
            return false;
        };
    </script> 
    ```

# r - for循环在r中输出不同的对象

> ID：10843946
> 
> 赞同：1
> 
> 时间：2012-06-01T03:17:03.483
> 
> 标签：r, object, if-statement

我正在尝试使用 for 从 for 创建多个对象，只是示例（不准确）：

```
l_gr <- list (1:10, 11:20, 21:30)
for (i in 1:length(l_gr)){
  grp <- NULL
  grp[[i]] <- mean(l_gr[[i]])
    } 
```

这不是我所期望的，而是我需要输出多个对象（不同类）但是名称与 i 级别不同，例如：这里 grp1、grp2、grp3。这些对象中的每一个都具有特定 i 列表的函数输出。对不起，简单的问题。

编辑：响应以提供具体示例：

```
install.packages("onemap")
require(onemap)
data(example.out)
twopts <- rf.2pts(example.out)
all.data <- make.seq(twopts,"all") 
link_gr <- group(all.data)
link_gr$n.groups 
```

开始循环

```
 # without loop: 
# for 1
grp1 <- make.seq(link_gr, 1)
grp1.od <- order.seq(input.seq=grp1, n.init = 5,  subset.search = "twopt", 
    twopt.alg = "rcd", THRES = 3, draw.try = TRUE, wait = 1, touchdown=TRUE) 

# for 2
grp2 <- make.seq(link_gr, 2)
grp2.od <- order.seq(input.seq=grp2, n.init = 5,  subset.search = "twopt",  
   twopt.alg = "rcd", THRES = 3, draw.try = TRUE, wait = 1, touchdown=TRUE) 
```

1:1 的相同进程报告：link_gr$n.groups

所以我想创建一个for循环和输出对象：

```
for (i in 1:link_gr$n.groups){
    grp <- NULL
  grp[i] <- make.seq(link_gr, i)
  grp[i].od <- order.seq(input.seq=grp[i], n.init = 5,  subset.search = "twopt",  
      twopt.alg = "rcd", THRES = 3, draw.try = TRUE, wait = 1, touchdown=TRUE)
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T08:50:59.583

请注意，您的 for 循环是错误的。如果您`grp <- NULL`在循环中设置，您只需在每次迭代时擦除结果变量 - 可能不是您想要的。您需要将变量初始化放在循环之外。

另请注意，我建议您最好使用单个变量而不是多个变量。`list`对象在 R 中非常灵活，可以容纳不同类的对象。你可以做

```
 require(onemap)
 data(example.out)
 twopts <- rf.2pts(example.out)
 all.data <- make.seq(twopts,"all") 
 link_gr <- group(all.data)
 link_gr$n.groups

   # initialise list outputs
 grp = list()
 grp.od = list()
 for (i in 1:2){
 grp[[i]] <- make.seq(link_gr, i)
 grp.od[[i]] <- order.seq(input.seq=grp[[i]], n.init = 5,  subset.search = "twopt", 
     twopt.alg = "rcd", THRES = 3, draw.try = TRUE, wait = 1, touchdown=TRUE) 
 }

 #check out output
 str(grp)
 str(grp.od)
 grp[[1]]
 grp[[2] 
```

如果您*必须*坚持使用不同的变量，请考虑`?assign`和`?get`。像这样的东西会起作用：

```
 i = 1
 assign(paste("grp", i, sep = ""), grp[[1]])
 exists("grp1")
 str(get(paste("grp", i, sep = ""))) 
```

# c++ - 将向量地址转换为本机指针是否安全？

> ID：10843949
> 
> 赞同：0
> 
> 时间：2012-06-01T03:17:47.890
> 
> 标签：c++, stl

我想在将向量地址传递给某些外部 API 调用之前将其传递给指针，这样做安全吗？潜在的问题是向量中的元素是否确保在内存中是连续的？

```
std::vector<Type> vT;
Type* p = (Type*)&vT[0]; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-06-01T03:18:43.487

是的，你甚至不需要投射它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-06-01T03:24:00.833

是的，`&v[0]`这样做是安全的，是的，这些元素在内存中是连续的。不过，我个人会使用[`v.data()`](http://en.cppreference.com/w/cpp/container/vector/data)，因为这样可以更好地传达这个想法（毕竟你想获得内部数组， *data ）。*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T03:43:51.903

在执行此操作之前，请确保该向量不为空。

`Type *p = ( vT.empty() ? NULL : &vT[0] );`

或者正如 Xeo 所指出的，新的库规范允许`.data()`成员函数做同样的事情（在您的实现中可能不可用）。

# php - PHP EVAL - 修复不安全性

> ID：10843950
> 
> 赞同：3
> 
> 时间：2012-06-01T03:17:50.460
> 
> 标签：php, eval

我们有一个系统必须执行用户输入提供的计算。

我发现进行其中一项计算的最简单方法是 eval - 试图找出一个解析器：

```
(3 + 6 ) / 2 + 27 * 5 / 2 
```

只是似乎很难。如果有人对此有解决方案 - 我很乐意听到。

假设您要使用 EVAL（我知道它是可怕的功能），允许他们在该框中键入任何他们想要的内容将是一个主要的不安全因素。

所以，我提出了一个问题，如果我做了一个正则表达式删除除了数字、标准运算符（+ - / *）和括号之外的所有内容，比如

```
$equation = preg_replace( '/[^0-9+-\/*()]/', '', $input_equation );
$result = eval( $equation ); 
```

系统是否可能发生任何损害？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T03:56:40.053

我最近编写了一个使用[BCMath](http://php.net/manual/en/book.bc.php)函数的[符合 PEDMAS 的解释器：](https://github.com/alixaxel/phunction/blob/4ff6f7d29262b489bc26abc6c3867760eafe9972/phunction/Math.php#L74)

```
function BC($string, $precision = 32)
{
    if (extension_loaded('bcmath') === true)
    {
        if (is_array($string) === true)
        {
            if ((count($string = array_slice($string, 1)) == 3) && (bcscale($precision) === true))
            {
                $callback = array('^' => 'pow', '*' => 'mul', '/' => 'div', '%' => 'mod', '+' => 'add', '-' => 'sub');

                if (array_key_exists($operator = current(array_splice($string, 1, 1)), $callback) === true)
                {
                    $x = 1;
                    $result = @call_user_func_array('bc' . $callback[$operator], $string);

                    if ((strcmp('^', $operator) === 0) && (($i = fmod(array_pop($string), 1)) > 0))
                    {
                        $y = BC(sprintf('((%1$s * %2$s ^ (1 - %3$s)) / %3$s) - (%2$s / %3$s) + %2$s', $string = array_shift($string), $x, $i = pow($i, -1)));

                        do
                        {
                            $x = $y;
                            $y = BC(sprintf('((%1$s * %2$s ^ (1 - %3$s)) / %3$s) - (%2$s / %3$s) + %2$s', $string, $x, $i));
                        }

                        while (BC(sprintf('%s > %s', $x, $y)));
                    }

                    if (strpos($result = bcmul($x, $result), '.') !== false)
                    {
                        $result = rtrim(rtrim($result, '0'), '.');

                        if (preg_match(sprintf('~[.][9]{%u}$~', $precision), $result) > 0)
                        {
                            $result = (strncmp('-', $result, 1) === 0) ? bcsub($result, 1, 0) : bcadd($result, 1, 0);
                        }

                        else if (preg_match(sprintf('~[.][0]{%u}[1]$~', $precision - 1), $result) > 0)
                        {
                            $result = bcmul($result, 1, 0);
                        }
                    }

                    return $result;
                }

                return intval(version_compare(call_user_func_array('bccomp', $string), 0, $operator));
            }

            $string = array_shift($string);
        }

        $string = str_replace(' ', '', str_ireplace('e', ' * 10 ^ ', $string));

        while (preg_match('~[(]([^()]++)[)]~', $string) > 0)
        {
            $string = preg_replace_callback('~[(]([^()]++)[)]~', __METHOD__, $string);
        }

        foreach (array('\^', '[\*/%]', '[\+-]', '[<>]=?|={1,2}') as $operator)
        {
            while (preg_match(sprintf('~(?<![0-9])(%1$s)(%2$s)(%1$s)~', '[+-]?(?:[0-9]++(?:[.][0-9]*+)?|[.][0-9]++)', $operator), $string) > 0)
            {
                $string = preg_replace_callback(sprintf('~(?<![0-9])(%1$s)(%2$s)(%1$s)~', '[+-]?(?:[0-9]++(?:[.][0-9]*+)?|[.][0-9]++)', $operator), __METHOD__, $string, 1);
            }
        }
    }

    return (preg_match('~^[+-]?[0-9]++(?:[.][0-9]++)?$~', $string) > 0) ? $string : false;
} 
```

它支持以下运算符：

*   `^`（战俘）
*   `*`
*   `/`
*   `%`（模数）
*   `+`
*   `-`
*   `=`, `==`, `<`, `<=`, `>`, `>=`（比较）

你这样称呼它：

```
echo BC('(3 + 6 ) / 2 + 27 * 5 / 2'); 
```

我这样做是为了有一种简单的方法来执行任意长度的计算，但在你的情况下，你不妨去掉所有空格并使用以下正则表达式验证字符：

```
if (preg_match('~^(?:[0-9()*/%+-<>=]+)$~', $expression) > 0) {
    // safe to eval()
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:37:10.003

这对我来说似乎更简单，但我还没有搜索过原生 PHP 解决方案。我会发布它只是为了踢球。

而不是 using `eval`，我想使用的第一件事是[`exec`](http://php.net/exec)调用[`bc`](http://linux.die.net/man/1/bc)并`bc`为我完成所有工作（假设您在 Linux 机器上）。

所以，你会做类似的事情（**非常**未经测试）：

```
$user_input = '(3 + 6 ) / 2 + 27 * 5 / 2';
$return = exec( 'echo "scale=1; ' . escapeshellarg( $user_input) . '" | bc', $output, $retval);

$calculation = $output[0];
if( !is_numeric( $calculation)) {
    echo "Invalid input!";
}
echo $calculation; // Outputs 72 
```

# javascript - 是否可以包含许多 .js 文件以使我的代码看起来模块化？

> ID：10843958
> 
> 赞同：0
> 
> 时间：2012-06-01T03:19:07.230
> 
> 标签：javascript, jquery

我有一个页面，其中几乎所有功能都使用 Ajax 请求。我有这么多行的js代码。剖析我的 js 代码并将其包含在我的页面中是否是一种好习惯，例如：

```
<script src="../js_code_func_1.js"></script>
<script src="../js_code_func_2.js"></script>
<script src="../js_code_func_3.js"></script>
<script src="../js_code_func_4.js"></script>
<script src="../js_code_func_5.js"></script> 
```

如果我这样做会不会有任何不良的性能影响？

谢谢！来自 JavaScript 菜鸟..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-06-01T03:21:14.583

有2种不同的观点：

1.  从开发的角度来看——每个文件应该只包含特定的小部分功能（一些有限且完整的应用程序单元）

2.  从用户体验的角度来看 - 文件越少越好（因为您拥有的 HTTP 请求越多 - 用户等待页面呈现的时间越长）

因此，常见的解决方案是将您的应用程序拆分为最佳设计实践所需的尽可能多的文件，并在部署之前加入+缩小它们

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:23:04.817

取决于您的页面将被使用的情况。每个新`script`标签都是一个`http-request`，所以那里会有一些性能损失。

如果应用程序的规模很大，将它们拆分为模型视图控制器（或类似）模式对于开发来说非常有效。

您可以随时将它们拼接在一起进行部署。

# java - 取 3 个整数，创建一个日期

> ID：10843965
> 
> 赞同：4
> 
> 时间：2012-06-01T03:20:24.203
> 
> 标签：java, date, integer

我正在尝试获取 3 个单独的整数输入（年、月、日）并获取这 3 个条目并从中形成一个日期对象，以便我可以使用它来比较其他日期。

到目前为止，这就是我所拥有的，不知从何而来：

```
public void compareDates() {

    String dayString = txtOrderDateDay.getText();
    String monthString = txtOrderDateMonth.getText();
    String yearString = txtOrderDateYear.getText();

    int day = Integer.parseInt(dayString);
    int month = Integer.parseInt(monthString);
    int year = Integer.parseInt(yearString);
} 
```

非常感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-06-01T03:25:20.110

试试这个，注意到月份从零开始，所以我们需要减去一个来正确指定月份：

```
Calendar calendar = Calendar.getInstance();
calendar.set(Calendar.YEAR, year);
calendar.set(Calendar.MONTH, month-1);
calendar.set(Calendar.DATE, day);
Date date = calendar.getTime(); 
```

或这个：

```
Calendar calendar = Calendar.getInstance();
calendar.set(year, month-1, day);
Date date = calendar.getTime(); 
```

或这个：

```
Date date = new GregorianCalendar(year, month-1, day).getTime(); 
```

第一种方法为您提供更多控制权，因为它允许您在日期中设置其他字段，例如：`DAY_OF_WEEK, DAY_OF_WEEK_IN_MONTH, DAY_OF_YEAR, WEEK_OF_MONTH, WEEK_OF_YEAR, MILLISECOND, MINUTE, HOUR, HOUR_OF_DAY`等。

最后，为了正确格式化注释中指示的日期，请执行以下操作：

```
DateFormat df = new SimpleDateFormat("yyyy/MM/dd");
String strDate = df.format(date); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-06-01T03:22:22.023

使用[公历](http://docs.oracle.com/javase/7/docs/api/java/util/GregorianCalendar.html)

```
new GregorianCalendar(int year, int month, int dayOfMonth) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-06-01T03:35:00.587

请参阅此库，以方便您在此类任务中的生活 - [http://joda-time.sourceforge.net/](http://joda-time.sourceforge.net/)

然后你要写这样的代码：

```
LocalDate ld = new LocalDate(int year, int monthOfYear, int dayOfMonth) ; 
```

此类提供了许多有用的方法来进行比较和操作，例如添加分钟...在[这里查看它的文档](http://joda-time.sourceforge.net/api-release/index.html)

更多关于 joda-time 的信息：

> Joda-Time 为 Java 日期和时间类提供了质量替代品。该设计允许多个日历系统，同时仍提供简单的 API。“默认”日历是 XML 使用的 ISO8601 标准。格里高利、儒略、佛教、科普特、埃塞俄比亚和伊斯兰系统也包括在内，我们欢迎进一步添加。支持类包括时区、持续时间、格式和解析。

# css - 设置输入框背景

> ID：10843966
> 
> 赞同：7
> 
> 时间：2012-06-01T03:20:35.083
> 
> 标签：css, forms, layout, input

我必须创建一个具有以下背景的输入框

![在此处输入图像描述](../Images/3bda4d69d7704a8ec489f1d3adf784bc.png)

到目前为止，在我的代码中，我有下面的代码并且它没有显示 -> 这样做的正确程序是什么？

我还必须制作这个按钮的几个变体，它们如下：

*   按钮黑色区域上的十字 - 我只是要使用`<span>`带有类的标签并将图形设置为 -> 这是一个好方法吗？

*   左侧曲线后面的回形针图标 -> 我打算和上面一样 -> 这是一个好方法吗？

**HTML：**

```
<div class="innerTo">
        <form action="#" method="get">
           <label for="recipients">TO: </label>
              <input type="search" name="recipients" id="recipients" placeholder="Recipients Names">
    </form>
    </div> 
```

**CSS：**

```
.innerBar .innerTo{
    width:200px;
    padding:5px 0 0 15px;
    display:block;
    float:left;
}
.innerBar .innerTo label{
    margin:0 15px 0 0;
    font-size:14px;
    font-weight:bold;
    color:#666666;
}
.innerBar .innerTo input[type=search] {
    color: red;
}
.innerBar .recipients{
    background-image:url('../images/searchBGpng.png') no-repeat;
    width:192px;
    height:27px;
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-06-01T03:57:17.550

[摆弄](http://jsfiddle.net/ovfiddle/3Dzga/)：

```
<div class="input-container">
    <input type="text" value="aaaaaaaaaaaaaaaaaa"/>
</div>

.input-container {
    background: url(http://i.stack.imgur.com/0Vlc5.png) no-repeat;
    width:197px;
    height:28px;
}
.input-container input{
    height:28px;
    line-height:28px;/*results in nice text vertical alignment*/
    border:none;
    background:transparent;
    padding:0 10px;/*don't start input text directly from the edge*/
    width:148px;/*full width - grey on the side - 2*10px padding*/
} 
```

如果您打算以不同的宽度重复使用它，您应该查看[推拉门技术](http://www.alistapart.com/articles/slidingdoors/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T04:52:14.630

如果您喜欢，我已经为您的表单创建了新代码，然后继续并将其应用于您的 html 代码

**你可以这样做**

**HTML 代码**

```
<form action="#" method="get">
           <label for="recipients">TO: </label>
              <input type="search" name="recipients" id="recipients" placeholder="Recipients Names">
    <input type="submit" value="">
    </form> 
```

**CSS代码**

```
label{
float:left;
    margin:25px 0 0 0px;
    padding:0;
}

input[type="search"], input[type="submit"]{
margin:20px 0 0 0px;
    padding:0;
     line-height:28px;
    height:28px;
    background: url("http://i.stack.imgur.com/0Vlc5.png") no-repeat 0 0;
    border: 0 none;
    float:left;
}

input[type="search"]{
width:152px;
    padding-left:15px;
}

input[type="submit"]{
background-position:-167px 0;
    width: 30px;
    cursor:pointer;
} 
```

现场演示链接在这里[http://jsfiddle.net/AL6vb/4/](http://jsfiddle.net/AL6vb/4/)

现在根据您的布局更改代码这只是演示......

# build - MsBuild-根据修改时间/名称从目录中删除文件

> ID：10843967
> 
> 赞同：2
> 
> 时间：2012-06-01T03:20:43.207
> 
> 标签：build, msbuild, cmd, msbuild-4.0

我有一个目录内每个构建生成的文件列表`C:\BuildArtifacts`

目录的内容如下所示：

```
TestBuild-1.0.0.1.zip
TestBuild-1.0.0.2.zip
TestBuild-1.0.0.3.zip
TestBuild-1.0.0.4.zip
TestBuild-1.0.0.5.zip
TestBuild-1.0.0.6.zip 
```

现在，对于每个增量构建，我只想保留两个最近的工件并删除其余的。所以，在这个例子中，我想保留`TestBuild-1.0.0.5.zip`和`TestBuild-1.0.0.6.zip`

我怎样才能用 MSBuild 做到这一点？

## 笔记：

我设法在一个项目中获取上述列表

```
 <Exec WorkingDirectory="$(Artifacts)\.." Command="dir /B /A:-D /O:-N" Outputs="ArchiveFileList" /> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-06-05T06:26:02.140

好吧，我们编写了一个自定义任务来按文件名对文件进行排序，然后将要删除的文件列表（不包括列表中的前两个）输出到一个`Item`

自定义任务：

```
 <UsingTask
    TaskName="Cleanup"
    TaskFactory="CodeTaskFactory"
    AssemblyFile="$(MSBuildToolsPath)\Microsoft.Build.Tasks.v4.0.dll" >
    <ParameterGroup>
      <TargetPath ParameterType="System.String" Required="true"/>
      <BackupLength ParameterType="System.Int32" Required="true"/>
      <FilesToExclude ParameterType="System.String[]" Output="true" />
      <FilesToDelete ParameterType="System.String[]" Output="true" />
    </ParameterGroup>
    <Task>
      <Using Namespace="System.IO" />
      <Using Namespace="System.Linq" />
      <Code Type="Fragment" Language="cs">
        <![CDATA[
        var diInfo = new DirectoryInfo(TargetPath);
            if (diInfo.Exists)
            {
                var fiInfo = diInfo.GetFiles().OrderByDescending(file => file.Name);

                FilesToExclude = fiInfo.Take(BackupLength).Select(file => file.FullName).ToArray();
                FilesToDelete = fiInfo.Skip(BackupLength).Select(file => file.FullName).ToArray();
            }
        ]]>
      </Code>
    </Task>
  </UsingTask> 
```

**用法**：

```
<!-- Clean old archives. Keep the recent two and deletes rest. -->
<Cleanup TargetPath="$(PackageRoot)" BackupLength="2">
  <Output TaskParameter="FilesToDelete" ItemName="FilesToClean" />
</Cleanup>

<Message Text="Cleaning Old Archives" Importance="High" />
<Delete Files="@(FilesToClean)" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T04:16:59.627

请测试此命令，然后`<exec ...>`使用`del`而不是`echo`：

```
for /f %x in ('cmd /c "dir /B /A-D /O-N | more +2"') do echo %x 
```

# asp.net - ASP.NET：数据网格 CurrentRow

> ID：10843970
> 
> 赞同：-2
> 
> 时间：2012-06-01T03:21:17.577
> 
> 标签：asp.net, loops

我有一个 DataGrid，有大约 100 个不同的条目，我想遍历每一行，并从数据库中获取一个字段（该字段是 URL），变成一个字符串。基本上我有代码来使用HTMLAgilityPack，但我想对数据库中的每一行执行此操作，并根据返回的屏幕抓取更新数据库。

1.  循环遍历每一行
2.  将每个 URL 存储到一个字符串中
3.  使用 HtmlAgilityPack 完成屏幕*抓取*
4.  使用从第 3 步返回的值更新数据库字段“价格”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-06-05T13:29:08.433

您可以遍历数据网格中的所有行并将特定列的值添加到字符串列表中。

```
var hyperlinks = new List<string>();
var indexOfColumn = 2; 
foreach (DataGridViewRow row in dgvDataGridView.Rows)
{
  hyperlinks.Add(((DataGridViewCheckBoxCell)row.Cells[indexOfColumn]).Value);
} 
```

然后使用超链接列表并根据您在步骤 4 中的需要更新数据库。我会说您可以在 foreach 语句中更新数据库，而不必费心添加到超链接列表中，但是对于 100 行，这可能会非常昂贵，除非您有批处理或类似的东西，所以你实际上每 20 次左右更新一次才访问数据库。

# c# - C#：为什么作用域对象不能具有相同的名称？

> ID：10843971
> 
> 赞同：3
> 
> 时间：2012-06-01T03:21:43.313
> 
> 标签：c#

> **可能重复：**
> [为什么不能在嵌套的局部范围内声明重复的变量名？](https://stackoverflow.com/questions/6156449/why-cant-a-duplicate-variable-name-be-declared-in-a-nested-local-scope)

我是 C# 的新手，最近注意到 C# 中的作用域对象在两个不同的作用域中声明时不能与 Java 中的名称相同。为什么要设置这个设计限制？有任何想法吗？例如，以下代码在 C# 中不起作用，

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication1
{
    class Program
    {
        private string Name = "";
        public Program(string Name)
        {
            this.Name = Name;
        }

        public static void Main(string[] args)
        {
            bool flag = true;
            if (flag)
            {
                Program p = new Program("");
                return;
            }

            Program p = new Program("");
            return;
        }
    }
} 
```

根据引用 p 创建类 Program 的第二个实例的代码的第 24 行会产生编译时错误。而完全相同的代码在 Java 中运行没有任何问题，

```
public final class Test {
    private String Name = "";
    public Test (String Name) {
        this.Name = Name;
    }

    public static void main(String[] args) {
        boolean flag = true;
        if (flag)
        {
            Test t = new Test("");
            return;
        }

        Test t = new Test("");
        return;
    }
} 
```

如果我记得我的编译器类：由于内部嵌套范围（在 if 循环内）的控制流独立于它下面的 main 部分，所以允许用户使用相同的变量名完全没有害处参考（由 Java 编译器完成）。它不应该是编译时错误。那么在 C# 中有这样的设计限制有什么奥秘吗？

# json - 如何使用 Extjs 4 中的元数据使用 jsonreader 进行存储？

> ID：10843974
> 
> 赞同：1
> 
> 时间：2012-06-01T03:22:11.397
> 
> 标签：json, extjs4, metadata, store, jsonreader

是否可以创建一个将读取 json 的存储，并使用 json 中元数据中指定的字段作为模型？

我想说的是：

```
var store = new Ext.data.Store({
    autoLoad: {
        params: {
            metaNeeded: true
        }
    },
    reader: new Ext.data.JsonReader({fields:[]}),
    proxy: new Ext.data.HttpProxy({
        api: {
            url: 'php/chart-data.php'
        }
    })
}); 
```

我尝试了多种组合，但我似乎无法让它发挥作用。我目前收到错误“无法调用未定义的方法'indexOf'”。我还有其他人，包括“对象没有读取方法”。

我发送的json是：

```
{
  metadata:{
    root:"rows",
    sortInfo:{
       field:"date",
       direction:"ASC"
    },
    fields:[ {
          name:"date"
       }, {
          name:"flow"
       },{
          name:"limit"
       }
    ],
    idProperty:"date"
  },
  success:true,
  rows: << snip >>
} 
```

是否可以通过它接收的数据配置商店的模型，以便稍后我可以使用具有不同字段（例如日期、流量、限制和温度）的同一商店？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T14:55:47.523

我已经让它与以下工作：

```
var store = new Ext.data.Store({
    proxy: {
        type: 'ajax',
        url: 'php/chart-data2.php',
        reader: new Ext.data.JsonReader({
            fields:[]
        })
    }
}); 
```

以及发送 json 的 php：

```
'{"metaData":{
        "root":"rows",
        "fields": [
            {"name":"date",
             "type":"number", 
             "convert": function(val, rec) {
                return val*1000
            } },
            {"name":"flow"},
            {"name":"limit"}
        ]
    },
    "totalCount":'.count($chart).',
    "success":true,
    "rows":' . json_encode($chart) . '
}' 
```

这现在允许服务器指定数据（显示在图表中），并且可以动态添加系列。我不知道它是否好，但它有效。我对缺乏这方面的文档感到有点失望。

# iphone - 在 iOS 上，有没有办法直接更改或绘制到 CGImage 而不是绘制到 Graphics Context 然后转换整个东西？

> ID：10843977
> 
> 赞同：0
> 
> 时间：2012-06-01T03:22:52.257
> 
> 标签：iphone, ios, core-graphics, quartz-2d, cgimage

如果我们已经有一个位图图形上下文，并且我们将此上下文转换为`CGImage`. 现在我们想在`CGImage`. 我们可以`CGImage`直接改变，而是在图形上下文中绘制一个点并将整个上下文再次转换为 a`CGImage`吗？

这个想法`CGImage`也是一个结构，所以如果我们可以改变结构中的一些数据，那应该是可能的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-01T03:56:13.267

CGImage 是不可变的。它们在创建后无法更改。

> 如果我们已经有一个位图图形上下文，并且我们将这个上下文转换为一个 CGImage

[`CGBitmapContextCreateImage`](https://developer.apple.com/library/mac/documentation/graphicsimaging/reference/CGBitmapContext/Reference/reference.html#//apple_ref/doc/uid/TP30000947-CH1g-BAJDJIFF)不会将上下文“转换”为图像——它有效地拍摄了上下文当前状态的快照。

您可以在原始上下文中绘制更多内容。（第一个 CGImage 不会受到影响。）然后`CGBitmapContextCreateImage`再次调用，以获取包含新绘图的新图像。

# sql - 如何计算另一个表中具有特定值的链接条目

> ID：10843980
> 
> 赞同：0
> 
> 时间：2012-06-01T03:23:08.857
> 
> 标签：sql, join

假设我有两张桌子。学生表和观察表。如果学生表如下所示：

```
Id Student Grade
1  Alex    3
2  Barney  3
3  Cara    4
4  Diana   4 
```

观察表如下所示：

```
Id Student_Id Observation_Type
1  1          A
2  1          B       
3  3          A
4  2          A
5  4          B
6  3          A
7  2          B
8  4          B
9  1          A 
```

基本上，我想从查询中得到的结果如下：

```
Student Grade Observation_A_Count
Alex    3     2
Barney  3     1
Cara    4     2
Diana   4     0 
```

换句话说，我想从学生表中收集每个学生的数据，并为每个学生计算观察表中 A 观察的数量，并将其附加到其他信息上。我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T03:29:36.747

这是一个简单的连接和聚合：

```
select
  a.Student,
  a.Grade,
  count(b.Id) as Observation_A_Count
from
  Student a left join
  Observations b on a.Id = b.Student_Id
group by
  a.Student,
  a.Grade
order by
  1 
```

或者，您可以使用相关子查询：

```
select
  a.Student,
  a.Grade,
  (select count(*) from observations x where x.Student_Id = a.Id) as Observation_A_Count
from
  Student a
order by
  a.Student 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T03:43:10.913

您可以加入具有特定条件的表，通过这样做，您可以拥有 Observation_B_Count 和 Observation_C_Count 等字段。

```
SELECT Student.Student, Student.Grade, COUNT(Observation_Type.*) AS Observation_A_Count
FROM Student
LEFT JOIN Observations ON Observations.Student_ID = Student.Student_ID AND Observations.Observation_Type = 'A'
GROUP BY Student.Student, Student.Grade 
```

# php - PHP SQL 表条目超链接

> ID：10843984
> 
> 赞同：1
> 
> 时间：2012-06-01T03:24:01.717
> 
> 标签：php, sql

下面是我的 PHP 代码。谁能告诉我如何删除此代码中每个 SQL 条目的超链接？

因为我不希望我的用户点击任何条目然后定向到另一个网页。我只想要一个包含来自我的 sql 数据库的条目的静态表。

非常感谢！

```
<?
 #Get the event id from $_GET
    $int_event_id = $_GET["EventID"];
    if((int)$int_event_id)
    {
        $pdo = new PDO('mysql:host=localhost;dbname=clubresults', 'root', '12345678');
    #Set Error Mode to ERRMODE_EXCEPTION.
    $pdo->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);  
$query = $pdo->query("SELECT EventName, Score, Place from results WHERE EventID ='$int_event_id' ORDER By EventID ASC");
$rowset = array();

if ($query) {
  while ($row = $query->fetch(PDO::FETCH_ASSOC)) {
    // Build array of rows
    $rowset[] = $row;
  }    

  // Output header first
  $headrow = $rowset[0];
  print("<table border=\"1\">\n<tr>\n");
  // Use $rowset[0] to write the table heading
  foreach ($headrow as $col => $val) {
    printf("<th>%s</th>\n", $col);
  }
  print("</tr>");

  // Then output table rows.
  // Outer loop iterates over row
  foreach ($rowset as $row) {
     print("<tr>");
     // Inner loop iterates over columns using $col => $val
     foreach ($row as $col => $val) {
        // We don't know your column names, but substitute the first column (the ID) for FIRSTCOL here
        printf("<td><a href=\"index.php?ID=%s\">%s</a></td>\n", $row['EventID'],$val);
     }
     print("</tr>");
  }
}}
print("</table>");
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:28:44.300

如果您更改此行：

```
printf("<td><a href=\"index.php?ID=%s\">%s</a></td>\n", $row['EventID'],$val); 
```

对此你应该没问题：

```
printf("<td>%s</td>\n", $val); 
```

# plsql - 如何监控 plsql 块语句

> ID：10843985
> 
> 赞同：1
> 
> 时间：2012-06-01T03:24:05.633
> 
> 标签：plsql, oracle11g

我试图弄清楚为什么插入和更新语句在生产服务器上比在测试服务器上运行需要更长的时间。我不知道如何监控在 SQL Developer 中运行的块的状态。在插入这么多行之后，类似 rownum 加上 sysdate 输出将是一个好的开始。

有没有办法在块运行时输出 dbms_output.put_line 语句？

我目前在 Oracle 11g 上运行 SQL Developer 3.1.07。

编辑添加解决方案：

```
PROCEDURE log_timestamp (
    PI_trans_num    number  
) IS
    PRAGMA AUTONOMOUS_TRANSACTION;
BEGIN
    INSERT INTO timestamp_log (log_timestamp, trans_num)
    VALUES (SYSTIMESTAMP, PI_trans_num);
    COMMIT;
END log_timestamp; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-06-06T07:31:02.057

另一种方法是使用 DBMS_Application_Info。

您可以通过设置“动作名称”和通过 v$session_longops 维护进度报告来将元数据添加到 v$session 中的会话以共享进度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-06-01T10:38:41.317

One of the better ways of monitoring PL/SQL performance on a row-by-row basis is to use DBMS_Profiler, which will give you execution statistics for each row and how many times it executed.

It won't diagnose a SQL execution problem of course, but it will highlight how much of your execution time is spent on executing each statement.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-06-01T06:07:12.517

`dbms_output.put_line`语句只会在执行 pl/sql 块后显示，因此它们不适合在代码运行时识别问题。

如果您想跟踪长时间运行的进程，您可以使用自治事务记录到数据库表（这样您就不会干扰当前事务）并监视日志记录表。

采用另一种方法，您可以查看在测试和生产服务器上运行的插入和更新语句的解释计划。这可能会识别生产系统上的差异，从而解释时间差异。

# mysql - 在 SQL 语句中发出使用“in”获取记录组合的问题

> ID：10843988
> 
> 赞同：1
> 
> 时间：2012-06-01T03:24:23.643
> 
> 标签：mysql, sql, aggregate-functions

我有一个有 2 列的表，例如 Empname、DepartmentName，其中一名员工可能在多个部门工作，反之亦然。我想编写一个查询以根据某些部门组合选择 EmpName。例如。仅在 Dept1、Dept2 和 Dept3 下工作的员工（在这种情况下，应仅选择仅在 3 个部门下工作的员工）

这是我尝试过的查询。

```
Select EmpName, Count(*) as Total from Emp_Departments where DepartmentName in ('Dept1', 'Dept2', 'Dept3') group by EmpName having Total=3 
```

这里的问题是，任何在上述任何部门工作且总人数为 3 的员工，它也会返回他们的行。请建议我如何才能获得唯一的组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:31:51.837

你很亲密 - 使用：

```
 SELECT d.EmpName, COUNT(*) as Total 
    FROM Emp_Departments d
   WHERE d.DepartmentName IN ('Dept1', 'Dept2', 'Dept3') 
GROUP BY d.EmpName 
  HAVING COUNT(DISTINCT d.DepartmentName) = 3 
```

# mysql - 如何在mysql中删除前导和尾随斜杠

> ID：10843989
> 
> 赞同：7
> 
> 时间：2012-06-01T03:24:39.203
> 
> 标签：mysql, sql, trim

我需要从表格菜单中的 url 字段中查询 remove /

原表

```
menuname url
home     /home/
about    /home/about/ 
```

要求

```
menuname   url
home       home
about      home/about 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-09-09T18:11:19.813

这是从字段中删除尾部斜杠的方法：

```
UPDATE `table_name` SET `field_name`=TRIM(TRAILING '/' FROM `field_name`) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-06-01T03:26:18.330

```
SELECT TRIM( BOTH  '/'    FROM  '/bar/' ) 
```

编辑

```
SELECT TRIM(BOTH  '/' FROM link ) FROM menu 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-06-01T03:30:20.207

见[http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_trim](http://dev.mysql.com/doc/refman/5.5/en/string-functions.html#function_trim)

例子：

```
SELECT TRIM(BOTH '/' FROM home, about) FROM 'table_name'; 
```

# xcode - iPad 支持的设备方向和横向启动图像

> ID：10843994
> 
> 赞同：0
> 
> 时间：2012-06-01T03:25:46.250
> 
> 标签：xcode, ipad, orientation, landscape

如果 iPad 横向设备方向都不支持（左侧或右侧），横向启动图像是否会显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T07:58:19.923

我目前正在开发一个仅限纵向的应用程序。我还没有找到一种方法来启动显示横向启动图像的应用程序。所以，我认为不会显示风景图像。您仍然应该将它包含在您的应用程序包中以通过 App Store 审批流程。

# javascript - 用ajax预加载图片

> ID：10843997
> 
> 赞同：6
> 
> 时间：2012-06-01T03:25:59.050
> 
> 标签：javascript, ajax, image, preload

在以下位置找到了使用 ajax 预加载内容的技术：http: [//perishablepress.com/3-ways-preload-images-css-javascript-ajax/](http://perishablepress.com/3-ways-preload-images-css-javascript-ajax/)

```
window.onload = function() {
    setTimeout(function() {
        // XHR to request a JS and a CSS
        var xhr = new XMLHttpRequest();
        xhr.open('GET', 'http://domain.tld/preload.js');
        xhr.send('');
        xhr = new XMLHttpRequest();
        xhr.open('GET', 'http://domain.tld/preload.css');
        xhr.send('');
        // preload image
        new Image().src = "http://domain.tld/preload.png";
    }, 1000);
}; 
```

我注意到此图像的“ajax”预加载根本不是真正的 ajax。它与我多年来一直使用的相同，只是将 url 设置在新图像对象的源中并让浏览器将其加载到缓存中。

现在想象有一个应用程序，如果它占用了一定的时间，我需要实际取消图像的预加载。仅将图像设置为 src 确实没有什么好的方法，这与停止加载实际 xhr 请求的 xhr.abort() 方法不同。

有什么理由做类似下面的事情不会预加载图像并允许取消预加载请求？

```
function preload(url, timeout){
    this.canceltimeout = function(){
        clearTimeout(this.timeout);
        this.loaded = true;
        return false;
    }

    this.abort = function(){
        this.xhr.abort();
        this.aborted = true;
    }

    //creates a closure to bind the functions to the right execution scope
    this.$_bind = function(method){
        var obj = this;
        return function (e){ obj[method](e);};
    }

    //set a default of 10 second timeout
    if(timeout == null){
        timeout = 10000;
    }

    this.aborted = false;
    this.loaded = false;
    this.xhr = new XMLHttpRequest();
    this.xhr.onreadystatechange = this.$_bind('canceltimeout');
    this.xhr.open('GET', url);
    this.xhr.send('');
    this.timeout = setTimeout(this.$_bind('abort'), timeout);
}

var llama = new preload('/image.gif');
show_image();

function show_image(){
    if(llama.loaded){
        var l = new Image();
        l.src = '/image.gif';
        application.appendChild(l);
    }else if(llama.aborted){
        var l = document.createElement('p');
        l.innerHTML = 'image.gif got cancelled';
        application.appendChild(l);
    }else{
        setTimeout(show_image, 10);
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-06-01T05:22:38.853

主要缺点是除非您已将网络服务器配置为提供未来的新鲜度信息（未来的一个`Expires`或`Cache-control: max-age`http 标头），否则当您设置 image.src 时，网络浏览器可能会向服务器发出第二个 http 请求，或者只是简单地实际使用文档中的图像。如果您的 Web 服务器发送了新鲜度验证标头（`last-modified`或`e-tag`），则不会重新下载图像，但仍会发出请求服务器进行新鲜度验证的请求，这很浪费并增加了过程的延迟。

我不知道为什么，但是当你持有一个 Image() 对象的引用时，浏览器真的很喜欢缓存图像。

如果您在 Web 浏览器调试工具中观看网络面板，您会发现大多数浏览器会发出前 2 个请求，但不会发出第 3 个请求。注释掉 ajax 回调中的代码，您将看到针对 #3 的请求

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.js"></script>
<script>
var f = "0.png?" + (new Date); // 0.png should not have future freshness info headers

$.get(f, function() {
    var i = new Image();
    i.src = f;
});
setTimeout(function(){
    //#3
    var i = new Image();
    i.src = f;
}, 5000);
</script> 
```

# grep - 递归 grep 结果并返回

> ID：10843999
> 
> 赞同：1
> 
> 时间：2012-06-01T03:26:06.570
> 
> 标签：grep

我需要从文件中找到一些匹配条件并递归地在以前匹配的文件中找到下一个条件，我有这样的东西

输入.txt

123

22

33

您需要在以下文件中找到上述术语的文件，挑战是如果在 10 个文件中找到 123，则应仅在这 10 个文件中搜索 22，依此类推...文件示例如 f1、f2、 f3,f4 .....f1200

所以就像我需要 grep -w "123" f* | grep -w "123" | ......

不可能手动列出它们，所以有更简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-06-01T03:32:15.720

您可以使用 awk 脚本解决此问题，我遇到过类似的问题，这将正常工作

```
awk '{ if(!NR){printf("grep -w %d f*|",$1)} else {printf("grep -w %d f*",$1)} }' input.txt | sh 
```

它能做什么？

*   它逐行读取 input.txt
*   直到最后一条记录，它打印 grep -w %d | （注意这里有一个管道）
*   然后将其发送到 shell 执行，结果通过管道背靠背传输
*   当你到达终点时，管道被避开

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-06-01T03:30:14.340

也许采取元编程观点会有所帮助。已经`grep`输出了一系列`grep`命令。或者编写一个小的 PERL 程序。也许 Ruby，如果心情合适的话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-06-01T03:37:16.457

您可以使用`grep -lw`写入匹配的文件名列表（请注意，它会在找到第一个匹配项后停止）。

您捕获文件名列表并将其用于循环中的下一次迭代。