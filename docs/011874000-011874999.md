# StackOverflow 问答 11874000-11874999

# c++ - 是否可以为 CString 返回堆栈对象以及为什么 /GR 会导致 dynamic_cast 的未定义行为？

> ID：11874006
> 
> 赞同：0
> 
> 时间：2012-08-08T22:15:11.467
> 
> 标签：c++, casting, cstring

我有多态类，我想通过`dynamic_cast<B>(A)`编译器优化/GR转换一个对象，我收到一条消息，它可能导致未定义的行为。我正在使用`static_cast`，但它没有运行时检查，并且对我的课程不安全。`CString`从类返回堆栈对象也有效吗？

```
CString CKingdomWar::GetTeamName( eUserTeam eTeam )
{
    if( eTeam == ELDAR )
        return CString( "Eldar" );
    else if( eTeam == ELWYN )
        return CString( "Elwyn" );
    else if( eTeam == NORGNAGON )
        return CString( "Norgnagon" );

    return CString( " " );
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:56:40.610

如前所述，您的 CString 是按值返回的，这不是问题。

关于静态/动态转换，您应该显示给出警告的特定代码。如果`dynamic_cast`正确使用（即在兼容类型之间转换指针或引用），通常不会收到此类警告。

如果`dynamic_cast<B>(A)`要工作，那么 A 和 B 都应该是同一继承树中对象的指针或引用。例如，如果您有：

```
class A {
    // ...
};

class B : public A {
    // ...
};

A* inst = new B; 
```

然后`dynamic_cast<B*>(inst)`就好了。同样处理参考。如果`inst`不是 B 类型，则指针版本将返回 NULL，否则引用版本将抛出异常。

但是，您不能这样做：

```
A inst;
B nonono = dynamic_cast<B>(inst); 
```

# html - 图像和资产 - 多少才算太多？

> ID：11874016
> 
> 赞同：1
> 
> 时间：2012-08-08T22:16:15.867
> 
> 标签：html, caching, image-processing

当我在 1998 年第一次学习构建网页时，将图像压缩成压缩伪影的虚拟马赛克的过程是一门必需的艺术。现在波特率几乎被遗忘了，通常会找到带有满是 900 倍图像的滑块、充满图像的文章、Flash 广告等的网站。这些网站在我的高速电缆调制解调器或 T1 工作时加载良好（而且看起来也不错）但我忍不住想知道我们是否把期望值定得太高了。也许我只是对页面一次加载一厘米（交错任何人？）的偏执闪回。

尽管图像预加载之类的技术有助于提高高带宽站点的用户体验，但对于我们在 2012 年现有的站点类型和连接带宽，是否有任何一致的性能指南？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:55:54.647

我可以列出一些我经常使用的方法。

*   如果可以的话，使用精灵。它将减少连接数。例如; 您在 8 个图像文件中存储了 150 个图标/图像。在这种情况下，您的浏览器将只建立 8 个连接，而不是 150 个。

*   使用正确的图像格式。例如; 对照片使用 jpg，对大多数几何图像使用 png。

*   同样，为了减少连接数，请将您的 JS 或 CSS 文件合并到一个文件中。

*   使用不同的工具来测量页面和加载速度。

*   不要一开始就加载隐藏的图像。www.wallbase.cc 就是一个很好的例子。

*   如果需要，请使用服务器端压缩。

您可以将更多内容添加到这些列表中。逻辑很简单，减少带宽使用，减少连接数。

# java - 使用 Maven 和 Spring 控制项目：如何使用 Maven 配置文件设置 Spring 配置文件？

> ID：11874017
> 
> 赞同：11
> 
> 时间：2012-08-08T22:16:34.443
> 
> 标签：java, spring, maven, configuration-files

我正在尝试根据某个 Maven 配置文件是否处于活动状态来配置带有数据库信息的 Spring 配置文件。我已经看到了一些答案，但我无法将它们放在一起。

我有一个这样的 Maven 配置文件：

```
<profiles>
    <profile>
        <id>production</id>
        <activation>
            <property>
                <name>environment.type</name>
                <value>prod</value>
            </property>
        </activation>
    </profile>

    <profile>
        <id>development</id>
        <activation>
            <property>
                <name>environment.type</name>
                <value>dev</value>
            </property>
        </activation>

        <!-- Database properties for Spring -->
        <properties>
            <db.driver>oracle.jdbc.driver.OracleDriver</db.driver>
            <db.type>oracle</db.type>
            <db.host>192.168.0.0</db.host>
            <db.port>1521</db.port>
            <db.name>myDb</db.name>
            <db.url>jdbc:${db.type}:thin:@${db.host}:${db.port}:${db.name}</db.url>
        </properties> 
```

还有一个像这样的 settings.xml 文件：

```
<servers>
  <server>
    <id>development</id>
    <username>jsmith</username>
    <password>secret</password>
  </server>
</servers>

....

<profiles>
  <profile>
    <activation>
      <activeByDefault>true</activeByDefault>
    </activation>

    <properties>
      <environment.type>dev</environment.type>
    </properties>
  </profile>
</profiles> 
```

在 servlet-context.xml 中：

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource"
        destroy-method="close">
    <property name="driverClassName">
        <value>${db.driver}</value>
    </property>

    <property name="url">
        <value>${db.url}</value>
    </property>

    <property name="username">
        <value>${db.username}</value>
    </property>

    <property name="password">
        <value>${db.password}</value>
    </property>

    <property name="maxActive">
        <value>10</value>
    </property>

    <property name="maxIdle">
        <value>1</value>
    </property>
</bean> 
```

我的问题基本上是，如何将 Maven 属性放入 servlet-context.xml 文件中？我需要一个 .properties 文件吗？我对 Maven 中的过滤和 Spring 中的 PropertyPlaceholderConfigurer 了解一些，但我不知道如何将它们组合在一起——或者它们是否组合在一起？或者有没有更简单的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-08T23:43:26.653

### 我需要一个 .properties 文件吗？

一般来说，是的，你需要使用 .properties 文件，这是我们通常做的，特别是在 spring 上下文文件中处理数据库连接配置。

.properties 文件的目的是提供在应用程序运行时配置数据库连接的能力（对于 Web 应用程序，通常需要在 .properties 文件更改后重新启动应用程序容器/服务器）。这通常在不同环境（DEV/TEST/UAT/PROD）中的应用程序部署/安装步骤中完成。

将这些数据库连接设置存储在 pom.xml 中并不是一个好习惯，因为 pom.xml 的目的是用于项目描述并且仅在应用程序构建时使用一次（例如 mvn deploy）。而且在大多数情况下，即使它被打包到最终的 jar/war 文件中，我们也并不真正关心和在构建应用程序后触摸它。

要在 spring 上下文中使用 .properties 文件，请在 applicationContext 中定义一个 propertyConfigurer bean，例如：

```
<bean id="propertyConfigurer"
  class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
  <property name="locations">
    <list>
      <!-- Default location inside war file -->
      <value>classpath:db.properties</value>
      <!-- Environment specific location, a fixed path on server -->
      <value>file:///opt/my-web-app/conf/db.properties</value>
    </list>
  </property>
  <property name="ignoreResourceNotFound" value="true"/>
</bean> 
```

希望这是有道理的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-09T23:13:54.880

使用我从两个答案和我的研究中学到的知识，我能够获得一个由 pom 控制的开发/生产系统，它可以设置正确的数据库值。

首先，在 pom 中，我创建了两个配置文件。

```
<!-- Production and Development Profiles -->

<profiles>
    <!-- Nike profile needs go here -->
    <profile>
        <id>production</id>
        <activation>
            <property>
                <name>environment.type</name>
                <value>prod</value>
            </property>
        </activation>
    </profile>

    <!-- Catalyst profile needs go here -->
    <profile>
        <id>development</id>
        <activation>
            <property>
                <name>environment.type</name>
                <value>dev</value>
            </property>
        </activation>

        <build>

            <!-- This holds the properties for the Spring context file.
                 Database values will be changes to development. -->
            <filters>
                <filter>src/main/resources/dev.database.properties</filter>
            </filters>

            <resources>

                <!-- This is the directory that holds the Spring context
                     file.  The entire folder is searched, so either no
                     other file should have place holders or you should
                     exclude other files from being filtered. -->
                <resource>
                    <directory>src/main/webapp/WEBINF/</directory>
                    <filtering>true</filtering>
                </resource>
            </resources>
    </profile>
</profiles> 
```

在 servlet-context.xml 的 WEBINF 目录中，我放置了占位符：

```
<!-- For database, uses maven filtering to fill in placeholders -->
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName" value="${db.driver}" />
    <property name="url"             value="${db.url}" />
    <property name="username"        value="${db.username}" />
    <property name="password"        value="${db.password}" />
    <property name="maxActive">
        <value>10</value>
    </property>
    <property name="maxIdle">
        <value>1</value>
    </property>
</bean> 
```

然后我创建了一个属性文件放在 src/main/resources

```
#
# Development database properties file
#
db.driver=oracle.jdbc.driver.OracleDriver
db.url=jdbc:oracle:thin:[USER/PASSWORD]@[HOST][:PORT]:SID
db.username=jsmith
db.password=s3cr3t 
```

然后我可以启动 Maven

```
mvn -P developement clean install 
```

或者有一个 settings.xml 为我设置正确的配置文件：

```
<settings>
  <profiles>
    <profile>
      <activation>
        <activeByDefault>true</activeByDefault>
      </activation>

      <properties>
        <environment.type>dev</environment.type>
      </properties>
    </profile>
  </profiles>   
</settings> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-09T12:50:11.830

主要问题是：您将如何将 WAR 文件部署到不同的环境？通过 RPM、jenkins 构建，手动？您是否还希望将相同的 WAR 文件部署到所有环境？

a）您希望通过 JENKINS 作业（或通过 maven 手动）部署您的 WAR，只需处理您的资源并在 jar 的构建过程中使用配置文件（mvn -P production clean deploy），maven pom 应包含代码像这样：

```
 <filters>
        <filter>${config.maven.plattform.resources}/environment/${config.environment.dir}/your_proyect.properties</filter>
    </filters>
    <resources>
        <resource>
            <directory>resources/servlet-context.xml</directory>
            <filtering>true</filtering>
        </resource>
        <resource>
            <directory>target/generated-resources</directory>
            <filtering>true</filtering>
        </resource>
    </resources> 
```

您应该在 your_proyect.properties 文件中定义您的属性（每个环境一个），并为所有不同的配置文件定义 config.environment.dir。

b) 您希望所有项目都使用相同的 WAR/RPM 等。然后，您必须在应用程序 servert 的 java 启动中将环境定义为属性： -DENVIRONMENT=production 然后使用参数化的 PropertyPlaceholderConfigurer 加载所有属性，正如 yorkw 指出的那样：

```
<bean id="propertyPlaceholderConfigurer"
class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="locations">
        <list>
        <value>classpath:environment/${ENVIRONMENT}/your_project.properties</value>
        </list>
    </property>
</bean> 
```

还要记住将所有属性放在 WAR 中，WAR 构建的 pom 应该包含如下代码：

```
 <execution>
                    <id>copy-env-resources</id>
                    <!-- here the phase you need -->
                    <phase>validate</phase>
                    <goals>
                        <goal>copy-resources</goal>
                    </goals>
                    <configuration>
                        <outputDirectory>${basedir}/src/main/webapp/WEB-INF/classes/environment/</outputDirectory>
                        <overwrite>true</overwrite>
                        <resources>
                            <resource>
                                <directory>${basedir}/${build_to_all_your_environments}</directory>
                                <includes>
                                    <include>**/*.properties</include>
                                </includes>
                            </resource>
                        </resources>
                    </configuration>
                </execution> 
```

c）混合的：您可以手动选择一个环境而不是服务器中定义为属性的环境（-D），您可以通过使用默认属性来获取此环境，如果找不到，则使用该环境的环境，此步骤非常复杂，因为它需要另一组属性，如果您有兴趣查看我的帖子： [deployment for different environment with maven and spring](https://stackoverflow.com/questions/11850130/deployment-for-different-enviroments-with-maven-and-spring)，我也对 c) 的更好解决方案感兴趣

# c# - 使用 KendoUI Grid，如何将可选图像或图标添加到行模板中？

> ID：11874022
> 
> 赞同：1
> 
> 时间：2012-08-08T22:17:06.477
> 
> 标签：c#, javascript, asp.net, kendo-ui

我是 KendoUI 的新手。（谁错了？）我有一个网格，我正在使用行模板。我的数据集包含几个布尔值。我想在产品名称之后插入一个图标作为产品状态的视觉指示器。

例如，如果产品低于阈值计数，我想显示一个低库存图标。如果产品的订单多于库存，我想显示一个不同的警告图标。所以大多数产品不会有任何图标。但有些可能有多个图标。

有没有人对这个问题有很好的解决方案？我将如何格式化模板，以便我可以根据布尔值显示或隐藏图标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:45:32.387

您可以使用 RowTemplate 根据单元格的值设置 CSS 类。

[http://demos.kendoui.c​​om/web/grid/rowtemplate.html](http://demos.kendoui.com/web/grid/rowtemplate.html)

例如，考虑一个有 2 列的网格，名称和状态。您可以制作如下行模板：

```
var rowTemplate = "<tr><td class='#= Status #'></td><td>#= Name #</td></tr>"; 
```

并为每个状态制作 CSS 类：

```
.status1 { background-image: Url("/images/status1image.gif"); }
.status2 { background-image: Url("/images/status2image.gif"); } 
```

然后将 RowTemplate 应用于网格。随着数据的变化，CSS 类应该显示适当的图像。

我还没有完全尝试过 - 但它应该可以正常工作。

# c# - 是否可以在 MVC 3 中打开/关闭验证数据注释？

> ID：11874026
> 
> 赞同：4
> 
> 时间：2012-08-08T22:17:20.500
> 
> 标签：c#, asp.net, asp.net-mvc-3, data-annotations

我有两个单独的视图访问同一个模型。当我将验证器数据注释放在模型上时，它会像宣传的那样工作，如果留空或不在范围内，它会阻止提交数据（对于两个视图）。但是，我有一个视图应该能够允许为属性保存空值或空值，而另一个视图需要在允许它通过之前输入或选择信息。换句话说，我想为一个视图关闭模型中属性的验证器，并为另一个视图保留它。这是示例代码：

模型：

```
[Range(1, 999, ErrorMessage = "A submittal is required")]
public int SubmittalId { get; set; } 
```

查看#1：

```
 <label>@Model.AuditDoc.SubmittalsLabel.ConfigurableLabelDesc</label> @Html.ValidationMessageFor(x => x.AuditDoc.SubmittalId) @Html.DropDownListFor(x => x.AuditDoc.SubmittalId, new SelectList(Model.AuditDoc.ListOfSubmittals, "Id", "Name")) 
```

查看#2：

```
 <label>@Model.AuditDoc.SubmittalsLabel.ConfigurableLabelDesc</label> @Html.DropDownListFor(x => x.AuditDoc.SubmittalId, new SelectList(Model.AuditDoc.ListOfSubmittals, "Id", "Name")) 
```

如您所见，我想为 View #2 禁用该验证器数据注释，并为 View #1 保留它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T22:27:24.130

这是不可能通过默认的数据注释集实现的。但是，您可以选择使用 2 个单独的视图模型或编写自己的验证属性。

我写过一次..虽然我讨厌使用它..

```
public class RequiredOnAttribute : ValidationAttribute
{
    public string[] URLs { get; set; }

    public override bool IsValid(object value)
    {
        if (URLs.Contains(System.Web.HttpContext.Current.Request.Url.AbsolutePath))
        {
            if (string.IsNullOrEmpty(value as string))
            {
                return false;
            }
        }
        return true;
    }
} 
```

用法：

```
[RequiredOn(URLs = new string[] { "/create", "/edit" })]
public string MyModelField { get; set; } 
```

你可以对 Range、RegEx 等做同样的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T22:57:11.013

我使用不同的方法解决了这个问题。

诀窍不是禁用验证本身，而是在调用控制器的操作之前清除任何不适当的验证错误（因此 ModelState.IsValid 返回 true）。

如果一个模型（或视图模型）对象需要自定义验证，那么它会实现我定义的一个接口`ICustomValidation`，它看起来像这样：

```
public interface ICustomValidation {
    void PerformValidation(ModelStateDictionary modelState);
} 
```

我的`BaseController`类（我所有的控制器子类）都有这个方法覆盖：

```
protected override void OnActionExecuting(ActionExecutingContext filterContext) {
    base.OnActionExecuting(filterContext);

    // Unfortunately it seems this is the only way to get the Model object
    if( filterContext.ActionParameters.ContainsKey("model") ) {

        Object                    model = filterContext.ActionParameters["model"];
        ModelStateDictionary modelState = filterContext.Controller.ViewData.ModelState; // ViewData.Model always returns null at this point.

        ICustomValidation modelValidation = model as ICustomValidation;
        if( modelValidation != null ) {
            modelValidation.PerformValidation( modelState );
        }
    }

} 
```

因此，在示例 ViewModel 类中，如果我想禁用（或者更确切地说：忽略）某些验证错误，那么它只需要这样做：

```
public class SomeModel : ICustomValidation {

    [Required]
    public Boolean NamePresent { get; set; }

    [Required]
    public String Name { get; set; }

    public void PerformValidation(ModelStateDictionary modelState) {
        if( !NamePresent ) dict.Remove("Name");
    }
} 
```

在我的实际代码中，有更多的逻辑可以在模型递归和按前缀的方法中清除 ModelStateDictionary，从而保持它的健壮性。

我的解决方案与您的问题不完全匹配，但使用类似的方法您应该能够让它为您工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T22:39:00.947

我也建议使用不同的视图模型对象。这篇文章有一个很好的例子来说明如何干净地实现它[http://lostechies.com/jimmybogard/2009/06/30/how-we-do-mvc-view-models/](http://lostechies.com/jimmybogard/2009/06/30/how-we-do-mvc-view-models/)

或者，您可以简单地不在控制器上调用 ModelState.IsValid。

# directx - 如何在桌面应用程序中调出 Windows 8 屏幕键盘

> ID：11874029
> 
> 赞同：7
> 
> 时间：2012-08-08T22:17:38.660
> 
> 标签：directx, touch, windows-8, multi-touch

我有一个全屏 DirectX 桌面应用程序，并且希望在用户点击我的游戏中的文本框时显示屏幕键盘。在全屏模式下有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-24T12:55:34.590

执行 osk.exe 会弹出更老式的屏幕键盘。Windows 8 触摸键盘将通过执行弹出

```
C:\Program Files\Common Files\Microsoft Shared\ink\TabTip.exe 
```

我只是想通了，因为我正在开发一个全屏桌面应用程序，该应用程序在没有连接键盘的平板电脑上运行。

塞维林。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-28T09:55:22.403

与 Severin Stampler 的答案相同，但为了从 c# 中找到正确的路径，我使用：

```
var path = Environment.GetFolderPath(Environment.SpecialFolder.CommonProgramFiles) + @"\Microsoft Shared\ink\TabTip.exe";

if (!File.Exists(path))
{
   // older windows versions
   path = Environment.GetFolderPath(Environment.SpecialFolder.System) + @"\osk.exe";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T03:29:48.950

如果它是桌面应用程序，您可能需要调用`ShellExecute`for `osk.exe`。

如果它是 Metro 应用程序，则您无法从应用程序本身调用 SIP。根据[MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/apps/hh465404.aspx)：

> 这意味着应用程序无法通过焦点操作以编程方式调用触摸键盘。过去的罪魁祸首是网页——其中许多默认设置焦点

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-18T03:14:46.330

您可以很容易地展示 Windows 8 触摸键盘：

[http://brianlagunas.com/showing-windows-8-touch-keyboard-wpf/](http://brianlagunas.com/showing-windows-8-touch-keyboard-wpf/)

# javascript - jquerymobile：使用reloadpage：true调用mobile.changepage时目标页面不刷新

> ID：11874030
> 
> 赞同：2
> 
> 时间：2012-08-08T22:17:49.110
> 
> 标签：javascript, jquery, jquery-mobile

我正在尝试通过 ajax 调用加载页面，使用`mobile.changepage`如下所示：

```
mobile.changePage( "index.html", {transition: "slide", reloadPage: true, data: id}) 
```

我尝试在`index.html`所有功能上使用，例如：

```
$( '#mainMenu' ).live( 'pageinit',function(event){var movie_id = location.search;}); 
```

页面已加载，但我无法在页面上获取“id”的值`index.html`，只要我硬刷新它就可以了。

我究竟做错了什么？

谢谢罗德里戈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:19:03.107

假设您将单个参数传递给`page2`，您可以使用`location.search`in`page2`来获取电影变量，但我发现它不适用于常规浏览器。因此，在结果页面中，您需要解析`$(this).data('url')`.

此外，脚本代码`page2`必须在`DIV#page2`块内，因为当下一页更改时，标题 HTML 中的内容不会更改（正如另一位成员所注意到的）。

脚本块：

**第 1 页**

```
<script language="javascript">

    $( '#mainMenu' ).live( 'pageinit',function(event){
        $('.btnTxtSearch').bind('click',function () {
            var movieName = $('#txtMovieTitle').val();
            if (!movieName || movieName.length == 0 || movieName == null) {
                alert('Please insert a title before clicking the button');
                return false;
            } //end of if

            $.mobile.changePage( "page2.html", {transition: "slide", reloadPage: true, data: movieName}); 

        });
    });

</script> 
```

**第2页**

```
<script language="javascript">
//Without this pageinit may be called multiple times in back and forth use case.   
$('#page2').die( 'pageinit');

$('#page2').live( 'pageinit',function(){
    var movieName = $(this).data('url').split('?')[1];
    //Debug:
    alert(movieName);
});     

</script> 
```

# c# - 当我更改数据上下文时双向绑定崩溃

> ID：11874038
> 
> 赞同：1
> 
> 时间：2012-08-08T22:18:16.477
> 
> 标签：c#, wpf, xaml, data-binding, telerik

我正在使用双向绑定来动态更改我的一个用户控件的颜色并设置初始选择的颜色。它的结构如下（简化方式）：

```
<RadGridView x:Name="T" ItemsSource="{Binding storage, Mode=OneWay}">
    <GridViewColumn>
        <GridViewColumn.Template>
            <ColorPicker SelectedColor="{Binding Color, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
        </...>
    </...>
</...> 
```

以及相关的 C# 代码：

```
void func(object sender) {
    this.DataContext = sender;
} 
```

当我尝试更改 GridView 的 DataContext IF 且仅当 GridView 中包含元素时，我得到一个空指针异常。有没有办法绕过更改具有双向绑定的网格视图的源？

最好的，金

# excel - 如何在 excel 2010 电子表格中删除任何列中没有单元格注释的行

> ID：11874041
> 
> 赞同：0
> 
> 时间：2012-08-08T22:18:34.677
> 
> 标签：excel, vba

我有一个包含 85,000 行的 excel 文件，我只需要提取单元格注释，但它目前太大，所以我想知道我是否可以编写一些 VB（以前从未做过）或宏或通过每一行的东西，查看是否有任何列有单元格注释，如果没有，则删除该行。

任何有关如何实现这一目标的提示将不胜感激！我有编程背景（很多很多年前做过一些 VB2-6，但从未为 Excel 编程过）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T22:39:31.260

这与您的要求略有不同，但我认为满足您的需求。它选择带有注释的行并将它们和第 1 行中的假定标题粘贴到另一个工作表中。更改“Sheet1”以适合：

```
Sub PasteRowsWithComments()
Dim wsSource As Excel.Worksheet
Dim wsTarget As Excel.Worksheet
Dim RowsWithComments As Excel.Range

Set wsSource = Sheet1
Set wsTarget = Worksheets.Add
On Error Resume Next
Set RowsWithComments = wsSource.Cells.SpecialCells(xlCellTypeComments).EntireRow
On Error GoTo 0
If Not RowsWithComments Is Nothing Then
    RowsWithComments.Copy Destination:=wsTarget.Range("A1")
    wsSource.Range("A1").EntireRow.Copy
    wsTarget.Range("A1").Insert shift:=xlDown
End If
End Sub 
```

**跟进**

```
Option Explicit

Dim RngToCopy As Range

Sub PasteRowsWithComments()
    Dim wsSource As Excel.Worksheet
    Dim wsTarget As Excel.Worksheet
    Dim RowsWithComments As Excel.Range

    Set wsSource = Sheet1: Set wsTarget = Worksheets.Add

    On Error Resume Next
    Set RowsWithComments = wsSource.Cells.SpecialCells(xlCellTypeComments).EntireRow
    On Error GoTo 0

    If Not RowsWithComments Is Nothing Then
        '~~> This is required to clean duplicate ranges so that we do not get
        '~~> the error "That command cannot be used on multiple selections"
        If InStr(1, RowsWithComments.Address, ",") Then _
        Set RngToCopy = cleanRange(RowsWithComments) Else _
        Set RngToCopy = RowsWithComments

        RngToCopy.Copy Destination:=wsTarget.Rows(1)
        wsSource.Range("A1").EntireRow.Copy
        wsTarget.Range("A1").Insert shift:=xlDown
    End If
End Sub

'~~> This function will convert `$1:$1,$1:$1,$4:$4,$7:$7` to `$1:$1,$4:$4,$7:$7`
Function cleanRange(rng As Range) As Range
    Dim col As New Collection
    Dim Myarray() As String, sh As String, tmp As String
    Dim i As Long
    Dim itm As Variant

    sh = rng.Parent.Name: Myarray = Split(rng.Address, ",")

    For i = 0 To UBound(Myarray)
        On Error Resume Next
        col.Add Myarray(i), """" & Myarray(i) & """"
        On Error GoTo 0
    Next i

    For Each itm In col
        tmp = tmp & "," & itm
    Next

    tmp = Mid(tmp, 2): Set cleanRange = Sheets(sh).Range(tmp)
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:13:45.133

确保您的工作表处于活动状态，将“12”替换为您关心的列数`numColumns`。需要一些`On Error`技巧，`HasComment()`因为`Comment.Text`如果您在不存在时尝试检查其值，则会出现错误：

```
Sub RemoveRowsWithoutComments()
Dim rngAll As Range, rng As Range
Dim numColumns As Integer, colCntr As Integer, rowCntr As Long
Dim rowHasComment As Boolean

'set YOUR number of columns
numColumns = 12

Set rngAll = Range("A1", Range("A1").End(xlDown))

rowCntr = rngAll.Count - 1

'need to work backwards because deleting rows messes up forward iteration
Do Until rowCntr = -1

'work with current row (descending)
Set rng = Range("A1").Offset(rowCntr, 0)

rowHasComment = False

    For colCntr = 0 To numColumns

        If HasComment(rng.Offset(0, colCntr)) Then
            rowHasComment = True
            Exit For
        End If

    Next colCntr

    If Not rowHasComment Then rng.Rows.EntireRow.Delete

'decrement
rowCntr = rowCntr - 1
Loop
End Sub

Function HasComment(rng As Range) As Boolean
On Error GoTo NoComment

    If rng.Comment.Text <> "" Then
        HasComment = True
        Exit Function
    End If

NoComment:
    HasComment = False

End Function 
```

# php - symfony2 表单字段：具有自定义选项名称的实体

> ID：11874042
> 
> 赞同：1
> 
> 时间：2012-08-08T22:18:37.770
> 
> 标签：php, forms, symfony

我使用实体作为表单字段类型，并像这样获取该下拉框的选项列表，就像一个魅力。

```
 $builder->add('parent', 'entity', array(
    'label' => 'Välj en fastighet för skärmen ',
    'class' => 'BizTVContainerManagementBundle:Container','property'=>'name',
    'query_builder' => function(EntityRepository $er) use ($parentType, $company) {
        return $er->createQueryBuilder('u')
            ->where('u.containerType = :type', 'u.company = :company')
            ->setParameters( array('type' => $parentType, 'company' => $company) )
            ->orderBy('u.name', 'ASC');
        },
    )); 
```

现在，如何将显示名称自定义为我一起编写的代码，而不仅仅是

```
'property'=>'name 
```

我最终想要做的是拥有当前显示的字符串，再加上另一个字符串。我实际上也想在其中获取该实体的父级名称，例如：

```
option_name = $entity->getName() . ' (' . $entity->getParent()->getName() . ')' . 
```

如果我自己构建表单，平面 php html 将是一件容易的事，但是由于我不喜欢做数百个无聊的小时，所以这些天我喜欢使用 symfony2 =)

欢迎任何输入...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T22:41:35.017

修改你的`Container`类并添加一个返回字符串的方法（如你所愿）：

```
class Container
{
    public function getSelectLabel()
    {
        return $this->name . '(' . $this->parent->getName() . ')';

    }
} 
```

然后将其用作`property`（只需将大小写替换为`_`小写）：

```
$builder->add('parent', 'entity', array(
    'label'    => 'Välj en fastighet för skärmen ',
    'class'    => 'BizTVContainerManagementBundle:Container'
    'property' => 'select_label',
)); 
```

所以`getSelectLabel()`变成“select_label”，没有“get”。

# ios - 读取音频文件时出现大量内存峰值

> ID：11874047
> 
> 赞同：1
> 
> 时间：2012-08-08T22:19:08.737
> 
> 标签：ios, c, malloc, extaudiofile

我目前正在使用 Dirac`(OSStatus) readFloatsConsecutive:(SInt64)numFrames intoArray:(float**)audio`函数从文件中读取音频浮点数。我创建了一个浮点指针**

```
arrayToFill = malloc(channelCount * sizeof(float*));

for(int i = 0; i < channelCount; ++i)
{
    arrayToFill[i] = malloc(frameCount * sizeof(float));
} 
```

并将它传递给 Dirac 函数，当所有浮点数都被分配时，我会得到一个巨大的内存峰值。

在仪器中，我得到了大约 90MB 的峰值，并且由于某种原因，这个应用程序仍然在设备上运行。

例如 15839544 * 2 个浮点数会导致这些巨大的峰值吗？

怎么会占用这么多内存？是虚拟内存吗？我没有看到任何虚拟机分配。

我看不出加载单个文件（例如 5MB 音频文件）如何导致内存中出现如此巨大的峰值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T22:27:57.607

> 例如 15839544 * 2 个浮点数会导致这些巨大的峰值吗？

是的，一点没错。一个浮点数是 4 个字节，因此两个 1580 万个浮点数的数组总共约为 120 MB。

至于您如何从 5 MB 的输入文件中得到这个：音频压缩是一件了不起的事情。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T22:42:51.767

它可能是虚拟内存 - 尽管不是通常（错误）理解的方式。

虚拟内存是映射到进程中的可用地址空间。它可能会或可能不会用内存的物理页备份。

访问未如此备份的页面会导致页面错误，然后内核以多种方式之一提供服务：

*   分配一个新的归零页面
*   分配页面并用内存映射文件的页面填充其内容
*   分配页面并从页面文件中填充其内容
*   不执行上述任何操作并终止应用程序

因此，`malloc()`对于大量内存（大于可用的物理页面）往往会成功，而操作系统有足够的 RAM 来分配页面描述符以将虚拟空间映射到进程中（尽管如果超过资源限制，它可能会下降）观点）。尝试实际写入分配的空间会逐渐将物理页面拉入进程。

您指示的大小实际上是 ~128MB 内存。您不太可能在 iDevice 上使用这么多物理 RAM，所以我认为我们可以假设它并没有全部被使用。您可能可以获得页面错误数量的统计信息 - 这将使您对使用的数量有一个很好的了解（大概是每页 4kB）。

我希望您的进程的 VM 统计信息包括此分配。

# c# - 当输出包含的一个/多个关键字为空时，输出不会被过滤

> ID：11874050
> 
> 赞同：0
> 
> 时间：2012-08-08T22:19:12.577
> 
> 标签：c#, xml, winforms

下面的函数在这一行不能正常工作

```
if (itemDescription.ToLower().Contains(txtComKeyword1.Text.ToLower()) ||
    itemDescription.ToLower().Contains(txtComKeyword2.Text.ToLower()) ||
    itemDescription.ToLower().Contains(txtComKeyword3.Text.ToLower()) ||
    itemDescription.ToLower().Contains(txtComKeyword4.Text.ToLower())) 
```

如果一个/多个`txtComKeyword`是空的。只有当所有四个`txtComKeyword`都填满时，它才能正常工作。

我想通过使用关键字限制 XML 文件的数据来过滤它。检测到的关键字`<item></item>`将显示为结果。我想让用户选择是否只输入一个/两个/三个/四个关键字。不幸的是，只要有空，就会输出`txtComKeywords`整个 XML 文件。`<item></item>`

我对编程非常陌生。如果可能的话，你们能帮忙吗？谢谢你。

我的代码：

```
private void searchComByKeywords()
{
    // Process the list of files found in the directory. 
    string[] fileEntries = Directory.GetFiles(sourceDir);
    foreach (string fileName in fileEntries)
    {
        try
        {
            XmlDocument xmlDoc = new XmlDocument(); //* create an xml document object.

            string docPath = fileName;

            xmlDoc.Load(docPath); //* load the XML document from the specified file.

            XmlNodeList nodeList = xmlDoc.GetElementsByTagName("item");

            foreach (XmlNode node in nodeList)
            {

                XmlElement itemElement = (XmlElement) node;

                string itemDescription = itemElement.GetElementsByTagName("description")[0].InnerText;

                if (itemDescription.ToLower().Contains(txtComKeyword1.Text.ToLower()) || itemDescription.ToLower().Contains(txtComKeyword2.Text.ToLower()) || itemDescription.ToLower().Contains(txtComKeyword3.Text.ToLower()) || itemDescription.ToLower().Contains(txtComKeyword4.Text.ToLower()))
                {
                    string itemTitle = itemElement.GetElementsByTagName("title")[0].InnerText;
                    string itemDate = itemElement.GetElementsByTagName("pubDate")[0].InnerText;
                    string itemAuthor = itemElement.GetElementsByTagName("author")[0].InnerText;

                    richComResults.AppendText("Author: " + itemAuthor + "\nDate: " + itemDate + "\nTitle: " + itemTitle + "\nDescription: " + itemDescription + "\n\n--------\n\n");
                }
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    }
} 
```

编辑：

```
private void searchComByKeywords()
{
    // Process the list of files found in the directory. 
    string[] fileEntries = Directory.GetFiles(sourceDir);
    foreach (string fileName in fileEntries)
    {
        try
        {
            XmlDocument xmlDoc = new XmlDocument(); //* create an xml document object.

            string docPath = fileName;

            xmlDoc.Load(docPath); //* load the XML document from the specified file.

            XmlNodeList nodeList = xmlDoc.GetElementsByTagName("item");

            foreach (XmlNode node in nodeList)
            {

                XmlElement itemElement = (XmlElement) node;
                string itemDescription = itemElement.GetElementsByTagName("description")[0].InnerText;
                string[] words = new String[] { null, null, null, null };
                string key1 = txtComKeyword1.Text.Trim();
                string key2 = txtComKeyword2.Text.Trim();
                string key3 = txtComKeyword3.Text.Trim();
                string key4 = txtComKeyword4.Text.Trim();
                words[0] = (key1.Length == 0 ? null : key1.ToLower());
                words[1] = (key2.Length == 0 ? null : key2.ToLower());
                words[2] = (key3.Length == 0 ? null : key3.ToLower());
                words[3] = (key4.Length == 0 ? null : key4.ToLower());

                if (words.Contains(itemDescription.ToLower())) 
                {
                    string itemTitle = itemElement.GetElementsByTagName("title")[0].InnerText;
                    string itemDate = itemElement.GetElementsByTagName("pubDate")[0].InnerText;
                    string itemAuthor = itemElement.GetElementsByTagName("author")[0].InnerText;

                    richComResults.AppendText("Author: " + itemAuthor + "\nDate: " + itemDate + "\nTitle: " + itemTitle + "\nDescription: " + itemDescription + "\n\n--------\n\n");
                }
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:40:57.247

在进入循环之前读取所有单词并将它们保存在字符串数组
中在将单词输入数组之前检查文本框是否为空
然后使用**Array.Contains**方法检查 itemDescription 是否在单词数组中

```
string[] words = new String[] {null, null, null, null};
// as from John Saunders comment below, 
// pass everything into a local temp variable to avoid double 
// evaluation (and string rebuild) of the Trim() method
string key1 = txtComKeyword1.Text.Trim();
string key2 = txtComKeyword2.Text.Trim();
string key3 = txtComKeyword3.Text.Trim();
string key4 = txtComKeyword4.Text.Trim();
words[0] = (key1.Length == 0 ? null : key1.ToLower());
words[1] = (key2.Length == 0 ? null : key2.ToLower());
words[2] = (key3.Length == 0 ? null : key3.ToLower());
words[3] = (key4.Length == 0 ? null : key4.ToLower());

if (words.Contains(itemDescription.ToLower())) 
    ..... 
```

优点有两个：

*   您阅读了文本框并在循环外仅转换为小写一次
*   if 语句被大大简化

C# 中的[三元运算符](http://msdn.microsoft.com/en-US/library/ty67wk28%28v=vs.100%29.aspx)是表达常见编码模式的一种更简单的方式

```
if(condition == true)
   variable = first statement;
else
   variable = second statement; 
```

该代码使用三元运算符

```
 variable = (condition == true ? first statement : second statement); 
```

# android - Android EditText在TableLayout中按下按钮后消失

> ID：11874052
> 
> 赞同：0
> 
> 时间：2012-08-08T22:19:47.397
> 
> 标签：android, button, android-edittext, tablelayout

**一些背景**
我有一个 9 行的 TableLayout。我选择了 TableLayout，因为我可以成功地将 EditText 视图在 1 行上并排排列。正如您将在下面看到的，我在两行上有 6 个 EditText，但为了避免重复，我只包含 6 个中的 2 个以节省空间，并且我删除了一些不必要的行，因为它们显示正确（只是 TextView）。

**问题**
我遇到的问题是在我按下布局上的按钮后，所有 EditText 视图都消失了。我的按钮启动与 WCF Restful 服务的联系，但使用 AsyncTask 这样做。有一个等待对话框占用用户，有时会弹出吐司消息。这都是正常的行为。为了完美，EditText 在我按下按钮后立即消失。

我用 google 和 stackoverflow 进行了搜索，我看到了类似的问题，但与我遇到的问题不同。非常奇怪的是，这只发生在我在手机上调试时，它不会发生在 AVD 模拟器中。

**统计**
电话：T-Mobile myTouchQ LG-C800（仅供参考：不是最好的手机）我扎根了。
手机 Android 版本：2.3.4（LG 显然不相信更新）
IDE：IntelliJ 11.1
Android SDK：4.0.3
Java 版本：1.7

**问题**
1\. 我应该使用不同的布局吗？
2\. 任何线索为什么会发生这种情况？

这是我的 Layout.xml 的缩短版本：

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
             android:id="@+id/tableLayout1"
             android:layout_width="fill_parent"
             android:layout_height="fill_parent" >
    <TableRow android:id="@+id/rowTitleWinningNumbers"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:padding="0dip" >
        <TextView android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:text="Winning Numbers" />
    </TableRow>
    <TableRow android:id="@+id/rowWinningNumbers"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:padding="0dip" >
        <EditText android:id="@+id/txtLotto1"
                  android:inputType="text"
                  android:layout_width="0dp"
                  android:layout_weight="16.67"
                  android:editable="false"
                  android:focusable="false" />
        <EditText android:id="@+id/txtLotto2"
                  android:inputType="text"
                  android:layout_width="0dp"
                  android:layout_weight="16.67"
                  android:editable="false"
                  android:focusable="false" />
    </TableRow>
    <TableRow android:id="@+id/rowTitlePlayerNumbers"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:padding="0dip" >
        <TextView android:layout_width="wrap_content"
                  android:layout_height="wrap_content"
                  android:text="Your Numbers" />
    </TableRow>
    <TableRow android:id="@+id/rowPlayerNumbers"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:padding="0dip" >
        <EditText android:id="@+id/txtPlayer1"
                  android:inputType="text"
                  android:layout_width="0dp"
                  android:layout_weight="16.67"
                  android:hint="@string/strDefaultNumber" />
        <EditText android:id="@+id/txtPlayer2"
                  android:inputType="text"
                  android:layout_width="0dp"
                  android:layout_weight="16.67"
                  android:hint="@string/strDefaultNumber" />
    </TableRow>
    <TableRow android:id="@+id/rowPlayerStatus2"
              android:layout_height="wrap_content"
              android:layout_width="wrap_content"
              android:gravity="center">
        <Button android:id="@+id/btnSubmit"
                android:text="Did I Win?!"
                android:onClick="btnSubmit_onClick" />
        <CheckBox android:id="@+id/cbxSavePlayerNumbers"
                  android:layout_height="wrap_content"
                  android:layout_width="wrap_content"
                  android:gravity="center"
                  android:lines="2"
                  android:text="Save my \nNumbers" />
    </TableRow>
</TableLayout> 
```

**编辑**评论中要求的代码

```
public void btnSubmit_onClick(View v)
{
    try
    {
        clearStatuses();

        setLabelText(R.id.lblTimeStamp, DateTime.Today().toString());

        savePlayerNumbers();

        //This method has to perform its main task asynchronously
        getWinningLotteryNumbers();
    }
    catch(Exception ex)
    {
        ex.toString();
    }
}

private void getWinningLotteryNumbers()
{
    try
    {
        _waitDialog = ProgressDialog.show(MyActivity.this, "Working", "Getting latest Lottery drawing, Please Wait...", true);

        getButton(R.id.btnSubmit).setEnabled(false);

        String strUrl = getRString(R.string.strWCFServiceURL);

        new LottoProxy().execute(strUrl);
    }
    catch (Exception e)
    {
        resetControlStates();
    }
}

private void clearStatuses()
{
    TextView lblStatus = getLabel(R.id.lblStatus);
    lblStatus.setText("");
    lblStatus.setTextColor(Color.BLACK);

    for (int i = 0; i < 6; i++)
        resetTextBoxBackResource(getWinningBox(i), getPlayerBox(i));
} 
```

我非常坚持这一点，所以提前感谢您的帮助。这是我的第一个真正的应用程序（而不是只是玩玩），所以如果我犯了一个新手错误，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T15:59:08.913

所以事实证明，EditText 并没有消失，而是因为我的 clearStatuses() 方法迭代所有可用的 EditText 并将它们的背景更改为黑色而从视图中隐藏。这不是等待处理此问题，因为显然在执行此操作时您正在覆盖库存的 EditText 背景图像。

令人难以置信的部分是（正如我在上面的评论中所说）我注释掉了 onClick() 方法中的所有代码，无论如何这仍然发生。因此，准确指出问题是相当困难和令人困惑的。我想知道这是否是Android中的错误？

我学会了使用以下代码将您的 EditText 更改回它通常的外观：

```
yourEditText.setBackgroundResource(android.R.drawable.editbox_background_normal); 
```

我在这里找到了这个答案： [Removing the background color of an EditText](https://stackoverflow.com/questions/9213449/removing-the-background-color-of-an-edittext)

一个警告，即使此代码会将 EditText 恢复为它的外观，它可能与原始外观不匹配。我这么说是因为那是我所经历的，但这对我来说已经足够了。

# ios - 将 iOS 应用程序版本恢复到旧版本

> ID：11874053
> 
> 赞同：5
> 
> 时间：2012-08-08T22:19:50.420
> 
> 标签：ios, app-store, itunes, reverse

一旦我的新版本被证明并发布，如果我想回滚，iTunes是否具有恢复到以前版本的功能，或者我应该重新提交旧版本？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-08T22:26:32.650

一旦应用程序版本获得批准并发布到 App Store，就无法删除该版本。如果您仍处于审批流程中并想要拉取提交并中止流程，那么您可以。

# php - 如何使用 Auth 组件更改输入值？

> ID：11874054
> 
> 赞同：-2
> 
> 时间：2012-08-08T22:20:22.023
> 
> 标签：php, cakephp

我正在使用最新版本的 CakePhp。

我开发了一个带有电子邮件和密码的简单网络表单（我使用电子邮件而不是用户名）。

现在我有以下问题。

我在数据库中加密了电子邮件字段，因此，我不能按原样使用身份验证组件，因为它会检查计划电子邮件和散列密码。我需要加密的电子邮件和散列密码。

那么现在，在 login() 之前，我如何更改电子邮件字段的值？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T05:04:15.807

`AuthComponent`仍然适合您的情况。

如果您包含指定电子邮件地址也是“用户名”的组件

```
public $components = array(
    'Auth' => array(
        'authenticate' => array(
            'Form' => array(
                'fields' => array('username' => 'email')
            )
        )
     )
); 
```

然后在调用登录方法之前加密电子邮件地址。

```
 $this->request->data['User']['email'] = someEncryption($this->request->data['User']['email']);
 $this->Auth->login(); 
```

希望这可以帮助

更多信息： [http ://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#creating-custom-authentication-objects](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#creating-custom-authentication-objects)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:52:08.067

您可以在调用之前创建自定义`FormAuthenticate`类或加密电子邮件。`$this->request->data``$this->Auth->login()`

如果您使用第一个选项，请将未加密的电子邮件保存在 tmp var 中，如果登录失败，请恢复未加密的值，以便加密的值不会出现在表单中。

对于自定义身份验证类：[http ://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#creating-custom-authentication-objects](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html#creating-custom-authentication-objects)

# objective-c - NSInvocation getReturnValue: 内部调用 forwardInvocation: 使返回的对象调用 dealloc:

> ID：11874056
> 
> 赞同：6
> 
> 时间：2012-08-08T22:20:33.663
> 
> 标签：objective-c, nsinvocation

`test.m`这是我用来测试行为的独立文件。

编译：`clang test.m -o test.app -fobjc-arc -ObjC -framework Foundation`. 确保安装了 Xcode 命令行工具。

```
#import <Foundation/Foundation.h>

@protocol Protocol

@optional
- (id)objProxyMethod;

@end

@interface ReturnObject: NSObject

@end

@interface Test : NSObject <Protocol>

@end

@interface Proxy : NSObject <Protocol>

- (id)objProxyMethod;

@end

@implementation ReturnObject

- (void)dealloc {
    NSLog(@"ERROR:");
    NSLog(@"I'm getting deallocated!");
    NSLog(@"This shouldn't happen!");
}

- (NSString *)description {
    return @"Blank object!";
}

@end

@implementation Proxy

- (id)objProxyMethod {
    NSLog(@"in [Proxy objProxyMethod]!");
    return [[ReturnObject alloc] init];
}

@end

@implementation Test

- (void)forwardInvocation:(NSInvocation *)invocation {
    NSLog(@"Forwarded invocation!");
    Proxy *proxy = [[Proxy alloc] init];
    [invocation invokeWithTarget: proxy];
    NSUInteger length = [[invocation methodSignature] methodReturnLength];
    if (length == 8) {
        id result;
        [invocation getReturnValue:&result];
    }
}

@end

int main () {
    Test *test = [[Test alloc] init];
    id objResult = [test objProxyMethod];
    NSLog(@"objResult = \"%@\"", objResult);

    return 0;
} 
```

如果我注释掉`[invocation getReturnValue:&result];`，返回的对象不会被`dealloc`吃掉。我不知道这是否是一个错误，或者只是我误解了它的`NSInvocation`工作原理。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-08T22:40:57.607

问题是`result`默认`__strong`情况下，所以当它超出范围时，编译器会`release`为它生成一个。但是`getReturnValue:`没有给你返回对象的所有权，所以你的方法不应该释放它。

您可以通过更改以下声明来解决此问题`result`：

```
__unsafe_unretained id result; 
```

这可以防止编译器在超出范围时生成`release`for 。如果需要保留它，可以将其复制到另一个变量。`result``result``__strong`

您还可以添加一个类别来`NSInvocation`为您处理此问题：

```
@interface NSInvocation (ObjectReturnValue)

- (id)objectReturnValue;

@end

@implementation NSInvocation (ObjectReturnValue)

- (id)objectReturnValue {
    __unsafe_unretained id result;
    [self getReturnValue:&result];
    return result;
}

@end

...
    if (length == 8) {
        id result = [invocation objectReturnValue];
    }
... 
```

您也可以将此报告为错误。我希望编译器，或者至少是静态分析器，会警告您正在将指向强指针的指针转换为`id`空指针。[http://bugreport.apple.com](http://bugreport.apple.com)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-29T08:55:42.017

这是因为 ARC 无法管理写成指针的对象。只能直接赋值。

**错误的：**

```
id result;
[invocation getReturnValue:&result]; 
```

**正确的：**

```
void *pointer;
[invocation getReturnValue:&pointer];

id result = (__bridge id)pointer; //Correct, ARC will retain pointer after assignment 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T22:36:58.747

```
if (length == 8) {
    id result; //this is nil (its also a stack allocated pointer)
    [invocation getReturnValue:&result];  //sets the value to an object
}

...method ends object is deallocated 
```

您必须将结果设置为未分配堆栈或不调用 getReturnValue 的指针。

API 可能会假设，因为您调用了 getReturnValue，您将保留（并可能使用返回值）。你没有。当您删除 getReturnValue 时，返回值是否在 main 方法中正确返回？苹果文档说返回值是自动返回的。

我假设确实如此。

# c# - 实体框架查询本地默认

> ID：11874058
> 
> 赞同：1
> 
> 时间：2012-08-08T22:21:05.247
> 
> 标签：c#, asp.net, asp.net-mvc, entity-framework

我想在访问数据库之前在搜索时在使用本地跟踪实体的实体框架中执行查询。我编写了一个复杂的例程来填充存储库/数据库，现在当我使用实体框架时，它不会使用已经添加但尚未保存的实体。因此，这段代码应该只向数据库添加一个类别，而不是添加 n。

```
using (Db Db = new Db()) {
    for (int i = 0; i < 10; i++) {
        Category Category = Db.Categories.SingleOrDefault(x => x.Name == "Hello");
        if (Category == null) {
            Category = Db.Categories.Create();
            Category.Name = "Hello";
            Db.Categories.Add(Category);
            Console.WriteLine("Adding item...");
        }
    }
} 
```

我该怎么做呢？我有一个抽象，允许我从 IQueryable 更改提供程序，我尝试使用它来首先访问 Local 集合。我没有成功。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:37:45.940

这是一种非常简单易读的方法，尽管它可能不是您想要的：

```
using (Db Db = new Db()) {
    var newCategories = new List<Category>();
    for (int i = 0; i < 10; i++) {
        Category category = newCategories.SingleOrDefault(x => x.Name == "Hello");
        if (category == null) {
            category = Db.Categories.SingleOrDefault(x => x.Name == "Hello");
            if (category == null) {
                category = Db.Categories.Create();
                category.Name = "Hello";
                Db.Categories.Add(category);
                newCategories.Add(category);
                Console.WriteLine("Adding item...");
            }
        }
    }
} 
```

编写自己的 IQueryable 提供程序是一项非常复杂的任务。

编辑：我发现[这篇文章](https://stackoverflow.com/questions/699648/entity-framework-re-finding-objects-recently-added-to-context)更详细地说明了为什么您尝试做的事情不起作用。

以为我不知道您的具体情况是什么，您应该在查询数据存储之前尝试从您的集合中删除重复项。上述解决方案同时执行此操作。

希望这可以帮助。

# html - 之前和之后选择器的行为不符合预期

> ID：11874062
> 
> 赞同：0
> 
> 时间：2012-08-08T22:21:18.050
> 
> 标签：html, css, css-selectors

我有以下CSS：

```
#clickto {
    color: white;
    text-shadow: 2px 2px 2px Darkblue;
}

#verdescheading:hover {
    border-bottom: 1px solid;
}

    #verdescheading :before {
        content: " >";
    }

    #verdescheading :after {
        content: " <";
    }

    #verdescheading .clicked:before {
        content: "< ";
    }

    #verdescheading .clicked:after {
        content: "> ";
    } 
```

和以下html（直接从firebug剪切和粘贴，所以它是准确的）：

```
<h1 id="verdescheading" class="">
Important notice
<span id="clickto">(Click to expand)</span>
</h1> 
```

单击事件的标题部分时，将“verdescheading”类设置为“单击”。Firebug 显示一切都按应有的方式设置。但是，我在页面上*看到*的有点不同。

首先，根据样式表设置的 > 和 < 符号，不是出现在具有 id verdesc 的 h1 之前和之后，而是具有 id 'clickto' 的跨度，即它的直接子级。Firebug 清楚地表明“点击”类是在父级而不是子级上设置的。

另一件事是符号不会改变，即它始终是 :before 和 :after 的规则，而不是 .clicked:before 和 .clicked:after 的规则。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T22:26:56.400

```
#verdescheading.clicked:before {
    content: "< ";
}

#verdescheading.clicked:after {
    content: "> ";
} 
```

将修复符号不变，因为 id 和 class 位于同一元素上，而不是其子元素之一，因此没有空间。

其他的也解决了间距问题：

```
#verdescheading:before {
    content: " >";
}

#verdescheading:after {
    content: " <";
} 
```

请参阅由[bfavaretto](http://jsfiddle.net/BWghm)提供的 JSFiddle jsfiddle.net/BWghm

# c# - 从现有的 silverlight 应用程序开发 Windows 移动应用程序

> ID：11874066
> 
> 赞同：0
> 
> 时间：2012-08-08T22:21:28.970
> 
> 标签：c#, silverlight, windows-phone-7, microsoft-metro

我开发了一个动态数据网格 Silver light 4.0 Web 应用程序。[你可以假设它是一个带有一些动画的数据拉取网格] 这个 Web 应用程序非常庞大，有大约 10 个 Xaml 文件和一个大型 Ms-Sql 数据库。我还使用了 Sivlerlight 的 Web 服务来获取数据。

现在，我正计划为我的软件构建一个 WINDOWS Mobile 应用程序。我需要一些建议。

我是否需要从头开始开发 Windows 应用程序。（或）我能否重用我在 Web 应用程序中使用的 Silver light Xaml 文件。如果我使用相同的 XAP 文件，是否会产生任何性能问题？

有任何顾虑/即兴创作/评论吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T21:50:12.037

如果它是 Windows Mobile（而不是 Windows Phone），那么没有。微软从未向 Windows Mobile 提供 Silverlight（最初计划将其移植到 WM6.1，但在 WP7 工作开始时就放弃了）。

如果是 Windows Phone，那就看情况了。我知道 WP7 上的 Silverlight 有不同的小部件集可用，但您的 XAML 和应用程序代码只需稍作修改即可工作（当然，假设您已经重新设计以适应 WP7 的屏幕尺寸）。

# terminal - UNIX 将 tty 重定向到不同终端中的 c++ 标准输入

> ID：11874069
> 
> 赞同：1
> 
> 时间：2012-08-08T22:21:41.627
> 
> 标签：terminal, pipe, stdin, tty, io-redirection

我有一个简单的命令行 c++ 程序，如下所示，它从命令行获取标准输入。我的 Mac 上打开了 2 个 SSH 终端。一个是/dev/ttys001，一个是/dev/ttys000。我想在一个终端中回显一个值，并使用我的程序在第二个终端的标准输入中使用它。我似乎无法做到这一点。什么是正确的语法？谢谢 -

我尝试了以下变体，但没有运气。在我正在运行 ./test 的终端中，它会提示输入数字，并且来自另一个终端的回显肯定会显示在控制台上，但程序不会将其视为标准输入？

1号航站楼：

```
./test < /dev/ttys001 
```

2号航站楼：

```
echo 2 > /dev/ttys001 
```

我的程序：

```
#include <iostream>

using namespace std;

int main() {
    cout << "Enter a number: ";
    int nb;
    cin>>nb;
    cout << "Here is your number:" << nb << endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T22:36:57.420

我不确定你可以那样做。但是，您可以使用命名管道。在 1 号航站楼：

```
mkfifo mypipe

myprogram < mypipe 
```

然后在 2 号航站楼：

```
echo > mypipe 
```

然后打字。但是您的代码看起来只会执行一次然后终止，因此您可能需要添加一个循环。

# django - 使用 Django 模型进行单元测试并涉及很多关系

> ID：11874071
> 
> 赞同：10
> 
> 时间：2012-08-08T22:21:52.713
> 
> 标签：django, unit-testing, django-models

或者，“如何设计您的数据库模式以便于进行单元测试？”

顺便说一句，这里有一个非常相似的问题： [How to test Models in Django with Foreign Keys](https://stackoverflow.com/questions/3690022/how-to-test-models-in-django-with-foriegn-keys)

我正在尝试为使用框架 Django 的项目遵循 TDD 方法。我正在创建和测试模型及其功能（保存方法、信号等）以及其他依赖于模型的高级功能。

我知道单元测试必须尽可能隔离，但我发现自己使用 FactoryBoy 为每个测试创建了很多表和关系，所以我的测试不够强大，因为如果模型中的某些内容发生变化，许多测试可能会被破坏。

如何避免所有这些依赖并使测试更干净？

你们建议在实际测试之前避免所有的样板吗？

最佳实践是什么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-14T20:36:35.050

没有用于测试的*最佳实践*列表，其中有很多*对您*和您正在从事的特定项目有用的方法。我同意 pyriku 的说法：

> 你不应该根据你想要的测试方式来设计你的软件

但是，我要*补充*一点，如果你有一个好的和**模块化**的软件设计，它应该很容易正确测试。

我最近在我的工作中对单元测试有点兴趣，并且我在 Python 中发现了一些有趣且有用的工具，*FactoryBoy*就是其中之一，而不是在测试的 setUp() 方法中准备大量对象类，您可以为每个模型定义一个工厂，并在需要时批量生成它们。

你也可以试试*Mocker*，它是一个模拟对象的库，因为在 Python 中**一切**都是对象，你也可以模拟函数，如果你需要测试一个在一天中的某个时间生成 X 事件的函数，它会很有用，例如，在上午 10:00 发送一条消息，您编写一个总是返回 '10:00am' 的 datetime.datetime.now() 模拟，并**使用**该模拟调用该函数。

如果您还需要测试一些前端或者您的测试需要一些人机交互（例如针对 执行 OAuth 时），您可以使用*Selenium*填写和提交这些表单。

在您的情况下，要准备与 FactoryBoy 有关系的对象，您可以尝试覆盖 Factory._prepare() 方法，让我们使用这个简单的 django 模型来完成：

```
class Group(models.Model):
    name = models.CharField(max_length=128)
    members = models.ManyToManyField(User, blank=True, null=True)

    # ... 
```

现在，让我们定义一个简单的 UserFactory：

```
class UserFactory(factory.Factory):
    FACTORY_FOR = User

    first_name = 'Foo'
    last_name = factory.Sequence(lambda n: 'Bar%s' % n)
    username = factory.LazzyAttribute(lambda obj: '%s.%s' % (obj.first_name, obj.last_name)) 
```

现在，假设我想要或需要我的工厂生成具有 5 个成员的组，GroupFactory 应该如下所示

```
class GroupFactory(factory.Factory):
    FACTORY_FOR = Group

    name = factory.Sequence(lambda n: 'Test Group %s' % n)

    @classmethod
    def _prepare(cls, create, **kwargs):
        group = super(GroupFactory, cls)._prepare(create, **kwargs)
        for _ in range(5):
            group.members.add(UserFactory())
        return group 
```

希望这会有所帮助，或者至少给了你一盏灯。在这里，我将留下一些与我提到的工具相关的资源链接：

工厂男孩：[https ://github.com/rbarrois/factory_boy](https://github.com/rbarrois/factory_boy)

嘲笑者： http: [//niemeyer.net/mocker](http://niemeyer.net/mocker)

硒：[http ://selenium-python.readthedocs.org/en/latest/index.html](http://selenium-python.readthedocs.org/en/latest/index.html)

还有另一个关于测试的有用线程：

[在 Django 中测试“不同层”的最佳实践是什么？](https://stackoverflow.com/questions/11543117/what-are-the-best-practices-for-testing-different-layers-in-django/11546195#11546195)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-07T19:27:39.143

尝试使用[Mixer](https://github.com/klen/mixer)。它比 'factory_boy' 简单得多，而且功能更强大。您无需设置工厂，并在需要时获取数据：

```
from mixer.backend.django import mixer

mixer.blend(MyModel) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T16:06:40.030

I'm not really sure if you need to go **that** deep. You should not design your software basing on how you want to test it, you need to adapt your way of testing to the tools you're using.

Say that you want to get that level of granularity, like mocking FK and M2M models when you test some model, right? Something like

```
class Invoice(models.Model):
    client = models.ForeignKey(Client) 
```

and in your tests, you want to test only `Invoice` model, without dealing with `Client` model. Is that right? So, why don't you mock the database backend too, and just test ONLY what your model should do?

My point is that you don't need to get to that level. Add some tests to your models for non-trivial things like signals, methods, check that the model creations are working (can even avoid this if you trust the database), and when you need to work with external models just create what you need on the test's `setUp()` method.

Also if you want you can mock whatever you want using Python's mock library: [http://www.voidspace.org.uk/python/mock/](http://www.voidspace.org.uk/python/mock/). If you really want to do TDD, you can use it for mock your FK in each test, but if you change that model, you will need to change all the mockers too.

# objective-c - 在 NSDictionary 中设置和获取 BOOL 值

> ID：11874073
> 
> 赞同：1
> 
> 时间：2012-08-08T22:22:01.780
> 
> 标签：objective-c, nsdictionary

我需要一个指向布尔值的字符串字典。

我有一个像这样创建的 NSDictionary toolStates

```
NSArray *keys = [NSArray arrayWithObjects:@"X", @"Y", nil];
NSArray *isActive = [NSArray arrayWithObjects:[NSNumber numberWithBool:NO], [NSNumber numberWithBool:YES], nil];
toolStates = [NSDictionary dictionaryWithObjects:isActive forKeys:keys]; 
```

在我班的其他地方，我正在尝试检索和比较这样的布尔值

```
if ([toolStates valueForKey: @"X"] == [NSNumber numberWithBool:NO]) NSLog(@"%s", "X = NO"); 
```

我知道这两个部分的代码都在运行，但我在 if 语句中收到“EXC_BAD_ACCESS”错误，并输出：

```
<Error>: CGAffineTransformInvert: singular matrix. 
```

比较有什么问题吗？

当我尝试这个时，我得到了同样的错误：

```
[toolStates setValue:[NSNumber numberWithBool:YES] forKey:@"X"]; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-08T22:54:06.867

您所写的内容存在一些问题，但我认为它们都不是您当前问题的原因（见下文）。让我们来看看几个问题。

1.  你`[toolStates setValue:forKey:]`不能像书面的那样工作，因为你有一个`NSDictionary`，不是`NSMutableDictionary`。
2.  `-valueForKey:`返回`id`（即它将返回您的`NSNumber`实例，而不是`BOOL`. 因此，您的比较不正确。您`==`正在进行指针比较，这不是您想要的。（如果优化为返回单例，它*可能*在这里工作，但那不是行为你应该指望。）在Objective-C中进行相等比较的正确方法是方法，例如.`NSNumber``+numberWithBool:``-isEqual:``if ([[toolStates valueForKey:@"X"] isEqual:[NSNumber numberWithBool:NO])`

但是你得到了`EXC_BAD_ACCESS`这通常意味着你正在访问一个被释放的对象。我的怀疑是因为您收到与核心图形相关的错误，这与您的代码无关（表明您的垃圾指针现在指向与图形相关的东西）。

你在用ARC吗？如果没有，我认为您不会`toolStates`在任何地方保留。如果您不是，并且您在运行循环的下一轮（听起来像）之后访问它，那么您会期望崩溃。如果这听起来不正确，或者您找不到问题，请尝试以下操作：

1.  通过 Xcode 静态分析器 (Clang) 运行您的代码。修复它向您抛出的任何警告。
2.  在启用僵尸的情况下运行您的代码，并注意“发送到已释放实例的消息”或类似的东西。

# eclipse - Eclipse - 如何获取导致异常的行？

> ID：11874076
> 
> 赞同：1
> 
> 时间：2012-08-08T22:22:08.477
> 
> 标签：eclipse, exception

我的 Java 1.6-Oracle11g-JDBC（即 OJDBC6）代码中出现了一些 SQLExceptions。但我无法看到是哪一行代码导致了问题。如何使用 Eclipse 找出问题所在的代码行？

我的代码的输出 -

```
Running main...
Exception- java.sql.SQLSyntaxErrorException: ORA-00911: invalid character
Exiting main... 
```

谢谢。

PS-我认为没有必要将代码放在这里。我只想知道哪一行负责并自己修复代码。我尽量少接受额外的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T22:31:15.680

您在某处有一些遵循此模式的代码：

```
try 
    {
    ...
    }
catch (Exception err)
    {
    System.out.println("Exception- "+err);
    } 
```

这是一个糟糕的模式，因为如您所见，只报告异常消息并且异常消失。

要么使用`err.printStackTrace(System.out)`（如果你真的想要在 stdout 而不是 stderr 上输出），或者`err.printStackTrace()`. ***或者***，根本不捕获异常，JVM 将打印整个堆栈跟踪。

堆栈跟踪包含类、方法、文件名和行号。当堆栈跟踪被打印出来时，Eclipse 的控制台会将文件名和行号转换为一个超链接，您只需单击该超链接即可转到源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T22:25:19.407

我假设您的主要方法中的某个地方捕获了异常？无论他们在哪里被抓到，都做一个`myException.printStackTrace()`. 或者，只需使用调试器运行您的代码并逐行查看它在哪里搞砸了。

# sitecore - 在 Sitecore 中使用 target="_blank" 呈现一般链接

> ID：11874079
> 
> 赞同：2
> 
> 时间：2012-08-08T22:22:38.160
> 
> 标签：sitecore

在 Sitecore 中，我有一个`General Link`设置为外部链接。呈现此链接以便进入`target="_blank"`我的页面并在新窗口中打开的最简单方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-09T05:58:26.730

如果我对您的理解正确，您有一个通用链接字段，并且您希望它包含一个在新窗口中打开的参考。如果是这种情况，下图应该可以回答您的问题：

![在此处输入图像描述](../Images/9a5260740dc58d1b3d4b52f51fef7454.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-09T12:12:20.287

除了 Yan 所说的在 Sitecore 中配置链接之外，如果您需要代码来呈现它，您可以使用 a`FieldRenderer`或 C# 中的 API 来访问该字段。

例如

```
<sc:Link Field="Your Field Name" runat="server" /> 
```

或者

```
<sc:FieldRenderer FieldName="Your Field Name" runat="server" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-03T13:52:48.457

如果您有一个基于 Sitecore API 构建的框架，您也可以在代码中执行此操作

```
Sitecore.Web.UI.WebControls.FieldRenderer fieldRenderer =
    new Sitecore.Web.UI.WebControls.FieldRenderer();

fieldRenderer.Item = MySitecoreItem;
fieldRenderer.FieldName = "Link";
return fieldRenderer.Render(); 
```

“链接”硬代码特定于 Sitecore，用于系统提供的链接模板，您可以在代码中重用它。

`MySitecoreItem`是 的一种`Sitecore.Data.Items.Item`。

我遇到了一个问题，我可以通过说从项目中获取 URL `LinkManager.GetItemUrl()`，但是如果不退出正则表达式或`String.Split()`在请求`Item.Field[0].Value`.

上述方法将链接呈现为我可以直接写入浏览器的字符串，并且可以像您期望的锚标记那样工作。

# perl - 测试::简单检查文件是否存在

> ID：11874080
> 
> 赞同：2
> 
> 时间：2012-08-08T22:22:45.153
> 
> 标签：perl, unit-testing

有没有办法使用 test::simple 检查文件是否存在？我对 perl 很陌生，我阅读了所有 test::tutorial，很简单。我假设我需要在模块中创建一个 sub，但我可以添加常规 perl 代码来检查文件吗？如果是这样，我如何从测试文件中调用它？

抱歉，我没有代码，因为我真的不明白。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T22:28:29.937

这应该工作

```
$filename = '/path/to/your/file.doc';
 if (-e $filename) {
 print "File Exists!";
 } 
```

要查看是否允许读取、写入或执行文件，我们可以使用这些而不是`-e`上面的：

```
Readable: -r
Writable: -w
Executable: -x 
```

使用测试::简单

```
use Test::Simple tests => 1;
my $filename='/path/to/your/file.doc';

ok(checkfile($file)==1,'File found');

sub checkfile{
    if (-e $_[0]) { return 1;}
    else { return 0; }
} 
```

或者

```
use Test::Simple tests => 1;
my $filename='/path/to/your/file.doc';

ok(-e $filename,'File found'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-19T12:29:38.713

[Test::File](https://metacpan.org/pod/Test::File)似乎很适合这种需求。

```
use Test::File;
file_exists_ok $filename, "Check the file exists"; 
```

# html - 在 td 中添加另一个图像？

> ID：11874082
> 
> 赞同：2
> 
> 时间：2012-08-08T22:22:54.133
> 
> 标签：html, css, css-float

我想`<tr class="sub-title">`在右边的位置添加一个箭头图像。

`td`在不添加另一个的情况下这样做的正确方法是什么`<tr class="sub-title">`？

`.sub-title td`包含背景图像和文本对齐中心。

`.sub-title .arrow-toggle`包含箭头图像。

```
<table style="margin-top:-185px;" border="1">
  <tbody>
    <tr> <td> Item 1 </td> </tr>
    <tr class="sub-title">
        <td colspan="5">Sub-Title Here<span class="arrow-toggle"></span></td>
    </tr>
    <tr> <td> Item 2 </td> </tr>
    <tr> <td> Item 2 </td> </tr>
</tbody>
</table> 
```

CSS

```
.sub-title .arrow-toggle {
        background: url(/public/images/toggle-arrow.png) no-repeat;
        width: 20px;
        height:20px;
        float:right;
    }

    .sub-title td {
        background: url(/public/images/subtitle.gif) repeat-x;
        color:white;
        padding: 5px;
        font-weight: bold;
        border-top:none;
        border-bottom:1px solid #4799bd;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:33:30.810

你实际上几乎在那里。您只是忘记了 span 是一个内联元素，它不能有一个 floet，宽度和高度应用于它。只需添加`display: block`到您的 .arrow-toggle 类就可以了。

# wordpress - WordPress edit_user() 和 Cimy 用户额外字段

> ID：11874083
> 
> 赞同：0
> 
> 时间：2012-08-08T22:22:55.193
> 
> 标签：wordpress, updates

我创建了一个页面来更新用户的 WordPress 个人资料。该站点使用 cimy 用户额外字段，并在用户配置文件中添加了几个自定义字段。该页面获取所有用户数据并输入表单中的相应字段。用户可以进行他们需要的任何更改，然后单击提交。

发布表单时调用edit_user()。它返回所有额外字段为空的错误。我可以回显 $_POST 变量，它们都在那里。这些名称与它们在 cimy 设置面板中的名称相匹配。标准的 WordPress 字段很好。我不确定是否需要切换到 edit_user() 以外的其他方法，我查看了其他几种方法，但没有什么比 edit_user() 更好，或者我需要做些什么才能更新cimy 额外字段。

这是代码：

```
if(!empty($_POST['action'])){
    require_once(ABSPATH . 'wp-admin/includes/user.php');
    require_once(ABSPATH . WPINC . '/registration.php');
    check_admin_referer('update-profile_' . $user_ID);
    $errors = edit_user($user_ID);
    echo $_POST['church'];
    if ( is_wp_error( $errors ) ) {
        foreach( $errors->get_error_messages() as $message )
        $errmsg .= "$message ";
    }
    if($errmsg == ''){
        do_action('personal_options_update', $user_id);
        $d_url = $_POST['dashboard_url'];
        wp_redirect( get_option("siteurl").'?page_id='.$post->ID.'&updated=true' );
    }
    else {
        $errmsg = '<div class="box-red">** ' . $errmsg . ' **</div>';
        $errcolor = 'style="background-color:#FFEBE8;border:1px solid #CC0000;"';
    }
} 
```

像往常一样，我确信我忽略了一些明显的东西。

任何想法将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T19:15:30.657

我想到了。该插件将 cimy_uef_ 添加到字段名称的前面。一旦我补充说一切正常。

# ios - NSManagedObject 的 KVO 方法调用外部二进制数据属性导致表格视图滚动迟缓，为什么？

> ID：11874084
> 
> 赞同：-1
> 
> 时间：2012-08-08T22:23:10.667
> 
> 标签：ios, uitableview, core-data, nsfetchedresultscontroller

经过数周的调试，我终于找到了表格视图滚动期间零星滞后的罪魁祸首。它们是`-willChangeValueForKey:`并且`-didChangeValueForKey:`需要外部二进制数据属性。

为方便起见，您可以将我的应用程序视为 Twitter 客户端。所以主要实体是`Tweet`具有`thumbnail_pic_data`我设置为的属性`allowsExternalBinaryDataStorage`。一个相应的非持久属性被称为`thumbnail_picture`被用作其方便的访问器。

表格视图是一个推文列表视图——时间线，每条推文都`thumbnail_picture`显示在其相应单元格的内联中。图片是懒惰下载的。下载成功后，我`thumbnail_pic_data`使用自定义设置器进行如下设置：

```
- (void)setThumbnail_pic_data:(NSData *)thumbnail_pic_data {
    [self willChangeValueForKey:@"thumbnail_pic_data"]; // culprit
    [self setPrimitiveThumbnail_pic_data:thumbnail_pic_data];
    [self didChangeValueForKey:@"thumbnail_pic_data"]; // culprit

    UIImage *picture;
    if (thumbnail_pic_data) {
        picture = [UIImage imageWithData:thumbnail_pic_data];
    }
    self.thumbnail_picture = picture;
} 
```

使用上面的代码，我在每张图片下载后的表格视图滚动期间看到零星的滞后。在我发表评论`willChangeValueForKey:`并`didChangeValueForKey:`打电话后，滞后消失了。所以我知道他们是罪魁祸首。

但是，我用下面的代码得到的计时结果表明，它们长时间没有*直接使用CPU：*

```
CFAbsoluteTime t1 = CFAbsoluteTimeGetCurrent();
[self willChangeValueForKey:@"thumbnail_pic_data"];
CFAbsoluteTime t2 = CFAbsoluteTimeGetCurrent();
NSLog(@"willChangeValueForKey time: %f", t2 - t1);
[self setPrimitiveThumbnail_pic_data:thumbnail_pic_data];
CFAbsoluteTime t3 = CFAbsoluteTimeGetCurrent();
NSLog(@"setPrimitiveThumbnail_pic_data time: %f", t3 - t2);
[self didChangeValueForKey:@"thumbnail_pic_data"];
CFAbsoluteTime t4 = CFAbsoluteTimeGetCurrent();
NSLog(@"didChangeValueForKey time: %f", t4 - t3); 
```

计时结果：

> willChangeValueForKey 时间：0.000145
> setPrimitiveThumbnail_pic_data 时间：0.001512
> didChangeValueForKey 时间：0.001810
> 
> willChangeValueForKey 时间：0.000138
> setPrimitiveThumbnail_pic_data 时间：0.001418
> didChangeValueForKey 时间：0.002211
> 
> willChangeValueForKey 时间：0.000302
> setPrimitiveThumbnail_pic_data 时间：0.001891
> didChangeValueForKey 时间：0.003349
> 
> willChangeValueForKey 时间：0.000162
> setPrimitiveThumbnail_pic_data 时间：0.001462
> didChangeValueForKey 时间：0.002114

作为临时解决方法，我将把这两个 KVO 调用注释掉。我不确定是否会发生任何不好的事情`Core Data Programming Guide`说：

> 您必须确保调用相关的访问和更改通知方法（willAccessValueForKey:、didAccessValueForKey:、willChangeValueForKey:、didChangeValueForKey:、willChangeValueForKey:withSetMutation:usingObjects: 和 didChangeValueForKey:withSetMutation:usingObjects:）。

最重要的是，我想知道为什么这两个 KVO 调用会导致表格视图滚动缓慢，希望我能找到更好的解决方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T04:25:38.083

请允许我提出一种不同的方法，而不是将数据/图像保存为瞬态属性，而是将图像的名称另存为瞬态属性。图像的 NSData 对象对您来说似乎没有用，因此，不要浪费内存来保存它，因为您似乎唯一需要内容的就是生成图像，而是使用来自网络的 NSData 创建 NSImage 对象，并将其分配给一个 NSCache 值，其中图像的名称（您的 NSManagedObject 对象的瞬态属性）作为图像对象的键。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-27T21:55:26.760

最后，我找到了。

`-willChangeValueForKey:`并且在我的情况下，如果在滚动期间频繁调用它们，`-didChangeValueForKey:`则会导致`NSFetchedResultsControllerDelegate`调用这些方法非常耗时。省略这两个 KVO 调用可以让我省去那些不必要的`NSFetchedResultsControllerDelegate`方法调用，但我不应该这样做，因为 Apple 文档明确告诉我们不要这样做，而且我确实看到如果我这样做会发生不好的事情。

本质上，这个问题需要相同的解决方案[如何知道 NSFetchedResultsChangeUpdate 更改了哪个属性？](https://stackoverflow.com/questions/11869520/how-to-know-which-property-is-changed-for-nsfetchedresultschangeupdate)

# c++ - 如何在 Visual Studio 中强制生成错误输出的绝对路径

> ID：11874086
> 
> 赞同：1
> 
> 时间：2012-08-08T22:23:28.033
> 
> 标签：c++, visual-studio-2008, build, vcbuild

在大多数 Visual Studio（2008，但我怀疑它是否重要）项目中构建时，如果有错误，它会列出错误文件的绝对路径。像这样（忽略具体的错误——我是故意添加的）：

```
1>dope_external.cpp
1>c:\users\me\dope_external.cpp(4) : error C2144: syntax error : 'void' should be preceded by ';'
1>c:\users\me\dope_external.cpp(4) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int
1>Generating Code... 
```

但是，我目前正在使用的解决方案/项目列出了相对路径名：

```
1>FileBasedEffect.cpp
1>..\..\..\..\..\..\..\..\tools\blah\code\src\important_file.cpp(10) : error C2653: 'FusionEffectKeys' : is not a class or namespace name
1>..\..\..\..\..\..\..\..\tools\blah\code\src\important_file.cpp(10) : error C2143: syntax error : missing ';' before 'const'
1>..\..\..\..\..\..\..\..\tools\blah\code\src\important_file.cpp(10) : error C4430: missing type specifier - int assumed. Note: C++ does not support default-int 
```

这发生在 Visual Studio 中，如果我从命令行或使用 vcbuild 在另一个环境中构建，也会发生这种情况。我想使用不同的环境来构建，至少作为一个实验。但是相对路径让我有点害怕。

我没有发现项目属性中有任何明显的差异，例如“UseRelativePathsInBuildErrors”，但我不太了解构建系统。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T16:23:30.497

我找到了解决方案。

在项目属性->配置属性->c/c++->高级中，有一个“使用完整路径”选项似乎使 vcbuild 将[/FC](http://msdn.microsoft.com/en-us/library/027c4t2s%28v=vs.80%29.aspx)标志传递给 cl.exe。这会在输出中产生完整路径。

这样就解决了我的问题...但是在我已经看到完整路径的情况下没有设置该选项，所以这里还有其他东西在起作用。

# python - 确定 Python 数字文字表示的 Number 的种类（int，float）？

> ID：11874087
> 
> 赞同：2
> 
> 时间：2012-08-08T22:23:29.743
> 
> 标签：python, tokenize, standard-library, number-literal

*如果有人感兴趣，这是[正则表达式的后续，以匹配 Python 整数文字](https://stackoverflow.com/questions/11733262/regular-expression-to-match-a-python-integer-literal)。*

该`tokenize`模块对于分解 Python 表达式很有用，但`tokenize.NUMBER`不是很有表现力，因为它表示各种数字文字，例如，，（`1`在`1l`Python 2 中），，，，，，，，并且都被认为是 NUMBER（以及所有前一个用大写字母）。标准库中是否有一个函数可以告诉我上面的内容是什么？我特别关心我是否有整数或浮点数（复数也被认为是浮点数），但进一步的表现力也可以:)。基本上，我不想自己尝试捕捉所有可能的数字文字，因为我已经成功地做错了一次。 `0xf2``1e-10``1.1``0b101``0o17``1j`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T22:30:29.750

您可以使用[ast.literal_eval](http://docs.python.org/library/ast.html#ast.literal_eval)将任何 Python 数字格式解析为 int、float 或 long：

```
>>> ast.literal_eval('1')
1
>>> ast.literal_eval('1l')
1L
>>> ast.literal_eval('0x2')
2
>>> ast.literal_eval('0b1101')
13 
```

请记住，Python 中没有“hex”、“oct”或“bin”类型。这些文字字符串立即转换为其十进制等价物。

这很好用：

```
def numtype(s):
    numtypes=[int,long,float,complex]

    try:
        n=ast.literal_eval(s)
    except SyntaxError:
        return None

    if type(n) not in numtypes:
        return None  
    else:
        return type(n)    

for t in ['1','0x1','0xf2','1e-10','0o7','1j', '0b1101']:
    print t, numtype(t) 
```

印刷：

```
1 <type 'int'>
0x1 <type 'int'>
0xf2 <type 'int'>
1e-10 <type 'float'>
0o7 <type 'int'>
1j <type 'complex'>
0b1101 <type 'int'> 
```

如果您真的需要区分不同的十进制类型，您可以执行以下操作：

```
def numtype(s):
    numtypes=[int,long,float,complex]

    try:
        n=ast.literal_eval(s)
    except SyntaxError:
        return None

    if type(n) not in numtypes:
        return None    

    if type(n) != int:
        return type(n)
    else:
        if 'x' in s.lower():
            return 'HEX'
        if 'o' in s.lower():
            return 'OCT'   
        if 'b' in s.lower():
            return 'BIN'     

        return int 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T22:33:14.787

可能[`ast.literal_eval`](http://docs.python.org/library/ast.html#ast.literal_eval)吗？

```
type(ast.literal_eval(s)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T22:36:02.553

```
def is_int(number_string):
    try:
        i = int(number_string)
    except ValueError:
        return False
    return True 
```

# android - 当我将非资源 PNG 文件添加到我的 Android 项目时，Eclipse 给出“无效的资源目录名称”

> ID：11874090
> 
> 赞同：2
> 
> 时间：2012-08-08T22:23:57.043
> 
> 标签：android, eclipse

我想在 Eclipse 中将 PNG 文件与我的 Android 项目相关联，但我不想实际发布它——它只是我用来生成 icon.png 文件的各种 icon.png 文件的更高分辨率版本。但是无论我把这个PN​​G文件放在哪里，我都会收到错误“无效的资源目录名称”。我应该把它放在哪里？我真的不想把它放在项目文件夹之外，因为这会使它与项目分离！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T22:25:32.493

将文件夹添加`_workspace`到您的资源文件夹并将其放在那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:26:20.007

你用它做什么？你可以把它放在你的drawable文件夹中，命名为icon_ginormous.png。这样您就可以使用您的资源引用它。

# javascript - 在 Nodejs 中解析大型 JSON 文件

> ID：11874096
> 
> 赞同：126
> 
> 时间：2012-08-08T22:24:25.863
> 
> 标签：javascript, json, file, node.js

我有一个文件，它以 JSON 形式存储许多 JavaScript 对象，我需要读取该文件，创建每个对象，并对它们执行一些操作（在我的情况下将它们插入到数据库中）。JavaScript 对象可以用一种格式表示：

**格式 A：**

```
[{name: 'thing1'},
....
{name: 'thing999999999'}] 
```

或**格式 B：**

```
{name: 'thing1'}         // <== My choice.
...
{name: 'thing999999999'} 
```

请注意，`...`表示大量 JSON 对象。我知道我可以将整个文件读入内存，然后`JSON.parse()`像这样使用：

```
fs.readFile(filePath, 'utf-8', function (err, fileContents) {
  if (err) throw err;
  console.log(JSON.parse(fileContents));
}); 
```

但是，文件可能非常大，我更喜欢使用流来完成此操作。我在流中看到的问题是文件内容可以在任何时候分解成数据块，那么我该如何`JSON.parse()`在这些对象上使用呢？

理想情况下，每个对象都将作为单独的数据块读取，但我不确定*如何做到这一点*。

```
var importStream = fs.createReadStream(filePath, {flags: 'r', encoding: 'utf-8'});
importStream.on('data', function(chunk) {

    var pleaseBeAJSObject = JSON.parse(chunk);           
    // insert pleaseBeAJSObject in a database
});
importStream.on('end', function(item) {
   console.log("Woot, imported objects into the database!");
});*/ 
```

注意，我希望防止将整个文件读入内存。时间效率对我来说并不重要。是的，我可以尝试一次读取多个对象并将它们全部插入，但这是一个性能调整 - 我需要一种保证不会导致内存过载的方法，无论文件中包含多少对象.

我可以选择使用`FormatA`或者`FormatB`可能是其他东西，请在您的答案中指定。谢谢！

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2012-08-08T23:26:11.937

要逐行处理文件，您只需将文件的读取和作用于该输入的代码解耦。您可以通过缓冲输入来完成此操作，直到您点击换行符。假设我们每行有一个 JSON 对象（基本上是格式 B）：

```
var stream = fs.createReadStream(filePath, {flags: 'r', encoding: 'utf-8'});
var buf = '';

stream.on('data', function(d) {
    buf += d.toString(); // when data is read, stash it in a string buffer
    pump(); // then process the buffer
});

function pump() {
    var pos;

    while ((pos = buf.indexOf('\n')) >= 0) { // keep going while there's a newline somewhere in the buffer
        if (pos == 0) { // if there's more than one newline in a row, the buffer will now start with a newline
            buf = buf.slice(1); // discard it
            continue; // so that the next iteration will start with data
        }
        processLine(buf.slice(0,pos)); // hand off the line
        buf = buf.slice(pos+1); // and slice the processed data off the buffer
    }
}

function processLine(line) { // here's where we do something with a line

    if (line[line.length-1] == '\r') line=line.substr(0,line.length-1); // discard CR (0x0D)

    if (line.length > 0) { // ignore empty lines
        var obj = JSON.parse(line); // parse the JSON
        console.log(obj); // do something with the data here!
    }
} 
```

每次文件流从文件系统接收数据时，它都会被存储在缓冲区中，然后`pump`被调用。

如果缓冲区中没有换行符，则`pump`直接返回而不做任何事情。下次流获取数据时，更多数据（可能还有换行符）将被添加到缓冲区中，然后我们将拥有一个完整的对象。

如果有换行符，`pump`则将缓冲区从开头切到换行符并将其交给`process`. 然后它再次检查缓冲区（`while`循环）中是否有另一个换行符。通过这种方式，我们可以处理当前块中读取的所有行。

最后，`process`每个输入行调用一次。如果存在，它会去掉回车符（以避免出现行尾问题——LF vs CRLF），然后调用`JSON.parse`一行。此时，您可以对您的对象做任何您需要的事情。

请注意，`JSON.parse`它接受的输入是严格的；你必须*用双引号*引用你的标识符和字符串值。也就是说，`{name:'thing1'}`会抛出错误；你必须使用`{"name":"thing1"}`.

因为一次不会超过一块数据在内存中，这将是非常高效的内存。它也将非常快。快速测试显示我在 15 毫秒内处理了 10,000 行。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-08-08T22:49:02.407

就像我在想写一个流式 JSON 解析器会很有趣一样，我也想也许我应该快速搜索一下，看看是否已经有可用的解析器。

原来有。

*   [JSONStream](https://github.com/dominictarr/JSONStream) *“流式处理 JSON.parse 和 stringify”*

由于我刚刚找到它，我显然没有使用它，所以我无法评论它的质量，但我很想知道它是否有效。

它确实工作考虑以下Javascript和[`_.isString`](https://underscorejs.org/#isString)：

```
stream.pipe(JSONStream.parse('*'))
  .on('data', (d) => {
    console.log(typeof d);
    console.log("isString: " + _.isString(d))
  }); 
```

如果流是对象数组，这将在对象进入时记录它们。因此，唯一被缓冲的是一次一个对象。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2014-07-12T05:51:21.180

**截至 2014 年 10 月**，您可以执行以下操作（使用 JSONStream） - [https://www.npmjs.org/package/JSONStream](https://www.npmjs.org/package/JSONStream)

```
var fs = require('fs'),
    JSONStream = require('JSONStream'),

var getStream() = function () {
    var jsonData = 'myData.json',
        stream = fs.createReadStream(jsonData, { encoding: 'utf8' }),
        parser = JSONStream.parse('*');
    return stream.pipe(parser);
}

getStream().pipe(MyTransformToDoWhateverProcessingAsNeeded).on('error', function (err) {
    // handle any errors
}); 
```

用一个工作示例进行演示：

```
npm install JSONStream event-stream 
```

**数据.json：**

```
{
  "greeting": "hello world"
} 
```

**你好.js：**

```
var fs = require('fs'),
    JSONStream = require('JSONStream'),
    es = require('event-stream');

var getStream = function () {
    var jsonData = 'data.json',
        stream = fs.createReadStream(jsonData, { encoding: 'utf8' }),
        parser = JSONStream.parse('*');
    return stream.pipe(parser);
};

getStream()
    .pipe(es.mapSync(function (data) {
        console.log(data);
    })); 
```

```
$ node hello.js
// hello world 
```

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2016-04-13T07:06:54.970

我意识到如果可能的话，您希望避免将整个 JSON 文件读入内存，但是如果您有可用的内存，那么在性能方面可能不是一个坏主意。在 json 文件上使用 node.js 的 require() 非常快地将数据加载到内存中。

我进行了两次测试，以查看从 81MB geojson 文件中打印出每个特征的属性时的性能。

在第一次测试中，我使用`var data = require('./geo.json')`. 这需要 3330 毫秒，然后从每个特征中打印出一个属性需要 804 毫秒，总共需要 4134 毫秒。但是，node.js 似乎使用了 411MB 的内存。

在第二个测试中，我使用了@arcseldon 的 JSONStream + event-stream 答案。我修改了 JSONPath 查询以仅选择我需要的内容。这次内存从未超过 82MB，但是，整个过程现在需要 70 秒才能完成！

* * *

## 回答 #5

> 赞同：23
> 
> 时间：2016-01-27T17:16:19.887

我有类似的要求，我需要在节点 js 中读取一个大的 json 文件并分块处理数据并调用 api 并保存在 mongodb 中。inputFile.json 就像：

```
{
 "customers":[
       { /*customer data*/},
       { /*customer data*/},
       { /*customer data*/}....
      ]
} 
```

现在我使用 JsonStream 和 EventStream 来同步实现这一点。

```
var JSONStream = require("JSONStream");
var es = require("event-stream");

fileStream = fs.createReadStream(filePath, { encoding: "utf8" });
fileStream.pipe(JSONStream.parse("customers.*")).pipe(
  es.through(function(data) {
    console.log("printing one customer object read from file ::");
    console.log(data);
    this.pause();
    processOneCustomer(data, this);
    return data;
  }),
  function end() {
    console.log("stream reading ended");
    this.emit("end");
  }
);

function processOneCustomer(data, es) {
  DataModel.save(function(err, dataModel) {
    es.resume();
  });
} 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2018-04-02T17:20:16.877

我写了一个可以做到这一点的模块，叫做[BFJ](https://gitlab.com/philbooth/bfj)。具体来说，该方法`bfj.match`可用于将大流分解为离散的 JSON 块：

```
const bfj = require('bfj');
const fs = require('fs');

const stream = fs.createReadStream(filePath);

bfj.match(stream, (key, value, depth) => depth === 0, { ndjson: true })
  .on('data', object => {
    // do whatever you need to do with object
  })
  .on('dataError', error => {
    // a syntax error was found in the JSON
  })
  .on('error', error => {
    // some kind of operational error occurred
  })
  .on('end', error => {
    // finished processing the stream
  }); 
```

在这里，`bfj.match`返回一个可读的对象模式流，它将接收解析的数据项，并传递 3 个参数：

1.  包含输入 JSON 的可读流。

2.  一个谓词，指示解析后的 JSON 中的哪些项目将被推送到结果流。

3.  一个选项对象，指示输入是换行符分隔的 JSON（这是为了处理问题中的格式 B，格式 A 不需要）。

在被调用时，`bfj.match`将深度优先从输入流解析 JSON，使用每个值调用谓词以确定是否将该项目推送到结果流。谓词传递三个参数：

1.  属性键或数组索引（这将`undefined`用于顶级项目）。

2.  价值本身。

3.  JSON 结构中项目的深度（顶级项目为零）。

当然根据需要也可以根据需要使用更复杂的谓词。如果要对属性键执行简单匹配，还可以传递字符串或正则表达式而不是谓词函数。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-06-02T15:46:52.283

如果您可以控制输入文件，并且它是一个对象数组，则可以更轻松地解决这个问题。安排输出文件，每条记录在一行，如下所示：

```
[
   {"key": value},
   {"key": value},
   ... 
```

这仍然是有效的 JSON。

然后，使用 node.js readline 模块一次处理一行。

```
var fs = require("fs");

var lineReader = require('readline').createInterface({
    input: fs.createReadStream("input.txt")
});

lineReader.on('line', function (line) {
    line = line.trim();

    if (line.charAt(line.length-1) === ',') {
        line = line.substr(0, line.length-1);
    }

    if (line.charAt(0) === '{') {
        processRecord(JSON.parse(line));
    }
});

function processRecord(record) {
    // Process the records one at a time here! 
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-05-24T05:16:58.930

[我使用split npm 模块](https://www.npmjs.com/package/split)解决了这个问题。通过管道将您的流分成拆分，它将“*分解流并重新组合它，以便每一行都是一个块*”。

示例代码：

```
var fs = require('fs')
  , split = require('split')
  ;

var stream = fs.createReadStream(filePath, {flags: 'r', encoding: 'utf-8'});
var lineStream = stream.pipe(split());
linestream.on('data', function(chunk) {
    var json = JSON.parse(chunk);           
    // ...
}); 
```

* * *

## 回答 #9

> 赞同：-5
> 
> 时间：2012-08-08T22:34:51.173

我认为您需要使用数据库。在这种情况下，MongoDB 是一个不错的选择，因为它与 JSON 兼容。

**更新**：您可以使用[mongoimport](http://docs.mongodb.org/manual/administration/import-export/)工具将 JSON 数据导入 MongoDB。

```
mongoimport --collection collection --file collection.json 
```

# asp.net-mvc - 在哪里将 DTO 转换为 ViewModel？

> ID：11874097
> 
> 赞同：20
> 
> 时间：2012-08-08T22:24:33.090
> 
> 标签：asp.net-mvc, domain-driven-design, viewmodel, dto, separation-of-concerns

我继承了一个 MVC2 项目，使用了一个非常标准且保存完好的 DDD 模式。我也对整个 DTO/ViewModel 辩论进行了大量阅读。

目前我们的 DTO 经常像*ViewModels*一样使用。老实说，这对我们正在做的事情没有影响，但我想在升级网站时使用正确的 ViewModel。

**这是我的问题：**

我们的“域”项目模型当前持有实体并将 DTO 返回给我的控制器。现在我需要将该 DTO 映射到 ViewModel。我应该在哪里做这个？

*   就在控制器里？
*   在域项目中？
*   别处？

我将我的 ViewModel 与我们的“Web”项目中的视图放在一起，因此在域项目中转换*DTO -> ViewModel感觉不对。*在控制器中这样做也感觉不对。

别人做了什么？

**编辑：**

[这个问题/答案](https://stackoverflow.com/questions/526641/what-to-put-in-your-viewmodel?rq=1)建议在控制器中处理它。这肯定很容易过度思考。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-09T00:14:41.113

DTO 通常是特定于技术的。例如，在 .NET 世界中，您的 DTO 可能带有序列`DataContract`化`DataMember`属性。此外，DTO 与返回它们的服务一起形成了[六边形架构](http://alistair.cockburn.us/Hexagonal+architecture)的域适配器。它们*使*您的域适应特定的传输技术，例如 HTTP，因此它们位于您的域之外。换句话说，域不应该了解 DTO - DTO 应该在单独的项目中定义。包含该服务的项目应该具有将域对象映射到 DTO 的映射代码。

ASP.NET MVC 项目在本质上是相似的——它使您的服务/DTO（或直接域对象）*适应*一种表示技术，尤其是 HTML。因此，DTO 不应该知道 ViewModel。相反，MVC 控制器应该调用 DTO 和 ViewModel 之间的映射。这可以通过多种方式完成，但我发现效果最好的是 ViewModel 中的构造函数接受 DTO。此外，在控制器操作保证创建 DTO 以发送回服务的情况下，ViewModel 可以包含基于 ViewModel 创建 DTO 的方法。这包含 ViewModel 中最接近实际数据的所有映射代码 -[信息专家模式](http://en.wikipedia.org/wiki/GRASP_%28object-oriented_design%29#Information_Expert)的一个实例。实现这一点的另一种方法是使用类似的东西[AutoMapper](https://github.com/AutoMapper/AutoMapper)使用基于约定的映射来避免样板代码。除非有必要，否则我会认为除此之外的任何东西都是矫枉过正的。

在许多情况下，您的 ViewModel 最终看起来就像 DTO，但具有用于绑定和验证的 ASP.NET MVC 特定属性。尽管这似乎违反了[DRY](http://en.wikipedia.org/wiki/Don%27t_repeat_yourself)，但这些确实是单独的职责。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-08T22:39:20.040

首先，始终为您的视图使用显式视图模型，不要将 DTO 一直传递到视图。它需要更多的前期工作，但它可以让您更好地控制视图中**确切**需要哪些数据（它还可以防止像 EF 这样的框架侧载大量您可能使用或可能不使用的额外数据）

其次，本文概述了 Orchestrator 模式[http://www.simple-talk.com/dotnet/asp.net/never-mind-the-controller,-here-is-the-orchestrator/](http://www.simple-talk.com/dotnet/asp.net/never-mind-the-controller,-here-is-the-orchestrator/)这可能只是其他一些模式，但我喜欢这种格式。

本质上，您为每个 Controller 创建了一个 Orchestrator。Orchestrator 接收数据（通常是 ViewModel，以及所需的任何其他基本数据类型，尤其是来自 HttpContext 的数据），并返回 ViewModel（如果 View 需要，否则返回一些其他类型）。

这种格式使您能够轻松地对实际逻辑进行单元测试，而无需尝试模拟控制器所需的 HttpContext 内容。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-08T22:33:05.967

听起来像是您想在专门构建的映射类/模块中做的事情。

我会亲自让我的控制器依赖于映射服务，然后在使用新映射的视图模型返回视图之前将实际转换委托给该服务。

```
public class DemoController : Controller
{
    private readonly IMappingService _mappingService;

    public DemoController(IMappingService mappingService)
    {
        _mappingService = mappingService;
    }

    public ActionResult Stuff()
    {
        var vm = _mappingService.Map(yourDto);

        return View(vm);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-08T22:53:13.077

一个不错的方法是使用第二个构造函数重载 ViewModel 上的构造函数，该构造函数将 dto 作为参数。这意味着您可以在视图模型本身中处理映射。这使您的控制器保持整洁，而无需设置映射服务。

# javascript - 在使用 nested_form gem 添加新字段时使用 WYIHTML5

> ID：11874098
> 
> 赞同：0
> 
> 时间：2012-08-08T22:24:41.083
> 
> 标签：javascript, jquery, ruby-on-rails, forms, wysiwyg

我正在尝试将[WYSIHTML5](https://github.com/xing/wysihtml5)与 Rails 嵌套表单一起使用，使用[nested_form](https://github.com/ryanb/nested_form/) gem。

通过nested_form 的`link_to_add`功能生成一组新字段时，我最初的问题出现了。据我了解，它复制了一个预先生成的字段（“蓝图”）。WYSIHTML5 使用 iFrame 并且 iFrame 内容没有被复制。`body`缺少一个属性，`contenteditable`所以它几乎没用。我设法用nested_form 的`nested:fieldAdded`javascript 触发器复制了所有缺失的属性。

所以现在一切都是可编辑的并且看起来正确。新问题。`iframe`显然与原作无关`textarea`。我可以输入任何我想输入的内容，但它不会随表单一起提交。我无法弄清楚我在这里缺少什么。`iframe`没有任何 id 属性或看似任何将两者联系在一起的东西。

任何帮助，将不胜感激。如果我遗漏了任何细节，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T15:42:36.970

手动将所有内容链接在一起太痛苦了。

我基本上最终忽略了带有`$('.wysiwyg:not([id$="_blueprint"] .wysiwyg)')`. 然后在`nested:fieldAdded`jQuery 触发器上，我选择`$('.wysiwyg-inactive:not([id$="_blueprint"] .wysiwyg)')`并激活它们，使用`wysiwyg-inactive`和`wysiwyg-active`类来确保我不会双重激活它们

有点干净。有点简单。但是你现在有了。

# visual-studio-2010 - 无法在 VS2010 中编译在 VS2008 中编译并使用 MSBuild 编译的混合模式 C++/CLR 库

> ID：11874101
> 
> 赞同：0
> 
> 时间：2012-08-08T22:24:54.623
> 
> 标签：visual-studio-2010, visual-studio-2008, unmanaged, managed-c++, mixed-mode

这是我今天下午遇到的一个奇怪的问题……我有一个混合模式库，这是我不久前制作的，它在 VS2008 上构建得很好。我正在转换到 VS2010，并尝试使用 VS2010 IDE 构建这个库。正如所料，IDE告诉我解决方案需要转换为VS2010，我让它去做......转换没有错误。我去构建库，似乎存在构建顺序问题，或者构建过程无法从托管代码中识别出非托管代码。（例如...当引入托管标头时，我看到一个错误：`cannot convert int to System::String^`其中有一个类方法将 a`System::String^`作为其参数之一，并将成员变量设置为其值）。

好的，现在退后一步，回到转换之前的解决方案/项目文件。打开 VS2010 命令提示符并使用 MSBuild 尝试构建解决方案，而无需先进行转换。一切正常。

? 嗯？

项目文件中显然有一些变化，但是什么？为什么 IDE 无法在不转换项目文件的情况下构建项目，而 MSBuild 却不咳嗽就直接通过它们？显然，我希望能够使用 IDE 编辑我的源代码——有没有其他人有过类似的经历或听说过这个问题？关于如何解决它的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T17:09:00.343

您是否将转换后的项目的设置与 VS2010 中新创建的设置进行了比较，并检查了哪些差异？

右键单击项目，转到属性，然后检查“平台工具集”之类的内容，并确保将其设置为“v100”，并且在同一页面上启用了“公共语言运行时支持”等。与新的比较工作项目。

您还可以右键单击该项目，将其卸载，再次右键单击并编辑“vcxproj”文件，看看那里是否有任何遗漏/错误。

如果一切都失败了，我会创建一个新项目并手动复制所有代码，如果这是一个转换问题，那么这肯定可以工作。

这些链接可能会有所帮助：
[将 C++/CLI 项目迁移到 Visual Studio 2010](http://code.logos.com/blog/2010/04/migrating_a_ccli_project_to_visual_studio_2010.html)
[将 C++ 项目从 VS2008](http://syncor.blogspot.fi/2011/02/moving-c-project-from-vs2008-to-vs2010.html)
[迁移到 VS2010 将 C++/CLI 项目从 VS2008 迁移到 2010](http://jkhk.wordpress.com/2011/02/16/migrating-a-ccli-project-from-vs2008-to-2010/)

# oracle - Oracle：批量存储过程

> ID：11874104
> 
> 赞同：1
> 
> 时间：2012-08-08T22:25:17.347
> 
> 标签：oracle, batch-file

我可以在 Oracle 中通过 ODBC 执行一批存储过程吗？存储过程具有我使用参数标记绑定的输入参数。

在 SQL Server 中我有这种能力，在 DB2 中我只能进行批量插入/更新，但我不能从 ODBC/C++ 代码批量存储过程。

Oracle 似乎支持对插入语句进行批处理，如果使用 JDBC，也可以对存储过程进行批处理。

是否可以做同样的事情，但使用对存储过程和 ODBC 的调用？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T00:58:05.240

简单的答案是——是的。您可以使用 Oracle 调度程序来调度和运行作业。阅读[本文](http://docs.oracle.com/cd/E11882_01/server.112/e17120/scheduse.htm)了解更多信息。

它可以像下面这样完成

```
BEGIN
  DBMS_SCHEDULER.CREATE_JOB (
   job_name           =>  'update_sales',
   job_type           =>  'STORED_PROCEDURE',
   job_action         =>  'OPS.SALES_PKG.UPDATE_SALES_SUMMARY',
   start_date         =>  '28-APR-08 07.00.00 PM Australia/Sydney',
   repeat_interval    =>  'FREQ=DAILY;INTERVAL=2', /* every other day */
   end_date           =>  '20-NOV-08 07.00.00 PM Australia/Sydney',
   auto_drop          =>   FALSE,
   job_class          =>  'batch_update_jobs',
   comments           =>  'My new job');
END;
/ 
```

# javascript - 在 HTML 中显示变量的良好做法是什么？

> ID：11874116
> 
> 赞同：2
> 
> 时间：2012-08-08T22:26:31.477
> 
> 标签：javascript, jquery, html

我是 Javascript 和 Jquery 的新手。

我正在使用 Jquery $.ajax 发送获取请求，处理返回的 Json 字符串并用于在我的 html`.html()`中显示内容。`<div id="myTabs"></div>`您可以从下面的代码中看到，我正在使用 String 变量来制作 HTML 列表。我这样做是一种好的做法吗？我觉得这种方式不是很敏捷，有没有更好的方法呢？

谢谢！

```
function updateRelated(str)
{
    $.ajax(
        {
            url:ServerUrl+api_subject,
            type:'GET',
            success:function(json)
            {
                // alert(json);
                var obj = jQuery.parseJSON(json);

                var toDisplay="";
                var tableDisplay="<ul>";
                for(var i=0;i<obj.subject_list.length;i++)
                {
                    tableDisplay=tableDisplay+'<li><a href="subject.htm?subjectid='+obj.subject_list[i].id+'">'+obj.subject_list[i].title+'</li>';
                    //    toDisplay=toDisplay+"<br>preferred_synonym:"+obj.relatedCocepts[i].preferred_synonym+",Type: "+obj.relatedCocepts[i].type+",score: "+obj.relatedCocepts[i].score;
                }
                tableDisplay=tableDisplay+"</ul>"
                $("#myTabs").html(tableDisplay);
            }
        }
        )
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:32:01.927

基本上，我正在阅读您的问题，以真正询问您是否应该编写一串标记并将其输出到 dom 中，并将变量连接到其中。

它可以用于较小的东西，但如果您使用 javascript 编写大量视图，您将需要一个将视图部分组合在一起的工具。

有一些工具可以做到这一点：

*   [http://mustache.github.com/](http://mustache.github.com/)
*   [https://github.com/adammark/Markup.js](https://github.com/adammark/Markup.js)
*   [http://api.jquery.com/category/plugins/templates/](http://api.jquery.com/category/plugins/templates/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T22:33:17.657

您可能想要使用像[jsViews](https://github.com/BorisMoore/jsviews/)这样的模板引擎。如果您坚持使用 jQuery 循环和创建元素，请查看：[http ://www.andyjarrett.co.uk/blog/index.cfm/2009/3/14/Creating-a-new-DOM-element- with-jQuery/](http://www.andyjarrett.co.uk/blog/index.cfm/2009/3/14/Creating-a-new-DOM-element-with-jQuery/) - 语法很简单：

```
div = $("<div>"); // then append more stuff with append() or html() 
```

但同样，如果您要添加大量内容，则使用模板引擎远远优于自制循环解决方案。它也更健壮和可扩展（并且布局修改更容易实现）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T22:36:29.377

就像其他人已经说过的那样，如果您有很多 html，那么模板引擎就是要走的路。但是您可以使用数组来清理当前代码。我评论了几点：

```
var list = [],
    arr = obj.subject_list,
    len = arr.length; // cache length for better performance

for (var i=0; i<len; i++) {
  list.push(
    '<li>'+
      '<a href="subject.htm?subjectid='+ arr[i].id +'">'+
        arr[i].title +
      '</a>'+ // you forgot to close <a>
    '</li>'
  );
}

$("#mytabs").html('<ul>'+ list.join('') +'</ul>'); 
```

在 JavaScript 中处理 html 时，我建议正确缩进你的 html，就像它是真正的 html 一样。如您所见，它更具可读性，并且可以避免语法错误，例如缺少 close `</a>`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T22:39:45.630

我相信你在这里做得很好，在这种情况下，我可能会做一些非常相似的事情。使用特殊的插件是可能的，并且可能对用户更友好，但它们几乎总是带来很多开销。我怀疑这在处理器负载方面是否可以更有效地完成。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T23:14:35.087

您可以为此使用[jsrender](https://github.com/BorisMoore/jsrender)。

使用特殊类型在脚本标签内定义模板`text/x-jsrender`：

```
<script id="listTemplate" type="text/x-jsrender">
    <li><a href="subject.htm?subjectid={{>id}}">{{>title}}</a></li>
</script> 
```

请注意，很容易看到 HTML 的结构。与在 javascript 中连接相比，错过的机会更少（你错过了结束`</a>`标签，顺便说一句）。

要使用此模板，请修改您的函数，如下所示：

```
success:function(json)
{
    // alert(json);
    var obj = jQuery.parseJSON(json);
    var htmlList = $('#listTemplate').render(obj.subject_list);
    $('#myTabs').html(htmlList);   
} 
```

这是一个 jsfiddle 演示：http: [//jsfiddle.net/d4DjY/](http://jsfiddle.net/d4DjY/)。将鼠标悬停在链接上，您可以看到它们在查询字符串中具有正确的 ID。

更多演示：http: [//borismoore.github.com/jsrender/demos/demos.html](http://borismoore.github.com/jsrender/demos/demos.html)。使用 view-source 查看模板代码。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-08T22:32:10.710

您还可以查看[jQuery Templates](http://api.jquery.com/category/plugins/templates/)。它仍处于测试阶段，不会比这更进一步，但对于您的情况，应该没问题。

# performance - 基于BFS的寻路算法的运行时间

> ID：11874119
> 
> 赞同：1
> 
> 时间：2012-08-08T22:26:54.523
> 
> 标签：performance, graph, big-o, dijkstra, breadth-first-search

我提出了一种基于 BFS 的寻路算法，旨在替代 Diskjstra 的（老实说，我怀疑其他人过去曾提出过它，但我在任何地方都找不到任何关于它的在线提及）。我试图弄清楚运行时间是多少，但我和我的朋友们正在争论它，并且无法得出一个明确的答案。这是 Go 中算法的描述和实现的链接： [https ://github.com/joshlf13/bfspath](https://github.com/joshlf13/bfspath)

我的印象是运行时间是 e + e^2 + e^4 + ... + e^2d 其中 e 是每个顶点的平均边数，d 是最终最短路径的距离（给 O (e^2d))。问题是，这取决于算法的结果，正如我的朋友指出的那样，它不应该包含在运行时间的考虑中。

我的推理是这样的：BFS 的每次传递都会增加 e 的倍数所考虑的顶点数量。此外，每次考虑一个顶点时，它都是 e 操作。因此，每次传递都是 v（传递中的顶点数）乘以 e。如果 v 为 1，则 e 则为 e^2，以此类推，v*e 为 e + e^2 + e^4，以此类推。

另一种方法是根据考虑的边数来考虑运行时间。一条长度为 N 的边需要 N 次操作。因此，对于具有 E 条边且平均边长为 N 的图，它是 O(N*E)。但是，这仅适用于在算法运行期间考虑的图形部分，并且该子集的大小不会随起点和终点之间的距离线性缩放，这使得真正考虑 O() 变得困难.

想法……？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T20:10:06.830

因此，您的算法最基本的问题是，当边具有实值权重/长度时，它不能保证正确答案。除非您完全准备好拥有计算机上可用的最小浮点值的“单位长度”（提示：它非常小），否则您将无法分解每条边。

因此，您的算法甚至只能在可以简化为统一网格的图形上返回正确答案，在这些网格中，您在任何给定时间只能水平或垂直移动。

至于分析运行时，你的朋友是绝对正确的。“真正考虑 O()”并没有什么“困难”。您的算法是复杂性理论中所谓的伪多项式时间。这真正意味着它的输入大小是指数的，但值是多项式的。特别是，它是 O(NE + V)，其中 N 是图中所有边中最大的边权重。

图上的伪多边形算法 / 太慢 / 对于任何现实世界的使用，即使你可以保证整数边长。你真的只能在统一长度的网格上使用它，人们/已经/在统一长度的网格上使用 BFS；这不是“特殊算法”，而是 BFS。

# abap - XXX 是没有标题行的表，因此没有名为“EBELN”的组件

> ID：11874121
> 
> 赞同：3
> 
> 时间：2012-08-08T22:26:58.017
> 
> 标签：abap

我收到语法错误：

> “IT_COMBINE”是一个没有标题行的表，因此没有名为“EBELN”的组件。

我尝试过使用“进入相应的字段”，但这不起作用。

我的代码：

```
 19   Data it_combine type standard table of ty_combine.
  ...
  32    select ebeln lifnr ekorg bsart ekgrp
  33      into table it_po
  34       from ekko
  35         where ebeln = it_combine-ebeln. " <=== SYNTAX ERROR
  ... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T04:56:32.687

如果您没有使用标题行声明内部表，则不能直接使用内部表中的字段。

有 2 种可能性可以更改您的代码。

1.  你在第 35 行调用了字段 ebeln。由于你没有在第 19 行声明 it_combine 和标题行，你不能像这样使用 it_combine-ebeln。相反，您必须声明**工作区**

    ```
    Data wa_combine type ty_combine. 
    ```

并使用第 35 行中的工作区作为

```
Loop at it_combine into wa_combine .
 select ebeln lifnr ekorg bsart ekgrp
   into table it_po
    from ekko
      where ebeln = wa_combine-ebeln.
End Loop. 
```

2 你必须用标题行声明你的内部表

```
 Data it_combine type standard table of ty_combine with header line. 
```

有关标题行和工作区的简要说明，请参阅 Sap 帮助文档。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-09T19:57:33.920

您还可以对语句“SELECT”使用附加的“FOR ALL ENTRIES IN”：

```
SELECT DISTINCT ebeln netwr werks INTO TABLE it_combine
  FROM ekpo
  WHERE netwr IN s_netwr. "in is only for select options

  CHECK it_combine[] IS NOT INITIAL. " not empty, obligatory

 SELECT ebeln lifnr ekorg bsart ekgrp
  INTO TABLE it_po  
  FROM ekko FOR ALL ENTRIES IN it_combine
  WHERE ebeln = it_combine-ebeln. 
```

“带标题行”或附加工作区 - 不需要

此外，在 OOP 上下文中使用“带标题行”是不可能的。

# python - 使用 python 获取 xml 文件的一部分

> ID：11874124
> 
> 赞同：0
> 
> 时间：2012-08-08T22:27:18.587
> 
> 标签：python, xml, xpath

我对 Python 很陌生，我有以下`.xml`文件：

```
<A>
  <B>
    <C>NUM123456</C>
    <D>
      <E>123</E>
      <F>Spam</F>
        <G>Apple</G>
    </D>
    <D>
      <E>456</E>
      <F>Egg</F>
        <G>Orange</G>
    </D>
    <D>
      <E>789</E>
      <F>Bacon</F>
        <G>Strawberry</G>
    </D>
    <D>
      <E>0AB</E>
      <F>Cheese</F>
        <G>Cherry</G>
    </D>
  </B>
</A> 
```

我试图只取其中的一部分，以便新`.xml`文件为：

```
<A>
  <B>
    <C>NUM123456</C>
    <D>
      <E>456</E>
      <F>Egg</F>
        <G>Orange</G>
    </D>
    <D>
      <E>0AB</E>
      <F>Cheese</F>
        <G>Cherry</G>
    </D>
  </B>
</A> 
```

我正在尝试使用`.xpath`，但它只会在`.xml`找到不同的节点后才开始写入新文件。换句话说，节点`<A> <B>`和`<C>`新`.xml`文件都没有包含。有人可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:31:40.390

你需要输入正确的标准——我根据你的例子中的文本值这个过滤器：

```
#!/usr/bin/env python
from xml.etree import ElementTree
import sys
tree = ElementTree.ElementTree()
tree.parse(sys.stdin)
b = tree.find("B")
for e in b.getiterator("D"):
    if e.find("E").text in ["123", "789"]: 
        b.remove(e)
tree.write(sys.stdout) 
```

像这样运行它：

> ./parse.py < 文件.xml

得到你想要的输出。

# qt - 将 Wt 集成到 Qt Creator。如何更改 Qt UI 设计器解析器以制作 Wt 应用程序？

> ID：11874127
> 
> 赞同：1
> 
> 时间：2012-08-08T22:27:42.823
> 
> 标签：qt, qt-designer, wt

我想知道是否可以改变 Qt Ui 设计师创建 C++ 代码的方式。

例如，当我向 Ui 添加一个按钮时，它会转换为

```
pushButton = new QPushButton(centralWidget);
pushButton->setObjectName(QString::fromUtf8("pushButton"));
pushButton->setGeometry(QRect(70, 90, 97, 27));

void retranslateUi(QMainWindow *MainWindow)
{

    pushButton_2->setText(QApplication::translate("MainWindow", "hola", 0, QApplication::UnicodeUTF8)); 
```

我希望 Qt Ui Designer 解析器将此文本转换为下一个

```
pushButton = new Wt::WPushButton("Some Text",root()); 
```

# wordpress - Wordpress 和链接页面到自定义帖子类型页面

> ID：11874130
> 
> 赞同：0
> 
> 时间：2012-08-08T22:27:53.460
> 
> 标签：wordpress

我无法为 WordPress 中的以下场景提出解决方案。一般来说，我想双向链接到服务和位置。让我们以下面的服务和位置示例来帮助解释......

**服务分为几个部分......每个服务都是一个页面。**

```
Services Section 1
- Service 1
- Service 2
- Service 3
- Etc…

Services Section 2
- Service 1
- Service 2
- Service 3
- Etc… 
```

一项服务可以有多个与之关联的位置。

**位置按几个区域细分......每个位置都是一个页面（这将是一个 CPT）。**

```
Locations West
- Location 1
- Location 2
- Location 3
- Etc…

Locations East
- Location 1
- Location 2
- Location 3
- Etc… 
```

一个位置可以有多个与之关联的服务。

**现在对于用例/功能......**

*用户案例 1*

如果我浏览到服务部分 1，然后是服务 2。我会看到一个页面，其中包含有关该服务的一般信息和一个部分，其中列出了按地区划分的所有提供此服务的位置。然后我可以单击其中一个位置，它会直接将我带到该位置页面以获取地址/电话/等....

*用例 2*

假设我浏览到 Locations East 和 Location 3。我会得到一个页面，其中包含位置信息、地址、电话、方向链接，而且还会调用该位置提供的所有服务。如果我选择一项服务，我将被带到该服务页面。

我以为我可以使用分类法来做到这一点，但它似乎分类法对事物进行分组，但不会直接链接到该服务或位置页面，而是显示带有该服务/位置标记的所有页面的列表。这不是我想要的用例。

希望得到关于如何最好地实现这一点的想法/想法。任何回复/帮助将不胜感激。希望上面的解释是有道理的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:39:36.410

好吧，您可以 a) 使用 MicroKids 相关帖子，它可以让您将页面/帖子相互关联，然后您可以修改主题以在某处显示这些结果。

否则，我认为您仍然可以使用分类法-但您希望以某种方式将页面/帖子与分类法相关联-例如，可能是您关联到每个位置的服务分类法。然后在“服务”页面上，您将编写一个 WordPress 循环（或使用插件生成并输出一个），该循环显示指向您需要显示的特定服务（分类）中的每个位置的链接。

# javascript - mouseenter mouseleave 没有按我认为应该的方式工作

> ID：11874132
> 
> 赞同：0
> 
> 时间：2012-08-08T22:28:01.180
> 
> 标签：javascript, jquery

我对 jQuery 比较陌生，我似乎被这个 mouseenter/mouseleave 问题困住了。我想设置一个菜单，当页面不在顶部时“隐藏”，这似乎工作正常，当它被隐藏时我想这样做，所以当用户将鼠标悬停在它上面时，类切换和菜单回来了。但是，当它滚动回顶部时，我不希望这样。当页面第一次加载（在 Firefox 和 chrome 中）并且我还没有滚动时，它工作正常，但是在向下滚动并返回顶部后，菜单将隐藏在 mouseleave 上。

这是我当前代码设置的[jsFiddle](http://jsfiddle.net/bJquD/)。

我一直在尝试解决这个问题，并尝试了其他一些方法。

我试过像这样使用悬停

```
$("#access").hover(function() {
            $(this).removeClass("scroll").addClass("normal");
        }, function() {
            $(this).removeClass("normal").addClass("scroll");
        }); 
```

但这与我现在拥有的代码相同。

我尝试的其他一些方法是将 b 变量传递给另一个函数，创建一个单独的 div 并跟踪它的位置以确定是否使用 mouseenter/mouseleave，最后绑定它们，但这似乎都不起作用正如我认为的那样。

我想不出还有什么可以尝试的，所以我不确定这是否是我做错了，或者这是否甚至不可能像这样完成。

这是我的第一个问题，我试图包含尽可能多的信息，希望它是足够的信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:03:17.810

试试这个

```
$(document).ready(function() {
    $(window).scroll(function() {
        var b = $(window).scrollTop();
        $("#access").toggleClass("normal", b == 0)
        $("#access").toggleClass("scroll", b > 0)
    });
    $("#access").hover(function() {           
        if($(window).scrollTop() > 0){
            $("#access").toggleClass("normal scroll");
        }
    });
});​ 
```

[http://jsfiddle.net/bJquD/6/](http://jsfiddle.net/bJquD/6/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:46:37.980

您没有考虑页面的滚动状态，因此无论页面是否滚动，mouseenter/mouseleave 事件都会重置类名而不考虑。可以预见的是，这与您想要的并不相符。

对此的明显解决方案是使用全局变量（尽管在 jQuery 文档就绪的范围内）来跟踪它，然后在`hover()`函数中检查它，导致以下结果：

```
var scrolled = false;

$(window).scroll(
    function(){
        var b = $(window).scrollTop();
        if (b == 0) {
            $('#access').removeClass('scroll').addClass('normal');
            scrolled = false;
        }
        else if (b > 0) {
            $('#access').removeClass('normal').addClass('scroll');
            scrolled = true;
        }
    });

$('#access').hover(
    function(){
        if (scrolled) {
            // window scrolled, hence access class should be 'scroll'
            $('#access').removeClass('scroll').addClass('normal');
        }
    },
    function(){
        if (scrolled) {
            // window scrolled, hence access class should be 'normal' (from mouseenter)
            $('#access').removeClass('normal').addClass('scroll');
        }
    });​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/bJquD/2/)。

这样做的结果是，如果页面未滚动，`mouseenter`/`mouseleave`事件什么也不做（因为它们不应该，`normal`在这种情况下类名是正确的），而如果页面*被*滚动，它们会删除滚动类名打开`mouseenter`并恢复它`mouseleave`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T22:46:55.087

在这里，您只需添加变量 isOnTop，mouseenter 和 mouseleave 处理程序在执行任何操作之前都会对其进行检查

```
$(document).ready(function() {
var isOnTop=1;
    $(window).scroll(function() {
        var b = $(window).scrollTop();

        if (b > 0) {
            isOnTop=0;            
            $("#access").removeClass("normal").addClass("scroll");
        }

        else if (b == 0) {
            isOnTop=1;
            $("#access").removeClass("scroll").addClass("normal");
        }

    });

    $("#access").mouseenter(function() {
        if(isOnTop){return;}
        $(this).removeClass("scroll").addClass("normal");
    });

    $("#access").mouseleave(function() {
        if(isOnTop){return;}
        $(this).removeClass("normal").addClass("scroll");
    });
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T22:53:00.860

是的，您正在向该元素添加一堆事件处理程序，这最终会令人难以置信地减慢页面速度。你想避免这样做。或者，您可以绑定事件，然后在滚动到页面顶部时将其删除。最好的方法是使用下面的代码。

```
$(document).ready(function() {
    $(window).scroll(function() {
        if ($(this).scrollTop() > 0) {
            $("#access").removeClass("normal").addClass("scroll").on('mouseenter', function() {
                $(this).removeClass("scroll").addClass("normal");
            }).on('mouseleave', function() {
                $(this).removeClass("normal").addClass("scroll");
            });
        } else {
            $("#access").removeClass("scroll").addClass("normal").off('mouseenter mouseleave');
        }
    });
});​ 
```

[您也可以在这里](http://jsfiddle.net/N7RmL/6/)试一试。

希望这可以帮助你:)

# linq - Linq to Dynamics - 比较 where 子句中的两个属性

> ID：11874133
> 
> 赞同：3
> 
> 时间：2012-08-08T22:28:07.767
> 
> 标签：linq, dynamics-crm, dynamics-crm-2011

我正在使用 Dynamics sdk dll 的版本 5.0.9689.2165 并尝试使用从 Dynamics Online 帐户获取小于的`Linq` 所有帐户（两者都是自定义属性 - 我使用项目中生成的代理类来访问这些）。`Account.XDate``Account.YDate``DateTime`

我有这个基本的表达：

```
var accounts = myOrganizationServiceContext.CreateQuery<Account>().Where(a => a.XDate < a.YDate) 
```

但是当它被处理时我得到了下面的异常 - 你不能比较服务器上的 2 个实体属性吗？

```
System.InvalidOperationException occurred
  Message=variable 'a' of type 'Account' referenced from scope '', but it is not defined
  Source=System.Core
  StackTrace:
       at System.Linq.Expressions.Compiler.VariableBinder.Reference(ParameterExpression node, VariableStorageKind storage)
       at System.Linq.Expressions.Compiler.VariableBinder.VisitParameter(ParameterExpression node)
       at System.Linq.Expressions.ExpressionVisitor.VisitMember(MemberExpression node)
       at System.Linq.Expressions.ExpressionVisitor.Visit(ReadOnlyCollection`1 nodes)
       at System.Linq.Expressions.Compiler.VariableBinder.VisitLambda[T](Expression`1 node)
       at System.Linq.Expressions.Compiler.LambdaCompiler.Compile(LambdaExpression lambda, DebugInfoGenerator debugInfoGenerator)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.CompileExpression(LambdaExpression expression)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.TranslateExpressionToValue(Expression exp, ParameterExpression[] parameters)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.TranslateExpressionToConditionValue(Expression exp, ParameterExpression[] parameters)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.TranslateWhereCondition(BinaryExpression be, FilterExpressionWrapper parentFilter, Func`2 getFilter, Boolean negate)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.TranslateWhere(String parameterName, BinaryExpression be, FilterExpressionWrapper parentFilter, Func`2 getFilter, List`1 linkLookups, Boolean negate)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.TranslateWhereBoolean(String parameterName, Expression exp, FilterExpressionWrapper parentFilter, Func`2 getFilter, List`1 linkLookups, BinaryExpression parent, Boolean negate)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.TranslateWhere(String parameterName, BinaryExpression be, FilterExpressionWrapper parentFilter, Func`2 getFilter, List`1 linkLookups, Boolean negate)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.TranslateWhereBoolean(String parameterName, Expression exp, FilterExpressionWrapper parentFilter, Func`2 getFilter, List`1 linkLookups, BinaryExpression parent, Boolean negate)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.TranslateWhere(QueryExpression qe, String parameterName, Expression exp, List`1 linkLookups)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.GetQueryExpression(Expression expression, Boolean& throwIfSequenceIsEmpty, Boolean& throwIfSequenceNotSingle, Projection& projection, NavigationSource& source, List`1& linkLookups)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.Execute[TElement](Expression expression)
       at Microsoft.Xrm.Sdk.Linq.QueryProvider.GetEnumerator[TElement](Expression expression) 
```

在我的电话里

内部异常：

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T13:49:53.813

这代表了 CRM Linq 提供商的限制（再次）。[根据微软](http://msdn.microsoft.com/en-us/library/gg328328.aspx#limitations "LINQ 限制")：

> **where**
> 子句的左侧必须是属性名，**子句的右侧必须是值**。您不能将左侧设置为常数。子句的两边都不能是常数。

要使用 Linq 提供程序解决您的特定问题，您可能必须`AccountSet`在内存中收集全部内容，然后针对结果使用常规 Linq 方法以获得您想要的最终结果。

```
var accounts = myOrganizationServiceContext
    .CreateQuery<Account>()
    .Select(a => new { a.AccountId, a.XDate, a.YDate })
    .ToList();

var filteredAccounts = accounts
    .Where(a => a.XDate < a.YDate); 
```

# javascript - 解析正负整数的字符串，Javascript

> ID：11874136
> 
> 赞同：1
> 
> 时间：2012-08-08T22:28:21.647
> 
> 标签：javascript, parsing, tags, position, d3.js

所以我正在研究一个用 d3 制作的标签云示例。

[http://www.jasondavies.com/wordcloud/#http%3A%2F%2Fsearch.twitter.com%2Fsearch.json%3Frpp%3D100%26q%3D%7Bword%7D=cloud](http://www.jasondavies.com/wordcloud/#http%3A%2F%2Fsearch.twitter.com%2Fsearch.json%3Frpp%3D100%26q%3D%7Bword%7D=cloud)

并且我试图在每个单词悬停时将 Div 放置在它的顶部，并且基本上遇到了问题，因为我放置 div 的方式取决于 svg word 元素的 transform 属性。

这个转换属性是我需要解析的字符串，但该字符串包含我需要抓取的正值和负值。

```
tagCloudHover.style("top", function(){

       //parses the words attributes for its position, and gives that position to tagCloudHover
       var str, matches, index, num;
        str = thisWord.attr("transform");
        matches = str.match(/\d+/g);
        for (index = 1; index < 2; ++index) {
                num = (parseInt(matches[index], 10));

        }

        if(num<0){
            return -num+"px";
        }else{
            return num+"px";
        }
  }); 
```

我的代码如上，最后一条语句什么都不做，但它能够从字符串中获取一个 Int 。问题是它不会抓住负号。

我不是最擅长解析，但我尝试了几个不同的 str.match 函数，但似乎没有任何效果。

任何 parseNinjas 有什么想法吗？任何事情都有帮助。艾萨克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T22:32:07.563

您的正则表达式应该是`/-?\d+/g`，基本上`-`在模式中添加“可选”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T22:39:44.023

如果您知道需要解析哪些值，则只需将负值乘以 -1

例子：

```
num = -1 * (parseInt(matches[index], 10)); 
```

# c++ - C++继承基类使用派生类的成员

> ID：11874137
> 
> 赞同：0
> 
> 时间：2012-08-08T22:28:24.953
> 
> 标签：c++, class, inheritance

是否可以有一个基类，它具有派生类的实例作为基类函数之一的参数？例如：

```
class A
{
  virtual void foo(B b[]);
};
Class B: public A
{
  void foo(B b[]);
}; 
```

这合法吗？A 类也需要包含 B 类的头文件，这也有问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-08T22:36:21.430

前向声明是可能的：

```
class B;
class A
{
  virtual void foo(B b[]);
};
Class B: public A
{
  void foo(B b[]);
}; 
```

但这**是一个主要的代码气味**。请说明您要实现的目标，这看起来像是一个错误的设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T22:34:09.960

您可以使用奇怪重复的模板模式：

```
template <class T>
class A
{
public:
    virtual void foo(T t[]);
};

class B: public A<B>
{
public:
    void foo(B b[]);
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T23:43:49.723

一种方法可能是定义一个接口类，该类定义您希望在派生类中公开的功能。如果您想在基类的成员函数中访问派生类 B 内部，那么这种方法并不比已经发布的方法好。

```
class IntfB
{
  public:
    virtual void meth1() = 0;
    virtual void meth2() = 0;
};

class A
{
  public:
    virtual void foo(IntfB b[]);
};

class B : public A, public IntfB
{
  public:
    virtual void meth1();
    virtual void meth2();
}; 
```

# .htaccess - htaccess 仅删除“？” 使用查询字符串从 URL 签名

> ID：11874142
> 
> 赞同：2
> 
> 时间：2012-08-08T22:29:18.637
> 
> 标签：.htaccess, query-string, ssi

如何`?`使用查询字符串从 URL 中删除符号

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T22:55:43.740

```
RewriteEngine On

# This is to physically change what's in the browser's address bar using a client redirect
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /\?([^\ ]+)
RewriteRule ^$ /%1? [R=301,L]

# This is to internally rewrite on the server side
RewriteCond %{QUERY_STRING} ^$
RewriteRule ^/?(.+)$ /?$1 [L] 
```

* * *

> 另外请你解释一下`[A-Z]{3,9}\ and ([^\ ]+)`它本身是什么意思？我在哪里可以阅读有关构建此类结构的信息？

该正则表达式用于匹配*HTTP Request*，第一行将如下所示：

```
GET /path/to/file HTTP/1.1 
```

第一个词是**METHOD**，长度可以在 3 到 9 个字符之间（因此`{3,9}`，第二个词是请求的*未*更改URI。这是通过重写引擎的内容，但在对其进行任何路径处理之前. 最后一位是协议版本，有些可选，决定之后是否会有headers。

# javascript - 无法加载 socket.io.js

> ID：11874146
> 
> 赞同：0
> 
> 时间：2012-08-08T22:29:45.667
> 
> 标签：javascript, node.js, socket.io

我正在创建一个具有单独的服务器和客户端代码（两个不同的 git 存储库）的应用程序。

HTML 只是作为 UI 存在，但它仍然需要加载`/socket/socket.io.js`才能与服务器通信。

这是我的 HTML：

```
<html>
    <head>
        <script src="/socket/socket.io.js"></script>
        <script src="js/myStuff.js"></script>
    </head>

    <body>
    </body>
</html> 
```

当查询以 开头的地址时`/c`，服务器会自动将前缀替换为客户端代码目录。所以，网站是这样加载的：`localhost:8080/c/index.html`，请求`js/myStuff.js`实际上是`/c/js/myStuff.js`。

这就是它的全部实现方式：

```
var http = require("http");
var io = require("socket.io");
var fs = require("fs");
var iniparser = require("iniparser");

var config = iniparser.parseSync('./config.ini');

clientPath = config.server.clientPath; //   ../../Bla

var handler = function(req, res)
{    
    if (req.url[1] == "c")
    {
        req.url = req.url.slice(2, req.url.length); //Cut off the "/c"
        url = __dirname + "/" + clientPath + req.url;
    }
    else
    {
        url = req.url; //Nothing.
    }

    fs.readFile (url, function(err, data)
    {
        if (err)
        {
            res.writeHead(404);
            return res.end("File not found.");
        }

        res.writeHead(200);
        res.end(data);
    });
}

var server = http.createServer(handler);
server.listen(8080);
var socket = io.listen(server); 
```

myStuff.js 和 index.html 都正确加载，但是加载有问题`/socket/socket.io.js`。那是非常非常奇怪的，因为我什至不碰地址。

这个错误是由谷歌浏览器给出的：

`GET http://localhost:8080/socket/socket.io.js 404 (Not Found)`

为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T22:31:25.530

它看起来好像没有在任何地方更改它，所以 Socket.io JavaScript 的默认位置是

```
<script src="/socket.io/socket.io.js"></script> 
```

不是套接字/socket.io.js。

# android - ActionBarSherlock 问题继续使用 4.0 书

> ID：11874152
> 
> 赞同：0
> 
> 时间：2012-08-08T22:30:37.700
> 
> 标签：android, commonsware

![在此处输入图像描述](../Images/15e7c3475f66118fa9ac3f60b8a18d27.png)现在使用4.0的书。

我从 T5 创建了一个新项目 - 进度...

按照第 214 页上的说明附加“Android 支持包”。（需要运行 eclipse

作为在 Windows 7 上工作的管理员）

下载 ActionBarSherlock 并将 \library 目录放在我的桌面上重命名目录

按照第 217 页上的说明发送到 ActionBarSherlock。

按照第 218 页上的说明创建第二个项目，从现有代码导航到

我桌面上的 ActionBarSherlock 目录。

点击完成并得到：“未找到标记 id 2320。”

单击该错误对话框并看到新的 ActionBarSherlock 项目有 > 100 个错误。

检查 API 级别，发现它设置为 15。

然后，如果存在错误，我按照指示进行了一个项目 > 清理。

将两个项目都设置为编译器级别 1.6，并在两个项目上进行了另一个干净的构建。

仍有 100 个错误。

谢谢，加里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:41:59.307

引用我自己的话：

> 如果您仍然遇到错误，并且对 ActionBarSherlock 代码的检查表明投诉是关于实现接口的方法上的 @Override 注释，而不是真正覆盖超类方法，则需要将 Eclipse 编译器合规级别调整为1.6，而不是 1.5。即使您已经在工作区级别执行此操作，您也可能需要在项目级别执行此操作。

（见 4.0 版，第 218 页）

# sql - SSIS 连接错误

> ID：11874154
> 
> 赞同：7
> 
> 时间：2012-08-08T22:31:07.957
> 
> 标签：sql, ssis, bids

我将以下代码写入 SSIS 脚本任务以连接到我的 SQL 数据库：

```
 ConnectionManager cm;
 System.Data.SqlClient.SqlConnection sqlConn;
 System.Data.SqlClient.SqlCommand sqlComm;

 cm = Dts.Connections["QUAHILSQ03"];

 sqlConn = (System.Data.SqlClient.SqlConnection)cm.AcquireConnection(Dts.Transaction); 
```

但是这一行：

```
 sqlConn = (System.Data.SqlClient.SqlConnection)cm.AcquireConnection(Dts.Transaction); 
```

返回以下异常：

{“无法将“System.__ComObject”类型的 COM 对象转换为“System.Data.SqlClient.SqlConnection”类类型。表示 COM 组件的类型实例不能转换为不表示 COM 组件的类型；但是它们可以只要底层 COM 组件支持接口的 IID 的 QueryInterface 调用，就转换为接口。"} System.Exception {System.InvalidCastException}

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-09T15:10:37.060

非常简单的修复：我创建了 QUAHILSQ03 连接管理器作为 OLE DB 连接。只需将其更改为 ADO.NET，我的代码就可以正常工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-09T02:01:57.837

在我看来，您正在使用 OLEDB 连接。oledb 连接管理器上的获取连接方法返回一个 COM 对象，因此您收到错误消息。

尝试这个 ：

```
 ConnectionManager cm = Dts.Connections["QUAHILSQ03"];
   IDTSConnectionManagerDatabaseParameters100 cmParams = cm.InnerObject 
   as IDTSConnectionManagerDatabaseParameters100;
   OleDbConnection conn = cmParams.GetConnectionForSchema() as OleDbConnection; 
```

您需要使用`Microsoft.SqlServer.Dts.Runtime.Wrapper`命名空间使用上述方法，您无法保留`transaction`.

有关更多详细信息，请参阅[本文](http://blogs.msdn.com/b/mattm/archive/2008/08/22/accessing-oledb-connection-managers-in-a-script.aspx)

# xcode - XCode 使用 ncurses 构建命令行工具

> ID：11874160
> 
> 赞同：2
> 
> 时间：2012-08-08T22:31:22.523
> 
> 标签：xcode, cocoa, command-line, ncurses, curses

使用 ncurse 构建一个应用程序，该应用程序一次使用用户的一次击键来创建以下功能。

当用户按下制表符时，他的当前行将尝试自动完成。

使用 getch()，我获取每个值并将其添加到缓冲区中，以便在用户按 Enter 时使用。

每次击键后，屏幕都会刷新，缓冲区会重新绘制到屏幕上。

问题：我在以这种方式使用 unicode 字符时遇到了很多麻烦。示例：“Nìco”正在出现“NÃ¬co”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T01:57:10.707

```
initscr();
cbreak();
noecho();
nonl();
move(0,0);
scrollok(stdscr, TRUE);
keypad(stdscr, TRUE);
while(TRUE){
    int value = getch();
    if( value == '\r' ){
        int x,y;
        getyx(stdscr,y,x);
        move(y, 0);
        /// add loop and push to buffer
        char values[1024] = {};

        winnstr(stdscr,values, 1024);
        move(y+1, 0);
        printw("buffer was %s", values);
        move(0,0);   
        //break;
    }
    else {
        addch(value);
    }
} 
```

# java - Java 将 URL 中的图像添加到我的 JPanel

> ID：11874166
> 
> 赞同：3
> 
> 时间：2012-08-08T22:31:45.297
> 
> 标签：java, image, swing, url, jpanel

我知道关于这个问题已经发布了很多问题和答案，但我相信我的情况有点扭曲。我在 JFrame 中有一个 JPanel；Jpanel 具有网络地图的绘制图像背景。我使用 MigLayout 创建了一个布局。在此布局的单元格内，我想显示从 url 获得的图像。扭曲的是，在我的项目中，我希望能够每 5 秒左右刷新一次该图像。

话虽如此，我是否应该采用一种特定的方式来添加我的图像，以便以后在项目中每 5 秒刷新一次这些图像时让自己更容易？

如果我缺少任何必要的附加信息，请告诉我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T22:34:49.903

考虑使用 JLabel 网格并在需要时使用 JLabel`setIcon(Icon icon)`方法交换 ImageIcons。要每 5 秒执行一次类似的操作，请考虑使用 Swing Timer。或者，如果您打算每 xxx 秒下载一次图像，那么`SwingWorker<Void, ImageIcon>`.

如果这没有帮助，那么请具体说明您可能被卡住的位置。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T23:22:49.443

扩展 HovercraftFullOfEels 建议，我将创建一个自定义`Component`（`JLabel`在这种情况下可能是一个）。

我会`javax.swing.Timer`在每个中使用一个，设置为每 5 秒重复一次，这将执行一个下载请求。这里的问题是；

1.  如果您有大量图像，可能会导致系统资源耗尽，并且每个组件都需要单独下载
2.  关闭每个图像所需的时间可能会超过 5 秒。在那种情况下你会怎么做？

另一种方法是有一个集中的队列来负责处理下载请求。这可以是自动的（即，您注册`Component`它并决定何时更新）或愚蠢的，您可以随时添加请求。

在自动化模型中，您可以更好地控制资源管理。

在这种情况下，我很想使用[ScheduledExecutorService](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ScheduledExecutorService.html)之类的东西来管理下载任务。基本思想是，在未来的给定时间（5 秒），下载任务将执行，这将下载图像并将其应用于`Component`，然后将新的下载请求注册回`ScheduledExecutorService`

这种方法允许您控制系统创建的线程数以及修改请求之间的时间。

在愚蠢的模型中，我可能会使用`javax.swing.Timer`& 的组合[ExectutorService](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html)（可能是[ThreadPoolExecutor](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html)）。计时器将与 each 相关联`Component`，当它触发时，它将一个新请求放入哑队列。愚蠢的队列，在未来的某个时候会下载图像并将其返回给`Component`.

我看到的主要问题是，组件有可能在前一个请求完成之前请求新图像。虽然您可以使用一些技术来捕获这些条件，但使用智能队列的想法会更简单、更容易

所有这些想法都利用了 Java 的`Thread`功能，在这种情况下，了解[事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/dispatch.html)以及如何[在 Swing 中处理并发非常重要](http://www.google.com.au/url?sa=t&rct=j&q=swing%20event%20dispatch%20thread&source=web&cd=2&ved=0CF4QFjAB&url=http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html&ei=QvQiUOfFJMeQiAfTnYG4Dw&usg=AFQjCNGcXdzVRzVPo6KM1UD_2Png8yGeZg&sig2=vM6NecUriJrPPWsAbjfkVg)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-09T00:59:29.130

如果“5 秒图像”显示“网络状态更新”或类似内容，则应用程序。可能会更好（带宽明智，以及避免图像缓存）以文本（或对象等）的形式获取更新，然后创建适当的图像并在需要时调用重绘。

# sql - 无法删除数据库，因为它正在使用中 + EF 代码优先

> ID：11874167
> 
> 赞同：5
> 
> 时间：2012-08-08T22:31:55.623
> 
> 标签：sql, asp.net-mvc-3, entity-framework-4.1

我是 asp .net mvc3 的新手

我正在尝试通过标准的 asp .net 会员提供程序存储其他用户信息。我创建了一个新实体 UserAddress，并使用会员 API 将其与 aspnet_tables 同步。

但是，现在如果我对 UserAddress 类进行任何更改 - asp.net 不会删除并重新创建模型。我得到错误

无法删除数据库，因为它正在使用中。

我搜索了stackoverflow和谷歌。基本上，我的问题与此类似

[Entity Framework 4 Code First 的数据库使用错误](https://stackoverflow.com/questions/5288996/database-in-use-error-with-entity-framework-4-code-first)

但是，我不确定如何实施 chris 建议的解决方案：

“这发生在我身上，因为我正在针对数据库调用 Membership 方法，这造成了冲突。我通过强制初始化程序在使用 Membership 系统之前运行和种子来解决这个问题”

我很确定这就是数据库正在使用的原因，因为我的代码此时在数据存储库中崩溃了：

```
var userid = Membership.GetUser.ProviderUserKey.ToString();
return db.UserAddress.SingleOrDefault(a => a.UserId == userid); 
```

如何强制初始化程序在会员系统之前运行？

我的代码片段如下：

```
public class UserAddress
{
    public int UserAddressId { get; set; }
    public string UserId { get; set; }
    public string FlatNo { get; set; }
    public string BuildingName { get; set; }
    public string Address1 { get; set; }
    public string Address2 { get; set; }
    public string PostCode { get; set; }
    public string City { get; set; }
    public string State { get; set; }
    public string Country { get; set; }
    public long MobilePhone { get; set; }
}

public class NPLHWebsiteDb : DbContext
{
    public DbSet<UserAddress> UserAddress { get; set; }
}

public class NPLHWebsiteInitializer : DropCreateDatabaseIfModelChanges<NPLHWebsiteDb>
    {
        protected override void Seed(NPLHWebsiteDb context)
        {
            var userAddress = new List<UserAddress>
            {
                new UserAddress {
                    UserAddressId = 1,
                    UserId = "153",
                    FlatNo = "6.4",
                    BuildingName = "Wilton Plaza",
                    MobilePhone = 9810110123,
                }
            };
            userAddress.ForEach(a => context.UserAddress.Add(a));
            context.SaveChanges();
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-09T02:43:55.707

我之前使用 SQL Server Management Studio 连接到 SqlExpress 数据库时遇到过这个问题，并且在我开始我的项目时打开了几个查询。

如果这是您正在做的 - 在开始您的项目之前尝试断开与 SSMS 中的数据库的连接。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-09T13:24:19.777

怀疑罪魁祸首是“会员”。

该代码使用成员资格来查找登录用户的地址。因此，如果我登录网站，那么我的成员资格表将被调用，SQL 将不允许初始化程序删除并重新创建当前正在使用的表（即通过成员资格）。

这正是克里斯在我原来的问题中链接到的堆栈溢出问题中指出的

基本上，解决方案是在调用 Membership 之前强制数据库初始化。我不知道该怎么做。我试图通过输入 URL 来手动访问用户地址页面。但是，这不起作用，因为它在调用成员资格表的行再次失败。

正确的方法是在 Application start 中强制初始化，如下所示：

```
System.Data.Entity.Database.SetInitializer(new MyInitializer());          
MyContext db = new MyContext();         
db.Database.Initialize(true); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T00:27:01.990

您的 Global.asax 中的 Application_Start() 中是否有初始化程序，所以它首先发生？

```
protected void Application_Start() {
    Database.SetInitializer(new NPLHWebsiteInitializer());
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T02:15:02.790

控制器是什么`return db.UserAddress.SingleOrDefault(a => a.UserId == userid);`样子的。

我会尝试，“ `return db.UserAddress.SingleOrDefault(a => a.UserId == userid).ToList()`”

并看到它可以解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-22T14:13:18.170

我首先在实体框架中使用 MVC 4 代码。我将我的会员资格移至另一个数据库，将 Tripping 的代码添加到`Application_Start()`，我不使用 SSMS，将代码移至 start 方法的开头。就像（不同的）马克说的那样，仍然出现错误。

通过遵循[https://stackoverflow.com/a/7007818/2332919](https://stackoverflow.com/a/7007818/2332919)添加`Pooling=false`到我的连接字符串来解决，这让我再次开始，但代价是什么？

# vb.net - 以编程方式打印 HTML 文档

> ID：11874171
> 
> 赞同：1
> 
> 时间：2012-08-08T22:32:19.103
> 
> 标签：vb.net, printing

我需要一种以编程方式将打印作业发送到 IP 打印机的方法。该文档将采用 HTML 格式并位于本地磁盘上。语言无关紧要，我只需要它来工作。我看了这个：http: [//msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.printing.printdocument.aspx)

但我不知道如何在外部调用此函数。

我真的无处可去。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T01:04:29.597

正如 Dan-o 所说，WebBrowser 控件可以解决问题。 [这是代码](http://social.msdn.microsoft.com/Forums/en-US/vbgeneral/thread/1da25ff0-0b6a-4779-9f73-ea13b8f92bc9/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T14:40:18.087

这就是我的做法。不完全是您正在寻找的东西，但我认为您会发现它有效，并且很容易实现。

1) WebApp 将 HTML 输出保存为 PDF 文件。然后将其放置在根据您要打印到的打印机命名的文件夹中。

2) 控制台应用程序（或 Windows 服务）监视文件夹，当它检测到新的 PDF 文件时，它会获取文件并将其发送到与主机文件夹同名的打印机。

3) 然后，您可以根据需要将打印机设置为双面打印、装订、折叠、打孔。

# javascript - 在动画运行时获取矩形的坐标

> ID：11874175
> 
> 赞同：1
> 
> 时间：2012-08-08T22:32:31.557
> 
> 标签：javascript, jquery, html, html5-canvas, kineticjs

我正在尝试在动画运行时获取矩形的坐标。您可以在此处查看动画的代码和类型：http: [//jsfiddle.net/2UZM3/](http://jsfiddle.net/2UZM3/)

可以看到，在动画结束时会打印坐标。我希望在矩形移动时坐标永久更新。

感谢您的帮助！

PS：源代码最初来自这里：[http ://www.html5canvastutorials.com/kineticjs/html5-canvas-transition-easing-functions-with-kineticjs/](http://www.html5canvastutorials.com/kineticjs/html5-canvas-transition-easing-functions-with-kineticjs/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T00:41:16.863

您可以添加一个`stage.onFrame`输出项目坐标的处理程序。只需`stage`在用户单击按钮开始动画时启动，并在方法`stage`上的回调`transitionTo`执行时停止：

```
window.onload = function() {
    var stage = new Kinetic.Stage({
        container: "container",
        width: 500,
        height: 200
    });
    var layer = new Kinetic.Layer();
    var greenBox = new Kinetic.Rect({
        x: 100,
        y: stage.getHeight() / 2,
        width: 100,
        height: 50,
        fill: 'green',
        stroke: 'black',
        strokeWidth: 4
    });

    layer.add(greenBox);
    stage.add(layer);

    stage.onFrame(function(frame) {
        // Update print coordinates on each frame of animation loop
        jQuery("#coordinates").text(Math.round(greenBox.getX()) + "," + Math.round(greenBox.getY()));      
    });

    jQuery("#StartAnim").click(function() {

        // Start the timer running
        stage.start();

        greenBox.transitionTo({
            x: 300,
            duration: 1,
            easing: 'ease-in-out',
            callback: function() {
                // Stop the stage loop
                stage.stop();
            }
        });

    });
}; 
```

[在这里](http://jsfiddle.net/u3mE2/)更新了小提琴。

# php - 来自 PHP 后台进程的实时数据

> ID：11874177
> 
> 赞同：0
> 
> 时间：2012-08-08T22:32:50.610
> 
> 标签：php, html, shell, background-process

我目前正在开发一个项目，该项目使用 twitter firehose 来抓取推文并在 Arduino 上处理/执行操作。执行所有这些操作的 PHP 作为后台进程从我的本地计算机上的终端运行。我想做的是以某种方式在某种前端页面上实时获取数据，而不必每次都重新加载。所以基本上像......

Guy tweets..tweet 是用 PHP 接收和处理的......然后不知何故，tweet 被前端抓取并附加到屏幕上的实时列表中。

唯一的解决方案是运行一个连续的 jquery ajax 调用来查看 SQL 数据库中是否存在新数据？多谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:40:17.157

您需要在客户端执行此操作。因此，您可以使用 ajax 或 websockets。

# actionscript-3 - 在 AS3 中，如何根据列的值将 DataGrid 中的复选框设置为选中或不选中？

> ID：11874181
> 
> 赞同：0
> 
> 时间：2012-08-08T22:33:05.893
> 
> 标签：actionscript-3, apache-flex, datagrid

我正在使用此页面顶部代码提供的自定义 DataGrid 子类：

[http://blogs.adobe.com/aharui/2008/02/checkbox_selection_in_datagrid.html](http://blogs.adobe.com/aharui/2008/02/checkbox_selection_in_datagrid.html)

我有效地为它提供了从 VB.NET Web 服务中提取的两列 DataRows 的 ArrayCollection。其中一列称为“isSelected”，设置为“True”或“False”，它是唯一由复选框表示的列。一切都很顺利，除了我希望代码能够进入并选中和取消选中复选框 - 至少取决于 isSelected 的值是什么。我的代码可以很好地从这些复选框中读取所有内容，用户可以很好地设置它们；只是 DataGrid 组件非常隐蔽并且使用起来很混乱，所以我还没有找到一种方法来让代码本身将特定的复选框设置为选中或取消选中。

你怎么做到这一点？谢谢！

编辑：目前渲染器的代码是这样的：

```
package 
{
import flash.display.DisplayObject;
import flash.events.KeyboardEvent;
import flash.events.MouseEvent;
import flash.text.TextField;

import mx.controls.Alert;
import mx.controls.CheckBox;
import mx.controls.dataGridClasses.DataGridListData;
import mx.controls.listClasses.ListBase;

/** 
*  The Renderer.
*/
public class CheckBoxRenderer extends CheckBox
{
private var _data:*;  
private var selectedSet:Boolean;

override public function set data(value:Object):void {  
    var newSelected:*;  

    //so we don't have to rewrite the label stuff  
    super.data=value;  
    _data = value;  

    if (listData && listData is DataGridListData && DataGridListData(listData).dataField != null)  
    {  
        newSelected = _data[DataGridListData(listData).dataField];  
    }  
    else if (listData)  
    {  
        if (selectedField)  
            newSelected = _data[selectedField];  
    }  
    else  
    {  
        newSelected = _data;  
    }  

    if (newSelected !== undefined)  
    {
        /*if (newSelected is XMLList) {  
            newSelected = newSelected[0];  
            selected = (newSelected == 'true' ? true : false);  
        } else {
            selected = newSelected as Boolean;  
        }*/
        selected = (newSelected == "True" ? true : false);
    }
}  

public function CheckBoxRenderer()
{
    focusEnabled = false;
}

/*  override public function set data(value:Object):void
{
    super.data = value;
    invalidateProperties();
}*/

override protected function commitProperties():void
{
    super.commitProperties();
    if (owner is ListBase)
        selected = ListBase(owner).isItemSelected(data);
}

/* eat keyboard events, the underlying list will handle them */
override protected function keyDownHandler(event:KeyboardEvent):void
{
}

/* eat keyboard events, the underlying list will handle them */
override protected function keyUpHandler(event:KeyboardEvent):void
{
}

/* eat mouse events, the underlying list will handle them */
override protected function clickHandler(event:MouseEvent):void
{
}

/* center the checkbox if we're in a datagrid */
override protected function updateDisplayList(w:Number, h:Number):void
{
    super.updateDisplayList(w, h);

    if (listData is DataGridListData)
    {
        var n:int = numChildren;
        for (var i:int = 0; i < n; i++)
        {
            var c:DisplayObject = getChildAt(i);
            if (!(c is TextField))
            {
                c.x = (w - c.width) / 2;
                c.y = 0;
            }
        }
    }
}

}

} 
```

复选框的选定字段正在设置为正确的东西，但在选定的设置为true时，它在视觉上显示。我还缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:29:20.420

问题不在于 DataGrid，而在于未正确实现的 Checkbox。[有关如何覆盖设置数据的](http://livedocs.adobe.com/flex/3/html/help.html?content=celleditor_4.html)代码，请参阅我的评论，以便如果 dataField 包含 true，则 selected 将起作用。您需要查看 XMLList 的路径，以了解如何调整它以实现您的“True”值。或者您可以将该值转换为布尔值 true。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T01:24:18.620

首先，将您的arraycollection 中包含的对象设置为可绑定的。如果您想以编程方式选中或取消选中复选框，您只需将值直接分配给对象的属性。

鉴于：

```
 <mx:DataGrid id="mygrid" dataProvider="{mycollection}"/> 
```

...

```
 [Bindable]
 var mycollection:ArrayCollection = new ArrayCollection([....]); 
```

……

将第一行设置为选中：

```
 var firstItem:MyObject = mycollection.getItemAt(0);
   firstItem.isSelected = true; // or false 
```

复选框项目渲染器应自动反映列的状态。

# matlab - 如何捕捉鼠标在按钮上的移动

> ID：11874183
> 
> 赞同：1
> 
> 时间：2012-08-08T22:33:16.433
> 
> 标签：matlab

是否可以在鼠标移到按钮上以及鼠标离开按钮时捕获鼠标悬停事件（不涉及单击）。使用数字很容易做到这一点，使用`WindowButtonMotionFcn`. 但是，对于我不知道的按钮或其他类型的对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:10:58.120

虽然我认为如果你很聪明的话，直接用 UIControls 注册回调是不可能的，但实际上并不需要。它有点额外的工作，但如果您知道图中按钮的位置，您可以检查鼠标光标是否在按钮上方并让您的 UI 做出相应的响应。

要记住的一件事是，如果您使用`Normalized`单位创建按钮，则在调整图形大小时必须重新计算它们的位置。您可以使用`resizeFcn`图形的属性来执行此操作。注册一个执行如下操作的回调：

```
u = get(button, 'Units');
set(button,'Units');
buttonPosition = get(button,'Position');
set(button, 'Units', u); 
```

虽然这不能为您提供您正在寻找的确切解决方案，但它应该足以为您提供您想要实现的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T13:54:53.257

您可以使用 WindowButtonMotionFcn 在要执行的操作上添加自己的回调函数。

```
set(gcf,'WindowButtonMotionFcn ',your_callback); 
```

如果你用谷歌搜索它，你可能会找到更多信息，下面的链接显示了一些你可以使用数字的东西。如果您知道按钮 pos 和光标 pos，那么您总是可以这样编写测试。

[http://www.mathworks.com/help/techdoc/ref/figure_props.html](http://www.mathworks.com/help/techdoc/ref/figure_props.html)

# c# - 没有命名空间的 XML 反序列化

> ID：11874187
> 
> 赞同：3
> 
> 时间：2012-08-08T22:33:34.263
> 
> 标签：c#, xml, visual-studio, deserialization, xml-deserialization

我在反序列化没有命名空间的 XML 时遇到了一些麻烦。奇怪的是，我收到一个异常消息“XML 文档 (2,2) 中存在错误。”；内部异常“command_strings xmlns = 不是预期的。”。我在 VS2008 中编码。

我的 XML

```
<?xml version="1.0" encoding="utf-8"?>
<command_strings version="1">
    <commands>
         <command cmd_id="1" state_id="1" label="On" cmd_type="F" cmd_string="1" />
    </commands>
</command_strings> 
```

我的课

```
public class Command
{
    [System.Xml.Serialization.XmlAttribute("cmd_id")]
    public int cmd_id { get; set; }

    [System.Xml.Serialization.XmlAttribute("state_id")]
    public int state_id { get; set; }

    [System.Xml.Serialization.XmlAttribute("label")]
    public string label { get; set; }

    [System.Xml.Serialization.XmlAttribute("cmd_type")]
    public string cmd_type { get; set; }

    [System.Xml.Serialization.XmlAttribute("cmd_string")]
    public string cmd_string { get; set; }
}

[System.Xml.Serialization.XmlRoot("commands_strings")]
public class CommandCollection
{
    [System.Xml.Serialization.XmlAttribute("version")]
    public int version { get; set; }

    [XmlArray("commands")]
    [XmlArrayItem("command", typeof(Command))]
    public Command[] Command { get; set; }
}

public bool IsValidXML()
{
    CommandCollection commandscollection = null;
    XmlSerializer dserial = new XmlSerializer(typeof(CommandCollection));

    using (StreamReader streamReader = new StreamReader(@"C:\123.xml"))
    {
        commandscollection = (CommandCollection)dserial.Deserialize(streamReader);
        streamReader.Close();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T16:50:08.467

试试这个进行反序列化。

```
Stream Read = null;
object m_Configuration = null;
try
{
     FileInfo FI = new FileInfo("C:\\");

     Read = FI.OpenRead();
     XmlSerializer serializer = new XmlSerializer(typeof(CommandCollection));

     m_Configuration = serializer.Deserialize(Read);

}
finally
{
     if (Read != null)
     {
           Read.Close();
     }
} 
```

您也可以尝试不要将 Root 属性放在 CommandCollection 上方，而是使用

```
[XmlType("commands_strings")] 
```

# mysql - SQL：获取一个表的 COUNT 并加入其他表

> ID：11874188
> 
> 赞同：4
> 
> 时间：2012-08-08T22:33:50.683
> 
> 标签：mysql, sql, count, left-join

我有一个看起来像这样的查询：

```
SELECT COUNT(A.Value1) AS Count, B.id AS Id1, C.id AS Id2
FROM Table1 A LEFT JOIN Table2 B ON (B.Name LIKE '%UserInput1%')
LEFT JOIN Table3 C ON (C.Name LIKE '%UserInput2%')
WHERE A.Value1 LIKE 'CertainValue' 
```

查询运行良好；只是我从中得到的**COUNT**并没有给我s 中`Table1`的实际数量，而是s 的数量乘以实际加入的表的数量。`Value1``Table1``Value1`

有什么方法可以从符合条件的 Table1 中获取**COUNT**`A.Value1 LIKE 'CertainValue'`，同时加入其他表？

**仅供参考：**我正在使用 MySQL！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T23:33:37.750

好吧，我想你可以添加`DISTINCT`到你的`COUNT`.

```
SELECT COUNT(DISTINCT A.Value1) AS Count, B.id AS Id1, C.id AS Id2
FROM Table1 A LEFT JOIN Table2 B ON (B.Name LIKE '%UserInput1%')
LEFT JOIN Table3 C ON (C.Name LIKE '%UserInput2%')
WHERE A.Value1 LIKE 'CertainValue' 
```

整个查询确实不是很漂亮，因为您要连接的表似乎彼此之间没有任何关系。结果集应该是一团糟。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-09T00:23:37.993

问题是您在加入后进行计数，因此您正在计算生成的叉积中 A.Value1 的数量。如果您想要原始表中的计数，则应使用子查询。我不认为这会导致很大的性能问题，它实际上应该改进它，因为它减少了生成的连接的大小。

```
SELECT ACount, B.id AS Id1, C.id AS Id2
FROM (Select COUNT(*) ACount FROM Table1 WHERE Value1 LIKE 'CertainValue') A 
LEFT JOIN Table2 B ON (B.Name LIKE '%UserInput1%')
LEFT JOIN Table3 C ON (C.Name LIKE '%UserInput2%') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T00:12:27.387

所写的查询将返回一个笛卡尔积，因为 A、B 和 C 根本没有连接。另外，count 是一个关键字，最好在 select 中使用另一个标识符。尝试像这样编写查询：

```
SELECT COUNT(A.Value1) AS MyCount, B.id AS Id1, C.id AS Id2
FROM Table1 A
LEFT JOIN Table2 B ON A.?? = B.??
LEFT JOIN Table3 C ON A.?? = C.??
WHERE A.Value1 LIKE '%CertainValue%'
AND B.Name LIKE '%UserInput1%'
AND C.Name LIKE '%UserInput1%'
GROUP BY B.id, C.id 
```

# qt - QNetworkAccessManager - 设置主动/被动 ftp 模式

> ID：11874189
> 
> 赞同：0
> 
> 时间：2012-08-08T22:33:56.717
> 
> 标签：qt, qt4

我希望能够在使用 QNetworkAccessManager 时设置 FTP 模式（主动或被动）。

QFtp 有 setTransferMode()，有没有办法用 QNetworkAccessManager 做到这一点？

# scala - sbt- ManagedStyle.Maven

> ID：11874190
> 
> 赞同：2
> 
> 时间：2012-08-08T22:34:00.257
> 
> 标签：scala, maven, sbt

我试图将 jars 从 sbt 推送到我们当地的 maven repo。我使用 SBT-0.11.3

我按照 github wiki 上的说明进行操作。我的项目目录下有一个 build.scala

```
import sbt._
import Key._

object MyBuild extends Build{
    override def managedStyle = ManagedStyle.Maven
   lazy val publishTo = "internal" at "http://playground:9049/archiva/repository/internal/"
} 
```

但是当我做 sbt 时，我得到一个错误 "not found:ManagedStyle" 。我该如何解决 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T23:44:41.820

该`managedStyle`方法和`ManagedStyle`对象仅存在于 sbt 0.7 中。

在 sbt 0.10+ 中，你有一个`SettingKey`命名的`publishMavenStyle`. 例如，在一个简单的`build.sbt`你写

```
publishMavenStyle := true 
```

在[完整的构建文件](https://github.com/harrah/xsbt/wiki/Getting-Started-Full-Def)中，您需要将其包含在项目的设置中。

* * *

您的`publishTo`条目也是如此——这是一个设置，在构建文件的顶层编写它是没有意义的。尽量坚持[简单的构建文件格式](https://github.com/harrah/xsbt/wiki/Getting-Started-Basic-Def)。

# categories - Prestashop：如果父类别为空，则显示子类别中的产品

> ID：11874191
> 
> 赞同：2
> 
> 时间：2012-08-08T22:34:09.210
> 
> 标签：categories, prestashop

请帮我解决以下问题：

我的网站在选择类别时显示相应的子类别，并显示“该类别中没有产品”的消息。这在向下钻取时发生，直到到达较低级别的子类别。

我想展示其子类别的所有产品。

请问我该怎么做？

非常感谢您的建议，

史蒂文

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T03:14:29.273

打开`/controllers/CategoryController.php`并将以下代码添加到`process()`方法中，注意注释告诉您从哪里开始和结束添加代码

```
public function process()
{
    ....
            }
            if ($this->category->id != 1)
                $this->productListAssign();

            /* MODIFICATION STARTS HERE */  
            if(!(isset($this->cat_products) AND $this->cat_products) ){ 
                $this->category->id=array();
                foreach($subCategories as $k=>$v){
                    $this->category->id[]=$v['id_category'];
                }
                $this->productListAssign();

            }
            /* MODIFICATION ENDS HERE */    

            self::$smarty->assign(array( ...
} 
```

然后打开`classes/Category.php`并更改 SQL 查询的 WHERE CLAUSE 行`public function getProducts`从

```
 WHERE cp.`id_category` = '.(int)$this->id.($active ? ' AND p.`active` = 1' : '').' 
```

至

```
 WHERE cp.`id_category` '.(is_array($this->id)?" IN(".implode(',',$this->id).") ": "=".(int)$this->id).($active ? ' AND p.`active` = 1' : '').' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-15T18:14:42.230

您无需更改任何内容即可实现此目的。

只需将产品不仅分配给它所在的子类别，还分配给父类别（在 BO 中的产品编辑中）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-02T07:05:23.990

您也可以只安装分层导航模块（blocklayered）。此模块的默认行为是显示子类别产品，即使选择器小部件在页面上不可见/不活动也是如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-19T22:28:00.427

在 categoryController.php 中，您可以找到该`process()`方法。那是获得类别页面上显示的所有信息的那个。`$cat_product`你会找到一个存储所有产品的变量（如果我的记忆好的话，我想它会被调用）。您可以轻松检查它是否为空。然后从这里你只需要获取子类别（在类别类中有一个方法），然后获取这些类别的产品（还有一个获取类别产品的方法）。这只是您必须遵循的逻辑，毕竟您需要的所有代码都已经在框架中。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-10-26T18:34:30.317

在主标题菜单上添加新类别非常简单，只需转到模块 - Pos Megamenu Customer 并添加您想要的任何内容。

完毕！！

# java - GunzipOutputStream - 或类似的东西 - 是否存在？

> ID：11874193
> 
> 赞同：3
> 
> 时间：2012-08-08T22:34:19.243
> 
> 标签：java, http, gzip, http-compression, content-encoding

与[处理 HTTP ContentEncoding "deflate"](https://stackoverflow.com/q/3932117/276232)相关，我想知道如何使用 an`OutputStream`来膨胀`gzip`和`deflate`流。原因如下：

我有一个从 Web 服务器获取资源的类（想想`wget`，但在 Java 中）。我有它严格执行响应的内容长度，我想保持这种执行。所以，我想做的是从响应中读取特定数量的字节（我已经在这样做了），但是如果响应已被压缩，它会生成更多字节。

我有这样的`deflate`回应：

```
OutputStream out = System.out;
out = new InflateOutputStream(out);
// repeatedly:
out.write(compressedBytesFromResponse); 
```

我希望能够对`gzip`响应做同样的事情，但是如果没有 GunzipOutputStream，我不确定下一步该做什么。

## 更新

我正在考虑构建这样的东西[，](http://repo.aduna-software.org/svn/org.openrdf/alibaba/branches/kenwenzel/metadata-server/src/main/java/org/openrdf/server/metadata/filters/GUnzipOutputStream.java)但它似乎完全疯了。也许这是使用 an`OutputStream`来膨胀我的数据的唯一方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T02:14:20.837

对于`deflate`，Java 有[InflaterOutputStream 可以满足](http://docs.oracle.com/javase/6/docs/api/java/util/zip/InflaterOutputStream.html)您的需求：向其提供压缩的放气数据，并将未压缩的数据发送到其底层输出流。

* * *

For `gzip`... 似乎找不到等价物。 `InflaterOutputStream`的同伴`InflaterInputStream`有一个`GZipInputStream`处理所有标头的子类，但没有等效的解压缩输出流类可能是 的子类`InflaterOutputStream`。

为 GZIP构建`InflaterOutputStream`自己的子类看起来很麻烦，查看源代码`GZipInputStream`（处理标题、预告片等）

使用管道流似乎是两害相权取其轻。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T17:15:46.687

回答我自己的问题：

这里有两种可能性：输出上的 gunzip（例如 use `GunzipOutputStream`，Java API 未提供），或输入上的 gunzip（例如 use `GZIPInputStream`，由 Java API 提供）*加上*在读取期间强制执行 Content-Length。

我两者都做过，而且我认为我更喜欢后者，因为 a) 它不需要启动单独的线程来将字节从`PipedOutputStream`a`PipedIOnputStream`和 b) （推论，我猜）它没有这样的种族威胁-条件和其他同步问题。

首先，这是我的 实现`LimitedInputStream`，它允许我包装输入流并强制限制读取的数据量。请注意，我还有一个`BigLimitedInputStream`使用`BigInteger`计数来支持大于的 Content-Length 值`Long.MAX_LONG`：

```
public class LimitedInputStream
    extends InputStream
{
    private long _limit;
    private long _read;
    private InputStream _in;

    public LimitedInputStream(InputStream in, long limit)
    {
        _limit= limit;
        _in = in;
        _read = 0;
    }
    @Override
    public int available()
        throws IOException
    {
        return _in.available(); // sure?
    }

    @Override
    public void close()
        throws IOException
    {
        _in.close();
    }

    @Override
    public boolean markSupported()
    {
        return false;
    }

    @Override
    public int read()
        throws IOException
    {
        int read = _in.read();

        if(-1 == read)
            return -1;

        ++_read;

        if(_read > _limit)
            return -1;
            // throw new IOException("Read limit reached: " + _limit);

        return read;
    }

    @Override
    public int read(byte[] b)
        throws IOException
    {
        return read(b, 0, b.length);
    }

    @Override
    public int read(byte[] b, int off, int len)
        throws IOException
    {
        // 'len' is an int, so 'max' is an int; narrowing cast is safe
        int max = (int)Math.min((long)(_limit - _read), (long)len);

        if(0 == max && len > 0)
            return -1;
            //throw new IOException("Read limit reached: " + _limit);

        int read = _in.read(b, off, max);

        _read += read;

        // This should never happen
        if(_read > _limit)
            return -1;
            //throw new IOException("Read limit reached: " + _limit);

        return read;
    }

    @Override
    public long skip(long n)
        throws IOException
    {
        long max = Math.min((long)(_limit - _read), n);

        if(0 == max)
            return 0;

        long read = _in.skip(max);

        _read += read;

        return read;
    }
} 
```

使用上面的类来包装从`InputStream`获得的`HttpURLConnection`允许我简化现有代码，我必须读取`Content-Length`标题中提到的精确字节数，然后盲目地将输入复制到输出。然后我将输入流（已经包装在 中`LimitedInputStream`）包装在 a 中`GZIPInputStream`以进行解压缩，并将字节从（双重包装）输入泵送到输出。

不太直截了当的路线是继续我原来的路线：使用（结果是）一个尴尬的类来包装 OutputStream `GunzipOutputStream`：. 我编写了一个`GunzipOutputStream`使用内部线程通过一对管道流泵送字节的方法。它很丑，而且它基于[OpenRDF 的`GunzipOutputStream`](http://repo.aduna-software.org/svn/org.openrdf/alibaba/branches/kenwenzel/metadata-server/src/main/java/org/openrdf/server/metadata/filters/GUnzipOutputStream.java). 我觉得我的比较简单：

```
public class GunzipOutputStream
    extends OutputStream
{
    final private Thread _pump;

    // Streams
    final private PipedOutputStream _zipped;  // Compressed bytes are written here (by clients)
    final private PipedInputStream _pipe; // Compressed bytes are read (internally) here
    final private OutputStream _out; // Uncompressed data is written here (by the pump thread)

    // Internal state
    private IOException _e;

    public GunzipOutputStream(OutputStream out)
        throws IOException
    {
        _zipped = new PipedOutputStream();
        _pipe = new PipedInputStream(_zipped);
        _out = out;
        _pump = new Thread(new Runnable() {
            public void run() {
                InputStream in = null;
                try
                {
                    in = new GZIPInputStream(_pipe);

                    pump(in, _out);
                }
                catch (IOException e)
                {
                    _e = e;
                    System.err.println(e);
                    _e.printStackTrace();
                }
                finally
                {
                    try { in.close(); } catch (IOException ioe)
                    { ioe.printStackTrace(); }
                }
            }

            private void pump(InputStream in, OutputStream out)
                throws IOException
            {
                long count = 0;

                byte[] buf = new byte[4096];

                int read;
                while ((read = in.read(buf)) >= 0) {
                    System.err.println("===> Pumping " + read + " bytes");
                    out.write(buf, 0, read);
                    count += read;
                }
                out.flush();
                System.err.println("===> Pumped a total of " + count + " bytes");
            }
        }, "GunzipOutputStream stream pump " + GunzipOutputStream.this.hashCode());

        _pump.start();
    }

    public void close() throws IOException {
        throwIOException();
        _zipped.close();
        _pipe.close();
        _out.close();
    }

    public void flush() throws IOException {
        throwIOException();
        _zipped.flush();
    }

    public void write(int b) throws IOException {
        throwIOException();
        _zipped.write(b);
    }

    public void write(byte[] b) throws IOException {
        throwIOException();
        _zipped.write(b);
    }

    public void write(byte[] b, int off, int len) throws IOException {
        throwIOException();
        _zipped.write(b, off, len);
    }

    public String toString() {
        return _zipped.toString();
    }

    protected void finish()
        throws IOException
    {
        try
        {
            _pump.join();
            _pipe.close();
            _zipped.close();
        }
        catch (InterruptedException ie)
        {
            // Ignore
        }
    }

    private void throwIOException()
        throws IOException
    {
        if(null != _e)
        {
            IOException e = _e;
            _e = null; // Clear the existing error
            throw e;
        }
    }
} 
```

同样，这可行，但它似乎相当......脆弱。

最后，我重构了我的代码以使用`LimitedInputStream`and`GZIPInputStream`而没有使用`GunzipOutputStream`. 如果 Java API 提供了`GunzipOutputStream`，那就太好了。但事实并非如此，而且如果不编写“本机”gunzip 算法，实现您自己的算法就会`GunzipOutputStream`扩展适当的限制。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-08T23:35:01.527

如果您使用 HttpURLConnection 所有这些事情都会自动发生。

# codeigniter - 在 codeigniter 的多行中只选择一列。如何以及这更有效？

> ID：11874194
> 
> 赞同：6
> 
> 时间：2012-08-08T22:34:21.730
> 
> 标签：codeigniter, activerecord, query-optimization

我正在考虑效率，但我并不确定这种或另一种方式。

但我有一堆多列的行。我只需要某个其他键为某个值的所有行中的名称字段。我可以像这样得到所有这些行：

```
$this->db->where('res_id', $res_id);
$q = $this->db->get('products');
return $q->result(); 
```

然后我可以遍历它返回的数组，并且只使用每个对象的 name 方法，例如：

```
foreach($returned_value as $fun):
    echo $fun->name;
endforeach; 
```

但我想知道，只从每一行中选择名称属性会更有效吗？我觉得很愚蠢，因为我一直在使用活动记录，但我该怎么做。我意识到我可以使用该函数将其写出来`$this->db->query()`，但是有没有办法使用主要的活动记录命令来指定它？谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-08T22:39:27.160

```
 $this->db->select('name'); 
    $this->db->from('tblNAME');   
    $this->db->where('res_id', $res_id);
    return $this->db->get()->result(); 
```

我想它更快更有效，因为你没有返回所有东西。

未经测试

这是我使用的一个经过测试的函数，您可能会找到很好的参考

```
function get($id = null) 
        {
            $this->db->select('id, Username, First_Name, Last_Name, Role, Email');
            $this->db->from('user');
            if (!is_null($id)) $this->db->where('id', $id);
            $this->db->order_by('id', 'desc');
            return $this->db->get()->result();
        } 
```

# objective-c - NSInvalidArgumentException - 接收者没有标识符的segue

> ID：11874200
> 
> 赞同：31
> 
> 时间：2012-08-08T22:35:10.103
> 
> 标签：objective-c, uiviewcontroller, segue, identifier, uistoryboardsegue

我已经尝试了好几个小时，但没有任何效果。我试图在两个视图控制器之间进行切换，从一个 tableViewController 到另一个 tableViewController。segue 连接到顶层视图，而不是 tableviewcell。Xcode 中设置的标识符与代码中使用的标识符相同（复制和粘贴）。昨晚它工作得很好，但现在我似乎无法让它在不崩溃的情况下继续运行。

以下是调用 segue 的方法

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{

    self.photoList = [FlickrFetcher photosInPlace:[self.topPlacesList objectAtIndex:indexPath.row] maxResults:50];
    NSLog(@"photolist %@", self.photoList);

    NSLog(@"here");

    [self performSegueWithIdentifier:@"segue1" sender:self];
    NSLog(@"here");
}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if([segue.identifier isEqualToString:@"segue1"])
    {
        PhotosTableViewController *photosTVC = segue.destinationViewController;
        photosTVC.photoList = self.photoList;
    }
} 
```

这是错误报告

2012-08-08 15:28:39.093 Top Places[512:f803] *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“接收者（PlacesTableViewController：0x6887ff0）没有标识符为“segue1”的segue ***第一次抛出调用堆栈:( 0x13c0052 0x1551d0a 0xde24b 0x3efd 0xa771d 0x7952 0x112f86d 0x1394966 0x12f77c0 0x12f77c0 0x12f6db4 0x12f6ccb 0x12a9879 0x12a9930 0x12a993e 0x12a9930 0x12a9930 0x12a9930 0x12a993e 0x12a9a9b 0x12778 0x17a9b 0x2778 0x26d5）终止称为抛出异常

[这是情节提要的截图 http://s14.postimage.org/66wf13q4h/Screen_Shot_2012_08_08_at_3_22_10_PM.png](http://s14.postimage.org/66wf13q4h/Screen_Shot_2012_08_08_at_3_22_10_PM.png)

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-04-14T20:41:38.877

我可以通过在 Xcode 的“产品”菜单下运行“清洁”并重置模拟器中的内容和设置来修复它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-12T00:16:48.927

我有同样的问题。在我的初始化程序`- (id)initWithCoder:(NSCoder *)aDecoder`中，我正在做`self = [super init];`我应该做的事情`self = [super initWithCoder:aDecoder];`。当我解决这个问题时，一切都按预期工作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-15T21:40:14.053

我遇到了同样的问题，并为此苦苦挣扎了好几个小时。Stackmonster 的回答解决了我的问题（重命名情节提要），但我不明白为什么它解决了问题。

我发现当我更改情节提要上的项目（添加标签或更改背景颜色）时，它并没有反映在模拟器中 - 我没有使用我可以在 xcode 中看到的情节提要，而是情节提要的旧版本。我不得不在项目导航器中重命名故事板，并在`info.plist`（在支持文件中）重命名它，我的标签出现了，背景颜色应用了，segue 起作用了。

我不知道为什么故事板的更改没有生效，但这让我花了很多时间去寻找。我在博客上看到很多开发人员都有同样的问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-30T08:45:54.060

我修好了它！1\. 确保在 Xcode 中选择了正确的故事板（如果您重命名故事板，请在项目摘要中更改它）。然后删除模拟器上的应用程序并重新启动

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-08T23:16:46.807

在 Interface Builder 中，您需要设置`segue1`连接到视图控制器的 segue 标识符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-09-19T00:33:59.900

我尝试了列出的所有内容，但没有运气。有效的是为新视图创建一个新的转场，然后使用那个，运行它，然后创建一个转回旧视图的转场。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-28T20:57:30.953

在展开 segue 时遇到了这个问题。终于意识到，当我更换情节提要上的视图控制器时，我丢失了我的标识符。我通过单击文档大纲（情节提要的侧边栏）中的展开转场重新添加它，然后在属性检查器中为其添加标识符。

如果没有其他方法，至少在放松转场方面，您可以致电

```
[self dismissViewControllerAnimated:YES completion:nil]; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-02-07T16:48:21.857

当我将新的 VC 作为另一个视图控制器的子类时，我遇到了同样的问题。它应该是 UIViewController 或 UITableViewController 的子类。检查头文件是否正在导入 UIKIT。

# iphone - 如何在 iPhone 中更改 Facebook 重定向到的应用程序？

> ID：11874203
> 
> 赞同：-1
> 
> 时间：2012-08-08T22:35:23.790
> 
> 标签：iphone, facebook

我正在将 Facebook 登录添加到我的 iPhone 应用程序中，并使用一个示例 iPhone 应用程序对其进行测试，然后我从该示例应用程序登录到 Facebook 到我的 Facebook 应用程序并且它工作正常。但是现在当我通过我的真实 iPhone 应用程序登录 Facebook 时，成功登录后，它总是将我重定向到我的示例 iPhone 应用程序。如果我删除我的示例 iPhone 应用程序，它会在 Facebook 登录后显示“页面无法显示”。登录后如何让 Facebook 重定向到我的真实 iPhone 应用程序（只需带我回到我原来的 iPhone 应用程序）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T02:01:33.057

要在使用 facebook 登录后重定向到任何 url，您可以将 redirect_uri 参数附加到登录 url： [https](https://www.facebook.com/dialog/oauth?client_id=...&redirect_uri=) ://www.facebook.com/dialog/oauth?client_id=...&redirect_uri= ...

# php - 如何在 curl 响应中找到字段的值？正则表达式？

> ID：11874206
> 
> 赞同：0
> 
> 时间：2012-08-08T22:35:49.633
> 
> 标签：php, regex, curl

我正在使用 cURL ping 导致 HTML 表的 API。我只想返回一个名为“errorCode”的字段的单个数字值。

（我正在使用 Jquery 来 ajax 我的 Curl.php 页面，它会 ping 一个 API，该 API 将回显到 curl 页面，从而在成功时将数字返回给我的 Jquery。大声笑是的）。

大部分都有效，除了我似乎无法解析 HTML 以获取我需要的唯一字段。我希望它是 XMl，但它不是。

我应该使用正则表达式来查找字段并提取其值吗？其他方式？

我的 CURL 页面的底部，它输出所有 HTML。我只需要提取名为“errorCode”的隐藏字段的值，然后回显到页面。

```
 $retValue = curl_exec($ch);                             
    echo $retValue; 
```

$retValue 当前打印整个页面，包括 HTML 标签、表格标签等。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:56:11.633

使用[`DOMDocument`](http://php.net/manual/en/class.domdocument.php)和[`DOMXPath`](http://www.php.net/manual/en/class.domxpath.php)

```
$dom = new DOMDocument();
$dom->loadHTML($retValue);
$path = new DOMXPath($dom);
$item = $path->query('/table/tr/td[errorCode]');//whatever the xpath is
$value = $item->item(0)->textContext; 
```

# c++ - 改变派生类函数的行为，对其他人影响最小或没有影响

> ID：11874209
> 
> 赞同：-4
> 
> 时间：2012-08-08T22:36:14.167
> 
> 标签：c++

我目前在使用基类中定义为 const 的函数时遇到问题。

我正在使用上述虚函数实现派生类，但返回值是非 const。我想在不更改基类的情况下实现它，因为还有其他外部类使用这个虚函数。不更改此虚函数的原因是存在使用相同函数的其他派生类。

非常感谢任何帮助。

例如：我正在实现`double DerivedClass1::Function()`具有不同返回值的派生类函数，该函数是在`double BaseClass::Function() const`. 同样的功能由我使用`double DerivedClass2::function() const`，`double DerivedClass3::Function() const`我无法控制。如何在不对基类进行任何或最小更改的情况下做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:33:22.087

我不确定我是否完全理解你，但也许这就是你想要的：

```
struct BaseClass {
    virtual double Function() {return const_cast<const BaseClass*>(this)->Function();}
    virtual double Function() const=0;
    virtual BaseClass() {}
};
struct DerivedClass1: public BaseClass {
    virtual double Function() {stuff};
    virtual double Function() const {throw std::logic_error("UNIMPLEMENTED");};
};
struct DerivedClass2: public BaseClass {
    virtual double Function() const {stuff};
}; 
```

不用说，这是一个非常糟糕的主意。BaseClass 实现会将可变实例重定向到现有`const`函数，除非它们已被派生类覆盖，正如您在`DerivedClass1`. 问题是如果你调用`Function()`a `const DerivedClass1`，那么你会在运行时得到一个异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:48:20.727

你有：

```
struct Base {
    virtual double Function() const;
};

struct Derived1 : Base {
    virtual double Function() const;
};

struct Derived2 : Base {
    virtual double Function() const;
}; 
```

你要：

```
struct Derived1 : Base {
    virtual double Function(); // overrides virtual function in base
}; 
```

所以，首先你需要添加一个非常量虚函数到`Base`，否则你不会覆盖任何东西。问题是，基类函数应该定义为什么？为了最小化中断，它应该做与当前通过非常量引用调用函数相同的事情——调用 const 函数：

```
struct Base {
    virtual double Function() const;
    virtual double Function() { return static_cast<const Base*>(this)->Function(); }
};

struct Derived1 : Base {
    virtual double Function() const;
    virtual double Function();
};

struct Derived2 : Base {
    virtual double Function() const;
    // no need to override non-const Function
}; 
```

我认为这仍然可能会破坏现有代码，例如，如果您将指针指向函数的 const 和非 const 版本，那么以前它们会比较相等，而现在它们不会：

```
typedef double (Base::*constfunc)() const;
typedef double (Base::*mutfunc)();
((mutfunc)(constfunc(&Base::Function)) == (mutfunc(&Base::Function))); // was true, now false 
```

对于该类的典型用户`Base`，添加新功能可能是无害的。

`double`但是，您说：“使用上述虚函数但具有非 const 返回值”，并且您的示例函数即使使用 const 版本的函数也已经具有非 const 返回值 ( )。所以答案无法解决这个问题，而且通过隐藏你的真实用例，你得到的答案可能比你通过一个更好地反映你的实际代码的例子得到的答案更糟糕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T23:22:35.310

想要覆盖虚拟基方法的派生方法**必须**使用与基方法完全相同的签名，包括使用 of `const`，否则派生方法将仅隐藏基方法而不是覆盖它。如果您打算重写，则不能更改派生类中的签名。

# regex - Emacs 用 html 查询替换正则表达式

> ID：11874211
> 
> 赞同：3
> 
> 时间：2012-08-08T22:36:22.563
> 
> 标签：regex, emacs, replace

*我在Emacs*中尝试了*replace-regexp*命令，但我不知道如何构建正确的正则表达式。我的文件如下所示：

 *```
<img src="http://s.perros.com/content/perros_com/imagenes/thumbs/1lundehund2.jpg" />
<img src="http://s.perros.com/content/perros_com/imagenes/thumbs/1pleon2.jpg" /> 
```

我想替换为：

```
<img src="" class="class-1lundehund2.jpg" />
<img src="" class="class-1pleon2.jpg" /> 
```

我使用这个正则表达式没有成功（*替换了 0 次*）：

```
M-x replace-regexp
  Replace regexp:  src\=\"http\:\/\/s\.perros\.com\/content\/perros_com\/imagenes\/thumbs\/\([a-zA-Z0-9._-]+\)\"
  Replace regexp with: src\=\"\" class\=\"class-\1\" 
```

但是在具有相同正则表达式的*重新构建器模式下（将***\([a-zA-Z0-9\. *-]+\)****更改为**\\([a-zA-Z0-9.*** **-]+\\)**）所有结果正确突出显示。我不知道发生了什么，有什么提示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:20:13.017

我觉得你逃避的东西太多了。正则表达式 = `src="http://s\.perros\.com/content/perros_com/imagenes/thumbs/\([^"]*\)"`，替换 =`src="" class="class-\1"`*

# php - 如何处理从 PHP Mysql API 到 PDO 的转换中的数据类型

> ID：11874213
> 
> 赞同：3
> 
> 时间：2012-08-08T22:36:44.637
> 
> 标签：php, mysql, pdo

我正在将我们的网站从 PHP Mysql API 转换为 PDO，并且遇到了数据类型问题。

以前，我们将所有变量都转义为字符串。例如，

```
SET varname = '$varvalue' 
```

现在，有了 PDO，我当然愿意

```
SET varname = :varvalue 
```

然后我们有一个类来处理 $varvalue 的值的绑定，根据变量的类型设置数据类型。

当 varname 应该是一个字符串时，我们的问题就出现了，而 $varvalue 出于某种原因是 null。以前，当 $varvalue 为空时，'$varvalue' 会变成 ''。现在，我们“正确”地将 $varvalue 绑定为 null，但数据库字段不允许为 null。

我知道解决这个问题的最正确方法是确保 $varvalue 以正确的值进入函数，但是我们有大量的遗留代码库，这确实需要大量的工作来实现。另一种解决方案是在我们将每个变量绑定到正确的类型时显式地转换它。如果可能的话，我们更喜欢一种避免我们必须在模型中显式转换每个变量的解决方案。有吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T09:07:53.647

这可能不是您正在等待的答案，但应该提到：使用异常。

您可以将 PDO 配置为抛出类型异常，`PDOException`而不是依赖于返回值：

```
$db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

您可以捕获这些异常并将它们记录下来、通过电子邮件发送它们等，以便您可以准确地识别出哪段代码传递了错误的值并修复它。

这是一个有点痛苦的操作；当我们开始在我们的网站上报告所有未捕获的异常并且我们的收件箱中充斥着错误时，我们不得不自己忍受这种情况。它持续了几天，但我们设法清除了所有非常糟糕的代码:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T21:43:21.277

既然以前你不介意有空字符串，为什么不检查 var 值是否为空呢？

```
$stmt->bindParam(':varvalue', (is_null($varvalue) ? '' $varvalue), PDO::PARAM_STR); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-18T00:42:59.087

您可能应该为您的应用程序使用抽象，而不是直接使用 PDO。在您的抽象层中，您可以执行您想要执行的任何类型转换。

如果这绝对不是一个选项并且您*必须*直接使用 PDO，那么您可以尝试子类化和委托以生成执行所需类型转换的 PDO 类似对象。但是，如果有任何列*确实*期望为空，那么您的抽象层将会大大复杂化。您可能需要对数据库或其他一些技巧进行自省。您可能无法准确地保留 PDO API。

## `PDOStatement`代表团

这对于`bindValue`. 但是，`bindParam`使用引用并且我们不能在不重写它们的情况下对它们进行类型转换，因此我们需要一种解决方法，在`bindValue`调用时将它们转换`execute`为调用。

首先我们子类化`PDO`，所以它返回我们新的 Wrapped `PDOStatement`。

```
class PDO_nullcast extends PDO {
    public function prepare($statement, $driver_options=array()) {
        $prepared = parent::prepare($statement, $driver_options);
        $delegated_prepared = new PDOStatement_nullcast($prepared);
        return $delegated_prepared;
    }
} 
```

然后我们创建一个`PDOStatement_nullcast`具有空转换语义的委托。我们的第一次尝试只会覆盖`bindValue`.

```
class PDOStatement_nullcast {
    protected $pstmt;
    protected $bindparams; // this is for later
    function __construct(PDOStatement $pstmt) {
        $this->pstmt = $pstmt;
        $this->bindparams = array();
    }
    function __get($k) {
        return $this->pstmt->{$k};
    }
    function __set($k, $v) {
        $this->pstmt->{$k} = $v;
    }
    function __call($k, $a) {
        return call_user_func_array(array($this->pstmt, $k), $a);
    }
    function bindValue($parameter, $value, $data_type=PDO::PARAM_STR) {
        $newvalue = $this->castValue($value, $data_type);
        return $this->pstmt->bindValue($parameter, $newvalue, $data_type);
    }
    static public function castValue($val, $typehint) {
        $newval = $val;
        if ($val===NULL) {
            if ($typehint===PDO::PARAM_STR) {
                $newval = '';
            } else if ($typehint===PDO::PARAM_INT) {
                $newval = 0;
            } else if ($typehint===PDO::PARAM_BOOL) {
                $newval = false;
            }
        } else {
            if ($typehint===PDO::PARAM_STR) {
                $newval = (string) $val;
            } else if ($typehint===PDO::PARAM_INT) {
                $newval = (int) $val;
            } else if ($typehint===PDO::PARAM_BOOL) {
                $newval = (bool) $val;
            }
        }
        return $newval;
    }
} 
```

这是一些演示代码。我们将使用下表作为示例：

```
CREATE TABLE `typetest` (
  `intcol` int(11) NOT NULL,
  `strcol` varchar(255) NOT NULL,
  `intnullcol` int(11) DEFAULT NULL,
  `intstrcol` varchar(255) DEFAULT NULL,
) 
```

现在是 PHP 代码。假设您有一个`PDO_nullcast`对象分配给`$db`：

```
$sql = 'INSERT INTO typetest (`intcol`, `strcol`, `intnullcol`, `intstrcol`) VALUES (?,?,?,?)';
$insert = $db->prepare($sql);
$insert->bindValue(1, null, PDO::PARAM_INT);
$insert->bindValue(2, null, PDO::PARAM_STR);
$insert->bindValue(3, null, PDO::PARAM_INT);
$insert->bindValue(4, null, PDO::PARAM_STR);
$insert->execute();
$insert->closeCursor();

$select = $d->prepare('SELECT * FROM typetest');
$select->execute();
$res = $select->fetchAll();
$select->closeCursor();

var_dump($res); 
```

您可以将`castValue`函数更改为您想要的语义。

但是，这不会处理这种`bindParam`情况。在这里，我们需要在内部保留一个引用，直到`execute`在我们的包装器上被调用，然后将它们转换为`bindValue`调用。但是，我们无法处理`bindParam`这种方式的所有用途！INOUT 参数没有解决方法，因为我们无法通过类型转换保留引用。

我们可以像这样拦截`bindParam`和`execute`调用来得到我们想要的（在`PDOStatement_nullcast`上面的类中添加以下方法）：

```
function bindParam($parameter, &$variable, $data_type=PDO::PARAM_STR, $length=null, $driver_options=null) {
    if (isset($length) || isset($driver_options) || ($data_type & PDO::PARAM_INPUT_OUTPUT)) {
        // in either of these cases, we cannot wrap!
        return $this->pstmt->bindParam($parameter, $variable, $data_type, $length, $driver_options);
    }
    // note we preserve a reference to the variable
    $this->bindparams[] = array($parameter, &$variable, $data_type);
    return true; // this is a bit of a lie--we can't know if we would have an error until later.
}
function execute($input_parameters=null) {
    if ($input_parameters!==null) {
        return $this->pstmt->execute($input_parameters);
    }
    // for-loop is to preserve references more clearly
    // foreach is trickier
    for ($i=0; $i < count($this->bindparams); $i++) {
        call_user_func_array(array($this,'bindValue'), $this->bindparams[$i]);
    }
    return $this->pstmt->execute();
} 
```

这是一些使用的测试代码`bindParam`：

```
$var = null;
$insert->bindParam(1, $var, PDO::PARAM_INT);
$insert->bindParam(2, $var, PDO::PARAM_STR);
$insert->bindParam(3, $var, PDO::PARAM_INT);
$insert->bindParam(4, $var, PDO::PARAM_STR);
error_log($var);
$insert->execute();
$var = 1;
$insert->execute();
$var = 2;
$insert->execute(); 
```

# jquery - “：”在jQuery中做什么？

> ID：11874214
> 
> 赞同：0
> 
> 时间：2012-08-08T22:36:47.207
> 
> 标签：jquery, function

> **可能重复：**
> [“：”在 JavaScript 中做了什么？](https://stackoverflow.com/questions/418799/what-does-do-in-javascript)

我正在尝试学习 jQuery，我注意到某人的代码中有以下语法。如果有人可以向我解释，那就太好了。

```
functionName: function(form, callback)
    {   
        form.submit(function(event) {
            event.preventDefault();
            callback(TestPageUtils.getFormParams(form));
            return false;
        });
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T22:38:33.380

语法`{ property: value }`是标准的 JavaScript 表示法。

冒号左侧是属性名称，在您的情况下是“functionName”，右侧是其值，在您的情况下是函数定义。

然后，这些函数用逗号分隔：

```
var obj = { x: 1, f: function(a) { alert(a); } };

alert(obj.x) // alerts 1
obj.f(1)     // alerts 1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T22:40:04.377

那是“不是”jQuery，而是通用的 Javascript 语法。这就是您在对象文字中定义成员的方式，在这种情况下，该成员是一个函数。

例如：

```
person = 
{
    name: "John",
    age: 432,
    walk: function (){alert("Walking!");}
} 
```

是另一个 Javascript 对象。要访问其成员，只需执行`person.name`. 或者，如果你想让这个人走路，像这样调用它的 walk 方法`person.walk()`：

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T22:37:47.030

这本身不是“jQuery”——它是基本的 Javascript 语法。

“：”表示属性“functionName”具有值`function(...) { ... }`

这是一个很好的图表（JSON 语法中经常使用相同的结构）：

[http://www.json.org/](http://www.json.org/)

# iphone - -[__NSArrayM setTableViewStyle:]: 创建自定义 uitablevewcell 时出错

> ID：11874216
> 
> 赞同：0
> 
> 时间：2012-08-08T22:36:50.797
> 
> 标签：iphone, objective-c, ios5

我刚刚在表格视图中创建了一个自定义单元格，我在 UITableViewDelegate 方法中调用了自定义单元格

```
--(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

这就是我的代码的样子：

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{

        static NSString *cellId = @"cellIdetifier";
        static NSString *cellId2 = @"cellId2";

        tableCell *customCell = [tableView dequeueReusableCellWithIdentifier:cellId2];
        if(customCell == nil){

            NSArray *customObjects = [[NSBundle mainBundle]loadNibNamed:@"tableCell" owner:self options:nil];
            for(id obj in customObjects){

                if([obj isKindOfClass:[tableCell class]]){

                    customCell = (tableCell *)customObjects;
                    break;
                }

            }

        }

        return customCell;

} 
```

我收到一个错误，上面写着

```
 creatingcustomcell[693:f803] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSArrayM setTableViewStyle:]: unrecognized selector sent to instance 0x6d6c7f0' 
```

请帮助我，我不知道刚刚发生了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:50:14.997

很难从这段代码中看出你的强制是否符合要求：

```
 customCell = (tableCell *)customObjects; 
```

是正确的。至少强制数组看起来很奇怪：

```
NSArray *customObjects = [[NSBundle mainBundle]loadNibNamed:@"tableCell" owner:self options:nil]; 
```

给你的`tableCell`

你的意思是：

```
 customCell = (tableCell *)obj; 
```

此外，您可能希望遵循类名应大写的建议

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:45:45.733

```
 if([obj isKindOfClass:[tableCell class]]){
      customCell = (tableCell *)customObjects;
      break;
 } 
```

您正在将单元格设置为整个数组

改为这样做

```
 for (int i=0; i < customObjects.count; i++) {

     if([customObjects objectAtIndex:i] isKindOfClass:[tableCell class]]){

          customCell = (tableCell *)[customObjects objectAtIndex:i];
          break;
     }
} 
```

# image - 使用cli查找所有像素的平均值

> ID：11874217
> 
> 赞同：2
> 
> 时间：2012-08-08T22:36:52.837
> 
> 标签：image, imagemagick

有没有一种获取图像中所有像素平均值的cli方法

例如 - 如果我有一个全黑图像，我想输入：

```
   *cmd* black-img.jpg 

```

并且输出将`0`在外壳中

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T23:22:57.340

哦，这很简单：

```
convert  image.jpg  -scale 1x1\!  txt:- 
```

该命令使用 ImageMagick`convert`强制将输入图像缩放为 1x1 像素大小。对于 8 位 RGBA 图像，输出将是这样的：

```
# ImageMagick pixel enumeration: 1,1,255,srgba
0,0: (151,161,212, 92)  #97A1D45C  srgba(151,161,212,0.361928) 
```

或者对于 8 位 sRGB 图像：

```
# ImageMagick pixel enumeration: 1,1,255,srgb
0,0: (229,226,229)  #E5E2E5  srgb(229,226,229) 
```

它表示生成的单像素图​​像的颜色值：

*   `0,0:`是该像素的坐标：第一列中的第一行。
*   `(151,161,212, 92)`表示 RGBA 像素的 **R** ed、**G** reen、**B** lue 和 **A** lpha 值。
*   `(229,226,229)`表示 sRGB 像素的**R** ed、**G** reen 和 **B** lue 值。
*   `#97A1D45C`并且`#E5E2E5`是各自的十六进制值。

现在，如果它是一个黑色像素，则将这个输出计算为“*外壳中的**a`'0'`* ”是您自己的工作。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T07:35:01.847

好的，所以当原始海报询问*“获取图像中所有像素的平均值”*时，他似乎不想要 3 或 4 个*颜色*通道值......他想要一个可以通过转换图像得出的单一值先灰度化：

 *```
convert  image.jpg  -colorspace gray  -scale 1x1\!  txt:- 
```

与另一个答案相同的 8 位 RGBA（带 Alpha 通道）图像的示例输出：

```
# ImageMagick pixel enumeration: 1,1,255,graya
0,0: (119,119,119, 92)  #7777775C  graya(119,119,119,0.361928) 
```

之前的 8 位 sRGB 图像（无 Alpha 通道）的输出：

```
# ImageMagick pixel enumeration: 1,1,255,gray
0,0: (221,221,221)  #DDDDDD  gray(221,221,221) 
```*

# spring - 使用注解将属性注入spring bean

> ID：11874220
> 
> 赞同：2
> 
> 时间：2012-08-08T22:37:14.753
> 
> 标签：spring, spring-mvc

正如[这里](https://stackoverflow.com/questions/6630965/how-to-inject-string-property-in-a-spring-bean)和[这里](https://stackoverflow.com/questions/317687/inject-property-value-into-spring-bean)所解释的，如何做到这一点很清楚，但似乎仍然无法使其工作。我只是喜欢使用 @Value 注释来将属性注入到 spring bean。我用一个控制器和一个 bean 创建了一个基本的 spring MVC 项目。

这是我的应用程序上下文：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:mvc="http://www.springframework.org/schema/mvc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:util="http://www.springframework.org/schema/util" xmlns:beans="http://www.springframework.org/schema/beans"
    xsi:schemaLocation="
   http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.1.xsd
   http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd
   http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.1.xsd
   http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
   http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.1.xsd
   http://www.springframework.org/schema/oxm http://www.springframework.org/schema/oxm/spring-oxm-3.1.xsd">

<!-- Root Context: defines shared resources visible to all other web components -->

<context:component-scan base-package="me.co.fatsecret" />

<!-- Properties -->

<bean id="props"
    class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="classpath:fatProperties.properties" />
</bean>

</beans> 
```

我有一个名为 Configuration 的 bean：

```
package me.co.fatsecret;

import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

@Component
public class Configuration {

    /*--- Members ---*/

    @Value("${api_key}")
    protected String API_KEY;
    @Value("${api_secret}")
    protected String API_SECRET;
    @Value("${api_url}")
    protected String API_URL;

    /*--- Constructors ---*/

    public Configuration() {
    }

    /*--- Getters & Setters ---*/

    public String getAPI_KEY() {
    return API_KEY;
    }

    public void setAPI_KEY(String aPI_KEY) {
    API_KEY = aPI_KEY;
    }

    public String getAPI_SECRET() {
    return API_SECRET;
    }

    public void setAPI_SECRET(String aPI_SECRET) {
    API_SECRET = aPI_SECRET;
    }

    public String getAPI_URL() {
    return API_URL;
    }

    public void setAPI_URL(String aPI_URL) {
    API_URL = aPI_URL;
    }

} 
```

现在我只有一个控制器，注入了这个配置类，当我调用这个控制器时，我看到配置类中的值没有正确填充。

我的属性文件位于资源文件夹 (src/main/resources) 下，并且是我的类路径的一部分（默认情况下完成，因为这是一个 maven 项目）。这里是：

```
api_url=http://platform.fatsecret.com/js?
api_key=SomeKey
api_secret=SomeSecret 
```

文件名为 fatProperties.properties。当我在调用控制器时调试服务器时，我看到 Configuration 类的内容是：

```
${api_key}
${api_secret}
${api_url} 
```

这是字符串的实际值，这意味着属性文件中的值由于某种原因没有被注入。

我在这里错过了什么吗？

UPDATE1：我将 PropertyPlaceholderConfigurer bean 替换为：

```
<context:property-placeholder location="classpath:fatProperties.properties"/> 
```

得到相同的结果

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-10T17:40:09.370

好的，我知道了！

我正在使用一个 spring MVC 项目，这意味着我的 Web 层（控制器）有一个单独的上下文。使用 @Value 注释来隐藏属性的“配置”bean 被注入到控制器中。我的属性占位符是在我的根上下文中定义的，因此无法从我的控制器中看到它。为了解决这个问题，我只是将属性占位符定义添加到我的 DispatcherServlet 上下文中，它就像一个魅力:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-09T00:42:52.243

将此添加到您的应用程序上下文文件中：

```
<context:property-placeholder location="classpath:fatProperties.properties" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T22:42:32.533

尝试

```
@Value("#{props['api_key']}")
private String apiKey; 
```

# javascript - 如何在加载时运行操纵 iframe 内容的代码？

> ID：11874221
> 
> 赞同：0
> 
> 时间：2012-08-08T22:37:20.580
> 
> 标签：javascript, google-chrome, iframe, google-chrome-extension

我试图在加载时隐藏 Facebook like 按钮的计数值。它在 中运行`iframe`，如下所示：

```
<iframe src="//www.facebook.com/plugins/like.php?href='+'facebook.com'+'&amp;send=false&amp;layout=button_count&amp;width=90&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:90px; height:21px;margin:30px 0px 25px 0px;" allowTransparency="true"> </iframe> 
```

所以我尝试在 iframe 标签中插入一个 onload，例如：

```
onload="
function loadme() { 
    // pluginCountTextConnected is the like text count's classname
    var x = document.getElementsByClassName('pluginCountTextConnected');
    console.log(x); 
} 
loadme();
" 
```

但是代码返回一个空列表。我认为`document`在这种情况下，引用是指加载 iframe 的文档，而不是 iframe 文档。我如何将其指向 iframe 的内容？

小提琴：[这里](http://jsfiddle.net/forgetcolor/FHpuM/)

我应该补充一点，iframe 是从在 Facebook 上运行的内容脚本 Chrome 扩展加载的，这就是为什么我认为这可能不受同源策略的约束。

更新：为什么有人投票关闭？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:43:32.353

iframe 未托管在您的域上，因此您无法访问它，请查看[http://en.wikipedia.org/wiki/Same_origin_policy](http://en.wikipedia.org/wiki/Same_origin_policy)

# linux - 未定义的符号，即使有明确的链接

> ID：11874222
> 
> 赞同：0
> 
> 时间：2012-08-08T22:37:21.950
> 
> 标签：linux, linker, g++, shared-libraries, undefined-symbol

过去一天一直在处理链接器地狱，并想我会把它扔在那里，看看是否有人可以帮助我。

我正在构建两个共享库：一个称为“libhttp”，它具有一些用于 http 协议的帮助函数，似乎正在构建更好或更坏的 OK。第二个称为“libvpcutil”，它导致了问题。它取决于 libhttp 中的符号，因此我将其链接到 libhttp。这是编译指令（从 make 文件中分解出来的），其中包含一些小东西，比如我个人的 openssl 生成路径：

```
g++ -shared -Wl,-soname,libvpcutil.so.1 -o libvpcutil.so.1.0  vpcreg/registry.o \
vpcreg/vpcreg2.o  dbase/dbase.o dbase/sqlutils.o  diaglog/diaglog.o  errmsg/errmsg.o  \
faillib/faillib.o  failover/failover.o  initerr/init_err.o  kmq/kmq.o kmq/publish.o  \
kthread/kcom.o kthread/kthread.o  libobdi/odi_serv.o  mutex/mutex.o  netserv/netserv.o  \
newmem/newmem.o  rmtstore/avlmem.o rmtstore/rmtstore.o rmtstore/shm_aloc.o  \
servhand/servhand.o  timers/timers.o  vpcstamp/vpcstamp.o  websql/websql.o  types/blob.o \
types/hitime.o types/ticks.o types/timestamp.o  odasm/odasm.o  webvibapi/webvibapi.o  \
vibusfeed/vibusfeed.o  propstore/propstore2.o  cardlib/cardlib.o cardlib/sortlist.o  \
gapi/genapi.o -L/usr/lib/i386-linux-gnu -lm -lrt -lxml2 -lodbc -L/usr/lib/i386-linux-gnu -\
lcurl -Wl,-Bsymbolic-functions -Wl,-z,relro \
-L/pathtoopenssl/openssl -lssl -lcrypto  -lxml2   -lreadline -\
lcurses -Wl,-rpath=.:/pathtobin/bin http/libhttp.so.1.0 ../ddldata/ddldata.o 
../cardddl/cardddl.o ../gendata/generic.o 
```

编译和链接成功完成。希望您注意到 http/libhttp.so.1.0 的链接步骤。

现在，如果我在 libhttp.so.1.0 上执行 nm，我会得到以下输出（以及其他输出）：

```
00015d5a T _ZN12http_cookiesC1Ev
00015d5a T _ZN12http_cookiesC2Ev
00015d7e T _ZN12http_cookiesD1Ev
00015d7e T _ZN12http_cookiesD2Ev
00011574 T _ZN12http_headers11url_expressERSo
00011466 T _ZN12http_headers12http_expressERSo 
```

但是当我在 libvpcutil.so.1.0 上做一个 nm 时，我基本上得到：

```
 U _ZN12http_cookiesC1Ev
     U _ZN12http_cookiesD1Ev
     U _ZN12http_headers11url_expressERSo
     U _ZN12http_headers3setEPKcRKSs
     U _ZN12http_headers3setEPKcS1_
     U _ZN12http_headersC1Ev
     U _ZN12http_headersD1Ev 
```

我显然在这里剪断了，但我被困在这里的是符号在 libhttp 中明确定义，我为 libvpcutil 链接它，但随后符号在 libvpcutil 中未定义。这会产生运行时错误。

有人看到这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T07:59:34.883

这看起来像预期的行为。

链接到共享库不像链接到静态库，所需的符号不会被复制到输出文件中，您只需获得对仍必须在运行时解析的符号的引用。所以符号显示为 是正常`U`的`nm`。

什么是运行时错误？这可能意味着`libhttp.so.1.0`在运行时找不到该库。您应该能够在可执行文件上运行`ldd`并`libvpcutil.so`查看它们是否依赖`libhttp.so.1.0`以及它们是否找到了正确的。

`libhttp.so.1.0`有soname设置吗？如果它与文件名不同，您是否有与 soname 同名的符号链接？（例如，如果 soname 是`libhttp.so.1`您将需要一个 symlink `libhttp.so.1 -> libhttp.so.1.0`）。我还看到您`libhttp.so.1.0`位于一个名为`http`但不在您的 RPATH 中的目录中，因此在运行时找不到。

# sql-server-2008 - 如何按表 B 中的日期对表 A 中的 SQL Server 行进行分组

> ID：11874231
> 
> 赞同：1
> 
> 时间：2012-08-08T22:38:34.360
> 
> 标签：sql-server-2008

这在理论上很简单，但对我来说很难弄清楚。

我有两个 SQL Server 表：

1.  带有购买日期和总额的购买清单

    ```
    select total, date from purchases 
    ```

2.  为特定工作和旅行日期旅行的里程列表

    ```
    select travelDate, miles from trips 
    ```

**编辑：**为了保持对我的问题的回答/讨论，我重新表述了这个要求。

我需要计算每次购买之间的总里程数。

我想要比总体平均值更高的准确性。

我可以通过将每个日期`trips`之间的所有里程相加来手动获取此信息。`purchases`现在，我只想自动化这个过程。

分组应该使得所有`trips`大于`purchases`日期 A 和小于`purchases`日期 B 的日期都是`purchases`日期 A 组的一部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:35:21.243

治愈我的密度，我认为您的要求是非常合理的，将问题视为“更换燃料成本” - 因此使用*下一次加油*的燃料成本而不是之前购买实际使用的燃料的成本（这真的很复杂，真的快速地）。然后音量无关紧要。试穿这个尺寸。

```
SELECT
   T.*,
   P.*, -- from previous purchase
   N.*, -- from next purchase (NULL if none yet)
   TripCost = N.Total * T.Miles / M.MilesThisFill
FROM
   dbo.Trips T
   CROSS APPLY (
      SELECT TOP 1 *
      FROM dbo.Purchases P
      WHERE P.[Date] < T.travelDate
      ORDER BY P.[Date] DESC
   ) P
   CROSS APPLY (
      SELECT TOP 1 *
      FROM dbo.Purchases P
      WHERE P.[Date] > T.travelDate
      ORDER BY P.[Date]
   ) N
   CROSS APPLY (
      SELECT Sum(miles) MilesThisFill
      FROM dbo.Trips T2
      WHERE
         T2.[Date] > P.[Date]
         AND T2.[Date] < N.[Date]
   ) M; 
```

或者这里有一个版本对问题有非常不同的看法，但应该给出相同的结果。让我知道哪个表现更好，好吗？( `SET STATISTICS IO ON; SET STATISTICS TIME ON;`)

```
WITH PSeq AS (
   SELECT
      Seq = Row_Number() OVER (ORDER BY [Date]),
      *
   FROM dbo.Purchases
), Slices AS (
   SELECT
      FromDate = P.[Date],
      ToDate = N.[Date],
      N.Total
   FROM
      PSeq P
      INNER JOIN PSeq N
         ON P.Seq + 1 = N.Seq
), TotalMiles AS (
    SELECT
       S.FromDate,
       Sum(T.Miles) MilesThisFill
    FROM
      Slices S
      INNER JOIN dbo.Trips T
         ON T.travelDate BETWEEN S.FromDate AND S.ToDate
    GROUP BY
       S.FromDate 
)
SELECT
   T.travelDate,
   S.FromDate,
   S.ToDate,
   TripCost = S.Total * T.Miles / M.MilesThisFill
FROM
   Slices S
   INNER JOIN dbo.Trips T
      ON T.travelDate BETWEEN S.FromDate AND S.ToDate 
   INNER JOIN dbo.TotalMiles M
      ON S.FromDate = L.FromDate; 
```

对于任何拼写错误或错误，我提前道歉......我没有测试过代码。

只是为了笑，这是第一个被变形为可以在 SQL Server 2000 上运行的版本的查询！

```
SELECT
   T.travelDate,
   T.Miles,
   T.ToDate,
   TripCost = P.Total * T.Miles / M.MilesThisFill
FROM
   (
      SELECT
         T.travelDate,
         T.Miles,
         ToDate = (
            SELECT TOP 1 P.Date
            FROM dbo.Purchases P
            WHERE P.[Date] > T.travelDate
            ORDER BY P.[Date]
         )
      FROM
         dbo.Trips T
   ) T
   INNER JOIN (
      SELECT
         ToDate = (
            SELECT TOP 1 P.Date
            FROM dbo.Purchases P
            WHERE P.[Date] > T2.travelDate
            ORDER BY P.[Date]
         ),
         MilesThisFill = Sum(T2.Miles)
      FROM dbo.Trips T2
      GROUP BY
         (
            SELECT TOP 1 P.Date
            FROM dbo.Purchases P
            WHERE P.[Date] > T2.travelDate
            ORDER BY P.[Date]
         )
   ) M ON T.ToDate = M.ToDate
   INNER JOIN dbo.Purchases P
      ON T.ToDate = P.[Date]; 
```

这实际上表明我可能不需要在我的第一个查询中查找之前的购买日期，如果我做得对的话......所以这是一个最终版本：

```
WITH TripData AS (
   SELECT
      T.Miles,
      T.travelDate,
      ToDate = (
         SELECT TOP 1 P.[Date]
         FROM dbo.Purchases P
         WHERE P.[Date] > T.travelDate
         ORDER BY P.[Date]
      )
   FROM
      dbo.Trips T
)
SELECT
   T.*,
   P.*,
   TripCost = P.Total * T.Miles / M.MilesThisFill
FROM
   TripData T
   INNER JOIN dbo.Purchases P
      ON T.ToDate = P.[Date]
   INNER JOIN (
      SELECT
         T2.ToDate,
         Sum(T2.Miles) MilesThisFill
      FROM TripData T2
      GROUP BY
         T2.ToDate
   ) M ON T.ToDate = M.ToDate; 
```

注意： TripCost 表达式的顺序很重要，因为 Miles 和 TotalMiles 是整数。如果你把 P.Total 放在最后，你会得到错误的答案，因为 Miles / TotalMiles 将被转换为整数。

# regex - \w 和 \b 正则表达式元字符之间的区别

> ID：11874234
> 
> 赞同：153
> 
> 时间：2012-08-08T22:38:56.033
> 
> 标签：regex

谁能解释正则表达式元字符`\b`和`\w`正则表达式元字符之间的区别？据我了解，这两个元字符都用于单词边界。除此之外，哪个元字符对多语言内容有效？

* * *

## 回答 #1

> 赞同：280
> 
> 时间：2012-08-08T23:50:42.540

元字符`\b`是类似于插入符号和美元符号的锚。它匹配一个称为**“单词边界”**的位置。这个匹配是零长度的。

有资格作为单词边界的三个不同位置：

*   在字符串的第一个字符之前，如果第一个字符是单词字符。
*   在字符串的最后一个字符之后，如果最后一个字符是单词字符。
*   在字符串中的两个字符之间，其中一个是单词字符，另一个不是单词字符。

简单地说：**允许**`\b`您使用. “**单词字符”**是可用于构成单词的字符。所有不是**“单词字符”**的字符都是**“非单词字符”**。**`\bword\b`**

 ******在所有风格中，字符`[a-zA-Z0-9_]`都是单词字符。这些也与速记字符类匹配`\w`。在风味比较中为单词边界显示**“ascii”**的风味仅将这些识别为单词字符。

`\w`代表**“单词字符”**，通常是`[A-Za-z0-9_]`. 注意包含下划线和数字。

`\B`是 的否定版本`\b`。在不`\B`匹配的每个位置匹配。`\b`实际上，`\B`匹配两个单词字符之间的任何位置以及两个非单词字符之间的任何位置。

`\W`是 的缩写`[^\w]`，否定的版本`\w`。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-08-08T22:42:44.777

`\w`匹配一个单词字符。`\b`是一个零宽度匹配，它匹配一侧有单词字符的位置字符，而另一侧不是单词字符的位置字符。（不是单词字符的示例包括空格、字符串的开头和结尾等）

`\w`匹配`a`、`b`、`c`、`d`、`e`和`f`in`"abc def"`
`\b`匹配（零宽度）位置 before `a`、 after `c`、 before`d`和 after `f`in`"abc def"`

见：[http ://www.regular-expressions.info/reference.html/](http://www.regular-expressions.info/reference.html/)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-08-08T23:19:06.813

@Mahender，您可能是指`\W`（而不是`\w`）和`\b`. 如果不是，那么我同意上面的@BoltClock 和@jwismar。否则继续阅读。

`\W`将匹配任何非单词字符，因此很容易尝试使用它来匹配单词边界。问题是它与行的开头或结尾不匹配。`\b`更适合匹配单词边界，因为它也会匹配行的开头或结尾。粗略地说（有经验的用户可以在这里指正）`\b`可以认为是`(\W|^|$)`. [编辑：正如@Ωmega 下面提到的，`\b`是一个零长度匹配，所以`(\W|^|$)`不是严格正确的，但希望有助于解释差异]

快速示例：对于字符串`Hello World`，`.+\W`将匹配`Hello_`（与空格）但不会匹配`World`。`.+\b`将匹配`Hello`和`World`。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-12-19T04:22:41.900

```
\b <= this is a word boundary. 
```

匹配后面有单词字符但前面没有单词字符的位置，或者前面有单词字符但后面没有单词字符的位置。

```
\w <= stands for "word character". 
```

它总是匹配 ASCII 字符 [A-Za-z0-9_]

你有什么特别想匹配的吗？

一些对初学者有用的正则表达式网站，或者只是为了满足你的胃口。

*   [http://www.regular-expressions.info](http://www.regular-expressions.info)
*   [http://www.javascriptkit.com/javatutors/redev2.shtml](http://www.javascriptkit.com/javatutors/redev2.shtml)
*   [http://www.virtuosimedia.com/dev/php/37-tested-php-perl-and-javascript-regular-expressions](http://www.virtuosimedia.com/dev/php/37-tested-php-perl-and-javascript-regular-expressions)
*   [http://www.i-programmer.info/programming/javascript/4862-master-javascript-regular-expressions.html](http://www.i-programmer.info/programming/javascript/4862-master-javascript-regular-expressions.html)

我发现这是一本非常有用的书：

*   [Jeffrey EF Friedl 掌握正则表达式](https://rads.stackoverflow.com/amzn/click/com/0596528124)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-12-19T04:20:18.793

`\w`不是单词边界，它匹配*任何*单词字符，包括下划线：`[a-zA-Z0-9_]`. `\b` *是*单词边界，即匹配单词和非字母数字字符之间的位置：`\W`或`[^\w]`.

但是，这些实现可能因语言而异。******

# vba - 限制访问和突出显示 Microsoft Access 中的选项卡

> ID：11874236
> 
> 赞同：0
> 
> 时间：2012-08-08T22:39:11.023
> 
> 标签：vba, ms-access, vbscript, ms-office, office-2010

我正在处理一个带有 3 个选项卡的表单，我想做的是限制对其他选项卡的访问，直到用户在选项卡页 1 上提供信息，或者在用户在选项卡页 1 上提供正确信息之前使其他选项卡不可见。我是新来的在 MS Access 中构建表单。我该如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T13:11:57.503

可以引用选项卡控件的页面，也可以通过名称引用选项卡控件上的控件：

```
Me.Page24.Visible = (Not IsNull(Me.ID)) 
```

无需引用页面即可引用该页面上的控件。

# php - php 向内部数组的特定项目注入值

> ID：11874239
> 
> 赞同：0
> 
> 时间：2012-08-08T22:39:28.823
> 
> 标签：php, arrays, array-push

我想将值插入到数组的内部数组特定项中。

所以我有一个数组，它在函数之间丢失数据，我找不到应该在何时何地打印出一些值，但我可以从一个对象中获取这些值，我想将对象的项目注入到数组的内部数组 [value] 项。在对象中，我的名称与数组中的名称相同。

对象看起来像这样

```
Userinfos Object
(
    [address_type] => BT
    [address_type_name] => 
    [company] => 
    [title] => 
    [last_name] => Last Name
    [first_name] => First Name
    [middle_name] => 
    [phone_1] => 1234567
    [phone_2] => 
    [fax] => 
    [address_1] => Street address
    [address_2] => 
    [city] => City
    [virtuemart_state_id] => 0
    [virtuemart_country_id] => 97
    [zip] => 1234
    [agreed] => 0
    [created_on] => 0000-00-00 00:00:00
    [created_by] => 0
    [modified_on] => 2012-08-08 22:04:36
    [modified_by] => 853
    [email] => webmaster@universumpoker.com
    [username] => webmaster@universumpoker.com
) 
```

数组看起来像这样

```
Array
(
    [email] => Array
        (
            [name] => email
            [value] => 
            [title] => E-Mail
            [type] => emailaddress
            [required] => 1
            [hidden] => 
            [formcode] => <input type="text" maxlength="100" class="required" value="" size="30" name="email" id="email_field"> 
        )

    [last_name] => Array
        (
            [name] => last_name
            [value] => 
            [title] => Last Name
            [type] => text
            [required] => 1
            [hidden] => 
            [formcode] => <input type="text" maxlength="32" class="required" value="" size="30" name="last_name" id="last_name_field"> 
        )

    [first_name] => Array
        (
            [name] => first_name
            [value] => 
            [title] => First Name
            [type] => text
            [required] => 1
            [hidden] => 
            [formcode] => <input type="text" maxlength="32" class="required" value="" size="30" name="first_name" id="first_name_field"> 
        )
) 
```

正如您在此数组中看到的，[value] 为空，而在 [formcode] 中，输入的值也为空。

那么有没有办法将对象的值推送到数组中。我正在研究 array_push 但无法弄清楚目标 [value]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:54:04.260

你能不能像这样简单地设置值：

```
$array->first_name[$index]->value = $userinfos->first_name 
```

围绕您的所有用户信息循环？

# cuda - 从 for 循环内部调用 CUDA 内核

> ID：11874244
> 
> 赞同：5
> 
> 时间：2012-08-08T22:39:39.420
> 
> 标签：cuda

我有一个从 for 循环中调用的 CUDA 内核。就像是

```
for(i=0; i<10; i++) {
   myKernel<<<1000,256>>>(A,i);
} 
```

现在假设我有一张带有 15 个流多处理器 (SM) 的 NVIDIA 卡。为简单起见，还假设只有一个块可以映射到 SM，这基本上是说大多数时候，我将在设备上执行 15 个块。由于内核执行是异步的，基本上 i=1 的调用将在第一个内核启动后排队执行（i=0 的那个）。

我的问题是：在执行第一个内核（i=0）时，只有 14 个 SM 忙，然后只有 13 个，然后只有 12 个，然后只有 11 个，等等。

是否会在一个 SM 可用时立即发送 i=1 的内核在设备上执行，或者第二个内核的启动会等到所有 SM 完成处理第一个内核（i=0 的那个）？

还假设我在一个 CUDA 流中工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:20:43.623

同一流中的内核启动被序列化。给定足够的资源（SM、共享内存等），来自不同流的内核调用可能会重叠

# php - 填充一行其余部分的下拉菜单

> ID：11874249
> 
> 赞同：1
> 
> 时间：2012-08-08T22:40:11.323
> 
> 标签：php, html, ajax, drop-down-menu

让我再试一次，所以我希望我的下拉菜单与它提取的数据位于同一行中。然后可以根据需要添加更多行。

所以本质上我想选择一个项目，它在同一行显示项目的属性。然后单击按钮添加更多行。

该表如下所示：

[例子](http://imgur.com/UwWj3)

这是我到目前为止所拥有的：

HTML：

```
 <div id='main'>
              <!--Dropdown Will not work inside of table-->
         <select id='ddName' onchange="showUser(this.value)"> 
                <option id='none'>Select a Food:</option>
                <?php $sql = new Mysql(); $sql->diary(); ?>
                </select>
         <input type='button' id='addRows' value='Add Rows'/> 
        <table id="diary">
        <thead>
            <tr>
                <th scope="cols">Check</th>
                <th scope="cols">Name</th>
                <th scope="cols">Units</th>
                <th scope="cols">Amounts</th>
                <th scope="cols">Calories</th>
                <th scope="cols">Sugars</th>
            </tr>
            </thead>
            <tbody>
               <tr id='txtHint'></tr>
            </tbody>
            </table>
    </div> 
```

用于下拉列表的 Ajax：

```
//Retrived from w3schools.com
function showUser(str)
    {
    if (str=="")
      {
      document.getElementById("txtHint").innerHTML="";
      return;
      } 
    if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
      }
    else
      {// code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
      }
    xmlhttp.onreadystatechange=function()
      {
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
        document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
        }
      }
    xmlhttp.open("GET","classes/ajax.php?q="+str,true);
    xmlhttp.send();
    } 
```

用于填充表格的 PHP：

```
//Retrived from w3school.com 
$q=$_GET["q"];

require_once dirname(dirname(__FILE__)).'/includes/constants.php';

$con = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME) or 
                  die('There was a problem connecting to the database.');

$result = $con->query("SELECT * FROM ingredient WHERE name = '".$q."'");

while($row = $result->fetch_array())
 {
   echo "<td><input type='checkbox' /></td>";
   echo "<td>".$row['Name']."</td>";
   echo "<td>" . $row['Units'] . "</td>";
   echo "<td>" . $row['Amount'] . "</td>";
   echo "<td>" . $row['Calories'] . "</td>";
   echo "<td>" . $row['Sugar'] . "</td>";
   echo "</tr>";
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:27:08.300

我能够弄清楚我的问题。我将这两个 php 代码合并到这个中。

PHP修复：

```
$q=$_GET["q"];

require_once dirname(dirname(__FILE__)).'/includes/constants.php';

$con = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME) or 
                  die('There was a problem connecting to the database.');

$result = $con->query("SELECT * FROM ingredient WHERE Name = '".$q."'");
$dd     = $con->query("SELECT * FROM ingredient");

if($q == 'Select a Food:')
{
   echo "<td><input type='checkbox' /></td>";
   echo "<td><select id='ddName' onchange='showUser(this.value)'>";
   echo "<option id='none'>Select a Food:</option>";
   while($ddrow = $dd->fetch_assoc())
     {
       if($ddrow['Name'] != $q)
          {
            echo "<option value='".$ddrow['Name']."'>".$ddrow['Name']."</option>";
          }
       else
          {
            echo "<option value='".$ddrow['Name']."' selected='selected'>".$ddrow['Name']."</option>";
          }
     }
   echo "</select></td>\n";
   echo "<td></td>";
   echo "<td></td>";
   echo "<td></td>";
   echo "<td></td>";
   echo "</tr>";
}

else{

 while($row = $result->fetch_array())
   {
    echo "<td><input type='checkbox' /></td>";
    echo "<td><select id='ddName' onchange='showUser(this.value)'>";
    echo "<option id='none'>Select a Food:</option>";
        while($ddrow = $dd->fetch_assoc())
     {
      if($ddrow['Name'] != $q)
      {
        echo "<option value='".$ddrow['Name']."'>".$ddrow['Name']."  </option>";
      }
      else
      {
          echo "<option value='".$ddrow['Name']."' selected='selected'>".$ddrow['Name']."</option>";
      }
    }
      echo "</select></td>\n";
      echo "<td>" . $row['Units'] . "</td>";
      echo "<td>" . $row['Amount'] . "</td>";
      echo "<td>" . $row['Calories'] . "</td>";
      echo "<td>" . $row['Sugar'] . "</td>";
      echo "</tr>";
    }
} 
```

# objective-c - 石英在路径中产生不透明度

> ID：11874253
> 
> 赞同：1
> 
> 时间：2012-08-08T22:40:32.517
> 
> 标签：objective-c, quartz-2d

当我将不透明度设置为 0.5 时，创建路径并在此路径的自交点上绘制它，不透明度与此路径的其他部分相同。有没有办法在其他情况下产生这种效果？例如，当我在它们的交叉点绘制 2 个相同颜色和不透明度的图像时，也会出现这种不透明度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T03:53:55.540

在将图像绘制到上下文之前，您可以通过更改混合模式来获得所需的效果。您可以使用`CGContextSetBlendMode`设置混合模式。[*您可以在CGContext Reference*](http://developer.apple.com/library/ios/DOCUMENTATION/GraphicsImaging/Reference/CGContext/Reference/reference.html#//apple_ref/c/tdef/CGBlendMode)中找到混合模式列表。我建议尝试`kCGBlendModeDarken`或`kCGBlendModeLighten`先。如果这些都不是你想要的，请尝试其他一些。

# eclipse - Eclipse - 使其使用环境变量指向 .classpath 中 sourcepath 属性中的本地 maven 存储库

> ID：11874255
> 
> 赞同：0
> 
> 时间：2012-08-08T22:40:44.043
> 
> 标签：eclipse, maven

Eclipse 的 Maven 插件正在我的本地 Maven 存储库中为我的项目引用的库之一查找相关源代码，并向我的文件添加一个`sourcepath`属性。`.classpath`

```
<classpathentry kind="lib" path="lib/core/guava-11.0.1.jar" sourcepath="Users/<my_user>/.m2/repository/com/google/guava/guava/11.0.1/guava-11.0.1-sources.jar">
    <attributes>
        <attribute name="javadoc_location" value="http://docs.guava-libraries.googlecode.com/git-history/v11.0.1/javadoc/"/>
    </attributes>
</classpathentry> 
```

问题是我无法提交该`.classpath`文件，因为它包含我本地 Maven 存储库的硬编码路径。有没有办法告诉 Eclipse 使用像 M2_HOME 这样的环境变量来输出它？即使它不是自动化的，是否有任何我可以放在那里的令牌可以让它在没有硬编码路径的情况下解析源的位置？我试过了：

```
sourcepath="$M2_HOME/com/google/guava/guava/11.0.1/guava-11.0.1-sources.jar" 
```

但是在我进行此更改后，Eclipse 无法解析此库的源位置。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T06:48:24.140

你说得对，提交 .classpath 或 .project 文件不是一个好主意。然而，m2e 以同样的方式增加了这个价值，其他用户的插件也是如此。如果需要，Maven 将在另一个用户的 PC 上下载所需的文件（即不在他们的本地 repo 中），并在`.classpath`文件中提供正确的源路径。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T22:14:13.417

我会将“guava-11.0.1.jar”添加到 maven 存储库中，然后将其作为依赖项添加到我的 pom.xml 中。通过这样做，您的 .classpath 文件中将不会有“classpathentry”标签。

之后，我将通过 m2eclipse 插件（Window->Maven 并检查“下载工件源”）打开源下载。以这种方式使用源不会添加任何 .classpath 文件条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T06:37:22.233

使用 maven 2，您可以`M2_REPO`在 Eclipse 中设置类路径变量，并将在您的文件`maven eclipse:eclipse`中自动使用它。`.classpath`详细信息可以在这里看到：[http ://www.mkyong.com/maven/how-to-configure-m2_repo-variable-in-eclipse-ide/](http://www.mkyong.com/maven/how-to-configure-m2_repo-variable-in-eclipse-ide/)

我们还没有迁移到 maven 3，所以我不确定，但我想这个变量需要`M3_REPO`为 maven 3 命名。

# parsing - 如何将用户友好的中缀数学代码转换为 Clojure 代码？

> ID：11874256
> 
> 赞同：7
> 
> 时间：2012-08-08T22:40:47.970
> 
> 标签：parsing, clojure, infix-notation

我希望用户能够像这样输入：

```
5+6*t+sin(2*t) 
```

，因此它将转换为：

```
(+ 5 (* 6 t) (sin (* 2 t))) 
```

，所以我可以将它评估为一些稍后将被 JITted 和有效执行的函数。

是否已经有可用的库（具有操作员优先级）可以在最新的 Clojure 中运行？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T23:01:53.543

Incanter 软件包包括一个[用于进行中缀数学的模块](http://data-sorcery.org/2010/05/14/infix-math/)

```
user> ($= 7 + 8 - 2 * 6 / 2)
9 
```

和其他人已经[写了包](https://github.com/tristan/clojure-infix)。

# c++ - 从文本文件输入，无法正确显示，为什么？

> ID：11874264
> 
> 赞同：0
> 
> 时间：2012-08-08T22:41:20.523
> 
> 标签：c++, visual-c++

这是我的主要内容的一部分：

```
int main() {
  Inventory Master;
  bool flag;

  Customer Bob("Bob", "CreditCard.txt");
  Customer Chris("Chris", "CreditCard.txt" ); 
} 
```

这是我的方法：

```
Customer::Customer( string n, string fileName ) {
  name = n;
  ifstream Credit;

  Credit.open(fileName.c_str(), ios::in);

  while( Credit.good() && !Credit.eof() ) {
    Credit >> card >> balance >> ws;
    cout << card <<"\t" << balance << endl;

  }

 CreditCard _CC( int card, double balance);
} 
```

这是我的“CreditCard.txt 文件：

```
12345  15.00
32564  20.00 
```

我希望信息显示的方式是将第 1 行“12345 15.00”分配给 Bob，将第 2 行分配给 Chris，如果我创建客户的新实例或对象，依此类推。然而，我目前实现它的方式是它不断将“12345 15.00 和 32564 20.00”分配给 Bob 和 Chris。如果有人能告诉我如何以某种方式指向文本文件的某些行，我将不胜感激，因此当我将它们添加到文本文件中时，将 Bob 分配到第 1 行，将 Chris 分配到第 2 行，并将更多客户分配到其他行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:48:52.343

istream.getline() [http://www.cplusplus.com/reference/iostream/istream/getline/](http://www.cplusplus.com/reference/iostream/istream/getline/)可能是你的答案。一次只读一行。

这里有一个小例子： [http ://www.cplusplus.com/forum/beginner/27799/](http://www.cplusplus.com/forum/beginner/27799/)

我的一个旧家庭作业中的一个小例子：

```
ifstream fin(fileName);
char buffer[256];

int count = 0;

if (fin.is_open())
{
    while (!fin.eof())
    {
        fin.getline(buffer, 256);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T02:33:11.330

你对 Bob 和 Chris 所做的一切都发生在构造函数中。因此，正如所写，您的代码说：当流处于良好状态并且它不是文件的结尾（关键点）时，请写入此处。

好吧，如果您考虑一下，这将一直读取到每个`Customer`. 那不是你想要的。我可能会建议将名称添加为每条记录的数据文件中的第一个字段。然后，您可以在文件中搜索正确的记录，假设您确保名称都是唯一定义的，然后逐个字符串地提取数据。这样它就不会每次都从头到尾阅读。我将“Bob”添加为第 1 行的第一个字段，将“Chris”添加到第 2 行并制作`string name = "Chris";`. 所以...

```
#include <string>
#include <iostream>
#include <fstream>
using namespace std;
int main()
{
  string tempStr;
  string name = "Chris";
  ifstream Credit;

  Credit.open("Info.txt", ios::in);

  while( Credit.good() && !Credit.eof() ) 
  {
      getline(Credit, tempStr, ' ');//Reads the first records name field
      cout << tempStr << endl;
      if(name.compare(tempStr) == 0)//Compares the "name" to the field.
      {                            //If true they are the same
          //Proceed to do reading and assignments with additional getline statements
          cout << "Chris was matched the second time around!";
          Credit.setstate(ios::eofbit, true);//***Sets eof to true
      }
      else 
      {
          Credit.ignore(50, '\n');
          //That should put Credit in the proper position to read the next name
      }
  } 
```

}

你这样做的方式会导致问题。唯一确定它起作用的方法是，如果您知道记录在文件中的位置。如果你有五张唱片呢？当你到达第三个时，你将不得不`ignore`或类似地，在你正在处理的那个之前的所有字段。此外，人类可以很方便地读取数据文件的打印件。为每条记录提供标签（名称）的另一个原因。另外，你显然是`using namespace std;`，所以我也这样做了，但它不受欢迎。

# javascript - 更改嵌入视频的 src 在 FF 中有效，但在 IE 或 Chrome 中无效

> ID：11874265
> 
> 赞同：0
> 
> 时间：2012-08-08T22:41:29.787
> 
> 标签：javascript, html, video, cross-browser, embed

当用户单击我的视频列表中的一个元素时，我想更改嵌入视频的来源。它在 FF 中运行良好，但在 IE 和 Chrome 中都没有任何反应。谁能告诉我如何让这个功能在所有浏览器中正常工作？
这是我的 JavaScript：

```
function updateSource(id)
{ 
    var video = document.getElementById('video');
    video.src=document.getElementById(id).getAttribute('data-value');
} 
```

这是我的 HTML：

```
<embed id="video" src="https://www.youtube-nocookie.com/v/h5NeJaWR5WA?version=3&amp;hl=en_US&amp;rel=0&showinfo=0"
            type="application/x-shockwave-flash" width="480" height="360"
            allowscriptaccess="never" allowfullscreen="true"></embed>

<li id="one" class="videoLink" style="margin-top: -1em;" onclick="updateSource(this.id)"
 data-value="https://www.youtube-nocookie.com/v/h5NeJaWR5WA?version=3&amp;hl=en_US&amp;rel=0&showinfo=0">
      <img class="youtubeThumb" src="http://img.youtube.com/vi/h5NeJaWR5WA/default.jpg" />
      <p class="videoTitle">Video Number One!</p>
</li>
<li id="two" class="videoLink" onclick="updateSource(this.id)"
 data-value="http://www.youtube-nocookie.com/v/r19okL-IW6Q?version=3&amp;hl=en_US&amp;rel=0&showinfo=0">
      <img class="youtubeThumb" src="http://img.youtube.com/vi/r19okL-IW6Q/default.jpg" />
      <p class="videoTitle">Video Number Two!</p>
</li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:06:54.483

解决方案：http: [//jsfiddle.net/tuDXg/4/](http://jsfiddle.net/tuDXg/4/)

我不相信该`embed`元素支持更新`src`属性。您应该将它包装在一个 div 中并将 div 更改为具有更新的 src`innerHTML`的新`embed`元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:51:41.767

实际上，看起来数字（id 值）确实是问题所在。它认为您将整数（不是字符串）作为索引（不是 id 值）传递。

# zend-framework - Zend 框架中的链接错误消息

> ID：11874267
> 
> 赞同：0
> 
> 时间：2012-08-08T22:41:34.887
> 
> 标签：zend-framework, zend-form, zend-form-element

似乎使用 addErrorMessage() 会覆盖所有其他验证错误。

例如，我创建了一个自定义电话元素。我还创建了一个自定义验证类来检查自定义业务规则。我希望它在不符合自定义业务规则时打印出来自 My_Validate_BusinessPhone 的错误消息。但它一直打印在 addErrorMessage() 中设置的消息。这是正常行为吗？有没有办法链接错误消息？

```
$phone = new My_Form_Element_Phone( 'phone' );   
$phone->setRequired( TRUE )
    ->setAttrib( 'id', 'phone' )
    ->addErrorMessage( 'Please provide a valid phone number' )
    ->addValidator( new My_Validate_BusinessPhone ); 
```

我提前谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T07:52:49.950

消息被覆盖，因为您将消息设置为表单元素而不是验证器。这就是它应该如何工作的：首先，获取您的表单元素。在您的情况下，只需使用它。其次，按名称获取验证器（我不知道这里如何准确地调用它，例如它可能是 'notEmpty'），第三，为该验证器添加您的消息。

```
$phone->getValidator('yourValidatorsName')->setMessage('Please provide a valid phone number'); 
```

我刚刚在自己的脚本中对此进行了测试，但我希望它应该可以工作;-)

# php - 如何在php中打印出两个数组连接它们

> ID：11874269
> 
> 赞同：0
> 
> 时间：2012-08-08T22:41:42.150
> 
> 标签：php, arrays, printing, echo

我的 php 中有两个要打印的数组。我希望将它们连接起来，但我不知道如何连接。$names 的数组打印，但描述数组“$desc”不打印。有什么办法可以同时打印吗？

```
 $query = "SELECT eName FROM Events";
            $query2 = "SELECT eDescription FROM Events";
            $result = mysql_query($query);
            $result2 = mysql_query($query2);
            $names = array();
            $desc = array();
            echo "hello there people!" . $query . " ".$result;
            for($i=0; $i<sizeof($result); $i++){
                echo $result[$i] ."\n" . $result2[$i];
            }
            while($entry = mysql_fetch_row($result)){
                $names[] = $entry[0];
            }
            while($entry2 = mysql_fetch_row($result2)){
                $desc[] = $entry2[0];
            }
            echo "Which Event would you like to see?<br>";
            $stop = count($names);
            //echo $stop . "\n";
            $i = 0;
            print_r($names);                
            print_r($desc);
            foreach($names as $value){
                    echo $value . " " . $desc[i] ."<br>";   
                                     $i++;              
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T22:44:37.963

为什么要执行两个查询以从同一源获取数据？

```
$sql = mysql_query("select `eName`, `eDescription` from `Events`");
while($row = mysql_fetch_assoc($sql)) {
    echo $row['eName']." ".$row['eDescription']."<br />";
} 
```

简单得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:44:48.823

试试这个：

```
 foreach($names as $key => $value){
                echo $value . " " . $desc[$key] ."<br />";                 
        } 
```

只要数组`$key`匹配，信息就会一起打印。

# java - Java 扫描仪更改字符串

> ID：11874272
> 
> 赞同：1
> 
> 时间：2012-08-08T22:42:03.877
> 
> 标签：java, file-io, java.util.scanner

我正在使用扫描仪从文本文件中读取一些基本文件。

前 5 个条目是这样的 -

```
 0 MR2Spyder
1 Tundra
3 Echo
3 Yaris
4 ScionxB
4 ScionxD 
```

我通常实例化扫描仪，然后执行此操作 -

```
String line = scanner.nextLine();
System.out.println(line); 
```

然后我得到这个输出 -

```
ÿþ0 M R 2 S p y d e r 
```

哪个对我没有意义- Scanner 类有问题吗？我应该使用 BufferedReader 吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T22:46:25.673

您的文件是使用 UTF-16 编码的...字符和标题之间的空格`ÿþ`表明了这一点——它是[*字节顺序标记*](http://en.wikipedia.org/wiki/Byte_order_mark)。见[这里](http://en.wikipedia.org/wiki/Byte_order_mark#UTF-16)：

> 如果 16 位单元使用 little-endian 顺序，则字节序列将`0xFF`后跟`0xFE`. 此序列在文本显示中显示为 ISO-8859-1 字符`ÿþ`，文本显示为 ISO-8859-1。

您必须[在构建`Scanner`](http://goo.gl/ZJdxX).

```
final Scanner scanner = new Scanner(file, "UTF-16"); 
```

# android - Android Nexus 7 Jelly Bean：s tartPreview/takePicture 调用 getCameraStereoMode 记录错误

> ID：11874273
> 
> 赞同：31
> 
> 时间：2012-08-08T22:42:10.857
> 
> 标签：android, android-ndk, android-camera, nvidia

我刚得到一个 Nexus 7，我正在尝试将一些代码移植到。以下行在运行 Ice Cream 的 Xoom 上没有问题：

```
mCamera.startPreview(); 
```

它在 Nexus 7 上也能正常工作，但会记录错误：

```
E/NvOmxCamera(  126): OMX_ERRORTYPE android::NvOmxCamera::getCameraStereoMode(NvxComponent*, NvOmxCameraUserStereoMode&): Error: invalid NVX mode 0.
E/NvOmxCamera(  126): OMX_ERRORTYPE android::NvOmxCamera::getCameraStereoModeAndCaptureInfo(NvxComponent*, NvOmxCameraUserStereoMode&, NVX_STEREOCAPTUREINFO&): getCameraStereoMode failed with 0x00000000 
```

这是一个问题，因为当我执行该行时，它还会每帧记录一次这些错误

```
mCamera.takePicture(null, null, null, pictureCallback); 
```

由于我每秒拍摄 10 帧，这让我很不安，所以我想修复这些错误。我已经浏览了所有来源（android sdk 和 ndk），并且上述错误的文本没有出现在任何地方。我从大量谷歌搜索中相信，这发生在 Nvidia 的 OpenMax 实现中，它似乎与参数“nv-stereo-mode”相关，该参数可能值为“left”、“right”或“stereo” （Nexus 7 只有一个摄像头，所以我不知道为什么它会关心立体摄像头模式，但无论如何）。我尝试将其设置为每个合法值，例如：

```
mParams = mCamera.getParameters();
mParams.set("nv-stereo-mode", "right");
mCamera.setParameters(mParams); 
```

但是，我的日志说：

```
E/NvOmxCameraSettingsParser(  126): Skipping non-standard parameter: nv-stereo-mode 
```

这似乎与源文件 nvomxcamerasettingsparser.cpp 有关，我在网络上的任何地方都找不到。我真的不知道从哪里开始，我已经搜索并搜索了我能想到的一切，所以任何帮助都会非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-24T06:30:35.230

> 试试下面的代码来解决你的问题。我希望它能正常工作。

```
import java.io.File;
import java.io.IOException;
import android.app.Activity;
import android.content.Intent;
import android.hardware.Camera;
import android.media.CamcorderProfile;
import android.media.MediaRecorder;
import android.os.Bundle;
import android.os.CountDownTimer;
import android.os.Environment;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class Record extends Activity implements SurfaceHolder.Callback,
    MediaRecorder.OnInfoListener {

Button myButton;
MediaRecorder mediaRecorder;
SurfaceHolder surfaceHolder;
boolean recording;
Camera camera;
int mCount;
TextView msg;
boolean rec = false;
String fileName = "DamageVideo.mp4";
CountDownTimer timer;

/** Called when the activity is first created. */
@SuppressWarnings("deprecation")
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    recording = false;

    mediaRecorder = new MediaRecorder(); 
    initMediaRecorder();

    setContentView(R.layout.record_view);

    SurfaceView myVideoView = (SurfaceView) findViewById(R.id.videoview);
    surfaceHolder = myVideoView.getHolder();
    surfaceHolder.addCallback(this);
    surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

    myButton = (Button) findViewById(R.id.mybutton);
    msg = (TextView) findViewById(R.id.txttimer);

    myButton.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            myButton.setVisibility(View.GONE);
            myButton.setClickable(false);
            try {
                if (recording) {
                    recording = false;

                    myButton.setClickable(true);
                    myButton.setVisibility(View.VISIBLE);

                    Intent intent = new Intent();

                    setResult(100, intent);
                    finish();
                    overridePendingTransition(R.anim.trans_right_in,
                            R.anim.trans_right_out);

                    mediaRecorder.stop();
                    mediaRecorder.release();

                    moveFile();
                } else {

                    recording = true;
                    camera.stopPreview();
                    camera.release();
                    // myButton.setVisibility(View.GONE);
                    timer.start();
                    // myButton.setClickable(false);
                    mediaRecorder.start();

                    new CountDownTimer(21000, 1000) {

                        public void onTick(long millisUntilFinished) {

                            msg.setText(+(22000 - (millisUntilFinished - 0))
                                    / 1000 + "/20");

                        }

                        public void onFinish() {
                            // msg.setText("10/10");
                        }
                    }.start();
                    myButton.setText("STOP");
                    // camera.release();

                }
            } catch (Exception e) {
                // TODO: handle exception
                e.printStackTrace();
            }
        }
    });

    timer = new CountDownTimer(1000, 1000) {

        public void onTick(long millisUntilFinished) {

        }

        public void onFinish() {
            myButton.setVisibility(View.VISIBLE);
            myButton.setClickable(true);
        }
    };

}

@Override
public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
    // TODO Auto-generated method stub

}

@Override
public void surfaceCreated(SurfaceHolder arg0) {
    // TODO Auto-generated method stub

    try {
        prepareMediaRecorder();
        camera = Camera.open();

        try {
            camera.setPreviewDisplay(surfaceHolder);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        camera.startPreview();
    } catch (Exception e) {
        // TODO: handle exception
    }
}

@Override
public void surfaceDestroyed(SurfaceHolder arg0) {
    // TODO Auto-generated method stub

}

private void initMediaRecorder() {
    mediaRecorder.setAudioSource(MediaRecorder.AudioSource.DEFAULT);
    mediaRecorder.setVideoSource(MediaRecorder.VideoSource.DEFAULT);
    CamcorderProfile camcorderProfile_HQ = CamcorderProfile
            .get(CamcorderProfile.QUALITY_HIGH);

    mediaRecorder.setProfile(camcorderProfile_HQ);
    // mediaRecorder.setVideoFrameRate(30);
    // File dir = Const.getFilePath();
    File dir = Environment.getExternalStorageDirectory();

    // String fname = "DamageVideo.mp4";

    mediaRecorder.setOutputFile(dir.getAbsolutePath() + "/" + fileName);
    mediaRecorder.setMaxDuration(20000); // Set max duration 60 sec.
    mediaRecorder.setOnInfoListener(this);
}

private void prepareMediaRecorder() {
    mediaRecorder.setPreviewDisplay(surfaceHolder.getSurface());
    try {

        mediaRecorder.prepare();
    } catch (IllegalStateException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

@Override
public void onInfo(MediaRecorder mr, int what, int extra) {
    // TODO Auto-generated method stub
    if (what == MediaRecorder.MEDIA_RECORDER_INFO_MAX_DURATION_REACHED) {

        // mr.stop();
        // mr.release();
        recording = false;

        mediaRecorder.stop();

        Intent intent = new Intent();

        setResult(100, intent);
        finish();
        overridePendingTransition(R.anim.trans_right_in,
                R.anim.trans_right_out);
        mediaRecorder.release();
        moveFile();
    }
}

@Override
public void onBackPressed() {

    super.onBackPressed();

    try {
        if (!recording) {
            File dir = Environment.getExternalStorageDirectory();
            File imgFile = new File(dir.getAbsolutePath(), fileName);
            if (imgFile.exists()) {
                imgFile.delete();
            }

            camera.stopPreview();
            camera.release();
        } else {
            mediaRecorder.stop();
            mediaRecorder.release();

            moveFile();
        }

        recording = false;

        Intent intent = new Intent();

        setResult(100, intent);
        finish();
        overridePendingTransition(R.anim.trans_right_in,
                R.anim.trans_right_out);
    } catch (Exception e) {
        // TODO: handle exception
    }

}

public void moveFile() {
    File temp = Environment.getExternalStorageDirectory();
    File from = new File(temp.getAbsolutePath(), fileName);

    File dir = Const.getFilePath(Record.this);
    File to = new File(dir.getAbsolutePath(), fileName);

    from.renameTo(to);
}

@Override
public void onResume() {
    super.onResume();

}
}

// xml file
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<SurfaceView
    android:id="@+id/videoview"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_weight="1" />

<Button
    android:id="@+id/mybutton"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_centerVertical="true"
    android:layout_marginRight="5dp"
    android:background="#55A5D8"
    android:padding="5dp"
    android:text="REC"
    android:textColor="#ffffff"
    android:textSize="20sp" />

<TextView
    android:id="@+id/txttimer"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:text=""
    android:textColor="#55A5D8"
    android:textSize="20sp"
    android:textStyle="bold" />

</RelativeLayout> 
```

# php - 发音算法

> ID：11874274
> 
> 赞同：5
> 
> 时间：2012-08-08T22:42:22.417
> 
> 标签：php, algorithm, function

我正在努力寻找/创建一种可以确定随机 5 个字母组合的发音的算法。

到目前为止，我发现的最接近的东西来自这个 3 岁的 StackOverflow 线程：

[测量一个单词的发音？](https://stackoverflow.com/questions/1186213/measure-the-pronounceability-of-a-word)

```
<?php
// Score: 1
echo pronounceability('namelet') . "\n";

// Score: 0.71428571428571
echo pronounceability('nameoic') . "\n";

function pronounceability($word) {
    static $vowels = array
        (
        'a',
        'e',
        'i',
        'o',
        'u',
        'y'
        );

    static $composites = array
        (
        'mm',
        'll',
        'th',
        'ing'
        );

    if (!is_string($word)) return false;

    // Remove non letters and put in lowercase
    $word = preg_replace('/[^a-z]/i', '', $word);
    $word = strtolower($word);

    // Special case
    if ($word == 'a') return 1;

    $len = strlen($word);

    // Let's not parse an empty string
    if ($len == 0) return 0;

    $score = 0;
    $pos = 0;

    while ($pos < $len) {
        // Check if is allowed composites
        foreach ($composites as $comp) {
                $complen = strlen($comp);

                if (($pos + $complen) < $len) {
                        $check = substr($word, $pos, $complen);

                        if ($check == $comp) {
                                $score += $complen;
                                $pos += $complen;
                                continue 2;
                        }
                }
        }

        // Is it a vowel? If so, check if previous wasn't a vowel too.
        if (in_array($word[$pos], $vowels)) {
                if (($pos - 1) >= 0 && !in_array($word[$pos - 1], $vowels)) {
                        $score += 1;
                        $pos += 1;
                        continue;
                }
        } else { // Not a vowel, check if next one is, or if is end of word
                if (($pos + 1) < $len && in_array($word[$pos + 1], $vowels)) {
                        $score += 2;
                        $pos += 2;
                        continue;
                } elseif (($pos + 1) == $len) {
                        $score += 1;
                        break;
                }
        }

        $pos += 1;
    }

    return $score / $len;
}
?> 
```

...但它远非完美，给出了一些相当奇怪的误报：

使用此功能，以下所有比率都可发音，（7/10 以上）

*   中泰达
*   LLFDA
*   MMGDA
*   THHDA
*   RTHDA
*   XYHDA
*   维启达

比我更聪明的人可以用这个算法来解决这个问题：

*   'MM'、'LL' 和 'TH' 仅在元音之后或之前才有效？
*   连续 3 个或更多的辅音是禁止的，（除非第一个或最后一个是“R”或“L”）
*   您能想到的任何其他改进...

*（我已经进行了大量的研究/谷歌搜索，这似乎是过去 3 年每个人都在参考/使用的主要发音功能，所以我相信更新的、更精致的版本会受到更广泛的社区，不仅仅是我！）。*

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-09T07:04:14.247

基于对“在字母上使用马尔可夫模型”的链接问题的建议

> 使用马尔可夫模型（当然是字母，而不是单词）。单词的概率是发音容易程度的一个很好的代表。

我想我会尝试一下并取得一些成功。

# 我的方法论

我将一个真正的 5 个字母单词列表复制到一个文件中作为我的数据集（[这里](http://homepage.ntlworld.com/adam.bozon/Scrabble5.htm)...嗯，实际上是[这里](http://www.becomeawordgameexpert.com/wordlists5.htm)）。

然后我使用隐马尔可夫模型（基于 One-gram、Bi-gram 和 Tri-gram）来预测目标词在该数据集中出现的可能性。

（将某种音标作为步骤之一可以获得更好的结果。）

首先，我计算数据集中字符序列的概率。

例如，如果“A”出现 50 次，而数据集中只有 250 个字符，则“A”的概率为 50/250 或 0.2。

对二元组 'AB', 'AC', ... 做同样的事情

对三元组 'ABC'、'ABD'、... 执行相同操作

基本上，我对“ABCDE”这个词的评分由以下组成：

*   概率（'A'）
*   概率（'B'）
*   概率（'C'）
*   概率（'D'）
*   探测' ）
*   概率（'AB'）
*   概率（'BC'）
*   概率（'CD'）
*   概率（'DE'）
*   概率（'ABC'）
*   概率（'BCD'）
*   概率（'CDE'）

您可以将所有这些相乘以获得目标单词出现在数据集中的估计概率（但这非常小）。

因此，我们取每个日志并将它们加在一起。

现在我们有了一个分数，可以估计我们的目标词出现在数据集中的可能性。

# 我的代码

我已经编码这是 C#，并且发现大于负 160 的分数非常好。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;

namespace Pronouncability
{

class Program
{
    public static char[] alphabet = new char[]{ 'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z' };

    public static List<string> wordList = loadWordList(); //Dataset of 5-letter words

    public static Random rand = new Random();

    public const double SCORE_LIMIT = -160.00;

    /// <summary>
    /// Generates random words, until 100 of them are better than
    /// the SCORE_LIMIT based on a statistical score. 
    /// </summary>
    public static void Main(string[] args)
    {
        Dictionary<Tuple<char, char, char>, int> trigramCounts = new Dictionary<Tuple<char, char, char>, int>();

        Dictionary<Tuple<char, char>, int> bigramCounts = new Dictionary<Tuple<char, char>, int>();

        Dictionary<char, int> onegramCounts = new Dictionary<char, int>();

        calculateProbabilities(onegramCounts, bigramCounts, trigramCounts);

        double totalTrigrams = (double)trigramCounts.Values.Sum();
        double totalBigrams = (double)bigramCounts.Values.Sum();
        double totalOnegrams = (double)onegramCounts.Values.Sum();

        SortedList<double, string> randomWordsScores = new SortedList<double, string>();

        while( randomWordsScores.Count < 100 )
        {
            string randStr = getRandomWord();

            if (!randomWordsScores.ContainsValue(randStr))
            {
                double score = getLikelyhood(randStr,trigramCounts, bigramCounts, onegramCounts, totalTrigrams, totalBigrams, totalOnegrams);

                if (score > SCORE_LIMIT)
                {
                    randomWordsScores.Add(score, randStr);
                }
            }
        }

        //Right now randomWordsScores contains 100 random words which have 
        //a better score than the SCORE_LIMIT, sorted from worst to best.
    }

    /// <summary>
    /// Generates a random 5-letter word
    /// </summary>
    public static string getRandomWord()
    {
        char c0 = (char)rand.Next(65, 90);
        char c1 = (char)rand.Next(65, 90);
        char c2 = (char)rand.Next(65, 90);
        char c3 = (char)rand.Next(65, 90);
        char c4 = (char)rand.Next(65, 90);

        return "" + c0 + c1 + c2 + c3 + c4;
    }

    /// <summary>
    /// Returns a score for how likely a given word is, based on given trigrams, bigrams, and one-grams
    /// </summary>
    public static double getLikelyhood(string wordToScore, Dictionary<Tuple<char, char,char>, int> trigramCounts, Dictionary<Tuple<char, char>, int> bigramCounts, Dictionary<char, int> onegramCounts, double totalTrigrams, double totalBigrams, double totalOnegrams)
    {
        wordToScore = wordToScore.ToUpper();

        char[] letters = wordToScore.ToCharArray();

        Tuple<char, char>[] bigrams = new Tuple<char, char>[]{ 

            new Tuple<char,char>( wordToScore[0], wordToScore[1] ),
            new Tuple<char,char>( wordToScore[1], wordToScore[2] ),
            new Tuple<char,char>( wordToScore[2], wordToScore[3] ),
            new Tuple<char,char>( wordToScore[3], wordToScore[4] )

        };

        Tuple<char, char, char>[] trigrams = new Tuple<char, char, char>[]{ 

            new Tuple<char,char,char>( wordToScore[0], wordToScore[1], wordToScore[2] ),
            new Tuple<char,char,char>( wordToScore[1], wordToScore[2], wordToScore[3] ),
            new Tuple<char,char,char>( wordToScore[2], wordToScore[3], wordToScore[4] ),

        };

        double score = 0;

        foreach (char c in letters)
        {
            score += Math.Log((((double)onegramCounts[c]) / totalOnegrams));
        }

        foreach (Tuple<char, char> pair in bigrams)
        {
            score += Math.Log((((double)bigramCounts[pair]) / totalBigrams));
        }

        foreach (Tuple<char, char, char> trio in trigrams)
        {
            score += 5.0*Math.Log((((double)trigramCounts[trio]) / totalTrigrams));
        }

        return score;
    }

    /// <summary>
    /// Build the probability tables based on the dataset (WordList)
    /// </summary>
    public static void calculateProbabilities(Dictionary<char, int> onegramCounts, Dictionary<Tuple<char, char>, int> bigramCounts, Dictionary<Tuple<char, char, char>, int> trigramCounts)
    {
        foreach (char c1 in alphabet)
        {
            foreach (char c2 in alphabet)
            {
                foreach( char c3 in alphabet)
                {
                    trigramCounts[new Tuple<char, char, char>(c1, c2, c3)] = 1;
                }
            }
        }

        foreach( char c1 in alphabet)
        {
            foreach( char c2 in alphabet)
            {
                bigramCounts[ new Tuple<char,char>(c1,c2) ] = 1;
            }
        }

        foreach (char c1 in alphabet)
        {
            onegramCounts[c1] = 1;
        }

        foreach (string word in wordList)
        {
            for (int pos = 0; pos < 3; pos++)
            {
                trigramCounts[new Tuple<char, char, char>(word[pos], word[pos + 1], word[pos + 2])]++;
            }

            for (int pos = 0; pos < 4; pos++)
            {
                bigramCounts[new Tuple<char, char>(word[pos], word[pos + 1])]++;
            }

            for (int pos = 0; pos < 5; pos++)
            {
                onegramCounts[word[pos]]++;
            }
        }
    }

    /// <summary>
    /// Get the dataset (WordList) from file.
    /// </summary>
    public static List<string> loadWordList()
    {
        string filePath = "WordList.txt";

        string text = File.ReadAllText(filePath);

        List<string> result = text.Split(' ').ToList();

        return result;
    }
}

} 
```

在我的示例中，我将三元组概率缩放 5。

我还将所有计数加一，因此我们不会乘以零。

# 最后的笔记

我不是 php 程序员，但该技术很容易实现。

尝试一些缩放因子，尝试不同的数据集，或者添加一些其他检查，就像你上面建议的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-09T12:18:04.987

从一开始就生成一个合理发音的组合怎么样？我已经做了一些事情，我生成了一个随机的[Soundex](http://en.wikipedia.org/wiki/Soundex)代码，然后从它返回到一个（通常）可发音的原始代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-26T16:04:58.397

如果有人正在寻找使用节点执行此操作的方法，我发现了一个名为[pronouncable](https://github.com/lukem512/pronounceable)的模块，它似乎实现了 Xantix 的答案所描述的内容。

```
npm i pronounceable 
```

您[无需在 RunKit 上安装任何东西即可进行测试](https://npm.runkit.com/pronounceable)。

# php - 我需要什么邮件服务器来做我需要的事情？

> ID：11874275
> 
> 赞同：0
> 
> 时间：2012-08-08T22:42:25.253
> 
> 标签：php, apache, smtp, ubuntu-12.04, exchange-server-2007

好的，我正在运行 Ubuntu 12.4 64 位。

我正在开发一个基于 Web 的 PHP 应用程序，我需要使用 PHP 的`mail()`函数不时发送一封电子邮件。

我在可用于 SMTP 的同一网络上的 SBS2008 实例上安装了 Exchange Server 2007。

我想使用最简单的解决方案在 Ubuntu 服务器上安装 Apache 和 PHP，用于向 Exchange 服务器发送邮件。

你有什么建议？

# c# - 检查不同的空值

> ID：11874282
> 
> 赞同：2
> 
> 时间：2012-08-08T22:42:44.860
> 
> 标签：c#, silverlight, linq

我已经尝试了很多不同的方法来做到这一点，但每次我尝试这个时它都会抛出一个空引用异常。

我正在尝试过滤字段中的值以在该字段中列出唯一值。它适用于没有缺失值的字段，但是当我在我知道有空值的字段上使用它时，它会引发异常，所以我假设这是我应该过滤的内容。

我这样做的最初方法只是循环遍历值并检查唯一值列表是否包含该值，但这需要很长时间，我想利用 Linq 的力量

```
List<Graphic> ReturnedGraphics = e.FeatureSet.Features as List<Graphic>;

IEnumerable<string> ValueSet = (
                                 from g in e.FeatureSet.Features
                                 where !uniquevalues.Contains((g.Attributes[_selectedField] == null ? "blank" : g.Attributes[_selectedField].ToString()))
                                 select g.Attributes[_selectedField] == null ? "blank" : g.Attributes[_selectedField].ToString()
                               ) as IEnumerable<string>;

if (ValueSet.Any())
{
    uniquevalues.AddRange(ValueSet);
} 
```

我还应该补充一点，我在列表中添加范围的原因是因为有 5000 个值来自服务器，这些值对返回的值有限制，但是它适用于此并且不应该对我尝试的内容产生影响在这里做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T22:45:28.977

您不能`.ToString()`为空值。看起来你可能正在尝试。null 的候选人包括`lstbxFields.SelectedValue`,`g.Attributes[someVal]`

如何合理化您的代码，以便更容易捕获错误并且您不会到处重复自己？

```
var selVal = lstbxFields.SelectedValue;
if(selVal == null)
{
    //act on this
    return; //or throw
}
var selectedValue = selVal.ToString();

var query=
    e.FeatureSet.Features
        .Select(feature => feature.Attributes[selectedValue])
        .Select(attr => attr == null 
                        ? "blank" 
                        : attr.ToString())
        .Where(attrVal => !uniquevalues.Contains(attrVal)); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-08T22:57:37.140

您的数据模型几乎可以肯定是“错误的”，因为它非常容易出错且难以使用。您不应该将所有内容都转换为，`string`而是直接处理强类型对象。这样做可能会自动修复此错误，因为当您尝试 ToString 一个空值时很可能会引发 NullReferenceException。

处理类型化对象不仅更安全，而且速度更快，代码更短。

# html - Facebook 开放图调试问题

> ID：11874285
> 
> 赞同：0
> 
> 时间：2012-08-08T22:42:59.210
> 
> 标签：html, facebook, facebook-graph-api, facebook-opengraph

我在 Facebook OG 调试器中遇到了从未见过的关闭错误。

调试器：[https ://developers.facebook.com/tools/debug](https://developers.facebook.com/tools/debug)

我正在调试的网址：[http ://www.dalianceaccessories.com/](http://www.dallianceaccessories.com/)

我的 FB/OG 元标签：

```
<meta property="og:title" content="Dalliance Accessories" />
<meta property="og:description" content="Dalliance Accessories is proud to release our new collection with the launch of Dalliance 2.0! Drawing inspiration from all over the world, we are excited to present our new pieces featuring bold stones, neon chord, collars, bracelets and natural stone charged pieces. Striving for a eclectic take on accessories and accessorizing for an instant love affair!" /> 
<meta property="og:url" content="http://www.dallianceaccessories.com/" /> 
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Dalliance Accessories" />
<meta property="og:image" content="http://www.dallianceaccessories.com/skin/frontend/default/blanco/images/dalliance-logo.png">
<meta property="og:image" content="http://www.dallianceaccessories.com/skin/frontend/default/blanco/images/dalliance-screenshot.jpg"> 
```

我得到的错误：

> 解析器不匹配元数据：此元数据的解析器结果与输入元数据不匹配。这可能是由于数据以一种意外的方式排序、为一个属性提供了多个值而只期望一个值、或者给定属性的属性值不匹配造成的。以下是解析结果中未显示的输入属性：'og:image:url'

我不明白。我到处寻找答案，但没有任何解决方案有效。最后没有多余的空格（一个建议的解决方案），我已经手动输入了所有内容，因此也没有不可见的字符。

这个问题似乎只出现在我把图片放进去。所以随机。我在网站的最后一个版本上的图像很好。有人有什么想法吗？

**更新：所以这只是主页上的一个问题，我仍然无法弄清楚为什么。我在其他任何地方都没有看到这个错误。（例如，当我调试[http://www.dalianceaccessories.com/necklaces.html](http://www.dallianceaccessories.com/necklaces.html)时）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T01:14:11.920

我想出了一个解决办法。它很脏，但它有效。

**背景信息：**当我尝试更改主页的网站标题时，它告诉我“您无法更改此冻结页面的标题”等。“冻结”部分提出了一个心理危险信号，但更改了标题主页没什么大不了的，所以我继续前进。

现在，在试图弄清楚这一点时，我想它可能正在寻找我的一些旧 OG 数据，因为无论这些“冻结”数据是什么。我假设由于某种原因我不能在页面上更改太多我的 OG 数据？

**修复：**在添加了之前在上一个网站版本的 OG 数据中指定的 4 个图像后，它允许我通过调试器更新 OG 数据。现在读起来完全没问题。添加旧的图片 url 让我可以在人们分享时更新标题、描述等。

我的猜测是有某种检查来查看是否有太多数据发生了变化并且我以某种方式触发了它？？？我不太确定他们为什么会这样做，但似乎是这样。

为了清楚起见，这就是我现在所有的图像标签（底部的 4 个甚至不是有效的 url，但它们是我曾经拥有的）。

```
<meta property="og:image" content="http://www.dallianceaccessories.com/skin/frontend/default/blanco/images/dalliance-logo.png" />
<meta property="og:image" content="http://www.dallianceaccessories.com/skin/frontend/default/blanco/images/dalliance-screenshot.jpg" />
<meta property="og:image" content="http://www.dallianceaccessories.com/wp-content/themes/Core/images/slider-miko.jpg" />
<meta property="og:image" content="http://www.dallianceaccessories.com/wp-content/themes/Core/images/slider-pagan.jpg" />
<meta property="og:image" content="http://www.dallianceaccessories.com/wp-content/themes/Core/images/slider-sugarchain-black.jpg" />
<meta property="og:image" content="http://www.dallianceaccessories.com/wp-content/themes/Core/images/og-logo.jpg" /> 
```

我将尝试以某种方式消除这些旧图像 url，或者用新图像填充旧 url，直到我能以某种方式找到解决此错误的正确方法。

# xpages - XPages - SSJS 调用 bean

> ID：11874286
> 
> 赞同：0
> 
> 时间：2012-08-08T22:43:00.887
> 
> 标签：xpages, xpages-ssjs

我试图从 XPage 调用一些 java 代码，并试图通过 SSJS 来执行此操作。只是试图让一个基本的 hello world 示例工作。理想情况下，Java 代码的返回值可以填充到变量中。

目标：（Xpage 内容）

```
<?xml version="1.0" encoding="UTF-8"?>
<xp:view xmlns:xp="http://www.ibm.com/xsp/core">
    <xp:label value="#{javascript:helloWorld.anyoneThere}" id="label1"></xp:label>
</xp:view> 
```

会打印“哟！” 页面加载时。相反，我得到一个运行时错误，找不到 helloWorld。

创建了一个包

```
package testBean;

public class helloWorld {
    public String anyoneThere(){
        return "Yo!";
    }
} 
```

然后我修改了 faces-config 文件

```
<?xml version="1.0" encoding="UTF-8"?>
<faces-config>
    <managed-bean>
        <managed-bean-name>helloWorld</managed-bean-name>
        <managed-bean-class>testBean</managed-bean-class>
        <managed-bean-scope>application</managed-bean-scope>
    </managed-bean>
</faces-config> 
```

不知道我需要做什么来初始化/调用java函数。我见过的一些例子是挂钩视图或事件，但我正在做的事情的预期代码更有可能在 beforePageLoad 部分中运行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T23:25:46.723

您的托管豆类也包含类名。

```
<managed-bean-class>testBean.helloWorld</managed-bean-class> 
```

你的标签也必须有括号

```
<xp:label value="#{javascript:helloWorld.anyoneThere();}" id="label1"></xp:label> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-09T07:42:56.123

我已经写了一个[关于创建和使用带有 XPages 的简单托管 bean 的基础知识的小教程](http://per.lausten.dk/blog/2012/02/creating-your-first-managed-bean-for-xpages.html)。

本教程还展示了如何将 getter 和 setter 添加到变量中，以便您可以使用 EL 来引用它们。因此，在您的示例中，您将能够执行以下操作来引用`anyoneThere`变量（假设您已经为其设置了 getter 和 setter）：

```
<xp:label value="#{helloWorld.anyoneThere}" id="label1"></xp:label> 
```

# macos - 在内核控制 ctl_enqueuedata 调用中识别 EINVAL

> ID：11874288
> 
> 赞同：0
> 
> 时间：2012-08-08T22:43:15.673
> 
> 标签：macos, kernel, kernel-module, kernel-extension

我想使用内核控件将消息从内核扩展发送到用户程序。我打电话`EINVAL`时遇到错误`ctl_enqueuedata`。

* * *

我已经设置了一个内核控件，我正在尝试使用`ctl_enqueuedata`. 我在设置

```
ep_ctl.ctl_flags = 0 
```

在传递给 之前`ctl_register`，[文件](https://developer.apple.com/library/mac/#documentation/Darwin/Conceptual/NKEConceptual/control/control.html)建议，这应该导致`ctl_unit`被自动设置。

引用`kern_control.h`：

> 对于动态分配的控件 ID，不要设置 CTL_FLAG_REG_ID_UNIT 标志。

```
static struct kern_ctl_reg ep_ctl;
static kern_ctl_ref kctlref; 
```

...

```
errno_t error;
bzero(&ep_ctl, sizeof(ep_ctl));  // sets ctl_unit to 0
ep_ctl.ctl_id = 0;
ep_ctl.ctl_unit = 0;
strncpy(ep_ctl.ctl_name, CONTROL_NAME, strlen(CONTROL_NAME));
ep_ctl.ctl_flags = 0x0; // not CTL_FLAG_REG_ID_UNIT so unit gets supplied. Not CTL_FLAG_PRIVILEGED either.
ep_ctl.ctl_send = EPHandleSend;
ep_ctl.ctl_getopt = EPHandleGet;
ep_ctl.ctl_setopt = EPHandleSet;
ep_ctl.ctl_connect = EPHandleConnect;
ep_ctl.ctl_disconnect = EPHandleDisconnect;
error = ctl_register(&ep_ctl, &kctlref);

printf("setupControl %d\n", error); 
```

当我打电话`ctl_register`时，它返回`0`正常。

当我打电话时`ctl_enqueuedata`，传入我的`struct kern_ctl_reg`我得到 22，即`EINVAL`。其中一个论点似乎是不正确的。我传递的其他参数是静态测试字符串及其数据长度和零标志。

```
int result = ctl_enqueuedata(kctlref, ep_ctl.ctl_unit, filename, length, 0x0); 
```

my`ep_ctl`的`.ctl_unit`值为`0`， 的`.ctl_id`值为`6`。可能`ctl_unit`是传递给的值`ctl_enqueuedata`无效/未初始化吗？

`kern_control.h`说ctl_unit：

> 对于动态分配的控件 ID，此字段将被忽略

这表明无论如何都不需要它？

我在初始化 ep_ctl 时错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:18:28.967

我相信您提供了错误的值作为`ctl_enqueuedata()`. 而不是`ep_ctl.ctl_unit`，您必须`struct sockaddr_ctl::sc_unit`在`EPHandleConnect()`回调中记住，这就是您应该传递给`ctl_enqueuedata()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-15T21:40:35.867

我建议使用 OSX 的内核调试工具来弄清楚这里发生了什么。这将让您浏览相关的内核代码，并且应该告诉您它在哪里拒绝您的输入。

# php - .docx、.xlsx、.pdf 到 .pdf 使用 PHP

> ID：11874293
> 
> 赞同：0
> 
> 时间：2012-08-08T22:43:46.673
> 
> 标签：php, pdf, type-conversion, docx, xlsx

我在 .docx、.xlsx 和 PDF 文件中有相对敏感的数据，这些数据都需要在本地转换为单个 PDF 文件。将这些文件发送到 phpdocx 或 Google Docs 或类似的东西不是一种选择。

我看到的唯一其他选项是 OpenOffice / LibreOffice，但我对他们转换文档的方式不满意。

还有其他任何人都知道的选择吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T09:00:25.160

绝对是一项艰巨的任务。LibreOffice 3.6 的最新版本已经修复了它的 docx 处理，如果这可能有帮助的话，但是您还没有具体说明您在尝试 OpenOffice 时遇到的实际问题。

如果您有时间进行试验（并引入完成工作所需的任何工具/语言），您可以尝试使用 LibreOffice 生成 PDF，然后使用众多 PDF 库之一将 PDF 拼接到您需要的单个文件中。

您还可以查看 ODFConverter，它在 DOCX 上比 OpenOffice 或 LibreOffice 都要好得多。这将允许您使用 docx -> odt -> pdf。我认为它也可以做 xlsx。然后再次进行PDF拼接。

我建议首先手动测试这些阶段，如果有希望，请尝试 JODConverter（需要 Java）之类的东西，以允许您通过脚本自动化该过程。

祝你好运。

# vba - 如何在microsoft access中动态加载、访问和卸载子表单

> ID：11874299
> 
> 赞同：2
> 
> 时间：2012-08-08T22:44:07.187
> 
> 标签：vba, ms-access, vbscript, ms-office, office-2010

我正在尝试从 ASP.NET 到访问编程的顶级转换，当我想到 Access 中的子窗体时，我习惯于从用户控件的角度来思考。我想做的是允许用户单击一个按钮来加载一个包含用户可以输入其他数据的控件的子表单。如果有任何信息或资源可以帮助我理解在 MS Access 中是如何完成的——如何加载、卸载和访问子表单中的数据，我将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T11:46:27.543

好吧，作为一般规则，子表单的这种加载是自动完成的，不需要您进行任何编码。所以一般来说，你最好不要担心这个问题，并节省所有编码时间来帮助你附近的穷人和有需要的人。

但是我应该指出，如果您在 Access 中构建 Web 表单，则子表单仅在使用时才会动态加载。因此，如果您在选项卡控件后面放置一个子表单，然后生成的 Web 表单（发布时它们是 XAML 表单，并且表单代码被转换为 JavaScript），那么子表单会为您动态加载到浏览器中。毫无疑问，这种设置确实会加快 Web 表单的加载速度。因此，对于 Web 表单，这种加载是动态的，并且是 Access Web 表单的按需加载。

但是，我在这里的猜测是您谈论的是 Access 客户端表单，而不是 Access Web 表单。鉴于这种情况，在客户端，加载时间相当快，很少担心或需要或浪费开发人员的时间来执行此操作。

但是，在某些情况下，例如必须加载 5 个子表单，并且这样的时间可能会开始累积到用户可能开始注意到延迟的地步。在这种情况下，您可以动态加载子表单，您可以通过设置子表单对象的源对象属性来做到这一点。

所以请记住，子表单只是一个“控件”，与实际表单无关。在大多数 Access 应用程序中，我看到这个子表单控件的名称与子表单的名称相同，但它当然不必如此。

因此，要动态加载子表单，例如切换到表单上的不同选项卡时，代码如下所示：

```
 Private Sub TabCtl2_Change()

     If Me.TabCtl2.Value = 1 Then
        If Me.frmListContacts.SourceObject = "" Then
           Me.frmListContacts.SourceObject = "frmListContacts"
        End If

  End Sub 
```

因此，如果您在表单上放置子表单控件，但将源对象设置留空，则不会为该子表单加载或显示任何表单。在上面，一旦我加载了表单，那么源对象设置就不会是空白的，因此我不会多次尝试设置/加载子表单。

如前所述，在加载表单的绝大多数情况下，无论如何您都需要加载和显示该子表单，因此在大多数典型应用程序中不需要上述代码。

# sql - 将虚拟子过滤器与父表进行比较

> ID：11874309
> 
> 赞同：0
> 
> 时间：2012-08-08T22:45:22.180
> 
> 标签：sql, vba, ms-access, parent-child

我不知道如何做到这一点。我正在使用 Access 2007，并使用 VBA 和 SQL 进行编码。

表 A 包含数据、帐户和金额。用户可以使用表单 B 访问 A 中的数据子集，例如，金额在 50 美元到 100 美元之间的所有行。

当用户查看一行时，我需要知道是否还有其他具有相同帐户的行被排除在他们的视图之外。换句话说，我需要知道父项中是否有可见的行在子项中不可见。

我认为一个解决方案是确定哪些过滤器在他们的视图中处于活动状态，然后我可以使用 dcount 进行比较。不过，我不知道如何获取在他们看来处于活动状态的过滤器。并且可能有更简单的方法 - 我在这里超出了我的深度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T10:18:50.780

让我们假设 TableA 有一个主键 ID。使用 FormB 的当前事件：

```
 Dim rs AS DAO.Recordset

 dAmt = Me.Amount
 sAcc = Me.Account 

 ''Get a list of visible IDs
 With Me.RecordsetClone
    .MoveFirst

     Do While Not .EOF
         If !Amount=dAmt And !Account=sAcc Then
            sIDs = sIDs & "," & .ID
         End If
         .MoveNext
     Loop
 End with

 ''Other IDs
 sSQL = "SELECT * FROM TableA "
      & "WHERE Amount = " & dAmt _
      & "Account = '" & sAcc _
      & "' ID Not In (" & Mid(sIDs,2) & ")"

 CurrentDB.CreateQueryDef("NewQ",sSQL")
 Docmd.OpenQuery NewQ 
```

以上内容未经测试，就目前而言，如果它运行的话，只会运行一次，因为创建了一个新查询，而不是编辑现有查询。

# ios - 向表格视图添加多个水平按钮

> ID：11874314
> 
> 赞同：0
> 
> 时间：2012-08-08T22:45:41.737
> 
> 标签：ios, uitableview

我尝试了很多东西——从对象浏览器中添加一个按钮、更改属性、搜索网络，但没有运气。本质上，我想做——在故事板中——：![固定截图](../Images/6b4e06c50edc5497b8b7220aaafc317c.png)

您在其中看到“添加到联系人”“共享位置”和“添加到书签”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:20:35.527

您应该创建一个`UITableViewCell`其`contentView`拥有 3 个单独的`UIButtons`. 要以编程方式执行此操作，在您的`tableView:cellForRowAtIndexPath:`数据源方法中，您可以使用类似于以下的代码：

```
- (UITableViewCell*) tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString* identifier = @"cell";
    UITableViewCell* cell = [tableView dequeueReusableCellWithIdentifier:identifier];
    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:nil];
        cell.backgroundColor = [UIColor clearColor];
        UIButton* button1 = [UIButton buttonWithType:UIButtonTypeRoundedRect];
        UIButton* button2 = [UIButton buttonWithType:UIButtonTypeRoundedRect];
        UIButton* button3 = [UIButton buttonWithType:UIButtonTypeRoundedRect];
        button1.frame = UIEdgeInsetsInsetRect(cell.contentView.bounds, UIEdgeInsetsMake(0, 0, 0, 250)); 
        button2.frame = UIEdgeInsetsInsetRect(cell.contentView.bounds, UIEdgeInsetsMake(0, 125, 0, 125)); 
        button3.frame = UIEdgeInsetsInsetRect(cell.contentView.bounds, UIEdgeInsetsMake(0, 250, 0, 0)); 
        button1.autoresizingMask = UIViewAutoresizingFlexibleRightMargin;
        button2.autoresizingMask = UIViewAutoresizingFlexibleRightMargin | UIViewAutoresizingFlexibleLeftMargin;
        button3.autoresizingMask = UIViewAutoresizingFlexibleLeftMargin;
        [cell.contentView addSubview:button1];
        [cell.contentView addSubview:button2];
        [cell.contentView addSubview:button3];
    }

    return cell;
} 
```

此外，在`tableView:willDisplayCell:`您的委托的方法中，执行以下操作以使单元格的默认装饰完全消失：

```
- (void) tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    cell.backgroundView = nil;
} 
```

您应该获得与您发布的内容非常相似的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T23:08:09.937

将三个按钮放在一个 320 像素宽、60 高的 UIView 中，然后将该视图设置为表格的页脚。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T23:08:48.837

使用stye`UITableView`进行样式设置。 这三个以编程方式添加到. 或者，您可以将三个添加到最后一个.`UITableViewStyleGrouped`
`UIButtons``tableView.tableFooterView`
`UIButtons``contentView``cell`

添加按钮，例如：

```
UIButton *theButton = [UIButton buttonWithType:UIButtonTypeRoundedRect];
theButton.frame = CGRectMake(20, 20, 200, 40); 
[theButton setTitle:@"Button" forState:UIControlStateNormal];
[theButton addTarget:self action:@selector(buttonClicked:) forControlEvents:UIControlEventTouchUpInside];
[cell.contentView addSubview:theButton]; 
```

使用反复试验正确获取按钮位置:)

# jquery - jquery outerWidth/Height 因元素淡入而失败

> ID：11874316
> 
> 赞同：1
> 
> 时间：2012-08-08T22:46:22.820
> 
> 标签：jquery, css, popup, show

我创建了一个弹出框类。每个弹出窗口可以有可变的内容，并且出现在可变的位置，这取决于打开时光标所在的位置，因此弹出窗口似乎是从单击的链接或按钮中出来的。

问题是如果光标太靠近边框，弹出窗口可能部分位于屏幕之外。要调整位置，我需要弹出窗口的宽度和高度。

我试过这个：

```
$("#" + div_id).show(400);          

var off = $("#" + div_id).offset();
                var t = off.top;
                var l = off.left;
                var h = $("#" + div_id).outerHeight();

                var w = $("#" + div_id).outerWidth();

                var docH = $(document).height();
                var docW = $(document).width();
                alert("t = "+ t + ", h = " + h + ", w " + w + ", l "+ l + ", docH " + docH + ", docW " + docW);
                if ((t + h) > docH) {
                    var h_diff = (t + h) - docH;    //difference (how much is hidden?)
                    var new_top = Math.max(10, t - h_diff - 10); //move it of the needed amout + 10 margin  (but don’t go further than 10 from top border)
                    $("#" + div_id).css("top", new_top);
                }
                if ((l+ w) > docW) {
                    var w_diff = (l + w) - docW;    //difference (how much is hidden?)
                    var new_left = Math.max(10, l - w_diff - 10); //move it of the needed amout + 10 margin
                    $("#" + div_id).css("left", new_left);
                } 
```

问题是outerWidth() 和outerHeight 实际上确实失败了，因为因为我使用show() 的动画版本，所以检索到的高度和宽度是最小的。我很确定这就是原因，因为如果我立即显示 div 一切正常。另外，添加警报以查看发生了什么，我发现弹出窗口仅在带有动画的警报之后出现（并且警报显示最小的宽度和重量），而如果不添加持续时间来显示（）弹出窗口首先显示，警告框出现，显示正确的值。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T22:52:06.627

由于您已经在使用 jQuery，您可以使用 .poisition() 方法来完成您想要做的事情。 [http://jqueryui.com/demos/position/](http://jqueryui.com/demos/position/)

希望这可以帮助

# ruby-on-rails-3.1 - Rails：如何添加带有目标空白的link_to

> ID：11874317
> 
> 赞同：71
> 
> 时间：2012-08-08T22:46:24.763
> 
> 标签：ruby-on-rails-3.1

我是 Rails 3 的新手，我想在下面的 link_to 助手中添加 (:target => "_blank")

```
link_to "GOOGLE", 'http://www.google.com', class: "btn btn-large btn-primary" 
```

但我想使用 application_helper 来定义 link_to 方法。

1.  如何在 application_helper 中定义 link_to 方法？
2.  如何在 link_to 方法中通过类：“btn btn-large btn-primary”？

谢谢您的帮助...

* * *

## 回答 #1

> 赞同：145
> 
> 时间：2012-08-08T23:03:56.087

为什么要覆盖`link_to`？它已经在 Rails 中定义了，只需像这样使用它：

```
link_to "GOOGLE", "http://www.google.com", target: "_blank", class: "btn btn-large btn-primary" 
```

编辑：好的，明白了。我建议不要覆盖这种常见的方法，所以创建另一个：

```
def link_to_blank(body, url_options = {}, html_options = {})
  link_to(body, url_options, html_options.merge(target: "_blank"))
end 
```

它应该可以解决问题

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-12-20T05:20:28.680

添加到 Anthony 的回答中，这更类似于 Rails 的`link_to`实现，包括对块的支持和不传递参数：

```
def link_to_blank(name = nil, options = nil, html_options = nil, &block)
  target_blank = {target: "_blank"}
  if block_given?
    options ||= {}
    options = options.merge(target_blank)
  else
    html_options ||= {}
    html_options = html_options.merge(target_blank)
  end
  link_to(name, options, html_options, &block)
end 
```

# backbone.js - 为什么模型属性会添加到我的 Backbone.Marionette.ItemView？

> ID：11874319
> 
> 赞同：3
> 
> 时间：2012-08-08T22:46:36.860
> 
> 标签：backbone.js, attributes, marionette

# 问题

我有一个 itemview，它通过其初始化程序接收模型。当 itemview 被渲染时，属性被添加到每个模型属性的视图元素中。

为什么会发生这种情况，我该如何防止这种情况发生？

## 示例场景

我拥有的代码的简化示例如下所示：

```
var MyView = Marionette.ItemView.extend({
  tagName: 'div',
  id: 'myView',
  className: 'myClass',
  template: someTemplate,

  initialize: function(model) {
    this.model = model;
  }
});
var myView = new MyView(someBackboneModel);
myView.render(); 
```

假设模型有一个值为 '124' 的 'id' 属性，这会产生一个像这样的元素：

```
<div id="124" foo="foo" bar="bar" class="myClass">
  <!-- blabla -->
</div> 
```

## 问题

如您所见，在 MyView 类中设置的 id 值被模型的 id 属性替换。

我的应用程序中有其他 ItemViews 由 Backbone.Marionette.CollectionView 呈现，它呈现没有表现出这种行为并且根本不将它们的模型属性添加到它们的 $el 的 ItemView 元素。

## 有任何想法吗？

我已经尝试在 Marionette Source 和 Backbone 源中进行挖掘，但到目前为止我找不到发生这种情况的原因。

# 附录

应[Derick Bailey](https://stackoverflow.com/users/93448/derick-bailey)的要求，这是对我造成此问题的完整视图和模板：

### 风景：

```
var Admin_Applications_ApplicationReader_Application_View = Marionette.ItemView.extend({
  tagName: "div",
  id: "Admin-Applications-ApplicationReader-Application-View",
  template: ApplicationTemplate,
  templateHelpers: {
    moment: Moment
  },

  initialize: function(model) {
    this.model = model;
    this.bindTo(this, 'layout', this.onLayout);
  },

  // Callbacks
  //----------
  onRender: function() {
    var that = this;
    setTimeout(function() {
      that.onLayout();
      var $scrollContainer = that.$el.find('#Admin-Applications-ApplicationReader-Body'), 
          scrollPane = new ScrollPane($scrollContainer, {
            maxHeightProperty: 'maxHeight',
            scrollUpButton: false,
            scrollDownButton: false
          });
    }, 0);
  },

  // Layout
  //-------
  onLayout: function() {
    var css;

    // Calculate desktop styles
    if ($(window).width() > 767) {
      css = this.calculateBodyStyle();
    }
    else {
      css = {
        applicationBody: { height: 'auto' }
      }
    }

    // apply styles
    this.$el.find('#Admin-Applications-ApplicationReader-Body').css(css.applicationBody);

    // re-initialize scroll-pane
    this.$el.find('.scroll-container').trigger('scroll-pane:new-content');
  },
  calculateBodyStyle: function() {
    var $title = this.$el.find('#Admin-Applications-ApplicationReader-Title'),
        viewHeight = this.$el.height(),
        titleHeight = $title.outerHeight(true),
        bodyHeight = viewHeight - titleHeight,
        css = {
          applicationBody: { maxHeight: bodyHeight },
        };

    return css;
  }
}); 
```

### 模板：

```
<div id="Admin-Applications-ApplicationReader-Title" class="page-header no-top-margin">
  <h2>Application&nbsp;
    <span class="no-wrap"><small>Package: <%= package %>,&nbsp;</small></span> 
    <span class="no-wrap"><small><%= moment(submission_timestamp, 'YYYY-MM-DD HH:mm:ss').fromNow() %></small></span>
  </h2>
</div>

<div id="Admin-Applications-ApplicationReader-Body" class="container-white scroll-container">
  <ul class="application unstyled scroll-content">
    <li class="section summary-section">
      <div class="section-header">
        <h3>Summary</h3>
      </div>

      <table class="section-body no-border table-condensed">
        <tbody>
          <tr>
            <th>Package:</th>
            <td><%= package %></td>
          </tr>
          <tr>
            <th>Date of last flight:</th>
            <td><%= date_of_last_flight %></td>
          </tr>
          <tr>
            <th>Date of renewel:</th>
            <td><%= date_of_ir_renewel %></td>
          </tr>
        </tbody>
      </table>
    </li>
    <!-- /.summary-section -->

    <li class="section credentials-section">
      <div class="section-header">
        <h3>Credentials</h3>
      </div>

      <table class="section-body no-border table-condensed">
        <tbody>
          <tr>
            <th>Pilot Training Institute:</th>
            <td><%= pilot_training_institute %></td>
          </tr>
          <tr>
            <th>Date of exam:</th>
            <td><%= moment(date_of_exam).format('DD-MM-YYYY') %></td>
          </tr>
          <tr>
            <th>Date of last flight:</th>
            <td><%= moment(date_of_last_flight).format('DD-MM-YYYY') %></td>
          </tr>
          <tr>
            <th>Date of MCC Certificate:</th>
            <td><%= moment(date_of_mcc_certificate).format('DD-MM-YYYY') %></td>
          </tr>
          <tr>
            <th>Date of renewel:</th>
            <td><%= moment(date_of_ir_renewel).format('DD-MM-YYYY') %></td>
          </tr>
        </tbody>
      </table>
    </li>
    <!-- /.credentials-section -->

    <li class="section personal-information-section">
      <div class="section-header">
        <h3>Personal information</h3>
      </div>

      <table class="section-body no-border table-condensed">
        <tbody>
          <tr>
            <th>Name:</th>
            <td><%= [first_name, last_name].join(' ') %></td>
          </tr>
          <tr>
            <th>Adress:</th>
            <td><%= address %></td>
          </tr>
          <tr>
            <th>Zip code:</th>
            <td><%= zip_code %></td>
          </tr>
          <tr>
            <th>City:</th>
            <td><%= city %></td>
          </tr>
          <tr>
            <th>Country:</th>
            <td><%= country %></td>
          </tr>
          <tr>
            <th>Language:</th>
            <td><%= language %></td>
          </tr>
          <tr>
            <th>Telephone:</th>
            <td><%= telephone %></td>
          </tr>
          <tr>
            <th>Celĺphone:</th>
            <td><%= cell_phone %></td>
          </tr>
          <tr>
            <th>E-mail:</th>
            <td><%= email %></td>
          </tr>
          <tr>
            <th>Date of birth:</th>
            <td><%= moment(date_of_birth).format('DD-MM-YYYY') %></td>
          </tr>
        </tbody>
      </table>        
    </li>
    <!-- /.personal-information-section -->
  </ul>
  <!-- /.application.scroll-content -->
</div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-27T22:11:52.327

问题是您如何在实例化时将模型传递到视图中。您应该像这样实例化视图：

```
var myView = new MyView({model: someBackboneModel}); 
```

您可以从 initialize 方法中删除`this.model = model`代码 - 当您在构造函数中指定[模型选项](http://backbonejs.org/#View-constructor)时，Backbone 会为您设置此代码。

您的视图元素具有附加属性的原因`model.attributes`是被设置为视图的[可选`attributes`参数](http://backbonejs.org/#View-attributes)。`element`渲染时添加属性。要正确使用它，您将实例化如下：

```
var myView = new MyView({
    model: someBackboneModel,
    attributes: { id: ..., class: ..., data-foo: bar }
}) 
```

# java - 防止 Google App Engine 中 get_serving_url() 的热链接

> ID：11874321
> 
> 赞同：0
> 
> 时间：2012-08-08T22:46:40.150
> 
> 标签：java, python, google-app-engine

有没有办法防止图像服务方法 get_serving_url() 提供的图像的热链接？

我只找到[了这个答案](https://stackoverflow.com/q/903144/734765)，但我认为它不适用于 get_serving_url()。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:13:42.530

否 - 如果您想要对从 Blobstore/Google 存储提供的图像进行任何类型的访问控制，那么您应该编写一个 BlobstoreDownloadHandler 并在执行任何您想要的访问控制后使用 send_blob 返回图像。

如果您使用 get_serving_url() 的裁剪或调整大小选项，那么您需要自己进行此转换并将结果存储在 blobstore 中，然后您将返回该结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T22:52:38.663

不，您不能对 blobstore 或图像服务 URL 进行引荐来源网址检查。

# objective-c - 使所有文本显示在 UITableView 单元格中

> ID：11874323
> 
> 赞同：3
> 
> 时间：2012-08-08T22:47:01.073
> 
> 标签：objective-c, ios, xcode, uitableview

我正在将一个数组加载到 UITableView 中，并且该数组的组件很长。我想要做的是自定义单元格，以便它们的长度将调整以适应文本，但宽度将保持不变。现在发生的事情是当文本变得太长时，它只会注销单元格，你会看到这一点。

![在此处输入图像描述](../Images/8b8dc68023f3eb39c83a355dc1068fb2.png)

我希望看到文本到达单元格的末尾，然后开始新的一行。

我的代码现在看起来像这样。

```
@implementation CRHCommentSection
@synthesize observationTable; 

NSArray *myArray; 

- (void)viewDidLoad
{

    myArray = [CRHViewControllerScript theArray];  
    NSLog(@"%@", myArray);
    //NSArray* paths = [NSArray arrayWithObject:[NSIndexPath indexPathForRow:0   inSection:1]];
   //[observationTable insertRowsAtIndexPaths:paths withRowAnimation:UITableViewRowAnimationTop];

   [observationTable reloadData]; 

    [super viewDidLoad];
// Do any additional setup after loading the view.

}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    // Return the number of sections.

    NSLog(@" in method 1");
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

 NSLog(@" in method 2");
// Return the number of rows in the section.
return [myArray count];

}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath  *)indexPath {

NSLog(@" in method 3");

static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewStylePlain reuseIdentifier:CellIdentifier];
}

cell.textLabel.text = [myArray objectAtIndex:indexPath.row];
//cell.textLabel.text = @"Label"; 

return cell;
} 
```

我还发现了一些其他人为多个行单元格编写的代码，但不知道如何根据数组中字符串的长度使其自动运行。

```
static NSString *CellIdentifier = @"MyCell"; 
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (cell == nil) {
 cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue2
 reuseIdentifier:CellIdentifier] autorelease];
}
cell.textLabel.text = @"Label';
cell.detailTextLabel.text = @"Multi-Line\nText";
cell.detailTextLabel.numberOfLines = 2;
cell.detailTextLabel.lineBreakMode = UILineBreakModeWordWrap; 
```

他们说您还需要为多行单元格返回合适的高度，并且 (44.0 + (numberOfLines - 1) * 19.0) 的高度应该可以正常工作。

有谁知道如何做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-08T22:57:54.847

您将需要使用以下方法

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    // this method is called for each cell and returns height
    NSString * text = @"Your very long text";
    CGSize textSize = [text sizeWithFont:[UIFont systemFontOfSize: 14.0] forWidth:[tableView frame].size.width - 40.0 lineBreakMode:NSLineBreakByWordWrapping];
    // return either default height or height to fit the text
    return textSize.height < 44.0 ? 44.0 : textSize.height;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString * cellIdentifier = @"YourTableCell";

    UITableViewCell * cell = [tableView dequeueReusableCellWithIdentifier:cellIdentifier];

    if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 
                                      reuseIdentifier:cellIdentifier];

        [[cell textLabel] setNumberOfLines:0]; // unlimited number of lines
        [[cell textLabel] setLineBreakMode:NSLineBreakByWordWrapping];
        [[cell textLabel] setFont:[UIFont systemFontOfSize: 14.0]];
    }

    [[cell textLabel] setText:@"Your very long text"];

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:00:31.287

你想看看 NSString 函数`-(CGSize)sizeWithFont:(UIFont *)font constrainedToSize:(CGSize)size`

您必须将其包含在您的`heightForRowAtIndexPath`函数中以确定正确的高度。

此外，将`numberOfLines`标签的 设置为 0。这允许它调整到所需的任何行数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T23:09:02.877

在表格视图单元格中使用 UITextView 怎么样。

首先，您必须更改单元格的高度。

接下来，将 UITextView 放入单元格中。

![ss](../Images/e97241a5bc5a9908e34302c598f746ab.png)

![ss](../Images/aa65cb07cf6097d5afa002129e229498.png)

当然，您可以通过代码而不是通过 IB 来做到这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-10T14:51:46.803

对我来说，接受的答案是通过添加 else 条件来实现的。在我的情况下，如果条件没有得到满足，因为`[tableView dequeueReusableCellWithIdentifier:@"comment"];`总是返回不为零的单元格。

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    NSInteger item = indexPath.item;
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"comment"];

    if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1
                                      reuseIdentifier:@"comment"];

        [[cell textLabel] setNumberOfLines:0]; // unlimited number of lines
        [[cell textLabel] setLineBreakMode:NSLineBreakByWordWrapping];
        [[cell textLabel] setFont:[UIFont systemFontOfSize: 14.0]];
    }
     // added else condition
    else {
        [[cell textLabel] setNumberOfLines:0];
        [[cell textLabel] setLineBreakMode:NSLineBreakByWordWrapping];
        [[cell textLabel] setFont:[UIFont systemFontOfSize: 14.0]];
    }

    [[cell textLabel] setText:commentsText[item]];

    return cell;
} 
```

# java - 使用没有静态数组的 RandomAccessFile 编写学生的另一种方法

> ID：11874324
> 
> 赞同：0
> 
> 时间：2012-08-08T22:47:06.117
> 
> 标签：java, random-access

我正在制作一个使用 RandomAccessFile 将学生详细信息存储在文件中的应用程序，但我实现这一目标的唯一方法是将存储学生 a、b、c、d、e 等添加到静态数组中并使用 getBytes方法来写。存储是使用 arrayList 创建的。我尝试了很多事情和很多方法，如果不使用静态数组，我无法弄清楚。

这是我的代码：

主应用

```
import java.io.IOException;
import java.io.RandomAccessFile;
public class MainApp
{

    public static void main(String[] args) throws Exception 
    {
        new MainApp().start();

    }
    public void start()throws Exception 
    {
        StudentStore details = new StudentStore();
        Student a = new Student("Becky O'Brien", "DKIT26", "0876126944", "bexo@hotmail.com");
        Student b = new Student("Fabio Borini", "DKIT28", "0876136944", "fabioborini@gmail.com");
        Student c = new Student("Gaston Ramirez", "DKIT29", "0419834501", "gramirez@webmail.com");
        Student d = new Student("Luis Suarez", "DKIT7", "0868989878", "luissuarez@yahoo.com");
        Student e = new Student("Andy Carroll", "DKIT9", "0853456788", "carroll123@hotmail.com");
        details.add(a);
        details.add(b);
        details.add(c);
        details.add(d);
        details.add(e);
        //details.print();

        RandomAccessFile file = new RandomAccessFile("ContactDetails.txt","rw");
        //getBytes() returns an array of bytes.
        //Because i have put the store in a static Array.(I done this because i could find no other
        //Simple way to write a Student Object.)
        //None of the methods of the RandomAccessFile write class worked with this.
        Student[] students = {a,b,c,d,e};
        details.write(students, file);
        details.readAll(file);

        file.close();

     }

 } 
```

学生商店

```
//---------------------------------------------------------------------------
//Imports.
//---------------------------------------------------------------------------   
import java.io.IOException;
import java.io.RandomAccessFile;
import java.util.ArrayList;
import java.util.List;
//---------------------------------------------------------------------------   

public class StudentStore
{
//---------------------------------------------------------------------------
//ArrayList declaration.
//---------------------------------------------------------------------------
    List<Student> students = new ArrayList<Student>();
//---------------------------------------------------------------------------
//Name:          Add method.
//Description:   Adds a student to the ArrayList.
//---------------------------------------------------------------------------
    public void add(Student student) 
    {
        students.add(student);
    }
//---------------------------------------------------------------------------
//Name:          DeleteAll method.
//Description:   Delete's everything in the ArrayList.
    //---------------------------------------------------------------------------
     public void deleteAll()
     {
           students.clear();
     }
//---------------------------------------------------------------------------
//Name:          Print method.
//Description:   Prints out the contents of the ArrayList.
//---------------------------------------------------------------------------
    public void print() 
    {
        for (int i = 0; i < students.size(); i++) 
        {
          Student a = students.get(i);
            System.out.println(a.toString());
        }
    }
    public int size()
    {
        return (students == null) ? 0 : students.size();
    }
    public void write(Student[] students, RandomAccessFile file) throws IOException
    {
        for (int i = 0; i < students.length; i++)
        {
        byte[] bytes = students[i].toString().getBytes();
        for(byte byteWrite : bytes)
        {
            file.writeByte(byteWrite);
        }
        }

    }
    public void readAll(RandomAccessFile file) throws IOException
    {
        final int Record_Length = 30;
        int recordNumber = 0;
        file.seek((recordNumber) * Record_Length);

        String code ="";
        for(int i = 0; i < 30; i++)
        {
        code += file.readLine() + "\n";
        }
        System.out.println(code);
    }

} 
```

注意：我没有展示学生类，因为它是由构造函数、getter 和 setter 以及 toString 构建的，我不觉得上传它有什么用，但如果需要我会很乐意这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:56:21.430

您可以标记`Student`为实现`Serializable`，因为它看起来只是存储一堆文本。然后，您可以`List<Student> students`像这样从您的字节中获取要存储的字节：

```
ByteArrayOutputStream bos = new ByteArrayOutputStream();
ObjectOutputStream out = new ObjectOutputStream(bos);
out.writeObject(students);
out.close();

byte[] bytes = bos.toByteArray(); 
```

然后，您可以通过将文件中的字节读取到字节数组中，然后执行以下操作，将其从文件中提取回来：

```
ObjectInputStream in = new ObjectInputStream(new ByteArrayInputStream(bytes));
students = (List<Student>) in.readObject();
in.close(); 
```

编辑：只需编写`Student.toSting()`您可以执行的 as 字节：

```
public void write(RandomAccessFile file) throws IOException
{
    for (Student s: students)
    {
        byte[] bytes = s.toString().getBytes();
        for(byte byteWrite : bytes)
        {
            file.writeByte(byteWrite);
        }
    }

} 
```

# django - 对象 TextField 内的模板标签

> ID：11874325
> 
> 赞同：0
> 
> 时间：2012-08-08T22:47:10.737
> 
> 标签：django, django-templates, django-views

`model.TextField`我需要在值内自定义模板标签。来自对象文本字段的值类似于`"lorem ipsum dolor {% mytag %}"`但“mytag”未呈现为模板标签。它在库中注册为标签并加载到页面上，我有`{{ object.textfield|safe }}`过滤器。有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T19:47:31.070

由于 Django 的模板引擎可以轻松地在您的代码中的任何地方使用，您应该能够执行以下操作：

```
from django.template import Context, Template
rendered = Template("{% load your_tag_library %}",
    object.textfield).render(Context()) 
```

它不是从文件中呈现模板，而是从如下字符串呈现模板：

```
"{% load your_tag_library %}lorem ipsum dolor {% mytag %}" 
```

例如，代码可以在您的视图中使用或作为模型上的方法。请注意，它`Context`是空的，您不妨将带有模板变量的 dict 传递给它。

此外，要直接在模板中处理它，您可以编写一个执行类似操作的自定义模板标签，基本上是一个为模板标签解析字符串的模板标签。

# iis - 网络部署。2-3 个文件后关闭连接，无法将数据写入传输连接

> ID：11874326
> 
> 赞同：0
> 
> 时间：2012-08-08T22:47:11.330
> 
> 标签：iis, webdeploy

在 Visual Studio 2010 中使用 Web Deploy 时，它会自动加载前 2 或 3 个文件，然后切断连接：

输出 ：

```
Start Web Deploy Publish the Application/package to https://xx.xx.xx.xx:8172/msdeploy.axd?site=Defau ...
Ajout de l'enfant dirPath (Add\bin).
Ajout de l'enfant dirPath (Add\ClientBin).
Ajout de l'enfant dirPath (Add\ClientBin\ProfilePicture).
Mise à jour de setAcl (Add).
Mise à jour de setAcl (Add).
Ajout de l'enfant filePath (Add\Analyze.XML).
Ajout de l'enfant filePath (Add\bin\Antlr3.Runtime.dll). 
```

错误：Web 部署任务失败。（无法将数据写入传输连接：现有连接被远程主机强行关闭。）

这可能是文件大小或超时问题吗？我已经和主机核实过，防火墙没有任何限制。这可能是 IIS 配置问题吗？

有任何想法吗？

本杰明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T13:28:20.660

我解决了我的问题：

我用新的应用程序池创建了新的网站（我没有使用 DefaultAppPool）。在我的新应用程序池中使用 .Net V4.0 之后。

（不要忘记在“配置 Web 部署发布...”中添加用户）

它正在工作。

再会。

# javascript - 使用 javascript 预填充电子邮件

> ID：11874327
> 
> 赞同：2
> 
> 时间：2012-08-08T22:47:18.053
> 
> 标签：javascript, jquery

我有一个显示用户列表的应用程序，当单击电子邮件按钮时，我希望电子邮件客户端打开一个预先填充的消息（我使用 javascript 制作消息），我不确定如何预先填充消息

任何帮助，将不胜感激

我会发布片段，但老实说，我不知道如何开始

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T22:50:10.277

[URI 对](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/encodeURIComponent)文本进行编码，然后将其附加到`mailto:`URL：

```
<a href='mailto:person@place.com?body=text%20here'>Send mail!</a> 
```

更一般地，您可以使用：

*   学科
*   正文（多个`body`参数会将每个参数放在一个新行上）
*   抄送
*   密件抄送

每对之间有一个与号 (&)。

```
mailto:person@place.com?subject=Hi&body=some%20text 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T22:56:44.193

您可以使用 jQuery 查找所有具有 的链接`mailto:`，然后处理它们的 href 以添加消息正文：

```
$("a[href^='mailto:']").prop( "href", function(i, prop){
     return prop + "?body=" + encodeURIComponent( "Your message here" );
}); 
```

演示：

[http://jsfiddle.net/6qXrU/](http://jsfiddle.net/6qXrU/)

# mysql - 列出在 MySQL 表的特定列中具有重复条目的所有行

> ID：11874328
> 
> 赞同：3
> 
> 时间：2012-08-08T22:47:47.180
> 
> 标签：mysql, select, duplicates

尽管进行了大量搜索，但我还没有想出正确的方法来列出在特定列中具有相同内容的行的所有列（假设列“名称”）。

因此，如果我的名为 USERS 的表具有以下内容：

```
ID      User      Name

1       Nick      Nick
2       NickP     Nick
3       NickC     Nick
4       John      John
5       Brian     Brian 
```

SELECT 语句应返回：

```
ID      User      Name

1       Nick      Nick
2       NickP     Nick
3       NickC     Nick 
```

因为这些都是在“名称”列中包含相同内容的所有行。我怎么写这个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-08T22:55:09.797

这个怎么样？

```
SELECT * FROM Users WHERE Name IN(SELECT Name FROM Users GROUP BY Name HAVING COUNT(1) > 1) 
```

# php - 将 PHP 变量“11:00 AM”转换为 MySQL 时间格式

> ID：11874330
> 
> 赞同：8
> 
> 时间：2012-08-08T22:47:51.340
> 
> 标签：php, mysql, time

尝试将标准时间变量从表单输入转换为 MySQL INSERT 可接受的 TIME 格式。我可能做错了，可以使用一些帮助。我已经阅读了 MySQL TIME 函数和 PHP TIME 函数，但还没有找到解决方案。

这是我尝试过的示例：

```
<?php
$time_input = '11:00 AM';

$strtotime = strtotime($time_input);

$mysql_time = date('H:m:s',$strtotime);

echo "<p>time_input: $time_input</p>";
echo "<p>strtotime: $strtotime</p>";
echo "<p>mysql_time: $mysql_time</p>";
?> 
```

结果是将时间更改为 11:08:00（不确定 8 分钟的来源）：

```
time_input: 11:00 AM

strtotime: 1344438000

mysql_time: 11:08:00 
```

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-08T22:52:39.157

[`DateTime`](http://php.net/datetime)将为您执行此操作：

```
$time_input = '11:00 AM';
$date = DateTime::createFromFormat( 'H:i A', $time_input);
$formatted = $date->format( 'H:i:s'); 
```

我通常会尽可能避免`strtotime()`，因为它可能有些不可预测。

[您可以在此演示](http://viper-7.com/hrIOLp)中看到它的工作原理。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T22:55:17.190

`m`是带有前导零的月份的格式（8 月，即 08），您想要`i`（带有前导零的分钟）：

```
$mysql_time = date('H:i:s',$strtotime); 
```

[PHP 日期文档](http://php.net/manual/en/function.date.php)

# iphone - 在同一工作区中的项目之间包含标题路径时出错

> ID：11874333
> 
> 赞同：0
> 
> 时间：2012-08-08T22:48:23.873
> 
> 标签：iphone, objective-c, ios, xcode, ios5

我有 5 个项目的工作区，我在一个项目中创建了一个新的视图控制器，当我尝试将该控制器作为标题包含在另一个项目中时，它会抛出错误“找不到文件”我尝试了 [两个项目中给出的步骤xcode4 workspaces (#import failure)](https://stackoverflow.com/questions/5271026/two-projects-in-xcode4-workspaces-import-failure) ，但它仍然不起作用。对此还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T00:12:28.527

在引发错误的顽皮项目的构建设置中，将头文件的路径添加到“用户搜索路径”

# python - 函数似乎返回多个结果或：什么是隐式元组解包

> ID：11874334
> 
> 赞同：1
> 
> 时间：2012-08-08T22:48:25.887
> 
> 标签：python, for-loop

有人可以解释以下代码行吗？它是某种嵌套的for循环吗？如果是这样，有人可以将其重写为等效的嵌套 for 循环。allPositions 参数是一个列表， synapsesPerSegment 是一个 int 变量。

```
for rx,ry in random.sample(allPositions, synapsesPerSegment): 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T22:52:33.687

这是一个正常的循环。没有嵌套。`random.sample`从 中返回一个元素列表，`allPositions`其中包含`synapsesPerSegment`许多项。由于在 for 循环中分配给的变量是 form 中的元组`(rx, ry)`，这表明它`allPositions`是 form 中元组的列表（或集合），`(rx, ry)`它们被分配给每次迭代。如果您有一个元组列表，则 for 循环每次迭代都会将它们“解包”到这些变量中。例如，如果您有`rx``ry`

`(a, b) = (99, 100)`

那么这个分配将解包：

`(c, d) = (a, b)`

所以`c == 99`和`d == 100`。

回到这个问题，这里有一些示例数据：

如果我们说： `allPositions = [(1,100), (2, 200), (3, 300), (4, 400)]`

例如： `synapsesPerSegment = 3`

然后 `random.sample(allPositions, synapsesPerSegment)`可能会产生`[(3, 300), (1,100), (2, 200)]`，因为它随机取 3 个项目`allPositions`。

然后迭代它：

*   迭代 1: `rx = 4`,`ry = 400`
*   迭代 2: `rx = 1`,`ry = 100`
*   迭代 3: `rx = 2`,`ry = 200`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:03:49.683

它不是嵌套循环，它被称为元组解包。它可能会帮助您将其视为大致等同于执行此操作

```
for item in random.sample(allPositions, synapsesPerSegment):
    rx = item[0]
    ry = item[1] 
```

# iphone - Google Analytics 是否在单独的线程中运行？

> ID：11874335
> 
> 赞同：2
> 
> 时间：2012-08-08T22:48:28.360
> 
> 标签：iphone, objective-c, ios, google-analytics

我在 iOS 项目中使用 Google Analytics SDK，我有点担心它的性能问题。我不确定跟踪器调用是否在单独的线程中运行以避免阻塞主线程。

有人知道它是否在一个单独的线程中运行？有没有办法弄清楚？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T22:55:47.907

SDK 使用事件队列，每 X 个事件或秒异步线程与 Google 服务器通信并发送所有队列事件。使用调试模式查看日志。

```
 // Optional: set Google Analytics dispatch interval to e.g. 20 seconds.
  [GAI sharedInstance].dispatchInterval = 20;
  // Optional: set debug to YES for extra debugging information.
  [GAI sharedInstance].debug = YES; 
```

# asp.net - 用于 asp.net 的多个 Web 部署

> ID：11874343
> 
> 赞同：0
> 
> 时间：2012-08-08T22:49:22.913
> 
> 标签：asp.net

我有一个安装在几个不同客户端服务器上的应用程序。它们每个都有不同的 web.config 文件和不同的虚拟文件夹。目前我正在编译、手动复制、设置 IIS、更改 web.config 并为每次安装添加虚拟文件夹，并在更新时再次添加。

我根本不知道如何使用诸如 Web Deploy 或 Deployment Package 之类的东西进行部署，这将让我创建不同的配置文件或如何管理虚拟文件夹（我假设我只会部署空文件夹并且仍然需要手动完成这部分）。我可以从一开始就设置 IIS 和虚拟文件夹，但我希望每个客户端都能够下载新版本并在没有我输入的情况下安装它们（因为有些客户端对远程访问很有趣）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:16:59.600

我不喜欢 Web Deploy 和其他方案，因为与桌面不同，Web 服务器都倾向于具有独特的配置。

就我而言，我们所有的 Web 应用程序都使用自定义编写的 VBScripts 进行部署（比批处理文件更令人愉快，并且无需重新学习 PowerShell）。VBScript（及其默认的 COM 对象库）为编写部署脚本提供了一个引人注目的平台。如果您不能忍受语法，您可以使用相同的工具使用 JScript。奖励：Visual Studio 仍然提供 Windows 脚本 IntelliSense，尽管它不是广告功能）。

我最近的部署脚本很简单：它是一个 VBScript（由 VS 的 Post-build 命令行调用），它使用 7-Zip 打包 Web 应用程序的文件，然后生成一个`ftp.exe`批处理文件（然后运行 ​​ftp.exe 本身）上传文件到服务器，它还会生成一个名为“Unpack.cmd”的文件，该文件会调用 7-Zip 将文件提取到正确的位置。唯一的手动步骤是在服务器上执行 Unpack.cmd，但例如可以使用远程 PowerShell 来完成。

为什么需要独立于应用程序自定义 IIS 配置？你不能把你的`web.config`文件里的所有东西都放在下面`<system.webServer>`吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:10:38.747

您可以为每个环境设置构建配置。通常，您可以获得开箱即用的 Debug 和 Release。我喜欢用 Development、Staging 和 Production 配置替换它们，这允许每个环境使用不同的 web.config。

当然，在发布的时候，你还是要确保你选择了正确的配置。

# android - getXidKey() 在 API 低于 16 时返回 null。Android Xtify SDK GCM 实现

> ID：11874344
> 
> 赞同：0
> 
> 时间：2012-08-08T22:49:27.063
> 
> 标签：android, xtify

我们已经实现了 Xtify SDK 2.1.0.2，它在 API 16 上完美运行。如果我在任何 API 级别低于 16 的 AVD 上运行它，它不会注册，我也不会得到 xtify XID。

```
XtifySDK.start(getApplicationContext(), XTIFY_APP_KEY, SENDER_ID);
XtifySDK.getXidKey(getApplicationContext()); // returns null
XtifySDK.isNotificationEnabled(getApplicationContext(); // returns true 
```

我们重新检查了实施指南，似乎没有任何遗漏。我们甚至在项目中添加了 GSM 库，但没有帮助。

我还需要做些什么才能使其正常工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T22:24:02.607

我已经确认示例应用程序在 API 级别 8 上运行正常。您需要使用目标名称 Google API（不是 Android）、API 级别 8 设置 AVD。您还必须确保在 AVD 之后添加您的 gmail 帐户发射。

# powershell - Powershell从文件中提取值

> ID：11874345
> 
> 赞同：0
> 
> 时间：2012-08-08T22:49:37.960
> 
> 标签：powershell

我有一个日志文件，其中列出了很多字段。我想从文件中提取字段，但我不想逐行搜索文件。

我有我的模式：

```
$pattern="Hostname \(Alias\):(.+)\(.+Service: (.+)" 
```

这将为我提供我需要的两个值。我知道如果我有一个字符串，并且我正在寻找一个匹配项，我可以使用 $matches 数组来查找字段。换句话说，如果我使用字符串变量 $line 查看文件中的一行，我可以使用此代码提取字段。

```
if($line -matches $pattern){
  $var1=$matches[1]
  $var2=$matches[2]
} 
```

但是如何在不逐行搜索的情况下获得这些值？我想将整个文件作为单个字符串传递，并将我提取的值添加到两个不同的数组中。

我正在寻找类似的东西

```
while($filetext -match $pattern){
  $array1+=$matches[1]
  $array2+=$matches[2]
} 
```

但是，如果只有一个匹配项，这段代码就会让我陷入无限循环。那么有没有可以使用的 nextMatch 函数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T02:49:46.890

PowerShell 2.0 通过将`-AllMatches`参数添加到`Select-String`cmdlet 来解决此限制，例如：

```
$filetext | Select-String $pattern -AllMatches | 
    Foreach {$_.Matches | Foreach {$_.Groups[1] | Foreach {$_.Value}}} 
```

# android - 平板电脑检测同步数字问题

> ID：11874348
> 
> 赞同：3
> 
> 时间：2012-08-08T22:49:59.253
> 
> 标签：android, eclipse, driver, detection, tablet

我和我的同事必须为一家公司在 Android 平板电脑上开发和实现一个应用程序。我们使用 Eclipse AVD 开始并几乎完成了有问题的应用程序的开发（我们还没有收到平板电脑）并且它运行良好。

我们收到了必须安装应用程序的平板电脑，型号：SynchroDigital INOSOP10-4.0 RES，10" 带 ICS，不到 100 欧元，非常便宜。

我们的问题：我的电脑无法识别平板电脑（WIN7，连接时无法安装驱动，虽然我已经在Galaxy S和Galaxy Tab上开发成功了）。当我激活大容量存储时，我可以访问存储空间，但它不被识别为平板电脑，因此它无法直接从 Eclipse 编译，设备列表中没有任何内容。

启用 USB 调试不会改变任何东西。
连接平板电脑时，logcat 中没有任何活动。
在设备管理中，我在其他设备/Android 下找到了带有黄色三角形的平板电脑。制造商的网站提供“支持”部分，但没有指向驱动程序的链接。
用另一台电脑试了，结果一样。

有任何想法吗？是否有可能某些平板电脑不允许直接从 Eclipse 开发？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-08T23:43:46.997

首先，这是一个驱动问题。不幸的是，如果没有司机，你会很不走运。

您可以尝试从最简单到最困难的几件事：

1.  如果你办公室里有 MAC，试试看，你通常不需要驱动程序。
2.  如果设备已root，则可以无线使用ADB
3.  您可以尝试修改 google android 驱动程序（见下文）

**编辑**此方法在 Windows 上可靠地工作。如果您运行的是 Windows 8，则必须重新启动进入高级启动菜单并禁用驱动程序签名才能安装修改后的驱动程序。

Google 将 Nexus 设备的 USB 驱动程序作为 SDK 的一部分。如果您尚未从 SDK 管理器安装 Google USB 驱动程序包，请执行此操作。

从 SDK 文件夹中，我在这里看到了驱动程序：/android-sdk-windows/google-usb-driver/

打开 android_winusb.inf，您可以看到 Nexus One 的示例条目：

```
;Google Nexus One
%SingleAdbInterface%        = USB_Install, USB\VID_18D1&PID_0D02
%CompositeAdbInterface%     = USB_Install, USB\VID_18D1&PID_0D02&MI_01
%SingleAdbInterface%        = USB_Install, USB\VID_18D1&PID_4E11
%CompositeAdbInterface%     = USB_Install, USB\VID_18D1&PID_4E12&MI_01 
```

**注意**此条目位于两个位置（32 位驱动程序和 64 位驱动程序部分）。我们将创建一个新条目，但我们的条目很可能只有 2 个硬件 ID。因此，在 [Google.NTx86] 部分下，创建一个条目：

```
;SynchroDigital INOSOP10-4.0 RES
%SingleAdbInterface%        = USB_Install, 
%CompositeAdbInterface%     = USB_Install, 
```

现在我们需要填补空白。

*   打开设备管理器
*   转到其他设备/Android 并打开带有黄色三角形的条目
*   转到详细信息选项卡
*   从属性下拉列表中选择硬件 ID

看起来熟悉？示例：USB\VID_0BB4&PID_0CBB&MI_01

将这些复制并粘贴到适当的位置：

```
;SynchroDigital INOSOP10-4.0 RES
%SingleAdbInterface%        = USB_Install, USB\VID_0BB4&PID_0CBB&MI_01
%CompositeAdbInterface%     = USB_Install, USB\VID_0BB4&PID_0CBB&REV_0228&MI_01 
```

**注意**我认为粘贴这些硬件 ID 的位置并不*重要*，我*认为*变量名称只是为了美观。我可能是错的，我不写 Windows 驱动程序。

现在将整个条目复制并粘贴到 [Google.NTamd64] 部分。全部完成，尝试更新驱动程序，看看它是否接受它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-29T19:07:11.390

我想在“错误 454”答案中再添加一件事，这对我有用。如果你只是去设备管理器并说“更新驱动程序”它不会工作（对我来说不是）。

在上面的程序之后，我执行了“echo 0xYYYY >>”%USERPROFILE%.android\adb_usb.ini”命令（其中 YYYY 是来自 VID_0BB4 的四位数字。在这种情况下，它将是“echo 0x0BB4 >>”%USERPROFILE%.android \adb_usb.ini”），然后进入设备管理器并在更新驱动程序中选择“浏览我的计算机以查找驱动程序软件”，然后选择“让我从计算机上的设备驱动程序列表中选择”。之后，单击浏览并选择“android_winusb.inf”。它会说驱动程序没有数字签名，但忽略警告并继续。

在此之后，执行 adb kill-server 然后 adb devices 你的设备应该在列表中。

我有便宜的 Prestigio PMP3370B 平板电脑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-29T23:33:42.303

几乎也可以与 Prestigio PMP5101C QUAD 一起使用.....驱动程序似乎可以工作，但我不得不：

1.  再做一次，但这次是在 MTP 模式下（第一次是在大容量存储模式下，这意味着两个条目，每个条目都有不同的 PID）。（这并没有解决它，但意味着它在 MTP 模式下的 Windows 中报告为正常）
2.  然后按照这个[http://blog.itfiser.cz/android-adb-with-prestigio-multipad-pmp5080cpro-and-win7/](http://blog.itfiser.cz/android-adb-with-prestigio-multipad-pmp5080cpro-and-win7/)

2\. 中使用的供应商 ID 是 0x2207

值得指出的是，如果您升级安装在 PC 上的 Android 版本，它将破坏您在 2 中添加的条目。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-27T09:46:09.647

修改后的驱动程序在我的 Prestigio PMP5770D 平板电脑和朋友的 Coby Kyros MID7042 上都非常有效。谢谢

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-30T19:37:46.210

与 Synchro Digital 无关......但对于那些（像我一样）正在搜索如何使**PMP5101C_QUAD**驱动程序工作并偶然发现这篇文章的人：在“android_winusb.inf”中，我必须添加：

%SingleAdbInterface% = USB_Install, USB\VID_2207&PID_0011&REV_0222&MI_01 %CompositeAdbInterface% = USB_Install, USB\VID_2207&PID_0011&MI_01

请注意，如果您以错误的顺序添加它们，例如：

%SingleAdbInterface% = USB_Install, USB\VID_2207&PID_0011&MI_01
%CompositeAdbInterface% = USB_Install, USB\VID_2207&PID_0011&REV_0222&MI_01

**adb 不会将其识别**为PMP5101C_QUAD 设备。

# java - JPA如何将非托管实体对象与数据库同步（按值调用）

> ID：11874356
> 
> 赞同：0
> 
> 时间：2012-08-08T22:50:47.680
> 
> 标签：java, jpa, jpa-2.0

以下问题：

关系： |店铺| --1--------n--> |产品|

所以我有一个实体名为 shop 可以有很多产品。

我开发了一个名为**void addProductToShop(Shop shop, Product product);的函数。**

它看起来像这样：

```
public void addProductToShop(Shop shop, Product product)
{
    entityManager = entityManagerFactory.createEntityManager();
    entityManager.getTransaction().begin();

    shop = entityManager.merge(shop);
    shop.getProductList.add(product);

    entityManager.getTransaction().commit();
    entityManager.close();
} 
```

一切正常，并正确写入数据库。问题是，我的应用程序代码中没有更新这两个实体。

所以在调用**addProductToShop(shop, product);** 您必须更新**shop**和**product**这两个变量，因为它们没有最新的更改（因为 callByValue）。

但是作为这个函数的使用者，我假设我的参数在调用之后发生了变化，而不仅仅是数据库。如何在每次函数调用后不要求更新**商店**和**产品的情况下实现这一点。**

有没有最佳实践？

谢谢，亚历克斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T08:53:30.317

我知道了。

我的错误是我应该首先从参数中更改实体，**然后**进行合并...

因此参数具有与合并实体相同的状态。

推理中的小错误...

问候，亚历克斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:07:42.087

我认为 entityManager.refresh(Object) 是您需要为商店和产品调用的内容。

# powershell - 启动过程：访问被拒绝（即使我提供了凭据

> ID：11874357
> 
> 赞同：9
> 
> 时间：2012-08-08T22:50:53.727
> 
> 标签：powershell, permissions

尝试执行一行代码时出现以下错误

```
Start-Process : This command cannot be executed due to the error: 
Access is denied. 
```

这是正在执行的代码

```
$username = "domain\username"
$passwordPlainText = "password"     
$password = ConvertTo-SecureString "$passwordPlainText" -asplaintext -force
$cred = New-Object -TypeName System.Management.Automation.PSCredential -argumentlist $username,$password

$powershellArguments = "D:\path\ps.script.ps1", "arg1", "arg2", "arg3", "arg4"
Start-Process "powershell.exe" -credential $cred -ArgumentList $powershellArguments -wait 
```

*   此代码在本地执行时工作正常，但在通过 vbs WMI 调用时不能正常工作
*   两台计算机存在于相同的域和地址范围内
*   提供的用户名和密码在两台机器上都具有管理员权限
*   我已经尝试了有和没有`-wait`但都没有工作，并且由于用户具有特权，我更愿意保留它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T22:53:36.177

问：您是否尝试过不使用“-wait”？

看看这个链接：

> *   [http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/3983a1e4-a663-47df-86f6-874d1828ea61/](http://social.technet.microsoft.com/Forums/en-US/winserverpowershell/thread/3983a1e4-a663-47df-86f6-874d1828ea61/)
> 
> 参数“-wait”抑制命令提示符或保留窗口直到进程完成。此操作可能需要管理员权限。

# iphone - 将 NSData 复制到 int32_t 变量中

> ID：11874359
> 
> 赞同：0
> 
> 时间：2012-08-08T22:51:06.117
> 
> 标签：iphone, ios, nsdictionary

我有一个很大的 NSDictionary，里面全是 NSData 类型的条目。我有几个条目需要是 int32_t 类型的，但是我不是 100% 确定如何将 NSDictionary 条目中的数据复制到..

是否像执行以下操作一样简单 -

***。H***

```
//..
int32_t myint;
}
@property (assign) int32_t myint;
//.. 
```

***.m***

```
//..
@synthesize cardID;
//..
- (void)assignSearchData:(NSData*)searchData
{
myint = [searchData objectForKey:@"IntKey"];
}
//.. 
```

还是我需要在我的方法中进行某种类型的数据转换？

还有一个小问题，我什至正确地声明了 int32_t 吗？我已经在文档和这里寻找了一个例子，但我很难找到一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:29:26.630

好吧，您可以直接访问数据对象中的原始字节。

```
void const *dataPtr = [data bytes]; 
```

现在您有了指向原始内存的指针，您可以随意复制它（这些规则适用于任何数据传输，而不仅仅是 iOS）。如果需要考虑对齐边界，则需要使用 memcpy。

```
int32_t myInt;
memcpy(&myInt, dataPtr); 
```

否则，如果在允许跨对齐边界进行整数操作的架构上......

```
int32_t myInt = *(int32_t const *)dataPtr; 
```

现在，ARM 支持跨对齐边界访问，但速度要慢得多。我没有进行性能比较，但是您不会继续使用错误对齐的指针，因此它可能比 memcpy 函数调用更好（不过，老实说，这对您来说可能是太多的性能考虑）。

最大的问题是数据的字节顺序。如果它是由您提供的，那么您可以随心所欲，但您应该更喜欢一种标准。

如果它来自第三方，它可能是网络字节顺序（又名大端）。您可能需要转换为您的主机字节序表示。`hton`幸运的是，这对和`ntoh`他们的朋友来说是直截了当的。

FWIW，Intel 是 little-endian，网络字节序是 big-endian，现代 Mac 和 iOS 设备是 little-endian，较旧的 Mac 是 big-endian。

```
// Convert from network order to host order.
// Does the right thing wherever your code is running
myInt = ntohl(myInt); 
```

简而言之，无论...

```
int32_t myInt = ntohl(*(int32_t const *)[data bytes]); 
```

或者

```
int32_t myInt;
memcpy(&myInt, [data bytes);
myInt = ntohl(myInt); 
```

所以，数据必须以某种方式进入那里。是，逆...

```
int32_t myInt = 42;
myInt = htonl(myInt);
NSData *data = [NSData dataWithBytesNoCopy:&myInt length:sizeof(myInt) freeWhenDone:NO]; 
```

当然，使用正确的 Data 初始化器......它只会使用堆栈上的那些原始字节，所以你最好不要在堆栈展开后使用它。

您不必担心发送数据的对齐问题，除非您向接收者保证数据将与某个边界对齐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:06:04.050

是的，int32_t 很好。所以你有一连串的再见。您需要知道的是他的字节布局是什么。如果您知道数据是什么，那么构建它将非常容易。

给定一个长度为 4（int32_t 大小）的 NSData 对象，那么您将：

```
int32_t val;
if([data length] == sizeof(uint32_t)) {
    void *bytes = [data bytes];
    // if the layout is same as iOS then
    memcpy(&val, bytes, sizeof(int32_t) );
} 
```

如果不是这种情况，那么您可以尝试：

```
unsigned char val[4] = {0,0,0,0};
if([data length] == sizeof(uint32_t)) {
    memcpy(val, bytes, sizeof(int32_t) );
    then rearrange the bytes
} 
```

# php - phpmyadmin。自动登录

> ID：11874360
> 
> 赞同：0
> 
> 时间：2012-08-08T22:51:12.330
> 
> 标签：php, mysql, phpmyadmin

我正在使用 phpmyadim。是否可以跳过登录页面使其自动登录。我不想使用浏览器记住密码。我需要任何访问网页的用户都应该能够查看数据库条目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T22:56:26.347

[http://wiki.phpmyadmin.net/pma/Auth_types#config](http://wiki.phpmyadmin.net/pma/Auth_types#config)

> auth_type = 'config' 是最基本的认证方式。用户名和密码存储在 phpMyAdmin 配置文件中。它适用于故障排除和单用户安装，其中“root”（或一些类似的超级用户）用于所有管理工作。Config 没有密码保护 phpMyAdmin；任何访问正确 URL 的人都直接登录并可以操纵您的服务器。
> 
> 如果您使用配置，还请将您的服务器置于防火墙后面或使用您的网络服务器的身份验证（例如 Apache .htaccess 文件）来限制对您数据的访问。
> 
> 在 config.inc.php 中，还填写用户和密码的值。

请相应地保护您的安装

# ruby-on-rails - 无法显示来自 Rails ActiveRecord 的文本 errors.full_message

> ID：11874361
> 
> 赞同：0
> 
> 时间：2012-08-08T22:51:18.813
> 
> 标签：ruby-on-rails, validation, activerecord

好的，我整天都在查看结果（包括在 StackOverflow 上搜索）...

在 Rails 3.2.X 和 Ruby 1.9.3 中，我有一个远程表单。表单工作正常，有效时保存，无效时不保存。但是我无法找回实际的错误（我尝试了很多不同的方法）。

### 这是表格（haml）

```
= form_for @lead, :remote => true, :validate => false do |f|
    .span6
        %ul
            %li
                = f.label "Name*"
                = f.text_field :name
            %li
                = f.label "Company*"
                = f.text_field :company
...
            %li
                = f.label :state
                = select_tag :state, options_for_select(us_states)
            %li
                = f.label "Email*"
                = f.text_field :email
    .actions
        = f.submit '', :id => "contactsubmit" 
```

这是控制器中的相关位置：

```
def create
    @lead = Lead.new(params[:lead])

    respond_to do |format|
        if @lead.valid?
         format.js
        else
         format.js
        end
    end
end 
```

### 这是我一直失败的观点（create.js.erb）......

```
<% if @lead.errors.count == 0 %>
    $('#error_explanation').fadeOut(500);
    $('#learn-more .form').fadeOut(500, function() {
        $('#learn-more #form-response').fadeIn(500);
      });
<% else %>
      $('#error_explanation').fadeIn(500);
        <% @lead.errors.full_messages.each do |msg| %>
           #never shows any messages. If I do @lead.errors.each do |error| 
           #it shows the field name, but not the body...?
           $('#error_explanation').append('<%=content_tag(:p, msg)%>');
        <% end %>
<% end %> 
```

我知道那里的评论无效，我添加它以显示我尝试过的内容。我已经尝试了*一百万种不同的方式*在这里显示错误消息。其他一切都在工作。我什至在其中添加了一个计数器（不使用 msg 时），它确实显示了四个字段错误。有什么建议吗？在另一个项目中使用类似的代码（在传统视图中）没有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:44:39.947

确保您在`escape_javascript`遇到此类问题时使用。任何可能在内容中或由类似方法生成的引号都可能`content_tag`破坏您的 JS。

# android - Horizo ntalScrollView 在视图之间添加空间

> ID：11874362
> 
> 赞同：2
> 
> 时间：2012-08-08T22:51:21.330
> 
> 标签：android, horizontalscrollview

我有 Horizo​​ntalScrollView，问题是添加视图后，这些视图之间有空格。这是一张图片：
![在此处输入图像描述](../Images/5f5f3536f947390ad06f6932844703e9.png)

这是该类的代码：

```
public class HomeFeatureLayout extends HorizontalScrollView {
    public HomeFeatureLayout(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public HomeFeatureLayout(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public HomeFeatureLayout(Context context) {
        super(context);
    }

    public void setFeatureItems() {
        LinearLayout internalWrapper = new LinearLayout(getContext());
        internalWrapper.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
        internalWrapper.setOrientation(LinearLayout.HORIZONTAL);
        addView(internalWrapper);
        // this.mItems = items;
        for (int i = 0; i < 10; i++) {
            ImageView im = new ImageView(getContext());
            im.setImageResource(R.drawable.aaaa);
            im.setScaleType(ScaleType.CENTER_INSIDE);
            im.setLayoutParams(new LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.MATCH_PARENT));

            internalWrapper.addView(im);
        }
    }
} 
```

和 MainActivity：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        HomeFeatureLayout home = new HomeFeatureLayout(this);
        home.setFeatureItems();
        home.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));

        setContentView(home);

    } 
```

为什么每2个图像之间有空格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T09:01:26.537

[我必须在这个](https://stackoverflow.com/questions/7420060/make-children-of-horizontalscrollview-as-big-as-the-screen)问题的帮助下创建自己的视图并扩展 ImageView，然后覆盖 OnMeasure 方法：

```
public class myImageView extends ImageView {

    public myImageView(Context context) {
        super(context);
        // TODO Auto-generated constructor stub
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        MeasureSpec.getSize(widthMeasureSpec);
        MeasureSpec.getSize(heightMeasureSpec);
        setMeasuredDimension(measureWidth(widthMeasureSpec), measureHeight(heightMeasureSpec));

        setLayoutParams(new LinearLayout.LayoutParams(measureWidth(widthMeasureSpec), measureHeight(heightMeasureSpec)));

        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
    }

    public int measureWidth(int measureSpec) {
        int result = 0;
        int specMode = MeasureSpec.getMode(measureSpec);
        int specSize = MeasureSpec.getSize(measureSpec);
        Display display = ((WindowManager) getContext().getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
        int screenWidth = display.getWidth();

        if (specMode == MeasureSpec.EXACTLY)
            // We were told how big to be
            result = specSize;
        else {
            // Measure the view
            result = screenWidth;
            if (specMode == MeasureSpec.AT_MOST)
                // Respect AT_MOST value if that was what is called for by measureSpec
                result = Math.min(result, specSize);
        }

        return result;
    }

    public int measureHeight(int measureSpec) {
        int result = 0;
        int specMode = MeasureSpec.getMode(measureSpec);
        int specSize = MeasureSpec.getSize(measureSpec);
        Display display = ((WindowManager) getContext().getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();
        int screenHeight = display.getHeight();

        if (specMode == MeasureSpec.EXACTLY)
            // We were told how big to be
            result = specSize;
        else {
            // Measure the view
            result = screenHeight;
            if (specMode == MeasureSpec.AT_MOST)
                // Respect AT_MOST value if that was what is called for by measureSpec
                result = Math.min(result, specSize);
        }

        return result;
    }

} 
```

# google-docs-api - Google Drive 不再显示嵌入的图像

> ID：11874365
> 
> 赞同：4
> 
> 时间：2012-08-08T22:51:35.833
> 
> 标签：google-docs-api, google-drive-api

自 2012 年 8 月 7 日起，Google Drive 不再显示由 Google Drive 网页或 API 上传的文档中的图像。

我正在使用 google Docs API 上传引用来自 Internet 的公共图像的 HTML 文件。API 将 HTML 转换为 Google 文档并很好地显示图像。昨天突然这个行为不再可用了！Google Doc 将显示一个带有旋转图标的灰色框（图像大小相同）。

即使我使用Google Drive 网站中的**上传功能上传 Word (.docx) 文档，我也意识到这种情况正在发生。**

任何解决方法的想法？谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T17:25:58.097

当我上传图片并说转换为谷歌文档格式时，我遇到了同样的问题。当我不转换时它工作正常。

# c# - system.drawing.imaging 的质量和压缩之间的区别？

> ID：11874368
> 
> 赞同：11
> 
> 时间：2012-08-08T22:51:55.817
> 
> 标签：c#, asp.net, image-processing, system.drawing, system.drawing.imaging

我对 ASP.NET 中的图像处理完全陌生。我对 Photoshop 非常熟悉，并且在某种程度上熟悉图像魔法。

我试图弄清楚质量和压缩之间的区别是什么，因为其他应用程序倾向于将它们视为相同。使用 system.drawing.imaging 有质量和压缩设置。

[http://msdn.microsoft.com/en-us/library/system.drawing.imaging.encoder.quality.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.encoder.quality.aspx)写道：“质量类别指定图像的压缩级别。”

[http://msdn.microsoft.com/en-us/library/bb882583.aspx](http://msdn.microsoft.com/en-us/library/bb882583.aspx)写道：“质量等级 0 对应于最大压缩，质量等级 100 对应于最小压缩。”

该文档似乎可以互换使用质量和压缩。但是，每个都有设置。有什么不同？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-08T23:00:10.557

编码器参数的`Quality`值介于 0-100 之间，这将指示可以应用于某些编码器的压缩*量，0 表示最大压缩，100 表示最小压缩。*

`Compression`编码器参数指定应用于某些编码器的压缩类型*。*此值取决于编解码器，但（理论上）GIF 编码器可能具有 VersionGif87 或 VersionGif89 作为可能的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T23:00:19.637

质量编码参数是您所期望的，并且引用了一个 0-100 之间的值，它告诉处理器您希望以什么质量保存图像。Compression 参数定义编码器将使用的压缩*类型。*以下是所有有效的压缩类型：http: [//msdn.microsoft.com/en-us/library/system.drawing.imaging.encodervalue.aspx](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.encodervalue.aspx)

希望这可以帮助。

# django - Django缓存一个大列表

> ID：11874377
> 
> 赞同：5
> 
> 时间：2012-08-08T22:52:56.130
> 
> 标签：django, caching, memcached, deserialization, pickle

我的 django 应用程序处理 25MB 的二进制文件。它们每个都有大约 100,000 条“记录”，每条 256 字节。

从磁盘读取二进制文件并使用 python 的 struct 模块对其进行解码大约需要 7 秒。我将数据转换成一个包含大约 100,000 个项目的列表，其中每个项目都是一个包含各种类型（浮点数、字符串等）值的字典。

我的 django 视图需要搜索此列表。显然 7 秒太长了。

我尝试使用 django 的低级缓存 API 来缓存整个列表，但这不起作用，因为任何单个缓存项的最大大小限制为 1MB。我尝试单独缓存 100,000 个列表项，但这需要超过 7 秒的时间 - 大部分时间都花在解开这些项目上。

有没有一种方便的方法可以在请求之间将大列表存储在内存中？你能想出另一种方法来缓存我的 django 应用程序使用的对象吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-13T11:04:40.663

编辑项目大小限制为10m（大于1m），添加

```
-I 10m 
```

到 /etc/memcached.conf 并重新启动 memcached

还在 /usr/lib/python2.7/dist-packages/django/core/cache/backends 中的 memcached.py 中编辑此类，如下所示：

```
class MemcachedCache(BaseMemcachedCache):
"An implementation of a cache binding using python-memcached"
def __init__(self, server, params):
    import memcache
    memcache.SERVER_MAX_VALUE_LENGTH = 1024*1024*10 #added limit to accept 10mb
    super(MemcachedCache, self).__init__(server, params,
                                         library=memcache,
                                         value_not_found_exception=ValueError) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-23T15:33:24.120

我还不能添加评论，但我想分享我对这个问题的快速修复，因为当你更改`SERVER_MAX_VALUE_LENGTH`at import 时间时，python-memcached 的行为异常我遇到了同样的问题。

好吧，除了`__init__`FizxMike 建议的编辑之外，您还可以在同一类中编辑 _cache 属性。这样做可以实例化`server_max_value_length`显式传递的 python-memcached 客户端，如下所示：

```
from django.core.cache.backends.memcached import BaseMemcachedCache

DEFAULT_MAX_VALUE_LENGTH = 1024 * 1024

class MemcachedCache(BaseMemcachedCache):
    def __init__(self, server, params):
        #options from the settings['CACHE'][connection]
        self._options = params.get("OPTIONS", {})
        import memcache
        memcache.SERVER_MAX_VALUE_LENGTH = self._options.get('SERVER_MAX_VALUE_LENGTH', DEFAULT_MAX_VALUE_LENGTH)

        super(MemcachedCache, self).__init__(server, params,
                                             library=memcache,
                                             value_not_found_exception=ValueError)

    @property
    def _cache(self):
        if getattr(self, '_client', None) is None:
            server_max_value_length = self._options.get("SERVER_MAX_VALUE_LENGTH", DEFAULT_MAX_VALUE_LENGTH)
            #one could optionally send more parameters here through the options settings,
            #I simplified here for brevity
            self._client = self._lib.Client(self._servers,
                server_max_value_length=server_max_value_length)

        return self._client 
```

我也更喜欢创建另一个继承自 BaseMemcachedCache 的后端并使用它而不是编辑 django 代码。

这是 django memcached 后端模块供参考： [https ://github.com/django/django/blob/master/django/core/cache/backends/memcached.py](https://github.com/django/django/blob/master/django/core/cache/backends/memcached.py)

感谢您对此线程的所有帮助！

# c++ - 将向量传递给函数并返回向量并重铸

> ID：11874378
> 
> 赞同：1
> 
> 时间：2012-08-08T22:52:56.290
> 
> 标签：c++, matlab, pointers, vector, mex

我正在使用 MEX 将我的 C++ 代码与 MATLAB 接口。我的 C++ 代码要求输出类型为 vector 。由于我是 C++ 新手，我对指针的工作方式非常困惑。我将从 MATLAB 获取一个输入数组

```
int *data_array_ptr
data_array_ptr=(int *)mxGetData(prhs[0]);
a = mxGetM(prhs[0]);
int int_data[a];
copy(*data_array_ptr, *data_array_ptr+ a, int_data); 
```

现在，int_data 应该包含存储在 data_array_ptr 位置的所有数据......它这样做了吗？

然后，

```
double *data_out_ptr;

plhs[0]= mxCreateDoubleMatrix( (mwSize)m, (mwSize)n, mxREAL); 
data_out_ptr= mxGetPr(plhs[0]);
len6=mxGetM(plhs[0]);
vector<double> data_out_data(*data_out_ptr,*data_out_ptr+len6); 
```

这应该将空输出矩阵的内容放入名为 data_out_data 的向量中。它这样做吗？

然后，我想将 data_out_data 和 int_data 都传递给 c++ 函数。但是，我想将 data_out_data 作为指针传递，以便 c++ 函数将用数据填充向量，然后当函数完成时，MEX 函数将看到现在填充的向量并能够将其转换回双精度数组可以填充plhs[0]。

所以，像

```
mexFunction(plhs[],prhs[]){

int *data_array_ptr
data_array_ptr=(int *)mxGetData(prhs[0]);
a = mxGetM(prhs[0]);
int int_data[a];
copy(*data_array_ptr, *data_array_ptr+ a, int_data);

 double *data_out_ptr;
plhs[0]= mxCreateDoubleMatrix( (mwSize)m, (mwSize)n, mxREAL); 
data_out_ptr= mxGetPr(plhs[0]);
len6=mxGetM(plhs[0]);
vector<double> data_out_data(*data_out_ptr,*data_out_ptr+len6);

foo(int_data, *data_out_data)

copy(data_out_data.begin(), data_out_data.end(), data_out_ptr);
} 
```

并且在 foo 返回时， data_out_data 将被填充。我的函数没有返回参数 data_out_data 必须是向量类型。如何将向量传递给 foo 以便 foo 可以编辑数据？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:20:51.347

我不确定我是否正确理解了您的问题。我相信您想将一个数组从 MATLAB 传递给您的 mex 函数，然后 mex 函数调用一个对该数据数组进行操作的 C++ 函数，以及一个`vector`. then 包含 C++ 函数执行的任何操作的`vector`结果，并且您希望将此数据传递回 MATLAB。

* * *

首先，让我们处理从 MATLAB 获取数据到您的 MEX 函数

```
int const *data_in = static_cast<int const *>(mxGetData(prhs[0])); 
```

现在，`data_in`指向您传入的数据。顺便问一下，您确定数组包含`int`s 吗？默认情况下，MATLAB`double`用于所有内容。

你的 C++ 函数会修改这个数组吗？如果没有，您可以只使用指针和元素数调用它，而不是执行复制。

例如，如果 的签名`foo`是

```
foo( int const *data_in, mwSize num_data_in, std::vector<double> *data_out ); 
```

你可以称之为

```
foo( data_in, mxGetNumberOfElements(prhs[0]), &data_out ); 
```

如果您确实需要修改数据，并且/或者不能修改`foo`，只需创建一个向量来保存数据的副本。

```
std::vector<int> data_in_vec( data_in, data_in + mxGetNumberOfElements(prhs[0]) );
foo( data_in_vec.data(), data_out ); 
```

* * *

至于`foo`函数，在调用它之前是否需要正确调整向量的大小？如果是这样，

```
std::vector<double> data_out( m * n );  // creates a vector with m * n elements
foo( data_in_vec.data(), &data_out ); 
```

如果可能，修改`foo`以接受 a`std::vector<double>&`而不是`std::vector<double> *`. 然后你可以称它为

```
foo( data_in_vec.data(), data_out ); 
```

此外，如果可以选择，我会`foo`根据需要调整向量的大小，而不是要求调用者这样做。

* * *

现在，将数据返回到 MATLAB。

```
plhs[0] = mxCreateDoubleMatrix( m, n, mxReal );
std::copy( data_out.data(), data_out.data() + data_out.size(), mxGetPr(plhs[0]) ); 
```

上述行假设向量的大小不大于`m * n`

请记住，与 C 和 C++ 不同，MATLAB 以列优先格式存储矩阵。根据`foo`函数的工作方式，您可能必须转置返回的向量，在这种情况下，您不能用于`std::copy`复制，您必须编写嵌套循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:15:11.670

您对指针的取消引用超出了应有的范围...

```
int *data_array_ptr;
// ...
copy(*data_array_ptr, *data_array_ptr+ a, int_data); 
```

当您被要求提供指向 的开始和结束指针时`copy`，您需要执行以下操作：

```
copy(data_array_ptr, data_array_ptr+ a, int_data); 
```

现在您已经提供了两个内存地址。第一个，`data_array_ptr`，是数组的起始地址。第二个`data_array_ptr+a`是数组末尾之后的元素地址。

如果您取消引用指针 ( `*data_array_ptr`)，那么您要求的是数组第一个元素的*值*(an `int`)。同样，`*data_array_ptr+a`将首先获取第一个数组元素的值，然后添加`a`到它。这不是你想要的。

因此，按照建议更改所有调用`copy`以及`vector`构造函数。

至于你关于你的`foo`函数的问题，如果你需要传递一个向量，那么像这样声明它：

```
void foo( int * int_data, std::vector<double> & data_out_data ) 
```

假设您在上面提供了这些变量的定义。我认为您是这样称呼的：

```
// ...

int int_data[a];
copy(*data_array_ptr, *data_array_ptr+ a, int_data);

// ...

vector<double> data_out_data(data_out_ptr, data_out_ptr+len6);

// ...

foo( int_data, data_out_data ); 
```

请注意，如果您不知道`int_data`内部数组的长度`foo`（基于 的长度`data_out_data`），您还应该在参数列表中要求一个大小`foo`：

```
foo( int_data, a, data_out_data ); 
```

# sql - Perl DBI - 在两个 sql 服务器之间传输数据 - fetchall_arrayref

> ID：11874388
> 
> 赞同：0
> 
> 时间：2012-08-08T22:54:38.670
> 
> 标签：sql, sql-server, perl, dbi, dbix-class

我有 2 台服务器：dbh1 和 dbh2，我在其中查询 dbh1 并通过 fetchall_arrayref 方法提取数据。执行查询后，我想将 dbh1 的输出插入到服务器 dbh2 上的临时表中。

我能够同时建立对两台服务器的访问权限，并且能够从两者中提取数据。1.我从dbh1拉数据：

```
while($row = shift(@$rowcache) || shift(@{$rowcache=$sth1->fetchall_arrayref(undef, $max_rows)})) {
        #call to sub insert2tempData
        &insert2tempData(values @{$row});
} 
```

2\. 然后在 dbh2 上我有一个插入查询：

```
 INSERT INTO ##population (someid, Type, anotherid)
    VALUES ('123123', 'blah', '634234'); 
```

问题：如何将 dbh1 中的 fetchall_arrayref 的批量结果插入到服务器 dbh2 上的临时表中（不循环单个记录）？

好的 - 所以我能够解决这个问题并能够实现以下代码：

```
 my $max_rows = 38;
my $rowcache = [];
my $sum   = 0;

if($fldnames eq "ALL"){ $fldnames = join(',', @{ $sth1->{NAME} });}

my $ins = $dbh2->prepare("insert into $database2.dbo.$tblname2 ($fldnames) values $fldvalues");

my $fetch_tuple_sub = sub { shift(@$rowcache) || shift(@{$rowcache=$sth1->fetchall_arrayref(undef, $max_rows)}) };

my @tuple_status;
my $rc;

$rc = $ins->execute_for_fetch($fetch_tuple_sub, \@tuple_status);

my @errors = grep { ref $_ } @tuple_status; 
```

传输工作，但它仍然比我通过 SQL Server 导出/导入向导手动传输数据要慢。我注意到的问题是数据逐行流入目的地，我想知道是否可以增加批量传输大小。它下载数据的速度非常快，但是当我结合下载和上传时，速度会急剧下降，在服务器之间传输 5000 行表需要长达 10 分钟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T08:40:06.523

如果你说你的目标是什么（速度？）而不是问一个关于避免循环的具体问题会更好。

对于 Perl/DBI 方式：

看看 DBI 的[execute_array](http://search.cpan.org/~timb/DBI-1.622/DBI.pm#execute_array)和[execute_for_fetch](http://search.cpan.org/~timb/DBI-1.622/DBI.pm#execute_for_fetch)但是因为你没有告诉我们你正在使用哪个 DBD，所以不可能再说更多。并非所有 DBD 都支持批量插入，当它们不支持时，DBI 会模拟它。DBD::Oracle 确实和 DBD::ODBC 确实（在最近的版本中，请参见[odbc_array_operations](http://search.cpan.org/~mjevans/DBD-ODBC-1.39/ODBC.pm#odbc_array_operations)），但在后者中，默认情况下它是关闭的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T00:40:57.790

您没有提及您使用的是哪个版本的 SQL Server。首先，我会研究该版本的“BULK INSERT”支持。

您也没有提到涉及多少行。我会假设它们适合内存，否则批量插入将不起作用。

从那里您可以将输出`fetchall_arrayref`转换为“BULK INSERT”操作所需的语法。

# c# - 属性与公共成员变量

> ID：11874391
> 
> 赞同：15
> 
> 时间：2012-08-08T22:55:04.677
> 
> 标签：c#, properties, private, public

> **可能重复：**
> [C#中的字段和属性有什么区别](https://stackoverflow.com/questions/295104/what-is-the-difference-between-a-field-and-a-property-in-c-sharp)

我是一个初级程序员，我已经阅读了所有关于类属性的内容。书籍指出属性允许您间接访问成员变量。好的，那么与仅将字段公开并直接访问它有什么不同呢？

这是 Jesse Liberty 的 Learning C# 3.0 中的一段话：

> 例如，您可能希望外部类能够读取一个值，但不能更改它；或者您可能想要编写一些代码，以便内部字段只能接受特定范围内的值。如果您授予外部课程对您的成员字段的免费访问权限，您将无法控制其中的任何内容。

我不明白他在这里说什么。有人可以进一步解释这一点或举例说明为什么我想使用属性而不是公开该字段。据我所知，他们现在都会完成同样的事情......所以我显然在这里遗漏了一些东西。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-08T23:07:52.077

到目前为止提供的其他答案提供了访问器/突变器逻辑优势的详细信息，但似乎都错过了关于对象封装的思想观点。

你看，类成员字段是一个实现细节。例如，如果您有一个表示集合的类，那么您可以将其实现为链表（并通过公共字段公开根节点），或者您可以将其实现为可调整大小的数组并公开 index0 成员。

揭示实现细节的问题是你失去了你的类和它的消费者之间的任何类型的定义接口。通过确保通过定义的方法（由类本身控制）完成所有操作，您可以更轻松地使用并提供长期观点。例如，您可以更轻松地将集合实现从一种类型（链表）转换为另一种类型（数组），而不会违反与类的消费者的任何约定。

不要担心琐碎的访问器/修改器方法对性能的任何影响：JIT 编译器将内联属性方法。如果您运行一些基准测试，您会发现属性与字段的性能是相同的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-08T22:59:00.420

他说属性可以提供getter但不能提供setter，因此使它们成为只读的（例如）

属性只是方法的语法糖，例如

```
public int SomeProperty { get; set; } 
```

只是糖

```
private int _someProperty;

public int SomeProperty_get() 
{
   return _someProperty;
}

public void SomeProperty_set(int value) 
{
   _someProperty = value;
} 
```

这意味着属性设置器/获取器可以应用纯公共字段不能应用的逻辑

编辑：我不完全确定 CLR 为自动属性提供支持字段的字段名称 - 这只是一个示例 :)

编辑2：

只读属性的示例：

```
public int SomeProperty { get; } 
```

最后是公共读取 - 私人写入（用于自动属性）

```
public int SomeProperty { get; private set; } 
```

当您不想在其中键入支持字段时非常有用:)

请记住，如果您希望将逻辑应用于成员，那么属性就是要走的路。这是许多框架的工作方式（例如，通过使用属性来跟踪“脏”对象以告诉某种对象管理器某些内容已更改，使用公共字段这是不可能的）

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-08-08T22:58:15.303

属性可能有副作用，它们围绕“getter”和“setter”方法提供语法糖。

```
public class MyClass {

   int sizeValue = 0;

   public int Size {
      get {
         return sizeValue;
      }
      set {
         if ( value < 10 ) throw new Exception("Size too small");
         sizeValue = value;
      }
   }
} 
```

属性也可以对 get 和 set 有不同级别的保护，你不能用字段来做到这一点。

```
public class MyOtherClass {

   // only this object can set this.
   public int Level {
      get; private set; 
   }

   // only things in the same assembly can set this.
   public string Name {
      get; internal set;
   }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-08T22:57:26.707

“属性”和“成员访问”之间存在许多重要区别。

最重要的是，您可以通过属性将成员设为只读（您可以访问状态，但不能更改它）。就像 Java 中的“getter()”和“setter()”方法一样。

您还可以从属性返回计算值（“即时”生成值，就好像它是一个变量一样）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-08T23:05:26.867

可以配置属性，以便：

它们是只读的，`Public MyProp {get;}`

它们是只写的`Public MyProp {set;}`

它们可由外部对象读取，但只能由类的内部设置

上市`MyProp {get; private set;}`

正如其他人所发布的那样，您还可以将逻辑放入您的 getter 和 setter 中。例如，在允许将属性设置为新值之前，您可以检查该值是否可以接受。

您不能对公共字段执行任何操作。

基本上，公共字段是您可以拥有的最愚蠢的属性。鉴于 .Net 现在允许为您的属性自动备份字段。不再有充分的理由使用公共字段。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-08T22:59:27.763

如果你有，`Public Int MyAge` 我可以将它设置为 -200 或 20,000，你无能为力。

例如，如果您使用属性，则可以检查年龄是否介于 0 和 150 之间。

编辑：根据 IanNorton 的示例（伙计，这很快）

# java - 通过 Tomcat 流式传输

> ID：11874394
> 
> 赞同：0
> 
> 时间：2012-08-08T22:55:13.290
> 
> 标签：java, tomcat, streaming

我已经使用 Tomcat 构建了一个流媒体中继服务器。

简单的想法是：一个客户端执行 POST，另一个客户端执行 GET。servlet 生成一个 Thread 并执行简单的字节混洗，直到 InputSteam（来自 POST）为空。完成后关闭/回答两个请求。一切都很好，而且效果很好，但是：

Tomcat 似乎重用了请求对象甚至 InputStream 对象！每 10 个 POST 左右，InputStream 无法读取，因为已经关闭。仔细查看日志，我意识到之前的请求使用（并因此关闭）完全相同的 InputStream 对象。事实证明，即使是 HttpServletRequest 对象也是完全相同的。

这里发生了什么？为什么 Tomcat 会重用显然没有正确重置的对象？我已经尝试过 7.0.29 和 6.0.16 版本，同样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T14:02:31.800

由于这是一个资源管理问题（您的线程持有`InputStream`时间过长），您应该能够解决这个问题：让启动线程的 servlet（或将任务提交给`Executor`...您*正在*`Executor`为此使用任何，对吗？）等待线程完成（或`Future`完成）并释放其资源。如果您将代码发布到字节泵线程（以及 servlet 的相关部分），我可以向您展示如何改进它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T22:55:13.290

更新：

原来，我产生的线程（显然有对输入和输出流的引用）并没有总是及时释放这些引用。谢谢克里斯托弗的指点！

虽然我同意缓存这些对象是一种非常糟糕的做法，而且永远不应该这样做，但令人失望的是 Tomcat 对它的反应如此糟糕。我希望有更好的那种成熟的应用服务器......

# ruby-on-rails - 孩子不是从父模型创建的？

> ID：11874397
> 
> 赞同：0
> 
> 时间：2012-08-08T22:55:21.057
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我有一个复选框，如果选中该复选框，则可以创建我的名为 Engineer 的子资源。我正在尝试通过我的模型创建它，因为那是我可以调用该`after_save`方法的地方。

这是我的代码：

**模型/用户.rb**

```
class User < ActiveRecord::Base
  has_many :armies
  has_many :engineers  
end 
```

**模型/军队.rb**

```
class Army < ActiveRecord::Base
 has_many :engineers
 attr_reader :siege
 after_save :if_siege
 private

 def if_siege
   if self.siege
    Engineer.create!( :user_id => current_user.id, :army_id => self.id )
   end
 end
end 
```

**模型/工程师.rb**

```
class Engineer < ActiveRecord::Base
  belongs_to :user
  belongs_to :army
end 
```

**控制器/armies_controller.rb**

```
def new
  @army = Army.new
end

def create
  @army = current_user.armies.build(params[:army])
    if @army.save
      redirect_to new_army_path
    else
      render :new
    end
  end
end 
```

`if_siege`尽管对于我的方法，这给了我一个错误：

```
undefined local variable or method `current_user' 
```

我该如何解决这个问题，或者有其他方法可以做到这一点吗？不确定这是否应该放入控制器或模型中，但我只能将其放入模型中。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:14:20.457

添加`belongs_to :user`到`Army`模型

中`Army#if_siege`，更新`Engineer.create!`如下

```
Engineer.create!( :user_id => self.user.id, :army_id => self.id ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:19:03.937

首先， current_user 对象不会存在于模型层的上下文中，除非您的身份验证正在做一些事情以使其可用。不过，这通常是一种非线程安全的方法。也许对你来说这不是问题。

[当前用户实例化](https://stackoverflow.com/questions/1568218/access-to-current-user-from-within-a-model-in-ruby-on-rails)

话虽如此，解决这个问题的一种方法（也许不是理想的方法）是在名为 Army 的对象的模型中创建一个 attr_accessor。然后在current_user 实例可用的控制器中的 Army*新操作中将 current_user 设置为此。*

```
# in the Army model
attr_accessor :the_user

# in the Army Controller
@army = Army.new(:the_user => current_user.id) 
```

您还必须添加一个隐藏字段来将此值存储在您的视图中，以将其传递到创建操作。

只是一个观察，但我相当确定在“if_seige”方法中，*自我*调用是多余的。*在该方法中， self*应该已经被限定为 Army 对象。

# ruby-on-rails - 从我的浏览器访问亚马逊实例上的 Ruby Server

> ID：11874402
> 
> 赞同：0
> 
> 时间：2012-08-08T22:56:05.150
> 
> 标签：ruby-on-rails, amazon-web-services

我已经开始学习 Ruby on Rails 教程，并且正在使用我的第一个应用程序。我在亚马逊网络服务 (aws) 上的一个实例上完成了所有这些工作。前段时间我在那里安装了 apache，所以当我输入公共地址（端口 80）时，它告诉我“它可以工作”。我想从家里的网络浏览器访问这个服务器。

但是，当我输入服务器地址 :3000 （应用程序应该运行的端口）时，我什么也得不到。我是否需要告诉盒子打开端口 3000 或类似的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T02:58:44.873

您需要打开实例的安全组以接受端口 3000 上的流量。查看[文档](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/using-network-security.html)以获取更多信息。

# asp.net-mvc - 如何处理抽象出 3rd 方依赖项（依赖注入）？

> ID：11874403
> 
> 赞同：2
> 
> 时间：2012-08-08T22:56:06.033
> 
> 标签：asp.net-mvc, unit-testing, architecture, dependency-injection, ninject

将 Ninject 与 ASP.NET MVC 一起使用时，抽象出 3rd 方依赖项的最佳方法是什么？

通常，我会这样做：

```
public interface IProductRepository
{
    IEnumerable<Product> GetProducts();
}

public class ProductRespository : IProductRepository
{
    public IEnumerable<Product> GetProducts()
    {
        ...
    }
} 
```

然后在控制器中：

```
public class ProductController : Controller
{
    private IProductRepository repository;

    public ProductController(IProductRepository repository)
    {
        this.repository = repository;
    }

    ...
} 
```

然后我使用 Ninject 将固体 ProductRepository 自动注入控制器。

但是，如果依赖项是第 3 方，我该怎么做？例如，我正在使用[FlickrNet](http://flickrnet.codeplex.com/)。

```
public class ProductController : Controller
{
    private Flickr flickr;

    ...
} 
```

我希望能够将`Flickr`对象抽象到一个接口中，以便我可以使用依赖注入并使其更容易进行单元测试。我知道我可以创建一个“服务”类型的接口，然后实现一个基于包装 Flickr 对象的类。

但是我必须在接口中定义一个与 Flickr 对象的每个成员相对应的成员，然后将每个成员映射到包装器对象中。Flickr 对象中有很多很多的成员。

有没有更好的方法来处理这个问题？我的主要目标是在单元测试中轻松模拟 Flickr 依赖项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T09:54:15.760

将我的评论升级为答案。

这不是 DI 的问题，而是一般的架构问题。您可以将控制器声明为抽象层，也可以在实现自定义接口的 flickr 组件周围定义一个包装器。如果您的 3rd 方组件上的方法使用更多的 3rd 方类，则您也需要将它们抽象出来，依此类推，直到您只剩下原始值或更多围绕 3rd 方代码的包装器。根据该组件的复杂性，这可能意味着大量的映射和包装。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-09T08:03:46.933

我认为包装器是正确的方法。您不必公开 3rd 方对象的每个成员 - 只需公开您需要的那些。不同的情况下使用不同的接口，包装器解决方案变得更加漂亮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T03:53:56.663

我知道这篇文章不是关于单元测试的，但它提供的解决方案顺便也适用于基于模拟的单元测试。

[http://goodcoffeegoodcode.blogspot.com/2011_04_01_archive.html](http://goodcoffeegoodcode.blogspot.com/2011_04_01_archive.html)

基本上，正如@Brian Dishaw 建议的那样，您需要从 FlickrNet 类中提取接口并将它们注入到您的类中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-09T14:23:53.650

The only purpose would be if you abstract away flickr .NET into a higher abstraction layer. For instance

```
interface IAlbumViewer
{
   IEnumerable<IImage> GetImages();
}

interface IPictureUploader
{
   string Upload(string filename, Stream image)
} 
```

That is, create interfaces/methods that are specific for your usecases contra generic flickr interfaces. You would also benefit from that since it makes it a lot easier to add support for other image services.

# php - Div 内正确的 JSON 响应输出

> ID：11874413
> 
> 赞同：0
> 
> 时间：2012-08-08T22:57:01.540
> 
> 标签：php, javascript, jquery, ajax, json

**问题：**

我正在毫无问题地将数据拉入 div，但是，文本没有按应有的方式显示。当数据被扔进 div 时，格式会被剥离。段落只是一个文本块。奇怪的是，在 Firebug 中，如果我检查并更改：

```
<div id="description">Lorem ipsum dolor...</div> 
```

至

```
<pre id="description">Lorem ipsum dolor...</pre> 
```

整个文本块得到修复 - 正是我需要的！所以现在，如果我继续并在实际页面中更改为`<div>`并`<pre>`点击刷新，文本块仍会显示。没有退货/进入。

**我的问题：**

我还需要做什么才能正确显示传入的文本？我有带有 Enter/Return 键、项目符号等的文本项。

**预期结果：**

> Lorem ipsum dolor sit amet, consectetur adipiscing elit。整数 convallis iaculis 前庭。Fusce egestas lectus vitae lacus tempor vel tempus mauris facilisis。Fusce dignissim risus ut augue venenatis 在 lacinia enim scelerisque。Vivamus id sem Tellus。Maecenas vel laoreet metus。Proin suscipit, eros a ornare tristique, tellus est consequat ipsum, sat amet cursus justo libero non massa。Morbi auctor congue est ut posuere。Curabitur aliquet metus eu eros faucibus porttitor。Duis lectus ligula, scelerisque ac eleifend quis, tempor condimentum nisl。Suspendisse bibendum, lorem vitae vulputate laoreet, turpis tellus congue odio, ac aliquam urna augue id sem。Quisque consequat ullamcorper lorem non auctor。
> 
> Maecenas fringilla, lacus vitae varius venenatis, elit risus rut​​rum mi, a consequat ipsum massa quis tortor。Phasellus eu risus quam。Maecenas sagittis magna et diam consequat molestie。Vivamus pharetra dictum augue, et sollicitudin ipsum infantum vel。Cras aliquam lobortis lorem vel ornare。整数发酵 nunc et turpis mattis sollicitudin。Fusce magna nibh，pellentesque posuere rutrum id，luctus viverra nibh。在 laoreet lorem 的 Donec。Sed actor turpis vitae lectus dictum convallis。Nulla quam nulla，scelerisque quis eleifend imperdiet，pretium ut diam。

**实际结果：**

> Lorem ipsum dolor sit amet, consectetur adipiscing elit。整数 convallis iaculis 前庭。Fusce egestas lectus vitae lacus tempor vel tempus mauris facilisis。Fusce dignissim risus ut augue venenatis 在 lacinia enim scelerisque。Vivamus id sem Tellus。Maecenas vel laoreet metus。Proin suscipit, eros a ornare tristique, tellus est consequat ipsum, sat amet cursus justo libero non massa。Morbi auctor congue est ut posuere。Curabitur aliquet metus eu eros faucibus porttitor。Duis lectus ligula, scelerisque ac eleifend quis, tempor condimentum nisl。Suspendisse bibendum, lorem vitae vulputate laoreet, turpis tellus congue odio, ac aliquam urna augue id sem。Quisque consequat ullamcorper lorem non auctor。Maecenas fringilla, lacus vitae varius venenatis, elit risus rut​​rum mi, a consequat ipsum massa quis tortor。Phasellus eu risus quam。Maecenas sagittis magna et diam consequat molestie。Vivamus pharetra dictum augue, et sollicitudin ipsum infantum vel。Cras aliquam lobortis lorem vel ornare。整数发酵 nunc et turpis mattis sollicitudin。Fusce magna nibh，pellentesque posuere rutrum id，luctus viverra nibh。在 laoreet lorem 的 Donec。Sed actor turpis vitae lectus dictum convallis。Nulla quam nulla，scelerisque quis eleifend imperdiet，pretium ut diam。

**我的代码：**

*索引.php*

```
var string = "itemNum=" + item + "&idNum=" + id;
$.ajax({
    type: "POST",
    url: "data.php",
    dataType: "json",
    data: string,
    success: function(output)
    {   
        $("#image").attr("src", "xml/"+output[0]);
        $('#description').html(output[1]);  
        //I've also tried: $('#description').text(output[1]);   
    }
}); 
```

*数据.php：*

```
$getXML = simplexml_load_file("output.xml");

function getDesc($getXML){

    ...code....

    return array($img, $desc);  
}

$output = getDesc($getXML);
echo json_encode($output); 
```

**使用 Firebug 的控制台窗口：**

*标题：*

内容类型应用程序/json；字符集=utf-8

ETC....

*回复：*

> 一个后果性的 ipsum massa quis 侵权行为。Phasellus eu risus quam。Maecenas sagittis magna et diam consequat molestie。Vivamus pharetra dictum augue, et sollicitudin ipsum infantum vel。Cras aliquam lobortis lorem vel ornare。整数发酵 nunc et turpis mattis sollicitudin。Fusce magna nibh，pellentesque posuere rutrum id，luctus viverra nibh。在 laoreet lorem 的 Donec。Sed actor turpis vitae lectus dictum convallis。Nulla quam nulla, scelerisque quis eleifend imperdiet, pretium ut diam。”] 在 laoreet lorem 的 Donec。Sed actor turpis vitae lectus dictum convallis。Nulla quam nulla, scelerisque quis eleifend imperdiet, pretium ut diam。”] 在 laoreet lorem 的 Donec。Sed actor turpis vitae lectus dictum convallis。Nulla quam nulla, scelerisque quis eleifend imperdiet, pretium ut diam。”]

*JSON：*

键 0 给了我“img/sun.jpg”

键 1 给了我

> Phasellus eu risus quam。Maecenas sagittis magna et diam consequat molestie。Vivamus pharetra dictum augue, et sollicitudin ipsum infantum vel。Cras aliquam lobortis lorem vel ornare。整数发酵 nunc et turpis mattis sollicitudin。Fusce magna nibh，pellentesque posuere rutrum id，luctus viverra nibh。在 laoreet lorem 的 Donec。Sed actor turpis vitae lectus dictum convallis。Nulla quam nulla, scelerisque quis eleifend imperdiet, pretium ut diam。”

**输出：**

```
console.log("Image = " + output[0]); 
```

图片 = img/sun.jpg

```
console.log("Description = " + output[1]); 
```

描述 = Lorem ipsum dolor sit amet，consectetur adipiscing elit。整数 convallis iaculis 前庭。Fusce egestas lectus vitae lacus tempor vel tempus mauris facilisis。Fusce dignissim risus ut augue venenatis 在 lacinia enim scelerisque。Vivamus id sem Tellus。Maecenas vel laoreet metus。Proin suscipit, eros a ornare tristique, tellus est consequat ipsum, sat amet cursus justo libero non massa。Morbi auctor congue est ut posuere。Curabitur aliquet metus eu eros faucibus porttitor。Duis lectus ligula, scelerisque ac eleifend quis, tempor condimentum nisl。Suspendisse bibendum, lorem vitae vulputate laoreet, turpis tellus congue odio, ac aliquam urna augue id sem。Quisque consequat ullamcorper lorem non auctor。

Maecenas fringilla, lacus vitae varius venenatis, elit risus rut​​rum mi, a consequat ipsum massa quis tortor。Phasellus eu risus quam。Maecenas sagittis magna et diam consequat molestie。Vivamus pharetra dictum augue, et sollicitudin ipsum infantum vel。Cras aliquam lobortis lorem vel ornare。整数发酵 nunc et turpis mattis sollicitudin。Fusce magna nibh，pellentesque posuere rutrum id，luctus viverra nibh。在 laoreet lorem 的 Donec。Sed actor turpis vitae lectus dictum convallis。Nulla quam nulla，scelerisque quis eleifend imperdiet，pretium ut diam。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:02:19.640

包含文本的 JSON 数据没有标记，因此当您使用该`.html()`函数设置`<div>`内容时，它会按预期工作。

您必须将用于创建段落`<p>`和项目符号`<ul>`等内容的任何标记保存为文本的一部分。即，来自您的 XML 文件的原始数据还必须包括这些标签以及文本。

以上面的示例为例，JSON 应如下所示：

JSON：

键 0：“img/sun.jpg”

关键 1:" `<p>`Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer convallis iaculis vestibulum. Fusce egestas lectus vitae lacus tempor vel tempus mauris facilisis. Fusce dignissim risus ut augue venenatis in lacinia enim scelerisque. Vivamus id sem tellus. Maecenas vel laoreet metus . Proin suscipit, eros a ornare tristique, tellus est consequat ipsum, sat amet cursus justo libero non massa. Morbi auctor congue est ut posuere. Curabitur aliquet metus eu eros faucibus porttitor. Duis lectus ligula, scelerisque ac eleifend quis, tempor condimentum nisl。 Suspendisse bibendum, lorem vitae vulputate laoreet, turpis tellus congue odio, ac aliquam urna augue id sem. Quisque consequat ullamcorper lorem non auctor。`</p><p>`Maecenas fringilla, lacus vitae varius venenatis, elit risus rut​​rum mi, a consequat ipsum massa quis tortor。Phasellus eu risus quam。Maecenas sagittis magna et diam consequat molestie。Vivamus pharetra dictum augue, et sollicitudin ipsum infantum vel。Cras aliquam lobortis lorem vel ornare。整数发酵 nunc et turpis mattis sollicitudin。Fusce magna nibh，pellentesque posuere rutrum id，luctus viverra nibh。在 laoreet lorem 的 Donec。Sed actor turpis vitae lectus dictum convallis。Nulla quam nulla，scelerisque quis eleifend imperdiet，pretium ut diam。`</p>`"

# java - Java打破了无限循环

> ID：11874414
> 
> 赞同：3
> 
> 时间：2012-08-08T22:57:01.367
> 
> 标签：java

我在我们的生产环境中遇到了特殊情况，其中一段特定的代码进入了无限循环。原因主要是数据特定的，无法找出真正的原因。同时，我希望做的是产生一个单独的子线程来执行那段代码，如果它执行超过 30 秒，想要阻止该子线程执行

```
Thread t = new Thread() {
    public void run() {
                    // This is where i will the method that runs in a infinite loop
                    callMethodThatRunsInInfiniteLoop();
    };
};

t.start();
try {
    t.join(2000); // wait 2s
} catch (InterruptedException e) {
    e.printStackTrace();
} 

// if not completed how to break the child thread ??? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:13:36.303

有没有办法通过抛出异常来导致无限循环代码中断？例如将一些变量设置为空？一个可能的优点是受影响的线程*（如果写得好*）将在自己之后清理并关闭比 stop() 更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T00:40:54.490

> 不幸的是，它是第三方代码，无法轻易更改。

听起来您正在尝试解决第三方库中的问题……或者在您的代码中调用第三方库时输入错误或其他问题。

我的建议是解决这个问题，而不是试图杀死错误的线程。如果你不能这样做，那么你有两个选择：

*   修改 3rd 方库以感知中断/响应，然后使用它来停止它，或者

*   尝试找到一种方法来“进入”第 3 方库的数据结构（例如使用令人讨厌的反射）并使其死亡。

如果您求助于后者，那么也许您还应该考虑在单独的 JVM 中运行 3rd 方库，以便您可以使用 Process API 强行杀死它。

* * *

`Thread.stop()`话虽如此，实际上（可能）可以安全使用的情况有限。基本上，如果错误线程不创建子线程，不与其他线程交互并且不共享数据结构，并且当你杀死它时不能进行类初始化，那么你**可能**会是安全的。问题是有太多的理论场景，停止线程可能会导致损坏，很难知道您已经考虑了所有这些场景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T00:27:52.500

根据方法的实现，您可以在它自己的 JVM 中启动它，然后通过调用`destroy()`进程来停止它：

```
Process process = new ProcessBuilder("java", "-cp", "/some/class/path", "com.mycompany.MyLauncher").start();

// sometime later
process.destroy(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-08T23:46:20.893

所有用于“纯粹在外部”停止线程的方法都已弃用并被认为是不安全的。可以安全停止线程的**唯一方法需要**

1.  修改正在运行的代码以检查是否已通过`stopMe`设置某些变量礼貌地要求停止；或者
2.  选择另一个线程已经使用的变量来导致线程退出（这通常是非常糟糕的做法）；例如，按照 user949300 的建议，强制它抛出异常。

没有这个，你别无选择，只能使用不安全的方法，这意味着`Thread.stop()`，这也是非常糟糕的做法。这是一个非常糟糕的主意，当然唯一真正的解决方案是更改您的输入以防止这种情况发生，或者修复第三方代码。

线程使用的任何对象都可能处于不一致（并且可能不可用）的状态，所以尽量避免让线程修改任何重要的东西，如果可以帮助它，不要查看它的任何输出变量。

该`Thread.stop()`方法似乎仍然存在于 Java SE 7 中，尽管当然已弃用，但我不能保证您的特定环境。

请参阅[http://docs.oracle.com/javase/1.4.2/docs/guide/misc/threadPrimitiveDeprecation.html](http://docs.oracle.com/javase/1.4.2/docs/guide/misc/threadPrimitiveDeprecation.html)

# sql - 将 SQL 转换为 Linq - Where、Groupby 和 Have

> ID：11874418
> 
> 赞同：2
> 
> 时间：2012-08-08T22:57:16.533
> 
> 标签：sql, linq, group-by, having

这个 SQL 查询在 Linq 中的正确语法让我望而却步。我将不胜感激。

SQL：

```
SELECT TOP 1 posdate 
FROM   dailypos 
GROUP  BY posdate 
HAVING Count(DISTINCT customernumber) = 3 
ORDER  BY posdate DESC) 
```

本质上，我从 3 个不同的客户那里获取文件，我需要一种快速的方法来确定我从所有 3 个客户那里获得数据的最近日期。我愿意采用不同的方法，但是这个 SQL 可以满足我的需要。

我可以做组，但我不知道如何处理第 4 行 (HAVING Count(Distinct...))

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:03:11.390

尝试这样的事情：

```
var result = context.dailypos
    .GroupBy(x => x.posdate)
    .Where(g => g.Select(x => x.customernumber).Distinct().Count() == 3)
    .Select(g => g.Key)
    .OrderByDescending(x => x)
    .Take(1); 
```

# java - 如何使用 Java 程序创建 Web 代理服务

> ID：11874419
> 
> 赞同：0
> 
> 时间：2012-08-08T22:57:19.840
> 
> 标签：java, xml, json, web-services, soap

我有一个场景，我应该联系一个 RESTFul API，它会向我发送 JSON 响应。得到响应后，我想将数据存储在数据库中。

我们使用 BPEL 进行开发。但是，对于干净的开发/部署，我使用 Java 来联系 RESTFul API，这样我就不必在我的 BPEL 中处理任何 Java 代码。所以我想创建一个网络服务代理。

我创建了一个类，它与此端点联系并获取响应 (JSON) 并将响应消息 (JSON) 转换为 XML。

现在，我想创建一个 Web 代理服务，我可以为我创建的这个 Java 程序托管它。有什么办法可以做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T00:45:36.597

我有一个解决方案。我使用 java（使用 json.org 库）创建了一个中间 Web 服务，用于使用 REST API，然后在解析 JSON 响应后为我的 BPEL 提供 SOAP 响应。

# fortran - 如何使循环计数器不大于最终值？

> ID：11874421
> 
> 赞同：4
> 
> 时间：2012-08-08T22:57:32.540
> 
> 标签：fortran, intel-fortran

所以样本循环：

```
do i=1,1
    print *,i
enddo
print *,i 
```

给我`2`作为 的最终值`i`。如何在 Windows 上为 Visual Studio 设置 Intel Fortran 以获得最终值`1`for `i`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-09T11:46:11.137

几十年来，这一直是 Fortran 循环的工作方式，您不能简单地使用编译器选项来更改它。Fortran 标准明确规定：

> 8.1.4.4.1 循环启动
> 
> (2) DO 变量被定义为初始参数*m [1]*的值。
> 
> (3)**迭代次数**成立，是表达式的值 `MAX (INT ((m2 – m1 + m3) / m3), 0)`

这里*m [1]*，*m [2]*和*m [3]**是循环控制*中的三个参数：`[,] var = m1,m2[,m3]`，给定您的示例`i=1,1`（如果省略*m [3]*则隐含`1`），迭代计数的`MAX(INT((1-1+1)/1),0)`计算结果为`1`，即循环应该执行一次。根据（2）`i`初始化。`1`

> 8.1.4.4.2 执行周期
> 
> DO 构造的**执行周期**由以下步骤组成，这些步骤按顺序重复执行，直到终止：
> 
> (1) 测试迭代次数，如果有的话。如果迭代计数为零，则循环终止并且 DO 构造变为非活动状态。如果*loop-control*是`[ , ] WHILE (scalar-logical-expr)`，则评估*scalar-logicalexpr*；如果此表达式的值为 false，则循环终止并且 DO 构造变为非活动状态。结果，如果所有共享*do-term-shared-stmt*的 DO 结构都处于非活动状态，则所有这些结构的执行都完成了。但是，如果某些共享*do-term-shared-stmt*的 DO 结构处于活动状态，则执行将继续执行最近执行 DO 语句的活动 DO 结构的执行周期的步骤 (3)。

Fortran 测试剩余**迭代计数**是否大于零，而不是 DO 变量是否小于（大于）结束值。

> (2) 如果迭代计数不为零，则执行循环的范围。
> 
> (3) 迭代计数，如果有的话，减一。DO 变量（如果有）按增量参数*m [3]*的值递增。

DO 变量总是随着循环的迭代而递增。因此，在第一次执行之后，它的值`i`会增加。`1``2`

> 除了在步骤 (3) 中发生的 DO 变量的递增之外，DO 变量在 DO 构造处于活动状态时既不能重新定义也不能变为未定义。
> 
> 8.1.4.4.4 循环终止
> 
> 当 DO 构造变为非活动状态时，DO 构造的 DO 变量（如果有）将保留其最后定义的值。

最后定义的值为`2`。因此在 DO 循环结束后，`i`等于`2`。

我已经从 ISO/IEC 1539:1991（又名 Fortran 90）中提取了文本，但也可以在 ISO/IEC 1539:1980（又名 ANSI X3J3/90.4 又名 FORTRAN 77）的 §11.10.3 中找到几乎相同的文本; 没有`WHILE`F77 中不存在的东西）以及 ISO/IEC 1539-1:2010（又名 Fortran 2008）的 §8.1.6.6 中的内容。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T23:03:26.547

你不能，因为这就是 DO 的工作原理；当控制变量超过限制时停止。

一般来说，在几乎任何具有 FOR/DO 计数循环的语言中，您应该只在循环体内使用循环控制变量，并将其视为未定义的其他地方，即使您实际上不能将其范围限制在循环体中。

在您的情况下，我将使用不同的变量来跟踪 i 在任何迭代中的实际最后一个值：

```
lasti = 0
do i=1,1
   print *,i
   lasti = i
enddo
print *,lasti 
```

# jquery - 动态添加表单元素后表单提交

> ID：11874423
> 
> 赞同：1
> 
> 时间：2012-08-08T22:57:38.423
> 
> 标签：jquery, python, google-app-engine, jinja2

我对编程比较陌生，对这个网站也是新手，请容忍我在描述这个问题时犯的任何简单错误。

我正在使用 python 来实现一个带有 Google App Engine 的网络应用程序，并正在使用`jinja2`它来呈现我的 HTML 模板。

我在我的`base.html`模板中包含了一些 jquery，以允许用户将输入框动态添加到表单中。每当添加一组输入框时，它们就会在页面上闪烁，似乎有问题的表单提交给服务器（带有输入框名称的查询字符串[包括刚刚添加的输入框]出现在 url 中） . 之后，在浏览器中呈现一个空白页面。

我不确定如何解决此问题。我猜这与我的 GET 和 POST 函数格式不正确有关，但不知道如何继续。我已经包含了相关的 jquery、html、GAE 处理程序和相关的函数定义。任何有关潜在解决方案或故障排除建议的见解都将不胜感激。

这是jQuery：

```
$(document).ready(function() {
  $('#btnAdd').click(function() {
    var num     = $('.clonedInput').length;
    var newNum  = new Number(num + 1);

    var newElemName = $('#inputName' + num).clone().prop('id', 'inputName' + newNum);
    var newElemValue = $('#inputValue' + num).clone().prop('id', 'inputValue' + newNum);

    newElemName.children(':first').prop('id', 'name' + newNum).prop('name', 'name' + newNum);
    newElemValue.children(':first').prop('id', 'value' + newNum).prop('name', 'value' + newNum);

    $('#inputValue' + num).after(newElemName);
    $(newElemName).after(newElemValue);
    $('#btnDel').removeAttr('disabled');

    if (newNum == 13) {
        $('#btnAdd').prop('disabled', true);
    };
  });

  $('#btnDel').click(function() {
    var num = $('.clonedInput').length;

    $('#inputName' + num).remove();
    $('#inputValue' + num).remove();
    $('#btnAdd').removeAttr('disabled');

    if (num-1 == 1) {
      $('#btnDel').prop('disabled', true);
    };
  });

    $('#btnDel').attr('disabled', true);
}); 
```

这是表单的标记：

```
<form class="well form-inline" method="post">
  <legend>custom post</legend>
  <button class="btn" id='btnAdd'>add another row</button> 
  <button class="btn" id='btnDel'>remove row</button>            
    <fieldset>
      <div id='inputName1' class='clonedInput'>
        <input type="text" class="input-xlarge" id="name1" placeholder="name" name="name1" value="{{name1}}">
      </div>
      <div id='inputValue1' class='clonedInput1'>
        <input type="text" class="input-xlarge" id="value1" placeholder="value" name="value1" value="{{value1}}">
      </div>
      <p class="help-block">enter your custom name and value, please.</p>
    </fieldset>
  <input type="submit">
</form> 
```

这是我的 GAE 处理程序和相关的函数定义（不完整，我还没有实现大部分的 post 函数）：

```
class Create(Handler):
    def get(self):
        if not self.getCookieVal('user_id'):
            self.redirect('/register/')
        self.render('create.html', userCookie=User.by_id(int(self.getCookieVal('user_id'))).username)

    def post(self):
        if not self.getCookieVal('user_id'):
            self.redirect('/register/')

def write(self, *a, **kw):
    self.response.out.write(*a, **kw)

def render_str(self, template, **params):
    return render_str(template, **params)

def render(self, template, **kw):
    self.write(self.render_str(template, **kw))

def getCookieVal(self, name):
    cookieVal = self.request.cookies.get(name)
    if cookieVal:
        return verification.checkSecureVal(cookieVal)  #returns string if value is secure 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:35:51.777

问题是，每当您单击提交表单的按钮时，请尝试使用按钮类型的输入。

```
<input type="button" value="add another row"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:24:41.973

您是否熟悉用于调试 html、脚本和网络 io 的 chrome 开发人员工具。 [https://developers.google.com/chrome-developer-tools/](https://developers.google.com/chrome-developer-tools/)

# javascript - Javascript未在浏览器中显示

> ID：11874424
> 
> 赞同：0
> 
> 时间：2012-08-08T22:57:50.110
> 
> 标签：javascript, html

我正在关注有关在 JavaScript 中创建计时器的教程，但我无法让它显示在我的浏览器上。我正在使用 Dreamweaver，它在“实时视图”中很好地显示了计时器，但在浏览器窗口中没有显示任何内容。我错过了什么？

这是主要的 HTML 页面：

```
<html>
    <head>
        <script type="text/javascript" src="/Timer2.js" />
    </head>
    <body>
        <div id='timer' />
        <script type="text/javascript">
            window.onload = CreateTimer("timer", 90);
        </script>
    </head>
    </body>
</html> 
```

这是 JavaScript 计时器功能。`timer2.js`：

```
var Timer;
var TotalSeconds;

function CreateTimer(TimerID, Time) {
    Timer = document.getElementById(TimerID);
    TotalSeconds = Time;

    UpdateTimer()
    window.setTimeout("Tick()", 1000);
}

function Tick() {
    if (TotalSeconds <= 0) {
        alert("Time's up!")
        return;
    }

    TotalSeconds -= 1;
    UpdateTimer()
    window.setTimeout("Tick()", 1000);
}

function UpdateTimer() {
    Timer.innerHTML = TotalSeconds;
}

function UpdateTimer() {
    var Seconds = TotalSeconds;

    var Days = Math.floor(Seconds / 86400);
    Seconds -= Days * 86400;

    var Hours = Math.floor(Seconds / 3600);
    Seconds -= Hours * (3600);

    var Minutes = Math.floor(Seconds / 60);
    Seconds -= Minutes * (60);

    var TimeStr = ((Days > 0) ? Days + " days " : "") + LeadingZero(Hours) + ":" + LeadingZero(Minutes) + ":" + LeadingZero(Seconds)

    Timer.innerHTML = TimeStr ;
}

function LeadingZero(Time) {
    return (Time < 10) ? "0" + Time : + Time;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T22:59:29.140

您不能自行关闭脚本标签。你必须写`<script ....></script>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:05:42.483

写`<div id="timer"></div>`和没有`<div id='timer' />`

删除`</head>`代码底部的您，如果您的脚本再次无法运行，请尝试`src="Timer2.js"`不使用“/”

# .net - 在 .NET 中使用错误代码进行支持调用

> ID：11874425
> 
> 赞同：1
> 
> 时间：2012-08-08T22:57:50.510
> 
> 标签：.net, windows, error-code

我一直在考虑将错误代码合并到我目前支持的应用程序中，并且我有一些一般性问题。

我完全倾向于使用代码的原因是因为我们已经在我们的应用程序中发现了至少一个严重的问题，这是我们无法通过编程方式解决的。该问题非常罕见，但如果发生，可能会导致用户严重停机。要解决此问题，需要直接联系熟悉该问题的支持人员。

为了在应用程序中做到最好，我们正在将信息写入 Windows 事件日志，以将支持人员指向损坏的数据，并向用户显示通用的“请致电支持”提示。

我们希望添加错误代码，以便支持人员更快地在事件查看器中找到特定错误。

所以，第一个问题：这是一种可以接受的方法，还是我没有考虑过其他想法？

其次，如果我们使用错误代码，在我们的解决方案中管理它们的最佳方法是什么？在每个项目中包含一个错误代码文件，其中不相交的整数组被屏蔽（**yuck**）？创建一个专门用于保存错误代码的新项目 ( **yuck** )？

我从来不知道如何最好地管理错误代码，而且我从事的两个项目都没有以任何干净的方式做到这一点。我宁愿避免使用它们，但如果我必须使用它们，我想知道什么最有效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:03:27.427

错误代码只是作为一种简洁地描述每个**已知**可能的错误场景的方式存在——作为一种确保本地化和中文耳语不会混淆任何故障排除过程的方式。

假设您对每个错误条件都有唯一的人类可读错误消息，那么您不需要维护错误代码数据库，只需将其计算为规范英语字符串的哈希（我假设这是您的默认语言） . 如果您添加本地化版本，则继续使用英文字符串作为摘要的基础。

当您接到技术电话时，您只需要找到与哈希码匹配的字符串，这可以使用实用程序自动完成（救援反射）。

或者，确保向用户显示的所有异常都由您自己的 Exception 子类封装，该子类具有所需的错误代码构造函数参数，该参数成为开发人员的责任。

# facebook - Facebook 注册插件未加载

> ID：11874427
> 
> 赞同：1
> 
> 时间：2012-08-08T22:57:55.210
> 
> 标签：facebook

我正在使用 Facebook 注册插件，它似乎已经停止工作，但我不确定为什么。发生的情况是，它没有加载注册表单，而是仅显示移动条加载图标（并且从不加载）。我有必要的凭据，过去当我的凭据错误时，表单通常会显示的空间中会出现错误消息。

我注意到的一件事是，当我访问[注册的 FB 页面](http://developers.facebook.com/docs/plugins/registration/)时，我可以看到没有自定义字段的两个示例，但是我看不到带有自定义字段的示例。在我的使用中，我使用自定义字段。也许它与使用自定义字段和/或防火墙有关？

所以现在，用户无法注册。请帮忙！谢谢！

这是我的代码：

```
<div id="fb-root"></div>
  <%= javascript_include_tag "https://connect.facebook.net/en_US/all.js#appId=myappnumberiscorrecthere&xfbml=1" %>
    <% site_url = MyApplication::Application.config.site_url %>
    <fb:registration
      fields="[
     {'name':'name'},
     {'name':'first_name'},
     {'name':'last_name'},
     {'name':'email'},
     {'name':'gender'},
     {'name':'birthday'},
     {'name':'username', 'description':'User Name', 'type':'text'},
     {'name':'postal_code', 'description':'Postal Code', 'type':'text'},
     {'name':'password'},
     {'name':'captcha'}
    ]"
      redirect-uri="https://<%= @domain + "." + site_url %>/users"
      width="530">
   </fb:registration>
 </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:22:51.627

删除验证码字段。

在尝试使用自定义字段加载他们的文档页面以及使用您提供的代码时，我遇到了同样的问题。

通过删除验证码，它似乎工作。我认为 Facebook 端有一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-13T22:04:37.990

您可以在此处跟踪错误：

[http://developers.facebook.com/bugs/509265599090288?browse=search_5028d48a2f1678298252951](http://developers.facebook.com/bugs/509265599090288?browse=search_5028d48a2f1678298252951)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T17:10:36.757

改变它

```
fields="[
     {'name':'name'},
     {'name':'first_name'},
     {'name':'last_name'},
     {'name':'email'},
     {'name':'gender'},
     {'name':'birthday'},
     {'name':'username', 'description':'User Name', 'type':'text'},
     {'name':'postal_code', 'description':'Postal Code', 'type':'text'},
     {'name':'password'},
     {'name':'captcha'}
    ]" 
```

到

```
fields=[
     {'name':'name'},
     {'name':'first_name'},
     {'name':'last_name'},
     {'name':'email'},
     {'name':'gender'},
     {'name':'birthday'},
     {'name':'username', 'description':'User Name', 'type':'text'},
     {'name':'postal_code', 'description':'Postal Code', 'type':'text'},
     {'name':'password'},
     {'name':'captcha'}
    ]" 
```

# function - 如果行不为空，则 VIM Tab 然后转到行

> ID：11874435
> 
> 赞同：0
> 
> 时间：2012-08-08T22:58:34.990
> 
> 标签：function, vim, if-statement, mutt

我现在已经尝试了大约一个小时，但我似乎根本无法让它工作！哈哈

这就是我所拥有的：

```
function! Tabber()
let l2=getline(".")
if l2[:2] == 'To:'
    if len(l2) > 4
        exe "silent! normal 5Gi"
    else
        exe "silent! normal 2Gi"
    endif
endif
startinsert
endfunction 
```

基本上，当我在 VIM 中为 mutt 写一封电子邮件时，我希望能够在写完 To: 地址后按下 Tab 键，我希望它决定我所在的行是否有 To:，然后如果超过 4 个字符的意思是我输入了一个地址，如果没有，那就呆在那里。如果有超过 4 行转到第 5 行，即主题行。

完成后，我想将 If 复制到主题行，以确保我是否在主题行转到第 9 行来写电子邮件。所以我可以按我的方式下来哈哈。

对于我的生活，它不会起作用。当然，我还没有将它连接到选项卡，我只是`<Esc>`出去然后：

```
:call Tabber() 
```

但这应该有效。:S

谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:30:26.100

您的功能确实对我有用，所以我不确定为什么在没有更多信息的情况下您会遇到麻烦。我确实修改了它以适合您的规格：

```
function! Tabber()
   let line=getline(".")
   if line[:2] == 'To:'
      if len(line) > 4 | 5 | endif
   elseif line[:7] == 'Subject:'
      if len(line) > 9 | 9 | endif
   endif
   startinsert!
endfunction
inoremap <Tab> <Esc>:call Tabber()<cr> 
```

# php - nl2br 不适用于数据库中的文本

> ID：11874436
> 
> 赞同：2
> 
> 时间：2012-08-08T22:58:37.623
> 
> 标签：php

我试试这个：

```
echo nl2br($row['content']); 
```

但我得到的是：

> 大家好\n祝你好运！

为什么它不转换`\n`？数据库将数据存储为 UTF-8。

另外，我用测试字符串检查它，发现如果字符串带有双引号，它也不起作用。我的意思是：

```
echo nl2br("Hello everybody\n Good luck"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:04:03.310

它应该可以，但是如果您愿意，可以尝试`str_replace("\n","<br />")`代替 nl2br。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-23T00:28:49.353

问题是文本在您的数据库中存储有一个额外的斜线。对之前的文本使用`stripslashes`（此处为[PHP 文档](http://au1.php.net/stripslashes)）函数`nl2br`（[此处为 PHP 文档](http://php.net/manual/en/function.nl2br.php)）

```
$myText = "Hello\\nWorld"; //text from a database (with line breaks escaped)
stripslashes(nl2br($myText));
print $myText;
// Result: Hello<br>World 
```

# powershell - 在登录脚本中使用 $env:username 不起作用

> ID：11874437
> 
> 赞同：1
> 
> 时间：2012-08-08T22:58:38.343
> 
> 标签：powershell, group-policy, gpo

我有这个带有 GPO 的设置，可以作为登录脚本运行，显然是为了为客户端映射驱动器。

```
net use H: \\server1\share\$env:username 
```

死的简单。如果我输入一个特定的用户名来代替变量，那么它就可以工作。另外，如果我直接在客户端机器上运行这个脚本，它就可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T16:56:35.473

这*应该*在有或没有引号的情况下工作。客户端都是Windows 7吗？我相信 Powershell 登录/启动脚本不适用于早期版本，即使您安装了 Powershell，因为它是附加组件而不是本机 shell。如果您使用的是低级客户端，则可以从 cmd 批处理文件调用 powershell 脚本。但是，如果您要这样做，不妨跳过 Powershell 并`net use H:\\server1\share\%username%`从您的批处理文件中运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T20:12:12.427

在 .bat 文件中将其作为登录脚本运行（使用 FQDN 作为服务器名称）：

```
    净使用 H:\\server.example.com\share\%USERNAME%

```

如果这不起作用，则您的 GPO 尚未应用。您可以通过在机器上运行来强制执行此操作`gpupdate /force`。为了进行测试，请确保将 GPO 应用于组“Authenticated Users”的正确 OU（计算机也在组中）。如果这不起作用，您还可以“强制执行”GPO。不要忘记在`gpupdate /force`对 GPO 或其设置进行任何更改后进行操作。

您还可以尝试使用 .js 登录脚本，例如：

```
    var WSH = new ActiveXObject("WScript.Shell");

    // 地图分享
    WSH.Run("net use H: \\\\server.example.com\\share");

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T08:05:59.797

你有错误吗？如果将路径用双引号括起来有帮助吗？

```
"\\server1\share\$env:username" 
```

# c++ - 指向位集数组

> ID：11874438
> 
> 赞同：0
> 
> 时间：2012-08-08T22:58:45.803
> 
> 标签：c++, arrays, memory-address, bitset

我想知道是否可以进行以下构造：

```
typedef std::bitset<4> BIT4;
BIT4* x=new BIT4[3];
BIT4* y=new BIT4[5]; 
```

我的担忧是：

(1) BIT4 的数组是否合法？

(2) 如果是，指针将如何寻址这些大小为 3 和 5 的数组？这些数组的最后一个元素似乎占用了 1/2 字节，另一半刚刚丢失，我们从新字节开始下一个数组，或者它是如何工作的？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:20:51.163

据我了解，您正在尝试做的是

对名为 x 的数组中的 3 个元素使用 12 位

对名为 y 的数组中的 5 个元素使用 20 位

这是错误的，因为您最终将使用：

*   x 为 3 个字节
*   y 5 个字节

如果你想实现你想要的，你需要这样做：

```
std::bitset<4*3> x;   // this will occupy 12 + 4 Padding Bits = 2 bytes
std::bitset<4*5> y;   // this will occupy 20 + 4 Padding Bits = 3 bytes 
```

如果您愿意，您当然可以动态分配它。

# ios - 使用 CGFloat 和“内存占用”

> ID：11874450
> 
> 赞同：0
> 
> 时间：2012-08-08T23:00:22.270
> 
> 标签：ios, floating-point, typedef, cgfloat

我正在阅读[这篇](https://stackoverflow.com/questions/1264924/whats-the-difference-between-using-cgfloat-and-float)文章，我很好奇增加内存占用意味着什么。无论如何，我都不是这方面的专家。实际上，我知道的很少，除了我想出的关于系统如何工作的想法。如果有人可以帮助澄清我的想法并纠正我的错误，我将不胜感激。

我知道，通过使用正确的 typedef，我正在对我的代码进行未来验证，以防苹果更改 typedef 的结构并且使用 typedef 不应该影响处理器，因为它的编译器或预处理器的工作基本上是转换它们。但是，如果 typedef 仅用于期望它们（及其精度）的函数，例如 CGRect/CGSize/etc 和要求这些 typedef 的 NSDate 函数，它实际上会使用比必要更多的内存吗？

基本上，是否有任何额外的内存被使用，因为它们只在函数需要它们的情况下使用，而不是使用它们当前的对应物（CGFloat -> float）？

这是针对 iOS 与 OSX 的，因为我知道 OSX 有 32 位和 64 位处理器，并且 typedef 是预期的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:17:14.613

这样想吧。内存占用通常意味着您在任何时候都消耗了多少内存。如果您无缘无故地使用 64 位值而不是完全有用的 32 位值，则存在一些边际膨胀。也就是说，我敢打赌你的大部分使用都是在自动和对象 ivars 中。

现在在 iOS 上，CGFloat == 浮动。

我个人总是将 CGFloat 用于任何可能与 iOS 交互的东西——也就是说，除非我正在做一些数学函数。正如你所说。前几天我不得不在 iOS 上获取一些代码并将其移动到 Mac 应用程序中，而且几乎不需要时间（因为我使用 CGFlat、NSInteger 和朋友）。您将不会收到任何转换警告（即将 64 位值转换为 32 位值）。

未来，鉴于 iOS 的普及，很可能会有使用 64 位浮点和整数的处理器。这是进步的本质。如果您使用 CGFloat 和朋友，您的代码将在 32 位和 64 位通用应用程序上编译而不会出现警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T00:25:01.973

如果 Apple 使用 CGFloat，你为什么会担心呢？使用与您正在调用的 api 调用匹配的类型。如果 CGFloat 是内存问题，我们的手机都会崩溃。

# javascript - 将所有内容替换为 内容 在 jQuery 中

> ID：11874454
> 
> 赞同：0
> 
> 时间：2012-08-08T23:00:44.177
> 
> 标签：javascript, jquery, html

如何从我的 HTML 代码中删除所有标签： `table`、、、 ？最后我想补充所有`tbody``tr`

```
<td>
    <input id="selectOne" type="radio" value="1" name="selectOneRadio">   
</td> 
```

和

```
<li>
    <input id="selectOne" type="radio" value="1" name="selectOneRadio"> 
</li> 
```

我需要一个 jQuery 函数。请帮我 ：）

```
<table>
    <tbody>
        <tr>
            <td>
                <input id="selectOne" type="radio" value="1" name="selectOneRadio">
                <label for="selectOne">
            </td>  
       </tr>    
    </tbody>
</table> 
```

* * *

*从评论...*

该`label`元素应该保留。我试过：

```
$('table td').each(function () {
    $(this).replaceWith(function () {
        return $('<li>' + this.innerHTML + '</li>')
    })
}); 
```

接着

```
jQuery.fn.unwrap = function (el) {
    return this.each(function () {
        $(this.childNodes).appendTo(this.parentNode);
    });
};
$('tr, table, tbody').unwrap().remove(); 
```

但这对我不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:06:12.477

用 . 创建一个列表`document.createElement`。然后循环遍历表的`rows[]`数组，对于每个数组，获取`cells[]`数组并执行所需的操作以将其放入列表项中（可能`document.createElement`是创建列表项，然后将`innerHTML`单元格的复制到其中）。

完成后，使用`insertBefore`将列表放在桌子所在的位置，最后使用`removeChild`摆脱桌子。

* * *

上述实现：

```
function replaceTableWithList(tableid) {
    var table = document.getElementById(tableid),
        rows = table.rows, cells, list = document.createElement('ul'),
        len = rows.length, i, item;
    for( i=0; i<len, i++) {
        item = list.appendChild(document.createElement('li'));
        cells = rows[i].cells;
        while(cells[0].firstChild) item.appendChild(cells[0].firstChild);
        // this only gets the contents of the first cell in a row
        // to get the whole row will need another loop
    }
    table.parentNode.replaceChild(list,table);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:21:07.093

我会使用展开/包装功能：

`$('table').contents().unwrap(); $('tr').contents().unwrap(); $('td').contents().unwrap().wrap('<li/>');`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T23:40:52.130

我会将您的桌子包装在某种容器中：

```
<div id="content">
    <table>
        <tbody>
            <tr>
                <td>
                    <input type="radio" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="radio" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="radio" />
                </td>
            </tr>
        </tbody>
    </table>
</div>​​​​ 
```

然后使用 jQuery 并执行以下操作：

```
// Hide the table
$('#content table').hide();

// Append a ul to the content div
$('<ul />').appendTo('#content');

// For each td, wrap children in an li and append to the ul​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​
$('#content table td').each(function (index, element) {
    $(element).children().appendTo('#content ul').wrap('<li />');
}); 
```

# android - 创建细致入微的 android 操作栏渐变（如在foursquare、instagram 上所见）

> ID：11874455
> 
> 赞同：1
> 
> 时间：2012-08-08T23:00:49.033
> 
> 标签：android, user-interface, gradient, photoshop, adobe-illustrator

我正在尝试生成在foursquare（左）和instagram（右）等应用程序上看到的细微渐变：

![四方](../Images/1d7c658d58f1341f0ee6f7c995bcad26.png) ![Instagram](../Images/c5942f4a9f73fd786bc8c903a6557eac.png)

我使用 illustrator 和基本的 android 形状为操作栏生成了一个简单的渐变。不幸的是，我的渐变看起来像这样：

![我无聊的渐变](../Images/3aa51ee8890ce3d8dde7cccf6c260330.png)

它缺少上述操作栏中的“spackled”细微差别，并将其替换为不幸的“streaking”，我想知道 android 中是否有一种方法可以以编程方式生成此类渐变，或者是否有人对使用创建此类渐变有任何提示插画师/photoshop。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:06:18.573

我怀疑任何应用程序都会即时生成这些，但很高兴被证明是错误的。

您可以查看[http://subtlepatterns.com](http://subtlepatterns.com)之类的网站，该网站具有知识共享许可的 spackle，可能适合您的批发需求或进行一些适度调整。

# rally - RallyComboBox 下拉后清除过滤器

> ID：11874456
> 
> 赞同：0
> 
> 时间：2012-08-08T23:00:54.953
> 
> 标签：rally

我使用以下代码创建了一个简单的 RallyComboBox：

```
Ext.define('CustomApp', {
extend: 'Rally.app.App',
componentCls: 'app',

items: [
    { xtype: 'container', itemId: 'toolbar', cls: 'toolbar' }
],

launch: function() {
    this.nameBox = this.down('#toolbar').add({
        xtype: 'rallycombobox',
        storeConfig: {
            model: 'User',
            autoLoad: true,
            filters: [
                {
                    property: 'FirstName',
                    value: 'Conner'
                }
            ]
        }
    });
}
}); 
```

该框正确渲染，并且首先应用了过滤器。问题是，在我单击箭头展开下拉列表后，过滤器被清除，所有用户都显示在下拉列表中。我已经搜索了文档，但仍然不确定是什么原因造成的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:20:35.930

我认为您需要在 storeConfig 中指定以下内容以防止外部过滤：

```
remoteFilter: false 
```

当您使用它时，您也可以设置以下内容：

```
remoteGroup: false,
remoteSort: false 
```

# c# - 在 C# 中快速将多个图像保存到磁盘

> ID：11874457
> 
> 赞同：2
> 
> 时间：2012-08-08T23:01:10.557
> 
> 标签：c#, image

我有一个 C# 程序，它在处理大量图像后将它们保存到磁盘。由于需要保存这么多图像，这似乎需要相当长的时间。

现在，我想知道：有什么方法可以加快在 C# 中保存图像的速度？目前，我正在使用标准的[bmp.Save(filename)](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.save.aspx)方法。

如果有帮助，图像生成过程的一部分涉及使用锁定位更快地访问和修改像素值，所以也许当我这样做时，图像可以同时保存到磁盘？如果这个想法很愚蠢，我深表歉意，但我对 C# 还是有些陌生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T23:05:43.253

您当然可以为每个图像保存启动一个新线程。这会减少一点时间，但磁盘会成为瓶颈。

另一种选择是将图像保存到临时缓冲区列表中，然后将控制权返回给程序。然后有一个线程在后台将每个写入磁盘。当然，这只会使这种情况迅速发生。不过，它可能会满足您的需求。

我确信 .NET 已经实现了某种异步 I/O 来为您执行此操作。我知道 Windows 有，所以它在 .NET 中是有道理的。

这可能会有所帮助。

[http://msdn.microsoft.com/en-us/library/kztecsys(v=vs.71).aspx](http://msdn.microsoft.com/en-us/library/kztecsys(v=vs.71).aspx)

# c++ - c++ 未处理的异常 LoadImage() 与 MAKEINTRESOURCE

> ID：11874459
> 
> 赞同：0
> 
> 时间：2012-08-08T23:01:16.923
> 
> 标签：c++, resources, loadimage

我在将位图图像添加到静态控制框时遇到问题，当我运行程序时出现未处理的异常。这是我的代码。

从 RC 文件：

```
ID_ICON1    BITMAP  "icon1.bmp" 
```

CPP文件：

```
HANDLE bIcon1;
HWND hIcon;             
hIcon = CreateWindowEx(0, "Static", NULL, WS_CHILD | WS_VISIBLE|SS_BITMAP, 250, 100, 100, 100, hwnd, NULL, GetModuleHandle(NULL), NULL);
bIcon1 = LoadImage(GetModuleHandle(NULL), MAKEINTRESOURCE(ID_ICON1), IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE| LR_DEFAULTSIZE); 
```

如果我使用完整路径，则不会出现错误，并且 bmp 显示正确：

```
bIcon1 = LoadImage(GetModuleHandle(NULL), "c:\\icon1.bmp", IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE| LR_DEFAULTSIZE); 
```

感谢您的帮助:)

编辑：例外的行是这一行：

```
bIcon1 = LoadImage(GetModuleHandle(NULL), MAKEINTRESOURCE(ID_ICON1), IMAGE_BITMAP, 0, 0, LR_LOADFROMFILE| LR_DEFAULTSIZE); 
```

消息异常是：windows2.exe 中 0x7768e41b 处的未处理异常：0xC0000005：访问冲突读取位置 0x000001f4。

> windows2.exe!WndProc(HWND__ * hwnd, unsigned int msg, unsigned int wParam, long lParam) 第 153 行 + 0x27 字节 C++

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:54:29.813

您正在传递，`LR_LOADFROMFILE`但第二个参数不是文件名。删除该标志。

# ruby-on-rails-3 - 没有控制器的渲染布局

> ID：11874462
> 
> 赞同：1
> 
> 时间：2012-08-08T23:01:49.330
> 
> 标签：ruby-on-rails-3, backbone.js

我正在编写一个带有主干的 Rails 3.2 应用程序，因为我只需要 rails 来呈现一个页面，我不需要控制器来支持索引页面。

有没有办法在没有控制器的情况下呈现布局（application.html.erb）？我想这将是 routes.rb 文件中的配置？

我的第一个想法是将其移动到 /public 目录中的 index.html 中，但我需要利用 erb 来获取 javascript 包含和 CSRF 助手等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:07:44.910

我知道您不需要控制器来做任何事情，但 Rails 是“自以为是”的软件；它需要一个控制器和一个视图，因为这是它的设计方式，而试图解决这个问题会给你带来很多麻烦。

只是

1.  在中创建一个空的控制器类`/app/controllers/main_controller.rb`
2.  创建一个空视图文件`/app/views/main/index.html.erb`
3.  设置一条路线，例如`:root => 'main#index'`

十分简单。

# actionscript-3 - AS3 ScrollPane 项目数

> ID：11874466
> 
> 赞同：0
> 
> 时间：2012-08-08T23:02:14.150
> 
> 标签：actionscript-3, flash, scrollpane

每个人。

我可以从 Flash 中的 ScrollPane 组件中获取多个项目吗？如果是，那么如何？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:24:06.593

[http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObjectContainer.html#numChildren](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObjectContainer.html#numChildren)

如果您正在谈论的对象是相关 ScrollPane 的实际直接后代，则应该有一个 numChildren。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:24:52.700

ScrollPane 有一项是源参数。如果您想知道该源中的所有子项（它是一个 DisplayObjectContainer），您可以使用 SOURCE 的 .numChildren 属性。

如果你想要所有的子孩子，你可以遍历所有的孩子，直到你有你的最终数字：

```
var d:DisplayObjectContainer = scrollPane.source;

function countChildren(container:DisplayObjectContainer):int {
    var count:int = container.numChildren;
    var tmp:DisplayObject;
    var i:int = count;
    while(i--){
        tmp = container.getChildAt(i);
        if(tmp is DisplayObjectContainer){
            count += countChildren(tmp);
        }
    }
    return count;
} 
```

所以用scrollPane的源调用countChildren()。

```
if(scrollPane.source is DisplayObjectContainer){
    countChildren(DisplayObjectContainer(scrollPane.source));
} 
```

# java - 重新启动后应用程序失去触摸输入

> ID：11874470
> 
> 赞同：0
> 
> 时间：2012-08-08T23:02:36.717
> 
> 标签：java, android

我正在android上编写一个2D引擎。我可以接收触摸输入并根据触摸事件更新我的场景，但存在问题。当我在失去焦点后重新启动应用程序（单击主屏幕按钮、接听电话等）时，我无法再接收触摸输入，屏幕仍然显示内容但它保持冻结状态。有没有办法解决这个问题？

这是代码：

```
import android.os.Bundle;
import android.os.PowerManager;
import android.os.PowerManager.WakeLock;
import android.app.Activity;
import android.view.MotionEvent;
import android.view.SurfaceView;
import android.view.SurfaceHolder;
import android.view.View;
import android.view.View.OnTouchListener;
import android.view.Window;
import android.view.WindowManager;
import android.media.AudioManager;
import android.content.Context;
import android.content.Intent;
import android.graphics.Color;
import android.util.DisplayMetrics;

public class SolarFighter extends Activity implements OnTouchListener
{
Game            game;
GraphicsManager graphicsMan;
SoundManager    soundMan;
ErrorManager    errorMan;
FrameSetManager frameSetMan;
SpriteManager   spriteMan;
InputManager    inputMan;
WakeLock        wakeLock;

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);

    //
    //Go full screen
    //

    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN,
    WindowManager.LayoutParams.FLAG_FULLSCREEN);

    PowerManager powerManager = (PowerManager)getSystemService(Context.POWER_SERVICE);
    wakeLock                  = powerManager.newWakeLock(PowerManager.FULL_WAKE_LOCK, "My Lock");

    //
    // Get system information
    //

    DisplayMetrics displaymetrics = new DisplayMetrics();

    getWindowManager().getDefaultDisplay().getMetrics(displaymetrics);

    int height = displaymetrics.heightPixels;
    int width  = displaymetrics.widthPixels;

    //
    // Create Graphics Manager and load spriteSheets load fonts
    //

    graphicsMan = new GraphicsManager(width,height,this);
    graphicsMan.addFont(0, "fonts/font.ttf", this);      

    //
    // Create Sound Manager and add sounds
    //

    setVolumeControlStream(AudioManager.STREAM_MUSIC);

    //
    // Create Input Manager
    //
    inputMan = new InputManager();

    //
    // Create Frame Set Manager and add frame sets
    //

    //
    // Create Sprite Manager and add sprites
    //

    //
    // Create Entity Manager and add entities
    //

    //
    // Create Game
    //

    game = new Game(this);

    game.setOnTouchListener(this);  
    setContentView(game);

}

public void onResume() 
{
    super.onResume();

    wakeLock.acquire();

    game.resume();
}

public void onPause()
{
    super.onPause();

    wakeLock.release();

    game.pause();
}

public boolean onTouch(View v, MotionEvent event) 
{
    switch (event.getAction())
    {
        case MotionEvent.ACTION_DOWN:
            inputMan.setTouchState(InputManager.TOUCH_DOWN);
            inputMan.setLastX((int)(event.getX()));
            inputMan.setLastY((int)(event.getY()));
        break;

        case MotionEvent.ACTION_MOVE:
            inputMan.setTouchState(InputManager.TOUCH_MOVE);    
            inputMan.setCurrentX((int)(event.getX()));
            inputMan.setCurrentY((int)(event.getY()));
            inputMan.setRelativeX(inputMan.getCurrentX() - inputMan.getLastX());
            inputMan.setRelativeY(inputMan.getCurrentY() - inputMan.getLastY());    
            inputMan.setLastX(inputMan.getCurrentX());
            inputMan.setLastY(inputMan.getCurrentY());
        break;

        case MotionEvent.ACTION_CANCEL:
            inputMan.setTouchState(InputManager.TOUCH_UP);
        break;

        case MotionEvent.ACTION_UP:
            inputMan.setTouchState(InputManager.TOUCH_UP);
        break;
    }
    return true;
}

class Game extends SurfaceView implements Runnable
{
    private Thread            renderThread = null;
    private SurfaceHolder     holder;
    private volatile boolean  running = false;  

    private int  x  = 0,y = 0;
    private int  xx = 250;
    private int  xy = 400;

    public Game(Context context)
    {
        super(context);

        holder = getHolder();   
    }

    public void resume() 
    {
        running      = true;
        renderThread = new Thread(this);

        renderThread.start();
    }

    public void run() 
    {
        while(running) 
        {
            if(!holder.getSurface().isValid())
            {
                continue;
            }

            //
            // Update Scene
            //

            //
            // Render scene
            //

            graphicsMan.beginScene(holder);
            graphicsMan.clearScene();   
            x = inputMan.getRelativeX();
            y = inputMan.getRelativeY();
            if(inputMan.getTouchState() == InputManager.TOUCH_MOVE)
            {
                xx += x;
                xy += y;
            }
            graphicsMan.drawText(0, "X", Color.RED,40,xx, xy);
            graphicsMan.endScene(holder);
        }
    }

    public void pause() 
    {
        running = false;

        while(true) 
        {
            try 
            {
                renderThread.join();
            } 
            catch (InterruptedException e)
            {
                // retry
            }
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T14:42:08.930

我摆脱了Game的暂停方法的整个while语句，问题就解决了。

# javascript - jquery列表拖拽

> ID：11874474
> 
> 赞同：0
> 
> 时间：2012-08-08T23:02:57.173
> 
> 标签：javascript, jquery

我有一个 Jquery 拖放列表，我想使用 Jquery Ajax Post 在 MYSQL 中立即更新它。

因为我可以在列表之间拖动元素（多个列表），所以我需要获取父 ID（父是列表类别 ID - 可拖动对象被拖动到的位置）

当我从一个类别/列表拖到另一个时，我总是得到前一个 ID..

例如：

类别 1 ------------ 类别 2

如果我要将某些东西从 CAT1 拖到 CAT2 - ID 将是 CAT1 而不是新的类别 ID...

我在下面添加了我的代码：

**查询：**

```
<script src="js/jquery.min.js" type="text/javascript"></script>
    <script src="js/jquery.ui.core.js"></script>
    <script src="js/jquery.ui.widget.js"></script>
    <script src="js/jquery.ui.mouse.js"></script>
    <script src="js/jquery.ui.sortable.js"></script>
<script>
    $(function() {
        $( "#sortable1, #sortable2" ).sortable({
            connectWith: ".connectedSortable"
        }).disableSelection();
    });
    </script>

    <script type="text/javascript">
    $(document).ready(function(){
    $(".mouseup").mouseleave(function(){
    var sparent = $(this).parent().attr("id");
    alert(sparent);
    });
    });
    </script> 
```

**列表 HTML：**

```
<div class="demo">
<div class="box">
<ul id="sortable1" class="connectedSortable">
    <li class="ui-state-default mouseup">Item 1</li>
    <li class="ui-state-default mouseup">Item 2</li>
</ul>
</div>
<div class="box">
<ul id="sortable2" class="connectedSortable">
    <li class="ui-state-highlight mouseup">Item 1</li>
    <li class="ui-state-highlight mouseup">Item 2</li>
</ul>
</div>
</div> 
```

任何帮助，将不胜感激。

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:20:56.477

你想要的在这里：http: [//jqueryui.com/demos/draggable/#events](http://jqueryui.com/demos/draggable/#events)

```
$( "#sortable1, #sortable2" ).sortable({
    connectWith: ".connectedSortable",
    stop: function(event, ui) { alert($(ui.item).parent().attr("id") }
}).disableSelection(); 
```

将您的代码放在停止回调中将允许您检查正确的 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:22:53.497

您需要处理的事件是`received`.

```
 $(".connectedSortable" ).on( "sortreceive", function(event, ui) { 
     alert(ui.item.parent()[0].id); 
     // also ui.sender will hold original list, from where element was taken
 }); 
```

已编辑：取决于您是否需要处理刚刚重新排序项目时的情况，即您在同一个列表中拖放，或者您不打算使用`received`或`stop`事件。 `received`只有在您拖动到另一个列表时才会触发。 `stop`即使您将项目留在同一个列表中，也会触发。

# c# - 如何删除 SelectListItem 中的项目

> ID：11874476
> 
> 赞同：2
> 
> 时间：2012-08-08T23:03:05.243
> 
> 标签：c#, c#-4.0

我正在尝试从 selectlistitem 中删除一个项目。到目前为止，我还没有取得任何成功

这是代码的快照

使用 System.Collections.Generic；

```
 List<SelectListItem> abcd = new List<SelectListItem>();
        SelectListItem i1 = null;
        i1 = new SelectListItem();
        i1.Text = "t0";
        i1.Value = "v0";
        i1.Selected = false;
        abcd.Add(i1);
        i1 = new SelectListItem();
        i1.Text = "";
        i1.Value = "";
        i1.Selected = false;
        abcd.Add(i1);
        i1 = new SelectListItem();
        i1.Text = "t1";
        i1.Value = "v1";
        i1.Selected = false;
        abcd.Add(i1); 
```

我试图删除与以下内容匹配的 abcd 项目之一：

```
 SelectListItem f = new SelectListItem();
        f.Selected = false;
        f.Text = "t0";
        f.Value = "v0";
        f.Selected = false;

        int x = abcd.IndexOf(f);  //return -1
        bool b = abcd.Remove(f); //return false 
```

...但它没有删除。我试图找到索引，它总是返回 -1 由于我不知道特定列表的位置，removeat 方法将无济于事。

非常感谢你的帮助

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-08T23:11:13.763

如果我理解正确，这应该可以。您将需要对其进行修改以处理存在多个 SelectListItem 值与您要删除的值的情况，或者如果没有 SelectListItem 具有您的值。

```
abcd.Remove(abcd.Where(c => c.Value == "v0").Single()); 
```

或者

```
abcd = abcd.Where(c => c.Value != "v0").ToList(); 
```

或者

```
abcd.RemoveAll(c => c.Value == "v0"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:12:29.840

您似乎认为从列表中删除恰好与现有项具有相同值的**新**实例`SelectListItem`将导致现有项被删除。这是错误的。您将不得不保留对现有引用 ( `i1`) 的引用，或者先找到它并将其删除。后一种方法看起来像（对于一个项目）：

```
abcd.Remove(abcd.Single(x => x.Value == "v0")); 
```

或者（对于多个）：

```
abcd.RemoveRange(abcd.Where(x => x.Value == "v0")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T23:12:55.657

在引用类型中 X.Properties = Y.Properties 并不意味着 X=Y 所以：

```
SelectListItem f = abcd.Find(Itm=>Itm.Text == "t0" && Itm.Value == "v0" &&  Itm.Selected == false) 
```

然后根据您的需要调整您的状况

```
 int x = abcd.IndexOf(f);  //return -1
    bool b = abcd.Remove(f); //return false 
```

# javascript - 用 LESS 伪造 css 属性（并在解析时用真实属性替换它）

> ID：11874481
> 
> 赞同：0
> 
> 时间：2012-08-08T23:03:30.793
> 
> 标签：javascript, css, node.js, less

假设我想创建一个具有一些任意值的“假”（不支持浏览器，例如 { dimensions: 3; } ）css 属性，并在通过 LESS 解析它时，希望这个假 css 属性被替换为任何真正的 css属性（例如 { background: red; }）——有谁知道这样的事情会怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:11:33.877

不完全确定你想在这里实现什么......我的建议是做这样的事情：

```
.dimension {
  background: red;
}

.realClassOne {
  font-size: 14px; /* some normal css */
  ...
  .dimension;  /* will apply all styles in dimension to this class */
} 
```

我想这就是你要找的。应该工作得很好。

您可能还想看看参数 mixins 以获得更复杂和更强大的行为（这是 less 真正发挥作用的地方！）[http://lesscss.org/#-parametric-mixins](http://lesscss.org/#-parametric-mixins)

# html - Facebook 赞按钮消失

> ID：11874487
> 
> 赞同：4
> 
> 时间：2012-08-08T23:04:09.840
> 
> 标签：html, facebook

我的站点中的 Facebook Like 按钮有问题：添加此代码（由 facebook 提供）

```
<iframe allowtransparency="true" frameBorder="0" src="//www.facebook.com/plugins/like.php?href=http://my.site.com/folder/&send=false&layout=button_count&width=120&show_faces=false&action=like&colorscheme=light&font&height=20" style="border:none; overflow:hidden; width:450px; height:20px;"> 
```

按钮在创建时正确显示在任何页面中，几天后在某些页面上 iframe 仍然为空，因为 Facebook 不再发送按钮代码。

我试图解决最终的 url 问题并更改一些 url 我注意到按钮显示在新的 url 中，几天后一些页面丢失了按钮。

这是加载没有 Like 按钮的页面后来自 Facebook 的所有代码：

```
<html lang="it" id="facebook" class="no_js">
<head>
<meta charset="utf-8"/>
<meta name="robots" content="noodp, noydir"/>
<meta name="referrer" content="default" id="meta_referrer"/>
<meta name="description" content=" Facebook è una piattaforma sociale che ti consente di connetterti con i tuoi amici e con chiunque lavori, studi e viva vicino a te. Puoi usare Facebook per rimanere in contatto con i tuoi amici, caricare tutte le foto che vuoi, pubblicare link e video o per saperne di più sulle persone che incontri."/>
<script/>
<title>Facebook</title>
<script>var onloadRegister_DEPRECATED=function(){},onafterloadRegister_DEPRECATED=function(){},ServerJSQueue={add:function(){}};
</script>
<style type="text/css"> div.fbNubFlyoutBody.scrollable{position:inherit}
</style>
<script>ServerJSQueue.add({"require":[["lowerDomain"],["Primer"]]});</script>
</head>
<body class="opera Locale_it_IT">
<div id="FB_HiddenContainer" style="position:absolute; top:-10000px; width:0px; height:0px;"/>
<script>function envFlush(a){function b(c){for(var d in a)c[d]=a[d];}if(window.requireLazy){requireLazy(['Env'],b);}else{Env=window.Env||{};b(Env);}}
envFlush        ({"fb_dtsg":"XXXXXXXXXX","ajaxpipe_token":"XXXXXXXXXXXXXXXX","lhsh":"XXXXXXXXX","user":"XXXXXXXXXXXXXXX"});</script>
<script>
</script>
</body>
</html> 
```

最明显的区别在于：

```
<html lang="it" id="facebook" class="no_js"> 
```

在工作页面中有class=""。在工作页面中还有很多代码......

任何人都可以提供帮助或提示让我了解发生了什么吗？

* * *

感谢您的回答，但这不是解决方案，这是 facebook 提供的代码，正如我所说的在创建 url 时有效，并且仅对于某些页面，几天后停止工作。无论如何，我在 facebook 开发者网站上发现这是一个中等优先级的已知错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-23T15:00:10.147

看来这可能是这个错误：

[http://developers.facebook.com/bugs/335818753176892/](http://developers.facebook.com/bugs/335818753176892/)

[http://developers.facebook.com/bugs/130242697118406/](http://developers.facebook.com/bugs/130242697118406/)

本质上，如果您创建“赞”按钮的 Facebook 应用程序是：

*   在“沙盒”模式下，或
*   与生成“赞”按钮的域不同

那么就会出现这个问题。这两个都可以通过转到[https://developers.facebook.com/apps/](https://developers.facebook.com/apps/)并选择有问题的应用程序来更改。

就我而言，我最初将 App URL 设置为`localhost`用于开发。我已经添加了正确的 URL 以及我们使用的子域，但它还没有重新开始工作。我会在我去的时候用更多信息更新这个答案......

**更新**

这不起作用，尽管建议更改应用程序设置。我现在正在研究其他异步调用的这个问题：

[http://developers.facebook.com/bugs/353458578076232?browse=search_506192588df614017400920](http://developers.facebook.com/bugs/353458578076232?browse=search_506192588df614017400920)

看起来其他人也有同样的问题：

[http://developers.facebook.com/bugs/498181603534748?browse=search_506192588df614017400920](http://developers.facebook.com/bugs/498181603534748?browse=search_506192588df614017400920)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-11T02:26:16.370

ifream的链接错了你要加http://

```
<iframe allowtransparency="true" frameBorder="0" src="http://www.facebook.com/plugins/like.php?href=http://my.site.com/folder/&send=false&layout=button_count&width=120&show_faces=false&action=like&colorscheme=light&font&height=20" style="border:none; overflow:hidden; width:450px; height:20px;"> 
```

# java - 使用共享的 ExecutorService 作为任务队列，我如何知道作业何时完成？

> ID：11874488
> 
> 赞同：0
> 
> 时间：2012-08-08T23:04:18.933
> 
> 标签：java, concurrency, threadpool

我有一个处理较大作业的 JobService。作业被动态细分为多个任务，任务也可能产生子任务等，因此无法预测一个作业的任务总数。每个任务自己排队运行`ExecutorService.submit(...)` 问题是我似乎必须为每个作业创建一个单独的 ExecutorService ，因为判断“作业队列”何时完成的唯一方法是使用`ExecutorService.awaitTermination(...)`. 不过，这似乎效率低下，因为[我无法](https://stackoverflow.com/questions/368613/is-it-possible-for-two-executorservices-to-share-a-thread-pool)在作业和它们的 ExecutorService 之间共享单个线程池。

我正在寻找一些替代方案，我正在考虑为每项工作使用 AtomicInteger。提交新任务时递增，任务完成时递减。但是我必须轮询它什么时候为零，这看起来很混乱，还有一些异常处理混乱。

似乎必须有更好的解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T03:02:00.053

Submit 返回一个 Future 对象，该对象可用于等待任务完成。您可以跟踪这些并添加一个递归阻塞直到所有子任务完成的方法。这样，您可以在任何需要的地方重用执行器。

```
import java.util.ArrayList;
import java.util.Collection;
import java.util.List;
import java.util.concurrent.ExecutionException;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.Future;
import java.util.concurrent.atomic.AtomicBoolean;

public class JobExecutor {
    ExecutorService executorService = Executors.newFixedThreadPool(1);

    private class Task implements Runnable {
        private final String name;
        private final Task[] subtasks;
        private final ExecutorService executorService;
        private volatile boolean started = false;
        private Future<?> taskFuture;

        // Separate list from subtasks because this is what you'll probably
        // actually use as you may not be passing subtasks as constructor args
        private final List<Task> subtasksToWaitOn = new ArrayList<Task>();

        public Task(String name, ExecutorService executorService,
                Task... subtasks) {
            this.name = name;
            this.executorService = executorService;
            this.subtasks = subtasks;
        }

        public synchronized void start() {
            if (!started) {
                started = true;
                taskFuture = executorService.submit(this);
            }
        }

        public synchronized void blockTillDone() {
            if (started) {
                try {
                    taskFuture.get();
                } catch (InterruptedException e) {
                    // TODO Handle
                } catch (ExecutionException e) {
                    // TODO Handle
                }
                for (Task subtaskToWaitOn : subtasksToWaitOn) {
                    subtaskToWaitOn.blockTillDone();
                }
            } else {
                // TODO throw exception
            }
        }

        @Override
        public void run() {
            for (Task subtask : subtasks) {
                subtask.start();
                subtasksToWaitOn.add(subtask);
            }
            System.out.println("My name is: " + name);
        }
    }

    void testSubmit() {
        Task subsubTask1 = new Task("Subsubtask1", executorService);
        Task subtask1 = new Task("Subtask1", executorService, subsubTask1);
        Task subtask2 = new Task("Subtask2", executorService);
        Task subtask3 = new Task("Subtask3", executorService);
        Task job = new Task("Job", executorService, subtask1, subtask2,
                subtask3);
        job.start();
        job.blockTillDone();
        System.out.println("Job done!");
    }

    public static void main(String[] args) {
        new JobExecutor().testSubmit();
    }
} 
```

打印出来：

```
My name is: Job
My name is: Subtask1
My name is: Subtask2
My name is: Subtask3
My name is: Subsubtask1
Job done! 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T04:17:57.890

如果您使用的是 java7（或带有 backport 库[http://www.cs.washington.edu/homes/djg/teachingMaterials/grossmanSPAC_forkJoinFramework.html](http://www.cs.washington.edu/homes/djg/teachingMaterials/grossmanSPAC_forkJoinFramework.html)的 java6 ），您可能需要考虑使用 Fork-Join 池进行此类事物：

```
class MainTask extends RecursiveTask<Long> {

    @Override
    protected Long compute() {
        SubTask subtask0 = new SubTask(0L);
        SubTask subtask1 = new SubTask(1L);
        SubTask subtask2 = new SubTask(2L);
        SubTask subtask3 = new SubTask(3L);
        SubTask subtask4 = new SubTask(4L);
        SubTask subtask5 = new SubTask(5L);

        subtask1.fork();
        subtask2.fork();
        subtask3.fork();
        subtask4.fork();
        subtask5.fork();

        return subtask0.compute() +
                subtask1.join() +
                subtask2.join() +
                subtask3.join() +
                subtask4.join() +
                subtask5.join();
    }

}

class SubTask extends RecursiveTask<Long> {
    private Long rawResult = null;

    private Long expected = null;

    public SubTask(long expected) {
        this.expected = expected;
    }

    @Override
    protected Long compute() {
        return expected;
    }
}

public static void main( String[] args )
{
    ForkJoinPool forkJoinPool = new ForkJoinPool();
    Long result = forkJoinPool.invoke(new MainTask());
    System.out.println(result);
} 
```

显然，这具有硬编码的子任务，但是没有理由不能将参数传递给主任务，并使用它来生成子任务。子任务本身不必都是同一类型，但它们都应该扩展 RecursiveTask。实际上，如果一个任务生成子任务（如上面的 MainTask），至少其中一个子任务应该直接在其上调用“计算”​​（而不是分叉和连接），以便当前线程可以执行一些计算，并让其他线程完成其余的工作。

# php - AMQP_MANDATORY 标志在 PHP 中不起作用（带 RabbitMQ）

> ID：11874490
> 
> 赞同：0
> 
> 时间：2012-08-08T23:04:34.303
> 
> 标签：php, rabbitmq, amqp

`RabbitMQ`向in发布消息时，即使未找到交换`PHP`，该`AMQPExchange->publish`方法也会返回。`true`我正在设置`AMQP_MANDATORY`旗帜。这是代码：

```
$myExchange->publish($myMessage, $myRoutingKey, AMQP_MANDATORY, $myOptions); 
```

我知道我正在以有效的方式使用该方法，因为它可以工作，但是如果我给它提供一个不存在的交换或队列，它仍然返回 true。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T17:14:44.780

强制，如立即，不会使发布操作失败，而是在 AMQP 客户端的返回通道上返回消息。因此，您需要检查消息是否已返回，以了解有关此强制性出版物的问题。

相关：请参阅此评论`AMQPExchange::publish`：[http ://www.php.net/manual/en/amqpexchange.publish.php#106987](http://www.php.net/manual/en/amqpexchange.publish.php#106987)

# xml - AJAX XML 加载在带有本地文件的果酱中不起作用

> ID：11874491
> 
> 赞同：0
> 
> 时间：2012-08-08T23:04:47.333
> 
> 标签：xml, jquery, cordova, marmalade

只是尝试使用以下 jQuery 代码在我的 Marmalade Web 应用程序（基于 PhoneGap）中加载一个简单的 XML 文件：

```
$.ajax({
    type: "GET",
    url: "books.xml",
    dataType: "xml",
    success: function(xml) {
        alert("SUCCESS");
    },
    error: function(result) {     
            alert("FAILED : " + result.status + ' ' + result.statusText);  
    }
}); 
```

但是，我收到 404 错误。该文件与包含上述 JavaScript 的 HTML 文件位于同一目录中。我还尝试将“file:///”添加到 URL 的开头，但无济于事。

搜索了几个小时后，我没有找到解决该问题的方法。有任何想法吗？

感谢您的帮助！-SL

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T14:03:51.307

我要做的第一件事就是把 jQuery 排除在外，然后尝试一个普通的 AJAX 调用：

```
var request = new XMLHttpRequest();
request.open("GET", "books.xml", true);
request.onreadystatechange = function() {
    if (request.readyState == 4) {
        if (request.status == 200 || request.status == 0) {
            alert("SUCCESS");
            var books = request.responseXML;
        }
    }
}
request.send(); 
```

如果 books.xml 与您的 HTML 文件位于同一目录中，则应该可以正常工作。

# c++ - 在 c++ 中编译但在 c (gcc) 中编译时复杂

> ID：11874494
> 
> 赞同：6
> 
> 时间：2012-08-08T23:05:01.150
> 
> 标签：c++, c, gcc, compiler-errors, g++

我在 c++ 中的乘法声明有问题，但在 c 中没有。您可以查看代码以获取更多信息。

文件 main.c

```
#ifndef VAR
#define VAR
int var;
#endif
int main(){} 
```

文件其他.c

```
#ifndef VAR
#define VAR
int var;
#endif 
```

用 gcc 编译

```
gcc main.c other.c
>> success 
```

用 g++ 编译

```
g++ main.c other.c
Output:
/tmp/ccbd0ACf.o:(.bss+0x0): multiple definition of `var'
/tmp/cc8dweC0.o:(.bss+0x0): first defined here
collect2: ld returned 1 exit status 
```

* * *

我的 gcc 和 g++ 版本：

```
gcc --version
gcc (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3
Copyright (C) 2011 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

g++ --version
g++ (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3
Copyright (C) 2011 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-08T23:15:06.860

由于 variable 的多个定义，您的代码在 C 和 C++ 中的形式都不正确`var`。只是这种类型的错误传统上被 C 编译器忽略为流行的非标准扩展。这个扩展甚至在 C 语言规范中被提及

> **J.5 通用扩展**
> 
> 以下扩展在许多系统中广泛使用，但不能移植到所有实现中。[...]
> 
> **J.5.11 多个外部定义**
> 
> 一个对象的标识符可能有多个外部定义，无论是否显式使用关键字 extern；如果定义不一致，或者不止一个被初始化，则行为未定义（6.9.2）。

但从形式上讲，在 C 和 C++ 语言中，您都会遇到完全相同的多重定义错误。要求你的 C 编译器表现得更迂腐（禁用扩展，如果它有一个选项），你的 C 编译器也会产生与你的 C++ 编译器相同的错误。

同样，您的代码包含变量的多个定义`var`，这在 C 和 C++ 中都是错误的。您的`#ifdef`指令根本没有解决任何问题。预处理指令在这里无法为您提供帮助。预处理器在每个翻译单元中本地独立地工作。它无法跨翻译单元查看。

如果您想创建一个*全局*变量（即所有翻译单元共享的同一个变量），您需要对该变量进行*一个且只有一个定义*

```
int var; 
```

在一个且只有一个翻译单元中。所有其他翻译单元应收到非定义声明`var`

```
extern int var; 
```

后者通常放在头文件中。

如果您在每个翻译单元中需要一个单独的自变量`var`，只需在每个翻译单元中将其定义为

```
static int var; 
```

（尽管在 C++ 中这种用法`static`现在已被无名命名空间弃用并取代）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:11:31.440

这两个`#define`指令彼此无关，因为它们位于不同的翻译单元（即源文件）中。编译器完全隔离地处理这两个源文件，因此`defined(VAR)`始终为 false，并且`#ifndef`始终包含它们的内容。

如果您的意思是在多个源文件之间共享一个变量，有一种简单的方法可以做到这一点：在一个源文件中*定义*它，并在另一个源文件中*声明*它：

```
// other.cpp
int var;        // Definition.

// main.cpp
extern int var; // Declaration. 
```

链接时，这些将引用相同的`var`. 更好的是，在标头中声明变量：

```
// other.h
extern int var; 
```

然后需要`var`的文件可以简单地包含标题：

```
// main.cpp
#include "other.h" 
```

您观察到的 C 和 C++ 之间的差异与 C 与 C++ 中全局声明标识符的处理有关。在 C 中，链接器可以将任意数量的*暂定定义*（没有存储类说明符和初始化器）合并为一个符号——只要该符号的所有实际定义最终具有相同的链接和存储类。这是使用*弱*链接器符号完成的。

然而，C++ 没有暂定定义的概念，并将没有存储类说明符的外部声明视为定义。因此 G++ 会生成*强*链接器符号，从而导致链接时发生冲突。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-08T23:10:43.670

编译模块中全局变量的可见性在 C 和 C++ 之间略有不同。

如果这些是不同的变量，请将它们包含在每个文件的匿名命名空间中。

```
namespace {
 int var;
} 
```

如果它们打算成为 SAME 变量，则其中之一需要一个`extern`decl 说明符，以避免多个定义。

```
extern int var; 
```

在您发布的示例中，您`#define VAR`没有做任何事情。该定义不跨编译模块进行。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-08T23:12:51.143

包含保护对于翻译单元是本地的。这意味着当您`#define VAR`在一个`.cpp`文件中执行时，它不会在任何其他文件中定义。

# c# - 从选定的行网格视图中检索值

> ID：11874496
> 
> 赞同：1
> 
> 时间：2012-08-08T23:05:09.950
> 
> 标签：c#, asp.net, gridview, textbox

我有一些数据绑定到 gridview，想知道是否可以检索选定行中的值并将这些值插入到一系列文本框或标签中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:18:21.160

是的，有可能。使用`FindControl`方法

*   [这是一个例子](http://www.codeproject.com/Articles/12021/Accessing-the-different-controls-inside-a-GridView)

重复

*   [如何在 GridView 的 TemplateField 中找到控件？](https://stackoverflow.com/questions/6873973/how-to-find-control-in-templatefield-of-gridview)
*   [使用 FindControl 在内容页面中获取 GridView](https://stackoverflow.com/questions/6525804/using-findcontrol-to-get-gridview-in-a-content-page)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:50:55.367

正如@codingbiz 所说：您可以使用`FindControl`and `TemplateField`。

这个例子：

EditGridView.aspx：

```
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="EditGridView.aspx.cs" Inherits="Q11874496WebApp.EditGridView" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" OnSelectedIndexChanged="GridView1_SelectedIndexChanged">
            <Columns>
                <asp:CommandField ShowSelectButton="True" />
                <asp:TemplateField HeaderText="Id" SortExpression="Id">
                    <ItemTemplate>
                        <asp:Label ID="LblId" runat="server" Text='<%# Bind("Id") %>'></asp:Label>
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="Name" SortExpression="Name">
                    <ItemTemplate>
                        <asp:Label ID="Lblname" runat="server" Text='<%# Bind("Name") %>'></asp:Label>
                    </ItemTemplate>
                </asp:TemplateField>
                <asp:TemplateField HeaderText="Phone" SortExpression="Phone">
                    <ItemTemplate>
                        <asp:Label ID="LblPhone" runat="server" Text='<%# Bind("Phone") %>'></asp:Label>
                    </ItemTemplate>
                </asp:TemplateField>
            </Columns>
        </asp:GridView>
    </div>
    &nbsp;Id:
    <asp:TextBox ID="TxtId" runat="server"></asp:TextBox>
    &nbsp;Name:
    <asp:TextBox ID="TxtName" runat="server"></asp:TextBox>
    &nbsp;Phone:
    <asp:TextBox ID="TxtPhone" runat="server"></asp:TextBox>
    <asp:Button ID="BtnUpdate" runat="server" OnClick="BtnUpdate_Click" Text="Update" />
    </form>
</body>
</html> 
```

EditGridView.aspx.cs：

```
public partial class EditGridView : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (!this.IsPostBack)
        {
            if (this.MyDataList.Count == 0)
            {
                this.populateData();
            }
            this.GridView1.DataSource = this.MyDataList;
            this.GridView1.DataBind();
        }
    }

    /// <summary>
    /// Data for the GridView. Encapsulates a list that will be in session.
    /// </summary>
    public IList<MyDataPoco> MyDataList
    {
        get
        {
            if (this.Session["MyDataList"] == null)
                this.Session["MyDataList"] = new List<MyDataPoco>();
            return (IList<MyDataPoco>)this.Session["MyDataList"];
        }
    }

    /// <summary>
    /// Creates a list of 10 items.
    /// </summary>
    private void populateData()
    {
        for (int i = 0; i < 10; i++)
        {
            this.MyDataList.Add(
                new MyDataPoco()
                {
                    Id = i.ToString(),
                    Name = "Name " + i,
                    Phone = i + "" + i + "" + i + "." + i + "" + i + "" + i + "" + i + ""
                });
        }
    }

    /// <summary>
    /// Here is the way you can get values from GridView.
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void GridView1_SelectedIndexChanged(object sender, EventArgs e)
    {
        GridViewRow row = this.GridView1.SelectedRow;
        Label LblId = (Label)row.FindControl("LblId");
        Label LblName = (Label)row.FindControl("LblName");
        Label LblPhone = (Label)row.FindControl("LblPhone");

        this.TxtId.Text = LblId.Text;
        this.TxtName.Text = LblName.Text;
        this.TxtPhone.Text = LblPhone.Text;
    }

    /// <summary>
    /// Updates the data in the GridView.
    /// </summary>
    /// <param name="sender"></param>
    /// <param name="e"></param>
    protected void BtnUpdate_Click(object sender, EventArgs e)
    {
        if (this.GridView1.SelectedIndex < 0)
        {
            this.ClientScript.RegisterStartupScript(
                this.GetType(),
                "alert",
                "alert('Select before...');", true);
        }
        else
        {
            MyDataPoco myDateItem = this.MyDataList[this.GridView1.SelectedIndex];
            myDateItem.Id = this.TxtId.Text;
            myDateItem.Name = this.TxtName.Text;
            myDateItem.Phone = this.TxtPhone.Text;

            this.GridView1.DataSource = this.MyDataList;
            this.GridView1.DataBind();
        }
    }
} 
```

MyDataPoco.cs：

```
public class MyDataPoco
{
    public String Id { get; set; }
    public String Name { get; set; }
    public String Phone { get; set; }
} 
```

完整来源：[Q11874496WebApp.7z](https://dl.dropbox.com/u/49510149/stackoverflow/dotnet/Q11874496WebApp.7z)

# ajax - 为什么 else 语句在这里不起作用？

> ID：11874502
> 
> 赞同：0
> 
> 时间：2012-08-08T23:05:43.980
> 
> 标签：ajax

以下代码在 else 语句下无法得到正确响应：

```
function ajax_response(){
 if(is_user_logged_in() && check_key() ){
    $result = $do_something;
     if($result){
        ajax_response_string(1,'success!');
      }else{
         ajax_response_string(-1,'there is a problem, please try again!');
      }
 }else{
   ajax_response_string(-1,'you must login first.');
} 
```

}

当我注销并尝试单击触发此 ajax 功能的链接时，我得到“未定义”的响应，它应该是“您必须先登录”。我哪里做错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T01:08:09.817

我只是想通了——这不是 else 语句，而是 ajax 响应 url 不适用于已注销的用户。所以，我的问题不再有效。如有必要，请关闭它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:27:39.600

您在 line 处有语法错误，`$result= //do something`因为该行没有终止。尝试这个：

```
function ajax_response()
{
     if(is_user_logged_in() && check_key() )
     {
        $result =  doSomething; //error was here as there was no line terminator (;) present.

         if($result)
         {
            ajax_response_string(1,'success!');

         }
          else  
          {
             ajax_response_string(-1,'there is a problem, please try again!');
          }
     }
     else
        {
           ajax_response_string(-1,'you must login first.');
        }

} 
```

# .net - 如何使用 EF 存储库的 find 方法？

> ID：11874507
> 
> 赞同：1
> 
> 时间：2012-08-08T23:06:21.800
> 
> 标签：.net, linq, entity-framework, c#-4.0, c#-3.0

我看到了一些使用 EF 通用存储库的示例。我对 LINQ 的掌握不是很牢，所以我无法理解如何使用这种方法。你能指导我吗？这是我的代码。我不知道如何将表达式传递给它。如果您可以举例说明，将高度赞赏。

```
 public IEnumerable<T> Query(Expression<Func<T, bool>> filter)
    {
        return objectSet.Where(filter);
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:25:09.947

您可以像使用 linq where 方法一样使用它。

例如，如果 T 是用户，您可以使用 Name 属性

```
Query(u=>u.Name == "Bob"); 
```

这种类型的表达式称为 lambda 表达式。有关更多详细信息，您可以查看[http://msdn.microsoft.com/en-us/library/bb397687.aspx](http://msdn.microsoft.com/en-us/library/bb397687.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:29:55.863

假设您创建了一个具体的存储库实现，您将调用这样的方法：

```
var repo = new StuffRepo();

IEnumerable<Stuff> stuff = repo.Query(s => s.SomeProperty == "Foo"); 
```

所以表达式或过滤器是一个匿名函数（[Func](http://www.dotnetperls.com/func)），它接受一个 T（在我的示例中，一个 Stuff，由别名“s”表示），并返回一个布尔值。所以在 SQL 中：

```
select *
from stuff s
where s.SomeProperty = "Foo" 
```

# jquery - Highcharts - 负值，将y轴设置为大于0？

> ID：11874508
> 
> 赞同：4
> 
> 时间：2012-08-08T23:06:25.687
> 
> 标签：jquery, highcharts

我正在使用 Highcharts，我正在尝试创建一个包含负值的柱形图，例如他们的示例：http: [//jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com /tree/master/samples/highcharts/demo/column-negative/](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/demo/column-negative/)

但是，我试图弄清楚如何设置基线 60。这样 x 和 y 在 -40 处相交，低于 65 的任何值都是负数据点。我一直在搜索，但到目前为止只找到了解释如何设置最小值和最大值的线程......

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-09T06:35:18.783

您可能正在寻找该`threshold`选项。

```
plotOptions: {
    series: {
        threshold: 100
    }
} 
```

[**演示**](http://jsfiddle.net/9dWgL/.)

# php - 散列/加盐后数据codeigniter

> ID：11874510
> 
> 赞同：0
> 
> 时间：2012-08-08T23:06:32.497
> 
> 标签：php, codeigniter, hash

我正在将创建的用户登录到帐户的尾端。我已经注释掉了我的流程，此后一切似乎都在进行，但是我错过了一两步，因为现在未对发布数据密码进行哈希处理。

控制器：

```
function validate_credentials()
    {
        // WHEN THE VIEW IS LOADED THIS FUNCTION IS CALLED AND LOADS MODEL AS WELL AS DEFINES THE SALT VARIABLE AND LOADS THE ENCRYPTING HELPER LIBRARY
        $this->load->model('user_model', 'um');
        $login = $this->input->post('submit');
        $salt = $this->_salt();
        $this->load->library('encrypt');

        //IF THE SUBMIT BUTTON IS TRIGGERED THE POST DATA IS SENT TO THE VALIDATE FUNCTION IN THE MODEL VIA VARIABLES CREATED 
        if($login)
        {

        $data = array(
            'email' => $this->input->post('email'),
            'password' => $this->encrypt->sha1($user->salt. $this->encrypt->sha1($this->input->post('password')))
            );

            $user = $this->um->validate($data);

        }

        // IF ITS A REAL USER OPEN THE GATE AND LET THEM IN
        if($user)
        {

            $this->session->set_userdata($data);
            redirect('account/dashboard');
        }

        else

        {
            $this->index();
        }
    } 
```

模型：

```
function validate($data)
{
    $this->output->enable_profiler(TRUE);

    // TAKING THE DATA FROM THE MODEL AND CHECKING IT AGAINST THE STORED INFO IN THE DB
    $query = $this->db->where($data)->get('users', 1);
    if($query->row())
    {
        return $query->row();
    }
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-10T07:59:57.507

`$user->salt`应该只是`$salt`。

# mysql - 在 ubuntu 12.04 中打开 3306 端口以允许从任何 ip 连接到 mysql

> ID：11874518
> 
> 赞同：7
> 
> 时间：2012-08-08T23:07:20.663
> 
> 标签：mysql, ubuntu

我有一个在服务器上运行的 mysql 服务器，我想知道如何在 ubuntu 12.04 中打开端口 3306 以允许从任何 ip 连接到 mysql。你能帮我吗？谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-08T23:19:33.180

我不认为防火墙是你的问题。任何现代 mysql 版本都`bind-address=127.0.0.1`在其`my.cnf`中，这使其仅绑定到环回。把它注释掉，重启mysql，你应该很高兴。默认情况下，Ubuntu IIRC 没有限制性防火墙。

# wicket - 如何正确处理检票口中的文件上传

> ID：11874520
> 
> 赞同：1
> 
> 时间：2012-08-08T23:07:27.287
> 
> 标签：wicket, solaris, wicket-1.5

我有一个文件上传页面，它接受一个文件并对其进行解析。

**事件顺序**

1.  用户上传文件
2.  上传的文件被复制
3.  [使用CPDetector](http://cpdetector.sourceforge.net/%20CPDetector)对复制的文件进行编码检查
4.  从复制的文件中确定的编码用于解析原始上传的文件
    *   `FileNotFoundException``BufferedReader`在创建期间在 Solaris 测试服务器上。
5.  复制的文件被删除
6.  上传的文件被解析/验证
7.  解析后的数据保存到数据库
8.  上传的文件被删除（我不记得我是这样做还是Tomcat是。）

整个过程在我的 Windows 7 工作站上运行。如上所述，它不适用于我的 Solaris 测试服务器。在我完成解析之前，某些东西（我怀疑 Tomcat）正在删除上传的文件。

我在此过程中查看了该目录，并且确实创建了一个上传的文件，但它在被删除之前持续了不到一秒钟。它也应该进入`/opt/tomcat/`，但似乎是在`/var/opt/csw/tomcat6/temp/`目录中创建的。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-14T21:46:57.387

我意识到这样回答我自己的问题可能是不好的形式，但我想把它留在这里，以防它帮助别人。

问题原来是我如何访问文件。

我有硬编码的文件路径，用于 Windows，以及用于测试服务器的数据库加载路径。我将它们切换为使用`System.getProperty("catalina.home")+"/temp/" + filename` 我还第二次复制临时文件，所以我最终得到：

**事件顺序*（更改以粗体显示）***

1.  用户上传文件
2.  上传的文件被复制
3.  *使用CPDetector*对复制的文件进行编码检查
**   **上传的文件被再次复制以确保副本能够被解析***   从复制的文件中确定的编码用于解析原始上传的文件*   用于编码检测的副本被删除*   **解析的副本被解析/验证***   解析后的数据保存到数据库*   **解析的文件被删除。***   上传的文件被删除（我不确定我是这样做还是Tomcat是。）*

# iis - Azure WebRole 在 1.7 升级后不会启动

> ID：11874524
> 
> 赞同：7
> 
> 时间：2012-08-08T23:07:49.320
> 
> 标签：iis, azure, azure-web-roles

我最近尝试将我的 WebRole 从 Azure SDK v1.6 升级到 v1.7。这似乎工作正常。我可以很好地在我的 devfabric 中构建和运行角色。当我尝试将升级后的项目部署到真正的云时，实例永远不会启动。他们只是处于“忙碌”状态。有趣的是，他们不执行典型的“循环循环”，他们只是永远处于“忙碌”状态。

当我使用 RDP 登录实例时，我在事件日志中看到以下错误：

> 属于站点“1”的应用程序“/”设置了无效的 AppPoolId“DefaultAppPool”。因此，该应用程序将被忽略。

其次是：

> 站点 1 被禁用，因为为站点定义的根应用程序无效。有关根应用程序无效的信息，请参阅前面的事件日志消息。

查看 IIS 管理器确认没有名为“DefaultAppPool”的 AppPool。Azure 创建的名称也没有带有 GUID 的典型 AppPool。不出所料，我的网站也不存在。

那么我该如何解决呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-05T15:49:54.390

升级到 v1.7 后我遇到了同样的问题，但是在查看 Azure VM 中的 Windows Azure 日志时，我注意到以下异常：

```
An unhandled exception occurred. Type: System.ArgumentException Process ID: 2340
Process Name: DiagnosticsAgent
Thread ID: 1
AppDomain Unhandled Exception for role Backend_IN_0
Exception: Endpoint http://xxxx.blob.core.windows.net/ is not a secure connection. 
```

因此，我将诊断连接字符串更改为使用`https`，而不是`http`瞧，这解决了我的问题。

希望这对你有用，我已经把头发拉了两天了。

# sql - 触发器创建期间的 SQL 语法错误：when vs. where

> ID：11874527
> 
> 赞同：1
> 
> 时间：2012-08-08T23:08:09.617
> 
> 标签：sql, sqlite

为什么下面的第一个查询在 Firefox SQLite 管理器中有效，而第二个查询无效？为什么使用 SQLite、MySQL、PostGreSQL 等在[SQL Fiddle中都失败了？](http://sqlfiddle.com/#!1)

```
create trigger symmetric_insertion
after insert on T
for each row
when not exists (select * from T where T.A = New.B and T.B = New.A)
begin
  insert into T values (New.B, New.A);
end; 
```

.

```
create trigger symmetric_insertion
after insert on T
for each row
begin
  insert into T values (New.B, New.A)
  where not exists (select * from T where T.A = New.B and T.B = New.A);
end; 
```

**编辑**：不会创建无限循环，因为我没有将 recursive_triggers 设置设为真。此外，MySQL 只允许有限深度的递归。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:25:05.843

不知道为什么第一个触发器在 Firefox SQLite 管理器中起作用。如果触发器导致表插入到自身中，则触发器应该失败，并且最好在它不会编译时失败。我猜这可能是因为 Firefox SQLite 如何使用允许触发器编译的 when 子句编写他们的 DBMS。第二个是非法 SQL。当它执行时，它每次都会插入然后级联，所以你不能允许它。

# vb.net - 如何向窗口上下文菜单添加更多项目

> ID：11874528
> 
> 赞同：0
> 
> 时间：2012-08-08T23:08:22.393
> 
> 标签：vb.net, contextmenu

我正在为我工​​作的公司制作一个应用程序，我想知道如何自定义窗口的上下文菜单，如 PuTTY 的（又名，它有“新会话......”等）。我在谷歌上找遍了，找不到我要找的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:53:00.630

制作一个新模块并添加`Imports System.Runtime.InteropServices`到顶部

然后声明这个

```
<Flags()> _
Public Enum MenuFlags As Integer
    MF_BYPOSITION = 1024
    MF_REMOVE = 4096
    MF_SEPARATOR = 2048
    MF_STRING = 0
End Enum

<DllImport("user32.dll", CallingConvention:=CallingConvention.Cdecl)> _
Public Function GetSystemMenu(ByVal hWnd As IntPtr, Optional ByVal bRevert As Boolean = False) As IntPtr
End Function

<DllImport("user32.dll", CharSet:=CharSet.Auto)> _
Public Function AppendMenu(ByVal hMenu As IntPtr, ByVal uFlags As MenuFlags, ByVal uIDNewItem As Int32, ByVal lpNewItem As String) As Boolean
End Function 
```

然后在您的表单加载处理程序上添加此代码

```
Dim sysmenu As IntPtr = GetSystemMenu(Me.Handle)
AppendMenu(sysmenu, MenuFlags.MF_STRING, &H1FFF, "Hello") 
```

然后，为了能够捕获用户单击您的新菜单项，您必须实现此功能，该功能将捕获所有消息，只需将其添加到您的表单代码中

```
 Protected Overrides Sub WndProc(ByRef m As System.Windows.Forms.Message)
      If m.Msg = WM_SYSCOMMAND Then
          If m.WParam.ToInt32 = &H1FFF Then
               ' your menu item is clicked, call a function here
          End If
      End If
      MyBase.WndProc(m)
   End Sub 
```

# android - Android WebView 导致 NullPointer

> ID：11874529
> 
> 赞同：0
> 
> 时间：2012-08-08T23:08:24.443
> 
> 标签：android, webview, android-webview

尝试在活动中创建 Web 视图时遇到一个非常奇怪的问题。

我按照 Android WebView 指南执行此操作（http://developer.android.com/guide/webapps/webview.html）

我的应用程序有一个主菜单，上面有一个按钮，可以引导一个应该打开 Web 视图的活动。当我使用 Intent 时它工作得很好，但我需要更多的灵活性，所以这不是一个真正的选择。

这是我的 webview.xml 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<WebView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/webview"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
</WebView> 
```

这是我的 WebView 活动文件中的内容：

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    WebView webview = (WebView) findViewById(R.id.webview);
    diningWebView.loadUrl(http://www.google.com);
} 
```

问题是我的 findViewById() 返回 null，但我不知道为什么。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:12:17.227

你忘了你的 setContentView()

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView( R.layout.webview );   

    WebView webview = (WebView) findViewById(R.id.webview);
    diningWebView.loadUrl(http://www.google.com);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T13:11:43.340

作为记录，还有一个可能的原因：有几种不同的布局，例如纵向和横向，但并非所有布局都定义了 WebView。

# eclipse - 使用 Git 作为代码存储库时，如何为开发人员和 UI 编码人员划分 JSF 项目

> ID：11874535
> 
> 赞同：2
> 
> 时间：2012-08-08T23:09:14.823
> 
> 标签：eclipse, git, jsf, maven, jenkins

我正在将我的 JSF 应用程序迁移到 Cloudbees——基本上是一个 Maven/Jenkins/Git 平台。不幸的是，我对 Maven/Jenkins/Git 没有太多经验。

我想创建一种简单的方式，让 UI 开发人员可以与 xhtml 和相关的 UI 文件保持同步，而无需他们机器上的 Java 代码。Java 开发人员需要 UI 代码和 Java 代码。在这两种情况下，当他们推送他们的内容时，它应该可以与 Jenkins 持续构建过程集成。

您是否可以提出一个好的模式或建议来划分项目，以便 UI 开发人员拥有他们的 XHTML 和其他文件（图像、CSS 等），而 Java 开发人员拥有一切？这需要与 Maven、Git 和 Jenkins 一起使用。感谢所有的帮助。

最后一件事 - java 开发人员将使用 Eclipse。UI 开发人员不需要使用 Eclipse，因此链接将是 Git。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T11:16:05.337

这实际上只是一个 Maven/JSF 问题。Jenkins 并没有真正进入这个等式，CloudBees 也没有（注意我们 [cloudbees] 也支持 Subversion 托管的存储库，它可能更适合也可能不适合您的项目结构......无论如何，GIT 恕我直言“更好”，所以我会去如果是我，GIT over Subversion）

你真的有三个选择。

1.  将 XHTML 保存在单独的 GIT 存储库中

2.  将所有内容保存在一个存储库中。

3.  1和2的一种混合

## 选项1

这将带你走上 GIT 子模块的道路......这是我更喜欢 Subversion 而不是 GIT 的一种情况......不，我并不是说这`svn:externals`比 GIT 更好，Subversion 允许你检查更多存储库的一部分，因此 UI 团队可以检查 XHTML 文件所在的子路径，IOW

```
$ svn co https://svn-user1530669.forge.cloudbees.com/jsf-app/trunk/web-module/src/main/webapp web-content
$ cd web-content 
```

将为 UI 团队工作，并且

```
$ svn co https://svn-user1530669.forge.cloudbees.com/jsf-app/trunk jsf-app
$ cd jsf-app
$ mvn package 
```

将适用于 Java 开发人员。

要使用 GIT 实现相同的功能，需要使用子模块，因此您将`web-module/src/main/webapp`在 jsf-app GIT 存储库中拥有一个子模块。

当 Java 开发人员还需要对 XHTML 文件进行调整时，这会变得很痛苦，这取决于 IDE，要让子模块中的提交正确执行可能会很棘手。此外，您现在没有要跟踪的单个修订，两个存储库可以独立移动......这会降低 GIT 的某些功能。

当您想要使用 Maven 发布插件（并且您应该想要）时，子模块会阻止您，因为发布插件当前不支持标记子模块的想法，并且有两个单独的存储库可以再次跟踪问题。

## 选项 2

这确实是更好的选择......即使它正在做你说你不想做的事情。

这里的诀窍是让 UI 开发人员的生活更轻松。

您应该设置一个带有默认目标的漂亮 Maven 配置文件，该配置文件最终会使用例如 jetty:run 运行 Web 应用程序，例如，请参见此[pom 配置文件](https://github.com/tobar-segais/tobar-segais/blob/master/pom.xml#L193)如果您签出该项目并运行

```
$ mvn -Pdemo 
```

它将从构建了所有依赖模块的子模块启动 Web 应用程序。

使用这种方法意味着 UI 人员还可以测试集成到 JSF 应用程序中的 UI 更改，从而减少 Java 人员的负载。

## 选项 3

这是一种混合，XHTML 和 Java 有单独的 GIT 模块，但它们是有效的 Maven 项目。

您可以通过两种方式实现这一目标...

*   使用 Maven War Overlays将 XHTML 模块`<packaging>war</packaging>`提取到 Java Web 应用程序中

*   让 XHTML 模块成为一个`<packaging>war</packaging>`直接引入 Java 依赖项的模块。

第一个优点是 Java 开发人员可以快速使用 Java 代码，但副作用是修复 XHTML 很棘手，例如数据绑定属性

第二个使调整 Java 变得更加困难（必须继续运行`mvn install`），如果 UI 人员想要启动 Maven 打包，他们必须从远程 Maven 存储库中拉下 Java .JAR，因此您可能会暴露一些 Java 内部结构给用户界面的家伙。

## TL;博士

就个人而言，除非对 UI 人员*保密很重要，否则我会选择***选项 2**

# xcode - 尝试在 XCode 4.4 Mountain Lion 上安装 Cocos2d 模板

> ID：11874536
> 
> 赞同：2
> 
> 时间：2012-08-08T23:09:36.063
> 
> 标签：xcode, cocos2d-iphone, osx-mountain-lion, xcode4.4

我正在尝试在 Mountain Lion 上的 XCode 4.4 上安装 cocos2d 模板。我已经从[http://www.cocos2d-iphone.org/download下载了最新的稳定版本，从](http://www.cocos2d-iphone.org/download)[https://github.com/cocos2d/cocos2d-iphone](https://github.com/cocos2d/cocos2d-iphone)下载了最新的代码。

当我运行 ./install-templates.sh -f -u 或仅运行 -f 时，它会将模板安装到我的 ~/Library/Developer/Xcode/Templates

![像这样](../Images/37d7e196f10396ac166f49381639829c.png)

但是，当我尝试使用模板创建新项目时，我只能在 cocos2d v2.x 选项下看到 CNode 模板。

![像这样](../Images/050e21e7c75e3c312bd3d64391683030.png)

其他部分没有任何与 cocos2d 相关的内容。

我已经尝试将 CNode class.xctemplate 移动到 ~/Library/Developer/Xcode/Templates/cocos2d v2.x/ 文件夹中，也尝试将所有这些 .xctemplates 移动到 ./File Templates/cocos2d v2.x/文件夹，但我得到相同的结果。

如何正确安装模板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:40:52.517

您点击了“新建 -> 文件”而不是“新建 -> 项目”

如果您使用的是新文件 command-n，则 command-shift-n 是新项目。

# ruby - 如何创建沙盒 RSpec 环境？

> ID：11874537
> 
> 赞同：5
> 
> 时间：2012-08-08T23:09:45.030
> 
> 标签：ruby, rspec, jruby, sandbox

本质上，我想创建一个程序，该程序将运行一些定义某些方法或类的不受信任的代码，然后针对它运行不受信任的 rspec 规范。

我对沙盒 Ruby 进行了一些研究，来自 ruby​​conf 的[这段视频](http://www.youtube.com/watch?v=6XxCOYco3Eg)特别有用。在查看了几个解决方案之后，似乎最有帮助的两个是[ruby​​cop](https://github.com/envylabs/RubyCop)，它基本上对代码进行静态分析，以及[jruby 沙箱](https://github.com/omghax/jruby-sandbox)（都在上面的视频中介绍）。我的直觉告诉我，jruby 沙盒可能更安全，但我很可能是错的。

这是我想做的一个完全不安全的例子：

```
code = <<-RUBY
class Person
  def hey
    "hey!"
  end
end
RUBY

spec = <<-RUBY
describe Person do
  let(:person) { Person.new }

  it "says hey" do
    person.hey.should == "hey!"
  end
end
RUBY

# code and spec will be from user input (unsafe)

eval code
require 'rspec/autorun'
eval spec 
```

这一切都很好，但代码显然需要被沙盒化。`system("rm -rf /*")`一些天才提交，`fork while fork`或者同样危险的东西，这将是几分钟的事情。

我用jruby沙箱做了各种尝试......

```
sand = Sandbox::Safe.new
sand.eval("require 'rspec/autorun'")
sand.activate! # lock it down
sand.eval code
puts sand.eval spec 
```

该代码引发此异常：

```
Sandbox::SandboxException: NoMethodError: undefined method `require' for #<RSpec::Core::Configuration:0x7c3cfaab> 
```

这是因为 RSpec 在沙箱被锁定后试图要求一些东西。

因此，我试图通过调用 empty 来强制 RSpec 在沙箱被锁定之前需要一些东西`describe`：

```
sand = Sandbox::Safe.new
sand.eval("require 'rspec/autorun'")
sand.eval("describe("") { }")
sand.activate! # lock it down
sand.eval code
sand.eval spec 
```

我明白了：

```
Sandbox::SandboxException: NameError: uninitialized constant RSpec 
```

这基本上意味着`RSpec`沙盒中不存在。这很奇怪，考虑到`sand.eval("require 'rspec/autorun'")`返回 true，并且前面的示例确实有效（RSpec 的自动加载器开始运行）。

不过，这可能是 gems 和这个特定沙箱的问题。沙盒对象实际上支持一个方法`#require`，它本质上是绑定到的`Kernel.require`，因此不能加载 gems。

它开始看起来像使用这个沙箱可能真的无法使用 rspec。主要问题是试图将其实际加载到沙箱中。我什至尝试过这样的事情：

```
require 'rspec'
sand.ref(RSpec) # open access to local rspec 
```

但它没有任何东西。

所以，我的问题有两个：

*   有没有人有任何关于如何让它与 jruby 沙箱一起工作的好主意？
*   如果不是，[ruby​​cop](https://github.com/envylabs/RubyCop)的安全性如何？显然[codeschool](http://codeschool.com)使用它，所以它必须经过很好的测试......能够使用 ruby​​ 1.9 而不是 jruby 会很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-25T09:54:33.460

我一直在试图找出类似的问题。激活后，我想在我的沙箱中使用 json 和 rest-client 之类的 gem。我试着跟随。

```
require "sandbox"
s=Sandbox.safe

s.eval <<-RUBY
  require 'bundler'
  Bundler.require :sandbox
RUBY

s.activate! 
```

宝石文件.rb

```
group :sandbox do
  platforms :jruby do
    gem 'json'
    gem 'rest-client'
  end
end 
```

这样，我就可以在我的沙箱中使用 gems。但是，沙盒存在一些特定于宝石的问题。例如，我必须在 jruby-sandbox 中为 safe.rb 添加一个方法 initialize_dup 到白名单中。RestClient 对我正在尝试修补的假文件系统 ALT_SEPARATOR 有一些问题。您可以为 RSpec 尝试这种方法，看看是否一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T17:59:12.283

看起来沙盒环境没有加载包/宝石集。如果您使用 gemset 或其他东西，RVM 可能会出现问题。

一旦沙盒化，人们可能会尝试再次加载捆绑包。

我会看看红宝石污染模式

```
$SAFE   The security level
0 --> No checks are performed on externally supplied (tainted) data. (default)
1 --> Potentially dangerous operations using tainted data are forbidden.
2 --> Potentially dangerous operations on processes and files are forbidden.
3 --> All newly created objects are considered tainted.
4 --> Modification of global data is forbidden. 
```

# android - 如何在xml中设置复合可绘制文本视图的高度和宽度？

> ID：11874538
> 
> 赞同：19
> 
> 时间：2012-08-08T23:09:54.013
> 
> 标签：android, xml, compound-drawables

我看不到任何标签来设置宽度

在这里我设置了 textview 的高度，如果我设置了宽度，它将无法正常工作。

```
<TextView
   android:id="@+id/nome"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   android:textColor="#FFFFFF"
   android:drawableLeft="@drawable/ic_launcher"
   android:height="50dp" /> 
```

如何在 xml 中设置它？可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:31:14.177

您可以尝试以下方法：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

<TextView
    android:id="@+id/Home"
    android:layout_width="wrap_content"
    android:layout_height="50dp"
    android:layout_centerHorizontal="true"
    android:gravity="center"
    android:text="Something"
    android:textColor="#FFFFFF" />

<ImageView 
    android:src="@drawable/icon" 
    android:layout_width="50dp"
    android:layout_height="50dp"
    android:layout_toLeftOf="@id/Home"/>

</RelativeLayout> 
```

这样我认为你可以更好地控制你的形象。希望有帮助。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-08-08T23:23:53.717

尝试设置`android:width="50dip"`，看看你得到了什么。dip 是与设备无关的像素。您应该能够在设计视图中的 eclipse 中看到。你不能只设置为“300”

# ruby-on-rails-3 - 构建用于白标的 Rails 应用程序

> ID：11874539
> 
> 赞同：1
> 
> 时间：2012-08-08T23:10:08.023
> 
> 标签：ruby-on-rails-3, configuration, white-labelling

我很好奇您将如何创建一个易于对其进行白标的 rails 3 应用程序。例如，如果您有一个对食物进行评论的网站和一个对电影进行评论的网站，那么自定义路线的最佳方式是什么，这样 /foods 可以在一个站点上运行，而 /movies 可以在另一个站点上运行。显然是某种配置，但如果没有设置，它可能应该回退到/reviews。

在较小的规模上，我可以解决这个问题，但我很好奇这如何扩展到 100 个站点。你不能真正将他们所有的配置存储在同一个 git repo 中，你如何处理创建可审查模型的自定义方法。由于食物和电影不会有相同的参数，如果你让用户输入它们，就必须为此进行某种定制。

此外，我猜测每个站点可能应该以某种方式自包含，以防止一个站点出现问题而导致其余站点瘫痪。

我想我在这里只是触及表面，我还没有找到任何谈论这种东西的文章。

# backbone.js - Backbone.Marionette onRender 回调在浏览器中呈现视图之前触发？

> ID：11874541
> 
> 赞同：29
> 
> 时间：2012-08-08T23:10:22.290
> 
> 标签：backbone.js, settimeout, marionette

## 那个设定

我有 Backbone.Marionette.ItemView 呈现一些内容。当呈现内容时，我想应用一个 jQuery 插件，它将视图的一部分变成带有滚动条的容器。

滚动条完全用 javascript 实现，初始化时它必须检查滚动容器的高度以及容器内内容的高度。

如果内容高于容器，则应启用滚动条。

## 问题

虽然这一切听起来很简单，但我遇到了一个奇怪的问题：

如果我直接在 onRender 回调中初始化我的滚动条插件，它似乎认为 .scroll-container 元素的高度为 0，maxHeight 为 0。

但是，如果我将初始化代码包装在 0ms 超时内，则一切正常，jQuery 正确返回 .scroll-container 元素的 height 属性，并且滚动条插件运行良好。

## 编码

```
onRender: function() {
  var that = this;
  setTimeout(function() {
    that.onLayout();
    var $scrollContainer = that.$el.find('.scroll-container'), 
        scrollPane = new ScrollPane($scrollContainer, {
          maxHeightProperty: 'maxHeight',
          scrollUpButton: false,
          scrollDownButton: false
        });
  }, 0);
}, 
```

## 问题

我假设问题发生是因为在执行 onRender 回调时浏览器没有完成实际渲染新插入的 html。

这个假设正确吗？如果是这样，我在正常情况下使用 0ms 超时的解决方案是否可靠？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-08-09T00:30:29.237

由于有问题的插件依赖于 DOM，`onRender`因此不会满足您的需要。这个回调在视图被渲染后启动，但不能保证视图`el`已经被添加到 DOM 中。事实上，你可以假设相反的情况是安全的——它还没有被添加。

如果您使用 Marionette`Region`来显示视图，则可以在视图中实现一个`onShow`方法。在区域将视图添加到 DOM 之后，该方法会被区域调用。它是专门为处理这种情况而实施的。

有关这方面的更多信息以及一般使用 jQuery 插件的信息，请参阅此博客文章： http: [//lostechies.com/derickbailey/2012/02/20/using-jquery-plugins-and-ui-controls-带骨干/](http://lostechies.com/derickbailey/2012/02/20/using-jquery-plugins-and-ui-controls-with-backbone/)

# ruby - 使用 Pivotal Tracker API 获取 Backlog 或 Current 中的所有故事？

> ID：11874542
> 
> 赞同：1
> 
> 时间：2012-08-08T23:10:30.457
> 
> 标签：ruby, gem, pivotaltracker

我正在使用关键跟踪器 gem：[https](https://github.com/jsmestad/pivotal-tracker) ://github.com/jsmestad/pivotal-tracker 。

结果，我可以轻松地按州讲述故事，例如

```
project.stories.all(:current_state => 'started') 
```

但是，我想知道如何获取与 Backlog 和/或 Current 列相对应的所有故事。

看起来这可能与迭代有关，但我无法弄清楚。

```
project.iterations.find(????) 
```

任何帮助将不胜感激！现在我只是根据故事状态进行分离。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-15T11:21:55.357

感谢 Pivotal 的某个人向我指出了这些代码片段：[https ://github.com/jsmestad/pivotal-tracker/blob/master/spec/pivotal-tracker/iteration_spec.rb](https://github.com/jsmestad/pivotal-tracker/blob/master/spec/pivotal-tracker/iteration_spec.rb)

例如，要获取`current`列表：

```
@iteration = PivotalTracker::Iteration.current(@project) 
```

# c# - 在 Switch 块/C# 中显示 JS 脚本块（例如广告词脚本）

> ID：11874543
> 
> 赞同：0
> 
> 时间：2012-08-08T23:10:30.967
> 
> 标签：c#, controls

我尝试编写 Control (.ascx) 来管理我内部页面上的横幅。

我通过 switch case 来做到这一点，每个 ID 都匹配正确的横幅。问题 - 我如何将 Adwords JS 脚本放在`switch break;`?

它应该是这样的：

```
switch(_bannerId) 
{ 
     case "banner1": 
     {
           <script type= >
              Google adsense code
           </script>
     }
     case "banner2": 
     {
           <script type= >
              Google adsense code
           </script>
     }

     break;  
} 
```

可能吗？怎么做？

***编辑***

它不适用于`Response.Write()`

我尝试搜索“如何从后面的代码调用 Javascript”，但找不到合适的帖子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T22:08:25.757

您不能简单地将 c# 代码和 html 混合在一起，您需要将 html 代码视为字符串并将它们添加到页面输出中。

将此添加到您的 .ascx 文件中：

```
<Asp:Literal runat="server" ID="AdwordsScript"></Asp:Literal> 
```

然后到你的 ascx.cs 文件：

```
switch(_bannerId) 
{ 
     case "banner1": 
     {
           AdwordsScript.Text= @"<script type=""text/javascript"">
              //Google adsense code 1
           </script>";
     }
     break;  
     case "banner2": 
     {
           AdwordsScript.Text= @"<script type=""text/javascript"">
              //Google adsense code 2
           </script>";
     }
     break;  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T22:12:50.387

调用`Response.Write()`将破坏输出标记，即它会在`Render()`调用之前写入内容，从而将脚本放在文档标记之外。`Literal`在页面中添加 a`Text`并将 equal 的属性设置`Literal`为脚本。

[更好的是，只需使用`RegisterStartupScript()`](http://msdn.microsoft.com/en-us/library/z9h4dk8y.aspx). 它适用于这样的场景，让您可以更好地控制脚本的执行时间。如果您`ScriptManager`在页面上使用 a ，则有[类似的方法](http://msdn.microsoft.com/en-us/library/bb359558.aspx)。

或者，为了避免后面代码中出现大的脚本字符串，您可以`Placeholders`在标记中声明所有脚本并根据您的 switch 语句显示/隐藏它们。

## C＃

```
switch(_bannerId){
  case "banner1":
      this.plhScript1.Visible = true;
      break;
  case "banner2":
      this.plhScript2.Visible = true;
      break;
  default:
      throw new InvalidOperationException( "Unknown banner type" );
} 
```

## 用户控制

```
<asp:Placeholder runat="server" id="plhScript1" visible="false">
    <script>
    // script goes here

    </script>
</asp:Placeholder>

<asp:Placeholder runat="server" id="plhScript2" visible="false">
    <script>
    // script goes here

    </script>
</asp:Placeholder> 
```

# iphone - Apple 会拒绝 wait_fences 警告吗？

> ID：11874546
> 
> 赞同：0
> 
> 时间：2012-08-08T23:10:43.637
> 
> 标签：iphone, ios, xcode

应用程序会拒绝接收到的应用程序

```
wait_fences: failed to receive reply: 10004003 
```

我已经尝试了一切来消除警告，但到目前为止什么都没有......它根本不会影响我的应用程序，它只是打印出来......所以我将它提交给 Apple App Store，但他们会拒绝收到这种警告的应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:13:03.300

一般来说，警告并不是什么大问题，它可能会很好。

特别是这个警告，根据这里的这篇文章：[wait_fences: failed to receive reply: 10004003 (Again)](https://stackoverflow.com/questions/8994998/wait-fences-failed-to-receive-reply-10004003-again)

> 根据苹果工程师的说法，这是内部引起的问题，第三方开发人员不必担心。

# python - 在 Python 中找不到包含 $ 的字符串

> ID：11874553
> 
> 赞同：0
> 
> 时间：2012-08-08T23:11:55.213
> 
> 标签：python, regex

我在 python 中的正则表达式匹配遇到了一个意想不到的困难：正如预期的那样：

```
>>> re.match("r", "r").group() #returns...
"r" 
```

然而：

```
>>>re.match("r", "$r").group()
Traceback (most recent call last):
    File "<stdin>", line 1, in <module>
AttributeError: 'NoneType' object has no attribute 'group' 
```

有谁知道为什么美元符号在要匹配的字符串中会引起麻烦，以及我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:13:22.607

[看看re.match](http://docs.python.org/library/re.html#re.match)和[re.search](http://docs.python.org/library/re.html#re.search)的区别

```
>>> re.match("r", "$r")    # no match since re.match is equivalent to '^r'
>>> re.search("r", "$r")   # match
<_sre.SRE_Match object at 0x10047d3d8> 
```

re.match 从字符串的开头搜索，因此“r”不匹配“$r”，因为“$r”不以“r”开头。

re.search 扫描字符串，因此它不依赖于字符串的开头。

作为一般形式，您应该以这种方式进行匹配：

```
match=re.search(pattern, string)
if match
   # you have a match -- get the groups...
else:
   # no match -- deal with that... 
```

# c# - data_received 事件在哪个线程上运行？

> ID：11874559
> 
> 赞同：1
> 
> 时间：2012-08-08T23:12:46.717
> 
> 标签：c#, wpf, serial-port, backgroundworker

我正在使用 WPF 应用程序进行串行通信，其中通过在主窗口（GUI）中获取用户的规范来创建串行端口，并将端口作为参数发送到后台工作人员。我的问题是我的主窗口线程中有一个端口的 datareceived 事件，用于从串行端口读取样本数据并在 BG 线程中进行连续读取。当使用我作为参数发送给 BG 工作人员的端口时，我应该定义一个新的 datareceived 事件还是同样的一个工作？

```
private void SerialThread_DoWork(object Sender, DoWorkEventArgs e )
    {

        BGargs args = e.Argument as BGargs;
        SerialPort BGport = args.PORT;
        string MODE = args.MODE;
        string filePath = args.filepath;
        BGport.DataReceived +=new SerialDataReceivedEventHandler(BGport_DataReceived);
        Dispatcher.BeginInvoke((Action)delegate() { run_button.IsEnabled = false; });
        switch (MODE)
        {
            case "EXT_trigger":
                while (SerialThread.CancellationPending)
                {
                    FileStream file = new FileStream(filePath, FileMode.Append, FileAccess.Write);
                    using (StreamWriter Writer = new StreamWriter(file))
                    {
                        //code to continuously trigger and read data and then write to file
                    }
                }

                    break;
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:15:24.930

来自标题的问题：

[http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx](http://msdn.microsoft.com/en-us/library/system.io.ports.serialport.datareceived.aspx)

```
The DataReceived event is raised on a secondary thread when data is received
from the SerialPort object. Because this event is raised on a secondary thread,
and not the main thread, attempting to modify some elements in the main thread,
such as UI elements, could raise a threading exception 
```

第二个问题：
不，您不必附加另一个事件处理程序。这里和那里都是同一个 SerialPort 对象。一旦您将事件处理程序附加到它，处理程序将保留，无论您对对象做什么。您可以通过 args 传递它，存储在属性中，等等。一旦 +='ed 到 SerialPort 对象，处理程序将一直存在，直到您通过 -= 明确取消绑定它形成该对象。

# javascript - 为多个表单泛化 jQuery 动态添加/删除表单输入

> ID：11874564
> 
> 赞同：3
> 
> 时间：2012-08-08T23:13:17.820
> 
> 标签：javascript, jquery, html, forms, dynamic

目前我有一个功能代码，用于在我的页面上动态添加和删除表单输入。我有多个表单需要包含在页面上，所以我做了一个事件操作，他们可以按下一个按钮，它会隐藏除相关表单之外的所有表单。这工作正常，但它与我的 jQuery/javascript 代码产生了冲突，因为代码使用类名来动态添加或删除输入字段。两种形式都必须使用相同的类名才能按原样使用 jQuery 函数，但这会产生冲突并且函数停止工作。我可以只编写函数的两个版本（每个类一个），但我正在尝试找到一种方法来概括这一点，这样我就不必拥有这么多函数。我正在考虑做这样的事情：

```
$('.ccinput').addClass('dinput').removeClass('ccinput'); 
```

我将相应地更改每个表单的类名，以便它们成为唯一与 jQuery 函数通信的人。这种方法似乎很容易出错，尤其是超过 2 个表单（我计划总共有 4 个表单）。你们知道我可以做到这一点的另一种方法吗？这是我的html代码供参考：

编辑：我对代码进行了重大更改，所以这是新版本。我从表单输入中删除了所有 ID 值并更改了 jQuery 函数，以便它不使用 ID 值作为选择器。这消除了一些冲突。我现在正在尝试使用 attr('class','newclass') 以便 jQuery 函数适用于两种代码。它似乎适用于第一种形式，但它拒绝适用于第二种形式。我不知道为什么。

```
<html>

<head>
<title></title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
<script src="jquery.maskedinput.js" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function() {
        $("#table1").hide();
        $("#table2").hide();
        $("#cc_button").click(function(){
            $("#table1").show();
            $("#table2").hide();
            $("#cctable tr").attr('class', 'dinput');
            $("#dbtable tr").attr('class', 'dbinput');
        });
        $("#db_button").click(function(){
            $("#table2").show();
            $("#table1").hide();
            $("#dbtable tr").attr('class', 'dinput');
            $("#cctable tr").attr('class', 'ccinput');
        });
        $('#btnAdd').click(function() {
            var num     = $('.dinput').length; // how many "duplicatable" input fields we currently have
            var newNum  = new Number(num + 1);      // the numeric ID of the new input field being added

            // create the new element via clone(), and manipulate it's ID using newNum value
            var newElem = $('.dinput:last').clone();

            // insert the new element after the last "duplicatable" input field
            $('.dinput:last').after(newElem);
            $(".dinput:last td:first").replaceWith( "<td>" + newNum + "</td>" );

            // enable the "remove" button
            $('#btnDel').attr('disabled','');

            $(".date").mask("99/99/9999");

            // business rule: you can only add 20 names
            if (newNum == 20)
                $('#btnAdd').attr('disabled','disabled');
        });

        $('#btnDel').click(function() {
            var num = $('.dinput').length; // how many "duplicatable" input fields we currently have
            $('.dinput:last').remove();     // remove the last element

            // enable the "add" button
            $('#btnAdd').attr('disabled','');

            // if only one element remains, disable the "remove" button
            if (num-1 == 1)
                $('#btnDel').attr('disabled','disabled');
        });

        $(".date").mask("99/99/9999");
    });
</script>
</head>
<body>
<div id="tablebuttons">
<button type="button" id="cc_button">CC</button> <button type="button" id="db_button">DB</button>
</div>
<div id="table1">

<form id="ccards" method="post" action="<?php echo htmlentities($PHP_SELF); ?>">
<table border="1" cellspacing="0">
<tr>
<th></th>
<th># (last four digits)</th>
<th>Amount</th>
<th>Approval</th>
<th>Date Received</th>
</tr>
<tbody id ="cctable" >
<tr class="ccinput">
    <td> 1 </td>
    <td> <input type="text" name="cc_num[]" maxlength="4" /> </td> 
    <td> <input type="int" name="cc_amnt[]" /> </td>
    <td> <input type="text" name="cc_app[]" maxlength="10" /> </td> 
    <td> <input class="date" type="text" name="cc_date[]" /> </td>
</tr>
</tbody>
</table>
<div>
    <input type="button" id="btnAdd" value="Add CC" />
    <input type="button" id="btnDel" value="Remove CC" />
</div>
<input type="submit" value="Submit" name="submit" />
</form>
</div>
<div id="table2">

<form id="db" method="post" action="<?php echo htmlentities($PHP_SELF); ?>">
<table border="1" cellspacing="0">
<tr>
<th></th>
<th>DB #</th>
<th>Amount</th>
<th>Date</th>
</tr>
<tbody id="dbtable">
<tr class="dbinput">
    <td> 1 </td>
    <td> <input type="text" name="db_num[]" /> </td> 
    <td> <input type="int" name="db_amnt[]" /> </td> 
    <td> <input class="date" type="text" name="db_date[]" /> </td>
</tr>
</tbody>
</table>
<div>
    <input type="button" id="btnAdd" value="Add DB" />
    <input type="button" id="btnDel" value="Remove DB" />
</div>
<input type="submit" value="Submit" name="submit" />
</form>
</div>
</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T01:25:55.743

好的，我解决了。我的选择器存在多个问题，我必须修复，但之后以下解决方案完美运行：

```
$("#cc_button").click(function(){
  $("#table1").show();
  $("#table2").hide();
  $("#cctable tr").attr('class', 'dinput');
  $("#dbtable tr").attr('class', 'dbinput');
});
$("#db_button").click(function(){
  $("#table2").show();
  $("#table1").hide();
  $("#dbtable tr").attr('class', 'dinput');
  $("#cctable tr").attr('class', 'ccinput');
}); 
```

这基本上会根据按下哪个按钮来更改每个表的类属性。从理论上讲，这应该适用于 4 种形式，尽管我还没有尝试过。这是那些想看看我做了什么的人的更新代码（自第一个代码以来我已经改变了很多）：

```
<html>

<head>
<title></title>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>
<script src="jquery.maskedinput.js" type="text/javascript"></script>

<script type="text/javascript">
    $(document).ready(function() {
        $("#table1").hide();
        $("#table2").hide();
        $("#cc_button").click(function(){
            $("#table1").show();
            $("#table2").hide();
            $("#cctable tr").attr('class', 'dinput');
            $("#dbtable tr").attr('class', 'dbinput');
        });
        $("#db_button").click(function(){
            $("#table2").show();
            $("#table1").hide();
            $("#dbtable tr").attr('class', 'dinput');
            $("#cctable tr").attr('class', 'ccinput');
        });
        $('.btnAdd').click(function() {
            var num     = $('.dinput').length; // how many "duplicatable" input fields we currently have
            var newNum  = new Number(num + 1);      // the numeric ID of the new input field being added

            // create the new element via clone(), and manipulate it's ID using newNum value
            var newElem = $('.dinput:last').clone();

            // insert the new element after the last "duplicatable" input field
            $('.dinput:last').after(newElem);
            $(".dinput:last td:first").replaceWith( "<td>" + newNum + "</td>" );

            // enable the "remove" button
            $('.btnDel').attr('disabled','');

            $(".date").mask("99/99/9999");

            // business rule: you can only add 20 names
            if (newNum == 20)
                $('.btnAdd').attr('disabled','disabled');
        });

        $('.btnDel').click(function() {
            var num = $('.dinput').length; // how many "duplicatable" input fields we currently have
            $('.dinput:last').remove();     // remove the last element

            // enable the "add" button
            $('.btnAdd').attr('disabled','');

            // if only one element remains, disable the "remove" button
            if (num-1 == 1)
                $('.btnDel').attr('disabled','disabled');
        });

        $(".date").mask("99/99/9999");
    });
</script>
</head>
<body>
<div id="tablebuttons">
<button type="button" id="cc_button">CC</button> <button type="button" id="db_button">DB</button>
</div>
<div id="table1">

<form id="ccards" method="post" action="<?php echo htmlentities($PHP_SELF); ?>">
<table border="1" cellspacing="0">
<tr>
<th></th>
<th># (last four digits)</th>
<th>Amount</th>
<th>Approval</th>
<th>Date Received</th>
</tr>
<tbody id ="cctable" >
<tr class="ccinput">
    <td> 1 </td>
    <td> <input type="text" name="cc_num[]" maxlength="4" /> </td> 
    <td> <input type="int" name="cc_amnt[]" /> </td>
    <td> <input type="text" name="cc_app[]" maxlength="10" /> </td> 
    <td> <input class="date" type="text" name="cc_date[]" /> </td>
</tr>
</tbody>
</table>
<div>
    <input type="button" class="btnAdd" value="Add" />
    <input type="button" class="btnDel" value="Remove" />
</div>
<input type="submit" value="Submit" name="submit" />
</form>
</div>
<div id="table2">

<form id="db" method="post" action="<?php echo htmlentities($PHP_SELF); ?>">
<table border="1" cellspacing="0">
<tr>
<th></th>
<th>DB #</th>
<th>Amount</th>
<th>Date</th>
</tr>
<tbody id="dbtable">
<tr class="dbinput">
    <td> 1 </td>
    <td> <input type="text" name="db_num[]" /> </td> 
    <td> <input type="int" name="db_amnt[]" /> </td> 
    <td> <input class="date" type="text" name="db_date[]" /> </td>
</tr>
</tbody>
</table>
<div>
    <input type="button" class="btnAdd" value="Add" />
    <input type="button" class="btnDel" value="Remove" />
</div>
<input type="submit" value="Submit" name="submit" />
</form>
</div>
</body>

</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-05T18:27:21.163

你可以使用这样的东西。

```
//when the Add Field button is clicked
$("#add").click(function (e) {
//Append a new row of code to the "#items" div
  $("#items").append('<div><input type="text" name="input[]"><button  class="delete">Delete</button></div>');
}); 
```

详细教程[http://voidtricks.com/jquery-add-remove-input-fields/](http://voidtricks.com/jquery-add-remove-input-fields/)

# objective-c - 如何显示基于 UIWindow 的暗色背景，如 UIAlertView？

> ID：11874570
> 
> 赞同：1
> 
> 时间：2012-08-08T23:13:56.023
> 
> 标签：objective-c, ios, background, uialertview, uiwindow

这是我的问题：我试图显示一个带有子视图的 UIWindow，该子视图显示径向渐变。我想把窗口放在 UIWindowLevelAlert 上。我之前已经弄清楚了这一切并且它正在工作，但现在我试图重现它浪费时间......这是我得到的代码（背景不是渐变，因为我想保持简单，然后添加一个真正类似于 UIAlertView 的视图）：

```
- (IBAction)buttonPressed {
UIWindow *backgroundWindow = [[UIWindow alloc]initWithFrame:[UIScreen mainScreen].bounds];
backgroundWindow.windowLevel = UIWindowLevelAlert;
UIView *backgroundView = [[UIView alloc]initWithFrame:[UIScreen mainScreen].bounds];
backgroundView.backgroundColor = [UIColor blackColor];
backgroundView.alpha = 0.5;
[backgroundWindow makeKeyAndVisible];
[backgroundWindow addSubview:backgroundView];
backgroundWindow.hidden = NO; 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:36:20.560

当 UIWindow 被释放时，它将从屏幕上移除。由于您没有保留对 UIWindow 的引用，我相信它会被释放并释放，因此它不会显示。

解决方案是在某处保留对窗口的引用。您可以将其作为属性存储在您正在工作的课程中吗？

# ruby - 定义自定义 Ruby 运算符

> ID：11874579
> 
> 赞同：5
> 
> 时间：2012-08-08T23:15:06.183
> 
> 标签：ruby, operators, metaprogramming

问题是：我可以在 Ruby 中定义我**自己的自定义**运算符，除了“[运算符表达式](http://phrogz.net/ProgrammingRuby/language.html#operatorexpressions)”中的运算符吗？

例如：`1 %! 2`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-09T02:34:45.980

是的，可以创建自定义运算符，尽管有一些警告。Ruby 本身并不直接支持它，但[superators gem](http://rubygems.org/gems/superators19)做了一个巧妙的技巧，它将运算符链接在一起。这允许您创建自己的运算符，但有一些限制：

```
$ gem install superators19 
```

然后：

```
require 'superators19'

class Array
  superator "%~" do |operand|
    "#{self} percent-tilde #{operand}"
  end
end

puts [1] %~ [2]
# Outputs: [1] percent-tilde [2] 
```

Due to the aforementioned limitations, I couldn't do your `1 %! 2` example. The [Documentation](http://rubydoc.info/gems/superators19/0.9.3/frames) has full details, but Fixnums can't be given a superator, and `!` can't be in a superator.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-08T23:27:44.640

不可以。您只能定义已在 ruby​​、+、-、!、/、% 等中指定的运算符（您看到了列表）

你可以亲眼看到这行不通

```
def HI
  def %!
    puts "wow"
  end
end 
```

这主要是因为必须扩展语法解析器以使用 new 运算符接受任何代码。

* * *

正如 Darshan 提到的，仅此示例可能不足以解决潜在问题。相反，让我们仔细看看解析器如何使用此运算符处理一些示例代码。

```
3 %! 0 
```

虽然我的间距看起来很明显，这应该是`3.%!(0)`没有间距的，但它变得更难看到。

`3%!`也可以看作是`3.%(0.!)`解析器不知道该选择哪个。目前，没有简单的方法来告诉它。相反，我们可能希望覆盖 的含义，`3.%(0.!)`但这并不完全是定义一个新的运算符，因为我们仍然仅限于 ruby​​ 的可解析符号

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-08T23:38:42.507

您可能无法*在*Ruby 中做到这一点，而只能通过修改 Ruby 本身。我认为修改 parse.y 将是你最好的选择。[parse.y famtour](http://rubykaigi.org/2011/en/schedule/details/18S01)

# ios - 显示 UIPickerView 时如何向上移动视图

> ID：11874588
> 
> 赞同：0
> 
> 时间：2012-08-08T23:15:40.073
> 
> 标签：ios, xcode, uipickerview, nsnotificationcenter

我有一个包含所有文本字段和按钮的主视图。对于我的文本字段，我使用 inputView 来显示 UIPickerViews 而不是键盘。我想知道如何在选择文本字段时使视图向上移动，这样选择器和选择器工具栏不会覆盖文本字段，因为我在底部有一些文本字段被它覆盖。我尝试使用带有表格视图的教程中的以下代码，但它对我不起作用。它构建没有错误，但它不能正常工作。视图只是消失了，然后当 pickerView 被关闭时它才回来一半。

```
 - (void)viewDidLoad {
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(pickerShown:) name:UIKeyboardDidShowNotification object:nil];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(pickerHidden:) name:UIKeyboardWillHideNotification object:nil];

}

-(void)pickerShown:(NSNotification *)note {
CGRect pickerFrame;
[[[note userInfo] objectForKey:UIKeyboardFrameEndUserInfoKey]   getValue:&pickerFrame];
CGRect scrollViewFrame = mainView.frame;
scrollViewFrame.size.height -= pickerFrame.size.height;
[mainView setFrame:pickerFrame];
}
-(void)pickerHidden:(NSNotification*)note{
[mainView setFrame:self.view.bounds];
} 
```

这接近我需要做的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:35:08.027

我可以建议看看[本教程](http://cocoawithlove.com/2008/10/sliding-uitextfields-around-to-avoid.html)“Sliding UITextFields around to Avoid the keyboard”。

在您的情况下，您需要将它们的代码放入`textFieldDidBeginEditing`您的`pickerShown`方法中，并改为将它们用于键盘高度的常量更改为选择器高度。

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T05:26:38.710

对于那些寻找替代解决方案的人，这里有[一个](http://de-co-de.blogspot.sg/2009/03/moving-uitextfield-above-keyboard.html). 我把它做成了一个库，可以在复杂的项目中重复使用。

```
/* In Keyboard.m */
static NSUInteger verticalOffset = 0;

+ (void)moveViewForKeyboard:(UITextField *)theTextField inView:(UIView *)view
{
    /* Move 200 for keyboard, change the number for other types */
    [self moveViewUp:view withOffset:theTextField.frame.origin.y - 200];
}

+ (void)moveViewUp:(UIView *)view withOffset:(int)offset
{
    if(offset < 0) 
        offset = 0;

    if(offset != verticalOffset) 
    {
        [self moveView:view withOffset:offset - verticalOffset];
        verticalOffset = offset;
    }
}

+ (void)moveViewOnEndEditing:(UIView *)view
{
    if(verticalOffset != 0)
    {
        [self moveView:view withOffset:-verticalOffset];
        verticalOffset = 0;
    }
}

+ (void)moveView:(UIView *)view withOffset:(int)offset
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3];

    CGRect rect = view.frame;
    rect.origin.y -= offset;
    rect.size.height += offset;
    view.frame = rect;

    [UIView commitAnimations];
} 
```

并在视图中以这种方式使用它：

```
- (void)textFieldDidBeginEditing:(UITextField *)theTextField
{
    [Keyboard moveViewForKeyboard:theTextField inView:self.view];
}

- (void)textFieldDidEndEditing:(UITextField *)theTextField
{
    [Keyboard moveViewOnEndEditing:self.view];
} 
```

# google-apps-script - 谷歌应用程序脚本 - 网络应用程序似乎没有做任何事情。.

> ID：11874595
> 
> 赞同：0
> 
> 时间：2012-08-08T23:16:42.047
> 
> 标签：google-apps-script

我是一名 Java 开发人员，但我使用 Google 协作平台为一个非盈利组织创建了一个小型站点。我有一个表格，我想有点动态，Google Apps 脚本似乎是一个可行的选择。就像学习新技术时经常发生的那样，我从教程/文档中复制并粘贴了下面的代码。然后我发布了它，并将脚本小部件插入到站点上的一个页面中并保存了该页面。当我重新加载页面时，小部件的“占位符”就在那里，但什么也没有发生——没有按钮，没有面板，什么都没有。当我从脚本编辑器运行它时，结果相同。我确定我遗漏了一些明显的东西，但我根本无法让 UI 呈现。一点方向将不胜感激。提前致谢！

```
function doGet(e) {
  Logger.log("Executing the doGet() method . . .");

  var app = UiApp.createApplication();
  var aPanelRoot = app.createVerticalPanel();

  var button = app.createButton('Click Me');
  aPanelRoot.add(button);

  var label = app.createLabel('The button was clicked.');
  label.setId('statusLabel');
  aPanelRoot.add(label);

  var handler = app.createServerHandler('myClickHandler');
  handler.addCallbackElement(label);
  button.addClickHandler(handler);

  aPanelRoot.setVisible(true);
  return app;
}

function myClickHandler(e) {
  var app = UiApp.getActiveApplication();

  var label = app.getElementById('statusLabel');
  label.setVisible(true);

  //app.close();
  return app;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:48:20.740

看来您只是忘记在函数中添加`aPanelRoot`到应用程序`doGet()`

```
app.add(aPanelRoot) 
```

另外：默认情况下，所有小部件都是可见的，因此您可以删除所有`setVisible(true)`语句，因为它们只有在您将它们设置到`false`其他地方时才是必需的......

如果我可以添加最后一条评论，那么选择父小部件通常是一个好主意，`callbackElement`这样当您开始拥有大量元素时就不会忘记添加元素（所有子小部件都自动包含在父小部件中）。

# c++ - Engine.exe 中 0x00000000 处的未处理异常：0xC0000005：访问冲突

> ID：11874596
> 
> 赞同：1
> 
> 时间：2012-08-08T23:16:44.710
> 
> 标签：c++, opengl

我尝试构建本教程：[this one](http://www.opengl-tutorial.org/beginners-tutorials/tutorial-2-the-first-triangle/)

在 window.cpp 中使用以下代码：

```
// Include standard headers
#include <stdio.h>
#include <stdlib.h>

// Include GLEW
#include <GL/glew.h>

// Include GLFW
#include <GL/glfw.h>

//Include GLM
#include <glm/glm.hpp>
using namespace glm;

#include <common/shader.hpp>

int main( void )
{
// Initialise GLFW
if( !glfwInit() )
{
    fprintf( stderr, "Failed to initialize GLFW\n" );
    return -1;
}

glfwOpenWindowHint(GLFW_FSAA_SAMPLES, 4);
glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3);
glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 3);
glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);

// Open a window and create its OpenGL context
if( !glfwOpenWindow( 1024, 768, 0,0,0,0, 32,0, GLFW_WINDOW ) )
{
    fprintf( stderr, "Failed to open GLFW window. If you have an Intel GPU, they are not 3.3 compatible. Try the 2.1 version of the tutorials.\n" );
    glfwTerminate();
    return -1;
}

// Initialize GLEW
if (glewInit() != GLEW_OK) {
    fprintf(stderr, "Failed to initialize GLEW\n");
    return -1;
}

glfwSetWindowTitle( "Tutorial 02" );

// Ensure we can capture the escape key being pressed below
glfwEnable( GLFW_STICKY_KEYS );

// Dark blue background
glClearColor(0.0f, 0.0f, 0.3f, 0.0f);

GLuint VertexArrayID;
glGenVertexArrays(1, &VertexArrayID);
glBindVertexArray(VertexArrayID);

// Create and compile our GLSL program from the shaders
GLuint programID = LoadShaders( "SimpleVertexShader.vertexshader", "SimpleFragmentShader.fragmentshader" );

static const GLfloat g_vertex_buffer_data[] = { 
    -1.0f, -1.0f, 0.0f,
     1.0f, -1.0f, 0.0f,
     0.0f,  1.0f, 0.0f,
};

GLuint vertexbuffer;
glGenBuffers(1, &vertexbuffer);
glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);
glBufferData(GL_ARRAY_BUFFER, sizeof(g_vertex_buffer_data), g_vertex_buffer_data, GL_STATIC_DRAW);

do{

    // Clear the screen
    glClear( GL_COLOR_BUFFER_BIT );

    // Use our shader
    glUseProgram(programID);

    // 1rst attribute buffer : vertices
    glEnableVertexAttribArray(0);
    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);
    glVertexAttribPointer(
        0,                  // attribute 0\. No particular reason for 0, but must match the layout in the shader.
        3,                  // size
        GL_FLOAT,           // type
        GL_FALSE,           // normalized?
        0,                  // stride
        (void*)0            // array buffer offset
    );

    // Draw the triangle !
    glDrawArrays(GL_TRIANGLES, 0, 3); // From index 0 to 3 -> 1 triangle

    glDisableVertexAttribArray(0);

    // Swap buffers
    glfwSwapBuffers();

} // Check if the ESC key was pressed or the window was closed
while( glfwGetKey( GLFW_KEY_ESC ) != GLFW_PRESS &&
       glfwGetWindowParam( GLFW_OPENED ) );

// Close OpenGL window and terminate GLFW
glfwTerminate();

// Cleanup VBO
glDeleteBuffers(1, &vertexbuffer);
glDeleteVertexArrays(1, &VertexArrayID);

return 0;
} 
```

`

以及 shader.cpp 中的以下代码

```
#include <stdio.h>
#include <string>
#include <vector>
#include <iostream>
#include <fstream>
#include <algorithm>
using namespace std;

#include <stdlib.h>
#include <string.h>

#include <GL/glew.h>

#include "shader.hpp"

GLuint LoadShaders(const char * vertex_file_path,const char * fragment_file_path){

// Create the shaders
GLuint VertexShaderID = glCreateShader(GL_VERTEX_SHADER);
GLuint FragmentShaderID = glCreateShader(GL_FRAGMENT_SHADER);

// Read the Vertex Shader code from the file
std::string VertexShaderCode;
std::ifstream VertexShaderStream(vertex_file_path, std::ios::in);
if(VertexShaderStream.is_open()){
    std::string Line = "";
    while(getline(VertexShaderStream, Line))
        VertexShaderCode += "\n" + Line;
    VertexShaderStream.close();
}

// Read the Fragment Shader code from the file
std::string FragmentShaderCode;
std::ifstream FragmentShaderStream(fragment_file_path, std::ios::in);
if(FragmentShaderStream.is_open()){
    std::string Line = "";
    while(getline(FragmentShaderStream, Line))
        FragmentShaderCode += "\n" + Line;
    FragmentShaderStream.close();
}

GLint Result = GL_FALSE;
int InfoLogLength;

// Compile Vertex Shader
printf("Compiling shader : %s\n", vertex_file_path);
char const * VertexSourcePointer = VertexShaderCode.c_str();
glShaderSource(VertexShaderID, 1, &VertexSourcePointer , NULL);
glCompileShader(VertexShaderID);

// Check Vertex Shader
glGetShaderiv(VertexShaderID, GL_COMPILE_STATUS, &Result);
glGetShaderiv(VertexShaderID, GL_INFO_LOG_LENGTH, &InfoLogLength);
std::vector<char> VertexShaderErrorMessage(InfoLogLength);
glGetShaderInfoLog(VertexShaderID, InfoLogLength, NULL,
&VertexShaderErrorMessage[0]);
fprintf(stdout, "%s\n", &VertexShaderErrorMessage[0]);

// Compile Fragment Shader
printf("Compiling shader : %s\n", fragment_file_path);
char const * FragmentSourcePointer = FragmentShaderCode.c_str();
glShaderSource(FragmentShaderID, 1, &FragmentSourcePointer , NULL);
glCompileShader(FragmentShaderID);

// Check Fragment Shader
glGetShaderiv(FragmentShaderID, GL_COMPILE_STATUS, &Result);
glGetShaderiv(FragmentShaderID, GL_INFO_LOG_LENGTH, &InfoLogLength);
std::vector<char> FragmentShaderErrorMessage(InfoLogLength);
glGetShaderInfoLog(FragmentShaderID, InfoLogLength, NULL,
&FragmentShaderErrorMessage[0]);
fprintf(stdout, "%s\n", &FragmentShaderErrorMessage[0]);

// Link the program
fprintf(stdout, "Linking program\n");
GLuint ProgramID = glCreateProgram();
glAttachShader(ProgramID, VertexShaderID);
glAttachShader(ProgramID, FragmentShaderID);
glLinkProgram(ProgramID);

// Check the program
glGetProgramiv(ProgramID, GL_LINK_STATUS, &Result);
glGetProgramiv(ProgramID, GL_INFO_LOG_LENGTH, &InfoLogLength);
std::vector<char> ProgramErrorMessage( max(InfoLogLength, int(1)) );
glGetProgramInfoLog(ProgramID, InfoLogLength, NULL, &ProgramErrorMessage[0]);
fprintf(stdout, "%s\n", &ProgramErrorMessage[0]);

glDeleteShader(VertexShaderID);
glDeleteShader(FragmentShaderID);

return ProgramID;
} 
```

但是当在调试模式下运行代码时（我从教程文件中复制了完整的代码）我的程序启动了，但是它打开了 Microsoft Visual C++ 2010 Express 的错误窗口，该窗口包含以下错误：

```
Unhandled exception at 0x00000000 in Engine.exe: 0xC0000005: Access violation. 
```

我的调试控制台显示以下错误/输出：

```
'Engine.exe': Loaded 'C:\Users\Domenik\Documents\Visual Studio 2010\Projects\Engine\Debug\Engine.exe', Symbols loaded.
'Engine.exe': Loaded 'C:\Windows\SysWOW64\ntdll.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\kernel32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\KernelBase.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Program Files\AVAST Software\Avast\snxhk.dll', Cannot find or open the PDB file
'Engine.exe': Loaded 'C:\Windows\SysWOW64\opengl32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\msvcrt.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\advapi32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\sechost.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\rpcrt4.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\sspicli.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\cryptbase.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\gdi32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\user32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\lpk.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\usp10.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\glu32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\ddraw.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\dciman32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\setupapi.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\cfgmgr32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\oleaut32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\ole32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\devobj.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\dwmapi.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Users\Domenik\Documents\Visual Studio 2010\Projects\Engine\Debug\glew32.dll', Binary was not built with debug information.
'Engine.exe': Loaded 'C:\Windows\SysWOW64\msvcp100d.dll', Symbols loaded.
'Engine.exe': Loaded 'C:\Windows\SysWOW64\msvcr100d.dll', Symbols loaded.
'Engine.exe': Loaded 'C:\Windows\SysWOW64\imm32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\msctf.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\uxtheme.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\winmm.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\nvoglv32.dll', Cannot find or open the PDB file
'Engine.exe': Loaded 'C:\Windows\SysWOW64\shell32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\shlwapi.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\version.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\ntmarta.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\Wldap32.dll', Symbols loaded (source information stripped).
'Engine.exe': Loaded 'C:\Windows\SysWOW64\powrprof.dll', Symbols loaded (source information stripped).
The thread 'Win32 Thread' (0xcfc) has exited with code 0 (0x0).
'Engine.exe': Unloaded 'C:\Windows\SysWOW64\powrprof.dll'
The thread 'Win32 Thread' (0x1198) has exited with code 0 (0x0).
The thread 'Win32 Thread' (0x538) has exited with code 0 (0x0).
First-chance exception at 0x00000000 in Engine.exe: 0xC0000005: Access violation.
Unhandled exception at 0x00000000 in Engine.exe: 0xC0000005: Access violation.
The thread 'Win32 Thread' (0xdb0) has exited with code -805306369 (0xcfffffff).
The thread 'Win32 Thread' (0x1370) has exited with code -805306369 (0xcfffffff).
The program '[2624] Engine.exe: Native' has exited with code -805306369 (0xcfffffff). 
```

我的堆栈包含以下内容：

```
00000000()  
Engine.exe!main()  Line 54 + 0x12 bytes C++
Engine.exe!__tmainCRTStartup()  Line 555 + 0x19 bytes   C
Engine.exe!mainCRTStartup()  Line 371   C
kernel32.dll!@BaseThreadInitThunk@12()  + 0x12 bytes    
ntdll.dll!___RtlUserThreadStart@8()  + 0x27 bytes   
ntdll.dll!__RtlUserThreadStart@8()  + 0x1b bytes 
```

我读过指针NULL（它发现它在shader.cpp中使用了4次）如果经常使用它可能会使程序崩溃。听起来如此，我可以将它们全部更改为 0 或 0L，但这不能解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:34:09.110

真的看不出你是怎么遇到这个问题的。但是您可以从该站点下载源代码。运行它并与您自己的代码进行比较。

# batch-file - 在批处理脚本中查询注册表项

> ID：11874598
> 
> 赞同：3
> 
> 时间：2012-08-08T23:16:51.483
> 
> 标签：batch-file, cmd, windows-scripting

我正在使用以下代码获取启动时正在运行的程序列表，并将它们记录到文件中。

`for /f "skip=2 tokens=1,2*" %%A in ('REG QUERY "HKCU\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run" 2^>NUL') do echo %%A : %%C >> Log.txt`

这适用于值名称不包含空格的条目，但是当它包含空格时，例如“Google Update”，它会弄乱令牌，并且 %%C 变为: `REG_SZ <path>`，而不仅仅是路径。

有没有人有更好的方法来查询注册表并记录其值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T15:06:42.007

好吧，我有一个可行的解决方案，我仍然很想看看是否有人有更好的解决方案。

```
for /f "skip=2 tokens=*" %%A in ('REG QUERY "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" 2^>NUL') do (
    set regstr=%%A
    set regstr=!regstr:    =^|!

    for /f "tokens=1,3 delims=  |" %%X in ("!regstr!") do (
        echo %%X : %%Y
    )
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T13:18:40.610

*特定版本，在 XP 中有效，在 Win 7 中无效 - 请参阅评论了解详细信息。*

输出中的列由制表符 (0x09) 分隔，因此仅使用制表符作为分隔符：
`for /f "skip=2 tokens=1,2* delims= " %%A`
由于标记如何处理白色字符，这不能很好地显示，但后面的字符`delims=`必须是实际的`TAB`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-18T05:52:04.097

这是通过 WMI 调用 Win32_StartupCommand 类的更好方法，结果输出到屏幕以及与脚本名称相同的文件夹中的 CSV 文件：

```
@echo off
setlocal enabledelayedexpansion
    cd \ & pushd "%~dp0"
if exist "%~n0.tmp" (del /f /q "%~n0.tmp")
if exist "%~n0.csv" (del /f /q "%~n0.csv")
wmic /namespace:\\root\cimv2 path Win32_StartupCommand get /all /format:csv >"%~n0.tmp"
for /f "tokens=1,2,3,4,5,6,7,8,9 usebackq delims=, skip=2" %%a in (`type "%~n0.tmp"`) do (
  echo %%b, %%c >>"%~n0.csv"
  echo %%b, %%c
)
if exist "%~n0.tmp" (del /f /q "%~n0.tmp")
popd & endlocal
exit /b 0` 
```

# unit-testing - 如何使用 HUnit 和 Cabal 进行自动化测试？

> ID：11874601
> 
> 赞同：15
> 
> 时间：2012-08-08T23:17:35.343
> 
> 标签：unit-testing, haskell, cabal, hunit

一天的大部分时间里，我一直在与 Cabal 进行斗争，试图让它的自动化测试功能与 HUnit 一起工作。我已经阅读了[这里](http://www.haskell.org/cabal/users-guide/developing-packages.html#test-suites)和[这里](http://hackage.haskell.org/packages/archive/Cabal/1.10.1.0/doc/html/Distribution-TestSuite.html)的文档，并且我已经设置了我的测试套件部分，就像它显示的那样，但是每当我尝试使用`cabal build`Cabal 构建包时，都说唯一支持的测试套件类型是`exitcode-stdio-1.0`. 是什么赋予了？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-08T23:17:35.343

# 背景

所以这是交易，阴谋集团网站上的文档是“未来文档”，也就是说，并非所有这些功能都已实现和发布。Cabal-install 0.14.0 带有`detailed-0.9`接口，这是文档中指定的版本（`detailed-1.0`），但我还没有遇到任何与此相关的问题。如果您有 cabal-install 0.10.2 附带的 Haskell 平台版本 2011.4，您将无法使用该`detailed-0.9`界面。您需要升级到 cabal-install 0.14.0 附带的 Haskell Platform 2012.2。您也可以单独升级 cabal-install，这就是我所做的，因为在 Fedora 17 上，Haskell 平台仅在 2011.4 上。

# 安装

[在此处](http://hackage.haskell.org/packages/archive/Cabal/1.10.1.0/doc/html/Distribution-TestSuite.html)的文档中，您将看到如何将`detailed-0.9`界面与 QuickCheck 一起使用的示例。它提到了一些具有 HUnit、QuickCheck1 和 QuickCheck2 接口的包，但只有 QuickCheck2 的包在 hackage 上可用。如果您想要其余框架的软件包，您需要使用 darcs（一个 VCS）从[该](http://community.haskell.org/~ttuegel/)位置下载它们。您要为 HUnit 接口运行的命令是这样的`darcs get http://community.haskell.org/~ttuegel/cabal-test-hunit/`：您可能必须调整 .cabal 文件才能构建它，特别是它依赖于`ghc 3.*`and `cabal 1.10`。我将其更改为我的版本（`ghc 4.*`和`cabal 1.14`）并且它构建得很好。

# 测试

构建好界面后，您需要在测试模块中做一些事情，以便 Cabal 可以运行它。具体来说，您需要同时导入`Distribution.TestSuite`和`Distribution.TestSuite.HUnit`。之后，您需要使用 HUnit 接口中提供的函数将您的 HUnit 测试转换为 Cabal 测试。这是相关的代码行：

```
import qualified Distribution.TestSuite as Cabal
import qualified Distribution.TestSuite.HUnit as CabalHUnit

tests = map (\(x,y) -> CabalHUnit.test x y) [("Login tests", loginTests)] 
```

就是这样！您应该能够运行`cabal configure --enable-tests && cabal build && cabal test`并看到您的单元测试通过（或失败）。

*编辑*
编辑澄清该`detailed-0.9`接口包含在 cabal-install 0.14.0 中，而不是`detailed-1.0`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-06T06:48:00.287

虽然 Dwilson 的回答很好，但`detailed`目前没有得到很好的支持。您可以`HUnit`使用和`cabal`集成。`exitcode-stdio-1.0``Test.Framework`

如果测试失败，它将输出所有成功和失败的测试`stdout`以及失败的构建。见我的[要点](https://gist.github.com/Risto-Stevcev/a9798abc898fba99235b)。

# javascript - javascript如何定义内部函数

> ID：11874604
> 
> 赞同：0
> 
> 时间：2012-08-08T23:17:53.437
> 
> 标签：javascript

我想在函数中定义一个内部函数。

```
function outfunction(){
  function innerfunction(){
      alert('inner'); 
  }
  alert('out');
} 
```

但内部函数永远不会被调用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-08T23:20:21.697

你需要执行它：

```
function outfunction(){
  function innerfunction(){
      alert('inner'); 
  }
  innerfunction();
  alert('out');
} 
```

或者：

```
function outfunction(){
  (function(){
      alert('inner'); 
  })();
  alert('out');
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T23:20:50.613

您需要调用嵌套函数：

```
function outfunction(){
    function innerfunction(){
        alert('inner'); 
    }
    alert('out');
    innerfunction(); // like this
} 
```

函数嵌套的事实仅意味着它的范围有限。

# .net - DLLImport 无法加载 DLL

> ID：11874606
> 
> 赞同：0
> 
> 时间：2012-08-08T23:18:11.783
> 
> 标签：.net, reflection, embedded, dllimport

我有代码可以调用用 C 编写的 DLL。这段代码在我们拥有 Windows7 的开发人员机器上运行良好。但它在我们拥有 Windows Embedded Standard OS 的 Kiosk 上失败，并出现以下异常：“无法加载 DLL 'xxx.dll'：找不到指定的模块。（来自 HRESULT 的异常：0x8007007E）”。

我的 DLL 和以前一样位于我的工作目录中。我的项目设置没有改变，工作目录指定正确。我尝试使用从 Kernel.DLL 导出的函数设置“DllImport”路径，但它无济于事。什么可能会导致此错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:25:59.210

使用 DependencyWalkier [http://www.dependencywalker.com/](http://www.dependencywalker.com/)之类的工具加载 DLL，并检查 DLL 需要哪些外部模块。您的 W7 上可能有一些 Kiosk 机器上不存在的东西。如果我没记错的话，如果 .Net 没有找到所有依赖项，它会引发同样的异常。

该工具将允许您查看 DLL 引用了哪些本机模块。如果您设法在 Kiosk 上运行该工具，它将向您报告所有缺少的依赖项。如果有的话 - 你有理由。如果没有 - 好吧..然后乐趣又开始了:)

顺便提一句。堆栈跟踪中有什么有趣的吗？顺便说一句。您是否尝试过启用 fusionlog？嗯.. 不.. 它是本机 DLL，所以 Depends 应该找到原因。我敢打赌它是运行时版本。啊对 --- 那个 DLL 是否完全属于你？如果是您的，该本地 DLL 是使用 DEBUG 还是 RELEASE 模式构建的？如果调试，则在 Release 中重新编译。这是一个很常见的陷阱。

# javascript - Backbone：确定视图是否已经加载

> ID：11874609
> 
> 赞同：1
> 
> 时间：2012-08-08T23:18:50.547
> 
> 标签：javascript, backbone.js

我想通过更改 url 来更改我的主干应用程序的当前页面。我设置了路由，当我更改 url 时，我的页面正在更改，预计每次我访问给定路由时，都会向 dom 呈现一个新视图。

我的路由器：

```
myApp.Application = Backbone.Router.extend({

  routes: {
    ''      : 'home'
    //etc
  },

  initialize : function() {
    myApp.dom.$container = $('#container');
    myApp.dom.$container.empty();
  },

  home : function() {
    myApp.loginView = new myApp.views.home();
    myApp.dom.$container.append(myApp.home.render().el);
  }

  }) 
```

我是否认为我需要在渲染之前检查（例如）myApp.loginView 是否存在？

所以像：

```
 home : function() {
    if (!myApp.loginView) {}
      myApp.loginView = new myApp.views.home();
      myApp.dom.$container.append(myApp.home.render().el);
    } else {
      //just show it
    }
  } 
```

..为我的每条路线都这样做？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T18:07:31.413

这看起来很湿，我宁愿做一些类似电话的事情`isAlreadyRendered()`

此外，当您的 myApp.views 似乎是类时，将所有内容都坚持到 myApp.SpecificName 似乎是错误的。

用什么初始化呢`App.views.class = new App.Views.Class`

然后创建一个工厂来启动视图，比如

```
function factory(className){
  if( App.views[className.toCamelCase()] ) return;
  App.views[className.toCamelCase()] = new App.Views[className].apply(App.Views, [].slice.call(arguments, 1))

} 
```

类似的东西，我习惯于使用咖啡脚本，这也会使事情变得更容易。

apply 和 slice 以及所有这些，以便您应该能够在第一个之后将尽可能多的 args 传递给因素，尽管这都是我的想法，所以它可能是一个学习实验让它工作和了解使用 apply 和 call 的乐趣（如果你使用 coffeescript 你会更开心）

请享用！

# paypal - 贝宝并行和快速结帐

> ID：11874610
> 
> 赞同：0
> 
> 时间：2012-08-08T23:18:51.647
> 
> 标签：paypal, express-checkout

我正在使用新版本的 paypal Checkout Express API 来实现并行支付，

当我发送请求时出现错误：

```
The totals of the cart item amounts do not match order amounts. 
```

这是来自 api debug 的请求和响应：

```
INFO: <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:urn="urn:ebay:api:PayPalAPI" xmlns:ebl="urn:ebay:apis:eBLBaseComponents" xmlns:cc="urn:ebay:apis:CoreComponentTypes" xmlns:ed="urn:ebay:apis:EnhancedDataTypes"><soapenv:Header><urn:RequesterCredentials><ebl:Credentials><ebl:Username>sdk-three_api1.sdk.com</ebl:Username><ebl:Password>QFZCWN5HZM8VBG7Q</ebl:Password><ebl:Signature>A-IzJhZZjhg29XQ2qnhapuwxIDzyAZQ92FRP5dqBzVesOkzbdUONzmOU</ebl:Signature></ebl:Credentials></urn:RequesterCredentials></soapenv:Header><soapenv:Body><urn:SetExpressCheckoutReq><urn:SetExpressCheckoutRequest><ebl:Version>92.0</ebl:Version><ebl:SetExpressCheckoutRequestDetails><ebl:ReturnURL>http://localhost:8080/EC/GetExpressCheckout?currencyCodeType=null</ebl:ReturnURL><ebl:CancelURL>http://localhost:8080/index.html</ebl:CancelURL><ebl:NoShipping>0</ebl:NoShipping><ebl:PaymentDetails><ebl:OrderTotal currencyID="USD">10.00</ebl:OrderTotal><ebl:ItemTotal currencyID="USD">10.0</ebl:ItemTotal><ebl:PaymentDetailsItem><ebl:Quantity>1</ebl:Quantity><ebl:Amount currencyID="USD">10.0</ebl:Amount></ebl:PaymentDetailsItem><ebl:PaymentDetailsItem><ebl:Quantity>1</ebl:Quantity><ebl:Amount currencyID="USD">10.0</ebl:Amount></ebl:PaymentDetailsItem><ebl:SellerDetails><ebl:PayPalAccountID>tarik._1341024461_biz@gmail.com</ebl:PayPalAccountID></ebl:SellerDetails><ebl:PaymentAction>Sale</ebl:PaymentAction><ebl:PaymentRequestID>1</ebl:PaymentRequestID></ebl:PaymentDetails><ebl:PaymentDetails><ebl:OrderTotal currencyID="USD">10.00</ebl:OrderTotal><ebl:ItemTotal currencyID="USD">10.0</ebl:ItemTotal><ebl:PaymentDetailsItem><ebl:Quantity>1</ebl:Quantity><ebl:Amount currencyID="USD">10.0</ebl:Amount></ebl:PaymentDetailsItem><ebl:PaymentDetailsItem><ebl:Quantity>1</ebl:Quantity><ebl:Amount currencyID="USD">10.0</ebl:Amount></ebl:PaymentDetailsItem><ebl:SellerDetails><ebl:PayPalAccountID> tarik._1341024461_biz@gmail.com</ebl:PayPalAccountID></ebl:SellerDetails><ebl:PaymentAction>Sale</ebl:PaymentAction><ebl:PaymentRequestID>2</ebl:PaymentRequestID></ebl:PaymentDetails></ebl:SetExpressCheckoutRequestDetails></urn:SetExpressCheckoutRequest></urn:SetExpressCheckoutReq></soapenv:Body></soapenv:Envelope> 
```

9 août 2012 01:01:34 com.paypal.core.LoggingManager 日志信息：2012-08-08T23:01:33ZFailure222642713a617由于参数无效，交易被拒绝。有关详细信息，请参阅其他错误消息。购物车项目总金额与订单金额不匹配。10413Error92.03386080

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-12T11:29:40.990

问题是它所说的：

```
The totals of the cart item amounts do not match order amounts.# 
```

确保您从购物车中发送相同数量的物品以匹配订单金额。

# android - Android：在服务中使用网络

> ID：11874611
> 
> 赞同：12
> 
> 时间：2012-08-08T23:19:02.093
> 
> 标签：android, networking, service

在我的 Android 应用程序的 Service 类中调用 REST WebService 会创建`NetworkOnMainThreadException`.

我理解为什么会在 Activity 中引发此异常：通过网络同步获取某些内容是一种非常糟糕的做法，但我很惊讶在服务类中看到同样的错误。所以我的问题是：

- 在这种特定情况下，我应该使用`StrictMode.setThreadPolicy()`来允许这个调用。*（对于那些因为在活动中遇到此错误而阅读此内容的人，请不要使用 StrictMode 隐藏此错误，请使用 AsyncTask）*

- 或者我应该使用 AsyncTask 吗？在那种情况下，这里有什么问题？线程上的服务不是与 Activity 的服务分开的吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-09T00:06:34.880

尽管[Service](http://developer.android.com/reference/android/app/Service.html)用于后台处理，但它们在**主线程**中运行。

来自[文档](http://developer.android.com/guide/components/services.html)的简短引用：

> 注意：默认情况下，服务与声明它的应用程序在同一进程中运行，并且在该应用程序的主线程中运行。因此，如果您的服务在用户与来自同一应用程序的活动交互时执行密集或阻塞操作，则该服务将降低活动性能。为避免影响应用程序性能，您应该在服务内启动一个新线程。

“后台处理”意味着服务没有用户界面，即使用户没有直接与应用程序交互，它也可以运行。但是默认情况下，所有后台处理仍然发生在主线程中。

那么，如何解决它并摆脱异常呢？正如文档所建议的，您必须使用后台线程。在您的服务中，您可以`AsyncTask`直接使用或创建线程。但我想 [IntentService](https://developer.android.com/reference/android/app/IntentService.html)可能最适合您的情况。`IntentService`在后台线程中处理请求（这就是您正在寻找的那种服务）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-19T18:47:19.460

服务在主线程中运行，这就是为什么你需要做类似的事情

```
public class ServiceDownloadSomething extends Service {

private static final String TAG = ServiceDownloadSomething.class.getSimpleName();

private boolean isRunning;
private Thread backgroundThread;

private Runnable myTask = new Runnable() {
    public void run() {
        while (true) {

            //sleep 30 seconds
            long sleepTime = System.currentTimeMillis() + (15 * 1000);

            try {
                Thread.sleep(sleepTime - System.currentTimeMillis());
            } catch (InterruptedException e) {
                e.printStackTrace();
            }

            try {
                //perform network action
                downloadSomething();
            } catch (IOException e) {
                e.printStackTrace();
            }

        }
    }
};

@Nullable
@Override
public IBinder onBind(Intent intent) {
    return null;
}

@Override
public void onCreate() {
    this.isRunning = false;
    this.backgroundThread = new Thread(myTask);
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    if(!this.isRunning) {
        this.isRunning = true;
        this.backgroundThread.start();
    }

    return START_STICKY;
}

@Override
public void onDestroy() {
    this.isRunning = false;
}

private void downloadSomething() throws IOException {

    URL url = new URL("http://192.168.197.101:8080/api/medias/");
    HttpURLConnection conn = (HttpURLConnection) url.openConnection();
    conn.setReadTimeout(10000 /* milliseconds */);
    conn.setConnectTimeout(15000 /* milliseconds */);
    conn.setRequestMethod("POST");
    conn.setDoInput(true);
    // Starts the query
    conn.connect();

    InputStream is = conn.getInputStream();
    StringBuilder sb = new StringBuilder();
    int r;
    do {
        r = is.read();

        if (r != -1){
            sb.append((char) r);
        }

    } while (r != -1);

    String json = sb.toString();
    Log.d(TAG, json);

} 
```

}

# c++ - 尝试使用 C++ 打开显示设备句柄以更改 Windows XP 上的亮度

> ID：11874615
> 
> 赞同：0
> 
> 时间：2012-08-08T23:19:11.003
> 
> 标签：c++, windows, winapi, monitor

我正在尝试编写 C++/WinAPI 代码来更改显示器亮度。代码必须与 Windows XP 兼容，所以我不能使用像 SetMonitorBrightness 这样的 API。所以我想尝试一下[IOCTL_VIDEO_SET_DISPLAY_BRIGHTNESS](http://msdn.microsoft.com/en-us/library/aa372704.aspx)但我似乎连设备句柄都没有。

```
HANDLE hDevice = ::CreateFile(_T("\\\\.\\LCD"),
    GENERIC_READ | GENERIC_WRITE,
    FILE_SHARE_READ | FILE_SHARE_WRITE,
    NULL,
    OPEN_EXISTING,
    0, NULL);
if(hDevice != INVALID_HANDLE_VALUE)
{
    //Do work here

    ::CloseHandle(hDevice);
}
else
{
    nOSErr = ::GetLastError();
    //Get code 2
} 
```

我尝试了 GENERIC_READ、GENERIC_WRITE 和 FILE_SHARE_READ、FILE_SHARE_WRITE 标志的各种组合，但在调用 CreateFile 时总是得到错误代码 2。

那么我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T01:08:02.960

您知道并非所有设备都支持此 API，对吧？您的笔记本电脑可能支持它，因为它允许软件调整其屏幕亮度，甚至可能使用键盘上的功能键。您的另一台机器（运行 Windows 7 的机器）可能不支持它，因此调用`CreateHandle`with`\\\\.\\LCD`不会给您带来任何有用的信息。它与操作系统无关，与硬件和/或视频驱动程序无关。

# android - android中的灰度位图

> ID：11874616
> 
> 赞同：3
> 
> 时间：2012-08-08T23:19:16.600
> 
> 标签：android, image, image-processing, bitmap, grayscale

我有一个对应于“灰度位图”（一个字节->一个像素）的字节数组，我需要为此图像创建一个 PNG 文件。

下面的方法有效，但是创建的 png 非常大，因为我使用的位图是 ARGB_8888 位图，每个像素占用 4 个字节而不是 1 个字节。

我无法使其与不同于 ARGB_8888 的其他 Bitmap.Config 一起使用。也许 ALPHA_8 是我需要的，但我无法让它工作。

我还尝试了其他一些帖子中包含的 toGrayScale 方法（[在 Android 中将位图转换为](https://stackoverflow.com/questions/3373860/convert-a-bitmap-to-grayscale-in-android)灰度），但我对大小有同样的问题。

```
public static boolean createPNGFromGrayScaledBytes(ByteBuffer grayBytes, int width,
        int height,File pngFile) throws IOException{

    if (grayBytes.remaining()!=width*height){
        Logger.error(Tag, "Unexpected error: size mismatch [remaining:"+grayBytes.remaining()+"][width:"+width+"][height:"+height+"]", null);
        return false;
    }
    Bitmap bitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888);
    // for each byte, I set it in three color channels.
    int gray,color;
    int x=0,y=0;        
    while(grayBytes.remaining()>0){

        gray = grayBytes.get();
        // integer may be negative as byte is signed. make them positive. 
        if (gray<0){gray+=256;}

        // for each byte, I set it in three color channels.
        color= Color.argb(-1, gray, gray, gray);

        bitmap.setPixel(x, y, color);
        x++;
        if (x==width){
            x=0;
            y++;
        }           
    }
    FileOutputStream fos=null;

    fos = new FileOutputStream(pngFile);
    boolean result= bitmap.compress(Bitmap.CompressFormat.PNG,100,fos);
    fos.close();
    return result;
} 
```

编辑：链接到生成的文件（它可能看起来很废话，但只是用随机数据创建的）。 [http://www.tempfiles.net/download/201208/256402/huge_png.html](http://www.tempfiles.net/download/201208/256402/huge_png.html)

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-09T01:05:00.343

正如您所注意到的，将灰度图像保存为 RGB 非常昂贵。如果您有亮度数据，那么最好保存为灰度 PNG 而不是 RGB PNG。

Android 框架中可用的位图和图像功能真正适用于读取和写入框架和 UI 组件支持的图像格式。此处不包括灰度 PNG。

如果您想在 Android 上保存灰度 PNG，则需要使用[http://code.google.com/p/pngj/之类的库](http://code.google.com/p/pngj/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T20:17:57.903

如果您使用 OPENCV for Android 库，您可以使用该库将二进制数据保存到 png 文件中。我的方法是：在 jni 部分，设置 Mat 其数据以字节数组开头：

```
jbyte* _ByteArray_BrightnessImgForOCR = env->GetByteArrayElements(ByteArray_BrightnessImgForOCR, 0);
Mat img(ByteArray_BrightnessImgForOCR_h, ByteArray_BrightnessImgForOCR_w, CV_8UC1, (unsigned char *) _ByteArray_BrightnessImgForOCR); 
```

然后将其写入 png 文件。

```
imwrite("/mnt/sdcard/binaryImg_forOCR.png", img); 
```

当然，您需要花一些时间来熟悉 OpenCV 和 Java 原生编码。遵循[OpenCV for Android 示例](http://docs.opencv.org/2.4.3/doc/tutorials/introduction/android_binary_package/dev_with_OCV_on_Android.html#dev-with-ocv-on-android)，学习速度很快。

# javascript - $.getJSON 和 google fonts API 在 jQuery 版本大于 1.4.4 的 Internet Explorer 中停止工作

> ID：11874617
> 
> 赞同：1
> 
> 时间：2012-08-08T23:19:25.287
> 
> 标签：javascript, jquery, internet-explorer, google-font-api

我几乎花了一整天的时间试图找到解决这个问题的方法。

我已经成功编写了代码来使用 Google 字体 API 和 jQuery 1.4.4 动态检索和显示全部字体。（适用于所有浏览器）

我不得不将 jQuery 更改为 1.7.2 版本，但不幸的是，我注意到我编写的代码在除 Internet Explorer 之外的所有浏览器中都运行良好。

我做了一些测试，发现在 Internet Explorer 中使用高于 1.4.4 的 jQuery 版本时，$.getJSON 或 $.ajax 无法从 Google 加载 JSON 字体数据。

这是我正在使用的代码：

```
$(function(){           

$.getJSON('https://www.googleapis.com/webfonts/v1/webfonts?key=XXXXXX', function(json) {

alert(json);

});
}); 
```

经过一些研究，我也尝试过：

```
$.ajax({
type: "get",
url: "https://www.googleapis.com/webfonts/v1/webfonts?key=XXXXXXXX",
cache:false,
dataType:'json',
success: function(data){
alert(data);
}
}); 
```

在 Internet Explorer 中使用任何大于 1.4.4 的 jQuery 版本时，这两种方法都会失败 - 没有任何反应。

任何想法为什么？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:42:59.337

似乎是 IE 阻止了与您站点域之外的主机的连接。这是由于[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)。这对于最新最好的浏览器来说通常没什么大不了的，尽管它仍然可以在任何浏览器上发生。我使用 JSFiddle 测试了您的代码，它在 Chrome 21 中引发了关于相同来源的错误。

通常，解决此问题的方法是使用 JSONP。不幸的是，Google Webfonts API 不支持 JSONP。我能想到的跨浏览器获取数据的最佳方法是使用 PHP 等服务器端编程语言下载 JSON。从那里，您可以将 JSON 回显到页面并使用该`$.getJSON`函数在您的服务器上本地获取该数据。

**示例：** *fontApi.php*（服务器上的本地文件）

```
<?php
$json = file_get_contents('https://www.googleapis.com/webfonts/v1/webfonts?key=XXXXXX');
die($json); // prints JSON to the screen that jQuery can use
?> 
```

然后使用下面的jQuery ...

```
$.getJSON('fontApi.php', function(json) {
    //your code
}); 
```

希望这可以帮助你:)

# ember.js - Ember.js：如何在模板中保留 HTML 标签

> ID：11874626
> 
> 赞同：0
> 
> 时间：2012-08-08T23:20:40.640
> 
> 标签：ember.js

```
<script type="text/x-handlebars" data-template-name="item-view">
  {{#with view.content.json}}
  <tr>
    <td>{{unbound artistName}}</td>
    <td>{{unbound price}}</td>
    <td>{{unbound primaryGenreName}}</td>
    <td>{{unbound version}}</td>
  </tr>
  {{/with}}
</script>

<table>
  <script type="text/x-handlebars">
    {{view Em.CollectionView itemViewClass="App.ItemView" contentBinding="App.itemsController"}}
  </script>
</table> 
```

上述模板中的 HTML 表格标签是使用 ember-1.0.pre.js 去除的。有没有比这更合适的模式来输出有很多值的结果表？

[Handlebars.js：嵌套模板去除“安全”HTML](https://stackoverflow.com/questions/9457566/handlebars-js-nested-templates-strip-safe-html "Handlebars.js：嵌套模板剥离安全 HTML")的帖子似乎与保留标签的主题相关，但 Ember 在此基础上添加了自己的抽象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:36:38.910

查看[ember 文档](http://docs.emberjs.com/symbols/Ember.CollectionView.html#automaticmatchingofparentchildtagnames)，我认为这就是您要查找的内容。您应该能够根据您的目标替换一堆不同的列表类型。

```
anUndorderedListView = Ember.CollectionView.create({
    tagName: 'tbody',
    content: ['A','B','C','D'],
    itemViewClass: Ember.View.extend({
        templateName: 'item-view'
    })
}); 
```

[**演示**](http://jsfiddle.net/scispear/PAqpG/)

# android - “持久状态”与“当前状态”

> ID：11874627
> 
> 赞同：15
> 
> 时间：2012-08-08T23:20:41.957
> 
> 标签：android, android-activity, onpause, activity-lifecycle, application-state

试图决定（对于我的应用程序）在[onPause()](https://stackoverflow.com/q/5166201/869501)中保存什么以及在[onSaveInstanceState()](http://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState%28android.os.Bundle%29)中保存什么，我梳理了整个 SO 以获得提示和明确的指导方针。

如果我理解正确，[onSaveInstanceState()](https://stackoverflow.com/a/151940/869501)最适合保存“运行时更改”或“当前状态”（无论这意味着什么），而[onPause()](https://stackoverflow.com/q/5166201/869501)最适合保存“持久状态”（无论这意味着什么）。

我仍然难以确定我的应用程序中的“持久状态”与“当前状态”。例如，虽然用户偏好显然是持久的，`onPause()`但当用户更改它们时，Android UI 框架总是自动保存它们时，我是否需要保存它们？

类数据成员是否需要保存在[onSaveInstanceState()](https://stackoverflow.com/a/151940/869501)中？我需要为我的应用程序中的*每个*课程都这样做吗？

我很困惑。

你能举出真实世界的例子来说明什么必须保存`onPause()`和什么必须保存`onSaveInstanceState()`吗？[除了](http://developer.android.com//guide/topics/resources/runtime-changes.html)设备配置更改外，就是这样。

--

在我的问题得到回答*后*，一些新的见解：

*   onSaveInstanceState[不会写入任何东西](https://stackoverflow.com/a/8092181)，也不会以任何方式持久化`Bundle`。
*   onSaveInstanceState 的`Bundle`数据只会[保存在内存中](https://stackoverflow.com/a/8092164)，直到应用程序关闭。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-09T00:24:52.497

您不需要在 onPause 中存储用户首选项，因为正如您所说，框架会为您执行此操作。

要区分持久数据与状态信息，请考虑一个文本编辑器应用程序。

**持久数据**

假设用户输入了几个单词，然后退出了应用程序。用户没有明确告诉我们将这些数据保存到文件中，但是当他们回来时将这些数据存储起来肯定会很好。这是持久数据，您希望将其存储在 onPause() 中。

**状态数据**

同样，假设您有 2 个选项卡和一个跟踪当前选择的选项卡的变量。这是您将存储在 onSaveInstanceState() 中的状态数据。

**灰质**

最后假设您在编辑器中有一个类，用于跟踪编辑器中的字符数和行数。这是状态数据，您可以将其存储在 onSaveInstanceState() 中，也可以将其丢弃并在重新启动时重新计算。是否丢弃它可能取决于计算需要多长时间，例如，如果您可以通过存储数据来阻止网络请求，那么就这样做。

**进一步的想法**

通过使用您的应用程序，您应该很明显是否有一个区域您未能存储正确的数据。请务必执行诸如点击主页按钮然后从设备管理器中关闭您的应用程序之类的操作。这将让您遇到应用程序关闭而不是暂停的极端情况。

如果您的 UI 状态在整个生命周期事件中保持一致并且您的用户数据仍然存在，那么做得很好。

**根据评论编辑**

我认为这里有两条标准来确定何时/保存什么。

第一个是相当主观的——你想保存数据吗？确实没有什么可以强迫您保存状态或数据。保存这些信息会带来更好的用户体验吗？如果您正在编写电子邮件并尝试从另一个应用程序复制/粘贴文本，那么每次应用程序关闭时丢失您输入一半的电子邮件会令人沮丧。

第二部分，确定要保存的内容取决于您是否可以根据您拥有的数据重建您的 UI 状态。例如，如果您保存了文本数据，那么这一定意味着用户正在编辑文本。所以现在我们知道切换到编辑文本选项卡并填写保存的文本。

一般来说，如果您希望将用户返回到他们离开的地方，那么您需要考虑返回该点所需的状态数据。想象一下您的应用程序的原始加载版本

*   需要更改哪些数据才能将其变为用户看到的最后状态？
*   您需要存储哪些数据才能返回这里？

这确实是 android 的工作方式，您的活动被销毁并重新创建，您的工作是再次启动这些部分（如果您选择这样做）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-08T23:38:10.870

这是答案。您可以通过三种不同的方式保存状态。

1）子类化应用程序（不是一个好主意）。2）SharedPreferences（适用于简单数据，快速可靠） 3）SQLite 数据库（更复杂，也更可靠）。

现在回答你的问题。android真的没有保证。在任何时候，它都可以并且可能在不调用任何特定函数的情况下破坏您的应用程序。因此，如果有重要的数据需要保存，答案是一**拿到就保存**。如果您知道需要立即保存某些东西，那么稍后保存通常没有太大的优势。

onSaveInstanceState() 仅用于保存与布局或方向更改相关的临时变量。

总之，**持久状态/数据**（应该在崩溃中幸存），应该尽快保存**，**不要等待`onPause()`，因为没有保证。这就是现实。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T18:35:09.813

我的案例是一个游戏，我想将持久性数据保存到游戏服务器。

由于这可能需要一段时间，我发现尝试保存在 中并不是一件好事`onPause`，而是在`onStop`.

根据我所做的测试，`onStop`似乎能够在后台运行 while`onPause`块，至少当我按下 home 时就是这种情况（使用简单的 for`1`循环`10m`和`onPause`测试`onStop`）。谁能证实这个阻塞理论？

`onStop`需要`Honeycomb`（`api11+`），因为在那个版本之前你可以在`onClose`被调用之前被杀死。

请参阅[此处](http://developer.android.com/reference/android/app/Activity.html)并`killable`在表格中查找 - 如果现实与文档匹配是另一个问题:)。

# tridion - Content Porter SP1 在导入内容时抛出错误

> ID：11874630
> 
> 赞同：2
> 
> 时间：2012-08-08T23:20:46.797
> 
> 标签：tridion

您好 Tridion 专家，

我在使用 Content Porter SP1 导入内容时遇到了许多问题。

1.  使用所有关键字导入所有类别失败
2.  复制的组件导入失败
3.  导入结构组失败

这是错误详细信息

```
8/8/2012 10:13:25 PM    [Information]   Resolving item mappings
8/8/2012 10:13:25 PM    [Information]   Mappings resolving started
8/8/2012 10:13:25 PM    [Information]   Mappings resolving finished
8/8/2012 10:13:25 PM    [Information]   Discovering potential problems
8/8/2012 10:13:25 PM    [Information]   Problems discovery started
8/8/2012 10:13:26 PM    [Information]   Problems discovery finished
8/8/2012 10:13:26 PM    [Information]   Import started
8/8/2012 10:13:26 PM    [Information]   Importing System Administration items
8/8/2012 10:13:26 PM    [Information]   Importing items into '040 XXX XXXXX Website' Publication
8/8/2012 10:13:26 PM    [Information]   Importing items into '040 XXX XXXXX Website' Publication started at 18:13:26
8/8/2012 10:13:27 PM    [Error] <?xml version="1.0" standalone="yes"?>
<tcm:Error ErrorCode="80040200" Category="4" Source="Kernel" Severity="2" xmlns:tcm="http://www.tridion.com/ContentManager/5.0"><tcm:Line ErrorCode="80040200" Cause="false" MessageID="16137"><![CDATA[Unable to save Publication (tcm:0-0-0).]]><tcm:Token>RESID_4574</tcm:Token><tcm:Token>RESID_4452</tcm:Token><tcm:Token>tcm:0-0-0</tcm:Token></tcm:Line><tcm:Line ErrorCode="80040200" Cause="true" MessageID="15748"><![CDATA[Unable to map all paths to URIs.]]></tcm:Line><tcm:Details><tcm:CallStack><tcm:Location>Tridion.ContentManager.UrlConversion.Convert()</tcm:Location><tcm:Location>Tridion.ContentManager.IdentifiableObject.Save(SaveEventArgs)</tcm:Location><tcm:Location>Tridion.ContentManager.IdentifiableObject.Save()</tcm:Location><tcm:Location>Tridion.ContentManager.BLFacade.IdentifiableObjectFacade.Create(UserContext,String)</tcm:Location><tcm:Location>XMLState.Save</tcm:Location><tcm:Location>Publication.Save</tcm:Location><tcm:Location>Request.SaveItem</tcm:Location><tcm:Location>XMLResponder.Request</tcm:Location></tcm:CallStack></tcm:Details></tcm:Error>

8/8/2012 10:13:27 PM    [Information]   Import failed
=======
Start time: 2012-08-08 18:13:26
End time: 2012-08-08 18:13:27

All changes made during import process were rolled back
8/8/2012 10:13:27 PM    [Error] Transactional import failed. No changes will be commited.
8/8/2012 10:13:27 PM    [Information]   Import completed 
```

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T08:14:33.160

您提到您遇到了许多问题，但您提供的错误消息实际上似乎只报告了一个故障（这将阻止所有进一步的操作确实发生）。

您得到的错误是`Unable to save Publication`标准的 WebDAV 解释`Unable to map all paths to URIs.`。

因此，Quirijn 关于**040 XXX XXXXX 网站**出版物是否真的存在的评论似乎确实相关。但是，它是否存在并不重要，只要正在导入它的用户在系统中有足够的权限来创建项目（特别是出版物）。

所以我会检查以下内容：

1.  您是否使用 Tridion 管理员帐户通过 Content Porter 导入？
2.  登录 UI 后，是否可以手动创建 Publication **040 XXX XXXXX 网站？**
3.  如果您能够完成 #2，那么之后导入是否有效？

如果您可以在 #2 之后导入，那么我的猜测是您没有在 Content Porter 中导出出版物本身，但我的第一个想法是您尝试与没有足够权限创建出版物或任何项目的用户一起导入在里面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-09T12:26:34.503

谢谢你的回答，但不知何故，这不是问题。解决方法是我未能 100% 安装根发布。这就是我面临类别和关键字问题的原因。是的，在我们导入时无需手动执行任何操作……这会以某种方式破坏蓝图。

为了解决这个问题，我需要清除所有出版物，并且需要导入具有 100% tridion 工件的根出版物。

谢谢，海伦

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-03T15:06:24.073

我知道您已经解决了这个问题，但我遇到了同样的错误，并想根据我的解决方法提供更多信息。就我而言，我正在导入一个继承自我之前使用 Content Porter 导入的出版物的出版物。正如您在解决方案 Hiren 中提到的那样，我的问题是在以前的出版物中，特别是在要继承的出版物中缺少“根”结构组。由于没有根结构组就无法继承出版物，这阻止了我在导入期间创建新出版物。一旦我在我的父出版物中创建了一个根结构组，导入就会顺利进行。

# php - 如何将值添加到关联数组中？

> ID：11874634
> 
> 赞同：-1
> 
> 时间：2012-08-08T23:20:52.907
> 
> 标签：php, arrays

如果我想在 while 循环中向数组添加值，我可以这样做`$arr[] = "some"`。但是如果我有一个关联数组，我该怎么做，例如：

```
while($result = $result->fetch_array(MYSQLI_ASSOC))
{
   $arr[]["some_key"] = "some";
   $arr[]["other_key"] = "some2";
} 
```

但这会给我类似的东西`Array ( [0] => Array ( [some_key] => some) [1] => Array ( [other_key] => some2)`。那么将值添加到循环内的关联数组中的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:23:08.723

为您的键创建一个临时数组，然后将该临时数组推送到主数组：

```
$arr = [];
loop(condition) {
    $tmp = [];
    $tmp['some_key'] = 'some value';
    $tmp['other_key'] = 'other value';
    $arr[] = $tmp;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:35:37.313

这不会覆盖您的值：

```
$arr = array();
while($result = $result->fetch_array(MYSQLI_ASSOC))
{
    $tmp = array();
    foreach($result as $key=>$value)
    {        
       $tmp[$key] = $value;  
    }
    $arr[]=$tmp;
} 
```

或者更简洁地说：

```
$arr = array();
while($result = $result->fetch_array(MYSQLI_ASSOC))
{
    $arr[]=$result;
} 
```

由于 PHP 默认是复制而不是引用。

如果您想将它们存储为 assoc. 你可以这样做的数组数组：

```
$arr = array();
while($result = $result->fetch_array(MYSQLI_ASSOC))
{
    foreach($result as $key=>$value)
    {        
       if(!isset($arr[$key])){
         $arr[$key] = array();
       }
       $arr[$key][] = $value;  
    }
} 
```

# java - Java won't print inside a for loop

> ID：11874637
> 
> 赞同：2
> 
> 时间：2012-08-08T23:21:17.633
> 
> 标签：java, for-loop

I've been toying around with Java recently and I've encountered a problem:

Whenever I put `System.out.println()` or `System.out.print()` inside a for loop, there is no output on the console.

For example:

```
package experimental;

public class Main {
    public static void main(String args[]) {
        recur();
    }

    public static void recur() {
        for(int x = 0; x == 10; x++) {
            for(int y = 0; y == 10; y++) {
                System.out.print(x + "-" + y + " ");
            }
        }
    }
} 
```

Outputs:

```
*crickets* 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T23:23:07.823

The loop condition isn't `true` to even begin with... `x == 10` is not `true` when `x = 0`. Had it been, you would've also noticed the *second* loop condition is also not `true` to begin with; similarly , `y == 10` is not true as `y = 0`. You probably confused the condition with one for **stopping**.

```
for(int x = 0; x == 10; x++) {
     for(int y = 0; y == 10; y++) { 
```

Change to the following if you want `x`, `y` to vary from [0, 10):

```
for(int x = 0; x < 10; x++) {
    for(int y = 0; y < 10; y++) { 
```

... or the following for [0, 10]:

```
for(int x = 0; x <= 10; x++) {
    for(int y = 0; y <= 10; y++) { 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-08T23:23:42.737

Your problem is with the condition in your for loop. It says:

> start with x = 0 and loop while x is 10

That is not true so the loop exits immediately.

You need to replace it with:

```
for (int x = 0; x < 10; x++) 
```

(assuming you want to loop 10 times)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T23:23:17.217

Those `for` loops will never loop.

They'll only loop so long as the *termination condition* is **true**. As termination conditions you have: `x == 10`, `y == 10`. Since you initialize `x`, `y` to `0`, these conditions are never true, and the loops are a no-op.

I think you want, e.g.: `for (int x = 0; x < 10; x++)`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-08T23:23:22.343

```
for(int x = 0; x == 10; x++) {
    for(int y = 0; y == 10; y++) {
        System.out.print(x + "-" + y + " ");
    }
} 
```

The `x == 10` condition will fail, the loop will break, crickets. Same with the other loop condition.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-08T23:27:20.437

Your code never gets to the body of the for loop because the condition `x==10` is already false before it starts the loop. I think you should be writing `x != 10` instead. Same goes for the inner loop.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-08T23:33:18.700

Since everyone has already answered your question, I would like to add some debugging tips. First of all, I suggest using an IDE such as NetBeans or Eclipse. The debuggers in both of these will allow you to step through your code line by line to see how it executes. In doing so, you would have quickly noticed that your for loops are skipped completely. If you are unable or unwilling to do this. Then the next best thing is to add SOP's (`System.out.println()`) in your code. Even if it's just a simple message such as `"Here"` to tell you where you are in the code, this additional output can help you track down errors in logic.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-08-10T10:49:57.893

You can't use `x == 10`. The comparison needs to express this way:

```
for(int x = 0; x <= 10; x++) {
   for(int y = 0; y <= 10; y++) {
     System.out.print(x + "-" + y + " ");
   }
} 
```

# asp.net-mvc - 带有 ChangeTracker 的 EF 存储库模式

> ID：11874638
> 
> 赞同：0
> 
> 时间：2012-08-08T23:21:18.553
> 
> 标签：asp.net-mvc, entity-framework, interface, repository-pattern

我想在我的 ASP.NET MVC + EF 4.3 项目中实现存储库模式。

现在我的`DBContext`班级有一个覆盖`SaveChanges`接收“userid”参数以便进行审计跟踪。

例子：

```
 // This is overridden to prevent someone from calling SaveChanges without specifying the user making the change
public override int SaveChanges()
{
    throw new InvalidOperationException("User ID must be provided");
}

public int SaveChanges(int userId)
{
    // Get all Added/Deleted/Modified entities (not Unmodified or Detached)
    foreach (var ent in this.ChangeTracker.Entries().Where(p => p.State ==      System.Data.EntityState.Added || p.State == System.Data.EntityState.Deleted || p.State == System.Data.EntityState.Modified))
{
                    // For each changed record, get the audit record entries and add them
                    foreach (AuditLog x in GetAuditRecordsForChange(ent, userId))
                    {
                        this.AuditLogs.Add(x);
                    }
                }

                // Call the original SaveChanges(), which will save both the changes made and the audit records
                return base.SaveChanges();
            } 
```

现在，我的`RepositoryBase`班级有这样的事情：

```
 public class RepositoryBase<C> : IDisposable
        where C : DbContext, new()
    {
        private C _DataContext;

        public virtual C DataContext
        {
            get
            {
                if (_DataContext == null)
                {
                    _DataContext = new C();
                    this.AllowSerialization = true;
                    //Disable ProxyCreationDisabled to prevent the "In order to serialize the parameter, add the type to the known types collection for the operation using ServiceKnownTypeAttribute" error
                }
                return _DataContext;
            }
        } 
```

我的问题是如何`SaveChanges(int)`在课堂上公开该方法`RepositoryBase`？

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:00:14.713

您将需要在通用定义中使用实际的 DbContext 而不是 DbContext 基类。然后你就可以调用你的覆盖函数

```
 public class RepositoryBase<C> : IDisposable
        where C : YourContextClassGoesHere, new()

{
    private C _dataContext;

    public void SaveChanges()
    {
        int userId = GetUserId();
       _dataContext.SaveChanges(userId);
    }
} 
```

# awk - awk：打印未确定的列数

> ID：11874639
> 
> 赞同：7
> 
> 时间：2012-08-08T23:21:18.633
> 
> 标签：awk

我有一个文件，其中包含许多由制表符分隔的字段。我正在尝试打印除第一列之外的所有列，但想用 AWK将它们全部打印在*一个列中。*文件的格式是

```
col 1   col 2   ... col n 
```

一行中至少有 2 列。

**样本**

```
2012029754      901749095
2012028240      901744459       258789
2012024782      901735922
2012026032      901738573       257784
2012027260      901742004
2003062290      901738925       257813  257822
2012026806      901741040
2012024252      901733947       257493
2012024365      901733700
2012030848      901751693       260720  260956  264843  264844 
```

因此，我想告诉 awk 将第 2 列打印到第 n 列，当 n 大于 2 时，当该行的第 n 列中没有信息时，不打印空行，所有信息都在一个列中，如下所示。

```
901749095
901744459
258789
901735922
901738573
257784
901742004
901738925
257813
257822
901741040
901733947
257493
901733700
901751693
260720
260956
264843
264844 
```

这是我第一次使用 awk，所以请多多包涵。我从命令行编写了这个，它有效：

```
awk '{i=2; 
while ($i ~ /[0-9]+/)
{ 
    printf "%s\n", $i
    i++
}
}' bth.data 
```

这更像是寻求批准，而不是询问在 AWK 中这样做是否是正确的方法，或者是否有更好/更短的方法。

请注意，实际的输入文件可能有数百万行。

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-08T23:28:12.960

这是你想要的输出吗？

```
awk '{for(i=2; i<=NF; i++) print $i}' bth.data 
```

给

```
901749095
901744459
258789
901735922
901738573
257784
901742004
901738925
257813
257822
901741040
901733947
257493
901733700
901751693
260720
260956
264843
264844 
```

`NF`是几个[预定义的 awk 变量](http://www.freeos.com/guides/lsst/ch07sec02.html)之一。它指示给定输入行上的字段数。例如，如果您想始终打印出一行中的最后一个字段，它会很有用`print $NF`。或者当然，如果您想遍历给定行上的全部或部分字段到行尾。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-10T19:21:21.610

似乎`awk`是错误的工具。我会做：

```
cut -f 2- < bth.data | tr -s '\t' '\n' 
```

请注意，使用`-s`，这可以避免打印原始问题中所述的空白行。

# c++ - 未调用模板化构造函数的专用模板

> ID：11874645
> 
> 赞同：3
> 
> 时间：2012-08-08T23:22:46.217
> 
> 标签：c++, c++11

我试图模仿可继承构造函数的行为，因为它们尚未在 g++ 中实现。

我尝试了这里描述的技术[https://stackoverflow.com/a/5411992/234261](https://stackoverflow.com/a/5411992/234261)但是当我想添加自己的构造函数时遇到了问题。具体来说，我正在尝试添加一个专门的复制构造函数，以及继承所有其他构造函数。不幸的是，总是调用继承的、更通用的复制构造函数。

## 一个例子

```
#include <iostream>
struct A {
  A(){}
  A(const A &){ std::cout << "IN A" << std::endl; }
};

struct B : public A{
  template<typename ...Args,
           typename = typename std::enable_if
      <
             std::is_constructible<A, Args...>::value
             >::type>
  B(Args &&...args)
    : A(std::forward<Args>(args)...) {}

  // These don't work either.                                                                                                                
  //B(const A &a):A(a){ std::cout << "IN B-A" << std::endl; }                                                                                
  //B(const B &b):A(b){ std::cout << "IN B-B" << std::endl; }                                                                                
};
template<>
B::B(const A &a):A(a){ std::cout << "IN B-A" << std::endl; }
template<>
B::B(const B &b):A(b){ std::cout << "IN B-B" << std::endl; }

int main(){
  A a;      // 1\. Prints nothing as expected                                                                                                    
  B b(a);   // 2\. Prints "IN A" only                                                                                                              
  B b1(b);  // 3\. Prints "IN A" only                                                                                                              
  return 0;
} 
```

我想 [3] 打印**IN A**然后**IN BB**。不知何故，我设法让 [2] 在我的实际代码中工作，但由于某种原因不能在这个小例子中重复它。

我知道由于子类（B）实际上可以用于构造超类（A），因此正在创建模板构造函数。

但是，为什么我的显式特化没有被调用？我是不是专业不正确？有没有更好的办法？

* * *

如果有人想运行它，请链接到此示例[http://ideone.com/eUHD5](http://ideone.com/eUHD5)

我正在使用 gcc 4.6

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:38:52.553

以下“作品”：

```
struct B : public A
{
    template<typename ...Args, typename = typename std::enable_if<std::is_constructible<A, Args...>::value>::type>
    B(Args &&...args) : A(std::forward<Args>(args)...) {}

    B(const A & a) : A(a){ std::cout << "IN B-A" << std::endl; }
    B(const B & b) : A(b){ std::cout << "IN B-B" << std::endl; }
};

int main()
{
    A a;
    B b(a);
    B b1(static_cast<B const &>(b)); 
} 
```

这是旧的模板重载是更好的匹配栗子。请参阅[STL 的第 3 课](http://channel9.msdn.com/Series/C9-Lectures-Stephan-T-Lavavej-Core-C-/Stephan-T-Lavavej-Core-Cpp-3-of-n)以获得深入的解释。基本上，绑定`b`到推导模板参数的引用`Args... = { B }`与身份完全匹配，而将其绑定到`B const &`需要限定符转换，这是身份转换的严格超集。

通过显式转换为 const-reference，模板构造函数和非模板构造函数现在都完美匹配，但作为非模板是决胜局。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T23:46:01.803

这无需将事物转换为 const 即可工作：

```
#include <iostream>
struct A {
  A(){}
  A(const A &){ std::cout << "IN A" << std::endl; }
};

struct B : public A{
  B() = default;

  template<typename A0, typename ...Args,
           typename = typename std::enable_if
      <
             !std::is_same<typename std::decay<A0>::type, A>::value &&
             !std::is_same<typename std::decay<A0>::type, B>::value &&
             std::is_constructible<A, A0, Args...>::value
             >::type>
  B(A0&& a0, Args &&...args)
    : A(std::forward<A0>(a0), std::forward<Args>(args)...) {}

  B(const A &a):A(a){ std::cout << "IN B-A" << std::endl; }                                                                                
  B(const B &b):A(b){ std::cout << "IN B-B" << std::endl; }                                                                                
};

int main(){
  A a;      // 1\. Prints nothing as expected                                                                                                    
  B b(a);   // 2\. Prints "IN A" only                                                                                                              
  B b1(b);  // 3\. Prints "IN A" only                                                                                                              
  return 0;
} 
```

虽然对作者来说更麻烦，但对客户来说更干净。

# gwt - 向面板添加点击处理程序？

> ID：11874650
> 
> 赞同：2
> 
> 时间：2012-08-08T23:22:59.127
> 
> 标签：gwt

我们有接口：

```
AbsolutePanel ap = ...;
ap.addHandler(EventHandler h, Type<EventHandler> type); 
```

我们如何使用上述内容？似乎 GWT 中点击事件的界面已经改变了几次，关于这个主题的旧问题已经过时了，

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:29:25.003

这应该有效：

```
 AbsolutePanel ap = new AbsolutePanel();
    ap.addHandler(new ClickHandler() {
        @Override
        public void onClick(ClickEvent event) {
            // TODO Auto-generated method stub

        }
    }, ClickEvent.getType()); 
```

# php - Google 通讯录 API 名称和电子邮件

> ID：11874657
> 
> 赞同：4
> 
> 时间：2012-08-08T23:23:18.027
> 
> 标签：php, google-contacts-api

这是我在这个网站上的第一篇文章，如果我把它杀了，请原谅我，但我会尽量保持清晰和直截了当。

我正在尝试使用 Google Contacts API 从经过身份验证的用户 gmail 帐户导入姓名和电子邮件地址。我使用 Google 本身提供的通用代码获得了电子邮件地址。我试图修改它以获取联系人姓名，但无济于事。任何帮助将不胜感激。下面是我目前正在使用的代码。

```
$xml =  new SimpleXMLElement($val->getResponseBody());

$xml->registerXPathNamespace('gd', 'http://schemas.google.com/g/2005');
$result = $xml->xpath('//gd:email');

$name_result = $xml->xpath('//title');

foreach ($result as $title) {
    echo "<div>".$title->attributes()->address."</div>";
}

foreach ($name_result as $name) {
        echo "<div class='contact_alt'>".$name."</div>";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-14T14:29:29.027

好的，所以我设法在本网站的其他地方找到了答案。并不是要发布带有此处已经存在的答案的问题。我确实确实尝试过先环顾四周，所以我没有这样做。

[PHP GMAIL 联系人 XML 解析与 DOMDocument 和 cURL](https://stackoverflow.com/questions/6530050/php-gmail-contacts-xml-parsing-with-domdocument-and-curl)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-09T15:42:18.520

我使用的另一种解决方案是要求 Google API 使用 JSON 而不是 XML 进行回复。使用 gd: 命名空间解析 XML 变得很棘手。JSON 带有联系人姓名和电子邮件，这成为使用`json_decode()`.

```
$url = 'https://www.google.com/m8/feeds/contacts/%s/full'
$url .= '&access_token=%s'
$url .= &alt=json; 
```

只需添加`&alt=json`到请求 URL。

# batch-file - 批处理：将 %'s 添加到值以声明另一个变量

> ID：11874660
> 
> 赞同：0
> 
> 时间：2012-08-08T23:23:34.590
> 
> 标签：batch-file

我有一个名为“ **VAR.bat** ”的文件来设置变量：

```
SET VARa=C:\Program Files
SET VARb=C:\Program Files (x86)
set VARc=C:\ProgramData 
```

我有一个名为“ **SET.set** ”的文件，其中仅包含变量名：

```
VARa
VARb
VARc 
```

我想从这样的例程中调用集合：

```
 for /f "tokens=* delims= " %%a in ('type "SET.set"') do (
    SET CONSA=%%~a
    SET CONSN=%%^%%a%%
    CALL :CREATEVAR
    )
    :CREATEVAR
    if exist "%CONSN%" CALL :%CONSA%_detect
    exit /b

:VARa_detect
echo "%CONSN%"
exit /b

:VARb_detect
echo "%CONSN%"
exit /b

:VARc_detect
echo "%CONSN%"
exit /b 
```

使用**^**转义并向值添加**%**不起作用，因为命令处理器将值解释为“ **%VARa%** ”而不是“ **C:\Program Files** ”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T09:19:23.247

您可以在此处使用延迟扩展。

```
setlocal EnableDelayedExpansion
for /f "tokens=* delims= " %%a in ('type "SET.set"') do (
    SET CONSA=%%~a
    SET CONSN=!%%~a!
    CALL :CREATEVAR
) 
```

或者在同一行，您可以使用额外的 expaqnsion`CALL`

```
...
call set CONSN=%%%%~a%% 
```

# mysql - 从选择语句mysql创建表的问题

> ID：11874662
> 
> 赞同：-1
> 
> 时间：2012-08-08T23:23:50.217
> 
> 标签：mysql

我正在尝试`MySQL`从`SELECT`声明中创建一个新的：

```
 CREATE TABLE site_database AS(SELECT database_id, name, description, site_id FROM sitematrix_databases INNER JOIN site
    matrix_site_databases ON sitematrix_site_databases.database_id = sitematrix_data
    bases.database_id); 
```

当我执行`SELECT`语句时，我得到：

```
+-------------+--------+-------------+-------------+---------+
| database_id | name   | description | database_id | site_id |
+-------------+--------+-------------+-------------+---------+
|           5 | tc2007 |             |           5 |       1 |
|           5 | tc2007 |             |           5 |       8 |
|           5 | tc2007 |             |           5 |       9 |
|           5 | tc2007 |             |           5 |      12 |
|           5 | tc2007 |             |           5 |      14 |
+-------------+--------+-------------+-------------+---------+ 
```

但是，当我尝试创建表时，我得到：

```
ERROR 1052 (23000): Column 'database_id' in field list is ambiguous 
```

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:27:00.023

在您的选择语句中，确保您指定数据库 id 来自哪个表：

```
CREATE TABLE site_database AS(SELECT sitematrix_site_databases.database_id, name, description, site_id FROM sitematrix_databases INNER JOIN site
    matrix_site_databases ON sitematrix_site_databases.database_id = sitematrix_data
    bases.database_id); 
```

会工作，当多个表具有相同的字段名称时，mysql 需要这个。

您可以将其简化为：

```
CREATE TABLE site_database AS(SELECT ssd.database_id, name, description, site_id 
FROM sitematrix_databases as sd 
INNER JOIN sitematrix_site_databases as ssd 
ON ssd.database_id = sd.database_id) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:26:08.707

尝试将查询更改为：

```
CREATE TABLE site_database AS(SELECT sitematrix_site_databases.database_id, name, description, site_id FROM sitematrix_databases  INNER JOIN site 
    matrix_site_databases ON sitematrix_site_databases.database_id = sitematrix_data
    bases.database_id); 
```

由于字段 database_id 出现在两个表`sitematrix_databases`中：因此`site`存在歧义

# struct - CUDA：在结构内分配结构数组

> ID：11874667
> 
> 赞同：4
> 
> 时间：2012-08-08T23:24:06.367
> 
> 标签：struct, cuda, deep-linking

我有这些结构：

```
typedef struct neuron
{
float*  weights;
int n_weights;
}Neuron;

typedef struct neurallayer
{
Neuron *neurons;
int    n_neurons;
int    act_function;
}NLayer; 
```

“NLayer”结构可以包含任意数量的“神经元”

我试图以这种方式从主机分配一个带有 5 个“神经元”的“NLayer”结构：

```
NLayer* nL;
int i;
int tmp=9;
cudaMalloc((void**)&nL,sizeof(NLayer));
cudaMalloc((void**)&nL->neurons,6*sizeof(Neuron));
for(i=0;i<5;i++)
    cudaMemcpy(&nL->neurons[i].n_weights,&tmp,sizeof(int),cudaMemcpyHostToDevice); 
```

...然后我尝试使用该内核修改“nL->neurons[0].n_weights”变量：

```
__global__ void test(NLayer* n)
           {
              n->neurons[0].n_weights=121;
           } 
```

但在编译时 nvcc 返回与内核唯一行相关的“警告”：

```
Warning: Cannot tell what pointer points to, assuming global memory space 
```

当内核完成其工作时，结构开始无法访问。

很可能是我在分配过程中做错了什么......有人可以帮助我吗？非常感谢，对不起我的英语！:)

**更新：**

感谢 aland，我修改了创建此函数的代码，该函数应分配结构“NLayer”的实例：

```
NLayer* setNLayer(int numNeurons,int weightsPerNeuron,int act_fun)
{
    int i;
    NLayer  h_layer;
    NLayer* d_layer;
    float*  d_weights;

    //SET THE LAYER VARIABLE OF THE HOST NLAYER
    h_layer.act_function=act_fun;
    h_layer.n_neurons=numNeurons;
    //ALLOCATING THE DEVICE NLAYER
    if(cudaMalloc((void**)&d_layer,sizeof(NLayer))!=cudaSuccess)
        puts("ERROR: Unable to allocate the Layer");
    //ALLOCATING THE NEURONS ON THE DEVICE
    if(cudaMalloc((void**)&h_layer.neurons,numNeurons*sizeof(Neuron))!=cudaSuccess)
        puts("ERROR: Unable to allocate the Neurons of the Layer");
    //COPING THE HOST NLAYER ON THE DEVICE
    if(cudaMemcpy(d_layer,&h_layer,sizeof(NLayer),cudaMemcpyHostToDevice)!=cudaSuccess)
                puts("ERROR: Unable to copy the data layer onto the device");

    for(i=0;i<numNeurons;i++)
    {
        //ALLOCATING THE WEIGHTS' ARRAY ON THE DEVICE
        cudaMalloc((void**)&d_weights,weightsPerNeuron*sizeof(float));
        //COPING ITS POINTER AS PART OF THE i-TH NEURONS STRUCT
        if(cudaMemcpy(&d_layer->neurons[i].weights,&d_weights,sizeof(float*),cudaMemcpyHostToDevice)!=cudaSuccess)
                puts("Error: unable to copy weights' pointer to the device");
    }

    //RETURN THE DEVICE POINTER
    return d_layer;
} 
```

我以这种方式从主函数调用该函数（内核“测试”之前已声明）：

```
int main()
{
    NLayer* nL;
    int h_tmp1;
    float h_tmp2;

    nL=setNLayer(10,12,13);
    test<<<1,1>>>(nL);
    if(cudaMemcpy(&h_tmp1,&nL->neurons[0].n_weights,sizeof(float),cudaMemcpyDeviceToHost)!=cudaSuccess);
        puts("ERROR!!");
    printf("RESULT:%d",h_tmp1);

} 
```

当我编译该代码时，编译器会向我显示警告，当我执行程序时，它会在屏幕上打印：

```
Error: unable to copy weights' pointer to the device
Error: unable to copy weights' pointer to the device
Error: unable to copy weights' pointer to the device
Error: unable to copy weights' pointer to the device
Error: unable to copy weights' pointer to the device
Error: unable to copy weights' pointer to the device
Error: unable to copy weights' pointer to the device
Error: unable to copy weights' pointer to the device
Error: unable to copy weights' pointer to the device
Error: unable to copy weights' pointer to the device
ERROR!!
RESULT:1 
```

如果我评论内核调用，最后一个错误不会比较。

我哪里错了？我不知道怎么办 谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-09T01:23:59.900

问题在这里：

```
cudaMalloc((void**)&nL,sizeof(NLayer));
cudaMalloc((void**)&nL->neurons,6*sizeof(Neuron)); 
```

在第一行中，`nL`指向设备上全局内存中的结构。因此，在第二行中，第一个参数`cudaMalloc`是驻留在 GPU 上的地址，这是未定义的行为（在我的测试系统上，它会导致段错误；但在你的情况下，还有一些更微妙的东西）。

做你想做的事情的正确方法是首先在主机内存中创建结构，用数据填充它，然后将其复制到设备，如下所示：

```
NLayer* nL;
NLayer h_nL;
int i;
int tmp=9;
// Allocate data on device
cudaMalloc((void**)&nL, sizeof(NLayer));
cudaMalloc((void**)&h_nL.neurons, 6*sizeof(Neuron));
// Copy nlayer with pointers to device
cudaMemcpy(nL, &h_nL, sizeof(NLayer), cudaMemcpyHostToDevice); 
```

此外，不要忘记始终检查 CUDA 例程中的任何错误。

**更新**

在您的代码的第二个版本中：

`cudaMemcpy(&d_layer->neurons[i].weights,&d_weights,...)`--- 再次，您正在取消引用主机上的设备指针 ( `d_layer`)。相反，您应该使用

```
cudaMemcpy(&h_layer.neurons[i].weights,&d_weights,sizeof(float*),cudaMemcpyHostToDevice 
```

这里你取`h_layer`（主机结构），读取它的元素（`h_layer.neurons`），它是指向设备内存的指针。然后你对它做一些指针算术（`&h_layer.neurons[i].weights`）。计算该地址不需要访问设备内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T01:13:28.057

这完全取决于您使用的 GPU 卡。Fermi 卡使用共享和全局内存空间的统一寻址，而 pre-Fermi 卡没有。

对于 pre-Fermi 案例，您不知道地址应该是共享的还是全局的。编译器通常可以解决这个问题，但在某些情况下它不能。当需要指向共享内存的指针时，您通常获取共享变量的地址，编译器可以识别它。当没有明确定义时，将出现“假设全局”消息。

如果您使用的 GPU 具有 2.x 或更高的计算能力，它应该与 -arch=sm_20 编译器标志一起使用

# python - 在 Python 中以独特的方式组合两个列表

> ID：11874669
> 
> 赞同：7
> 
> 时间：2012-08-08T23:24:13.460
> 
> 标签：python, list

我正在研究 Project Euler 问题 5，并且正在使用以下内容：

```
def findLCM(k):
start=time.time()
primes=[2,3,5,7,11,13,17,19,23]
factors=[]
for factor in range(2,k):
    if factor in primes:
        factors.append(factor)
    else:
        factorization=[]
        while factor!=1:
            for prime in primes:
                lastFactor=prime
                if factor%prime==0:
                    factor/=prime
                    factorization.append(lastFactor)
                    break
        tmpFactors=[]
        for tmpFactor in factorization:
            if tmpFactor not in factors:
                factors.append(tmpFactor)
            else:
                tmpFactors.append(tmpFactor)
                factors.remove(tmpFactor)
        for tmpFactor in tmpFactors:
            factors.append(tmpFactor)
        print factors
product=1
for factor in factors:
    product*=factor
factors.sort()
end=time.time()
fnTime=end-start
return product, fnTime, factors 
```

是否有一个 Python 函数，我可以将分解和像这个函数一样的因子结合起来？例如，如果`factors=[2, 3, 5]`和`factorization=[2, 2, 3]`，组合列表应该是`[2, 2, 3, 5]`。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-08T23:42:38.497

术语是“多集的并[集](http://en.wikipedia.org/wiki/Multiset)”。

它是在 Python 中使用*[collections.Counter](http://docs.python.org/library/collections.html#counter-objects)*实现的：

```
>>> from collections import Counter
>>> combined = Counter([2, 3, 5]) | Counter([2, 2, 3])
>>> list(combined.elements())
[2, 2, 3, 5] 
```

# node.js - 回调函数的变量范围

> ID：11874670
> 
> 赞同：0
> 
> 时间：2012-08-08T23:24:40.797
> 
> 标签：node.js, scope

我正在使用 TLS 模块在 node.js 中制作一个简单的服务器。到目前为止一切顺利，客户端能够连接、发送数据和断开与服务器的连接。但是，我想在与服务器断开连接时打印客户端的 IP 地址。就目前而言，我可以从事件回调函数之外打印客户端的 IP 地址，但我不能在回调函数中这样做（检查`on('end)`）。

```
var tls = require('tls');
var fs = require('fs');

var server = tls.createServer({
    key: fs.readFileSync('server-key.pem'),
    cert: fs.readFileSync('server-cert.pem'),
}, function(cleartextStream) {
    cleartextStream.setEncoding('utf8');

    /*
     * Error receiving data.
     */
    cleartextStream.on('error', function (exception) {

    });

    /*
     * Signal that it is safe to write again.
     */
    cleartextStream.on('drain', function () {

    });

    /*
     * New data received.
     */
    cleartextStream.on('data', function (data) {
        console.log('New data: '+data);
    });

    /*
     * Remote client disconnected.
     */
    console.log(cleartextStream.remoteAddress); // This prints the IP address correctly.

    cleartextStream.on('end', function () {
        console.log(cleartextStream.remoteAddress); // This prints undefined.
    });

    /*
     * Server is shutting down.
     */
    cleartextStream.on('close', function () {

    });
});

server.listen(8000, function() {
  console.log('Server listening.');
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T00:43:44.043

看起来在事件触发之前删除了 的`remoteAddress`属性。所以捕获远程地址，以便它在您的事件回调中仍然可用：`cleartextStream``'end'``'end'`

```
var remoteAddress = cleartextStream.remoteAddress;
cleartextStream.on('end', function () {
    console.log(remoteAddress);
}); 
```

# javascript - 如何处理访问 javascript 中的数据结构的两个回调？

> ID：11874674
> 
> 赞同：1
> 
> 时间：2012-08-08T23:25:03.527
> 
> 标签：javascript, concurrency, callback, firebase

**更新2：** *我认为这是一个更好的解释：*

我有两个回调，每个都在填充一个数组。我想以某种方式合并这些数组。天真的方法是等到数组被填满，然后与 for 循环合并。我不能这样做，因为没有真正的方法来检查回调是否“完成”。

下一步可能是这样的：每次回调下载对象时，它都会检查合并数组（称为混合），并查看它是否包含“伙伴”对象。如果是：则合并到该伙伴对象中。如果没有，则插入该对象。

我担心竞争条件：回调 1 看到数组为空，决定插入其中，但随后控制切换到回调 2，它首先插入。回调 1 现在应该合并而不是插入，但是当控制切换回来时，它会插入。

如果我可以制作一个原子的“检查和插入/合并”代码块，那么可能会有所帮助。有没有办法做到这一点？

* * *

**更新 1：** 现在有代码，还有更多文字！

谢谢大家的回复。我去尝试尽可能地简化代码。

**字：**

我有一个名为混合的数组。Mixed 应该以：所有类型 (A) 的对象结束，并且如果它们具有类型 (B) 的模拟对象（也称为“私有”），则它们应该被合并。

这意味着使用两个使用回调的函数 - getAllA 和 getAllB。现在，我同时调用两者，手动稍等片刻，然后运行一个 for 循环来进行合并。

我需要做的是编辑我的代码，以便合并发生在回调中。但是，我想不出一种不产生竞争条件的方式来进行合并。

天真地，我可能想先用 A 类型的对象填充混合，然后遍历 B 对象并根据需要合并它们。但是，我不能这样做，因为无法查看您是否在 firebase 中使用 on("contact_added") 完成了操作。我想我想要的是一个并发数组结构，但我不知道如何使用内置的。我担心自己做，因为我不知道如何检查我是否做错了。比赛条件就是这样棘手。

**现在，代码：** 以下是您需要参考的脚本：

这是我粘贴到 javascript 控制台中的内容：

```
 //Note: private ~~ B
    //      public ~ A

    var me = 'IWwypRHWpDmydd30o-v';
    var mixed = new Array();
    var mixedNames = new Array();
    var privates = new Object();

    var callbackB = function(snapshot){
        child = snapshot.val();
        privates[snapshot.name()] = child;
    };

    var callbackA = function(snapshot){
        var listRef = snapshot.ref();
        listRef.on('child_added', function (snapshot2) {
        child = snapshot2.val();
            mixedNames.push(snapshot2.name());
            mixed.push(child);
      });
    };

    var getAllB = function (callback, ownerid){
        var priv = new Firebase('http://gamma.firebase.com/innermost/project/private/' + ownerid);
        priv.on('child_added', function (snapshot){
        callback(snapshot);
      });
    };

    function getAllA(callback) {
      var pub = new Firebase('http://gamma.firebase.com/innermost/project/public');
      pub.once('value', function (snapshot) {
        if (snapshot.val() === null) {
          alert('snapshot does not exist.');
        }
        callback(snapshot);
      });
    }

    getAllA(callbackA);
    getAllB(callbackB, me);

    //////wait

    for (b in privates){
        var index = $.inArray(b, mixedNames);
        if (index < 0){ //if there is no record with this name
            mixed.push(privates[b]);
            mixedNames.push(b);
        }
        else{
            var pub = mixed[index];
            var mutt = returnMixed(pub, privates[b]);
            mixed.splice(index,1,mutt);
        }
    }; 
```

我想要做的是将逻辑从 for 循环移动到回调中，因为如果你立即运行 for 循环，数组将不会通过回调完成下载。

* * *

*旧条目：*

我有两个回调访问 Firebase 上的数据列表。

回调 1 获取类型 A 的对象。回调 2 获取类型 B 的对象。

我的目标 - 拥有一个正确合并 A 和 B 类型对象的数组。

大多数（但必须是所有）类型 B 的对象都有一个类型为 A 的“伙伴”对象。少数类型 A 的对象有一个类型为 B 的伙伴对象。

对于从 Firebase 中提取的每个对象，我想看看他们的伙伴是否在数组中。如果没有，则插入。如果是这样，则改为与合作伙伴“合并”。

如果没有并发数据结构，我想不出办法来做到这一点 - 但我不知道如何在 Javascript 中做到这一点。

我怎样才能创建那个并发数组，或者想办法以其他方式实现我的目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T01:45:12.870

```
<script src="underscore.js"></script> <!-- or the lib of your choice -->
<script>

   function addWithPartner( value, id, type ) {
      var indexOfPartner = _.find(values, function(partner, i) {
         // logic for determining what a partner is goes here
         // for example: 
         return value.name == partner.name;
      });

      if( indexOfPartner >= 0 ) {
         merge( values, indexOfPartner, value );
      }
      else {
         values.push( value );
      }
   }

   function merge( list, index, value ) {
      // do whatever merge means here
      // for example:
      _.extend( list[index], value );
   }

   var FB = new Firebase(YOUR_URL);
   var values = [];

   FB.child('TYPEA').on('child_added', function(snapshot) {
      addWithPartner( snapshot.val(), snapshot.name(), 'typeA' );
   });

   FB.child('TYPEB').on('child_added', function(snapshot) {
      addWithPartner( snapshot.val(), snapshot.name(), 'typeB' );
   });

</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:41:27.453

JS 有 nil 值，对吧？无论如何，如果他们不这样做，这个答案是没有用的。

我要做的是在主数组上有一个函数，你传递一个对象并检查它的伙伴是否在数组中。如果是，则返回所述对象，否则返回 nil。这样，如果您需要，您已经拥有执行合并的对象。

此外，我不确定您的措辞如何，但您似乎担心并发会成为问题（竞争条件、覆盖等）？如果是这种情况，这是使用互斥锁的完美示例（如果 js 还没有它们，您可以很容易地制作自己的）。只要把我上面提到的功能锁在开头，然后解锁，就可以避免读取过时的数据。希望有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T00:40:57.597

不是 100% 确定我理解问题的细节，但知道 javascript 是单线程的可能会有所帮助，因此您永远不必担心真正的并发性。您的回调将始终一次发生一个。

因此，您不需要“并发数据结构”。很可能任何数据结构都可以工作，因为 javascript 中没有并发性。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-31T13:43:58.023

就像前面的答案中解释的那样，javascript 在仅限于主窗口时是单线程的；即使一个函数被异步调用，它的执行也将是“原子的”（不会被中断）。因此，您不能有竞争条件。

但是，处理问题“我不能这样做，因为没有真正的方法来检查回调是否“完成””，请尝试提供等待的[http://www.megiddo.ch/jcon-q-rency/](http://www.megiddo.ch/jcon-q-rency)通知（全部）机制。我用它来做和你一样的操作。

有了它，您可以延迟函数的执行，直到满足某个条件。那是你的“///////等待”。当 getAllA() 和 getAllB() 完成后，它们可以通知一个等待函数，该函数负责执行 for (b in privates){..} 循环。

# python - 如何使用 python 的 mongoengine 检索不同集合中的记录？

> ID：11874681
> 
> 赞同：1
> 
> 时间：2012-08-08T23:25:49.960
> 
> 标签：python, mongodb, mongoengine

我有一个模型“帖子”：

```
class Post(db.Document):
    created_at = db.DateTimeField(default=datetime.datetime.now, required=True)
    title = db.StringField(max_length=255, required=True)
    slug = db.StringField(max_length=255, required=True)
    body = db.StringField(required=True) 
```

假设我`post`使用 Post 对象创建了一个变量，但在将其保存之前，我将其保存到默认 (Post) 以外的集合名称，例如：

```
post._meta['collection'] = "customcollection"
post.save(); 
```

那么如何使用**mongoengine获取****customcollection**中的所有文档？

 **通常，如果我没有设置**customcollection**，我可以执行以下操作：

```
for item in Post.objects:
    print item.title 
```

但由于我设置了**customcollection**，我希望能够执行以下操作：

```
for item in customcollection.objects:
    print item.title 
```

虽然我得到一个：

```
NameError: global name 'customcollection' is not defined 
```

我需要在语法上做什么才能获取我的**customcollection**中的所有 Post 对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T03:22:52.180

如果您希望`Post`文档类指向`customcollection`只需执行以下操作：

```
class Post(db.Document):
    created_at = db.DateTimeField(default=datetime.datetime.now, required=True)
    title = db.StringField(max_length=255, required=True)
    slug = db.StringField(max_length=255, required=True)
    body = db.StringField(required=True)
    meta = {'collection': 'customcollection'} 
```

现在当你这样做时：

```
for item in Post.objects:
    print item.title 
```

`customcollection`它应该从集合中读取其帖子。**

# opencv - 编译 PCL 以与 OpenCV 一起使用

> ID：11874684
> 
> 赞同：1
> 
> 时间：2012-08-08T23:26:01.287
> 
> 标签：opencv, kinect, point-clouds

我正在尝试**编译 PCL 以**在 Ubuntu（64 位）上与 OpenCV 一起使用。

我正在按照官方[网站](http://www.pointclouds.org/downloads/source.html)上的说明进行操作。

当我执行“ **make** ”时，出现以下错误：

```
Linking CXX executable ../../bin/pcl_example_extract_clusters_normals
/usr/bin/ld: cannot find -lpcl_visualization
collect2: ld returned 1 exit status
make[2]: *** [bin/pcl_example_extract_clusters_normals] Error 1
make[1]: *** [examples/segmentation/CMakeFiles/pcl_example_extract_clusters_normals.dir/all] Error 2
make: *** [all] Error 2 
```

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T16:22:22.047

我通过编辑 cmake 文件来修复它。由于某种原因，没有构建可视化模块。我使用命令自定义了 cmake 文件`ccmake`，使其也构建可视化模块。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-28T16:54:54.417

我还必须编辑cmake文件来构建可视化，但后来我发现我需要安装libvtk5-dev，否则可视化模块会自动关闭。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T09:45:09.977

您还可以使用`cmake-gui`和启用`BUILD_visualisation`

# clojure - Clojure REPL 中是否可以有 _good_ 选项卡补全？

> ID：11874689
> 
> 赞同：7
> 
> 时间：2012-08-08T23:26:29.220
> 
> 标签：clojure, read-eval-print-loop, tab-completion

好的选项卡完成意味着使用反射或其他方式动态生成（不需要在某处预定义的完成列表），并且知道在特定位置可以遵循什么，不遵循什么。

就像`(.<TAB> x)`我会得到 x 的方法列表一样，我会得到`(println <TAB>)`本地和全局定义`(Math/<TAB>`的列表，我会得到数学函数的列表......

例如，我喜欢`Tab`ghci (Haskell) 或 ipython 中的工作方式。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-09T05:49:07.563

查看[回复](https://github.com/trptcolin/reply)以获得比默认更好的 REPL。它涵盖了您提到的三个用例中的两个，而没有涉及 Java 实例方法完成。

如果您使用[leiningen](https://github.com/technomancy/leiningen)`lein repl` v2+，它是命令调用的默认 REPL 。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-08T23:51:02.853

这当然是可能的，并且一些工具正在朝着这个方向发展。最新版本的 clojure 包含一个**“开发模式”选项，可以更轻松地构建此类工具**；例如，它关闭本地清除以帮助调试，其目的是最终能够导出更多关于编译过程的信息，以供 IDE 和相关工具使用。这被广泛认为是改进 Clojure 生态系统的一个领域，根据我的观察，有几个非常聪明的人正在研究它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T13:15:02.857

我将 Emacs 用作具有 Slime 和[Emacs auto-complete](http://emacswiki.org/emacs/AutoComplete)的编辑器，并且使所有这些功能都适用于 Emacs 中的 Repl：Java 类和字段的自动完成、自动完成以及 Clojure 函数的文档。不幸的是，如果您不使用 Emacs 作为编辑器/IDE，这将不起作用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-09T08:08:53.833

当前 Eclipse CounterClockwise REPL 的 beta 版本大大改进了代码完成，并涵盖了您的所有案例，包括 Java 完成。除了当然不是独立的命令行 REPL。Clojure 是一种动态语言，但是它对类型完成有限制，这在 Haskell 等强类型语言中要容易得多。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-19T03:44:26.973

看起来[IClojure](https://github.com/cosmin/IClojure)或多或少地做得很好。它受到启发，看起来像 IPython，并提供选项卡完成（不完整，提到 3 个案例中的 2 个）并帮助在控制台中开发 Clojure。虽然不是很稳定。

# php - 拥有一个 widget_id 我如何呈现小部件本身

> ID：11874693
> 
> 赞同：0
> 
> 时间：2012-08-08T23:27:03.367
> 
> 标签：php, wordpress

假设我能够获取特定小部件的“widget_id”。然后我怎样才能渲染/显示那个wiget

```
 e.g. show_widget($widget_id); 
```

详细信息：我希望能够将小部件添加到侧边栏（使用外观 -> 小部件）。然后以编程方式，我希望能够在该侧边栏中获取该小部件并显示它。

有没有办法我可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T19:42:09.743

您可以使用`the_widget`

[http://codex.wordpress.org/Function_Reference/the_widget](http://codex.wordpress.org/Function_Reference/the_widget)

您将需要小部件类名称，而不是 widget_id

# algorithm - 二叉索引树（Fenwick Tree）——关于更新

> ID：11874701
> 
> 赞同：4
> 
> 时间：2012-08-08T23:27:49.723
> 
> 标签：algorithm, data-structures, fenwick-tree

我最近学习了[Fenwick Tree（二进制索引树）](http://en.wikipedia.org/wiki/Fenwick_tree)数据结构。

查询时，我可以理解为什么要减去（idx & -idx）。但是，我真的不明白为什么在更新值时要添加 (idx & -idx)。

换句话说，我知道我们必须更新所有将受到更新某些单个元素 x 影响的间隔，并且我知道 BIT[x] 是第一个要更新的，但不明白为什么要更新下一个索引是 BIT[x + (x & -x)]

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T06:31:59.240

这是一个很好的解释： http: [//community.topcoder.com/tc ?module=Static&d1=tutorials&d2=binaryIndexedTrees](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=binaryIndexedTrees)

关键思想是，如果 f(i) 是索引 i 处的频率，则 t(i) 是所有 (i - (r - 1)) .. i 的累积频率，其中 r 是 i 中设置最少的位。您可以将 r 计算为 r = i & -i。

[编辑：上面我错误地将 (r - 1) 写为 (2^r - 1)。]

例如，如果 i = 12 = 1100_2，则 r = 100_2 并且 t(i) = f(1001_2) + f(1010_2) + f(1011_2) + f(1100_2) = f(9) + f(10) + f(11) + f(12)。

当从 0 .. i 计算累积频率时，您基本上将 i 处的 t 值相加，i 删除了它的最少设置位，i 删除了它的至少两个设置位，......等等，直到我们用完位。

例如，如果 i = 12 = 1100_2，那么我们需要 t(1100_2) + t(1000_2)。

因此，如果您更改 f(i) 处的值，则必须更改所有受影响的 t 值。这些是 t(i), t(i + r), 2t(i + r), 4t(i + r), ... 等等，直到我们超过最后一个索引。这些正是我们将在指数 j >= i 的任何累积频率计算中检查的受影响的 t 值。

[编辑：修复了最后一段中的“受影响的 t 值”序列，以响应 j_random_hacker 的更正。]

# objective-c - 如何将 xib 与情节提要相关联

> ID：11874708
> 
> 赞同：0
> 
> 时间：2012-08-08T23:28:41.563
> 
> 标签：objective-c, xcode, storyboard

我用情节提要构建了一个应用程序我需要在情节提要上使用 356 个视图控制器，而且无法使用这么多的屏幕我在情节提要上创建标签栏和表格单元我创建 xib 我想在情节提要上建立从 xib 到表格单元的关系如何做吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T02:39:11.063

您可以从 TableViewController 连接到其他视图。

![ss](../Images/d5ae91dce2f9039410c84f6ecf4987cb.png)

例如，首先，您可以将 TableViewCell 设置如下：

![ss](../Images/640896876b83d5eabbf92ef93842ea28.png)

点击单元格时，显示点击单元格数量的视图。

![ss](../Images/c4e627677e0c859bf057e0a1181aebac.png)

要将点击的单元格的数量发送到下一个 ViewController，您可以使用`performSegueWithIdentifier:sender:`和`prepareForSegue:sender`，如下所示。

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    [self performSegueWithIdentifier:@"showDetail" 
                              sender:[NSString stringWithFormat:@"%d", indexPath.row + 1]];
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    DetailViewController *c = segue.destinationViewController;
    c.string = (NSString *)sender;
} 
```

您可以下载此项目并运行它。

[https://github.com/weed/p120809_TableCellToView](https://github.com/weed/p120809_TableCellToView)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T00:08:02.063

您有太多视图控制器，但我会幽默地回答实际问题：

```
UIStoryBoard *storyBoard = [UIStoryboard storyboardWithName:storyboardName bundle:nil];

BrowserViewController *vc = (BrowserViewController*)[storyboard instantiateViewControllerWithIdentifier:@"BrowserViewController"];

//get whatever instance you want off the VCs properties a table view or whatever
// but usually youll just want to push it onto a nav controller

[[self navigationController] pushViewController:vc animated:YES]; 
```

# java - 我应该如何以及在哪里添加 ActionListener 在我的代码中？

> ID：11874709
> 
> 赞同：3
> 
> 时间：2012-08-08T23:28:45.737
> 
> 标签：java, swing, actionlistener, jtabbedpane

我写了下面的代码，它有一个文本字段和一个按钮。只要输入一个字符并按下按钮，就会创建一个选项卡，其标题与在字段中输入的内容相同。

可以以相同的方式创建多个选项卡......现在再次在新选项卡中，一个文本字段和一个按钮存在一个很长的文本窗格以显示结果......

我想在每个选项卡的文本窗格中显示输入到文本字段中的文本...

现在请引导我了解如何以及在何处放置选项卡按钮的侦听器......并推荐任何其他所需的侦听器（我认为应该有另一个侦听器将我引导到焦点或选定的选项卡）。

应该提到的是，我已将这些选项卡添加到数组列表中以供重复使用，但我不知道我是否做得对或如何使用它？

```
package test;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTabbedPane;
import javax.swing.JTextField;
import javax.swing.JTextPane;

public class TestGUI extends JFrame {

    private JTextField jTextField1;
    private JButton jButton1;
    static ArrayList<JPanel> ary = new ArrayList<JPanel>();
    private int tabIndex = 0;
    static int index = 0;
    private JTabbedPane tabbedPane;

    /**
    * @param args
    */
    public TestGUI() {

        super("Testing Tab Frame");
        setLayout(null);

        Handler but1 = new Handler();

        jTextField1 = new JTextField();
        jTextField1.setVisible(true);
        jTextField1.setBounds(12, 12, 85, 30);
        add(jTextField1);

        jButton1 = new JButton("Button1");
        jButton1.setVisible(true);
        jButton1.setBounds(130, 12, 85, 30);
        add(jButton1);
        jButton1.addActionListener(but1);

        tabbedPane = new JTabbedPane();
        tabbedPane.setBounds(12, 54, 200, 150);
        tabbedPane.setVisible(false);
        add(tabbedPane);
        pack();
        setSize(250, 110);
        setLocationRelativeTo(null);

    }

    private class Handler implements ActionListener {

        public void actionPerformed(ActionEvent evt) {
            String input = jTextField1.getText();
            if (!input.isEmpty()) {
                setSize(250, 250);
                JPanel inst = createPanel(input);
                inst.setVisible(true);
                tabbedPane.addTab(Integer.toString(tabIndex), inst);
                tabbedPane.setVisible(true);
            }

        }
    }

    protected JPanel createPanel(String input) {
        JPanel inst = new JPanel();
        inst.setVisible(true);
        JTextField textField = new JTextField();
        textField.setVisible(true);
        textField.setBounds(12, 12, 80, 30);
        JButton button = new JButton();
        button.setVisible(true);
        button.setBounds(100, 12, 80, 30);
        JTextPane textPane = new JTextPane();
        textPane.setBounds(12, 54, 168, 40);
        inst.add(textPane);
        textPane.setVisible(true);
        inst.setLayout(null);
        inst.add(button);
        inst.add(textField);
        ary.add(inst);
        tabIndex = index;
        index++;
        return inst;
    }

    public static void main(String[] args) {
        // TODO Auto-generated method stub
        TestGUI inst = new TestGUI();
        inst.setVisible(true);
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-09T00:49:59.717

您将添加到您的方法`ActionListener`内的按钮。`createPanel`因此，您的方法将是这样的（由于不清楚，因此对您实际想要对文本执行的操作做出一些假设）：

```
protected JPanel createPanel(String input) {
    JPanel inst = new JPanel();
    inst.setVisible(true);
    final JTextField textField = new JTextField();
    textField.setVisible(true);
    textField.setBounds(12, 12, 80, 30);
    JButton button = new JButton();        
    button.setVisible(true);
    button.setBounds(100, 12, 80, 30);
    final JTextPane textPane = new JTextPane();
    textPane.setBounds(12, 54, 168, 40);
    inst.add(textPane);
    textPane.setVisible(true);

    button.addActionListener(new ActionListener(){

        @Override
        public void actionPerformed(ActionEvent arg0) {
            textPane.setText(textPane.getText() + textField.getText());
        }});

    inst.setLayout(null);
    inst.add(button);
    inst.add(textField);
    ary.add(inst);
    tabIndex = index;
    index++;
    return inst;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-09T00:20:34.470

[此处](https://stackoverflow.com/a/3158757/230513)显示的修改[`TabComponentsDemo`](http://docs.oracle.com/javase/tutorial/uiswing/components/tabbedpane.html#eg)显示了一种重命名选项卡的方法。它在每个窗格上听 a ，但 a上的 a也应该服务。`JButton``ActionListener``JTextField`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-09T06:24:44.340

可用于使用户界面更健壮的各种要点：

*   [从绝对定位](http://docs.oracle.com/javase/tutorial/uiswing/layout/none.html)开始真的不是一个好主意。请阅读链接的第一段，以了解更多关于为什么不鼓励使用 [LayoutManagers](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)的方法的信息。
*   无需像在代码中那样显式使用`setVisible(true);`各种 `JComponent`s，因为当您使父组件可见时，所有子组件都将同样设置为可见。
*   像这样的调用`pack()/setVisible(true/false)`必须在 EDT 事件调度线程上完成，而不是从 main 方法调用它们。有关更多信息，请阅读[Swing 中的并发](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)。

看看你的这个修改过的代码，如果你需要更多的了解，请询问：

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTabbedPane;
import javax.swing.JTextField;
import javax.swing.JTextPane;
import javax.swing.SwingUtilities;

public class TestGUI extends JFrame {

    private JPanel contentPane;
    private JTextField jTextField1;
    private JButton jButton1;
    static ArrayList<JPanel> ary = new ArrayList<JPanel>();
    private int tabIndex = 0;
    static int index = 0;
    private JTabbedPane tabbedPane;

    public TestGUI() {

        super("Testing Tab Frame");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        contentPane = new JPanel();
        contentPane.setLayout(new BorderLayout(5, 5));

        Handler but1 = new Handler();
        JPanel footerPanel = new JPanel();

        jTextField1 = new JTextField(10);
        footerPanel.add(jTextField1);

        jButton1 = new JButton("Create TAB");
        footerPanel.add(jButton1);
        jButton1.addActionListener(but1);

        tabbedPane = new JTabbedPane();

        contentPane.add(tabbedPane, BorderLayout.CENTER);
        contentPane.add(footerPanel, BorderLayout.PAGE_END);   

        setContentPane(contentPane);    
        setSize(300, 300);
        setLocationRelativeTo(null);
    }

    private class Handler implements ActionListener {

        @Override
        public void actionPerformed(ActionEvent evt) {
            String input = jTextField1.getText();
            if (!input.isEmpty()) {

                JPanel inst = createPanel();                
                tabbedPane.addTab(input, inst);
                ary.add(inst);              

                jTextField1.setText("");
                contentPane.revalidate();
                contentPane.repaint();              
            }
        }
    }

    protected JPanel createPanel() {

        JPanel inst = new JPanel();
        inst.setLayout(new BorderLayout(5, 5));

        final JTextPane textPane = new JTextPane();

        JPanel footerPanel = new JPanel();
        final JTextField textField = new JTextField(10);
        JButton button = new JButton("SHOW");
        button.addActionListener(new ActionListener()
        {
            @Override
            public void actionPerformed(ActionEvent ae)
            {
                if (textField.getDocument().getLength() > 0)
                    textPane.setText(textField.getText());
                textField.setText("");  
            }
        });
        footerPanel.add(textField);
        footerPanel.add(button);

        inst.add(textPane, BorderLayout.CENTER);
        inst.add(footerPanel, BorderLayout.PAGE_END);    

        return inst;
    }

    public static void main(String[] args) {
        // TODO Auto-generated method stub
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                TestGUI inst = new TestGUI();
                inst.setVisible(true);
            }
        });
    }

} 
```

# asp.net - 使用 oauth2 进行身份验证以转到网络研讨会

> ID：11874710
> 
> 赞同：2
> 
> 时间：2012-08-08T23:29:19.367
> 
> 标签：asp.net, c#-4.0, oauth-2.0

我正在尝试从我的 c# asp.net 应用程序连接到 gotowebinar REST 服务，该应用程序需要 oauth2。不幸的是我不能使用 dotnetopenauth。有没有人有任何关于如何验证 gotowebinar 的简单 c# 代码示例？

我已经看到了其他一些 oauth2 API，但大多数似乎都没有记录。

这是[gotowebinar 对其身份验证过程的概述](https://developer.citrixonline.com/page/authentication-and-authorization)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-06T21:10:40.180

我建议使用 dotnetopenauth。

不幸的是，由于项目限制，我无法使用它，所以这是我工作代码的片段。我删除了一些专有代码以尝试使其更易于阅读和使用。如果有人有任何问题，请告诉我，我会看看是否可以提供帮助。

```
 /// <summary>
/// Summary description for GoToWebinarProvider
/// </summary>
public class GoToWebinarProvider
{
    #region properties
    private GoToWebinarAccessToken _accessToken;
    private readonly string _apiKey = "apikey";

    /// <summary>
    /// Use for debugging purposes
    /// </summary>
    private const bool EnableCaching = true;

    private const string G2WApiDateTimeFormat = "yyyy-MM-ddTHH:mm:ssZ";
    #endregion properties

    #region token management
    private void OAuthenticate()
    {
        GoToWebinarAccessToken localToken = null;

        //try to get access token from cache
        if (EnableCaching)
        {
            localToken = GetTokenFromDb();

            //cache it here
        }
        else
        {
            _accessToken = GetTokenFromDb();
        }

        //if the token hasn't expired yet, we have an access token, so instantiation is complete
        if (_accessToken != null && _accessToken.ExpirationDate > DateTime.Now)
        {
            return;
        }

        //else get new token
        var responseKey = GetResponseKey();

        if (responseKey != null)
        {
            _accessToken = GetAccessToken(responseKey);

            if (_accessToken != null)
            {
                StoreTokenInDb(_accessToken);
            }
            else
            {
                throw new Exception("Could not acquire access token from GoToWebinar");
            }
        }
        else
        {
            throw new Exception("Could not acquire response key from GoToWebinar");
        }
    }

    private GoToWebinarAccessToken GetAccessToken(string responseKey)
    {
        var url =
            String.Format(
                "https://api.citrixonline.com/oauth/access_token?grant_type=authorization_code&code={0}&client_id={1}",
                responseKey, _apiKey);

        const string applicationJSON = "application/json; charset=UTF-8";

        var httpWebRequest = (HttpWebRequest)WebRequest.Create(url);

        httpWebRequest.ProtocolVersion = HttpVersion.Version11;
        httpWebRequest.Method = "GET";

        httpWebRequest.Accept = applicationJSON;

        try
        {
            var response = httpWebRequest.GetResponse();
            //will throw error if not 200 response

            using (var dataStream = response.GetResponseStream())
            {
                var responseText = dataStream != null ? new StreamReader(dataStream).ReadToEnd() : String.Empty;

                var jsSerializer = new JavaScriptSerializer();

                var accessToken = jsSerializer.Deserialize(responseText, typeof(GoToWebinarAccessToken)) as GoToWebinarAccessToken;

                //pad it by a minute.  took time to calculate it, and each request will have latency in getting to gotowebinar
                accessToken.ExpirationDate = DateTime.Now.AddSeconds(Convert.ToDouble(accessToken.Expires_In)).AddMinutes(-1);

                return accessToken;
            }
        }
        catch (Exception ex)
        {
            return null;
        }
    }

    private string GetResponseKey()
    {
        var redirectURL = HttpContext.Current.Server.UrlEncode("http://mysite.net/Welcome.aspx");

        var requestURL =
            String.Format("https://api.citrixonline.com/oauth/authorize?client_id={0}&amp;redirect_uri={1}", _apiKey,
                          redirectURL);
        var request = CreateWebRequest(requestURL, "GET");

        try
        {
            //first request
            var response = request.GetResponse();
            //will throw error if not 200 response

            using (var dataStream = response.GetResponseStream())
            {

                var responseText = dataStream != null ? new StreamReader(dataStream).ReadToEnd() : String.Empty;

                return Login(redirectURL);
            }
        }
        catch (Exception ex)
        {
            return null;
        }
    }

    /// <summary>
    /// Should only be called by GetResponseKey
    /// </summary>
    /// <param name="urlEncodedRedirect"></param>
    private string Login(string urlEncodedRedirect)
    {
        var elp = new EventLogProvider();

        var userName = HttpContext.Current.Server.UrlEncode(SettingsKeyProvider.GetSettingsKeyInfo("GoToWebinarUserEmail").KeyValue);
        var password = HttpContext.Current.Server.UrlEncode(SettingsKeyProvider.GetSettingsKeyInfo("GoToWebinarUserPassword").KeyValue);
        var postData = String.Format(
                "emailAddress={0}&password={1}&client_id={2}&access_type=G2W&app_name=MyApp&redirect_url={3}&submitted=form_submitted&submit=Log+In",
                userName, password, _apiKey, urlEncodedRedirect);

        var request = CreateWebRequest("https://developer.citrixonline.com/oauth/g2w/authorize.php", "POST",
                                       postData, "application/x-www-form-urlencoded");
        request.AllowAutoRedirect = false;

        var response = request.GetResponse();

        using (var dataStream = response.GetResponseStream())
        {
            var responseText = dataStream != null ? new StreamReader(dataStream).ReadToEnd() : String.Empty;

            const string locationHeader = "location";

            if (!String.IsNullOrWhiteSpace(response.Headers.Get(locationHeader)))
            {
                //get redirect to login page
                var locationRedirect = response.Headers.Get(locationHeader);

                elp.LogEvent("I", DateTime.Now, GetType().Name, "GoToWebinar",
                             HttpContext.Current.Request.Url.ToString(), locationRedirect);

                const string comparator = "code=";
                var index = locationRedirect.IndexOf(comparator, StringComparison.OrdinalIgnoreCase);

                if (index != -1)
                {
                    return locationRedirect.Substring(index + comparator.Length);
                }

                throw new Exception("Could not parse response code: " + locationRedirect);
            }

            throw new Exception("Did not receive redirect: ", new Exception(responseText));
        }
    }

    private static GoToWebinarAccessToken GetTokenFromDb()
    {
        //return token
    }

    private static void StoreTokenInDb(GoToWebinarAccessToken accessToken)
    {
        //store token
    }
    #endregion token management

    #region api calls

    public IList<GoToWebinarWebinar> GetWebinars()
    {
        if (_accessToken == null || _accessToken.ExpirationDate < DateTime.Now)
        {
            OAuthenticate();
        }

        var serviceEndPoint = String.Format("https://api.citrixonline.com/G2W/rest/organizers/{0}/webinars", _accessToken.Organizer_Key);

        try
        {
            var httpWebRequest = CreateJSONRequest(serviceEndPoint, "GET", null);

            var httpResponse = (HttpWebResponse)httpWebRequest.GetResponse();
            using (var httpResponseStream = httpResponse.GetResponseStream())
            {
                if (httpResponseStream != null)
                {
                    using (var streamReader = new StreamReader(httpResponseStream))
                    {
                        var responseText = streamReader.ReadToEnd();

                        var jsSerializer = new JavaScriptSerializer();
                        var gotoWebinarList = jsSerializer.Deserialize<IList<GoToWebinarWebinar>>(responseText);

                        return gotoWebinarList;
                    }
                }
            }
        }
        catch (Exception ex)
        {
            //log it
        }

        return null;
    }

    #endregion api calls

    #region web requests
    private HttpWebRequest CreateJSONRequest(string serviceEndPoint, string httpMethod, string postData)
    {
        const string applicationJSON = "application/json";

        var httpWebRequest = (HttpWebRequest)WebRequest.Create(serviceEndPoint);

        httpWebRequest.ProtocolVersion = HttpVersion.Version11;
        httpWebRequest.Method = httpMethod;

        httpWebRequest.Accept = String.Format("{0}, application/vnd.citrix.g2wapi-v1.1+json", applicationJSON);

        httpWebRequest.ContentType = applicationJSON;
        httpWebRequest.Headers.Add(HttpRequestHeader.Authorization, _accessToken.Access_Token);

        if (httpMethod.Equals("POST", StringComparison.OrdinalIgnoreCase))
        {
            var encoding = new ASCIIEncoding();

            var body = encoding.GetBytes(postData);
            httpWebRequest.ContentLength = body.Length;

            using (var newStream = httpWebRequest.GetRequestStream())
            {
                newStream.Write(body, 0, body.Length);
                newStream.Close();
            }
        }

        return httpWebRequest;
    }

    private static HttpWebRequest CreateWebRequest(string serviceEndPoint, string httpMethod)
    {
        //const string applicationJSON = "application/json";

        var httpWebRequest = (HttpWebRequest)WebRequest.Create(serviceEndPoint);

        httpWebRequest.ProtocolVersion = HttpVersion.Version11;
        httpWebRequest.Method = httpMethod;

        //httpWebRequest.Accept = String.Format("{0}, application/vnd.citrix.g2wapi-v1.1+json", applicationJSON);

        //httpWebRequest.ContentType = applicationJSON;
        //httpWebRequest.Headers.Add(HttpRequestHeader.Authorization, _accessToken);

        return httpWebRequest;
    }

    private static HttpWebRequest CreateWebRequest(string serviceEndPoint, string httpMethod, string postData, string contentType)
    {
        var httpWebRequest = (HttpWebRequest)WebRequest.Create(serviceEndPoint);

        httpWebRequest.ProtocolVersion = HttpVersion.Version11;
        httpWebRequest.Method = httpMethod;

        if (contentType != null)
        {
            httpWebRequest.ContentType = contentType;
        }

        if (httpMethod.Equals("POST", StringComparison.OrdinalIgnoreCase))
        {
            var encoding = new ASCIIEncoding();

            var body = encoding.GetBytes(postData);
            httpWebRequest.ContentLength = body.Length;

            using (var newStream = httpWebRequest.GetRequestStream())
            {
                newStream.Write(body, 0, body.Length);
                newStream.Close();
            }
        }

        return httpWebRequest;
    }

    #endregion web requests

    private void LogRequest(string methodName, string dataToLog)
    {
        //log it
    }

    /// <summary>
    /// Syntax matches JSON response
    /// </summary>
    private class GoToWebinarAccessToken
    {
        public string Access_Token;
        public string Refresh_Token;
        public string Organizer_Key;
        public string Account_Key;

        public double? Expires_In;

        public DateTime ExpirationDate;
    }
} 
```

# php - 来自jquery的iphone上的奇怪结果得到

> ID：11874715
> 
> 赞同：0
> 
> 时间：2012-08-08T23:29:26.627
> 
> 标签：php, jquery, iphone, mysql, ajax

所以我在我的 iPhone4 上从我编写的 jquery“get”代码中得到了奇怪的结果。基本上，该代码建议使用 php 生成的 mysql 数据库中的单词。

代码位于`http://111.89.128.27/smt/?nsd`

在任何桌面浏览器中，代码都可以正常工作。在第一个输入表单中，请键入“p”，它会返回（警告）这个：

```
<li class="data-row"><a class="data-click" href="#PC无偿贷与制度">PC无偿贷与制度</a></li>
<li class="data-row"><a class="data-click" href="#理学治疗士">理学治疗士</a>
</li>
<li class="data-row"><a class="data-click" href="#DTPオペレーター・DTPクリエイター">DTPオペレーター・DTPクリエイター</a></li>
<li class="data-row"><a class="data-click" href="#マイクロソフト・フィスペシャリスト(MOS)">マイクロソフト・オフィスペシャリスト(MOS)</a></li>
<li class="data-row"><a class="data-click" href="#JＡＰＡＮサッカーカレッジ">ＪＡＰＡＮサッカーカレッジ</a></li>

```

同样的结果出现在我的 iPad2 平板电脑上，这很好。

但是，在我的 iPhone4 中，结果显示的是当前代码。

有没有人遇到过这个问题并知道解决方法？我很感激帮助。提前致谢。

# python - 狮身人面像：在不记录包中导入错误。有没有办法“跳过”？

> ID：11874716
> 
> 赞同：4
> 
> 时间：2012-08-08T23:29:28.707
> 
> 标签：python, python-sphinx, importerror

我正在尝试使用 Sphinx 开始记录一个小型 Python 项目。

我创建了一个`samplecode.rst`我会尝试为我的一个类（*MyClass.py*）组织（并自动生成）文档的地方。

这是其中的一部分`samplecode.rst`：

```
MyClass.py
----------------------------------
.. autoclass:: backlib.classes.MyClass
   :members: 
```

但是当我尝试执行时`make html`，我得到一个导入错误，并且“ ”没有被导入（在生成的 .html 中`MyClass`显示“”的一个空条目）：`MyClass`

```
Traceback (most recent call last):de                                                                                                                                                                                
  File "/usr/lib/pymodules/python2.7/sphinx/ext/autodoc.py", line 329, in import_object
    __import__(self.modname)
  File "/home/borrajax/Projects/myProject/backlib/classes/MyClass.py", line 4, in <module>
    from backlib.database import BaseClass
[ ... ]
    from grokcore.component import sort_components
ImportError: cannot import name sort_components 
```

……再过一会儿……

```
/home/borrajax/Projects/myProject/docs/source/samplecode.rst:16: (WARNING/2) autodoc can't import/find module 'backlib.classes.MyClass', it reported error: "cannot import name sort_components", please check your spelling and sys.path

/home/borrajax/Projects/myProject/docs/source/samplecode.rst:19: (WARNING/2) don't know which module to import for autodocumenting u'MyClass' (try placing a "module" or "currentmodule" directive in the document, or giving an explicit module name) 
```

让我`grokcore`的生活变得混乱的东西是一个安装在其中的模块，`$HOME/.buildout/eggs/`我没有创建也不需要记录。

我已经将所有在`$HOME/.buildout/eggs/`Pythonpath 中找到的鸡蛋（在 Sphinx 的`conf.py`文件中）添加了，但这并没有解决任何问题，所以现在我正在尝试一种不同的方法（放弃）所以这里有一个问题：我可以做些什么来跳过这个什么样的错误？

我只是想让评论`/home/borrajax/Projects/myProject/backlib/classes/MyClass.py`显示在一个漂亮的 html 页面中，仅此而已。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T03:03:46.150

我假设您`sys.path`在 sphinx 中的 for`conf.py`不包括您的源代码所在的目录。

尝试将以下内容添加到您的`conf.py`for sphinx.xml 中。

```
sys.path.insert(0, '/home/borrajax/Projects/myProject/') 
```

另外，我假设`backlib`并且`backlib/classes`是有效的包（它们包含`__init__.py`文件。）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-09T15:33:33.797

嗯...我发现了问题。

Mike Steder 的[回答](https://stackoverflow.com/a/11876192/289011)证实了我通过谷歌搜索开始怀疑的一些事情：Sphinx 中的这种类型的*ImporErrors*通常是某种配置错误的相当微不足道的错误。没什么太复杂的，所以即使我有我的源代码所在的目录`sys.path`（正如迈克在他的回答中建议的那样），我还是开始四处挖掘。

我开始猜测我所做的事情是弄乱了 PythonPath，而我实际上所做的唯一一件事就是通过 Sphinx 的文件添加`.eggs`找到的（所以肯定有什么问题）。我检查了我的目录并意识到该项目中使用的主 Web 框架 ( [Grok](http://grok.zope.org/) ) 的更新已将新版本的 下载到目录中（导致大多数有两个版本）。我完全删除了该目录并重新安装了 Grok 项目（它再次下载了所需的 .eggs，但现在我没有同一个 .egg 的多个版本）。`$HOME/.buildout/``conf.py``$HOME/.buildout/``.eggs``$HOME/.buildout/``.eggs``.buildout`

现在，Sphinx为我的班级`make html`创造了一个不错的入口**：)**`MyClass`

# python - 混合语言 - Python 和 Objective-C

> ID：11874719
> 
> 赞同：2
> 
> 时间：2012-08-08T23:30:07.437
> 
> 标签：python, objective-c, cross-language

我知道 Objective-C++ 可以存在，因为 Objective-C 和 C++ 在 C 中有共同点。但是 Objective-C 如何与 Python 共存呢？我知道这一定是可能的，因为 wxPython 使用 Cocoa 来绘制接口。

我正在为 OS X 编写一个纸牌游戏引擎。它将能够玩多个游戏（Klondike、Spider、Free Cell，甚至可能是 Hearts 或 Poker）。它将与 Game Center 一起工作，所以我需要有可用的 Cocoa 框架，但我想编写一个 Python API，所以我可以用 Python 自己编写游戏（因为它更易于使用且更具动态性）。我将如何在我自己的应用程序中实现这种语言混合？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:34:02.743

如果 Python 应用程序使用已编译的外部库，那么这就是对Python 的*扩展*。这样做的文档在[这里](http://docs.python.org/extending/extending.html)。

如果编译的应用程序使用 Python 编写脚本，那么这就是*嵌入*Python。这样做的文档在[这里](http://docs.python.org/extending/embedding.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:38:17.937

我不是 Cocoa 方面的专家，但我认为您误解了使用它的意义。Cocoa 只是一个导出一些函数的库。任何能够理解函数签名的东西都可以使用它。这并不意味着该事物必须与 Objective-C 兼容。这只是意味着它必须能够理解调用约定。

但是，我很确定 Python 可以在标准 C 和 ObjC 运行时上运行（因为 IIRC 它是前者的扩展），所以我不明白为什么不可能为 Python 制作 Cocoa 绑定。苹果似乎支持它[https://developer.apple.com/technologies/mac/cocoa.html](https://developer.apple.com/technologies/mac/cocoa.html)

> Objective-C 的动态运行时类似于许多现代脚本语言，使用**Cocoa Bridge**可以轻松地将 Cocoa 的功能映射到其他语言。借助 Cocoa Bridge，开发人员可以使用 AppleScript、Ruby 和 Python 创建一流的 Mac OS X 应用程序。

那么，您要检查的下一个关键字是：**Cocoa Bridge** ，也许还有[https://developer.apple.com/cocoa/pyobjc.html](https://developer.apple.com/cocoa/pyobjc.html)？

# sql - 在包中找不到 SSIS 连接

> ID：11874722
> 
> 赞同：28
> 
> 时间：2012-08-08T23:30:16.797
> 
> 标签：sql, sql-server, ssis

我是 SSIS 编程的新手，我在部署 SSIS 包时遇到了一些问题。

这个包在我的电脑上正常运行，做它需要做的一切......但是当我部署它时找不到连接字符串。

这是错误：

> 代码：0xC001000E 来源：描述：未找到连接“{DA7CD38D-F6AA-4B06-8014-58BEE5684364}”。当未找到特定连接元素时，Connections 集合会引发此错误。结束错误
> 
> 错误：2012-08-09 00:21:06.25 代码：0xC001000E 源：包描述：找不到连接“{DA7CD38D-F6AA-4B06-8014-58BEE5684364}”。当未找到特定连接元素时，Connections 集合会引发此错误。结束错误
> 
> 错误：2012-08-09 00:21:06.25 代码：0xC001000E 源：包描述：找不到连接“{DA7CD38D-F6AA-4B06-8014-58BEE5684364}”。当未找到特定连接元素时，Connections 集合会引发此错误。结束错误
> 
> 错误：2012-08-09 00:21:06.25 代码：0xC00291EB 来源：执行 SQL 任务 执行 SQL 任务描述：连接管理器“{DA7CD38D-F6AA-4B06-8014-58BEE5684364}”不存在。结束错误
> 
> 错误：2012-08-09 00:21:06.25 代码：0xC0024107 来源：执行 SQL 任务描述：任务验证期间出现错误。结束错误 DTExec：包执行返回 DTSER_FAILURE (1)。开始时间：00:21:04 结束时间：00:21:06 经过时间：1.888 秒。包执行失败。步骤失败。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-06-25T22:28:21.490

我参加聚会有点晚了，但我遇到了同样的错误并遇到了这个线程，并找到了不同的解决方案。

创建 SSIS 2012 包时，在解决方案资源管理器窗口中，您将看到项目级别的 Connection Managers 文件夹。这似乎是创建连接最合乎逻辑的地方，并且应该在创建可以被项目中的任何包使用的连接时使用。它包含在项目级别，而不是包级别。

当使用 dtexec 运行我的 dtsx 包时，我收到了上面显示的相同错误。这是因为连接不包含在包中（只是项目）。我的解决方案是进入包设计器，然后在连接管理器窗口中，右键单击项目级连接（使用“（项目）”前缀显示）并选择“转换为包连接”。这会将连接嵌入到实际的 dtsx 包中。这缓解了我的问题。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2012-08-09T01:26:25.887

`deleted`您的ssis 包似乎指向了其他一些可能已经存在的连接。尝试`renamed`打开 SSIS 组件并指向连接管理器中的正确连接。

当我们复制 SSIS 包组件以创建新包时或由于重命名连接或可能仍有组件使用您的 xml 配置文件中定义的旧连接时会发生这种情况（在您的情况下，请尝试检查执行 SQL 任务，它是抛出错误）。如果您使用 XML 进行配置，请尝试部署新的配置。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-10-01T15:29:31.843

感谢您发布此问题。

一种解决方法：通过Windows资源管理器以XML形式打开包，找到无法找到的连接管理器的GUID。就我而言，这是一个损坏的 EventHandler 连接。在控制流中使用了相同的连接管理器，但不知何故在那里没有损坏，因此通过 UI 对用户来说并不明显。由于 XML 指向事件处理程序连接管理器，我在 UI 中打开了事件处理程序选项卡，它立即在引用损坏的连接管理器 ID 的源和目标上显示了美妙的 RED X。我将它重新指向正确的经理，重建 pkg 并保存。很好走。

关键是以 XML 格式打开 pkg 并在代码中找到 GUID 以查看失败的位置。如果我无法在 UI 中找到对它的有效引用，我打算将 XML 连接重命名为 XML 中的另一个已知 GUID，然后进入 UI 并再次重新指向它，或者完全删除它。

祝你好运。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-20T14:46:27.533

当您使用新的 SSIS 2012“共享连接管理器”概念时，这似乎也会发生，其中连接管理器不是在包中定义，而是在 Visual Studio 项目中定义，只是在包中被引用。通过 SQL 代理或 DTEXEC 执行它会产生相同的错误消息。

我还没有找到解决方案，但如果有人以前经历过，我很想得到一些反馈。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-03-09T17:52:41.273

先前关于删除或删除连接的评论绝对是一种可能性。但是，当您尝试调用使用项目级连接（而不是包级连接）的包时，您也可能会收到此错误。

如果您正在使用项目级连接并且仍想使用 dtexec，请不要担心有办法。我不建议将它们转换为包级连接（假设您出于充分的理由将它们创建为项目级连接）。

您将需要部署您的 SSIS 项目。您的 SSIS 服务器需要创建一个目录 ( [https://msdn.microsoft.com/en-us/library/gg471509.aspx](https://msdn.microsoft.com/en-us/library/gg471509.aspx) )。获得目录后，在 SSIS 项目中选择 Project->Deploy 并按照向导进行操作。结果将是在您的 SSIS 解决方案文件夹/bin/Development 中生成的 *.ispac 文件

现在使用 money 命令，而不是使用简单的调用包：dtexec.exe /f "package.dtsx"

而是这样称呼它： dtexec.exe /project "<...>/project.ispac" /package "<...>/package.dtsx"

ispac 文件包含执行包所需的项目级连接信息，您应该进行设置！

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-12-16T12:02:18.810

就我而言，我发现问题是先前配置的日志提供程序指向不再使用的旧连接。要解决此问题，请单击 Package Explorer 选项卡，然后单击 Log Providers 并删除过时的 Log Provider。我希望这可以帮助别人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-05T16:21:42.143

我为解决这个问题所做的事情很简单。我不得不重命名我的 SQL Server 以便它响应 (localhos) 标记。之后，我更改了 SSIS 上的所有连接并重建了解决方案……它起作用了。希望对你有帮助

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-10-28T15:06:16.717

周五包裹工作正常，签到 TFS 并回家。星期一打开它，到处都是错误。“在变量集合中找不到连接管理器变量 $project._connectionstring”。

我 rtclick-edit 连接并测试连接，没有问题。ConnMnger 位于解决方案的连接管理器列表中。打开连接到这个连接管理器的TARGET对象，点击MAPPINGS，就会弹出上面的错误。映射中的任何地方都没有对连接管理器变量的引用。

事实证明，要更正此问题，您必须在 Connection Manager 窗口中右键单击连接管理器并选择 PARAMETERIZE。根据需要填写选项 -

属性：ConnectionString 使用现有参数：$Project::ConnMgrName_ConnectionString 或创建新参数：遵循选项

一旦这个连接管理器被参数化，一切正常。尽管 Conn Manger 存在于 Conn Manger 选项卡中，但 Conn Mgr 已在解决方案资源管理器中列出，并且在 2 天前没有问题。

奇怪的。任何。微软就是微软。SQL Server 是 SQL Server。选择你的毒药。

希望这有助于下一个人节省一些时间。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-11-14T19:13:42.537

我有同样的问题，以上都没有解决。原来有一个旧的 sql 任务在我的 ssis 的右下角被禁用，我真的必须寻找才能找到。一旦我删除了这一切都很好

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-06T07:17:18.547

就我而言，其中一个事件处理程序任务指向已删除的旧连接，删除未使用的事件处理程序任务解决了问题。我最终以 XML 格式打开包，以了解问题出在事件处理程序任务上！

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-05-06T15:43:01.513

就我而言，我可以用更简单的方式解决这个问题。我打开了 x.dtsConfig 存档，但由于未知原因，该存档不是标准格式，因此 ssis 无法识别配置。幸运的是，我之前已经备份了存档，所以我只需将其复制到原始文件夹，一切都恢复正常了。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-07-28T19:30:04.667

我在尝试使用 SSDT 2013 在 VS 中打开 SSDT 2010/SSIS 2012 项目时收到此错误。当它打开项目时，它要求迁移所有包。当我允许它继续时，每个包都因这个错误和其他错误而失败。我发现绕过转换只单独打开每个包，打开时包就升级了，它转换得很好并成功运行。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-08-17T09:29:53.927

在我的情况下我遇到了同样的问题，原因是连接没有嵌入并且 Oracle 客户端不兼容。

**解决方案：**

我的环境：SQL SERVER 2014 64bit Oracle Client 32 位

1.  对于包含/嵌入连接

    *   开包
    *   右键单击连接
    *   选择“转换为项目”选项
2.  对于 SQL SSIS 目录/作业计划设置配置按照图片中的步骤

    *   右键“SQL JOB->Step”或“SSIS Catalog-->Package-->Execute”并选择“Properties”
    *   选择配置-->高级选项卡
    *   检查 32 位运行时

我试图逐步发布详细的图片，但由于声誉原因，Stack Overflow 不允许这样做。希望我以后会更新这篇文章。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2015-11-03T14:17:57.790

这个解决方案对我有用：

转到 SQL Server Management Studio，右键单击失败的步骤并选择 Properties -> Logging -> Remove the Log Provider，然后重新添加它

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-10-27T12:26:39.500

通过识别失败的特定连接，我确定这个问题是一个损坏的连接管理器。我在 SQL Server 2016 中工作，我已经创建了 SSISDB 目录，我正在那里部署我的项目。

这是简短的答案。删除连接管理器，然后使用相同的名称重新创建它。确保使用该连接的软件包仍然正确连接，你应该一切顺利。如果您不确定如何执行此操作，我在下面提供了详细过程。

为了识别损坏的连接，我执行了以下操作。在 SSMS 中，我打开了 Integration Services Catalogs 文件夹，然后是 SSISDB 文件夹，然后是我的解决方案的文件夹，直到找到该项目的包列表。

通过右键单击失败的包，转到报告>标准报告>所有执行，选择最后一次执行，并查看“所有消息”报告，我能够隔离哪个连接失败。就我而言，连接管理器到我的目的地。我只是删除了连接管理器，然后重新创建了一个具有相同名称的新连接管理器。

随后，我进入我的包，打开数据流，发现我的一些目的地已经亮起了红色的X。我打开目的地，重新选择正确的连接名称，重新选择目标表，并检查映射仍然正确。我有六个目的地，只有三个有红色 X，但我单击了所有目的地并确保它们仍然配置正确。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2017-04-11T17:23:47.083

我通常发现，当 SSIS 似乎不合理地抱怨明显良好的连接时，这是因为我试图直接使用包变量而不是通过连接管理器来定义连接。示例：今天我有一个 Web 服务任务，我犯了一个错误，即直接创建一个表达式，根据包含 Web 服务 URL 的包变量定义其“连接”属性。但是请注意，Connection 与 ConnectionString 不同！因此，当我查看该任务时，它会寻找所有的世界，就像它拥有一切有效的东西一样，因为它显示了一个完全有效的 URL 作为“连接”。问题是 Connection 不能是字符串；它必须是连接管理器。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-06-25T15:09:05.987

作业中的连接值似乎区分大小写。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-07-09T15:27:17.720

对于在 Visual Studio 2015 中开发的包，我发现我必须为设置连接管理器的连接字符串而不是使用设计时值的参数提供一个值（当您在不同的服务器上部署或运行​​时会出现这种情况）。这将抑制错误消息。我认为这可能是一个错误。

```
dtexec /project c:\mypath\ETL.ispac /package mypackage.dtsx /SET \Package.Variables[$Project::myParameterName];"myValueForTheParameter" 
```

我在没有或没有参数化连接字符串的情况下对此进行了测试，这是在项目级别。结果是一样的：即我必须设置参数的值，即使它没有被使用。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2018-08-27T09:50:52.067

我有同样的问题。

我使用项目级连接管理器，并且我的包在 SSDT 中正确运行，但是当我部署它们并通过使用 sql server 代理的作业执行它们时，出现“找不到连接”错误。

所以我部署了项目，然后问题就解决了，当你使用项目级连接管理器但只从该项目部署一个包，并且你通过 sql server 代理调用包时，它无法识别你的连接管理器，所以你应该确定包级别的连接管理器，或者您应该首先部署您的项目。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2019-10-02T09:24:33.243

这发生在我身上：不是由我创建的 SSIS 包在某些时候开始出现意外行为，例如给出 Connection not found -error，但我的任务是修复它。当我查看 SQL 代理作业下的作业步骤属性时，它显示没有正在使用的配置，并且数据源与它们应该是一样的。但是，错误消息指出了一些不同的东西。然后我打开有问题的 .dtsx 文件并注意到有包 conf。设置并在该包 conf. 文件是连接名称设置错误。所以我的建议是并排比较 .dtsx 和 .dtsConfig -files。

# javascript - Node.js - 从 JSON 对象中删除空元素

> ID：11874724
> 
> 赞同：8
> 
> 时间：2012-08-08T23:30:23.347
> 
> 标签：javascript, json, node.js

我正在尝试从 JSON 对象中删除空/空元素，类似于 python webutil/util.py -> trim_nulls 方法的功能。我可以使用 Node 内置的东西，还是自定义方法。

例子：

```
var foo = {a: "val", b: null, c: { a: "child val", b: "sample", c: {}, d: 123 } }; 
```

预期结果：

```
foo = {a: "val", c: { a: "child val", b: "sample", d: 123 } }; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-08T23:38:18.010

我不知道为什么人们会赞成我原来的答案，这是错误的（我猜他们看起来太快了，就像我一样）。无论如何，我不熟悉节点，所以我不知道它是否包含一些东西，但我认为你需要这样的东西才能在直接的 JS 中做到这一点：

```
var remove_empty = function ( target ) {

  Object.keys( target ).map( function ( key ) {

    if ( target[ key ] instanceof Object ) {

      if ( ! Object.keys( target[ key ] ).length && typeof target[ key ].getMonth !== 'function') {

        delete target[ key ];

      }

      else {

        remove_empty( target[ key ] );

      }

    }

    else if ( target[ key ] === null ) {

      delete target[ key ];

    }

  } );

  return target;

};

remove_empty( foo ); 
```

我没有用数组尝试这个`foo`——可能需要额外的逻辑来以不同的方式处理它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-03-07T08:35:41.447

你可以这样使用：

```
Object.keys(foo).forEach(index => (!foo[index] && foo[index] !== undefined) && delete foo[index]); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2021-04-14T03:18:11.157

你可以使用这个：

```
let fooText = JSON.stringify(foo);

let filteredFoo = JSON.parse(objectLogText, (key, value) => {if(value !== null) return value}); 
```

[JSON.parse() 文档](https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-08-09T00:47:05.090

感谢所有帮助.. 我使用所有与 foo 一起使用的评论中的反馈拼凑了以下代码。

```
function trim_nulls(data) {
  var y;
  for (var x in data) {
    y = data[x];
    if (y==="null" || y===null || y==="" || typeof y === "undefined" || (y instanceof Object && Object.keys(y).length == 0)) {
      delete data[x];
    }
    if (y instanceof Object) y = trim_nulls(y);
  }
  return data;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-12-06T17:05:08.093

我发现这是最优雅的方式。此外，我相信 JS 引擎已针对它进行了大量优化。

> 使用内置`JSON.stringify(value[, replacer[, space]])`功能。文档在[这里](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify)。

示例是在从外部 API 检索一些数据、相应地定义一些模型、获取所有无法定义或不需要的所有内容的结果和截断的上下文中：

```
function chop (obj, cb) {
  const valueBlacklist = [''];
  const keyBlacklist = ['_id', '__v'];

  let res = JSON.stringify(obj, function chopChop (key, value) {
    if (keyBlacklist.indexOf(key) > -1) {
      return undefined;
    }

    // this here checks against the array, but also for undefined
    // and empty array as value
    if (value === null || value === undefined || value.length < 0 || valueBlacklist.indexOf(value) > -1) {
      return undefined;
    }
    return value;
 })
 return cb(res);
} 
```

在您的实施中。

```
// within your route handling you get the raw object `result`
chop(user, function (result) {
   var body = result || '';
   res.writeHead(200, {
      'Content-Length': Buffer.byteLength(body),
      'Content-Type': 'application/json'
   });
   res.write(body);
   // bang! finsihed.
   return res.end();
});

// end of route handling 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-08T23:43:30.397

您可以使用`for`循环过滤并输出到新的干净对象：

```
var cleanFoo = {};
for (var i in foo) {
  if (foo[i] !== null) {
    cleanFoo[i] = foo[i];
  }
} 
```

如果您也需要处理子对象，则需要递归。

# macos - NSTableView reloadData 内存泄漏

> ID：11874726
> 
> 赞同：0
> 
> 时间：2012-08-08T23:30:30.553
> 
> 标签：macos, memory-leaks, nstableview, nsautoreleasepool

我一直在使用 Instruments 应用程序检查我的应用程序是否存在泄漏。在某些情况下，HUD 面板中的表格视图每秒更新一次。除了每秒（reloadData） _NSArrayl 对象的数量增加一之外，一切正常。如果我将数据源更改为 return(@""); （它们都是文本单元格）然后问题仍然存在（没有变化）。如果我将所有周围的代码删除为：

```
[myTableView reloadData]; 
```

和

```
- (id)tableView:(NSTableView *)tv objectValueForTableColumn:(NSTableColumn *)column row:(int)rowIndex {
   return(@"");
} 
```

（甚至返回零）

问题仍然存在。注释掉 [myTableView reloadData]，问题就消失了。每个块都是一个 _NSarrayl，大小为 32 字节，详细信息：

```
 0 libsystem_c.dylib calloc
   1 libobjc.A.dylib class_createInstance
   2 CoreFoundation __CFAllocateObject2
   3 CoreFoundation +[__NSArrayI __new::]
   4 CoreFoundation -[__NSPlaceholderArray initWithObjects:count:]
   5 CoreFoundation +[NSArray arrayWithObjects:]
   6 AppKit -[NSWindow _runLoopModesForInvalidCursorRectsObserver]
   7 AppKit __-[NSWindow _postInvalidCursorRects]_block_invoke_1
   8 CoreFoundation __CFRUNLOOP_IS_CALLING_OUT_TO_AN_OBSERVER_CALLBACK_FUNCTION__
   9 CoreFoundation __CFRunLoopDoObservers
  10 CoreFoundation __CFRunLoopRun
  11 CoreFoundation CFRunLoopRunSpecific
  12 HIToolbox RunCurrentEventLoopInMode
  13 HIToolbox ReceiveNextEventCommon
  14 HIToolbox BlockUntilNextEventMatchingListInMode
  15 AppKit _DPSNextEvent
  16 AppKit -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:]
  17 AppKit -[NSApplication run]
  18 AppKit NSApplicationMain 
```

我注意到这些对象的历史记录中有一个 Autorelease 条目，所以我想知道它是否已被自动释放（保留计数仍为 1）。但是 5 分钟后，没有任何东西释放它们，所以可能自动释放池没有被释放。我不创建任何自动释放池（也不释放任何），而是留下应用程序框架。我应该对自动释放池做些什么吗？

```
#   Address Category    Event Type  RefCt   Timestamp   Size    Responsible Library Responsible Caller
0   0x100669cf0 __NSArrayI  Malloc  1   00:01.342.634   32  AppKit  -[NSWindow _runLoopModesForInvalidCursorRectsObserver]
1   0x100669cf0 __NSArrayI  Autorelease <null>  00:01.342.636   0   AppKit  -[NSWindow _runLoopModesForInvalidCursorRectsObserver] 
```

任何关于我可能做错了什么的建议将不胜感激。

请注意，1秒更新的情况对于应用程序来说不是“正常情况”，但它可能会发生，然后应用程序设计了很长时间；即不是您运行、退出、再次运行、退出等的应用程序。

它们没有被检测为“泄漏”，但分配计数一直在增加，所以我认为它们在实践中是泄漏（或出现问题）

我没有使用 ARC 而不是“垃圾收集”——只是保留/释放系统，我倾向于使用保留/释放，而我自己的代码只是偶尔使用自动释放，并且与此代码无关。

附加信息：我一直在看着计数增加，只使用 Instruments 应用程序（表格视图位于始终可见的 HUD 中）。但是，如果我将鼠标移到“泄漏”的 tableview 上 - 计数会回到合理的值。在屏幕上稍微移动包含 tableview 的 HUD 窗口，计数会回落，等等。似乎是缺少用户活动导致这种情况发生。我仍然很困惑，但认为这个新的观察可能有助于想法（或者如果有人试图重现它）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-08T23:43:03.947

代码本身不会泄漏。但是可能发生的是外部自动释放池没有耗尽。这在 AppKit 中是一件棘手的事情：AppKit 运行循环会自动添加一个自动释放池，但只会在它接收到事件（即您移动鼠标）时将其耗尽。

您可以通过激活应用程序并移动鼠标然后再次尝试泄漏来确认这一点。

这意味着，一般来说，在您的自定义非事件驱动回调中添加您自己的自动释放池是一个好主意。一些基本的 Foundation 机制已经为您完成了这项工作（例如，NSTimer 在触发之前为您创建了一个池并在之后将其排出），但并非一切都为您完成。

在这种特殊情况下，您似乎对该特定​​回调没有太多控制权，因此：

1）考虑在运行泄漏之前对您的应用程序进行处理

2) 可能向 Apple 提交错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T09:29:29.117

****更新和后续问题（抱歉） **** 根据您的建议，我在 [myTableView reloadData] 下方添加了一些内容，以向应用程序发布一个虚拟/无害的消息（看起来比直接发布到相关窗口更安全）。**

 **```
NSEvent *dummyEvent=[NSEvent mouseEventWithType:NSMouseMoved location:NSMakePoint(0.0,0.0) modifierFlags:0 timestamp:0.0 windowNumber:0 context:nil eventNumber:0 clickCount:0 pressure:0.0];
[NSApp postEvent:dummyEvent atStart:FALSE]; 
```

我的想法是添加在表格视图完成所有内容之后会发生的事情（基本上是当事件队列变空时。这看起来像是用户在做某事。只要不断增加的分配计数不再增加，它似乎就可以工作（按预期移动了一点，但基本稳定）。

但是，我对事件做的不多，并且担心我的“dummyEvent”可能不是无害的，或者将来可能会开始引起问题。有没有更好的方法来实现这一点，或者我应该使用更好的事件（或参数）？

我确实尝试过

```
NSEvent *dummyEvent=[NSEvent otherEventWithType:NSApplicationDefined location:NSMakePoint(0.0,0.0) modifierFlags:0 timestamp:0.0 windowNumber:0 context:nil subtype:(short)(0) data1:0 data2:0]; 
```

但我对此不太信任，因为我没有自定义事件处理程序，并且不确定它最终会在哪里结束。另外，我第一次使用此变体也遇到了地址违规 - 但我想知道这是否是其他事情，因为它没有再次发生。只要我的参数都不会导致崩溃/断言失败或类似情况，我可以看到虚拟鼠标移动是如何无害的。**

# jquery - jQuery Mobile 后退按钮不返回（并且没有 href 不响应）

> ID：11874727
> 
> 赞同：1
> 
> 时间：2012-08-08T23:30:38.063
> 
> 标签：jquery, jquery-mobile, pushstate

我有以下标题：

```
<div data-theme="b" data-role="header" data-add-back-btn="true" data-back-btn-text="Back" data-position="fixed">
    <h3>Title</h3>

    <a data-role="button" data-transition="fade" data-theme="c" data-rel="back" href="" data-direction="reverse"
        data-icon="arrow-l" data-iconpos="left" class="ui-btn-left"
    > Back </a>

    <a data-role="button" data-transition="fade" data-theme="c"
        href="#page2" data-icon="arrow-r" data-iconpos="right"
        class="ui-btn-right ui-disabled"
    > Next </a>
</div> 
```

后退按钮不会返回。如果我将它设置为`""`or `"#"`，它会重定向到我的主页。如果我没有该`href`属性，则单击该按钮不会执行任何操作。

我在这里做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:51:18.623

您在`data-role="header"`元素的上下文中进行操作，因此添加`data-add-back-btn="true"`应该足以添加后退按钮。

我的猜测是 jQM 不希望看到另一个带有标题的后退按钮 - 因此没有正确增强它。尝试删除`data-add-back-btn="true"`或您的自定义后退按钮，两者都可能是问题。

在正常情况下，`href`不需要设置 an，您应该可以将其设置为 '#'。只要您有`data-rel="back"`，jQM 就应该为您处理这些功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T16:51:13.393

如有疑问，请回归基础。

```
 events : {
        "click .back" : "back"
    },

    back : function() {
        window.history.back();
    }, 
```

# android - 根据显示标题的长度动态定位 ActionBar Spinner 的右角箭头

> ID：11874734
> 
> 赞同：5
> 
> 时间：2012-08-08T23:32:16.673
> 
> 标签：android, android-actionbar, android-ui, android-spinner

在 Google+ 应用程序中，右上角箭头的位置会`ActionBar` `Spinner`适应当前显示的字符串的长度。例如，选择*Family*时 Spinner 的长度似乎比选择 Acquaintances 时*短*。

我该怎么做才能让右角箭头根据标题的长度动态定位？我的猜测是我可以在*styles.xml*中设置一个属性来为我做这件事。

这是我的styles.xml：

```
<style name="MyStyle" parent="android:style/Theme.Holo">
    <item name="android:actionDropDownStyle">@style/MyDropDownNav</item>
</style>

<style name="MyDropDownNav" parent="android:style/Widget.Holo.Spinner">
    <item name="android:AttributeHere">AttributeValue</item>
</style> 
```

这是我在 MainActivity.java 中的代码：

```
ActionBar actionBar = getActionBar();
actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);

// Specify a SpinnerAdapter to populate the dropdown list.
SpinnerAdapter dataAdapter = new ArrayAdapter<String>(
        actionBar.getThemedContext(),
        android.R.layout.simple_list_item_1, android.R.id.text1,
        new String[] { "AAAAAAAAAAAAAAA", "BB" });

// Set up the dropdown list navigation in the action bar.
actionBar.setListNavigationCallbacks(dataAdapter, this); 
```

与 Google+ 不同，我的右上角箭头的位置始终是固定的。因此，如果我从下拉列表中选择“AAAAAAAAAAAAAAA”到“BB”，箭头根本不会移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-14T02:28:10.677

请参考 android pure 的代码`Calendar`，在它的适配器中，`getView()`总是返回当前项，`Calendar`使得 的宽度`Spinner`等于当前项。实际上，`Spinner`宽度`ActionBar`总是计算为其最长项目的长度。`Calendar`在这里做了一些特殊的过程。

# java - java多线程 - 子线程不会立即启动

> ID：11874735
> 
> 赞同：0
> 
> 时间：2012-08-08T23:32:43.537
> 
> 标签：java, multithreading

我正在学习java中的MULTITHREADING，我想知道为什么在下面的代码中，当执行start方法调用子线程中的run方法时，子线程没有立即运行？

相反，在执行 start 方法后，主线程继续执行其代码并开始打印“.”。它做了三遍，控制权由子线程接管。然后子线程执行一次它的代码并返回到主线程。然后主线程完成，然后子线程也完成其执行。

我无法理解为什么会这样？

```
class MyThread implements Runnable {

    String thrdName;

    MyThread(String name) {
        thrdName = name;
    }

    public void run() {
        System.out.println(thrdName + " starting.");
        for (int count = 0; count < 10; count++) {
            System.out.println("In " + thrdName + ", count is " + count);
        }
    }
}

class UseThreads {

    public static void main(String args[]) {
        System.out.println("Main thread starting.");
        MyThread mt = new MyThread("Child #1");
        Thread newThrd = new Thread(mt);
        newThrd.start();
        for (int i = 0; i < 50; i++) {
            System.out.print(".");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:33:52.977

当你调用`start()`你的线程时，你无法保证它会以多快的速度启动。这取决于您计算机的线程调度程序。如果您多次运行代码，您的线程可能会得到几个不同的执行顺序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T23:35:53.113

开始线程的调用是异步的。它不会等到线程开始运行才返回；它基本上立即返回。

您可以自己实现该行为，并带有一点锁定，这样您的主线程就会暂停，直到您开始的线程发出某种信号，以表明它已经开始执行。

# sql - 返回重复的值

> ID：11874737
> 
> 赞同：0
> 
> 时间：2012-08-08T23:32:57.233
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我正在尝试根据以下内容获取所有重复的记录：

```
accession_id, 
  check_num,
  procedure_code,
  paid_amt, 
```

此查询将返回上述内容以及这些字段重复的次数。

但是，我只想返回不止一次发生的那些。

```
 select    
  ACCESSION_PAYMENTS_DAILY_KEY, 
  accession_id, 
  check_num,
  procedure_code,
  paid_amt,
  row_number() 
  over 
  (partition by   accession_id, check_num,procedure_code,paid_amt order by ACCESSION_PAYMENTS_DAILY_KEY) as occurrence
          from      [MILLENNIUM_DW_DEV].[dbo].[F_PAYOR_PAYMENTS_DAILY]         
   where PROCEDURE_CODE is not null
   and PAID_AMT>0 
```

当我将过滤条件添加`occurrence>1`到上述查询时，我收到此错误：

```
Msg 207, Level 16, State 1, Line 13
Invalid column name 'occurrence'. 
```

如果记录不止一次，我如何才能返回记录？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:38:26.173

如果要在`WHERE`子句中使用别名，则可以将其包装在另一个`SELECT`语句中。

```
SELECT *
FROM
(
  select ACCESSION_PAYMENTS_DAILY_KEY, 
    accession_id, 
    check_num,
    procedure_code,
    paid_amt,
    row_number() over (partition by   accession_id, check_num,procedure_code,paid_amt order by ACCESSION_PAYMENTS_DAILY_KEY) as occurrence
  from      [MILLENNIUM_DW_DEV].[dbo].[F_PAYOR_PAYMENTS_DAILY]         
  where PROCEDURE_CODE is not null
     and PAID_AMT>0
) x
WHERE x.occurrence>1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T00:16:06.657

也许您应该尝试使用 GROUP BY / HAVING 子句：

```
SELECT accession_id, check_num, procedure_code, paid_amt,
       COUNT(ACCESSION_PAYMENTS_DAILY_KEY) as occurrences 
FROM [MILLENNIUM_DW_DEV].[dbo].[F_PAYOR_PAYMENTS_DAILY] 
GROUP BY accession_id, check_num, procedure_code,paid_amt 
HAVING COUNT(ACCESSION_PAYMENTS_DAILY_KEY) > 1 
```

HAVING 子句过滤 GROUP BY 之后的记录

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T05:27:15.720

我*不*知道你的表是如何被索引的，但是自左连接呢？它可能值得测试，但我无法想象它比上述任何一种方法都快。我什至不会尝试这个，除非 accession_id 和 check_num 被索引......

```
Select
  t1.*
from [MILLENNIUM_DW_DEV].[dbo].[F_PAYOR_PAYMENTS_DAILY] as t1
left join [MILLENNIUM_DW_DEV].[dbo].[F_PAYOR_PAYMENTS_DAILY] as t2
  on t2.accession_id = t1.accession_id
  and t2.check_num = t1.check_num
  and t2.procedure_code = t1.procedure_code
  and t2.paid_amt = t1.paid_amt
where t2.ACCESSION_PAYMENTS_DAILY_KEY is null 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-09T06:27:17.213

试试这个：

```
select accession_id, 
    check_num,
    procedure_code,
    paid_amt,
    COUNT(*) as occurrance
  from      [MILLENNIUM_DW_DEV].[dbo].[F_PAYOR_PAYMENTS_DAILY]         
  where PROCEDURE_CODE is not null
     and PAID_AMT>0
     group by  accession_id,check_num,procedure_code,paid_amt
     having COUNT(*) > 1 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-09T06:48:49.293

也许是一个替代...

```
;WITH MoreOne_CTE()
    AS
    (
    SELECT       
        ACCESSION_PAYMENTS_DAILY_KEY   
    FROM  [MILLENNIUM_DW_DEV].[dbo].[F_PAYOR_PAYMENTS_DAILY]     
    GROUP BY 
          accession_id,    
          check_num,   
          procedure_code,   
          paid_amt
    HAVING  COUNT(*) > 1     
    )
SELECT       
        ACCESSION_PAYMENTS_DAILY_KEY ,    
        accession_id,    
        check_num,   
        procedure_code,   
        paid_amt           
FROM [MILLENNIUM_DW_DEV].[dbo].[F_PAYOR_PAYMENTS_DAILY]   x  
WHERE
        PROCEDURE_CODE IS NOT NULL
        AND PAID_AMT>0 
        AND EXISTS 
            (
                    SELECT 1 
                    FROM MoreOne_CTE y 
                    WHERE x.ACCESSION_PAYMENTS_DAILY_KEY = y.ACCESSION_PAYMENTS_DAILY_KEY
            ) 
```

# opengl - `GLfloat` 和 `cl_float` 是否保证具有相同的大小？

> ID：11874739
> 
> 赞同：3
> 
> 时间：2012-08-08T23:33:04.640
> 
> 标签：opengl, floating-point, opencl, sizeof

使用 OpenGL 分配 VBO 后，我使用[`clCreateFromGLBuffer`](http://www.khronos.org/registry/cl/sdk/1.0/docs/man/xhtml/clCreateFromGLBuffer.html).

我将 VBO 用作数组，`GLfloat`将 OpenCL 缓冲区用作`cl_float`. 它在我的机器上完美运行。确实，`GLfloat`和`cl_float`(and `float`) 具有相同的大小。

我想知道这是否可以完美地工作。换句话说，`sizeof(GLfloat) == sizeof(cl_float)`总是正确的？^*如果不是，通常如何处理这个问题？

^(* 是否有文件证明这一点)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T04:30:47.167

是的，如果您查看 CL 和 GL 标头，您会得到：

```
typedef float cl_float;          // @cl_platform.h
typedef float GLfloat;           // @gl.h 
```

请注意，在某些 GL 实现中，您会得到类似的中间类型定义`khronos_float_t`，但最终归结为`float`类型。所以这两种类型都与您的本机浮点类型相同。[此外， OpenCL 内核](http://www.khronos.org/registry/cl/sdk/1.0/docs/man/xhtml/scalarDataTypes.html)和[OpenGL 着色器](http://www.opengl.org/registry/specs/ARB/shader_precision.txt)中的等效数据类型都保证符合 IEEE754。

相关标头的链接：[cl_platform.h](http://www.khronos.org/registry/cl/api/1.1/cl_platform.h)和 GL 标头取决于您从哪里获得它（它们从操作系统到操作系统以及从供应商到供应商略有不同），看看你的。示例：[gl.h](http://www.khronos.org/registry/gles/api/1.1/gl.h)（GLES 版本）、[gl.h](ftp://download.nvidia.com/freebsd/71.86.13/README/gl.h)（FreeBSD nVidia 版本）、[gl.h](http://www.cs.unm.edu/~angel/BOOK/INTERACTIVE_COMPUTER_GRAPHICS/SIXTH_EDITION/CODE/include/GL/gl.h)（一些随机版本）。

# javascript - GET请求在javascript到NodeJS

> ID：11874746
> 
> 赞同：0
> 
> 时间：2012-08-08T23:33:33.347
> 
> 标签：javascript, jquery, node.js, get, request

我正在尝试从网络上的 javascript 代码到 Node.js 中的服务器进行简单的连接（请求 - 响应）。

我试图提出[如下](https://stackoverflow.com/a/4033310/1374493)请求：

```
var request = new XMLHttpRequest();
request.open('GET', 'http://localhost:4444/', false);
request.send(); 

if (request.status === 200) {
  console.log(request.responseText);
} 
```

[运行此代码我在FireBug](http://img706.imageshack.us/img706/654/capturatl.png)中遇到错误

我继续搜索，我发现这个方法只是在同一个域上发出 GET 请求。要进行跨域请求，我们必须使用其他策略。

我找到了一个[jQuery 方法](https://stackoverflow.com/a/247511/1374493)，看来我走对了：

```
$.get(
    'http://localhost:4444/',
    function(data) {
        alert("sucess"); 
        //Do anything with "data"
    }
); 
```

在这种情况下，我得到相同的响应[而没有错误](http://img213.imageshack.us/img213/3261/captura2zo.png)。

它似乎有效，但从未显示“警报”消息！发生什么了？我究竟做错了什么？

Node.js 服务器代码是：

```
var http = require("http");

http.createServer(function(request, response) {
    response.writeHead(200, {"Content-Type": "text/html"});
    response.write("Response");
    response.end();
}).listen(4444); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:45:41.443

所以你遇到了跨域问题。你有几个选择：

1）由于您使用的是节点，请使用 socket.io 。它是跨域兼容的。

在客户端：

```
<script src="Full path to were socket IO is held on your server//socket.io.js"></script>
<script>
    var socket = io.connect();

    socket.on('some_callback', function(data){
        // receive data
    });

    socket.emit('some_other_callback', {'data': value}); //send data
</script> 
```

服务器：

```
var io = require('socket.io').listen(server);

// define interactions with client
io.sockets.on('connection', function(socket){
    //send data to client
    socket.emit('some_callback', {'data': value});

    //recieve client data
    socket.on('some_other_callback', function(data){
        //do something
    }); 
}); 
```

2）既然你只想使用 GET 你可以使用 JSONP

```
$.getJSON('url_to_your_domain.com/?callback=?&other_data=something,
    function(data){
        //do something
    }
); 
```

在这里，我们传递您的正常 GET 参数以及 callback=?。您将从您的服务器返回以下内容：

```
require('url');
var r = url.parse(req.url,true);
r.query.callback + '(' + some JSON + ')' 
```

3）如果您不关心所有浏览器兼容性，您可以使用 CORS：您可以看到一个比我能在[这里写的更好的示例](http://www.nczonline.net/blog/2010/05/25/cross-domain-ajax-with-cross-origin-resource-sharing/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:41:20.307

跨域 ajax 需要您的服务器的特殊支持。

要么 CORS：[http](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing) ://en.wikipedia.org/wiki/Cross-origin_resource_sharing 并非所有浏览器都支持。它涉及请求和响应中的特殊标头，告诉浏览器允许一个域与另一个域进行通信，以及哪些数据。

或 JSONP：[http](http://en.wikipedia.org/wiki/JSONP) ://en.wikipedia.org/wiki/JSONP WHich 可以在任何地方工作，但有一些实现限制。它涉及服务器将响应包装在 javascript 函数回调中，该回调将执行并传入您想要的数据。

无论哪种方式，都需要为这些方法中的每一种设置服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T23:39:51.303

我认为您的问题是[Same Origin Policy](http://en.wikipedia.org/wiki/Same_origin_policy)。您的浏览器**必须**从 node.js 实例获取网页。

否则，您必须使用类似[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)的东西。SO上也有很好的问题：[绕过同源政策的方法](https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy)。

# php - 正确使用地穴？

> ID：11874753
> 
> 赞同：1
> 
> 时间：2012-08-08T23:34:28.157
> 
> 标签：php, hash, passwords

因此，在对此进行了相当多的研究之后，我想知道这是否是最佳实践方式。

当我将用户的密码发送到数据库时，我正在这样做：

```
// DB input:

$mySalt = time(); // generate random salt such as a timestamp
$password = crypt($_POST['password'], $mySalt);
// submit $password and $mySalt to DB here via PDO 
```

当我在登录时检查密码时，我正在这样做：

```
// At login:

// retrieve the password and the salt from the DB
if(crypt($_POST['password'], $saltFromDb) === $passFromDb)
// allow login 
```

这是正确的方法还是我错过了什么？谢谢你的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:41:58.870

相反，您需要使用 crypt 中提供的内置加盐和散列函数。下面是一个使用好的散列算法调用 blowfish (bcrypt) 的示例：[How do you use bcrypt for hashing passwords in PHP?](https://stackoverflow.com/questions/4795385/how-do-you-use-bcrypt-for-hashing-passwords-in-php)

在这种情况下，算法越慢越好。

从 DB 获取它时，您只需使用`crypt()`评估整个字符串来了解它是否验证为正确的密码等。

# postgresql - 消除 Ubuntu 10.04 上的非工作 PostgreSQL 安装并重新开始

> ID：11874754
> 
> 赞同：4
> 
> 时间：2012-08-08T23:34:50.267
> 
> 标签：postgresql, ubuntu, purge

我发现我在 Ubuntu 10.04 上有两个旧 PostgreSQL 安装的残骸：

```
$ pg_lsclustersVersion Cluster   Port Status Owner    Data directory                     Log file
Use of uninitialized value in printf at /usr/bin/pg_lsclusters line 38.
8.4     main      5432 down   /var/lib/postgresql/8.4/main /var/log/postgresql/postgresql-8.4-main.log  
Use of uninitialized value in printf at /usr/bin/pg_lsclusters line 38.
9.1     main      5433 down   /var/lib/postgresql/9.1/main /var/log/postgresql/postgresql-9.1-main.log  
$ 
```

尝试执行基本功能会返回错误，例如：

```
createuser: could not connect to database postgres: could not connect to server: No such file or directory
    Is the server running locally and accepting
    connections on Unix domain socket "/var/run/postgresql/.s.PGSQL.5432"? 
```

当我尝试启动数据库服务器时，会出现更多信息：

```
$ sudo /etc/init.d/postgresql start 
 * Starting PostgreSQL 9.1 database server
 * Error: The cluster is owned by user id 109 which does not exist any more
   ...fail!
$ 
```

我的问题：如何完全删除两个集群并设置一个新集群？`postgresql`我已经按照以下建议尝试删除、清除和重新安装： [https](https://stackoverflow.com/a/2748644/621762) ://stackoverflow.com/a/2748644/621762 。现在`pg_lsclusters`显示不存在集群，但是`No such file or directory`当我尝试或运行`createuser`时错误仍然存​​在。我做错了什么？`createdb``psql`

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-08-09T00:48:54.860

首先，您链接的那个答案非常不安全-手动编辑`/etc/passwd`？！？`dselect`通配符在哪里`apt`？疯狂的事情。我对你有问题并不感到惊讶。

至于`no such file or directory`消息：您需要确保您有一个正在运行的 PostgreSQL 服务器（“集群”），然后才能使用类似的管理命令`createdb`，因为它们会连接到服务器。该`No such file or directory`消息告诉您服务器不存在或未运行。

这是正在发生的事情：

Ubuntu 用于[`pg_wrapper`](http://manpages.ubuntu.com/manpages/precise/man1/pg_wrapper.1.html)管理多个并发 PostgreSQL 实例。您遇到的问题确实与`pg_wrapper`.

理想情况下，您只是用来`pg_dropcluster`摆脱不需要的集群。不幸的是，听从了不好的建议，听起来你的系统有点混乱，PostgreSQL 软件包安装了一半并且有点混乱。您需要修复安装，或完全清除它。

我会把它清理干净。我建议：

*   验证`pg_lsclusters`没有列出任何数据库集群
*   `apt-get --purge remove postgresql\*`- 这很*重要*
*   消除`/etc/postgresql/`
*   消除`/etc/postgresql-common`
*   消除`/var/lib/postgresql`
*   `userdel -r postgres`
*   `groupdel postgres`
*   `apt-get install postgresql-common postgresql-9.1 postgresql-contrib-9.1 postgresql-doc-9.1`

该`apt-get --purge`步骤可能会失败，因为您已删除用户 ID 等。重新创建`postgres`用户 ID`useradd -r -u 109 postgres`应该允许您成功重新运行清除，然后删除用户。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-01-02T21:46:34.097

这个答案不是直接关于删除 postgres 实例，而是关于解决问题，

```
Error: The cluster is owned by user ... 
```

我在尝试启动指向通过不同容器（在不同主机上）生成的 postgres 数据目录的 docker 容器时遇到此错误。

该错误与目录所有权直接相关。就我而言，系统无法在当前环境中找到某些 postgres 目录所拥有的用户。通过将这些目录重新拥有给正确的用户可以解决问题。以下是一个示例映射（对我有用）：

```
chown -R postgres:postgres /var/lib/postgresql
chown -R postgres:postgres /etc/postgresql
chown -R postgres:postgres /var/log/postgresql
chown -R postgres:postgres /var/run/postgresql 
```

# sql-server-2008 - sql server 2008 分区

> ID：11874760
> 
> 赞同：0
> 
> 时间：2012-08-08T23:35:25.750
> 
> 标签：sql-server-2008, partitioning

我有一个基本的分区问题。

我有一个看起来像这样的表：

```
CREATE TABLE [dbo].[WeatherStationData](
    [Time] [smalldatetime] NOT NULL,
    [pk_WS] [int] NOT NULL,
    [TemperatureF] [decimal](5, 1) NULL,
            ....
 CONSTRAINT [PK_WeatherStationData] PRIMARY KEY CLUSTERED 
(
    [Time] ASC,
    [pk_WS] ASC
) [PRIMARY]
) ON [PRIMARY] 
```

我创建了这个分区函数：

```
CREATE PARTITION FUNCTION pfWSD (DATETIME) AS RANGE RIGHT
FOR
VALUES (
    '01/01/2007', 
    '01/01/2008',
    '01/01/2009',
    '01/01/2010',
    '01/01/2011',
    '01/01/2012'
    ); 
```

而这个分区方案：

```
CREATE PARTITION SCHEME [psWSD] AS PARTITION [pfWSD] TO (
    [WSD0000]
    ,[WSD2007]
    ,[WSD2008]
    ,[WSD2009]
    ,[WSD2010]
    ,[WSD2011]
    ,[WSD2012]
    ) 
```

当我运行时：

```
SELECT $PARTITION.pfWSD([Time]) AS Partition, 
COUNT(*) AS [COUNT] FROM dbo.WeatherStationData
GROUP BY $PARTITION.pfWSD([Time])
ORDER BY Partition ; 
```

结果如下所示：

```
Partition   COUNT
----------- -----------
2           3396337
3           5408747
4           6576450
5           9602069
6           12650615
7           5577064 
```

然而，当我查看底层文件时，它们都是 99% 的可用空间（初始大小为 2048MB，2047MB 可用空间），并且主文件组仍然很大并且大部分都已满。该表是空的，我在设置分区后将数据加载到其中。我认为分区不起作用，我还需要检查什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T01:12:09.837

忘记在分区方案上创建表，应该是：

```
CREATE TABLE [dbo].[WeatherStationData](
    [Time] [smalldatetime] NOT NULL,
    [pk_WS] [int] NOT NULL,
    [TemperatureF] [decimal](5, 1) NULL,
        ....
 CONSTRAINT [PK_WeatherStationData] PRIMARY KEY CLUSTERED 
(
    [Time] ASC,
    [pk_WS] ASC
) **psWSD([Time])**
) ON **psWSD([Time])** 
```

# python - 如何使用 matplotlib 在 while 循环中实时绘图？

> ID：11874767
> 
> 赞同：310
> 
> 时间：2012-08-08T23:36:04.497
> 
> 标签：python, matplotlib, while-loop, real-time

我正在尝试使用 OpenCV 实时绘制来自相机的一些数据。但是，实时绘图（使用 matplotlib）似乎不起作用。

我已将问题隔离到这个简单的示例中：

```
fig = plt.figure()
plt.axis([0, 1000, 0, 1])

i = 0
x = list()
y = list()

while i < 1000:
    temp_y = np.random.random()
    x.append(i)
    y.append(temp_y)
    plt.scatter(i, temp_y)
    i += 1
    plt.show() 
```

我希望这个例子能够单独绘制 1000 个点。实际发生的情况是窗口弹出并显示第一个点（可以），然后等待循环完成，然后再填充图形的其余部分。

有什么想法为什么我一次看不到一个点填充？

* * *

## 回答 #1

> 赞同：372
> 
> 时间：2013-03-30T16:37:14.450

这是相关代码的工作版本（至少需要 2011-11-14 版本的 Matplotlib 1.1.0）：

```
import numpy as np
import matplotlib.pyplot as plt

plt.axis([0, 10, 0, 1])

for i in range(10):
    y = np.random.random()
    plt.scatter(i, y)
    plt.pause(0.05)

plt.show() 
```

请注意对 的调用`plt.pause(0.05)`，它既绘制新数据又运行 GUI 的事件循环（允许鼠标交互）。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2013-03-31T00:17:21.350

如果您对实时绘图感兴趣，我建议您查看[matplotlib 的动画 API](https://matplotlib.org/stable/api/animation_api.html)。特别是，使用`blit`避免在每一帧上重绘背景可以为您带来显着的速度提升（~10x）：

```
#!/usr/bin/env python

import numpy as np
import time
import matplotlib
matplotlib.use('GTKAgg')
from matplotlib import pyplot as plt

def randomwalk(dims=(256, 256), n=20, sigma=5, alpha=0.95, seed=1):
    """ A simple random walk with memory """

    r, c = dims
    gen = np.random.RandomState(seed)
    pos = gen.rand(2, n) * ((r,), (c,))
    old_delta = gen.randn(2, n) * sigma

    while True:
        delta = (1\. - alpha) * gen.randn(2, n) * sigma + alpha * old_delta
        pos += delta
        for ii in xrange(n):
            if not (0\. <= pos[0, ii] < r):
                pos[0, ii] = abs(pos[0, ii] % r)
            if not (0\. <= pos[1, ii] < c):
                pos[1, ii] = abs(pos[1, ii] % c)
        old_delta = delta
        yield pos

def run(niter=1000, doblit=True):
    """
    Display the simulation using matplotlib, optionally using blit for speed
    """

    fig, ax = plt.subplots(1, 1)
    ax.set_aspect('equal')
    ax.set_xlim(0, 255)
    ax.set_ylim(0, 255)
    ax.hold(True)
    rw = randomwalk()
    x, y = rw.next()

    plt.show(False)
    plt.draw()

    if doblit:
        # cache the background
        background = fig.canvas.copy_from_bbox(ax.bbox)

    points = ax.plot(x, y, 'o')[0]
    tic = time.time()

    for ii in xrange(niter):

        # update the xy data
        x, y = rw.next()
        points.set_data(x, y)

        if doblit:
            # restore background
            fig.canvas.restore_region(background)

            # redraw just the points
            ax.draw_artist(points)

            # fill in the axes rectangle
            fig.canvas.blit(ax.bbox)

        else:
            # redraw everything
            fig.canvas.draw()

    plt.close(fig)
    print "Blit = %s, average FPS: %.2f" % (
        str(doblit), niter / (time.time() - tic))

if __name__ == '__main__':
    run(doblit=False)
    run(doblit=True) 
```

输出：

```
Blit = False, average FPS: 54.37
Blit = True, average FPS: 438.27 
```

* * *

## 回答 #3

> 赞同：54
> 
> 时间：2016-07-20T16:48:40.313

我知道我回答这个问题有点晚了。不过，我前段时间编写了一些代码来绘制实时图表，我想分享一下：

**PyQt4 的代码：**

```
###################################################################
#                                                                 #
#                    PLOT A LIVE GRAPH (PyQt4)                    #
#                  -----------------------------                  #
#            EMBED A MATPLOTLIB ANIMATION INSIDE YOUR             #
#            OWN GUI!                                             #
#                                                                 #
###################################################################

import sys
import os
from PyQt4 import QtGui
from PyQt4 import QtCore
import functools
import numpy as np
import random as rd
import matplotlib
matplotlib.use("Qt4Agg")
from matplotlib.figure import Figure
from matplotlib.animation import TimedAnimation
from matplotlib.lines import Line2D
from matplotlib.backends.backend_qt4agg import FigureCanvasQTAgg as FigureCanvas
import time
import threading

def setCustomSize(x, width, height):
    sizePolicy = QtGui.QSizePolicy(QtGui.QSizePolicy.Fixed, QtGui.QSizePolicy.Fixed)
    sizePolicy.setHorizontalStretch(0)
    sizePolicy.setVerticalStretch(0)
    sizePolicy.setHeightForWidth(x.sizePolicy().hasHeightForWidth())
    x.setSizePolicy(sizePolicy)
    x.setMinimumSize(QtCore.QSize(width, height))
    x.setMaximumSize(QtCore.QSize(width, height))

''''''

class CustomMainWindow(QtGui.QMainWindow):

    def __init__(self):

        super(CustomMainWindow, self).__init__()

        # Define the geometry of the main window
        self.setGeometry(300, 300, 800, 400)
        self.setWindowTitle("my first window")

        # Create FRAME_A
        self.FRAME_A = QtGui.QFrame(self)
        self.FRAME_A.setStyleSheet("QWidget { background-color: %s }" % QtGui.QColor(210,210,235,255).name())
        self.LAYOUT_A = QtGui.QGridLayout()
        self.FRAME_A.setLayout(self.LAYOUT_A)
        self.setCentralWidget(self.FRAME_A)

        # Place the zoom button
        self.zoomBtn = QtGui.QPushButton(text = 'zoom')
        setCustomSize(self.zoomBtn, 100, 50)
        self.zoomBtn.clicked.connect(self.zoomBtnAction)
        self.LAYOUT_A.addWidget(self.zoomBtn, *(0,0))

        # Place the matplotlib figure
        self.myFig = CustomFigCanvas()
        self.LAYOUT_A.addWidget(self.myFig, *(0,1))

        # Add the callbackfunc to ..
        myDataLoop = threading.Thread(name = 'myDataLoop', target = dataSendLoop, daemon = True, args = (self.addData_callbackFunc,))
        myDataLoop.start()

        self.show()

    ''''''

    def zoomBtnAction(self):
        print("zoom in")
        self.myFig.zoomIn(5)

    ''''''

    def addData_callbackFunc(self, value):
        # print("Add data: " + str(value))
        self.myFig.addData(value)

''' End Class '''

class CustomFigCanvas(FigureCanvas, TimedAnimation):

    def __init__(self):

        self.addedData = []
        print(matplotlib.__version__)

        # The data
        self.xlim = 200
        self.n = np.linspace(0, self.xlim - 1, self.xlim)
        a = []
        b = []
        a.append(2.0)
        a.append(4.0)
        a.append(2.0)
        b.append(4.0)
        b.append(3.0)
        b.append(4.0)
        self.y = (self.n * 0.0) + 50

        # The window
        self.fig = Figure(figsize=(5,5), dpi=100)
        self.ax1 = self.fig.add_subplot(111)

        # self.ax1 settings
        self.ax1.set_xlabel('time')
        self.ax1.set_ylabel('raw data')
        self.line1 = Line2D([], [], color='blue')
        self.line1_tail = Line2D([], [], color='red', linewidth=2)
        self.line1_head = Line2D([], [], color='red', marker='o', markeredgecolor='r')
        self.ax1.add_line(self.line1)
        self.ax1.add_line(self.line1_tail)
        self.ax1.add_line(self.line1_head)
        self.ax1.set_xlim(0, self.xlim - 1)
        self.ax1.set_ylim(0, 100)

        FigureCanvas.__init__(self, self.fig)
        TimedAnimation.__init__(self, self.fig, interval = 50, blit = True)

    def new_frame_seq(self):
        return iter(range(self.n.size))

    def _init_draw(self):
        lines = [self.line1, self.line1_tail, self.line1_head]
        for l in lines:
            l.set_data([], [])

    def addData(self, value):
        self.addedData.append(value)

    def zoomIn(self, value):
        bottom = self.ax1.get_ylim()[0]
        top = self.ax1.get_ylim()[1]
        bottom += value
        top -= value
        self.ax1.set_ylim(bottom,top)
        self.draw()

    def _step(self, *args):
        # Extends the _step() method for the TimedAnimation class.
        try:
            TimedAnimation._step(self, *args)
        except Exception as e:
            self.abc += 1
            print(str(self.abc))
            TimedAnimation._stop(self)
            pass

    def _draw_frame(self, framedata):
        margin = 2
        while(len(self.addedData) > 0):
            self.y = np.roll(self.y, -1)
            self.y[-1] = self.addedData[0]
            del(self.addedData[0])

        self.line1.set_data(self.n[ 0 : self.n.size - margin ], self.y[ 0 : self.n.size - margin ])
        self.line1_tail.set_data(np.append(self.n[-10:-1 - margin], self.n[-1 - margin]), np.append(self.y[-10:-1 - margin], self.y[-1 - margin]))
        self.line1_head.set_data(self.n[-1 - margin], self.y[-1 - margin])
        self._drawn_artists = [self.line1, self.line1_tail, self.line1_head]

''' End Class '''

# You need to setup a signal slot mechanism, to 
# send data to your GUI in a thread-safe way.
# Believe me, if you don't do this right, things
# go very very wrong..
class Communicate(QtCore.QObject):
    data_signal = QtCore.pyqtSignal(float)

''' End Class '''

def dataSendLoop(addData_callbackFunc):
    # Setup the signal-slot mechanism.
    mySrc = Communicate()
    mySrc.data_signal.connect(addData_callbackFunc)

    # Simulate some data
    n = np.linspace(0, 499, 500)
    y = 50 + 25*(np.sin(n / 8.3)) + 10*(np.sin(n / 7.5)) - 5*(np.sin(n / 1.5))
    i = 0

    while(True):
        if(i > 499):
            i = 0
        time.sleep(0.1)
        mySrc.data_signal.emit(y[i]) # <- Here you emit a signal!
        i += 1
    ###
###

if __name__== '__main__':
    app = QtGui.QApplication(sys.argv)
    QtGui.QApplication.setStyle(QtGui.QStyleFactory.create('Plastique'))
    myGUI = CustomMainWindow()
    sys.exit(app.exec_())

'''''' 
```

我最近重写了 PyQt5 的代码。
**PyQt5 的代码：**

```
###################################################################
#                                                                 #
#                    PLOT A LIVE GRAPH (PyQt5)                    #
#                  -----------------------------                  #
#            EMBED A MATPLOTLIB ANIMATION INSIDE YOUR             #
#            OWN GUI!                                             #
#                                                                 #
###################################################################

import sys
import os
from PyQt5.QtWidgets import *
from PyQt5.QtCore import *
from PyQt5.QtGui import *
import functools
import numpy as np
import random as rd
import matplotlib
matplotlib.use("Qt5Agg")
from matplotlib.figure import Figure
from matplotlib.animation import TimedAnimation
from matplotlib.lines import Line2D
from matplotlib.backends.backend_qt5agg import FigureCanvasQTAgg as FigureCanvas
import time
import threading

class CustomMainWindow(QMainWindow):
    def __init__(self):
        super(CustomMainWindow, self).__init__()
        # Define the geometry of the main window
        self.setGeometry(300, 300, 800, 400)
        self.setWindowTitle("my first window")
        # Create FRAME_A
        self.FRAME_A = QFrame(self)
        self.FRAME_A.setStyleSheet("QWidget { background-color: %s }" % QColor(210,210,235,255).name())
        self.LAYOUT_A = QGridLayout()
        self.FRAME_A.setLayout(self.LAYOUT_A)
        self.setCentralWidget(self.FRAME_A)
        # Place the zoom button
        self.zoomBtn = QPushButton(text = 'zoom')
        self.zoomBtn.setFixedSize(100, 50)
        self.zoomBtn.clicked.connect(self.zoomBtnAction)
        self.LAYOUT_A.addWidget(self.zoomBtn, *(0,0))
        # Place the matplotlib figure
        self.myFig = CustomFigCanvas()
        self.LAYOUT_A.addWidget(self.myFig, *(0,1))
        # Add the callbackfunc to ..
        myDataLoop = threading.Thread(name = 'myDataLoop', target = dataSendLoop, daemon = True, args = (self.addData_callbackFunc,))
        myDataLoop.start()
        self.show()
        return

    def zoomBtnAction(self):
        print("zoom in")
        self.myFig.zoomIn(5)
        return

    def addData_callbackFunc(self, value):
        # print("Add data: " + str(value))
        self.myFig.addData(value)
        return

''' End Class '''

class CustomFigCanvas(FigureCanvas, TimedAnimation):
    def __init__(self):
        self.addedData = []
        print(matplotlib.__version__)
        # The data
        self.xlim = 200
        self.n = np.linspace(0, self.xlim - 1, self.xlim)
        a = []
        b = []
        a.append(2.0)
        a.append(4.0)
        a.append(2.0)
        b.append(4.0)
        b.append(3.0)
        b.append(4.0)
        self.y = (self.n * 0.0) + 50
        # The window
        self.fig = Figure(figsize=(5,5), dpi=100)
        self.ax1 = self.fig.add_subplot(111)
        # self.ax1 settings
        self.ax1.set_xlabel('time')
        self.ax1.set_ylabel('raw data')
        self.line1 = Line2D([], [], color='blue')
        self.line1_tail = Line2D([], [], color='red', linewidth=2)
        self.line1_head = Line2D([], [], color='red', marker='o', markeredgecolor='r')
        self.ax1.add_line(self.line1)
        self.ax1.add_line(self.line1_tail)
        self.ax1.add_line(self.line1_head)
        self.ax1.set_xlim(0, self.xlim - 1)
        self.ax1.set_ylim(0, 100)
        FigureCanvas.__init__(self, self.fig)
        TimedAnimation.__init__(self, self.fig, interval = 50, blit = True)
        return

    def new_frame_seq(self):
        return iter(range(self.n.size))

    def _init_draw(self):
        lines = [self.line1, self.line1_tail, self.line1_head]
        for l in lines:
            l.set_data([], [])
        return

    def addData(self, value):
        self.addedData.append(value)
        return

    def zoomIn(self, value):
        bottom = self.ax1.get_ylim()[0]
        top = self.ax1.get_ylim()[1]
        bottom += value
        top -= value
        self.ax1.set_ylim(bottom,top)
        self.draw()
        return

    def _step(self, *args):
        # Extends the _step() method for the TimedAnimation class.
        try:
            TimedAnimation._step(self, *args)
        except Exception as e:
            self.abc += 1
            print(str(self.abc))
            TimedAnimation._stop(self)
            pass
        return

    def _draw_frame(self, framedata):
        margin = 2
        while(len(self.addedData) > 0):
            self.y = np.roll(self.y, -1)
            self.y[-1] = self.addedData[0]
            del(self.addedData[0])

        self.line1.set_data(self.n[ 0 : self.n.size - margin ], self.y[ 0 : self.n.size - margin ])
        self.line1_tail.set_data(np.append(self.n[-10:-1 - margin], self.n[-1 - margin]), np.append(self.y[-10:-1 - margin], self.y[-1 - margin]))
        self.line1_head.set_data(self.n[-1 - margin], self.y[-1 - margin])
        self._drawn_artists = [self.line1, self.line1_tail, self.line1_head]
        return

''' End Class '''

# You need to setup a signal slot mechanism, to
# send data to your GUI in a thread-safe way.
# Believe me, if you don't do this right, things
# go very very wrong..
class Communicate(QObject):
    data_signal = pyqtSignal(float)

''' End Class '''

def dataSendLoop(addData_callbackFunc):
    # Setup the signal-slot mechanism.
    mySrc = Communicate()
    mySrc.data_signal.connect(addData_callbackFunc)

    # Simulate some data
    n = np.linspace(0, 499, 500)
    y = 50 + 25*(np.sin(n / 8.3)) + 10*(np.sin(n / 7.5)) - 5*(np.sin(n / 1.5))
    i = 0

    while(True):
        if(i > 499):
            i = 0
        time.sleep(0.1)
        mySrc.data_signal.emit(y[i]) # <- Here you emit a signal!
        i += 1
    ###
###

if __name__== '__main__':
    app = QApplication(sys.argv)
    QApplication.setStyle(QStyleFactory.create('Plastique'))
    myGUI = CustomMainWindow()
    sys.exit(app.exec_()) 
```

试试看。将此代码复制粘贴到一个新的 python 文件中，然后运行它。你应该得到一个漂亮的、平滑移动的图表：

[![在此处输入图像描述](../Images/4dbcd29d926e7db3ca867fa90688aa7d.png)](https://i.stack.imgur.com/1TKDs.png)

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2014-06-15T09:33:01.467

这些方法都不适合我。但我发现这个 [实时 matplotlib 图在循环中不起作用](https://stackoverflow.com/questions/19766100/real-time-matplotlib-plot-is-not-working-while-still-in-a-loop)

您只需要添加

```
plt.pause(0.0001) 
```

然后你可以看到新的情节。

**所以你的代码应该是这样的，它会工作**

```
import matplotlib.pyplot as plt
import numpy as np
plt.ion() ## Note this correction
fig=plt.figure()
plt.axis([0,1000,0,1])

i=0
x=list()
y=list()

while i <1000:
    temp_y=np.random.random();
    x.append(i);
    y.append(temp_y);
    plt.scatter(i,temp_y);
    i+=1;
    plt.show()
    plt.pause(0.0001) #Note this correction 
```

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2017-12-27T09:10:37.000

最重要的（和许多其他的）答案是建立在 上的`plt.pause()`，但这是在 matplotlib 中为情节设置动画的一种旧方式。它不仅速度慢，而且每次更新都会引起关注（我很难停止绘制 python 进程）。

**TL；DR：**您可能想要使用`matplotlib.animation`（[如文档中所述](https://matplotlib.org/api/_as_gen/matplotlib.pyplot.pause.html)）。

在挖掘了各种答案和代码片段之后，事实证明这对我来说是一种无限绘制传入数据的流畅方式。

这是我的快速入门代码。它每 200 毫秒用 [0, 100) 中的随机数无限地绘制当前时间，同时还处理视图的自动缩放：

```
from datetime import datetime
from matplotlib import pyplot
from matplotlib.animation import FuncAnimation
from random import randrange

x_data, y_data = [], []

figure = pyplot.figure()
line, = pyplot.plot_date(x_data, y_data, '-')

def update(frame):
    x_data.append(datetime.now())
    y_data.append(randrange(0, 100))
    line.set_data(x_data, y_data)
    figure.gca().relim()
    figure.gca().autoscale_view()
    return line,

animation = FuncAnimation(figure, update, interval=200)

pyplot.show() 
```

您还可以[在 FuncAnimation 文档中](https://matplotlib.org/api/animation_api.html#funcanimation)`blit`探索更好的性能。

文档中的一个示例`blit`：

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation

fig, ax = plt.subplots()
xdata, ydata = [], []
ln, = plt.plot([], [], 'ro')

def init():
    ax.set_xlim(0, 2*np.pi)
    ax.set_ylim(-1, 1)
    return ln,

def update(frame):
    xdata.append(frame)
    ydata.append(np.sin(frame))
    ln.set_data(xdata, ydata)
    return ln,

ani = FuncAnimation(fig, update, frames=np.linspace(0, 2*np.pi, 128),
                    init_func=init, blit=True)
plt.show() 
```

* * *

## 回答 #6

> 赞同：34
> 
> 时间：2012-08-08T23:48:57.177

`show`可能不是最好的选择。我会做的是`pyplot.draw()`改用。您可能还希望`time.sleep(0.05)`在循环中包含一个小的时间延迟（例如 ），以便您可以看到正在发生的图。如果我对您的示例进行这些更改，它对我有用，并且我看到每个点一次出现一个。

* * *

## 回答 #7

> 赞同：16
> 
> 时间：2014-05-09T15:25:06.337

我知道这个问题很老，但现在在 GitHub 上有一个名为[drawow](https://github.com/stsievert/python-drawnow)的包，名为“python-drawnow”。这提供了一个类似于 MATLAB 的 drawow 的界面——您可以*轻松地*更新图形。

您的用例示例：

```
import matplotlib.pyplot as plt
from drawnow import drawnow

def make_fig():
    plt.scatter(x, y)  # I think you meant this

plt.ion()  # enable interactivity
fig = plt.figure()  # make a figure

x = list()
y = list()

for i in range(1000):
    temp_y = np.random.random()
    x.append(i)
    y.append(temp_y)  # or any arbitrary update to your figure's data
    i += 1
    drawnow(make_fig) 
```

python-drawnow 是一个瘦包装器，`plt.draw`但提供了在图形显示后确认（或调试）的能力。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2012-08-08T23:44:15.233

问题似乎是您希望`plt.show()`显示窗口然后返回。它不这样做。该程序将在该点停止，只有在您关闭窗口后才能恢复。您应该能够测试：如果您关闭窗口，然后应该弹出另一个窗口。

要解决该问题，只需`plt.show()`在循环后调用一次。然后你得到完整的情节。（但不是“实时绘图”）

`block`您可以尝试像这样设置关键字参数：`plt.show(block=False)`在开始时使用一次，然后用于[`.draw()`](http://matplotlib.sourceforge.net/api/pyplot_api.html#matplotlib.pyplot.draw)更新。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2020-03-16T18:04:27.363

另一种选择是使用[bokeh](https://github.com/bokeh/bokeh)。IMO，至少对于实时绘图来说，它是一个不错的选择。这是问题中代码的散景版本：

```
from bokeh.plotting import curdoc, figure
import random
import time

def update():
    global i
    temp_y = random.random()
    r.data_source.stream({'x': [i], 'y': [temp_y]})
    i += 1

i = 0
p = figure()
r = p.circle([], [])
curdoc().add_root(p)
curdoc().add_periodic_callback(update, 100) 
```

并运行它：

```
pip3 install bokeh
bokeh serve --show test.py 
```

散景通过 websocket 通信在 web 浏览器中显示结果。当数据由远程无头服务器进程生成时，它特别有用。

[![散景示例图](../Images/e98f34e4f05a05083b06038a423c0a4b.png)](https://i.stack.imgur.com/RyGZz.gif)

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2020-04-05T01:10:10.897

实时绘制 CPU 使用情况的示例用例。

```
import time
import psutil
import matplotlib.pyplot as plt

fig = plt.figure()
ax = fig.add_subplot(111)

i = 0
x, y = [], []

while True:
    x.append(i)
    y.append(psutil.cpu_percent())

    ax.plot(x, y, color='b')

    fig.canvas.draw()

    ax.set_xlim(left=max(0, i - 50), right=i + 50)
    fig.show()
    plt.pause(0.05)
    i += 1 
```

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2015-05-05T18:19:13.947

这是我必须在我的系统上工作的版本。

```
import matplotlib.pyplot as plt
from drawnow import drawnow
import numpy as np

def makeFig():
    plt.scatter(xList,yList) # I think you meant this

plt.ion() # enable interactivity
fig=plt.figure() # make a figure

xList=list()
yList=list()

for i in np.arange(50):
    y=np.random.random()
    xList.append(i)
    yList.append(y)
    drawnow(makeFig)
    #makeFig()      The drawnow(makeFig) command can be replaced
    #plt.draw()     with makeFig(); plt.draw()
    plt.pause(0.001) 
```

drawow(makeFig) 行可以用 makeFig() 替换；plt.draw() 序列，它仍然可以正常工作。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-05-01T20:53:05.037

如果您想绘制而不是冻结线程，因为绘制了更多点，您应该使用 plt.pause() 而不是 time.sleep()

我使用以下代码绘制一系列 xy 坐标。

```
import matplotlib.pyplot as plt 
import math

pi = 3.14159

fig, ax = plt.subplots()

x = []
y = []

def PointsInCircum(r,n=20):
    circle = [(math.cos(2*pi/n*x)*r,math.sin(2*pi/n*x)*r) for x in xrange(0,n+1)]
    return circle

circle_list = PointsInCircum(3, 50)

for t in range(len(circle_list)):
    if t == 0:
        points, = ax.plot(x, y, marker='o', linestyle='--')
        ax.set_xlim(-4, 4) 
        ax.set_ylim(-4, 4) 
    else:
        x_coord, y_coord = circle_list.pop()
        x.append(x_coord)
        y.append(y_coord)
        points.set_data(x, y)
    plt.pause(0.01) 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-09-29T11:23:33.997

这是使用while循环绘制动态实时matplot动画的正确方法

[对此也有一篇中等文章：](https://yogender027mae.medium.com/easy-matplot-animation-using-less-than-15-lines-of-code-24ba92f9927b)

pip install celluloid # 这将捕获图像/动画

```
import matplotlib.pyplot as plt
import numpy as np
from celluloid import Camera # getting the camera
import matplotlib.animation as animation
from IPython import display
import time
from IPython.display import HTML

import warnings
%matplotlib notebook
warnings.filterwarnings('ignore')
warnings.simplefilter('ignore')

fig = plt.figure() #Empty fig object
ax = fig.add_subplot() #Empty axis object
camera = Camera(fig) # Camera object to capture the snap

def f(x):
    ''' function to create a sine wave'''
    return np.sin(x) + np.random.normal(scale=0.1, size=len(x))

l = []

while True:
    value = np.random.randint(9) #random number generator
    l.append(value) # appneds each time number is generated
    X = np.linspace(10, len(l)) # creates a line space for x axis, Equal to the length of l

    for i in range(10): #plots 10 such lines
        plt.plot(X, f(X))

    fig.show() #shows the figure object
    fig.canvas.draw() 
    camera.snap() # camera object to capture teh animation
    time.sleep(1) 
```

并用于保存等：

```
animation = camera.animate(interval = 200, repeat = True, repeat_delay = 500)
HTML(animation.to_html5_video())
animation.save('abc.mp4') # to save 
```

输出是：

[![在此处输入图像描述](../Images/94d0510cbbf0ae78a2ecb61b7ea6cb17.png)](https://i.stack.imgur.com/APhAE.gif)

# jquery - 在 jQuery 中将 CSS 添加到选中的单选按钮和标签

> ID：11874773
> 
> 赞同：1
> 
> 时间：2012-08-08T23:36:51.693
> 
> 标签：jquery, function, radio-button, checked

我将图像用作单选按钮，并希望将 CSS 样式添加到通过 jQuery 检查的单选按钮（图像）。

这是具有单选按钮和标签的 HTML 代码：

```
<input class="radio" type="radio" name="asw_options[box_background_color]" id="box_background_color0" value="aqua_solid"  checked='checked'>
<label for="box_background_color0"><img src="images/backgrounds/aqua.png"></label>
<input class="radio" type="radio" name="asw_options[box_background_color]" id="box_background_color1" value="blue_solid" >
<label for="box_background_color1"><img src="images/backgrounds/blue.png"></label>
<input class="radio" type="radio" name="asw_options[box_background_color]" id="box_background_color2" value="black_solid" >
<label for="box_background_color2"><img src="images/backgrounds/black.png"></label> 
```

这是我用来使单选按钮作为图像工作的 jquery 代码：

```
$('#solidcolor input:radio').addClass('input_hidden');
$('#solidcolor label').click(function() {
    $(this).addClass('selected').siblings().removeClass('selected');
}); 
```

这很好用。您选择一个图像，它会检查隐藏的单选按钮并突出显示图像，以便您知道您做出了选择。然后我保存设置，效果很好。

我想知道的是，当页面重新加载时，我想为选中的单选按钮（图像标签）添加一个纯色 3px 黑色边框，以便您知道之前做出的选择。

当前发生的情况是，当您重新加载页面时，所有图像（标签）最终都带有黑色边框。

这是我试图用来突出显示以前保存的单选按钮的 jQuery。

```
$("#solidcolor input[type='radio']:checked").each( 
function() { 
   $('#solidcolor label').css("border", "solid 3px black");
} 
); 
```

这可以通过 jQuery 完成，还是我最好尝试通过 CSS 突出显示先前选择的单选按钮？

我还尝试了不同的 jQuery 函数，如果我使用此代码，它会提醒我先前正确选中的单选按钮，但是使用此代码我不知道如何使用它来使其将 CSS 边框添加到该特定标签或选中单选按钮。

```
var isChecked = $("#solidcolor input[name=asw_options[box_background_color]]:checked").val();
 alert(isChecked); 
```

请帮忙，我已经三天了。

谢谢你

编辑：

我刚刚设置了一个 jsfiddle 来说明我的意思

[jSFiddle 示例](http://jsfiddle.net/Broady/4GpGe/7/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:54:30.863

您可能会尝试的一件事是更新`.each`回调。我向选择器添加了一个属性选择`label`器，以获取与选中复选框关联的标签

```
$("#solidcolor input[type='radio']:checked").each( 
    function() { 
       $("#solidcolor label[for='" + this.id + "']").css("border", "solid 3px black");
    } 
); 
```

# heroku - 在 Heroku 应用程序中安装 Ruby/GSL

> ID：11874776
> 
> 赞同：1
> 
> 时间：2012-08-08T23:37:32.600
> 
> 标签：heroku, gsl, buildpack

语境：

*   我有一个大量使用 GSL 库及其 Ruby 绑定的应用程序。
*   我想将该应用程序部署到 Heroku。一般来说，我对编程非常陌生，部署少得多，而且 Heroku 使用起来非常简单，尤其是对于 Rails 应用程序。
*   我的笔记本电脑上安装了 GSL。我正在使用“gsl”宝石。

问题：

*   gem 要求已安装 GSL 库。
*   Heroku 环境中尚未安装 GSL。
*   所以，不出所料，我从 Heroku 收到了这个错误`git push heroku master`

    ```
    -----> Heroku receiving push
    -----> Removing .DS_Store files
    -----> Ruby/Rails app detected
    -----> Installing dependencies using Bundler version 1.2.0.rc
           Running: bundle install --without development:test --path vendor/bundle --binstubs bin/ --deployment

    ...
    Installing gsl (1.14.7) with native extensions
    Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.
    /usr/local/bin/ruby extconf.rb
    checking gsl version... *** extconf.rb failed ***
    Could not create Makefile due to some reason, probably lack of
    necessary libraries and/or headers.  Check the mkmf.log file for more
    details.  You may need configuration options.
    Provided configuration options:
    --with-opt-dir
    --without-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/usr/local/bin/ruby
    extconf.rb:237:in `rescue in <main>': Check GSL>=0.9.4 is installed, and the command "gsl-config" is in search path. (RuntimeError)
    from extconf.rb:138:in `<main>' 
    ```

（可能的）解决方案：

*   似乎使用 Heroku 的 buildpacks 是可能的路线。 [这](https://devcenter.heroku.com/articles/buildpack-binaries "这")（打包二进制 buildpack 依赖项）似乎很有希望。
*   我只是不明白教程中发生了什么，或者如何使用 vulcan。

我所希望的：

*   关于如何使 GSL 库可用于我在 Heroku 上的应用程序的易于理解的解释。

非常感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-19T01:10:04.560

嘿，汤姆（两个名叫汤姆的人需要在 heroku 上使用 ruby​​-gsl 的可能性有多大？）我还没有测试它（我真的不知道我在做什么，我真的没有应用程序*尚未*准备好对其进行测试）但也许这会起作用：

[heroku-buildpack-gsl-ruby](https://github.com/tomwolfe/heroku-buildpack-gsl-ruby)

如果没有，好吧，我们会坚持下去；）

它是当前最新的 gsl 1.15。

虽然在未来类似： [package_nodejs](https://github.com/heroku/heroku-buildpack-nodejs/blob/master/support/package_nodejs) 代替 gsl 可能会很好（请参阅自述文件的黑客部分）。我可能会很快添加（复制/粘贴，颤抖，所以不是干的）。

# objective-c - iOS：如何在每次更改边界时动态更改 uiscrollview 的 minZoom？

> ID：11874777
> 
> 赞同：0
> 
> 时间：2012-08-08T23:37:34.330
> 
> 标签：objective-c, ios, uiscrollview

我想我可以将它子类化并覆盖 minZoom 的 getter 方法，但有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:59:02.950

在您的视图控制器中覆盖这个 -

```
- (void)viewWillLayoutSubviews 
```

当视图的边界发生变化时，视图会调整其子视图的位置。您的视图控制器可以覆盖此方法以在视图布置其子视图之前进行更改。

如果这还为时过早，就会出现 viewDidLayoutSubviews

在那里更改您的滚动视图缩放。

# google-apps-script - Google Apps 脚本：电子表格：如何获取工作表数量、将最后一张设置为活动副本并重命名？

> ID：11874779
> 
> 赞同：2
> 
> 时间：2012-08-08T23:37:35.467
> 
> 标签：google-apps-script

我似乎无法使语法正确...

我正在尝试获取电子表格中的工作表总数并将最后一个设置为活动工作表。然后我想复制工作表，将第 3 行重命名并删除到最后一行。

这是我一直在玩的一些代码：

```
 var logbook = SpreadsheetApp.openById("keycode here");
    var logbookSheets = logbook.getSheets();
    var numSheets = logbook.getNumSheets();
    logbook.setActiveSheet(logbookSheets[numSheets]).duplicateActiveSheet(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-10T12:52:13.140

我从未使用过`duplicateActiveSheet`，并且由于代码编辑器尚未完成（至少尚未完成），因此我不会使用它。

这是我的做法：

```
 var ss = SpreadsheetApp.openById('ss-key');
  var sheets = logbook.getSheets();
  ss.setActiveSheet(sheets[sheets.length-1]);
  sheets[sheets.length-1].copyTo(ss).setName('NewName'); 
```

# groovy - Groovy 节点与节点列表

> ID：11874781
> 
> 赞同：5
> 
> 时间：2012-08-08T23:37:46.107
> 
> 标签：groovy

我很难在 xml 结构中添加更深的节点。我在节点和节点列表之间缺少一些东西。任何帮助将不胜感激。

```
def xml='''<Root id="example" version="1" archived="false">
<Item name="one" value="test"/>
<Item name="two" value="test2"/>
<Item name="three" value="test3"/>
<AppSettings Name="foo" Id="foo1">
    <roles>foo</roles>
</AppSettings>
<AppSettings Name="bar" Id="bar1">
    <Item name="blue" value=""/>
    <Item name="green" value=""/>
    <Item name="yellow" value=""/>
    <Roles>
        <Role id="A"/>
        <Role id="B"/>
        <Role id="C"/>
    </Roles>
</AppSettings>
</Root>'''

root = new XmlParser().parseText(xml)
def appSettings = root.'AppSettings'.find{it.@Name == "bar"}.'Roles'
appSettings.appendNode('Role', [id: 'D'])

def writer = new StringWriter()
def printer = new XmlNodePrinter(new PrintWriter(writer))
printer.preserveWhitespace = true
printer.print(root)
String result = writer.toString()

println result 
```

错误

```
groovy.lang.MissingMethodException: No signature of method: groovy.util.NodeList.appendNode() is applicable for argument types: (java.lang.String, java.util.LinkedHashMap) values: [Role, [id:D]] 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-09T08:20:26.933

这一行在这里：

```
def appSettings = root.'AppSettings'.find{it.@Name == "bar"}.'Roles' 
```

正在返回一个 NodeList （包含一个节点），所以你想调用`appendNode`这个列表的内容，而不是列表本身。

这可以通过以下方式完成：

```
appSettings*.appendNode('Role', [id: 'D']) 
```

它将调用`appendNode`列表的每个元素，或者通过：

```
appSettings[0]?.appendNode('Role', [id: 'D']) 
```

这将调用`appendNode`列表的第一个元素（如果有第一个元素，这要归功于 null-safe operator `?`）。

# perl - Perl Rover v3 将环境变量传递到规则集中

> ID：11874782
> 
> 赞同：9
> 
> 时间：2012-08-08T23:37:57.187
> 
> 标签：perl, expect

我正在使用 perl Rover 模块版本 3 登录到 Linux/Unix 服务器并运行脚本。在规则集中，如果我添加完整路径名，它将脚本复制到远程服务器，无法替换环境变量。

例如。这有效：

```
 copy:{
       put_file "/home/u1/find.sh" "/tmp/"
        }; 
```

这没有用：

```
copy:{
   put_file "$HOME/find.sh" "/tmp/"
    }; 
```

使用 $ENV{'HOME'}，这也没有用。

如何传递环境变量？

流动站模块文档。 [http://rover.sourceforge.net/QuickStart/Rover-QuickStart-3.html#ss3.2](http://rover.sourceforge.net/QuickStart/Rover-QuickStart-3.html#ss3.2)

[http://rover.sourceforge.net/](http://rover.sourceforge.net/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-15T06:20:32.763

在查看了我从未使用过的 rover 的源代码后，我确定现有代码不可能。

我为您创建了一个具有该功能的新扩展，它支持 ~ 和 ${HOME} 语法（它们是 bash 扩展，而不是直接属于操作系统的一部分，这就是 perl 不支持它们的原因）。

代码在这里： [https ://github.com/h4ck3rm1k3/perl-rover/commit/2c78aefb97e819956bb665b04056763f8df1b242](https://github.com/h4ck3rm1k3/perl-rover/commit/2c78aefb97e819956bb665b04056763f8df1b242)

我很难测试它，因为我以前从未使用过 rover ~~，而且 rover 似乎不支持 scp。~~（我读到它是受支持的，但还不能测试它。）无论如何，如果你喜欢它，请告诉我。如果有合理的要求，我会做更多的工作。

# 更新

这是我的示例规则集：

## 示例规则集

```
[rulesets]
test:
{
       put_file_from_home put_file "~/find2.sh" "/tmp/"
       put_file_from_home put_file "${HOME}/find3.sh" "/tmp/"

},  ; 
```

## 示例输出

这是示例输出，我无法让流动站工作。请参阅下面的测试用例。

# 测试输出

```
perl -I lib  t/example2.t
Local was ~/find2.sh and home was /home/mdupont at lib/Rover/CoreExtension.pm line 19.
Local now /home/mdupont/find2.sh at lib/Rover/CoreExtension.pm line 22.
Local was ${HOME}/find3.sh and home was /home/mdupont at lib/Rover/CoreExtension.pm line 19.
Local now /home/mdupont/find3.sh at lib//Rover/CoreExtension.pm line 22. 
```

# 新 sshport 选项的新配置选项

```
[hosts]
someexample:{
    os linux
    username myusername
    description 'myhost'
    sshport 12345
    ftp_method_used sftp
 }; 
```

# 更新2

不要在名称周围使用引号，在 args 之间使用逗号，

到 git@github.com:h4ck3rm1k3/perl-rover.git 2207417..7637741 CoreExtension -> CoreExtension

```
[rulesets]

test: {     put_file_from_home ~/find2.sh,/tmp/ }, ;

[hosts]

localhost:{
    os linux
    username mdupont
    description 'localhost'
    ftp_methods sftp 
    ftp_method_used sftp  }; 
```

麦克风

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T00:16:30.940

老问题但新答案，因为您使用 Rover v3，您可以通过重载来扩展 Rover::Core 模块。

将此添加到您的 ~/.rover/contrib 目录：

核心变量.pm：

```
package CoreVariables;

use strict;
use Exporter;
our @ISA = qw( Exporter );
our @EXPORT = qw( put_file );

sub put_file {
  my ($self, $host, $command) = @_;

  $command =~ s/(\$[\w{}]+)/$1/eeg;
  return Rover::Core::put_file($self, $host, $command);
} 
```

并将以下内容添加到您的 ~/.rover/config [modules] 部分（必须在 Rover::Core 之后）：

```
CoreVariables:{
}; 
```

然后您可以在使用 put_file 时将环境变量存储在您的流动站配置中。如果您愿意，可以添加其他例程，这只会扩展 put_file。

由于这是一项如此简单的任务，我会将其添加到请求的功能列表中，并将其包含在下一个版本中（我是 Rover 的作者）。

向 Rover 提问的更好的地方当然是在 sourceforge 网站上：http: [//sourceforge.net/projects/rover/](http://sourceforge.net/projects/rover/)

# php - Facebook上的访问令牌无效 - 即使在制作之后

> ID：11874785
> 
> 赞同：1
> 
> 时间：2012-08-08T23:38:15.597
> 
> 标签：php, facebook-graph-api

我正在使用 facebook SDK 在 PHP 中编写一个 facebook 应用程序。
我的代码中的重要部分是：

```
 $facebook = new Facebook(array(
                'appId' => $ApplicationID,
                'secret' => $ApplicationSecret,
                'cookie' => true, // enable optional cookie support  
            ));
    $user = $facebook->getUser();

              $post = $facebook->api('/' . $user . '/feed', 'post', array(
              stuff
      ));
                $_SESSION['finish'] = false;
                $_SESSION['inside'] = 'yes';
                $_SESSION['uid'] = $user;
                $token = $facebook->getAccessToken();
                echo 'Access token: ' .$token;
                $_SESSION['friends'] = $facebook->api('/me/friends?access_token'.$token); 
```

您可以看到我正在`echo`获取访问令牌。
起初，我没有将其添加`access_token`到查询中 - 我只是添加它以进行检查。
问题是最后一个like（带有`/me/friends/`）抛出异常：

```
OAuthException: An active access token must be used to query information about the current user. 
```

尽管我进行了登录，并且`feed post` *确实*有效（我在墙上检查过，它就在那里）。然后，我的`try catch`块通过重定向到登录链接来处理异常，这样：

```
catch(Exception $e) {

            $login_url_params = array(
            'scope' => 'stuff',
            'fbconnect' => 1,
            'redirect_uri' => $ApplicationURL
        );
        $login_url = $facebook->getLoginUrl($login_url_params);

        //redirect to the login URL on facebook
        echo ("EXCPETION! " . $e . "<script> top.location.href='" . $login_url . "'</script>");
        exit();
        } 
```

编写异常的代码显然仅用于调试目的。
好吧，我第一次运行应用程序时，一个类似的代码是由一个`if(!$user)`条件执行的。然后它请求我的许可，我给了它。然后，它再次说访问令牌无效（但确实发布到我的墙上）。
请注意，我已经比较了 access_tokens，即使在删除应用程序并再次执行所有操作之后 - 它仍然保持不变。

这是非常尴尬的行为，我无法理解。任何人都可以对此有所了解吗？
编辑：出于某种奇怪的原因，即使在转到不同的用户之后，令牌也不会改变。但是墙上的帖子还是发了……（而且访问好友列表的时候抛出异常）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T12:30:49.653

> 出于某种奇怪的原因，即使在转到不同的用户之后，令牌也不会改变。但是墙上的帖子还是发了……（而且访问好友列表的时候抛出异常）

在我看来，这听起来好像您实际上没有用户当前登录，因此 SDK 只是使用您的*应用*访问令牌，这始终是它在接收另一个更“特定”的令牌之前将使用的默认令牌。

您的访问令牌有什么格式——看起来像`your_app_id|your_app_secret`或`your_app_id|some_random_characters`吗？如果它以您的应用程序 ID*开头*，那么它绝对是一个*应用程序*访问令牌。

# java - 如何从正在运行的 web 应用程序重新启动 tomcat？

> ID：11874789
> 
> 赞同：4
> 
> 时间：2012-08-08T23:38:30.147
> 
> 标签：java, tomcat, batch-file

我需要从在这个 tomcat 上运行的 webapp 重新启动 tomcat 服务。所以我试图执行停止tomcat服务的脚本，然后启动它：

```
echo "before stop" >> textfile.txt
NET STOP "Tomcat7"

:loop
    timeout 3
    SC query Tomcat7 | FIND "STATE" | FIND "RUNNING" > NUL

IF ERRORLEVEL 1 (
    goto start
) ELSE (
    goto loop
)

:start
    NET START "Tomcat7" 
```

Java代码：

```
 String command = "C:\\Tomcat 7.0\\bin\\restart.bat";
   Process p = Runtime.getRuntime().exec(command); 
```

Tomcat 已停止，但未启动。如果我从命令行运行这个批处理，它可以正常工作。

感谢您的时间

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T00:00:47.507

您所问的并不是完全安全和可能的，但请查看 Tomcat manager API，它允许您以编程方式操作 Tomcat 部署和实例：

[http://tomcat.apache.org/tomcat-7.0-doc/api/index.html](http://tomcat.apache.org/tomcat-7.0-doc/api/index.html)

[http://tomcat.apache.org/tomcat-7.0-doc/api/org/apache/catalina/manager/host/HostManagerServlet.html](http://tomcat.apache.org/tomcat-7.0-doc/api/org/apache/catalina/manager/host/HostManagerServlet.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-09T14:31:26.063

这有效：

```
 String fileName = "C:\\Tomcat 7.0\\bin\\restart.bat";
        String[] commands = {"cmd", "/c", "start", "\"DummyTitle\"",fileName};
        Runtime.getRuntime().exec(commands); 
```

取自[http://www.rgagnon.com/javadetails/java-0014.html](http://www.rgagnon.com/javadetails/java-0014.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T01:37:19.660

同意埃德蒙的观点。

Tomcat 是容器的提供者。每个容器都应该彼此独立运行，即使它们调用另一个容器提供的服务。这一切都应该通过 RMI 或类似方法完成。

就像 Edmon 还建议的那样，您可以使用 API 调用，但同样......听起来很糟糕。相反，质疑它为什么需要重新启动。然后，如果没有解决办法，请使用 Tomcat 管理器。

# ios - 通过 NSURLProtocol 子类从相对路径加载资源

> ID：11874795
> 
> 赞同：1
> 
> 时间：2012-08-08T23:38:52.320
> 
> 标签：ios, uiwebview, webview, nsurlprotocol

我为基于 UIWebView 的应用程序注册了一个 NSURLProtocol，设置为响应`file`方案请求。

在 web 视图中，我加载图像、CSS、JS 等，一切正常；当我尝试引用不在 HTML 树根目录中的 CSS 文件中的图像时，问题就出现了。例如

```
<html>
    <head>
        <style type="text/css">
        .1 { background-image: url("1.png"); }
        </style>
        <link href="css/style.css" rel="stylesheet" type="text/css" />
        <!-- contents of css/style.css might be:
        .2 { background-image: url("../2.png"); }
        -->
    </head>
    <body>
        <div class="1">properly styled</div>
        <div class="2">not styled</div>
    </body>
</head> 
```

查看到达我的 NSURLProtocol 的请求，我看不到确定请求文件在源树中的位置的方法。

例如，如果上面的 HTML 在一个名为 的文件中，我的 NSURLProtocol 子类将从该文件中`source/index.html`获取一个请求。`../2.png``source/css/style.css`

这应该解析为`source/2.png`，但我不知道路径中应该`css`包含那个子目录。

有什么方法可以获取有关请求源的更多上下文，以便在查找请求的文件时修复路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-02T08:43:40.863

我有一个非常相似的问题，在这里解释：[Loading resources from relative paths through NSURLProtocol subclass](https://stackoverflow.com/questions/11874795/loading-resources-from-relative-paths-through-nsurlprotocol-subclass)

我有以下内容`NSURLProtocol`：

```
- (void)startLoading {
    [self.client URLProtocol:self
          didReceiveResponse:[[NSURLResponse alloc] init]
          cacheStoragePolicy:NSURLCacheStorageNotAllowed];
    //Some other stuff
} 
```

并解决了以下问题：

```
- (void)startLoading {
    [self.client URLProtocol:self
          didReceiveResponse:[[NSURLResponse alloc] initWithURL:_lastReqURL MIMEType:nil expectedContentLength:-1 textEncodingName:nil]
          cacheStoragePolicy:NSURLCacheStorageNotAllowed];
    //Some other stuff
} 
```

_lastReqURL 在哪里`_lastReqURL = request.URL;`，从

```
- (id)initWithRequest:(NSURLRequest *)request cachedResponse:(NSCachedURLResponse *)cachedResponse client:(id < NSURLProtocolClient >)client {
    self = [super initWithRequest:request cachedResponse:cachedResponse client:client];
    if (self) {
        _lastReqURL = request.URL;
        // Some stuff
    }
} 
```

我只能假设 NSURLResponse 中的 URL 部分在处理相对路径时至关重要（似乎合乎逻辑）。

# mongodb - C# MongoDb 连接到副本集问题

> ID：11874796
> 
> 赞同：5
> 
> 时间：2012-08-08T23:39:01.723
> 
> 标签：mongodb, mongodb-.net-driver

根据 mongodb 网站，如果我只给它一个副本集中的成员，我应该能够连接到副本集：

“即使种子列表不完整，C# 驱动程序也能够连接到副本集。只要种子列表中至少有一个服务器响应，即使它不在种子列表中，它也会找到主服务器（响应将包含完整的副本集和当前主节点的名称）。” [http://www.mongodb.org/display/DOCS/CSharp+Driver+Tutorial#CSharpDriverTutorial-Connectionstrings](http://www.mongodb.org/display/DOCS/CSharp+Driver+Tutorial#CSharpDriverTutorial-Connectionstrings)

但是，如果我只是给它一个次要成员，我无法让我的驱动程序连接。

这是我当前的连接声明：

`m_server = MongoServer.Create(new MongoServerSettings { ConnectionMode = ConnectionMode.ReplicaSet, Server = new MongoServerAddress(connection) });`

“连接”变量是：`mongodb://servername/?safe=true`

我看到了这个：[https](https://jira.mongodb.org/browse/CSHARP-500) ://jira.mongodb.org/browse/CSHARP-500 ，我确实运行了 rs.status()，并且使用了正确的服务器名称。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-07-04T04:34:50.397

目前我正在学习 MongoDB，并且正在玩副本集连接。我喜欢用我用来连接数据库的 2 种方式做出贡献，这些方式我觉得有用，如果对任何人没有帮助，至少我将来会有一个地方可以参考（我确定我要去在某些时候需要它）首先：

```
var connString = "mongodb://localhost:27029,localhost:27027,localhost:27028?connect=replicaSet";
var client = new MongoClient(connString);
var db = client.GetDatabase("test"); 
```

第二：

```
var settings = new MongoClientSettings
{
   Servers = new[]
   {
      new MongoServerAddress("localhost", 27027),
      new MongoServerAddress("localhost", 27028),
      new MongoServerAddress("localhost", 27029)
   },
   ConnectionMode = ConnectionMode.Automatic,
   ReplicaSetName = "m101",
   WriteConcern = new WriteConcern(WriteConcern.WValue.Parse("3"),wTimeout:TimeSpan.Parse("10"))
};
var client = new MongoClient(settings); 
```

首先，允许我通过服务器列表中指定的服务器连接到数据库。这允许驱动程序在主体发生故障的情况下自动连接到副本集中的新主体节点。第二个，我发送副本集中的服务器列表，连接类型。副本集的名称和写入关注点配置。使用此设置，我强制驱动程序等待来自副本集中 3 个服务器的写入确认 (WValue:3)，并最多等待 10 秒以确认写入。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-09T03:54:35.863

所以，连接变量是一个完整的连接字符串，而不是传递给 MongoServerAddress 的东西。此外，您还可以在连接字符串上指定连接模式。试试这个：

```
connection = "mongodb://servername/?safe=true&connect=replicaset";
m_server = MongoServer.Create(connectionString); 
```

# objective-c - 无法在包 ImageViewCell 中加载 NIB

> ID：11874797
> 
> 赞同：1
> 
> 时间：2012-08-08T23:39:12.117
> 
> 标签：objective-c, ios, xcode

运行模拟器时出现此错误。该项目不是在此环境中创建的，不确定我是否缺少配置设置。

> **错误** 2012-08-08 19:30:56.411 ACME[4068:f803] mItemArray.count: 2 2012-08-08 19:30:56.413 ACME[4068:f803] ***由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：'无法在包中加载NIB：'NSBundle（已加载）'，名称为'ImageViewCell''

```
if(cell == nil)
{
    NSArray *array = [[NSBundle mainBundle] loadNibNamed:@"ImageViewCell" owner:self options:nil];
    cell = [array objectAtIndex:0];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T13:34:46.633

“loadNibNamed:”之后的名称必须是 nib 文件的名称（在屏幕左侧的项目导航器中），有时人们会在 CellForRowAtIndexPath （静态 NSString ...）中从头开始写入“单元标识符” .

这个小故障可能是你的问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:55:23.290

您尚未将 NIB 文件中的“文件所有者”设置为您在代码中设置的所有者。当 NIB 加载器无法将 NIB 中的对象链接到正确的根所有者时，它会像这样失败。

# javascript - JQuery：如何遍历 div 的所有子元素

> ID：11874799
> 
> 赞同：9
> 
> 时间：2012-08-08T23:39:35.843
> 
> 标签：javascript, jquery

我正在尝试遍历给定 div 中的所有元素并将结果（我稍后将使用的 C# 代码）输出到屏幕进行测试。

所以如果我有这样的html：

```
 <div id="testDiv">
        <test>
            <a>aVal</a>
            <c>
                <cc>ccVal</cc>
            </c>
       </test>
    </div> 
```

我正在尝试生成此字符串值：

```
HtmlElement.CreateNode("test").AddNode(CreateNode("a").addText("aVal")).AddNode(CreateNode("c").AddNode(CreateNode("cc").addText("ccVal")) 
```

现在我已经安装了这个 jquery，但我不确定如何深入到其他节点：

```
var x = "HtmlElement.";
$('div#testDiv').children().each(function () {    
    var nodeNameStr = this.nodeName.toLowerCase();
    var nodeText = $(this).text();
    x += "CreateNode(nodeNameStr).addText(nodeText)"
}); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-08-08T23:45:25.000

[jsFiddle 示例](http://jsfiddle.net/NBzgM/)

```
$('#testDiv').find('*').each(function() {
     // do stuff
}); 
```

​​​

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-08T23:51:20.243

这是一个比以前的答案更完整的示例：

[http://jsfiddle.net/4QtS5/](http://jsfiddle.net/4QtS5/)

```
// returns the 'AddNode(...)' method call for every child.    
function addChildren(element){
   var command = "";
   $(element).find("> *").each(function(){
      command += ".AddNode("+createNode(this)+")";
   });
   return command;
}

// if the element has text, add the text
function addText(element){
   var elementText = $(element).clone().children().remove().end().text().trim();
   if(elementText) {
      return ".addText(\""+elementText+"\")";
   } else {
      return "";
   }
}

// returns the 'CreateNode(...)' method call for a node and all its children.
function createNode(element){
   var nodeName =  element.nodeName.toLowerCase();
   var csharpCommand = "CreateNode(\""+nodeName+"\")";
   csharpCommand += addChildren(element);
   csharpCommand += addText(element);
   return csharpCommand;
}

// begin
$("div#testDiv > *").each(function(){
    var csharpCommand = "HtmlElement."+createNode(this);
    console.log(csharpCommand);
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-08T23:42:52.473

您正在循环遍历 div 的直接子代，而不是所有子代。为此，请使用以下代码：

```
$('div#testDiv *').each(function(){
    // Your Code
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-09-26T09:51:24.630

您可以通过以下方式使用 div id 获取所有子项：

```
$('#youDivId').children().each(function(){
     alert(this.value);
}); 
```

# c# - 更改 RichTextBox 中选定文本的样式

> ID：11874800
> 
> 赞同：4
> 
> 时间：2012-08-08T23:39:39.910
> 
> 标签：c#, .net, wpf, richtextbox

如何更改选定文本的样式（例如字体、字体大小、画笔）`RichTextBox`？

**更新：**假设我有一个`RichTextBox`和一个工具栏。用户来并在 RichTextBox 框中选择文本并从工具栏更改字体大小。我想更改所选文本的样式。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-08T23:48:35.430

WPF

```
if (this.TextEditor.Selection.IsEmpty)
    this.TextEditor.CurrentFontFamily = SelectedFont;
else
    this.TextEditor.Selection.ApplyPropertyValue(TextElement.FontFamilyProperty, SelectedFont); 
```

或另一个 WPF 示例

```
 private void ChangeTextProperty(DependencyProperty dp, string value)
    {
        if (mainRTB == null) return;

        TextSelection ts = richTextBox.Selection;
        if (ts!=null)
            ts.ApplyPropertyValue(dp, value);
        richTextBox.Focus();
    } 
```

这是一些示例 Windows 更改字体和字体颜色（不是 wpf）

```
richTextBox1.SelectionFont = new Font("Tahoma", 12, FontStyle.Bold);
richTextBox1.SelectionColor = System.Drawing.Color.Red; 
```

下面的另一个例子（不是wpf）

```
private void WriteTextToRichTextBox()
{
   // Clear all text from the RichTextBox;
   richTextBox1.Clear();
   // Set the font for the opening text to a larger Arial font;
   richTextBox1.SelectionFont = new Font("Arial", 16);
   // Assign the introduction text to the RichTextBox control.
   richTextBox1.SelectedText = "The following is a list of bulleted items:" + "\n";
   // Set the Font for the first item to a smaller size Arial font.
   richTextBox1.SelectionFont = new Font("Arial", 12);
   // Specify that the following items are to be added to a bulleted list.
   richTextBox1.SelectionBullet = true;
   // Set the color of the item text.
   richTextBox1.SelectionColor = Color.Red;
   // Assign the text to the bulleted item.
   richTextBox1.SelectedText = "Apples" + "\n";
   // Apply same font since font settings do not carry to next line.
   richTextBox1.SelectionFont = new Font("Arial", 12);
   richTextBox1.SelectionColor = Color.Orange;
   richTextBox1.SelectedText = "Oranges" + "\n";
   richTextBox1.SelectionFont = new Font("Arial", 12);
   richTextBox1.SelectionColor = Color.Purple;
   richTextBox1.SelectedText = "Grapes" + "\n";
   // End the bulleted list.
   richTextBox1.SelectionBullet = false;
   // Specify the font size and string for text displayed below bulleted list.
   richTextBox1.SelectionFont = new Font("Arial", 16);
   richTextBox1.SelectedText = "Bulleted Text Complete!";
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-08T23:51:57.280

对于 WPF RichTextBox，您必须对 TextRange 使用 ApplyPropertyValue 方法。您可以使用 RichTextBox 实例的 Selected 属性获取选定的 TextRange。

```
var selection = myRichTextBox.Selection;
if (!selection.IsEmpty)
    selection.ApplyPropertyValue(TextElement.FontSizeProperty, 10.0); 
```

# iphone - 在 ios 中调用方法时的超精度

> ID：11874801
> 
> 赞同：0
> 
> 时间：2012-08-08T23:39:41.993
> 
> 标签：iphone, objective-c, ios, xcode, timing

我正在使用 xcode 在 ios 上编写应用程序，经过大量工作后，我发现该功能实际上取决于方法调用的准确性。在代码中逐行调用它们并没有帮助，它们仍然以 tp 150 ms 的差异相互调用。所以我需要让两种方法以最小的时间差运行，因此“同时”。我正在执行的这两个任务实际上是音频和视频任务，所以我知道它可能还包括进程内延迟和延迟，所以我想知道你们可能对如何同步音频任务和视频任务有任何了解，所以他们开始一起跑步，时间间隔非常小。我尝试使用调度队列和类似的东西，但它们不起作用。

如果我不够清楚，我会很乐意详细说明。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:53:55.773

你不能让一个中断驱动的多任务操作系统表现得像一个实时操作系统。

它只是不那样工作。

您需要使用各种多媒体 API 来设置音频和视频在其中同步的播放上下文（我不知道）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:52:44.397

Apple 在同步音频和视频方面拥有 API 和文档。 [http://developer.apple.com](http://developer.apple.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T23:57:20.607

显然，按顺序（串行）调用方法不会满足您的要求，因为每个方法调用都需要一定的时间，在此期间后续方法将被阻塞。

要同时运行多个通用任务（可能在现代多核设备上真正同时运行），您确实需要通过“调度队列和类似的东西”进行线程化。GCD 肯定*会*起作用，因此您需要详细说明“它们不起作用”是什么意思。

但这一切可能都是徒劳的，因为您不是在谈论通用任务。如果您正在处理音频和视频任务，那么您真的不应该在 CPU 上使用自己的代码来完成所有这些工作；你*需要*硬件加速，Apple[提供了框架来帮助](https://developer.apple.com/technologies/mac/audio-and-video.html)。我可能会先看看[AV Foundation](http://developer.apple.com/library/ios/#DOCUMENTATION/AVFoundation/Reference/AVFoundationFramework/_index.html)框架，然后，根据你想要做什么（你在你的问题中并没有真正说......）看看不同的[OpenAL](http://developer.apple.com/library/ios/#technotes/tn2199/_index.html)，[核心视频](https://developer.apple.com/library/mac/#documentation/GraphicsImaging/Conceptual/CoreVideo/CVProg_Intro/CVProg_Intro.html)和[核心音频](https://developer.apple.com/library/mac/#documentation/MusicAudio/Conceptual/CoreAudioOverview/Introduction/Introduction.html)。（有一[本](https://rads.stackoverflow.com/amzn/click/com/0321636848)关于后者的书好评如潮，但我自己没有看过，而且说实话，我不是 A/V 开发人员。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T00:02:15.093

您可能知道，在任何多任务环境中（尤其是在单核设备上），您将无法保证正在执行的语句之间的时间安排。

但是，由于您提到了音频和视频的播放，Apple 确实提供了一些基础知识，可以通过其框架实现这一点。

**[AVSynchronizedlayer](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVSynchronizedLayer_Class/Reference/Reference.html#//apple_ref/occ/cl/AVSynchronizedLayer "AVSynchronizedLayer")** - 如果您的某些视频或音频可以从[AVPlayerItem](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVPlayerItem_Class/Reference/Reference.html#//apple_ref/occ/cl/AVPlayerItem)（支持多种格式）播放，您可以构建与其同步的其他事件树，从关键帧动画到其他 AVPlayerItem。

如果您特别需要多个音轨，那么 Core Audio 中也有一些更简单的结构可以做到这一点。

如果你能给出一个更具体的例子来说明你的需求，那么有人可能会提供更多的想法。

# asp.net - <#= #> 是什么意思

> ID：11874802
> 
> 赞同：5
> 
> 时间：2012-08-08T23:39:47.843
> 
> 标签：asp.net, .net, syntax, expression, t4

阅读[代码生成和 T4 文本模板](http://msdn.microsoft.com/en-us/library/bb126445.aspx)，我发现了这种语法 <#= DateTime.Now #>

```
<html><body>
 The date and time now is: <#= DateTime.Now #>
</body></html> 
```

它与`<%= DateTime.Now %>`或有何不同`<%# DateTime.Now %>`。

谷歌搜索什么也没显示

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:48:10.737

我不能声称对 T4 文本模板非常熟悉，但似乎区别在于设计/构建时代码生成（可以包括可执行语句）和运行时代码执行之间。

因此`<#= #>`计算用于生成文件的模板中的表达式。

并`<%= %>`执行块内的代码并将其写入输出流。这将在页面第一次执行时进行 JIT 编译，但关键是它表示在页面运行时执行的代码块，而不是在模板文件的生成期间。

第三种形式，`<%# %>`表示数据绑定表达式，也在页面执行时进行评估。

> **表达式控制块**
> 
> 表达式控制块计算表达式并将其转换为字符串。这被插入到输出文件中。
> 
> 表达式控制块由符号 <#= ... #> 分隔
> 
> 例如，以下控制块导致输出文件包含“5”：
> 
> `<#= 2 + 3 #>`

来源：http: [//msdn.microsoft.com/en-us/library/bb126478](http://msdn.microsoft.com/en-us/library/bb126478)

# mysql - 在同一张表中获取我的用户的余额

> ID：11874804
> 
> 赞同：1
> 
> 时间：2012-08-08T23:40:28.967
> 
> 标签：mysql, sql

请帮忙，我有一张这样的桌子：

```
 | ID | userId   | amount  | type    |
 -------------------------------------
 |  1 |       10 |  10     | expense |
 |  2 |       10 |  22     | income  |
 |  3 |        3 |  25     | expense |
 |  4 |        3 |  40     | expense |
 |  5 |        3 |  63     | income  | 
```

我正在寻找一种方法来使用一个查询并检索每个用户的平衡。

当必须将金额添加到费用中并从收入中减去时，困难的部分就来了。

这将是结果表：

```
 | userId | balance |
 --------------------
 |   10   |  12     |
 |    3   |  -2     | 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-08T23:50:04.903

您需要获取每个总数`income`并`expense`使用***子查询***，然后再***加入***它们，这样您就可以`subtract expense from income`

```
SELECT  a.UserID,
        (b.totalIncome - a.totalExpense) `balance`
FROM
(
    SELECT  userID, SUM(amount) totalExpense
    FROM    myTable
    WHERE   type = 'expense'
    GROUP BY userID
) a INNER JOIN
(
    SELECT  userID, SUM(amount) totalIncome
    FROM    myTable
    WHERE   type = 'income'
    GROUP BY userID
) b on a.userID = b.userid 
```

# [*SQLFiddle 演示*](http://sqlfiddle.com/#!2/3bc18/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T01:31:18.630

这对单个组最简单，方法是：

```
select user_id,
       sum(case when type = 'income' then amount else - amount end) as balance
from t
group by user_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T23:47:43.687

您可以有 2 个子查询，每个子查询按 id 分组：一个汇总收入，另一个汇总支出。然后你可以将它们连接在一起，这样每一行都有一个 id、费用总和和收入总和，你可以从中轻松计算余额。

# actionscript-3 - 在 AS3 中创建链表

> ID：11874805
> 
> 赞同：2
> 
> 时间：2012-08-08T23:40:46.860
> 
> 标签：actionscript-3, actionscript, linked-list

如何在 actionScript 3.0 中创建链表？我有一个项目，我应该从用户那里获取一些整数并通过树算法对它们进行排序，例如堆排序并在闪存中显示树，我认为我应该使用链表通过树算法对数据进行排序。所以任何人都知道如何创建一个可以插入节点、删除节点和传递节点的链表，就像 C++ 链表一样。谢谢。南非

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T09:59:51.267

您可以使用或以[as3Commons 链表实现为例](http://www.as3commons.org/as3-commons-collections/asdoc/index.html)。它们提供了非常漂亮的实现和非常好的抽象层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T14:56:40.090

如果您有权访问该`mx`软件包，则可以使用[mx.utils.LinkedList](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/utils/LinkedList.html)。

要构建`LinkedList`你可以重复`push`或`unshift`项目到它。

```
var input:Array = getInput();
var myList:LinkedList = new LinkedList();
for each (var o:Object in input) {
    myList.push(o);
} 
```

# android - Android RSS 应用程序中的 NullPointerException

> ID：11874809
> 
> 赞同：1
> 
> 时间：2012-08-08T23:41:21.960
> 
> 标签：android, nullpointerexception, sax, android-logcat, rss-reader

我正在尝试构建一个 android RSS 阅读器应用程序，但我不断收到 Null 指针异常。我是 java 新手，不知道它的提要 url 是没有返回任何数据还是数据没有正确存储。

我的 logcat 内容如下：

```
08-08 18:44:25.840: E/Trace(621): error opening trace file: No such file or directory (2)
08-08 18:44:25.910: W/ActivityThread(621): Application com.app.fullmetalmanga is waiting for the debugger on port 8100...
08-08 18:44:25.930: I/System.out(621): Sending WAIT chunk
08-08 18:44:25.951: I/dalvikvm(621): Debugger is active08-08 18:44:26.140: I/System.out(621): Debugger has connected
08-08 18:44:27.710: I/System.out(621): debugger has settled (1382)
08-08 18:44:29.291: D/gralloc_goldfish(621): Emulator without GPU emulation detected.
08-08 18:44:48.060: W/System.err(621): java.lang.NullPointerException
08-08 18:44:48.760: W/System.err(621):  at java.util.Calendar.setTime(Calendar.java:1324)
08-08 18:44:48.810: W/System.err(621):  at java.text.SimpleDateFormat.formatImpl(SimpleDateFormat.java:536)
08-08 18:44:49.050: W/System.err(621):  at java.text.SimpleDateFormat.format(SimpleDateFormat.java:821)
08-08 18:44:49.150: W/System.err(621):  at java.text.DateFormat.format(DateFormat.java:376)
08-08 18:44:49.490: W/System.err(621):  at com.app.fullmetalmanga.RssItem.getDate(RssItem.java:48)
08-08 18:44:49.810: W/System.err(621):  at com.app.fullmetalmanga.MainActivity$RSSHandler.endElement(MainActivity.java:146)
08-08 18:44:50.090: W/System.err(621):  at org.apache.harmony.xml.ExpatParser.endElement(ExpatParser.java:156)
08-08 18:44:50.250: W/System.err(621):  at org.apache.harmony.xml.ExpatParser.appendBytes(Native Method)
08-08 18:44:50.410: W/System.err(621):  at org.apache.harmony.xml.ExpatParser.parseFragment(ExpatParser.java:513)
08-08 18:44:50.610: W/System.err(621):  at org.apache.harmony.xml.ExpatParser.parseDocument(ExpatParser.java:474)
08-08 18:44:50.791: W/System.err(621):  at org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:321)
08-08 18:44:50.990: W/System.err(621):  at org.apache.harmony.xml.ExpatReader.parse(ExpatReader.java:279)
08-08 18:44:51.800: W/System.err(621):  at com.app.fullmetalmanga.MainActivity$SAXHelper.parseContent(MainActivity.java:112)
08-08 18:44:51.870: W/System.err(621):  at com.app.fullmetalmanga.MainActivity$loadingTask.doInBackground(MainActivity.java:74)
08-08 18:44:52.350: W/System.err(621):  at com.app.fullmetalmanga.MainActivity$loadingTask.doInBackground(MainActivity.java:1)
08-08 18:44:52.700: W/System.err(621):  at android.os.AsyncTask$2.call(AsyncTask.java:287)
08-08 18:44:53.070: W/System.err(621):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
08-08 18:44:53.190: W/System.err(621):  at java.util.concurrent.FutureTask.run(FutureTask.java:137)
08-08 18:44:53.370: W/System.err(621):  at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
08-08 18:44:53.561: W/System.err(621):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
08-08 18:44:53.980: W/System.err(621):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
08-08 18:44:54.051: W/System.err(621):  at java.lang.Thread.run(Thread.java:856) 
```

我的主要活动：

```
public class MainActivity extends Activity {
/** Called when the activity is first created. */
ListView lv1;
ProgressDialog ShowProgress;
public ArrayList<RssItem> RssItemList = new ArrayList<RssItem>();

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    lv1 = (ListView) findViewById(R.id.listView1);

    ShowProgress = ProgressDialog.show(MainActivity.this, "",
            "Loading. Please wait...", true);
    new loadingTask().execute("http://fandom.com/rss/news/manga");

    lv1.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

            Intent intent = new Intent(Intent.ACTION_VIEW).setData(Uri
                    .parse(RssItemList.get(position).getTitle()));
            startActivity(intent);

        }
    });       
}

class loadingTask extends AsyncTask<String, Void, String> {

    protected String doInBackground(String... urls) {

        SAXHelper sh = null;
        try {
            sh = new SAXHelper(urls[0]);
        } catch (MalformedURLException e) {
            e.printStackTrace();
        }
        sh.parseContent("");
        return "";

    }

    protected void onPostExecute(String s) {
        lv1.setAdapter(new EfficientAdapter(MainActivity.this, RssItemList));
        ShowProgress.dismiss();

    }
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

class SAXHelper {
public HashMap<String, String> userList = new HashMap<String, String>();
private URL url2;

public SAXHelper(String url1) throws MalformedURLException {
    this.url2 = new URL(url1);
}

public RSSHandler parseContent(String parseContent) {
    RSSHandler df = new RSSHandler();
    try {

        SAXParserFactory spf = SAXParserFactory.newInstance();
        SAXParser sp = spf.newSAXParser();
        XMLReader xr = sp.getXMLReader();
        xr.setContentHandler(df);
        xr.parse(new InputSource(url2.openStream()));
    } catch (Exception e) {
        e.printStackTrace();
    }
    return df;
}
}

class RSSHandler extends DefaultHandler {

private RssItem currentPost = new RssItem();
StringBuffer chars = new StringBuffer();

@Override
public void startElement(String uri, String localName, String qName,
        Attributes atts) {

    chars = new StringBuffer();
    if (localName.equalsIgnoreCase("item")) {

    }
}

@Override
public void endElement(String uri, String localName, String qName)
        throws SAXException {

    if (localName.equalsIgnoreCase("title")
            && currentPost.getTitle() == null) {
        currentPost.setTitle(chars.toString());

    }
    if (localName.equalsIgnoreCase("pubDate")
            && currentPost.getDate() == null) {
        currentPost.setDate(chars.toString());

    }
    /*if (localName.equalsIgnoreCase("thumbnail")
            && currentPost.getThumbnail() == null) {
        currentPost.setThumbnail(chars.toString());

    } */
    if (localName.equalsIgnoreCase("link")
            && currentPost.getLink() == null) {
        currentPost.setLink(chars.toString());
    }

    if (localName.equalsIgnoreCase("item")) {
        RssItemList.add(currentPost);
        currentPost = new RssItem();
    }

}

@Override
public void characters(char ch[], int start, int length) {
    chars.append(new String(ch, start, length));
}

   }

} 
```

我的 RssItem 类：

```
public class RssItem {

static SimpleDateFormat FORMATTER = 
        new SimpleDateFormat("EEE, dd MMM yyyy HH:mm:ss Z");
    private String title;
    private URL link;
    private String description;
    private Date date;

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title.trim();
    }
    // getters and setters omitted for brevity 
    public URL getLink() {
        return link;
    }

    public void setLink(String link) {
        try {
            this.link = new URL(link);
        } catch (MalformedURLException e) {
            throw new RuntimeException(e);
        }
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description.trim();
    }

    public String getDate() {
        return FORMATTER.format(this.date);
    }

    public void setDate(String date) {
        // pad the date if necessary
        while (!date.endsWith("00")){
            date += "0";
        }
        try {
            this.date = FORMATTER.parse(date.trim());
        } catch (ParseException e) {
            throw new RuntimeException(e);
        }
    }

} 
```

我的代码是使用[这个](http://www.ingeniumblog.net/2012/01/making-a-slick-rss-reader-in-android/)例子编写的。仅更改 URL 并使用我自己修改过的“发布”文件。（重命名为 RssItem）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:03:12.720

看来，`date`在 RssItem 中，当您将其传递给您的 SimpleDateFormat 时，会引发异常：

```
public String getDate() {
    return FORMATTER.format(this.date); // FORMATTER cannot format a null value
} 
```

您需要定义一个默认的`date`或其他礼貌的方法来处理这个：

```
public String getDate() {
    if(this.date == null)
        return "";
    return FORMATTER.format(this.date);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T00:04:23.560

看起来您从未在 RssItem 中初始化您的日期属性。如果尚未完成，您可能需要在 getDate() 中添加检查以初始化日期属性。或者更好的是，在您的构造函数中执行此操作。不过，我对使用 RSS 提要不是很熟悉。

# ios - UIGroupedTableViewCell 上的背景问题

> ID：11874815
> 
> 赞同：0
> 
> 时间：2012-08-08T23:42:02.307
> 
> 标签：ios, xcode, interface

我正在使用以下代码生成背景

```
 cell.backgroundView = [ [[UIImageView alloc] initWithImage:[ [UIImage imageNamed:@"list-item.png"] stretchableImageWithLeftCapWidth:0.0 topCapHeight:00.0] ]autorelease]; 
```

这会产生以下结果，其中 textLabel 似乎在文本周围有某种背景。有没有人有这个问题的经验？我确保将 textlabel 的 backgroundview 设置为 nil，但它仍然不起作用。

[http://cl.ly/image/3K1P1O473v05](http://cl.ly/image/3K1P1O473v05)（由于代表不能直接发布图片）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-08T23:45:25.797

`UILabel`没有`backgroundView`财产。确保`backgroundColor`设置为`[UIColor clearColor]`.

# android - Android：使用处理程序和可运行更新 App Widget TextView

> ID：11874817
> 
> 赞同：2
> 
> 时间：2012-08-08T23:42:09.797
> 
> 标签：android, service, android-appwidget, runnable

我正在尝试制作一个经常更改 TextView 值的应用小部件——一个秒表小部件。为此，我使用在处理程序中启动的可运行对象来更新值，然后将 textview 设置为这些值。出于某种原因，文本视图并没有更新。一切正常，文本视图不会更新。

以下是 Handler 和 Runnable 的代码：

```
RemoteViews remoteViews;
long sStart, elapsedTime;
private final int REFRESH_RATE = 100;
private Handler sHandler = new Handler();
private Runnable startStopwatch = new Runnable() {
    @Override
    public void run() {
        final long start = sStart;
        elapsedTime = System.currentTimeMillis() - start;
        updateStopwatch(elapsedTime);
        sHandler.postDelayed(this, REFRESH_RATE);
    }
};

private void updateStopwatch(long time) {
    int seconds = (int) time / 1000;
    int minutes = seconds / 60;
    int hours = minutes / 60;
    long millis = time % 1000;
    seconds = seconds % 60;

    remoteViews.setTextViewText(R.id.tvStopwatchWidget, String.format("%d : %02d : %02d", hours, minutes, seconds));
    remoteViews.setTextViewText(R.id.tvStopwatchMillisWidget, String.format(". %03d", millis));

} 
```

我在 onUpdate 方法中设置了所有内容，一切正常。onReceive 方法，我应该在单击按钮时更新文本视图，是这样的：

```
 @Override
public void onReceive(Context context, Intent intent) {
    remoteViews = new RemoteViews(context.getPackageName(), R.layout.stopwatch_widget_layout);
    if (intent.getAction().equals(ACTION_STOPWATCH_WIDGET_START)) {
        if (sStart == 0L) {
            sStart = System.currentTimeMillis();
        } else {
            sStart = System.currentTimeMillis() - elapsedTime;
        }
        sHandler.removeCallbacks(startStopwatch);
        sHandler.postDelayed(startStopwatch, REFRESH_RATE);
    }
    ComponentName widget = new ComponentName(context, StopwatchWidgetProvider.class);
    AppWidgetManager.getInstance(context).updateAppWidget(widget, remoteViews);
    super.onReceive(context, intent);
} 
```

这是我用来为实际应用程序更新它的相同代码，它有效，只是针对应用程序小部件进行了修改。我知道时间正在正确更新——如果我在日志中显示它，它会正确更新时间。如果我直接在 onReceive 方法中更改它，我也知道 textview 会正确更改。一切似乎都在工作，但由于某种原因，它不会更新它尝试在 Runnable 中的时间，所以我真的不知道如何解决这个问题。

我也尝试过使用服务，但效果并没有更好。它的代码是：

```
public class SWStartService extends Service {

RemoteViews remoteViews;
long sStart = 0;
long elapsedTime;
private final int REFRESH_RATE = 100;
private Handler sHandler = new Handler();
private Runnable startStopwatch = new Runnable() {
    @Override
    public void run() {
        final long start = sStart;
        elapsedTime = System.currentTimeMillis() - start;
        updateStopwatch(elapsedTime);
        sHandler.postDelayed(this, REFRESH_RATE);
    }
};
String sMain, sMillis;

private void updateStopwatch(long time) {
    int seconds = (int) time / 1000;
    int minutes = seconds / 60;
    int hours = minutes / 60;
    long millis = time % 1000;
    seconds = seconds % 60;

    remoteViews.setTextViewText(R.id.tvStopwatchWidget, String.format("%d : %02d : %02d", hours, minutes, seconds));
    remoteViews.setTextViewText(R.id.tvStopwatchMillisWidget, String.format(". %03d", millis));
    Intent i1 = new Intent(getApplicationContext(), SWStartService.class);
    sMain = String.format("%d : %02d : %02d", hours, minutes, seconds);
    sMillis = String.format(". %03d", millis);
    //  Log.d("TEST TIME", String.format("%d : %02d : %02d . %03d", hours, minutes, seconds, millis));
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    remoteViews = new RemoteViews(getApplicationContext().getPackageName(), R.layout.stopwatch_widget_layout);
    if (sStart == 0L) {
        sStart = System.currentTimeMillis();
    } else {
        sStart = System.currentTimeMillis() - elapsedTime;
    }
    sHandler.removeCallbacks(startStopwatch);
    sHandler.postDelayed(startStopwatch, 100);
    intent.putExtra("sMainWidget", sMain);
    intent.putExtra("sMillisWidget", sMillis);

    sendBroadcast(intent);
    return START_REDELIVER_INTENT;
}

@Override
public IBinder onBind(Intent intent) {
    return null;
} 
```

}

该服务在 onReceive 方法中调用，如下所示：

```
Intent intent1 = new Intent(context, SWStartService.class);
context.startService(intent1); 
```

我尝试了其他一些技术来启动服务，但我仍然无法更新 TextView。

我知道这很草率，我尝试了几种不同的技术来让它工作，但都没有奏效，我也没有清理旧的技术。它不适用于直接更改 remoteViews，或者通过从意图中获取额外内容来更改 appwidget 类中的它们。一切都只是返回空白/空——出于某种原因进入或退出服务的意图附加或远程视图。而且我意识到这对电池来说可能不是很好，也可能不是很有效，但让我感到困扰的是，我什至根本无法更新 TextView。

有什么建议么？

**编辑**：有人可能想要解决方案，所以在这里：

```
//Global Variables
ComponentName widget;
AppWidgetManager awManager;

//Set them up in onReceive method
    remoteViews = new RemoteViews(context.getPackageName(), R.layout.stopwatch_widget_layout);
    widget = new ComponentName(context, StopwatchWidgetProvider.class);
    awManager = AppWidgetManager.getInstance(context);
    if (intent.getAction().equals(ACTION_STOPWATCH_WIDGET_START)) {
        //showStopButton();
        if (sStart == 0) {
            sStart = System.currentTimeMillis();
        } else {
            sStart = System.currentTimeMillis() - elapsedTime;
        }
        sHandler.removeCallbacks(startStopwatch);
        sHandler.postDelayed(startStopwatch, REFRESH_RATE);
    }
    awManager.updateAppWidget(widget, remoteViews);
    super.onReceive(context, intent);

//update appwidget in runnable
        final long start = sStart;
        elapsedTime = System.currentTimeMillis() - start;
        updateStopwatch(elapsedTime);
        sHandler.postDelayed(this, REFRESH_RATE);
        awManager.updateAppWidget(widget, remoteViews); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-13T08:28:15.963

你只调用`AppWidgetManager.updateAppWidget(widget, remoteViews)`一次。每次更新小部件时都需要调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T09:45:24.430

为什么你做的这么复杂（而且 CPU 密集型）？

只需设置一个服务，在启动时设置一个具有您选择的时间间隔的 AlarmManager。让 AlarmManager 向您的 AppWidgetProvider-class 发送广播并在那里捕获该意图。

现在只需更新您的小部件。

# perl - 在 Cygwin 上调用 Unicode::Collat e::Locale Perl 模块的“新”方法时出错

> ID：11874820
> 
> 赞同：2
> 
> 时间：2012-08-08T23:42:41.497
> 
> 标签：perl, cygwin

我[`Unicode::Collate::Locale`](https://wwww.metacpan.org/module/Unicode%3a%3aCollate%3a%3aLocale)在 Cygwin 上使用 Perl 5.14.2 对一些法语文本进行排序

```
use Unicode::Collate::Locale;
my $coll = Unicode::Collate::Locale->new(locale => "fr");
@french_text = $coll->sort(@french_text); 
```

我得到的错误是：

```
Unicode/Collate/Locale/fr.pl can't be found at ./program.pl line 16 
```

此错误消息是从以下文件生成的：

```
/usr/lib/perl5/5.14/i686-cygwin-threads-64int/Unicode/Collate/Locale.pm 
```

存在以下文件：

```
/usr/lib/perl5/5.14/Unicode/Collate/Locale/fr.pl 
```

但经过调查，我注意到 Locale.pm 正在寻找：

```
/usr/lib/perl5/5.14/i686-cygwin-threads-64int/Unicode/Collate/Locale/fr.pl 
```

该文件不存在，因此我收到错误消息。其他人看到这个问题吗？这是一个错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T01:07:58.400

您应该检查是否`Unicode::Collate::Locale`安装正确-

使用命令`instmodsh`检查已安装的模块。

```
MPBAB:work macpro$ instmodsh
Available commands are:
   l            - List all installed modules
   m <module>   - Select a module
   q            - Quit the program
cmd? m Unicode::Collate::Locale
Available commands are:
   f [all|prog|doc]   - List installed files of a given type
   d [all|prog|doc]   - List the directories used by a module
   v                  - Validate the .packlist - check for missing files
   t <tarfile>        - Create a tar archive of the module
   h                  - Display module help
   q                  - Quit the module
WWW::Mechanize cmd? f 
```

# ruby-on-rails - 如何在 attr_encrypted db 字段上添加索引？

> ID：11874823
> 
> 赞同：2
> 
> 时间：2012-08-08T23:42:54.983
> 
> 标签：ruby-on-rails, database, performance, postgresql, indexing

我有

```
attr_accessible :access_token
attr_encrypted :access_token, key: ENV['ENCRYPTION_KEY'] 
```

我正在做一些`User.find_by_access_token`，所以我想索引数据库中的字段。

然而，不`access_token`存在，只有`encrypted_access_token`。

索引这个是否与索引任何其他字段相同？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:03:44.490

保存加密数据的全部目的是防止显示*明文*。显然你不能搜索它，否则整个概念就会有缺陷。

您可以使用普通索引对*加密令牌进行索引，并使用**加密*令牌搜索表- 您显然需要加密密钥。

```
CREATE INDEX tbl_encrypted_access_token_idx ON tbl(encrypted_access_token);

SELECT *
FROM   tbl
WHERE  encrypted_access_token = <encrypted_token>; 
```

*如果*`IMMUTABLE`您的所有令牌都可以使用Postgres 函数解密，您可以[在表达式上使用索引](http://www.postgresql.org/docs/current/interactive/indexes-expressional.html)：

```
CREATE INDEX tbl_decrypted_token_idx
ON tbl(decrypt_func(encrypted_access_token));

SELECT *
FROM   tbl
WHERE  decrypt_func(encrypted_access_token) = <access_token>; 
```

请注意，表达式必须与索引中的表达式匹配才能使索引有用。

但这会*在多个层面上造成安全隐患*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-21T13:51:38.103

[我用谷歌搜索并找到了对加密字段快速搜索](http://postgresql.nabble.com/Fast-Search-on-Encrypted-Feild-td1863960.html)的参考。有评论提到“去识别数据”。似乎是一种[公认​​的方法](http://www.hhs.gov/ocr/privacy/hipaa/understanding/coveredentities/De-identification/guidance.html)。

这是我设想它的工作方式。在此示例中，我将患者姓名与患者记录的其余部分分开。

`Patient Row: [id=1, name_and_link=9843565346598789, …] Patient_name Row: [id=1, name=”John”, patient_link=786345786375657]`

name_and_link 字段是两个字段的加密副本：名称和指向 Patient_name 的链接。在两个表中都有名称是多余的。我建议它提供更快的访问（无需从 Patient_name 表中读取）。如有必要，还允许重新创建 Patient_name 表（例如，如果两个表不同步）。

Patient_name 表包含名称值的未加密副本。名称行可以被索引以便快速访问。要按名称搜索，请在 Patient_name 表中找到匹配的名称，然后使用加密链接返回 Patient 表。

注意：在上面的示例中，我将长数字显示为示例加密数据。实际上，在现实生活中情况更糟。根据加密方法，使用 Postgres 的 pgp_sym_encrypt() 函数的加密值的最小长度约为 67 字节。这意味着将字母“x”加密为 67 个字节。我建议为每个去标识字段设置两个加密字段。这就是为什么我建议在 Patient 表中将名称和链接一起加密（作为 JSON 元组？）。与分别加密两个字段相比，将空间开销减少了一半。

注意：这需要将一些字段分成几部分。（例如电话号码、SSN、地址）。每个部分都需要存储在单独的表中。即使是地址的街道部分也必须进一步细分。这变得越来越复杂。我希望看到 Postgres 自动执行此操作。

注意：仅控制对密码的访问本身就是一个棘手的问题。

# bash - 使用解压缩捕获错误？

> ID：11874826
> 
> 赞同：1
> 
> 时间：2012-08-08T23:43:23.890
> 
> 标签：bash, unzip

有时，我们会从供应商处收到看似已损坏的 ZIP 文件。尝试列出 ZIP 的内容将触发如下错误：

```
 $>unzip -qql JABL_VER_20120808_165910.zip
unzip:  cannot find or open JABL_VER_20120808_165910.zip, JABL_VER_20120808_165910.zip.zip or JABL_VER_20120808_165910.zip.ZIP. 
```

我快速阅读了 unzip 手册页并对该片段进行了编码以捕获上述错误

```
EXIT=`echo $?`
case $EXIT in
> 0-1) echo "Unzip Complete.";;
> *) echo "Unzip Failed.";;
> esac
$>Unzip Failed. 
```

它似乎工作。但是，在某些情况下，错误是不同的：

```
$>unzip -qql JABL_VER_20120808_175915.zip
  End-of-central-directory signature not found.  Either this file is not
  a zipfile, or it constitutes one disk of a multi-part archive.  In the
  latter case the central directory and zipfile comment will be found on
  the last disk(s) of this archive.
unzip:  cannot find zipfile directory in one of JABL_VER_20120808_175915.zip or
        JABL_VER_20120808_175915.zip.zip, and cannot find JABL_VER_20120808_175915.zip.ZIP, period. 
```

是否有一种“万无一失”的方法来捕获此类错误？

PS：不确定是否重要，但 ZIP 文件是在 MS Windows 上生成的；我们使用红帽。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T02:53:36.953

退出代码 1 也不好，1 遇到一个或多个警告错误，但无论如何处理成功完成。这包括由于不支持的压缩方法或使用未知密码加密而跳过一个或多个文件的 zipfile。

你应该试试

```
 unzip -t zipfilename 
```

并且只接受退出代码 0

为什么你有这么多错误？ftp'd 文本模式的文件？

# c - C中free（）的确切输出？

> ID：11874832
> 
> 赞同：0
> 
> 时间：2012-08-08T23:44:01.720
> 
> 标签：c, pointers, free, null-pointer

我想问一下，如果我有一个指向某个结构的指针，但是然后我 free(struct) 那么如果我取消引用该指针，它会指向 NULL 吗？我可以检查一下，指针！= NULL 还是未定义？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-08T23:49:48.833

在指针上调用 free() 不会更改指针值。它仍将指向不再属于您的应用程序的同一内存。您应该始终在释放指针后立即将 NULL 分配给已释放的指针，以确保您不会再次使用它。

```
void *p = malloc(10);    // p points to allocated memory
free(p);                 // p still points to invalid memory
p = NULL;                // good practice 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T02:07:34.350

考虑下面的代码

```
int main()
{
    int *p = (int *)malloc(sizeof(int) * 10);
    free(p);
} 
```

这里变量 p 是函数的局部变量`main`。此变量的大小将为 4 字节（在 32 位 m/c 中）或 8 字节（在 64 位 m/c 中）。现在我们正在分配内存来存储 10 个整数元素，并且该地址存储在 variable 中`p`。现在我们正在调用 free 函数，我们将动态内存地址传递给该函数，该地址存储在局部变量`p`中。现在 free 函数将释放内存，它将无法分配`NULL`给变量`p`。因为我们将地址作为值传递，而不是对指针的引用。

我们可以定义一个包装函数，`free`如下所示

```
void myfree(void **p)
{
    free(*p);
    *p = NULL;
}

int main()
{
    int *p = (int *)malloc(sizeof(int) * 10);
    myfree(&p);
} 
```

或者我们也可以定义宏功能

```
#define MYFREE(x) \
        free(x); \
        x = NULL; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-08T23:48:48.340

它是未定义的。尽管大多数实现什么都不做，但 C 没有定义它对指针内容的作用。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-09T00:01:35.343

看看[这个](http://www.cplusplus.com/reference/clibrary/cstdlib/free/)页面。

它清楚地说：

> 请注意，此函数使 ptr 的值保持不变，因此它仍然指向相同（现在无效）的位置，而不是空指针。

请注意，您需要确保指针在被释放后不被取消引用。

# primefaces - primefaces 行编辑数据表 ejb 更新返回旧数据

> ID：11874834
> 
> 赞同：0
> 
> 时间：2012-08-08T23:44:20.067
> 
> 标签：primefaces, datatable, ejb, row, edit

Salut :)，我是 primefaces 和 ajax 的新手

我正在使用 primefaces 3.4、glassfish 3.1、jsf2.0 和 ejb 3。我尝试实现 primefaces 展示数据表行编辑。但是当我将更新的值验证到数据表中时，我得到了旧值。这是我的代码：

```
<h:form id="form">
<p:growl id="messages" showDetail="true"/>
<p:dataTable var="item" value="#{jSFMBean.allContacts}" id="contactList" editable="true">
    <p:ajax event="rowEdit" listener="#{jSFMBean.onEdit}" update="@this :form:messages" />
    <p:ajax event="rowEditCancel" listener="#{jSFMBean.onCancel}" update=":form:messages" />
        <p:column headerText="EMAIL" style="width:125px">
                    <p:cellEditor>
                        <f:facet name="output">
                            <h:outputText value="#{item.email}" />
                        </f:facet>
                        <f:facet name="input">
                            <p:inputText value="#{item.email}" label="EMAIL"/>
                        </f:facet>
                    </p:cellEditor>
                </p:column><p:column headerText="Options" style="width:50px"> 
                    <p:rowEditor />
                </p:column>
     </p:dataTable>
<h:outputText value="#{jSFMBean.selectedContact.displayname}" /> 
```

方法是：

```
 public void onEdit(RowEditEvent event) {
    this.session.updateContact((Contacts) event.getObject());
    FacesMessage msg = new FacesMessage("Edition contact: ", ((Contacts) event.getObject()).getDisplayname());

    FacesContext.getCurrentInstance().addMessage(null, msg);
} 
```

**（联系人） event.getObject()**总是获取旧值:(。这就像在 ajax 更新到数据库之前首先启动数据表的 getter。

我在做什么错？感谢您帮助解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T22:25:18.937

目前您正在编辑对象中的值。看起来您仍然需要回调您的数据库以更新那里的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-09T17:52:01.610

似乎每当您需要数据表时，您都是从数据库中获取它，这就是为什么 event.getObject() 总是返回旧值。所以在数据表的 getter 中，您需要添加：

```
if (allContacts== null){

        allContacts= (List<Contacts>) yourservice.getAll();  /*this refers to the function that get the list from the database*/

    }

    return allContacts; 
```

我希望这可以帮助你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-04T14:01:55.510

很可能问题出在您的支持 bean 上。如果你使用@Named 注解而不是@ManagedBean (javax.faces.bean.ManagedBean) 作为你的backing bean，你就会面临这种问题。只需更换

> @Named (value="YourBeanName")

和

> @ManagedBean (name="YourBeanName")

# css - CSS 问题...固定位置消失

> ID：11874837
> 
> 赞同：1
> 
> 时间：2012-08-08T23:44:36.717
> 
> 标签：css, css-position

当我缩小浏览器并水平滚动时，left_nav 消失了。我试着改变位置。但这没有用。有什么建议吗？

```
#left_nav {
    position: fixed;
    height: 95%;
    width: 100px;
    background-color: #ededed;
    border-right: 1px solid #aaa
}

#container {
    margin-left: 100px;
    position: absolute;
    overflow: auto;
    width: 75%;
    min-width: 1129px;
    overflow: hidden;
    min-width: 1100;
    background-color: #fff;
    border-right: 1px solid #aaa;
    border-bottom: 1px solid #aaa;
    border-left: 1px solid #aaa;
    -webkit-border-bottom-right-radius: 20px;
    -moz-border-radius-bottomright: 20px;
    border-bottom-right-radius: 20px
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T13:14:23.440

```
#left_nav {
position: fixed;
top:0;
left:0;
height: 95%;
width: 100px;
background-color: #ededed;
border-right: 1px solid #aaa
} 
```

您应该如上所述为固定元素指定 left 和 top。这将从*浏览器窗口*的顶部和左侧放置左侧导航 0px 。

您是否尝试相对于容器指定它？如果是这样，您需要给 left_nav 一个**绝对**位置，给容器一个**相对位置**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:51:51.433

尝试添加`min-width: 100px;`到您的 left_nav，并摆脱`min-width: 1100;`容器...

请注意，您正在复制`min-width`属性；这是一个禁忌：

```
min-width: 1129px; 
overflow: hidden; 
min-width: 1100; 
```

# javascript - Instagram API 随机停止获取

> ID：11874841
> 
> 赞同：2
> 
> 时间：2012-08-08T23:44:45.230
> 
> 标签：javascript, api, limit, instagram

我今天早些时候刚刚为测试/学习目的（[http://himynameismarvin.com/instahelp](http://himynameismarvin.com/instahelp)）构建了一些东西，正如您通过访问它所看到的，它正在加载从 Instagram 请求的图像。

我继续前进并开始使用完全相同的脚本构建新的东西（ [http://himynameismarvin.com/instabroken ）。](http://himynameismarvin.com/instabroken)在我构建时它整天都在工作，然后随机决定不加载图像。我最初认为这是对 API 的限制，但我的第一个示例仍然有效，并且我使用相同的客户端 ID、身份验证代码等。

关于为什么会发生这种情况的任何原因？

**已修复**，但请参阅下面的评论

# asp.net - ASP.NET 表单身份验证在浏览器硬刷新之前不起作用

> ID：11874842
> 
> 赞同：2
> 
> 时间：2012-08-08T23:44:50.520
> 
> 标签：asp.net, .net, asp.net-mvc

我正在开发一个使用子域的 SAAS 应用程序。出于某种原因，隶属于具有长子域的公司的长名称用户在登录后无法访问该应用程序，直到浏览器进行硬刷新。在刷新之前，它们最终会进入重定向循环。这似乎仅适用于 Chrome 和 Firefox。这似乎是 cookie 缓存的问题，但我不能确定。

有没有人见过这个问题？

经过一番挖掘后，我发现这仅在启用 SSL 时才会发生。通过http没有问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T05:37:20.207

通过将 cookie 剥离到尽可能小来解决此问题。

原来大约 1kb 的 cookie 需要多个数据包来传输。所以，我的猜测是只有一个数据包可以通过我们的负载均衡器并使用 SSL？我无法确认问题背后的确切原因，但似乎已经解决。

Forms Auth cookie 本身就变得非常大（由于加密/验证开销），因此只需要几个属性就可以超过 1kb。

# c++ - || vs 或关键字

> ID：11874851
> 
> 赞同：1
> 
> 时间：2012-08-08T23:45:48.293
> 
> 标签：c++

简单，可能很容易回答问题。|| 和 || 有什么区别？和或类似 if 语句的东西。

简单的例子：

```
#include <iostream>

int main(){
    int x = 8;

    if(x == 8 or 17){
        std::cout << "Hello World!\n";
    }
} 
```

和

```
#include <iostream>

int main(){
    int x = 8;

    if(x == 8 || 17){
        std::cout << "Hello World!\n";
    }
} 
```

这些对我来说似乎同样有效。他们都编译并且他们都显示“Hello World！” 我一直用|| 甚至不知道或。他们做同样的事情吗？或者是否存在细微差别，例如使用 \n 或 endl ，其中一个行为略有不同。对不起，如果这是一个非常简单的问题。谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T00:07:31.300

正如 Luchian 所说，没有语义差异。最新的[C++ 标准草案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf)在“关键字”部分中说：

> 此外，表 5 中显示的某些运算符和标点符号 (2.6) 的替代表示是保留的，不得以其他方式使用：

```
and     and_eq  bitand  bitor  compl   not
not_eq  or      or_eq   xor    xor_eq 
```

但是对于阅读您的代码的任何人来说，可能会有所不同。“逻辑或”的`||`运算符可以追溯到几十年前。替代表示较新。

它们至少早在 1998 年的 C++ 标准中就被引入了（我不知道 pre-ISO C++ 是否有它们）。至少可以想象，您可能会遇到无法识别它们的 C++ 编译器，但如果是这样，它将是一个足够老的编译器，您将遇到其他问题。C 在其 1995 年的修正案中引入了类似的标识符（但仅限于`#include iso646.h>`）。

至少在 C 中，可能在 C++ 中，引入了这些替代表示，以及二合字母和三合字母，以迎合具有不包含 C 和 C++ 所需的所有字符的字符集的系统：

```
{ } [ ] # & | ^ ~ ! 
```

随着更现代的字符集（尤其是 Unicode）的引入，这样的系统越来越少见。

但据我所知，它们很少在代码中使用（我认为我从未见过任何使用它们的代码），而且一些 C++ 程序员可能不知道它们。我相信如果您使用`||`而不是`or`.

正如 Luchian 所说，`(x == 8 || 17)`这并不意味着你可能期望从英语语法中得到什么。这并不意味着“x 等于 8 或 17”；这意味着`((x == 8) || 17)`；`17`本身被视为一个条件，而不是与 比较`x`。可能你想写`(x == 8 || x == 17)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-08T23:47:11.553

完全一样，它是一个替代运算符。[您可以在此处](http://en.cppreference.com/w/cpp/language/operator_alternative)找到完整列表。

另外，请注意`x == 8 or 17`始终返回 true。它不检查`x`是不是`8`或`17`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-28T15:40:33.557

他们之间没有区别，他们都做同样的事情

# kml - 在 kml 文件中为单轨着色

> ID：11874858
> 
> 赞同：6
> 
> 时间：2012-08-08T23:46:37.997
> 
> 标签：kml

我试图让 gx:track 的线根据某些条件在轨道的不同部分具有不同的颜色，但我无法找到为轨道的一部分着色的方法。我正在使用 C# 生成 kml 文件。顺便说一句，我的 gx:track 有扩展数据。

我知道我可以将 lineStyle 应用于 gx:track 但这只会应用于整个轨道，但我希望沿着轨道的线有不同的颜色。

提前致谢。

特里

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-11T20:14:24.490

正如前面的答案所说，您必须将曲目分成多个片段并单独为每个片段着色。使用 KML 没有其他方法可以做到这一点。但请记住，这会为长音轨创建非常大的 KML 文件！所以尝试通过使用共享样式来节省一些空间。

我建议为整个轨道创建一个具有低“draworder”的“gx：track”，并为每个小段轨道创建具有不同颜色和高“draworder”的地标集合。

您可以在此处检查此方法的结果： [http](http://www.zonefivesoftware.com/sporttracks/plugins/?p=dobrou-extensions) ://www.zonefivesoftware.com/sporttracks/plugins/?p= dobrou-extensions（它是应用程序 SportTracks 的插件）。

这是我的 GPS 轨迹可视化工具。它通过为每个轨道段创建具有自己颜色样式的地标来跟踪着色。

在这里，您可以看到以 KML 着色的示例曲目：

[以速度#1 KMZ 着色的轨道](https://dl.dropbox.com/u/341905/_web/_kml/examples/ski.kmz)

[以速度#2 KMZ 着色的轨道](https://dl.dropbox.com/u/341905/_web/_kml/examples/3dwall.kmz)

[按海拔 KMZ 着色的轨道](https://dl.dropbox.com/u/341905/_web/_kml/examples/mountains.kmz)

![以速度#1着色的轨道](../Images/72dedbbdf1855d923fb44a08fc983c99.png) ![以速度#2着色的轨道](../Images/f879f7770928d2b900458f60f9f9f0fc.png) ![按海拔着色的轨道](../Images/9f4d07a2d9db8ff4ec812841d748f0a3.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-09T12:08:31.413

正如您所发现的，您只能设置完整曲目的样式。如果您希望不同的段具有不同的颜色，则需要拆分轨道，然后设置每个段的样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-05T08:08:33.293

我使用了 simplekml，它使用 Python 生成 KML 代码。正如其他答案指出的那样，您必须将线分成多个线串，每个线串都有不同的样式。不过，您可以使用一组通用样式来缩小 kml 的大小。

一行的结束坐标是下一行的开始坐标。

# excel - 将 CSV 导入 Excel

> ID：11874865
> 
> 赞同：2
> 
> 时间：2012-08-08T23:47:24.060
> 
> 标签：vba, excel, vba, csv, data-import

我需要将一些 CSV 导入 Excel 电子表格，每个 CSV 的行/列号都不同。问题是某些值是长数字字符串
`341235387313289173719237217391`， 例如

Excel 会将这些值视为（双）数字，然后导致数据丢失。

我解决它的方法是使用以下[vba](/questions/tagged/vba "显示标记为“vba”的问题")函数来完成这项工作：

```
Sub readCSV(f As TextStream, sh As Worksheet)
    i = 1
    Do
        l = Trim(f.ReadLine)
        If l = "" Then Exit Sub 'skip the last empty line(s)
        l = Mid(l, 2, Len(l) - 1)
        ss = Split(l, """,""")
        For j = LBound(ss) To UBound(ss) 'j starts from 0
            Dim a As Range
            With sh.Cells(i, j + 1)
                .NumberFormat = "@" 'Force to text format
                .Value = ss(j)
            End With
            DoEvents 'Avoid blocking the GUI
        Next j
        i = i + 1
    Loop Until f.AtEndOfStream
End Sub 
```

问题是性能。它比通过 Data->From Text 导入数据或直接打开 CSV 慢得多。

有什么方法可以更有效地做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:22:41.210

您可以一次格式化/写入每一行：

```
Sub readCSV(f As TextStream, sh As Worksheet)

     Dim i As Long
     Dim ss, l
     i = 1

    With Application
        .ScreenUpdating = False
        .Calculation = xlCalculationManual
    End With

    Do
        l = Trim(f.ReadLine)
        If l = "" Then Exit Sub 'skip the last empty line(s)
        l = Mid(l, 2, Len(l) - 1)
        ss = Split(l, """,""")

        With sh.Cells(i, 1).Resize(1, (UBound(ss) - LBound(ss)) + 1)
            If (i-1) Mod 100 = 0 Then .Resize(100).NumberFormat = "@"
            .Value = ss
        End With

        i = i + 1
    Loop Until f.AtEndOfStream

    With Application
        .ScreenUpdating = True
        .Calculation = xlCalculationAutomatic
    End With

End Sub 
```

**编辑**：经过测试，真正的性能杀手是将单元格格式设置为文本修改代码，以 100 行而不是每行的块进行设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T01:01:09.473

除了在 Excel 中工作（按单元格或按行），您可以使用 a`Regexp`快速创建 CSV 文件的第二个版本，其中每个长度超过 16 个字符的字母数字字符串都使用前面的更新`'`

然后只需在 Excel 中导入或打开整个新的 csv

`StrIn`在具有此路径的 CSV 文件上运行的示例代码示例，`"c:\Temp\test.csv"`

```
Sub Main()
Dim objFSO As Object
Dim objRegex As Object
Dim objTF As Object
Dim objTF2 As Object
Dim tf As Object
Dim strIn As String
Dim strOut As String
Dim strFile As String

strIn = "c:\Temp\test.csv"
strOut = "c:\Temp\test2.csv"

Set objFSO = CreateObject("scripting.filesystemobject")
Set objTF = objFSO.getfile(strIn)
Set objRegex = CreateObject("vbscript.regexp")
Set tf = objTF.OpenAsTextStream(ForReading)
strFile = tf.ReadAll

With objRegex
.Pattern = "(\w{16,})"
.Global = True
strFile = .Replace(strFile, "'" & "$1")
End With

Set objTF2 = objFSO.OpenTextFile(strOut, ForWriting, True)
objTF2.Write strFile
objTF2.Close
tf.Close
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T00:11:19.340

尝试`.Value = "'" & ss(j)`

强制值在`'`Excel 中显示为文本字符串。

另外，尝试在字符串中声明您的 ss 数组，这样它就不会在拆分后将数字存储为 long 。就像是：

```
Dim ss() as String = Split(l, """,""") 
```

# c - C中的正则表达式不起作用（我找不到原因）

> ID：11874866
> 
> 赞同：1
> 
> 时间：2012-08-08T23:47:24.970
> 
> 标签：c, regex

在 regexpal.com 上测试过这个正则表达式工作正常，但是在我的程序中运行时它根本不起作用。目标是从 url 中提取视频 ID（如果它不是有效的 url，则抛出错误）

```
#include <regex.h>
#include <stdio.h>
#include <stdlib.h>

int main(){
    regex_t expression;

    char * regexpression = "^(https?://)?(www\\.)?youtube\\.com/watch\\?(.*&)?v=(.*?)(&.*)?$";

    regcomp(&expression,regexpression,0);

    char * url = "http://www.youtube.com/watch?v=HereBeVideoId";    

    if(regexec(&expression, url, 0, NULL, 0)){
        printf("Url %s not a valid video.\n",url);
        return;
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:22:10.097

向函数添加`REG_EXTENDED`标志：`regcomp()`

```
regcomp(&expression,regexpression,REG_EXTENDED); 
```

# ruby-on-rails-3 - Rails 3：Devise Gem + 错误：唯一性验证

> ID：11874868
> 
> 赞同：1
> 
> 时间：2012-08-08T23:47:56.797
> 
> 标签：ruby-on-rails-3, validation, devise, ruby-on-rails-3.2

我正在使用最新的 Devise gem 运行 rails 3.2.5。我有一个与 Actor 类相关的用户类。如果我使用以下语法，则有一个名为 slug 的字段可以很好地验证...

```
validates :slug, :presence => true, :length => { :maximum => 50 } 
```

但是如果我放置额外的唯一性参数

```
validates :slug, :presence => true, :length => { :maximum => 50 }, :uniqueness => true 
```

它抛出一个错误......

```
NoMethodError in Devise::RegistrationsController#update

undefined method `text?' for nil:NilClass 
```

**我不确定是什么原因造成的。**

我还应该提到，在我的用户模型类中，我有以下内容......

```
attr_accessible :name, :email, :password, :password_confirmation, :language, :remember_me, :profile_attributes, :admin, :slug 
```

在我的配置文件中，我有

```
config.active_record.whitelist_attributes = false #not standard nor recommended I know 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-30T23:10:06.957

我遇到了同样的问题，并且能够通过自己分离出 validates_uniqueness_of 来解决它。所以对我来说

```
validates :username, :presence, uniqueness: { case_sensitive: false } 
```

抛出相同的错误（未定义的方法“文本？”）。同时更改为

```
validates_presence_of :username
validates_uniqueness_of :username, { case_sensitive: false } 
```

工作得很好。

# c++ - 找到最昂贵的方法并评估/分析它们

> ID：11874869
> 
> 赞同：2
> 
> 时间：2012-08-08T23:48:04.233
> 
> 标签：c++, methods, big-o, execution

我想知道是否有可用的技术或工具可以告诉您执行特定方法需要多少时间。

类似于数学/计算机科学中的大 O 符号可以让您了解算法的复杂性，我想知道代码分析是否有类似的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T01:20:24.167

[分析](http://en.wikipedia.org/wiki/Profiling_%28computer_programming%29)是一种分析程序以确定在特定功能或方法中花费的相对时间量的方法。它对于凭经验发现程序中的性能问题很有用。例如，使用 GCC，您可以：

*   `-pg`使用启用分析的选项编译程序。

*   运行可执行文件以生成一个名为 的文件`gmon.out`，其中包含有关程序实际运行时的运行时特性的信息。

*   运行`gprof`以显示由检测的可执行文件生成的信息。

一般来说，人类分析是发现特定算法的渐近（即大O）复杂性的唯一方法——据我所知，没有机械的方法可以做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-09T00:04:18.307

如果您想知道一个函数花费了多少时间，请使用所谓的“分析器”。

但是，复杂性分析超出了分析器的范围，因为分析器会告诉您运行一次程序时会发生什么，而复杂性会告诉您在运行具有越来越大的输入的无限程序序列时会发生什么的极限行为。

所以：你想知道你的程序中哪些函数是最昂贵的（在这种情况下为你的 C++ 实现找到一个分析器并遵循它的文档），或者你想知道时间复杂度（在这种情况下你几乎需要一个人工分析您的代码）？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T07:44:57.333

您应该尝试在 callgrind 启动的情况下运行您的代码，它会记录调用了哪些函数、调用了多少次，但代码运行速度会慢 20 倍左右。获得 callgrind 输出后，您应该使用 kcachegrind 打开它以查看调用的树结构。在那里你可以四处浏览，看看你在哪里有瓶颈

有用的链接：
kcachegrind [http://kcachegrind.sourceforge.net/html/Home.html](http://kcachegrind.sourceforge.net/html/Home.html)
callgrind 文档[http://valgrind.org/docs/manual/cl-manual.html](http://valgrind.org/docs/manual/cl-manual.html)
（valgrind 是框架，callgrind 是组件）
如何如果程序产生进程并且您也想分析这些进程，则启动 callgrind（用您的程序替换 sage bench.py​​）[https://github.com/titusnicolae/pynac-callgrind/blob/master/run.sh](https://github.com/titusnicolae/pynac-callgrind/blob/master/run.sh)
**编辑：** “- -instr-atstart=no" 如果您不打算稍后启用检测，则应从参数列表中删除

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-09T01:05:22.393

这与停机问题有何不同？

请注意，我可以使用您的自动复杂性分析器轻松解决停机问题——您的问题更难。停机问题已经无法确定。

# javascript - 将未定义的变量传递给函数时出错？

> ID：11874871
> 
> 赞同：10
> 
> 时间：2012-08-08T23:48:12.053
> 
> 标签：javascript

我正在尝试创建一个可重用的函数来检查变量是否未定义。奇怪的是，当我将变量传递给函数以执行代码时，它不起作用，但如果我在函数外部使用相同的逻辑，它就起作用了。有没有办法让这个函数 isDefined 工作？

```
//THIS WORKS AND RETURN FALSE
alert(typeof sdfsdfsdfsdf !== 'undefined');

//THIS GIVES AN ERROR, WHY?
//Uncaught ReferenceError: sdfsd is not defined 
function isDefined(value) {
        alert(typeof value !== 'undefined' && value !== null)
}

isDefined(sdfsd); 
```

​现场示例（检查控制台是否有错误）：http: [//jsfiddle.net/JzJHc/](http://jsfiddle.net/JzJHc/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-09T00:04:33.883

`typeof`除非在测试中，否则您不能使用尚未声明的变量

当您尝试将尚未声明的变量传递给函数时，会考虑使用该未声明的变量。您会注意到错误在调用者中，而不是在调用者内部`isDefined`

您需要运行检查

```
if (typeof sdsdsd !== 'undefined') 
```

在将其传递给函数之前。基本上这意味着你**不能**编写一个`isDefined`接受未声明变量的函数。您的函数只能用于未定义的属性（可以传递）

但是，我很好奇，您传递一个不存在的变量的真实情况是什么？您应该声明所有变量，并且它们应该已经存在。如果您声明`var sdsdsds`它会以 的值存在，`undefined`并且您的`isDefined`函数可以正常工作。

# c# - 大型无向图的高效存储、查找和操作

> ID：11874875
> 
> 赞同：3
> 
> 时间：2012-08-08T23:48:26.000
> 
> 标签：c#, performance, data-structures, graph, hashset

我有一个大约 5000 个节点的无向​​图 G。任何一对节点都可以通过一条边连接。边的长度、方向或其他特征无关紧要，两点之间最多只能有一条边，因此节点之间的关系是二元的。因此，总共有 12497500 个潜在边。

每个节点由字符串名称而不是数字标识。

我想存储这样的图表（作为输入数据加载到我的程序中），但我不确定哪种数据结构最好。

*   我需要多次查找给定的一对节点是否已连接，因此查找性能可能是主要关注点。
*   添加和删​​除元素的性能成本不是问题。
*   如果可能的话，我还想保持语法简单和优雅，以减少引入错误的可能性并使调试更容易。

两种可能：

*   `bool[numNodes, numNodes]`和 a`Dictionary<string, int>`将每个节点名称与索引匹配。优点：简单、快速的查找。缺点：不能轻易删除或添加节点（必须添加/删除行/列）、冗余（必须小心`g[n1, n2]`vs `g[n2, n1]`）、笨拙的语法，因为我每次都必须通过 HashMap。

*   `HashSet<HashSet<string>>`. 优点：直观，节点直接由字符串标识，易于“添加/删除节点”，因为只存储边并且节点本身是隐式的。缺点：可能输入垃圾输入（边“连接”三个节点，因为该集合有三个成员）。

关于第二个选项，我也不清楚一些事情：

1.  它会比数组占用更多的内存`bool`吗？
2.  两个 .NET 集是否等同于数学集，当且仅当它们具有完全相同的成员（而不是按元素的容量或顺序等区分）时它们才相等`HashSet`？（即查询是否`outerSets.Contains(new HashSet<string>{"node1", "node2"})`真的有效？）
3.  查找会比数组花费更长的时间`bool`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T01:13:02.847

C5 Collections Library 有一些关于图表的有用的东西

[http://www.itu.dk/research/c5/](http://www.itu.dk/research/c5/)

这个问题，[完整无向图的最有效实现](https://stackoverflow.com/questions/10951564/most-efficient-implementation-for-a-complete-undirected-graph)，看起来也很有用。

SortedDictionary 在引擎盖下，是一个高度平衡的红黑树，所以查找是 O(log n)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T01:45:10.640

我很好奇在生成表示哈希表中边缘的键以接近 O(1) 查找性能时使用字符串连接与元组。这里有两种处理无向边要求的可能性：

1.  规范化密钥，使其无论在边的描述中首先指定哪个节点都相同。在我的测试中，我只是选择将具有最低序数比较值的节点作为键中的第一个组件。

2.  在哈希表中创建两个条目，一个用于边缘的每个方向。

这里的一个关键假设是字符串节点标识符不是很长，因此密钥规范化相对于查找来说是便宜的。

带有键规范化的字符串连接和元组版本似乎工作大致相同：在发布模式下的 VirtualBox VM 中，大约 3 秒内完成了大约 200 万次随机查找。

为了查看密钥归一化是否淹没了查找操作的影响，第三种实现不进行密钥归一化，但保持关于边的两个可能方向的对称条目。这似乎在查找时慢了大约 30-40%，这有点出乎我的意料（对我来说）。也许底层哈希表存储桶具有更高的平均占用率，因为元素数量是两倍，需要在每个哈希存储桶内进行更长的线性搜索（平均而言）？

```
interface IEdgeCollection
{
    bool AddEdge(string node1, string node2);
    bool ContainsEdge(string node1, string node2);
    bool RemoveEdge(string node1, string node2);
}

class EdgeSet1 : IEdgeCollection
{
    private HashSet<string> _edges = new HashSet<string>();

    private static string MakeEdgeKey(string node1, string node2)
    {
        return StringComparer.Ordinal.Compare(node1, node2) < 0 ? node1 + node2 : node2 + node1;
    }

    public bool AddEdge(string node1, string node2)
    {
        var key = MakeEdgeKey(node1, node2);
        return _edges.Add(key);
    }

    public bool ContainsEdge(string node1, string node2)
    {
        var key = MakeEdgeKey(node1, node2);
        return _edges.Contains(key);
    }

    public bool RemoveEdge(string node1, string node2)
    {
        var key = MakeEdgeKey(node1, node2);
        return _edges.Remove(key);
    }
}

class EdgeSet2 : IEdgeCollection
{
    private HashSet<Tuple<string, string>> _edges = new HashSet<Tuple<string, string>>();

    private static Tuple<string, string> MakeEdgeKey(string node1, string node2)
    {
        return StringComparer.Ordinal.Compare(node1, node2) < 0 
            ? new Tuple<string, string>(node1, node2) 
            : new Tuple<string, string>(node2, node1);
    }

    public bool AddEdge(string node1, string node2)
    {
        var key = MakeEdgeKey(node1, node2);
        return _edges.Add(key);
    }

    public bool ContainsEdge(string node1, string node2)
    {
        var key = MakeEdgeKey(node1, node2);
        return _edges.Contains(key);
    }

    public bool RemoveEdge(string node1, string node2)
    {
        var key = MakeEdgeKey(node1, node2);
        return _edges.Remove(key);
    }
}

class EdgeSet3 : IEdgeCollection
{
    private HashSet<Tuple<string, string>> _edges = new HashSet<Tuple<string, string>>();

    private static Tuple<string, string> MakeEdgeKey(string node1, string node2)
    {
        return new Tuple<string, string>(node1, node2);
    }

    public bool AddEdge(string node1, string node2)
    {
        var key1 = MakeEdgeKey(node1, node2);
        var key2 = MakeEdgeKey(node2, node1);
        return _edges.Add(key1) && _edges.Add(key2);
    }

    public bool ContainsEdge(string node1, string node2)
    {
        var key = MakeEdgeKey(node1, node2);
        return _edges.Contains(key);
    }

    public bool RemoveEdge(string node1, string node2)
    {
        var key1 = MakeEdgeKey(node1, node2);
        var key2 = MakeEdgeKey(node2, node1);
        return _edges.Remove(key1) && _edges.Remove(key2);
    }
}

class Program
{
    static void Test(string[] nodes, IEdgeCollection edges, int edgeCount)
    {
        // use edgeCount as seed to rng to ensure test reproducibility
        var rng = new Random(edgeCount);

        // store known edges in a separate data structure for validation
        var edgeList = new List<Tuple<string, string>>();

        Stopwatch stopwatch = new Stopwatch();

        // randomly generated edges
        stopwatch.Start();
        for (int i = 0; i < edgeCount; i++)
        {
            string node1 = nodes[rng.Next(nodes.Length)];
            string node2 = nodes[rng.Next(nodes.Length)];
            edges.AddEdge(node1, node2);
            edgeList.Add(new Tuple<string, string>(node1, node2));
        }
        var addElapsed = stopwatch.Elapsed;

        // non random lookups
        int nonRandomFound = 0;
        stopwatch.Start();
        foreach (var edge in edgeList)
        {
            if (edges.ContainsEdge(edge.Item1, edge.Item2))
                nonRandomFound++;
        }
        var nonRandomLookupElapsed = stopwatch.Elapsed;
        if (nonRandomFound != edgeList.Count)
        {
            Console.WriteLine("The edge collection {0} is not working right!", edges.GetType().FullName);
            return;
        }

        // random lookups
        int randomFound = 0;
        stopwatch.Start();
        for (int i = 0; i < edgeCount; i++)
        {
            string node1 = nodes[rng.Next(nodes.Length)];
            string node2 = nodes[rng.Next(nodes.Length)];
            if (edges.ContainsEdge(node1, node2))
                randomFound++;
        }
        var randomLookupElapsed = stopwatch.Elapsed;

        // remove all
        stopwatch.Start();
        foreach (var edge in edgeList)
        {
            edges.RemoveEdge(edge.Item1, edge.Item2);
        }
        var removeElapsed = stopwatch.Elapsed;

        Console.WriteLine("Test: {0} with {1} edges: {2}s addition, {3}s non-random lookup, {4}s random lookup, {5}s removal",
            edges.GetType().FullName,
            edgeCount,
            addElapsed.TotalSeconds,
            nonRandomLookupElapsed.TotalSeconds,
            randomLookupElapsed.TotalSeconds,
            removeElapsed.TotalSeconds);
    }

    static void Main(string[] args)
    {
        var rng = new Random();

        var nodes = new string[5000];
        for (int i = 0; i < nodes.Length; i++)
        {
            StringBuilder name = new StringBuilder();
            int length = rng.Next(7, 15);
            for (int j = 0; j < length; j++)
            {
                name.Append((char) rng.Next(32, 127));
            }
            nodes[i] = name.ToString();
        }

        IEdgeCollection edges1 = new EdgeSet1();
        IEdgeCollection edges2 = new EdgeSet2();
        IEdgeCollection edges3 = new EdgeSet3();

        Test(nodes, edges1, 2000000);
        Test(nodes, edges2, 2000000);
        Test(nodes, edges3, 2000000);

        Console.ReadLine();
    }
} 
```

# jquery - 在 Fancybox iFrame 中使用 JQZoom 而不加载 jquery

> ID：11874877
> 
> 赞同：1
> 
> 时间：2012-08-08T23:48:44.417
> 
> 标签：jquery, fancybox, parent-child, javascript, jqzoom

我在页面中使用 Fancybox（称为 parent.html）来加载 iframe（称为 child.html）。在 child.html 页面中，我使用的是 JQzoom。我已经设置好了一切，一切顺利，但我想知道是否有办法减少加载时间（或者加载时间会最短吗？）。现在我在父页面和子页面中加载 JQuery 库，然后在子页面中加载 JQZoom 库。

我将有几个子页面，但只有一个父页面使用 Fancybox 加载子页面。有没有办法在不加载 JQuery 库的情况下在子窗口中使用 JQzoom？更好的做法是将所有内容（包括所有函数和 JQzoom 库）加载到父页面中，然后从子页面访问这些函数/库文件。

现在子页面有以下代码和脚本来触发 JQzoom：

```
...
<head>
...
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type='text/javascript' src='jqzoom/js/jquery.jqzoom-core.js'></script>  
</head>
<body>
<a href="large.jpg" class="myID"><img src="small.jpg"></a>
...
<script>
  $(document).ready(function(){  
    $('.myID').jqzoom({
      //... zqzoom OPTIONS  
    });  
  });
</script> 
... 
```

我是一名设计师，所以如果你有任何建议，请把我当作紧身连衣裤编码员一样对待：)

谢谢！

# sql - .bak 文件是否太大？

> ID：11874883
> 
> 赞同：1
> 
> 时间：2012-08-08T23:48:58.553
> 
> 标签：sql, sql-server-2008, sql-server-express

我正在尝试将 12g 的 .bak 文件恢复到本地位置，并收到一条错误消息，提示我无法在 4g 左右执行任何操作。反正有没有增加位置的大小？

我做了一些阅读，从我所看到的你不能增加位置的大小，只有 .bak 文件的大小。这种情况不是我可以更改 .bak 文件大小的情况。

感谢您的浏览，非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T21:09:01.673

看起来您正在使用 SQL Server Express，它的数据库文件大小限制为 10GB（SQL Server 2008 Express 或更早版本为 4GB）。有关详尽的讨论和指示，请参阅[此问题](https://stackoverflow.com/questions/1169634/limitations-of-sql-server-express)。

# php - 通过 jquery ajax 发送表单字段时出错

> ID：11874902
> 
> 赞同：1
> 
> 时间：2012-08-08T23:50:58.913
> 
> 标签：php, jquery, codeigniter

我在将 dataString 发送到服务器时遇到问题。显然，它没有从表单中正确提取值。下面是我的 jquery 和我的 php。

```
$(document).ready(function() {  
    $("#submitForm").live('click', function() {
        updateUserInfo();
    });

var birthdate = $("#birthdate");
var sex = $("#sex");
var interestedIn = $("#interestedIn");
var relationshipStatus = $("#relationshipStatus");
var knownLanguages = $("#knownLanguages");
var religiousViews = $("#religiousViews");
var politicalViews = $("#politicalViews");
var aboutMe = $("#aboutMe");
var mobilePhone = $("#mobilePhone");
var neighborhood = $("#neighborhood");
var website = $("#website");
var email = $("#email");

var dataString = birthdate + sex + interestedIn + relationshipStatus + knownLanguages + politicalViews + aboutMe + mobilePhone + neighborhood + website + email;

function updateUserInfo() {
    jQuery.ajax({
        type: "POST",
        dataType: "JSON",
        url: "<?=base_url()?>index.php/regUserDash/updateUserInfo",
        data: dataString,
        json: {userInfoUpdated: true},
        success: function(data) {
        if(data.userInfoUpdated == true) {
            alert("hello");
        }
      }
   });
}
}); 
```

我的PHP：

```
 public function updateUserInfo() {
        $userid = $this->session->userdata('userid');
        $birthdate = $this->input->post("birthdate");
        $sex = $this->input->post("sex");
        $interestedIn = $this->input->post("interestedIn");
        $relationshipStatus = $this->input->post("relationshipStatus");
        $languages = $this->input->post("languages");
        $religiousViews = $this->input->post("religiousViews");
        $politicalViews = $this->input->post("politicalViews");
        $aboutMe = $this->input->post("aboutMe");
        $mobilePhone = $this->input->post("mobilePhone");
        $neighborhood = $this->input->post("neighborhood");
        $websites = $this->input->post("websites");
        $email = $this->input->post("email");

        $this->db->query("INSERT IGNORE INTO user_info (birthdate, sex, interestedIn, relationshipStatus, Languages, religiousViews, politicalViews, aboutMe, mobilePhone, neighborhood, websites, email, userid)
                          VALUES('{$birthdate}', '{$sex}', {$relationshipStatus}', '{$languages}, {$religiousViews}', '{$politicalViews}', {$aboutMe}', '{$mobilePhone}' {$neighborhood}', '{$websites}', {$email}', '{$userid}')");

        echo json_encode(array('userInfoUpdated' => true));
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:20:52.487

用于[`.val()`](http://api.jquery.com/val/)获取元素的值。并将您的更改`dataString`为：

```
var dataString = {'birthdate' : birthdate, 'sex' : sex, 'interestedIn' : interestedIn, 'relationshipStatus' : relationshipStatus, 'knownLanguages' : knownLanguages, 'politicalViews' : politicalViews, 'aboutMe' : aboutMe, 'mobilePhone' : mobilePhone, 'neighborhood' : neighborhood, 'website' : website, 'email' : email}; 
```

从[api.jquery.com](http://api.jquery.com/jQuery.ajax/)： ![jQuery.ajax 数据](../Images/6d6cd4dcb897aab29ab49936636f086d.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-08T23:55:45.290

该代码`$("#birthdate");`将返回一个 id 为 #birthdate 但不是其值的元素。使用 val 函数获取其中的值。像`var birthdate = $("#birthdate").val();`

# android - 立方体上的Android OpenGL触摸方向

> ID：11874904
> 
> 赞同：1
> 
> 时间：2012-08-08T23:51:16.530
> 
> 标签：android, opengl-es, touch

我的 OpenGL 视图中有一个立方体，当我触摸立方体外部时可以旋转它。现在我可以检测到我触摸了立方体的哪一侧，现在我正试图找出触摸运动的哪一侧。因此，如果我触摸顶部，运动可以向立方体的左侧、右侧、正面或背面移动。执行此操作时，立方体的方向可以是任何东西。

所以在弄清楚这一点后，我会让它围绕正确的轴旋转。

我只需要知道如何实现这一点。

编辑：这是我正在尝试做的一个粗略的例子。对不起，我不善于解释。

绿色的东西是手指触摸红色的一面。箭头表示手指移动的方向。由于它向蓝色侧 (2) 移动，它应该返回 2。如果它向绿色侧 (1) 移动，它将返回 1，依此类推。

![](../Images/0cc63501fa0eb1371e1ab9bd28ba1892.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T02:02:41.800

这是一种方法：

当您向上滑动并抬起手指时，您会在屏幕空间中获得两个 2D 点：ptBegin 和 ptEnd。将这些转换为 3D（您需要执行 gluUnproject 的等效操作才能获得 3D 坐标），您将获得立方体坐标系中的 3D 坐标 ptBegin3D 和 ptEnd3D。

计算向量 D = ptEnd3D - ptBegin3D。

现在，如果您使用立方体面法线 (0, 0, 1)、(1, 0, 0) 等进行上述的点积，您将从值中知道您正朝着哪个立方体面移动。

# javascript - 如何避免重复代码（页面加载时切换）？

> ID：11874907
> 
> 赞同：1
> 
> 时间：2012-08-08T23:51:34.117
> 
> 标签：javascript, jquery

请参阅下面的代码，如果您单击副标题行，它将隐藏带有它的行。它运作良好。

在第二个副标题行 ( `<tr class="sub-title default-hide">`) - 我希望在页面加载时默认切换/隐藏。如何在不编写如下重复代码的情况下执行此操作？

```
 $(".sub-title").on("click",function() {
        tr = $(this).find('span').hasClass("arrow2");
        trSpan = $(this).find('span');
        $(this).nextUntil(".sub-title").each(function() {
            if (!$(this).hasClass('head-order')) {
                $(this).toggle();
                if (tr) {
                    trSpan.removeClass('arrow2').addClass('arrow1');
                } else {
                    trSpan.removeClass('arrow1').addClass('arrow2');
                }
            }
        });
    }); 
```

HTML

```
<table border="1">
 <tbody>
  <tr class="head">
   <td> title </td>
  </tr>
  <tr class="sub-title">
     <td>Sub Title 1 <span class="arrow2"> </span></td>
  </tr>
   <tr> <td>Item 1</td> </tr>
   <tr> <td>Item 2</td> </tr>
   <tr> <td>Item 3</td> </tr>
   <tr class="sub-title default-hide">
     <td>Sub Title 2 <span class="arrow2"></span></td>
   </tr>
   <tr> <td>Item 4</td> </tr>
   <tr> <td>Item 5</td> </tr>
   <tr> <td>Item 6</td> </tr>
  </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:18:42.613

我使用您提供的信息创建了一个[jsFiddle 示例。](http://jsfiddle.net/tADRt/1/)

我对代码进行了一些编辑，使用默认的`arrow`-class 并将类添加`close`到其中，以定义新样式，这应该会使代码更短一些。

```
$(".sub-title").on("click",function() {
    var trSpan = $(this).find('span');

    trSpan.toggleClass('closed');

    $(this).nextUntil(".sub-title").each(function() {
        if (!$(this).hasClass('head-order')) {
            $(this).toggle();
        }
    });
}); 
```

为了使“默认隐藏”元素在页面加载时关闭，我所做的就是在绑定点击处理程序*后触发点击事件。*

```
$('.default-hide').trigger('click'); 
```

请参阅小提琴以获取工作示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T00:20:51.300

创建一个命名函数并调用它几次：

```
var toggleArrow = function(el) {
    tr = $(el).find('span').hasClass("arrow2");
    trSpan = $(el).find('span');
    $(el).nextUntil(".sub-title").each(function() {
        if (!$(el).hasClass('head-order')) {
            $(el).toggle();
            if (tr) {
                trSpan.removeClass('arrow2').addClass('arrow1');
            } else {
                trSpan.removeClass('arrow1').addClass('arrow2');
            }
        }
    });
};

$(".sub-title").on("click", function(){ toggleArrow(this); });
$(".default-hide").each(function(i, el){ toggleArrow(this); }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-09T00:19:18.277

您可以手动触发`default-hide`行的单击事件。

[像这样](http://jsfiddle.net/KtL9Q/)

```
$('.default-hide').trigger('click'); 
```

# actionscript-3 - 如何使用 Flex、AS3 和 Flash Builder 从客户端 swf 向服务器端 (main.asc) 发送变量

> ID：11874908
> 
> 赞同：0
> 
> 时间：2012-08-08T23:51:36.800
> 
> 标签：actionscript-3, flash, apache-flex, flash-builder, flash-media-server

我搜索了 Google、FMS Guru 和大量 Adob​​e 开发人员教程。我有点困惑如何从客户端将变量作为参数发送到共享对象或客户端对象中，以便我可以从 main.asc 文件中获取和处理服务器端的变量。

例如，如何使用创建的 SWF 中的 AS3 将用户名、用户 ID、性别、用户类型和生日变量发送到 main.asc 文件？

来自chat.mxml

```
private var xmlstring:String = "http://www.blah.com/xml.xml";

            private var userType:String;
            private var userCountText:String;

            protected function getXML():void {
                XML.ignoreWhitespace = true;
                var myLoader:URLLoader=new URLLoader();
                myLoader.load(new URLRequest(ownerstring));
                myLoader.addEventListener(Event.COMPLETE, processXML);
            }

            protected function processXML(e:Event):void {
                var myXML:XML = XML(e.target.data)
                for (var i:int = 0; i<myXML.*.length(); i++){
                    xinstance = myXML.owner[0];
                    xuserid = myXML.owner[1];
                    xusername = myXML.owner[2];
                    xphoto = myXML.owner[3];
                    xroomowner = myXML.owner[4];
                }
                //xinstance = myXML.broadcastowner.owner.(@title == "instance");
                //xuserid = myXML.broadcastowner.owner.(@title == "userid");
                //xusername = myXML.broadcastowner.owner.(@title == "username");
                //xphoto = myXML.broadcastowner.owner.(@title == "photo");
                //xroomowner = myXML.broadcastowner.owner.(@title == "roomowner");

                go();
            }

            private function initConnection(event:FlexEvent):void{
                getXML();
            }

            private function go():void {
                var fmsstring:String = "rtmp://blah.com/appname/" + xinstance;

                nc = new NetConnection();
                nc.addEventListener(NetStatusEvent.NET_STATUS, onNetStatus);
                nc.connect(fmsstring);
                nc.client = this;
            }           

            protected function onNetStatus(event:NetStatusEvent):void{
                trace(event.info.code);

                switch(event.info.code){

                    case "NetConnection.Connect.Success":
                        publishCamera(); 
                        displayPublishingVideo();
                        chat_broadcastLive();

                        so = SharedObject.getRemote("message", nc.uri, false);

                        so.username = xusername;
                        so.userid = xuserid;
                        so.userType = xroomowner;

                        so.addEventListener(SyncEvent.SYNC, soOnSync);
                        so.client = this;
                        so.connect(nc);

                        //so.setProperty("userinfo",{username:xusername, userid:xuserid, userType:xroomowner});

                        sendBtn.addEventListener(MouseEvent.CLICK, onClickSendBtn);
                        break;

                    case "NetConnection.Connect.Closed" :
                        nc.call("chat.sendMessage", myResponder, xusername + " left the room");
                        break;

                }
            } 
```

主目录

```
application.onAppstart = function(){
this.totalUserCount = 0; 
}

application.onConnect = function(client, username, userid, gender, userType, birthday )
{

//userType = so.data.userinfo["userType"];

client.username = username;
client.userid = userid;
client.gender = gender;
client.userType = userType;
client.birthdaye = birthday;

if(userType="viewer"){
this.totalUserCount++;
}

client.chat = chat;

application.acceptConnection(client);

}

application.onDisconnect = function(client){
if(userType="viewer"){
this.totalUserCount--;
}
}

trace("usercount is:" + this.totalUserCount); 
```

使用上面的 main.asc 代码我得到“usercount is undefined”，所以我一定做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:00:26.477

至少您的一个问题是您将值“viewer”分配给您的 userType var 而不是评估它。例如

```
if(userType="viewer") 
```

应该

```
if(userType == "viewer") 
```

此外，您的跟踪语句很可能在您应用程序 onStart() 之前运行，因此您的变量在那时确实是未定义的。

在您的客户端代码中，您需要在连接字符串之后在网络连接上的 connect() 函数中传递参数，所以如果它会是这样的：

```
nc.connect(fmsstring, username, userid, gender, userType, birthday); 
```

# python-3.x - 在 Komodo 7.1 IDE 中创建新命令或宏以保存和运行 python 文件

> ID：11874913
> 
> 赞同：1
> 
> 时间：2012-08-08T23:51:57.930
> 
> 标签：python-3.x, komodo

如何在 Komodo 7.1 IDE 中创建新命令或宏来保存和运行 python 文件？

我希望输出转到新控制台。不是命令输出选项卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-26T13:26:24.167

如果你放：

```
import code
code.interact(local=locals()) 
```

在您的程序中，您将被转储到[python 解释器](https://stackoverflow.com/questions/1711193/komodo-watch-variables-and-execute-code-while-on-pause-in-the-program)。（请参阅查看[当前正在运行的 Python 程序的方法](https://stackoverflow.com/questions/1637198/method-to-peek-at-a-running-python-program/1637277#1637277)）。

使用[doCommand 和 runEncodedCommand](https://stackoverflow.com/questions/6172314/python-macros-on-mac-using-komodo)分别保存和运行 python 文件：

```
komodo.assertMacroVersion(3);
if (komodo.view && komodo.view.scintilla) { komodo.view.scintilla.focus(); }
komodo.doCommand('cmd_save')
ko.run.runEncodedCommand(window, '/usr/local/bin/pythonw3 \"%F\" {\'cwd\': u\'%D\'}'); 
```

# python - 将 django polls 教程应用添加到另一个应用

> ID：11874915
> 
> 赞同：-1
> 
> 时间：2012-08-08T23:52:35.250
> 
> 标签：python, django, django-models, django-templates, django-views

我做了一个简单的博客和 django polls 教程。我试图让他们一起工作。当我加载一个帖子时，与其关联的民意调查会加载，投票再次起作用，但是当我点击一个选项，然后点击投票按钮时，它会加载带有投票 id 的 id 的帖子。我不确定它是我在视图中的“投票”功能、我的“投票”网址还是我的模板搞砸了？这是我的代码：

模型.py：

```
# Post class
class Post(models.Model):
    title = models.CharField(max_length=60)
    description = models.CharField(max_length=200)
    body = models.TextField()
    created = models.DateTimeField(auto_now_add=True)

    def display_mySafeField(self):
        return mark_safe(self.body)

    def __unicode__(self):
        return self.title

# Poll for the Post
class Poll(models.Model):
    question = models.CharField(max_length=200)
    total_votes = models.IntegerField(default=0)
    post = models.ForeignKey(Post)
    voted = models.BooleanField(default=False)

    def __unicode__(self):
        return self.question

# Choice for the poll
class Choice(models.Model):
    poll = models.ForeignKey(Poll)
    choice = models.CharField(max_length=200)
    votes = models.IntegerField(default=0)
    percentage = models.DecimalField(default=0.0, max_digits=5, decimal_places=2)

    def __unicode__(self):
        return self.choice 
```

网址.py：

```
urlpatterns = patterns('',
    ### main/index page
    url(r'^$', 'blog.views.main', name='index'),

    ### url for the post.html
    url(r'^post/(\d+)', 'blog.views.post'),

    ### polls
    url(r'^polls/(\d+)/results/$', 'blog.views.results'),
    url(r'^polls/(\d+)/vote/$', 'blog.views.vote'),
    url(r'^revote/(\d+)/$', 'blog.views.vote_again'),

) 
```

视图.py：

```
# main view for the posts
def main(request):
    posts = Post.objects.all().order_by("-created")
    paginator = Paginator(posts, 5)

    try: page = int(request.GET.get("page", '1'))
    except ValueError: page = 1

    try:
        posts = paginator.page(page)
    except (InvalidPage, EmptyPage):
        posts = paginator.page(paginator.num_pages)
    d = dict(posts=posts, user=request.user,
             post_list=posts.object_list, months=mkmonth_lst())

    return render_to_response("list.html", d)

def post(request, pk):
    post = Post.objects.get(pk=int(pk))
    comments = Comment.objects.filter(post=post)
    try:
        poll = Poll.objects.get(post=post)
    except Poll.DoesNotExist:
        poll = None
    d = dict(post=post, comments=comments, form=CommentForm(), user=request.user,
             months=mkmonth_lst(), poll=poll)
    d.update(csrf(request))
    return render_to_response("post.html", d)

#view to vote on the poll
def vote(request, post_id):
    global choice
    p = get_object_or_404(Poll, pk=post_id)
    try:
        selected_choice = p.choice_set.get(pk=request.POST['choice'])

    except (KeyError, Choice.DoesNotExist):
        # Redisplay the poll voting form.
        return render_to_response('post.html', {
            'poll': p,
            'error_message': "You didn't select a choice.",
            }, context_instance=RequestContext(request))
    else:
        selected_choice.votes += 1
        p.total_votes += 1
        selected_choice.save()
        p.voted = True
        p.save()

        choices = list(p.choice_set.all())
        for choice in choices:
            percent = choice.votes*100/p.total_votes
            choice.percentage = percent
            choice.save()

        return HttpResponseRedirect(reverse("blog.views.post", args=[post_id    ]))

def vote_again(request, post_pk):
    try:
        p = get_object_or_404(Poll, post_id=post_pk)
    except (KeyError, Poll.DoesNotExist):
        pass
    else:
        p.voted = False
        p.save()
    return HttpResponseRedirect(reverse("blog.views.post", args=[post_pk])) 
```

这就是正在发生的事情：

```
post1 - linked to - poll1
post2 - not linked
post3 - linked to - poll2 
```

当我对链接到 post3 的 poll2 进行投票时，它会更新 poll2 的数据库，但它会重新加载 post2 而不是 post3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T01:30:28.093

在您的 HTML 表单中，您的操作设置为`/polls/{{ poll.id }}/vote/`. 但是，它正在寻找`post.pk`价值，而不是`poll.pk`. 它使用该值在提交数据后重新加载页面。那应该是你的问题。

**编辑**

```
def vote(request, poll_id):
    global choice
    p = get_object_or_404(Poll, pk=poll_id)
       try:
        selected_choice = p.choice_set.get(pk=request.POST['choice'])    

    except (KeyError, Choice.DoesNotExist):
        # Redisplay the poll voting form.
        return render_to_response('post.html', {
            'poll': p,
            'error_message': "You didn't select a choice.",
            }, context_instance=RequestContext(request))
    else:
        selected_choice.votes += 1
        p.total_votes += 1
        selected_choice.save()
        p.voted = True
        p.save()

        choices = list(p.choice_set.all())
        for choice in choices:
            percent = choice.votes*100/p.total_votes
            choice.percentage = percent
            choice.save()

        return HttpResponseRedirect(reverse("blog.views.post", args=[ p.post.pk ] ) 
```

# java - 在 Java 中解析 JSON 字符串

> ID：11874919
> 
> 赞同：76
> 
> 时间：2012-08-08T23:52:46.317
> 
> 标签：java, json, parsing

我正在尝试在 java 中解析 JSON 字符串以单独打印单个值。但是在使程序运行时，我收到以下错误-

```
Exception in thread "main" java.lang.RuntimeException: Stub!
       at org.json.JSONObject.<init>(JSONObject.java:7)
       at ShowActivity.main(ShowActivity.java:29) 
```

我的班级看起来像-

```
import org.json.JSONException;
import org.json.JSONObject;

public class ShowActivity {
   private final static String  jString = "{" 
   + "    \"geodata\": [" 
   + "        {" 
   + "                \"id\": \"1\"," 
   + "                \"name\": \"Julie Sherman\","                  
   + "                \"gender\" : \"female\"," 
   + "                \"latitude\" : \"37.33774833333334\"," 
   + "                \"longitude\" : \"-121.88670166666667\""            
   + "                }" 
   + "        }," 
   + "        {" 
   + "                \"id\": \"2\"," 
   + "                \"name\": \"Johnny Depp\","          
   + "                \"gender\" : \"male\"," 
   + "                \"latitude\" : \"37.336453\"," 
   + "                \"longitude\" : \"-121.884985\""            
   + "                }" 
   + "        }" 
   + "    ]" 
   + "}"; 
   private static JSONObject jObject = null;

   public static void main(String[] args) throws JSONException {
       jObject = new JSONObject(jString);
       JSONObject geoObject = jObject.getJSONObject("geodata");

       String geoId = geoObject.getString("id");
           System.out.println(geoId);

       String name = geoObject.getString("name");
       System.out.println(name);

       String gender=geoObject.getString("gender");
       System.out.println(gender);

       String lat=geoObject.getString("latitude");
       System.out.println(lat);

       String longit =geoObject.getString("longitude");
       System.out.println(longit);                   
   }
} 
```

让我知道我缺少什么，或者每次运行应用程序时都会出现该错误的原因。任何意见将不胜感激。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-08-09T00:06:53.343

见我的[评论](https://stackoverflow.com/questions/11874919/parsing-json-string-in-java#comment15799748_11874919)。您需要在运行时包含完整的[org.json 库](http://www.json.org/java/index.html)，因为*android.jar*仅包含要编译的存根。

此外，您必须删除`}`JSON 数据后面的两个 extra 实例`longitude`。

```
 private final static String JSON_DATA =
     "{" 
   + "  \"geodata\": [" 
   + "    {" 
   + "      \"id\": \"1\"," 
   + "      \"name\": \"Julie Sherman\","                  
   + "      \"gender\" : \"female\"," 
   + "      \"latitude\" : \"37.33774833333334\"," 
   + "      \"longitude\" : \"-121.88670166666667\""
   + "    }," 
   + "    {" 
   + "      \"id\": \"2\"," 
   + "      \"name\": \"Johnny Depp\","          
   + "      \"gender\" : \"male\"," 
   + "      \"latitude\" : \"37.336453\"," 
   + "      \"longitude\" : \"-121.884985\""
   + "    }" 
   + "  ]" 
   + "}"; 
```

除此之外，`geodata`实际上不是 a`JSONObject`而是 a `JSONArray`。

这是完全工作且经过测试的更正代码：

```
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

public class ShowActivity {

  private final static String JSON_DATA =
     "{" 
   + "  \"geodata\": [" 
   + "    {" 
   + "      \"id\": \"1\"," 
   + "      \"name\": \"Julie Sherman\","                  
   + "      \"gender\" : \"female\"," 
   + "      \"latitude\" : \"37.33774833333334\"," 
   + "      \"longitude\" : \"-121.88670166666667\""
   + "    }," 
   + "    {" 
   + "      \"id\": \"2\"," 
   + "      \"name\": \"Johnny Depp\","          
   + "      \"gender\" : \"male\"," 
   + "      \"latitude\" : \"37.336453\"," 
   + "      \"longitude\" : \"-121.884985\""
   + "    }" 
   + "  ]" 
   + "}"; 

  public static void main(final String[] argv) throws JSONException {
    final JSONObject obj = new JSONObject(JSON_DATA);
    final JSONArray geodata = obj.getJSONArray("geodata");
    final int n = geodata.length();
    for (int i = 0; i < n; ++i) {
      final JSONObject person = geodata.getJSONObject(i);
      System.out.println(person.getInt("id"));
      System.out.println(person.getString("name"));
      System.out.println(person.getString("gender"));
      System.out.println(person.getDouble("latitude"));
      System.out.println(person.getDouble("longitude"));
    }
  }
} 
```

这是输出：

```
C:\dev\scrap>java -cp json.jar;. ShowActivity
1
Julie Sherman
female
37.33774833333334
-121.88670166666667
2
Johnny Depp
male
37.336453
-121.884985 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-07-01T08:17:09.060

要将您的**JSON 字符串转换为 hashmap**，您可以使用以下命令：

```
HashMap<String, Object> hashMap = new HashMap<>(Utility.jsonToMap(response)) ; 
```

**使用这个类:** )（处理偶数列表、嵌套列表和 json）

```
public class Utility {

    public static Map<String, Object> jsonToMap(Object json) throws JSONException {

        if(json instanceof JSONObject)
            return _jsonToMap_((JSONObject)json) ;

        else if (json instanceof String)
        {
            JSONObject jsonObject = new JSONObject((String)json) ;
            return _jsonToMap_(jsonObject) ;
        }
        return null ;
    }

   private static Map<String, Object> _jsonToMap_(JSONObject json) throws JSONException {
        Map<String, Object> retMap = new HashMap<String, Object>();

        if(json != JSONObject.NULL) {
            retMap = toMap(json);
        }
        return retMap;
    }

    private static Map<String, Object> toMap(JSONObject object) throws JSONException {
        Map<String, Object> map = new HashMap<String, Object>();

        Iterator<String> keysItr = object.keys();
        while(keysItr.hasNext()) {
            String key = keysItr.next();
            Object value = object.get(key);

            if(value instanceof JSONArray) {
                value = toList((JSONArray) value);
            }

            else if(value instanceof JSONObject) {
                value = toMap((JSONObject) value);
            }
            map.put(key, value);
        }
        return map;
    }

    public static List<Object> toList(JSONArray array) throws JSONException {
        List<Object> list = new ArrayList<Object>();
        for(int i = 0; i < array.length(); i++) {
            Object value = array.get(i);
            if(value instanceof JSONArray) {
                value = toList((JSONArray) value);
            }

            else if(value instanceof JSONObject) {
                value = toMap((JSONObject) value);
            }
            list.add(value);
        }
        return list;
    }
} 
```

* * *

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-09T00:01:58.133

看起来对于您的两个对象（在数组内部），您在“经度”之后都有一个额外的右括号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-09T00:07:02.323

`}`首先，在 each之后有一个额外的`array object`。

其次，“地理数据”是一个`JSONArray`. 因此，`JSONObject geoObject = jObject.getJSONObject("geodata");`您必须将其作为`JSONArray geoObject = jObject.getJSONArray("geodata");`

拥有 后，`JSONArray`您可以获取`JSONArray`using中的每个条目`geoObject.get(<index>)`。

我正在使用`org.codehaus.jettison.json`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-07-26T16:48:34.737

这是一个对象的示例，对于您的情况，您必须使用 JSONArray。

```
public static final String JSON_STRING="{\"employee\":{\"name\":\"Sachin\",\"salary\":56000}}";  
try{  
   JSONObject emp=(new JSONObject(JSON_STRING)).getJSONObject("employee");  
   String empname=emp.getString("name");  
   int empsalary=emp.getInt("salary");  

   String str="Employee Name:"+empname+"\n"+"Employee Salary:"+empsalary;  
   textView1.setText(str);  

}catch (Exception e) {e.printStackTrace();}  
   //Do when JSON has problem.
} 
```

我没有时间，但试图给出一个想法。如果你还是做不到，那我来帮忙。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-08-09T00:04:56.177

你在每个对象中有一个额外的“ **}** ”，你可以这样写 json 字符串：

```
public class ShowActivity {   
    private final static String  jString = "{" 
    + "    \"geodata\": [" 
    + "        {" 
    + "                \"id\": \"1\"," 
    + "                \"name\": \"Julie Sherman\","                  
    + "                \"gender\" : \"female\"," 
    + "                \"latitude\" : \"37.33774833333334\"," 
    + "                \"longitude\" : \"-121.88670166666667\""            
    + "                }" 
    + "        }," 
    + "        {" 
    + "                \"id\": \"2\"," 
    + "                \"name\": \"Johnny Depp\","          
    + "                \"gender\" : \"male\"," 
    + "                \"latitude\" : \"37.336453\"," 
    + "                \"longitude\" : \"-121.884985\""            
    + "                }" 
    + "        }" 
    + "    ]" 
    + "}"; 
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-06-12T18:19:25.823

我们将使用 java 对象打印 json 的值。我们可以使用 Gson 库将 json 字符串解析为 java 对象。我们有一个像

```
 String json = "{"id":1,"name" : "json" }" 
```

现在我们将 json 字符串解析为 java 对象，所以首先我们创建带有文件名 id 和 name 的 java pojo

```
public class Student {
private int id;
private String  name;
     //getter 
    //setter
 } 
```

我们将使用 Gson 从 json 字符串创建学生对象

```
 Student stu = gson.fromJson(json, Student.class); 
```

现在您可以使用 getter 打印任何 json 字段的值

```
 System.out.println(" id ="+ stu.getId() +" name ="+ stu.getName()); 
```

**参考**：[如何将 JSON 转换为 Java 对象 Gson 示例/从 Java 对象 Gson 示例](https://www.javavogue.com/2015/10/how-to-convert-json-to-from-java-object-html/)

* * *

## 回答 #8

> 赞同：-5
> 
> 时间：2012-08-09T00:01:32.217

如果我错了，请纠正我，但 json 只是由“：”分隔的文本，所以只需使用

```
String line = ""; //stores the text to parse.

StringTokenizer st = new StringTokenizer(line, ":");
String input1 = st.nextToken(); 
```

继续使用 st.nextToken() 直到数据用完。确保使用“st.hasNextToken()”，以免出现空异常。

# mapping - 多好的地图可以让街道在多边形之上

> ID：11874925
> 
> 赞同：0
> 
> 时间：2012-08-08T23:54:11.937
> 
> 标签：mapping, gis, geocoding

我想使用 google、mapquest、bing 或 openlayers 之类的东西来尝试获得看起来像的东西

[http://screencast.com/t/qZejYb0L3Er](http://screencast.com/t/qZejYb0L3Er)

主要街道不受多边形覆盖的影响。

有人可以指出我正确的方向。从 google api 文档看来，我无法进入道路，所以......寻求帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-13T10:57:26.133

您可以通过更改图层的顺序来使用 Google 地图。 [**这是一个 API V2 示例**](http://maps.forum.nu/gm_main.html?lat=40.446947&lon=-90.834961&z=5&mType=19)，但您可以使用当前版本（即 V3）实现相同的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T23:15:02.917

我们最终使用了具有开放地图背景的[http://www.mapdotnet.com/ 。](http://www.mapdotnet.com/)来自存储在 SQL 中的形状文件的自定义中间缓存切片，在顶部我们有开放的街道图层（或者可以使用 bing）

# jquery - jQuery在Chrome头痛中使用最大高度和最大宽度定位图像

> ID：11874926
> 
> 赞同：0
> 
> 时间：2012-08-08T23:54:23.703
> 
> 标签：jquery, firefox, google-chrome, positioning

我刚刚注意到在某个阶段 Chrome 已经更新到新版本，我的一些 jQuery 代码不再工作......（jQuery 版本 1.7 - 与 wordpress 捆绑在一起）

这是在幻灯片放映中定位图像（居中）和定位上一个/下一个按钮的基本代码。它在 FF 中工作（不了解 IE - 我尽可能少地看）。它现在在 chrome 中所做的，不是计算盒子的高度减去图像的高度，而是简单地将盒子的高度除以 2。因此，对于一个 4 倍高、图像 2 倍高的盒子，FF 给了我正确的“top: 1x”，而 Chrome 给了我“top:2x”。

奇怪的是，它正确定位了#next 和#prev div...

```
h = j$('.slide').height();
w = j$('.slide').width();
nph = j$('#next').height();
j$('.slide').each(function(){
   thisImg= j$(this).find('img');
   var imgH = thisImg.height();
   var imgW = thisImg.width();
   thisImg.css({'position':'absolute',
               'top':(h-imgH)/2,
               'left':(w-imgW)/2
   } );
}) ;
j$('#next, #prev').css('top',(h-nph)/2); 
```

};

要么我没有正确地做某事，要么 chrome 发生了一些变化（自更新以来，我在另一个站点上丢失了完整的动画）。如果我没有错，Chrome 有什么技巧？

编辑进一步的研究使我认为这是因为我试图在灵活（基于百分比）环境中使用图像。这意味着图像和 div 的样式如下：

```
div {height:100%;width:100%;}
img {max-height:100%;max-width:100%} 
```

似乎 Firefox 可以进行计算，但 Chrome 不能。“下一个”和“上一个” div 具有已知尺寸（并且位置正确） 有没有办法在加载图像时“捕捉”图像并在应用 max-height 和 max-width 之前找出它的尺寸？

进一步更新我已经设法确认，如果 Chrome 的样式为“max-height”或“max-width”，则 Chrome 无法返回页面上图像的高度值。“outerHeight/Width”方法也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-10T04:32:46.083

Nick，我认为解决方法是在 javascript 而不是 CSS 中应用`max-height`and`max-width`限制，并具有允许保持图像纵横比的额外优势。CSS 没有此功能，因为它独立应用高度和宽度限制。

应用限制可以在应用“左”和“上”偏移的同一循环中完成。

试试这个：

```
j$(function() {
    j$(".slide img").each(function(i, img) {
        var $img = j$(img),
            $wrapper = $img.closest(".slide"),//assuming '.slide' is the constraining wrapper
            w = $wrapper.width(),
            h = $wrapper.height(),
            _w = $img.width(),
            _h = $img.height(),
            scale = Math.min(1, w/_w, h/_h);//scale down if necessary, never scale up, preserving aspect ratio
        _w *= scale;
        _h *= scale;
        $img.width(_w).height(_h).css({
            'position': 'absolute',
            'left': ( w - _w ) / 2,
            'top': ( h - _h ) / 2
        });
    });
    var nph = j$('#next').height();
    j$('#next, #prev').css('top', (h-nph)/2);
}); 
```

如评论中所述，我不得不假设这`.slide`是约束包装。如果不是，则调整语句中的选择器`$wrapper = $img.closest(".slide")`。

别担心`Math.min()`，这不是一个错误。*取*最小值，*应用*最大值。

# python - 使用 Python 为 GAE 覆盖数据存储区 - 留言簿示例

> ID：11874934
> 
> 赞同：0
> 
> 时间：2012-08-08T23:55:53.183
> 
> 标签：python, google-app-engine, entity, data-modeling

我想做一些与 GAE 在 Python 中提供的留言簿示例非常相似的事情。

但是，我希望每个提交都覆盖当前用户先前存在的任何一个，而不是允许一个用户多次签名。

我无法弄清楚如何编辑此示例以使其正常工作。

```
import cgi
import datetime
import urllib
import wsgiref.handlers

from google.appengine.ext import db
from google.appengine.api import users
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app

class Greeting(db.Model):
"""Models an individual Guestbook entry with an author, content, and date."""
author = db.StringProperty()
content = db.StringProperty(multiline=True)
date = db.DateTimeProperty(auto_now_add=True)

def guestbook_key(guestbook_name=None):
"""Constructs a Datastore key for a Guestbook entity with guestbook_name."""
return db.Key.from_path('Guestbook', guestbook_name or 'default_guestbook')

class MainPage(webapp.RequestHandler):
def get(self):
self.response.out.write('<html><body>')
guestbook_name=self.request.get('guestbook_name')

# Ancestor Queries, as shown here, are strongly consistent with the High
# Replication Datastore. Queries that span entity groups are eventually
# consistent. If we omitted the ancestor from this query there would be a
# slight chance that Greeting that had just been written would not show up
# in a query.
greetings = db.GqlQuery("SELECT * "
                        "FROM Greeting "
                        "WHERE ANCESTOR IS :1 "
                        "ORDER BY date DESC LIMIT 10",
                        guestbook_key(guestbook_name))

for greeting in greetings:
  if greeting.author:
    self.response.out.write(
        '<b>%s</b> wrote:' % greeting.author)
  else:
    self.response.out.write('An anonymous person wrote:')
  self.response.out.write('<blockquote>%s</blockquote>' %
                          cgi.escape(greeting.content))

self.response.out.write("""
      <form action="/sign?%s" method="post">
        <div><textarea name="content" rows="3" cols="60"></textarea></div>
        <div><input type="submit" value="Sign Guestbook"></div>
      </form>
      <hr>
      <form>Guestbook name: <input value="%s" name="guestbook_name">
      <input type="submit" value="switch"></form>
    </body>
  </html>""" % (urllib.urlencode({'guestbook_name': guestbook_name}),
                      cgi.escape(guestbook_name)))

class Guestbook(webapp.RequestHandler):
def post(self):
# We set the same parent key on the 'Greeting' to ensure each greeting is in
# the same entity group. Queries across the single entity group will be
# consistent. However, the write rate to a single entity group should
# be limited to ~1/second.
guestbook_name = self.request.get('guestbook_name')
greeting = Greeting(parent=guestbook_key(guestbook_name))

if users.get_current_user():
  greeting.author = users.get_current_user().nickname()

greeting.content = self.request.get('content')
greeting.put()
self.redirect('/?' + urllib.urlencode({'guestbook_name': guestbook_name}))

application = webapp.WSGIApplication([
('/', MainPage),
('/sign', Guestbook)
], debug=True)

def main():
run_wsgi_app(application)

if __name__ == '__main__':
main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:29:12.217

最简单的方法是修改类的`post`方法`Guestbook`，以便它检查当前用户的现有帖子并更新它（如果存在）。

```
class Guestbook(webapp.RequestHandler):
  def post(self):
    guestbook_name = self.request.get('guestbook_name')
    user = users.get_current_user()
    nickname = None
    if user:
      nickname = user.nickname()
      greeting = Greeting.gql('WHERE author = :1 AND ANCESTOR IS :2',
          nickname, guestbook_key(guestbook_name)).get()
    if not greeting:
      greeting = Greeting(parent=guestbook_key(guestbook_name))
      greeting.author = nickname

    greeting.content = self.request.get('content')
    greeting.put()
    self.redirect('/?' + urllib.urlencode({'guestbook_name': guestbook_name})) 
```

# wcf - 用于加密的 WCF 绑定安全性

> ID：11874935
> 
> 赞同：3
> 
> 时间：2012-08-08T23:55:55.227
> 
> 标签：wcf, security, encryption, wshttpbinding, basichttpbinding

这是我很困惑的 WCF 绑定和安全问题：

> 您在 [http://www.contoso.com](http://www.contoso.com)为执法机构托管 Windows Communication Foundation (WCF) 服务。该机构增加了支持通过非缓冲流发送生物识别指纹数据的操作。服务数据在中介之间路由。默认情况下，您使用的 WCF 绑定不支持加密。您需要确保指纹数据在通过网络传递时不会泄露。你该怎么办？
> 
> *   A. 使用具有消息安全性的 basicHttpBinding 到 https://www.contoso.com
> *   B. 使用具有传输安全性的 basicHttpBinding 到 https://www.contoso.com
> *   C. 使用带有消息安全性的 wsHttpBinding 到 https://www.contoso.com
> *   D. 使用具有传输安全性的 wsHttpBinding 到 http://www.contoso.com

答案是 B。但我认为这里说的是“服务数据在中介之间路由”，因此消息安全性应该优于传输安全性。好吧，它确实说“默认情况下您使用的 WCF 绑定不支持加密”，但是这里的选项确实提供了使用 wsHttpBinding，所以我认为 A 和 C 都可以。谁能告诉我那里有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T00:12:17.310

问题中的这句话是关键：

> 您默认使用的 WCF 绑定不支持加密

所以这意味着问题暗示您正在使用 basicHttpBinding，因为 wsHttpBinding 默认启用 WS*-Security。您实际上可以通过 Fiddler 检查调用。默认情况下，使用安全令牌对消息进行签名和加密 - 对于血腥细节 - 这[解释](http://blogs.msdn.com/b/socaldevgal/archive/2007/08/15/why-is-wshttpbinding-secure-by-default-how-does-it-work.aspx)了缓存在服务上的 SPNEGO 令牌。

因此，由于我之前突出显示的句子，因此消除了 C、D。

剩下的就是A 和 B。我不同意 B，因为 MSDN 本身[声明](http://msdn.microsoft.com/en-us/library/ms733137.aspx)**传输安全性仅通过点对点的通信来保护消息。如果消息在到达最终接收者之前被路由到一个或多个 SOAP 中介，那么一旦中介从线路中读取消息，消息本身就不受保护**。

问题也很明确的说：

> 服务数据在中介之间路由

因此，我相信正确的答案是**A**，一些关于 SO 的 WCF 专家可能会纠正我。

# javascript - JQuery：悬停时的文本颜色切换

> ID：11874939
> 
> 赞同：1
> 
> 时间：2012-08-08T23:56:52.390
> 
> 标签：javascript, jquery, jquery-ui

可能很简单，只是尝试在将鼠标悬停在 div 上时为文本的颜色设置动画。到目前为止对 SO 进行了研究，但如果有人能指出我正确的方向，那就太棒了。目前这什么都不做，也不会向控制台抛出任何错误：

```
$('#homenav .homenavimg').hover(function (){
    $('#homenav h1').toggle(function() {
       $(this).animate({ color: "#FF0000" }, 1000);
    }, function() {
       $(this).animate({ color: "#000000" }, 1000);
    });
}); 
```

提前致谢！（PS：我有链接到 JQuery 和 UI 设置好）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:10:27.203

如果您提供了您的标记，那会很棒，但请检查一下。可能你正在寻找这样的东西

[http://jsfiddle.net/j6AeZ/2/](http://jsfiddle.net/j6AeZ/2/)

```
$('#homenav .homenavimg').hover(function (){
$('#homenav h1').stop().animate({ color: "#FF0000" }, 1000);
  }, function() {
  $('#homenav h1').stop().animate({ color: "#000000" }, 1000);
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T00:04:23.623

```
$('#homenav .homenavimg').hover(function (){
    $('#homenav h1').stop().animate({ color: "#FF0000" }, 1000);
 }, function() {
    $('#homenav h1').stop().animate({ color: "#000000" }, 1000);
}); 
```

没必要用`.toggle()`，反正你之前用错了。

JSfiddle：http: [//jsfiddle.net/uArDu/2/](http://jsfiddle.net/uArDu/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-13T02:51:19.173

如果有人有兴趣将其转换为导航样式效果（即适用于多个 h1），请执行以下操作：

```
$('#homenav .homenavimg').hover(function (){
$(this).find('h1').stop().animate({ color: "#53799E" }, 250);
 }, function() {
  $(this).find('h1').stop().animate({ color: "#F58426" }, 250);
}); 
```

# shell - 仅显示目录树中所有文件的文件名和创建时间

> ID：11874940
> 
> 赞同：0
> 
> 时间：2012-08-08T23:57:16.880
> 
> 标签：shell, directory, cygwin, dos

主持人：赢7

我今天更新了一个产品（如果你愿意，可以打补丁）。我想具体查看哪些文件已添加到基本安装目录树中。

预期结果将仅显示创建时间戳和完整文件路径/名称。我不想看到目录摘要信息或数据中的任何其他中断。输出将是一个非常直观的列表，如下所示：

```
08/06/2012  11:02 AM c:\my_product_install_path\folder3\new_file_3.xml
08/06/2012  11:01 AM c:\my_product_install_path\folder2\new_file_2.c
08/06/2012  11:01 AM c:\my_product_install_path\new_file_1.h
...
... 
```

我认为从完整安装目录树的自上而下列表中，我可以通过向下滚动并查找时间早于 X 的第一个文件来轻松地从旧文件中查看新文件。

如何在 Windows 命令 shell（或 cygwin shell）中执行此操作？

“dir /s /b”非常接近，但它不显示创建时间戳。

您可能认为“dir /s /b /T:C”会起作用，因为 /T:C 用于显示创建时间，但不是。/T:C 选项不会“覆盖” /b 选项来显示时间戳所以，不知何故，我需要通过添加时间戳来获得 /b 选项的好处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T05:21:29.490

这是命令行的繁琐本机解决方案，但它有效:-)

```
for /d /r %F in (.) do @pushd "%F"&(for /f "eol= delims=" %S in ('2^>nul dir /tc /a-d *') do @for /f "tokens=1-4*" %A in ("%S") do @echo %A  %B %C  %~fE)&popd 
```

在批处理文件中跨多行格式化时看起来更好。

```
@echo off
for /d /r %%F in (.) do (
  pushd "%%F"
  for /f "eol= delims=" %%S in ('2^>nul dir /tc /a-d *') do (
    for /f "tokens=1-4*" %%A in ("%%S") do @echo %%A  %%B %%C  %%~fE
  )
  popd
) 
```

您可能希望按时间倒序对列表进行排序，以便所有新文件都聚集在顶部。使用该`DIR /ODN`选项在每个目录中按时间顺序进行排序是微不足道的。但是在所有目录中按时间顺序排序是相当棘手的。这需要解析时间戳信息并以允许 SORT 生成按时间顺序排列的方式重新格式化它。不幸的是，解析时间戳非常依赖于语言环境。

这是一个适用于 OP 语言环境设置的批处理解决方案。它首先按创建时间戳按时间顺序排序，然后按完整文件路径的字母顺序排序。

```
@echo off
setlocal
set "tempFile=%temp%\listCreateTime%random%.txt"
>"%tempFile%" (
  for /d /r %%F in (.) do (
    pushd "%%F"
    for /f "eol= delims=" %%S in ('2^>nul dir /tc /a-d *') do (
      for /f "tokens=1-6* delims=/ " %%A in ("%%S") do (
        if "%%D"=="12:00" (
          echo %%C%%A%%B%%E00:00%%~fG*%%A/%%B/%%C  %%D %%E  %%~fG
        ) else (
          echo %%C%%A%%B%%E%%D%%~fG*%%A/%%B/%%C  %%D %%E  %%~fG
        )
      )
    )
    popd
  )
)
for /f "tokens=2 delims=*" %%A in ('sort /r "%tempFile%"') do echo %%A
del "%tempFile%" 
```

也可以使用 WMIC 来获取和排序信息。它要简单得多，因为时间戳已经以允许 SORT 按时间顺序对其进行排序的方式进行格式化，因此无需解析。它也是独立于语言环境的——它应该可以在世界上任何支持 WMIC 的 Windows 机器上工作。但是这种方法速度较慢，而且输出也不那么容易阅读。当然，可以添加额外的编码来解析时间戳中的子字符串并重新格式化为更熟悉的形式。

```
@echo off
setlocal disableDelayedExpansion
set "tempFile=%temp%\listCreateTime%random%.txt"
>"%tempFile%" (
  for /d /r %%F in (.) do (
    set "folder=%%~pnxF\"
    set "drive=%%~dF"
    setlocal enableDelayedExpansion
    2>nul wmic datafile where "drive='!drive!' and path='!folder:\=\\!'" get name, creationDate|findstr /brc:[0-9]
    endlocal
  )
)
sort /r "%tempFile%"
del "%tempFile%" 
```

时间戳在 YYYYMMDDhhmmss.ddddddzzzz

*   YYYY = 年
*   MM = 月
*   DD = 天
*   hh = 24 小时格式的小时
*   毫米 = 分钟
*   ss = 秒
*   dddddd = 微秒
*   zzzz = 时区信息，表示为与 GMT 相差的分钟数

# timeout - 为可编辑操作设置超时？

> ID：11874944
> 
> 赞同：1
> 
> 时间：2012-08-08T23:57:36.447
> 
> 标签：timeout, datatables, jeditable

我正在为 Datatables 使用 jeditable 插件。我有一个设置了一个表的页面，该表将提交的添加表单传递给 .java 类进行处理，并设置了 fnShowError 参数以显示失败消息。

添加处理程序的操作确实需要一段时间，有时添加会成功，但无论如何我都会收到 fnSHowError 消息，可能是因为超时。有没有办法为 add 函数指定超时长度？

# mysql - 避免创建临时或永久表

> ID：11874945
> 
> 赞同：0
> 
> 时间：2012-08-08T23:57:49.567
> 
> 标签：mysql, phpmyadmin, temp-tables

我想使用表格进行操作，但到目前为止我发现的唯一解决方案是首先创建一些表格并将它们连接在一起以获得所需的结果。

我试图避免创建表并在我的 MySQL 查询末尾删除它们，顺便说一句，我在 phpmyadmin 页面上运行。

这是数据：我有一个包含 user_id、columnA_unixtime、columnB_unixtime 的表——这意味着对于每个用户，数据库中存储了两个 unix_time，用于两个不同的事件。

```
user_id eventA_join eventB_join
1 1321652009 1321652009
2 0 1321652257
3 0 1321668650
4 1321669261 0

```

我想要的是一张表格，显示每天有多少用户参加了这两个活动。像这样的东西（只是一个样本）

```
日事件A 事件B
2011 年 11 月 18 日 3 2
11/19/11 11 8
2011 年 11 月 20 日 6 3
11/21/11 17 11

```

这是我到目前为止使用的代码：

```
CREATE TABLE table1(
day VARCHAR(256),
eventA_count INT);

INSERT INTO table1 (day, eventA_count)
(SELECT DATE(FROM_UNIXTIME('eventA_join') ) AS 'day', COUNT('user_id') AS 'eventA_count'
FROM org_table
WHERE 'eventA_join' > 0
GROUP BY day);

CREATE TABLE table2(
day VARCHAR(256),
eventB_count INT);

INSERT INTO table2 (day, eventB_count)
(SELECT DATE(FROM_UNIXTIME('eventB_join') ) AS 'day', COUNT('user_id') AS 'eventB_count'
FROM org_table
WHERE 'eventB_join' > 0
GROUP BY day);

SELECT t.day, t1.eventA_count, t2.eventB_count FROM
(SELECT DISTINCT day FROM table1
UNION
SELECT DISTINCT day FROM table2) t
LEFT JOIN table1 t1 
ON t.day = t1.day
LEFT JOIN table2 t2
ON t.day = t2.day

DROP table2;
DROP table1; 
```

据我尝试，我无法在 phpmyadmin 中使用表变量，也无法使用模板表，因为当我尝试加入它们时，无法多次引用模板表（错误 #10327 无法重新打开临时表）一起。

无论如何我避免创建表格但获得我正在寻找的东西？有什么想法吗？

编辑：两个表都从“org_table”获取数据，现在在代码中更正了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T01:28:51.753

使用单个查询很容易做到这一点。你只需要 UNION ALL：

```
select date, sum(IsEventA) as EventA, sum(isEventB) as EventB
from ((select user_id, DATE(FROM_UNIXTIME('eventA_join') as date,
              1 as IsEventA, 0 as IsEventB
       from table1
       where eventA_join > 0
      ) union all
      (select user_id, DATE(FROM_UNIXTIME('eventB_join') as date,
              0 as IsEventA, 1 as IsEventB
       from table1
       where eventB_join > 0
      )
     ) t
group by date
order by 1 
```

# javascript - Node.js 中的跨域连接

> ID：11874946
> 
> 赞同：0
> 
> 时间：2012-08-08T23:58:05.470
> 
> 标签：javascript, node.js, socket.io

我正在学习 Node 并且有一个我似乎无法找到答案的问题。在以下简约聊天服务器示例中，节点服务器希望客户端页面与服务器文件位于同一目录中，如果我正在为移动设备构建客户端应用程序，我将如何将数据发送回正确的客户？

```
 var fs = require('fs')
    , http = require('http')
    , socketio = require('socket.io');

var server = http.createServer(function(req, res) {
    res.writeHead(200, { 'Content-type': 'text/html'});
    **res.end(fs.readFileSync(__dirname + '/index.html'));** 
}).listen(8080, function() {
    console.log('Listening at: http://localhost:8080');
});

socketio.listen(server).on('connection', function (socket) {
    socket.on('message', function (msg) {
        console.log('Message Received: ', msg);
        socket.broadcast.emit('message', msg);
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:34:42.487

你遇到[这个问题](https://stackoverflow.com/questions/10738073/socket-io-phonegap)了吗？如果是这样，也许使用用于 WebSockets 的 phonegap iOS / Android 插件可能会对您有所帮助。

作为参考，这里是什么`res.end(fs.readFileSync(__dirname + '/index.html'));`意思：

1.  同步读取文件 index.html 的内容（位于服务器当前目录）

2.  在通过网络将文件内容发送给请求页面的客户端（可以是本地机器、电话、互联网上的计算机——任何有权访问服务器的人）之后，结束 HTTP 响应。换句话说，节点充当页面 index.html 的 HTTP 服务器

3.  index.html 大概包含一些socket相关的代码，指示客户端连接到服务器上的socket（服务器的socket是由创建的`socketio.listen(server)`）

# asp.net - 使用 WIF 安全令牌服务将用户的 asp.net 会话限制为 1

> ID：11874949
> 
> 赞同：2
> 
> 时间：2012-08-08T23:58:49.310
> 
> 标签：asp.net, security, token, wif

我们正在构建一组 Web 应用程序，这些应用程序都使用自己独特的角色提供程序，使用 sql server 并利用 Windows Identity Foundation 提供安全令牌服务来处理使用 Active Directory 的成员资格。此解决方案还提供单点登录的好处。一个疏忽是只允许用户进行一次会话。跟踪用户是否已经有活动会话似乎很容易实现，如果确定用户已经在其他地方登录，这就是处理用户会话的内容和方式。

我的问题是，如果用户试图产生一个额外的会话，那么终止现有用户会话的推荐方法是什么？还想通知用户已检测到现有会话，并通过继续，现有会话将被终止。（这部分似乎也很琐碎……）

具有 2 个 Web 应用程序和一个 STS Identity 应用程序的示例场景：

*   用户尝试访问应用程序 A：
*   STS 身份扩展确定用户尚未登录，提供声明并缓存用户/会话标识符。
*   用户尝试访问不同计算机上的应用程序 B。（如果使用相同的会话，他们可以访问应用程序 B）
*   STS Identity 确定用户有活动会话并拒绝登录。

似乎还有其他发行人需要克服，例如……。

*   如果用户主动保持会话活动，如何从应用程序 A 更新登录用户缓存。
*   您将如何处理未明确注销的用户，例如关闭浏览器或会话超时。
*   其他问题？？？

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-10T12:32:12.763

我们选择在应用程序级别处理并发，使用存储用户会话 ID 的简单表。如果在其他地方为应用程序创建了新会话，则现有会话将终止，使用被重定向回 STS，并带有一条消息（在查询字符串中携带），说明它们被重定向回登录页面的原因。

# git - 如何通过 git 下载源代码？

> ID：11874950
> 
> 赞同：-1
> 
> 时间：2012-08-08T23:58:50.503
> 
> 标签：git

我想`git://git.openscada.org/org.openscada.utgard.git`从[某个网站](http://openscada.org/downloads/)下载源代码，但只能通过 Git 下载。

我已经下载了一个 Git Bash。我的问题是如何下载这个源？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T00:01:28.120

确认您已在 CLI 上安装了 Git...

```
whereis git 
```

你应该看到类似的东西`/usr/bin/git`。

运行后，您可以使用...

```
git clone git://git.openscada.org/org.openscada.utgard.git 
```

这应该使用源创建一个文件夹 ( `org.openscada.utgard`)。如果您希望它克隆到不同的文件夹，请将其名称作为第二个参数传递给`git clone`...

`git clone git://git.openscada.org/org.openscada.utgard.git /path/to/folder`

# python - 使用 pygame 问题/问题的基于瓷砖的游戏

> ID：11874952
> 
> 赞同：2
> 
> 时间：2012-08-08T23:59:22.467
> 
> 标签：python, pygame

感谢您抽时间阅读。我正在尝试使用 pygame 创建一个非常基本的瓷砖游戏系统。我不是最擅长 pygame，所以我可能遗漏了一些相当明显的东西。到目前为止，我将所有内容都放在一个文件中。我现在所拥有的似乎真的很草率，并且可能有一种更有效的方法，但现在我只是使用二维数组，其数字等于特定类型的瓷砖（草、水等）。为此，我正在使用 numpy，因为这是有人向我推荐的。虽然我不知道我是否喜欢这种方法，因为如果将来我有一些不仅仅是图形的图块，并且有更具体的属性怎么办？例如宝箱或陷阱？你会如何构建这个？

但无论如何，我的问题是现在屏幕只是黑色的，并且没有绘制草砖。

这是代码：

```
import numpy
import pygame
import sys
from pygame.locals import *

pygame.init()

fpsClock = pygame.time.Clock()

windowWi = 800
windowHi = 608

mapWi = 50 # *16 = 800, etc
mapHi = 38

# ----- all of the images ------------------------------

grass1 = pygame.image.load('pictures\(Grass\grass1.png')

#-------------------------------------------------------
screen = pygame.display.set_mode((windowWi, windowHi))
pygame.display.set_caption("Tile Testing!")

gameRunning = True

groundArray = numpy.ones((mapWi,mapHi))

def drawMapArray(maparray):
    for x in range(mapWi,1):
        for y in range(mapHi,1):
            #Determines tile type.
            if maparray[y,x] == 1:
                screen.blit(grass1, (x*16, y*16))
            else:
                print "Nothing is here!"

while gameRunning:
    drawMapArray(groundArray)

    for event in pygame.event.get():
        if event.type == "QUIT":
            pygame.quit()
            sys.exit()

    #Updates display and then sets FPS to 30 FPS. 
    pygame.display.update()
    fpsClock.tick(30) 
```

请随时引导我朝着更好的结构方向发展，因为我对游戏设计非常陌生，希望得到任何反馈！

谢谢，瑞安

编辑：我已经尝试过了，这在逻辑上是有道理的，但是我得到了一个超出范围的索引错误。

```
def drawMapArray(maparray):
    for x in range(0,mapWi,1):
        for y in range(0,mapHi,1):
            #Determines tile type.
            if maparray[y,x] == 1:
                screen.blit(grass1, (x*16, y*16))
            else:
                print "Nothing is here!" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:40:45.787

当您添加更多图块类型时，一种可能会更好地扩展的解决方案是使用字典从数组中的数字获取图像，例如：

```
tile_dict = {1 : pygame.image.load('pictures\(Grass\grass1.png'),
             2 : pygame.image.load('pictures\rock.png')
            } 
```

然后只需在您的绘图函数中从字典中绘制相关条目

```
def drawMapArray(maparray):
    for x in range(0, mapWi):
        for y in range(0, mapHi):
            #Determines tile type.
            current_tile = tile_dict[maparray[x, y]]
            screen.blit(current_tile, (x*16, y*16)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-09T08:32:34.673

你的绘制方法是错误的。

```
def drawMapArray(maparray):
    for x in range(mapWi,1):
        for y in range(mapHi,1):
            #Determines tile type.
            if maparray[y,x] == 1:
                screen.blit(grass1, (x*16, y*16)) 
```

* * *

第一个错误是`for x in range(mapWi,1)`。

看看[`range`](http://docs.python.org/library/functions.html#range)功能。您正在使用两个参数，因此您从`mapWi`to循环`1`，这不是您想要的。

你想从 to 循环`0`，`mapWi`所以你必须使用

```
for x in range(mapWi):
    for y in range(mapHi): 
```

（使用`xrange`会更好，但这只是一个很小的改进）

否则，不会在屏幕上绘制任何内容。

* * *

第二个错误是这一行：

```
if maparray[y,x] == 1: 
```

你会得到一个，`IndexError`因为你混淆了数组的初始化。它实际上又`mapWi` *高*又`mapHi` *宽*。所以，你应该使用它来初始化它

```
groundArray = numpy.ones((mapHi,mapWi)) 
```

代替

```
groundArray = numpy.ones((mapWi,mapHi)) 
```

为了说明这一点，只是一个小测试：

```
>>> numpy.ones((10,5))
array([[ 1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.],
       [ 1.,  1.,  1.,  1.,  1.]])
>>> 
```

你会看到 using给了我们一个and`(10, 5)`的数组。`height = 10``width = 5`

* * *

旁注：

```
for event in pygame.event.get():
    if event.type == "QUIT": 
```

什么都不做。`event.type`从来都不是字符串`"QUIT"`。退出事件的类型是`12`，或者更好`pygame.QUIT`：所以它应该是：

```
for event in pygame.event.get():
    if event.type == pygame.QUIT: 
```

像这样重写你的主循环：

```
while gameRunning:
    drawMapArray(groundArray)
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            gameRunning = False
            break

    #Updates display and then sets FPS to 30 FPS. 
    pygame.display.update()
    fpsClock.tick(30)

pygame.quit() 
```

避免调用`sys.exit`.

更好：将您的主循环分成您通常在主循环中执行的三个步骤。

```
while gameRunning:
    draw()         # do all the drawing stuff in this function
    handle_input() # handle all input stuff in this function
    update()       # update the game state in this function 
```

# android - 需要帮助使用 gson 解析 json 文件

> ID：11874954
> 
> 赞同：5
> 
> 时间：2012-08-09T00:00:09.113
> 
> 标签：android, gson

编辑：我更改了 json 文件的样式以使其更简单，因为我无法使用旧版本。我需要能够在 java 中创建一个目标数组，其中数组中的每个元素的名称都作为 Target_Name 的值。我还需要能够将具有不同对象名称的重复目标名称合并在一起。所以基本上我想要一个目标数组，并且在每个元素中我想要一个包含 Type、Pin_number 和功能的对象数组。

我知道我可能必须创建一个目标列表类，并在该变量中创建目标名称和其他所有内容。我以前尝试过类似的方法，但我无法弄清楚它是如何工作的。

```
 {
"Targets": [
    {
        "Target_Name": "----",
        "Object_Name": "----",
        "Type": "----",
        "Pin_Number": "----",
        "Capabilities": "----"
    },
    {
        "Target_Name": "----",
        "Object_Name": "----",
        "Type": "----",
        "Pin_Number": "----",
        "Capabilities": "----"
    },
    {
        "Target_Name": "----",
        "Object_Name": "----",
        "Type": "----",
        "Pin_Number": "----",
        "Capabilities": "----"
    },
    {
        "Target_Name": "----",
        "Object_Name": "----",
        "Type": "----",
        "Pin_Number": "----",
        "Capabilities": "----"
    }
] 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:09:19.397

这很简单，下面是一些如何加载和读取节点的代码。它将帮助您了解如何查询您的数据。

```
Reader reader = null;
InputStream stream = context.getResources()
    .openRawResource(R.raw.json_file);
reader = new BufferedReader(new InputStreamReader(stream), 8092);

// parse json
JsonParser parser = new JsonParser();
JsonObject jsonObj = (JsonObject)parser.parse(reader); 
```

// 你的 json 解析将如下所示

```
JsonArray targets= jsonObj.getAsJsonArray("Targets");

List<Target> targetList = new ArrayList<Target>(); 
for (JsonElement target: targets) {

    JsonObject targetObject = target.getAsJsonObject();
    String targetName= targetObject.get("Target_Name").getAsString();
    ....//get the rest

    // create target object
    targetList.add(new Target(targetName, ....));
} 
```

// 如何读取值和查询对象的示例

```
for (Entry<String, JsonElement> entry : rootElem.entrySet())
{
    int key = Integer.parseInt(entry.getKey());
    JsonObject jsonObject = entry.getValue().getAsJsonObject();
}

// get integer element
int key = Integer.parseInt(entry.getKey());

// get child object
JsonObject jsonObject = entry.getValue().getAsJsonObject();

// get string element           
String title = jsonObject.get("Object_Name").getAsString(); 
```

# c++ - RegQueryValueEx 的奇怪字符

> ID：11874959
> 
> 赞同：0
> 
> 时间：2012-08-09T00:00:32.003
> 
> 标签：c++, visual-c++, npapi

我正在创建一个 NPAPI dll 文件，我需要从注册表中获取一些信息，但是当我使用 RegQueryValueEx 时，我得到了一些奇怪的字符。

例如，我的电脑型号是“N310”，但我得到的是“Nfb1fb1”或“N$(”。

我很确定这是一个字符集问题，但我是 C++ 新手，需要一些帮助。

我正在使用 Visual Studio 2010，我的项目正在使用 UNICODE 字符集。

这是我的代码：

```
char lszValue[255];
std::string cadena;
HKEY hKey;
LONG returnStatus;
DWORD dwType=REG_SZ;
DWORD dwSize=255;

returnStatus = RegOpenKeyEx(HKEY_LOCAL_MACHINE, L"HARDWARE\\DESCRIPTION\\System\\BIOS", NULL, KEY_READ, &hKey);
if (returnStatus == ERROR_SUCCESS) {
    returnStatus = RegQueryValueEx(hKey, L"SystemProductName", NULL, &dwType,(LPBYTE)&lszValue, &dwSize);
    lszValue[dwSize] = 0;
    cadena.assign(lszValue, dwSize);

    return cadena;
} 
```

非常感谢，感谢您的提前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T00:09:53.650

如果您的项目使用 UNICODE 字符集，那么可能所有 WINAPI 函数都绑定到 unicode 字符串，也就是说，`RegQueryValueEx`实际上`RegQueryValueExW`是使用`wchar_t`数组，而不是`char`数组。

当使用非 Unicode 单字节项目时，该函数将是`RegQueryValueExA`并且它可以与`char[]`.

要使您的项目（非）Unicode 安全，请使用`TCHAR`宏而不是`char`. 试试这个代码：

```
DWORD const dwSize=255;
TCHAR lszValue[dwSize];
std::wstring cadena;

HKEY hKey;
LONG returnStatus;
DWORD dwType=REG_SZ;
returnStatus = RegOpenKeyEx(HKEY_LOCAL_MACHINE, L"HARDWARE\\DESCRIPTION\\System\\BIOS", NULL, KEY_READ, &hKey);
if (returnStatus == ERROR_SUCCESS)
{
    returnStatus = RegQueryValueEx(hKey, L"SystemProductName", NULL, &dwType, (LPBYTE)&lszValue, &dwSize);
    lszValue[dwSize] = 0;
    cadena.assign(lszValue, dwSize);

    return cadena;
} 
```

我只改变了类型。可能还有其他错误/错别字。请记住 std::wstring 用于 wchar_t

# javascript - Javascript 书签适用于 Chrome/Safari 但不适用于 Firefox/IE

> ID：11874964
> 
> 赞同：0
> 
> 时间：2012-08-09T00:01:11.717
> 
> 标签：javascript, internet-explorer, firefox, bookmarklet

我有一个在 Chrome (v21) 和 Safari (v6) 中运行良好的 JavaScript 小书签，但是当我尝试在 Firefox (v14) 或 IE (v9) 中使用它时，我得到一个页面，上面写着：

> [对象 HTMLScriptElement]

小书签是这样的（最后的所有 PHP 语句都插入了 API 密钥）：

```
javascript: (function(src, cb) {
var s = document.createElement('script');
s.charset = 'UTF-8';
document.body.insertBefore(s, document.body.firstChild);
s.src = src;
if (typeof cb === 'function') {
    s.onload = cb;
    s.onreadystatechange = function() {
        (/loaded|complete/).test(s.readyState) && cb(s);
    };
}
return s;
}('http://towatchlist.com/marks/bookmarklet2response?uid=<?php echo $userID; ?>'))​ 
```

我认为它甚至根本没有加载书签。在 Firefox 中，URL 栏变为上面的代码；在 IE 中，它甚至不会从它所在的任何页面改变。

[我确实尝试按照其他地方的建议](https://stackoverflow.com/a/2222499/1304462)将小书签包装在自执行函数表达式中，但这只会导致 `Uncaught SyntaxError: Unexpected token (`Chrome 控制台（仅此而已）。这是我包装它的方式：

```
javascript: (function() {
function(src, cb) {
    var s = document.createElement('script');
    s.charset = 'UTF-8';
    document.body.insertBefore(s, document.body.firstChild);
    s.src = src;
    if (typeof cb === 'function') {
        s.onload = cb;
        s.onreadystatechange = function() {
            (/loaded|complete/).test(s.readyState) && cb(s);
        };
    }
    return s;
}('http://towatchlist.com/marks/bookmarklet2response?uid=<?php echo $userID; ?>')
}());​ 
```

也许我没有把它包装好？无论如何，为了使 IE/Firefox 实际执行书签，我需要更改什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-09T00:24:37.913

小书签不得返回任何内容。只需删除`return s;`线，你应该很好。

更一般地，您可以将整个内容（或更准确地说是最后一条语句）包装在`void()`函数调用中，以确保没有返回值。

# java - SQL Java - 使用游标返回 10 行的简单查询

> ID：11874970
> 
> 赞同：0
> 
> 时间：2012-08-09T00:01:40.957
> 
> 标签：java, sql, database, sqlite

我有一个包含 70 条记录的 SQLite 数据库，并且想使用游标获取其中的 10 条记录。

我有`KEY_ROWID`（主键）的10 条记录`2, 3, 15, 23, 35, 50, 51, 60, 61, 64`

检索这些记录的 SQL 是什么？

这是我到目前为止所拥有的，但我认为这不会奏效......

我应该使用`WHERE`or`HAVING`子句吗？

任何帮助都会很棒。

```
public Cursor getTopTen() {

    String ids = "2, 3, 15, 23, 35, 50, 51, 60, 61, 64";

    SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();
    queryBuilder.setTables(DATABASE_TABLE);

    String[] columns = new String[] { KEY_ROWID, RECIPE, DESC, PREPTIME,
            COOKTIME, SERVES, CALORIES, FAT, CATEGORY, FAV };

    Cursor myCursor = queryBuilder.query(myDataBase, columns, KEY_ROWID + "="
            + "'" + ids + "'", null, null, null, null);

    return myCursor;
} 
```

在 SQL 中，上面的 java 是：

```
SELECT * FROM myDataBase WHERE KEYROWID = "2, 3, 15, 23, 35, 50, 51, 60, 61, 64". 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:20:17.650

SQL 应该是：

```
SELECT * FROM myDataBase WHERE KEYROWID IN (2, 3, 15, 23, 35, 50, 51, 60, 61, 64) 
```

当您想要获取列值位于特定值列表中的所有行时，您必须使用[IN 运算符](http://www.w3schools.com/sql/sql_in.asp)。

所以你的代码应该是：

```
public Cursor getTopTen() {

    String ids = "2, 3, 15, 23, 35, 50, 51, 60, 61, 64";

    SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();
    queryBuilder.setTables(DATABASE_TABLE);

    String[] columns = new String[] { KEY_ROWID, RECIPE, DESC, PREPTIME,
            COOKTIME, SERVES, CALORIES, FAT, CATEGORY, FAV };

    Cursor myCursor = queryBuilder.query(myDataBase, columns, KEY_ROWID + " IN ("
            + ids + ")", null, null, null, null);

    return myCursor;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-09T00:05:17.920

在您的情况下，您应该使用 WHERE 子句而不是 HAVING 子句。

# node.js - 如何使用最新的 Express.js 进行应用路由？

> ID：11874972
> 
> 赞同：1
> 
> 时间：2012-08-09T00:02:03.267
> 
> 标签：node.js, express

标题可能不清楚..但是..之前，我可以这样做：

```
/* file 1*/
app = express.createServer();

/* main file*/
server = express.createServer();

// route
server.get('/whatever', function(req, res) { res.send('whatever'); });
server.use('/test/*', app); 
```

但是对于最新的 Express.js，我不能。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-09T17:40:37.520

3.x 版本发生了很大变化。express 网站上的基本示例现在显示以下代码：

```
var express = require('express');
var app = express();

app.get('/', function(req, res){
  res.send('hello world');
});

app.listen(3000); 
```

[http://expressjs.com/api.html](http://expressjs.com/api.html)

# c - C中的常量正确性

> ID：11874982
> 
> 赞同：11
> 
> 时间：2012-08-09T00:03:45.490
> 
> 标签：c, constants, const-correctness, mutability

`const`显然，除非某些东西是可变的，否则使用它是一个好习惯，但你能走多远？如果我有一个字符串数组，我的函数签名应该包括这个吗？

```
char const * const * const my_strings 
```

我不会对其进行*任何*修改，因此它是指向常量数组的第一个元素的常量指针，指向常量字符数组的第一个元素。这很拗口，而且代码几乎不可读。这一切都是一个简单的数据结构，如`argv`.

我觉得好像 const 应该是默认的，应该有一个 mutable 关键字。

**您通常只是其中之一`const`吗？**那么，如果您仍然可以通过或多或少地取消引用来轻松更改它，那又有什么意义呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-09T00:17:25.483

我通常会使用三个`const`s 中的两个：

```
const char *const *my_strings; 
```

有时我会使用所有三个，但在我看来，最后一个是最不重要的。它仅有助于分析使用变量 的代码`my_strings`，而其他两个有助于分析具有指向 指向的数组`my_strings`或指向该数组元素的字符串的任何指针的代码。这通常是更多的代码，在几个不同的地方（例如函数的调用者和函数本身），因此是一项更难的任务。

使用变量本身的代码仅限于 的范围`my_strings`，因此，如果这是一个自动变量（包括函数参数），那么它是包含良好且更容易的任务。通过标记它提供的帮助`const`可能仍然值得赞赏，但它不太重要。

我还要说，如果`char const * const * const my_strings`它“几乎不可读”，那么当你有更多的阅读 C 的练习时，情况就会改变，并且最好得到这种练习而不是更改代码。编写新手可以轻松阅读的 C 代码有一些价值，但没有完成一些工作的价值 ;-)

您可以使用 typedefs 来缩短变量定义，但代价是引入了会惹恼许多 C 程序员的间接：

```
typedef char const *ro_strptr;
ro_strptr const *my_strings; 
```

无论出于何种原因，C 程序员通常希望在一个地方尽可能多地看到一种类型。只有当类型变得真正复杂（指向函数的类型）时，您才能仅使用 typedef 来缩写，而不必半信半疑地有人会抱怨它。

# objective-c - 如何使用 Objective-C 从大型文本文件中读取特定行？

> ID：11874984
> 
> 赞同：4
> 
> 时间：2012-08-09T00:03:46.817
> 
> 标签：objective-c, ios, cocoa-touch

假设我有这样的文本文件 my.txt

```
this is line 1
this is line 2
....
this is line 999999
this is line 1000000 
```

在 Unix 中，我可以通过发出“head -1000 my.txt | tail -1”之类的命令来获得“这是第 1000 行”的行。在 Objective-C 中得到这个的相应方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-09T00:23:34.207

如果一次将整个内容存储在内存中并不是太低效，那么最紧凑的调用序列（为了更简单的说明，我已经扩展为多行）将是：

```
NSError *error = nil;
NSString *sourceString = [NSString stringWithContentsOfFile:@"..."
                                    encoding:NSUTF8StringEncoding error:&error];
NSArray *lines = [sourceString componentsSeparatedByCharactersInSet:
                                     [NSCharacterSet newlineCharacterSet]];

NSString *relevantLine = [lines objectAtIndex:1000]; 
```

您应该检查 of`error`和`count`of的值以`lines`进行验证。

编辑：与 Nathan 的回答相比，按集合中的字符拆分的好处是，您将接受可能分隔换行符的五个 unicode 字符中的任何一个，其中几个字符彼此相邻的任何地方都算作仅一次休息（根据例如`\r\n`）。

`NSInputStream`如果内存占用是一个问题，这可能是您必须处理的问题，它几乎不比 C 的 stdio.h fopen/fread/etc 进化，所以您将不得不编写自己的小循环来冲刺.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-07T19:48:26.763

答案没有解释如何读取太大而无法保存在内存中的**文件**。在 Objective-C 中没有很好的解决方案来读取大型文本文件而不将它们放入内存（这并不总是一种选择）。

在这些情况下，我喜欢使用 c 方法：

```
FILE* file = fopen("path to my file", "r");

size_t length;
char *cLine = fgetln(file,&length);

while (length>0) {
    char str[length+1];
    strncpy(str, cLine, length);
    str[length] = '\0';

    NSString *line = [NSString stringWithFormat:@"%s",str];        
    % Do what you want here.

    cLine = fgetln(file,&length);
} 
```

请注意， fgetln 不会保留您的换行符。此外，我们将 str 的长度 +1，因为我们想为 NULL 终止腾出空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-09T00:37:22.097

我不认为这是完全重复的，因为听起来您想跳过文件中的某些行，但是您可以轻松使用此处的方法：

[Objective-C：逐行读取文件](https://stackoverflow.com/questions/1044334/objective-c-reading-a-file-line-by-line) （有一些示例代码的[具体答案）](https://stackoverflow.com/a/1045440/1580216)

循环输入文件，读入一大块数据，然后寻找换行符。数一数，当你打到正确的数字时，输出那个之后的数据，直到下一个。

您的示例看起来可能有数十万行，因此绝对不要只将文件读入 NSString，也绝对不要将其转换为 NSArray。

如果您想使用更高级的 NSInputStream 方式（在字符集解码方面具有一些关键优势），这里有一个很好的示例，它展示了轮询以使用来自流源的所有数据的基本思想（在文件示例中，它有点矫枉过正）。它用于输出，但这个想法也适用于输入： [轮询与运行循环调度](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Streams/Articles/PollingVersusRunloop.html#//apple_ref/doc/uid/20002275-CJBEDDBG)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-09T00:22:40.567

最简单的方法是使用 NSString 文件方法之一加载文件，然后使用 -[NSString componentsSeparatedByString:] 方法获取每一行的数组。

或者您可以使用 NSScanner，扫描换行符/回车符，对它们进行计数，直到找到您感兴趣的行。

如果您真的担心内存使用情况，您可以查看 NSInputStream 使用它来读取文件，并计算换行符的数量。很遗憾 NSScanner 不能与 NSInputStream 一起使用。

# string - Visual Basic 字符串工具

> ID：11874990
> 
> 赞同：2
> 
> 时间：2012-08-09T00:04:26.463
> 
> 标签：string, vba

将逗号 ("") 插入字符串 Visual Basic

```
Dim str As String

str = "*.doc" & "," & "*.docx" 
```

我想要文本框显示`"*.doc" & "," & "*.docx"`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-09T09:46:01.783

写出你想要的字符串：

```
str = "*.doc" & "," & "*.docx" 
```

加倍引号以逃避它们：

```
str = ""*.doc"" & "","" & ""*.docx"" 
```

然后引用整个字符串：

```
str = """*.doc"" & "","" & ""*.docx"""

?str
"*.doc" & "," & "*.docx" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-09T08:17:42.033

根本不清楚你要什么。如果你这样做，结果字符串将是`*.doc,*.docx`. 如果你想要引号（引号），你会做这样的事情：

```
str = Chr$(34) & "*.doc" & Chr$(34) & "," & Chr$(34) & "*.docx" & Chr$(34) 
```

那会产生类似的东西

```
"*.doc","*.docx" 
```

这是你想要的？如果没有，请告诉我们您要完成的工作，我们可以为您提供帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-22T02:16:48.700

这对我有用，试试吧。

```
Dim str As String = """ * .doc"" & "","" & ""*.docx """
TextBox1.Text = str 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-09T09:52:55.697

我用一个消息框对此进行了测试，它对我来说效果很好。

```
Dim str As String = "*.doc" & "," & "*.docx"
textbox1.text = str 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-23T22:36:12.157

**VB6代码：**

```
Dim str As String
str = "*.doc" & "," & "*.docx"
Text1.Text = str 
```

**VB.net 代码：**

```
Dim str As String
str = "*.doc" & "," & "*.docx"
TextBox1.Text = str 
```

这两个都有效。

# mysql - 为什么即使 SQL 语句产生语法错误，此 SQL 注入也会成功？

> ID：11874991
> 
> 赞同：3
> 
> 时间：2012-08-09T00:04:30.040
> 
> 标签：mysql, sql-injection

在[这个问题](https://stackoverflow.com/q/11873585/869912)和一些评论中，这个输入：

`$input = '; DELETE FROM table_name ; #';`

建议作为 SQL 注入到此 PHP 语句的示例：

```
$input = $_POST['input'];
'SELECT '.$input.' FROM table_name' 
```

我切入正题，直接在 MySQL 中使用了一个示例，尽管我使用 * 代替了 #。结果是一样的。

```
CREATE TABLE a_table (
 id INT NOT NULL);

INSERT INTO a_table (id) VALUES (1), (2), (3), (4), (5);
SELECT * FROM a_table;
SELECT ; DELETE FROM a_table; * FROM a_table;
SELECT COUNT(*) FROM a_table; 
```

这输出：

```
mysql> SELECT * FROM a_table;
+----+
| id |
+----+
|  1 |
|  2 |
|  3 |
|  4 |
|  5 |
+----+
5 rows in set (0.00 sec)

mysql> SELECT ; DELETE FROM a_table; * FROM a_table;
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1
Query OK, 5 rows affected (0.03 sec)

mysql> SELECT * FROM a_table;
Empty set (0.00 sec) 
```

尽管语法错误，为什么此 SQL 注入会成功？这是因为 MySQL`DELETE`在周围`SELECT`查询之前解析并运行查询吗？当然，我不打算依靠如此弱的 PHP 代码或 MySQL 语法错误来防范 SQL 注入；这个例子让我很感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-09T00:11:45.890

查询仍在运行，因为 mysql 用于`;`分隔每个查询，并且如果您允许它这样做，即使存在语法错误，它也会继续运行查询。在 SequelPro 中运行查询我收到一条关于语法错误的消息，它会提示我是否要继续运行所有查询或停止。但是，直接在 MySQL 命令行中运行它们，查询会继续运行，MySQL 只会给出一条错误消息并按预期继续下一个查询（与 PHP 代码发生的情况相同）。

# android - Android在java中改变密度DPI

> ID：11874997
> 
> 赞同：0
> 
> 时间：2012-08-09T00:05:44.840
> 
> 标签：android, keyboard, viewport, dpi

有人知道如何在java中更改android应用程序的密度Dpi吗？

我正在开发一个 android 应用程序，我在其中操纵视点标记中的目标密度。这在应用程序的某些地方引起了一个小问题，目标密度似乎被软键盘重置。

所以我需要一种方法来重置它，或者防止键盘改变密度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T16:10:56.923

对于 lenovo A1（240dpi 密度的平板电脑）或 Galaxy Note 等设备，您可能需要在您的应用程序中执行此操作，以避免在不同设备上看起来像它的大小不同。

将以下函数添加到您的扩展应用程序类并从 onCreate 调用它：

```
public void changeDensity(float desiredDensity) {
    //desiredDensity : ldpi = 0.75 (120dpi) , mdpi = 1 (160dpi), hdpi = 1.5 (240dpi), xhdpi = 2.0 (320dpi)
    DisplayMetrics metrics = getResources().getDisplayMetrics();

    metrics.density = desiredDensity;
    metrics.xdpi = desiredDensity * 160;
    metrics.ydpi = desiredDensity * 160;
    metrics.densityDpi = (int) (desiredDensity * 160);

    getResources().updateConfiguration(null, null);
} 
```