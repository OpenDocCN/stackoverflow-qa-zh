# StackOverflow 问答 000258000-000258999

# actionscript-3 - 在包中使用 internal 会出错

> ID：258004
> 
> 赞同：1
> 
> 时间：2008-11-03T05:43:11.700
> 
> 标签：actionscript-3, packages, visibility

我正在尝试将一个类放入放置另一个公共类的包中。文档说只能将一个外部可见声明放入包中。

所以我声明第二类内部。但随后它给出了以下错误：

> 5006：一个 ActionScript 文件不能有多个外部可见定义：character.AnimatedCharacterClass、character.CharacterPositions

我使用的代码是：

```
internal class CharacterPositions
{
    public static const BEGIN_WALK:String = 'begin_walk';
    public static const END_WALK:String = 'end_walk';
    public static const STAND:String = 'stand';     
} 
```

有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-03T14:23:34.553

我发现我必须把第二类放在包外。尽管如此，它仍然让我感到困惑。

# class - 类：公共变量或公共函数来更改本地变量？

> ID：258005
> 
> 赞同：1
> 
> 时间：2008-11-03T05:45:35.440
> 
> 标签：class, function, variables, private, public

正是主题标题所说的，

在哪些情况下，您更喜欢使用公共函数来更改局部变量，而不是仅仅将该变量定义为公共并直接修改它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T05:55:29.787

**不要直接暴露数据成员**：使用不透明的访问器意味着您可以在以后更改实现而不更改接口。

* * *

我应该知道。我不时走捷径，并有机会后悔。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T05:55:22.813

显然，如果您想更改变量以对对象的状态产生其他影响（例如重新计算对象的某些其他属性），则必须使用 mutator 函数。

如果可以将变量设置为使对象处于无效状态的内容，则您可能还应该使用 mutator 函数。这样，如果即将发生非法事件，您可以抛出异常（或返回错误，或只是忽略）。这为调试创造了奇迹。

但是，如果某些变量可以用 mutator 函数修改，而其他变量是公共的，则程序员需要跟踪哪个是哪个。这是浪费时间和精力，因此在某些情况下，最简单的方法是对所有事情都使用 mutator 函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T12:59:24.707

您应该提及您正在处理的语言，因为这会影响答案。

你的第一个想法应该是关于你的类的 API。如果您想保持该 API 稳定（而且您应该这样做！），那么请考虑一下您以后如何将今天的简单变量更改为成熟的方法。

在许多语言中，您无法在不更改调用代码的情况下将变量更改为方法。C、C++ 和 Java 属于这一类。永远不要在这些语言中使用公共变量，因为以后您将没有任何回旋余地。

在 Python 中，您可以在不更改调用者的情况下将变量更改为属性，因此您不必事先担心：使用公共变量。

我相信 C# 具有可以让您透明地将变量更改为方法的属性，但我不确定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T06:57:36.947

如果你纯粹从以下方面来看一个对象**如果您纯粹从服务**，您会意识到公开变量并不是公开这些服务的好方法。

API 必须反映对象的全部内容（以实现高内聚性），如果您定义一个 setValue(...)，那么它并不是因为您需要一种方法来——今天——改变一个变量，但因为对象公开此服务是有意义的。

所以：

1.  不要为您编写的每个类的每个成员提供访问器或修改器功能。仅当访问器/修改器方法是类接口 (API) 的合理且有用的部分时才提供访问器/修改器函数。

2.  不要将这些方法视为访问器或修改器。相反，将它们视为访问或改变对象的某个抽象属性的方法，该属性恰好由*今天*的单个成员表示，但明天可能会以更复杂的方式计算。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T05:51:43.273

如果你想改变一个类中的一个变量，你最好通过属性来做。

在外部修改变量并不是一个好习惯。

也考虑未来的发展。您可以在属性后面放置一些逻辑，而无需更改整个程序。

# iphone - 尝试通过 iPhone 模拟器播放声音

> ID：258006
> 
> 赞同：2
> 
> 时间：2008-11-03T05:45:44.160
> 
> 标签：iphone, cocoa-touch, ios-simulator

我正在尝试从 iPhone 程序播放声音文件。

这是代码：

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"play" ofType:@"caf"];
NSFileHandle *bodyf = [NSFileHandle fileHandleForReadingAtPath:path];
NSData *body = [bodyf availableData];
NSLog( @"length of play.caf %d",[body length] );
NSURL *url = [NSURL fileURLWithPath:path isDirectory:NO];
NSLog( [url description] );
NSLog( @"%d", AudioServicesCreateSystemSoundID((CFURLRef)url, &soundID) ); 
```

第一个 NSLog 是检查我是否可以访问该文件（我做了），第二个 NSLog 是显示文件 URL，第三个 NSLog 返回 -1500 “发生了未指定的错误”。

对于第二个 NSLog，我得到以下输出：

file://localhost/Users/alan/Library/Application 敲慬楴敶瑓楲杮upport/iPhone蒠ꁻĀ⾅獕牥⽳污湡䰯扩慲祲䄯灰楬楴汤大师灵溃玱椯桐汤⁥畭潴⽲獕牥䄯灰楬惯楴汤⽳㕅㡂㤱䌭䐳ⴸ䐴䙃㠭ⴷ䍁㈶㠵䙁㤴㈈䙁㤴㈯瑡䵥⹥灬慍捯牥䄯楬楬楴汤⽳㕅㡂䌭䐳ⴸ䐴䙃㠭ツⴷ䍁㈶㠵䙁㤴㈯瑡䵥⹥獬慍扯瑡䵥⹥灬1-C3D祡挮䰯慍潮/C3D挮殙4DCF-8C37-AC6258AF4902/LocateMe.app/play.caf

这要么是由于我对“描述”方法的误解，要么是导致问题的原因。

知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T19:18:19.463

NSLog 的第一个参数是格式字符串；您将`[URL description]`作为格式字符串传递给 NSLog 的第二次使用。这很糟糕，因为如果 URL 的描述包含任何`%`字符，那么它将最终打印堆栈中的随机内容。

相反，写

```
NSLog(@"%@", URL); 
```

你甚至不需要在`-description`这里使用；NSLog 会自动为你调用它，因为它的`%@`意思是“一个对象”而不是“一个 NSString”，它足够聪明，可以为你做正确的事情。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-01T00:06:04.857

此外，iPhone 模拟器似乎不喜欢播放 (systemSound) 长度超过 5 秒的声音。我遇到了与应用程序几乎总是播放启动系统声音相同的问题。

我在模拟器上工作的应用程序之一不会播放声音，但设备会。后来我发现模拟器和它处理声音的方式有一些奇怪的限制。我已经向 Apple 提交了一个错误。希望这将在 iPhone SDK 3.0 的发布中得到解决。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-21T01:36:36.880

对此的更新。

我得到了允许我在设备上运行我的应用程序的密钥。

当应用程序在设备上运行时，我发现我的 .caf 文件成功播放。

然后我尝试了各种替代方案。

一个 60 秒长的 .wav 文件无法在模拟器和设备上运行。

5 秒长的 .wav 文件可以在模拟器上运行，但不能在设备上运行。

一个 5 秒长的 .aiff 文件可以在模拟器和设备上运行。

最好确切地知道模拟器和设备在将文件传递给 AudioServicesCreateSystemSoundID 时正在检查什么

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T06:53:51.700

我对播放声音的应用程序进行了同样的尝试。声音不会在模拟器中播放，当我尝试访问`NSLog`URL 时，我会得到与你相同的垃圾，并且`EXC_BAD_ACCESS`在它的顶部。当我在设备上记录 URL 时，URL 很好，但我`EXC_BAD_ACCESS`还是得到了。当我放弃日志记录时，声音播放并且一切正常。如果有人可以解释这种行为，我将不胜感激。至于您的问题，我会放弃日志记录并在设备上尝试代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-10-30T05:19:16.413

使用“AVAudioPlayer”类播放 .caf 文件

# visual-c++ - 在 VC++ 6.0 中设置命令按钮的可见性？

> ID：258007
> 
> 赞同：0
> 
> 时间：2008-11-03T05:49:59.767
> 
> 标签：visual-c++, mfc, visual-c++-6

如何使 VC++ 6.0 对话框中的命令按钮在加载时可见或不可见？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T09:31:08.200

从资源编辑器中选择按钮后，您可以在属性窗口中查看其属性。在这里您可以将可见属性设置为真/假。（假设此功能存在于 6.0 中 - 我现在使用 2003 并且不记得它是否曾经存在于 6.0 中）

**添加 CButton 变量**

如果您想在加载期间动态更改按钮的可见性，请使用 MFC 类向导为您的按钮添加一个变量。（你很幸运拥有这个 - 这个向导似乎已从 Visual Studio .NET 中删除）

**覆盖 CDialog InitDialog**

接下来覆盖对话框的 initdialog 函数，然后在成功调用基本 InitDialog 函数后，在显示对话框之前将按钮的 showwindow 属性设置为 SW_HIDE /。

**代码**

```
BOOL CMyDialog::OnInitDialog() 
   {
   CDialog::OnInitDialog();

   if (ConditionShow)
       m_MyButton.ShowWindow(SW_SHOW);
   else
       m_MyButton.ShowWindow(SW_HIDE);

   return TRUE;
   } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T15:00:01.140

您也可以在不添加 CButton 变量的情况下执行此操作 - 只需调用

在包含按钮/控件的窗口的 OnInitDialog 方法中，输入代码：

CWnd *wnd = GetDlgItem (YOUR_RESOURCE_NAME_OF_THE_BUTTON) wnd->ShowWindow(SW_SHOW) 或 SW_HIDE

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T06:28:07.257

'commnad button' 到底是什么意思？

无论如何，您需要获取按钮的句柄然后调用 ShowWindow 函数：

```
BOOL prevState = ShowWindow( itemHandle, SW_HIDE ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-05T04:09:12.293

只使用

```
ShowDlgItem(Your_DLG_ITEM_ID,1); // visible = true   
ShowDlgItem(Your_DLG_ITEM_ID,0); // visible = false 
```

# asp.net-mvc - 看起来您忘记使用 IIS7 向 Windsor Castle 注册 http 模块

> ID：258011
> 
> 赞同：27
> 
> 时间：2008-11-03T05:53:13.613
> 
> 标签：asp.net-mvc, iis-7, castle-windsor

我在我的一个 MVC 项目中使用了 Windsor DI 框架。当我尝试从 Visual Studio 2008 运行时，该项目运行良好。

但是当我尝试运行在 IIS7 中创建应用程序的项目时，我收到以下错误消息：

> 看起来您忘记注册 http 模块 Castle.MicroKernel.Lifestyle.PerWebRequestLifestyleModule 添加 '<add name="PerRequestLifestyle" type="Castle.MicroKernel.Lifestyle.PerWebRequestLifestyleModule, Castle.MicroKernel" />' 到您网站上的部分。配置

但是这个模块已经存在于 web.config 文件的 httpmodule 部分。

有谁知道我必须做些什么来消除这个问题。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2011-02-11T11:12:08.723

我有同样的错误，但它是由另一个原因引起的：

我试图解决自定义路由类处理，但类型 for已注册`IService`为. 路由子系统停留在 Web 请求的更高级别，并且对象在路由处理时不存在。`Application_Start``IService``PerWebRequestLifestyle`

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2008-11-03T07:30:24.870

尝试将其添加到该`system.webServer`部分吗？

```
<configuration>
    <system.web>
        <httpModules>
            <add name="PerRequestLifestyle" type="..." />
        </httpModules>
    </system.web>
    <system.webServer>
        <modules>
            <add name="PerRequestLifestyle" type="..." />
        </modules>
    </system.webServer>
</configuration> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-11-14T20:59:55.683

它帮助了我：

```
<system.web>
  <httpModules>
      <add name="PerRequestLifestyle" type="Castle.MicroKernel.Lifestyle.PerWebRequestLifestyleModule, Castle.Windsor" />
  </httpModules>
</system.web> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2011-10-05T18:38:09.853

我在开发环境中遇到过这个问题。值得注意的是这个标签：

```
 <validation validateIntegratedModeConfiguration="false"/> 
```

虽然它显然做到了它在锡上所说的那样，但它可以阻止那些讨厌的错误出现。假设您的其余配置工作正常。

什么对我有用：

```
<system.webServer>
  <validation validateIntegratedModeConfiguration="false"/>
  <modules runAllManagedModulesForAllRequests="true">
    <remove name="PerRequestLifestyle"/>
    <add name="PerRequestLifestyle" type="Castle.MicroKernel.Lifestyle.PerWebRequestLifestyleModule, Castle.Windsor"/>
  </modules>
</system.webServer> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-25T00:05:20.477

我写了一篇博客文章，通过反编译 Castle.Windsor.dll 在代码级别解释了这个问题。

[修复和解释：忘记注册 http 模块 Castle.MicroKernel.Lifestyle.PerWebRequestLifestyleModule](https://sitecorelogy.com/2016/05/25/fixed-sitecore-forgot-to-register-the-http-module-castle-microkernel-lifestyle-perwebrequestlifestylemodule/)

# c++ - “函数式”？

> ID：258020
> 
> 赞同：4
> 
> 时间：2008-11-03T06:03:18.993
> 
> 标签：c++, boost

我在[这里](https://isocpp.org/wiki/faq/pointers-to-members#functionoids)阅读了“functionoids”的描述。它们看起来像是 Boost::function 和 Boost::bind 的穷人版本。我错过了什么吗？如果您已经在使用 Boost，是否有充分的理由使用它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T10:25:24.487

我投票给 tr1::function。

*函子*或*函*子代表`tr1/boost::function`进化的基础。公共接口函子的限制是它们打破了 OO 范式，因为它们代表不同的类型并且只能传递给模板函数（除非您提供它们派生自的基类）。

事实上，通过*[类型擦除技术](http://www.artima.com/cppsource/type_erasure2.html)* `tr1::function`克服了这个限制：它们最好用于实现动态*策略类*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T06:50:36.057

不。

或者在此处查看 FQA 答案[。](http://yosefk.com/c++fqa/function.html#fqa-33.10)

# java - 创建透明面板

> ID：258023
> 
> 赞同：5
> 
> 时间：2008-11-03T06:08:53.990
> 
> 标签：java, panel, transparent

我需要创建一个不可见的面板，但其中的组件（例如，JTextArea、JButton 等）应该是可见的。当我点击不可见的面板时，它应该变得可见。

我只能使用 JRE 1.4，仅此而已。:(

知道如何创建这样一个透明面板吗？？？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T06:48:18.853

透明度受控于

```
setOpaque(false) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T06:46:55.393

`JComponent.setOpaque(false)`是要走的路。

# asp.net - 当子 ASCX 控件需要触发更改时，更新 ASPX 页面的最佳方法是什么？

> ID：258024
> 
> 赞同：1
> 
> 时间：2008-11-03T06:09:30.977
> 
> 标签：asp.net, user-controls, ascx

当我有一个需要影响父页面中某些内容的子 .ASCX 控件时，我不完全确定在需要更新父页面中的某些内容的情况下我应该如何处理事件流。

我最终所做的就是将逻辑放入“Pre_Render”事件处理程序中。

由于这是在处理任何子 .ascx 控件之后处理的，因此我可以确保在 ASPX 页面显示之前正确呈现它。我只是不认为这是一个好的设计，当我不得不这样做时，我总是畏缩不前。但是现在有stackoverflow，所以我终于可以问了！

例如，假设我在页面中有一个“登录控件”ascx 控件。包含页面在标题栏中显示“当前登录用户”的文本标签。

假设我单击“登录”按钮，然后将触发我的身份验证并登录我的用户。问题是父页面中的文本标签已经呈现为“没有用户登录”。那不好！

通过将逻辑放入“PreRender”，它将在用户登录后呈现。我只是不喜欢这样，因为这不是 PreRender 的用途。

我在这里缺少的预期最佳实践是什么？我知道我可以在用户控件上放置一个事件处理程序，但这似乎也很笨拙，因为耦合太多。

PS。我只是以此为例。我已经多次遇到这个问题，所以请不要回复告诉我如何实现登录！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T06:49:06.340

在您的 ascx.cs 中：

```
public delegate void NavigateEventHandler(int PID); // if you want a custom handler
public event NavigateEventHandler onNavigate; 
```

在您的 page.aspx.cs 中：

```
protected void Page_Init(object sender, EventArgs e) {
    eSelector1.onNavigate += new PostSelector.NavigateEventHandler(eSelector1_Navigate); }
public void eSelector1_Navigate(int PID) {
    eSelector1.PopulateComments(eSelector1.m_PID); } 
```

# javascript - 脚本调试不起作用（VS 2008）

> ID：258028
> 
> 赞同：6
> 
> 时间：2008-11-03T06:22:12.090
> 
> 标签：javascript, visual-studio-2008, debugging, jit

我最近在安装 VS 2008 并覆盖 JIT 设置后安装了 VS 6.0.. 当我启动 VS 2008 选项对话框时.. 它说另一个调试器已经接管了 VS 2008 调试器，我让我重置.. 所以我做了..

现在一切正常，除了 javascript 调试。我无法调试 javascript .. 我可以设置断点 .. 但在调试模式下，当我悬停断点时，它会显示“断点当前不会被命中。文档未加载”..

我该如何解决这个问题？我可以重置 JIT 设置吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T06:36:35.040

听起来您的脚本调试已禁用。要启用它，请转到工具 Internet 选项、高级并确保未选中禁用脚本调试。

我还发现有帮助的是，如果你放一个

> “调试器；”

行在你的 javascript 中。请记住，如果您将调试器语句放在函数的第一行，它将不会附加调试器，据我所知，这是 javascript 调试器引擎实现的一个已知错误。

```
var myFunction = new function()
{
  debugger;
  alert('This will not properly attach the debugger');
} 
```

一种解决方法是：

```
var myFunctionThatDoesAttachTheDebugger = new function()
{
    var x = 0;
    debugger;
    alert('this should work and attach the debugger');
} 
```

我还发现了一个非常有用的方法，就是打开要调试的网站，然后在 url 栏中输入以下内容：

```
javascript:debugger; 
```

这也将启动调试器并让您有机会附加调试器。

希望能帮助到你

蕾哈梅杰

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T12:25:50.577

我想我必须重新安装 Visual Studio 2008 看看是否能解决这个问题

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-12-19T00:41:59.477

您是否尝试过使用 FireBug 进行 JS 调试？它可以很好地替代 VS。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-09-09T08:24:01.953

我只是想插话并补充说，对我来说唯一的解决方案是重新安装。幸运的是，只需重新应用 VS 2008 SP1 就可以了。我在 VS6 中禁用了 JIT 调试，并在 VS2008 中选择了所有推荐的设置。我的建议是省去你的麻烦，在安装 SP 时去呼吸新鲜空气。下次重启时你会像新的一样好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-08-18T14:04:22.443

确保在 Internet Explorer -> 工具 -> Internet 选项 -> 高级选项卡中未选中“禁用脚本调试”复选框。

这是在 MS 所谓的安全补丁更新/恢复到原始设置解决方案之后选中的经典禁用脚本调试复选框。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-06-23T04:55:27.610

`ASP.NET Bundles`如果您正在使用类似的东西

```
BundleTable.EnableOptimizations = true; 
```

或调试模式设置为 false 该`debugger;`命令将从您的代码中删除。好消息:-)

# c# - GraphicsUnit.Point，不能很好地转换为 PDF... GraphicsUnit.World 是，但我怎样才能将它转换为 Point？

> ID：258035
> 
> 赞同：1
> 
> 时间：2008-11-03T06:35:52.157
> 
> 标签：c#, .net, pdf, gdi+

我在 .Net 中有一些代码可以使用 GDI+ 绘制一些文本内容。我使用 GraphicsUnit.Point 来调整文本大小。它在屏幕上运行得非常好，即使打印它也是如此。

我被要求制作一个生成 PDF 的系统，并且我得到了 ComponentOne 的 PDF 控件。它具有与 GDI+ 类似的界面。

问题是：字体大小不起作用。如果我使用 GraphicsUnit.Point，文本会小得多，并且文本下方会出现空白。当我使用 GraphicsUnit.World 时，文本仍然很小，但文本下方没有多余的空白空间。

我想了解如何将 GraphicsUnit.World 转换为 GraphicsUnit.Point。

所有帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-07T21:23:13.613

经过一些谷歌搜索以及我从 GDI+ 和字符串绘图的个人经验中了解到的情况，它归结为 DPI（每英寸点数）。基本上不同的设备（就 GDI+ 而言，PDF 可能是一个设备）具有不同的 DPI 值。显示器通常有类似 70 DPI 的东西。打印机使用 72。我不知道 PDF 使用什么，但它可能是 100（因为这是设备独立性的常见值，可以解释较小的文本）。

现在，点被定义为 72 DPI。这总是正确的。当绘制到具有不同 DPI 的 PDF 时，GDI+ 应该做的是相应地转换字符串绘制。但这并不总是有效，尤其是文本。

GraphicsUnit.World 应该（根据一些谷歌搜索）独立于设备，并且在所有设备上看起来都应该相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-10T10:23:20.633

没错，GraphicsUnit.World 在打印和屏幕上看起来都一样。我的最终解决方案是使用 GraphicsUnit.World 作为度量单位，并避开点。我仍然不知道转换率，但我估计了这个值，直到看起来还不错。

就我的目的而言，这就足够了。

# winforms - 将 system.windows.forms 与 XNA 一起使用

> ID：258048
> 
> 赞同：7
> 
> 时间：2008-11-03T06:55:57.653
> 
> 标签：winforms, forms, xna

我正在制作一个使用 XNA 的游戏。我想在游戏中添加一些东西，例如按钮、文本框、标签、工具提示文本以及 system.windows.forms 附带的其他东西。如何将 system.windows.forms 与 XNA 合并？是否有任何 API 或 DLL 可以实现以使其正常工作？

谢谢，

本舒姆斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T09:21:19.233

坏消息：简而言之，不，这是不可能的（至少，以直截了当的方式）。虽然您可以将 System.Windows.Forms 控件用作游戏的画布，但您不能将 XNA 设备用作控件的画布。

好消息：已经有一些替代工具包可以使用 XNA 创建文本框、按钮和标签。

[http://forums.xna.com/forums/p/1891/9461.aspx](http://forums.xna.com/forums/p/1891/9461.aspx)

# c++ - 你如何将 CString 和 std::string std::wstring 相互转换？

> ID：258050
> 
> 赞同：81
> 
> 时间：2008-11-03T06:58:46.150
> 
> 标签：c++, mfc, c-strings, stdstring

`CString`非常方便，同时`std::string`更兼容 STL 容器。我正在使用`hash_map`. 但是，`hash_map`不支持`CString`s 作为键，所以我想将 s 转换`CString`为`std::string`.

编写`CString`散列函数似乎需要很多时间。

```
CString -----> std::string 
```

我怎样才能做到这一点？

```
std::string -----> CString:

inline CString toCString(std::string const& str)
{
    return CString(str.c_str()); 
} 
```

我对吗？

* * *

**编辑：**

这里有更多问题：

我怎样才能从`wstring`to转换，`CString`反之亦然？

```
// wstring -> CString
std::wstring src;
CString result(src.c_str());

// CString -> wstring
CString src;
std::wstring des(src.GetString()); 
```

这有什么问题吗？

此外，我怎样才能从`std::wstring`to转换，`std::string`反之亦然？

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2008-11-03T07:05:03.017

根据[CodeGuru](http://www.codeguru.com/forum/archive/index.php/t-231155.html)：

`CString`至`std::string`：

```
CString cs("Hello");
std::string s((LPCTSTR)cs); 
```

**但是：** `std::string`不能总是从`LPCTSTR`. 即 UNICODE 构建的代码将失败。

由于`std::string`只能从`LPSTR`/构造`LPCSTR`，使用 VC++ 7.x 或更高版本的程序员可以利用转换类，例如作为`CT2CA`中介。

```
CString cs ("Hello");
// Convert a TCHAR string to a LPCSTR
CT2CA pszConvertedAnsiString (cs);
// construct a std::string using the LPCSTR input
std::string strStd (pszConvertedAnsiString); 
```

[`std::string`至`CString`](http://cstrings.blogspot.com/2006/08/how-to-convert-from-stdstring-to.html)：（来自[Visual Studio 的 CString 常见问题解答...](http://cstrings.blogspot.com/2006/08/how-to-convert-from-stdstring-to.html)）

```
std::string s("Hello");
CString cs(s.c_str()); 
```

`CStringT`可以从字符或宽字符串构造。ie 它可以从`char*`(ie `LPSTR`) 或`wchar_t*`( `LPWSTR`) 转换。

换句话说， char-specialization (of `CStringT`) 即`CStringA`-specilization和`wchar_t`-specialization可以由任一字符或宽字符构成，`CStringW``TCHAR``CString``char`~~空终止（空终止在这里非常重要）~~字符串来源。
Althoug [IInspectable修改了](https://stackoverflow.com/users/1889329/iinspectable)[评论中](https://stackoverflow.com/questions/258050/how-to-convert-cstring-and-stdstring-stdwstring-to-each-other/258052?noredirect=1#comment29168168_258052)的“null-termination”部分：

> **不需要 NUL 终止**。
> `CStringT`具有采用显式长度参数的转换构造函数。这也意味着您可以从具有嵌入字符`CStringT`的对象构造对象。`std::string``NUL`

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-11-03T09:36:36.503

通过使用`std::basic_string<TCHAR>`而不是解决这个问题，`std::string`无论您的角色设置如何，它都应该可以正常工作。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-06-03T13:49:14.753

`CString`转换为`std::string`使用指定长度的转换更有效。

```
CString someStr("Hello how are you");
std::string std(someStr, someStr.GetLength()); 
```

在一个紧密的循环中，这会显着提高性能。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-07-12T15:05:24.737

如果你想要更多类似 C++ 的东西，这就是我使用的。虽然它依赖于 Boost，但这只是例外。您可以轻松地删除那些离开它只依赖于 STL 和`WideCharToMultiByte()`Win32 API 调用的人。

```
#include <string>
#include <vector>
#include <cassert>
#include <exception>

#include <boost/system/system_error.hpp>
#include <boost/integer_traits.hpp>

/**
 * Convert a Windows wide string to a UTF-8 (multi-byte) string.
 */
std::string WideStringToUtf8String(const std::wstring& wide)
{
    if (wide.size() > boost::integer_traits<int>::const_max)
        throw std::length_error(
            "Wide string cannot be more than INT_MAX characters long.");
    if (wide.size() == 0)
        return "";

    // Calculate necessary buffer size
    int len = ::WideCharToMultiByte(
        CP_UTF8, 0, wide.c_str(), static_cast<int>(wide.size()), 
        NULL, 0, NULL, NULL);

    // Perform actual conversion
    if (len > 0)
    {
        std::vector<char> buffer(len);
        len = ::WideCharToMultiByte(
            CP_UTF8, 0, wide.c_str(), static_cast<int>(wide.size()),
            &buffer[0], static_cast<int>(buffer.size()), NULL, NULL);
        if (len > 0)
        {
            assert(len == static_cast<int>(buffer.size()));
            return std::string(&buffer[0], buffer.size());
        }
    }

    throw boost::system::system_error(
        ::GetLastError(), boost::system::system_category);
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-09-06T10:07:43.293

> 有**什么**问题吗？

有几个问题：

*   `CString`是[CStringT](https://docs.microsoft.com/en-us/cpp/atl-mfc-shared/reference/cstringt-class)的模板特化。根据描述字符类型的*BaseType*，有两种具体的特化：`CStringA`(using `char`) 和`CStringW`(using `wchar_t`)。
*   虽然`wchar_t`在 Windows 上普遍用于存储 UTF-16 编码的代码单元，但使用`char`是模棱两可的。后者通常存储 ANSI 编码的字符，但也可以存储 ASCII、UTF-8 甚至二进制数据。
*   `CString`我们不知道（通过预处理器符号控制）的字符编码（甚至字符类型）`_UNICODE`，使问题变得模棱两可。我们也不知道`std::string`.
*   Unicode 和 ANSI 之间的转换本质上是有损的：ANSI 编码只能表示 Unicode 字符集的一个子集。

为了解决这些问题，我将假设`wchar_t`它将存储 UTF-16 编码的代码单元，`char`并将保存 UTF-8 八位字节序列。这是您可以做出的唯一合理选择，以确保源字符串和目标字符串保留相同的信息，而不会将解决方案限制为源域或目标域的子集。

以下实现在`CStringA`/`CStringW`和`std::wstring`/`std::string`从 UTF-8 到 UTF-16 的映射之间转换，反之亦然：

```
#include <string>
#include <atlconv.h>

std::string to_utf8(CStringW const& src_utf16)
{
    return { CW2A(src_utf16.GetString(), CP_UTF8).m_psz };
}

std::wstring to_utf16(CStringA const& src_utf8)
{
    return { CA2W(src_utf8.GetString(), CP_UTF8).m_psz };
} 
```

其余两个函数从 MFC 字符串构造 C++ 字符串对象，保持编码不变。请注意，虽然以前的函数无法处理嵌入的 NUL 字符，但这些函数对此免疫。

```
#include <string>
#include <atlconv.h>

std::string to_std_string(CStringA const& src)
{
    return { src.GetString(), src.GetString() + src.GetLength() };
}

std::wstring to_std_wstring(CStringW const& src)
{
    return { src.GetString(), src.GetString() + src.GetLength() };
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-08-21T09:14:40.077

（从 VS2012 开始……至少在 VS2017 v15.8.1 之前）

由于它是一个 MFC 项目且 CString 是一个 MFC 类，MS 提供了技术说明[TN059：使用 MFC MBCS/Unicode 转换宏](https://msdn.microsoft.com/en-us/library/805c56f8.aspx)和通用转换宏：

```
A2CW      (LPCSTR)  -> (LPCWSTR)  
A2W       (LPCSTR)  -> (LPWSTR)  
W2CA      (LPCWSTR) -> (LPCSTR)  
W2A       (LPCWSTR) -> (LPSTR) 
```

采用：

```
void Example() // ** UNICODE case **
{
    USES_CONVERSION; // (1)

    // CString to std::string / std::wstring
    CString strMfc{ "Test" }; // strMfc = L"Test"
    std::string strStd = W2A(strMfc); // ** Conversion Macro: strStd = "Test" **
    std::wstring wstrStd = strMfc.GetString(); // wsrStd = L"Test"

    // std::string to CString / std::wstring
    strStd = "Test 2";
    strMfc = strStd.c_str(); // strMfc = L"Test 2"
    wstrStd = A2W(strStd.c_str()); // ** Conversion Macro: wstrStd = L"Test 2" **

    // std::wstring to CString / std::string 
    wstrStd = L"Test 3";
    strMfc = wstrStd.c_str(); // strMfc = L"Test 3"
    strStd = W2A(wstrStd.c_str()); // ** Conversion Macro: strStd = "Test 3" **
} 
```

--

脚注：

(1) 为了让转换宏有空间来存储临时长度，有必要`_convert`在每个使用转换宏的函数中声明一个调用的局部变量。这是通过调用`USES_CONVERSION`宏来完成的。在 VS2017 MFC 代码 (atlconv.h) 中，它看起来像这样：

```
#ifndef _DEBUG
    #define USES_CONVERSION int _convert; (_convert); UINT _acp = ATL::_AtlGetConversionACP() /*CP_THREAD_ACP*/; (_acp); LPCWSTR _lpw; (_lpw); LPCSTR _lpa; (_lpa)
#else
    #define USES_CONVERSION int _convert = 0; (_convert); UINT _acp = ATL::_AtlGetConversionACP() /*CP_THREAD_ACP*/; (_acp); LPCWSTR _lpw = NULL; (_lpw); LPCSTR _lpa = NULL; (_lpa)
#endif 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-01-21T23:17:00.963

这工作正常：

```
//Convert CString to std::string
inline std::string to_string(const CString& cst)
{
    return CT2A(cst.GetString());
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-10-24T04:51:55.817

转换`CString to std::string`。您可以使用这种格式。

```
std::string sText(CW2A(CSText.GetString(), CP_UTF8 )); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-03-10T19:04:21.087

这是对 Sal 的回答的跟进，他/她在其中提供了解决方案：

```
CString someStr("Hello how are you");
std::string std(somStr, someStr.GetLength()); 
```

这在将非典型 C-String 转换为 std::string 时也很有用

对我来说，一个用例是有一个预先分配的 char 数组（如 C-String），但它不是 NUL 终止的。（即 SHA 摘要）。上面的语法允许我指定 char 数组的 SHA 摘要的长度，以便 std::string 不必寻找可能存在或不存在的终止 NUL char。

如：

```
unsigned char hashResult[SHA_DIGEST_LENGTH];    
auto value = std::string(reinterpret_cast<char*>hashResult, SHA_DIGEST_LENGTH); 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-08-21T08:55:32.547

来自这篇文章（谢谢[Mark Ransom](https://stackoverflow.com/users/5987/mark-ransom)）

[将 CString 转换为字符串 (VC6)](https://stackoverflow.com/questions/2954399/convert-cstring-to-string-vc6)

我已经对此进行了测试，并且效果很好。

```
std::string Utils::CString2String(const CString& cString) 
{
    std::string strStd;

    for (int i = 0;  i < cString.GetLength();  ++i)
    {
        if (cString[i] <= 0x7f)
            strStd.append(1, static_cast<char>(cString[i]));
        else
            strStd.append(1, '?');
    }

    return strStd;
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-04-19T17:31:11.603

您可以使用**CT2CA**

```
CString datasetPath;
CT2CA st(datasetPath);
string dataset(st); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-11-10T10:10:29.807

为我工作：

```
std::wstring CStringToWString(const CString& s)
{
    std::string s2;
    s2 = std::string((LPCTSTR)s);
    return std::wstring(s2.begin(),s2.end());
}

CString WStringToCString(std::wstring s)
{
    std::string s2;
    s2 = std::string(s.begin(),s.end());
    return s2.c_str();
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-06-29T21:15:37.527

所有其他答案并没有完全解决我正在寻找的内容，`CString`即即时转换而不是将结果存储在变量中。

解决方案与上面类似，但我们需要多一步来实例化一个无名对象。我用一个例子来说明。这是我需要`std::string`但我有的功能`CString`。

```
void CStringsPlayDlg::writeLog(const std::string &text)
{
    std::string filename = "c:\\test\\test.txt";

    std::ofstream log_file(filename.c_str(), std::ios_base::out | std::ios_base::app);

    log_file << text << std::endl;
} 
```

当你有一个时如何调用它`CString`？

```
std::string firstName = "First";
CString lastName = _T("Last");

writeLog( firstName + ", " + std::string( CT2A( lastName ) ) ); 
```

请注意，最后一行不是直接类型转换，但我们正在创建一个无名`std::string`对象并`CString`通过其构造函数提供。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-09-22T13:23:25.877

`CString`如果您使用的是 Unicode，则具有`GetString()`返回类型的方法，否则。`LPCWSTR``LPCSTR`

在 Unicode 情况下，您必须通过 a 传递它`wstring`：

```
CString cs("Hello");
wstring ws = wstring(cs.GetString());
string s = string(ws.begin(), ws.end()); 
```

否则，您可以直接转换字符串：

```
CString cs("Hello");
string s = string(cs.GetString()); 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2009-02-20T09:28:20.363

如果您希望在其他字符串类型之间轻松转换，那么[`_bstr_t`](http://msdn.microsoft.com/en-us/library/zthfhkd6(VS.71).aspx)该类可能更合适？它支持`char`,`wchar_t`和之间的转换`BSTR`。

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2017-10-17T19:58:20.967

一种有趣的方法是强制`CString`转换到构造函数`CStringA`内部`string`。与`std::string s((LPCTSTR)cs);`此不同，即使`_UNICODE`已定义也将起作用。但是，如果是这种情况，这将执行从 Unicode 到 ANSI 的转换，因此对于 ASCII 字符集之外的更高 Unicode 值是不安全的。这种转换受`_CSTRING_DISABLE_NARROW_WIDE_CONVERSION`预处理器定义的约束。[https://msdn.microsoft.com/en-us/library/5bzxfsea.aspx](https://msdn.microsoft.com/en-us/library/5bzxfsea.aspx)

```
 CString s1("SomeString");
        string s2((CStringA)s1); 
```

# excel - 当工作表名称是单元格的值时，如何引用另一个工作表的单元格？

> ID：258053
> 
> 赞同：10
> 
> 时间：2008-11-03T07:08:45.600
> 
> 标签：excel, excel-formula, worksheet-function

在 excel 2007 中，我在单元格中有一个公式，如下所示：

```
=COUNTIFS('2008-10-31'!$C:$C;">="&'$A7) 
```

现在我想让工作表的名称（'2008-10-31'）取决于某个单元格的值（比如 A1）。就像是：

```
=COUNTIFS(A1!$C:$C;">="&'$A7) // error 
```

有没有办法做到这一点？还是我必须为此编写一个 VBA 宏？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-03T08:56:42.013

间接做你想做的事。请注意，如果工作表名称有空格，则需要将单引号括起来，即

```
=COUNTIFS(INDIRECT("'" & A1 & "'!$C:$C"); ">=" & $A7) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-03T07:55:47.503

您正在寻找 INDIRECT 工作表函数：

```
=INDIRECT("SHEET2!A1")
=COUNTIFS(INDIRECT(A1 & "!$C:$C"); ">=" & $A7) 
```

该函数将字符串转换为真正的单元格引用。

# c# - 在 Visual Studio 的 Express 版本中进行 TDD 的最佳方式（例如 VB Express）

> ID：258055
> 
> 赞同：12
> 
> 时间：2008-11-03T07:09:07.737
> 
> 标签：c#, vb.net, unit-testing, testing, tdd

我一直在为我目前正在编写的一个应用程序（OLE 对象的 OLE 包装器）做一些测试驱动的开发。唯一的问题是我使用的是 Visual Studio 的 express 版本（目前），目前我使用的是 VB express，但有时我使用 C# express。

是否可以在 express 版本中进行 TDD？如果是这样，有什么不好的呢？

干杯。

编辑。从外观上看，我将不得不购买完整的视觉工作室，以便我可以进行集成 TDD，希望预算中有钱购买副本 :)。现在我想我会像大家说的那样使用 Nunit。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T07:22:29.440

[Nunit](http://www.nunit.org/index.php)似乎可以独立工作，为什么不尝试使用 Visual Studio 的 express 版本呢？

看起来您必须在 Nunit GUI 中使用 VS 之外的测试 dll。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-03T07:43:54.157

不幸的是，TestDriven.NET 和 NUnit 的主要支持者 Jamie Cansdale在提出适用于 Visual Studio Express 2005版本[的 TestDriven.NET 时遇到了很多法律问题。](http://weblogs.asp.net/nunitaddin/archive/2007/07/06/microsoft-amp-testdriven-net.aspx)

VS 2008 Express 的 EULA 已修改为将 TestDriven.NET 锁定在 IDE 之外。

我认为您可以运行测试的唯一方法是在 Visual Studio 之外使用 NUnit 客户端显式打开已编译的 DLL。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-03T08:34:21.510

Microsoft 不允许 Visual Studio 的 Express 版本进行 3rd 方扩展。正如 Jon Limjap 已经提到的，Testdriven.Net 不适用于 Visual Studio。其他与 Visual Studio 集成的测试运行程序（如 resharper 中的测试运行程序）也无法正常工作。

幸运的是，大多数单元测试框架，如 Xunit.Net、Nunit 和 MBUnit 都有自己的独立测试运行程序。您可以使用 Visual Studio Express 编译您的测试，然后在测试运行程序中加载测试程序集并执行测试。

您不能以这种方式测试网络项目中的代码。您需要将测试和要测试的代码放在单独的类库中。Web 项目是由网络服务器按需编译的，这使得测试变得困难。

Marc Gravell 的一个有用补充：*网站*项目是按需编译的。Web*应用程序*项目是预编译的。

因此，您应该能够使用外部测试运行器在 Web 应用程序项目中运行测试。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-06T03:35:15.077

您可能还想将 ExpressUnit 视为 VS 2008 Express 的轻量级测试框架。该框架以类库的形式集成到您的解决方案中，这意味着您不需要外部测试运行器来运行您的测试。这为您提供了在进程内运行测试的优势，这意味着您可以直接调试测试。由于 VS 2008 Express 无法附加进程外的第三方工具，这可能会有所帮助。ExpressUnit 可作为 WPF 应用程序使用。

在这里阅读更多 [http://torgeirhelgevold.wordpress.com/2008/05/31/unit-testing-in-visual-studio-express-2008/](http://torgeirhelgevold.wordpress.com/2008/05/31/unit-testing-in-visual-studio-express-2008/)

托尔

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T07:45:24.747

对于单元测试，您可以使用[NUnit](http://www.nunit.org/index.php)。

对于代码完成，您可以使用[NCover](http://www.ncover.com/)和[NCoverExplorer](http://webscripts.softpedia.com/script/Development-Scripts-js/NCoverExplorer-29187.html)。

以上所有内容都没有插入 Visual Studio Express，但它们确实有自己的 UI。我通常使用批处理脚本运行我的测试。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-27T03:16:45.523

对于 tdd，vs express 2008 有一些开发，您可以在此[站点](http://torgeirhelgevold.wordpress.com/)中找到更多信息。它被称为[单位快递gui](http://code.google.com/p/expressunit/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-08T16:13:23.293

还尝试将单元测试集成到 Visual Studio 2008 Express 中并找到此站点：[链接](http://www.dijksterhuis.org/setting-up-nunit-for-c-unit-testing-with-visual-studio-c-express-2008/)。效果很好 - 无需离开 Visual Studio :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-06T19:51:44.260

似乎 Visual C# 2010 express 有某种扩展，但我找不到 nunit（git 或 subversion）的任何东西。有人看到过吗？

# javascript - 获取表中特定对象的数据

> ID：258056
> 
> 赞同：2
> 
> 时间：2008-11-03T07:10:13.630
> 
> 标签：javascript, html

我需要获取特定的数据`<td>`，但我没有任何`id`或`name`特定的数据`<td>`。您如何获得其中的内容`<td>`？

例如：

```
<table>
  <tr><td>name</td><td>praveen</td></tr>
  <tr><td>designation</td><td>software engineer</td></tr>
</table> 
```

是否可以从此表中获取值“指定”。我需要使用 javascript 提取“软件工程师”一词。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T08:29:31.583

I prefer to use jQuery to do all the heavy lifting for this sort of task.

For example, the following function will return the text of the next element of the same type that you're searching for:

```
function GetNextChildText(tagToFind, valueToFind) {
    var nextText = "";
    $(tagToFind).each(function(i) {
        if ($(this).text() == valueToFind) {
            if ($(this).next() != null && $(this).next() != undefined) {
                nextText = $(this).next().text();
            }
        }
    });
    return (nextText);
} 
```

So, for your example table, your call to return the designation could be:

```
var designationText = GetNextChildText('td', 'designation'); 
```

And the result is that the variable designationText would contain the value 'software engineer'.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T08:14:03.377

A quick solution:

```
function GetTdContent(label)
{
  var TDs = document.getElementsByTagName("TD");
  var foundFlag = false;

  for (i = 0; i < TDs.length; i++)
  {
    if (foundFlag) return TDs[i].innerHTML;
    foundFlag = TDs[i].innerHTML.toLower() == label.toLower(); 
  }
} 
```

elsewhere call:

```
var value = GetTdContent("designation"); 
```

Explanation:

The function iterates all TDs in the document. If it finds one with the given label, say "designation", it loops one more time and returns the next TD content.

This makes a few assumptions about your source HTML. If you know your data though, it can be enough.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T07:32:47.987

Something along the line of:
(not tested, just quick code to give an idea)

```
var tables = document.getElementById('TABLE'); // instead of document.all.tag
var rows;
var cells;
var maxCells = 1;
var designation;
if (tables) {
    for (var t=0; t<tables.length; t++) {
        rows = tables[t].all.tags('TR');
        if (tables[t].all.tags('TABLE').length == 0) {
            for (var r=0; r<rows.length; r++) {
                if (rows[r].innerText != '') {
                    cells = rows[r].all.tags('TD');
                    for (var c=0; c<cells.length; c++) {
                        if (cells[c].innerText == 'designation' && c<(cells.length-1)) {
                            designation = cells[c+1].innerText;
                        }
                    }
                }
            }
        }
    }
} 
```

Since document.all is IE specific, you should rather user getElementById, with the following to [redefine that function for IE](http://www.sixteensmallstones.org/ie-javascript-bugs-overriding-internet-explorers-documentgetelementbyid-to-be-w3c-compliant-exposes-an-additional-bug-in-getattributes):

```
if (/msie/i.test (navigator.userAgent)) //only override IE
{
    document.nativeGetElementById = document.getElementById;
    document.getElementById = function(id)
    {
        var elem = document.nativeGetElementById(id);
        if(elem)
        {
            //make sure that it is a valid match on id
            if(elem.attributes['id'].value == id)
            {
                return elem;
            }
            else
            {
                //otherwise find the correct element
                for(var i=1;i<document.all[id].length;i++)
                {
                    if(document.all[id][i].attributes['id'].value == id)
                    {
                        return document.all[id][i];
                    }
                }
            }
        }
        return null;
    };
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T08:16:08.770

Use XPath (tutorial here, including instructions for IE and other browsers: [http://www.w3schools.com/XPath/xpath_examples.asp](http://www.w3schools.com/XPath/xpath_examples.asp))

The xpath for your example is

//table/tr/td[text()="designation"]/following::td

("the td that follows the td with text "designation" that's in a tr that's in a table somewhere in the document")

Simpler Xpaths are possible - if it's the only table cell that could contain 'designation' you could use

//td[text()="designation"]/following::td

One issue with writing code to do the particular search is that it needs changing, possibly significantly, if the structure of your page changes. The Xpath may not need to change at all, and if it does, it's only one line.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T15:06:08.757

Tomalak 有点快：

```
<script type="text/javascript">
function getText(tText){
  var tds = document.getElementsByTagName("td");
  for(var i=0, im=tds.length; im>i; i++){
    if(tds[i].firstChild.nodeValue == tText)
      return tds[i].nextSibling.firstChild.nodeValue;
  }
}
</script> 
```

# java - 无法更改 java.awt.MenuBar 中的字体

> ID：258057
> 
> 赞同：1
> 
> 时间：2008-11-03T07:15:02.653
> 
> 标签：java, awt, menubar

我正在尝试使用更改 AWT 菜单栏中的字体`MenuBar.setFont()`。该调用适用于菜单栏的子菜单，但菜单栏本身不会更改字体（我正在尝试使字体变大）。

有谁知道这是否可行？

我在 Windows XP 上使用 JRE 1.6。

**更新**：只要文本适合菜单栏高度，更改字体似乎确实有效，否则字体大小会减小。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T07:59:11.177

Use Swing. I don't think that AWT is capable of restyling native component peers in a reliable fashion. I know for certain that SWT can't, and it's a far more sophisticated toolkit than AWT. This is *part* of why it was essentially deprecated (in favor of Swing) back in Java 1.2.

# javascript - 正则表达式 - 我做错了什么吗？

> ID：258062
> 
> 赞同：2
> 
> 时间：2008-11-03T07:27:19.103
> 
> 标签：javascript, regex

*这是 javascript，但几乎相同的正则表达式在 PHP 中也失败了，所以我不认为它是特定于语言的*

```
var r = new RegExp(
    "^(:19|20)?[0-9][0-9]"            // optional 19/20 start followed by 2 numbers
    + "-"                             // a hyphen
    + "(:0?[1-9]|1[0-2])"             // optional 0 followed by 1-9, or 10, 11, 12
    + "-"                             // a hyphen
    + "(:3[01]|[12][0-9]|0?[1-9])$"   // you get the idea.
);
r.test("2008-07-01");                // == false 
```

我到底错过了什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-03T07:32:28.593

我认为您的非捕获块应该是例如`(?:19|20)`而不是`(:19|20)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T08:22:45.763

正确的; 您的正则表达式实际上可以使用`?:`

`?`使用前缀时，表示您将要做一些关于捕获的事情。要么不捕获块`(:)`，捕获前面`(=)`，后面`(<=)`等。

# c# - 在不更改 ControlTemplate 的情况下访问 TemplatePart？

> ID：258074
> 
> 赞同：2
> 
> 时间：2008-11-03T07:39:18.660
> 
> 标签：c#, wpf, controltemplates

我想知道是否有一种方法可以从 c# 中访问控件的模板部分以修改该部分（例如隐藏等）。是否可以使用纯 c# 获得对该部分的引用？我不想触摸控件模板。谢谢j。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T08:19:57.890

这是可能的，但它非常讨厌。

在模板上有一个名为 FindName 的方法，它需要两个参数：名称和以 ControlTemplate 作为模板的 FrameworkElement。当然，你需要在ControlTemplate中设置元素的名称...

另一个更优雅的解决方案是在 ControlTemplate 中使用绑定来确定可见性。这样你就不需要在你的代码中做任何事情，你可以只保留 Xaml ......

# asp.net - 为什么我会在 5 分钟内丢失会话变量？

> ID：258077
> 
> 赞同：1
> 
> 时间：2008-11-03T07:45:07.680
> 
> 标签：asp.net, iis, session, session-state

我有一个网页，用户可以在其中选择一家公司，并通过会话将公司名称保存在内存中，但是当我转到下一页时，会话仅持续 5 分钟？无论出于何种原因以及如何解决此问题，我确实在 Web.config 中扩展了会话状态，但这不起作用。

示例：Session("CompanyName") = "Bytes Technology"

在我的 web.config 我有： timeout="40" />

我使用 Session("CompanyName") 从 Default.aspx 移动到 CompanyDetail.aspx

但是，如果我让 CompanyDetail.aspx 中的程序空闲，我会丢失会话状态。

有任何想法吗？

问候艾蒂安

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T08:26:00.407

从您的评论中，我看到您认为您的站点位于负载平衡服务器场中。

在这种情况下，您需要将会话存储在数据库中或避免使用它：您无法确定每次回发时同一台服务器都会为同一用户提供服务，并且如果用户从服务器“A”转到服务器“B” “在两个不同的帖子中……您的会话变量丢失了。

尝试用谷歌搜索“会话状态数据库”，你会发现很多东西。

希望这可以帮助

安德烈亚

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T07:53:32.110

一些问题：

*   超时时间总是一样的？5分钟？
*   您的站点是否在负载平衡服务器场中运行？有多个前端服务器？
*   您在 web.confing 中关于会话和会话状态的内容是什么？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T20:38:22.360

我敢打赌你没有使用负载平衡的农场，实际上是在使用共享主机。

在负载平衡的场中，您的代码部署到多个服务器，如果您禁用了粘性会话，用户将使用每个请求负载最少的服务器。

由于您使用的是 3rd 方托管，我严重怀疑您是否这样做。

会话超时可以由主机提供商在 IIS 中硬设置，最可能的罪魁祸首是他们将其设置为 5 分钟。

致电您的主机提供商，询问他们的 IIS 会话设置是什么，然后从那里开始。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T07:54:44.757

在 IIS 中，进入您网站的属性，单击主目录选项卡，然后单击配置按钮。在这里，单击选项选项卡并检查那里的会话超时。我很确定这只会影响经典的 ASP，但我不能 100% 确定。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T08:08:58.660

如果这种情况总是在 5 分钟后发生，请检查 web.config 的会话设置，并检查 IIS：website/Properties/ASP.NET，单击编辑配置，选择状态管理选项卡，然后检查会话设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T08:17:29.797

服务器上是否有一些防病毒软件导致 Web 应用程序每 5 分钟重置一次，而 ASP.NET 运行时认为二进制文件或 web.config 已更改？这也是可能的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T20:30:37.417

另一个想法是将机器名称放入页面上的注释中，并查看该页面是否在页面之间发生变化，以确认处理请求的服务器发生了变化。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-04T09:27:27.067

谢谢大家提供的所有信息。托管我的网站的公司刚刚延长了应用程序池的时间，并且奏效了！

谢谢艾蒂安 [http://www.erate.co.za](http://www.erate.co.za)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-05T09:27:57.033

我决定放弃使用会话变量并使用查询字符串！好多了！！

# c - 什么时候应该使用 mmap 进行文件访问？

> ID：258091
> 
> 赞同：315
> 
> 时间：2008-11-03T07:56:03.150
> 
> 标签：c, file-io, posix, mmap

POSIX 环境至少提供两种访问文件的方式。有标准的系统调用`open()`, `read()`, `write()`, 和朋友，但也有`mmap()`用于将文件映射到虚拟内存的选项。

什么时候最好使用其中一种？包括两个接口的优点是什么？

* * *

## 回答 #1

> 赞同：333
> 
> 时间：2008-11-03T08:01:22.030

[`mmap`](http://man7.org/linux/man-pages/man2/mmap.2.html)如果您有多个进程以只读方式从同一个文件访问数据，那就太好了，这在我编写的那种服务器系统中很常见。 `mmap`允许所有这些进程共享相同的物理内存页面，从而节省大量内存。

`mmap`还允许操作系统优化分页操作。例如，考虑两个程序；程序`A`将文件读`1MB`​​入创建的缓冲区`malloc`，程序 B`mmaps`将 1MB 文件读入内存。如果操作系统必须将`A`'s 的部分内存换出，它必须先将缓冲区的内容写入交换，然后才能重用内存。在`B`' 的情况下，任何未修改`mmap`的 'd 页面都可以立即重用，因为操作系统知道如何从它们所在的现有文件中恢复它们`mmap`。（操作系统可以通过最初将可写页面标记`mmap`为只读并捕获[seg faults](https://en.wikipedia.org/wiki/Segmentation_fault)来检测哪些页面未修改，类似于[Copy on Write](https://en.wikipedia.org/wiki/Copy-on-write)策略）。

`mmap`对于[进程间通信](https://en.wikipedia.org/wiki/Inter-process_communication)也很有用。您可以`mmap`在需要通信的进程中将文件作为读/写，然后在`mmap'd`区域中使用同步原语（这就是`MAP_HASSEMAPHORE`标志的用途）。

`mmap`如果您需要在 32 位机器上处理非常大的文件，可能会有些尴尬。这是因为`mmap`必须在进程的地址空间中找到一个连续的地址块，该地址空间大到足以容纳被映射文件的整个范围。如果您的地址空间变得碎片化，这可能会成为一个问题，您可能有 2 GB 的可用地址空间，但没有一个单独的范围可以适合 1 GB 的文件映射。在这种情况下，您可能必须将文件映射成比您想要的更小的块。

作为读/写替代品的另一个潜在尴尬`mmap`是您必须在页面大小的偏移量上开始映射。如果您只想在偏移量处获取一些数据，`X`则需要修复该偏移量以使其与`mmap`.

最后，读/写是处理某些类型文件 的唯一方法**。**`mmap`不能用于[管道](https://en.wikipedia.org/wiki/Named_pipe)和[ttys](https://en.wikipedia.org/wiki/Tty_(unix))之类的东西。

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2008-11-03T22:16:38.653

我发现 mmap() 不是优势的一个领域是读取小文件（低于 16K）时。与仅执行一次 read() 系统调用相比，读取整个文件的页面错误开销非常高。这是因为内核有时可以在您的时间片中完全满足读取，这意味着您的代码不会切换。由于页面错误，似乎更有可能安排另一个程序，从而使文件操作具有更高的延迟。

* * *

## 回答 #3

> 赞同：49
> 
> 时间：2010-05-24T08:53:50.630

`mmap`当您对大文件进行随机访问时具有优势。另一个优点是您可以通过内存操作（memcpy、指针算法）访问它，而无需担心缓冲。当结构大于缓冲区时，使用缓冲区时，普通 I/O 有时会非常困难。要处理的代码通常很难正确处理，mmap 通常更容易。这就是说，使用`mmap`. 正如人们已经提到`mmap`的那样，设置成本非常高，因此仅对给定尺寸（因机器而异）才值得使用。

对于对文件的纯顺序访问，它也不总是更好的解决方案，尽管适当的调用`madvise`可以缓解问题。

您必须小心您的架构（SPARC、安腾）的对齐限制，通过读/写 IO，缓冲区通常会正确对齐，并且在取消引用强制转换的指针时不会陷入陷阱。

您还必须注意不要在地图之外访问。如果您在地图上使用字符串函数，并且文件末尾不包含 \0，则很容易发生这种情况。大多数情况下，当您的文件大小不是页面大小的倍数时，它将起作用，因为最后一页填充为 0（映射区域的大小始终为页面大小的倍数）。

* * *

## 回答 #4

> 赞同：40
> 
> 时间：2017-09-27T07:46:28.723

除了其他不错的答案，引用谷歌专家罗伯特·洛夫 (Robert Love) 所写的[Linux 系统编程的话：](https://rads.stackoverflow.com/amzn/click/com/1449339530)

> ### 的优点`mmap( )`
> 
> 与标准和系统调用相比，通过操作文件`mmap( )`有一些优势。其中有：`read( )``write( )`
> 
> *   读取和写入内存映射文件避免了使用`read( )`or`write( )`系统调用时发生的无关复制，其中数据必须复制到用户空间缓冲区和从用户空间缓冲区复制。
>     
>     
> *   除了任何潜在的页面错误之外，读取和写入内存映射文件不会产生任何系统调用或上下文切换开销。就像访问内存一样简单。
>     
>     
> *   当多个进程将同一个对象映射到内存中时，数据在所有进程之间共享。只读和共享可写映射完全共享；私有可写映射共享它们的尚未 COW（写时复制）页面。
>     
>     
> *   寻找映射涉及微不足道的指针操作。不需要`lseek( )`系统调用。
>     
>     
> 
> 由于这些原因，`mmap( )`它是许多应用程序的明智选择。
> 
> ### 的缺点`mmap( )`
> 
> 使用时有几点需要注意`mmap( )`：
> 
> *   内存映射始终是整数页大小。因此，后备文件的大小与整数页数之间的差异被“浪费”为松弛空间。对于小文件，可能会浪费很大比例的映射。例如，对于 4 KB 页面，7 字节映射会浪费 4,089 字节。
>     
>     
> *   内存映射必须适合进程的地址空间。对于 32 位地址空间，大量不同大小的映射会导致地址空间碎片化，从而难以找到大的空闲连续区域。当然，这个问题在 64 位地址空间中不太明显。
>     
>     
> *   在内核中创建和维护内存映射和相关数据结构是有开销的。这种开销通常可以通过消除上一节中提到的双重副本来消除，特别是对于较大且经常访问的文件。
>     
>     
> 
> 由于这些原因，`mmap( )`当映射文件很大时（因此任何浪费的空间只占总映射的一小部分），或者当映射文件的总大小可以被页面大小整除时（因此没有浪费的空间）。

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-11-03T08:08:00.770

与传统 IO 相比，内存映射具有巨大的速度优势。它让操作系统在内存映射文件中的页面被触摸时从源文件中读取数据。这通过创建故障页面来工作，操作系统检测到这些页面，然后操作系统自动从文件中加载相应的数据。

这与分页机制的工作方式相同，通常通过读取系统页面边界和大小（通常为 4K）上的数据来针对高速 I/O 进行优化——大多数文件系统缓存都针对该大小进行了优化。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-09-17T06:04:47.810

尚未列出的一个优点是将`mmap()`只读映射保持为*干净*页面的能力。如果在进程的地址空间中分配一个缓冲区，然后使用`read()`从文件中填充缓冲区，则与该缓冲区对应的内存页面现在是*脏*的，因为它们已被写入。

内核不能从 RAM 中删除脏页。如果有交换空间，则可以将它们调出进行交换。但这很昂贵，并且在某些系统上，例如只有闪存的小型嵌入式设备，根本没有交换。在这种情况下，缓冲区将被卡在 RAM 中，直到进程退出，或者可能以`madvise()`.

非写入`mmap()`页面是干净的。如果内核需要 RAM，它可以简单地删除它们并使用页面所在的 RAM。如果具有映射的进程再次访问它，则会导致页面错误，内核从它们最初来自的文件重新加载页面. 与他们最初的填充方式相同。

这不需要多个使用映射文件的进程即可成为优势。

# java - 如何从代码中关闭 Java Swing 应用程序

> ID：258099
> 
> 赞同：98
> 
> 时间：2008-11-03T08:01:53.823
> 
> 标签：java, swing

从代码中终止 Swing 应用程序的正确方法是什么，有哪些陷阱？

我试图在计时器触发后自动关闭我的应用程序。但是仅仅调用`dispose()`并`JFrame`没有奏效——窗口消失了，但应用程序没有终止。但是，当使用关闭按钮关闭窗口时，应用程序会终止。我该怎么办？

* * *

## 回答 #1

> 赞同：112
> 
> 时间：2008-11-03T17:01:37.197

您的 JFrame 默认关闭操作可以设置为“ `DISPOSE_ON_CLOSE`”而不是`EXIT_ON_CLOSE`（为什么人们继续使用 EXIT_ON_CLOSE 超出了我的范围）。

如果您有任何未部署的窗口或非守护线程，您的应用程序将不会终止。这应该被认为是一个错误（使用 System.exit 解决它是一个非常糟糕的主意）。

最常见的罪魁祸首是 java.util.Timer 和您创建的自定义线程。两者都应该设置为 daemon 或者必须被明确地杀死。

如果要检查所有活动帧，可以使用[`Frame.getFrames()`](http://java.sun.com/j2se/1.5.0/docs/api/java/awt/Frame.html#getFrames()). 如果所有 Windows/Frames 都已处理完毕，则使用调试器检查任何仍在运行的非守护线程。

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2008-11-03T08:21:25.063

我猜是[EXIT_ON_CLOSE](http://java.sun.com/docs/books/tutorial/uiswing/components/frame.html#windowevents)

```
frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
```

before更好，因为您可以在实际离开应用程序之前`System.exit(0)`编写一个[窗口侦听器来进行一些清理操作。](http://java.sun.com/docs/books/tutorial/uiswing/events/windowlistener.html)

该窗口侦听器允许您定义：

```
public void windowClosing(WindowEvent e) {
    displayMessage("WindowListener method called: windowClosing.");
    //A pause so user can see the message before
    //the window actually closes.
    ActionListener task = new ActionListener() {
        boolean alreadyDisposed = false;
        public void actionPerformed(ActionEvent e) {
            if (frame.isDisplayable()) {
                alreadyDisposed = true;
                frame.dispose();
            }
        }
    };
    Timer timer = new Timer(500, task); //fire every half second
    timer.setInitialDelay(2000);        //first delay 2 seconds
    timer.setRepeats(false);
    timer.start();
}

public void windowClosed(WindowEvent e) {
    //This will only be seen on standard output.
    displayMessage("WindowListener method called: windowClosed.");
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2008-11-03T08:04:31.807

尝试：

```
System.exit(0); 
```

粗鲁，但有效。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2011-06-24T19:01:57.940

可能是安全的方式是这样的：

```
 private JButton btnExit;
    ...
    btnExit = new JButton("Quit");      
    btnExit.addActionListener(new ActionListener() {
        public void actionPerformed(ActionEvent e){
            Container frame = btnExit.getParent();
            do 
                frame = frame.getParent(); 
            while (!(frame instanceof JFrame));                                      
            ((JFrame) frame).dispose();
        }
    }); 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2010-04-06T05:29:22.410

以下程序包含的代码将终止缺少无关线程的程序，而无需显式调用 System.exit()。为了将此示例应用于使用线程/侦听器/计时器/等的应用程序，只需在 actionPerformed() 中手动启动 WindowEvent 之前插入清理代码以请求（并且，如果适用，等待）它们的终止。

*对于那些希望复制/粘贴能够完全按照所示运行的代码的人，最后包含了一个有点难看但在其他方面不相关的 main 方法。*

```
public class CloseExample extends JFrame implements ActionListener {

    private JButton turnOffButton;

    private void addStuff() {
        setDefaultCloseOperation(DISPOSE_ON_CLOSE);
        turnOffButton = new JButton("Exit");
        turnOffButton.addActionListener(this);
        this.add(turnOffButton);
    }

    public void actionPerformed(ActionEvent quitEvent) {
        /* Iterate through and close all timers, threads, etc here */
        this.processWindowEvent(
                new WindowEvent(
                      this, WindowEvent.WINDOW_CLOSING));
    }

    public CloseExample() {
        super("Close Me!");
        addStuff();
    }

    public static void main(String[] args) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                CloseExample cTW = new CloseExample();
                cTW.setSize(200, 100);
                cTW.setLocation(300,300);
                cTW.setVisible(true);
            }
        });
    }
} 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-03T08:41:10.763

如果我理解正确，即使用户没有单击关闭按钮，您也想关闭应用程序。您可能需要使用更适合您需要的 addWindowListener() 或 enableEvents() 注册 WindowEvents。

然后，您可以通过调用 processWindowEvent() 来调用该事件。这是一个示例代码，它将创建一个 JFrame，等待 5 秒并在没有用户交互的情况下关闭 JFrame。

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

public class ClosingFrame extends JFrame implements WindowListener{

public ClosingFrame(){
    super("A Frame");
    setSize(400, 400);
            //in case the user closes the window
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            setVisible(true);
            //enables Window Events on this Component
            this.addWindowListener(this);

            //start a timer
    Thread t = new Timer();
            t.start();
    }

public void windowOpened(WindowEvent e){}
public void windowClosing(WindowEvent e){}

    //the event that we are interested in
public void windowClosed(WindowEvent e){
    System.exit(0);
}

public void windowIconified(WindowEvent e){}
public void windowDeiconified(WindowEvent e){}
public void windowActivated(WindowEvent e){}
public void windowDeactivated(WindowEvent e){}

    //a simple timer 
    class Timer extends Thread{
           int time = 10;
           public void run(){
     while(time-- > 0){
       System.out.println("Still Waiting:" + time);
               try{
                 sleep(500);                     
               }catch(InterruptedException e){}
             }
             System.out.println("About to close");
    //close the frame
            ClosingFrame.this.processWindowEvent(
                 new WindowEvent(
                       ClosingFrame.this, WindowEvent.WINDOW_CLOSED));
           }
    }

    //instantiate the Frame
public static void main(String args[]){
          new ClosingFrame();
    }

} 
```

如您所见，processWindowEvent() 方法会触发 WindowClosed 事件，如果您需要在关闭应用程序之前有机会执行一些清理代码，则该事件会被触发。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-09-25T11:32:19.663

查看[Oracle 文档](http://docs.oracle.com/javase/7/docs/api/java/awt/doc-files/AWTThreadIssues.html#Autoshutdown)。

从 JDK 1.4 开始，如果出现以下情况，应用程序将终止：

*   没有可显示的 AWT 或 Swing 组件。
*   本机事件队列中没有本机事件。
*   java EventQueues 中没有 AWT 事件。

角柜：

该文档指出，一些包创建可显示的组件而不释放它们。[调用 Toolkit.getDefaultToolkit() 的程序不会终止。](http://bugs.sun.com/view_bug.do?bug_id=4515058)是作为一个例子给出的。

当其他进程出于某种原因将事件发送到本机事件队列时，它们也可以保持 AWT 处于活动状态。

我还注意到，在某些系统上，应用程序实际终止需要几秒钟的时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-01-18T21:44:51.143

我认为，这里的想法是 WindowListener - 您可以在其中添加任何您想在关闭之前运行的代码

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2011-08-16T00:37:34.160

针对其他评论，DISPOSE_ON_CLOSE 似乎没有正确退出应用程序 - 它只会破坏窗口，但应用程序将继续运行。如果要终止应用程序，请使用 EXIT_ON_CLOSE。

# python - Python: wrapping method invocations with pre and post methods

> ID：258119
> 
> 赞同：8
> 
> 时间：2008-11-03T08:23:10.397
> 
> 标签：python, metaprogramming

I am instantiating a class A (which I am importing from somebody else, so I can't modify it) into my class X.

Is there a way I can intercept or wrap calls to methods in A? I.e., in the code below can I call

```
x.a.p1() 
```

and get the output

```
X.pre
A.p1
X.post 
```

Many TIA!

```
class A:
    # in my real application, this is an imported class
    # that I cannot modify
    def p1(self): print 'A.p1'

class X:
    def __init__(self):
        self.a=A()
    def pre(self): print 'X.pre'
    def post(self): print 'X.post'

x=X()
x.a.p1() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T10:18:21.910

Here is the solution I and my colleagues came up with:

```
from types import MethodType

class PrePostCaller:
    def __init__(self, other):
        self.other = other

    def pre(self): print 'pre'
    def post(self): print 'post'

    def __getattr__(self, name):
        if hasattr(self.other, name):
            func = getattr(self.other, name)
            return lambda *args, **kwargs: self._wrap(func, args, kwargs)
        raise AttributeError(name)

    def _wrap(self, func, args, kwargs):
        self.pre()
        if type(func) == MethodType:
            result = func( *args, **kwargs)
        else:
            result = func(self.other, *args, **kwargs)
        self.post()
        return result

#Examples of use
class Foo:
    def stuff(self):
        print 'stuff'

a = PrePostCaller(Foo())
a.stuff()

a = PrePostCaller([1,2,3])
print a.count() 
```

Gives:

```
pre
stuff
post
pre
post
0 
```

So when creating an instance of your object, wrap it with the PrePostCaller object. After that you continue using the object as if it was an instance of the wrapped object. With this solution you can do the wrapping on a per instance basis.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T08:26:27.503

The no-whistles-or-bells solution would be to write a wrapper class for class A that does just that.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T09:06:35.177

You could just modify the A instance and replace the p1 function with a wrapper function:

```
def wrapped(pre, post, f):
    def wrapper(*args, **kwargs):
        pre()
        retval = f(*args, **kwargs)
        post()
        return retval
    return wrapper

class Y:
    def __init__(self):
        self.a=A()
        self.a.p1 = wrapped(self.pre, self.post, self.a.p1)

    def pre(self): print 'X.pre'
    def post(self): print 'X.post' 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T10:00:30.463

I've just recently read about decorators in python, I'm not understanding them yet but it seems to me that they can be a solution to your problem. see Bruce Eckel intro to decorators at: [http://www.artima.com/weblogs/viewpost.jsp?thread=240808](http://www.artima.com/weblogs/viewpost.jsp?thread=240808)

He has a few more posts on that topic there.

Edit: Three days later I stumble upon this article, which shows how to do a similar task without decorators, what's the problems with it and then introduces decorators and develop a quite full solution: [http://wordaligned.org/articles/echo](http://wordaligned.org/articles/echo)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T10:27:04.077

As others have mentioned, the wrapper/decorator solution is probably be the easiest one. I don't recommend modifyng the wrapped class itself, for the same reasons that you point out.

If you have many external classes you can write a code generator to generate the wrapper classes for you. Since you are doing this in Python you can probably even implement the generator as a part of the program, generating the wrappers at startup, or something.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T10:07:25.693

Here's what I've received from Steven D'Aprano on comp.lang.python.

```
# Define two decorator factories.
def precall(pre):
    def decorator(f):
        def newf(*args, **kwargs):
            pre()
            return f(*args, **kwargs)
        return newf
    return decorator

def postcall(post):
    def decorator(f):
        def newf(*args, **kwargs):
            x = f(*args, **kwargs)
            post()
            return x
        return newf
    return decorator 
```

Now you can monkey patch class A if you want. It's probably not a great idea to do this in production code, as it will effect class A everywhere. [this is ok for my application, as it is basically a protocol converter and there's exactly one instance of each class being processed.]

```
class A:
    # in my real application, this is an imported class
    # that I cannot modify
    def p1(self): print 'A.p1'

class X:
    def __init__(self):
        self.a=A()
        A.p1 = precall(self.pre)(postcall(self.post)(A.p1))
    def pre(self): print 'X.pre'
    def post(self): print 'X.post'

x=X()
x.a.p1() 
```

Gives the desired result.

```
X.pre
A.p1
X.post 
```

# java - What is the memory consumption of an object in Java?

> ID：258120
> 
> 赞同：235
> 
> 时间：2008-11-03T08:24:48.240
> 
> 标签：java, memory, footprint

Is the memory space consumed by one object with 100 attributes the same as that of 100 objects, with one attribute each?

How much memory is allocated for an object?
How much additional space is used when adding an attribute?

* * *

## 回答 #1

> 赞同：194
> 
> 时间：2008-11-03T08:42:19.403

[Mindprod](http://mindprod.com/jgloss/sizeof.html) points out that this is not a straightforward question to answer:

> A JVM is free to store data any way it pleases internally, big or little endian, with any amount of padding or overhead, though primitives must behave as if they had the official sizes.
> For example, the JVM or native compiler might decide to store a `boolean[]` in 64-bit long chunks like a `BitSet`. It does not have to tell you, so long as the program gives the same answers.
> 
> *   It might allocate some temporary Objects on the stack.
> *   It may optimize some variables or method calls totally out of existence replacing them with constants.
> *   It might version methods or loops, i.e. compile two versions of a method, each optimized for a certain situation, then decide up front which one to call.
> 
> Then of course the hardware and OS have multilayer caches, on chip-cache, SRAM cache, DRAM cache, ordinary RAM working set and backing store on disk. Your data may be duplicated at every cache level. All this complexity means you can only very roughly predict RAM consumption.

## Measurement methods

You can use [`Instrumentation.getObjectSize()`](https://docs.oracle.com/javase/8/docs/api/java/lang/instrument/Instrumentation.html#getObjectSize-java.lang.Object-) to obtain an estimate of the storage consumed by an object.

To visualize the *actual* object layout, footprint, and references, you can use the [JOL (Java Object Layout) tool](http://openjdk.java.net/projects/code-tools/jol/).

## Object headers and Object references

In a modern 64-bit JDK, an object has a 12-byte header, padded to a multiple of 8 bytes, so the minimum object size is 16 bytes. For 32-bit JVMs, the overhead is 8 bytes, padded to a multiple of 4 bytes. *(From [Dmitry Spikhalskiy's answer](https://stackoverflow.com/a/32224498/6309), [Jayen's answer](https://stackoverflow.com/a/35407947/6309), and [JavaWorld](http://www.javaworld.com/javaworld/javatips/jw-javatip130.html).)*

Typically, references are 4 bytes on 32bit platforms or on 64bit platforms up to `-Xmx32G`; and 8 bytes above 32Gb (`-Xmx32G`). *(See [compressed object references](http://www.lowtek.ca/roo/2008/java-performance-in-64bit-land/).)*

As a result, a 64-bit JVM would typically require 30-50% more heap space. *([Should I use a 32- or a 64-bit JVM?](http://www.javacodegeeks.com/2012/12/should-i-use-a-32-or-a-64-bit-jvm.html), 2012, JDK 1.7)*

## Boxed types, arrays, and strings

Boxed wrappers have overhead compared to primitive types (from [JavaWorld](http://www.javaworld.com/javaworld/javatips/jw-javatip130.html)):

> *   **`Integer`**: The 16-byte result is a little worse than I expected because an `int` value can fit into just 4 extra bytes. Using an `Integer` costs me a 300 percent memory overhead compared to when I can store the value as a primitive type
>     
>     
> *   **`Long`**: 16 bytes also: Clearly, actual object size on the heap is subject to low-level memory alignment done by a particular JVM implementation for a particular CPU type. It looks like a `Long` is 8 bytes of Object overhead, plus 8 bytes more for the actual long value. In contrast, `Integer` had an unused 4-byte hole, most likely because the JVM I use forces object alignment on an 8-byte word boundary.

Other containers are costly too:

> *   **Multidimensional arrays**: it offers another surprise.
>     Developers commonly employ constructs like `int[dim1][dim2]` in numerical and scientific computing.
>     
>     
>     
>     In an `int[dim1][dim2]` array instance, every nested `int[dim2]` array is an `Object` in its own right. Each adds the usual 16-byte array overhead. When I don't need a triangular or ragged array, that represents pure overhead. The impact grows when array dimensions greatly differ.
>     
>     
>     
>     For example, a `int[128][2]` instance takes 3,600 bytes. Compared to the 1,040 bytes an `int[256]` instance uses (which has the same capacity), 3,600 bytes represent a 246 percent overhead. In the extreme case of `byte[256][1]`, the overhead factor is almost 19! Compare that to the C/C++ situation in which the same syntax does not add any storage overhead.
>     
>     
> *   **`String`**: a `String`'s memory growth tracks its internal char array's growth. However, the `String` class adds another 24 bytes of overhead.
>     
>     
>     
>     For a nonempty `String` of size 10 characters or less, the added overhead cost relative to useful payload (2 bytes for each char plus 4 bytes for the length), ranges from 100 to 400 percent.

## Alignment

Consider this [example object](https://plumbr.eu/blog/memory-leaks/how-much-memory-do-i-need-part-2-what-is-shallow-heap):

```
class X {                      // 8 bytes for reference to the class definition
   int a;                      // 4 bytes
   byte b;                     // 1 byte
   Integer c = new Integer();  // 4 bytes for a reference
} 
```

A naïve sum would suggest that an instance of `X` would use 17 bytes. However, due to alignment (also called padding), the JVM allocates the memory in multiples of 8 bytes, so instead of 17 bytes it would allocate 24 bytes.

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2015-08-26T10:43:56.143

这取决于架构/ jdk。对于现代 JDK 和 64 位架构，对象具有 12 字节的标头和 8 字节的填充 - 因此最小对象大小为 16 字节。您可以使用名为[Java Object Layout](http://openjdk.java.net/projects/code-tools/jol/)的工具来确定大小并获取有关任何实体的对象布局和内部结构的详细信息，或者通过类引用猜测此信息。我的环境中 Integer 的输出示例：

```
Running 64-bit HotSpot VM.
Using compressed oop with 3-bit shift.
Using compressed klass with 3-bit shift.
Objects are 8 bytes aligned.
Field sizes by type: 4, 1, 1, 2, 2, 4, 4, 8, 8 [bytes]
Array element sizes: 4, 1, 1, 2, 2, 4, 4, 8, 8 [bytes]

java.lang.Integer object internals:
 OFFSET  SIZE  TYPE DESCRIPTION                    VALUE
      0    12       (object header)                N/A
     12     4   int Integer.value                  N/A
Instance size: 16 bytes (estimated, the sample instance is not available)
Space losses: 0 bytes internal + 0 bytes external = 0 bytes total 
```

因此，对于 Integer，实例大小为 16 字节，因为 4 字节 int 紧挨着 header 之后和填充边界之前压缩到位。

代码示例：

```
import org.openjdk.jol.info.ClassLayout;
import org.openjdk.jol.util.VMSupport;

public static void main(String[] args) {
    System.out.println(VMSupport.vmDetails());
    System.out.println(ClassLayout.parseClass(Integer.class).toPrintable());
} 
```

如果你使用 maven，要获得 JOL：

```
<dependency>
    <groupId>org.openjdk.jol</groupId>
    <artifactId>jol-core</artifactId>
    <version>0.3.2</version>
</dependency> 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2008-11-03T08:39:52.233

Each object has a certain overhead for its associated monitor and type information, as well as the fields themselves. Beyond that, fields can be laid out pretty much however the JVM sees fit (I believe) - but as [shown in another answer](https://stackoverflow.com/questions/229886/size-of-a-byte-in-memory-java#230063), at least *some* JVMs will pack fairly tightly. Consider a class like this:

```
public class SingleByte
{
    private byte b;
} 
```

vs

```
public class OneHundredBytes
{
    private byte b00, b01, ..., b99;
} 
```

On a 32-bit JVM, I'd expect 100 instances of `SingleByte` to take 1200 bytes (8 bytes of overhead + 4 bytes for the field due to padding/alignment). I'd expect one instance of `OneHundredBytes` to take 108 bytes - the overhead, and then 100 bytes, packed. It can certainly vary by JVM though - one implementation may decide not to pack the fields in `OneHundredBytes`, leading to it taking 408 bytes (= 8 bytes overhead + 4 * 100 aligned/padded bytes). On a 64 bit JVM the overhead may well be bigger too (not sure).

EDIT: See the comment below; apparently HotSpot pads to 8 byte boundaries instead of 32, so each instance of `SingleByte` would take 16 bytes.

Either way, the "single large object" will be at least as efficient as multiple small objects - for simple cases like this.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-01-24T12:55:32.727

The total used / free memory of a program can be obtained in the program via

```
java.lang.Runtime.getRuntime(); 
```

The runtime has several methods which relate to the memory. The following coding example demonstrates its usage.

```
 public class PerformanceTest {
     private static final long MEGABYTE = 1024L * 1024L;

     public static long bytesToMegabytes(long bytes) {
         return bytes / MEGABYTE;
     }

     public static void main(String[] args) {
         // I assume you will know how to create an object Person yourself...
         List <Person> list = new ArrayList <Person> ();
         for (int i = 0; i <= 100_000; i++) {
             list.add(new Person("Jim", "Knopf"));
         }

         // Get the Java runtime
         Runtime runtime = Runtime.getRuntime();

         // Run the garbage collector
         runtime.gc();

         // Calculate the used memory
         long memory = runtime.totalMemory() - runtime.freeMemory();
         System.out.println("Used memory is bytes: " + memory);
         System.out.println("Used memory is megabytes: " + bytesToMegabytes(memory));
     }
 } 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2015-05-05T21:49:26.850

似乎每个对象在 32 位系统上都有 16 字节的开销（在 64 位系统上是 24 字节）。

[http://algs4.cs.princeton.edu/14analysis/](http://algs4.cs.princeton.edu/14analysis/)是一个很好的信息来源。许多好的例子中的一个例子如下。

![在此处输入图像描述](https://i.stack.imgur.com/d5jNj.png)

[http://www.cs.virginia.edu/kim/publicity/pldi09tutorials/memory-efficient-java-tutorial.pdf](http://www.cs.virginia.edu/kim/publicity/pldi09tutorials/memory-efficient-java-tutorial.pdf)也很丰富，例如：

![在此处输入图像描述](https://i.stack.imgur.com/E8l6J.png)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-02-15T11:16:15.507

> 1个100个属性的对象占用的内存空间和100个1个属性的对象占用的内存空间是一样的吗？

不。

> 为一个对象分配了多少内存？

*   开销在 32 位上为 8 个字节，在 64 位上为 12 个字节；然后向上取整为 4 字节（32 位）或 8 字节（64 位）的倍数。

> 添加属性时使用了多少额外空间？

*   属性范围从 1 字节 (byte) 到 8 字节 (long/double)，但引用是 4 字节或 8 字节，这取决于*它*是 32 位还是 64 位，而取决于 -Xmx 是 < 32Gb 还是 >= 32Gb：典型 64 -bit JVM 有一个称为“-UseCompressedOops”的优化，如果堆小于 32Gb，它会将引用压缩到 4 个字节。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2008-11-03T08:26:17.720

No, registering an object takes a bit of memory too. 100 objects with 1 attribute will take up more memory.

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2013-05-18T14:23:18.003

这个问题将是一个非常广泛的问题。

它取决于类变量，或者您可以在 java 中调用状态内存使用情况。

它还对标头和引用有一些额外的内存要求。

**Java 对象使用的堆内存包括**

*   原始字段的内存，根据它们的大小（参见下面的原始类型的大小）；

*   参考字段的内存（每个 4 个字节）；

*   一个对象头，由几个字节的“管家”信息组成；

Java 中的对象还需要一些“管家”信息，例如记录对象的类、ID 和状态标志，例如对象当前是否可访问、当前是否已同步锁定等。

Java 对象标头大小在 32 位和 64 位 jvm 上有所不同。

虽然这些是主要的内存消费者，但 jvm 有时也需要额外的字段，例如代码对齐等

**原始类型的大小**

**布尔值 & 字节**-- 1

**字符 & 短**-- 2

**整数和浮点数**——4

**长 & 双**-- 8

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-04T01:27:30.220

我从另一个答案中提到的[java.lang.instrument.Instrumentation方法获得了非常好的结果。](http://java.sun.com/javase/6/docs/api/java/lang/instrument/Instrumentation.html)有关其使用的良好示例，请参见JavaSpecialists' Newsletter 中的*[Instrumentation Memory Counter](http://www.javaspecialists.eu/archive/Issue142.html)*[条目和 SourceForge 上的java.sizeOf](https://sourceforge.net/projects/sizeof/)库。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-04-07T17:10:51.767

如果它对任何人有用，您可以从我的网站下载一个小型[Java 代理，用于查询对象的内存使用情况](http://www.javamex.com/classmexer/)。它还可以让您查询“深度”内存使用情况。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-03T08:27:12.697

no, 100 small objects needs more information (memory) than one big.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-13T08:18:12.680

关于消耗多少内存的规则取决于 JVM 实现和 CPU 架构（例如 32 位与 64 位）。

有关 SUN JVM 的详细规则，请查看[我的旧博客](http://www.sdn.sap.com/irj/scn/weblogs?blog=/pub/wlg/5163)

问候， [马库斯](http://kohlerm.blogspot.com/)

# ruby-on-rails - Activerecode HABTM primary key problem

> ID：258128
> 
> 赞同：0
> 
> 时间：2008-11-03T08:28:08.607
> 
> 标签：ruby-on-rails, activerecord, associations

I have to tables that have a many to many relationship. I have created the correct table codesecure_project_tst_definition and it works. I can join rows together by calling the codesecure_projects << method on a TstDefinition object. The problem is that for some reason active record wants to use Codesecure_project_id as the id value for the codesecure_project_tst_definition table. What am I doing wrong? How do I fix it so that when I call the codesecure_projects << method it does not try to set the id of the codesecure_project_tst_definition table?

I have posted the migrations below

```
class CreateCodesecureProjects < ActiveRecord::Migration
  def self.up
    create_table :codesecure_projects do |t|
      t.string :name
      t.string :lang

      t.timestamps
    end
  end

  def self.down
    drop_table :codesecure_projects
  end
end

class CreateTstDefinitions < ActiveRecord::Migration
  def self.up
    create_table :tst_definitions do |t|
      t.string :test_name

      t.timestamps
    end
  end

  def self.down
    drop_table :tst_definitions
  end
end

class CreateCodesecureProjectsTstDefinitions < ActiveRecord::Migration
  def self.up
    create_table :codesecure_projects_tst_definitions do |t|
      t.references :codesecure_project
      t.references :tst_definition

      t.timestamps
    end
  end

  def self.down
    drop_table :codesecure_projects_tst_definitions
  end
end 
```

The relevant parts of the models:

```
class TstDefinition < ActiveRecord::Base
  has_and_belongs_to_many :codesecure_projects
  has_many :tst_datas 

class CodesecureProject < ActiveRecord::Base
  has_many :input_abstractions
  has_and_belongs_to_many :tst_definitions 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T09:09:02.003

经过一番搜索，我实际上找到了答案，感谢这篇博文[http://jimcortez.com/blog/?p=9](http://jimcortez.com/blog/?p=9)。我只需要从 codesecure_projects_tst_definitions 表中删除 id 列。所以迁移现在看起来像这样：

```
class CreateCodesecureProjectsTstDefinitions < ActiveRecord::Migration
  def self.up
    create_table :codesecure_projects_tst_definitions, :id => false do |t|
      t.references :codesecure_project
      t.references :tst_definition

      t.timestamps
    end
  end

  def self.down
    drop_table :codesecure_projects_tst_definitions
  end
end 
```

# binary - 从有符号数中提取位域

> ID：258131
> 
> 赞同：1
> 
> 时间：2008-11-03T08:29:33.160
> 
> 标签：binary, bit-manipulation, math, signed

我有以 32 位整数存储的有符号数字（2s 补码），我想从中提取 16 位字段。如果我从 32 位有符号数中提取低 16 位，只要原始（32 位）数适合 16 位，结果是否正确？

对于正数来说，这是微不足道的，对于负数来说似乎也是如此。但是可以证明吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T08:41:56.660

是的，在二进制补码中，符号位“一直”向左延伸。当您将带符号的 short 转换为带符号的 int 时，该数字是[“符号扩展”](http://en.wikipedia.org/wiki/Sign_extension)并且具有相同的值。

例子：[`Nibble`](http://en.wikipedia.org/wiki/Nibble)`(-2) = 1110 => Byte(-2) = 1111_1110`

显然相反，如果您捕获至少一个符号位，则该数字的值保持不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T08:46:39.163

从我（第二次）阅读您的问题来看，您似乎不需要“提取”任何位，而是需要转换整数？

即做这样的事情：

```
int negative = -4711;
short x = (short) negative; 
```

在这种情况下，编译器将确保在赋值中尽可能多地转换原始数字的精度。即使底层硬件没有使用 2:s 补码也是如此。如果是，那么这很可能只是截断，正如 Motti 所解释的那样。

# java - 在不尝试打印的情况下验证 Postscript？

> ID：258132
> 
> 赞同：6
> 
> 时间：2008-11-03T08:30:54.403
> 
> 标签：java, validation, postscript, ghostscript

在我的应用程序中将数据保存到 Postscript 会生成一个 Postscript 文件，我可以在 GhostView 中毫无问题地查看该文件，但是当我尝试打印它时，打印机无法打印它，因为它似乎无效。

有没有办法验证/查找 Postscript 文件中的错误，而无需实际将其发送到打印机？首选的是某种 Java API/库，但执行相同操作的程序也可以。

* * *

**编辑＃1**：不，我不知道它为什么无效，甚至不一定无效，但希望能够在ghostview之外验证它，或者弄清楚它无法打印时发生了什么。

* * *

**回答**： 好吧，使用 ps2ps 技巧，我能够看到 Postscript 所做的输出，并在那里检查差异。不同之处在于我不允许在 Postscript 中为图像的宽度或高度使用十进制数，而只能使用整数。所以我仍然没有找到验证的方法，但是这种方法对我的问题来说已经足够好了。谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2010-06-05T17:18:26.527

每当我需要使用 Ghostscript 验证 PostScript 文件而无需实际查看其呈现的页面图像时，我都会使用“nullpage”设备：

```
gswin32c ^
   -sDEVICE=nullpage ^
   -dNOPAUSE ^
   -dBATCH ^
   c:/path/to/file/to/be/validated.pdf-or-ps ^
   1>validated.stdout ^
   2>validated.stderr 
```

如果出现问题，将会有一个非零`%errorlevel%`集，并且`validated.stderr`日志文件将包含 Ghostscript 在渲染过程中吐出的所有消息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T08:45:16.187

知道为什么无效吗？

我的建议是将其提供给 Ghostscript/Ghostvoiew，但鉴于 Ghostview 可以查看它，似乎至少有一些解释者认为它是有效的 Postscript。

所以它可能是特定于您的打印机的东西 - 要么它对 Ghostscript 允许的 PS 中的某些东西挑剔，要么它正在访问您的打印机（可能是文件系统）上不存在的东西，或者超过了一些内存限制，或者......

关键是它可能不是一个错误的 PS 程序，因此验证它的库/API 可能无济于事

编辑：有任何打印吗？您是否尝试过来自不同制造商的打印机（或者 Postscript 解释器的供应商，无论如何）。Ghostview 是否给出/记录任何警告或错误？

文件来自哪里（什么应用程序）？

您可以生成文档的其他实例吗？（例如一个非常简单/空的，看看是否也会出错）

除非有一个 API 可以访问您的打印机中使用的特定解释器，否则我认为您**正在**针对另一个 PS 解释器（Ghostscript）对其进行验证。

由于世界上没有那么多 PS 克隆，因此访问另一个基于非 GS 的克隆可能并不容易

Edit2：此链接（如果信息很旧）提供了有关如何从打印机获取有关错误的更多详细信息的信息：[http ://www.quite.com/ps/errors.htm](http://www.quite.com/ps/errors.htm)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T09:05:33.307

如果你能在ghostview 上看到它，就意味着ghostscript 可以解析它。

因此，您可以尝试使用来打印（但不实际验证）您的文件的一个技巧是使用 ghostscript 的 postscript 输出模式（有一个调用`ps2ps`它的包装器，主要添加`-sDEVICE=pswrite`；还有`ps2ps2`which uses `-sDEVICE=ps2write`）。

# .net - .net 清单查询字符串

> ID：258133
> 
> 赞同：1
> 
> 时间：2008-11-03T08:30:54.983
> 
> 标签：.net, manifest

如何解析发送到 .NET 中应用程序清单的查询字符串（GET / POST 参数）？
从一个应用程序中，我调用`MyApp.application`它需要安装我的 .NET 应用程序（如果未安装），并且在任何情况下它都应该调用应该解析 GET 参数的应用程序。

稍后编辑：
我有一个 .NET 应用程序，应该通过 ClickOnce 安装。它已经发布在网络服务器上。应用程序的执行是通过`MyApp.application`从外部应用程序（用 PHP 编写）调用文件来完成的。这通常会检查更新并在需要时安装应用程序，然后它会调用应用程序，因此这是始终从外部应用程序调用的文件。
外部应用程序通过 GET 查询向该文件发送参数，该文件应在 .NET 应用程序中处理（参数包括凭据信息，因为这是实现自动登录的最简单方法）。
如果将 GET 参数发送到`MyApp.application`，我如何在`MyApp.cs`每次启动时处理它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T08:57:10.030

首先，您需要确保启用查询字符串选项（项目属性=>publish=>options=>manifests=>allow url parameters...）；

然后 - 为了允许独立和网络之间的平等，我使用了类似下面的东西（重要的是`ActivationArguments.ActivationData`; 你也需要参考`System.Deployment.dll`）。

你也可以看看`System.Deployment.Application.ApplicationDeployment.CurrentDeployment.ActivationUri`，MSDN 有一个很好的[例子](http://msdn.microsoft.com/en-us/library/system.deployment.application.applicationdeployment.activationuri.aspx)。

* * *

```
 public static string[] GetStartupArguments() {
        List<string> allOptions = new List<string>();
        try // command line
        {
            string[] options = System.Environment.GetCommandLineArgs();
            if (options != null) { // strip the first (the exe name)
                int length = options.Length;
                for (int i = 1; i < length; i++)
                    allOptions.Add(options[i]);
            }
        } catch { } // lazy swallow
        try // query string
        {
            if (System.Deployment.Application.ApplicationDeployment.IsNetworkDeployed) {
                string[] options = AppDomain.CurrentDomain.SetupInformation.ActivationArguments.ActivationData;
                if (options != null && options.Length > 0) {
                    foreach (string queryItem in new Uri(options[0]).Query.TrimStart('?').Split('&')) {
                        allOptions.Add(System.Web.HttpUtility.UrlDecode(queryItem));
                    }
                }
            }
        } catch { } // lazy swallow

        return allOptions.ToArray();
    } 
```

# sql - 关系术语：外键来源、目的地？

> ID：258134
> 
> 赞同：5
> 
> 时间：2008-11-03T08:30:56.760
> 
> 标签：sql, oracle, terminology

我正在对我们的表进行一些 FK 分析，方法是制作一个表示 FK 依赖关系的有向图，然后遍历该图。在我的代码中，我使用有向图术语来命名所有内容，但我希望在报告中添加一些更“用户友好”的内容。

在这种情况下：

```
create table t1(a varchar2(20));
alter table t1 add constraint t1_fk foreign key(a) references t2(b); 
```

t1.a 必须存在于 t2.b 中。那么，我应该在空格中使用什么词？

```
t1 is the _______ of t2.
t2 is the _______ of t1. 
```

许多TIA！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T08:44:43.270

我会说（括号之间的东西是可选的，但我会使用它们）

```
表 t1 的 [a 列] 引用表 t2 的 [b 列

```

和

```
[column b of] table t2 被 [column a of] table t1 引用

```

?

如果有的话，我还会指定删除/更新时发生的操作。

```
表 t2 的 b 列由表 t1 的 a 列引用。
删除表 t2 中的记录将删除表 t1 上的匹配记录

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T11:10:52.460

```
t1 is the parent of t2.
t2 is the child of t1. 
```

这是什么观众？如果是理解关系模式的人，那么可能会这样做。如果是非技术人员，那么通常我已经在我的建模工具（ERWin）中专门记录了关系的含义。

```
InvoiceLineItem is a part of Invoice.
Invoice has one or more InvoiceLineItems. 
```

或者：

```
User must belong to a Business.
Business has zero or more Users. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T09:58:10.517

我会说一些类似的东西

```
t1 是 t2 的主人。ID 必须在 t1 中，然后才能在 t2 中提及。
t2 是 t1 的从机。它不能引用 t1 中不存在的 ID。

```

大多数非技术人员都会非常直观地掌握主/从术语。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T10:16:13.787

您可以采用以下句子形式：

*   每个 t1 行必须恰好链接到一个 t2 行
*   每个 t2 行可以与任意数量的 t1 行链接，或者没有

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-06T17:22:15.160

在解释的场景中，我认为正确的命名应该是（从技术上讲）：
`t2`is parent of `t1`
`t1`is the child of`t2`

受约束列的表称为**子**表，而被引用列的表称为**父**表。

我个人不喜欢这个命名，在 SQL SERVER 中，当您查询`sys.foreign_keys`视图时，子表被调用`parent_object_id`，而被引用的表被调用`referenced_object_id`.. 从约束本身的角度来看，可能是正确的.. 但最后这个很混乱。

# windows-services - 调查哪个 Windows 服务正在侦听哪个 IP 和端口

> ID：258136
> 
> 赞同：17
> 
> 时间：2008-11-03T08:33:34.820
> 
> 标签：windows-services

我正在研究一个生产系统，其中有多个 Windows 服务通过 TCP/IP 套接字相互通信。我试图找出哪个可执行文件正在侦听给定机器上的哪个 IP 地址和哪个端口。

除了翻遍每个windows服务晦涩难懂的配置文件，有没有系统工具可以更方便的给我想要的细节？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2008-11-03T08:45:04.703

正如已经提到的 SysInternals（即 Microsoft）的[TCPView](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)是一个很棒的工具。但是在生产系统上你可能不允许安装额外的软件，所以我想你可能想试试 netstat.exe，它通常位于 C:\WINNT\system32\netstat.exe 。

帮助页面可用于

```
netstat -? 
```

例子是：

```
netstat -a 
```

列出所有本地 TCP 连接和侦听端口以及远程 TCP 端点。

```
netstat -o 
```

将进程 ID 添加到输出。

```
netstat -b 
```

为您提供建立此连接/端口所涉及的可执行文件的名称。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-03T08:41:37.580

[http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx](http://technet.microsoft.com/en-us/sysinternals/bb897437.aspx)

SysInternals TCPView 很棒

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T08:37:16.123

试一试。

```
netstat -abn 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T08:36:20.557

命令行 netstat 工具可能会对您有所帮助。要了解可用参数，请使用 /? 运行它：netstat /?

或者有一个更好的 GUI 替代方案：SysInternals TcpView（可从 ms 站点免费下载）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-07T12:15:06.640

谢谢大家。确实很有帮助。一位朋友还向我介绍了一个来自 DeviceLock 的名为“Active Ports”的免费软件实用程序：http: [//www.devicelock.com/freeware.html/](http://www.devicelock.com/freeware.html/)

# sql-server - SQL Server 2000 Personal Edition: SQL Query Analyzer is not appearing

> ID：258138
> 
> 赞同：0
> 
> 时间：2008-11-03T08:35:40.493
> 
> 标签：sql-server

I installed SQL server 2000 personal edition in my pc. I am now accessing it using windows authentication account. I can use the enterprise manager but when I try to access the sql query analyzer, there aint no window appearing for the query analyzer. Can someone help me on this? Thank you.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T08:40:41.903

Sounds odd. Perhaps a re-install might be needed.

Could you clarify your meaning of "there aint no window appearing for the query analyzer". What type of window, the application window, or a query window?

# c# - 关于通过优化 Linq To SQL 查询删除多个子查询（包含连接）的建议

> ID：258166
> 
> 赞同：1
> 
> 时间：2008-11-03T08:57:58.063
> 
> 标签：c#, linq-to-sql, optimization

我正在努力将全球化添加到我的产品目录中，并且我已经成功了。但是，我觉得底层 SQL 查询的性能不如预期，我可能需要一些关于如何更改我的 Linq To SQL 查询以提高效率的建议。

使用的表

**产品**包含每个产品的唯一 ID。此列称为 EntityID

**TextTranslation**包含全球化文本。此表中的列是 CultureID（字符串）、TextID（对文本的引用）、Value（实际的全球化文本）。

**文本**包含全球化文本和产品之间的映射。还有一列指示它是哪种类型的文本（如名称、描述等）

**TextType**包含文本类型的定义（id、名称和描述）。

```
var culturedTexts =
  from translation in ctx.TextTranslations
  join text in ctx.Texts on translation.TextId equals text.TextId
  where translation.CultureId == "en-EN"
  select new
  {
    text.EntityId,
    text.TextTypeId,
    translation.Value,
  };

var products =
  from p in ctx.Products
  let texts = culturedTexts.Where(i => i.EntityId == p.EntityId)
  select new Model.Product
  {
    Description = texts.Where(c => c.TextTypeId == (int)TextType.Description).SingleOrDefault().Value,
    Name = texts.Where(c => c.TextTypeId == (int)TextType.Name).SingleOrDefault().Value
  }; 
```

执行此操作时，我得到一个看起来像的查询

```
SELECT (
    SELECT [t1].[Value]
    FROM [Common].[TextTranslation] AS [t1]
    INNER JOIN [Common].[Text] AS [t2] ON [t1].[TextId] = [t2].[TextId]
    WHERE ([t2].[TextTypeId] = 2) AND ([t2].[EntityId] = [t0].[EntityId]) AND ([t1].[CultureId] = 'sv-SE')
    ) AS [Description], (
    SELECT [t3].[Value]
    FROM [Common].[TextTranslation] AS [t3]
    INNER JOIN [Common].[Text] AS [t4] ON [t3].[TextId] = [t4].[TextId]
    WHERE ([t4].[TextTypeId] = 1) AND ([t4].[EntityId] = [t0].[EntityId]) AND ([t3].[CultureId] = 'sv-SE')
    ) AS [Name]
FROM [Catalog].[Product] AS [t0] 
```

因此，LINQ 查询中的每个全球化文本（名称、描述）都有自己的子查询和关联的联接。是否有可能简化这一点并删除每个文本类型获得自己的连接和子查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T09:11:27.473

好吧，鉴于它们获得不同的 TextTypeId 值，您希望 TSQL 看起来如何？如果你做一个单一的 JOIN，你将不得不放入一个凌乱的`SELECT CASE`或类似的东西来区分类型“1”和类型“2”。

一种选择是简单地带回所有合适的行并在客户端进行最终的内存投影，但老实说，我希望 SQL 优化器无论如何都会轻松处理该 TSQL ......尤其是如果该查询达到了良好的跨度指数。

# internet-explorer - 如何在 Internet Explorer 上记录错误？

> ID：258168
> 
> 赞同：3
> 
> 时间：2008-11-03T09:00:15.063
> 
> 标签：internet-explorer, bug-tracking

我在 IE7/8 上发现了一个明显的平方错误，它通过自动化出现（顺便说一句，[仍在寻找](https://stackoverflow.com/questions/246365/how-to-manage-full-screen-in-ie-via-automation-flash-player-like)解决方法）。

所以，我试图找到一种记录这个错误的方法，但没有运气。尝试了[论坛的方式](http://groups.google.com/group/microsoft.public.internetexplorer.general/browse_thread/thread/0f8439d0751578a6#)，但现在这个网站似乎不那么活跃了。

我什至试图给[克里斯·威尔逊](http://cwilso.com/)发邮件，但老实说，我对这次尝试没有太大希望；o)

那么，有人知道在 IE 上记录错误的方法吗？

谢谢，文森特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T12:46:27.150

我认为运行这些错误列表的人正在倾听：

[http://webbugtrack.blogspot.com/search/label/IE7](http://webbugtrack.blogspot.com/search/label/IE7)

[http://css-discuss.incutio.com/?page=InternetExplorerWinBugs](http://css-discuss.incutio.com/?page=InternetExplorerWinBugs)

[http://www.positioniseverything.net/explorer.html](http://www.positioniseverything.net/explorer.html)

[http://www.gtalbot.org/BrowserBugsSection/MSIE7Bugs/](http://www.gtalbot.org/BrowserBugsSection/MSIE7Bugs/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T09:19:22.107

根据[http://blogs.msdn.com/ie/archive/2008/07/30/wanted-ie8-beta-testers.aspx](http://blogs.msdn.com/ie/archive/2008/07/30/wanted-ie8-beta-testers.aspx)：

> 目前，直接向 IE 团队提交错误的唯一方法是加入[Microsoft Connect](http://connect.microsoft.com)上的 IE8 Technical Beta 计划。

但是，该帖子还说：

> 如果您希望通过提供出色的错误报告来让 IE 变得更好，请发送电子邮件至 IESO@microsoft.com 并告诉我们一些关于您自己的信息，包括为什么您会成为一名出色的 beta 测试人员。

也许给 Chris Wilson 发电子邮件是个好主意！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T11:55:28.500

正如 Phil 所说，使用 IE 反馈系统是您最好的选择，尽管结果从“是的，感谢您的报告”到“抱歉，可能在下一个版本中”不等 ;-)

你能详细说明这个错误或提供一些代码吗？如果我们知道确切的问题，我们可能会有答案。如果我有足够的详细信息来重现它，我也很乐意在连接中为您提交错误。

# networking - 什么是监控网络活动的好工具

> ID：258172
> 
> 赞同：6
> 
> 时间：2008-11-03T09:02:26.057
> 
> 标签：networking, monitoring, snmp

我[在农村环境中经营邻里 WIFI 网络](http://maps.google.de/maps/ms?ie=UTF8&hl=de&msa=0&msid=101021148567197540440.00043fcffa4cdf06fb4bc&ll=51.791948,8.173571&spn=0.033976,0.058365&t=h&z=14)。

现在我正在寻找一个在服务器（Windows 或 Linux）上运行的监控工具，它可以跟踪带宽、正常运行时间（客户端以及 Internet 连接）等......这些信息中的大部分都是我的路由器通过 SNMP 公开的，并且接入点，因此需要 SNMP 支持。

附加功能应该是：

*   图形数据表示
*   免费许可证

那么对我来说最好的选择是什么？

*编辑*这些是到目前为止提到的工具：

*   [MRTG](http://oss.oetiker.ch/mrtg/)
*   [穆宁](http://munin.projects.linpro.no/)
*   [纳吉奥斯](http://www.nagios.org/)
*   [泽诺斯核心](http://www.zenoss.com/product/core)
*   [顶部](http://www.ntop.org/)
*   [仙人掌](http://cacti.net/features.php)
*   [扎比克斯](http://www.zabbix.com/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T09:35:44.553

[MRTG](http://oss.oetiker.ch/mrtg/)可能是最容易设置的。如果您的路由器有 SNMP（如您所述），则设置它是一个命令：

```
cfgmaker --output=mrtg_myrouter.cfg public@1.2.3.4 
```

MRTG 适用于高带宽路由器等。这对其他数据来说不是很好（它可以强制绘制大多数东西，但设置起来有点不直观）

为了监视我喜欢[Munin](http://munin.projects.linpro.no/)的其他东西。我会再次描述它，但我不久前[在这里](https://stackoverflow.com/questions/40737/generate-disk-usage-graphscharts-with-cli-only-tools-in-linux#43733)发布了一个答案（关于绘制磁盘使用情况）。

Munin 当然可以绘制网络使用情况，并通过 SNMP 轻松提取数据（事实上，这是从基于 Windows 的服务器获取数据的推荐设置 - 在 Windows 机器上运行 SNMP 守护程序，并让 Munin 连接到此）。我想说，这些图表也比 MRG 更漂亮（显然是最重要的因素..）

[这里有一个安装MRTG](http://www.switch.ch/network/operation/statistics/geant2.html)的示例，这里有[Munin](http://munin.ping.uio.no/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-03T14:40:56.027

恕我直言，[仙人掌](http://cacti.net/)是最容易安装和使用的。

[Zabbix](http://www.zabbix.com/)很有趣，但更难使用。

这是所有网络监控工具的非常全面的列表[。](http://www.slac.stanford.edu/xorg/nmtf/nmtf-tools.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T09:21:36.253

不确定这是否适合您的使用，但许多网络托管服务提供商使用[Nagios](http://www.nagios.org/)进行网络监控

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T10:41:24.627

[Zenoss Core](http://www.zenoss.com/product/core)是免费和开源的。它保留 RRD 图（就像这里提到的其他监控工具一样）。要监控基本网络带宽（和启动状态）以外的参数，交换机或路由器的 SNMP 定义和 MIB 应作为[ZenPack](http://www.zenoss.com/community/projects/zenpacks/)提供。在 Linux（虚拟？）服务器上运行。使用谷歌地图显示链接状态。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T13:59:10.390

我一直在使用[ntop](http://www.ntop.org/)，它在 linux 上是免费的，如果你想要一个 Windows 二进制文件并且对我们来说工作得很好，可以购买

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-01T10:50:46.727

上周我有同样的问题并尝试了几个选项。

对于基本的 snmp 绘图需求，**cacti**很棒，但我认为绘制 apache、mysql 等有点太难了。

**ntop**也是一个不错的工具，但与列表中的其他用例不同。

你应该看看**芝诺斯**。Core 版本是 FOSS，用户友好且非常强大。我不需要企业版，但您的需求可能会有所不同。它对所有基本统计数据进行绘图、监控和警报，但下载一些 ZenPacks，您可以轻松添加 Apache、MySQL 或许多其他统计数据。所有配置都可以通过 GUI 完成。界面清晰且响应迅速，可轻松管理超大型网络。

简而言之，我很高兴我从来没有花太多时间在**Nagios**上，因为我相信 Zenoss 是最好的选择。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-05-13T08:59:53.387

还可以考虑虚拟机或小型服务器上的 CactiEZ，它是基于 CentOS 6 的裸机系统[。](http://cactiez.cactiusers.org/)

# sql - 查看选定的列

> ID：258173
> 
> 赞同：0
> 
> 时间：2008-11-03T09:03:34.883
> 
> 标签：sql, vb.net, datagridview, dataview

我正在为一个类在 VB 中进行 .NET 3.5 编程。我有一个带有 3 个相关表的 .mdb 数据库，以及一个带有一些查询的表适配器，如下所示：

```
SELECT     PropertyID, Street, Unit, City, Zip, Type, Bedrooms, Bathrooms, Area, MonthlyRent
FROM         tblProperties 
```

然后在一个表单中我有一个 DataGridView。我想要做的是获取从查询返回的数据并将其显示在 DGV 中。但是，当我这样做时，它会显示数据库中的所有 35 列，而不是我选择的 10 列（这 10 列是唯一有数据的列……所以它基本上是一个带有一堆空白列的表）。

我当前的不优雅的解决方案是将查询返回到 DataTable，然后遍历表的列，删除我不想要的列。这不健壮、高效，而且不喜欢我删除主键列。

我的 TA 建议尝试使用无类型数据绑定……他说这应该只显示我提取的数据，但我们都还没能弄清楚这一点。

谢谢你！

更新

我不确定 .aspx/.aspx.vb 页面是什么意思，但这是我从表适配器获得的查询代码

```
SELECT     tblRent.PaymentID, tblTenant.TenantName, tblProperties.Street, tblProperties.Unit, tblProperties.City, tblRent.AmountPaid, tblRent.PaymentDate, 
                      tblTenant.Telephone
FROM         ((tblProperties INNER JOIN
                      tblRent ON tblProperties.PropertyID = tblRent.PropertyID) INNER JOIN
                      tblTenant ON tblProperties.PropertyID = tblTenant.PropertyID) 
```

这是我在代码中使用它的地方：

```
Public Sub getRent()
        propView.DataSource = TblPropertiesTableAdapter.GetAllRentReceipts()
        propView.AutoResizeColumns(DataGridViewAutoSizeColumnsMode.AllCells)
        propView.ReadOnly = True
    End Sub 
```

propView 是一个 DataGridView，在加载时没有选择 DataSource

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T11:01:55.537

I'm assuming that you're using Windows forms and a `DataGridView` with `AutoGenerateColumns` turned on.

If you add you own columns only the ones that you select will appear:

```
propView.AutoGenerateColumns = false

For Each //of the columns that you want

    dim column as DataGridViewColumn = New DataGridViewColumn()
        column.DataPropertyName = "DB field name"
        column.HeaderText = "column title"

    propView.Columns.Add( column )
Next 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T11:59:27.417

如果您使用标签构建页面，您将需要页面中的以下代码...

```
<asp:GridView ID="GridView1" runat="server" DataSourceID="SqlDataSource1">
</asp:GridView>

 <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
            ConnectionString="<%$ ConnectionStrings:MY_ConnectionString %>" 
            SelectCommand="SELECT     tblRent.PaymentID, tblTenant.TenantName, tblProperties.Street, tblProperties.Unit, tblProperties.City, tblRent.AmountPaid, tblRent.PaymentDate,                       tblTenant.TelephoneFROM         ((tblProperties INNER JOIN                      tblRent ON tblProperties.PropertyID = tblRent.PropertyID) INNER JOIN                      tblTenant ON tblProperties.PropertyID = tblTenant.PropertyID)"></asp:SqlDataSource> 
```

如果您想为数据层使用代码，则可以使用以下内容...

```
 Public Class DataLayer
    Public Function GetData(ByVal query As String, ByVal params As System.Data.Common.DbParameter()) As System.Data.DataTable
        Dim dt As New System.Data.DataTable
        Dim constr As String = System.Configuration.ConfigurationManager.ConnectionStrings("constr").ConnectionString()
        Using cnObject As New System.Data.SqlClient.SqlConnection(constr)
            Using cmd As New System.Data.SqlClient.SqlCommand(query, cnObject)
                If Not params Is Nothing Then
                    For Each param In params
                        cmd.Parameters.Add(param)
                    Next
                End If
                Using da As New System.Data.SqlClient.SqlDataAdapter(cmd)
                    da.Fill(dt)
                    Return dt
                End Using
            End Using
        End Using
    End Function
End Class 
```

如果您使用的是 OLEDB 连接，则可以按如下方式更改此功能（这意味着您只需更改一个功能即可更新应用程序中的每次使用 - 很好）

```
 Public Function GetDataOLE(ByVal query As String, ByVal params As System.Data.Common.DbParameter()) As System.Data.DataTable
        Dim dt As New System.Data.DataTable
        Dim constr As String = System.Configuration.ConfigurationManager.ConnectionStrings("constr").ConnectionString()
        Using cnObject As New System.Data.OleDb.OleDbConnection(constr)
            Using cmd As New System.Data.OleDb.OleDbCommand(query, cnObject)
                If Not params Is Nothing Then
                    For Each param In params
                        cmd.Parameters.Add(param)
                    Next
                End If
                Using da As New System.Data.OleDb.OleDbDataAdapter(cmd)
                    da.Fill(dt)
                    Return dt
                End Using
            End Using
        End Using
    End Function 
```

这个函数的工作原理是一个通用数据层，它将接受任何 SQL 命令并在 DataTable 中输出数据，可以简单地将其绑定到网格视图或类似视图。您可以检查“查询”是否仅选择您想要的列，但调试代码并检查数据库的 SQL 命令。

我会将它构建到一个类中，以便任何页面都可以访问它以将数据加载到数据表中。

你的代码会变成

```
Public Sub getRent()
    Dim dataLayer As New DataLayer()
    Dim sqlText As String = "<insert your query text here>"
    propView.DataSource = dataLayer.getData(sqlText, Nothing)
    propView.AutoResizeColumns(DataGridViewAutoSizeColumnsMode.AllCells)
    propView.ReadOnly = True
End Sub 
```

# apache-flex - 我可以暂停绘图以在 Flex 中执行多次连续更新吗？

> ID：258182
> 
> 赞同：2
> 
> 时间：2008-11-03T09:08:33.517
> 
> 标签：apache-flex, drawing

我编写了一个简单的日历控件来允许选择单日、周、月等。简单性来自于我自己并没有真正做任何绘图，而是选择创建一堆框和标签来充当日历的日期单元格。

选择日期或日期范围时，我需要突出显示该范围。这很容易通过遍历单元格并切换它们的样式来完成。**[编辑：]**但是，这似乎会导致延迟，在此期间首先绘制单元格，好像样式名称是空白的，然后用正确的样式重新绘制，尽管我从未明确地将样式设置为 null - - 我在“CalendarCell”和“CalendarCellSelected”之间交替。

如果这是 Windows 窗体，我会在父容器上调用 SuspendLayout，以确保仅在完成更新后重新绘制控件。我想知道的是 Flex 是否存在类似的解决方案。我想避免“手动”绘制整个日历，可以这么说，如果可能的话。

**编辑：**更改了问题描述以更准确地反映我所看到的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T13:50:39.720

你在使用 callLater() 吗？

如果您使用 callLater() 它可能会改善您的视觉效果，因为它会批量更改，直到它需要绘制一个框架，或者您使用 validateNow() 或类似方法强制绘制一个框架。在你的情况下可能就足够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T11:39:20.327

这可能不是您正在寻找的内容，但 Adob​​e 的 David Coletta 发布[了一段视频，解释了他们在 Buzzword 中使用的 EventCoalescer](http://www.colettas.org/?p=237)，用于推迟更新应用程序 UI 特定区域的事件，直到用户停止将插入点移入文本，例如。

[Hans Van de Velde 的这篇博文](http://www.novio.be/blog/?p=340) 也有类似的解决方案，以及它的实际代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-05T01:43:27.067

你的日历控件是 UIComponent 吗？是否使用标准的失效方法，如 commitProperties()、updateDisplayList() 等？

您可能想要做的是保留将更改其样式的单元格的私有数组，然后在您的 commitProperties() 覆盖中进行实际的样式切换。我只是不确定 setStyle() 是否会触发 validateNow() 因为闪烁有点令人惊讶。

# asp.net - 如何在 Visual Studio 2005 中添加 Silverlight 控件

> ID：258189
> 
> 赞同：0
> 
> 时间：2008-11-03T09:15:36.997
> 
> 标签：asp.net, silverlight

我已经从这个[http://www.microsoft.com/silverlight/下载了银灯](http://www.microsoft.com/silverlight//)

我需要在我的 Visual Studio 中将其用作自定义工具箱，请让我知道如何添加它并使用控件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-03T09:42:19.580

这篇[文章](https://stackoverflow.com/questions/143281/silverlight-controls-in-aspnet-application#143317)可能会对你有所帮助。这实际上会将您带到我之前回答的帖子。只需转到答案部分并单击链接。

# c# - 如何从 7z 命令行进程中获取扩展的错误信息

> ID：258198
> 
> 赞同：2
> 
> 时间：2008-11-03T09:20:35.817
> 
> 标签：c#, 7zip

在我的 C# 应用程序中，我运行一个 7z 进程以将存档提取到它的目录中

例如，存档位于 %TEMP% 目录上的随机命名目录中

> C:\Documents and Settings\User\Local Settings\Temp\vtugoyrc.fd2

(fullPathFilename = "C:\Documents and Settings\User\Local Settings\Temp\vtugoyrc.fd2\xxx.7z")

我的代码是：

```
sevenZipProcessInfo.FileName = SEVEN_ZIP_EXECUTABLE_PATH;
sevenZipProcessInfo.Arguments = "x " + fullPathFilename;
sevenZipProcessInfo.WindowStyle = ProcessWindowStyle.Hidden;
sevenZipProcessInfo.UseShellExecute = true;
sevenZipProcessInfo.WorkingDirectory = Path.GetDirectoryName(fullPathFilename);
Process sevenZipProcess = Process.Start(sevenZipProcessInfo);
if (sevenZipProcess != null)
{
    sevenZipProcess.WaitForExit();
    if (sevenZipProcess.ExitCode != 0)
         ...exit code is 2 (fatal error by the 7z help) 
```

我在哪里可以找到更详细的文档？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T09:28:13.150

您在这里使用 7 Zip 作为外部进程。它相当于直接从命令行调用命令。

您是否考虑过使用实际的库来压缩/解压缩文件。您可以在 C# 项目中引用的内容。

[Sharp Zip Lib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)相当有名，但这里有一个特定的[包装库](http://innerlimit.googlepages.com/sevenzipinterface)，用于使用 7zip 存档

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T11:02:06.720

Assuming that the process writes errors to stderr/stdout, you could set UseShellExecute to false, and redirect stdout/stderr; there is an example on MSDN [here](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandarderror.aspx) (stderr) and [here](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardoutput.aspx) (stdout).

If you need to read from both stderr **and** stdout, **and** use `WaitForExit()`, then things get more interesting - usually involving either a few threads, or async methods.

One other final option is to use pipe redirection in the command - i.e. `1>out.txt 2>&1` - this pipes stdout into out.txt, and pipes stderr into stdout, so this *also* goes into out.txt. Then read from `out.txt`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T13:52:38.890

感谢所有帮助。

无论如何，问题是使用 'long-path-name' -> 命令行进程找不到 C:\Documents and Settings\ （因为名称中的空格）。可以在此处找到解决方案[在.net 中转换为短路径的标准方法](https://stackoverflow.com/questions/258367/standard-way-to-convert-to-long-path-in-net)

# visual-studio - 如何撤销前雇员在 TFS 中的签出

> ID：258202
> 
> 赞同：6
> 
> 时间：2008-11-03T09:24:24.030
> 
> 标签：visual-studio, version-control, tfs, active-directory

在我们的 TFS 源代码控制服务器上，很多源文件被人检出，不再使用。

有没有一种中央方式可以撤销对 TFS 中所有文件的签出？

我什至不确定它们是否存在于 Active Directory 中。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-03T12:22:26.420

最好的办法是使用命令行工具 (tf.exe) 或 Atrice 的[TFS Sidekicks](http://www.attrice.info/cm/tfs/)删除他们的工作区。

当它发生在我身上时，请参阅以下关于该主题的博客文章，并详细说明了命令行版本：

[http://www.woodwardweb.com/vsts/unlocking_files.html](http://www.woodwardweb.com/vsts/unlocking_files.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-03T09:48:38.553

有命令行工具可以做到这一点。

但是，我发现[Sidekicks](http://www.attrice.info/cm/tfs/)工具更易于使用（它免费且稳定。）

您可以轻松撤消签出。那里还有更多值得安装的东西。

# .net - 当我遍历字典（.NET 通用数据结构）时，它的顺序是否与我添加它们的顺序相同？

> ID：258204
> 
> 赞同：9
> 
> 时间：2008-11-03T09:26:34.433
> 
> 标签：.net, data-structures, dictionary

我有一个字典，我通常用一个键访问，所以我需要快速随机访问读取。但是，对于一个功能，我需要处理字典中顺序很重要的每个项目。它似乎在测试中工作正常。依赖字典中项目的顺序可以吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T09:37:04.443

不可以。如果您需要保留订单，您还应该有一份商品清单。您可以将所需的所有操作封装在您自己的集合类中，这将同时更新字典和列表。

不幸的是，.NET 本身没有支持它的字典——这是一个相当常见的请求——Java 确实如此，就像[LinkedHashMap](http://java.sun.com/javase/6/docs/api/java/util/LinkedHashMap.html)一样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-05-24T15:49:06.920

您绝对不能依赖 Dictionary<> 按您添加它们的顺序返回结果 - 正如文档所述。

在测试中， Dictionary<> 似乎总是以它们添加的相同顺序枚举 KeyValuePairs<>。但是， Dictionary<> 的 Mono 实现没有。Mono 在实现行为时遵循文档，我假设他们看到了文档的那部分，然后以某种不维护顺序的方式实现。

另一种选择是使用 OrderedDictionary，*它将*保持顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T09:41:21.923

`tpower`,`Dictionary`并且`SortedDictionary`非常相似，因为它们都拥有一组对象，可以通过键访问。它们的不同之处在于它们的内部构建方式。

`Dictionary`据我所知，插入速度更快，而`SortedDictionary`建立在二叉树搜索算法之上，读取速度更快。

但是，在这两种情况下，内部顺序都是由键顺序维护的。无法保证您遍历整个集合的顺序与您插入项目的顺序相同。

在这种情况下，您可能需要同时存储列表和字典以满足您的不同需求。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-03T09:30:11.837

不。如果你想保持你的密钥井井有条，你最好使用[SortedDictionary 。](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)

编辑：或者，如果您想跟踪添加项目的顺序，请将您的密钥添加到链接列表中。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-11-03T11:31:54.447

该文档明确指出“出于枚举的目的，字典中的每个项目都被视为表示值及其键的 KeyValuePair<(Of <(TKey, TValue>)>) 结构。**返回项目的顺序是未定义**。” 但我不相信。

在我执行的所有测试中，项目总是按插入排序。

我发现这很奇怪，因为我还测试了 HashMap 和 LinkedHashMap（在 Java 中），并且 HashMap 中的顺序与预期**的不正确**，但是就像 Jon Skeet 所说的那样，LinkedHashMap 中的顺序是正确的。

任何人都可以用字典指出失败测试吗？

这是我用来测试的代码：

```
 IDictionary<string, int> dic = new Dictionary<string, int>(10);

        Console.WriteLine("Adding ...");
        for (int i = 0; i < 1000000; i++)
        {
            Guid guid = Guid.NewGuid();
            dic.Add(guid.ToString(), i);
        }
        Console.WriteLine("Testing ...");

        bool first = true;
        int lastItem = 0;
        foreach (var item in dic.Values)
        {
            if (first)
            {
                first = false;
            }
            else
            {
                if (lastItem != item - 1)
                {
                    Console.WriteLine("Test Failed !");
                    break;
                }

            }
            lastItem = item;
        }
        Console.WriteLine("Done."); 
```

# linux - 如何正确处理 bash shell 脚本中的通配符扩展？

> ID：258211
> 
> 赞同：3
> 
> 时间：2008-11-03T09:31:28.637
> 
> 标签：linux, bash, unix, shell

```
#!/bin/bash

hello()
{
    SRC=$1
    DEST=$2

    for IP in `cat /opt/ankit/configs/machine.configs` ; do
        echo $SRC | grep '*' > /dev/null
        if test `echo $?` -eq 0 ; then
            for STAR in $SRC ; do
                echo -en "$IP"
                echo -en "\n\t ARG1=$STAR ARG2=$2\n\n"
            done
        else
            echo -en "$IP"
            echo -en "\n\t ARG1=$SRC ARG2=$DEST\n\n"
        fi
    done
}

hello $1 $2 
```

以上是我提供源（SRC）和目标（DEST）路径的shell脚本。当我没有使用通配符“ *”放入 SRC 路径时，它工作正常。当我运行这个 shell 脚本并给出 '* '.pdf 或 '*' 时，如下所示：

```
root@ankit1:~/as_prac# ./test.sh /home/dev/Examples/*.pdf /ankit_test/as 
```

我得到以下输出：

```
192.168.1.6
ARG1=/home/dev/Examples/case_Contact.pdf ARG2=/home/dev/Examples/case_howard_county_library.pdf 
```

DEST 是 /ankit_test/as 但 DEST 也由于“*”而被操纵。预期的答案是

```
ARG1=/home/dev/Examples/case_Contact.pdf ARG2=/ankit_test/as 
```

所以，如果你明白我在做什么，请帮我解决这个BUG。我会很感激你的。

提前致谢！！！

我需要确切地知道如何在我的程序中一一使用'*.pdf'而不会干扰 DEST。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T10:40:11.617

Your script needs more work. Even after escaping the wildcard, you won't get your expected answer. You will get:

```
ARG1=/home/dev/Examples/*.pdf ARG2=/ankit__test/as 
```

Try the following instead:

```
for IP in `cat /opt/ankit/configs/machine.configs`
do
    for i in $SRC
    do
        echo -en "$IP"
        echo -en "\n\t ARG1=$i ARG2=$DEST\n\n"
    done
done 
```

Run it like this:

```
root@ankit1:~/as_prac# ./test.sh "/home/dev/Examples/*.pdf" /ankit__test/as 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T09:47:29.243

除非您将通配符转义，否则 shell 将扩展通配符，例如，如果您有

```
$ ls
one.pdf two.pdf three.pdf 
```

并运行你的脚本

```
./test.sh *.pdf /ankit__test/as 
```

它将与

```
./test.sh one.pdf two.pdf three.pdf /ankit__test/as 
```

这不是您所期望的。正在做

```
./test.sh \*.pdf /ankit__test/as 
```

应该管用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T11:00:33.963

If you can, change the order of the parameters passed to your shell script as follows:

```
./test.sh /ankit_test/as /home/dev/Examples/*.pdf 
```

That would make your life a lot easier since the variable part moves to the end of the line. Then, the following script will do what you want:

```
#!/bin/bash
hello()
{
    SRC=$1
    DEST=$2

    for IP in `cat /opt/ankit/configs/machine.configs` ; do
        echo -en "$IP"
        echo -en "\n\t ARG1=$SRC ARG2=$DEST\n\n"
    done
}

arg2=$1
shift
while [[ "$1" != "" ]] ; do
        hello $1 $arg2
        shift
done 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T09:52:21.010

您还缺少一个最终的“完成”来关闭您的外部 for 循环。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T10:47:37.750

OK, this appears to do what you want:

```
#!/bin/bash

hello() {

  SRC=$1
  DEST=$2

   while read IP ; do
     for FILE in $SRC; do
       echo -e "$IP"
       echo -e "\tARG1=$FILE ARG2=$DEST\n"
      done
   done < /tmp/machine.configs
 }

 hello "$1" $2 
```

1.  You still need to escape any wildcard characters when you invoke the script
2.  The double quotes are necessary when you invoke the `hello` function, otherwise the mere fact of evaluating `$1` causes the wildcard to be expanded, but we don't want that to happen until `$SRC` is assigned in the function

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-05T18:44:17.753

这是我想出的：

```
#!/bin/bash

hello()
{
    # DEST will contain the last argument
    eval DEST=\$$#

    while [ $1 != $DEST ]; do
        SRC=$1

        for IP in `cat /opt/ankit/configs/machine.configs`; do
            echo -en "$IP"
            echo -en "\n\t ARG1=$SRC ARG2=$DEST\n\n"
        done

        shift || break
    done
}

hello $* 
```

我们将传入脚本获得的所有参数，而不是只向 hello() 函数传递两个参数。

在 hello() 函数中，我们首先将最后一个参数分配给 DEST 变量。然后我们遍历所有参数，将每个参数分配给 SRC，并使用 SRC 和 DEST 参数运行我们想要的任何命令。请注意，您可能需要在 $SRC 和 $DEST 周围加上引号，以防它们包含空格。当 SRC 与 DEST 相同时，我们停止循环，因为这意味着我们已经到达了最后一个参数（目的地）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-08-02T15:29:58.550

对于使用诸如 *.txt 之类的通配符的多个输入文件，我发现它工作得很好，不需要转义。它应该像“ls”或“rm”这样的本机 bash 应用程序一样工作。这几乎没有记录在任何地方，所以因为我花了 3 天的大部分时间试图弄清楚我决定我应该将它发布给未来的读者。

目录包含以下文件（ls 的输出）

```
file1.txt file2.txt file3.txt 
```

像这样运行脚本

```
$ ./script.sh *.txt 
```

甚至喜欢

```
$ ./script.sh file{1..3}.txt 
```

剧本

```
#!/bin/bash

# store default IFS, we need to temporarily change this
sfi=$IFS

#set IFS to $'\n\' - new line
IFS=$'\n'

if [[ -z $@ ]]
  then
  echo "Error: Missing required argument"
  echo
  exit 1
fi

# Put the file glob into an array
file=("$@")

# Now loop through them
for (( i=0 ; i < ${#file[*]} ; i++ ));
do

  if [ -w ${file[$i]} ]; then
     echo ${file[$i]} "  writable" 
  else
     echo ${file[$i]} " NOT writable"
  fi
done

# Reset IFS to its default value
IFS=$sfi 
```

输出

```
file1.txt writable
file2.txt writable
file3.txt writable 
```

关键是暂时切换 IFS（内部场分离器）。您必须确保在切换之前存储它，然后在完成后将其切换回来，如上所示。

现在您在 file[] 数组中有一个扩展文件列表（**带有转义的空格**），然后您可以循环遍历该列表。我喜欢这个解决方案，它是最好的、最容易编程的、对用户来说最简单的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-03T09:59:27.673

无需生成外壳即可查看`$?`变量，您可以直接评估它。

它应该只是：

```
if [ $? -eq 0 ]; then 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-04-15T15:08:57.917

你在跑步

```
./test.sh /home/dev/Examples/*.pdf /ankit_test/as 
```

并且您的交互式外壳会在脚本获取通配符之前对其进行扩展。您只需要在启动它时引用第一个参数，如

```
./test.sh "/home/dev/Examples/*.pdf" /ankit_test/as 
```

然后，在您的脚本中，在您真正想要使用通配符的任何地方引用“$SRC”（即，当您这样做时`echo $SRC`，而不是使用`echo "$SRC"`），并在您希望扩展通配符时不加引号。基本上，除非您希望解释元字符，否则请始终在可能包含 shell 元字符的事物周围加上引号。:)

# linux - 处理大量临时小文件

> ID：258212
> 
> 赞同：7
> 
> 时间：2008-11-03T09:31:34.983
> 
> 标签：linux, caching, filesystems

我有一个 Web 服务器，它保存缓存文件并将它们保存 7 天。文件名是 md5 哈希，即正好 32 个十六进制字符长，并保存在一个看起来像这样的树结构中：

```
00/
  00/
    00000ae9355e59a3d8a314a5470753d8
    .
    .
00/
  01/ 
```

你明白了。

我的问题是删除旧文件需要很长时间。我有一个每天运行的 cron 作业

```
find cache/ -mtime +7 -type f -delete 
```

这需要半天多的时间才能完成。我担心可扩展性以及这对服务器性能的影响。此外，缓存目录现在是我系统中的一个黑洞，偶尔会捕获无辜的`du`或`find`.

LRU 缓存的标准解决方案是某种堆。有没有办法将其扩展到文件系统级别？有没有其他方法可以更容易管理？

以下是我考虑过的想法：

1.  创建 7 个顶级目录，每个工作日一个，每天清空一个目录。这将缓存文件的查找时间增加了 7 倍，使得文件被覆盖时变得非常复杂，而且我不确定它会对删除时间有什么影响。
2.  将文件保存为带有名称和日期索引的 MySQL 表中的 blob。这看起来很有希望，但实际上它总是比 FS 慢得多。也许我做得不对。

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-03T09:45:18.780

当您存储文件时，请创建一个指向按日期而非名称组织的第二个目录结构的符号链接。

使用“名称”结构检索文件，使用“日期”结构删除它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T10:13:24.447

假设这是 ext2/3，您是否尝试在索引目录中添加？当您在任何特定目录中有大量文件时，删除某些内容的查找速度会非常缓慢。
使用 tune2fs -o dir_index 启用 dir_index 选项。
挂载文件系统时，请确保使用 noatime 选项，该选项会阻止操作系统更新目录的访问时间信息（仍然需要修改它们）。
查看原始帖子，您似乎只有 2 级间接文件，这意味着您可以在叶目录中拥有大量文件。当这些条目超过一百万时，您会发现搜索和更改非常缓慢。另一种方法是使用更深层次的目录，减少任何特定目录中的项目数量，从而降低搜索和更新特定目录的成本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T09:42:22.293

[Reiserfs](http://en.wikipedia.org/wiki/ReiserFS)在处理小文件方面相对有效。您是否尝试过不同的 Linux[文件系统](http://en.wikipedia.org/wiki/Comparison_of_file_systems)？我不确定删除性能 - 您可以考虑格式化 (mkfs) 作为单个文件删除的替代品。例如，您可以为每个工作日创建不同的文件系统（cache1、cache2、...）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T09:47:30.273

这个怎么样：

*   有另一个名为“ToDelete”的文件夹
*   添加新项目时，获取今天的日期并在“ToDelete”中查找名称指示当前日期的子文件夹
*   如果它不存在，请创建它
*   将符号链接添加到您在今天的文件夹中创建的项目
*   创建一个 cron 作业，该作业将转到“ToDelete”中正确日期的文件夹，并删除所有链接的文件夹。
*   删除包含所有链接的文件夹。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T09:35:37.643

在您的数据库中拥有一个使用散列作为键的表怎么样。另一个字段将是文件的名称。这样，文件可以以与日期相关的方式存储以进行快速删除，并且数据库可用于基于散列以快速方式查找该文件的位置。

# svn - 身份验证 Subversion 直写代理

> ID：258214
> 
> 赞同：5
> 
> 时间：2008-11-03T09:34:35.960
> 
> 标签：svn, authentication, proxy, mirror

从 1.5 版开始，Subversion 支持为主主存储库提供本地缓存代理。

我让从属同步，主控重播对从属的提交。到目前为止一切正常，但现在我想知道如何进行身份验证（使用[本](http://blogs.open.collab.net/svn/2007/10/yesterday-at-th.html)指南）。

当主机和从机都设置了身份验证时，从机在读取时询问用户名/密码，但在写入时都询问。

获得对从属用户透明的身份验证的方法是什么（这意味着如果它是读取或写入的，则只需要 1 个独立的身份验证）？

我正在测试：

*   Apache/2.2.3，Subversion 1.4.2 在从站 (Debian)
*   Apache/2.2.8，Subversion 1.5.1 (Ubuntu)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-15T08:36:07.090

最后通过正确配置 mod_proxy 解决了问题。一个 mod_proxy 知道它还必须代理身份验证凭据，它工作正常，用户只需输入一次用户名/密码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-05T01:21:28.250

记住密码肯定取决于您使用的svn客户端，如果您告诉它记住它为什么会再次询问您？

此外，您可能还想阅读 apache，特别是 Require 指令，它控制 HTTP 身份验证：[http ://httpd.apache.org/docs/2.2/mod/core.html#require](http://httpd.apache.org/docs/2.2/mod/core.html#require)

通常`Require valid-user`被使用

# msbuild - 从 MSBuild 任务中的解决方案输出所有文件

> ID：258218
> 
> 赞同：3
> 
> 时间：2008-11-03T09:37:01.743
> 
> 标签：msbuild

在 MSBuild 中，我想调用一个任务，该任务在特定解决方案中提取所有项目中的所有文件，并将这些文件保存在一个属性中，该属性可以传递给其他任务（用于处理等）

我在想一些事情：

```
<ParseSolutionFile SolutionFile="$(TheSolutionFile)">
  <Output TaskParameter="FilesFound" ItemName="AllFilesInSolution"/>
</ParseSolutionFile>

<Message Text="Found $(AllFilesInSolution)" /> 
```

这将输出解决方案中项目中所有文件的列表，我可以使用 AllFilesInSolution 属性作为其他分析任务的输入。这是一个已经存在的任务还是我需要自己构建它？如果我需要自己构建它，任务应该输出一个字符串数组还是 ITaskItems 或其他东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T06:04:31.283

我不知道任务，但已经有包含所有项目的属性。只需查看您的典型项目文件，您就会看到它们被添加到哪个集合中。

请注意属性**Content**、**Compile**、**Folder** ... 任何时候将文件添加到项目时，它都会被放入其中一个主要集合中，如下所示：

```
<ItemGroup>
  <Content Include="Default.aspx" />
  <Content Include="Web.config" />
</ItemGroup>
<ItemGroup>
  <Compile Include="Default.aspx.cs">
    <SubType>ASPXCodeBehind</SubType>
    <DependentUpon>Default.aspx</DependentUpon>
  </Compile>
  <Compile Include="Default.aspx.designer.cs">
    <DependentUpon>Default.aspx</DependentUpon>
  </Compile>
</ItemGroup>
<ItemGroup>
  <Folder Include="App_Data\" />
</ItemGroup> 
```

然后你可以做这样的事情来将现有属性中的值放入你的属性中（条件属性充当过滤器）：

```
<CreateItem Include="@(Content)" Condition="'%(Extension)' == '.aspx'">
    <Output TaskParameter="Include" ItemName="ViewsContent" />
</CreateItem> 
```

或者您可以手动执行（Include 属性使用现有属性 OutputPath，但它指示包含所有文件的路径）：

```
<CreateItem Include="$(OutputPath)\**\*">
  <Output TaskParameter="Include" ItemName="OutputFiles" />
</CreateItem> 
```

我在处理自定义构建任务和非常有用的东西时阅读了 MSDN MSBuild 文档中的更多详细信息。继续阅读 CreateItem 任务，您将能够更了解我在此处发布的内容。这真的很容易上手。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-28T00:12:36.453

我将以下内容用于 SSRS 项目的解决方案（不在 TFS 下构建 w/o 与安装在构建框上）。基本上，我们要求将 RDL 捆绑到构建输出中，以便我们可以将构建标记为发布。

```
<Target Name="CopyArtifactstoDropLocation">
  <CreateItem Include="$(SolutionRoot)\**\*.*">
    <Output TaskParameter="Include" ItemName="YourFilesToCopy" />
  </CreateItem>

  <Copy
    SourceFiles="@(YourFilesToCopy)"
    DestinationFiles="@(YourFilesToCopy->'$(DropLocation)\$(BuildNumber)\Release\%(RecursiveDir)%(Filename)%(Extension)')" />
</Target> 
```

只需将 Copy Task 的使用替换为您需要对包执行的任何操作。当然，这将在您的解决方案根目录中获取所有内容，但如果您使用 TFS，那么您应该只有可构建的工件。

# python - 为什么异常是可迭代的？

> ID：258228
> 
> 赞同：13
> 
> 时间：2008-11-03T09:46:03.020
> 
> 标签：python, exception

我最近被一些意想不到的东西咬了。我想做这样的事情：

```
try :
     thing.merge(iterable) # this is an iterable so I add it to the list
except TypeError :
     thing.append(iterable) # this is not iterable, so I add it 
```

好吧，它工作正常，直到我传递了一个从应该添加的 Exception 继承的对象。

不幸的是，异常是可迭代的。以下代码不会引发任何`TypeError`：

```
for x in Exception() :
    print 1 
```

有人知道为什么吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-03T15:08:02.090

请注意，发生的事情与任何类型的隐式字符串转换等无关，而是因为`Exception`该类实现了从 args 元组 ( )`___getitem__`中返回值。`ex.args`您可以通过以下事实看到这一点：您将整个字符串作为迭代中的第一个也是唯一的项目，而不是迭代字符串时得到的逐个字符的结果。

这也让我感到惊讶，但仔细想想，我猜这是出于向后兼容性的原因。Python 过去（[1.5 之前](http://www.python.org/doc/essays/stdexceptions.html)）缺少当前的异常类层次结构。相反，字符串被抛出，（通常）一个元组参数用于应该传递给处理块的任何细节，即：

```
try:
    raise "something failed", (42, "some other details")
except "something failed", args:
    errCode, msg = args
    print "something failed.  error code %d: %s" % (errCode, msg) 
```

看起来这种行为是为了避免破坏需要参数元组而不是不可迭代的异常对象的 1.5 之前的代码。[在上面链接](http://www.python.org/doc/essays/stdexceptions.html)`IOError`的致命破损部分中有几个例子

字符串异常已经被弃用了一段时间，并且在 Python 3 中消失了。异常对象在 Python 3 中不再是可迭代的：

```
>>> list(Exception("test"))
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'Exception' object is not iterable 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T09:47:35.107

无效。检查布赖恩 anwser。

好的，我刚刚得到它：

```
for x in Exception("test") :
    print x
   ....:     
   ....:     
test 
```

不要打扰;-)

无论如何，很高兴知道。

编辑：查看评论，我想添加一些解释。

异常包含您在实例化期间传递给的消息：

```
raise Exception("test") 

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
Exception: test 
```

公平地说，消息是最好的定义异常的原因，所以 str() 返回它：

```
print Exception("test") 
test 
```

现在，当在除异常上下文之外的其他内容中使用时，异常会隐式转换为字符串。

所以当我这样做时：

```
for x in Exception("test") :
    print x 
```

我正在迭代字符串“test”。

当我这样做时：

```
for x in Exception() :
    print x 
```

我确实迭代了一个空字符串。棘手。因为当涉及到我的问题时：

```
try :
    thing.merge(ExceptionLikeObject)
except TypeError :
    ... 
```

这不会引发任何问题，因为 ExceptionLikeObject 被视为字符串。

现在好了，我们知道如何，但我仍然不知道为什么。也许内置的 Exception 继承自内置的 String ？因为据我所知：

*   添加**str**不会使任何对象可迭代。
*   **我通过覆盖iter**绕过了这个问题，使它引发了 TypeError ！

不再是问题，但仍然是一个谜。

# sqlite - Sqlite 优化：只读场景

> ID：258230
> 
> 赞同：4
> 
> 时间：2008-11-03T09:47:00.850
> 
> 标签：sqlite, windows-mobile, compact-framework

我将 SQLite 用于桌面和 PDA 上的许多应用程序。大多数操作都是只读的，因为 SQLite 在我的应用程序中用作参考资料的数据存储。

基本上，我正在寻找有关在您知道对数据的访问是只读的情况下提高性能的建议。

也许通过各种编译指示设置？ETC...

SQLite 性能非常好，但是在 PDA 上，当您有多个数据库时，我可以看到性能受到很小的影响。我不认为这是 SQLite 的问题，只是 PDA 速度的现实。但是，话虽如此，也许有办法改进它。

* * *

很好的建议，而且说得很好。我希望能更具体地告诉引擎我在做什么。例如，告诉引擎不会对数据库进行多次写入，或者以某种方式修改缓存处理。

但是，我很高兴您将数据库的“设计”方面作为一个主要问题引起了人们的注意。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T12:45:10.727

标准数据库性能提示仍然适用：

*   确保您的查询使用索引而不是全表扫描
*   在查询中尽可能有选择性，这样您就不会从数据库中提取不需要的行
*   仅选择所需的列

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-12-23T00:23:42.393

带有标志 SQLITE_OPEN_READONLY 的 sqlite3_open_v2() 改变了 SQLite 处理机会锁的方式，没有真正的性能优势。如果您正在进行大量读取或根据数据库的大小使用 :memory open 选项在内存中创建数据库副本，则可以使用 pragma cache_size。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2008-11-07T13:53:51.007

您可以使用标志[SQLITE_OPEN_READONLY调用](http://sqlite.org/c3ref/c_open_create.html)[sqlite3_open_v2()](http://sqlite.org/c3ref/open.html)。我不知道 sqlite3 是否真的使用它来优化它的行为，或者只是为了在它对操作系统的开放调用上设置适当的权限。

# nhibernate - 创建 NHibernate 对象并初始化 Set

> ID：258231
> 
> 赞同：3
> 
> 时间：2008-11-03T09:47:28.867
> 
> 标签：nhibernate, orm, mapping

我有一个名为*Product*的表，我有一个表*StorageHistory*。

现在， Product 在其映射中包含对 StorageHistory 的引用

```
<set name="StorageHistories" lazy="false">
  <key column="ProductId" />
  <one-to-many class="StorageHistory" />
</set> 
```

它有效，当我从 ORM 中检索一个对象时，我得到一个空的 ISet。

让我头疼的是如何首先构造对象。当我执行以下操作时：

```
var product = new Product();
session.Save(product); 
```

product.StorageHistory 属性为 NULL，我得到 NullReferenceException。那么，如何将项目添加到该集合中，或者我应该如何将 StorageHistory 项目本身添加到数据库中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T10:03:06.387

我总是在父对象的 ctor 中执行以下操作：

历史 = 新的 HashedSet();

这涵盖了 Save() 用例。如您所述，NHibernate 涵盖了 Load()/Get() 等用例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-06T18:50:38.270

为什么不？

```
private ISet _StorageHistories;
public virtual ISet StorageHistories {
     protected set { _StorageHistories = value;}
     get { if (_StorageHistories == null) _StorageHistories = new HashSet();
           return _StorageHistories;
     }
} 
```

当然，如果您无论如何都遇到了私有的麻烦，那么您不妨将它放在构造函数中。

# visual-studio - Visual Studio 2010 或更高版本的功能区 UI？

> ID：258240
> 
> 赞同：3
> 
> 时间：2008-11-03T09:49:05.433
> 
> 标签：visual-studio, user-interface, ribbon, pdc2008

PDC2008 演示文稿之一展示了使用 WPF 构建的新 VS2010 UI（与当前测试版不同）。一些新的代码效果看起来相当不错（注释 xml 在代码编辑器中解析和样式化）。

这让我想知道微软是否会将 VS UI 更改为 Ribbon；像 Office 一样，更改可能是在没有“经典”模式的情况下强制进行的。

你会接受这样的改变吗？

从我收集到的

高级程序员：小改动，热键都一样。

中级/初级程序员：相当大的变化，每个按钮都移动了！

新程序员：上下文相关的功能区有助于强调他们可以做什么以及在哪里。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T10:04:12.767

这一切都取决于它将如何实施。
这可能是一件好事，但以防万一我希望它是可选的:)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-18T21:32:22.133

[Rico Mariani](http://channel9.msdn.com/shows/Going+Deep/Rico-Mariani-Visual-Studio-Today-Tomorrow-and-Beyond/)多次提到他不喜欢 VS 的 Ribbon，所以我认为它不会很快实施。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T10:08:55.330

如果他们这样做，我会预测开发人员的最大反弹将会发生。Ribbon 是 File 菜单的一个伟大进化，但它并不能解决所有问题，而且对于像 VS 这样的应用程序来说，它还不够成熟。

老实说，我相信这样的举动会让许多开发人员转向[SharpDevelop](http://www.icsharpcode.net/OpenSource/SD/)之类的东西。包括我。最好的做法是将功能区样式菜单设为可选，而不是默认设置。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-03T09:58:15.540

我非常喜欢 MS Office 的功能区界面，因为它非常直观，但我会讨厌 Visual Studio 的功能区界面。MS Office 是一个适合所有人的程序，所以它应该对每个人都易于使用，但 VS 是专为专家设计的应用程序。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-03T10:23:00.870

坏坏坏...我已经删除了所有存在的工具栏，以支持自定义创建的工具栏，其中包含来自各地的大约 15 个选择命令。

我不需要一条丝带把我的工作区弄得乱七八糟。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T10:11:32.423

我是功能区的忠实拥护者，但是如果他们在 VS 上实现类似功能区的 UI，如果它占用了太多的屏幕空间并让我看不到我的代码，那就太可怕了。

# django - 有人可以评论 django-wapi 吗？

> ID：258243
> 
> 赞同：1
> 
> 时间：2008-11-03T09:51:33.320
> 
> 标签：django, web-services

[除了在http://fi.am/en/tag/django/2/](http://fi.am/en/tag/django/2/)找到的一些用户指南找到的一些用户指南之外，我还没有找到很多关于 WAPI 的信息。

我想知道是否有人有使用 WAPI 和 django 创建 Web api 的经验？我对这些框架似乎具有的魔力有点害怕。

在 python 中创建 web api 还有其他好的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-21T15:17:51.380

这是一个不错的 django WAPI 指南，用于构建一个 restful API： http: [//fi.am/entry/building-a-website-api-with-django-part-2a-api-aut/](http://fi.am/entry/building-a-website-api-with-django-part-2a-api-aut/)

# perl - 如何在 Perl 中使用“use base”继承子例程？

> ID：258251
> 
> 赞同：15
> 
> 时间：2008-11-03T09:58:27.503
> 
> 标签：perl, inheritance

如何在 Perl 中应用“使用基础”来继承某些基础模块的子模块？

我习惯了 C++ 继承机制，我为此搜索的所有网站都造成了更多的混乱，然后提供了帮助。我想做如下的事情：

```
#! /usr/bin/perl
#The base class to inherit from
use strict;
use warnings;

package 'TestBase';

#-------------------------------
sub tbSub
{
    my ($self, $parm) = @_;
    print "\nTestBase: $parm\n";
}

1; 
```

.

```
#! /usr/bin/perl
#The descendent class
use strict;
use warnings;

use base qw(TestBase);
sub main;
sub mySub;

#-------------------------------
#Entry point...
main();

#---code------------------------
sub main
{
    mySub(1);
    tbSub(2);
    mySub(3);
}

#-------------------------------
sub mySub
{
    my $parm = shift;
    print "\nTester: $parm\n";
} 
```

Perl 抱怨/找不到 tbSub。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-03T10:50:45.933

C++ 机制与 Perl 机制没有太大区别：要使用继承，您需要两个类：基类和继承类。但是你没有任何后代类。

您还缺少构造函数。与 C++ 不同，Perl 不会为您提供默认构造函数。

您的基类包含错误的语法错误，所以我猜您在发布之前没有尝试代码。

最后，正如 tsee 已经观察到的，你必须让 Perl 知道你想要一个函数调用还是一个方法调用。

你真正想要的看起来像这样：

```
my $foo = TestDescendent->new();
$foo->main();

package TestBase;

sub new {
   my $class = shift;
   return bless {}, $class;
}

sub tbSub
{
   my ($self, $parm) = @_;
   print "\nTestBase: $parm\n";
}

package TestDescendent;
use base 'TestBase';

sub main {
    my $self = shift;
    $self->mySub( 1 );
    $self->tbSub( 2 );
    $self->mySub( 3 );
}

sub mySub
{
    my $self = shift;
    my $parm = shift;
    print "\nTester: $parm\n";
}

1; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2008-11-03T17:10:48.567

你应该看看使用[Moose](http://search.cpan.org/dist/Moose/lib/Moose.pm)，它是 Perl5 的后现代对象系统。您可能会发现它比使用标准 Perl OO 语义更容易掌握……尤其是来自另一种 OO 语言时。

这是您问题的[驼鹿](http://moose.perl.org)版本....

```
package TestBase;
use Moose;

sub tbSub {
   my ($self, $parm) = @_;
   print "\nTestBase: $parm\n";
}

package TestDescendent;
use Moose;
extends 'TestBase';

sub main {
    my $self = shift;
    $self->mySub( 1 );
    $self->tbSub( 2 );
    $self->mySub( 3 );
}

sub mySub {
    my ($self, $parm) = @_;
    print "\nTester: $parm\n";
}

package main;
my $foo = TestDescendent->new();
$foo->main 
```

区别是......

*   构造函数自动为您创建 &
*   由“extends”命令而不是“use base”定义的继承。

所以这个例子只涵盖了 Moose 冰山一角 ;-)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T10:55:57.373

在我看来，您在这里混淆了两件事：面向对象和过程 Perl。Perl OO 有点“不同”（不是主流但可行）。

您的 TestBase.pm 模块似乎希望作为 Perl 对象（Perl oo 风格）运行，但您的 Perl 脚本希望将其作为“普通”模块访问。Perl 不像 C++ 那样工作（正如您所意识到的），因此您必须以不同的方式构建代码。请参阅 Damian Conway 的书籍以获取解释（以及比我下面的更智能的代码）。

* * *

**程序：**

```
#! /usr/bin/perl
#The module to inherit from

package TestBase;
  use strict;
  use warnings;

  use Exporter ();
  our @ISA         = qw (Exporter);
  our @EXPORT      = qw (tbSub);

#-------------------------------
sub tbSub
{
    my ($parm) = @_;
    print "\nTestBase: $parm\n";
}

1; 
```

.

```
#! /usr/bin/perl
#The descendent class
use strict;
use warnings;

use TestBase; 
sub main;
sub mySub;

#-------------------------------
#Entry point...
main();

#---code------------------------
sub main
{

    mySub(1);
    tbSub(2);
    mySub(3);
}

#-------------------------------
sub mySub
{
    my $parm = shift;
    print "\nTester: $parm\n";
} 
```

* * *

**Perl 面向对象**

```
#! /usr/bin/perl
#The base class to inherit from

package TestBase;
  use strict;
  use warnings;

#-------------------------------
sub new { my $s={ };
    return bless $s;
}
sub tbSub
{
    my ($self,$parm) = @_;
    print "\nTestBase: $parm\n";
}

1; 
```

.

```
#! /usr/bin/perl
#The descendent class
use strict;
use warnings;

use TestBase; 
sub main;
sub mySub;

#-------------------------------
#Entry point...
main();

#---code------------------------
sub main
{
    my $tb = TestBase->new();
    mySub(1);
    $tb->tbSub(2);
    mySub(3);
}

#-------------------------------
sub mySub
{
    my $parm = shift;
    print "\nTester: $parm\n";
} 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-03T12:01:26.303

作为旁注，没有什么好的理由`use base`而不是较新的.`use [parent](http://p3rl.org/parent)`

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2008-11-03T10:46:00.967

Perl 的继承继承*方法*，而不是函数。这意味着你将不得不打电话

```
main->tbSub(2); 
```

但是，您真正想要的是将该方法继承到适当的类中：

```
package Derived;
use base "TestBase";

package main;
Derived->somemethod("foo"); 
```

将当前包中的方法作为函数调用不会神奇地传入 $self 或“this”对象或类名。在内部，

```
Class->somemethod("foo") 
```

基本上最终被称为

```
Class::somemethod("Class", "foo") 
```

内部。当然，这假设 Class 有一个名为“somemethod”的子例程/方法。如果没有，将检查 Class 的超类，如果它们也没有方法“somemethod”，您将收到致命错误。（同样的逻辑适用于 $obj->method("foo")。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T21:17:40.083

OO 语法使用`->`运算符将​​消息和参数与消息的接收者分开。下面是一个简短的插图。

```
You->do_something( @params );

OR 

$you->do_something( @params );

package A;

sub do_neat_thing { 
    my ( $class_or_instance, @args ) = @_;
    my $class = ref( $class_or_instance );
    if ( $class ) {
         say "Instance of '$class' does a neat thing.";
    }
    else { 
        say "$class_or_instance does a neat thing.";
    }
}

...
package main;
A->do_neat_thing();      # A does a neat thing.
my $a_obj = A->new();
$a_obj->do_neat_thing();     # Instance of 'A' does a neat thing. 
```

# ruby-on-rails - 使用 Memcached 进行片段缓存

> ID：258264
> 
> 赞同：4
> 
> 时间：2008-11-03T10:13:12.310
> 
> 标签：ruby-on-rails, ruby, caching, memcached, fragment-caching

有没有办法在 Rails 中使用 Memcached 进行片段缓存？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-23T20:14:43.170

您可以将其添加到您的 development.rb 中，它应该像其他缓存一样进行片段缓存

```
config.action_controller.perform_caching = true
config.cache_classes = true
config.cache_store = :mem_cache_store 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T16:48:02.590

您可以在 environment.rb 中设置 fragment_cache_store

```
 ActionController::Base.cache_store = ActiveSupport::Cache::MemCacheStore.new() 
```

[http://api.rubyonrails.org/classes/ActionController/Caching.html#M000628](http://api.rubyonrails.org/classes/ActionController/Caching.html#M000628)

# .net - 安装 Visual Studio 2010 +Oslo CTP 会破坏我的 Visual Studio 08 安装吗？

> ID：258268
> 
> 赞同：7
> 
> 时间：2008-11-03T10:14:37.207
> 
> 标签：.net, windows, visual-studio

我很想试一试，但我只有我珍贵的家用机器来试一试。

我正在进行一些无法推断的重要工作，但我无法抗拒尝试新内容的冲动。

将 VS10 安装在带有 VS08 的 Vista SP1 盒子上是否会以任何方式获得 VS08 体验？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T10:17:11.430

不会。CTP 的下载是 Virtual PC Image 的形式，所以不会有任何影响。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T11:50:08.730

我会避免在您认为关键任务的机器上安装任何标记为 CTP、RC 或 beta 的东西。抵制诱惑，将其安装在虚拟机或非关键盒子中。:)

# html - 在 IE6 中，页脚被 1px 淘汰

> ID：258273
> 
> 赞同：0
> 
> 时间：2008-11-03T10:18:12.473
> 
> 标签：html, css, internet-explorer-6

这是链接：

[DAMNIE6TOHELL](http://tinyurl.com/596xva)

正如你所看到的，如果在“IE6-o-color”中查看，页脚向左移动了 1px。我正在努力寻找解决此问题的方法，我已将其缩减到最低限度的 HTML。

可能与haslayout有关吗？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T10:40:49.837

这看起来像是[IE6 1px jog](http://www.pmob.co.uk/temp/onepxjog.htm)的情况，可以通过一些不同的修复来解决。

您只想将这些修复应用到 IE6，使用您最喜欢的方法（条件注释、star html hack 等等）。你可以

*   将背景位置应用于#container_bottom

    container_bottom { 背景位置：1px 0; }

*   对 #container_bottom 应用左边距或填充

    container_bottom { margin-left:1px; }

*   或将#container_bottom 向左浮动并给它一个宽度

    container_bottom { 浮动：左；宽度：800 像素；}

其中任何一个似乎都对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T10:37:27.223

添加

```
background-position: 50% top; 
```

到 container_bottom 的 css。

它适用于 IE Developer 工具栏，但它在 IE6 虚拟机上，所以我不确定真实世界的结果

# c# - 访问被拒绝尝试在 Windows 用户临时文件夹中提取档案

> ID：258275
> 
> 赞同：0
> 
> 时间：2008-11-03T10:19:01.970
> 
> 标签：c#, process, temporary-directory, win32exception

我正在尝试对位于 Windows 用户临时目录 (C:\Documents and Settings\User\Local Settings\Temp )，在我的 c# 应用程序中使用 Process。

我认为由于“访问被拒绝”而发生的进程返回错误，因为当我挖掘 .NET 的进程对象时，我可以看到错误代码为 5 的 win32Exception。

在其他地方做同样的事情之前效果很好，所以我想这可能是我不应该做的事情？（运行一个进程以使用 %TEMP% 上的文件）也许我需要以某种方式通过安全性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T10:21:12.217

假设您使用的是常规 .NET（不是 CF/Silverlight 等）访问用户临时区域中的文件是完全可以预期的。我想知道问题是否不在于您在创建文件后不小心将文件打开，也许是不使用“使用”或类似的？

我可能不建议在使用单独的进程时使用环境变量（%TEMP% 等）；理想情况下，您将传递文件的完整路径（更少出错...），确保*引用*任何路径参数（如果有空格） - 即您的参数是 @"... ""c: \some path\whatever\tmp""..." （如果你明白我的意思）。

最后，如果要提取文件，则需要考虑现有内容。`Path.GetTempFileName()`可以用于创建单个文件占位符，但要提取存档，您可能需要创建一个目录 - guid 对此目的很方便（同时避免冲突，并记得在之后将其删除）：

```
string dir = Path.Combine(Path.GetTempPath(), Guid.NewGuid().ToString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T14:05:19.830

使用命令行 (cmd) 运行相同的进程有助于找出我的问题是我使用 long-path-name 为进程指定了路径参数。

可以在这里找到解决方案：

[在.net中转换为短路径的标准方法](https://stackoverflow.com/questions/258367/standard-way-to-convert-to-long-path-in-net)

# hibernate - 在 Hibernate 中自动生成类有什么缺点

> ID：258278
> 
> 赞同：1
> 
> 时间：2008-11-03T10:21:42.230
> 
> 标签：hibernate

我正在现有系统的新部分工作。为现有数据库自动生成 Hibernate 类的缺点是什么？

我只是认为，无论我们目前（并且有很多）设计失败，我们都会移植到系统的这个新部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T11:37:53.560

如果现有数据库的模式设计正确，Hibernate 生成/逆向工程是一个很好的起点。如果没有正确使用外键和约束，Hibernate 无法猜测依赖关系。无论如何，您最终可能会为 Hibernate 编写至少几个报复规则来处理数据库特定情况，如序列。

如果您的数据库设计严重混乱，但您想使用手写语句以外的其他内容，请查看 iBatis 而不是 Hibernate。

# asp.net-mvc - 实现 Html Helper 方法的更好方法？

> ID：258280
> 
> 赞同：0
> 
> 时间：2008-11-03T10:23:37.063
> 
> 标签：asp.net-mvc, performance, html-helper

我创建了一个 html 助手

```
Html.BreadCrumb(IDictionary<string, string> crumbs) 
```

其中第一个字符串是标签，第二个字符串是 URL。助手创建所需的 html（无序列表，第一个元素、当前元素、最后一个元素、死元素和分隔符等的一些类）所有工作都很好，但我通过创建一个 stringbuilder 来做到这一点，将所有 html 抽入其中并返回stringbuilder 的内容为字符串。

我认为在这个例子中它并不重要，但是如果一个 Html 助手正在大量生产 html 怎么办？没有办法将它推送到 Response.Write 而不是 stringbuilder 吗？

或者您有任何其他问题/改进？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-04T20:58:02.353

顺便说一句，我们在 ASP.NET MVC 中有一个用于各种渲染技术的命名模式。

返回字符串的助手应该被命名为它们是什么。例如， Url.Action() 和 Html.TextBox() 返回那些确切的项目。因此，这些助手应该与 <%= %> 语法一起使用。

直接渲染到输出流的助手应该以 Render 开头。例如，Html.RenderPartial()。这些与 <% %> 语法一起使用。

使用 IDisposable 模式的助手应以 Begin/End 命名。例如，Html.BeginForm() 和 Html.EndForm()。这些也应该与 <% %> 语法一起使用。

谢谢，艾隆

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T14:27:51.877

当然可以使用 Response.Write 而不是返回字符串；有关示例，请参阅 MVC 源中 System.Web.Mvc.Ajax.Form（在 AjaxExtensions.cs 中）的源。

然后用 <% 而不是 <%= 调用帮助程序。

它会更快吗？我对此表示怀疑，但它很容易测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T11:03:52.443

只要您生成的 HTML 页面的大小合理，我认为您不会有任何性能问题。当你真正开始创建兆字节大小的页面时，你应该问自己，为什么要创建如此巨大的 HTML 文件？

# iphone - 使用 iPhone SDK 查找 SRV 记录

> ID：258284
> 
> 赞同：4
> 
> 时间：2008-11-03T10:28:08.473
> 
> 标签：iphone, objective-c, cocoa-touch, dns

如果您在 Windows 或 Mac OS X 终端中键入...

```
nslookup -type=SRV _xmpp-server._tcp.gmail.com 
```

...（例如）您将收到一堆与不同的 google 聊天服务器相关的 SRV 记录..

有没有人在这方面有任何经验，并且可能知道如何使用 iPhone SDK 服务这些信息（主机名、端口、重量、优先级）？我已经尝试过 Bonjour 课程，但还没有运气..

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-03T14:34:33.313

我相信你需要使用 DNSServiceDiscovery 框架。我没有 iPhone SDK，但 Google 搜索表明它在 iPhone 上可用。

[有关完整的 API 详细信息](https://developer.apple.com/library/mac/documentation/networking/conceptual/dns_discovery_api/Introduction.html)，请参阅 Apple 开发人员站点。

我也包含了一些（不完整的）示例代码：

```
#include <dns_sd.h>

int main(int argc, char *argv[])
{
   DNSServiceRef sdRef;
   DNSServiceErrorType res;

   DNSServiceQueryRecord(
     &sdRef, 0, 0,
     "_xmpp-server._tcp.gmail.com",
     kDNSServiceType_SRV,
     kDNSServiceClass_IN,
     callback,
     NULL
  );

  DNSServiceProcessResult(sdRef);
  DNSServiceRefDeallocate(sdRef);
} 
```

您需要提供自己的回调函数，并注意`rdata`发送到回调的字段是有线格式的，因此您必须自己解码来自 SRV 记录字段的原始数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T11:58:00.570

我认为您最好的选择是使用 CFNetwork 实现 DNS 查询工具。

尝试在此处阅读有关此内容的更多信息：http: [//developer.apple.com/documentation/Networking/Conceptual/CFNetwork/Introduction/chapter_1_section_1.html#//apple_ref/doc/uid/TP30001132-CH1-DontLinkElementID_24](http://developer.apple.com/documentation/Networking/Conceptual/CFNetwork/Introduction/chapter_1_section_1.html#//apple_ref/doc/uid/TP30001132-CH1-DontLinkElementID_24)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T11:45:17.867

嗯，看起来我无法`system()`在模拟器或设备上运行。我可以`NSTask`在模拟器上运行，但不能在 iPhone 上运行，并且`NSTask`不是`Foundation`框架的一部分。

[ISC BIND](http://www.isc.org/index.pl?/sw/bind/index.php)包具有 BSD 许可证。如果可行，也许代码的相关部分`dig`可以直接包装到项目中。

# java - Java接口是抽象类吗？

> ID：258285
> 
> 赞同：13
> 
> 时间：2008-11-03T10:28:30.937
> 
> 标签：java, oop, interface, abstract-class

我正在做一些家庭作业，以前试卷上的一个问题要求命名给定 UML 图中的所有抽象类。相当简单，我想。有一个抽象类和三个接口。一般来说，这些接口是否有资格作为抽象类？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-03T10:39:52.647

问题是，虽然从技术上讲，接口可以用 Java 等语言表示为类，但我不会认为它们是类。

抽象的？当然好。班级？不。

接口不能有构造函数，属性、字段、函数体等也不能。接口不能被继承，它们是被实现的（同样，从技术上讲，实现一个接口实际上可能是用特定语言继承它，但这不是我的意思。）接口更像是“合同”，因为它们没有定义任何行为，例如类。

现在，如果这是一个家庭作业，那么你真的不应该和老师争论这些事情。只需检查您的讲义，看看您的老师对界面的定义中是否提到了“课堂”一词。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-03T10:38:00.060

所有接口[确实是抽象的](http://en.wikipedia.org/wiki/Interface_(Java))

实际上，您可以在接口中将方法声明为抽象...除了任何“checkstyle”工具会告诉您抽象关键字是多余的。所有方法都是公开的。

如果一个类实现了一个接口并且没有实现它的所有方法，那么它必须被标记为抽象的。如果一个类是抽象的，它的子类之一应该实现它的未实现的方法。

为了回应其他答案，[接口不是类](http://java.sun.com/docs/books/tutorial/java/IandI/interfaceAsType.html)。

接口是一种*引用类型*，类似于类，只能包含常量、方法签名和嵌套类型。没有方法体。接口不能被实例化——它们只能由类实现或由其他接口扩展。

接口不是类层次结构的一部分，尽管它们与类结合使用。

当您定义一个新接口时，您就是在定义一个新的引用数据类型。您可以在可以使用任何其他数据类型名称的任何地方使用接口名称。如果你定义了一个类型为接口的引用变量，你分配给它的任何对象都必须是实现该接口的类的实例

* * *

为了更好地解释为什么接口不是类，请考虑以下内容：

1/ 接口是**值**使用的**类型**

 **2/ 一个类用于对象

3/：

```
Object a = new Date();
String s = a.toString(); 
```

*   变量“a”的**类型**是 Object（它实际上是 Java 源代码中的类型表示法，表示对 Object 的*引用*），
*   但它指向的对象的**类是日期。**

类型（对象）仅影响根据编译器的类型检查哪些代码有效，*而不*影响代码实际执行的操作。

对象的类会影响代码的作用，因此第二行中的 a.toString() 调用会返回一个看起来像 Date 的字符串，而不是看起来像“java.lang.Object@XXXXXXXX”的字符串。

由于接口是一种类型，它仅用于值，不会代表对象在运行时实际会做什么。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T11:38:38.877

然而，在 Java 中，故事发生了转折——Java 中的所有接口都扩展了 java.lang.Object！尝试添加一个方法：

公共无效通知（）；

在界面中，看看会发生什么..

扩展类的接口 - 这是否使接口成为类？还是类接口？？Uhh-huh .. 猜猜这是为了防止接口覆盖 java.lang.Object 中的定义而*不得不做的黑客攻击，接口的实现无论如何都必须扩展。*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T10:31:19.340

是的，接口是隐式抽象的。在幕后查看它被编码为`.class`文件的方式。

不过，语义是一件有趣的事情。在考试条件下，“抽象类”必须从使用类声明 的`.java`源文件中编译出来。`abstract class`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T10:40:57.560

您只询问了抽象方面，但不要忘记类方面-我不会将接口称为类，因此即使接口是抽象[的（根据规范](http://java.sun.com/docs/books/jls/third_edition/html/interfaces.html#9.1.1.1)），我仍然认为它们不算数作为抽象类。虽然可能值得明确解释:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T12:58:15.940

接口包含方法的原型（即声明）而不是定义，但抽象类可以包含方法的定义和至少一个抽象方法（只有原型的方法）

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-09-30T17:00:36.023

接口用于中断对象继承。它们可以包含多个类和类层次结构的两个或多个对象。将接口视为插座插头。所有实现接口的类都需要有一个接口，就像计算机、咖啡机、通风机和冰箱需要有相同的设备来获取电源一样。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-19T03:40:41.357

抽象类看起来像接口。抽象类可以有实现，而接口不能有任何实现。

然后，有一个问题。如果抽象类只有方法签名，我们可以将它们称为接口吗？

我认为，与接口不同，抽象类是类。它们使用起来很昂贵，因为当您从抽象类继承一个类时需要进行查找。

# apache-flex - 使用 Adob e Flex 3 编译时如何跟踪应用程序版本？

> ID：258287
> 
> 赞同：2
> 
> 时间：2008-11-03T10:28:50.627
> 
> 标签：apache-flex, adobe, versioning

在 Adob​​e Flex 文件中编译 swf 文件时如何监控 swf 文件中的版本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T11:22:22.000

假设我正确理解了您的问题，您应该查看我的这篇博客文章，标题为[“使用 Flex 应用程序保存和访问版本/编译信息”](http://hasseg.org/blog/?p=165)，其中继续解释了如何使用 mxmlc 编译器中的*条件编译*功能来保存变量值到已编译的二进制文件中，然后将它们打印到应用程序本身的日志（或显示在用户界面中）。

以下是该帖子的相关片段：

```
# Compiling the binary with the conditional compilation parameter:
/path/to/mxmlc -define+=DEBUG::compiled,"Fri_Sep_12_17:26:13_on_Alis-MacBook.local" -strict=true /path/to/myApp.mxml

// Printing out the "compiled" value in the application code:
var DEBUG:Namespace = new Namespace("DEBUG");
var compiledStr:String = DEBUG::compiled;
trace("SWF was compiled: "+compiledStr); 
```

就实际的“版本号”而言，我只使用了三件事：

*   编译日期（有关如何自动执行此操作的信息，请参阅帖子中的示例脚本）
*   编译它的计算机的主机名（也在帖子中演示）
*   工作副本的 SVN 修订版（有关如何获取 SVN 修订号的信息，请参阅[我对此问题的回答）](https://stackoverflow.com/questions/56227/how-do-you-determine-the-latest-svn-revision-number-rooted-in-a-directory#249905)

# visual-studio - 部署和引用 XSLT 文件的最佳方式

> ID：258291
> 
> 赞同：3
> 
> 时间：2008-11-03T10:36:52.403
> 
> 标签：visual-studio

在 Visual Studio 项目中，我有三层，数据层、业务层和表示层。

在数据层中，我有一些将一些对象转换为电子邮件的 XSLT，一切正常，但我发现 XSLT 在构建时不会被构建/复制。

我目前在部署位置创建了一个文件夹并将 XSLT 放在那里，但我担心依赖手动过程来更新这些。

有没有人遇到过类似的问题，如果有，他们是如何解决的。

它有点改变 MSBuild 脚本以将构建工件复制到所需位置，有人有这方面的例子吗？

塔克斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T14:47:29.510

如果您使用的是 Visual Studio 2005/2008，最简单的方法是将您的 XSLT 文件包含为项目资源。

1.  打开项目的属性。
2.  选择资源选项卡。您可能会看到一个链接，上面写着“此项目不包含默认资源文件。单击此处创建一个”。继续并单击它。
3.  单击顶部附近的添加资源下拉菜单，然后选择添加现有文件。
4.  浏览到您的 XSLT 文件并选择它们。

完成此操作后，您可以通过以下方式轻松访问资源：

```
// To get the contents of the resource as a string:
string xslt = global::MyNamespace.Properties.Resources.MyXsltFile;
// To get a Stream containing the resource:
Stream xsltStream = global::MyNamespace.Properties.Resources.ResourceManager.GetStream("MyXsltFile"); 
```

如果您使用的是 Visual Studio 2003，最好的办法是将这些 XSLT 文件作为 DLL 的嵌入式资源包含在内。在 Visual Studio 中，在解决方案资源管理器中选择文件，打开“属性”窗格，然后将“构建类型”更改为“嵌入式资源”。然后，您可以使用[GetManifestResourceStream 方法](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getmanifestresourcestream.aspx)获取包含 XSLT(s) 的 Stream。要传递的名称将基于程序集的默认命名空间、包含文件的文件夹以及文件的名称。

例如，假设您的数据层程序集具有 My.DataLayer 的默认命名空间。在您的数据层项目中，您有一个名为 Templates 的文件夹，其中包含一个名为 Transform.xslt 的文件。获取 XSLT 的代码如下所示：

```
// There are numerous ways to get a reference to the Assembly ... this way works
// when called from a class that is in your data layer.  Have a look also at the
// static methods available on the Assembly class.
System.Reflection.Assembly assembly = (GetType()).Assembly;
System.IO.Stream xsltStream = assembly.GetManifestResourceStream("My.DataLayer.Templates.Transform.xslt"); 
```

有关更多信息，请查看[CodeProject 上的这篇文章](http://www.codeproject.com/KB/dotnet/embeddedresources.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T11:40:25.020

可能是一个明显的问题，但仍然需要问，您是否在项目本身中包含了包含 XSLT 的文件夹？这是一个网络或表单应用程序？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T12:08:48.990

在 VS 中，很容易设置项目中 XSLT 文件的属性以在构建时复制，默认情况下它们不会。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T14:08:45.877

我可能解释得不好。

数据层是表示层引用的类库。

在构建 DataLayer 时，我可以让 XSLT 输出到 DataLayer 的 Bin 目录。但是，当我构建和发布表示层时，它正确地抓取了 DLL 而不是 XSLT

# iphone - 如何在 iPhone 上使用 CALayer？

> ID：258292
> 
> 赞同：4
> 
> 时间：2008-11-03T10:37:15.040
> 
> 标签：iphone, core-animation

目前，我有一个 UIView 子类，它在屏幕上“标记”单个 2px x 2px CGLayerRef，最多 160 x 240 次。

我目前通过将 UIView“向上”移动 2 个像素（实际上是 UIImageView）然后绘制下一个“行”来对此进行动画处理。

使用多个 CALayer 层会加快渲染此动画的性能吗？

是否有使用 CALayer 和 iPhone SDK 的教程、示例应用程序或代码片段？

我问的原因是，我发现的大多数演示 CALayer 简单示例的代码片段都使用了不适用于 iPhone SDK 的方法调用。我感谢任何建议或指示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T12:20:38.997

好吧，如果你想要一些 CA good 的好例子，可以画出类似的东西并在手机上运行，​​我推荐 Jens Aflke 发布的[GeekGameBoard](http://mooseyard.com/Jens/2008/03/geekgameboard-getting-closer-to-iphone-ready/)代码（它是一些 Apple 演示代码的改进版本）。

根据您所描述的，我认为您正在做的事情比它需要的要复杂得多。我的印象是，您基本上想要一个静态视图，通过移动其位置使其部分离开屏幕来制作动画。如果您只需要在您的 drawRect 中设置一些静态内容，那么通过图层不会比使用您的颜色调用 CGFillRect() 更快。之后，您可以在 UIView 上使用隐式动画和动画代理来移动视图。我怀疑您甚至可以摆脱自定义 drawRect: 使用带有图案的 UIColor 的实现，但老实说，我还没有对两者之间的差异进行基准测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T11:21:30.410

您看到哪些在 iPhone 上不起作用的 CALayer 方法？除了与 CoreImage 相关的动画功能外，我还没有注意到缺少多少。您可能会注意到的一件大事是所有视图都是图层支持的（因此您不需要做任何特殊的事情来使用图层，您可以通过图层访问器方法获取 UIView 的图层），并且坐标系有一个顶部左原点。

无论如何，通常拥有更多的东西比拥有更少的东西要慢。如果您只是一遍又一遍地重复相同的模式，您可能会发现最好的性能是实现一个知道如何绘制您想要的内容的自定义 UIView/CALayer/UIColor，而不是将视觉上相同的图层或视图彼此相邻放置.

话虽如此，通常层比视图更轻，所以如果你有很多单独的元素需要保持逻辑分离，你会发现移动到层可能比使用视图更胜一筹。

您可能想查看 -[UIColor initWithPatternImage:] ，具体取决于您要执行的操作。如果您使用这两个像素图案作为背景颜色，您可以制作一个 UIColor 来绘制它并设置背景。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T12:05:00.260

*您看到哪些在 iPhone 上不起作用的 CALayer 方法？*

[作为一个例子，我尝试在此处](http://devblog.brautaset.org/2008/10/01/calayer-grid-with-caconstraintlayoutmanager/)实现网格演示，但运气不佳。它看起来像`CAConstraintLayoutManager`并且`CAConstraint`在`QuartzCore.h`.

在另一次尝试中，我尝试了一个非常简单的 20x20 小`CALayer`对象作为我`UIView`的 layer 属性的子层，但没有出现。

现在，我有一个习惯`UIView`，我覆盖了该`drawRect`方法。在`drawRect`我抓取一个上下文并渲染两种类型的`CGLayerRef`s：

在“关闭”单元格处，我在整个 320x480 画布上绘制背景颜色。

在“on”单元格`CGLayerRef`处，我在 320x480 像素的网格（初始化）或 320x2 的行（动画）上绘制一个。

在动画过程中，我`UIImageView`从 320x478 像素制作了一个剪辑视图，并绘制了一行。这一次将我的位图“推”到屏幕上两个像素。

基本上，我想测试 using 是否`CALayer`会完成两件事：

1.  让我的渲染速度更快，如果`CALayer`开销比我现在做的少
2.  让我在屏幕上平滑过渡一个图层，让我的动画更流畅

不幸的是，我目前似乎无法让基本的 CALayer 工作，也没有找到大量示例代码可供查看和使用。

# python - Django 模型 - 如何过滤 ForeignKey 对象的数量

> ID：258296
> 
> 赞同：50
> 
> 时间：2008-11-03T10:38:54.897
> 
> 标签：python, django, database-design

我有一个模型`A`，`B`就像这样：

```
class A(models.Model):
  title = models.CharField(max_length=20)
  (...)

class B(models.Model):
  date = models.DateTimeField(auto_now_add=True)
  (...)
  a = models.ForeignKey(A) 
```

现在我有一些`A`和`B`对象，我想得到一个查询，选择所有指向它们的`A`对象少于 2 。`B`

A 类似于池的东西，用户（B）加入池。如果只有 1 或 0 加入，则根本不应该显示池。

这样的模型设计有可能吗？还是我应该稍微修改一下？

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2011-06-01T17:30:34.490

问题和选择的答案来自 2008 年，从那时起，此功能已集成到 django 框架中。由于这是“django filter foreign key count”的热门谷歌点击，我想使用最近的 django 版本添加一个更简单的解决方案[Aggregation](https://docs.djangoproject.com/en/dev/topics/db/aggregation/ "聚合")。

```
from django.db.models import Count
cats = A.objects.annotate(num_b=Count('b')).filter(num_b__lt=2) 
```

就我而言，我不得不将这个概念更进一步。我的“B”对象有一个名为 is_available 的布尔字段，我只想返回具有超过 0 个 B 对象且 is_available 设置为 True 的 A 对象。

```
A.objects.filter(B__is_available=True).annotate(num_b=Count('b')).filter(num_b__gt=0).order_by('-num_items') 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-03T10:47:39.417

听起来像是一份工作[`extra`](http://docs.djangoproject.com/en/dev/ref/models/querysets/#extra-select-none-where-none-params-none-tables-none-order-by-none-select-params-none)。

```
A.objects.extra(
    select={
        'b_count': 'SELECT COUNT(*) FROM yourapp_b WHERE yourapp_b.a_id = yourapp_a.id',
    },
    where=['b_count < 2']
) 
```

如果 B 计数是您经常需要作为过滤或排序标准的东西，或者需要显示在列表视图上，您​​可以考虑通过向 A 模型添加 b_count 字段并在添加 B 时使用信号更新它来进行非规范化或删除：

```
from django.db import connection, transaction
from django.db.models.signals import post_delete, post_save

def update_b_count(instance, **kwargs):
    """
    Updates the B count for the A related to the given B.
    """
    if not kwargs.get('created', True) or kwargs.get('raw', False):
        return
    cursor = connection.cursor()
    cursor.execute(
        'UPDATE yourapp_a SET b_count = ('
            'SELECT COUNT(*) FROM yourapp_b '
            'WHERE yourapp_b.a_id = yourapp_a.id'
        ') '
        'WHERE id = %s', [instance.a_id])
    transaction.commit_unless_managed()

post_save.connect(update_b_count, sender=B)
post_delete.connect(update_b_count, sender=B) 
```

另一种解决方案是在添加或删除相关 B 时管理 A 对象上的状态标志。

```
B.objects.create(a=some_a)
if some_a.hidden and some_a.b_set.count() > 1:
    A.objects.filter(id=some_a.id).update(hidden=False)

...

some_a = b.a
some_b.delete()
if not some_a.hidden and some_a.b_set.count() < 2:
    A.objects.filter(id=some_a.id).update(hidden=True) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T11:00:13.417

我建议修改您的设计以在 A 上包含一些状态字段。

问题之一是“为什么？” 为什么 A 有 < 2 个 B，为什么 A 有 >= 2 个 B。是因为用户没有输入什么吗？或者是因为他们尝试过并且他们的输入有错误。还是因为 < 2 规则不适用于这种情况。

使用外键的存在或不存在将含义限制为 - 嗯 - 存在或不存在。你没有任何方式来表示“为什么？”

此外，您还有以下选择

```
[ a for a in A.objects.all() if a.b_set.count() < 2 ] 
```

这可能很昂贵，因为它确实获取了所有 A，而不是强制数据库完成这项工作。

* * *

编辑：来自评论“需要我注意用户加入/用户离开池事件”。

你不会“看”任何东西——你提供了一个 API 来满足你的需要。这是 Django 模型的核心优势。这是一种方法，在`A`类中使用显式方法。

```
class A( models.Model ):
    ....
    def addB( self, b ):
        self.b_set.add( b )
        self.changeFlags()
    def removeB( self, b ):
        self.b_set.remove( b )
        self.changeFlags()
    def changeFlags( self ):
        if self.b_set.count() < 2: self.show= NotYet
        else: self.show= ShowNow 
```

您还可以`Manager`为此定义一个特殊的，并将默认的`b_set`Manager 替换为计算引用和更新的经理`A`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-10T18:26:19.403

我认为加入或离开池可能不像列出（显示）池那样频繁。我也相信用户加入/离开操作来更新池显示状态会更有效。这样，列出和显示池将需要更少的时间，因为您只需对池对象的 SHOW_STATUS 运行单个查询。

# database - 保持密码可配置的最佳方法是什么，而不会让普通的人类读者太容易获得它们？

> ID：258299
> 
> 赞同：42
> 
> 时间：2008-11-03T10:40:18.420
> 
> 标签：database, passwords

我有一个数据库，许多不同的客户端应用程序（少量 Web 服务、一些 Java 应用程序和一些 dot net 应用程序）都连接到该数据库。并非所有这些都在 Windows 上运行（遗憾的是，否则只需为数据库连接启用 Windows 身份验证，这将成为一个简单的答案问题）。目前，密码存储在系统周围的各种配置/属性文件中。理想情况下，只有支持人员才能访问运行文件的服务器，但如果其他人获得对其中一台服务器的访问权限，他们将拥有足够的数据库权限来获得相当多的数据，就像现在这样。

那么我的问题是，保持密码可配置的最佳方法是什么，而不是让普通的人类读者太容易获得它？

**编辑**只是为了澄清，数据库服务器是 Windows Server 2003，运行 MSSQL 2005。

PS：我没有看到任何重复的问题，但如果有，请随时关闭此问题。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-03T11:07:50.767

我假设您想对不经意的观察者隐藏密码。如果他们是邪恶的、目光敏锐的观察者，可以访问其中一台连接的机器上的所有源代码，那么他们可以通过一些逆向工程来获取密码。

请记住，您不需要为每个不同的客户端使用相同的保护。几个步骤：-

1.  为访问您的数据库的不同系统创建不同的数据库帐户
2.  使用您的内置数据库 GRANT 将数据库的访问权限限制在他们需要的范围内
3.  在数据库的密码管理器类中存储三重 DES（或其他）密钥。使用它来解密属性文件中的加密值。

我们还考虑过在启动时让应用程序提示输入密码，但尚未实施，因为这似乎很痛苦，您的操作人员需要知道密码。它可能不太安全。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-07T19:18:58.290

让我们假设以下常见情况：

*   您对所有环境使用相同的代码库，并且您的代码库具有每个环境的数据库密码。

*   有权访问您的生产应用程序服务器的人员（系统管理员、配置管理员）被允许知道生产数据库密码，而其他任何人都不知道。

*   您不希望任何有权访问源代码的人知道生产密码是什么。

在这种情况下，您可以加密生产密码并将其存储在应用程序的属性文件中。在应用程序中，您可以包含一个类，该类从属性文件中读取密码并在将其传递给数据库驱动程序之前对其进行解密。但是，用于解密密码的密钥和算法不是源代码的一部分，而是在运行时作为系统属性传递给应用程序。这将密钥知识与应用程序源代码分离，任何只能访问应用程序源代码的人将不再能够解密密码，因为他们无权访问应用程序的运行时环境（应用服务器）。

如果您使用的是 Java，请查看[这个](http://heuristicexception.wordpress.com/2008/10/09/secure-your-spring-application-configuration-with-jasypt/)以获取更具体的示例。该示例使用 Spring 和 Jasypt。我相信这样的事情可以外推到其他环境，如 .Net

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-03T10:50:13.983

在我以前的工作场所，我们曾经有一个系统，所有密码都被加密（使用三重 DES 或我们当时使用的任何东西）。密码通常存储在属性文件中（这是在 Java 系统中）。

当需要更改密码时，我们可以简单地使用“！plaintext”作为值，然后我们的代码会加载它，对其进行加密，并将加密后的值存储回属性文件中。

这意味着可以在不知道原始值的情况下更改密码 - 不确定这是否是您要求的那种东西！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-03T10:51:01.797

听起来没有简单的答案（因为连接的应用程序类型不同）......真的，我看到的唯一问题是 Java 应用程序似乎直接连接到您的数据库。那是对的吗？

如果是这样，您可以执行以下操作：

1) 更改任何直接连接到数据库的客户端应用程序以通过服务。（如果他们*必须*直接连接，那么至少给他们一个从服务“获取密码”的第一步，然后他们可以直接连接）。

2) 将密码存储在 web.config 文件中（如果您选择使用 .Net Web 服务），然后加密文件的“连接字符串”部分。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-11-03T10:42:31.050

不要使用密码，服务器到服务器的身份验证通常可以通过使用密钥文件或客户端证书或密码以外的其他方式来执行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T10:48:41.723

您可以使用可逆加密算法（例如 Blowfish）来存储密码作为权宜之计。应该有许多免费库可以用来将其构建到所有需要此访问权限的程序中。

Bruce Schneier 关于[河豚的页面](http://www.schneier.com/blowfish.html)

维基百科关于[河豚的文章](http://en.wikipedia.org/wiki/Blowfish_cipher)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T11:16:53.400

对于 java 的东西，如果您使用的是应用程序服务器，请查看是否可以定义数据源，并且您的应用程序可以使用 JNDI 获取数据源。这样，管理数据源（包括连接详细信息）由应用服务器处理，您的应用程序代码要做的就是请求数据源。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-03T12:50:17.360

NTLM 身份验证或基于 LDAP (Active Directory) 的身份验证应该提供给您稍作努力。这将允许您跨应用程序使用“Windows 身份验证”。

这可能意味着您的操作人员需要进行一些迁移，但是对于一组应用程序来说，SSO 是不错的选择。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-10-18T02:46:22.367

是的，我必须同意存储（盐渍）哈希的选项。我会推荐存储在数据库中的密码的（加盐的）SHA256 哈希。也不要忘记强制执行安全密码规则。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-25T17:27:30.443

我对您的问题的解释是，您具体询问如何存储配置密码，您的代码将使用这些配置密码连接到它所依赖的服务，例如数据库或第三方 API。在这种情况下，您可能需要考虑使用提供秘密容器的服务，例如[Hashicorp 的 Vault](https://www.vaultproject.io/docs/what-is-vault)。

您可以将 Vault 视为您的应用程序可以连接到的 Web 服务，以便在应用程序运行时查找您的应用程序所需的秘密。

例如，假设您的应用程序需要连接到数据库，但您不想将数据库凭据与应用程序源代码一起存储在版本控制系统中。此外，假设您希望应用程序使用的数据库凭据在每次应用程序启动时都不同。在这种情况下，您可以在 Vault 中启用和配置数据库机密后端。这意味着保险库将动态创建您的数据库凭据作为服务，然后在一段时间内为您的应用程序提供可撤销的租用令牌。当然，保险柜将允许您在其中存储任何秘密。

Vault 为您的应用程序连接到它提供了安全的方式。一种这样的身份验证方法使用保险库中称为[Cubbyhole Secrets Engine](https://www.vaultproject.io/docs/secrets/cubbyhole)的东西。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2009-06-18T20:35:55.490

使用加密不是一个好主意。如果有人泄露了密钥，他可以解密它。使用带盐的哈希算法来存储密码。哈希算法是一种方式，因此它是不可逆的。但是它们很容易受到字典攻击，因此请使用盐（连接纯文本，其内容长而冗长，而不是散列）。它还保护数据库免受内部攻击。

# java - IE 浏览器在打开文件对话框后挂起。解决方法？

> ID：258304
> 
> 赞同：0
> 
> 时间：2008-11-03T10:43:34.527
> 
> 标签：java, applet, browser, filedialog

这是一个已注册的错误（[错误 ID：6515708](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6515708)），但有人有解决方法吗？

**设想**

*   javascript 在小程序中调用 OpenDialog() 方法
*   小程序启动新线程，打开 AWT FileDialog
*   完成时，读取文件名并调用 javascript 方法 OnDialogComplete
*   此时对话框被释放并且（仅在某些浏览器上）浏览器挂起。

我们混合了带有 IE6/7 的 XP 和带有 IE7 的 Vista，但不幸的是，该错误随机出现在其中任何一个上。

任何人的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T12:04:10.247

错误报告表明它仅在同时打开两个 FileDialogs 时发生。也许您可以检测到 Java 实现何时受到影响（1.6.2 之前），在这种情况下，使用小程序间通信方法（例如类上的静态变量）来实现互斥锁，以防止 OpenDialog() 在已经有一个 FileDialog 正在进行中？

# web-applications - MVP - Presenter 应该使用 Session 吗？

> ID：258307
> 
> 赞同：5
> 
> 时间：2008-11-03T10:44:49.220
> 
> 标签：web-applications, session, mvp

我正在为网页使用 Model-View-Presenter 模式。演示者应该知道 Session 还是应该只有视图知道它？

我想我得到的是像 Session 这样的概念与视图的体系结构非常相关，所以它们应该被限制为视图使用吗？否则，如果我想在不同架构的类似页面上重用演示者会发生什么（或者我不需要担心，除非我有计划这样做）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T12:53:34.110

我在我的 MVP 实现中正在做类似的事情，我将 ICookieManager、ISessionManager、ICacheManager、IConfigurationManager、IRedirector 注入到我的演示者中，它们由包装为此功能的类实现。

这允许演示者在其中注入这些模拟版本，并且在演示者中对 asp.net 运行时没有直接依赖关系，因此它使测试更容易。

干杯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T10:56:30.413

它甚至可以是一个共享模块，充当您正在使用的任何会话的包装器。通过这种方式，您的所有控制器都可以使用它，并且您可以简单地更改会话的物理实现。

您的演示者将使用控制器从会话中获取的任何内容填充视图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T14:50:26.947

谢谢大家的回答，总结一下。。。

我们是说实际上 Presenter*应该*能够从会话中访问数据（最好是通过接口）以及不应该访问它的视图（仍然是哑巴）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T10:53:18.500

取决于您尝试重用的对象或包含大部分业务逻辑的对象。

我假设只有演示者应该知道会话，因为该对象是 MVP 中最接近控制器的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T12:45:31.350

是的，正如鸽子所说，将访问 Session 的任何内容包装在另一个类中。

这意味着您可以注入这种类型的模拟类来模拟 Session 的不同值。

为了更具体地回答您的问题，我倾向于使用 Supervising-Presenter 模式（[http://martinfowler.com/eaaDev/SupervisingPresenter.html](http://martinfowler.com/eaaDev/SupervisingPresenter.html)），它使视图保持非常愚蠢。所以只有 Presenter 会访问 Session（虽然不是像我之前说的那样直接访问）并告诉 View 要做什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-17T21:53:25.223

我也在研究被动 MVP 方法。我在网上看到过一些事情，它们都将会话持久性留给了视图——要么通过注入，如鸽子所提到的，要么显式管理。

可以在此处查看依赖注入示例：http: [//www.codeproject.com/KB/aspnet/Advanced_MVP.aspx](http://www.codeproject.com/KB/aspnet/Advanced_MVP.aspx)和此处： http: [//geekswithblogs.net/opiesblog/archive/2006/06/30/83743.aspx](http://geekswithblogs.net/opiesblog/archive/2006/06/30/83743.aspx)。这里的技巧是在一个静态变量中管理所有会话实例，并防止它们相互覆盖。（我不确定第一个示例能否正确完成此操作。）

第二种方法在这里： [http](http://codebetter.com/blogs/jeffrey.palermo/archive/2005/03/28/128592.aspx) ://codebetter.com/blogs/jeffrey.palermo/archive/2005/03/28/128592.aspx 。在这个例子中，视图知道如何存储它的状态。缺点是每次演示者将数据放入视图时，它都必须在视图上调用 Update 方法来强制重新绑定。在上面的示例中不需要这样做，但您不需要管理会话表。我不确定这种方法如何使使用模拟工具的测试变得复杂。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-18T18:57:37.940

技巧是连接每个消耗品实体。它使演示者和模型更容易通过模拟进行测试，并将测试集中在行为上。

# jquery - Jquery改变父div的背景

> ID：258317
> 
> 赞同：12
> 
> 时间：2008-11-03T10:52:25.990
> 
> 标签：jquery, html

我的一个 html 页面中有以下代码段：

```
<div class="inputboximage">
    <div class="value2">
    <input name='address1'  value='Somewhere' type="text" size="26" maxlength="40" />
    <br />

    </div>
</div> 
```

我的问题是我需要在`inputboximage background`单击`address1`文本字段时进行更改，并在失去焦点时恢复为原始状态。

我使用了以下内容：

```
 <script>
  $(document).ready(function(){

    $("input").focus(function () {
         $(this.parentNode).css('background-image', 'url(images/curvedinputblue.gif)');
    });

    $("input").blur(function () {
    $(this.parentNode).css('background-image', 'url(images/curvedinput.gif)');
    });

  });
  </script> 
```

但它似乎没有替换图像，而是向 value2 div 添加了背景图像，正如您所期望的那样。我可以`parentNode.parentNode`在这种情况下使用，但`inputboxImage`节点也有可能在父树的上方或下方。

有没有办法可以更改此代码，以便它沿着父树导航，直到找到一个名为 div`inputboximage`并替换那里的图像？

另外，如果我有两个不同的 div 类，`inputboximage`并且`inputboximageLarge`，有没有办法修改这个函数，使其适用于两者，用不同的图像替换背景图像？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-03T10:55:39.917

我认为使用

```
$(this).parents('div.inputBoxImage').css(...) 
```

而不是`$(this.parentNode)`应该工作。

请参阅 jQuery[遍历文档](http://docs.jquery.com/Traversing/parents#expr)

编辑：根据 Prody 的回答更新（将父母更改为父母）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T11:03:05.893

我不是 100% 确定，但我认为你需要的是 Phill Sacre 的回答所建议的，除了使用`parents`（注意最后一个 s）

来自 jQuery API：

parent( String expr ) 返回 jQuery 获取一组元素，其中包含匹配的元素集的唯一父级。

parents( String expr ) 返回 jQuery 获取一组元素，其中包含匹配的元素集的唯一祖先（根元素除外）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T11:15:28.473

现在由于在 HTML 中只有 ID 是唯一的，您可以直接引用 div 而无需进行任何遍历：

```
<div class="inputboximage" id="inputboximage">
    <div class="value2">
    <input name='address1'      value='5 The Laurels' type="text" size="26" maxlength="40" />
    <br />

    </div>
</div>

<script>
  $(document).ready(function(){

    $("input").focus(function () {
         $('#inputboximage').css('background-image', 'url(images/curvedinputblue.gif)');
    });

  });
</script> 
```

请注意，虽然可以为 CSS 分类过滤父元素，但使用样式类或行为是一个坏主意 TM，您应该避免这样做。但是如果你真的很绝望，你可以试一试：

```
$("input").focus(function () {
         $(this).parents('div.inputboximage').css('background-image', 'url(images/curvedinputblue.gif)');
    }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-18T17:22:49.467

.parent().css（此处更改）

# .net - System.Drawing.Image 用于业务对象中的图像？

> ID：258327
> 
> 赞同：1
> 
> 时间：2008-11-03T10:59:51.827
> 
> 标签：.net, image, business-objects, system.drawing

我想将图像存储在业务对象中。在 MSDN 中，我看到 System.Drawing-namespace 提供了许多 GDI+ 功能等。

是否可以将 Image 存储在业务层的 System.Drawing.Image 类中（“仅”是一个类库），从而也包括对 System.Drawing 的引用？我觉得这样做有点糟糕，因为我似乎在业务代码中有特定于 UI 的引用。此外，代码可能会变得不必要地依赖于平台（尽管这只是理论上的问题，因为我们不是为多个平台开发的）。

如果不正确，哪种类型最适合？

感谢您的任何回复！

马蒂亚斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T11:34:24.580

从您的问题来看，您的业务逻辑层似乎需要以非常低级的方式处理图像（否则，我猜您只是存储图像 URL 或其他东西......）。这将图像/位图的概念直接置于业务逻辑领域，因此它完全可以依赖 System.Drawing 命名空间来实现此目的。

如果你觉得图像在类库中没有位置，[那么看看 System.Drawing 本身](http://referencesource.microsoft.com/netframework.aspx)应该会让你信服：它是类库的一个典型例子（并且是一个非常体面的设计），除了处理之外几乎什么都不做与图像。

它确实与 UI 没有任何关系（Windows.Forms 和朋友处理这些）。此外，System.Drawing 存在于任何安装了 .NET Framework 的系统上，因此不存在依赖性问题。

如果您担心跨平台兼容性，为图像创建一个包装类可以缓解这些问题。但是，由于位图结构本身很可能已经是特定于平台的（例如，除非您注意仅在外部接口上使用 PNG），因此这可能有点过分，因为您增加了复杂性而没有收获。 ..

# c# - pConsole.StartInfo.RedirectStandardOutput and pConsole.Exited event (c#)

> ID：258339
> 
> 赞同：3
> 
> 时间：2008-11-03T11:02:28.217
> 
> 标签：c#, console, process

I have a GUI application that executes (in a new process) "console" applications and parse the output. To redirect the Output i set the pConsole.StartInfo.RedirectStandardOutput to true. I also subscribes to the event pConsole.Exited.

The problem I see is that I have to use Thread.Sleep() in the Exited event handler to get the last data.

My Exited event handler looks like this:

```
Thread.Sleep(100); // Wait for additional data (if any).
pConsole.OutputDataReceived -= new System.Diagnostics.DataReceivedEventHandler(this.localTerminal_DataAvailableEvent);
int exit = pConsole.ExitCode;
pConsole.Dispose();
pConsole = null; 
```

It seems that the Exited event executes before my last pConsole_DataAvailableEvent. Anyone knows how/why this is happening?

I also use a mutex/lock to make sure my Exited event is finished before I start execute my next console application.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T18:06:58.157

问题几乎可以肯定是输出缓冲：进程退出，触发您的 Exited 事件，但一些输出数据仍在缓冲区中。您的 hack 在某些情况下可能会奏效，但其他方法可能更强大。考虑：

1) 消除 Exited 事件处理程序，而是在 OutputDataReceived 处理程序中检查 Process.HasExited。

2) 不要使用 OutputDataReceived 处理程序，而只需在 Process.StandardOutput 流上调用 Read()。流关闭后进行后处理清理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T11:31:57.190

我不知道它是否更好，但我一直在寻找类似的东西，使用线程来读取 stderr/stdout，如下所示。它涉及一些额外的线程（以避免死锁/复杂的异步代码），但似乎工作得相当稳健。

这里的关键是我`Join()`在处理 IO 的两个线程上，所以我只有在两个输出流都被完全消耗后才继续。

```
 using (Process proc = Process.Start(psi))
            {
                Thread stdErr = new Thread(DumpStream(proc.StandardError, Console.Error));
                Thread stdOut = new Thread(DumpStream(proc.StandardOutput, Console.Out));
                stdErr.Name = "stderr reader";
                stdOut.Name = "stdout reader";
                stdErr.Start();
                stdOut.Start();
                proc.WaitForExit();
                stdOut.Join();
                stdErr.Join();
                if (proc.ExitCode != 0) {...} // etc
            }

    static ThreadStart DumpStream(TextReader reader, TextWriter writer)
    {
        return (ThreadStart) delegate
         {
             string line;
             while ((line = reader.ReadLine()) != null) writer.WriteLine(line);
         };
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T11:09:44.957

I strongly suspect that it's just the operating system flushing any output buffers. It looks like your workaround is okay-ish, although obviously it's ugly (not your fault) and the length of sleep could be wastefully long in some cases and not long enough in some pathological other cases.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-01-04T09:27:53.670

除了 Marc Gravell 的回答

proc.StandardError、proc.StandardOutput 都有一个 EndOfStream 方法。这对于确定在用户输入/提示之前输出不产生换行符的情况很有用

# hibernate - Spring & Hibernate EJB 事件

> ID：258344
> 
> 赞同：1
> 
> 时间：2008-11-03T11:03:58.167
> 
> 标签：hibernate, spring, jpa, events, ejb

是否可以定义一个弹簧管理的 EJB3 休眠监听器？

我的**persistence.xml**中有这个定义：

```
<properties> 
    <property name="hibernate.ejb.interceptor"
        value="my.class.HibernateAuditInterceptor" /> 
    <property name="hibernate.ejb.event.post-update"
        value="my.class.HibernateAuditTrailEventListener" /> 
</properties> 
```

但我想管理`HibernateAuditInterceptor`和`HibernateAuditTrailEventListener`使用 spring，所以我可以在这些类中做一些 bean 注入（例如：会话范围的 bean）。这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-06-17T16:48:17.630

[http://blog.krecan.net/2009/01/24/spring-managed-hibernate-interceptor-in-jpa/](http://blog.krecan.net/2009/01/24/spring-managed-hibernate-interceptor-in-jpa/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-04T19:05:00.223

问题是这些属性只是字符串。即使您将 SessionFactory 定义为 Spring bean，您通过 hibernateProperties 设置器传递给它的任何属性也只是字符串：

```
<bean id="mySessionFactory" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
    <property name="dataSource"ref="myDataSource"/>
    <property name="mappingResources">
        <list>
            <value>whatever.hbm.xml</value>
        </list>
    </property>
    <property name="hibernateProperties">
        <value>
            hibernate.ejb.interceptor= my.class.HibernateAuditInterceptor
        </value>
        <value>
            hibernate.ejb.event.post-update=my.class.HibernateAuditTrailEventListener
        </value>
    </property>
</bean> 
```

所以我认为你不能这样做。

# ssis - How to split a column content using SSIS?

> ID：258345
> 
> 赞同：0
> 
> 时间：2008-11-03T11:07:07.133
> 
> 标签：ssis

My source data is stored as (000000000000054390-) which denotes -543.90 I need the destination as -543.90\. How this can be done using SSIS?

Thanks Arif

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T11:10:50.307

Use a Derived Column object in your Data Flow Task.

You can then do a SUBSTRING (assuming that this is a string) manipulation on your number, which can in turn be cast into its proper data type.

# visual-c++ - 如何获得焦点 CWindow 句柄？

> ID：258350
> 
> 赞同：4
> 
> 时间：2008-11-03T11:09:49.577
> 
> 标签：visual-c++, mfc

有没有办法获得具有焦点的控件的句柄？我正在寻找一种在我的应用程序中获取焦点控件 ID 的方法。

之后，使用 GetDlgCtrlID 很容易获得 id。

```
CWnd *pwnd = GetWindowOnFocus(); 
int wID = pwnd->GetDlgCtrlID(); 
```

这是我缺少的 GetWindowOnFocus 部分！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T11:17:03.897

看看静态[CWnd::GetFocus](http://msdn.microsoft.com/en-us/library/f9fd0z3x(VS.80).aspx)方法。

# css - 随时修复浏览器错误或将它们保存到最后？

> ID：258351
> 
> 赞同：3
> 
> 时间：2008-11-03T11:10:02.070
> 
> 标签：css, debugging

对于 CSS 错误，您是在开发的每个阶段出现时修复它们，还是将它们保存到最后？因为我正处于一个大型项目的早期阶段，并且似乎陷入了烦人的 IE6 错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T11:13:17.620

**我的工作流程：**

*   在 Firefox 上开发。**编辑：**尝试并处理已知的 ie6 错误 - 但不要浪费时间检查。
*   证实
*   检查 Chrome/Safari。通常没问题
*   Hack for IE7 - 通常没什么可做的。如有必要，在单独的样式表中添加 hack。
*   破解 IE6。如有必要，在单独的样式表中添加 hack。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T11:14:30.753

我发现最好在进行过程中进行测试（并修复）——这样，如果您确实发现了一个主要错误，那么（可能）需要进行更少的重写。如果您直到最后都没有抓住它，您会发现很多代码依赖于以特定（特定于浏览器）方式发生的事情。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T11:16:26.363

我倾向于尽快解决这些问题。

我的理论是在早期进行更改比在以后进行可能的设计破坏更改更容易。

我在 Firefox 中完成大部分工作，但会定期在 IE 中进行测试以确保一切正常

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-03T11:17:24.257

我倾向于保存它们；如果你按照 W3C 标准开发，你应该有一个坚实的基础。此外，您通常会及时了解 Internet Explorer 中的不同缺陷，并在开发过程中考虑这些缺陷。

最后，我喜欢先使用 Firefox 进行开发，并在过程结束时修复我在此过程中可能未修复的任何错误。

*   选择一个 DOCTYPE 并坚持下去
*   开始在 FireFox 中开发
*   使用[HTMLTidy](http://users.skynet.be/mgueury/mozilla/)或类似的插件来保持你的代码干净和闪亮
*   检查 Internet Explorer 6 和 Internet Explorer 7
*   为 IE使用 css hack 或[条件语句和样式表](http://www.quirksmode.org/css/condcom.html)
*   验证更多并进行最终检查。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T12:38:28.540

好的建议：随手测试，YUI 网格，事先扫描[IE 错误列表](http://www.positioniseverything.net/explorer.html)，不要让 browsershots.org 让你发疯......

[http://www.communitymx.com/content/article.cfm?cid=C37E0](http://www.communitymx.com/content/article.cfm?cid=C37E0)

[http://webdesign.about.com/od/internetexplorer/a/aa082906.htm](http://webdesign.about.com/od/internetexplorer/a/aa082906.htm)

[http://ask.metafilter.com/100059/Help-me-understand-what-I-need-to-make-my-website-compliant-with-IE](http://ask.metafilter.com/100059/Help-me-understand-what-I-need-to-make-my-website-compliant-with-IE)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T12:48:48.923

我也在 FF 上开发，只测试 IE 兼容性。我倾向于在开发过程中解决大问题，以便我可以验证所需的样式是否可以在所有浏览器上实现。我留下所有的小东西或稍后，即。定义边距等以实现我们想要的确切布局。稍后我不是指项目的结束，我是指站点的逻辑部分（通常是页面）的结束

# c# - 反映局部变量

> ID：258355
> 
> 赞同：0
> 
> 时间：2008-11-03T11:13:00.380
> 
> 标签：c#, debugging, reflection, logging

我正在尝试找到一种方法来自动化一些异常日志记录代码以添加到已经可用的堆栈信息中。

有什么方法可以使用反射来检索堆栈上所有变量的值（局部变量和参数） - 我真诚地怀疑变量的名称是否可用，但在许多情况下，查看这些值会很有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T11:25:23.040

并不真地。对于这种级别的挖掘，您可能需要 WinDbg 之类的东西。

如果对*特定*变量感兴趣，您可以自己将其添加到异常中（尽管即使这样也会引入重复键、重入等问题）：

```
 string dir = ...todo...
    try
    {
        // some code
    }
    catch (Exception ex)
    {
        ex.Data.Add("dir", dir);
        throw;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-27T12:04:37.540

您可以查看 John Robbins 的 SUPERASSERT ( [SUPERASSERT Goes .Net](http://msdn.microsoft.com/en-us/magazine/cc188701.aspx) )，他的书很好地介绍了一种方法来做您所追求的事情（还有更多）。

# java - Functor 和 Command 模式有什么区别？

> ID：258364
> 
> 赞同：14
> 
> 时间：2008-11-03T11:20:11.147
> 
> 标签：java, design-patterns, oop, theory, functor

我对命令模式非常熟悉，但我还不了解 Functor 和命令之间的理论区别。特别是，我正在考虑 Java 实现。两者基本上都是编程表示为对象的“动词”。然而，就仿函数而言，正如我从一些示例中看到的，匿名内部类实现似乎很常见。那里的任何人都可以很好地为我解决这个问题吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-03T11:52:36.620

仿函数是一种实现，一种使对象表现得像函数的方式。

“命令模式”是一种设计模式。
函子是实现“命令模式”的一种方式。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-03T12:44:59.383

仿函数是一个“语法级别”的概念——它将代码打包在一个对象中，可以像函数指针一样在语法上进行处理——也就是说，可以通过将参数列表放在其后面的括号中来“调用”它。在 C++ 中，您可以通过重写 operator() 使类成为仿函数。

命令模式中的命令是一个对象，它封装了一些可运行的功能，但并不要求它是函子。例如，它可以是一个实现接口 ICommand 的类，允许通过调用 Do() 来运行它的命令。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-16T19:23:33.193

这是来自[GOF](https://rads.stackoverflow.com/amzn/click/com/0201633612)的答案：

> Coplien 描述了如何在 C++ [Cop92] 中实现函子，即函数的对象。他通过重载函数调用运算符 (operator()) 实现了它们使用的一定程度的透明性。命令模式不同；它的重点是***维护接收器和函数（即动作）之间的绑定***，而不仅仅是 ***维护函数***。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-03T11:43:10.040

从[Apache Commons Functor](http://commons.apache.org/sandbox/functor/)页面的描述中：

* * *

仿函数是可以作为对象或表示单个通用函数的对象来操作的函数。

函子支持并鼓励许多强大的编程技术，包括：

*   函数式编程
*   高阶函数
*   内部迭代器
*   通过组合重用和专业化，而不是继承和重载
*   通用“回调”或“扩展点”API
*   通用“过滤器”或谓词 API
*   许多“行为”设计模式，例如访问者、策略、责任链等。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-05-17T10:45:45.440

根据 GOF（Gang of Four）引用的定义（由 Comptrol），Functor 和 Command 是两种不同的模式。

如前所述，Functor 表示一个包含服务方法的类，换句话说：Functor 类的主要职责是存储在其自己的方法中实现的特定逻辑。因此，我们可以在函子上思考如何为自己的方法的内部逻辑提供一个容器。从历史上看，Functor 的诞生是因为在 Java 规范中不存在“函数指针”的实现和/或概念，这在注册回调（观察者模式的特定实现）的上下文中非常有用。

命令模式代表了一种设计模式，旨在将调用者实体与接收者实体分离。它主要用于需要从动作侦听器（考虑到 GUI）中分解动作（生成事件）时使用。它有一个方法负责执行特定操作（取决于它自己的超类中的特定命令实现），该方法引用特定的对象接收器；在所述定义中，可以将执行方法定义为“不智能”，实际上具有智能的实现可以自己实现操作逻辑，而不是将其委托给第三个对象。当我们有一个智能执行方法时，我们正在实现一个函子，我们将函子（特定的命令子部分实现）放在命令模式的上下文中。

我希望这对你有帮助。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2008-11-03T12:08:59.707

我认为函子是命令模式的一个组件，它还涉及其他基础设施，例如调用者和命令接收者。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2008-11-03T13:12:56.537

在 Java 中使用命令模式是因为我们在 Java 中没有闭包。Functors 是一种实现闭包的尝试。

带有闭包的语言不需要命令模式。

# php - php link to image file outside default web directory

> ID：258365
> 
> 赞同：15
> 
> 时间：2008-11-03T11:20:20.350
> 
> 标签：php, html, image

Here is the directory structure

```
/domain.com
 /public_html
  /functions
  /image
  /mobile
  /www 
```

the /domain.com/public_html/www folder has a file index.php the default web directory is /user/public_html/www in the index file is an include that includes the functions with include"../functions/function.inc" this works without problem when I want to link to a picture in the image folder I don't get any results for example

```
<img src="../image/graphic/logo.gif" alt="alt text"/> 
```

Does anybody has any idea why the link to the image does not work and how to link correctly to the image file ?

I tried `<img src="<?php echo $_SERVER['PHP_SELF']; ?>../image/graphic/logo.gif" alt="alt text"/>`

but that gives me the same result when I build a link around the image to get to the properties I get this as path [http://domain.com/image/pc/tattoo_small/small_2008_10_22_001.JPG](http://domain.com/image/pc/tattoo_small/small_2008_10_22_001.JPG) the path should be [http://domain.com/public_html/image/pc/tattoo_small/small_2008_10_22_001.JPG](http://domain.com/public_html/image/pc/tattoo_small/small_2008_10_22_001.JPG) when I try to browse directly to this url [http://domain.com/public_html/image/pc/tattoo_small/small_2008_10_22_001.JPG](http://domain.com/public_html/image/pc/tattoo_small/small_2008_10_22_001.JPG) I get an 404 file not found error because the default web directory is /domain.com/public_html/www I tried [http://domain.com/../image/pc/tattoo_small/small_2008_10_22_001.JPG](http://domain.com/../image/pc/tattoo_small/small_2008_10_22_001.JPG) to get to the image folder but that does not help neither.

Anybody any ideas or is it impossible to html link to graphical files outside the default web directory ?

thanks for reading this far

Thanks for the answers so far. I will try to solve my problem with one of the recommended solutions and report my working solution back here. I wanted to have the image folder at the same level as the www and mobile folder because some of the images used for the pc (www) version and the mobile version are the same. Of course it is easier to just get an image folder in the www and in the mobile folder and I think that is what I am going to do.

thank you everybody for the advice. The main reason why I am not going to work with a script is that a script will be a difficult solution to an easy problem and also because I don't really see how you can wrap your image in a css class and how to provide alt text for an image.

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2008-11-03T11:28:29.430

无法直接访问 webroot 之外的文件；这是一个内置的安全限制，这是有充分理由的。

但是，可以使用 PHP 脚本为您提供这些图像。这样，您可以调用如下图像：

```
/image.php?file=myfile.jpg 
```

并使用[file_get_contents()](http://php.net/manual/en/function.file-get-contents.php)获取文件内容并将它们打印到您的浏览器。您还应该将标头发送到客户端，在本例中使用 PHP 的[header()](http://php.net/header)函数。一个简短的例子：

```
<?php

    $file = basename(urldecode($_GET['file']));
    $fileDir = '/path/to/files/';

    if (file_exists($fileDir . $file))
    {
        // Note: You should probably do some more checks 
        // on the filetype, size, etc.
        $contents = file_get_contents($fileDir . $file);

        // Note: You should probably implement some kind 
        // of check on filetype
        header('Content-type: image/jpeg');

        echo $contents;
    }

?> 
```

对此使用脚本有更多优点：

*   例如，您可以跟踪下载并实施计数器
*   您可以将文件限制为经过身份验证的用户
*   ... ETC

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2008-11-03T12:11:43.210

如果您使用 Apache 作为服务器，您可以将其设置为 httpd.conf 中的目录的别名...

```
<IfModule mod_alias.c>

    Alias /images/ "/User/Public_html/Image/"

    <Directory "/User/Public_html/Image">
        Options Indexes MultiViews
        AllowOverride None
        Order allow,deny
        Allow from all
    </Directory>

</IfModule> 
```

IIRC，别名文件夹不需要在 webroot 中。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2008-11-03T11:23:57.580

You can't serve a page that's outside of the web directory because the path doesn't work, i.e. [http://mydomain.com/../page.html](http://mydomain.com/../page.html) simply refers to an inaccessible location.

If you really want to serve (static) files that are outside the webroot, you could write a small PHP script to read them and output them. Thus you would redirect requests to the PHP script, and the PHP would read the appropriate file from disk and return it back.

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-15T17:11:35.217

在指向您想要的目录的 Web 根目录中创建符号链接。

```
cd public_html
ln -s ../images 
```

Apache 需要`Options +FollowSymlinks`配置指令才能工作（您可以将其放在`.htaccess`您的 Web 根目录中）。

编写从外部 Web 根目录提供文件的 PHP 脚本违背了 Web 根目录的目的。您必须非常仔细地验证路径以避免将整个磁盘暴露给网络。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T11:24:35.757

It's impossible to link directly to a file outside of the web-accessible area of the web server.

However, you can write a PHP script that will proxy images for you

```
<img src="my_php_proxy.php"> 
```

because PHP can send image data as well as HTML. This PHP "image" isn't restricted to the same folder as the web accessible stuff, it can access any readable file on the server. See [http://www.electrictoolbox.com/image-headers-php/](http://www.electrictoolbox.com/image-headers-php/) for more info

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T11:28:43.423

您可以在 public___html 中创建一个指向图像目录的链接，将图像目录移动到 public_html，或者，如果您特别喜欢复杂的解决方案，您可以编写一个脚本来读取图像文件并将其输出给用户（Of当然，除非您将所有图像都列入白名单，否则您可能会遇到潜在的安全问题）。

# .net - 在.net中转换为短路径的标准方法

> ID：258367
> 
> 赞同：8
> 
> 时间：2008-11-03T11:22:01.547
> 
> 标签：.net, path, quotes

寻找标准的防错误方法将“长名称”（例如“C:\Documents and settings”）转换为等效的“短名称”“C:\DOCUME~1”

我需要这个来运行我的 C# 应用程序的外部进程。如果我用“长名称”中的路径提供它，它会失败。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-03T11:29:24.373

如果您准备开始调用 Windows API 函数，则 GetShortPathName() 和 GetLongPathName() 提供此功能。

见[http://csharparticles.blogspot.com/2005/07/long-and-short-file-name-conversion-in.html](http://csharparticles.blogspot.com/2005/07/long-and-short-file-name-conversion-in.html)

```
 const int MAX_PATH = 255;

    [DllImport("kernel32.dll", CharSet = CharSet.Auto)]
    public static extern int GetShortPathName(
        [MarshalAs(UnmanagedType.LPTStr)]
         string path,
        [MarshalAs(UnmanagedType.LPTStr)]
         StringBuilder shortPath,
        int shortPathLength
        );

    private static string GetShortPath(string path) {
        var shortPath = new StringBuilder(MAX_PATH);
        GetShortPathName(path, shortPath, MAX_PATH);
        return shortPath.ToString();
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T12:03:26.037

即使您将长文件路径括在引号中，外部进程是否也会失败？如果外部应用程序支持，这可能是一种更简单的方法。

例如

```
myExternalApp "C:\Documents And Settings\myUser\SomeData.file" 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-09-26T13:17:48.903

使用 WinAPI 中的 GetShortPathName 的技巧可以正常工作，但在使用非常长的路径时要小心。

我们只是在调用路径长于 MAX_PATH 的 7zip 时遇到了问题。如果路径太长，GetShortPathName 不起作用。只需在它前面加上“\?\”，然后它就会完成这项工作并正确返回缩短的路径。

# css - CSS div 元素 - 如何仅显示水平滚动条？

> ID：258372
> 
> 赞同：209
> 
> 时间：2008-11-03T11:24:57.160
> 
> 标签：css, html

我有一个 div 容器，并定义了它的样式如下：

```
div#tbl-container 
{
    width: 600px;   
    overflow: auto;    
    scrollbar-base-color:#ffeaff
} 
```

一旦我填充了这个 div 包含的表格，这就会自动给我水平和垂直滚动条。我只想自动出现水平滚动条。我将以编程方式修改表格的高度。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：287
> 
> 时间：2008-11-03T11:35:23.220

除非您使内容足够大以需要它们，否则您不应该同时获得水平和垂直滚动条。

但是，由于错误，您通常在 IE 中执行此操作。检查其他浏览器（Firefox 等）以查明实际上是否只有 IE 正在执行此操作。

IE6-7（在其他浏览器中）支持建议的 CSS3 扩展来独立设置滚动条，您可以使用它来抑制垂直滚动条：

```
overflow: auto;
overflow-y: hidden; 
```

您可能还需要为 IE8 添加：

```
-ms-overflow-y: hidden; 
```

因为微软威胁要在 IE8 标准模式下将所有 pre-CR-standard 属性移动到他们自己的“-ms”框中。（如果他们一直这样做的话，这是有道理的，但现在对每个人来说都是不便的。）

另一方面，IE8 完全有可能修复了这个错误。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2011-11-29T23:16:27.083

我还必须添加`white-space: nowrap;`到样式中，否则元素会向下包裹到我们要删除滚动到的区域中。

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2014-09-05T14:25:06.307

此解决方案**没有父 div 的高度/宽度规范，**因此它将**响应**窗口大小调整，最有用的原因是水平滚动条仅在需要时出现。

```
.container{
    padding:20px;
    border:dotted 1px;
    white-space:nowrap;
    overflow-x:auto;
}

.box{
    width:100px;
    height:180px;
    background-color: red;
    margin:10px;
    display:inline-block
} 
```

看看[DEMO](http://jsfiddle.net/evqt871L/)

* * *

## 回答 #4

> 赞同：25
> 
> 时间：2009-11-30T15:07:52.210

要同时显示：

```
<div style="height:250px; width:550px; overflow-x:scroll ; overflow-y: scroll; padding-bottom:10px;">      </div> 
```

隐藏 X 轴：

```
<div style="height:250px; width:550px; overflow-x:hidden; overflow-y: scroll; padding-bottom:10px;">      </div> 
```

隐藏 Y 轴：

```
<div style="height:250px; width:550px; overflow-x:scroll ; overflow-y: hidden; padding-bottom:10px;">      </div> 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2008-11-03T11:38:48.317

您也可以这样做`overflow: auto`并以这种方式提供最大固定高度和宽度，当文本或其中的任何内容溢出时，它将仅显示所需的滚动条

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-10-02T16:06:15.817

我使用 CSS 属性：1）“ `overflow-x: auto`”；2）“ `overflow-y: hidden`”；3）“ `white-space: nowrap`”；

不要忘记为容器和内部 DIVS 组件设置宽度。**属性“white-space : nowrap”**允许内部 DIVS 不放在不同的行上。

考虑以下 HTML：

```
<div class="container"> 
  <div class="inner-1"></div>
  <div class="inner-2"></div>
  <div class="inner-3"></div>
</div> 
```

我使用以下 CSS 仅进行水平滚动：

```
.container {
  height: 80px;
  width: 600px;
  overflow-x: auto;
  overflow-y: hidden; 
  white-space: nowrap;
}
.inner-1,.inner-2,.inner-3 {
  height: 60px;
  max-width: 250px;
 display: inline-block; /* this should fix it */
} 
```

小提琴：[https](https://jsfiddle.net/qrjh93x8/) ://jsfiddle.net/qrjh93x8/ （不使用上面的代码）

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-06-19T21:24:25.773

使用以下

```
<div style="max-width:980px; overflow-x: scroll; white-space: nowrap;">
<table border="1" style="cellpadding:0; cellspacing:0; border:0; width=:100%;" > 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2008-11-03T11:27:50.397

**CSS3**具有该`overflow-x`属性，但我不希望对此有很大的支持。在**CSS2**中，您所能做的就是设置一个通用`scroll`策略并按照自己的方式工作`widths`，而`heights`不是把它们搞砸。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-12-11T06:04:19.103

```
.box-author-txt {width:596px; float:left; padding:5px 0px 10px 10px;  border:1px #dddddd solid; -moz-border-radius: 0 0 5px 5px; -webkit-border-radius: 0 0 5px 5px; -o-border-radius: 0 0 5px 5px; border-radius: 0 0 5px 5px; overflow-x: scroll; white-space: nowrap; overflow-y: hidden;}

.box-author-txt ul{ vertical-align:top; height:auto; display: inline-block; white-space: nowrap; margin:0 9px 0 0; padding:0px;}
.box-author-txt ul li{ list-style-type:none;  width:140px; } 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-18T04:04:21.073

我们应该设置`overflow: auto`并隐藏一个滚动条，我们不使用它来处理不支持的 CSS3 浏览器。看看这个[CSS 溢出；XME.im](http://xme.im/css-overflow-strict-how-to-display-horizontal-or-verticle-only)

# iphone - 是否有任何标准方法可以在 iPhone 中实现“蓝色徽章”？

> ID：258375
> 
> 赞同：19
> 
> 时间：2008-11-03T11:26:44.503
> 
> 标签：iphone, cocoa-touch

很多 iPhone 应用程序使用蓝色徽章来指示子视图中的项目数，例如 Mail 客户端：

[iPhoto http://img.skitch.com/20081103-tjr9yupbhgr3sqfh7u56if4rsn.preview.jpg](http://skitch.com/leonho/4xeu/iphoto)

是否有任何标准方式（甚至 API）可以做到这一点？

更新：我创建了一个名为 BlueBadge 的类来执行此操作。可在[http://github.com/leonho/iphone-libs/tree/master获得](http://github.com/leonho/iphone-libs/tree/master)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-03T13:15:04.080

据我所知，没有用于此的 API。然而，使用 CoreGraphics（NSBezierPath 在 iPhone 上不可用），你可以很容易地做到这一点。它只是 CGPath 中的两条弧线和一些文本：

```
CGContextRef        context = UIGraphicsGetCurrentContext();
float               radius = bounds.size.height / 2.0;
NSString            *countString = [NSString stringWithFormat: @"%d", count];

CGContextClearRect(context, bounds);

CGContextSetFillColorWithColor(context, ovalColor);
CGContextBeginPath(context);
CGContextAddArc(context, radius, radius, radius, M_PI / 2 , 3 * M_PI / 2, NO);
CGContextAddArc(context, bounds.size.width - radius, radius, radius, 3 * M_PI / 2, M_PI / 2, NO);
CGContextClosePath(context);
CGContextFillPath(context);

[[UIColor whiteColor] set];

UIFont              *font = [UIFont boldSystemFontOfSize: 14];
CGSize              numberSize = [countString sizeWithFont: font];

bounds.origin.x = (bounds.size.width - numberSize.width) / 2;

[countString drawInRect: bounds withFont: font]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-12-05T02:00:36.173

我认为实现非常接近`UITabBarItem`徽章的更好方法是使用`UIImage stretchableImageWithLeftCapWidth:topCapHeight:`两个端盖都可以是更精美的图像并且中间将自动拉伸（使用 1px 宽的图像）以适应`NSString`将被覆盖的大小的方法最佳。

仍然需要获得正确的图像，但可以很容易地从屏幕截图中提取或从 PS 构建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-02-18T07:18:26.880

您可以通过使用简单的 UILabel 并更改其底层的cornerRadius 轻松灵活地做到这一点：

```
#import <QuartzCore/QuartzCore.h> // don't forget!
// ...
UILabel *badge = [[UILabel alloc] init];
badge.layer.backgroundColor = [UIColor blueColor].CGColor;
badge.layer.cornerRadius = badge.bounds.size.height / 2; 
```

You can use my (small and simple) [code for a BadgeLabel class and a matching BadgeTableViewCell class](http://ootips.org/yonat/badge-label/).

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T12:27:32.600

NSBezierPath 类中有几个方法称为“appendBezierPathWithRoundedRect....”。

我自己没有尝试过，但它们可能会起作用。这值得一试。

* * *

## 回答 #5

> 赞同：-7
> 
> 时间：2008-11-03T12:40:26.773

您可能还知道另一种类型的徽章，它是应用程序图标上的“红色”徽章。它们是通过执行以下操作创建的：

```
NSDate *now = [NSDate dateWithTimeIntervalSinceNow:0];
NSString *caldate = [[now 
        dateWithCalendarFormat:@"%b" 
        timeZone:nil] description];
[self setApplicationBadge:caldate];" 
```

这将使用当前月份的 3 个字母缩写设置徽章。

# c# - 如何在配置中指定颜色

> ID：258376
> 
> 赞同：3
> 
> 时间：2008-11-03T11:27:06.560
> 
> 标签：c#, .net, winforms

如何在 app.config 中指定颜色，然后在运行时将其转换为实际的 System.Drawing.Color 对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T11:36:03.347

一种方法是将[KnownColor](http://msdn.microsoft.com/en-us/library/system.drawing.knowncolor.aspx)值之一指定为配置文本，然后使用[Color.FromName](http://msdn.microsoft.com/en-us/library/system.drawing.color.fromname.aspx)创建 Color 对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T12:06:25.640

看看[ColorTranslator](http://msdn.microsoft.com/en-us/library/system.drawing.colortranslator.aspx)。您将能够指定一种颜色，例如在 appSettings 中，并使用 ColorTranslator 将其转换为真实颜色。特别是我发现 .FromHtml() 方法非常有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T11:39:46.987

`Color`是个怪事；常规的 xml 序列化通常不起作用 - 因此您经常需要添加自己的代码，可能通过`TypeConverter`：

```
static void Main()
{

    Test(Color.Red);
    Test(Color.FromArgb(34,125,75));
}
static void Test(Color color)
{
    TypeConverter converter = TypeDescriptor.GetConverter(typeof(Color));
    string s = converter.ConvertToInvariantString(color);
    Console.WriteLine("String: " + s);
    Color c = (Color) converter.ConvertFromInvariantString(s);
    Console.WriteLine("Color: " + c);
    Console.WriteLine("Are equal: " + (c == color));
} 
```

输出：

```
String: Red
Color: Color [Red]
Are equal: True
String: 34, 125, 75
Color: Color [A=255, R=34, G=125, B=75]
Are equal: True 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-11-03T11:45:21.470

你的配置看起来像这样：

```
<add key="SomethingsColor" value="Black" /> 
```

您可以将其转换为颜色：

```
Color myColor = Color.FromName(ConfigurationManager.AppSettings["KEY"]); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T11:41:22.197

我写[了这篇](http://www.singingeels.com/Articles/Creating_Custom_Configuration_Sections_In_ASPNET.aspx)关于 ASP.NET 中的自定义配置部分的文章......但是“app.config”（非 Web 应用程序）的主体（和代码）是相同的。但是，如果这对您来说太过分了，那么您可以像其他一些人提到的那样转换字符串。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T11:56:06.207

您可以将颜色存储为可以序列化的 int 值，并添加一个 color 类型的属性，该属性使用 toArgb 和 from argb 来转换它。

例如

```
private ColorInt

public Color shapeColor
{
    get {
         return Color.FromArgb(ColorInt);
     }
      set 
    {
        ColorInt = value.toargb()
    }
} 
```

# ruby-on-rails - 如何将条件“IS NOT NULL”添加到 Thinking Sphinx 搜索

> ID：258378
> 
> 赞同：9
> 
> 时间：2008-11-03T11:27:15.093
> 
> 标签：ruby-on-rails, ruby, full-text-search, sphinx, thinking-sphinx

[在此视频](http://railscasts.com/episodes/120-thinking-sphinx)之后，我正在使用 Thinking Sphinx 进行全文搜索。

我想做以下事情：

```
@articles = Article.search(params[:search], :conditions => "published_at IS NOT NULL", :order => :created_at) 
```

问题是这行不通。似乎搜索方法只接受哈希条件。我尝试了几种方法，但我不知道如何将“published_at IS NOT NULL”表示为哈希......

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2008-11-03T14:11:46.120

在[Railscasts上获得了解决方案](http://railscasts.com/episodes/120-thinking-sphinx)

> 如果您希望该模型的 *all* 结果过滤掉 published_at IS NULL 的记录，请将 'where "published_at IS NOT NULL"' 添加到您的 define_index 块。
> 
> 如果只是有时，添加 published_at 作为属性，然后 sphinx 应该将空日期存储为 0，因此您可以使用 :without => {:published_at => 0} 进行过滤

第二个解决方案是我需要的。

# python - Python 从列表中过滤/删除 URL

> ID：258390
> 
> 赞同：5
> 
> 时间：2008-11-03T11:34:18.950
> 
> 标签：python, url, list, filter

我有一个 URL 的文本文件，大约 14000。下面是几个例子：

[http://www.domainname.com/pagename?CONTENT_ITEM_ID=100¶m2=123](http://www.domainname.com/pagename?CONTENT_ITEM_ID=100&param2=123)
[http://www.domainname.com/images?IMAGE_ID=10](http://www.domainname.com/images?IMAGE_ID=10)
[http://www.domainname.com/pagename?CONTENT_ITEM_ID=101¶m2=123](http://www.domainname.com/pagename?CONTENT_ITEM_ID=101&param2=123)
[http ://www.domainname.com/images?IMAGE_ID=11](http://www.domainname.com/images?IMAGE_ID=11)
[http://www.domainname.com/pagename?CONTENT_ITEM_ID=102¶m2=123](http://www.domainname.com/pagename?CONTENT_ITEM_ID=102&param2=123)

我已将文本文件加载到 Python 列表中，并试图将所有带有 CONTENT_ITEM_ID 的 URL 分离到它们自己的列表中。在 Python 中执行此操作的最佳方法是什么？

干杯

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2008-11-03T11:45:47.053

这是 Graeme 的另一种替代方法，使用较新的列表理解语法：

```
list2= [line for line in file if 'CONTENT_ITEM_ID' in line] 
```

你喜欢哪个是口味问题！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-03T12:32:06.850

我喜欢@bobince 的回答（+1），但会加大赌注。

由于您有一个相当大的起始集，您可能希望避免将整个列表加载到内存中。除非您需要整个列表来做其他事情，否则您可以使用[Python 生成器表达式](http://www.python.org/doc/2.5.2/ref/genexpr.html)通过按请求逐项构建过滤列表来执行相同的任务：

```
for filtered_url in (line for line in file if 'CONTENT_ITEM_ID' in line):
   do_something_with_filtered_url(filtered_url) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T11:37:13.687

```
list2 = filter( lambda x: x.find( 'CONTENT_ITEM_ID ') != -1,  list1 ) 
```

过滤器对 list1 的每个元素（第二个参数）调用函数（第一个参数）。如果函数返回 true（非零），则将元素复制到输出列表。

lambda 基本上创建了一个临时的未命名函数。这只是为了避免必须创建一个函数然后传递它，如下所示：

```
function look_for_content_item_id( elem ):
    if elem.find( 'CONTENT_ITEM_ID') == -1:
        return 0
    return 1
list2 = filter( look_for_content_item_id, list1 ) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-03T12:40:37.380

为了完整性；您也可以使用`ifilter`. 它就像过滤器，但不建立一个列表。

```
from itertools import ifilter

for line in ifilter(lambda line: 'CONTENT_ITEM_ID' in line, urls):
    do_something(line) 
```

# cocoa - 需要在 Cocoa 中做老式的输入/输出

> ID：258394
> 
> 赞同：0
> 
> 时间：2008-11-03T11:35:51.817
> 
> 标签：cocoa, input

我是 Cocoa 的新手，需要使用 scanf 捕获输入来运行一个程序，该程序需要一次输入四个变量。

是否有任何控制台、窗口类、画布、备忘录类（如在 delphi 中）可以让我这样做。

塞纳克伯爵

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T11:58:16.793

您可以将 stdio 与 Objective C 一起使用，它是 C 的完整超集。

如果您的程序从命令行运行，您可以只用 C 编写它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T12:23:39.113

Objective C 只是 C 的扩展，Objective C++ 是 C++ 的扩展。您可以使用 scanf，或者如果您愿意，也可以使用 Objective C++（将实现文件重命名为以 .mm 结尾）并使用 C++ iostreams。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-12-26T11:46:38.277

```
NSString *password=@"rajan";
NSString *scanpass;
char currentpass[10];

NSLog(@"Enter your old password tp compare");
scanf("%s",currentpass);
scanpass = [NSString stringWithUTF8String:currentpass];
//if([password isEqualToString: @"rajan"])
if([password isEqualToString: scanpass])
    NSLog(@"Correct Password");
else 
    NSLog(@"Wrong Password"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T13:37:20.980

您可以使用[NSScanner](http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSScanner_Class/Reference/Reference.html)来解析输入，但正如已经说过的，您使用 C 标准库与 stdin/stdout 进行交互。我会使用 -[NSString initWithUTF8String:] 来获得从 c 字符串到 NSString 的转换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T20:46:54.887

Objective-C 只是 C 的一组扩展（以及 libobjc 中的支持库和 API），因此您可以访问任何其他 C 程序所拥有的一切。所以，只需使用`scanf`.

要将结果放入 中`NSString`，请使用`+[NSString stringWithUTF8String:]`或（不太可能）`+[NSString stringWithCString:encoding:]`。

# php - PHP 自动“获取”变量

> ID：258397
> 
> 赞同：3
> 
> 时间：2008-11-03T11:37:14.233
> 
> 标签：php, get, global-variables

我正在为我的公司设计一个新网站，并且我正在尝试实现切换导航，这是我过去在所有网站上使用的。

```
<?php
switch($x) {

default:
include("inc/main.php");
break;

case "products":
include("inc/products.php");
break;

}
?> 
```

出于某种原因，当我转到 index.php?x=products 时没有任何反应，它仍然显示 inc/main.php，换句话说，它没有从 URL 中检测到 X 变量。这与全局变量有关吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2008-11-03T11:40:11.667

是的，您的 PHP 配置已**正确**`register_globals`关闭，因为这非常不安全。

只是说：

```
$x = $_REQUEST['x'] 
```

在脚本的顶部。

`$_GET`如果您特别希望它仅适用于`GET`HTTP 方法，您也可以使用它。我见过一些人声称这`$_REQUEST`在某种程度上是不安全的，但没有证据支持这一点。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T11:41:19.667

您以前的虚拟主机似乎都使用了[register_globals](http://php.net/register_globals)并且您的代码依赖于它。这是一个**危险**的设置，在 PHP 6.0 中被正确地删除了！改为使用`switch($_GET['x']) {`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T11:41:06.033

您应该使用 $_GET 来读出这些变量。有一个不推荐使用的函数[register_globals](http://nl.php.net/register_globals)，但我绝对不建议使用它，因为它存在潜在的安全风险。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-08-23T07:42:33.683

您可以使用[http://php.net/manual/es/function.extract.php](http://php.net/manual/es/function.extract.php)如果您想提取变量，但请记住，这可以让任何用户在您的脚本中使用他们想要的内容设置变量，这使得它与使用 register_globals 一样不安全

# c - UNICODE_STRING 到 Null 终止

> ID：258407
> 
> 赞同：2
> 
> 时间：2008-11-03T11:40:59.793
> 
> 标签：c, windows, string, unicode, utf-16

我需要将 UNICODE_STRING 结构转换为简单的 NULL TERMINATED STRING。

```
typedef 
struct _UNICODE_STRING 
{
    USHORT  Length;  
    USHORT  MaximumLength;  
    PWSTR   Buffer;
} 
UNICODE_STRING, *PUNICODE_STRING; 
```

我在 MSDN 上找不到关于它的干净解决方案。有人去过吗？我没有使用 .net，所以我需要一个原生 API 解决方案。

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T14:03:10.833

您应该使用 WideCharToMultiByte。作为对输出缓冲区大小的估计，您可以使用 Length 字段 - 但请考虑真正的多字节字符串的情况，在这种情况下它将失败并显示 ERROR_INSUFFICIENT_BUFFER，并且您需要从更大的缓冲区重新开始。或者，您总是首先使用 0 的输出缓冲区大小调用它，因此它会告诉您缓冲区的必要大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-07-03T22:33:07.273

在为 unicode 编译并转换为 ansi 时，这似乎对我有用
（从[http://support.microsoft.com/kb/138813](http://support.microsoft.com/kb/138813)修改）：

```
HRESULT UnicodeToAnsi(LPCOLESTR pszW, LPSTR* ppszA){
    ULONG cbAnsi, cCharacters;
    DWORD dwError;
    // If input is null then just return the same.    
    if (pszW == NULL)    
    {
        *ppszA = NULL;
        return NOERROR;
    }
    cCharacters = wcslen(pszW)+1;
    cbAnsi = cCharacters*2;

    *ppszA = (LPSTR) CoTaskMemAlloc(cbAnsi);
    if (NULL == *ppszA)
        return E_OUTOFMEMORY;

    if (0 == WideCharToMultiByte(CP_ACP, 0, pszW, cCharacters, *ppszA, cbAnsi, NULL, NULL)) 
    {
        dwError = GetLastError();
        CoTaskMemFree(*ppszA);
        *ppszA = NULL;
        return HRESULT_FROM_WIN32(dwError);
    }
    return NOERROR;
} 
```

用法：

```
LPSTR pszstrA;
UnicodeToAnsi(my_unicode_string.Buffer, &pszstrA);
cout << "My ansi string: (" << pszstrA << ")\r\n"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T02:01:19.877

转换为 ANSI 且不需要 UNICODE_STRING 中必须作为参数传递给 WideCharToMultiByte 的 unicode 字符数的替代代码。（请注意，UNICODE_STRING.Length 是字节数，而不是 unicode 字符，如果缓冲区不是以零结尾的，则 wcslen 不起作用）。

```
UNICODE_STRING tmp;
// ...
STRING dest; // or ANSI_STRING in kernel mode

LONG (WINAPI *RtlUnicodeStringToAnsiString)(PVOID, PVOID, BOOL);
*(FARPROC *)&RtlUnicodeStringToAnsiString = 
    GetProcAddress(LoadLibraryA("NTDLL.DLL"), "RtlUnicodeStringToAnsiString");
if(!RtlUnicodeStringToAnsiString)
{
    return;
}

ULONG unicodeBufferSize = tmp.Length;
dest.Buffer = (PCHAR)malloc(unicodeBufferSize+1); // that must be enough...
dest.Length = 0;
dest.MaximumLength = unicodeBufferSize+1;

RtlUnicodeStringToAnsiString(&dest, &tmp, FALSE);
dest.Buffer[dest.Length] = 0; // now we get it in dest.Buffer 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-07-04T00:53:36.937

由于您没有说是否需要 ANSI 或 UNICODE 以空字符结尾的字符串，我将假设 UNICODE：

```
#include <string>

UNICODE_STRING us;
// fill us as needed...

std::wstring ws(us.Buffer, us.Length);
// use ws.c_str() where needed... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-11T18:25:40.180

```
WCHAR* UnicodeStringToNulTerminated(UNICODE_STRING* str)
{
  WCHAR* result;
  if(str == NULL)
    return NULL;
  result = (WCHAR*)malloc(str->Length + 2);
  if(result == NULL)
    // raise?
    return NULL;
  memcpy(result, str->Buffer, str->Length);
  result[str->Length] = L'\0';
  return result;
} 
```

# c# - 如何获取有关 Control.Invoke 目标引发的异常的信息

> ID：258409
> 
> 赞同：2
> 
> 时间：2008-11-03T11:41:17.093
> 
> 标签：c#

我有一个“通用”样板静态方法来检查 InvokeRequired 并相应地调用相关操作。

如果操作引发了未处理的异常，则堆栈跟踪没有太大帮助，因为它从这里开始。我可以获得有关控件的信息，但这并不总是有多大帮助。我想知道是否有可能从行动中获得“有用的东西”——除了“目标”。（请注意，Action 通常是 lambda 或匿名委托...）

```
 public static void Invoke(Control ctrl, Action action)
    {
        if (ctrl == null)
            throw new ArgumentNullException("ctrl");
        if (action == null)
            return;

        var invokeRequired = ctrl.InvokeRequired;
        try
        {
            if (ctrl.InvokeRequired)
                ctrl.Invoke(action);
            else
                action();
        }
        catch (Exception ex)
        {
            throw new Exception(String.Format("Invoke error, ctrl={0}, action Target={1}", ctrl.Name, action.Target), ex);
        }
    } 
```

编辑：根据这个答案，这里是新的重载（也略有改进）

```
public static void Invoke(Control ctrl, Action action, string context)
{
    if (ctrl == null)
        throw new ArgumentNullException("ctrl");
    if (action == null)
        return; //not sure it's worththrowing an exception here...

    var invokeRequired = ctrl.InvokeRequired;
    try
    {
        if (invokeRequired)
            ctrl.Invoke(action);
        else
            action();
    }
    catch (Exception ex)
    {
        var ps = invokeRequired ? "" : " - has the target control been initialised?";
        var errmsg = String.Format("Invoke error, ctrl={0}, action Target={1}, context={2}{3}", ctrl.Name, action.Target, context, ps);
        throw new Exception(errmsg, ex);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T11:46:47.350

好吧，`.Method.Name`会给你被调用的方法，但在匿名方法/ lambdas 的情况下：不，不是真的。编译器生成的名称相当难以理解，并且您无法轻松解析委托的 IL。您最好的选择可能是包含一个可选的字符串参数（出于责备目的；如果省略，请使用`.Method.Name`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T11:59:56.090

如果我没看错，您希望访问发生的原始异常的详细信息。您应该能够通过检查 ex 变量的 InnerException 属性来获得它。

# c# - .NET 中的 ShellExecute 等效项

> ID：258416
> 
> 赞同：52
> 
> 时间：2008-11-03T11:46:30.063
> 
> 标签：c#, .net, winapi, windows-shell, shellexecute

我正在寻找 .NET 首选的方式来执行与 ShellExecute 在 Win32 中执行的相同类型的操作（针对任意文件类型打开、打印等）。

我已经编写 Windows 20 多年了，但我是 .NET 的新手，所以也许我只是在寻找错误的地方。我目前正在使用 .NET 2.0 (VS C# 2005)，但如果需要可以使用 VS 2008。

如果唯一的答案是使用 P/Invoke，那么我最好还是使用 Win32 编写我的小实用程序。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2008-11-03T11:48:59.870

[进程](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx).开始。

请注意，高级用途（打印等）需要使用[ProcessStartInfo](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo_properties.aspx)并设置[Verb](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.verb.aspx)属性。

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2008-11-03T12:13:14.813

```
System.Diagnostics.Process.Start(command) 
```

我敢打赌你找不到它，因为它位于 System.Diagnostics 命名空间中。“诊断”？通常拥有 20 年经验的你擅长的一件事就是猜测新 API/语言中会调用什么东西，但这件事欺骗了我。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T12:15:23.267

您是否尝试过 System.Diagnostics.Process.Start() 函数...它或多或少类似于 ShellExecute。您可以打开exes，文档。我还没有检查打印，Marc 已经告诉你如何了。

# apache-flex - 在 TextArea.htmlText 中显示内联图像

> ID：258418
> 
> 赞同：0
> 
> 时间：2008-11-03T11:48:01.543
> 
> 标签：apache-flex, htmltext

我想在我的聊天框中显示一些笑脸的中间文本，但是当我添加图像时，它会显示在单独的行上......

有任何想法吗？

```
<mx:TextArea id="myChat" width="271" height="238" backgroundColor="#ffffff" borderThickness="0" editable="false" enabled="true" horizontalScrollPolicy="off" wordWrap="true">
    <mx:htmlText>
    <![CDATA[
         <font size='14'> some text - </font><img src='images/emoticons/wink_smile.gif' height='15' width='15'/><font size='14'> more text</font>
    ]]>                      
    </mx:htmlText>
</mx:TextArea> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T12:12:46.827

`img`不幸的是，Flash 对文本字段中的标签的支持不够好。即使在[官方的 Flex 3 文档](http://livedocs.adobe.com/flex/3/html/help.html?content=textcontrols_04.html)中它也说：

> *“注意：<img> 标签不受完全支持，在某些情况下可能不起作用。”*

[Adobe 错误跟踪器](http://bugs.adobe.com/jira/browse/FP-620)中有一个问题似乎描述了您遇到的确切问题。

无论如何，[Valentin Manthei 似乎](http://www.valentin-manthei.de/as3/SmileArea.as)对此有解决方案。不过我自己没试过。

# c++ - C中的函数指针-地址运算符“不必要”

> ID：258422
> 
> 赞同：10
> 
> 时间：2008-11-03T11:49:21.273
> 
> 标签：c++, c, function-pointers

在 C 中使用 qsort 我们传入一个比较函数，例如

```
int cmp(const void*, const void*); 
```

qsort 的原型需要 a`int (* )(const void* , const void*)`所以我们称之为：

```
qsort(..., cmp); 
```

但调用同样有效：

```
qsort(..., &cmp); 
```

如果我们在 C++ 中传入一个静态成员函数，这就是我们必须要做的。Kernighan & Ritchie (2nd Edition, 5.11 "Pointers To Functions" p119) 指出“由于 [cmp] 已知是一个函数，因此 & 运算符不是必需的，就像在数组名称之前不需要它一样。 "

有没有其他人对此感到有点不舒服（特别是关于类型安全）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-05T01:42:13.497

嗯，答案是按值传递函数会产生函数指针，就像按值传递数组会产生指向其第一个元素的指针一样。有人说数组和函数“衰减”。只有少数情况不会发生这种衰减。例如 sizeof(array) 产生数组的大小，而不是它的第一个元素指针。sizeof(function) 无效（函数不是对象），你必须做 sizeof(&function)。其他场合对引用具有约束力：

```
void baz();

void foo(void (&bar)()) {
    bar();
}

// doesnt work, since a reference to a function is requested. 
// you have to pass 'bar' itself, without taking its address 
// explicitely.
foo(&baz); 
```

这，顺便说一句，这就是你能做到的原因

```
template<typename T, int N>
void ByRef(T (&foo)[N]) { 
    ...
} 
```

因为在考虑参考参数时数组还没有衰减。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-03T11:58:21.757

无论您是否感到不舒服，都不会改变 C 不是一种类型安全的语言这一事实​​。一个例子：

```
int main()
{
   int integer = 0xFFFFFF; 
   void (*functionPointer)() = (void(*)())integer; 

   functionPointer(); 

   return 0; 
} 
```

这在编译时是完全有效的，但显然不安全。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T12:12:03.117

我怀疑你只是觉得不舒服，因为你不习惯像 C 允许的那样“接近金属”编码。C 不需要在函数上使用地址运算符的原因是，除了调用或传递函数之外，您实际上无法对函数做任何事情。

换句话说，没有合理的定义来操纵函数的“值”。

而使用整数，您可以添加或减去值，这对函数没有意义。

无论如何，C 早于 C++ 和它自己的标准化——最初的 K&R C 甚至没有原型，而 ANSI 必须确保它们的标准化不会尽可能多地破坏现有代码。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-11-03T12:10:30.000

这是一个语法细节。如果您不喜欢不使用 & 来指示函数指针，请始终使用它。如果您喜欢节省额外的按键并且在编码中不那么明确，那么请利用它。

至于类型安全，我看不出它有什么不同。编译器被赋予一个函数作为参数，它可以完全从名称中计算出函数签名是什么。您没有调用它（使用 () 语法）这一事实表明编译器需要您在此位置有一个函数指针。& 只是一种语法上的精巧，向人们表明他们正在查看某个描述的指针。

如果您使用的是 C++，那么我建议您将 boost 函子视为一种更好的传递函数的方法。这些可爱的实体为 C++ 中的所有函数提供了统一且相当清晰的语法:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T22:20:56.163

请注意，“取消引用”（即调用）函数指针也是如此；你不必

```
(*funcptr)(arg1, arg2); 
```

作为

```
funcptr(arg1, arg2); 
```

就足够了。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T12:11:04.053

这与其说是一种不适感，不如说是对有效但冲突的语法选项的厌恶。要么`cmp`是指针，并且应该始终如一地对待，要么是其他类型——恕我直言，这在语法上具有误导性。

更进一步，我还需要调用以取消引用指针（以突出显示它是指针的事实）或不取消引用（因为函数名*是*指针）......但不允许两者。

函数指针可能非常强大，但对于新手和有经验的程序员来说，它们似乎都是一个困惑的根源。部分困难可以通过要求一个单一的、有意义的语法来*澄清*它们的使用而不是*模糊*它来缓解。

# c++ - 在 Visual Studio (TDD) 中构建和运行 C++ 单元测试

> ID：258425
> 
> 赞同：7
> 
> 时间：2008-11-03T11:51:14.093
> 
> 标签：c++, visual-studio, unit-testing, visual-studio-2005, tdd

我有一个尝试使用 TDD 的大型项目。我使用[Tut](http://tut-framework.sourceforge.net/)作为我的测试框架，它有其缺陷，但足以满足我的需要。

我需要利用链接时间测试接缝，**每个测试都必须在自己的可执行文件**中。然后，此可执行文件的项目会作为后期构建步骤自行启动。

不幸的是，这意味着我的 Visual Studio Sln 充满了测试，这是不可扩展的，并且还隐藏了实际的重要项目。

有谁知道运行这些测试的更好方法？是否可以从构建中隐藏项目但仍然让它们构建？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T12:09:21.827

“是否有可能从构建中隐藏项目，但仍然让它们构建？”

您可以为测试用例制作单独的解决方案。然后您可以设置主要项目的后期构建步骤。这个后期构建应该通过单独的解决方案构建测试项目并运行它们。构建测试项目应该通过命令行完成（详情请参见[此处](http://www-unix.mcs.anl.gov/mpi/mpich1/docs/mpichntman/node10.htm)）。

如果您需要将单元测试与主要项目中的一些 lib-s 链接，您可以使用

```
#pragma comment(lib, "libname") 
```

有关详细信息，请参阅[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/7f0aews7(VS.80).aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T10:47:48.807

您可以尝试在解决方案资源管理器的解决方案中将您的测试分组到文件夹（它们是否称为过滤器？）。这会将测试与您的其他项目分开。

但是，否则，您能否避免使用链接时测试接缝（是的，我知道，现在建议这样做可能为时已晚）并使用多态性来提供您的运行时变化并减少测试项目？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-23T22:20:36.580

不知道你是否还在寻找解决方案。但这里有一个想法：

您可以将所有测试保存在一个库中，并编写一个应用程序自行生成并执行每个测试。这样，您最终会得到一个套件的可执行文件（因此也是一个项目），并且每个测试都将像一个单独的可执行文件。

这实际上是[CUnitWin32](http://code.google.com/p/cunitwin32/)中使用的机制。您甚至可以将测试包装在该框架中。

# asp.net-mvc - ASP.NET MVC 配置问题

> ID：258427
> 
> 赞同：0
> 
> 时间：2008-11-03T11:55:04.600
> 
> 标签：asp.net-mvc, model-view-controller

使用 IIS7 集成模式时，配置中的这一行到底在做什么？

```
<add name="UrlRoutingHandler" preCondition="integratedMode" verb="*"
     path="UrlRouting.axd" type="System.Web.HttpForbiddenHandler, System.Web,
         Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" /> 
```

如果没有这个，我会收到一条错误消息，说它在尝试运行我的网站时找不到 .axd 但有了它我的网站可以工作，它有什么作用？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T16:53:13.610

在集成模式和无扩展 URL 中使用 IIS7 时，这对于解决一个晦涩的问题是必要的。它使无扩展名的 URL 能够工作。此问题将在未来得到解决，我们将能够删除该行。现在，只需忽略它，不要删除它。:)

# session - 浏览器后退按钮 - 它会删除会话数据吗？

> ID：258430
> 
> 赞同：2
> 
> 时间：2008-11-03T11:55:42.197
> 
> 标签：session, browser, back-button

在 Web 浏览器中点击后退按钮是否会导致前面调用中的会话数据集被删除？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T12:02:55.583

不，不是的。

好吧，如果用户通过 POST（而不是 GET）到达上一个页面并重新发布该页面，则服务器将再次处理该请求。但它不会删除会话中的数据。可以使用一些代码来实现此行为，但这不是默认情况下的工作方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T12:06:19.697

服务器端会话数据由 Web 框架处理，因此行为可能会有所不同。然而，几乎所有框架都将会话数据映射到 cookie，使用后退按钮时不会丢失这些数据。

然而，一些框架可能会在 URL 中而不是在 cookie 中编码会话 ID（如果浏览器不支持 cookie，通常作为后备），在这种情况下，如果浏览器“退出”，浏览器可能会丢失会话 ID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T12:03:52.883

不，它只会导致浏览器再次发送它刚刚发送到服务器的内容，或者它会导致浏览器从其缓存中获取页面，而根本不与服务器交互。

# c++ - 为什么在 ATL 的资源文件中找不到控件 ID？

> ID：258438
> 
> 赞同：1
> 
> 时间：2008-11-03T12:00:13.467
> 
> 标签：c++, visual-c++, atl

由于我需要根据我的应用程序中的焦点控件进行一些检查，因此我得到的焦点控件 ID 如下所示：

```
HWND controlOnFocus = ::GetFocus();
int controlID = ::GetDlgCtrlID(controlOnFocus); 
```

我得到了一致的 ID，但我在资源文件中找不到它们！我可以依靠我获得的 ID 还是什么？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T12:14:46.667

您的代码片段从具有当前焦点的任何窗口中获取控件标识符。您的应用程序可能包含许多不是您自己创建的窗口，例如常用对话框，并且这些窗口的 ID 不会在您的资源文件中。此外，并非所有窗口都有有用的控件 ID。例如，静态文本控件通常具有 ID_STATIC (-1?)。

# google-chrome - 您可以在 Google Chrome 中使用 VMWare 的远程控制台吗？

> ID：258452
> 
> 赞同：14
> 
> 时间：2008-11-03T12:09:11.797
> 
> 标签：google-chrome, vmware

您可以在 Google Chrome 中使用 VMWare 的远程控制台吗？主 VMWare 基础架构 Web 访问工作正常，但远程控制台显示错误“未安装或找不到 VMware 远程控制台插件”。这个插件存在吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T12:14:37.247

直到 VMware 为 Google Chrome 创建一个插件之后才可以。

# asp.net - Ajax TabControl 加载缓慢

> ID：258456
> 
> 赞同：0
> 
> 时间：2008-11-03T12:10:19.937
> 
> 标签：asp.net, asp.net-ajax

我的页面中有一个 ajax 选项卡控件，每个选项卡包含大约 15 个控件。我的标签容器有大约 10 个标签。

它需要一些时间加载到我的网页中。请让我知道如何减少页面加载时间。或任何其他建议

由于数据库调用的数量较少。

控件是只读显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2008-11-03T12:17:51.107

查看正在创建的 ViewState 的数量以及创建控件所需的数据库调用的执行时间。使用**页面跟踪选项**来执行此操作。

```
<% @Page ... Trace="True" ... %> 
```

这应该向您显示执行时间的去向以及哪个控制了最大的 html 大小。

在您的特定情况下（Tabstrip），通过将某些选项卡（用户并不总是打开的选项卡）的内容实现为**按需加载到 iframe 中的专用页面**（由 Javascript 功能激活），这可能是一个利用页面的好策略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-07T04:30:08.303

与视图状态的其他评论一起尝试在页面外处理它。我的意思是编写您自己的视图状态处理程序以将其存储在服务器端，这样您就不会在每次往返时将其发送给客户端。如果您不确定如何执行此操作，请给我发消息或回复，我可以向您发送一些代码，帮助您在 ajax 环境中处理此问题。

如果这些是选项，那么您可能需要考虑使每个选项卡的内容不可见，直到用户单击选项卡。您需要处理每次点击的回发并更新内容，购买一次发送的内容会更少，这在某些情况下可能更有意义？你有我可以看到的页面的公开版本吗？

安德鲁

# xml - 使用 RelaxNG 进行 XML 模式验证

> ID：258462
> 
> 赞同：17
> 
> 时间：2008-11-03T12:12:29.543
> 
> 标签：xml, perl, validation, schema, relaxng

对于性能和准确性，您可以推荐哪些 XML 验证工具，每一个都是我们系统的关键问题？我们有以下要求：

*   它*不是*xmllint（见下文）
*   支持RelaxNG
*   可以轻松地与 Perl 集成（这是可选的，但它会很好）

为什么不是 xmllint？（这是背景，喜欢的可以跳过）

我们有一个大型 Perl 系统，它使用 RelaxNG 来验证我们的 XML。我们使用[紧凑的 RelaxNG 格式](http://www.relaxng.org/compact-tutorial-20030326.html)和[trang](http://www.thaiopensource.com/relaxng/trang.html)将其转换为标准的 RelaxNG 格式。然后我们通过[xmllint](http://xmlsoft.org/xmllint.html)进行实际验证。

这就是问题出现的时候。xmllint 通常在错误地报告验证错误方面存在问题。它不会给出错误的肯定或否定，但如果文档验证失败，xmllint 经常会报告给定错误的错误元素或属性。有时错误是正确的（“没想到会看到元素'bar'），但这只是因为没有报告先前的错误（因为'bar'应该遵循必需但缺少元素'foo'，但xmllint没有' t 告诉我们那一点）。请注意，这是 xmllint 长期存在的问题，甚至最新版本也有同样的问题。我们经常有巨大的 XML 文档，误报错误会给客户和开发人员带来很大的痛苦。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2008-11-03T16:03:41.167

我认为 JDrago 的想法是正确的，您需要避免使用基于 libxml2 的工具进行 RNG 验证，至少目前是这样。我也在我的项目中发现了这一点。我最近记录了两个关于 RNG 验证的针对 libxml2 的错误。

我推荐[京](http://code.google.com/p/jing-trang/)。它是由 Relax NG 的创建者和 XML 世界的领军人物之一 James Clark 编写的。他也是 trang 的作者，您已经在使用它。这段代码（和 trang）的开发最近在我上面链接到的 Google 代码网站上恢复了。

Jing 已经证明我们的内容和架构始终是正确的，并且提供比 libxml2 更好的错误消息，尽管在这方面仍有很大的改进空间。

jing 相对于 libxml2/xmllint 的一个缺点是它目前不使用 OASIS XML 目录来解析公共和系统标识符以及指向模式的 URI。如果您包含由“http”URI 引用的模式，这将是一个问题——这些模式总是会通过网络获取。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-01-11T20:14:54.810

[Hamcrest Schema](http://code.google.com/p/hamcrest-schema)允许您使用 Hamcrest 匹配器针对 RelaxNG 验证 XML 文档。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T15:16:26.317

我怀疑 xmllint 使用与其他任何东西相同的底层库（libxml2 等）。认为同一个库的另一个前端会给出不同的结果是违反直觉的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2008-12-23T09:05:22.667

[rnv](http://www.davidashen.net/rnv.html)非常快速、免费（就像在言论自由中一样）并且在命令行上运行（因此 Perl 可以轻松调用它）。大多数情况下，消息都可以。不幸的是，它似乎不再维护。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2008-12-23T10:07:08.597

我是 RNV 的作者。它在 sourceforge.net 上维护，并且有一个维护者负责 sourceforge 和 debian 包的构建。事实是代码没有改变是因为代码是稳定的。没有报告错误。

# properties - 属性和属性有什么区别？

> ID：258469
> 
> 赞同：185
> 
> 时间：2008-11-03T12:15:57.023
> 
> 标签：properties, modeling

这些似乎意味着同样的事情。但是在什么情况下哪个词更合适呢？

* * *

## 回答 #1

> 赞同：215
> 
> 时间：2012-05-20T12:49:08.937

一般而言（以及正常的英语用法），这些术语的含义相同。

在 HTML / Javascript 的特定上下文中，术语会混淆，因为 DOM 元素的 HTML 表示具有*属性*（在 XML 中用于标记中包含的键/值对的术语），但是当表示为 JavaScript 对象时，这些属性显示为对象*属性*。

更令人困惑的是，对属性的更改通常会更新属性。

例如，更改`element.href` *属性*将更新元素上的`href` *属性*，这将反映在对`element.getAttribute('href')`.

但是，如果您随后*阅读*该属性，它将被规范化为绝对 URL，即使该*属性*可能是相对 URL！

* * *

## 回答 #2

> 赞同：90
> 
> 时间：2014-02-05T00:48:43.907

这些词在计算机科学出现之前就已经存在了。

1.  属性是**我们归因**于某人或某物的品质或对象。例如，权杖是权力和国家地位的属性。

2.  财产是一种**没有任何归属**的品质。例如，粘土具有粘性；即，粘土的一个特性是它的粘合性。另一个例子：金属的特性之一是导电性。属性通过物理现象展示自己，而无需将它们归因于某人或某物。同理，说某人有阳刚之气是不言而喻的。实际上，您可以说财产归某人或某物所有。

公平地说，在计算机科学中，这两个词至少在大多数情况下可以互换使用——但程序员通常没有英语文学学位，也不写或关心语法书:)。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2013-04-20T13:12:10.233

属性是您在 HTML 标记中使用的实际内容，例如

```
<input type="checkbox" checked="checked" /> 
```

在此实例中，类型和选中是属性。该属性是这些属性的值，浏览器将其保存在 DOM 元素中。通常属性和属性的值是相等的，这就是它如此混乱的原因。

在此示例中，DOM 元素`input`具有`type`带有值的属性和带有值的`"checkbox"`属性（请注意此值与 HTML 属性中的值有何不同）。`checked``true`

使用 Firebug，您可以在单击元素并选择“DOM 视图”时观察属性的行为。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2011-07-19T14:04:20.817

通常使用*属性*来描述机制或现实世界的事物。

*属性*用于描述模型。

例如，一份文档（放在您的办公桌上）可能具有草稿的属性。

为文档建模的类有一个属性来指示它是否是草稿。在这种情况下，属性捕获状态。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2008-11-03T12:37:07.933

这些术语的确切含义在很大程度上取决于您所谈论的语言/系统/宇宙。

例如，在 HTML/XML 中，属性是标记中带有等号和值的部分，而属性没有任何意义。

因此，我们需要有关您正在讨论的领域的更多信息。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2008-11-03T12:36:58.963

在 Python...

```
class X( object ):
    def __init__( self ):
        self.attribute
    def getAttr( self ):
        return self.attribute
    def setAttr( self, value ):
        self.attribute= value
    property_name= property( getAttr, setAttr ) 
```

属性是一个类似属性的名称，它包装了 setter、getter（和 deleter）函数的集合。

属性通常是另一个对象中的单个对象。

然而，话虽如此，Python 为您提供了`__getattr__`允许您扩展“属性”定义的方法。

底线 - 它们几乎是同义词。Python 对它们的实现方式进行了技术区分。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-01-29T17:34:50.527

属性和属性有什么区别？
功能和功能有什么区别？Characteristic 和 Character 和有什么不一样？行为和行为有什么区别？

它只是上下文的变化。

对象、产品、个性、人

一个人在一种行为中行动。人格具有给定角色的特征。产品具有派生功能的特征。对象具有赋予它属性的属性。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2010-05-19T13:36:24.533

在 Java（或其他语言）中，使用 Property/Attribute 取决于用法：

*   值不经常更改时使用的属性（通常在启动时使用或用于环境变量）

*   属性是一个元素（对象）的值（对象子），它可以经常/一直改变并且是持久的或不持久的

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2012-07-24T23:49:46.787

在 HTML 中，属性似乎特定于 DOM 树，而属性用于描述 DOM 元素的特征

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2008-11-03T12:31:42.080

Delphi 使用了属性，并且他们已经找到了进入 .NET 的方式（因为它具有相同的架构师）。

在 Delphi 中，它们通常与运行时类型信息结合使用，以便可以使用集成的属性编辑器在设计时设置属性。

属性并不总是与字段相关。它们可能是可能有副作用的功能（但当然这是非常糟糕的设计）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2008-11-03T12:19:38.280

```
<property attribute="attributeValue">proopertyValue</property> 
```

将是看待它的一种方式。

在 C# 中

```
[Attribute]
public class Entity
{
    private int Property{get; set;}; 
```

# asp.net - 你能在 ASCX 控件中获得 SkinID 自动补全吗

> ID：258470
> 
> 赞同：1
> 
> 时间：2008-11-03T12:16:16.913
> 
> 标签：asp.net, visual-studio, autocomplete, skin, web-user-controls

在 VS 2008 中工作

在`Source`模式下处理 ASPX 文件时，如果我在文件的页面指令中指定了 StyleSheetTheme，那么 Visual Studio 将为我提供控件可能的 skinID 值的自动完成列表

例如

```
<asp:Button ID="myButton" runat="server" SkinID="
//Having typed this much, I'll get an intellisense with the possible skinid values for this button 
```

我只是想知道是否有可能在 ASCX 中获得相同的功能。因为没有为控件指定样式表主题，VS 不知道可能的值是什么......

**您能否指定 Visual Studio 可用于 Web 用户控件的默认样式表主题。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-23T15:16:56.037

是的你可以。如果您在 web.config 中指定默认主题，则 intellsense 也会在用户控件中列出可用的皮肤。

要定义默认主题，请在 web.config 中编辑以下条目：

```
...
<system.web>
    ...
    <pages styleSheetTheme="MyTheme">
    ... 
```

这适用于主题和样式表主题。但是可能需要一些时间（或重建？），直到智能感知列出可用的皮肤。

顺便说一句：指定要在 web.config 中使用的主题（而不是在页面中）具有额外的优势，您可以非常轻松地切换主题。

# svn - 如何导出具有依赖项的 SVN 存储库的一部分？

> ID：258473
> 
> 赞同：2
> 
> 时间：2008-11-03T12:19:32.447
> 
> 标签：svn, svnadmin, svndumpfilter

我正在尝试使用`svnadmin dump`.

提供的 svndumpfilter 工具不管理来自未包含在导出中的目录的复制/移动/重命名依赖项。

是否有可以管理这些依赖项的工具？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T10:25:39.447

我发现了一个由 Simon Tatham 编写的名为[svndumpfilter2](http://svn.tartarus.org/sgt/svn-tools/svndumpfilter2?view=markup)的 Python 脚本，它试图处理简单的依赖关系（不过我发现了一些限制）。

您还可以查看有关他迁移到 Subversion 和脚本动机的[文章。](http://www.chiark.greenend.org.uk/~sgtatham/svn.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T12:36:17.013

对于依赖项，您的意思是由属性 svn:external?

如果是，我认为您应该将属性中的路径引用也传递给 svndumpfilter。例如，如果您的项目在`http://host/project`其中并且 svn:external 属性设置为`http://host/dependencies`您可以执行类似的操作

```
svndumpfilter include http://host/project http://host/dependencies < total.dump > project.dump 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T13:34:45.167

你无法摆脱这个问题。如果您复制了目录/文件，则必须将（源和目标）都包含到 svndumpfilter 中。

但是，您可以做一些技巧：

如果您不是从修订 0 转储存储库，而是从修订 100 转储，您将获得一个新的存储库，其中修订 1-100 消失了。但是，您的目标存储库将修订 1 中的所有文件/文件夹作为修订 100 中的源存储库。通过这种方式，您可以摆脱版本化数据而不会丢失 HEAD-Revision。

您可以尝试转储/加载源存储库，直到您的第一个副本进入“平面”存储库，然后将剩余的转储添加到其中。通过这种方式，您可以跳过麻烦的 copy-from 修订，因为您的文件已经在合适的（目标）目录中。

# c# - 如何检查我是否处于 Web 应用程序的调试或发布版本中？

> ID：258481
> 
> 赞同：5
> 
> 时间：2008-11-03T12:24:39.003
> 
> 标签：c#, asp.net, debugging

在任何（非 Web）.net 项目中，编译器会自动声明 DEBUG 和 TRACE 常量，因此我可以使用条件编译来例如在调试与发布模式下以不同方式处理异常。

例如：

```
#if DEBUG
    /* re-throw the exception... */
#else
    /* write something in the event log... */
#endif 
```

如何在 ASP.net 项目中获得相同的行为？看起来 web.config 中的 system.web/compilation 部分可能是我需要的，但是如何以编程方式检查它？还是我最好自己声明一个 DEBUG 常量并在发布版本中将其注释掉？

编辑：我在 VS 2008

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T12:41:33.977

要添加安德鲁斯答案，您也可以将其包装在一个方法中

```
public bool IsDebugMode
{
  get
  {
#if DEBUG 
    return true;
#else
    return false;
#endif
  }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-03T12:34:24.507

看看[ConfigurationManager.GetSection()](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.getsection.aspx) - 这应该让你大部分时间都在那里.. 但是，我认为你最好在调试和发布模式之间进行切换，并让编译器确定执行“#if DEBUG”封闭语句.

```
#if DEBUG
/* re-throw the exception... */
#else
/* write something in the event log... */
#endif 
```

以上将正常工作，只需确保您至少有两个构建配置（右键单击您正在处理的项目并转到“属性”，其中有一个关于构建的部分） - 确保其中一个构建检查了“定义调试”，而另一个没有。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T16:57:18.297

这就是我最终做的事情：

```
protected bool IsDebugMode
{
    get
    {
        System.Web.Configuration.CompilationSection tSection;
        tSection = ConfigurationManager.GetSection("system.web/compilation") as System.Web.Configuration.CompilationSection;
        if (null != tSection)
        {
            return tSection.Debug;
        }
        /* Default to release behavior */
        return false;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-05T09:52:09.000

我个人不喜欢“#if debug”改变布局的方式。我通过创建一个仅在调试模式下调用并通过引用传递布尔值的条件方法来做到这一点。

```
[Conditional("DEBUG")]
private void IsDebugCheck(ref bool isDebug)
{
    isDebug = true;
}

public void SomeCallingMethod()
{ 
    bool isDebug = false;
    IsDebugCheck(ref isDebug);
} 
```

# sql-server - 本地化 SQL Server (2005/2008) 数据库的最佳实践

> ID：258483
> 
> 赞同：12
> 
> 时间：2008-11-03T12:26:39.373
> 
> 标签：sql-server, linq-to-sql, database-design, localization

## 问题

我相信你们中的许多人都面临过将数据库后端本地化到应用程序的挑战。如果你还没有，那么我很有信心说你将来必须这样做的可能性很大。我说的是为您的数据库实体存储多个文本翻译（货币等也是如此）。

例如，经典的“Category”表可能有一个应该全球化的 Name 和 Description 列。一种方法是为每个实体创建一个“文本”表，然后根据提供的语言进行连接以检索值。

这为您留下了许多“文本”表，每个表用于您要本地化的每个实体，并添加了一个 TextType 来区分它可能存储的各种文本。

我很好奇是否有任何记录在案的最佳实践/设计模式将这种支持实现到 SQL Server 2005/2008 数据库中（我特别关注 RDBMS，因为它可能包含受支持的关键字等，这有助于与实施）？

## 关于 XML 方法的思考

我一直在玩弄的一个想法（尽管到目前为止只是在我的脑海中）是利用 SQL Server 2005 中引入的 XML 数据类型。这个想法是制作应该支持本地化的 XML 数据类型的列（并将模式绑定到它）。XML 将包含本地化字符串以及与之相关的语言代码/文化。

类似的东西

```
Product
ID (int, identity)
Name (XML ...)
Description (XML ...) 
```

然后你会有像 XML 这样的东西

```
<localization>
  <text culture="sv-SE">Detta är ett namn</text>
  <text culture="en-EN">This is a name</text>
</localization> 
```

然后你可以这样做（这不是生产代码，所以我将使用 *）

```
SELECT *
From Product
Where Product.ID = 10 
```

您将获得带有所有本地化文本的产品，这意味着您必须在客户端进行提取。这里最大的问题显然是每次查询都必须返回的额外数据量，好处是没有查找表、连接等的更简洁的设计。

顺便说一句，无论我最终在设计中使用什么方法，我仍将使用 Linq To SQL（.NET 平台）来查询数据库（XML 方法应该是一个问题，因为它会返回一个可以被客户端解释的 XElement-边）

因此，关于数据库本地化设计模式的建议，以及可能对 XML 思想的评论，将非常受欢迎。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-04T14:06:39.157

我认为您可以坚持使用允许更简洁设计的 XML。我会更进一步并利用[专为此用途设计](http://www.opentag.com/xfaq_lang.htm)`xml:lang`的属性：

```
<l10n>
  <text xml:lang="sv-SE">Detta är ett namn</text>
  <text xml:lang="en-EN">This is a name</text>
</l10n> 
```

更进一步，您可以通过[XPath 查询](http://msdn.microsoft.com/en-us/library/ms345117(SQL.90).aspx)（如评论中的建议）在查询中选择本地化资源，以避免任何客户端处理。这会给出这样的东西（未经测试）：

```
SELECT Name.value('(l10n/text[lang()="en"])[1]', 'NVARCHAR(MAX)')
  FROM Product
  WHERE Product.ID=10; 
```

请注意，与单独的表格相比，此解决方案将是一种优雅但效率较低的解决方案。这对于某些应用程序可能没问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-11-09T02:52:57.687

这是我的做法。我不为此使用 LINQ 或 SP，因为查询太复杂并且是动态构建的，这只是查询的摘录。

我有一个产品表：

```
* id
* price
* stocklevel
* active
* name
* shortdescription
* longdescription 
```

和 products_globalization 表：

```
* id
* products_id
* name
* shortdescription
* longdescription 
```

如您所见，产品表也包含所有全球化列。这些列包含默认语言（因此，在请求默认文化时能够跳过连接 - 但我不确定这是否值得麻烦，我的意思是两个表之间的连接是基于索引的所以。 .. - 给我一些关于这个的反馈）。

我更喜欢在全局资源表上使用并排表，因为在某些情况下，您可能需要在几列上执行即数据库 (MySQL) MATCH，例如 MATCH(name, shortdescription, longdescription) AGAINST ('这里的东西'）。

在正常情况下，某些产品翻译可能会丢失，但我仍然想显示所有产品（不仅仅是被翻译的产品）。所以仅仅做一个join是不够的，我们实际上需要根据products-table做一个left join。

伪：

```
string query = "";
if(string.IsNullOrEmpty(culture)) {
   // No culture specified, no join needed.
   query = "SELECT p.price, p.name, p.shortdescription FROM products p WHERE p.price > ?Price";
} else {
   query = "SELECT p.price, case when pg.name is null then p.name else pg.name end as 'name', case when pg.shortdescription is null then p.shortdescription else pg.shortdescription end as 'shortdescription' FROM products p"
   + " LEFT JOIN products_globalization pg ON pg.products_id = p.id AND pg.culture = ?Culture"
   + " WHERE p.price > ?Price";
} 
```

我会选择 COALESCE 而不是 CASE ELSE，但除此之外。

嗯，这就是我的看法。随意批评我的建议...

亲切的问候，理查德

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T14:09:37.950

这是难以回答的问题之一，因为答案中有很多“取决于”:-)

答案取决于数据库中本地化项目的数量、部署方案、缓存问题、访问模式等。如果你能给我们一些关于应用程序有多大、它将有多少并发用户以及如何部署的数据，那将非常有帮助。

一般来说，我通常使用以下两种方法之一：

1.  将本地化项目存储在可执行文件附近（本地化资源 dll）
2.  将本地化项目存储在数据库中，并在包含本地化项目的表中引入 localeID 列。

第一种方法的优点是良好的 VisualStudio 支持。第二种的优点是集中部署。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T13:58:01.733

我不明白你为什么需要多个文本表。具有“全局”唯一文本 ID 的单个文本表就足够了。该表将具有 ID、语言、文本列，并且您只会获得您需要呈现的语言的文本（或者可能根本不检索文本）。连接应该是相当有效的，因为 (ID, language) 的组合是主键。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-04T13:30:37.747

我认为使用 XML 列存储本地化值没有任何优势。除非你有一个项目的所有本地化版本“在一个地方”，如果这对你有价值的话。

我建议在每个具有可本地化项目的表中使用cultureID 列。这样，您根本不需要任何 XML 处理。您已经将数据保存在关系模式中，那么当关系模式完全能够处理问题时，为什么还要引入另一层复杂性呢？

假设“sv-SE”有cultureID = 1，“en-EN”有2。

然后您的查询将被修改为

```
SELECT *
From Product
Where Product.ID = 10 AND Product.cultureID = 1 
```

对于瑞典客户。

我在本地化数据库中经常看到这种解决方案。它可以很好地适应文化数量和数据记录数量。它避免了 XML 解析和处理，并且易于实现。

还有一点：XML 解决方案为您提供了您不需要的灵活性：例如，您可以从“名称”列中获取“sv-SE”值，从“描述”-列。但是，您不需要这个，因为您的客户一次只会请求一种文化。灵活性通常是有代价的。在这种情况下，您需要单独解析所有列，同时使用cultureID 解决方案，您可以获得包含所有值的整个记录​​，其中所有值都适合所请求的文化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-14T19:07:34.180

这里有一些关于 Rick Strahl 博客的想法：

[数据库](http://www.west-wind.com/weblog/posts/695968.aspx) [本地化 JavaScript 本地化](http://www.west-wind.com/Weblog/posts/698097.aspx)

我更喜欢在 UserSetting 表中使用单个开关，通过调用存储过程来使用它......这里有一些代码

```
CREATE TABLE [dbo].[Lang_en_US_Msg](
    [MsgId] [int] IDENTITY(1,1) NOT NULL,
    [MsgKey] [varchar](200) NOT NULL,
    [MsgTxt] [varchar](2000) NOT NULL,
    [MsgDescription] [varchar](2000) NOT NULL,
 CONSTRAINT [PK_Lang_US-us__Msg] PRIMARY KEY CLUSTERED 
(
    [MsgId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

CREATE TABLE [dbo].[User](
    [UserId] [int] IDENTITY(1,1) NOT NULL,
    [FirstName] [varchar](50) NOT NULL,
    [MiddleName] [varchar](50) NULL,
    [LastName] [varchar](50) NULL,
    [DomainName] [varchar](50) NULL,
 CONSTRAINT [PK_User] PRIMARY KEY CLUSTERED 
(
    [UserId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

CREATE TABLE [dbo].[UserSetting](
    [UserSettingId] [int] IDENTITY(1,1) NOT NULL,
    [UserId] [int] NOT NULL,
    [CultureInfo] [varchar](50) NOT NULL,
    [GuiLanguage] [varchar](10) NOT NULL,
 CONSTRAINT [PK_UserSetting] PRIMARY KEY CLUSTERED 
(
    [UserSettingId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

去

```
 ALTER TABLE [dbo].[UserSetting] ADD  CONSTRAINT [DF_UserSetting_CultureInfo]  DEFAULT ('fi-FI') FOR [CultureInfo]
 GO

 CREATE TABLE [dbo].[Lang_fi_FI_Msg](
    [MsgId] [int] IDENTITY(1,1) NOT NULL,
    [MsgKey] [varchar](200) NOT NULL,
    [MsgTxt] [varchar](2000) NOT NULL,
    [MsgDescription] [varchar](2000) NOT NULL,
    [DbSysNameForExpansion] [varchar](50) NULL,
 CONSTRAINT [PK_Lang_Fi-fi__Msg] PRIMARY KEY CLUSTERED 
(
    [MsgId] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

CREATE PROCEDURE [dbo].[procGui_GetPageMsgs]
@domainUser varchar(50) ,           -- the domain_user performing the action  
@msgOut varchar(4000) OUT,        -- the (error) msg to be shown to the user   
@debugMsgOut varchar(4000) OUT ,   -- this variable holds the debug msg to be shown if debug level is enabled   
@ret int OUT                  -- the variable indicating success or failure 

AS                            
BEGIN -- proc start                            
 SET NOCOUNT ON;                            

declare @procedureName varchar(200)        
declare @procStep varchar(4000)  

set @procedureName = ( SELECT OBJECT_NAME(@@PROCID))        
set @msgOut = ' '     
set @debugMsgOut = ' '     
set @procStep = ' '     

BEGIN TRY        --begin try                  
set @ret = 1 --assume false from the beginning                  

--===============================================================
 --debug   set @procStep=@procStep + 'GETTING THE GUI LANGUAGE FOR THIS USER '
--===============================================================

declare @guiLanguage nvarchar(10)

if ( @domainUser is null)
    set @guiLanguage = (select Val from AppSetting where Name='guiLanguage')
else 
    set @guiLanguage = (select GuiLanguage from UserSetting us join [User] u on u.UserId = us.UserId where u.DomainName=@domainUser)

set @guiLanguage = REPLACE ( @guiLanguage , '-' , '_' ) ;

--===============================================================
set @procStep=@procStep + ' BUILDING THE SQL QUERY '
--===============================================================

DECLARE @sqlQuery AS nvarchar(2000)
SET @sqlQuery = 'SELECT  MsgKey , MsgTxt FROM dbo.lang_' + @guiLanguage + '_Msg'

--===============================================================
set @procStep=@procStep + 'EXECUTING THE SQL QUERY'
--===============================================================
print @sqlQuery

    exec sp_executesql @sqlQuery

    set @debugMsgOut = @procStep
    set @ret = @@ERROR                  

END TRY        --end try                  

BEGIN CATCH                        
 PRINT 'In CATCH block.                         
 Error number: ' + CAST(ERROR_NUMBER() AS varchar(10)) + '                        
 Error message: ' + ERROR_MESSAGE() + '                        
 Error severity: ' + CAST(ERROR_SEVERITY() AS varchar(10)) + '                        
 Error state: ' + CAST(ERROR_STATE() AS varchar(10)) + '                        
 XACT_STATE: ' + CAST(XACT_STATE() AS varchar(10));                        

set @msgOut = 'Failed to execute ' + @sqlQuery             
set @debugMsgOut = ' Error number: ' + CAST(ERROR_NUMBER() AS varchar(10)) +               
 'Error message: ' + ERROR_MESSAGE() + 'Error severity: ' + CAST(ERROR_SEVERITY() AS varchar(10)) +               
 'Error state: ' + CAST(ERROR_STATE() AS varchar(10)) + 'XACT_STATE: ' + CAST(XACT_STATE() AS varchar(10))                        

--record the error in the database                        
--debug    
 --EXEC [dbo].[procUtils_DebugDb]
    --  @DomainUser = @domainUser,
    --  @debugmsg = @debugMsgOut,
    --  @ret = 1,
    --  @procedureName = @procedureName ,
    --  @procedureStep = @procStep

 -- set @ret = 1                       

END CATCH                        

return  @ret                                   
END --procedure end 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-12-17T17:27:23.630

我喜欢 XML 方法，因为如果没有瑞典语翻译 (cultureID = 1)，除非您进行外部连接，否则分离表解决方案不会返回结果。但尽管如此，你不能回退到英语。使用 XML 方法，您可以简单地回退到英语。有关于在生产环境中使用 XML 方法的消息吗？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-09-13T05:04:26.873

我总体上看到了 delim - 您必须将一个实体表示为单个实例（例如，一个 ProductID 为“10”），但具有不同列/属性的多个本地化文本。这是一个艰难的过程，我确实看到了对 POS 系统的需求，即您只想跟踪一个 ProductID = 10，而不是多个具有不同 ProductID 的产品，但它们是相同的，只是文本不同。

我倾向于您和其他人已经在此处概述的 XML 列解决方案。是的，它是通过网络传输更多数据 - 但是，它使事情变得简单，并且如果数据包站点成为问题，可以使用 XElement 进行过滤。

主要缺点是通过线路从 DB 传输到服务层/UI/App 的数据量。在返回结果之前，我会尝试在 SQL 端进行一些转换，只返回一种文化 UI。您总是可以通过 xml 在存储过程中选择正确的文化，并将其作为普通文本返回。

总的来说，这与博客文章或 CMS 需要本地化（我已经做过一些）不同。

我对 Post 场景的方法与 TToni 的方法类似，除了从域的角度对数据进行建模（以及一点 BDD）。话虽如此，请专注于您想要实现的目标：

```
Given a users culture is "sv-se"
When the user views a post list
It should list posts only in "sv-se" culture 
```

这意味着用户应该只看到他们文化的帖子列表。我们之前实现这一点的方式是传入一组文化以根据用户可以看到的内容进行查询。如果用户将“sv-se”设置为他们的主要用户，但也选择了他们说美国英语（en-us），那么查询将是：

```
SELECT * FROM Post WHERE CultureUI IN ('sv-se', 'en-us') 
```

请注意，这如何为您提供所有帖子及其不同的 PostID，这是该语言独有的。PostID 在博客上并不那么重要，因为每个帖子都绑定到不同的语言。如果有副本被转录，那么在这里也可以正常工作，因为每个帖子都是该文化所独有的，因此会获得一组独特的评论等。

但是回到我回答的第一部分，您的需求源于需要具有多个文本的单个实例的要求。Xml 列非常适合。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-09-29T11:50:00.343

要考虑的另一种方法：不要将内容存储在数据库中，而是将支持数据库记录的“应用程序”和“内容”作为单独的实体保持。

在为我的电子商务网站创建多个主题时，我使用了类似的方法。一些产品具有制造商徽标，该徽标也必须与网站主题相匹配。由于主题没有真正的数据库支持，所以我遇到了问题。我想出的解决方案是使用数据库中的令牌来识别图像的 ClientID，而不是存储图像的 URL（这会因主题而异）。

遵循相同的方法，您可以将数据库从存储产品的名称和描述更改为存储名称标记和描述标记，以识别资源（在 resx 文件中或使用 Rick Strahl 方法的数据库中）内容。.NET 的内置功能然后会处理语言切换，而不是尝试在数据库中进行（将业务逻辑放在数据库中很少是一个好主意）。然后，您可以使用客户端上的令牌来查找正确的资源。

```
Label1.Text = GetLocalResourceObject("TokenStoredInDatabase").ToString() 
```

这种方法的缺点显然是使数据库令牌和资源令牌保持同步（因为可以在没有任何描述的情况下添加产品），但使用诸如 Rick Strahl 创建的资源提供程序可能会更容易完成。如果您的产品经常更换，这种方法可能不起作用，但对某些人来说可能。

优点是您有少量数据要从数据库传输到客户端，您的内容与数据库完全分离，并且您的数据库不需要比现在更复杂。

附带说明一下，如果您正在经营一家电子商务商店，并且确实希望将您的本地化页面编入索引，那么您必须稍微偏离 Microsoft 创建的看似自然的方式。实用且合乎逻辑的设计流程与 Google对 SEO 的[建议](http://googlewebmastercentral.blogspot.com/2008/08/how-to-start-multilingual-site.html)显然存在分歧。事实上，一些网站管理员抱怨他们的页面没有被搜索引擎索引为“默认”文化，因为搜索引擎只会索引单个 URL，即使它根据浏览器的文化而改变。

幸运的是，有一种简单的方法可以解决这个问题：在页面上放置链接，以根据查询字符串参数将其翻译成其他语言。可以找到一个这样的例子（哎呀，他们不会让我发布另一个链接！！）如果你检查一下，页面的每种文化都已被谷歌和雅虎索引（尽管不是必应）。更高级的方法可以使用 URL 重写与一些花哨的正则表达式相结合，使您的单个本地化页面看起来像它具有多个目录，但实际上将查询字符串参数传递给页面。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-08-05T20:34:41.990

索引成为一个问题。我不认为你可以索引 xml，当然，如果你将它存储为字符串，你就不能索引它，因为每个字符串都以`<localization> <text culture="...">`.

# java - 在Java中计算字符串的显示宽度

> ID：258486
> 
> 赞同：103
> 
> 时间：2008-11-03T12:30:04.750
> 
> 标签：java, string-length

如何在 Java 中计算字符串的长度（以像素为单位）？

最好不使用 Swing。

编辑：我想在 Java2D 中使用 drawString() 绘制字符串，并使用长度进行自动换行。

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2008-11-03T12:36:40.507

如果您只想使用 AWT，则使用[`Graphics.getFontMetrics`](http://docs.oracle.com/javase/6/docs/api/java/awt/Graphics.html#getFontMetrics())（可选地指定字体，对于非默认字体）获取 a`FontMetrics`然后[`FontMetrics.stringWidth`](http://docs.oracle.com/javase/6/docs/api/java/awt/FontMetrics.html#stringWidth(java.lang.String))查找指定字符串的宽度。

例如，如果您有一个`Graphics`名为 的变量`g`，您将使用：

```
int width = g.getFontMetrics().stringWidth(text); 
```

对于其他工具包，您需要向我们提供更多信息——它总是依赖于工具包。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2013-02-12T12:49:02.490

它并不总是需要依赖于工具包，或者并不总是需要使用 FontMetrics 方法，因为它需要首先获取 Web 容器或无头环境中不存在的图形对象。

我已经在 web servlet 中对此进行了测试，它确实计算了文本宽度。

```
import java.awt.Font;
import java.awt.font.FontRenderContext;
import java.awt.geom.AffineTransform;

...

String text = "Hello World";
AffineTransform affinetransform = new AffineTransform();     
FontRenderContext frc = new FontRenderContext(affinetransform,true,true);     
Font font = new Font("Tahoma", Font.PLAIN, 12);
int textwidth = (int)(font.getStringBounds(text, frc).getWidth());
int textheight = (int)(font.getStringBounds(text, frc).getHeight()); 
```

* * *

将必要的值添加到这些尺寸以创建任何所需的边距。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-08-26T18:41:22.027

在以下类中使用 getWidth 方法：

```
import java.awt.*;
import java.awt.geom.*;
import java.awt.font.*;

class StringMetrics {

  Font font;
  FontRenderContext context;

  public StringMetrics(Graphics2D g2) {

    font = g2.getFont();
    context = g2.getFontRenderContext();
  }

  Rectangle2D getBounds(String message) {

    return font.getStringBounds(message, context);
  }

  double getWidth(String message) {

    Rectangle2D bounds = getBounds(message);
    return bounds.getWidth();
  }

  double getHeight(String message) {

    Rectangle2D bounds = getBounds(message);
    return bounds.getHeight();
  }

} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-03-11T19:29:10.067

而现在*完全*不同的东西。以下假设 arial 字体，并根据字符与宽度的线性插值进行疯狂猜测。

```
// Returns the size in PICA of the string, given space is 200 and 'W' is 1000.
// see https://p2p.wrox.com/access/32197-calculate-character-widths.html

static int picaSize(String s)
{
    // the following characters are sorted by width in Arial font
    String lookup = " .:,;'^`!|jl/\\i-()JfIt[]?{}sr*a\"ce_gFzLxkP+0123456789<=>~qvy$SbduEphonTBCXY#VRKZN%GUAHD@OQ&wmMW";
    int result = 0;
    for (int i = 0; i < s.length(); ++i)
    {
        int c = lookup.indexOf(s.charAt(i));
        result += (c < 0 ? 60 : c) * 7 + 200;
    }
    return result;
} 
```

有趣，但也许不是很实用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-25T12:10:31.673

我个人正在寻找一些东西来让我计算多行字符串区域，所以我可以确定给定区域是否足够大以打印字符串 - 保留特定字体。

```
private static Hashtable hash = new Hashtable();
private Font font;
private LineBreakMeasurer lineBreakMeasurer;
private int start, end;

public PixelLengthCheck(Font font) {
    this.font = font;
}

public boolean tryIfStringFits(String textToMeasure, Dimension areaToFit) {
    AttributedString attributedString = new AttributedString(textToMeasure, hash);
    attributedString.addAttribute(TextAttribute.FONT, font);
    AttributedCharacterIterator attributedCharacterIterator =
            attributedString.getIterator();
    start = attributedCharacterIterator.getBeginIndex();
    end = attributedCharacterIterator.getEndIndex();

    lineBreakMeasurer = new LineBreakMeasurer(attributedCharacterIterator,
            new FontRenderContext(null, false, false));

    float width = (float) areaToFit.width;
    float height = 0;
    lineBreakMeasurer.setPosition(start);

    while (lineBreakMeasurer.getPosition() < end) {
        TextLayout textLayout = lineBreakMeasurer.nextLayout(width);
        height += textLayout.getAscent();
        height += textLayout.getDescent() + textLayout.getLeading();
    }

    boolean res = height <= areaToFit.getHeight();

    return res;
} 
```

# cpu - 如何：四核和双四核虚拟化？

> ID：258487
> 
> 赞同：1
> 
> 时间：2008-11-03T12:30:54.857
> 
> 标签：cpu, hyper-v, vmware-server, smp

在双四核物理主机之上，我想运行具有 8 个虚拟 CPU（如果可能）或至少 4 个虚拟 CPU 的单个 VM - 用于科学计算。

我已经调查了市场在这个日期所提供的东西，似乎

*   VMWare Server 2.0 仅限于 2 个虚拟 CPU。
*   Microsoft Virtual Server 2005 RC2 仅限于单 CPU。
*   Microsoft Hyper-V 2008 仅限于 4 个虚拟 CPU（对来宾操作系统有限制）。

有没有办法获得 8 个虚拟 CPU？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T14:23:17.733

Xen、KVM、VirtualBox，都可以模拟比你拥有的更多的 CPU，每个 VM 至少可以模拟 32 个 CPU。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T12:37:40.087

我会为您的应用调查 VMware 的 ESXi：http: [//www.vmware.com/products/esxi/](http://www.vmware.com/products/esxi/)。

他们的产品数据表：http: [//www.vmware.com/files/pdf/vmware_esxi_datasheet.pdf](http://www.vmware.com/files/pdf/vmware_esxi_datasheet.pdf)

# apache-flex - 创建对对象的弱引用

> ID：258505
> 
> 赞同：7
> 
> 时间：2008-11-03T12:38:12.423
> 
> 标签：apache-flex, flash, actionscript-3, garbage-collection, weak-references

是否可以在 Actionscript 3 中创建对对象的弱引用，以便对其进行垃圾收集。

我正在创建一些类以使调试更容易，因此如果仅在此处引用它们，我不希望对象在内存中徘徊（当然我不想用回调填充代码以删除对象）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T12:49:14.617

Grant Skinner 撰写了一系列关于[ActionScript 3 资源管理](http://www.gskinner.com/blog/archives/2006/06/as3_resource_ma.html)的优秀文章，在该系列的第三部分中，他介绍[了可用于此目的的 WeakReference 和 WeakProxyReference](http://www.gskinner.com/blog/archives/2006/08/as3_resource_ma_2.html)辅助类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T12:38:34.700

现在我创建了一个简单的类来利用 Dictionary weakKeys 参数：

```
public class WeakReference
{
    private var dic

    public function WeakReference(object)
    {
        this.dic = new Dictionary(true)
        this.dic[object] = true
    }

    public function get Value()
    {
        for (var object in this.dic)
        {
            return object
        }
        return null
    }
} 
```

# linux - linux命令的词源

> ID：258509
> 
> 赞同：11
> 
> 时间：2008-11-03T12:39:52.343
> 
> 标签：linux

只是为了好玩......我倾向于通过整天寻找偶然的谜题来保持自己的警觉。我喜欢 linux 的一件事是它所体现的永无止境的聪明才智，从优雅的简洁一直到手册页中的注释。

*您能否阐明规定新命令如何命名的不成文规则，或者提供一些常用命令背后的历史？库存 linux 发行版缺少什么基本命令——它会做什么，你会怎么命名它？*

**例子：**

*   `cat`用于连接*文件*。`dog`它已在某些发行版 中被取代。
*   `ssh`提供了一个*安全的外壳*，但它只是*乞求*发音为“ssssshhhhh！”并不是巧合。

*额外谜题：* 我们的一位长期客户是 MCI，他们的送货地址是 1101 Summit Ave。现在，MCI 是一家大公司，可能可以选择任何地址……那为什么是 1101？令人惊讶的是，我从来*没有*遇到过知道这个答案的 MCI 员工……但当时他们没有这样的答案！

**编辑：在这失控之前：请不要*简单*地列出命令！我正在寻找上述*斜体*问题的答案。谢谢！**

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2008-11-03T13:47:06.077

有点开玩笑的答案，但引用自[http://www.mindspring.com/~blackhart/requium.html](http://www.mindspring.com/~blackhart/requium.html)：

> 我只能想出一种用于创建 Unix 命令名称的算法：想一个好的英文单词来描述你想要做什么，然后想一个晦涩的近义词或部分同义词，随意丢弃所有元音缩短剩下的部分，然后，最后，作为对有文化的程序员的慰问，也许重新插入丢失的元音之一。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2008-11-03T12:43:45.487

罗马数字中的 MCI = 1101...直到现在我才点击它:)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-03T14:19:09.100

*   ed = 编辑
*   ex = 扩展（编辑）
*   vi = VIsual（ex 中的 :visual 命令）
*   vim = Vi 改进
*   vile = VI Like Emacs

*   TECO = 文本编辑器和校正器

*   Emacs = 编辑 MACroS（适用于东元）

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2008-11-03T14:45:54.023

“更多”实用程序的命名是因为每页后都有提示。“less”实用程序是另一个寻呼机应用程序，之所以如此命名是因为“少即是多”。

Mailers 有着悠久的时髦名字历史。榆树是“电子邮件”。Pine 是首字母缩略词“pine is no longer elm”。Balsa 的重量很轻。

不是 Linux，而是 Mac OS X 工具将多个单架构二进制文件粘合到一个单一的多架构二进制文件（也称为“胖”二进制文件）称为“lipo”。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2008-11-13T15:37:00.480

`tac`以反向行顺序列出文件，即`cat`向后的输出。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2008-11-03T14:14:59.950

`grep`来自 ed 命令、g/re/p 或全局搜索正则表达式和打印。

`yacc`，当然，是又一个编译器编译器。

`perl`是实用提取和报告语言（另见评论）。

`roff`是“runoff”（存在于其他非 Unix 机器上的类似系统）的简单缩写；`troff`是 'typsetting roff' 或类似的东西；我猜那`nroff`是“非排版 roff”；`tbl`是“table”的简单缩写；`eqn`是“方程”的简单缩略；`grap`是“graph”的简单缩略（以及为什么觉得有必要去掉“h”对我来说仍然是个谜）；`pic`可能只是“图片”的简单缩写；`refer`是“引用”的简单缩写；并且`chem`是“化学”（或“化学”，或...）的简单缩写。

理想情况下，这个名字很短，（几乎）可以发音，并且（如果你知道这个秘密）至少是半记忆的。在某种程度上，这在今天仍然适用。程序名称是根据作者愿意使用的任何基础选择的。

* * *

直接回答问题 - 缺少什么命令（并且有一个异想天开的名字）......

```
$ dribbler -h
Usage: dribbler [-hV][-s sleep][-f file][-m message][-o openstr]
  -V           Print version information and exit
  -f file      Write to named file
  -h           Print this help message and exit
  -m message   Write message on each line of output
  -o openstr   Flags passed to fopen()
  -s sleep     Sleep for given interval between writes 
```

这是一个不热情的对应物`yes`。相比之下`yes`，将内容尽可能快地写入输出管道，`dribbler`发送少量信息，足以使接收端的进程保持活跃，但不足以淹没系统。

* * *

我喜欢的另一个命令是`bombard`：

**轰炸**- 用信号轰炸正在测试的程序

```
 bombard [-s sig][-rvV][-t mintime][-T maxtime][-i iterations] -- cmd [args ...] 
```

Bombard 运行由 `cmd [args ...]' 指定的测试程序，并使其接受一个或多个信号。它可用于对程序的信号处理特性进行随机测试。

'-s' 选项指定发送哪个信号；默认为 SIGINT。'-V' 选项打印程序版本号并退出。'-r' 选项重复发送信号。'-i' 选项指定信号要重复多少次；如果指定了“-r”而未指定“-i”，则默认值为 1000。如果未指定“-r”选项，则该标志无效。'-v' 选项打印关于测试程序每次运行结果的详细信息。'-t' 选项指定发出信号之前的最小延迟（以秒为单位）；默认值为 0。“-T”选项指定发出信号之前的最大延迟（以秒为单位）。' `--`'

如果只指定了'-t'，则bombard 休眠指定的时间，然后向进程发送信号。如果同时指定了“-t”和“-T”，则bombard 在指定范围内随机休眠一段时间，然后向进程发送信号。

显然，所有时间都受制于内核调度算法的特性。

* * *

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2008-11-03T15:35:05.313

Unix biff cmd（宣布电子邮件到达）以某人的狗命名，每当邮递员到达时它就会吠叫。[http://en.wikipedia.org/wiki/Biff](http://en.wikipedia.org/wiki/Biff)

计算早期的许多其他有趣的花絮可以在 The Jargon File 中找到。[http://en.wikipedia.org/wiki/Jargon_File](http://en.wikipedia.org/wiki/Jargon_File)

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2008-11-03T17:08:55.373

我们不要忘记“***不是***”递归命名方案：

*   pine = Pine **I** s **not** E **lm** **（**尽管其中一位原作者否认了这一点，它现在正式代表“ **Pine** Internet News and **E** **-** **mail** ”）

*******   wine = **Wine****不是** **模拟器**_ **_** _****** 

 ******而且当然：

*   GNU = **G** NU 不是U **nix** **（**尽管本身不是命令）

 *** * *

## 回答 #9

> 赞同：4
> 
> 时间：2008-11-03T13:05:33.273

zsh 是作者钟少的登录名

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2008-11-03T13:41:31.097

GNU 对 yacc 解析器生成器的替换被命名为 bison。

在相关的说明中，我们最近对 tee 命令进行了一个小改动，以便在其输出中插入时间戳以调试一个令人讨厌的问题。我们称之为新命令？开球时间，当然 :-)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2008-11-03T12:49:51.263

许多 UNIX 命令在历史上都有短名称，因此在使用慢速电传打字机的日子里，在终端中输入的内容更少，在某种程度上，这种传统甚至在今天仍然存在。

至于 MCI 的东西，他们有几个以 1101 开头的地址，MCI 在罗马数字中是 1101。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2008-11-03T16:53:15.593

fsck = 文件系统检查（注意先前记录的丢弃所有元音和尽可能多的辅音的规则。

在我的经验中最常被用作[亵渎](http://en.wikipedia.org/wiki/Fsck#Use_as_profanity)，我只听到它以两种不同的方式发音：“FSCK”（即跛脚）和“F-Suck”（正确）。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-03T16:10:07.550

关于 mp3 编码器 LAME，它代表Lame **A** in't an **M** p3 **E** **ncoder** :)

 ***** * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-05-09T07:53:47.853

`awk`以作者姓名的首字母命名：Alfred V. Aho、Peter J. Weinberger 和 Brian W. Kernighan。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2008-11-03T12:44:24.003

我对明显相关的工具的了解越来越少。它们以小块的形式显示文件的内容，因此它们可以显示在屏幕上。在这种情况下，少即是多。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-03T16:15:37.057

将 VMS 风格的冗长的 'option=mode' 命令放入 'dd' 是因为有人抱怨 unix 命令上的简短隐秘选项。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-11-03T16:27:46.983

pic - troff 的基于文本的图片生成语言前端 cip - 读取/生成图片文件的 GUI

[Blit 终端](https://eprints.kfupm.edu.sa/69014/1/69014.pdf)不是贝尔实验室的智能终端，而是简单的 bitblt 操作。 [Mgr Window Manager](http://en.wikipedia.org/wiki/ManaGeR)据称代表“经理”。当我开始使用/处理它时，仍然有人将 munger 从动词称为[mung(e)](http://en.wikipedia.org/wiki/Mung)。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-05-09T07:43:53.963

[这个](https://stackoverflow.com/questions/686216/what-code-would-you-have-on-your-wedding-cake/687556#687556)对婚礼蛋糕问题的回答让我对这些名字背后的真正动机有了新的认识……

[军事 crontab](https://stackoverflow.com/questions/686216/what-code-would-you-have-on-your-wedding-cake/687556#687556)：

```
# DO NOT EDIT THIS FILE - until death
# (/marriage/crontab.XXX installed on Sat Apr  4 11:26:10 2009)
# (Cron version V5.0 -- $Id: crontab.c,v 1.12 2004/01/23 18:56:42 vixie Exp $)
0 21 * * * unzip; strip; touch; grep; finger; mount; fsck; more; yes; umount; sleep 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2008-11-03T12:56:04.167

`sed`= **s** tream **ed** itor ...但我不禁想，*那不是我的sed！* 巧合？

# java - 类型与泛型不匹配

> ID：258529
> 
> 赞同：3
> 
> 时间：2008-11-03T12:48:29.423
> 
> 标签：java, generics, types, mismatch

这是一个界面：

```
public interface Foo<T> extends Comparable<Foo<T>>  {
   ...
} 
```

并且有一些类实现了这个接口：

```
public class Bar extends Something implements Foo<Something> {
    public Vector<Foo<Bar>> giveBar() {
        ...
    }
}

public class Boo extends SomethingElse implements Foo<SomethingElse> {
    public Vector<Foo<Boo>> giveBoo() {
        ...
    }
} 
```

现在我想在一个向量中保留一堆 Foos（可能真的是 Foos 或 Boos）。

```
Bar bar = new Bar();
Boo boo = new Boo();
Vector<Foo<?>> vector;
if (...) 
   vector = bar.giveBar();
else
   vector = boo.giveBoo(); 
```

我得到：

```
Type mismatch: cannot convert from Vector<Foo<SomethingElse>> to Vector<Foo<?>> 
```

这同样适用于：

```
Vector<Foo> vector;
if (...) 
   vector = giveBar();
else
   vector = giveBoo(); 
```

Bar 和 Boo 都扩展了这个问题的唯一解决方案的超类吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T13:31:02.397

所有这些代码归结为：

```
Vector<A> vector = new Vector<B>(); 
```

在这种情况下，B 扩展了 A，但这是不允许的，因为类型不匹配。为了弄清楚为什么这不起作用，请想象以下代码：

```
Vector<Vector<?>> vector = new Vector<Vector<String>>();
vector.add(new Vector<Integer>()); 
```

变量的类型是*未知类型向量的向量*；分配给它的是一个*由 strings 向量组成的向量*。第二行添加了一个*整数向量*。变量的组件类型`Vector<?>`，接受`Vector<Integer>`; 但实际向量的组件类型是`Vector<String>`，而不是。如果编译器不反对第一行的赋值，它将允许您编写不正确的第二行而不会被发现。

C# 的泛型也有类似的限制，但不同的是，C# 中的泛型类存储它的组件类型，而 Java 在编译代码时会忘记组件类型。

ps - 你到底为什么使用`Vector`而不是`LinkedList`or `ArrayList`？是因为涉及线程问题吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T13:36:49.000

您可以使用

```
Vector<? extends Foo<?>> vector; 
```

# language-agnostic - 贫血域模型：优点/缺点

> ID：258534
> 
> 赞同：82
> 
> 时间：2008-11-03T12:49:33.713
> 
> 标签：language-agnostic, design-patterns

我想知道使用贫血域模型的优缺点是什么（见下面的链接）。

[福勒文章](http://www.martinfowler.com/bliki/AnemicDomainModel.html "福勒文章")

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2011-05-01T08:10:08.760

“贫血领域模型”是反模式，为什么会有这么多系统实现这一点？

我认为有几个原因

**1\. 系统的复杂性**

如果我想实现一个简单的系统（这几乎是您在互联网上找到的所有示例和示例代码）：

将产品添加到订单

我把这个功能放在订单上

```
public void Order.AddOrderLine(Product product)
{
    OrderLines.Add(new OrderLine(product));
} 
```

尼斯和超级面向对象。

现在假设我需要确保我需要验证产品是否存在于库存中，如果不存在则抛出异常。

我真的不能再把它放在订单上，因为我不希望我的订单依赖于库存，所以现在它需要继续服务

```
public void OrderService.AddOrderLine(Order order, Product product)
{
    if (!InventoryService.Has(product)
       throw new AddProductException

    order.AddOrderLine(product);
} 
```

我还可以将 IInventoryService 传递给 Order.AddOrderLine，这是另一种选择，但这仍然使 Order 依赖于 InventoryService。

Order.AddOrderLine 中仍有一些功能，但通常仅限于 Order 范围，而根据我的经验，Order 范围之外还有更多业务逻辑。

当系统不仅仅是基本的 CRUD 时，您最终会在 OrderService 中使用大部分逻辑，而在 Order 中使用很少。

**2\. 开发者对OOP的看法**

互联网上有很多关于应该在实体上进行哪些逻辑的激烈讨论。

就像是

订购.保存

Order是否应该知道如何自救？假设我们有相应的存储库。

现在Order可以添加订单行吗？如果我试图用简单的英语来理解它，它也没有任何意义。用户将产品添加到订单中，那么我们应该使用 User.AddOrderLineToOrder() 吗？这似乎是矫枉过正。

OrderService.AddOrderLine() 怎么样。现在有点道理！

我对 OOP 的理解是，为了封装，您将函数放在需要访问类内部状态的类上。如果我需要访问 Order.OrderLines 集合，我将 Order.AddOrderLine() 放在 Order 上。这样类的内部状态就不会暴露。

**3\. IoC 容器**

使用 IoC 容器的系统通常完全乏力。

这是因为您可以测试具有接口的服务/存储库，但不能（轻松地）测试域对象，除非您将接口放在所有对象上。

由于“IoC”目前被誉为解决所有编程问题的解决方案，因此很多人盲目地追随它，最终导致贫血领域模型。

**4\. OOP 难，程序简单**

我对此有点“[知识诅咒](http://www.businesspundit.com/the-curse-of-knowledge-why-communication-at-work-is-sometimes-difficult/)”，但我发现对于拥有 DTO 和服务的新开发人员来说，比 Rich Domain 容易得多。

可能是因为使用 Rich Domain 更难知道将逻辑放在哪些类上。何时创建新课程？使用哪些模式？ETC..

使用无状态服务，您只需将其添加到名称最接近的服务中。

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2008-11-07T19:15:25.897

优点：

*   你可以声称它是一个领域模型，向你的开发者朋友吹嘘，然后把它写在你的简历上。
*   从数据库表中自动生成很容易。
*   它非常好地映射到数据传输对象。

缺点：

*   您的域逻辑存在于其他地方，可能在一个充满类（静态）方法的类中。或者你的 GUI 代码。或者在多个地方，都具有相互矛盾的逻辑。
*   这是一种反模式，因此其他开发人员会问您是否了解面向对象设计的概念。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2011-09-26T23:12:56.653

此后，我的脑海里一直有一个想法。我相信“OOP”这个词的含义并不真正适用于它。字谜的意思是“面向对象编程”，我们都知道。重点当然是“面向”这个词。它不是“OMP”，意思是“对象强制编程”。ADM 和 RDM 都是 OOP 的示例。它们利用对象、属性、方法接口等。但是，在我们选择封装事物的方式上，ADM 和 RDM 之间存在差异。他们是两个不同的东西。说 ADM 是糟糕的 OOP 并不是一个准确的说法。也许我们需要不同的术语来代替各种级别的封装。此外，我从不喜欢反模式这个词。它通常由对立团体的成员分配给某物。ADM 和 RDM 都是有效的模式，它们具有不同的目标，旨在解决不同的业务需求。我们这些实践 DDD 的人至少应该欣赏这一点，而不是落入别人的水平，去抨击那些选择实施 ADM 的人。只是我的想法。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-02-28T14:29:07.217

“这是一种反模式，所以其他开发人员会问你是否了解面向对象设计的概念。”

“贫血的领域模型是一种反模式。反模式没有优点。”

贫血域模型是否是反模式是一个见仁见智的问题。Martin Fowler 说是这样，许多对 OO 了如指掌的开发人员说不是。将意见陈述为事实很少有帮助。

一个，即使它被普遍认为是一种反模式，它仍有可能有一些（尽管相对较小）的上升空间。

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2008-11-03T14:01:29.103

在我看来，Fowler 的主要反对意见是 ADM 不是 OO，在以下意义上。如果一个人围绕由其他代码片段操作的被动数据结构“从头开始”设计一个系统，那么这肯定更像是过程设计而不是面向对象的设计。

我建议至少有两种力量可以产生这种设计：

1.  仍然认为程序上需要在面向对象环境中工作（或假设他们可以......）以生成**新**系统的设计师/程序员，以及

2.  开发人员致力于在以非 OO 方式（不管语言）设计的**遗留**系统上放置类似服务的“面孔” 。

例如，如果一个人正在构建一组服务来公开现有 COBOL 大型机应用程序的功能，则可以根据**不**反映内部 COBOL 数据结构的概念模型来定义服务和接口。但是，如果服务将新模型映射到遗留数据以使用现有但隐藏的实现，那么新模型很可能是 Fowler 文章意义上的“贫血”——例如，一组 TransferObject 样式的定义和没有真实行为的关系。

这种折衷对于理想主义纯 OO 系统必须与现有的非 OO 环境交互的边界很常见。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2011-05-12T18:47:36.957

如果您的团队无法或不愿意构建富域模型 (RDM) 并随着时间的推移对其进行维护，贫血域模型 (ADM) 可能是一个不错的选择。使用 RDM 取胜需要仔细注意系统中使用的主要抽象。想象一下，在任何开发组中，不超过一半，也许只有十分之一的成员能够胜任抽象。除非这个干部（也许只有一个开发人员）能够对整个团队的活动保持影响力，否则 RDM 将屈服于熵。

熵 RDM 会在某些方面造成伤害。它的开发人员将吸取惨痛的教训。起初，他们将能够满足利益相关者的期望，因为他们没有历史可辜负。但是随着他们的系统变得更加[复杂（不复杂）](http://codebetter.com/drusellers/2009/09/25/complex-vs-complicated/)，它会变得脆弱；开发人员会尝试重用代码，但往往会在开发过程中引入新的错误或回溯（从而超出他们的估计）。

相比之下，ADM 开发人员会为自己设定较低的期望，因为他们不会期望为新功能重用那么多代码。随着时间的推移，他们将拥有一个具有许多不一致之处的系统，但它可能不会意外中断。他们的上市时间将比成功的 RDM 更长，但他们的利益相关者不太可能察觉到这种可能性。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2009-05-05T17:32:43.510

“开发人员致力于在以非 OO 方式（无论语言）设计的遗留系统上放置类似服务的“面孔”。”

如果您想到许多 LOB 应用程序，这些遗留系统通常不会使用与您相同的域模型。Anemic Domain Model 通过在服务类中使用业务逻辑解决了这个问题。您可以将所有这些接口代码放入您的模型中（在传统的 OO 意义上） - 但您通常最终会失去模块化。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2012-06-21T00:15:45.587

当我第一次看到贫血领域模型文章时，我想“我的天，这就是我所做的。恐怖！” 我坚持并遵循了对 Eric Evan 的书的引用，认为这是一个很好的例子，并下载了源代码。事实证明，“不使用贫血域模型”并不意味着“不使用服务类、不使用中介、不使用策略”，甚至不意味着“将逻辑放在被操作的类上”。

DDD 示例具有服务类、XyzUpdaters、单例和 IoC。

我仍然对贫血域模型到底是什么感到困惑。我期待“当我看到它时我会知道它”。现在我满足于一个好的设计的正面例子。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2017-03-26T11:00:32.223

在使用带有 ADM 的“成熟”系统后，我觉得我至少可以为这个问题提供一些轶事反馈。

1）缺乏封装

在带有 ADM 的实时系统中，可以编写例如 'obj.x = 100; obj.save'，即使这违反了业务逻辑。如果不变量是在对象上建模的，这会导致一些不会遇到的错误。我认为这些错误的严重性和普遍性对 ADM 来说是最严重的负面影响。

我觉得有必要在这里指出，这是一个功能解决方案和 ADM 的程序解决方案显着不同的地方，其他人可能对 ADM 和功能解决方案之间的表面相似性产生的任何相似之处都是偶然的。

2) 代码膨胀

我估计 ADM 中生成的代码量是 OOP/RDM 解决方案将创建的代码量的 5-10 倍。这可能是因为 50% 是代码重复，30% 是样板代码，20% 是由于缺乏 RDM 引起的问题的解决或解决。

3）对领域问题的理解不足

ADM 和对领域问题的理解不足在某种程度上是齐头并进的。出现了幼稚的解决方案，由于难以用现有的 DM 支持需求而没有考虑需求，并且由于开发时间较长且缺乏灵活性，ADM 成为业务创新的重要障碍。

4) 维护困难

考虑到该概念可能不仅仅是复制和粘贴的重新实现，需要一定程度的严格性来确保域概念在其表达的所有地方都发生了变化。这通常会导致多次调查和修复相同的错误。

5) 入职难度增加

我认为 RDM 的好处之一是概念的凝聚力，可以更快地理解领域。使用 ADM 时，概念可能是支离破碎的，缺乏清晰性，因此新开发人员更难掌握。

我也很想将 ADM 的运营支持成本包括在 RDM 之上，但这取决于许多因素。

正如其他人所指出的，请查看 DDD（Greg Evans、Vince Vaughn 和 Scott Millett）以了解 RDM 的好处。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2010-11-08T21:42:43.610

这与大多数反模式的优点相同：它可以让很多人长时间忙碌。由于管理者在管理更多人时往往会获得更多报酬，因此有强烈的动机不去改进。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2011-06-27T19:47:17.390

根据 Eric P 的回答以及上面其他人所写的内容，ADM 的主要缺点似乎是 OOD 的丢失，特别是将域概念的逻辑和数据保持在一起，以便在隐藏实现细节的同时API可以很丰富。

Eric 继续指出，域类之外的信息通常是对该类执行逻辑所必需的，例如在将商品添加到订单之前检查库存。不过，我质疑答案是否是包含此总体逻辑的服务层，或者它是否作为对象设计的一部分更好地处理。 *必须有人*知道 Inventory 对象、Product 对象和 Order 对象。也许它只是一个 OrderSystem 对象，它有一个 Inventory 成员、一个 Orders 列表等等。这看起来与服务没有太大不同，但我认为它在概念上更加连贯。

或者这样看：您可以拥有一个具有内部信用余额的用户，并且每次调用 User.addItemToOrder(item) 时，它都会获取项目的价格并在添加它之前检查信用等。这似乎是一个合理的 OO设计。我不确定用 Service.addItemToUserOrder(user, item) 替换它会丢失什么，但我也不确定得到了什么。我想损失将是额外的代码层，加上笨拙的写作风格和对底层域模型的强制无知。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2012-07-14T12:31:43.017

应该注意的是，随着系统的复杂性和变化粒度的增长，精心设计的消息传递对象模型所提供的接口点的封装和整合使得在不进行广泛重构的情况下更改和维护关键代码变得更加安全。

ADM 创建的服务层虽然更容易实现（因为它们需要相对较少的思考并且有许多分散的接口点），但当需要修改一个活跃且不断增长的系统时，可能会在未来产生麻烦。

我还可以补充一点，并非所有情况都需要域模型（更不用说 ADM 了）。有时最好使用更程序化/功能化的任务风格，它是数据驱动的，不依赖于应用程序范围的逻辑/业务规则。

如果您试图决定整个应用程序的优缺点，我认为在开始编写单行代码之前，首先设计每个应用程序的外观是很重要的。一旦您以两种样式对您的应用程序进行了 CRC 处理或线框化，请退后一步，决定哪一种更有意义并且更适合应用程序。

还要提前考虑哪个更容易维护......

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-03-02T14:12:16.377

它提供了更好的可预测性。经理喜欢这样，特别是如果项目是有偿时间和材料的。每一次改变都意味着大量的工作，因此艰巨的工作可能隐藏在大量重复性工作的背后。在精心设计的 DRY 系统中，可预测性非常糟糕，因为您不断地做新的事情。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2020-07-28T23:36:28.740

在我第一次阅读 Eric Evans 关于领域驱动设计的书后，我并没有真正理解它不仅仅是一组用于设计好的领域模型类的战术模式。

在了解了有关该主题的更多信息并使用了战略模式之后，我终于开始明白，起初*这一切都是为了深入了解*您要解决的业务问题。

只有在此之后，您才能决定系统的哪些部分适合应用诸如**聚合、实体、存储库等***战术模式*以及所谓***的富***域模型（与*贫血*模型相反）。但是为了从这些模式中受益，系统的那部分*业务逻辑必须**足够****复杂。***

 *******因此，在实施手头问题的解决方案时，应首先确定是否使用基于**CRUD**的方法或投资于***丰富的*领域模型**以及上述战术模式来更好地解决这个特定问题。

如果 CRUD 更有意义，例如，如果没有复杂的业务逻辑，并且大部分逻辑都与转换、传输和持久化实现域模型的数据有关，则可能是不必要的矫枉过正。这并不意味着不会有很多工作要做，而仅仅是产生最多实施工作的不是业务规则。*但**在这种情况下，不存在*贫血域模型***之类的东西，仅仅是因为根本***没有域模型****。你更愿意看到的是诸如**DTO**（数据传输对象）或**DAO之类的东西**（数据访问对象）和将对数据进行操作的服务类。相应的操作在很大程度上涉及将数据从一种表示形式转换为另一种表示形式，并在几乎没有业务逻辑的情况下移动数据。

如果您确定有*很多复杂的业务逻辑*也会随着时间而改变，那么根据我的经验，*投资领域模型是一个好主意。*原因是更容易通过代码表示业务视角，更容易理解反映业务领域及其规则的相应操作。这并不意味着在每个用例中都必须有领域模型类。例如，如果没有要改变和持久化的状态，也只能是包含域逻辑的域服务，其实现更像纯函数。

但是，如果在业务领域中也有需要改变和持久化的状态，并且该状态也具有目的和意义，则应该**封装**状态和更改此状态的行为。这样一来，没有人可以轻松绕过业务规则，从而导致无效状态和严重故障。*所谓的*贫血*域模型通常是此类问题的根源*。如果您看到不同组件在同一个“贫血”域模型类上运行的代码检查其状态的某些部分并更改其状态的某些部分而不关心或知道该业务实体的整体不变量，则通常是这种情况。没有必要将其称为反模式，但重要的是要了解*您在基于 DDD 的方法中失去了*丰富*领域模型*的许多好处以及上述问题。当使用行为及其数据放在同一个类中的域模型时，也可能有许多不同的“客户”调用该类的操作，但他们不需要关心业务实体的业务不变量是否被遵守域模型类将始终处理这一点，并且还可以通知“客户端”有关无效操作甚至抛出异常作为安全网。

So **bottom line**, I think it is important to **not confuse data-structure like classes (such as DTOs or DAOs) with anemic domain model classes**. In a carefully and intentionally chosen CRUD based approach there is no advantage of trying to use a domain model because there is too less complex business logic.

By *anemic domain model* I would refer to code from which I can see that there is a lot of complex business logic and business rules that are spread across different components which should rather be close to the data these logic is changing.

在此过程中，我还学到了另一个教训：如果您尝试在代码中使用与牛排老板在日常工作中使用的相同的业务语言（也称为***通用语言***），那么您已经在理解业务领域并提高代码的可读性，无论您使用基于 CRUD 还是基于域模型的方法，这对您都有很大帮助。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2012-01-05T14:42:34.353

为了扩展迈克尔的回答，我认为（相当）清楚该代码应该放在哪里：进入处理订单和库存之间交互的专用调解器。

从我的观点来看，该域的关键在于它必须具有简单的测试行为、 `isInThisState()`方法等。根据我的经验，这些也分散在大多数公司的服务眼泪中（原文如此 :)），并且要么被复制，要么被无休止地重写。所有这些都违反了标准的衔接规则。

在我看来，这种方法应该是*针对*一个尽可能多地掌握商业行为的 DM，将其余部分放在明确指定的区域（即不在服务中）

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2012-03-18T11:15:38.770

我的团队个人更喜欢 ADM。我们有一组代表我们领域特定部分的业务对象。我们使用服务将这些对象保存到数据库中。我们的业务对象确实有方法，但是这些方法只操纵它的内部状态。

使用 ADM 而不是 RDM 对我们的好处可以从我们如何将对象持久化到 db 中看出。处理我们遗留代码系统的开发人员可以使用我们的业务对象（来自新系统）并继续使用他们当前的数据访问层将这些对象持久化到数据库中。使用 RDM 将迫使我们遗留系统的开发人员将 Repository 对象注入我们的业务模型中……这与他们当前的数据访问层不一致。

* * *

## 回答 #17

> 赞同：-17
> 
> 时间：2008-11-06T20:54:54.463

[贫血域模型](http://www.martinfowler.com/bliki/AnemicDomainModel.html)是一种反模式。反模式没有优点。

# sharepoint - 检查列表中项目的权限

> ID：258537
> 
> 赞同：0
> 
> 时间：2008-11-03T12:50:44.020
> 
> 标签：sharepoint, permissions

在项目只能由所有者或管理员更改的列表中，我如何通过代码检查用户是否可以编辑项目。

我试试

```
item.DoesUserHavePermissions(SPBasePermissions.EditListItems); 
```

它将返回 True，因为用户可以在列表中添加和编辑项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T21:35:10.203

根据作者字段检查用户可能是唯一的方法。

或者，您可以通过进行查询来限制用户可以尝试编辑的项目列表，该查询仅带回他们是作者的项目，除非他们拥有更广泛的权限。

使用 SPRoleDefinition 和 SPRoleAssignment 类检查更广泛的权限。

否则，只需尝试编辑并捕获异常并将其返回给用户。

# winapi - 如何实时处理麦克风输入？

> ID：258551
> 
> 赞同：3
> 
> 时间：2008-11-03T12:58:41.417
> 
> 标签：winapi, audio, signal-processing, microphone, directsound

我开始为我的想法创建概念验证，此时，我需要一些关于我应该如何开始的指导。

我需要对麦克风输入进行采样，并实时处理该信号（想想自动调谐，但要实时工作），而不是“录制”一段时间。

我正在做的是“一种”“麦克风输入到 MIDI 转换器”，因此它需要快速响应。

我在网上调查了一下，显然要走的路是 DirectSound 或 WaveIn* API 函数。现在，根据我阅读的内容，WaveIn API 将让我填充一定大小的缓冲区，这对于录制和后期处理来说是很好的，但我想知道......我如何进行实时处理？

我是否使用 10ms 缓冲区并自己保持循环 50ms 或 100ms 数组，并且我得到一个每 10ms 触发一次分析的函数？（可以访问最新的100ms的输入，其中只有10ms是新的）

我在这里错过了什么吗？

另外，DirectSound 是如何做到的？与常规 Win32 API 相比，它是否为我提供了任何改进的功能？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2008-11-03T13:23:36.827

DirectSound 和 Wave API 最终都为您提供了填充了您可以处理的音频数据的缓冲区。这些缓冲区的大小可以变化，但实际上您需要将延迟保持在 10 毫秒以下才能进行有用的实时处理。这意味着在数据到达缓冲区的 10 毫秒内处理数据，减去数据到达音频硬件和到达缓冲区之间的时间，这取决于驱动程序。出于这个原因，我建议一次处理不超过 5 毫秒的数据。

两者之间的主要架构差异在于，使用 DirectSound，您分配一个循环缓冲区，然后由 DirectSound 音频驱动程序填充，而 Wave API 采用预先分配的 WAVEHDR 缓冲区队列，这些缓冲区被填充、返回到应用程序然后回收。两种 API 都有多种通知方法，例如窗口消息或事件。但是，对于低延迟处理，可能建议维护一个专用的流线程并等待新数据到达。

出于各种原因，我会推荐 DirectSound 而不是 Wave API 进行新开发 - 它肯定会更容易实现更低的延迟。

无论您选择哪种方法进行捕获，一旦您获得数据，您只需将其传递给您的处理算法并等待下一个缓冲区准备好。只要您能够比数据更快地处理数据，那么您就可以进行（伪）实时分析。

还有一些可能更合适的替代 API。看看[ASIO](http://en.wikipedia.org/wiki/Audio_Stream_Input/Output)、 Kernel Streaming （仅适用于 XP - 我不会打扰）以及 Vista 中的新功能[Core Audio APIs](http://msdn.microsoft.com/en-us/library/ms678710(VS.85).aspx)。

# architecture - 您将如何显示/布局企业应用程序之间的数据流？

> ID：258554
> 
> 赞同：2
> 
> 时间：2008-11-03T12:59:39.447
> 
> 标签：architecture, enterprise, visualization, dataflow

我的雇主是一家大型瑞士电信公司。我们有许多系统用于为不同的任务传输数据，例如性能管理、故障管理、配置管理等。

为了向“管理”（尖头发和其他）解释这些系统如何交互，我将有关数据流/格式/协议的信息收集到“数据库”（逗号分隔的劝说）中，然后为 Graphviz 生成代码（[http： //www.graphviz.org/](http://www.graphviz.org/) ) 和 Yed ( [http://www.yworks.com/en/products_yed_about.html](http://www.yworks.com/en/products_yed_about.html) ) 来可视化这些图表。

显示从我的数据库生成的这些图表起初相当有效..但是添加新的系统/数据流会导致 Graphviz 和 Yed 重新布局图表，因为这就是它们的工作方式......自然这真的让任何试图匹配的人感到困惑昨天看到的那个图，到今天显示的那个图。

您将如何显示/布局企业应用程序之间的数据流？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T13:28:07.923

如果您想坚持使用 graphviz 并从您的数据中生成

1.  制作新图表
2.  生成具有确切位置的 Dot 文件
3.  打印出新图表
4.  编辑点文件以删除新的东西
5.  打印出之前的图表

他们无法将新图表与您给他们的图表进行比较，但他们将有两个可以相互比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-03T10:31:21.610

似乎没有工具可以满足我的要求。

我们（=我的雇主，从那以后我开始从事其他工作）现在正在使用多 $$ click-ed-y-click 工具。有用 ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-24T08:29:11.640

我迟到了，但谁知道呢，你会为这项任务重新分配美好的一天：对于 GraphViz，你不仅可以定义确切的位置，还可以控制排名级别。例如，它们用于将日期标签和事件保存在时间线图中的同一列中。

本文档中有一个很好的示例，请转到第 16 页：http: [//www.graphviz.org/pdf/dotguide.pdf](http://www.graphviz.org/pdf/dotguide.pdf)

无论如何，如果您使用排名，您必须编写一段代码，从源数据中提取排​​名信息，或者，最坏的情况是，您必须手动将此信息添加到项目中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-12T22:04:27.043

解决此问题的一种方法是使用**图层**功能（请参阅[https://www.graphviz.org/pdf/dotguide.pdf](https://www.graphviz.org/pdf/dotguide.pdf)）。虽然它不能保证今天的布局与旧版本完全一致，但它会重新布局旧图以与最新图保持一致。它确实可以轻松生成多个视觉上一致的图表。
（好吧，简单是夸大了。您必须生成 Postscript 输出并将其转换为 PDF 和/或任何您想要的。）

# vba - OpenArgs 是空问题

> ID：258556
> 
> 赞同：11
> 
> 时间：2008-11-03T12:59:57.450
> 
> 标签：vba, ms-access, openform, openargs

我在使用时使用`OpenArgs`参数发送值`DoCmd.OpenForm`：

```
DoCmd.OpenForm "frmSetOther", acNormal, , , acFormAdd, acDialog, "value" 
```

然后我`Me.OpenArgs`在打开的表单中使用来获取***value***。它有时会发送**Null**值而不是原始字符串。怎么了？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2008-11-03T15:28:10.943

这通常发生在开发过程中，当表单已经打开（例如在编辑模式下）并且您调用 docmd.OpenForm 函数时。在这种情况下，表单被置于正常（查看）模式并引发 OnOpen 和 OnLoad 事件，但无论您传递给 docmd.OpenForm 什么，OpenArgs 属性都设置为 null。

解决方案显然是在使用 docmd.OpenForm 调用它之前关闭表单。但是有一个我喜欢使用的解决方法。在 OnOpen 事件中，我检查 me.OpenArgs 是否为空，如果是，我将其替换为一些调试值。

```
if not isnull(me.OpenArgs) then
   myvalue = me.OpenArgs
else
   msgbox "Debug mode"
   myValue = "foo"
endif 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-14T04:01:00.903

我刚遇到这个问题。`Arg`字符串没有通过，因为报告已经打开，但不可见。当代码与`Null string error`.

解决方案是在即时窗口中关闭报告，使用

```
Docmd.Close acReport, "myReport" 
```

它修复了我的错误，并且参数被正确传递。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T14:28:45.710

这个“openArgs”参数的一个非常有趣的替代方法是使用 currentProject.allforms("myFormName") 对象的 .properties 集合。当您需要将值传递给表单时（例如从另一个控件或另一个表单继承的过滤器），只需为您的表单添加相应的属性，并将您的值添加到此属性中。

例子：

```
addPropertyToForm "formFilter","Tbl_myTable.myField LIKE 'A*'",myFormName 
```

被调用的函数将尝试更新对象的“formFilter”属性的值。如果该属性不存在（引发 err 2455），它将作为新属性添加到错误管理代码中。

```
Function addPropertyToForm(_ 
    x_propertyName as string, _
    x_value As Variant, _
    x_formName As String) 
As Boolean

On Error GoTo errManager
CurrentProject.AllForms(x_formName).Properties(x_propertyName).Value = x_value
addPropertyToForm = True
On Error GoTo 0

Exit Function

errManager:
If Err.Number = 2455 Then
    CurrentProject.AllForms(x_formName).Properties.Add x_propertyName, Nz(x_value)
    Resume Next
Else
    msgbox err.number & ". The property " & x_propertyName & "was not created"
End If

End Function 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-07T07:01:33.077

可能是您已经打开了表单（如建议的那样），但只需检查 null 并且表单也会处理缺少参数的打开。

如果参数不重要，这将允许打开表单以快速查看（由您或用户）。

```
Private Sub Form_Open(Cancel As Integer)
    If Not IsNull(Me.OpenArgs) Then
        Me.lblHeading.Caption = Me.OpenArgs
    End If
End Sub 
```

通过省略 OpenForm 调用中的值或双击 Access Objects 侧栏中的表单，可以将空值传递给 OpenArgs。

* * *

如果它是[模态](https://msdn.microsoft.com/en-us/vba/access-vba/articles/form-modal-property-access)表单，则应明确检查它是否已打开并在打开之前将其关闭。这是一个常见的问题。

当然，所有表单都可以这样做，而不仅仅是模态表单，然后您就不需要 null 检查（前提是您永远不会将 null 传递给它）。但是往往一个项目中的表单很多，而且OpenForm调用比表单还要多……

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T13:04:35.367

值是否取自用户完成的控件？您是否确保在运行 openform 行之前将焦点从控件移开？

编辑：控件的 value 属性将等于以前的值，它可能为 null，除非你这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T13:10:51.780

我想我找到了问题的答案：

> 根据我的经验，必须在打开表单后立即处理 OpenArgs。[（关联）](http://www.dbforums.com/archive/index.php/t-1620380.html)

在尝试使用 OpenArgs 值之前，我通过中断来检查这一点，它为空。但是当我删除中断时，程序没有显示错误。这只能在开发时发生。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-02T06:36:12.990

在这里回答。即使在设计模式下，您的表单也可能已经打开： [http ://www.tech-archive.net/Archive/Access/microsoft.public.access.formscoding/2007-02/msg00928.html](http://www.tech-archive.net/Archive/Access/microsoft.public.access.formscoding/2007-02/msg00928.html)

# msbuild - NAnt 和 MSBuild 命令行问题

> ID：258567
> 
> 赞同：1
> 
> 时间：2008-11-03T13:03:28.333
> 
> 标签：msbuild, nant

我正在尝试配置 NAnt 以自动化我的构建过程——一旦我完成了这一步，我将集成单元测试。

也许我不完全知道我想要什么，所以如果有完全不同的方式来做这一切，请纠正我......

我想要两个 NAnt 目标，一个用于快速调试构建以确保一切正常且测试通过，另一个目标用于正确编译和发布（它是一个 Web 应用程序项目）

我的问题是...

1.  我不能让 MSBuild 只编译 dll，它总是用它复制所有的网络应用垃圾（图像、css、.aspx 文件等）。有没有办法阻止这种情况？如果是这样，怎么做？
2.  当我使用 /t:Compile 进行编译时，它仍在为 dll 创建 .pdb 文件。它是否正确？我认为这些是用于调试器的，因此在进行发布编译时不应该出现？

这是我的完整版本编译（发布）的 NAnt 目标：

```
<target name="build.deploy" description="Compile Web Site." depends="init">
    <exec basedir="." program="C:\WINDOWS\Microsoft.NET\Framework\v3.5\msbuild.exe" commandline=" MyProj/Interface/Interface.csproj /nologo
        /t:Compile
        /t:ResolveReferences;_CopyWebApplication
        /p:OutDir=../../deploy/bin/
        /p:WebProjectOutputDir=../../deploy/;AspNetConfiguration=Release"
        workingdir="." failonerror="true" />
</target> 
```

谢谢你的帮助！

PS 如果有更简单的方法，我不必使用 msbuild。我尝试先使用 CSC，但我无法解决我遇到的所有引用问题。非常欢迎提出建议

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T13:11:58.423

我建议不要直接调用 MSBuild，而是使用[NAnt-Contrib](http://nantcontrib.sourceforge.net/) [msbuild task](http://nantcontrib.sourceforge.net/release/latest/help/tasks/msbuild.html)。

例如，在我的 Protocol Buffers 项目中，我有这个：

```
<target name="build"
        description="Builds all C# code">
  <msbuild project="${src}/ProtocolBuffers.sln">
    <property name="Configuration"
              value="${build-configuration}" />
  </msbuild>
</target> 
```

什么时候`build-configuration`不`Release`构建 PDB。这取决于您如何在 Visual Studio 中设置项目 - 您仍然*可以*为优化的发布版本构建 PDB。

编辑：至于“额外的垃圾”的东西 - 它会做任何 Visual Studio 中的构建。如果您可以在 VS 中随意切换各种选项，那么 NAnt/MSBuild 也应该可以正常工作。

# asp.net - ASP.NET 网站/服务托管

> ID：258580
> 
> 赞同：3
> 
> 时间：2008-11-03T13:10:37.303
> 
> 标签：asp.net, web-services, webserver, hostable-web-core

除了 IIS 之外，是否还有其他可能用于托管基于 ASP.NET 的网站和 Web 服务，这是 Microsoft 推荐用于小型环境的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T13:19:32.730

[您可以使用IIS 7 的 Hostable Web Core](http://blogs.msdn.com/carlosag/archive/2008/04/14/HostYourOwnWebServerUsingIIS7.aspx)在您自己的应用程序中托管您自己的 Web 服务器。 而且，当然，您可以创建自己的应用程序来侦听端口 80。但是，所涉及的复杂性可能并不值得。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T15:48:42.447

也可以在 Cassini Web Server 中托管基于 ASP.NET 的网站和 Web 服务。 [这](http://www.ultidev.com/Products/Cassini/)是 Cassini Web Server 的网站。来自网站的概述：

“UltiDev Cassini 是一款免费、轻量级和可再分发的 Web 服务器，可以托管 ASP.NET 3.5、3.0、2.0 和 1.1 应用程序和静态 HTML 站点。”

当然微软不推荐，但是这个web服务器可以嵌入到应用安装包中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T13:15:34.190

Ohad 有一个关于让它在 apache 上运行的教程：[asp.net on apache](http://weblogs.asp.net/israelio/archive/2005/09/11/424852.aspx)。我不确定它运行得如何，但它确实有效。我不认为微软推荐除了 IIS 之外的任何东西，但他们为什么会推荐。对于大多数小规模使用而言，Windows Server 将包含小型站点所需的一切。我不确定为什么您需要寻找替代方案，除非您没有可用的 Windows 服务器，在这种情况下，apache 端口应该可以工作为你。

# svn - 如何使用 git-svn 将不同目录中的 svn 分支导入 git？

> ID：258590
> 
> 赞同：12
> 
> 时间：2008-11-03T13:13:55.567
> 
> 标签：svn, git, git-svn

我有一个如下所示的 SVN 存储库结构。我们在分支下使用多个级别用于各种发布维护分支，以及用于功能分支的目录。

git-svn init 似乎与单个 --branches 参数一起工作，即似乎期望所有分支都在一个位置。

```
trunk
branches
  1.1
    1.2.1
    1.2.2
  1.2
    1.2.1
    1.2.2
    1.2.3
  features
    feature1
    feature2 
```

关于如何处理这个问题的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-03-10T15:04:57.110

在您的配置文件中，将 svn-remotes 部分设置为：

```
[svn-remote "svn"]
    url = svn://svnserver/repo
    fetch = trunk:refs/remotes/trunk
    branches = branches/*/*:refs/remotes/*
    tags = tags/*:refs/remotes/tags/* 
```

这应该让你抓住嵌套的分支。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T13:48:37.850

按照惯例，Subversion 分支都存在于 Subversion 存储库中的单个“分支”路径中，所以我对`git-svn`做出这个假设并不感到惊讶。

我建议以下（注意，您可能会在此操作中丢失一些历史记录）：

1.  扁平化 Subversion`branches`路径，使用命名约定来保持唯一身份和当前结构的想法。
2.  履行`git-svn`
3.  在存储库中移动内容`git`以符合您的实践。

的危险`losing history`取决于`git-svn`从不同路径进行复制操作的程度。我最近在迁移颠覆存储库（1.4-ish）时遇到了这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T13:20:31.277

`git`为每个分支子目录创建一个 repo 是否可行？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-06T00:00:53.403

您可以`git svn`为每个分支添加多个遥控器，或者可能为每个分支目录添加多个遥控器。最初的`git svn fetch`需要永远，但据我所知，它应该可以工作。

# ssis - 如何将 DTS 包转换为 SSIS 包？

> ID：258614
> 
> 赞同：3
> 
> 时间：2008-11-03T13:26:40.703
> 
> 标签：ssis, migration, dts

我正在寻找将 DTS 包转换为新的 SSIS 2005 的教程或演练。任何人都知道。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T13:34:04.463

[将 DTS 包迁移到集成服务](http://msdn.microsoft.com/en-us/library/cc768544.aspx)

SQL Server Integration Services 提供了一种处理数百万行数据的可靠方法。该平台具有高度可扩展性，并且比以前的 DTS 平台执行速度更快。旧 DTS 包的迁移可以通过两种方式完成：通过内置的包迁移向导，它可以处理简单的包迁移；并通过 DTS xChange，它处理简单和复杂的 DTS 迁移，同时将最佳实践应用于迁移的包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T13:37:43.817

在解决方案资源管理器中有一个用于导入 DTS 包的菜单选项。这应该为您完成所有转换。话虽如此，我只在简单的包装上尝试过

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T08:34:49.140

已知的 DTS 迁移问题。 [http://msdn.microsoft.com/en-us/library/ms143462(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms143462(SQL.90).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-25T20:08:41.310

SSIS 比 DTS 好得多，我建议将 DTS 包重写为 SSIS 包，而不是迁移它们。我特别推荐任何 DTS 包，这些包需要玩有依赖关系的游戏以模拟循环或 DTS 没有的其他功能。

# gis - 谁知道什么是GIS工具？

> ID：258616
> 
> 赞同：0
> 
> 时间：2008-11-03T13:28:11.217
> 
> 标签：gis, esri, ogc, opengis

究竟什么是[地理信息系统](https://en.wikipedia.org/wiki/Geographic_information_system)？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-03T13:40:14.903

前面的两个答案都是正确的，但我认为它们有些不完整。

*GIS*是地理信息系统的缩写。它确实包含有关位置的信息。Wikipedia [GIS](http://en.wikipedia.org/wiki/Geographic_information_system)确实有一个很好的概述，但我认为错过了真正的重点。

要真正有用，关于位置的信息必须对应用程序/业务很重要。

例如：

一家服务公司希望能够一目了然地了解其服务覆盖范围内的哪些区域收到最多的回电。GIS 和一些地图软件可以快速向该公司显示这些信息以及其他重要信息，只需使用不同的颜色或图标来显示“未结电话”、“逾期电话”、“现场技术”等。

正是位置数据和业务特定数据的结合使 GIS 变得有价值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T13:30:44.080

地理信息系统。基本上是关于映射的数据。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2008-11-03T15:24:21.480

用于创建/管理和使用 GIS 数据的最受欢迎的工具制造商之一是[Esri](http://en.wikipedia.org/wiki/Esri)。

我见过的另一个开源项目是[GRASS](http://en.wikipedia.org/wiki/GRASS_GIS)。

GIS 信息的一些非常适用的应用，例如在灾难期间，能够为权威人士提供信息，以做出明智的猜测，以最好地应用他们的有限资源。无需让 5 个公路巡逻队亲自前往 5 座桥梁查看它们是否仍然站立，您可以根据之前的数据做出估计猜测，哪些人可能仍然站立。

农业可能是 GIS 信息的最大用户，[联合收割机](http://en.wikipedia.org/wiki/Combine_harvester)在哪里，收割时正在收集数据，这使农民可以决定明年种植什么作物，或者在哪里使用什么补充剂。

可用于收集 GIS 数据的输入范围非常广泛，从用于指示植物生长活动的高分辨率红外卫星图像到在耕作时捕获 GPS 坐标的低技术拖拉机。

GIS 专业人员使用的工具通常非常专业，并且在价格比较中可以与大多数 CAD 应用程序相媲美。

我个人认为最大的挑战在于数据的一致性，问题是地球不是任何形状，所以有很多不同的方法来识别地球上的一个点，这导致了 GIS 的很多问题.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-25T21:17:14.843

**地理信息系统是首**字母****缩略词**GIS的行业标准**词根**。**

 ****GIS 是一种技术基础设施，可提供基于表示的（静态地图）、分析（数据和统计）和组织（过程）决策支持。

许多非 GIS 专业人员将他们的兴趣集中在演示和轻量级用户界面（参见 Google 地图）上，但企业级 GIS 的全部功能仅在大型应用程序套件中可用，例如[ESRI](http://www.esri.com) , Inc 提供的套件。

然而，与任何其他信息系统一样，给定地理空间系统的效用取决于潜在的用户需求。真正将 GIS 与任何其他 IT 系统区分开来的是对现实世界坐标系的原生支持以及其中固有的复杂几何变换。通过支持真实世界的坐标，GIS 保证（在给定的分辨率内）数据集之间描绘的关系是真实的。通过在底层数据库中添加扩展属性，存在一个框架，可以使用现实世界关系中的现实世界数据和大多数人可以轻松解释的可视界面来做出现实世界决策。

有了这个基本前提，现代地理信息系统的所有其他方面，无论轻重，都只是附加特征。

一张图片胜过千言万语。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T15:40:51.417

GIS 可以是地理信息科学或地理信息系统。我认为系统部分是科学部分的子集。

GISci 更偏学术，而我认为 GISys 更实用。

现在最明显的 GIS 用途是谷歌地球、虚拟地球和其他所有人都可以使用的地图应用程序。例如，10 年前，你妈妈不能轻易地看她家的航拍照片。现在这是很常见的地方。还有非常具体的 GIS 应用，例如车队管理、军事情报等。尽管随着诸如 SQL 2008 GISys 之类的空间支持的增加，日常应用程序将变得越来越普遍。

# php - $_REQUEST 有多邪恶，有哪些可以接受的创可贴对策？

> ID：258625
> 
> 赞同：9
> 
> 时间：2008-11-03T13:32:11.207
> 
> 标签：php, security, xss

我最近遇到了几个流行的 PHP 相关答案，建议使用 superglobal `$_REQUEST`，我认为这是代码异味，因为它让我想起了`register_globals`.

您能否提供一个很好的解释/证据来说明为什么`$_REQUEST`是不好的做法？我将抛出一些我已经挖掘出来的示例，并且希望获得有关理论攻击向量和现实世界漏洞的更多信息/观点，以及系统管理员可以采取的合理步骤以降低风险的建议（缺少重写应用程序......或者，我们*是否需要*去管理层并坚持重写？）。

**漏洞示例：**默认`GPC`数组合并顺序意味着 COOKIE 值覆盖 GET 和 POST，因此`$_REQUEST`可用于 XSS 和 HTTP 攻击。PHP 让 cookie 变量覆盖超全局数组。[本演讲](http://www.slideshare.net/ZendCon/lesser-known-security-problems-in-php-applications-presentation)的前 10 张幻灯片给出了示例（整个演讲很棒）。[phpMyAdmin 利用](http://www.hardened-php.net/advisory_072006.130.html)CSRF 攻击示例。

**对策示例：**重新配置`$_REQUEST`数组合并顺序 from `GPC`以`CGP`使 GET/POST 覆盖 COOKIE，而不是相反。使用[Suhosin](http://www.hardened-php.net/suhosin/)阻止覆盖超全局变量。

（另外，不会问我是否认为我的问题是骗人的，但令人高兴的是，对于[“何时以及为什么应该使用 $_REQUEST 而不是 $_GET / $_POST / $_COOKIE？”](https://stackoverflow.com/questions/107683/when-and-why-should-request-be-used-instead-of-get-post-cookie)的压倒性 SO 答案是“从不”。 )

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2008-11-03T14:20:04.030

照原样对待它：一种从用户那里获取数据的方法。它必须经过清理和验证，那么您为什么要关心它是以 POST、GET 还是 cookie 的形式出现的呢？他们都来自用户，所以说“他们可以被欺骗！” 是多余的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T16:00:17.493

$_REQUEST 与 $_GET、$_POST 和 $_COOKIE 一样是邪恶的。虽然我认为有使用 $_REQUEST 的有效场景，但有一个很好的理由不使用 $_REQUEST 并将其标记为“不良做法”。

使用 $_REQUEST 的主要原因是参数可以在 $_POST 或 $_GET 中传输。通过访问 $_REQUEST 您不必同时检查 $_GET 和 $_POST 它的值已设置。问题是 ini 设置[gpc_order](http://www.php.net/manual/en/ini.core.php#ini.gpc-order)可以改变构建 $_REQUEST 的行为。此设置可能因服务器而异，您的脚本可能会改变行为。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T17:16:15.873

`$_REQUEST``$_GET`是有问题的，因为它忽略了 URL ( ) 和请求正文 ( )之间的区别`$_POST`。HTTP-GET 请求应该没有副作用，而 HTTP-POST 可能有副作用，因此不能被缓存。将这些完全不同的数据源放入一个桶中，需要非[REST](http://en.wikipedia.org/wiki/Representational_State_Transfer) -ful 的应用程序，也就是糟糕的应用程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T14:06:57.847

它容易受到 URL 上传递的任何东西的影响。因此，如果表单包含与表单一起提交的带有“userid”的隐藏字段，尽管理论上用户无法编辑它，但如果足够敏锐，没有什么能阻止他们更改值。

如果您只是想从请求中获取价值，那很好，但您需要意识到它很可能被欺骗，因此您需要采取相应的行动，当然不要将其用于安全的参数/值数据。

# delphi - 如何在 Delphi 2006 项目中的所有文件中进行全局搜索和替换

> ID：258626
> 
> 赞同：9
> 
> 时间：2008-11-03T13:33:24.560
> 
> 标签：delphi, delphi-2006

帮助 ！！！

我刚刚花了大约 10 分钟寻找一种方法来搜索和替换 Delphi 2006 项目中的所有文件。

请问你能告诉怎么做吗

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-03T14:07:55.177

我会为此使用[GExperts的 Grep Search](http://www.gexperts.org/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T13:41:31.673

据我所知，D2006 中不存在这样的功能。

我使用 Notepad++ 来完成这项任务。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T13:59:34.367

也许您可以使用 Refactoring 菜单中的 Rename 选项。它适用于多个文件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-04T10:16:36.437

我使用 BK ReplaceEm V2.0

做这项工作。

另一个很棒的实用程序是 WinMerge

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-08T14:39:40.283

GEExperts 在 Delphi 7 上运行良好（不能投票给 Marius，因为我的声誉很低）。在 GEExperts 的 grep 中进行全局搜索，然后单击“替换”。很简单。也直接集成到 IDE 中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-17T18:38:41.190

[CnPack](http://www.cnpack.org/index.php?lang=en)是一个 Delphi 包，包含数百个工具作为 IDE 增强功能和编辑器功能。它与所有 Dephi 版本兼容，并且具有快速简便的“在文件中替换”选项。我强烈推荐使用它。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-17T20:12:31.293

GExperts 是我的直接同事使用的并且非常受欢迎。我自己更喜欢 Notepad++ 来完成这样的任务（免费、本地化和开源）。非常方便快速检查 pas 以及 dfm、dpr、dpk 甚至 dproj 和 groupproj 文件中的内容。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2015-04-10T11:06:32.183

要搜索项目中的所有文件，您可以使用：

`Ctrl`+ `Shift`+`F`

# vb.net - 我将如何使用 COM OLE 对象进行 TDD

> ID：258627
> 
> 赞同：2
> 
> 时间：2008-11-03T13:33:34.420
> 
> 标签：vb.net, testing, com, tdd, ole

我有一个试图为其编写包装器的 OLE COM 对象，我已决定开始使用 TDD 为其编写代码，因为我相信它会让我对我正在尝试编写的内容有更好的方向感。COM 对象有一个这样的接口：

```
Interface Mapinfo
    Sub [Do](ByVal cmd As String)
    Function Eval(ByVal cmd As String) As String
End Interface 
```

[Do] 命令将采用以下内容

```
Mapinfo.Do("OpenTable("""C:\Temp\MyTable.TAB""")") 
```

现在我正在尝试编写一个包装器，所以有一个这样的函数：

```
Mapinfo.OpenTable("C:\Temp\MyTable.TAB") 
```

现在我遇到的主要问题是，每次我想编写一个新测试和一些代码时，我都必须创建一个 OLE 对象的实例，等待应用程序启动（30 秒+），测试我的小功能，关闭并处理 OLE 对象，更改代码并再次运行它。

我的问题是：有没有更好的方法来完成所有这些，而不必每次都启动 OLE 应用程序？我听说过模拟对象，但没有真正研究过，他们会在这里帮助我吗？如果有怎么办？

编辑：我现在意识到我必须为 Mapinfo 制作一个模拟对象，我的问题是如何制作一个可以采用不同格式字符串的模拟对象？这将如何帮助我验证包装器中的代码是否正确？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T13:50:27.427

是的，模拟对象会有所帮助。本质上，您通过模拟 Mapinfo 接口创建了一个伪造的 Mapinfo 对象（您应该重命名该 IMapInfo，顺便说一句）。

然后，您指示该模拟程序期望什么调用，以及返回什么结果（如果合适）。您还可以创建测试，其中模拟抛出异常或执行其他难以使用真实对象调用的事情。

两个大的（免费的）.NET 模拟框架是[MoQ](http://code.google.com/p/moq/)和[Rhino](http://ayende.com/projects/rhino-mocks.aspx) Mocks 。Rhino 更加成熟，并且有更多的方式来配置 mock。MoQ 是新来者，与 Rhino 相比，功能集更小，设定期望的方式也更少。

就我个人而言，我认为 MoQ 更适合新来的 mocking。它相对容易理解，所有文档都与当前版本相关（搜索 Rhino 教程，你会发现几年前的垃圾，不再适用），而且性能很好。

# cross-platform - Cross-platform, cross-language messaging system?

> ID：258638
> 
> 赞同：11
> 
> 时间：2008-11-03T13:38:45.220
> 
> 标签：cross-platform, ipc, messaging

I'm developing a set of applications that work together to create a system for processing metering data. There's several reasons I want to have them loosely coupled and the system should be extensible by third parties, so the apps will be tied together via messaging.

I'm looking for a messaging system that offers bindings in (at least) C#, Java and Python and supports messaging patterns like Publish-Subscribe, Guaranteed Delivery, Selective Consumer (like Peek in .Net Messaging).

As far as I could find out, there's nothing wrong with JMS or .Net Messaging, it's just that they are for .Net / Java only.

The system should give me control over which transport mechanism (Sockets, Message Queues, etc.) to use when setting up a channel. I want to be able to both scale out to remote machines and speed things up with local transport facilities.

If I can't find anything suitable, I'll have to roll my own. I'd probably use Google's protocol buffers for serialization. If anybody has other recommendations for technology options, fire away.

Oh, yes - and I would like to have optional encryption on a per-channel or per-message basis.

*ETA: Thanks for all the quick replies. I'm working my way through the docs & propaganda now. Has anybody used the technologies below, and for what / with what results?*

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2008-11-03T13:45:36.110

activemq

[http://activemq.apache.org/cross-language-clients.html](http://activemq.apache.org/cross-language-clients.html)

Supports all the following protocols

*   OpenWire
*   REST
*   Stomp
*   WS Notification
*   XMPP
*   AMQP

Thanks Paul

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T13:44:52.353

SonicMQ might be a tool you're looking for. I know they are heavy into Progress but that they also support other language alternatives as well and are a leading player in the Messaging sector.

[Sonic Software](http://www.sonicsoftware.com/index.ssp)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T16:32:04.060

As Paul mentioned, try [ActiveMQ](http://activemq.apache.org/cross-language-clients.html) which supports many language clients and wire protocols.

BTW ActiveMQ 6.x will probably be using Google's protocol buffers as one of its underlying wire transports :)

I've used Apache ActiveMQ on many projects to great success. Its the [most](http://www.nabble.com/Java-Software-f787.html) [popular](http://www.nabble.com/Apache-f90.html) and powerful open source message broker around today.

Incidentally on .Net / C# the ActiveMQ project has created the [NMS API](http://activemq.apache.org/nms/) which is a standard API for communicating with message brokers on the .Net platform which is now integrated into [Spring.Net](http://springframework.net/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T13:45:11.243

Have you considered [MPI](http://www.open-mpi.org/)?

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T13:51:03.337

You could use an ESB (Enterprise Service Bus) like [Mule](http://mule.mulesource.org/display/MULE/Home). The idea is that you send your messages to the Bus in any way you want (JMS, http, email) and the bus does the routing for you. I don't know if there are .NET bindings, but even if there aren't any available, you can build your own using an extension mechanism. Of course, this means you need to set up a bus somewhere.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T13:59:44.523

If you want rock solid, commercial support and integration to just about anything, IBM's MQ Series, now [Websphere MQ](http://www-01.ibm.com/software/integration/wmq/features/) provides all the features described in your requirements.

Sometimes you *do* get what you pay for... ;-)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-03T18:10:27.663

If you want a multilanguage "standard" -- meaning you are not tied to using a specific broker / intermediary like ActiveMQ, SonicMQ, or WebsphereMQ -- I strongly suggest you look at the AMQP standard ([http://www.amqp.org](http://www.amqp.org)) and related brokers (RabbitMQ, QPid, OpenAMQ; see [http://www.amqp.org/confluence/display/AMQP/AMQP+Products](http://www.amqp.org/confluence/display/AMQP/AMQP+Products)).

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-03-27T17:28:00.370

[Open Message Queue (Open MQ)](https://mq.dev.java.net/) is included in the GlassFish application Server and also runs stand-alone. It starts up in a few seconds, and supports Java and C client. Stomp support is currently in development in version 4.4.

# asp.net - Flash 10 和 HttpHandler 服务 swf 文件问题

> ID：258649
> 
> 赞同：3
> 
> 时间：2008-11-03T13:43:49.593
> 
> 标签：asp.net, flash

我通过将 Movie 和 Src 参数以及 embed-tag 的 src 属性指向文件名为 QueryString 的 HttpHandler 来显示 flash 对象。

```
<OBJECT codeBase="https://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7.0.19.0" classid=clsid:D27CDB6E-AE6D-11cf-96B8-444553540000 width="468" height="60">
  <PARAM NAME="Movie" VALUE="/image.ashx?serverencoded=true&amp;path=%2fapp_data%2fconfiguration%2faccount%2f21658260-9a62-425b-abb7-496ffde599a5%2fcreatives%2fswf_test_bannerA(4).swf">
  <PARAM NAME="Src" VALUE="/image.ashx?serverencoded=true&amp;path=%2fapp_data%2fconfiguration%2faccount%2f21658260-9a62-425b-abb7-496ffde599a5%2fcreatives%2fswf_test_bannerA(4).swf">
  <embed src="/image.ashx?serverencoded=true&path=%2fapp_data%2fconfiguration%2faccount%2f21658260-9a62-425b-abb7-496ffde599a5%2fcreatives%2fswf_test_bannerA(4).swf&rnd=34d5" quality="high" wmode="opaque" pluginspage="https://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="468" height="60">
  </embed>
</OBJECT> 
```

它与安装的 Falsh 9 播放器完美配合。安装 Flash 10 后，会显示白色背景，当我右键单击对象时，“电影未加载”在 Flash 上下文菜单中显示为禁用的菜单项。

如果我将 Movie 和 Src 参数指向一个实际的 swf 文件，它就可以工作！

请记住：运行代码适用于 Flash 9，但不适用于 10。根本没有对代码进行任何更改......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T15:14:12.500

回答我自己的问题：

我正在像这样设置内容配置 HTTP 标头：

HTTP/1.1 200 OK
内容处置：**附件；**文件名=checkimage.jpg
内容长度：76127
内容类型：图像/JPEG

从 Flash 10 开始，它们会忽略使用 attachment 关键字提供的 SWF 文件，因此我将标题更改为：

HTTP/1.1 200 OK
内容处置：filename=checkimage.jpg
内容长度：76127
内容类型：图像/JPEG

现在它可以工作了。看看这个： http: [//www.adobe.com/devnet/flashplayer/articles/fplayer10_security_changes_02.html#head32](http://www.adobe.com/devnet/flashplayer/articles/fplayer10_security_changes_02.html#head32)

# c# - .Net (C#) 检测是否连接了电视

> ID：258655
> 
> 赞同：3
> 
> 时间：2008-11-03T13:46:30.943
> 
> 标签：c#, .net, screen, monitor, television

任何人都知道如何在c#中检测电视当前是否连接到PC？

干杯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T14:04:18.007

设备是如何连接的？

每当发生设备到达/移除时，Windows 都会向系统中当前运行的所有应用程序发送一条名为 WM_DEVICECHANGE 的消息。但要接收此消息，我们的应用程序应该处理“Windows 进程函数”。C# 应用程序不会默认支持此功能，但可以添加它。您可以扩展表单类。

为 USB 大容量存储设备执行此操作的代码类似于：

```
using System;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;
using System.Runtime.InteropServices;
namespace WindowsApplication
{
    /// <summary>
    /// Summary description for Form1.
    /// </summary>
    public class Form1 : System.Windows.Forms.Form
    {
        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.Container components = null;

        public Form1()
        {
            //
            // Required for Windows Form Designer support
            //
            InitializeComponent();

            //
            // TODO: Add any constructor code after InitializeComponent call
            //
        }

        [StructLayout(LayoutKind.Sequential)] 
            public struct DEV_BROADCAST_VOLUME 
        { 
            public int dbcv_size; 
            public int dbcv_devicetype; 
            public int dbcv_reserved; 
            public int dbcv_unitmask; 
        } 

        protected override void WndProc(ref Message m) 
        { 
            //you may find these definitions in dbt.h and winuser.h 
            const int WM_DEVICECHANGE = 0x0219; 
            const int DBT_DEVICEARRIVAL = 0x8000;  // system detected a new device 
            const int DBT_DEVICEREMOVECOMPLETE = 0x8001;  // system detected a new device 
            const int DBT_DEVTYP_VOLUME = 0x00000002;  // logical volume 
            switch(m.Msg)
            {
                case WM_DEVICECHANGE:
                switch(m.WParam.ToInt32())
                {
                    case DBT_DEVICEARRIVAL:
                        { 
                            int devType = Marshal.ReadInt32(m.LParam,4); 
                            if(devType == DBT_DEVTYP_VOLUME) 
                            { 
                                DEV_BROADCAST_VOLUME vol; 
                                vol = (DEV_BROADCAST_VOLUME) 
                                    Marshal.PtrToStructure(m.LParam,typeof(DEV_BROADCAST_VOLUME)); 
                                MessageBox.Show(vol.dbcv_unitmask.ToString("x")); 
                            } 
                        } 
                        break;
                    case DBT_DEVICEREMOVECOMPLETE:
                        MessageBox.Show("Removal");
                        break;
                }

                    break;
            }
            //we detect the media arrival event 
            base.WndProc (ref m); 

        } 
        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        protected override void Dispose( bool disposing )
        {
            if( disposing )
            {
                if (components != null) 
                {
                    components.Dispose();
                }
            }
            base.Dispose( disposing );
        }

        #region Windows Form Designer generated code
        /// <summary>
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            // 
            // Form1
            // 
            this.AutoScaleBaseSize = new System.Drawing.Size(5, 13);
            this.ClientSize = new System.Drawing.Size(292, 273);
            this.Name = "Form1";
            this.Text = "Form1";
            this.Load += new System.EventHandler(this.Form1_Load);

        }
        #endregion

        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main() 
        {
            Application.Run(new Form1());
        }

        private void Form1_Load(object sender, System.EventArgs e)
        {

        }
    }
} 
```

它可能会让你知道如何实现它。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2008-11-03T14:04:47.587

我想你在谈论显示器/电视？

当用户切换到电视时，您可以制作一个带有“TV CONNECTED”的大按钮的winform应用程序:-)

如果与 PC 的唯一连接只是 VGA 连接器，那么您就不走运了。您总是可以实现一个连接到串行端口的红外传感器来读取来自遥控器的红外信号（无论何时用户单击它）。

# asp.net - 编辑 GridView 文本框时捕获 Enter 键

> ID：258661
> 
> 赞同：2
> 
> 时间：2008-11-03T13:49:33.763
> 
> 标签：asp.net, gridview

我有一个这样定义的 GridView：

```
<asp:GridView ID="myGridView" ruant="server">
    <asp:BoundField DataField="myField" />
    <asp:CommandField ShowDeleteButton="true" ShowEditButton="true" />
</asp:GridView> 
```

使用 Edit 按钮将行置于编辑模式后，如何捕获 Enter 键并触发行上的结果更新？现在，如果我按 Enter 键，页面会重新加载，输入到 TextBox 中的内容会丢失，并且该行仍处于编辑模式。我知道如何在表单上[完全禁用 enter 键](https://stackoverflow.com/questions/152099/i-want-to-prevent-aspnet-gridview-from-reacting-to-the-enter-button)（当前的解决方法），但我想让它触发 Update 命令。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T13:52:36.720

好吧，使用您链接的问题中的知识，这很简单：

```
string js = "if (event.keyCode == 13) this.form.submit();"
myGridView.Attributes.Add("onkeydown", js); 
```

正如我们在评论中发现的那样，这引入了一个小问题。`GridView_RowUpdating`服务器事件不再触发，但问题作者依赖它。

简而言之 - 服务器事件模型依赖于`__EVENTTARGET`要设置的表单字段。仅调用时不会发送此表单字段`form.submit()`。一个解决方案是使用 JavaScript “单击”相关按钮。

```
string js = "if ((event.which && event.which == 13) || " 
            + "(event.keyCode && event.keyCode == 13)) "
            + "{document.myForm.Update.click();return false;} "
            + "else return true;";
myGridView.Attributes.Add("onkeydown", js); 
```

请参阅AllAsp.net 上[的“使用 enter 键提交表单”](http://www.allasp.net/enterkey.aspx)，其中更详细地介绍了该问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-25T11:43:44.857

将页面上按钮的“UseSubmitBehavior”属性设置为“False”（默认为True）解决了多个评论中的提交问题。

# c# - BackgroundWorker 中未处理的异常

> ID：258662
> 
> 赞同：73
> 
> 时间：2008-11-03T13:50:01.843
> 
> 标签：c#, .net, multithreading, debugging, backgroundworker

我的 WinForms 应用程序使用许多[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)对象从数据库中检索信息。我正在使用 BackgroundWorker，因为它允许 UI 在长时间运行的数据库查询期间保持畅通，并且它为我简化了线程模型。

我在其中一些后台线程中偶尔会遇到 DatabaseExceptions，并且我在调试时在工作线程中目睹了这些异常中的至少一个。我相当有信心这些异常是超时，我认为它不时期望它是合理的。

我的问题是当这些后台工作线程之一中发生未处理的异常时会发生什么。

我认为我不能在另一个线程中捕获异常，但是我可以期望我的 WorkerCompleted 方法被执行吗？我可以询问 BackgroundWorker 的任何属性或方法是否有异常？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2008-11-03T13:50:28.597

如果该操作引发了您的代码未处理的异常，则`BackgroundWorker`捕获该异常并将其传递给`RunWorkerCompleted`事件处理程序，在该处理程序中它作为`System.ComponentModel.RunWorkerCompletedEventArgs`. 如果您在 Visual Studio 调试器下运行，则调试器将在 DoWork 事件处理程序中引发未处理异常的位置中断。

[http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.dowork.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.dowork.aspx)

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2010-04-14T09:46:16.223

我已经充分使用`BackgroundWorker`了一年多，并且非常了解它。

就在最近，我`RunWorkerCompleted`根本没赶上`e.Error`我`Throw New Exception("Test")`在`DoWork`. 但是引发了未处理的异常。赶上`DoWork`不是最好的做法，因此`e.Error`没有意义。

当我尝试使用 new 创建 new`Form`时，`BackgroundWorker`已成功处理。我的复杂中应该有问题。`e.Error``RunWorkerCompleted``BackgroundWorker`

经过几天的谷歌搜索和调试，尝试了一个错误。我在我的`RunWorkerCompleted`：

*   首先检查`e.Error`，然后检查`e.Cancelled`，最后检查`e.Result`
*   不要得到`e.Result`if `e.Cancelled = True`。
*   不要得到`e.Result`if `e.Error`is not `null`(or `Nothing`) **

**这是我想念的地方。如果您尝试使用`e.Result`if `e.Error`is not `null`(or `Nothing`)，则会抛出 Unhandled Exception。

* * *

**更新：** 在`e.Result`获取属性 .NET 中设计它首先检查`e.Error`，如果有错误，那么他们将重新从 .NET 中抛出相同的异常`DoWork`。这就是为什么我们得到 Unhandled 异常`RunWorkerCompleted`但实际上异常来自`DoWork`.

这是最好的做法`RunWorkerCompleted`：

```
If e.Error IsNot Nothing Then
  ' Handle the error here
Else
  If e.Cancelled Then
    ' Tell user the process canceled here
  Else
    ' Tell user the process completed
    ' and you can use e.Result only here.
  End If
End If 
```

如果您想要一个可供所有 DoWork、ProgressChanged 和 RunWorkerCompleted 访问的对象，请像这样使用：

```
Dim ThreadInfos as Dictionary(Of BackgroundWorker, YourObjectOrStruct) 
```

您可以轻松访问`ThreadInfos(sender).Field`任何您想要的地方。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2008-11-03T13:54:24.423

默认情况下，它将被 BackgroundWorker 捕获并存储。来自 MSDN：

> 如果操作引发了您的代码无法处理的异常，BackgroundWorker 将捕获该异常并将其传递给 RunWorkerCompleted 事件处理程序，在该处理程序中它作为 System.ComponentModel.RunWorkerCompletedEventArgs 的 Error 属性公开。如果您在 Visual Studio 调试器下运行，则调试器将在 DoWork 事件处理程序中引发未处理异常的位置中断。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2011-06-20T09:21:31.187

正如已经指出的那样：

> 如果操作引发了您的代码无法处理的异常，BackgroundWorker 将捕获该异常并将其传递给 RunWorkerCompleted 事件处理程序，在该处理程序中它作为 System.ComponentModel.RunWorkerCompletedEventArgs 的 Error 属性公开。

每当您与原始线程交互时，这很重要。例如，如果您希望将异常结果写入表单上的某种标签中，那么您就不能在 BackgroundWorker 的 DoWork 中捕获异常，而是处理来自 RunWorkerCompletedEventArgs 的 e.Error。

如果您使用反射器分析 BackgroundWorker 代码，您会发现它的处理非常简单：您的 DoWork 在 try-catch 块中执行，异常只是传递给 RunWorkerCompleted。这就是为什么我不同意始终在 DoWork 事件中捕获所有异常的“首选”方法。

简而言之，回答原来的问题：

**是**的 - 你可以指望你的 RunWorkerCompleted 总是被解雇。

使用RunWorkerCompleted 中的**e.Error**检查另一个线程中的异常。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2011-08-26T13:18:00.360

这只会在没有附加调试器的情况下工作，当从 Visual Studio 运行时，调试器将在 DoWork 方法中捕获未经处理的异常并中断执行，但是您可以单击继续并到达 RunWorkerCompleted 并且您将能够读取异常通过 e.Error 字段。

# audio - 我可以使用 DirectSound 轻松进行频带滤波吗？如果没有，我该怎么做？

> ID：258667
> 
> 赞同：2
> 
> 时间：2008-11-03T13:51:10.857
> 
> 标签：audio, filtering, signal-processing, waveform, equalizer

我想知道这样的事情是否可能（并且相对容易做到），如果是这样，我该怎么做？

我想对正在复制的波形文件进行频带过滤。类似于您在大多数类似 Winamp 的应用程序中看到的“均衡器”。
然而，我的想法是不均衡声音，而是使用非常高的负分贝值，几乎杀死我正在过滤的频段。

第一个问题是：DirectSound 是否给了我一些允许我这样做的东西？
如果不是：您将如何解决这个问题？
我知道（尽管我不太了解）您可以使用快速傅立叶变换将采样波形转换为频率分布。现在，在更改某些频率的幅度值后，我显然无法从该分布返回到原始波形:-)

我怎么能做这样的事情？

另外，我可以使这些过滤器精确到什么程度？（如果我想过滤掉从 2250Hz 到 2275Hz 的所有内容，那么过滤器会有什么误差？我可以获得的最大精度取决于什么？）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T14:01:25.157

我不知道 DirectSound 是否提供此功能，我认为它没有，因为 DSP 相当复杂，并且经常因情况而异。您想要做的通常称为 DSP（数字信号处理）中的“过滤”。很多时候，这涉及使用 FIR（有限脉冲响应）滤波器。有许多图书馆可以完全按照您的意愿行事。滤波器设计最棘手的一个方面是在速度、精度和误差之间总是存在权衡。在您的示例中，您将能够消除频率之间的信号，但这也会影响周围的频率。它将影响的量与处理时间和过滤器设计有关。

也许从这里开始（数学重）：[FIR 滤波器](http://en.wikipedia.org/wiki/Finite_impulse_response)

然后用谷歌搜索你自己的 Windows/DirectSound 特定的 FIR 相关信息

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T14:04:15.853

据我所知，DirectSound 不会像您在此处描述的那样进行频带过滤。

带通滤波背后的一般思想是使用延迟线，它接收信号输出并将其反馈到输入流中，具有指定的延迟时间和衰减（或衰减）因子。精心设计的滤波器将使您能够放大或衰减音频源中的特定频率范围。请注意，此技术不使用 FFT，除非在测试过滤器效果时作为诊断工具。FFT 技术可以更精确地限制或放大频率，但延迟线通常更快（并且更容易编码）。

对于处理 WAV 文件（而不是进行实时合成/过滤），在音频缓冲区上执行延迟线非常简单：

```
for (int i = 0; i < samples.Length - delay; i++)
{
    samples[i + delay] += samples[i] * decay;
} 
```

当然，在实践中它比这要复杂一些（例如，您必须处理潜在的溢出值，并且某些类型的延迟线必须反向运行，这在 C 样式编码中总是很痛苦）。

至于过滤器的精确度，这仅取决于其设计的好坏（这非常困难）。当您使用延迟线设计滤波器时，您实际上所做的事情与电子工程师在廉价微处理器出现之前的几十年中所做的（并且现在仍在做）相同的事情。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T14:00:31.103

DirectSound 根本不提供信号处理设施。您可以使用多种技术来做您想做的事。可以使用 FFT 来做你想做的事，但这可能不是最好或最简单的方法。您应该阅读音频 DSP，尤其是数字滤波（IIR、FIR）。有一本很好的 DSP 书籍可免费在线获得，名为[The Scientist and Engineer's Guide to Digital Signal Processing](http://www.dspguide.com/)，绝对值得一看。亚马逊等还有许多其他优秀的 DSP 书籍。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T12:20:32.257

我不知道有任何图书馆直接处理这类事情。

您可以使用傅里叶变换实现您想要的，诸如[FFTW](http://www.fftw.org/)之类的实现会为您完成计算工作，但根据我的经验，使用起来非常讨厌，并且使用大量内存，特别是如果您想处理更长的音频位一击。

使用 FFT 应用 eq 的基本思想是：

1.  获取您的音频。音频只是一个非常长的值（样本）数组，它是扬声器锥体的位移/随着时间的推移。
2.  对音频进行傅里叶变换（库会这样做，但您必须将音频样本分流为正确的格式。这会将基于时间的样本转换为基于频率的表示 - 本质上这会将信号转换为显示分布信号中的频率。
3.  向上划分频率分布 - 将分布划分为多个区域，每个区域将是一个频率范围。
4.  然后，您可以对频段进行调整 - 对于您的示例，您可以将一个区域归零以删除它的所有痕迹。
5.  取更新后的频率分布的傅里叶逆变换。这会将表示返回到时域，重建原始信号的（近似值），但要进行您所做的调整。

这样做可以让您准确地操纵音频中存在的频率，从而为您提供您想要的那种控制。但是请注意，实施起来并不简单。

我建议围绕这个主题阅读。节拍检测与其中很多密切相关（大量使用基本技术） - 尝试[这里](http://www.owlnet.rice.edu/~elec301/Projects01/beat_sync/beatalgo.html#filterbank)的前几个部分作为开​​始。

希望能有所帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-14T19:44:31.383

DirectSound 可能不直接支持这一点，但 DirectShow 应该。你可以改用那个 API 吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-04T21:12:23.307

我支持 FIR 滤波器的想法。要获得窄缺口，您将需要一个长滤波器内核。

基本上，您使用输入流对一组值（内核）的卷积。每个输出样本都是前 N 个样本的总和乘以它在过滤器内核中的相应条目。

所以你需要保持一个内核数组和一个相同数量的样本的 FIFO 或循环缓冲区。

它们是网络上的 FIR 滤波器内核计算器，只需谷歌“FIR 滤波器计算器”。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-28T05:57:00.773

您应该能够进行 FFT，在频域（缩放频率箱）中乱七八糟，然后进行 IFFT 以恢复时域信号。否则，使用 ScopeFIR 或 MATLAB 设计滤波器非常容易。ScopeFIR 可以轻松设计带阻滤波器并为您提供系数，以便您可以对信号进行卷积。这是 ScopeFIR 网站上的教程：http: [//www.iowegian.com/fir/tutor/firintro.htm](http://www.iowegian.com/fir/tutor/firintro.htm)

# json - GWT 覆盖类型，转换为 JSON

> ID：258668
> 
> 赞同：8
> 
> 时间：2008-11-03T13:51:52.103
> 
> 标签：json, gwt

在 GWT 中，将 JavaScriptObject 覆盖类型转换为 JSON 字符串的最佳方法是什么？

我目前有

```
public final String toJSON() {      
    return new JSONObject(this).toString();
} 
```

这似乎工作正常。我想知道是否有更好的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-12-01T20:59:45.517

我从来没有真正尝试过（到目前为止只消耗了 JSON，从来不需要生成它）。这似乎是本机浏览器/javascript 功能。

你*可以*把它写成：

```
public native String toJSON() /*-{
  return this.toString();
}-*/; 
```

它们本质上只是做完全相同的事情，并且可能导致相同的 JavaScript 输出。优化编译器真的很棒。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-08-18T14:44:43.090

我们有一个这样的 JSNI 方法，但是使用 douglas crockfords JSON 库（以防浏览器本身不提供）：

[https://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)

```
public native String stringify() /*-{
  return JSON.stringify();
}-*/; 
```

好在 stringify 可以使用参数来漂亮地打印带有指定缩进的输出......除此之外

# php - htaccess 请求转发，如果内部 ip

> ID：258680
> 
> 赞同：0
> 
> 时间：2008-11-03T13:59:08.003
> 
> 标签：php, .htaccess, forwarding

如果请求来自内部 IP 范围，是否有可能的 htaccess 指令可以透明地将请求从 index.php 转发到 index_internal.php？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T14:11:36.293

```
RewriteEngine on

RewriteCond %{REMOTE_ADDR} ^192\.168\.1\. [OR]
RewriteCond %{REMOTE_ADDR} ^10\.15\.
RewriteRule ^index\.php$ index_internal.php [R,NC,QSA,L] 
```

这是做什么的：

启动 mod_rewrite 引擎（你可能已经有了）

if（客户端 IP 地址以“192.168.1”开头。[或]

客户端 IP 地址以“10.15”开头。）

并且页面名称是 index.php ([n]ot [c]asesensitive), [r]edirect to index_internal.php, [q]uery [s]tring [a] append (ie become `index.php?foo=bar`) `index_internal.php?foo=bar`, [l]eave processing .

根据需要对 IP 地址块进行修改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T14:05:41.950

应该这样做（显然更改 IP 地址以匹配您的网络）：

```
RewriteCond %{REMOTE_ADDR} ^192\.168\.
RewriteRule index.php index_internal.php 
```

如果你想要一个实际的标题，那就做吧`RewriteRule index.php index_internal.php [L,R,QSA]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T14:21:20.890

好的，这是我的代码（无重定向）基于[维基百科的专用网络列表](http://en.wikipedia.org/wiki/Private_network)

```
RewriteEngine on
RewriteCond %{REMOTE_ADDR} ^10\. [OR]
RewriteCond %{REMOTE_ADDR} ^172\.[1-3]{1}\d{1}\. [OR]
RewriteCond %{REMOTE_ADDR} ^192\.168\.
RewriteRule ^index\.php index_internal.php [NC,QSA,L] 
```

# java - .NET (Mono) 是否支持跨平台文件操作和跨平台音频元数据处理（通过库）？

> ID：258686
> 
> 赞同：1
> 
> 时间：2008-11-03T14:00:54.050
> 
> 标签：java, .net, file-io, cross-platform, metadata

对于我的下一个项目，两个领先的领跑者是 .NET 和 Java。该项目将采用一个包含目录和音乐文件（最初是 MP3，但最终扩展到其他音乐格式）的目录（类似于 Windows 中的 My Music）。对于每个文件，它允许您播放文件并查看/编辑其元数据、文件名和位置。

我知道 Java 有用于获取/编辑元数据和跨平台文件操作支持的库。我也知道 .NET 有用于处理元数据的库，但我不确定我需要的文件操作。但是，我真的很想回到 .NET，尤其是因为我想将它保留在我的简历中，但自 .NET 2.0 以来我就没有使用过它（现在是什么，3.5？），如果我不使用跟上它，把它放在我的简历上是没有意义的，因为我无法回答任何关于新技术版本的问题。

最初，Windows 是我唯一关心的问题，但我想将其作为跨平台应用程序发布。

注意：我知道我正在重新发明轮子，但这是我遇到的一个问题，我认为解决它会很有趣。它处理了许多问题，从 UI 问题到文件结构管理到外部库等等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T17:07:21.180

本主题第一部分来自 mono 的官方页面是[IOMap](http://mono-project.com/IOMap)。

> Mono 现在有一个可移植到 Mono 的层，它将解决这些问题，而无需更改您的代码。这将消除移植周期的很大一部分，因为一整类令人讨厌的问题都消失了。
> 
> 通过将环境变量`MONO_IOMAP`（我们可能将其重命名为更短的名称）设置为以下值之一来启用新的可移植性框架：
> 
> *   **case：**使所有文件系统访问不区分大小写。
> *   **驱动器：**从路径名中去除驱动器名称。
> *   **all：**启用机箱和驱动器。
> 
> 此外，如果启用了这些选项中的任何一个，则目录分隔符映射也会打开。

自 1.1.18 起包含此功能。

# .net - 为 .Net XmlDocument 实现 GetByClassName

> ID：258691
> 
> 赞同：1
> 
> 时间：2008-11-03T14:02:16.780
> 
> 标签：.net, xpath, xmldocument, classname

我正在使用 XmlDocument 来解析和操作 XHTML 字符串，将一些节点转换为非 HTML 节点。

获取具有给定类名的所有节点列表的最佳方法是什么？可以用 XPath 完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T14:04:38.177

有一个给定的班级？如果它只是一个类，那么您应该能够执行类似 .SelectNodes("//*[@class='foo']") 的操作。如果不是 xhtml，那么[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)值得一看。

在客户端，jQuery 将是一个不错的选择——它支持复合类名。

如果您在单个元素上有多个类名，并且需要在服务器上处理它，我希望您可能需要先找到候选类 ("//*[@class!=''])，然后遍历它们做 a`Split()`并检查结果中的类名；即手动将其拆开。

在 LINQ 术语中，类似于：

```
 var qry = from XmlElement el in d.SelectNodes("//*[@class!='']")
                  let classes = el.GetAttribute("class").Split(new[] {' '},
                          StringSplitOptions.RemoveEmptyEntries)
                  where classes.Contains("foo")
                  select el; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T14:04:51.250

是的，使用 XPath 很容易：

```
//*[@class='foo'] 
```

# c# - 在格式化为 XML (C#) 的字符串中更新“ID”的快速而肮脏的方法

> ID：258694
> 
> 赞同：2
> 
> 时间：2008-11-03T14:03:17.307
> 
> 标签：c#, xml, string, parsing, format

对于一次性操作，我需要解析 XML 字符串的内容并更改“ID”字段的数字。但是，我不能冒险更改字符串的任何其他内容，例如。空格、换行符等必须保持原样！

由于我已经体验到 XmlReader 往往会弄乱空格，甚至可能重新格式化您的 XML，我不想使用它（但请随意说服我）。这也为 RegEx 尖叫，但是……我不擅长 RegEx，尤其是在 .NET 实现中。

这是字符串的一小部分，在某些情况下需要更新 ID 字段的编号。字符串中可以有许多这样的 VAR 条目。所以我需要将每个 ID 转换为 Int32，比较并修改它，然后将它放回字符串中。

```
<VAR NAME="sf_name" ID="1001210"> 
```

我正在寻找最简单（就编码时间而言）和最安全的方法来做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T14:15:50.603

您正在寻找的正则表达式模式是：

```
ID="(\d+)" 
```

匹配组 1 将包含数字。使用[MatchEvaluator Delegate](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.matchevaluator.aspx)将匹配项替换为动态计算的替换项。

```
Regex r = new Regex("ID=\"(\\d+)\"");
string outputXml = r.Replace(inputXml, new MatchEvaluator(ReplaceFunction)); 
```

`ReplaceFunction`像这样的东西在哪里：

```
public string ReplaceFunction(Match m)
{
  // do stuff with m.Groups(1);
  return result.ToString();
} 
```

如果您需要，我可以扩展正则表达式以更具体地匹配。目前*所有*ID 值（仅包含数字）都被替换。如果您不想更改它，您还可以将那一点“额外智能”构建到匹配评估器函数中，并使其返回匹配不变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T14:18:38.820

看看[XmlDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)类中的这个属性[PreserveWhitespace](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.preservewhitespace.aspx)

# windows - 如何获取 Windows 中所有打开的命名管道的列表？

> ID：258701
> 
> 赞同：100
> 
> 时间：2008-11-03T14:04:54.527
> 
> 标签：windows, winapi, pipe

有没有一种简单的方法来测试您的命名管道是否正常工作？我想确保我从我的应用程序发送的数据实际上正在发送。有没有一种快速简便的方法来获取所有命名管道的列表？

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2008-11-03T14:39:49.277

您可以使用sysinternals中的[Process Explorer](http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx)查看这些内容。使用“Find -> Find Handle or DLL...”选项并输入模式“\Device\NamedPipe\”。它将显示哪些进程打开了哪些管道。

* * *

## 回答 #2

> 赞同：100
> 
> 时间：2012-08-22T04:44:28.173

在 Windows Powershell 控制台中，键入

```
[System.IO.Directory]::GetFiles("\\.\\pipe\\") 
```

* * *

如果您的操作系统版本高于 Windows 7，您还可以键入

```
get-childitem \\.\pipe\ 
```

这将返回一个对象列表。如果您只想要名称：

```
(get-childitem \\.\pipe\).FullName 
```

（第二个示例`\\.\pipe\` 在 Powershell 7 中不起作用，但第一个示例可以）

* * *

## 回答 #3

> 赞同：57
> 
> 时间：2010-11-23T02:13:18.573

请尝试以下操作：

```
String[] listOfPipes = System.IO.Directory.GetFiles(@"\\.\pipe\"); 
```

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2009-09-16T22:19:42.290

使用Sysinternals 的[pipelist.exe](http://technet.microsoft.com/en-us/sysinternals/dd581625.aspx)。

* * *

## 回答 #5

> 赞同：26
> 
> 时间：2017-01-05T14:44:37.667

我偶然发现了 Chrome 中的一项功能，该功能将通过导航到“file://.//pipe//”列出所有打开的命名管道

由于我似乎找不到任何对此的参考，而且它对我很有帮助，我想我可以分享一下。

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2010-11-17T22:31:46.057

C＃：

```
String[] listOfPipes = System.IO.Directory.GetFiles(@"\\.\pipe\"); 
```

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2019-11-27T09:23:05.803

`CMD`提示时：

```
>ver

Microsoft Windows [Version 10.0.18362.476]

>dir \\.\pipe\\ 
```

* * *

## 回答 #8

> 赞同：9
> 
> 时间：2011-01-03T22:30:37.737

第二个管道在提交时被此网站解释...您需要在开头使用两个反斜杠。所以请务必使用`System.IO.Directory.GetFiles(@"\\.\pipe\")`.

请注意，我已经看到此函数调用抛出“路径中的非法字符”。当我的机器上的一个管道包含无效字符时出现异常。PipleList.exe 工作正常，所以它似乎是 MS 的 .NET 代码中的一个错误。

# sql-server-2008 - 快照隔离

> ID：258719
> 
> 赞同：3
> 
> 时间：2008-11-03T14:12:04.013
> 
> 标签：sql-server-2008

有谁知道sqlserver2008哪些版本支持快照隔离？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T15:07:39.970

快照隔离是在 SQL 2005 中添加的，并且不依赖于 2005 或 2008 的 SKU 来获得该支持。甚至 SQL Express (2005/2008) 也支持该功能。

```
ALTER DATABASE DatabaseName
SET ALLOW_SNAPSHOT_ISOLATION ON 
```

# .net - 哪种内置 .NET 加密算法最安全？

> ID：258721
> 
> 赞同：13
> 
> 时间：2008-11-03T14:14:13.527
> 
> 标签：.net, encryption, cryptography

.net 附带的哪种加密算法最安全？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2008-11-03T14:32:46.453

您无法直接比较所有类型的加密算法。这就像将排序算法与乘法算法进行比较：它们有不同的目的。话虽如此，我会回答：

*   对称密码：[AES-256](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aesmanaged.aspx)
*   非对称密码：具有 4096 位密钥的[RSA](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsacryptoserviceprovider.aspx)（我相信这是 .NET 中的最大值）或具有 571 位密钥的[ECDSA](http://msdn.microsoft.com/en-us/library/system.security.cryptography.ecdsa.aspx)（但仅在 .NET 3.5 中支持）
*   哈希：[SHA-512](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha512.aspx)
*   消息验证码：[带有 SHA-512 的 HMAC](http://msdn.microsoft.com/en-us/library/system.security.cryptography.hmacsha512.aspx)

话虽这么说，这些对于大多数应用程序来说都是多余的，您应该使用 AES-128、带有 2048 位密钥的 RSA、SHA-256 和带有 SHA-256 的 HMAC。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T14:22:00.997

我有点偏爱[SHA-512](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha512.aspx)。如果 512 有点过多，SHA-2 系列的其他成员可能会有所帮助 - [SHA-256](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha256.aspx)和[SHA-384](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha384.aspx)都属于 SHA-2 系列。但是 AviewAnew 对[AES 256](http://msdn.microsoft.com/en-us/library/system.security.cryptography.aesmanaged.aspx)的建议也很好。

# task - todo.txt 和任务管理

> ID：258724
> 
> 赞同：11
> 
> 时间：2008-11-03T14:16:08.000
> 
> 标签：task, scheduling

抱歉，如果这经常被提及，但我想知道其他人如何处理个人任务管理。

我已经阅读了 GTD 的（部分内容），开始变得兴奋起来，在各处安装了大量的插件，然后就让它全部搁置了。我用过todoist、outlook、google calendar、project。我试过在记事本、“笔记本”、便利贴和电子表格等中写列表，但没有一个能持久。

为什么一个简单有效的待办事项应用程序这么难找？由于该应用程序使用如此频繁，我发现该应用程序的任何小问题在使用几天后都会变得过于夸张。

到目前为止，我最喜欢的应用程序是 todo.txt 的一个变体，称为[task](http://www.beckingham.net/task.html)

你用什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2008-11-03T14:52:37.880

很抱歉成为坏消息的承担者，但是“简单有效的待办事项应用程序”很难找到，因为您正在使用该工具来代替自律和承诺。诸如“我已经阅读了部分内容并尝试了那个和那个，但是轻微的界面问题导致我在几天内放弃它”之类的陈述意味着您正在寻找灵丹妙药和借口。

*   工具的小问题是放弃努力的糟糕借口。
*   选择一个系统和一个工具并**坚持下去**
*   没有任何工具能给你改变习惯所需的自律和承诺
*   个人时间管理是关于改变你的观点和习惯，而不是找到“正确”的工具
*   警告：有些系统比其他系统更适合您的个人工作要求。如果您是开发人员，那么像 Franklin Planner 这样的基于日历的系统可能不会工作，而像 GTD 这样的基于列表的系统可能会。

建议：谷歌并审查各种系统，选择一个，并承诺至少一个月。例如，尝试 GTD 和纸笔，然后在系统成为习惯后开始幻想。一旦你知道你需要如何使用系统并致力于它，寻找完美的工具。与此同时，完美的工具是破坏引用的好习惯的敌人；-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-03-27T04:16:12.020

我使用文本文件。每个都包含一个项目列表，以空行分隔。项目空间的每一行都包含如下语法：

*   '-'：感兴趣的项目
*   '*'：待办事项
*   ':': 代码更改
*   'AWT'：（等待外部的东西）

文本文件一起存在，项目可以流畅地进出：

*   work.txt：当前工作/活动项目
*   deferred.txt：某天要做的事情
*   done.txt：完成；存档备查

文本文件系统快速、有效、全球兼容，并在几分之一秒内加载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-12-19T01:21:59.703

我想我和你一样（两年前）：在找到完美的工具之前懒得做任何事情。是的，人们说工具永远不应该被误认为是执行计划的替代品，绝对是对...

That said, one tool that seems "perfect enough" for me to drop thoses excuses for [GTD](http://members.optusnet.com.au/~charles57/GTD/orgmode.html): [org-mode](http://orgmode.org) for Emacs. I really hope so, anyway.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T14:27:11.970

我认为这几乎是[我如何应用 David Allen 的“Getting Things Done”作为程序员的副本？](https://stackoverflow.com/questions/248159/how-can-i-apply-david-allens-getting-things-done-as-a-programmer)

另请参阅：
[有人可以做些什么来组织这里？](https://stackoverflow.com/questions/1831/what-can-someone-do-to-get-organized-around-here)
[时间管理技巧、工具和技巧](https://stackoverflow.com/questions/71273/time-management-tricks-tools-tips)
[作为开发人员，您使用什么来记笔记？](https://stackoverflow.com/questions/78756/what-do-you-use-to-keep-notes-as-a-developer)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T14:27:27.163

这与[带有命令行界面的任务/问题跟踪系统](https://stackoverflow.com/questions/81698/taskissue-tracking-system-with-command-line-interface)有关，也提到了 todo.txt

就个人而言，我使用我的 Palm PDA 上的待办事项列表，它与 Apple iCal 同步。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T15:02:16.017

[ToDoList](http://www.codeproject.com/KB/applications/todolist2.aspx)也是一种选择

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-27T04:46:31.933

我正在尝试更好地管理我的时间。我喜欢从简单开始并根据需要构建复杂性，而不是实现一些难以维护的庞然大物。

为此，我使用简单的列表。 [http://tadalist.com](http://tadalist.com)

它非常简单、免费且基于互联网，因此它随处可见。优胜者

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-03T14:33:20.443

在我们公司，我们使用 Google Docs 电子表格 - 这很棒，因为您可以将所有任务放入单元格中，并且您可以与其他人共享和共同编辑此文档。它非常易于使用，不需要您填写大量表格。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2008-11-03T14:50:08.400

[我使用一个名为NoteZilla](http://www.conceptworld.com/NoteZilla/)的便签程序

只需从头开始你的任务/想法/笔记，然后忘记它。这就是我喜欢便利贴的原因。无需分类，分组。所有这些仍然可以在 NoteZilla 中完成。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2008-11-03T15:01:38.127

我使用[TiddlyWiki](http://www.tiddlywiki.com/)。它使用简单，全部在一个 html 文件中（非常便携）。

这对我很有效。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2008-11-03T15:10:50.807

我在某种程度上回应了上述评论。对我来说，该工具对于建立允许我以一致的方式融入 GTD 原则的心态和习惯来说几乎是次要的。我真的很喜欢它，当我可以得到它的时候。当我可以自律地做一些小事情时，就会有一种很好的控制感和方向感——每周扫描、定期审查等等。

我的下一个 GTD 挑战是离开树林，这样我就可以看到森林了。:-) David Allen 谈到了与进球相关的 50,000 英尺、30,000 英尺、10,000 英尺的观点。这一切都非常高尚，但我必须超过500英尺。

如果您熟悉 GTD，DIY Planner 上有一个不错的摘要甲板 PDF：

[http://www.diyplanner.com/diyp_official/diyp3cl/diyp3_gtdref_cl_2up.pdf](http://www.diyplanner.com/diyp_official/diyp3cl/diyp3_gtdref_cl_2up.pdf)

如果您是纸质计划迷（我是），该网站就像破解：D

希望能帮助到你。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2008-11-03T15:30:25.370

我使用[myLifeOrganized](http://www.mylifeorganized.net/)。最重要的是，您只需要开始记录您在每项任务中必须做的下一件事。MLO 让您轻松快速地做到这一点。

它有一个方便的快速任务输入对话框，您可以快速输入数据。您可以根据需要记录尽可能多的文件。这个软件，因为添加东西很容易，已经救了我很多次。它帮助我记住了我忘记的事情。我现在想知道这些年来我忘记了多少事情并没有意识到。

我从 USB 棒上运行它，并把它放在我的手机上。我什至用它来帮助我概述代码。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-03-27T04:01:51.853

正如其他人所说，GTD 就是关于纪律：实际做你清单上的事情。但是，一定要优先考虑。

对于我的任务列表管理，我目前使用[Remember the Milk](http://www.rememberthemilk.com/)，它与 IM 集成相当方便（它发送 IM 提醒）。我最大的挑战是记住添加任务，但我做得越来越好，因为有人指出我可以做一个重复的任务来提醒我：P。

# c# - 复古拟合新语言功能 C#（或任何其他语言）

> ID：258725
> 
> 赞同：1
> 
> 时间：2008-11-03T14:16:08.060
> 
> 标签：c#, resharper

使用我的 .Net 2.0 代码库时，ReSharper 不断建议应用最新的 c# 3.0 语言功能，最值得注意的是；将简单属性转换为自动实现属性或将局部变量声明为 var。在其他人中。

当一个新的语言特性到来时，你是返回并虔诚地将它应用到你现有的代码库中，还是让代码保持最初编写的状态，接受如果使用新语言特性编写新代码，你的代码之间会出现不一致？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T14:20:47.117

如果它没有坏，就不要修理它。当然，如果你对单元测试有信心，你可以试一试，但你真的不应该“仅仅因为”就随意更改代码。

当然 - 在某些情况下，简化代码是进行更改的正当理由 - 但即使是像切换到自动实现的属性这样无辜的事情也可能会破坏做出假设并使用反射直接更新字段的代码。或者它可能会破坏序列化。

更改为“var”实际上可以为您提供不同的（更具体的）类型，这可能会导致选择不同的方法重载等。

再说一次；这取决于您对单元测试的信心。

其他注意事项：

*   团队的其他成员了解新语法了吗？
*   您的项目是否需要支持 C# 2.0（例如，某些开源项目可能希望保持与 C# 2.0 的兼容性）。

如果这些都不是问题，您应该可以在新代码中使用新功能......在旧代码上点击“全部更新”之前要小心*一点......*

这是一个将“var”作为重大更改的简单示例：

```
 static void Main() {
        using (TextReader reader = File.OpenText("foo.bar")) { // [HERE]
            Write(reader);
        }
    }
    static void Write(TextReader reader) {
        Console.Write(reader.ReadToEnd());
    }
    static void Write(StreamReader reader) {
        throw new NotImplementedException();
    } 
```

现在切换到`var reader`标记为`[HERE]`...的行

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T14:22:01.357

我会在我去的时候简单地维护代码。最终，大部分应用程序将被清理或调整到新功能和改进。不要为了改变而改变。如果您没有获得任何性能或稳定性改进，则无需浪费时间更新代码。

C# 3 基于 C# 2 构建，两者都非常兼容。因此，每次更新都应该得到反映。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T14:22:17.940

我离开它，直到我改变那条线（或者通常只是它附近的线）。然后我升级。（有时我会更新整个类或文件，一旦我改变了其中一个）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T14:23:28.513

我不管它。除了需要大量工作之外，还有一个问题是代码是否真的相同，或者新功能是否有副作用。

在 var 的特定情况下，编译器无论如何都会在编译时放入正确的类型，所以实际上没有任何好处。

编辑：实际上我对 var 不破坏事物是错误的，所以是的，我最初的建议是有效的。如果没坏...

# timeout - 批处理文件是否有超时？

> ID：258726
> 
> 赞同：2
> 
> 时间：2008-11-03T14:16:52.320
> 
> 标签：timeout, batch-file

我在 Windows 2000 SP4 服务器上使用 bat 文件在数据库关闭时复制数据库文件。一旦 bat 文件点击 xcopy 命令，它就会进行复制，但永远不会返回 bat 文件继续执行其他命令（启动数据库等）。我应该提到 xcopy 需要几个小时。bat文件是否有某种超时或时间最大值？这是正常的吗？如果是这样，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T14:24:56.763

批处理文件不会超时。听起来您可能会遇到来自 XCOPY 的提示，例如“您确定”提示。

确保您已将必要的命令行开关添加到 XCOPY 以使其静默。

我知道的有：

```
-Y to suppress prompts about overwriting files

-C continue even if errors occur 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T14:28:21.907

此外，请确保您正在运行 XCOPY.EXE 应用程序，并且没有在您的路径中的某处找到 XCOPY.BAT 文件。（从批处理文件调用批处理文件会阻止返回，除非您使用 CALL 命令）

并且，确保在 XCOPY 期间没有覆盖批处理文件本身。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T19:40:09.843

大概在您的 backup.log 文件中一切看起来都正常吗？看起来您正在将 STDOUT 重定向到您的日志文件，而不是 STDERR - 建议将 2>&1 添加到命令行末尾，以确保您不会丢失日志中的任何错误信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T14:24:17.997

我知道 .bat 或 .cmd 文件没有超时。但是，可能有关于启动的进程吗？你是如何启动它的？

# delphi - 在 Delphi Win32 应用程序中显示调用堆栈

> ID：258727
> 
> 赞同：16
> 
> 时间：2008-11-03T14:17:29.853
> 
> 标签：delphi, error-handling

我想在 Delphi 2007 (Win32) 的错误对话框中显示堆栈跟踪。

理想情况下，我想要这样的东西：

```
try
  //do something
except on e : exception do
  begin
    //rollback a transaction or whatever i need to do here       
    MessageDlg('An error has occurred!' + #13#10 +
                e.Message + #13#10 +
               'Here is the stack trace:' + #13#10 +
               e.StackTrace,mtError,[mbOK],0);
  end;  //except
end;  /try-except 
```

并且输出类似于 IDE 中的调用堆栈：

```
MYPROGRAM.SomeFunction
MYPROGRAM.SomeProcedure
MYPROGRAM.MYPROGRAM
:7c817067 kernel32.RegisterWaitForInputIdle + 0x49 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2008-11-03T14:24:50.853

[madExcept](http://www.madshi.net/madExceptDescription.htm)有一个方法 StackTrace（在单元 madStackTrace 中）可以做到这一点。

[JEDI 代码库](http://sourceforge.net/projects/jcl/)在单元 JclDebug 中提供了类似的功能。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-02-18T12:11:30.440

我们使用[Exceptional Magic](http://www.dimusware.com/products/excmagic/index.html)，它对我们非常有效。有了它，您可以执行以下操作：

```
try
    raise Exception.Create('Something bad happened...');
except
    on e: Exception do begin
        CallStack := TStringList.Create;
        try
            ExceptionHook.LogException; // Logs call stack
            ExceptionHook.CallStack.Dump(CallStack);
            ShowMessage(CallStack.Text);
        finally
            CallStack.Free;
            end;
        end;
    end; 
```

这会产生一个非常详细的调用堆栈：

```
Exception 'Exception' in module BOAppTemplate.exe at 003F3C36
Something bad happened...

Module: BOAppUnit, Source: BOAppUnit.pas, Line 66
Procedure: MyProcedure

Call stack:
:007F4C36 [BOAppTemplate.exe] MyProcedure (BOAppUnit.pas, line 66)
:7C812AFB [kernel32.dll]
:007F4C36 [BOAppTemplate.exe] MyProcedure (BOAppUnit.pas, line 66)
:00404DF4 [BOAppTemplate.exe] System::__linkproc__ AfterConstruction
Recursive call (2 times):
:007F4C36 [BOAppTemplate.exe] MyProcedure (BOAppUnit.pas, line 66)
:007F4CE6 [BOAppTemplate.exe] MyProcedure (BOAppUnit.pas, line 79)
:007F4D22 [BOAppTemplate.exe] Boappunit::TBOAppForm::Button1Click (BOAppUnit.pas, line 82)
:004604C2 [BOAppTemplate.exe] Controls::TControl::Click
:004487FB [BOAppTemplate.exe] Stdctrls::TButton::Click
:004488F9 [BOAppTemplate.exe] Stdctrls::TButton::CNCommand
:0045FFBA [BOAppTemplate.exe] Controls::TControl::WndProc 
```

Exceptional Magic 没有源码只要 25 美元，所以相对便宜。希望有帮助！

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2010-05-05T12:41:23.380

您可能对这篇文章感兴趣：“ [Delphi 2009 及更高版本中的新异常类](http://eurekalog.blogspot.com/2010/05/new-exception-class-in-delphi-2009-and_05.html)”。

# java - 在 Windows Vista 上请求 Java 应用程序的管理员权限

> ID：258728
> 
> 赞同：9
> 
> 时间：2008-11-03T14:17:36.577
> 
> 标签：java, windows-vista, scheduler, access-denied

当我尝试通过 Java ProcessBuilder 类在任务调度程序中创建新任务时，我收到 Windows Vista 的访问被拒绝错误。在 XP 上它工作得很好。

当我使用“以管理员身份运行”选项时，它也可以在 Vista 上运行..

然而，这是一个额外的步骤，用户可能不知道这一点。当用户只是双击应用程序图标时，它将失败并拒绝访问。我的问题是如何强制 Java 应用程序在启动后立即重新获得管理员权限？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2010-02-23T14:34:58.833

您是否考虑过使用 launch4j 将 Java 应用程序包装在 .exe 中？通过这样做，您可以嵌入一个清单文件，该文件允许您为可执行文件指定“执行级别”。换句话说，您控制应该授予正在运行的应用程序的权限，有效地告诉操作系统“以管理员身份运行”，而无需用户手动执行此操作。

例如...

构建.xml：

```
<target name="wrapMyApp" depends="myapp.jar">
        <launch4j configFile="myappConfig.xml" />
</target> 
```

myappConfig.xml：

```
<launch4jConfig>
  <dontWrapJar>false</dontWrapJar>
  <headerType>gui</headerType>
  <jar>bin\myapp.jar</jar>
  <outfile>bin\myapp.exe</outfile>
  <priority>normal</priority>
  <downloadUrl>http://java.com/download</downloadUrl>
  <customProcName>true</customProcName>
  <stayAlive>false</stayAlive>
  <manifest>myapp.manifest</manifest>
  <jre>
    <path></path>
    <minVersion>1.5.0</minVersion>
    <maxVersion></maxVersion>
    <jdkPreference>preferJre</jdkPreference>
  </jre>
</launch4jConfig> 
```

我的应用程序清单：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
        <security>
            <requestedPrivileges>
            <requestedExecutionLevel level="highestAvailable"
                uiAccess="False" />
        </requestedPrivileges>
    </security>
    </trustInfo>
</assembly> 
```

有关模式的详细信息，请参阅[http://msdn.microsoft.com/en-us/library/bb756929.aspx](http://msdn.microsoft.com/en-us/library/bb756929.aspx)和 launch4j 网站。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T14:50:03.000

我不确定您是否可以以编程方式进行操作。如果您有应用程序的安装程序，则可以添加注册表项以强制以管理员身份运行：

> 路径：HKEY_CURRENT_USER\Software\Microsoft\Windows NT\Currentversion\Appcompatflags\layers
> 
> 键：<< exe的完整路径>>
> 
> 值：RUNASADMIN
> 
> 类型：REG_SZ

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-10T16:30:46.907

虽然 FreeCouch 的回答很好，但我遇到了一些问题，并想把它放在这里，以便下次其他人可以轻松受益。

要在 Java 中获得管理员权限，据我所知，解决方案是将 *.jar 包装在 *.exe 中，并使用 Launch4J 之类的程序并将 Manifest 与它绑定。

要创建 Manifest 文件，请打开任何文本编辑器（如记事本）并将这些行粘贴到其中，并将其与文件名及其扩展名一起保存，例如：**myApplication.exe.manifest**

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
     <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
         <security>
             <requestedPrivileges>
                 <requestedExecutionLevel level="highestAvailable" uiAccess="False" />
             </requestedPrivileges>
         </security>
     </trustInfo>
</assembly> 
```

在 Launch4J 中，在`Basic`选项卡上将此文件添加到 Wrapper Manifest 选项中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-02-13T06:39:57.537

我还没有找到最好的解决方案。但与“James Van Huis”相比，我有另一种解决方法。请改用 RUNASINVOKE，这样您就不必在每次运行应用程序时都看到提示 Allow/Deny。

注意：您始终必须是管理员，这就是我要解决的问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-04-04T06:47:42.403

**使用 launch4j Gradle 插件**

特别是当已经使用 Gradle 时，很容易应用[launch4j 插件](https://github.com/TheBoegl/gradle-launch4j)来解决这个问题。

与[freecouch 的答案一样](https://stackoverflow.com/a/2318883/4126843)`myapp.manifest`，创建一个文件

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <trustInfo xmlns="urn:schemas-microsoft-com:asm.v3">
        <security>
            <requestedPrivileges>
            <requestedExecutionLevel level="highestAvailable"
                uiAccess="False" />
        </requestedPrivileges>
    </security>
    </trustInfo>
</assembly> 
```

然后通过添加到您的应用 Gradle 插件`build.gradle`

```
plugins {
  id 'java'
  id 'edu.sc.seis.launch4j' version '2.4.3'
}

launch4j {
    mainClassName = 'com.mypackage.MainClass'
    icon = "$projectDir/icons/icon.ico"
    manifest = "$projectDir/myapp.manifest"
} 
```

或者，如果使用 Kotlin Gradle DSL，您的`build.gradle.kts`：

```
plugins {
    application
    kotlin("jvm") version "1.2.31"
    java
    id("edu.sc.seis.launch4j") version "2.4.3"
}

launch4j {
    mainClassName = "com.mypackage.MainKt"
    icon = "$projectDir/icons/icon.ico"
    manifest = "$projectDir/myapp.manifest"
} 
```

# linux - 为什么双引号会改变结果

> ID：258729
> 
> 赞同：1
> 
> 时间：2008-11-03T14:18:31.130
> 
> 标签：linux, bash, shell, scripting

我有一个简单的 linux 脚本：

```
#!/bin/sh
for i in `ls $1`
do
       echo $i
done 
```

在我的临时文件夹中有 4 个文件：aa、a.aa、a.ab 和 a.ac

当我调用 ./script temp/*.?? 我得到：

```
temp/a.aa 
```

当我调用 ./script "temp/*.??" 我得到：

```
temp/a.aa
temp/a.ab
temp/a.ac 
```

为什么双引号会改变结果？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T14:30:48.983

在第一种情况下，外壳扩展`temp/*.??`为：

```
temp/a.aa temp/a.ab temp/a.ac 
```

由于您只查看脚本中的第一个参数，因此仅`temp/a.aa`将其传递给 ls。

在第二种情况下，由于引号，shell 不会执行任何扩展，并且脚本会接收在对 .`temp/*.??`的调用中扩展的单个参数`ls`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T14:28:44.620

因为没有引号，shell 会将您的调用扩展到：

```
./script temp/a.aa temp/a.ab temp/a.ac 
```

代替. _ `$1`_`temp/a.aa``temp/*.??`

# linux - 更有效的 shell 文本操作

> ID：258735
> 
> 赞同：0
> 
> 时间：2008-11-03T14:20:03.857
> 
> 标签：linux, bash

我正在使用这个命令：

剪切-d：-f2

要对文本进行排序和重新编辑，是否有更有效的方法可以在不使用 sed 或 awk 的情况下执行此操作？

我也想知道如何在每个字段的末尾附加句点

目前输出就像 $x['s'] ，我希望它是 $x['s'] 。

只需使用标准的 unix 工具

编辑：我只是想知道如果没有 sed 或 awk 是否有可能，否则你会如何使用 awk 呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T14:31:58.653

**简短的回答：**不是真的

**更长的答案：** `cut`用于分割文本行，它做得很好。如果您需要更复杂的行为，则需要一种文本操作语言。您拒绝了旧时的答案，所以我会推荐`perl`。

* * *

您不想使用的任何特殊原因`sed`或`awk`？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-09T20:19:44.993

> 编辑：我只是想知道如果没有 sed 或 awk 是否有可能，否则你会如何使用 awk 呢？

awk -F: '{打印 $2"."}'

# java - 由于 xsl:include 导致转换失败

> ID：258738
> 
> 赞同：7
> 
> 时间：2008-11-03T14:20:19.193
> 
> 标签：java, xslt

我有一个包含 XSLT 转换的 Java maven 项目。我按如下方式加载样式表：

```
TransformerFactory tFactory = TransformerFactory.newInstance();

DocumentBuilderFactory dFactory = DocumentBuilderFactory
                .newInstance();

dFactory.setNamespaceAware(true);

DocumentBuilder dBuilder = dFactory.newDocumentBuilder();

ClassLoader cl = this.getClass().getClassLoader();
java.io.InputStream in = cl.getResourceAsStream("xsl/stylesheet.xsl");

InputSource xslInputSource = new InputSource(in);
Document xslDoc = dBuilder.parse(xslInputSource);

DOMSource xslDomSource = new DOMSource(xslDoc);

Transformer transformer = tFactory.newTransformer(xslDomSource); 
```

stylesheet.xsl 有许多语句。这些似乎导致了问题，当我尝试运行我的单元测试时，我收到以下错误：

```
C:\Code\workspace\app\dummy.xsl; Line #0; Column #0; Had IO Exception with stylesheet file: footer.xsl
C:\Code\workspace\app\dummy.xsl; Line #0; Column #0; Had IO Exception with stylesheet file: topbar.xsl 
```

XSLT 中的 include 语句是相对链接

```
xsl:include href="footer.xsl"
xsl:include href="topbar.xsl" 
```

我已经尝试过试验并将其更改为以下内容 - 但我仍然收到错误消息。

```
xsl:include href="xsl/footer.xsl"
xsl:include href="xsl/topbar.xsl" 
```

有任何想法吗？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-03T15:15:09.737

使用 URIResolver 解决了我的问题。

```
class MyURIResolver implements URIResolver {
@Override
public Source resolve(String href, String base) throws TransformerException {
  try {
    ClassLoader cl = this.getClass().getClassLoader();
    java.io.InputStream in = cl.getResourceAsStream("xsl/" + href);
    InputSource xslInputSource = new InputSource(in);
    Document xslDoc = dBuilder.parse(xslInputSource);
    DOMSource xslDomSource = new DOMSource(xslDoc);
    xslDomSource.setSystemId("xsl/" + href);
    return xslDomSource;
 } catch (... 
```

并将其分配给 TransformerFactory

```
tFactory.setURIResolver(new MyURIResolver()); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-06-21T12:33:49.207

URIResolver 也可以以更直接的方式使用，如下所示：

```
class XsltURIResolver implements URIResolver {

    @Override
    public Source resolve(String href, String base) throws TransformerException {
        try{
              InputStream inputStream = this.getClass().getClassLoader().getResourceAsStream("xslts/" + href);
              return new StreamSource(inputStream);
        }
        catch(Exception ex){
            ex.printStackTrace();
            return null;
        }
    }
} 
```

将 URIResolver 与 TransformerFactory 一起使用，如下所示：

```
TransformerFactory transFact = TransformerFactory.newInstance();
transFact.setURIResolver(new XsltURIResolver()); 
```

或者使用 lambda 表达式：

```
transFact.setURIResolver((href, base) -> {
    final InputStream s = this.getClass().getClassLoader().getResourceAsStream("xslts/" + href);
    return new StreamSource(s);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T14:38:39.140

[使用EntityResolver](http://java.sun.com/j2se/1.5.0/docs/api/org/xml/sax/EntityResolver.html)设置 DocumentBuilder 对象。

您必须扩展 EntityResolver 类来解析您的外部实体（footer.xsl 和 topbar.xsl）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T14:23:25.347

我曾经在 XSLT 中使用相对路径遇到过类似的问题。

如果可以，请尝试将绝对路径放入 XSLT - 这应该可以解决错误。

对于 XSLT 的最终版本，绝对路径可能并不可取，但它应该可以帮助您解决 maven 问题。也许您可以拥有两个版本的 XSLT，一个带有 maven 的绝对路径，一个带有相对路径，用于与它一起使用的任何其他工具。

# bootstrapping - 哪些工具是使用自己构建的？

> ID：258740
> 
> 赞同：11
> 
> 时间：2008-11-03T14:21:19.080
> 
> 标签：bootstrapping

我很好奇使用什么工具来构建自己的下一个版本。

例如，Delphi 长期以来一直声称“ [Delphi 是用 Delphi 编写的](http://en.wikipedia.org/wiki/Borland_Delphi#Products_developed_with_Delphi)”。

我假设 Visual Studio 是使用 Visual Studio 编写的。

还有哪些其他自行编写的工具示例？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-03T14:25:29.430

有趣的是，VB.NET 和 C# 编译器本身是用非托管 C++ 编写的（导致 C++ 团队的 T 恤：“我的编译器编译了你的”）。C# 团队希望为 VS2010 提供一个完全托管的 C# 托管 C# 编译器。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2008-11-03T15:06:27.913

Bjarne Stroustrup 在[The Design and Evolution of C++](http://www.research.att.com/~bs/dne.html)中提到，第一个 C++ 编译器是用 C++ 编写的。

我刚刚注意到这也是他的[常见问题解答](http://www.research.att.com/~bs/bs_faq.html#bootstrapping)中的一个问题：

> 第一个 C++ 编译器 (Cfront) 是用 C++ 编写的。为了构建它，我首先使用 C 编写了一个“C with Classes”-to-C 预处理器。“C with Classes”是一种 C 方言，成为 C++ 的直接祖先。该预处理器将“带有类的 C”结构（例如类和构造函数）翻译成 C。它是一个传统的预处理器，不能理解所有语言，将大部分类型检查留给 C 编译器来完成，并翻译个别在没有完整知识的情况下构建。然后我在“C with Classes”中编写了 Cfront 的第一个版本。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2008-11-03T15:19:33.440

这是题外话，但严格来说，它是自建工具的一个例子。

reprap - 一种[开源](http://www.reprap.org/bin/view/Main/WebHome)3D 原型机，最近“诞生”了“它的第一个完整的工作复制副本”。

我喜欢这种东西。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2008-11-03T14:22:40.357

一般而言，C 编译器通常是用 C 编写的... *nix 内核是在 *nix 上编译的，等等。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2008-11-03T14:45:44.117

此外，还有一个[pypy](http://codespeak.net/pypy/dist/pypy/doc/home.html)项目，它提供了一个用 Python 编写的 Python 解释器。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2008-11-03T14:32:59.447

当 gcc（Gnu C 编译器[http://gcc.gnu.org/](http://gcc.gnu.org/)）不能广泛使用时，你必须从源代码编译它，编译 stage1 编译器，然后用 stage1 编译 stage2，直到你有你的最终编译器。我想今天一定是一样的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2008-11-03T14:57:45.200

下面是另一个例子：Mono 的 C# 编译器是[自托管](http://en.wikipedia.org/wiki/Self-hosting)的 - 即它是用 C# 编写的，用于自行编译。

*狗食*是指公司在内部使用自己的产品的更普遍的做法，尤其是在其开发过程中。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2008-11-03T14:44:47.410

很多人喜欢看看如何[在 Lisp 中实现 Lisp](http://www.cs.aau.dk/~normark/prog3-03/html/notes/languages_themes-list-in-lisp.html)。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2008-11-04T09:31:14.063

[Squeak](http://www.squeak.org)是自己编写的 Smalltalk-80 实现。

> 甚至它的虚拟机也完全用 Smalltalk 编写，因此易于调试、分析和更改。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2008-11-05T00:59:33.923

Sun 的 Java 编译器早已用 Java 编写。然而，[最近的工作](https://maxine.dev.java.net/)也在用 Java 编写 JIT 编译器。这是将 Java 字节码转换为本机处理器指令的 JVM 组件。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2008-11-03T14:47:15.033

我们使用 RealBasic 进行开发。IDE 是自己编写的，或者我一直相信。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2008-11-03T15:07:42.920

ghc，Haskell 编译器，*主要是*用 Haskell 编写的。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2008-11-05T01:27:38.657

[tcc](http://bellard.org/tcc)是另一个用于 x86 和 ARM 的自托管 C 编译器。它声名鹊起的是，嗯，很小（预处理器、编译器、汇编器和链接器大约为 100k）。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-01-15T22:16:26.423

我会假设作为典型开发过程一部分的几乎所有工具都将尽可能地参与其自身的开发。这包括：

*   某些编程语言，尤其是编译语言
*   IDE
*   文本编辑器
*   版本控制系统
*   错误跟踪器
*   构建系统

如果您在一个构建这些工具之一的团队中，并且您不是为不适用于您的团队的特定利基开发它，我不知道您为什么不使用它来构建自己。让开发人员成为产品的用户是找到可能改进的最佳方法之一。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-01-16T07:31:05.493

对于 AmigaOS，有一个第三方基本解释器（不记得名称），您以后可以为其购买编译器。编译器是作为源代码交付的，所以你必须使用解释器来运行编译器来编译自己......

引用肯特贝克：

> ...这看起来有点像对自己进行脑部手术。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2008-11-03T14:27:44.607

Visual Studio 和 Team Foundation Server 自行构建。它被称为[dogfooding](http://en.wikipedia.org/wiki/Dogfooding)，这个术语如果不是源自微软，它当然[喜欢](http://weblogs.asp.net/scottgu/archive/2003/02/21/2743.aspx)

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2008-11-03T15:10:05.083

[Oracle Application Express](http://www.oracle.com/technology/products/database/application_express/index.html)是一个自身构建的 Web 应用程序开发工具。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2008-11-04T09:26:37.740

[Eclipse IDE](http://www.eclipse.org/downloads/)通常是使用 Eclipse IDE 构建和开发的。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-01-16T08:28:25.753

用自己的语言编写语言编译器是相当典型的。这称为[自托管](http://en.wikipedia.org/wiki/Self-hosting)或[引导](http://en.wikipedia.org/wiki/Bootstrapping_(compilers))。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2008-11-03T14:30:41.107

[Maven2](http://maven.apache.org/)是使用 Maven2 构建的。好的，它不是使用自己构建（即*编写*）的，因为它是构建（即*编译*）项目的工具，但它使用自己的代码进行编译...

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2008-11-03T15:30:23.917

我对[JSLint感到惊讶](http://www.jslint.com/ "JSLint")

简而言之，它被描述为使用 javascript 的 Javascript“编译器”。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2008-11-03T15:50:09.243

我正在构建一个基于 IDE 的代码生成器，并使用它来构建自己。事实上，正如 Stroustrup 所做的那样，我首先构建了一个有效的生成器模型并使用预处理器构建最终的 C++ 代码以进行编译。一旦我有了 IDE 的良好工作版本，我将开始使用它来构建它自己的更多版本。

这就像给“递归编程”的含义赋予了新的维度！

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2008-11-04T08:36:16.593

AFAIK首先使用已安装的 java 构建[OpenJDK](http://openjdk.java.net/)，然后再构建自身。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2008-11-04T09:09:11.893

Jetbrains 团队自然使用自己的 IDE [IntelliJ IDEA](http://www.jetbrains.com/idea/)来开发这个 IDE。

我认为大多数 IDE 供应商都是如此。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2008-11-04T09:09:28.430

据我所知，从源代码构建 EMACS 时，所有 ELISP 代码都是自举的。我发现这很值得注意。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2008-11-04T09:21:17.517

不完全是您所要求的，但 Revolution [http://www.runrev.com](http://www.runrev.com)的整个开发环境都是使用 Revolution 本身构建的，并且源代码（除了执行许可证的小部分）完全以源代码形式公开. 所以如果你不喜欢开发环境的实现方式，你可以改变它。找到一个错误，修复它。您还可以轻松构建其他开发工具并集成它们。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2008-11-05T00:43:31.243

我给了 Smalltalk-80 的答案。我能想到的最好、最优雅的例子。这个问题也让我想起了一个曾经很流行的稍微相关的问题：编写一个输出自身的程序。不是同一级别的引导程序，而是一个有趣的小编程难题，供您娱乐。也许不可能在所有语言中都有？

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2008-11-05T00:45:52.110

艾达和福斯

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2008-11-05T00:57:52.617

旧的 Watcom C/C++ 编译器是使用自己构建的。

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2008-11-05T01:14:13.223

Kragen Sitaker 的[Ur-Scheme是一个用自己编写的](http://www.canonical.org/~kragen/sw/urscheme/)*小型*非平凡编译器的一个很好的例子。该页面链接到这方面的几个更好的资源。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2009-01-16T06:27:01.613

我正在开发一个名为[nWire](http://www.nwiresoftware.com/)的 Eclipse 插件，它可以帮助和加速代码探索。从它足够稳定的那一刻起，我就一直将它作为我开发的一部分，而我现在不能没有它（嗯，它有很快成为一种习惯的趋势:-)。

对我来说，这是“吃你自己的狗粮”，但它真的很有帮助。这也增加了我对产品的信心。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2009-01-16T20:09:03.273

这就是大多数编译器的工作方式。是的，我知道，有例外，但列出这些例外实际上可能更短。

同时，我知道[gnat](http://www.gnu.org/software/gnat/)需要一个 Ada 编译器（gnat 可以）从源代码编译。GCC 需要某种 C 编译器，并且有一个引导阶段来使用自己构建自己（或者至少在 15 年前我最后一次经历这种痛苦时它是这样做的）。我相信 Draco 的创造者告诉我它是用 Draco 编写的。

# iphone - 在 OpenGL 中更改纹理不透明度

> ID：258742
> 
> 赞同：14
> 
> 时间：2008-11-03T14:21:55.880
> 
> 标签：iphone, opengl-es

希望这是一个简单的问题：我有一个 OpenGL 纹理并且希望能够改变它的不透明度，我该怎么做？纹理已经有一个 alpha 通道并且混合效果很好，但我希望能够降低整个纹理的不透明度，使其淡入背景。我已经摆弄了`glBlendFunc`，但没有运气 - 似乎我需要类似的东西`GL_SRC_ALPHA_MINUS_CONSTANT`，这是不可用的。我正在使用 OpenGL ES 开发 iPhone。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-03T14:46:15.987

我不知道 OpenGL ES，但在标准 OpenGL 中，您可以通过在使用之前为纹理声明颜色来设置不透明度：

```
//          R,   G,   B,   A
glColor4f(1.0, 1.0, 1.0, 0.5); 
```

该示例将为您提供 50% 的 alpha，而不会影响纹理的颜色。通过调整其他值，您也可以改变纹理颜色。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2008-11-04T17:02:47.693

使用纹理组合器。设置纹理阶段以`GL_MODULATE`在纹理和恒定颜色之间进行操作。`glTexEnv`然后从您的代码 ( , `GL_TEXTURE_ENV_COLOR`) 中更改常量颜色。

就性能而言，这应该是“免费的”。在大多数（如果不是全部）图形芯片上，组合器操作需要相同数量的 GPU 周期（通常为 1），因此仅使用纹理与执行调制操作（或任何其他操作）的成本完全相同。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2011-01-26T08:54:45.393

基本上你有两个选择：使用 glTexEnv 为你的纹理使用 GL_MODULATE 并使用 glColor4* 指定颜色并为 alpha 通道使用非不透明级别。请注意，当您第一次加载纹理时，glTexEnv 应该只发出一次。但是，如果您在顶点属性中指定颜色，这种情况将不起作用。这些将覆盖您可以设置的任何 glColor4* 颜色。在这种情况下，您可能需要使用 2 个选项之一：使用纹理组合器（高级主题，不适合在固定管道中使用），或“手动”更改每个单独顶点的顶点颜色属性（对于更大的网格）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-04-01T07:37:36.277

谢谢大家的想法。我玩过 glColor4f 和 glTexEnv，最后强迫自己仔细阅读 glTexEnv 手册页。手册页说，在 GL_MODULATE 纹理模式下，结果颜色是通过将传入片段乘以纹理颜色 (C=Cf×Ct) 来计算的，对于 alpha 也是如此。我尝试了 glColor4f(1, 1, 1, opacity) 并且没有用，但是将所需的不透明度传递给调用的所有四个参数就可以了。（但仍然不确定为什么。）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-05-21T20:23:16.240

如果您使用的是现代 OpenGL ..

您可以在片段着色器中执行此操作：

```
void main()
{
     color = vec4(1.0f, 1.0f, 1.0f, OPACITY) * texture(u_Texture, TexCoord);
} 
```

这允许您在不中断混合的情况下将不透明度值应用于纹理。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2008-11-03T15:11:10.337

最直接的方法是动态更改纹理的 alpha 值。由于您在某个时候告诉 OpenGL 有关纹理的信息，因此您将在内存中拥有位图。所以只需将纹理重新绑定到相同的纹理 ID。如果内存中没有它（由于空间限制，因为您在 ES 上），您可以使用**glGetTexImage()**再次将纹理检索到缓冲区。这就是干净的解决方案。

不过，保存/检索操作的成本有点高，因此您可能需要另一种解决方案。考虑一下，您可能能够使用几何图形背后的几何图形来显示纹理，或者简单地处理包含纹理的几何图形的材质/颜色。您可能希望对背面几何进行一些附加混合。使用 glBlendFunc

```
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_DST_ALPHA), 
```

您可能能够“轻松”并且 - 更重要的是，更便宜 - 达到预期的效果。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-07-28T06:30:52.887

很可能您正在使用 cg 将图像转换为纹理。当您使用 cg 时，alpha 是预乘的，因此您必须将 alpha 用于 color4f 函数的 rgba。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-05-20T12:49:26.820

我怀疑您的背景是黑色的，因此通过减少每种颜色的数量，您实际上是在将颜色淡化为黑色。

# python - 使用 Python 对 URL 进行切片

> ID：258746
> 
> 赞同：8
> 
> 时间：2008-11-03T14:22:13.430
> 
> 标签：python, url, string

我正在处理大量的 URL。只是一个简单的问题，我试图将 URL 的一部分切掉，见下文：

```
http://www.domainname.com/page?CONTENT_ITEM_ID=1234&param2&param3 
```

我怎么能切出来：

```
http://www.domainname.com/page?CONTENT_ITEM_ID=1234 
```

有时 CONTENT_ITEM_ID 之后有两个以上的参数，并且 ID 每次都不同，我认为可以通过找到第一个 & 然后在 & 之前切掉字符来完成，不太确定如何做到这一点。

干杯

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2008-11-03T16:25:13.090

使用[urlparse](http://docs.python.org/2/library/urlparse.html#urlparse.urlsplit)模块。检查此功能：

```
import urlparse

def process_url(url, keep_params=('CONTENT_ITEM_ID=',)):
    parsed= urlparse.urlsplit(url)
    filtered_query= '&'.join(
        qry_item
        for qry_item in parsed.query.split('&')
        if qry_item.startswith(keep_params))
    return urlparse.urlunsplit(parsed[:3] + (filtered_query,) + parsed[4:]) 
```

在您的示例中：

```
>>> process_url(a)
'http://www.domainname.com/page?CONTENT_ITEM_ID=1234' 
```

如果您决定还需要更多查询参数，或者如果参数的顺序不固定，则此函数具有额外的好处，它更易于使用，如下所示：

```
>>> url='http://www.domainname.com/page?other_value=xx&param3&CONTENT_ITEM_ID=1234&param1'
>>> process_url(url, ('CONTENT_ITEM_ID', 'other_value'))
'http://www.domainname.com/page?other_value=xx&CONTENT_ITEM_ID=1234' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T14:34:34.203

快速而肮脏的解决方案是：

```
>>> "http://something.com/page?CONTENT_ITEM_ID=1234&param3".split("&")[0]
'http://something.com/page?CONTENT_ITEM_ID=1234' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T14:36:06.117

另一种选择是使用 split 函数，将 & 作为参数。这样，您将同时提取基本 url 和两个参数。

```
 url.split("&") 
```

返回一个列表

```
 ['http://www.domainname.com/page?CONTENT_ITEM_ID=1234', 'param2', 'param3'] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T14:33:32.910

我发现下面是我需要做的：

```
url = "http://www.domainname.com/page?CONTENT_ITEM_ID=1234&param2&param3"
url = url[: url.find("&")]
print url
'http://www.domainname.com/page?CONTENT_ITEM_ID=1234' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T15:52:06.730

Parsin URL 从来没有我看起来那么简单，这就是为什么有 urlparse 和 urllib 模块。

例如：

```
import urllib
url ="http://www.domainname.com/page?CONTENT_ITEM_ID=1234&param2&param3"
query = urllib.splitquery(url)
result = "?".join((query[0], query[1].split("&")[0]))
print result
'http://www.domainname.com/page?CONTENT_ITEM_ID=1234' 
```

这仍然不是 100 % 可靠，但比你自己拆分它要多得多，因为有很多你和我不知道的有效 url 格式，有一天会在错误日志中发现。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T14:34:17.633

```
import re
url = 'http://www.domainname.com/page?CONTENT_ITEM_ID=1234&param2&param3'
m = re.search('(.*?)&', url)
print m.group(1) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2008-11-03T14:41:39.197

查看[urllib2 文件名](https://stackoverflow.com/questions/163009/urllib2-file-name)问题以了解有关此主题的一些讨论。

另请参阅“ [Python Find Question](https://stackoverflow.com/questions/229352/python-find-question) ”问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2008-11-03T15:31:04.947

此方法不依赖于参数在 url 字符串中的位置。我敢肯定，这可以改进，但它明白了这一点。

```
url = 'http://www.domainname.com/page?CONTENT_ITEM_ID=1234&param2&param3'
parts = url.split('?')
id = dict(i.split('=') for i in parts[1].split('&'))['CONTENT_ITEM_ID']
new_url = parts[0] + '?CONTENT_ITEM_ID=' + id 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-24T14:43:26.787

一个古老的问题，但我还是想说，查询字符串参数也可以用';'分隔 不仅 '＆'。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2012-07-20T09:39:32.970

除了*urlparse*还有[furl](https://github.com/gruns/furl/)，它有恕我直言更好的 API。

# vb.net - DataGridView 组合框和主键

> ID：258751
> 
> 赞同：1
> 
> 时间：2008-11-03T14:23:11.480
> 
> 标签：vb.net, datagridview

在未绑定的数据网格视图组合框列中处理主键的最佳实践方法是什么？

我想显示一个有意义的值，但只存储主键（很像 Access 组合框）。我通过将具有两个属性的对象而不是纯字符串添加到项目集合中来使用常规组合框来实现此目的。然后我通过将组合框的选定索引值转换回它的对象形式然后检索属性来检索它。这很好用，但我无法使用 datagridview 组合复制该技术，因为我似乎无法访问项目集合。尽管我可以在创建列时正常添加对象，但我似乎只能从网格中检索回字符串值。

希望这是有道理的...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T12:18:43.803

已解决 - 将组合数据源设置为集合类，并以与绑定到数据源时相同的方式使用 ValueMember 和 DisplayMember 属性。工作一种享受。

# sql-server - 在 SQL Server 中转义字符串，以便在 LIKE 表达式中使用它是安全的

> ID：258757
> 
> 赞同：83
> 
> 时间：2008-11-03T14:24:10.633
> 
> 标签：sql-server, tsql, stored-procedures, sql-like

如何在 SQL Server 的存储过程中转义字符串，以便在`LIKE`表达式中安全使用。

假设我有一个`NVARCHAR`像这样的变量：

```
declare @myString NVARCHAR(100); 
```

我想在`LIKE`表达式中使用它：

```
... WHERE ... LIKE '%' + @myString + '%'; 
```

如何在 T-SQL 中转义字符串（更具体地说，是对`LIKE`模式匹配有意义的字符，例如`%`or `?`），以便以这种方式安全使用？

例如，给定：

```
@myString = 'aa%bb' 
```

我想：

```
WHERE ... LIKE '%' + @somehowEscapedMyString + '%' 
```

匹配`'aa%bb'`，`'caa%bbc'`但不是`'aaxbb'`or `'caaxbb'`。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2008-11-03T15:13:30.130

要转义 LIKE 表达式中的特殊字符，请在它们前面加上转义字符。您可以选择与 ESCAPE 关键字一起使用的转义字符。（[MSDN 参考](http://msdn.microsoft.com/en-us/library/ms179859.aspx)）

例如，这转义了 % 符号，使用 \ 作为转义字符：

```
select * from table where myfield like '%15\% off%' ESCAPE '\' 
```

如果您不知道字符串中将包含哪些字符，并且不想将它们视为通配符，则可以在所有通配符前面加上转义字符，例如：

```
set @myString = replace( 
                replace( 
                replace( 
                replace( @myString
                ,    '\', '\\' )
                ,    '%', '\%' )
                ,    '_', '\_' )
                ,    '[', '\[' ) 
```

（请注意，您也必须转义转义字符，并确保这是内部字符，`replace`因此您不会转义从其他`replace`语句中添加的字符）。然后你可以使用这样的东西：

```
select * from table where myfield like '%' + @myString + '%' ESCAPE '\' 
```

还要记住为您的 @myString 变量分配更多空间，因为它会随着字符串替换而变得更长。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-07-24T15:24:06.293

有一个类似的问题（使用 NHibernate，所以 ESCAPE 关键字会非常困难）并使用括号字符解决它。所以你的样本会变成

```
WHERE ... LIKE '%aa[%]bb%' 
```

如果您需要证明：

```
create table test (field nvarchar(100))
go
insert test values ('abcdef%hijklm')
insert test values ('abcdefghijklm')
go
select * from test where field like 'abcdef[%]hijklm'
go 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-02-11T16:56:44.283

鉴于您在模式中使用前导通配符，而不是转义字符串中在模式语法中具有特殊意义的**所有字符，这样做更快更容易。**

```
SELECT * 
FROM YourTable
WHERE CHARINDEX(@myString , YourColumn) > 0 
```

如果您不使用前导通配符，则应避免使用上述方法，因为它不能在`YourColumn`.

此外，在最佳执行计划将根据匹配行数变化的情况下，与 和[关键字](https://dba.stackexchange.com/q/46917/3690)[相比](https://dba.stackexchange.com/a/47206/3690)`LIKE`，使用方括号转义语法时[估计](https://dba.stackexchange.com/a/47206/3690)可能会更好。[`CHARINDEX`](https://dba.stackexchange.com/q/46917/3690)[`ESCAPE`](https://dba.stackexchange.com/a/47206/3690)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2008-11-03T14:26:39.990

您指定转义字符。此处的文档：http:
[//msdn.microsoft.com/en-us/library/ms179859.aspx](http://msdn.microsoft.com/en-us/library/ms179859.aspx)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-03T14:35:39.347

是否要查找包含转义字符的字符串？例如你想要这个：

```
select * from table where myfield like '%10%%'. 
```

您想在哪里搜索 10% 的所有字段？如果是这种情况，那么您可以使用 ESCAPE 子句来指定转义字符并转义通配符。

```
select * from table where myfield like '%10!%%' ESCAPE '!' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-07-07T15:39:46.807

替代转义语法：

> [LIKE 通配符文字](https://docs.microsoft.com/en-us/sql/connect/jdbc/using-sql-escape-sequences?view=sql-server-2017)
> 
> JDBC 驱动程序支持使用 LIKE 子句通配符作为文字的**{escape 'escape character'}语法。**

```
SELECT *
FROM tab
WHERE col LIKE 'a\_c' {escape '\'}; 
```

**[db<>小提琴演示](https://dbfiddle.uk/?rdbms=sqlserver_2017&fiddle=e4080bf5917b482e809013444f1fc40b)**

# c# - 以人类可读的文本格式序列化

> ID：258762
> 
> 赞同：5
> 
> 时间：2008-11-03T14:25:02.443
> 
> 标签：c#, .net, serialization, .net-2.0

.NET 2.0 (C#) 中是否有一种方法可以像使用 XmlSerializer 以简单/可定制的人类可读格式（例如看起来像[PXLS](http://community.moertel.com/pxsl/)或 JSON）一样序列化对象？我也知道 XML 是人类可读的，我正在寻找一些冗余较少的东西，你可以输出到控制台作为用户的结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T14:51:49.190

要在 .NET 中序列化为 JSON，请执行以下操作：

```
public static string ToJson(IEnumerable collection)
        {
            DataContractJsonSerializer ser = new DataContractJsonSerializer(collection.GetType());
            string json;
            using (MemoryStream m = new MemoryStream())
            {
                XmlDictionaryWriter writer = JsonReaderWriterFactory.CreateJsonWriter(m);
                ser.WriteObject(m, collection);
                writer.Flush();

                json = Encoding.Default.GetString(m.ToArray());
            }
            return json;
        } 
```

集合项需要具有“DataContract”属性，并且您希望序列化为 JSON 的每个成员都必须具有“DataMember”属性。

这可能仅适用于 .NET 3.5。但也有一个同样简单的 2.0 版本......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2010-03-31T16:00:24.200

我在这里找到了一份详尽的文档：

[http://pietschsoft.com/post/2008/02/NET-35-JSON-Serialization-using-the-DataContractJsonSerializer.aspx](http://pietschsoft.com/post/2008/02/NET-35-JSON-Serialization-using-the-DataContractJsonSerializer.aspx)

使用这个有用的类（支持泛型）

```
using System.Runtime.Serialization;
using System.Runtime.Serialization.Json;

public class JSONHelper
{
  public static string Serialize<T>(T obj)
  {
      DataContractJsonSerializer serializer = new DataContractJsonSerializer(obj.GetType());
      MemoryStream ms = new MemoryStream();
      serializer.WriteObject(ms, obj);
      string retVal = Encoding.Default.GetString(ms.ToArray());
      ms.Dispose();
      return retVal;
  }

  public static T Deserialize<T>(string json)
  {
      T obj = Activator.CreateInstance<T>();
      MemoryStream ms = new MemoryStream(Encoding.Unicode.GetBytes(json));
      DataContractJsonSerializer serializer = new DataContractJsonSerializer(obj.GetType());
      obj = (T)serializer.ReadObject(ms);
      ms.Close();
      ms.Dispose();
      return obj;
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-03T14:36:31.390

.Net 的内置序列化选项是 Xml、Xml-Soap 和二进制。由于您已经排除了 xml 并且二进制文件绝对不是人类可读的，因此您必须自己动手。

当你自己滚动时，你有几个选择：

*   向类添加实用程序或扩展方法，如建议的 AviewAnew
*   扩展 System.Runtime.Serialization.Formatter / 实现 System.Runtime.Serialization.IFormatter
*   通过 google 在线查找通用组件，它可以满足您的需求。

请注意，第二项可以专门用于您的特定类（如果您不希望它不必能够处理任何类），后两项不是互斥的。

我过去曾搜索过 .Net JSON 格式化程序，而且肯定有多种选择。然而，那次我最终走向了不同的方向。我只是对他们中的任何一个都没有信心。也许其他人可以提供更具体的建议。JSON 变得足够大，希望微软很快会在框架中包含对它的“本机”支持。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-07-23T05:25:00.387

[https://stackoverflow.com/a/38538454/6627992](https://stackoverflow.com/a/38538454/6627992)

您可以使用以下标准方法来获取格式化的 Json

*JsonReaderWriterFactory.CreateJsonWriter（流流，编码编码，bool ownsStream，bool indent，string indentChars）*

只设置*“缩进==真”*

尝试这样的事情

```
 public readonly DataContractJsonSerializerSettings Settings = 
            new DataContractJsonSerializerSettings
            { UseSimpleDictionaryFormat = true };

    public void Keep<TValue>(TValue item, string path)
    {
        try
        {
            using (var stream = File.Open(path, FileMode.Create))
            {
                var currentCulture = Thread.CurrentThread.CurrentCulture;
                Thread.CurrentThread.CurrentCulture = CultureInfo.InvariantCulture;

                try
                {
                    using (var writer = JsonReaderWriterFactory.CreateJsonWriter(
                        stream, Encoding.UTF8, true, true, "  "))
                    {
                        var serializer = new DataContractJsonSerializer(type, Settings);
                        serializer.WriteObject(writer, item);
                        writer.Flush();
                    }
                }
                catch (Exception exception)
                {
                    Debug.WriteLine(exception.ToString());
                }
                finally
                {
                    Thread.CurrentThread.CurrentCulture = currentCulture;
                }
            }
        }
        catch (Exception exception)
        {
            Debug.WriteLine(exception.ToString());
        }
    } 
```

注意线条

```
 var currentCulture = Thread.CurrentThread.CurrentCulture;
    Thread.CurrentThread.CurrentCulture = CultureInfo.InvariantCulture;
    ....
    Thread.CurrentThread.CurrentCulture = currentCulture; 
```

您应该使用*InvariantCulture*以避免在具有不同区域设置的计算机上反序列化期间出现异常。例如，*双*精度或*日期*时间的无效格式有时会导致它们。

用于反序列化

```
 public TValue Revive<TValue>(string path, params object[] constructorArgs)
    {
        try
        {
            using (var stream = File.OpenRead(path))
            {
                var currentCulture = Thread.CurrentThread.CurrentCulture;
                Thread.CurrentThread.CurrentCulture = CultureInfo.InvariantCulture;

                try
                {
                    var serializer = new DataContractJsonSerializer(type, Settings);
                    var item = (TValue) serializer.ReadObject(stream);
                    if (Equals(item, null)) throw new Exception();
                    return item;
                }
                catch (Exception exception)
                {
                    Debug.WriteLine(exception.ToString());
                    return (TValue) Activator.CreateInstance(type, constructorArgs);
                }
                finally
                {
                    Thread.CurrentThread.CurrentCulture = currentCulture;
                }
            }
        }
        catch
        {
            return (TValue) Activator.CreateInstance(typeof (TValue), constructorArgs);
        }
    } 
```

谢谢！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-21T14:38:58.500

将 xsl 应用到您的 xml 以去除您不想看到的内容？

就像是

```
<?xml version="1.0"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
<xsl:output method="text" indent="yes"/>
  <xsl:template match="*">
      <xsl:value-of select="name()" /><xsl:text>
</xsl:text>
      <xsl:apply-templates select="@*"/>
<xsl:apply-templates select="*"/>
  </xsl:template>
  <xsl:template match="@*|text()|comment()|processing-instruction">
   <xsl:value-of select="name()" />:<xsl:value-of select="." /><xsl:text>
</xsl:text>
  </xsl:template>
</xsl:stylesheet> 
```

# python - Django：在不删除模型的情况下覆盖 AutoField 的详细名称

> ID：258767
> 
> 赞同：3
> 
> 时间：2008-11-03T14:27:08.007
> 
> 标签：python, django

我正在使用Django**的 0.97-pre-SVN-unknown**版本。

我有一个模型，我没有给出任何primary_key。因此，Django 自动提供了一个名为“id”的 AutoField。一切都很好。但是现在，我必须将该 AutoField 的“verbose_name”更改为“id”以外的其他内容。我不能以通常的方式覆盖“id”字段，因为这需要删除/重置整个模型及其数据（这绝对不是一个选项）。我找不到其他方法。我想要的甚至可能实现吗？如果您可以提出任何替代方案，让我在不必放弃模型/表格的情况下获得我想要的东西，我会很高兴。

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T15:57:31.790

嗯...在模型定义中显式写入*id*字段呢？像这样的例子：

```
class Entry(models.Model):
   id = models.AutoField(verbose_name="custom name")
   # and other fields... 
```

它不需要任何底层数据库更改。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T15:42:03.333

查看`manage.py`;的命令行选项 有一个命令可以将所有模型数据转储到 JSON，另一个命令可以从 JSON 加载回来。您可以导出所有模型数据，将新字段添加到模型中，然后重新导入数据。只需确保将`db_column`选项设置为，`'id'`以免破坏现有数据。

**编辑**：具体来说，您需要命令[`dumpdata`](http://docs.djangoproject.com/en/dev/ref/django-admin/#dumpdata)和[`loaddata`](http://docs.djangoproject.com/en/dev/ref/django-admin/#loaddata-fixture-fixture).

# html - 列表中的 IE6 项目符号

> ID：258769
> 
> 赞同：2
> 
> 时间：2008-11-03T14:27:16.353
> 
> 标签：html, css, internet-explorer-6

我的链接在这里：

[示例页面](http://tinyurl.com/5kr4ra)

我正在使用 list-style-image: 给我的水平列表（非常顶部和底部）分隔符。我有一类 .first 从每个列表中的第一个 li 中删除图像。

瞧，在 IE6 中，它不起作用。发生的情况是没有显示项目符号图像，并且文本的底部几个像素似乎被裁剪。

[截屏](http://tinyurl.com/66hcso)

我已经修复了这个页面的一些“haslayout”错误，但我感觉它与我的规则层次结构有关，尽管没有多少黑客攻击似乎对我有用。

有人可以对此有所了解吗？谢谢。

此外，我的颜色更改适用于悬停，但不是下划线，在同一个选择器中？

**编辑**好的，我使用了 yoavf 建议的背景图像技术，这似乎可以解决问题，但裁剪问题仍然存在。看起来像一个单独的问题然后......

这是我修改后的 CSS

```
#site-navigation li {
    background-image:url(../img/site-nav-seperator.gif);
    background-position:0 4px;
    background-repeat:no-repeat;
    float:left;
    padding-left:15px;
}
#site-navigation li.first {
    background-image:none;

} 
```

**进一步编辑：**

通过给 a 标签一些行高，也设法修复了裁剪。

```
#site-navigation a {
    color:#666666;
    display: block;
    text-decoration:none;
    margin-right: 1em;
    line-height: 1.1em;
} 
```

不过，这有点像一个障碍:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2008-11-03T14:45:45.863

我知道这并不是真正的解决方案，但我建议使用**background-image**而不是**list-style image**。您将获得相同的效果，并且它适用于所有浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T14:49:49.100

看起来像站点导航中对象的边距和填充有问题。

如果您展示了这些元素的 CSS，我们可以更快地检查它:)

# python - How to find out if a lazy relation isn't loaded yet, with SQLAlchemy?

> ID：258775
> 
> 赞同：16
> 
> 时间：2008-11-03T14:28:03.170
> 
> 标签：python, sqlalchemy

With SQLAlchemy, is there a way to know beforehand whether a relation would be lazy-loaded?
For example, given a lazy parent->children relation and an instance X of "parent", I'd like to know if "X.children" is already loaded, without triggering the query.

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2014-07-29T09:05:24.683

You can get a list of all unloaded properties (both relations and columns) from `sqlalchemy.orm.attributes.instance_state(obj).unloaded`.

See: [Completing object with its relations and avoiding unnecessary queries in sqlalchemy](https://stackoverflow.com/questions/5795492/completing-object-with-its-relations-and-avoiding-unnecessary-queries-in-sqlalch)

An easier way is to use `inspect()`, which gives the same results:

```
from sqlalchemy import inspect
from sqlalchemy.orm import lazyload

user = session.query(User).options(lazyload(User.articles)).first()
ins = inspect(user)

ins.unloaded  # <- set or properties that are not yet loaded 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-04T07:48:26.470

I think you could look at the child's `__dict__` attribute dictionary to check if the data is already there or not.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T10:34:28.860

Slightly neater than Haes answer (though it effectively does the same thing) is to use hasattr(), as in:

```
>>> hasattr(X, 'children')
False 
```

# javascript - 持续集成期间js的最佳打包策略？

> ID：258781
> 
> 赞同：3
> 
> 时间：2008-11-03T14:29:53.867
> 
> 标签：javascript, deployment, continuous-integration, minify

我需要打包我所有的 js，但需要将其编辑到源代码管理中。

是否有一个用于 ccnet 或 nant 的简单易用的插件，它可以让我打包我的 js，并在生产时将它们存储在相同的文件中。

不是真的在寻找文件组合，只是缩小每个文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T16:43:57.937

这是我找到的最佳答案。它调用 YUI 版本的 minify 并使用普通的旧 Nant 来执行此操作，并将现有的 js 文件替换为缩小后的文件。

[http://codeclimber.net.nz/archive/2007/08/22/How-to-use-YUI-JS-Compressor-inside-a-NAnt-build.aspx](http://codeclimber.net.nz/archive/2007/08/22/How-to-use-YUI-JS-Compressor-inside-a-NAnt-build.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T14:35:16.103

我根据这个构建了自己的 Nant 任务。

[http://www.nabble.com/Re:-All-.js-files-into-1-p19593677.html](http://www.nabble.com/Re:-All-.js-files-into-1-p19593677.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-06T16:18:22.790

我在后期构建脚本中使用复制连接和 YUI 压缩器。老式的批处理文件样式。

[压缩机](http://www.julienlecomte.net/yuicompressor/README)就像一个魅力。我的 .NET 网站应用程序使用网站部署项目，由 TeamCity 持续构建。也许有点骇人听闻，但它确实有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-12-10T03:21:33.270

我为此编写了自己的自定义工具，它是运行时的一部分，但可以很容易地更改为在持续集成过程中工作。它使用谷歌的闭包编译器。看看这个：

[http://www.picnet.com.au/blogs/Guido/post/2009/12/10/Javascript-runtime-compilation-using-AspNet-and-Googles-Closure-Compiler.aspx](http://www.picnet.com.au/blogs/Guido/post/2009/12/10/Javascript-runtime-compilation-using-AspNet-and-Googles-Closure-Compiler.aspx)

谢谢

圭多

# c# - 如何将月份名称（字符串）解析为整数以在 C# 中进行比较？

> ID：258793
> 
> 赞同：99
> 
> 时间：2008-11-03T14:33:08.260
> 
> 标签：c#, parsing, integer, compare

我需要能够比较数组中的一些月份名称。

如果有一些直接的方式，那就太好了：

```
Month.toInt("January") > Month.toInt("May") 
```

我的谷歌搜索似乎表明唯一的方法是编写自己的方法，但这似乎是一个很常见的问题，我认为它已经在 .Net 中实现了，以前有人这样做过吗？

* * *

## 回答 #1

> 赞同：189
> 
> 时间：2008-11-03T14:40:18.793

`DateTime.ParseExact(monthName, "MMMM", CultureInfo.CurrentCulture ).Month`

虽然，出于您的目的，您最好只创建`Dictionary<string, int>`月份名称与其值的映射。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2008-11-03T14:42:23.530

你可以这样做：

```
Convert.ToDate(month + " 01, 1900").Month 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2008-11-03T14:58:58.943

如果你使用`DateTime.ParseExact()`几个人建议的 - 方法，你应该仔细考虑当应用程序在非英语环境中运行时你想要发生什么！

在丹麦，哪些`ParseExact("Januar", ...)`应该`ParseExact("January", ...)`有效，哪些应该失败？

`CultureInfo.CurrentCulture`这将是和之间的区别`CultureInfo.InvariantCulture`。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-05-06T23:48:51.610

一个简单的解决方案是创建一个包含名称和值的字典。然后使用 Contains() 可以找到正确的值。

```
Dictionary<string, string> months = new Dictionary<string, string>()
{
                { "january", "01"},
                { "february", "02"},
                { "march", "03"},
                { "april", "04"},
                { "may", "05"},
                { "june", "06"},
                { "july", "07"},
                { "august", "08"},
                { "september", "09"},
                { "october", "10"},
                { "november", "11"},
                { "december", "12"},
};
foreach (var month in months)
{
    if (StringThatContainsMonth.ToLower().Contains(month.Key))
    {
        string thisMonth = month.Value;
    }
} 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2008-11-03T14:43:48.893

您可以使用 DateTime.Parse 方法获取 DateTime 对象，然后检查其 Month 属性。做这样的事情：

```
int month = DateTime.Parse("1." + monthName + " 2008").Month; 
```

诀窍是建立一个有效的日期来创建一个 DateTime 对象。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2008-11-03T14:47:04.597

您可以使用几个月的枚举：

```
public enum Month
{
    January,
    February,
    // (...)
    December,
}    

public Month ToInt(Month Input)
{
    return (int)Enum.Parse(typeof(Month), Input, true));
} 
```

不过，我不是 100% 确定 enum.Parse() 的语法。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2012-09-22T20:32:45.533

您不必创建 DateTime 实例来执行此操作。就这么简单：

```
public static class Month
{
    public static int ToInt(this string month)
    {
        return Array.IndexOf(
            CultureInfo.CurrentCulture.DateTimeFormat.MonthNames,
            month.ToLower(CultureInfo.CurrentCulture))
            + 1;
    }
} 
```

我在`da-DK`文化上运行，所以这个单元测试通过了：

```
[Theory]
[InlineData("Januar", 1)]
[InlineData("Februar", 2)]
[InlineData("Marts", 3)]
[InlineData("April", 4)]
[InlineData("Maj", 5)]
[InlineData("Juni", 6)]
[InlineData("Juli", 7)]
[InlineData("August", 8)]
[InlineData("September", 9)]
[InlineData("Oktober", 10)]
[InlineData("November", 11)]
[InlineData("December", 12)]
public void Test(string monthName, int expected)
{
    var actual = monthName.ToInt();
    Assert.Equal(expected, actual);
} 
```

我将把它作为练习留给读者创建一个重载，您可以在其中传递一个显式的 CultureInfo。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-06-11T02:22:28.827

在提出问题七年后回答这个问题，可以使用内置方法进行比较：

```
Month.toInt("January") > Month.toInt("May") 
```

变成

```
Array.FindIndex( CultureInfo.CurrentCulture.DateTimeFormat.MonthNames,
                 t => t.Equals("January", StringComparison.CurrentCultureIgnoreCase)) >
Array.FindIndex( CultureInfo.CurrentCulture.DateTimeFormat.MonthNames,
                 t => t.Equals("May", StringComparison.CurrentCultureIgnoreCase)) 
```

为简单起见，可以将其重构为扩展方法。以下是一个 LINQPad 示例（因此`Dump()`方法调用）：

```
void Main()
{
    ("January".GetMonthIndex() > "May".GetMonthIndex()).Dump();
    ("January".GetMonthIndex() == "january".GetMonthIndex()).Dump();
    ("January".GetMonthIndex() < "May".GetMonthIndex()).Dump();
}

public static class Extension {
    public static int GetMonthIndex(this string month) {
        return Array.FindIndex( CultureInfo.CurrentCulture.DateTimeFormat.MonthNames,
                         t => t.Equals(month, StringComparison.CurrentCultureIgnoreCase));
    }
} 
```

带输出：

```
False
True
True 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2008-11-03T14:36:35.243

如果您使用的是 c# 3.0（或更高版本），您可以使用扩展程序

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-11-09T10:28:17.913

```
Public Function returnMonthNumber(ByVal monthName As String) As Integer
    Select Case monthName.ToLower
        Case Is = "january"
            Return 1
        Case Is = "february"
            Return 2
        Case Is = "march"
            Return 3
        Case Is = "april"
            Return 4
        Case Is = "may"
            Return 5
        Case Is = "june"
            Return 6
        Case Is = "july"
            Return 7
        Case Is = "august"
            Return 8
        Case Is = "september"
            Return 9
        Case Is = "october"
            Return 10
        Case Is = "november"
            Return 11
        Case Is = "december"
            Return 12
        Case Else
            Return 0
    End Select
End Function 
```

警告代码为 Beta 版本。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-04-23T16:38:01.373

我将它翻译成西班牙语版本的 C# 代码，问候：

```
public string ObtenerNumeroMes(string NombreMes){

       string NumeroMes;   

       switch(NombreMes) {

        case ("ENERO") :
            NumeroMes = "01";
            return NumeroMes;

        case ("FEBRERO") :
            NumeroMes = "02";
            return NumeroMes;

        case ("MARZO") :
            NumeroMes = "03";
            return NumeroMes;

        case ("ABRIL") :
            NumeroMes = "04";
            return NumeroMes;

        case ("MAYO") :
            NumeroMes = "05";
            return NumeroMes;

        case ("JUNIO") :
            NumeroMes = "06";
            return NumeroMes;

        case ("JULIO") :
            NumeroMes = "07";
            return NumeroMes;

        case ("AGOSTO") :
            NumeroMes = "08";
            return NumeroMes;

        case ("SEPTIEMBRE") :
            NumeroMes = "09";
            return NumeroMes;

        case ("OCTUBRE") :
            NumeroMes = "10";
            return NumeroMes;

        case ("NOVIEMBRE") :
            NumeroMes = "11";
            return NumeroMes;

        case ("DICIEMBRE") :
            NumeroMes = "12";
            return NumeroMes;

            default:
            Console.WriteLine("Error");
            return "ERROR";

        }

   } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2012-09-07T05:58:41.947

我所做的是使用 SimpleDateFormat 创建格式字符串，并将文本解析为日期，然后从中检索月份。代码如下：

```
int year = 2012 \\or any other year
String monthName = "January" \\or any other month
SimpleDateFormat format = new SimpleDateFormat("dd-MMM-yyyy");
int monthNumber = format.parse("01-" + monthName + "-" + year).getMonth(); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-11-06T07:53:13.770

此代码可以帮助您...

```
using System.Globalization;

....

string FullMonthName = CultureInfo.CurrentCulture.DateTimeFormat.GetMonthName(DateTime.UtcNow.Month); 
```

GetMonthName 方法 - 它返回字符串...

如果您想将月份作为整数，则只需使用 -

```
DateTime dt= DateTime.UtcNow;
int month= dt.Month; 
```

希望对你有帮助！！！

谢谢！！！

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-06-03T12:35:40.407

```
int selectedValue = 0;
            switch (curentMonth)
            {
                case "January":
                    selectedValue = 1;
                    break;
                case "February":
                    selectedValue = 2;
                    break;
            }
            if (selectedValue != 0)
            {
               /* var list= db.model_name.Where(x => x.column== selectedValue);
                return list; */
            }
            return Ok(selectedValue); 
```

# c# - 消除依赖的技术？

> ID：258795
> 
> 赞同：2
> 
> 时间：2008-11-03T14:33:15.733
> 
> 标签：c#, class, dependencies

设想：

在 A 类中引发了一个**事件**，需要由 B 类中的**方法**处理。（当前通过委托）

从**事件**传递到**方法**的数据当前包装在 C 类中。
这显然需要 B 类依赖于 C 类。

我可以执行任何技术/重构来消除这种依赖关系吗？
*例如，将数据展开回简单的原始数据类型并直接传递它们。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T14:37:20.140

展开到原语会起作用，但请确定您确实确实想要删除这种依赖关系。如果 C 是它们之间的桥梁，或者如果 C 提供它们两者，等等，那么类 A 和 B 都依赖于 C 是完全有效的。

展开到原语会删除编译依赖项，但不会删除数据依赖项，并且实际上可能通过删除逻辑上需要的实体（C 类）来“反规范化”设计

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T14:46:49.823

我同意 Steven Lowe 的观点；依赖关系可能是有效的。我可以提供的唯一选择是依赖接口而不是实际的类，但它几乎可以归结为同一件事。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T15:06:25.260

正如大多数其他人所说，对 C 的依赖可能是有效的。

但是，如果依赖 C 给你带来了问题，那可能是因为 C 太复杂或者依赖太多。

如果在事件中传递了类 C，它可能应该是一个没有自身依赖关系的 POCO 类，因此您可能需要考虑对其进行重构。

如果 C 有自己的复杂方法，那么很可能它们实际上属于 A 类。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T15:14:29.707

您是否看过像[Structuremap](http://structuremap.sourceforge.net/Default.htm)这样的依赖注入框架来至少集中这些依赖并使其可配置？我没有尝试使用事件/委托类型，但如果您在图层周围传递大量自定义类型/接口，它是一个很好的工具。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2008-11-03T14:37:15.040

您可以序列化为 XML，然后通过 XPATH 直接读取 XML（无需反序列化）

# ruby-on-rails - 可移植的 Ruby on Rails 环境

> ID：258801
> 
> 赞同：5
> 
> 时间：2008-11-03T14:34:35.840
> 
> 标签：ruby-on-rails, ruby, usb-drive, portable-applications

我给自己买了一个新的 8 gig USB 密钥，我正在寻找一个体面的解决方案来拥有一个可移植的 RoR 环境来学习。我在上面做了谷歌，发现了一些可能性，但我很想听到一些真实的生活经历和意见。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T14:50:02.923

我喜欢[InstantRails](http://instantrails.rubyforge.org)，非常易于使用，无需安装程序，并且不会修改您的系统环境。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-10T21:57:52.760

InstantRails 在 2007 年被 [BitNami RubyStack] 取代。

[http://bitnami.org/stack/rubystack](http://bitnami.org/stack/rubystack)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-05-30T23:35:07.353

如何基于 RubyInstaller 的二进制文件和开发工具包创建可移植环境：

[http://hcettech.blogspot.pt/2012/05/windows-portable-rails-development.html](http://hcettech.blogspot.pt/2012/05/windows-portable-rails-development.html)

相关：[适用于 Windows 的便携式 Ruby on Rails 环境](https://stackoverflow.com/questions/4388288/portable-ruby-on-rails-environment-for-windows/10825835#10825835)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T15:55:13.353

设置[Cygwin 的便携式安装](http://www.dam.brown.edu/people/sezer/software/cygwin/)将是一个不错的选择。

您将拥有一个完整的 *nix 环境，这将为您提供无限可能。您可以轻松拥有 Ruby、Rails、Mongrel（或任何选择的服务器）以及一个非常好的编辑器供您使用。我会推荐带有这个[Rails 特定 VIM 配置](http://github.com/srmoon7/vim/commits/master)的 VIM （很棒的外观和感觉！）。

我目前有一个类似的设置在跳跃驱动器上运行 Cygwin。我主要将它用于 bash shell、VIM，并使用 tail 以漂亮的颜色编码语法来监视开发日志文件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T14:58:22.170

我找到了这个，我打算今晚试一试： [Flash Rails](http://rubyforge.org/projects/flashrails)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-03T21:40:55.510

假设您使用的是 Windows，我会选择[Instant Rails](http://instantrails.rubyforge.org/)和[Netbeans](http://www.netbeans.org/)（带有用于 Netbeans 的 JVM）。

Netbeans 有点重量级，但它支持许多以 Rails 为中心的优秀 IDE 功能，并且是 Windows IMO 上 Rails 的最佳 IDE。

您将在不到 1 场演出中获得所有这些。

# sql-server - SQL Server 查询使用不同排序规则的两个链接数据库

> ID：258807
> 
> 赞同：3
> 
> 时间：2008-11-03T14:35:37.710
> 
> 标签：sql-server, linked-server

作为查询的一部分，我有 2 个远程数据库

```
select p.ID,p.ProjectCode_VC,p.Name_VC,v.*
FROM [serverB].Projects.dbo.Projects_T p
LEFT JOIN [serverA].SOCON.dbo.vw_PROJECT v on
p.ProjectCode_VC = v.PROJ_CODE 
```

问题是 serverA 使用排序`Latin1_General_BIN`规则，而 serverB 使用`Latin1_General_CP1_CP_AS`并且查询拒绝运行。

两台服务器都是 SQL 2000 服务器。这两个数据库都是一成不变的，所以很遗憾，我无法更改它们的排序规则。

无论如何，你们知道如何让它工作吗？

**更新：** 我找到了另一种解决方案。在链接服务器属性中，您可以在那里指定链接服务器的排序规则。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2008-11-03T14:47:31.243

只需将排序规则添加到您的选择中，例如：

```
select 
  p.ID,
  p.ProjectCode_VC,
  p.Name_VC,
  v.* 
FROM
  [serverB].Projects.dbo.Projects_T p 
  LEFT JOIN [serverA].SOCON.dbo.vw_PROJECT v on p.ProjectCode_VC 
    collate Latin1_General_Bin = v.PROJ_CODE 
```

或相反。因此，将其中一个排序规则“转换”为另一个排序规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-11-08T02:28:02.377

或者您可以使用更通用的查询，如下所示：

```
select * from profile, userinfo
where profile.custid collate database_default = userinfo.custid collate database_default 
```

# silverlight - 是否可以通过 JavaScript 在 Silverlight XAP 文件中显示/隐藏用户控件？

> ID：258812
> 
> 赞同：0
> 
> 时间：2008-11-03T14:36:27.520
> 
> 标签：silverlight

我创建了一个 Silverlight 项目，该项目生成 [something].xap 文件以打包一些 silverlight UserControl。我想通过在浏览器中使用 javascript 来操作该 .xap 文件，以显示和隐藏基于 java 脚本事件的用户控件。

是否有可能做到这一点？

如果是这样，任何样本都可以或文档链接将不胜感激。

提前致谢

凯文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T16:19:58.640

这是我的解决方案...不确定它是否是“最佳实践”方式...评论？？？？

在我的 Silverlight 应用程序的 App 类中，我有以下代码：

```
 private Page _page = null;
    private void Application_Startup(object sender, StartupEventArgs e)
    {
        _page = new Page();
        this.RootVisual = _page;

        HtmlPage.RegisterScriptableObject("App", this);
    } 
```

我还在 App 类中添加了一个 [ScriptableMember] 以从 JavaScript 调用

```
 [ScriptableMember]
    public void ShowTeamSearch(Guid ctxId, Guid teamId)
    {
        _page.ShowTeamSearcher(ctxId, teamId);
    } 
```

Page 类是在 Silverlight Control 项目中创建的默认类，它实际上没有任何 UI 或逻辑，它只是用于换入/换出视图。

```
 Login oLogin;
    TeamSearcher oSearcher;

    public Page()
    {
        InitializeComponent();
        oLogin = new Login();
        oSearcher = new TeamSearcher();

        oLogin.Visibility = Visibility;
        this.LayoutRoot.Children.Add(oLogin);
    } 
```

还添加了一种方法来显示/隐藏视图...这可能/可能会通过动画等变得更高级/更强大...但这显示了基本思想：

```
 public void ShowTeamSearcher(Guid ctxId, Guid teamId)
    {
        oSearcher.UserTeamId = teamId;
        oSearcher.UserContextId = ctxId;

        LayoutRoot.Children.Remove(oLogin);
        LayoutRoot.Children.Add(oSearcher);
    } 
```

然后在将 oXaml 的 id 分配给 silverlight 主机的实例之后在 JavaScript 中调用它。

```
 var slControl = document.getElementById('oXaml');
    slControl.Content.App.ShowTeamSearch(sessionId, teamId); 
```

这似乎可行，并不是一个糟糕的解决方案，但可能有更好的......想法？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T15:10:53.880

这是我为这个主题收集的链接。

*   [与 Silverlight 2.0 的 Javascript 通信](http://weblogs.asp.net/albertpascual/archive/2008/08/13/javascript-communication-to-silverlight-2-0.aspx)
*   [Silverlight 互操作性](http://www.wilcob.com/Wilco/Articles/silverlight-interoperability.aspx)
*   [Silverlight 和 JavaScript 互操作基础知识](http://pietschsoft.com/post/2008/06/Silverlight-and-JavaScript-Interop-Basics.aspx)

# wpf - WPF - 将 IsMouseOver 绑定到可见性

> ID：258824
> 
> 赞同：3
> 
> 时间：2008-11-03T14:39:44.863
> 
> 标签：wpf, data-binding

我有一个覆盖`RadioButton`'s`ControlTemplate`以在其中显示自定义控件的窗口。在自定义控件中，我将按钮的可见性绑定到`IsMouseOver`，仅当鼠标悬停在控件上时才能正常显示按钮。但是，当我单击 时`RadioButton`，`Button`消失了。经过一些调试和阅读，似乎`RadioButton`是在单击时捕获鼠标，这是`IsMouseOver`错误的`UserControl`。

`Button`我尝试将' 的可见性绑定到它并且它可以工作，但对我来说依赖于谁来包含它`FindAncestor {x:Type RadioButton}`似乎有点脆弱。`UserControl`窗口和用户控件的代码如下。有什么建议么？

```
<Window x:Name="window" x:Class="WPFTest.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:WPFTest="clr-namespace:WPFTest"
    Title="Window1" Height="300" Width="300">
    <Window.Resources>
        <Style TargetType="{x:Type RadioButton}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RadioButton}">
                        <WPFTest:TestUC />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Border BorderBrush="Black" BorderThickness="2">
        <StackPanel>
            <RadioButton x:Name="OptionButton" Height="100" />
            <TextBlock Text="{Binding ElementName=OptionButton, Path=IsMouseOver}" />
        </StackPanel>
    </Border>
</Window>

<UserControl x:Name="_this" x:Class="WPFTest.TestUC"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="300" Width="300">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    </UserControl.Resources>
    <StackPanel>
        <TextBlock Text="SomeText" />
        <TextBlock Text="{Binding ElementName=_this, Path=IsMouseOver}" />
        <Button x:Name="_cancelTextBlock" Content="Cancel" Visibility="{Binding ElementName=_this, Path=IsMouseOver, Converter={StaticResource BooleanToVisibilityConverter}}" />
    </StackPanel>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T15:09:26.660

我似乎通过在控件模板中设置触发器来解决问题，该触发器绑定到 RadioButton 的 IsMouseOver，并在 UserControl 上设置自定义 DependencyProperty。

就像是：

```
<ControlTemplate TargetType="{x:Type RadioButton}">
    <WPFTest:TestUC x:Name="UC" />
    <ControlTemplate.Triggers>
        <Trigger Property="IsMouseOver" Value="True">
            <Setter Property="ShowCancel" Value="True" TargetName="UC"/>
        </Trigger>
    </ControlTemplate.Triggers>
</ControlTemplate> 
```

但是，我仍然对为什么 Mouse Capture 会在 RadioButton 的 UserControl 子项上伪造 IsMouseOver 感到困惑。任何人都可以对此有所了解吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-12-18T05:43:12.117

事件由 RadioButton 处理后，它仅*设置*为已处理，但实际上它仍然冒泡。所以你只需要指定你也想处理已处理的事件。

为此，您需要查看[handledEventsToo](http://www.google.ro/search?hl=ro&client=firefox-a&rls=org.mozilla%3Aen-US%3Aofficial&hs=xUW&q=handledEventsToo&btnG=C%C4%83utare&meta=)。

不幸的是，我认为它不能在 xaml 中设置。只有代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T16:30:16.543

非常有趣的问题。我自己想更多地了解为什么当鼠标按下其视觉效果中的 TextBlock(s) 时 UserControl IsMouseOver 变为 false 的原因。

但是，这是解决它的另一种方法……也许您会更喜欢这种方法。

**而不是使用 RadioButton（因为您正在重新模板化它）为什么不使用 Control 呢？**（我认为 IsMouseOver 正在更改为 false，因为它是一个 Button 派生控件。）

以下是 Window 的 xaml ...

```
<Window
    x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication1"
    Title="Window1"
    Width="300"
    Height="300"
>
    <Window.Resources>
        <Style TargetType="{x:Type Control}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Control}">
                        <local:UserControl1/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Border BorderBrush="Black" BorderThickness="2">
        <StackPanel>
            <Control x:Name="OptionButton" Height="100"/>
            <TextBlock Text="{Binding ElementName=OptionButton, Path=IsMouseOver}"/>
        </StackPanel>
    </Border>
</Window> 
```

### 编辑：

我只是想补充一点……如果您对上述方法没意见……那么，正确的做法可能是只使用 Window 的可视化树中的 UserControl 而不是重新模板化 Control。所以......像这样：

```
<Window
    x:Class="WpfApplication1.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:WpfApplication1"
    Title="Window1"
    Width="300"
    Height="300"
>
    <Border BorderBrush="Black" BorderThickness="2">
        <StackPanel>
            <local:UserControl1 x:Name="OptionButton" Height="100"/>
            <TextBlock Text="{Binding ElementName=OptionButton, Path=IsMouseOver}"/>
        </StackPanel>
    </Border>
</Window> 
```

# linq - 我应该如何开始学习 ADO.NET Entity Framework？

> ID：258840
> 
> 赞同：14
> 
> 时间：2008-11-03T14:44:45.617
> 
> 标签：linq, linq-to-sql, entity-framework, ado.net

所以在这里我正要开始一个使用 LINQ to SQL 的大项目，然后我读到了这个：

[LINQ to SQL 真的死了吗？](http://www.infoq.com/news/2008/11/DLINQ-Future)乔纳森艾伦为 InfoQ.com

好吧，如果它是死胡同，我不想无限期地支持 LINQ to SQL。那么，我应该如何开始学习 ADO.NET Entity Framework？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-03T14:47:09.420

我如何...？视频

*   [如何开始使用实体框架？](http://blogs.msdn.com/adonet/archive/2008/05/20/how-do-i-new-entity-framework-videos.aspx)
*   [如何使用新的实体数据源？](http://blogs.msdn.com/adonet/archive/2008/05/20/how-do-i-new-entity-framework-videos.aspx)
*   [如何使用实体框架序列化图形？](http://blogs.msdn.com/adonet/archive/2008/05/20/how-do-i-new-entity-framework-videos.aspx)
*   [如何使用实体客户端？](http://blogs.msdn.com/adonet/archive/2008/05/20/how-do-i-new-entity-framework-videos.aspx)
*   [ADO.NET 实体设计器视频 - CTP 2](http://www.asp.net/learn/3.5-SP1/video-245.aspx)

网络广播

*   [MSDN 网络广播：框架大师班：LINQ to Entities（200 级）](http://www.asp.net/learn/webcasts/webcast-181.aspx)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2008-11-03T15:17:07.970

图书

是否还没有出版过教授 Microsoft ADO.NET 实体框架的书籍？

[对 Microsoft® ADO.NET 实体框架进行编程 http://ecx.images-amazon.com/images/I/418vMwHm9nL._SL160_AA115_.jpg](http://ecx.images-amazon.com/images/I/418vMwHm9nL._SL160_AA115_.jpg) David Sceppa
对 Microsoft® ADO.NET 实体框架（PRO-Developer）进行编程**12 月 10 日， 2008年**

 **[实体框架编程 http://ecx.images-amazon.com/images/I/51j8llSWYyL._SL160_AA115_.jpg](http://ecx.images-amazon.com/images/I/51j8llSWYyL._SL160_AA115_.jpg)
实体框架编程
，作者：Julia Lerman
**2009 年 1 月 15 日**

[Professional ADO.NET 3.5 with LINQ and the Entity Framework http://ecx.images-amazon.com/images/I/21ALxQeeJWL._SL160_AA115_.jpg](http://ecx.images-amazon.com/images/I/21ALxQeeJWL._SL160_AA115_.jpg)
Professional ADO.NET 3.5 with LINQ and the Entity Framework
by Roger Jennings
**2009 年 2 月 9 日**

[Pro SQL Server 2008 实体框架 (Pro) http://ecx.images-amazon.com/images/I/41Q1111Df8L._SL160_AA115_.jpg](http://ecx.images-amazon.com/images/I/41Q1111Df8L._SL160_AA115_.jpg) 由 Jim Wightman 撰写的
Pro SQL Server 2008 实体框架 (Pro) **2009 年 3 月 2 日**

 *** * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-04-03T07:13:08.370

在 Google 图书中搜索并预览阅读 PRO ADO.NET Entity Framework 4.0 图书。它看起来相当不错。这里是一个链接。

[http://books.google.co.in/books?id=mJwXCgFhtPMC&pg=PA1&source=gbs_toc_r&cad=4#v=onepage&q&f=false](http://books.google.co.in/books?id=mJwXCgFhtPMC&pg=PA1&source=gbs_toc_r&cad=4#v=onepage&q&f=false)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T15:23:26.240

会议

[PDC 2008 实体框架期货会议](http://channel9.msdn.com/pdc2008/TL20/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2008-11-03T15:59:53.423

相关问题：

*   [ADO.NET 实体框架教程](https://stackoverflow.com/questions/62110/adonet-entity-framework-tutorials)
*   [从哪里开始使用实体框架](https://stackoverflow.com/questions/42826/where-to-start-with-entity-framework)

# javascript - 来自 xul 的 Ajax 请求在 Firefox 2 中不起作用

> ID：258856
> 
> 赞同：0
> 
> 时间：2008-11-03T14:47:36.127
> 
> 标签：javascript, firefox, xul, httprequest

我正在开发一个 Firefox 扩展，并且一直在 Firefox 3 中开发它，我在 Firefox 2 上对其进行了测试，由于某种原因，我的 HTTP 请求都没有触发。请求的格式如下（使用原型）：

```
theResponse = function(response){
    //some code
}

new Ajax.Request(url,{
    method:'get',
    parameters : {url: currentURL},
    onSuccess: theResponse,
    onFailure: function(){ alert('Something went wrong...') }
}); 
```

我一直在尝试寻找解决方案，但我发现的最接近的事情与跨站点 HTTPrequests 有关，有人有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T13:16:32.800

发现问题与原型执行 HTTPrequests 的方式有关，切换到使用 jquery 并且没有进一步的问题......无论如何 HTTPrequests 都很好。

# c# - 设置线程标识

> ID：258857
> 
> 赞同：27
> 
> 时间：2008-11-03T14:49:10.850
> 
> 标签：c#, .net, multithreading, iidentity

在 C# 中，如何设置线程的标识？

例如，如果我有 Thread MyThread，它已经启动，我可以更改 MyThread 的身份吗？

或者这是不可能的？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2008-11-03T16:28:12.973

您可以通过创建新的 Principal 来设置线程的标识。[您可以使用从System.Security.Principal.IIdentity](https://msdn.microsoft.com/en-us/library/system.security.principal.iidentity(v=vs.110).aspx)继承的任何 Identity ，但您需要一个从[System.Security.Principal.IPrincipal](https://msdn.microsoft.com/en-us/library/system.security.principal.iprincipal(v=vs.110).aspx)继承的类，该类采用您正在使用的 Identity 类型。
为简单起见，.Net 框架提供了[GenericPrincipal](https://msdn.microsoft.com/en-us/library/system.security.principal.genericprincipal(v=vs.110).aspx)和[GenericIdentity](https://msdn.microsoft.com/en-us/library/system.security.principal.genericidentity(v=vs.110).aspx)类，它们可以像这样使用：

```
 using System.Security.Principal;

 // ...
 GenericIdentity identity = new GenericIdentity("M.Brown");
 identity.IsAuthenticated = true;

 // ...
 System.Threading.Thread.CurrentPrincipal =
    new GenericPrincipal(
        identity,
        new string[] { "Role1", "Role2" }
    );

 //...
 if (!System.Threading.Thread.CurrentPrincipal.IsInRole("Role1"))
 {
      Console.WriteLine("Permission denied");
      return;
 } 
```

但是，这不会给您使用新身份的 Windows 权限。但如果您正在开发一个网站并想要创建自己的用户管理，它会很有用。

如果您想伪装成与您当前使用的帐户不同的 Windows 用户，那么您需要使用模拟。[可以在System.Security.Principal.WindowsIdentity.Impersonate()](http://msdn.microsoft.com/en-us/library/chf6fbt4.aspx)的帮助中找到如何执行此操作的示例。您运行的帐户可以模拟哪些帐户存在限制。

在某些情况下，.Net 框架会为您进行模拟。发生这种情况的一个例子是，如果您正在开发一个 ASP.Net 网站，并且您为正在运行的虚拟目录或网站打开了集成 Windows 身份验证。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-08-22T14:00:42.483

**已接受答案的更新 [仅适用于 .NET framework 4.5 及更高版本]**
在`.NET 4.5`该属性`IsAuthenticated`中没有设置访问器，因此您不能将其直接设置为已接受的答案。
您可以使用以下代码设置该属性。

```
GenericIdentity identity = new GenericIdentity("someuser", "Forms");
Thread.CurrentPrincipal = new GenericPrincipal(identity, new string[] { "somerole" }); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2008-11-03T14:53:48.360

是的，从字面上使用[模仿](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext.aspx)

```
using (new Impersonation())
{
    // your elevated code
} 
```

并且类如下，对于设置，如果它看起来很奇怪，我会使用城堡字典适配器。

```
[PermissionSet(SecurityAction.Demand, Name = "FullTrust")]
public class Impersonation : IDisposable
{
    private readonly SafeTokenHandle _handle;
    private readonly WindowsImpersonationContext _context;

    //const int Logon32LogonNewCredentials = 9; 
    private const int Logon32LogonInteractive = 2;

    public Impersonation()
    {
        var settings = Settings.Instance.Whatever;
        var domain = settings.Domain;
        var username = settings.User;
        var password = settings.Password;
        var ok = LogonUser(username, domain, password, Logon32LogonInteractive, 0, out _handle);
        if (!ok)
        {
            var errorCode = Marshal.GetLastWin32Error();
            throw new ApplicationException(string.Format("Could not impersonate the elevated user.  LogonUser returned error code {0}.", errorCode));
        }
        _context = WindowsIdentity.Impersonate(_handle.DangerousGetHandle());
    }

    public void Dispose()
    {
        _context.Dispose();
        _handle.Dispose();
    }

    [DllImport("advapi32.dll", SetLastError = true, CharSet = CharSet.Unicode)]
    private static extern bool LogonUser(String lpszUsername, String lpszDomain, String lpszPassword, int dwLogonType, int dwLogonProvider, out SafeTokenHandle phToken);

    public sealed class SafeTokenHandle : SafeHandleZeroOrMinusOneIsInvalid
    {
        private SafeTokenHandle()
            : base(true)
        { }

        [DllImport("kernel32.dll")]
        [ReliabilityContract(Consistency.WillNotCorruptState, Cer.Success)]
        [SuppressUnmanagedCodeSecurity]
        [return: MarshalAs(UnmanagedType.Bool)]
        private static extern bool CloseHandle(IntPtr handle);

        protected override bool ReleaseHandle()
        {
            return CloseHandle(handle);
        }
    }
} 
```

# c# - 如何在无序列表元素中添加表单输入

> ID：258858
> 
> 赞同：0
> 
> 时间：2008-11-03T14:49:43.127
> 
> 标签：c#, asp.net

我正在动态生成一个 asp 表单，我想在列表中添加**标签**和**输入**元素。

例如，我想最终得到类似的东西：

```
<ul>
<li><label for="input"/><input id=input"/></li>
</ul> 
```

为此，我创建了一个 Label 对象和一个 TextBox 对象，然后分配 Label 的 AssociatedControlId 属性以链接它们。但是我不能在 ListItem 中添加任何这些，也不能在 BulletedList 的 Controls 集合中添加这些...

任何想法都会非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-04T05:54:23.080

System.Web.UI.HtmlControls 命名空间有一些有用的控件。

在你的 aspx 中：

```
<asp:PlaceHolder ID="PlaceHolder1" runat="server" /> 
```

在您后面的代码中：

```
HtmlGenericControl list = new HtmlGenericControl("ul");
for (int i = 0; i < 10; i++)
{
    HtmlGenericControl listItem = new HtmlGenericControl("li");
    Label textLabel = new Label();
    textLabel.Text = String.Format("Label {0}", i);
    listItem.Controls.Add(textLabel);
    // etc...
    list.Controls.Add(listItem);
}
PlaceHolder1.Controls.Add(list); 
```

奇迹般有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T15:47:13.040

您可能可以使用中继器执行类似的操作。

```
<asp:Repeater ID="rpt" runat="server">
    <HeaderTemplate>
        <ul>
    </HeaderTemplate>
    <ItemTemplate>
        <li>
            <label for='<%# string.Format("ctrl-{0}", Container.ItemIndex) %>'>label for ctrl #<%# Container.ItemIndex %></label>
            <input id='<%# string.Format("ctrl-{0}", Container.ItemIndex) %>' type="text" />                
        </li>
    </ItemTemplate>
    <FooterTemplate>
        </ul>
    </FooterTemplate>
</asp:Repeater> 
```

如果您需要将服务器控件添加到列表中，您需要对 Repeater 的 ItemDataBound 事件做一些事情。

# c# - 当一个表达式 已编译，是否隐式缓存？

> ID：258864
> 
> 赞同：16
> 
> 时间：2008-11-03T14:50:04.780
> 
> 标签：c#, .net, linq, caching, expression

编译时`Expression<T>`，结果代码是否被框架隐式缓存？我正在考虑`Regex`框架隐式编译和缓存最后几个正则表达式的静态方法。

如果**未**`Expression<T>`缓存已编译的对象，您能否推荐一些最佳实践来降低编译时间或在我手动缓存表达式时可能导致问题的任何陷阱？

 **```
public MyResultType DoSomething(int arg1, int arg2)
{
    var result = invokeHandler(
        (IDoSomethingHandler h) => h.DoSomething(arg1, arg2)
    );
    return result;
}

private TResult invokeHandler<T, TResult>(Expression<Func<T, TResult>> action)
    where T : class
{
    // Here, I might want to check to see if action is already cached.

    var compiledAction = action.Compile();
    var methodCallExpr = action as MethodCallExpression;

    // Here, I might want to store methodCallExpr in a cache somewhere.

    var handler = ServiceLocator.Current.GetInstance<T>();
    var result = compiledAction(handler);

    return result;
} 
```

在这个例子中，我有点担心如果我缓存编译的表达式，它会使用 和 的值，`arg1`因为`arg2`它们在编译表达式时，而不是从堆栈中的适当位置检索这些值（即而不是获取当前值）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-03T15:02:04.537

不; 我不相信它是；如果你想缓存它，你必须保留`Delegate`引用（通常是`Func<...>`或`Action<...>`）。同样，如果您想获得最佳性能，您可以将其编译为参数化表达式，以便在调用它时发送不同的值。

在这种情况下，重新措辞会有所帮助：

```
public MyResultType DoSomething(int arg1, int arg2)
{
    var result = invokeHandler(
        (IDoSomethingHandler h, int a1, int a2) => h.DoSomething(a1, a2),
        arg1, arg2);
    return result;
}

private TResult invokeHandler<T, TResult>(Expression<Func<T,int,int,TResult>> action,
    int arg1, int arg2)
    where T : class
{
    // Here, I might want to check to see if action is already cached.

    var compiledAction = action.Compile();
    var methodCallExpr = action as MethodCallExpression;

    // Here, I might want to store methodCallExpr in a cache somewhere.

    var handler = ServiceLocator.Current.GetInstance<T>();
    var result = compiledAction(handler, arg1, arg2);

    return result;
} 
```

即制作表达式的数字参数，并在运行时传递*实际*的参数（而不是表达式中的常量）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T15:02:43.460

Lambda experssions 不会自动缓存。您将需要为此实现自己的缓存/记忆算法。检查相关的 Stackoverflow 问题：

[是否可以缓存在 lambda 表达式中评估的值？](https://stackoverflow.com/questions/66382/is-it-possible-to-cache-a-value-evaluated-in-a-lambda-expression-c-linq)

需要注意的是，lambda 表达式在 C# 中是惰性求值的。

# c++ - 如何在 C++ 中使用带有指向对象的指针向量的查找算法？

> ID：258871
> 
> 赞同：17
> 
> 时间：2008-11-03T14:51:11.267
> 
> 标签：c++, algorithm, stl, pointers, vector

我想在一个匹配对象的对象指针向量中找到。这是一个示例代码来说明我的问题：

```
class A {
public:
    A(string a):_a(a) {}
    bool operator==(const A& p) {
        return p._a == _a; 
    }

private: 
    string _a;
};

vector<A*> va;

va.push_back(new A("one"));
va.push_back(new A("two"));
va.push_back(new A("three"));

find(va.begin(), va.end(), new A("two")); 
```

我想找到推入向量的第二个项目。但是由于vector被定义为一个指针集合，C++并没有使用我的重载运算符，而是使用隐式指针比较。在这种情况下，首选的 C++ 解决方案是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2008-11-03T15:03:05.423

将 find_if 与仿函数一起使用：

```
template <typename T>
struct pointer_values_equal
{
    const T* to_find;

    bool operator()(const T* other) const
    {
        return *to_find == *other;
    }
};

// usage:
void test(const vector<A*>& va)
{
    A* to_find = new A("two");
    pointer_values_equal<A> eq = { to_find };
    find_if(va.begin(), va.end(), eq);
    // don't forget to delete A!
} 
```

注意：A 的 operator== 应该是 const，或者，更好的是，将其写为非成员友元函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2008-11-03T15:05:30.583

要么使用 std::find_if 并自己提供合适的谓词，请参阅其他答案以获取此示例。

或者作为替代方案查看[boost::ptr_vector](http://www.boost.org/doc/libs/1_37_0/libs/ptr_container/doc/ptr_container.html)，它提供对真正存储为指针的元素的透明引用访问（作为额外的奖励，内存管理也为您处理）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T14:59:43.433

尝试改用 find_if 。它有一个谓词参数，您可以在其中准确决定如何检查是否找到了正确的元素。

[http://www.sgi.com/tech/stl/find_if.html](http://www.sgi.com/tech/stl/find_if.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-04T12:23:25.840

你也可以使用 Boost::Lambda:

```
using namespace boost::lambda;
find_if(va.begin(), va.end(), *_1 == A("two")); 
```

当然，您应该更喜欢使用 shared_ptrs，这样您就不必记住删除！

# .net - 在 Delphi 程序中托管 .NET 运行时

> ID：258875
> 
> 赞同：13
> 
> 时间：2008-11-03T14:51:45.277
> 
> 标签：.net, delphi, winapi, com, interop

我正在考虑在 Delphi 程序中使用一些 .NET 代码，我需要使用 .net 程序集和预定义函数（我已经支持常规 DLL）使我的程序可扩展。

经过大量的在线搜索，我找到了 [Managed-VCL](http://www.managed-vcl.com/)，但我还没有准备好为我需要的东西支付 250 美元，我还发现一些新闻组的代码不完整且无法正常工作。

我正在将 Delphi 2007 用于 win32。我可以使用什么来从具有预定义参数的程序集中动态执行函数？

就像是：

```
procedure ExecAssembly(AssemblyFileName:String; Parameters: Variant); 
```

我只想补充一点，我需要能够加载任意程序集（可能是特定文件夹中的所有程序集），因此创建 C# 包装器可能不起作用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T15:12:27.917

自己托管 CLR 并不是那么困难（特别是如果您只使用单个 AppDomain）。您可以使用基于 COM 的托管 API 来启动运行时、加载程序集、创建对象并在其上调用方法。

网上有很多信息，例如关于“[托管公共语言运行时](http://msdn.microsoft.com/en-us/library/9x0wh2z3(VS.80).aspx)”的 MSDN 文档。*（[新家](https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-3.0/9x0wh2z3(v=vs.85))）*

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-19T07:45:10.023

在 Jedi Code Library (JCL) - 免费 - 有一个 JclDotNet.pas，包含一个类 TJclClrHost，可能做你想做的事：

```
 TJclClrHost = class(TJclClrBase, ICorRuntimeHost)
  private
    FDefaultInterface: ICorRuntimeHost;
    FAppDomains: TObjectList;
    procedure EnumAppDomains;
    function GetAppDomain(const Idx: Integer): TJclClrAppDomain;
    function GetAppDomainCount: Integer;
    function GetDefaultAppDomain: IJclClrAppDomain;
    function GetCurrentAppDomain: IJclClrAppDomain;
  protected
    function AddAppDomain(const AppDomain: TJclClrAppDomain): Integer;
    function RemoveAppDomain(const AppDomain: TJclClrAppDomain): Integer; 
  public
    constructor Create(const ClrVer: WideString = '';
      const Flavor: TJclClrHostFlavor = hfWorkStation;
      const ConcurrentGC: Boolean = True;
      const LoaderFlags: TJclClrHostLoaderFlags = [hlOptSingleDomain]);
    destructor Destroy; override;
    procedure Start;
    procedure Stop;
    procedure Refresh;
    function CreateDomainSetup: TJclClrAppDomainSetup;
    function CreateAppDomain(const Name: WideString;
      const Setup: TJclClrAppDomainSetup = nil;
      const Evidence: IJclClrEvidence = nil): TJclClrAppDomain;
    function FindAppDomain(const Intf: IJclClrAppDomain; var Ret: TJclClrAppDomain): Boolean; overload;
    function FindAppDomain(const Name: WideString; var Ret: TJclClrAppDomain): Boolean; overload;
    class function CorSystemDirectory: WideString;
    class function CorVersion: WideString;
    class function CorRequiredVersion: WideString;
    class procedure GetClrVersions(VersionNames: TWideStrings); overload;
    class procedure GetClrVersions(VersionNames: TStrings); overload;
    property DefaultInterface: ICorRuntimeHost read FDefaultInterface implements ICorRuntimeHost;
    property AppDomains[const Idx: Integer]: TJclClrAppDomain read GetAppDomain; default;
    property AppDomainCount: Integer read GetAppDomainCount;
    property DefaultAppDomain: IJclClrAppDomain read GetDefaultAppDomain;
    property CurrentAppDomain: IJclClrAppDomain read GetCurrentAppDomain;
  end; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2008-11-03T15:01:57.283

我可以从第一手经验告诉你，与 Delphi 的 .Net 互操作不是野餐。我是 .Net 人，但曾在 .Net 和 Delphi 商店工作过一段时间。我管理了几个用 .Net（WinForms 和 WPF）编写但被 Delphi 调用的项目。我们的 Delphi 人员已经为 Delphi 编写了一个互操作层来调用 .Net 库，因为我们所有的新产品都是用 .Net 编写的。这对我们来说很麻烦（这些都是优秀的 Delphi 开发人员）。如果我们可以购买一个*好的*3rd 方库来为我们进行互操作，那将是非常值得的。我敢打赌，我们花费了数千美元的工时编写和调试从 Delphi 到 .Net 的互操作问题。

我会拿那个 Managed-VLC 库进行试驾，看看它的工作情况。如果它不辜负它的广告，那么它很容易值 250 美元。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-01-12T21:13:25.420

有关使用 JCL 在 Delphi 中托管 CLR 的端到端示例，请参阅[我的问题。](https://stackoverflow.com/questions/2048540/hosting-clr-in-delphi-with-jcl-example)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2008-11-03T17:57:08.083

我有这个完全相同的问题。我在一家 Delphi 商店工作，他们想开始使用 .NET 和 C# 向旧版 Delphi 应用程序添加功能。我查看了 Managed-VLC 并决定跳过它，因为我觉得它有一些严重的问题。我在这里发现了一些更简单的东西：[Delphi.NET](http://sourceforge.net/projects/delphinet/)。注意：这*不是*在 .NET 上本机运行的 Delphi 版本。这是一个开源项目，允许旧版 Delphi 应用程序通过 COM 和反射访问 .NET 功能。尽管它很旧，但由于它使用 COM，它就像一个魅力。我将验证它是否适用于 .NET 2.0 和 3.5。几天之内，我就将 .NET DLL 完全集成到了我们的旧版 Delphi 5 应用程序中。我的老板认为我是超级英雄。祝你好运！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2008-11-03T15:01:21.060

您可以在 Delphi 中使用 .Net 类作为 COM 对象：

*   在 C# 中创建程序集
*   为程序集创建类型库
*   在 Delphi 中导入类型库

现在您可以从 .Net 程序集中访问在类型库中导出的类。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2008-11-03T18:39:38.093

您可以将 Delphi 用于 .Net 和非托管导出，也称为反向 P/Invoke。

这实际上让您可以创建一个 .Net .dll，该 .dll 可以完全访问 .Net 框架，但可以由任何本地语言加载，就像使用任何 .dll 一样，并且没有 com 互操作的开销。

这是一个简单的例子： [http ://cc.codegear.com/Item/22688](http://cc.codegear.com/Item/22688)

# asp.net - 以编程方式将用户控件加载到 html 文本编写器中

> ID：258877
> 
> 赞同：6
> 
> 时间：2008-11-03T14:51:55.307
> 
> 标签：asp.net, user-controls

我正在尝试将用户控件呈现为字符串。应用程序设置为使用户能够使用令牌，并且在找到令牌的地方呈现用户控件。

```
StringBuilder sb = new StringBuilder();
StringWriter sw = new StringWriter(sb);
HtmlTextWriter writer = new HtmlTextWriter(sw);

Control uc = LoadControl("~/includes/HomepageNews.ascx");
uc.RenderControl(writer);
return sb.ToString(); 
```

**该代码呈现控件，但控件的 Page_Load 中调用的任何事件都未触发。控件中有一个中继器需要触发。**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2008-11-03T20:15:35.463

很长一段时间以来，我一直在使用 Scott Guthrie 在他的博客中提供的以下代码：

```
public class ViewManager
{
    public static string RenderView(string path, object data)
    {
        Page pageHolder = new Page();
        UserControl viewControl = (UserControl) pageHolder.LoadControl(path);

        if (data != null)
        {
            Type viewControlType = viewControl.GetType();
            FieldInfo field = viewControlType.GetField("Data");
            if (field != null)
            {
                field.SetValue(viewControl, data);
            }
            else
            {
                throw new Exception("ViewFile: " + path + "has no data property");
            }
        }

        pageHolder.Controls.Add(viewControl);
        StringWriter result = new StringWriter();
        HttpContext.Current.Server.Execute(pageHolder, result, false);
        return result.ToString();
    }
} 
```

该`object data`参数可以将数据动态加载到用户控件中，并且可以用于通过数组或类似的方式将多个变量注入到控件中。

此代码将触发控件中的所有正常事件。

[你可以在这里读更多关于它的内容](http://weblogs.asp.net/scottgu/archive/2006/10/22/Tip_2F00_Trick_3A00_-Cool-UI-Templating-Technique-to-use-with-ASP.NET-AJAX-for-non_2D00_UpdatePanel-scenarios.aspx)

问候杰斯珀豪格

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T14:55:20.463

您需要通过将控件添加到页面的控件集合或页面上的控件来将控件附加到页面。除非您在正常页面渲染事件期间明确禁用渲染，否则这不会解决您的所有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-29T13:11:19.263

我采用了 Hauge/Scott Guthrie 的上述方法并对其进行了调整，以便您无需使用反射，或修改 UserControl 来实现任何特殊接口。关键是我添加了上面 RenderView 方法调用的强类型回调，而不是进行反射。

[我在这里](http://www.jonkragh.com/index.php/rendering-an-asp-net-usercontrol-to-a-string/)写了帮助方法和用法

HTH，乔恩

# visual-studio - Visual Studio 颜色未正确加载

> ID：258878
> 
> 赞同：3
> 
> 时间：2008-11-03T14:51:57.413
> 
> 标签：visual-studio, visual-studio-2008

我在 Visual Studio 中使用自定义配色方案（黑色背景、灰色文本等）。但是，有一些设置拒绝更改。例如，当光标通过 aspx 页面的标记时，当前标记默认为黑色文本，这在我的黑色背景上效果不佳。我之前已将适当的设置更改为“可见”颜色。事实上，要修复它，我所要做的就是打开选项窗口，选中并取消选中纯文本上的粗体设置，然后点击确定，现在我选择的所有设置都已正确加载。如果我打开一个新会话，我必须再次执行这些步骤。只有少数设置我注意到了这种行为（只读区域是另一个），但是必须做一个虚拟选项更改才能让它们生效，这很烦人。以前有没有人见过这种行为，

更新：找到了一个有趣的修复。我仍然不知道根本原因是什么（可能是@sliderhouserules 建议的一些损坏），但我有一个比使用工具更快的方法来修复它 | 选项 | 字体和颜色。我只是导出了我当前的颜色设置并创建了一个宏来加载它们：

```
Public Sub ImportColors()
    DTE.ExecuteCommand("Tools.ImportandExportSettings", "-import:""C:\Documents and Settings\gregf\My Documents\Visual Studio 2008\Settings\FontsAnColors_Exported-2008-12-05.vssettings""")
End Sub 
```

然后我将该宏映射到工具栏上的一个按钮。现在，每当我的颜色出错时，我都可以一键修复。不理想，但现在不那么痛苦了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T05:46:23.643

在我看来，您的 VS 安装中可能存在一些损坏或其他问题（即您需要重新安装 VS）。这听起来不像是一个错误，你会在黑暗中钓鱼，试图修复你的注册表或任何涉及为 VS 设置和存储这些选项的配置文件。

# linux - 我需要一个 TCP 选项 (ioctl) 来立即发送数据

> ID：258883
> 
> 赞同：7
> 
> 时间：2008-11-03T14:53:22.713
> 
> 标签：linux, embedded, tcp

我遇到了一个不寻常的情况：我在嵌入式环境中使用 Linux 系统（Intel box，目前使用 2.6.20 内核。）它必须与 TCP 实现部分损坏的嵌入式系统通信。据我所知，他们希望我们的每条消息都出现在单独的以太网帧中！当消息跨以太网帧拆分时，它们似乎有问题。

我们与设备在本地网络上，我们之间没有路由器（只是一个交换机）。

当然，我们正试图强迫他们修复他们的系统，但这可能最终不可行。

我已经在我的套接字上设置了 TCP_NODELAY（我连接到它们），但这只有在我不尝试一次发送多个消息时才有帮助。如果我连续有几条传出消息，这些消息往往会以一个或两个以太网帧结束，这会导致另一个系统出现问题。

我通常可以通过使用计时器来避免这个问题，以避免将消息发送得太近，但这显然会限制我们的吞吐量。此外，如果我把时间调得太低，我会冒网络拥塞阻碍数据包传输的风险，最终导致我的多个消息进入同一个数据包。

有什么方法可以判断驱动程序是否有数据排队？有什么方法可以强制驱动程序在独立的传输层数据包中发送独立的写调用？我查看了 socket(7) 和 tcp(7) 手册页，但没有找到任何东西。可能只是我不知道我在寻找什么。

显然，UDP 将是一种出路，但同样，我认为我们不能让另一端在这一点上做出任何改变。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-03T15:07:49.313

IIUC，设置 TCP_NODELAY 选项应该刷新所有数据包（即 tcp.c 通过调用 tcp_push_pending_frames 来实现 NODELAY 的设置）。所以如果你在每次发送调用后设置套接字选项，你应该得到你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-05T10:21:48.983

除非您确定问题是什么，否则您无法解决问题。

如果他们犯了假设 recv() 只收到一条消息的新手错误，那么我看不到完全解决它的方法。每个以太网帧只发送一条消息是一回事，但如果多个以太网帧在接收方调用 recv() 之前到达，它仍然会在一次调用中获得多条消息。

网络拥塞使得实际上不可能防止这种情况（同时保持良好的吞吐量），即使他们可以告诉你他们多久调用一次 recv()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2008-11-03T16:28:30.227

也许，设置 TCP_NODELAY 并将 MTU 设置得足够低，以便每帧最多有 1 条消息？哦，在传出的数据包上添加“dont-fragment”标志

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T16:35:23.303

您是否尝试过为每条消息打开一个新套接字并立即关闭它？开销可能令人作呕，但这应该限制您的消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T16:45:04.923

在最坏的情况下，您可以降低一级（原始套接字），在那里您可以更好地控制发送的数据包，但是您必须处理 TCP 的所有细节。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2008-11-03T18:33:20.773

也许您可以尝试将 tcp 堆栈置于低延迟模式：

```
echo 1 > /proc/sys/net/ipv4/tcp_low_latency 
```

这应该有利于尽可能快地发送数据包而不是组合数据。阅读有关 tcp(7) 的手册以获取更多信息。

# java - Java 网络事件

> ID：258885
> 
> 赞同：0
> 
> 时间：2008-11-03T14:54:15.597
> 
> 标签：java, networking, mobile

我正在创建一个 java 移动应用程序，我想知道设备何时获得 IP 地址以便能够将消息发送到后端系统。

是否存在任何 API？我猜如果存在 API，它必须通过 JNI 使用系统相关调用？

谢谢你，朱利安。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-04T10:32:27.637

好的，我不是 100% 确定我理解你想要做什么，但这里有一些可能被证明有用的事情：

*   stackoverflow 有 J2ME 和 javaME（Java 的移动版本）的标签。

*   从理论上讲，安装一个声明静态 PushRegistry 套接字连接的 MIDlet 可能会强制设备始终拥有一个 IP 地址。这显然取决于 VM 提供者如何解释 Pushregistry 规范。

*   移动 Java 虚拟机没有标准的 JNI 支持。

*   移动 Java 应用程序在后台运行时可能会自动暂停，因此我不认为您不应该只使用 GCF API 打开与后端系统的客户端套接字连接。大概只有当 MIDlet 处于前台时才需要它。

# wpf - 在没有 WinForms 的情况下确定屏幕数量和屏幕相对位置

> ID：258886
> 
> 赞同：3
> 
> 时间：2008-11-03T14:55:10.400
> 
> 标签：wpf, multiple-monitors

我想保存和恢复我的 WPF 应用程序的窗口位置。我想让代码健壮地与多个监视器一起使用，这些监视器的数量和相对位置可以改变（当监视器配置在调用之间发生变化时，我想避免在屏幕外打开我的应用程序）。

我知道 System.Windows.Forms 中的 Screen 类，但我不想仅仅为了这个特性而依赖该程序集。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T15:17:45.160

即使您使用现在超出可视范围的坐标，Windows 也会将您的应用程序保留在屏幕上。只需坚持`DesktopLocation`, `Size`, 和`WindowState`（查看应用程序是否已最大化）。如果应用程序在最小化时关闭，请确保不要保存这些设置。

# c# - 面向开发人员的网络安全基础（IIS、SQL、RDP 等）

> ID：258889
> 
> 赞同：3
> 
> 时间：2008-11-03T14:55:58.823
> 
> 标签：c#, asp.net, vb.net, security, iis

不确定是否有人听过 Hanselminutes 第 134 和 135 集，但在第 135 期节目结束时，Scott Hanselman 对如何为 Web 应用程序设置基线安全环境提出了很多很好的建议。作为一名开发人员，我的大部分时间都专注于开发应用程序，而不是项目的网络方面，但是作为一家初创公司，这仍然是一个重要的组成部分，如果没有安全顾问，如何实现和正确设置斯科特对这个问题有同样的了解吗？

我想我正在寻找一些有关该主题的阅读材料（书籍、文章、网站），以帮助我了解 Scott 推荐的设置安全网络环境以托管应用程序的方法。IIS、SQL Server、防火墙、无需使用“远程桌面”即可更新站点（以避免任何 RDP 漏洞）等。

ps Jeff - 没有人会因为没有钱购买额外的服务器而责备你，我们知道如果你负担得起的话，你会的。不要从 Scott 那里拿那个“银行家”的废话，那个家伙在微软工作了太久，忘记了作为一家初创公司破产是什么感觉……哈哈哈。

编辑：要清楚，我不是在谈论代码安全性，我是在谈论加密服务器之间的流量、网络拓扑、防火墙等。

编辑＃2：更改主题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T14:58:26.870

[owasp](http://www.owasp.org)将是一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T18:48:58.290

由于您是 ASP.NET 人员，因此您可以查看 Microsoft Press 的《 **提高 Web 应用程序安全**性》一书ISBN 978-0735618428。整个[文本托管在 MSDN 上](http://msdn.microsoft.com/en-us/library/ms994921.aspx)。还有可用的[死树版本](https://rads.stackoverflow.com/amzn/click/com/0735618429)和[电子书版本](http://download-ebook.org/index.php?target=desc&ebookid=2159)。

我要特别指出这些章节：

[第 5 章：安全架构和设计评审](http://msdn.microsoft.com/en-us/library/aa302421.aspx)

[第 15 章：保护您的网络](http://msdn.microsoft.com/en-us/library/aa302431.aspx)

[第 16 章：保护您的 Web 服务器](http://msdn.microsoft.com/en-us/library/aa302432.aspx)

[第 17 章：保护您的应用程序服务器](http://msdn.microsoft.com/en-us/library/aa302433.aspx)

[第 18 章：保护您的数据库服务器](http://msdn.microsoft.com/en-us/library/aa302434.aspx)

诚然，它有点过时（.NET 1.1、IIS 5.0、SQL Server 2000），但基本原则就在那里。

# c# - Winform 的所见即所得控件

> ID：258893
> 
> 赞同：12
> 
> 时间：2008-11-03T14:57:46.887
> 
> 标签：c#, .net, vb.net, winforms

我正在寻找在 Winform 应用程序中使用的免费所见即所得编辑器控件。应用程序的主要语言是 VB，但也可以选择使用 C#。为了澄清我需要一个具有格式栏的富文本编辑器控件。我浏览了整个网络，我能找到的唯一选择是昂贵的控制包，这些包比我需要的要多。我并不反对创建我自己的此控件版本，如果能找到一个免费且开放的替代方案就好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2008-11-03T15:06:45.667

在这种情况下，从 CodeProject 文章开始似乎是最简单的：

*   [http://www.codeproject.com/KB/edit/editor_in_windows_forms.aspx](http://www.codeproject.com/KB/edit/editor_in_windows_forms.aspx) --*不是我的第一个建议，但如果你想要 HTML，也许有用。*

*   [http://www.codeproject.com/KB/edit/TextRulerControl.aspx?fid=968441&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=26&select=2438044](http://www.codeproject.com/KB/edit/TextRulerControl.aspx?fid=968441&df=90&mpp=25&noise=3&sort=Position&view=Quick&fr=26&select=2438044)

*   [http://www.codeproject.com/KB/cs/eRichTextBox.aspx](http://www.codeproject.com/KB/cs/eRichTextBox.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T15:01:00.060

实际上，基于 RichTextBox 控件编写自己的控件非常容易。

我肯定会走那条路。您最大的问题将是编辑栏的图标。

检查[这个](http://www.workaholic.hu/temp/RTFEditor.zip)作为初学者。

# asp.net-mvc - 什么 CAPTCHA 系统与 ASP.NET MVC 兼容？

> ID：258897
> 
> 赞同：16
> 
> 时间：2008-11-03T14:59:06.460
> 
> 标签：asp.net-mvc, captcha

什么[CAPTCHA](http://en.wikipedia.org/wiki/CAPTCHA)系统与 ASP.NET MVC 兼容？有什么好的例子吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-09-29T10:01:18.877

这是一个[关于在 MVC 中使用 reCaptcha的](http://devlicio.us/blogs/derik_whittaker/archive/2008/12/02/using-recaptcha-with-asp-net-mvc.aspx)[**很棒的**](http://devlicio.us/blogs/derik_whittaker/archive/2008/12/02/using-recaptcha-with-asp-net-mvc.aspx)教程，并且适用于当前最新版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2008-11-03T15:00:22.183

[试试这个帖子](http://www.coderjournal.com/2008/03/aspnet-mvc-captcha/)

没耐心看文章的可以在这里找到源码：[zip文件](http://www.coderjournal.com/uploads/2008/03/captcha.zip)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2008-11-03T15:24:22.590

使用 ASP.NET MVC 编写的 Stack Overflow 使用[reCAPTCHA](http://en.wikipedia.org/wiki/ReCAPTCHA)。*[您可以在一次一个单词的数字化书籍](http://recaptcha.net/learnmore.html)*中找到有关 reCAPTCHA 的更多信息，甚至可以观看 Jeff Atwood在[PDC](http://en.wikipedia.org/wiki/Professional_Developers_Conference) 2008的演讲中谈论[Stack Overflow 中的 reCAPTCHA 。](http://channel9.msdn.com/pdc2008/PC21/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2008-12-09T17:18:57.517

查看[RecaptchaMvc](http://weblogs.asp.net/awilinsk/archive/2008/12/09/recaptchamvc.aspx)。它是一个使用 reCAPTCHA 服务和 ASP.NET MVC 的框架。

# java - Sun JVM 如何将 Java 线程映射到 Windows 线程？

> ID：258901
> 
> 赞同：9
> 
> 时间：2008-11-03T15:00:24.227
> 
> 标签：java, windows, multithreading, jvm

我的应用程序使用大量 Java 线程。我正在寻找对 JVM（版本 5 和 6）如何将 Java 线程映射到底层 Windows 线程的可靠理解。我知道有一个映射到 Solaris 线程的文档，但不是 Windows。

为什么 Sun 不发布此信息？

我想知道是否存在 1:1 映射，或者它是否因 JVM、-server 选项、工作负载等而异。

我知道我不“应该”关心，我应该编写正确的同步代码，但我继承了大量代码......

另外，有谁知道如何给 Windows 线程命名？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2008-11-03T15:19:08.620

没有适合您的文档，但是从任务管理器的线程列中，您可以非常可靠地猜测它会 1:1 映射到本机线程（您需要先在任务管理器中启用线程列）。

哦，差点忘了，你可以在[这里](https://jdk6.dev.java.net/)下载jdk src ，自己看看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T15:52:48.053

映射是平台相关的，但是我发现了一个有趣的 vm 平台线程之间的[比较](http://www2.sys-con.com/itsg/virtualcd/Java/archives/0306/gal/index.html)（虽然可能有点旧）。底线是：你不需要知道。您可能更感兴趣的是了解[绿色线程](http://en.wikipedia.org/wiki/Green_threads)（如果您还不知道）。

至于命名问题：[构造函数](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Thread.html#Thread(java.lang.String))不允许您命名线程吗？或者您的意思是给它们命名并在某些 Windows 线程浏览器上查看它们的名称？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T15:54:38.860

[如何命名 Win32 线程](http://msdn.microsoft.com/en-us/library/xcb2z8hs.aspx)

不幸的是，这似乎是不可能的，或者至少很难在 Windows JVM 中做到。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-17T11:40:30.233

JVM 规范在这方面没有严格规定。它留给 JVM 实现者将 Java 主题映射到平台主题（Windows、Linux 等）。也很难相信 Java 线程和 OS 线程之间会有一对一的映射。

# c# - 如何在构造函数中查找参数的数量

> ID：258908
> 
> 赞同：1
> 
> 时间：2008-11-03T15:02:05.973
> 
> 标签：c#, visual-studio-2008, constructor

我试图找到一种方法来确定构造函数有多少个参数。

现在我已经构建了一个没有参数的构造函数和一个有 4 个参数的构造函数。

在 C# 中，是否有一种方法可以找出使用的或给定的构造函数有多少个参数？

问题是，我正在使用第三个构造函数来读取日志文件。这些日志文件被读取为 string[] 元素，并且应该与参数一样多。如果没有，我有一个损坏的日志文件。

但是我使用了很多子类，并且每个构造函数都有更多针对其特定日志类型的参数。

所以我想知道：有没有一种方法可以检查构造函数的参数数量？

是的，这是一项学校作业。我真的不知道要寻找什么术语，所以 VS2008 对象浏览器目前用处不大。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T15:06:35.150

您应该查看 System.Reflection 命名空间。更具体地说，您可以通过以下方式获取类的构造函数列表：

```
 System.Type.GetType("MYClassName").GetConstructors() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T15:11:21.600

听起来好像您需要重新考虑一下您的代码。根据您的描述，必须动态确定构造函数中的参数数量听起来有点麻烦。您可能会考虑工厂设计模式，因为创建的对象类型是在运行时确定的。如果我误解了您的问题，那么使用其他答案指出的反射将为您解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T15:05:08.010

我不确定您需要此信息的确切上下文，但如果您在运行时动态需要它，请尝试 System.Reflection 命名空间

否则 Intellisense 下拉列表应该显示所有可用的构造函数......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2008-11-03T15:26:24.800

参数的数量是恒定的。我已经定义了它们并且它们没有改变。

正在发生的事情是我正在模拟一种出版物树，并且我正在其中进行划分（又名子类​​）

因此，我的子类的所有构造函数都有参数或它们继承的类。

因此，每种出版物的长度都不同。

我有第三个构造函数，以防我需要通过读取日志文件来可视化我的发布数据。

但我必须考虑到日志文件可能已损坏。其中包括日志文件中我的所有参数都没有数据的可能性。

这就是为什么我必须知道如何在我的构造函数中找到参数的数量：我必须检查我的日志中有多少数据与我拥有的参数数量相比。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2008-11-03T15:33:02.337

你不能创建一个构造函数来引用日志文件（或当前的原始日志文件条目），读取它并在有任何问题时抛出错误吗？

我试图理解为什么你需要查看构造函数的元素数量。到目前为止，我所看到的似乎是一个薄弱的设计，相信日志文件中的元素数量恰好可以识别要创建的发布类型。

对您当前问题的简短回答是之前的回答中所述：反思您尝试创建的类的构造函数，并检查其参数。

# c# - 泛型类上的 DebuggerDisplay

> ID：258917
> 
> 赞同：14
> 
> 时间：2008-11-03T15:05:59.380
> 
> 标签：c#, .net, visual-studio, debugging

我`DebuggerDisplay`在泛型类上应用属性时遇到问题：

```
[DebuggerDisplay("--foo--")]
class Foo
{
}

[DebuggerDisplay("Bar: {t}")]
class Bar<T>
{
    public T t;
} 
```

在检查类型的对象时，`Bar<Foo>`我希望它显示为`Bar: --foo--`，但我得到`Bar: {Foo}`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2008-11-03T15:18:32.477

DebuggerDisplay 属性不是递归的。字符串中的 {} 本质上是说评估这个表达式并内联显示结果。内部结果的字符串被计算为好像没有 DebuggerDisplay 属性在播放类型或成员。这就是为什么您会看到 {Foo} 而不是 --foo--。

原因是可靠性。拥有相互递归的 DebuggerDisplay 属性标记太容易了。这将导致在评估内部表达式时发生堆栈溢出或无限循环。不递归地评估 DebuggerDisplay 属性可以防止这种无限递归（尽管用户仍然很有可能在特定表达式中自己创建它）。

控制内部表达式显示方式的一种方法是覆盖 .ToString() 方法。这将在计算内部表达式的显示字符串时进行评估。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-09-16T07:15:40.803

您可以使用`[DebuggerDisplay("Bar<{typeof(T).Name,nq}>")]//nq - no quotes`.

您还可以使用以下做法： [DebuggerDisplay 属性最佳做法](http://blogs.msdn.com/b/jaredpar/archive/2011/03/18/debuggerdisplay-attribute-best-practices.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-08T12:00:50.623

*[免责声明：我隶属于 OzCode]*

您可以使用支持嵌套/递归调试信息的 OzCode 的显示功能。 一旦为实例定义了它，它将自动用于该类型的所有实例。[![在此处输入图像描述](https://i.stack.imgur.com/hWlRv.gif)](https://i.stack.imgur.com/hWlRv.gif)

# .net - COMException: 传递给系统调用的数据区域太小

> ID：258934
> 
> 赞同：1
> 
> 时间：2008-11-03T15:08:49.843
> 
> 标签：.net, workflow-foundation, com-interop

在创建 Windows Workflow Foundation 运行时实例时，偶尔会出现本文标题中定义的消息以及 HResult 0x8007007A。

错误文本很容易解释，并且在 Workflow Foundation 程序集中使用反射器我已将问题缩小到 ADVAPI32.DLL 中的以下调用之一。

SetKernelObjectSecurity RevertToSelf OpenProcessToken GetKernelObjectSecurity

我已经消除了 RevertToSelf() 因为它不接受输入参数，所以不能传入太小的数据结构。

GetKernelObjectSecurity 将结构作为输入，这可能是错误的，但此错误是暂时的，没有明显的再现步骤。

我*认为*它与应用程序中某处的内存管理有关，但无法找到 HResult 含义的良好定义。谁能指出我对这个 HResult 的良好定义的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T18:26:59.663

我可以提供一些推测。

正如您所说，错误消息听起来很容易解释。

OpenProcessToken 似乎不太可能作为候选对象，因为您从不直接将内存区域的*大小传递给它。*

GetKernelObjectSecurity 或 SetKernelObjectSecurity 似乎是不错的选择。我认为您没有直接调用它们，因此您不知道使用什么逻辑将内存区域传递给这些函数。是否有可能，例如，您正在使用的某个库中有一个固定大小的安全描述符缓冲区，一旦缓冲区用尽，它会占用缓冲区的剩余大小（例如零）并将其传递给 GetKernelObjectSecurity ?

（一般来说，我希望它更有可能来自这样的 WF 运行时实现错误，而不是操作系统错误。）

# visual-studio - Ctrl+Backspace 可以在 VS2008 的解决方案资源管理器中工作吗？

> ID：258952
> 
> 赞同：1
> 
> 时间：2008-11-03T15:15:10.687
> 
> 标签：visual-studio, visual-studio-2008

我在一个 ASP.NET MVC Beta 1 项目中工作，我注意到如果我想在解决方案资源管理器窗格中重命名一个文件，Ctrl+Backspace 不会做它应该做的事情（删除最接近的“单词”） ，我得到了一个愚蠢的盒子字符并且很生气。

我在使用 jTemplates 时经常这样做，所以与其训练自己不使用这个非常有用的组合键，有没有办法让这个功能在 VS2008 中达到预期的效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-03T16:45:00.413

可能不是。在 connect.microsoft.com 上提交一个错误，并希望他们在 VS 2010 中修复它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2008-11-03T15:23:55.570

我不确定这是否完全有效，但是如果您转到工具-> 选项：环境-> 键盘，您可以设置快捷方式。

在包含文本框中的显示命令中键入“重命名”。搜索“文件.重命名”

将光标放在“按快捷键”文本框中，然后按 Ctrl+Backspace。

按分配，它应该接管快捷方式组合。

希望这对你有用。

# java - Java：淘汰旧，进新

> ID：258954
> 
> 赞同：65
> 
> 时间：2008-11-03T15:15:22.997
> 
> 标签：java

Java 接近第 7 版。在我看来，必须有大量的教科书和培训手册围绕旧版本的 Java 教授方法，在这些方法中教授的方法现在会有更好的解决方案。

有哪些样板代码情况，尤其是您看到人们通过习惯的力量实现的情况，您发现自己正在重构以利用最新版本的 Java？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2008-11-03T15:51:36.277

枚举。更换

```
public static final int CLUBS = 0;
public static final int DIAMONDS = 1;
public static final int HEARTS = 2;
public static final int SPADES = 3; 
```

和

```
public enum Suit { 
  CLUBS, 
  DIAMONDS, 
  HEARTS, 
  SPADES 
} 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2008-11-03T15:16:31.293

泛型，不再需要创建迭代器来遍历集合中的所有元素。新版本更好，更容易使用，也更容易理解。

编辑：

前：

```
List l = someList;
Iterator i = l.getIterator();
while (i.hasNext()) {
    MyObject o = (MyObject)i.next();
} 
```

后

```
List<MyObject> l = someList;
for (MyObject o : l) {
    //do something
} 
```

* * *

## 回答 #3

> 赞同：37
> 
> 时间：2008-11-03T16:32:20.203

使用类型的局部变量`StringBuffer`来执行字符串连接。除非需要同步，现在建议`StringBuilder`改用，因为这个类提供了更好的性能（大概是因为它是不同步的）。

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2009-05-30T16:39:50.150

从标准输入读取字符串：

**Java pre-5**：

```
try {
    BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
    String str = reader.readLine();
    reader.close();
}
catch (IOException e) {
    System.err.println("error when closing input stream.");
} 
```

**爪哇 5**：

```
Scanner reader = new Scanner(System.in);
String str = reader.nextLine();
reader.close(); 
```

**爪哇6**：

```
Console reader = System.console();
String str = reader.readLine(); 
```

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2008-11-03T15:58:44.140

这是我看到的一个：

`String.split()`与`StringTokenizer`.

`StringTokenizer`不推荐用于新代码，但我仍然看到人们使用它。

至于兼容性，Sun 为使 Java 向后和向前兼容付出了巨大的努力。这部分解释了为什么泛型如此复杂。弃用也应该有助于简化从旧代码到新代码的转换。

* * *

## 回答 #6

> 赞同：24
> 
> 时间：2008-11-03T19:32:42.133

使用 Thread 的旧代码而不是 Thread 的许多其他替代品......这些天，我遇到的很少的代码仍然需要使用原始线程。[一定程度的抽象，特别是Callable](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Callable.html) / [Futures](http://java.sun.com/javase/6/docs/api/java/util/concurrent/Future.html) / [Executors](http://java.sun.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)会更好地为它们服务。

看：

[java.util.Timer](http://java.sun.com/javase/6/docs/api/java/util/Timer.html)

[javax.swing.Timer](http://java.sun.com/javase/6/docs/api/javax/swing/Timer.html)

[java.util.concurrent.*](http://java.sun.com/javase/6/docs/api/java/util/concurrent/package-summary.html)

* * *

## 回答 #7

> 赞同：21
> 
> 时间：2008-11-04T09:08:46.527

VARARGS 也很有用。

例如，您可以使用：

```
public int add(int... numbers){
    int sum = 0 ;
    for (int i : numbers){
        sum+=i;
    }
    return sum ;
} 
```

代替：

```
public int add(int n1, int n2, int n3, int n4) ; 
```

或者

```
public int add(List<Integer> numbers) ; 
```

* * *

## 回答 #8

> 赞同：17
> 
> 时间：2008-11-03T16:34:59.980

使用 Vector 类型的局部变量来保存对象列表。除非需要同步，否则现在建议使用 List 实现，例如 ArrayList，因为此类提供更好的性能（因为它是不同步的）。

* * *

## 回答 #9

> 赞同：16
> 
> 时间：2009-03-09T13:18:02.650

直到 JDK 1.5 才引入格式化打印。所以不要使用：

```
String str = "test " + intValue + " test " + doubleValue; 
```

或使用 StringBuilder 的等价物，

一个可以使用

```
String str = String.format("test %d test %lg", intValue, doubleValue); 
```

从字符串连接和字符串构建器版本来看，后者更具可读性。我仍然发现人们采用这种风格的速度非常缓慢。例如，Log4j 框架不使用它，尽管我相信这样做会大大受益。

* * *

## 回答 #10

> 赞同：15
> 
> 时间：2008-11-03T16:40:56.537

从 Java 1.5 开始，自动装箱/拆箱自动处理原始类型和包装类型之间的显式转换（例如，整数到 int 或反之亦然）。

一个例子是

```
Integer myInteger = 6;
int myInt = myInteger.intValue(); 
```

可以简单地写成

```
Integer myInteger = 6;
int myInt = myInteger; 
```

但请注意 NullPointerExceptions :)

* * *

## 回答 #11

> 赞同：12
> 
> 时间：2008-11-03T15:19:21.413

Q1：嗯，最明显的情况是在泛型/类型特定的集合中。另一个立即浮现在脑海中的是改进的 for 循环，我觉得它看起来更干净，更容易理解。

Q2：一般来说，我一直将 JVM 捆绑在我的应用程序中，用于面向客户的应用程序。这使我们可以使用新的语言特性而不必担心 JVM 不兼容。

如果我不捆绑 JRE，出于兼容性原因，我可能会坚持使用 1.4。

* * *

## 回答 #12

> 赞同：12
> 
> 时间：2008-11-03T15:39:10.327

自 1.5 以来的一个简单更改，但有一点不同 - 在 Swing API 访问 JFrame 的 contentPane 中：

```
myframe.getContentPane().add(mycomponent); 
```

变成

```
myframe.add(mycomponent); 
```

当然，枚举的引入改变了许多过去使用常量的应用程序的行为方式。

String.format() 极大地改进了字符串操作，并且三元 if 语句在使代码更易于阅读方面非常有帮助。

* * *

## 回答 #13

> 赞同：11
> 
> 时间：2008-11-03T18:04:23.640

泛型集合使编码更能抵抗错误。老的：

```
Vector stringVector = new Vector();
stringVector.add("hi");
stringVector.add(528); // oops!
stringVector.add(new Whatzit());  // Oh my, could spell trouble later on! 
```

新的：

```
ArrayList<String> stringList = new ArrayList<String>();
stringList.add("hello again");
stringList.add(new Whatzit()); // Won't compile! 
```

* * *

## 回答 #14

> 赞同：11
> 
> 时间：2008-11-04T00:56:22.747

使用迭代器：

```
List list = getTheList();
Iterator iter = list.iterator()
while (iter.hasNext()) {
  String s = (String) iter.next();
    // .. do something
} 
```

或者有时会看到另一种形式：

```
List list = getTheList();
for (Iterator iter = list.iterator(); iter.hasNext();) {
  String s = (String) iter.next();
  // .. do something
} 
```

现在全部替换为：

```
List<String> list = getTheList();
for (String s : list) {
  // .. do something
} 
```

* * *

## 回答 #15

> 赞同：11
> 
> 时间：2009-03-08T04:00:31.967

虽然我承认静态导入很容易被过度使用，但我喜欢使用

```
import static Math.* ; 
```

在使用大量数学函数的类中。它确实可以减少代码的冗长。不过，我不会将它推荐给鲜为人知的图书馆，因为这会导致混乱。

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2008-11-03T15:26:43.020

将数字转换为字符串：

```
String s = n + ""; 
```

在这种情况下，我认为一直有更好的方法来做到这一点：

```
String s = String.valueOf(n); 
```

* * *

## 回答 #17

> 赞同：10
> 
> 时间：2009-06-14T07:38:42.860

将现有数组复制到新数组：

**Java 5 之前的版本**：

```
int[] src = new int[] {1, 2, 3, 4, 5};
int[] dest = new int[src.length];
System.arraycopy(src, 0, dest, 0, src.length); 
```

**爪哇6**：

```
int[] src = new int[] {1, 2, 3, 4, 5};
int[] dest = Arrays.copyOf(src, src.length); 
```

以前，我必须显式创建一个新数组，然后将源元素复制到新数组中（调用一个带有很多参数的方法）。现在，语法更简洁，新数组是从方法返回的，我不必创建它。顺便说一句，方法[Arrays.copyOf](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#copyOf(int[],%20int))有一个称为[Arrays.copyOfRange](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#copyOfRange(int[],%20int,%20int))的变体，它复制源数组的特定区域（很像[System.arraycopy](http://java.sun.com/javase/6/docs/api/java/lang/System.html#arraycopy(java.lang.Object,%20int,%20java.lang.Object,%20int,%20int))）。

* * *

## 回答 #18

> 赞同：8
> 
> 时间：2009-03-08T04:44:32.423

`for`用于迭代数组和集合的新-each 构造对我来说是最大的。

这些天来，每当我看到样板`for`循环使用索引变量逐个遍历数组时，我都想尖叫：

```
// AGGHHH!!!
int[] array = new int[] {0, 1, 2, 3, 4};
for (int i = 0; i < array.length; i++)
{
    // Do something...
} 
```

将上述内容替换为[`for`Java 5 中引入的构造](http://java.sun.com/j2se/1.5.0/docs/guide/language/foreach.html)：

```
// Nice and clean.    
int[] array = new int[] {0, 1, 2, 3, 4};
for (int n : array)
{
    // Do something...
} 
```

干净，简洁，最重要的是，它赋予代码*意义*，而不是展示*如何*做某事。

显然，代码具有迭代集合的意义，而不是`for`说如何迭代数组的旧循环。

此外，由于每个元素的处理独立于其他元素，因此可以允许将来对并行处理进行优化，而无需更改代码。（当然，只是猜测。）

* * *

## 回答 #19

> 赞同：7
> 
> 时间：2009-03-11T15:32:18.567

与[可变参数](https://stackoverflow.com/questions/258954/java-out-with-the-old-in-with-the-new/261297#261297)有关；从 Java 5 开始，采用可变参数参数的实用方法 [Arrays.asList()非常有用。](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#asList%28T...%29)

我经常发现自己在简化类似的东西

```
List<String> items = new ArrayList<String>();
items.add("one");
items.add("two");
items.add("three");
handleItems(items); 
```

通过使用

```
handleItems(Arrays.asList("one", "two", "three")); 
```

* * *

## 回答 #20

> 赞同：6
> 
> 时间：2009-08-18T23:10:58.743

注释

我想知道到目前为止没有人提到它，但是许多框架都依赖于注解，例如[Spring](http://www.springsource.org/)和[Hibernate。](https://www.hibernate.org/)如今，弃用 xml 配置文件而支持代码中的注释是很常见的（尽管这意味着在从配置迁移到元代码时失去了灵活性，但这通常是正确的选择）。最好的例子是 EJB 2（和更早版本）的比较到[EJB 3.0](http://www.oracle.com/technology/tech/java/newsletter/articles/simplifying_ejb3.html)以及如何通过注释简化 EJB 编程。

我发现注释与一些 AOP 工具（如 AspectJ 或 Spring AOP）结合起来也非常有用。这种组合可能非常强大。

* * *

## 回答 #21

> 赞同：5
> 
> 时间：2009-03-07T20:03:28.027

改变 JUnit 3 风格的测试：

```
class Test extends TestCase {
    public void testYadaYada() { ... }
} 
```

到 JUnit 4 风格的测试：

```
class Test {
   @Test public void yadaYada() { ... }
} 
```

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2009-09-17T21:49:44.653

改进的单例模式。从技术上讲，这些都包含在流行的答案枚举中，但它是一个重要的子类别。

```
public enum Singleton {
    INSTANCE;

    public void someMethod() {
        ...
    }
} 
```

比更清洁、更安全

```
public class Singleton {
    public static final Singleton INSTANCE = new Singleton();

    private Singleton() {
        ...
    }

    public void someMethod() {
        ...
    }
} 
```

* * *

## 回答 #23

> 赞同：3
> 
> 时间：2009-03-10T20:27:54.870

将类转换为使用泛型，从而避免出现不必要的强制转换的情况。

* * *

## 回答 #24

> 赞同：3
> 
> 时间：2009-03-10T20:42:01.280

如果这就是您对源代码树所做的所有事情，我会有点谨慎地按照这些思路进行重构。到目前为止，这些示例似乎并不是单独更改任何工作代码库的理由，但也许如果您要添加新功能，您应该利用所有新东西。

**归根结底，这些示例并没有真正删除样板代码**，它们只是使用更新的 JDK 更易于管理的结构来**制作漂亮的样板代码**。

大多数使代码优雅的方法不在 JDK 中。

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2009-03-10T21:08:08.487

好吧，现在轮到我被骂了。

我不推荐 90% 的这些更改。

并不是说将它们与新代码一起使用不是一个好主意，而是闯入现有代码以将 for 循环更改为 for(:) 循环只是浪费时间和破坏某些东西的机会。(IIWDFWI) 如果它有效，请不要修复它！

如果你在一家真正的开发公司工作，那么这种变化现在就变成了代码审查、测试和调试的事情。

如果有人无缘无故地进行这种重构导致了任何类型的问题，我会让他们无所适从。

另一方面，如果您在代码中并且无论如何都要更改该行的内容，请随时清理它。

还有，所有打着“性能”之名的建议，确实需要了解优化法则。就两个字，不要！曾经！（如果你不相信我，谷歌“优化规则”）。

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2009-05-30T16:48:15.587

使用 Swing 的新`DefaultRowSorter`功能对表格进行排序，而不是从头开始滚动您自己的表格。

* * *

## 回答 #27

> 赞同：2
> 
> 时间：2008-11-03T17:30:27.640

新版本的 Java 很少会破坏现有代码，因此只需保留旧代码并专注于新功能如何让您的生活更轻松。

如果您只是不理会旧代码，那么使用新功能编写新代码就没有那么可怕了。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2008-11-04T01:01:39.163

字符串比较，我遇到的真正的老派 Java 程序员会这样做：

```
String s1 = "...", s2 = "...";

if (s1.intern() == s2.intern()) {
    ....
} 
```

（据说是出于性能原因）

而现在大多数人只是这样做：

```
String s1 = "...", s2 = "...";

if (s1.equals(s2)) {
    ....
} 
```

* * *

## 回答 #29

> 赞同：1
> 
> 时间：2009-03-06T01:20:05.460

使用 Vector 而不是新的 Collections。

使用类而不是枚举

```
 public class Enum
  {
      public static final Enum FOO = new Enum();
      public static final Enum BAR = new Enum();
  } 
```

使用 Thread 而不是新的 java.util.concurrency 包。

[使用标记接口而不是注释](http://www.artima.com/weblogs/viewpost.jsp?thread=98061)

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2009-05-30T17:05:32.663

值得注意的是，Java 5.0 已经问世五年了，从那时起只有很小的变化。您必须处理非常旧的代码才能仍在重构它。

# .net - 如何在不获取 xmlns="..." 的情况下将对象序列化为 XML？

> ID：258960
> 
> 赞同：118
> 
> 时间：2008-11-03T15:17:56.487
> 
> 标签：.net, xml-serialization, xml-namespaces

有没有办法让我在 .NET 中序列化对象，而 XML 命名空间也不会自动序列化？似乎默认情况下 .NET 认为应该包含 XSI 和 XSD 命名空间，但我不希望它们在那里。

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2008-11-03T15:23:54.227

啊……没关系。提出问题后的搜索总是会产生答案。我正在序列化的对象是`obj`并且已经被定义。将具有单个空命名空间的 XMLSerializerNamespace 添加到集合中就可以了。

在VB中是这样的：

```
Dim xs As New XmlSerializer(GetType(cEmploymentDetail))
Dim ns As New XmlSerializerNamespaces()
ns.Add("", "")

Dim settings As New XmlWriterSettings()
settings.OmitXmlDeclaration = True

Using ms As New MemoryStream(), _
    sw As XmlWriter = XmlWriter.Create(ms, settings), _
    sr As New StreamReader(ms)
    xs.Serialize(sw, obj, ns)
    ms.Position = 0
    Console.WriteLine(sr.ReadToEnd())
End Using 
```

在 C# 中像这样：

```
//Create our own namespaces for the output
XmlSerializerNamespaces ns = new XmlSerializerNamespaces();

//Add an empty namespace and empty value
ns.Add("", "");

//Create the serializer
XmlSerializer slz = new XmlSerializer(someType);

//Serialize the object with our own namespaces (notice the overload)
slz.Serialize(myXmlTextWriter, someObject, ns); 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-02-12T01:19:05.353

如果您想摆脱多余的`xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"`and `xmlns:xsd="http://www.w3.org/2001/XMLSchema"`，但仍保留自己的命名空间`xmlns="http://schemas.YourCompany.com/YourSchema/"`，则使用与上面相同的代码，除了这个简单的更改：

```
//  Add lib namespace with empty prefix  
ns.Add("", "http://schemas.YourCompany.com/YourSchema/"); 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2016-09-28T02:28:54.867

如果您想删除命名空间，您可能还想删除版本，为了节省您的搜索，我添加了该功能，因此下面的代码将同时执行这两项操作。

我还将它包装在一个通用方法中，因为我正在创建非常大的 xml 文件，这些文件太大而无法在内存中序列化，因此我将输出文件分解并将其序列化为更小的“块”：

```
 public static string XmlSerialize<T>(T entity) where T : class
    {
        // removes version
        XmlWriterSettings settings = new XmlWriterSettings();
        settings.OmitXmlDeclaration = true;

        XmlSerializer xsSubmit = new XmlSerializer(typeof(T));
        using (StringWriter sw = new StringWriter())
        using (XmlWriter writer = XmlWriter.Create(sw, settings))
        {
            // removes namespace
            var xmlns = new XmlSerializerNamespaces();
            xmlns.Add(string.Empty, string.Empty);

            xsSubmit.Serialize(writer, entity, xmlns);
            return sw.ToString(); // Your XML
        }
    } 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-02-19T12:43:21.900

我建议这个助手类：

```
public static class Xml
{
    #region Fields

    private static readonly XmlWriterSettings WriterSettings = new XmlWriterSettings {OmitXmlDeclaration = true, Indent = true};
    private static readonly XmlSerializerNamespaces Namespaces = new XmlSerializerNamespaces(new[] {new XmlQualifiedName("", "")});

    #endregion

    #region Methods

    public static string Serialize(object obj)
    {
        if (obj == null)
        {
            return null;
        }

        return DoSerialize(obj);
    }

    private static string DoSerialize(object obj)
    {
        using (var ms = new MemoryStream())
        using (var writer = XmlWriter.Create(ms, WriterSettings))
        {
            var serializer = new XmlSerializer(obj.GetType());
            serializer.Serialize(writer, obj, Namespaces);
            return Encoding.UTF8.GetString(ms.ToArray());
        }
    }

    public static T Deserialize<T>(string data)
        where T : class
    {
        if (string.IsNullOrEmpty(data))
        {
            return null;
        }

        return DoDeserialize<T>(data);
    }

    private static T DoDeserialize<T>(string data) where T : class
    {
        using (var ms = new MemoryStream(Encoding.UTF8.GetBytes(data)))
        {
            var serializer = new XmlSerializer(typeof (T));
            return (T) serializer.Deserialize(ms);
        }
    }

    #endregion
} 
```

:)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2014-07-11T20:25:46.430

如果您无法摆脱每个元素的额外 xmlns 属性，则在从生成的类序列化为 xml 时（例如：使用**xsd.exe**时），那么您有类似的东西：

```
<manyElementWith xmlns="urn:names:specification:schema:xsd:one" /> 
```

然后我会和你分享对我有用的东西（以前的答案和我在[这里](http://blogs.msdn.com/b/dotnetinterop/archive/2006/01/06/prettification-of-xml-serialization-within-web-services.aspx)找到的混合）

*显式设置所有不同的 xmlns，如下所示：*

```
Dim xmlns = New XmlSerializerNamespaces()
xmlns.Add("one", "urn:names:specification:schema:xsd:one")
xmlns.Add("two",  "urn:names:specification:schema:xsd:two")
xmlns.Add("three",  "urn:names:specification:schema:xsd:three") 
```

*然后将其传递给序列化*

```
serializer.Serialize(writer, object, xmlns); 
```

*您将在根元素中声明三个命名空间，并且不再需要在其他元素中生成相应的前缀*

```
<root xmlns:one="urn:names:specification:schema:xsd:one" ... />
   <one:Element />
   <two:ElementFromAnotherNameSpace /> ... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-21T16:06:07.127

```
 XmlWriterSettings settings = new XmlWriterSettings
        {
            OmitXmlDeclaration = true
        };

        XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
        ns.Add("", "");

        StringBuilder sb = new StringBuilder();

        XmlSerializer xs = new XmlSerializer(typeof(BankingDetails));

        using (XmlWriter xw = XmlWriter.Create(sb, settings))
        {
            xs.Serialize(xw, model, ns);
            xw.Flush();
            return sb.ToString();
        } 
```

# sql-server-2000 - 如何确定可以在我的 SQL Server 2000 DB 上打开的最佳连接数？

> ID：258962
> 
> 赞同：2
> 
> 时间：2008-11-03T15:18:51.320
> 
> 标签：sql-server-2000

可以在 SQL Server 2000 DB 上打开的最佳连接数是多少。我知道在我之前工作的公司中，在带有 Oracle 8i、8 处理器机器的 tru 64 机器上，我们发现 8*12=96 个连接似乎是一个不错的数字。SQL Server 2000 是否有任何此类计算。数据库在 2 处理器（超线程 4）机器上运行。有很多针对数据库运行的事务。我问的原因是因为我们有一个应用程序通常倾向于打开大约 100 个连接，即使它没有做任何事情，我很难解释这可能是导致我们的性能问题的原因。也许，SQL Server 没有这样的限制......你们中的任何人都可以为此倾注一些智慧吗？非常感谢。谢谢，

我应该添加它是标准版。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2008-11-04T05:41:10.393

如果您不知道这是否是您的性能瓶颈，那么您应该尝试确定这一点，而不是尝试限制连接或其他东西。

如果你没有，你应该：

1.  使用 SQL Profiler 查找长时间运行的查询。
2.  监控您的数据库服务器的 CPU 负载、内存/页面文件使用情况和网络使用情况
3.  找到一个运行时间最长的查询（参见上面的#1）并编写一个非常精简的测试应用程序，它可以在峰值负载期间将此查询抛出到您的数据库服务器并记录一些响应时间。

如果 #1 和 #2 没有发现任何东西，并且 #3 显示您的数据库服务器在加载期间的响应时间很慢，那么您就知道您遇到了“连接太多”之类的问题。但是，如果您还没有完成#3，那么这样做似乎是可取的，因为处理连接限制等似乎只会造成人为的瓶颈，并不能真正让您找到问题的根源，IMO。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2008-11-03T15:35:03.830

MSDN 上的这篇博文表明没有限制 - 至少在 Express 版本中：http: [//blogs.msdn.com/euanga/archive/2006/03/09/545576.aspx](http://blogs.msdn.com/euanga/archive/2006/03/09/545576.aspx)

这表明它可能是 256，对于精简版 - [http://blogs.msdn.com/stevelasker/archive/2006/04/10/SqlEverywhereInfo.aspx](http://blogs.msdn.com/stevelasker/archive/2006/04/10/SqlEverywhereInfo.aspx)

这也表明没有限制：[http ://channel9.msdn.com/forums/TechOff/169030-The-difference-between-SQL-Server-2005-Express-and-Developer-Edition/?CommentID=299642](http://channel9.msdn.com/forums/TechOff/169030-The-difference-between-SQL-Server-2005-Express-and-Developer-Edition/?CommentID=299642)

**另外**- 从评论中， http: [//msdn.microsoft.com/en-us/library/aa196730](http://msdn.microsoft.com/en-us/library/aa196730(SQL.80).aspx) (SQL.80).aspx表示最大值为 32767，而没有“理想”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-04T05:59:29.700

您的性能问题不会由连接数引起。

除了sliderhouserules 的回答之外，作为快速解决方法，我建议关闭超线程而不是限制您的连接。 [link1](http://blogs.digineer.com/blogs/larar/archive/2006/11/13/maximum-degree-of-parallelism-and-hyperthreading.aspx) , [link2](http://blogs.msdn.com/slavao/archive/2005/11/12/492119.aspx)（注意：这个人在 MS SQL 2005 代码上工作）

每个连接都占用微不足道的内存量。共享数据库锁仅用于稳定性。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2008-11-04T03:29:22.080

如果应用程序是一个长时间运行的应用程序并且它在同一台服务器上，如果应用程序留下打开的数据库句柄并创建了一个锁，这对性能来说确实很糟糕。您可以检查 select * from sys.dm_tran_locks 或 sp_lock 之类的内容来给您一个想法。

# c++ - MFC 事件处理程序

> ID：258968
> 
> 赞同：1
> 
> 时间：2008-11-03T15:20:55.730
> 
> 标签：c++, windows, user-interface, mfc

只是想知道以以下为前缀的 MFC 控制消息之间的区别是：

```
LVN (e.g. LVN_ITEMCHANGED)
HDN (e.g. HDN_TRACK)
NM (e.g. NM_HOVER) 
```

此外，当用户使用 NM_CLICK 消息单击项目时，我正在使用 ListControl 并进行陷印。我还想在用户选择新项目时捕获一个键，例如向上/向下箭头键。谁能告诉我应该为此设置哪些信息？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T15:24:28.877

*   LVN = 列表视图通知
*   HDN = 标头控制通知
*   NM = er..um..“鼠标通知”？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2008-11-03T15:52:54.683

要更改选择，您需要处理 LVN_ITEMCHANGED 通知：

```
NMLISTVIEW & nm = *(NMLISTVIEW *) pnmh;
if (  (nm.uNewState ^ nm.uOldState) & LVIS_SELECTED) 
{     
   // nm.iItem was selected or deselected
   if (!m_internalUIChange)
   {
      // see below
   }
} 
```

第一个“if”检查“selected”状态是否已更改。请注意，当在列表中选择不同的项目时，它仍然会触发两次：一次用于取消选择旧项目，一次用于选择新项目。但是，这对于获取“完全取消选择”是必要的。

此通知经常触发 - 即使您以编程方式修改控件。如果您的处理程序应该只对用户事件做出反应，那么您至少需要一个在这些操作期间设置的标志（我为此使用了一个类和一个 RAII-Lock，所以我不会忘记重置它）

# .net - 如何避免自动附加到 T-SQL 以在 Visual Studio 2008 中进行调试？

> ID：258971
> 
> 赞同：4
> 
> 时间：2008-11-03T15:22:31.000
> 
> 标签：.net, visual-studio, visual-studio-2008, debugging, settings

在调试我正在处理的网站时，我倾向于使用 Attach to Process 而不是 F5 来开始调试（因为该站点已经在 Firefox 中运行）。但是，偶尔这样做时，我会收到以下错误：

> 对象“sp_sdidebug”、数据库“master”、所有者“dbo”的执行权限被拒绝。

我知道这是由于附加了 T-SQL 的调试器，而不仅仅是托管代码（有关该问题的进一步说明，请参阅[此博客文章）。](http://blogs.ipona.com/dan/archive/2006/09/29/6699.aspx)

我希望可以设置某处以避免首先附加到 T-SQL，而不是每次附加时都必须记住重置该设置。

所以，真正的问题是：**有谁知道我可以如何更改 Visual Studio 2008 的默认行为，以便通过调试菜单附加到进程时，它不会*自动*附加到 T-SQL，而只会附加到托管代码？也就是说，如何设置 Studio 以*记住*不附加到托管代码以外的任何内容？**

仅供参考，如果有项目特定的设置，我正在使用 C# Web 应用程序项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2008-11-03T15:29:07.570

您可以通过单击附加对话框中“附加到：”行上的“选择...”按钮来更改用于附加到进程的调试引擎。

选择“调试这些代码类型”选项而不是自动选项，并确保清除 T-SQL 选项。

我不知道如何将其设置为默认值，希望 Visual Studio 会记住它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2008-11-03T15:28:20.350

在项目的属性下（在解决方案资源管理器中选择项目：右键单击并选择属性；或按 Alt-F7；或按 Alt-Enter；或从菜单中选择项目/xxxx 属性），切换到 [ Debug] 选项卡，并取消选中“启用 SQl 调试”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2008-11-03T15:29:33.187

如果您在 VS 的服务器资源管理器中右键单击数据库连接，您应该会看到 2 个调试选项，确保它们没有被勾选。

同样在项目设置中，您可以更改是否启用 SQL 调试。

# .net - COM/Interop - 支持多个版本

> ID：258972
> 
> 赞同：3
> 
> 时间：2008-11-03T15:23:22.280
> 
> 标签：.net, visual-studio, interop, reference

我编写了一个 .NET 控制台应用程序，它包装了 CuteFTP 的传输引擎 - 一个 COM 对象 (ftpte)。我打包的版本是CuteFTP 7.0。我还想支持 8.0 版本，因为我集成的一些客户端具有该版本。

我在我的 Visual Studio 项目中有一个对 CuteFTP COM 对象的引用...如何引用 8.0 版组件并仍然支持 7.0 版？在我看来，我被迫在设计时做出选择，除非我做出更大的架构转变。

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2008-11-03T15:36:40.177

看看我的爱好开源项目[MS Office Wrapper for .NET](http://www.codeplex.com/msofficefornet)。使用了“后期绑定”，它允许您使用不同版本的 COM 库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2008-11-03T15:37:26.930

您需要参考您需要支持的最低版本，并且鉴于新版本不会更改 API，而只是添加新功能，您应该可以。但这显然取决于应用程序开发人员不破坏 API。

这样，您将错过新版本中添加的任何新功能，但至少旧功能应该可以工作。

# c# - C#4 中的 dynamic 关键字是否支持扩展方法？

> ID：258988
> 
> 赞同：44
> 
> 时间：2008-11-03T15:28:58.227
> 
> 标签：c#, dynamic, extension-methods, c#-4.0

我正在[听一个](http://channel9.msdn.com/shows/Going+Deep/Inside-C-40-dynamic-type-optional-parameters-more-COM-friendly/)关于**C#4**关键字的演讲`dynamic`，我想知道......这个功能是否会与其他 .NET 功能正交，例如它是否支持扩展方法？

```
public static class StrExtension {
    public static string twice(this string str) { return str + str; }
}
...
dynamic x = "Yo";
x.twice(); // will this work? 
```

* * *

**注意：**这个问题是在 C#4 发布之前提出的，这就是为什么它用将来时来表达。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2008-11-03T15:33:36.500

来自[“C# 4 中的新功能”word doc](http://code.msdn.microsoft.com/Project/Download/FileDownload.aspx?ProjectName=csharpfuture&DownloadId=3550)：

> 动态查找将无法找到扩展方法。扩展方法是否适用取决于调用的静态上下文（即出现哪些 using 子句），并且此上下文信息当前不作为有效负载的一部分保存。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-30T22:39:49.747

至少我觉得这很有趣......

```
public static class StrExtension
{
   public static string twice(this string str) { return str + str; }
}

...
dynamic x = "Yo";
StrExtension.twice(x); 
```

不过，如果编译器可以在编译时找到正确的扩展方法，那么我不明白为什么它不能打包一组扩展方法以在运行时查找？它就像一个用于非成员方法的 v-table。

编辑：

这很酷...... [http://www2.research.att.com/~bs/multimethods.pdf](http://www2.research.att.com/~bs/multimethods.pdf)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2008-11-20T17:53:19.980

它不能工作，扩展方法的工作取决于文件中包含的命名空间，据我所知，MSIL 不知道文件和包括命名空间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-01T17:17:36.313

*您可以为对象*创建扩展方法并将其分配给*动态*：

```
public static void MyExt(this object o) {
    dynamic d = o;
    d.myProp = "foo";
} 
```

并这样称呼它：

```
ClassWithMyProp x;
x.MyExt(); 
```

# .net - .NET 加密许可证密钥？

> ID：258994
> 
> 赞同：14
> 
> 时间：2008-11-03T15:31:13.293
> 
> 标签：.net, encryption, cryptography

我想创建一个许可证密钥，您会推荐哪种加密算法？

基本上输入将是：

> 公司名称
> 主要版本号
> 创建
> 日期 过期日期
> 有特征1：
> 有特征2：
> 有特征3：

例如 Acme Inc 5.0 20081102 20081102 0 1 0

相关：[哪种内置 .NET 加密算法最安全？](https://stackoverflow.com/questions/258721/which-built-in-net-crypotgraphy-algorithm-is-the-most-secure)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2008-11-04T13:18:13.217

我会建议：不要花太多时间来保护您的密钥。使用字节编译语言很容易反编译，只需让应用程序跳过验证步骤。无论您的密钥有多安全，当您的验证函数始终返回 true 时，它​​们都无关紧要。序列号的存在是为了让诚实的人保持诚实。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2008-11-03T18:11:16.917

如果您在客户端进行验证，则需要使用非对称加密。这样您就不必将私钥分发给客户。我将使用 SHA-256 和 2048 位密钥生成 RSA 签名。如果你这样做，加密操作将不是薄弱环节。破解者当然可以更改代码以跳过验证步骤，但没有任何加密算法可以帮助做到这一点。

如果您在服务器端进行验证，我会选择基于 SHA-256 的 HMAC。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-02-23T08:18:14.807

对于许可证密钥，您不是对加密它感兴趣，而是对它签名感兴趣。通过签名，您可以验证到期日期和启用的功能列表没有*被篡改*。无需隐藏（加密）许可证密钥，因为您不想通过向最终用户隐藏许可证来减轻威胁。

加密签名是通过散列许可证然后用私钥加密散列来完成的。由于任何人都可以使用相应的公钥解密该哈希，因此任何人都可以验证许可证是否被篡改。

用于签名和验证的基本 CryptoAPI 函数是[CryptSignHash](http://msdn.microsoft.com/en-us/library/aa380280%28VS.85%29.aspx)和[CryptVerifySignature](http://msdn.microsoft.com/en-us/library/aa381097%28VS.85%29.aspx)，请参阅[示例 C 程序：签名哈希和验证哈希签名](http://msdn.microsoft.com/en-us/library/aa382371%28VS.85%29.aspx)。

.Net Framework 等效项是[RSAPKCS1SignatureFormatter](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsapkcs1signatureformatter.aspx)和[RSAPKCS1SignatureDeformatter](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rsapkcs1signaturedeformatter.aspx)类。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2008-11-03T15:43:50.613

您的其他问题的答案在这里也很合适：[哪种内置 .NET 加密算法最安全？](https://stackoverflow.com/questions/258721/which-built-in-net-crypotgraphy-algorithm-is-the-most-secure)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-02-23T08:00:04.737

您需要做 4 件事：
第 1：校验和您的应用程序（MD5，带有自定义 md5 上下文）
- MD5 上下文需要加密初始化
- 比较私钥/公钥加密校验和
第 2：校验和您正在运行的应用程序的文本段
第 3：对许可证使用 4096 位 RSA 私钥公钥加密
4：加密任何关键字符串，如“错误密钥”或“密钥正常”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2008-11-07T14:14:10.077

如果您想查看三重 DES 加密的示例，可以查看我关于加密数据库中的数据的 [博客文章。](http://www.wrightin.gs/2008/11/how-to-encryptdecrypt-sensitive-column-contents-in-nhibernateactive-record-video.html)

博客文章包含视频和源代码。

虽然它专注于加密数据库中的字符串列，但您绝对可以修改它以使用许可字段。

源代码用 C# 编写并使用 Triple DES 算法。*******************************