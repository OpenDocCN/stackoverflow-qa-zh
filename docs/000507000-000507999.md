# StackOverflow 问答 000507000-000507999

# c# - 编写单元测试标准

> ID：507000
> 
> 赞同：11
> 
> 时间：2009-02-03T13:06:13.940
> 
> 标签：c#, visual-studio-2008, unit-testing, coding-style

我计划在我的团队中引入一套编写单元测试的标准。但是要包括什么？

这两篇文章（[单元测试命名最佳实践](https://stackoverflow.com/questions/155436/unit-test-naming-best-practices)和[单元/集成测试中文件系统依赖的最佳实践](https://stackoverflow.com/questions/377423/best-practices-for-file-system-dependencies-in-unit-integration-tests)）已经给了我一些思考的余地。

我的标准中应该涵盖的其他领域应该是如何设置测试类以及如何组织它们。例如，如果您有一个名为 OrderLineProcessor 的类，则应该有一个名为 OrderLineProcessorTest 的测试类。如果该类上有一个名为 Process() 的方法，那么应该有一个名为 ProcessTest 的测试（可能更多用于测试不同的状态）。

还有什么要包括的吗？

贵公司有单元测试标准吗？

编辑：我正在使用 Visual Studio Team System 2008 并在 C#.Net 中开发

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-03T14:27:54.353

看看[Michael Feathers 什么是单元测试](http://www.artima.com/weblogs/viewpost.jsp?thread=126923)（或者是什么让单元测试成为糟糕的单元测试）

看看“Arrange, Act, Assert”的想法，即测试只做三件事，按照固定的顺序：

*   **安排**测试所需的任何输入数据和处理类
*   执行被测**动作**
*   用一个或多个**断言**测试结果。是的，它可以是多个断言，只要它们都致力于测试所执行的操作。

查看[行为驱动开发](http://en.wikipedia.org/wiki/Behavior_Driven_Development)，了解一种使测试用例与需求保持一致的方法。

此外，我今天对标准文档的看法是，除非必须，否则不应该编写它们——已经编写了很多可用的资源。链接到他们，而不是重新散列他们的内容。为想要了解更多信息的开发人员提供阅读清单。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-03T13:11:40.293

您可能应该看看“实用单元测试”系列。 [这](https://rads.stackoverflow.com/amzn/click/com/0977616673)是 C# 版本，但还有另一个用于 Java。

关于您的规格，我*不会*过火。你有一个很好的开始——命名约定非常重要。我们还要求目录结构与原始项目匹配。覆盖范围还需要扩展到边界情况和非法值（检查异常）。这很明显，但是您的规范是为您将来不可避免地与不想测试传递非法值的人的那个人之间的争论写下来的地方。但是不要让规范超过几页，否则没有人会将它用于与上下文相关的任务。

更新：我不同意 Potato Head 先生关于每个单元测试只有一个断言的观点。这在理论上听起来不错，但在实践中，它要么导致大量冗余测试，要么导致人们在设置和拆卸中做大量工作，而这些工作*本身*应该被测试。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-04T11:44:13.450

我遵循 TDD 的 BDD 风格。见： [http ://blog.daveastels.com/files/BDD_Intro.pdf](http://blog.daveastels.com/files/BDD_Intro.pdf) [http://dannorth.net/introducing-bdd](http://dannorth.net/introducing-bdd) [http://behaviour-driven.org/Introduction](http://behaviour-driven.org/Introduction)

简而言之，这意味着

*   测试不被认为是“测试”，而是系统行为的规范（以下称为“规范”）。规范的目的不是验证系统在任何情况下都能正常工作。他们的目的是指定行为并推动系统的设计。

*   规范方法名称写成完整的英文句子。例如，球的规格可以包括“球是圆形的”和“当球击中地板时它会反弹”。

*   生产类和规范类之间没有强制的 1:1 关系（并且为每种生产方法生成测试方法将是疯狂的）。相反，系统行为和规范之间存在 1:1 的关系。

前段时间，我写了 TDD 教程（您开始使用提供的测试编写俄罗斯方块游戏），其中显示了这种编写测试的风格作为规范。您可以从[http://www.orfjackal.net/tdd-tutorial/tdd-tutorial_2008-09-04.zip](http://www.orfjackal.net/tdd-tutorial/tdd-tutorial_2008-09-04.zip)下载它该教程中仍然缺少有关如何执行 TDD/BDD 的说明，但示例代码已准备好，因此您可以查看测试的组织方式并编写通过测试的代码。

您会注意到，在本教程中，生产类被命名为 Board、Block、Piece 和 Tetrominoe，它们以俄罗斯方块游戏的概念为中心。但是测试类以俄罗斯方块游戏的行为为中心：FallingBlocksTest、RotatingPiecesOfBlocksTest、RotatingTetrominoesTest、FallingPiecesTest、MovingAFallingPieceTest、RotatingAFallingPieceTest 等。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-03T13:12:01.230

1.  尝试在每个测试方法中使用尽可能少的断言语句。这确保了测试的目的是明确定义的。
2.  我知道这会引起争议，但不要测试编译器——花时间测试 Java Bean 访问器和修改器最好花在编写其他测试上。
3.  尽可能尝试使用[TDD](http://en.wikipedia.org/wiki/Test-driven_development) ，而不是在代码之后编写测试。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-03T13:12:31.867

我发现大多数测试约定可以通过对所有测试使用标准基类来强制执行。强制测试人员覆盖方法，使它们都具有相同的名称。

我还提倡[Arrange-Act-Assert](http://www.lostechies.com/blogs/jimmy_bogard/archive/2008/07/24/arrange-act-assert-and-bdd-specifications.aspx) (AAA) 测试风格，因为您可以从测试中生成相当有用的文档。由于命名风格，它还迫使您考虑您期望的*行为。*

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-03T13:13:22.880

您可以在标准中添加的另一项是尝试保持单元测试的规模较小。那是实际的测试方法本身。除非您正在进行完整的集成单元测试，否则通常不需要大型单元测试，比如超过 100 行。如果您有很多设置可以进行一次测试，我会给您这么多。但是，如果你这样做，你应该重构它。

人们还谈论重构那里的代码，以确保人们意识到单元测试也是代码。所以重构，重构，重构。

我发现我所见过的使用中最大的问题是人们往往不会意识到你想让你的单元测试保持轻量和敏捷。毕竟，您不想要一个整体的野兽来进行测试。考虑到这一点，如果您有一种方法要尝试测试，则不应在一个单元测试中测试所有可能的路径。您应该有多个单元测试来说明通过该方法的每条可能路径。

是的，如果您正确地进行了单元测试，那么平均而言，单元测试代码的行数应该比您的应用程序多。虽然这听起来像是很多工作，但最终会在不可避免的业务需求变化时为您节省大量时间。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-03T13:15:57.087

功能齐全的 IDE 的用户会发现“其中一些”对以特定模式创建测试有非常详细的支持。给定这个类：

```
public class MyService {
    public String method1(){
        return "";
    }

    public void method2(){

    }

    public void method3HasAlongName(){

    }
} 
```

当我在 intellij IDEA 中按 ctrl-shift-T 时，我在回答 1 个对话框后得到了这个测试类：

```
public class MyServiceTest {
    @Test
    public void testMethod1() {
        // Add your code here
    }

    @Test
    public void testMethod2() {
        // Add your code here
    }

    @Test
    public void testMethod3HasAlongName() {
        // Add your code here
    }
} 
```

因此，在编写标准之前，您可能需要仔细查看工具支持。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-03T15:47:07.283

我的单元测试函数名称使用近乎简单的英语。有助于定义他们的确切工作：

```
TEST( TestThatVariableFooDoesNotOverflowWhenCalledRecursively )
{
/* do test */
} 
```

我使用 C++，但命名约定可以在任何地方使用。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-03-12T23:36:43.420

确保包括不是单元测试的内容。请参阅：[在单元测试方面什么不应该测试？](https://stackoverflow.com/questions/109432/what-not-to-test-when-it-comes-to-unit-testing/110403#110403)

包括一个指南，以便清楚地识别集成测试并且可以与单元测试分开运行。这很重要，因为如果单元测试与其他类型的测试混合在一起，您可能会以一组非常慢的“单元”测试结束。

检查此以获取更多信息：[如何改进我的 junit 测试](https://stackoverflow.com/questions/589603/how-can-i-improve-my-junit-tests/589620#589620)......特别是第二次更新。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-03T13:12:00.123

如果您使用的是 Junit 家族的工具（OCunit、SHunit、...），那么测试的名称已经遵循一些规则。

对于我的测试，我使用自定义的[doxygen](http://www.doxygen.nl/)标签来将他们的文档收集到特定的页面中。

# python - 使用 django mptt 的问题

> ID：507006
> 
> 赞同：1
> 
> 时间：2009-02-03T13:09:04.073
> 
> 标签：python, django, mptt, django-mptt

我在实现 django mptt 时遇到问题。

这是我的模型：

```
 class Company(models.Model):
       name = models.CharField( max_length=100)
       parent = models.ForeignKey('self', null=True, blank=True, related_name='children')

   mptt.register(Company, order_insertion_by=['name']) 
```

和

```
class Financials(models.Model):
    company = models.ForeignKey(Company, related_name="financials")
    year = models.IntegerField()
    revenue = models.DecimalField(max_digits = 10, decimal_places = 2) 
```

所以我正在研究的是如何将财务作为一个孩子添加到公司。我尝试`mptt.register(Financials, parent = Company)`了这当然会给我错误。

所以 mytree 结构将是：

```
company1
....................> Financial1
--------------------> Financial 2

company2
-------------------->Financial 3 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T17:37:51.270

Django-mptt 不支持同一树中的多种类型的对象。您*可以*让 Financial 和 Company 都从同一个父类继承，然后根据该父类的实例构建树。您需要在父类上存储一个“内容类型”字段，以便您可以将父类的实例转换为正确的子类。这是一个严重的黑客攻击，因为它违反了继承的精神。财务不是公司，它是公司的属性。正确的答案是修复您的 ACL 设计，以便您可以使用 ForeignKey。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-11T17:53:56.263

我推荐 django-polymorphic_tree

# language-agnostic - 有哪些方法可以限制对 Web 系统中一组机器的访问？

> ID：507007
> 
> 赞同：0
> 
> 时间：2009-02-03T13:09:22.890
> 
> 标签：language-agnostic

我的银行网站有一个安全功能，可以让我注册允许进行银行交易的机器。如果有人窃取了我的密码，他将无法从他的计算机上转移我的钱。只有我的个人电脑可以从我的账户进行交易。所以...

**有哪些方法可以限制对 Web 系统中一组机器的访问？**

换句话说，如何在 Web 服务器中识别发出 http 请求的计算机？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T14:10:01.503

为什么不在授权主机的证书存储中或在可以插入任何所需计算机的智能卡等加密令牌中使用客户端证书？

**更新：**您应该考虑到唯一标识计算机意味着获得相对较低级别的东西，无法访问嵌入在 html 页面中的代码（Javascript，未签名的小程序或 activeX），除非您在所需的计算机上安装了某些东西（或执行签名的东西，如小程序或 activeX）。

每台计算机唯一的一件事是以太网卡的 MAC 地址，它在每台相当现代（而不是那么现代）的计算机上几乎无处不在。然而，这还不够安全，因为许多卡都允许更改其 MAC 地址。

Pentium III 曾经在 CPU 内部有一个唯一的序列号，非常适合您的使用。缺点是由于大多数用户的隐私问题，没有更新的 CPU 配备这样的东西。

您还可以结合计算机的许多元素，例如 CPU id（型号、速度等）、主板型号、硬盘空间、安装的内存等。我认为 Windows XP 曾经收集此类信息以提供*哈希值*以唯一标识计算机以用于激活目的。

**更新 2：**硬盘还带有可以通过软件检索的序列号。[这](http://www.codeproject.com/KB/cs/hard_disk_serialno.aspx)是一个如何获取它以用于激活目的的示例（您的情况）。但是，如果某人将 HD 带到另一台计算机上，它将起作用。尽管如此，您仍然可以将它与来自计算机的更多独特数据（例如我之前所说的 MAC 地址）结合起来。我还将添加一个为用户生成的唯一密钥，并将其保存在您自己的数据库中（可以从服务器在线检索）以及其余部分，以提供标识系统的[哈希函数](http://en.wikipedia.org/wiki/Cryptographic_hash_function)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T13:32:39.143

如果您正在寻找发出帐户创建请求的计算机的 IP 地址，您可以轻松地从请求中提取它。在 ASP.NET 中，您将使用：

字符串 IPAddress = Request.UserHostAddress;

然后，您可以将其与帐户记录一起存储，并且只接受来自该 IP 地址的该帐户的登录。当然，问题在于这根本不适用于公共站点。大多数人都是通过动态分配 IP 地址的 ISP 来的。即使使用始终在线的 Internet 连接，ISP 也会偶尔断开连接并重新打开连接，从而导致 IP 地址发生变化。

无论如何，这就是你要找的吗？

更新：如果您要注册特定的计算机，您是否考虑过使用 cookie？当然，缺点是有人可能会清除他们的 cookie，从而“取消注册”他们的计算机。问题是，网络只能访问您的计算机（不多），因此没有万无一失的“注册”计算机的方法。即使您安装了 ActiveX 控件，他们也可以卸载或删除它（尽管这比 cookie 更持久）。最后，您总是必须为最终用户提供*一些*重新注册的方法。而且，如果您这样做，那么您还不如登录。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T13:40:07.413

你真的安装了什么吗？

除了 Mark Brittingham 提到的关于 IP 地址的内容之外，我想如果您安装了某些东西，那么只有您的银行计算机和您的计算机才知道的某种哈希码可以工作。但是，如果您一开始就没有非常强的密码，那么什么会阻止某人“注册”他们的计算机来窃取您的钱呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T14:05:12.933

我猜你的银行是通过使用受信任的小程序来做到这一点的——我的银行曾经有类似的方法（老实说，我认为这有点麻烦——现在他们正在使用类似计算器的代码生成器）。受信任的小程序可以访问您的文件系统，因此它可以将某种标识符写入您系统上的文件并稍后检索它。

[使用可信小程序的教程。](http://www.developer.com/java/data/article.php/3303561)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-03T14:18:16.900

我正在考虑使用[Gears](http://gears.google.com/)在本地存储一个哈希值来标记计算机已注册。

# asp.net-mvc - 从非控制器类添加到 TempData

> ID：507019
> 
> 赞同：4
> 
> 时间：2009-02-03T13:14:08.340
> 
> 标签：asp.net-mvc

如何从非控制器类添加到 TempData 字典？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-08T01:56:50.197

你**不需要**[ControllerContext](http://msdn.microsoft.com/en-us/library/system.web.mvc.controllercontext%28v=vs.118%29.aspx) ，你只需要当前的[HttpContext](http://msdn.microsoft.com/en-us/library/system.web.mvc.controllercontext.httpcontext%28v=vs.118%29.aspx)。

而且您不需要传递任何内容，您可以创建一个新的[SessionStateTempDataProvider](http://msdn.microsoft.com/en-us/library/system.web.mvc.sessionstatetempdataprovider%28v=vs.118%29.aspx)并使用它，因为此类的 SaveTempData 方法所做的唯一事情就是在当前会话中的特定键上设置一个 IDictionary。

（如果您的应用程序没有使用任何自定义[ITempDataProvider](http://msdn.microsoft.com/en-us/library/system.web.mvc.itempdataprovider%28v=vs.118%29.aspx)。如果这样做，您显然必须依赖它。）

*SessionStateTempDataProvider*是一个非常简单的类：

```
// Copyright (c) Microsoft Corporation. All rights reserved. See License.txt in the project root for license information.

using System.Collections.Generic;
using System.Web.Mvc.Properties;

namespace System.Web.Mvc
{
    public class SessionStateTempDataProvider : ITempDataProvider
    {
        internal const string TempDataSessionStateKey = "__ControllerTempData";

        public virtual IDictionary<string, object> LoadTempData(ControllerContext controllerContext)
        {
            HttpSessionStateBase session = controllerContext.HttpContext.Session;

            if (session != null)
            {
                Dictionary<string, object> tempDataDictionary = session[TempDataSessionStateKey] as Dictionary<string, object>;

                if (tempDataDictionary != null)
                {
                    // If we got it from Session, remove it so that no other request gets it
                    session.Remove(TempDataSessionStateKey);
                    return tempDataDictionary;
                }
            }

            return new Dictionary<string, object>(StringComparer.OrdinalIgnoreCase);
        }

        public virtual void SaveTempData(ControllerContext controllerContext, IDictionary<string, object> values)
        {
            if (controllerContext == null)
            {
                throw new ArgumentNullException("controllerContext");
            }

            HttpSessionStateBase session = controllerContext.HttpContext.Session;
            bool isDirty = (values != null && values.Count > 0);

            if (session == null)
            {
                if (isDirty)
                {
                    throw new InvalidOperationException(MvcResources.SessionStateTempDataProvider_SessionStateDisabled);
                }
            }
            else
            {
                if (isDirty)
                {
                    session[TempDataSessionStateKey] = values;
                }
                else
                {
                    // Since the default implementation of Remove() (from SessionStateItemCollection) dirties the
                    // collection, we shouldn't call it unless we really do need to remove the existing key.
                    if (session[TempDataSessionStateKey] != null)
                    {
                        session.Remove(TempDataSessionStateKey);
                    }
                }
            }
        }
    }
} 
```

因此我们可以这样做：

```
var httpContext = new HttpContextWrapper(HttpContext.Current);
var newValues = new Dictionary<string, object> {{"myKey", myValue}};
new SessionStateTempDataProvider().SaveTempData(new ControllerContext { HttpContext = httpContext }, newValues); 
```

请注意，这每次都会覆盖现有的 Dictionary，因此如果要按顺序添加数据，显然必须依赖中间容器或编写一些额外的逻辑来将现有值与新值合并。

我需要这样做的情况是错误页面处理，我在其中进行重定向，但我需要在控制器范围之外保留临时数据的逻辑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T03:17:25.127

您必须将 TempDataDictionary 传递给其他类。我经常这样做，只要其他类与演示相关（听起来像是），它就没有任何问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-13T08:38:23.247

ControllerBase.TempData 属性

System.Web.Mvc.TempDataDictionary

您可以使用 public TempDataDictionary **TempData** { get; 放; }

使用**TempData**

**例如像 TempData.Clear(); // 清除其他类中的 TempData**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T13:19:10.607

为此，您需要当前的控制器上下文，否则您不能。

ViewContext.Controller.TempData["whatever"] = 不管

# eclipse - 存储在 Eclipse Ganymede WTP 项目的元数据中的特定 JRE 名称（在其他计算机上可能不同）

> ID：507022
> 
> 赞同：2
> 
> 时间：2009-02-03T13:14:25.267
> 
> 标签：eclipse, eclipse-wtp, ganymede

## 问题概述：

将 Eclipse Ganymede 与 Web 工具平台一起使用时，项目将依赖于我使用的确切 JRE 名称。名称在其他开发者机器上可能不同，如何最好地解决这个问题，以便许多开发者可以在项目上一起工作？

## 详细问题描述：

我正在使用 Eclipse Ganymede 和**Web 工具平台**（因为它是面向 Java EE 开发人员的 Eclipse IDE 的一部分），并且我创建了一个**Dynamic Web Project**。

我安装了一个 JRE，即 Sun JRE for Java SE 6。在 Eclipse 中，我可以选择： *Window / Preferences / Java / Installed JREs*。我可以看到 JRE 的列表，每一行都有*Name*、*Location*和*Type*列。

我在列表中只有一个条目，它有： *Name* =java-6-sun-1.6.0.07 *Location* =/usr/lib/jvm/java-6-sun-1.6.0.07 *Type=*Standard VM。

问题是我的 JRE 的名称是在两个 Eclipse 项目元数据文件中指定的，它们是**.classpath**和**.settings/org.eclipse.jst.common.project.facet.core.prefs**。

我想将我的项目检查到版本控制中，以供其他开发人员检查和工作，但我认为我不能确定他们有一个与我*完全相同名称*的 JRE 。

违规文件的内容：

**.classpath**：（倒数第二个类路径条目是有问题的标签。）

```
<?xml version="1.0" encoding="UTF-8"?>
<classpath>
        <classpathentry kind="src" path="src/main/java"/>
        <classpathentry kind="src" path="src/main/resources"/>
    <classpathentry kind="src" path="src/test/java"/>
    <classpathentry kind="con" path="org.apache.ivyde.eclipse.cpcontainer.IVYDE_CONTAINER/?ivyXmlPath=ivy.xml&amp;confs=*">
        <attributes>
            <attribute name="org.eclipse.jst.component.dependency" value="/WEB-INF/lib"/>
        </attributes>
    </classpathentry>
    <classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/java-6-sun-1.6.0.07"/>
    <classpathentry kind="output" path="target/eclipse/classes"/>
</classpath> 
```

**.settings/org.eclipse.jst.common.project.facet.core.prefs**：

```
#Mon Feb 02 13:29:53 CET 2009
classpath.helper/org.eclipse.jdt.launching.JRE_CONTAINER\:\:org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType\:\:java-6-sun-1.6.0.07/owners=jst.java\:6.0
eclipse.preferences.version=1 
```

* * *

**签入此项目并让其他开发人员签入并运行/更改它的最佳方式是什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T13:18:08.207

选择执行环境而不是要使用的 JRE。为此，请进入您的项目 -> 属性 -> Java 构建路径 -> 库。选择“JRE System Library”元素，单击“Edit...”并选择您选择的执行环境（对于您的示例，可能是“JavaSE-1.6”）。

.classpath 文件将包含如下条目：

```
<classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/JavaSE-1.6"/> 
```

# jsf - 带有选项卡式浏览的 JSF 会话范围 bean

> ID：507029
> 
> 赞同：3
> 
> 时间：2009-02-03T13:16:27.647
> 
> 标签：jsf, tabs, richfaces, ajax4jsf

我们有以下问题...

**应用环境：**

JSF、Richfaces、a4J

**考虑有以下情况：**

*   用户登录系统
*   用户导航到一个新页面，该页面由一个包含 a4j 组件的 a4j 表单组成，用户填写表单但不提交。
*   用户打开一个新选项卡并打开相同的 URL 并用新数据填写新表单
*   用户返回到他的第一个选项卡并提交信息（注意：所有 bean 都定义为会话范围）

**结果：**

提交的信息是来自第二个选项卡但从第一个选项卡提交的信息，只要将 bean 定义为会话范围，这是预期的。

**问题：**

我们需要获取请求范围的行为（即：尽管 bean 被定义为会话范围，但将新选项卡作为新请求处理）。

**笔记：**

当将 bean 范围定义为请求范围时，来自同一表单中各个组件的部分 Ajax 响应会重置其他组件，因为它们尚未提交。

有什么建议么 ？

--

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T17:54:26.183

这是 Web 应用程序的一个众所周知的问题。

当然，您可以尝试使用更多自定义代码来解决这个问题，但我的快速建议是使用正好解决这个问题的[seam 框架](http://www.seamframework.org/)。

Seam 是 JSF 的超集，`conversation scope`它为 bean 引入了一个新的功能，可以完全满足您的需求。

Seam 本身就支持richfaces（两者都是JBoss/Redhat 的项目），所以你不应该期望集成有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T15:02:00.350

bean 需要在会话范围内的原因是什么？

如果这只是为了获得 ajax 功能，那么您可以将 bean 更改为请求并使用[a4j:keepAlive](http://www.jboss.org/file-access/default/members/jbossrichfaces/freezone/docs/tlddoc/a4j/keepAlive.html)标记。

a4j:keepAlive 扩展了请求范围 bean 的生命周期，然后您的 bean 实例就像在 ajax 请求的会话范围内一样。当用户打开两个相同的页面时，他们正在使用两个不同的 bean 实例。

# php - PHP中的CRC8检查

> ID：507041
> 
> 赞同：2
> 
> 时间：2009-02-03T13:22:38.353
> 
> 标签：php, checksum, crc

如何在 PHP 中生成 CRC-8 校验和？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T21:14:34.530

它必须是CRC8吗？

在 PHP.net 上有一个非常简单的[CRC16实现和](http://php.net/manual/en/function.crc32.php#86628)[CRC32](http://php.net/crc32)的本机版本。

如果它确实必须是 CRC8，我建议从 Marius 指出的维基百科页面上的伪代码中编写一些东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-04-03T21:57:54.890

```
function crcnifull ($dato, $byte)
{
  static $PolyFull=0x8c;

  for ($i=0; $i<8; $i++)
  {
    $x=$byte&1;
    $byte>>=1;
    if ($dato&1) $byte|=0x80;
    if ($x) $byte^=$PolyFull;
    $dato>>=1;
  }
  return $byte;
}

function crc8 (array $ar,$n=false)
{
  if ($n===false) $n=count($ar);
  $crcbyte=0;
  for ($i=0; $i<$n; $i++) $crcbyte=crcnifull($ar[$i], $crcbyte);
  return $crcbyte;
} 
```

要将此函数用于二进制字符串，您必须先将二进制字符串转换为数组。可以这样实现：

```
function sbin2ar($sbin)
{
  $ar=array();
  $ll=strlen($sbin);
  for ($i=0; $i<$ll; $i++) $ar[]=ord(substr($sbin,$i,1));
  return $ar;
} 
```

示例如何使用整个东西：

```
$crc8=crc8(sbin2ar($packet)); 
```

# c++ - VC++ 资源编辑器问题？

> ID：507042
> 
> 赞同：2
> 
> 时间：2009-02-03T13:23:02.160
> 
> 标签：c++, visual-studio-2005, resource-files

我有一个在 VS2005 上工作的 C++ 项目，我做了一个小改动，导致了一个问题，我不知道它是什么以及如何解决，我使用 VS2005 RC 编辑器在资源文件中添加了一个新的字符串条目（默认在VS2005）但编译后我得到两个编译错误

1.  错误 22 错误 RC2135：找不到文件：BEGIN f:\Projects\C++\TIP Project\SmartFeeder\FeederService\FeederService.rc 54

2.  错误 23 错误 RC2135：找不到文件：0x0064 f:\Projects\C++\TIP Project\SmartFeeder\FeederService\FeederService.rc 55

当我走到这些线路时，我发现

```
1 11 
BEGIN
    0x0001, 0x0000, 0x0064, 0x0000, 0x0064, 0x0000, 0x0010, 0x0000, 0x0010, 
    0x0001, 0x0025, 0x0031, 0x000d, 0x000a, 0x0000, 0x0000
END 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T13:56:28.427

您的资源类型 11 是错误的。这意味着 RT_MESSAGETABLE，资源编译器尝试加载 .mc 文件。选择其他东西，例如 99 或 MYCUSTOMRESOURCE

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T13:37:19.760

检查 rc 文件是否使用与应用程序其余部分相同的编码（ASCII 或 unicode）。有关详细信息，请参阅此[论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/2f5ce42f-0547-4ad9-868f-49df5ecbc858/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T13:40:57.753

听起来资源文件已经搞砸了。尽管没有更多文件，但很难准确诊断...如果您有更改之前的备份，请还原它并尝试再次添加字符串。如果您遇到同样的问题，您所能做的就是将其报告给 Microsoft 并尝试发明一种解决方法。

就我个人而言，我从不使用字符串资源，而是将重要的字符串保存在每种语言的单独文件中（使用带有自定义转义的纯文本），所以我不是专家......虽然在尝试使用第三方资源编译器时我确实遇到了类似的问题，由于丢失包含文件。

# c++ - 从构造函数调用虚函数

> ID：507043
> 
> 赞同：2
> 
> 时间：2009-02-03T13:23:04.360
> 
> 标签：c++, inheritance, constructor, virtual-functions, overriding

也许我错了，但这似乎是一个非常基本的问题。突然我的继承链停止工作。编写一个小的基本测试应用程序证明是我错了（所以我不能责怪编译器）。

我有一个基类，在虚函数中具有默认行为。子类从中派生并更改行为。

```
#include <iostream>

class Base
{
public:
    Base() { print(); }
    ~Base() {}

protected:
    virtual void print() { std::cout << "base\n"; }
};

class Child : public Base
{
public:
    Child() {}
    ~Child() {}

protected:
    virtual void print() { std::cout << "child\n"; }
};

int main()
{
    Base b;
    Child c;
} 
```

这打印：

```
base
base 
```

创建 Child 实例时，为什么要调用 Base::print()？我认为通过使用 virtual 关键字，可以将函数替换为派生类。

我在什么时候让自己感到困惑？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-03T13:25:03.527

您在构造函数中调用了一个虚方法，该方法不起作用，因为子类尚未完全初始化。

另请参阅[此 StackOverflow 问题](https://stackoverflow.com/questions/496440/c-virtual-function-from-constructor)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T14:39:17.903

尽管您当前的问题是其他人提到的构造函数的虚拟方法调用，但我注意到您没有将析构函数设为虚拟。这通常是一件坏事。在您的情况下，析构函数是 nop 并且没有成员是具有析构函数的对象，......但是如果您的代码发生更改，那么很容易发生坏事。

# macos - 直接访问 OSX 中的键盘事件

> ID：507044
> 
> 赞同：8
> 
> 时间：2009-02-03T13:23:48.537
> 
> 标签：macos

我正在寻找对 OS X 中原始键盘事件的应用程序范围的访问，或者使用 Cocoa 或 Carbon 框架（或任何底层 API，就此而言）。我知道我可以覆盖 NSApplication 的 sendEvent: 以获取原始键盘信息，但是对于元键（命令、控制、备用、移位等）不会显示为击键事件。我正在寻找类似于 Microsoft 的 DirectInput 框架的东西。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-03T16:17:09.360

我认为相当于 DirectInput 的是 HID Manager。HID 代表“人机接口设备”，HID Manager（有时称为 HIDLib）是 HID 的低级 API：键盘、鼠标和操纵杆。

Leopard 有一个新的 HID Manager API，记录在[Technical Note TN2187](http://developer.apple.com/technotes/tn2007/tn2187.html)中。Leopard 之前的 API 记录在[HID 类设备接口指南](http://developer.apple.com/documentation/DeviceDrivers/Conceptual/HID/)中。[我围绕较旧的 API DDHidLib](http://www.dribin.org/dave/software/#ddhidlib)编写了一个 Objecive-C 包装器，您可能会发现它很有用。Leopard API*要*好得多。如果可以的话，我会直接使用它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-03T16:34:12.727

Core Graphics 框架还包含一些有用的功能，作为远程​​操作系统的一部分。查找 CGRemoteOperation.h，并查看[Quartz Events 参考](http://developer.apple.com/documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html)。

您可以使用 Quartz Events 系统来安装特定于应用程序或系统范围的“事件点击”，它可以让您在相当低的级别上监视和注入键盘和鼠标事件。几年前，特定于应用程序的事件点击存在一些错误，但希望现在已经解决了。

我认为 HID 的东西主要用于驱动程序开发，所以如果您只是为您的应用程序寻找工具，HID 可能是矫枉过正。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-12-29T11:23:30.120

`NSResponder`派生类有一个方法`-(void)flagsChanged`：当元键被按下时被调用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T13:39:19.787

您可以使用 RegisterHotKeyEvent Carbon 功能，但我不确定您是否可以显式注册任何元键。

博客文章[Program Global Hotkeys in Cocoa 轻松](http://dbachrach.com/blog/2005/11/28/program-global-hotkeys-in-cocoa-easily/)解释了如何做到这一点。

# wpf - 如何在 MVVM 模式中保持模型和视图模型之间的一致性？

> ID：507045
> 
> 赞同：8
> 
> 时间：2009-02-03T13:24:03.903
> 
> 标签：wpf, mvvm

**问题陈述**

我正在编写一个非常基本的 WPF 应用程序来更改配置文件的内容。数据格式是带有架构的 XML 文件。我想把它作为一个MVVM的学习项目，所以我把代码适当的分成

*   **模型**：从 xsd.exe 自动生成的 C# 类

*   **View-Model**：模型的视图友好表示。

*   **查看**：Xaml 和后面的空代码

我了解 View-Model 如何使 View-binding 变得轻而易举。但是，这不是让 View-Model <-> Model 语义非常尴尬吗？Xsd.exe 为多个 XML 元素生成带有数组的 C# 类。但是，在 V-VM 级别，您需要 Observable Collections。

**问题：**

这真的意味着我必须保持两个完全不同的集合类型一致地表示相同的数据吗？

保持模型和视图模型之间一致性的最佳实践是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T13:33:38.627

我不是一个大专家，但我认为是的。总体思路确实是通过 Binding 在视图和 viewModel 之间传播更改，然后通过事件（在 Model -> ViewModel 方向）或依赖关系（在另一个方向）在 ViewModel 和 Model 之间传播更改。

我不知道这有多标准，但我对 MVVM 的理解是 ViewModel 应该持有对模型的引用，以便当用户修改视图时，ViewModel 应该调用模型上的适当代码。反过来说，Model 在修改时应该引发事件，并且 ViewModel 应该相应地更新自身（ViewModel 是模型的观察者）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T13:52:34.347

@这真的意味着我必须保持两种完全不同的集合类型一致地表示相同的数据吗？

我想是的。这很无聊，但效果很好。希望将来我们还会有一个代码生成器来创建 ViewModel 部分。

[卡尔](http://karlshifflett.wordpress.com)正在努力：http: [//karlshifflett.wordpress.com/mvvm/](http://karlshifflett.wordpress.com/mvvm/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T18:11:25.213

您显然需要在视图模型中使用 ObservableCollections，所以，是的，您需要在模型和视图模型中使用两种完全不同的集合类型。

我已经完成了一篇关于在 MVVM 中执行撤消/重做的文章，您可以在其中找到可能的解决方案。它使用我称之为**MirrorCollection**的东西：一个 ObservableCollection 派生类女巫自动从 List（模型列表）中获取他的项目。

我认为这是一个有趣的解决方案，您可以在此处找到文章

[第 1 部分：使用 Viewmodel 模式在 WPF 中提供 Undo / Redo](http://blog.notifychanged.com/2009/01/30/using-the-viewmodel-pattern-to-provide-undo-redo-in-wpf/)

[第 2 部分：视图建模列表](http://blog.notifychanged.com/2009/01/30/viewmodelling-lists/)（这里是 MirrorCollection 定义）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-16T02:12:02.523

在模型中公开事件或委托并在 ViewModel 中挂钩相同，当模型中的值发生更改时，通过事件或委托通知 viewmodel，您可以从 Viewmodel 更新 UI。

如果您想将其从视图模型更新到模型，那么只需调用一些方法即可传递新值

# asp.net - 如何在 TreeView 中获取 TreeNode 的 ClientID？

> ID：507051
> 
> 赞同：1
> 
> 时间：2009-02-03T13:25:53.557
> 
> 标签：asp.net, javascript, treeview

如何使用服务器端或客户端代码根据其呈现的属性之一（例如，它的标题属性（在我的情况下它是唯一的））在 TreeView 中获取 TreeNode 的 ClientID？

我使用此代码，但它不起作用，有什么建议吗？

```
 // Retrieves TreeNode ClientID.
    function GetTreeNodeID(nodeTitle)
    {                            
        var treeNodes = document.getElementById('tvMenu').childNodes;
        var treeLinks;

        for(var i=0 ; i<treeNodes.length ; i++)
        {                                                
            treeLinks = treeNodes[i].getElementsByTagName('a');                        
            for(var j=0 ; j<treeLinks.length ; j++)
            {                                        
                if(nodeTitle == treeLinks[j].title && treeLinks[j].title != "");
                {                        
                    alert("Par: " + nodeTitle);
                    alert("Title: " + treeLinks[j].title);
                    return treeLinks[j].id;
                }
            }
        }
    } 
```

* * *

问题中提到的上述代码总是返回根节点的 id，有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T13:43:43.367

innerText 或 innerHtml 或 textContent ？您使用哪种浏览器？

```
 function GetTreeNodeID(nodeInnerText)
        {                            
            var tree = document.getElementById('tvMenu');
            var treeLinks =  tree.getElementsByTagName('A');    

            for(var element in treeLinks )
            {                                             

                if((nodeInnerText == treeLinks[element].innerText) && (treeLinks[element].innerText != ""))
                    {                        
                        alert("Par: " + nodeInnerText);
                        alert("innerText: " + treeLinks[element].title);
                        return treeLinks[element].id;
                    }

            }
        } 
```

[在此处](https://developer.mozilla.org/fr/DOM/element.getElementsByTagName)查找示例代码。

# c# - Convert.ChangeType 并转换为枚举？

> ID：507059
> 
> 赞同：70
> 
> 时间：2009-02-03T13:28:47.653
> 
> 标签：c#, enums, changetype

我`Int16`从数据库中获得了一个值，需要将其转换为枚举类型。不幸的是，这是在代码层中完成的，除了它可以通过反射收集的内容之外，它对对象知之甚少。

因此，它最终调用`Convert.ChangeType`失败并出现无效的强制转换异常。

我发现了我认为很臭的解决方法，如下所示：

```
String name = Enum.GetName(destinationType, value);
Object enumValue = Enum.Parse(destinationType, name, false); 
```

有没有更好的方法，这样我就不必通过这个 String 操作了？

这是一个简短但完整的程序，如果有人需要进行实验，可以使用它：

```
using System;

public class MyClass
{
    public enum DummyEnum
    {
        Value0,
        Value1
    }

    public static void Main()
    {
        Int16 value = 1;
        Type destinationType = typeof(DummyEnum);

        String name = Enum.GetName(destinationType, value);
        Object enumValue = Enum.Parse(destinationType, name, false);

        Console.WriteLine("" + value + " = " + enumValue);
    }
} 
```

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2009-02-03T13:41:00.377

`Enum.ToObject(....`就是你要找的！

**C＃**

```
StringComparison enumValue = (StringComparison)Enum.ToObject(typeof(StringComparison), 5); 
```

**VB.NET**

```
Dim enumValue As StringComparison = CType([Enum].ToObject(GetType(StringComparison), 5), StringComparison) 
```

如果您进行大量 Enum 转换，请尝试使用以下类，它将为您节省大量代码。

```
public class Enum<EnumType> where EnumType : struct, IConvertible
{

    /// <summary>
    /// Retrieves an array of the values of the constants in a specified enumeration.
    /// </summary>
    /// <returns></returns>
    /// <remarks></remarks>
    public static EnumType[] GetValues()
    {
        return (EnumType[])Enum.GetValues(typeof(EnumType));
    }

    /// <summary>
    /// Converts the string representation of the name or numeric value of one or more enumerated constants to an equivalent enumerated object.
    /// </summary>
    /// <param name="name"></param>
    /// <returns></returns>
    /// <remarks></remarks>
    public static EnumType Parse(string name)
    {
        return (EnumType)Enum.Parse(typeof(EnumType), name);
    }

    /// <summary>
    /// Converts the string representation of the name or numeric value of one or more enumerated constants to an equivalent enumerated object.
    /// </summary>
    /// <param name="name"></param>
    /// <param name="ignoreCase"></param>
    /// <returns></returns>
    /// <remarks></remarks>
    public static EnumType Parse(string name, bool ignoreCase)
    {
        return (EnumType)Enum.Parse(typeof(EnumType), name, ignoreCase);
    }

    /// <summary>
    /// Converts the specified object with an integer value to an enumeration member.
    /// </summary>
    /// <param name="value"></param>
    /// <returns></returns>
    /// <remarks></remarks>
    public static EnumType ToObject(object value)
    {
        return (EnumType)Enum.ToObject(typeof(EnumType), value);
    }
} 
```

现在`(StringComparison)Enum.ToObject(typeof(StringComparison), 5);`你可以简单地写而不是写`Enum<StringComparison>.ToObject(5);`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-21T13:58:10.273

基于@Peter的回答，这里是转换的`Nullable<int>`方法`Enum`：

```
public static class EnumUtils
{
        public static bool TryParse<TEnum>(int? value, out TEnum result)
            where TEnum: struct, IConvertible
        {
            if(!value.HasValue || !Enum.IsDefined(typeof(TEnum), value)){
                result = default(TEnum);
                return false;
            }
            result = (TEnum)Enum.ToObject(typeof(TEnum), value);
            return true;
        }
} 
```

在许多情况下使用`EnumUtils.TryParse<YourEnumType>(someNumber, out result)`变得有用。例如，Asp.NET 中的 WebApi 控制器没有针对无效枚举参数的默认保护。Asp.NET 将只使用值，`default(YourEnumType)`即使某些通过`null`、`-1000`、或完全忽略该参数。此外，在所有这些情况下都有效，因此解决方案之一是使用带有自定义检查的类型`500000``"garbage string"``ModelState``int?`

```
public class MyApiController: Controller
{
    [HttpGet]
    public IActionResult Get(int? myEnumParam){    
        MyEnumType myEnumParamParsed;
        if(!EnumUtils.TryParse<MyEnumType>(myEnumParam, out myEnumParamParsed)){
            return BadRequest($"Error: parameter '{nameof(myEnumParam)}' is not specified or incorrect");
        }      

        return this.Get(washingServiceTypeParsed);            
    }
    private IActionResult Get(MyEnumType myEnumParam){ 
       // here we can guarantee that myEnumParam is valid
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-28T14:12:41.660

如果您将枚举存储在 DataTable 中，但不知道哪一列是枚举，哪一列是字符串/整数，则可以通过以下方式访问该值：

```
foreach (DataRow dataRow in myDataTable.Rows)
{
    Trace.WriteLine("=-=-=-=-=-=-=-=-=-=-=-=-=-=-=");
    foreach (DataColumn dataCol in myDataTable.Columns)
    {
        object v = dataRow[dataCol];
        Type t = dataCol.DataType;
        bool e = false;
        if (t.IsEnum) e = true;

        Trace.WriteLine((dataCol.ColumnName + ":").PadRight(30) +
            (e ? Enum.ToObject(t, v) : v));
    }
} 
```

# perl - 如果我要在 Perl 中使用纯 OO，是否需要 Exporter？

> ID：507062
> 
> 赞同：4
> 
> 时间：2009-02-03T13:29:18.370
> 
> 标签：perl, oop, module, perl-module, exporter

文档（Exporter 和 perlmodlib）说：

> 作为一般规则，如果模块尝试面向对象，则不导出任何内容。

但是 perlmodlib 也说：

> 标准的捆绑模块都应该在命名空间污染方面以明确定义的方式运行，因为它们使用 Exporter 模块。

所以我想知道，如果你去OO并且什么都不导出，你真的需要Exporter吗？如果你不这样做，这是否意味着没有一个标准模块在这个意义上是严格的面向对象的，或者这是否意味着它们`EXPORT_OK`有些东西，因为如果有人想从你的模块继承，你需要这样做？（这是真的吗？）或者您是否需要 Exporter 才能做到`use MyModule; ... = new MyModule`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T13:56:10.237

你是对的。如果一切都被称为 OBJECT::sub() 或 $obj->sub()，你应该没问题。

对于继承，您将需要使用@ISA，为此，您不需要导出器。

此外，您给出的第二个引用是关于导出数据注入模块的。

如果您使用：`use libname ();`针对使用 Exporter 导出的库，则可以保证不导出任何内容。这就是它可以用来防止命名空间污染的方式。如果您通过函数名称显式导出，则这些是您获得的唯一函数。

# sql - mysql格式化日期

> ID：507063
> 
> 赞同：1
> 
> 时间：2009-02-03T13:30:40.990
> 
> 标签：sql, mysql

我正在尝试这个查询：

```
SELECT ARTICLE_NO, 
    USERNAME, 
    ACCESSSTARTS, 
    ARTICLE_NAME, 
    date_format( ACCESSSTARTS, '%d %m %Y' ) AS shortDate 
FROM AUCTIONS 
WHERE upper( ARTICLE_NAME ) LIKE '%hardy%' 
LIMIT 0 , 10; 
```

哪个工作正常，但 shortDate 为空，我不确定为什么。

数据库的内容是这样的：

```
ARTICLE_NO    USERNAME     ACCESSSTARTS          ARTICLE_NAME  shortDate
110313660559  banger-wear  17.11.2008 13:24:56   acolshirt     NULL 
```

编辑：accessstarts 字段不是日期时间字段，而是 varchar。我不确定该怎么做。我是否应该在 ACCESSSTARTS 中的第一个空格之后简单地删除所有内容以仅显示日期？

或者将列转换为日期时间字段会更好，如果是这样，我将如何指定它应该采用 %D.%M.%Y 格式而不是默认格式，默认以 %Y 开头

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T13:34:26.020

ACCESSSTARTS 的格式看起来像您拥有的日期是一个 varchar，但 DATE_FORMAT 需要一个 DATE 或 DATETIME 值。

您可以尝试先使用[STR_TO_DATE](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_str-to-date)将该字符串转换为日期值，例如

```
SELECT 
   ACCESSSTARTS, 
   date_format(str_to_date(ACCESSSTARTS, '%d.%m.%Y %k:%i:%s'), '%d %m %Y' ) AS shortDate
FROM AUCTIONS 
WHERE upper( ARTICLE_NAME ) LIKE '%hardy%' 
LIMIT 0 , 10; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T13:43:54.410

ACCESSSTARTS 看起来像一个字符串类型的列而不是日期时间。尝试更换你的

```
date_format( ACCESSSTARTS, '%d %m %Y' ) 
```

这样：

```
date_format(str_to_date(ACCESSSTARTS, '%d.%m.%Y %H:%i:%S'), '%d %m %Y'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T13:37:56.327

17.11.2008 13:24:56 似乎不是有效的 mysql 日期。您是否将该列存储为日期，如果是，是否有任何格式应用于该日期。您可以使用 STR_TO_DATE 的组合将字符串格式转换为日期，然后在日期上使用 DATE_FORMAT 来实现结果。

# nant - 构建失败执行 nan

> ID：507064
> 
> 赞同：1
> 
> 时间：2009-02-03T13:30:54.687
> 
> 标签：nant, build-script

我有一个 nant 构建脚本（.86 beta），它告诉我这个：

> 构建失败
> 
> 无法初始化“Microsoft .Net Framework 2.0”目标框架。
> 
> 该进程无法访问文件“C:\Users\cconway\AppData\Local\Temp\tmp25E3.tmp”，因为它正被另一个进程使用。

这个文件甚至在我的机器上都不存在。有谁知道这是什么原因？重新启动似乎允许我成功运行脚本一次，但之后每次我都会收到此消息（尽管每次重新启动时 tmp 文件的名称都会更改）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T13:37:01.040

是否有任何第三方任务可能使临时文件处于打开状态或继续在后台运行，从而使文件处于锁定状态？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T15:22:40.997

也许尝试[sysinternals 进程监视器](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)，它可以让您查看拥有此文件句柄的进程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T21:56:52.963

此外，请确保您安装了所有正确版本的 .Net 并且它们是正确的（SDK 与运行时）。如果你打开 nant 的配置文件，你可以看到它期望 .net 版本在哪里去检查以确保它在那里并且你可以看到 hte 编译器方法（csc、vbc 等）。所以它可能有一些东西试图找到它，但它不存在或路径已关闭。

它是测试版，因此配置文件中甚至可能存在拼写错误。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-16T01:36:11.060

答案是我的防病毒软件。我应该先尝试禁用它！一旦我禁用它，一切都像一个魅力。

希望这可以帮助某人。

# java - Lightweight Webservice producing in Java (without an application server)

> ID：507073
> 
> 赞同：12
> 
> 时间：2009-02-03T13:35:33.007
> 
> 标签：java, web-services

Is there any Java library allowing to build a simple standalone webservice server without any application server framework?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-03T14:04:43.633

Java 6 contains JAX-WS, which makes it very easy to host a web service in a stand-alone application:

```
javax.xml.ws.Endpoint.publish("http://localhost:8000/myService/", myServiceImplementation); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-03T14:13:24.053

[Axis 2](http://ws.apache.org/axis2/) has a simple standalone server (see [http://ws.apache.org/axis2/1_4_1/installationguide.html](http://ws.apache.org/axis2/1_4_1/installationguide.html))

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T15:00:31.370

[Simple](http://www.simpleframework.org:Simple) is the fastest and lightest NIO web server you will find in the Java world. About twice as fast as Jetty and a quarter the size.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T14:42:31.983

[Jetty](http://eclipse.org/jetty/) can be run embedded in a java application. Have a look at it.

# unit-testing - 测试测试？

> ID：507077
> 
> 赞同：7
> 
> 时间：2009-02-03T13:36:43.100
> 
> 标签：unit-testing, automated-tests

我主要花时间在 win32 和 .NET 应用程序的自动化测试上，这需要我们大约 30% 的时间来编写和 70% 的维护。我们一直在寻找减少维护时间的方法，并且已经转移到一个可重用的测试库，该库涵盖了我们软件的大部分关键组件。此外，我们正在进行一些工作，以使我们的库达到可以使用[基于关键字的测试](http://www.devbistro.com/articles/Testing/Keyword-Based-Test-Automaton)的状态。

我一直在考虑对我们的测试库进行单元测试，但我想知道这是否值得花时间。我是软件单元测试的坚定支持者，但我不确定如何处理测试代码。

你认为自动化的 Gui 测试库应该进行单元测试吗？还是只是浪费时间？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-03T13:52:09.637

首先，我发现将单元测试视为“可执行规范”而不是测试非常有用。我写下我希望我的代码做什么，然后实现它。我从编写单元测试中获得的大部分好处是它们推动了实现过程并集中了我的思考。它们可重复用于测试我的代码这一事实几乎是一个令人愉快的巧合。

测试测试似乎只是解决问题而不是解决问题的一种方式。谁来测试测试测试的测试？TDD 用来确保测试真正有用的“技巧”是让它们首先失败。这可能也是您可以在这里使用的东西。编写测试，看到它失败，然后修复代码。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-03T13:47:08.443

我不认为你应该对你的单元测试进行单元测试。

但是，如果您已经编写了自己的测试库，带有自定义断言、键盘控制器、按钮测试器或其他任何东西，那么可以。您应该编写单元测试来验证它们是否都按预期工作。

例如，NUnit 库经过单元测试。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-03T13:53:08.790

从理论上讲，它*是*软件，因此应该进行单元测试。如果您正在滚动自己的单元测试库，特别是，您将希望随时对其进行单元测试。

但是，您的主要软件系统的实际单元测试永远不会增长到足以需要单元测试的程度。如果它们太复杂以至于*需要*进行单元测试，那么您需要对软件进行一些认真的重构，并注意简化单元测试。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-03T13:53:31.910

您可能想看[看谁测试了测试](http://haacked.com/archive/2007/03/12/who-tests-the-tests.aspx)。

> **简短的回答是代码测试测试，测试测试代码。**
> 
> 嗯？
> 
> **测试原子钟**
> 让我从一个类比开始。假设你带着原子钟旅行。你怎么知道时钟校准正确？
> 
> 一种方法是向您的邻居询问原子钟（因为每个人都随身携带一个）并比较两者。如果他们同时报告，那么你有很高的信心他们都是正确的。
> 
> 如果它们不同，那么您就知道其中一个是错误的。
> 
> 所以在这种情况下，如果你问的唯一问题是“我的时钟给出的时间是否正确？”那么你真的需要第三个时钟来测试第二个时钟和第四个时钟来测试第三个吗？如果全部不是。避免堆栈溢出！

IMPO：这是你有多少时间和你想拥有多少质量之间的权衡。

*   如果我要使用自制的测试仪，如果时间允许，我会测试它。
*   如果它是我使用的第三方工具，我希望供应商已经对其进行了测试。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-03T13:44:55.453

确实没有理由可以/不应该对您的库进行单元测试。有些部分可能太难正确地进行单元测试，但其中大部分可能可以毫无问题地进行单元测试。

对这种代码进行单元测试实际上可能特别有益，因为您希望它既可靠又可重用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-04T11:13:41.217

测试测试代码，代码测试测试。当您以两种不同的方式（一次在测试中，一次在代码中）说出相同的意图时，它们都出错的可能性非常低（除非需求已经错误）。这可以与会计师使用的双重记账法相提并论。见[http://butunclebob.com/ArticleS.UncleBob.TheSensitivityProblem](http://butunclebob.com/ArticleS.UncleBob.TheSensitivityProblem)

[最近在http://blog.objectmentor.com/articles/2009/01/31/quality-doesnt-matter-that-much-jeff-and-joel](http://blog.objectmentor.com/articles/2009/01/31/quality-doesnt-matter-that-much-jeff-and-joel)的评论中讨论了同样的问题

* * *

关于您的问题，是否应该测试 GUI 测试库...如果我理解正确，您正在制作自己的测试库，并且您想知道是否应该测试您的测试库。是的。为了能够依赖库正确报告测试，您应该进行测试以确保库不报告任何误报或误报。不管测试是单元测试、集成测试还是验收测试，至少应该有一些测试。

通常在编写完代码之后再编写单元测试为时已晚，因为那样代码往往会更加耦合。单元测试迫使代码更加解耦，因为否则小单元（一个类或一组密切相关的类）无法单独测试。

当代码已经写好时，通常你可以只添加集成测试和验收测试。它们将在整个系统运行的情况下运行，因此您可以确保功能正常工作，但覆盖每个极端情况和执行路径比单元测试更难。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-11T02:50:13.200

Kent Beck 的“测试驱动开发：通过示例”一书中有一个单元测试框架的测试驱动开发示例，因此当然可以测试您的测试。

我没有使用过 GUI 或 .NET，但是您对单元测试有什么顾虑？

您是否担心它在正常运行时可能会将目标代码描述为不正确？我想这是一种可能性，但如果发生这种情况，您可能能够检测到。

或者您是否担心它可能将目标代码描述为正常运行，即使它不是？如果您对此感到担心，那么[突变测试](http://en.wikipedia.org/wiki/Mutation_testing)可能就是您所追求的。变异测试会更改正在测试的部分代码，以查看这些更改是否会导致任何测试失败。如果没有，那么要么代码没有运行，要么代码的结果没有被测试。

如果您的系统上没有可用的突变测试软件，那么您可以手动进行突变，方法是自己破坏目标代码并查看它是否会导致单元测试失败。

如果您正在构建一套不依赖于特定应用程序的单元测试产品，那么也许您应该构建一个可以在其上运行测试软件并确保它获得预期的失败和成功的简单应用程序。

突变测试的一个问题是它不能确保测试涵盖程序可能遇到的所有潜在场景。相反，它只确保目标代码预期的场景都经过测试。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-07-19T15:48:18.260

我们通常使用这些经验法则：

1) 所有产品代码都有单元测试（与产品代码类和功能紧密对应）和单独的功能测试（按用户可见的特性排列）

2) 不要为 .NET 控件或第三方库等第三方代码编写测试。例外情况是，如果您知道它们包含您正在解决的错误。对此的回归测试（当 3rd 方错误消失时失败）将在升级到 3rd 方库修复错误时提醒您，这意味着您可以删除您的解决方法。

3) 单元测试和功能测试本身并没有被直接测试过——除了使用 TDD 程序在产品代码之前编写测试，然后运行测试以观察它失败。如果你不这样做，你会*惊讶于意外编写**总是*通过的测试是多么容易。理想情况下，您将一次执行您的产品代码，并在每次更改后运行测试，以便查看测试中的每个断言都失败，然后执行并开始通过。然后你会看到下一个断言失败。通过这种方式，您的测试确实得到测试，但仅在编写产品代码时进行。

4）如果我们从单元测试或功能测试中提取代码——创建一个用于许多测试的测试库，那么我们会对所有这些进行单元测试。

这对我们很有帮助。我们似乎一直 100% 遵守这些规则，我们对我们的安排非常满意。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2010-06-19T21:32:40.530

## 回答

是的，应该测试您的 GUI 测试库。

例如，如果您的库提供了一个**Check**方法来根据二维数组验证网格的内容，您希望确保它按预期工作。

否则，用于测试网格必须接收特定数据的业务流程的更复杂的测试用例可能不可靠。如果您的**Check**方法中的错误导致误报，您将很快找到问题所在。但是，如果它产生误报，那么您将面临严重的麻烦。

要测试您的**CheckGrid**方法：

*   使用已知值填充网格
*   使用填充的值调用**CheckGrid方法**
*   **如果这种情况通过， CheckGrid**至少有一个方面可以工作。
*   对于第二种情况，您希望**CheckGrid**方法报告测试失败。
*   您如何表示期望的细节将取决于您的 xUnit 框架（请参阅稍后的示例）。但基本上，如果**CheckGrid**没有报告测试失败，那么测试用例本身一定会失败。
*   最后，您可能需要针对特殊情况多做几个测试用例，例如：空网格、网格大小与数组大小不匹配。

您应该能够为大多数框架修改以下 dunit 示例，以测试**CheckGrid**是否正确检测到错误：

```
begin
  //Populate TheGrid
  try
    CheckGrid(<incorrect values>, TheGrid);
    LFlagTestFailure := False;
  except
    on E: ETestFailure do
      LFlagTestFailure := True;
  end;
  Check(LFlagTestFailure, 'CheckGrid method did not detect errors in grid content');
end; 
```

让我重申一下：应该测试您的 GUI 测试库；诀窍是——你如何有效地做到这一点？

TDD 流程建议您在实际**实施****之前**首先弄清楚您打算如何**测试**新功能。原因是，如果你不这样做，你经常会发现自己摸不着头脑，不知道如何验证它是否有效。将测试用例改造到现有的实现上是极其困难的。

 ****## 边注

你说的一件事让我有点困扰......你说需要“70％的时间来维护（你的测试）”

这对我来说听起来有点不对，因为理想情况下你的测试应该很简单，并且如果你的接口或规则发生变化，它们本身应该只需要改变。

我可能误解了你，但我的印象是你不写“生产”代码。否则你应该对测试代码和生产代码之间的切换周期有更多的控制，以减少你的问题。

一些建议：

*   注意非确定性值。例如，日期和人工键可能会对某些测试造成严重破坏。你需要一个明确的策略来解决这个问题。（另一个答案本身。）
*   您需要与“生产开发人员”密切合作，以确保您正在测试的接口的各个方面能够稳定下来。即，他们需要了解您的测试如何识别 GUI 组件并与之交互，这样他们就不会通过“不影响它们”的更改任意破坏您的测试。
*   在前一点上，如果在进行更改时运行自动化测试会有所帮助。
*   您还应该警惕太多简单地归结为任意排列的测试。例如，如果每个客户都有一个类别 A、B、C 或 D；然后 4 个“新客户”测试（每个类别 1 个）为您提供 3 个额外的测试，这些测试并不能真正告诉您比第一个测试更多，并且“难以”维护。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-03T14:12:58.097

就个人而言，我不会对我的自动化库进行单元测试，而是针对基线的修改版本运行它们以确保所有检查点都能正常工作。这里的原则是我的自动化主要用于回归测试，例如当前运行的结果与预期结果相同（通常这等同于上次运行的结果）。通过针对一组经过适当修改的预期结果运行测试，所有测试都应该失败。如果他们没有，您的测试套件中有错误。这是从突变测试中借来的一个概念，我发现它非常适合检查 GUI 自动化套件。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-10-25T14:51:08.327

从您的问题中，我可以理解您正在构建一个关键字驱动框架来执行自动化测试。在这种情况下，始终建议对常用和 GUI 实用功能进行一些白盒测试。由于您对在您的库中对每个 GUI 测试功能进行单元测试感兴趣，请继续努力。测试总是好的。这不是浪费时间，我将其视为您框架的“增值”。

您还提到了处理测试代码，如果您指的是测试方法，请将执行类似工作的不同功能/模块分组，例如：GUI 元素验证（存在）、GUI 元素输入、GUI 元素读取。对不同的元素类型进行分组，并为每个组执行类型单元测试方法。您可以更轻松地跟踪测试。干杯!

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-02-12T22:58:39.100

我建议测试测试是一个好主意，并且必须做一些事情。只需确保您为测试应用程序而构建的内容并不比应用程序本身更复杂。如前所述，即使在构建自动化功能测试时，TDD 也是一种好方法（我个人不会那样做，但无论如何它是一种好方法）。对测试代码进行单元测试也是一种好方法。恕我直言，如果您要自动化 GUI 测试，请继续进行任何可用的手动测试（您应该有步骤、原始场景、预期结果等），确保它们通过。然后，对于您可能创建且尚未手动编写脚本的其他测试，对它们进行单元测试并遵循 TDD 方法。（那么如果你有时间，你可以对其他的进行单元测试）。最后，关键字驱动，是，IMO，

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2014-02-28T22:41:55.663

You may want to explore a mutation testing framework ( if you work with Java : check out [PIT Mutation Testing](http://pitest.org/) ). Another way to assess the quality of your unit testing is to look at reports provided by tools such as [SonarQube](http://www.sonarqube.org/) ; the reports include various [coverage metrics](http://en.wikipedia.org/wiki/Code_coverage);

# asp.net - 带有 Asp.net Ajax 问题的 Masterpage

> ID：507087
> 
> 赞同：1
> 
> 时间：2009-02-03T13:40:06.290
> 
> 标签：asp.net, asp.net-ajax

我把 scritmanager 放到母版页上。“脚本管理器1”

母版页中有一个更新面板显示总计。“更新面板1”

在内容页面中，我嵌套了列表视图。“listview1”中的“listview2”有一个带有名为“addtoTotal”的链接按钮的itemtemplate

当用户单击 addtoTotal 按钮时，我想更新 masterpage 中的 updatepanel1。

updatepanel1 的更新模式是有条件的。

我怎样才能做到这一点。

首先我找不到control addtoTotal 链接按钮。

其次如何注册此按钮以更新 updatepanel1

我想从内容页面触发条件更新面板。

我试图做这样的事情

protected void Page_Load(object sender, EventArgs e) { ScriptManager1.RegisterAsyncPostBackControl(myControl);

}

我不能。因为我不知道在哪里写这个 RegisterAsyncPostBackControl 代码。我找不到控制链接按钮。我不确定我试图解决这个问题的方法是否正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T17:02:41.387

您可以在您的母版页上放置一个更新面板的子例程，您可以像这样从内容页面调用它。

```
 Public Partial Class _Default1
        Inherits System.Web.UI.MasterPage

        Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

        End Sub
        Public Sub updatedpage()
             updatepanel1.update()
        End Sub
    End Class

    Public Partial Class _Default5
        Inherits System.Web.UI.Page
        Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
            If Not IsPostBack Then
                LoadData()
            End If
            CType(Me.Master, _Default1).updatedpage()
        End Sub
    End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T13:45:38.323

为了找到 addtoTotal 按钮，我相信您必须在后面的代码中执行以下操作

```
 ListView listview2 = (ListView)listview1.FindControl("listview2"); 
 LinkButton addtoTotal = (LinkButton)listview2.FindControl("addtoTotal"); 
```

您应该能够在第一个 listview 中找到 listview2，然后在 listivew2 中找到 LinkBut​​ton

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-09T14:01:27.307

我不太确定我是否理解您的问题，但在我看来，[这篇](http://www.asp.net/learn/master-pages/tutorial-06-vb.aspx)文章应该为您指明正确的方向

# c# - Web服务调用的多线程性能问题

> ID：507089
> 
> 赞同：4
> 
> 时间：2009-02-03T13:40:53.543
> 
> 标签：c#, performance, multithreading, service

这是我的 Web 服务服务器端和客户端的示例程序。我遇到了一个奇怪的性能问题，即即使我增加调用 Web 服务的线程数，性能也没有提高。同时，任务管理器性能面板的CPU/内存/网络消耗较低。我想知道瓶颈是什么以及如何改进它？

（我的测试经验，双倍的线程数几乎会使总响应时间翻倍）

客户端：

```
class Program
{
    static Service1[] clients = null;
    static Thread[] threads = null;

    static void ThreadJob (object index)
    {
        // query 1000 times
        for (int i = 0; i < 100; i++)
        {
            clients[(int)index].HelloWorld();
        }
    }

    static void Main(string[] args)
    {
        Console.WriteLine("Specify number of threads: ");
        int number = Int32.Parse(Console.ReadLine());

        clients = new Service1[number];
        threads = new Thread[number];

        for (int i = 0; i < number; i++)
        {
            clients [i] = new Service1();
            ParameterizedThreadStart starter = new ParameterizedThreadStart(ThreadJob);
            threads[i] = new Thread(starter);
        }

        DateTime begin = DateTime.Now;

        for (int i = 0; i < number; i++)
        {
            threads[i].Start(i);
        }

        for (int i = 0; i < number; i++)
        {
            threads[i].Join();
        }

        Console.WriteLine("Total elapsed time (s): " + (DateTime.Now - begin).TotalSeconds);

        return;
    }
} 
```

服务器端：

```
 [WebMethod]
    public double HelloWorld()
    {
        return new Random().NextDouble();
    } 
```

提前谢谢，乔治

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T20:33:42.413

尽管您正在创建一个多线程客户端，但请记住，.NET 有一个可配置的瓶颈，即对单个主机进行 2 次同时调用。这是设计使然。请注意，这是在客户端上，而不是在服务器上。

尝试在客户端调整您的 app.config 文件：

```
<system.net>
<connectionManagement>
    <add address=“*” maxconnection=“20″ />
</connectionManagement></system.net> 
```

[这篇简短的文章](http://basildoncoder.com/blog/2007/12/15/turbocharging-net-webservice-clients/)中有更多关于此的信息：

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-03T13:52:30.117

我的经验通常是锁定是问题所在：我曾经有一个大规模并行服务器，它在上下文切换上花费的时间比执行工作的时间多。

所以 - 检查你在 perfmon 中的内存和进程计数器，如果你查看上下文切换及其高（每秒超过 4000 次），那么你就有麻烦了。

您还可以检查服务器上的内存统计信息 - 如果它花费所有时间交换，或者只是创建和释放字符串，它似乎也会停止。

最后，检查磁盘 I/O，原因同上。

解决方案是移除您的锁，或将它们保持最短时间。我们的问题通过消除对 COM BSTR 及其全局锁的依赖得到解决，您会发现 C# 有很多类似的同步瓶颈（旨在让您的代码安全工作）。当我将一个简单的 C# 应用程序从单核移到多核盒时，我看到了性能下降。

如果您无法移除锁，最好的选择是不要创建尽可能多的线程 :) 使用线程池来让 CPU 在开始另一项工作之前完成一项工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T07:11:46.353

我不相信你实际上遇到了瓶颈。

你试过我的建议了吗？

您的想法是添加更多线程以提高性能，因为您希望所有线程都能完美地并行运行。这就是为什么您假设线程数加倍不应使总测试时间加倍的原因。

您的服务需要几分之一秒才能返回，并且您的线程不会在客户端上的完全相同的时刻开始工作。

因此，您的线程实际上并没有像您假设的那样完全并行工作，并且您看到的结果是可以预期的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-18T19:56:25.297

您没有看到任何性能提升，因为没有任何提升。无论如何，您的服务中的一行代码（如下）可能在大多数情况下都在没有上下文切换的情况下执行。

```
return new Random().NextDouble(); 
```

Web 服务调用所涉及的开销高于您在其中所做的工作。如果您在服务内部有一些实质性的工作要做（数据库调用、查找、文件访问等），您可能会开始看到一些性能提升。仅将任务并行化不会自动使其更快。

-杰森

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T16:37:48.767

当然，添加睡眠不会提高性能。

但测试的重点是使用可变数量的线程进行测试。所以，在你的 WebMethod 中保持睡眠。

现在尝试使用 5、10、20 个线程。

如果您的代码没有其他问题，那么时间的增加不应像以前那样是线性的。

您意识到在您的测试中，当您将线程数量增加一倍时，您正在完成的工作量增加一倍。因此，如果您的线程没有真正并行执行，那么您当然会看到总时间线性增加......

我使用您的客户端代码（在服务上休眠）运行了一个简单的测试。对于 5 个线程，我看到的总时间约为 53 秒。对于 10 个线程，62 秒。因此，对于 2 倍的 Web 服务调用次数，只花费了 17% 的时间。这就是您所期望的，不是吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T21:26:41.060

正如 bruno 所提到的，您的 webmethod 是一个非常快速的操作。作为一个实验，尝试确保您的 HelloWorld 方法需要更长的时间。在返回随机双精度数之前，请输入 Thread.Sleep(1000)。这将使您的服务更有可能实际上被迫并行处理请求。然后用不同数量的线程尝试你的客户端，看看性能有何不同。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-03T14:05:36.457

好吧，在这种情况下，您并没有真正平衡所选 n.º 线程之间的工作......您创建的每个线程都将执行相同的作业。因此，如果创建 n 个线程并且并行处理能力有限，性能自然会降低。我注意到的另一个想法是，所需的作业是 100 次迭代的相对较快的操作，即使您计划将此作业划分为多个线程，您也需要考虑上下文切换所花费的时间，线程创建/删除将是一个重要因素在总时间。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-16T20:42:55.110

尝试使用一些处理器消耗任务而不是 Thread.Sleep。实际上结合的方法是最好的。

睡眠只会将线程的时间范围传递给另一个线程。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-02-12T10:20:49.757

IIS AppPool“最大工作进程”默认设置为 1。由于某种原因，每个工作进程一次只能处理 10 个服务调用。我的 WCF 异步服务器端函数会 Sleep(10*1000); 只要。这就是最大工作进程 = 1 [http://s4.postimg.org/4qc26cc65/image.png](http://s4.postimg.org/4qc26cc65/image.png)

或者

[http://i.imgur.com/C5FPbpQ.png?1](http://i.imgur.com/C5FPbpQ.png?1)

（关于SO的第一篇文章，我需要将所有图片组合成一张图片。）

客户端在此测试中进行了 48 个异步 WCF WS 调用（使用 16 个进程）。理想情况下，这应该需要大约 10 秒才能完成（睡眠（10000）），但需要 52 秒。您可以在 perfmon 图片（上方链接）中看到 5 条水平线（使用 perfmon 监控服务器中的 Web 服务当前连接）。每条水平线持续 10 秒（Sleep(10000) 确实如此）。有 5 条水平线，因为服务器每次处理 10 个调用然后关闭这 10 个连接（这种情况发生 5 次以处理 48 个调用）。完成所有呼叫需要 52 秒。

在设置Maximum Worker Processes = 2（在上面给出的同一张图片中）之后，这次有3条水平线，因为服务器每次处理20个调用然后关闭这20个连接（这种情况发生3次以处理48个调用）。花了33秒。

设置Maximum Worker Processes = 3后（在上面给出的同一张图中）这次有2条水平线，因为服务器每次处理30个调用。（发生 2 次以处理 48 个呼叫）花了 24 秒。

设置Maximum Worker Processes = 8后（在上面给出的同一张图中）这次有1条水平线，因为服务器每次处理80个调用。（发生一次以处理 48 个呼叫）花了 14 秒。

如果您不关心这种情况，您的并行（异步或线程）客户端调用将在服务器中排队 10 秒，然后您的所有线程调用 (>10) 将不会由服务器并行处理。

PS：我使用的是 Windows 8 x64 和 IIS 8.5。10 个并发请求限制适用于工作站 Windows 操作系统。根据 SO 上的另一篇文章，服务器操作系统没有该限制（由于 rep < 10，我无法提供链接）。

# asp-classic - 你用什么来编辑和开发 Classic ASP

> ID：507092
> 
> 赞同：7
> 
> 时间：2009-02-03T13:41:07.770
> 
> 标签：asp-classic, editor

您使用哪些编辑器和工具在 Classic ASP 中进行开发。我目前正在使用 TextPad，但它不是很好，所以我正在寻找替代品。

我在使用 TextPad 时遇到的问题是，它似乎试图进行语法高亮显示，但它被弄乱了，这使得它难以阅读。我觉得使用更好的工具可能会更有效率。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-03T13:44:36.670

我用过的一些工具：

*   视觉工作室
*   记事本
*   超编辑
*   记事本++
*   语境

Visual Studio（收费版和免费版）工作得非常好。智能感知是一大优势。但是，任何为您真正需要的 asp 内置代码突出显示的文本编辑器。

如果您开始使用 WinVI，我认为您应该获得额外的选票

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T13:43:28.747

在 2000 年（我唯一一次使用它），我使用了 Dreamweaver（我认为它是第 4 版）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-03T14:00:02.257

回到我使用 Homesite 的日子[http://www.adobe.com/products/homesite/](http://www.adobe.com/products/homesite/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T13:58:58.310

VIM 很棒，因为您不必在 Windows 机器上使用它。如果我正在寻找一些容易向某人介绍的东西，我通常会使用免费的 Komodo Edit。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-03T14:06:30.310

Visual Web Developer Express - 从 Microsoft 免费下载。

Emacs 和 vi 也总是很好。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-04T01:15:27.213

[Zeus](http://www.zeusedit.com) IDE 具有完全可配置的语法突出显示，但没有 ASP 的默认配置。

但是 Zeus 可以导入 Textpad*语法文件*，因此使用您当前的 Textpad 配置详细信息为 ASP 配置它应该相当容易。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-03T13:48:30.767

我也使用 emacs，但有时 Ultraedit 会为我完成这项工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-02-03T13:51:40.900

微软的 Expression Web 似乎完成了这项工作。虽然我不是用它来写经典的asp，但有时当我打开.asp文件时，高亮似乎很到位。（无论如何，它是一个很棒的 html 编辑器 IMO）

[表达式 Web2](http://www.microsoft.com/expression/products/overview.aspx?key=web)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-02-03T13:58:50.887

当我在 2001/02 开发经典 ASP 时，我使用了 EditPlus。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-02-03T14:07:43.193

我们使用[Visual Interdev](http://en.wikipedia.org/wiki/Visual_InterDev)作为我们的 ASP 3.0 开发环境。它具有调试功能和代码完成功能，但那是大约 5 年前的事了，所以我希望现在有更好的选择。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-03T13:46:22.457

Emacs 将是我的选择，但它对于新用户来说可能是相当艰巨的。

可以在[此处找到用于添加编辑 ASP/JSP/PHP/HTML 的主要模式的 lisp 扩展](http://ourcomments.org/Emacs/EmacsW32.html)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-03T14:04:42.043

Allaire [HomeSite](http://www.adobe.com/products/homesite/)曾经非常出色，后来被 Macromedia 收购，然后又被 Adob​​e 收购。代码编辑功能在某种程度上合并到了慢 10 倍的 Dreamweaver 中，尽管 Adob​​e 仍在销售 HomeSite，但它似乎不再是一个积极开发的产品。很久没有更新了。它也有一些问题并且经常崩溃（可能是由于它已经很久没有更新了）。

还短暂尝试[了 WeBuilder 2008](http://www.blumentals.net/webuilder/)，但也发现它有很多错误并且经常崩溃，尽管它有一组很好的功能，感觉就像是更新更好的 Homesite 版本。

我过去使用过[Ultra-Edit](http://www.ultraedit.com/)，它有很多有用的功能并且运行良好，[Notepad2](http://www.flos-freeware.ch/notepad2.html)也是一个很好的免费应用程序，尽管它似乎更适合快速更改，而不是用于经典 ASP 开发的成熟 IDE .

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-04T01:45:43.937

[Visual Studio 2008 SP1 重新添加了对 Classic ASP 的支持](http://weblogs.asp.net/scottgu/archive/2008/05/12/visual-studio-2008-and-net-framework-3-5-service-pack-1-beta.aspx)。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-04T02:02:33.343

如果您使用的是 Mac，[Coda非常好。](http://www.panic.com/coda)也有可用于 ASP 的语法荧光笔。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-02-04T02:09:59.367

真的，我一直无法为 ASP 找到一个好的编辑器（突出显示、折叠、完成）。

当您打开 ASP 文档时，Notepad++ 允许您折叠函数和脚本块，但不能折叠 HTML 元素，即使您将语言设置为 HTML！（当您在 Notepad++ 中打开一个 .htm 文件时，它确实允许您折叠这些元素。）

VS 2008 文本编辑器则相反——HTML 元素是公平的游戏，但不是 ASP 代码本身。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-03-05T00:41:01.020

对我来说，Visual Studio 2008 曾经使用 Ultra Edit，但我一拿到 2008 就停止使用它。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-04-03T20:27:58.360

Visual Studio 2005 运行良好。2003年也是如此

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-04-07T22:22:51.797

我使用 EditPlus (www.editplus.com) 非常简单，带有颜色和标签编码以及非常好的搜索和替换功能，包括正则表达式。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2013-02-25T11:15:25.823

我在 mac 上工作，经过一段时间寻找类似于 notepad++ 的东西，我找到了一个真正适合我的东西。

[崇高的文本](http://sublimetext.com)

# reverse-engineering - 如何对二进制文件格式进行逆向工程以实现兼容性

> ID：507093
> 
> 赞同：7
> 
> 时间：2009-02-03T13:41:44.413
> 
> 标签：reverse-engineering, binaryfiles

我正在开发一种文件准备软件，以使翻译人员能够轻松有效地处理各种文件格式。

就基于文本的格式（xml、php、资源文件...）而言，我的小型准备实用程序运行良好，但对于大多数翻译人员来说，一个主要问题是处理各种专有的二进制格式（Framemaker、Publisher、夸克……）。

这些文件很少被请求并且需要在昂贵的应用程序中打开（很少有自由职业者能买得起价值 20,000 美元的软件来每年处理几个项目），即便如此，直接在这些应用程序中工作也不方便。

我希望能够读取这些文件并以这样的方式提取文本，以便可以翻译它然后以最小的努力重新导入到原始应用程序中，甚至更好地重新创建一个有效的本机二进制文件。

这听起来可行吗？

我在哪里可以找到有关处理二进制文件格式的更多信息，以及这些工作是否有有用的工具（除了常规的十六进制编辑器）？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-18T20:13:34.427

当然逆向工程是可能的，但如果没有格式规范，它将需要大量工作。我会考虑支持这些“很少要求，非常昂贵”的格式的努力回报。花费这些精力改进应用程序的核心功能可能会更好。

另一个角度是与这些格式的公司联系，解释你的目标，解释这有助于他们的产品，如果他们不认为你是竞争对手，他们可能愿意提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T13:48:37.067

我知道你想对它们进行逆向工程 - 但由于这些可能是适当的文件格式，你正在寻找一个非常陡峭的曲线来尝试解码它们......

有些（因为我之前写过一些内部使用的专有格式）具有写入其中的特定方法和对象，这些方法和对象提供了一些替代过程而不是文件内容本身。可以证明新文件是非法的东西。

只有我的 2 美分，我不是律师 =>

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T14:08:28.743

也许您可以选择一个具有 QuarkXPress 导入功能的更便宜的应用程序。例如，InDesign 应该能够读取 Quark 文档。然后使用导入应用程序导出到您需要的任何格式 - 可能在插件的帮助下。

# c - 删除文件后可以使用 fread 吗？

> ID：507109
> 
> 赞同：2
> 
> 时间：2009-02-03T13:47:36.400
> 
> 标签：c

我使用 fopen 将文件流打开到一个非常大的文件。在对该流执行任何读取操作之前，我使用 unlink() 删除了该文件。而且，我仍然能够阅读整个文件。

我猜测有一个与流相关联的缓冲区，它保存文件的数据。但显然该缓冲区将有一个限制。这就是我选择大小为 551126688 字节或 526MB 的 a_big_file 的原因。

我想知道它背后的确切原因是什么。这是我使用的测试代码。

```
#include <stdio.h>
#include <unistd.h>

int main(){

    FILE *fp;
    long long int file_size = 0;
    int bytes_read = 0;
    char buf[1];

    fp = fopen("a_big_file", "r");

    unlink("a_big_file");

    while(0 != (bytes_read = fread(buf, 1, 1, fp))){
        file_size += bytes_read;
    }

    printf("file_size is %llu\n", file_size);

    return 0;
} 
```

输出：file_size 为 551126688

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-03T13:52:21.397

在 Unix 和类 Unix 操作系统中，文件实际上直到最后打开的文件句柄关闭后才消失。这对于临时文件来说是一个非常有用的技巧——如果你一打开它就取消链接，其他进程将看不到该文件，并且一旦你的程序关闭它，它就会从系统中删除，结束或崩溃。这有助于防止孤立临时文件的扩散。

实际上（这里忽略了一些技术细节）发生的是 Unix 文件系统是引用计数的。当您打开文件时，您实际上会连接到文件的 inode（这是文件实际内容所在位置的真正指示）。但是取消链接文件只会删除目录条目，因此文件不再有名称。如果文件空间（即 inode）不在任何目录条目中，并且没有人打开它，文件系统只会回收文件空间（即 inode）。其他进程无法以普通方式打开它，因为它们无法将文件名映射到 inode。

请注意，Unix 文件系统允许多个目录条目指向同一个 inode——我们称之为“硬链接”。如果执行“ls -l”，其中一个字段是指向同一 inode 的硬链接计数，如果执行“ls -li”，则可以看到实际的 inode 地址。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-03T13:54:23.797

从取消链接的手册页：

> unlink() 从文件系统中删除一个名称。如果该名称是文件的最后一个链接，并且没有进程打开该文件，则该文件将被删除，并且它正在使用的空间可供重用。
> 
> **如果名称是文件的最后一个链接，但任何进程仍然打开该文件，则该文件将一直存在，直到最后一个引用它的文件描述符被关闭。**

粗体部分解释了这种行为。:-)

[编辑]顺便说一句，您应该在 return 语句之前使用 fclose() 关闭文件... [/edit]

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-03T14:35:50.187

在某些系统上，例如 linux，只要进程仍然打开，您仍然可以轻松访问文件系统上没有名称的文件。有一个文件描述符列表

```
/proc/<pid>/fd 
```

**编辑**：根据[Paul Tomblin](https://stackoverflow.com/users/3333/paul-tomblin)的评论，如果您是与进程或 root 相同的用户，则只能访问此目录。

例如：

```
# Create a file with cat
chris@shrubbery:~$ cat > MYFILE
Hello

# Suspend the process and find its pid
[1]+  Stopped                 cat > MYFILE
chris@shrubbery:~$ ps waux | grep cat
chris     1311  0.0  0.0   5088   668 pts/6    T    14:29   0:00 cat
chris     1313  0.0  0.0   5168   840 pts/6    R+   14:29   0:00 grep cat

# Inspect the list of open files
chris@shrubbery:~$ cd /proc/1311/fd
chris@shrubbery:/proc/1311/fd$ ls -l
total 0
lrwx------ 1 chris chris 64 2009-02-03 14:29 0 -> /dev/pts/6
l-wx------ 1 chris chris 64 2009-02-03 14:29 1 -> /home/chris/MYFILE
lrwx------ 1 chris chris 64 2009-02-03 14:29 2 -> /dev/pts/6

# View MYFILE from the symlink on the /proc pseudofilesystem.
chris@shrubbery:/proc/1311/fd$ cat 1
Hello

# Delete the filename /home/chris/MYFILE
chris@shrubbery:/proc/1311/fd$ rm /home/chris/MYFILE
chris@shrubbery:/proc/1311/fd$ cat /home/chris/MYFILE
cat: /home/chris/MYFILE: No such file or directory

# But the process still has it open. 
# The /proc system knows the original name was deleted
chris@shrubbery:/proc/1311/fd$ ls -l
total 0
lrwx------ 1 chris chris 64 2009-02-03 14:29 0 -> /dev/pts/6
l-wx------ 1 chris chris 64 2009-02-03 14:29 1 -> /home/chris/MYFILE (deleted)
lrwx------ 1 chris chris 64 2009-02-03 14:29 2 -> /dev/pts/6

# We can still view the file, useful for debugging.
chris@shrubbery:/proc/1311/fd$ cat 1
Hello 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T13:54:45.450

在`Linux`, 文件只有在最后一个打开的句柄关闭时才真正被删除。

人们通常以这种方式使用临时文件：`mkstemp(3)`后跟立即`unlink(2)`. 这样只有你可以访问文件的数据，其他进程不能。

即使另一个进程创建了其他同名文件，它们的新文件也与原始文件没有任何共同之处。

# c# - 安装向导

> ID：507112
> 
> 赞同：1
> 
> 时间：2009-02-03T13:48:35.557
> 
> 标签：c#, deployment

我正在使用安装向导来打包我的 Windows 窗体应用程序，但是在安装时我会提示安装 .NET 3.5 框架，即使我的应用程序是基于 2.0 构建的，并且安装项目的 prereqs 部分中没有勾选 3.5 框架。

为什么要求 .NET 3.5？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T14:17:06.963

已解决：我在启动条件下手动更改了框架版本。

# ruby - FTP 有 Rake 任务吗？

> ID：507115
> 
> 赞同：3
> 
> 时间：2009-02-03T13:49:12.153
> 
> 标签：ruby, rake

我正在寻找通过 FTP 进行部署的 Rake 任务。

有人知道吗？

安德斯

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-03T20:35:57.573

好吧，我决定自己做。代码不是很漂亮，因为它包含很多异常处理，但它完成了工作:)

```
require 'rake'
require 'net/ftp'

def ftp_files(prefixToRemove, sourceFileList, targetDir, hostname, username, password)
  Net::FTP.open(hostname, username, password) do |ftp|
  begin
    puts "Creating dir #{targetDir}" 
    ftp.mkdir targetDir
  rescue 
    puts $!
  end
  sourceFileList.each do |srcFile|    
    if prefixToRemove
      targetFile = srcFile.pathmap(("%{^#{prefixToRemove},#{targetDir}}p")) 
    else
      targetFile = srcFile.pathmap("#{targetDir}%s%p")
    end
    begin
      puts "Creating dir #{targetFile}" if File.directory?(srcFile)
      ftp.mkdir targetFile if File.directory?(srcFile)
    rescue 
      puts $!
    end
    begin
      puts "Copying #{srcFile} -> #{targetFile}" unless File.directory?(srcFile)
      ftp.putbinaryfile(srcFile, targetFile) unless File.directory?(srcFile)
    rescue 
      puts $!
    end
  end
  end
end

task :ftp => [:dist] do
  ftp_files("dist", FileList["dist/**/*"], "remote_dir", 'host.com', 'user', 'pwd')
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T17:24:31.953

不是我知道虽然[Net::SFTP](http://net-ssh.rubyforge.org/sftp/v2/api/) gem 非常好，但你可以很容易地编写一个[新的 rake 任务](http://railscasts.com/episodes/66)来做你想做的事。

它还取决于您正在执行哪种部署 - 如果是 Rails，您是否研究过[Capistrano](http://www.capify.org/)或[Vlad the Deployer](http://rubyhitsquad.com/Vlad_the_Deployer.html)？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-27T20:05:18.640

上面的代码对我不起作用。我创建了不同的： [https ://gist.github.com/1690647](https://gist.github.com/1690647)

# java - 如何更改 Javahelp 字体？

> ID：507117
> 
> 赞同：1
> 
> 时间：2009-02-03T13:49:50.827
> 
> 标签：java, fonts, javahelp

Javahelp 是基于 Java 的帮助系统，可以很容易地集成到 Java 应用程序中。该文档没有提供有关它的任何信息。在网络上，许多人说帮助浏览器总是使用内置字体是不可能的。我不相信这是不可能的。

IntelliJ IDE 的帮助系统基于 javahelp 并使用另一种字体。所以我认为这一定是可能的。真的有人这样做吗？

为了完整性：

*   在帮助文件中包含标签没有帮助。
*   样式表不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T14:05:30.950

样式表似乎工作......在某些情况下。可能只支持一个子集，诀窍是找出哪个子集。

# unicode - python 3.0，如何使 print() 输出 unicode？

> ID：507123
> 
> 赞同：18
> 
> 时间：2009-02-03T13:51:54.783
> 
> 标签：unicode, console, printing, python-3.x, stdout

我在 WinXP 5.1.2600 下工作，编写一个涉及中文拼音的 Python 应用程序，这让我陷入了无穷无尽的 Unicode 问题。切换到 Python 3.0 解决了其中的许多问题。但是出于某种奇怪的原因，控制台输出的 print() 函数不支持 Unicode。这是一个很小的程序。

```
print('sys.stdout encoding is "' + sys.stdout.encoding + '"')
str1 = 'lüelā'
print(str1) 
```

输出是（为了便于阅读，将尖括号更改为方括号）：

```
    sys.stdout 编码为“cp1252”
    回溯（最近一次通话最后）：
      [模块] 中的文件“TestPrintEncoding.py”，第 22 行
        打印（str1）
      文件“C:\Python30\lib\io.py”，第 1491 行，写入
        b = 编码器.encode(s)
      文件“C:\Python30\lib\encodings\cp1252.py”，第 19 行，在编码中
        返回 codecs.charmap_encode(input,self.errors,encoding_table)[0]
    UnicodeEncodeError：“charmap”编解码器无法编码字符“\u0101”
    在位置 4：字符映射到 [未定义]

```

请注意， ü = \xfc = 252 没有问题，因为它是高位 ASCII。但是 ā = \u0101 超过 8 位。

任何人都知道如何将 sys.stdout 的编码更改为“utf-8”？请记住`codecs`，如果我正确理解文档，Python 3.0 不再使用该模块。

* * *

抱歉，我给了你没有序言的程序。在给出 3 行之前，它的开头是这样的：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import sys 
```

不幸的是，“coding:”行指定的编码是*源代码*的编码，而不是控制台输出的编码。但是谢谢你的想法！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-03T14:34:08.553

Windows 命令提示符 (cmd.exe) 无法显示您正在使用的 Unicode 字符，即使 Python 在内部以正确的方式处理它。您需要使用 IDLE、Cygwin 或其他可以正确显示 Unicode 的程序。

有关完整说明，请参阅此线程：http: [//www.nabble.com/unable-to-print-Unicode-characters-in-Python-3-td21670662.html](http://www.nabble.com/unable-to-print-Unicode-characters-in-Python-3-td21670662.html)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-10-26T20:37:12.763

您可能想尝试将环境变量“PYTHONIOENCODING”更改为“utf_8”。我已经写了[一页关于这个问题的磨难](http://daveagp.wordpress.com/2010/10/26/what-a-character/)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-19T11:13:57.370

[看看这里](https://stackoverflow.com/questions/492483/setting-the-correct-encoding-when-piping-stdout-in-python)的问答，我认为他们有一些有价值的线索。具体来说，请注意模块[`setdefaultencoding`](http://docs.python.org/library/sys.html#sys.setdefaultencoding)中的`sys`，以及您可能不应该使用它的事实。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-04-09T16:00:08.997

在 Windows 中以 Python 显示 Unicode 字符的问题是已知的。目前还没有官方解决方案。正确的做法是使用winapi函数WriteConsoleW。由于存在其他相关问题，因此构建一个可行的解决方案并非易事。但是，我已经开发了一个包来尝试修复 Python 关于这个问题。请参阅[https://github.com/Drekin/win-unicode-console](https://github.com/Drekin/win-unicode-console)。您还可以在那里阅读对问题的更深入解释。该软件包也在 pypi ( [https://pypi.python.org/pypi/win_unicode_console](https://pypi.python.org/pypi/win_unicode_console) ) 上，可以使用 pip 安装。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-05-28T11:42:12.660

这是一个肮脏的黑客：

```
# works
import os
os.system("chcp 65001 &")
print("юникод") 
```

然而一切都打破了它：

*   简单的静音第一行已经打破了它：

    ```
    # doesn't work
    import os
    os.system("chcp 65001 >nul &")
    print("юникод") 
    ```

*   检查操作系统类型会破坏它：

    ```
    # doesn't work
    import os
    if os.name == "nt":
        os.system("chcp 65001 &")

    print("юникод") 
    ```

*   它甚至在 if 块下都不起作用：

    ```
    # doesn't work
    import os
    if os.name == "nt":
        os.system("chcp 65001 &")
        print("юникод") 
    ```

但是可以使用 cmd 的 echo 打印：

```
# works
import os
os.system("chcp 65001 & echo {0}".format("юникод")) 
```

这是一种跨平台的简单方法：

```
# works

import os

def simple_cross_platrofm_print(obj):
    if os.name == "nt":
        os.system("chcp 65001 >nul & echo {0}".format(obj))
    else:
        print(obj)

simple_cross_platrofm_print("юникод") 
```

但`echo`不能抑制窗口的尾随空行。

# c# - 为什么我不能在 C# 中设置此 ACL 规则？

> ID：507124
> 
> 赞同：2
> 
> 时间：2009-02-03T13:52:02.803
> 
> 标签：c#, .net, security, acl, rights

在 Vista SP1 上以提升的管理员身份运行，我的 C# 应用程序尝试使用以下代码设置以下规则。不会产生错误，但目录的 ACL 也不会发生任何更改。我错过了什么？

```
public static void Main( string args[] )
{
    string dirPath = Path.Combine(Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData), "Company"), "Product" );
    Directory.Create(dirPath);
    _SetAcl(dirPath, "Users", FileSystemRights.FullControl);
}

private static void _SetAcl(string path, string identity, FileSystemRights rights)
{
    var info = new DirectoryInfo(path);
    var acl = info.GetAccessControl();

    var rule1 = new FileSystemAccessRule(identity, rights, AccessControlType.Allow);
    bool modified;
    acl.ModifyAccessRule(AccessControlModification.Reset, rule1, out modified);

    var inheritanceFlags = InheritanceFlags.ContainerInherit | InheritanceFlags.ObjectInherit;
    var rule2 = new FileSystemAccessRule(identity, rights, inheritanceFlags,
                                        PropagationFlags.InheritOnly, AccessControlType.Allow);
    acl.ModifyAccessRule(AccessControlModification.Add, rule2, out modified);
} 
```

**更新：**只需将以下代码添加为 _SetAcl 方法的最后一行，我的代码就可以了。

```
info.SetAccessControl(acl); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T14:26:41.423

要完成该过程，您必须使用修改后的 ACL 调用 DirectoryInfo.SetAccessControl()。

GetAccessControl() 真正返回 ACL 的副本。您可以随意修改它，但在您调用 SetAccessControl() 之前它不会生效

# sql - 模型数据库中的异构类型

> ID：507136
> 
> 赞同：2
> 
> 时间：2009-02-03T13:53:39.180
> 
> 标签：sql, database-design

我试图找出在我的系统中建模一组“类”的最佳方法。请注意，我不是在谈论 OO 类，而是响应类（在调查中）。所以模型是这样的：

可以使用三种不同类型的数据定义一个类：

*   一类编码响应（其中编码响应由字符串标签和整数值组成）

*   一类数值响应（定义为一组区间，其中每个区间的范围从最小值到最大值）

*   一类字符串响应（定义为一组正则表达式模式）

现在我们有：Class 表（用于定义唯一的类）和一个 ClassCoded、ClassNumeric 和 ClassString 表（都带有 ClassID 作为 Class 表的外键）。

我的问题是，现在一个类在技术上可以被这个系统编码和数字。有没有办法定义一组表来处理这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T14:58:36.473

关系数据库不能优雅地处理这个问题。最简单的方法是为所有不同类型的数据定义列，并且只填充适当的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T18:37:43.460

处理子类型有两种主要方法，或者通过为每个可能的属性添加列来使用稀疏列（最好使用检查约束以确保只有一种类型具有值），或者为超类型创建一个表，然后为子类型创建三个表类型，每个都有返回超类型表的外键。然后添加一个检查约束以确保三个可能的类型列中只有一个不为空。

我个人根据子类型的相似程度来决定使用这两种实现中的哪一种。如果 90% 的列是共享的，我使用稀疏列方法，如果共享的信息很少，我使用多表方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T19:28:13.530

我不明白问题是什么。这只是混合继承。为什么一个类不能只拥有一个 ClassCoded 和 ClassNumeric 的条目？

无论如何，业务规则的实施不会在数据库中完成，因此您可以轻松地在业务层代码中实施这些约束，并为在这两个表中都有条目的类使用特殊规则。

# javascript - 如何将类添加到给定元素？

> ID：507138
> 
> 赞同：1459
> 
> 时间：2009-02-03T13:54:00.210
> 
> 标签：javascript, dom-manipulation

我有一个已经有一个类的元素：

```
<div class="someclass">
    <img ... id="image1" name="image1" />
</div> 
```

现在，我想创建一个 JavaScript 函数，它将一个类添加到`div`（不是替换，而是添加）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2361
> 
> 时间：2009-02-03T13:58:01.480

# 如果您只针对现代浏览器：

使用[element.classList.add](https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/add)添加一个类：

```
element.classList.add("my-class"); 
```

和[element.classList.remove](https://developer.mozilla.org/en-US/docs/Web/API/DOMTokenList/remove)删除一个类：

```
element.classList.remove("my-class"); 
```

# 如果您需要支持 Internet Explorer 9 或更低版本：

`className`在元素的属性中添加一个空格和新类的名称。首先，`id`在元素上放一个，这样您就可以轻松获得参考。

```
<div id="div1" class="someclass">
    <img ... id="image1" name="image1" />
</div> 
```

然后

```
var d = document.getElementById("div1");
d.className += " otherclass"; 
```

注意前面的空格`otherclass`。包含空格很重要，否则它会损害类列表中位于它之前的现有类。

另请参阅[MDN 上的 element.className](https://developer.mozilla.org/en-US/docs/Web/API/Element/className)。

* * *

## 回答 #2

> 赞同：1391
> 
> 时间：2012-12-31T12:12:22.263

在没有任何框架的情况下，最简单的方法是使用[element.classList.add](https://developer.mozilla.org/en-US/docs/DOM/element.classList)方法。

```
var element = document.getElementById("div1");
element.classList.add("otherclass"); 
```

**编辑：** 如果你想从元素中删除类 -

```
element.classList.remove("otherclass"); 
```

我不希望自己添加任何空白空间和重复条目处理（使用该`document.className`方法时需要这样做）。存在一些[浏览器限制](http://caniuse.com/#feat=classlist)，但您可以使用[polyfill](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills#wiki-classlist)解决这些限制。

* * *

## 回答 #3

> 赞同：185
> 
> 时间：2009-02-03T14:01:20.130

随心所欲地找到目标元素“d”，然后：

```
d.className += ' additionalClass'; //note the space 
```

你可以用更聪明的方式包装它来检查是否存在，并检查空间要求等。

* * *

## 回答 #4

> 赞同：143
> 
> 时间：2014-12-22T23:29:37.120

## 添加类

*   **交叉兼容**

    在以下示例中，我们将 a 添加`classname`到`<body>`元素。这是 IE-8 兼容的。

    ```
    var a = document.body;
    a.classList ? a.classList.add('classname') : a.className += ' classname'; 
    ```

    这是以下的简写..

    ```
    var a = document.body;
    if (a.classList) {
        a.classList.add('wait');
    } else {
        a.className += ' wait';
    } 
    ```

* * *

*   **表现**

    如果您更关心交叉兼容性的性能，您可以将其缩短到以下，即快 4%。

    ```
    var z = document.body;
    document.body.classList.add('wait'); 
    ```

* * *

*   **方便**

    或者，您可以使用 jQuery，但结果性能明显变慢。根据 jsPerf 慢 94%

    ```
    $('body').addClass('wait'); 
    ```

* * *

* * *

## 删除类

*   **表现**

    如果您关心性能，有选择地使用 jQuery 是删除类的最佳方法

    ```
    var a = document.body, c = ' classname';
    $(a).removeClass(c); 
    ```

* * *

*   如果没有 jQuery，它会慢 32%

    ```
    var a = document.body, c = ' classname';
    a.className = a.className.replace( c, '' );
    a.className = a.className + c; 
    ```

* * *

## 参考

1.  [jsPerf 测试用例：添加类](http://jsperf.com/addclass99)
2.  [jsPerf 测试用例：删除一个类](http://jsperf.com/removeclass99)

* * *

## 使用原型

```
Element("document.body").ClassNames.add("classname")
Element("document.body").ClassNames.remove("classname")
Element("document.body").ClassNames.set("classname") 
```

## 使用 YUI

```
YAHOO.util.Dom.hasClass(document.body,"classname")
YAHOO.util.Dom.addClass(document.body,"classname")
YAHOO.util.Dom.removeClass(document.body,"classname") 
```

* * *

## 回答 #5

> 赞同：36
> 
> 时间：2014-09-23T11:15:35.920

另一种使用纯 JavaScript 将类添加到元素的方法

**添加类：**

```
document.getElementById("div1").classList.add("classToBeAdded"); 
```

**对于删除类：**

```
document.getElementById("div1").classList.remove("classToBeRemoved"); 
```

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2009-02-03T14:40:44.373

当我正在做的工作不保证使用库时，我使用这两个函数：

```
function addClass( classname, element ) {
    var cn = element.className;
    //test for existance
    if( cn.indexOf( classname ) != -1 ) {
        return;
    }
    //add a space if the element already has class
    if( cn != '' ) {
        classname = ' '+classname;
    }
    element.className = cn+classname;
}

function removeClass( classname, element ) {
    var cn = element.className;
    var rxp = new RegExp( "\\s?\\b"+classname+"\\b", "g" );
    cn = cn.replace( rxp, '' );
    element.className = cn;
} 
```

* * *

## 回答 #7

> 赞同：23
> 
> 时间：2009-02-03T14:00:25.110

假设您所做的不仅仅是添加这个类（例如，您还有异步请求等等），我建议您使用[Prototype](http://www.prototypejs.org/)或[jQuery](http://jquery.com)之类的库。

这将使您需要做的所有事情（包括这个）变得非常简单。

因此，假设您的页面上现在有 jQuery，您可以使用这样的代码向元素添加类名（在这种情况下是在加载时）：

```
$(document).ready( function() {
  $('#div1').addClass( 'some_other_class' );
} ); 
```

查看[jQuery API 浏览器](http://api.jquery.com/)了解其他内容。

* * *

## 回答 #8

> 赞同：18
> 
> 时间：2013-08-10T08:59:34.110

您可以使用 classList.add OR classList.remove 方法从元素中添加/删除类。

```
var nameElem = document.getElementById("name")
nameElem.classList.add("anyclss") 
```

上面的代码将添加（而不是替换）一个类“anyclass”到nameElem。同样，您可以使用 classList.remove() 方法来删​​除一个类。

```
nameElem.classList.remove("anyclss") 
```

* * *

## 回答 #9

> 赞同：17
> 
> 时间：2020-05-29T06:31:09.797

```
document.getElementById('some_id').className+='  someclassname' 
```

或者：

```
document.getElementById('some_id').classList.add('someclassname') 
```

当第二种方法不起作用时，第一种方法有助于添加类。
不要忘记`' someclassname'`在第一种方法的前面保留一个空格。

对于删除，您可以使用：

```
document.getElementById('some_id').classList.remove('someclassname') 
```

* * *

## 回答 #10

> 赞同：13
> 
> 时间：2015-08-20T08:38:22.067

### 向元素添加附加类：

要将类添加到元素，而不删除/影响现有值，请附加一个空格和新的类名，如下所示：

```
document.getElementById("MyElement").className += " MyClass"; 
```

### 要更改元素的所有类：

要将所有现有类替换为一个或多个新类，请设置 className 属性：

```
document.getElementById("MyElement").className = "MyClass"; 
```

（您可以使用空格分隔的列表来应用多个类。）

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2016-03-31T23:29:30.830

如果您不想使用 jQuery 并希望支持旧版浏览器：

```
function addClass(elem, clazz) {
    if (!elemHasClass(elem, clazz)) {
        elem.className += " " + clazz;
    }
}

function elemHasClass(elem, clazz) {
    return new RegExp("( |^)" + clazz + "( |$)").test(elem.className);
} 
```

* * *

## 回答 #12

> 赞同：8
> 
> 时间：2017-12-30T17:46:20.430

我也认为最快的方法是使用 es5 中的 Element.prototype.classList：`document.querySelector(".my.super-class").classList.add('new-class')` 但是在 ie8 中没有 Element.prototype.classList 这样的东西，无论如何你可以用这个片段来填充它（可以自由编辑和改进它):

```
if(Element.prototype.classList === void 0){
	function DOMTokenList(classes, self){
		typeof classes == "string" && (classes = classes.split(' '))
		while(this.length){
			Array.prototype.pop.apply(this);
		}
		Array.prototype.push.apply(this, classes);
		this.__self__ = this.__self__ || self
	}

	DOMTokenList.prototype.item = function (index){
		return this[index];
	}

	DOMTokenList.prototype.contains = function (myClass){
		for(var i = this.length - 1; i >= 0 ; i--){
			if(this[i] === myClass){
				return true;
			}
		}
		return false
	}

	DOMTokenList.prototype.add = function (newClass){
		if(this.contains(newClass)){
			return;
		}
		this.__self__.className += (this.__self__.className?" ":"")+newClass;
		DOMTokenList.call(this, this.__self__.className)
	}

	DOMTokenList.prototype.remove = function (oldClass){
		if(!this.contains(newClass)){
			return;
		}
		this[this.indexOf(oldClass)] = undefined
		this.__self__.className = this.join(' ').replace(/  +/, ' ')
		DOMTokenList.call(this, this.__self__.className)
	}

	DOMTokenList.prototype.toggle = function (aClass){
		this[this.contains(aClass)? 'remove' : 'add'](aClass)
		return this.contains(aClass);
	}

	DOMTokenList.prototype.replace = function (oldClass, newClass){
		this.contains(oldClass) && this.remove(oldClass) && this.add(newClass)
	}

	Object.defineProperty(Element.prototype, 'classList', {
		get: function() {
			return new DOMTokenList( this.className, this );
		},
		enumerable: false
	})
}
```

* * *

## 回答 #13

> 赞同：7
> 
> 时间：2014-06-11T08:11:00.757

以简单的方式添加、删除或检查元素类：

```
var uclass = {
    exists: function(elem,className){var p = new RegExp('(^| )'+className+'( |$)');return (elem.className && elem.className.match(p));},
    add: function(elem,className){if(uclass.exists(elem,className)){return true;}elem.className += ' '+className;},
    remove: function(elem,className){var c = elem.className;var p = new RegExp('(^| )'+className+'( |$)');c = c.replace(p,' ').replace(/  /g,' ');elem.className = c;}
};

var elem = document.getElementById('someElem');
//Add a class, only if not exists yet.
uclass.add(elem,'someClass');
//Remove class
uclass.remove(elem,'someClass'); 
```

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2016-12-18T17:30:21.470

我知道 IE9 已正式关闭，我们可以用上面所说的方法来实现它，`element.classList`但我只是试图在没有`classList`上面很多答案的帮助下学习它是如何工作的，我可以学习它。

下面的代码扩展了上面的许多答案，并通过避免添加重复的类来改进它们。

```
function addClass(element,className){
  var classArray = className.split(' ');
  classArray.forEach(function (className) {
    if(!hasClass(element,className)){
      element.className += " "+className;
    }
  });            
}
//this will add 5 only once
addClass(document.querySelector('#getbyid'),'3 4 5 5 5'); 
```

* * *

## 回答 #15

> 赞同：6
> 
> 时间：2017-09-24T15:44:43.243

您可以使用类似于 jQuery 的现代方法

如果您只需要更改一个元素，即 JS 将在 DOM 中找到的第一个元素，您可以使用以下命令：

```
document.querySelector('.someclass').className += " red";
```

```
.red {
  color: red;
}
```

```
<div class="someclass">
  <p>This method will add class "red" only to first element in DOM</p>
</div>

<div class="someclass">
  <p>lorem ipsum</p>
</div>

<div class="someclass">
  <p>lorem ipsum</p>
</div>

<div class="someclass">
  <p>lorem ipsum</p>
</div>
```

请记住在类名**前留一个空格。**

如果您有多个要添加新类的类，则可以像这样使用它

```
document.querySelectorAll('.someclass').forEach(function(element) {
  element.className += " red";
});
```

```
.red {
  color: red;
}
```

```
<div class="someclass">
  <p>This method will add class "red" to all elements in DOM that have "someclass" class.</p>
</div>

<div class="someclass">
  <p>lorem ipsum</p>
</div>

<div class="someclass">
  <p>lorem ipsum</p>
</div>

<div class="someclass">
  <p>lorem ipsum</p>
</div>
```

* * *

## 回答 #16

> 赞同：5
> 
> 时间：2009-02-03T14:18:50.423

只是为了详细说明其他人所说的，多个 CSS 类组合在一个字符串中，由空格分隔。因此，如果你想对其进行硬编码，它看起来就像这样：

```
<div class="someClass otherClass yetAnotherClass">
      <img ... id="image1" name="image1" />
</div> 
```

从那里您可以轻松地派生添加新类所需的 javascript... 只需在元素的 className 属性后面附加一个空格，然后是新类。知道了这一点，您还可以编写一个函数，以便稍后在需要时删除一个类。

* * *

## 回答 #17

> 赞同：5
> 
> 时间：2016-11-28T00:41:39.140

我认为最好使用纯 JavaScript，我们可以在浏览器的 DOM 上运行。

这是使用它的功能方法。我使用过 ES6，但可以随意使用 ES5 和函数表达式或函数定义，以适合您的 JavaScript 样式指南。

```
'use strict'

const oldAdd = (element, className) => {
  let classes = element.className.split(' ')
  if (classes.indexOf(className) < 0) {
    classes.push(className)
  }
  element.className = classes.join(' ')
}

const oldRemove = (element, className) => {
  let classes = element.className.split(' ')
  const idx = classes.indexOf(className)
  if (idx > -1) {
    classes.splice(idx, 1)
  }
  element.className = classes.join(' ')
}

const addClass = (element, className) => {
  if (element.classList) {
    element.classList.add(className)
  } else {
    oldAdd(element, className)
  }
}

const removeClass = (element, className) => {
  if (element.classList) {
    element.classList.remove(className)
  } else {
    oldRemove(element, className)
  }
}
```

* * *

## 回答 #18

> 赞同：5
> 
> 时间：2021-11-07T02:35:13.890

# 使用 JavaScript 添加类的 2 种不同方法

JavaScript 提供了 2 种不同的方式来向 HTML 元素添加类：

1.  使用`element.classList.add()`方法
2.  使用`className`属性

> 使用这两种方法，您可以一次添加单个或多个类。

[![TutorialsTonight.com 的 JavaScript 添加类](https://i.stack.imgur.com/BJ4Hj.png)](https://i.stack.imgur.com/BJ4Hj.png)

**参考**：TutorialsTonight（[javascript添加类](https://www.tutorialstonight.com/javascript-add-class.php)）

### 一、使用`element.classList.add()`方法

```
var element = document.querySelector('.box');
// using add method
// adding single class
element.classList.add('color');

// adding multiple class
element.classList.add('border', 'shadow');
```

```
.box {
    width: 200px;
    height: 100px;
}
.color {
    background: skyblue;
}
.border {
    border: 2px solid black;
}
.shadow {
    box-shadow: 5px 5px 5px gray;
}
```

```
<div class="box">My Box</div>
```

### 2.使用`element.className`属性

**注意**：始终使用**`+=`**运算符并在类名前添加一个空格以使用 classList 方法添加类。

```
var element = document.querySelector('.box');
// using className Property
// adding single class
element.className += ' color';

// adding multiple class
element.className += ' border shadow';
```

```
.box {
    width: 200px;
    height: 100px;
}
.color {
    background: skyblue;
}
.border {
    border: 2px solid black;
}
.shadow {
    box-shadow: 5px 5px 5px gray;
}
```

```
<div class="box">My Box</div>
```

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2015-07-19T16:31:23.180

纯 JS 示例。在第一个示例中，我们获取元素的 id 并添加例如 2 个类。

```
document.addEventListener('DOMContentLoaded', function() {
    document.getElementsById('tabGroup').className = "anyClass1 anyClass2";
}) 
```

在第二个示例中，我们获取元素的类名并再添加 1 个。

```
document.addEventListener('DOMContentLoaded', function() {
    document.getElementsByClassName('tabGroup')[0].className = "tabGroup ready";
}) 
```

* * *

## 回答 #20

> 赞同：3
> 
> 时间：2017-06-30T07:21:18.427

对于那些使用[Lodash](http://lodash.com)并想要更新`className`字符串的人：

```
// get element reference
var elem = document.getElementById('myElement');

// add some classes. Eg. 'nav' and 'nav header'
elem.className = _.chain(elem.className).split(/[\s]+/).union(['nav','navHeader']).join(' ').value()

// remove the added classes
elem.className = _.chain(elem.className).split(/[\s]+/).difference(['nav','navHeader']).join(' ').value() 
```

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2020-05-14T11:20:16.443

## 最短的

```
image1.parentNode.className+=' box'; 
```

```
image1.parentNode.className+=' box';
```

```
.box { width: 100px; height:100px; background: red; }
```

```
<div class="someclass">
    <img ... id="image1" name="image1" />
</div>
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2015-03-06T10:27:52.930

您可以使用 API querySelector 来选择您的元素，然后使用该元素和新的类名作为参数创建一个函数。对现代浏览器使用类列表，否则对 IE8 使用。然后您可以在事件发生后调用该函数。

```
 //select the dom element
 var addClassVar = document.querySelector('.someclass');

 //define the addclass function
 var addClass = function(el,className){
   if (el.classList){
     el.classList.add(className);
   }
   else {
     el.className += ' ' + className;
  }
};

//call the function
addClass(addClassVar, 'newClass'); 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2009-02-03T14:04:58.253

首先，给 div 一个 id。然后，调用函数 appendClass：

```
<script language="javascript">
  function appendClass(elementId, classToAppend){
    var oldClass = document.getElementById(elementId).getAttribute("class");
    if (oldClass.indexOf(classToAdd) == -1)
    {
      document.getElementById(elementId).setAttribute("class", classToAppend);
    }
}
</script> 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2020-08-18T02:41:26.837

就我而言，我在 DOM 中调用了多个类`main-wrapper`，但我只想影响 parent `main-wrapper`。使用`:first Selector`( [https://api.jquery.com/first-selector/](https://api.jquery.com/first-selector/) )，我可以选择第一个匹配的 DOM 元素。这是我的解决方案：

```
$(document).ready( function() {
    $('.main-wrapper:first').addClass('homepage-redesign');
    $('#deals-index > div:eq(0) > div:eq(1)').addClass('doubleheaderredesign');
} ); 
```

我也为我的 DOM 中特定 div 的第二个孩子做了同样的事情，正如您在我使用的代码中看到的那样`$('#deals-index > div:eq(0) > div:eq(1)').addClass('doubleheaderredesign');`。

注意：`jQuery`如您所见，我使用过。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2022-02-16T15:40:52.260

```
h2.setAttribute('class', h2.getAttribute('class') + ' newClassName') 
```

* * *

## 回答 #26

> 赞同：-4
> 
> 时间：2014-06-27T14:48:21.130

这个js代码对我有用

提供类名替换

```
var DDCdiv = hEle.getElementBy.....

var cssCNs = DDCdiv.getAttribute('class');
var Ta = cssCNs.split(' '); //split into an array
for (var i=0; i< Ta.length;i++)
{
    if (Ta[i] == 'visible'){
        Ta[i] = 'hidden';
        break;// quit for loop
    }
    else if (Ta[i] == 'hidden'){
        Ta[i] = 'visible';
    break;// quit for loop
    }
}
DDCdiv.setAttribute('class',Ta.join(' ') );  // Join array with space and set class name 
```

添加只是使用

```
var cssCNs = DDCdiv.getAttribute('class');
var Ta = cssCNs.split(' '); //split into an array
Ta.push('New class name');
// Ta.push('Another class name');//etc...
DDCdiv.setAttribute('class',Ta.join(' ') );  // Join array with space and set class name 
```

删除使用

```
var cssCNs = DDCdiv.getAttribute('class');
var Ta = cssCNs.split(' '); //split into an array

for (var i=0; i< Ta.length;i++)
{
    if (Ta[i] == 'visible'){
        Ta.splice( i, 1 );
        break;// quit for loop
    }
}
DDCdiv.setAttribute('class',Ta.join(' ') );  // Join array with space and set class name 
```

希望这对某人有帮助

* * *

## 回答 #27

> 赞同：-9
> 
> 时间：2009-02-03T14:11:58.597

在 YUI 中，如果包含[yuidom](http://developer.yahoo.com/yui/dom/)，则可以使用

`YAHOO.util.Dom.addClass('div1','className');`

高温高压

# sql - Oracle 和 SQL 数据集

> ID：507139
> 
> 赞同：1
> 
> 时间：2009-02-03T13:54:14.890
> 
> 标签：sql, sql-server, oracle, dataset

问题：我必须从 SQL Server 数据库和 Oracle 数据库中提取数据并将它们放在一个数据集中。我遇到的问题是：SQL Server 查询需要一个只能从 Oracle 查询返回中找到的 ID。

我想知道的是：我怎样才能以不损害性能的方式解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T15:04:14.997

您可以使用链接服务器或将数据全部传输到一侧来执行此操作。这一切都将取决于每一方的数据量。

一般的经验法则是在数据最多的一侧执行查询。

例如，如果 Oracle ID 的集合很小，但 SQL Server 集合很大，则您可以将链接服务器连接到 Oracle 端并在 SQL Server 端执行：

```
SELECT *
FROM sqlservertable
INNER JOIN linkedserver.oracletable
    ON whatever 
```

在这种情况下，如果 Oracle 端很大（或者在需要与 SQL Server 端连接之前无法进行预过滤），性能通常会很差 - 通过拉取整个表（或最小子集）会提高很多您可以确定）改为 SQL Server 表，并在 SQL Server 端执行全部 JOIN。

# ruby-on-rails - 使用 MediaTemple 上传 Rails 应用程序

> ID：507141
> 
> 赞同：1
> 
> 时间：2009-02-03T13:54:43.827
> 
> 标签：ruby-on-rails, capistrano, uploading, mediatemple

**最近**关于将 Rails 应用程序上传到 (gs) rails 容器的教程或指南有什么建议吗？

我已经遵循了几个教程，但这两个都没有奏效。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T15:14:24.463

我使用了 mt-capistrano gem（来自 MT）并使用[了本](http://blog.vixiom.com/2007/02/18/mt-ror-a-z-the-complete-guide-to-getting-rails-running-on-media-temple/)教程。它对我来说很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T20:47:56.050

很久以前，我写了一个方法，有人（显然）修好了并开始工作。不久前，我收到了一个 pingback 的通知。也许它会帮助您入门：

[http://websitesyoucanedit.com/?p=102](http://websitesyoucanedit.com/?p=102)

# iphone - 如何在同一层继承两个类？

> ID：507144
> 
> 赞同：2
> 
> 时间：2009-02-03T13:55:18.677
> 
> 标签：iphone, objective-c, cocos2d-iphone

我是 iPhone 领域的新手。我正在尝试使用 Cocos2d 构建一个 iPhone 应用程序。我已经使用了这种类型的类，如下所示-

```
@interface MenuScene : Scene {}
@end

@interface FlipView : UIImageView
{
    CGPoint startTouchPosition;
    NSString *dirString;
    UIImageView *firstPieceView;   
    UIImageView *secondPieceView;

}
@end

@interface HelloController : UIViewController 
@end

@interface MenuLayer: Layer{        
        Menu * menu;        
    NSString *dirString;
    CGPoint startTouchPosition;
}
-(void) button1: (id)sender;
-(void) button2: (id)sender;
-(void) black_jack: (id)sender;
@end 
```

我想将两个类（FlipView、HelloController）继承到 MenuLayerClass。但我该怎么做。实际上将是什么语法。请用代码或语法回复任何评论，我该怎么做。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-09T02:10:26.970

你不能。正如克拉克所说，Objective-C 不支持多重继承。这是因为设计者认为多重继承的优点并不能证明它所鼓励的复杂性和糟糕的设计是合理的。

相反，它们包含了一些可以满足您需求的东西。您可以使用 @protocol 指令声明“协议”。协议描述了类响应但不能向对象添加数据的一组方法。

要使用协议，请将协议名称包含在超类之后的尖括号中。

例如

```
@protocol myProtocol
-(void)myProtocolMethod
@end

@interface myClass : NSObject <myProtocol>
{
    int someData;
} 
```

将给出一个也必须响应`(void)myProtocolMethod`消息的 NSObject 子类。

也就是说，我同意 Clark 的观点，即你应该审查你的设计——拥有一个既是 FlipView 又是 HelloController 的对象听起来并不好。您可能应该实现一个 FlipController 并使用第三个类（模型）在两个控制器之间同步状态 - 或者如果您的应用程序非常简单，则使用一个类作为 FlipView 和 UIController 的委托。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-07T06:06:29.853

你不能，因为 Objective-C 没有多重继承。此外，让一个类既是视图又是视图控制器并没有什么意义。

# c# - 在编译时不知道对象类型时如何构建 LINQ 查询

> ID：507155
> 
> 赞同：3
> 
> 时间：2009-02-03T13:57:46.393
> 
> 标签：c#, sql, linq

我正在开发能够将过滤器应用于 LinqDataSource 对象的 Web 自定义控件。它是通用控件，因为它应该与特定类型的对象一起操作。

控件通过以下字段知道它应该操作的对象的哪个字段

```
 /// <summary>
    /// Method to get compared column from object
    /// </summary>
    public Expression<Func<T, int>> GetColumnMethod; 
```

（我转移到从对象类型中获取适当字段的方法）

我们用这样的代码执行过滤

... if (selectedValue == "<=") predicate = predicate.And(c => method(c) <= val); if (selectedValue == "<") predicate = predicate.And(c => method(c) < val);

在 LINQ 到 SQL 转换发生之前，一切正常。然后错误“方法'.....'没有支持的SQL转换。

当然，CLR 不知道如何为委托创建 SQL。

如果只有 C# 可以在转换为 SQL 之前编译表达式，但我不知道如何让它去做。

像 Expression.Compile 这样的变态（无论我尝试了一整天的任何棘手的方法 - 我已经记不清它们了......没有任何帮助）

但是......在运行时 CLR 已经知道我的对象的类型，因此它可以设法构建具有编译委托值的 SQL 表达式。但是怎么做呢？天知道。

帮助高度赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T14:07:42.240

LINQ to SQL 提供程序负责将您的表达式树转换为有效的 T-SQL 语句。由于 C# 和 T-SQL 之间没有一对一的关系，因此表达式树越复杂，LINQ to SQL 翻译的可能性就越小。

当您使用 lambda 表达式时，您必须决定是要编译它还是将其用作表达式树。如果您想将 lambda 用作表达式，那么您有责任确保表达式包含您的提供程序支持的函数和语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T14:08:48.057

它行不通。基本上，您的 LINQ 查询是有效的 C# 代码，因此它可以正常编译，但在运行时在 LINQ to SQL 提供程序范围之外的任何内容上都会失败。

在这里阅读更多：

**[“不能在 DateTime 上调用方法”和其他限制](https://stackoverflow.com/questions/323704/cannot-call-methods-on-datetime-and-other-limitations)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T14:28:00.750

如果只是选择要在查询中使用的特定字段，您应该能够使用 Expression.Compile “perversion”来做到这一点。但这可能需要做很多工作。您可能可以通过编译您现在拥有的内容并针对输出使用 Reflector 来查看 C# 编译器生成的代码的样子来抢占先机。

你能把查询分成两部分——一个被翻译成 SQL 并在服务器上运行，另一个使用你的 GetColumnMethod 并在内存中针对第一部分输出的数据运行？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T14:32:16.497

没有用于任意委托的 SQL。如果`method(c)`可以表示为 lambda，则可以使用 将 lambda 作为子表达式调用`Expression.Invoke`，但您需要自己构建表达式树，[如下所示](http://marcgravell.blogspot.com/2008/10/express-yourself.html)。

# windows - 我可以让在 Windows 上运行的 Apache 区分大小写吗？

> ID：507156
> 
> 赞同：15
> 
> 时间：2009-02-03T13:57:58.780
> 
> 标签：windows, apache, file

Windows 文件系统（FAT、NTFS）不关心文件名的大小写（不区分大小写）。因此，在 Windows 上运行的程序（例如 Apache Web 服务器）不区分大小写处理文件。

当您在 Windows 上创建网站时，您会无意中创建与实际文件名大小写不匹配的链接等。在将网站部署到区分大小写的文件系统（Linux、UNIX 上的默认设置...）之前，您通常不会注意到这个错误。

现在，我想知道是否有一种方法可以通过**使 Apache Web 服务器以某种方式关心大小写，即使文件系统不关心，**也可以避免此类错误。我的意思是 NTFS 在文件名中的大写和小写字母之间确实存在差异，因此理论上应该可以检查文件名是否以区分大小写的方式匹配。

* * *

我知道像“*只使用小写*”这样的命名约定可以帮助避免这类问题，但这对现有文件没有帮助而且不太方便:-)

此外，不使用 Windows 也不是一种选择。我不会自愿使用 Windows，在这种情况下不可能在不同的平台上运行 Apache。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T14:21:29.763

据我所知，你不能，但我会关注这个问题以获得其他答案。

作为一种解决方法，您说您必须在 Windows 上进行开发。在虚拟 PC 中安装 Linux 怎么样。有几个免费的 VM 程序，例如[VirtualBox](http://www.virtualbox.org/)和[Microsoft Virtual PC](https://www.microsoft.com/windows/downloads/virtualpc/default.mspx)。这样，您可以将您的开发环境与您的部署环境相匹配。

除此之外，我发现最好确保所有内容都使用小写字母，从而最大限度地减少错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-03T21:18:29.957

根据 Apache 文档，这是不可能的，因为 Windows 操作系统中嵌入了不区分大小写的功能。但是你可以“扭转问题”，让 Linux/Unix 下的 Apache 服务器不区分大小写。只需将以下指令添加到您的 .htaccess 中：

```
RewriteEngine On
RewriteMap lowercase int:tolower
RewriteCond %{REQUEST_URI} [A-Z]
RewriteRule (.*) ${lowercase:$1} [R,L] 
```

[请参阅此处](http://httpd.apache.org/docs/trunk/platform/windows.html)的文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-04-15T01:01:45.747

所以现在可以在 Windows 10 上执行此操作 [https://www.windowscentral.com/how-enable-ntfs-treat-folders-case-sensitive-windows-10](https://www.windowscentral.com/how-enable-ntfs-treat-folders-case-sensitive-windows-10)

fsutil.exe 文件 SetCaseSensitiveInfo C:\folder\path 启用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T14:01:15.030

~~看来您可以在 Apache 配置文件中使用指令 CheckSpelling on 启用 mod_spelling。~~

~~信息和上下文在这里找到：http: [//bytes.com/topic/apache/answers/608164-apache-case-sensitive-urls](http://bytes.com/topic/apache/answers/608164-apache-case-sensitive-urls)~~

编辑：上面引用了问题的反面，对不起。有人确实会问与你之后相同的问题，但无论答案是否有效，都不会回应。进一步观察后，apache 本身似乎没有任何标志或任何设置来执行此操作。有些人建议尝试使文件系统区分大小写，这似乎是可能的，但看起来它会导致更多问题，尤其是对于其他不期望这种情况的程序。

总体而言，如果您不能在另一个操作系统上进行开发，并且您无法将所有现有文件名更改为小写（这是可以理解的），那么看起来您真的没有很多选择。在这一点上，我给您的唯一建议是尝试获得一个测试环境，设置与您的生产环境完全相同，并在发送到生产环境之前尽可能多地进行测试。

很抱歉造成误解，我无法提供更多帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-03T14:54:10.617

NTFS 实际上确实支持区分大小写的文件名。它由 Microsoft 的 UNIX 服务使用和启用。它在注册表中进行控制。在“ObCaseinSensitive”注册表项上进行谷歌搜索。例如[msdn 博客](http://www.siao2.com/2008/01/12/7062458.aspx) ，尤其是这篇 microsoft KB 文章：[kb817921](http://support.microsoft.com/kb/817921)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-03T15:04:04.420

这不是你可以用你想要的方式解决的问题。您需要通过强制小写来上传文件。您将避免 Windows 上的命名冲突问题，因此如果您在 Windows 上构建东西，那么您不必担心这一点。现在，您需要使用某种链接检查程序来查找包含大写字母的 URL，然后用等效的小写字母替换。

但是，Ryan Guill 确实提出了一个很好的建议来启用 CheckSpelling。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-05-21T06:11:56.320

Windows，可以设置为区分大小写模式。NTFS 卷也支持区分大小写模式。如果您之前安装了 UNIX 互操作性，您的 Windows 可能已经变成了区分大小写的模式。我相信注册表中有一个开关，但我忘记了它在哪里，所以我无法为您找到它。:-(

# sql - 外键会提高查询性能吗？

> ID：507179
> 
> 赞同：161
> 
> 时间：2009-02-03T14:03:27.570
> 
> 标签：sql, sql-server, performance, indexing, foreign-keys

假设我有 2 个表，Products 和 ProductCategories。两个表在 CategoryId 上都有关系。这就是查询。

```
SELECT p.ProductId, p.Name, c.CategoryId, c.Name AS Category
FROM Products p
INNER JOIN ProductCategories c ON p.CategoryId = c.CategoryId
WHERE c.CategoryId = 1; 
```

当我创建执行计划时，表 ProductCategories 执行集群索引查找，这是预期的。但是对于表产品，它执行集群索引扫描，这让我怀疑。为什么 FK 无助于提高查询性能？

所以我必须在 Products.CategoryId 上创建索引。当我再次创建执行计划时，两个表都执行索引查找。并且估计的子树成本降低了很多。

我的问题是：

1.  除了 FK 有助于关系约束之外，它还有其他用处吗？它会提高查询性能吗？

2.  我应该在所有表中的所有 FK 列（喜欢 Products.CategoryId）上创建索引吗？

* * *

## 回答 #1

> 赞同：202
> 
> 时间：2009-02-03T14:07:29.060

外键是参照完整性工具，而不是性能工具。至少在 SQL Server 中，创建 FK 不会创建关联索引，您应该在所有 FK 字段上创建索引以缩短查找时间。

* * *

## 回答 #2

> 赞同：65
> 
> 时间：2009-02-03T14:14:07.390

外键可以提高（并损害）性能

1.  如此处所述：[外键提高性能](http://www.microsoft.com/technet/abouttn/flash/tips/tips_122104.mspx)

2.  您应该始终在 FK 列上创建索引以减少查找。SQL Server 不会自动执行此操作。

**编辑**

由于链接现在似乎已失效*（感谢 Chris 的注意）*，以下显示了为什么外键可以提高（和损害）性能的要点。

[外键可以提高性能吗](http://www.experts-exchange.com/Microsoft/Development/MS-SQL-Server/A_4293-Can-Foreign-key-improve-performance.html)

> 外键约束提高了读取数据时的性能，但同时降低了插入/修改/删除数据时的性能。
> 
> 在读取查询的情况下，优化器可以使用外键约束来创建更有效的查询计划，因为外键约束是预先声明的规则。这通常涉及跳过查询计划的某些部分，因为例如优化器可以看到由于外键约束，没有必要执行计划的特定部分。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2009-02-03T14:10:34.310

外键是用于确保数据库完整性的 DBMS 概念。

任何性能影响/改进都将特定于所使用的数据库技术，并且次要于外键的用途。

SQL Server 中的良好做法是确保所有外键上至少有一个非聚集索引。

我希望这可以为您解决问题，但请随时索取更多详细信息。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-02-03T15:02:27.607

您的最佳性能选择是在您经常使用的字段上使用索引。如果您使用 SQL Server，您可以使用分析器来分析特定数据库并获取输出文件并使用调整向导来接收有关放置索引的位置的建议。我也喜欢使用分析器来清除长时间运行的存储过程，我每周都会发布十大最严重的违规者名单，让人们诚实:D。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-02-03T14:15:42.100

您可以使用它来帮助提高查询效率。它确实允许您在 SQL Server 中重组查询以使用外部联接而不是内部联接，这消除了 sql 服务器必须检查列中是否存在空值的必要性。您不需要输入该限定符，因为外键关系已经为您强制执行。

所以这：

```
select p.ProductId, p.Name, c.CategoryId, c.Name AS Category 
from Products p
inner join ProductCategories c on
p.CategoryId = c.CategoryId
where c.CategoryId = 1; 
```

变成这样：

```
 SELECT p.ProductId, p.Name, c.CategoryId, c.Name AS Category 
 FROM ProductCategories c 
 LEFT OUTER JOIN Products P ON
 c.CategoryId = p.CategoryId 
 WHERE c.CategoryId = 1; 
```

这不一定会在小型查询中产生巨大的性能，但是当表变大时它可能会更有效。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-02-03T15:09:52.927

我对 SQL Server 了解不多，但在 Oracle 的情况下，拥有外键列会降低数据加载的性能。那是因为数据库需要检查每个插入的数据完整性。是的，正如已经提到的，在外键列上建立索引是一种很好的做法。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2011-08-28T09:43:07.560

在表中添加外键不会提高性能，只是说如果您在 ProductCategories 表数据库中插入一条记录，将尝试查找外键列的值存在于产品表的主键值中，这个查找，每次在 ProductCategories 表中添加新条目时，操作都会对数据库产生开销。因此，通过添加外键不会提高您的数据库性能，但会注意数据库的完整性。是的，如果您使用外键检查完整性而不是运行许多查询来检查程序中的数据库中是否存在记录，它将提高您的数据库的性能。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-06-18T22:03:59.660

对于 MySQL 5.7，它绝对可以非常好地加速涉及多个连接的查询！

我使用“解释”来理解我的查询，发现我加入了 4-5 个表——根本没有使用任何键。我只为这些表添加了一个外键，结果是加载时间减少了 90%。超过 5 秒的查询现在需要 500 毫秒或更短的时间。

这是一个巨大的进步！

而且，正如其他人所提到的，您可以获得确保关系完整性的额外好处。

除此之外，确保参照完整性也有其自身的性能优势。它具有确保具有外键的表与外表“最新”的二阶效果。假设您有一个用户表和一个评论表，并且您正在对评论表进行一些统计。可能如果您硬删除用户，您也不再需要他们的评论。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-04-20T01:11:21.317

从 SQL Server 2008 开始，外键可以通过影响数据库引擎选择优化查询的方式来影响性能。请参阅以下文章中的 Star Join Heuristics：[https ://technet.microsoft.com/en-us/library/2008.04.dwperformance.aspx](https://technet.microsoft.com/en-us/library/2008.04.dwperformance.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-06-26T18:10:35.313

是的，FK可以加速`SELECT`但减速`INSERT/UPDATE/DELETE`

SQL Server 使用*所有*约束（包括 FK）来为 s 构建更好的执行计划`SELECT`。

例如，如果您使用约束运行查询`Column1 = X`并且`X`不符合约束，则服务器甚至不会触及表。

P.S. unless the constraint is in ["untrusted" state](https://www.brentozar.com/blitz/foreign-key-trusted/), but that's a whole different story.

P.P.S. However having a foreign key (or other constraints) can slow down `INSERT/UPDATE/DELETE`s unless you have a non-clustered index on this column

# excel - 标准 VBA 函数的“找不到项目或库”

> ID：507191
> 
> 赞同：86
> 
> 时间：2009-02-03T14:05:45.363
> 
> 标签：excel, vba, reference, namespaces

因此，我不得不在我的 PC 上运行其他人的 excel 应用程序，并且在标准函数（例如日期、格式、十六进制、中间值等）上出现“找不到项目或库”。

一些研究表明，如果我在这些函数前面加上“VBA”。就像在“VBA.Date”中一样，它会正常工作。

网页表明它与我系统上的项目引用有关，而它们在开发人员的系统上必须没问题。我将在一段时间内从其他人那里处理这个问题，并将这些应用程序分发给许多其他人，所以我需要了解我需要修复的 Excel 设置有什么问题，或者需要在xls 文件，以便它可以在各种系统上运行。我想避免让每个人都使用“VBA”。作为明确的参考，但如果没有理想的解决方案，我想这就是我们必须做的。

*   我如何制作“VBA”。隐含在我的项目属性/引用/等中？

-亚当

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2009-02-03T14:24:08.387

如果缺少对完全不同的库的引用，我已经看到标准函数的错误。

在 VBA 编辑器中，从菜单中启动 Compile 命令，然后检查 References 对话框以查看是否缺少任何内容，如果有，请尝试添加这些库。

一般来说，编译完整的 VBA 代码然后在分发之前保存文档似乎是一种好习惯。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2011-07-08T14:18:59.747

我有同样的问题。这对我有用：

*   在 VB 中，转到工具 » 参考
*   取消选中库“Crystal Analysis Common Controls 1.0”。或任何图书馆。
*   只需留下这 5 个参考：
    1.  Visual Basic For Applications（这是定义 VBA 语言的库。）
    2.  Microsoft Excel 对象库（它定义了 Excel 的所有元素。）
    3.  OLE 自动化（这指定了用于链接和嵌入文档以及其他应用程序自动化的类型以及 Excel 用于与外部世界通信的 COM 系统的“管道”。）
    4.  Microsoft Office（这定义了所有 Office 程序共有的东西，例如命令栏和命令栏控件。）
    5.  Microsoft Forms 2.0 如果您使用的是用户表单，这是必需的。这个库定义了诸如用户表单和可以放置在表单上的控件之类的东西。
*   然后保存。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2009-03-04T22:44:11.347

我遇到了这个确切的问题，并发现在用户机器上，我所依赖的库之一在引用对话框中被标记为“MISSING”。在这种情况下，我的 Office 2007 版本中提供了一些办公字体库，但客户端桌面上没有。

您得到的错误是一个完整的红鲱鱼（正如 divo 指出的那样）。

幸运的是，我没有使用库中的任何东西，所以我能够将它从 XLA 引用中完全删除。我想，divo 建议的最佳实践的扩展是用于测试以检查所有目标 Office 版本上的 XLA（无论如何都不是一个坏主意）。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-07-11T14:14:27.783

在我的例子中，该函数是 AMBIGUOUS，因为它是在 VBA 库（在我的参考资料中）和 Microsoft Office 对象库（也存在）中定义的。我删除了 Microsoft Office 对象库，瞧！无需使用 VBA。字首。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2020-02-05T01:09:45.990

就我而言，我什至无法在 Visual Basic 窗口中打开“参考”。我什至尝试重新安装 Office 365，但没有成功。最后，我尝试在“信任中心”设置中禁用宏。当我重新启动 Excel 时，我收到了宏被禁用的警告消息，当我单击“启用”时，我不再收到错误消息。

后来我重新启用了“信任中心”设置中的所有宏，错误信息没有出现！

嘿，如果没有其他方法适合您，请尝试上述方法；它对我有用！:)

**更新：** 问题又回来了，这就是我*第二次*“修复”它的方式：

我在**Excel 中在线**打开了我的工作簿（Office 365，在浏览器中，无论如何都不支持宏），用新文件名保存它（仍然使用 .xlsm 文件扩展名），然后在桌面软件中重新打开。有效。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-11-03T19:27:57.520

对于那些还没有找到任何其他答案的人适合你。

试试这个：

关闭文件，通过电子邮件将其发送给自己，或者如果您在工作，将其从网络驱动器粘贴到您的桌面上，以使其在“保护模式”下打开。

现在打开文件

不要点击任何启用编辑或黄丝带

转到 VBA 编辑器

转到Debug - - Compile VBA Project，如果“Compile VBA Project”是灰色的，那么您可能需要单击一次黄色功能区才能启用内容，但不要启用宏。

单击编译后，保存，关闭文件。重新打开它，启用一切，它应该没问题。这对我来说 100% 的时间都有效。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-02-05T10:47:45.197

就我而言，我正在家里（没有 Visio）检查我的办公室计算机（安装了 Visio）上完成的工作。尽管 VBA 似乎被简单的默认函数挂断了，但问题是我对 Visio 库的引用仍然处于活动状态。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-10-09T08:10:01.640

我找到了对 AVAYA/CMS 程序文件的引用？完全随机，这是在 MS Access 中，与 AVAYA 无关。我的 PC 上确实有 AVAYA，而其他人没有，所以这解释了为什么它在我的机器上而不是其他机器上工作 - 但不是 Access 如何链接到 AVAYA。无论如何-我只是取消选中了参考，这似乎已经解决了问题

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-12-04T22:30:01.507

即使所有引用都很好，前缀问题也会导致编译错误。

如何为所有模块中的所有“内置 VBA 函数”创建一个查找和替换子程序，如下所示：

[替换代码模块中的文本](https://stackoverflow.com/questions/44349684/replace-text-in-code-module)

例如，“= Date”将替换为“= VBA.Date”。

例如，“Date(”将被替换为“VBA.Date(”。

（不包括“dim t As Date”或“mydate”）

查找和替换的所有 vba 函数都写在这里：

[vba 函数列表](https://bettersolutions.com/vba/functions/complete-list.htm)

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2020-09-21T07:50:15.907

我已经在几个 XLSM 文件中打开和关闭了这个错误大约两年（这是最烦人的，因为当它发生时文件没有任何问题！-我怀疑孤立的 Excel 进程是问题的一部分）

我发现最有效的解决方案是将 Python 与 oletools 一起使用， `https://github.com/decalage2/oletools/wiki/Install`并提取所有模块的 VBA 代码并保存在文本文件中。

然后我只是将文件重命名为 zip 文件（备份以防万一！），打开这个 zip 文件并删除 xl/vbaProject.bin 文件。重命名回 XLSX，应该可以了。

复制保存的 VBA 代码（需要清理换行符、注释和其他内容。还需要添加缺少的库。

当其他方法没有时，这救了我。

YMMV。

# asp.net-mvc - MVC 批量编辑 - 示例

> ID：507208
> 
> 赞同：3
> 
> 时间：2009-02-03T14:11:12.373
> 
> 标签：asp.net-mvc, linq, linq-to-sql

[好的，所以这是这个问题](https://stackoverflow.com/questions/506381/mvc-bulk-edit-linq-to-sql-list-save)的替代方案。

我正在尝试使用 LinqToSql 生成一个 MVC 应用程序，该应用程序允许在单个页面上批量编辑数据。

想象一个简单的表 Item，其中 ItemId、ItemName、ItemPrice 作为字段。

有许多非常简单的 MVC 应用程序示例，它们向您显示这些项目的列表，每个项目旁边都有一个编辑按钮，底部有一个添加按钮。

从 UI 的角度来看，当需要输入/更新大量数据时，我发现这非常耗时。

我在一个页面之后，其中包含文本框中的项目名称和价格，这些文本框中都可以一次性编辑，然后按下一个“保存”按钮来更新数据。

我已经看到了许多执行不同阶段的示例，但还没有找到一个实现完整解决方案的示例。特别是与 Linq 的交互。

我尝试了许多方法，它们都有效，但是，我的直觉告诉我我的方法“有味道”，因此我想看看其他人如何尝试的一些例子。

所以，简而言之，我的问题是任何人都可以提供一些示例的链接吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T16:21:53.373

我已经[写过如何](http://lunaverse.wordpress.com/2009/01/13/editing-a-variable-length-list-of-items-with-mvccontribfluenthtml-take-2/)使用[MvcContrib](http://www.codeplex.com/MVCContrib)的 FluentHtml 来做到这一点。Steve Sanderson[写过如何在](http://blog.codeville.net/2008/12/22/editing-a-variable-length-list-of-items-in-aspnet-mvc/)没有 FluentHtml 的情况下做到这一点。我们的两篇文章都有一个示例解决方案，您可以下载并查看。

就 LinqToSql 而言，我认为批量编辑机制（控制器和视图）与 LinqToSql 之间的任何交互都是一种气味。也就是说，尽可能让你的 UI 不知道你的持久化机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T14:27:06.927

为了解决这个问题，我可能会做的是在切换行时使用 jQuery 调用 jsonResult。此 jsonResult 将调用模型中的代码以仅为您要关闭的行保存 ItemId、ItemName、ItemPrice。更多关于一般 jsonResult w/jQuery 用法的信息：http: [//www.dev102.com/2008/08/19/jquery-and-the-aspnet-mvc-framework/](http://www.dev102.com/2008/08/19/jquery-and-the-aspnet-mvc-framework/)

您可以做的另一件事是将模型绑定到项目列表，遍历列表以保存每个项目——Phil Haack 在这里有一个列表绑定示例：http: [//haacked.com/archive/2008/10/23 /model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)使用任何一种方法，您都需要做一些事情来表明该行已更改，因此如果您只是更改少数几行，则不会更新每个字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T15:52:22.217

你的目标到底是什么，你是否试图一次提交一系列信息？还是您只是不希望您的页面在每次更改时都回发。无论哪种情况，jQuery 都是您最好的选择。如果你想一次性完成所有事情，除非你使用 jQuery 控件来为你做这件事，否则它会变得很复杂。有一些很棒的，比如[Flexigrid](http://code.google.com/p/flexigrid/)。

# asp.net - 发布我的 ASP.NET 站点会破坏 Subversion 文件

> ID：507210
> 
> 赞同：2
> 
> 时间：2009-02-03T14:12:09.580
> 
> 标签：asp.net, svn, deployment

我一直在尝试使用 SVN 将我的 asp.net 站点部署到生产环境。我的工作流程是：

设置：将站点发布到 FolderX，将 FolderX 导入到 SVN，使用 FolderX 的存储库更新 Web 服务器生产文件夹。

每天：将更新的站点发布到 FolderX、提交更改、使用更改更新远程服务器。

这就是理论，但是当我再次将站点发布到 FolderX 时，它会破坏所有站点子文件夹中的 .svn 文件夹。

如何防止这种情况发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-24T01:04:48.417

如果您使用的是 tortoisesvn，请在设置中单击“使用 _svn 而不是 .svn 目录”。

然后希望发布不会忽略 .svn 目录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T14:44:43.883

好吧，有几件事：

首先，如果网站中的 .svn 文件夹被破坏了，这有什么关系呢？您肯定不会从生产环境中重新提交到 SVN 吗？我怀疑您遇到的问题是以后的更新。您可以通过在更新之前删除整个站点来解决该特定问题。

其次，为什么要尝试使用 SVN 进行部署？这并不是它的真正用途，只需大约 5 行批处理代码即可将整个树部署到生产位置。

# visual-studio - 如何在 Visual Studio 中自动生成接口的实现者？

> ID：507211
> 
> 赞同：0
> 
> 时间：2009-02-03T14:12:21.623
> 
> 标签：visual-studio, eclipse

在 Eclipse 中，我可以使用为接口自动生成的存根方法创建一个类。当然这在 Visual Studio 中以某种方式工作，但对于我的生活，我无法弄清楚如何......

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T14:14:25.877

是的你可以。像往常一样输入接口名称，然后在接口名称下方寻找一个智能标签。展开它，它将为您提供用于实现界面的菜单选项。

键盘快捷键是`Control + .`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T14:17:39.507

这是一篇关于 Visual Studio 2005 中代码重构功能的好文章。

[使用 Visual Studio 2005 重构 C# 代码](http://msdn.microsoft.com/en-us/library/ms379618.aspx#vs05_refac_topic5)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T14:18:25.993

输入界面的名称，然后右键单击它（使用智能标签），或者，我个人最喜欢的，按 ctrl + point。（无需伸手去拿鼠标；））。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-03T14:16:20.820

在 vb.net 中你只需编写类名实现接口 [按 enter here]

# asp.net - asp:repeater - 部分更改的标题

> ID：507215
> 
> 赞同：4
> 
> 时间：2009-02-03T14:13:17.813
> 
> 标签：asp.net, data-binding, formatting, repeater

有什么方法可以在数据绑定 asp:repeater 控件中的字段更改时显示子标题行，例如

代替

```
国家 | 颜色 | 数字
英国 | 红色 | 3
英国 | 绿色 | 3
法国| 家企业 红色 3
```

做这个：

```
==英国==
颜色 | 数字
红色 | 3
绿色 3
==法国==
颜色 | 数字
红色 | 3
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-03T14:31:26.967

没有内置支持，但这并不意味着它是不可能的。

您需要覆盖 OnItemDataBound 事件，并在标记中有类似的内容：

```
<asp:Repeater OnItemDataBound="NextItem" ... >
    <ItemTemplate><asp:Literal Id="Header" Visible="False" Text="{0}<strong>{1}</strong><br/><table>" ... />
         <tr>
             <td><asp:Label id="Color" Text="<%# Eval("Color")" ... /></td>
             <td><asp:Label id="Number" Text="<%# Eval("Number")" ... /></td>
         </tr>
    </ItemTemplate>
</asp:Repeater></table> 
```

然后在代码隐藏中：

```
private string CurCountry = string.Empty;

private void NextItem(object sender, RepeaterItemEventARgs e)
{
    if ( e.Item.ItemType != ListItemType.Item 
      && e.Item.ItemType != ListItemType.AlternatingItem) return;

    DbDataRecord row = (DbDataRecord)e.Item.DataItem;

    if (CurCountry != row["country"].ToString() )
    {
        string prev = (CurCounter == string.Empty)?"":"</table>";
        CurCountry = row["country"].ToString();

        Literal header = (Literal)e.Item.FindControl("Header");
        Literal footer = (Literal)e.Item.FindControl("Footer");

        header.Text = string.Format(header.Text, prev, CurCountry);
        header.Visible = true;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T11:27:49.677

另一种解决方案是简单地使用两个中继器，一个嵌套在另一个中。您可以将带有子记录的组传递给第一个转发器，然后在组转发器的 ItemDataBound 上，将子记录传递给子转发器并在那里调用 DataBind()。

这是更多的代码，但实际上可以让您更好地控制布局，而无需在代码隐藏中使用 HTML 创建代码。

正如您在此处看到的，我们有一个父中继器，并且在项目模板中，我们可以根据需要自定义每个组。在 ChildRepeater 中，我们有我们的项目模板，我们可以在其中自定义分组内的每个项目。非常干净，并且全部带有声明性 UI。

```
<asp:Repeater runat="server" id="GroupRepeater">
 <ItemTemplate>
   <asp:Literal runat="server" id="HeaderText" />
   <asp:Repeater runat="server id="ChildRepeater">
    <ItemTemplate>
      <asp:Literal runat="server" id="InfoGoesHere" />
    </ItemTemplate>
   </asp:Repeater>
 </ItemTemplate>
</asp:Repeater> 
```

在后面的代码中，我们可以有这样的东西：

```
private void GroupRepeater_ItemDataBound(object sender, RepeaterItemEventArgs e)
{
  //Get the child records, this can be any data structure you want
  SomeChildCollection children = ((SomeGroupCollection)e.Item.DataItem).Children;
  //Find the child repeater
  Repeater childRepeater = e.Item.FindControl("ChildRepeater") as Repeater;
  childRepeater.ItemDataBound += SomeMethod;
  childRepeater.DataSource = children;
  childRepeater.DataBind();
} 
```

绑定每个子项后，您可以订阅 ItemDataBound 事件并按照您认为合适的方式将子项绑定到控件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T14:22:12.740

啊 - 你在一个分组中继器之后。我过去采用的[解决方案似乎已经消失了。](http://www.dotnetjunkies.ddj.com/Article/4365153F-D2F5-4C77-9FE7-94DD1AAF6F98.dcik)也许你能找到它。但无论如何，搜索分组中继器应该会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T14:58:25.493

乔尔解决方案，我可以建议以下 - 改变这一行：

```
header.Text = string.Format("<strong> {0} </strong><br/><table>", CurCountry); 
```

到

```
header.Text = string.Format(header.Text, CurCountry); 
```

而且您可以从 .as?x 文件自定义外观。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T11:20:55.213

dotnetjunkies 代码中似乎有一些错误，但我在这里找到了一个更简单的解决方案[http://www.west-wind.com/weblog/posts/140753.aspx](http://www.west-wind.com/weblog/posts/140753.aspx)

现在中继器不支持分组，所以你必须自己做，但它很容易做到。在上面的转发器中，以下数据表达式负责分组：

```
<%# this.RenderGroup(Eval("Group") as
string) %> 
```

表达式调用表单上的方法来呈现额外的 div 标记。这个简单方法的代码如下所示：

```
string LastGroup = "@#@~";
protected string RenderGroup(string Group) {   
    if (Group == this.LastGroup)       
    return "";     // *** Group has changed    
    this.LastGroup = Group;    
    return "<div class='groupheader'>" +Group + "</div>";
} 
```

每个项目都会调用此代码，它只是检查组是否已更改。如果没有返回任何内容，否则返回一个简单的 div 标签作为字符串嵌入到标记中。我选择发回 HTML，但我想你也可以返回 true 或 false 并有条件地在 Repeater 中渲染一个控件，这将使 CSS 纳粹更快乐。

# asp.net - 消息/确认对话框

> ID：507220
> 
> 赞同：1
> 
> 时间：2009-02-03T14:15:10.463
> 
> 标签：asp.net, javascript

我需要通过按钮单击确认消息框，但仅在某些情况下。我在 aspx.page 上检查两个值，如果一个值高于另一个值，我需要用户确认。有没有（简单的）方法可以做到这一点？我一直在阅读有关 javascript 和警报消息的信息，但我似乎无法弄清楚这一点……我正在使用 RadStudio 2007，.net 应用程序。

任何帮助都会得到帮助。安雅

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T14:21:09.360

JavaScript 提供了你需要的确认功能。这将显示一个确认框，允许用户“确定”或“取消”。基于您需要的示例函数：

```
function FormSubmit(){
    var value1 = document.getElementById("Textbox1").value;
    var value2 = document.getElementById("Textbox2").value;
    if(value1 > value2){
        if(confirm("Are you sure?")) {return true;} else {return false;}
    }
} 
```

现在可以将此功能添加到按钮的 onclick 方法中

```
<input type="Button" value="Submit" onclick="return FormSubmit()" /> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T14:24:59.257

这是 javascript 中的确认消息示例：

```
<a href="deleteUser.aspx?id=231" onclick="return confirm('Are you sure you want to delete user ?')">Delete User</a> 
```

[其他一些有用的例子](http://www.michael-thomas.com/tech/javascript/ex_confirm.htm)

# asp.net - 我在哪里可以为 Delphi Prism 定义条件编译常量？

> ID：507225
> 
> 赞同：4
> 
> 时间：2009-02-03T14:16:11.037
> 
> 标签：asp.net, visual-studio, delphi, oxygene

我刚刚将 Web 服务从 Delphi.NET 2006 移植到 Delphi Prism 2009（在 Visual Studio 2008 IDE 中运行）。但是我找不到应该设置（或取消设置）条件编译常量的位置！

我是瞎了吗，这个选项被忽略了，还是在 VS 中不支持？

[编辑：感谢 Mohammed Nasman 的链接] MSDN 告诉我使用项目设计器设置它们。首先，我花了一段时间才发现只有在选择解决方案时才可见项目菜单（而不是 Web 服务项目）。然后，仍然无法在项目设计器中设置条件编译常量！

我只是找不到进入 ASP.NET 项目中的[项目选项](http://prismwiki.codegear.com/en/Project_Options)的方法......真的不可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-03T18:37:26.797

Delphi Prism 使用 VS [How to：声明条件编译常量](http://msdn.microsoft.com/en-us/library/3dxx7dta(VS.80).aspx)

对于 Asp.net[条件编译常量和 ASP.NET](http://haacked.com/archive/2007/09/16/conditional-compilation-constants-and-asp.net.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-11T22:56:44.067

如果您在解决方案资源管理器中右键单击项目节点（任何项目，而不仅仅是 Delphi Prism），然后单击上下文菜单中的“属性”选项，项目选项选项卡簿应出现在文本编辑器窗格中。单击构建选项卡，它应该是左侧的第三个选项卡。该页面上出现的第一个文本框应标记为“条件编译符号”。它应该已经包含符号：“DEBUG;TRACE”。您可以在那里添加自己的符号。

您还可以通过在解决方案资源管理器中选择项目节点，然后单击解决方案资源管理器窗口中左上角的工具栏按钮来访问项目属性选项卡。

# programming-languages - 用于音乐创作的高级编程语言

> ID：507227
> 
> 赞同：31
> 
> 时间：2009-02-03T14:16:35.453
> 
> 标签：programming-languages

我想写一首互动歌曲。它将包含状态和逻辑。听众/用户应该能够使用 GUI 或 MIDI 界面修改一些状态变量。听众可访问的变量不必直接表示速度、音高或任何其他音乐属性。他们宁愿代表逻辑将处理以对歌曲进行更改的值。

我必须自己编写这样的平台还是已经存在适合我想象的东西？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-03T14:19:22.530

看看[cSounds](http://www.csounds.com/)和[PureData](http://puredata.info/)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-03T14:51:10.077

如果您乐于使用 Java，请查看[JFugue](http://www.jfugue.org/)。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2011-12-17T23:35:50.107

我试过[PureData](https://puredata.info/)、[CSound](http://csound.com/)和[SuperCollider](http://supercollider.github.io/)。

CSound 的编程非常麻烦，并且在版本 4 中对我的要求（24bit/96kHz 实时低延迟 linux）有严重的稳定性问题。

PureData 是图形化的，与使用文本文件相比，这使得保持代码整洁和整洁变得更加困难。作曲很痛苦，因为您必须构建自己的作文 GUI，它可能很强大，但只要我是唯一的用户，我发现使用文本会更快。

获胜者无疑是 SuperCollider，因为它是一种受 smalltalk 启发的面向对象语言，使用起来非常愉快。它分为 OSC 控制的声音服务器和客户端语言。我可以毫无保留地推荐声音合成服务器并使用该语言创建乐器，因为它具有出色的稳定性、极大的灵活性和令人难以置信的强大功能。我在舞台上现场使用过，表现非常好。

乐谱创作语言患有多手综合症；最近缺乏明确的领导，有太多的方法可以做太多的事情，有太多的限制，但它仍然比 CSound 好，因为至少你可以使用合理的高级结构。

仍在寻找一种正确的组合语言。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-03-26T20:38:38.890

看看**[斯特拉希拉](http://strasheela.sourceforge.net/strasheela/doc/index.html)**：

它是一个基于编程语言 Oz 的组合系统。学习 Oz 并不容易，因为它结合了函数式和逻辑编程范式。但是，如果您喜欢**[SICP](http://mitpress.mit.edu/sicp/full-text/book/book.html)**书，那么您可能也会喜欢它。

Strasheela 将音乐创作视为一个约束统计问题 (CSP)，并为其寻求“解决方案”。这意味着音乐风格被定义为整数（有限域）上的数学约束，必须对其进行统计，并且内置的约束求解系统会“自动”计算解。

PS：我不能在 Oz 中编程，但我正在学习它。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-03T14:20:19.080

请参阅[用于计算机音乐的高级语言](http://www.cs.ucsc.edu/~sasha/proj/musicpaper.pdf)和[用于音乐的编程语言以](http://www.nosuch.com/plum/cgi/showlist.cgi?sort=name&concise=yes)获得帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-03T14:24:48.087

我不确定它是否涵盖了您所追求的目标，但请查看[Java Sound API](http://java.sun.com/products/java-media/sound/)。有关它可以做什么的常见问题解答，请参见[此处](http://www.jsresources.org/faq_midi.html)。好处是已经捆绑在 SDK 和 JRE 中并且是跨平台的。此外，您可以使用任何 Java 工具包构建 GUI。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-26T21:02:32.640

如果不是为了交互位，我建议看一下[Haskore](http://www.haskell.org/haskore/)或[Nyquist](http://www.cs.cmu.edu/afs/cs.cmu.edu/project/music/web/music.software.html)，它们实际上都是用于音乐生成的 DSL。

不过，一定要看看[Alex McLean 的实时编码](http://yaxu.org/category/livecoding/)演示。它更加灵活和互动，你可以想象，通过[OpenSoundControl使用](http://supercollider.sourceforge.net//)[SuperCollider](http://opensoundcontrol.org/)。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-07-17T20:36:34.023

答案适用于 .NET：
我发现了一些东西，请查看[Mark Heath的](http://mark-dot-net.blogspot.com/search/label/NAudio)[NAudio](http://naudio.codeplex.com/)，这是一个很棒的 .NET 音乐库，我会说它应该包含在 BCL 中。

[midi-dot-net](http://code.google.com/p/midi-dot-net/)是 Tom Lokovic 的另一个出色的 C# 项目。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2010-12-23T19:21:24.627

对于音乐交互，PureData、Max/MSP 和 OpenMusic（最后这两个来自 IRCAM）是最好的。PureData 是免费软件。谷歌他们！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-03T16:42:38.683

我真的不明白你想要做什么，但这里有一些 CL 音乐软件的列表，用于作曲和认知：[http ://www.cliki.net/Music](http://www.cliki.net/Music)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-03-26T20:45:18.453

您正在寻找一种[音频编程语言](http://en.wikipedia.org/wiki/Audio_programming_language)。您应该考虑的另一个选项是[处理](http://processing.org/)- 许多艺术家和音乐家用于此类工作。

-亚当

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2013-11-01T05:11:31.830

遗憾的是，没有人提到 Chuck ...... Chuck 是一种专门为音乐/音频生成和作曲而构建的编程语言。[您可以在http://chuck.stanford.edu](http://chuck.stanford.edu)下载 Chuck， 它更易于使用，并且对 c、c++、java 等非常熟悉，但它也更容易学习。您可以在 Coursera 上免费找到有关 Chuck来自加州艺术大学，链接[在这里。](https://class.coursera.org/chuck101-001/class)

# authorization - 从 ADFS 迁移到日内瓦框架

> ID：507234
> 
> 赞同：2
> 
> 时间：2009-02-03T14:18:04.327
> 
> 标签：authorization, identity, federated-identity, geneva-framework, claims-based-identity

我的公司需要联合身份解决方案，作为 Microsoft 商店，我们希望使用 MS 技术来实现这一目标。

我们在生产中没有 Server 2008 或 .NET 3.5，因此我们仅限于基于 .NET 2.0/Server 2003 的解决方案。

这意味着（就联合身份解决方案而言）[Active Directory 联合服务](http://technet.microsoft.com/en-us/library/cc736690.aspx)。

ADFS 看起来不错，因为它支持 WS-Federation 标准，这意味着我们可以与不使用 Microsoft 技术的合作伙伴进行联合。

不幸的是（对我们来说），微软即将发布基于 .NET 3.5 的身份框架，即[日内瓦框架](https://connect.microsoft.com/site/sitehome.aspx?SiteID=642)。

日内瓦框架似乎在各方面都优于 ADFS（主要是因为它是 ADFS 加上额外的功能和标准支持）。

由于我们不是 .NET 3.5 商店，并且 Geneva 仅处于测试阶段，因此目前这对我们来说不是一个可行的选择。

**我的问题是：我们从 ADFS 搬到日内瓦有多难？**

我们正处于 ADFS 的概念验证阶段，因此我们还没有开始深入研究从基于身份的授权转移到基于声明的 ADFS 所需的代码更改。我确信我们可以将这个逻辑放在一个可以更新以支持基于日内瓦声明的身份验证的程序集中。

除了所需的代码更改之外，将我们基于声明的基础架构从 ADFS 迁移到日内瓦会有多困难？（例如从 ADFS 的 STS（联合服务）迁移到日内瓦的 STS（日内瓦服务器））

感谢您对此主题的任何意见，非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-10T15:58:28.600

[我在MSDN 论坛帖子](http://social.msdn.microsoft.com/Forums/en-US/Geneva/thread/f6fde85f-c81d-444e-abfd-0b7aa245b554)上收到了回复：

> 虽然我自己没有做过，但是可以预见从 ADFS 到日内瓦应该是非常愉快的旅程。到那时，您的 RP 将已经是基于声明的应用程序，因此没有大的飞跃；日内瓦通过基于元数据交换的自动配置来促进配置。

# c# - 推荐一个 C# 任务调度库

> ID：507247
> 
> 赞同：53
> 
> 时间：2009-02-03T14:20:00.623
> 
> 标签：c#, azure, scheduled-tasks

我正在寻找一个 C# 库，最好是开源的，它可以让我以相当大的灵活性安排任务。具体来说，我应该能够安排每 N 个时间单位以及“每个工作日 XXXX 时间”或“每个星期一 XXXX 时间”运行一次。比这更多的功能会很好，但不是必需的。这是我想在 Azure WorkerRole 中使用的东西，它立即排除了 Windows 计划任务、“at”、“Cron”以及任何需要安装和/或 GUI 才能运行的第三方应用程序。我在找图书馆。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-03T14:24:37.590

[http://quartznet.sourceforge.net/](http://quartznet.sourceforge.net)

“Quartz.NET 是非常流行（原文如此！）开源 Java 作业调度框架 Quartz 的一个端口。”

PS：明智的，不要试图在工作时导航到quartz.net ;-)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-11-20T23:11:21.030

我在 Java 时代使用过 Quartz，效果很好。我现在将它用于一些 .Net 工作，并且效果更好（当然，它已经稳定了很多年）。所以我当然支持它的建议。

您应该看看的另一件有趣的事情是我刚刚开始使用的 .Net 4.0 中的新 System.Threading.Tasks。我一直在使用这些任务来并行化工作，它充分利用了多核/处理器。我注意到那里有一个名为 TaskScheduler 的类，我没有详细查看它，但它有 QueueTask、DeQueTask 等方法。至少可能值得研究一下。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-03T14:22:43.753

请参阅Codeproject 上[的 A New Task Scheduler Class Library for .NET](http://www.codeproject.com/KB/cs/tsnewlib.aspx)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-03T14:25:27.290

我在这个问题中阅读了有关[Quartz的内容](http://quartznet.sourceforge.net/)[How may I schedule a C# Windows Service to perform a task?](https://stackoverflow.com/questions/503564/c-service-perform-daily-task) . 它是一个 C# 库，允许灵活调度。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-11-04T16:21:21.283

Quartz 似乎是一个不错的解决方案。

我最近（今年）不得不为我正在从事的一个主要项目编写一个自定义任务调度程序。他们也无法使用 Windows 任务计划程序，并且还希望能够通过上传程序集（通过 ASP.net 网站）来执行自定义功能，并让服务在指定时间执行适当的任务。

老实说，这有点像一场噩梦（与其说是设计和实现，不如说是调度逻辑有点拖累）。

我强烈建议在决定“自己动手”（又名重新发明轮子！）之前用尽所有其他途径。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-29T17:46:37.673

[Aditi Technologies](http://www.aditicloud.com/)有一个新的基于云的调度程序，称为[调度程序](http://blog.aditicloud.com/2013/01/22/introducing-scheduler-a-cloud-based-cron-scheduler/)。

> 调度程序允许开发人员通过在简单或复杂 CRON 调度上运行的 HTTP webhook 调度任务的执行。

# c++ - 有没有办法监控 C++/MacOS 中的堆使用情况？

> ID：507249
> 
> 赞同：3
> 
> 时间：2009-02-03T14:20:18.753
> 
> 标签：c++, macos, memory-leaks, heap-memory

我担心我的某些代码会导致内存泄漏，我不确定如何检查它。是否有适用于 MacOS X 的工具或其他东西？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T14:40:15.623

是的 - 有一个名为**MallocDebug**的应用程序作为 Xcode 包的一部分安装。

您可以在`/Developer/Applications/Performance Tools`文件夹中找到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T14:58:11.000

Apple 在其开发人员页面上对如何在 OS X 上使用 MallocDebug 进行了很好的描述。

*   关于发现一般[泄漏的文件](http://developer.apple.com/documentation/Performance/Conceptual/ManagingMemory/Articles/FindingLeaks.html)
*   [特别是启用 malloc](http://developer.apple.com/documentation/Performance/Conceptual/ManagingMemory/Articles/MallocDebug.html)的调试功能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T00:23:00.720

当然，UNIX 提供了一种快速而肮脏的方法来检测内存泄漏......顶部。

启动您的应用程序并观察随着时间的推移分配给您的进程的系统内存。如果它在不应该的时候持续增长，那么可能存在内存泄漏。此时你打破[Valgrind](http://valgrind.org/)或使用 MallocDebug 等。

当然，如果您使用智能指针和/或 RAII，那么您的代码中不应该有内存泄漏，对吧？;)))

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-09T14:00:07.340

内存错误、泄漏等的最佳工具期是 Valgrind。[从这里](http://valgrind.org/docs/manual/QuickStart.html)开始。你不需要在你的代码中做任何特别的事情，这将报告内存的分配位置（带有完整的堆栈跟踪，即使在 C 中也是如此）。此外，它还会检测对已释放内存的写入、未初始化的内存使用情况等等。

# excel - Excel 公式引用“向左的单元格”

> ID：507253
> 
> 赞同：94
> 
> 时间：2009-02-03T14:20:34.353
> 
> 标签：excel, excel-2007, excel-formula

我正在尝试进行条件格式设置，以便如果值与其左侧单元格中的值不同，单元格颜色会发生变化（每列是一个月，每行是某个对象的费用。我想监控几个月内价格很容易发生变化。）

我可以对每个单元格进行格式化并拖动它，但我想要一个适用于整个工作表的通用公式。

谢谢！

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2009-04-29T13:46:44.260

```
=OFFSET(INDIRECT(ADDRESS(ROW(), COLUMN())),0,-1) 
```

* * *

## 回答 #2

> 赞同：94
> 
> 时间：2011-10-10T14:07:32.690

最短最兼容的版本是：

```
=INDIRECT("RC[-1]",0) 
```

“RC[-1]”表示左边一列。“R[1]C[-1]”在左下角。

第二个参数 0 表示第一个参数使用 R1C1 表示法解释。

其他选项：

```
=OFFSET(INDIRECT(ADDRESS(ROW(), COLUMN())),0,-1) 
```

在我看来太长了。但如果相对值是动态的/从另一个单元格派生的，则很有用。例如：

```
=OFFSET(INDIRECT(ADDRESS(ROW(), COLUMN())),0, A1) 
```

最简单的选择：

```
= RC[-1] 
```

缺点是您需要使用选项打开 R1C1 表示法，当其他人必须使用 excel 时，这是不行的。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-03T14:27:01.657

创建条件格式时，将其适用于您想要的范围（整个工作表），然后输入一个*相对*公式（删除`$`符号），就好像您只格式化左上角一样。

Excel 会相应地将格式应用于其余单元格。

在此示例中，从 B1 开始，*左侧*单元格将是 A1。只需使用它 - 不需要高级公式。

* * *

如果您正在寻找更高级的东西，您可以使用`column()`、`row()`和`indirect(...)`。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-07-08T23:12:54.903

如果您将单元格引用更改为使用 R1C1 表示法（工具|选项，常规选项卡），那么您可以使用简单的表示法并将其粘贴到任何单元格中。

现在你的公式很简单：

```
=RC[-1] 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-05-02T19:11:58.443

而不是写很长：

```
=OFFSET(INDIRECT(ADDRESS(ROW(), COLUMN())),0,-1) 
```

你可以简单地写：

```
=OFFSET(*Name of your Cell*,0,-1) 
```

因此，例如，您可以写入 Cell **B2**：

```
=OFFSET(B2,0,-1) 
```

引用单元格**B1**

仍然感谢杰森杨！！如果没有您的回答，我永远不会想出这个解决方案！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-08-02T14:42:41.480

**使用以下公式**填充 A1 单元格：****

 **```
 =IF(COLUMN(A1)=1;"";OFFSET(A20;0;-1))&"1" 
```

然后自动向右扩展，你得到

```
 1|  A  |  B  |  C  |  ect ect
 2|    1|   11|  111|  ect ect 
```

如果偏移量超出可用单元格的范围，您将获得#REF！错误。

希望你喜欢。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-03-19T16:07:05.637

更简单：

```
=indirect(address(row(), column() - 1)) 
```

OFFSET 返回相对于当前引用的引用，因此如果间接返回正确的引用，则不需要它。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-07-09T13:42:28.260

在创建**用户定义函数**时，我发现其他涉及函数的答案`OFFSET`无法`INDIRECT`应用。

相反，您必须使用[`Application.Caller`](https://msdn.microsoft.com/en-US/library/office/ff193687.aspx)引用已使用用户定义函数 (UDF) 的单元格。在第二步中，将列的索引转换为相应列的名称。
最后，您可以使用活动工作表的[Range 函数](https://msdn.microsoft.com/en-US/library/office/ff836512.aspx)来引用左侧单元格。

```
Function my_user_defined_function(argument1, argument2)
    ' Way to convert a column number to its name copied from StackOverflow
    ' http://stackoverflow.com/a/10107264
    ' Answer by Siddarth Rout (http://stackoverflow.com/users/1140579/siddharth-rout)
    ' License (if applicable due to the small amount of code): CC BY-SA 3.0
    colName = Split(Cells(, (Application.Caller(1).Column - 1)).Address, "$")(1)

    rowNumber = Application.Caller(1).Row

    left_cell_value = ActiveSheet.Range(colName & rowNumber).Value

    ' Now do something with left_cell_value 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-04-12T15:13:03.777

为什么不直接使用：

```
=ADDRESS(ROW(),COLUMN()-1) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-03T14:37:18.360

您可以使用 VBA 脚本来更改选择的条件格式（您可能需要相应地调整条件和格式）：

```
For Each i In Selection
i.FormatConditions.Delete
i.FormatConditions.Add Type:=xlCellValue, Operator:=xlLess, Formula1:="=" & i.Offset(0, -1).Address
With i.FormatConditions(1).Font
    .Bold = True
End With
Next i 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-01-05T09:41:49.477

我偶然发现了这个线程，因为我想始终引用“左侧单元格”，但以非易失性方式（没有偏移、间接和类似灾难）至关重要。上下浏览网页，没有答案。（这个帖子实际上也没有提供答案。）经过一番修改后，我偶然发现了最令人惊讶的方法，我喜欢与这个社区分享：

假设 E6 中的起始值为 100。假设我在 F5 中输入这个值的增量，比如 5。然后我们将计算 F6 = E6+F5 中的延续值 (105)。如果您想添加另一个步骤，很简单：只需将 F 列复制到 G 列，然后在 G5 中输入一个新的增量。

这就是我们定期做的事情。每列都有一个日期，这些日期必须按时间顺序排列（以帮助 MATCH 等）。我们经常会忘记进入一个步骤。现在假设您想在 F 和 G 之间插入一列（以弥补您的遗漏）并将 F 复制到新的 G 中（以重新填充延续公式）。这简直就是一场彻底的灾难。试试看 - H6 现在会说 =F6+H5 而不是（因为我们绝对需要它） =G6+H5。（新的 G6 将是正确的。）

为了完成这项工作，我们可以以最惊人的方式混淆这个平庸的计算 F6=index($E6:F6;1;columns($E1:F1)-1)+F5。复制正确，你得到 G6=index($E6:G6;1;columns($E1:G1)-1)+G5。

这应该永远不会工作，对吧？循环引用，清楚！尝试一下并感到惊讶。Excel 似乎意识到，虽然 INDEX 范围跨越了我们正在重新计算的单元格，但该单元格本身并没有被 INDEX 寻址，因此不会创建循环引用。

所以现在我在家干了。在 F 和 G 之间插入一列，我们就得到了我们需要的结果：旧 H 中的延续值将引用我们在新 G 中插入的延续值。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-11-06T00:15:28.980

## 制作一个命名公式“LeftCell”

对于那些寻找非易失性答案的人，您可以通过在命名公式中使用 INDEX 函数来完成此操作。

1.  选择单元格 A2

2.  打开`Name Manager`(Ctrl+F3)

3.  点击`New`

4.  将其命名为“LeftCell”（或您喜欢的任何名称）

5.  对于`Scope:`, 选择`Workbook`

6.  在`Refers to:`中，输入公式：

    `=INDEX(!A1:!A2, 1)`

7.  单击`OK`并关闭`Name Manager`

这告诉 Excel 始终查看当前单元格左侧的值，并且会随着选择不同的单元格而动态更改。如果名称单独使用，它提供单元格的值，但在范围内它使用引用。归功于这个关于单元格引用的[答案。](https://stackoverflow.com/a/22264393/4269270)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2019-05-13T14:37:00.683

我认为这是最简单的答案。

使用“名称”来引用偏移量。

假设您想将一列（A 列）一直求和，但不包括保存总和的单元格（例如单元格 A100）；做这个：

（我假设您在创建名称时使用 A1 引用；随后可以切换到 R1C1）

1.  单击工作表中不在顶行的任意位置 - 例如单元格 D9
2.  定义一个名为“OneCellAbove”的命名范围，但用“=D8”覆盖“RefersTo”框（无引号）
3.  现在，在单元格 A100 中，您可以使用公式

    > =SUM(A1:OneCellAbove)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2021-01-28T03:22:16.117

因为这是回答@zipper的唯一方法

你的公式的原因：

```
="OFFSET(INDIRECT(ADDRESS(ROW(), COLUMN())),0,-1)=""xyz""" 
```

没有条件格式，是因为公式 litteraly 要求 =“THIS PHRASE” 等于“THAT PHRASE”，尝试这样写： `=OFFSET(INDIRECT(ADDRESS(ROW(),COLUMN())),0,-1)="xyz"`其中“xyz”是您的文本，“-1”是列数离开你想搜索。

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2019-06-29T10:30:11.607

请选择整个工作表和 HOME > Styles - Conditional Formatting, New Rule..., *Use a formula to determine which cells to format* and **Format values where this formula is true:** :

```
=A1<>XFD1 
```

`Format...`, 选择格式选择, `OK`, `OK`.

# c# - TcpListener：监听每个地址，包括GPRS IP地址

> ID：507254
> 
> 赞同：14
> 
> 时间：2009-02-03T14:20:56.817
> 
> 标签：c#, .net, networking, tcp, tcplistener

我们有一个简单的遗留软件，我们需要通过端口 15001 使用 TCP/IP 进行通信。我们需要在端口 15001 上监听遗留软件以建立连接，然后读取它发送给我们的任何内容。

我们已经在互联网上测试了这个解决方案，它工作得很好。然而，如果我们在 GPRS TCP/IP 网络上测试相同的解决方案，它不会。

基本都查过了，可以ping通GPRS网络中的其他设备，15001端口没有被防火墙封锁。

所以也许我的 TcpListener 有问题？

它是这样初始化的：

```
tcpServer = new TcpListener(IPAddress.Any, TCP_PORT); 
```

我假设它侦听系统上每个可用的启用 IPv4 的接口，因为我使用了 IPAddress.Any ？

有人知道这两个网络之间可能有什么区别吗？（即使不应该有任何区别）如果有什么我需要更改为我的 TcpListener？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-03T14:27:29.843

您需要指定要侦听的 IP 地址，而不是 IPAddress.Any。见[这里](http://msdn.microsoft.com/en-us/library/c6z86e63(VS.80).aspx)。当您使用 IPAddress.Any 时，它会自动为您选择网络接口。要侦听某个接口（在您的情况下为 GPRS），您必须在构造函数中使用正确的 IP。

[这篇文章](https://stackoverflow.com/questions/436778/send-broadcast-message-from-all-network-adapters)有更多关于获取每个 nic 的 IP 地址的信息。

此外，如果您希望同时监听每个 IP 地址，则每个 nic 都需要一个 TcpListener。

# c# - 如何查找对象是否来自类而不是超类？

> ID：507262
> 
> 赞同：4
> 
> 时间：2009-02-03T14:24:45.390
> 
> 标签：c#, class, object

在 C# 中，如何确定一个对象是否是某个类的实例，但不是该类的任何超类？

即使对象实际上来自超类，“is”也会返回 true。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-03T14:27:52.637

```
typeof(SpecifiedClass) == obj.GetType() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-03T15:03:38.587

您可以将对象的类型与您要查找的类的类型进行比较：

```
class A { }
class B : A { }

A a = new A();
if(a.GetType() == typeof(A)) // returns true
{
}

A b = new B();
if(b.GetType() == typeof(A)) // returns false
{
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T14:26:49.270

不幸的是，这在 C# 中是不可能的，因为 C# 不支持多重继承。给出这个继承树：

```
GrandParent
  Parent
   Child 
```

将`Child`始终是继承链中它上面的每个类型的实例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T14:41:21.987

您可能想查看 Type 类的几个方法：Type.IsInstaceOf 和 Type.IsSubclassOf

您可以通过您正在寻找的课程并获得您需要的信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-25T18:26:26.317

```
if(Obj.GetType() == typeof(ClassName)) 
```

这对我有用

# xslt - XSLT 分组

> ID：507263
> 
> 赞同：5
> 
> 时间：2009-02-03T14:24:46.370
> 
> 标签：xslt

我有一个带有两个级别（标题和行）标签的简单 XML，例如：

```
<?xml version="1.0"?>
<Header>
    <line>Line 1</line>
    <line>Line 2</line>
    <line>Line 3</line>
    <line>Line 4</line>
    <line>Line 5</line>
    <line>Line 6</line>
    <line>Line 7</line>
    <line>Line 8</line>
    <line>Line 9</line>
</Header> 
```

我需要对 X（例如 X=3）行上的行进行分组，以便我的输出如下：

```
<?xml version="1.0"?>
<Header>
    <set>
        <line>Line 1</line>
        <line>Line 2</line>
        <line>Line 3</line>
    </set>
    <set>
        <line>Line 4</line>
        <line>Line 5</line>
        <line>Line 6</line>
    </set>
    <set>
        <line>Line 7</line>
        <line>Line 8</line>
        <line>Line 9</line>
    </set>
</Header> 
```

如何编写可以进行这种转换的 XSLT？

谢谢！

○

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T15:05:07.303

**以下转换产生所需的结果**：

```
<xsl:stylesheet version="1.0" 
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:variable name="vN" select="3"/>

  <xsl:template match="/*">
    <xsl:copy>
      <xsl:apply-templates 
           select="line[position() mod $vN = 1]"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="line">
    <set>
      <xsl:apply-templates mode="copy" select= 
       ". 
       | 
        following-sibling::line[position() &lt; $vN]"/>
    </set>
  </xsl:template>

    <xsl:template match="line" mode="copy">
      <xsl:copy-of select="."/>
    </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<Header>
    <line>Line 1</line>
    <line>Line 2</line>
    <line>Line 3</line>
    <line>Line 4</line>
    <line>Line 5</line>
    <line>Line 6</line>
    <line>Line 7</line>
    <line>Line 8</line>
    <line>Line 9</line>
</Header> 
```

**结果是**：

```
<Header>
  <set>
    <line>Line 1</line>
    <line>Line 2</line>
    <line>Line 3</line>
  </set>
  <set>
    <line>Line 4</line>
    <line>Line 5</line>
    <line>Line 6</line>
  </set>
  <set>
    <line>Line 7</line>
    <line>Line 8</line>
    <line>Line 9</line>
  </set>
</Header> 
```

**请注意以下几点**：

1.  **使用 XPath`mod`运算符**找出`line`每组元素中的第一个`vN`元素。

2.  **模式的使用**，以便能够`line`通过不同的模板处理不同的元素

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T14:50:13.323

一般来说，在 XSLT 中，如果您想从列表创建层次结构，您可以使用 before-sibling 和 following-sibling 关键字。如果集合之间有标记条目，这很容易。

由于在这种情况下您没有这样的标记，我想解决方案可能涉及以下兄弟关键字和 mod 运算符。提供集合之间划分的mod。

我还没有尝试过，但这将是我的第一次开始。

[xslt](http://www.w3schools.com/xsl/)通常是了解不同关键字的好地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T15:27:43.797

[http://www.xml.com/pub/a/2003/11/05/tr.html](http://www.xml.com/pub/a/2003/11/05/tr.html)使用 XSLT 2.0 显示了一种稍微不那么丑陋的方法。关键元素是这个：

`<xsl:for-each-group select="*" group-ending-with="*[position() mod 3 = 0]">`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T15:10:40.040

这应该是可能的。具有所需的输出：

```
<?xml version='1.0' encoding='UTF-8'?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                version="1.0">

  <xsl:template match="/Header">
    <Header>
      <xsl:for-each select="line">
        <xsl:if test="not(number()=0) and position() mod 3 = 0">
          <set>
            <xsl:variable name="pos" select="position()"/>
            <line><xsl:value-of select="../line[position()=($pos -2)]"/></line>
            <line><xsl:value-of select="../line[position()=($pos -1)]"/></line>
            <line><xsl:value-of select="text()"/></line>
            </set>
        </xsl:if>

      </xsl:for-each>
    </Header>
  </xsl:template>

</xsl:stylesheet> 
```

（$pos-1, $pos-2 的东西不是很漂亮）

# java - 正则表达式中的“*”有什么作用？

> ID：507265
> 
> 赞同：8
> 
> 时间：2009-02-03T14:24:50.677
> 
> 标签：java, regex

我的Java源代码：

```
String result = "B123".replaceAll("B*","e");
System.out.println(result); 
```

输出是：`ee1e2e3e`。为什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-03T14:27:48.613

'*' 表示前一个字符的零个或多个匹配项。因此，每个空字符串都将替换为“e”。

您可能想使用 '+' 代替：

> `replaceAll("B+", "e")`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-03T14:28:37.470

你想要这个作为你的模式：

```
B+ 
```

你的代码是：

```
String result = "B123".replaceAll("B+","e");
System.out.println(result); 
```

“*”匹配“零或多个”——“零”包括 B 之前以及所有其他字符之间的空。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T15:55:50.913

我在一家大型科技公司工作了一个多月，修复了正则表达式中带有 * (splat!) 的错误。我们维护了一个鲜为人知的 UNIX 操作系统。我的脑袋几乎要爆炸了，因为它与零次遇到一个角色相匹配。谈论一个很难通过您自己的重新创建来理解的错误。在某些情况下，我们进行了双重替代。我不知道为什么代码是错误的，但能够添加捕获特殊（错误）情况的代码并防止双重替换，并且没有破坏任何包含它的实用程序（包括 sed 和 awk）。我很自豪修复了这个错误，但正如已经提到的。

看在上帝的份上，只需使用**+** !!!!

# asp.net - Asp.net 1.1 到 3.5 迁移问题

> ID：507266
> 
> 赞同：2
> 
> 时间：2009-02-03T14:24:58.477
> 
> 标签：asp.net, .net-3.5, webforms, code-migration

我们有一个最近迁移到 3.5 的 asp.net 1.1 应用程序。当我们对迁移的应用程序进行代码修改时，我们会遇到一些问题。这是正在发生的事情

1.  在 asp.net 1.1 应用程序中，我们有页面指令 codebehind="ePC.aspx.cs"。这迁移得很好。

2.  我们对 .cs 文件进行了一些代码更改。例如，我们添加了一个按钮并将事件处理程序添加到该按钮。

3.  这个新功能没有得到正确执行。

4.  我们将 codebehind 指令更改为 codefile 指令

5.  现在它工作正常。但在部署期间，它要求 .cs 文件也与 aspx 页面一起部署。我们不确定为什么会这样。

我附上了一个示例页面指令

**在带有 CodeFile 的 VisualStudio 中**

```
<%@ Page language="c#" Codefile="ePC.aspx.cs" AutoEventWireup="True"   Inherits="SPUniversal.Web.ePC" %> 
```

**网站发布后**

```
<%@ page language="c#" autoeventwireup="True" inherits="SPUniversal.Web.ePC, App_Web_eu_mdesx" %> 
```

App_Web_eu_mdesx在已发布的网站中自动生成*。*我不明白这里发生了什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T14:34:53.823

如果您将新的 3.5 应用程序创建为网站而不是 Web 应用程序，则可能会导致您看到的内容。

看看这篇旧博客文章，它解释了这里的一些差异： [网站与 Web 应用程序](http://west-wind.com/weblog/posts/5601.aspx)

我认为我没有完全回答您的问题，但希望这些面包屑会引导您走上正确的道路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T16:51:31.763

补充一下 CubanX 所说的，即使您确实将其创建为 Web 应用程序（而不是网站），仍然值得在 Visual Studio 的解决方案资源管理器中右键单击您的 Web 应用程序项目并单击“转换为 Web 应用程序” ，即使它已经是一个。

我们发现这为我们解决了一些神秘的问题 - 但我们从未弄清楚原因。:)

# .net - XSLT 和 T4 代码生成方法有什么区别？

> ID：507269
> 
> 赞同：3
> 
> 时间：2009-02-03T14:25:15.963
> 
> 标签：.net, xslt, code-generation, t4

我刚刚进入重复编码任务的代码生成的想法，并且已经看到了这两种方法。我[在 Microsoft .Net 中的 Apress 书籍代码生成中](http://apress.com/book/view/1590591372/ "Microsoft .Net 中的代码生成")看到了 XSLT 方法，并阅读了与 MVC 框架中的新功能相关的 T4 方法。

每种方法更适合什么样的项目？快速浏览告诉我 T4 是一个更轻量级的系统，这是真的吗？

非常感谢...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T18:07:39.743

是的 - T4 是一种基于模板的方法，可以从各种来源提取信息 - 通常来自数据库（表或系统目录）。

T4 内置于 VS 2008 - 您可以在 VS2008 中定义一个 .tt 文件并让它在 VS 中生成其输出。

XSLT 有一个要求——输入必须是 XML，而 XSLT 本身也是 XML，因此存在许多挑战和可能的缺点。

XSLT 是独立的——您可以安装和使用任意数量的 XSL 引擎。

总而言之：T4 对我来说更像是一个“内部 VS”代码生成工具（用于快速创建 C# 或其他文件），而 XSLT 更像是一个数据处理/数据转换工具，用于将数据从 XML 转换为另一个格式（通常是使用 XSL-FO 的 HTML 或 PDF）。

马克

# mysql - 如何抑制添加到 mysqldump 输出的表的行数（AUTO_INCREMENT=N）？

> ID：507271
> 
> 赞同：12
> 
> 时间：2009-02-03T14:25:39.693
> 
> 标签：mysql, mysqldump

我使用以下命令输出 MySQL 数据库的架构：

```
mysqldump --no-data --skip-add-drop-table 
```

我将对两个要比较的数据库执行此操作，然后对两个输出文件进行比较。这是我在环境之间跟踪数据库更改的粗略方式。

但是，给我带来的一个小不便是，每个表的行数都包含在表定义中，作为 AUTO_INCREMENT 值，如下所示：

```
ENGINE=MyISAM AUTO_INCREMENT=844 DEFAULT CHARSET=latin1; 
```

我认为“--no-data”标志会抑制有关引用数据的表的任何信息，包括行数。

如何在此输出中抑制 AUTO_INCREMENT=N？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-03T14:34:43.810

看看这个[`ticket`](http://bugs.mysql.com/bug.php?id=20786)关于这个问题。它被关闭为“不会修复”

你可以这样做，或者：

```
mysqldump --no-data --skip-add-drop-table my_database | sed 's/AUTO_INCREMENT=[0-9]*\b//' > database.dump 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T14:30:18.030

```
mysqldump --no-data --skip-add-drop-table | grep -v AUTO_INCREMENT 
```

?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-05-08T00:27:24.860

经过大量研究和调整后，我发现在 Windows（可用 Powershell）上，您可以...

`mysqldump -h SERVER -u USERNAME --password=PASSWORD -d DATABASE -C | powershell -Command "$input | ForEach-Object { $_ -replace \" AUTO_INCREMENT=\S+\", \"\" }"`

只需添加`> output.txt`到末尾即可将其保存到文件中，而不是将其打印到屏幕上。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T23:30:45.487

（**编辑**接受的答案当然是正确的方法。没有人在他们的头脑中使用默认值“AUTO_INCREMENT = 123”创建一个列）

在同一个问题上苦苦挣扎，并阅读了有关解决方案的参考票证警告，我对`--xml`输出形式进行了旋转，我想出了一个没有陷阱的工作解决方案（例如，有人创建了一个默认值为“AUTO_INCREMENT”的列=123" —我知道，牵强，但仍然……）：

```
mysqldump \
  --xml \
  --compact \
  --no-data \
  mydb |
xmlstarlet ed -d '
  //key/@Cardinality |
  //options/@Rows |
  //options/@Avg_row_length |
  //options/@Data_length |
  //options/@Auto_increment |
  //options/@Index_length
' |
xmllint --format - 
```

基本上，它使用我看到的不同的 xmlstarlet 删除了一些值（即使来自同一数据库的连续转储）。XSLT 样式表可以做同样的工作。

```
<?xml version="1.0"?>
<mysqldump xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <database name="mydb">
    <table_structure name="SomeTable">
      <field Field="foo" Type="int(12)" Null="NO" Key="PRI" Extra="" Comment=""/>
      <field Field="bar" Type="int(11)" Null="NO" Key="PRI" Extra="" Comment=""/>
      <field Field="baz" Type="int(11)" Null="NO" Key="PRI" Extra="" Comment=""/>
      <key Table="AccessControlList" Non_unique="0" Key_name="PRIMARY"
           Seq_in_index="1" Column_name="referenceID" Collation="A" Null=""
           Index_type="BTREE" Comment="" Index_comment=""/>
    <options Name="SomeTable" Engine="InnoDB" Version="10" Row_format="Compact"
           Max_data_length="0" Data_free="0" Create_time="2012-09-11 15:31:11"
           Collation="utf8_general_ci" Create_options="" Comment=""/>
[...] 
```

（为了便于阅读，在 XML 属性之间添加了换行符；它们不在 xmllint 输出中）

# asp.net - 如何防止在 ModalPopupExtender 中执行自动客户端验证？

> ID：507284
> 
> 赞同：0
> 
> 时间：2009-02-03T14:28:58.390
> 
> 标签：asp.net, asp.net-ajax, ajaxcontroltoolkit, modalpopupextender

我正在使用 ModalPopupExtender 显示一个模式弹出窗口，其中包含一堆输入控件和几个 EnableClientScript 设置为 true 的验证器。
我面临的问题是，客户端验证在显示模式弹出窗口后立即执行（通过客户端代码，而不是来自服务器）。
有没有办法防止这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T22:53:59.337

我目前面临与您完全相同的问题。

目前，我已经编写了一些 JavaScript 来处理这种情况，方法是用“默认”文本值填充当前输入。当默认值在输入中为灰色而不是黑色时，我还会修改样式颜色。

然后当用户点击输入时，调用另一个 JavaScript 函数来清除它并将颜色改回黑色！

所以我的 Javascript 验证基于我的输入颜色样式。我不太喜欢我这样做的方式，因为验证器应该可以工作......

我在那里找到了一些相关信息：http: [//forums.asp.net/t/1066821.aspx](http://forums.asp.net/t/1057570.aspx) [http://forums.asp.net/t/1057570.aspx](http://forums.asp.net/t/1066821.aspx)

但实际上，当我在我的 web.config 中插入他们的 tagMapping 时，我的母版页或 .apsx 页面中的所有控件都无法在我的 .apsx.vb 页面中找到......

PS如果你想让我给你我当前的Javascript（完美运行）告诉我:)

# css - IE 是否正确打印 [table] 页眉和页脚（css 设置）？

> ID：507287
> 
> 赞同：1
> 
> 时间：2009-02-03T14:31:14.563
> 
> 标签：css, printing, header, cross-browser, footer

我需要为某些页面准备打印 css 样式。每个打印页面上都可以有页脚吗？

我尝试了代码，我在网上找到了：

```
display:block;position:fixed; bottom:0px; 
```

但它仅适用于 Firefox。

我可以尝试用表格修复它，但在 Q. 中：[CSS：在打印模式下重复表格标题](https://stackoverflow.com/questions/274149/css-repeat-table-headers-in-print-mode)是信息，它在 IE5 中不起作用（也许我犯了一些错误，但似乎它没有即使在 IE7 中也能工作）。

有人解决了在 IE 中的每一页上打印页脚的问题吗？*有桌子还是没有桌子都没关系。*

感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-04-15T14:53:45.800

我认为使用 IE current 打印页眉和页脚是不可能的，因为即使在 IE8 中它也符合 CSS 2.1。但是还有其他一些调整可以解决这个问题。希望这个 URL 会有所帮助： http: [//msdn.microsoft.com/en-us/library/dd433064](http://msdn.microsoft.com/en-us/library/dd433064(VS.85).aspx) (VS.85).aspx 。

PS：您在页面底部特别提到的 URL 仅适用于 safari。

# c# - 控制 WF 持久性点事务

> ID：507289
> 
> 赞同：0
> 
> 时间：2009-02-03T14:31:34.690
> 
> 标签：c#, transactions, workflow-foundation

我正在使用 WF，并且需要支持事务和持久性。我不想使用 TransactionScopeActvity ，而是使用我自己的事务范围对象，并且最后仍然有一个持久点，它将成为活动本身的事务的一部分（类似于 TransactionScopeActvity 在这方面的工作方式）。我可以通过使用“PersistOnClose”属性在事务结束时实现持久化点，但是持久化调用属于哪个事务呢？它会打开一个新事务，还是寻找环境事务？当持久性点被激活时，如何确保环境事务存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-07T16:43:17.507

版本 3 和 3.5**不支持环境事务**我在设计时遇到了很多问题在新版本的工作流中，即 4.0（从头开始完全重写）支持环境事务

# php - 将整数转换为笛卡尔坐标的替代/更快方法？

> ID：507295
> 
> 赞同：4
> 
> 时间：2009-02-03T14:34:43.573
> 
> 标签：php, optimization, math

作为一个有趣的副项目，帮助我学习另一个 PHP MVC 框架，我一直在编写 Reversi / Othello 作为 PHP 和 Ajax 应用程序，主要是简单的东西。出于多种原因，我决定不使用多维数组，而是使用线性数组（在本例中为 64 个元素长）和几种从坐标转换为整数的方法。

所以我很好奇，有没有其他可能更快的算法将整数转换为坐标点？

```
function int2coord($i){
    $x = (int)($i/8);
    $y = $i - ($x*8);      
    return array($x, $y);
}

//Not a surprise but this is .003 MS slower on average
function int2coord_2($i){
    $b = base_convert($i, 10, 8);
    $x =  (int) ($b != 0 ? $b/8 : 0); // could also be $b < 8 for condition
    $y = $b % 10;
    return array($x, $y);
} 
```

为了子孙后代，我为 coord2int 编写的方法

```
function coord2int($x, $y){
   return ($x*8)+$y;
} 
```

更新：
所以在奇怪的地方，结果不是我所期待的，但使用预先计算的查找表主要证明是最快的，猜测用内存换速度总是赢家？

*   这里有一张桌子，但由于 SO 的样式问题，我把它剪掉了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T14:42:47.130

哦是的！这是二进制的完美示例：

```
function int2coord($i){
    $x = $i >> 3;
    $y = $i & 0x07;      
    return array($x, $y);
} 
```

现实情况是一个好的编译器会发现这个优化并使用它，所以它不一定更快。测试并查看您的编译器/解释器是否这样做。

它之所以有效，是因为任何二进制除以 8 都与右移 3 位相同。现代处理器具有桶形移位器，可以在一条指令中进行多达 32 位的移位。

反过来也很简单：

```
function coord2int($x, $y){
   return ($x << 3)+$y;
} 
```

-亚当

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-03T14:39:58.040

我现在没有时间自己测量这个，但我怀疑预先计算的查找表会在速度上超过你的解决方案。代码看起来像这样：

```
class Converter  {
    private $_table;

    function __construct() 
    {
        $this->_table = array();
        for ($i=0; $i<64; $i++) {
            $this->_table[$i] = array( (int)($i/8), (int)($i%8) ); 
        }
    }

    function int2coord( $i )
    {
        return $this->_table[$i];
    }
}

$conv = new Converter(); 
$coord = $conv->int2coord( 42 ); 
```

当然，这确实会增加很多开销，因此在实践中，如果您经常调用转换代码，您只会费心预先计算所有**坐标**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T14:42:59.953

我现在无法测量，但是您应该能够通过以下方式获得一些额外的速度：

```
function int2coord($i){
  $y = $i%8;
  $x = (int)($i/8);
  return array($x, $y);
} 
```

编辑：忽略我——亚当的位移答案应该更好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T14:56:58.803

```
function int2coord_3($i){
    return array((int) ($i / 8), ($i % 8));
} 
```

这有点快，因为没有 var 声明和做作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T16:11:36.750

我认为你的大部分表现都会因最后返回 array(...) 而丢失。相反，我建议：
* 定义两个函数，一个用于 x，一个用于 y
    或
* 在需要计算的代码中内联位运算

# svn - 在 Windows XP 上无法打开存储库错误

> ID：507299
> 
> 赞同：4
> 
> 时间：2009-02-03T14:35:08.487
> 
> 标签：svn

我正在尝试使用一直运行良好的本地 SVN，但今天它给出了这个错误：

```
Unable to open repository 
'file:///C:/wamp/www/svns/[myproject]/[dir]/[subdir]' 
```

可能是什么问题呢？

编辑：完全错误：

```
Commit failed (details follow):
Unable to open an ra_local session to URL
Unable to open repository 
'file:///C:/wamp/www/svns/[myproject]/[dir]/[subdir]' 
```

第二次编辑：

这是 TortoiseSVN 和 SVN 客户端信息：

```
TortoiseSVN 1.5.7, Build 15182 - 32 Bit , 2009/01/24 22:44:13
Subversion 1.5.5, 
apr 1.2.12
apr-utils 1.2.12
berkeley db 4.4.20
neon 0.28.3
OpenSSL 0.9.8i 15 Sep 2008
zlib 1.2.3 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T18:03:46.413

您最近是否升级了一个或多个 Subversion 客户端？

如果您的所有客户端直接访问您的存储库，则它们应该处于同一级别（全部 1.4\. *、全部 1.5.*或很快全部 1.6.*）。

从技术上讲，您可以使用其他一些组合，但是由于您也需要它们与工作副本的版本相同，因此您应该使它们兼容...（在 1.5.X 发布之前，您的存储库会自动升级到最新版本您可以使用更高版本访问它们）。

需要注意的另一件事是并非所有客户端都支持相同的存储库格式。大多数支持 fsfs，但并非全部支持 BDB。更糟糕的是，有多个不兼容的 BDB 版本......

TortoiseSVN、AnkhSVN 和 Slik Subversion 在相同的 1.XY 级别具有完全相同的 BDB 版本。对于其他客户端，您应该阅读他们的文档

**小更新：** TortoiseSVN 1.6.x 将放弃对 file:// 访问 BDB 存储库的支持。（然后您将需要一个 svnserve 或 apache 服务器来访问这些存储库）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T15:44:06.633

别忘了跑

```
svnadmin verify path\to\repository 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-15T14:00:49.920

[使用 file:// URL 方案访问存储库可能会导致存储库损坏](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.choosing.html#svn.serverconfig.choosing.recommendations)，因为 file:// 协议本质上是无状态的，并且通常在存储库有多个用户时不使用。

因此，您可能希望使用 svn:// URL 方案来验证存储库是否确实已损坏。这是因为 Subversion 处理不同 URL 方案的方式——它使用存储库访问层来处理 URL 方案。RA 层中的不同模块处理适当的协议，如 file://、svn://、http:// 等。在您的情况下，ra_local 模块报告错误，因为它处理 file:// URL 方案。

如果您正在使用 svnserve 守护程序，则可以使用 svn:// URL 方案。我在这里有点冒昧，但假设您将[svnserve 守护程序配置为作为 Window Service 运行](http://svnbook.red-bean.com/en/1.5/svn.serverconfig.svnserve.html#svn.serverconfig.svnserve.invoking.winservice)。svnserve 的根目录在这里很重要——URL 中的路径是相对于根目录的。

假设 C:/wamp/www/svns/[myproject] 是您的存储库，并且 svnserve 的根目录设置为 C:/wamp/www/svns，您可以尝试使用 svn:// *hostname* /[我的项目]。

另一方面，由于您使用的是 BDB 而不是 FSFS，因此请查看 Subversion 站点上的以下常见问题解答条目：

1.  [恢复 BDB 存储库](http://subversion.tigris.org/faq.html#bdb-recovery)请记住[Stefan](https://stackoverflow.com/questions/507299/unable-to-open-repository-error-on-windows-xp/507617#507617)关于在尝试恢复之前先运行 svnadmin verify 的建议。
2.  [正确设置存储库权限](http://subversion.tigris.org/faq.html#reposperms)

PS：备份很有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T14:39:53.127

在过去的几天里，我们在这里也遇到了 svn 的问题，涉及 C:/windows/temp 的权限。

可能是 MS 修复破坏了 svn 访问其临时文件的方式？

这可能与您的经历完全无关，但似乎与我们所经历的相似。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-14T01:47:17.237

我认为这可能是由于以下原因之一：

1.  BDB 4.4 与您的 svn 客户端不兼容。查看此[链接](http://aggregator.foolab.org/node/48256)以获取更多信息（它不适用于 Windows，但希望仍然有用） - 即将 BDB 升级到 > 4.4 或迁移到 fsfs。
2.  文件权限问题。“Practical Subversion”一书中有一个关于存储库权限的部分，特别提到了您遇到的错误。请参阅[链接](http://books.google.com/books?id=IQSmDzixITgC&printsec=frontcover&source=gbs_summary_r&cad=0#PPA88,M1)进行预览 - 通常您需要仔细检查所有权限。另外：正如其他人所建议的那样，可能值得仔细检查 Windows 临时文件夹权限，因为 svn 可能在幕后使用它。

迁移到 fsfs 存储库存储也可能是一个好主意。

如果这没有帮助：在

```
Unable to open repository
'file:///C:/wamp/www/svns/[myproject]/[dir]/[subdir]' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-10-22T06:18:02.367

就我而言，它一定是SVN-Tortoise的权限设置中的一个错误。我没有更改任何内容，但突然无法导入或提交。仅当我重新安装 SVN-Tortoise 并创建新存储库时才解决。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-03T14:38:39.807

我要检查的前三件事：

1.  本地路径是您想要的
2.  该目录仍然存在
3.  该路径中所有文件夹的权限。

# ms-access - 如何使用表单上的复选框将记录添加到 Microsoft Office Access 的子表单中？

> ID：507300
> 
> 赞同：2
> 
> 时间：2009-02-03T14:35:45.290
> 
> 标签：ms-access, forms, vba, checkbox, subform

我有一个地毯公司的数据库。我有一个表格，可以让用户进行报价，包括选择客户等。还有一个处理产品和附加品的子表格，包括数量和单价。要说明用户是否需要拟合，有一个复选框。勾选后，我希望将配件作为产品之一添加到子表单中。通常使用下拉菜单手动选择产品。

重要属性有：
表单名称：**订单**
子表单名称：**订单详细信息 子**
表单 复选框名称：产品的**拟合**
字段名称：**产品 ID**
链接到表的子表单：**订单详细信息**
链接到表的表单：**订单**

我假设需要 VBA 或宏生成器。

无论如何提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T14:44:59.123

我认为最简单的方法是使用附加查询。

```
If Me.Fitting Then
   strSQL="INSERT INTO [Order Details] (ProductID,OtherTextField) Values ("
         & Me.ProductID & ",'" & Me.OtherTextField & "')"
   CurrentDB.Execute strSQL, dbFailOnError

   Me.[Subform control name here].Form.Requery
End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T16:17:19.310

在复选框控件上，您将在复选框的更新后事件上添加一个[事件过程]（参见属性窗口）。这将删除 VBA 代码，单击省略号（“...”）以获取 VBA 代码。

您可以使用 Remou 的代码（经过一段时间）插入新产品：

```
If Me.Fitting Then
    strSQL="INSERT INTO [Order Details] (ProductID,OtherTextField) " & _
        "Values (" & _
        Me.ProductID & ",'" & Me.OtherTextField & "')"
    CurrentDB.Execute strSQL, dbFailOnError

    Me.[Subform control name here].Form.Requery
End If
'[code not tested] 
```

但是，您可能还想检查订单中不存在产品（您的业务规则是否允许安排多个配件），并且您可能还希望允许在配件产品存在时将其删除未选中 - 您可以在“结束 if”之前的 if 上使用 else 条件来做到这一点：

```
if 'blah
     'blah blah
else
    strSQL="Delete [Order Details] " & _
        "where ProductID = " & Me.ProductID & " " & _
            "and OtherTextField = 'fitting' " 
    CurrentDB.Execute strSQL, dbFailOnError

    Me.[Subform control name here].Form.Requery
end if
'[code not tested] 
```

您还必须破解您的 Products 子表单，这样如果您从中删除 Fitting 产品，您就可以更新复选框（或者这样您就不能删除 Fittings 了）。

再说一次，也许您不想使用复选框，而只是将配件作为另一个下拉选项，就像其他产品一样。每当创建新订单时，您始终可以确保它自动填充到 [订单详细信息] 中，这样就不会被遗忘。这将与产品选择用户界面的其余部分更加一致。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T14:08:03.457

这是无代码解决方案：

去掉 Fitting 复选框。制作适合产品并像其他所有产品一样添加它。如果您想知道订单是否需要配件（我猜这就是您有复选框的原因。），您可以创建查询以查看配件是否是您的报告/发票上的产品之一。

# while-loop - while 语言

> ID：507310
> 
> 赞同：24
> 
> 时间：2009-02-03T14:37:24.240
> 
> 标签：while-loop, language-theory

在我的计算语言理论课上，我们得到了一个家庭作业，用一种语言实现一段代码，该语言只有用于流控制的 while 语句（没有 if 语句）。这主要是为了证明你可以编写一个图灵完备的语言，只需要一个while循环。

对于那些能够理解语言语法的人，这里是语言规则：

```
S -> S;S | while C do S od | id := E

E -> E + T | T | E - T

T -> T * F | F | F / T

F -> id | cons | (E)

C -> E = E | E > E | E < E | E >= E | E <= E | E != E | C and C | C or C | not(C) 
```

这是从我的课堂笔记中复制的，所以如果有什么遗漏或不正确，请不要怪我！

要实现的代码是这样的：

```
if d = 0 do
    x := 1
else
    x := a / d 
```

无论如何，如果您想继续使用上面的语言规则编写它，请继续。否则，请继续使用您最熟悉的任何语言编写它。但有一些警告！

*   没有 if 语句或除 while 循环之外的任何其他类型的流控制。
*   不作弊：上面的语法不包括任何 break 语句、return 语句或异常。不要使用它们。

我已经为此编写了一段代码（我将发布它只是为了证明这不是向我展示 codez 帖子）。我有点好奇其他人能想出什么。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-03T14:48:01.020

可以用一个while循环来完成，但不是很清楚：

```
while d == 0 do
  d := 1;
  a := 1
od
x := a / d; 
```

说明，如果 d = 0，则 d 将为 1，a 也将为 1。这样就结束了循环。

现在 x 设置为 a / d 这很好，因为如果 d 为 0，则 a / d 评估为 1。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-03T14:37:29.857

这是我的代码：

```
continue := True
while d = 0 and continue do
    x := 1
    continue := False
od
while d != 0 and continue do
    x := a/d
    continue := False
od 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-03T15:35:06.153

这行得通吗？

```
td := d
x := 1

while td != 0 do
    x := a / d
    td := 0
od 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-03T15:23:14.723

要成为图灵完备，您需要同时支持选择和迭代。While 循环显然是迭代的。如果条件为真，则可以通过使其通过循环一次来完成选择，否则根本不进行。

所以在最坏的情况下，你可以通过应用这些技术来做你需要做的一切。我想一些复杂的控制流会很快变得丑陋。:-)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2011-01-28T11:00:48.103

不使用真假分支的细节，也不重复谓词：

```
statementIncomplete := True
while d = 0 and statementIncomplete do
    x := 1
    statementIncomplete := False
od
while statementIncomplete do
    x := a/d
    statementIncomplete := False
od 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-26T21:50:58.747

这是[埃蒙答案](https://stackoverflow.com/a/4827465/58668)的扩展。

的语义`if <condition> then <stmt> else <stmt> fi`如下：

*   评估`<condition>`；
*   如果为真，则执行 and 之间的`then`语句`else`；
*   否则，执行 和 之间的`else`语句`fi`。

的语义`while <condition> do <stmt> od`如下：

*   评估`<condition>`；
*   如果为假，则`while`语句执行完毕；
*   否则，执行 和 之间的语句`do`，`od`并再次执行该`while`语句。

要用 表示`if A then B else C`，`while`请执行以下转换：

让`gensymN`是一个不用于任何其他变量的名称；然后发出以下代码

```
gensymN := 0;
while gensymN = 0 and A do B; gensymN = 1; od;
while gensymN = 0 do C; gensymN = 1; od 
```

这个程序的语义是：

*   将 0 分配给`gensymN`。
*   评估`gensymN = 0 and A`（如果为真，`A`则为真）
*   如果为真，那么：
    *   执行`B`
    *   执行`gensymN = 1`
    *   评估`gensymN = 0 and A`（这是错误的）
    *   评估`gensymN = 0`（这是错误的）
*   否则（如果`gensymN = 0 and A`为假）：
    *   评估`gensymN = 0`（这是真的）
    *   执行`C`
    *   执行`gensymN := 1`
    *   评估`gensymN = 0`（这是错误的）

观察上述的以下子结构：

*   它（有效地）评估`A`；
*   如果为真，则执行`B`，否则`C`。
*   除了`A`,`B`和之外`C`，程序（片段）只摆弄`gensymN`输入程序中不存在的 。

因此，该程序具有相同的语义

```
if A then B else C fi; gensymN := 1 
```

一个脚注：如果`A`在评估时为真，它将再次评估（除非`and`是短路）。如果该语言允许将布尔值存储在变量中，则可以再引入一个虚拟变量并执行`dummy := A; <insert the above program here, with dummy instead of A>`. 那么 的两个评估`dummy`本质上只是一个负载。如果评估布尔表达式不会产生副作用，则不需要阻止第二次评估以确保正确性；它可能（也可能不是）是一种优化。

将上述内容作为“软证明”，加上前一段的附带条件，这是to的正确*完全一般*翻译。在我看来，完整的概括性使这个（= Eamon 的）答案与其他答案区分开来。`if``while`

# c# - 具有 HttpWebRequest 对象的相对文件路径

> ID：507317
> 
> 赞同：0
> 
> 时间：2009-02-03T14:38:29.497
> 
> 标签：c#, path, httpwebrequest

我正在尝试创建可以在我的开发团队之间共享的单元测试，所以我需要让项目中的所有路径都是相对的。

这给我带来麻烦的地方是 HttpWebRequest 类。我希望它从本地文件系统中的文件中提供静态测试数据。

我想做这样的事情：

```
file:///./TestData/test.html 
```

但这只会产生 C:\TestData\test.html 和 DirectoryNotFoundException。

HttpWebRequest 的代码如下所示：

```
var request = HttpWebRequest.Create(uri);
var response = request.GetResponse();
var responseStream = new StreamReader(response.GetResponseStream());
return responseStream.ReadToEnd(); 
```

如何说服 C# 在不破坏 Uri 语法的情况下解析相对路径？

问候丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T14:48:05.683

与项目中的任何程序集相比，您尝试服务器的文件是否具有相对路径？如果是这样，那么您可以基于其中一个程序集的路径构建一个非相对 URL，并将其返回给调用者。

例如：

```
var basePath = Path.GetDirectoryName(typeof(MyType).Assembly.Location);
var fullPath = Path.Combine(basePath, @"TestData\test.html");
return new Uri(fullPath); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-03T14:52:52.850

如果 webrequest 在文件系统上，为什么还需要它？你可以用 File.ReadAllText(path) 打开它

# php - PHP 查询字符串限制

> ID：507324
> 
> 赞同：3
> 
> 时间：2009-02-03T14:39:55.607
> 
> 标签：php, apache

我安装了 PHP 5.1.6 (cli)，只要 GET 查询字符串超过 128 个字符，它就会失败并出现 HTTP 406 Not Acceptable 错误。有什么建议可以解决这个问题，以便可以使用超过 128 个字符？POST 不是一个选项。

服务器正在返回错误，所以不要认为它是浏览器问题。我认为它是 PHP 而不是 Apache 的原因是因为它适用于 HTML 文件。

```
GET /test.php?phptestof129characterstring-NEW-WOVEN-FENCE-PANELS-GARDEN_W0QQitemZ200303392512QQihZ010QQcategoryZ139954QQtcZphotoQQcmdZViewItem
HTTP/1.1
主持人： *****
用户代理：Mozilla/5.0（Windows；U；Windows NT 5.1；en-GB；rv:1.9.0.5）Gecko/2008120122 Firefox/3.0.5
接受：text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
接受语言：en-gb,en;q=0.5
接受编码：gzip,deflate
接受字符集：ISO-8859-1,utf-8;q=0.7,*;q=0.7
保活：300
连接：保持活动
Cookie：agent_name=Tim

HTTP/1.1 406 不可接受
日期：格林威治标准时间 2009 年 2 月 3 日星期二 12:05:33
服务器：Apache/2.2.3（红帽）
X-Powered-By: PHP/5.1.6
内容长度：0
连接：关闭
内容类型：文本/html

```

* * *

```
GET /test.html?phptestof129characterstring-NEW-WOVEN-FENCE-PANELS-GARDEN_W0QQitemZ200303392512QQihZ010QQcategoryZ139954QQtcZphotoQQcmdZViewItem
HTTP/1.1
主持人： *****
用户代理：Mozilla/5.0（Windows；U；Windows NT 5.1；en-GB；rv:1.9.0.5）Gecko/2008120122 Firefox/3.0.5
接受：text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
接受语言：en-gb,en;q=0.5
接受编码：gzip,deflate
接受字符集：ISO-8859-1,utf-8;q=0.7,*;q=0.7
保活：300
连接：保持活动
Cookie：agent_name=Tim

HTTP/1.1 200 正常
日期：格林威治标准时间 2009 年 2 月 3 日星期二 12:18:19
服务器：Apache/2.2.3（红帽）
最后修改时间：格林威治标准时间 2008 年 12 月 19 日星期五 15:01:17
ETag：“156960d-221-94be8940”
接受范围：字节
内容长度：545
连接：关闭
内容类型：文本/html

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T14:46:42.927

你的网络服务器上启用了[mod_security吗？](http://www.modsecurity.org/)这听起来像是它会做的事情。如果是这样，您可以在`<VirtualHost>`块内本地禁用或使用 v1.x 的 .htaccess 文件禁用

```
<IfModule mod_security.c>
SecFilterEngine Off
SecFilterScanPOST Off
</IfModule> 
```

版本 2.x 具有不同的配置语法：

```
<IfModule mod_security2.c>
    SecRuleEngine Off
</IfModule> 
```

这是一种蛮力的方法，您可能需要阅读[文档](http://www.modsecurity.org/documentation/modsecurity-apache/2.5.7/html-multipage/)以了解如何允许特定的 URI 通过。另请参阅[处理误报和创建自定义规则](http://www.modsecurity.org/blog/archives/2007/02/handling_false.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T14:49:45.103

作为一种变通方法，您可以尝试使用 Javascript 将数据放入 cookie 中。cookie 将随每个 GET 请求自动发送，并为您提供额外的 2KB 数据空间（如果我没记错的话）。

如果您不想在*每个*请求中都传输该数据，这是非常危险的，所以一般来说我会建议您不要这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T15:05:55.133

这是一个很长的镜头，但尝试添加：

```
header('Content-Type: text/html'); 
```

到您的服务器端代码。如果这没有帮助，请检查您的 Apache 配置，可能是配置错误，因此 PHP 文件无法发出 text/html MIME 类型。如果这没有帮助，如何设置 Apache 以便将 .html 文件视为 PHP 并将目标脚本重命名为 .html？

顺便说一句，来自[http://www.checkupdown.com/status/E406.html](http://www.checkupdown.com/status/E406.html)：

> 客户端（例如您的 Web 浏览器或我们的 CheckUpDown 机器人）可以向 Web 服务器指示它将从 Web 服务器接收回的数据的特征。这是使用以下类型的“接受标头”完成的：
> 
> *   接受：客户端接受的 MIME 类型。例如，浏览器可能只接受它知道如何处理的返回类型的数据（HTML 文件、GIF 文件等）。
> *   Accept-Charset：客户端接受的字符集。
> *   Accept-Encoding：客户端接受的数据编码，例如它理解的文件格式。
> *   Accept-Language：客户接受的自然语言（英语、德语等）。
> *   Accept-Ranges：客户端是否接受来自资源的字节范围，即资源的一部分。
> 
> 如果 Web 服务器检测到它要返回的数据不被客户端接受，它会返回一个包含 406 错误代码的标头。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T15:45:43.883

感谢 Ben 的评论，找到了答案。

虽然这会产生 406 错误：test.php?129+characters

这很好用：test.php?data=129+characters

所以我的猜测是，在第一个实例中，PHP 试图在 $_GET 数组中使用 129 个字符作为名称，而第二个示例只有 4 个字符作为名称，其余的被分配为值，因此数组必须有 128 个字符的限制索引名称。

# .net - 在 .net 中打印 2 列报告

> ID：507341
> 
> 赞同：1
> 
> 时间：2009-02-03T14:45:08.810
> 
> 标签：.net, crystal-reports, reportviewer

如何创建包含 2 列的报告：

例子：

```
Student Name:   Reyes JA               Student Name:   Reyes K 
Student ID:     2008-1000              Student ID:     2008-1000
Semester:       First Sem, 2008-2009   Semester:       First Sem, 2008-2009
Amount:         2000.00                Amount:         2000.00 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T15:21:24.540

很久没有使用水晶了……但这对我来说就像一个“标签”报告（又名“多列格式”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-18T02:40:18.687

我通过使用 ReportViewer 找到了解决方案。

您可以设置列属性的数量。当报表显示数据时，reportviewer 将自动创建 2 列报表。

# visual-studio - 将 Git 与 Visual Studio 一起使用

> ID：507343
> 
> 赞同：1463
> 
> 时间：2009-02-03T14:46:19.010
> 
> 标签：visual-studio, git

作为一个长期的V​​isual [SourceSafe](http://en.wikipedia.org/wiki/Microsoft_Visual_SourceSafe)用户（和仇恨者），我正在与一位同事讨论切换到[SVN 。](http://en.wikipedia.org/wiki/Apache_Subversion)他建议改用[Git](http://en.wikipedia.org/wiki/Git_%28software%29)。因为，显然，它可以在没有中央服务器的情况下用作点对点（我们是一个 3 开发人员团队）。

不过，我还没有找到任何关于将 Git 与 Visual Studio 集成的工具的信息——这样的东西存在吗？

哪些技术可用于将 Git 与 Visual Studio 结合使用？在我开始之前，我需要知道它们有何不同？

* * *

## 回答 #1

> 赞同：1072
> 
> 时间：2009-02-03T15:07:20.700

2013 年 1 月，Microsoft[宣布](https://devblogs.microsoft.com/bharry/git-init-vs/)他们将在其所有 ALM 产品中添加完整的 Git 支持。他们为 Visual Studio 2012[发布了一个插件，添加了 Git 源代码控制集成。](http://visualstudiogallery.msdn.microsoft.com/abafc7d6-dcaa-40f4-8a5e-d6724bdb980c)

另外，还有一个名为[Git Extensions](http://gitextensions.github.io/)的项目，其中包括 Visual Studio 2005、2008、2010 和 2012 的加载项，以及 Windows 资源管理器集成。它会定期更新，并在几个项目中使用过，我发现它非常有用。

另一种选择是[Git Source Control Provider](http://gitscc.codeplex.com/)。

* * *

## 回答 #2

> 赞同：202
> 
> 时间：2009-02-03T14:51:39.687

我将 Git 与 Visual Studio 一起用于我的 Protocol Buffers 到 C# 的端口。我不使用 GUI——我只是保持命令行和 Visual Studio 一样打开。

在大多数情况下它很好 - 唯一的问题是当您想要重命名文件时。Git 和 Visual Studio 都希望*他们*是重命名它的人。我认为在 Visual Studio 中重命名它是可行的方法 - 以后要小心你在 Git 端所做的事情。虽然这在过去有点痛苦，但我听说它在 Git 端实际上应该是非常无缝的，因为它可以注意到内容几乎是相同的。（通常不完全一样——当你重命名类时，你倾向于重命名一个文件，IME。）

但基本上 - 是的，它工作正常。我是 Git 新手，但我可以让它做我需要做的一切。确保你有一个用于 bin 和 obj 以及 *.user 的 git ignore 文件。

* * *

## 回答 #3

> 赞同：93
> 
> 时间：2010-05-31T22:16:29.920

[Git Source Control Provider](http://gitscc.codeplex.com)是一个将 Git 与 Visual Studio 集成的新插件。

* * *

## 回答 #4

> 赞同：52
> 
> 时间：2009-02-03T15:13:16.820

我在工作中对此进行了一些研究（使用 Subversion 和 Git）。Visual Studio 实际上有一个源代码管理集成 API，允许您将第三方源代码管理解决方案集成到 Visual Studio 中。但是，出于几个原因，大多数人不会为此烦恼。

首先是 API 几乎假定您使用的是锁定结帐工作流程。其中有很多钩子，要么实施起来很昂贵，要么在您使用更现代的编辑合并工作流程时完全没有意义。

第二个（相关的）是当您使用 Subversion 和 Git 都鼓励的编辑合并工作流时，您实际上并不*需要*Visual Studio 集成。SourceSafe 与 Visual Studio 集成的主要杀手锏是，您（和编辑器）一眼就可以看出您拥有哪些文件，在编辑之前必须签出哪些文件，即使您想签出也无法签出。然后，它可以帮助您在想要编辑文件时执行任何您需要执行的修订控制巫术。这些都不是典型的 Git 工作流程的一部分。

当您使用 Git（或通常为 SVN）时，您的修订控制交互都发生在您的开发会话之前或之后（一旦您完成所有工作并经过测试）。在这一点上，使用不同的工具真的不是太痛苦。您不必经常来回切换。

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2009-02-03T15:09:37.933

我发现与基于文件或遵循 checkout-edit-commit 模式的源代码控制工具相比，Git 在整个树上工作，从 IDE 集成中获益更少。当然，在某些情况下，单击一个按钮进行一些历史检查可能会很好，但我并没有很怀念这一点。

真正必须做的是让您的 .gitignore 文件充满不应该在共享存储库中的内容。我的通常包含（除其他外）以下内容：

```
*.vcproj.*.user
*.ncb
*.aps
*.suo 
```

但这严重偏向 C++，很少或根本不使用任何类向导风格的功能。

我的使用模式如下所示。

1.  Visual Studio 中的代码、代码、代码。

2.  高兴时（提交代码的明智中间点，切换到 Git，暂存更改并查看差异。如果有任何明显错误，请切换回 Visual Studio 并修复，否则提交。

任何合并、分支、变基或其他花哨的 SCM 东西都可以在 Git 中通过命令提示符轻松完成。Visual Studio 通常对它下的变化非常满意，尽管如果您对项目文件进行了重大更改，它有时可能需要重新加载一些项目。

我发现 Git 的实用性超过了没有完整 IDE 集成的任何小不便，但在某种程度上，这是一个品味问题。

* * *

## 回答 #6

> 赞同：31
> 
> 时间：2013-01-30T23:10:19.683

微软最近宣布[了适用于 Visual Studio 2012 的 Git （更新 2）。](http://visualstudiogallery.msdn.microsoft.com/abafc7d6-dcaa-40f4-8a5e-d6724bdb980c)我还没有玩过它，但[这个视频](http://channel9.msdn.com/posts/GitForVisualStudioTFS)看起来很有希望。

这是关于如何在 Visual Studio 2012 中使用 Git的快速[教程。](http://blogs.msdn.com/b/visualstudioalm/archive/2013/01/30/getting-started-with-git-in-visual-studio-and-team-foundation-service.aspx)

* * *

## 回答 #7

> 赞同：28
> 
> 时间：2009-05-26T01:21:14.960

也不要错过 TortoiseGit ... [https://tortoisegit.org/](https://tortoisegit.org/)

* * *

## 回答 #8

> 赞同：26
> 
> 时间：2013-01-30T17:32:17.433

Microsoft有一个[Visual Studio Tools for Git](http://visualstudiogallery.msdn.microsoft.com/abafc7d6-dcaa-40f4-8a5e-d6724bdb980c)。它只支持 Visual Studio 2012（更新 2）。

* * *

## 回答 #9

> 赞同：19
> 
> 时间：2013-11-10T10:28:47.183

Visual Studio 2013 原生支持 Git。

见[官方公告](http://blogs.msdn.com/b/visualstudioalm/archive/2013/06/26/visual-studio-2013-preview-version-control-tfbuild.aspx)。

* * *

## 回答 #10

> 赞同：18
> 
> 时间：2013-12-09T16:20:02.003

微软在 Visual Studio 中完成的 Git 支持对于基本工作（提交/获取/合并和推送）来说已经足够了。我的建议是避免它...

我非常喜欢[GitExtensions](http://code.google.com/p/gitextensions/)（或者比例较低的[SourceTree](http://sourcetreeapp.com/)）。因为看到[DAG](https://stackoverflow.com/questions/26395521/git-dag-vs-tree)对我来说理解 Git 是如何工作的非常重要。而且您更加了解您项目的其他贡献者所做的事情！

在 Visual Studio 中，您无法快速查看文件或提交之间的差异，也无法（添加到索引）并仅提交部分修改。浏览你的历史也不好......所有这一切都以痛苦的经历结束！

而且，例如，GitExtensions 与有趣的插件捆绑在一起：后台获取、GitFlow ......现在，[持续集成](http://en.wikipedia.org/wiki/Continuous_integration)！

对于[Visual Studio 2015](https://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2015)的用户，如果您安装了 GitHub 扩展，Git 正在形成。但是外部工具仍然更好;-)

* * *

## 回答 #11

> 赞同：15
> 
> 时间：2010-01-27T09:56:59.057

最新版本的[Git 扩展](http://sourceforge.net/projects/gitextensions/)现在支持[Visual Studio 2010](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2010)（以及[Visual Studio 2008](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2008)和[Visual Studio 2005](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2005)）。

我发现它在 Visual Studio 2008 中使用起来相当容易，并且界面在 Visual Studio 2010 中似乎是相同的。

* * *

## 回答 #12

> 赞同：15
> 
> 时间：2011-05-30T11:00:51.613

[TortoiseGit](http://code.google.com/p/tortoisegit/)已经成熟，我推荐它，特别是如果你使用过 TortoiseSVN。

* * *

## 回答 #13

> 赞同：14
> 
> 时间：2011-08-30T18:44:51.377

实际上效果很好的最简单的解决方案是将 TortoiseGit 命令添加为外部工具。

[向 Visual Studio 添加 Git (TortoiseGit) 工具栏的解决方案](https://stackoverflow.com/questions/6169851/solution-to-adding-a-git-tortoisegit-toolbar-to-visual-studio)

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2009-02-07T16:10:57.447

正如 Jon Rimmer 所说，您可以使用 GitExtensions。GitExtensions 可以在 Visual Studio 2005 和 Visual Studio 2008 中使用，如果您手动复制和配置 .Addin 文件，它也可以在 Visual Studio 2010 中使用。

* * *

## 回答 #15

> 赞同：10
> 
> 时间：2013-02-20T20:08:57.010

自2013 年 2 月 11[日起，适用于 Visual Studio 2012 的 Microsoft Git 插件也应适用于 Express 版本](http://visualstudiogallery.msdn.microsoft.com/abafc7d6-dcaa-40f4-8a5e-d6724bdb980c)。

* * *

## 回答 #16

> 赞同：10
> 
> 时间：2013-11-22T11:39:20.047

目前 Visual Studio（2010 和 12）中的 Git 源代码控制有 2 个选项：

1.  [Git 源代码控制提供程序](http://visualstudiogallery.msdn.microsoft.com/63a7e40d-4d71-4fbb-a23b-d262124b8f4c)
2.  [微软 Git 提供程序](http://visualstudiogallery.msdn.microsoft.com/abafc7d6-dcaa-40f4-8a5e-d6724bdb980c)

我都试过了，发现第一个更成熟，功能更多。例如，它可以很好地与乌龟 git 和 git 扩展配合使用，甚至暴露了它们的功能。

**注意**：无论您使用哪个扩展，请确保启用它`Tools -> Options -> Source control -> Plugin Selection`以使其正常工作。

# windows - 隐藏执行另一个 .EXE 文件的 .BAT 文件的命令窗口

> ID：507347
> 
> 赞同：63
> 
> 时间：2009-02-03T14:47:34.953
> 
> 标签：windows, command-line, copy, executable

这是 Windows 中的批处理文件。

这是我的 .bat 文件

```
@echo off
copy "C:\Remoting.config-Training" "C:\Remoting.config"

"C:\ThirdParty.exe" 
```

这工作正常，除了 .bat 文件在“第三方”应用程序运行的整个过程中使命令窗口保持打开状态。
我需要关闭命令窗口。

我会为应用程序使用快捷方式，但我必须能够首先运行此复制命令（它实际上更改了应用程序使用的数据库和服务器）。

第三方应用程序不允许用户更改数据库或应用程序服务器的来源。

我们这样做是为了允许用户从测试环境更改为生产环境。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-02-03T14:52:06.660

使用`start`对我有用：

```
@echo off
copy "C:\Remoting.config-Training" "C:\Remoting.config"
start C:\ThirdParty.exe 
```

编辑：好的，仔细观察，`start`如果引用，似乎将第一个参数解释为新窗口标题。因此，如果您需要引用 ThirdParty.exe 的路径，您还必须提供标题字符串。

例子：

```
:: Title not needed:
start C:\ThirdParty.exe

:: Title needed
start "Third Party App" "C:\Program Files\Vendor\ThirdParty.exe" 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-11-18T18:45:00.697

使用以下代码创建一个`.vbs`文件：

```
CreateObject("Wscript.Shell").Run "your_batch.bat",0,True 
```

这`.vbs`将`your_batch.bat`隐藏。

对我来说很好。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-08-24T10:32:18.137

使用`start`工作正常，除非您使用脚本语言。幸运的是，Python 有一条出路 - 只需使用`pythonw.exe`而不是`python.exe`：

```
:: Title not needed:
start pythonw.exe application.py 
```

如果您需要报价，请执行以下操作：

```
:: Title needed
start "Great Python App" pythonw.exe "C:\Program Files\Vendor\App\application.py" 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-03T14:51:12.807

试试这个：

```
@echo off 
copy "C:\Remoting.config-Training" "C:\Remoting.config"
start C:\ThirdParty.exe
exit 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2011-01-06T06:51:01.500

很棒的小费。它也适用于运行 java 程序的批处理文件。

```
start javaw -classpath "%CP%" main.Main 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-04-07T05:06:09.990

您可能有兴趣尝试我的[silentbatch](http://www.taenarum.com/software/#silentbatch)程序，该程序将运行`.bat`/`.cmd`脚本，完全禁止创建命令提示符窗口（因此您不会看到它出现然后消失），并可选择将输出记录到指定文件。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-11-15T11:14:34.280

或者您可以使用：

```
Start /d "the directory of the executable" /b "the name of the executable" "parameters of the executable" %1 
```

如果 %1 是一个文件，那么它将被传递给您的可执行文件。例如在`notepad.exe foo.txt`%1 中是“foo.txt”。

`/b`start 命令的参数是这样做的：

> 启动应用程序而不打开新的命令提示符窗口。除非应用程序启用+处理，否则`CTRL`+`C`处理将被忽略。使用+中断应用程序。`CTRL``C``CTRL``BREAK`

这正是我们想要的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-03T14:51:04.977

我还没有真正找到一个很好的方法来做这件事，所以我只使用了一个名为[hstart](http://www.ntwind.com/software/utilities/hstart.html)的实用程序来为我做这件事。如果有更简洁的方法来做到这一点，那就太好了。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-10-14T15:17:08.810

您可以创建一个强制隐藏窗口的 VBS 脚本。

```
Set WshShell = WScript.CreateObject("WScript.Shell")
obj = WshShell.Run("""C:\Program Files (x86)\McKesson\HRS
Distributed\SwE.bat""", 0)
set WshShell = Nothing 
```

然后，不执行批处理文件，而是执行脚本。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-05-13T11:52:20.883

使用 Windows API，我们可以启动新进程、控制台应用程序，并隐藏其“黑色”窗口。这可以在进程创建时完成，并且完全避免显示“黑色”窗口。

在[CreateProcess](https://docs.microsoft.com/en-us/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessw)函数中，`dwCreationFlags`参数可以有[CREATE_NO_WINDOW](https://docs.microsoft.com/en-us/windows/desktop/ProcThread/process-creation-flags)标志：

```
The process is a console application that is being run
without a console window. Therefore, the console handle
for the application is not set. This flag is ignored if
the application is not a console application 
```

这是使用此方法和[源代码](https://github.com/AlexKordic/hide-win32-console-window/blob/master/batchscript_starter.cpp)[的 hide-win32-console-window 可执行文件](https://github.com/AlexKordic/hide-win32-console-window/releases)的链接。

`hide-win32-console-window`类似于[Jamesdlin 的 silentbatch 程序](https://stackoverflow.com/a/15859075/70405)。

有一个悬而未决的问题：**当程序的窗口不存在时如何处理程序的输出？**如果发生异常怎么办？丢弃输出不是一个好的解决方案。`hide-win32-console-window`使用匿名管道将程序的输出重定向到当前目录中创建的文件。

## 用法

**batchscript_starter.exe** *full/path/to/application* [*要传递的参数*]

## 运行 python 脚本的示例

```
batchscript_starter.exe c:\Python27\python.exe -c "import time; print('prog start'); time.sleep(3.0); print('prog end');" 
```

输出文件在以`python.2019-05-13-13-32-39.log`python 命令的输出命名的工作目录中创建：

```
prog start
prog end 
```

## 示例运行命令

```
batchscript_starter.exe C:\WINDOWS\system32\cmd.exe /C dir . 
```

输出文件在以`cmd.2019-05-13-13-37-28.log`CMD 输出命名的工作目录中创建：

```
 Volume in drive Z is Storage
 Volume Serial Number is XXXX-YYYY

 Directory of hide_console_project\hide-win32-console-window

2019-05-13  13:37    <DIR>          .
2019-05-13  13:37    <DIR>          ..
2019-05-13  04:41            17,274 batchscript_starter.cpp
2018-04-10  01:08            46,227 batchscript_starter.ico
2019-05-12  11:27             7,042 batchscript_starter.rc
2019-05-12  11:27             1,451 batchscript_starter.sln
2019-05-12  21:51             8,943 batchscript_starter.vcxproj
2019-05-12  21:51             1,664 batchscript_starter.vcxproj.filters
2019-05-13  03:38             1,736 batchscript_starter.vcxproj.user
2019-05-13  13:37                 0 cmd.2019-05-13-13-37-28.log
2019-05-13  04:34             1,518 LICENSE
2019-05-13  13:32                22 python.2019-05-13-13-32-39.log
2019-05-13  04:55                82 README.md
2019-05-13  04:44             1,562 Resource.h
2018-04-10  01:08            46,227 small.ico
2019-05-13  04:44               630 targetver.h
2019-05-13  04:57    <DIR>          x64
              14 File(s)        134,378 bytes
               3 Dir(s)  ???,???,692,992 bytes free 
```

## 运行 .bat 脚本的示例快捷方式

[![启动无窗口 .bat 文件的快捷方式](https://i.stack.imgur.com/MRzAP.jpg)](https://i.stack.imgur.com/MRzAP.jpg)

`Target`场地：

```
C:\batchscript_starter.exe C:\WINDOWS\system32\cmd.exe /C C:\start_wiki.bat 
```

字段中指定的目录`Start in`将保存输出文件。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2010-11-29T20:39:41.957

在不同的用户下运行它。假设这是一个 Windows 框，为计划任务创建一个用户帐户。以该用户身份运行它。命令提示符只会针对当前登录的用户显示。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-07-30T11:20:53.250

使用 Batch2Exe [http://www.f2ko.de/programs.php?lang=en&pid=b2e](http://www.f2ko.de/programs.php?lang=en&pid=b2e)将批处理文件编译为可执行文件。使用“不可见窗口”选项。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-05-02T18:20:40.543

我用它从 C# 启动一个 cmd 文件：

```
Process proc = new Process();
proc.StartInfo.WorkingDirectory = "myWorkingDirectory";
proc.StartInfo.FileName = "myFileName.cmd";
proc.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
proc.Start();
proc.WaitForExit(); 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-08-10T10:46:09.800

请使用这个，上面的不起作用。我已经在 Window server 2003 中进行了测试。

```
@echo off 
copy "C:\Remoting.config-Training" "C:\Remoting.config"
Start /I "" "C:\ThirdParty.exe"
exit 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2017-03-06T23:19:19.100

要使执行 .exe 文件的 .bat 文件的命令窗口尽快退出，请使用`@start`您尝试执行的文件之前的行。这是一个例子：

```
(insert other code here)
@start executable.exe
(insert other code here) 
```

您不必将其他代码与`@start executable.exe`.

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-08-02T11:16:15.757

所以下面的 vbscript 将以隐藏模式启动 cmd/bat 文件。

```
strPath = Wscript.ScriptFullName
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.GetFile(strPath)
strFolder = objFSO.GetParentFolderName(objFile)

'MsgBox(strFolder)

Set WshShell = CreateObject("WScript.Shell") 
WshShell.Run chr(34) & strFolder & "\a.bat" & Chr(34), 0
Set WshShell = Nothing 
```

现在，只有应用程序窗口可见，而不是 cmd.exe 窗口

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-10-06T04:47:00.697

对于那些对肮脏解决方案感到满意的人来说，这是一个简单的解决方法。按win+tab，将bat文件拖放到新桌面，然后忘记它。

我偶尔会制作一个我很少使用的bat文件，不得不使用工具来隐藏窗口是一种拖累。这并不比我需要的复杂。

[![在此处输入图像描述](https://i.stack.imgur.com/4erHw.png)](https://i.stack.imgur.com/4erHw.png)

# asp.net - 如何使用 asp.net 用户控件获取设计表面渲染和设计时数据源选择

> ID：507351
> 
> 赞同：2
> 
> 时间：2009-02-03T14:48:26.650
> 
> 标签：asp.net, data-binding, .net-3.5

如果我创建一个用户控件（编辑：不是 Web 控件/服务器控件），那么获取数据绑定非常简单。我只是添加了一个 datasourceID 属性。

在后面的代码中 (vb)

```
Partial Public Class BandedControl
    Inherits UserControl

    Public Property DataSourceID() As String
        Get
            Return MyGridView.DataSourceID
        End Get
        Set(ByVal value As String)
            MyGridView.DataSourceID = value
        End Set
    End Property

End Class 
```

在后面的代码中 (c#)

```
public partial class BandedControl : UserControl
{

    public string DataSourceID {
        get { return MyGridView.DataSourceID; }
        set { MyGridView.DataSourceID = value; }
    }
} 
```

我的问题是这会破坏设计时渲染，而且我没有下拉列表来选择我的数据源。我该如何解决这个问题。（提示：我想我需要一个类型转换器，但我能找到的所有信息都与服务器控件有关，而不是用户控件）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-10T19:24:01.103

您可以尝试将 IDReferenceProperty 属性添加到您的属性定义中...

```
public partial class BandedControl : UserControl
{
    [System.Web.UI.IDReferenceProperty(typeof(DataSourceControl))]
    public string DataSourceID
    {
        get
        {
           return MyGridView.DataSourceID;
        }
        set
        {
           MyGridView.DataSourceID = value; 
        }
    }
} 
```

有关 IDReferencePropertyAttribute 类的更多信息，请参阅[http://msdn.microsoft.com/en-us/library/system.web.ui.idreferencepropertyattribute.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.idreferencepropertyattribute.aspx)。

如果这不起作用 - 我也会尝试从 DataBoundControl 而不是 UserControl 继承，看看这是否能让你到任何地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:29:30.617

Web UserControls 在运行时动态编译，因此不会在设计时呈现，您要做的是创建一个 Web 自定义控件。您最好的选择是扩展现有的可绑定 Web 控件之一

[http://msdn.microsoft.com/en-us/library/aa651710(VS.71).aspx](http://msdn.microsoft.com/en-us/library/aa651710(VS.71).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T14:01:08.283

不确定这是否正是你想要的，但我似乎记得他们在一些 dnr 电视剧中展示了类似的东西。

我想是米格尔卡斯特罗第 1 集和第 2 集，但可能是第 31 集。

所有视频的存档都在[这里](http://www.dnrtv.com/archives.aspx)

# c# - 如何在 c# winforms 应用程序中获取列表框项的“键”？

> ID：507354
> 
> 赞同：7
> 
> 时间：2009-02-03T14:49:16.650
> 
> 标签：c#, winforms, listbox

我正在编写一个 winforms 应用程序，其中用户从列表框中选择一个项目并编辑一些构成关联对象一部分的数据。然后将编辑从对象列表应用到基础文件。

在 ASP.Net 中，将与用户看到的显示文本不同的系统值分配给列表项是微不足道的。在 winforms 应用程序中，您必须以稍微复杂的（并且在互联网上不经常相关）过程设置每个项目的“显示成员”和“值成员”。

这是我做过的。在调试模式下，我已经确认每个项目现在都有一个值，它是显示成员（用户看到的“友好”字符串）和一个键，即 valuemember，它保存要更新数据的哈希表对象的键存在。

因此，当用户选择要编辑的字符串时，程序应将“密钥”传递给哈希表，拉出对象并允许对其进行编辑。

捕获？

我看不到任何明显的方式告诉程序查看项目的值成员。我天真地期望它会填充列表框的“SelectedValue”属性，但到目前为止这太简单了。那么我到底怎么才能得到列表项的值呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T15:14:55.100

同时使用`SelectedIndexChanged`和`SelectedValueChanged`对我不起作用-该`ListBox's` `SelectedValue`属性始终为空。这也让我感到惊讶。

`ListBox`作为一个蹩脚的解决方法，您可以使用以下命令直接将对象拉出`SelectedIndex`：

```
public Form1()
{
    InitializeComponent();

    this.listBox1.DisplayMember = "Name";
    this.listBox1.ValueMember = "ID";

    this.listBox1.Items.Add(new Test(1, "A"));
    this.listBox1.Items.Add(new Test(2, "B"));
    this.listBox1.Items.Add(new Test(3, "C"));
    this.listBox1.Items.Add(new Test(4, "D"));
    this.listBox1.Items.Add(new Test(5, "E"));
}

private void OnSelectedIndexChanged(object sender, EventArgs e)
{
    if(-1 != this.listBox1.SelectedIndex)
    {
        Test t = this.listBox1.Items[this.listBox1.SelectedIndex] as Test;
        if(null != t)
        {
            this.textBox1.Text = t.Name;
        }
    }
} 
```

(`Test`只是一个具有两个属性的简单类 -`ID`和`Name`)。

似乎应该有更好的方法，但如果没有别的，这应该可行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-03T16:52:03.203

好的，答案是安迪回答的结果，因此我赞成这个答案。

但是当我创建一个小类并尝试将 listitem 转换为该类时，程序抛出了异常。

明显的异常告诉我，程序无法将 DictionaryEntry 转换为我定义的类型的类。

所以我删除了代理类并重新构建了请求：

```
DictionaryEntry de = (DictionaryEntry)listbox.SelectedItem;

string htKey = de.Key.ToString();
```

这一切都很好。

最后的答案很简单。感谢您的提示安迪。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2011-05-19T22:06:25.663

我知道这是一篇非常古老的帖子，但我无法将列表框项目转换为字典项目。该解决方案在 .NET 3.5 中适用于 Windows 窗体。

```
KeyValuePair<int, string> kvp = (KeyValuePair<int, string>)listBoxSystems.SelectedItem;
string szValue = kvp.Value; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T14:59:33.227

尝试从 ListBox1_SelectedValueChanged 事件中获取“ValueMember”。

```
private void ListBox1_SelectedValueChanged(object sender, EventArgs e)
{
    if (ListBox1.SelectedIndex != -1)
    {
        string orbit = ListBox1.SelectedValue.ToString();
    }
}

ArrayList planets = new ArrayList();
planets.Add(new Planet("Mercury", "1"));
planets.Add(new Planet("Venus", "2"));

//Remember to set the Datasource
ListBox1.DataSource = planets;
//Name and Orbit are properties of the 'Planet' class
ListBox1.DisplayMember = "Name";
ListBox1.ValueMember = "Orbit"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-04-13T23:10:45.053

当我搜索如何在 ListBox 中获取 Item 的值时，我最终来到了这里，然后我想到了显而易见的事情。
秘诀在于 中的 Item 方法`C#`，`VB`而其他方法是数组，因此要获取任何 Item 的值，您只需编写以下代码：

```
//Get value of the #1 Item in the ListBox;
ListBox1.Items[1].toString(); 
```

要获取所有项目并将其放入文档或字符串中，只需执行如下操作：

```
string Value;
for (int c = 0; c < ListBox1.Items.Count; c++)  {
    Value = Value + ListBox1.Items[c].toString();
} 
```

我希望我能帮助你们。这是对您的帖子最简单的答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-27T12:45:04.680

**一个简单而干净的方法：**

将项目（包括键和值）添加到列表框：

```
lsbListBoxName.Items.Insert(0, New ListItem("Item 1", 1))
lsbListBoxName.Items.Insert(0, New ListItem("Item 2", 2))
... 
```

获取用户选择的项目：

```
Private Sub lsbListBoxName_SelectedIndexChanged(sender As Object, e As EventArgs) Handles lsbListBoxName.SelectedIndexChanged
    Console.WriteLine(TryCast(lsbListBoxName.SelectedItem, ListItem).Text)
    Console.WriteLine(TryCast(lsbListBoxName.SelectedItem, ListItem).Value)
End Sub 
```

这`lsbListBoxName`是 ListBox 的名称，代码是**VB.NET**，您可以使用[This Online Tool](http://codeconverter.sharpdevelop.net/SnippetConverter.aspx)转换为**C#**。

# database - 在现有数据库上休眠一对多单向

> ID：507358
> 
> 赞同：2
> 
> 时间：2009-02-03T14:50:12.000
> 
> 标签：database, hibernate, mapping

您好 Stack Overflow 专家，我需要您的专业知识：

我正在尝试在现有数据库上使用 Hibernate。目前我正在尝试加载一个用户对象和一个用户数据对象列表。

在数据库中（简化的）布局是

```
|    User      |      |          UserData               |
----------------      -----------------------------------
uid | username |      | uid | parentuid | field | value | 
```

因此，每个 User 对象都匹配 UserData.parentuid = User.uid 的所有 UserData 对象。

我的用户类映射文件

```
 <class name="com.agetor.commons.security.User" table="ac_users">
    <id name="uid" column="uid" type="long" >
        <!--<generator class="native"/>-->
    </id>
    <property name="username" column="username" />   

    <list name="fieldData" cascade="all">
        <key column="parentuid" not-null="true" />
        <index column="parentuid" />
        <one-to-many class="com.agetor.commons.fields.FieldData"/>
    </list>

</class> 
```

Mu UserData 映射文件

```
 <class name="com.agetor.commons.fields.FieldData" table="ac_userdef_data">
    <id name="uid" column="uid" type="long" >
    <!--<generator class="native"/> -->
    </id>
    <!--<property name="parentuid" column="parentuid" />   -->
    <property name="fieldname" column="fieldname" />
    <property name="value" column="value" />
</class> 
```

到目前为止，我已经尝试了许多不同的配置，并且所有配置都有不同程度的失败。此处粘贴的代码不起作用。

*   parentuid 属性被注释掉，否则 Hibernate 会给出“映射中的重复列”错误。
*   目前在uid字段上仍然有一个“映射中的重复列”，我用于`<list-index />`
*   我不明白我在哪里指定 UserData.parentuid 是外键并且列表应该使用 User.uid 作为键。

我希望有人能够提供帮助。

* * *

当您同时定义一对多和多对一时，这不是使其成为双向吗？当前的工作模型是单向的，并且 UserData 没有对 User 的引用。您的建议失败，因为 Hibernate 在 UserData 上找不到用户的 get 或 set 方法。

是否暗示此代码使用 User.uid 作为键并将其与 UserData.parentuid 列匹配？还是在其他地方指定了这个事实？

```
 <list name="fieldData" inverse="true">
    <key column="parentuid" not-null="true" />
    <one-to-many class="com.agetor.commons.fields.FieldData"/>
  </list> 
```

我仍在学习 Hibernate，并通过我能找到的文档和示例进行工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T15:51:27.960

试试这个（干代码）：

```
<class name="com.agetor.commons.security.User" table="ac_users">
  <id name="uid" column="uid" type="long" >
    <!--<generator class="native"/>-->
  </id>
  <property name="username" column="username" />   

  <list name="fieldData" inverse="true">
    <key column="parentuid" not-null="true" />
    <one-to-many class="com.agetor.commons.fields.FieldData"/>
  </list>
</class>

<class name="com.agetor.commons.fields.FieldData" table="ac_userdef_data">
  <id name="uid" column="uid" type="long" >
    <!--<generator class="native"/> -->
  </id>
  <many-to-one name="user" class="com.agetor.commons.security.User" fetch="join">
     <column name="parentuid" not-null="true"/>
  </many-to-one>
  <property name="fieldname" column="fieldname" />
  <property name="value" column="value" />
</class> 
```

如果可行，请尝试添加我遗漏的索引和级联内容。

干杯，
米奇

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T00:48:20.197

我认为您很接近，但 List 可能不是您在新 User 类中想要的数据结构。列表意味着子元素的排序，而表似乎没有。如果您有一个像列表这样的索引集合，则数据必须有一个单独的列来提供索引，因此会出现“映射中的重复列”问题。

我使用的经验法则是 - 每个映射都应该包含它所映射的类的每个成员的条目。因此，例如，您的 User 类应该为其 FieldData 集合提供一个条目，但您的 FieldData 映射不需要 parentuid 的条目，因为该列不映射到 FieldData 类的元素 - 它只是用来放置 FieldData在父对象的集合中。

如果 User 对象确实包含一个有序的 FieldData 集合，则使用一个集合来代替。另一方面，我认为您更可能需要 FieldData 的地图，使用“字段”名称作为索引。然后 FieldData 类不需要映射“字段”列并且不会将其作为成员，它只会具有值（以及该表中的任何其他字段 - 当然如果真的只有一列留给映射，您可能最终会得到一个字符串到字符串的映射。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T08:02:52.377

这是这个问题的最新进展。此配置可以成功从数据库加载。保存不起作用。我决定改为更改数据库设计，因此在我放弃这种方法之前，我将其发布在这里以供其他人参考。

```
 <class name="com.agetor.commons.security.User" table="ac_users">
    <id name="uid" column="uid" type="long" >
        <generator class="increment"/>
    </id>
    <property name="deleted" column="deleted" />
    <property name="username" column="username" />   
    <property name="password" column="passwd" />
    <property name="disabled" column="disabled" />
    <property name="lockout" column="lockout" />
    <property name="expires" column="expires" />
    <bag name="fieldData" lazy="extra">
        <key column="parentuid" not-null="true" />
        <one-to-many class="com.agetor.commons.fields.FieldData"/>
    </bag>
    <bag name="groups" table="ac_group_rel" access="field" lazy="extra">
        <key column="useruid"/>         
        <many-to-many column="groupuid" class="com.agetor.commons.security.Group"/>
    </bag>         
    <join table="ac_userdef_data" optional="true" fetch="join">
        <subselect>
            select
                *
            from
                ac_userdef_data data
            where
                data.objectname = 'user' and
                data.fieldname = 'firstname'
        </subselect>
        <key column="parentuid" />
        <property name="firstname" formula="(select data.value from ac_userdef_data data where data.fieldname = 'firstname' and data.uid = uid)"/>
    </join>
    <join table="ac_userdef_data" optional="true" fetch="join">
        <subselect>
            select
                *
            from
                ac_userdef_data data
            where
                data.objectname = 'user' and
                data.fieldname = 'lastname'
        </subselect>        
        <key column="parentuid" />
        <property name="lastname" formula="(select data.value from ac_userdef_data data where data.fieldname = 'lastname' and data.uid = uid)"/>
    </join>

</class> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-04T06:34:35.647

-->

```
<list name="fieldData" cascade="all">
    <key column="uid" not-null="true" />
    <index column="parentuid" />
    <one-to-many class="com.agetor.commons.fields.FieldData"/>
</list> 
```

试试这个，我只是将 key coloumn 作为 parentuid 更改为 uid。（并且在休眠映射中更好地使用 set）

干杯，纳根德拉普拉萨德..

# asp.net - 如何编写 AJAX/ASP.NET Web 应用程序的离线版本

> ID：507367
> 
> 赞同：1
> 
> 时间：2009-02-03T14:51:26.990
> 
> 标签：asp.net, web-applications, offline

我们有一个使用 AJAX 与 ASP.NET Web 服务通信的 Web 应用程序。我们想写另一个可以离线使用的版本。我们需要能够尽可能地重用我们现有的代码。我们应该考虑哪些方法？

* * *

该应用程序当前正在使用 XmlHttpRequest 从服务器获取动态数据。显然离线版不能与服务器对话，但它确实需要与某些东西对话！我确信在客户端上安装 IIS 或 Cassini 会起作用，但我希望有一个更简单的解决方案。JavaScript 是否没有其他方法可以与某些外部代码对话？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-24T06:54:24.833

现在有很多离线网络应用程序。它只是从 AJAX 演变而来的。

例如：

WoaS（棒上的维基/stickwiki），Tiddly Wiki，

Google doc 和 Gmail 将离线。

您不需要网络服务器即可在离线模式下运行这些网络应用程序。只需将所需的数据、脚本存储在客户端（通常为 XML）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T14:59:17.097

一种可能性是使用卡西尼。这是一个充当 ASP.Net 运行时主机的 Web 服务器。您可以在 Windows 应用程序或 Windows 服务中托管 Cassini。在这种情况下，您不必重写 Web 应用程序和 Web 服务。

大多数其他解决方案确实需要重写您的 Web 应用程序和 Web 服务。根据您编写现有应用程序的方式，您可以重用或多或少的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-25T08:49:27.410

您是否考虑过带有应用程序缓存和离线存储的 HTML5？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-05-23T11:15:50.837

我还没有遇到任何专门为 asp.net 构建的框架，例如可用于 PHP 或 RoR 的框架。这是 Steven 撰写的一篇好文章，可帮助您开始使用 HTML 5 和 ASP.Net[创建 HTML 5 离线应用程序](http://stephenwalther.com/blog/archive/2011/01/26/creating-html5-offline-web-applications-with-asp-net.aspx?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20StephenWalther%20%28Stephen%20Walther%20on%20ASP.NET%20MVC%29)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T13:16:41.623

> 显然离线版不能与服务器对话，但它确实需要与某些东西对话！

输入 HTML5 本地存储。它像数据库一样工作，使您能够将数据放在客户端上。实际上，您必须在 javascript 中重新编写部分代码并将其传输到客户端，但随后它将脱机工作。

本地存储的工作方式如下： - Setter：window.localStorage.setItem(KEY, VALUE) - Getter：window.localStorage.getItem(KEY) - Remove：window.localStorage.removeItem(KEY)

要使主页脱机工作，您需要创建一个清单。这用于在客户端上存储完整的站点。有关清单的更多信息，请参阅此：http: [//diveintohtml5.info/offline.html](http://diveintohtml5.info/offline.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-03T15:00:06.067

如果您希望创建包的“离线”版本，那么到目前为止，您最大的问题是需要将您的站点安装到 IIS 的本地副本中（注册虚拟目录等）。几年前我曾短暂地追求过这一点，但沮丧地放弃了。可以*做到*：许多软件供应商（例如 DevExpress）都这样做，因此您可以拥有他们的演示项目的本地副本。确实，*我*能够做到这一点。问题是经典的“它适用于*我的*电脑”综合症。根本无法保证我的大多数最终用户都具备完成这项工作的技术能力。

因此，我强烈建议您**不要**走这条路，除非您拥有非常精通技术的用户和庞大的支持人员。

但是还有一个非常重要的问题：您是否将所有数据访问代码抽象为 DAL？如果没有，那么您在管理数据访问方面也有很多工作要做。

更新：用户“Rine”推荐了卡西尼。我只是想让你知道我也追求 Cassini 和另一个 3rd-party Web 服务器。我认为 Cassini 存在许可问题，但可能是错误的 - 已经有一段时间了。但是，我清楚地记得使用这种方法遇到了一个又一个障碍，而且*很少*有文档可以帮助我。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-03T15:01:41.290

如果您希望 Web 应用程序脱机运行，您需要一个绑定到 localhost (127.0.0.1) 地址的 Web 服务器（用于 ASP 的 IIS）。在此之后，可以通过在 Web 浏览器中键入[http://127.0.0.1/](http://127.0.0.1/)来访问您的 Web 应用程序，就像您在线一样。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-03T15:08:56.610

如果您`AJAX`依赖`XMLHttpRequest`'s，您可以：

1.  `XML`制作's的静态版本，`XMLHttpRequest`然后将其放入磁盘上的文件夹中。
2.  重写你`XMLHttpRequest` `URL`的 's，使它们指向磁盘上的文件。
3.  重写你`XMLHttpRequest`的，这样他们就不会检查状态（它总是`0`用于`file://`协议。

所有`JScript`作品都在`file://`页面上以及在页面上`http://`。

当然，这不是开发静态页面的最佳方式，但它可能会为您节省一些重写时间。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-02-03T14:57:48.597

您想构建一个 Web 应用程序以离线工作吗？这是不可能的。

您可以将接口代码与其余部分（在不同的 dll 中）分开，并创建一个 Windows 应用程序来模仿您的 Web 应用程序的行为。这样，您就有 2 个不同的用户界面，但业务规则和数据访问的代码相同。

我真的没有看到任何其他方式......

# python - 如何通过 python 读取/检索本地 postfix 收到的电子邮件

> ID：507376
> 
> 赞同：0
> 
> 时间：2009-02-03T14:54:00.197
> 
> 标签：python, email, smtp, postfix-mta, mailing

我在我的生产服务器中使用 postfix，它将接收与 mydomain.com 相关的所有电子邮件在这种情况下，我只想将与少数用户相关的电子邮件转发到不同的电子邮件地址。我的意思是，假设我是超级用户（superuser@mydomain.com）。我想将我所有的电子邮件（所有带有 to:superuser@mydomain.com 的邮件）转发到我的个人电子邮件 ID：superuser@gmail.com。所以我想我会在这里需要一些编程逻辑。所以我想编写一个自定义 python 脚本，它应该读取后缀电子邮件收件箱并根据上述标准转发所有新电子邮件。我可以这样做吗？我在后缀领域听说过 .forward 文件。我可以用它来达到同样的效果吗（完全绕过 pythonic 解决方案）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T17:58:35.037

听起来您只需要设置别名，而不是编写任何脚本。

在大多数 Unix/Linux 系统上，您只需将别名添加到 /etc/aliases 文件中：

```
superuser:                 marc,webmaster@my-site.com 
```

然后运行：

```
newaliases 
```

然后发送给“超级用户”的邮件将转到“marc”和“webmaster@my-site.com”。

这是一个[教程](http://www.linuxhomenetworking.com/wiki/index.php/Quick_HOWTO_:_Ch21_:_Configuring_Linux_Mail_Servers#The_.2Fetc.2Faliases_File)，这是后缀“别名”[手册页](http://www.postfix.org/aliases.5.html)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-03T14:58:19.407

Procmail 是邮件过滤的解决方案。如果需要更多脚本，可以从 .procmailrc 调用 python 脚本。

# google-gears - Google Gears 真的是一个长期的解决方案吗？

> ID：507379
> 
> 赞同：9
> 
> 时间：2009-02-03T14:54:51.367
> 
> 标签：google-gears

我正在考虑在项目中使用[Gears](http://gears.google.com/)，但我对此表示怀疑。

你认为 Gears 真的会（或已经）被社区接受为最先进的解决方案吗？

虽然 Gears 看起来很棒，但我认为社区有点[害怕使用它](https://stackoverflow.com/questions/410959/has-anyone-used-google-gears-in-an-enterprise-scenario)。

你怎么看待这件事？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-04-18T14:53:46.170

如果 Google 决定弃用 Gears，HTML 5 中的客户端存储将提供 Gears 的升级路径。有一篇关于 Google 使用抽象层的有趣文章，以便[在支持 HTML 5 客户端存储的浏览器上不需要 Gears](http://google-code-updates.blogspot.com/2009/04/html5-and-webkit-pave-way-for-mobile.html)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2010-03-06T13:58:55.280

Google Gears 不是一个长期的解决方案。2010 年 2 月 19 日，Google[宣布](http://gearsblog.blogspot.com/2010/02/hello-html5.html)Gears 将停产，他们认为正确的解决方案是通过标准投诉选项，例如 HTML5。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-03T15:41:20.600

Gears 具有 SQL 引擎 ( [SQLite](http://www.sqlite.org) )、脚本 (Javascript) 和良好的 Internet 支持。

事实上，我在市场上看不到类似的东西。

如果 Google 设法将 Gears 推广到小型设备上（SQLite 和 javascrpt 都可以在这些设备上运行），那么就有可能将 Gears 定位为重要的客户端框架。

他们似乎并不着急。说不出为什么。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T14:58:55.133

谷歌在这方面投入了大量时间，并将其集成到他们的一些网络应用程序中。我想它会在这里停留一段时间，但这样的事情总是有风险的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-03T15:02:44.687

Google 即将推出基于 Gears 的“离线 GMail”。鉴于 GMail 的市场份额，我预计它将成为 Gears 采用的杀手级应用。

但很难做出预测，尤其是关于未来。如果您负担得起，您可能想等待，看看离线 GMail 是如何流行起来的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-03T15:05:26.133

任何平台都存在风险，但至少在这个平台上，谷歌正在吃自己的狗粮。即，它是 gmail 离线所必需的，这是您离线使用 google 文档的方式。

我认为从持续支持的角度来看，你可能对 Gears 和使用大多数其他框架一样安全。如果它在当前状态下满足您的需求，那听起来很合适。

# winforms - 按钮图像离按钮顶部太远；太靠近按钮底部

> ID：507380
> 
> 赞同：5
> 
> 时间：2009-02-03T14:54:51.613
> 
> 标签：winforms, user-interface, .net-2.0, button, icons

我正在使用 VB.NET 2005 中的 Windows 窗体，我想要一些带有图像的按钮（我说的是普通的香草 System.Windows.Forms.Button）。我已经按照我想要的方式进行了所有设置，但是按钮上的图像显示得太低，以至于图标的底部几乎就在按钮的底部，并且图像上方有很多空间。

这是截图：
[按钮截图 http://www.freeimagehosting.net/uploads/b28a5c63b8.jpg](http://www.freeimagehosting.net/uploads/b28a5c63b8.jpg)

看看图标的角是如何刷到按钮底部的？

我的按钮高 23 像素，图像是 16 x 16 图标（转换为位图，以便可以将其分配给按钮的 Image 属性）。

我尝试将按钮的 Margin.All 属性设置为 0，并验证 Padding.All 属性为 0。我还尝试将按钮的 ImageAlign 更改为 TopLeft、MiddleLeft 和 BottomLeft，但这些设置似乎都没有任何影响。

有谁知道我如何将图像定位为与按钮的顶部和底部边缘等距离？如有必要，我可以调整按钮或图像的大小，但它们是我喜欢的大小，如果可能的话，我希望保持这种大小。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-08-30T00:22:20.287

我刚刚遇到了一个类似的问题，我通过认真思考能够解决这个问题。（这些情况不是很好吗？）

### 说明

首先，重要的是要了解 ImageAlign 并不意味着您想要图像在按钮上的哪个位置。这意味着应该使用图像上的哪个点（像素）进行定位。因此，如果您选择“TopLeft”，则图像最左上角的像素将在按钮上垂直居中。

当您有一个带有居中图像的按钮时，问题就出现了，其 ImageAlign 垂直设置为“中心”，并且其尺寸为偶数像素。您的图像是 16x16 像素 - 16 是偶数。中间像素理论上在像素 8 和像素 9 之间。由于没有像素 8.5，VB 向下舍入到 8，从而使用像素 8 作为定位像素。这是您不需要的上边距的根本原因。

您的按钮具有奇数像素高度 (23px)，这意味着它具有真正的中心像素 - 像素 12。VB 尝试将图像的中心像素 (8) 定位在按钮的中心像素 (12) 的顶部。这将图像的 8 个像素置于中心下方，将 7 个像素置于中心之上。为了平衡，图像上方会出现 1 像素的边距。

### 解决方案

用底部额外的 1 行像素填充图像。图像现在有一个奇怪的高度（17 像素），使图像具有真正的中心像素，可以与按钮的中心像素完美对齐。

这就是我为自己解决问题的方法。但是，我刚刚想到了一个更简单的可能解决方案。通过为图像分配 1 像素的下边距，您可能会获得相同的结果。我没有测试过这个解决方案，但理论上它似乎等同于第一个解决方案。

Additional note: Two objects of EVEN dimensions should theoretically be able to center-align perfectly. But strangely enough, the alignment problem occurs even if the button AND the image BOTH have even dimensions. (Apparently the compiler is not consistent in the way it determines the center pixel of one control vs another.) Nonetheless, in this case, the same solution applies.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T15:06:18.177

通常，我们将设置以下属性（例如，对于右侧的图像）：

```
ImageAlign: MiddleRight
TextAlign: MiddleLeft 
```

您需要以类似的方式对齐文本和图像。除此之外，请确保您设置的是 Image 属性，而不是 BackgroundImage 属性，并确保您正确地将图标转换为普通位图。你试过一个普通的位图文件吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-20T14:54:05.787

只是一个问题：您确定位图在笔记图像的顶部不包含任何信息吗？我不止一次遇到过这种情况，裁剪在 Photoshop 中看起来正确，但在实时代码中却不正确...... :)

如果是这种情况，您的代码可能是完美的；）

# javascript - MSIE 浏览器高度？

> ID：507381
> 
> 赞同：0
> 
> 时间：2009-02-03T14:55:11.677
> 
> 标签：javascript, internet-explorer

有谁知道如何使用 javascript 在 IE7+ 中获取浏览器高度？我已经看到了几种获取文档或身体高度的方法，但这并不相同。window.innerHeight 在 Firefox 和其他浏览器中运行良好，但 ie 似乎不支持它。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T14:57:38.363

```
var windowWidth = -1, windowHeight = -1;

if(typeof(window.innerWidth) == 'number') { //Non-IE
    windowWidth = window.innerWidth;
    windowHeight = window.innerHeight;
} else if(document.documentElement && (document.documentElement.clientWidth || document.documentElement.clientHeight)) { //IE 6+ in 'standards compliant mode'
    windowWidth = document.documentElement.clientWidth;
    windowHeight = document.documentElement.clientHeight;
} 
```

这对我来说效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T14:57:08.617

要确定浏览器窗口的实际大小，请使用以下属性：

### 基于 Mozilla 的浏览器

```
window.innerWidth
window.innerHeight 
```

### 微软 Internet Explorer

```
document.body.offsetWidth
document.body.offsetHeight 
```

这是我使用的一些代码：

```
var winW = 630, winH = 460;

if (navigator.appName.indexOf("Microsoft") == -1) {
 if (navigator.appName=="Netscape") {
  winW = window.innerWidth;
  winH = window.innerHeight;
 }
 if (navigator.appName.indexOf("Microsoft") != -1) {
  winW = document.body.offsetWidth;
  winH = document.body.offsetHeight;
 }
} 
```

# .net - 如何允许用户在 WPF 中向 UI 控件添加注释？

> ID：507383
> 
> 赞同：5
> 
> 时间：2009-02-03T14:55:28.947
> 
> 标签：.net, wpf, xaml, controls, annotations

支持注释的 WPF 文档查看控件包括 FlowDocumentReader 和 FlowDocumentScrollViewer，以及从 DocumentViewerBase 派生的控件，例如 DocumentViewer 和 FlowDocumentPageViewer。

[WPF 中对基于文档的控件的内置注释支持非常棒](http://msdn.microsoft.com/en-us/library/ms748864.aspx)

我想知道如何将功能添加到 WPF 常用控件（如 Button、TextBox、ListBox 项等）。想法是允许用户将 UI 屏幕上的一些评论传递给另一个用户。

首先想到的是从 DocumentViewerBase 继承并创建自己的自定义控件。我不确定它会如何运作。如果非自定义控件需要注释怎么办？

有没有人工作或看到过这种功能？

任何方向都会有所帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-03T15:12:20.800

嗯。我可能会用一个装饰器来做[这个](http://msdn.microsoft.com/en-us/library/ms753340.aspx)：

```
Imports System.Windows
Imports System.Windows.Documents
Imports System.Windows.Media

Public Class Annotation
    Inherits Adorner

    Private _fill As Brush
    Private _pen As Pen
    Private _text As FormattedText
    Private _annotationText as String

    Public Sub New(ByVal adornedElement As UIElement, ByVal annotationText as String)
        MyBase.New(adornedElement)
        _annotationText = annotationText
        _fill = New SolidColorBrush(Color.FromArgb(&H33, &HB0, &HC4, &HDE))
        _fill.Freeze()
        _pen = New Pen(Brushes.LightSteelBlue, 3.0)
        _pen.Freeze()
        _text = New FormattedText(_annotationText, Globalization.CultureInfo.InvariantCulture, FlowDirection.LeftToRight, New Typeface("Verdana"), 11.0, Brushes.Black)
        Me.IsHitTestVisible = False
    End Sub

    Protected Overrides Sub OnRender(ByVal drawingContext As DrawingContext)
        MyBase.OnRender(drawingContext)
        Dim adornedRect As New Rect(MyBase.AdornedElement.RenderSize)
        drawingContext.DrawRectangle(_fill, _pen, adornedRect)
        drawingContext.DrawText(_text, New Point(0,0))
    End Sub

End Class 
```

然后您可以通过以下方式使用它：

```
Private Sub AddAnnotation(ByVal uie As UIElement, ByVal annotationText as String)
    Dim annotation = New Annotation(uie)
    Dim adornerLayer = AdornerLayer.GetAdornerLayer(uie, annotationText)
    adornerLayer.Add(annotation)
End Sub 
```

我会让你调整注释的位置和实际外观，但你明白了。这适用于**任何**UIElement，包括自定义控件。

这是基于我与 Adorners 所做的其他一些工作的即兴回答。上面的代码可能编译也可能不编译。我没有提供编辑注释的方法，但您可以通过删除“Me.IsHitTestVisible = False”行并在装饰器中处理 MouseUp 事件来轻松完成此操作。

# perl - 如何在 Perl 中解析命令行开关？

> ID：507387
> 
> 赞同：4
> 
> 时间：2009-02-03T14:56:51.893
> 
> 标签：perl, parsing, command-line, arguments

为了在 Perl 中扩展我的[“grep”模拟器](https://stackoverflow.com/questions/506009/scanning-multiple-files-in-perl)，我添加了对一个`-r`开关的支持，该开关可以在子目录中进行递归搜索。现在命令行调用看起来像这样：

```
perl pgrep.pl -r <directory> <expression> 
```

`-r`和参数都是可选的（`directory`目录默认为'.'）。到目前为止，我只需检查第一个参数是否是`-r`，如果是则设置适当的标志，然后使用移位操作扫描其余两个参数。`-r`如果出现在参数列表的末尾或更糟 - 在目录名称和搜索表达式之间，这显然会是一个问题。

一种解决方法是简单地从 @ARGV 数组中删除该`-r`项目，这样我就可以简单地将剩余的参数**移入**，但我无法找到一种方法来做到这一点，而不会在我的奇数位置获得“undef”大批。欢迎您使用任何建议或不同的策略。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-02-03T15:08:50.667

你应该使用[`GetOpt::Long`](http://search.cpan.org/perldoc?Getopt::Long). 这将完成您所描述的一切。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T15:30:34.150

```
use Getopt::Std;

our $opt_r; # will be set to its value if used.
getopts('r:'); # -r has an option. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T15:06:19.347

*   为您的目录添加 -d 开关。我的意见是，“如果一个命令是可选的，它应该有一个开关来启用它。”
*   此外，当我阅读它们时，我会从数组中删除开关（及其参数），只留下我的“表达式”。如果该数组中有超过 1 个元素，则说明有人写错了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-11T18:25:34.510

[我在Mastering Perl](http://oreilly.com/catalog/9780596527242/)中关于“配置”的章节介绍了命令行切换处理的几种可能性，从 perl`-s`到处理这些的流行模块。对于您的示例，如果以后需要，我可能会从[Getopt::Std](http://search.cpan.org/dist/Getopt-Std)开始，然后转换为[Getopt::Long 。](http://search.cpan.org/dist/GetOpt-Long)

祝你好运， ：）

# java - 活动 MQ 与 JBoss 消息传递

> ID：507391
> 
> 赞同：20
> 
> 时间：2009-02-03T14:57:31.237
> 
> 标签：java, jboss, jms, activemq

我将为一个项目选择一个 JMS 消息代理。JMS 服务器必须稳定并且能够处理大量消息，这一点至关重要。我缩小了列表范围，将 Active MQ 和 JBoss Messaging 包括在内。

我想知道你们中是否有人对这些有任何经验，或者甚至更好地在同一环境中尝试过它们。任何指向研究论文或类似内容的链接都会很好。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2010-01-10T13:14:08.273

JBoss Messaging 现在仅处于错误修复模式，因为 JBoss / Red Hat 有一个名为 HornetQ 的新 Java 消息传递项目。

该网站在这里[http://hornetq.org](http://hornetq.org)

HornetQ 拥有卓越的性能、完整的功能集和易用性。

你会发现它的性能与 ActiveMQ 相比*非常*好。

顺便说一句 - 我是 JBoss Messaging 和 HornetQ 的项目负责人。

HornetQ 2.0.0.GA 将于下周发布。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-03T15:20:35.480

[http://activemq.apache.org/how-does-activemq-compare-to-jbossmq.html](http://activemq.apache.org/how-does-activemq-compare-to-jbossmq.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-25T21:27:53.133

JBoss 最近重新实现了他们的 Messaging 的整个实现，例如 JBoss MQ 已被 JBoss Messaging 取代，现在又被替换为“HornetQ”。你只需要记住这一点，因为上面的比较已经*过时*了（更不用说可能有偏见了）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-08-06T15:49:57.893

逐个功能的比较都非常好，但我对 ActiveMQ 的经验（通过多年来的各种版本）是它存在令人震惊的错误，似乎没有人愿意修复这些错误。这令人深感沮丧。此外，文档很混乱，没有正确更新新版本。

与 ActiveMQ 相比，JBossMessaging 的功能相对较少，但它坚如磐石、文档齐全且可靠。它也是 JBossAS 5 的一部分，RedHat 在支持它方面做得很好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-08-06T15:44:31.743

JBoss Messaging 取代了 JBoss MQ。以下是消息传递性能数据： [http ://www.jboss.org/community/docs/DOC-10640](http://www.jboss.org/community/docs/DOC-10640)

JBoss MQ 根本不可扩展：[http ://www.jboss.org/community/docs/DOC-12452](http://www.jboss.org/community/docs/DOC-12452)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-08-06T21:35:17.253

到目前为止，我对 Jboss 的社区 wiki 和文档有很好的体验，它几乎涵盖了所有内容。虽然，我发现他们最新的文档中遗漏了相当明显的配置设置，但我想这一定是从那时起改进了。对于 ActiveMQ，与 Jboss 相比，我发现的文档很少。

我已经使用 MOM 与 Jboss 和 GlassFish 进行了某些研究，但最重要的影响之一是永久存储（如果您要使用任何存储）。我认为这本身非常重要，尤其是它们的兼容性、支持、文档。

看看这个。显然，在 ActiveMQ 中的持久存储方面存在一定的问题。

[http://www.jboss.org/file-access/default/members/jbossmessaging/freezone/docs/userguide-2.0.0.alpha1/html/performance.html#performance.results](http://www.jboss.org/file-access/default/members/jbossmessaging/freezone/docs/userguide-2.0.0.alpha1/html/performance.html#performance.results)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-03-16T19:59:34.707

HornetQ 看起来不错。

[http://www.spec.org/jms2007/results/jms2007.html](http://www.spec.org/jms2007/results/jms2007.html)

# c# - c# 枚举函数参数

> ID：507396
> 
> 赞同：8
> 
> 时间：2009-02-03T14:58:05.087
> 
> 标签：c#, enums, function-parameter

作为[这个问题的后续。](https://stackoverflow.com/questions/492115/c-enums-as-function-parameters)

如何调用函数并传入枚举？

例如我有以下代码：

```
enum e1
{
    //...
}

public void test()
{
    myFunc( e1 );
}

public void myFunc( Enum e )
{
    var names = Enum.GetNames(e.GetType());

    foreach (var name in names)
    {
        // do something!
    }

} 
```

虽然当我这样做时，我得到的“e1”是一个“类型”，但它被用作“变量”错误消息。有什么想法可以帮助吗？

我试图保持函数通用以在任何 Enum 上工作，而不仅仅是特定类型？这甚至可能吗？...使用通用函数怎么样？这行得通吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-03T15:02:37.340

为什么不传递类型？像：

```
 myfunc(typeof(e1));

public void myFunc( Type t )
{
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-03T15:16:56.720

您可以使用通用函数：

```
 public void myFunc<T>()
    {
        var names = Enum.GetNames(typeof(T));

        foreach (var name in names)
        {
            // do something!
        }
    } 
```

并调用：

```
 myFunc<e1>(); 
```

**（编辑）**

如果您尝试约束`T`到`Enum`or ，编译器会抱怨`enum`。

因此，为确保类型安全，您可以将函数更改为：

```
 public static void myFunc<T>()
    {
        Type t = typeof(T);
        if (!t.IsEnum)
            throw new InvalidOperationException("Type is not Enum");

        var names = Enum.GetNames(t);
        foreach (var name in names)
        {
            // do something!
        }
    } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-03T15:01:03.117

您正在尝试将枚举的类型作为该类型的实例传递 - 尝试这样的事情：

```
enum e1
{
    foo, bar
}

public void test()
{
    myFunc(e1.foo); // this needs to be e1.foo or e1.bar - not e1 itself
}

public void myFunc(Enum e)
{
    foreach (string item in Enum.GetNames(e.GetType()))
    {
        // Print values
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T15:06:04.463

采用

```
public void myFunc( e1 e ) { // use enum of type e} 
```

代替

```
public void myFunc( Enum e ) { // use type enum. The same as class or interface. This is not generic! } 
```

# visual-studio-2008 - 如何阻止visualstudio 2008中的上下文菜单消失

> ID：507401
> 
> 赞同：1
> 
> 时间：2009-02-03T14:58:38.627
> 
> 标签：visual-studio-2008

每当我在 visualstudio 中右键单击某些内容时，我都会获得大约半秒钟的上下文菜单。然后它消失了，在我有机会点击任何东西之前。有时，如果我真的很快，无论如何我都会设法单击某些东西，那么它就可以工作。

很烦人。

有时问题会消失几个小时，然后又回来（在 sams Visual Studio 实例中）。我尝试卸载所有插件，重新安装 Visual Studio，均无济于事）。

这不会发生在任何其他程序中。

我希望其他人已经看到了这个问题并找到了解决它的方法。

WinXP，Visual Studio 2008。

PS我希望这个问题不会超出stackoverflow的范围。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-03T15:01:03.350

您是否尝试过使用其他鼠标？更换了无线等的电池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T15:01:10.400

也许尝试使用键盘上的菜单键，看看是否有任何效果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-03-29T22:44:17.987

你安装SP1了吗？我似乎记得以前看到过这样的事情，并认为是这个问题（[http://code.msdn.microsoft.com/KB947751](http://code.msdn.microsoft.com/KB947751)）但是重新阅读你的问题可能不是？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-09-14T13:20:46.687

对于将来遇到这种情况的任何人：

重新安装使这个问题消失了。重新安装 VisualSVN 使这个问题再次出现。重新安装又解决了。

# python - Python xml minidom。产生 一些文字 元素

> ID：507405
> 
> 赞同：13
> 
> 时间：2009-02-03T14:59:17.363
> 
> 标签：python, xml, minidom

我有以下代码。

```
from xml.dom.minidom import Document

doc = Document()

root = doc.createElement('root')
doc.appendChild(root)
main = doc.createElement('Text')
root.appendChild(main)

text = doc.createTextNode('Some text here')
main.appendChild(text)

print doc.toprettyxml(indent='\t') 
```

结果是：

```
<?xml version="1.0" ?>
<root>
    <Text>
        Some text here
    </Text>
</root> 
```

这一切都很好，很漂亮，但是如果我希望输出看起来像这样呢？

```
<?xml version="1.0" ?>
<root>
    <Text>Some text here</Text>
</root> 
```

这很容易做到吗？

欧阳普...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T15:30:32.183

> 这很容易做到吗？

这取决于您想要什么确切的规则，但通常不，您几乎无法控制漂亮的打印。如果你想要一个特定的格式，你通常必须编写自己的 walker。

[pxdom](http://www.doxdesk.com/software/py/pxdom.html)中的 DOM Level 3 LS 参数 format-pretty-print与您的示例非常接近。它的规则是，如果一个元素只包含一个 TextNode，则不会添加额外的空格。然而，它（目前）使用两个空格而不是四个缩进。

```
>>> doc= pxdom.parseString('<a><b>c</b></a>')
>>> doc.domConfig.setParameter('format-pretty-print', True)
>>> print doc.pxdomContent
<?xml version="1.0" encoding="utf-16"?>
<a>
  <b>c</b>
</a> 
```

（为您正在执行的任何类型的序列化调整编码和输出格式。）

如果这是您想要的规则，并且您可以侥幸逃脱，您也可以对 minidom 的 Element.writexml 进行猴子补丁，例如：

```
>>> from xml.dom import minidom
>>> def newwritexml(self, writer, indent= '', addindent= '', newl= ''):
...     if len(self.childNodes)==1 and self.firstChild.nodeType==3:
...         writer.write(indent)
...         self.oldwritexml(writer) # cancel extra whitespace
...         writer.write(newl)
...     else:
...         self.oldwritexml(writer, indent, addindent, newl)
... 
>>> minidom.Element.oldwritexml= minidom.Element.writexml
>>> minidom.Element.writexml= newwritexml 
```

所有关于猴子补丁坏处的常见警告都适用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-19T19:58:11.553

我正在寻找完全相同的东西，我遇到了这篇文章。（xml.dom.minidom 中提供的缩进破坏了我用来操作 XML 的另一个工具，我需要缩进）我用一个稍微复杂的示例尝试了公认的解决方案，结果如下：

```
In [1]: import pxdom

In [2]: xml = '<a><b>fda</b><c><b>fdsa</b></c></a>'

In [3]: doc = pxdom.parseString(xml)

In [4]: doc.domConfig.setParameter('format-pretty-print', True)

In [5]: print doc.pxdomContent
<?xml version="1.0" encoding="utf-16"?>
<a>
  <b>fda</b><c>
    <b>fdsa</b>
  </c>
</a> 
```

打印出来的漂亮 XML 格式不正确，而且我对猴子补丁不太满意（即我几乎不知道它的含义，并且理解它很糟糕），所以我寻找了另一种解决方案。

我正在将输出写入文件，因此我可以使用 Ubuntu 的 xmlindent 程序（$sudo aptitude install xmlindent）。所以我只是将未格式化的文件写入文件，然后从 python 程序中调用 xmlindent：

```
from subprocess import Popen, PIPE
Popen(["xmlindent", "-i", "2", "-w", "-f", "-nbe", file_name], 
      stderr=PIPE, 
      stdout=PIPE).communicate() 
```

-w 开关会导致文件被覆盖，但令人讨厌的是会留下一个名为“myfile.xml~”的文件，您可能希望将其删除。其他开关可以让格式正确（对我来说）。

PS xmlindent 是一个流格式化程序，即您可以按如下方式使用它：

```
cat myfile.xml | xmlindent > myfile_indented.xml 
```

因此，如果需要，您可以在 python 脚本中使用它而无需写入文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-27T16:43:31.887

这可以通过 toxml() 来完成，使用正则表达式来整理。

```
>>> from xml.dom.minidom import Document
>>> import re
>>> doc = Document()
>>> root = doc.createElement('root')
>>> _ = doc.appendChild(root)
>>> main = doc.createElement('Text')
>>> _ = root.appendChild(main)
>>> text = doc.createTextNode('Some text here')
>>> _ = main.appendChild(text)
>>> out = doc.toxml()
>>> niceOut = re.sub(r'><', r'>\n<', re.sub(r'(<\/.*?>)', r'\1\n', out))
>>> print niceOut
<?xml version="1.0" ?>
<root>
<Text>Some text here</Text>
</root> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-03-08T16:48:22.527

pyxml 包通过使用 xml.dom.ext.PrettyPrint() 函数提供了一个简单的解决方案。它还可以打印到文件描述符。

但是 pyxml 包不再维护。

欧尔扬·彼得森

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-25T16:18:07.500

该解决方案对我有用，无需猴子修补或停止使用 minidom：

```
from xml.dom.ext import PrettyPrint
from StringIO import StringIO

def toprettyxml_fixed (node, encoding='utf-8'):
    tmpStream = StringIO()
    PrettyPrint(node, stream=tmpStream, encoding=encoding)
    return tmpStream.getvalue() 
```

[http://ronrothman.com/public/leftbraned/xml-dom-minidom-toprettyxml-and-silly-whitespace/#best-solution](http://ronrothman.com/public/leftbraned/xml-dom-minidom-toprettyxml-and-silly-whitespace/#best-solution)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-07T13:51:20.917

最简单的方法是使用 prettyxml，并删除标签内的 \n 和 \t。这样，您就可以按照示例中的要求保持缩进。

`xml_output = doc.toprettyxml() nojunkintags = re.sub('>(\n|\t)</', '', xml_output) print nojunkintags`

# vba - 如何使用 VBA 检索 Visio 自定义形状信息

> ID：507409
> 
> 赞同：5
> 
> 时间：2009-02-03T14:59:48.437
> 
> 标签：vba, ms-office, visio, office-2003

使用 VBA，我如何从 Visio 2003 图表中检索自定义形状信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-03T18:02:14.107

从 Visio 形状获取自定义形状信息：

```
Function GetCustomPropertyValue(TheShape As Visio.Shape, ThePropertyName As String) As String
    On Error Resume Next
    GetCustomPropertyValue = TheShape.CellsU("Prop." & ThePropertyName).ResultStr(visNone)
End Function 
```

这个函数所做的只是使用形状上的 cellsu 属性来按名称获取自定义属性 ShapeSheet 单元格...

如果你是一个坚持使用 on error resume 的人，你可以通过首先检查单元格是否存在来检查单元格是否存在：

```
if TheShape.CellExistsU( "Prop." & ThePropertyName , 0 ) then
GetCustomPropertyValue = TheShape.CellsU("Prop." & THePropertyName).ResultStr(VisNone) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-08T23:08:06.990

[在http://visio.mvps.org/VBA.htm](http://visio.mvps.org/VBA.htm)找到这个（自定义属性）

```
Public Sub CustomProp()
    Dim shpObj As Visio.Shape, celObj As Visio.Cell
    Dim i As Integer, j As Integer, ShpNo As Integer
    Dim LabelName As String, PromptName As String, ValName As String, Tabchr As String

    Open "C:\CustomProp.txt" For Output Shared As #1

    Tabchr = Chr(9)

    For ShpNo = 1 To Visio.ActivePage.Shapes.Count
        Set shpObj = Visio.ActivePage.Shapes(ShpNo)
        nRows = shpObj.RowCount(Visio.visSectionProp)
        For i = 0 To nRows - 1
            Set celObj = shpObj.CellsSRC(Visio.visSectionProp, i, 0)
            ValName = celObj.ResultStr(Visio.visNone)
            Set celObj = shpObj.CellsSRC(Visio.visSectionProp, i, 1)
            PromptName = celObj.ResultStr(Visio.visNone)
            Set celObj = shpObj.CellsSRC(Visio.visSectionProp, i, 2)
            LabelName = celObj.ResultStr(Visio.visNone)

            Debug.Print shpObj.Name, LabelName, PromptName, ValName
            Print #1, shpObj.Name; Tabchr; LabelName; Tabchr; PromptName; Tabchr; ValName
        Next i
    Next ShpNo

    Close #1
End Sub 
```

# visual-studio - Visual Studio：如何在 Visual Studio 中引用程序集？

> ID：507422
> 
> 赞同：1
> 
> 时间：2009-02-03T15:01:35.080
> 
> 标签：visual-studio, assemblies

我有一个程序集 dll 的调试和发布版本。

他们坐在我电脑上的目录。对于其他开发人员，他们坐在他们计算机上的目录中。

对于应用程序的调试版本，我想使用调试程序集。对于应用程序的发布版本，我想使用发布程序集。

这就是问题所在。

* * *

对于那些不注意的人，这里有很多问题。如何在我的计算机上引用程序集，在将项目签入源代码管理后，该程序集将成为其他人计算机上的有效路径。

如何根据解决方案类型（调试、发布）设置“参考”节点。

我尝试将调试程序集复制到

```
\bin\Debug 
```

和释放组件

```
\bin\Release 
```

并将程序集 dll 添加到源代码控制中

\bin\调试\bin\Release

文件夹。然后我希望程序集可以在可执行文件的文件夹中找到。

问题是其他开发人员的机器收到无法覆盖程序集 dll 的错误 - 当 CopyLocal 为 false 时。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-03T15:10:02.020

为这些 DLL 使用一个公共结构（一个公共目录名）并链接到这个相对文件。

来自 .csproj 文件的示例：

```
<Reference Include="utils_xxx, Version=1.2.10.0, Culture=neutral, processorArchitecture=MSIL">
  <SpecificVersion>False</SpecificVersion>
  <HintPath>..\..\common_utils_dllproject_dir\utils\bin\$(Configuration)\utils_xxx.dll</HintPath>
</Reference> 
```

您可能必须手动输入，但是一旦进入 repo，对所有人都是一样的。现在你只需要说服你的开发人员适应这个目录布局和命名。

PS：如果你忽略了它：$(Configuration) 是使用 Release/Debug-DLLs 的技巧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T21:35:23.727

*   开发人员*必须*在他们的机器上的某个地方有一个文件夹，结构如下......

```
[父文件夹]
  调试
    [调试程序集].dll
  发布
    [发布程序集].dll

```

*   打开项目并添加对第一步中的 Debug 程序集的引用。检查它。
*   让*每个*开发人员打开项目并在项目属性中添加参考路径。该路径应该是从第一步开始到 Debug 文件夹的绝对路径。
*   让*每个*开发人员关闭 Visual Studio 并编辑现在与项目文件位于同一文件夹中的 [project].user 文件。将“调试”更改为“$（配置）”。保存并关闭。
*   现在应该可以了。如果您在解决方案资源管理器中选择引用并查看属性网格中的路径属性，它可能不正确。这只是一个VS问题。如果您在发布和调试中测试构建，它应该可以工作。

之所以可行，是因为开发人员设置的参考路径存储在一个用户文件中，该文件永远不会被检入源代码管理。因此，每个开发人员的路径可能不同。该解决方案基本上是从 Leonidas 的答案中窃取的，但使用了参考路径。

**免责声明**
我不知道您情况的所有细节，但我个人不会这样做。我可能会 GAC 开发人员机器上的程序集的发布版本。然后我会有一个在服务器上运行的构建脚本来处理你的复杂场景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T15:06:31.187

包括项目和项目链接？不知道这在你的情况下是否有效......

# python - Python包含，模块范围问题

> ID：507425
> 
> 赞同：2
> 
> 时间：2009-02-03T15:02:03.160
> 
> 标签：python, import, include, module

我正在处理我的第一个重要的 Python 项目，但在范围问题和在包含的文件中执行代码时遇到了麻烦。以前我的经验是使用 PHP。

我想做的是有一个文件来设置许多配置变量，然后将在整个代码中使用这些变量。另外，我想让某些函数和类在全球范围内可用。例如，主文件将包含一个其他文件，该文件将加载一堆常用函数（每个函数都在自己的文件中）和一个配置文件。在这些加载的文件中，我还希望能够访问函数和配置变量。我不想做的是必须将整个例程放在每个（包含）文件的开头以包含所有其余部分。此外，这些包含的文件位于各种子目录中，这使得导入它们变得更加困难（特别是如果我必须在每个文件中重新导入）。

无论如何，我正在寻找有关构建代码以实现我想要的最佳方式的一般建议。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T15:36:21.187

在 python 中，通常的做法是拥有一堆实现各种功能的模块，然后拥有一个模块作为所有功能的访问点。这基本上是[门面模式](http://en.wikipedia.org/wiki/Facade_Pattern)。

一个例子：假设你正在编写一个包`foo`，其中包括`bar`、`baz`和`moo`模块。

```
~/project/foo
~/project/foo/__init__.py
~/project/foo/bar.py
~/project/foo/baz.py
~/project/foo/moo.py
~/project/foo/config.py 
```

你通常会这样写`__init__.py`：

```
from foo.bar import func1, func2
from foo.baz import func3, constant1
from foo.moo import func1 as moofunc1
from foo.config import * 
```

现在，当你想使用你刚刚做的功能时

```
import foo
foo.func1()
print foo.constant1
# assuming config defines a config1 variable
print foo.config1 
```

* * *

如果你愿意，你可以安排你的代码，这样你只需要编写

```
import foo 
```

在每个模块的顶部，然后通过`foo`它访问所有内容（您可能应该将其命名为“全局”或类似的名称）。如果你不喜欢命名空间，你甚至可以这样做

```
from foo import * 
```

并将一切都作为全球性的，但这真的不推荐。请记住：命名空间是一个很棒的主意！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T15:36:36.850

这是一个两步过程：

1.  在您的模块 globals.py 中，从任何地方导入项目。
2.  在所有其他模块中，执行“从全局导入 *”

这会将所有这些名称带入当前模块的命名空间。

现在，已经告诉你如何做到这一点，*让我建议你不要这样做*。首先，您正在使用一堆“神奇定义”的实体加载本地名称空间。这违反[了 Python 之禅的](http://www.python.org/dev/peps/pep-0020/)戒律 2 ，“显式胜于隐式”。尝试使用“import foo”，然后说“foo.some_value”，而不是“from foo import *”。如果您想使用较短的名称，请使用“from foo import mumble, snort”。这些方法中的任何一个都直接暴露了模块 foo.py 的实际使用。使用 globals.py 方法有点太神奇了。主要的例外是在 __init__.py 中，您在其中隐藏了包的一些内部方面。

全局变量也是半邪恶的，因为很难弄清楚谁在修改（或破坏）它们。如果您有明确定义的获取/设置全局变量的例程，那么调试它们会简单*得多*。

我知道 PHP 有这种“一切都是一个、大、快乐的命名空间”的概念，但它实际上只是糟糕的语言设计的产物。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T15:35:06.933

据我所知，程序范围的全局变量/函数/类/等。在 Python 中不存在，所有内容都“限制”在某个模块（命名空间）中。因此，如果您希望在代码的许多部分中使用某些函数或类，一种解决方案是创建一些模块，例如：“globFunCl”（​​从其他地方定义/导入您想要成为“全局”的所有内容）和“config”（包含配置变量）并在需要它们的任何地方导入它们。如果您不喜欢使用嵌套命名空间的想法，您可以使用：

```
from globFunCl import * 
```

这样，您将“隐藏”命名空间（使名称看起来像“全局”）。

我不确定您不想“*将整个例程放在每个（包含的）文件的开头以包含所有其余部分*”的意思，恐怕您无法真正摆脱这一点。不过，请查看[Python 包](http://docs.python.org/tutorial/modules.html#packages)，它们应该会让您更轻松。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T15:47:01.823

这在一定程度上取决于您希望如何打包。您可以考虑*文件*或*模块*。后者是“更 Pythonic”，使您能够准确地决定哪些项目（它们可以是任何具有名称的项目：类、函数、变量等）要使其可见。

基本规则是，对于您导入的任何文件或模块，可以直接访问其命名空间中的任何内容。因此，如果 myfile.py 包含定义`def myfun(...):`，`class myclass(...)`那么`myvar = ...`您可以通过以下方式从另一个文件访问它们

```
import myfile
y = myfile.myfun(...)
x = myfile.myvar 
```

或者

```
from myfile import myfun, myvar, myclass 
```

至关重要的是，可以访问 myfile 顶层的任何内容，*包括*导入。所以如果 myfile 包含`from foo import bar`, then`myfile.bar`也是可用的。

# php - 如何用php链接字符串中的url？

> ID：507436
> 
> 赞同：34
> 
> 时间：2009-02-03T15:04:11.283
> 
> 标签：php, url, string

我有以下字符串：

```
"Look on http://www.google.com". 
```

我需要将其转换为：

> “在[http://www.google.com](http://www.google.com)上查看”

原始字符串可以有超过 1 个 URL 字符串。

我如何在 php 中执行此操作？

谢谢

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2009-02-03T15:07:59.373

您可以使用以下内容：

```
$string = "Look on http://www.google.com";
$string = preg_replace(
              "~[[:alpha:]]+://[^<>[:space:]]+[[:alnum:]/]~",
              "<a href=\"\\0\">\\0</a>", 
              $string); 
```

**PHP 版本 < 5.3 (ereg_replace) 否则 (preg_replace)**

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2009-02-03T15:20:57.677

`lib_autolink`做得很好，避免了链接后的额外标点符号和 HTML 标记内的链接之类的陷阱：

[https://github.com/iamcal/lib_autolink](https://github.com/iamcal/lib_autolink)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-02-03T15:11:12.067

看看[正则表达式](http://www.regular-expressions.info/)。然后你会做类似的[事情](http://snipplr.com/view/2371/regex-regular-expression-to-match-a-url/)：

```
$text = preg_replace('@(https?://([-\w\.]+)+(:\d+)?(/([\w/_\.]*(\?\S+)?)?)?)@', '<a href="$1">$1</a>', $text); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-10-21T16:25:22.367

从今天开始的小更新。仅仅一个正则表达式是不够的。Urls 可以包含 unicode 字符、括号、标点符号等。

有一个[Url 高亮](https://github.com/vstelmakh/url-highlight)库，涵盖了许多边缘情况。

例子：

```
<?php

use VStelmakh\UrlHighlight\UrlHighlight;

$urlHighlight = new UrlHighlight();
$urlHighlight->highlightUrls('Look on http://www.google.com or even google.com.');
// return: 'Look on <a href="http://www.google.com">http://www.google.com</a> or even <a href="http://google.com">google.com</a>.' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-03T15:09:54.253

您将需要使用正则表达式...

这样的事情会有所帮助。

```
$result = preg_replace('/\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[A-Z0-9+&@#\/%=~_|]/i', '<a href="\0">\0</a>', $text); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-11-02T11:45:45.277

我找到了一个示例，它允许包含 ftp、https 和其他似乎适用于多个 URL 的链接

[如何检测 urls-in-text-and-convert-to-html-links-php-using-regular-expressions](http://blog.zero7ict.com/2009/10/how-to-detect-urls-in-text-and-convert-to-html-links-php-using-regular-expressions/)

```
<?php
// The Regular Expression filter
$pattern = "/(http|https|ftp|ftps)\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(\/\S*)?/";

//example text
$text="Example user text with a URL http://www.zero7web.com , second link http://www.didsburydesign.co.uk";

// convert URLs into Links
$text= preg_replace($pattern, "<a href=\"\\0\" rel=\"nofollow\">\\0</a>", $text);

echo $text;
?> 
```

将 nofollow 添加到链接可能也是一个好主意，因为它是用户提交的值。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2010-07-16T06:30:31.347

试试这个...

```
<?

   function link_it($text)  
   {  
        $text= preg_replace("/(^|[\n ])([\w]*?)([\w]*?:\/\/[\w]+[^ \,\"\n\r\t<]*)/is", "$1$2<a href=\"$3\" >$3</a>", $text);  
        $text= preg_replace("/(^|[\n ])([\w]*?)((www)\.[^ \,\"\t\n\r<]*)/is", "$1$2<a href=\"http://$3\" >$3</a>", $text);
                $text= preg_replace("/(^|[\n ])([\w]*?)((ftp)\.[^ \,\"\t\n\r<]*)/is", "$1$2<a href=\"ftp://$3\" >$3</a>", $text);  
        $text= preg_replace("/(^|[\n ])([a-z0-9&\-_\.]+?)@([\w\-]+\.([\w\-\.]+)+)/i", "$1<a href=\"mailto:$2@$3\">$2@$3</a>", $text);  
        return($text);  
    }

$text = "ini link gue: http://sapua.com <br>
https://sapua.com <br>
anything1://www.sss.com <br>

dua www.google.com <br>
tiga http://www.google.com <br>

ftp.sapua.com <br>

someone@sapua.com

";

print link_it($text);

?> 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2015-07-07T11:18:24.120

[我在http://code.seebz.net/p/autolink-php/](http://code.seebz.net/p/autolink-php/)找到了这段代码，并对其进行了一些调整以将 www.* 识别为链接。我不太熟悉正则表达式，但我认为两条 str_replace 行可以修改为一个正则表达式

```
<?php
$text = 'First link is: www.example.com. Second link is http://example.com. Third link is https://example.com. Fourth link is http://www.example.com. Fifth link is <a href="http://www.example.com">www.example.com</a>';

function autolink($str, $attributes=array()) {
$str = str_replace("http://www","www",$str);
$str = str_replace("https://www","www",$str);

$attrs = '';
foreach ($attributes as $attribute => $value) {
$attrs .= " {$attribute}=\"{$value}\"";
}
$str = ' ' . $str;
$str = preg_replace(
'`([^"=\'>])((http|https|ftp)://[^\s<]+[^\s<\.)])`i',
'$1<a href="$2"'.$attrs.'>$2</a>',
$str
);
$str = preg_replace(
'`([^"=\'>])((www).[^\s<]+[^\s<\.)])`i',
'$1<a href="http://$2"'.$attrs.'>$2</a>',
$str
);
$str = substr($str, 1);
return $str;
}

echo autolink($text);
?> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-02-23T19:25:35.050

正确链接 URL 并非易事。（请参阅： http: [//www.codinghorror.com/blog/2008/10/the-problem-with-urls.html](http://www.codinghorror.com/blog/2008/10/the-problem-with-urls.html)了解更多关于为什么会这样的信息。）对问题有一个很好的解决方案（对于 PHP 和/或 Javascript）。见：http: [//jmrware.com/articles/2010/linkifyurl/linkify.html](http://jmrware.com/articles/2010/linkifyurl/linkify.html)

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-03-08T12:03:43.970

查看我的 linkify 函数，它使用 preg_replace_callback（仅限 PHP 5.3）。它支持http、email和twitter：

[http://www.jasny.net/articles/linkify-turning-urls-into-clickable-links-in-php/](http://www.jasny.net/articles/linkify-turning-urls-into-clickable-links-in-php/)

```
/**
* Turn all URLs in clickable links.
*
* @param string $value
* @param array $protocols http/https, ftp, mail, twitter
* @param array $attributes
* @param string $mode normal or all
* @return string
*/
    function linkify($value, $protocols = array('http', 'mail'), array $attributes = array(), $mode = 'normal')
    {
        // Link attributes
        $attr = '';
        foreach ($attributes as $key => $val) {
            $attr = ' ' . $key . '="' . htmlentities($val) . '"';
        }

        $links = array();

        // Extract existing links and tags
        $value = preg_replace_callback('~(<a .*?>.*?</a>|<.*?>)~i', function ($match) use (&$links) { return '<' . array_push($links, $match[1]) . '>'; }, $value);

        // Extract text links for each protocol
        foreach ((array)$protocols as $protocol) {
            switch ($protocol) {
                case 'http':
                case 'https': $value = preg_replace_callback($mode != 'all' ? '~(?:(https?)://([^\s<]+)|(www\.[^\s<]+?\.[^\s<]+))(?<![\.,:])~i' : '~([^\s<]+\.[^\s<]+)(?<![\.,:])~i', function ($match) use ($protocol, &$links, $attr) { if ($match[1]) $protocol = $match[1]; $link = $match[2] ?: $match[3]; return '<' . array_push($links, '<a' . $attr . ' href="' . $protocol . '://' . $link . '">' . $link . '</a>') . '>'; }, $value); break;
                case 'mail': $value = preg_replace_callback('~([^\s<]+?@[^\s<]+?\.[^\s<]+)(?<![\.,:])~', function ($match) use (&$links, $attr) { return '<' . array_push($links, '<a' . $attr . ' href="mailto:' . $match[1] . '">' . $match[1] . '</a>') . '>'; }, $value); break;
                case 'twitter': $value = preg_replace_callback('~(?<!\w)[@#](\w++)~', function ($match) use (&$links, $attr) { return '<' . array_push($links, '<a' . $attr . ' href="https://twitter.com/' . ($match[0][0] == '@' ? '' : 'search/%23') . $match[1] . '">' . $match[0] . '</a>') . '>'; }, $value); break;
                default: $value = preg_replace_callback($mode != 'all' ? '~' . preg_quote($protocol, '~') . '://([^\s<]+?)(?<![\.,:])~i' : '~([^\s<]+)(?<![\.,:])~i', function ($match) use ($protocol, &$links, $attr) { return '<' . array_push($links, '<a' . $attr . ' href="' . $protocol . '://' . $match[1] . '">' . $match[1] . '</a>') . '>'; }, $value); break;
            }
        }

        // Insert all link
        return preg_replace_callback('/<(\d+)>/', function ($match) use (&$links) { return $links[$match[1] - 1]; }, $value);
    } 
```

# c++ - GCC 4.0：模板函数中的“没有要调用的匹配函数”

> ID：507446
> 
> 赞同：5
> 
> 时间：2009-02-03T15:06:05.087
> 
> 标签：c++, templates, gcc

我想知道为什么以下人为的示例代码在 Visual Studio 2005 中运行良好，但在 GCC 中生成错误（调用 Interpolate() 时“没有要调用的匹配函数”，如下所示）。

另外，我该如何解决这个问题？似乎错误消息只是一个通用消息，因为 GCC 没有针对问题的实际原因更具体的消息，它必须输出一些东西。我对如何在没有一些非常丑陋的解决方法的情况下继续移植这个类有点不知所措。

```
namespace Geo
{
    template <class T>
    class TMyPointTemplate
    {
        T X,Y;
    public:
        inline TMyPointTemplate(): X(0), Y(0) {}
        inline TMyPointTemplate(T _X,T _Y): X(_X), Y(_Y) {}
        inline T GetX ()const { return X; }
        inline T GetY ()const { return Y; }
        //...
        template<T> TMyPointTemplate<T> Interpolate(const TMyPointTemplate<T> &OtherPoint)const
        {
            return TMyPointTemplate((X+OtherPoint.GetX())/2,(Y+OtherPoint.GetY())/2);
        }           
    };
    typedef TMyPointTemplate<int> IntegerPoint;
}

Geo::IntegerPoint Point1(0,0);
Geo::IntegerPoint Point2(10,10);
Geo::IntegerPoint Point3=Point1.Interpolate(Point2); //GCC PRODUCES ERROR: no matching function for call to 'Geo::TMyPointTemplate<int>::Interpolate(Geo::IntegerPoint&)' 
```

谢谢你的帮助，

阿德里安

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-03T15:19:35.730

我认为您在函数定义中根本不需要模板，因为它是与类内联定义的

```
TMyPointTemplate Interpolate(const TMyPointTemplate &OtherPoint)const { 
```

应该做。

当你使用模板来定义非内联函数时，我认为你需要像这样的 class 关键字。

```
template<class T> // <- here
TMyPointTemplate<T> TMyPointTemplate<T>::Interpolate(const TMyPointTemplate<T> &OtherPoint)const { 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-03T15:48:13.770

埃文的[回答](https://stackoverflow.com/questions/507446/gcc-4-0-no-matching-function-to-call-in-template-function/507511#507511)解决了这个问题，但我认为解释原因可能很有用。

如所写，Interpolate 是一个成员模板函数，具有单个未命名的“非类型模板参数”（而不是几乎可以肯定是您想要的类型模板参数）。为了说明这一点，我们可以给该参数一个名称：

```
template<T t> TMyPointTemplate<T> Interpolate
      (const TMyPointTemplate<T> &OtherPoint)const 
```

现在我们可以看到如何调用该函数，我们只需要为 't' 提供一个值：

```
Geo::IntegerPoint Point3=Point1.Interpolate <0> (Point2); 
```

在此处的“T”之前添加*类*或*类型名*，会将其声明为类型模板参数。但是，仅进行该更改将导致错误，因为标识符“T”已被用于封闭类模板中的模板参数名称。我们必须更改成员函数模板的模板参数名称：

```
template <class T>
class TMyPointTemplate
{
public:
  //...
  template<class S> TMyPointTemplate<T> Interpolate
                 (const TMyPointTemplate<S> &OtherPoint) const
  {
    return ...;
  }                       
}; 
```

# asp.net - 如何在 GridView 中将日期时间字符串修剪为其分钟？

> ID：507466
> 
> 赞同：0
> 
> 时间：2009-02-03T15:09:04.910
> 
> 标签：asp.net, datetime, gridview, asp.net-2.0

我已将*GridView*中的字段绑定到数据对象的某些`dateTime`属性。字段显示为秒级别。它看起来像`2009-2-3 18:00:00 PM`。

我只是希望它显示到分钟，例如`2009-2-3 18:00`。

做这个的最好方式是什么？

**编辑**：我发现使用`DataFormatString="{0:g}"`对我来说很好。格式为`2009-2-3 6:00 PM`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T15:52:05.353

虽然您已经找到了解决方案，但这里有一些附加信息：

您可以在 MSDN 的此页面上找到所有标准日期和时间格式字符串（例如“g”）的列表：标准日期时间格式[字符串](http://msdn.microsoft.com/en-us/library/az4se3k1%28VS.80%29.aspx)。

如果不想使用其中一种预定义格式，还有一个关于[自定义日期和时间格式字符串](http://msdn.microsoft.com/en-us/library/8kb3ddd4%28VS.80%29.aspx)的页面。例如，要完全按照您在问题中使用的格式（“2009-2-3 18:00”）获取日期，您可以使用格式字符串“yyyy-Md HH:mm”。

在使用自定义格式字符串之前，请记住使用标准（预定义）格式字符串的优点是它会自动考虑当前的文化（区域设置）。因此，如果您想向用户显示日期，可能预定义的格式将是更好的选择。

# sql-server-2005 - SQL Server 2005 报告服务 - 优点和缺点

> ID：507470
> 
> 赞同：11
> 
> 时间：2009-02-03T15:09:41.443
> 
> 标签：sql-server-2005, reporting-services, asp.net-2.0

我正在使用 ASP .NET 2.0、VS 2008 和 SQL Server 2005 开发一个 Web 应用程序。我想使用 SSRS 2005 来生成我需要为此 Web 应用程序构建的各种报告。我想说服团队我们应该采用 SSRS 作为我们拥有的大多数内部和外部 Web 应用程序的主要报告平台。

Reporting Services 的优缺点是什么？我可以看到许多优点，例如与 IIS、SQL Server 和 Visual Studio 的紧密集成、丰富的演示功能和导出功能、订阅等，所以我主要对 SSRS 的缺点感兴趣。

编辑：我知道如果我不使用 VS 2005 进行应用程序开发，我将使用不同的 Visual Studio 版本进行应用程序和报表开发。但是，我对 SSRS 本身的负面（或不太好的方面）更感兴趣。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-03T16:10:29.730

我知道你说的是 2005 年，但我也会在 2008 年左右做笔记。

SRS 优点：
- 它是免费的（前提是您拥有 SQL Server 许可证）
- 与 SQL Server 的紧密数据集成，但它可以处理任何 .NET 可以处理的事情（Oracle、ODBC 等...）。( `2008 has native support for Terradata too`)
- Visual Studio、SharePoint 和 PerformancePoint 的组件都存在以便于利用它。它只是一个网络应用程序，因此集成到任何可以与网络服务器对话的网页或应用程序也很容易。
- 内置的订阅工具（即定期发送给带有报告的人员列表的电子邮件）。收件人列表可以是静态人员或共享点站点或动态人员列表（从数据库中提取）（`08 adds support for dynamic to sharepoint too`）
- 存在第三方供应商以增强产品
- 导出为多种格式（XML、CSV、Excel、PDF 等）
- 能够设计模板，高级用户可以使用这些模板在不知道 SQL 的情况下构建报告（因为模板中包含 SQL）。高级用户使用一种特殊的报告生成器工具，该工具通过单击一次交付。
- 与水晶报表不同的工作方式（我不喜欢水晶，这就是为什么这对我来说是专业的）

SRS 缺点：
- 图表控件看起来像 Excel 2003 并且是有限的。( `2008 has the Dundas controls in by default so they are much more powerful, more varied and better looking`)
- 由于它是一个 Web 应用程序而导致的 Kerberos 问题可能会导致烦人的问题 ( `2008 removes that as it is no longer an IIS web app. It runs it's own web server based off the IIS core but is closer to a stand alone app - so the security issues aren't a problem`)
- 设计器支持是一种痛苦。2000 报表必须在 VS 2003 中开发，2005 报表必须在 VS 2005 中开发，2008 报表必须在 VS 2008 中开发。我所说的 Visual Studio 是指使用 SQL 管理工具获得的普通版本或精简版本。
- 兼容性。每个版本的报告服务只能运行当前版本和一个版本的报告。
- 安全性仅限于集成 Windows 或匿名 ( `2008 has added support for forms based security and for custom providers, like you get with ASP.NET`)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T15:24:29.573

我在您的设置中看到的其中一个缺点是，由于您使用的是 SSRS 2005，因此您必须将 Visual Studio 2005 用于您的报告项目。

由于看起来您正在使用 Visual Studio 2008 进行其他开发，这意味着安装了这两个版本，并且大部分时间都必须同时打开和运行。

我也有同样的情况，这很麻烦，但我已经习惯了。

**编辑：**
我遇到的其他一些缺点通常与设计师有关。它们可能已在 2008 年修复（不确定），但与其他更成熟的报告解决方案相比，我将它们归因于 SSRS 的初期阶段。

*   每次进入数据选项卡时，即使您将它们设置为存储过程，数据集也会更改为文本

*   Web 服务数据集在更改查询时丢失其参数

*   表达式编辑器非常笨拙。它比使用记事本略好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-03T15:43:35.573

缺点：

1.  在 Firefox 或其他浏览器中呈现可能会有所不同。在 ASP.NET 页面上使用 SSRS ReportViewer 时，只需确保在 IE 以外的浏览器上呈现时验证报表的外观/感觉/布局。

2.  一个缺点是，对于 SSRS，开发人员可以使用的选项太多，一开始可能会让人感到困惑。我更多地谈论是否使用本地报告或服务器报告，是否将代码放入代码模块、可重用程序集中或使用可重用托管代码 (C#) 存储过程。

3.  在 SSRS 中我能想到的最大问题是代码模块非常基础。没有智能感知和调试功能。如果 SSRS 脚本支持 C# 而不仅仅是 VB.NET，那就太好了。

4.  虽然表达式很棒，但问题是没有一个容器/位置可以让您查看报告中定义的所有表达式。这可能会成为未来的维护噩梦。

也就是说，SSRS 是经验丰富的开发人员手中的强大工具。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T15:34:06.607

优点：

*   自由
*   可能比大多数其他人更好地绑定到 MS SQL
*   适用于大多数类型的报告

缺点：

*   自由; 支持访问不像水晶
*   没有其他老竞争对手拥有的所有功能。作为一款较新的软件，它仍然具有其他产品（如 Crystal Reports）多年来所拥有的新功能。

我经常以最简单的方式运行报告。最近，我构建了自己的基于 Web 的界面，可以驱动 PDF/HTML/Crystal/SRSS 报告的任意组合并提供它们。通常 Crystal 会分两步完成，或者 SRSS 会做得更好。如果我现在必须选择一个作为所有场景的首选，我可能会选择 Crystal。我使用 SRSS 的次数越多，几年前仍处于积极的功能开发阶段（赶上 Crystal 等产品），我可以看到它被使用得更多……虽然还没有。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T15:26:38.073

我发现 SSRS 非常强大，并提供了非常广泛的功能来满足您的报告需求。我尝试过其他人（水晶）并且几乎不喜欢它。（这可能只是个人口味）。

即使对于初学者，SSRS 也有许多向导可以为您提供所需的结果，对于经验丰富的开发人员，您可以通过钻取、颜色、编码等微调您的报告。

老实说，我对 SSRS 没什么好说的。Dustin 指出的一个缺点是您的 VS 版本和 SQL 版本不同。我有一个在 VS2005 中的应用程序，但使用 SQL 2000 后端，我必须在 VS2003 项目中分开我的报告才能让它们正常工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-03T15:57:47.447

为了更好地提供分析，如果我们更新您正在考虑的替代方案会更容易。例如，如果它是 SSRS 与无，那么参数很简单，同样，SSRS 与定制报告（例如 ASP.NET）。但是，如果您正在考虑其他报告工具，例如 Crystal，那么我们可能会更加挑剔。此外，您正在计划什么样的报告，以及您理想需要哪些功能。

无论如何，我基本上同意其他海报。SSRS 是免费的并且非常有能力。其他系统可能有额外的花里胡哨，但这些问题会很重要，并为成本做好准备吗？

我想，鉴于 SSRS 是免费且易于设置的，我的建议是进行试用；您可能会通过一些实验来下定决心 - 您没有什么可失去的！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-03-11T03:19:49.497

SSRS 使用起来非常简单。我们有实习生在 SSRS 工作的第一天就写报告，并且在工作中做得很好。

对于只想快速完成报告以便回到实际编码的开发人员来说，这种简单性大有帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-03T16:12:30.990

如果我错了，请纠正我，但 SSRS 不使用表单身份验证。对于使用内置组件从 Web 应用程序查看报告，将使用应用程序使用的任何身份验证。但是，对于订阅和使用需要访问报表管理器的 Windows 身份验证的报表生成器应用程序（单击一次）。

[编辑] 来自 Robert MacLean - MSSQL 2008 确实支持表单身份验证，这是一件好事。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-05T10:53:07.590

我遇到的主要问题是在舞台/生产网络环境中设置 Reportserver。我必须将报告从 Reportserver Web 服务中取出到 Web 应用程序中。现在环境看起来很简单，但我记得当时很难调试。

另一个问题是多语言报告。再说一遍：现在它很容易使用，但要准备好做一些谷歌搜索。

设计师很垃圾。谁知道 =First(Fields!Sales.Value,"DataSet1") 是什么意思？我也遇到了报告大小的问题（该报告设计为适合 A4 页面，但最后没有）。

我还是喜欢这个产品。一段时间后，我解决了所有问题，我们的实习生可以设计和发布出色的报告。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-04-09T10:42:10.670

SSRS 2005 Pro 集成到 Sharepoint

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-08-17T13:22:32.620

我只会在这里放一些缺点，因为大多数人已经提到了好处。

SSRS 2008：原始用户界面几乎没有灵活性来做花哨的东西，即华而不实的图表，地理地图（无纬度）

MS 必须认真地重新思考竞争对手在 BI 和数据可视化领域所做的事情。

# c++ - 无论区域设置如何，如何将浮点数转换为字符串？

> ID：507477
> 
> 赞同：2
> 
> 时间：2009-02-03T15:10:04.347
> 
> 标签：c++, mfc, formatting, locale

我的产品面向葡萄牙语观众，其中逗号是十进制符号。我通常使用 CString::Format 将数字输入字符串，它考虑了计算机的区域设置。虽然总的来说这是一个好方法，但我在格式化 SQL 查询时遇到了问题，例如：

```
CString szInsert;
szInsert.Format("INSERT INTO Vertices (X, Y) VALUES (%f, %f)", pt.X, pt.Y); 
```

传递值时，我得到这个字符串，这是一个不正确的查询：

```
INSERT INTO Vertices (X, Y) VALUES (3,56, 4,67) 
```

如何在这些字符串中强制将点作为十进制符号，而不更改区域设置并且不必为每个浮点值创建专门的字符串？

注意：这是一个一般性问题，而不是 SQL 问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-03T15:30:47.267

坏主意，你真的应该使用准备好的语句。仅使用数字进行 SQL 注入并非易事，但 CString::Format 并不是进行参数绑定的正确方法。

（MFC 和 SQL 已经有一段时间了 - 事实证明这是隐藏得很好。我开始看到我们如何以 SQL 注入错误告终，感谢 Microsoft。使用原始 ODBC，您可以使用 SQLPrepare 创建一个语句（一次）。通过？对于要填写的2个参数。随后，对于每个INSERT调用`SQLBindParameter(stmt, 1, &X); SQLBindParameter(stmt, 2, &Y) /*extra parameters omitted, see http://msdn.microsoft.com/en-us/library/ms710963(VS.85).aspx */`。最后，调用SQLExecute来执行操作。）

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-03T15:47:39.403

关于 Pukku 对 ostringstream 的建议的评论：为了使其与语言环境无关，应该明确地 imbue() 具有所需语言环境的流：

```
std::ostringstream s;
s.imbue(std::locale::classic());
s << "INSERT INTO Vertices (X, Y) VALUES (" << pt.X << ", " << pt.Y << ")"; 
```

否则，将使用当前的全局语言环境。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-03T15:35:33.047

参数化查询应该完全避免这个问题。你应该调查那些。也就是说，您应该能够使用[setlocale](http://msdn.microsoft.com/en-us/library/x99tb11d.aspx)或类似的方法来更改小数点分隔符。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-10-06T15:07:26.413

采用

```
_create_locale( LC_NUMERIC, "C" ) 
```

创建一个“英语”（C 默认）语言环境，然后将其传递给 _sprintf_l 函数组之一。

例如

```
_locale_t locale = _create_locale( LC_NUMERIC, "C" );
_sprintf_l( pszValue, "%f", locale, 3.141 );
_free_locale(locale); 
```

这是线程安全的。语言环境可以存储在静态变量中，以避免每次需要格式化值时创建它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-09-29T16:56:42.293

这就是我所做的。

```
CString FormatQuery(LPCTSTR pszFormat, ...)
{
    CString szLocale = setlocale(LC_NUMERIC, NULL);
    setlocale(LC_NUMERIC, "English");

    va_list args;
    va_start(args, pszFormat);
    CString szFormatted;
    int nSize = (_vscprintf(pszFormat, args) + 1) * sizeof(char);
    _vsnprintf_s(szFormatted.GetBuffer(nSize), nSize, nSize, pszFormat, args);
    szFormatted.ReleaseBuffer();
    va_end(args);

    setlocale(LC_NUMERIC, szLocale);
    return szFormatted;
} 
```

你应该像`sprintf`. 你必须`#include <locale.h>`让它工作。

我有点固执，所以我没有使用准备好的语句/参数化查询。如果你有类似的问题，我建议你这样做。同时，如果您的问题与 SQL 无关，我的回答应该会有所帮助。

**编辑：**这是一个线程安全的版本：

```
CString FormatQuery(LPCTSTR pszFormat, ...)
{
    _locale_t locale = _create_locale(LC_NUMERIC, "English");

    va_list args;
    va_start(args, pszFormat);
    CString szFormatted;
    int nSize = (_vscprintf_l(pszFormat, locale, args) + 1) * sizeof(char);
    _vsnprintf_s_l(szFormatted.GetBuffer(nSize), nSize, nSize, pszFormat, locale, args);
    szFormatted.ReleaseBuffer();
    va_end(args);

    return szFormatted;
} 
```

# sql - LINQ 排除

> ID：507478
> 
> 赞同：4
> 
> 时间：2009-02-03T15:10:12.893
> 
> 标签：sql, linq

是否有直接的 LINQ 语法来查找集合 B 中不存在的集合 A 的成员？在 SQL 中我会写这个

```
SELECT A.* FROM A LEFT JOIN B ON A.ID = B.ID WHERE B.ID IS NULL 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-03T15:14:58.690

请参阅有关[except 运算符](https://msdn.microsoft.com/en-us/library/vstudio/bb300779%28v=vs.100%29.aspx)的 MSDN 文档。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-03T15:28:11.830

我相信您的 LINQ 将类似于以下内容。

```
var items = A.Except(
  from itemA in A
  from itemB in B
  where itemA.ID == itemB.ID
  select itemA); 
```

### 更新

正如[马斯洛](https://stackoverflow.com/users/57883/maslow)在评论中所指出的，这可能不是性能最高的查询。与任何代码一样，执行某种级别的分析以消除瓶颈和低效算法非常重要。在这种情况下，[chaowman 的答案](https://stackoverflow.com/questions/507478/linq-exclusion/507605#507605)提供了更好的执行结果。

稍微检查一下查询就可以看出原因。在我提供的示例中，在 A 集合上至少有两个循环 - 1 用于组合 A 和 B 列表，另一个用于执行`Except`操作 - 而在[chaowman 的回答](https://stackoverflow.com/questions/507478/linq-exclusion/507605#507605)中（转载如下），A 集合仅迭代一次.

```
// chaowman's solution only iterates A once and partially iterates B
var results = from itemA in A
              where !B.Any(itemB => itemB.Id == itemA.Id)
              select itemA; 
```

此外，在我的回答中，B 集合对 A 中的每个项目都进行了整体迭代，而在[chaowman 的回答](https://stackoverflow.com/questions/507478/linq-exclusion/507605#507605)中，它只迭代到找到匹配项的点。

如您所见，即使在查看生成的 SQL 之前，您也可以仅从查询本身发现潜在的性能问题。再次感谢[马斯洛](https://stackoverflow.com/users/57883/maslow)强调这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-03T15:42:23.033

```
var results = from itemA in A
              where !B.Any(itemB => itemB.Id == itemA.Id)
              select itemA; 
```

# php - 在 Linux 上从 PHP 连接到 MS SQL Server？

> ID：507479
> 
> 赞同：6
> 
> 时间：2009-02-03T15:10:19.540
> 
> 标签：php, sql-server, linux, apache

我需要从 Linux 服务器上运行的 PHP 脚本连接到 MS SQL Server 数据库。我正在考虑使用 FreeTDS，因为没有适用于 Linux 的官方 MS SQL Server 驱动程序。这是我最好的选择吗？生产环境可以吗？还有其他选择，也许是 ODBC？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T15:30:12.450

是最好的免费选择。我已经将它与 Qt (C++) 一起使用。

您可以将它与 unixODBC 一起使用。

如果你能付钱，你可以使用[easysoft的驱动程序](http://www.easysoft.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T16:24:04.743

我工作的公司在我们的生产服务器上运行 FreeTDS 以连接到 SQL 2000 已经快 6 年了。特殊字符编码存在一些问题，但总体而言效果很好。

# spring - 负载均衡、Spring Security、ConcurrentSessionFilter

> ID：507480
> 
> 赞同：5
> 
> 时间：2009-02-03T15:10:31.037
> 
> 标签：spring, networking

我有一个 Spring 2.5.6/Flex 应用程序设置并使用 Spring Security 2.0.4 运行。最近安装了一个负载均衡器（A Foundry ServerIron 4g [http://www.foundrynet.com/products/a...ems/si-4g.html](http://www.foundrynet.com/products/a...ems/si-4g.html)），现在我遇到了跨域错误。基本上，负载均衡器正在向 myloadbalancer.abc.com 发出请求，并且 myrealserver1.abc.com 作为域名返回。Spring security 以某种方式将请求转发到真实服务器。我怎样才能解决这个问题？

ConcurrentSessionFilter 也不再工作。该应用程序设置为禁用并发登录，但在将应用程序置于负载平衡器后面后，此功能停止。我相信也有多个 Oracle 应用服务器集群在一起。我以前从未处理过集群或负载平衡器，我也不知道在某些领域必须以不同的方式编写软件。

这些对我来说听起来像是不同的问题，但我都需要帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-15T20:04:52.463

关于你的第二个问题：

如果 ConcurrentSessionFilter 停止工作（即不再阻止并发会话），这可能是由于集群应用程序容器具有粘性会话。

在这样的设置中，集群的每个节点都独立工作，不与其他节点共享状态。相反，负载均衡器确保现有会话始终由同一节点提供服务。

现在 Spring Security`ConcurrentSessionController`通过将会话映射到主体来工作。控制器本身依赖于用户会话的开始和终止`HttpSessionEventPublisher`发送 `ApplicationEvents`。

如果打算打开多个会话的人最终在同一个节点上，他已经打开了一个会话，那么一切都会正常工作。`HttpSessionEventPublisher`通知并发会话机制会话的创建和身份验证将失败，因为已经有一个与此用户关联的会话。然而，在不同的节点上，该用户还没有会话，因此`ConcurrentSessionController`不会抱怨并且登录成功。

幸运的是，解决问题应该很容易：实现您自己的`SessionRegistry`并为所有节点（例如应用程序的数据库）使用共享数据存储。

# cvs - cvs2svn mime 类型

> ID：507494
> 
> 赞同：2
> 
> 时间：2009-02-03T15:14:28.363
> 
> 标签：cvs, cvs2svn

为了考虑到 Richard 的评论和 Steen 的回答，我必须独立于类型 mime 文件和独立于 CVS 中标记的类型文件进行指定，我正在寻找如何将所有文件视为 cvs2svn 中的二进制文件？也许是不可能的？

请理查德（或其他人），您能告诉我如何知道 CVS 中给定文件的标记类型吗？

* * *

您好，如何将所有文件视为二进制文件？
（cvs2svn 的）所有 16 次通过都正确完成，但有几个二进制文件已损坏（如 .gif）。没有被视为二进制文件！

我使用的命令行是：

```
python C:\noinstaller\cvs2svn-2.2.0\cvs2svn -s "SVN_REPO" "CVS_REPO" --use-cvs
--encoding=latin1 --mime-types=svn-mime-types --eol-from-mime-type 
--keywords-off --sort=C:\noinstaller\UnxUtils\usr\local\wbin\sort.exe 
```

阅读[CVS2SVN 常见问题解答](http://cvs2svn.tigris.org/faq.html)后，我尝试了许多其他选项，但相同的文件总是损坏。

谢谢。基督教。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T19:06:09.330

Subversion 使用启发式算法来确定文件是否为二进制文件。首先，它检查是否`mime-types-file`设置了配置参数，并使用它来将文件映射到 MIME 类型。如果没有找到这样的配置，它会查看前 1024 个字节，如果超过 15% 不在 ASCII 范围内或其中任何一个为空值，则该文件被视为二进制文件。要专门设置给定文件类型的 MIME 类型，您必须使用[auto props](http://svnbook.red-bean.com/nightly/en/svn.advanced.props.html#svn.advanced.props.auto)。

请注意，如果 subversion 确定您的文件是 mime-type`image/x-xbitmap`或`image/x-xpixmap`，它将被视为文本文件

Auto-props 影响`svn add`和`svn import`操作，并使用[运行时配置](http://svnbook.red-bean.com/nightly/en/svn.advanced.confarea.html)进行设置，这些配置通过命令行选项或在 subversion 的*配置*文件中指定，位于 subversion 安装 conf 目录中。应设置以下值：

```
# default is 'no', so we enable auto props with
enable-auto-props = yes

# specify absolute path to mime.types like file, e.g.
mime-types-file = /etc/mime.types 
```

这应该正确映射您的二进制文件。

编辑：来自[cvs2svn](http://cvs2svn.tigris.org/cvs2svn.html)手册：

> --auto-props=文件
> 
> 以 Subversion 配置文件的格式指定一个文件，其 [auto-props] 部分可用于根据文件名设置 Subversion 存储库中文件的任意属性。（必须存在 [auto-props] 部分标题；配置文件的其他部分，包括 enable-auto-props 设置，将被忽略。）文件名与文件名模式匹配，不区分大小写，与 Subversion 的行为一致。auto-props 文件可能包含如下内容：
> 
> ```
> [auto-props]
> *.txt = svn:mime-type=text/plain;svn:eol-style=native
> *.doc = svn:mime-type=application/msword;!svn:eol-style 
> ```

因此，使用命令行开关`--auto-props`和自动道具文件，您应该能够获得 `cvs2svn`脚本的所需功能

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T13:05:30.697

关于如何让 cvs2svn 将所有文件视为二进制的问题，我只能指向 FAQ 中与[EOL相关的部分](http://cvs2svn.tigris.org/faq.html#eol-fixup)

> 从 2.0 版开始，cvs2svn 的默认行为是将所有文件视为二进制文件，但明确确定为文本的文件除外。

同样来自常见问题解答：

> 如果一个文件在 CVS 中被标记为二进制文件（使用 cvs admin -kb，那么 cvs2svn 将始终将该文件视为二进制文件。

要查看文件是否标记为二进制文件，请在 CVS 中查找文件的 -kb 选项。在 WinCVS 中，有这方面的列以及编码。

不幸的是，我没有适合您的解决方案，但我会尝试简化您的命令参数，以专注于那些不适合这些文件的内容。使用 --auto-props 文件可以让您最终控制每个文件。如果您的 CVS 文件是“干净的”（意味着所有文件都以文本和二进制文件的形式正确提交），那么 --default-style=native 参数应该会给出最好的结果。

祝你好运，让我们知道什么对你有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-13T10:30:42.450

我推断不可能强制 cvs2svn 将所有文件视为二进制文件。

# c# - IEnumerable 康卡特 保持元素的顺序？

> ID：507500
> 
> 赞同：17
> 
> 时间：2009-02-03T15:15:35.270
> 
> 标签：c#, .net, linq

假设两个列表 A 和 B 使得 A = (1,2,3) 和 B = (4,5,6)。A.Concat(B) 是否会保留顺序以使结果为 (1,2,3,4,5,6)？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-03T15:18:09.603

是的。IEnumerable.Concat 将简单地将两个列表变成一个列表，方法是将一个列表附加到另一个列表的末尾。每个列表中的顺序将被保留。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-03T15:19:54.700

是的，这就是串联的意思。

强制性 MSDN 报价：（[Enumerable.Concat](http://msdn.microsoft.com/en-us/library/bb302894.aspx)）

> **返回值**
> 
> 类型： [System.Collections.Generic.IEnumerable](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx) (TSource)
> 
> 一个[IEnumerable(T)](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)，包含两个输入序列的连接元素。

# oracle - Oracle 中的重音和不区分大小写的 COLLATE 等效项

> ID：507504
> 
> 赞同：5
> 
> 时间：2009-02-03T15:17:42.303
> 
> 标签：oracle

在 Microsoft SQL Server 中，如果我想在区分大小写的数据库中不区分大小写搜索，我可以运行以下 SQL：

```
SELECT * FROM MyTable
WHERE MyField = 'BobDillon' COLLATE Latin1_General_CI_AI 
```

这将找到所有“bobdillon”条目。

如果我想在 Oracle 中做同样的事情，我知道我可以这样做：

```
SELECT * FROM MyTable
WHERE UPPER(MyField) = 'BOBDILLON' 
```

但我想知道是否有与 collat​​e 关键字直接等效的，所以我可以搜索我认为合适的区分大小写和重音的。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-03T15:27:27.447

```
SELECT *
FROM MyTable
WHERE NLSSORT(MyField, 'NLS_SORT = Latin_AI') = NLSSORT('BobDillon', 'NLS_SORT = Latin_AI') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-22T11:36:59.810

从此[线程](https://community.oracle.com/thread/1117030?start=0&tstart=0)中，您可以执行以下操作：

```
select * from your_table 
where utl_raw.cast_to_varchar2((nlssort(your_column, 'nls_sort=binary_ai'))) like lower('%word%') 
```

# linq-to-sql - 如何在 LINQ-To-SQL (IDENTITY INSERT) 中手动设置身份字段

> ID：507515
> 
> 赞同：9
> 
> 时间：2009-02-03T15:20:36.367
> 
> 标签：linq-to-sql, insert, identity

我有一个表，通常在插入时，自动键会增加。但是，在某些情况下我们想要设置 ID（就像在 SQL 中使用“IDENTITY INSERT”很容易做到的那样）。

有没有办法用 LINQ to SQL 来完成这个？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T00:35:52.177

看看这里：[http ://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/566e9540-911e-48b4-ac31-f69c0ab9f7fb/](http://social.msdn.microsoft.com/Forums/en-US/linqtosql/thread/566e9540-911e-48b4-ac31-f69c0ab9f7fb/)

最后回复在这里：[http ://forums.asp.net/t/1208607.aspx](http://forums.asp.net/t/1208607.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-06-02T22:19:57.953

如果你想让 IDENTITY 增量总是关闭

编辑模型

```
public class TableName
{

    [Key,DatabaseGenerated(DatabaseGeneratedOption.None)]
    public int ID { get; set; }

...
} 
```

# c# - 在 XP 上使用 C# 和目录服务崩溃

> ID：507519
> 
> 赞同：1
> 
> 时间：2009-02-03T15:21:35.227
> 
> 标签：c#, windows-xp, directoryservices

我正在尝试使用 C# 和目录服务进行一些简单的数据检索，但由于某种原因，它不适用于任何 XP 机器。如果我在 Server 2003 机器上运行我的代码，则没有问题。我花了相当多的时间试图找出我在 XP 上是否需要一些可再分发的东西，或者该功能是否根本不存在，但我找到了对在 XP 下具有类似代码的其他开发人员的参考。如果有人有任何经验或建议可以分享，我将不胜感激。

一个让我崩溃的简单代码片段：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Data;
using System.Windows.Documents;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Media.Imaging;
using System.Windows.Navigation;
using System.Windows.Shapes;
using System.DirectoryServices;

namespace IIS_Site_Query_Tool
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();

            DirectoryEntry W3SVC = new DirectoryEntry("IIS://localhost/w3svc");
            foreach (DirectoryEntry Site in W3SVC.Children)
            {
                //Do some data processing
            }
        }
    }
} 
```

在 XP 下运行它会给我以下错误，HRESULT 为 -2147463168：

```
System.Runtime.InteropServices.COMException was unhandled
  Message="Unknown error (0x80005000)"
  Source="System.DirectoryServices"
  ErrorCode=-2147463168
  StackTrace:
       at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)
       at System.DirectoryServices.DirectoryEntry.Bind()
       at System.DirectoryServices.DirectoryEntry.get_IsContainer()
       at System.DirectoryServices.DirectoryEntries.ChildEnumerator..ctor(DirectoryEntry container)
       at System.DirectoryServices.DirectoryEntries.GetEnumerator()
       ... 
```

谷歌搜索错误中的各种信息让我认为这是一个非常通用的 COM 互操作错误，我现在没有想法。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T15:37:25.180

根据堆栈跟踪和反射器，看起来对[ADsOpenObject](http://msdn.microsoft.com/en-us/library/aa772238(VS.85).aspx)的调用正在返回[E_ADS_BAD_PATHNAME](http://msdn.microsoft.com/en-us/library/aa705940(VS.85).aspx)。此错误表明您提供给 DirectoryEntry 类的路径在当前机器上无效。

如果安装了 IIS，则可能是 IIS 提供程序未正确安装在您的计算机上。

有关详细信息，请参阅此 SO 问题：[ADSI will not connect to IIS from XP Workstation](https://stackoverflow.com/questions/117379/adsi-will-not-connect-to-iis-from-xp-workstation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T16:34:55.110

安装 IIS 修复了它。在编写这个小实用程序之前我没有遇到过 ADSI，所以我没有意识到软件可以安装它们自己的 ADSI 功能块。谢谢您的帮助！

# winforms - 如何在我自己的设计工具中获得 Localizable 属性和支持？

> ID：507520
> 
> 赞同：8
> 
> 时间：2009-02-03T15:21:35.337
> 
> 标签：winforms, localization, internationalization, c#-2.0, windows-forms-designer

### 概述

在另一个问题中，我询问了有关[为某些运行时编译`UserControl`的](https://stackoverflow.com/questions/205138/globalizing-runtime-generated-assemblies). 但是，在我开始部署本地化之前，我需要一种本地化控件的方法。

### 背景

这些控件由我们自己的 WinForms 样式设计器创建（使用 .NET 对设计图面的支持等），并保存为将`CodeCompileUnit`、资源 resx 和用户源合并到一个文件中的二进制格式。这些文件然后在运行时由另一个工具编译成适当的程序集。

为了本地化这些，我们需要告诉设计者和序列化可本地化的属性值将存储在资源中。VisualStudio WinForms 设计器使用名为的扩展属性`Localizable`和用于指定默认区域性的关联属性来执行此操作。如果可能，我们需要在自定义设计器中使用此属性。

### 约束

我们需要我们的独立设计器工具，该工具易于用于非开发人员类型并限制某些操作，因此使用 Visual Studio 的免费版本（即 C# Express）是行不通的（我已经投过它但失败了） ; 因此，我们如何本地化这些 UserControl 的任何解决方案都需要对此进行补偿。

### 问题

我们可以在我们的自定义 WinForms 设计器中获得 Localizable 支持吗？

*   如果是，如何？
*   如果不是，有什么替代方法可以本地化我们`UserControl`的 's？例如以某种方式进行后处理，不同的文件格式等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-08-03T09:32:52.113

我不确定我是否正确理解了您的问题。

如果您的控件是可本地化的，只需检查所有要（反）序列化的属性上的[System.ComponentModel.LocalizableAttribute 。](http://msdn.microsoft.com/en-us/library/system.componentmodel.localizableattribute.aspx)

```
// Gets the attributes for the property.
AttributeCollection attributes = 
TypeDescriptor.GetProperties(this)["MyProperty"].Attributes;

// Checks to see if the property needs to be localized.
LocalizableAttribute myAttribute = 
(LocalizableAttribute)attributes[typeof(LocalizableAttribute)];
if(myAttribute.IsLocalizable) {
// Insert code for handling resource files here.
} 
```

由于您决定编写自己的设计师，因此您必须自己做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-08-09T00:21:52.650

您需要将[System.ComponentModel.Design.LocalizationExtenderProvider](http://msdn.microsoft.com/en-us/library/system.componentmodel.design.localizationextenderprovider.aspx)添加到您的设计图面。

# java - Java - 捕获 System.err.println 或捕获 PrintStream

> ID：507522
> 
> 赞同：12
> 
> 时间：2009-02-03T15:22:12.370
> 
> 标签：java, io, stream

Java新手问题：

我需要捕获由第 3 方组件写入 printStream 的文本。

PrintStream 默认为 System.err，但可以更改为另一个 PrintStream。

浏览文档，我找不到将 PrintStream 的内容定向到字符串写入器/缓冲区的简单方法。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-03T15:29:23.480

```
PipedOutputStream pipeOut = new PipedOutputStream();
PipedInputStream pipeIn = new PipedInputStream(pipeOut);
System.setOut(new PrintStream(pipeOut));
// now read from pipeIn 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-03T15:30:23.523

```
import java.io.*;

public class Test {
    public static void main(String[] args) {
        FileOutputStream fos = null;
        try {
            fos = new FileOutputStream("errors.txt");
        } catch(IOException ioe) {
            System.err.println("redirection not possible: "+ioe);
            System.exit(-1);
        }
        PrintStream ps = new PrintStream(fos);
        System.setErr(ps);
        System.err.println("goes into file");
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-03T15:29:46.660

您可以围绕任何其他 OutputStream 创建一个 PrintStream。

创建一个进入内存缓冲区的最简单方法是：

```
PrintStream p = new PrintStream( new ByteArrayOutputStream() ) 
```

然后你可以在你喜欢的任何点读取和重置字节数组的内容。

另一种可能性是使用管道。

```
InputStream third_party_output = new PipedInputStream();
PrintStream p = new PrintStream( new PipedOutputStream( third_party_output ) ); 
```

然后，您可以从 third_party_output 流中读取以获取库写入的文本。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-03T15:30:08.673

你在寻找这样的东西吗？

```
 OutputStream redirect = System.err;
    PrintStream myPrintStream = new PrintStream(redirect);
    myPrintStream.println("hello redirect"); 
```

如果您可以传递`myPrintStream`给第 3 方应用程序，则可以将其重定向到您想要的任何位置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-03T17:57:00.513

我使用以下类将 System.out 和 System.err 记录到一组旋转文件（其中 xxx-001.log 是最新的）。它包含一些对实用程序方法的调用，您需要在它编译之前实现它们——它们应该是不言自明的。

```
import java.io.*;
import java.lang.reflect.*;

public class LoggerOutputStream
extends OutputStream
{

// *****************************************************************************
// INSTANCE PROPERTIES
// *****************************************************************************

private FileOutputStream                log=null;                               // the base output stream
private String                          fnmBase,fnmExt;                         // filename base, file extension
private int                             fnmCount,fnmLast;                       // count for filename index, last filename used
private int                             logSize,totWritten;                     // max log size, current number of bytes written

// *****************************************************************************
// INSTANCE CONSTRUCTORS/INIT/CLOSE/FINALIZE
// *****************************************************************************

public LoggerOutputStream(String baseFilename) throws IOException {
    this(baseFilename,".log",2,1024000);
    }

public LoggerOutputStream(String baseFilename, String extension) throws IOException {
    this(baseFilename,extension,2,1024000);
    }

public LoggerOutputStream(String baseFilename, String extension, int numberOfFiles, int maxFileSize) throws IOException {
    fnmBase=baseFilename;
    if(Character.isLetterOrDigit(fnmBase.charAt(fnmBase.length()-1))) { fnmBase=(fnmBase+"-"); }
    fnmExt=extension;
    if(!fnmExt.startsWith(".")) { fnmExt=('.'+fnmExt); }
    fnmCount=numberOfFiles;
    logSize=maxFileSize;
    if(fnmCount>MAXLOGS) { fnmCount=MAXLOGS; }

    fnmLast=0;
    for(int xa=1; xa<=MAXLOGS; xa++) {
        if(!new File(constructFilename(xa)).exists()) {
            while((--xa)>fnmCount) { IoUtil.deleteFile(constructFilename(xa)); }
            fnmLast=xa;
            break;
            }
        }
    log=null;

    openFile(false);

    if(numberOfFiles>MAXLOGS) { System.out.println("** Log File Count Limited To "+MAXLOGS); }
    }

public void close() throws IOException {
    close(false);
    }

private void openFile(boolean ovrflw) throws IOException {
    close(true);

    if     (fnmLast< fnmCount) { fnmLast++;                                      }
    else if(fnmLast==fnmCount) { IoUtil.deleteFile(constructFilename(fnmCount)); }
    for(int xa=fnmLast; xa>0; xa--) { IoUtil.renameFile(constructFilename(xa-1),constructFilename(xa)); }
    log=new FileOutputStream(constructFilename(1));
    totWritten=0;
    }

private String constructFilename(int index) {
    return constructFilename(fnmBase,index,fnmExt);
    }

private synchronized void close(boolean ovrflw) throws IOException {
    if(log!=null) {
        log.flush();
        log.close();
        log=null;
        }
    }

// *****************************************************************************
// INSTANCE METHODS - ACCESSORS
// *****************************************************************************

public String getFilename() {
    return constructFilename(1);
    }

public String getFilename(int idx) {
    return constructFilename(idx);
    }

public synchronized void cycleLogFile() throws IOException {
    openFile(true);
    }

// *****************************************************************************
// INSTANCE METHODS
// *****************************************************************************

public synchronized void flush() throws IOException {
    if(log!=null) {
        log.flush();
        }
    }

public synchronized void write(int val) throws IOException {
    if(log!=null) {
        log.write(val);
        totWritten++;
        if(val=='\n') {
            if(totWritten>logSize) { openFile(true); }
            else                   { log.flush();    }
            }
        }
    }

public synchronized void write(byte[] bytes) throws IOException {
    if(log!=null) {
        log.write(bytes);
        totWritten+=bytes.length;
        if(bytes.length>0 && bytes[bytes.length-1]=='\n') {
            if(totWritten>logSize) { openFile(true); }
            else                   { log.flush();    }
            }
        }
    }

public synchronized void write(byte[] bytes, int str, int len) throws IOException {
    if(log!=null) {
        log.write(bytes,str,len);
        totWritten+=len;
        if(bytes.length>(str+len-1) && bytes[str+len-1]=='\n') {
            if(totWritten>logSize) { openFile(true); }
            else                   { log.flush();    }
            }
        }
    }

// *****************************************************************************
// STATIC PROPERTIES
// *****************************************************************************

static public final int                 MAXLOGS=999;                            // maximum log files allowed

// *****************************************************************************
// STATIC METHODS
// *****************************************************************************

static public String constructFilename(String bas, int idx, String ext) {
    if(!bas.endsWith("-") && !bas.endsWith("_") && !bas.endsWith(".")) { bas=(bas+"-"); }
    if(!ext.startsWith(".")                                          ) { ext=('.'+ext); }
    return (bas+TextUtil.raZeros(idx,3)+ext);
    }

} /* END PUBLIC CLASS */ 
```

# html - CSS：当使用 float:left 将我的内容固定在左侧的菜单上时，菜单在 IE 中消失

> ID：507526
> 
> 赞同：1
> 
> 时间：2009-02-03T15:23:13.163
> 
> 标签：html, css, internet-explorer

我在左侧有一个链接菜单，在中间有一个内容。如果内容比链接长，它将包裹在它们下方，而不是整齐地保持在右侧。

添加`float:left`到我的`content`div 可以解决这个问题，除了在 IE 中，它会导致菜单（和页脚）完全消失。

我需要解决问题`float:left`，或者找到另一种方法将我的所有内容保留在菜单的右侧。

这是 html 和 css 代码的精简版本，它显示了实际存在的问题。替换为`#content { float:left; }`以`#content {}`查看原始包装问题。

`content {margin:200px;}`几乎解决了这个问题——但是以前会被包裹的行现在比它们上面的行左约 3 个像素，同样仅在 IE 中。

html:

```
<HTML><HEAD>
<TITLE>Index</TITLE>
<LINK rel="stylesheet" type="text/css" href="style.css">
</HEAD>
<BODY>
    <DIV id="main">
        <DIV id="nav">
            <A href="link1.html">Link 1</A>
            <A href="link2.html">Link 2</A>
        </DIV>
        <DIV id="content">
            Content<br>
            goes<br>
            here<br>
            and<br>
            sometimes<br>
            wraps<br>
            under<br>
            links
        </DIV>
        <DIV id="footer">
            Footer<BR>
        </DIV>
    </DIV>
</BODY>
</HTML> 
```

CSS：

```
* {
    padding: 0;
    margin: 0;
    text-decoration:none;
    font-family: Arial, Helvetica, sans-serif;
    font-size: 13px;
    color: #fff;
}

img { border:0px; } 
body { background-color:#454547; padding: 4px; }
#main { position: relative; top: 20px; }
#nav {
    position: relative;
    left: 0px;
    width: 200px;
    float: left;
    font-weight: bold;
    padding: .25em;
    line-height: 1.25em;
    font-size: 1em;
}
#nav a { display: block; height: 35px; padding: 3px; color:#FFFFFF; }
#nav a:hover { background-color:#CCCCCC; color:#333; }
#footer { width: 100%; clear: both; margin: 0px 0px 10px 0px; padding: 10px; font-size:10px; }
#content { float:left; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T15:49:39.413

> 找到另一种将我的所有内容保留在菜单右侧的方法。

```
#content { margin-left: 200px; } 
```

考虑添加一个标准模式文档类型来减少 IE 的古怪。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T15:34:57.807

好的，如果您对我之前的回答不满意，我会一步一步地完成它......

HTML/CSS 有很多你可以做错的事情，但也有一些事情你可以做对，如果你做对了，你将不必担心你做错的事情。所以最好学习一些你能做对的事情，这就是我告诉你阅读其他问题/答案的原因。

我可以告诉你在你的#main div 中删除“position:relative”行，你会发现问题已经消失了……但我不会，因为你一般不会改进你的 CSS。

**首先**，使用 DOCTYPES。只要有可能，请像这样使用严格：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
```

如果您认为您不能应用严格，请使用过渡性，但请注意您已经再次打开可能出现的问题的范围。

**第二**：不要将边距应用于包含您的内容的 div 标签。instaed 在内容标签周围创建一个 div 标签并在那里应用边距！您可以在容器上使用填充但没有边距。

**第三**：在样式表的开头使用一堆重置，有很多可用的，一个很好的设置（带有雅虎的 yui 包），我用于许多具有严格 xhtml 的网站，如下所示：

```
@charset "utf-8";
/*
 Copyright (c) 2008, Yahoo! Inc. All rights reserved.
 Code licensed under the BSD License:
 http://developer.yahoo.net/yui/license.txt
 version: 2.6.0
 Adapted by Markus Hausammann
 */
/* reset rules */ * {
    font-size: 100.01%;
    overflow: hidden
}

html, body
{
    color: #313131;
    background-color: #ffffff;
    font-family: Geneva, Arial, Verdana, Helvetica, sans-serif;
    line-height: 1.2em;
}

body, div, dl, dt, dd, ul, ol, li, h1, h2, h3, h4, h5, h6, pre, code, form, fieldset, legend, input, textarea, p, blockquote, th, td {
    margin: 0;
    padding: 0;
}

table {
    border-collapse: collapse;
    border-spacing: 0;
}

fieldset, img {
    border: 0;
}

address, caption, cite, code, dfn, em, strong, th, var {
    font-style: normal;
    font-weight: normal;
}

li {
    list-style: none;
}

caption, th {
    text-align: left;
}

h1, h2, h3, h4, h5, h6 {
    font-size: 100%;
    font-weight: normal;
}

q:before, q:after {
    content: '';
}

abbr, acronym {
    border: 0;
    font-variant: normal;
}

/* to preserve line-height and selector appearance */
sup {
    vertical-align: text-top;
}

sub {
    vertical-align: text-bottom;
}

input, textarea, select {
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
}

/*because legend doesn't inherit in IE */
legend {
    color: #000;
}

del, ins {
    text-decoration: none;
}

/* clearing methods */
/* clearfix method for clearing floats */ .clearfix:after {
    content: ".";
    display: block;
    height: 0;
    clear: both;
    visibility: hidden;
}

/* essential for Safari browser !! */ .clearfix {
    display: block;
}

/* removes ugly mozilla dotted link borders */
a:active
{
  outline: none;
} 
```

**第四**：不要将多个 div 浮动到同一方向，以避免一些 IE 问题。如果您需要两个以上的 div，请创建包装器 div。因此，例如对于三列布局，您会将第一列向左浮动，然后是带有 float:right 的包装器 div，其中包含向左浮动的第二列（在包装器内），第三列在包装器内向右浮动......等等。但非常可控！

* * *

以前的答案：

为所有 div 指定宽度（分别为 maxwidth），将菜单向左浮动，内容向右浮动。所有问题都解决了。也适用于百分比宽度。

或者

给你的主 div 属性内联和你的菜单 div 一个固定的宽度。

或者

使用网格（例如[http://developer.yahoo.com/yui/grids/](http://developer.yahoo.com/yui/grids/)或[http://www.blueprintcss.org/](http://www.blueprintcss.org/)）

或者

在 stackoverflow 上阅读有关此主题的许多其他帖子（见右侧）。

# c# - 在 c# 中使用十进制值作为属性参数？

> ID：507528
> 
> 赞同：86
> 
> 时间：2009-02-03T15:23:19.747
> 
> 标签：c#, parameters, attributes, decimal

我一直在尝试使用十进制值作为字段属性的参数，但出现编译器错误。

我发现这个博客文章[链接](http://salamakha.com/blog/2007/09/21/decimal-in-c-attributes/)说当时无法在.NET中使用，有人知道他们为什么选择这个或者我如何使用十进制参数吗？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-02-03T15:26:57.760

这是 CLR 限制。只有原始常量或原始数组可以用作属性参数。原因是属性必须完全编码在元数据中。这与在 IL 中编码的方法体不同。使用 MetaData 只会严重限制可以使用的值的范围。在当前版本的 CLR 中，元数据值仅限于基元、null、类型和基元数组（可能遗漏了一个次要的）。

小数，而基本类型不是原始类型，因此不能在元数据中表示，这会阻止它成为属性参数。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2010-04-23T14:18:37.410

我也有同样的问题。我考虑使用**字符串**。这不是类型安全的，但它是可读的，我认为我们将能够在字符串中写入有效数字:-)。

```
class BlahAttribute : Attribute
{
  private decimal value;

  BlahAttribute(string number)
  {
    value = decimal.Parse(number, CultureInfo.InvariantCulture);
  }
}

[Blah("10.23")]
class Foo {} 
```

算不上美颜，不过考虑了所有的选择，还是够用了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-07-23T16:49:55.950

当我遇到这种情况时，我最终将属性上的属性公开为双精度，但在属性内部将它们视为十进制。远非完美，但对于简单的情况，它可能正是您所需要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T12:35:35.170

对于具有属性的实时技巧，我正在使用[TypeConverter](http://www.codeguru.com/columns/vb/article.php/c6529)类。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-23T16:52:36.663

您可以使用以下构造函数。当 C# 代码中有十进制文字时，C# 编译器会发出对此构造函数的调用。

[`Decimal(Int32, Int32, Int32, Boolean, Byte)`](http://msdn.microsoft.com/en-us/library/bb1c1a6x.aspx)

编辑：我知道这不方便。

# silverlight - Silverlight 项目控件。您可以通过模板完全删除面板吗？

> ID：507535
> 
> 赞同：2
> 
> 时间：2009-02-03T15:27:07.493
> 
> 标签：silverlight, data-binding, templates, itemscontrol

我的 ItemsControl 有一个 DataTamplate，它只包含一个带有其他元数据的图像。我想要做的是绑定到 ItemsControl 并让图像与通过我提供的数据绑定的 Convas.Left 和 Canvas.Top 一起显示。

我一直在尽力通过 ItemsPanelTemplate 从控件中删除任何面板，因此我可以使用父画布中的附加属性，但似乎默认情况下您总是会得到一个 StackPanel。

有人有什么好主意吗？

谢谢，戴夫

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T09:42:03.993

ItemsControl 中项目的布局通过 ItemsControl.ItemsPanel 属性进行控制，该属性的类型为 ItemsPanelTemplate。ItemsControl.ItemsPanel 属性的默认值确实是 ItemsPanelTemplate 的一个实例，它指定了一个 StackPanel，但这是完全可定制的。

代码示例（[在此 MSDN 页面上](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol(VS.95).aspx)）显示在“以下示例创建一个 ItemsControl”的段落下方。对于理解 ItemsControl.Template、ItemsControl.ItemsPanel 和 ItemsControl.ItemTemplate 属性的用途非常有用。

有几种方法可以实现您在问题第一段第二句中描述的内容。这是一个完整的例子：

页面.xaml：

```
<UserControl x:Class="ItemsControlImages.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:app="clr-namespace:ItemsControlImages">

    <UserControl.Resources>
        <DataTemplate x:Key="CountryTemplate">
            <Canvas>
                <Image Canvas.Top="{Binding Location.Y}"
                       Canvas.Left="{Binding Location.X}"
                       Source="{Binding FlagImage}" />

                <StackPanel Canvas.Top="{Binding Location.Y}"
                            Canvas.Left="{Binding Location.X}">
                    <TextBlock Text="{Binding Title}" />
                    <TextBlock Text="{Binding Location}" />

                    <StackPanel.RenderTransform>
                        <TranslateTransform Y="-32.0" />
                    </StackPanel.RenderTransform>
                </StackPanel>
            </Canvas>
        </DataTemplate>
    </UserControl.Resources>

    <Canvas x:Name="LayoutRoot">
        <Canvas.Background>
            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                <GradientStop Color="#FFB2C6D5"/>
                <GradientStop Color="#FF1483D9" Offset="1"/>
            </LinearGradientBrush>
        </Canvas.Background>

        <ItemsControl ItemTemplate="{StaticResource CountryTemplate}">
            <app:Country Title="Argentina" Location="56,218" FlagImage="Images/ARG.png" />
            <app:Country Title="China" Location="368,66" FlagImage="Images/CHN.png" />
            <app:Country Title="Ireland" Location="192,90" FlagImage="Images/IRE.png" />
            <app:Country Title="New Zealand" Location="404,225" FlagImage="Images/NZ.png" />
            <app:Country Title="United States" Location="40,80" FlagImage="Images/USA.png" />
        </ItemsControl>
    </Canvas>
</UserControl> 
```

国家.cs：

```
using System.ComponentModel;
using System.Windows;

namespace ItemsControlImages
{
    public class Country : INotifyPropertyChanged
    {
        private string title;
        private string flagImage;
        private Point location;

        public string Title
        {
            get
            {
                return this.title;
            }
            set
            {
                if ((object.ReferenceEquals(this.title, value) != true))
                {
                    this.title = value;
                    this.RaisePropertyChanged("Title");
                }
            }
        }

        public string FlagImage
        {
            get
            {
                return this.flagImage;
            }
            set
            {
                if ((object.ReferenceEquals(this.flagImage, value) != true))
                {
                    this.flagImage = value;
                    this.RaisePropertyChanged("FlagImage");
                }
            }
        }

        public Point Location
        {
            get
            {
                return this.location;
            }
            set
            {
                if ((this.location.Equals(value) != true))
                {
                    this.location = value;
                    this.RaisePropertyChanged("Location");
                }
            }
        }

        #region INotifyPropertyChanged Members

        public event PropertyChangedEventHandler PropertyChanged;

        protected void RaisePropertyChanged(string propertyName)
        {
            PropertyChangedEventHandler propertyChanged = this.PropertyChanged;

            if (propertyChanged != null)
            {
                propertyChanged(this, new PropertyChangedEventArgs(propertyName));
            }
        }

        #endregion
    }
} 
```

这就是最终结果所需要的（以及图像文件夹中的图像）：

[替代文字 http://www.freeimagehosting.net/uploads/bec683b75e.png](http://www.freeimagehosting.net/uploads/bec683b75e.png)

请注意，即使图像位于 ItemsControl 中，它们也会定位在通过将其父 Canvas 的 Left 和 Top 附加属性绑定到自定义 Location 属性的 X 和 Y 坐标值来显示的坐标处。

有关此示例和使用模板自定义 ItemsControl 的更多信息，您可以查看[此博客文章](http://petermcg.wordpress.com/customizing-the-silverlight-2-itemscontrol-with-templates/)。

# asp.net-mvc - 从 ActionFilter 返回视图

> ID：507536
> 
> 赞同：23
> 
> 时间：2009-02-03T15:27:08.150
> 
> 标签：asp.net-mvc

我有一个 ActionFilter 来检查 URL 中的参数是否有效。如果它无效，我必须渲染一个视图。我不想重定向，因为我仍然需要 ActionExecutingContext。可以这样做吗？

```
 public override void  OnActionExecuting(ActionExecutingContext filterContext)
    {
        Guid processIdentifier = (Guid)filterContext.RouteData.Values["processIdentifier"];
        //if processIdentifier  not found render a view with message and some other objects in ViewData
        filterContext.Controller.ViewData.ModelState.AddModelError("WrongProcessIdentifier", "The process-id you supplied is not valid");
        base.OnActionExecuting(filterContext);
    } 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-02-03T16:26:35.423

`HandleErrorAttribute`有我要找的东西。

```
filterContext.Result = new ViewResult
            {
                ViewName = "MessagePage",
                ViewData = filterContext.Controller.ViewData,
                TempData = filterContext.Controller.TempData
            }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T15:29:57.113

是的。查看 HandleErrorAttribute 的来源。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T15:40:43.253

试试这个

```
[HandleError]
public ActionResult MyAction (int id)
{
    // ...
} 
```

并将您想要渲染的视图放入`~/Views/Shared/Error.ascx`.

# javascript - 将一段 javascript 附加到 DOM 在生产中失败 - 但在开发中没有

> ID：507541
> 
> 赞同：2
> 
> 时间：2009-02-03T15:27:57.367
> 
> 标签：javascript, jquery, code-injection

我有一个 ASP.NET 网站。非常巨大！

我所做的最新添加，一切都启用了 JavaScript/AJAX。

我将 HTML 和 JavaScript 代码从服务器发送回客户端，客户端会将 HTML 注入 DIV - 并使用以下命令将 JavaScript 注入 DOM：

```
$('<script type="text/javascript">' + script + '</sc' + 'ript>').appendTo(document); 
```

或这个：

```
var js = document.createElement("script");
js.setAttribute("type", "text/javascript");
js.text = script;
document.appendChild(js); 
```

在我自己的开发机器上，可以访问注入的 javascript，并且我能够执行注入的 JavaScript 函数。

当我部署到我的测试环境时，）我们有一个内部域名，例如 www.testenv.com）我收到 JavaScript 错误。

我试图将问题隔离到一个小页面中，在其中注入 alert("sfdfdf"); 在页面的底部，这工作正常。

是否有任何政策设置禁止这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-03T15:45:49.953

不要将Child 附加到“文档”；<script> 不能去那里，你应该根据 DOM Level 1 Core 规范得到一个 HIERARCHY_REQUEST_ERR DOMException。可以进入 Document 对象的子列表的唯一元素是单个根 documentElement，<html>。

而是将脚本附加到文档内的元素，例如 <body>。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T15:41:33.033

动态创建元素应该可以正常工作，脚本将在插入 DOM 时执行。为了具体回答您的问题，没有禁止脚本注入的直接策略设置，但是，如果您在动态插入的脚本中使用 ajax 调用，您可能会遇到跨域限制。

如果您可以发布错误，也许您插入的“脚本”元素的来源将有助于调试问题:)

# zend-framework - 在 Zend_Db_Table_Row 中使用关系进行设置

> ID：507554
> 
> 赞同：1
> 
> 时间：2009-02-03T15:30:23.900
> 
> 标签：zend-framework, orm, zend-db-table

有没有办法使用 Zend_Db 关系来设置相关对象？我正在寻找类似以下代码的内容：

```
$contentModel = new Content();          
$categoryModel = new Category();

$category = $categoryModel->createRow();
$category->setName('Name Category 4');

$content = $contentModel->createRow();
$content->setTitle('Title 4');

$content->setCategory($category);
$content->save(); 
```

这提供了小型库： [http ://code.google.com/p/zend-framework-orm/](http://code.google.com/p/zend-framework-orm/)

有人有这方面的经验吗？ZF 没有类似的计划吗？或者有什么更好的用处？（我不想使用教义 ORM 或外部的东西）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-12-27T00:29:40.397

我在 Zend Framework 中设计并实现了表关系代码。

外键（`$content->category`在您的示例中）包含它引用的父行中的主键的值。在您的示例中，`$category`尚未包含主键值，因为您尚未保存它（假设它使用自动递增的伪键）。`$content`在填充其外键之前，您无法保存该行，因此满足参照完整性：

```
$contentModel = new Content();                  
$categoryModel = new Category();

$category = $categoryModel->createRow();
$category->setName('Name Category 4');

$content = $contentModel->createRow();
$content->setTitle('Title 4');

// saving populates the primary key field in the Row object
$category->save();

$content->setCategory($category->category_id);
$content->save(); 
```

`setCategory()`如果没有填充主键 ，则将Row 对象传递给它是没有用的。`$content->save()`如果它没有要引用的有效主键值，则会失败。

由于您在任何情况下都需要填充该主键字段，因此在调用时访问该字段并不难`setCategory()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T15:40:25.377

我总是覆盖 Zend_Db_Table 和 Zend_Db_Table_Row 并使用我自己的子类。在我的 Db_Table 类中，我有：

```
protected $_rowClass = 'Db_Table_Row'; 
```

在我的 Db_Table_Row 中，我有以下 __get() 和 __set() 函数：

```
public function __get($key)
{
    $inflector = new Zend_Filter_Word_UnderscoreToCamelCase();

    $method = 'get' . $inflector->filter($key);

    if(method_exists($this, $method)) {
        return $this->{$method}();
    }

    return parent::__get($key);
}

public function __set($key, $value)
{
    $inflector = new Zend_Filter_Word_UnderscoreToCamelCase();

    $method = 'set' . $inflector->filter($key);

    if(method_exists($this, $method))
        return $this->{$method}($value);

    return parent::__set($key, $value);
} 
```

基本上，这只是告诉类寻找名为 getFoo() 和 setFoo() 的方法或其他方法。然后，只要您在后面编写自己的逻辑，您几乎可以组成自己的字段。在你的情况下，也许：

```
public function setCategory($value)
{
     $this->category_id = $value->category_id;
} 
```

# java - Spring 对 JDBC 操作来说太复杂了吗？

> ID：507556
> 
> 赞同：3
> 
> 时间：2009-02-03T15:30:32.400
> 
> 标签：java, spring, jdbc

刚刚查看了 JDBC 的 Spring 框架 - 看起来有一点学习曲线 - 我仍然无法找到任何质量的最新快速入门 Spring/JDBC 教程！

对于基本的 JDBC 操作，有没有比 Spring 更轻的东西 - 或者有没有人有任何好的教程链接

非常感谢

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-03T15:42:30.613

恰恰相反。Spring 中的 JDBC 支持非常简单。这是基本示例：

```
dataSource = ... obtain data source... (e.g. via Spring config)
SimpleJdbcTemplate jdbcTemplate = new SimpleJdbcTemplate(dataSource);
Map<String, Object> row = jdbcTemplate.queryForMap(
        "SELECT * FROM MyTable WHERE ID=? LIMIT 1", 100); 
```

JdbcTemplate 和 SimpleJdbcTemplate 有很多你可能会发现有用的查询方法。要将行映射到您的对象，请查看 RowMapper 和 ParameterizedRowMapper < T >。

对于您的数据源，您通常希望使用一些具有池支持的高级数据源。对于测试，简单的 BasicDataSource 将执行以下操作：

```
BasicDataSource ds = new BasicDataSource();
ds.setDriverClassName("driverClassName");
ds.setUrl("jdbc://...");
ds.setUsername("username");
ds.setPassword("password"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-03T15:47:45.020

查看[http://static.springframework.org/spring/docs/2.5.x/reference/jdbc.html](http://static.springframework.org/spring/docs/2.5.x/reference/jdbc.html)以选择一种风格（完全“自动”Spring 与程序员完​​成的大部分工作）并了解上的基本操作`JdbcTemplate`。

该网站有很好的例子，比如

```
int countOfActorsNamedJoe =
    this.jdbcTemplate.queryForInt(
        "select count(0) from t_actors where first_name = ?",
        new Object[]{"Joe"}); 
```

无论如何，您*将*需要投入一些时间。无论您将使用哪个 Spring JDBC 教程，它仍然是下面的 Spring JDBC。在这种情况下，从源代码中学习并没有什么坏处，即 Spring 文档，它们写得很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-03T15:32:50.710

是的，它有 JdbcTemplate 。

[http://www.techfaq360.com/tutorial/spring/JdbcTemplate.jsp](http://www.techfaq360.com/tutorial/spring/JdbcTemplate.jsp)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T15:45:34.180

Spring 文档非常好。

如果这对 Spring in Action 等各种 Spring 书籍没有帮助的话，那就太好了。

Spring 值得学习——你可以摆脱大量的样板 JDBC 代码。它在连接管理方面做得非常好 - 与 DBCP 一起

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T18:11:51.280

Spring JDBC 在 1.0 版中表现不错，但他们在 2.5 版中对其进行了相当多的重构，使其更加简单。查看 JdbcTemplate 和 org.springframework.jdbc.core.simple 包中的类。它们是 Spring 2.5 的新内容，因此您不会在旧书中找到它们。最好在线查看参考文档。

# php - PHP 注册电子邮件验证登录脚本/类

> ID：507559
> 
> 赞同：0
> 
> 时间：2009-02-03T15:30:41.293
> 
> 标签：php, registration

我正在寻找一个不错的 PHP 脚本或类库来处理用户注册/注册、电子邮件验证和网站登录。我以前写过这种东西，但我宁愿使用更经过测试和更健壮的东西。到目前为止，我遇到的少数开源产品在我看来并不是很好。我也看过[RPX](https://rpxnow.com/)，但根据我的需要，有趣的可能是矫枉过正。在这一点上，我认为我不需要可能包含这样一个设施的完整 CMS。

任何指针或建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T23:17:19.977

我用于我的私人项目 Picora ( [http://picora.org/](http://picora.org/) )。对于更专业的工作，您可以使用 ZEND-Framework ( [http://framework.zend.com/](http://framework.zend.com/) ) 组件来处理这类事情。这个框架与核心的耦合松散，可以很容易地单独使用。

# c++ - 将资源文件添加到 VC6 dll

> ID：507560
> 
> 赞同：2
> 
> 时间：2009-02-03T15:30:41.730
> 
> 标签：c++, version-control, visual-c++, visual-c++-6

我有许多 VC 6.0 项目 (dsps)，它们构建到没有资源文件的 dll 中。知道如何将资源添加到现有项目中吗？

该项目即将发布一个主要版本，我想为当前缺少的那些 dll 添加一个文件版本。dll 将在发布之前重新编译，所以我只是想让这些 dsps 像我在这个项目中继承的所有其他 dsps（确实有一个文件和产品版本等，以便我们可以轻松地准确地知道什么在运行客户的机器。

一个答案：创建一个 *.rc 和 resource.h 文件（从另一个项目复制？）并将其添加到 VC6 文件视图中 ypur 项目的源文件夹中。资源视图是自动创建的。谢谢你们的帮助，给了我需要的指点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T17:29:56.700

只需在 DLL 的资源文件中添加一个 VERSIONINFO 块。

打开 .rc 文件，然后使用“Insert/Resource.../Version”，您将获得一个带有一堆默认值的新 VERSIONINFO 资源。如果项目还没有资源文件，您可以使用“文件/新建.../资源脚本”添加一个。

如果你想自己动手，可以在[MSDN 页面上为 VERSIONINFO](http://msdn.microsoft.com/en-us/library/aa381058.aspx)`VERSIONINFO`提供一个示例块：

```
#define VER_FILEVERSION             3,10,349,0
#define VER_FILEVERSION_STR         "3.10.349.0\0"

#define VER_PRODUCTVERSION          3,10,0,0
#define VER_PRODUCTVERSION_STR      "3.10\0"

#ifndef DEBUG
#define VER_DEBUG                   0
#else
#define VER_DEBUG                   VS_FF_DEBUG
#endif

VS_VERSION_INFO VERSIONINFO
FILEVERSION     VER_FILEVERSION
PRODUCTVERSION  VER_PRODUCTVERSION
FILEFLAGSMASK   VS_FFI_FILEFLAGSMASK
FILEFLAGS       (VER_PRIVATEBUILD|VER_PRERELEASE|VER_DEBUG)
FILEOS          VOS__WINDOWS32
FILETYPE        VFT_DLL
FILESUBTYPE     VFT2_UNKNOWN
BEGIN
    BLOCK "StringFileInfo"
    BEGIN
        BLOCK "040904E4"
        BEGIN
            VALUE "CompanyName",      VER_COMPANYNAME_STR
            VALUE "FileDescription",  VER_FILEDESCRIPTION_STR
            VALUE "FileVersion",      VER_FILEVERSION_STR
            VALUE "InternalName",     VER_INTERNALNAME_STR
            VALUE "LegalCopyright",   VER_LEGALCOPYRIGHT_STR
            VALUE "LegalTrademarks1", VER_LEGALTRADEMARKS1_STR
            VALUE "LegalTrademarks2", VER_LEGALTRADEMARKS2_STR
            VALUE "OriginalFilename", VER_ORIGINALFILENAME_STR
            VALUE "ProductName",      VER_PRODUCTNAME_STR
            VALUE "ProductVersion",   VER_PRODUCTVERSION_STR
        END
    END

    BLOCK "VarFileInfo"
    BEGIN
        /* The following line should only be modified for localized versions.     */
        /* It consists of any number of WORD,WORD pairs, with each pair           */
        /* describing a language,codepage combination supported by the file.      */
        /*                                                                        */
        /* For example, a file might have values "0x409,1252" indicating that it  */
        /* supports English language (0x409) in the Windows ANSI codepage (1252). */

        VALUE "Translation", 0x409, 1252

    END
END 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T15:48:23.537

您可以随时尝试使用`editbin /VERSION:#[.#]`更改 dll 本身的版本。否则，它应该是项目资源文件中的一个条目。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-05T17:47:50.190

帕特里克，添加 versioninfo 块是否实际上将版本控制添加到您的 DLL 中？实际上，我的意思是当您将鼠标悬停在二进制文件上时，版本控制弹出...或右键单击>属性>详细信息也没有显示版本控制...

这适用于 exe(s)，但每当我将 versioninfo 块添加到库时，什么都不会显示。

EB

好的，以为我今天会分享我的无知......显然这个版本控制只适用于 exe（s）和 dll（s）所以我希望在静态库上使用它以快速查看版本控制

# django - 如何使用 django 表单/模型来表示字段之间的选择？

> ID：507564
> 
> 赞同：4
> 
> 时间：2009-02-03T15:31:35.597
> 
> 标签：django, django-models, django-forms

如何在模型字段中使用布尔选项来启用/禁用其他字段。如果布尔值为真/假，我希望它启用/禁用其他模型字段。有没有办法使用 django 模型/表单/小部件本地表达这些关系？我一直在编写自定义模板来模拟这些关系，但是如果没有特殊的模板，我无法找到一种在 django 中表示它们的好方法。

例如：

```
类PointInTime（模型。模型）：
    is_absolute_time = models.BooleanField()
    absolute_time = models.DateTimeField()
    is_relative_time = models.BooleanField()
    days_before = models.IntegerField()

```

因此，如果 is_absolute_time 为 True，我希望 absolute_time 条目可在 GUI 中编辑，而 days_before 条目灰显且不可编辑。如果“is_relative_time”标志为 True，我希望 absolute_time 条目变灰，并且 days_before 值可编辑。因此 is_absolute_time 和 is_relative_time 将是 GUI 中同一组中的单选按钮，并且它们的两个对应字段仅在选择它们的单选按钮时才可编辑。这在自定义模板中很容易做到，但是有没有办法在 django 中使用模型/表单来本地显示这种关系？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T18:29:14.320

澄清“本机显示这种关系”的含义并清楚地考虑关注点分离会很有帮助。

如果您只想根据另一个字段的值“变灰”或禁用某个字段，这纯粹是一个演示/UI 问题，因此模板（和/或 Javascript）是处理它的合适位置。

如果您想验证提交的数据是否内部一致（即如果 is_absolute_time 为 True，则填写 absolute_time 等），这是一个表单验证问题。该逻辑的位置在您的 Form 或 ModelForm 对象的 clean() 方法中。

如果您想确保在没有内部一致的情况下不能将任何 PointInTime 模型保存到数据库中，那就是数据层问题。这样做的地方是在模型对象上的自定义 save() 方法中（Django 1.2 将包括[更广泛的模型验证系统](http://docs.djangoproject.com/en/dev/ref/models/instances/#id1)）。

所有这些选项都涉及编写命令式代码来完成您对这些特定字段的需要。您可能正在寻找一种在模型中以声明方式表示情况的方法，以便可以通用而不是专门编写上述所有三种情况的代码。没有内置的 Django 方法可以执行此操作，但您当然可以执行以下操作：

```
class PointInTime(models.Model):
    field_dependencies = {'is_absolute_time': 'absolute_time',
                          'is_relative_time': 'days_before'}
    ... fields here ... 
```

然后，您的模型 save() 代码（或您的 Form clean() 代码或您的模板）可以使用此字典来确定应启用/禁用哪些字段，具体取决于哪个字段的值。但是，这种概括几乎不值得付出努力，除非您预计需要在许多不同的模型中做同样的事情。

最后，您可能需要考虑一些模式设计替代方案，以使您的数据层更好地规范化：

*   如果只有两个有效状态（绝对和相对），请使用单个布尔字段而不是两个。然后你避免可能的不一致（如果两个布尔值都是假的，这意味着什么？还是真？）

*   或者通过完全消除布尔值并仅在 absolute_time/days_before 中的一个或另一个中使用 Null 值来进一步简化。

*   如果可能有两个以上的有效状态，请使用单个 IntegerField 或 CharField 进行选择，而不是使用两个布尔字段。与上述相同的原因，但可以容纳两个以上的选项。

*   由于 RelativeTime 和 AbsoluteTime 似乎彼此不共享任何数据字段，因此请考虑将它们完全拆分为单独的模型。如果您有其他模型需要一个外键到另一个模型，您可以使用继承来建模（RelativeTime 和 AbsoluteTime 都继承自 PointInTime，其他模型具有指向 PointInTime 的外键）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T16:29:48.287

我不完全确定你在用这些对象做什么，但无论用户选择哪个，你都指向一个时间点。“5 天前”是“星期四”，反之亦然。

因此，除非日期随网站滚动（例如，“5 天前”的记录仍表示星期四、明天等），这肯定只是界面问题吗？如果是这种情况，我会坚持在您的模型中为日期使用单个值，并让表单和视图完成所有工作。

这解决了自动生成的管理方面的问题，因为您只需要处理一个字段，但除非您编写自己的表单小部件并覆盖模型的 ModelAdmin 类，否则它不会原生地让您在两者之间进行选择。

如果不是这种情况，请忽略此答案。

# java - 为什么 Grails 需要 Xerces？

> ID：507565
> 
> 赞同：1
> 
> 时间：2009-02-03T15:32:04.037
> 
> 标签：java, grails, xerces

我们在 grails 项目中遇到了不同 XML 库冲突的问题。解决方案是从 $GRAILS_HOME/lib 中删除 xercesImpl.jar。没有它，Grails 也能很好地工作。所以我的问题是，为什么 grails-distribution 中的 xerces-library 首先是？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T15:36:23.810

包含 XML 解析器的一个常见原因是应用程序是否需要在早期的 JRE 版本上运行。

# button - 如何在 Windows 上禁用 Perl/Tk 窗口关闭 ('X') 按钮

> ID：507566
> 
> 赞同：2
> 
> 时间：2009-02-03T15:32:21.167
> 
> 标签：button, perltk

有没有办法禁用 Perl/Tk 窗口的关闭 ('X') 按钮？我知道如何使用[此处](http://www.mail-archive.com/perl-win32-users@lyris.activestate.com/msg01402.html)描述的技术忽略单击它，但我更愿意禁用它。

我在 Windows 上使用 Perl/Tk。

谢谢，
刺客

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T17:44:18.450

如果您在 Unix 环境中，那么您就不走运了。“关闭”按钮由`Window Manager`桌面管理，这是一个完全不同的过程，您无法控制。

即使您通过黑客禁用“关闭”按钮，如果窗口管理器允许，用户也可以随时将其恢复。例如，启蒙窗口管理器可以按需启用/禁用所有窗口按钮。

您在链接中提供的技术正是这样做的。它不会删除“关闭”按钮。它只是给窗口管理器 ( ) 一个**提示**`WM_DELETE_WINDOW`。 *是否遵守此提示取决于窗口管理器。*

另请参阅[icccm](http://tronche.com/gui/x/icccm/)和[NetWM](http://standards.freedesktop.org/wm-spec/wm-spec-latest.html)页面。

你想要的*可能*在 Windows 上是可能的，但我对这个操作系统的经验是有限的，所以也许另一位海报会知道这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-06-30T18:34:48.327

我有一个我写的应用程序，我想知道同样的事情，我没有禁用它，但我有一个对子程序的回调，这只是`return;`

```
$Mw->protocol('WM_DELETE_WINDOW',sub{return;}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-22T21:38:53.873

根据[Perl Monks 的](http://www.perlmonks.org/?node_id=855752)说法，它在 Windows 上看起来像以下工作：

```
#!/usr/bin/perl
use warnings;
use strict;
use Tk;

my $window = new MainWindow;
$window ->title("Close test");
$window ->geometry("400x250");

#prevents window from closing
$window->protocol('WM_DELETE_WINDOW' => sub {
                       print "Do stuff before exiting\n";
                       exit;
                   });

MainLoop; 
```

在上面的代码中，您正在拦截用户按下“X”时发送的信号，然后可以编写自己的子程序以在按下按钮时执行。

如果你想**禁用关闭图标**，设置`sub`为空（有效地告诉它“按下时什么都不做”）：`'WM_DELETE_WINDOW' => sub {}`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-09T13:52:32.703

如果您没有设法*真正*禁用关闭按钮（我的意思是将其变灰甚至从窗口装饰中删除），那么将窗口图标化而不是关闭它可能是最直观的事情。这就是我所做的。

`$window->protocol('WM_DELETE_WINDOW', sub { $window->iconify(); } );`

# iphone - 如何通过触摸选项将图像设置到另一个固定位置？

> ID：507567
> 
> 赞同：0
> 
> 时间：2009-02-03T15:32:48.963
> 
> 标签：iphone, objective-c, cocos2d-iphone

我正在尝试使用 Cocos2d 构建一个 iPhone 应用程序。我想通过使用触摸作为我的愿望（快速或缓慢）将图像从固定位置设置到另一个固定位置。我有一些代码，但它不能正常工作。

所以朋友们，如果我得到任何解决方案，它会对我更有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-11T18:23:50.487

这个问题有点模糊，但是如果你想设置一个 CocosNode 的位置，你可以这样做：

```
[myNode setPosition:cpv(x,y)]; 
```

如果您希望节点从触摸位置偏移，可以通过实现 ccTouchesBegan:withEvent 来实现

```
-(BOOL)ccTouchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
  UITouch *touch = [touches anyObject];
  CGPoint location = [touch locationInView: [touch view]];
  CGPoint convertedLocation = [[Director sharedDirector] convertCoordinate:location];

  [myNode setPosition: cpv(convertedLocation.x - 100, convertedLocation.y - 100)];
  return kEventHandled;
} 
```

这将使 CocosNode 偏移 -100,-100 到触摸发生的位置。

ccTouchesBegan:withEvent: 应该在您的层中实现，并且 isTouchesEnabled 应该设置为 YES 以启用触摸。

# html - 让一个 div 填充空间

> ID：507579
> 
> 赞同：0
> 
> 时间：2009-02-03T15:35:51.783
> 
> 标签：html, css

我想在内容 div 的一侧放置两列。我遇到的问题是我希望由 3 个部分构建列。顶部和底部应该有固定的高度，但中间的高度会根据内容高度进行调整。用一列查看示例：

```
<html>
   <head>
      <style>
          * { border: 1px solid black;}
          #contentWrapper     { width:450px; }
          #leftColumn         { width:100px; float: left; }
          #leftColumnTop      { width:100px; height:50px; 
                                 background-color: gray; }
          #leftColumnMiddle   { background-color: red; }
          #leftColumnBottom   { width: 100px; height:50px; 
                                 background-color: gray; }
          #content            { width: 300px; float: left; }
          #footer             { width: 400px; clear: both; }
      </style>
   </head>
   <body>
       <div id="contentWrapper">
       <div id="leftColumn">
      <div id="leftColumnTop"> </div>
      <div id="leftColumnMiddle"> </div>
      <div id="leftColumnBottom"> </div>
      </div>
      <div id="content">content<br> here <br>more 
               <br>more <br>more <br>more <br>more 
               <br>more <br>
          </div>
          <div id="footer">footer text</div>
      </div>
   </body>
</html> 
```

我想要的是`#leftColumnBottom`页脚顶部的棍子和红色`#leftColumnMiddle`来填充顶部和底部之间的空间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T15:42:20.490

这适用于除 IE6 之外的所有内容；为此，您需要一个条件注释和 css 表达式来设置高度而不是`bottom`on`#leftColumnMiddle`

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>
<style>* { border: 1px solid black;}
#contentWrapper     { position: relative; float:left; width: 450px; }
#leftColumnTop      { position: absolute; width: 100px; height: 50px; left: 0; background-color: gray; }
#leftColumnMiddle   { position: absolute; width: 100px; top: 50px; bottom: 50px; left: 0; background-color: red; }
#leftColumnBottom   { position: absolute; width: 100px; height: 50px; left: 0; bottom: 0; background-color: gray; }
#content            { width: 300px; float: left; margin-left: 100px;}
#footer             { width: 400px; clear: both; }
</style>
</head>
<body>
<div id="contentWrapper">
    <div id="leftColumnTop"> </div>
    <div id="leftColumnMiddle"> </div>
    <div id="leftColumnBottom"> </div>
    <div id="content">content<br>
    here<br>more<br>more<br>more<br>more<br>more<br>more<br>
    </div>
</div>
<div id="footer">footer text</div>
</body>
</html> 
```

对于评论者 - 它几乎起作用了，所以这就是原因。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T15:41:22.473

为需要增长的那个尝试最小高度

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T15:58:33.857

如果你需要两列高度相等，*并且*在 IE6 中工作，你基本上必须破解。

我过去使用的解决方案涉及为其中一列设置假边距/填充。这假设您知道列可以增长的上限（可能在几千像素的数量级）。

[此处](http://www.positioniseverything.net/articles/onetruelayout/equalheight)概述了此解决方案。

引用我链接的页面：

> 基本方法是这样工作的：
> 
> 1.  将充当列的块必须包装在容器元素中
> 2.  应用溢出：隐藏到容器元素
> 3.  将 padding-bottom: $big_value [2] 应用于列块，其中 $big_value 是
> 
> 4.  将 margin-bottom: -$big_value 应用于列块

# sql-server - 跨不同数据库（模式）授予权限

> ID：507581
> 
> 赞同：0
> 
> 时间：2009-02-03T15:35:59.677
> 
> 标签：sql-server, sql-server-2005, tsql, permissions

我只允许通过一系列 Sproc 与数据库交互来保护数据库；很普通的票价。

我已经挖掘并修改了一个脚本，该脚本循环并为所有非系统 SProcs 分配用户 EXECUTE 权限。除了我希望将它添加到主数据库以便我可以轻松地将其用于任何后续项目之外，它是一种享受。是的，我可以将简单保存为 .sql 文件，但我更喜欢这种方式。

问题是我不知道如何动态引用另一个数据库中的对象。例如，我可以在 MyDB.dbo.INFORMATION_SCHEMA.ROUTINES 上轻松查询，但如果数据库名称是动态的（例如 @MyDBName），我如何查询此数据库中的对象？

编辑：感谢下面的海报，我现在有了一个可行的解决方案：

```
USE [master]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [dbo].[spGrantExec] 
@User sysname,
@DB varchar(50),
@Target varchar(50)
AS 
/*---------------------------- SQL 2005 + -------------------------------*/

SET NOCOUNT ON

-- 1 - Variable declarations
DECLARE @SQL varchar(8000)

-- 2 - Create temporary table
Set @SQL =
'USE @DB

DECLARE @MAXOID int
DECLARE @OwnerName varchar(128)
DECLARE @ObjectName varchar(128)
DECLARE @CMD1 varchar(8000)

CREATE TABLE #StoredProcedures
(OID int IDENTITY (1,1),
StoredProcOwner varchar(128) NOT NULL,
StoredProcName varchar(128) NOT NULL)

-- 3 - Populate temporary table

INSERT INTO #StoredProcedures (StoredProcOwner, StoredProcName)
SELECT ROUTINE_SCHEMA, ROUTINE_NAME
FROM INFORMATION_SCHEMA.ROUTINES 
WHERE ROUTINE_NAME LIKE ''' + @Target + '%''
 AND ROUTINE_TYPE = ''PROCEDURE''

-- 4 - Capture the @MAXOID value
SELECT @MAXOID = MAX(OID) FROM #StoredProcedures

-- 5 - WHILE loop
WHILE @MAXOID > 0
 BEGIN 

    -- 6 - Initialize the variables
    SELECT @OwnerName = StoredProcOwner,
    @ObjectName = StoredProcName
    FROM #StoredProcedures
    WHERE OID = @MAXOID

    -- 7 - Build the string

    SELECT @CMD1 = ''GRANT EXEC ON '' + ''['' + @OwnerName + '']'' + ''.'' + ''['' + @ObjectName + '']'' + '' TO @user''

    -- 8 - Execute the string
    Print @CMD1
    EXEC(@CMD1)

    -- 9 - Decrement @MAXOID
    SET @MAXOID = @MAXOID - 1
 END

-- 10 - Drop the temporary table
DROP TABLE #StoredProcedures'

Set @SQL = REPLACE(REPLACE(REPLACE(@SQL, '@DB', @DB), '@User', @User), '@Target', @Target)
--Select @SQL
--Print @SQL
Exec (@SQL)
SET NOCOUNT OFF 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T17:52:08.323

类似于@Cade 的回答，这样做的方法是使用动态sql。在每次调用数据库表之前，添加“@DbName”。然后将@DbName 替换为实际的数据库名称（数据库名称在SQL 中不能作为变量传递，因此您必须进行替换）。

出于性能原因，游标通常被认为是邪恶的，但是在这种情况下使用游标是有意义的。一方面，它会大大简化程序，而且由于您只会在应用程序更新期间运行一次，您可能不会注意到性能下降，即使它增加了一两秒（我怀疑它会添加接近那么多的任何地方）。

```
ALTER PROCEDURE [dbo].[spGrantExec]
@User SysName,
@DbName VarChar(512)
AS
BEGIN
DECLARE @Sql VarChar(1024)

SET @Sql = 'DECLARE @OwnerName varchar(128)
DECLARE @ObjectName varchar(128)
DECLARE @Cmd1 VarChar(128)
DECLARE ProcCursor CURSOR FOR
SELECT ROUTINE SCHEMA, ROUTINE NAME
FROM @DbName.INFORMATION SCHEMA.ROUTINES 
WHERE ROUTINENAME NOT LIKE ''dt %'' AND ROUTINE TYPE = ''PROCEDURE''
OPEN ProcCursor
FETCH NEXT FROM ProcCursor INTO @OwnerName, @ObjectName
WHILE @@FETCH STATUS = 0
BEGIN
SET @CMD1 = ''GRANT EXEC ON '' + ''['' + @OwnerName + '']'' + ''.'' + ''['' + @ObjectName + '']'' + '' TO '' + ''@user''
EXEC (@CMD1)

FETCH NEXT FROM ProcCursor INTO @OwnerName, @ObjectName
END
CLOSE ProcCursor
DEALLOCATE ProcCursor
'

SET @Sql = Replace(Replace(@Sql, '@DbName', @DbName), '@user', @User)
EXEC (@Sql) `END` 
```

您可以使用以下命令调用它：EXEC [spGrantExec] 'bob', 'Northwind'

抱歉，sp 中的间距有点偏离。使用 Sql 2005 开发。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-06T03:45:18.890

我发现[了另一种我认为更清洁的技术](http://www.sommarskog.se/dynamic_sql.html#Dyn_table)：

```
SELECT @sql = 'CREATE VIEW ...'
SELECT @sp_executesql = quotename(@dbname) + '..sp_executesql'
EXEC @sp_executesql @sql 
```

这依赖于通过在另一个数据库中调用 sp_executesql 来设置数据库上下文（就像可以在任何数据库中调用 SP 一样）。

在你的情况下，它相当于：

```
SELECT @sp_executesql = quotename(@dbname) + '..sp_executesql'
EXEC @sp_executesql @CMD1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T15:40:58.947

您可以使用[双重执行技术](https://stackoverflow.com/questions/483798/creating-stored-procedure-in-another-database/483868#483868)。

在您的情况下，而不仅仅是：

```
EXEC(@CMD1) 
```

你将会拥有：

```
SET @CMD1 =
    'USE OtherDatabase;
    EXEC (''' + REPLACE(@CMD1, '''', '''''') + ''')'
EXEC(@CMD1) 
```

# c# - MVC通用类位置

> ID：507588
> 
> 赞同：7
> 
> 时间：2009-02-03T15:38:46.300
> 
> 标签：c#, .net, asp.net-mvc, solution

在 MVC 文件夹结构中，通用类文件应该放在哪里？例如，我有一个类可以确定要使用的正确 DataContext，因此我不会在每个控制器中重新发明轮子。即使它不是控制器，它是否应该存在于 Controllers 文件夹中？它是否应该与模型一起使用，因为它与数据库相关，即使它不是模型？可能是 Views\Shared 文件夹？或者 Content 是那种东西的包罗万象的文件夹？我确信我可以把它放在任何地方，但我想知道“正确”的地方在哪里。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-03T15:58:04.483

它不是控制器、内容或视图，所以不要使用它们。它听起来与您的模型最密切相关，因此您可以将它放在模型中名为“Helpers”或“Utility”之类的子文件夹下。或者，您可以添加另一个名为 Services 的顶级文件夹并将其放在那里。这就是我放置所有应用程序逻辑的地方，即控制器和模型之间的中间人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-03T15:54:31.837

如果您查看 Rob 的 MVC Storefront：单独的类库项目（如 Commerce.MVC.Data）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T15:50:44.793

如果它本身有用（想想围绕它构建的命令行工具），请将其放在 Models 文件夹中。如果它仅用作控制器的助手，请将其放在 Controllers 文件夹中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T15:55:21.027

这真的取决于它做什么，如果它访问数据它应该在数据访问层，否则你可以把它放在控制器文件夹中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-03T15:57:04.780

德马基奇，

为什么要把它分成自己的区域？如果它的 BLL 代码应该在控制器文件夹中，如果它的 DAL 相关项它应该在模型中。我可以理解如果一个项目变得庞大并且您想创建一些子文件夹，那应该不是问题。但是将代码放在另一层确实违背了 MVC 的目的，你不觉得吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T13:04:46.923

有一个单独的 DataAccess 程序集，将该类设为内部并将其命名为 DataContextFactory。

# c# - 如何将电子邮件功能从 ASP Classic 迁移到 ASP.NET？

> ID：507589
> 
> 赞同：1
> 
> 时间：2009-02-03T15:38:59.747
> 
> 标签：c#, email, asp-classic

我以前在 ASP Classic 中使用`CDO.Message`和`CDO.Configuration`创建非常简单的 HTML 电子邮件。在 .NET 中，您似乎必须为`System.Net.Mail.Message`对象提供内容的 HTML 字符串，然后以某种方式嵌入所需的图像。在 .NET 中是否有一种简单的方法可以做到这一点？我对 .NET MVC 很陌生，非常感谢任何帮助。

这是它在 ASP Classic 中的外观：

```
Set objCDO = Server.CreateObject("CDO.Message")
objCDO.To = someone@somthing.com
objCDO.From = me@myaddress.com
objCDO.CreateMHTMLBody "http://www.example.com/somepage.html"
objCDO.Subject = sSubject

'the following are for advanced CDO schematics
'for authentication and external SMTP

Set cdoConfig = CreateObject("CDO.Configuration")
With cdoConfig.Fields  
  .Item(cdoSendUsingMethod) = cdoSendUsingPort '2 - send using port  
  .Item(cdoSMTPServer) = mail.myaddress.com
  .Item(cdoSMTPServerPort) = 25
  .Item(cdoSMTPConnectionTimeout) = 10
  .Item(cdoSMTPAuthenticate) = cdoBasic
  .Item(cdoSendUsername) = "myusername"
  .Item(cdoSendPassword) = "mypassword"
  .Update  
End With

Set objCDO.Configuration = cdoConfig

objCDO.Send 
```

基本上，我想将我的一个观点（减去 site.master）作为电子邮件发送，嵌入图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T06:58:12.497

谢谢你们的帮助 - 这是一个非常干净和全面的教程，由 .NET MVP [http://msdn.microsoft.com/en-us/vbasic/bb630227.aspx发布](http://msdn.microsoft.com/en-us/vbasic/bb630227.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T16:06:20.597

我不知道有什么简单的方法，但是您可以使用 WebClient 来获取您的页面，然后将响应作为正文传递。

例子：

```
var webClient = new WebClient();

byte[] returnFromPost = webClient.UploadValues(Url, Inputs);

var utf = new UTF8Encoding();
string returnValue = utf.GetString(returnFromPost);

return returnValue; 
```

注意：输入只是一个后变量的字典。

我认为您会立即遇到的一个问题是，我认为您不会得到图像。您可以解析获得的 HTML，然后将图像绝对返回到您的服务器。

# asp.net - 保护 Web 服务的侵入性最小的方法？

> ID：507591
> 
> 赞同：0
> 
> 时间：2009-02-03T15:39:35.097
> 
> 标签：asp.net, javascript, ajax, web-services, security

我正在维护一个公共网站（无需授权），该网站通过 https 使用 Web 服务来执行各种操作。大多数对 Web 服务的调用都是从 javascript 调用的。

我最近想到的是，如果恶意黑客愿意，他/她可以直接调用 Web 服务，试图对系统造成严重破坏。

实际上，它们能造成的损害并不大，但在实践中，这些事情很难预测。

请记住，Web 服务调用将在 javascript 代码（客户端可用）中公开，我可以用来防止未经授权和/或恶意访问 Web 服务的最佳方法是什么。

遗憾的是，我不能只限制 IP 访问，因为那里有基于 Windows 窗体的客户端应用程序，它们也与 Web 服务交互。

使用 Windows 身份验证可能很困难，因为这些客户端应用程序可以在世界任何地方运行，并且用户不属于任何特定的 AD 组，甚至不属于任何域。

我将不胜感激任何建议，请记住两种不同的访问类别和 javascript 代码的公开。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T15:45:41.450

任何由 javascript 调用的东西都可以被有权使用该 javascript 的恶意用户轻松模仿。我建议修改页面以使用更多的服务器端解决方案。将 AJAX 留给不容易被利用的东西。

防止未经授权的用户比支持完全公共访问要容易得多。如果您在用户的 cookie 上放置一个过期的 guid，该 guid 与单个用户相关联，作为参数之一发送给 Web 服务，那么您就有了一个额外的、通常难以破解的应用程序层。

但是，任何有权执行 javascript 的人都应该毫不费力地将其拼凑起来。无法访问 javascript 的人可能无法轻松访问 Web 服务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T15:53:06.223

这需要做一些工作，但如果您的页面也是 ASP.net，您可以设置共享会话，打开 Web 服务上的 EnableSession 属性并使用会话数据来保护会话。可以在此处找到概述：http: [//blogs.lessthandot.com/index.php/WebDev/ServerProgramming/ASPNET/sharing-asp-net-session-state-between-we](http://blogs.lessthandot.com/index.php/WebDev/ServerProgramming/ASPNET/sharing-asp-net-session-state-between-we)

这将需要为您的 Windows 应用程序使用不同的服务“版本”。

# tfs - 我应该为我的 TFSBuild 帐户提供哪些帐户权限？

> ID：507592
> 
> 赞同：3
> 
> 时间：2009-02-03T15:39:44.113
> 
> 标签：tfs, permissions

我有一个运行 tfs build 的单独服务器。

我创建了一个将运行 tfs 构建服务的帐户。

我收到一个错误，因为它说它无法访问放置文件夹。

我必须为 tfs 构建服务帐户授予什么权限？我相信它必须是某些 tfs 特定组的一部分？

**更新**

我决定只使用域上的 tfsservice 帐户...

我使用 LogonAs 为 TFSBuild 服务添加了 TFSService 帐户，我收到“无法在本地计算机上启动团队基础构建服务”错误 5 访问被拒绝。

我使用 mydomain/tfsservice 作为帐户名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T15:42:50.160

由于除了最终的复制任务之外构建实际上已经完成，只需将 TFSBuild 帐户添加到放置位置的文件夹即可完全控制。这将尽可能暴露 fs 的最小部分。

# php - 使用 Zend 框架转义用户输出的最佳方法是什么？

> ID：507593
> 
> 赞同：0
> 
> 时间：2009-02-03T15:40:07.843
> 
> 标签：php, zend-framework

我对应该使用什么来逃避用户输出感到有些困惑。

首先，有一个[`Zend_Filter_Input`](http://framework.zend.com/manual/en/zend.filter.input.html)类看起来可能会做我想要的，但似乎面向批量过滤大量项目。目前我只想过滤一个。此外，与过滤器相比，逃逸者的定义也让我有些困惑。过滤器和逃逸器有什么区别`StringTrim`？

是否有更好的解决方案来转义单个元素？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-03T18:07:02.227

过滤器非常适合您的表单，因此您可以在处理/存储数据之前对其进行清理和规范化。您提到了 StringTrim - 您还有其他确保大写或您的输入都是数字（或字母数字或......）的。请注意，这是为了确保数据的一致性和完整性——而不是为了避免 SQL 注入——ZF 的数据库库将其作为一个单独的问题处理。

另一方面，你可以逃避输出。虽然“x < 5”或“PB&J”可能是在您的系统中存储和处理的完全有效的数据，但它们在网页上显示时可能会导致问题。这就是为什么您通常使用`htmlspecialchars()`或`htmlentities()`- 默认情况下，Zend_View 在您使用 htmlspecialchar() 时使用`$this->escape($foo)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T16:00:16.990

使用[htmlspecialchars()](http://www.php.net/htmlspecialchars)？

如果这不是您想要的，请指定“转义用户输出”的含义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T18:55:39.693

如果您担心安全性并希望像 Django 一样自动转义所有变量，那么您可能会对本文感兴趣。

[如何在 Zend_View 中自动转义模板变量](http://codeutopia.net/blog/2007/11/10/how-to-automatically-escape-template-variables-in-zend_view/)

# java - 如何初始化静态地图？

> ID：507602
> 
> 赞同：1198
> 
> 时间：2009-02-03T15:41:33.080
> 
> 标签：java, dictionary, collections, initialization, idioms

你将如何`Map`在 Java 中初始化一个静态变量？

方法一：静态初始化
方法二：实例初始化（匿名子类）还是其他方法？

各自的优缺点是什么？

以下是说明这两种方法的示例：

```
import java.util.HashMap;
import java.util.Map;

public class Test {
    private static final Map<Integer, String> myMap = new HashMap<>();
    static {
        myMap.put(1, "one");
        myMap.put(2, "two");
    }

    private static final Map<Integer, String> myMap2 = new HashMap<>(){
        {
            put(1, "one");
            put(2, "two");
        }
    };
} 
```

* * *

## 回答 #1

> 赞同：1169
> 
> 时间：2009-02-03T15:51:04.420

在这种情况下，实例初始化程序只是语法糖，对吧？我不明白为什么你需要一个额外的匿名类来初始化。如果正在创建的类是最终的，它将不起作用。

您也可以使用静态初始化器创建不可变映射：

```
public class Test {
    private static final Map<Integer, String> myMap;
    static {
        Map<Integer, String> aMap = ....;
        aMap.put(1, "one");
        aMap.put(2, "two");
        myMap = Collections.unmodifiableMap(aMap);
    }
} 
```

* * *

## 回答 #2

> 赞同：468
> 
> 时间：2011-08-31T13:58:37.283

我喜欢[Guava](https://github.com/google/guava)初始化静态、不可变映射的方式：

```
static final Map<Integer, String> MY_MAP = ImmutableMap.of(
    1, "one",
    2, "two"
); 
```

如您所见，它非常简洁（因为 中方便的工厂方法[`ImmutableMap`](https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/ImmutableMap.html)）。

如果您希望地图的条目超过 5 个，则不能再使用`ImmutableMap.of()`. 相反，请尝试[`ImmutableMap.builder()`](https://google.github.io/guava/releases/snapshot/api/docs/com/google/common/collect/ImmutableMap.html#builder--)以下方式：

```
static final Map<Integer, String> MY_MAP = ImmutableMap.<Integer, String>builder()
    .put(1, "one")
    .put(2, "two")
    // ... 
    .put(15, "fifteen")
    .build(); 
```

要了解更多关于 Guava 的不可变集合实用程序的好处，请参阅[Guava 用户指南中](https://github.com/google/guava/wiki/ImmutableCollectionsExplained)[*解释*](https://github.com/google/guava/wiki/ImmutableCollectionsExplained)的不可变集合。

Guava 的（一个子集）曾经被称为*Google Collections*。如果您还没有在 Java 项目中使用这个库，我**强烈**建议您尝试一下！[正如其他 SO 用户所同意](https://stackoverflow.com/questions/130095/most-useful-free-third-party-java-libraries/132639#132639)的那样，Guava 已迅速成为 Java 最流行和最有用的免费 3rd 方库之一。（如果您是新手，该链接后面有一些优秀的学习资源。）

* * *

**更新（2015 年）**：至于**Java 8**，好吧，我仍然会使用 Guava 方法，因为它比其他任何方法都干净。如果您不想要 Guava 依赖，请考虑使用[普通的旧 init 方法](https://stackoverflow.com/a/509016/56285)。[如果你问我，二维数组和 Stream API](https://stackoverflow.com/a/25829097/56285)的 hack非常丑陋，如果你需要创建一个键和值不是同一类型的 Map（就像`Map<Integer, String>`问题中一样），它会变得更丑陋。

至于 Guava 的未来，关于 Java 8，Louis Wasserman早在 2014 年就[说过，2016 年 [](https://groups.google.com/d/msg/guava-discuss/fEdrMyNa8tA/F4XFm6-uA6oJ)*更新*] 宣布[**Guava 21 将需要并正确支持 Java 8**](https://groups.google.com/forum/?utm_medium=email&utm_source=footer#!msg/guava-announce/o954PqvaXLY/7ss96X6sAwAJ)。

* * *

**更新（2016 年）**：正如[Tagir Valeev 指出的那样](https://stackoverflow.com/questions/507602/how-can-i-initialise-a-static-map/34508760#34508760)，**Java 9**最终将通过为集合添加[便利工厂方法](http://openjdk.java.net/jeps/269)，只使用纯 JDK 来实现这一点：

```
static final Map<Integer, String> MY_MAP = Map.of(
    1, "one", 
    2, "two"
); 
```

* * *

## 回答 #3

> 赞同：197
> 
> 时间：2009-02-03T21:40:14.573

我会使用：

```
public class Test {
    private static final Map<Integer, String> MY_MAP = createMap();

    private static Map<Integer, String> createMap() {
        Map<Integer, String> result = new HashMap<>();
        result.put(1, "one");
        result.put(2, "two");
        return Collections.unmodifiableMap(result);
    }
} 
```

1.  它避免了匿名类，我个人认为这是一种不好的风格，并避免
2.  它使地图的创建更加明确
3.  它使地图不可修改
4.  由于 MY_MAP 是常量，我将其命名为常量

* * *

## 回答 #4

> 赞同：188
> 
> 时间：2009-07-15T21:29:54.440

Java 5 提供了这种更紧凑的语法：

```
static final Map<String , String> FLAVORS = new HashMap<String , String>() {{
    put("Up",    "Down");
    put("Charm", "Strange");
    put("Top",   "Bottom");
}}; 
```

* * *

## 回答 #5

> 赞同：102
> 
> 时间：2009-02-03T15:44:58.300

第二种方法的一个优点是您可以将其包装起来`Collections.unmodifiableMap()`以保证以后不会更新集合：

```
private static final Map<Integer, String> CONSTANT_MAP = 
    Collections.unmodifiableMap(new HashMap<Integer, String>() {{ 
        put(1, "one");
        put(2, "two");
    }});

 // later on...

 CONSTANT_MAP.put(3, "three"); // going to throw an exception! 
```

* * *

## 回答 #6

> 赞同：70
> 
> 时间：2015-12-29T10:07:24.950

# `Map.of`在 Java 9+

```
private static final Map<Integer, String> MY_MAP = Map.of(1, "one", 2, "two"); 
```

有关详细信息，请参阅[JEP 269](http://openjdk.java.net/jeps/269)。JDK 9于 2017 年 9 月[全面上市](http://jdk.java.net/9/)。

* * *

## 回答 #7

> 赞同：63
> 
> 时间：2014-09-14T00:44:37.927

这是一个 Java 8 单行静态映射初始化器：

```
private static final Map<String, String> EXTENSION_TO_MIMETYPE =
    Arrays.stream(new String[][] {
        { "txt", "text/plain" }, 
        { "html", "text/html" }, 
        { "js", "application/javascript" },
        { "css", "text/css" },
        { "xml", "application/xml" },
        { "png", "image/png" }, 
        { "gif", "image/gif" }, 
        { "jpg", "image/jpeg" },
        { "jpeg", "image/jpeg" }, 
        { "svg", "image/svg+xml" },
    }).collect(Collectors.toMap(kv -> kv[0], kv -> kv[1])); 
```

编辑：要在问题中初始化 a `Map<Integer, String>`，您需要这样的东西：

```
static final Map<Integer, String> MY_MAP = Arrays.stream(new Object[][]{
        {1, "one"},
        {2, "two"},
}).collect(Collectors.toMap(kv -> (Integer) kv[0], kv -> (String) kv[1])); 
```

编辑（2）：i_am_zero 有一个更好的、支持混合类型的版本，它使用`new SimpleEntry<>(k, v)`调用流。查看答案：[https ://stackoverflow.com/a/37384773/3950982](https://stackoverflow.com/a/37384773/3950982)

* * *

## 回答 #8

> 赞同：53
> 
> 时间：2016-05-23T07:17:08.880

## 爪哇 9

我们可以使用[`Map.ofEntries`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html#ofEntries(java.util.Map.Entry...)), 调用[`Map.entry( k , v )`](https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/Map.html#entry(K,V))来创建每个条目。

```
import static java.util.Map.entry;
private static final Map<Integer,String> map = Map.ofEntries(
        entry(1, "one"),
        entry(2, "two"),
        entry(3, "three"),
        entry(4, "four"),
        entry(5, "five"),
        entry(6, "six"),
        entry(7, "seven"),
        entry(8, "eight"),
        entry(9, "nine"),
        entry(10, "ten")); 
```

我们也可以`Map.of`按照 Tagir 在他的回答中的建议[使用](https://stackoverflow.com/a/34508760/1216775)，但我们不能有超过 10 个使用`Map.of`.

## 爪哇 8

我们可以创建一个映射条目流。我们已经有两个实现`Entry`，`java.util.AbstractMap`其中[SimpleEntry](https://docs.oracle.com/javase/8/docs/api/java/util/AbstractMap.SimpleEntry.html)和[SimpleImmutableEntry](https://docs.oracle.com/javase/8/docs/api/index.html?java/util/AbstractMap.SimpleImmutableEntry.html)。对于此示例，我们可以将前者用作：

```
import java.util.AbstractMap.*;
private static final Map<Integer, String> myMap = Stream.of(
            new SimpleEntry<>(1, "one"),
            new SimpleEntry<>(2, "two"),
            new SimpleEntry<>(3, "three"),
            new SimpleEntry<>(4, "four"),
            new SimpleEntry<>(5, "five"),
            new SimpleEntry<>(6, "six"),
            new SimpleEntry<>(7, "seven"),
            new SimpleEntry<>(8, "eight"),
            new SimpleEntry<>(9, "nine"),
            new SimpleEntry<>(10, "ten"))
            .collect(Collectors.toMap(SimpleEntry::getKey, SimpleEntry::getValue)); 
```

* * *

## 回答 #9

> 赞同：31
> 
> 时间：2012-12-18T23:10:43.323

使用[Eclipse Collections](https://github.com/eclipse/eclipse-collections)，以下所有操作都将起作用：

```
import java.util.Map;

import org.eclipse.collections.api.map.ImmutableMap;
import org.eclipse.collections.api.map.MutableMap;
import org.eclipse.collections.impl.factory.Maps;

public class StaticMapsTest
{
    private static final Map<Integer, String> MAP =
        Maps.mutable.with(1, "one", 2, "two");

    private static final MutableMap<Integer, String> MUTABLE_MAP =
       Maps.mutable.with(1, "one", 2, "two");

    private static final MutableMap<Integer, String> UNMODIFIABLE_MAP =
        Maps.mutable.with(1, "one", 2, "two").asUnmodifiable();

    private static final MutableMap<Integer, String> SYNCHRONIZED_MAP =
        Maps.mutable.with(1, "one", 2, "two").asSynchronized();

    private static final ImmutableMap<Integer, String> IMMUTABLE_MAP =
        Maps.mutable.with(1, "one", 2, "two").toImmutable();

    private static final ImmutableMap<Integer, String> IMMUTABLE_MAP2 =
        Maps.immutable.with(1, "one", 2, "two");
} 
```

您还可以使用 Eclipse Collections 静态初始化原始地图。

```
import org.eclipse.collections.api.map.primitive.ImmutableIntObjectMap;
import org.eclipse.collections.api.map.primitive.MutableIntObjectMap;
import org.eclipse.collections.impl.factory.primitive.IntObjectMaps;

public class StaticPrimitiveMapsTest
{
    private static final MutableIntObjectMap<String> MUTABLE_INT_OBJ_MAP =
            IntObjectMaps.mutable.<String>empty()
                    .withKeyValue(1, "one")
                    .withKeyValue(2, "two");

    private static final MutableIntObjectMap<String> UNMODIFIABLE_INT_OBJ_MAP =
            IntObjectMaps.mutable.<String>empty()
                    .withKeyValue(1, "one")
                    .withKeyValue(2, "two")
                    .asUnmodifiable();

    private static final MutableIntObjectMap<String> SYNCHRONIZED_INT_OBJ_MAP =
            IntObjectMaps.mutable.<String>empty()
                    .withKeyValue(1, "one")
                    .withKeyValue(2, "two")
                    .asSynchronized();

    private static final ImmutableIntObjectMap<String> IMMUTABLE_INT_OBJ_MAP =
            IntObjectMaps.mutable.<String>empty()
                    .withKeyValue(1, "one")
                    .withKeyValue(2, "two")
                    .toImmutable();

    private static final ImmutableIntObjectMap<String> IMMUTABLE_INT_OBJ_MAP2 =
            IntObjectMaps.immutable.<String>empty()
                    .newWithKeyValue(1, "one")
                    .newWithKeyValue(2, "two");
} 
```

**注意：**我是 Eclipse Collections 的提交者

* * *

## 回答 #10

> 赞同：29
> 
> 时间：2009-02-03T15:55:18.810

在这种情况下，我永远不会创建匿名子类。如果您想让地图不可修改，静态初始化器同样可以工作，例如：

```
private static final Map<Integer, String> MY_MAP;
static
{
    Map<Integer, String>tempMap = new HashMap<Integer, String>();
    tempMap.put(1, "one");
    tempMap.put(2, "two");
    MY_MAP = Collections.unmodifiableMap(tempMap);
} 
```

* * *

## 回答 #11

> 赞同：18
> 
> 时间：2009-02-03T21:33:02.823

看看[Google Collections](http://code.google.com/p/google-collections/)可能会很有趣，例如他们页面上的视频。它们提供了各种初始化地图和集合的方法，并且还提供了不可变集合。

更新：这个库现在被命名为[Guava](https://code.google.com/p/guava-libraries/)。

* * *

## 回答 #12

> 赞同：17
> 
> 时间：2013-09-19T08:48:59.010

我喜欢匿名类，因为它很容易处理：

```
public static final Map<?, ?> numbers = Collections.unmodifiableMap(new HashMap<Integer, String>() {
    {
        put(1, "some value");
                    //rest of code here
    }
}); 
```

* * *

## 回答 #13

> 赞同：12
> 
> 时间：2010-06-03T08:18:48.417

```
public class Test {
    private static final Map<Integer, String> myMap;
    static {
        Map<Integer, String> aMap = ....;
        aMap.put(1, "one");
        aMap.put(2, "two");
        myMap = Collections.unmodifiableMap(aMap);
    }
} 
```

如果我们声明了多个常量，那么该代码将被编写在静态块中，并且将来很难维护。所以最好使用匿名类。

```
public class Test {

    public static final Map numbers = Collections.unmodifiableMap(new HashMap(2, 1.0f){
        {
            put(1, "one");
            put(2, "two");
        }
    });
} 
```

并且建议将 unmodifiableMap 用于常量，否则它不能被视为常量。

* * *

## 回答 #14

> 赞同：10
> 
> 时间：2010-12-12T04:29:03.437

我强烈建议使用“双括号初始化”样式而不是静态块样式。

有人可能会评论说他们不喜欢匿名类、开销、性能等。

但我更多考虑的是代码的可读性和可维护性。从这个角度来看，我认为双大括号是一种更好的代码风格而不是静态方法。

1.  元素是嵌套的和内联的。
2.  它更多是面向对象的，而不是程序性的。
3.  性能影响非常小，可以忽略不计。
4.  更好的 IDE 大纲支持（而不是许多匿名静态{} 块）
5.  您保存了几行评论以使他们建立关系。
6.  防止异常和字节码优化器可能导致未初始化对象的元素泄漏/实例引导。
7.  不用担心静态块的执行顺序。

此外，如果您知道匿名类的 GC，您可以随时将其转换为普通的 HashMap 使用`new HashMap(Map map)`.

你可以这样做，直到你遇到另一个问题。如果你这样做，你应该为它使用完整的另一种编码风格（例如，没有静态，工厂类）。

* * *

## 回答 #15

> 赞同：9
> 
> 时间：2015-09-08T09:32:09.580

像往常一样 apache-commons 有适当的方法[MapUtils.putAll(Map, Object[])](https://commons.apache.org/proper/commons-collections/javadocs/api-release/org/apache/commons/collections4/MapUtils.html#putAll(java.util.Map,%20java.lang.Object[]))：

例如，要创建一个颜色图：

```
Map<String, String> colorMap = MapUtils.putAll(new HashMap<String, String>(), new String[][] {
     {"RED", "#FF0000"},
     {"GREEN", "#00FF00"},
     {"BLUE", "#0000FF"}
 }); 
```

* * *

## 回答 #16

> 赞同：8
> 
> 时间：2016-09-15T12:09:43.897

这是我最喜欢的，如果我

*   不想（或不能）使用 Guava 的`ImmutableMap.of()`
*   或者我需要一个可变的`Map`
*   或者我需要超过`Map.of()`JDK9+的 10 个条目限制

```
public static <A> Map<String, A> asMap(Object... keysAndValues) {
  return new LinkedHashMap<String, A>() {{
    for (int i = 0; i < keysAndValues.length - 1; i++) {
      put(keysAndValues[i].toString(), (A) keysAndValues[++i]);
    }
  }};
} 
```

它非常紧凑，它忽略了杂散值（即没有值的最终键）。

用法：

```
Map<String, String> one = asMap("1stKey", "1stVal", "2ndKey", "2ndVal");
Map<String, Object> two = asMap("1stKey", Boolean.TRUE, "2ndKey", new Integer(2)); 
```

* * *

## 回答 #17

> 赞同：7
> 
> 时间：2014-04-22T08:46:50.750

我更喜欢使用静态初始化程序来避免生成匿名类（这将没有其他目的），因此我将列出使用静态初始化程序进行初始化的提示。所有列出的解决方案/提示都是类型安全的。

**注意：**这个问题并没有说明关于使地图不可修改的任何内容，所以我将把它省略，但知道它可以很容易地用`Collections.unmodifiableMap(map)`.

**第一个提示**

第一个技巧是您可以对地图进行本地引用，并给它一个简短的名称：

```
private static final Map<Integer, String> myMap = new HashMap<>();
static {
    final Map<Integer, String> m = myMap; // Use short name!
    m.put(1, "one"); // Here referencing the local variable which is also faster!
    m.put(2, "two");
    m.put(3, "three");
} 
```

**第二个提示**

第二个技巧是你可以创建一个辅助方法来添加条目；如果您愿意，还可以公开此辅助方法：

```
private static final Map<Integer, String> myMap2 = new HashMap<>();
static {
    p(1, "one"); // Calling the helper method.
    p(2, "two");
    p(3, "three");
}

private static void p(Integer k, String v) {
    myMap2.put(k, v);
} 
```

此处的辅助方法不可重用，因为它只能将元素添加到`myMap2`. 为了使其可重用，我们可以将映射本身作为辅助方法的参数，但初始化代码不会更短。

**第三个提示**

第三个技巧是您可以创建一个可重用的类似构建器的辅助类，并具有填充功能。这实际上是一个简单的 10 行帮助类，它是类型安全的：

```
public class Test {
    private static final Map<Integer, String> myMap3 = new HashMap<>();
    static {
        new B<>(myMap3)   // Instantiating the helper class with our map
            .p(1, "one")
            .p(2, "two")
            .p(3, "three");
    }
}

class B<K, V> {
    private final Map<K, V> m;

    public B(Map<K, V> m) {
        this.m = m;
    }

    public B<K, V> p(K k, V v) {
        m.put(k, v);
        return this; // Return this for chaining
    }
} 
```

* * *

## 回答 #18

> 赞同：7
> 
> 时间：2017-11-26T03:38:36.390

如果你想要不可修改的地图，最后 java 9`of`为`Map`接口添加了一个很酷的工厂方法。类似的方法也被添加到 Set、List 中。

`Map<String, String> unmodifiableMap = Map.of("key1", "value1", "key2", "value2");`

* * *

## 回答 #19

> 赞同：5
> 
> 时间：2009-02-03T16:31:26.677

您正在创建的匿名类运行良好。但是您应该知道这是一个*内部*类，因此它将包含对周围类实例的引用。所以你会发现你不能用它做某些事情（使用[XStream](http://xstream.codehaus.org/)之一）。你会得到一些非常奇怪的错误。

话虽如此，只要您知道，那么这种方法就可以了。我大部分时间都用它来以简洁的方式初始化各种集合。

编辑：在评论中正确指出这是一个静态类。显然我没有仔细阅读这个。*但是我*的评论仍然适用于匿名内部类。

* * *

## 回答 #20

> 赞同：5
> 
> 时间：2013-08-02T01:30:58.623

如果您想要一些简洁且相对安全的东西，您可以将编译时类型检查转移到运行时：

```
static final Map<String, Integer> map = MapUtils.unmodifiableMap(
    String.class, Integer.class,
    "cat",  4,
    "dog",  2,
    "frog", 17
); 
```

此实现应捕获任何错误：

```
import java.util.HashMap;

public abstract class MapUtils
{
    private MapUtils() { }

    public static <K, V> HashMap<K, V> unmodifiableMap(
            Class<? extends K> keyClazz,
            Class<? extends V> valClazz,
            Object...keyValues)
    {
        return Collections.<K, V>unmodifiableMap(makeMap(
            keyClazz,
            valClazz,
            keyValues));
    }

    public static <K, V> HashMap<K, V> makeMap(
            Class<? extends K> keyClazz,
            Class<? extends V> valClazz,
            Object...keyValues)
    {
        if (keyValues.length % 2 != 0)
        {
            throw new IllegalArgumentException(
                    "'keyValues' was formatted incorrectly!  "
                  + "(Expected an even length, but found '" + keyValues.length + "')");
        }

        HashMap<K, V> result = new HashMap<K, V>(keyValues.length / 2);

        for (int i = 0; i < keyValues.length;)
        {
            K key = cast(keyClazz, keyValues[i], i);
            ++i;
            V val = cast(valClazz, keyValues[i], i);
            ++i;
            result.put(key, val);
        }

        return result;
    }

    private static <T> T cast(Class<? extends T> clazz, Object object, int i)
    {
        try
        {
            return clazz.cast(object);
        }
        catch (ClassCastException e)
        {
            String objectName = (i % 2 == 0) ? "Key" : "Value";
            String format = "%s at index %d ('%s') wasn't assignable to type '%s'";
            throw new IllegalArgumentException(String.format(format, objectName, i, object.toString(), clazz.getSimpleName()), e);
        }
    }
} 
```

* * *

## 回答 #21

> 赞同：4
> 
> 时间：2015-11-20T00:26:24.170

在 Java 8 中，我开始使用以下模式：

```
private static final Map<String, Integer> MAP = Stream.of(
    new AbstractMap.SimpleImmutableEntry<>("key1", 1),
    new AbstractMap.SimpleImmutableEntry<>("key2", 2)
).collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue)); 
```

这不是最简洁和有点迂回的，但是

*   它不需要任何东西`java.util`
*   它是类型安全的，并且很容易适应不同类型的键和值。

* * *

## 回答 #22

> 赞同：4
> 
> 时间：2017-04-30T21:28:08.007

如果您只需要向地图添加一个值，则可以使用[Collections.singletonMap](https://docs.oracle.com/javase/7/docs/api/java/util/Collections.html#singletonMap(K,%20V))：

```
Map<K, V> map = Collections.singletonMap(key, value) 
```

* * *

## 回答 #23

> 赞同：4
> 
> 时间：2017-05-23T09:29:22.520

您的第二种方法*（双括号初始化）*被认为是一种[反模式](https://stackoverflow.com/q/1958636/1183010)，所以我会采用第一种方法。

初始化静态 Map 的另一种简单方法是使用此实用程序函数：

```
public static <K, V> Map<K, V> mapOf(Object... keyValues) {
    Map<K, V> map = new HashMap<>(keyValues.length / 2);

    for (int index = 0; index < keyValues.length / 2; index++) {
        map.put((K)keyValues[index * 2], (V)keyValues[index * 2 + 1]);
    }

    return map;
}

Map<Integer, String> map1 = mapOf(1, "value1", 2, "value2");
Map<String, String> map2 = mapOf("key1", "value1", "key2", "value2"); 
```

注意：在`Java 9`你可以使用[Map.of](http://download.java.net/java/jdk9/docs/api/java/util/Map.html#of-K-V-)

* * *

## 回答 #24

> 赞同：4
> 
> 时间：2017-06-20T17:28:06.330

您可以使用[`StickyMap`](http://static.javadoc.io/org.cactoos/cactoos/0.10/org/cactoos/list/StickyMap.html)and [`MapEntry`](http://static.javadoc.io/org.cactoos/cactoos/0.10/org/cactoos/list/MapEntry.html)from [Cactoos](http://www.cactoos.org)：

```
private static final Map<String, String> MAP = new StickyMap<>(
  new MapEntry<>("name", "Jeffrey"),
  new MapEntry<>("age", "35")
); 
```

* * *

## 回答 #25

> 赞同：3
> 
> 时间：2012-08-27T06:09:31.830

我不喜欢静态初始化器语法，也不相信匿名子类。一般来说，我同意使用静态初始化程序的所有缺点以及使用之前答案中提到的匿名子类的所有缺点。另一方面 - 这些帖子中介绍的专业人士对我来说还不够。我更喜欢使用静态初始化方法：

```
public class MyClass {
    private static final Map<Integer, String> myMap = prepareMap();

    private static Map<Integer, String> prepareMap() {
        Map<Integer, String> hashMap = new HashMap<>();
        hashMap.put(1, "one");
        hashMap.put(2, "two");

        return hashMap;
    }
} 
```

* * *

## 回答 #26

> 赞同：3
> 
> 时间：2015-06-03T20:46:29.060

我没有在任何答案中看到我使用（并且已经变得喜欢）的方法，所以这里是：

我不喜欢使用静态初始化器，因为它们很笨重，而且我不喜欢匿名类，因为它为每个实例创建一个新类。

相反，我更喜欢如下所示的初始化：

```
map(
    entry("keyA", "val1"),
    entry("keyB", "val2"),
    entry("keyC", "val3")
); 
```

不幸的是，这些方法不是标准 Java 库的一部分，因此您需要创建（或使用）一个定义以下方法的实用程序库：

```
 public static <K,V> Map<K,V> map(Map.Entry<K, ? extends V>... entries)
 public static <K,V> Map.Entry<K,V> entry(K key, V val) 
```

（您可以使用“导入静态”来避免需要为方法名称添加前缀）

我发现为其他集合（list、set、sortedSet、sortedMap 等）提供类似的静态方法很有用

它不如 json 对象初始化那么好，但就可读性而言，这是朝着这个方向迈出的一步。

* * *

## 回答 #27

> 赞同：3
> 
> 时间：2016-02-26T21:53:35.680

因为 Java 不支持映射文字，所以映射实例必须始终显式实例化和填充。

幸运的是，可以使用***工厂方法***来近似 Java 中映射文字的行为。

***例如：***

```
public class LiteralMapFactory {

    // Creates a map from a list of entries
    @SafeVarargs
    public static <K, V> Map<K, V> mapOf(Map.Entry<K, V>... entries) {
        LinkedHashMap<K, V> map = new LinkedHashMap<>();
        for (Map.Entry<K, V> entry : entries) {
            map.put(entry.getKey(), entry.getValue());
        }
        return map;
    }
    // Creates a map entry
    public static <K, V> Map.Entry<K, V> entry(K key, V value) {
        return new AbstractMap.SimpleEntry<>(key, value);
    }

    public static void main(String[] args) {
        System.out.println(mapOf(entry("a", 1), entry("b", 2), entry("c", 3)));
    }
} 
```

***输出：***

> {a=1, b=2, c=3}

这比一次创建和填充地图元素要方便得多。

* * *

## 回答 #28

> 赞同：2
> 
> 时间：2015-05-20T09:13:47.693

我已经阅读了答案，并决定编写自己的地图生成器。随意复制粘贴和享受。

```
import java.util.Collections;
import java.util.HashMap;
import java.util.Map;

/**
 * A tool for easy creation of a map. Code example:<br/>
 * {@code MapBuilder.of("name", "Forrest").and("surname", "Gump").build()}
 * @param <K> key type (inferred by constructor)
 * @param <V> value type (inferred by constructor)
 * @author Vlasec (for http://stackoverflow.com/a/30345279/1977151)
 */
public class MapBuilder <K, V> {
    private Map<K, V> map = new HashMap<>();

    /** Constructor that also enters the first entry. */
    private MapBuilder(K key, V value) {
        and(key, value);
    }

    /** Factory method that creates the builder and enters the first entry. */
    public static <A, B> MapBuilder<A, B> mapOf(A key, B value) {
        return new MapBuilder<>(key, value);
    }

    /** Puts the key-value pair to the map and returns itself for method chaining */
    public MapBuilder<K, V> and(K key, V value) {
        map.put(key, value);
        return this;
    }

    /**
     * If no reference to builder is kept and both the key and value types are immutable,
     * the resulting map is immutable.
     * @return contents of MapBuilder as an unmodifiable map.
     */
    public Map<K, V> build() {
        return Collections.unmodifiableMap(map);
    }
} 
```

`of`编辑：最近，我经常发现公共静态方法，我有点喜欢它。我将它添加到代码中并将构造函数设为私有，从而切换到静态工厂方法模式。

EDIT2：甚至最近，我不再喜欢调用静态方法`of`，因为使用静态导入时它看起来很糟糕。我将其重命名为`mapOf`，使其更适合静态导入。

* * *

## 回答 #29

> 赞同：2
> 
> 时间：2016-04-10T15:08:52.067

[JEP 269](http://openjdk.java.net/jeps/269)为 Collections API 提供了一些便利的工厂方法。该工厂方法不在当前的 Java 版本中，即 8，但计划在 Java 9 版本中发布。

因为`Map`有两种工厂方法：`of`和`ofEntries`. 使用`of`，您可以传递交替的键/值对。例如，为了创建一个`Map`like `{age: 27, major: cs}`：

```
Map<String, Object> info = Map.of("age", 27, "major", "cs"); 
```

目前有十个重载版本`of`，因此您可以创建一个包含十个键/值对的映射。如果您不喜欢此限制或交替键/值，您可以使用`ofEntries`：

```
Map<String, Object> info = Map.ofEntries(
                Map.entry("age", 27),
                Map.entry("major", "cs")
); 
```

两者`of`和`ofEntries`都会返回一个不可变的`Map`，所以你不能在构造后改变它们的元素。[您可以使用JDK 9 Early Access](https://jdk9.java.net/jigsaw/)试用这些功能。

* * *

## 回答 #30

> 赞同：2
> 
> 时间：2017-10-25T16:28:13.200

嗯...我喜欢枚举；）

```
enum MyEnum {
    ONE   (1, "one"),
    TWO   (2, "two"),
    THREE (3, "three");

    int value;
    String name;

    MyEnum(int value, String name) {
        this.value = value;
        this.name = name;
    }

    static final Map<Integer, String> MAP = Stream.of( values() )
            .collect( Collectors.toMap( e -> e.value, e -> e.name ) );
} 
```

* * *

## 回答 #31

> 赞同：1
> 
> 时间：2015-01-28T21:35:25.137

当我有一个抽象类的具体实现时，我喜欢使用静态初始化程序“技术”，该类定义了一个初始化构造函数但没有默认构造函数，但我希望我的子类有一个默认构造函数。

例如：

```
public abstract class Shape {

    public static final String COLOR_KEY = "color_key";
    public static final String OPAQUE_KEY = "opaque_key";

    private final String color;
    private final Boolean opaque;

    /**
     * Initializing constructor - note no default constructor.
     *
     * @param properties a collection of Shape properties
     */
    public Shape(Map<String, Object> properties) {
        color = ((String) properties.getOrDefault(COLOR_KEY, "black"));
        opaque = (Boolean) properties.getOrDefault(OPAQUE_KEY, false);
    }

    /**
     * Color property accessor method.
     *
     * @return the color of this Shape
     */
    public String getColor() {
        return color;
    }

    /**
     * Opaque property accessor method.
     *
     * @return true if this Shape is opaque, false otherwise
     */
    public Boolean isOpaque() {
        return opaque;
    }
} 
```

和我对这个类的具体实现——但它需要/需要一个默认构造函数：

```
public class SquareShapeImpl extends Shape {

    private static final Map<String, Object> DEFAULT_PROPS = new HashMap<>();

    static {
        DEFAULT_PROPS.put(Shape.COLOR_KEY, "yellow");
        DEFAULT_PROPS.put(Shape.OPAQUE_KEY, false);
    }

    /**
     * Default constructor -- intializes this square to be a translucent yellow
     */
    public SquareShapeImpl() {
        // the static initializer was useful here because the call to 
        // this(...) must be the first statement in this constructor
        // i.e., we can't be mucking around and creating a map here
        this(DEFAULT_PROPS);
    }

    /**
     * Initializing constructor -- create a Square with the given
     * collection of properties.
     *
     * @param props a collection of properties for this SquareShapeImpl
     */
    public SquareShapeImpl(Map<String, Object> props) {
        super(props);
    }
} 
```

然后要使用这个默认构造函数，我们只需执行以下操作：

```
public class StaticInitDemo {

    public static void main(String[] args) {

        // create a translucent, yellow square...
        Shape defaultSquare = new SquareShapeImpl();

        // etc...
    }
} 
```

* * *

## 回答 #32

> 赞同：1
> 
> 时间：2018-09-10T23:59:34.177

注意：这个答案实际上属于问题[如何直接初始化 HashMap（以字面方式）？](https://stackoverflow.com/q/6802483/1744774)但是由于在撰写本文时它被***标记**为与此重复...*

* * *

在 Java 9 及其[Map.of()](https://docs.oracle.com/javase/9/docs/api/java/util/Map.html#of-K-V-K-V-K-V-K-V-K-V-K-V-K-V-K-V-K-V-K-V-)之前（也仅限于 10 个映射），您可以扩展`Map`您选择的实现，例如：

```
public class InitHashMap<K, V> extends HashMap<K, V> 
```

重新实现`HashMap`的构造函数：

```
public InitHashMap() {
    super();
}

public InitHashMap( int initialCapacity, float loadFactor ) {
    super( initialCapacity, loadFactor );
}

public InitHashMap( int initialCapacity ) {
    super( initialCapacity );
}

public InitHashMap( Map<? extends K, ? extends V> map ) {
    super( map );
} 
```

并添加一个受[Aerthel 答案](https://stackoverflow.com/a/17474581/1744774)启发但通过使用`Object...`和`<K, V>`类型通用的构造函数：

```
public InitHashMap( final Object... keyValuePairs ) {

    if ( keyValuePairs.length % 2 != 0 )
        throw new IllegalArgumentException( "Uneven number of arguments." );

    K key = null;
    int i = -1;

    for ( final Object keyOrValue : keyValuePairs )
        switch ( ++i % 2 ) {
            case 0:  // key
                if ( keyOrValue == null )
                    throw new IllegalArgumentException( "Key[" + (i >>> 1) + "] is <null>." );
                key = (K) keyOrValue;
                continue;
            case 1:  // value
                put( key, (V) keyOrValue );
        }
} 
```

### 跑

```
public static void main( final String[] args ) {

    final Map<Integer, String> map = new InitHashMap<>( 1, "First", 2, "Second", 3, "Third" );
    System.out.println( map );
} 
```

### 输出

```
{1=First, 2=Second, 3=Third} 
```

* * *

您也可以`Map`同样扩展接口：

```
public interface InitMap<K, V> extends Map<K, V> {

    static <K, V> Map<K, V> of( final Object... keyValuePairs ) {

        if ( keyValuePairs.length % 2 != 0 )
            throw new IllegalArgumentException( "Uneven number of arguments." );

        final Map<K, V> map = new HashMap<>( keyValuePairs.length >>> 1, .75f );
        K key = null;
        int i = -1;

        for ( final Object keyOrValue : keyValuePairs )
            switch ( ++i % 2 ) {
                case 0: // key
                    if ( keyOrValue == null )
                        throw new IllegalArgumentException( "Key[" + (i >>> 1) + "] is <null>." );
                    key = (K) keyOrValue;
                    continue;
                case 1: // value
                    map.put( key, (V) keyOrValue );
            }
        return map;
    }
} 
```

### 跑

```
public static void main( final String[] args ) {

    System.out.println( InitMap.of( 1, "First", 2, "Second", 3, "Third" ) );
} 
```

### 输出

```
{1=First, 2=Second, 3=Third} 
```

* * *

## 回答 #33

> 赞同：1
> 
> 时间：2019-06-25T08:39:48.030

这个使用 Apache commons-lang，它很可能已经在您的类路径中：

```
Map<String, String> collect = Stream.of(
        Pair.of("hello", "world"),
        Pair.of("abc", "123"),
        Pair.of("java", "eight")
).collect(Collectors.toMap(Pair::getKey, Pair::getValue)); 
```

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2009-02-03T15:45:34.260

如果需要，第二种方法可以调用受保护的方法。这对于初始化构造后不可变的类很有用。

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2009-02-03T16:18:07.047

我喜欢匿名类语法；它只是更少的代码。但是，我发现的一个主要问题是您将无法通过远程处理来序列化该对象。您将收到关于无法在远程端找到匿名类的异常。

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2009-02-03T18:40:56.433

我做了一些不同的事情。不是最好的，但它对我有用。也许它可以“通用化”。

```
private static final Object[][] ENTRIES =
{
  {new Integer(1), "one"},
  {new Integer(2), "two"},
};
private static final Map myMap = newMap(ENTRIES);

private static Map newMap(Object[][] entries)
{
  Map map = new HashMap();

  for (int x = 0; x < entries.length; x++)
  {
    Object[] entry = entries[x];

    map.put(entry[0], entry[1]);
  }

  return map;
} 
```

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2014-01-13T04:39:14.663

如果您可以使用字符串表示您的数据，这也是 Java 8 中的一个选项：

```
static Map<Integer, String> MAP = Stream.of(
        "1=one",
        "2=two"
).collect(Collectors.toMap(k -> Integer.parseInt(k.split("=")[0]), v -> v.split("=")[1])); 
```

* * *

## 回答 #38

> 赞同：0
> 
> 时间：2014-04-16T07:32:03.843

现在 Java 8 已经发布，这个问题值得重新审视。我试了一下——看起来也许你可以利用 lambda 表达式语法来获得一个非常漂亮和简洁（但类型安全）的映射文字语法，如下所示：

```
Map<String,Object> myMap = hashMap(
    bob -> 5,
    TheGimp -> 8,
    incredibleKoolAid -> "James Taylor",
    heyArnold -> new Date()
);

Map<String,Integer> typesafeMap = treeMap(
    a -> 5,
    bee -> 8,
    sea -> 13
    deep -> 21
); 
```

[https://gist.github.com/galdosd/10823529](https://gist.github.com/galdosd/10823529)上未经测试的示例代码 会很好奇其他人对此的看法（这有点邪恶......）

* * *

## 回答 #39

> 赞同：0
> 
> 时间：2015-08-06T16:10:30.540

在 Java 8 中，程序方法也可以包装在`Supplier`：

```
Map<String,String> m = ((Supplier<Map<String,String>>)(() -> {
    Map<String,String> result = new HashMap<>();
    result.put("foo","hoo");
    ...
    return result;
)).get(); 
```

这只是假设的方式，但如果您真的需要单线，它可以派上用场。

* * *

## 回答 #40

> 赞同：0
> 
> 时间：2016-01-28T16:20:21.027

这里有一些很好的答案，但我确实想再提供一个。

创建自己的静态方法来创建和初始化`Map`. 我在一个包中有自己的`CollectionUtils`类，我在项目中使用我经常使用的各种实用程序，这些实用程序很容易编写，并且避免了对某些更大库的依赖。

这是我的`newMap`方法：

```
public class CollectionUtils {
    public static Map newMap(Object... keyValuePairs) {
        Map map = new HashMap();
        if ( keyValuePairs.length % 2 == 1 ) throw new IllegalArgumentException("Must have even number of arguments");
        for ( int i=0; i<keyValuePairs.length; i+=2 ) {
            map.put(keyValuePairs[i], keyValuePairs[i + 1]);
        }
        return map;
    }
} 
```

用法：

```
import static CollectionUtils.newMap;
// ...
Map aMap = newMap("key1", 1.23, "key2", 2.34);
Map bMap = newMap(objKey1, objVal1, objKey2, objVal2, objKey3, objVal3);
// etc... 
```

它不使用泛型，但您可以根据需要对地图进行类型转换（只要确保正确地进行类型转换！）

```
Map<String,Double> aMap = (Map<String,Double>)newMap("key1", 1.23, "key2", 2.34); 
```

* * *

## 回答 #41

> 赞同：0
> 
> 时间：2016-11-28T23:17:00.143

这是[AbacusUtil的代码](https://github.com/landawn/AbacusUtil)

```
Map<Integer, String> map = N.asMap(1, "one", 2, "two");
// Or for Immutable map 
ImmutableMap<Integer, String> = ImmutableMap.of(1, "one", 2, "two"); 
```

声明：我是AbacusUtil的开发者。

* * *

## 回答 #42

> 赞同：0
> 
> 时间：2016-11-30T01:16:09.423

即使使用 Guava 不错的 ImmutableMap 类，有时我也想流畅地构建可变映射。发现自己想要避免静态块和匿名子类型的事情，当 Java 8 出现时，我编写了一个名为[Fluent](https://github.com/alexheretic/fluent)的小型库来提供帮助。

```
// simple usage, assuming someMap is a Map<String, String> already declared
Map<String, String> example = new Fluent.HashMap<String, String>()
    .append("key1", "val1")
    .append("key2", "val2")
    .appendAll(someMap); 
```

使用默认的 Java 8 接口，我可以为所有标准 Java Map 实现（即 HashMap、ConcurrentSkipListMap 等）实现 Fluent.Map 方法，而无需繁琐的重复。

不可修改的地图也很简单。

```
Map<String, Integer> immutable = new Fluent.LinkedHashMap<String, Integer>()
    .append("one", 1)
    .append("two", 2)
    .append("three", 3)
    .unmodifiable(); 
```

有关源代码、文档和示例，请参阅[https://github.com/alexheretic/fluent](https://github.com/alexheretic/fluent)。

* * *

## 回答 #43

> 赞同：0
> 
> 时间：2020-11-19T13:52:16.997

带有流的 Java 8：

```
 private static final Map<String, TemplateOpts> templates = new HashMap<>();

    static {
        Arrays.stream(new String[][]{
                {CUSTOMER_CSV, "Plantilla cliente", "csv"}
        }).forEach(f -> templates.put(f[0], new TemplateOpts(f[1], f[2])));
    } 
```

它也可以是 Object[][] 将任何内容放入其中并将其映射到 forEach 循环中

# css - 使用带和不带回车的无序列表的菜单在 IE 6 中有所不同

> ID：507606
> 
> 赞同：2
> 
> 时间：2009-02-03T15:42:23.500
> 
> 标签：css, cross-browser, internet-explorer-6

我为标题道歉，我真的不知道更好的表达方式（如果你有更好的方式，请告诉我，我会改变它）。请考虑以下代码：

```
<html>
    <head>
        <title>IE 6 Menu Test</title>
        <style type="text/css">
            .nMenu {
                border: 1px solid black;
            }

            .nMenu ul {
                margin: 0;
                padding: 0;
                list-style-type: none;
            }

            .nMenu a {
                display: block;
                padding: 3px 0px 3px 5px;
                background-color: #fff;
                border-bottom: 1px solid #eee;
                font-weight: bold;
                text-decoration: none;
            }

            .nMenu a:hover {
                background-color: #dddddd;
            }
        </style>
    </head>
    <body>
        <div class="nMenu">
            <ul>
                <li><a href="">One</a></li><li><a href="">Two</a></li><li><a href="">Three</a></li><li><a href="">Four</a></li><li><a href="">Five</a></li>
            </ul>                        
        </div>

        <hr />

        <div class="nMenu">
            <ul>
                <li><a href="">One</a></li>
                <li><a href="">Two</a></li>
                <li><a href="">Three</a></li>
                <li><a href="">Four</a></li>
                <li><a href="">Five</a></li>
            </ul>                        
        </div>
    </body>
</html> 
```

在 Firefox 中，顶部和底部菜单的显示完全相同。但在 IE6 中，底部版本与顶部相同，除了每个列表元素后的回车符外，每个元素上方都有额外的填充显示。没有回车的顶级版本没有。当滚动底部列表中的项目时，这一点尤其明显（额外的填充）。

似乎 IE6 出于某种原因正在呈现回车。现在我们只是像上面的例子一样格式化我们的代码，但这并不理想。我们可以在 CSS 中添加一些东西以使其在 IE6 中看起来合适吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T15:57:10.227

应用于`display: block;`，`li`告诉 IE6 使`a`宽度为 100%，并告诉所有浏览器将 显示`a`为块。

```
.n菜单里{
    显示：块；
}

/* 破解 IE6 */
* html .n菜单
{
    宽度：100%
}

.n菜单一个{
    显示：块；
    填充：3px 0px 3px 5px；
    背景颜色：#fff；
    边框底部：1px 实心#eee；
    字体粗细：粗体；
    文字装饰：无；
}

```

在 IE6 中尝试过，两个列表看起来相同，在 Firefox 中呈现完全相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T15:49:00.883

我没有解决主要问题的方法，但是您可以更改代码格式以使其看起来更好，并且仍然可以在 IE 6 中工作。

```
<div class="nMenu">
    <ul>
        <li><a href="">One</a></li
        ><li><a href="">Two</a></li
        ><li><a href="">Three</a></li
        ><li><a href="">Four</a></li
        ><li><a href="">Five</a></li>
    </ul>                                           
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T15:49:58.073

尝试添加`overflow: hidden;`到`.nMenu li`.

# silverlight - 如何在 MouseEnter 上设置列表框项的 ZIndex？

> ID：507613
> 
> 赞同：1
> 
> 时间：2009-02-03T15:43:01.300
> 
> 标签：silverlight, listbox, silverlight-2.0

我在 MouseOver 上的列表框中的项目有不同的样式，这会产生轻微的缩放效果。这很好用，但是由于 ZIndex 是按照将项目添加到 ListBox 的顺序设置的，因此缩放的项目将被绘制在下一个项目的后面。我想将其设置为使缩放的项目位于顶部。

我试过创建一个 MouseOver 事件处理程序，并像这样设置 ZIndexProperty

```
 private void ListItem_MouseEnter(object sender, MouseEventArgs e)
    {
        var grid = sender as Grid;            
        grid.SetValue(Canvas.ZIndexProperty, 5);
    } 
```

这不起作用，如果我检查 ZIndex 而不设置它，我总是得到 0 所以就像我没有看到正确的值一样。如何修改正确的 ZIndexProperty？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T22:06:06.127

您没有包含相关的 Xaml，因此我很难判断 ListItem_MouseEnter 是什么事件的处理程序。如果它是 ListBoxItem 的 MouseEnter 事件的处理程序，则发送者将不是 Grid。

要在 MouseOver 上更改 ListBoxItem 的 ZIndex，Xaml 和下面的代码将起作用：

页面.xaml

```
<UserControl x:Class="SilverlightApplication1.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
    Width="400" Height="300">
    <Grid x:Name="LayoutRoot" Background="White">
        <ListBox x:Name="ListBox1">
            <ListBoxItem Content="Test 1" MouseEnter="ListBoxItem_MouseEnter" />
            <ListBoxItem Content="Test 2" MouseEnter="ListBoxItem_MouseEnter" />
            <ListBoxItem Content="Test 3" MouseEnter="ListBoxItem_MouseEnter" />
            <ListBoxItem Content="Test 4" MouseEnter="ListBoxItem_MouseEnter" />
        </ListBox>
    </Grid>
</UserControl> 
```

页面.xaml.cs：

```
using System;
using System.Windows.Controls;
using System.Windows.Input;

namespace SilverlightApplication1
{
    public partial class Page : UserControl
    {
        public Page()
        {
            InitializeComponent();
        }

        private void ListBoxItem_MouseEnter(object sender, MouseEventArgs e)
        {
            ListBoxItem listBoxItem = (ListBoxItem)sender;

            listBoxItem.SetValue(Canvas.ZIndexProperty, 5);
        }
    }
} 
```

请注意，事件处理程序针对每个 ListBoxItem 的 MouseEnter 事件，这意味着发送者是 ListBoxItem。

ListBoxItem_MouseEnter 方法将 MouseEnter 上的 Zindex 更改为 5，使用[Silverlight Spy](http://silverlightspy.com/silverlightspy/)进行验证。

# sharepoint - SharePoint：备份单页

> ID：507620
> 
> 赞同：4
> 
> 时间：2009-02-03T15:44:26.117
> 
> 标签：sharepoint, sharepoint-designer

我需要备份一个包含 Web 部件和其他 html 调整的共享点网页。我想在适当的位置使用 Web 部件备份页面本身，这可能吗？现在我刚刚打开了 SharePoint 设计器，打开了我的页面并保存到了我的硬盘中。还有其他方法吗？这是页面的完整备份吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T15:53:31.123

我对小改动也做同样的事情，到目前为止它对我来说效果很好。也就是说，唯一的官方方法是使用 Microsoft 的 Data Protection Manager 软件，它可以让您备份/恢复单个页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-12-16T21:25:28.983

Of course you can go the doclib where the page is stored and use the ECB SendTo>>Download a copy

the interesting part of this approach is that you get the ASP.NET markup (w/server control specs)...

# tfs - TFS 中的孤立分支

> ID：507623
> 
> 赞同：11
> 
> 时间：2009-02-03T15:45:24.227
> 
> 标签：tfs, version-control, merge, branch

我们在 TFS 中有一个主干，每个人都在工作，直到我们需要分支为止。我们的上一个项目是一个需要分支的大型功能。现在开发已经完成，更改已合并回主干。开发分支应该发生什么？

我应该删除它吗？以某种方式将其标记为只读？隐藏和锁定呢？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-03T19:18:17.700

您*可以*将分支设为只读。您只需要从相应的组中删除签入/签出权限。请注意，它在第一次脸红时看起来没有任何不同，但是当您尝试签出文件时，您将被阻止。

我总是最终删除分支。它被“删除”了，但没有什么可以阻止您取消删除它（这与销毁不同）或查看代码。除非你努力摧毁它，否则它实际上不会去任何地方。

此外，如果您有像[Team Foundation Sidekicks](http://www.attrice.info/cm/tfs/)这样的好工具，您仍然可以看到所有分支历史记录，即使它已被删除。

正如@Ray 所说，你可以离开它，但如果你在十几个分支的过程中这样做，事情就会变得有点难以管理。如果分支已死，并且您已将代码合并到主线中，那么除了“以防万一”之外，您是否还有其他目的保留它。

如果是这样，只需将其删除并仅在您确实需要时重新挖掘它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T15:49:18.760

就别管了。:) 您可以删除分支，但它仍将保留在存储库中。这确实是您和您的团队可以做出的决定，以遵循您的源代码控制指南。

附带说明一下，TFS 中没有只读选项，您只能将其保留、删除或运行 TFS destroy 命令以永久删除分支。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-11T23:30:12.580

有一个读取访问控制权限。如果您将贡献者设置为“拒绝”，它应该覆盖任何“未设置”或“允许”权限。您可以通过右键单击文件夹并进入高级 | 在源代码管理资源管理器中进行设置。安全...

# wordpress - Wordpress 中的高级链接类别功能

> ID：507628
> 
> 赞同：0
> 
> 时间：2009-02-03T15:45:42.697
> 
> 标签：wordpress

我一直在摆弄 Wordpress，我意识到链接和链接类别提供的功能很少。

例如，我想在一个页面中显示某个链接类别中的所有链接，而不是任何其他链接。在剩下的页面中，我想显示除已说明类别的链接之外的每个链接。

我可以想到一种愚蠢的方法，使用简单的“文本小部件”并在 HTML 中制作列表，但我想知道是否有更聪明的方法。就像一种能够选择我希望在“链接”小部件上显示哪些链接类别的方式。拥有多个此类小部件的方法也可以很好地将链接划分为多个侧边栏。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T16:59:16.560

您可以根据链接类别过滤链接，因此如果您有一个类别 foo，您可以通过使用获取 foo 中的所有链接。

`<?php wp_list_bookmarks('title_li=&categorize=0&category_name=foo' ); ?>`

Foo 也可以是一个变量，因此您可以确定您所在的页面并根据标题过滤您的列表。在这种情况下，如果我在一个名为 bar 的帖子或页面上，输出将是 bar 类别中的所有链接。

`<?php wp_list_bookmarks('title_li=&categorize=0&category_name='.$post->post_title ); ?>`

# c# - Reporting Services - 在 C# WinForm 中呈现到 Excel

> ID：507630
> 
> 赞同：2
> 
> 时间：2009-02-03T15:45:44.943
> 
> 标签：c#, excel, reporting-services, export

我有一个 WinForms 应用程序，它可以调用并显示许多报告服务报告。我可以打电话给

```
LocalReport.Render("Excel", null, out mimeType, out encoding, out filenameExtension, out streamids, out warnings); 
```

方法 - 写入 byte[] 数组，但会引发异常

> 尚未指定报告定义的来源。

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-03-29T18:25:19.933

使用以下参数作为第二个参数。

```
<DeviceInfo><Toolbar>False</Toolbar></DeviceInfo> 
```

您需要使用以下内容设置报告：

```
var MyInfo = MyRS.LoadReport("/" + reportPath, null);
var ReportDeviceInfo = @"<DeviceInfo><Toolbar>False</Toolbar></DeviceInfo>";
String ExtensionValue = String.Empty;
String EncodingValue = String.Empty;
String MimeTypeValue = String.Empty;
Warning[] WarningValue = null;
String[] StreamIDsValue = null;

var Result = MyRS.Render("Excel", ReportDeviceInfo, out ExtensionValue, out EncodingValue, out MimeTypeValue, out WarningValue, out StreamIDsValue); 
```

# grails - 学习Grails的动手学习计划

> ID：507634
> 
> 赞同：11
> 
> 时间：2009-02-03T15:46:31.183
> 
> 标签：grails

我是一名尝试学习 Grails 的 Java 开发人员，我希望尽可能多地接触 Grails 框架的各个部分。最好通过使用“Grails 方法”（DRY、convention-over-configuration 等）解决实际的小问题来做到这一点。

三个例子可以是：

*   通过创建一些类（例如 Movie、Actor 等）和它们之间的关系/映射（1:1、1:N、N:N 等）来了解 GORM。
*   通过使用它生成网站上所有 GSP:s 通用的页眉和页脚来了解布局支持 (sitemesh)。
*   通过使用它来了解过滤器支持，以确保对某个控制器的所有访问都来自经过身份验证的用户。

我的问题是针对所有 Grails 开发人员的——您会在“Grails 课程”中包含哪些内容以及按什么顺序？

所有输入表示赞赏！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-07T09:16:04.680

这是一些示例，但请注意它们相当琐碎，并不能真正向您展示系统如何协同工作。Grails 的优势之一是所有不同的部分都结合在一起可以降低代码复杂性并加快开发速度。我建议你做一个中等大小的项目（比如博客软件或照片库），它迫使你几乎接触所有东西。我目前正在开发一个工单管理应用程序，而且我基本上必须学习框架中的所有内容。实际上，它真的没有那么多材料。

话虽如此，这是我的“必须学习”清单，以及一些示例：

1.  Groovy，尤其是闭包、映射和属性。如果您来自 Java，起初可能会觉得闭包有点奇怪。然而，一旦你把头绕在它们周围，就很难回到不使用它们的语言。地图和属性使用的想法可能很熟悉，但语法和用法不同，值得仔细研究。Grails 在整个框架中始终使用这三样东西。举个很好的例子，检查实例化在 resources.groovy 中定义的 Spring bean 的“BeanBuilder”。此外，浏览 groovy.codehaus.org 上的 Groovy 文档。在那里呆上几个小时可以为您节省几天的时间。

2.  MVC programming. The "MVC" model in Grails pretty closely matches the one used in Rails, but it's significantly different than the "MVC" model used in Java desktop applications. Basically, all incoming URL requests are a message to a controller, which returns a view. Domain objects are the data that you want to store, view, and manipulate through views and controllers. Do an input form that validates the user's input using constraints, and then manipulates it somehow using a controller. Something like a page that takes in your birthday, and returns your Zodiac sign and Chinese Zodiac animal. See if you can get it to return errors to the user when bad input is given.

3.  GORM. GORM is super-important, but you'll be forced to learn it with virtually any project you pick. Give the documentation a once-over, just so you know what its' capabilities are.

4.  Filters and Services. These are "the grails way" to do a lot of DRY programming. Authentication is a canonical example, and it's perfect for learning filters. For services, write something that will send out email. There's a great example of a simple emailer service on the Grails website.

5.  Groovy Server Pages. If you've worked with a templating engine before, then this should seem familiar. Get to know the GSP tag library, it's a huge help. Practical examples include: virtually anything. Every application needs a front-end. Try and make it pretty. NOTE: This spills into a lot of stuff that isn't Grails-specific, like JavaScript, CSS, etc. Unless you have that knowledge already, prepare for a bit of a learning curve.

6.  Your "conf" directory. Get to know every file in there, especially UrlMappings.groovy. Play with UrlMappings so that you have an app that takes meaningful information from the URL. Something like `/myapp/calculate/36/times/145`, where the app returns an answer.

I'd say those are the basics, but there's a lot of other topics like webflows, i18n, testing, session handling, and so on. The best way to learn those is by building a decent sized project. While you're doing that, you'll probably find yourself thinking, "Gosh, I wish that Grails did ____". Read through the excellent documentation on Grails.org, and you'll probably find a built-in capability or plugin that does what you want. The reference PDF lives on my desktop, and I've found it invaluable during my learning experience.

Oh, and look at the scaffolding code that Grails generates. You'll probably end up pitching it all out, but it'll give you a good idea of how the system works.

Have fun, and happy hacking!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-08-28T16:28:57.537

**Step 1 - Learn Groovy**

If you already know Java, I highly recommend [Programming Groovy](https://rads.stackoverflow.com/amzn/click/com/1934356093). It's a lot more concise and up-to-date than the otherwise excellent [Groovy in Action](https://rads.stackoverflow.com/amzn/click/com/1932394842). Neither of these books cover the significant language changes in Groovy 1.6, so you should also read [this page](http://www.infoq.com/articles/groovy-1-6).

**Step 2 - Learn Grails**

[The Definitive Guide to Grails](http://www.apress.com/book/view/1590599950) is probably the standard Grails reference - make sure you get the second edition. [Grails in Action](https://rads.stackoverflow.com/amzn/click/com/1933988932) is slightly more recent, but I haven't read it so can't comment further on it. I found TDGTG a little lighton GORM, so you might also consider checking out [Grails Persistence with GORM and GSQL](https://rads.stackoverflow.com/amzn/click/com/1430219262). It's a *very* short book, but worth it's weight in gold.

**Step 3 - Dive In**

Try and modify the sample app in the Grails book, or build your own from scratch. The [Groovy console](http://groovyconsole.appspot.com/) is a great way to experiment with snippets of Groovy code.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T16:35:11.507

如果读者不熟悉**Groovy**编程，那么应该对其进行介绍。Java 可以工作，但是当您看到 Groovy 中的代码不那么冗长时，它就会变得更高效。在讨论**GORM**时包括**约束**以及它们如何影响**验证**。**在开始一个新项目时，脚手架**可以节省时间，所以一定要包括它。Grails 真正帮助我的特性之一是**Plug-ins**。挑选一些并展示他们如何在节省开发时间的同时提供解决方案。**安全**插件将适合您提到的过滤器主题**。****测试**，是否有足够的测试？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T14:18:15.773

I would really recommend reading the [Definite Guide to Grails, Second Edition](http://www.apress.com/book/view/1590599950). It covers everything you need to know about **writing** applications in Grails. It probably lacks the "what happens under the hood" knowledge, but you should get the hang of it. You can buy it as a PDF and start reading it immediately.

You should also have a list of plug-ins to use - Grails has some really nice ones that come in handy. I can tell you some of the ones I use, but that may be a good question here, too. :-)

# bash - Makefile 中的函数

> ID：507641
> 
> 赞同：52
> 
> 时间：2009-02-03T15:47:53.100
> 
> 标签：bash, function, makefile, gnu-make

我正在编写一个包含很多重复内容的 Makefile，例如

```
debug_ifort_Linux:
        if [ $(UNAME) = Linux ]; then                           \
          $(MAKE) FC=ifort FFLAGS=$(difort) PETSC_FFLAGS="..."  \
                  TARGET=$@ LEXT="ifort_$(UNAME)" -e syst;      \
        else                                                    \
          echo $(err_arch);                                     \
          exit 1;                                               \
        fi 
```

在定义目标“syst”的地方，定义了变量“UNAME”（通常是 Linux，但也可能是 Cygwin 或 OSF1），还定义了变量“difort”和“err_arch”。这段代码被多次用于不同的编译器目标（使用命名约定 '*'）。由于这是大量的冗余代码，我希望能够以更简单的方式编写它。例如，我想做这样的事情：*

 *```
debug_ifort_Linux:
        compile(uname,compiler,flags,petsc_flags,target,lext) 
```

其中 compile 可以是根据参数执行上述代码的函数。有谁知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-12-22T02:17:34.077

有3个相关概念：

1.  [`call`功能](http://www.gnu.org/software/make/manual/html_node/Call-Function.html)
2.  [多行变量](http://www.gnu.org/software/make/manual/html_node/Multi_002dLine.html)
3.  [条件句](http://www.gnu.org/software/make/manual/html_node/Conditionals.html#Conditionals)

重构后的结果可能如下所示：

```
ifeq ($(UNAME),Linux)
    compile = $(MAKE) FC=$(1) FFLAGS=$(2) PETSC_FFLAGS=$(3) \
                      TARGET=$@ LEXT="$(1)_$(UNAME)" -e syst
else
    define compile =
        echo $(err_arch)
        exit 1
    endef
endif

debug_ifort:
        $(call compile,ifort,$(difort),"...") 
```

剩下`\`的就是继续`$(MAKE)`shell的行。这里不需要多行变量，因为它只是一行 shell 代码。多行变量仅在 else 块中使用。

如果您不需要参数，您可以使用 := 分配并使用扩展方法`$(compile)`（参见[罐头食谱](http://www.gnu.org/software/make/manual/html_node/Canned-Recipes.html#Canned-Recipes)）

*注意：*在版本 3.82 之前使用 make，在我的定义语句末尾无法识别 =。我通过改用来解决这个问题`define compile`。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-02-03T15:59:59.113

您正在寻找[`call`功能](http://www.gnu.org/software/make/manual/html_node/Call-Function.html)。

```
compile =                                                 \
        if [ $(UNAME) = $(1) ]; then                      \
          $(MAKE) FC=$(2) FFLAGS=$(3) PETSC_FFLAGS="..."  \
                  TARGET=$@ LEXT="$(4)_$(UNAME)" -e syst; \
        else                                              \
          echo $(err_arch);                               \
          exit 1;                                         \
        fi

debug_ifort_Linux:
        $(call compile,Linux,ifort,$(difort),ifort) 
```

但是，如果您可以重组您`Makefile`的一点，您应该看看是否可以使用`make`'[条件](http://www.gnu.org/software/make/manual/html_node/Conditional-Syntax.html)而不是`sh`'。

# oop - 除了经典的基于类的方法之外，您能想象任何其他实现 OO 的方法吗？

> ID：507643
> 
> 赞同：5
> 
> 时间：2009-02-03T15:48:18.683
> 
> 标签：oop, class

我最近一直在思考基于类的面向对象方法的替代方案。在今天的语言中让我感到困扰的一件事是，我们经常使用[静态类/单例来设计单个（全局）对象](https://stackoverflow.com/questions/505550/dont-static-members-make-classes-kind-of-global-objects-themselves)，因为没有其他方法可以做到这一点，所以在我看来，这与其说是一种功能，不如说是一种 hack。另一件事是，例如，Java 允许程序员[拥有带有附加数据（全局状态）和功能的枚举，](http://www.artima.com/forums/flat.jsp?forum=106&thread=128338)这也使它们在我眼中也是一种对象。

无论如何，我想知道的是，您是否有任何想法，可以在编译和高效的语言中采用不同的面向对象方法（因此，通过原型创建对象可能不是一个好主意），或者，如果您没有有什么，经典的OO方法中是否有一些东西也让你很烦恼。

[编辑]：只是为了让事情清楚。如上所述，我已经知道基于原型的编程。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-03T15:51:08.273

查看[基于原型的编程](http://en.wikipedia.org/wiki/Prototype-based_programming)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T15:54:22.213

看看[演员模型](http://en.wikipedia.org/wiki/Actor_model)。除了异步之外，它类似于类。如果每个参与者都是有限状态机，那么您将拥有一个潜在的强大系统。

有人告诉我，Erlang 使用类似的东西……至少类似。Actor 模型的关键在于它不需要纯粹实现，因此不需要成为 Erlang 的一部分。

几年前，我开始使用该模型一次的小型语言。我可能会再试一次。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-03T15:59:27.897

现在我的阻燃服已安全固定，我可以说：我不喜欢 OOP。

我遇到的核心问题是它试图提出一个单一的分类法，每个功能单元都真正属于该分类法。

这有几个问题。首先，产生一个好的分类是*困难*的。人们不擅长创造它们。其次，我不相信您实际上可以构建一个合理的、可维护的层次结构，以承受包含大量实体的项目中的变化；重构的整个实践基本上是承认创建大型的、所有不包括在内的分类法的难度。

实际上，我认为 OOP 被过度设计了。你可以用 OOP 做的所有事情都可以用高阶函数 (HOF) 来完成。对于 OOP 试图解决的相同问题，HOF 是更优雅、更灵活的解决方案。

因此，如果您要问另一种方法来做 OOP 风格的东西，HOF 可能是最接近的替代技术，具有类似的灵活性水平。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T15:58:32.047

我认为您在定义“经典 OO”方法时遇到了麻烦。是 Objective-C 经典中的信号方法还是标准 C++ 中的静态方法？

在函数式语言中，很容易拥有非对象函数，这些函数在某种意义上就像对象一样，因为它们返回的函数的实现是不透明的。例如Scheme中的如下代码

```
(define (create-ball color)
    (lambda (attribute-name)
       (if (equal? attribute-name "color")
            color
            "method-not-supported")))) 
```

将输出一个正式不是“对象”的函数，但它可以像一个函数一样运行，因为它存储状态，但是您不太清楚您所接触的面向对象范例到底有什么问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-02-02T23:09:51.830

Google's Go language takes a decidedly different approach to object orientation, maybe worth a look.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-03T15:59:41.593

深入了解具有基于原型的模型的 javascript，或者查看具有一些奇怪的面向对象实现方式的 lua

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-07-08T11:07:55.513

看看 CLOS，它基本上是基于函数/方法的。

# php - 从 20 个整数中选择最多 5 个整数

> ID：507646
> 
> 赞同：1
> 
> 时间：2009-02-03T15:48:24.363
> 
> 标签：php, sql, mysql

我正在尝试从表中 20 个最新条目的列表中选择 5 个查看次数最多的文章。我的表结构本质上是这样的：

```
id | date | title | content | views 
```

我的第一个想法是使用内部选择来获取最近的 20 篇文章，然后从中进行选择，但我还没有运气。

```
//doesn't work (my version of mysql doesn't support LIMIT in sub queries)
$recent = "(SELECT id FROM news ORDER BY date DESC LIMIT 20)";
$result = $db->query("SELECT id, title, date, content FROM news WHERE id IN $recent ORDER BY views DESC LIMIT ".self::RECENT_MAX);

//neither does this (syntax error @ 'OFFSET 20')
$recent = "(SELECT MAX(date) FROM news ORDER BY date DESC OFFSET 20)";
$result = $db->query("SELECT id, title, date, content FROM news WHERE date > $recent ORDER BY views DESC LIMIT ".self::RECENT_MAX); 
```

有人对如何构建此查询有任何建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T16:49:19.373

我刚刚测试了这个并且它有效

```
SELECT *
FROM (
    SELECT *
    FROM news
    ORDER BY id DESC
    LIMIT 0, 20
) lasttwenty
ORDER BY views DESC
LIMIT 0, 5 
```

服务器版本：5.0.51a-3ubuntu5.4

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T16:06:24.483

如果您在通过 SQL 运行时遇到很多问题，我建议您从数据库中获取 20 篇最新的文章，然后在 PHP 中对其进行处理以找到 5 篇最受欢迎的文章。您可以循环遍历行，也可以将其全部加载到数组中并对其进行排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T16:02:20.620

为什么不单独运行第一个（内部）查询，并以编程方式创建第二个查询？

```
$ids = array();
$result = $db->query("SELECT id FROM news ORDER BY date DESC LIMIT 20");
while ($row = $result->fetch()) {
    $ids[] = $row[0];
}
$ids = implode(',', $ids);
$result = $db->query("SELECT id, title, date, content FROM news WHERE id IN ($ids) ORDER BY views DESC LIMIT ".self::RECENT_MAX); 
```

或者这种性质的东西...

**更新**：或者你可以简单地获取前 20 个 sorted by `date`，然后在 PHP 中对结果数组进行排序`views`，最后取 5 个最上面的项目（我想这就是 SilentGhost 在评论中的意思）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T16:10:54.613

由于我想不出任何方法可以在单个查询中做到这一点，我建议要么选择代码中的前 5 个，要么使用两个查询来完成，例如：

```
$items = $db->query("SELECT id FROM news ORDER BY date DESC LIMIT 20");
$recent = array();
foreach ($items->fetchAll() as $item) { $recent[] = $item['id']; }
$recent = "('".join("','", $recent)."')";

$result = $db->query("SELECT id, title, date, content FROM news WHERE id IN {$recent} ORDER BY views DESC LIMIT ".self::RECENT_MAX); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-03T16:15:47.740

试试这个...

```
select top 5 number from
(
    select 
         top 20 (ID) as number
    from 
        news order by date desc
)
as number 
```

***编辑***MS SQL

对 MYSQL 使用 LIMIT

# c# - 学习编写惯用的 C# 的最佳资源是什么？

> ID：507649
> 
> 赞同：4
> 
> 时间：2009-02-03T15:49:30.133
> 
> 标签：c#, .net, idioms

我正在为 c# 程序员寻找像[惯用的 ruby​​ 之类的东西](http://cbcg.net/talks/rubyidioms/)

它应该：

*   适用于已经可以编程的人

*   更简洁

*   不是基本的

刚刚在stackoverflow上为这个问题找到了一个更好的线程：[c-coding-standard-best-practices](https://stackoverflow.com/questions/14967/c-coding-standard-best-practices)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T16:44:43.483

您可能想尝试Bill Wagner 的[Effective C#](https://rads.stackoverflow.com/amzn/click/com/0321245660)和[More Effective C#](https://rads.stackoverflow.com/amzn/click/com/0321485890)。

我没有正确阅读其中任何一个（必须有一段时间这样做），但我听到了一些好消息。

假设您使用的是 C# 3，我会尽量确保您熟悉：

*   泛型以及泛型方法的类型推断可以为您做什么
*   `IEnumerable<T>`和迭代器块
*   一般的 LINQ，特别是 LINQ to Objects（其他 LINQ 风格在*某些*地方很有用 - LINQ to Objects 几乎在任何地方都很有用）
*   委托，特别是 lambda 表达式和匿名方法
*   对象和集合初始化器
*   扩展方法 - 了解它们，并将它们*视为*实用方法。如果您想添加自己的 LINQ 运算符，它们尤其方便

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T15:53:43.273

[框架设计指南](https://rads.stackoverflow.com/amzn/click/com/0321545613)是我发现的唯一东西

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T22:14:41.040

MSDN 有一个程序可以检查您的程序是否有“最佳实践”：[FXCop](http://www.microsoft.com/downloads/details.aspx?familyid=9AEAA970-F281-4FB0-ABA1-D59D7ED09772&displaylang=en)

这是 MSDN 中的指南，告诉您有关传统和成语的信息：[MSDN](http://msdn.microsoft.com/en-gb/ms229042.aspx)

哦，最后这里是 MSDN 上的另一个指南：[MSDN](http://msdn.microsoft.com/en-gb/library/4dtdybt8.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T22:19:52.683

如果您想确保您的代码样式符合 Microsoft 的建议，请查看[StyleCop](http://code.msdn.microsoft.com/sourceanalysis)。是的，它非常挑剔，我并不完全同意所有规则，但在一般情况下，它确实使代码更具可读性，这在开发人员之间更加一致。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2009-02-03T16:36:27.323

[这是 C# 和 Java 之间的一个不错的比较](http://www.25hoursaday.com/CsharpVsJava.html)，它触及了大多数 C# 习语，但要注意这里有两种不同的习语：C# 习语和 .NET 习语。例如，在 C# 中，在标识符中使用下划线是完全可以接受的，但在 VB.NET 中则不行，因此虽然没有强制要求，但最好不要在公共标识符中使用下划线，以便 VB.NET 可以访问他们。

# arrays - 如何将一组文本值分配给字符串数组？

> ID：507653
> 
> 赞同：3
> 
> 时间：2009-02-03T15:49:58.617
> 
> 标签：arrays, excel, vba

如何将一组文本值分配给数组？我试过的都没有用！

```
Months = Array("Jan", "Feb", ..., "Dec") 
```

和我试过的其他人不起作用！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-03T15:53:28.127

这是关于 VB 的一些内容：http: [//www.devx.com/vb2themax/Tip/18322](http://www.devx.com/vb2themax/Tip/18322)

> Visual Basic 没有提供任何方法来声明一个数组并同时初始化它的元素。在大多数情况下，您最终会一一设置单个元素，如下所示：

```
 Dim strArray(0 To 3) As String
  strArray(0) = "Spring" 
  strArray(1) = "Summer"
  strArray(2) = "Fall"
  strArray(3) = "Winter" 
```

> 在 VB4、VB5 和 VB6 下，您可以使用 Array() 函数动态创建变量数组：

```
 Dim varArray() As Variant 
  varArray() = Array("Spring", "Summer", "Fall", "Winter") 
```

> 但是除了 Variant 之外，没有类似的函数可以创建数据类型的数组。但是，如果您使用的是 VB6，则可以使用 Split() 函数创建字符串数组：

```
 Dim varArray() As String 
  ' arrays returned by Split are always zero-based 
  varArray() = Split("Spring;Summer;Fall;Winter", ";") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T15:51:54.307

我很确定你只能这样做：

```
 dim months(2) as string

 months(0) = "Jan"
 months(1) = "Feb"
 months(2) = "Mar" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T15:59:23.387

如果你在谈论 vbscript 那么这有效：

```
months = Array("may","june","july") 
```

如果是 vb.net，那么：

```
dim months() as string = {"may","june","july"} 
```

# java - java中FTPClient类的问题

> ID：507660
> 
> 赞同：8
> 
> 时间：2009-02-03T15:51:09.427
> 
> 标签：java, ftp, apache-commons

我正在使用 org.apache.commons.net.ftp.FTPClient 并看到行为，嗯......令人困惑。

下面的方法打算通过一个 FTPFile 列表，读入它们，然后对内容做一些事情。这一切都在工作。（真正）不起作用的是 FTPClient 对象执行以下操作...

```
1) Properly retrieves and stores the FIRST file in the list  
2) List item evaluates to NULL for x number of successive iterations of the loop (x varies on successive attempts  
3) manages to retrieve exactly 1 more file in the list  
4) reports that it is null for exactly 1 more file in the list  
5) hangs indefinitely, reporting no further activity.

public static String mergeXMLFiles(List<FTPFile> files, String rootElementNodeName, FTPClient ftp){
        String ret = null;
        String fileAsString   = null; 
        //InputStream inStream;
        int c;

        if(files == null || rootElementNodeName == null)
            return null;
        try {
            System.out.println("GETTING " + files.size() + " files");
            for (FTPFile file : files) {
                fileAsString = "";
                InputStream inStream = ftp.retrieveFileStream(file.getName());

                if(inStream == null){
                    System.out.println("FtpUtil.mergeXMLFiles() couldn't initialize inStream for file:" + file.getName());

                    continue;//THIS IS THE PART THAT I SEE FOR files [1 - arbitrary number (usually around 20)] and then 1 more time for [x + 2] after [x + 1] passes successfully.
                }
                while((c = inStream.read()) != -1){

                    fileAsString += Character.valueOf((char)c);
                }
                inStream.close();

                System.out.println("FILE:" + file.getName() + "\n" + fileAsString);
            }

        } catch (Exception e) {
            System.out.println("FtpUtil.mergeXMLFiles() failed:" + e);
        }
        return ret;
    } 
```

有人见过这样的吗？我是 FTPClient 的新手，我做错了什么吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-03T16:12:25.967

根据 的 API [`FTPClient.retrieveFileStream()`](http://commons.apache.org/net/api/org/apache/commons/net/ftp/FTPClient.html#retrieveFileStream(java.lang.String))，该方法`null`在无法打开数据连接时返回，这种情况下您应该检查回复代码（例如[`getReplyCode()`](http://commons.apache.org/net/api/org/apache/commons/net/ftp/FTP.html#getReplyCode())、[`getReplyString()`](http://commons.apache.org/net/api/org/apache/commons/net/ftp/FTP.html#getReplyString())、[`getReplyStrings()`](http://commons.apache.org/net/api/org/apache/commons/net/ftp/FTP.html#getReplyStrings())）以了解其失败的原因。此外，您应该通过调用[`completePendingCommand()`](http://commons.apache.org/net/api/org/apache/commons/net/ftp/FTPClient.html#completePendingCommand())并验证传输确实成功来完成文件传输。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-04-12T19:43:00.393

当我在“检索”命令之后添加时它工作正常：

```
 int response = client.getReply();
        if (response != FTPReply.CLOSING_DATA_CONNECTION){
            //TODO 
        } 
```

# html - 单个图像文件，用于存储页面上的所有小图像

> ID：507665
> 
> 赞同：9
> 
> 时间：2009-02-03T15:52:05.853
> 
> 标签：html, css, css-sprites

在最近的一个**Stackoverflow 播客**中，Jeff 谈到拥有一个图像文件，其中包含整个页面上的所有这些小图像，然后使用 CSS 对其进行剪切，以便所有图像都能正确显示。重点是减少服务器请求的数量，以便更快地加载页面。我就像“哇，这真的很酷，我真的可以在我们的产品中使用它”。

我的问题是：**这是如何用 CSS 完成的？**我需要使用背景图像加载图像，但是如何指定大图像中子图像的偏移量？也就是说，假设在（50px，50px）处的大图像中有一个锤子图标，它的大小为32px * 32px，我怎样才能强制浏览器只显示那个位？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-03T15:57:01.333

基本上，您将单个图像用作背景图像，但将其移开（向左和向上）您要显示的图像的偏移量。例如显示锤子图标：

```
.hammer
{
  background: transparent url(myIcons.jpg) -50px -50px no-repeat;
} 
```

但据我所知，您必须确保使用背景图像的元素具有正确的尺寸（例如 32x32 像素）。

搜索 CSS Sprites 将为您提供更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T15:54:11.620

它被称为[css sprites](http://www.alistapart.com/articles/sprites/)。

我基本上是游戏编程中使用的一个旧技巧，您可以在其中加载包含您需要绘制的某些项目的所有“状态”的单个位图，优点是这样可以预加载图像，并且在您需要实际使用时没有延迟，在 css 的情况下，它通常通过使用图像作为元素的背景来实现，并在 :hover、:active 和 "normal" 类上应用不同的偏移量和边界。

[stackoverflow 博客](https://blog.stackoverflow.com/2009/01/updated-wmd-editor/)中有更多信息

这是一个不错的生成器：[http ://www.csssprites.com/](http://www.csssprites.com/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-03T16:03:57.840

你知道答案...问google 在这种情况下查看google搜索结果页面的来源，使用firebug之类的工具，你会发现

```
 .w10 
 background-position:-152px 0;
}
.w10, .w11, .w20, .w21, .w24, .wci, .wpb 
 background:transparent url(/images/nav_logo4.png) no-repeat scroll 0 0;
 border:0 none;
 cursor:pointer;
 height:16px;
 margin-left:8px;
 vertical-align:bottom;
 width:16px;
} 
```

所以所有 w10、w11、w20 等共享相同的图像 (nav_logo4.png) 都具有固定的高度和宽度。并且都指定（不同的）backgroup-position。

# .net - 信任位于网络共享上的程序集

> ID：507669
> 
> 赞同：5
> 
> 时间：2009-02-03T15:53:17.440
> 
> 标签：.net, security

我一直想在这里发帖，但总能找到我需要的信息；当然到现在为止！我将感谢您在代码访问安全性方面提供的任何帮助，特别是网络共享上的 dll。

我正在寻找一种在运行时从未知网络共享动态加载反射、实例化和调用的组合的方法。

我搜索了论坛并了解到从 .NET 3.5 SP1 开始，程序集将在完全信任的网络共享上执行。这似乎是针对 .exe 文件而不是 .dll 的。

我了解为什么会发生这种情况，什么是代码信任，以及 CasPol 和“.NET Framework 2.0 配置”工具是如何工作的。我可以修改策略，以便在测试环境中获得对特定共享的完全信任，尽管部署后我不知道确切的网络共享。

我无法使用任何内置的会员条件，例如强签名、url、证书等等。

我知道我可以通过实现 IMembershipCondition 接口并跳过几个环节来实现自定义条件类型。

基于上述信息，我想实现一个自定义成员资格条件（在 C# 中），但这似乎是一项相当复杂的任务，并且似乎没有太多可以从 Microsoft 或 t'internet 获得的信息。目前，我不明白您如何将“证据”放入程序集中以便可以识别它，也不了解在策略评估期间如何公开该证据以及如何以编程方式编写该证据。

例如，我想实现一个策略，该策略标识所有具有 AssemblyCompany 类型的程序集属性且值为“My Company”的程序集，即 [assembly: AssemblyCompany("My Company")]。这并不完全是我打算实现的，但它会帮助我理解该机制是如何工作的。

在处理此产品请求之前，我对代码安全一无所知，正如您可能推断的那样，我一直在广泛研究并找到尽可能多的关于该主题的信息，但我现在陷入困境。

您是否实现了自己的 IMembershipCondition 适配器？您是否有任何指向如何执行此操作的综合指南的链接？你能提供一个工作的例子吗？

感谢您阅读我的（长）帖子，请帮助我！:D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2011-01-28T12:34:04.767

它被称为 CAS，代码访问安全性，它强制所有不受信任的网络驱动器被视为不受信任的网络代码。

本地代码具有完全信任，网络代码具有部分信任，互联网代码没有信任。它是一个仅 .Net 的安全模型。您可以选择通过授予网络驱动器完全权限（搜索 caspol.exe fulltrust 网络驱动器）将网络驱动器指定为“受信任”驱动器，或者将 .exe 复制到本地驱动器。

此链接应该可以帮助您：[https ://julianscorner.com/wiki/programming/caspol_network_share](https://julianscorner.com/wiki/programming/caspol_network_share)

或者命令行上的 CasPol.exe -m -pp off -ag 1.2 -url file://///server/share/* FullTrust。

# sql - 处理“超标准化”数据

> ID：507671
> 
> 赞同：4
> 
> 时间：2009-02-03T15:53:28.517
> 
> 标签：sql, ruby-on-rails, database-design, denormalization, normalizing

我的雇主是一家小型办公用品公司，正在更换供应商，我正在查看他们的电子内容以提出一个强大的数据库架构；我们之前的模式几乎是完全不加思索地拼凑在一起的，而且它几乎导致了一个无法忍受的数据模型，其中包含损坏的、不一致的信息。

新供应商的数据比旧供应商的数据要好得多，但他们的数据就是我所说的*超标准化*。例如，他们的产品类别结构有5个层次：Master Department、Department、Class、Subclass、Product Block。此外，产品块内容具有产品的长描述、搜索词和图像名称（想法是产品块包含产品和所有变体 - 例如，特定的笔可能采用黑色、蓝色或红色墨水；所有这些items 本质上是相同的东西，因此它们适用于单个产品块）。在我得到的数据中，这表示为产品表（我说“表”，但它是一个包含数据的平面文件），它引用了产品块的唯一 ID。

我正在尝试提出一个强大的模式来容纳我提供的数据，因为我需要相对较快地加载它，而且他们给我的数据似乎与他们的数据类型不匹配在他们的示例网站 ( [http://www.iteminfo.com](http://www.iteminfo.com) )上提供演示。无论如何，我不打算重用他们的演示结构，所以这是一个有争议的问题，但我正在浏览该网站以了解如何构建事物的一些想法。

我不确定是否应该以这种格式保存数据，或者例如使用自引用关系将主/部门/类/子类合并到一个“类别”表中，并将其链接到产品块（产品块应该分开，因为它不是一个“类别”，而是给定类别的一组相关产品）。目前，产品块表引用子类表，因此如果我将它们合并在一起，这将更改为“category_id”。

我可能会创建一个电子商务店面，利用 Ruby on Rails 上的这些数据（或者这是我的计划，无论如何），所以我试图避免以后被卡住或拥有一个臃肿的应用程序 - 也许我我想太多了，但我宁愿安全也不愿后悔；我们之前的数据一团糟，由于数据不一致和不准确，公司损失了数万美元的销售额。此外，我将通过确保我的数据库是健壮的并强制执行约束来稍微打破 Rails 约定（我也计划在应用程序级别这样做），所以这也是我需要考虑的事情。

你会如何处理这样的情况？请记住，我已经将数据加载到模拟表结构的平面文件中（我有文档说明哪些列是哪些列以及设置了哪些引用）；我正在尝试决定是否应该让它们像目前一样正常化，或者我是否应该寻求整合；我需要知道每种方法将如何影响我使用 Rails 对网站进行编程的方式，因为如果我合并，一个表中基本上会有 4 个“级别”的类别，但这似乎比单独的表更易于管理每个级别，因为除了子类（直接链接到产品块）他们**不做**除了显示它们下的下一级类别之外的任何内容。我总是对处理这样的数据的“最佳”方式感到茫然——我知道“规范化直到它受伤，然后非规范化直到它起作用”的说法，但直到现在我才真正需要实施它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T16:10:34.770

我更喜欢“超规范化”方法而不是非规范数据模型。您提到的自引用表可能会减少表的数量并在某些方面简化生活，但通常这种类型的关系可能很难处理。分层查询变得很痛苦，将对象模型映射到此（如果您决定走那条路线）也是如此。

几个额外的连接不会受到伤害，并且会使应用程序更易于维护。除非由于连接数量过多而导致性能下降，否则我会选择保持原样。作为额外的好处，如果这些级别的表中的任何一个需要添加额外的功能，您将不会遇到问题，因为您将它们全部合并到自引用表中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-03T19:15:43.803

我完全不同意对父子层次结构的自引用表结构的批评。在大多数情况下，链表结构使 UI 和业务层编程更容易且更易于维护，因为链表和树是用通常用于实现 UI 和业务层的语言来表示这些数据的自然方式。

关于在这些结构上维护数据完整性约束的难度的批评是完全正确的，尽管简单的解决方案是使用一个包含更难检查约束的闭包表。使用触发器很容易维护闭包表。

权衡是数据库（闭包表和触发器）中的一些额外复杂性，而 UI 和业务层代码的复杂性要低得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T16:10:01.620

如果我理解正确，您希望将它们单独的表转换为一个层次结构，该层次结构保存在具有自引用 FK 的单个表中。

这通常是一种更灵活的方法（例如，如果您想添加第五层），但 SQL 和关系数据模型往往不能很好地处理像这样的链表，即使是像 MS SQL Servers CTE 这样的新语法。诚然，CTE 让它变得更好。

执行某些事情可能既困难又昂贵，例如产品必须始终位于层次结构的第四层等。

如果您确实决定这样做，那么一定要查看 Joe Celko 的[Smarties SQL](https://rads.stackoverflow.com/amzn/click/com/0123693799)，我相信其中有一两节是关于建模和使用 SQL 中的层次结构的，或者更好的是获得他专门针对该主题的书（[Joe Celko 为 Smarties 编写的 SQL 中的树和层次结构](https://rads.stackoverflow.com/amzn/click/com/1558609202)）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T16:18:18.887

`Normalization`意味着数据完整性，即：每个范式都会减少数据不一致的情况。

通常，`denormalization`它的目标是更快`querying`，但会导致空间增加、`DML`时间增加，最后但并非最不重要的一点是，需要加大努力使数据保持一致。

人们通常会更快地编写代码（写得更快，而不是代码更快），如果数据是`normalized`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-03T18:05:32.713

自引用表几乎总是比规范化表更难查询和执行。不要这样做。它可能看起来更优雅，但它不是而且是一种非常糟糕的数据库设计技术。就我个人而言，您描述的结构对我来说听起来不错，没有超规范化。正确规范化的数据库（具有外键约束以及默认值、触发器（如果需要复杂规则）和数据验证约束）也更有可能拥有一致和准确的数据。我同意让数据库执行规则，这可能是最后一个应用程序有错误数据的部分原因，因为规则没有在适当的地方执行，人们能够轻松绕过它们。并不是说应用程序不应该 t 检查（甚至发送无效日期以使数据库在插入时失败）。自从你重新设计以来，我会花更多的时间和精力来设计必要的约束和选择正确的数据类型（例如，不要将日期存储为字符串数据），而不是试图让完美的普通规范化结构看起来更优雅。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-03T16:16:18.113

我会尽可能地把它带入他们的模型（如果可能的话，我会得到与他们的模式匹配的文件——而不是扁平化的版本）。如果您将数据直接带入您的模型，如果他们发送的数据开始打破转换到您的内部应用程序模型的假设，会发生什么情况？

最好将他们的数据带入，运行健全性检查并检查假设没有被违反。然后，如果您确实有一个特定于应用程序的模型，请将其转换为您的应用程序最佳使用的模型。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T11:33:12.707

不要反规范化。试图通过非规范化来实现良好的模式设计，就像试图从纽约开车去旧金山一样。它不会告诉你走哪条路。

在您的情况下，您想弄清楚规范化模式想要什么。您可以在很大程度上基于源模式，但您需要了解数据中的功能依赖关系 (FD) 是什么。源架构和展平文件都不能保证向您显示所有 FD。

一旦您知道规范化模式的外观，您现在需要弄清楚如何设计满足您需求的模式。它的模式还没有完全规范化，就这样吧。但是要准备好在扁平文件中的数据与您设计的模式中的数据之间进行转换时遇到困难。

您说贵公司以前的模式由于不一致和不准确而花费了数百万美元。您的模式越规范化，您就越能免受内部不一致的影响。这使您可以自由地对不准确性更加警惕。始终错误的一致数据可能与不一致的数据一样具有误导性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2010-11-24T01:43:28.933

您的店面（或您正在建造的任何东西，对此不太清楚）是否总是会使用来自该供应商的数据？您是否会更换供应商或添加其他不同的供应商？

如果是这样，请设计一个满足*您*需求的通用模式，并将供应商数据映射到它。就我个人而言，我宁愿忍受自引用类别（分层）表的（非常轻微的）“痛苦”，也不愿维持四个（显然是半无用的）类别变体级别，然后明年发现他们已经添加了第 5 个，或者推出了一条只有三个的产品线……

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-11-24T02:04:46.563

对我来说，真正的问题是：*什么更适合模型？*

这就像比较一个元组和一个列表。

1.  元组是固定大小并且是异构的——它们是“超规范化的”。
2.  列表是任意大小并且是同质的。

当我需要一个元组时我使用一个元组，当我需要一个列表时我使用一个列表；它们从根本上服务于不同的目的。

在这种情况下，由于*产品结构已经很好地定义*（并且我认为不太可能改变），所以我会坚持使用“元组方法”。**列表（或递归表模式）的真正威力/用途是当您需要它*扩展*到任意深度时，例如用于 BOM 或家谱树。**

*我根据需要在我的一些数据库中使用这两种方法。*然而，递归模式也存在“隐藏成本”，即并非所有 ORM（不确定 AR）都很好地支持它。许多现代数据库都支持“join-throughs”（Oracle）、层次 ID（SQL Server）或其他递归模式。另一种方法是使用基于集合的层次结构（通常依赖于触发器/维护）。在任何情况下，如果使用的 ORM 不能很好地支持递归查询，那么直接使用数据库功能可能会产生额外的“成本”——无论是在手动查询/视图生成方面，还是在触发器等管理方面。如果你不使用时髦的 ORM，或者只是使用 iBatis 等逻辑分隔符，那么这个问题甚至可能不适用。

就性能而言，在新的 Oracle 或 SQL Server（以及可能的其他）RDBMS 上，它应该非常具有可比性，所以这将是我最不担心的：但请查看适用于您的 RDBMS 和可移植性问题的解决方案。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-02-28T19:50:44.713

每个建议您不要在数据库中引入层次结构的人，只考虑拥有自引用表的选项。这不是在数据库中对层次结构建模的唯一方法。您可以使用不同的方法，它为您提供更轻松、更快速的查询，而无需使用递归查询。假设您的层次结构中有一大组节点（类别）：

> Set1 = (Node1 Node2 Node3...)

这个集合中的任何节点也可以是另一个集合，它包含其他节点或嵌套集合：

> Node1=(Node2 Node3=(Node4 Node5=(Node6) Node7))

现在，我们如何建模呢？让每个节点有两个属性，设置它包含的节点的边界：

> 节点 = { Id: int, Min: int, Max: int }

为了对我们的层次结构进行建模，我们只需相应地分配这些最小值/最大值：

> 节点 1 = { ID = 1，最小值 = 1，最大值 = 10 }
> 节点 2 = { ID = 2，最小值 = 2，最大值 = 2 }
> 节点 3 = { ID = 3，最小值 = 3，最大值 = 9 }
> 节点 4 = { ID = 4，Min = 4，Max = 4 }
> Node5 = { Id = 5，Min = 5，Max = 7 }
> Node6 = { Id = 6，Min = 6，Max = 6 }
> Node7 = { Id = 7，Min = 8 , 最大值 = 8 }

现在，查询 Set/Node5 下的所有节点：

> 选择 n.* 从 Nodes as n, Nodes as s
> where s.Id = 5 and s.Min < n.Min and n.Max < s.Max

唯一消耗资源的操作是如果要插入新节点或在层次结构中移动某些节点，因为许多记录会受到影响，但这很好，因为层次结构本身不会经常更改。

# .net - 计划的控制台应用程序与 Windows 服务？什么时候适合使用每个

> ID：507674
> 
> 赞同：28
> 
> 时间：2009-02-03T15:53:59.170
> 
> 标签：.net, windows, windows-services

我刚刚读到：[将应用程序开发为 Windows 服务有什么好处？](https://stackoverflow.com/questions/442264/what-is-the-benefit-of-developing-the-application-as-a-windows-service)但我仍然不确定何时使用 Windows 服务。

我有几个任务需要每隔一段时间（即每 5 分钟）运行一次。我应该使用哪种项目类型？是否有任何应该是 Windows 服务的应用程序类型的示例？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-03T16:09:14.710

对于任何计划任务，我通常会推荐一个 Windows 服务，原因如下：

*   即使用户未登录 PC，Windows 服务也会运行（即使服务器处于登录提示符下也会运行）（***注意 - 这可能取决于您运行的 Windows 版本）。
*   服务可以作为网络服务或本地系统或用户等高权限帐户运行 - 它们在这方面具有更多可配置性
*   服务还内置了用于在运行时启动、停止、重新启动和暂停的选项（有时）
*   您还可以为服务设置故障条件，例如如果它失败了让它自动重启

至于可以是 Windows 服务的应用程序的其他示例，很多时候它们对于远程处理等应用程序很有用 - 您可以让服务运行客户端连接到的远程处理服务器。显然，对于您希望在后台运行的数据处理任务，或者您希望在某些条件下发送电子邮件的过程等非常有用。

一般来说，我总是发现计划任务更加脆弱和不可靠。除非你让它们正确记录，否则通常更难调试。

关于 Timer 的错误 - 如果您阅读 MS 网站上的错误报告，您可以看到它是在 Timer_Elapsed 事件中调用“Stop”时引起的。答案很简单——不要叫停。相反，将整个事情包装在“IsRunning”布尔值的检查中，并且仅在 IsRunning 为假时运行。即使计时器没有问题，您仍然需要这样做，因为如果您的执行时间长于计时器间隔，计时器可能会在您执行期间重新触发。

无论如何，我仍然认为使用计划任务是一个薄弱的解决方案，让我回想起 Windows 95。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-02-03T16:51:19.727

对于按计划运行的**单一或狭义应用**程序，通过任务计划程序运行控制台应用程序几乎总是正确的设计。

对于可能需要交互的**长时间运行或复杂的任务**，例如手动启动、停止、暂停、继续等，通常情况下，Windows 服务是更好的选择。

计划任务可以在任何帐户下运行，并且不需要用户登录，就像服务一样。对于单一目的的任务，例如您提出的任务的外部控制通常是无关紧要的，因此您不需要服务的可控性。

一个重要因素也是任务调度器是一个非常健壮和灵活的基于事件的调度器。您极不可能编写一个更健壮的调度程序，并且可以处理多变的时间和基于触发器的调度。事实上，在这个站点上使用计时器来安排服务中的任务有很多问题，而且质量差或完全不正确的答案（包括一些“正确”答案）的数量非常显着。

编辑：值得注意的是，微软的政策正在从使用服务进行基于任务的操作转移，这也很有趣。如果您查看 Vista、Win2K8 和 Win7，您会注意到执行系统维护和许多系统服务的特殊用途计划任务的列表越来越多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-15T16:11:09.650

由于不得不编写、调试、部署和支持两者，我更喜欢计划任务。我不怀疑在某些用例中这是错误的选择。但是对于任何相对琐碎的任务，作为计划任务运行的控制台应用程序都非常有效。

根据我的经验，计划任务非常可靠。我不记得有一次失败，我支持大约六种不同的计划任务，从每天到每 15 分钟运行一次。（并不是说没有失败，但它们都是代码或配置问题。并且被记录并发送了通知。问题从来没有出现在任务调度基础设施上。）

任务计划程序任务可以在任何用户上下文下运行，不需要任何人登录。

我最大的优点是部署。对于控制台应用程序，只需将 EXE 发布到正确的目标文件夹。对于 Windows 服务，您需要停止服务（使用 net.exe），卸载服务（使用 InstallUtil.exe），等待（我让部署休眠 25 秒），发布 EXE，然后反向执行所有操作（安装， 开始）。

如果我要再次开发 Windows 服务，我会将其编写为控制台应用程序，然后找到一种方法将其包装到服务中，以使调试不那么令人头疼。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T15:59:19.427

这是 Windows 服务 IMO 的典型案例。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-10-16T14:07:15.583

我有许多在生产网络服务器上每小时运行的 Windows 计划任务。它们根本不可靠。它们在特定计算机帐户下的 Windows 2003 Server 中运行。大多数时候它们运行良好，但有时它们无法运行，有时它们在完成之前终止。

其中一些可能是由于它们是 vbscripts 以及它们的编写方式，但我已经看到使用 WS FTP Pro（商业 FTP 软件）执行相同方式的计划任务。

我已经将其中许多转换为 Windows 服务，并且再也不用担心它们了。

我肯定会倾向于 Windows 服务。像其他一些评论一样，我被 Windows 计划任务烧伤了太多次。我不相信他们提供企业级解决方案。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-16T00:03:54.657

除了需要以非常短的时间间隔运行或连续运行的程序外，我建议在所有情况下都使用计划任务。启动、执行其功能和关闭的程序具有明确定义的资源生命周期，在有限数量的步骤中执行适当的设置和清理（如果没有，它们没有在预期时间终止的事实表明存在错误)，因此更容易推理。而且你不需要摆弄计时器等。

计划任务与服务的停止和重新启动命令具有等效的操作，即。禁用任务，启用任务。很简单，它可以让正在进行的任何当前操作完成，而不是试图中止它们，这本质上是处理这个问题的*正确方法。*在存在重构的情况下，手动执行所有这些状态/转换管理资源生命周期很容易出错。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-03T16:16:17.910

在大多数情况下，我更喜欢 Windows 服务。
使用计划任务时的一件好事：
当计划任务完成时，所有使用的资源都会被释放。

使用 windows 服务时（不停止服务），进程永远不会死。你必须在你的程序中确保资源被释放。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-12-28T15:01:02.227

我从我的经验告诉你，大多数时候我更喜欢使用计划任务而不是 Windows 服务的主要原因之一是它更容易调试，当然在好处列表的顶部`memory management`是`scheduled tasks`.

**`Windows service`**只是在实际需要时运行一段**`always running process`**时间**`schedule task`**，例如，假设您要处理应用程序中的大量数据，并且应该每小时触发一次，如果您使用 Windows 服务，那么您应该小心`disposing objects`并`releasing memory blocks`正确否则它可能是一个巨大的麻烦，但是在您的操作完成后的计划任务中，您的进程被处理并且没有留下任何东西。

# sql-server - SQL Server 中的 Begin...End 块：这段代码对吗？

> ID：507677
> 
> 赞同：1
> 
> 时间：2009-02-03T15:54:08.953
> 
> 标签：sql-server, syntax

我只是想确认我没有在这里遗漏任何东西......所以请耐心等待。

我正在重写很多旧的存储过程，并不断看到格式类似于此的 IF 语句：

```
begin
    if @someParameter <> 'ThisType'
    set @someCode = right(cast(@pYear as varchar(6)),2) + 'THIS'
end 
```

所以 Begin...End 块只是包装（但不影响） IF 语句，对吗？这是 IF 的一些旧语法还是什么？

写这篇文章的人在这份工作之前没有太多的 SQL 经验；他主要在 VB (pre-.NET) 中工作。也许这是其他语言的语法，所以他不小心这样写（习惯）？

这是 SQL Server 2005（代码是为 SQL Server 2000 编写的），顺便说一句

就像我说的，我只是想把我的大脑包裹在这个意大利面上。欢迎任何想法/评论/启发性见解

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-03T16:04:26.670

在 T-SQL 中，Begin 和 END 应该包装 IF（或其他控制结构）的包含语句，并执行多个语句（如代码块）

**会工作**

```
if @someParameter <> 'ThisType'
    set @someCode = right(cast(@pYear as varchar(6)),2) + 'THIS' 
```

**也可以工作，但不是绝对必要的**

```
if @someParameter <> 'ThisType'
Begin
    set @someCode = right(cast(@pYear as varchar(6)),2) + 'THIS'
End 
```

**会按预期工作**

```
if @someParameter <> 'ThisType'
Begin
    set @someCode = right(cast(@pYear as varchar(6)),2) + 'THIS'
    {...do other stuff}
End 
```

**不会按预期工作**（如果您希望这两个语句仅在 IF 条件是我时执行）

```
if @someParameter <> 'ThisType'
    set @someCode = right(cast(@pYear as varchar(6)),2) + 'THIS'
    {...do other stuff} 
```

**没有语义价值**

```
Begin --without wrapping control structure
    {...stuff}
End 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-03T15:57:19.990

正确的。您示例中的 begin...end 块封装了 IF 语句，但不影响它。尽管有罪的程序员可能应该这样做

```
BEGIN
  if ... BEGIN
    set @somecode...
  END
END 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T16:02:31.540

您可以安全地将其更改为：

```
if @someParameter <> 'ThisType'
begin
    set @someCode = right(cast(@pYear as varchar(6)),2) + 'THIS'
end 
```

*begin..end*仍然是额外的，但代码更具可读性。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T16:04:19.930

这取决于之前的情况。您发布的代码与

```
if @someParameter <> 'ThisType'
set @someCode = right(cast(@pYear as varchar(6)),2) + 'THIS' 
```

不过，在 if 之前可能有一个需要开始/结束块的语句。

# performance - 用于压力、负载和性能测试的开源工具

> ID：507683
> 
> 赞同：25
> 
> 时间：2009-02-03T15:54:29.403
> 
> 标签：performance, testing, load, stress-testing, qa

> **可能重复：**
> [您如何对 Web 应用程序进行压力测试？](https://stackoverflow.com/questions/7492/how-do-you-stress-test-a-web-application)

目前我已经用 cc.net、watin 和 nunit 配置了一个项目，现在我想对我的 .net 项目进行压力、负载和性能测试。知道我应该使用哪种开源工具，或者可以使用相同的工作工具来实现它，如果是，那么如何？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-03T16:41:31.277

过去，我使用 Apache [JMeter](http://jmeter.apache.org/)取得了相当大的成功。该界面非常易于使用，它支持远程代理以帮助对许多主机进行负载测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T23:33:51.553

我公司提供的服务不是开源的，但它非常酷，并且建立在开源之上。这是一个[负载测试服务](http://browsermob.com)，它使用真实的浏览器来回放负载（而不是模拟 HTTP/虚拟用户）。我们使用 Selenium 作为播放引擎，对于 WatiN 用户来说应该有些熟悉。

关于我们的服务（或使用真实浏览器的一般想法）最好的部分是像 ViewState 这样的 .NET 东西是自动处理的。您不必做任何诡计，例如使用正则表达式解析请求以使其工作。相反，浏览器只是做普通浏览器所做的事情。

如果这篇文章看起来过于商业化，我深表歉意，但由于问题是关于开源（我们利用开源并提供免费试用）和 .NET（我们的一大特色是无缝支持 .NET），我想我会给它一提。

祝你好运！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-23T06:09:24.267

Jmeter放下手。这是我用过的唯一一个反复产生可靠结果的工具。一旦你掌握了它的窍门，使用它绝对是一种乐趣，你可以用相对较少的线程来模拟大负载。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2010-10-29T15:33:50.970

我会投票给 JMeter。完全免费，而且很容易设置和开始。以下是有关如何 [使用 Jmeter 对应用程序进行压力测试的一些链接](http://www.skill-guru.com/blog/tag/jmeter/)

我们还描述了我们如何测试、不同参数和指标的过程。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-02-28T12:09:07.000

前几天我偶然发现了[HttpRider](http://httprider.codeplex.com/)，看起来很不错。干净的 UI 并且易于配置，尽管我建议谨慎，因为他们声明它是测试版（在发布时）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-03T15:58:39.317

如果它是针对网站/网络应用程序的，您可以在这里获取一些答案：[对网站进行压力测试的最佳方式](https://stackoverflow.com/questions/340564/best-way-to-stress-test-a-website/340588#340588)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-04T09:03:38.423

我使用 Jmeter 和 Selenium 对我的应用程序进行负载测试。我增强了 Jmeter 代码来调用 selenium 引擎来模拟负载测试。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-23T05:52:33.217

由于您已经熟悉 c#。你可以试试这个工具 fwptt.sourceforge.net。它基本上会在 C# 中生成一个测试类，您可以根据需要对其进行修改，然后使用该类运行测试。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2011-10-21T05:23:45.920

作为 C# 开发人员，您可以轻松理解类结构。所以我推荐你使用csunit进行测试，这个工具是开源的，你可以很容易地找到它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-03T16:08:09.360

我们使用[Grinder](http://grinder.sourceforge.net/)对 Web 服务运行负载/压力和功能测试。我们从未将它用于网页，但它也应该这样做。您可以通过在几台机器上安装 Grinder“代理”来真正击败您的服务器，然后生成一堆进程来访问您的站点以模拟多个连接。

文档还可以，但是您对开源项目有什么期望？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-03T17:28:37.607

[WebLOAD](http://www.webload.org/)是一个开源负载测试器。我相信它最初是由最初开发 Mercury LoadRunner 的同一个人开发的。

他们也有商业版本：[WebLOAD 版本比较](http://www.webload.org/webload-editions.html)

如果您使用的是 Windows 平台并且拥有 Visual Studio 企业版，那么您也可以使用 Application Center 测试工具。

最后但同样重要的是，还有 Homer：Microsoft [Web Application Stress](http://www.microsoft.com/downloads/details.aspx?familyid=e2c0585a-062a-439e-a67d-75a89aa36495&displaylang=en)工具（又名 WAS，Application Center Test 的前身）

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T18:49:00.987

我用过[openSTA](http://www.opensta.org/)。

这使用了一种相对简单的脚本语言。

您可以轻松地测试 Web 服务并编写自己的脚本。

它允许您以任何您想要的方式将脚本放在测试中，并配置迭代次数、每次迭代中的用户数、引入每个新用户的加速时间以及每次迭代之间的延迟。将来也可以安排测试。

它是开源和免费的。

它会生成许多报告，这些报告可以保存到电子表格中。然后，我们使用数据透视表轻松分析和绘制结果。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-04T19:14:26.427

在为 MS Windows 平台开发时，我使用 typeperf。使用 MS Windows 内置的 WMI 计数器（几乎所有你想跟踪的信息都在那里），所以你不需要在目标机器上安装“服务器应用程序”。

它在同时测试客户端/服务器应用程序或多台机器时非常有用。它可以生成 CSV 文件，然后我用它来生成报告和图表。此外，WMI 还为 NET 应用程序提供了特殊的计数器。

如果 typeperf 命令行客户端还不够，您可以使用 MS 提供的 api 编写自己的代码。

[http://technet.microsoft.com/en-us/library/cc753182.aspx](http://technet.microsoft.com/en-us/library/cc753182.aspx)

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-09-10T20:15:58.420

试试这个：http: [//sourceforge.net/projects/dieseltest/](http://sourceforge.net/projects/dieseltest/)

这似乎是完美的事情。

杰迪普戴夫

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-09-16T08:10:18.993

对于 Web 服务测试、soap rest 或 WCF（包括 WebHttpBinding），请试用 SOA Cleaner。可以从：http://xyrow.com[下载](http://xyrow.com)。有一个免费版本，它不需要任何安装。它还可以执行负载测试。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-09-17T09:56:42.403

Open STA 是事实上的开源负载测试工具。

但它只能支持Http协议。

问候金佰利免费[LoadRunner](http://www.guru99.com/loadrunner-tutorials.html)视频教程

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2010-01-09T00:20:16.990

有同样的问题，我正在使用[NTime](http://www.codeproject.com/KB/dotnet/NTime.aspx) - 早期但它看起来相当不错。可以运行多个线程进行测试，如果有人感兴趣，其他好的功能会在这里报告。

我注意到这里的大多数答案都是针对 Java/Web World 的，它们都不符合我的要求。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2009-02-03T23:34:48.180

哦，如果您正在寻找 100% 开源（尽管我强烈建议您结合使用外部负载测试和内部测试），[Pylot](http://www.pylot.org/)也非常棒。我发现它比 JMeter 或 OpenSTA 更容易使用。

# regex - 正则表达式从其他恒定的管道分隔字符串中获取一个字段

> ID：507693
> 
> 赞同：1
> 
> 时间：2009-02-03T15:56:31.927
> 
> 标签：regex

什么是正则表达式

```
initSock|north|router\r\n 
```

有**北方**的地方一直在变化，但其余的总是一样的。所以它可以是：

```
initSock|foo|router\r\n
initSock|bar|router\r\n 
```

等等

但是在**north**、**foo**或**bar**的地方肯定应该有东西并且不能为空。我将在 C# 中使用它。

更清楚地说：任何看起来像这样的事情都是不好的：

```
initSock||router\r\n
initSockfoorouter\r\n
|foo|router\r\n
initSock|foo|router
initSock|foo|portal\r\n
outSock|foo|router\r\n 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T15:58:30.770

```
"^initSock\|([a-zA-Z]+)\|router\\r\\n$" 
```

虽然我可能很想分割管道（“|”）字符......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T16:10:05.393

为了从 M Potato Head 扩展上述答案以允许所有可能的字符，我将正则表达式重写为：

```
"^initSock\|[^|]+\|router\\r\\n$" 
```

或者

```
"^initSock\|[^|][^|]*\|router\\r\\n$" 
```

如果你不能使用扩展的正则表达式。这样，您不必确保您已允许您使用的字符集中所有可能的字符来匹配名称的不同部分。

高温高压

干杯，

抢

# c# - VC# 2008：从 DataTable 中获取表名到 ComboList / 如何合并来自 2 个 MDB 的表？

> ID：507698
> 
> 赞同：0
> 
> 时间：2009-02-03T15:57:22.410
> 
> 标签：c#, ms-access, datagridview, datatable

我正在编写的程序的目的是由这个问题引起的：

有两个用户，每个用户保存到一个 .MDB 文件。一个用户拥有一半更新/正确的信息（另一半已过时），另一个用户拥有一半信息（另一半已过时）。

用户 1：25% + 25% = 50% 需要当前信息，另外 50% 已过时用户 1 处理 4 个项目中的 2 个。

用户 2：25% + 25% = 50% 需要当前信息，另外 50% 已过时用户 2 处理 4 个项目中的 2 个。

我需要从假设中提取 50%（4 个项目中的 2 个）...... User1 并将其添加到 User2 使其成为 100% 的当前（4 个项目中的 4 个）。

他们的 SQL 样式表结构（无论如何都应该）是相同的（但如果可能的话，我想提供一个事件，我会知道添加了一些新表）

如果我能找到如何从 DataTable 中获取所有表名，我可以通过 DataTable 系统地排列并用我知道需要更新的其他 .MDB 文件中的表替换这些表。我知道 DataSet 有“DataSet.Tables”……但这对我没有多大帮助。

如果我能做到这一点，我还可以将表格添加到组合框中，并在组合框所说的任何地方创建功能，这就是我将在我的 Datagrid 上列出的表格。

如果你们中的任何人对如何执行此操作有任何想法（或者如果您甚至理解我在说什么），请告诉我。我已经完成了这个项目的 70%，这些似乎是我最后的逻辑障碍。我想我解释得对。

1.  如何仅列出 DataTable 对象中的表名称。
2.  您对从 .MDB 文件中取出特定表并将它们添加到另一个 .MDB 文件有什么想法？
3.  我将如何输入一个包含所有表名的 ComboList 下拉框...当我更改表名时，它会在 Datagrid 上列出这些内容。
4.  有没有办法在 Datagrid 上列出表格，当您单击表格时，它会列出该表格的内容（有点像树结构）。

**编辑：我认为他是对的！我认为 DataTables 只是一个表，而 DataSets 是一组表。考虑到这一点，如何将 .MDB 文件中的所有表列出到 DataSet 中？那将完美地解决我的问题。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T16:03:30.883

我认为 DataTable 对象只是一个表，而 DataSet 是包含一对多 DataTables 的。

如果您正在查找 DataTable 的实际名称，则可以通过该`DataTable.TableName`属性访问该名称。

编辑：如果您想将 DataTables 添加到 DataSet 对象中，只需创建一个新的 DataSet 然后使用 .Add() 方法。

```
Dim DS as new DataSet
Dim DT as new DataTable("TableName")

DS.Add(DT) 
```

然后，您应该能够遍历您的 DataSet 并通过访问每个 DataTable 的 TableName 属性来检索表名：

```
For each table as DataTable in DS.Tables
    Console.Writeline(table.TableName)
Next 
```

# c# - #if RELEASE 会像 C# 中的 #if DEBUG 一样工作吗？

> ID：507704
> 
> 赞同：297
> 
> 时间：2009-02-03T15:58:26.557
> 
> 标签：c#, .net, debugging

在我看到的所有#if 编译器指令示例中，它们都使用“DEBUG”。我可以以相同的方式使用“RELEASE”来排除在调试模式下编译时我不想运行的代码吗？我想用这个块包围的代码会发送一堆电子邮件，我不想在测试时不小心把它们发送出去。

* * *

## 回答 #1

> 赞同：416
> 
> 时间：2009-02-03T16:01:19.093

`RELEASE`未定义，但您可以使用

```
#if (!DEBUG)
  ...
#endif 
```

* * *

## 回答 #2

> 赞同：297
> 
> 时间：2009-02-03T16:02:07.610

不，它不会，除非你做一些工作。

这里重要的部分是 DEBUG 的真正含义，它是一种定义的常量，编译器可以检查。

如果您检查项目属性，在 Build 选项卡下，您会发现三件事：

*   标有“条件编译符号”的文本框
*   标有“定义调试常量”的复选框
*   标有“定义跟踪常数”的复选框

没有这样的复选框，也没有名称为 RELEASE 的常量/符号预定义。

但是，您可以轻松地将该名称添加到标有条件编译符号的文本框中，但请确保在此之前将项目配置设置为发布模式，因为这些设置是按配置进行的。

所以基本上，除非您将其添加到文本框中，`#if RELEASE`否则不会在任何配置下生成任何代码。

* * *

## 回答 #3

> 赞同：45
> 
> 时间：2009-02-03T16:02:57.420

没有。

在调试配置中，有一个已`DEBUG`定义的常量（由 Visual Studio 自动定义），而没有为发布模式定义这样的常量。检查构建下的项目设置。

*在Project -> Build*下选择 [Define DEBUG constant]就像在每个文件的开头包含 #define DEBUG。

如果要为发布配置定义 RELEASE 常量，请访问：

*   项目属性 -> 构建
*   选择发布模式
*   在*条件编译符号*文本框中输入：RELEASE

* * *

## 回答 #4

> 赞同：35
> 
> 时间：2009-02-03T16:02:11.993

在我的 VS 安装（VS 2008）`#if RELEASE`上不起作用。但是你可以使用`#if !DEBUG`

例子：

```
#if !DEBUG
SendTediousEmail()
#endif 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2009-02-03T16:04:36.967

我以前从未见过……但我见过：

```
#if (DEBUG == FALSE) 
```

和

```
#if (!DEBUG) 
```

那为你工作？

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2016-10-24T08:05:37.250

您可以`#if(!DEBUG)`用于此目的。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-14T22:27:33.127

“Pop Catalin”做对了。根据构建类型控制定义提供了很大的灵活性。例如，您可以在同一个解决方案中拥有“DEBUG”、“DEMO”和“RELEASE”配置。这可以避免使用两种不同的解决方案进行重复编程。

所以 yes `#if RELEASE`or与定义 RELEASE Con​​ditional 编译符号时的`#if (RELEASE)`工作方式相同。`#if DEBUG`

以下内容来自“Pop Catalin”帖子：如果要为发布配置定义 RELEASE 常量，请转到：* Project *Properties -> Build* * Select Release Mode * 在*Conditional compilation symbols*文本框中输入：RELEASE

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-09-15T09:59:31.110

我知道这是一个老问题，但值得一提的是，您可以在 DEBUG 和 RELEASE 之外创建自己的配置，例如 TEST 或 UAT。

如果然后在项目属性页面的 Build 选项卡上将“条件编译符号”设置为 TEST（例如），则可以使用诸如

```
#if (DEBUG || TEST )
    //Code that will not be executed in RELEASE or UAT
#endif 
```

您可以出于特定原因使用此构造，例如，如果您有需要，可以使用不同的客户端，甚至可以使用整个 Web 方法。过去我们也使用过它，其中一些命令会导致特定硬件出现问题，因此我们在部署到硬件 X 时为应用程序配置了一个配置。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-02-11T05:33:40.777

您可以创建自己的条件编译时符号（您喜欢的任何名称）。转到“项目构建对话框”，位于项目属性框中，菜单选项：项目-> [项目名称] 属性...

您还可以在“C# 代码文件的顶部”定义它们。像：

```
#define RELEASE
// or
#undef RELEASE 
```

您可以在#if 语句中使用该符号：

```
#if RELEASE
// code ...
#elif …
// code ...
#endif

// or

#if !RELEASE
// code ...
#endif 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-11-26T18:20:36.233

虽然[M4N 的答案](https://stackoverflow.com/a/507723/361842)( `#if (!DEBUG)`) 最有意义，但另一种选择可能是使用预处理器来修改其他标志的值；例如

```
bool isRelease = true;
#if DEBUG
    isRelease = false;
#endif 
```

或者更好，而不是指我们是否处于发布模式或调试模式，使用定义预期行为的标志并根据模式设置它们：

```
bool sendEmails = true;
#if DEBUG
    sendEmails = false;
#endif 
```

这与使用预处理器标志不同，因为标志仍然存在于生产中，因此`if (sendEmails) {/* send mails */}`每次调用该代码时都会产生开销，而不是存在于发布中但不存在于调试中的代码，但这可能是有利的；例如，在您的测试中，您可能想`SendEmails()`在模拟中调用您的方法，同时在调试中运行以获得额外的输出。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-08-05T09:52:34.577

另外一个选项：

```
#If CONFIG = "Release" Then

....

#End If 
```

* * *

## 回答 #12

> 赞同：-8
> 
> 时间：2009-02-03T16:03:30.947

为什么不只是

```
#if RELEASE
#undef DEBUG
#endif 
```

# curl - cURL 登录 login.live.com

> ID：507712
> 
> 赞同：4
> 
> 时间：2009-02-03T15:59:22.810
> 
> 标签：curl, live, login-script

我正在尝试通过 cURL 登录 live.com

以前有人试过吗？然后你可以发布你的脚本吗？

谢谢

我现在正在使用这个命令...

curl --cookie cjar3 --cookie-jar cjar3 --data 'PPSX=P&PwdPad=&type=&login=xxx@xxx.xxx&passwd=xxxxxxxxx&SI= Accedi &radio=2' --location --output /home/mauripz/temp/Nuova /loginresult.html [https://login.live.com/ppsecure/post.srf](https://login.live.com/ppsecure/post.srf)

但我收到“错误的电子邮件或密码”错误

更新：仅使用一个 --data 但仍然得到相同的错误

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T01:11:12.210

不幸的是，我还没有为 live.com 做这件事，所以我无法为您提供脚本。但是，我在使用 cURL 登录 Salesforce.com 时遇到了类似的情况，希望可以为您指明正确的方向。

live.com 的登录表单有一个名为 OnSigninSubmit 的 onsubmit 函数。该脚本位于 ( [https://login.live.com/pp650/JS/PPPrimary.js?x=6.5.11760.0](https://login.live.com/pp650/JS/PPPrimary.js?x=6.5.11760.0) ) 并已被 MS 最小化。我在[http://pastebin.com/f34f2593b](http://pastebin.com/f34f2593b)中使它更具可读性。

为了防止脚本向登录表单发送垃圾邮件，Microsoft 可能会操纵表单数据并添加额外的字段或修改您使用其 Javascript 函数提交的字段。您需要为要提交的用户名/密码重新创建这些条件。

# sql-server - 有人在 SQL Server 中使用 Service Broker 吗？

> ID：507721
> 
> 赞同：23
> 
> 时间：2009-02-03T16:00:35.117
> 
> 标签：sql-server, sql-server-2005, sql-server-2008, service-broker

当我参加 Microsoft 的 SQL Server 2008 演示文稿时，他们快速浏览了一下我们正在使用的功能。原来，整个报告厅里，只有我公司在使用Service Broker。这让我很惊讶，因为我认为会有更多的人使用它。

我对 SB 的经验是，它的工作做得很好，但管理起来非常困难，而且很难获得概览。

那么，您是否考虑过使用 Service Broker？如果不是，为什么不呢？你改用 MSMQ 了吗？SQL Server 2008 中是否有任何内容可以让您考虑使用 Service Broker。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-04T01:52:53.377

在 SQL 2005 发布几个月后，我一直在使用 SQL Service Broker。我们在这里不间断地使用它，每天通过它发送数十万条消息。

我们使用它来将数据从临时表加载到生产表，这样加载临时表的服务就不必等待数据实际处理，它可以返回并获取更多数据来加载。

我们使用它来排队从文件系统中删除文件。（当行被删除时，文件也需要被删除。）

在以前的公司，我用它来打印贷款文件和发送给客户的支票。

我什至使用 Service Broker 进行从 OLTP 数据库到 OLAP 数据库的 ETL 以进行实时报告。

大多数人（尤其是 DBA）不喜欢 Service Broker，因为它没有任何 UI。如果您想使用服务代理或查看它在做什么，您必须实际编写和运行一些 T/SQL。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-04T00:49:18.653

我在 2005 年使用 SB 大约两年了，其中一个实现每天处理数十万条消息。我想说最大的挑战不是架构，而是理解所涉及的所有细微差别。微软的文档很差，很少有实际的例子。[Remus Rusanu 的博客](http://rusanu.com/blog/)在处理对话重用和激活存储过程调整等方面确实很有帮助。我发现尽可能多地重用对话框（并处理与之相关的所有相关锁定）以及将多个接收到的消息作为一组而不是一次处理一个是非常重要的。

监控 SB 可能会很痛苦。您基本上依靠一堆系统视图来告诉您发生了什么。孤立的消息是一种痛苦。有很多小陷阱可以，嗯，getcha。

除了问题，也没有那么多，我认为它确实比我预期的要好。由于 SB 已集成到数据库中，因此没有单独的消息队列可以在数据库之外进行备份。这一切在事务上都是一致的。性能很好。这是一个很好的解决方案。

我会再次使用它并将继续使用它。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-14T00:13:20.810

在我现在的公司，我们对 SB 的使用与其他海报的使用有些不同。我们在SQL2005中主要使用SB作为管理工具。例如，我们使用它来管理对存在于大量其他不可变数据库中的一小组可变表的更新。所有消息都在同一实例上运行的服务之间，消息量非常低。

我对 SB 的经验是，正确设置可能有点“繁琐”，而且正如您在问题中提到的那样，由于没有单一的监控工具，因此很难对 SB 的状态进行概述。

尽管如此，我们发现它作为一种以可追溯和可靠的方式自动化大量数据库管理任务的方式非常有价值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-03T16:16:53.087

我最近考虑在一个项目中使用 Service Broker，但是是的，我决定改用 MSMQ。

我们的架构由许多（集群）服务器组成，每个服务器都需要将信息可靠地写入单个 SQL 实例。

据我了解，SB 仅适用于 SQL 到 SQL 的通信，因此我们需要在每个集群框上都有一个 SQL 实例。我们觉得这有点不必要，因此使用 MSMQ

老实说，我想不出我会使用 SB 的场景——我有兴趣更多地了解你的场景，看看我是否遗漏了一些重要的东西。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-09-29T06:08:33.937

Service Broker 可用于需要在分布式架构中完成自动化的各种情况。此类应用程序从各种设备接收事件并需要可靠地完成处理。来自设备（检测）或传感器的事件用于处理自动化逻辑。在多个数据库或应用程序之间进行数据交换。

我希望SB**的**实施可以更加**安全**可靠

 **# c# - WPF ListBox 或 ComboBox 中的 ItemActivated 事件

> ID：507736
> 
> 赞同：1
> 
> 时间：2009-02-03T16:04:11.117
> 
> 标签：c#, .net, wpf, combobox, listbox

WPF ListBox 或 ComboBox 控件中是否存在 ItemActivated 事件（如在 Windows 窗体中）？我一个都看不到

没有一些事件做同样的事情似乎很疯狂——所以它只是换了个名字吗？如果没有，还有其他简单的方法吗？我看过各种关于此的博客文章，但它们似乎都涉及子类化控件和其他类似的东西。我确信 WPF 设计人员意识到这几乎是使用 ListBox 或 ComboBox 完成的最常见的事情！

我基本上是在寻找一个在激活项目时将触发的事件，告诉我哪个项目已激活并允许我访问该项目的属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T16:12:23.003

根据我对您的描述的理解，您想查看 SelectedItem （个人）和 SelectedItems （集合）属性。此外，应该有一个 SelectionChanged 事件（尽管我不确定那里的命名）。

# java - 使用远程服务的 Java 序列化和实例共享

> ID：507738
> 
> 赞同：0
> 
> 时间：2009-02-03T16:04:21.770
> 
> 标签：java, serialization, remoting

我目前正在考虑 Java Swing WebStart 应用程序（胖客户端）和在 Tomcat 上运行的一些远程服务之间的远程处理/序列化的一些设计细节。我想使用 http 兼容的传输与服务器通信，因为我已经在使用 Spring，我认为 Spring 的 HTTP Remoting 是一个不错的选择。但我对这里的其他选择持开放态度。我的设计问题最好用一些小例子来说明

客户端将调用远程端的一些服务。示例服务接口：

```
public interface ServiceInterface extends Serialiazable {
    // Get immutable reference data
    public List<Building> getBuildings();
    public List<Office> getOffices();

    // Create, read and update Employee objects
    public insertEmployee(Employee employee);
    public Employee getEmployee();
    public void updateEmployee(Employee employee);
} 
```

Building 和 Office 是不可变的引用数据对象，例如

```
public Building implements Serializable {
    String name;
    public Building(String name) { this.name = name; }
    public String getName() { return name; }
}

public Office implements Serializable {
    Building building;
    int maxEmployees;
    public Office(Building building, int maxEmployess) {
        this.building = building;
        this.maxEmployees = maxEmployees;
    }
    public Building getBuilding() { return building; }
    punlic int getMaxEmployees() { retrun maxEmployees; }
} 
```

可用的建筑物和办公室在运行时不会改变，并且应该由客户端预先设置以具有可供选择列表、过滤条件...我希望客户端上的每个特定建筑物和办公室只有一个实例和一个实例在服务器端。在服务器端这不是一个大问题，但在我看来，当我在 getBuildings() 之后调用 getOffices() 时，问题就从这里开始了。getOffices() 返回的 Buildings 共享相同的 Buildings 实例（如果它们分配了相同的 Buildings），但 getOffices() 返回的 Buildings（在 Office 对象中引用）与 getBuildings() 返回的 Buildings 实例不同。

这可以通过使用一些 getReferenceDate() 方法在同一个调用中返回两个信息来解决，但是如果我有员工引用办公室，问题就会开始。

我正在考虑一些自定义序列化（readObject，writeObject）只传输主键，而不是从某个保存引用数据对象的类中获取对象的实例。但这是解决这个问题的最佳方案吗？我假设这个问题不是一个罕见的问题，但在谷歌上没有找到任何东西。有更好的解决方案吗？如果没有，实现它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T16:27:19.790

如果您要序列化，您可能需要实现 readResolve 以保证您不会创建额外的实例：

来自 Serializable 的 javadoc：

> 当从流中读取实例时需要指定替换的类应该使用精确的签名实现这个特殊方法。
> 
> ANY-ACCESS-MODIFIER 对象 readResolve() 抛出 ObjectStreamException；

我似乎记得在枚举前的日子里读过这种方法来处理必须保证是单数的对象的序列化，比如类型安全的枚举。

我还强烈建议您在序列化类中包含手动 serialVersionUID，以便您可以手动控制应用程序何时决定您的类表示无法反序列化的不兼容版本。

然而，在更基本的层面上，我会质疑整个方法 - 而不是试图通过网络保证对象身份，这听起来至少是一场并发噩梦，为什么不只是传递原始数据和你的逻辑是否通过 id 来确定身份，就像我们在我祖父时代所做的那样？您的后端有一个构建对象，它从前端获取一个，通过 ID 进行比较（如果您更改了前端的对象，则必须将对象提交到中央数据存储并确定更改的内容，这可能是与多个客户端的同步问题，但无论如何你都会遇到这个问题）。

通过 Spring-httpclient 远程传递数据非常简单，比 RMI 低级一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T16:12:52.613

首先，我建议您使用[RMI](http://java.sun.com/docs/books/tutorial/rmi/index.html)进行远程处理，它可以通过 HTTP (IIRC) 代理。其次，如果你序列化ServiceInterface，我相信序列化机制将维护它在远程JVM中反序列化时的相对引用。

# visual-studio - VS 安装程序自定义操作问题

> ID：507743
> 
> 赞同：2
> 
> 时间：2009-02-03T16:05:25.623
> 
> 标签：visual-studio, installation, custom-action

如果您有一个 Web 应用合并模块和一个 exe 合并模块包含在同一个设置部署项目中，则每个合并模块的自定义操作中的 Context.Parameters["AssemblyPath"] 值会变得混乱。尝试创建一个包含 web 项目和应用程序项目的 setup-deployment 项目，如下所示：

1.  创建一个 Web 项目
2.  为该 Web 项目创建一个合并模块
3.  创建一个常规的 App 项目
4.  为该应用创建合并模块
5.  创建一个包含上述两个合并模块的安装项目
6.  为自定义安装程序创建一个项目。
7.  在 Commit() 方法覆盖中，访问 Context.Parameters["AssemblyPath"] 并调试打印出值。
8.  将此自定义操作项目输出添加到您的两个合并模块。现在进行安装。根据调用此自定义操作的合并模块，您会期望打印不同的值。但他们是一样的！有时是 c:\inetpub\wwwroot 有时是 C:\MyAppDir...

不过，合并模块文件确实在正确的位置结束：
Web 项目内容进入 C:\Inetpub\wwwroot\
，而 App 项目进入“模块可重定向文件夹”。
您还会注意到每个合并模块中包含的 customactions.dll 最终会出现在正确的位置（在一个情况下是 c:\inetpub\wwwroot\，在另一个情况下是“模块可重定向文件夹”）。

但是 Context.Parameters["AssemblyPath"] 的调试打印将在两种情况下（即两个合并模块）显示相同的值。它都是 C:\Inetpub\wwwroot\CustomActions.dll 或`<targetdir>`\CustomActions.dll。这是错误的！

当调试打印来自基于 Web 项目的合并模块 时，调试打印应该显示C:\Inetpub\wwwroot\CustomActions.dll，当调试打印来自基于`<targetdir>`应用项目的合并模块时，应该显示 \CustomActions.dll。

有人知道为什么每个合并模块的值没有更新吗？这是 Microsoft VS 中的错误吗？

# java - 你能解释一下流的概念吗？

> ID：507747
> 
> 赞同：197
> 
> 时间：2009-02-03T16:06:44.683
> 
> 标签：java, .net, stream, language-agnostic, iostream

我知道流是字节序列的表示。每个流都提供了读取和写入字节到其给定后备存储的方法。但是流的意义何在？为什么我们与之交互的不是后备存储本身？

无论出于何种原因，这个概念对我来说并不适用。我读过很多文章，但我想我需要一个类比什么的。

* * *

## 回答 #1

> 赞同：249
> 
> 时间：2009-02-03T16:26:33.410

之所以选择“流”这个词，是因为它代表（在现实生活中）与我们在使用它时想要传达的意思非常相似。

让我们暂时忘记后备存储，并开始考虑与水流的类比。您会收到持续不断的数据流，就像河流中不断流动的水一样。您不一定知道数据来自哪里，而且大多数情况下您也不需要；无论是来自文件、套接字还是任何其他来源，它都（不应该）真的很重要。这与接收水流非常相似，您无需知道它来自哪里；无论是来自湖泊、喷泉还是任何其他来源，都（不应该）真正重要。

也就是说，一旦你开始认为你只关心获取你需要的数据，不管它来自哪里，其他人谈论的抽象就会变得更加清晰。你开始认为你可以包装流，你的方法仍然可以完美地工作。例如，您可以这样做：

```
int ReadInt(StreamReader reader) { return Int32.Parse(reader.ReadLine()); }

// in another method:
Stream fileStream = new FileStream("My Data.dat");
Stream zipStream = new ZipDecompressorStream(fileStream);
Stream decryptedStream = new DecryptionStream(zipStream);
StreamReader reader = new StreamReader(decryptedStream);

int x = ReadInt(reader); 
```

如您所见，在不更改处理逻辑的情况下更改输入源变得非常容易。例如，要从网络套接字而不是文件读取数据：

```
Stream stream = new NetworkStream(mySocket);
StreamReader reader = new StreamReader(stream);
int x = ReadInt(reader); 
```

尽可能简单。并且美丽还在继续，因为您可以使用任何类型的输入源，只要您可以为它构建一个流“包装器”。你甚至可以这样做：

```
public class RandomNumbersStreamReader : StreamReader {
    private Random random = new Random();

    public String ReadLine() { return random.Next().ToString(); }
}

// and to call it:
int x = ReadInt(new RandomNumbersStreamReader()); 
```

看？只要您的方法不关心输入源是什么，您就可以通过各种方式自定义您的源。抽象允许您以一种非常优雅的方式将输入与处理逻辑分离。

请注意，我们自己创建的流没有后备存储，但它仍然完美地服务于我们的目的。

因此，总而言之，流只是一个输入源，隐藏（抽象）另一个源。只要您不破坏抽象，您的代码就会非常灵活。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2009-02-03T16:09:32.463

关键是您不必知道后备存储是什么——它是对它的抽象。*实际上，甚至可能*没有后备存储——您可能正在从网络读取数据，而数据根本不会“存储”。

如果您可以编写无论您是在与文件系统、内存、网络还是其他任何支持流思想的东西对话的代码，那么您的代码都会更加灵活。

此外，流通常链接在一起 - 您可以有一个流来压缩放入其中的任何内容，将压缩形式写入另一个流，或加密数据等。在另一端会有相反的情况链，解密，解压缩或其他。

* * *

## 回答 #3

> 赞同：30
> 
> 时间：2009-02-03T16:08:13.840

流的重点是在您和后备存储之间提供一个抽象层。因此，使用流的给定代码块不需要关心后备存储是否是磁盘文件、内存等......

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-03T16:13:05.670

这不是关于溪流——而是关于游泳。如果您可以游一条溪流，那么您可以游过任何遇到的溪流。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-03T16:22:30.877

要添加到回声室，流是一种抽象，因此您不必关心底层存储。当您考虑有和没有流的场景时，这是最有意义的。

文件在很大程度上是无趣的，因为流并没有超出我熟悉的非基于流的方法所做的太多。让我们从互联网文件开始。

如果我想从 Internet 下载文件，我必须打开 TCP 套接字，建立连接并接收字节，直到没有更多字节为止。我必须管理一个缓冲区，知道预期文件的大小，并编写代码来检测何时断开连接并适当地处理它。

假设我有某种 TcpDataStream 对象。我使用适当的连接信息创建它，然后从流中读取字节，直到它说没有更多字节了。流处理缓冲区管理、数据结束条件和连接管理。

通过这种方式，流使 I/O 更容易。您当然可以编写一个 TcpFileDownloader 类来完成流所做的事情，但是您有一个特定于 TCP 的类。大多数流接口只是提供了一个 Read() 和 Write() 方法，任何更复杂的概念都由内部实现处理。因此，您可以使用相同的基本代码来读取或写入内存、磁盘文件、套接字和许多其他数据存储。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-02-03T18:47:28.680

我使用的可视化是传送带，不是在真实的工厂中，因为我对此一无所知，而是在卡通工厂中，物品沿着线条移动，并被一系列愚蠢的设备盖章、装箱、计数和检查。

您有一些简单的组件可以做一件事，例如将樱桃放在蛋糕上的设备。该设备具有无樱桃蛋糕的输入流和带有樱桃的蛋糕的输出流。以这种方式构建处理结构有三个优点值得一提。

首先，它简化了组件本身：如果你想在蛋糕上涂上巧克力糖衣，你不需要一个了解蛋糕一切的复杂设备，你可以创建一个愚蠢的设备，将巧克力糖衣粘在任何东西上（在漫画，这甚至不知道下一个项目不是蛋糕，而是Wile E. Coyote）。

其次，您可以通过将设备放入不同的序列来创建不同的产品：也许您希望您的蛋糕在樱桃上涂上糖衣而不是在糖衣上涂上樱桃，您可以通过在线交换设备来做到这一点.

第三，设备不需要管理库存、装箱或拆箱。聚合和包装事物的最有效方式是多变的：也许今天您将蛋糕放入 48 个一盒的盒子中，然后用卡车运送出去，但明天您想根据定制订单发送 6 个一盒的蛋糕。这种变化可以通过更换或重新配置生产线起点和终点的机器来适应；无需更改生产线中间的樱桃机即可一次处理不同数量的项目，它始终一次处理一个项目，并且不必知道其输入或输出如何被分组。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2016-01-24T11:41:01.103

当我第一次听说流媒体时，那是在使用网络摄像头进行**实时流媒体的背景下。**因此，一台主机正在广播视频内容，而另一台主机正在接收视频内容。那么这是流媒体吗？嗯……是的……但是直播是一个具体的概念，我认为这个问题是指流媒体的抽象概念。见[https://en.wikipedia.org/wiki/Live_streaming](https://en.wikipedia.org/wiki/Live_streaming)

所以让我们继续。

* * *

视频不是唯一可以流式传输的资源。音频也可以流式传输。所以我们现在谈论的是流媒体。请参阅[https://en.wikipedia.org/wiki/Streaming_media](https://en.wikipedia.org/wiki/Streaming_media)。音频可以通过多种方式从源传送到目标。因此，让我们比较一些数据传递方法。

**经典文件下载** 经典文件下载不会实时发生。在使用该文件之前，您必须等到下载完成。

**渐进式下载** 渐进式下载块将数据从流媒体文件下载到临时缓冲区。该缓冲区中的数据是可用的：缓冲区中的音频-视频数据是可播放的。因此，用户可以在下载时观看/收听流媒体文件。快进和快退是可能的，在缓冲区之外。无论如何，渐进式下载不是直播。

**流**式传输 实时发生，并分块数据。流媒体是在直播中实现的。收听广播的客户端不能快进或快退。在视频流中，数据在播放后被丢弃。

流服务器与其客户端保持双向连接，而 Web 服务器在服务器响应后关闭连接。

* * *

音频和视频不是唯一可以流式传输的内容。让我们看一下 PHP 手册中的流的概念。

> 流是表现出可流式行为的资源对象。也就是说，它可以以线性方式**读取**或**写入**，并且可以 fseek() 到流中的任意位置。链接：[https ://www.php.net/manual/en/intro.stream.php](https://www.php.net/manual/en/intro.stream.php)

在 PHP 中，资源是对外部源（如文件、数据库连接）的引用。换句话说，流是可以读取或写入的源。因此，如果您使用过`fopen()`，那么您已经使用过流。

受流式处理的文本文件的示例：

```
// Let's say that cheese.txt is a file that contains this content: 
// I like cheese, a lot! My favorite cheese brand is Leerdammer.
$fp = fopen('cheese.txt', 'r');

$str8 = fread($fp, 8); // read first 8 characters from stream. 

fseek($fp, 21); // set position indicator from stream at the 21th position (0 = first position)
$str30 = fread($fp, 30); // read 30 characters from stream

echo $str8; // Output: I like c 
echo $str30; // Output: My favorite cheese brand is L 
```

Zip 文件也可以流式传输。最重要的是，流媒体不仅限于文件。HTTP、FTP、SSH 连接和输入/输出也可以流式传输。

* * *

维基百科对流媒体的概念有什么看法？

> 在计算机科学中，流是随时间可用的一系列数据元素。流可以被认为是传送带上一次处理一个而不是大批量处理的项目。

请参阅：[https](https://en.wikipedia.org/wiki/Stream_%28computing%29) ://en.wikipedia.org/wiki/Stream_%28computing%29 。

维基百科链接到这个：[https](https://srfi.schemers.org/srfi-41/srfi-41.html) ://srfi.schemers.org/srfi-41/srfi-41.html ，作者对流有这样的说法：

> 流，有时称为惰性列表，是一种顺序数据结构，包含仅按需计算的元素。流要么为空，要么是其 cdr 中有流的对。由于流的元素仅在访问时才计算，因此流可以是无限的。

所以 Stream 实际上是一种数据结构。

* * *

我的结论：流是可以包含可以按顺序读取或写入的数据的源。流不会立即读取源包含的所有内容，它会按顺序读取/写入。

* * *

**有用的链接：**

1.  [http://www.slideshare.net/auroraeosrose/writing-and-using-php-streams-and-sockets-zendcon-2011](http://www.slideshare.net/auroraeosrose/writing-and-using-php-streams-and-sockets-zendcon-2011)提供了非常清晰的演示
2.  [https://www.sk89q.com/2010/04/introduction-to-php-streams/](https://www.sk89q.com/2010/04/introduction-to-php-streams/)
3.  [http://www.netlingo.com/word/stream-or-streaming.php](http://www.netlingo.com/word/stream-or-streaming.php)
4.  [http://www.brainbell.com/tutorials/php/Using_PHP_Streams.htm](http://www.brainbell.com/tutorials/php/Using_PHP_Streams.htm)
5.  [http://www.sitepoint.com/php-streaming-output-buffering-explained/](http://www.sitepoint.com/php-streaming-output-buffering-explained/)
6.  [http://php.net/manual/en/wrappers.php](http://php.net/manual/en/wrappers.php)
7.  [http://www.digidata-lb.com/streaming/Streaming_Proposal.pdf](http://www.digidata-lb.com/streaming/Streaming_Proposal.pdf)
8.  [http://www.webopedia.com/TERM/S/streaming.html](http://www.webopedia.com/TERM/S/streaming.html)
9.  [https://en.wikipedia.org/wiki/Stream_%28computing%29](https://en.wikipedia.org/wiki/Stream_%28computing%29)
10.  [https://srfi.schemers.org/srfi-41/srfi-41.html](https://srfi.schemers.org/srfi-41/srfi-41.html)

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-02-03T16:09:27.800

这只是一个概念，另一个抽象层次，让您的生活更轻松。它们都有共同的接口，这意味着您可以将它们以类似管道的方式组合起来。例如，编码为base64，然后压缩，然后将其写入磁盘，全部在一行中！

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-02-03T19:03:53.000

我见过的对流的最好解释是[SICP 的第 3 章](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-24.html#%_sec_3.5)。（您可能需要阅读前两章才能理解，但无论如何您都应该阅读。:-)

他们根本不使用 sterams 来表示字节，而是使用整数。我从中得到的要点是：

*   流是延迟列表
*   [在某些情况下，急切地提前计算所有内容]的计算开销是惊人的
*   我们可以使用流来表示无限长的序列

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2016-09-01T03:23:20.903

还有一点（对于读取文件的情况）：

1.  `stream`可以让你之前做些别的事情`finished reading all content of the file`。
2.  您可以节省内存，因为不需要一次加载所有文件内容。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-02-03T16:10:34.833

将流视为抽象的数据源（字节、字符等）。它们抽象了读取和写入具体数据源的实际机制，无论是网络套接字、磁盘上的文件还是来自 Web 服务器的响应。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2009-02-03T16:18:53.753

我认为您需要考虑后备存储本身通常只是另一个抽象。内存流很容易理解，但文件完全不同，具体取决于您使用的文件系统，更不用说您使用的硬盘驱动器了。并非所有流实际上都位于后备存储之上：网络流几乎就是流。

流的意义在于我们将注意力限制在重要的事情上。通过有一个标准的抽象，我们可以执行常见的操作。例如，即使您今天不想在文件或 HTTP 响应中搜索 URL，也不意味着您明天不希望这样做。

流最初是在内存与存储相比很小的时候构思的。仅仅读取一个 C 文件可能是一个很大的负担。最小化内存占用非常重要。因此，几乎不需要加载的抽象非常有用。今天，它在执行网络通信时同样有用，而且事实证明，在我们处理文件时，它很少受到限制。以一般方式透明地添加诸如缓冲之类的东西的能力使其更加有用。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-02-03T16:09:50.917

流是对字节序列的抽象。这个想法是你不需要知道字节来自哪里，你可以以标准化的方式读取它们。

例如，如果您通过流处理数据，那么如果数据来自文件、网络连接、字符串、数据库中的 blob 等等等，则对您的代码无关紧要。

与后备存储本身进行交互本身并没有错，除了它将您与后备存储实现联系在一起这一事实。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-02-03T16:12:41.957

流是一种抽象，它提供了一组用于与数据交互的标准方法和属性。通过从实际存储介质中抽象出来，您的代码可以在不完全依赖该介质是什么甚至该介质的实现的情况下编写。

一个很好的类比可能是考虑一个包。你不在乎一个包是用什么做的，或者当你把你的东西放进去时它会做什么，只要这个包能起到一个包的作用，你可以把你的东西拿出来。流为存储媒体定义了袋子的概念为袋子的不同实例（如垃圾袋、手提包、背包等）定义的内容——交互规则。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2013-02-13T22:59:26.953

我会保持简短，我只是在这里错过了这个词：

*流是通常存储在包含任何类型数据的缓冲区中的**队列。***

（现在，既然我们都知道什么是队列，就没有必要再解释了。）

# c# - 使用 C# 和 System.IO.Packaging 以编程方式从 Zip 存档中提取文件

> ID：507751
> 
> 赞同：49
> 
> 时间：2009-02-03T16:08:26.897
> 
> 标签：c#, zip, system.io.packaging

我有一堆急需进行分层重组和提取的 ZIP 文件。目前，我可以做的是创建目录结构并将 zip 文件移动到正确的位置。我缺少的神秘奶酪是从 ZIP 存档中提取文件的部分。

我在`ZipArchive`课堂上看过 MSDN 文章，并且对它们理解得很好。我还看到了[VBScript 提取](https://stackoverflow.com/questions/291406/extract-files-from-zip-file-with-vbscript). 这不是一个复杂的类，因此提取内容应该非常简单。事实上，它“大部分”都有效。我在下面包含了我当前的代码以供参考。

```
 using (ZipPackage package = (ZipPackage)Package.Open(@"..\..\test.zip", FileMode.Open, FileAccess.Read))
 {
    PackagePartCollection packageParts = package.GetParts();
    foreach (PackageRelationship relation in packageParts)
    {
       //Do Stuff but never gets here since packageParts is empty.
    }
 } 
```

问题似乎出在某个地方`GetParts`（或就此而言获得*任何东西）。*似乎打开的包裹是空的。深入挖掘调试器显示私有成员 _zipArchive 表明它实际上有部分。具有正确名称的零件和所有内容。为什么函数不会`GetParts`检索它们？我曾尝试将开放投射到 ZipArchive 并没有帮助。嗯。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2009-02-10T06:09:38.180

如果您正在处理 ZIP 文件，您可能需要查看第 3 方库来帮助您。

例如最近更新的 DotNetZip。当前版本现在是 v1.8。以下是创建 zip 的示例：

```
using (ZipFile zip = new ZipFile())
{
  zip.AddFile("c:\\photos\\personal\\7440-N49th.png");
  zip.AddFile("c:\\Desktop\\2005_Annual_Report.pdf");
  zip.AddFile("ReadMe.txt");

  zip.Save("Archive.zip");
} 
```

*这是一个更新*现有 zip的示例；您无需提取文件即可：

```
using (ZipFile zip = ZipFile.Read("ExistingArchive.zip"))
{
  // 1\. remove an entry, given the name
  zip.RemoveEntry("README.txt");

  // 2\. Update an existing entry, with content from the filesystem
  zip.UpdateItem("Portfolio.doc");

  // 3\. modify the filename of an existing entry 
  // (rename it and move it to a sub directory)
  ZipEntry e = zip["Table1.jpg"];
  e.FileName = "images/Figure1.jpg";

  // 4\. insert or modify the comment on the zip archive
  zip.Comment = "This zip archive was updated " + System.DateTime.ToString("G"); 

  // 5\. finally, save the modified archive
  zip.Save();
} 
```

这是一个提取条目的示例：

```
using (ZipFile zip = ZipFile.Read("ExistingZipFile.zip"))
{
  foreach (ZipEntry e in zip)
  {
    e.Extract(TargetDirectory, true);  // true => overwrite existing files
  }
} 
```

DotNetZip 支持文件名中的多字节字符、Zip 加密、AES 加密、流、Unicode、自解压档案。ZIP64 也适用于大于 0xFFFFFFFF 的文件长度，或具有超过 65535 个条目的档案。

自由。开源

[在codeplex](https://archive.codeplex.com/?p=dotnetzip)获取它 或[从 windows.net 直接下载](https://codeplexarchive.blob.core.windows.net/archive/projects/DotNetZip/DotNetZip.zip)- CodePlex 已停产并存档

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2009-02-03T17:21:09.963

来自[MSDN](http://blogs.msdn.com/msdnmagazine/archive/2007/05/16/2675596.aspx)，

在此示例中，使用了 Package 类（与 ZipPackage 相对）。在使用了这两种方法后，我只看到 zip 文件损坏时会出现片状问题。不一定是引发 Windows 提取程序或 Winzip 的损坏，而是打包组件无法处理的问题。

希望这会有所帮助，也许它可以为您提供调试问题的替代方法。

```
using System;
using System.IO;
using System.IO.Packaging;
using System.Text;

class ExtractPackagedImages
{
    static void Main(string[] paths)
    {
        foreach (string path in paths)
        {
            using (Package package = Package.Open(
                path, FileMode.Open, FileAccess.Read))
            {
                DirectoryInfo dir = Directory.CreateDirectory(path + " Images");
                foreach (PackagePart part in package.GetParts())
                {
                    if (part.ContentType.ToLowerInvariant().StartsWith("image/"))
                    {
                        string target = Path.Combine(
                            dir.FullName, CreateFilenameFromUri(part.Uri));
                        using (Stream source = part.GetStream(
                            FileMode.Open, FileAccess.Read))
                        using (Stream destination = File.OpenWrite(target))
                        {
                            byte[] buffer = new byte[0x1000];
                            int read;
                            while ((read = source.Read(buffer, 0, buffer.Length)) > 0)
                            {
                                destination.Write(buffer, 0, read);
                            }
                        }
                        Console.WriteLine("Extracted {0}", target);
                    }
                }
            }
        }
        Console.WriteLine("Done");
    }

    private static string CreateFilenameFromUri(Uri uri)
    {
        char [] invalidChars = Path.GetInvalidFileNameChars();
        StringBuilder sb = new StringBuilder(uri.OriginalString.Length);
        foreach (char c in uri.OriginalString)
        {
            sb.Append(Array.IndexOf(invalidChars, c) < 0 ? c : '_');
        }
        return sb.ToString();
    }
} 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2009-02-03T17:34:15.473

来自“ [ZipPackage 类](http://msdn.microsoft.com/en-us/library/system.io.packaging.zippackage%28VS.85,printer%29.aspx)”（MSDN）：

> 虽然包通过 ZipPackage 类存储为 Zip 文件*，但所有 Zip 文件都不是 ZipPackage。ZipPackage 具有特殊要求，例如符合 URI 的文件（部分）名称和定义包中包含的所有文件的 MIME 类型的“[Content_Types].xml”文件。ZipPackage 类不能用于打开不符合 Open Packaging Conventions 标准的任意 Zip 文件。
> 
> 有关详细信息，请参阅 ECMA 国际“开放包装约定”标准的第 9.2 节“映射到 ZIP 存档”，[http://www.ecma-international.org/publications/files/ECMA-ST/Office%20Open%20XML% 20Part%202%20(DOCX).zip](http://www.ecma-international.org/publications/files/ECMA-ST/Office%20Open%20XML%20Part%202%20(DOCX).zip) (342Kb) 或[http://www.ecma-international.org/publications/files/ECMA-ST/Office%20Open%20XML%20Part%202%20(PDF).zip](http://www.ecma-international.org/publications/files/ECMA-ST/Office%20Open%20XML%20Part%202%20(PDF).zip) (1.3Mb)
> 
> *您只需将“.zip”添加到任何基于 ZipPackage 的文件（.docx、.xlsx、.pptx 等）的扩展名中，即可在您最喜欢的 Zip 实用程序中打开它。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-04-09T12:01:35.523

我遇到了完全相同的问题！为了让 GetParts() 方法返回某些内容，我必须将 [Content_Types].xml 文件添加到存档的根目录，并为包含的每个文件扩展名添加一个“默认”节点。一旦我添加了这个（仅使用 Windows 资源管理器），我的代码就能够读取和提取存档内容。

有关 [Content_Types].xml 文件的更多信息，请参见此处：

[http://msdn.microsoft.com/en-us/magazine/cc163372.aspx](http://msdn.microsoft.com/en-us/magazine/cc163372.aspx) - 在文章的图 13 下方有一个示例文件。

```
var zipFilePath = "c:\\myfile.zip"; 
var tempFolderPath = "c:\\unzipped"; 

using (Package package = ZipPackage.Open(zipFilePath, FileMode.Open, FileAccess.Read)) 
{ 
    foreach (PackagePart part in package.GetParts()) 
    { 
        var target = Path.GetFullPath(Path.Combine(tempFolderPath, part.Uri.OriginalString.TrimStart('/'))); 
        var targetDir = target.Remove(target.LastIndexOf('\\')); 

        if (!Directory.Exists(targetDir)) 
            Directory.CreateDirectory(targetDir); 

        using (Stream source = part.GetStream(FileMode.Open, FileAccess.Read)) 
        { 
            FileStream targetFile = File.OpenWrite(target);
            source.CopyTo(targetFile);
            targetFile.Close();
        } 
    } 
} 
```

注意：此代码使用 .NET 4.0 中的 Stream.CopyTo 方法

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2009-02-10T06:51:13.680

我同意奶酪。System.IO.Packaging 在处理通用 zip 文件时很尴尬，因为它是为 Office Open XML 文档设计的。我建议使用[DotNetZip](https://archive.codeplex.com/?p=dotnetzip)或[SharpZipLib](http://icsharpcode.net/OpenSource/SharpZipLib/Default.aspx)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-21T08:34:49.190

（这基本上是[这个答案](https://stackoverflow.com/a/508103/57428)的改写）

原来`System.IO.Packaging.ZipPackage`它不支持 PKZIP，这就是为什么当你打开一个“通用”ZIP 文件时没有返回“部分”。此类仅支持某些特定风格的 ZIP 文件（请参阅[MSDN 描述](http://msdn.microsoft.com/en-us/library/system.io.packaging.zippackage%28v=vs.85%29.aspx)底部的注释），在 SDK 1.6 之前用作 Windows Azure 服务包 - 这就是为什么如果您解压缩服务包然后使用 Info-ZIP 重新打包它的原因打包程序将变为无效。

# apache-flex - 如何在 flex 中读取网络摄像头/麦克风的安全设置？

> ID：507753
> 
> 赞同：1
> 
> 时间：2009-02-03T16:09:15.117
> 
> 标签：apache-flex, security, webcam, microphone

我正在开发一个需要访问麦克风的 flex 应用程序。默认情况下，当我们的应用程序尝试访问麦克风时会显示安全首选项，但我们想在麦克风实际用于录制之前知道这些设置的值。这将使我们能够向用户显示帮助，例如，如果他们不小心点击了“拒绝”，然后想知道为什么他们在对着麦克风说话时听不到任何声音。如果我们看到用户尚未授予我们的应用程序权限，它还允许我们在应用程序生命周期的早期调用 Security.showSettings() - 这意味着在实际录制时闪光灯首选项弹出不会打扰用户我们的应用程序的一部分开始运行。

有没有办法在运行时实际*读取*我们网站的安全首选项的值？还是只能向用户显示安全设置面板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T21:59:22.893

您可能想尝试使用`Microphone.muted`和`Camera.muted`属性，看看它们是否会为您提供所需的内容。

来自文档（对于 Camera.muted）：

> “一个布尔值，指示用户在 Flash Player 隐私对话框中是拒绝访问相机 ( `true` ) 还是允许访问 ( )。当此值更改时，将调度状态事件。”`false`

# javascript - 在 Firefox 中动态设置 style.overflow 的问题

> ID：507754
> 
> 赞同：2
> 
> 时间：2009-02-03T16:09:27.657
> 
> 标签：javascript, firefox, html

我正在为客户开发网站，我们有以下要求：

1.  当浏览器宽度大于 960px 时不显示滚动条。
2.  当内容比浏览器宽但浏览器宽度大于960时不显示滚动条
3.  如果浏览器是 960 像素，则在需要时不显示滚动条。

我有以下 javascript 在 ie、chrome、safari 和 opera 下完美运行，但在 FF 中通过强制页面“重新加载”客户端（它重绘所有元素）而死。

```
function sizeHandler(myWidth) {
    if (myWidth > 960)
        document.documentElement.style.overflowX = 'hidden';
    else
        document.documentElement.style.overflowX = 'auto';
} 
```

因为似乎每个人都对内容提出质疑，所以这里是 HTML：

```
<body>
    <div id="flashContent">
        <object...>
        </object>
    </div>
</body>
<script...>$(document).ready(sizeHandler(getWidth()));</script> 
```

忽略 getWidth()，它可以工作，但我不想再添加 15 行；）。对象标签是一个闪存对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T21:31:05.387

尝试使用 document.body 而不是 document.documentElement。在 HTML 元素上设置 CSS 属性可能会产生意想不到的怪癖。

# unit-testing - 在 .NET 2.0+ 中使用构建后事件执行带有 MS 测试的单元测试

> ID：507757
> 
> 赞同：10
> 
> 时间：2009-02-03T16:09:39.217
> 
> 标签：unit-testing, build-process, mstest

我正在尝试在 .NET 3.5 中设置一个构建后事件，该事件将运行一套带有 MS 测试的单元测试。我发现[这篇](http://www.highoncoding.com/Articles/398_Using%20Post-Build%20Event%20to%20Execute%20Unit%20Tests.aspx)文章展示了如何使用 MbUnit 调用 bat 文件，但我想看看是否有人用 MS 测试做过这种事情？

如果是这样，我会对 bat 文件的样例感兴趣

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2011-11-18T21:02:01.857

We were using NUnit in the same style and decided to move to MSTest. When doing so, we just added the following to our Post-Build event of the applicable MSTest project:

```
CD $(TargetDir)
"$(DevEnvDir)MSTEST.exe" /testcontainer:$(TargetFileName) 
```

The full set of MSTest command line options can be found at the [applicable MSDN site](http://msdn.microsoft.com/en-US/library/ms182489.aspx).

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-03T16:11:59.760

我个人不建议将运行单元测试作为编译过程的一部分。相反，请考虑类似 ReSharper（+ 适当的单元测试运行程序或他们现在如何称呼这些）或其他一些 GUI 运行程序。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T16:26:15.270

而不是在构建后事件中进行，每次编译时都会发生这种情况，我会考虑设置一个像[CruiseControl.Net](http://confluence.public.thoughtworks.org/display/CCNET/Welcome+to+CruiseControl.NET)这样的持续集成服务器。它将为您提供一个紧密的反馈周期，但不会在您每次构建应用程序时都运行测试来阻止您的工作。

如果您想运行您当前正在开发的一组测试，Anton 建议使用[ReSharper](http://www.jetbrains.com/resharper/index.html)会很有效。您可以创建一个测试子集以在您希望时执行，并且它足够聪明，可以在需要时为您编译。当您在那里进行演示时，如果您还没有许可证，请选择[Team City](http://www.jetbrains.com/teamcity/index.html)。它是另一个有前途的 CI 服务器。

如果您想使用此方法来控制构建质量，您可能会发现随着测试数量的增加，您不再希望每次按 F5 测试更改时都等待运行 1000 个测试。

# login - 多域内网简单登录？

> ID：507765
> 
> 赞同：0
> 
> 时间：2009-02-03T16:11:28.107
> 
> 标签：login, dns, ntfs, intranet

我在 Windows 域上有一个 Intranet 服务器（服务器是 Windows 2003、IIS6、NTFS 权限）。它在域 Domain01 上。我有来自同一林中两个域的用户访问此 Intranet：Domain01 和 Domain02（DC 也运行 Windows 2003）。目前，用户需要通过输入以下任一方式登录：Domain01\username 或 username@Domain01

我的用户每次登录时都必须输入域，这让他们感到**完全和彻底的困惑。有没有什么方法可以让他们只输入用户名和密码而不输入域来登录？**比如让服务器默认尝试Domain01，如果登录失败则尝试Domain02？

注意：如果可能的话，我想通过 IIS 或服务器设置而不是通过编程来执行此操作（作为参考，我使用的是 ASP.NET 2.0）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T16:51:07.310

是的。通常我所做的是使用提供的用户名作为 sAMAccountName 进行全局目录搜索。使用 PrincipalSearcher 执行此操作需要获取底层 DirectorySearcher 并将其替换为 SearchRoot。一旦找到相应的用户对象，我就会从用户对象的路径中提取域并将其用作身份验证步骤的域。您如何进行身份验证取决于您需要它执行的操作。如果您不需要模拟，您可以使用[PrincipalContext.ValidateCredentials](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.principalcontext.validatecredentials.aspx)来确保用户名/密码使用[PrincipalContext](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.principalcontext.aspx)匹配，该 PrincipalContext 与您之前找到的用户帐户的域相匹配。如果您需要模拟，请查看[此参考](http://support.microsoft.com/kb/306158)。

```
// NOTE: implement IDisposable and dispose of this if not null when done.
private DirectoryEntry userSearchRoot = null;
private UserPrincipal FindUserInGlobalContext( string userName )
{
    using (PrincipalSearcher userSearcher = new PrincipalSearcher())
    {
        using (PrincipalContext context
                 = new PrincipalContext( ContextType.Domain ))
        {
            userSearcher.QueryFilter = new UserPrincipal( context );
            DirectorySearcher searcher
                 = (DirectorySearcher)userSearcher.GetUnderlyingSearcher();

            // I usually set the GC path from the existing search root
            // by doing some string manipulation based on our domain
            // Your code would be different.
            string GCPath = ...set GC path..

            // lazy loading of the search root entry.  
            if (userSearchRoot == null)
            {
                userSearchRoot = new DirectoryEntry( GCPath );
            }

            searcher.SearchRoot = userSearchRoot;
            using (PrincipalContext gcContext =
                     new PrincipalContext( ContextType.Domain,
                                           null,
                                           GCPath.Replace("GC://",""))
            {
                UserPrincipal userFilter = new UserPrincipal( gcContext );
                userFilter.SamAccountName = userName;
                userSearcher.QueryFilter = userFilter;
                return userSearcher.FindOne() as UserPrincipal;
            }
        }
    }
} 
```

# wcf - 有没有同时使用 WCF 和 .NET Remoting 的方法？

> ID：507774
> 
> 赞同：2
> 
> 时间：2009-02-03T16:12:23.940
> 
> 标签：wcf, remoting, wcf-binding

由于部署限制，我们无法在客户端（目前）部署 WCF，但希望在服务器端使用它。

我很想知道是否可以在服务器上使用 WCF，但在客户端使用 .NET 远程处理来使用它。在服务器端使用特定的绑定、传输或协议来实现这一点我没有任何问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T16:22:32.000

这绝对是可能的——[这是一个很好的起点](http://msdn.microsoft.com/en-us/library/aa730857(VS.80).aspx)。

# sql - SQL Server 2005 中 VARBINARY 字段的大小

> ID：507785
> 
> 赞同：67
> 
> 时间：2009-02-03T16:15:21.890
> 
> 标签：sql, sql-server, sql-server-2005, clr

我正在尝试`VARBINARY(MAX)`使用 SQL 确定 SQL Server 2005 中字段中内容的字节大小。由于我怀疑是否有对此的本机支持，是否可以使用 CLR 集成来完成？任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2009-02-03T16:24:29.390

实际上，你可以在 T-SQL 中做到这一点！

`DATALENGTH(<fieldname>)`将在`varbinary(max)`领域工作。

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-02-03T16:33:47.797

VARBINARY(MAX) 字段分配的可变长度数据最大不超过 2GB。

您可以使用 DATALENGTH() 函数来确定列内容的长度。

例如：

```
SELECT DATALENGTH(CompanyName), CompanyName
FROM Customers 
```

# delphi - 德尔福键盘挂钩

> ID：507791
> 
> 赞同：1
> 
> 时间：2009-02-03T16:16:50.653
> 
> 标签：delphi, winapi, api, hook

我在实现全局键盘挂钩时遇到了一个有趣的问题。

我编写了一个用于设置挂钩的 dll，然后是一个加载 dll 并处理挂钩结果的应用程序（Delphi）。这是今天下午在我的电脑上完成的，经过一些测试，我认为它可以 100% 工作。

我刚刚在家中测试了相同的应用程序和 dll，我没有收到任何错误，但该应用程序似乎也没有收到任何数据。

两台机器都是WinXP，虽然我的工作机器是SP2，而这台机器是SP3。

Win32 API 中是否有一些更改会导致此故障，或者问题是否与最近发布的某些 A/V/Spyware/MS 更新有关？

我希望这里有人会在我花费数小时调试之前知道一个明显的原因，这可能会发生。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T16:46:51.343

实际上，有些 A/V 不喜欢自制挂钩。我在某些机器上的鼠标钩子也有同样的问题，而且它不依赖于服务包版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-06T17:29:22.547

一种替代方法是使用低级键盘挂钩。（只是与 SetWindowsHookEx 不同的参数）。钩子在注册线程的消息循环中处理，因此不需要到处注入dll。由于某些奇怪的原因，VirusScanners/Firewalls 对它的干扰要小得多。他们经常默默地阻止 dllinjection 或正常的键盘钩子。如果您希望它在较旧的 Windows 版本中工作，也无需跨进程共享 hHook。如果您滥用键盘挂钩来实现全局热键（已经看到很多），请改用 RegisterHotkey/ [http://msdn.microsoft.com/en-us/library/ms646309.aspx](http://msdn.microsoft.com/en-us/library/ms646309.aspx)）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T16:24:40.140

您的家用计算机上有调试器吗？您是否通过钩子收到任何消息？可能是其他一些应用程序正在挂钩，并且没有将消息传递到挂钩链上吗？

顺便说一句：我喜欢用虚拟机进行这种测试。保持干净的 XP 安装。安装 SP2，并测试您的应用程序。回滚以再次全新安装，然后安装 SP3。再次尝试您的应用程序。这样你就会知道它是否是 SP3，因为没有其他东西可以搞砸了。我喜欢保留一组具有不同配置的快照。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T16:39:49.890

是的，我可以。我还没有在这台机器上安装 Delphi，但我想我可能必须安装。我要在这里寻找低垂的果实。如果有一个明显的答案，就没有必要经历所有调试的麻烦并希望找到可能是什么问题。

我的第一个怀疑是某个地方的 API 发生了变化。

正如我所提到的，这个应用程序在我的工作机器上运行得非常完美。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T09:13:51.507

你用的是哪种钩子？我曾经使用过`WH_CBT`-type 并且在某些其他应用程序运行时遇到了问题。我可以追溯到 Trillian 的一个案例，它似乎也做了某种挂钩（并且可能搞砸了）。

除此之外，我目前正在开发一个使用`WH_KEYBOARD`-hook 的应用程序，它同样适用于 SP2 和 SP3。MSDN 也没有提及任何与服务包相关的更改。

您可以采取哪些措施来跟踪家用机器上的错误：

*   确保检查所有系统 api 调用的所有结果值（并`GetLastError`在出现错误时使用）
*   在出现错误时提供某种调试输出（例如作为消息框或文本文件）
*   可选：记录一些状态消息，以便您了解内部发生的情况

# html - 后退按钮留下表单数据的最佳方式

> ID：507793
> 
> 赞同：4
> 
> 时间：2009-02-03T16:17:07.127
> 
> 标签：html, language-agnostic, forms, browser, back-button

我正在根据表单中的用户输入创建一个网页。在用户看到生成的页面后，我想让他们按下后退按钮并对表单进行更改。我想显示他们之前填写​​的表格。获得这种行为的最佳方法是什么（具有跨浏览器支持）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T16:48:55.003

> 在用户看到生成的页面后，我想让他们按下后退按钮并对表单进行更改。我想显示他们之前填写​​的表格。

无需添加任何巧妙的花哨代码；这是浏览器默认执行的操作，除非您采取积极措施来阻止它，例如：

*   使用 Cache-Control/Pragma 标头破坏缓存
*   从对 POST 的响应中生成表单页面本身（改用 POST-Redirect-GET）
*   从脚本生成表单元素

Cookie 解决方案很脆弱，如果您不希望同时打开两个选项卡变得非常混乱，则需要进行特殊处理。让自己轻松：让浏览器完成工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T16:19:54.517

将保存的信息作为分隔数据存储在 cookie 中。如果 cookie 存在，请重新填充表单。

如果您使用`document.formName.fieldName`语法，则不存在跨浏览器问题。

如果 cookie 被禁用，作为后备，您可以将其存储在服务器上并使用 AJAX 执行相同的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T16:22:36.150

JQuery 有一个很好的[cookie 插件](http://plugins.jquery.com/project/Cookie)，我用来在用户浏览网站寻找答案时保存考试数据。

# django - 我可以在 Django 中使用数据库视图作为模型吗？

> ID：507795
> 
> 赞同：62
> 
> 时间：2009-02-03T16:17:16.737
> 
> 标签：django, django-migrations, django-syncdb

我想使用我在数据库中创建的视图作为我的 django-view 的源。

这可能吗，不使用自定义sql？

******2009 年 13 月 2 日更新 ***********

就像许多答案所暗示的那样，您可以在数据库中创建自己的视图，然后通过在 models.py 中定义它来在 API 中使用它。

虽然有一些警告：

*   manage.py syncdb 将不再工作
*   视图在其名称的开头需要与所有其他模型（表）相同的东西，例如，如果您的应用程序被称为“事物”，那么您的视图将需要被称为 thing_$viewname

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-08-15T03:22:09.317

只是为那些会遇到这个问题的人（来自谷歌或其他）的更新......

目前 Django 有一个简单的“正确方法”来[定义模型而不管理数据库表](https://docs.djangoproject.com/en/1.8/ref/models/options/#django.db.models.Options.managed)：

> **选项管理**
> 
> 默认为`True`，这意味着 Django 将在其中创建适当的数据库表`syncdb`并将它们作为`reset`管理命令的一部分删除。也就是说，Django*管理*数据库表的生命周期。
> 
> 如果`False`，则不会对该模型执行任何数据库表创建或删除操作。如果模型表示现有表或已通过其他方式创建的数据库视图，这将很有用。这是 is时的*唯一*区别。模型处理的所有其他方面与正常情况完全相同。`managed``False`

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-02-03T17:13:10.493

从 Django 1.1 开始，您可以为此使用[Options.managed](https://docs.djangoproject.com/en/1.8/ref/models/options/#django.db.models.Options.managed)。

对于旧版本，您可以轻松地为视图定义模型类并像使用其他视图一样使用它。我刚刚使用基于 Sqlite 的应用程序对其进行了测试，它似乎工作正常。如果您的视图的“主键”列未命名为“id”，请确保添加主键字段，如果您的视图未命名为“app_classname”，请在元选项中指定视图的名称。

唯一的问题是“syncdb”命令会引发异常，因为 Django 将尝试创建表。您可以通过在与 models.py 不同的单独 Python 文件中定义“视图模型”来防止这种情况。这样，Django 在检查 models.py 以确定要为应用程序创建的模型时不会看到它们，因此不会尝试创建表。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2015-04-09T07:10:53.910

我刚刚使用带有 postgres 9.4 和 django 1.8 的视图实现了一个模型。

我创建了这样的自定义迁移类：

```
# -*- coding: utf-8 -*-
from __future__ import unicode_literals

from django.db import migrations

class Migration(migrations.Migration):

    dependencies = [
        ('myapp', '0002_previousdependency'),
    ]

    sql = """
    create VIEW myapp_myview as
     select your view here
    """

    operations = [
        migrations.RunSQL("drop view if exists myapp_myview;"),
        migrations.RunSQL(sql)
    ] 
```

我像往常一样编写模型。它适用于我的目的。

**注意**- 当我运行 makemigrations 时，为模型创建了一个新的迁移文件，我手动删除了该文件。

完全公开-我的视图是只读的，因为我使用的是从 jsonb 数据类型派生的视图并且没有编写 ON UPDATE INSTEAD 规则。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-07T02:56:26.443

我们已经在使用 MySQL 的应用程序中非常广泛地完成了这项工作，以解决 Django 的单一数据库限制。我们的应用程序有几个数据库存在于一个 MySQL 实例中。只要我们为“当前”数据库中的每个表创建了视图，我们就可以通过这种方式实现跨数据库模型连接。

就视图的插入/更新而言，在我们的用例中，视图基本上是“从 [db.table] 中选择 *；”。换句话说，我们不做任何复杂的连接或过滤，所以来自 save() 的插入/更新触发器工作得很好。如果您的用例需要如此复杂的连接或广泛的过滤，我怀疑您不会在只读场景中遇到任何问题，但可能会遇到插入/更新问题。我认为 MySQL 中有一些潜在的约束阻止您更新到跨表、具有复杂过滤器等的视图。

无论如何，如果您使用的是 MySQL 以外的 RDBMS，您的里程可能会有所不同，但 Django 并不真正关心它是否位于物理表或视图的顶部。将由 RDBMS 确定它是否真正按您的预期运行。正如之前的评论者所指出的，您可能会将 syncdb 扔出窗外，尽管我们使用 post-syncdb 信号成功解决了它，该信号删除了 Django 创建的物理表并运行我们的“创建视图...”命令。但是，post-syncdb 信号的触发方式有点深奥，所以也请注意。

编辑：当然，“post-syncdb 信号”是指“post-syncdb 监听器”

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-09-23T12:47:17.713

从[Django Official Documentation](https://docs.djangoproject.com/en/dev/topics/db/sql/#executing-custom-sql-directly)，您可以这样调用视图：

```
#import library
from django.db import connection

#Create the cursor
cursor = connection.cursor()

#Write the SQL code
sql_string = 'SELECT * FROM myview'

#Execute the SQL
cursor.execute(sql_string)
result = cursor.fetchall() 
```

希望能帮助到你 ;-）

# .net - 合并数据表列

> ID：507799
> 
> 赞同：0
> 
> 时间：2009-02-03T16:18:02.757
> 
> 标签：.net, asp.net, merge, datatable

您好我有两个数据表说：

表格1：

```
name  age
----  ---
Bob   40 
```

表 2：

```
auto kids
---- ----
3     3 
```

我想合并这两个表以获得类似的东西

```
name age auto kids
---  --- --- ----
Bob  40   3   3 
```

这可能吗？我尝试了合并，但它似乎不起作用，谢谢。

* * *

我不能做你们建议的原因是因为这两个数据来自两个不同的数据库（Oracle，SQL）。我不能使用链接服务器，因为速度不存在，您可以向我建议我可以以编程方式执行的操作吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T16:48:57.860

我将尝试添加前两个答案，以期让您更清楚，以防万一。什么 Stingy 和 Menace 想知道为什么你说的两张桌子看起来不像这样：

**Person**
PersonID（主键）
FirstName
LastName
Age

**Demographics**
DemographicsID（主键）
PersonID（外键）
Autos
Kids

...如果这两个表看起来像这样，那么您可以通过在 person 表中添加几列来组合它们，使其看起来像这样：

**Person**
PersonID（主键）
FirstName
LastName
Age
Autos
Kids

...然后执行这样的查询：

UPDATE Person p, Demographics d
SET
  p.Autos = d.Autos
  p.Kids = d.Kids
WHERE
  p.PersonID = d.PersonID

在上面的示例中，如果没有 Person 和 Demographics 表中的 PersonID 字段，我们不知道哪个 Demographic 记录与每个 Person 记录相关联。您需要知道这一点才能创建组合表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T16:21:13.563

合并只会合并具有相似架构的表的数据。

您可能必须遍历每个表并制作一个包含所有您想要的列的第三个表。

另外，我在这里看不到任何类型的关系键。如果你有这个，你可以建立一个数据关系，甚至不需要合并它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T16:21:53.843

这些表有什么关系？他们之间的关键是什么

```
select * from table1 t1
join table2 t2 on  <some magic where clause here> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-04-29T13:30:36.037

如果您想加入这两个数据表 - Table1(name,age) 和 Table2(auto,kids) 而不管列之间的任何连接，那么我更喜欢使用 Linq。在 Linq 中，您可以使用表的“rowIndex”连接两个或多个表。

尝试以下 VB.NET 代码：

```
Dim Table1, Table2, MergerTable As New DataTable

    Dim rs = From c In Table1.AsEnumerable()
        Join c1 In Table2.AsEnumerable() On Table1.Rows.IndexOf(c) Equals LicensDatum.Rows.IndexOf(c1)
                   Select New With
                   {
                        .a0 = c.Item(0),
                        .b0 = c.Item(0),
                        .a1 = c.Item(0),
                        .b1 = c1.Item(0)
                   }

    MergerTable = New DataTable()
    MergerTable.Columns.Add("name", GetType(String))
    MergerTable.Columns.Add("age", GetType(String))
    MergerTable.Columns.Add("auto", GetType(String))
    MergerTable.Columns.Add("kid", GetType(String))

    For Each row In rs.ToList()
        Dim tableRow = MergerTable.NewRow()
        tableRow.Item("name") = row.a0
        tableRow.Item("age") = row.b0
        tableRow.Item("auto") = row.a1
        tableRow.Item("kid") = row.b1
        MergerTable.Rows.Add(tableRow)
    Next 
```

如果您想以更高的类型安全性进行此合并，则可以使用这些类型。

# user-interface - 在 MFC 中检测单击鼠标

> ID：507802
> 
> 赞同：6
> 
> 时间：2009-02-03T16:18:50.027
> 
> 标签：user-interface, winapi, visual-c++, mfc

在 MFC 中，双击鼠标事件会触发以下消息序列

*   WM_LBUTTONDOWN
*   WM_LBUTTONUP
*   WM_LBUTTONDBCLK
*   WM_LBUTTONUP

因此，响应**WM_LBUTTONDBCLK**消息可以让您检测到双击。但是如果我只是想检测一下单击如何区分呢？

但仅查看**WM_LBUTTONUP**消息是不够的，因为它可能是单击，也可能是双击的第一次单击。

我如何才能成功识别单击？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-03T19:29:00.813

（请允许我将这些事件称为 Mouse Up 和 Mouse Down。我的 MFC 有点生疏了。还有一个叫做 .NET 的东西最近一直在搞乱我的术语 ;-)

**短篇小说**：您不只是想了解鼠标点击。你需要更多。

**长篇大论**：

尽管这是违反直觉的，但似乎只是想要单击鼠标是相当少见的。大多数情况下，您需要在 Mouse Down 上执行一些处理并在 Mouse Up 上进行一些进一步的处理。诀窍是仅仅跟踪 Mouse Up 消息是不够的：Mouse Down 可能没有在您的窗口中发生。你认为这是一次有效的点击吗？特别是考虑到没有发生 Mouse Down 处理（例如选择一个项目）。

进一步推理，在处理鼠标按下后，您不应该依赖接收鼠标向上：用户可能已经移动了鼠标并在其他地方释放了按钮（想想拖放），在这种情况下，您不需要接收 MouseUp 事件...除非您在 MouseDown 上捕获鼠标以确保即使鼠标离开您的窗口也能将鼠标事件提升到 Mouse Up。

总而言之，您最终会跟踪 Mouse Down，捕获鼠标，当您收到 Mouse Up 时，只需检查您是否拥有捕获。如果没有，鼠标要么被双击（没有第二次鼠标按下），要么鼠标按下发生在其他地方，因此你很可能不关心这个鼠标按下。

**总结**：没有 MouseClick 消息仅仅是因为你不会走得太远：你需要处理更多的消息并实现更多的机制。

哦！如果您正在处理已经处理所有这些项目和选择内容的现有控件，例如列表视图，它可能会提供类似的自定义通知，例如项目激活或项目选择已更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T16:44:00.413

我刚刚在 Delphi 中尝试过，行为是相同的：即使发生双击，单击事件也会在两者中的第一个之后立即发出。

我使用计时器解决了它，它的工作原理如下：

*   停用 WM_LBUTTONDBLCLK 上的计时器（并设置`bDbl`为`true`）
*   如果在 WM_LBUTTONUP 上激活计时器`bDbl==false`
*   `bDbl==true`如果（和重置`bDbl`）在 WM_LBUTTONUP 上停用

我将计时器的间隔设置为返回的时间`GetDoubleClickTime`。

MSDN 说：

> GetDoubleClickTime 函数检索鼠标的当前双击时间。双击是连续两次单击鼠标按钮，第二次在第一次之后的指定时间内发生。双击时间是双击的第一次和第二次单击之间可能发生的最大毫秒数。

如果计时器恰好触发，那么您将获得真正的点击。在我的情况下，双击间隔是 500 毫秒，所以任何“真正的点击”都会延迟这么长时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T16:25:13.180

您可以检查 WM_LBUTTONDOWN 在 WM_LBUTTONUP 之前是否被多次调用。实际上，Windows 会为您执行此操作，因为如果您获得 WM_LBUTTONDBCLK，您往往不会获得 WM_LBUTTONUP。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T16:30:02.313

您可以使用 PreTranslateMessage() 对出现的消息进行计数。如果您只收到与单击相对应的鼠标消息，并且系统配置的双击时间已过期，您可以放心地假定它是单击。

据我所知，没有办法知道这种情况正在发生，这是有道理的——在时间到期之前，没有办法知道第二次点击是否到来。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-03T16:30:21.250

这有点棘手。

我会检测 WM_LBUTTONDOWN 和 WM_LBUTTONUP 组合，将该事件存储在某处并设置一秒钟左右的超时。如果在该超时期间没有 WM_LBUTTONDBCLK，那么您只需单击一下。

这可能意味着您需要运行另一个线程，但我认为您可以使用一个线程来完成它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-04-12T10:00:14.463

我认为解决方案是在第一次单击后启动计时器，然后在下一次立即单击后检查经过的时间，这将告诉您是单击还是双击。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-02-03T16:25:02.823

您通常会查看@MLButtonUp，并且不会在同一个鼠标按钮上进行单击和双击行为。

# iphone - NSThread 在第二次调用时崩溃（iPhone）

> ID：507803
> 
> 赞同：2
> 
> 时间：2009-02-03T16:18:52.803
> 
> 标签：iphone, objective-c, cocoa, cocoa-touch, multithreading

我有一个对象，在那个对象中我启动了我的线程（用于加载做一些 URL 加载）。

当我返回我的数据时，我调用一个选择器在主线程上执行。

如果我第一次调用它可以正常工作，但第二次它崩溃（没有具体错误）。

```
[NSThread detachNewThreadSelector:@selector(doThread:)
                         toTarget:self
                       withObject:@"lala"];

-(void) doThread:(NSString *)poststring {
 NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

DataModelLocator *mydelegate = [DataModelLocator instance];
NSData *postData = [poststring dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:NO];
NSURL *url = [NSURL URLWithString:[mydelegate fwaservicepath]];

NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];

[request setURL:url];
[request setHTTPMethod:@"POST"];
[request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"content-type"];
[request setHTTPBody:postData];

NSURLResponse *urlResponse;

NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:&urlResponse error:nil];

if(data) {
    [self performSelectorOnMainThread:@selector(loadDidFinishWithData:)
                           withObject:data 
                        waitUntilDone:YES];
    //[self loadDidFinishWithData:data];
} else {
    [self performSelectorOnMainThread:@selector(loadDidFinishWithError:)
                           withObject:data 
                        waitUntilDone:YES];
}
[pool release];

}
} 
```

当我打电话时它崩溃`performSelectorOnMaintThread`了......它是否会在它被释放时在单例上崩溃？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T19:31:38.747

在处理线程时，避免像瘟疫这样的自动释放对象。自动释放池将在不确定的时间耗尽，导致有趣的崩溃。对所有涉及的对象使用 alloc/init 和 release，确保保留您在使用 performSelectorOnMainThread 或 detachNewThreadSelector 从另一个线程调用的方法上获取的所有对象。

Mac 上的垃圾收集功能有效地解决了这些问题，但 iPhone 不会很快拥有这样的功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T16:44:18.337

您可能想发布更多关于您的问题的信息（两行中的哪一行崩溃，到目前为止您从调试中发现的内容等），以便我们可以为您提供一些更好的建议。在不知道哪一行给你带来问题的情况下，我会冒险猜测：从它的声音来看，你可能在某个地方有一个对象正在被自动垃圾收集清理掉。

变量“数据”来自哪里？如果你在头文件中创建它作为私有成员变量，你可能会有类似的东西：

```
NSSomeType *data = [NSSomeType builtInInitFunction]; 
```

像这样初始化的变量通常会自动释放，但您可能希望确保垃圾收集保留该对象的实例。尝试类似：

```
// Objects initialized with init are retained
NSSomeType *data = [[NSSomeType alloc] init];

// Objects that would normally be autoreleased can be marked as retain
NSSomeType *data = [[NSSomeType builtInInitFunction] retain]; 
```

我不确定您的代码是如何构造的，但请确保为每个保留和初始化添加至少一个版本！我对 Objective-C 还是很陌生，所以这有点像盲人在引导盲人，所以请接受我的建议。

查看[学习 Objective-C 的“更多内存管理”部分了解](http://cocoadevcentral.com/d/learn_objectivec/ "学习 Objective-C")更多信息。

EDIT2：阐明了示例代码。感谢埃文（评论）的帮助。

EDIT3：我同意布拉德的观点。考虑删除您自己处理 alloc/init/release 的 AutoRelease 池。我对 NSURLConnection 对象知之甚少，无法知道这一点，但是您的 *data 内存是否被标记为 Autorelease？如果是这样，您可能需要以不同的方式初始化或使用保留。

在调试器中单步执行您的代码。弄清楚 A）到底哪条线崩溃了，然后 B）所有变量的值。如果你幸运的话，你会发现一个是零。

# c# - 我在哪里可以开始用 C# 编写媒体服务器，比如 PlayOn

> ID：507815
> 
> 赞同：14
> 
> 时间：2009-02-03T16:22:51.797
> 
> 标签：c#, asp.net, media, upnp, dlna

我在哪里可以开始用 C# 编写媒体服务器，例如 PlayOn [http://www.themediamall.com/playon](http://www.themediamall.com/playon)

更新：
我了解到 PlayOn 是一个 DLNA/UPnP 媒体服务器，但我仍在寻找此类服务器的 C# 示例实现。如果您可以向我指出一些示例代码，我将奖励它，我可以使用这些示例代码将照片和/或视频内容提供给 XBOX 360、Playstation 3、Media Center 或 Media Center Extenders 等媒体客户端

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-03T21:40:52.967

经过更多研究，我了解到 PlayOn 是一个[DLNA](http://www.dlna.org/industry/certification/guidelines/) / [UPnP](http://en.wikipedia.org/wiki/UPnP_AV_MediaServers)媒体服务器。关于它的信息不多，但有一些。如果有人可以参考一个很棒的例子。

这是我在发现我正在寻找[DLNA](http://www.dlna.org/industry/certification/guidelines/) / [UPnP后找到的一些链接](http://en.wikipedia.org/wiki/UPnP_AV_MediaServers)

[在 VB.NET 中创建 DLNA 服务器/服务](https://stackoverflow.com/questions/274470/creating-a-dlna-server-service-in-vb-net)

[C# UPNP/DNLA 媒体服务器库](https://stackoverflow.com/questions/418451/c-upnp-dnla-media-server-library)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-22T21:10:23.887

[这个](https://stackoverflow.com/questions/544152/connect-my-360-to-an-application)问题也可能有助于为您指明正确的方向。

[特别是白金 UPnP 库](http://www.plutinosoft.com/blog/projects/platinum)的公认答案点。虽然它是一个 C++ 库，但它看起来很有前途，而且我确信它可以与 C# 解决方案集成，或者至少为您提供自己实现的想法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-25T08:42:59.370

我的建议是不要编写你自己的服务器，因为[Windows Media Services](http://www.microsoft.com/windows/windowsmedia/9series/server.aspx) - 这是一个来自 Microsoft 的很棒的免费流媒体服务器已经可用。它专注于您如何流式传输、格式等的繁重工作......有据可查并易于理解，这使得部署更容易。然后，您的注意力可能会集中在它不擅长的领域，即客户端前端 - 即漂亮的 Web 或[Silverlight](http://www.theregister.co.uk/2008/01/09/silverlight_media_application_service/)界面，可能是视频的 RSS 提要。这应该不难，因为服务器 API 以及如何针对它编写代码[是有据可查](http://msdn2.microsoft.com/windowsmedia/)的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T17:25:00.173

[XNA工作室](http://msdn.microsoft.com/en-us/xna/default.aspx)？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T08:27:57.760

也许看看[Media Portal的代码库](http://www.team-mediaportal.com/)

这是开发者页面 [http://www.team-mediaportal.com/contribute_to_mediaportal.html](http://www.team-mediaportal.com/contribute_to_mediaportal.html)

Code plex 上还有一个媒体共享库，可能会有所帮助

[http://www.codeplex.com/blueportal](http://www.codeplex.com/blueportal)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-23T14:40:15.360

这里有几件事需要调查：

/whsUpnp360 UPnP MediaServer 使用 Intels SDK for Windows Home Server 和 Xbox 360（用 C# 编写）

[http://www.mperfect.net/whsUpnp360/](http://www.mperfect.net/whsUpnp360/)

用于 C# 的 UPnP 库？ [http://bytes.com/groups/net-c/741142-upnp-library-c](http://bytes.com/groups/net-c/741142-upnp-library-c)

# html - form action="" 和 form action="." 有什么区别？

> ID：507816
> 
> 赞同：11
> 
> 时间：2009-02-03T16:23:52.323
> 
> 标签：html, forms, action

有没有区别：

```
<form action=""> 
```

... 和：

```
<form action="."> 
```

?

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-03T16:28:40.367

空字符串通常表示当前 url（例如，`http://example.com/a/test.html`）
`'.'`- 当前的“目录”（例如，`http://example.com/a/`）

# javascript - 如何组织 css 和 js 文件的压缩和打包以加快网站速度？

> ID：507818
> 
> 赞同：12
> 
> 时间：2009-02-03T16:24:14.460
> 
> 标签：javascript, css, optimization, web, performance

我正在为我的网站应用程序进行速度优化。我找到了一些做法来做到这一点。例如从雅虎[加速您的网站的最佳实践。](http://developer.yahoo.com/performance/rules.html)其中有：

*   缩小 JavaScript 和 CSS。
*   通过将多个文件（css、js）合并为一个来最小化 HTTP 请求的数量。

我的问题是您使用或可以推荐哪些基础设施、工具和构建过程来执行这些？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-03T16:30:30.533

根据[JavaScript Compression Rater](http://compressorrater.thruhere.net/)，最有效的工具是[YUI Compressor](http://developer.yahoo.com/yui/compressor/)或[JSMin](http://crockford.com/javascript/jsmin)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T16:28:16.560

您可以使用[YUI 压缩器](http://www.julienlecomte.net/yuicompressor/)。

它可以压缩 JavaScript 和 CSS。只需为所有文件运行它，然后将它们连接到一个“包”文件中。您可以手动执行此操作，编写 Makefile 或使用一些脚本在 Web 请求上“即时”压缩，尽管您可能希望缓存生成的文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T16:34:00.307

雅虎提示非常好。我使用[gomez](http://www.gomez.com/instant-test-pro/index.php)来测试优化工作的结果。缩小是一个很好的步骤。我发现通常可以通过调整页面的组合方式来产生更大的影响（特别是在减少多少图像被切割成小块以减少请求数量方面）。无论如何，这个[雅虎博客](http://developer.yahoo.net/blog/archives/2007/07/high_performanc_8.html)提供了一个非常好的缩小工具纲要。我通常会远离混淆，除非除了相对较小的性能提升之外还有令人信服的理由。安装和使用缩小工具的实际步骤相对简单。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-10T03:25:00.833

我为此编写了自己的自定义管理器。它使用 google 的闭包编译器，仅在需要时在发布模式下压缩文件。一探究竟：

[http://www.picnet.com.au/blogs/Guido/post/2009/12/10/Javascript-runtime-compilation-using-AspNet-and-Googles-Closure-Compiler.aspx](http://www.picnet.com.au/blogs/Guido/post/2009/12/10/Javascript-runtime-compilation-using-AspNet-and-Googles-Closure-Compiler.aspx)

谢谢

圭多塔皮亚

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T22:58:27.380

我已将缩小集成到我的部署过程中。我在 perl 中使用[JavaScript::Minifier](http://search.cpan.org/~pmichaux/JavaScript-Minifier-1.05/lib/JavaScript/Minifier.pm)和[CSS::Minifier](http://search.cpan.org/~pmichaux/CSS-Minifier-0.01/lib/CSS/Minifier.pm)包。

在我的开发过程中，我想保持脚本的扩展。我在我的 HTML 中添加了一些注释，以便我的脚本知道将哪些文件放在一起并缩小：

```
<!--- MinifyJS[js/minified-1.js] -->
<script src="..."></script>
<script src="..."></script>
<!-- end[js/minified-1.js] -->

<!--- MinifyCSS[css/minified-1.css] -->
<link ...> 
```

几个正则表达式，我很快就得到了一个带有缩小文件的“生产”版本。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-03T17:42:20.670

或者您可以将您的 HTTP 服务器配置为 GZIP 压缩所有文本文档。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-03T20:11:54.610

我使用 ASP.NET，所以我在构建过程中使用带有 NAnt 的 CruiseControl.NET。这个构建过程的一部分是使用 YUICompressor 进行压缩，根据我的经验，它是目前最好的压缩器。

如果您不使用 ASP.NET，则仍然可以使用具有 Ant 的原始 CruiseControl，您可以在相同的容量中使用。

我发现这是一个优越的设置的原因是因为a）所有乏味的东西都是自动化的，b）如果你在自己的机器上进行测试，你不必调试一个超长的 JS 字符串 :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-03T16:32:12.293

Dean Edwards [/packer/](http://dean.edwards.name/download/)我自己的忠实粉丝 - 有多种口味。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-03T16:52:50.190

通过关注[yahoo 博客](http://developer.yahoo.net/blog/archives/2007/07/high_performanc_8.html)链接，我找到了一个真正的解决方案 - Niels Leenheer 的“[通过组合和压缩 javascript 和 css 文件使您的页面加载更快”。](http://rakaz.nl/item/make_your_pages_load_faster_by_combining_and_compressing_javascript_and_css_files)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-02-04T15:05:54.230

为了在上传到网络之前压缩所有内容，这个程序对于 CSS/JS/HTML 来说都很棒：

[http://www.w3compiler.com/](http://www.w3compiler.com/)

甚至可以选择不压缩的区域，因为并非标记中的所有 MVC 代码都支持压缩。

每次压缩文件时它都会保存备份文件，因此您只需单击一下即可轻松解压缩。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-02-06T11:21:03.727

我发现[Minify](http://code.google.com/p/minify/)对我的 PHP 项目最有用。非常易于使用，只需手动配置 CSS 和 JS 文件的最小化、压缩和缓存即可。还具有整洁的分组功能。

关于[YUI Compressor的一些注意事项](http://developer.yahoo.com/yui/compressor/)

1.  YUI Compressor 生成时完全没有换行符，而 Minify 有一些。
2.  如果您已经转义了字符串，请小心。我发现 YUI Compressor 使它们无法转义。所以像“\'”这样的字符串变成了“'”。

# floating-point - 浮点数的 PI 和精度

> ID：507819
> 
> 赞同：14
> 
> 时间：2009-02-03T16:24:18.313
> 
> 标签：floating-point, precision, floating-accuracy

Pi 的单/双/扩展精度浮点表示精确到小数点后几位？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-02-03T16:38:43.917

```
#include <stdio.h>

#define E_PI 3.1415926535897932384626433832795028841971693993751058209749445923078164062

int main(int argc, char** argv)
{
    long double pild = E_PI;
    double pid = pild;
    float pif = pid;
    printf("%s\n%1.80f\n%1.80f\n%1.80Lf\n",
    "3.14159265358979323846264338327950288419716939937510582097494459230781640628620899",
    pif, pid, pild);
    return 0;
} 
```

结果：

```
[quassnoi #] gcc --version
gcc (GCC) 4.3.2 20081105 (Red Hat 4.3.2-7)

[quassnoi #] ./test

3.14159265358979323846264338327950288419716939937510582097494459230781640628620899

3.14159274101257324218750000000000000000000000000000000000000000000000000000000000
        ^
3.14159265358979311599796346854418516159057617187500000000000000000000000000000000
                 ^
3.14159265358979311599796346854418516159057617187500000000000000000000000000000000
                 ^
  0000000001111111
  1234567890123456 
```

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-03-28T18:45:03.733

当我检查 Quassnoi 的答案时，我觉得这很可疑，`long double`并且`double`最终会得到同样的准确性，所以我挖了一点。如果我运行他用 clang 编译的代码，我会得到与他相同的结果。但是我发现，如果我指定`long double`后缀并使用文字来初始化 long double，它会提供更高的精度。这是我的他的代码版本：

```
#include <stdio.h>

int main(int argc, char** argv)
{
    long double pild = 3.14159265358979323846264338327950288419716939937510582097494459230781640628620899L;
    double pid = pild;
    float pif = pid;
    printf("%s\n%1.80f\n%1.80f\n%1.80Lf\n",
        "3.14159265358979323846264338327950288419716939937510582097494459230781640628620899",
        pif, pid, pild);
    return 0;
} 
```

结果：

```
3.14159265358979323846264338327950288419716939937510582097494459230781640628620899

3.14159274101257324218750000000000000000000000000000000000000000000000000000000000
        ^
3.14159265358979311599796346854418516159057617187500000000000000000000000000000000
                 ^
3.14159265358979323851280895940618620443274267017841339111328125000000000000000000
                    ^ 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-03T16:30:29.707

6 位和 14 位。1 位超过 0 为 3 位，虽然存储的最后一位不能被视为一个精度点。

抱歉，如果没有更多上下文，我不知道扩展意味着什么。你的意思是C#的小数点吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-08-08T00:21:37.277

Accuracy of a floating-point type is **not related to PI or any specific numbers**. It only depends on *how many digits are stored in memory* for that specific type.

In case of IEEE-754 `float` uses 23 bits of mantissa so it can be accurate to 23+1 bits of precision, or ~7 digits of precision in decimal. Regardless of π, e, 1.1, 9.87e9... all of them is stored with exactly 24 bits in a float. Similarly `double` (53 bits of mantissa) can store 15~17 decimal digits of precision.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T16:36:51.613

打印和计数，宝贝，打印和计数。（或阅读[规格](http://en.wikipedia.org/wiki/IEEE_754)。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-08-18T19:52:26.937

在 x86 浮点单元 (x87) 中有用于加载某些浮点常量的指令。例如，“fldz”和“fld1”将 0.0 和 1.0 加载到堆栈顶部“st”（又名“st(0)”）。另一个是“fldpi”。

所有这些值都有一个 64 位长的尾数，可以转换为接近 20 个十进制数字。通过 x87 内部使用的 80 位临时浮点格式可以实现 64 位。x87 也可以从 10 字节内存位置加载临时变量并将其存储到 10 字节内存位置。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T08:47:48.063

对于 C 代码，请查看`<float.h>`. 这包括`float`( `FLT_*`)、`double`( `DBL_*`) 和`long double`( `LDBL_*`) 定义。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-03T17:01:30.830

[World of PI](http://ja0hxv.calico.jp/pai/epivalue.html)有 PI 到 100,000,000,000 位，您可以打印和比较。对于一个稍微容易阅读的版本[，PI 的喜悦](http://www.joyofpi.com/pi.html)有 10,000 位数字。如果您想自己记住数字，可以尝试学习[Cadaeic Cadenza](http://www.cadaeic.net/cadintro.htm)诗。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-03-15T05:53:24.160

由于存在用于 pi 的二进制表示的筛方程，因此可以组合变量来存储值的片段以提高精度。此方法对精度的唯一限制是从二进制转换为十进制，但即使是有理数也会遇到问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-11-24T19:02:13.773

*** 编辑：查看这篇文章以获得最新的讨论：[使用标准 C 数学库实现 sinpi() 和 cospi()](https://stackoverflow.com/questions/42792939/implementation-of-sinpi-and-cospi-using-standard-c-math-library) ***

新的 math.h 函数`__sinpi()`为`__cospi()`我解决了 90 度等直角的问题。

```
cos(M_PI * -90.0 / 180.0) returns 0.00000000000000006123233995736766
__cospi( -90.0 / 180.0 )      returns 0.0, as it should

/*  __sinpi(x) returns the sine of pi times x; __cospi(x) and __tanpi(x) return
the cosine and tangent, respectively.  These functions can produce a more
accurate answer than expressions of the form sin(M_PI * x) because they
avoid any loss of precision that results from rounding the result of the
multiplication M_PI * x.  They may also be significantly more efficient in
some cases because the argument reduction for these functions is easier
to compute.  Consult the man pages for edge case details.                 */
extern float __cospif(float) __OSX_AVAILABLE_STARTING(__MAC_10_9, __IPHONE_NA);
extern double __cospi(double) __OSX_AVAILABLE_STARTING(__MAC_10_9, __IPHONE_NA);
extern float __sinpif(float) __OSX_AVAILABLE_STARTING(__MAC_10_9, __IPHONE_NA);
extern double __sinpi(double) __OSX_AVAILABLE_STARTING(__MAC_10_9, __IPHONE_NA);
extern float __tanpif(float) __OSX_AVAILABLE_STARTING(__MAC_10_9, __IPHONE_NA);
extern double __tanpi(double) __OSX_AVAILABLE_STARTING(__MAC_10_9, __IPHONE_NA); 
```

# asp.net - 在 64 位操作系统上以 32 位和 64 位运行 IIS 的优缺点是什么？

> ID：507820
> 
> 赞同：39
> 
> 时间：2009-02-03T16:24:25.663
> 
> 标签：asp.net, iis, 64-bit, 32bit-64bit, 32-bit

可能更适合“机架溢出”，但从开发人员的角度来看，在 64 位 Windows 主机上将 IIS（服务于传统的经典 ASP 和 .NET）作为 32 位进程而不是 64 位进程运行的优点和缺点是什么?

与 32/32 相比，32/64（iis/服务器）的主要优势似乎是每个 IIS 进程的内存容量高达 4gb。

我期望 32/64 优于 64/64 的优势似乎是更容易访问传统的 32 位进程内 DLL（我们仍然从合作伙伴供应商那里获得一个，我们无法立即放弃），也许给定更小的内存指针，相同代码的内存占用更小。

64/64 与 32/64 相比是否有任何性能优势或其他任何可以保证现在完全切换的东西？我在这里做了任何错误的假设吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2010-01-14T02:02:29.173

在 64 位和 32 位上运行 IIS 的唯一性能优势是允许访问更大的内存地址空间。

如果您正在执行正常的 ASPX 页面处理，那么您可能不需要从任何单个进程处理超过 4gb 的数据。假设您在 32 位模式下运行，在同一台机器上有多个工作进程的网络花园。在这种情况下，每个进程最多可以寻址 4GB。

当您执行缓存时，最大的优势就会出现。64 位进程可以维护一个巨大的内存缓存（假设您有 32GB 或更多的 RAM 来支持它），以允许您在 Web 服务器上缓存复杂的页面内容或数据。当数据的生成成本高于检索数据的成本时，这可以提高性能 - 例如，如果数据是详细的形式（假设是蒙特卡罗模拟的结果），或者数据驻留在机外并且网络IO 时间比缓存检索时间昂贵得多。

如果您不使用缓存，那么 64 位 IIS 将无法帮助您。每次查找都需要 64 位指针，这会使一切变慢。

64 位服务器在用于数据库（如 SQL Server）或其他数据管理服务器（例如，企业电子邮件服务器，如 Exchange）时，比用于处理服务器（如 IIS 或它管理的工作进程）更有效。使用 64 位地址空间，需要管理数据的服务器可以将更多数据以及索引和其他缓存保存在内存中。这可以节省磁盘 IO 时间和查询进入时的详细说明时间。大多数 Web 应用程序不需要从单个进程处理超过 4gb 的数据。

* * *

也许是一个有用的类比：在交通领域，大型 SUV 就像 64 位机器，而普通的紧凑型乘用车就像 32 位服务器。您可以在大型 SUV 中携带更多东西，它具有更大的牵引能力，可容纳 8 人，[GVWR 为 8600 磅](http://autos.msn.com/research/vip/spec_engines.aspx?year=2005&make=Ford&model=Excursion)。但有了这一切，你付出。卡车更重。它使用更多的燃料。如果您只运送大约 2 个人和一个行李袋，则不需要 SUV。使用较小的车辆会更好。它可以更快、更高效。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T17:13:54.453

我认为你没有做出任何错误的假设。但我会说，不，您概述的任何场景之间可能没有性能差异。Windows 上的 64 上的 32 不会受到惩罚。64 on 64 可能会带来一些轻微的性能提升，但这是值得怀疑的。使用 32 位进程可能会节省一些内存，但这很可能会被首先运行该进程所需的 thunking 所抵消。

唯一的好处是您提到的 DLL 问题。这也可能是升级的原因（如果您需要使用特定的 64 位）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-07-14T05:51:43.877

我有过从运行 IIS 6 和 ASP.NET 3.5 网站性能的 32 位 Windows 2003 Server 迁移到 64 位 Windows 2003 Server 的经验。

64 位服务器将始终比 32 位服务器慢 2 秒。

将 IIS 6 切换为作为 32 位工作进程运行后，性能再次相同且可比。

我还没有验证它，但我认为它可能只适用于 IIS6 win2k3，因为我使用 IIS7 x64 (Vista) 和 64 位 IIS 工作进程完成的测试似乎执行得很好。

切换到 32 位进程的过程非常简单。这是包含支持详细信息的知识库文章：http: [//support.microsoft.com/kb/894435/en-us](http://support.microsoft.com/kb/894435/en-us)

ASP.NET 2.0，32 位版本 要运行 32 位版本的 ASP.NET 2.0，请执行以下步骤：

1.  单击开始，单击运行，键入 cmd，然后单击确定。
2.  键入以下命令以启用 32 位模式： cscript %SYSTEMDRIVE%\inetpub\adminscripts\adsutil.vbs SET W3SVC/AppPools/Enable32bitAppOnWin64 1
3.  键入以下命令以安装 ASP.NET 2.0（32 位）版本并在 IIS 根目录下安装脚本映射：%SYSTEMROOT%\Microsoft.NET\Framework\v2.0.50727\aspnet_regiis.exe -i
4.  确保在 Internet 信息服务管理器的 Web 服务扩展列表中将 ASP.NET 版本 2.0.50727（32 位）的状态设置为允许。

有关设置回 64 位的信息，请参阅知识库文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-01-14T02:44:06.143

有关内存可用性，请参阅此[msdn 博客](http://blogs.msdn.com/tom/archive/2008/04/10/chat-question-memory-limits-for-32-bit-and-64-bit-processes.aspx)。

内存可用性。对于我的应用程序，我们得到了从 32 位操作系统上的 32 位进程切换到 64 位操作系统上的 32 位进程所需的功能，而无需更换第三方库。所以，我们停在那里。好处是：1）每个 IIS 工作进程可用的有效内存为 2-3 倍；2）在网站使用大量内存的 32 位操作系统中，其他系统进程和网站竞争有限的总内存。对于您的应用程序，请查看您的工作进程使用了​​多少内存。如果每个 WP 不使用大量内存（远超过 1GB），64 位工作进程将无济于事。

为了性能，我认为您必须在两种配置中测试自己的应用程序。[Dave 在](https://stackoverflow.com/questions/507820/what-are-the-pros-and-cons-of-running-iis-as-32bit-vs-64bit-on-a-64bit-os/1123653#1123653)上面的帖子表明您可能会在使用 64 位时出现性能下降。[正如 cheeso 所说](https://stackoverflow.com/questions/507820/what-are-the-pros-and-cons-of-running-iis-as-32bit-vs-64bit-on-a-64bit-os/2061731#2061731)，一些应用程序可能会从缓存中受益（不过 2GB 以上的缓存已经很多了）。除了有限和简单的应用程序之外，我认为我们无法对性能进行概括。我们也许能够指出性能更好或更差的特定技术。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-01-14T03:10:59.583

除了明显的内存差异外，64 位操作系统上的 32 位进程还必须在称为“Windows on Windows”或 WOW 模式下运行。它基本上是一个 thunking/emulation 层。如果你足够关注，就会有性能损失。

# javascript - 使用 IFrame 阻止 URL

> ID：507821
> 
> 赞同：0
> 
> 时间：2009-02-03T16:24:26.410
> 
> 标签：javascript, html, iframe

我正在将外部页面加载到 IFRAME 中，其中包含我不想加载的广告。

有没有办法可以为 IFRAME 中的任何内容设置 URL/域黑名单？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T16:36:11.037

我假设您正在服务器端开发某种 Web 应用程序。

在这种情况下，我会达到的目标是`Perl::HTTP::Proxy`.

与其将 IFRAME 直接指向外部站点，不如将其指向您自己站点上的`proxy`进程（页面、servlet、PHP 脚本，无关紧要）。此代码获取提供给它的 URL 的内容，并在提供修改后的响应之前过滤掉有问题的广告代码。

我无法评论这样做的合法性或道德性；视情况而定，有些人可能不高兴您提供他们的内容，但没有展示他们赚钱的广告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T16:28:54.827

不，如果您可以更改外部页面，那么它可能会导致 XSS 攻击。您将不得不依赖 AdBlock Plus 之类的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T16:44:53.937

不，但是有一种方法可以从外部干扰 iframe 的脚本：

```
<iframe security="restricted"> 
```

这是一个仅限 IE6+ 的扩展，请参阅[http://msdn.microsoft.com/en-us/library/ms534622(VS.85).aspx](http://msdn.microsoft.com/en-us/library/ms534622(VS.85).aspx)。

这种机制设计不佳，对于任何类型的实际安全几乎都是致命的损失，但如果子页面中的广告依赖 JavaScript 编写其 iframe（许多广告网络这样做），那么您可能能够破坏它像这样。当然，您也会破坏页面上的任何其他脚本，并且您很可能仍然会收到一堆非基于脚本的广告。

不是很满意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T16:47:35.100

Proxy the request internally and manipulate the raw HTML before returning it?

# ruby-on-rails - 格式化复数

> ID：507827
> 
> 赞同：8
> 
> 时间：2009-02-03T16:26:03.833
> 
> 标签：ruby-on-rails, pluralize

我有一个案例，我需要使用复数来正确拼写一些东西。但是，我需要像这样渲染 html：

```
<span>1</span> thing 
```

或者，

```
<span>3</span> things 
```

我可以编写一个辅助方法，但我只是确保盒子里没有东西可以做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-03T16:48:05.333

这使用 Rails 类[TextHelper](http://api.rubyonrails.com/classes/ActionView/Helpers/TextHelper.html#M001714) ，如果需要，它使用[Inflector进行复数。](http://rails.rubyonrails.org/classes/Inflector.html#M001627)

```
def pluralize_with_html(count, word)
  "<span>#{count}</span> #{TextHelper.pluralize(count, word)}"
end 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-03T16:52:10.707

在此期间，我创建了这个辅助方法，因为它看起来没有我要找的东西：

```
def pluralize_word(count, singular, plural = nil)
  ((count == 1 || count == '1') ? singular : (plural || singular.pluralize))
end 
```

它基本上与复数方法相同，只是它从前面删除了数字。这允许我这样做（haml）：

```
%span.label= things.size.to_s
%description= pluralize_word(things.size, 'thing') 
```

# wpf - 如何读取 WPF UserControl 中传递的参数？

> ID：507832
> 
> 赞同：8
> 
> 时间：2009-02-03T16:28:11.647
> 
> 标签：wpf, user-controls

我在 WPF 中创建了一个用户控件：

```
<UserControl x:Class="TestUserControl.Controls.GetLatest"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
        <TextBlock Name="theTextBlock"/>
</UserControl> 
```

后面的代码有一个名为“FirstMessage”的参数，它设置为我的用户控件 TextBlock 的文本：

```
public partial class GetLatest : UserControl
{
    public string FirstMessage { get; set; }

    public GetLatest()
    {
        InitializeComponent();
        theTextBlock.Text = this.FirstMessage;
    }
} 
```

在我的主代码中，我可以使用智能感知在我的用户控件中设置 FirstMessage 参数：

```
<Window x:Class="TestUserControl.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Window1" Height="300" Width="300"
    xmlns:controls="clr-namespace:TestUserControl.Controls"
    >
    <StackPanel>
        <controls:GetLatest FirstMessage="This is the title"/>
    </StackPanel>
</Window> 
```

但是，它仍然没有设置文本。我已经尝试过 Text="{Binding Path=FirstMessage}" 和我发现的其他语法，但没有任何效果。

如何访问用户控件中的 FirstMessage 值？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-03T20:15:11.827

您的绑定方法不起作用，因为您的属性 FirstMessage 在更新时没有通知。为此使用依赖属性。见下文：

```
public partial class GetLatest : UserControl
{
    public static readonly DependencyProperty FirstMessageProperty = DependencyProperty.Register("FirstMessage", typeof(string), typeof(GetLatest));

    public string FirstMessage
    {
        get { return (string)GetValue(FirstMessageProperty); }
        set { SetValue(FirstMessageProperty, value); }
    }

    public GetLatest()
    {
        InitializeComponent();
        this.DataContext = this;
    }

} 
```

XAML：

```
<UserControl x:Class="TestUserControl.Controls.GetLatest"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <TextBlock Text="{Binding FirstMessage}" />
</UserControl> 
```

每当 FirstMessage 属性更改时，您的文本块都会自行更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-03T16:34:56.703

FirstMessage 在构造函数被调用后设置。您应该从 FirstMessage 的设置器中更改您的文本。

从 XAML 初始化对象时，首先调用默认构造函数，然后在对象上设置属性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-03T16:44:58.693

这个快速示例不会使用任何绑定，因为在调用默认构造函数之后才设置值，但这里是显示文本的方法。

```
<UserControl x:Class="TestUserControl.Controls.GetLatest"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Loaded="GetLatest_Loaded">
        <TextBlock Name="theTextBlock"/>
</UserControl> 
```

然后，只需将您的 cs 文件修改为：

```
public partial class GetLatest : UserControl
{
    public string FirstMessage { get; set; }

    public GetLatest()
    {
        InitializeComponent();
        theTextBlock.Text = this.FirstMessage;
    }

    private void GetLatest_Loaded(object sender, RoutedEventArgs e)
    {
        theTextBlock.Text = this.FirstMessage;
    }
} 
```

我建议改为设置一个 Binding，因为这是相当像意大利面条的代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T09:21:14.020

您还可以使用：

```
public partial class GetLatest : UserControl
{
    private string _firstMessage;
    public string FirstMessage 
    {
        get { return _firstMessage; }
        set { _firstMessage = value; theTextBlock.Text = value; }
    }

    public GetLatest()
    {
        InitializeComponent();
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-03T16:36:43.233

对于您在上面发布的代码，这是一个时间问题；构造函数执行时，FirstMessage 属性尚未分配其值。您必须在稍后发生的事件（例如已加载）中执行该代码。

# excel - 使用 .Find 查看另一个工作表

> ID：507841
> 
> 赞同：-1
> 
> 时间：2009-02-03T16:30:11.330
> 
> 标签：excel, vba

我在一个工作簿（活动的）中有一组帐户名称，我需要使用 .Find 函数在另一个工作簿/工作表中查找它们的出现。我认为我没有为其他工作簿/工作表获得正确的对象句柄，但我尝试的任何方法都不起作用。

```
For Count = 1 to 10

accName = Cells(Count, 1).Value

AccRow(Count) = OBJECTHANDLE.Find(accName).Row

Next Count 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T16:55:38.440

没关系，我找到了坚持不懈的答案（这在一天结束时是如此罕见）。需要将对象定义为.Range，因此：

`Workbooks("WORKBOOK").Sheets("SHEET").Range("RANGE")`

我讨厌VBA。

# xml - 将 xslt 修改为与命名空间无关

> ID：507847
> 
> 赞同：7
> 
> 时间：2009-02-03T16:30:38.350
> 
> 标签：xml, xslt, xpath, xml-namespaces

我创建了一个 XSLT 来处理特定的 xml 文档。但是，现在在我们的一些（但不是全部）文档中引入了命名空间。我想对这些文档使用相同的 XSLT，但是我无法将我的样式表修改为与名称空间无关。

之前有人建议将我的 xpaths 修改为`*[local-name()="ElementName"]`，但是考虑到我们已经制作了样式表，这是非常耗费人力的。

此外，我知道我可以将 设置`xpath-default-namespace`为特定的命名空间，但如前所述，我不能简单地将其设置为 #all 或可能的命名空间列表。我正在寻找一个更有效的解决方案，并为我提供 Saxon 处理器的扩展功能。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T18:22:26.017

您是否考虑过预处理您的 XML 文档？

您可以删除所有名称空间（注意可能的冲突），然后使用现有的 XSL 转换对其进行处理。

这种方法的优点是您根本不必修改 XSLT。它保持可读性（*[local-name()='frob'] 看起来很糟糕）并且可维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T19:17:05.110

经过进一步咨询，似乎没有简单的方法可以解决这个问题。XSLT 必须重新设计为与名称空间无关，或者使用元素`xpath-default-namespace`上的属性。`<xsl:stylesheet>`如果我们希望保留传入文档的名称空间，但仍然有一个样式表与多个名称空间一起使用，那么我们的模板需要类似于以下形式：

```
<xsl:template match="*[local-name(.)='ElementName']">
   <xsl:element name="{local-name(.)}" xmlns="http://yourURIhere">
      <xsl:value-of select="."/>
   </xsl:element>
</xsl:template/> 
```

等等

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-07T00:28:50.627

也许我不明白你的问题，但你不能让你的模板同时匹配空命名空间版本**和**元素的命名空间版本吗？- 像这样：

```
<xsl:template match="ElementName | NS:ElementName" xmlns:NS="your-namespace">
   ... output ...
</xsl:template> 
```

（通常，NS 前缀的声明将放在样式表元素上）

这是迄今为止对我来说最“干净”的版本——我已经使用它来让一个 XSLT 样式表处理所有三种 RSS 格式（0.91、1.0 和 2.0）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-12-17T15:15:40.630

我发现以下页面很好地呈现了问题，但没有给出解决方案：

[http://www.edankert.com/defaultnamespaces.html](http://www.edankert.com/defaultnamespaces.html)

我在 O'Reilly "XML in a Nutshell" 中找到了该问题的解决方案：

[http://docstore.mik.ua/orelly/xml/xmlnut/ch08_10.htm](http://docstore.mik.ua/orelly/xml/xmlnut/ch08_10.htm)

# winapi - Win32窗口所有者与窗口父？

> ID：507848
> 
> 赞同：55
> 
> 时间：2009-02-03T16:30:56.367
> 
> 标签：winapi, window, parent, owner

在 Win32 编程中，窗口的父级和窗口的所有者有什么区别？我以为我已经弄清楚了，然后我遇到了这段代码：

```
SetWindowLong(handle, GWL_HWNDPARENT, foo); 
```

这实际上设置了窗口的所有者，而不是父级 - 尽管使用了 GWL_HWNDPARENT。父母/所有者这两个术语是否可以互换，或者实际上有区别？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-03-05T17:23:24.107

所有权是两个顶级窗口之间的关系，而父级是顶级和 WS_CHILD 或 WS_CHILD 和另一个 WS_CHILD 之间的关系。

按钮的父级是它所在的窗体，而消息框由显示它的窗体拥有。

阅读 Microsoft [Win32 Window Hierarchy and Styles](https://www.cnblogs.com/fwycmengsoft/p/10201734.html)中的这篇文章，以更清楚地了解 Ownership、Parenting、ZOrder、SetWindowLong、GetWindow 以及用于创建窗口关系的 Win32 api 的所有其他讨厌的部分。

编辑：看起来 Microsoft 删除了该内容，这是[Ownership / Parenting 的另一个合理总结](http://msdn.microsoft.com/en-us/library/ms632599%28v=VS.85%29.aspx#owned_windows)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-02-03T16:47:06.147

Owner 是负责控件或对话框的 Window*（例如，负责创建/销毁窗口）。

Parent 是窗口链中控件或对话框的下一个高级窗口*，但实际上并不对其负责（不一定关心它的生命周期等）。窗口的父级也可以是它的所有者。

*Window vs window：Window是屏幕上实际显示的窗口；window 是具有 HWND 的任何对象（包括按钮、面板等）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-18T17:12:31.643

陈的博客文章是值得阅读的。对我来说关键点是必须在子窗口上使用 WS_CHILD 样式。您可以尝试创建一个子窗口并将父句柄传递给 CreateWindow()，但如果您没有设置 WS_CHILD 样式，则两个窗口将具有所有者关系，而不是父/子关系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-30T02:28:06.483

这非常简单：代码错误。故事到此结束。

是的，有些窗口可能碰巧对这样的调用做出了积极的反应——不知道更好的人可能已经实现了对它的支持。Quoth 文档（它是**旧**文档） -*您不能`SetWindowLong`使用`GWL_HWNDPARENT`索引调用来更改子窗口的父级。相反，请使用该`SetParent`功能。*

所以，它的全部内容：你遇到了错误的代码，将其更改`SetParent`或重构以做其他事情，然后继续？

# delphi - 系统错误。代码：8\. 没有足够的存储空间来处理这个命令

> ID：507853
> 
> 赞同：38
> 
> 时间：2009-02-03T16:32:43.320
> 
> 标签：delphi, winapi

我们有一些 Win32 应用程序（在 Delphi 2006 中编码），有时用户会收到一条错误消息，说**“系统错误。代码：8。没有足够的存储空间来处理这个命令。”** .

从堆栈跟踪看起来它总是在 CreateWnd 调用期间

```
Main ($1edc):
004146cc +070 app.exe SysUtils               RaiseLastOSError
00414655 +005 app.exe SysUtils               RaiseLastOSError
004ce44c +130 app.exe Controls               TWinControl.CreateWnd
00535a72 +022 app.exe cxControls             TcxControl.CreateWnd
004ce82a +016 app.exe Controls               TWinControl.CreateHandle
00553d21 +005 app.exe cxContainer            TcxContainer.CreateHandle
00586ef1 +005 app.exe cxEdit                 TcxCustomEdit.CreateHandle
005c331d +005 app.exe cxDropDownEdit         TcxCustomDropDownEdit.CreateHandle
004ceaf0 +074 app.exe Controls               TWinControl.UpdateShowing
004ceb1e +0a2 app.exe Controls               TWinControl.UpdateShowing
004cebdc +03c app.exe Controls               TWinControl.UpdateControlState
004d118a +026 app.exe Controls               TWinControl.CMVisibleChanged
004cb713 +2bb app.exe Controls               TControl.WndProc
004cf569 +499 app.exe Controls               TWinControl.WndProc
004b727d +4c1 app.exe Forms                  TCustomForm.WndProc
004cb3a0 +024 app.exe Controls               TControl.Perform
004c9f6a +026 app.exe Controls               TControl.SetVisible
004b6c46 +03a app.exe Forms                  TCustomForm.SetVisible
004baf1b +007 app.exe Forms                  TCustomForm.Show
004bb151 +14d app.exe Forms                  TCustomForm.ShowModal
007869c7 +0d3 app.exe UfrmPrice      770 +19 TfrmPrice.EditPrice
0078655d +009 app.exe UfrmPrice      628  +0 TfrmPrice.actNewBidExecute
00431ce7 +00f app.exe Classes                TBasicAction.Execute
004c2cb5 +031 app.exe ActnList               TContainedAction.Execute
004c397c +050 app.exe ActnList               TCustomAction.Execute
00431bb3 +013 app.exe Classes                TBasicActionLink.Execute
004af384 +090 app.exe Menus                  TMenuItem.Click
004b059f +013 app.exe Menus                  TMenu.DispatchCommand
004b16fe +082 app.exe Menus                  TPopupList.WndProc
004b164d +01d app.exe Menus                  TPopupList.MainWndProc
004329a8 +014 app.exe Classes                StdWndProc
7e4196b2 +00a USER32.dll                     DispatchMessageA
004bea60 +0fc app.exe Forms                  TApplication.ProcessMessage
004bea9a +00a app.exe Forms                  TApplication.HandleMessage
004becba +096 app.exe Forms                  TApplication.Run
008482c5 +215 app.exe AppName        129 +42 initialization 
```

我从来没有能够深入了解导致这种情况的原因，因为它很少发生，我没有关注过，但我想找出导致它的原因并希望能纠正它......

**编辑：**完整的堆栈跟踪

**编辑 2：**更多信息... 今天遇到此问题的客户已经安装了我的应用程序大约 4 个月，并且它每天 8 小时在他的 PC 上运行。即使他杀死了我的应用程序并重新启动它，问题也仅在今天出现并不断再次出现。他系统上的其他应用程序都没有异常行为。重新启动后，问题完全消失。这是否指向史蒂夫提到的堆短缺？

**编辑 3：**关于桌面堆主题的有趣的 msdn 博客文章[在这里](http://blogs.msdn.com/ntdebugging/archive/2007/01/04/desktop-heap-overview.aspx)和[这里](http://blogs.msdn.com/ntdebugging/archive/2007/07/05/desktop-heap-part-2.aspx)。虽然我不确定这是否是问题的原因，但它看起来很可能。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-01-30T15:43:39.793

实际上这是 ATOM 表的问题。[我向 Embarcadero 报告了这个问题](http://qc.embarcadero.com/wc/qcmain.aspx?d=100600)（[保存在 Wayback Machine 中](https://web.archive.org/web/20171220121720/http://qc.embarcadero.com/wc/qcmain.aspx?d=100600)），因为它让我很伤心。

如果您监视全局原子表，您将看到 Delphi 应用程序正在泄漏原子，留下您的应用程序的 id 而不将其从内存中删除：

您将看到大量以下项目：

```
**Delphi000003B4*

*Controlofs0040000000009C0** 
```

基本上，由于您不能注册超过 0xFFFF 的不同 Windows 消息 ID，因此系统将返回“**系统错误。代码：8。没有足够的存储空间来处理此命令**”。然后您将无法启动任何创建窗口的应用程序。

Embarcadero QC Central 报告了[另一个问题](http://qc.embarcadero.com/wc/qcmain.aspx?d=90511)（[保存在 Wayback Machine中）。](https://web.archive.org/web/20171220113936/http://qc.embarcadero.com/wc/qcmain.aspx?d=90511)

此问题在 Windows 7 / Windows Server 2008 下出现。在 Windows Server 2003 和之前运行它之前的事实是由于错误的实现，一旦它们的索引围绕最大 16384 单位，它会回收 ATOM。

随意使用我的[**Global Atom Monitor**](https://github.com/JordiCorbilla/atom-table-monitor)来检查您的 Delphi 应用程序是否正在泄漏原子。

要解决此问题，您需要来自 Embarcadero 的补丁，或从[www.idefixpack.de/blog/downloads下载](https://www.idefixpack.de/blog/downloads/)[ControlsAtomFix1.7z](https://web.archive.org/web/20211026143957if_/https://www.idefixpack.de/blog/wp-content/uploads/2014/04/ControlsAtomFix1.7z)。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-02-03T20:48:32.103

如果您的程序使用大量 Windows 资源，则可能是资源堆短缺。

有一个注册表项可以增加以增加 XP 的堆大小。对于 Vista，Microsoft 已经将默认值设置得更高。我建议将默认的 3072 更改为至少 8192。

此信息记录在[MS 知识库](http://support.microsoft.com/kb/126962)中 （或搜索“内存不足”）。有关参数值的其他详细信息，请参阅文章[KB184802](http://support.microsoft.com/kb/184802)。

我建议您阅读知识库文章，但有关更改的基本信息是：

1.  运行注册表编辑器 (REGEDT32.EXE)。

2.  从 HKEY_LOCAL_MACHINE 子树中，转到以下键：

    ```
    \System\CurrentControlSet\Control\Session Manager\SubSystem 
    ```

3.  在屏幕右侧双击键：

    ```
    windows 
    ```

4.  在弹出窗口中，您将看到一个很长的字段被选中。将光标移动到字符串开头附近以查找此内容（值可能会有所不同）：

    ```
    SharedSection=1024,3072,512 
    ```

5.  SharedSection 使用以下格式指定系统堆和桌面堆：`SharedSection=xxxx,yyyy,zzz`where`xxxx`定义系统范围堆的最大大小（以千字节为单位），`yyyy`定义每个桌面堆`zzz`的大小，并为“非互动”窗口站。

6.  仅将`yyyy`值更改为 8192（或更大），然后按 OK。

7.  退出注册表编辑器并重新启动 PC 以使更改生效。

祝你好运。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-05-12T02:48:55.137

我一直在寻找 2 年，感谢[Jordi Corbilla 的回答](https://stackoverflow.com/a/9066509/112670)，我终于明白了！

简而言之：**Delphi 源代码存在导致您出现此问题的错误！**

让我们了解发生了什么：

Windows 有一个称为“Atom 表”的内存区域，用于应用程序相互通信（[查看更多](http://msdn.microsoft.com/en-us/library/windows/desktop/ms649053%28v=vs.85%29.aspx)）。

此外，Windows 有另一个“内存区域”，称为“窗口消息系统”，用于相同目的（[查看更多](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644947%28v=vs.85%29.aspx)）。

这两个内存区域各有“16k 个插槽”。在第一个中，可以使用以下 Windows API**删除原子：**

```
GlobalDeleteAtom // for removing an atom added by "GlobalAddAtom" 
```

在第二个“区域”中，我们**无法移除**任何东西！

> RegisterWindowMessage 函数通常用于注册消息，以便在两个协作应用程序之间进行通信。如果两个不同的应用程序注册相同的消息字符串，则应用程序返回相同的消息值。**该消息保持注册状态，直到会话结束**。

Delphi 编译的应用程序（至少由 D7 编译）将在“Messaging Area”中放置一条记录，而其他一些记录则在“Atom Table”中每次它们**开始时**。该应用程序会在应用程序关闭时尝试删除它们，但我发现许多（和许多）“原子泄漏”，即使在应用程序关闭后也是如此。

此时你可以看到，如果你的服务器每天启动数千个应用程序，你可能应该很快达到 16k 的限制，问题就开始了！此时的解决方案？只有一次重启。

所以，我们能做些什么？好吧，我的朋友，很抱歉告诉你，但我们需要修复 Delphi 源代码并重新编译所有应用程序。

首先，打开单元 Controls.pas 并替换以下行：

```
RM_GetObjectInstance := RegisterWindowMessage(PChar(ControlAtomString)); 
```

为了：

```
RM_GetObjectInstance := RegisterWindowMessage('RM_GetObjectInstance'); 
```

然后重新编译 Delphi 包和你的应用程序。

因为即使在应用程序关闭后我也发现原子泄漏，我创建了一个垃圾收集任何留下的原子的应用程序。它只是每小时运行以下代码：

```
procedure GarbageCollectAtoms;
var i, len : integer;
    cstrAtomName: array [0 .. 1024] of char;
    AtomName, Value, procName: string;
    ProcID,lastError : cardinal;
    countDelphiProcs, countActiveProcs, countRemovedProcs, countCantRemoveProcs, countUnknownProcs : integer;

    // gets program's name from process' handle
    function getProcessFileName(Handle: THandle): string;
    begin
      Result := '';
      { not used anymore
      try
        SetLength(Result, MAX_PATH);
        if GetModuleFileNameEx(Handle, 0, PChar(Result), MAX_PATH) > 0 then
          SetLength(Result, StrLen(PChar(Result)))
        else
          Result := '';
        except
      end;
      }
    end;

    // gets the last 8 digits from the given atomname and try to convert them to and integer
    function getProcessIdFromAtomName(name:string):cardinal;
    var l : integer;
    begin
      result := 0;
      l := Length(name);
      if (l > 8) then
      begin
        try
          result := StrToInt64('$' + copy(name,l-7,8));
          except
            // Ops! That should be an integer, but it's not!
            // So this was no created by a 'delphi' application and we must return 0, indicating that we could not obtain the process id from atom name.
            result := 0;
        end;
      end;
    end;

    // checks if the given procID is running
    // results: -1: we could not get information about the process, so we can't determine if is active or not
    //           0: the process is not active
    //           1: the process is active
    function isProcessIdActive(id: cardinal; var processName: string):integer;
    var Handle_ID: THandle;
    begin
      result := -1;
      try
        Handle_ID := OpenProcess(PROCESS_QUERY_INFORMATION or PROCESS_VM_READ, false, id);
        if (Handle_ID = 0) then
        begin
          result := 0;
        end
        else
        begin
          result := 1;
          // get program's name
          processName := getProcessFileName(Handle_ID);
          CloseHandle(Handle_ID);
        end;
        except
          result := -1;
      end;
    end;

    procedure Log(msg:string);
    begin
      // Memo1.Lines.Add(msg);
    end;

begin

  // initialize the counters
  countDelphiProcs := 0;
  countActiveProcs := 0;
  countRemovedProcs := 0;
  countUnknownProcs := 0;

  // register some log
  Log('');
  Log('');
  Log('Searching Global Atom Table...');

  for i := $C000 to $FFFF do
  begin
    len := GlobalGetAtomName(i, cstrAtomName, 1024);
    if len > 0 then
    begin
      AtomName := StrPas(cstrAtomName);
      SetLength(AtomName, len);
      Value := AtomName;
      // if the atom was created by a 'delphi application', it should start with some of strings below
      if (pos('Delphi',Value) = 1) or
         (pos('ControlOfs',Value) = 1) or
         (pos('WndProcPtr',Value) = 1) or
         (pos('DlgInstancePtr',Value) = 1) then 
      begin
        // extract the process id that created the atom (the ProcID are the last 8 digits from atomname)
        ProcID := getProcessIdFromAtomName(value);
        if (ProcId > 0) then
        begin
          // that's a delphi process
          inc(countDelphiProcs);
          // register some log
          Log('');
          Log('AtomName: ' + value + ' - ProcID: ' + inttostr(ProcId) + ' - Atom Nº: ' + inttostr(i));
          case (isProcessIdActive(ProcID, procName)) of
            0: // process is not active
            begin
              // remove atom from atom table
              SetLastError(ERROR_SUCCESS);
              GlobalDeleteAtom(i);
              lastError := GetLastError();
              if lastError = ERROR_SUCCESS then
              begin
                // ok, the atom was removed with sucess
                inc(countRemovedProcs);
                // register some log
                Log('- LEAK! Atom was removed from Global Atom Table because ProcID is not active anymore!');
              end
              else
              begin
                // ops, the atom could not be removed
                inc(countCantRemoveProcs);
                // register some log
                Log('- Atom was not removed from Global Atom Table because function "GlobalDeleteAtom" has failed! Reason: ' + SysErrorMessage(lastError));
              end;
            end;
            1: // process is active
            begin
              inc(countActiveProcs);
              // register some log
              Log('- Process is active! Program: ' + procName);
            end;
            -1: // could not get information about process
            begin
              inc(countUnknownProcs);
              // register some log
              Log('- Could not get information about the process and the Atom will not be removed!');
            end;
          end;
        end;
      end;
    end;
  end;
  Log('');
  Log('Scan complete:');
  Log('- Delphi Processes: ' + IntTostr(countDelphiProcs) );
  Log('  - Active: ' + IntTostr(countActiveProcs) );
  Log('  - Removed: ' + IntTostr(countRemovedProcs) );
  Log('  - Not Removed: ' + IntTostr(countCantRemoveProcs) );
  Log('  - Unknown: ' + IntTostr(countUnknownProcs) );

  TotalAtomsRemovidos := TotalAtomsRemovidos + countRemovedProcs;

end; 
```

（上面的代码是基于[这个代码](http://code.google.com/p/atom-table-monitor/)）

在那之后，我再也没有遇到过这个 f** 错误！

**延迟更新：**

此外，这也是此错误的来源：[应用程序错误：故障地址 0x00012afb](https://stackoverflow.com/questions/3040357/application-error-fault-address-0x00012afb-expert)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-11-13T17:43:20.123

您可以使用 Microsoft 的 Desktop Heap Monitor 查看堆统计信息（使用 % 等），可在以下位置获得：

[http://www.microsoft.com/downloads/details.aspx?familyid=5cfc9b74-97aa-4510-b4b9-b2dc98c8ed8b&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=5cfc9b74-97aa-4510-b4b9-b2dc98c8ed8b&displaylang=en)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-11-13T21:35:27.523

我最近在使用一些 Twain 代码时注意到了这个错误（系统错误。代码：8。没有足够的存储空间......），它发生在我的计算机上而不是我同事的计算机上，我们机器之间唯一真正的区别是我使用笔记本电脑屏幕作为第二个显示器，所以我的桌面总尺寸更大。

我找到了史蒂夫·布莱克（Steve Black）指出的上述问题的文档，但我找到了一种不需要编辑注册表的方法（至少修复了我机器上的错误）：

旧代码正在使用

```
 DC := GetDC(Owner.VirtualWindow);
  // ...
  ReleaseDC(Owner.VirtualWindow, DC);
```

我发现用它替换它摆脱了我的错误

```
 DC := CreateCompatibleDC(Owner.VirtualWindow);
  // ...
  DeleteDC(DC);
```

我不知道这是否与您的问题有关，但将来可能对其他人有所帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-03T18:01:02.317

编译器中可能存在错误，可以肯定的是，这是您的应用程序中的某些东西导致了问题。可能是您的应用程序正在泄漏窗口句柄或其他一些 GUI 对象，如钢笔/画笔？这可能是一个原因。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-01-25T11:50:04.823

对我来说，这只是一堆以幻灯片方式解压缩的 TJPEGImage，最终内存不足。

# c# - 验证是否存在可用网络连接的最简单方法是什么？

> ID：507855
> 
> 赞同：9
> 
> 时间：2009-02-03T16:33:42.773
> 
> 标签：c#, .net, .net-2.0, networking

我是 c#/.net 开发的新手，但我已经为我公司的一小部分资产组合了一个股票跟踪应用程序。我还在 SQL 2000 中设置了它连接的数据库。

当网络连接可用时，它目前工作得很好，但我想扩展它以在我离开连接时使用。

首先，我需要知道是否有可用的连接。所以我把它放在一起：

```
 private int availableNetAdapters()
    {
        int nicCount = 0;
        foreach (NetworkInterface nic in NetworkInterface.GetAllNetworkInterfaces())
        {
            if (nic.OperationalStatus == OperationalStatus.Up)
            {
                nicCount++;
            }
        }

        return nicCount;
    } 
```

似乎工作，但我必须测试“> 1”，因为无论其他适配器状态如何，总是检测到“MS TCP Loopback interface”。

是否有更好/更简单的方法来检查连接？

G

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-03T16:40:24.210

`System.Net.NetworkInformation.NetworkInterface.GetIsNetworkAvailable()`

您还可以使用该类中的事件`NetworkAvailabilityChanged`和事件来监控 IP 地址和网络可用性的变化。`NetworkAddressChanged`

编辑：请注意，此方法检查计算机上可能存在的所有可用网络接口（无线、局域网等）。如果其中任何一个连接，它将返回 true。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-03T16:51:55.217

还有一些要记住的事情：

*   可用的网络连接！= 可用的互联网连接。
*   互联网访问！= 访问特定网站（想想代理过滤器，或者该网站可能只是关闭）

因此，通常最好直接测试对您需要的特定资源的访问。

这些资源是不稳定的；无论如何，当它们出现故障时，您必须处理异常。所以通常最好只是去获取一个资源，就好像你确定它存在一样，并投入你的开发时间来确保你的异常处理程序能很好地处理失败。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T20:33:11.167

这是课程

```
using System;
using System.Net;
using System.Net.Sockets;
using System.Threading;
using System.Diagnostics;

namespace Ping
{    
    public readonly int iSent = 0;
    public readonly int iReceived = 0;
    public readonly int iLost = 0; 

    public PingReceivedArgs (int iSent, int iReceived, int iLost)
    {
        this.iSent = iSent;
        this.iReceived = iReceived;
        this.iLost = iLost;
    }

    public class PingFailedArgs : EventArgs
    {
        public readonly int iSent = 0;
        public readonly int iReceived = 0;
        public readonly int iLost = 0;

        public PingFailedArgs (int iSent, int iReceived, int iLost)
        {
            this.iSent = iSent;
            this.iReceived = iReceived;
            this.iLost = iLost;
        }
    }

/// <summary>
/// The Main Ping Class
/// </summary>
public class Ping
{
        //Create delegate for events
            public delegate void PingReceivedHandler(object DataObj, PingReceivedArgs PingReceived);
        public delegate void PingFailedHandler(object DataObj, PingFailedArgs PingFailed);

    //The events we publish
    public event PingReceivedHandler OnPingReceived;
    public event PingFailedHandler OnPingFailed;

    private void FirePingReceivedEvent( int iSent, int iReceived, int iLost)
    {
        PingReceivedArgs NewStatus = new PingReceivedArgs(iSent, iReceived, iLost);
        if (OnPingReceived != null)
        {
            OnPingReceived(this,NewStatus);
        }
    }

    private void FirePingFailedEvent(int iSent, int iReceived, int iLost)
    {
        PingFailedArgs NewStatus = new PingFailedArgs(iSent, iReceived, iLost);
        if (OnPingFailed != null)
        {
            OnPingFailed(this,NewStatus);
        }
    }

    private string _Host = "";
    private bool _HostFound = false;
    private int _PingSent = 0;
    private int _PingReceived = 0;
    private int _PingLost = 0;
    private int _PauseBetweenPings = 2000;
    private Thread _PingThread;

    public string  Host
    {
        get { return _Host; }
        set { _Host = value; }
    }
    public bool  HostFound
    {
        get { return _HostFound; }
    }
    public int PingSent
    {
        get { return _PingSent; }
    }
    public int PingReceived
    {
        get { return _PingReceived; }
    }
    public int PingLost
    {
        get { return _PingLost; }
    }

    public int  PauseBetweenPings
    {
        get { return _PauseBetweenPings; }
        set { _PauseBetweenPings = value; }
    }

    public Ping()
    {
        //
        // TODO: Add constructor logic here
        //
    }

    public void StartPinging()
    {
        try
        {
            if (_Host.Length == 0)
            {
                //LogStatus.WriteLog("Host name is blank,    stopping.","Error","StartPinging");
                return;
            }

               if (_PingThread == null || (_PingThread.ThreadState &    (System.Threading.ThreadState.Unstarted | System.Threading.ThreadState.Background)) == 0)
            {

                _PingThread = new Thread(new ThreadStart(LoopAndPing));
                _PingThread.IsBackground = true;
                _PingThread.Start();
            }
        }
        catch( Exception ex)    
        {
            //LogStatus.WriteErrorLog(ex,"Error","StartPinging");
        }
    }

    public void StopPinging()
    {
        try
        {
               if (_PingThread != null && (_PingThread.ThreadState &    (System.Threading.ThreadState.Stopped | System.Threading.ThreadState.Aborted |    System.Threading.ThreadState.Unstarted | System.Threading.ThreadState.AbortRequested)) ==    0)
            {
                _PingThread.Abort();
                _PingThread.Join();
            }
        }
        catch (Exception ex)
        {
            //LogStatus.WriteErrorLog(ex, "Error", "StopPinging");
        }
    }

    /// <summary>
    /// LoopAndPing: Runs from a thread.  Basically loops and gathers stats.
    /// </summary>
    private void LoopAndPing()
    {
        bool bHostFound = false;

        try
        {
            while(true)
            {
                _PingSent++;
                bHostFound = PingHost(_Host);
                if (bHostFound) 
                { 
                    _PingReceived++; 
                    _HostFound = true;
                       FirePingReceivedEvent(_PingSent,_PingReceived,_PingLost);
                }
                else  
                { 
                    _PingLost++; 
                    _HostFound = false;
                       FirePingFailedEvent(_PingSent,_PingReceived,_PingLost);
                }
                Thread.Sleep(_PauseBetweenPings);
            }
        }
        catch(ThreadAbortException)
        {
            //No need to do anything!
        }
        catch(Exception e)  
        {
            //LogStatus.WriteErrorLog(e,"Error","LoopAndPing");
        }
    }

    /// <summary>
    /// PingHost - Send one ping to the host
    /// </summary>
    /// <param name="host">Can be an IP or Host name.</param>
    /// <returns></returns>
    public bool PingHost(string szHost)
    {
        bool bPingWorked = false;

        try
        {
            string szCommand = "ping " + szHost + " -n 1";
            Process p = new Process();
            p.StartInfo.FileName = "cmd.exe";
            p.StartInfo.Arguments = "/Q /A /C" + szCommand;
            p.StartInfo.UseShellExecute = false;
            p.StartInfo.RedirectStandardOutput = true;
            p.StartInfo.RedirectStandardError = true;
            p.StartInfo.CreateNoWindow = true;
            p.Start();
            string szCommandOutput = p.StandardOutput.ReadToEnd();
            p.WaitForExit();

            if (szCommandOutput.ToUpper().IndexOf("REPLY FROM") > -1)
            {
                bPingWorked = true;
            }
        }
        catch(ThreadAbortException)
        {
            //No need to do anything!
        }
        catch(Exception e)  
        {
            //LogStatus.WriteErrorLog(e,"Error","PingHost");
        }
        return bPingWorked;
    }
}
} 
```

从客户那里你会打电话

```
PingHost = new Ping();
PingHost.OnPingFailed += new Ping.PingFailedHandler(PingHost_OnPingFailed);
PingHost.OnPingReceived +=new Ping.PingReceivedHandler(PingHost_OnPingReceived);
PingHost.Host = *IP you wish to ping*;
PingHost.StartPinging(); 
```

然后您将编写方法来捕获上面定义的 PingHost 事件

```
private void PingHost_OnPingReceived(object DataObj, PingReceivedArgs PingReceived)
{
    try
    {
        // code to do something when a successful ping occurrs
    }
    catch (Exception ex) 
    {
       // code to do something when an exception occurrs
    }
 }

private void PingHost_OnPingFailed(object DataObj, PingFailedArgs PingFailed)
{
    try
    {
            // code to do something when a ping failure occurrs
    }
    catch (Exception ex) 
    {
            // code to do something when an exception occurrs
    }
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T17:11:39.793

我们有一个应用程序，主要在通过无线空中卡连接的警车中运行。我们需要一种方法来确定它们是否连接。我们编写了一个非常小的 Ping.cs 类，它定期 ping 预定的 IP 或计算机名称。我们解释结果消息并更改系统托盘连接图标的显示。如果你愿意，我可以给你发 C# 代码。

# asp.net - .NET Remoting vs. Web Services vs. Windows Communication Foundation (WCF)

> ID：507862
> 
> 赞同：12
> 
> 时间：2009-02-03T16:34:39.870
> 
> 标签：asp.net, wcf, web-services, remoting

有人愿意帮助我了解 .NET Remoting、Web 服务和 WCF 的优缺点吗？我在 .NET Remoting 和 Web 服务方面做了一些工作，我正在构建一个新的 ASP.NET 3.5 Web 应用程序，我将在其中使用 SQL 2008 DB。首先，我想知道是否值得为这个应用程序真正研究 WCF。

在这种特殊情况下，以下是一些相关点：

*   大多数持久性数据将是错误和使用跟踪。
*   即使我使用 .NET Remoting，流量也不会保证物理远程处理服务器，但我希望有一天它会！
*   目前，我预计不需要从其他 Web 应用程序中获取这些数据。

但是，我仍然想知道：

*   何时/为什么要在 Web 应用程序中使用 .NET Remoting？
*   您何时/为什么要在 Web 应用程序中使用 Web 服务？
*   何时/为什么要在 Web 应用程序中使用 WCF？
*   我应该考虑使用 LINQ to SQL 之类的技术吗？
*   还有其他更好的选择吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-03T16:56:59.077

实际上，我将我们的软件从传统的 .NET Remoting 切换到了 WCF。Remoting 导致的通信膨胀是惊人的（只需查看 Wireshark 跟踪）。在迁移到 WCF 之前，我考虑过只使用传统的 .NET Web 服务，但我们为远程调用实现的接口需要进行大量修改（我们使用了一些 out 和 ref 参数，如果我不是，Asp.Net Web 服务无法做到这些）错误）。

真的，我想不出使用 Asp.Net 网络服务的理由，但我不是 Asp.Net 人。对我来说，它比 WCF 没有任何优势。使用 Web 服务可能更容易，但 WCF 提供的灵活性正是我所需要的。特别是在消息格式方面。

我喜欢我的 WCF 服务，因为通过一项服务，我可以提供 JSON 或 SOAP/XML，并且支持所有协议（ipc、tcp 和 http）。

WCF 的糟糕之处在于，如果您希望在基于 Web 的场景中使用它，它的严格绑定要求您为 HTTP 和 HTTPS 定义一个端点。与传统的 Web 服务不同，无论它是否安全，它都“正常工作”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T20:29:53.983

好问题！像你自己一样，我以前没有看过 WCF，想知道它是否会使 Web 服务或多或少过时？

关于你关于 Linq2SQL 的观点 - 鉴于这是一个非常棒的新应用程序，你可能会在几年内维护代码库 - 就个人而言（并且有被否决的风险 - 但请记住这是一个有效的观点查看！）我倾向于查看实体框架。

我知道它的缺点，对我来说最大的缺点是它与 DAL 耦合太紧密 - 因此它不能轻易地进行单元测试（相信我，这对我来说是一个大问题，尽管我确实有一种直觉一种解决方法来实现这一点）。

但是，我个人的看法是，MS 不会让这项技术被淘汰，而且我必须考虑到它将取代 L2S 的传言。另一方面，L2S 是一种更成熟的技术，也是一种更安全的选择。

也许我太天真了，但是当 Dan Simmons 说他们正在努力将 EF（最终）作为一个完全持久的无知架构交付时，我相信他 - [http://blogs.msdn.com/dsimmons/pages/ef-faq -entity-classes.aspx#_Does_Entity_Framework](http://blogs.msdn.com/dsimmons/pages/ef-faq-entity-classes.aspx#_Does_Entity_Framework)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-18T12:48:25.560

我宁愿先研究 EF，然后再研究 L2SQL。

只能连接到 MSSQL 的想法是我从未采用 L2SQL 的原因，从那时起很明显，MS 总有一天会放弃它。

# .net - .NET 中的全局变量（或替代）最佳实践

> ID：507864
> 
> 赞同：12
> 
> 时间：2009-02-03T16:34:49.120
> 
> 标签：.net, vb.net, global-variables

在 VB.NET WinForms 应用程序中存储全局变量的最佳实践是什么。例如，当用户登录到应用程序时，您可能希望存储可以在整个应用程序中访问的 CurrentUser 对象。您可以将它作为一个对象存储在模块中，或者创建一个包含所有必需全局变量的成员的类，但您仍然需要将它的实例存储在某个地方。

该框架是否提供了一个简单的解决方案？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-03T16:54:02.327

我认为“不要”有点苛刻，这是史蒂夫·麦康奈尔（Steve McConnell）的一句话：

> 与纪律一起使用，全局变量在多种情况下很有用

我认为就像一个好的木匠有合适的工具来完成这项工作，并且在需要时会使用合适的工具一样，程序员也应该使用他们可以使用的所有工具。

直接来自“Tour de Force”代码完成是使用全球数据的几个原因：

*   维护全球价值
*   简化极其常见数据的使用
*   消除流浪汉数据

麦康奈尔还说：

> 仅将全球数据用作最后手段。在您诉诸使用全局数据之前，请考虑一些替代方案。

以下是他列出的替代方案：

*   首先将每个变量设为局部变量，并仅在需要时将变量设为全局变量
*   区分全局变量和类变量
*   使用访问例程

我在这里提到的东西在这本很棒的书[Code Complete中得到了很好的报道](http://www.cc2e.com/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-03T16:38:54.337

关于使用全局变量，大约有一种最佳实践。

“不。”

（如果这听起来很苛刻，请考虑像 CurrentUser 这样的东西通常属于环境*已经*为您维护一个唯一实例的东西，例如会话。查找 API 以获取当前会话，将您的 CurrentUser 存储在那里并从中检索它那里。不要创建自己的全局变量，这将使您的应用程序更难维护并且容易受到竞争条件的影响。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-03T16:37:51.173

您可以将全局可访问变量存储为适当类的公共只读静态属性，例如创建或填充它的类。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-03T16:49:26.423

使用静态/全局变量严重损害代码的可测试性，因为测试无法确定它操作的对象不会在代码库中看似不相关的区域造成副作用。

如果您有一个需要 CurrentUser 类的实例的类，请让它在其构造函数中请求它。

有关更多信息，请参见此处：http: [//misko.hevery.com/code-reviewers-guide/flaw-brittle-global-state-singletons/](http://misko.hevery.com/code-reviewers-guide/flaw-brittle-global-state-singletons/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-07-11T19:47:52.100

我的做法是将*CurrentUser*、*ConfigFilePath*等全局变量放入*program.vb （带有**sub main*的启动类）。这样，没有人会盲目地使用全局变量，因为它们必须通过*程序*命名空间来访问。

在业务逻辑中，我从不直接使用全局变量。如果任何函数需要使用全局变量，则必须将其作为函数参数发送。

没有办法避免使用全局变量。恕我直言，最好用他们的真实姓名称呼他们并小心使用它们，然后将它们隐藏在单例、会话或文件中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-03T16:40:40.233

单[例模式](http://en.wikipedia.org/wiki/Singleton_pattern)比全局的花园品种更安全。

# sql-server - 修剪所有数据库字段

> ID：507869
> 
> 赞同：8
> 
> 时间：2009-02-03T16:36:26.513
> 
> 标签：sql-server, tsql

你知道 sql server 中是否有一种快速的方法（通过 transact-sql），我可以修剪所有数据库字符串字段。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-03T18:55:34.110

没有游标。复制并粘贴输出。也适用于没有 varchar(max) 的 SQL 2000。如果需要，这可以很容易地扩展为在每个 UPDATE 的末尾添加一个 GO 行。

```
SELECT  SQL
FROM    (       SELECT  t.TABLE_CATALOG
                 ,      t.TABLE_SCHEMA
                 ,      t.TABLE_NAME
                 ,      0               SORT
                 ,      'UPDATE  ' + QUOTENAME(t.TABLE_CATALOG) + '.' + QUOTENAME(t.TABLE_SCHEMA) + '.' + QUOTENAME(t.TABLE_NAME)       SQL
                FROM    INFORMATION_SCHEMA.TABLES       t
                 JOIN   INFORMATION_SCHEMA.COLUMNS      c
                  ON    t.TABLE_CATALOG = c.TABLE_CATALOG
                   AND  t.TABLE_SCHEMA  = c.TABLE_SCHEMA
                   AND  t.TABLE_NAME    = c.TABLE_NAME
                WHERE   t.TABLE_TYPE    = 'BASE TABLE'
                 AND    c.DATA_TYPE     IN ('char','nchar','varchar','nvarchar')
                GROUP BY        t.TABLE_CATALOG
                 ,              t.TABLE_SCHEMA
                 ,              t.TABLE_NAME
                UNION ALL
                SELECT  x.TABLE_CATALOG
                 ,      x.TABLE_SCHEMA
                 ,      x.TABLE_NAME
                 ,      CASE    WHEN    x.COLUMN_NAME_MIN       = y.COLUMN_NAME
                                THEN    1
                                ELSE    2
                        END                                                     SORT
                 ,      CASE    WHEN    x.COLUMN_NAME_MIN       = y.COLUMN_NAME
                                THEN    'SET     '
                                ELSE    ' ,      '
                        END + y.SQL                                             SQL
                FROM    (       SELECT  t.TABLE_CATALOG
                                 ,      t.TABLE_SCHEMA
                                 ,      t.TABLE_NAME
                                 ,      MIN(c.COLUMN_NAME)      COLUMN_NAME_MIN
                                FROM    INFORMATION_SCHEMA.TABLES       t
                                 JOIN   INFORMATION_SCHEMA.COLUMNS      c
                                  ON    t.TABLE_CATALOG = c.TABLE_CATALOG
                                   AND  t.TABLE_SCHEMA  = c.TABLE_SCHEMA
                                   AND  t.TABLE_NAME    = c.TABLE_NAME
                                WHERE   t.TABLE_TYPE    = 'BASE TABLE'
                                 AND    c.DATA_TYPE     IN ('char','nchar','varchar','nvarchar')
                                GROUP BY        t.TABLE_CATALOG
                                 ,              t.TABLE_SCHEMA
                                 ,              t.TABLE_NAME
                        )       x
                 JOIN   (       SELECT  t.TABLE_CATALOG
                                 ,      t.TABLE_SCHEMA
                                 ,      t.TABLE_NAME
                                 ,      c.COLUMN_NAME
                                 ,      QUOTENAME(c.COLUMN_NAME) + ' = LTRIM(RTRIM(' + QUOTENAME(c.COLUMN_NAME) + '))'  SQL
                                FROM    INFORMATION_SCHEMA.TABLES       t
                                 JOIN   INFORMATION_SCHEMA.COLUMNS      c
                                  ON    t.TABLE_CATALOG = c.TABLE_CATALOG
                                   AND  t.TABLE_SCHEMA  = c.TABLE_SCHEMA
                                   AND  t.TABLE_NAME    = c.TABLE_NAME
                                WHERE   t.TABLE_TYPE    = 'BASE TABLE'
                                 AND    c.DATA_TYPE     IN ('char','nchar','varchar','nvarchar')
                        )       y
                  ON    x.TABLE_CATALOG = y.TABLE_CATALOG
                   AND  x.TABLE_SCHEMA  = y.TABLE_SCHEMA
                   AND  x.TABLE_NAME    = y.TABLE_NAME
        )       x
ORDER BY        x.TABLE_CATALOG
 ,              x.TABLE_SCHEMA
 ,              x.TABLE_NAME
 ,              x.SORT
 ,              x.SQL 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-02-03T16:40:03.713

你的问题有点模糊，但这就是你所追求的吗？

```
UPDATE mytable SET mycolumn= LTRIM(RTRIM(mycolumn)) 
```

这将从“mytable”表的“mycolumn”列中的所有值中删除前导空格和尾随空格。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-03T16:41:59.997

通过动态创建更新语句来循环 information_schema.columns 和 RTRIM varchar/nvarchar 列

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-03T17:07:25.497

如果有人知道如何在没有光标的情况下执行此操作，请发布：

```
DECLARE @CRLF AS varchar(2)
SET @CRLF = CHAR(13) + CHAR(10)
DECLARE @TAB AS varchar(1)
SET @TAB = CHAR(9)

DECLARE @template AS varchar(max)
SET @template = 'UPDATE {@OBJECT_NAME}' + @CRLF + 'SET {@column_list}'

DECLARE c CURSOR FAST_FORWARD
    FOR SELECT  DISTINCT
                QUOTENAME(T.TABLE_CATALOG) + '.' + QUOTENAME(T.TABLE_SCHEMA)
                + '.' + QUOTENAME(T.TABLE_NAME) AS [OBJECT_NAME]
        FROM    INFORMATION_SCHEMA.TABLES AS T
        INNER JOIN INFORMATION_SCHEMA.COLUMNS AS C
                ON T.TABLE_CATALOG = C.TABLE_CATALOG
                   AND T.TABLE_SCHEMA = C.TABLE_SCHEMA
                   AND T.TABLE_NAME = C.TABLE_NAME
                   AND T.TABLE_TYPE = 'BASE TABLE'
                   AND C.DATA_TYPE IN ('varchar', 'nvarchar')
        ORDER BY 1

DECLARE @OBJECT_NAME AS sysname

OPEN c

FETCH NEXT FROM c INTO @OBJECT_NAME
WHILE @@FETCH_STATUS = 0
    BEGIN 
        DECLARE @column_list AS varchar(max)
        SELECT  @column_list = COALESCE(@column_list + @CRLF + @TAB + ',', '')
                + QUOTENAME(C.COLUMN_NAME) + ' = LTRIM(RTRIM('
                + QUOTENAME(C.COLUMN_NAME) + '))'
        FROM    INFORMATION_SCHEMA.COLUMNS AS C
        WHERE   C.DATA_TYPE IN ('varchar', 'nvarchar')
                AND QUOTENAME(C.TABLE_CATALOG) + '.'
                + QUOTENAME(C.TABLE_SCHEMA) + '.' + QUOTENAME(C.TABLE_NAME) = @OBJECT_NAME
        ORDER BY C.ORDINAL_POSITION

        PRINT REPLACE(REPLACE(@template, '{@column_list}', @column_list),
                      '{@OBJECT_NAME}', @OBJECT_NAME)

        FETCH NEXT FROM c INTO @OBJECT_NAME
    END

CLOSE c

DEALLOCATE c 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-03T16:43:56.793

只需确保您正在修剪 VARCHAR 字符串字段，而不是 CHAR 字段:)

那不会有多大好处。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-12-03T07:43:10.263

更新了 dan 的答案以使用数据库中的所有表。只需运行代码段并复制结果即可执行。

```
SELECT 'UPDATE [' + TABLE_SCHEMA + '].[' + TABLE_NAME + '] SET [' + Column_Name + '] = ' + 'LTRIM(RTRIM([' + Column_Name + ']))' 
FROM INFORMATION_SCHEMA.Columns c
WHERE Data_Type LIKE '%CHAR%' 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T08:36:34.700

多谢你们，

Entaroadun 代码对我来说工作得很好，我只需要对我的要求做一些小改动，而且我必须在每次迭代时重置 @colum_list。

```
...
  PRINT REPLACE(REPLACE(@template, '{@column_list}', @column_list),
                          '{@OBJECT_NAME}', @OBJECT_NAME)
    PRINT 'GO'
    SELECT  @column_list = null
            FETCH NEXT FROM c INTO @OBJECT_NAME
... 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-05T16:36:56.037

- V 又快又脏！

-- 如果这是生成在单个表上运行的代码，请使用文本输出运行此代码；

设置不计数

声明 @table nvarchar(100) 选择 @table = 'YourTableHere'

SELECT 'UPDATE' + @table + 'SET' SELECT '[' + Column_Name + '] = ' + 'LTRIM(RTRIM([' + Column_Name + '])), ' FROM INFORMATION_SCHEMA.Columns WHERE Table_Name = @table AND Data_Type喜欢'%CHAR%'

- 作为文本输出运行（查询/结果到...结果到文本） - 将文本输出（不包括最后一个逗号）复制并粘贴到新的查询窗口中，然后运行它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-11-06T13:59:43.927

好的，这又快又脏，但是我已经被当前的项目充分激发了“正确”地做到这一点 - 也没有游标，但有一点 sql 连接技巧。确实使用动态sql：

```
--exec    spGenerateTrimStatements 'StaticImportMaturities'
ALTER   PROCEDURE       spGenerateTrimStatements
    (
            @TableName NVARCHAR(100)
    )
AS
    DECLARE @Cr char(2),    
                    @OutputString nvarchar(max)

    SELECT  @Cr = CHAR(13) + CHAR(10)
    SET     NOCOUNT ON

    -- Create table to store commands
    CREATE  TABLE   #tOutput(OutputText nvarchar(500), RowID int identity(1,1))

    -- Build up commands
    INSERT  #tOutput(OutputText)
    SELECT  'UPDATE ' + @TableName + ' SET ' 

    INSERT  #tOutput(OutputText)
    SELECT  '[' + Column_Name + '] = ' + 'LTRIM(RTRIM([' + Column_Name + '])), ' 
    FROM    INFORMATION_SCHEMA.Columns 
    WHERE   Table_Name = @TableName 
       AND Data_Type LIKE '%CHAR%' 

    --      Trim last comma
    UPDATE  #tOutput
    SET             OutputText = LEFT(OutputText, LEN(OutputText)-1)
    WHERE   RowID = (SELECT Max(RowID) FROM #tOutput)

    -- use subselect to concatenate the command string
    SELECT  @OutputString = ISNULL(@OutputString, '') + ISNULL(OutputText, '')
    FROM (SELECT OutputText
          FROM    #tOutput) TextOutput

    -- run the command
    EXEC sp_ExecuteSQL @OutputString 
```

# windows - 免费的代码覆盖工具

> ID：507873
> 
> 赞同：4
> 
> 时间：2009-02-03T16:37:20.520
> 
> 标签：windows, linux, code-coverage, native

是否有适用于本机（非托管）代码的免费代码覆盖工具？对于 Windows 或 Linux 平台？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T16:40:21.823

[EMMA](http://emma.sourceforge.net/)是一个免费的 Java 代码覆盖工具，还有.NET的[NCover](http://ncover.sourceforge.net/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-03T16:44:20.880

[gcov](http://gcc.gnu.org/onlinedocs/gcc/Gcov.html)来自 GNU 工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T16:56:52.727

valgrind应该是可能的：

[http://benjamin-meyer.blogspot.com/2007/12/valgrind-callgrind-tools-part-3-code.html](http://benjamin-meyer.blogspot.com/2007/12/valgrind-callgrind-tools-part-3-code.html)

# multithreading - Delphi表单创建不冻结主线程

> ID：507878
> 
> 赞同：9
> 
> 时间：2009-02-03T16:38:42.247
> 
> 标签：multithreading, delphi, forms, vcl

我在想做的事情上遇到麻烦。我有一些需要一些时间来创建的大表格。为了使应用程序加载更快，我想让表单在主表单的 OnCreate 事件中创建的线程中创建。该线程有一个 TApplication 类型的 FApplication 字段，这显然是 Application 变量。我用它在线程上创建表单，但即使我尝试过

```
FApplication.CreateForm (TfrmXXX, frmXXX) 
```

和

```
frmXXX := TFrmXXX.Create(FApplication) 
```

表格仍未创建。有什么解决方法吗？

提前致谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-03T16:49:56.407

在线程中创建表单根本行不通。VCL ，尤其是视觉部分，不是线程安全的。放弃这个想法，而是优化导致表单需要很长时间创建的代码。你还没有告诉我们慢的部分是什么。如果你能回答这个问题，也许我们可以建议一种加快速度的方法。

通常，在您分析并确切知道问题所在之前，不可能很好地提高一段代码的性能。否则，你只是在浪费时间。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-03T16:51:08.633

解决方案并不容易，因为

1.  Delphi VCL 不是线程安全的
2.  在另一个线程中创建窗口需要相应的线程有一个消息循环

你需要一次所有的表格吗？如果没有，您可以将创建推迟到应用程序空闲的时间（即 TApplicationEvents.OnIdle）。或者只是显示一个漂亮的进度条:)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-03T22:26:59.067

正如 Riho 指出的那样，表单创建不应该占用时间。但是，可能需要时间的是您放入构造函数或该表单的 OnCreate 事件中的所有代码。

正如 Craig 建议的那样，分析您的代码，以便您知道哪些代码占用的时间最多。然后看看你是否可以将一些代码移到一个单独的线程中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T10:29:04.507

如上所述，您必须在 VCL 线程中创建表单。但是，您不需要在那里做所有事情：

如果您的表单有大量图像数据，您可以将其从表单中删除，并将其放在资源文件中（或仅使用原始图像文件）

在表单的构造函数中，启动一个后台线程以从资源中读取图像数据并执行任何其他慢速操作。覆盖您的表单 OnShow 事件，以确保它在显示表单之前等待后台线程完成。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-03-20T09:56:49.233

只需在 OnCreate 表单上放置一个 PostMessage，然后在表单上编写一个过程来处理该 postmessage。这样，所有需要时间的代码都可以从 OnCreate 方法中排除。不过，我确实同意，仅在需要时创建表单，然后确实实现一些逻辑来决定是否要在关闭时释放它..取决于加载时间和用户再次想要它的机会..

Jens Fudge，Archersoft

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-03T21:59:23.957

我无法想象需要线程来解决的表单创建需要这么长时间。如果数据量很大，请尝试限制最初显示的数量。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T03:32:07.077

这是我们之前使用的快捷方式，用于在创建时需要执行大量流程的表单。在表单上放置一个 TTimer 并将其设置为 false。表单的 OnCreate 启用它。然后将您在 OnCreate 中的所有代码放入 OnTimer 事件中。将间隔设置为 250 到 500 就足够了。

这不是一个优雅的解决方案，但它很简单。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T10:06:37.563

正如我之前所说，有一些大表格。DFM 文件大小为 3mb（当然包括图像数据）。我实际上认为大部分的创建时间是由于那个而不是执行的代码。但是可能会在应用程序空闲时拆分 em 并创建它们，当前的加载时间并不是很大（比如 4 或 5 秒），但我会仔细研究它。感谢您的回复。

# c++ - 在向量中查找特定字符串的最佳方法是什么？

> ID：507884
> 
> 赞同：3
> 
> 时间：2009-02-03T16:40:16.113
> 
> 标签：c++, string, stl, vector

例如。我有一些结构：

```
s_Some{
  std::string lable;
  s_some_junk some_junk;
}; 
```

还有一个向量：

```
std::vector<s_Some> mSome; 
```

然后我用很多 s_Somes 填充这个向量。

我需要为这个向量中的单个 s_Some 找到一个迭代器，它有一个特定的标签。到目前为止，我只是遍历所有这些垃圾并将每个标签与想要的标签匹配。这在我看来有点愚蠢。有更好的方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-03T16:44:52.703

选项 1）如果您被迫使用 std::vector，但是一旦向量被填充，它就保持不变，那么您可以对向量进行排序并使用二分搜索。唯一的成本是排序，不会有额外的开销。搜索时间是对数 O(logN)。

选项 2）如果您有自由并且可以选择不同的数据结构，那么考虑使用 map（也是对数）或 unordered_map（预期 O(1)，最坏 O(n)）。

我刚刚注意到您说您希望将每个标签与正在寻找的标签相匹配。所以我得出结论，你可以有重复的标签。然后对于第 2 点，使用相应的 multi_map 容器，而对于第 1 点，事情变得有点混乱。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-03T16:42:35.813

如果您只搜索几次，或者如果您的矢量每次搜索时都可能包含不同的内容，那么很遗憾，别无选择；您将不得不遍历整个向量。

但是，如果您的向量在创建后不会更改并且您必须运行大量搜索，请执行以下操作：

1.  按字符串的升序对向量进行排序（即它们在字典中的方式）。
2.  一旦如此排序，对所有搜索使用[二进制搜索算法](http://en.wikipedia.org/wiki/Binary_search)。

这会快得多。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-03T17:02:12.967

用一个

```
std::multimap< string, s_Some > mSome; 
```

和

```
mSome.insert( std::make_pair( aSome.lable, aSome ) ); 
```

找到你想要的标签值的第一个实例

```
mSome.find( lable_you_want ); 
```

下一个实例将通过递增迭代器来找到。

参看。[http://www.cppreference.com/wiki/stl/multimap/start](http://www.cppreference.com/wiki/stl/multimap/start)

也就是说，除非您需要使用 std::vector。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T16:43:59.740

[您还可以](http://www.cppreference.com/wiki/stl/list/start)使用列表[地图](http://www.cppreference.com/wiki/stl/map/start)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-03T17:00:15.840

您可以使用 find_if 算法来执行此操作。定义一个谓词，如下所示：

```
struct isEqual
{
    isEqual(const std::string& s): m_s(s)
    {}
    bool operator()(S_Some& l)
    {
        return l.lable == m_s;
    }

    std::string m_s;
}; 
```

在搜索时您可以使用

```
std::vector<S_Some>::iterator iter = std::find_if(mSome.begin(),
                                                  mSome.end(),
                                                  isEqual(std::string("AAAA")); 
```

# email - Procmail 转发脚本，用于将电子邮件从一个域转发到另一个域

> ID：507903
> 
> 赞同：-1
> 
> 时间：2009-02-03T16:44:41.910
> 
> 标签：email, postfix-mta, forward, procmail

我正在尝试编写一个 procmail 转发脚本，它将把 mydomain.com 收到的所有邮件转发到 mydomain.NET。更清楚地说，如果邮件是：jack@mydomain.com，它应该转发到：jack@mydomain.net。像这样它应该转发所有相应的电子邮件：我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T18:38:18.107

我认为您正在寻找的可能是使用 sendmail 更好地实现。由于procmail在重定向的情况下无论如何只是将邮件交给sendmail。

在您的 sendmail 虚拟用户表中使用以下指令：

```
@mydomain.com %1@mydomain.net 
```

这将有效地将 mydomain.com 上的每个用户映射到远程 mydomain.net

我不确定 procmail 中是否允许使用上述一般性的东西，我只使用 procmail 来过滤我的个人邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T19:05:19.987

一般来说 .procmailrc 文件是按用户部署的。也就是说，用户“jack”将拥有一个，而用户“jill”将拥有一个不同的。有了这个限制，实际上不可能让一个 .procmailrc 文件作用于“在 mydomain.com 收到的所有邮件”。

但是，您的服务器可能配置为将所有传入的电子邮件发送到单个用户的帐户。在这种情况下，您将面临非常艰巨的任务，即找出每条传入消息的预期收件人。虽然这听起来很简单，但事实并非如此。您可以使用 procmail 来解析 To 和 Cc 标头，但这不考虑密件抄送和邮件列表服务器等不在标头中包含此信息的信息。

请参阅此[警告](http://www.ii.com/internet/robots/procmail/qs/#virtualDomain)和给出的一些建议。

Steen 建议使用您的 MTA（sendmail、postfix 等）进行重定向是一个很好的建议。

--
bmb

# apache-flex - 在 Flex 中的 HTTP Post 中上传任意数据

> ID：507913
> 
> 赞同：2
> 
> 时间：2009-02-03T16:46:55.070
> 
> 标签：apache-flex, actionscript-3, http, post

我们目前有一个 Java 小程序，它可以生成大量数据并将其上传到我们的服务器。我们拥有的一种上传方法是使用 HTTP POST 到我们的服务器，其内容只是原始数据（没有多部分编码或任何东西）。

我正在考虑实现一个做同样事情的 Flex 应用程序，但我没有看到复制该网络行为的方法。Flex 中所有与 HTTP 相关的网络类似乎都在假设您只是发出请求的情况下工作。我看不到实际设置 POST 有效负载的方法（除了设置几个查询参数，这在此处不起作用）。

我真正想要的是能够启动一个 HTTP POST，然后能够像我写一个套接字一样写入连接。这是否可能无需在 Socket 类之上编写我自己的 HTTP 实现？有没有办法在 Flex 中设置 HTTP POST 的负载？

澄清：能够创建一个数据缓冲区并将其发送到服务器就足够了（看起来是可能的）。如果我可以将连接视为套接字并随着时间的推移将数据发送给它会更好，而不是一次全部发送，但这不是严格要求的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T17:26:38.890

听起来你是在问两个问题。是的，有一种方法可以在 Flex 中设置 HTTP POST 的有效负载，并将任何格式的文件上传到您的服务器：

```
private function doPost():void
{
    var yourData:ByteArray = new ByteArray();
    var encoder:Base64Encoder = new Base64Encoder();

    for (var i:int = 0; i < 10000; i++)
        yourData.writeByte(i);

    yourData.position = 0;
    encoder.encodeBytes(yourData);

    var req:URLRequest = new URLRequest("http://yourdomain.com/yourservice.ext");
    req.method = URLRequestMethod.POST;

    var postData:URLVariables = new URLVariables();
    postData.userData = encoder.flush();

    req.data = postData;

    var loader:URLLoader = new URLLoader();
    loader.dataFormat = URLLoaderDataFormat.BINARY;
    loader.addEventListener(Event.COMPLETE, loader_complete);
    loader.load(req);
}

private function loader_complete(event:Event):void
{
    trace("Upload complete!");
} 
```

...但听起来您也想连接，保持连接打开，然后“像套接字一样”任意写入；如果是这种情况，那么除了为此目的使用 Socket 类之外，我不相信有内置机制，不。希望它仍然有帮助！

# .net - 为什么 String.Empty 不是常数？

> ID：507923
> 
> 赞同：204
> 
> 时间：2009-02-03T16:49:46.673
> 
> 标签：.net, string, readonly, constants

在 .NET 中，为什么`String.Empty`只读而不是常量？我只是想知道是否有人知道该决定背后的原因。

* * *

## 回答 #1

> 赞同：159
> 
> 时间：2009-02-03T17:24:23.577

`static readonly`使用 代替 的原因`const`是由于使用了非托管代码，正如 Microsoft 在[Shared Source Common Language Infrastructure 2.0 Release](http://www.microsoft.com/downloads/details.aspx?FamilyId=8C09FD61-3F26-4555-AE17-3121B4F51D4D&displaylang=en)中指出的那样。要查看的文件是`sscli20\clr\src\bcl\system\string.cs`.

> Empty 常量保存空字符串值。我们需要调用 String 构造函数，以便编译器不会将其标记为文字。
> 
> 将其标记为文字意味着它不会显示为我们可以从本机访问的字段。

我从[CodeProject 的这篇方便的文章中](http://www.codeproject.com/KB/dotnet/StringEmpty.aspx)找到了这些信息。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-02-03T17:43:28.747

我认为这里有很多混乱和不好的反应。

首先，`const`字段是`static`成员（**不是实例成员**）。

检查 C# 语言规范的第 10.4 节常量。

> 即使常量被认为是静态成员，常量声明既不需要也不允许静态修饰符。

如果`public const`成员是静态的，则不能认为常量会创建一个新对象。

鉴于此，以下代码行在创建新对象方面执行*完全相同的操作。*

```
public static readonly string Empty = "";
public const string Empty = ""; 
```

这是 Microsoft 的注释，解释了两者之间的区别：

> readonly 关键字与 const 关键字不同。const 字段只能在字段声明时进行初始化。只读字段可以在声明或构造函数中初始化。因此，只读字段可以具有不同的值，具体取决于使用的构造函数。此外，虽然 const 字段是编译时常量，但 readonly 字段可用于运行时常量，...

所以我发现这里唯一合理的答案是 Jeff Yates 的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-05-18T11:02:47.823

```
String.Empty read only instead of a constant? 
```

**如果您将任何字符串设为常量**，那么编译器将在您调用它的任何地方用**实际字符串**替换，并且您用相同的字符串填充您的代码，并且当代码运行时还需要一次又一次地从不同的内存中读取该字符串数据。

如果您将字符串只保留在一个地方，因为它是`String.Empty`，程序只在一个地方保留相同的字符串并读取它，或者引用它 - 保持内存中的数据最少。

此外，如果您使用 String.Empty 作为 const 编译任何 dll，并且由于任何原因 String.Empty 发生更改，则编译后的 dll 将不再工作，因为`cost`内部代码实际上保留了字符串的副本每次通话。

例如，请参阅此代码：

```
public class OneName
{
    const string cConst = "constant string";
    static string cStatic = "static string";
    readonly string cReadOnly = "read only string";

    protected void Fun()
    {
        string cAddThemAll ;

        cAddThemAll = cConst;
        cAddThemAll = cStatic ;
        cAddThemAll = cReadOnly;    
    }
} 
```

将由编译器作为：

```
public class OneName
{
    // note that the const exist also here !
    private const string cConst = "constant string";
    private readonly string cReadOnly;
    private static string cStatic;

    static OneName()
    {
        cStatic = "static string";
    }

    public OneName()
    {
        this.cReadOnly = "read only string";
    }

    protected void Fun()
    {
        string cAddThemAll ;

        // look here, will replace the const string everywhere is finds it.
        cAddThemAll = "constant string";
        cAddThemAll = cStatic;
        // but the read only will only get it from "one place".
        cAddThemAll = this.cReadOnly;

    }
} 
```

和装配电话

```
 cAddThemAll = cConst;
0000003e  mov         eax,dword ptr ds:[09379C0Ch] 
00000044  mov         dword ptr [ebp-44h],eax 
        cAddThemAll = cStatic ;
00000047  mov         eax,dword ptr ds:[094E8C44h] 
0000004c  mov         dword ptr [ebp-44h],eax 
        cAddThemAll = cReadOnly;
0000004f  mov         eax,dword ptr [ebp-3Ch] 
00000052  mov         eax,dword ptr [eax+0000017Ch] 
00000058  mov         dword ptr [ebp-44h],eax 
```

编辑：更正错字

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T16:51:06.060

这个答案是出于历史目的而存在的。

**起初：**

因为`String`是一个类，因此不能是一个常量。

**扩展讨论：**

在审查这个答案时敲出了很多有用的对话，而不是删除它，直接复制了这个内容：

> 在 .NET 中，（与 Java 不同）字符串和字符串完全相同。是的，您可以在 .NET 中使用字符串文字常量 – DrJokepu 2009 年 2 月 3 日 16:57
> 
> 你是说一个类不能有常量吗？– StingyJack 2009 年 2 月 3 日 16:58
> 
> *是的，对象必须使用只读。只有结构可以做常量。我认为当您使用`string`而不是`String`编译器时，会将 const 更改为您的只读。一切都是为了让 C 程序员开心。– 加里·舒特勒 2009 年 2 月 3 日 16:59*
> 
> tvanfosson 只是稍微详细地解释了一下。“X 不能是一个常数，因为包含的 Y 是一个类”有点过于无上下文了 ;) – Leonidas 2009 年 2 月 3 日 17:01
> 
> string.Empty 是静态属性，它返回 String 类的实例，即空字符串，而不是字符串类本身。– tvanfosson 2009 年 2 月 3 日 17:01
> 
> Empty 是 String 类的只读实例（它不是属性）。– senfo 2009 年 2 月 3 日 17:02
> 
> *头疼。我仍然认为我是对的，但现在我不太确定了。今晚需要研究！– 加里·舒特勒 2009 年 2 月 3 日 17:07*
> 
> 空字符串是字符串类的一个实例。Empty 是 String 类上的静态字段（不是属性，我已更正）。基本上是指针和它所指向的东西之间的区别。如果它不是只读的，我们可以更改 Empty 字段引用的实例。– tvanfosson 2009 年 2 月 3 日 17:07
> 
> 加里，你不需要做任何研究。想想看。字符串是一个类。Empty 是 String 的一个实例。– senfo 2009 年 2 月 3 日 17:12
> 
> 有些东西我不太明白：String 类的静态构造函数到底如何创建 String 类的实例？这不是某种“先有鸡还是先有蛋”的场景吗？– DrJokepu 2009 年 2 月 3 日 17:12 5
> 
> 这个答案对于除 System.String 之外的几乎任何其他类都是正确的。.NET 为字符串做了很多性能特例，其中之一就是你可以拥有字符串常量，试试吧。在这种情况下，杰夫耶茨有正确的答案。– 乔尔·穆勒 2009 年 2 月 3 日 19:25
> 
> 如第 7.18 节所述，常量表达式是可以在编译时完全计算的表达式。由于创建除字符串之外的引用类型的非空值的唯一方法是应用 new 运算符，并且由于常量表达式中不允许使用 new 运算符，因此引用类型常量的唯一可能值字符串以外的为空。前面的两条评论直接取自 C# 语言规范，并重申了 Joel Mueller 提到的内容。– senfo 2009 年 2 月 4 日 15:05 5

# tfs - TFS 似乎停留在“获取资源”步骤中？

> ID：507926
> 
> 赞同：3
> 
> 时间：2009-02-03T16:50:20.353
> 
> 标签：tfs

我终于让服务器帐户为构建工作。

现在，当我运行骨架构建时，它卡在“获取资源”步骤中，绿色条正在发光，但没有其他响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2010-05-21T14:21:30.680

您可以从 cmd 行运行构建并检查发生了什么，您还可以将构建控制器中的默认工作目录更改为更短的名称，因为有时会超出默认目录名称长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-06T22:37:53.300

如果您使用 2005 或 2008 且标签设置为 false，则 TFS 将尝试每次删除并重新创建构建工作区。例如，当工作区中的一个文件被另一个进程锁定时（如 cmd.exe - 每次都让我知道），这可能会导致问题。

# python - 如何安装 pyCurl？

> ID：507927
> 
> 赞同：27
> 
> 时间：2009-02-03T16:50:24.657
> 
> 标签：python, libcurl, pycurl, installation

我使用 libcurl 没有问题，过去使用过一次 pyCurl。现在我想在我的机器和开发人员上设置它。但是我不知道该怎么做。我宁愿不 DL libcirl 文件并将其与 pycurl 一起编译，我想知道最简单的方法。我的机器上安装了 libcurl。

我在 Windows 上。我尝试 DLing 源代码并使用 pycurl 设置脚本，但我没有运气。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-05-22T09:52:55.163

**总长，博士**

从该网站获取二进制文件：[http ://www.lfd.uci.edu/~gohlke/pythonlibs/](http://www.lfd.uci.edu/~gohlke/pythonlibs/)

直接链接：[`2.6 32bit`](http://www.lfd.uci.edu/~gohlke/pythonlibs/qjbh48zu/pycurl-7.19.0.win32-py2.6.exe), [`2.7 32bit`](http://www.lfd.uci.edu/~gohlke/pythonlibs/qjbh48zu/pycurl-7.19.0.win32-py2.7.exe), [`2.6 64bit`](http://www.lfd.uci.edu/~gohlke/pythonlibs/qjbh48zu/pycurl-7.19.0.win-amd64-py2.6.exe),[`2.7 64bit`](http://www.lfd.uci.edu/~gohlke/pythonlibs/qjbh48zu/pycurl-7.19.0.win-amd64-py2.7.exe)

* * *

对于 pycURL，两者`pip`和`easy_install`在 Windows 上都会失败。

我还尝试在下载 cURL 后手动下载并安装 pycURL 包，但这也不起作用，即使指定了 `CURL_DIR`（它抱怨它找不到 'lib\libcurl.lib' ）。从我可以从自述文件中收集到的内容，它需要的`CURL_DIR`是 cURL 的源代码分发，而不是可执行文件。

从官方[pycURL 存储库](http://pycurl.sourceforge.net/download/)下载预编译版本可能会让您一事无成，因为它需要 Python 2.5。它*不适*用于 2.6。

目前唯一简单的方法似乎是 [这个](http://www.lfd.uci.edu/~gohlke/pythonlibs/5kq9gygp/pycurl-7.19.0.win32-py2.6.exe) 非官方版本。它是一个可执行的安装程序，我在 Python 2.6 上使用它时没有任何问题。可 从[同一站点](http://www.lfd.uci.edu/~gohlke/pythonlibs/)[获得 Python 2.7 版本](http://www.lfd.uci.edu/~gohlke/pythonlibs/5kq9gygp/pycurl-7.19.0.win32-py2.7.exe)。

* * *

您可能还想考虑使用[`requests`](http://docs.python-requests.org/en/latest/)pycURL 的流行替代方法。使用起来很愉快，并且正在积极开发中。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2011-03-21T23:35:40.197

您可以尝试从这里下载 pycurl

[http://www.lfd.uci.edu/~gohlke/pythonlibs/](http://www.lfd.uci.edu/~gohlke/pythonlibs/)

> PycURL 是 libcurl 库的接口。
> pycurl-7.19.0.win-amd64-py2.6.‌exe [863 KB] [Python 2.6] [64 位] [2010 年 12 月 9 日]
> pycurl-7.19.0.win-amd64-py2.7.‌exe [863 KB] [Python 2.7] [64 位] [2010 年 12 月 9 日]
> pycurl-7.19.0.win32-py2.6.‌exe [764 KB] [Python 2.6] [32 位] [2010 年 12 月 9 日]
> pycurl-7.19 .0.win32-py2.7.‌exe [764 KB] [Python 2.7] [32 位] [2010 年 12 月 9 日]

或在这里

[http://pycurl.sourceforge.net/download/](http://pycurl.sourceforge.net/download/)

> pycurl-ssl-7.15.5.1.win32-py2.4.exe 02-Oct-2006 10:10 534K 预编译的 win32 安装程序（带有 openssl-0.9.8c、zlib-1.2.3、c-ares-1.3.1）
> pycurl -ssl-7.15.5.1.win32-py2.5.exe 02-Oct-2006 10:10 534K 预编译的 win32 安装程序（带有 openssl-0.9.8c、zlib-1.2.3、c-ares-1.3.1）
> pycurl- ssl-7.16.4.win32-py2.4.exe 05-Sep-2007 19:28 546K 预编译的 win32 安装程序（带有 openssl-0.9.8e、zlib-1.2.3、c-ares-1.4.0）
> pycurl-ssl -7.16.4.win32-py2.5.exe 05-Sep-2007 19:27 546K 预编译的 win32 安装程序（带有 openssl-0.9.8e、zlib-1.2.3、c-ares-1.4.0）
> pycurl-ssl- 7.18.2.win32-py2.5.exe 17-Jun-2008 20:43 540K 预编译的 win32 安装程序（带有 openssl-0.9.8h、zlib-1.2.3）

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-02-03T16:56:48.577

取决于平台。在 ubuntu 上，它很简单：

```
sudo apt-get install python-pycurl 
```

一个包很常见，以至于大多数主要的 Linux 发行版都会在其源代码中包含它。

如果你在 Windows 上，你也需要[cURL](http://curl.haxx.se/download.html)。然后，您可以安装包装在安装程序中的[pycurl 。](http://pycurl.sourceforge.net/download/)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-02-15T19:07:16.393

根据[http://bazaar-vcs.org/PyCurl](http://bazaar-vcs.org/PyCurl)

> 由于 Windows 既没有 cURL 也没有 pycURL，Windows 用户必须同时安装两者。
> 
> cURL 下载： [http](http://curl.haxx.se/download.html) ://curl.haxx.se/download.html 。
> 
> pycURL 下载： [http](http://pycurl.sourceforge.net/download/) ://pycurl.sourceforge.net/download/ 。
> 
> 两个链接都包含 Linux（和其他 *Nix）压缩包/包和 Windows 安装程序文件。

两个链接都有 Windows 安装程序，希望它们对您有用。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-03T17:42:26.067

正如已经说过的，这取决于平台。

一般来说，我更喜欢只使用为我的操作系统打包的 Python 解释器本身，并在[虚拟环境](http://pypi.python.org/pypi/virtualenv)中安装其他所有东西，但这是一个完全不同的故事......如果你安装了[setuptools](http://pypi.python.org/pypi/setuptools/)，安装大多数 Python 包是很简单：

```
easy_install pycurl 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-01-09T14:03:08.160

我的环境是 Windows 7 和 Python 2.7。虽然我的 Windows 7 是 64 位的，但我的 Python 2.7 是 32 位的。

我通过访问[http://pycurl.sourceforge.net/download/](http://pycurl.sourceforge.net/download/)并下载并运行 pycurl-7.19.3.win32-py2.7.msi 取得了成功。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-09-06T12:15:23.937

```
sudo apt install libcurl4-openssl-dev libssl-dev
pip install pycurl 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-10-30T15:46:06.520

Windows：python 3.7.1`.msi`从[https://dl.bintray.com/pycurl/pycurl/](https://dl.bintray.com/pycurl/pycurl/)下载并安装，它运行良好。

# sql-server-2005 - Tsql VarChar 隐式到 SmallDateTime

> ID：507931
> 
> 赞同：0
> 
> 时间：2009-02-03T16:51:07.997
> 
> 标签：sql-server-2005, tsql, varchar, smalldatetime

当对返回的结果使用 smalldatetime 约束执行以下操作时，我得到零结果：

```
Execute sp_proc @DateOfBirth =   '01/01/1900' 
```

**或者**

```
Execute sp_proc @DateOfBirth =   '1900-01-01' 
```

**但是，当突然使用以下 varchar 参数时，我得到了对应于 2000 年 1 月 1 日的结果。 smalldatetime 隐式转换是否不适用于 mm/dd/YYYY 日期并且仅适用于 mm/dd/YY 日期？**

```
Execute sp_proc @DateOfBirth =   '01/01/00' 
```

这将返回 2000 年 1 月 1 日生日的所有结果！

```
CREATE PROCEDURE [dbo].[sp_proc] 
    -- Add the parameters for the stored procedure here

    @DateOfBirth SmallDateTime = null 

AS
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from
    -- interfering with SELECT statements.
    SET NOCOUNT ON;

    -- Insert statements for procedure here
    SELECT *
    FROM
        view_People
    WHERE
        FirstName LIKE '%' + IsNull(@FName ,FirstName) + '%'
    AND
        LastName LIKE '%' + IsNull(@LName,LastName) + '%'
    AND
        DOB = IsNull(@DateOfBirth,DOB) 
    AND
        SSN = IsNull(@SSN,SSN) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-03T17:06:30.023

“01/01/00”基于“[两位数年份截止](http://msdn.microsoft.com/en-us/library/ms189577(SQL.90).aspx)”选项进行转换。所以它变成了 2000 年 1 月 1 日。

如果您发送“1900-01-01”，那么您的代码显示只有当 DOB = 1900 年 1 月 1 日时您才会得到结果。

除此之外，它的工作方式与宣传的一样。除非你想跑`Execute sp_proc @DateOfBirth = DEFAULT`强制 DOB 被忽略

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-03T17:21:13.910

从技术上讲，您应该比较以下输出：

```
Execute sp_proc @DateOfBirth =   '01/01/00' 
```

到：

```
Execute sp_proc @DateOfBirth =   '01/01/2000' 
```

或者

```
Execute sp_proc @DateOfBirth =   '2000-01-01' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T16:58:15.140

使用像 YYYYMMDD 这样的安全格式（没有破折号）

运行这些也看看会发生什么

```
select convert(smalldatetime,'19000101')
select convert(smalldatetime,'01/01/00')
select convert(smalldatetime,0) 
```

# algorithm - 求多边形的内角数，大于 180º

> ID：507933
> 
> 赞同：5
> 
> 时间：2009-02-03T16:51:09.273
> 
> 标签：algorithm, geometry, polygon

如何找到多边形的内角数，大于 180º，只有多边形的顶点？

对于每个顶点，我总是想要内角，而不是外角。

来自巴西的感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T17:59:00.057

您可以简单地通过取标量积（点积）来确定两个向量的角度。一个有用的特性是，如果向量是正交的，则它们的标量积为零；如果它们的角度是钝角，则乘积为负，否则为正。因此，要采取的步骤是：

*   找到从 V0 到 V1 的第一条边（作为向量，您可以通过减去坐标得到），然后将其向左旋转 90 度（这只是转换`(x y)`为`(-y x)`）
*   找到从 V1 到 V2 的第二条边（未旋转）
*   取标量积（这只是`(x1 * x2) + (y1 * y2)`）
*   如果标量积为负，则为右转，否则为左转
*   下一个边缘...
*   如果逆时针通过顶点，则计算右转次数，否则计算左转次数
*   对于最后一个顶点，您必须返回第一个（即使用边 Vn 到 V0 和 V0 到 V1）

*编辑*：您可以通过使用以下公式计算多边形的面积来确定顶点是逆时针还是顺时针排列：

```
     1 n-1
A = --- SUM( x(i)*y(i+1) - x(i+1)*y(i) )
     2 i=0

```

其中`n`是顶点数。`x(n)`and 与 and相同`y(n)`（关闭多边形）。`x(0)``y(0)`

如果它是正的，那么顶点是逆时针排列的，否则是顺时针排列的。

*编辑*：当您简化旋转和标量积的步骤时，您会得到二维叉积的公式`x1*y2 - x2*y1`。这简化了上面的第一步：

*   找到从 V0 到 V1 的第一条边（作为向量，通过减去坐标）
*   从 V1 到 V2 的第二条边的 dito
*   取叉积`((x1 * y2) - (x2 * y1))`
*   如果叉积为正，则为左转

抱歉，第一种方法令人费解。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-03T17:22:41.597

1.  找到顶点的[凸包](http://en.wikipedia.org/wiki/Convex_hull_algorithms)。
2.  识别*不*位于凸包上的顶点。这些是具有 >180 个外角的候选顶点。
3.  对于每个这样的顶点，进一步研究角度（现在想不出任何方法，但你可以扩展它）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T17:02:59.203

我假设这是一个不规则多边形，因为规则多边形的内角很难大于 180 度。

对于每个顶点，您还需要知道两个相邻顶点。然后，您可以将其转换为三角问题，在其中找到从主顶点到左顶点的角度，并将其添加到从主顶点到右顶点的角度。

例如，

```
tan(angle_to_left) = (vy-left.x)/(vy-left.y)
tan(angle_to_right) = (vy-right.x)/(vy-right.y)

```

然后将角度相加。

最后，对于大于 180 的所有角度，增加一个计数器。在遍历所有顶点后，您的计数器会告诉您有多少个内角大于 180。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T17:31:30.067

切线的问题是当 x==0 时。如果您只知道多边形的顶点，那么除非它是一个三角形，否则您所知道的还不够，因为它们可能具有任何类型的连通性。

假设您知道连通性，那么您将需要计算缠绕顺序（即，点在多边形周围的哪个方向？）。使用缠绕顺序，您可以获取每个点与其相邻点的叉积，并取其幅度的反正弦以获得角度。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-18T07:49:57.127

求最后两个向量的内角（作为例子），我们需要对多边形的最后两个向量实现这个方程：

angleRadians = Math.acos((vx1 * vx2 + vy1 * vy2) / ( Math.sqrt( vx1*vx1 + vy1*vy1 ) * Math.sqrt( vx2*vx2 + vy2*vy2 ) ));

这是使用向量的点积。如果您对此有疑问，[这里有一个教程](http://www.youtube.com/watch?v=98C7iv8OcnI&list=FLp1JCtUAt1iLLUN6Sc74HQg&feature=mh_lolz)

但这并没有考虑到“缠绕方向”，首先你必须得到叉积，如果叉积是正的，那就是左转，如果是负的——右转（我们将通过减去(ext) 360 度角。

我在这里包含了我的 JS 代码，作为要点：[https](https://gist.github.com/3741816) ://gist.github.com/3741816 。

:D

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-02-03T16:59:56.933

这是一个与几何有关的问题，与编程不完全相关。

如果你有顶点，你可以通过三角函数找到内角，类似于你如何找到三角形的角度。

使用三个相邻的顶点，想象一个三角形，它们会找到内角。

例如，看多边形：

![多边形](https://i.stack.imgur.com/rCWzy.jpg)

我们可以构造一个三角形：

![构建内部三角形](https://i.stack.imgur.com/njthC.jpg)

# c# - 如何在 C# 中为 TcpClient 使用字符串而不是字节？

> ID：507936
> 
> 赞同：1
> 
> 时间：2009-02-03T16:51:35.873
> 
> 标签：c#, .net

在 C# 中，我尝试通过 TcpClient 发送一个字符串，如下所示：

```
byte[] outputOutStream = new byte[1024];
ASCIIEncoding outputAsciiEncoder
string message //This is the message I want to send
TcpClient outputClient = TcpClient(ip, port); 
Stream outputDataStreamWriter   

outputDataStreamWriter = outputClient.GetStream();
outputOutStream = outputAsciiEncoder.GetBytes(message);
outputDataStreamWriter.Write(outputOutStream, 0, outputOutStream.Length); 
```

我必须将消息从字符串转换为字节，**有没有办法可以直接将它作为字符串发送？**

我知道这在 Java 中是可能的。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-03T16:57:05.987

[`StreamWriter`](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.aspx)在 outputClient.GetStream 之上创建一个：

```
StreamWriter writer = new StreamWriter(outputClient.GetStream(),
                                       Encoding.ASCII);
writer.Write(message); 
```

（您可能想要一个`using`语句自动关闭编写器，并且您还应该仔细考虑要使用哪种编码。您确定要将自己限制为 ASCII 吗？如果您控制连接的两端，那么可以选择任意编码，那么 UTF-8 通常是一个不错的选择。）

# regex - 如何从第一个非字母字符开始的字符串中删除所有字符？

> ID：507941
> 
> 赞同：2
> 
> 时间：2009-02-03T16:52:44.077
> 
> 标签：regex, perl, string, parsing

如果不是在某些情况下，这会容易得多。

样本数据：

```
KENP989SD
KENP913E
KENPX189R
KENP913 
```

我可以使用什么正则表达式从第一个非字母字符开始的字符串中删除所有字符？基本上，我想找到第一个非字母字符，然后不管 char 类型如何都将所有内容都砍掉。

应用正则表达式后，这些数据应为：

```
KENP
KENP
KENPX
KENP 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-03T17:10:58.313

`$s =~ s/[^a-zA-Z].*$//;`

从字面上看，找到第一个非 alpha 字符并从它开始切掉所有内容。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-03T17:28:31.913

您以两种方式表达了请求：

1.  获取这些字符串前面的所有 alpha 字符
2.  找到最后一个 alpha char 并在之后切掉所有内容

虽然结果与您的示例字符串相同，但我发现对正则表达式更加小心是值得的。因此，我将上面的第一项作为真正的要求，并将其写为：

```
$str =~ s/^([a-z]*)[^a-z].*/$1/i; 
```

我认为的优势是意外字符串（如“7KENP989SD”）在替换后应该导致空字符串，而不是像“7KENP”这样的意外字符串。当然，也许这就是你想要的……

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-03T16:56:43.350

```
s/([A-Za-z]*).*/$1/ 
```

... 将工作。这不一定是最好的方法，但它是一般情况下的替换。

仅当您只需要字母字符时才有效

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T08:38:54.977

`s/\P{Alpha}.*//`对我有用：

```
perl -pe 's/\P{Alpha}.*//' <<EOF
KENP989SD
KENP913E
KENPX189R
KENP913
EOF 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-03T17:02:39.673

也许是这样：

```
s/(?<=^[A-Z]+).*// 
```

使用后视将起始 alpha 之后的所有内容替换为空白。

如有必要，添加不区分大小写的 i 标志：

```
s/(?<=^[A-Z]+).*//i 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-03T17:16:07.710

**注意：**我认为 Igor 的效率更高。

```
$str =~ s{^([A-Z]+).*}{$1}; 
```

为不区分大小写的匹配添加“i”标志

```
$str =~ s{^([A-Z]+).*}{$1}i; 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-02-03T17:29:55.763

这是我的尝试。

**/^([A-Za-z] *)。*$/**

* * *

**编辑**我比我更喜欢伊戈尔的方法..

* * *

代码：

```
#!/usr/bin/perl
#
# http://stackoverflow.com/questions/507941/perl-regex-remove-all-characters-from-string-after-last-alpha-character
#
use strict;
use warnings;
for my $string (<DATA>){
    $string =~ /^([A-Za-z]*).*$/;
    print "$1\n";
}
__DATA__
KENP989SD
KENP913E
KENPX189R
KENP913 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-02-03T21:34:30.483

如果你不需要修改输入行本身，我用这个多一点：

```
my ( $alpha_prefix ) = ( $input_line =~ /^(\p{IsAlpha}*)/ ); 
```

在绝大多数情况下，我的大多数变量都是词汇，所以还有一些变量不会伤害到我，也不会让我误报输入。另外，它通过了[taint](http://perldoc.perl.org/perlsec.html#Taint-mode-and-@INC)。

# .net - XAML 中的“{x:Static}”是什么意思？

> ID：507942
> 
> 赞同：37
> 
> 时间：2009-02-03T16:52:47.400
> 
> 标签：.net, wpf, xaml

XAML 中的含义是什么`{x:Static}`？

代码示例：

```
<SolidColorBrush Color="{x:Static SystemColors.ControlColor}" /> 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2009-02-03T17:02:30.140

这是一种将任何静态值插入 XAML 的方法。例如，如果我有一堂课：

```
namespace A 
{ 
    public class MyConstants 
    {
        public static readonly string SomeConstantString = "BAM!";
    }
} 
```

我可以使用 XAML 将它放入 WPF UI 中，如下所示：

```
<TextBlock Text="{x:Static A:MyConstants.SomeConstantString}" /> 
```

请注意，您必须将定义 MyConstants 的命名空间导入 XAML。所以在 or 元素中执行如下操作：

```
xmlns:A="clr-namespace:A" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-03T16:57:45.987

来自 MSDN：http: [//msdn.microsoft.com/en-us/library/ms742135.aspx](http://msdn.microsoft.com/en-us/library/ms742135.aspx)

引用以符合公共语言规范 (CLS) 的方式定义的任何静态按值代码实体。引用的属性在加载 XAML 页面的其余部分之前进行评估，并可用于提供 XAML 中属性的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T16:57:39.637

我发现问题[XAML - Accessing static fields](https://stackoverflow.com/questions/32395/xaml-accessing-static-fields)有一个链接到 MSDN 文档[x:Static Markup Extension](http://msdn.microsoft.com/en-us/library/ms742135.aspx)的答案。我认为这在网站上仍然有用。

# javascript - 禁止输入字段的键盘事件

> ID：507944
> 
> 赞同：2
> 
> 时间：2009-02-03T16:52:47.663
> 
> 标签：javascript, jquery, keyboard

我已经使用 jQuery 的 keypress 事件定义了一些全局键盘处理。

有没有办法抑制*输入*/*文本区域*字段的这些事件，以免干扰输入？
我已经使用了一些基于元素选择器条件的 hack，但是它们对性能有很大的影响，因为它们在每次按键时都会被触发。

（其中一些字段是动态创建的，这超出了我的控制——也许这很相关。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T17:42:50.823

为所有输入和文本区域创建一个 onfocus 处理程序，该处理程序设置一些全局变量，指示应忽略键盘事件。为 blur 事件创建另一个处理程序以重置全局变量。

```
var DISABLE_KEY_HANDLERS = false;

$('input[type=text], input[type=password], textarea').focus(function(){
  DISABLE_KEY_HANDLERS = true
})

$('input[type=text], input[type=password], textarea').blur(function(){
  DISABLE_KEY_HANDLERS = false
}) 
```

在您的密钥处理程序中，您只需要检查该值是否为真，如果为真则返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T16:24:29.843

事实证明，这个活动已经为我提供了我需要的一切；*ev.target*是活动的 DOM 元素，所以我可以检查它是否是一个输入字段。

# jquery - 如何使用 jQuery $.ajax 打开没有回发的 pdf？

> ID：507947
> 
> 赞同：2
> 
> 时间：2009-02-03T16:53:39.097
> 
> 标签：jquery, ajax, pdf

我有一个非常动态的 UI，它为最终用户提供了 2 个详细视图（每一个都比前一个更深入）。当我到达这条链的底部时，我希望能够“预览”一个 pdf 文件......但到目前为止我唯一的运气是使用 window.open(url)，这会在 IE6 中弹出一个额外的浏览器窗口/7（如果可能的话，不需要）

我的问题是——如果我可以在服务器端生成一个 pdf（没问题）并希望在没有回发的情况下向用户显示它，我应该如何构建这种类型的功能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T17:02:11.077

jQuery 只是 javascript 的包装器——它只能编织这么多魔法——你在这里仍然有有限的选择。Window.Open 或 iframe。或者也许你可以找到某种 activex 组件来后台加载 pdf？- 或者也许可以在 javascript 中解释和呈现 pdf .. 但我怀疑这将是一个令人愉快的 UI 体验。

艰难的，希望这会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T17:41:08.893

如果要预览 PDF 内联，唯一的方法是在服务器上渲染图像并加载它。

# nhibernate - NHibernate - 存在的地方（X）

> ID：507952
> 
> 赞同：3
> 
> 时间：2009-02-03T16:56:07.003
> 
> 标签：nhibernate

我有以下表格（简化）：

```
Product(Id, Name)
OrderItem(Id, ProductId) 
```

...映射到以下类：

```
Product {Id, Name}
OrderItem {Id, Product (many-to-one)} 
```

我需要 (N)Hibernate 语法来检索出现在订单中的产品。
SQL 将类似于：

```
select *
from   Product
where  exists (
       select *
       from   OrderItem
       where  OrderItem.ProductId = Product.Id) 
```

如何创建标准？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T12:21:00.630

结果很容易......

```
var query = session.CreateQuery(
            "select distinct oi.Product from OrderItem oi");
return query.List<Product>(); 
```

# php - 每 24 小时运行一个 php 任务

> ID：507965
> 
> 赞同：7
> 
> 时间：2009-02-03T16:58:30.103
> 
> 标签：php, service, cron, scheduled-tasks

我有一些函数使用 curl 从几个站点中提取信息并将它们插入到我的数据库中。我只是想知道每 24 小时执行一次这项任务的最佳方法是什么？

我现在正在关闭 Windows，但一旦我上线可能会切换到 linux（如果这有所作为）。我现在在 symfomy 框架内工作。

我听说 cronjobs 可以做到这一点......但是看看这个网站，它似乎可以远程工作，我宁愿把东西放在家里......我可以在我的电脑上“运行服务”吗？不管那是什么意思；）（听说过）

感谢您的帮助，安德鲁

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-03T16:59:42.237

这正是 Cron (linux) 或计划任务 (windows) 的用途。

您可以在应用程序服务器上运行它们以将所有内容保存在一个地方。

例如，我在我的家庭服务器上运行了一个 cron 来每天备份它的 MySQL 数据库。这个过程只涉及一个系统。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-03T17:17:14.730

添加`0 0 * * * php /path/to/your/cronjob.php`到您的[crontab](http://en.wikipedia.org/wiki/Cron)中应该可以完成此操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-03T17:03:36.613

您可以在 cron 中设置计划任务（或在 windows 中设置计划任务）。最简单的方法是创建一个从命令行执行 php 脚本的 shell 脚本（Windows 中的批处理脚本）（因此您不必使用 www 服务器资源）。当然，您在目标机器上执行脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T17:20:30.683

如果您认为 cron 或 windows 调度程序不合适，我有时会发现编写一个执行相同操作的快速 Java 应用程序很方便：

您可以使用来电`System.getRuntime().exec("cmd line stuff here");`。然后，您可以在`TimerTask`. `Timer`最后，您通过添加 TimerTasks 并指定时间和频率等来启动一个对象......

这显然比上面提到的例子更复杂，但我喜欢它，因为你可以投入一些智能错误处理，并在出现问题时向自己发送电子邮件警报等。

可能是矫枉过正，但如果你有几个这样的操作要处理，可能值得一看。

斯威尼

# xml - Fortran XML 库的建议

> ID：507966
> 
> 赞同：3
> 
> 时间：2009-02-03T16:58:35.733
> 
> 标签：xml, fortran

对 Fortran XML 库有什么建议吗？我找到了[一些](http://www.google.com/search?q=fortran+xml)，但我不知道它们的支持程度如何。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-07T18:40:29.113

Toby White 编写了一个非常有用的库 FoX，可以在以下位置找到：

[http://uszla.me.uk/space/software/FoX/](http://uszla.me.uk/space/software/FoX/)

它提供了一个能够在 Fortran95 中读写 XML 的库。它被广泛用于计算化学和矿物学界——我不知道有多远。每当我有需要发出 XML 的 Fortran 程序时，我都会使用 FoX。

Toby 现在继续前进，但我希望你能够毫无问题地运行 FoX，除非你的机器有一个不常用的编译器。我希望如果您有任何问题，托比将能够回答他们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-26T23:49:41.823

[F77xml](http://members.ferrara.linux.it/munehiro/f77xml/)，虽然它需要 gdome2

# javascript - 需要 jquery/javascript 弹出窗口脚本的帮助 - 在 Internet Explorer 中出现奇怪的错误

> ID：507968
> 
> 赞同：2
> 
> 时间：2009-02-03T16:59:40.520
> 
> 标签：javascript, jquery, internet-explorer, popupwindow

我正在尝试构建一个 jquery 脚本，它将为类似邮件的应用程序打开一个新的浏览器窗口（弹出窗口）（用户可以双击邮件，它们将在新窗口中打开）。

这并不是特别难。我的问题是我想跟踪打开的窗口，这样如果用户再次双击同一个邮件项目，它只会将焦点放在已经打开的弹出窗口上，而不是重新加载它。

我让它在 Firefox 中运行，但 Internet Explorer 返回以下错误：

```
Line: 51
Error: The interface is unknown. 
```

特别是，当用户关闭一个弹出窗口，然后双击邮件项目再次打开它时，就会发生这种情况。

我的 javascript/jquery 技能充其量是初级的，所以我希望这里有人可以提供帮助。这是脚本的代码。

```
(function($)
{
    var _popupTracker = {}
    var _popupCounter = 0;
    $.fn.openPopupWindow = function(options)
    {
        var defaults = {
            height: 600, // sets the height in pixels of the window.
            width: 600, // sets the width in pixels of the window.
            toolbar: 0, // determines whether a toolbar (includes the forward and back buttons) is displayed {1 (YES) or 0 (NO)}.
            scrollbars: 0, // determines whether scrollbars appear on the window {1 (YES) or 0 (NO)}.
            status: 0, // whether a status line appears at the bottom of the window {1 (YES) or 0 (NO)}.
            resizable: 1, // whether the window can be resized {1 (YES) or 0 (NO)}. Can also be overloaded using resizable.
            left: 0, // left position when the window appears.
            top: 0, // top position when the window appears.
            center: 0, // should we center the window? {1 (YES) or 0 (NO)}. overrides top and left
            createnew: 0, // should we create a new window for each occurance {1 (YES) or 0 (NO)}.
            location: 0, // determines whether the address bar is displayed {1 (YES) or 0 (NO)}.
            menubar: 0 // determines whether the menu bar is displayed {1 (YES) or 0 (NO)}.
        };

        var options = $.extend(defaults, options);

        var obj = this;

        // center the window
        if (options.center == 1)
        {
            options.top = (screen.height - (options.height + 110)) / 2;
            options.left = (screen.width - options.width) / 2;
        }

        var parameters = "location=" + options.location +
                         ",menubar=" + options.menubar +
                         ",height=" + options.height +
                         ",width=" + options.width +
                         ",toolbar=" + options.toolbar +
                         ",scrollbars=" + options.scrollbars +
                         ",status=" + options.status +
                         ",resizable=" + options.resizable +
                         ",left=" + options.left +
                         ",screenX=" + options.left +
                         ",top=" + options.top +
                         ",screenY=" + options.top;

        // target url
        var target = obj.attr("href");       

        // test if popup window is already open, if it is, just give it fokus.        
        var popup = _popupTracker[target];
        if (options.createnew == 0 && popup !== undefined && !popup.closed)
        {            
            popup.focus();
        } 
        else
        {
            var name = "PopupWindow" + _popupCounter;
            _popupCounter++;

            // open window
            popup = window.open(target, name, parameters);            
            _popupTracker[target] = popup;
            _popupTracker[target].focus();
        }

        return false;
    };        
})(jQuery); 
```

给我错误的代码行是：

```
if (options.createnew == 0 && popup !== undefined && !popup.closed) 
```

谢谢，埃吉尔。

**更新：**事实证明这实际上是 IE8 的东西，至少是 Windows 7 beta 中的版本。我建立了一个测试页面（[http://egil.dk/popuptest/popup-source.htm](http://egil.dk/popuptest/popup-source.htm)），它似乎在我的同事 IE7 中按预期工作。嘎嘎，浪费时间！

**更新2：**我可能应该告诉如何重现错误。转到[http://egil.dk/popuptest/popup-source.htm](http://egil.dk/popuptest/popup-source.htm)，单击其中一个链接，即“something 1”，弹出窗口完成加载后，返回父窗口，然后单击相同的链接再次。这一次，弹出窗口将再次获得焦点，而不是重新加载（这是故意的，也是我想要的）。现在关闭弹出窗口，然后再次单击相同的链接。这会在 IE8 beta 中产生错误。在 Firefox 中，它正确地重新打开。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-03T19:51:42.047

我注意到的唯一一件事是，您的默认菜单栏后有一个额外的逗号。删除最后一个逗号后，它在 IE7 上对我来说效果很好。如果 IE 给你这个问题是什么版本？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-08-26T17:10:02.103

以下似乎对我有用。如果有人可以改进它，请做！

在 Firefox 中，弹出窗口只有在打开时才会获得焦点。在 IE8 中，“接口未知”错误被捕获，弹出窗口被关闭并重新打开。在所有情况下，window.open 行都会将当前“页面”加载到弹出窗口中。

```
变种比吉姆；// 在函数外部设置这个变量，所以第一次
             // 弹出窗口打开，bigimg 是一个已定义的变量，并且 if 不会阻塞。

功能弹出大图片（页面）
  {
  尝试
    {
    if(window.focus && bigimg) bigimg.focus();
    }
  抓住（错误）
    {
    if(bigimg) bigimg.close();
    }
  bigimg = window.open(page,"popup","width=670,height=665,toolbar=no");
  }

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-03T11:00:08.383

我遇到了 IE 8 的问题，即 window.open 无法正常工作，我只是将窗口名称替换为 null，我从[http://msdn.microsoft.com/en-us/library/ms536651.aspx得到了想法](http://msdn.microsoft.com/en-us/library/ms536651.aspx)

window.open("Sample.htm",null, "height=200,width=400,status=yes,toolbar=no,menubar=no,location=no");

# c++ - STL 映射是否在插入时初始化原始类型？

> ID：507971
> 
> 赞同：45
> 
> 时间：2009-02-03T17:00:02.860
> 
> 标签：c++, dictionary, stl, initialization, primitive-types

我有一个`std::map`这样的：

```
map<wstring,int> Scores; 
```

它存储玩家的姓名和分数。当有人得分时，我会简单地做：

```
Scores[wstrPlayerName]++; 
```

当地图中没有带有键的元素时，`wstrPlayerName`它将创建一个，但它是在增量之前初始化为零还是为空，还是未定义？

我应该在每次递增之前测试元素是否存在吗？

我只是想知道，因为我认为原始类型的东西在创建时总是未定义的。

如果我写类似：

```
int i;
i++; 
```

编译器警告我 i 未定义，当我运行程序时它通常不为零。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2009-02-03T17:11:36.970

运算符 [] 看起来像这样：

```
Value& map<Key, Value>::operator[](const Key& key); 
```

如果您使用尚未在地图中的**键调用它，它将默认构造一个新的****Value实例，将其放在您传入的****键**下的地图中，并返回对它的引用。在这种情况下，您有：

```
map<wstring,int> Scores;
Scores[wstrPlayerName]++; 
```

这里的值是**int**，并且 int 默认构造为 0，就好像您使用**int()**初始化它们一样。其他原始类型的初始化方式类似（*例如***double()**、**long()**、bool **()**等）。

最后，您的代码将一个新对 (wstrPlayerName, 0) 放入地图中，然后返回对 int 的引用，然后您将其递增。因此，如果您希望事情从 0 开始，则无需测试该元素是否存在。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-03T17:03:26.160

这将默认构造一个新的`value`. 对于整数，默认构造为 0，因此可以按预期工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-03T17:30:43.827

在增加它之前，您不应该测试该项目是否存在。正如其他人所说， [] 运算符完全符合您的需要。

但是，如果默认构造的值对您不起作用怎么办？在您的情况下，查找元素是否已存在的最佳方法是尝试插入它。的`insert`成员函数`std::map`返回 a `std::pair<iterator, bool>`。无论插入成功还是失败，该对的第一个元素都将指向所需的对象（您的新对象或已经存在的对象）。然后，您可以根据需要更改其值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-03T17:49:44.693

检查初始化规则。

请参阅第 4.9.5 节 C++ Prog Lang 或 C++ 标准书的初始化。取决于您的变量是本地的、静态的、用户定义的还是 const 默认初始化。

在您的情况下， int 称为 POD（普通旧数据类型）。任何自动（在堆/局部变量上创建）POD 变量都不会默认初始化。因此，对您来说，上面的“i”的值不会为零。

在堆中定义时，始终养成初始化 POD 的习惯。您甚至可以使用 int() 来初始化值。

# c# - WPF 中类似于 FF3 AwesomeBar 的行为

> ID：507975
> 
> 赞同：1
> 
> 时间：2009-02-03T17:00:46.900
> 
> 标签：c#, .net, wpf, combobox

我正在尝试在 WPF 中实现类似于 Firefox 3 AwesomeBar 的行为。我有一个 ComboBox 来使用 DataTemplate，它使下拉菜单看起来像 AwesomeBar 的下拉菜单，但我不确定如何获得正确的行为。

我想要发生的是让用户将他们的搜索输入到 ComboBox 的 TextBox 位中，然后逐渐缩小下拉列表中的结果。我想我可能可以让数据库查询部分工作（因为结果将来自数据库）但我想要得到的是用户开始输入时打开的下拉位（就像在 Firefox 中一样3) 然后自动选择列表中的第一个项目和列表中的其他项目，可以通过使用箭头键或单击它们来选择它们。

**更新：**

我现在找到了让 ComboBox 下拉的编程方式（使用 IsDropDownOpen = true），但我还有一些其他问题：

首先，当我输入某些内容时，它会下拉，但它不会选择与我正在输入的内容最接近的匹配项，其次，当我输入唯一选择一个项目的内容时，它会自动关闭并运行 SelectedItemChanged 方法。我希望它仅在我实际单击它或按 Enter 时关闭并运行代码（而不是仅使用向上或向下箭头进行选择）。任何想法如何让它做我想做的事？如果还不够清楚，我可以提供更多信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-03T19:24:20.417

您想要的大部分功能已经在 ComboBox 中。

> 有没有一种编程方式来告诉 ComboBox 列表下拉？

是的，您可以通过将[ComboBox.IsDropDownOpen](http://msdn.microsoft.com/en-us/library/system.windows.controls.combobox.isdropdownopen.aspx)属性设置为**true**来做到这一点。

> 有没有办法在不关闭列表并成为选定项目的情况下选择项目？

当您将[IsEditable](http://msdn.microsoft.com/en-us/library/system.windows.controls.combobox.iseditable.aspx)设置为**true**时，它​​将为您选择与输入文本匹配的第一个项目 - 当您下拉该项目时仍将被选中。此示例不会从更大的数据集执行过滤，但它应该可以帮助您入门：

```
<Grid xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid.Resources>
        <x:Array x:Key="data" Type="{x:Type sys:String}">
            <sys:String>Veni</sys:String>
            <sys:String>Vidi</sys:String>
            <sys:String>Vici</sys:String>
        </x:Array>
    </Grid.Resources>
    <ComboBox x:Name="myCombo" ItemsSource="{StaticResource data}" IsEditable="True" PreviewTextInput="myCombo_PreviewTextInput"/>
</Grid> 
```

在后面的代码中，我们打开 ComboBox。您的处理程序也可能在此处进行过滤：

```
private void myCombo_PreviewTextInput(object sender, TextCompositionEventArgs e)
{
    myCombo.IsDropDownOpen = true;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-09T17:39:51.837

使用 CollectionView 访问您的集合。

```
ListCollectionView _myCollectionView = new ListCollectionView(someCollection); 
```

将您的 ComboBox 绑定到此 CollectionView。这将提供一个过滤器机制。实现过滤方法（此代码中的 SearchText 将是您的 ComboBox 文本...我会将其存储在名为 SearchText 的 DP 中并从 ComboBox 更新它）：

```
private bool FilterMethod(string expression)
{

     if (expression != null && this.SearchText != null)
     {
          if (expression.ToUpper().Contains(this.SearchText.ToUpper()))
              return true;

          else
              return false;
     }

     return true;
} 
```

现在，当用户键入内容时，在 CollectionView 上使用此过滤方法：

```
_myCollectionView.Filter = new Predicate<string>(FilterMethod); 
```

# java - 如何使 Java3D 启动更快？

> ID：507987
> 
> 赞同：7
> 
> 时间：2009-02-03T17:03:49.560
> 
> 标签：java, optimization, java-3d

我的应用程序需要几秒钟来显示第一个带有 a 的窗口`Canvas3D`。我已经对其进行了分析，发现瓶颈在`SimpleUniverse.getPreferredConfiguration()`; 第一次调用需要三四秒，*必须*在渲染场景之前调用。

我正在使用 Direct3D 渲染器 ( `-Dj3d.rend=d3d`)，因为 OpenGL 渲染器在我的显卡上崩溃。我有一个运行单个显示器的集成 ATI 卡。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-03T17:04:02.727

速度变慢的原因`GraphicsDevice.getConfigurations()`是 使用的`SimpleUniverse.getPreferredConfiguration()`，在某些系统上非常慢。请参阅[这个 java.net 论坛主题](http://forums.java.net/jive/thread.jspa?threadID=56947&tstart=0)，它链接到[这个 Java3D 错误](https://java3d.dev.java.net/issues/show_bug.cgi?id=406)，而后者又链接到[这个 Sun 错误](http://forums.java.net/jive/thread.jspa?threadID=56947&tstart=0)：

> 问题是`::DescribePixelFormat`Win32 调用很慢 - 最多需要 60 毫秒才能完成。...
> 使用建议的解决方法（消除 [原文如此] 有问题的 win32 调用），时间显着改善（例如，0 毫秒）。

提到的解决方法是**传递`-Dsun.awt.nopixfmt=true`给 JVM**，这使得底层本机代码不调用`DescribePixelFormat`。

这显然不是一个完美的解决方案：

> ... 一些将 OpenGL 与 Java 结合使用的应用程序可能无法正常工作。

但由于我一直在使用 Direct3D，所以这不是问题。**这将启动时间缩短了 3.2 秒。**

# asp.net - 如何构建可配置的 Web 用户控件？

> ID：507989
> 
> 赞同：0
> 
> 时间：2009-02-03T17:04:03.930
> 
> 标签：asp.net, custom-controls, user-controls

所以这是一个项目大纲，我需要制作一个 Web 应用程序，其核心组件封装在 Web User Controls 中。原因是该公司将在明年初广泛使用 MOSS，我们希望稍后将这些组件用作 Web 部件。我认为这些网络用户控件在数据源、主题/CSS 方面需要灵活。我们可能有一个将数据绑定到这些控件的 WCF 服务，我应该认真考虑哪些事情？

如果需要，我愿意提供更多细节。

提前致谢 ！！

编辑：更多细节

**场景：**用户控件 A 是为使用 WCF 服务 A 而构建的。现在我需要确保在 WCF 服务 URI 更改时控件仍然可以工作，并且还需要处理 ServiceContract 中的潜在更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-03T17:21:51.553

更多细节会很有用。

您是否考虑过构建[WebPart](http://msdn.microsoft.com/en-us/library/e0s9t4ck.aspx)？这些可能更接近迁移到 SharePoint 所需的模型。WebPart 属性可以通过浏览器进行编辑。

如果您的应用程序的后端将成为 WCF 服务，那么这应该很容易迁移。根据您处理安全性的方式，您可能需要进行一些测试以查看身份验证在 SharePoint 环境中是否正常工作。SharePoint 中的组件可能使用不同的凭据运行。

研究如何在 SharePoint 中设置 Web 部件的样式，以及您的 SharePoint 环境加载了哪些 CSS，并利用您现在可以做的事情。SharePoint 中的样式相当一致。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T22:01:54.653

附加的场景信息可以提供更好的答案。实际上，您的问题实际上与您是使用 SharePoint WebParts 还是 ASP.NET 构建无关，而是关于如何以可维护的方式使用 WCF 服务。

*   考虑使用 WCF 遵循[WSDL 优先设计方法](http://blogs.msdn.com/dotnetinterop/archive/2008/09/05/using-the-wsdl-first-design-approach-with-wcf-services.aspx)。谷歌[搜索](http://www.google.com/#hl=en&q=wsdl+first+wcf)会产生很多信息。
*   将 URL 存储在应用程序中硬编码以外的其他位置，并按照其他发布者的建议通过属性设置这些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-03T17:15:32.207

我在可配置的用户控件中广泛使用了属性，并且效果很好。您可以在容器页面中设置控件的属性，并动态设置控件。

还需要注意的是，您需要将大部分控件代码（即 CodeBehind 文件中的 VB.Net/C# 代码）移动到 PreRender 事件。您可以在容器页面的 PageLoad 事件中设置控件的属性。

# javascript - 如何确定数组中已定义元素的数量？

> ID：507992
> 
> 赞同：3
> 
> 时间：2009-02-03T17:04:53.910
> 
> 标签：javascript, optimization

如果我有一个偶尔填充的 Javascript 数组，我如何确定数组中非空元素的数量？

例如：

```
var zipCodes = [];
zipCodes[10006] = 'New York, NY';
zipCodes[90210] = 'Los Angeles, CA'; 
```

zipCodes.length 在这里返回 90,211，我真的不想循环 90,209 来找出我有两个有效元素。使用 for-in 循环意味着处理任何可能在原型链中冒泡的东西，并试图弄清楚它是否是*这个*数组的一部分。

有没有什么办法，给定上面定义的数组，我可以提取“2”作为定义元素的数量？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-03T17:08:18.240

您需要一个带有键值对的对象（有点像关联数组/哈希表）而不是数组：

```
var zipCodes = {};
zipCodes[10006] = 'New York, NY';
zipCodes[90210] = 'Los Angeles, CA';

for(var zipCode in zipCodes) {
    if(zipCodes.hasOwnProperty(zipCode)) {//makes sure prototypes aren't taken into account

    }
} 
```

编辑：或者您可以将对象存储在这样的数组中：

```
var zipCodes = [];
zipCodes.push({10006:'New York, NY'});
zipCodes.push({90210: 'Los Angeles, CA'}); 
```

//zipCodes.length = 2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T17:29:49.820

您还可以（取决于大量当前未知数）填充第二个数组，该数组包含第一个数组中填充条目的索引（索引？）。

因此，您可以使用一种方法将整个数组放大一次，然后填充第二个数组：

```
var indexesNext = 0;
var indexes = new Array();
for(i = 0 ; i < zipCodes.length ; i++) 
     if(zipCodes[i] != null) indexes[indexesNext++] = i; 
```

或者，如果您希望它经常更改，您可以使用 zipCodes 数组上的 add 和 delete 访问器方法来更新索引数组。

或者您可以在数组上使用 Javascript sort() 方法，并遍历它，直到找到一个空单元格。您也可以使用它来优化以前的技术（YMMV 对这个内置方法的效率，但 FFX 3.1 和 Chrome 中的新 Javascript 引擎肯定会做得很好，我敢肯定。）*********