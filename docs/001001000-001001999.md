# StackOverflow 问答 1001000-1001999

# java - 与 lucene 索引一起使用的最佳跨语言分析器

> ID：1001003
> 
> 赞同：7
> 
> 时间：2009-06-16T11:50:08.040
> 
> 标签：java, lucene

我正在寻找有关将哪个分析器与包含多种语言文档的索引一起使用的反馈。目前我正在使用 simpleanalyzer，因为它似乎可以处理最广泛的语言。大多数要编入索引的文档都是英文的，但偶尔也会有双字节语言编入索引。

还有其他建议还是我应该坚持使用 simpleanalyzer。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T16:33:59.213

根据您的描述，我认为您有多种语言的文档，但每个文档只有一种语言的文本。

对于这种情况，您可以使用 Nutch 的语言识别来获取文档的语言。然后使用相应的语言分析器进行索引。要获得正确的搜索结果，您需要将语言识别应用于搜索查询并使用该分析器。

这里的好处是您将能够使用特定语言的词干分析器和停用词，从而提高搜索质量。索引时的额外开销应该是可以接受的。但是，语言识别无法识别正确语言的搜索查询可能会受到影响。几年前我用过，结果比预期的要好。

对于 CJK，您可以应用类似的技术，但工具可能会有所不同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T12:26:10.120

我已经将 StandardAnalyzer 与非英语单词一起使用，它工作正常。它甚至处理重音字符。如果语言是 CJK（中文、日文、韩文）、俄文或德文，可能会有问题，但我怀疑大部分问题都与词干有关。如果您没有启用词干提取，它可能就足够了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T11:55:50.650

SimpleAnalyzer 真的很简单，它所做的只是小写的术语。我原以为即使使用非英语语言数据，StandardAnalyzer 也会比 SimpleAnalyzer 提供更好的结果。除了默认的英语语言之外，您还可以通过提供自定义停用词列表来稍微改进它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-05-03T10:07:25.633

纯属轶事证据，但我们`StandardAnalyzer`为我们的系统使用（定制的，但不以任何相关方式）版本。我们的文档可能不仅彼此使用不同的语言，而且文档可能包含不同语言的块（例如，想象一篇用日语写的文章带有英语评论），因此语言嗅探很困难。

我们的大部分文件是英文的，但也有很多是中文和日文，还有少量是法文、西班牙文、葡萄牙文和韩文。

最终结果？我们使用`StandardAnalyzer`，并且很少有人使用非罗马语言的系统抱怨我们的搜索工作方式。顺便说一句，我们的系统在某种程度上对用户“强制执行”，所以并不是说人们不抱怨而是搬到别处；如果他们不开心，我们一般都知道。

因此，基于我没有被用户投诉淹没的事实（非常偶然的投诉，主要是关于中文的，但没有什么严重的，而且很容易解释）对于许多情况来说似乎“足够好”。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-08-25T00:11:23.293

正确答案取决于您的主要语言（如果有）。

为了获得最佳的跨语言 IR 性能，我会使用 4/5 克分析器，它已证明在许多语言上都表现出色。它甚至可能比 SimpleAnalyzer for English 更有效。例如，参见[http://www.eecs.qmul.ac.uk/~christof/html/publications/inrt142.pdf 。](http://www.eecs.qmul.ac.uk/~christof/html/publications/inrt142.pdf)

[我已经研究过这个](http://www.code972.com/blog/2010/06/finding-hebrew-lemmas/)，但从另一个角度。似乎没有一个包罗万象的分析器——每​​种语言都需要自己的方法才能获得最佳结果。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-05-03T06:22:50.520

首先，你应该发现你的语言是什么？例如，我的文件是英文、日文或波斯文的。您可以通过处理 UTF-8 字符找到您的文档语言。

然后，当你发现你的文档是哪种语言的时候，你可以用特定的分析器来分析它。

# javascript - Javascript 文本框事件

> ID：1001009
> 
> 赞同：7
> 
> 时间：2009-06-16T11:51:39.630
> 
> 标签：javascript, textbox

我面临输入文本类型（即文本框）的问题。

`onkeyup`我在文本框上编写了事件使用的函数。该行如下所示：

```
<input type='TEXT' value='abc' onkeyup='changeSomething( this );'> 
```

但是现在我面临的问题是，当用户从先前输入的值中选择值时，当用户从下拉列表中选择任何先前输入的值时，我没有收到任何事件（*编辑：我相信他在这里指的是浏览器自动完成*）。

有人对此有解决方案吗？:)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-16T11:53:28.347

在这种情况下使用`onchange`代替`onkeyup`

见：[http ://www.w3schools.com/jsref/event_onchange.asp](http://www.w3schools.com/jsref/event_onchange.asp)

例如

```
<input type='text' value='abc' onchange='changeSomething(this);' /> 
```

解决这个问题

**编辑** 两件事：
1）可以使用箭头键和输入/选项卡以及使用鼠标选择自动完成值。箭头键/enter.tab 触发 onkeyup 事件...但是，单击自动完成框不会触发 onclick 事件。
2) 如果内容发生更改，则一旦失去焦点就会触发 onchange 事件。选择自动完成值时不会丢失焦点。

从本质上讲，似乎没有任何方法可以合理地保证事件将以您想要的方式进行处理。

首先，你真的需要听每一次击键吗？其次，关闭自动完成功能会更好吗？（例如`<input type='text' value='abc' autocomplete='off' onkeyup='changeSomething(this);' />`）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T12:47:49.860

这是一个定期轮询元素以获取任何更改的解决方案

```
<script type="text/javascript">

var changeWatcher = {
    timeout: null,
    currentValue: '',
    watchForChange: function( el ) {
        if( el.value != this.currentValue ) {
            this.changed( el );
        }
        this.timeout = setTimeout( function() {
             changeWatcher.watchForChange(el)
        }, 200 );
    },
    cancelWatchForChange: function() {
        clearTimeout( this.timeout );
        this.timeout = null;
    },
    changed: function( el ) {
        this.currentValue = el.value;
        // do something with the element and/or it's value
        //console.log( el.value );
    }
}

</script>
<input type='text' value='abc' onfocus='changeWatcher.watchForChange(this)' onblur='changeWatcher.cancelWatchForChange()' onchange='changeWatcher.changed(this)' /> 
```

# virtual-directory - 什么是虚拟目录？它有什么用？

> ID：1001030
> 
> 赞同：13
> 
> 时间：2009-06-16T11:57:22.113
> 
> 标签：virtual-directory

请有人通过示例向我解释什么是虚拟目录以及我们为什么需要它？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-06-16T12:01:43.133

虚拟目录是服务器硬盘驱动器上不位于主目录中的物理目录的友好名称或别名。
因为别名通常比物理目录的路径短，所以更方便用户键入。

取自[这里](http://windowsitpro.com/article/articleid/15605/iis-101-using-virtual-directories.html)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-06-16T12:03:33.990

本质上，在 IIS 中，它就像是您计算机上另一个目录的快捷方式，而它看起来像是当前目录的子目录。

IE

www.example.com/bob/phil

bob 可能是根目录的子目录，而 phil 是计算机其他地方的目录，不一定在 bob

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-23T04:34:00.167

在 IIS 中创建的目录中的虚拟目录用于承载本地应用程序或转到服务器上的特定文件夹物理或虚拟目录。

例如：在开发团队中，如果您希望接收您的应用程序，您必须创建一个虚拟目录并指定物理路径。

您可以创建虚拟目录，单击 IIS 并从上下文菜单中选择。

[3100 转储 PDF](http://www.dumpspdf.com/3100.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-31T06:14:51.340

使用虚拟目录名称而不是物理文件夹名称访问 Web 应用程序。例如，如果您的机器中有一个名为“Shopcart”的 Web 应用程序，您将拥有该 Web 应用程序的虚拟目录。您将使用 URL 访问您的 Web 应用程序。如果您的 virtaul 目录名称是“Test”，那么您的 Web 应用程序 url 将是“ [http://localhost/Test](http://localhost/Test) ”。

# silverlight - Silverlight 小部件跨平台？

> ID：1001031
> 
> 赞同：3
> 
> 时间：2009-06-16T11:57:35.297
> 
> 标签：silverlight, desktop, widget

我可以使用 Silverlight 构建跨平台桌面小部件吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T12:03:44.223

**Silverlight 与 WPF**

首先，WPF 并不完全是 Silverlight。它们本质上需要不同的运行时间。Silverlight Runtime 是 .NET 的一个子集，需要由客户端安装，才能通过浏览器查看您的 SL 应用程序。目前 SL 运行时可用于 Windows 和 Mac。对于 Linux，Moonlight 还没有完全成熟，并且还在不断发展。

另一方面，WPF 纯粹是在 .NET 运行时之上，并且仅适用于 Windows。

您可以使用 XAML 在 Silverlight 和 WPF 中开发用户体验，并且只要您坚持使用 Silverlight 子集，您也可以在 WPF 中编译您的 XAML。

**桌面小部件**

现在，您对构建跨平台“桌面”小部件的想法 - 您想在桌面窗口中托管 Silverlight 应用程序吗？Silverlight 3.0 支持在浏览器之外托管 silverlight 控件。

否则，请参阅我关于使用浏览器外壳托管 Silverlight 的博客文章。[http://amazedsaint.blogspot.com/2008/12/thinking-outside-silverlight-sandbox.html](http://amazedsaint.blogspot.com/2008/12/thinking-outside-silverlight-sandbox.html)。

这篇文章围绕

1.  使用 Web 浏览器控件在 Winforms/Webkit 桌面应用程序中使用 Silverlight 托管 HTML 页面，并使用 HTML DOM 来回通信
2.  在 Host 应用程序中嵌入轻量级 Web 服务器，并处理执行此类操作的请求

但请记住 - 它不是 WPF。希望这可以澄清。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T12:04:23.300

在 Silverlight 2.0 中，您不会有这样的运气。

然而，在[Silverlight 3.0](http://silverlight.net/getstarted/silverlight3/default.aspx)（目前处于测试阶段）中，添加了对**Out of Browser Capabilities 的**支持，这意味着您可以从桌面下载和运行 Silverlight 应用程序。

Silverlight 平台通常是跨平台的，因此 Silverlight 3.0 中的外部（桌面）应用程序将完全相同。

引自*Silverlight 3 Beta 中的新增功能？*发布页面的部分：

> *   浏览器功能不足。Silverlight 3 中全新的浏览器外体验使用户能够将他们最喜欢的 Silverlight 应用程序直接放置到他们的 PC 和 Mac 上，并在桌面和开始菜单上提供链接，而无需下载额外的运行时或浏览器插件。此外，无论计算机是否连接到 Internet，新体验都使 Silverlight 应用程序能够正常工作——这是对传统 Web 体验的根本改进。特点包括：
>     
>     
>     *   浏览器之外的生活。Silverlight 应用程序现在可以作为轻量级 Web 伴侣安装到桌面并从桌面运行。因此，用户可以随身携带他们喜欢的 Web 应用程序，无论他们是否连接到 Internet。
>     *   桌面快捷方式和开始菜单支持。Silverlight 应用程序可以通过开始菜单和应用程序文件夹中的链接存储在任何 PC 或 Mac 计算机的桌面上，因此可以一键访问。
>     *   安全又可靠。利用 .NET Framework 的安全功能，Silverlight 应用程序在具有持久隔离存储的安全沙箱中运行。这些应用程序具有与传统 Web 应用程序大部分相同的安全限制，因此可以在没有安全警告或提示的情况下进行信任，从而最大限度地减少用户中断。
>     *   顺利安装。由于 Silverlight 应用程序存储在本地缓存中，并且不需要额外的权限即可运行，因此安装过程快速高效。
>     *   自动更新。启动时，Silverlight 应用程序可以检查服务器上的新版本，并在找到时自动更新。
>     *   互联网连接检测。Silverlight 应用程序现在可以检测它们是否具有 Internet 连接，并且可以智能地做出反应，包括缓存用户的数据，直到他们的连接恢复。

# qt4 - 如何在 Qt4 或 GTK 等 GUI 框架中集成 Boost.Asio 主循环

> ID：1001032
> 
> 赞同：29
> 
> 时间：2009-06-16T11:57:47.603
> 
> 标签：qt4, gtk, boost-asio, event-loop

有没有办法将 Boost.Asio 与 Qt4（首选）或 GTK 主循环集成？GTK 提供 poll(2) 之类的 API，所以技术上应该是可行的。Qt 提供了自己的网络层，但我更喜欢使用为 Boost.Asio 编写的现有代码。我想在**不**使用额外线程的情况下集成它们。

有没有参考如何为 Qt4（首选）或 GTKmm 执行此操作？

谢谢。

**编辑**

我想澄清几件事以使答案更容易。Qt 和 GTKmm 都提供“选择喜欢”功能：

*   [http://qt-project.org/doc/qt-5.0/qtcore/qsocketnotifier.html](http://qt-project.org/doc/qt-5.0/qtcore/qsocketnotifier.html)
*   [http://www.gtkmm.org/docs/glibmm-2.4/docs/reference/html/group__MainLoop.html](http://www.gtkmm.org/docs/glibmm-2.4/docs/reference/html/group__MainLoop.html)

所以，问题是，如何将现有的“选择器/轮询器”作为反应器集成到 Boost.Asio `io_service`。今天，Boost.Asio 可以使用 select、kqueue、epoll、/dev/poll 和 iocp 作为 reactor/proactor 服务。我想将它集成到 GUI 框架的主循环中。

欢迎任何建议和解决方案（更好）。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-12-21T18:58:19.100

**简单：** 构建一个调用`io_service::poll_one()`属于 gui 的 QT 插槽。将该插槽连接到 QT 的`tick`信号。

**深入浅出：** 幸运的是，Boost.Asio 设计得非常好。关于如何为底层异步内部提供执行线程有很多选择。人们已经提到 using `io_service::run()`，这是一个有很多缺点的阻塞调用。

您只能从单个线程访问 gui 小部件。如果外部线程想要改变任何小部件，通常需要将事件发布到 gui。这与 Asio 的工作方式非常相似。

天真的方法是只使用一个线程（或计时器）来运行`io_service::run()`，并让 Asio 完成处理程序发布一个 gui 信号。这*将*起作用。

相反，您可以保证仅在调用者的执行线程中调用完成处理程序`io_service`。没有 gui 线程调用`io_service::run()`，因为它被阻塞并且可能挂起 gui。而是使用`io_service::poll()`or `io_service::poll_one()`。这将导致从 gui 线程调用任何挂起的 Asio 完成处理程序。由于处理程序在 gui 线程中运行，因此它们可以自由修改小部件。

现在您需要确保`io_service`有机会定期运行。我建议重复`poll_one()`几次 gui 信号调用。我相信 QT 有一个滴答信号可以解决问题。您当然可以滚动自己的 QT 信号以获得更多控制。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-12-14T22:26:59.950

这是一个相当老的问题，但对于那些现在正在阅读它的人，我想分享[我的代码](https://github.com/peper0/qtasio)，它是用于 boost::asio 的 QAbstractEventDispatcher 的实现。

您只需要在创建 QApplication 之前添加以下行（通常它在 main() 中）。

```
QApplication::setEventDispatcher(new QAsioEventDispatcher(my_io_service)); 
```

这将导致 io_service 与 qt 应用程序一起在一个线程中运行，而不会产生额外的延迟和性能下降（例如在“不时”调用 io_service::poll() 的解决方案中）。

不幸的是，我的解决方案仅适用于 posix 系统，因为它使用 asio::posix::stream_descriptor 。Windows 支持可能需要完全不同或非常相似的方法 - 我真的不知道。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-19T11:00:13.917

如果我正确理解了您的问题，那么您已经为 Boost.Asio 编写了代码。您想在 GUI 应用程序中使用该代码。

您的问题中不清楚的是，如果您只是在寻找一种同时具有 gui 事件循环和 asynio 的解决方案，您是否想通过 asynio 包装 Qt/Gtk 网络层以使您的代码正常工作。

我将假设第二种情况。

Qt 和 Gtk 都有将外部事件集成到其事件循环中的方法。参见例如[qtgtk](http://developer.kde.org/documentation/tutorials/qtgtk/main.html)，其中 Qt 事件循环被插入到 Gtk 中。

在 Qt 的特定情况下，如果要为 Qt 生成事件，可以使用以下类：[QAbstractEventDispatcher](http://qt-project.org/doc/qt-5/qabstracteventdispatcher.html)。

在快速浏览了 boost asio 之后，我认为您需要执行以下操作：

*   有一个持续时间为零的循环 QTimer，它一直调用 io_service::run() 。这样，boost::asio 将在您的异步操作完成后立即调用您的完成处理程序。
*   在您的完成处理程序中，有两个选项：
    *   如果您的完成操作很长，与 GUI 分开，请做好您的工作并确保定期调用 qApp.processEvents() 以保持 GUI 响应
    *   如果您只想与 gui 进行交流：
        1.  定义自定义[QEvent](http://qt-project.org/doc/qt-5/qevent.html)类型
        2.  [订阅此活动](http://qt-project.org/doc/qt-5/qwidget.html#event)
        3.  [使用QCoreApplication::postEvent()](http://qt-project.org/doc/qt-5/qcoreapplication.html#postEvent)将您的事件发布到 Qt 事件循环。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-23T04:18:26.013

真正集成主循环*是*可能的。这只是一个很大的痛苦（我还没有真正尝试过）。

在单独的线程上运行 io_service::run() 可能是要走的路。

# java - Spring + BlazeDS 集成入门。你好世界想要

> ID：1001036
> 
> 赞同：2
> 
> 时间：2009-06-16T11:58:19.007
> 
> 标签：java, spring, blazeds

我正在尝试获取一个小的 Spring + BlazeDS 集成“Hello World”-ish 类型的示例/教程，以查看使用[http://www.springsource 提供的 Spring 和 BlazeDS 集成所需的基本、最低配置。组织/弹簧弹性](http://www.springsource.org/spring-flex)

我得到的下载附带了所有这些试驾样本，但我无法对这里发生的事情做出怪诞的正面或反面。我想要的只是一个简单的 Hello World 应用程序，可以在 Eclipse 中建立一个简单的项目，这样我就可以看到应该去哪里......

我只需要一个 Bean，一个 Service，比如 HelloWorld.sayHi(String name);

任何人都可以提供有关此主题的任何有价值的链接/建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T15:33:02.863

查看我合着的 Flex 和 Spring Refcard：

[http://www.jamesward.com/blog/2009/04/06/download-the-flex-and-spring-integration-refcard/](http://www.jamesward.com/blog/2009/04/06/download-the-flex-and-spring-integration-refcard/)

让我知道这是否有帮助。

# c# - 扩展gridview的行

> ID：1001037
> 
> 赞同：0
> 
> 时间：2009-06-16T11:58:47.523
> 
> 标签：c#, asp.net, gridview

gridview 的列之一是“内容”列，它可以有几行文本（它可以是文字、文本框或标签）。

在“默认”模式下，我希望它只显示第一行和一个链接按钮：“（更多）”或“（阅读）”。

单击此链接应展开列并显示完整内容。

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T13:38:35.873

这将对您有所帮助。

[http://www.asp.net/community/control-gallery/Item.aspx?i=1465](http://www.asp.net/community/control-gallery/Item.aspx?i=1465)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T12:02:13.663

选择内容文本的前 10 个字符并将其用作链接文本是更好的方法。这将减少从数据库中检索到的数据大小，如下所示：

```
SELECT ContentId, SUBSTRING(Content, 0, 10) AS Content
FROM ContentTable; 
```

然后，您可以为此列使用包含标签和链接的模板列。Lbel 为描述文本，链接为详细信息。

```
<asp:TemplateColumn>

   <ItemTemplate>
      <asp:Label
           Text='<%# Eval("Content") %>'
           runat="server"/>
      <a href='<%# Eval("ContentId", "contentdetails.aspx?id={0}") %>'>More</a>
   </ItemTemplate>

</asp:TemplateColumn> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T18:08:24.270

尝试这个。[http://mosesofegypt.net/post/BuildingjQueryAndASPNetAJAXEnabledControlsjQueryCollapsiblePanelExtenderPart2.aspx](http://mosesofegypt.net/post/BuildingjQueryAndASPNetAJAXEnabledControlsjQueryCollapsiblePanelExtenderPart2.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-21T01:03:43.943

使用 CSS 的力量！

把它放在你的 gridview 行中。它自然会将行推出到您的内容的高度，或所需的行数。

```
<div class="toggle">
  <div class="toggle-header">
    Toggle!
  </div>
  <div class="toggle-height">
    <div class="toggle-transform">
      <p>2nd line of text</p>
      <p>3rd line</p>
      <p>4th line</p>
      <p>etc</p>
    </div>
  </div>
</div> 
```

并使用这个 CSS...

```
body {
  font-family: sans-serif;
}

.toggle {
  position: relative;
  border: 2px solid #333;
  border-radius: 3px;
  margin: 5px;
  width: 200px;
}

.toggle-header {
  margin: 0;
  padding: 10px;
  background-color: #333;
  color: white;
  text-align: center;
  cursor: pointer;
}

.toggle-height {
  background-color: tomato;
  overflow: hidden;
  transition: max-height .6s ease;
  max-height: 0;
}

.toggle:hover .toggle-height {
  max-height: 1000px;
}

.toggle-transform {
  padding: 5px;
  color: white;
  transition: transform .4s ease;
  transform: translateY(-100%);
}

.toggle:hover .toggle-transform {
  transform: translateY(0);
} 
```

您可能想用“（更多）”行的文本框来伪装“切换”以展开其余部分。

让我们知道它是否有效。

# iphone - 更改 iPhone Grouped TableView 的宽度

> ID：1001038
> 
> 赞同：1
> 
> 时间：2009-06-16T11:58:49.333
> 
> 标签：iphone

我想知道是否可以调整分组表视图的宽度。我想要一张更宽的桌子。这可能吗？如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-11-25T03:10:12.477

对不起，迈克直言不讳，但你错了。表格的宽度尚未设置为最大值。creator7 一针见血，您可以在 Interface Builder 中调整表的大小，包括分组表。如果您需要它比屏幕大（无法想象您为什么想要这个...），您可能需要以编程方式进一步调整大小。如果表格已经添加到 IB 中，那么最好在 viewWillAppear:(BOOL)animated 方法中进行编程调整大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T13:37:29.167

您必须使用界面生成器手动增加表格的宽度才能滚动到其宽度添加表格视图作为滚动视图的子视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T12:47:20.767

桌子上的宽度已设置为最大值。

# ruby - 在独立的 ruby 应用程序中使用哪个 ruby ORM 框架？

> ID：1001040
> 
> 赞同：9
> 
> 时间：2009-06-16T11:59:59.567
> 
> 标签：ruby, database, postgresql, orm

我想使用带有外键的 postgresql 来定义数据中的关系，以便其他平台/应用程序也能够轻松地使用相同的数据库。拥有某种 ruby​​ DSL 来定义具有迁移支持的数据库模式也会很棒。你会为我推荐哪个框架？

是否有某种框架仅用于处理与 ORM 分开的数据库模式更改、迁移和版本？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T12:09:15.897

查看[DataMapper](http://datamapper.org/docs/)。我[最近将它](http://alicebobandmallory.com/articles/2009/06/11/an-average-application-in-the-clouds)与 Sinatra 一起使用，并将应用程序部署到 Heroku。我必须编写的唯一 SQL 是 CREATE DATABASE。DataMapper 通过 .auto_migrate 为我提供的所有其他内容！和.auto_upgrade！功能。

外键支持在 dm-constraints 插件中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-16T12:32:32.433

在 ActiveRecord 和 DataMapper 之间，我选择了后者。两者都使用 Active Record 模式，因此您实际上可以在没有花哨的域逻辑的对象中恢复数据库表，但 DataMapper 更易于使用，并且是线程安全的。还有[Sequel](http://sequel.rubyforge.org/ "续集")，但我不熟悉。

如果您需要一个框架来处理迁移，我建议您使用[merb](http://merbivore.org "默布")。虽然它是一个从 1.1 开始的完整 Web 框架，但它可以处理前面提到的三个 ORM 框架的迁移（包括单独和自动迁移）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-09-10T20:22:24.017

[M4DBI](https://github.com/Pistos/m4dbi)也可能很有趣。一个低级 ORM，它利用 DBI 允许您根据需要编写原始 SQL。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T12:07:30.783

有充分的理由不使用[ActiveRecord](http://ar.rubyonrails.org/)吗？这是Ruby的一种标准......

# sharepoint - 如何在 Sharepoint Services 3 上找到错误详细信息？

> ID：1001042
> 
> 赞同：2
> 
> 时间：2009-06-16T12:00:31.420
> 
> 标签：sharepoint

我记得有一个日志文件可以检查 Sharepoint Services 3.0。我不记得我在哪里可以找到这个。我问这个的原因是我在实现新模板时出错，它可以在一台机器上运行，但不能在另一台机器上运行。页面上的错误非常笼统：“您选择的模板无效或找不到”。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T12:38:48.910

SharePoint 日志文件通常位于“ [12 Hive](http://msmvps.com/blogs/laflour/archive/2009/04/14/sharepoint-tip-31-do-you-know-the-12-hive-folder-structure-details.aspx) ”的“Logs”文件夹中，默认情况下位于`C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\Logs`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T12:27:07.797

完全显示错误更容易。您可以通过修改 web.config 来启用此功能。

在 web.config 中找到 SafeMode 条目并将 CallStack="false" 更改为 CallStack="true"。然后找到 customErrors 条目并将模式设置为 mode="Off"。现在错误将显示为完整的 ASP.NET 错误屏幕

# castle-windsor - 温莎城堡：重新注册命名组件保持以前的生活方式

> ID：1001063
> 
> 赞同：2
> 
> 时间：2009-06-16T12:05:44.470
> 
> 标签：castle-windsor

下面的单元测试失败了，我正在寻找这样做的正当理由。

```
interface IFoo { }
class Foo : IFoo { }
class Foo2 : IFoo { }

[TestMethod]
public void LifestyleTest4()
{
    WindsorContainer container = new WindsorContainer();

    container.Register(Component.For<IFoo>().ImplementedBy<Foo>().Named("foo").LifeStyle.Singleton);

    IHandler h = container.Kernel.GetHandler("foo");
    Assert.IsTrue(h.ComponentModel.LifestyleType == LifestyleType.Singleton);

    bool removed = container.Kernel.RemoveComponent("foo");
    Assert.IsTrue(removed);

    container.Register(Component.For<IFoo>().ImplementedBy<Foo2>().Named("foo").LifeStyle.Transient);

    h = container.Kernel.GetHandler("foo");
    //Assert will fail as LifestyleType == Singleton
    Assert.IsTrue(h.ComponentModel.LifestyleType == LifestyleType.Transient, "Expected Transient Lifestyle");
} 
```

即使该组件已从容器中删除，但对 LifeStyle 的引用似乎是按名称维护的。

我正在使用 2.0 版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-17T01:12:02.493

Krzysztof 是对的，这看起来像一个错误。

原因是包含生活方式的组件配置**没有**被 RemoveComponent 移除，所以将始终使用第一个生活方式配置。

解决方法：在调用 RemoveComponent() 后添加此行：

```
container.Kernel.ConfigurationStore.GetComponentConfiguration("foo").Attributes.Remove("lifestyle"); 
```

请将其报告给问题跟踪器（包括您的测试用例）并返回此处，这可以作为修复错误的起点。

# outlook - 使用 Outlook 或 Thunderbird 修改 LDAP 服务器中的数据

> ID：1001065
> 
> 赞同：2
> 
> 时间：2009-06-16T12:06:16.557
> 
> 标签：outlook, ldap, thunderbird

Outlook 和 Thunderbird 都能够在 LDAP 服务器中找到联系人，但它们都不能修改联系人数据。是否有插件或其他任何东西允许这样的事情？

问候，塞德里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T12:25:46.083

我一个都不知道。但是这个人似乎已经用 VBScript 做到了，通过进一步的工作，你应该能够很好地集成到 Outlook 中

[使用 VBScript 添加/修改/删除 Exchange 联系人](http://phongdam.supersized.org/archives/2-AddModifyDelete-Exchange-Contact-with-VBScript.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-12-02T09:50:15.830

是的，你不能，即使是现在 - 2011 年末（TB 不支持它，Outlook 2007 也不支持）。无论如何，一些邮件客户端允许这样做，例如 Evolution。

我没有测试过 Outlook 2010，但我觉得这是一样的。

检查：是否可以修改 ActiveDirectory 目录。AD 是 LDAP，尽管架构是特定于 microsoft 的。

# c++ - STL 字符串比较函子

> ID：1001067
> 
> 赞同：0
> 
> 时间：2009-06-16T12:06:40.630
> 
> 标签：c++, string, stl, functor

我有以下仿函数：

```
class ComparatorClass {
  public:
    bool operator () (SimulatedDiskFile * file_1, SimulatedDiskFile * file_2) {
      string file_1_name = file_1->getFileName();
      string file_2_name = file_2->getFileName();

      cout << file_1_name << " and " << file_2_name << ": ";

      if (file_1_name < file_2_name) {
        cout << "true" << endl;
        return true;
      }
      else {
        cout << "false" << endl;
        return false;
      }
    }
}; 
```

它应该是一个严格的弱排序，并且它这么长（可能只有一行）用于调试目的。

我使用这个函子作为 stl::set 的比较函子。问题是，它只插入第一个元素。通过将控制台输出添加到比较器函数中，我了解到它实际上**每次都**在将文件名与自身进行比较。

其他相关线路是：

```
typedef set<SimulatedDiskFile *, ComparatorClass> FileSet; 
```

和

```
// (FileSet files_;) <- SimulatedDisk private class member
void SimulatedDisk::addFile(SimulatedDiskFile * file) {
  files_.insert(file);
  positions_calculated_ = false;
} 
```

**编辑：**调用 .addFile() 的代码是：

```
current_request = all_requests.begin();
while (current_request != all_requests.end()) {
  SimulatedDiskFile temp_file(current_request->getFileName(), current_request->getResponseSize());
  disk.addFile(&temp_file);
  current_request++;
} 
```

其中 all_requests 是一个列表，而类 Request 是这样的：

```
class Request {
  private:
    string file_name_;
    int response_code_;
    int response_size_;

  public:
    void setFileName(string file_name);
    string getFileName();
    void setResponseCode(int response_code);
    int getResponseCode();
    void setResponseSize(int response_size);
    int getResponseSize();
}; 
```

我希望我能就发生的事情提供我的假设，但我实际上不知道。在此先感谢您的任何指点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T12:18:39.433

从功能上讲，您发布的代码没有任何问题。这是一个完整的测试程序 - 我只是填写了空白，根本没有更改您的代码。

```
#include <iostream>
#include <string>
#include <set>

using namespace std;

class SimulatedDiskFile
{
public:
    string getFileName() { return name; }

    SimulatedDiskFile(const string &n)
        : name(n) { }

    string name;
};

class ComparatorClass {
  public:
    bool operator () (SimulatedDiskFile * file_1, SimulatedDiskFile * file_2) {
      string file_1_name = file_1->getFileName();
      string file_2_name = file_2->getFileName();

      cout << file_1_name << " and " << file_2_name << ": ";

      if (file_1_name < file_2_name) {
        cout << "true" << endl;
        return true;
      }
      else {
        cout << "false" << endl;
        return false;
      }
    }
};

typedef set<SimulatedDiskFile *, ComparatorClass> FileSet;

int main()
{
    FileSet files;

    files.insert(new SimulatedDiskFile("a"));
    files.insert(new SimulatedDiskFile("z"));
    files.insert(new SimulatedDiskFile("m"));

    FileSet::iterator f;
    for (f = files.begin(); f != files.end(); f++)
        cout << (*f)->name << std::endl;

    return 0;
} 
```

我得到这个输出：

```
z and a: false
a and z: true
z and a: false
m and a: false
m and z: true
z and m: false
a and m: true
m and a: false
a
m
z 
```

请注意，该集合最终存储了所有三个内容，并且您的比较日志显示了合理的行为。

**编辑：**

您的错误在这些行中：

```
SimulatedDiskFile temp_file(current_request->getFileName(), current_request->getResponseSize());

disk.addFile(&temp_file); 
```

您正在获取本地对象的地址。每次在循环中，该对象被销毁，下一个对象被分配到完全相同的空间中。所以只有最终对象仍然存在于循环的末尾，并且您已经添加了多个指向同一个对象的指针。在循环之外，所有的赌注都被取消了，因为现在不存在任何对象。

要么用 new 分配每个 SimulatedDiskFile （就像在我的测试中一样，但是你必须弄清楚何时删除它们），或者根本不使用指针（如果它符合你的问题的约束，那就容易多了）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T12:24:17.643

这就是问题所在：

```
SimulatedDiskFile temp_file(current_request->getFileName(),
                                   current_request->getResponseSize());
disk.addFile(&temp_file); 
```

您正在添加一个指向立即销毁的变量的指针。您需要动态创建 SDF 对象。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T12:25:51.137

```
urrent_request = all_requests.begin();
while (current_request != all_requests.end()) {
  SimulatedDiskFile temp_file(...blah..blah..); ====> pointer to local variable is inserted
  disk.addFile(&temp_file);
  current_request++; 
```

}

temp_file 将在 while 循环中的下一次迭代时超出范围。您需要更改插入代码。在堆上创建 SimulatedDiskFile 对象，否则如果对象较小，则按值存储在集合中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T12:25:51.853

同意@Earwicker。一切看起来都不错。你看过 all_requests 里面了吗？也许那里的所有文件名都相同，其他一切都正常吗？（只是在这里大声思考）

# python - 使用 WSGI 创建动态图像，不涉及文件

> ID：1001068
> 
> 赞同：3
> 
> 时间：2009-06-16T12:06:56.073
> 
> 标签：python, image-processing, wsgi

我想将动态创建的图像发送给我的用户，例如图表、图形等。这些图像是“丢弃”图像，它们只会发送给一个用户然后被销毁，因此“不涉及文件”。

我想直接将图像发送给用户，而不是先将其保存在文件系统上。使用 PHP，这可以通过将 HTML 文件中的图像链接到 PHP 脚本来实现，例如：

编辑：所以吞下了我的图像标签：

```
<img src="someScript.php?param1=xyz"> 
```

然后脚本将正确的标头（filetype=>jpeg 等）发送到浏览器，并直接将图像写回客户端，而不是将其临时保存到文件系统中。

我怎么能用 WSGI 应用程序做这样的事情。目前我正在使用 Python 的内部 SimpleWSGI 服务器。我知道该服务器主要用于演示目的而不是实际使用，因为它缺乏多线程功能，所以请不要向我指出这一点，我知道，现在它满足我的要求： )

是否真的像将 URL 放入图像标签并使用 WSGI 处理请求一样简单，还是有更好的做法？

有没有人有这方面的经验，可以给我一些指示（请不要32位）

谢谢，

汤姆

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T12:14:19.507

它与 WSGI 或 php 或任何其他特定的 Web 技术无关。考虑

```
<img src="someScript.php?param1=xyz"> 
```

通常对于 url`someScript.php?param1=xyz`服务器应该返回图像类型的数据并且它会工作

考虑这个例子：

```
from wsgiref.simple_server import make_server

def serveImage(environ, start_response):
    status = '200 OK'
    headers = [('Content-type', 'image/png')]
    start_response(status, headers)

    return open("about.png", "rb").read()

httpd = make_server('', 8000, serveImage)
httpd.serve_forever() 
```

这里任何指向 serveImage 的 url 都将返回一个有效的图像，您可以在任何`img`标签或任何其他可以使用图像的标签位置使用它，例如 css 或背景图像

可以使用许多第三方库（例如 PIL 等）即时生成图像数据，例如查看使用 python 图像库 [http://lost-theory.org/python/dynamicimg.html动态生成图像的示例](http://lost-theory.org/python/dynamicimg.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T12:12:47.747

是的。就像将 url 放在页面中一样简单。

```
<img src="url_to_my_application"> 
```

并且您的应用程序只需使用正确的 mimetype 返回它，就像在 PHP 或其他任何东西上一样。最简单的例子：

```
def application(environ, start_response):
    data = open('test.jpg', 'rb').read() # simulate entire image on memory
    start_response('200 OK', [('content-type': 'image/jpeg'), 
                              ('content-length', str(len(data)))])
    return [data] 
```

当然，如果您使用框架/帮助程序库，它可能具有帮助程序功能，这将使您更轻松。

我想补充一点，多线程功能在 Web 服务器上并不是典型的。如果正确完成，您不需要线程来获得良好的性能。

如果您有一个在不同请求之间切换的完善的事件循环，并以一种对线程友好的方式编写您的请求处理代码（通过尽可能频繁地将控制权返回给服务器），您可以获得比使用线程*更好*的性能，因为它们不会使任何东西运行得更快并增加开销。

有关不使用线程的良好 python Web 服务器实现，请参阅[twisted.web 。](http://twistedmatrix.com/trac/wiki/TwistedWeb)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-24T17:54:08.007

有关使用此技术的精美示例，请参阅 [BNF 铁路图 WHIFF 迷你演示](http://aaron.oirt.rutgers.edu/myapp/root/misc/bnfTest)。您可以从 WHIFF wsgi 工具包下载中获取源代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-07-30T21:26:25.390

You should consider using and paying attention to ETag headers. It's a CGI script, not WSGI, but the ideas are translatable: [sparklines source](http://bitbucket.org/jcgregorio/sparklines/src/) -- it happens to always return the same image for the same parameters, so it practices extreme caching.

# perl - CPAN 中是否有用于过滤跨站点脚本 (XSS) 的良好库？

> ID：1001073
> 
> 赞同：1
> 
> 时间：2009-06-16T12:08:09.050
> 
> 标签：perl, security, xss

CPAN 中是否有一个很好的库来过滤掉所有不好的东西的文本字段，比如 xss？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T12:13:59.663

您的第一步应该始终是搜索和浏览结果。看起来有[很多潜在的热门歌曲](http://search.cpan.org/search?mode=all&query=xss)。当我在寻找新的东西时，我会浏览搜索结果并检查模块的文档以了解它们的清晰程度以及 API 的构建程度。我还寻找评论（有些有，有些没有——通常是随机的）并检查错误。它让我了解我正在处理的事情。

如果您的问题是“这些选项中哪一个最好？”，那么在这种情况下恐怕我不知道。（我最初的回答可能过于笼统。）

开始搜索 CPAN 的两个好地方：

*   [搜索 CPAN](http://search.cpan.org/)
*   [科比斯的寻找](http://kobesearch.cpan.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-03T20:47:40.867

在基本级别，您需要[HTML::Entities](https://metacpan.org/pod/HTML::Entities)，但您选择的转义取决于您在 DOM 中使用这些值的位置。例如，如果将用户输入粘贴在`<script>`标签内，则对用户输入进行 html 实体编码完全没有帮助。

您很可能正在使用某种模板来生成 html，因此它应该有一种方法来转义内容，`HTML::Mason`has `<% $thing |h %>`，`Template::Toolkit`has `[% thing | html %]`...但如果您只是在自己的代码中执行此操作，则需要给`encode_entities`自己打电话。

# https - 客户端（Java、C++ 等）是否需要有效的数字证书才能成功建立 https 连接？

> ID：1001078
> 
> 赞同：3
> 
> 时间：2009-06-16T12:11:38.870
> 
> 标签：https, certificate

我计划实现一个小型独立程序，它将向服务器发出 https 请求。这是否需要客户端中的有效 ssl 证书？在这种情况下 SSL 握手如何工作？没有 SSL 证书的客户端是否存在任何安全问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T12:25:58.500

除了对网络流量进行加密外，HTTPS 通常用于对服务器进行身份验证。也就是说，为了让客户放心，关于谁拥有服务器等信息。为此，客户需要检查服务器发布的证书中的信任链。为了自动发生这种情况，客户端计算机应该安装一个证书，该证书描述了颁发服务器证书的证书颁发机构。通常，此类证书可以在您的计算机上名为“受信任的根证书颁发机构”的商店中找到，并且大多数操作系统都已安装了一组常见的 CA。

此外，许多 Web 服务器提供了一种功能，客户端可以通过提供客户端证书向服务器验证自己的身份。Web 服务器能够检查来自客户端的证书并将其映射到服务器上的一组权限。这种“客户端身份验证”对于有效的 HTTPS 会话不是必需的，但它只是一个选项。

简而言之，您实际上*不需要*客户端上的任何证书，但您可能*希望*拥有一个根 CA 证书以验证服务器的身份。如果您没有该证书，您将无法信任服务器（除非您有其他充分的理由这样做），但您可能会选择与它交换数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T12:50:53.473

如果您想了解有关 HTTPS 握手和协商内容的更多信息，我完全建议您查看 moserware 上的这篇优秀文章

[http://www.moserware.com/2009/06/first-few-milliseconds-of-https.html](http://www.moserware.com/2009/06/first-few-milliseconds-of-https.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T12:25:40.573

仅当服务器需要客户端证书时才需要客户端证书。客户端证书允许服务器对客户端进行身份验证，但这仅在服务器具有所有授权客户端的列表时才有用。Web 服务器通常不是这种情况，因此它们很少需要客户端证书。

当存在时，客户端证书不影响安全通道的建立。（只需要服务器的证书，并且将客户端证书添加到混合中不会改变过程。）一旦建立了安全通道，服务器将使用客户端的证书对客户端进行身份验证（通常通过比较客户端的公共带有授权客户列表的密钥或名称）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T12:15:14.590

建立 HTTPS 连接不需要证书，但如果您想知道与谁通信，则需要证书。

# java - 使用 Spring Web Flow 1 时，如何将对象添加到 bean 的列表中？

> ID：1001084
> 
> 赞同：0
> 
> 时间：2009-06-16T12:12:44.063
> 
> 标签：java, spring, spring-webflow

我有一个网络流，我需要在其中一个屏幕上捕获数据。

此数据存储在一个对象中，该对象将保存在 bean 的列表中。

在提交页面时，我希望能够创建一个对象，并将其添加到 bean 中的列表中。

这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T21:17:15.963

你需要做几件事：

1.  将一个对象放入流范围内（或在现有对象上添加一个额外的字段，例如您的表单），为您要编辑的对象提供一个固定的绑定路径。如果不这样做，就无法利用 Spring 的数据绑定。

2.  在您的 FormAction 上编写一个方法以将此对象放入您的列表中，并将此方法设置为在您提交当前页面时跟随的转换上运行。该方法可以根据需要清理（1）中使用的flowscope级资源。

**编辑**Webflow 文档有很好的例子说明如何对转换执行操作。对于 Webflow 版本 2，请查看[Executing view transitions](http://static.springframework.org/spring-webflow/docs/2.0.x/reference/html/ch04s12.html)和[Executing actions](http://static.springframework.org/spring-webflow/docs/2.0.x/reference/html/ch05.html)。对于版本 1，请参阅[流定义](http://static.springframework.org/spring-webflow/docs/1.0.x/reference/flow-definition.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-18T07:49:28.880

最后，我设法让它与以下流程一起工作。

我创建了一个辅助 bean 来保存一个函数，用于添加到表单 bean 中保存的列表中。

```
<view-state id="page2" view="page2">
    <transition on="save" to="addToList">
        <action bean="form" method="bindAndValidate"/>
    </transition>
    <transition on="back" to="page1">
        <action bean="formAction" method="bindAndValidate"/>
    </transition>
    <transition on="next" to="page3">
        <action bean="formAction" method="bindAndValidate"/>
    </transition>
    </view-state>

    <action-state id="addToList">
        <bean-action bean="helperbean" method="addToList">
            <method-arguments>
                <argument expression="conversationScope.form"/>
        </method-arguments>
        </bean-action>
        <transition on="success" to="page2"/>
    </action-state> 
```

然后它再次显示原始页面

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T21:00:45.153

我会将 Bean（和列表）存储在 Session 中。

# wcf - 检查 WCF 服务是否存在

> ID：1001089
> 
> 赞同：2
> 
> 时间：2009-06-16T12:13:51.940
> 
> 标签：wcf, .net-3.5, installation

检查给定 ip 和端口中是否存在 WCF 服务的最佳方法是什么？我想检查客户端安装中是否存在服务器

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-16T12:15:56.773

知道“服务”是否“存在”的唯一方法是调用它。

为此，许多服务包括一个“Ping”操作（或者可能是一个“GetServerInformation”操作），当被调用时，除了证明服务存在的事实之外，它几乎没有做任何事情或什么都不做。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T17:24:33.177

我知道您已经在此处标记了答案，但您可能会考虑查看此相关线程： [如何检查 net.tcp WCF 服务的可用性](https://stackoverflow.com/questions/881754/how-to-check-the-availability-of-a-net-tcp-wcf-service)

根据您对服务本身的访问权限，使用受支持的 WS-Discovery 方法可能会满足您的需求，有一个很好的替代方法。

# velocity - 速度框架 servlet

> ID：1001096
> 
> 赞同：0
> 
> 时间：2009-06-16T12:15:43.763
> 
> 标签：velocity

我有一个用 servlet 编写的模块，最近需要移动到速度框架所以在此过程中，我正在重写 web.xml 以创建调用我们原始 servlet 的速度 servlet 对象。

现在，如果必须将其移至

```
<servlet>
<servlet-name>VeloServlet</servlet-name>
    <servlet-class>org.apache.velocity.tools.view.servlet.VelocityViewServlet</servlet-class>
</servlet> 
```

我们如何才能实现这一点，以及使用现有的 servlet 需要进行哪些更改。我现有的 servlet 看起来像

```
<servlet-name>DataBridgeServlet</servlet-name>
     <servlet-class>com.jda.pwm.databridge.framework.common.DataBridgeServlet</servlet-class>
<init-param>
    <param-name>jda.databridge.config.path</param-name>
    <param-value>d:/usr/databridge/conf</param-value>
</init-param> 
```

这是使用 url [http://localhost:8080/databridge/databridgeservlet 加载的](http://localhost:8080/databridge/databridgeservlet)

所以在较新的情况下，velocity servlet 如何调用这个 servlet

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-07-19T05:05:35.807

你看过 Velocity Tools 项目中的 VelocityViewServlet 吗？这是在 Web 上快速获取 Velocity 页面的有用方法。

[http://velocity.apache.org/tools/devel/view.servlet.html](http://velocity.apache.org/tools/devel/view.servlet.html)

如果需要，您可以将其子类化以获得更多可定制性。如果不出意外，您可以查看源代码并将其用作制作您自己的 servlet 的灵感。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-23T19:48:25.770

你应该看看：[jpublish.org](http://jpublish.org "JPublish")（我是维护者，因此有偏见:) 并用一个简单的 Action 替换你的 Servlet；脚本（BSH，JS）或Java，你觉得合适。我的 0.2CAD

# enums - 强制转换为枚举

> ID：1001101
> 
> 赞同：0
> 
> 时间：2009-06-16T12:16:52.387
> 
> 标签：enums, casting

我有以下代码。

```
private Enum MyEnum
{
    VALUE1=5, VALUE2=4, VALUE3=3, VALUE4=2, VALUE5=1
}

protected void Page_Load(object sender, EventArgs e)
{
    Session["EnumValue"] = "VALUE1";
    MyEnum test = (MyEnum) Session["EnumValue"];
} 
```

在页面加载中，在转换后我有变量“test”=“VALUE2”的值。

我期待它得到 test ='VALUE1'。代码有什么问题吗

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T12:20:41.973

您不能简单地将字符串值转换回枚举，您必须解析它：

```
MyEnum enumValue = (MyEnum) Enum.Parse(typeof(MyEnum), (string)Session["EnumValue"]); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T12:22:23.373

你为什么使用字符串而不是枚举？喜欢：

```
private Enum MyEnum
{
     VALUE1=5, VALUE2=4, VALUE3=3, VALUE4=2, VALUE5=1
}

protected void Page_Load(object sender, EventArgs e)
{
    Session["EnumValue"] = MyEnum.VALUE1;
    MyEnum test = (MyEnum) Session["EnumValue"];
} 
```

# c# - .net mvc 视图页面 和 ViewUserControl 行为

> ID：1001111
> 
> 赞同：0
> 
> 时间：2009-06-16T12:17:57.313
> 
> 标签：c#, .net, model-view-controller, user-controls

我有一个视图页，其中继承部分看起来像

```
Inherits="System.Web.Mvc.ViewPage<User>" 
```

和一个 ViewUserControl 的继承部分看起来像

```
Inherits="System.Web.Mvc.ViewUserControl<Address> 
```

其中用户类（缩短）基本上看起来像：

```
class User {
public virtual Address address { get; set; } 
```

}

现在，如果我尝试：

```
Html.RenderPartial("Address", Model.address); 
```

然后我可能会得到一些奇怪的行为。在我的例子中，原来 Model.address 是 null 而不是将 null 传递给控件，​​看起来框架试图传递 Model（即 type=User）并抛出错误（意外类型）。

忽略我的地址为空的事实，默认父对象的行为是错误或预期的行为。如果这是预期的行为，那么有人可以解释为什么吗？我不明白。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T13:15:18.353

这类问题通常会导致 OP 在其他地方犯错误，并且该错误是不可重现的。我尝试重新创建您的确切场景，您知道什么？你实际上是对的 :) 我创建了一个简单的父/子关系，并且 View 的类型为子类型，并且部分类型为 child.Parent，它为空，我没有得到空引用，事实上我做到了得到类型不匹配错误。事实上，即使明确地将 null 传递给视图：

```
Html.RenderPartial("MyPartial",null); 
```

甚至直接演员：

```
Html.RenderPartial("MyPartial",(Parent)null); 
```

它仍然给出了不匹配错误。

我的***猜测***，这确实是一个总猜测，是当它检测到传入的对象为空时，它只是默认使用实际视图本身的模型。我不确定这是设计使然还是错误，但这是唯一有意义的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T14:52:03.867

我相信**您应该避免将 null Models 传递给您的 Views**。如果您的模型为空，请使用默认/空模型。这应该有效：

```
Html.RenderPartial("Address", Model.address ?? new Address { /* OPTIONAL: default values */}); 
```

# c# - String.Format("{0:C2}", -1234) （货币格式）将负数视为正数

> ID：1001114
> 
> 赞同：20
> 
> 时间：2009-06-16T12:18:11.697
> 
> 标签：c#, vb.net, string-formatting, currency, string.format

我`String.Format("{0:C2}", -1234)`用来格式化数字。

它总是将金额格式化为正数，而我希望它变为 $ **-** 1234

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-16T12:24:14.820

我说它把它放在括号里是对的，即它把它格式化为`($1,234.00)`？如果是这样，我相信这是美国的预期行为。

但是，您可以创建自己的`NumberFormatInfo`不这样的行为。`NumberFormatInfo`取一个“大部分正确”的现有文件，调用`Clone()`以制作可变副本，然后[`CurrencyNegativePattern`](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.currencynegativepattern.aspx)适当地设置（我认为你想要值 2）。

例如：

```
using System;
using System.Globalization;

class Test
{
    static void Main()
    {
        var usCulture = CultureInfo.CreateSpecificCulture("en-US");
        var clonedNumbers = (NumberFormatInfo) usCulture.NumberFormat.Clone();
        clonedNumbers.CurrencyNegativePattern = 2;
        string formatted = string.Format(clonedNumbers, "{0:C2}", -1234);
        Console.WriteLine(formatted);
    }
} 
```

这将打印 $-1,234.00。如果您确实想要 $-1234，则需要将该[`CurrencyGroupSizes`](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.currencygroupsizes.aspx)属性设置为`new int[]{0}`并使用`"{0:C0}"`而不是`"{0:C2}"`作为格式字符串。

编辑：这是一个你可以使用的辅助方法，它基本上做同样的事情：

```
private static readonly NumberFormatInfo CurrencyFormat = CreateCurrencyFormat();

private static NumberFormatInfo CreateCurrencyFormat()
{
    var usCulture = CultureInfo.CreateSpecificCulture("en-US");
    var clonedNumbers = (NumberFormatInfo) usCulture.NumberFormat.Clone();
    clonedNumbers.CurrencyNegativePattern = 2;
    return clonedNumbers;
}

public static string FormatCurrency(decimal value)
{
    return value.ToString("C2", CurrencyFormat);
} 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2011-06-21T15:56:57.067

另一个简单的选项是手动指定格式字符串。

```
String.Format("{0:$#,##0.00}", -1234) 
```

或者，如果货币符号需要作为参数，您可以这样做

```
String.Format("{0:" + symbol + "#,##0.00}", -1234) 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-06-16T12:43:48.947

我想我会简单地使用：

```
FormatCurrency(-1234.56, 2, UseParensForNegativeNumbers:=TriState.False) 
```

（在 Microsoft.VisualBasic.Strings 模块中）

或者用更短的话（这是我实际要使用的）：

```
FormatCurrency(-1234.56, 2, 0, 0) 
```

或者我会让自己成为一个自定义格式货币函数，它使用传递我的自定义参数的 VB 函数。

有关更多详细信息，请查看 msdn 中的[FormatCurrency 函数 (Visual Basic)](http://msdn.microsoft.com/en-us/library/3352e6f5(VS.80).aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-21T20:16:21.000

```
#region Format value to currency
    /// <summary>
    /// Method to format input in currency format
    ///  Input:  -12345.55
    ///  Output:$-12,345.55  
    /// </summary>
    /// <param name="Input"></param>
    /// <returns></returns>
    public static string FormatToCurrency(string Input)
    {
        try
        {
            decimal value = Convert.ToDecimal(Input);
            CultureInfo culture = CultureInfo.CreateSpecificCulture("en-US");
            culture.NumberFormat.NumberNegativePattern = 2;
            return string.Format(culture, "{0:C}", value);
        }
        catch (Exception)
        {
            return string.Empty;
        }
    }
    #endregion 
```

# svn - 如何仅签入更改为颠覆的文件集

> ID：1001115
> 
> 赞同：7
> 
> 时间：2009-06-16T12:18:25.503
> 
> 标签：svn

如何仅签入已更改到存储库中的选定文件？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-06-16T12:24:02.777

只需将文件名提供给 commit 命令：

```
svn commit -m "Fixed a bad bug" file1 file2 
```

如果您使用的是 subversion 1.5 或更高版本，则可以改为创建一个[changelist](http://svnbook.red-bean.com/en/1.5/svn.advanced.changelists.html)。

```
svn changelist mychanges file1 file2 
```

将创建一个名为的更改列表`mychanges`并将文件分配给它。`file1``file2`

然后您可以提交更改列表，或者在许多其他命令上使用更改列表：

```
svn commit -m "Fixed a bad bug" --changelist mychanges 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-06-16T12:20:37.200

只需告诉 Subversion 你想签入哪些文件。

```
svn commit FILE1 FILE2 FILE3 ... 
```

您可能还会发现1.5 中引入的更改列表功能很有用[。](http://subversion.tigris.org/svn_1.5_releasenotes.html#changelists)请参阅[本书](http://svnbook.red-bean.com/)的[这一部分](http://svnbook.red-bean.com/nightly/en/svn.advanced.changelists.html)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T12:20:35.390

如果您使用的是 TortoiseSVN，当您提交时会出现一个对话框，允许您取消选择您不想提交的任何文件。

如果您使用的是命令行工具，请查看该工具的提交功能的文档，它应该允许您指定要包含的文件。

# terminology - 什么是应用于软件的“过度工程”？

> ID：1001120
> 
> 赞同：35
> 
> 时间：2009-06-16T12:19:35.347
> 
> 标签：terminology, definition

我想知道应用于软件开发的术语“过度工程”的良好定义是什么。在软件设计讨论中，该表达似乎经常与“过分的面向未来”结合使用，并且最好确定一个更精确的定义。

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2009-06-16T12:51:19.120

与大多数答案相反，我不认为“目前不需要的功能”是过度设计的。或者它是问题最少的形式。

就像你说的那样，最糟糕的过度工程通常是以面向未来和可扩展性的名义进行的 - 并达到完全相反的效果：

*   空的抽象层充其量是不必要的，最坏的情况是限制您对底层 API 的狭隘、低效使用。
*   代码中充斥着指定的“扩展点”，例如通过抽象工厂获取的受保护方法或组件——当您必须扩展功能时，这些都不是您真正需要的。
*   使一切都可配置以“避免硬编码”，其效果是配置文件中的应用程序逻辑比源代码中的更多（复杂、容易出错）。
*   过度通用化：开发人员没有实现（技术上无趣的）功能规范，而是构建了一个（技术上有趣的）“业务规则引擎”，它自己“执行”业务用户提供的规范。最终结果是一种专有（脚本或特定领域）语言的解释器，这种语言通常设计得很糟糕，没有工具支持，而且很难使用，以至于没有业务用户可以使用它。

事实是，最容易适应新的和不断变化的需求的设计（因此是最具前瞻性和可扩展性的）是尽可能简单的设计。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-06-16T13:32:50.627

与流行的看法相反，过度工程实际上是当工程师变得“傲慢”并认为他们了解用户时出现的一种现象。

我做了一个简单的图表来说明这一点：

[![过度工程的讽刺插图](../Images/f6aa9747a4d056eeee271e1f8e5fbc7f.png)](https://i.stack.imgur.com/LTE4E.png)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2009-06-16T12:23:47.350

在我们考虑过度设计的情况下，它总是在描述被设计为非常通用的软件，以至于它忽略了最初设计执行的主要任务，因此不仅变得难以使用，但从根本上说是不聪明的。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-06-16T12:24:22.310

对我来说，过度设计包括任何你不需要并且你不*知道*你会需要的东西。如果你发现自己说如果需求以某种方式发生变化，一个特性可能会很好，那么你可能是过度设计了。基本上，过度工程违反了[YAGNI](http://en.wikipedia.org/wiki/You_Ain%27t_Gonna_Need_It)。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-06-16T12:24:19.970

这个问题的敏捷答案是：每段代码都对请求的功能没有贡献。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-06-16T12:23:00.080

[Joel 关于软件](http://discuss.joelonsoftware.com/default.asp?joel.3.392075.30)的讨论始于，

> 为尚不存在的想象中的未来问题创建广泛的类层次结构是一种过度设计，因此是不好的。

并且，通过示例进行讨论。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-06-16T12:26:59.247

如果你花太多时间思考一个问题的可能后果，以至于最终干扰了问题本身的解决，那么你可能会过度设计。

“最佳工程实践”和“现实世界的适用性”之间有一个很好的平衡。在某些时候，您必须决定，即使从工程的角度来看，某个特定的解决方案可能不像它可能的那样“纯粹”，但它会完成这项工作。

例如：

如果您正在设计一个在高中同学聚会中一次性使用的用户管理系统，您可能不需要添加对超长名称或时髦字符集的支持。设置一个合理的最大长度并进行一些基本的清理就足够了。另一方面，如果您正在创建一个将部署用于数百个类似事件的系统，您可能希望在该问题上花费更多时间。

这一切都与手头任务的适当努力水平有关。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-06-16T18:41:16.600

这与我有争议的[“最简单的方法永远是最好的方法”的](https://stackoverflow.com/questions/406760/whats-your-most-controversial-programming-opinion/982182#982182)编程观点有关。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-06-16T12:30:35.713

恐怕不可能有一个精确的定义，因为它高度依赖于上下文。例如，过度设计一个显示闪闪发光的小马的网站比设计一个核电站控制系统要容易得多。冗余、过多的错误检查、高度仪表化的日志设施对于闪闪发光的小马应用程序来说都是过度设计的，但对于核电站控制系统来说却不是。我认为你能做的最好的事情就是感觉到你何时为了应用程序的目的而对你的功能应用了太多的开销。

请注意，我会区分镀金和过度工程。在我看来，镀金正在创造一些没有被要求也永远不会被使用的功能。过度工程更多地是关于通过围绕代码进行编码检查或对简单任务使用过度设计来为应用程序构建多少“安全性”。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2009-06-16T12:23:59.767

[从这里引用](http://c2.com/xp/YouArentGonnaNeedIt.html)：“......当你**真正**需要它们时实施它们，而不是在你**预见**到你需要它们时。”

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2009-06-16T12:34:04.910

对我来说，任何东西都会给代码增加更多的脂肪。Meat 可以是任何可以根据规范完成工作的代码，而 fat 可以是任何会使代码膨胀而只会增加复杂性的代码。程序员可能一直期待功能的未来扩展；但是还是很胖！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-11-01T04:19:30.830

> 当您的设计实际上使事情变得更复杂而不是简化事情时，您就是在过度设计。

更多信息请访问：

[http://www.codesimplicity.com/post/what-is-overengineering/](http://www.codesimplicity.com/post/what-is-overengineering/)

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-06-16T12:23:34.167

我的粗略定义是“提供不需要满足需求规范的功能”

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-06-16T12:23:37.053

我认为它们与[镀金](http://en.wikipedia.org/wiki/Gold_plating_(analogy))相同并被[金锤](http://sourcemaking.com/antipatterns/golden-hammer)击中:)

基本上，您可以坐下来花费太多时间来尝试做出完美的设计，而无需编写一些代码来检查它是如何工作的。任何敏捷方法都会告诉您不要预先完成所有设计，而只是创建设计块，实施它，重复它，重新设计，再去等等......

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-06-16T12:26:57.327

过度工程化意味着根据需求列表使用比实际应有的组件更多的组件来架构和设计应用程序。

过度工程和创建可扩展的应用程序之间有很大的区别，可以随着需求的变化而升级。如果我能想到一个例子，我会编辑帖子。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-06-16T12:55:21.763

过度工程只是简单地创建一个产品，其功能、质量、通用性、可扩展性、文档或任何其他方面都超出了要求。

当然，您可能有特定项目之外的需求——例如，如果您预计将来会做类似的应用程序，那么您可能有额外的可扩展性需求，取决于成本，您添加到项目特定需求中。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-09-03T19:41:47.697

免责声明＃1：我是一个大局的BA。我不知道代码。我一直在阅读这个网站。这是我的第一篇文章。

有趣的是，我的老板刚刚告诉我，我过度设计了一个我们计划指导的新软件产品（目标市场人力资源人员）。所以我来这里查一下这个词。

他们希望现在就出售一些东西，重新利用现有工具。我不禁坐下来思考，更少的注册，更低的保留，如果它不允许我们谈到的一些灵活性。主要是有一个猴子可以使用的高度可视化的 UI。

他说我们可以计划未来的阶段来改进产品，尤其是 UI。我们目前的客户正在等待我们仍然没有做的“未来改进”。他们需要它，真的需要它。

我正在辞职，所以我没有退缩。

但我的定义是......确保它只做尽可能少的事情，尽可能便宜，并且对于你所说的事情仍然可以接受。除此之外就是过度工程。

免责声明 #2：这个网站帮助我找到了下一份工作，实施了一个更可配置的软件。

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2009-06-16T12:22:23.297

我认为您的问题的最佳答案可以在[其他问题中找到](https://stackoverflow.com/questions/948355/when-is-an-api-overengineered)

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2009-06-16T12:25:51.387

敏捷编程的美妙之处在于，如果你做得对，就很难过度设计。

# c# - OO 设计与数据库设计

> ID：1001122
> 
> 赞同：5
> 
> 时间：2009-06-16T12:20:23.097
> 
> 标签：c#, oop, n-tier-architecture

假设我正在用 C# 为产品分销商开发应用程序。

分销商执行以下 3 种类型的交易：

(1) 缩进

(2) 卖出

(3) 库存

我正在设计我的课程如下：

```
public abstract class Transaction
{
}

public class Indent : Transaction
{
}

public class Sell : Transaction
{
}    

public class Stock : Transaction
{
} 
```

现在如果我想将这三种类型的信息保存在三个单独的表中，那么我应该如何设计我的 DA 层？

我应该建立单独的DA类吗？

```
(1) IndentDA
(2) SellDA
(3) StockDA 
```

还是单个类`TransactionDA`并通过使用`as/is`运算符检查其类型来执行 CRUD 操作？

或者我还能做什么？有什么建议么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T12:25:13.120

首先，如果您创建了单个类 TransactionDA 并检查了类中的类型以执行 CRUD 操作，那么您将违反[Open/Closed 原则](http://en.wikipedia.org/wiki/Open/closed_principle)，所以我绝对不会走这条路。

至于如何完成构建 DAL 的建议，我建议关注一些关于比我聪明得多的人对这个主题的看法的博客文章。

[存储库是新的单例](http://ayende.com/Blog/archive/2009/04/17/repository-is-the-new-singleton.aspx)

[存储库已死：存储库万岁](http://codebetter.com/blogs/gregyoung/archive/2009/04/23/repository-is-dead-long-live-repository.aspx)

[生者之夜](http://ayende.com/Blog/archive/2009/04/23/night-of-the-living-repositories.aspx)

我相信，对话仍在继续，但这应该让你开始。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T12:33:08.720

我会在这里使用实体子类型。为交易创建一个表（正如之前的海报所说，也许不同的术语会更好）并在那里存储所有常见的东西。然后为每个专业创建一个“子类型”表。这些子类型表应具有与主表（“强”实体）相同的主键以及该特定专业化唯一的字段。每个子类型以一对一的方式与强实体相关联，子类型端可选参与，强实体端需要参与。

然后，为了使查询更容易，定义一个（外部）将强实体与所有实体子类型连接起来的视图，以便您可以轻松“查看”所有内容。

这是一个如何设置的简单（和常见）示例：

```
create table Employee (
  eid        int primary key,
  first_name text,
  last_name  text not null
)

create table Salaried (
  eid             int primary key,
  annualSalaryUSD money not null
)

create table Hourly (
  eid             int primary key,
  hourlyRateUSD   money not null
) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T12:38:41.283

我会使用 NHibernate 之类的 ORM 并使用它的多表继承功能，然后我自己就不必担心了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T12:24:53.150

如果您知道您的数据将进入三个单独的表，那么我通常会有三个单独的 DA 类。

但是，如果您的表几乎完全相同，那么您可以通用化 TransactionDA 并简化您的数据层。如果您知道您将有大量事务并且要将您的表分成不同的文件或其他东西，我只会这样做，否则我可能只会简化事情并将它们组合起来。

**除非所有单独的事务类型都非常**相似，否则不要尝试创建 TransactionDA 。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-16T12:26:02.790

您可以使用依赖注入，为每个创建一个 DA 类，并让它们都使用您的 CRUD 操作实现相同的接口 ITransactionDA。

```
public interface ITransactionDA
{
  void Read();
  void Update();
...
}

public class StockDA : ITransactionDA
{
  //implement interface methods
}

Stock stock = new Stock(new StockDA()); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T12:35:00.930

我会做这样的事情

```
public abstract class DistributerTransaction
{
    DistributerDA dataaccess;
}
public class Indent : DistributerTransaction
{
}
public class Sell : DistributerTransaction
{
}
public class Stock : DistributerTransaction
{
}

public abstract class DistributerDA
{
   /*Read();
     Update();*/
}
public class IndentDA : DistributerDA
{
}
public class SellDA : DistributerDA
{
}
public class StockDA : DistributerDA
{
} 
```

* * *

## 回答 #7

> 赞同：-6
> 
> 时间：2009-06-16T12:24:24.087

查看[Gang of 4 设计模式](http://en.wikipedia.org/wiki/Gang_of_Four_(software))。

# .net - 为 COM 互操作性注册我的 .net 程序集不会公开我的方法

> ID：1001129
> 
> 赞同：3
> 
> 时间：2009-06-16T12:21:39.413
> 
> 标签：.net, com, com-interop

好吧，我要疯了。我一直在尝试使一个简单的.net 程序集可见以用作 COM 对象，但它不起作用。我一直在尝试很多不同的方法，但都没有奏效。到目前为止，我得到的最接近的是属性、接口、手动注册等最少的那个。

我有一个 vbscript 作为测试，如下所示：

```
Dim o
o = CreateObject("MyNamespace.MyClass")
msgbox o.Test() 
```

我的 c# 代码如下所示：

```
using System;
using System.Runtime.InteropServices;
namespace MyNamespace 
{
  [ProgId("MyNamespace.MyClass")]
  public class MyClass
  {
    public string Test()
    {
       return "teststring";
    }
  }
} 
```

在我的项目（VS2008）上，我选择了“使程序集 COM 可见”——它向我的 AssemblyInfo.cs 添加了一个属性，我还检查了“注册 COM 互操作”。

我可以看到 ProgId 真的没有什么区别（无论如何在我的情况下） - 只要我指定真正的名称空间+类名，我可以覆盖它，我认为这很好。

问题是 - 我的 CreateObject 运行良好，但找不到方法 Test()。事实上，如果我使用 dll 并提取 tlb 并期望我根本看不到任何方法。

我得到的错误是这样的：

> C:\inetpub\wwwroot\ASPTest\testrun.vbs(3, 1) Microsoft VBScript 运行时错误：对象不支持此属性或方法：“测试”

我很想得到任何反馈，但只是为了让你知道我一直在尝试什么。我在类上搞乱了 Guid 和 AttributeGuid，在类上明确定义了 COMVisible，我尝试不注册 COM 互操作，而是做了 regasm /codebase /regfile。

最后一点-我的大多数测试都围绕未签名的程序集展开，但试图查明我尝试使用强名称/密钥的错误，但它没有做任何事情。

谁能帮我找出问题，好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T12:36:36.917

我有没有提到我运行 Windows 7 RC 64 位？

好吧，我认为这可能解释我的 VS 做得不对： http: [//kbalertz.com/956933/Issues-building-project-assembly.aspx](http://kbalertz.com/956933/Issues-building-project-assembly.aspx) 似乎 VS 使用 32 位版本的注册表而不是 64 位...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T06:41:02.360

我从一开始就在我的项目中删除了有关 COM 互操作的任何内容，然后我添加了

```
[Guid(...some guid...)]
[ComVisible(true)] 
```

在 MyClass 上，我添加了一个强名称（使用项目设置来设置它 - 而不是在 AssemblyInfo.cs 中定义它。

当我编译程序集时，我将文件复制到另一个我做了

```
regasm MyNamespace.MyClass.dll /codebase /regfile 
```

然后我运行并接受了注册表项。

这使它起作用 - 每当我进行更改时，我只需重新编译并将文件复制到旧文件（没有取消注册），然后我只做：

```
regasm MyNamespace.MyClass.dll /codebase 
```

...就是这样 - 我对 MyClass 所做的更改在我的 vbscript 和我的 asp 页面中立即可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T12:25:52.383

您不需要定义一些具有方法的接口并实现该接口吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T12:39:17.193

这对我有用：

```
using System;
using System.Runtime.InteropServices;
namespace MyNamespace
{

    [GuidAttribute("8DDE02DF-B31C-4d91-98A7-C64444701985")]
    [ClassInterface(ClassInterfaceType.AutoDual)]
    public class clsCOMWraper
    {
       public string Test()
      {
         return "teststring";
      }
    }
} 
```

这些程序集必须签名。

注册 regasm /codebase

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-29T20:04:44.743

我没有看到该类的任何构造函数。COM Interop 需要一个默认构造函数（没有任何参数）才能成功生成 COM 接口。

尝试添加一个构造函数，看看它是否有效。

# c# - 检测视图状态篡改

> ID：1001134
> 
> 赞同：3
> 
> 时间：2009-06-16T12:22:34.793
> 
> 标签：c#, asp.net, viewstate

在我的 asp.net 项目中已经看到视图状态发生了变化。有没有办法检查我的 ViewState 是否被篡改？（理想情况下使用 C#）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T12:30:38.053

视图状态是用机器密钥（默认服务器 mac）签名的，但是如果它只是你得到的错误，那么它可能是一个传输错误或类似的（如果你运行一个农场，请确保在所有机器上设置相同的机器密钥）

此外，如果您的后安全性不在视图状态中存储有意义的信息，请将其保存在会话中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T12:32:03.073

您可以在 ViewState 中添加加密校验和，并在回发后检查它是否仍然正确

编辑：看了phoenix发布的链接后，好像ASP.NET中已经内置了这样的机制，所以我的建议可能没用......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T12:41:48.983

有一个内置机制可以检查视图状态是否存在篡改攻击。

您是否收到**此页面的视图状态无效，并且可能是损坏的**异常并怀疑被篡改？当您删除回发之间的控件时发生此异常。

# jquery - 根据状态显示用户名或登录按钮

> ID：1001135
> 
> 赞同：1
> 
> 时间：2009-06-16T12:22:59.050
> 
> 标签：jquery

针对 jQuery 1.3.2 我正在寻找实现典型的“*您登录为：* ”或“*单击此处登录*”模式的最佳实践。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T12:43:33.567

像这样的东西怎么样：

```
<script>
    var logged = '{$usernameFromServer}';
    $(document.ready(function () {
        var span = null;
        if (logged != '') {
            span = $('<span>You are logged in as: ' + logged + '</span>');
        } else {
            span = $('<span>Click here to log in</span>');
        }

        $('#someDiv').append(span.html());
    });
</script> 
```

对于一个快速而肮脏的解决方案，为了给你一些想法，我直接将它编码到 SO 所以不能保证:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T13:55:08.693

这里真的没有“模式”，更不用说成熟的模式了。

模式是参考典型实现风格或问题解决方案的快速方法。它们本质上是通用的，通常不用于参考用户界面元素。

[在客户端之一，围绕登录框](http://www.smileycat.com/design_elements/login_forms/)的设计方面有很多讨论，但很少实现，因为这实际上取决于您如何实现登录和会话管理。

# asp.net - 从 WebMethod 创建用户控件的 Asp.net 错误

> ID：1001141
> 
> 赞同：1
> 
> 时间：2009-06-16T12:23:45.197
> 
> 标签：asp.net, user-controls

我在参考[文章参考](http://mosesofegypt.net/post/2008/04/GridView-Grouping-Master-Detail-Drill-Down-Using-jQuery-AJAX.aspx)

动态创建 UserControl 并通过 jQuery 将其传递回页面。

当我只是在 UserControl“Hello World”中做一个简单的文本时，一切都很好......但是，当我尝试在控件上放置交互式控件时，我在我的 WebMethod 中收到以下消息（所以 jQuery 调用的东西是无关紧要的）（进一步的测试表明，文本框和按钮会导致问题，而不是标签）

执行处理程序“System.Web.UI.Page”的子请求时出错

这是网络方法：

```
[WebMethod]
public static string GetCtrl(string cname)
{
    StringWriter sw = new StringWriter();

    Page p = new Page();
    Control c = p.LoadControl("~/Controls/" + cname);
    p.Controls.Add(c);

    try
    {
        HttpContext.Current.Server.Execute(p, sw, false);
    }
    catch (Exception err)
    {
        return err.Message;
    }
    sw.Close();

    return sw.ToString();
} 
```

在 Server.Execute 调用期间发生异常。

解决方案可能是不可能的，我只想知道为什么交互式控件会导致这种情况。

编辑：接受下面的建议，我深入研究并发现内部异常表明它必须位于标有 runat="server" 的表单标记内，而我在表单标记内的 aspx 页面上显示此控件。 ..我的猜测是那里必须有某种“asp.net魔术”连接才能使控件运行...无论如何，无论如何，知道如何呈现带有控件的页面会很好（甚至如果它在这种情况下不可用）

所以我查看了上面代码的输出，对于那些好奇的人：

`<span id="ctl00_lbl1">abc: </span>`

所以控件在页面上正确渲染（只有标签id ='lbl1'），但是，控件本身是渲染的，页面内容根本不存在......有没有办法生成页面源也？（我一定不明白 Server.Execute 函数的工作方式）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T12:50:35.953

我将从缩小问题范围开始。例如，如果你离开会发生什么

```
p.Controls.Add(c); 
```

如果你正确地执行一个`using`语句会发生什么？

```
using (StringWriter sw = new StringWriter()) {
    // ...
    HttpContext.Current.Server.Execute(p, sw, false);
    return sw.ToString();
} 
```

如果您放弃尝试/捕获，会发生什么？除了 Message 属性之外，它会花费您在异常中的所有信息，那么为什么不直接关闭它呢？在任何情况下，你的调用者都可能期待 HTML，所以如果你保留它，你可能（稍后）想要包装输出：

```
return "<p>" + ex.ToString() + "</p>"; 
```

一点一点地移除东西，直到问题消失。

* * *

根据您从 InnerException 中了解到的情况，我建议您将 HtmlForm 控件添加到页面，然后将加载的控件添加为 HtmlForm 的子控件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-01-17T21:26:33.053

[使用 Scott Gu 的博客作为参考](http://weblogs.asp.net/scottgu/archive/2006/10/22/Tip_2F00_Trick_3A00_-Cool-UI-Templating-Technique-to-use-with-ASP.NET-AJAX-for-non_2D00_UpdatePanel-scenarios.aspx)，我也遇到了在我的小部件中加载服务器控件的相同问题（例如 GridView 和 RadTreeView 控件会导致相同的错误），用于我们公司的仪表板。按照 John Saunders 的提示，我添加了一个 HTML 表单控件和脚本管理器控件（用于 RadTreeView 控件）并解决了这个问题。现在我的用户控件呈现为纯 HTML。w00t！

```
[WebMethod]
public static string[] LoadWidget(string widgetID, string widgetPath)
{
    try
    {
        var pageHolder = new Page();
        var form = new HtmlForm();
        var viewControl = (UserControl)pageHolder.LoadControl(widgetPath);
        var scriptManager = new ScriptManager();
        form.Controls.Add(scriptManager);
        form.Controls.Add(viewControl);
        pageHolder.Controls.Add(form);

        var output = new StringWriter();
        HttpContext.Current.Server.Execute(pageHolder, output, false);

        return new string[]
        {
            widgetID, output.ToString()
        };
    }
    catch (Exception e)
    {
        // handle error...
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T12:41:23.320

我会尝试渲染控件并将该字符串发送回......

```
Control ctrl;
StringBuilder sb = new StringBuilder();
StringWriter tw = new StringWriter(sb);
HtmlTextWriter hw = new HtmlTextWriter(tw);

ctrl.RenderControl(hw);
return sb.ToString(); 
```

# sql - MySQL SELECT x FROM a WHERE NOT IN (SELECT x FROM b) - 意外结果

> ID：1001144
> 
> 赞同：36
> 
> 时间：2009-06-16T12:24:00.093
> 
> 标签：sql, mysql

我希望下面第三个查询的结果包含 id=732。它没有。这是为什么？

```
mysql> SELECT id FROM match ORDER BY id DESC LIMIT 5 ;
+------------+
| 编号 |
+------------+
| 第732章
| 730 |
| 655 |
| 第458章
| 第456章
+------------+
5 行一组（0.00 秒）

mysql> SELECT id FROM email ORDER BY id DESC LIMIT 5 ;
+------------+
| 编号 |
+------------+
| 第731章
| 第727章
| 725 |
| 第724章
| 第723章
+------------+
5 行一组（0.00 秒）

mysql> SELECT * FROM match WHERE id NOT IN (SELECT id FROM email);
空集（0.00 秒）

```

表 email.id 中有 3 个 NULL 条目，而 match.id 中没有 NULL 条目。

完整的表/查询可以在[http://pastebin.ca/1462094](http://pastebin.ca/1462094)

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-06-16T12:32:51.870

从[**文档**](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html)：

> 为了符合`SQL`标准，不仅如果左侧的表达式是，而且如果在列表中没有找到匹配项并且列表中的表达式之一是 ，则`IN` 返回。`NULL``NULL``NULL`

这正是你的情况。

两者都`IN`返回`NOT IN`，`NULL`这不是`WHERE`子句可接受的条件。

重写您的查询如下：

```
SELECT  *
FROM    match m
WHERE   NOT EXISTS
        (
        SELECT  1
        FROM    email e
        WHERE   e.id = m.id
        ) 
```

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2010-09-13T22:42:26.607

...或者如果你真的想使用`NOT IN`你可以使用

```
SELECT * FROM match WHERE id NOT IN ( SELECT id FROM email WHERE id IS NOT NULL) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-06-16T12:29:36.573

我对 MySQL 如何处理空值的细节有点脱节，但这里有两件事可以尝试：

```
SELECT * FROM match WHERE id NOT IN 
    ( SELECT id FROM email WHERE id IS NOT NULL) ;

SELECT
    m.*
FROM
    match m
    LEFT OUTER JOIN email e ON
        m.id = e.id
        AND e.id IS NOT NULL
WHERE
    e.id IS NULL 
```

第二个查询看起来与直觉相反，但它先执行连接条件，然后执行 where 条件。这是连接和 where 子句不等价的情况。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-05-17T16:20:14.720

下面是一些真正有意义的 SQL：

```
SELECT m.id FROM match m LEFT JOIN email e ON e.id = m.id WHERE e.id IS NULL 
```

简单总是更好。

# c++ - 使用命名空间两次

> ID：1001154
> 
> 赞同：3
> 
> 时间：2009-06-16T12:24:58.580
> 
> 标签：c++, namespaces

在 c++ 中可以两次包含相同的命名空间吗？编译器不会给出任何错误，但无论如何它仍然会影响

谢谢，

**编辑：**
我的意思是

```
using namespace std;

// . . STUFF
using namespace std; 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-16T12:30:14.497

这取决于您所说的“包含”是什么意思。说：

```
using namespace std;    
...    
using namespace std: 
```

没关系。但是说：

```
namespace X {
   ...
namespace X { 
```

将创建一个名为 X::X 的嵌套命名空间，这可能不是您想要的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-16T12:35:01.913

这种用法很好，如果这是您所说的：

**文件：foo.h**

```
namespace tools
{
  class Widget
  {
  ...
  };
} 
```

**文件：bar.h**

```
namespace tools
{
  class Gizmo
  {
  ...
  };
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T12:29:49.630

在同一个类/文件中两次？这不应该是一个问题，但也不应该是必要的。我天真地假设您应该能够重构代码以避免该问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T12:28:21.037

我不完全确定你的意思。您可以将多个类放在一个命名空间中（这就是整个想法）。每个类通常都有自己的文件，所以是的，您可以在多个文件中使用相同的命名空间。

虽然技术上没有要求，但最好有一个目录结构来表示您创建的命名空间层次结构。

至于*using*指令：编译器和/或智能感知最有可能给你一个警告（C# 有），否则没有效果。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T12:33:23.320

您是在问以下是否可以？

```
using namespace std;
using namespace std; 
```

没关系，但通常我更喜欢使用范围解析来引用命名空间元素。

前任：

```
std::vector
std::sort 
```

# php - 维基百科整合问题 - 最终需要解决这个问题 101

> ID：1001156
> 
> 赞同：0
> 
> 时间：2009-06-16T12:25:21.917
> 
> 标签：php, mysql, wikipedia, data-mining

对不起，伙计们，我一直在模拟询问如何将维基百科数据集成到我的应用程序中，坦率地说，我认为我没有取得任何成功，因为我一直在尝试所有的想法并且有点放弃当我读到死胡同或障碍时。我将尝试解释我到底想在这里做什么。

我有一个简单的位置目录，如城市和国家。我的应用程序是一个简单的基于 php 的基于 ajax 的应用程序，具有搜索和浏览功能。人们注册并将自己与一个城市相关联，当用户浏览城市时 - 他/她可以看到该城市的人和公司，即我们系统中的任何人。

该部分很容易自行设置并且工作正常。问题是我的搜索结果将采用以下格式，即有人搜索让我们说北京。它将在三个选项卡式界面框中返回：

1.  第一个选项卡会有一个包含北京城市信息的信息框
2.  第二个将是一个国家选项卡，其中包含来自中国的国家信息的信息框
3.  第三个选项卡将列出所有在北京的联系人。

前两个标签的内容应该来自维基百科。现在我完全不知道什么是完成这项工作的最佳方法，而且一旦决定了一种方法——我该如何去做并让它变得相当强大的。

到目前为止，我能够消化的一些好的和坏的想法是：

1.  直接向维基百科运行 curl 请求，并在每次搜索时解析返回的数据。在这种情况下，无需维护 wikipedia 上的数据的本地副本。另一个问题是它完全依赖于来自远程第三位置的数据，我怀疑每次向维基百科发出请求以检索基本信息是否可行。再加上考虑到维基百科上的数据需要在每个请求时进行解析 - 这将克服繁重的服务器负载......或者我在这里推测。

2.  下载维基百科转储并查询。好吧，我已经下载了整个数据库，但是从 xml 转储中导入所有表需要很长时间。另外考虑一下我只想提取国家和城市列表及其信息框的事实 - 转储中的很多信息对我来说毫无用处。

3.  制作我自己的本地表并创建一个 cron [我将在此处解释为什么 cron 工作] 脚本，它会以某种方式解析维基百科上的所有国家和城市页面，并将它们转换为我可以在我的表中使用的格式。但老实说，我不需要信息框中的所有信息，因为事实上我什至可以按原样获得信息框的基本标记——这对我来说已经足够了。像：

国家名称 | 信息框原始文本

如果需要，我可以亲自提取坐标和其他细节等内容。

我什至尝试从 infochiumps 和 dbpedia 下载第三方数据集，但 infochimps 的数据集不完整，并且不包含我想要显示的所有信息 - 加上 dbpedia，我完全不知道如何处理我下载的信息框的 csv 文件恐怕它也可能不完整。

但这只是这里问题的一部分。我想要一种显示维基百科信息的方法 - 我会让所有指向维基百科的链接以及来自维基百科的好信息在周围正确显示但问题是我需要一种方法来定期更新我拥有的信息来自维基百科，所以至少我没有完全过时的数据。就像说一个可以检查的系统，如果我们有一个新的国家或新的位置，它可以解析信息并以某种方式检索它。我在这里依靠维基百科中的国家和城市类别，但坦率地说，所有这些想法都写在纸上，部分编码并且非常混乱。

我正在用 PHP 和 MySQL 编程，我的截止日期很快就要到了——鉴于上述情况和要求，遵循和实施的最佳和最实用的方法是什么。我对想法完全持开放态度——如果有人做过类似的事情，我会举个实际例子——我很想听听：D

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T12:33:08.953

我能想到的几件事：

1.  只需在您网站的 iframe 中显示维基百科数据。

2.  使用 Curl 从 wikipedia 获取 html，然后使用自定义样式表对其进行样式设置和/或隐藏您不想显示的部分。

试图真正解析 HTML 并提取出你想要的部分将是一个巨大的痛苦，并且很可能必须为每个城市定制。最好先做一些简单的工作，然后再回去改进它，如果你决定你真的需要的话。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T12:37:03.780

如何使用[维基百科地理编码网络服务之一](http://www.geonames.org/export/wikipedia-webservice.html#wikipediaBoundingBox)

有几个可用的地方，例如，邮政编码和国家/地区可以传递到简短的文章摘要和维基百科文章的链接。

如果这样就足够了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T13:44:21.523

我建议以下

*   在您的数据库中创建城市（城市）时从维基百科查询城市
*   解析数据，使用上次更新的时间戳存储本地副本
*   访问时，如有必要，更新数据。您可以显示带有水印的旧版本，说明它已经存在……几天了，现在正在更新。然后在更新完成后更改为新获取的。你说你使用的是AJAX，所以不会有问题

它将最大限度地减少对维基百科的查询，即使无法访问维基百科，您的服务也不会显示空白页面。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-05-07T09:57:49.913

看看 DBPedia，它包含以 CSV 格式很好地提取 Wikipedia 数据。

# unix - UNIX ssh 脚本，在远程服务器上运行命令

> ID：1001179
> 
> 赞同：5
> 
> 时间：2009-06-16T12:29:06.277
> 
> 标签：unix, shell, ssh, command, remote-server

我想创建一个脚本，自动登录到远程服务器并获取服务器上的文件。该脚本已经登录到服务器，但是命令不在该机器上运行。一旦我与远程服务器断开连接，命令就会在客户端计算机上运行。

```
!/bin/sh
ssh -o PreferredAuthentications=publickey brjones@server.com
cd ~/folder
"i would like to grab file and copy it to client machines folder" 
```

编辑：我不确定您是否注意到，但我使用 ssh 和密钥生成与远程服务器建立无密码连接。我很欣赏这些想法，但我希望使用客户端上的脚本在远程服务器上传输命令或运行命令。我意识到远程服务器无权访问客户端脚本，但是我很好奇是否可以通过 ssh 连接管道命令。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-06-16T12:31:12.950

您应该使用[scp](http://www.eos.ncsu.edu/remoteaccess/man/scp.html)（“安全复制”）而不是[ssh](http://unixhelp.ed.ac.uk/CGI/man-cgi?ssh+1)（“安全外壳”）。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-16T14:19:59.393

此外，如果您不想在远程服务器上使用脚本，请尝试以下操作：

```
ssh thehost 'cd /tmp; ls; echo Hello world, I am `hostname`' 
```

对于无 SCP 复制：

```
ssh localhost 'cat /bin/bash' > local_bash 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-17T09:46:11.360

如果您的目标只是传输文件，则应使用 scp。但是要在远程主机上执行一些命令而不在该远程主机上使用特定脚本，您可以像这样简单地使用标准输入：

```
!/bin/sh
ssh -o PreferredAuthentications=publickey brjones@server.com << EOT
cd ~/folder
echo "hello" > hello.txt
...
EOT 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-16T12:33:12.930

你应该用`ssh`这种方式在远程机器上执行脚本，

```
ssh user@server exec /path/to/script/script.sh 
```

从登录到给定路径的服务器上`script.sh`可用的位置。`user`

* * *

如果脚本在服务器上不存在但在本地机器上可用（并且两台机器之间没有公共 NFS 共享空间），您应该`scp`像这样发送脚本，

```
scp script.sh user@server:/path/to/script/ 
```

* * *

现在，对于您获取服务器文件的特定情况，您应该执行，

```
scp user@server:/path/to/file/filename . 
```

就像其他一些答案已经暗示的那样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-16T12:32:53.680

脚本中的 ssh 不能那样工作。但是，它确实能够通过将命令指定为 ssh 的参数来在远程服务器上执行命令，例如：

ssh brjones@server.com do_foo.sh

将在服务器上运行 do_foo.sh 脚本

但是，对于您的情况，您真正要寻找的是SCP。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-11-12T16:06:07.560

除了 Tiemen 的回答之外，您当然可以使用以下命令从本地脚本中传输命令：

```
ssh thehost < commands.sh 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2011-02-02T02:28:13.327

SCP？Remote 是具有只读文件系统的设备。我不想留下脚本，或者使用 ssh 的多次调用来清理它，或者多次调用来一次执行一行。名单还在继续……

[Yarek T 的绝佳解决方案：](https://stackoverflow.com/questions/305035/how-to-use-ssh-to-run-shell-script-on-a-remote-machine)

您可能需要在引用或转义方面进行一些操作，但它可以完成工作，与远程的单个连接并且脚本保持在本地。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-16T14:03:35.557

有几个人已经解释了如何更好、更容易地完成你给出的特定示例。

如果您确实*需要*编写远程交互脚本，您可以考虑使用[`expect`](http://expect.nist.gov/).

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-16T12:31:43.747

为什么不使用[scp](http://linux.die.net/man/1/scp)？

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-05-13T10:47:05.297

如果要在远程主机上调用脚本，该脚本存在于 localhost

`ssh remote Password@remoteHostname < localScript.sh`

如果你想调用一个已经在远程主机上的脚本

`ssh remote Password@remoteHostname "$PATH_OF_SCRIPT/remoteScript.sh"`

# java - 在基于 Struts 的 Web 应用程序中的 JSP 页面中使用 JSTL

> ID：1001183
> 
> 赞同：0
> 
> 时间：2009-06-16T12:29:51.003
> 
> 标签：java, jakarta-ee, struts, jstl

我有一个基于 Struts 1.2 的 Web 应用程序，它在 JSP 页面中使用了大量的 scriptlet 代码，我希望通过使用 JSTL 来清理代码。Servlet 规范级别：2.3 和 JSP 规范级别：1.2。我正在使用 WSAD 5.1。

我尝试使用`<c:if></c:if>`标签，但在构建项目时出现以下错误。“JSP 翻译：无法加载 if 标记”

我已包含此标签库的 taglibs 元素以及相应文件夹中的 TLD 文件。

我猜容器无法找到标签处理程序。

如果有人可以分享他们对此的想法，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T12:45:03.920

确保您使用的 JSTL 版本与您的 servlet 容器兼容。例如，JSTL 1.1 只兼容 JSP 2.0 及更高版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-07-30T03:27:47.963

尝试使用这个：

```
<%@ taglib uri="http://java.sun.com/jstl/core" prefix="c" %> 
```

而不是这个，反之亦然

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %> 
```

# apache-flex - 带有 ItemRender 的 Flex 数据绑定列表 - 重新排序重置复选框值

> ID：1001184
> 
> 赞同：0
> 
> 时间：2009-06-16T12:29:52.797
> 
> 标签：apache-flex, flash, actionscript-3, flex3

我有一个数据绑定到数组的 Flex 列表。我的问题是，当我使用内置的 dragMoveEnabled 重新排序列表时，这些值会重置为原始值。

我假设我需要以某种方式进行双向数据绑定，但我不确定如何。

```
<mx:List width="100%"  top="20"   id="uiItemList" dragMoveEnabled="true" bottom="0" 
             dragEnabled="true" dropEnabled="true" 
    dataProvider="{listArray}"   >
    <mx:itemRenderer>
        <mx:Component>
            <mx:HBox width="100%" height="25" >
                <mx:CheckBox id="uiCheck" textAlign="center" selected="{data.IsDone}" mouseDown="event.stopImmediatePropagation();"  />
            </mx:HBox> 
        </mx:Component>
    </mx:itemRenderer>
</mx:List>

[Bindable]
public var listArray : ArrayCollection = new ArrayCollection (); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T16:09:49.720

也许你可以试试：

```
selectedField = "IsDone" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-10T21:13:22.243

itemRenderer 本身只渲染数据。这是我发现的作品：

```
<mx:ArrayCollection id="listArray">
  <mx:Array>
    <mx:Object label="Item One" checked="false" />
    <mx:Object label="Item Two" checked="true" />
  </mx:Array>
</mx:ArrayCollection>
<mx:List dataProvider="{listArray}" dragEnabled="true" dragMoveEnabled="true" dropEnabled="true" editable="true" rendererIsEditor="true" editorDataField="data">
  <mx:itemRenderer>
    <mx:Component>
      <mx:HBox xmlns:mx="http://www.adobe.com/2006/mxml">
        <mx:Script>
          <![CDATA[
    private var _data:Object;

    [Bindable]
    override public function set data(value:Object):void {
        _data = value;
    }

    override public function get data():Object {
        return _data;
    }
          ]]>
        </mx:Script>
        <mx:CheckBox selected="{data.checked}" />
        <mx:Label text="{data.label}" />                              
      </mx:HBox>
    </mx:Component>
  </mx:itemRenderer>
</mx:List> 
```

如果更新复选框，则需要先选择另一个项目，然后才能在列表中重新定位已编辑的项目。希望有帮助！

# asp.net - ASP.NET ListView 交替组

> ID：1001188
> 
> 赞同：1
> 
> 时间：2009-06-16T12:30:33.280
> 
> 标签：asp.net

与大多数数据绑定 ASP.NET 控件一样，ASP.NET ListView 控件具有 AlternatingItemTemplate，例如，您可以使用它来为奇数行和偶数行呈现不同的 css 类。该控件还具有 GroupTemplate，您可以使用它对项目进行分组并显示例如 TD 中的 3 个项目，这些项目在 TR 中分组。但是，没有交替组模板。我的问题是如何在 GroupTemplate 中替换 tr 的类属性。基本上我想在一个 TR 中有 3 个项目，并在奇数和偶数 TR 上交替使用样式。

我想避免将一个数据绑定控件嵌套在另一个控件中，并且我已经尝试在数据绑定表达式中绑定 TR 的类，`<%# Alternate() %>`但似乎数据绑定表达式仅在 itemtemplate 中调用（显然它们在数据绑定事件中使用，它是不需要组模板）

有任何想法吗？

示例代码：

```
 <asp:ListView ID="lv1" runat="server" EnableViewState="false" GroupItemCount="3">
    <LayoutTemplate>
        <table class="asd">
            <asp:PlaceHolder ID="groupPlaceholder" runat="server"></asp:PlaceHolder>
        </table>
    </LayoutTemplate>
    <GroupTemplate>
        <tr class='<%# GetAlternatingCssClass() %>'>
            <asp:PlaceHolder ID="itemPlaceholder" runat="server"></asp:PlaceHolder>
        </tr>
    </GroupTemplate>
    <ItemTemplate>
        <td>
            <asp:HyperLink runat="server" NavigateUrl='<%# Eval("Url") %>'> <%# Eval("Text") %> </asp:HyperLink>
        </td>
    </ItemTemplate>
</asp:ListView> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-10-28T13:34:17.827

[http://cshapin.blogspot.com/2010/06/listview-alternating-group-template.html](http://csharpin.blogspot.com/2010/06/listview-alternating-group-template.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T12:49:05.317

首先：

```
<GroupTemplate>
    <tr class='<%# GetAlternatingCssClass() %>'>
        <asp:PlaceHolder ID="itemPlaceholder" runat="server"></asp:PlaceHolder>
    </tr>
</GroupTemplate> 
```

只会对 ListView 进行一次评估，因为它是在处理页面时评估的，而不是每次访问元素时。要按照此处的预期实现这一点，我认为您需要覆盖 ListView 的 Render 方法，以根据 GroupItemCount 替换类。我没有对此进行编码，所以这是假设。

GroupTemplate 旨在提供一种流程布局，其中每个项目都是一个自包含的元素，即完整的产品列表，并且项目和行没有连接（就像一行中的单元格表示记录中的字段一样）。因此，交替行颜色对数据表示没有任何帮助，而纯粹是为了美观（并且可能会使习惯于以这种方式识别不同记录的用户感到困惑，这可能会导致他们对实际上不存在的数据关系进行推断） .

我认为你将不得不做很多工作才能从基本的 ListView 中获得你想要的东西，我认为要问自己的第一个问题是你为什么想要这个，它是用户要求还是你基于美学的要求（没有这本身就错了，但你明白这些控件是为功能而不是为美观而设计的）。如果这不是用户要求，他们是否愿意为解决这个问题付出努力？

# java - 如何在接受参数的构造函数上使用动态代理？

> ID：1001191
> 
> 赞同：4
> 
> 时间：2009-06-16T12:30:44.027
> 
> 标签：java, dynamic-proxy

我尝试使用 Sun 在其 [代理使用页面](http://java.sun.com/j2se/1.3/docs/guide/reflection/proxy.html)上发布的代码，并尝试使用 DebugProxy 打印调用了哪个方法。问题是，我正在为其创建代理的对象需要有一个参数。如果我尝试使用构造函数的参数创建代理，我会收到以下错误：

```
线程“主”java.lang.ClassCastException 中的异常：$Proxy0 无法转换为 myPackage.myClass
```

我创建了这样的代理：

```
 MyClass mc = (MyClass) DebugProxy.newInstance(new MyClass(props)); 
```

如何创建代理实例，并且仍然调用正确的构造函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T12:46:23.903

JDK 生成的代理与您代理的对象的类类型不同。相反，它实现了目标对象的相同接口。您需要转换为其中一种接口类型。

如果您查看链接到的页面上的示例，它会转换为 Foo，而不是 FooImpl。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T12:46:50.330

您的类是否实现了您要测试的某些接口？代理类只实现接口中的方法。如果您想在类的每个方法之前/之后打印（无论是用于度量还是调试），我建议使用面向方面的编程 (AOP)。我自己从来没有做过，但我听说[AspectJ](http://www.eclipse.org/aspectj/)是你想要的。

```
public interface SomeInterface {
    public void someMethod();
}

public MyClass implements SomeInterface {
...
}

// DebugProxy doesn't return your class, but a class which implements all of the interfaces
// you class implements
SomeInterface mc = (SomeInterface ) DebugProxy.newInstance(new MyClass(props)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T12:51:42.567

当你想创建一个代理时，你需要提供一个接口来实现。不是一个具体的类。

接口不描述构造函数，因此您想要做的事情并不是立即可行的。

# ruby - 去除/替换字符串中的空格

> ID：1001211
> 
> 赞同：15
> 
> 时间：2009-06-16T12:35:52.503
> 
> 标签：ruby, regex

给定一个字符串`"5 900 000"`

`gsub`我想使用以下模式摆脱空格：

```
gsub(/\s/, '') 
```

但这似乎不起作用。也没有：

```
gsub(' ', '') 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-06-16T12:40:36.833

如果要进行就地替换，则需要使用：

```
str.gsub!(/\s/,'') 
```

或者， gsub 返回带有替换的字符串

```
str2 = str.gsub(/\s/,'') 
```

**编辑**：根据您的回答，看起来您在字符串中嵌入了一些不可打印的字符，而不是空格。使用[/\D/](http://www.ruby-doc.org/docs/UsersGuide/rg/regexp.html)作为搜索字符串可能是您想要的。以下将匹配任何非数字字符并将其替换为空字符串。

```
str.gsub!(/\D/,'') 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-16T12:38:54.027

```
>> "5 900 00".gsub(' ','')
=> "590000" 
```

它真的是一个字符串吗？

.gsub 返回值，如果你想改变变量试试 .gsub!(" ", "")

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-16T13:50:15.770

只是为了好玩：你甚至需要一个正则表达式吗？`String#tr`应该做得很好：

```
telemachus ~ $ irb
>> "500 500 12".tr(' ', '')
=> "50050012"
>> "500 500 12".tr!(' ', '')
=> "50050012" 
```

与`gsub`and一样`gsub!`，该`!`方法在原地进行更改，而不是返回更改后的结果。我不知道你在这里想要什么。

在这样的情况下，`tr`对我来说似乎更直接。我不是在寻找优化，但最好记住除了正则表达式之外*还有很多字符串方法。*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-17T11:46:03.333

我建议`str.gsub!(/\s+/, '')`出于效率原因这样做。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-10-29T13:24:18.547

试试这个希望这会有所帮助：

```
2.2.1 :001> str= "  Jai   Kumar rajput ";
  # "  Jai   Kumar rajput "
2.2.1 :001> str.squish.downcase.tr(" ","");
  # "JaiKumarRajput" 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-16T12:42:43.740

`"5 900 000".gsub(/\s/,'')`工作正常

从我看到你写的 gsub **dot** (foo,bar) 必须是**string.gsub(foo,bar)**

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T12:41:01.310

```
print "5 900 000".gsub(/\s/, '') 
```

为我工作。

您是否影响变量的结果？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-16T12:42:48.137

你的意思是

```
str.gsub!.(/\s/,'') 
```

带感叹号？

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-16T12:54:49.410

有趣的是，当我打印字符串时，我得到

697\302\240000

但进入数据库的是：697 000。我知道我给出的模式应该和你的建议一样有效，但这似乎有点“狡猾”的情况:-)

# python - Python C API：如何获取异常的字符串表示？

> ID：1001216
> 
> 赞同：12
> 
> 时间：2009-06-16T12:36:53.890
> 
> 标签：python, exception, python-c-api

如果我这样做（例如）

```
 open("/snafu/fnord") 
```

在 Python 中（并且该文件不存在），我得到一个回溯和消息

```
 IOError: [Errno 2] No such file or directory: '/snafu/fnord' 
```

我想用 Python 的 C API（即嵌入在 C 程序中的 Python 解释器）来获取上述字符串。我需要它作为字符串，而不是输出到控制台。

有了`PyErr_Fetch()`我可以得到异常的类型对象和值。对于上面的示例，该值是一个元组：

```
 (2, 'No such file or directory', '/snafu/fnord') 
```

从我得到的信息`PyErr_Fetch()`到 Python 解释器显示的字符串有没有简单的方法？（不涉及自己为每种异常类型构造此类字符串。）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T13:25:13.107

我认为 Python 异常是通过在异常实例上运行“str()”来打印的，这将返回您感兴趣的格式化字符串。您可以通过调用[`PyObject_Str()`](https://docs.python.org/3/c-api/object.html#c.PyObject_Str)此处描述的方法从 C 中获取它：

[https://docs.python.org/c-api/object.html](https://docs.python.org/c-api/object.html)

祝你好运！

**更新：**我有点困惑为什么返回给你的第二个元素`PyErr_Fetch()`是一个字符串。我的猜测是您收到了“非规范化异常”，需要调用`PyErr_NormalizeException()`以将该元组转换为“真实”异常，该异常可以将自己格式化为您想要的字符串。

# c# - 在验证器上设置 ControlToValidate

> ID：1001222
> 
> 赞同：1
> 
> 时间：2009-06-16T12:38:31.110
> 
> 标签：c#, asp.net, validation

我目前正在根据数据库信息重写动态表单。

此表单包含许多“特定于项目”的属性，每个属性都有一个控件和标签，例如 Category 有一个标有“Category”的标签和一个包含所有选项的 DropDownList。

我现在发现的问题是，这些中的每一个都是通过基于数据库中的一些信息（属性名称、选项和属性的类型，例如文本或下拉列表）以编程方式创建的，并且这些中的每一个都至少具有一个验证器，以确保输入的数据是正确的。

这提供了一个问题：当我将每个组件作为对象进行验证时，如何在验证器上设置 ControlToValidate（也以编程方式创建），而不是 aspx 上的静态事物？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T12:48:20.000

给动态控件一个 Id，然后使用该 Id 设置 ControlToValidate。像这样的东西：

```
ddl = new DropDownList();
ddl.Id = "ddlWithMyID";

val = new SomeTypeOfValidator();
val.ControlToValidate = "ddlWithMyID"; 
```

确保如果要处理来自动态创建的控件的事件以重新创建它们并为它们提供相同的 Id。这可以在 Page_Init 甚至 Page_Load 中完成。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T12:44:33.267

确保您的控件具有 ID 并相应地设置 Validator.ControlToValidate 属性。

# c# - 在 ADAM 中以编程方式管理自定义属性

> ID：1001230
> 
> 赞同：2
> 
> 时间：2009-06-16T12:40:17.520
> 
> 标签：c#, active-directory, schema, adam

是否每个人都以编程方式创建了自定义属性？（目前我刚刚使用了 Scheme 管理单元）

理想情况下，我希望（管理员）用户能够通过 Web 界面管理 ADAM 实例。我正在编写 Web 服务以能够执行诸如创建新用户之类的操作，但也要求通过 Web 前端创建自定义属性，

有人以前做过这个或有任何建议/链接吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T13:06:26.093

下面是一个向架构添加属性的示例 LDIF 文件。用您需要的值替换“X”、attributeID、attributeSyntax、schemaIDGUID 和其他值。以编程方式，您可能会尝试使用 LDAP 或使用 ADAM 的命令行实用程序发送此 LDIF 文件`ldifde`（我希望我能正确记住它的名称）。几年前，我实际上使用此 ldif 文件将新属性导入 ADAM...

```
dn: CN=Uid-Number,CN=Schema,CN=Configuration,CN=X
changetype: ntdsschemaadd
objectClass: top
objectClass: attributeSchema
cn: Uid-Number
attributeID: 1.2.840.113556.1.4.302.1.2.3.4.5.6.7
attributeSyntax: 2.5.5.9
isSingleValued: TRUE
rangeLower: 1
rangeUpper: 100000
showInAdvancedViewOnly: TRUE
adminDisplayName: Uid-Number
adminDescription: Uid-Number
instanceType: 4
oMSyntax: 2
searchFlags: 0
lDAPDisplayName: uidNumber
schemaIDGUID:: MnqWv+YM0BGihQCqADBJ4g==
systemOnly: FALSE 
```

不要忘记 Active Directory 只允许添加新的架构条目，您不能删除它们。我认为这也适用于 ADAM，所以在添加新条目时要小心。

# asp.net-mvc - ASP.NET MVC 文档在哪里？

> ID：1001237
> 
> 赞同：1
> 
> 时间：2009-06-16T12:41:33.100
> 
> 标签：asp.net-mvc

主页 (asp.net/mvc) 似乎只有入门指南和教程以及视频，但我找不到合适的文档（类、方法等）。任何可以帮助我的链接？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T12:43:47.293

这是 MSDN 的官方文档。

[http://msdn.microsoft.com/en-us/library/dd394709.aspx](http://msdn.microsoft.com/en-us/library/dd394709.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T13:18:04.307

我认为使用[ASP.NET MVC Source](http://aspnet.codeplex.com/SourceControl/BrowseLatest)比 Reflector 好得多

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-09-15T09:28:40.060

[*在我看来，Steve Sanderson 的Pro ASP.NET MVC 2 Framework*](https://rads.stackoverflow.com/amzn/click/com/1430228865)是最好的起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T12:44:26.230

[反光板](http://www.red-gate.com/products/reflector/)。

我是认真的。很多时候我无法从 ASP.NET MVC API 中脱颖而出，而那些时候我使用 Reflector 来查看它们是如何完成的以及它们在做什么。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-06-27T14:38:29.687

MVC 文档很差，这对于微软的标准来说很奇怪。最好的也是我认为最完整的参考资料是 Steven Sanderson 的[Pro ASP.NET MVC 2 Framework](https://rads.stackoverflow.com/amzn/click/com/1430228865)。我很久以前就放弃了 MSDN MVC 文档。

# asp.net - 如何确定一个 ASPX 页面的类？

> ID：1001247
> 
> 赞同：1
> 
> 时间：2009-06-16T12:43:26.950
> 
> 标签：asp.net, class, parsing

没有自己解析 ASPX 页面，有什么方法可以确定一个 ASPX 页面的类？

在我们的项目中，我们使用 VS2008 中的 Web 项目（而不是网站类型或项目），这为我们提供了整个站点的单个 DLL，这很棒。

现在我需要以编程方式确定 ASPX 站点的类别。

我**知道**ASPX 类与 aspx 文件具有相同的名称（当使用 VS 创建时），但是，文件名可能在生产中被重命名，因此将此类代码吹到 smitherins 中。

我们所有的 ASPX 页面都以基本的 @Page 指令开头：

```
<%@ Page ... Inherits="_CLASS_NAME_GOES_HERE_" %> 
```

那么，除了自己解析指令之外，我还有哪些其他选择？

**编辑添加：**

因为我们使用第三方软件来管理我们的门户，所以它需要一定的条件。

我正在尝试创建一个自定义属性来将页面标记为门户的“安全”，因此我们所有页面之间的链接都需要通过需要分析目标页面是否安全的函数进行解析。

**编辑澄清**

我看到这个问题可能不像我想象的那么清楚，那么让我试着澄清一下：

假设我们有一个特定页面的相对 URL，例如`"~/destination.aspx"`

我需要根据它的 URL 确定该页面的类别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T12:58:03.363

您可以在页面代码隐藏中尝试 this.GetType()

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-22T13:58:37.353

以下代码执行我认为您正在寻找的内容，但它使用了一种明确标记为“不打算直接从您的代码中使用”的方法：

```
string path = "~/MyPage.Aspx";
IHttpHandler handler = System.Web.UI.PageParser.GetCompiledPageInstance(path, Server.MapPath(path), HttpContext.Current);
Response.Write(handler.GetType().BaseType.FullName); 
```

这输出：

```
MyApp.MyPage 
```

您需要使用 GetType().BaseType，因为 ASP.NET 会为每个 .ASPX 页面动态创建一个新类，该类继承了代码隐藏类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T13:54:11.380

如果您拥有所有“安全”的页面，也许您可​​以从具有您需要的信息的同一个基类中派生它们。然后你可以只对基础进行类型转换。如果它失败了，那么你知道它不可能是安全的。

# java - Java中线程用户时间和线程cpu时间的区别

> ID：1001248
> 
> 赞同：6
> 
> 时间：2009-06-16T12:43:27.997
> 
> 标签：java, jmx

ThreadMXBean 有两种检索线程时间使用情况的方法：

*   [获取线程用户时间](http://java.sun.com/javase/6/docs/api/java/lang/management/ThreadMXBean.html#getThreadUserTime%28long%29)
*   [获取线程CPU时间](http://java.sun.com/javase/6/docs/api/java/lang/management/ThreadMXBean.html#getThreadCpuTime%28long%29)

两者有什么区别？

* * *

**更新 2**：如果我能够链接到 javadocs，*请*不要引用它们 - 我已经阅读过它们。

**更新**：这是我试图用来了解这些时间意味着什么的一些代码，但收效甚微：

```
ThreadMXBean threadMXBean = ManagementFactory.getThreadMXBean();
threadMXBean.setThreadContentionMonitoringEnabled(true);
long mainThreadId = getMainThreadId(threadMXBean);

logTimes("Start", threadMXBean, mainThreadId);

URL url = new URL("https://hudson.dev.java.net");
URLConnection connection = url.openConnection();

connection.getContent();

logTimes("After loading", threadMXBean, mainThreadId); 
```

输出是：

```
Start Tue Jun 16 16:13:40 EEST 2009 Cpu time : 80, user time: 60, waited: 0, blocked: 0
After loading Tue Jun 16 16:13:43 EEST 2009 Cpu time : 1,020, user time: 960, waited: 0, blocked: 0 
```

所以 cpu 和用户时间之间的差异从 20 毫秒增加到了 60 毫秒。那是因为使用 HttpUrlConnection 确实包含一些网络 I/O？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T12:49:12.307

正如您链接到自己的 API 文档已经指出的那样

**获取线程CPU时间**

> 如果实现区分用户模式时间和系统模式时间，则返回的 CPU 时间是线程在用户模式或系统模式下执行的时间量。

如果 JVM 的实现区分了用户模式和内核模式时间，那么这两个函数的结果可能会有所不同。

此外，该值仅精确到纳秒，如果偏移量 > 2^63，则该值存在溢出问题。JVM 还必须支持测量当前线程的 CPU 时间，并且必须启用它。

在 Win32 上，返回值应该与从[GetThreadTimes 函数获得的相同](http://msdn.microsoft.com/en-us/library/ms683237(VS.85).aspx)

`getThreadUserTime()`-> `lpUserTime * 100`//或类似的东西

`getThreadCpuTime()`-> `(lpKernelTime + lpUserTime) * 100`//或类似的东西

[以及对用户模式与内核模式](http://en.wikibooks.org/wiki/Windows_Programming/User_Mode_vs_Kernel_Mode)的更清晰参考

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-06-16T12:50:33.940

它在 javadocs 中进行了解释:-)。

> getThreadCpuTime：返回指定 ID 的线程的总 CPU 时间。
> 
> getThreadUserTime：返回指定ID的线程在用户态执行的CPU时间。

不同之处在于 getThreadCpuTime 还包括线程使用 CPU 但未处于用户模式的时间。这就像在设备驱动程序中，轮询 I/O 或类似的事情。

# jquery - 优化 jQuery 循环

> ID：1001256
> 
> 赞同：0
> 
> 时间：2009-06-16T12:44:45.013
> 
> 标签：jquery, loops

在处理大量数据时，有没有办法优化 jQuery 循环。浏览器在数据循环时往往会锁定，并且任何低于 IE8 的内容都会显示“脚本运行速度太慢”的消息。

我只是使用 jQuery.each(data, function(i, val) 从数据库中获取该字段的字段名称和值，然后使用该值自动填充该字段。

数据取自登录时生成的 json 文件。

任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T13:04:33.757

几天前最近一次关于高性能 JavaScript 的 Google Tech Talk 提到 .each() 有巨大的开销以及原因。

[http://www.youtube.com/watch?v=mHtdZgou0qU](http://www.youtube.com/watch?v=mHtdZgou0qU)

这些事情可能会涉及到修复。

你多久做一次这个手术？你能用 setTimeout 把它分解成更小的部分，并在你做的时候给你的用户一个进度条吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T13:04:26.300

将慢速循环迭代推送到服务器并创建一个引人注目的糖果，让用户在等待来自服务器的结果时保持忙碌。如果循环的结果不是阻塞，则向服务器发送回调函数并让用户继续其工作流程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T13:31:06.137

我在遍历结果时遇到了同样的问题，并且我不使用 each() 函数。发生在 ajax 回调函数中的阻塞行为会锁定页面，包括任何“加载”指示器。

我尚未实现的一种解决方案是让 ajax 以递归方式将结果提取到“块”中，并一次显示 x 个结果（20？50？）。这样用户就可以立即获得反馈，并且不会出现锁定的感觉。

也许这样的东西可以为你工作 -

# c# - RadPanelBar 控件在动态添加项目后消失

> ID：1001259
> 
> 赞同：0
> 
> 时间：2009-06-16T12:45:13.203
> 
> 标签：c#, asp.net, telerik

我有一个关于 Telerik RadPanelBar 控件的问题。

例如，我们在表单上有一个 RadPanelBar 控件：

```
 <telerik:RadPanelBar ID="testPanelBar" runat="server">
        </telerik:RadPanelBar> 
```

和一个在运行时向此 RadPanelBar 添加新项目的按钮：

```
 RadPanelItem newParentItem = new RadPanelItem();
        RadPanelItem newChildItem = new RadPanelItem();
        newChildItem.Controls.Add(new RadTextBox());
        newChildItem.Text = "wazzap";
        newParentItem.Items.Add(newChildItem);
        languagesPanelBar.Items.Add(newParentItem); 
```

当我单击按钮时，新的 RadPanelItem 与所有子控件一起添加（在这种情况下，它是子项中的 RadTextBox）

当第二次单击按钮时，第二个 RadPanelItem 与所有控件一起添加，但这次 RadTexBox 控件从第一个 RadPanelItem 中消失了。

第三次单击按钮时相同，所有控件都添加了新项目，但 RadTextBox 将从第一个和第二个项目中消失。

动态添加项目时我做错了吗？

谢谢你 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T13:45:56.450

发生这种情况是因为添加到其他动态创建的控件的动态创建的控件在回发后丢失。您需要在每次页面加载时重新创建它们。据我所知，这个问题没有解决方法。您也可以使用 Page 类轻松重现它，在 page_load 上尝试 Controls.Add(new TextBox()); 然后在回发之后，相同的代码不会生成新的（第二个）文本框，而是会重新创建后者。

所有 PanelBar 项目（甚至是动态创建的项目）都在客户端上序列化，并且在服务器上重新创建回发之后。这就是他们没有迷路的原因。但是，同样的事情不适用于 RadPanelItem 对象的子控件。

# asp.net-mvc - 如何删除 MVC URL 路由中的“详细信息”，但保留其他操作不变？

> ID：1001261
> 
> 赞同：2
> 
> 时间：2009-06-16T12:45:52.687
> 
> 标签：asp.net-mvc, asp.net-mvc-routing

我想为具有正常 CRUD 操作的控制器设置路由，但希望详细信息操作不在 URL 中显示“详细信息”。Stackoverflow 似乎配置了这种类型的路由：

```
http://stackoverflow.com/questions/999999/
http://stackoverflow.com/questions/ask 
```

使用这个类比，我的路线目前看起来像：

```
http://stackoverflow.com/questions/Details/999999/ 
```

通过添加以下路线，我能够被`Details`删除：

```
routes.MapRoute("Q1", "questions/{id}", 
    new { controller = "Questions", action = "Details" }); 
```

但是，拉起控制器上的其他操作（例如`/questions/new`对于此示例）抱怨无法解析 id。

有没有办法设置路线，这样我就不必手动将所有其他操作（MapRoute“items/create”、“items/delete”等）手动输入到 Global.asax.cs 中？我基本上希望有第二条路线，例如：

```
routes.MapRoute("Q2", "questions/{action}", 
    new { controller = "Questions", action = "Index" }); 
```

`{id}`...如果匹配一个整数，并且`{action}`如果它是一个字符串，则让路由引擎使用路由 Q1 。这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T12:50:42.350

如果您在第一个上设置路由约束，以便 id 字段只能是整数，那么我相信任何其他操作都将采用默认设置。

```
routes.MapRoute("Q1", 
   "questions/{id}", 
   new {controller = "Questions", action = "Details"},
   new { id=@"\d+" }); 
```

其他任何事情都应该由默认路由处理。所以“questions/3553”会命中这个，但“questions/ask”会不匹配。您可能希望将更具体的路线放在您的 Global.asax.cs 文件中。

# c - 在 C 中访问大于 UINT_MAX*4 大小的内存？

> ID：1001262
> 
> 赞同：0
> 
> 时间：2009-06-16T12:46:05.167
> 
> 标签：c, pointers, long-integer

假设我有一个大小为 78719476736 字节的数组。请注意，这个数组是在我的 C 代码中使用 malloc 动态分配的。假设 malloc 在分配这么多内存后返回一个有效指针。该数组的大小大于 UINT_MAX(4294967295) ，即无符号整数的最大限制（32 位）

假设我的代码如下所示

```
int *buf;
buf = (int*)malloc(78719476736); 
```

这里 78719476736 大于 4 * UINT_MAX。

现在，如果我必须引用 buf 的所有元素，那么由于 buf 是 int* 它将是 32 位的，因此它将无法处理我使用 malloc 分配的所有内存元素（78719476736 字节）。

我的问题是不应该将上面的代码更改为使 buf 为 long（64 位变量），因为只有 long long 变量才能解决我分配的大内存。

更改代码例如

```
unsigned long long int buf;
buf = (unsigned long long int*)malloc(78719476736); 
```

事实上我认为，变量 buf 不应该再是一个指针，因为任何指针都将是 32 位宽，因此它将无法访问 78719476736 字节。

所以它应该是一个普通的 unsigned long long int ，我必须将 malloc 返回指针值转换为一个 unsigned long long int ，如上面更改的代码所示，并使用 buf 访问所有分配的元素。

我的上述假设是否正确？

或者

我是否感到困惑/遗漏了什么？

编辑：如果有帮助，

我正在使用在 Intel Core 2 Duo（64 位 CPU）上安装 WinXP 的台式机。所以从 CPU 角度来说，访问超过 4 GB 的地址空间应该不是问题。应该启用哪些所有其他组件以支持 64 位，即

a.) 如何在编译时启用对 64 位的编译器支持（我使用的是 Visual Studio 2005 专业版）

b.) 操作系统支持 64 位 - 我使用的是 Windows XP Professional。

谢谢你。

-广告。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T12:49:58.763

1.  您需要 64 位操作系统
2.  malloc 接收 size_t 作为 64 位平台上的 64 位参数
3.  **最重要的是：**您可能应该想：我是否需要分配超过 4G 的内存？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T13:03:46.927

我认为您对指针是什么感到非常困惑。至少在通用系统上，指针的大小（不同值的数量，即不同地址的数量）与类型无关！

```
int *a;
short *b;
double *c; 
```

a、b 和 c 是指向不同类型的指针，但它们都具有相同的大小（例如，在 32 位系统上为 4 个字节）。与 32 位相比，这正是 64 位系统的要点：能够从指针寻址超过 2**32 个位置。

此外，32 位 CPU 在硬件中也无法寻址超过 4 Gb [1]，相应的虚拟地址空间也通常限制为 32 位。因此分配 8 Gb 内存无论如何都不太可能工作。

[1] 这并不完全正确——例如，英特尔 CPU 具有扩展功能，因此 32 位 CPU 可以使用“扩展”地址。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T12:51:29.523

An`int*`是指针类型。如果您在一个可以分配 78719476736 字节的系统上，它可能至少有 64 位地址，即`sizeof(int*) >= 8`. 指针大小与什么无关`sizeof(int)`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T12:51:16.560

要处理超过 4GB 的内存，您需要某种机制来选择该内存。因此，您需要将您的应用程序编译为 64 位，然后您的所有指针都将是 64 位宽。

访问超过 4GB 内存的唯一其他方法是使用额外的地址/内存选择器机制，就像您在实模式 DOS 时代使用的段和偏移量一样。这当然取决于您的处理器架构。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T12:51:28.837

如果您在 64 位操作系统上运行您的软件并使用 64 位编译器设置，那么您的所有指针都是 64 位的。无需特别声明。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-07-14T06:45:16.357

这是不可能的，你的编译器和操作系统不支持，期间。

对于 Windows，您可以查看[_HEAP_MAXREQ](http://msdn.microsoft.com/en-us/library/6ewkz86d.aspx)的文档。

阅读一些选项，

[64 位大型 malloc](https://stackoverflow.com/questions/833234/64-bit-large-mallocs/938583#938583)

# .net - MSBuild 使用项目引用正确构建项目，但不是来自解决方案

> ID：1001264
> 
> 赞同：10
> 
> 时间：2009-06-16T12:46:50.250
> 
> 标签：.net, msbuild

当我构建一个包含 2 个项目 B.csproj 和 C.csproj 的 A.sln 时，它具有内部项目引用，它会在 MSBuild 中引发引用错误。但是当我在 MSBuild 中分别构建 B.csproj 和 C.csproj 时，它不会抛出错误。而且在 VS IDE 中构建 A.sln 也不会抛出错误。我使用的是 .NET 2.0 框架。请在下面找到用于构建 sln 和 projs 的脚本。

```
MSBuild "<path>/A.sln" /p:Configuration=Release /p:StartupObject="" /p:WarningLevel=4 /p:Optimize=true /t:rebuild /l:Filelogger,Microsoft.Build.Engine;logfile=F:\A.sln.log /verbosity:normal

MSBuild "<path>/B.csproj" /p:Configuration=Release /p:StartupObject="" /p:WarningLevel=4 /p:Optimize=true /t:rebuild /l:Filelogger,Microsoft.Build.Engine;logfile=F:\B.csproj.log /verbosity:normal 

MSBuild "<path>/C.csproj" /p:Configuration=Release /p:StartupObject="" /p:WarningLevel=4 /p:Optimize=true /t:rebuild /l:Filelogger,Microsoft.Build.Engine;logfile=F:\C.csproj.log /verbosity:normal 
```

编辑：

抛出的所有错误都来自缺少引用的代码（都是项目引用）。我只收到三种类型的错误，如下所示。

> 错误 CS0012：类型“X”在未引用的程序集中定义。您必须添加对程序集“Y，Version=2.0.0.0，Culture=neutral，PublicKeyToken=aad4cbe5d7c27078”的引用。
> 
> 错误 CS0234：命名空间“Y”中不存在类型或命名空间名称“X”（您是否缺少程序集引用？）
> 
> 错误 CS0246：找不到类型或命名空间名称“X”（您是否缺少 using 指令或程序集引用？）

在从 IDE 和 MSBuild 构建之前，我从构建路径中清除了所有以前构建的 dll。但是 IDE 工作正常，并且不会在项目的“参考”部分显示参考缺失指示器。

IDE 中没有手动添加参考路径。

另一个更新：

我刚刚注意到，当我从解决方案打开两个项目时，引用正确指向 IDE。但是当我在 IDE 中单独打开项目时，我提到的在 MSBuild 中出现的缺失引用会逐渐增加。很奇怪。

所以总结一下，

> 在 MSBuild 中构建 .proj - 好
> 
> Buiilding .proj in IDE - Error
> 
> Buiilding .sln in MSBuild - Error
> 
> Buiilding .sln in IDE - Good

Looks very wierd for me. Help much much appreciated.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-09-14T06:06:04.873

MSBuild and VS both use project references and project dependencies to choose the solution build order. Beyond that, it's undefined - and typically different between the two. Check both of these are correct. Project dependencies are set in the properties of your solution. If that doesn't work, double check the GUIDs in the project references in your projects match the ones in the solution. Sometimes recreating the solution can fix them.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-11-11T19:57:27.757

For me, when I've had this (or a similar) problem, manually checking (and fixing) the guids line up fixes my problem. It's annoying to trace down guids between .sln and .csproj files, but it works.

I usually drop the project reference and re-add it, and that fixes the problem (once I've found the offending mismatched guids). Maybe I should just try that first. It's easier.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T13:30:05.907

Some things to consider: building a solution in the IDE is not the same as running MSBUILD on the .sln file. You might try using devenv.exe /rebuild A.sln instead. The IDE plays several games to allow a .sln file to build, including creating an "equivalent" MSBUILD-style project.

Also, the IDE does not directly just spawn off MSBUILD commands. There is interaction between the two in order to improve performance. For instance, the CSC tasks in the project are probably being executed inside the IDE, instead of as separate command-line builds, as MSBUILD would have spawned them.

You should also consider getting Process Monitor from [http://technet.microsoft.com/sysinternals/](http://technet.microsoft.com/sysinternals/) in order to watch which files are being accessed.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T12:53:52.547

As Jon Skeet mentioned, an error message would be helpful to knowing what the problem is. Without any details, though, if it builds in the IDE but doesn't build in MSBuild, it sounds like you might have DLLs you are referencing in your projects that are not available in the path where you are building the solution. Perhaps you manually were copying them to somewhere the IDE could find them, or you had reference paths set up in your IDE to look in a certain folder.

Just something to check while you're getting those other details onto the question.

**EDIT:** Now that there are some details, it could be an order of build problem. Is there a project reference in project B to project C? If so, you may just need to change the order to build project C before project B.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-01-18T23:51:06.907

Remove the assembly from GAC(C:\WINDOWS\assembly folder - select your assebly and right click and uninstall).

Because solution keeps reference using guid and if that guid is in GAC, it will keep taking GAC version for compilation.

# db2 - 如何卸载具有 ROWID 数据类型的字段的表？

> ID：1001269
> 
> 赞同：1
> 
> 时间：2009-06-16T12:48:13.417
> 
> 标签：db2, zos

我必须卸载包含具有 ROWID 数据类型的字段的表。我无法通过 QMF 卸载该表，因为它不支持此数据类型。有没有其他方法可以卸载表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-11-06T04:18:30.283

在 DB2 中，ROWID 为 RDMS 提供了比最终用户所允许的更多的内部功能。这是故意的。见链接：

[http://publib.boulder.ibm.com/infocenter/dzichelp/v2r2/index.jsp?topic=/com.ibm.db2.doc.sqlref/xf7c63.htm](http://publib.boulder.ibm.com/infocenter/dzichelp/v2r2/index.jsp?topic=/com.ibm.db2.doc.sqlref/xf7c63.htm)

但是，如果您不需要 ROWID 属性（将数据用于只读目的），则可以模拟此表的卸载/加载。

您可以使用 EXPORT / IMPORT 命令执行卸载/加载功能，这应该支持 ROWID，但如果不支持，则可以通过将不支持的数据类型 ROWID 转换为支持的数据类型来实现相同的功能。唯一的问题是，一旦这样做，您将无法将数据转换回此数据类型。换句话说，ROWID 的所有属性现在都将是一个常规的 INTEGER 字段。

```
select INTEGER(ROWID)  as int-rowid
     , col2
     , coln
  from table
 order by 1 
```

然后您可以执行 EXPORT / IMPORT 命令来卸载 / 加载数据。

警告：一旦你摆脱了 ROWID 属性，你就无法恢复它。换句话说，此表的 INSERTS 不会自动增加 ROWID 字段。

# java - Java中基于控制台的进度

> ID：1001290
> 
> 赞同：36
> 
> 时间：2009-06-16T12:51:48.150
> 
> 标签：java, console, progress-bar, refresh

是否有简单的方法可以在 Java 中实现进程的滚动百分比，以显示在控制台中？我有一个在特定过程中生成的百分比数据类型（双精度），但我可以将它强制到控制台窗口并刷新它，而不是为每个新的百分比更新打印一个新行吗？我正在考虑推送 cls 和更新，因为我在 Windows 环境中工作，但我希望 Java 具有某种内置功能。欢迎所有建议！谢谢！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2009-06-16T13:03:30.513

您可以打印回车`\r`将光标放回行首。

例子：

```
public class ProgressDemo {
  static void updateProgress(double progressPercentage) {
    final int width = 50; // progress bar width in chars

    System.out.print("\r[");
    int i = 0;
    for (; i <= (int)(progressPercentage*width); i++) {
      System.out.print(".");
    }
    for (; i < width; i++) {
      System.out.print(" ");
    }
    System.out.print("]");
  }

  public static void main(String[] args) {
    try {
      for (double progressPercentage = 0.0; progressPercentage < 1.0; progressPercentage += 0.01) {
        updateProgress(progressPercentage);
        Thread.sleep(20);
      }
    } catch (InterruptedException e) {}
  }
} 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2016-08-31T19:51:44.760

我使用以下代码：

```
public static void main(String[] args) {
    long total = 235;
    long startTime = System.currentTimeMillis();

    for (int i = 1; i <= total; i = i + 3) {
        try {
            Thread.sleep(50);
            printProgress(startTime, total, i);
        } catch (InterruptedException e) {
        }
    }
}

private static void printProgress(long startTime, long total, long current) {
    long eta = current == 0 ? 0 : 
        (total - current) * (System.currentTimeMillis() - startTime) / current;

    String etaHms = current == 0 ? "N/A" : 
            String.format("%02d:%02d:%02d", TimeUnit.MILLISECONDS.toHours(eta),
                    TimeUnit.MILLISECONDS.toMinutes(eta) % TimeUnit.HOURS.toMinutes(1),
                    TimeUnit.MILLISECONDS.toSeconds(eta) % TimeUnit.MINUTES.toSeconds(1));

    StringBuilder string = new StringBuilder(140);   
    int percent = (int) (current * 100 / total);
    string
        .append('\r')
        .append(String.join("", Collections.nCopies(percent == 0 ? 2 : 2 - (int) (Math.log10(percent)), " ")))
        .append(String.format(" %d%% [", percent))
        .append(String.join("", Collections.nCopies(percent, "=")))
        .append('>')
        .append(String.join("", Collections.nCopies(100 - percent, " ")))
        .append(']')
        .append(String.join("", Collections.nCopies(current == 0 ? (int) (Math.log10(total)) : (int) (Math.log10(total)) - (int) (Math.log10(current)), " ")))
        .append(String.format(" %d/%d, ETA: %s", current, total, etaHms));

    System.out.print(string);
} 
```

结果： [![在此处输入图像描述](../Images/5332bdf7c346cab271f3bc5fa47e9611.png)](https://i.stack.imgur.com/RF1kC.gif)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-06-18T14:02:39.990

我已经用 Java 编写了这样的包。

[https://github.com/ctongfei/progressbar](https://github.com/ctongfei/progressbar)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-06-16T12:56:41.807

我认为没有内置功能可以满足您的需求。

有一个库可以做到这一点（JLine）。

看这个[教程](http://luka.tnode.com/blog/2007/07/java-console-progress-bar)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-06-16T12:58:26.717

我很确定没有办法更改控制台已经打印的任何内容，因为 Java 认为控制台（标准输出）是一个 PrintStream。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-16T12:58:35.983

不知道 java 本身内置的任何内容，但您可以使用终端控制代码来执行重新定位光标等操作。这里有一些细节：[http ://www.termsys.demon.co.uk/vtansi.htm](http://www.termsys.demon.co.uk/vtansi.htm)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T13:02:23.590

通过运行特定于操作系统的命令清除控制台，然后打印新的百分比

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-18T20:52:31.890

```
import java.util.Random;

public class ConsoleProgress {

    private static String CURSOR_STRING = "0%.......10%.......20%.......30%.......40%.......50%.......60%.......70%.......80%.......90%.....100%";

    private static final double MAX_STEP = CURSOR_STRING.length() - 1;

    private double max;
    private double step;
    private double cursor;
    private double lastCursor;

    public static void main(String[] args) throws InterruptedException {
        // ---------------------------------------------------------------------------------
        int max = new Random().nextInt(400) + 1;
        // ---------------------------------------------------------------------------------
        // Example of use :
        // ---------------------------------------------------------------------------------
        ConsoleProgress progress = new ConsoleProgress("Progress (" + max + ") : ", max);
        for (int i = 1; i <= max; i++, progress.nextProgress()) {
            Thread.sleep(3L); // a task with no prints
        }
    }

    public ConsoleProgress(String title, int maxCounts) {
        cursor = 0.;
        max = maxCounts;
        step = MAX_STEP / max;
        System.out.print(title);
        printCursor();
        nextProgress();
    }

    public void nextProgress() {
        printCursor();
        cursor += step;
    }

    private void printCursor() {
        int intCursor = (int) Math.round(cursor) + 1;
        System.out.print(CURSOR_STRING.substring((int) lastCursor, intCursor));
        if (lastCursor != intCursor && intCursor == CURSOR_STRING.length())
            System.out.println(); // final print
        lastCursor = intCursor;
    }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-05-18T19:52:27.993

派对迟到了，但这里有一个答案：

```
public static String getSingleLineProgress(double progress) {
    String progressOutput = "Progress: |";
    String padding = Strings.padEnd("", (int) Math.ceil(progress / 5), '=');
    progressOutput += Strings.padEnd(padding, 0, ' ') + df.format(progress) + "%|\r";
    if (progress == 100.0D) {
        progressOutput += "\n";
    }
    return progressOutput;
} 
```

记得使用`System.out.print()`而不是`System.out.println()`

# sql-server - 数据库结构查看器/打印

> ID：1001292
> 
> 赞同：1
> 
> 时间：2009-06-16T12:52:36.027
> 
> 标签：sql-server, database

我有一个 SQL Server 数据库，其中有 60 多个表。这个数据库在这些表之间有很多关系，虽然它是规范化的，但由于表的数量很大，使用起来仍然很复杂。

当然，有许多工具可以在某些图表中显示数据库结构。SQL Server 本身甚至能够创建这样的图表。现在，我更喜欢使用 Altova 的 DatabaseSpy。但是，虽然这个工具对结构有很好的可视化显示，但它不能很好地打印结构。（嗯，它可以打印图表，但没有结构的描述性文本。）

因此，我正在寻找一种用于 SQL Server 的工具，该工具能够创建图表并打印这些图表**以及**描述所有字段和链接的附加文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T12:59:19.913

SQL Server 数据库图表有什么不足？

无论如何，我出人意料的建议是尝试[Sparx Enterprise Architect](http://www.sparxsystems.com)。虽然主要不是数据库工具，但它可以将数据库逆向工程为 ER 模型，然后您可以从该模型创建一个或多个图表。它有一个很好的“添加相关元素”命令，允许您创建一个新图表以专注于一个实体；将一个实体拖到图表上；然后只添加与第一个相关的其他实体。

您还可以自定义图表上显示的详细程度，并将图表打印为一页或多页。

哦，它也支持 UML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T13:30:03.083

任何超过二十张左右的表格总是很难全面绘制图表并且有用/用户友好。

你应该看看今天提出的以下问题：

> [如何用 500 个表制作 ER 图？(SO)](https://stackoverflow.com/questions/1000872/how-to-make-e-r-diagram-with-500-tables)
> [如何用 500 个表制作 ER 图？（我的答案）](https://stackoverflow.com/questions/1000872/how-to-make-e-r-diagram-with-500-tables/1000988#1000988)

一般意见/共识是不要尝试一个大图表，而是将数据库分解为更小的可管理表组的多个图表（例如基于功能或其他一些关系）。

凯夫

# html - 将文本和图像彼此相邻放置而不换行并控制图像的垂直位置..？

> ID：1001293
> 
> 赞同：1
> 
> 时间：2009-06-16T12:53:03.047
> 
> 标签：html, css

我想在我的网站上的用户名旁边放置一个小图片，访问者可以点击。图像是一个图标（16x16 像素不能更改！），它需要显示得比文本低一点。我不知道用户名会有多少个字符，但整个文本+图像不应该被包裹在多行中......

**如何做到这一点？**

示例（显然不适用于我的要求......）：

```
<style type="text/css">
    div.userlink {height:20px;whitespace:no-wrap;}
</style>

<div class="userlink">
    <span class="text">The_username_of_unknown_length</span>
    <span class="image"><a href="#"><img src="/theicon.jpg" /></a></span>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T13:01:42.623

您可以使用负边距底部控制图像的垂直对齐方式。我也不认为您需要内部跨度元素，请始终记住标记越少越好。但是，我不确定您是否可以在不将 div 放置在足够宽的容器中以适应它的情况下防止包装。

```
<style type="text/css">
    div.userlink {position:relative;height:20px;whitespace:no-wrap;}
    div.userlink a {margin-bottom: -2px;}
</style>

<div class="userlink">
    The_username_of_unknown_length
    <a href="#"><img src="/theicon.jpg" /></a>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T13:13:45.003

**选项＃1（不完美 - 但没有编程）：**

```
<div id="userlink">
    <div class="text">The_username_of_unknown_length</div>
    <a href="#"><img class="userimg" src="image.gif"/></a>
</div>

#userlink {
    height: 20px;
    whitespace:no-wrap;
    overflow: hidden;
}

.text {
    float: left;
}

.userimg {
    float: left;
    margin-top: 3px;
    margin-left: 3px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T13:05:52.600

这是一个解决方案，但用户名是可点击的：

```
<html>
<head>
<style>
a.userlink {
    background: url('/theicon.jpg') no-repeat left bottom;
    padding-left: 20px;
    display: block;
    height: 20px;
    line-height: 20px;
    overflow: hidden;
}
</style>
</head>
<body>
<a class="userlink" href="#">The_username_of_unknown_length</a>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T13:10:29.703

有几个答案：1）给你的两个跨度显示：块；并且带有文本的必须具有行高 2）float:left 用于图像和行高

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T13:11:51.073

此解决方案适用于 IE7、Firefox、Safari、Chrome 和 Opera：

```
<style type="text/css">

div.userlink {
    overflow:hidden;
    position: relative;
    height: 25px;
    line-height: 25px;
}
span.image {
    position: absolute;
    left: 0px;
    top: 5px;
}
span.text {
    margin-left: 25px;
}

</style>

<div class="userlink">
    <span class="text">The_username_of_unknown_length</span>
    <span class="image"><a href="#"><img src="/theicon.jpg" /></a></span>
</div> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T14:45:37.873

**选项 #2（如果名称很长则停止换行）：如果名称** 超过 32 个字符，此函数会切断名称并在名称末尾添加三个“...”。

```
#userlink {
    height: 20px;
    whitespace:no-wrap;
    overflow: hidden;
}

.text {
    float: left;
}

.userimg {
    float: left;
    margin-top: 3px;
    margin-left: 3px;
}

    <?php
    function format_name( $name ) {
        $maxNameLength = 32;
            if ( strlen($name) > $maxNameLength ) {
            $name = substr($name, 0, $maxNameLength - 3)."...";
        }
        return $name;
    }

    $name = "The username of unknown length";
    $name = format_name($name);
    ?>
    <div id="userlink">
        <div class="text"><?php echo $name; ?></div><a href="#">
        <img class="userimg" src="image.gif" /></a>
    </div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T14:46:27.560

**选项＃3：（如果名称太长并且不缩短名称，则停止换行）：**

```
#userlinkDiv {
    height: 20px;
    display: table;
}

.userlink {
    display: block;
    padding-right: 24px;
    text-decoration: none;
    color: black;
}

     <?php
        function noBreakName( $name ) {
            $name = str_ireplace(" ", '& nbsp;', $name);
            return $name;
        }
        $name = "The username of unknown length";
        $name = noBreakName($name);
     ?>
    <div id="userlinkDiv" style="background: url('image.gif') no-repeat right bottom;">
        <a class="userlink" href="#"><?php echo $name; ?></a>
    </div> 
```

注意＃1：需要在上面的函数中将“&”和“nbsp”放在一起（如果我将它们放在一起，它将不会在本网站上显示文本）。

注意＃2：我将图像设置为内联样式，因为您说您希望为每个用户使用不同的样式。

注意＃3：我建议您在样式的 userlinkDiv 部分中添加您希望文本区域的最大宽度。

# winforms - 将 WinForms 复选框绑定到 SubSonic DAL 布尔值的问题

> ID：1001294
> 
> 赞同：1
> 
> 时间：2009-06-16T12:53:11.097
> 
> 标签：winforms, subsonic

我正在尝试将 SubSonic 2.1 生成的 DAL 对象绑定到 WinForm (VB.NET VS2005)。为了解决缺少 IPropertyNotifyChanged 实现的问题，在我的绑定方法中，我在我要绑定的每个控件的 controlname.DataBindings.Add() 之前执行 controlname.DataBindings.Clear()。

文本框可以很好地处理这样的代码（ioBLL 是对我的 BLL 对象的引用，ioDAL 是对其中的 DAL 属性的引用）：

```
txtCountryName.DataBindings.Add(New Binding("Text", ioBLL.ioDAL, namespace.Country.Schema.Columns.GetColumn("CountryName").ToString, True, DataSourceUpdateMode.OnPropertyChanged)) 
```

但是当绑定到一个复选框时

```
chkObsolete.DataBindings.Add(New Binding("Checked", ioBLL.ioDAL, namespace.Country.Schema.Columns.GetColumn("Obsolete").ToString, True, DataSourceUpdateMode.OnPropertyChanged)) 
```

当基础属性值为 True 时，它​​永远不会在运行时出现勾选。

任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-22T07:29:41.920

Is ioBLL.ioDAL.Obsolete a boolean ?

I use very similar code without problems.

Perhaps the only difference is that I use a BindingSource.

IE I use a bindingsource on my form and set it's DataSource to ioBLL.

Ive had other issues binding controls directly to my entities, but I dont recall the problem you describe as being one of them.

# matlab - MATLAB 中的用户定义函数

> ID：1001296
> 
> 赞同：2
> 
> 时间：2009-06-16T12:54:11.627
> 
> 标签：matlab, image

我需要为`imread`图像编写一个函数并将其转换为灰度。这个对吗：

```
function trial()

O = imread('m1.png');
G = rgb2gray(O);
imwrite(G,'s','jpg');

end 
```

还是有更好的写法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T13:40:09.583

您走在正确的轨道上，但我同意[Dan](https://stackoverflow.com/questions/1001296/user-defined-functions-in-matlab/1001317#1001317)的观点，即您应该添加输入参数以使其更普遍可用。每次要使用硬编码文件名时都必须更改它并不理想。

如果这个功能是为别人设计的，或者只是给自己使用，我建议添加[H1 行](http://www.mathworks.com/access/helpdesk/help/techdoc/matlab_prog/f7-41453.html#f7-38702)、[帮助文本](http://www.mathworks.com/access/helpdesk/help/techdoc/matlab_prog/f7-41453.html#f7-38710)和输入类型检查。例如：

```
function make_grayscale(inFile,outFile)
% MAKE_GRAYSCALE Converts an RGB image to grayscale
%    MAKE_GRAYSCALE(INFILE,OUTFILE) converts a truecolor RGB image stored in
% INFILE to a grayscale intensity image and writes it to OUTFILE.

  if ~ischar(inFile) || ~ischar(outFile),
    error('File name arguments must be character strings!');
  end

  ...(rest of function)...

end 
```

许多人低估了这些东西的用处。当您将一个函数搁置几个月时，很容易忘记您编写它的具体行为方式。帮助会提醒您（或其他人）如何使用它，错误检查有助于在您做错事时提供有用的信息。此外，具有描述性的 H1 行使您可以选择使用[LOOKFOR](http://www.mathworks.com/access/helpdesk/help/techdoc/ref/lookfor.html)来查找您可能忘记了名称的函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T12:58:30.150

该解决方案有效，但您可以通过接受参数使其更灵活：

```
function trial(inputName, outputName)
    o = imread(inputName);
    g = rgb2gray(o);
    imwrite(g, outputName, 'jpg') 
```

这样，您可以批量运行文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T13:53:04.953

此外，您可能希望让函数返回一些东西，以便您以后可以使用它。

```
function out = trial(imageName)

O = imread(imageName);
G = rgb2gray(O);
%imwrite(G,'s','jpg');
out = G;
end 
```

或者你喜欢的任何功能。这样你下次需要灰度时就不需要从磁盘调用它了。您可以在调用该函数的部分代码中更轻松地使用它。

```
x = trial('image.png') 
```

在大多数情况下可能比写入光盘更容易，因为我想你会在之后立即使用灰度图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T12:56:55.380

实际上，您的函数有点无用，可能只是一个脚本，因为该函数不接受任何参数。

您不需要 end 在文件末尾 - end 用于结束循环、条件等。

# netbeans - 如何让 Netbeans 6.5 使用我的文件 nb-build.xml 而不是 build.xml？

> ID：1001298
> 
> 赞同：4
> 
> 时间：2009-06-16T12:54:26.943
> 
> 标签：netbeans, ant, build

当我在 Netbeans 中创建一个新项目时，它会生成一个 build.xml 文件，它将用于编译和运行该项目，以及文件夹 nbproject 中的其他内容。

现在，我想要拥有自己的 build.xml 文件，我将使用它来编译以在服务器端进行项目。[有些](https://stackoverflow.com/questions/912522/run-netbeans-project-just-with-ant "仅使用 ant 运行 NetBeans 项目") [人](https://stackoverflow.com/questions/984605/how-do-i-create-a-new-java-project-without-existing-source-files-with-the-abili "如何在没有现有源文件的情况下创建新的 Java 项目，并能够使用 NetBeans 手动编辑 Ant 脚本")尝试在 Netbeans 和纯 Ant 中使用生成的构建文件，但这比它的价值更麻烦。

我想将自动生成的文件重命名为`nb-build.xml`并拥有 Netbeans 不会触及的我自己的 build.xml 文件。

我如何做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2011-10-19T16:44:18.220

进入`nbproject`项目目录中的目录，然后编辑文件`project.properties`. 查找如下所示的部分：

```
# Only compile against the classpath explicitly listed here:
build.sysclasspath=ignore
build.test.classes.dir=${build.dir}/test/classes
build.test.results.dir=${build.dir}/test/results 
```

并添加以下行：

```
buildfile=nb-build.xml 
```

当您下次在 NetBeans 中打开项目时，它将创建一个具有此名称的新文件，并开始忽略现有的 build.xml 文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-03-21T13:17:20.700

我们以这种方式解决了这个问题。假设您自己的 Ant 构建脚本名为“myBuild.xml”，并且与 build.xml 位于同一文件夹中 - 打开您的 build.xml 文件并将其内容替换为：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="payroll_web_ice_jq" default="default" basedir=".">    
    <condition property="import.path" value="myBuild.xml">
        <not><isset property="netbeans.user"/></not>
    </condition>
    <condition property="import.path" value="nbproject/build-impl.xml">
        <isset property="netbeans.user"/>
    </condition>

    <!-- conditional import. If triggered from NetBeans, use old build script
                if triggered from shell, user new build script -->
    <import file="${import.path}" />

</project> 
```

如您所见，我们检查是否存在“netbeans.user”属性，该属性仅应存在于 Netbeans 中而不应存在于命令行中。这对我们有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-17T11:58:38.067

创建项目时，您可以选择具有现有源的*Java 项目或具有现有源*的*Web 项目*选项。我相信这将尊重任何现有的 build.xml 文件并创建一个辅助构建文件。

在创建项目以使用现有构建脚本时还有一个选项，但是我相信此选项不会为您生成 Netbeans 构建脚本，而是仅依赖于所有构建的现有构建脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T11:53:03.240

尝试为 NetBeans 生成的 build-impl.xml 删除 build.xml 中的 import 语句（即`<import file="nbproject/build-impl.xml"/>`）并将其替换为您的 nb-build.xml 的导入（例如`<import file="nb-build.xml"/>`）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2011-05-24T16:31:21.003

像魅力一样工作：http: [//java.sun.com/developer/technicalArticles/java_warehouse/single_jar/](http://java.sun.com/developer/technicalArticles/java_warehouse/single_jar/)

# c++ - 在 C++ 程序中以编程方式检测字节顺序

> ID：1001307
> 
> 赞同：225
> 
> 时间：2009-06-16T12:56:53.587
> 
> 标签：c++, algorithm, endianness

有没有一种程序化的方式来检测你是在大端还是小端架构上？我需要能够编写将在 Intel 或 PPC 系统上执行的代码并使用完全相同的代码（即无条件编译）。

* * *

## 回答 #1

> 赞同：179
> 
> 时间：2009-06-16T13:08:04.500

我不喜欢基于类型双关的方法——编译器经常会警告它。这正是工会的目的！

```
bool is_big_endian(void)
{
    union {
        uint32_t i;
        char c[4];
    } bint = {0x01020304};

    return bint.c[0] == 1; 
} 
```

该原理等同于其他人建议的类型案例，但这更清楚 - 并且根据 C99，保证是正确的。与直接指针转换相比，gcc 更喜欢这个。

这也比在编译时修复字节序要好得多 - 对于支持多架构的操作系统（例如 Mac os x 上的胖二进制文件），这对 ppc/i386 都适用，否则很容易搞砸.

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2016-07-01T09:11:07.837

[`std::endian`](https://en.cppreference.com/w/cpp/types/endian)如果您可以访问 C++20 编译器，例如 GCC 8+ 或 Clang 7+，则可以使用。

注：`std::endian`开始于2019 年科隆会议，`<type_traits>`但[移至](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1612r1.pdf)该会议。`<bit>`GCC 8、Clang 7、8 和 9 包含它，`<type_traits>`而 GCC 9+ 和 Clang 10+ 包含它`<bit>`。

```
#include <bit>

if constexpr (std::endian::native == std::endian::big)
{
    // Big endian system
}
else if constexpr (std::endian::native == std::endian::little)
{
    // Little endian system
}
else
{
    // Something else
} 
```

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2009-06-16T13:00:53.500

您可以通过设置一个 int 并屏蔽位来做到这一点，但可能最简单的方法就是使用内置的网络字节转换操作（因为网络字节顺序总是大端）。

```
if ( htonl(47) == 47 ) {
  // Big endian
} else {
  // Little endian.
} 
```

位摆弄可能会更快，但这种方式简单、直接且几乎不可能搞砸。

* * *

## 回答 #4

> 赞同：68
> 
> 时间：2009-06-16T13:00:37.773

请看[这篇文章](http://vijayinterviewquestions.blogspot.com/2007/07/what-little-endian-and-big-endian-how.html)：

> 这是一些代码来确定您的机器的类型
> 
> ```
> int num = 1;
> if(*(char *)&num == 1)
> {
>     printf("\nLittle-Endian\n");
> }
> else
> {
>     printf("Big-Endian\n");
> } 
> ```

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2009-06-16T13:36:04.113

这通常在编译时完成（特别是出于性能原因），方法是使用编译器提供的头文件或创建您自己的头文件。在 linux 上，你有头文件“/usr/include/endian.h”

* * *

## 回答 #6

> 赞同：17
> 
> 时间：2009-06-20T19:15:07.617

我很惊讶没有人提到预处理器默认定义的宏。虽然这些会因您的平台而异；它们比编写自己的字节序检查要干净得多。

例如; 如果我们查看 GCC 定义的内置宏（在 X86-64 机器上）：

```
:| gcc -dM -E -x c - |grep -i endian
#define __LITTLE_ENDIAN__ 1 
```

在 PPC 机器上，我得到：

```
:| gcc -dM -E -x c - |grep -i endian
#define __BIG_ENDIAN__ 1
#define _BIG_ENDIAN 1 
```

（`:| gcc -dM -E -x c -`魔术会打印出所有内置宏）。

* * *

## 回答 #7

> 赞同：15
> 
> 时间：2011-05-04T01:11:06.490

嗯...令我惊讶的是，没有人意识到编译器只会简单地优化测试，并将固定结果作为返回值。这使得上面的所有代码示例都变得毫无用处。唯一会返回的是编译时的字节序！是的，我测试了上述所有示例。这是一个使用 MSVC 9.0 (Visual Studio 2008) 的示例。

**纯C代码**

```
int32 DNA_GetEndianness(void)
{
    union 
    {
        uint8  c[4];
        uint32 i;
    } u;

    u.i = 0x01020304;

    if (0x04 == u.c[0])
        return DNA_ENDIAN_LITTLE;
    else if (0x01 == u.c[0])
        return DNA_ENDIAN_BIG;
    else
        return DNA_ENDIAN_UNKNOWN;
} 
```

**拆卸**

```
PUBLIC  _DNA_GetEndianness
; Function compile flags: /Ogtpy
; File c:\development\dna\source\libraries\dna\endian.c
;   COMDAT _DNA_GetEndianness
_TEXT   SEGMENT
_DNA_GetEndianness PROC                 ; COMDAT

; 11   :     union 
; 12   :     {
; 13   :         uint8  c[4];
; 14   :         uint32 i;
; 15   :     } u;
; 16   : 
; 17   :     u.i = 1;
; 18   : 
; 19   :     if (1 == u.c[0])
; 20   :         return DNA_ENDIAN_LITTLE;

    mov eax, 1

; 21   :     else if (1 == u.c[3])
; 22   :         return DNA_ENDIAN_BIG;
; 23   :     else
; 24   :        return DNA_ENDIAN_UNKNOWN;
; 25   : }

    ret
_DNA_GetEndianness ENDP
END 
```

也许可以只为这个函数关闭任何编译时优化，但我不知道。否则，也许可以在汇编中对其进行硬编码，尽管这不是可移植的。即便如此，即使这样也可能会得到优化。这让我觉得我需要一些非常糟糕的汇编程序，为所有现有的 CPU/指令集实现相同的代码，而且……没关系。

另外，这里有人说字节序在运行时不会改变。错误的。那里有双端机器。它们的字节顺序在执行过程中会有所不同。ALSO，不仅有 Little Endian 和 Big Endian，还有其他的字节序（多么好的一个词）。

我既讨厌又喜欢编码……

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2009-06-16T13:00:05.577

声明一个 int 变量：

```
int variable = 0xFF; 
```

现在使用 char* 指针指向它的各个部分并检查这些部分中的内容。

```
char* startPart = reinterpret_cast<char*>( &variable );
char* endPart = reinterpret_cast<char*>( &variable ) + sizeof( int ) - 1; 
```

现在，根据哪个指向 0xFF 字节，您可以检测字节序。这需要 sizeof( int ) > sizeof( char )，但对于所讨论的平台来说绝对是正确的。

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2019-05-17T17:56:52.453

**不要使用`union`！**

C++ 不允许通过`union`s!
从不是最后写入的字段的联合字段中读取是**未定义的行为**！
许多编译器支持这样做作为扩展，但语言不保证。

有关更多详细信息，请参阅此答案：

[https://stackoverflow.com/a/11996970](https://stackoverflow.com/a/11996970)

* * *

只有两个有效的答案可以保证是可移植的。

如果您可以访问支持 C++20 的系统，第一个答案
是[`std::endian`](https://en.cppreference.com/w/cpp/types/endian)从头文件中使用[`<bit>`](https://en.cppreference.com/w/cpp/header/bit)。

### C++20 以后

```
constexpr bool is_little_endian = (std::endian::native == std::endian::little); 
```

* * *

在 C++20 之前，唯一有效的答案是存储一个整数，然后通过类型双关语检查它的第一个字节。与使用`union`s 不同，这是 C++ 的类型系统明确允许的。

同样重要的是要记住，`static_cast`应该使用最佳可移植性，
因为`reinterpret_cast`是实现定义的。

> 如果程序尝试通过非下列类型之一的泛左值访问对象的存储值，则行为未定义： ... a`char`或`unsigned char`类型。

### C++11 以后

```
enum class endianness
{
    little = 0,
    big = 1,
};

inline endianness get_system_endianness()
{
    const int value { 0x01 };
    const void * address = static_cast<const void *>(&value);
    const unsigned char * least_significant_address = static_cast<const unsigned char *>(address);
    return (*least_significant_address == 0x01) ? endianness::little : endianness::big;
} 
```

### C++11 以后（没有枚举）

```
inline bool is_system_little_endian()
{
    const int value { 0x01 };
    const void * address = static_cast<const void *>(&value);
    const unsigned char * least_significant_address = static_cast<const unsigned char *>(address);
    return (*least_significant_address == 0x01);
} 
```

### C++98/C++03

```
inline bool is_system_little_endian()
{
    const int value = 0x01;
    const void * address = static_cast<const void *>(&value);
    const unsigned char * least_significant_address = static_cast<const unsigned char *>(address);
    return (*least_significant_address == 0x01);
} 
```

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2009-06-16T13:03:53.027

有关更多详细信息，您可能需要查看此代码项目文章[有关 Endianness 的基本概念](http://www.codeproject.com/KB/cpp/endianness.aspx)：

> **如何在运行时动态测试 Endian 类型？**
> 
> 如计算机动画常见问题解答中所述，您可以使用以下函数来查看您的代码是在 Little-Endian 还是 Big-Endian 系统上运行：
> 
> ```
> #define BIG_ENDIAN      0
> #define LITTLE_ENDIAN   1 
> ```

```
int TestByteOrder()
{
   short int word = 0x0001;
   char *byte = (char *) &word;
   return(byte[0] ? LITTLE_ENDIAN : BIG_ENDIAN);
} 
```

> 此代码将值 0001h 分配给一个 16 位整数。然后分配一个 char 指针指向整数值的第一个（最低有效）字节。如果整数的第一个字节是 0x01h，则系统是 Little-Endian（0x01h 位于最低或最低有效地址）。如果它是 0x00h，那么系统是 Big-Endian。

* * *

## 回答 #11

> 赞同：7
> 
> 时间：2015-09-11T01:14:27.000

C++ 方法一直是使用[boost](http://www.boost.org/)，其中预处理器检查和强制转换在经过彻底测试的库中被分隔开。

Predef 库 (boost/predef.h) 识别[四种不同的字节序](https://www.boost.org/doc/libs/1_67_0/doc/html/predef/reference.html#predef.reference.other_macros)。

[Endian Library](https://www.boost.org/doc/libs/1_67_0/libs/endian/doc/index.html)计划提交给 C++ 标准，并支持对 endian 敏感数据的各种操作。

如上面的答案所述，字节顺序将成为 c++20 的一部分。

* * *

## 回答 #12

> 赞同：6
> 
> 时间：2012-10-12T21:22:12.423

如上所述，使用联合技巧。

不过，上面建议的问题很少，最值得注意的是，对于大多数体系结构而言，未对齐的内存访问速度非常慢，一些编译器甚至根本无法识别这样的常量谓词，除非字对齐。

因为单纯的字节序测试很无聊，所以这里有（模板）函数，它将根据您的规范翻转任意整数的输入/输出，而不管主机架构如何。

```
#include <stdint.h>

#define BIG_ENDIAN 1
#define LITTLE_ENDIAN 0

template <typename T>
T endian(T w, uint32_t endian)
{
    // this gets optimized out into if (endian == host_endian) return w;
    union { uint64_t quad; uint32_t islittle; } t;
    t.quad = 1;
    if (t.islittle ^ endian) return w;
    T r = 0;

    // decent compilers will unroll this (gcc)
    // or even convert straight into single bswap (clang)
    for (int i = 0; i < sizeof(r); i++) {
        r <<= 8;
        r |= w & 0xff;
        w >>= 8;
    }
    return r;
}; 
```

用法：

要将给定的字节序转换为主机，请使用：

`host = endian(source, endian_of_source)`

要将主机字节序转换为给定字节序，请使用：

`output = endian(hostsource, endian_you_want_to_output)`

生成的代码与在 clang 上编写手动汇编一样快，在 gcc 上它有点慢（展开 &,<<,>>,| 对于每个字节）但仍然不错。

* * *

## 回答 #13

> 赞同：6
> 
> 时间：2009-06-16T13:00:03.080

除非您使用已移植到 PPC 和 Intel 处理器的框架，否则您将不得不进行条件编译，因为 PPC 和 Intel 平台具有完全不同的硬件架构、管道、总线等。这使得汇编代码在两者之间完全不同他们俩。

至于查找字节顺序，请执行以下操作：

```
short temp = 0x1234;
char* tempChar = (char*)&temp; 
```

您将得到 tempChar 为 0x12 或 0x34，从中您将知道字节顺序。

* * *

## 回答 #14

> 赞同：6
> 
> 时间：2012-11-25T15:58:47.697

```
bool isBigEndian()
{
    static const uint16_t m_endianCheck(0x00ff);
    return ( *((const uint8_t*)&m_endianCheck) == 0x0); 
} 
```

* * *

## 回答 #15

> 赞同：4
> 
> 时间：2009-06-16T13:06:54.453

我会做这样的事情：

```
bool isBigEndian() {
    static unsigned long x(1);
    static bool result(reinterpret_cast<unsigned char*>(&x)[0] == 0);
    return result;
} 
```

沿着这些思路，您将获得一个只执行一次计算的高效函数。

* * *

## 回答 #16

> 赞同：4
> 
> 时间：2015-02-14T03:10:03.690

未经测试，但在我看来，这应该有效吗？因为它在小端上是 0x01，在大端上是 0x00？

```
bool runtimeIsLittleEndian(void)
{
 volatile uint16_t i=1;
 return  ((uint8_t*)&i)[0]==0x01;//0x01=little, 0x00=big
} 
```

* * *

## 回答 #17

> 赞同：3
> 
> 时间：2014-05-21T04:43:39.550

宣布：

# 我最初的帖子被错误地声明为“编译时间”。不是，在当前的 C++ 标准中甚至是不可能的。constexpr 并不意味着函数总是进行编译时计算。感谢理查德霍奇斯的纠正。

编译时，非宏，C++11 constexpr 解决方案：

```
union {
  uint16_t s;
  unsigned char c[2];
} constexpr static  d {1};

constexpr bool is_little_endian() {
  return d.c[0] == 1;
} 
```

* * *

## 回答 #18

> 赞同：3
> 
> 时间：2012-10-02T10:10:30.047

```
union {
    int i;
    char c[sizeof(int)];
} x;
x.i = 1;
if(x.c[0] == 1)
    printf("little-endian\n");
else    printf("big-endian\n"); 
```

这是另一种解决方案。类似于 Andrew Hare 的解决方案。

* * *

## 回答 #19

> 赞同：3
> 
> 时间：2017-02-17T11:58:49.400

如果您不想要条件编译，您可以编写与字节序无关的代码。这是一个示例（取自[Rob Pike](https://commandcenter.blogspot.fr/2012/04/byte-order-fallacy.html)）：

以与字节序无关的方式读取存储在磁盘上的小字节序的整数：

```
i = (data[0]<<0) | (data[1]<<8) | (data[2]<<16) | (data[3]<<24); 
```

相同的代码，试图考虑机器字节序：

```
i = *((int*)data);
#ifdef BIG_ENDIAN
/* swap the bytes */
i = ((i&0xFF)<<24) | (((i>>8)&0xFF)<<16) | (((i>>16)&0xFF)<<8) | (((i>>24)&0xFF)<<0);
#endif 
```

* * *

## 回答 #20

> 赞同：2
> 
> 时间：2009-06-16T14:44:48.767

您也可以通过预处理器使用诸如 boost 头文件之类的东西来执行此操作，该文件可以在[boost endian中找到](http://www.boost.org/doc/libs/1_39_0/boost/detail/endian.hpp)

* * *

## 回答 #21

> 赞同：2
> 
> 时间：2015-04-18T19:08:44.963

除非 endian 标头是 GCC-only，否则它提供了您可以使用的宏。

```
#include "endian.h"
...
if (__BYTE_ORDER == __LITTLE_ENDIAN) { ... }
else if (__BYTE_ORDER == __BIG_ENDIAN) { ... }
else { throw std::runtime_error("Sorry, this version does not support PDP Endian!");
... 
```

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-06-16T13:00:52.313

请参阅[字节顺序](https://sites.google.com/site/insideoscore/endianness)- C 级代码插图。

```
// assuming target architecture is 32-bit = 4-Bytes
enum ENDIANNESS{ LITTLEENDIAN , BIGENDIAN , UNHANDLE };

ENDIANNESS CheckArchEndianalityV1( void )
{
    int Endian = 0x00000001; // assuming target architecture is 32-bit    

    // as Endian = 0x00000001 so MSB (Most Significant Byte) = 0x00 and LSB (Least     Significant Byte) = 0x01
    // casting down to a single byte value LSB discarding higher bytes    

    return (*(char *) &Endian == 0x01) ? LITTLEENDIAN : BIGENDIAN;
} 
```

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-06-16T13:01:09.553

```
int i=1;
char *c=(char*)&i;
bool littleendian=c; 
```

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2012-11-25T14:56:32.873

C 编译器（至少我认识的每个人）的工作方式必须在编译时确定字节**顺序**。即使对于双字节序处理器（如 ARM och MIPS），您也必须在编译时选择字节序。此外，可执行文件（例如 ELF）的所有常见文件格式都定义了字节序。虽然可以制作一个二进制 blob 的 biandian 代码（可能对于某些 ARM 服务器漏洞利用？）它可能必须在汇编中完成。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2009-06-16T17:55:05.337

这是另一个 C 版本。`wicked_cast()`它通过 C99 联合文字和非标准运算符定义了一个称为内联类型双关语的宏`__typeof__`。

```
#include <limits.h>

#if UCHAR_MAX == UINT_MAX
#error endianness irrelevant as sizeof(int) == 1
#endif

#define wicked_cast(TYPE, VALUE) \
    (((union { __typeof__(VALUE) src; TYPE dest; }){ .src = VALUE }).dest)

_Bool is_little_endian(void)
{
    return wicked_cast(unsigned char, 1u);
} 
```

如果整数是单字节值，字节序就没有意义，并且会产生编译时错误。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2009-06-16T13:02:25.523

这个怎么样？

```
#include <cstdio>

int main()
{
    unsigned int n = 1;
    char *p = 0;

    p = (char*)&n;
    if (*p == 1)
        std::printf("Little Endian\n");
    else 
        if (*(p + sizeof(int) - 1) == 1)
            std::printf("Big Endian\n");
        else
            std::printf("What the crap?\n");
    return 0;
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2018-12-27T09:14:16.767

虽然没有快速和标准的方法来确定它，但这将输出它：

```
#include <stdio.h> 
int main()  
{ 
   unsigned int i = 1; 
   char *c = (char*)&i; 
   if (*c)     
       printf("Little endian"); 
   else
       printf("Big endian"); 
   getchar(); 
   return 0; 
} 
```

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2014-09-28T08:46:33.530

正如 Coriiander 所指出的，这里的大多数（如果不是全部）代码将在编译时进行优化，因此生成的二进制文件不会在运行时检查“字节顺序”。

据观察，给定的可执行文件不应以两种不同的字节顺序运行，但我不知道是否总是如此，而且在编译时检查对我来说似乎是一种黑客行为。所以我编写了这个函数：

```
#include <stdint.h>

int* _BE = 0;

int is_big_endian() {
    if (_BE == 0) {
        uint16_t* teste = (uint16_t*)malloc(4);
        *teste = (*teste & 0x01FE) | 0x0100;
        uint8_t teste2 = ((uint8_t*) teste)[0];
        free(teste);
        _BE = (int*)malloc(sizeof(int));
        *_BE = (0x01 == teste2);
    }
    return *_BE;
} 
```

MinGW 无法优化此代码，即使它确实优化了此处的其他代码。我相信这是因为我将分配在较小字节内存上的“随机”值保持原样（至少 7 位），所以编译器不知道该随机值是什么并且它不会优化功能消失。

我还对函数进行了编码，以便只执行一次检查，并存储返回值以供下次测试使用。

* * *

## 回答 #29

> 赞同：-2
> 
> 时间：2013-10-15T11:41:56.560

我正在阅读教科书：*计算机系统：程序员的视角*，并且通过C程序确定这是哪个字节序存在问题。

我使用指针的功能来做到这一点，如下所示：

```
#include <stdio.h>

int main(void){
    int i=1;
    unsigned char* ii = &i;

    printf("This computer is %s endian.\n", ((ii[0]==1) ? "little" : "big"));
    return 0;
} 
```

因为*int*占用 4 个字节，而*char*只占用 1 个字节。我们可以使用*char 指针*指向值为 1 的*int*。因此，如果计算机是 little endian，则char*指针**指向*的 char值为 1，否则其值为 0。

# subsonic - 亚音速2.1 gac？

> ID：1001311
> 
> 赞同：0
> 
> 时间：2009-06-16T12:57:37.610
> 
> 标签：subsonic

在托管环境中的 Web 应用程序中使用 SubSonic 2.1（例如，我无法控制服务器上发生的事情）。

SubSonic dll 是否必须在服务器 GAC 中注册，还是可以简单地在网站 bin 文件夹中？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T14:19:23.917

它可以简单地位于网站 bin 文件夹中。

# sharepoint - 通过 SharePoint 上的代码获取 SSO 凭据失败

> ID：1001319
> 
> 赞同：0
> 
> 时间：2009-06-16T12:58:38.090
> 
> 标签：sharepoint, single-sign-on

以下代码用于自定义 WebPart，由于某种原因，它仅在第一次在页面上执行时才有效。之后它抛出一个 SingleSignonCredsNotFoundException

非常感谢任何有关如何解决此问题的帮助或建议。

```
public static SsoIdentity GetCredentials(string applicationName)
{
    try
    {
        ISsoProvider ssoProvider = SsoProviderFactory.GetSsoProvider();
        SsoCredentials credentials = ssoProvider.GetCredentials(applicationName);

        string[] tmp = ConvertSecurityStringToString(credentials.UserName).Split(new string[] { "\\" }, StringSplitOptions.RemoveEmptyEntries);
        string username = tmp[1];
        string domain = tmp[0];
        string password = ConvertSecurityStringToString(credentials.Password);

        SsoIdentity wi = new SsoIdentity(username, password, domain);

        return wi;
    }
    catch (SingleSignonCredsNotFoundException ex)
    {

    }
    catch (SingleSignonException ex)
    {

    }

    return null;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-18T09:21:40.083

很明显，问题在于我在冒充我从 sso 凭证商店获得的用户。但是当我撤消此操作时，它会返回到应用程序池的标识，并且下次调用 GetCredentials 时，它会在 sso 中查找该用户，而这不一定是 sso 应用程序的成员。

# eclipse - 如何在 Eclipse 中制作只读编辑器（Eclipse 插件开发）

> ID：1001322
> 
> 赞同：5
> 
> 时间：2009-06-16T12:58:48.497
> 
> 标签：eclipse, editor, eclipse-rcp, readonly, eclipse-pde

我想知道如何制作一个真正只读的 Eclipse 编辑器。我的编辑器扩展了*TextEditor*，所以当我重新实现方法时*isEditable*总是返回**false**。

这是最简单的方法，它可以防止用户在编辑器中打开的文档中键入或删除任何内容。但是您仍然可以更改文档的内容，例如使用查找/替换。这是不希望的..

有没有其他简单的方法来实现这个目标？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-17T06:23:19.533

我想使用编辑器而不是查看器，因为编辑器已经制作好了，所以我只使用了一个 3rd 方插件..

我找到了我的解决方案 - 也许不是很干净，但可以完成工作并且很容易，所以它赢了

我已经覆盖了这些方法：

```
@Override
public boolean isEditable() {
    return false;
}

@Override
public boolean isEditorInputModifiable() {
    return false;
}

@Override
public boolean isEditorInputReadOnly() {
    return true;
}

@Override
public boolean isDirty() {
    return false;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T21:26:59.453

您是否尝试过创建自己的 SourceViewer？像这样的东西。我自己没有尝试过代码。

```
class ReadOnlyViewer extends SourceViewer
{
   protected StyledText createTextWidget(Composite parent, int styles) 
   {
    return new StyledText(parent, styles | SWT.READ_ONLY);
   }
}

class MyEditor extends TextEditor
{
protected ISourceViewer createSourceViewer(Composite parent, IVerticalRuler ruler, int styles) 
     {
        fAnnotationAccess= getAnnotationAccess();
        fOverviewRuler= createOverviewRuler(getSharedColors());

        ISourceViewer viewer= new ReadOnlyViewer(parent, ruler, getOverviewRuler(), isOverviewRulerVisible(), styles);
        // ensure decoration support has been created and configured.
        getSourceViewerDecorationSupport(viewer);

        return viewer;
    }
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-16T13:23:49.570

在 SWT 样式中，指定[SWT.READ_ONLY](http://www.java2s.com/Code/JavaAPI/org.eclipse.swt.widgets/newTextShellshellSWTREADONLYSWTBORDER.htm)。这应该拒绝所有修改文档的API（除了setText（），我希望......）

如果没有，请[提交一个错误](https://bugs.eclipse.org/bugs)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-16T13:34:15.727

为什么您使用 TextEditor 而不是[TextViewer](http://help.eclipse.org/help32/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/text/TextViewer.html)？

# asp.net - 两个 ASP.NET 站点共享应用程序文件但具有不同的 web.config

> ID：1001332
> 
> 赞同：7
> 
> 时间：2009-06-16T13:01:08.677
> 
> 标签：asp.net, iis-6, web-config

是否可以使用虚拟目录和/或虚拟应用程序来设置两个共享相同应用程序代码（aspx 页面等）但具有不同 web.config 文件的网站？站点和代码位于在同一 IIS 上运行的同一台服务器上。

我正在使用 IIS 6。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T13:06:16.857

如果您想将代码保存在一个地方，简短的回答是否定的。可能最好的解决方案是让应用程序根据您确定的站点（可能是主机标头？）加载自定义配置文件。

[ConfigurationManager.OpenExeConfiguration](http://msdn.microsoft.com/en-us/library/ms134265.aspx)之类的东西可能很有用。

我想另一种方法是提出一个配置约定，将所有内容都放在一个文件中，然后使用[GetSection](http://msdn.microsoft.com/en-us/library/system.web.configuration.webconfigurationmanager.getsection.aspx)（带有某种特定于应用程序的前缀）来获取所需的特定设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-18T01:33:23.680

我很确定我在几年前做过一次，以便为网站的每个实例使用不同的数据库连接字符串。我的猜测是，网站的每个实例都有一个虚拟目录，其中*仅*包含一个 web.config，其中包含特定于实例的设置，然后在每个虚拟目录中都有一个引用源代码的应用程序（其中包括一个共享的 web.config）。配置）。

因此，如果我没记错的话，诀窍是，对于给定的网站，拥有一个仅包含 web.config 的虚拟目录。此中的值将由该虚拟目录的子应用程序继承。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T13:33:21.467

这根本不可能。

为什么 ？？？

因为 asp.net 工作进程将从应用程序物理所在的物理文件夹中读取默认配置文件。虚拟目录与 web.config 无关。它只是被 webserver(IIS) 用来映射到作为网站根目录的特定物理目录。

谢谢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T13:05:03.100

应该是，将使用虚拟应用程序中的web.config。如果布局是分层的，您可能需要注意 web.config 继承

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T13:37:58.730

我假设您有应用程序 A、应用程序 B、应用程序 C 等等，它们完全相同，只是它们的 web.config 文件中定义的一些配置属性不同。

当然这是可能的 - 最简单的方法是将项目设置为 Web 应用程序，然后编译，然后在应用程序之间共享该 dll。您可以根据需要使用 GAC。

您可以在 IIS 中设置指向所有逻辑所在的共享目录（或在每个目录中使用虚拟目录）的各个站点，但您不能共享 app_code 文件夹。

编辑

RichardOD 上面有最好的答案，我之前也实现过类似的东西。基本上，我设置了一个由 web.config 引用的自定义配置文件（以防止在我对其进行更改时重新启动应用程序）。此文件按主机名读取，并包含基于每个主机的特定属性。

我所做的只是将主机头添加到 IIS，并在自定义配置文件中为该主机添加一个条目。完毕。

# java - 用于控制台应用程序的 Java gotoxy(x,y)

> ID：1001335
> 
> 赞同：26
> 
> 时间：2009-06-16T13:01:11.190
> 
> 标签：java, console-application

我正在用 Java 编写一个简单的控制台应用程序（80x24），是否有一个 gotoxy(x,y) 等价物？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-16T13:07:02.347

如果通过 gotoxy(x,y)，您想将光标重新定位在控制台上的特定位置，您通常可以使用 VT100 控制代码来执行此操作。请参阅[http://www.termsys.demon.co.uk/vtansi.htm](http://www.termsys.demon.co.uk/vtansi.htm)。

做类似的事情

```
char escCode = 0x1B;
int row = 10; int column = 10;
System.out.print(String.format("%c[%d;%df",escCode,row,column)); 
```

这应该将光标移动到控制台上的 10,10 位置。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-16T13:04:59.310

我认为在 Java 中没有内置函数可以做到这一点。您可以使用一个名为[JCurses](http://sourceforge.net/projects/javacurses/)的 Java 诅咒库。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T13:05:39.310

并非没有引入控制台`curses`样式库...

您可以尝试[javacurses](http://sourceforge.net/projects/javacurses/)看看是否对您有帮助。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-22T13:56:21.867

我发现[lanterna](http://code.google.com/p/lanterna/)是一个非常好的图书馆。它不依赖于任何本机库，而是 100% 在纯 Java 中运行。

它提供了一个`Screen`允许基于坐标系输出文本的类。对于具有图形环境的操作系统，它使用基于 Swing 的终端仿真器。不幸的是，您无法在 Windows 上强制使用终端模式，因此如果您真的需要终端，请使用其他答案中的解决方案之一。

# asp.net - OracleClient 命令 - 使用和处置命令的最佳实践

> ID：1001345
> 
> 赞同：0
> 
> 时间：2009-06-16T13:04:07.347
> 
> 标签：asp.net, oracle, connection-pooling

根据 OracleClient.OracleCommand 的 MSDN 文档：

```
Public Sub ReadMyData(ByVal connectionString As String)
    Dim queryString As String = "SELECT EmpNo, DeptNo FROM Scott.Emp"
    Using connection As New OracleConnection(connectionString)
        Dim command As New OracleCommand(queryString, connection)
        connection.Open()
        Dim reader As OracleDataReader = command.ExecuteReader()
        Try
            While reader.Read()
                Console.WriteLine(reader.GetInt32(0) & ", " _
                   & reader.GetInt32(1))
            End While
        Finally
            ' always call Close when done reading.
            reader.Close()
        End Try
    End Using
End Sub 
```

OracleCommand 未包装在 Using 块中。

问：应该吗？OracleCommand 继承自 DbCommand，后者实现了 IDisposable。

我正在查看执行以下操作的代码，并且我们遇到了隐式游标未关闭的问题：

```
 Dim cmd As OracleCommand = createCommand("some sql")
     ds = GetDataSet(cmd)
     cmd.Dispose()
     cmd = Nothing 
```

GetDataSet 看起来像：

```
 Dim da As New OracleDataAdapter()
  Dim ds As New DataSet()

  Using conn As OracleConnection = GetOpenConnection()
     cmd.Connection = conn
     da.SelectCommand = cmd
     da.Fill(ds, 0)
     cmd.Connection = Nothing
  End Using
  da.Dispose()
  da = Nothing
  Return ds 
```

这会不会泄露资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T13:11:55.257

首先，我认为您应该在代码中显式关闭连接，因为根据提供者的不同，调用 Close 方法时会完成一些额外的工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T13:48:35.697

您如何确定隐式游标已打开并且这是一个问题？我问的原因是调用“关闭”方法实际上并没有关闭连接。它只是让池知道它不再被使用并且可以在其他地方重新分配。这样做是出于性能原因，因为实际打开连接的成本很高。相同的连接将被重复使用多次，并且即使在调用“关闭”之后也可能保持打开状态，因此如果您使用一些 Oracle 工具来查看连接，它可能会让您误入歧途。

我从来没有看到任何明确处置命令对象的理由。它只是参数和其他信息的集合。

如果您使用 using 块，则绝对不需要在代码中显式调用“Close”或“Dispose”。这就是 using 块的重点。它可以防止您忘记调用 Close，因为这正是它为您所做的。

# visual-studio-2008 - 将 VS2008 测试变成 NUnit 测试

> ID：1001346
> 
> 赞同：2
> 
> 时间：2009-06-16T13:04:11.137
> 
> 标签：visual-studio-2008, unit-testing, nunit

有人告诉我，只需添加 VS2008 中自动生成的测试就可以与 NUnit 兼容

```
#if !NUNIT
using Microsoft.VisualStudio.TestTools.UnitTesting;
#else
  using NUnit.Framework;
  using TestClass = NUnit.Framework.TestFixtureAttribute;
  using TestMethod = NUnit.Framework.TestAttribute;
  using TestInitialize = NUnit.Framework.SetUpAttribute;
  using TestCleanup = NUnit.Framework.TearDownAttribute;
  using TestContext = System.String;
  using DeploymentItem = NUnit.Framework.DescriptionAttribute;
#endif 
```

编辑：自从我修复了参考问题以来，这个问题的焦点略有改变。再一次，有人告诉我这个语句可以更改为正确的单元测试程序，VS 或 NUnit。

它永远不会进入 else 语句。所以新的问题是，我是否需要将条件更改为其他内容，还是我又错过了一些简单的内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T13:27:36.753

您是否引用了 NUnit 程序集来代替 VS 测试程序集？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:14:00.923

您是否尝试转换您的测试或在同一个项目中同时运行 NUnit 和 VS 测试？如果您正在转换，那么您应该能够使用查找和替换来进行大部分更改。

我进行了从 VS 测试到 NUnit 的转换，发现了一个语法差异： IsInstanceOfType 方法的参数顺序不同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T12:30:38.967

好吧，在我忽略了理查德向我指出的简单错误之后，我发现了该怎么做。

由于我在 CC.NET 中运行这些，我只是为变量采取了简单的方法并在 cmd 中设置了一个 windows 变量，然后使用 nunit-console.exe 运行 dll。

如果您真的不关心能否在 VS2008 和 NUnit 测试程序之间来回交换，您可以只取出预编译代码，将 if 的内容留给 VS，将 else 的内容留给 NUnit。

# iphone - iPhone：相机预览覆盖

> ID：1001347
> 
> 赞同：43
> 
> 时间：2009-06-16T13:04:15.223
> 
> 标签：iphone, uiimageview, camera, uiimagepickercontroller

如何`UIImageView`在相机预览中添加叠加层 ( ) 并处理对此的触摸？

我之前的尝试（例如使用`UIImagePickerController`和添加图像作为子视图）失败了。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2010-01-12T13:06:31.173

本教程解释它：[http ://www.musicalgeometry.com/?p=821](http://www.musicalgeometry.com/?p=821)

只需在叠加视图中添加一个 UIImage，而不是教程中显示的红色区域。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-06T12:07:31.597

对于您的实施文件：

```
- (IBAction)TakePicture:(id)sender {

    // Create image picker controller
    UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];

    // Set source to the camera
    imagePicker.sourceType =  UIImagePickerControllerSourceTypeCamera;

        // Delegate is self
        imagePicker.delegate = self;

        OverlayView *overlay = [[OverlayView alloc] initWithFrame:CGRectMake(0, 0, 320, 480)];     

        // Insert the overlay:
        imagePicker.cameraOverlayView = overlay;

       // Allow editing of image ?
        imagePicker.allowsImageEditing = YES;
        [imagePicker setCameraDevice:
        UIImagePickerControllerCameraDeviceFront];
        [imagePicker setAllowsEditing:YES];
        imagePicker.showsCameraControls=YES;
        imagePicker.navigationBarHidden=YES;
        imagePicker.toolbarHidden=YES;
        imagePicker.wantsFullScreenLayout=YES;

        self.library = [[ALAssetsLibrary alloc] init];

        // Show image picker
        [self presentModalViewController:imagePicker animated:YES];
    } 
```

创建一个 UIView 类并添加此代码

```
 - (id)initWithFrame:(CGRect)frame
    {
        self = [super initWithFrame:frame];
        if (self) {
            // Initialization code

            // Clear the background of the overlay:
            self.opaque = NO;
            self.backgroundColor = [UIColor clearColor];

            // Load the image to show in the overlay:
            UIImage *overlayGraphic = [UIImage imageNamed:@"overlaygraphic.png"];
            UIImageView *overlayGraphicView = [[UIImageView alloc] initWithImage:overlayGraphic];
            overlayGraphicView.frame = CGRectMake(30, 100, 260, 200);
            [self addSubview:overlayGraphicView];

        }
        return self;
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T13:28:41.290

您也许可以直接将 添加`UIImageView`为主窗口的子视图而不是`UIImagePicker`，它可能会更好。只需确保以正确的顺序添加它们，或致电

```
[window bringSubviewToFront:imageView]; 
```

相机升起后。

如果您想处理触摸，`UIImageView`您可以将其添加为具有透明背景`UIImageView`的普通全屏的子视图，然后将*其*添加到窗口中，并使用可用于处理触摸事件的普通子类。`View`*`UIViewController`*

 ** * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-02-08T17:45:53.240

查看相机叠加视图（在 3.1 及更高版本中可用）

```
@property(nonatomic, retain) UIView *cameraOverlayView 
```*

# visual-studio - SSIS - 消失的外部 .dll

> ID：1001362
> 
> 赞同：3
> 
> 时间：2009-06-16T13:06:24.313
> 
> 标签：visual-studio, ssis

我在一个 2 开发人员团队中。我们正在运行 SQL Server 2008 和 SQL Server 2008 SSIS。我们有一个我编写的外部库，以利用脚本任务中的一些可重用功能。我已经用 .snk 对程序集进行了签名，对其进行了编译，并将其添加到开发机器上的 GAC 中。当我加载一个项目时，我可以添加对程序集的引用并毫无问题地使用代码。

我的同伴可以添加程序集并使用代码，但是当他保存/关闭脚本任务并重新打开它时，.dll 引用消失了。我们都将引用设置为复制本地，并确认 .dll 文件已复制到本地项目目录中，但不是为他。我让他在打开脚本窗口的情况下重建 这是一个全新的 VS 2008 安装，因此尚未设置用户特定的选项。

编辑：我们都在不同的登录名下使用同一台机器。他可以在他的登录名下查看我添加到 GAC 的文件。

有人有想法么？

如果我将文件添加到 GAC，他应该可以使用它，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T19:38:08.237

解决了-

脚本任务的框架版本与程序集中的版本不匹配。我不知道 SSIS 将框架版本默认为 2.0。一旦我们更改了脚本任务的框架版本，一切都运行良好。

# c# - 您可以使用 System.DirectoryServices.Protocols.ExtendedRequest 做什么？

> ID：1001369
> 
> 赞同：1
> 
> 时间：2009-06-16T13:07:09.133
> 
> 标签：c#, active-directory

（低级）Active Directory API[`System.DirectoryServices.Protocols`](http://msdn.microsoft.com/en-us/library/system.directoryservices.protocols.aspx)包含一个名为[`ExtendedRequest`](http://msdn.microsoft.com/en-us/library/system.directoryservices.protocols.extendedrequest.aspx). 我似乎无法为这个类找到任何好的文档，但顾名思义，您可以使用它执行 Active Directory 操作，这些操作没有被建模为这个命名空间中的标准类。

有谁知道你可以用这个类做什么以及如何使用它？它接受的唯一输入是字符串和字节数组。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T13:18:35.680

反映它表明，当它被[LdapConnection](http://msdn.microsoft.com/en-us/library/system.directoryservices.protocols.ldapconnection.aspx)使用时，它只是[ldap_extended_operation](http://msdn.microsoft.com/en-us/library/aa366578(VS.85).aspx) API 的包装器。这似乎是一个在多个平台上有文档的通用 API。例如，[此页面](http://docs.sun.com/source/817-6707/extendop.html#wp38654)显示如何将其与[OID](http://en.wikipedia.org/wiki/Object_identifier)一起使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:09:24.080

杰夫的回答给了我一些正确方向的好提示。API 是特定于目录服务器的`ldap_extended_operation`API，每个目录服务器可能支持也可能不支持某些非标准操作集。目录服务器支持的操作可以在`rootDse`属性中找到`supportedExtension`。

每个受支持的扩展都有一个唯一的 OID，它是属性[`ExtendedRequest.RequestName`](http://msdn.microsoft.com/en-us/library/system.directoryservices.protocols.extendedrequest.requestname.aspx)并且可选地需要 data: [`ExtendedRequest.RequestValue`](http://msdn.microsoft.com/en-us/library/system.directoryservices.protocols.extendedrequest.requestvalue.aspx)。您应该为什么请求提供什么数据可能可以在活动目录服务器的文档中的某处找到。

# svn - 如何禁止对 svn:external 的颠覆提交到修订版？

> ID：1001371
> 
> 赞同：5
> 
> 时间：2009-06-16T13:07:53.923
> 
> 标签：svn, permissions, svn-externals

我们将 svn:externals 用于库的特定修订，例如

```
xyzlib -r12345 https://asdf.asdf.local/xyzlib/trunk/ 
```

当您在工作副本中对此类签出的外部进行修改时，即使外部链接指向特定修订而不是 HEAD，也可以提交。

当您`svn update`在提交后运行时，更改将在工作副本中消失，因为 subversion 会将所有内容恢复到修订版 12345。因此您自己永远不会真正看到更改，但它们仍然在 HEAD 中，这很糟糕。

是否可以仅在外部不指向 HEAD 修订时才禁止提交？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2010-01-05T16:02:33.157

对于这些类型的验证，我还建议使用 pre-commit 钩子，但我建议使用像 SVNKit 这样的库 - [http://svnkit.com/](http://svnkit.com/)（如果你了解Java）。

我使用这个库自己编写了一些预提交钩子，使用起来非常容易。你编写了一个可运行的小型 Java 程序，它被 Subversion 从 pre-commit 钩子调用。然后很容易提取例如属性或 URL 的一部分来进行验证，如果它不适用于您的“规则”，则拒绝提交。

看看 SVNLookClient 和 SVNChangeEntry 类——它们有用于最常见情况的方法（例如，提取有关正在进行的提交的信息。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-01-04T21:08:52.070

您可以尝试这样的事情：使用[预提交脚本](http://xrunhprof.wordpress.com/2008/06/20/forbid-modification-of-tags-in-subversion/)来检查提交是否要发送到标签。如果是这样，则失败并提供消息。[阅读更多关于颠覆钩子的信息。](http://wordaligned.org/articles/a-subversion-pre-commit-hook)您必须重新编写正则表达式，以便它在不是 HEAD 时失败，而不是在标签时失败。

```
$SVNLOOK changed -t “$TXN” “$REPOS” | egrep -v “^[AD][[:space:]]+(.*/)?tags/[^/]+/$” | egrep “^[^[:space:]]+[[:space:]]+tags/[^/]+/.+”
if [ $? -eq 0 ] ; then
echo >&2 “***************************************”
echo >&2 “* Modification of tags is not allowed *”
echo >&2 “***************************************”
exit 1
fi 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T13:25:41.780

由于您使用的是 https，我假设您使用的是`mod_dav_svn`. 您可以为您的库存储库设置一个额外的 url，并且只授予对它的只读访问权限。这样，即使是通常可以提交到库的开发人员，也无法通过 svn:external 提交。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-01-05T05:17:22.017

如果您不承诺将外部定义为主干的修订版，为什么不根据该修订版制作一个新标签。然后，您可以将 svn:external 指向标签，并使用其中一种记录在案的访问控制方法来限制对标签目录的提交（或将标签放在不同的 repo 中并使该 repo 只读）。

# macos - Mac驱动开发

> ID：1001374
> 
> 赞同：11
> 
> 时间：2009-06-16T13:08:19.863
> 
> 标签：macos, kernel, driver

我正在考虑将 Windows 驱动程序迁移到 OS X 中。现在我刚刚开始四处查看可用的内容，并且有很多关于目标 C 和可可的内容。似乎语言和可可框架是高级 API，我是否正确假设？

我有很强的 C++ 技能，我将它们用于内核开发，我可以将相同的技能用于 Mac 驱动程序开发（我想答案是肯定的）。Macintosh 是否有任何类型的应用程序/开发环境来构建驱动程序？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-16T13:10:43.370

[Apple Hardware & Drivers 页面](http://developer.apple.com/samplecode/HardwareDrivers/index.html)包含大量有关 Mac 驱动程序开发的信息。这应该足以让你开始。一些亮点：

*   [**Getting Started**](https://developer.apple.com/library/mac/#referencelibrary/GettingStarted/GS_HardwareDrivers/_index.html) - 为刚接触 Mac OS X 的硬件和驱动程序开发人员提供的指导学习路径。

*   [**框架**](http://developer.apple.com/referencelibrary/API_Fundamentals/HardwareDrivers-api-date.html)- 由框架组织的 API 参考。

*   [**USB 示例代码**](http://developer.apple.com/samplecode/HardwareDrivers/idxUSB-date.html)- 用于开发 USB 设备和软件以访问它们的资源。

*   [**FireWire 示例代码**](http://developer.apple.com/samplecode/HardwareDrivers/idxFireWire-date.html)- 用于开发 FireWire 设备和访问它们的软件的资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T13:13:32.133

从这里开始[http://developer.apple.com/documentation/Darwin/Conceptual/KernelProgramming/About/About.html](http://developer.apple.com/documentation/Darwin/Conceptual/KernelProgramming/About/About.html)

Mac 开发通常使用 Xcode 完成，因为它处理各种 Mac 特定的概念，如包和框架。您很可能使用纯 C 语言工作。您不会使用 Cocoa 进行驱动程序开发，因为它是一个面向应用程序的框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-06-13T23:35:36.313

首先，C++ 工作得很好，尽管 Objective C 并不是那么难学。如果你有 Windows 驱动程序的背景，你就会知道一些要点——内存管理很重要，时间很重要，等等。

您可能会使用 IOKit。我建议从这里开始，逐步介绍如何让驱动程序工作。

[内核扩展](http://developer.apple.com/library/mac/#documentation/Darwin/Conceptual/KEXTConcept/KEXTConceptIntro/introduction.html#//apple_ref/doc/uid/10000191-SW1)

有一些事情似乎不像他们所说的那样工作，我试图弄清楚是否真的不可能在单台机器上调试驱动程序，但它比大多数 Apple 文档要好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-06T21:16:51.360

如果您的目标是 Catalina 或更高版本，您还应该考虑[DriverKit](https://developer.apple.com/documentation/driverkit)。

# c++ - C++ - 对最近创建的类的未定义引用！

> ID：1001375
> 
> 赞同：0
> 
> 时间：2009-06-16T13:08:38.257
> 
> 标签：c++, codeblocks, undefined-reference

我刚刚创建了这个新类：

```
//------------------------------------------------------------------------------
#ifndef MULTITHREADEDVECTOR_H
#define MULTITHREADEDVECTOR_H
//------------------------------------------------------------------------------
#include <vector>
#include <GL/GLFW.h>
//------------------------------------------------------------------------------
template<class T>
class MultithreadedVector {

    public:

        MultithreadedVector();

        void push_back(T data);

        void erase(typename std::vector<T>::iterator it);

        std::vector<T> get_container();
    private:

        std::vector<T> container_;
        GLFWmutex th_mutex_;

};
//------------------------------------------------------------------------------
#endif // MULTITHREADEDVECTOR_H_INCLUDED
//------------------------------------------------------------------------------ 
```

类的定义：

```
//------------------------------------------------------------------------------
#include "MultithreadedVector.h"
//------------------------------------------------------------------------------
using namespace std;
//------------------------------------------------------------------------------
template<class T>
MultithreadedVector<T>::MultithreadedVector() {

    th_mutex_ = glfwCreateMutex();
}

template<class T>
void MultithreadedVector<T>::push_back(T data) {

    glfwLockMutex(th_mutex_);
    container_.push_back(data);
    glfwUnlockMutex(th_mutex_);

}

template<class T>
void MultithreadedVector<T>::erase(typename vector<T>::iterator it) {

    glfwLockMutex(th_mutex_);
    container_.erase(it);
    glfwUnlockMutex(th_mutex_);
}

template<class T>
vector<T> MultithreadedVector<T>::get_container() {

    return container_;

} 
```

现在的问题是，当我尝试在我的代码中将它用作另一个类的静态成员时：

```
// VehicleManager.h
#ifndef MULTITHREADEDVECTOR_H
#define MULTITHREADEDVECTOR_H

#include "MultithreadedVector.h"
#include "Vehicle.h"
class Foo {

   public:
     // stuffs
   private:
     static MultithreadedVector<Vehicle> vehicles_; 
     ...
}

#endif 
```

然后在里面：VehicleManager.cpp

```
#include "VehicleManager.h"

MultithreadedVector<Vehicle> VehicleManager::vehicles_;

void VehicleManager::Method() {

  Vehicle vehicle;
  VehicleManager::vehicles_.push_back(vehicle);

} 
```

但它没有编译:(，我每次都会收到这个错误消息：

```
C:\***\VehicleManager.cpp|188|undefined reference to `MultithreadedVector<Vehicle>::push_back(Vehicle)'| 
```

我真的不明白为什么，尤其是我在 VehicleManager.cpp 的全局范围内定义了静态类成员。

PS：我正在使用 Code::Blocks。

谢谢 ！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T13:14:38.713

这就是盲目地将类模板实现移动到 cpp 文件时会发生的情况。

为了使这个工作，您必须确切地知道您将实例化类模板并在 cpp 文件中指定它们的 T 类型。

在这种情况下，将其放入 cpp 文件中：

```
template class MultithreadedVector<Vehicle>; 
```

请注意，cpp 文件必须知道`Vehicle`那时。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T13:12:27.050

大多数 C++ 编译器不允许您分离模板声明和模板定义。您需要将模板类的完整定义放在单个 .h 文件中，而不是将它们拆分为 .h 和 .cpp 文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T13:11:23.120

模板实现的完整代码必须在编译器看到模板的使用时对它是可见的，以便它可以实例化模板并将其编译成可以稍后链接的目标代码。

在声明模板的同一头文件中定义模板代码。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T23:27:10.257

我认为有两种情况可以使用模板

1.  为任意一组符合的类型提供通用代码
2.  为一组固定类型提供通用代码

对于第二个，您不需要将模板放入标题中：因为您事先知道您的模板使用什么类型。您可以很好地定义类模板的成员函数，或在单独的翻译单元中定义函数模板，而不会出现链接器错误。有些人一直在教导别人这是不可能的，并以此混淆了这件事。

但我认为这取决于这两种情况是否要将声明和定义分成不同的翻译单元。

*   如果您想使用案例 1，您总是希望在标题中包含定义（无论是否包含在特殊命名文件中，例如`.ipp`，`.tcc`或其他）。我只知道一个 C++ 前端即使在这种情况下也支持将定义与声明分离，它是英特尔和 Comeau 编译器使用的 EDG（爱迪生设计组）前端，它实现了`export`. 该关键字被某些人视为错误功能，并且大多数编译器都没有实现它。

*   如果您想使用案例 2，将定义放入标题中是没有好处的，因为没有理由这样做：您只需为固定类型集显式实例化所需的函数和类。在第二种情况下，您使用模板来避免维护可能冗余代码的负担，并在某些情况下可以选择为某些类型引入特殊行为。

您的场景显然是第一种情况，因此您必须将定义放入标题中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T13:12:54.350

您似乎在 VehicleManager.h 中有复制和粘贴错误：

```
#ifndef MULTITHREADEDVECTOR_H
#define MULTITHREADEDVECTOR_H 
```

这禁止包含定义类 Foo 的头文件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-16T13:13:28.187

在大多数情况下，您不能在 cpp 文件中编写模板实现。将模板实现移动到头文件中，以便编译器可以正确实例化它。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-06-16T13:15:34.233

除了其他答案：

你也得防备`get_container()`。这种方法基本上是复制`container_`元素，因此必须加以保护。

```
template<class T>
vector<T> MultithreadedVector<T>::get_container() 
{
    return container_;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-16T13:55:57.787

在某种程度上，模板是一种高级的、专门的宏。您实际上不能像您尝试做的那样单独编译模板定义。

对于大多数人来说，这意味着他们甚至不必费心将模板定义与声明分开。我有一位同事[更进一步](https://stackoverflow.com/questions/583255/c-code-in-header-files)，也拒绝分离*非模板*定义和声明。

如果您想从声明中放入模板的定义，您确实有几个选择。

第一个选项是使用 C++“export”关键字。这个看似简单的解决方案的问题是[没有人支持它](http://anubis.dkuug.dk/jtc1/sc22/wg21/docs/papers/2003/n1426.pdf)。编译器编写者很难实现。

第二种选择是使用[第三种类型的文件](http://lists.boost.org/Archives/boost/2003/08/51197.php)，通常标记为“.ipp”，用于声明。这里的诀窍是它仍然是一个必须是“#included”的文件，但作为一个单独的文件，你只需要将它包含在“.cpp”文件中。如果我在一个程序中的多个“.cpp”文件中#include 一个“.ipp”，我发现我的链接器不喜欢它，所以你必须选择一个作为包含器。

# visual-studio-2008 - 是否有一个很好的 Visual Studio 插件可以启动 msbuild 目标？

> ID：1001376
> 
> 赞同：3
> 
> 时间：2009-06-16T13:08:56.650
> 
> 标签：visual-studio-2008, msbuild

我喜欢 Java IDE 的一件事是它们通常能够允许用户右键单击 Ant 文件并运行其中一个目标。

我的解决方案中有一个 msbuild 文件，用于迁移应用程序数据库，并且会杀死能够右键单击它，选择“更新”或“回滚”并让它运行。

我的搜索没有发现任何可以在 VS2008 中运行的东西，只是 Windows 资源管理器的一个 shell 扩展。

有人在外面见过这样的动物吗？

亲切地，

乔恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-04-07T13:29:45.097

我开发了这个插件：

[http://www.netlogics.ch/devcenter/addins.msbuild.html](http://www.netlogics.ch/devcenter/addins.msbuild.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T16:54:23.690

据我所知，不存在这样的插件。

但是有一个独立的应用程序[MSBuild Sidekick 。](http://www.attrice.info/msbuild/)

赛义德·易卜拉欣·哈希米

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-05-19T10:18:59.213

也许带有 msbuild.exe 命令行的批处理文件会有所帮助。易于编写，易于调试，即时运行；）

# javascript - 在 Prototype 中对 AJAX 请求使用自己的回调方法

> ID：1001382
> 
> 赞同：0
> 
> 时间：2009-06-16T13:09:29.847
> 
> 标签：javascript, ajax, datatable, prototypejs, yui

我已经重构了工作代码以使用正确的对象，现在我无法让 Prototype 的 AJAX.Request 正常工作。代码如下，它在 YUI 的 DataTable 的上下文中工作：

```
SearchTable.prototype.setTableColumns = function (transport) {
      this.dataTableColumns = transport.responseText.evalJSON();
      this.dataTableCallback();
};

SearchTable.prototype.setTableConfiguration = function (transport) {
  this.dataTableConfiguration = transport.responseText.evalJSON();
  this.dataTableCallback();
};

SearchTable.prototype.show = function () {
  ....
  new Ajax.Request(this.dataProxy, {
    method: 'get',
    parameters: {
      format: 'json',
      param: 'columns'
    },
    onSuccess: this.setTableColumns
  });

 new Ajax.Request(this.dataProxy, {
   method: 'get',
   parameters: {
     format: 'json',
     param: 'configuration'
   },
   onSuccess: this.setTableConfiguration
  });
}
};

 SearchTable.prototype.dataTableCallback = function () {
        ....
 } 
```

我的问题是`dataTableCallback`永远不会被调用。显然它抛出了一个`this`未定义的异常，我可以理解：回调不在对象上下文中调用，因此`this`永远不会被分配。我试过 curryfying 回调但失败了。

问题是：我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T13:18:32.700

试试这个：

```
onSuccess: this.setTableColumns.bind(this) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T13:19:42.900

为“this”创建一个闭包：

```
SearchTable.prototype.show = function () {
  ....

  var self = this;

  new Ajax.Request(this.dataProxy, {
    method: 'get',
    parameters: {
      format: 'json',
      param: 'columns'
    },
    onSuccess: function(transport) { self.setTableColumns(transport); }
  }); 
```

# nhibernate - NHibernate 的增量生成器 - 无法获取初始值

> ID：1001387
> 
> 赞同：6
> 
> 时间：2009-06-16T13:10:42.793
> 
> 标签：nhibernate, sqlite, fluent-nhibernate

我正在尝试在遗留数据库上使用**NHibernate**（和**FluentNHibernate ）。**我也在使用**SQLite 进行测试**。

当我尝试使用 FluentNHibernate 的**PersistenceSpecification创建****映射测试时，**出现以下异常：

 ****NHibernate.Exceptions.GenericADOException：无法获取增量生成器的初始值**

我正在像这样映射我的 ID：

```
Id(f => f.ID, "OID").GeneratedBy.Increment(); 
```

我的测试使用 SQLite，所以当我运行它们时，表最初是空的。

有人知道如何解决这个问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-12-12T05:52:01.037

你也可以试试：

```
Id(f => f.ID, "OID").GeneratedBy.Native() 
```

这在 SQLite 和 SQL Server 中适用于我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-19T22:50:25.777

您是否尝试过使用 GeneratedBy.Identity 而不是 GeneratedBy.Increment？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-01-08T19:59:55.153

您可以根据您的数据库系统尝试使用[seqhilo 。](http://www.nhforge.org/doc/nh/en/index.html#mapping-declaration-id-generator)**

# java - XOM v/s javax.xml.parsers

> ID：1001392
> 
> 赞同：4
> 
> 时间：2009-06-16T13:11:37.767
> 
> 标签：java, xml, xom

我想做阅读简单的 XML 文件。我发现 [了在 Java 中做 Xml 的简单方法](https://stackoverflow.com/questions/528664/simple-way-to-do-xml-in-java)

还有几个可用的解析器只是想确保使用 XOM 解析器比 suns 解析器有什么优势

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T13:13:54.177

与标准的 W3C DOM 相比，XOM*非常快。*如果这是您的首要任务，那就没有比这更好的了。

但是，它仍然是一个 DOM 类型的 API，因此它的内存效率不高。它不能替代 SAX 或 STAX。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-22T17:24:49.373

您可能想查看[有关最佳 XML 库](https://stackoverflow.com/questions/831865/what-java-xml-library-do-you-recommend-to-replace-dom4j)及其顶级 (XOM) 答案的问题；很多关于 XOM 优势的细节。（如果不清楚，请发表评论；Peter Štibraný 似乎对 XOM 了如指掌。）

如前所述，与标准 javax.xml 相比，XOM 在大多数任务中都非常快速和简单。例如，请参阅[这篇](https://stackoverflow.com/questions/428073/what-is-the-best-simplest-way-to-read-in-an-xml-file-in-java-application/963648#963648)关于在 Java 中读取 XML 文件的最简单方法的问题。我收集了一些很好的例子，这些例子让 XOM 看起来很不错（而 javax.xml 相当笨拙）。:-)

所以我个人在评估后喜欢 XOM（正如你在链接的帖子中看到的那样）；对于任何新的 Java 项目，我很可能会选择 XOM 来处理 XML。我发现的唯一缺点是它[不*直接*支持流式 XML](https://stackoverflow.com/questions/967288/how-to-stream-xml-data-using-xom)（与我来自的 dom4j 不同），但通过[简单的解决方法](https://stackoverflow.com/a/1479881/56285)，它可以很好地流式传输。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T13:23:01.317

您需要如何访问您的数据？

如果是一次性的，那么您不需要在内存中构建树。您可以使用[SAX](http://www.saxproject.org/)（快速，简单）或[StAX](http://stax.codehaus.org/Home)（更快，不太简单）。

如果您需要将树保存在内存中进行导航，[XOM](http://www.xom.nu/)或[JDOM](http://www.jdom.org/)是不错的选择。 [DOM](http://www.w3.org/DOM/)是不得已的*选择*，无论是 1、2 还是 3 级，有或没有扩展。

Xerces 是 Java 包含的解析器（尽管您应该从 Apache 获取更新版本，而不是使用 Java 捆绑的版本，即使在 6.0 中也是如此），它也有一个名为[XNI](http://xerces.apache.org/xerces2-j/xni.html)的流式原生接口。

如果您想将其他预制部件连接到链中，通常 SAX 或 StAX 效果很好，因为它们可能会在内存中构建自己的模型。例如，[Saxon](http://www.saxonica.com/) XSLT/XQuery 引擎与 DOM、SAX 或 StAX 一起工作，但在内部构建[TinyTree](http://www.saxonica.com/documentation/javadoc/net/sf/saxon/tinytree/package-summary.html)（默认）或 DOM（可选）。 [DataDirect XQuery](http://www.xquery.com/)也适用于 SAX、StAX 或 DOM，但*非常*喜欢 StAX。

# java - Sax 无效 XML 字符异常

> ID：1001400
> 
> 赞同：2
> 
> 时间：2009-06-16T13:13:17.623
> 
> 标签：java, xml, sax

我已经下载了 Stack Over Flow 站点的 xml 转储。在将转储传输到 mysql 数据库时，我一直遇到以下错误：出现异常：字符引用“某些字符集如 ”是无效的 XML 字符。

我使用 UltraEdit（它是一个 800 兆的文件）从文件中删除了一些字符，但是如果我删除了无效的字符集并运行解析器，我会收到识别更多无效字符的错误。关于如何解决这个问题的任何建议？

大家加油，

j

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T13:17:10.317

XML 中允许的字符集在[这里](http://www.w3.org/TR/2000/REC-xml-20001006#NT-Char)。如您所见，#x10 不是其中之一。如果这些存在于 stackoverflow 转储中，则它不符合 XML。

或者，您正在使用错误的字符编码读取 XML。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T13:20:10.793

你用的是哪个转储？第一个版本存在问题（不仅是无效字符，而且还`<`出现在不应该出现的地方），但它们应该在[第二个转储](https://blog.stackoverflow.com/wp-content/uploads/so-export-2009-06.7z.torrent)中得到修复。

对于它的价值，我使用两个正则表达式替换修复了原始中的无效字符。替换“�[12345678BCEF];” 和 "" 每个都带有 "?" - 当然，将它们都视为正则表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-03-18T23:01:07.860

你应该把你的文件转换成我用java开发的UTF-8，下面是我的转换

公共字符串 FileUTF8Cleaner（文件 xmlfile）{

```
 String out = xmlfile+".utf8";
    if (new File(out).exists())
        System.out.println("### File conversion process ### Deleting utf8 file");
        new File(out).delete();
        System.out.println("### File conversion process ### Deleting utf8 file [DONE!]");

    try {
        System.out.println("### File conversion process ### Converting file");
        FileInputStream fis = new FileInputStream(xmlfile);
        DataInputStream in = new DataInputStream(fis);
        BufferedReader br = new BufferedReader(new InputStreamReader(in));
        String strLine;

        FileOutputStream fos = new FileOutputStream(out);

        while ((strLine = br.readLine()) != null) {

            fos.write(strLine.replaceAll("\\p{Cc}", "").getBytes());
            fos.write("\n".getBytes());
        }

        fos.close();
        fis.close();
        in.close();
        br.close();
        System.out.println("### File conversion process ### Converting file [DONE)]");

    } catch(Exception e) {
        e.printStackTrace();
    }

        System.out.println("### File conversion process ### Processing file : "+xmlfile.getAbsolutePath()+" [DONE!]");
        return out;

} 
```

# c# - 检查非托管 DLL 是 32 位还是 64 位？

> ID：1001404
> 
> 赞同：48
> 
> 时间：2009-06-16T13:13:36.640
> 
> 标签：c#, dll, 64-bit, 32-bit

如何在 C# 中以编程方式判断*非托管*DLL 文件是 x86 还是 x64？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2009-06-16T16:46:09.033

请参阅[规格](http://www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx)。这是一个基本的实现：

```
public static MachineType GetDllMachineType (string dllPath)
{
    // See http://www.microsoft.com/whdc/system/platform/firmware/PECOFF.mspx
    // Offset to PE header is always at 0x3C.
    // The PE header starts with "PE\0\0" =  0x50 0x45 0x00 0x00,
    // followed by a 2-byte machine type field (see the document above for the enum).
    //
    using (var fs = new FileStream (dllPath, FileMode.Open, FileAccess.Read))
    using (var br = new BinaryReader (fs))
    {
        fs.Seek (0x3c, SeekOrigin.Begin);
        Int32 peOffset = br.ReadInt32();

        fs.Seek (peOffset, SeekOrigin.Begin);
        UInt32 peHead = br.ReadUInt32();

        if (peHead != 0x00004550) // "PE\0\0", little-endian
            throw new Exception ("Can't find PE header");

        return (MachineType)br.ReadUInt16();
    }
} 
```

`MachineType`枚举定义为：

```
public enum MachineType : ushort
{
    IMAGE_FILE_MACHINE_UNKNOWN = 0x0,
    IMAGE_FILE_MACHINE_AM33 = 0x1d3,
    IMAGE_FILE_MACHINE_AMD64 = 0x8664,
    IMAGE_FILE_MACHINE_ARM = 0x1c0,
    IMAGE_FILE_MACHINE_EBC = 0xebc,
    IMAGE_FILE_MACHINE_I386 = 0x14c,
    IMAGE_FILE_MACHINE_IA64 = 0x200,
    IMAGE_FILE_MACHINE_M32R = 0x9041,
    IMAGE_FILE_MACHINE_MIPS16 = 0x266,
    IMAGE_FILE_MACHINE_MIPSFPU = 0x366,
    IMAGE_FILE_MACHINE_MIPSFPU16 = 0x466,
    IMAGE_FILE_MACHINE_POWERPC = 0x1f0,
    IMAGE_FILE_MACHINE_POWERPCFP = 0x1f1,
    IMAGE_FILE_MACHINE_R4000 = 0x166,
    IMAGE_FILE_MACHINE_SH3 = 0x1a2,
    IMAGE_FILE_MACHINE_SH3DSP = 0x1a3,
    IMAGE_FILE_MACHINE_SH4 = 0x1a6,
    IMAGE_FILE_MACHINE_SH5 = 0x1a8,
    IMAGE_FILE_MACHINE_THUMB = 0x1c2,
    IMAGE_FILE_MACHINE_WCEMIPSV2 = 0x169,
    IMAGE_FILE_MACHINE_ARM64 = 0xaa64 
} 
```

我只需要其中三个，但为了完整起见，我将它们都包括在内。最终 64 位检查：

```
// Returns true if the dll is 64-bit, false if 32-bit, and null if unknown
public static bool? UnmanagedDllIs64Bit(string dllPath)
{
    switch (GetDllMachineType(dllPath))
    {
        case MachineType.IMAGE_FILE_MACHINE_AMD64:
        case MachineType.IMAGE_FILE_MACHINE_IA64:
            return true;
        case MachineType.IMAGE_FILE_MACHINE_I386:
            return false;
        default:
            return null;
    }
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-05-07T17:31:48.350

使用 Visual Studio 命令提示符，dumpbin /headers dllname.dll 也可以工作。在我的机器上，输出的开头说：

```
FILE HEADER VALUES
8664 machine (x64)
5 number of sections
47591774 time date stamp Fri Dec 07 03:50:44 2007 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-07-01T17:52:40.037

更简单：查看 System.Reflection.Module 类。它包括 GetPEKind 方法，该方法返回 2 个描述代码类型和 CPU 目标的枚举。没有更多的十六进制！

（这篇内容丰富的帖子的其余部分无耻地从[http://www.developersdex.com/vb/message.asp?p=2924&r=6413567](http://www.developersdex.com/vb/message.asp?p=2924&r=6413567)复制）

示例代码：

```
Assembly assembly = Assembly.ReflectionOnlyLoadFrom(@"<assembly Path>");
PortableExecutableKinds kinds;
ImageFileMachine imgFileMachine;
assembly.ManifestModule.GetPEKind(out kinds, out imgFileMachine); 
```

PortableExecutableKinds 可以用来检查什么样的程序集。它有 5 个值：

ILOnly：可执行文件仅包含 Microsoft 中间语言 (MSIL)，因此与 32 位或 64 位平台无关。

NotAPortableExecutableImage：该文件不是可移植可执行 (PE) 文件格式。

PE32Plus：可执行文件需要 64 位平台。

Required32Bit：可执行文件可以在 32 位平台上运行，也可以在 64 位平台上的 32 位 Windows on Windows (WOW) 环境中运行。

Unmanaged32Bit：可执行文件包含纯非托管代码。

以下是链接：

Module.GetPEKind 方法：http: [//msdn.microsoft.com/en-us/library/system.reflection.module.getpekind.aspx](http://msdn.microsoft.com/en-us/library/system.reflection.module.getpekind.aspx)

PortableExecutableKinds 枚举： http: [//msdn.microsoft.com/en-us/library/system.reflection.portableexecutablekinds (VS.80).aspx](http://msdn.microsoft.com/en-us/library/system.reflection.portableexecutablekinds(VS.80).aspx)

ImageFileMachine 枚举：http: [//msdn.microsoft.com/en-us/library/system.reflection.imagefilemachine.aspx](http://msdn.microsoft.com/en-us/library/system.reflection.imagefilemachine.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-05-08T20:55:51.690

而不是`Assembly.LoadFile`，使用`Assembly.ReflectionOnlyLoadFrom`. 这将让您解决“错误的图像格式”异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-08T22:20:45.410

我知道自从更新以来已经有一段时间了。通过将文件加载到它自己的 AppDomain 中，我能够摆脱“错误的图像格式”异常。

```
 private static (string pkName, string imName) FindPEKind(string filename)
    {
        // some files, especially if loaded into memory
        // can cause errors. Thus, load into their own appdomain
        AppDomain tempDomain = AppDomain.CreateDomain(Guid.NewGuid().ToString());
        PEWorkerClass remoteWorker =
            (PEWorkerClass)tempDomain.CreateInstanceAndUnwrap(
                typeof(PEWorkerClass).Assembly.FullName,
                typeof(PEWorkerClass).FullName);

        (string pkName, string imName) = remoteWorker.TryReflectionOnlyLoadFrom_GetManagedType(filename);

        AppDomain.Unload(tempDomain);
        return (pkName, imName);
    } 
```

此时，我执行以下操作：

```
 public (string pkName, string imName) TryReflectionOnlyLoadFrom_GetManagedType(string fileName)
    {
        string pkName;
        string imName;
        try
        {
            Assembly assembly = Assembly.ReflectionOnlyLoadFrom(assemblyFile: fileName);
            assembly.ManifestModule.GetPEKind(
                peKind: out PortableExecutableKinds peKind,
                machine: out ImageFileMachine imageFileMachine);

            // Any CPU builds are reported as 32bit.
            // 32bit builds will have more value for PortableExecutableKinds
            if (peKind == PortableExecutableKinds.ILOnly && imageFileMachine == ImageFileMachine.I386)
            {
                pkName = "AnyCPU";
                imName = "";
            }
            else
            {
                PortableExecutableKindsNames.TryGetValue(
                    key: peKind,
                    value: out pkName);
                if (string.IsNullOrEmpty(value: pkName))
                {
                    pkName = "*** ERROR ***";
                }

                ImageFileMachineNames.TryGetValue(
                    key: imageFileMachine,
                    value: out imName);
                if (string.IsNullOrEmpty(value: pkName))
                {
                    imName = "*** ERROR ***";
                }
            }

            return (pkName, imName);
        }
        catch (Exception ex)
        {
            return (ExceptionHelper(ex), "");
        }
    } 
```

对我的 Widows\Assembly 目录运行它可以让我处理超过 3600 个文件的零错误。注意：我使用字典来加载返回的值。

我希望它有所帮助。YMMV

# c# - 为什么 'Submissions.Where(s => (false && s.Status == Convert.ToInt16("")))' 会引发 FormatException？

> ID：1001407
> 
> 赞同：3
> 
> 时间：2009-06-16T13:14:06.610
> 
> 标签：c#, linq

我认为查询非常简单，但它仍然引发了 FormatException（“输入字符串格式不正确”）：

```
Submissions.Where(s => (false && s.Status == Convert.ToInt16(""))) 
```

（当然，在我的代码中，另一个计算结果为 'false' 的表达式位于 '&&' 之前）

那么，为什么要评估 '&&' 之后的部分，因为第一部分始终为 false 并且总表达式永远无法评估为`true`？

这种情况特别奇怪，因为只有`Convert.ToInt16("")`部分似乎引发了异常——我最初查询的其他部分或多或少相同的结构，比如

```
Submissions.Where(s => (false && s.SubmissionDate <= DateTime.Now)) 
```

被正确评估。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T13:38:04.500

正如其他人所指出的那样，LINQ to SQL 代码在作为 SQL 代码针对数据库运行之前被拉到一个表达式树中。由于 SQL 不一定遵循与 C# 相同的短路布尔规则，因此表达式代码的右侧可能会被解析，以便可以构造 SQL。

来自[MSDN](http://msdn.microsoft.com/en-us/library/bb386909.aspx)：

> C# 根据逻辑运算符 && 和 || 的操作数的词法顺序指定短路语义。另一方面，SQL 针对基于集合的查询，因此为优化器提供了更多自由来决定执行顺序。

至于为什么使用此代码`Convert.ToInt16("")`会出现异常，总是会准确地抛出该异常，因为无法将空字符串转换为整数。您的另一个示例不会尝试进行无效转换，因此它可以毫无问题地运行。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T13:18:16.803

如果`Submissions`是`IQueryable<T>`，那么这不是一个常规的 C# 委托，而是一个表达式树。某些代码（LINQ 提供程序）必须将这棵树拆开并理解它——因此，如果您在表达式中有奇怪的地方，那么就期待奇怪的输出。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T13:23:33.267

好吧，根据您在评论中对我的问题的回答，由于它是 Linq to Sql，因此它实际上不是代表。我尝试使用 Linq to Objects 重新创建它，果然没有任何问题。VS实际上指出“检测到无法访问的代码”。因为在您的情况下它实际上是 Linq to Sql，所以它正在构建一个表达式树，在这种情况下，它必须破译所有它并且所有赌注都关闭。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T13:34:56.537

建议：使用静态 Int16 来保存 Convert.ToInt16("") 的结果，然后在谓词中引用静态。

更好的是，你知道 Convert.ToInt16("") 的结果是什么吗？是的？然后改用它。例如，如果它为 0，则说 s.Status == 0。您甚至可以将其设为常数。

# include - 将包含目录添加到 scons

> ID：1001408
> 
> 赞同：3
> 
> 时间：2009-06-16T13:14:11.163
> 
> 标签：include, scons

我有一个项目已从 Subversion 中签出并使用 Scons 进行构建。但是，我的计算机上安装了一个 Scons 没有检测到的库 - 它只是说找不到包含文件。有什么方法可以将 Scons 定向到库位置而不更改 Sconscript 文件（因为我不想每次更新时都必须处理冲突） - 例如添加一个命令行选项，它将在之前检测到搜索包含文件？我什至看不到所有可用选项，因为它在搜索包含文件之前不响应*--help选项。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T00:29:26.590

好的，经过一番谷歌搜索后，我发现有办法做到这一点。 *gcc*有许多它搜索的默认目录（我已经知道 - 我只是不知道它们被定义为什么）。做我想做的最简单的方法是将目录添加到这些环境变量中。我需要的是

```
$CPATH 
```

这设置了 gcc 搜索其包含文件的路径。将此设置为我需要的目录解决了我的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-08-11T13:24:43.120

你可以设置 env["CPPPATH"]，但我希望有一个更简单的方法......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-20T10:48:17.537

SCons 有一个存储库的概念——用于查找源文件和目标文件的目录。这些可以在命令行上指定。

```
-Y REPOSITORY, --repository=REPOSITORY, --srcdir=REPOSITORY
                            Search REPOSITORY for source and target files. 
```

要获得 SCons 本身的帮助，请使用`-H`option。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-06-16T13:17:13.467

不，你不能，除非 scons 脚本的开发者明确添加了对它的支持。

# java - 如何在java中获取默认打印机端口号

> ID：1001418
> 
> 赞同：2
> 
> 时间：2009-06-16T13:15:30.303
> 
> 标签：java

我想访问 Java 中的默认打印机端口。

另外，我想知道默认打印机是喷墨，激光，点阵等，请提供参考。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T14:28:17.130

我猜你正在使用Windows。在这种情况下，您可以查询 Windows 注册表以查找默认打印机端口。所有系统信息都是首选项。

```
import java.util.prefs.Preferences;

....

Preferences userRoot = Preferences.userRoot();
Preferences systemRoot = Preferences.systemRoot(); 
```

有一篇很好的文章解释了如何使用**纯**java 做到这一点：

[http://lenkite.blogspot.com/2008/05/access-windows-registry-using-java.html?dzref=85420](http://lenkite.blogspot.com/2008/05/access-windows-registry-using-java.html?dzref=85420)

此外，您可能需要知道 Windows 中默认打印机的密钥：

```
HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:35:21.187

你真的需要端口号吗？如果您想从 Java 打印，您是否考虑过[Java 打印 API](http://java.sun.com/javase/technologies/desktop/printing/)？

我问的原因是您可能没有直接连接打印机。您可能有一台联网的打印机。JPA 将为您提供更可靠的接口。

# c++ - 如何定义存在于不同文件中的同名函数

> ID：1001420
> 
> 赞同：2
> 
> 时间：2009-06-16T13:15:36.417
> 
> 标签：c++

我想定义一个这样的类

```
class HttpRestAccessor
{
public:
    IResource& UpdateResource(string& , IResource& );
}; 
```

并在 cpp 文件中实现

```
IResource& HttpRestAccessor::UpdateResource(string& resourceUri, IResource& resource) 
```

这个 cpp 文件是指 Winbase.h，它定义了 UpdateResource 如下

```
#define UpdateResource  UpdateResourceW 
```

因此在编译时我得到以下错误

错误 C2039：“UpdateResourceW”：不是“RestToolkit::HttpRestAccessor”的成员

如果将函数名称重命名为不同的名称，则此问题将得到解决。但我希望将我的函数名称保留为 UpdateResource。

提前致谢， 乌代

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T13:19:19.763

只需取消定义它：

```
 #undef UpdateResource 
```

如果您确实需要，请稍后重新定义。

编辑：但是，您应该重新考虑您对重命名方法的厌恶。正如其他人所说，这是一个更优雅的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T13:18:04.167

宏完全忽略范围。

基本上，前辈会用 UpdateResourceW 查找/替换 UpdateResource，所以你都不走运了。

重命名方法是您唯一的选择

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T13:17:58.940

最简单的方法是在所有其他标头（在 stdafx.h 中）之前包含 winbase.h，这样您就不必关心方法名称是否被替换。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T13:41:17.647

重命名您的函数。如果你想使用 Windows 库，那么你必须接受它们优先，你永远不会尝试创建一个名为 std::string 的类，对吗？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T13:18:22.013

呃，这就是预处理器的坏处！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T13:18:41.280

在声明函数之前，您可以使用 #undef 预处理器指令取消定义 UpdateResource 宏。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T13:55:04.623

一种方法是记录*如果*包含 Winbase.h，则必须在此标头之前包含它。通常这将是一个可怕的要求，但是对于 Windows 标头，除非您首先包含它们（通常在预编译的标头中，如 @sharptooth 所说），否则您几乎会陷入痛苦的世界。

完成后，将其放在您的标题中：

```
#ifdef UpdateResource
#pragma push_macro("UpdateResource")
#undef UpdateResource
#endif 
```

任何人同时需要原始定义`UpdateResource`和你的类只需要放

```
#pragma pop_macro("UpdateResource") 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2009-06-16T14:07:40.183

命名空间是要走的路。

# silverlight - Silverlight (2.0/3.0) 形状下载

> ID：1001425
> 
> 赞同：0
> 
> 时间：2009-06-16T13:17:11.000
> 
> 标签：silverlight, download

有谁知道下载预建或定义的 silverlight (2.0/3.0) 形状的地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T19:35:31.253

听起来您需要了解 Xaml - 也许这些教程会有所帮助：[http ://silverlight.net/learn/videocat.aspx?cat=2#HDI2Controls](http://silverlight.net/learn/videocat.aspx?cat=2#HDI2Controls)

silverzine.com 网站也有一些很好的 Xaml how-tos。您评论的特定实例，例如带有圆角边缘的矩形和项目符号列表，可以这样构造：

```
<Border CornerRadius="20" BorderThickness="4" Width="400" Height="300" BorderBrush="Black">
    <Border.Background>
      <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
        <GradientStop Color="Black" Offset="0.0" />
        <GradientStop Color="White" Offset="1.0" />
      </LinearGradientBrush>
    </Border.Background>

    <StackPanel Margin="10" Orientation="Vertical">
      <ListBox Height="200">

        <ListBox.Items>
          <StackPanel Orientation="Horizontal">
              <Ellipse Width="10" Height="10" Stroke="Black" StrokeThickness="15" Fill="Black"/>
              <TextBlock Margin="10,4,0,0" Text="Item 1"/>
          </StackPanel>
          <StackPanel Orientation="Horizontal">
              <Ellipse Width="10" Height="10" Stroke="Black" StrokeThickness="15" Fill="Black"/>
              <TextBlock Margin="10,4,0,0" Text="Item 2"/>
          </StackPanel>
          <StackPanel Orientation="Horizontal">
              <Ellipse Width="10" Height="10" Stroke="Black" StrokeThickness="15" Fill="Black"/>
              <TextBlock Margin="10,4,0,0" Text="Item 3"/>
          </StackPanel>
        </ListBox.Items>
      </ListBox>
      <Button Margin="10" Content="Click Me!"/>
    </StackPanel>
  </Border> 
```

要回答这个问题，我不知道有哪个网站有您说您正在寻找的示例。我认为一个好的策略是缩小搜索范围，一次解决一件事。从边框开始，然后四处寻找渐变等。祝你好运！

# c# - .NET 进程间“事件”

> ID：1001433
> 
> 赞同：4
> 
> 时间：2009-06-16T13:18:28.783
> 
> 标签：c#, .net, windows, ipc

我正在运行同一应用程序的多个实例。用户询问可以在每个实例上单击“退出”以将其关闭。

我想将选项添加到“退出所有实例”，这将引发一些“事件”的孩子，通知应用程序的所有实例它们应该关闭。我不需要与此事件一起传输任何数据。

使用 C#/.NET 在 Windows 中执行此操作的最佳（最好是最简单）方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T13:21:03.897

将good'ol WM_CLOSE发送给所有实例...

```
Process[] processes = Process.GetProcesses();
string thisProcess = Process.GetCurrentProcess().MainModule.FileName;
string thisProcessName = Process.GetCurrentProcess().ProcessName;
foreach (Process process in processes)
{
   // Compare process name, this will weed out most processes
   if (thisProcessName.CompareTo(process.ProcessName) != 0) continue;
   // Check the file name of the processes main module
   if (thisProcess.CompareTo(process.MainModule.FileName) != 0) continue;
   if (Process.GetCurrentProcess().Id == process.Id) 
   {
     // We don't want to commit suicide
     continue;
   }
   // Tell the other instance to die
   Win32.SendMessage(process.MainWindowHandle, Win32.WM_CLOSE, 0, 0);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T13:46:09.977

System.Diagnostics.Process 类有几个可以使用的方法。

Process.GetProcessesByName 将让您枚举所有实例：

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getprocessesbyname.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.getprocessesbyname.aspx)

然后 Process.CloseMainWindow 或 Process.Close 将关闭它们：

[http://msdn.microsoft.com/en-us/library/system.diagnostics.process.closemainwindow.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.closemainwindow.aspx) [http://msdn.microsoft.com/en-us/library/system.diagnostics.process.close.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.close.aspx)

# iphone - 如何在 iPhone 上从堆栈中弹出视图控制器后自动调用方法

> ID：1001441
> 
> 赞同：10
> 
> 时间：2009-06-16T13:19:08.360
> 
> 标签：iphone, model-view-controller, view, uiview, stack

从导航堆栈中弹出子视图后，我需要更新 iPhone 上的父视图。如何设置父视图以在子视图从堆栈中弹出并且父视图再次可见时收到通知或接收自动方法调用？

用户在用户完成后在子页面上输入要在父页面上显示的数据并弹出视图。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-01-23T07:50:37.793

我刚刚解决了这个同样的问题 - 上面的答案几乎是正确的，他们只是忘记了设置委托。

我有一个显示列表大小的根视图控制器，调用可能改变列表大小的子视图控制器，并且必须在返回时更新大小。

当我创建父视图（下面的 SettingsView）并将其添加为 UINavigationController 的根视图时，我确保在显示视图之前设置 UINavigationController 的委托 - 这是关键部分：

```
SettingsView *sv = [[SettingsView alloc] initWithNibName:@"SettingsView" bundle:nil];
UINavigationController *nc = [[UINavigationController alloc] initWithRootViewController:sv];
[nc setDelegate:sv]; 
```

在父视图中，实现 UINavigationControllerDelegate 协议：

```
@interface SettingsView : UIViewController <UINavigationControllerDelegate> 
```

并提供 willShowViewController 方法：

```
- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated
{
    // Your code to update the parent view
} 
```

这在子视图被关闭之后，父视图重新显示之前调用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-16T13:34:24.383

我也需要做这样的事情。在拥有我的**UINavigationController的****ViewController**中，我必须实现*willShowViewController*，如下所示：

 ***```
- (void)navigationController:(UINavigationController *)navigationController willShowViewController:(UIViewController *)viewController animated:(BOOL)animated {
} 
```

每当 UINavigationController 更改视图时，都会调用该方法。如果我正确理解了您的问题，我认为这应该可以满足您的要求。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T17:47:10.933

我认为这里有些混乱。`UIView`s 不会被压入或从`UINavigationController`' 的堆栈中弹出。被推送和弹出的是`UIViewControllers`，它们依次处理一个或（更经常）几个视图。

幸运的是，`UIViewController`有这些方法：

```
-(void) viewWillAppear:(BOOL)animated;
-(void) viewDidAppear:(BOOL)animated;
-(void) viewWillDisappear:(BOOL)animated;
-(void) viewDidDisappear:(BOOL)animated; 
```

每当视图即将 (dis) 出现或刚刚 (dis) 出现时，都会调用这些函数。我使用标签栏、模式视图和导航控制器。（当您实现自定义控制器时，使用这些是一个好主意。）

因此，在您的情况下，如果我理解正确，您只需覆盖您所谓的“父页面”（可能由 a 处理）上的`viewWillAppear`: 或: 方法并输入代码以更新页面的外观以反映刚刚输入的数据。`viewDidAppear``UIViewController`

（如果我没记错的话，您必须确保在首次显示时`UINavigationController`收到一条`viewWill/DidAppear:`消息，以便稍后将这些消息发送到其子控制器。如果您使用模板或在 IB 中进行设置，您可能不会不必担心。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-10T20:22:35.657

Felixyz 的回答对我有用。每次视图出现时，调用 view will appear 方法都会运行其中的代码。与 view did load 不同，后者仅在第一次加载视图时运行其代码。因此，如果子视图更改了父视图中显示的信息，您的父视图将不会自行更新，然后被弹出。但是如果父母调用视图将出现，则每次视图显示备份时都会运行代码。

确保同时调用超级方法。正确的实现如下所示：

```
- (void)viewWillAppear:(BOOL)animated
{
   [super viewWillAppear:animated];
    NSLog(@"View Appearing");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T20:10:16.550

如果您需要将一个控制器通知给另一个控制器，您可以使用此处描述的委托模式[（参见第二个答案）](https://stackoverflow.com/questions/244588/is-parentviewcontroller-always-a-navigation-controller/994164#994164)。

不幸的是，您描述的确切任务没有自动通知（AFAIK）。*为了满足您的需要，您可以在您的子控制器的viewWillDisappear*函数中向委托（即您的父控制器）发送消息。***

# c++ - 使用 CppUnit 进行内存泄漏检测

> ID：1001448
> 
> 赞同：6
> 
> 时间：2009-06-16T13:20:12.337
> 
> 标签：c++, unit-testing, memory-leaks, cppunit

是否有人知道 CppUnit 的扩展，可用于在逐个测试的基础上做出有关内存泄漏的断言。

即 CPPUNIT_ASSERT_NO_LEAKS()？

本质上，当测试的执行导致内存泄漏时，我希望能够使特定测试失败。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T13:44:53.113

如果您在 Linux 上运行，则可以使用[memcheck](http://valgrind.org/docs/manual/quick-start.html#quick-start.mcrun)运行测试。

手册的[客户端请求](http://valgrind.org/docs/manual/mc-manual.html#mc-manual.clientreqs)部分描述了几个有用的宏，其中一个被指出对测试很有用：

> `VALGRIND_COUNT_LEAKS`: 用之前的泄漏检查发现的要泄漏、可疑、可达和抑制的内存字节数填充四个参数。同样，在调用`VALGRIND_DO_LEAK_CHECK`.

宏在`memcheck.h`（可能在`/usr/include/valgrind`）中定义，您想要的序列将类似于

```
unsigned long base_definite, base_dubious, base_reachable, base_suppressed;
VALGRIND_DO_LEAK_CHECK;
VALGRIND_COUNT_LEAKS(base_definite, base_dubious, base_reachable, base_suppressed);
// maybe assert that they're zero!

// call test

unsigned long leaked, dubious, reachable, suppressed;
VALGRIND_DO_LEAK_CHECK;
VALGRIND_COUNT_LEAKS(leaked, dubious, reachable, suppressed);
CPPUNIT_ASSERT_EQUAL(base_leaked, leaked);
// etc. 
```

对每个测试重复这一点会很痛苦，因此您可以编写自己的宏，或者更好的是，编写专门的[TestRunner](http://cppunit.sourceforge.net/doc/lastest/class_test_runner.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T14:06:04.227

CPPUNIT 默认不支持内存泄漏检查。

该项目现已重新启动（已停止很长时间），这可能是 CPPUNIT2 的一个特性，您可以向作者提出（或写信）。

如果您正在寻找支持内存泄漏检测的单元测试框架，您可以尝试查看[CppUTest](http://www.cpputest.org/)。这是 Martin Fowler 和 Bob Martin 在一些 TDD 课程中使用的项目。这是相当不错的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T14:30:04.880

在 Windows 上，使用对调试堆的一些调用来让 CppUnit 使用`_CrtMemCheckpoint()`和处理此信息是一件非常简单的事情`_CrtMemDifference()`：

*   [http://msdn.microsoft.com/en-us/library/wc28wkas.aspx](http://msdn.microsoft.com/en-us/library/wc28wkas.aspx)

有以下缺点：

*   您必须在测试开始时手动放置一些东西才能获得检查点（也许有一种方法可以以某种方式将其集成到 CppUnit 中）
*   它只是 Windows（在其他各种平台上可能有类似的东西）
*   它仅适用于使用 Debug CRT 的构建

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-18T13:44:30.100

在我工作的地方，我们使用 purify 构建我们的单元测试。然后我们的持续集成平台提取成功/失败的测试用例数量和泄漏字节数（+ lint 和覆盖结果），并将其显示在网页上。我强烈建议这样做。

很抱歉没有提供您想要的解决方案。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-07-09T02:43:45.760

我知道现在回答这个问题有点太晚了。但这是来自 Microsoft 的一个很棒的工具。我现在是 linux 用户，但我在 Windows（Visual C++ 和 Qt）中编写代码时使用过它 [http://www.microsoft.com/en-us/download/details.aspx?id=20028](http://www.microsoft.com/en-us/download/details.aspx?id=20028)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T13:27:32.680

不知道，但是您可以使用 Fluid Studios Memory Manager 代码之类的东西，并通过一些调整将其挂钩。或者将其编译到您的测试应用程序中，然后有一个脚本为每个测试运行一次应用程序并整理内存跟踪结果。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T23:57:58.790

I know it's not CppUnit, but boost::test can do memory leak detection.

From [http://www.boost.org/doc/libs/1_39_0/libs/test/doc/html/execution-monitor/user-guide.html](http://www.boost.org/doc/libs/1_39_0/libs/test/doc/html/execution-monitor/user-guide.html "boost.org"):

`void detect_memory_leaks( bool on_off );`

`void break_memory_alloc( long mem_alloc_order_num );`

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-16T14:15:49.463

[使用valgrind](http://valgrind.org/)运行单元测试。我使用的单元测试框架允许您运行一个或多个单独的单元测试，这样您就可以检测出哪个导致了泄漏。

# user-interface - Mercurial 和 gwsmhg

> ID：1001449
> 
> 赞同：0
> 
> 时间：2009-06-16T13:20:18.920
> 
> 标签：user-interface, mercurial

有没有人为 Mercurial 使用 gwsmhg GUI 工具？在 Windows 上运行它有什么运气吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T15:12:14.780

为什么不在[Mercurial 邮件列表](http://www.selenic.com/mercurial/wiki/MailingLists)上问这样的问题呢？我希望这是一个更好的论坛来解决这些问题。

我搜索了一下，发现[之前关于 gwsmhg](http://mercurial.markmail.org/search/gwsmhg)的一些讨论。在那里它与[TortoiseHg](http://bitbucket.org/tortoisehg/stable/wiki/Home)进行了比较，消息是它可能更好地管理[mq 补丁](http://www.selenic.com/mercurial/wiki/MqExtension)。（但我还没有尝试过 gwsmhg。）

# jquery - 从值中选择单词

> ID：1001455
> 
> 赞同：0
> 
> 时间：2009-06-16T13:22:08.590
> 
> 标签：jquery

我有输入

```
<input type="hidden" value="Select Value 11121 DataValue " name="111" id="222"/> 
```

我用 jQuery 选择值

```
alert( $('#222').val() ); 
```

但

如何使用 jQuery 从该输入值中仅选择“11121”？

我可以创建一个过滤器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T13:25:58.533

创建四个隐藏的输入是否更有意义，每个输入都有一个值之一

在你的帖子里？我会这样做，而不是尝试从单个输入值中解析出某些字符串。只需给每个人一个唯一的 ID，然后从那里开始。

如果您真的想保留一个，您可以执行以下操作：

```
<input type="hidden" value="Value1 Value2 Value3 Value4" id="some_id" name="some_name" /> 
```

并通过以下方式提取值：

```
var vals = $('#some_id').val().split(/\W+/); 
```

然后按位置访问它们：

```
var val1 = vals[0]; // "Value1"
var val2 = vals[1]; // "Value2"
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T13:31:44.530

您可以使用 javascript 正则表达式从该字符串中获取数值：

```
var regex = new RegExp(/\d{5}/igm);

var myNumericValue = regex.exec($('#222').val()); 
```

# ruby-on-rails - Ruby on Rails：在 Ubuntu 9.0.4 中安装 gitorious 时出现问题

> ID：1001458
> 
> 赞同：-1
> 
> 时间：2009-06-16T13:22:36.327
> 
> 标签：ruby-on-rails, ruby, rake, ubuntu-9.04, gitorious

我似乎无法安装 Gitorious。我试图不安装 Ruby 企业版，但除此之外，我一直遵循 Ubunut 的说明（有一些错误，但我已经解决了这些错误）。我已经安装了许多缺少的包和 gem，但是现在当我尝试迁移数据库时我被卡住了。我收到以下错误：

耙中止！

nil:NilClass 的未定义方法“[]”

跟踪看起来像这样：

```
/var/www/gitorious/config/environments/production.rb:39:in `load_environment'
/var/www/gitorious/config/../vendor/rails/railties/lib/initializer.rb:386:in `load_environment'
/var/www/gitorious/vendor/rails/activesupport/lib/active_support/core_ext/kernel/reporting.rb:11:in `silence_warnings'
/var/www/gitorious/config/../vendor/rails/railties/lib/initializer.rb:379:in `load_environment'
/var/www/gitorious/config/../vendor/rails/railties/lib/initializer.rb:137:in `process'
/var/www/gitorious/config/../vendor/rails/railties/lib/initializer.rb:113:in `send'
/var/www/gitorious/config/../vendor/rails/railties/lib/initializer.rb:113:in `run'
/var/www/gitorious/config/environment.rb:13
/usr/lib/ruby/1.8/rubygems/custom_require.rb:32:in `gem_original_require'
/usr/lib/ruby/1.8/rubygems/custom_require.rb:32:in `require'
/var/www/gitorious/vendor/rails/activesupport/lib/active_support/dependencies.rb:156:in `require'
/var/www/gitorious/vendor/rails/activesupport/lib/active_support/dependencies.rb:521:in `new_constants_in'
/var/www/gitorious/vendor/rails/activesupport/lib/active_support/dependencies.rb:156:in `require'
/var/www/gitorious/vendor/rails/railties/lib/tasks/misc.rake:4
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:636:in `call'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:636:in `execute'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:631:in `每个'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:631：在“执行”中
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:597:in `invoke_with_call_chain'
/usr/lib/ruby/1.8/monitor.rb:242:在“同步”中
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:607:in `invoke_prerequisites'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:604:in `每个'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:604:in `invoke_prerequisites'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:596:in `invoke_with_call_chain'
/usr/lib/ruby/1.8/monitor.rb:242:在“同步”中
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:590:in `invoke_with_call_chain'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:583:in `invoke'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:2051:in `invoke_task'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:2029:in `top_level'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:2029:in `每个'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:2029:in `top_level'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:2023:in `top_level'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:2001:在“运行”中
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:2068:in `standard_exception_handling'
/var/lib/gems/1.8/gems/rake-0.8.7/lib/rake.rb:1998:在“运行”中
/var/lib/gems/1.8/gems/rake-0.8.7/bin/rake:31
/var/lib/gems/1.8/bin/rake:19:in `load'
/var/lib/gems/1.8/bin/rake:19

```

我的理解是我声称我缺少一些依赖项，但我检查了 /var/www/gitorious/config/environment.rb 中的依赖项是否已安装。

我还在 custom_require.rb 中放了一个打印来打印路径变量，最后一个打印是“active_support/dependencies”。

有谁知道问题是什么或我该如何进一步调试？我可以以某种方式打印确切的缺失依赖项吗？甚至可以在不安装整个 Ruby 企业版的情况下安装 gitorious 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-17T08:42:46.680

我从 Gitorious 讨论组询问了这个问题，原因是默认的 gitorious.yml 文件只有测试环境的设置。通过将这些设置复制到生产环境，我解决了这个问题。

# actionscript - 如何从 actionscript 中获取在线时间？

> ID：1001461
> 
> 赞同：0
> 
> 时间：2009-06-16T13:23:14.313
> 
> 标签：actionscript, time

我需要能够从在线资源而不是系统中找到当前时间，以确保时间正确。我需要在 actionscript 中执行此操作，最好是 2 而不是 3，但如果您有任何解决方案，请发布它。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T13:32:56.477

这是一个可能的参考：[http ://board.flashkit.com/board/showthread.php?t=663535](http://board.flashkit.com/board/showthread.php?t=663535)

最简单的解决方案可能如上所述，创建一个服务器端脚本以返回时间，然后在您的 ActionScript 中获取该时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:06:18.927

另一种选择是在 ActionScript 中创建 NTP 客户端。不幸的是，我已经有一段时间没有做任何动作脚本了，但是如果有人想做一个端口，这里有一个 Python 中的简单示例：http: [//maxinbjohn.blog.com/2366141/](http://maxinbjohn.blog.com/2366141/)

# c# - 如何在 LINQ 中实现动态“where”子句？

> ID：1001462
> 
> 赞同：12
> 
> 时间：2009-06-16T13:23:15.467
> 
> 标签：c#, linq, linq-to-sql

我想要一个动态的`where`条件。

在以下示例中：

```
var opportunites =  from opp in oppDC.Opportunities
                    join org in oppDC.Organizations 
                        on opp.OrganizationID equals org.OrgnizationID
                    where opp.Title.StartsWith(title)
                    select new
                    {
                        opp.OpportunityID,
                        opp.Title,
                        opp.PostedBy,
                        opp.Address1,
                        opp.CreatedDate,
                        org.OrganizationName
                    }; 
```

有时我有`Title`，有时我没有。而且我还想在`where`子句中动态添加日期。

例如，像这样的 SQL：

```
string whereClause;
string SQL = whereClause == string.Empty ? 
     "Select * from someTable" : "Select * from someTable" + whereclause 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-06-16T13:25:37.257

你可以像这样重写它：

```
 var opportunites =  from opp in oppDC.Opportunities
                            join org in oppDC.Organizations on opp.OrganizationID equals org.OrgnizationID
                            select new
                            {
                                opp.OpportunityID,
                                opp.Title,
                                opp.PostedBy,
                                opp.Address1,
                                opp.CreatedDate,
                                org.OrganizationName
                            };

if(condition)
{
   opportunites  = opportunites.Where(opp => opp.Title.StartsWith(title));
} 
```

**编辑：**要在评论中回答您的问题，是的，您可以继续附加到原始 Queryable。请记住，这一切都是延迟执行的，所以此时它正在构建 IQueryable 以便您可以根据需要继续将它们链接在一起：

```
if(!String.IsNullOrEmpty(title))
{
   opportunites  = opportunites.Where(.....);
}

if(!String.IsNullOrEmpty(name))
{
   opportunites  = opportunites.Where(.....);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T13:26:22.777

您可以像这样向 IQueryable 表达式动态添加 where 子句：

```
var finalQuery = opportunities.Where( x => x.Title == title ); 
```

和类似的日期。

***但是，如果***您的匿名类型不包含您要在 where 子句中查询的字段，则您必须等到动态添加 where 子句后才能创建匿名类型。

所以你可能有这样的东西：

```
var opportunities =  from opp in oppDC.Opportunities
                    join org in oppDC.Organizations on 
                    opp.OrganizationID equals org.OrgnizationID
                    select opp                            

if(!String.IsNullOrEmpty(title))
{
   opportunities = opportunities.Where(opp => opp.Title == title);
}

//do the same thing for the date

opportunities = from opp in opportunities
                select new
                        {
                            opp.OpportunityID,
                            opp.Title,
                            opp.PostedBy,
                            opp.Address1,
                            opp.CreatedDate,
                            org.OrganizationName
                        }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T13:27:19.560

WHERE 子句可以做类似的事情

```
//...
where string.IsNullOrEmpty(title) ? true : opp.Title.StartsWith(title)
//... 
```

我认为在 LINQ 中不可能动态返回记录，因为它需要能够创建一致的 AnonymousType（在后台）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T13:30:05.610

因为查询是可组合的，所以您可以分步构建查询。

```
var query = table.Selec(row => row.Foo);

if (someCondition)
{
    query = query.Where(item => anotherCondition(item));
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T13:34:04.523

如果您事先知道所有可能的查询，如您给出的 SQL 示例中的查询，您可以编写这样的查询

```
from item in Items
where param == null ? true : ni.Prop == param
select item; 
```

如果您事先不知道所有可能的 where 子句，您可以动态添加 where 子句，例如：

```
query = query.Where(item => item.ID != param); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-16T13:42:52.917

以下问题和答案很好地解决了这个问题：

> [LINQ 中的动态 where 子句 - 列名在运行时可用](https://stackoverflow.com/questions/234439/dynamic-where-clause-in-linq-with-column-names-available-at-runtime)
> [是否有使用 Linq 动态创建过滤器的模式？](https://stackoverflow.com/questions/30879/is-there-a-pattern-using-linq-to-dynamically-create-a-filter)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-11-20T07:33:32.580

我正在寻找在 LINQ 中创建动态 where 子句，并在网络上遇到了一个非常漂亮的解决方案，它在 C# 中使用 ExpressionBuilder。

我在这里发布它，因为上述解决方案都没有使用这种方法。它帮助了我。希望它也能帮助你 [http://www.codeproject.com/Tips/582450/Build-Where-Clause-Dynamically-in-Linq](http://www.codeproject.com/Tips/582450/Build-Where-Clause-Dynamically-in-Linq)

# actionscript-3 - 在 Flex 3 中使用列表组件

> ID：1001473
> 
> 赞同：0
> 
> 时间：2009-06-16T13:26:09.953
> 
> 标签：actionscript-3, flex3

如何为每个列表对象设置一个背景图像，并在翻转时使用不同的背景图像。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-18T02:31:40.810

为列表使用自定义项目渲染器。然后制作一个翻转处理程序，在翻转时切换图像。

[Flex 快速入门：构建高级用户界面](http://www.adobe.com/devnet/flex/quickstart/using_item_renderers/)

# c# - 从匿名方法调用带有 ref 或 out 参数的方法

> ID：1001475
> 
> 赞同：5
> 
> 时间：2009-06-16T13:26:29.547
> 
> 标签：c#, .net

这个问题与[我前几天问的一个](https://stackoverflow.com/questions/995377/delegate-signature-generic-delegate)问题有关，我从中得到了一些很好的有用答案。

我需要以通用方式调用具有不同签名的各种 Web 方法。我希望能够将 web 方法传递给具有委托参数的方法，但我不确定如何处理不同的签名。解决方案是使用 lambdas（或我目前使用 C#2 的匿名方法）。

这工作得很好，直到我需要我的匿名方法来调用没有参数的 web 方法。[由于此处解释](https://stackoverflow.com/questions/801147/scope-of-anonymous-methods)的原因，您不能这样做。

所以我的问题是，除了创建一个没有 ref 或 out 参数的包装器方法来从我的匿名方法调用之外，是否有更简单的方法来实现这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-16T13:33:13.887

实际上，您*可以*使用`ref`and `out`- 只是不能**直接**与调用方法的参数一起使用；但是，您可以在调用之前和之后复制值：

```
static void Foo(ref string s, out int i)
{
    string tmpS = s;
    int tmpI = 0; // for definite assignment
    DoIt(delegate { Bar(ref tmpS, out tmpI); });
    s = tmpS;
    i = tmpI;
} 
```

# .net - Visual Studio 设置文件 - 它是如何工作的？

> ID：1001487
> 
> 赞同：8
> 
> 时间：2009-06-16T13:29:59.697
> 
> 标签：.net, visual-studio, visual-studio-2008, settings

我不明白以下几点：

1.  app.config (applicationname.exe.config) 和设置文件有什么区别？
2.  我无法在特定帐户下的 Windows7 AppData 目录中找到 *.settings 文件（我听说它应该位于那里的某个地方）？
3.  假设 *.settings 文件位于硬盘驱动器的某个位置。为什么在开发时将设置文件中的数据复制到应用程序配置文件中？

亲切的问候 PK

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-19T06:04:07.673

因此，**默认设置**存储在与`<exename>.config`可执行文件位于同一目录的文件中。

您找不到 user.config 文件的原因是它仅在您更改默认值时创建。用户设置会覆盖`<exename>.config`文件中存储的默认值。**如果未进行任何更改，则不存在用户配置文件。** 而且...一旦它确实存在，您会注意到只有已更改的设置才会显示在 user.config 文件中。

要对此进行测试...在您的设置文件中创建一个名为 temp 的虚拟变量。当您启动应用程序时，请执行以下操作：

```
Settings1.Default.temp = Settings1.Default.temp + 1;
Settings1.Default.Save(); 
```

您现在将在用户的 ApplicationData 文件夹中创建一个名为 user.config 的文件，该文件夹在 Vista 中位于：`C:\Users\<username>\AppData\Local\<company>\<productname>`

这是我编写的一些代码，用于帮助识别不同操作系统上所有各种 SpecialFolders 的位置。（可能想做一个查找替换`log.Debug`并替换为`Console.WriteLine`）

```
log.Debug("SpecialFolder.ApplicationData: " + Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData ));
log.Debug("SpecialFolder.CommonApplicationData: " + Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData ));
log.Debug("SpecialFolder.ProgramFiles: " + Environment.GetFolderPath(Environment.SpecialFolder.ProgramFiles));
log.Debug("SpecialFolder.CommonProgramFiles: " + Environment.GetFolderPath(Environment.SpecialFolder.CommonProgramFiles ));
log.Debug("SpecialFolder.DesktopDirectory: " + Environment.GetFolderPath(Environment.SpecialFolder.DesktopDirectory ));
log.Debug("SpecialFolder.LocalApplicationData: " + Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData ));
log.Debug("SpecialFolder.MyDocuments: " + Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments ));
log.Debug("SpecialFolder.System: " + Environment.GetFolderPath(Environment.SpecialFolder.System )); 
```

Windows Server 2003 上的输出：

```
SpecialFolder.ApplicationData: "C:\Documents and Settings\blake\Application Data"
SpecialFolder.CommonApplicationData: "C:\Documents and Settings\All Users\Application Data"
SpecialFolder.ProgramFiles: "C:\Program Files"
SpecialFolder.CommonProgramFiles: "C:\Program Files\Common Files"
SpecialFolder.DesktopDirectory: "C:\Documents and Settings\blake\Desktop"
SpecialFolder.LocalApplicationData: "C:\Documents and Settings\blake\Local Settings\Application Data"
SpecialFolder.MyDocuments: "C:\Documents and Settings\blake\My Documents"
SpecialFolder.System: "C:\WINDOWS\system32" 
```

Vista上的输出：

```
SpecialFolder.ApplicationData: "C:\Users\blake\AppData\Roaming"
SpecialFolder.CommonApplicationData: "C:\ProgramData"
SpecialFolder.ProgramFiles: "C:\Program Files"
SpecialFolder.CommonProgramFiles: "C:\Program Files\Common Files"
SpecialFolder.DesktopDirectory: "C:\Users\blake\Desktop"
SpecialFolder.LocalApplicationData: "C:\Users\blake\AppData\Local"
SpecialFolder.MyDocuments: "C:\Users\blake\Documents"
SpecialFolder.System: "C:\Windows\system32" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T14:59:01.827

1.  app.config 文件代表应用程序固有的设置，并将应用于应用程序的所有会话。*.settings 文件通常用于特定于给定用户使用应用程序的设置。

2.  尝试查看 Local Settings [«username»\Local Settings\Application Data\«app name ...»] 下的 Application Data 目录，而不是用户的直接 Application Data 目录 [«username»\Application Data]。

3.  app.config 文件中给定 *.settings 文件的设置副本用于在第一次使用这些设置时对其进行初始化；包括添加新设置并且 *.settings 文件的先前副本还没有新设置的情况。

这是 C# 中设置的简要演练的链接。

[在 C# 中使用设置 (MSDN)](http://msdn.microsoft.com/en-us/library/aa730869(VS.80).aspx)

# asp.net - 是否可以使用 Membership API 更改用户名

> ID：1001491
> 
> 赞同：32
> 
> 时间：2009-06-16T13:30:39.553
> 
> 标签：asp.net, asp.net-membership, membership, membership-provider, sqlmembershipprovider

我在 ASP.NET 中使用默认的 sql 成员资格提供程序，我想提供一个页面来更改用户的用户名。我相信我确信我可以使用自定义提供程序来做到这一点，但是这可以使用默认提供程序来完成吗？

我的问题的第二部分是：我应该允许用户在创建帐户后更改他们的用户名吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-06-16T14:03:10.143

确实，默认的 SQL Membership Provider 不允许更改用户名。但是，如果您的站点上有有效的参数允许用户更改用户名，则没有内在的理由阻止用户更改用户名。SQL 数据库中的所有表都没有用户名作为键，一切都基于用户的 ID，因此从实现的角度来看，这将是相当容易的。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2011-02-27T11:35:38.173

如果你使用`SqlMembershipProvider`，你可以扩展它——它也与[这个问题有关](https://stackoverflow.com/questions/3762567/custom-asp-net-sqlmembershipprovider-handling-connection-string)。
[Roadkill](http://roadkill.codeplex.com/)是一个 wiki 引擎，不是对我的编码风格的描述。

```
using System;
using System.Web.Security;
using System.Configuration;
using System.Data.SqlClient;
using System.Data;
using System.Web.Configuration;

namespace Roadkill.Core
{
    public class RoadkillMembershipProvider : SqlMembershipProvider
    {
        private string _connectionString;

        protected string ConnectionString
        {
            get
            {
                if (string.IsNullOrWhiteSpace(_connectionString))
                {
                    Configuration config = System.Web.Configuration.WebConfigurationManager.OpenWebConfiguration("~");
                    MembershipSection section = config.SectionGroups["system.web"].Sections["membership"] as MembershipSection;
                    string defaultProvider = section.DefaultProvider;
                    string connstringName = section.Providers[defaultProvider].ElementInformation.Properties["connectionStringName"].Value.ToString();
                    _connectionString = config.ConnectionStrings.ConnectionStrings[connstringName].ConnectionString;
                }

                return _connectionString;
            }
        }

        public bool ChangeUsername(string oldUsername, string newUsername)
        {
            if (string.IsNullOrWhiteSpace(oldUsername))
                throw new ArgumentNullException("oldUsername cannot be null or empty");

            if (string.IsNullOrWhiteSpace(newUsername))
                throw new ArgumentNullException("newUsername cannot be null or empty");

            if (oldUsername == newUsername)
                return true;

            using (SqlConnection connection = new SqlConnection(ConnectionString))
            {
                connection.Open();

                using (SqlCommand command = connection.CreateCommand())
                {
                    command.CommandText = "UPDATE aspnet_Users SET UserName=@NewUsername,LoweredUserName=@LoweredNewUsername WHERE UserName=@OldUsername";

                    SqlParameter parameter = new SqlParameter("@OldUsername", SqlDbType.VarChar);
                    parameter.Value = oldUsername;
                    command.Parameters.Add(parameter);

                    parameter = new SqlParameter("@NewUsername", SqlDbType.VarChar);
                    parameter.Value = newUsername;
                    command.Parameters.Add(parameter);

                    parameter = new SqlParameter("@LoweredNewUsername", SqlDbType.VarChar);
                    parameter.Value = newUsername.ToLower();
                    command.Parameters.Add(parameter);

                    return command.ExecuteNonQuery() > 0;
                }
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-28T05:17:01.560

Scott Mitchell 有一篇很棒的文章描述了如何处理这种情况： [http ://www.4guysfromrolla.com/articles/070109-1.aspx](http://www.4guysfromrolla.com/articles/070109-1.aspx)

他文章中的重要引述：

**不幸的是，理想主义和实用主义很少交叉。在某些情况下——比如允许用户更改他们的用户名——我们别无选择，只能直接使用底层数据存储。**

他还展示了如何在更改用户名/电子邮件后重新验证用户。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2010-11-01T16:29:32.520

如果您想使用 Membership API 做到这一点，正确的方法似乎是这样的：

[http://omaralzabir.com/how_to_change_user_name_in_asp_net_2_0_membership_provider/](http://omaralzabir.com/how_to_change_user_name_in_asp_net_2_0_membership_provider/)

基本上，您必须执行以下操作（为了完整起见，我从上面的链接中复制）：

1.  使用新电子邮件地址创建新用户
2.  获取旧账号的密码，设置为新账号。如果您无法通过会员服务提供商获取旧密码，请询问用户。
3.  为新用户帐户创建新配置文件
4.  将旧配置文件中的所有属性复制到新配置文件对象。
5.  从旧帐户注销用户
6.  自动登录到新帐户，这样用户就不会注意到刚刚发生了什么不可思议的事情。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-12-29T09:20:50.057

由于 Membership API 不允许直接修改用户名，因此您可以直接访问`aspnet_Membership`数据库中的表。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-17T16:42:39.080

这是一个包含 Enterprise Libraries DAB 和其他一些小改动的版本。另外，我认为返回布尔值没有意义，因为它要么成功要么抛出异常。

```
 public static void ChangeUsername(string oldUsername, string newUsername)
    {
        if (string.IsNullOrWhiteSpace(oldUsername))
        {
            throw new ArgumentNullException("oldUsername cannot be null or empty");
        }

        if (string.IsNullOrWhiteSpace(newUsername))
        {
            throw new ArgumentNullException("newUsername cannot be null or empty");
        }

        if (oldUsername.Equals(newUsername))
        {
            return;
        }

        Database db = DatabaseFactory.CreateDatabase();
        using (DbCommand cmd = db.GetSqlStringCommand("UPDATE dbo.aspnet_Users SET UserName=@NewUsername, LoweredUserName=@LoweredNewUsername WHERE UserName=@OldUsername"))
        {
            db.AddInParameter(cmd, "@OldUsername", DbType.String, oldUsername);
            db.AddInParameter(cmd, "@NewUsername", DbType.String, newUsername);
            db.AddInParameter(cmd, "@LoweredNewUsername", DbType.String, newUsername.ToLower());

            db.ExecuteNonQuery(cmd);                
        }
    } 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-06-16T13:41:39.313

不，MembershipUser 类不允许修改 Username 属性，因此您不能这样做。

实际上，您不应该允许更改用户名。如果您允许以某种方式这样做，那么它将失去其目的和性质。

# sharepoint - 使用文档库的自定义列表定义

> ID：1001495
> 
> 赞同：1
> 
> 时间：2009-06-16T13:31:43.467
> 
> 标签：sharepoint

我创建了一个基于文档库列表的自定义列表定义。我的列表定义出现在“创建页面”中的自定义列表组下，但是当我尝试通过输入名称和定义并单击创建来基于自定义定义实例化一个新列表时 -

它显示带有错误消息***“未找到文件”的错误页面。***

关于该文件可能是运行时正在寻找的任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T14:23:02.617

在所有日志条目中，我发现有两个我认为可能相关 -

1.  未能在“12\Template\Features\\feature.xml”位置找到 XML 文件

2.  和一组重复的四个条目，如下所示 -

无法确定 ID 为“e2205d5b-5eda-40f8-b5e4-3f97d2375059”的功能的定义。跳过此功能以考虑元素查询。无法确定 ID 为“53b158d4-921d-4d17-99a7-6d3727611198”的功能的定义。跳过此功能以考虑元素查询。无法确定 ID 为“08d4396c-80a1-427d-9b6f-da64ba153f43”的功能的定义。跳过此功能以考虑元素查询。无法确定 ID 为“72a1f18e-c4d4-4e3c-b531-e1ccf702489e”的功能的定义。' 考虑元素查询跳过此功能。

- 不知道为什么它试图在第 1 点中找到 XML 文件。（该文件夹在前一段时间被删除） -我认为这些条目是针对***我删除文件夹的功能而没有先 Unstalling and Deactivating the Features***。

# silverlight - 如何将我的 XAML 内容保存到文件中？

> ID：1001498
> 
> 赞同：0
> 
> 时间：2009-06-16T13:32:44.323
> 
> 标签：silverlight

我有个问题。我想将 XAML 状态保存到文件中，或者类似的东西。我开发了一个 Silverlight 版本的 PowerPoint，现在我想保存我的演示文稿，但我不知道如何...我正在使用 Silverlight 3 beta（如果有帮助）...

我想允许用户在某处上传他们的照片、音乐和视频文件......我在哪里以及如何做到这一点？

谢谢，安德烈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T15:15:06.397

嗯，这是一个艰难的。WPF 有 Xaml Writer 可以发送该状态。Silverlight 没有:(

您正在做的事情听起来很像[Mike Harsh 的 Silverlight 3 示例](http://blogs.msdn.com/mharsh/archive/2009/03/18/silverlight-3-beta-sample-slidentity-presentation-creation-app.aspx)。他的来源是可用的；也许这将提供一个合适的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-15T14:49:53.217

我通过将数据保存在 XML 文件中解决了这个问题。当我想重新创建应用程序的状态时，我从我的 XML 文件中设置了所有参数。

# cappuccino - 学习卡布奇诺

> ID：1001517
> 
> 赞同：22
> 
> 时间：2009-06-16T13:35:07.657
> 
> 标签：cappuccino

学习卡布奇诺的最佳来源是什么？我从事“传统”网络开发，但我对这个新框架非常感兴趣。请注意，我不了解 Objective-C。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-06-18T00:54:42.503

如上所述，网站是一个好地方，但也有一些其他的好资源：

*   [http://cappuccinocasts.com/](http://cappuccinocasts.com/)（截屏视频）
*   [http://www.nice-panorama.com/Programmation/cappuccino/](http://www.nice-panorama.com/Programmation/cappuccino/)
*   [http://www.littletreesoftware.com/blog/](http://www.littletreesoftware.com/blog/)
*   [http://theocacao.com/document.page/593](http://theocacao.com/document.page/593)

还有一些其他的，其中许多是从网站链接到的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-12-18T08:18:02.093

I wrote a real life cappuccino tutorial based on an actual customer project: [http://www.springenwerk.com/2009/09/real-life-cappuccino-tutorial-part-1.html](http://www.springenwerk.com/2009/09/real-life-cappuccino-tutorial-part-1.html)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T15:22:29.687

在教程上说：

Objective-J 的精彩介绍。建议熟悉 JavaScript，不需要 Objective-C 的先验知识。

[http://cappuccino.org/learn/tutorials/](http://cappuccino.org/learn/tutorials/)

该网站似乎是一个学习的好地方。有趣的框架。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-31T21:37:00.190

你也有[http://www.cappuccino-project.org/learn/](http://www.cappuccino-project.org/learn/)

这是我们正在开发的新网站。根本不完整，它仍然有一些非常基本的教程可以帮助您开始使用 Cappuccino 编码

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-06-19T16:40:42.117

我最近开始学习卡布奇诺。我在 cappuccino.org 上找到了 Cappuccino Casts 和教程，但是，和你一样，我来自 Web 开发背景——不是可可/桌面应用程序。

遵循一些在线教程在一定程度上是好的，但我觉得我缺乏关于 Objective-C 和 Cocoa 的基础知识，而 Cappuccino 的模型与它非常接近。我在这里买了一本 Aaron Hillegass 的书，名为“Cocoa(R) Programming for Mac(R) OS X”：http: [//www.amazon.com/Cocoa-Programming-Mac-OS-3rd/dp/0321503619/ ref=pd_sim_b_3](https://rads.stackoverflow.com/amzn/click/com/0321503619)我觉得这确实有助于我对应用程序开发的基本理解，而不是传统的 Web 开发。

我肯定会推荐给它一读，我在几天内完成了它，并认为它提供了足够的知识来理解卡布奇诺的所有内容。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-07T10:19:33.373

我最近发现，当我从源代码安装 Cappuccino 时，有相当多的代码需要学习隐藏在`<install-dir>/Cappucino/Tests/Manual`

那里有大量没有在任何地方宣传的代码，但肯定足以从中学习。只需将`Frameworks`下一个`index.html`放在每个测试文件夹中的文件旁边，然后打开并学习！

# .net - 是否可以仅重新分发 .NET Framework 3.5 32 位？

> ID：1001518
> 
> 赞同：1
> 
> 时间：2009-06-16T13:35:10.217
> 
> 标签：.net, .net-3.5, 32-bit

.NET Framework 3.5 SP1 的离线安装程序大小为 200 MB。我们想知道是否有可能（在技术上和法律上）将其按目标体系结构拆分 - 以便为 32 位版本生成单独的安装程序。这个想法是它可能要小得多。

我知道引导程序，它只会下载必要的位。只是想知道其他可能性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T13:37:02.770

以下是您的选项的快速摘要，由 Scott Hanselman 构建：

[http://www.hanselman.com/smallestdotnet/](http://www.hanselman.com/smallestdotnet/)

所以答案是，是的，您可以在 200MB 以下获得完整安装。但是，最好的办法是给用户在线安装程序，这样它就可以为他们选择最好的框架版本。这将最大限度地减少下载。

# c# - 从字符串中修剪前导 n 个字母字符

> ID：1001521
> 
> 赞同：4
> 
> 时间：2009-06-16T13:35:46.410
> 
> 标签：c#, regex

我需要修剪字符串中的前 n 个字母字符。

例子：

a123456 -> 123456
abc123456 -> 123456
abc123456def -> 123456def

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-16T13:38:05.513

尝试这样的事情：

```
String output = Regex.Replace(input, @"^[^\d]+", String.Empty); 
```

以下是正则表达式的工作原理：

> **`^[^\d]+`**
> 
> **`^`**将表达式锚定到字符串的开头
> **`[^\d]`**是匹配所有非整数值的字符集通过使其匹配一次或多次来
> **`+`**限定**`[^\d]`**

所以基本上这个正则表达式匹配字符串中的所有非整数字符，直到找到一个整数字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T13:43:19.513

```
static string AlphaTrimRight(string value)
{
    while (!Char.IsNumber(value[0]))
        value = value.Substring(1, value.Length - 1);
    return value;
} 
```

# c# - C# 中的指针以及它在应用程序中的使用频率如何？

> ID：1001522
> 
> 赞同：4
> 
> 时间：2009-06-16T13:36:03.617
> 
> 标签：c#, c++, pointers

对我来说，指针是 C++ 编程语言中最难的概念之一。当我学习 C++ 时，我花费了大量的时间来学习它。但是，现在我主要从事完全用 C# 和 VB.NET 等语言编写的项目。事实上，我已经有将近 4 年没有接触过 C++ 了。尽管 C# 有指针，但我还没有遇到必须在 C# 中使用指针的情况。所以我的问题是，我们可以通过使用指针在 C# 中获得什么样的生产力？什么情况下必须使用指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T13:42:40.483

您已经在 C# 中使用了很多指针，只是它们看起来不像指针。每次你对一个类的实例做某事时，这就是一个指针。您已经获得了几乎所有潜在的好处，没有任何麻烦。

可以在 C# 中更明确地使用指针，这是大多数人所说的 C# 指针，但我认为这种情况非常罕见。它们对于链接到 C 库等可能很有用，但除此之外，我认为它们没有多大用处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T14:02:57.570

就个人而言，我从来不需要在 .NET 中使用指针，但是如果您正在处理对性能至关重要的代码，那么您将使用指针。如果您查看 System.String 类，您会发现很多处理字符串操作的方法都使用指针。此外，在处理图像处理时，使用指针通常很有用。现在，人们可以肯定地争论这些应用程序是否应该首先用 .NET 编写（我认为他们应该），但至少如果你需要挤出那一点额外的速度，你可以。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T13:41:39.253

我只在极少数情况下使用 C# 中的指针，这些情况主要与发送/接收数据有关，您必须将字节数组转换为结构，反之亦然。即使那样，您通常也不必直接处理指针。

在某些情况下，您可以使用指针来提高性能，因为使用 Marshaller，有时您必须复制内存才能访问数据，而使用指针，您可以直接访问它（想想`Bitmap.Lock()`）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T13:41:12.467

就个人而言，我从来不需要在 C# 中使用指针。如果我需要这种功能，我会在 C++/CLI 中编写该代码，然后从 C# 中调用它。如果我需要将指针从 C# 传递到 C++/CLI 或反之亦然，我将它们作为**IntPtr**传递并将其转换为我在 C++/CLI 中需要的类型。

在我看来 - 如果你在 C# 中使用指针，在 99% 的情况下，你使用的语言是错误的。

**编辑：** 关于 C++/CLI 的好处是您可以将单个类标记为仅本机编译。我做了很多需要快速完成的图像处理工作；它使用了大量基于指针的代码。我通常有一个托管 C++/CLI 对象将调用转发到我的处理发生的本地 C++ 对象。我打开了对本机代码和中提琴的优化，我获得了不错的性能提升。

当然，只有当您通过执行本机优化代码获得的性能提升可以抵消托管到非托管转换的开销时，这才有意义。就我而言，它总是如此。

# asp.net - 如何在 GridView 的 FooterTemplate 单元格中对齐文本

> ID：1001525
> 
> 赞同：4
> 
> 时间：2009-06-16T13:36:33.833
> 
> 标签：asp.net, html, gridview, cell, text-alignment

如何在 GridView 的 FooterTemplate 单元格中对齐文本

我尝试了以下但文本仍然居中（有一个父中心标签）：

```
<FooterTemplate>
    <span style="size:100%; padding:0; text-align: right">Total:&nbsp;</span>
</FooterTemplate> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-16T13:55:45.183

在模板的父列中尝试设置`FooterStyle-HorizontalAlign="Right"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T13:49:19.110

也许

```
<FooterTemplate>
    <div style="text-align: right;">
        <span>Total: </span>
    </div>
</FooterTemplate> 
```

随心所欲地工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T14:00:09.683

使用 display:block 替换 size:100% （不存在，AFAIK）

```
<FooterTemplate>
  <span style="display:block; padding:0; text-align: right">Total: </span>
</FooterTemplate> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-05T08:19:43.950

Grid-view 最终将呈现为表格本身，因此，使用基本的 CSS 选择器，我们可以解决问题，我使用以下方法解决了我面临的相同问题，希望它可以帮助其他寻找这个线程的人

```
 tr:last-of-type td {
        align-content: center;
        vertical-align: middle;
        text-align: center;
    } 
```

希望有帮助。

# c# - Membership.GetUser(username) - 如何返回正确的大小写？

> ID：1001527
> 
> 赞同：4
> 
> 时间：2009-06-16T13:37:04.393
> 
> 标签：c#, asp.net-membership

我从 URL so blah.com/kevinuk 获取用户名。

我希望页面上的一些内容说 KevinUK 是存储在会员表中的内容，但是当我执行以下操作时，它返回的大小写与输入的内容相同。

```
MembershipUser member = Membership.GetUser(user);
string userName = member.UserName; 
```

如何使用小写用户名作为参数并以正确的大小写从数据库返回值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T13:51:56.063

不幸的是，该`Membership.GetUser(string username)`方法只是将`MembershipUser`的用户名设置为传递参数的值。要获得正确的大小写，您需要使用`Membership.GetUser(object providerUserKey)`接受用户 GUID 的 ，或者覆盖前一个方法及其各自的存储过程以返回正确大小写的用户名。

或者，您可以简单地对两种不同的方法进行背靠背调用`GetUser()`，但这非常浪费。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:14:52.057

目前尚不清楚您使用的是哪个 Membership 提供程序，但您可以轻松地从中继承并覆盖 GetUser 方法。

创建一个类，该类继承自 MembershipProvider 类。

```
public class MyMembershipProvider : MembershipProvider

{

    public MyMembershipProvider()

    {

        //

        // TODO: Add constructor logic here

        //

    }

} 
```

覆盖 getUser 方法。

```
public override MembershipUser GetUser(string username, bool userIsOnline)

{
 ... Logic here to do a case insensitive lookup...

} 
```

最后更新网络配置以使用您的新提供者：

```
<system.web>
    <membership defaultProvider="MyMembershipProvider" userIsOnlineTimeWindow="10">
        <providers>
            <add name="MyMembershipProvider" type="Providers.FIFAMembershipProvider"     connectionStringName="ADConnectionString" ... />
        </providers>
    </membership>
</system.web> 
```

一些例子：

[http://www.eggheadcafe.com/tutorials/aspnet/30c3a27d-89ff-4f87-9762-37431805ef81/aspnet-custom-membership.aspx](http://www.eggheadcafe.com/tutorials/aspnet/30c3a27d-89ff-4f87-9762-37431805ef81/aspnet-custom-membership.aspx)

[http://msdn.microsoft.com/en-us/library/ms366730(VS.80).aspx](http://msdn.microsoft.com/en-us/library/ms366730(VS.80).aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-14T13:43:20.643

偶然发现同样的问题并尝试了上述解决方案=获得正确套管的最简单方法：

```
var user = Membership.GetUser(userName.Text);
user = Membership.GetUser(user.ProviderUserKey);
var correctCasing = user.UserName; 
```

# sql - sql连接问题

> ID：1001528
> 
> 赞同：1
> 
> 时间：2009-06-16T13:37:27.793
> 
> 标签：sql

我有以下表格

```
nid    timestamp   title

82  1245157883  Home
61  1245100302  Minutes
132    1245097268  Sample Form
95  1245096985  Goals & Objectives
99  1245096952  Members 
```

和

```
 pid     src         dst                                     language

        70  node/82         department/34-section-2      
        45  node/61/feed    department/22-section-2/feed     
        26  node/15         department/department1/15-department1    
        303 node/101        department/101-section-4 
```

这些是表的片段，并且缺少其余数据（它们都很大），但我试图将第二个表中的 dst 列连接到第一个表中。他们应该匹配他们的“nid”，但是第二个表有 node/[nid] 这使得这更加复杂。我也想忽略以“feed”结尾的那些，因为我正在做的事情不需要它们。

非常感谢

编辑：我为不提这个而感到难过，但第一个表是来自的 sql 结果

```
select nid, MAX(timestamp) as timestamp, title from node_revisions group by nid ORDER BY timestamp DESC LIMIT 0,5 
```

第二个表的名称为“url_alias”

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T13:40:37.897

尝试

```
select * from table1 inner join table2 on src=concat('node/',nid) 
```

**编辑**
编辑以反映 OP 的变化

```
select `nid`, MAX(`timestamp`) as `timestamp`, `title` from `node_revisions` inner join `url_alias` on `src`=concat('node/',`nid`) group by `nid` ORDER BY `timestamp` DESC LIMIT 0,5 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T13:41:01.437

不知道你用的是什么数据库。但是，我建议您编写一个解析函数，从该列返回 nid。然后，您可以进行这种查询（假设 GET_NID 是您定义的函数）：

```
SELECT * from T1, T2
WHERE T1.nid = GET_NID( T2.node) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T13:43:54.550

你有几个选择。

1.  编写一个将 src 转换为 nid 并加入 t1.nid = f(t2.src) 的函数——你没有说你使用什么 DBMS，但大多数都有办法做到这一点。它会很慢，但这取决于桌子有多大。

2.  与此类似，使用该函数创建一个具有计算域的视图——速度相同，但可能更容易理解。

3.  在 t2 中创建一个新的 nid 字段并使用该函数来填充它。制作插入和更新触发器以使其保持最新状态，然后加入。如果您经常查询，这会更好。

4.  转换 t2 使其具有一个 nid 字段并根据该字段和另一个字段计算 src，该字段是需要插入 nid 的模板。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T13:44:12.617

```
选择 *
FROM (SELECT *, 'node/' + nid AS src FROM table1) t1
INNER JOIN table2 t2
开启 t1.src = t2.src

```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T13:45:49.523

我会将第二个表中的节点 ID 拉到单独的列中。否则，任何连接这两个表的尝试都将导致对 src 字段进行一些处理的表扫描（我假设您的意思是 src 字段而不是 dst 字段）并且性能会出现问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T13:49:00.483

根据您想要的场景（例如，如果您将定期执行此 JOIN 并且您的第二个表相当大），您可能需要查看物化视图。

编写一个函数来执行所有逻辑以将 nid 提取到单独的列中。除了最初的 m-view 创建之外，与每次查询时针对每一行运行函数相比，该函数只需要在基表更改（插入、更新、删除）时运行。

这允许一个相当简单的连接到物化视图，并具有表的标准优势，例如索引。

注意：看起来我在写作时被打败了:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T13:54:30.770

您尚未使用 DBMS 指定。大多数引擎支持使用正则表达式进行匹配的 SQL-99 标准 SIMILAR TO 子句。一些引擎也实现了这一点，但使用了一些其他关键字而不是 SIMILAR TO。

火鸟SQL：
[http://wiki.firebirdsql.org/wiki/index.php?page=SIMILAR+TO](http://wiki.firebirdsql.org/wiki/index.php?page=SIMILAR+TO)

PostgreSQL：
[http://www.network-theory.co.uk/docs/postgresql/vol1/SIMILARTORRegularExpressions.html](http://www.network-theory.co.uk/docs/postgresql/vol1/SIMILARTORegularExpressions.html)

MySQL：
[http://dev.mysql.com/doc/refman/5.0/en/regexp.html](http://dev.mysql.com/doc/refman/5.0/en/regexp.html)

# c++ - 将 C++ 代码与“gcc”链接（没有 g++）

> ID：1001535
> 
> 赞同：29
> 
> 时间：2009-06-16T13:38:35.390
> 
> 标签：c++, gcc, linker

大家好：快速提问：我遇到的情况是，只使用“gcc”（不使用 g++）生成我的 C++ 可执行文件会很有用。原因是我必须将代码提交到无法识别“g++”（或“c++”）命令的自动提交服务器。

在我的实验中，当我**编译**gcc 时效果很好。问题是，当我尝试链接生成的目标文件时，它会搞砸。现在，根据我从 gcc 手册页中的理解（我可能离题了，如果我是的话，请告诉我），g++ 基本上是 gcc，但它链接了 C++ 库。

如果这是真的，我如何（如果可能）在**不**使用 g++（或 c++）命令的情况下显式链接 C++ 库？

**编辑：**我正在添加生成文件以更好地说明问题：

```
COMPILER = gcc
CFLAGS = -Wall -g -x c++

# MODULE COMPILATION
model: modules/model.h modules/sources/model.cpp
    $(COMPILER) $(CFLAGS) -c modules/sources/model.cpp -o obj/model.o

algorithms: modules/algorithms.h modules/sources/algorithms.cpp
    $(COMPILER) $(CFLAGS) -c modules/sources/algorithms.cpp -o obj/algorithms.o

io: modules/io.h modules/sources/io.cpp
    $(COMPILER) $(CFLAGS) -c modules/sources/io.cpp -o obj/io.o

stopwatch: modules/stopwatch.h modules/sources/stopwatch.cpp
    $(COMPILER) $(CFLAGS) -c modules/sources/stopwatch.cpp -o obj/stopwatch.o

# EXECUTABLE GENERATION
exe: model algorithms io stopwatch
    $(COMPILER) $(CFLAGS) main.cpp obj/model.o obj/algorithms.o obj/io.o obj/stopwatch.o -o bin/process

# DEFAULT TEST CASE
run: exe
    ./bin/process -i data/nasa_small.log -a data/nasa_small.access -s data/nasa_small.stack

# CLEANING ROUTINE
clean:
    rm -f obj/* 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-06-16T13:43:03.850

`-l`您可以将带有标志的标准 c++ 库链接到 gcc：

```
gcc cplusplus.o -lstdc++ -o myexe 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2009-06-16T13:47:43.390

如果您使用“-v”选项运行 g++，它将显示它使用的命令和选项。您应该能够从那里推断出正确的 gcc 命令行。

# .net - 来自 Nikon Coolpix 5600 的图像的 LocalReport 渲染失败

> ID：1001537
> 
> 赞同：0
> 
> 时间：2009-06-16T13:38:52.563
> 
> 标签：.net, image, rdlc

我有一个 RDLC，其中嵌入了使用 Nikon Coolpix 5600 拍摄的图像，当我调用 Render 函数时会引发以下错误。

示例图片： http: ~~[//img140.imageshack.us/img140/4906/dscn1559u.jpg](http://img140.imageshack.us/img140/4906/dscn1559u.jpg)~~（死链接）

有人知道那张图片有什么问题吗？

错误：

```
 [ArgumentOutOfRangeException: Nicht negative Zahl erforderlich.
Parametername: value]
   System.IO.MemoryStream.set_Position(Int64 value) +7679482
   Microsoft.ReportingServices.Rendering.ImageRenderer.CanvasPDF.MonochromeJpeg(MemoryStream memStream) +601
   Microsoft.ReportingServices.Rendering.ImageRenderer.CanvasPDF.ProcessImage(CanvasImagePDF image, Double left, Double top, Double width, Double height, Boolean scaleImage) +1656
   Microsoft.ReportingServices.Rendering.ImageRenderer.CanvasPDF.DrawImage(OutlineObjects outlines, CanvasImage image, Double left, Double top, Double width, Double height) +235
   Microsoft.ReportingServices.Rendering.ImageRenderer.Image.RenderToPage(Measurement parentClipBorder) +1275
   Microsoft.ReportingServices.Rendering.ImageRenderer.RenderingItemContainer.RenderToPage(Measurement parentClipBorder) +485
   Microsoft.ReportingServices.Rendering.ImageRenderer.Rectangle.RenderToPage(Measurement parentClipBorder) +373
   Microsoft.ReportingServices.Rendering.ImageRenderer.RenderingItemContainer.RenderToPage(Measurement parentClipBorder) +246
   Microsoft.ReportingServices.Rendering.ImageRenderer.ImageRendererBase.ProcessPages(CompositionBase theComposition, Report theReport, Boolean needTotalPages, Int32 startPage, Int32 endPage, Boolean render) +912
   Microsoft.ReportingServices.Rendering.ImageRenderer.PdfReport.RenderReport(Report report, NameValueCollection deviceInfo, EvaluateHeaderFooterExpressions evaluateHeaderFooterExpressions, CreateAndRegisterStream createAndRegisterStreamCallback, Int32 streamPageNumber) +652
   Microsoft.ReportingServices.Rendering.ImageRenderer.ImageRendererBase.Render(Report report, NameValueCollection reportServerParameters, NameValueCollection deviceInfo, NameValueCollection clientCapabilities, EvaluateHeaderFooterExpressions evaluateHeaderFooterExpressions, CreateAndRegisterStream createAndRegisterStream) +81

[ReportRenderingException: Fehler beim Rendern des Berichts.]
   Microsoft.ReportingServices.Rendering.ImageRenderer.ImageRendererBase.Render(Report report, NameValueCollection reportServerParameters, NameValueCollection deviceInfo, NameValueCollection clientCapabilities, EvaluateHeaderFooterExpressions evaluateHeaderFooterExpressions, CreateAndRegisterStream createAndRegisterStream) +142
   Microsoft.ReportingServices.ReportProcessing.ReportProcessing.RenderReport(IRenderingExtension renderer, DateTime executionTimeStamp, GetReportChunk getCompiledDefinitionCallback, ProcessingContext pc, RenderingContext rc, CreateReportChunk cacheDataCallback, Boolean& dataCached) +1775

[WrapperReportRenderingException: Fehler beim Rendern des Berichts.]
   Microsoft.ReportingServices.ReportProcessing.ReportProcessing.RenderReport(IRenderingExtension renderer, DateTime executionTimeStamp, GetReportChunk getCompiledDefinitionCallback, ProcessingContext pc, RenderingContext rc, CreateReportChunk cacheDataCallback, Boolean& dataCached) +2417
   Microsoft.ReportingServices.ReportProcessing.ReportProcessing.RenderReport(IRenderingExtension renderer, DateTime executionTimeStamp, GetReportChunk getCompiledDefinitionCallback, ProcessingContext pc, RenderingContext rc) +72
   Microsoft.Reporting.LocalService.RenderWithDataCache(PreviewItemContext itemContext, ParameterInfoCollection reportParameters, IEnumerable dataSources, DatasourceCredentialsCollection credentials, IRenderingExtension renderer, ReportProcessing repProc, CreateAndRegisterStream createStreamCallback, ReportRuntimeSetup runtimeSetup) +2069
   Microsoft.Reporting.LocalService.Render(PreviewItemContext itemContext, Boolean allowInternalRenderers, ParameterInfoCollection reportParameters, IEnumerable dataSources, DatasourceCredentialsCollection credentials, CreateAndRegisterStream createStreamCallback, ReportRuntimeSetup runtimeSetup, ProcessingMessageList& warnings) +441
   Microsoft.Reporting.WebForms.LocalReport.InternalRender(String format, Boolean allowInternalRenderers, String deviceInfo, CreateAndRegisterStream createStreamCallback, Warning[]& warnings) +364

[LocalProcessingException: Fehler bei der lokalen Berichtsverarbeitung.]
   Microsoft.Reporting.WebForms.LocalReport.InternalRender(String format, Boolean allowInternalRenderers, String deviceInfo, CreateAndRegisterStream createStreamCallback, Warning[]& warnings) +418
   Microsoft.Reporting.WebForms.LocalReport.InternalRender(String format, Boolean allowInternalRenderers, String deviceInfo, String& mimeType, String& encoding, String& fileNameExtension, String[]& streams, Warning[]& warnings) +199
   Microsoft.Reporting.WebForms.LocalReport.Render(String format, String deviceInfo, String& mimeType, String& encoding, String& fileNameExtension, String[]& streams, Warning[]& warnings) +57
   HrmSuite.MvcWebClient.EmployeePresentation.Render(Guid guid, String& mimeType, String reportMapPath, Boolean anonym) in C:\VS2008\HrmSuite\HrmSuite.MvcWebClient\Reports\EmployeePresentation.vb:226
   HrmSuite.MvcWebClient.EmployeeController.RenderReport(Guid guid, Boolean anonym) in C:\VS2008\HrmSuite\HrmSuite.MvcWebClient\Controllers\EmployeeController.vb:152
   lambda_method(ExecutionScope , ControllerBase , Object[] ) +230
   System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +17
   System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters) +178
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +24
   System.Web.Mvc.<>c__DisplayClassa.<InvokeActionMethodWithFilters>b__7() +52
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +254
   System.Web.Mvc.<>c__DisplayClassc.<InvokeActionMethodWithFilters>b__9() +19
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation) +254
   System.Web.Mvc.<>c__DisplayClassc.<InvokeActionMethodWithFilters>b__9() +19
   System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodWithFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor, IDictionary`2 parameters) +192
   System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) +399
   System.Web.Mvc.Controller.ExecuteCore() +126
   System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +27
   System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +7
   System.Web.Mvc.MvcHandler.ProcessRequest(HttpContextBase httpContext) +151
   System.Web.Mvc.MvcHandler.ProcessRequest(HttpContext httpContext) +57
   System.Web.Mvc.MvcHandler.System.Web.IHttpHandler.ProcessRequest(HttpContext httpContext) +7
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +181
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75 
```

* * *

**编辑**

EXIF 数据似乎是原因，仍在调查:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T13:55:14.140

图像需要采用 Base64 编码才能在 SSRS 中呈现。

这是一个将进行编码的 VB.NET 函数。您可能可以优化，我只是粘贴了我的一个旧功能。

```
Public Function ConvertImageToBase64String(ByVal img As Image) As String
    Dim output As String = ""
    Dim outputArray() As Byte
    Dim stream As New MemoryStream
    img.Save(stream, Drawing.Imaging.ImageFormat.Png)
    outputArray = stream.ToArray()
    stream.Close()
    output = Convert.ToBase64String(outputArray)
    Return output
  End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T08:51:55.627

我通过使用 System.Drawing.Bitmap 重新编码整个图像解决了这个问题，这不是一个完美的解决方案，但它现在可以工作。

# python - 如何在 Python 中连接文件？

> ID：1001538
> 
> 赞同：38
> 
> 时间：2009-06-16T13:38:56.497
> 
> 标签：python, file, mp3

我有多个（40 到 50 个）MP3 文件，我想将它们连接成一个文件。在 Python 中执行此操作的最佳方法是什么？

使用[`fileinput`](http://docs.python.org/library/fileinput.html)模块循环遍历每个文件的每一行并将其写入输出文件？外包给windows[`copy`](http://www.computerhope.com/copyhlp.htm)命令？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-06-16T13:44:51.273

将这些文件中的字节放在一起很容易......但是我不确定这是否会导致连续播放 - 我认为如果文件使用相同的比特率可能会，但我不确定。

```
from glob import iglob
import shutil
import os

PATH = r'C:\music'

destination = open('everything.mp3', 'wb')
for filename in iglob(os.path.join(PATH, '*.mp3')):
    shutil.copyfileobj(open(filename, 'rb'), destination)
destination.close() 
```

这将创建一个“everything.mp3”文件，其中将 C:\music 中所有 mp3 文件的所有字节连接在一起。

如果要在命令行中传递文件的名称，可以使用`sys.argv[1:]`代替`iglob(...)`等。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2009-10-05T07:40:10.677

总结一下（并从[nosklo 的答案](https://stackoverflow.com/questions/1001538/how-do-i-concatenate-files-in-python/1001587#1001587)中窃取），以便连接您所做的两个文件：

```
destination = open(outfile,'wb')
shutil.copyfileobj(open(file1,'rb'), destination)
shutil.copyfileobj(open(file2,'rb'), destination)
destination.close() 
```

这与以下内容相同：

```
cat file1 file2 > destination 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-06-16T13:49:11.077

唔。我不会使用“线条”。快速而肮脏的使用

```
outfile.write( file1.read() )
outfile.write( file2.read() ) 
```

;)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-31T16:20:45.307

改进了 Clint 和 nosklo，了解了上下文管理器，我发现这样写更简洁：

```
import shutil
import pathlib

source_files = pathlib.Path("My_Music").rglob("./*.mp3")
with open("concatenated_music.mp3", mode="wb") as destination:
    for file in source_files:
        with open(file, mode="rb") as source:
            shutil.copyfileobj(source, destination) 
```

# java - 如何用 Java 编写 UTF-8 文件？

> ID：1001540
> 
> 赞同：193
> 
> 时间：2009-06-16T13:39:05.857
> 
> 标签：java, file-io, utf-8

我有一些当前代码，问题是它创建了一个 1252 代码页文件，我想强制它创建一个 UTF-8 文件

任何人都可以帮我处理这段代码，正如我所说的那样，它目前可以工作......但我需要强制保存 utf .. 我可以传递一个参数或其他什么吗？

这就是我所拥有的，任何帮助都非常感谢

```
var out = new java.io.FileWriter( new java.io.File( path )),
        text = new java.lang.String( src || "" );
    out.write( text, 0, text.length() );
    out.flush();
    out.close(); 
```

* * *

## 回答 #1

> 赞同：218
> 
> 时间：2009-06-16T13:41:50.297

而不是使用`FileWriter`，创建一个`FileOutputStream`. 然后，您可以将其包装在一个`OutputStreamWriter`中，这样您就可以在构造函数中传递编码。然后，您可以将数据写入[try-with-resources 语句中](https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html)：

```
try (OutputStreamWriter writer =
             new OutputStreamWriter(new FileOutputStream(PROPERTIES_FILE), StandardCharsets.UTF_8))
    // do stuff
} 
```

* * *

## 回答 #2

> 赞同：205
> 
> 时间：2009-06-16T13:42:22.153

试试这个

```
Writer out = new BufferedWriter(new OutputStreamWriter(
    new FileOutputStream("outfilename"), "UTF-8"));
try {
    out.write(aString);
} finally {
    out.close();
} 
```

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2009-06-16T14:50:10.610

尝试[`FileUtils.write`](http://commons.apache.org/io/apidocs/org/apache/commons/io/FileUtils.html#write)从 Apache Commons 使用。

您应该能够执行以下操作：

```
File f = new File("output.txt"); 
FileUtils.writeStringToFile(f, document.outerHtml(), "UTF-8"); 
```

如果文件不存在，这将创建该文件。

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2014-12-16T12:46:45.010

从 Java 7 开始，您可以`Files.newBufferedWriter`更简洁地执行相同的操作：

```
Path logFile = Paths.get("/tmp/example.txt");
try (BufferedWriter writer = Files.newBufferedWriter(logFile, StandardCharsets.UTF_8)) {
    writer.write("Hello World!");
    // ...
} 
```

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2010-10-29T16:23:04.333

这里给出的所有答案都不起作用，因为 java 的 UTF-8 写作有问题。

[http://tripoverit.blogspot.com/2007/04/javas-utf-8-and-unicode-writing-is.html](http://tripoverit.blogspot.com/2007/04/javas-utf-8-and-unicode-writing-is.html)

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2009-06-16T13:47:00.753

```
var out = new java.io.PrintWriter(new java.io.File(path), "UTF-8");
text = new java.lang.String( src || "" );
out.print(text);
out.flush();
out.close(); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2014-08-13T09:37:11.220

[Java 7 Files 实用程序类型](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html)对于处理文件很有用：

```
import java.nio.charset.StandardCharsets;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.io.IOException;
import java.util.*;

public class WriteReadUtf8 {
  public static void main(String[] args) throws IOException {
    List<String> lines = Arrays.asList("These", "are", "lines");

    Path textFile = Paths.get("foo.txt");
    Files.write(textFile, lines, StandardCharsets.UTF_8);

    List<String> read = Files.readAllLines(textFile, StandardCharsets.UTF_8);

    System.out.println(lines.equals(read));
  }
} 
```

[Java 8 版本](http://docs.oracle.com/javase/8/docs/api/java/nio/file/Files.html)允许您省略*Charset*参数 -这些方法默认为 UTF-8。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-09-11T20:56:57.510

我们可以用 java 编写 UTF-8 编码的文件，使用 PrintWriter 编写 UTF-8 编码的 xml

或点击[这里](http://dharmeshpatel.ca/?p=46 "如何用 Java 编写 UTF-8 文件？")

```
PrintWriter out1 = new PrintWriter(new File("C:\\abc.xml"), "UTF-8"); 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-03-23T21:58:00.040

下面的示例代码可以逐行读取文件并以 UTF-8 格式写入新文件。另外，我明确指定了 Cp1252 编码。

```
 public static void main(String args[]) throws IOException {

    BufferedReader br = new BufferedReader(new InputStreamReader(
            new FileInputStream("c:\\filenonUTF.txt"),
            "Cp1252"));
    String line;

    Writer out = new BufferedWriter(
            new OutputStreamWriter(new FileOutputStream(
                    "c:\\fileUTF.txt"), "UTF-8"));

    try {

        while ((line = br.readLine()) != null) {

            out.write(line);
            out.write("\n");

        }

    } finally {

        br.close();
        out.close();

    }
} 
```

# sql - IN 与 JOIN 大行集

> ID：1001543
> 
> 赞同：32
> 
> 时间：2009-06-16T13:39:20.037
> 
> 标签：sql, sql-server-2005, performance, join

我想在主键位于另一个表中的表中选择行。我不确定我是否应该在 SQL Server 2005 中使用 JOIN 或 IN 运算符。这两个带有大型数据集（即数百万行）的 SQL 查询之间是否存在显着的性能差异？

```
SELECT *
FROM a
WHERE a.c IN (SELECT d FROM b)

SELECT a.*
FROM a JOIN b ON a.c = b.d 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-16T13:45:41.677

**更新：**

我博客中的这篇文章总结了我的答案和我对另一个答案的评论，并显示了实际的执行计划：

*   [**IN vs. JOIN vs. EXISTS**](http://explainextended.com/2009/06/16/in-vs-join-vs-exists/)

* * *

```
SELECT  *
FROM    a
WHERE   a.c IN (SELECT d FROM b)

SELECT  a.*
FROM    a
JOIN    b
ON      a.c = b.d 
```

这些查询是不等价的。如果您的表`b`没有保留键（即 的值`b.d`不唯一），它们可能会产生不同的结果。

第一个查询的等价物如下：

```
SELECT  a.*
FROM    a
JOIN    (
        SELECT  DISTINCT d
        FROM    b
        ) bo
ON      a.c = bo.d 
```

如果`b.d`is`UNIQUE`并且标记为这样（使用`UNIQUE INDEX`or `UNIQUE CONSTRAINT`），那么这些查询是相同的，并且很可能会使用相同的计划，因为`SQL Server`它足够聪明，可以考虑到这一点。

`SQL Server`可以使用以下方法之一来运行此查询：

*   如果`a.c`, `d`is`UNIQUE`和上的索引`b`与 相比相对较小`a`，则将条件传播到子查询中并使用纯文本`INNER JOIN`（带`b`前导）

*   如果有一个索引 on`b.d`并且`d`is not `UNIQUE`，那么该条件也会被传播并被`LEFT SEMI JOIN`使用。也可用于上述情况。

*   如果两者都有索引`b.d`并且`a.c`它们很大，则`MERGE SEMI JOIN`使用

*   如果任何表上都没有索引，则构建`b`并`HASH SEMI JOIN`使用哈希表。

**这些方法都不会**每次都重新评估整个子查询。

有关其工作原理的更多详细信息，请参阅我的博客中的此条目：

*   [**计算缺失的行数：SQL Server**](http://explainextended.com/2009/04/20/counting-missing-rows-sql-server/)

`RDBMS`四大巨头都有链接。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T13:43:16.627

两者都不。使用 ANSI-92 连接：

```
SELECT a.*
FROM a JOIN b a.c = b.d 
```

但是，最好作为 EXISTS

```
SELECT a.*
FROM a
WHERE EXISTS (SELECT * FROM b WHERE a.c = b.d) 
```

这将删除可能由 JOIN 生成的重复项，但运行速度即使不是更快也一样快

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T13:41:29.207

对 a 中的每一行评估 IN（并重新运行从 b 中选择），而优化 JOIN 以使用索引和其他巧妙的分页技巧......

但是，在大多数情况下，优化器很可能能够从相关子查询中构造一个 JOIN，并最终得到相同的执行计划。

编辑：请阅读下面的评论以进一步...讨论这个答案的有效性，以及对 OP 问题的实际答案。=)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-06-18T14:48:37.990

根据对 49,000,000 行表的经验，我建议使用 LEFT OUTER JOIN。使用 IN 或 EXISTS 需要 5 分钟才能完成 LEFT OUTER JOIN 在 1 秒内完成。

```
SELECT a.*
FROM a LEFT OUTER JOIN b ON a.c = b.d
WHERE b.d is not null -- Given b.d is a primary Key with index 
```

实际上，在我的查询中，我在 9 个表中执行此操作。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-06-16T13:42:41.387

除了为自己使用大量测试数据进行实际测试之外，我会说使用 JOINS。与 IN 子查询相比，在大多数情况下使用它们的性能总是更好，并且您有更多的自定义选项，例如如何加入、选择什么、不选择什么等。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-06-16T13:42:52.370

它们是具有不同结果的不同查询。使用 IN 查询，只要谓词匹配，您将从表 'a' 中获得 1 行。使用 INNER JOIN 查询，只要连接条件匹配，您就会得到 a*b 行。因此，对于 {1,2,3} 的 a 和 {1,2,2,3} 的 b 中的值，您将从 JOIN 中获得 1,2,2,3，从 IN 中获得 1,2,3。

编辑-我认为您可能会在这里遇到一些答案，这会给您带来误解。自己去测试一下，你会发现这些都是很好的查询计划：

```
create table t1 (t1id int primary key clustered)
create table t2 (t2id int identity primary key clustered
    ,t1id int references t1(t1id)
)

insert t1 values (1)
insert t1 values (2)
insert t1 values (3)
insert t1 values (4)
insert t1 values (5)

insert t2 values (1)
insert t2 values (2)
insert t2 values (2)
insert t2 values (3)
insert t2 values (4)

select * from t1 where t1id in (select t1id from t2)
select * from t1 where exists (select 1 from t2 where t2.t1id = t1.t1id)
select t1.* from t1 join t2 on t1.t1id = t2.t1id 
```

前两个计划是相同的。最后一个计划是一个嵌套循环，这种差异是意料之中的，因为正如我上面提到的，连接具有不同的语义。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-16T14:08:04.190

来自关于子查询基础的[MSDN 文档：](http://msdn.microsoft.com/en-us/library/ms189575(SQL.90).aspx)

> 许多包含子查询的 Transact-SQL 语句可以替代地表述为连接。其他问题只能通过子查询提出。在 Transact-SQL 中，包含子查询的语句与不包含子查询的语义等效版本之间通常没有性能差异。但是，在某些必须检查存在性的情况下，连接会产生更好的性能。否则，必须为外部查询的每个结果处理嵌套查询，以确保消除重复。在这种情况下，连接方法会产生更好的结果。

在您提供的示例中，嵌套查询只需为每个外部查询结果处理一次，因此应该没有性能差异。检查两个查询的执行计划应该可以确认这一点。

注意：虽然问题本身没有指定 SQL Server 2005，但我根据问题标签回答了这个假设。其他数据库引擎（甚至不同的 SQL Server 版本）可能不会以相同的方式进行优化。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-06-16T13:55:32.610

观察这两种类型的执行计划并得出结论。除非“IN”语句中的子查询返回的记录数非常少，否则 IN 变体几乎肯定会更慢。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-16T13:41:00.173

我会使用一个连接，打赌它会比 IN 快很多。当然，这假定定义了主键，从而使索引大大加快了速度。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-16T15:10:06.750

通常认为连接比 IN 子查询更有效；但是 SQL*Server 优化器通常不会导致明显的性能差异。即便如此，最好使用连接条件进行编码以保持标准一致。此外，如果您的数据和代码将来需要迁移，数据库引擎可能不会那么宽容（例如，使用连接而不是 IN 子查询会在 MySql 中产生巨大的差异）。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-16T18:38:31.207

理论只会让你在这样的问题上走得更远。归根结底，您需要测试这两个查询并查看哪个实际运行得更快。我遇到过 JOIN 版本超过一分钟而 IN 版本不到一秒的情况。我也遇到过 JOIN 实际上更快的情况。

就个人而言，如果我知道我不需要子查询表中的任何字段，我倾向于从 IN 版本开始。如果它开始运行缓慢，我会优化。幸运的是，对于大型数据集，重写查询会产生如此显着的差异，您只需从查询分析器中对其进行计时，就可以知道您正在取得进展。

祝你好运！

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-07-04T18:18:41.460

我一直是 IN 方法论的支持者。此链接包含在 PostgresSQL 中进行的测试的详细信息。 [http://archives.postgresql.org/pgsql-performance/2005-02/msg00327.php](http://archives.postgresql.org/pgsql-performance/2005-02/msg00327.php)

# c++ - 游戏消息传递系统的选项

> ID：1001544
> 
> 赞同：0
> 
> 时间：2009-06-16T13:39:52.500
> 
> 标签：c++, asynchronous, networking, shared-memory, message-passing

我正在开发针对手持硬件（Pandora）的 C++ RTS 游戏。作为参考，Pandora 有一个约 600Mhz 的 ARM 处理器并运行 Linux。我们正在尝试建立一个好的消息传递系统（内部和外部），这对我来说是一个新领域。

举一个我们想传递的信息的例子可能会有所帮助。一个单元可以进行这个调用来将它的模型加载到内存中：

`sendMessage("model-loader", "load-model", my_model.path, model_id );`

作为回报，该单元可以期待某种包含特定 model_id 的模型对象的消息，然后可以将其传递给图形系统。请注意，这个 sendMessage 函数绝不是最终的。它只是反映了我目前对消息传递系统的理解，这可能是不正确的:)

据我所知，有两种截然不同的选择。一种是在内存中传递消息，只有在需要与外部机器对话时才通过网络。我喜欢这个想法，因为开销似乎很低，但这里的大问题是您似乎需要在消息队列上广泛使用互斥锁。如果可能的话，我真的很想避免过度锁定。我已经阅读了一些实现简单队列而不加锁的方法（依靠原子`int`操作），但这些方法假设一个队列只有一个读取器和一个写入器。这对我们的特定情况似乎没有用，因为一个对象的队列将有许多写入者和一个读取者。

另一种选择是完全越过网络层。这有一些有趣的优势，比如几乎免费的异步消息传递。此外，我们获得了使用与本地传递完全相同的调用将消息传递给其他机器的能力。但是，这个解决方案让我很不爽，可能是因为我不完全理解它:) 我们是否需要为每个将要发送/接收消息的对象提供一个套接字？如果是这样，这似乎是多余的。一个给定的游戏将有数千个对象。对于像 Pandora 这样动力不足的设备，我担心像这样滥用网络可能最终成为我们的瓶颈。但是，我还没有进行任何测试，所以这只是猜测。

MPI 似乎在消息传递方面很受欢迎，但对于我们想要的东西来说，它确实感觉有点矫枉过正。此代码永远不会触及集群或需要进行大量计算。

非常感谢您对我们有哪些选择来实现这一点的任何见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T13:55:40.550

网络也将使用锁定。它只是在操作系统内核中你看不到的地方。

我要做的是创建您自己的消息队列对象，您可以根据需要对其进行重写。从简单开始，并根据需要使其变得更好。这样，您就可以让它在幕后使用您喜欢的任何实现，而无需更改其余代码。

查看您将来可能想做的几种可能的实现并设计您的 API，以便在您决定以这些术语实现时可以有效地处理它们。

如果您想要真正高效的消息传递，请查看一些开源 L4 微内核。那些家伙花了*很多*时间来快速传递消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:23:58.650

由于这是一个小型平台，因此可能值得对这两种方法进行计时。

但是，除非出现某种大的速度问题，否则我总是会采用更易于编码的方法。这可能会使用网络堆栈，因为无论接收者在哪里，它都是相同的代码，并且您不必手动编码和调试您的互斥、消息缓冲、分配等。

如果您发现它太慢，您可以稍后使用内存重新编码本地内容。但是，如果您可能不必这样做，为什么要浪费时间预先做这件事呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:07:31.120

我同意 Zan 的建议，尽可能在内存中传递消息。

一个原因是您可以传递复杂的对象 C++ 而无需编组和解组（序列化和反序列化）它们。

使用信号量保护消息队列的成本很可能低于进行网络代码调用的成本。

如果您使用一些无锁算法（使用您自己提到的原子操作）保护您的消息队列，您可以避免很多上下文切换进出内核。

# c# - C#如何访问列表视图中的下拉框？

> ID：1001548
> 
> 赞同：2
> 
> 时间：2009-06-16T13:40:12.360
> 
> 标签：c#, asp.net, listview, dropdownbox

我有一个列表视图。在我的列表视图中，我有一个下拉框，我想填写我的代码隐藏页面。唯一的问题是，我不知道如何访问这个 web 控件。以下不起作用：

```
DropDownList ddl = (DropDownList)lvUserOverview.Controls[0]; 
```

我知道索引是 0，因为下拉列表是列表视图上的唯一控件（当我尝试索引 1 时，我得到一个索引超出范围异常）。

有人可以告诉我如何访问下拉列表吗？在我的 pagebehind 中，我想添加列表项。

ASPX 代码：

```
<asp:DropDownList ID="ddlRole" onload="ddlRole_Load" runat="server">
</asp:DropDownList> 
```

代码隐藏：

```
protected void ddlRole_Load(object sender, EventArgs e)
{
  DropDownList ddl = (DropDownList)lvUserOverview.FindControl("ddlRole");
  if (ddl != null)
  {
      foreach (Role role in roles)
          ddl.Items.Add(new ListItem(role.Description, role.Id.ToString()));
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T13:49:37.457

如果这是在 ListView 中呈现的，那么有可能会实例化多个 DropDownList，每个都将获得一个唯一的 ID，您将无法使用 Matthew 的方法。

您可能希望使用 ItemDataBound 事件来访问 e.Item.FindControl("NameOfDropDownList") ，这将允许您迭代创建的每个下拉列表。

如果您只创建一个...为什么它在 ListView 中？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T16:27:22.617

要在其自身的 Load 事件处理程序中获取下拉列表的句柄，您只需将 sender 转换为 DropDownList。

```
DropDownList ddlRole = sender as DropDownList; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T13:42:17.300

试试这个：

```
DropDownList ddl = (DropDownList)lvUserOverview.FindControl("NameOfDropDownList"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T13:50:30.093

如果您的控件是数据绑定的，请确保在数据绑定后尝试访问它们的后代。我也可以帮助在该行之前检查调试器中的对象。

# iphone - 如何在 Web 应用程序中访问 iPhone 通讯录？

> ID：1001550
> 
> 赞同：6
> 
> 时间：2009-06-16T13:40:31.547
> 
> 标签：iphone, web-applications, contacts

我目前正在为我的公司开发一个网络应用程序。在这个应用程序中，有一个带有输入字段的表单，其中包含有关联系人的信息。我想创建一个按钮，允许单击时在地址簿中创建联系人。

无论如何可以使用 JavaScript 或其他网络语言访问地址簿吗？

例如，在 windows 和 IE 上，我们可以在 JavaScript 中创建一个 ActiveX 对象来在 Outlook 中创建联系人...

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T13:46:55.497

如果事实证明这是可能的，我正在吃我的[Mighty Mouse](http://store.apple.com/us/product/MB111LL/A/Wireless-Mighty-Mouse?fnode=MTY1NDA1Mg&mco=MjE0Njk1MA) ..

*我为稍微不相关的答案道歉*

PS：使这个答案更加相关；您可以通过在本机应用程序和 Web 应用程序之间创建一个混合体来实现这一点，其中本机应用程序将弹出地址簿，然后将其数据返回到 Web 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T14:00:49.230

如果您创建一个生成[vCard 格式](http://en.wikipedia.org/wiki/VCard)文件的链接， iPhone 版本的 Safari 可能会将其识别为联系人，并在他们单击该链接时自动启动地址簿应用程序。

看来这在 iPhone 2.1 中不起作用（在 safari 中不支持 vCard），但它可能在 3.0 中起作用 - 我已经看到人们可以在 iPhone 上通过 MMS 发送 vCard，所以也许他们会在野生动物园也？我想你只需要尝试一下就可以知道了。

# css - 在 SWF 上覆盖透明 PNG 会禁用 SWF 中的所有单击事件

> ID：1001551
> 
> 赞同：0
> 
> 时间：2009-06-16T13:40:35.883
> 
> 标签：css, flash, png

我正在尝试通过 CSS（绝对定位）将透明 PNG 放置在 SWF 电影上。但是当我将 PNG 直接放在 SWF 上时，SWF 上的所有单击操作似乎都被禁用了。SWF 要求使用您的网络摄像头，但您无法单击任何按钮。检查[此链接](http://www.goal043.nl/mysterycard/test/)以获取示例。[你可以在这里](http://www.goal043.nl/mysterycard/test/css/css-base.css)找到 CSS和[png](http://www.goal043.nl/mysterycard/test/img/cam-corners.png)在这里。

就像 PNG 充当您无法单击的覆盖平面一样。我已经在 CSS 和 SWF 中尝试了一些透明属性，但似乎没有任何效果。对这种特殊情况有任何想法/建议/经验吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T14:11:07.057

您的怀疑是正确的：PNG 位于您的 Flash 片段顶部的图层中，您无法单击它。

由于您只是将该 PNG 用于圆角，为什么不尝试以下操作：

1.  创建 4 个 div，每个角一个
2.  在您的样式表中，为它们提供绝对定位，将您的 PNG 作为背景图像，背景重复设置为“无重复”，并且明确的高度和宽度与圆角的确切大小相同。
3.  在每个角落的基础上，使用 background-position 将 PNG 背景滑动到位。
4.  设置每个角的顶部和左侧属性以将它们卡入到位。（由于 div#corners 本身具有绝对位置，因此它们会坐在正确的位置。）

基本上，把你的角落变成[CSS sprites](http://www.alistapart.com/articles/sprites)。

**编辑：**您可能仍然会遇到 div#corners 具有明确的高度和宽度并充当图层的问题。在这种情况下，您可能希望完全废弃它并绝对定位 div#corners 的父元素的角。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-03-04T04:50:50.517

如果您在 css 中将指针事件设置为 none，它会起作用吗？

[单击 DIV 到底层元素](https://stackoverflow.com/questions/3680429/click-through-a-div-to-underlying-elements)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T13:48:59.550

AFAIR 如果它在另一个对象下，你不能给 swf 动作，上面的对象会得到所有的点击，你应该编辑原始 swf 或考虑页面上的不同图形

# xml - Xml 注释本地化

> ID：1001559
> 
> 赞同：1
> 
> 时间：2009-06-16T13:41:31.640
> 
> 标签：xml, api, localization, comments

我将使用 XML 注释来记录应用程序的可扩展性 API，但我没有找到使用多种语言或任何方式本地化这些文件的任何参考。我想使用沙堡或任何其他工具（ABD...？），但我不知道将翻译后的 XML 注释放在哪里，我不知道是否应该使用相同的 XML 模式等... .

你有这方面的经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T13:45:20.990

创建一个 XML 文件（您使用的是模式吗？），其中包含作为元素的注释，并带有标识每个元素的 xml:lang 属性。

然后，您可以使用 XSLT 或 XQuery 按需创建特定语言的版本，或者至少使读者能够这样做。

如果您使用 . 则更难做到这一点，但如果您使用上述方法，您的 XSLT 或 XQuery 实际上可以*生成*另一个文件，其中包含目标语言的注释。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:39:03.753

这听起来像是您使用 Visual Studio 2010 编写编辑器扩展的好案例。新的编辑器使这实际上变得实用，并且他们发布了很多这样做的示例。

但是，正如其他答案所述，首先您需要弄清楚您需要完成什么。您可能需要将更改的注释提取到文件中，然后通知某人开始您对更改的本地化过程。您可能不打算进行自动本地化，但您可以自动化该过程，将更改的评论收集在一起，将它们发送到本地化，然后在翻译后的文档返回后将其合并到您的文档中。

# unit-testing - Mbunit和硒

> ID：1001563
> 
> 赞同：3
> 
> 时间：2009-06-16T13:41:50.360
> 
> 标签：unit-testing, selenium, mbunit

谁能告诉我如何让 mbunit 一次运行多个测试而不在每次测试后设置和拆除？

目前我正在使用 selenium 进行 UI 测试，并且需要连续运行测试做一个登录页面。

在此先感谢，CB

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T13:50:18.830

您是否正在寻找**FixtureSetUp/FixtureTearDown**属性 [以前称为 TestFixtureSetUp]，它在类级别调用，这意味着它将为一个测试类中的所有测试设置一次。

**在方法级别调用**Setup/TearDown属性。****

 **MbUnit 还支持测试程序集设置和拆卸。这是一个[链接](http://www.testingreflections.com/node/view/639)。

```
[assembly: AssemblyCleanUp(typeof(AssemblyCleaner))]
...
public class AssemblyCleaner
{
    [SetUp]
    public static void SetUp()
    {
        Console.WriteLine("Setting up {0}", typeof(AssemblyCleanUp).Assembly.FullName);
    }
    [TearDown]
    public static void TearDown()
    {
        Console.WriteLine("Cleaning up {0}", typeof(AssemblyCleanUp).Assembly.FullName);
    }
} 
```**

# python - 用于合并排序文件的 Python 类，如何改进？

> ID：1001569
> 
> 赞同：8
> 
> 时间：2009-06-16T13:42:24.773
> 
> 标签：python, merge, mergesort, large-file-support

**背景：**

我正在清理大型（不能保存在内存中）制表符分隔的文件。当我清理输入文件时，我在内存中建立了一个列表；当它达到 1,000,000 个条目（大约 1GB 内存）时，我对其进行排序（使用下面的默认键）并将列表写入文件。此类用于将已排序的文件重新组合在一起。它适用于我迄今为止遇到的文件。到目前为止，我最大的案例是合并 66 个排序文件。

**问题：**

1.  我的逻辑是否存在漏洞（它在哪里脆弱）？
2.  我是否正确实现了合并排序算法？
3.  有什么明显的改进可以做的吗？

**示例数据：**

这是其中一个文件中的一行的抽象：

`'hash_of_SomeStringId\tSome String Id\t\t\twww.somelink.com\t\tOtherData\t\n'`

外卖是我`'SomeStringId'.lower().replace(' ', '')`用作我的排序键。

**原始代码：**

```
class SortedFileMerger():
    """ A one-time use object that merges any number of smaller sorted 
        files into one large sorted file.

        ARGS:
            paths - list of paths to sorted files
            output_path - string path to desired output file
            dedup - (boolean) remove lines with duplicate keys, default = True
            key - use to override sort key, default = "line.split('\t')[1].lower().replace(' ', '')"
                  will be prepended by "lambda line: ".  This should be the same 
                  key that was used to sort the files being merged!
    """
    def __init__(self, paths, output_path, dedup=True, key="line.split('\t')[1].lower().replace(' ', '')"):
        self.key = eval("lambda line: %s" % key)
        self.dedup = dedup
        self.handles = [open(path, 'r') for path in paths]
        # holds one line from each file
        self.lines = [file_handle.readline() for file_handle in self.handles]
        self.output_file = open(output_path, 'w')
        self.lines_written = 0
        self._mergeSortedFiles() #call the main method

    def __del__(self):
        """ Clean-up file handles.
        """
        for handle in self.handles:
            if not handle.closed:
                handle.close()
        if self.output_file and (not self.output_file.closed):
            self.output_file.close()

    def _mergeSortedFiles(self):
        """ Merge the small sorted files to 'self.output_file'. This can 
            and should only be called once.
            Called from __init__().
        """
        previous_comparable = ''
        min_line = self._getNextMin()
        while min_line:
            index = self.lines.index(min_line)
            comparable = self.key(min_line)
            if not self.dedup:                      
                #not removing duplicates
                self._writeLine(index)
            elif comparable != previous_comparable: 
                #removing duplicates and this isn't one
                self._writeLine(index)
            else:                                   
                #removing duplicates and this is one
                self._readNextLine(index)
            previous_comparable = comparable
            min_line = self._getNextMin()
        #finished merging
        self.output_file.close()

    def _getNextMin(self):
        """ Returns the next "smallest" line in sorted order.
            Returns None when there are no more values to get.
        """
        while '' in self.lines:
            index = self.lines.index('')
            if self._isLastLine(index):
                # file.readline() is returning '' because 
                # it has reached the end of a file.
                self._closeFile(index)
            else:
                # an empty line got mixed in
                self._readNextLine(index)
        if len(self.lines) == 0:
            return None
        return min(self.lines, key=self.key)

    def _writeLine(self, index):
        """ Write line to output file and update self.lines
        """
        self.output_file.write(self.lines[index])
        self.lines_written += 1
        self._readNextLine(index)

    def _readNextLine(self, index):
        """ Read the next line from handles[index] into lines[index]
        """
        self.lines[index] = self.handles[index].readline()

    def _closeFile(self, index):
        """ If there are no more lines to get in a file, it 
            needs to be closed and removed from 'self.handles'.
            It's entry in 'self.lines' also need to be removed.
        """
        handle = self.handles.pop(index)
        if not handle.closed:
            handle.close()
        # remove entry from self.lines to preserve order
        _ = self.lines.pop(index)

    def _isLastLine(self, index):
        """ Check that handles[index] is at the eof.
        """
        handle = self.handles[index]            
        if handle.tell() == os.path.getsize(handle.name):
            return True
        return False 
```

**编辑：**实施[布赖恩](https://stackoverflow.com/users/9493/brian)的建议我想出了以下解决方案：

**第二次编辑：根据**[John Machin](https://stackoverflow.com/users/84270/john-machin)的建议更新了代码：

```
def decorated_file(f, key):
    """ Yields an easily sortable tuple. 
    """
    for line in f:
        yield (key(line), line)

def standard_keyfunc(line):
    """ The standard key function in my application.
    """
    return line.split('\t', 2)[1].replace(' ', '').lower()

def mergeSortedFiles(paths, output_path, dedup=True, keyfunc=standard_keyfunc):
    """ Does the same thing SortedFileMerger class does. 
    """
    files = map(open, paths) #open defaults to mode='r'
    output_file = open(output_path, 'w')
    lines_written = 0
    previous_comparable = ''
    for line in heapq26.merge(*[decorated_file(f, keyfunc) for f in files]):
        comparable = line[0]
        if previous_comparable != comparable:
            output_file.write(line[1])
            lines_written += 1
        previous_comparable = comparable
    return lines_written 
```

***粗略*测试**

使用相同的输入文件（2.2 GB 数据）：

*   SortedFileMerger 类耗时 51 分钟（3068.4 秒）
*   [Brian](https://stackoverflow.com/users/9493/brian)的解决方案耗时 40 分钟（2408.5 秒）
*   添加[John Machin](https://stackoverflow.com/users/84270/john-machin)的建议后，解决方案代码耗时 36 分钟（2214.0 秒）

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-16T13:50:56.457

请注意，在 python2.6 中，heapq 有一个新的[合并](http://docs.python.org/library/heapq.html#heapq.merge)函数，它将为您执行此操作。

要处理自定义键功能，您可以用装饰它的东西包装文件迭代器，以便它根据键进行比较，然后将其剥离：

```
def decorated_file(f, key):
    for line in f: 
        yield (key(line), line)

filenames = ['file1.txt','file2.txt','file3.txt']
files = map(open, filenames)
outfile = open('merged.txt')

for line in heapq.merge(*[decorated_file(f, keyfunc) for f in files]):
    outfile.write(line[1]) 
```

**[编辑]** 即使在早期版本的 python 中，从后面的 heapq 模块中获取合并的实现可能也是值得的。它是纯python，并且在python2.5中未经修改即可运行，并且由于它使用堆来获得下一个最小值，因此在合并大量文件时应该非常有效。

您应该能够简单地从 python2.6 安装中复制 heapq.py，将其作为“heapq26.py”复制到您的源并使用“ `from heapq26 import merge`”——其中没有使用 2.6 特定功能。或者，您可以只复制合并函数（重写 heappop 等调用以引用 python2.5 heapq 模块）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-17T00:33:01.747

<<这个“答案”是对原始提问者结果代码的评论>>

建议：使用 eval() 是 ummmm 并且您正在做的事情限制调用者使用 lambda - 密钥提取可能需要不止一个单行，并且在任何情况下您不需要相同的函数来进行初步排序步骤吗？

所以替换这个：

```
def mergeSortedFiles(paths, output_path, dedup=True, key="line.split('\t')[1].lower().replace(' ', '')"):
    keyfunc = eval("lambda line: %s" % key) 
```

有了这个：

```
def my_keyfunc(line):
    return line.split('\t', 2)[1].replace(' ', '').lower()
    # minor tweaks may speed it up a little

def mergeSortedFiles(paths, output_path, keyfunc, dedup=True): 
```

# c# - 如何将颜色数组设置为另一个颜色数组？

> ID：1001577
> 
> 赞同：0
> 
> 时间：2009-06-16T13:43:11.683
> 
> 标签：c#, .net, asp.net, arrays

我下面的代码给了我错误：“索引超出了数组的范围。” 我的算法创建了数组维度“16”的 Colorset 数组，但我需要第二个“colorSetLegend”，即维度：32，如果您在下面查看返回错误的粗体代码。

```
 Color[] colorSetLegend = new Color[32];
            Color[] colorSet = { Color.Red, Color.Blue, Color.Green, Color.Yellow };
            Color end = Color.White;
            colorSet = ColorMaker.GenerateColor(colorSet, end);

            for (int i = 0; i < colorSet.Length; )
            {
                for (int j = 0; j < colorSetLegend.Length; )
                {
                  **  colorSetLegend[j] = colorSet[i];**
                    colorSetLegend[j++] = Color.Black;
                    i++;
                }
            }
```

我的颜色生成器如下：

```
 public class ColorMaker
{
    public static Color[] GenerateColor(Color[] baseColorSet, Color end)
    {
        Color[] colorSet = new Color[16];
        int j = 0;
        foreach (Color start in baseColorSet)
        {
            for (int i = 0; i < 15; i += 4)
            {
                int r = Interpolate(start.R, end.R, 15, i),
                    g = Interpolate(start.G, end.G, 15, i),
                    b = Interpolate(start.B, end.B, 15, i);

                colorSet[j] = Color.FromArgb(r, g, b);
                j++;
            }
        }

        return colorSet;

    }
    static int Interpolate(int start, int end, int steps, int count)
    {
        float s = start, e = end, final = s + (((e - s) / steps) * count);
        return (int)final;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T13:45:33.970

你在你的*内部*循环中增加 i 。我怀疑您打算*在外*循环中执行此操作-否则在外循环的*一次*迭代中，您将递增`i`多次，直到超出数组的范围。

或者，您可以`for`像其他人一样编写循环：

```
for (int i = 0; i < colorSet.Length; i++)
{
    for (int j = 0; j < colorSetLegend.Length; j++)
    {
        colorSetLegend[j] = colorSet[i];
        colorSetLegend[j] = Color.Black;
    }
} 
```

`colorSetLegend[j]`话虽如此，考虑到循环内的第一行设置和第二行再次设置相同的元素，代码有点毫无意义。此外，在外循环的下一次迭代中，您将`colorSetLegend`再次覆盖所有值。你想达到什么目的？

马克在这里对你的目标做了一个很好的猜测（尽管他现在删除了他的答案！）

这是他对您想要的工作代码的猜测：

```
for (int i = 0; i < colorSet.Length; i++)
{
    colorSetLegend[i*2] = colorSet[i];
    colorSetLegend[(i*2)+1] = Color.Black;
} 
```

如果他是对的，可以从中学到一些东西：

*   考虑一下循环的嵌套级别。你真的是想在这里有两个循环吗？
*   尝试使用传统习语进行循环 - 每当我在循环开始的末尾看到一个空位时`for`，我都会感到紧张
*   在另一个表达式中使用前置和后置自增运算符很容易出错。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T13:54:15.840

这将实现您正在寻找的东西：

```
int j = 0;
for (int i = 0; i < colorSet.Length; i++)
{
    colorSetLegend[j++] = colorSet[i];
    colorSetLegend[j++] = Color.Black;
} 
```

# nhibernate - Nhibernate - 初始化列表 - 最佳实践？

> ID：1001584
> 
> 赞同：6
> 
> 时间：2009-06-16T13:44:21.197
> 
> 标签：nhibernate, list

我只是想知道一些 CodeWarning（ConstructorsShouldNotCallBaseClassVirtualMethods），以及是否有更好的方法来做到这一点。我有一个简单的日志收集器类，我正在使用 NHibernate 来检索一些对象。

有时我自己（当然）创建对象并将它们添加到 NHibernate 以保持持久性。确保**列表永远不会为 NULL 的最佳方法是什么。**

目前我正在这样做，但它似乎并不“完美”。对这个话题有任何想法吗？

```
public class LogRun
{
    public virtual int Id { get; private set; }
    public virtual DateTime StartTime { get; set; }
    public virtual DateTime EndTime { get; set; }
    public virtual IList<Log> LogMessages { get; set; }
    public virtual int LogMessageCount { get { return LogMessages.Count; } }

    public LogRun()
    {
        LogMessages = new List<Log>();
    }

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T14:48:54.640

LogMessages 是持久化的东西吗？如果是这样，最好的做法是永远不要公开公共二传手。如果您从数据库中检索 NHibernate，然后用新的 IList 替换该 IList，NHibernate 会变得很奇怪：

```
var myLog = session.Get<LogRun>(1);
Assert.True(myLog.LogMessages.Count > 0);
myLog.LogMessages = new List<Log>(); 
```

如果您注意到，NHibernate 正在返回一个代理对象并用通用列表替换它会导致它在您尝试保存时变得不稳定。

通常，我更喜欢初始化一个私有字段，然后只向客户端公开一个 getter：

```
public class LogRun
{
    private IList<Log> logMessages = new List<Log>();

    public virtual int Id { get; private set; } 
    public virtual DateTime StartTime { get; set; } 
    public virtual DateTime EndTime { get; set; }
    public virtual IList<Log> LogMessages { get { return logMessages; } } 
    public virtual int LogMessageCount { get { return LogMessages.Count; } }

    public void AddLogMessage(Log log)
    {
        logMessages.Add(log);
    }
} 
```

实际上，我更进一步，客户端得到一个 IEnumerable<> 并且我为 add 添加了一个辅助函数。

我的实现看起来像

```
public class LogRun
{
    private IList<Log> logMessages = new List<Log>();

    public virtual int Id { get; private set; } 
    public virtual DateTime StartTime { get; set; } 
    public virtual DateTime EndTime { get; set; }
    public virtual IEnumerable<Log> LogMessages { get { return logMessages; } } 
    public virtual int LogMessageCount { get { return LogMessages.Count(); } }

    public void AddLogMessage(Log log)
    {
        logMessages.Add(log);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T13:56:29.470

我做同样的事情，但我也想知道性能影响有多大，因为 NHibernate 还将为每个默认构造函数调用创建一个新的 List<> ..

我认为我们很幸运，而且它会奏效。考虑 NHibernate 创建一个延迟加载的 LogRun 列表（这就是我们将所有内容标记为虚拟的原因）：

1.  NHibernate 将反映 LogRun 并创建一个派生类
2.  NHibernate 将创建一个 LogRun 派生类的代理列表
3.  --
4.  当您加载该代理时，它将实例化其中一些派生类，但是，首先调用基构造函数 - 创建新列表 <> - 然后调用派生构造函数，而是创建一个代理列表。

实际上，我们创建了一个我们永远不会使用的列表。

考虑替代方案：

*   使构造函数受保护，这样没有人会调用它，并做出替代。例如，静态 LogRun.GetNew(); 方法。
*   允许对 IList<> 进行公共集访问，并在您创建新对象时自行创建它。

老实说，我认为两者都非常混乱，并且由于我（非常）确定在每个构造函数调用上创建一个新的空列表的性能开销是有限的，这就是我个人迄今为止所坚持的。至少在我的分析器告诉我之前：P

# ruby-on-rails - RoR：哈希数组上的 to_json

> ID：1001594
> 
> 赞同：2
> 
> 时间：2009-06-16T13:45:50.680
> 
> 标签：ruby-on-rails, ruby

我在 Rails 操作中有一个哈希数组，我以 json 格式返回给客户端：

```
{"msg": "Got report data.Check 'report' json object. ", "success": true, "reports": "[{\"total_transfers\": 0, \"total_keywords\": 0, \"keyword\": \"plum\", \"total_duration\":1464.0, \"total_calls\": 22, \"total_sms\": 0, \"avg_duration\": 67,\"total_email\": 0}]"} 
```

在行动中我做：返回reports.to_json，但你可以看到它看起来不像有效的json（为什么是转义字符？）

在客户端js代码中，我做reports.length并得到163？？？什么时候应该说 1 因为报告数组中只有一个“报告”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T13:50:37.300

如您所见，“报告”是一个大字符串，而不是您期望的散列数组（163 是字符串的长度，这就是您可以看到转义字符的原因）。您使用哪个 json 库与 rails 一起使用？你的哈希数组到底是什么类型的对象？它可能没有实现 to_json 方法......

或者，您可以先尝试将您的响应转换为 yaml，因为获取 json 更容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T14:51:49.673

```
reports_array_object = eval("(" + reports + ")"); 
```

甜的！！！！

# ruby-on-rails - 从 Rails 的任何地方访问“会话密钥”cookie 名称

> ID：1001597
> 
> 赞同：16
> 
> 时间：2009-06-16T13:46:44.797
> 
> 标签：ruby-on-rails, session, cookies

我们正在为 Rails 构建一个插件，以便在 iframe Facebook 应用程序中使用，并且有一次我们需要检查 Rail 的会话 id cookie 是否已设置。

默认情况下，这个 cookie 被命名为*_myprojectname_session*，我们需要找出 cookie 本身的实际名称。因此，如果未设置，我们可以进行一些重定向以确保设置了 cookie。

我们如何从任何地方访问该死的 cookie 名称？或者至少来自控制器内部？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-02-10T08:55:06.050

```
Rails.application.config.session_options[:key] 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-06-17T16:33:07.343

我找到了解决方案。在 Rails 2.3.2 中，至少会话密钥设置`config/initializers/session_store.rb`如下：

```
ActionController::Base.session = {
  :key         => '_myapp_session',
  :secret      => '[...]'
} 
```

您可以像这样读取值：

```
ActionController::Base.session_options[:key] 
```

从自动`Base.session`到`Base.session_options`自动，没有多大意义，这让我很头疼......哈哈

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T18:13:29.610

要从视图或控制器中访问会话 cookie 的名称，您可以说：

```
request.session_options[:session_key] 
```

然后要访问该 cookie 的原始值，如果未设置，则为空数组，请使用：

```
request.cookies[ request.session_options[:session_key] ] 
```

cookie 名称（又名 session_key）在您的`config/environment.rb`文件中设置。

```
 config.action_controller.session = {     
    :session_key => '_project_session',
    :secret      => 'long-secret-key'
  } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2011-03-19T02:07:15.157

根据我的经验，如果键中有下划线，IE 有时不会设置 cookie。换句话说，使用“projectsession”而不是“_project_session”。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T13:55:11.237

我认为会话密钥存储在一个名为 ENV_SESSION_KEY 的变量中

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-10-09T15:36:05.373

另请注意此错误会影响某些 Rails 2.x 版本中 session_options 的测试：[https ://rails.lighthouseapp.com/projects/8994/tickets/2303-testrequest-doesnt-initialize-session_options](https://rails.lighthouseapp.com/projects/8994/tickets/2303-testrequest-doesnt-initialize-session_options)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-14T15:07:42.437

在 Rails 3/4 我使用这个：

```
request.env["rack.request.cookie_hash"] 
```

这是一个散列，包含当前用户的所有 cookie，包括会话的一个。哈希以 cookie 的名称作为键，以 cookie 的值作为值

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2011-06-09T11:18:43.633

我不知道如何在 Rails 3 中做到这一点:-(

最终我把它放在了 config/initializers/session_store.rb

```
SESSION_KEY = '_myapp_session'
MyApp::Application.config.session_store :cookie_store, :key => SESSION_KEY 
```

然后在需要的地方访问它，例如在视图中......

```
<%= ::ENV_SESSION_KEY %> 
```

# ruby-on-rails - ASP.NETs Application_Start 的 Ruby 等价物？

> ID：1001600
> 
> 赞同：1
> 
> 时间：2009-06-16T13:47:03.280
> 
> 标签：ruby-on-rails

我想启动一个线程，每隔这么多秒就会唤醒一次，以便在 Ruby-on-Rails Web 应用程序中进行一些处理。在 .NET 中，合乎逻辑的地方是在 global.asax 文件中创建一个线程并以`Application_Start`.

在 RoR 中做这些事情是否有类似的范例？这会在`ApplicationController`?

顺便说一句：我输入了错误的搜索字符串还是搜索引擎真的不擅长查找构建 RoR 应用程序的信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T14:03:17.180

Rails 并没有真正的等价物。[When](http://github.com/javan/whenever/tree/master) RubyGem 是 Cron的一个很好的抽象，它允许您在 Rails 应用程序中使用如下示例的语法：

```
every 30.seconds do
  # Do something interesting...
end 
```

您可能会发现一些有用的资源：

*   [Ruby](http://railscasts.com/episodes/164-cron-in-ruby) Railscast 中的 Cron（涵盖了每当 gem）
*   [Rails 最好的后台作业管理库是什么？](https://stackoverflow.com/questions/977735/whats-the-best-background-job-management-library-for-rails)（堆栈溢出）
*   [在 Rails 应用程序中运行异步作业的最佳方式是什么？](https://stackoverflow.com/questions/124360/what-is-the-best-way-to-run-asynchronous-jobs-in-a-rails-application)（堆栈溢出）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T13:58:33.697

搜索引擎不仅不好，而且几乎是您找到 RoR 信息的唯一地方。:(

我认为您正在寻找的范例是一项 cron 工作，尽管这假定您在 Linux 下运行。我最常看到的本质上是一个“计划任务”，它每隔 X y 拉下一个页面，并且处理是在该请求中完成的。您甚至可以通过将计划任务指向远程框的 cron“命中点”来远程执行此操作。

您*可以*将代码放在 ApplicationController 中并让它检查作业是否在最后 X y 中完成，但问题是您可能会在超过预期时间间隔的时间内收到请求。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:06:35.270

这个问题没有一个简单的答案，因为它在很大程度上取决于您的具体要求。但是，当然，没有与您在 ASP.NET 中描述的概念直接等效的概念。但是，您需要了解[Rails 上的后台处理](http://blog.robmack.com/2009/05/04/background_processing/)作为一个很好的起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T14:13:43.133

几年前我尝试过[daemon_generator](http://douglasfshearer.com/blog/cron-jobs-in-ruby-on-rails)但由于某种原因现在忘记了我从未使用过它。

# python - 为什么我的 python 程序输出中有多余的空行？

> ID：1001601
> 
> 赞同：2
> 
> 时间：2009-06-16T13:47:10.583
> 
> 标签：python

我对python不是特别有经验，所以下面可能会做一些愚蠢的事情。我有以下程序：

```
import os
import re
import linecache

LINENUMBER = 2

angles_file = open("d:/UserData/Robin Wilson/AlteredData/ncaveo/16-June/scan1_high/000/angles.txt")

lines = angles_file.readlines()

for line in lines:
    splitted_line = line.split(";")
    DN = float(linecache.getline(splitted_line[0], LINENUMBER))
    Zenith = splitted_line[2]
    output_file = open("d:/UserData/Robin Wilson/AlteredData/ncaveo/16-June/scan1_high/000/DNandZenith.txt", "a")
    output_file.write("0\t" + str(DN) + "\t" + Zenith + "\n")
    #print >> output_file, str(DN) + "\t" + Zenith
    #print DN, Zenith

output_file.close() 
```

当我查看文件的输出时，我得到以下信息：

```
0   105.5     0.0

0   104.125  18.0

0   104.0    36.0

0   104.625  54.0

0   104.25   72.0

0   104.0    90.0

0   104.75  108.0

0   104.125 126.0

0   104.875 144.0

0   104.375 162.0

0   104.125 180.0 
```

哪个是正确的数字，每行之间只有空行。我试过并试图删除它们，但我似乎不能。我究竟做错了什么？

罗宾

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-16T13:58:32.400

对于 GENERAL 解决方案，请从 INPUT 中删除尾随换行符：

```
splitted_line = line.rstrip("\n").split(";") 
```

在这种情况下，从您的输出“工作”中删除无关的换行符，但这是一个 kludge。

另外：（1）在循环中间打开输出文件不是一个好主意；做一次，否则你只是在浪费资源。如果循环足够长，您将用完文件句柄并崩溃 (2) 像这样硬连线文件名不是一个好主意，尤其是隐藏在脚本中间；尝试使您的脚本可重用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-06-16T13:48:18.677

改变这个：

```
output_file.write("0\t" + str(DN) + "\t" + Zenith + "\n") 
```

对此：

```
output_file.write("0\t" + str(DN) + "\t" + Zenith) 
```

当您读入该字符串时，该`Zenith`字符串已包含原始文件的尾随`\n`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T13:57:05.290

替代解决方案（如果您正在处理文件中的行，则很方便）是去除空格：

```
Zenith = Zenith.strip(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T14:02:46.683

**编辑：**有关详细信息，请参阅评论，但肯定有更好的方法。`[:-1]`不是最好的选择，不管它看起来多么酷。改为使用`line.rstrip('\n')`。

问题在于，与 不同`file_text.split('\n')`，`file.readlines()`它不会`\n`从每行输入的末尾删除 。我解析文本行的默认模式如下：

```
with open(filename) as f:
    for line in f.readlines():
        parse_line(line[:-1]) # funny face trims the '\n' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T14:01:16.280

如果你想确保你的任何标记上没有空格（不仅仅是第一个和最后一个），试试这个：

```
splitted_line = map (str.strip, line.split (';')) 
```

# quicktime - MOV格式规范

> ID：1001614
> 
> 赞同：1
> 
> 时间：2009-06-16T13:49:11.857
> 
> 标签：quicktime, specifications, file-format

是否有在不使用 Quicktime SDK 的情况下读取 Quicktime MOV 文件的文档？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T14:16:33.767

Apple 发布了[QuickTime 文件格式规范](http://developer.apple.com/documentation/QuickTime/qtff/qtff.pdf)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T13:58:34.443

[Wotsit.org](http://www.wotsit.org/)有[4 个](http://www.wotsit.org/list.asp?search=mov&button=GO)关于 MOV 文件格式的文档。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T13:56:22.780

[如果你特别勤奋，并且想要重写 quicktime，你可以阅读 Apple 的规范](http://developer.apple.com/documentation/QuickTime/qtff/qtff.pdf)。

或者，您可以像[mPlayer一样在现有库（例如](http://en.wikipedia.org/wiki/MPlayer)[Libavcodec](http://en.wikipedia.org/wiki/Libavcodec) ）周围放置一个包装器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T13:50:25.193

查看 mplayer、ffmpeg、vlc 的源代码。

那里应该有某种文档。

# python - 数组除法 - 从 MATLAB 转换为 Python

> ID：1001634
> 
> 赞同：7
> 
> 时间：2009-06-16T13:54:13.767
> 
> 标签：python, matlab, numpy, linear-algebra

我在 MATLAB 中有这行代码，由其他人编写：

```
c=a.'/b 
```

我需要把它翻译成 Python。a、b 和 c 都是数组。我目前用于测试代码的维度是：

a: 18x1,
b: 25x18,

这给了我尺寸为 1x25 的 c。

数组不是正方形的，但如果它们是，我不希望代码失败。有人可以准确地解释这条线在做什么（数学上），以及如何在 Python 中做到这一点？（即，如果它存在于 Python 中，则它与 MATLAB 中的内置 mrdivide 函数等效？）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-06-16T14:07:57.420

符号`/`是MATLAB中的矩阵右除运算符，调用[`mrdivide`](https://www.mathworks.com/help/matlab/ref/mrdivide.html)函数。从文档中可以看出，矩阵右除与[矩阵左除](https://www.mathworks.com/help/matlab/ref/mldivide.html)的关系如下：

```
B/A = (A'\B')' 
```

If`A`是一个方阵，`B/A`大致等于`B*inv(A)`（尽管它以不同的、更稳健的方式计算）。否则，`x = B/A`是在最小二乘意义上对欠定或超定方程组的解`x*A = B`。有关用于求解方程组的算法的更多详细信息，请参见[此处](https://www.mathworks.com/help/matlab/ref/mldivide.html#bt4jslc-6)。通常在引擎盖下使用[LAPACK](http://en.wikipedia.org/wiki/LAPACK)或[BLAS](http://en.wikipedia.org/wiki/Basic_Linear_Algebra_Subprograms)等软件包。

Python的[NumPy 包](http://numpy.scipy.org/)包含一个[`lstsq`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.lstsq.html#numpy.linalg.lstsq)用于计算方程组的最小二乘解的例程。此例程可能会给您提供与`mrdivide`在 MATLAB 中使用该函数相当的结果，但不太可能是*精确的*。每个函数使用的底层算法的任何差异都可能导致答案彼此略有不同（即一个可能返回值 1.0，而另一个可能返回值 0.999）。此错误的相对大小最终*可能会*更大，这在很大程度上取决于您正在求解的特定方程组。

要使用`lstsq`，您可能需要稍微调整您的问题。您似乎想要求解**cB = a**形式的方程，其中**B**是 25×18，**a**是 1×18，**c**是 1×25。对两边应用[转置可以得到方程](http://en.wikipedia.org/wiki/Transpose)**B ^T c ^T = a ^T**，这是一种更标准的形式（即**Ax = b**）。的参数`lstsq`应该是（按此顺序）**B ^T**（一个 18×25 数组）和**一个^T**（一个 18 元素数组）。`lstsq`应该返回一个 25 元素的数组 ( **c ^T** )。

*注意：虽然 NumPy 对 1×N 或 N×1 数组没有任何区别，但 MATLAB 肯定会这样做，如果你不使用正确的数组，它会骂你。*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-06-17T18:41:38.080

线

```
c = a.' / b 
```

计算方程*cb = a ^T*对于*c*的解。Numpy 没有直接执行此操作的运算符。相反，您应该解决*b ^T c ^T = a* for *c ^T*并转置结果：

```
c = numpy.linalg.lstsq(b.T, a.T)[0].T 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-16T14:07:05.643

在 Matlab 中，`A.'`意味着转置 A 矩阵。所以从数学上讲，代码中实现的是A ^T / B。

* * *

**如何在 Python（或任何语言）中实现矩阵除法** *（注意：让我们看一下表格的简单除法`A/B`；对于您的示例，您需要先执行 A ^T，然后执行 A ^T /B，这很容易在 Python 中进行转置操作 |left-as-an-exercise :)|)*

你有一个矩阵方程 C*B=A （你想找到 C 作为 A/B）

右除（/）如下：

C `*`(B `*`B ^T )=A `*`B ^T

`*`然后通过反转 (B B ^T )来隔离 C

IE，

C = A `*`B ^T`*` (B `*`B ^T )' ----- [1]

因此，要在Python（或任何语言）中实现矩阵除法，得到以下三种方法。

*   矩阵乘法
*   矩阵转置
*   矩阵逆

然后迭代地应用它们以实现如 [1] 中的划分。

只是，您需要做A ^T / B，因此您在实现三个基本方法后的最终操作应该是：

A ^T`*` B ^T`*` (B `*`B ^T )'

*注意：不要忘记运算符优先级的基本规则 :)*

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T14:34:35.387

[已编辑] 正如 Suvesh 所指出的，我之前完全错了。但是，numpy 仍然可以轻松完成他在帖子中给出的程序：

```
A = numpy.matrix(numpy.random.random((18, 1))) # as noted by others, your dimensions are off
B = numpy.matrix(numpy.random.random((25, 18)))
C = A.T * B.T * (B * B.T).I 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-07T16:20:31.167

您也可以使用伪逆`B`然后将该结果与`A`. 尝试使用[`numpy.linalg.pinv`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.linalg.pinv.html)然后将其与矩阵乘法结合使用[`numpy.dot`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.dot.html)：

```
c = numpy.dot(a, numpy.linalg.pinv(b)) 
```

# php - 在数据库中计算相等值的最佳做法是什么？

> ID：1001638
> 
> 赞同：0
> 
> 时间：2009-06-16T13:54:49.070
> 
> 标签：php, mysql

我有一个相当大的 mysql 数据库，我想计算所有相等的值，以便更好地解释自己：

我有一个国家字段，它有几个国家值（美国、英国、墨西哥等），我想获得不重复的国家数量（如果我有 100 个美国和 2 个英国和 1000 个墨西哥，结果将是 3） .

我能想到的唯一方法是：

```
$i="0";
$query = "SELECT DISTINCT country FROM table"; 
$result = mysql_query($query) or die(mysql_error());
while($row = mysql_fetch_array($result)){
$i++;
}
echo $i; 
```

我真的认为有更好的方法来实现这一点，也许直接 trought 一条 sql 语句？

一如既往地感谢您的友好回复。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T14:01:57.650

你已经得到了大部分正确的选择语句，你只需要让 MySQL 为你计算：

```
SELECT COUNT(DISTINCT country)
FROM table 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:05:54.867

SELECT country, COUNT(country) FROM table GROUP BY country

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:05:51.247

```
SELECT country, COUNT(*) AS count
FROM table
GROUP BY country 
```

# c++ - 我可以编写没有标头的 C++ 代码（重复函数声明）吗？

> ID：1001639
> 
> 赞同：64
> 
> 时间：2009-06-16T13:55:00.317
> 
> 标签：c++, header, header-files

有没有办法不必编写两次函数声明（头文件），并且在用 C++ 编程时仍然保持相同的编译可伸缩性、调试的清晰度和设计的灵活性？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2009-06-16T14:18:45.370

使用[Lzz](http://www.lazycplusplus.com)。它需要一个文件并自动为您创建一个 .h 和 .cpp，所有声明/定义都在正确的位置。

Lzz 确实非常强大，可以处理 99% 的完整 C++ 语法，包括模板、特化等。

**更新 150120：**

较新的 C++ '11/14 语法只能在 Lzz 函数体中使用。

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2009-06-16T14:12:07.507

当我开始写 C 时，我也有同样的感觉，所以我也研究了这个。答案是肯定的，这是可能的，不，你不想这样做。

首先是肯定的。

在 GCC 中，您可以这样做：

```
// foo.cph

void foo();

#if __INCLUDE_LEVEL__ == 0
void foo() {
   printf("Hello World!\n");
}
#endif 
```

这具有预期的效果：您将标头和源合并到一个可以包含和链接的文件中。

然后没有：

这仅在编译器可以访问整个源代码时才有效。在编写要分发但保持封闭源代码的库时，您不能使用此技巧。要么分发完整的 .cph 文件，要么必须编写一个单独的 .h 文件以与 .lib 一起使用。尽管也许您可以使用宏预处理器自动生成它。不过它会变得毛茸茸的。

以及为什么你不想要这个的原因 #2，这可能是最好的一个：*编译速度*。通常，只有当文件本身发生更改或其中包含的任何文件发生更改时，才需要重新编译 C 源文件。

*   C 文件可以经常更改，但更改只涉及重新编译已更改的文件。
*   头文件定义接口，因此它们不应该经常更改。但是，当它们这样做时，它们会触发包含它们的*每个源文件的重新编译。*

当您的所有文件都是头文件和源文件的组合时，每次更改都会触发所有源文件的重新编译。即使到现在，C++ 也不以其快速的编译时间而闻名，想象一下当整个项目每次都必须重新编译时会发生什么。然后将其推断为一个包含数百个具有复杂依赖关系的源文件的项目......

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2009-06-16T14:07:38.233

抱歉，但在 C++ 中没有消除标头的“最佳实践”之类的东西：这是一个坏主意，句号。如果你那么讨厌他们，你有三个选择：

*   熟悉 C++ 内部结构和您正在使用的任何编译器；您将遇到与普通 C++ 开发人员不同的问题，并且您可能需要在没有太多帮助的情况下解决这些问题。
*   选择一种你可以“正确”使用而不会感到沮丧的语言
*   获取为您生成它们的工具；你仍然会有标题，但你节省了一些打字工作

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-06-16T14:10:35.700

Pedro Guerreiro在他的文章[Simple Support for Design by Contract in C++](http://www-ctp.di.fct.unl.pt/%7Epg/docs/TOOLS2001.pdf)中说：

> 通常，C++ 类有两个文件：头文件和定义文件。我们应该在哪里写断言：在头文件中，因为断言是规范？或者在定义文件中，因为它们是可执行的？或者两者都冒着不一致（和重复工作）的风险？相反，我们建议我们放弃传统样式，并取消定义文件，只使用头文件，就好像所有函数都是内联定义的，就像 Java 和 Eiffel 所做的那样。
> 
> 与 C++ 常态相比，这是一个如此巨大的变化，以至于它有可能在一开始就扼杀这项努力。另一方面，为每个类维护两个文件是如此尴尬，以至于迟早会出现一个 C++ 开发环境，它将对我们隐藏起来，使我们能够专注于我们的类，而不必担心它们的存储位置。

那是 2001 年。我同意了。现在是 2009 年，仍然没有出现“对我们隐藏，让我们专注于我们的课程的开发环境”。相反，长编译时间是常态。

* * *

**注意：**上面的链接现在似乎已经死了。这是对该出版物的完整参考，它出现在作者网站的“[出版物](http://me.pedroguerreiro.com/publications)”部分：

Pedro Guerreiro，*C++ 合同设计的简单支持*，TOOLS USA 2001，Proceedings，第 24-34 页，IEEE，2001。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-06-16T13:59:31.150

没有实用的方法来绕过标题。您唯一能做的就是将所有代码放入一个大的 c++ 文件中。这将导致无法维持的混乱，所以请不要这样做。

目前，C++ 头文件是一种邪恶。我不喜欢他们，但没有办法绕过他们。不过，我很乐意看到有关该问题的一些改进和新想法。

顺便说一句 - 一旦你习惯了它就不再**那么**糟糕了。C++（以及任何其他语言）有更多令人讨厌的东西。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-06-16T14:07:03.757

我见过像你这样的人所做的就是将[*所有内容都*](https://stackoverflow.com/questions/583255/c-code-in-header-files)[写在标题中](https://stackoverflow.com/questions/583255/c-code-in-header-files)*。这为您提供了只需编写一次方法配置文件的所需属性。*

 *就我个人而言，我认为有很好的理由说明最好将声明和定义分开，但如果这让你感到困扰，那么有一种方法可以做你想做的事。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-06-16T13:59:59.043

实际上，您必须编写两次函数**声明（一次在头文件中，一次在实现文件中）。**函数的定义（AKA 实现）将在实现文件中编写一次。

您可以在头文件中编写所有代码（这实际上是 C++ 通用编程中非常常用的做法），但这意味着每个包含该头文件的 C/CPP 文件都意味着从这些头文件重新编译实现。

如果您正在考虑使用类似于 C# 或 Java 的系统，那么在 C++ 中是不可能的。

* * *

## 回答 #8

> 赞同：6
> 
> 时间：2009-06-16T14:17:41.190

**有头文件生成软件。**我从未使用过它，但它可能值得研究。例如，查看**[mkhdr](http://www.hwaci.com/sw/mkhdr/index.html)**！它应该扫描 C 和 C++ 文件并生成适当的头文件。

（但是，正如 Richard 指出的那样，这似乎限制了您使用某些 C++ 功能。请参阅 Richard 的答案，而不是[在此线程中的此处](https://stackoverflow.com/questions/1001639/coding-c-without-headers-best-practices/1001805#1001805)。）

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-06-01T14:48:17.453

还没有人在 Visual Studio 2012 下提到 Visual-Assist X。

它有一堆菜单和热键，您可以使用它们来减轻维护标题的痛苦：

*   “创建声明”将函数声明从当前函数复制到 .hpp 文件中。
*   “重构..更改签名”允许您使用一个命令同时更新 .cpp 和 .h 文件。
*   Alt-O 允许您在 .cpp 和 .h 文件之间立即切换。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-06-16T14:03:19.753

实际上...您可以将整个实现写在一个文件中。模板类都是在头文件中定义的，没有 cpp 文件。

您也可以使用您想要的任何扩展名进行保存。然后在#include 语句中，您将包含您的文件。

```
/* mycode.cpp */
#pragma once
#include <iostreams.h>

class myclass {
public:
  myclass();

  dothing();
};

myclass::myclass() { }
myclass::dothing()
{
  // code
} 
```

然后在另一个文件中

```
/* myothercode.cpp */
#pragma once
#include "mycode.cpp"

int main() {
   myclass A;
   A.dothing();
   return 0;
} 
```

您可能需要设置一些构建规则，但它应该可以工作。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-10-08T06:42:10.290

C++ 20 模块解决了这个问题。不再需要复制粘贴！只需在单个文件中编写代码并使用“导出”导出内容。

```
export module mymodule;

export int myfunc() {
    return 1
} 
```

在此处阅读有关模块的更多信息：[https ://en.cppreference.com/w/cpp/language/modules](https://en.cppreference.com/w/cpp/language/modules)

在撰写此答案时（2022 年 2 月），这些编译器支持它： ![模块支持](../Images/154caeeb30f94dab1826c127a6b090af.png)

有关支持的编译器，请参见此处： [https ://en.cppreference.com/w/cpp/compiler_support](https://en.cppreference.com/w/cpp/compiler_support)

如果您想在 CMake 中使用模块，请参阅此答案： [https ://stackoverflow.com/a/71119196/7910299](https://stackoverflow.com/a/71119196/7910299)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2011-03-16T10:51:17.963

在阅读了所有其他答案后，我发现缺少在 C++ 标准中添加对模块的支持的正在进行的工作。它不会进入 C++0x，但目的是在以后的技术审查中解决它（而不是等待新标准，这需要很长时间）。

正在讨论的提案是[N2073](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2073.pdf)。

不好的部分是即使使用最新的 c++0x 编译器，您也不会得到它。你将不得不等待。同时，您将不得不在*仅标头*库中定义的唯一性和编译成本之间做出妥协。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-06-17T03:52:23.430

要提供 rix0rrr 的流行答案的变体：

```
// foo.cph

#define INCLUDEMODE
#include "foo.cph"
#include "other.cph"
#undef INCLUDEMODE

void foo()
#if !defined(INCLUDEMODE)
{
   printf("Hello World!\n");
}
#else
;
#endif

void bar()
#if !defined(INCLUDEMODE)
{
    foo();
}
#else
;
#endif 
```

我不建议这样做，我认为这种结构表明以死记硬背为代价去除了内容重复。我想它使复制意大利面更容易？这并不是真正的美德。

与这种性质的所有其他技巧一样，对函数体的修改仍然需要重新编译所有文件，包括包含该函数的文件。非常小心的自动化工具可以部分避免这种情况，但它们仍然必须解析源文件以进行检查，并仔细构建以不重写它们的输出（如果没有什么不同）。

对于其他读者：我花了几分钟试图找出这种格式的包含守卫，但没有想出任何好的东西。注释？

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-06-16T14:26:38.957

您**可以避免**标题。完全地。但我不推荐它。

您将面临一些非常具体的限制。其中之一是您将无法拥有循环引用（您将无法让 Parent 类包含指向 ChildNode 类实例的指针，并且 ChildNode 类还包含指向 Parent 类实例的指针。它必须是其中之一。）

还有其他一些限制最终会使您的代码变得非常奇怪。坚持标题。你将学会真正喜欢它们（因为它们提供了一个关于类可以做什么的很好的快速概要）。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2010-09-14T10:58:25.080

我理解你的问题。我会说 C++ 的主要问题是它从 C 继承的编译/构建方法。C/C++ 标头结构是在编码涉及较少定义和更多实现的时候设计的。不要向我扔瓶子，但这就是它的样子。

从那时起，OOP 征服了世界，世界更多的是定义而不是实现。结果，包含标头使使用一种语言工作非常痛苦，其中基本集合（例如 STL 中的集合）是使用模板制作的，而众所周知，编译器很难处理这些工作。当涉及到 TDD、重构工具、通用开发环境时，预编译头文件的所有这些魔法并没有太大帮助。

当然，C 程序员并没有受此困扰，因为他们没有大量编译器的头文件，因此他们对非常简单的低级编译工具链感到满意。对于 C++，这是一段痛苦的历史：无休止的前向声明、预编译的头文件、外部解析器、自定义预处理器等。

然而，许多人没有意识到 C++ 是唯一一种为高级和低级问题提供强大而现代的解决方案的语言。说你应该选择另一种具有适当反射和构建系统的语言很容易，但是我们必须为此牺牲低级编程解决方案，并且我们需要将低级语言混合的事情复杂化使用一些基于虚拟机/JIT 的解决方案。

我有这个想法已经有一段时间了，拥有一个基于“单元”的 c++ 工具链将是地球上最酷的事情，类似于 D 中的工具链。问题出现在跨平台部分：对象文件能够存储任何信息，这没问题，但是由于在 Windows 上，目标文件的结构与 ELF 不同，因此实现跨平台的解决方案来存储和处理中途将是一件很痛苦的事- 编译单元。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-06-16T14:02:14.560

据我所知，没有。标头是 C++ 作为一种语言的固有部分。不要忘记，前向声明允许编译器仅包含指向已编译对象/函数的函数指针，而不必包含整个函数（您可以通过声明内联函数来解决此问题（如果编译器喜欢它）。

如果你真的，真的，真的很讨厌制作标题，请编写一个 perl 脚本来自动生成它们。我不确定我会推荐它。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-03-16T08:19:37.767

完全可以不用头文件进行开发。可以直接包含源文件：

```
#include "MyModule.c" 
```

主要问题是循环依赖之一（即：在 C 中，您必须在调用它之前声明一个函数）。如果您完全自上而下地设计代码，这不是问题，但如果您不习惯这种设计模式，可能需要一些时间来围绕这种设计模式。

如果您绝对必须具有循环依赖关系，则可能需要考虑创建一个专门用于声明的文件并将其包含在其他所有内容之前。这有点不方便，但仍然比每个 C 文件都有一个头文件的污染少。

我目前正在为我的一个主要项目使用这种方法进行开发。以下是我体验过的优势的细分：

*   源代码树中的文件污染要少得多。
*   更快的构建时间。（编译器只生成一个目标文件，main.o）
*   更简单的制作文件。（编译器只生成一个目标文件，main.o）
*   无需“清洁”。每个构建都是“干净的”。
*   更少的样板代码。更少的代码 = 更少的潜在错误。

我发现 Gish（Cryptic Sea 的一款游戏，Edmund McMillen）在其自己的源代码中使用了这种技术的变体。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-06-21T17:37:21.777

Learn to recognize that header files are a good thing. They separate how codes appears to another user from the implementation of how it actually performs its operations.

When I use someone's code I do now want to have to wade through all of the implementation to see what the methods are on a class. I care about what the code does, not how it does it.

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2009-06-16T14:03:37.553

您可以仔细布局您的函数，以便所有依赖函数都在它们的依赖项之后编译，但正如 Nils 所暗示的那样，这是不切实际的。

Catalin（请原谅缺少的变音符号）还建议在头文件中定义方法的更实用的替代方法。这实际上可以在大多数情况下工作..特别是如果您在头文件中有保护以确保它们只包含一次。

我个人认为头文件+声明函数对于“了解”新代码更可取，但我认为这是个人偏好......

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-06-16T14:17:21.770

您可以不使用标题。但是，为什么要努力避免精心制定专家多年来开发的最佳实践。

当我写基本的时候，我很喜欢行号。但是，我不会想把它们塞进 C++ 中，因为那不是 C++ 的方式。标题也是如此……我相信其他答案可以解释所有原因。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2009-06-16T14:17:37.260

出于*实际*目的，不，这是不可能的。从技术上讲，是的，你可以。但是，坦率地说，这是对语言的滥用，你应该适应这种语言。或者转向 C# 之类的东西。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2009-06-16T15:40:07.813

最好的做法是使用头文件，一段时间后它会成长为你。我同意只有一个文件更容易，但它也可能导致错误的编码。

其中一些东西，虽然觉得别扭，但能让你得到更多的东西。

例如，考虑指针、按值/按引用传递参数……等。

对我来说，头文件允许我保持我的项目结构正确

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2011-03-16T11:47:33.270

由于重复，这已经“复活”了......

在任何情况下，标头的概念都是有价值的，即将接口与实现细节分开。标题概述了您如何使用类/方法，而不是它是如何使用的。

缺点是标题中的细节和所有必要的变通方法。这些是我看到的主要问题：

*   依赖生成。修改头文件时，任何包含此头文件的源文件都需要重新编译。问题当然是确定哪些源文件实际使用它。当执行“干净”构建时，通常需要将信息缓存在某种依赖树中以供以后使用。

*   包括警卫。好的，我们都知道如何编写这些，但在一个完美的系统中，这不是必需的。

*   私人细节。在一个类中，您必须将私有详细信息放入标题中。是的，编译器需要知道类的“大小”，但在一个完美的系统中，它可以在稍后阶段绑定它。这会导致各种解决方法，例如 pImpl 和使用抽象基类，即使您只有一个实现只是因为您想隐藏依赖项。

完美的系统将与

*   单独的类定义和声明
*   这两者之间的明确绑定，因此编译器将知道类声明及其定义在哪里，并且会知道类的大小。
*   您声明`using class`而不是预处理器`#include`。编译器知道在哪里可以找到一个类。完成“使用类”后，您可以使用该类名称而无需对其进行限定。

我很想知道 D 是如何做到的。

关于您是否可以在没有标头的情况下使用 C++，我会说不，您需要它们用于抽象基类和标准库。除此之外，没有它们你也可以过得去，尽管你可能不想这样做。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-07-09T15:17:32.210

历史上使用听者文件有两个原因。

1.  在编译要使用库或附加文件的程序时提供符号。

2.  隐藏部分执行；保密。

例如，假设您有一个不想暴露给程序其他部分的功能，但想在您的实现中使用。在这种情况下，您将在 CPP 文件中编写函数，但将其保留在头文件之外。您可以使用变量以及任何想要在浸渍中保持私有且您不希望暴露于该源代码的编号的东西来执行此操作。在其他编程语言中，有一个“public”关键字可以防止模块部分暴露给程序的其他部分。在 C 和 C++ 中，文件级别不存在这样的工具，因此需要使用头文件。

头文件并不完美。使用“#include”只会复制您提供的任何文件的内容。当前工作树的单引号和系统安装的标头的 < 和 >。在系统安装的标准组件的 CPP 中，省略了“.h”；只是 C++ 喜欢做自己的事情的另一种方式。如果你想给 '#include' 任何类型的文件，它将被包含在内。它确实不是像 Java、Python 和大多数其他编程语言那样的模块系统。由于标头不是模块，因此需要采取一些额外的步骤才能从中获得类似的功能。Prepossesser（与所有#keywords 一起使用的东西）将盲目地包含您声明的每个需要在该文件中使用的内容，但是 C 或 C++ 希望在编译中只定义一个符号或含义。如果你使用图书馆，不是 main.cpp，而是在 main 包含的两个文件中，那么您只希望该库包含一次而不是两次。标准库组件经过特殊处理，因此您无需担心在任何地方都使用相同的 C++ 包含。为了让 Prepossesser 第一次看到你的库时它不会再次包含它，你需要使用一个听过的守卫。

听到警卫是最简单的事情。它看起来像这样：

#ifndef LIBRARY_H #define LIBRARY_H

// 在这里写下你的定义。

＃万一

像这样评论 ifndef 被认为是好的：

#endif // LIBRARY_H

但是如果你不做评论，编译器不会在意，也不会伤害任何东西。

#ifndef 所做的只是检查 LIBRARY_H 是否等于 0；不明确的。当 LIBRARY_H 为 0 时，它提供 #endif 之前的内容。

然后#define LIBRARY_H 将LIBRARY_H 设置为1，因此下次预处理器看到#ifndef LIBRARY_H 时，它不会再次提供相同的内容。

（LIBRARY_H 应该是文件名，然后是 _ 和扩展名。如果你不写相同的东西，这不会破坏任何东西，但你应该保持一致。至少为#ifndef 输入文件名。否则，可能会混淆警卫的用途。）

真的没有什么想在这里发生的。

* * *

现在您不想使用头文件。

太好了，说你不关心：

*   通过从头文件中排除它们来将它们私有化

*   您不打算在库中使用此代码。如果您曾经这样做过，现在使用标头可能会更容易，因此您以后不必将代码重新组织到标头中。

*   您不想在头文件中重复一次，然后在 C++ 文件中重复一次。

听者文件的目的可能看起来模棱两可，如果您不关心人们出于想象的原因说出它是错误的，那么请节省您的手，不要费心重复自己。

如何仅包含听者文件

做

```
#ifndef THING_CPP
#define THING_CPP

#include <iostream>

void drink_me() {
  std::cout << "Drink me!" << std::endl;
}

#endif  // THING_CPP 
```

对于thing.cpp。

而对于 main.cpp 做

```
#include "thing.cpp"

int main() {
  drink_me();
  return 0;
} 
```

然后编译。

基本上只需使用 CPP 扩展名命名包含的 CPP 文件，然后将其视为头文件，但在该文件中写出实现。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2020-10-08T06:53:21.567

> 我可以编写没有标头的 C++ 代码吗

阅读[有关 C++](https://en.cppreference.com/w/cpp)的更多信息，例如[*Programming using C++*](https://stroustrup.com/programming.html)书，然后是 C+11 标准[n3337](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf)。

## 是的，因为预处理器（在概念上）生成没有标头的代码。

如果您的 C++ 编译器是[GCC](https://gcc.gnu.org/)并且您正在编译您的[翻译单元](https://en.wikipedia.org/wiki/Translation_unit_(programming)) `foo.cc`，请 考虑运行`g++ -O -Wall -Wextra -C -E foo.cc > foo.ii`；发出的文件`foo.ii`不包含任何预处理器指令，并且可以编译`g++ -O foo.ii -o foo-bin`成`foo-bin` [可执行文件](https://en.wikipedia.org/wiki/Executable)（至少在 Linux 上）。另请参阅[*高级 Linux 编程*](https://mentorembedded.github.io/advancedlinuxprogramming/)

在 Linux 上，以下 C++ 文件

```
// file ex.cc
extern "C" long write(int fd, const void *buf, size_t count);
extern "C" long strlen(const char*);
extern "C" void perror(const char*);
int main (int argc, char**argv)
{
   if (argc>1) 
     write(1, argv[1], strlen(argv[1]);
   else 
     write(1, __FILE__ " has no argument",
              sizeof(__FILE__ " has no argument"));
   if (write(1, "\n", 1) <= 0) {
     perror(__FILE__);
     return 1;
   }
   return 0;
} 
```

可以使用[GCC](https://gcc.gnu.org/)编译成`g++ ex.cc -O ex-bin`可执行文件`ex-bin`，执行时会显示一些内容。

### 在某些情况下，值得用另一个程序*生成*一些 C++ 代码

（可能是[SWIG](http://swig.org/)、[ANTLR](http://antlr.org/)、[Bison](https://www.gnu.org/software/bison/)、[RefPerSys](https://refpersys.org/)、[GPP](https://logological.org/gpp)或您自己的 C++ 代码生成器）并配置您的[构建自动化](https://en.wikipedia.org/wiki/Build_automation)工具（例如[ninja-build](https://ninja-build.org/)或[GNU make](https://www.gnu.org/software/make/)）来处理这种情况。请注意，[GCC 10](https://gcc.gnu.org/gcc-10/)的源代码有十几个 C++ 代码生成器。

使用[GCC](https://gcc.gnu.org/)，您有时可能会考虑编写自己的[GCC 插件](https://gcc.gnu.org/onlinedocs/gccint/Plugins.html)来分析您（或其他人）的 C++ 代码（例如在[GIMPLE](https://gcc.gnu.org/onlinedocs/gccint/GIMPLE.html)级别）。另见（2020 年秋季）[CHARIOT](https://www.chariotproject.eu/)和[DECODER](https://www.decoder-project.eu/)欧洲项目。您还可以考虑使用[Clang 静态分析器](https://clang-analyzer.llvm.org/)或[Frama-C++](https://frama-c.com/)。*

# php - 将 alt img 标签添加到现有的 php 网站

> ID：1001650
> 
> 赞同：1
> 
> 时间：2009-06-16T13:56:08.880
> 
> 标签：php, image, alt

我目前正在尝试为`img`运行 interspire 购物车平台的现有网站添加 alt 标签，我相信我已经非常接近了，但我似乎无法做到正确。任何帮助将不胜感激。

```
// Is there a thumbnail image we can show? 
$thumb = $GLOBALS['ISC_CLASS_PRODUCT']->GetThumb(); 
$alttext = $GLOBALS['ISC_CLASS_PRODUCT']->GetProductName(); 

if ($thumb == '' && GetConfig('DefaultProductImage') != '') {
    if (GetConfig('DefaultProductImage') == 'template') {
        $thumb = GetConfig('ShopPath').'/templates/'.GetConfig('template').'/images/ProductDefault.gif'; 
    } else { 
        $thumb = GetConfig('ShopPath').'/'.GetConfig('DefaultProductImage'); 
    } 
    $thumbImage = '<img src="'.$thumb.'" alt="->GetProductName" />'; 
} else if ($thumb != '') { 
    $thumbImage = '<img src="'.GetConfig('ShopPath').'/'.GetConfig('ImageDirectory').'/'.$thumb.'" alt=""'.$alttext.'" />';
} 
```

*我已尝试发布代码，但它说新用户由于某种原因无法发布图像标签*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T14:23:16.140

在我看来，在您打开 alt 属性后，您有两个双引号，然后是文本，然后是另一个右引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T14:26:15.417

这条线行不通

```
$thumbImage = '<img src="'.$thumb.'" alt="->GetProductName" />'; 
```

你可能想要这样的东西

```
$thumbImage = '<img src="'.$thumb.'" alt="'.$GLOBALS['ISC_CLASS_PRODUCT']->GetProductName().'" />'; 

//or as you have already set $alttext:
$thumbImage = '<img src="'.$thumb.'" alt="' . $alttext . '" />'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:47:19.430

ylebre 的意思是：（向右滚动代码框）

```
} else if($thumb != '') { 
    $thumbImage = '<img src="'.GetConfig('ShopPath').'/'.GetConfig('ImageDirectory').'/'.$thumb.'" alt=""'.$alttext.'" />';
}
                                                                                                        ^
                                                                                                        | 
```

最后多了一个"！

```
} else if($thumb != '') { 
    $thumbImage = '<img src="'.GetConfig('ShopPath').'/'.GetConfig('ImageDirectory').'/'.$thumb.'" alt="' . htmlspecialchars($alttext) . '" />';
} 
```

# vb.net - 在 .NET 中，如何检测用户是否安装了特定的可再发行组件？

> ID：1001651
> 
> 赞同：0
> 
> 时间：2009-06-16T13:56:13.823
> 
> 标签：vb.net, dll, crystal-reports

我创建了一个构建 Crystal 报表并将其显示在报表查看器中的类。

但是，如果没有 Crystal Redistributable，代码会崩溃。如何以编程方式检测最终用户是否安装了 Crystal DLL？

我需要包含的代码是：

```
Imports CrystalDecisions.CrystalReports.Engine
Imports CrystalDecisions.Shared 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T14:00:24.143

理想情况下，您将在安装时处理应用程序的所有依赖项，并确保已安装所有必需的组件。但是，您可以将调用相关 DLL 的代码包装在 try..catch 块中，并在抛出 DllNotFoundException 时捕获它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:16:53.800

我想Crystal安装到GAC。所以你需要以编程方式浏览全局程序集缓存并在那里寻找水晶程序集

GAC 可以通过 Windows API 以编程方式进行管理。 [在这里，您将找到](http://blogs.msdn.com/junfeng/articles/229649.aspx)一个简单的包装器，它允许从托管代码管理 GAC

**但我不建议你走这条路。:)**

好的解决方案通常是在安装软件期间检查所有必需的程序集，我想 Windows Installer 具有检查程序集的功能

但是，它并不总是好的。假设您希望用户在没有 Crystal 的情况下运行您的程序，但如果没有安装 Crystal，则不允许显示报告。

在这种情况下，您应该将所有报告功能与其他表单分离。您应该使用 Crystal Reports 功能创建一个单独的项目，我们称之为 MyReports。只有该项目应该引用 Crystal 程序集，而其他项目不应该。其他项目也不应该直接引用 MyReports。

最后，您应该使用反射从其他项目调用在 MyReports 中实现的报表查看器。

通常，您将编写 try / catch 围绕您将使用反射从文件加载 MyReports 程序集的过程。因此，如果 Crystal 或其他东西不存在，它会抛出异常，您会将其显示给用户，但程序的其他部分将起作用。

此外，您可以阅读有关**依赖注入**设计模式的信息，它有助于管理此类问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T14:26:00.520

您可以检查以下注册表项是否存在

```
HKEY_CURRENT_USER\Software\Crystal Decisions 
```

这将告诉您是否安装了水晶报表。如果要检查特定版本，请检查子密钥。例如，随 Visual Studio 2008 安装的水晶报表是 10.2

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T14:01:40.273

您可以通过查看注册表找到这些详细信息。我将搜索并提供更新。

编辑：您还可以将 Crystal 报表作为先决条件包含在部署包中。然后，您可以确保最终用户拥有该库。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T14:04:49.207

在您的设置中使用[合并模块。](http://en.wikipedia.org/wiki/Merge_Module)Sap 在这里有一个清单：

[合并模块](https://www.sdn.sap.com/irj/scn/wiki?path=/display/BOBJ/Crystal+Reports+for+Visual+Studio+.NET+Runtime+Distribution++-++Versions+9.1+to+12.0)

# macos - 为了拦截文件系统，我需要构建什么样的 Mac 驱动程序？

> ID：1001656
> 
> 赞同：2
> 
> 时间：2009-06-16T13:57:42.777
> 
> 标签：macos, kernel, drivers

在 Windows 世界中，我可以创建一个文件系统过滤器（上层或下层），以便在文件更改（例如审核或创建虚拟驱动器）时将我的驱动程序挂钩到操作。

你知道Mac中哪个是类似的型号吗？I/O Kit 讨论了驱动程序开发，但没有指定存储模型或文件系统。有没有其他套件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T14:15:45.237

OS X 没有像 FreeBSD 一样的 kevent/kqueue 吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:31:26.593

找到这个

[http://developer.apple.com/documentation/Darwin/Conceptual/FSEvents_ProgGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40005289-CH1-DontLinkElementID_15](http://developer.apple.com/documentation/Darwin/Conceptual/FSEvents_ProgGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40005289-CH1-DontLinkElementID_15)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:02:04.670

看起来有一个 Spotlight 使用的私有 API，这里有一些来源：

[http://osxbook.com/software/fslogger/](http://osxbook.com/software/fslogger/)

如果您想创建自己的文件系统（例如虚拟驱动器），请使用 MacFuse

[http://code.google.com/p/macfuse/](http://code.google.com/p/macfuse/)

# sharepoint - sharepoint - 通过对象模型将自定义列添加到列表

> ID：1001661
> 
> 赞同：2
> 
> 时间：2009-06-16T13:58:58.483
> 
> 标签：sharepoint

我无法弄清楚如何使用对象模型将自定义列类型添加到列表中。

SPFieldCollection.Add() 有一个参数 SPFieldType，但它必须是 Microsoft.SharePoint.SPFieldType 枚举中的枚举值之一，因此它不能用于创建自定义类型的列。

我接下来尝试使用 SPFieldCollection.CreateNewField() 但是当我对返回的值调用 SPField.Update() 时出现异常：“ArgumentException 未处理。值不在预期范围内。”。

我在这里看到了对 SPFieldCollection.AddFieldAsXml() 的引用：[How do I add custom column to existing WSS list template](https://stackoverflow.com/questions/277930/how-do-i-add-custom-column-to-existing-wss-list-template/278921#278921)但几乎没有任何信息，我不确定这是正确的做法。

更新：我在 AddFieldAsXml 上找到了一个帖子：[http](http://weblogs.asp.net/bsimser/archive/2005/07/21/420147.aspx) ://weblogs.asp.net/bsimser/archive/2005/07/21/420147.aspx ，事实证明这对我来说非常简单而且效果很好。无论如何发布，希望它会帮助别人。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:08:53.770

据我所知，SPFieldCollection.AddFieldAsXml() 是要走的路。见这里的例子：[http ://weblogs.asp.net/bsimser/archive/2005/07/21/420147.aspx](http://weblogs.asp.net/bsimser/archive/2005/07/21/420147.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-03-31T12:36:07.710

```
 Try with:

 SPField newField = null;
 newField= web.Fields.CreateNewField("MyFieldTypeName", fieldName); 
 web.Fields.Add(newField);

 newField = web.Fields[fieldName];

 // set some properties
 newField.ShowInDisplayForm = false;
 newField.ShowInViewForms = true;
 newField.Update(); 
```

# java - 警告：将来修改

> ID：1001662
> 
> 赞同：10
> 
> 时间：2009-06-16T13:59:02.523
> 
> 标签：java, jsp

我收到警告

```
Warning: sendmailpm.jsp modified in the future. 
```

这是什么意思？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-16T14:02:54.700

如果这样做可能会改变未来，则不允许您修改过去的任何内容。你可能会导致时间悖论，这可能会破坏时间流并导致我们的整个现实不复存在。

请不要修改该文件。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-06-16T14:14:36.690

JSP 文件被编译。许多服务器还允许您替换正在运行的服务器上的文件。然后比较编译源的时间戳和jsp文件的时间戳，判断是否需要重新编译。

如果该文件的日期为将来，则该 jsp 文件将始终比该类更新。这会给你一个警告。

检查文件上的时间戳。也许有人在时钟不正确的计算机上创建了它，现在它似乎是“在未来创建的”。或者服务器的日期可能不正确（检查时区设置）。

是否涉及远程文件服务器？Web 服务器和文件服务器之间的时钟漂移也可能导致此错误。

为了进一步诊断，您必须给我们一些提示——什么 jsp 服务器、什么操作系统、什么文件系统？

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-03-29T21:12:40.890

在 Ant 构建期间，可以在任务期间输出此警告。

```
[copy] Warning: foo\bar.txt modified in the future. 
```

如果目标文件比源文件新， Ant 的`<copy>`任务默认不会复制文件。这节省了大量时间和磁盘 I/O。但是，您可以使用选项覆盖此行为`<copy overwrite="true">`。这告诉 Ant 你知道你在做什么；无论修改日期如何，都覆盖目标文件。这也将抑制警告。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-01-22T11:31:44.623

如果您的代码驻留在 FAT/FAT32 分区或 ZIP 文件上，这可能是由于 FAT/ZIP 文件系统的时间戳（即 2 秒 (afaik)）缺乏精度造成的。这可能会导致编译器/构建工具的输出被保存一段时间后，因此当执行下一个构建/部署步骤（可以在 JSP 容器内部）时，文件将看起来来自未来并且产生警告。尝试使用不同的文件系统，例如 DOS/Windows 机器上的 NTFS。

尝试在 FAT32 TrueCrypt 分区上构建 Java 时，我收到了来自 Apache Ant 的相同警告消息。在排除了其他原因（时区差异、时钟关闭等）后，我最终找到了一个提示，更改为 NTFS TrueCrypt 分区并且警告消失了。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-06-16T14:01:36.950

可能有人修改了文件，然后更改了服务器上的时间。尝试检查您的盒子设置的时间并确保它是正确的。如果是这样，您可能可以忽略该警告而不会产生任何副作用。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2015-02-26T06:15:18.990

检查系统时间是否正确。如果不将其与您所在区域的标准时间同步。然后运行你的构建文件。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-06-16T14:14:58.153

JSP 被即时编译为 servlet。servlet 容器比较两者的“最后修改”日期以查看 JSP 是否已更改以及 servlet 是否需要更新。未来的“最后修改”日期表明系统时钟出现问题，这是相关的，因为它可能会破坏上述机制，导致 servlet 未更新。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-06-28T12:52:08.217

这是因为，您运行构建文件的系统时间不是当前的

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-07-26T01:03:13.960

如果您正在编译的 java 文件的时间戳超出您正在编译的系统的当前时间...您将看到此警告。我在一台机器上修改了文件并将其放在另一台机器上并尝试编译并遇到了这个问题。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-04-16T19:00:17.757

我遇到了同样的问题。解决方案是：我更改了构建机器上的日期和时间，使其与文件复制到的机器上的日期和时间同步。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-11-03T05:22:25.217

如果您有尝试在远程服务器上安装的 jar 文件。远程服务器时间戳可能与您的时区不匹配。如果您的时区比远程服务器提前几个小时，那么您可能会遇到此问题。我还尝试了另一个技巧。当您创建 JAR 文件，然后转到系统时间并设置几个月前的日期并尝试安装 JAR 时，您会收到此错误。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-21T08:42:56.103

我也有这个错误，但是在阅读了上面的一些答案后，我意识到这是由于我在计算机中所做的更改提前几天，因为测试需要日期操作的功能。

这是发生的事情：

1 - 要执行新实现的功能的单元测试，我必须将计算机日期设置为未来 4 天。

2 - 当我执行测试时，编译器按预期自动编译了该类。

3 - 因此，当我尝试重建项目时，IDE 检测到该文件是（具有讽刺意味的）将来创建的。（大声笑——这就是我喜欢 Java 的原因，你甚至可以在未来编写代码。）。

所以+1 @jmanning2k。

我希望它可以帮助面临这个问题的人。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2018-05-04T02:14:03.880

我也看到了这个警告，这是因为以前更改了我计算机中的时间来修复它，因为它比实际时间提前了 20 分钟

# c# - 编译的dll中的序列化异常

> ID：1001692
> 
> 赞同：4
> 
> 时间：2009-06-16T14:03:51.483
> 
> 标签：c#, asp.net, web-applications, serialization, dll

我继承了电子商务 ASP.NET（c# 代码隐藏）Web 应用程序。我们最近移动了服务器，事实证明这有点麻烦。我对 IIS 服务器配置和处理此类大型项目的经验很少。大多数问题现在都已解决，但我们遇到了关键部分的问题，因为客户尝试付款。
当客户确认付款时，应用程序遇到以下错误：

```
 Unable to serialize the session state. In 'StateServer' and 'SQLServer' mode, ASP.NET
will serialize the session state objects, and as a result non-serializable objects or 
MarshalByRef objects are not permitted. The same restriction applies if similar 
serialization is done by the custom session state store in 'Custom' mode. 
```

堆栈跟踪：

```
[SerializationException: Type 'PayerAuthentication.PayerAuthenticationServicePost' in Assembly 'PayerAuthentication, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable.]
   System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type) +7733643
   System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context) +258
   System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo() +111
   System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter) +161
   System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.Serialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter) +51
   System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Serialize(Object graph, Header[] inHeaders, __BinaryWriter serWriter, Boolean fCheck) +410
   System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph, Header[] headers, Boolean fCheck) +134
   System.Web.Util.AltSerialization.WriteValueToStream(Object value, BinaryWriter writer) +1577 
```

谷歌搜索结果表明我应该添加`[Serializable]`到受影响的类声明中，但这是在我没有 csproj 的已编译 dll 中。该代码在以前的服务器上运行良好，我不相信对代码进行了任何更改，仅对 web.config 进行了更改 - 我该怎么办？

web.config 的 sessionstate 部分读取`<sessionState mode="StateServer" />`

**UPDATE1**：使用反射器，我导出了上面的类，使其可序列化，重新编译并替换了 dll。订购过程更进一步，我在另一个 dll 编译的类中遇到了同样的错误。我再次能够使用 Reflector 查看代码，然后将其导出、编辑和重新编译。
现在我有同样的错误发生在：

```
SerializationException: Type 'System.Runtime.Remoting.Messaging.AsyncResult' in Assembly 'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' is not marked as serializable.] 
```

我不确定我能对此做些什么，因为这必须是 .net 系统文件的一部分！还有什么想法吗？

**UPDATE2**：哈，我后来发现它正在正确处理付款，但是在用户收到交易之前抛出上述`Unable to serialize the session state`错误。`System.Runtime.Remoting.Messaging.AsyncResult`不好。现在不知道如何前进...

**UPDATE3**：我尝试创建该类的副本`System.Runtime.Remoting.Messaging.AsyncResult`，并使其可序列化，但这会导致不一致的可访问性问题。

```
using System;
using System.Runtime.InteropServices;
using System.Threading;
using System.Security.Permissions;
using System.Runtime.Remoting.Messaging;

    [Serializable, ComVisible(true)]
    public class myAsyncResult : IAsyncResult, IMessageSink
    {
        // Fields
        private AsyncCallback _acbd;
        private Delegate _asyncDelegate;
        private object _asyncState;
        private ManualResetEvent _AsyncWaitHandle;
        private bool _endInvokeCalled;
        private bool _isCompleted;
        private IMessageCtrl _mc;
        private IMessage _replyMsg;

        // Methods
        internal myAsyncResult(Message m);
        //[SecurityPermission(SecurityAction.LinkDemand, Flags = SecurityPermissionFlag.Infrastructure)]
        public virtual IMessageCtrl AsyncProcessMessage(IMessage msg, IMessageSink replySink);
        private void FaultInWaitHandle();
        public virtual IMessage GetReplyMessage();
        public virtual void SetMessageCtrl(IMessageCtrl mc);
        //[SecurityPermission(SecurityAction.LinkDemand, Flags = SecurityPermissionFlag.Infrastructure)]
        public virtual IMessage SyncProcessMessage(IMessage msg);

        // Properties
        public virtual object AsyncDelegate { get; }
        public virtual object AsyncState { get; }
        public virtual WaitHandle AsyncWaitHandle { get; }
        public virtual bool CompletedSynchronously { get; }
        public bool EndInvokeCalled { get; set; }
        public virtual bool IsCompleted { get; }
        public IMessageSink NextSink { [SecurityPermission(SecurityAction.LinkDemand, Flags = SecurityPermissionFlag.Infrastructure)] get; }
    } 
```

具体来说，那个`error CS0122: 'System.Runtime.Remoting.Messaging.Message' is inaccessible due to its protection level`. 我可以看到这是因为 Message 是一个内部类。但我肯定无法更改它的可访问性级别，因为它是 System.Runtime 命名空间的一部分。制作副本并重命名它会再次解决同样的问题，肯定吗？
现在有人可以帮助我吗？

**最终更新** 看起来，毕竟这是 SSL 证书（见下面我的回答）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T21:05:54.380

如果你真的想要代码，你可以尝试使用 Reflector 的 Class View。至少，它可以帮助您验证是否`[Serializable]`属于问题类定义的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:07:49.403

您需要确定新服务器是比旧服务器更新的版本，还是较旧的服务器。如果它是旧版本，则将其升级到较新版本，并且一切正常。

如果它较新，那么是您的代码（您有源代码）将这些不可序列化的对象置于会话状态吗？如果是这样，那么您也许可以创建自己的类来反映旧类的属性。使您的类可序列化并将您的类的实例置于会话状态。当您退出会话状态时，创建旧类的实例。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-01-10T17:16:30.873

我现在相信这个问题是在我们安装新的 SSL 证书时出现的。

新证书具有邮政编码扩展，我们的支付商汇丰银行不接受其 CPI 支付网关。

安装正确的 SSL 证书似乎终于解决了这个问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T14:08:54.907

如果代码之前只使用内存中的状态提供程序，那么这可能会......很棘手。当默认提供者不需要时，序列化过程（通过`BinaryFormatter`数据库状态提供者使用）需要该属性是一个痛点。`[Serializable]`

您可以编辑多少代码？有吗？例如，您可以更改使事物进入/退出状态的代码吗？您也许可以使用具有必要属性的单独（可序列化）DTO，并使用您自己的代码在它们之间进行转换。

其他选项：

*   回到内存提供程序（向集群挥手告别）
*   编写一个不使用的提供程序`BinaryFormatter`

我对后者有一些想法，但我怀疑这将是微不足道的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T21:30:18.043

如果问题只是如何使应用程序运行而不会出现此错误，那么快速的解决方案是将 sessionState 元素的 mode 属性设置为“InProc”。

# c# - 在 C# 构造函数中使用 this()

> ID：1001694
> 
> 赞同：10
> 
> 时间：2009-06-16T14:04:14.213
> 
> 标签：c#, constructor

我一直试图弄清楚这些构造函数之间是否有任何区别。假设有一个不带参数的 Foo() 构造函数，所有这些构造函数都会有相同的结果吗？

## 示例 1

```
public Foo()
    : this()
{
     blah;
     blah;
     blah;
} 
```

## 示例 2

```
public Foo()
{
     this();
     blah;
     blah;
     blah;
} 
```

## 示例 3

```
public Foo()
{
     this = new Foo();
     blah;
     blah;
     blah;
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-16T14:07:06.267

*   示例 1 有效（假设有无参数构造函数），并在初始化过程中调用无参数构造函数。有关更多详细信息，请参阅我[关于构造函数链接的文章。](http://pobox.com/~skeet/csharp/constructors.html)编辑：请注意，由于 OP 的编辑，它是无限递归的。
*   示例 2 永远无效
*   示例 3 仅在 Foo 是一个结构时有效，并且没有做任何有用的事情。

我会避免分配给`this`结构。正如您从其他答案中看到的那样，它的*可能性*很少有人知道（我只知道是因为它在规范中出现了一些奇怪的情况）。在你得到它的地方，它没有任何好处 - 在其他地方它可能会改变结构，这*不是*一个好主意。结构应该始终是不可变的:)

编辑：只是为了让人们去“meep！” 有点 - 分配 to`this`与链接到另一个构造函数并不完全相同，因为您也可以在方法中执行此操作：

```
using System;

public struct Foo
{
    // Readonly, so must be immutable, right?
    public readonly string x;

    public Foo(string x)
    {
        this.x = x;
    }

    public void EvilEvilEvil()
    {
        this = new Foo();
    }
}

public class Test
{
    static void Main()
    {
        Foo foo = new Foo("Test");
        Console.WriteLine(foo.x); // Prints "Test"
        foo.EvilEvilEvil();
        Console.WriteLine(foo.x); // Prints nothing
    }
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-06-16T14:05:42.463

示例 2 和 3 不是合法的 C#。

编辑：乔恩准确地指出 3`Foo`在`struct`. 去看看他的答案！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T14:05:51.887

不，他们不会，因为只有第一个构造函数实际上是合法的。另外两个由于各种原因是非法的。

**编辑**有趣的是，当 Foo 是一个结构时， 3 确实是合法的。但即使在那种情况下，它也是一个多余的分配。

# java - 缺少 javax.servlet.http.Cookie 类

> ID：1001698
> 
> 赞同：2
> 
> 时间：2009-06-16T14:04:45.930
> 
> 标签：java, eclipse

我没有广泛使用Java，因此忘记了很多基本的东西。基本上，我正在处理一个 web 动态项目（使用带有 jdk 1.6 的 Eclipse IDE），并且在构建过程中，我收到无法找到 Cookie 类和其他 web 相关类的错误。我错过了什么？

我需要添加哪些 Jars 文件（以及如何添加）？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T14:09:43.627

认为你需要 servlet-api.jar

在这里尝试任何您需要的 jar 文件[http://www.java2s.com/Code/Jar/CatalogJar.htm](http://www.java2s.com/Code/Jar/CatalogJar.htm)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T14:08:52.020

听起来你不见了`servlet-api.jar`

您可以从[Maven 存储库](http://repo2.maven.org/maven2/javax/servlet/servlet-api/2.5/)下载它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:08:40.257

Servlet 只是企业版的一部分，而不是 Java 标准版的一部分。因此，您需要 Java 企业版，即 Java EE。

[http://java.sun.com/javaee/](http://java.sun.com/javaee/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T14:23:08.420

正如其他人所说，您缺少服务器 api jar。

话虽如此，仅下载 servlet api jar 而不是附带的服务器意味着您实际上无法*测试*您的代码。

在 Eclipse 中，一旦安装了 servlet 容器，例如[Sun 的 Glassfish](http://glassfish.java.net/)、[Apache Tomcat](http://tomcat.apache.org/)或[Jetty](http://www.mortbay.org/jetty/)，您就可以创建它的服务器实例，以便 Eclipse 针对您的服务器的 servlet 实现进行编译。创建服务器实例也意味着 Eclipse 的 Run on Server 命令有效。

[IBM 有一个关于使用 Tomcat 和 Eclipse 开发 Web 应用程序](http://www.ibm.com/developerworks/library/os-eclipse-tomcat/index.html)的稍微过时的指南。如果您有 Eclipse EE 版本，则可以跳过整个“安装 Web 工具”部分，因为已经安装了 Web 工具。

# client-server - 具有不同客户端的服务器上的 Axis2

> ID：1001707
> 
> 赞同：0
> 
> 时间：2009-06-16T14:06:02.090
> 
> 标签：client-server, axis2

是否可以在服务器上运行axis2并且发送soap消息的客户端不使用axis？这使用了一个进出过程。如果是这样，您是否发现这样做有任何问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T15:11:09.220

是的。Web 服务背后的整个理念是互操作性。

可能有问题。我不确定您要做什么，因此很难说这些问题会是什么。

# sql - 适用于各种 DBMS 系统的 Linux 最佳免费 SQL GUI 是什么

> ID：1001710
> 
> 赞同：57
> 
> 时间：2009-06-16T14:06:28.093
> 
> 标签：sql, linux

当我从 Windows 完全切换到 Linux (CentOS 5) 时，我正在为 MSSQL、MySQL、Oracle 等寻找最好的免费 G​​UI SQL 客户端工具......有什么建议吗？

我已经尝试过 DBVisualizer（迄今为止最好的选择，但仍然受到免费版本的限制，并非所有功能都在那里）、MySQL GUI 工具（很好，但仅适用于 MySQL，也需要其他 DB）和 Aqua Data Studio（与 DBVis 相同） ，这很好，但免费版本中缺少很多功能）。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2009-06-16T14:16:25.813

我强烈推荐[Squirrel SQL](http://squirrel-sql.sourceforge.net/)。

另见这个类似的问题：

[直接访问数据库的开发人员工具](https://stackoverflow.com/questions/721852/developer-tools-to-directly-access-databases)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-07-20T17:25:27.263

我坚持使用 DbVisualizer Free，直到出现更好的东西。

编辑/更新：最近一直在使用[https://dbeaver.io/](https://dbeaver.io/)，真的很享受这个

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-02-12T11:16:18.893

我目前使用用于 SQLite3 的[SQLite 数据库浏览器](http://sqlitebrowser.sourceforge.net/)，它非常有用。跨 Windows/OS X/Linux 工作，轻量且快速。如果格式不正确，在数据库上执行 SQL 会稍微不稳定。

***编辑***：我最近发现了[SQLite Manager](https://addons.mozilla.org/en-us/firefox/addon/sqlite-manager/)，一个 Firefox 插件。显然您需要运行 Firefox，但您可以关闭所有窗口并“独立”运行它。它的功能非常完整，非常稳定，并且可以记住您的数据库！它有大量的特性，所以我已经离开了 SQLite 数据库浏览器，因为它的不稳定性和缺乏特性实在是难以承受。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-06-16T14:12:01.563

对于 Oracle，我强烈推荐免费的 Oracle SQL Developer

[http://www.oracle.com/technology/products/database/sql_developer/index.html](http://www.oracle.com/technology/products/database/sql_developer/index.html)

文档说明它也适用于非 Oracle 数据库 - 我自己从未尝试过该功能，但我知道它适用于 Oracle 非常好

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-08-27T09:07:34.520

我尝试了许多 GUI，对我来说最好的继续是使用 wine 成为“SQLyog-comunity”。是完整的，很好，而且很直观。（在葡萄酒中工作完美）

# c# - 使用 GZipStream 压缩文件，同时保留其元数据

> ID：1001711
> 
> 赞同：2
> 
> 时间：2009-06-16T14:06:33.210
> 
> 标签：c#, .net, compression

压缩后如何获得压缩文件的扩展名`System.IO.Compression.GZipStream`？

例如，如果原始文件被命名`test.doc`并压缩为`test.gz`，我如何知道解压时使用什么文件扩展名？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T14:09:48.853

无法获取文件名 - 事实上，如果在内存中创建一条数据然后通过网络连接发送，则可能根本就没有文件名。

而不是替换文件扩展名，为什么不附加它，例如：test.doc.gz 然后你可以在解压缩时简单地将其剥离。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T14:08:37.403

不知道你的问题是什么——我假设你想要一种机制来“记住”压缩发生之前的扩展是什么？

如果这是问题，那么将 test.doc 压缩到 test.doc.gz 的约定将起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:08:47.810

前段时间我不得不这样做。解决方案是使用 J# 库来执行此操作。但是，您仍然用 C# 编写它。

[http://msdn.microsoft.com/en-us/magazine/cc164129.aspx](http://msdn.microsoft.com/en-us/magazine/cc164129.aspx)

这是微软对该主题的回答。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T14:16:42.630

test.gz 只是一个原始字节流，没有关于已压缩内容的元数据（例如，原始文件名、扩展名等）。您需要做的是创建一个存档，其中包含 gzip 流和存档中包含的每个文件的元数据。

[Mech Software 的答案](https://stackoverflow.com/questions/1001711/gzipstream-in-c-net/1001735#1001735)中链接的文章提供了一种非常合理的实现方式。

还有一个问题（模糊相关）问了一段时间，这可能会有所帮助：

> [如何使用内置的 .net 压缩类压缩目录？](https://stackoverflow.com/questions/900031/how-to-compress-a-directory-with-the-built-in-net-compression-classes)

# asp.net - 使用配置而不是重新编译来更改默认的 SqlCommand CommandTimeout？

> ID：1001713
> 
> 赞同：7
> 
> 时间：2009-06-16T14:06:45.457
> 
> 标签：asp.net, sql-server-2005, .net-3.5, iis-6, windows-server-2003

我支持 ASP.Net 3.5 Web 应用程序，用户在尝试运行报告时遇到超时错误 30 秒后。环顾网络，更改代码中的超时似乎很容易，不幸的是我无法访问代码并重新编译。无论如何要为 Web 应用程序、工作进程、IIS 或整台机器配置默认值吗？

这是堆栈跟踪到它在 System.Data 中的位置，以防我遗漏一些其他问题：

```
[SqlException (0x80131904): Timeout expired.  The timeout period elapsed prior to completion of the operation or the server is not responding.]
  System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) +1948826
  System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +4844747
  System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) +194
  System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) +2392
  System.Data.SqlClient.SqlDataReader.ConsumeMetaData() +33
  System.Data.SqlClient.SqlDataReader.get_MetaData() +83
  System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString) +297
  System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async) +954
  System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result) +162
  System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method) +32
  System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method) +141
  System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior) +12
  System.Data.Common.DbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior) +10
  System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) +130
  System.Data.Common.DbDataAdapter.Fill(DataTable[] dataTables, Int32 startRecord, Int32 maxRecords, IDbCommand command, CommandBehavior behavior) +162
  System.Data.Common.DbDataAdapter.Fill(DataTable dataTable) +115 
```

- 编辑

代码本身之外一定有一些东西 - 我已经下载了数据库并在测试服务器上安装的同一个网站上运行它，它运行超过 30 秒并返回报告。我在 live 和 test 上比较了 .Net 目录中的 machine.config 和 web.config 文件，它们看起来是一样的，比较了两个 IIS 设置，还查看了 SQL Server 配置，唯一的区别是 live服务器集群在 64 位 W2K3 上，而测试服务器在 32 位上。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-06-16T14:10:19.710

不幸的是，我过去读到的所有内容都说不，不能通过配置来控制。这是一个无赖。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T18:08:56.983

您无法从连接字符串或某些外部设置中设置命令超时，抱歉。

有时驱动程序会将连接字符串中的“超时”参数解释为连接超时和命令超时期限，但这在技术上是一个“错误”。一定要喜欢标准。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T14:17:42.737

我所知道的最好的是您可以在连接字符串中设置一个连接超时，它控制 ADO 在尝试连接到 SQL Server 时将等待多长时间，并且不会影响命令超时。

我个人认为应该有一种方法可以更改此设置。假设该程序集的名称不强，您最好的选择可能是对代码进行逆向工程，修改源代码并使用新名称重新部署程序集。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2010-06-03T05:58:48.790

自己动手不太难吧？只需在 AppSettings 下创建自定义 SqlCommandTimeout 设置。如果您已经在使用某种 SqlCommandFactory 来创建您的 SqlCommand 或具有某种 SqlCommand 基类，那么您可以轻松地进行更改。如果不是，那么您可能不太关心您的代码，无论如何都不想将其放入配置文件中。

问候，詹姆斯

# java - 如何创建战争文件

> ID：1001714
> 
> 赞同：96
> 
> 时间：2009-06-16T14:06:50.667
> 
> 标签：java, eclipse, tomcat, war

创建war文件（使用eclipse）以在tomcat上运行的最佳实践是什么？教程，链接，示例非常感谢。

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2009-06-16T14:22:35.660

您可以使用[Ant](http://ant.apache.org/manual/)来设置、编译、[WAR](http://ant.apache.org/manual/Tasks/war.html)和部署您的解决方案。

```
<target name="default" depends="setup,compile,buildwar,deploy"></target> 
```

然后，您可以在 Eclipse 中单击以运行该 Ant 目标。以下是每个步骤的示例：

### 前提条件

我们假设您的代码组织如下：

*   `${basedir}/src`: Java 文件、属性、XML 配置文件
*   `${basedir}/web`: 你的 JSP 文件
*   `${basedir}/web/lib`: 运行时需要的任何 JAR
*   `${basedir}/web/META-INF`: 你的清单
*   `${basedir}/web/WEB-INF`: 你的 web.xml 文件

### 设置

定义一个`setup`任务来创建分发目录并直接复制任何需要 WARred 的工件：

```
<target name="setup">
    <mkdir dir="dist" />
    <echo>Copying web into dist</echo>
    <copydir dest="dist/web" src="web" />
    <copydir dest="dist/web/WEB-INF/lib" src="${basedir}/../web/WEB-INF/lib" />
</target> 
```

### 编译

`src`将您的 Java 文件构建到类中并复制驻留在其下但需要在运行时可用的任何非 Java 工件（例如属性、XML 文件等）：

```
<target name="compile">
    <delete dir="${dist.dir}/web/WEB-INF/classes" />
    <mkdir dir="${dist.dir}/web/WEB-INF/classes" />
    <javac destdir="${dist.dir}/web/WEB-INF/classes" srcdir="src">
        <classpath>
            <fileset dir="${basedir}/../web/WEB-INF/lib">
                  <include name="*" />
            </fileset>
        </classpath>
    </javac>
    <copy todir="${dist.dir}/web/WEB-INF/classes">
        <fileset dir="src">
            <include name="**/*.properties" />
            <include name="**/*.xml" />
        </fileset>
    </copy>
</target> 
```

### 建立战争

创建 WAR 本身：

```
<target name="buildwar">
    <war basedir="${basedir}/dist/web" destfile="My.war"
     webxml="${basedir}/dist/web/WEB-INF/web.xml">
        <exclude name="WEB-INF/**" />
        <webinf dir="${basedir}/dist/web/WEB-INF/">
            <include name="**/*.jar" />
        </webinf>
    </war>
</target> 
```

### 部署

最后，您可以设置一个任务以将 WAR 直接部署到您的 Tomcat 部署位置：

```
<target name="deploy">
    <copy file="My.war" todir="${tomcat.deploydir}" />
</target> 
```

### 点击去！

完成所有这些设置后，只需`default`从 Eclipse 启动目标即可编译、WAR 和部署您的解决方案。

这种方法的优点是它可以在 Eclipse 之外以及在 Eclipse 中工作，并且可以用来轻松地与同样在您的项目上工作的其他开发人员共享您的部署策略（例如，通过源代码控制）。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2009-06-16T14:12:03.730

我总是选择从 Eclipse 导出。它构建战争文件并包含所有必要的文件。假设您将项目创建为 Web 项目，这就是您需要做的所有事情。Eclipse 使它变得非常简单。

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2009-06-16T14:19:07.133

我们所有的 java 项目都使用 Maven（Ant 的老大哥），它有一个非常漂亮的 WAR 插件。可以在那里找到教程和用法。

它比 Ant 容易得多，与 Eclipse 完全兼容（使用*maven eclipse:eclipse*创建 Eclipse 项目）并且易于配置。

[Maven的主页](http://maven.apache.org/ "Maven的主页")

[Maven WAR 插件](http://maven.apache.org/plugins/maven-war-plugin/ "Maven WAR 插件")

示例配置：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-war-plugin</artifactId>
    <version>2.1-alpha-2</version>
    <configuration>
        <outputDirectory>${project.build.directory}/tmp/</outputDirectory>
        <workDirectory>${project.build.directory}/tmp/war/work</workDirectory>
        <webappDirectory>${project.build.webappDirectory}</webappDirectory>
        <cacheFile>${project.build.directory}/tmp/war/work/webapp-cache.xml</cacheFile>
        <nonFilteredFileExtensions>
            <nonFilteredFileExtension>pdf</nonFilteredFileExtension>
            <nonFilteredFileExtension>png</nonFilteredFileExtension>
            <nonFilteredFileExtension>gif</nonFilteredFileExtension>
            <nonFilteredFileExtension>jsp</nonFilteredFileExtension>
        </nonFilteredFileExtensions>
        <webResources>
            <resource>
                <directory>src/main/webapp/</directory>
                <targetPath>WEB-INF</targetPath>
                <filtering>true</filtering>
                <includes>
                    <include>**/*.xml</include>
                </includes>
            </resource>
        </webResources>
        <warName>Application</warName>
    </configuration>
</plugin> 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2009-06-16T14:23:33.940

war 文件只是一个带有 war 扩展名的 jar 文件，但它的工作原理是内容的实际结构。

J2EE/Java EE 教程可以作为一个开始：

[http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/WebComponents3.html](http://java.sun.com/j2ee/tutorial/1_3-fcs/doc/WebComponents3.html)

Servlet 规范包含血淋淋的细节：

[http://java.sun.com/products/servlet/download.html](http://java.sun.com/products/servlet/download.html)

如果您在 Eclipse 中创建一个新的 Web 项目（我指的是 Java EE 版本），则会为您创建该结构，您还可以告诉它您的 Appserver 的安装位置，它将为您部署和启动应用程序。

使用“Export->WAR file”选项可以让您保存war文件。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-06-16T22:12:03.857

如果您不确定该做什么并且从头开始，那么 Maven 可以帮助您入门。

按照以下步骤，您可以在 Eclipse 中完美地获得一个新的战争项目设置。

1.  下载并安装[Maven](http://maven.apache.org/download.html)
2.  去命令行运行：`mvn archetype:generate`
3.  按照提示的步骤 - 选择简单的 java web 项目 (18) 和合适的名称。
4.  完成后运行：`mvn eclipse:eclipse`
5.  启动 Eclipse。选择文件 -> 导入 -> 现有项目。选择您运行 mvn 目标的目录。
6.  就是这样，您现在应该在 Eclipse 中对战争项目有一个很好的开始
7.  `mvn package`您可以通过在 eclipse 中设置服务器并简单地将项目添加到服务器来运行或部署它来创建战争本身。

正如其他人所说，使用 maven 的缺点是您必须使用 maven 约定。但我认为，如果您刚刚开始，在开始自己制作之前学习约定是一个好主意。没有什么可以阻止您稍后更改/重构为您自己喜欢的方法。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-06-16T14:17:49.117

使用[Ant 战争任务](http://ant.apache.org/manual/Tasks/war.html)

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-02-13T08:56:33.817

在 WEB-INF 文件夹外使用以下命令。这应该会创建您的战争文件，并且是我所知道的最快的方法。

*（您需要安装 JDK 1.7+ 和指向 JDK 的 bin 目录的环境变量。）*

```
jar -cvf projectname.war * 
```

[参考链接](http://www.javatpoint.com/war-file)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-11-12T05:56:21.950

使用 ant 构建代码我将其用于我的项目 SMS

```
<property name="WEB-INF" value="${basedir}/WebRoot/WEB-INF" />
<property name="OUT" value="${basedir}/out" />
<property name="WAR_FILE_NAME" value="mywebapplication.war" />
<property name="TEMP" value="${basedir}/temp" />

<target name="help">
    <echo>
        --------------------------------------------------
        compile - Compile
        archive - Generate WAR file
        --------------------------------------------------
    </echo>
</target>

<target name="init">
    <delete dir="${WEB-INF}/classes" />
    <mkdir dir="${WEB-INF}/classes" />
</target>

<target name="compile" depends="init">
    <javac srcdir="${basedir}/src" 
                destdir="${WEB-INF}/classes" 
                classpathref="libs">
    </javac>
</target>

<target name="archive" depends="compile">
    <delete dir="${OUT}" />
    <mkdir dir="${OUT}" />
    <delete dir="${TEMP}" />
    <mkdir dir="${TEMP}" />
    <copy todir="${TEMP}" >
        <fileset dir="${basedir}/WebRoot">
        </fileset>
    </copy>
    <move file="${TEMP}/log4j.properties" 
                    todir="${TEMP}/WEB-INF/classes" />
    <war destfile="${OUT}/${WAR_FILE_NAME}" 
                    basedir="${TEMP}" 
                    compress="true" 
                    webxml="${TEMP}/WEB-INF/web.xml" />
    <delete dir="${TEMP}" />
</target>

<path id="libs">
    <fileset includes="*.jar" dir="${WEB-INF}/lib" />
</path> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2013-05-29T12:22:11.130

另一种选择是使用 Eclipse 自动构建它。当然如果你有持续集成环境推荐使用 Ant 或 Maven。导出选项不是很方便，因为您每次都必须配置导出属性。

*脚步：*

1.  启用“项目档案”支持；这可能取决于您的项目（我在 Java EE/Web 项目中使用它）。右键项目根目录；配置 -> 添加项目档案支持。

2.  在“项目档案”顶部目录中创建一个新档案。您只有 jar 选项，但将存档命名为 *.war。

3.  配置Fileset-s，即要包含哪些文件。典型的是配置两个文件集，类似于配置 Web 部署程序集（项目属性）的方式。

    *   复制 /WebContent 到 /
    *   将 /build/classes 复制到 WEB-INF/classes （在存档中定义 WEB-INF/classes 目录后创建此文件集）
4.  您可能需要调整文件集排除属性，具体取决于您放置一些配置文件的位置，或者您可能需要更多文件集，但想法是，一旦您配置了它，您就不需要更改它。

5.  手动构建存档或直接发布到服务器；但也会由 Eclipse 自动为您构建

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2015-01-23T13:30:56.653

另一个常见的选择是 gradle。

[http://www.gradle.org/docs/current/userguide/application_plugin.html](http://www.gradle.org/docs/current/userguide/application_plugin.html)

要在 Web 应用程序中构建您的战争文件：

在 build.gradle 中，添加：

```
apply plugin: 'war' 
```

然后：

```
./gradlew war 
```

使用上面接受的答案中的布局。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-03-28T17:40:32.340

更简单的解决方案，它也刷新了 Eclipse 工作区：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="project" default="default">    
    <target name="default">
        <war destfile="target/MyApplication.war" webxml="web/WEB-INF/web.xml">
            <fileset dir="src/main/java" />
            <fileset dir="web/WEB-INF/views" />
            <lib dir="web/WEB-INF/lib"/>
            <classes dir="target/classes" />
        </war>
        <eclipse.refreshLocal resource="MyApplication/target" depth="infinite"/>
    </target>
</project> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-12-19T20:29:13.473

用于从标准 Eclipse 动态 Web 项目创建 WAR 文件的简单 Shell 代码。在 Linux 平台上使用 RAM 文件系统 (/dev/shm)。

```
#!/bin/sh

UTILITY=$(basename $0)

if [ -z "$1" ] ; then
    echo "usage: $UTILITY [-s] <web-app-directory>..."
    echo "       -s ..... With source"
    exit 1
fi

if [ "$1" == "-s" ] ; then
    WITH_SOURCE=1
    shift
fi

while [ ! -z "$1" ] ; do
    WEB_APP_DIR=$1

    shift

    if [ ! -d $WEB_APP_DIR ] ; then
        echo "\"$WEB_APP_DIR\" is not a directory"
        continue
    fi

    if [ ! -d $WEB_APP_DIR/WebContent ] ; then
        echo "\"$WEB_APP_DIR\" is not a Web Application directory"
        continue
    fi

    TMP_DIR=/dev/shm/${WEB_APP_DIR}.$$.tmp
    WAR_FILE=/dev/shm/${WEB_APP_DIR}.war

    mkdir $TMP_DIR

    pushd $WEB_APP_DIR > /dev/null
    cp -r WebContent/* $TMP_DIR
    cp -r build/* $TMP_DIR/WEB-INF
    [ ! -z "$WITH_SOURCE" ] && cp -r src/* $TMP_DIR/WEB-INF/classes
    cd $TMP_DIR > /dev/null
    [ -e $WAR_FILE ] && rm -f $WAR_FILE
    jar cf $WAR_FILE .
    ls -lsF $WAR_FILE
    popd > /dev/null

    rm -rf $TMP_DIR
done 
```

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2015-01-30T06:56:55.520

**在 Grails Web 项目的 Eclips Gaynemed 中制作 War 文件 **

1.导入项目：

2.更改datasource.groovy文件

像这样：url="jdbc:postgresql://18.247.120.101:8432/PGMS"

2.更改AppConfig.xml

3.从任务管理器中杀死Java：

4.  在 eclips 中运行干净的命令

5.  按项目名称运行“prod war”。

6.  检查日志文件并在工作台目录中找到相同日期的相同 .war 文件。

# c++ - 在 WinPE 中检测交流电源连接？

> ID：1001719
> 
> 赞同：2
> 
> 时间：2009-06-16T14:07:16.610
> 
> 标签：c++, winapi, wmi, winpe

我正在尝试确定笔记本电脑是否连接到交流电源。

我运行的操作系统是 WinPE。我的应用程序是用原生 C++ 编写的。

不支持使用 Win32_Battery 的 WMI 查询，并且 GetSystemPowerStatus API 始终为 ACLineStatus 返回“1”（是否在交流电源上运行）。

有任何想法吗？

附加调查：刚刚使用 POWER_INFORMATION_LEVEL::SystemBatteryState 尝试了 API 'CallNtPowerInformation'。无论电源状态如何，SYSTEM_BATTERY_STATUS 结构元素 AcOnLine 也返回 1。可能只是调用相同的系统级代码，但我想我会在这里添加它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-10T14:30:53.060

我设法回答了我自己的问题，最终证明它非常简单。

在 WinPE 中，以下 noddy 脚本在执行时返回 null，因为无法识别电池：

strComputer =“。” Set objWMIService = GetObject("winmgmts:\" & strComputer & "\root\CIMV2") Set colItems = objWMIService.ExecQuery("SELECT * FROM Win32_Battery",,48) For Each objItem in colItems Wscript.Echo objItem.BatteryStatus Wscript. Echo objItem.Caption Next

我在我的 PE 映像 (\windows\inf\battery.inf) 中找到了一个电池设备驱动程序，该驱动程序一旦安装就会导致电池被识别并且上述脚本返回预期值。即 BatteryStatus = 2（系统可以使用交流电，因此没有电池正在放电）或 BatteryStatus = 1（电池正在放电，即交流电未连接）。

驱动程序可以安装在 PE 映像本身中，也可以按需加载。即驱动加载

# floating-point - 浮点数 - SAS 十进制问题

> ID：1001722
> 
> 赞同：0
> 
> 时间：2009-06-16T14:07:35.597
> 
> 标签：floating-point, sas, numeric

有人知道正确转换此字符串需要什么 SAS 格式吗？

```
data _null_;
 x="0.14553821459";
 y=input(x,best32.);
 put y=;
run; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T15:59:47.657

试试这个

```
data _null_;
 x="0.14553821459";
 y=input(x,13.11);
 put y= 13.11;
run; 
```

我有

```
y=0.14553821459 
```

# sharepoint - SharePoint：“无法在解决方案中提取 cab 文件”

> ID：1001726
> 
> 赞同：7
> 
> 时间：2009-06-16T14:07:54.393
> 
> 标签：sharepoint, deployment

当我尝试使用 stsadm -o addolution -filename... 部署我的 wsp 时，收到“无法在解决方案中提取 cab 文件”错误。

我已将 wsp 作为 cab 打开并检查其中是否没有重复文件，据我所知，这有时会导致此问题。

问题仅在我尝试将自定义字段类型作为解决方案的一部分时才开始，为此我将以下内容添加到 ddf

..\CustomFields\ShortMonth\ShortMonthControl.ascx ..\CONTROLTEMPLATES\ShortMonthControl.ascx

..\CustomFields\ShortMonth\fldtypes_shortmonth.xml ..\XML\fldtypes_shortmonth.xml

和

`<TemplateFiles`>

`<TemplateFile Location="CONTROLTEMPLATES\ShortMonthControl.ascx"/`>

`<TemplateFile Location="XML\fldtypes_shortmonth.xml"/>`

`</TemplateFiles>`

到清单。

我已经尝试将其恢复为仅对两者中的 ascx 的引用，但它没有帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T14:31:29.683

检查您的文件中是否没有任何特殊字符。他们可能是由于复制粘贴而潜入的。例如，您的代码示例在此页面上呈现的方式，它有 (`)，它不应该在那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T21:18:01.373

您需要 DDF 中的“..\”吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-14T13:43:29.517

该问题更可能是由于您在 SharePoint 14 配置单元文件夹上部署的文件的名称无效。如果您在文件名中使用括号 '(', ')' 或在文件名中使用 @ 等特殊字符，则会出现此问题。

删除它，问题应该消失。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T18:59:57.383

我只知道我遇到了同样的问题，我想我在某处工作时记下了它（我明天会检查一下，如果我发现了什么，我会发回这里）。我只是不记得我现在是如何修复它的（也许是斜线错误的方式 / vs. \..hmm）。我在谷歌上搜索了它（我想你也做过）。找到这个（检查一下）：

[http://www.codeplex.com/wspbuilder/WorkItem/View.aspx?WorkItemId=7385](http://www.codeplex.com/wspbuilder/WorkItem/View.aspx?WorkItemId=7385)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-12-20T12:39:21.003

我的列表实例名称是“MyListInstance（列表实例）”。我从名称中删除了括号，它部署没有问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-02-28T07:33:04.040

检查 .ddf 文件中是否有可能意外重复的行。显然sharepoint不喜欢那样！

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-07-30T12:23:07.580

重新启动解决了我的“无法提取 cab 文件”问题。安装了一些更新，需要重新启动。不清楚这是否相关，但它有所帮助。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-04-06T14:30:07.013

在 WSP 的构建过程中会出现问题。重新构建 WSP 并部署 - 它应该可以正常工作。

# php - PHPflock() - 引擎盖下是什么？

> ID：1001732
> 
> 赞同：6
> 
> 时间：2009-06-16T14:08:32.020
> 
> 标签：php, flock

折腾了半个小时的PHP源码后，我放弃了。:P 问题是——在 Gentoo Linux 系统上 PHP 的 flock() 函数调用归结为什么系统调用？我遇到了一些问题（比如*每 20 次循环迭代中阻塞 30 秒*的问题），我想知道为什么会这样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T14:49:33.170

```
// example: $stream = fopen(**FILE**, 'rb') or die('???');
$md = stream_get_meta_data($stream);
echo $md['wrapper_type'];

flock($stream);
```

如果这打印*了plainfile*，那么对php函数flock()的调用由调用flock()的php_stdiop_set_option(...)处理。根据 PHP 是否使用 HAVE_FLOCK 编译，这可能是系统调用[flock()](http://www.kernel.org/doc/man-pages/online/pages/man2/flock.2.html)或flock_compat.c 中定义的使用[fcntl()](http://www.kernel.org/doc/man-pages/online/pages/man2/fcntl.2.html)的函数。在我的 gentoo 系统上，PHP 是用 HAVE_FLOCK 编译的。

main/streams/plain_wrapper.c @ static int php_stdiop_set_option(...):

> ```
>        案例 PHP_STREAM_OPTION_LOCKING：
>             如果（fd == -1）{
>                 返回-1；
>             }
> 
>             如果（（zend_uintptr_t）ptrparam == PHP_STREAM_LOCK_SUPPORTED）{
>                 返回0；
>             }
> 
>             if (!flock(fd, value)) {
>                 数据->lock_flag = 值；
>                 返回0；
>             } 别的 {
>                 返回-1；
>             }
>             休息;
> ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:00:59.450

[http://www.opengroup.org/onlinepubs/009695399/functions/fcntl.html](http://www.opengroup.org/onlinepubs/009695399/functions/fcntl.html)

```
/etc/standard/flock_compat.c [line 66]    
ret = fcntl(fd, operation & LOCK_NB ? F_SETLK : F_SETLKW, &flck); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:12:18.207

除非我误解了您的要求，否则 PHP是对 Gentoo 上`flock()`Unix 系统函数的调用。[**`flock()`**](http://www.manpagez.com/man/2/flock/)它们具有相同的语义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T14:12:35.773

您是在联网驱动器还是挂载驱动器上使用它？如果您遇到的是[deadlock](http://en.wikipedia.org/wiki/Deadlock)，我不会感到惊讶，并且文档中的一些[评论](http://us3.php.net/manual/en/function.flock.php#82521)谈到了这一点。

[羊群的文档](http://us3.php.net/flock)。

# java - Java 字节缓冲区到 C

> ID：1001740
> 
> 赞同：0
> 
> 时间：2009-06-16T14:09:22.800
> 
> 标签：java, c, bytebuffer

在 Windows 上的 C 程序中，我们需要像 Java 字节缓冲区一样读写，它将二进制文件存储在 BIG_ENDIAN 中

该算法描述于： http: [//mindprod.com/jgloss/binaryformats.html](http://mindprod.com/jgloss/binaryformats.html)

需要读写int和float。

有没有人有执行此操作的示例 c 或 C++ 代码或参考？

TIA，伯特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T14:50:32.827

我认为困难在于在 Big Endian 和 Little Endian 之间进行转换。

本文应该可以帮助您进行 Endian 转换。它包含用于交换整数、长整数、浮点数和任意长度的字节数组的字节顺序的代码。
[http://www.codeproject.com/KB/cpp/endianness.aspx](http://www.codeproject.com/KB/cpp/endianness.aspx)

交换任意类型的代码如下所示：

```
#include <algorithm> //required for std::swap

#define ByteSwap5(x) ByteSwap((unsigned char *) &x,sizeof(x))

void ByteSwap(unsigned char * b, int n)
{
   register int i = 0;
   register int j = n-1;
   while (i<j)
   {
      std::swap(b[i], b[j]);
      i++, j--;
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T14:57:03.967

你想使用[htonl](http://msdn.microsoft.com/en-us/library/ms738556(VS.85).aspx)和类似的。其余的设计是你自己的。

# python - 如何在 Linux 上使用 Python 可逆地存储密码？

> ID：1001744
> 
> 赞同：7
> 
> 时间：2009-06-16T14:09:44.313
> 
> 标签：python, linux, encryption, passwords

首先，我的问题不是密码哈希，而是密码加密。我正在构建一个需要向第三方服务验证用户的桌面应用程序。为了加快登录过程，我想为用户提供保存其凭据的选项。由于我需要密码来验证他对服务的身份，因此无法对其进行哈希处理。

我想过使用 pyCrypto 模块及其 Blowfish 或 AES 实现来加密凭据。问题是在哪里存储密钥。我知道一些应用程序将密钥直接存储在源代码中，但由于我正在编写开源应用程序，这似乎不是一个非常有效的解决方案。

所以我想知道如何在 Linux 上实现用户特定或系统特定的密钥来提高密码存储的安全性。

如果您有比使用 pyCrypto 和系统/用户特定密钥更好的解决方案，请不要犹豫分享它。正如我之前所说，散列不是一种解决方案，我知道密码加密很容易受到攻击，但我想给用户选择权。使用 Gnome-Keyring 也不是一种选择，因为很多人（包括我自己）不使用它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T14:20:28.363

尝试使用[PAM](http://www.kernel.org/pub/linux/libs/pam/)。您可以制作一个在用户登录时自动解密密钥的模块。这就是 GNOME-Keyring 内部的工作方式（如果可能）。您甚至可以使用[pam_python](http://ace-host.stuart.id.au/russell/files/pam_python/)在 Python 中编写 PAM 模块。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T14:24:46.090

加密密码并不能真正为您提供比以明文存储更多的保护。任何能够访问数据库的人都可能拥有对您的网络服务器机器的完全访问权限。

但是，如果安全性损失是可以接受的，并且您确实需要这个，我会在安装过程中生成一个新的密钥文件（来自一个好的随机数据源）并使用它。显然，尽可能安全地存储此密钥（锁定文件权限等）。使用嵌入源中的单个密钥不是一个好主意 - 没有理由单独安装应该具有相同的密钥。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:15:39.450

Password Safe 由 Bruce Schneier 设计并开源。它适用于 Windows，但您应该能够看到他们在做什么并可能重用它。

[http://www.schneier.com/passsafe.html](http://www.schneier.com/passsafe.html)

[http://passwordsafe.sourceforge.net/](http://passwordsafe.sourceforge.net/)

阅读此内容：[如果您在代码中输入 AES，那么您做错了。](http://chargen.matasano.com/chargen/2009/7/22/if-youre-typing-the-letters-a-e-s-into-your-code-youre-doing.html)

# sql - 从另一个 TABLE (Oracle) 更新 TABLE 中的多个列

> ID：1001753
> 
> 赞同：4
> 
> 时间：2009-06-16T14:11:17.430
> 
> 标签：sql, oracle

我想根据另一个表中的值更新一个表中的多个列。

我*想*我知道如何在 T-SQL 中编写一个更新语句来做我想要的（没有测试过下面的）。问题是我正在尝试将其翻译为 Oracle 数据库。有谁知道如何在 Oracle 中执行以下操作：

```
UPDATE oldauth SET
  AUTHUNIQUENAME=newauth.AUTHUNIQUENAME
  DESCRIPTION=newauth.DESCRIPTION
  MAPPINGAUTHNAME=newauth.MAPPINGAUTHNAME
FROM
 (SELECT * FROM USERS1 WHERE AUTHSOURCEID=100) oldauth
LEFT JOIN
 (SELECT * FROM USERS2 WHERE AUTHSOURCEID=200) newauth
ON 
oldauth.AUTHUSERNAME=newauth.AUTHUSERNAME; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T14:15:18.123

```
MERGE
INTO   (
       SELECT  *
       FROM    users1
       WHERE   AUTHSOURCEID=100
       ) oldauth
USING  (
       SELECT  *
       FROM    users2
       WHERE   AUTHSOURCEID=200
       ) newauth
ON     oldauth.AUTHUSERNAME=newauth.AUTHUSERNAME
WHEN MATCHED THEN
UPDATE
SET    AUTHUNIQUENAME=newauth.AUTHUNIQUENAME,
       DESCRIPTION=newauth.DESCRIPTION,
       MAPPINGAUTHNAME=newauth.MAPPINGAUTHNAME 
```

# xml - 有什么方法可以根据 XSD 模式在 Flex 中解析 XML 中的默认属性值？

> ID：1001757
> 
> 赞同：1
> 
> 时间：2009-06-16T14:11:58.630
> 
> 标签：xml, apache-flex, xsd

我有一个带有 xml 模式的 xml。xml-schema 定义了一个抽象的复杂类型，其中包含 2 个具有默认值的可选属性。然后我有几种复杂的类型来扩展基础类型。最后是定义类型的节点。所以我加载了 xml，当我解析每个节点时，可选属性根本不存在。我尝试过使用命名空间，甚至：

```
XML.ignoreProcessingInstructions = false; 
```

没运气。这家伙在[codingforums](http://www.codingforums.com/showthread.php?t=37004)上也经历过类似的事情，但那是 5 年前的事了。Firefox 3.0.11 也发生了同样的事情 - 显示的 xml 没有默认属性。现在我在代码中设置默认值，但是没有办法让它们从 xml-schema 中可用吗？

示例 XML 模式：

```
<schema xmlns="http://www.w3.org/2001/XMLSchema" targetNamespace="http://www.myorg.org" xmlns:tns="http://www.myorg.org" elementFormDefault="qualified">
<element name="config" type="tns:FieldsNode"></element>

<complexType name="FieldsNode">
    <choice minOccurs="0" maxOccurs="unbounded">
        <element name="ImagePicker" type="tns:ImagePickerNode"
            maxOccurs="unbounded" minOccurs="0">
        </element>
    </choice>
</complexType>

<complexType name="FieldBase">
    <attribute use="required" name="id" type="string"></attribute>
    <attribute use="optional" default="true" name="mandatory"
        type="boolean">
    </attribute>
    <attribute default="3" name="colspan" type="int" use="optional"></attribute>
</complexType>

<complexType name="ImagePickerNode">
    <complexContent>
        <extension base="tns:FieldBase">
            <attribute name="maxWidth" type="int" use="required"></attribute>
            <attribute name="maxHeight" type="int" use="required"></attribute>
        </extension>
    </complexContent>
</complexType> 
```

示例 XML：

```
<config xmlns="http://www.myorg.org"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.myorg.org test.xsd">
    <ImagePicker id="somePicker" maxHeight="10" maxWidth="12"/>
    <ImagePicker id="someOtherPicker" maxHeight="100" maxWidth="212" colspan="1" mandatory="false"/> 
</config> 
```

编辑：添加了示例 xml 和架构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-10-29T11:04:42.583

最近偶然发现以下主题：[在 Flex3 Air 中验证 Xml](https://stackoverflow.com/questions/1576617/validate-xml-in-flex3-air)

[Gregor Kiddie](https://stackoverflow.com/users/158242/gregor-kiddie)那里的答案也可能会回答我的问题。根据上述答案，基本上需要注意两个链接：

[XML & XSD 1](http://blog.misprintt.net/?p=181)

[XML & XSD 2](http://blog.misprintt.net/?p=192)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-10-29T11:14:15.917

其实是有可能的，这家伙写了如何使用flex框架中的XMLDecoder和XMLEncoder类来解析/写入基于schema的xml：

[http://blog.misprintt.net/?p=181](http://blog.misprintt.net/?p=181)

[http://blog.misprintt.net/?p=192](http://blog.misprintt.net/?p=192)

展示解析和写入的示例应用程序：http: [//misprintt.net/examples/xmlSchema/](http://misprintt.net/examples/xmlSchema/)

但是，应该注意的是，这些类中有几个错误可能会或可能不会导致您的特定应用程序出现问题。如果我没记错的话，其中之一与模式中具有默认值的可选参数直接相关。在某些（或全部）实例中，从未设置过默认值。但是，一旦您找出问题所在的编码器/解码器类中的哪个位置，这些错误通常很容易修复（因为几乎总是这两个类）。由于这些类具有高度递归性，因此很难发现错误，但对于较小的模式（以及随后的 xml 文件）来说，这并不难。

但是，您仍然必须为相应的架构类型创建 ActionScript 类型。这可以通过让 XMLDecoder 将它的结果吐出一个匿名对象然后直接将该对象序列化为 JSON 格式或 AS 类格式来自动完成。但是，除非所有属性和元素都存在于您的 xml 中，否则您将错过一些属性。还有这个项目，我还没有评估： [http ://www.graniteds.org/confluence/display/DOC/2.+Gas3+Code+Generator](http://www.graniteds.org/confluence/display/DOC/2.+Gas3+Code+Generator)

据说它可以将 Java bean 转换为 AS3，而如今，模式到 Java bean 的转换器只是一毛钱。

希望能帮助到你！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T16:45:03.250

我不知道有任何 XML 库将基于模式的默认属性插入到 XML 文件的 DOM 中。当然，Flex 没有。我相信模式中指定的默认值实际上更多地是作为工具的文档，例如那些生成 XML 可序列化类的工具。

# usb - win32 中的 Readfile 和 Writefile 失败，错误代码为 1

> ID：1001765
> 
> 赞同：1
> 
> 时间：2009-06-16T14:13:56.567
> 
> 标签：usb, wdk

代码 ：

```
hHCDev = CreateFileA(completeDeviceName,
                        //"F:\\test.txt",
                        GENERIC_WRITE|GENERIC_READ,
                        FILE_SHARE_WRITE|FILE_SHARE_READ,
                        NULL,
                        OPEN_EXISTING,
                        0,
                        NULL);

    if (hHCDev == INVALID_HANDLE_VALUE)
        {
                CloseHandle(hHCDev);
        }
    else
        {
            char bufRead[256] = {0};
            DWORD countRead = 0;
            BOOL result ;

            result = ReadFile(hHCDev, bufRead, 5, &countRead, NULL) ;
            if(!result)
            {
                printf("Reading file error %d\n", GetLastError());
            }

            char bufWrite[] = {'7', '8', '9', ' '};
            DWORD countWritten = 0;

            result = WriteFile(hHCDev, bufWrite, 3, &countWritten, NULL) ;
            if(!result)
            {
                printf("Writing file error %d\n", GetLastError());
            }
            else
                {
                    printf("sucess");
                }
            CloseHandle(hHCDev);
        }
        memset(completeDeviceName,0,256) ; 
```

描述：

我们尝试打开使用 createfile() 连接的 USB 设备。使用 Readfile 和 Writefile() 调用，我们尝试与设备通信。但是这些调用返回错误代码 1。可能是什么原因？

您的帮助将不胜感激。

最好的问候苏伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T14:26:35.980

尝试以管理员权限运行您的应用程序。

# java - Mac OS X 上的小程序 1.6

> ID：1001766
> 
> 赞同：1
> 
> 时间：2009-06-16T14:13:58.733
> 
> 标签：java, macos

我有一个小程序，我正在尝试在 Mac OS X 上的 64 位 1.6 Java VM 中进行测试。但是，Safari 正在继续加载 1.5 VM。我尝试在 Java 首选项中将默认小程序 VM 更改为 1.6，但没有任何效果。

目前有没有办法在 Mac 上的 Safari（或其他浏览器）中使用新的 1.6.0_13 小程序 VM？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-09-04T20:34:59.423

由于小程序在浏览器中运行，为了在 64 位 Java 中运行小程序，您需要使用 64 位浏览器。

在 Snow Leopard (10.6) 之前，Safari 是 32 位的。

如果您使用 64 位浏览器，您应该能够使用 64 位 VM。

# design-patterns - 工厂和抽象工厂设计模式之间的基本区别是什么？

> ID：1001767
> 
> 赞同：510
> 
> 时间：2009-06-16T14:14:06.847
> 
> 标签：design-patterns, factory, abstract-factory, factory-method

工厂模式和抽象工厂模式之间的基本区别是什么？

* * *

## 回答 #1

> 赞同：430
> 
> 时间：2009-06-16T14:18:25.683

使用工厂模式，您可以生成`Apple`特定接口（`Banana`例如.`Cherry``IFruit`

使用抽象工厂模式，您可以为任何人提供一种方式来提供自己的工厂。这使您的仓库可以是 an`IFruitFactory`或 an `IJuiceFactory`，而无需您的仓库了解有关水果或果汁的任何信息。

* * *

## 回答 #2

> 赞同：149
> 
> 时间：2010-04-13T18:20:59.773

> 此信息的来源取自：http: [//java.dzone.com/news/intro-design-patterns-abstract](http://java.dzone.com/news/intro-design-patterns-abstract)

## 抽象工厂与工厂方法

抽象工厂的方法被实现为工厂方法。抽象工厂模式和工厂方法模式都通过抽象类型和工厂将客户端系统与实际实现类解耦。工厂方法通过继承创建对象，抽象工厂通过组合创建对象。

抽象工厂模式由 AbstractFactory、ConcreteFactory、AbstractProduct、ConcreteProduct 和 Client 组成。

## 如何实施

抽象工厂模式可以使用工厂方法模式、原型模式或单例模式来实现。ConcreteFactory 对象可以实现为 Singleton，因为只需要一个 ConcreteFactory 对象的实例。

工厂方法模式是抽象工厂模式的简化版本。工厂方法模式负责创建属于一个系列的产品，而抽象工厂模式处理多个产品系列。

工厂方法使用接口和抽象类将客户端与生成器类和生成的产品分离。抽象工厂有一个生成器，它是多个工厂方法的容器，以及将客户端与生成器和产品解耦的接口。

## 何时使用工厂方法模式

当需要将客户端与其使用的特定产品分离时，请使用工厂方法模式。使用工厂方法来减轻客户创建和配置产品实例的责任。

## 何时使用抽象工厂模式

当客户端必须与产品类分离时，使用抽象工厂模式。对程序配置和修改特别有用。抽象工厂模式还可以强制限制哪些类必须与其他类一起使用。建造新的混凝土工厂可能需要做很多工作。

## 例子：

### 抽象工厂示例 1

用于在意大利面制造商中准备不同类型意大利面的磁盘的规范是抽象工厂，每个特定的磁盘都是一个工厂。所有工厂（意大利面制造商磁盘）都从抽象工厂继承其属性。每个单独的磁盘都包含如何制作意大利面的信息，而意大利面制造商没有。

### 抽象工厂示例 2：

冲压设备对应于抽象工厂，因为它是创建抽象产品对象的操作的接口。模具对应于混凝土工厂，因为它们制造了混凝土产品。每个零件类别（引擎盖、门等）对应于抽象产品。具体部件（即99凯美瑞驾驶员侧车门）对应具体产品。

### 工厂方法示例：

玩具公司对应于 Creator，因为它可以使用工厂来创建产品对象。制造特定类型玩具（马或汽车）的玩具公司的部门对应于 ConcreteCreator。

* * *

## 回答 #3

> 赞同：102
> 
> 时间：2009-06-16T14:16:41.473

工厂模式：工厂生产IProduct-实施

抽象工厂模式：工厂工厂生产 IFactories，而后者又生产 IProducts :)

*[根据评论更新]*
我之前写的至少根据[维基百科是不正确的。](https://en.wikipedia.org/wiki/Abstract_factory_pattern)抽象工厂只是一个工厂接口。有了它，您可以在运行时切换您的工厂，以允许在不同的上下文中使用不同的工厂。示例可能是针对不同操作系统、SQL 提供程序、中间件驱动程序等的不同工厂。

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2009-06-16T14:16:18.260

# 抽象工厂模式

*   提供用于创建相关或依赖对象系列的接口，而无需指定它们的具体类。

*   抽象工厂模式与工厂方法模式非常相似。两者之间的一个区别在于，对于抽象工厂模式，一个类通过组合将对象实例化的责任委托给另一个对象，而工厂方法模式使用继承并依赖子类来处理所需的对象实例化。

*   实际上，委托对象经常使用工厂方法来执行实例化！

# 工厂模式

*   工厂模式是创建模式的示例

*   创建模式抽象了对象实例化过程。它们隐藏了对象的创建方式，并有助于使整个系统独立于其对象的创建和组合方式。

*   类创建模式侧重于使用继承来决定要实例化的对象工厂方法

*   对象创建模式专注于将实例化委托给另一个对象抽象工厂

参考： [**工厂与抽象工厂**](http://userpages.umbc.edu/%7Etarr/dp/lectures/Factory.pdf)

* * *

## 回答 #5

> 赞同：41
> 
> 时间：2011-05-06T07:10:24.570

**工厂方法：**您有一个工厂，它创建从特定基类派生的对象

**抽象工厂：**您有一个创建*其他工厂*的工厂，而这些工厂又创建从基类派生的对象。这样做是因为您通常不只是想创建单个对象（如使用 Factory 方法），而是希望创建相关对象的集合。

* * *

## 回答 #6

> 赞同：39
> 
> 时间：2016-03-01T04:24:45.840

**基本区别：**

***工厂：***创建对象而不向客户端公开实例化逻辑。

***工厂方法***：定义一个用于创建对象的接口，但让子类决定实例化哪个类。Factory 方法允许类将实例化推迟到子类

***抽象工厂***：提供一个接口，用于创建相关或依赖对象的系列，而无需指定它们的具体类。

*抽象*工厂模式使用组合将创建对象的责任委托给另一个类，而*工厂方法*模式使用继承并依赖派生类或子类来创建对象

来自[oodesign](http://www.oodesign.com/creational-patterns/)文章：

[**工厂**](http://www.oodesign.com/factory-pattern.html)类图：

[![在此处输入图像描述](../Images/7fa70f1c440ce4a98433a7ed663f1c8d.png)](https://i.stack.imgur.com/mJN91.gif)

*示例：静态工厂*

```
 public class ShapeFactory {

   //use getShape method to get object of type shape 
   public static Shape getShape(String shapeType){
      if(shapeType == null){
         return null;
      }     
      if(shapeType.equalsIgnoreCase("CIRCLE")){
         return new Circle();

      } else if(shapeType.equalsIgnoreCase("RECTANGLE")){
         return new Rectangle();

      } else if(shapeType.equalsIgnoreCase("SQUARE")){
         return new Square();
      }

      return null;
   }
} 
```

这篇文章中提供了实现 FactoryMethod 示例的非静态工厂：

[设计模式：工厂 vs 工厂方法 vs 抽象工厂](https://stackoverflow.com/questions/13029261/design-patterns-factory-vs-factory-method-vs-abstract-factory/35851402?s=1|10.3261#35851402)

**何时使用：**客户端只需要一个类，并不关心它得到了哪个具体的实现。

[**工厂方法**](http://www.oodesign.com/factory-method-pattern.html)类图表：

[![在此处输入图像描述](../Images/33e337476a08cae6b2edd946bad3d8a3.png)](https://i.stack.imgur.com/oNtz1.gif)

**何时使用：**客户端不知道在运行时需要创建哪些具体类，但只想获得一个可以完成这项工作的类。

[](https://dzone.com/articles/design-patterns-abstract-factory)**[来自dzone的](https://dzone.com/articles/design-patterns-abstract-factory)[**抽象工厂**](https://dzone.com/articles/design-patterns-abstract-factory)类图**

 **[![在此处输入图像描述](../Images/736073a67b4db9c06fa9495efd87d2fa.png)](https://i.stack.imgur.com/ALJzI.png)

**何时使用：**当您的系统必须创建多个产品系列或您想要提供产品库而不公开实现细节时。

以上文章中的源代码示例非常有助于清楚地理解概念。

带有代码示例的相关 SE 问题：

[工厂模式。什么时候使用工厂方法？](https://stackoverflow.com/questions/69849/factory-pattern-when-to-use-factory-methods/35857241#35857241)

**差异：**

1.  抽象工厂类通常使用工厂方法实现，但也可以使用原型实现
2.  设计开始使用工厂方法（不太复杂，更可定制，子类激增），然后向需要更大灵活性的其他创建模式（更灵活，更复杂）发展。
3.  工厂方法通常在模板方法中调用。

其他有用的文章：

[来自sourcemaking](https://sourcemaking.com/design_patterns/factory_method)的 factory_method

来自 sourcemaking 的[abstract_factory](https://sourcemaking.com/design_patterns/abstract_factory)

来自 journaldev[的抽象工厂设计模式](http://www.journaldev.com/1418/abstract-factory-design-pattern-in-java)

* * *

## 回答 #7

> 赞同：36
> 
> 时间：2013-12-18T02:17:58.403

抽象工厂是用于创建相关对象的接口，但工厂方法是一种方法。抽象工厂是通过工厂方法实现的。

![在此处输入图像描述](../Images/a45d33f8fbe51ab5a68474605e3e00ee.png)

* * *

## 回答 #8

> 赞同：24
> 
> 时间：2014-12-19T18:54:41.243

也许很多人会感到惊讶，但这个问题是**不正确**的。如果你在面试中听到这个问题，你需要帮助面试官了解困惑在哪里。

让我们从没有被称为“工厂”的具体模式这一事实开始。有一种称为“抽象工厂”的模式，也有一种称为“工厂方法”的模式。

那么，“工厂”是什么意思呢？以下之一（所有都可以被认为是正确的，取决于参考的范围）：

*   有些人将其用作“[抽象工厂](http://en.wikipedia.org/wiki/Abstract_factory_pattern)”的别名（快捷方式）。
*   有些人将其用作“[工厂方法](http://en.wikipedia.org/wiki/Factory_method_pattern)”的别名（快捷方式）。
*   有些人将其用作所有工厂/创建模式的更通用名称。例如，“抽象工厂”和“工厂方法”都是工厂。

而且，**不幸**的是，许多人使用“工厂”来表示另一种工厂，它创建一个或多个工厂（或其接口）。根据他们的理论：

> Product 实现了由 Factory 创建的 IProduct，后者实现了由 AbstractFactory 创建的 IFactory。

为了理解这是多么愚蠢，让我们继续我们的等式：

> AbstractFactory 实现了 IAbstractFactory，它是由...AbstractAbstractFactory 创建的？

我希望你明白这一点。不要迷惑​​，也请不要发明不存在的东西。

-

**PS**：产品的工厂是抽象工厂，抽象工厂的工厂也只是抽象工厂的另一个例子。

* * *

## 回答 #9

> 赞同：23
> 
> 时间：2012-10-20T06:02:25.677

抽象工厂的示例/场景

我住在一个雨季下雨，冬天下雪，夏天炎热和阳光充足的地方。我需要不同种类的衣服来保护自己免受元素的伤害。为此，我会去我家附近的商店买衣服/物品来保护自己。店员会根据我口袋的环境和深度给我合适的物品。他给我的物品质量和价格范围相同。因为他知道我的标准，所以他很容易这样做。但是，当街对面的一个有钱人提出同样的要求时，他会得到一件昂贵的品牌商品。一件值得注意的事情是，他给我的所有物品在质量、标准和成本方面都相得益彰。可以说他们是一起去的。这个有钱人得到的物品也是如此。

所以通过看上面的场景，我现在很欣赏店主的效率。我可以用抽象商店代替这个店主。我们得到的项目是抽象项目，我和富人作为透视客户。我们所需要的只是适合我们需求的产品/项目。

现在我可以很容易地看到自己正在考虑为众多客户提供一系列服务的在线商店。每个客户都属于三个组之一。当高级组用户打开网站时，他会获得出色的用户界面、高度定制的广告窗格、菜单中的更多选项等。这些相同的功能集呈现给黄金用户，但菜单中的功能较少，广告大多是相关的，和稍微少一点的人机界面。最后是我的一种用户，一个“免费组”用户。我只是得到足够的服务，所以我不会被冒犯。用户界面是最低限度的，广告太离谱了，以至于我不知道里面有什么，最后菜单只有注销。

如果我有机会建立类似这个网站的东西，我肯定会考虑抽象工厂模式。

抽象产品：广告窗格、菜单、UI 画家。
抽象工厂：网店用户体验
Concreate Factory：高级用户体验、金牌用户体验、一般用户体验。

* * *

## 回答 #10

> 赞同：17
> 
> 时间：2013-08-09T06:48:23.040

```
//Abstract factory - Provides interface to create factory of related products
interface PizzaIngredientsFactory{    
   public Dough createDough(); //Will return you family of Dough
   public Clam createClam();   //Will return you family of Clam
   public Sauce createSauce(); //Will return you family of Sauce
}

class NYPizzaIngredientsFactory implements PizzaIngredientsFactory{

   @Override
   public Dough createDough(){
      //create the concrete dough instance that NY uses
      return doughInstance;
   }

   //override other methods
} 
```

其他答案已经提供了教科书的定义。我想我也会提供一个例子。

所以这里`PizzaIngredientsFactory`是一个**抽象工厂**，因为它提供了创建相关产品系列的方法。

请注意，抽象工厂中的每个方法本身都是**工厂方法**。Like`createDough()`本身就是一个工厂方法，其具体实现将由`NYPizzaIngredientsFactory`. 因此，使用这个每个不同的位置都可以创建属于其位置的具体成分的实例。

## 工厂方法

> 提供具体实现的实例

在示例中：
- `createDough()`- 提供了面团的具体实现。所以这是一个工厂方法

## 抽象工厂

> 提供创建相关对象系列的接口

在示例中：
-`PizzaIngredientsFactory`是一个抽象工厂，因为它允许创建一组相关的对象，例如`Dough`, `Clams`, `Sauce`。为了创建每个对象系列，它提供了一个工厂方法。

[Head First 设计模式](http://www.amazon.in/First-Design-Patterns-Elisabeth-Freeman/dp/0596007124)的示例

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2015-10-21T20:25:29.793

我对约翰的回答有一些贡献，如下所示：

## 抽象工厂是工厂的工厂！

使用“工厂方法”（因为只是“工厂”是模棱两可的），您可以生成特定接口的实现（ 、 等）——`Lemon`比如. 这个工厂可以被称为。`Orange``IFruit``CitricFruitFactory`

但是现在您想要创建 CitricFruitFactory 无法创建的另一种水果。如果您在其中创建一个，则代码`CitricFruitFactory`可能没有意义`Strawberry`（草莓不是柠檬水果！）。

所以你可以创建一个新的 Factory`RedFruitFactory`来生产`Strawberry`,`Raspberry`等等。

**正如 John Feminella 所说：** *“使用抽象工厂模式，您可以生成特定工厂接口的实现——例如，`IFruitFactory`。每个人都知道如何创建不同种类的水果。”*

`IFruitFactory`are`CitricFruitFactory`和`RedFruitFactory`!的实现

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2015-06-02T15:04:51.273

我的来源是：`StackOverflow`、、 `tutorialspoint.com`和。`programmers.stackexchange.com``CodeProject.com`

* * *

`Factory Method`（也称为`Factory`）用于解耦`Interface`实现的客户端。对于示例，我们有一个`Shape`带有两个`Circle`和`Square`实现的接口。我们已经定义了一个带有工厂方法的工厂类，该工厂方法带有一个确定参数，例如接口`Type`的新相关实现。`Shape`

* * *

`Abstract Factory`包含多个工厂方法或由多个工厂实现的工厂接口。对于上面的下一个示例，我们有一个`Color`带有两个`Red`和`Yellow`实现的接口。我们已经定义了一个`ShapeColorFactory`带有两个`RedCircleFactory`和的接口`YellowSquareFactory`。以下代码用于解释此概念：

```
interface ShapeColorFactory
{
    public Shape getShape();
    public Color getColor();
}

class RedCircleFactory implements ShapeColorFactory
{
    @Override
    public Shape getShape() {
        return new Circle();
    }

    @Override
    public Color getColor() {
        return new Red();
    }
}
class YellowSquareFactory implements ShapeColorFactory
{
    @Override
    public Shape getShape() {
        return new Square();
    }

    @Override
    public Color getColor() {
        return new Yellow();
    }
} 
```

`FactoryMethod`这里和之间的区别`AbstractFactory`。`Factory Method`就像简单地返回一个具体的接口类但`Abstract Factory`return `factory of factory`。也就是说`Abstract Factory`返回一系列接口的不同组合。

* * *

我希望我的解释有用。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-01-06T21:11:01.647

这些工厂的主要区别在于您何时想对工厂做什么以及何时想使用它。

有时，当您进行 IOC（控制反转，例如构造函数注入）时，您知道可以创建实体对象。正如上面水果的例子中提到的，如果你准备好创建水果对象，你可以使用简单的**工厂模式**。

但很多时候，您不想创建实体对象，它们会在程序流程的后面出现。但是配置告诉你一开始你想使用什么样的工厂，而不是创建对象，你可以将派生自公共工厂类的工厂传递给 IOC 中的构造函数。

所以，我认为这也与对象的生命周期和创建有关。

* * *

## 回答 #14

> 赞同：3
> 
> 时间：2016-01-17T08:51:27.027

两者都`Factory Method`使`Abstract Factory`客户端与具体类型分离。两者都创建对象，但`Factory`方法使用继承而`Abstract Factory`使用组合。

在`Factory Method`子类中继承以创建具体对象（产品），而`Abstract Factory`提供用于创建相关产品系列的接口，这些接口的子类定义如何创建相关产品。

然后这些子类在实例化时被传递到用作抽象类型的产品类中。an 中的相关产品`Abstract Factory`通常使用`Factory Method`.

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2016-10-26T11:57:00.350

**扩展 John Feminella 的答案：**

`Apple`, `Banana`,`Cherry`实现`FruitFactory`并且有一个方法被调用`Create`，该方法单独负责创建 Apple 或 Banana 或 Cherry。你用你的`Factory`方法完成了。

现在，你想用`Create`你的水果做一份特别的沙拉，你的**抽象工厂**来了。Abstract Factory 知道如何用苹果、香蕉和樱桃制作您的特色沙拉。

```
public class Apple implements Fruit, FruitFactory {
    public Fruit Create() {
        // Apple creation logic goes here
    }
}

public class Banana implements Fruit, FruitFactory {
    public Fruit Create() {
        // Banana creation logic goes here
    }
}

public class Cherry implements Fruit, FruitFactory {
    public Fruit Create() {
        // Cherry creation logic goes here
    }
}

public class SpecialSalad implements Salad, SaladFactory {
    public static Salad Create(FruitFactory[] fruits) {
        // loop through the factory and create the fruits.
        // then you're ready to cut and slice your fruits 
        // to create your special salad.
    }
} 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-02-15T10:48:00.070

通过定义我们可以拖出两者的区别：

工厂：接口用于创建对象，但子类决定实例化哪个类。对象的创建在需要时完成。

抽象工厂：抽象工厂模式充当创建其他工厂的超级工厂。在抽象工厂模式中，接口负责创建一组相关对象或依赖对象，而无需指定它们的具体类。

因此，在上面的定义中，我们可以强调一个特定的区别。即工厂模式负责创建对象，抽象工厂负责创建一组相关对象；显然都是通过一个接口。

工厂模式：

```
public interface IFactory{
  void VehicleType(string n);
 }

 public class Scooter : IFactory{
  public void VehicleType(string n){
   Console.WriteLine("Vehicle type: " + n);
  }
 }

 public class Bike : IFactory{
  public void VehicleType(string n) {
  Console.WriteLine("Vehicle type: " + n);
  }
 }

 public interface IVehicleFactory{
  IFactory GetVehicleType(string Vehicle);
 }

 public class ConcreteVehicleFactory : IVehicleFactory{
 public IFactory GetVehicleType(string Vehicle){
   switch (Vehicle){
    case "Scooter":
     return new Scooter();
    case "Bike":
     return new Bike();
    default:
    return new Scooter();
  }
 }

 class Program{
  static void Main(string[] args){
   IVehicleFactory factory = new ConcreteVehicleFactory();
   IFactory scooter = factory.GetVehicleType("Scooter");
   scooter.VehicleType("Scooter");

   IFactory bike = factory.GetVehicleType("Bike");
   bike.VehicleType("Bike");

   Console.ReadKey();
 }
} 
```

抽象工厂模式：

```
interface IVehicleFactory{
 IBike GetBike();
 IScooter GetScooter();
}

class HondaFactory : IVehicleFactory{
     public IBike GetBike(){
            return new FZS();
     }
     public IScooter GetScooter(){
            return new FZscooter();
     }
 }
class HeroFactory: IVehicleFactory{
      public IBike GetBike(){
            return new Pulsur();
     }
      public IScooter GetScooter(){
            return new PulsurScooter();
     }
}

interface IBike
    {
        string Name();
    }
interface IScooter
    {
        string Name();
    }

class FZS:IBike{
   public string Name(){
     return "FZS";
   }
}
class Pulsur:IBike{
   public string Name(){
     return "Pulsur";
   }
}

class FZscooter:IScooter {
  public string Name(){
     return "FZscooter";
   }
}

class PulsurScooter:IScooter{
  public string Name(){
     return "PulsurScooter";
   }
}

enum MANUFACTURERS
{
    HONDA,
    HERO
}

class VehicleTypeCheck{
        IBike bike;
        IScooter scooter;
        IVehicleFactory factory;
        MANUFACTURERS manu;

        public VehicleTypeCheck(MANUFACTURERS m){
            manu = m;
        }

        public void CheckProducts()
        {
            switch (manu){
                case MANUFACTURERS.HONDA:
                    factory = new HondaFactory();
                    break;
                case MANUFACTURERS.HERO:
                    factory = new HeroFactory();
                    break;
            }

      Console.WriteLine("Bike: " + factory.GetBike().Name() + "\nScooter: " +      factory.GetScooter().Name());
        }
  }

class Program
    {
        static void Main(string[] args)
        {
            VehicleTypeCheck chk = new VehicleTypeCheck(MANUFACTURERS.HONDA);
            chk.CheckProducts();

            chk= new VehicleTypeCheck(MANUFACTURERS.HERO);
            chk.CheckProducts();

            Console.Read();
        }
    } 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2012-01-06T15:15:08.003

在这里检查：[http](http://www.allapplabs.com/java_design_patterns/abstract_factory_pattern.htm) ://www.allapplabs.com/java_design_patterns/abstract_factory_pattern.htm 似乎工厂方法使用特定类（非抽象）作为基类，而抽象工厂为此使用抽象类。此外，如果使用接口而不是抽象类，结果将是抽象工厂模式的不同实现。

:D

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2016-12-25T09:27:38.957

抽象工厂是用于创建不同类型接口的模板。假设您有一个项目，需要您解析不同类型的 csv 文件，其中包含数量、价格和项目特定信息，例如一些包含有关水果的数据，而其他有关巧克力的数据，然后在解析后您需要在其相应的数据库中更新此信息，所以现在您可以拥有一个抽象工厂返回解析器和修改器工厂，然后这个解析器工厂可以返回巧克力解析器对象、水果解析器对象等，类似地修改器工厂可以返回巧克力修改器对象、水果修改器对象等。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2017-04-25T06:09:03.720

我想我们可以通过查看 Java8 示例代码来理解这两者之间的区别：

```
 interface Something{}

  interface OneWhoCanProvideSomething {
     Something getSomething();
  }

  interface OneWhoCanProvideCreatorsOfSomething{
     OneWhoCanProvideSomething getCreator();
  }

public class AbstractFactoryExample {

    public static void main(String[] args) {
        //I need something
        //Let's create one
        Something something = new Something() {};

        //Or ask someone (FACTORY pattern)
        OneWhoCanProvideSomething oneWhoCanProvideSomethingOfTypeA = () -> null;
        OneWhoCanProvideSomething oneWhoCanProvideSomethingOfTypeB = () -> null;

        //Or ask someone who knows soemone who can create something (ABSTRACT FACTORY pattern)
        OneWhoCanProvideCreatorsOfSomething oneWhoCanProvideCreatorsOfSomething = () -> null;

        //Same thing, but you don't need to write you own interfaces
        Supplier<Something> supplierOfSomething = () -> null;
        Supplier<Supplier<Something>> supplierOfSupplier = () -> null;
    }

} 
```

现在的问题是您应该使用哪种创建方式以及为什么：第一种方式（没有模式，只是简单的构造函数）：自己创建不是一个好主意，您必须完成所有工作，并且您的客户端代码与具体实现。

第二种方式（使用工厂模式）：为您提供可以传递任何类型的实现的好处，它可以根据某些条件（可能是传递给创建方法的参数）提供不同类型的东西。

第三种方式（使用抽象工厂模式）：这给你更多的灵活性。您可以根据某些条件（可能是传递的参数）找到不同类型的创建者。

***请注意，您总是可以通过将两个条件组合在一起来摆脱工厂模式（这会稍微增加代码复杂性和耦合度），我想这就是为什么我们很少看到抽象工厂模式的实际用例。*****

# svn - 如何使用命令行查看更改列表中存在的文件

> ID：1001771
> 
> 赞同：0
> 
> 时间：2009-06-16T14:14:53.193
> 
> 标签：svn

我创建了一个变更列表。我将 2 个文件移到其中。如果我给出 svn status 命令，它将显示更改列表和其中存在的文件。提交后。如果我尝试给出 svn 状态。我没有看到更改列表和其中存在的文件。提交到存储库后是否无法看到其中存在的更改列表和文件？除了 svn status 命令，还有什么命令可以查看我们自己创建的更改列表吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T23:25:28.717

我希望我能理解您的问题：也许您遇到的事实是，默认情况下，当您`svn commit`从文件中删除更改列表分配时。如果要`svn commit`保留更改列表，则必须使用`--keep-changelists`开关。示例：（其中更改列表称为“测试”）

```
svn commit --changelist test --keep-changelists 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:26:15.620

看起来您正在寻找：

```
svn diff --summarize -r0:100 
```

您可能还想看看：

```
svn log 
```

取决于你想要完成什么。

# java - 使用 Maven 管理 DLL 依赖项

> ID：1001774
> 
> 赞同：33
> 
> 时间：2009-06-16T14:15:36.920
> 
> 标签：java, dll, maven-2, java-native-interface

我有一个用 Maven 管理其依赖项的 Java 程序。其中一个依赖项是另一个程序的 JNI 包装器。Maven 负责对相关 JAR 文件的引用，但我自己却在搞乱 DLL 文件。

是否有让 Maven 也处理 DLL 的好方法？理想情况下，我希望将 DLL 像 JAR 文件一样加载到我们的本地存储库中。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-06-19T21:26:50.087

你有没有尝试过这样的事情：

```
<dependency>
    <groupId>com.foo</groupId>
    <artifactId>footron</artifactId>
    <version>4.2</version>
    <scope>runtime</scope>
    <type>dll</type>
</dependency> 
```

您可以使用以下内容将它们添加到 maven 的存储库中：

```
mvn install:install-file -Dfile=footron.dll -DgroupId=com.foo -DartifactId=footron  -Dversion=4.2 -Dpackaging=dll -DgeneratePom=true 
```

还没有为 DLL 做到这一点，但这样的事情应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-22T21:03:24.743

我找到了另一个解决方案，在这个问题的答案中有所描述：[Using maven with DLL fromthirdparty and manage the name of the DLL](https://stackoverflow.com/questions/50421441/using-maven-with-dll-from-third-party-and-managing-the-name-of-the-dll/50426244#50426244)

基本上，如果您将 DLL 放入 ZIP 文件，并将其作为单独的依赖项进行管理，并使用 . `nativedependencies-maven-plugin`，那么 DLL 将以正确的名称解压缩。

# powershell - 如何使用 PowerShell 拆分文本文件？

> ID：1001776
> 
> 赞同：81
> 
> 时间：2009-06-16T14:15:43.987
> 
> 标签：powershell

我需要将一个大的（500 MB）文本文件（一个 log4net 异常文件）拆分成可管理的块，比如 100 个 5 MB 文件就可以了。

我认为这应该是 PowerShell 的公园散步。我该怎么做？

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-06-13T07:34:21.453

关于一些现有答案的警告 - 对于非常大的文件，它们的运行速度会非常慢。对于一个 1.6 GB 的日志文件，我在几个小时后放弃了，意识到在我第二天回去工作之前它不会完成。

两个问题：对[Add-Content](https://technet.microsoft.com/en-us/library/hh849859.aspx)的调用打开、查找然后关闭源文件中每一行的当前目标文件。每次读取一点源文件并寻找新的行也会减慢速度，但我的猜测是 Add-Content 是罪魁祸首。

以下变体产生的输出稍微不那么令人愉快：它会在行中间拆分文件，但它会在不到一分钟的时间内拆分我的 1.6 GB 日志：

```
$from = "C:\temp\large_log.txt"
$rootName = "C:\temp\large_log_chunk"
$ext = "txt"
$upperBound = 100MB

$fromFile = [io.file]::OpenRead($from)
$buff = new-object byte[] $upperBound
$count = $idx = 0
try {
    do {
        "Reading $upperBound"
        $count = $fromFile.Read($buff, 0, $buff.Length)
        if ($count -gt 0) {
            $to = "{0}.{1}.{2}" -f ($rootName, $idx, $ext)
            $toFile = [io.file]::OpenWrite($to)
            try {
                "Writing $count to $to"
                $tofile.Write($buff, 0, $count)
            } finally {
                $tofile.Close()
            }
        }
        $idx ++
    } while ($count -gt 0)
}
finally {
    $fromFile.Close()
} 
```

* * *

## 回答 #2

> 赞同：63
> 
> 时间：2014-04-14T13:22:31.817

根据行数（在本例中为 100）进行拆分的简单单行：

```
$i=0; Get-Content .....log -ReadCount 100 | %{$i++; $_ | Out-File out_$i.txt} 
```

* * *

## 回答 #3

> 赞同：52
> 
> 时间：2009-06-16T17:00:47.880

对于 PowerShell 来说，这有点容易，但由于标准的 Get-Content cmdlet 不能很好地处理非常大的文件这一事实而变得复杂。我建议做的是使用 .NET [StreamReader 类](http://msdn.microsoft.com/en-us/library/system.io.streamreader.aspx)在 PowerShell 脚本中逐行读取文件，并使用`Add-Content`cmdlet 将每一行写入文件名中索引不断增加的文件。像这样的东西：

```
$upperBound = 50MB # calculated by Powershell
$ext = "log"
$rootName = "log_"

$reader = new-object System.IO.StreamReader("C:\Exceptions.log")
$count = 1
$fileName = "{0}{1}.{2}" -f ($rootName, $count, $ext)
while(($line = $reader.ReadLine()) -ne $null)
{
    Add-Content -path $fileName -value $line
    if((Get-ChildItem -path $fileName).Length -ge $upperBound)
    {
        ++$count
        $fileName = "{0}{1}.{2}" -f ($rootName, $count, $ext)
    }
}

$reader.Close() 
```

* * *

## 回答 #4

> 赞同：42
> 
> 时间：2015-02-10T13:13:52.017

与此处的所有答案相同，但使用 StreamReader/StreamWriter 在新行上拆分（逐行，而不是尝试一次将整个文件读入内存）。这种方法可以以我所知道的最快方式拆分大文件。

注意：我做的错误检查很少，所以我不能保证它会在你的情况下顺利运行。它对我来说是这样（*1.7 GB TXT 文件*，400 万行，每个文件*在 95 秒内*分成 100,000 行）。

```
#split test
$sw = new-object System.Diagnostics.Stopwatch
$sw.Start()
$filename = "C:\Users\Vincent\Desktop\test.txt"
$rootName = "C:\Users\Vincent\Desktop\result"
$ext = ".txt"

$linesperFile = 100000#100k
$filecount = 1
$reader = $null
try{
    $reader = [io.file]::OpenText($filename)
    try{
        "Creating file number $filecount"
        $writer = [io.file]::CreateText("{0}{1}.{2}" -f ($rootName,$filecount.ToString("000"),$ext))
        $filecount++
        $linecount = 0

        while($reader.EndOfStream -ne $true) {
            "Reading $linesperFile"
            while( ($linecount -lt $linesperFile) -and ($reader.EndOfStream -ne $true)){
                $writer.WriteLine($reader.ReadLine());
                $linecount++
            }

            if($reader.EndOfStream -ne $true) {
                "Closing file"
                $writer.Dispose();

                "Creating file number $filecount"
                $writer = [io.file]::CreateText("{0}{1}.{2}" -f ($rootName,$filecount.ToString("000"),$ext))
                $filecount++
                $linecount = 0
            }
        }
    } finally {
        $writer.Dispose();
    }
} finally {
    $reader.Dispose();
}
$sw.Stop()

Write-Host "Split complete in " $sw.Elapsed.TotalSeconds "seconds" 
```

输出拆分 1.7 GB 文件：

```
...
Creating file number 45
Reading 100000
Closing file
Creating file number 46
Reading 100000
Closing file
Creating file number 47
Reading 100000
Closing file
Creating file number 48
Reading 100000
Split complete in  95.6308289 seconds 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2009-06-16T20:47:23.870

我经常需要做同样的事情。诀窍是将标头重复到每个拆分块中。我编写了以下 cmdlet (PowerShell v2 CTP 3)，它成功了。

```
##############################################################################
#.SYNOPSIS
# Breaks a text file into multiple text files in a destination, where each
# file contains a maximum number of lines.
#
#.DESCRIPTION
# When working with files that have a header, it is often desirable to have
# the header information repeated in all of the split files. Split-File
# supports this functionality with the -rc (RepeatCount) parameter.
#
#.PARAMETER Path
# Specifies the path to an item. Wildcards are permitted.
#
#.PARAMETER LiteralPath
# Specifies the path to an item. Unlike Path, the value of LiteralPath is
# used exactly as it is typed. No characters are interpreted as wildcards.
# If the path includes escape characters, enclose it in single quotation marks.
# Single quotation marks tell Windows PowerShell not to interpret any
# characters as escape sequences.
#
#.PARAMETER Destination
# (Or -d) The location in which to place the chunked output files.
#
#.PARAMETER Count
# (Or -c) The maximum number of lines in each file.
#
#.PARAMETER RepeatCount
# (Or -rc) Specifies the number of "header" lines from the input file that will
# be repeated in each output file. Typically this is 0 or 1 but it can be any
# number of lines.
#
#.EXAMPLE
# Split-File bigfile.csv 3000 -rc 1
#
#.LINK 
# Out-TempFile
##############################################################################
function Split-File {

    [CmdletBinding(DefaultParameterSetName='Path')]
    param(

        [Parameter(ParameterSetName='Path', Position=1, Mandatory=$true, ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true)]
        [String[]]$Path,

        [Alias("PSPath")]
        [Parameter(ParameterSetName='LiteralPath', Mandatory=$true, ValueFromPipelineByPropertyName=$true)]
        [String[]]$LiteralPath,

        [Alias('c')]
        [Parameter(Position=2,Mandatory=$true)]
        [Int32]$Count,

        [Alias('d')]
        [Parameter(Position=3)]
        [String]$Destination='.',

        [Alias('rc')]
        [Parameter()]
        [Int32]$RepeatCount

    )

    process {

        # yeah! the cmdlet supports wildcards
        if ($LiteralPath) { $ResolveArgs = @{LiteralPath=$LiteralPath} }
        elseif ($Path) { $ResolveArgs = @{Path=$Path} }

        Resolve-Path @ResolveArgs | %{

            $InputName = [IO.Path]::GetFileNameWithoutExtension($_)
            $InputExt  = [IO.Path]::GetExtension($_)

            if ($RepeatCount) { $Header = Get-Content $_ -TotalCount:$RepeatCount }

            # get the input file in manageable chunks

            $Part = 1
            Get-Content $_ -ReadCount:$Count | %{

                # make an output filename with a suffix
                $OutputFile = Join-Path $Destination ('{0}-{1:0000}{2}' -f ($InputName,$Part,$InputExt))

                # In the first iteration the header will be
                # copied to the output file as usual
                # on subsequent iterations we have to do it
                if ($RepeatCount -and $Part -gt 1) {
                    Set-Content $OutputFile $Header
                }

                # write this chunk to the output file
                Write-Host "Writing $OutputFile"
                Add-Content $OutputFile $_

                $Part += 1

            }

        }

    }

} 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2010-04-15T14:26:07.157

我在尝试将单个 vCard VCF 文件中的多个联系人拆分为单独的文件时发现了这个问题。这是我根据 Lee 的代码所做的。我不得不查找如何创建一个新的 StreamReader 对象并将 null 更改为 $null。

```
$reader = new-object System.IO.StreamReader("C:\Contacts.vcf")
$count = 1
$filename = "C:\Contacts\{0}.vcf" -f ($count) 

while(($line = $reader.ReadLine()) -ne $null)
{
    Add-Content -path $fileName -value $line

    if($line -eq "END:VCARD")
    {
        ++$count
        $filename = "C:\Contacts\{0}.vcf" -f ($count)
    }
}

$reader.Close() 
```

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2014-12-08T17:44:47.700

其中许多答案对于我的源文件来说太慢了。我的源文件是 10 MB 到 800 MB 之间的 SQL 文件，需要拆分成行数大致相等的文件。

我发现以前使用 Add-Content 的一些答案非常慢。等待几个小时才能完成拆分并不少见。

我没有尝试[Typhlosaurus 的答案](https://stackoverflow.com/a/11010158/209)，但它看起来只按文件大小而不是行数进行拆分。

以下符合我的目的。

```
$sw = new-object System.Diagnostics.Stopwatch
$sw.Start()
Write-Host "Reading source file..."
$lines = [System.IO.File]::ReadAllLines("C:\Temp\SplitTest\source.sql")
$totalLines = $lines.Length

Write-Host "Total Lines :" $totalLines

$skip = 0
$count = 100000; # Number of lines per file

# File counter, with sort friendly name
$fileNumber = 1
$fileNumberString = $filenumber.ToString("000")

while ($skip -le $totalLines) {
    $upper = $skip + $count - 1
    if ($upper -gt ($lines.Length - 1)) {
        $upper = $lines.Length - 1
    }

    # Write the lines
    [System.IO.File]::WriteAllLines("C:\Temp\SplitTest\result$fileNumberString.txt",$lines[($skip..$upper)])

    # Increment counters
    $skip += $count
    $fileNumber++
    $fileNumberString = $filenumber.ToString("000")
}

$sw.Stop()

Write-Host "Split complete in " $sw.Elapsed.TotalSeconds "seconds" 
```

对于 54 MB 文件，我得到输出...

```
Reading source file...
Total Lines : 910030
Split complete in  1.7056578 seconds 
```

我希望其他寻找符合我要求的简单、基于行的拆分脚本的人会发现这很有用。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-02-18T02:53:26.410

还有这个快速（而且有点脏）的单线：

```
$linecount=0; $i=0; Get-Content .\BIG_LOG_FILE.txt | %{ Add-Content OUT$i.log "$_"; $linecount++; if ($linecount -eq 3000) {$I++; $linecount=0 } } 
```

您可以通过更改硬编码的 3000 值来调整每批的第一行数。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-08-02T14:49:16.513

做这个：

文件 1

还有这个快速（而且有点脏）的单线：

```
 $linecount=0; $i=0; 
    Get-Content .\BIG_LOG_FILE.txt | %
    { 
      Add-Content OUT$i.log "$_"; 
      $linecount++; 
      if ($linecount -eq 3000) {$I++; $linecount=0 } 
    } 
```

您可以通过更改硬编码的 3000 值来调整每批的第一行数。

```
Get-Content C:\TEMP\DATA\split\splitme.txt | Select -First 5000 | out-File C:\temp\file1.txt -Encoding ASCII 
```

文件 2

```
Get-Content C:\TEMP\DATA\split\splitme.txt | Select -Skip 5000 | Select -First 5000 | out-File C:\temp\file2.txt -Encoding ASCII 
```

文件 3

```
Get-Content C:\TEMP\DATA\split\splitme.txt | Select -Skip 10000 | Select -First 5000 | out-File C:\temp\file3.txt -Encoding ASCII 
```

等等……</p>

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-10-01T17:22:42.463

我对根据每个部分的大小拆分文件进行了一些修改。

```
##############################################################################
#.SYNOPSIS
# Breaks a text file into multiple text files in a destination, where each
# file contains a maximum number of lines.
#
#.DESCRIPTION
# When working with files that have a header, it is often desirable to have
# the header information repeated in all of the split files. Split-File
# supports this functionality with the -rc (RepeatCount) parameter.
#
#.PARAMETER Path
# Specifies the path to an item. Wildcards are permitted.
#
#.PARAMETER LiteralPath
# Specifies the path to an item. Unlike Path, the value of LiteralPath is
# used exactly as it is typed. No characters are interpreted as wildcards.
# If the path includes escape characters, enclose it in single quotation marks.
# Single quotation marks tell Windows PowerShell not to interpret any
# characters as escape sequences.
#
#.PARAMETER Destination
# (Or -d) The location in which to place the chunked output files.
#
#.PARAMETER Size
# (Or -s) The maximum size of each file. Size must be expressed in MB.
#
#.PARAMETER RepeatCount
# (Or -rc) Specifies the number of "header" lines from the input file that will
# be repeated in each output file. Typically this is 0 or 1 but it can be any
# number of lines.
#
#.EXAMPLE
# Split-File bigfile.csv -s 20 -rc 1
#
#.LINK 
# Out-TempFile
##############################################################################
function Split-File {

    [CmdletBinding(DefaultParameterSetName='Path')]
    param(

        [Parameter(ParameterSetName='Path', Position=1, Mandatory=$true, ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true)]
        [String[]]$Path,

        [Alias("PSPath")]
        [Parameter(ParameterSetName='LiteralPath', Mandatory=$true, ValueFromPipelineByPropertyName=$true)]
        [String[]]$LiteralPath,

        [Alias('s')]
        [Parameter(Position=2,Mandatory=$true)]
        [Int32]$Size,

        [Alias('d')]
        [Parameter(Position=3)]
        [String]$Destination='.',

        [Alias('rc')]
        [Parameter()]
        [Int32]$RepeatCount

    )

    process {

  # yeah! the cmdlet supports wildcards
        if ($LiteralPath) { $ResolveArgs = @{LiteralPath=$LiteralPath} }
        elseif ($Path) { $ResolveArgs = @{Path=$Path} }

        Resolve-Path @ResolveArgs | %{

            $InputName = [IO.Path]::GetFileNameWithoutExtension($_)
            $InputExt  = [IO.Path]::GetExtension($_)

            if ($RepeatCount) { $Header = Get-Content $_ -TotalCount:$RepeatCount }

   Resolve-Path @ResolveArgs | %{

    $InputName = [IO.Path]::GetFileNameWithoutExtension($_)
    $InputExt  = [IO.Path]::GetExtension($_)

    if ($RepeatCount) { $Header = Get-Content $_ -TotalCount:$RepeatCount }

    # get the input file in manageable chunks

    $Part = 1
    $buffer = ""
    Get-Content $_ -ReadCount:1 | %{

     # make an output filename with a suffix
     $OutputFile = Join-Path $Destination ('{0}-{1:0000}{2}' -f ($InputName,$Part,$InputExt))

     # In the first iteration the header will be
     # copied to the output file as usual
     # on subsequent iterations we have to do it
     if ($RepeatCount -and $Part -gt 1) {
      Set-Content $OutputFile $Header
     }

     # test buffer size and dump data only if buffer is greater than size
     if ($buffer.length -gt ($Size * 1MB)) {
      # write this chunk to the output file
      Write-Host "Writing $OutputFile"
      Add-Content $OutputFile $buffer
      $Part += 1
      $buffer = ""
     } else {
      $buffer += $_ + "`r"
     }
    }
   }
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-09-21T18:11:33.273

听起来像是 UNIX 命令拆分的工作：

```
split MyBigFile.csv 
```

只需在不到 10 分钟的时间内将我的 55 GB csv 文件拆分为 21k 块。

虽然它不是 PowerShell 原生的，但它附带了例如 git for windows 包[https://git-scm.com/download/win](https://git-scm.com/download/win)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-09-23T14:17:20.333

由于日志中的行可以是可变的，我认为最好在每个文件方法中采用多行。以下代码片段在 19 秒（18.83.. 秒）内处理了 400 万行日志文件，将其拆分为 500,000 行块：

```
$sourceFile = "c:\myfolder\mylargeTextyFile.csv"
$partNumber = 1
$batchSize = 500000
$pathAndFilename = "c:\myfolder\mylargeTextyFile part $partNumber file.csv"

[System.Text.Encoding]$enc = [System.Text.Encoding]::GetEncoding(65001)  # utf8 this one

$fs=New-Object System.IO.FileStream ($sourceFile,"OpenOrCreate", "Read", "ReadWrite",8,"None") 
$streamIn=New-Object System.IO.StreamReader($fs, $enc)
$streamout = new-object System.IO.StreamWriter $pathAndFilename

$line = $streamIn.readline()
$counter = 0
while ($line -ne $null)
{
    $streamout.writeline($line)
    $counter +=1
    if ($counter -eq $batchsize)
    {
        $partNumber+=1
        $counter =0
        $streamOut.close()
        $pathAndFilename = "c:\myfolder\mylargeTextyFile part $partNumber file.csv"
        $streamout = new-object System.IO.StreamWriter $pathAndFilename

    }
    $line = $streamIn.readline()
}
$streamin.close()
$streamout.close() 
```

这可以很容易地转换为带有参数的函数或脚本文件，以使其更加通用。它使用`StreamReader`and`StreamWriter`来实现它的速度和极小的内存占用

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-10-27T18:20:37.420

我的要求有点不同。我经常使用逗号分隔和制表符分隔的 ASCII 文件，其中单行是单条数据记录。而且它们真的很大，所以我需要将它们分成可管理的部分（同时保留标题行）。

因此，我恢复了我的经典 VBScript 方法，并拼凑了一个可以在任何 Windows 计算机上运行的小型 .vbs 脚本（它由 Window 上的 WScript.exe 脚本主机引擎自动执行）。

这种方法的好处是它使用文本流，因此底层数据不会加载到内存中（或者至少不是一次全部加载）。结果是它非常快，并且运行起来并不需要太多内存。我刚刚在 i7 上使用此脚本拆分的测试文件的文件大小约为 1 GB，大约有 1200 万行文本，并被拆分为 25 个部分文件（每个部分文件大约有 50 万行）——处理大约需要 2 分钟它在任何时候都没有超过 3 MB 的内存使用。

这里需要注意的是，它依赖于具有“行”的文本文件（意味着每个记录都用 CRLF 分隔），因为文本流对象使用“ReadLine”函数一次处理一行。但是，嘿，如果您使用的是 TSV 或 CSV 文件，那就完美了。

```
Option Explicit

Private Const INPUT_TEXT_FILE = "c:\bigtextfile.txt"  
Private Const REPEAT_HEADER_ROW = True                
Private Const LINES_PER_PART = 500000                 

Dim oFileSystem, oInputFile, oOutputFile, iOutputFile, iLineCounter, sHeaderLine, sLine, sFileExt, sStart

sStart = Now()

sFileExt = Right(INPUT_TEXT_FILE,Len(INPUT_TEXT_FILE)-InstrRev(INPUT_TEXT_FILE,".")+1)
iLineCounter = 0
iOutputFile = 1

Set oFileSystem = CreateObject("Scripting.FileSystemObject")
Set oInputFile = oFileSystem.OpenTextFile(INPUT_TEXT_FILE, 1, False)
Set oOutputFile = oFileSystem.OpenTextFile(Replace(INPUT_TEXT_FILE, sFileExt, "_" & iOutputFile & sFileExt), 2, True)

If REPEAT_HEADER_ROW Then
    iLineCounter = 1
    sHeaderLine = oInputFile.ReadLine()
    Call oOutputFile.WriteLine(sHeaderLine)
End If

Do While Not oInputFile.AtEndOfStream
    sLine = oInputFile.ReadLine()
    Call oOutputFile.WriteLine(sLine)
    iLineCounter = iLineCounter + 1
    If iLineCounter Mod LINES_PER_PART = 0 Then
        iOutputFile = iOutputFile + 1
        Call oOutputFile.Close()
        Set oOutputFile = oFileSystem.OpenTextFile(Replace(INPUT_TEXT_FILE, sFileExt, "_" & iOutputFile & sFileExt), 2, True)
        If REPEAT_HEADER_ROW Then
            Call oOutputFile.WriteLine(sHeaderLine)
        End If
    End If
Loop

Call oInputFile.Close()
Call oOutputFile.Close()
Set oFileSystem = Nothing

Call MsgBox("Done" & vbCrLf & "Lines Processed:" & iLineCounter & vbCrLf & "Part Files: " & iOutputFile & vbCrLf & "Start Time: " & sStart & vbCrLf & "Finish Time: " & Now()) 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2017-11-09T23:11:28.510

这是我将名为 patch6.txt 的文件（大约 32,000 行）拆分为每个 1000 行的单独文件的解决方案。它并不快，但它可以完成工作。

```
$infile = "D:\Malcolm\Test\patch6.txt"
$path = "D:\Malcolm\Test\"
$lineCount = 1
$fileCount = 1

foreach ($computername in get-content $infile)
{
    write $computername | out-file -Append $path_$fileCount".txt"
    $lineCount++

    if ($lineCount -eq 1000)
    {
        $fileCount++
        $lineCount = 1
    }
} 
```

# python - 如何在 Python 中将变量放在堆栈/上下文中

> ID：1001784
> 
> 赞同：3
> 
> 时间：2009-06-16T14:16:30.790
> 
> 标签：python, thread-local, contextmanager

本质上，我想在堆栈上放置一个变量，堆栈上该部分下方的所有调用都可以访问该变量，直到块退出。在Java中，我会使用支持方法的本地静态线程来解决这个问题，然后可以从方法中访问它。

典型例子：你得到一个请求，并打开一个数据库连接。在请求完成之前，您希望所有代码都使用此数据库连接。完成并关闭请求后，关闭数据库连接。

我需要这个，是一个报告生成器。每个报告由多个部分组成，每个部分可以依赖于不同的计算，有时不同的部分部分依赖于相同的计算。因为我不想重复繁重的计算，所以我需要缓存它们。我的想法是用缓存装饰器来装饰方法。缓存根据方法名称和模块创建一个 id，它是参数，查看它是否已经在堆栈变量中计算了这个，如果没有，则执行该方法。

我将通过展示我当前的实现来尝试和清除。我想做的是简化那些实现计算的代码。

首先，我有中央缓存访问对象，我称之为 MathContext：

```
class MathContext(object):
    def __init__(self, fn): 
        self.fn = fn
        self.cache = dict()
    def get(self, calc_config):
        id = create_id(calc_config)
        if id not in self.cache:
            self.cache[id] = calc_config.exec(self)
        return self.cache[id] 
```

fn 参数是创建上下文相关的文件名，可以从中读取数据以进行计算。

然后我们有 Calculation 类：

```
 class CalcBase(object):
     def exec(self, math_context):
         raise NotImplementedError 
```

这是一个愚蠢的斐波那契示例。这些方法实际上都不是递归的，它们适用于大量数据，但它可以证明您将如何依赖其他计算：

```
class Fibonacci(CalcBase):
    def __init__(self, n): self.n = n
    def exec(self, math_context):
        if self.n < 2: return 1
        a = math_context.get(Fibonacci(self.n-1))
        b = math_context.get(Fibonacci(self.n-2))
        return a+b 
```

相反，我希望斐波那契只是一种装饰方法：

```
@cache
def fib(n):
    if n<2: return 1
    return fib(n-1)+fib(n-2) 
```

在 math_context 示例中，当 math_context 超出范围时，它的所有缓存值也会如此。我想要装饰师也一样。IE。在 X 点，@cache 缓存的所有内容都被取消引用为 gced。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T18:43:15.380

我继续做了一些可能只是做你想做的事情。它既可以用作装饰器，也可以用作上下文管理器：

```
from __future__ import with_statement
try:
    import cPickle as pickle
except ImportError:
    import pickle

class cached(object):
    """Decorator/context manager for caching function call results.
    All results are cached in one dictionary that is shared by all cached
    functions.

    To use this as a decorator:
        @cached
        def function(...):
            ...

    The results returned by a decorated function are not cleared from the
    cache until decorated_function.clear_my_cache() or cached.clear_cache()
    is called

    To use this as a context manager:

        with cached(function) as function:
            ...
            function(...)
            ...

    The function's return values will be cleared from the cache when the
    with block ends

    To clear all cached results, call the cached.clear_cache() class method
    """

    _CACHE = {}

    def __init__(self, fn):
        self._fn = fn

    def __call__(self, *args, **kwds):
        key = self._cache_key(*args, **kwds)
        function_cache = self._CACHE.setdefault(self._fn, {})
        try:
            return function_cache[key]
        except KeyError:
            function_cache[key] = result = self._fn(*args, **kwds)
            return result

    def clear_my_cache(self):
        """Clear the cache for a decorated function
        """
        try:
            del self._CACHE[self._fn]
        except KeyError:
            pass # no cached results

    def __enter__(self):
        return self

    def __exit__(self, type, value, traceback):
        self.clear_my_cache()

    def _cache_key(self, *args, **kwds):
        """Create a cache key for the given positional and keyword
        arguments. pickle.dumps() is used because there could be
        unhashable objects in the arguments, but passing them to 
        pickle.dumps() will result in a string, which is always hashable.

        I used this to make the cached class as generic as possible. Depending
        on your requirements, other key generating techniques may be more
        efficient
        """
        return pickle.dumps((args, sorted(kwds.items())), pickle.HIGHEST_PROTOCOL)

    @classmethod
    def clear_cache(cls):
        """Clear everything from all functions from the cache
        """
        cls._CACHE = {}

if __name__ == '__main__':
    # used as decorator
    @cached
    def fibonacci(n):
        print "calculating fibonacci(%d)" % n
        if n == 0:
            return 0
        if n == 1:
            return 1
        return fibonacci(n - 1) + fibonacci(n - 2)

    for n in xrange(10):
        print 'fibonacci(%d) = %d' % (n, fibonacci(n))

    def lucas(n):
        print "calculating lucas(%d)" % n
        if n == 0:
            return 2
        if n == 1:
            return 1
        return lucas(n - 1) + lucas(n - 2)

    # used as context manager
    with cached(lucas) as lucas:
        for i in xrange(10):
            print 'lucas(%d) = %d' % (i, lucas(i))

    for n in xrange(9, -1, -1):
        print 'fibonacci(%d) = %d' % (n, fibonacci(n))

    cached.clear_cache()

    for n in xrange(9, -1, -1):
        print 'fibonacci(%d) = %d' % (n, fibonacci(n)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T14:35:58.643

这个问题似乎是两个问题

*   a) 共享数据库连接
*   b) 缓存/记忆

b) 你已经回答了自己

a）我似乎不明白为什么你需要把它放在堆栈上？你可以做其中之一

1.  你可以使用一个类，连接可以是它的属性
2.  您可以装饰您的所有功能，以便它们从中心位置获得连接
3.  每个函数都可以显式使用全局连接方法
4.  你可以创建一个连接并传递它，或者创建一个上下文对象并传递上下文，连接可以是上下文的一部分

等等等等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:27:36.803

您可以使用包装在 getter 函数中的全局变量：

```
def getConnection():
    global connection
    if connection:
        return connection
    connection=createConnection()
    return connection 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T14:40:44.843

**“你收到一个请求，然后打开一个数据库连接......你关闭了数据库连接。”**

这就是对象的用途。创建连接对象，将其传递给其他对象，然后在完成后将其关闭。全局变量不合适。只需将值作为参数传递给正在执行工作的其他对象。

**“每个报告由多个部分组成，每个部分可以依赖于不同的计算，有时不同的部分部分依赖于相同的计算......我需要缓存它们”**

这就是对象的用途。创建一个包含有用计算结果的字典，并将其从报告部分传递到报告部分。

你不需要弄乱“堆栈变量”、“静态线程本地”或类似的东西。只需将普通变量参数传递给普通方法函数。你会快乐很多。

* * *

```
class MemoizedCalculation( object ):
    pass

class Fibonacci( MemoizedCalculation ):
    def __init__( self ):
       self.cache= { 0: 1, 1: 1 }
    def __call__( self, arg ):
       if arg not in self.cache:
           self.cache[arg]= self(arg-1) + self(arg-2)
       return self.cache[arg]

class MathContext( object ):
    def __init__( self ):
        self.fibonacci = Fibonacci() 
```

你可以像这样使用它

```
>>> mc= MathContext()
>>> mc.fibonacci( 4 )
5 
```

您可以定义任意数量的计算并将它们全部折叠到一个容器对象中。

如果需要，可以将 MathContext 制作成正式的上下文管理器，以便它与**with**语句一起使用。将这两个方法添加到 MathContext。

```
def __enter__( self ):
    print "Initialize"
    return self
def __exit__( self, type_, value, traceback ):
    print "Release" 
```

然后你可以这样做。

```
with  MathContext() as mc:
    print mc.fibonacci( 4 ) 
```

在**with**语句的末尾，您可以保证该`__exit__`方法已被调用。

# ruby-on-rails - Rails ActiveRecord::find Join 语句问题

> ID：1001789
> 
> 赞同：3
> 
> 时间：2009-06-16T14:16:51.567
> 
> 标签：ruby-on-rails, activerecord, join

为什么下面的rails语句

```
User.find(:all, :joins => [:roles,:roles_users], 
          :conditions => { :roles => { :name => 'subscriber', 
                                       :authorizable_id => self.id, 
                                       :authorizable_type => self.class.to_s }}) 
```

翻译成这个（使用 2x 相同的连接）

```
SELECT "users".* FROM "users" 
    JOIN "roles_users" ON ("users"."id" = "roles_users"."user_id") 
    JOIN "roles" ON ("roles"."id" = "roles_users"."role_id") 
    JOIN "roles_users" roles_users_users ON roles_users_users.user_id = users.id 
  WHERE ("roles"."authorizable_id" = 4 AND "roles"."name" = 'subscriber' AND "roles"."authorizable_type" = 'Howto') 
```

只是好奇。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-18T00:49:08.273

我不需要加入roles_users，因为插件已经这样做了一次......

谢谢你的帮助。

```
has_many :users, :finder_sql => 'SELECT DISTINCT users.* FROM users INNER JOIN roles_users ON user_id = users.id INNER JOIN roles ON roles.id = role_id WHERE authorizable_type = \'#{self.class.base_class.to_s}\' AND authorizable_id = #{id}', :counter_sql => 'SELECT COUNT(DISTINCT users.id) FROM users INNER JOIN roles_users ON user_id = users.id INNER JOIN roles ON roles.id = role_id WHERE authorizable_type = \'#{self.class.base_class.to_s}\' AND authorizable_id = #{id}', :readonly => true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:08:38.280

我没有看到重复的连接，我看到 rails 尝试使用命名约定来连接 roles_users 和 users 导致 rails 寻找 roles_users_users 表。

因为您的模型中有用户和角色之间的关系，所以您不必指定加入角色用户

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T15:21:34.113

我不知道为什么它会产生那么多的 SQL 代码。需要从您的模型中查看更多代码。像这样的东西可能会减少代码/复杂性并产生优化的 SQL 代码：

```
class Server < ActiveRecord::Base
  has_and_belongs_to_many :roles, :join_table => :roles_users
end

User.all(:include => :roles, :conditions => {:roles => { :names => 'subscriber', :authorizable_id => self.id, :authorizable_type => self.class.to_s }}) 
```

# silverlight - 在使用数据绑定实现 MVVM 模式时，Silverlight 应用程序的性能是否会受到影响？

> ID：1001801
> 
> 赞同：2
> 
> 时间：2009-06-16T14:18:18.180
> 
> 标签：silverlight, performance, data-binding, mvvm

我正在使用 INotifyPropertyChanged 接口和 TwoWay 数据绑定以我的 SL2 应用程序的一种形式实现模型-视图-视图模型 (MVVM) 模式。

但是我觉得由于这种方法，我的表单表现得有些迟钝。

我只是想知道使用这种方法是否会对此类 SL2 应用程序造成任何性能影响。

谢谢...苏迪普

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:27:04.827

我没有注意到任何放缓。我们正在对 INotifyPropertyChanged ViewModels 进行大量绑定，并且 UI 似乎响应非常快。

当然，数据绑定与直接数据访问相比会受到打击……但这种打击是如此之小，以至于您从数据绑定中获得的好处使得小打击变得无关紧要。

需要记住的一点：数据绑定发生在 UI 中。在该层没有发生很多高强度处理。此外，UI 在单独的线程上呈现。在我看来，这两件事共同构成了一种非常敏感的体验。

Erik 问你是否有任何价值转换器？我会问同样的事情。如果是这样，他们是否做了很多工作？根据我使用 MVVM 的经验，很少需要值转换器。只是一些思考的食物。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:20:37.243

我没有注意到任何减速。Prism 参考实现，除其他外，似乎很快。

事实上，绑定系统使用依赖属性。就像动画系统一样。部分原因是框架可以快速更新值。

你有任何价值转换器吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T16:00:27.610

我们用 Prism 做了很多 MVVM，但没有注意到性能下降。恰恰相反 - 该应用程序的演示速度通常比它的低技术 Windows 对应物更快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T08:48:49.617

还要检查哪些地方需要两种方式绑定，而另一种方式只需一次绑定。

# ajax - 如何在播放时播放声音 已更新

> ID：1001804
> 
> 赞同：0
> 
> 时间：2009-06-16T14:18:27.227
> 
> 标签：ajax, audio

我正在编写一个简单的聊天模块，它将嵌入到一个网站中。它将允许网站访问者与网站所有者聊天。

该网站是 ruby​​/rails，我正在使用 AJAX。

我不知道该怎么做的一件事是如何在新消息到达时播放“金光闪闪”的声音（别担心，这个声音是可切换的，默认为“关闭”。）

我希望在消息到达时播放“bling”...即，当保存消息列表的**div**由服务器通过 Ajax 更新时。

我在想我需要一个 Event.observe('myDiv', someEvent, callback) 函数，但我不知道应该为'someEvent'使用什么......

任何帮助，非常感谢。

- 约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-16T14:33:41.893

您是否尝试过“加载”或“更改”？对于侦听器，事件必须是此处描述的某种类型[http://www.w3.org/TR/DOM-Level-2-Events/events.html](http://www.w3.org/TR/DOM-Level-2-Events/events.html)

另一种选择是将声音附加到填充 div 的 AJAX 回调函数。

希望有帮助，乔希

# .net - .NET Web 服务——新方法未出现

> ID：1001807
> 
> 赞同：3
> 
> 时间：2009-06-16T14:19:14.700
> 
> 标签：.net, web-services

构建一个测试网络服务，一切都很好，所以我添加了我的其余方法，现在它们没有出现在“在浏览器中查看”测试页面中。

我停止了系统托盘中的服务。做了一个清洁。重建。建立。这些都试了好几次。

奇怪的是，我的一种新方法取代了一种旧方法（HelloWorld 默认），但其余 10 到 15 种方法都不存在。

对此有什么想法吗？

编辑：这是我所拥有的样本......

```
 [WebMethod]
    public DataSet GetSiteMap()
    {
        return Photo_DA.GetSitemap();
    }

    [WebMethod]
    public DataSet GetByTypeDate(string photoType, DateTime photoDate)
    {
        return Photo_DA.GetByTypeDate(photoType, photoDate);
    }

    [WebMethod]
    public static DataSet GetArchiveCombos()
    {
        return Photo_DA.GetArchiveCombos();
    } 
```

前两个节目。第三个没有。

哦！STATIC 是坏人——我不能删除这条消息，所以我想管理员可以。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-16T14:26:00.457

真的应该`GetArchiveCombos()`是静态的吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T14:20:43.480

您是否忘记将属性 [WebMethod] 应用于您的新方法？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T14:25:17.293

您是否更新了网络参考？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T14:24:22.833

您是否有任何需要在 web.config 文件中配置的新端点？

# iphone - 向窗口添加新视图/更改视图

> ID：1001809
> 
> 赞同：0
> 
> 时间：2009-06-16T14:19:48.160
> 
> 标签：iphone, objective-c, cocoa-touch

上周我在这里问了一个问题，我试图效仿但没有太多快乐，

所以我正在尝试创建一个具有主窗口的应用程序。在这个窗口中，我希望能够显示 3 或 4 个不同的视图（不是同时），用户可以通过按下按钮来选择视图。如果可能的话，我不想使用导航栏。

我认为我需要

View1 .h &.m View1controller .h &.m 和第二个一样

现在，如果选择视图 2 的按钮在视图 1 上，

如何更改视图以及将此代码放在哪里？我是否需要一个根控制器，或者我是否对做同样事情的其他方式感到困惑。

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T14:30:48.653

如果您想在 iPod 应用程序中的视图之间进行更改，您可以使用 UITabBarController 完成此操作。您将创建所有视图控制器，然后将其添加到根 tabbarcontroller。然后，当按钮被选中时，tabbarcontroller 会自动为您切换视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T14:41:00.257

如果您有一个带有按钮的视图，并且想要更改活动视图，您可以从活动视图的 UIViewController 使用此方法：

```
- (void)presentModalViewController:(UIViewController *)modalViewController animated:(BOOL)animated; 
```

# .net - 我应该将敏感数据传递给 .NET 中的 Process.Start 调用吗？

> ID：1001810
> 
> 赞同：4
> 
> 时间：2009-06-16T14:19:48.550
> 
> 标签：.net, windows, security, command-line

我正在开发一个 .NET Windows 应用程序，它将使用 Process.Start 来启动另一个在同一台 PC 上运行的内部开发的 .NET 应用程序。我需要将数据库连接信息（包括用户 ID 和密码）传递给目标应用程序。我正在尝试确定是否需要在发送信息之前对其进行加密。

假设最终用户的 PC 没有受到损害，如果我在参数中未加密地传递连接信息，连接信息是否会暴露在任何地方？

这样的事情可以吗...

```
string myExecutable = "myApp.exe";
string server = "myServer";
string database = "top_secret_data";
string userID = "myUser";
string password = "ABC123";
string dbInfo = string.Format("server={0} database={1} userID={2} password={3}", server, database, userID, password);
ProcessStartInfo startInfo = new ProcessStartInfo(myExecutable, dbInfo);
Process.Start(startInfo); 
```

或者我应该使用这样的东西......

```
var crypto = new MySymmetricCryptoLib.Crypto();
string myExecutable = "myApp.exe";
string server = crypto.Encrypt("myServer");
string database = crypto.Encrypt("top_secret_data");
string userID = crypto.Encrypt("myUser");
string password = crypto.Encrypt("ABC123");
string dbInfo = string.Format("server={0} database={1} userID={2} password={3}", server, database, userID, password);
ProcessStartInfo startInfo = new ProcessStartInfo(myExecutable, dbInfo);
Process.Start(startInfo); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T14:23:50.260

检索调用进程的参数非常容易，因此它们将在本地公开给具有技术头脑的用户。如果这对您来说不是问题，那么我不会担心，因为您说您没有通过网络传输，并且您的问题要求我们假设机器没有受到损害。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T14:26:36.087

您的问题尚不清楚您要保护谁的数据。这很令人困惑，因为您说“假设 PC 没有受到损害”。

如果您在机器上启动本地进程并且机器没有受到损害，那么有什么可以保护的？在这种情况下，没有任何东西会遍历网络，因此没有人可以窥探这些论点。

但是，如果您担心可能对计算机具有管理访问权限的任何人或可能看到数据的用户，那么是的，您必须对其进行加密。查看进程的命令行参数相当容易。任何半熟练的用户都可以找到它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T14:30:51.150

我会加密整个字符串而不是单独的部分，你基本上已经告诉一个淘气的用户，嘿，这里的连接信息只是继续并打破它。另一种选择是在其他应用程序启动后传递参数。

当您构建安全措施以识别攻击是什么（获得对数据库连接信息的访问权限）以及谁将发起攻击时，这一点很重要。您是否试图阻止本地用户获取此信息？您是要阻止普通用户还是专家用户？

例如，专家可以继续转储进程的内存，并找到他未加密的字符串。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-17T16:30:39.093

使用命名管道并在其上适当地设置 ACL，然后让子进程继承句柄 - 不用担心加密。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T14:27:03.717

由于您必须修改接收应用程序才能进行解密，为什么不修改接收应用程序以从配置文件中读取，然后[加密配置文件](http://www.codeproject.com/KB/cs/Configuration_File.aspx)。如果您需要将不同的值传递给其他应用程序，为什么不传递一个 connectionString 键？

# indexing - 如何识别文件夹中是否存在 Lucene.Net 索引？

> ID：1001825
> 
> 赞同：21
> 
> 时间：2009-06-16T14:23:10.447
> 
> 标签：indexing, full-text-search, lucene.net, search, full-text-indexing

我正在使用 Lucene.Net 来索引和搜索文档，并且我正在使用以下代码来创建或打开索引（如果存在）：

```
IndexWriter writer = new IndexWriter(@"C:\index", new StandardAnalyzer(), !IndexExists);

...

private bool IndexExists
{
    get
    {
        return ??
    }
} 
```

现在，如何`IndexExists`以简单的方式实现？我不需要抛出任何异常。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-06-16T14:38:03.710

静态方法 IndexReader.IndexExists(string path) （或其重载之一）似乎非常合适。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-04T11:15:29.937

在 < 4.0 是`IndexReader.indexExists(org.apache.lucene.store.Directory)`

在 > 4.0 是`DirectoryReader.indexExists(org.apache.lucene.store.Directory)`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-17T15:31:02.613

您可以只使用不带布尔参数的构造函数。如果那里有一个现有索引，那将打开一个现有索引，如果不存在则创建一个新索引。

Java 文档链接（与 Lucene.Net 相同）：`http://lucene.apache.org/java/2_3_1/api/org/apache/lucene/index/IndexWriter.html#IndexWriter(org.apache.lucene.store.Directory, org.apache.lucene.analysis.Analyzer)`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-07-06T14:26:50.193

我也尝试找到这个anwser但没有成功，这是我在代码中使用的方式：

私有 bool IndexExists { get { return IndexDirectory.FileExists("segments.gen"); } }

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-09T15:14:42.607

我知道这是一个旧条目，但 Sean Carpenter 发布的内容是完全正确的，即使在最新版本的 Lucene .NET 中也存在此构造函数。IndexWriter 类的文档可以在这里找到：http: [//lucenenet.apache.org/docs/3.0.3/d2/d1d/class_lucene_1_1_net_1_1_index_1_1_index_writer.html#af4620c14320934601058e0e9cac9bfab](http://lucenenet.apache.org/docs/3.0.3/d2/d1d/class_lucene_1_1_net_1_1_index_1_1_index_writer.html#af4620c14320934601058e0e9cac9bfab)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-11-03T17:15:43.117

哎呀！

这是“纯 Java”Lucene，但它很可能适用于其他品种。

在 Lucene 4.0.0 中，API`DirectoryReader.indexExists()`说

> 如果指定目录中存在索引，则返回 true。

但是在 Lucene 4.10.2 中，API`DirectoryReader.indexExists()`说

> 如果指定目录中可能存在索引，则返回 true。请注意，如果存在损坏的索引，或者正在提交的索引

...是的，它在句子中间中断。注意我直接从源代码编译了我的 Javadoc，但是在在线 API 中可以看到相同的未完成短语。不仅如此，我查看了Lucene 6.0.0 API，也完全一样。

然而，“返回”短语是：

> 如果存在索引，则为 true；否则为假

...但我目前相信一个空目录有时会（？）返回`true`（来自我的单元测试）。反正我是不会相信的。

如果您`IndexReader`在空目录上创建一个，它的所有方法似乎都将返回而不会引发异常。你可以 go `indexReader.numDocs()`，这将返回 0，但这并不能证明那里没有索引，只能证明没有`Document`s。当然，根据您的要求，这可能就足够了。

同样，您可以`IndexSearcher`从这样的 中创建一个`IndexReader`，并且您可以创建一个`IndexWriter`. 这些都不会对空目录有任何明显的问题。

**更好的解决方案：**

```
 try {
        directoryReader = DirectoryReader.open( fsDir );
    } catch ( org.apache.lucene.index.IndexNotFoundException e) {
        ...
    } 
```

据我所知，这似乎是可靠的。

# .htaccess - 如何将不去特定目录的请求传递到 index.php/path？

> ID：1001830
> 
> 赞同：2
> 
> 时间：2009-06-16T14:23:55.530
> 
> 标签：.htaccess, mod-rewrite

在我目前的项目中，我有几个目录：应用程序（我的 MVC 文件，不能访问）、图像、css 和 js。实际上，我希望对 images/css/js 的所有请求保持不变，但我希望调用所有其他请求`index.php/my/path`。

我的 .htaccess 目前看起来像这样，并且正在对我的路由造成严重破坏。

```
<IfModule mod_rewrite.c>
  RewriteEngine on
  RewriteCond $1 !^(index\.php|images|js|css|robots\.txt)
  RewriteRule ^(.*)$ http://example.com/index.php/$1 [L]
</IfModule> 
```

这不起作用，因为相对 URL 开始堆积，例如：`example.com/blog/view/1/blog/view/2`.

当我尝试类似的事情时，--

```
<IfModule mod_rewrite.c>
  RewriteEngine on
  RewriteCond %{REQUEST_URI} !^/(index\.php|images|js|css|robots\.txt)
  RewriteRule ^ index.php%{REQUEST_URI} [PT]
</IfModule> 
```

任何请求都会出现此错误：`No input file specified.`

* * *

如何强制所有请求不向我的白名单目录调用，而不是重定向到（重定向谋杀发布，我发现）`index.php/path`，？IE，当`/blog/view/1`浏览器请求时， .htaccess*调用* `index.php/blog/view/1`. Apache 站点上的参考文件并不太清楚如何做这种事情——或者，我只是错过了我正在阅读的关于 RewriteRule 的内容。

而且，我真的很想了解这一点。为什么你的答案会奏效？为什么我的尝试失败了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T14:32:56.200

这就是我的 .htaccess 中用于我的框架的内容：

```
<IfModule mod_rewrite.c>
    RewriteEngine on

    #This will stop processing if it's images
    RewriteRule \.(css|jpe?g|gif|png|js)$ - [L] 

    #Redirect everything to apache
    #If the requested filename isn’t a file….
    RewriteCond %{REQUEST_FILENAME} !-f
    #and it isn’t a folder…
    RewriteCond %{REQUEST_FILENAME} !-d

    RewriteRule ^(.*)$ index.php?$1 [L,QSA] 
    #L = (last - stop processing rules)
    #QSA = (append query string from requeste to substring URL)
</IfModule> 
```

希望这可以帮助。

PS：如果是文件或文件夹，也许您想删除这些行以停止重定向；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:31:12.387

Antonio 帮助我走上了正确的道路，所以结果`.htaccess`如下：

```
<IfModule mod_rewrite.c>
  RewriteEngine on
  # skip if whitelisted directory
  RewriteRule ^(images|css|js|robots\.txt|index\.php) - [L]
  # rewrite everything else to index.php/uri
  RewriteRule . index.php%{ENV:REQUEST_URI} [NE,L]
</IfModule> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:44:27.850

您将不得不使用 PHP 来做到这一点。例如，如果您想将 URI 拆分为 domain.tld/controller/action/param 之类的内容，则可以使用以下 PHP 代码作为开始：

```
<?php

// Filter URI data from full path
$uri_string = str_replace($_SERVER['SCRIPT_NAME'], '', $_SERVER['REQUEST_URI']);
$uri_string = trim($uri_string, '/');    // Make sure we don't get empty array elements

// Retrieve URI data
$uri_data = explode('/', $uri_string); 
```

在这种情况下，$uri_data[0] 是控制器，$uri_data[1] 是动作，除此之外是参数。请注意，这不是一个万无一失的方法，并且像这样信任用户输入的输入从来都不是一个好主意，因此您应该将那些可以使用的控制器和操作列入白名单。

从这里开始，了解控制器并具有一致的目录结构，您可以 require_once 正确的控制器并使用变量变量调用操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-10-04T14:20:31.290

这是我在我`.htaccess`的 CMS 文件中使用的内容：

```
Options -Indexes

RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.+)$ index.php/$1 [NC,L] 
```

然后在我的`index.php`文件中我有：

```
$path_info = '';
$path_info = isset($_SERVER['PATH_INFO']) ? $_SERVER['PATH_INFO'] : $path_info;
$path_info = isset($_SERVER['ORIG_PATH_INFO']) ? $_SERVER['ORIG_PATH_INFO'] : $path_info;

$request = explode('/', trim($path_info, '/'));

// if $request[0] is set, it's the controller
// if $request[1] is set, it's the action
// all other $request indexes are parameters 
```

希望这可以帮助。

# c# - 有没有办法在 C# 中执行 SSRS 表达式

> ID：1001839
> 
> 赞同：3
> 
> 时间：2009-06-16T14:26:15.310
> 
> 标签：c#, reporting-services, expression, ssrs-expression

我正在处理一个 SQl Server Report Services 项目，而我正在创建的报告需要一些自定义代码。似乎[所有表达式都必须在 VB.NET 中](http://msdn.microsoft.com/en-us/library/ms345237.aspx)，我想如果有一种“简单”的方法可以将其切换为 C#，那将会很有帮助。

编辑：

好吧，我决定将我的代码移动到另一个遵循[本示例模式的 C# 程序集。](http://msftrsprodsamples.codeplex.com/Wiki/View.aspx?title=SS2008!File%20Share%20Data%20Processing%20Extension%20Sample)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T14:30:13.523

它是 VBA（Visual Basic for Applications）而不是 VB.NET，所以它不是 .NET，它是一种嵌入式脚本语言。因此，我希望没有办法切换到 C#。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:28:41.887

我相信这些报告使用的东西更像 VBScript（**编辑**：OregonGhost 说 VBA 实际上比 VBScript 更有意义）而不是 VB.NET（并且非常有限）。我还没有看到任何将其切换到 C# 的方法，我希望被证明是错误的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:31:25.673

最简洁的答案是不。而且我的 MSDN 所描述的语言并不是真正的 VB.NET，而是 Visual Basic

# .net - 使用 LINQ to Entities 进行数据绑定时出现重复行

> ID：1001847
> 
> 赞同：13
> 
> 时间：2009-06-16T14:27:02.203
> 
> 标签：.net, asp.net, linq

我在将 Telerik RadGrid 和普通的 ASP.NET GridView 绑定到以下 LINQ 到实体查询的结果时遇到问题。在这两种情况下，网格都包含正确的行数，但只有前几行的数据在所有其他行中重复。我直接将此代码的返回值分配给网格上的 DataSource 属性。

```
public IEnumerable<DirectoryPersonEntry> FindPersons(string searchTerm)
{
    DirectoryEntities dents = new DirectoryEntities();
    return from dp in dents.DirectoryPersonEntrySet
           where dp.LastName.StartsWith(searchTerm) || dp.Extension.StartsWith(searchTerm)
           orderby dp.LastName, dp.Extension
           select dp;
} 
```

**添加：**这是可以使用的备用纯 ADO.NET 代码：

```
 DataTable ret = new DataTable();
    using (SqlConnection sqn = new SqlConnection(ConfigurationManager.ConnectionStrings["WaveAdo"].ConnectionString))
    {
        SqlDataAdapter adap = new SqlDataAdapter("select * from DirectoryPersonList where LastName like '" + searchTerm + "%' order by LastName ", sqn);
        sqn.Open();
        adap.Fill(ret);
    }
    return ret; 
```

**更多**：

1.  LINQ 发送到 SQL Server 的查询有效。
2.  在返回它们之前迭代 LINQ 查询结果会导致相同的重复。
3.  在绑定之前迭代 LINQ 会导致调用方法产生相同的重复。

**更新**：根据下面*Marc Gravel*非常合乎逻辑和合适的建议，我发现 EF 设计者对我的实体类的实体键做出了非常未经教育的猜测，它的字段列表中的第一个字段，部门，其中只有大约七个条目在所有其他记录中共享。

这确实是重复的原因。如果我可以更改或删除实体密钥，但这位具有 Etch-a-Sketch 的所有业务逻辑的 EF 设计师令人钦佩地致力于重复其迟缓的密钥选择，同时嘲笑我被锁在外面乞求更改密钥。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2009-06-21T14:15:33.133

在我看来，您的主键很糟糕。LINQ-to-SQL 和 EF 的“身份管理”方面意味着当它看到相同对象类型的相同主键值时，它必须返回相同的实例。

例如，给定数据：

```
id     | name       | ...
-------+------------+------
1      | Fred       | ...
2      | Barney     | ...
1      | Wilma      | ...
1      | Betty      | ... 
```

然后，如果它在从 LINQ 迭代对象时**认为`id`是主键，它会***被迫*给你“Fred”、“Barney”、“Fred”、“Fred”。本质上，当它再次看到`id`1 时，它甚至不会查看其他列 - 它只是`id`从身份缓存中获取具有 1 的实例 - 并为您提供它之前提供给您的同一个 Fred 实例。如果它认为*不是*`id`主键，它会将每一行视为一个单独的对象（如果它在一个字段中与另一条记录具有相同的值怎么办 - 这并不完全不寻常）。

我建议检查您标记为主键的任何字段（在您的 DBML/EDM 模型中）是否真的每行都是唯一的。在上述情况下，该`id`列显然不代表唯一标识符，因此不适合作为主键。只需在 LINQ-to-SQL / EF 设计器中取消标记即可。

* * *

更新：特别是查看设计器中各种属性的“实体键”属性——尤其是在查询视图时。检查“实体键”是否仅针对合适的列（即使行唯一的那些）设置为 true。如果设置不正确，请将其设置为 false。这也显示为黄色钥匙图标 - 这应该只出现在真正是记录唯一标识符的事物上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-19T13:41:41.237

如果您将链接查询包装在括号中并使用 .Distinct() 扩展名？

```
public IEnumerable<DirectoryPersonEntry> FindPersons(string searchTerm)
{
    DirectoryEntities dents = new DirectoryEntities();
    return (from dp in dents.DirectoryPersonEntrySet
           where dp.LastName.StartsWith(searchTerm) || dp.Extension.StartsWith(searchTerm)
           orderby dp.LastName, dp.Extension
           select dp).Distinct();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-22T17:06:26.543

您的工作查询和中断查询之间的一个区别是 orderby 子句。我在 Linq to Entities 的 orderby 实现中发现了一个[记录在案的错误](http://msdn.microsoft.com/en-us/library/bb896317.aspx#OrderingInfoLost)……可能还有其他错误。

尝试从损坏的查询中删除 orderby，看看您是否仍然得到重复。

另一个区别是 where 子句中的 OR。尝试仅使用第一部分 [ where dp.LastName.StartsWith(searchTerm) ] 并查看是否仍然出现重复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-02-16T17:33:20.657

我遇到了同样的问题并通过解决方法解决了它。我在这里发布它，因为它可能会帮助其他人来到这里。

而不是 select dp ，使用

```
select new <ObjectName>
{
a = v.a
b = v.b
}. 
```

这不会返回重复项。

# python - PYTHONPATH 被忽略

> ID：1001851
> 
> 赞同：11
> 
> 时间：2009-06-16T14:27:44.433
> 
> 标签：python, path, debian

环境：debian 4.0

蟒蛇2.4

我的“项目”安装在：

> /usr/lib/python2.4/site-packages/项目。

但我想使用我的工作副本而不是位于以下位置的已安装副本：

> /home/me/dev/project/src

所以我要做的是：

> 导出 PYTHONPATH=/home/me/dev/project/src
> 
> 蟒蛇
> 
> import foo # 在 src 中
> 
> `foo.__file__`
> 
> ```
> */usr/lib/python2.4/site-packages/project/foo.py* 
> ```

代替 ：

> /home/me/dev/project/src/project/foo.py

怎么来的？我尝试检查路径（已经完成了上面的导出），我看到的是：

> 导入系统，操作系统
> 
> 系统路径
> 
> *['', '/usr/bin', '/usr/lib/python2.4/site-packages', '/home/me/dev/project/src', '/usr/lib/python24.zip', '/usr/lib/python2.4', '/usr/lib/python2.4/plat-linux2', '/usr/lib/python2.4/lib-tk', '/usr/lib/python2.4 /lib-dynload'、'/usr/local/lib/python2.4/site-packages'、'/usr/lib/python2.4/site-packages/PIL'、'/var/lib/python-support/ python2.4'，'/usr/lib/python2.4/site-packages/IPython/Extensions'，'/home/me/.ipython']*
> 
> os.environ['PYTHONPATH']
> 
> */home/me/dev/project/src*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-16T15:06:09.503

根据 python 文档，**这是预期的行为**：[https](https://docs.python.org/2.4/lib/module-sys.html) ://docs.python.org/2.4/lib/module-sys.html ：

> 请注意，脚本目录是在 PYTHONPATH 插入的条目**之前**插入的。

在 python-2.6 下它是不同的： http: [//docs.python.org/tutorial/modules.html#the-module-search-path](http://docs.python.org/tutorial/modules.html#the-module-search-path)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T16:31:17.047

[我发现了问题（当有人向我指出Python 的 sys.path 从哪里初始化](https://stackoverflow.com/questions/897792/pythons-sys-path-value)时，我很早就错过了？ ）。

似乎easy_install创建了一个pth文件/usr/lib/python2.4/site-packages/easy-install.pth，然后由site.py加载。这会将站点包路径插入到 PYTHONPATH 之前的 sys 路径中。不太好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T14:58:43.417

我不相信您可以控制 PYTHONPATH 插入实际路径列表的位置。但这不是修改路径的唯一方法 - 您可以在尝试导入项目之前自己更新 sys.path。

**编辑：**在您的特定情况下，您可以修改路径

```
import sys
sys.path.insert(2, '/home/me/dev/project/src') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T14:53:05.410

我在“/home/me/dev/project/src”之前的路径中看到“/usr/lib/python2.4/site-packages”，这有关系吗？当你切换两者时会发生什么？

从文档：

> 如果未设置 PYTHONPATH，或者在此处找不到文件，则搜索将在依赖于安装的默认路径中继续

所以也许你没有像你想象的那样在你的 PYTHONPATH 上找到你的工作副本？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T15:39:10.793

不是直接回答您的问题，但您也可以使用[virtualenv](http://pypi.python.org/pypi/virtualenv "虚拟环境")来创建开发环境。然后，在该 virtualenv 中，您可以将您的产品`/home/me/dev/project/src`作为开发包安装：“ `python setup.py develop`”。

这样您就不必`PYTHONPATH`手动更改。如果您想使用开发代码，只需激活 virtualenv。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T15:12:44.107

听起来`src`目录没有`__init__.py`文件。这不是一个合适的包。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-16T14:43:15.383

我认为您将 PYTHONPATH 设置为 /home/me/build/project/src 因为 /home/me/dev/project/src 没有出现在 sys.path 中，但 /home/me/build/project/src 出现了。

# sql-server - 如何将 Scope_Identity() 转换为 Int？

> ID：1001854
> 
> 赞同：12
> 
> 时间：2009-06-16T14:28:36.863
> 
> 标签：sql-server, scope-identity

因此[Scope_Identity()](http://msdn.microsoft.com/en-us/library/aa258832(SQL.80).aspx)在 SQL Server 中返回一个 ?-Byte 数字类型。

这并不可怕。

是否有一种安全的方法可以在选择查询中将其转换为 int，这样我们就不必在 ODBC Wrapper 中管理 SQL Server 的每一个奇思妙想？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-06-16T14:32:52.517

如果标识所属的源列是 Integer，则无需强制转换。假设标识列是一个整数开头或者它适合一个“Int”，那么下面的工作就很好。

```
DECLARE @NewIdent Int
SET @NewIdent = SCOPE_IDENTITY() 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2009-06-16T14:31:26.203

```
SELECT CAST( bigintcolumn AS int ) 
```

（前提是您知道它将适合 32 位整数）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-05-16T13:44:49.840

就像这样：

```
select CAST(SCOPE_IDENTITY() as int) 
```

还有你的数据层：

```
reader.GetInt32(0); 
```

# django - 如何限制用户对自己的模型投票

> ID：1001856
> 
> 赞同：2
> 
> 时间：2009-06-16T14:28:48.300
> 
> 标签：django, django-middleware, django-voting

我正在使用 django-voting 作为我的两个模型的投票应用程序。这两个模型都有“作者”字段。

如何在不修改 django-voting 应用程序的情况下限制用户对将此特定用户设置为作者的模型进行投票？

Django 中间件是我想到的第一件事，但我不明白它的“proces_view”功能。如果您认为中间件是正确的方法，请举例说明如何做。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T17:08:14.193

在 settings.py 中的任何位置添加此代码：

```
from voting.managers import VoteManager

def check_user(func):
    def wrapper(self, obj, user, vote):
        if obj.user != user:
            return func(self, obj, user, vote)
        else:
            return None
            # or raise some exception
    return wrapper

VoteManager.record_vote = check_user(VoteManager.record_vote) 
```

我没有运行此代码，也许它不正确，但我希望想法清楚

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T14:53:00.857

为什么不通过另一个视图将请求重新路由到该特定 URI，而不是中间件 hack？然后您可以执行您喜欢的任何逻辑，然后在适当的情况下调用原始视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-19T14:46:56.470

另一个想法是使用[post_save 信号](http://docs.djangoproject.com/en/dev/topics/signals/)

像这样：

```
from django.db.models.signals import post_save
from voting.models import Vote

def check_user(sender, instance, **kwargs):
    if instance.user == instance.object.user:
        instance.delete()
        # do some other stuff to tell the user it didn't work

post_save.connect(check_user, sender=Vote) 
```

这样做与覆盖相比的好处`VoteManager.record_vote`是它与投票模块的耦合不那么紧密，如果他们进行更改，那么破坏您的代码的可能性就会降低

**编辑**：正如格拉德的回答，您需要确保您投票的所有对象都具有“用户”属性。

# java - 查看 Session、Application 和 Request Bean 的内容

> ID：1001857
> 
> 赞同：1
> 
> 时间：2009-06-16T14:28:53.743
> 
> 标签：java, jsp, jsf, servlets

在开发 JSF 应用程序时能够监控 Session、Application 和 Request Bean 的内容会很有意义，但据我所知，我应该为我感兴趣的参数显式添加观察点。

当我浏览我的应用程序页面时，是否有更简单的方法来查看这些值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-17T02:39:12.803

您可以使用自己的一些过滤器或框架提供的一些 AOP 技术将其作为横切关注点来实现。这个想法是记录每个请求的所有这些信息。它可以是控制台，为什么不呢。

不过，IMO，监控请求的内容可能不是一个非常有用的想法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T09:54:00.407

如果您想查看在这些范围中添加和删除的内容，请查看[ServletContextAttributeListener](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletContextAttributeListener.html)、[ServletRequestAttributeListener](http://java.sun.com/javaee/5/docs/api/javax/servlet/ServletRequestAttributeListener.html)和[HttpSessionAttributeListener](http://java.sun.com/javaee/5/docs/api/javax/servlet/http/HttpSessionAttributeListener.html)。您可以使用*web.xml*定义这些类的实例。

正如[Vinegar 所说](https://stackoverflow.com/questions/1001857/viewing-the-contents-of-session-application-and-request-bean/1004836#1004836)，如果你想监控任意类，你可以使用 AOP。您还可以考虑[以编程方式使用调试器](http://illegalargumentexception.blogspot.com/2009/03/java-using-jpda-to-write-debugger.html)。

# .net - 将 HTML 注入服务器控件

> ID：1001858
> 
> 赞同：0
> 
> 时间：2009-06-16T14:29:06.973
> 
> 标签：.net, asp.net, servercontrols

如何将 HTML 注入服务器控件？

我正在创建一个日历控件，并有一些与之配套的 javascript/css。

此外，我有一些使用 JS/CSS 的正确 ClientID 生成的 html 代码，我想将其注入到使用“服务器”控件的位置。

例如：

```
<MyUC:UC1 ID="someUC" runat="server" /> 
```

使用 LiteralControls/RegisterClientScriptBlock 来包含 CSS/JS，但想知道 HTML 注入到正文中。

这将呈现为我构建的控件以及与之配套的 CSS/JSS/HTML。

我想我可以在 javascript 包含中生成 dom 元素，但我想知道如何从服务器端做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T14:34:30.050

磅：

看看这篇 CodeProject 文章：

[使用 ControlInjector http://www.codeproject.com/KB/aspnet/ControlInjector.aspx](http://www.codeproject.com/KB/aspnet/ControlInjector.aspx)简化 ASP.NET 服务器控件中 HTML 的构建

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T14:34:39.130

如果您只需要添加一些额外的标记，您可以使用 LiteralControl 将一些 HTML 添加到您的服务器控件。

```
myServerControl.Controls.Add(new LiteralControl("<br />")); 
```

或者，您可以使用 System.Web.UI.HtmlControls 库在后端生成特定的服务器控件，并以编程方式在服务器控件中创建您想要的 HTML 结构。

# asp.net - 获取 GridView ASP.Net 的更改行

> ID：1001859
> 
> 赞同：1
> 
> 时间：2009-06-16T14:29:09.750
> 
> 标签：asp.net, gridview

如何在 gridview 中找到所有已更改的行。我不能以任何形式使用 Ajax

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-06-16T14:31:08.607

首先获取网格在更改之前的内容（例如缓存原始 gridview 数据源绑定的结果）。然后浏览数据集/数据表/无论您想存储它，并将内容与gridview的当前行进行比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:31:59.743

没有真正有效的方法可以做到这一点，也没有像 GridView.GetAllChangedRows() 这样的方法。因此，您可以改为保留一个在每次修改行时添加到的幕后列表（使用 RowUpdated 方法），然后在需要时清除此列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-06-04T22:50:47.783

这取决于您要连续编辑多少列。

如果一行中只有一个可编辑列，则可以将 javascript 方法与要修改的控件相关联，在该方法中，您可以获得一个 rowid，您可以将其保存在另一个隐藏字段中，在服务器端您可以获得所有id 存储在隐藏字段中的行。

如果在这种情况下您有整行可编辑的最佳方法，我认为您应该将原始数据源保存在某处，并设置一个带有 rowclick 事件的 javascript 方法来获取用户选择的 rowid。然后，当用户单击提交按钮时，获取所有行 ID 存储在隐藏字段中的行，然后比较数据源中具有相同行 ID 的行。从我的角度来看，这是最好的方法。

让我举个例子，假设网格中有 1000 行，而用户只点击了 180 行。在这种情况下，我们将仅比较 180 行，而不会比较其余行。

如果有人对此有更好的想法，请告诉我。

# facebook - 在 Facebook 应用程序中邀请朋友

> ID：1001860
> 
> 赞同：2
> 
> 时间：2009-06-16T14:29:40.183
> 
> 标签：facebook, invitation

我有一个在 facebook 平台上发布的 facebook 应用程序，我使用 facebook API 来邀请朋友，我已经成功创建了邀请表单，但问题是当你邀请朋友并发送邀请并将邀请请求发送给用户和用户时接受这个朋友再次出现在可以再次邀请的朋友列表中

例如 ：

我的朋友列表中有一个名为 X 的朋友，当我向他发送邀请时，会发送邀请并且 X 接受邀请，当我再次尝试发送邀请时，朋友 X 再次出现在列表中，我可以从中选择发送邀请这意味着我可以向该用户 (X) 发送邀请，并且他已经在玩游戏，我需要知道如何解决此问题，以便朋友出现在朋友列表中（用于邀请），只有不使用该应用程序的朋友。

我的应用程序在以下链接 [我的游戏应用程序](http://apps.facebook.com/hanggame/) 访问它并在邀请朋友后看到问题 他们会再次出现在任何游戏应用程序中都是正常的吗？

提前感谢您的回复

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T14:39:55.327

在 FBML 中，如果您使用**[朋友选择器](http://wiki.developers.facebook.com/index.php/Fb:friend-selector)**，您可以将数组**exclude_ids**传递给它。如果您使用 api 查找已经在使用您的应用的用户的朋友，您可以通过这种方式排除他们。

这也适用于位于**[fb:request-form](http://wiki.developers.facebook.com/index.php/Fb:request-form)**标签内的**[多朋友选择器。](http://wiki.developers.facebook.com/index.php/Fb:multi-friend-selector)**

***编辑***：要排除的用户数组可以通过 API 调用**[Friends.getAppUsers](http://wiki.developers.facebook.com/index.php/Friends.getAppUsers)**获得。

以下示例使用 .NET [Facebook Developer Toolkit](http://www.codeplex.com/FacebookToolkit)。（主要是因为我以前就是这样做的！）

代码背后：

```
public string CURRENT_USER_FRIENDS = "";

//Call this function on pageload or where you like
private void PopulateFriendsData()
{
//exclude friends who already have the app from the inviter
string UsersToExclude = string.Empty;
IList<long> AppUserFriends = this.Master.API.friends.getAppUsers();
foreach (long L in AppUserFriends)
{
    UsersToExclude += L.ToString() + ",";
}
CURRENT_USER_FRIENDS = UsersToExclude.TrimEnd(',');
} 
```

页：

```
<fb:multi-friend-selector 
actiontext="Select the friends you want to invite" 
rows="3" 
exclude_ids="<%=CURRENT_USER_FRIENDS%>"/> 
```

# python - 加载大文件时显示 python 的 XML 解析器的进度

> ID：1001871
> 
> 赞同：3
> 
> 时间：2009-06-16T14:32:25.407
> 
> 标签：python, xml, pyqt

我使用 Python 的内置 XML 解析器来加载 1.5 gig XML 文件，这需要一整天。

```
from xml.dom import minidom
xmldoc = minidom.parse('events.xml') 
```

我需要知道如何进入其中并衡量其进度，以便显示进度条。有任何想法吗？

minidom 有另一种称为 parseString() 的方法，它返回一个 DOM 树，假设您传递的字符串是有效的 XML，如果我自己将文件拆分成块并一次将它们传递给 parseString，我可以合并所有DOM 树最终会重新组合在一起吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T14:57:35.883

您是否考虑过使用其他解析 XML 的方法？构建如此大的 XML 文件的树总是很慢并且占用大量内存。如果您不需要内存中的整个树，则基于流的解析会*快得多*。如果您习惯于基于树的 XML 操作，这可能有点令人生畏，但它会以巨大的速度提高（几分钟而不是几小时）的形式付出代价。

[http://docs.python.org/library/xml.sax.html](http://docs.python.org/library/xml.sax.html)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T15:10:21.787

您的用例要求您使用 sax 解析器而不是 dom，dom 将所有内容加载到内存中，sax 将逐行解析，并且您根据需要编写事件处理程序，这样可能是有效的，您也可以编写进度指示器

我还建议有时尝试 expat 解析器，它非常有用 [http://docs.python.org/library/pyexpat.html](http://docs.python.org/library/pyexpat.html)

使用萨克斯的进步：

当 sax 以增量方式读取文件时，您可以用自己的文件对象包装您传递的文件对象，并跟踪已读取了多少。

编辑：我也不喜欢自己拆分文件并最终加入 DOM，这样你最好编写自己的 xml 解析器，我建议改用 sax 解析器我也想知道你在 DOM 树中读取 1.5 gig 文件的目的是什么? 看起来萨克斯在这里会更好

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T15:09:39.450

对于 PyGTK，而不是 PyQt，我使用 pulldom api 有一些非常相似的东西。它使用 Gtk 空闲事件（因此 GUI 不会锁定）和 Python 生成器（以保存解析状态）一次调用一点。

```
def idle_handler (fn):
  fh = open (fn)  # file handle
  doc = xml.dom.pulldom.parse (fh)
  fsize = os.stat (fn)[stat.ST_SIZE]
  position = 0

  for event, node in doc:
    if position != fh.tell ():
      position = fh.tell ()
      # update status: position * 100 / fsize

    if event == ....

    yield True   # idle handler stays until False is returned

 yield False

def main:
  add_idle_handler (idle_handler, filename) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T14:35:52.793

最后合并树将非常容易。您可以只创建一个新的 DOM，然后将各个树一一添加到它上面。这也可以让您对解析的进度进行非常精细的控制。如果需要，您甚至可以通过生成不同的进程来解析每个部分来并行化它。您只需要确保智能地拆分它（而不是在标签中间拆分等）。

# reporting-services - RDLC 报告中的矩形是否固定高度？

> ID：1001872
> 
> 赞同：3
> 
> 时间：2009-06-16T14:32:52.487
> 
> 标签：reporting-services, reportviewer, rdlc

我有一个 RDLC 报告，其中有一个子报告，我想成为 A4 纸的高度。子报告中的行数可能会有所不同，所以我将子报告放在一个矩形中，这样如果子报告很短，我的报告的其余部分就不会缩小。根据文档，矩形是固定大小的。当我在网页上显示报告时，这很好用，但是当我在 WinForms 应用程序的 ReportViewer 中运行它时，它会缩小！

这是一个已知问题吗？是否有人对如何处理有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T14:42:00.487

六分钟后，我找到了自己问题的答案……

默认情况下，它以**正常**`ReportViewer`模式显示报告- （在我看来这是错误的）。将其设置为**页面布局**模式可以解决此问题。

 ****在**VB.NET**中，这是通过以下方式完成的：

```
Me.ReportViewer1.SetDisplayMode(DisplayMode.PrintLayout) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-03T17:44:46.987

设置所有文本框 CanGrow 为 False，则矩形为固定大小****

# nhibernate - 将对象从基类转换为子类是否有效

> ID：1001877
> 
> 赞同：13
> 
> 时间：2009-06-16T14:33:15.607
> 
> 标签：nhibernate, inheritance

在我目前的应用程序中（与许多其他应用程序一样）有一个名为 的实体`Contact`，它代表任何人。在最基本的层面上，这用于表示业务联系。但是，它也可以用来代表公司的员工。还有一些特殊类型的员工（假设有一种叫做`Manager`）

我试图将其建模为有意义的继承关系。员工有姓名和地址，就像联系人一样，还有许多与就业相关的属性。经理也有许多经理特定的属性。

当员工晋升为经理时，困难就来了。将基类转换`Employee`为继承类可以`Manager`吗？感觉不对。我想我会在`Manager`.

顺便说一句，NHibernate 是否支持这种行为？是否像获取员工，从员工创建经理，然后保存经理一样简单？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-16T14:55:26.293

在这种情况下，我会选择组合而不是继承。如果您坚持继承，那么每次晋升或降级以及每次雇用联系人或员工离开并成为常规联系人时，您都会改变班级。

说联系人有角色更容易。您可以将经理角色添加到联系人以提升它并删除角色以触发它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T14:42:02.797

只要您的商业模式与您的领域相匹配，您就做对了。

但是，在我看来，您应该具有以下内容：

```
Manager Promote(Employee employee)
{
   var manager = new Manager();
   //promote your employee to a manager here
   return manager;
} 
```

在某种工作流程中。

关于 NHibernate，听起来您正在将您的 ORM 逻辑与您的业务领域混合在一起。将员工提升为经理是一种业务领域结构，因此属于您的业务模型。然而，NHibernate 如何将您的员工和经理映射到您的数据库与您的业务模型无关，除了如何映射它们。不过，这绝对与如何将员工提升为经理无关。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-06-16T14:42:21.453

我个人会拥有一个包含所有基本内容和角色列表的基类。
每个角色都有自己的属性和功能。
优点有两个：

*   向某人授予或接受某个角色很容易
*   它将允许您的人员担任多个角色，而无需您进行“组合课程”

如果您使用单一继承，那么使用继承很快就会为您提供诸如“ManagerProgrammer”、“ProgrammerStockManager”、“ProgrammerSupport”之类的类

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-06-16T15:03:41.693

是的，它是有效的。关于实施，您可以使用：

*   Manager 上的静态方法：`public static Manager Promote(Employee employee) { ... }`
*   Manager 上的专用构造函数
*   工厂或服务等级

我认为这些方法中的任何一种都是一个很好的解决方案。我个人喜欢专门的构造函数解决方案，因为它很好地代表了现实世界：您正在从现有员工创建新经理。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T15:02:11.007

天，

如果您发现必须将派生类从一种类型转换为另一种派生类型，那么这就是初始设计有问题的味道。

我的直觉是您错误地表示了 Manager 对象。

回到基础并以 OO 术语思考，您的基类 (Contact) 包含 Employee 和 Manager 对象的公共元素。任何派生对象都只是基类的特化。

在这种情况下，经理不是员工的实例吗？

Manager 和Employee 类都应该有一个reportsTo 数据成员，它也是Employee 类型。

目前我能看到的唯一区别是 Manager 对象现在有一个 Employee 对象的集合，这些对象是它们自己的 directReports。这可能应该实现为指向 Employee 对象容器的指针。

我想不出任何需要将 Employee 对象与 Manager 对象分离的行为专业化。

嗯，也许可以创建包含联系人详细信息的基类 Person。

**编辑：**对不起，从你的评论我想我不够清楚。我所描述的不会导致两个单独的类都直接从您的 Contact 类派生，因此您必须在运行时将 Employee 的实例更改为 Manager，这是您最初的问题。

也就是说，我认为您不应该有两个派生类，一个 Employee 和一个 Manager，直接从您的 Contact 类继承。

这两种情况不都是受雇于公司的人吗？为什么要区分经理和员工？如果员工成为经理，他们就不再是员工了吗？

恕我直言，拥有两个派生类，一个 Manager 和一个 Employee 是完全错误的。您是否尝试过根据“isa”和“has a”关系来分解事物。然后你可以看到你的基本结构是错误的。

说员工“isa”联系人是没有意义的。更可能的是，员工“isa”人员和人员“拥有”一组联系方式。

也许将 Manager 类派生为 Employee 的专业化？员工“isa”人。经理“isa”员工，其中“isa”人。

高温高压

干杯，

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-20T20:16:04.920

联系人是 Employee 的一个属性。Worker（你的Employee）是一个角色，Manager是一个角色。Worker 和 Manager 仍然是 Employee，但有 Roles。Role 是 IS IN 关系，Employee 是 AM A 关系，Contact 是 HAS A 关系。员工有一个联系人（1-1 关系）每个员工一个联系人（如果他们有两部电话等，则为 1-M，但我离题了） 员工在职（MM 关系）许多员工有很多角色 员工是 A（M-1 关系）-许多员工，所有员工类型。

所以你正在改变角色。

# asp.net-2.0 - 数据网格和网格视图之间的区别

> ID：1001884
> 
> 赞同：2
> 
> 时间：2009-06-16T14:34:04.887
> 
> 标签：asp.net-2.0

我想知道asp.net 2.0中datagrid和gridview的主要区别

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T14:36:04.710

在此处查看 MSDN 的发布：http: [//msdn.microsoft.com/en-us/magazine/cc163933.aspx](http://msdn.microsoft.com/en-us/magazine/cc163933.aspx)

# java - XStream fromXML() 异常

> ID：1001899
> 
> 赞同：3
> 
> 时间：2009-06-16T14:36:19.920
> 
> 标签：java, exception, xml-serialization, xstream

我正在尝试使用 XStream 包反序列化 Java 中的字符串。XStream 包可以很好地序列化我的类。我从服务器获取 XML（无法更改 XML 的格式）并尝试将其节点信息保存到某个类中的相应变量中。我的函数在底部，我试图为 XStream 对象注册一个新的转换器（认为这是因为一个变量是一个字节数组）但仍然没有运气。任何人都可以阐明这些例外情况吗？我是否需要注册“MyClass”并为 XStream 编写自己的转换器来处理反序列化我的课程？提前致谢。

如果将字符串或 StringReader 对象作为输入传递给 fromXML() 则会出现异常：

> [致命错误]：1：1：序言中不允许内容。
> com.thoughtworks.xstream.io.StreamException: : prolog 中不允许内容。
> 在 com.thoughtworks.xstream.io.xml.DomDriver.createReader(DomDriver.java:86)
> 在 com.thoughtworks.xstream.io.xml.DomDriver.createReader(DomDriver.java:66)
> 在 com.thoughtworks.xstream.XStream .fromXML(XStream.java:853)

如果 ByteArrayInputStream 用作 fromXML() 的输入，则异常：

> com.thoughtworks.xstream.converters.ConversionException：字节大小：字节大小：字节大小：字节大小
> ----调试信息----
> 消息：字节大小：字节大小
> 原因异常：com.thoughtworks.xstream.mapper.CannotResolveClassException
> 原因消息：字节大小: ByteSize
> 类 : MyClass
> 所需类型 : MyClass
> 路径 : /MyClass/ByteSize
> at com.thoughtworks.xstream.core.TreeUnmarshaller.convert(TreeUnmarshaller.java:89)
> at com.thoughtworks.xstream.core.AbstractReferenceUnmarshaller.convert(AbstractReferenceUnmarshaller. java:63)
> 在 com.thoughtworks.xstream.core.TreeUnmarshaller.convertAnother(TreeUnmarshaller.java:76)
> 在 com.thoughtworks.xstream.core.TreeUnmarshaller.convertAnother(TreeUnmarshaller.java:60)
> 在 com.thoughtworks.xstream.core.TreeUnmarshaller.start(TreeUnmarshaller.java:137)
> 在 com.thoughtworks.xstream.core.AbstractTreeMarshallingStrategy.unmarshal (AbstractTreeMarshallingStrategy.java:33)
> 在 com.thoughtworks.xstream.XStream.unmarshal(XStream.java:923)
> 在 com.thoughtworks.xstream.XStream.unmarshal(XStream.java:909)
> 在 com.thoughtworks.xstream.XStream。来自XML(XStream.java:861)

```
static Object fromXmlString(String xml) 
{
    XStream xStream = new XStream(new DomDriver());
    xStream.registerConverter(new EncodedByteArrayConverter());
    //tried all 3 below
    //return xStream.fromXML(new StringReader(xml));
    //return xStream.fromXML(new ByteArrayInputStream(xml.getBytes()));
    return xStream.fromXML(xml);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T14:42:54.370

看看这个问题：[content not allowed in prolog exception](https://stackoverflow.com/questions/649209/content-not-allowed-in-prolog-exception)。

“Prolog 中不允许的内容”通常意味着在`<?xml`文件的标题（“prolog”）之前有一些内容。这是不允许的。

因此，请检查以确保字符串中没有前面`<?xml`的字符，并且您没有任何[BOM](http://en.wikipedia.org/wiki/Byte-order_mark)问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-04-02T16:04:28.927

这是一个编码问题。从 XStream[文档](http://xstream.codehaus.org/faq.html#Serialization)：

> “所有 HierarchicalStreamDriver 实现都尊重 1.3 版以来的编码，但前提是您提供了 InputStream。”

当您尝试读取 XML 时，只需添加一个 Reader。例如：

```
Object obj = xStream.fromXML(new FileReader(xmlFile)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:44:59.157

您的反序列化/解码 XStream 实例是否以与编码 XStream 实例**相同**的方式配置？我会检查后者，并确保同一个 XStream 实例可以编码/解码。

# text-editor - 哪些文本编辑器可以正确处理 Windows 和 Unix 样式的换行符？

> ID：1001900
> 
> 赞同：12
> 
> 时间：2009-06-16T14:36:27.300
> 
> 标签：text-editor, newline

哪些文本编辑器（免费或商业）能正确处理字符编码和 Windows/Unix 换行符？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-06-16T14:38:20.213

[这是文本编辑器及其换行支持的列表。](http://en.wikipedia.org/wiki/Comparison_of_text_editors#Newline_support)

另请参阅[此列表](http://en.wikipedia.org/wiki/Comparison_of_text_editors#Basic_features)并查看换行符转换字段

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-06-16T14:37:52.757

我应该认为绝大多数人都这样做。[Vim](http://www.vim.org)和[Emacs](http://www.gnu.org/software/emacs/)肯定会。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-06-16T14:38:31.557

[Notepad++](http://notepad-plus.sourceforge.net/)是免费的，并且处理得非常好。更不用说它对于许多其他文本编辑任务非常方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T14:37:38.967

[文本板](http://www.textpad.com/)做得很好。我喜欢 4.7 版，它比 ​​5 版​​好得多。*

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T14:38:32.337

记事本++真的很好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-16T14:39:40.600

[Scintilla 和 Scite](http://www.scintilla.org/SciTE.html)是我的最爱，但也有很多不错的可以满足您的需求

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-01-04T14:41:28.447

在 Windows 上，您可以使用 PowerShell ISE 来编辑带有 Unix 换行符的文件。

我观察到的唯一副作用是您必须在“另存为...”命令中将“另存为类型”设置为“所有文件”以避免附加 .ps1 文件扩展名。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-16T14:38:42.663

我想不出任何没有的。我不算notepad.exe。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-06-16T14:39:53.363

[Eclipse](http://www.eclipse.org/)在 windows 和 Unix 之间的重新格式化方面也做得很好。此外，如前所述，Emacs 也很棒。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-06-16T14:40:07.620

[通过使用IDM UltraEdit](http://www.ultraedit.com/downloads.html)，我在格式、特殊字符和变音符号方面没有任何问题。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2009-06-17T09:21:04.793

[jEdit](http://jedit.org/)做到了。

# html - CSS，HTML中的图像填充

> ID：1001903
> 
> 赞同：3
> 
> 时间：2009-06-16T14:37:13.803
> 
> 标签：html, css

我在处理表格中的图像时遇到问题。虽然我设置了 tr width=95，并且图像的宽度也为 95，但 tr 将自动具有 97 的宽度（右侧 2 px 填充）。

但是，我已经明确声明了 style="padding: 0px"。

示例页面如下： [http ://beta.worcell.com/sony.html](http://beta.worcell.com/sony.html)

我遇到的另一个问题是向上和向下箭头（在购买列内）。我希望它们与文本框的间距相等，但是在底部箭头中添加另一个换行符会产生过多的空间。我可以在 CSS 中更改它吗？

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T14:46:10.760

填充看起来不是问题，而是您设置的边距。在您拥有的样式表中

```
img {
    padding:0px;
    border:0px;
    margin:-2px;
} 
```

“边距：-2px;” 部分是使您的图像变为 97 像素而不是 95 像素的原因。将其设置为“边距：0px；” 并且图像看起来很正常。然后，您还需要添加，

```
menu img {
    margin: -2px;
} 
```

为了使您的菜单图像与您的菜单图像保持一致。

对于向上和向下箭头，您需要重新考虑您的标记。下行链路在一个表格内，而上行链路不在一个表格内，这有点不一致。它们还包含在显示为块的段落标签中，这使它们出现在另一个下方，因此向下箭头直到数量框底部之后才会出现，等等。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-16T14:41:07.540

你需要从一个[好的 css reset](http://developer.yahoo.com/yui/reset/)开始。那应该为您解决填充问题。将 css reset 作为页面上的第一个 css 样式导入，然后从那里开始。

另外，不要使用

```
<br/> 
```

如果你能帮上忙。br 所做的一切都可以通过使用 margin 来实现

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-06-16T14:40:03.987

问题的一部分是这样的：在styles.css（第77行）你有

```
tr td {
  border:1px solid #DDDDDD;
  padding:0.6em;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T14:42:22.453

在这种情况下，您的代码中的“填充：0px”适用于表格单元格，而不是图像标签。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T14:43:57.287

你需要：

```
styles.css (line 15)
img {
border:0 none;
margin:-2px; <-- remove this
padding:0;
}

styles.css (line 77)
tr td {
border:1px solid #DDDDDD;
padding:0.6em; <-- remove this
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T17:48:40.463

嗯，HTML Validator 中有 152 个警告，很多未闭合的标签....

**对于图像旁边空间的具体问题，您可以尝试删除</a>**标记和**</td>**标记之间的空白。

# java - Java 系统环境变量当前用户

> ID：1001905
> 
> 赞同：1
> 
> 时间：2009-06-16T14:37:49.887
> 
> 标签：java, environment-variables

通过在 JBoss 上运行的 Java 应用程序获取当前登录用户的最佳方法是什么。系统环境变量 System.getProperty("user.name") 不起作用，因为 JBoss 作为服务运行。

该应用程序在运行 Windows XP 的笔记本电脑上运行。该应用程序是基于网络的，并由特定登录的 Windows 用户使用 Internet Explorer 访问。一次只能登录 1 个 Windows 用户。应用程序需要知道哪个用户已登录才能执行基于角色的菜单和安全功能。因此客户端 (Internet Explorer) 和服务器 (JBoss) 都在同一台笔记本电脑上运行。目前，我们使用 tasklist /v 确定登录用户，然后解析输出以查找某些进程和运行它们的用户。但是，需要知道是否有更简洁的方式来获取登录的 Windows 用户。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T14:40:55.683

我认为这个问题真的没有多大意义。可能*没有*用户登录到主机 - 或者可能有多个用户。

无论如何，我都会对真正想知道这一点的设计保持警惕——Web 应用程序不应该对这类事情真正感兴趣，IMO。你想做什么？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-10-22T22:25:10.983

字符串 uname = System.getenv("user.name")

参考：http: [//download.oracle.com/javase/tutorial/essential/environment/sysprop.html](http://download.oracle.com/javase/tutorial/essential/environment/sysprop.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T16:12:54.150

这假设您在用户登录时存储了一个名为 USERNAME 的环境变量：

```
String username = System.getenv("USERNAME"); 
```

或者，如果您想要完整的环境变量集：

```
Map<String, String> envMap = System.getenv(); 
```

然后遍历地图以获取您存储用户名的环境变量。

```
Map<String, String> envMap = System.getenv();
int mapsize = envMap.size();
Iterator i = envMap.entrySet().iterator();
for (int j = 0; j < mapsize; j++) {
    Map.Entry entry = (Map.Entry) i.next();
    Object key = entry.getKey();
    Object value = entry.getValue();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-17T13:52:26.620

使用 JAAS 身份验证。您应该能够在 Windows 上使用 NTLM，因此用户不必做任何额外的工作。然后，在服务器上，您可以使用安全上下文来获取调用者主体。

# php - 在 CakePHP 中使用 requestAction 时，如何向内容字符串添加布局？

> ID：1001931
> 
> 赞同：1
> 
> 时间：2009-06-16T14:41:11.673
> 
> 标签：php, cakephp, layout

我正在构建一个 CakePHP 站点，用户可以在其中按下一个按钮来“将此时事通讯另存为 HTML”。使用媒体视图的组合来为他们提供内容似乎是个好主意`requestAction`，这样他们就可以获得与实时应用程序完全相同的内容。唯一的缺点是`requestAction`使用空布局，因此没有 HTML 页眉或页脚。

给定一个包含 HTML 正文的字符串，是否有一种简单的方法可以根据给定的布局构建一个包含完整页面内容的新字符串？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T15:01:22.180

有一个未记录的功能，如果您的`options`数组具有`0`作为`bare`键的值，则返回的结果将包括布局：

```
$newsletter_html = $this->requestAction(
                       array(
                           'controller' => 'Newsletters',
                           'action' => 'view'
                       ),
                       array(
                           'pass' => array($id),
                           'return',
                           'bare' => 0
                       )
                    ); 
```

# javascript - 在表单输入字段中自动插入日期和时间？

> ID：1001937
> 
> 赞同：9
> 
> 时间：2009-06-16T14:42:57.130
> 
> 标签：javascript, forms, date, automation

使用 javascript，我们如何自动将当前日期和时间插入表单输入字段。

我正在构建一个“问题”表单来跟踪用户提交的有关某项服务的投诉。我正在收集尽可能多的信息。我希望这里的工作人员不必在每次打开表格时手动输入日期和时间。

我有这段代码：

```
<input id="date" name="date" value="javascript:document.write(Date()+'.')"/> 
```

但它不起作用。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-06-16T14:46:40.603

Javascript 不会在 value 属性中执行。不过，您可以执行以下操作：

```
<input id="date" name="date">

<script type="text/javascript">
  document.getElementById('date').value = Date();
</script> 
```

您可能希望根据自己的喜好格式化日期，因为 Date() 的默认输出类似于：`Tue Jun 16 2009 10:47:10 GMT-0400 (Eastern Daylight Time)`. 有关格式化日期的信息，请参阅[此 SO question](https://stackoverflow.com/questions/986657/how-do-i-format-a-javascript-date)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-03-30T04:13:10.273

```
<input type="date" id="myDate"  />

<script type="text/javascript">
function SetDate()
{
var date = new Date();

var day = date.getDate();
var month = date.getMonth() + 1;
var year = date.getFullYear();

if (month < 10) month = "0" + month;
if (day < 10) day = "0" + day;

var today = year + "-" + month + "-" + day;

document.getElementById('myDate').value = today;
}
</script>

<body onload="SetDate();"> 
```

在这里找到：http: [//jsbin.com/oqekar/1/edit ?html,js,output](http://jsbin.com/oqekar/1/edit?html,js,output)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-06-16T14:46:28.793

见例子，[http://jsbin.com/ahehe](http://jsbin.com/ahehe)

使用[此处](http://blog.stevenlevithan.com/archives/date-time-format)描述的 JavaScript 日期格式化实用程序。

```
<input id="date" name="date" />

<script>
   document.getElementById('date').value = (new Date()).format("m/dd/yy");
</script> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-06-16T14:44:34.227

获取日期格式的最快方法是使用[datejs](http://www.datejs.com/2007/11/27/getting-started-with-datejs/)。

该库非常易于使用，并且确实为您提供了非常漂亮的格式。

* * *

就您的代码片段而言，如果您能提供帮助，请不要使用 document.write。尝试

```
 document.getElementById("date").value = new Date().toUTCString(); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-01-21T04:56:09.240

```
$("#startDate").val($.datepicker.formatDate("dd/mm/yy", new Date()));
$("#endDate").val($.datepicker.formatDate("dd/mm/yy", new Date())); 
```

在脚本末尾添加上面的代码。这是必需的，因为 datepicker 插件没有规定在初始化时在控件中设置日期。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-06-16T14:59:34.307

听起来您将在提交表单后存储输入字段包含的值，这意味着您正在使用脚本语言。我会使用它而不是 JavaScript，因为大多数脚本语言都有更好的时间/日期格式选项。在 PHP 中，您可以执行以下操作：

```
<input id="date" name="date" value="<?php echo date("M j, Y - g:i"); ?>"/> 
```

这将用“2009 年 6 月 16 日 - 8:58”填充该字段

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-07-26T07:07:46.797

如果您使用 HTML5 日期

使用此代码

**HTML**

```
<input type="date" name="bday" id="start_date"/> 
```

**Java 脚本**

```
document.getElementById('start_date').value = Date(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-06-16T14:47:37.840

```
<input id="date" name="date" />
<script type="text/javascript">
document.getElementById("date").value = new Date();
</script> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-03-25T01:16:23.447

另一种选择是：

```
<script language="JavaScript" type="text/javascript"> 
document.getElementById("my_date:box").value = ( Stamp.getDate()+"/"+(Stamp.getMonth() + 1)+"/"+(Stamp.getYear()) );
</script> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-06-30T08:51:16.487

```
var date = new Date();

document.getElementById("date").value = date.getFullYear() + "-" + (date.getMonth()<10?'0':'') + (date.getMonth() + 1) + "-" + (date.getDate()<10?'0':'') + date.getDate();

document.getElementById("hour").value = (date.getHours()<10?'0':'') + date.getHours()  + ":" + (date.getMinutes()<10?'0':'') + date.getMinutes(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-02-20T15:55:44.257

我不是不知道所有的技术语言，但我无法在任何地方找到答案，所以我想出了这个并且它有效......祝你好运！

```
$time = date("Y/m/d h:i:s");

$sql = "INSERT INTO *yourtablenamehere* ('dt')  VALUES ('$time')"; 
```

# vxml - 在 VXML 中传递子对话框参数

> ID：1001939
> 
> 赞同：1
> 
> 时间：2009-06-16T14:43:04.603
> 
> 标签：vxml

我正在创建另一个供应商正在调用的子对话框。我无法读取从该供应商传递到我的子对话框的值。当我自己从另一个vxml浏览器调用子对话框时，我可以读取传入的参数，所以我倾向于认为其他供应商传递错误。但是，我无法在 w3c 规范中找到有关该数据如何真正传递的任何细节。当 IIS 从我正在使用的语音浏览器发布我的页面时，我没有看到参数被指定为查询字符串的一部分。但是，当这个其他供应商的浏览器请求我的子对话框时，我会在查询字符串中看到参数，并且值不会显示在相应的 's. 这让我相信他们错误地传递了变量。有没有什么地方可以详细了解这个过程是如何工作的？我如何确认这些值实际上没有被传递？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-07-02T12:53:32.243

子对话框元素可用于转换到同一文档或外部文档中的表单。由于您表明您正在与第三方合作，因此我将假设子对话框是您文档中的外部表单。

子对话框通过 HTTP 请求传递参数。如果子对话框的方法属性是 GET 或未设置，它们将是 URL 上的参数。如果是发布的，它们将嵌入到请求中。如果您正在创建标准 servlet/jsp，您应该能够像从任何 Web 应用程序中一样获取这些参数。

您可能已经注意到，VoiceXML 规范在很多细节上都有些薄弱。可能会导致您遇到问题的一个特定问题是复杂对象（ECMAScript 对象）的传递方式。有些浏览器不会传递它们，有些会转换为 xyz=42 等文本参数，有些会转换为 JSON 字符串。我建议保持传递原始变量。

关于对象传递的主题，您可能会在浏览器中发现在文档内转换与转换到另一个文档时的不同行为。

一些快速检查：

*   查看供应商是否有演示参数传递的示例应用程序
*   确认您使用的是供应商用来验证其应用程序的浏览器。

# java - 更改构造函数参数类型会破坏另一个 jar 中的类

> ID：1001940
> 
> 赞同：3
> 
> 时间：2009-06-16T14:43:07.880
> 
> 标签：java, binding, parameters, constructor, binary-compatibility

我在一个普通的 jar 中有以下类：

```
public class Common 
{
  public Common(List list)
  {
    ...  
  }  
} 
```

然后我将构造函数参数从 a 更改`List`为 a `Collection`，如下所示：

```
public class Common 
{
  public Common(Collection collection)
  {
    ...
  }
} 
```

重建公共 jar 并运行系统`NoSuchMethodError`在调用构造函数时会在任何依赖类中导致 a，直到我重新编译该类。

我有一些想法是什么导致了这种情况，就像构造函数如何绑定在依赖类的字节码中一样，但我不是 100% 确定。

请问有人可以解释一下这里发生了什么吗？

## 更新

我随后做了一个快速测试并查看了字节码：

```
Compiled from "Client.java"
public class Client extends java.lang.Object{
public Client();
  Code:
   0:   aload_0
   1:   invokespecial   #1; //Method java/lang/Object."<init>":()V
   4:   return

public static void main(java.lang.String[]);
  Code:
   0:   new #2; //class ArrayList
   3:   dup
   4:   invokespecial   #3; //Method java/util/ArrayList."<init>":()V
   7:   astore_1
   8:   new #4; //class Common
   11:  dup
   12:  aload_1
   13:  invokespecial   #5; //Method Common."<init>":(Ljava/util/List;)V
   16:  pop
   17:  return

} 
```

正如 Tom 所说，正如您在第 13 行所见，确切的构造函数是在编译时绑定的。

你每天学习新的东西 ：-）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-06-16T14:58:03.793

javac 准确解析在编译时调用哪个方法或构造函数。这不会在链接时发生。由于构造函数签名已更改，链接步骤无法找到请求的方法，因此会引发错误。您可以通过提供给构造函数来修复错误 - 一个接受`Collection`另一个`List`。稍后`Iterable`可以添加一个采用 an 的构造函数。

请注意，泛型类型不构成签名的一部分，因此可以在保持二进制兼容性的同时更改它们。参数和返回类型都构成方法签名的一部分（协变返回导致创建合成桥方法）。

JLS 中有一个[很好的部分](http://java.sun.com/docs/books/jls/third_edition/html/binaryComp.html)准确定义了二进制兼容更改的构成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T14:46:44.597

您是否导入了正确的 List 和 Collection 类？即`java.util.List`和`java.util.Collection`？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-06-16T14:51:23.557

我认为这可能是库版本的问题。您确定在同一上下文中的其他地方没有另一个版本的公共库吗？

# android - Android远程代码加载

> ID：1001944
> 
> 赞同：16
> 
> 时间：2009-06-16T14:43:36.507
> 
> 标签：android, auto-update

我正在开发一个需要从中央服务器频繁更新的 Android 库。我在想，如果我的库可以自我更新，或者我可以发布一个引导库，在安装应用程序时下载目标库，那该多好。

我在 1.5 中看到了这个名为“DexClassLoader”的类，但除了 API 文档之外，网络上似乎很少有宝贵的东西。有没有人成功地将它用于我描述的场景？

另外，Android Market 的条款是否允许这样的事情？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2010-02-24T12:46:27.663

我已经成功使用[了 DexClassLoader](http://developer.android.com/reference/dalvik/system/DexClassLoader.html)。重要的是提供一个`dexOutputDir`实际上可由您的应用程序编写的，所以**不是** `/data/dalvik-cache`. 否则，日志将显示一两行关于未能在此处写入的信息，然后是`ClassNotFoundException`.

```
cl = new DexClassLoader("/full/path/com.example.apk",
                        getFilesDir().getAbsolutePath(),// /data/data/foo/files
                        null,  // native lib path, I haven't used this
                        MyClass.class.getClassLoader());
// This doesn't make Class.forName() work, instead I do this:
Class<?> foo = cl.loadClass("com.example.foo"); 
```

为了`Class.forName()`工作，您可以尝试[Thread.setContextClassLoader()](http://developer.android.com/reference/java/lang/Thread.html#setContextClassLoader(java.lang.ClassLoader))（我没有）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T22:54:34.190

确实，您想要的东西得到支持并且有效。**DexClassLoader**对我来说没有按预期工作，但以下代码工作正常。

```
DexFile df = new DexFile(new File("/data/app/my_downloaded_lib.apk"));
ClassLoader cl = getClassLoader();
Class clazz = df.loadClass("com/my/lib/MyClass", cl); 
```

关于市场问题，我认为这没有任何问题，但您必须阅读 EULA 才能确定。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-03-15T19:55:35.380

`DexClassLoader`是正确的答案。应用程序永远不应该`DexFile`直接使用（它应该由类加载器使用）。

您可以将外部存储 ( `/sdcard`) 或应用程序的私有数据区域用于`dexOutputDir`参数。外部存储通常较大，但如果卡被弹出，您的应用程序将被终止，并且由于缺乏文件权限强制执行，第三方很容易替换您的代码。这可能允许恶意应用程序导致您的应用程序执行任意操作。（如果你想这样做，通过`Environment.getExternalStorageDirectory()`; 获取路径需要`WRITE_EXTERNAL_STORAGE`许可。）

应用程序私有数据区（从 获取路径`Context.getFilesDir()`）更安全，并且还具有在卸载应用程序时自动清理的优点。这是推荐的方法。

# c# - 使用因消息类型而异的处理资源来使用队列的消息

> ID：1001955
> 
> 赞同：0
> 
> 时间：2009-06-16T14:44:54.537
> 
> 标签：c#, .net, algorithm, queue, message-queue

我在为异步队列消费者线程组合算法时遇到了一些麻烦，即从单个队列中读取需要分派以执行长时间运行（至少几秒钟）工作的项目。

基本上队列可以如下所示：A，A，A，A，A，B，B，A，B，A，A，A，A，A，C，B，A。

IE。A 消息比其他消息更常见。

我们的系统对每种不同的消息类型都有不同的并发值，例如我们一次只能执行 3 x A 消息，但我们可以同时执行 5 x B 和 4 x C 消息。

我当前的（损坏的）算法是让一个线程从队列的前面读取并将每个作业分派到线程池，每个作业的主体在执行实际有效负载之前等待足够的资源可用。

这意味着如果足够多的 A 消息首先到达，那么它们可以“填满”线程池的队列，并且 B+C 消息的饥饿时间比需要的时间长得多。

到目前为止，我已经考虑为每种消息类型（类型数量相当少）设置一个单独的线程池，但我担心保留这么多线程的效率。

关于如何改进这一点的任何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-06-16T14:48:50.940

为什么不让您的单个调度员根据消息的类型分派到单独的队列。因此，您总共有 4 个调度程序，第一个将消息发送到其他三个队列。

然后，您有单独的队列阅读器，它们根据自己的规则将消息从队列中拉出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-16T15:05:28.567

首先，以下假设是否有效？

*   作业实际执行的顺序无关紧要。
*   队列只是一种记录要承担的工作的机制。
*   工作都是独立的。
*   总是有多个作业等待处理。

如果是这种情况，那么我认为这是作业车间调度问题的一个示例。我认为这些通常是使用装箱算法建模的——谷歌搜索上述主题应该会找到很多参考资料。

很可能是因为您的约束非常简单，所以背包打包算法比 bin 打包更适合，只需为背包问题做一个谷歌。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T14:50:15.540

我不确定每种消息类型都有一个单独的线程池是否很糟糕。你只需要这样做，看看会发生什么。

至于替代方案，您可以围绕线程池创建一个包装器并实现优先级队列（[http://en.wikipedia.org/wiki/Priority_queue](http://en.wikipedia.org/wiki/Priority_queue)）。这种隐含性将为某些消息分配优先级。在您的情况下，由于 C 是最不常见的，它总是可以优先考虑 C。我认为你说对了。

# boost-build - 在 gentoo 上提升构建 site-config.jam

> ID：1001957
> 
> 赞同：4
> 
> 时间：2009-06-16T14:45:08.327
> 
> 标签：boost-build

我在我的项目中使用 boost build，现在我想使用 boost date_time。我用谷歌搜索并发现它应该（可能）以这种方式使用：

```
exe test : test.cpp /boost/date_time//date_time ; 
```

但后来我收到这条消息：

```
error: Unable to find file or target named
error:     '/boost/date_time//date_time'
error: referred from project at
error:     '.' 
```

（当我`-lboost_date_time`手动用作 gcc 标志时，它可以正常工作）我认为必须将库 oly 添加到 site-config.jam，所以我尝试添加：

```
project /boost/date_time ;
lib date_time ; 
```

但它没有效果。

我究竟做错了什么？

塔克斯

编辑：我不是在寻找一个可行的解决方案。我需要一些对正确安装 boost.build 和 boost 库的人都有效的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-21T16:58:37.753

我建议您查看当前版本的 Boost.Build 中的 contrib/boost.jam 模块。它允许您几乎自动地为每个库声明必要的目标。

或者最初的尝试并不完全正确。要让“/site-config//boost_date_time”正常工作，您需要在 site-config.jam 中有这个：

```
project site-config ;
searched-lib boost_date_time ; 
```

如果库文件被命名为 libboost_date_time.so（如果 Boost 是使用 --layout=system 构建的就是这种情况），这将在 Linux 上工作。在 Windows 上，由于自动链接，您实际上不需要任何这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-21T04:35:16.143

我在提升构建方面没有大量经验，但我相信您在站点配置中的规范已关闭（请参见[此处](http://www.boost.org/doc/tools/build/doc/html/bbv2/recipies/site-config.html)和[此处](http://www.boost.org/doc/tools/build/doc/html/bbv2/tutorial/prebuilt.html)）。如果您尝试在您的站点配置中放置一个预建的 boost_date_time，那么它应该是：

```
project site-config ;
lib b_date_time : : <name>boost_date_time ; 
```

在您的目录中：

```
exe test : test.cpp /site-config//b_date_time ; 
```

# events - 用于检查 Flex 中是否已编辑任何组件的全局标志

> ID：1001959
> 
> 赞同：0
> 
> 时间：2009-06-16T14:45:50.777
> 
> 标签：events, flex3, variables, global

我需要使用全局标志。每当我更改我的数据网格（即添加/更新行、更改复选框、单选按钮等）时，都会设置此标志。此外，可以在什么事件上设置此全局变量。将“change()”或“click()”工作。在这种情况下需要一些想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-11-07T20:58:29.900

从它的声音来看，您不想向数据网格添加任何事件。

您实际上想听它的 dataProvider。

我假设您使用 ArrayCollection 作为 dataProvider。您需要在 COLLECTION_CHANGE 上将 eventListener 添加到 arrayCollection（有关详细信息，请参见[此处](http://livedocs.adobe.com/flex/3/langref/mx/collections/ListCollectionView.html#event:collectionChange)）。

然后，您可以在每次调度该事件时更新您的全局标志。

# login-control - 在没有数据库的情况下阻止重复登录请求的最佳方法？

> ID：1001963
> 
> 赞同：1
> 
> 时间：2009-06-16T14:46:10.777
> 
> 标签：login-control, login-attempts

我正在尝试为我们的一个面向公众的网站编写改进的密码重置功能，除了更好的验证码之外，我还想标记一个用户名，该用户名在 y 分钟内尝试登录但未成功 x 次。第一个想法是拥有一个记录每次尝试的数据库，然后在该时间的最大尝试次数之后 - 我们只需锁定帐户，直到收到员工经理的电话以重置它。

什么是不需要通过 SQL 持久化的更好方法。（Cookie/其他东西？）如果不存在，我该如何使用更清洁的方法来做到这一点？*由于某种原因，我今天的大脑是满的*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T14:48:49.227

检查有关限制它们的答案。
[限制登录尝试](https://stackoverflow.com/questions/570160/throttling-login-attempts)

如果你好奇的话，Jeff Atwood 有一篇关于这个主题的有趣的博客文章。
[http://www.codinghorror.com/blog/archives/001206.html](http://www.codinghorror.com/blog/archives/001206.html)

将它们存储在数据库中可能会变得乏味，并且您最终会担心登录尝试失败会导致表泛滥。此外，在用户的机器上存储一些控制它的东西也很棘手，因为他们可以控制他们机器上的所有文件，并且他们可以轻松地重置您的失败登录计数器，或者更糟糕的是，将错误/恶意数据发回给您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-16T14:50:36.257

使用 cookie 或会话会很糟糕，因为用户可以通过清除 cookie 来清除他们的登录尝试。也许使用临时目录中的文件来存储登录尝试是合适的？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T14:52:44.087

好吧，cookie 对攻击者没有用（他们只会删除 cookie 或不将其发送给您）。如果你有内存中的应用程序状态，你也许可以使用它，但你必须非常小心，因为这样做可能会导致你很快填满你的内存，此外还会遇到由于并发性和锁定。即使这可能不适用于在许多不同服务器上运行的应用程序，因为该应用程序状态可能不会在这些服务器之间共享。为什么您认为将数据存储在数据库中是一个坏主意？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T14:56:38.460

您可以使用数据库，使用 memcache 并设置一个 cron 作业来定期转储表。您也可以使用 cookie 或会话变量，但出于安全原因，我不会依赖这些。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-06-16T15:05:59.737

请注意，破解者的目标可能不是访问您的系统，而是使其对每个人都无法使用。他也许可以通过自愿使用虚假凭据登录来阻止某些用户访问您的站点来实现这一点！我认为如果没有数据库，您将找不到任何适当的解决方案。

# c# - 如何确定对象是否被锁定？C＃

> ID：1001967
> 
> 赞同：5
> 
> 时间：2009-06-16T14:46:34.410
> 
> 标签：c#, design-patterns, locking

我的密码有锁。
我有两个线程同时运行。如何判断线程是否锁定了该对象？

```
private readonly object _lockObject = new Object();

// Both methods running
public void Method1()
{
    if(certainCriteria)
    {
        lock(_lockObject)
        {
        //doWork;
        }
    }
}

// Both methods running
public void Method2()
{
    if( isLocked?(_lockObject))
    {
        //doWork;
    }
} 
```

有人拿到isLocked吗？方法？

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-06-16T14:48:19.133

您*可以*使用[`Monitor.TryEnter`](http://msdn.microsoft.com/en-us/library/system.threading.monitor.tryenter.aspx)（超时为 0，或者根本不超时的重载），然后[`Monitor.Exit`](http://msdn.microsoft.com/en-us/library/system.threading.monitor.exit.aspx)在成功时立即调用 - 但我会说这通常是一种糟糕的设计气味。特别是，一旦您返回数据，数据就会过时。

你想达到什么目的？

# sql - SQL Server 批量插入

> ID：1001971
> 
> 赞同：4
> 
> 时间：2009-06-16T14:47:13.817
> 
> 标签：sql, sql-server, bulkinsert

我想将一列文本文件导入到我的一个 sql 表中。该文件只是一个脏话列表。

我编写了以下 TSQL 来执行此操作

```
BULK INSERT SwearWords
FROM 'c:\swears.txt'
WITH
(
FIELDTERMINATOR = ',',
ROWTERMINATOR = '\n'
) 
```

但是，它会因文件意外结束而出错。我要导入的表只是一个身份字段，后跟一个我想插入文本的 nvarchar 字段。如果我将文本文件“1”添加到每一行的开头，它工作正常，我认为这是因为 SQL 如果查找 2 个字段。有没有办法解决？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-06-16T14:58:22.967

为此，您需要使用 FORMATFILE。请参阅[批量插入](http://msdn.microsoft.com/en-us/library/aa225968.aspx)。

> FORMATFILE [ = 'format_file_path' ]
> 
> 指定格式文件的完整路径。格式文件描述了包含使用 bcp 实用程序在同一个表或视图上创建的存储响应的数据文件。在以下情况下应使用格式文件：
> 
> ```
> * The data file contains greater or fewer columns than the table or view.
> 
> * The columns are in a different order.
> 
> * The column delimiters vary.
> 
> * There are other changes in the data format. Format files are usually created by using the bcp utility and modified with a text editor as needed. For more information, see bcp Utility. 
> ```

有关更多详细信息，请参阅[使用格式文件](http://msdn.microsoft.com/en-us/library/aa173859(SQL.80).aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T15:09:25.707

这在 KEEPIDENTITY 参数下的 BULK INSERT 在线书籍中有描述。这是说的

> KEEPIDENTITY 指定标识列的值存在于导入的文件中。如果未给出 KEEPIDENTITY，则导入的数据文件中此列的标识值将被忽略，SQL Server 会根据创建表期间指定的种子值和增量值自动分配唯一值。如果数据文件不包含表或视图中标识列的值，则使用格式文件指定导入数据时应跳过表或视图中的标识列；SQL Server 自动为列分配唯一值

因此，要么使用格式文件，要么提供一个虚拟值，并确保不使用 KEEPIDENTITY 参数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T14:57:19.160

此外，您可以仅基于 nvarchar 列在表上创建一个视图，然后将 BULK INSERT 插入到您的视图中。这是使用 BULK INSERT 的一种非常简洁的方式。

这样您就不必担心您的 IDENTITY 列或创建格式文件。

您的 BULK INSERT 语句应如下所示：

```
BULK INSERT vw_SwearWords FROM 'c:\swearwords.txt' WITH (ROWTERMINATOR = '\n') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T14:51:04.230

您需要确保文本文件的结构与表格匹配 - 如果表格有两个字段，那么您还必须在文本文件中提供两个字段/列。

由于 SQL 表中的第一列是 IDENTITY 字段，因此您可以提供所需的任何值 - 但您必须在那里有一个值，我认为没有任何方法可以解决这个问题。

马克

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-16T14:53:55.597

检查最后一行是否有 CR/LF (\r\n)。有时这就是问题所在，有时在文件末尾有一个额外的回车。您可以使用十六进制编辑器进行检查。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-06-16T14:56:23.890

您可以删除标识列并在完成后将其放回原处。或者，如果这破坏了您的数据库关系，您可以使用 DTS 或 SSIS 进行导入（如果它是一次性导入）——更精细地控制摆弄列

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-06-27T04:54:11.953

在 SQL Server 2008 中，我发现只创建一个包含大量插入的文件，然后将其粘贴到 Management Studio 的查询窗口中，而不是与获取格式文件和批量插入文件权限相冲突更容易：

```
USE YourDB
GO
INSERT INTO MyTable (FirstCol, SecondCol)
VALUES ('First',1),
('Second',2),
('Third',3),
('Fourth',4),
('Fifth',5) 
```

[http://blog.sqlauthority.com/2008/07/02/sql-server-2008-insert-multiple-records-using-one-insert-statement-use-of-row-constructor/](http://blog.sqlauthority.com/2008/07/02/sql-server-2008-insert-multiple-records-using-one-insert-statement-use-of-row-constructor/)

# c# - 如何判断线程是否成功退出？

> ID：1001973
> 
> 赞同：3
> 
> 时间：2009-06-16T14:47:27.607
> 
> 标签：c#, multithreading, thread-state

根据[ThreadState 的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.threading.threadstate.aspx)，可以通过以下两种方式之一进入 Stopped 状态：线程退出或线程被中止。

是否有某种机制可以通过正常退出来判断线程是否已进入 Stopped 状态？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:04:43.640

线程可以通过多种方式达到 Stopped 状态：

*   它的主要方法可以退出而没有任何错误。
*   线程上未捕获的异常可以终止它。
*   另一个线程可以调用 Thread.Abort()，这将导致在该线程上引发 ThreadAbortException。

我不知道您是否希望区分所有三种状态，但如果您真正感兴趣的是线程是否成功完成，我建议使用某种共享数据结构（同步字典可以工作）线程的主循环在终止时更新。您可以使用 ThreadName 属性作为此共享字典中的键。对终止状态感兴趣的其他线程可以从该字典中读取以确定线程的最终状态。

在多看[MSDN 文档](http://msdn.microsoft.com/en-us/library/d6122999.aspx)`ThreadState`之后，您应该能够使用该属性来区分外部中止的线程。这应该设置为`ThreadState.Aborted`线程响应 Abort() 调用时。但是，除非您可以控制正在运行的线程代码，否则我认为您无法区分刚刚退出其 main 方法的线程与以异常终止的线程。

但是请记住，如果您控制*启动*线程的代码，您始终可以替换您自己的方法，该方法在内部调用运行主线程逻辑的代码并在那里注入异常检测（如上所述）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-06-16T15:33:00.120

是你要监控你的代码的线程吗？如果是这样，您可以将整个事情包装在一个类中，并在完成时引发事件或使用 WaitHandle（我将使用 ManualResetEvent）来表示完成。-- 完全封装后台逻辑。您还可以使用此封装来捕获异常，然后引发事件。

像这样的东西：

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace BackgroundWorker
{
    public class BackgroundWorker
    {
        /// 
        /// Raised when the task completes (you could enhance this event to return state in the event args)
        /// 
        public event EventHandler TaskCompleted;

        /// 
        /// Raised if an unhandled exception is thrown by the background worker
        /// 
        public event EventHandler BackgroundError;

        private ThreadStart BackgroundTask;
        private readonly ManualResetEvent WaitEvent = new ManualResetEvent(false);

        /// 
        /// ThreadStart is the delegate that  you want to run on your background thread.
        /// 
        /// 
        public BackgroundWorker(ThreadStart backgroundTask)
        {
            this.BackgroundTask = backgroundTask;
        }

        private Thread BackgroundThread;

        /// 
        /// Starts the background task
        /// 
        public void Start()
        {
            this.BackgroundThread = new Thread(this.ThreadTask);
            this.BackgroundThread.Start();

        }

        private void ThreadTask()
        {
            // the task that actually runs on the thread
            try
            {
                this.BackgroundTask();
                // completed only fires on successful completion
                this.OnTaskCompleted(); 
            }
            catch (Exception e)
            {
                this.OnError(e);
            }
            finally
            {
                // signal thread exit (unblock the wait method)
                this.WaitEvent.Set();
            }

        }

        private void OnTaskCompleted()
        {
            if (this.TaskCompleted != null)
                this.TaskCompleted(this, EventArgs.Empty);
        }

        private void OnError(Exception e)
        {
            if (this.BackgroundError != null)
                this.BackgroundError(this, new BackgroundWorkerErrorEventArgs(e));
        }

        /// 
        /// Blocks until the task either completes or errrors out
        /// returns false if the wait timed out.
        /// 
        /// Timeout in milliseconds, -1 for infinite
        /// 
        public bool Wait(int timeout)
        {
            return this.WaitEvent.WaitOne(timeout);
        }

    }

    public class BackgroundWorkerErrorEventArgs : System.EventArgs
    {
        public BackgroundWorkerErrorEventArgs(Exception error) { this.Error = error; }
        public Exception Error;
    }

} 

```

注意：您需要一些代码来防止 Start 被调用两次，并且您可能希望添加一个 state 属性以将状态传递给您的线程。

这是一个控制台应用程序，演示了此类的使用：

```
 using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace BackgroundWorker
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Test 1");
            BackgroundWorker worker = new BackgroundWorker(BackgroundWork);
            worker.TaskCompleted += new EventHandler(worker_TaskCompleted);
            worker.BackgroundError += new EventHandler(worker_BackgroundError);
            worker.Start();
            worker.Wait(-1);

            Console.WriteLine("Test 2");
            Console.WriteLine();

            // error case
            worker = new BackgroundWorker(BackgroundWorkWithError);
            worker.TaskCompleted += new EventHandler(worker_TaskCompleted);
            worker.BackgroundError += new EventHandler(worker_BackgroundError);
            worker.Start();
            worker.Wait(-1);

            Console.ReadLine();
        }

        static void worker_BackgroundError(object sender, BackgroundWorkerErrorEventArgs e)
        {
            Console.WriteLine("Exception: " + e.Error.Message);
        }

        private static void BackgroundWorkWithError()
        {
            throw new Exception("Foo");
        }

        static void worker_TaskCompleted(object sender, EventArgs e)
        {
            Console.WriteLine("Completed");
        }

        private static void BackgroundWork()
        {
            Console.WriteLine("Hello!");
        }
    }
} 

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-06-16T15:02:03.613

您可能想查看 BackgroundWorker 类。当线程完成时，它有一个通用的事件处理程序。在那里，您可以检查线程是否由于错误、被取消或成功完成而完成。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-06-16T15:16:24.270

假设主线程需要等待工作线程成功完成，我一般使用ManualResetEvent。或者，对于多个工作线程，来自 Parallels Extensions 的新 CountDownEvent，就像[这样](http://zvolkov.com/blog/post/2009/06/12/Parallels-Extensions-for-NET-Framework-35.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-16T22:30:19.167

我使用 a`CancellationTokenSource`要求线程优雅地退出。

然后我使用`var exitedProperly = _thread.Join(TimeSpan.FromSeconds(10);`which 等待线程退出。

如果`exitedProperly==false`，我将错误推送到日志中。

我主要在`Dispose()`函数中使用这种模式，并且我正在尝试清理我创建的任何线程。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2009-06-16T14:52:36.613

只能通过调用 Thread.Abort() 来中止线程，这会导致 ThreadAbortException，因此通过异常处理，您应该能够确定正常退出与中止退出。

# django - 我可以强制 django 模型字段的 verbose_name 的第一个字母为小写吗？

> ID：1001977
> 
> 赞同：2
> 
> 时间：2009-06-16T14:48:45.060
> 
> 标签：django, django-models

Django 自动将模型中字段的verbose_name 的第一个字母大写。我希望它是小写的。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-06-16T17:19:25.570

覆盖模板 'admin/index.html' 并更改

```
<th scope="row"><a href="{{ model.admin_url }}">{{ model.name }}</a></th> 
```

至

```
<th scope="row"><a href="{{ model.admin_url }}">{{ model.name|lower }}</a></th> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-17T12:53:23.150

我将要使用的一个可行但有点笨拙的解决方案是将我的 verbose_name 字符串的第一个字符设置为 unicode 零宽度空间 (\u200B)。

# asp.net - ASP.Net 会话状态、Sharepoint、GAC 和 Bin 部署

> ID：1001984
> 
> 赞同：2
> 
> 时间：2009-06-16T14:50:21.530
> 
> 标签：asp.net, sharepoint, moss, wss, session-state

将 dll 放置在 bin 中时是否与放置在 GAC 中时相同的过程适用于会话状态？

还是在幕后发生了某种深奥的变化？

我已将测试解决方案部署到使用会话状态的共享点站点的 bin 目录中。我确保在我的 web.config 文件中配置了会话状态...

```
<add name="Session" type="System.Web.SessionState.SessionStateModule" />

enableSessionState="true" 
```

一切正常！

然后我将此项目复制到另一个解决方案中，该解决方案部署到 GAC 并在不同的共享点站点上激活。我确保在 web.config 文件中为这个不同的共享点站点打开会话状态。我浏览到使用会话状态的页面并收到此错误...</p>

*会话状态只能在 enableSessionState 设置为 true 时使用，无论是在配置文件中还是在 Page 指令中。还请确保 System.Web.SessionStateModule 或自定义会话状态模块包含在应用程序配置的 \ 部分中。*

奇妙！我可以看到的唯一区别是一个解决方案部署到 Bin 文件夹，另一个部署到 GAC。

有时我讨厌 Sharepoint。

**对此更新：**我创建了一个简单的共享点解决方案，其中一个页面部署到 GAC，该页面将一个值添加到会话变量，然后将其从会话变量读回标签控件。

我将解决方案部署到我的测试和生产站点，它在测试站点中按预期工作，但产生错误......</p>

*会话状态只能在 enableSessionState 设置为 true 时使用，无论是在配置文件中还是在 Page 指令中。还请确保 System.Web.SessionStateModule 或自定义会话状态模块包含在应用程序配置的 \ 部分中。*

在我的生产现场，为什么，为什么，为什么？

我检查并重新检查了我的 web.config 文件和中央管理员以确保启用会话状态。现在这似乎表明我的 sharepoint Web 应用程序存在问题。

**对此 2 的更新：**这是母版页！我刚刚发现通过将母版页切换到开箱即用的选项可以让我的代码正确运行 - 它使用会话变量。我还注意到自定义母版页不喜欢“autoeventwireup=true”页面指令。我已经在两个母版页之间进行了文本比较，并且在 Tagprefix 中看不到任何不同。我会继续找...

**更新 3** 关闭此问题并使用一些附加信息开始一个新问题可能更容易。

[这里有新问题](https://stackoverflow.com/questions/1109155/sharepoint-master-pages-and-session-state)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-04-02T14:16:36.620

您是否验证了**Sharepoint Central Administration（应用程序管理）中**是否选中了“**启用会话状态**” ？除非打开它，否则它将不起作用。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-06-19T10:50:47.087

是否有可能在 OOTB 主控上而不是您自己的主控上有一些控件？也许那里有问题。此外，您的自定义大师，是否也有自定义代码隐藏？**

# objective-c - 关于 Mac 开发的死树期刊？

> ID：1001991
> 
> 赞同：4
> 
> 时间：2009-06-16T14:51:30.233
> 
> 标签：objective-c, cocoa, xcode, macos

在被问及订阅有关 Macintosh 开发的硬拷贝期刊时，我只能想到“MacTech”。

还有其他人吗？（它们有什么好处吗？）

谢谢你的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T17:00:53.030

我不知道其他任何人，但我确实倾向于在线阅读 Mac 开发人员文章，如果有的话。更重要的是，相对小众的潜在读者群可能是没有更多 Mac 技术杂志的最大原因。

我曾考虑再次订阅 MacTech（大约 10 年前我曾短暂订阅过），但发现我最终很少阅读足以证明费用合理的杂志。[从长远来看，购买MacTech 档案 DVD](http://www.mactech.com/dvd/)更为经济，尽管它不是硬拷贝并且您无法获得最新的内容。我当然希望 MacTech.com 有一种模式，允许读者在线订阅内容，而不是收到实体杂志。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-09-03T18:31:25.987

不幸的是，我不知道除 MacTech 之外的任何印刷期刊。我已经用其他几种形式的电子媒体填补了这个空白。我知道您正在寻找印刷材料，但我将作为 Mac 开发人员传递我的一些信息满足方法。

首先，在图书方面，没有什么比[O'Reilly 的 Safari](http://safaribooksonline.com)在线图书订阅更好的了。从这里，您可以掌握所有最新的通用开发、Mac 开发和 iPhone 开发书籍。我最喜欢的 Mac 开发绝对是 Aaron Hillegass 的 Cocoa® Programming for Mac® OS X，第三版。

其次，对于相对静态的参考站点，你当然有[Apple 的开发站点](http://developer.apple.com)——但另一个很好的用户赞助参考站点是[CoocaDev](http://www.cocoadev.com/)。

第三，要获得更多动态和实时的信息，您必须关注 Apple 员工和独立软件开发人员的大量博客。那里有无数很棒的博客，但我最喜欢的一些（和活跃的）可以帮助您入门：

*   迈克·阿什的[NSBlog](http://www.mikeash.com/?page=pyblog/)
*   Bill Bumgarner[的 BBum 的 Weblog-o-mat](http://www.friday.com/bbum/)
*   马特·加拉格尔的[可可与爱](http://cocoawithlove.com)

然后，为了获得最具互动性的体验，irc 是获得快速答案并经常潜伏一些有趣信息的地方（当然也可以帮助其他人）——请访问 irc.freenode.net——以下房间是相关的：

*   # 麦克德夫

*   # macosxdev

*   # 可可开发

*   # 对象

*   # 可可

*   # iphonedev

Mac 开发人员可以获得大量重要信息！

# c# - 存储许可证详细信息

> ID：1001994
> 
> 赞同：3
> 
> 时间：2009-06-16T14:51:49.343
> 
> 标签：c#, licensing

我对许可有疑问。我正在使用 C# 应用程序。场景：用户通过邮件以文件的形式获取应用程序的许可证。他/她将许可证文件存储在桌面上。之后，他/她选择许可证并单击注册。现在应用程序已注册（许可）。几天后，如果用户从 Desktop 中删除许可文件。由于没有文件，应用程序将停止工作。我想将许可证详细信息存储在注册表或文件（秘密路径）中的某处。但是，如果该用户帐户没有足够的权限来读/写注册表或文件怎么办。哪个是好方法？大家知道还有什么方法吗？我是这个领域的新手。所以请帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-06-16T15:17:28.280

所有应用程序数据都应存储在 %appdata% 目录中。

由于您指定了 C#，以下是获取文件夹的代码：

```
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData); 
```

这将输出到以下位置： 在 XP 中：C:/Documents and Settings/*用户名*/Application Data/ 在 Vista 中：C:/Users/*用户名*/AppData/Roaming

我建议您在该目录中为您的应用程序创建一个文件夹并复制到那里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-16T16:53:54.440

Microsoft 对 Windows Vista 中的存储位置有一些建议[：应用程序认证和兼容性文档](http://blogs.msdn.com/amitava/archive/2007/07/16/certified-for-windows-vista-logo-test-case-faq-test-case-15.aspx)。

> 所以，如果它[你的程序]一直在改变共享数据（而不是代码），那么它[数据]应该在逻辑上进入 ProgramData 文件夹。如果它是个人数据，那么它可以转到用户配置文件。

我们使用许可文件并将其存储在 ProgramData\CompanyName 文件夹中。但是我们的许可证是基于每台机器的，而不是每个用户的。默认情况下，此文件夹隐藏在 Windows 中，但不受 UAC 保护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-16T15:32:18.450

正如前段时间有人告诉我的那样：“注册表是用于应用程序与系统的交互，而不是用于应用程序与用户的交互。” 我不知道这是否是看待事物的正确方式。我曾经也将用户信息存储在注册表中，但现在不再如此。将设置放入文件是更好的方法。如果你想存储序列号之类的东西，别忘了加密它们。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-16T16:27:22.837

当然，在这种情况下可能应该避免写入注册表，特别是如果可以按照您描述的方式删除、添加或更改许可证。如果许可证打算在安装后以某种方式换出或更改，最好将其写入文件。不过，我通常不建议将任何类型的关键文件或类似的数据写入桌面。我可能会将其写入应用程序本身目录中包含的文件夹中。如果有必要，请将其包含在您的应用程序安装中。