# StackOverflow 问答 11996000-11996999

# orchardcms - 如何覆盖果园 cms 博客上的导航区而不是博客文章？

> ID：11996000
> 
> 赞同：1
> 
> 时间：2012-08-16T21:54:30.900
> 
> 标签：orchardcms

如何仅在主博客页面上覆盖 Orchard 中的区域导航区域。我想单独留下博客文章页面。

我想编辑菜单（删除它），但将菜单保留在博客文章页面上。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T03:17:12.470

您只需将该菜单小部件放在仅适用于博客文章页面的层中。我认为内容类型没有内置的层规则，但您可以实现一个。请参阅 Orchard.Widget 模块中的 IRuleProvider。或者，如果您的博客帖子的 url 中有一致的内容，您可以只使用 url 规则。在小部件管理区域中有一个创建新层的链接。你的规则看起来像这样......

```
url '~/MyBlog*' 
```

然后只需将您的小部件放在该层中。

此外，如果您不希望在其中没有任何形状时呈现任何区域，请确保在您的主题中检查 Layout.cshtml 中的 Model.ZoneName 是否为空。

```
@if (Model.Navigation != null) {
  <div id="navigation">@Display(Model.Navigation)</div>
} 
```

# javascript - 通过类名和 JS 数组更改背景

> ID：11996003
> 
> 赞同：2
> 
> 时间：2012-08-16T21:54:50.733
> 
> 标签：javascript

我试图让它在它可以工作的地方工作：删除当前类（当前数组值）并添加下一个类（下一个数组值）。

本质上，就是这样。

```
 var myFunction= function (step) {
        if (lastEntered === step) {
            triggerEvent(step, "impress:stepleave");
            lastEntered = null;
 // Adding in an array of gradients 
var i;
var bg = new Aray();
bg[0] = "gradient-0";       
bg[1] = "gradient-1";       
bg[2] = "gradient-2";               
bg[3] = "gradient-3";       
bg[4] = "gradient-4";       
bg[5] = "gradient-5";                   
bg[6] = "gradient-6";       
bg[7] = "gradient-7";       
bg[8] = "gradient-8";                   

            for (i=0;i<bg.length;i++)
            {
            body.classList.add(bg[i]);
            }
        }
    }; 
```

*其中**body.classList.add("gradient-1");** 放，它改变了一次颜色，而不会破坏脚本的其余部分。*

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:17:52.743

首先，定义数组的更好做法是：

```
var bg = ["gradient-0", "gradient-1", "gradient-0", you get the idea...]; 
```

你到底想做什么？
每次调用 yourFunction 时，您的代码都会将所有 9 个类名添加到正文中。
您可以使用 classList 的 remove 方法来删​​除一个类名。
它是否取决于 className 主体应该具有的 step 的值？
你可以这样做：

```
body.className = bg[step]; 
```

这将删除 body 的所有 classNames 并给它 className bg[step];

或者，如果 body 的 classNames 与 bg 中的不同，那么您可以这样做：

```
var i = 0, len = bg.length;
for ( ; i<len; i++) {
  if (i === step) { body.classList.add(bg[i]);
  } else {
    if (body.classList.contains(bg[i]) { body.classList.remove(bg[i]); }
  }
} 
```

希望我对您有所帮助，但我不确定步骤是什么以及您的功能应该做什么；}

# sql-server-2008 - Pasting from SQL Server Management Studio to Excel concatenates columns

> ID：11996005
> 
> 赞同：35
> 
> 时间：2012-08-16T21:55:00.920
> 
> 标签：sql-server-2008, concatenation, paste

I'm trying to paste my query results from Mgmt Studio to Excel, but for whatever reason the columns in Mgmt Studio are concatenated into a single column when pasted into Excel.

This doesn't happen to any of my colleagues and we couldn't find any settings for changing this. Any ideas?

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2012-08-17T00:57:05.350

This is an issue with Excel.

After you paste the results into Excel, go to the "data" option and choose "Text to Columns". Then click on "delimited" and be sure that "tab" is checked on the next window.

This will convert the data into columns. And, Excel remembers the settings, so it will paste correctly the next time.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-07-15T08:55:11.247

I had the exact same problem. Yesterday it worked, but today it just pasted everything into the first column as text. Used to automatically be pasted from the Management Studio columns into Excel columns.

It's Excel. It remembers your text-to-column choices from last time you used the function in Excel and applies them automatically next time you copy-paste.

You can indeed just use the text-to-columns function again with tabs selected as delimiter. Then after that this choice is remembered and stored in Excel. Now if you copy from Management Studio again and paste it will snap into the columns as expected.

Seems it's one of those instances where Excel tries to help you but ends up being a bit annoying :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-05T01:38:16.870

I have solved this problem in my SSMSBoost add-in for SSMS: it has possibility to export grid as native OpenXMLSpreadsheet, which can be easily "understood" by excel. As "bonus" to solution of your problem you will also see that even datatypes are preserved, so no problems anymore with conversion of dates to text or text to numbers... Check it out.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-01T16:04:10.373

I get this too and in the past i would shut down excel. I realized after a while that every day i do text to columns for a specific spreadsheet and i change the delimiter to other /. When i change it back to tab, it works fine.

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-10-17T19:38:44.723

I ran into the same issue. I was able to get my results to a CSV using the following solution:

1.  Execute query
2.  Right click in the top left corner of the results grid
3.  Select "Save Results as.."
4.  Choose csv and viola!

# android - 在 Afreechart 中画线下的区域

> ID：11996006
> 
> 赞同：0
> 
> 时间：2012-08-16T21:55:15.407
> 
> 标签：android, jfreechart

是否可以在 Android 的 afreechart（版本 0.0.4）的折线图下绘制区域（甚至可能带有渐变）？我想要一个类似于 Jfreechart 中的面积图的结果。

/马库斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T16:33:28.223

我发现最简单的方法是使用 XYDifferenceRenderer。您必须添加第二个时间序列，并将所有值设置为 0 或图表上的任何最小值，即这些值必须在 x 轴上。XYDifferenceRenderer 将简单地突出显示线条之间的区域。

# php - 与规则具有相同文件名的永久链接重写

> ID：11996011
> 
> 赞同：2
> 
> 时间：2012-08-16T21:55:33.597
> 
> 标签：php, macos, apache, mod-rewrite, permalinks

我正在使用 Mac OSX Lion 和本机 apache，php5 安装重写引擎仍在工作仍然存在问题，这个问题比解释的更好，所以我在下面有这 2 个规则，一个有效，另一个无效：

```
RewriteRule ^imovel/([a-z_A-Z0-9_-]+)/([a-z_A-Z0-9_-]+)/([a-z_A-Z0-9_-]+)/$ /imovel.php?imovel=$1 
```

这条规则有效，它转到文件 imovel.php，但它不传递变量，所以如果我将这个 ^imovel/ 更改为 ^blerg/ 之类的其他任何东西，效果很好，如下所示

```
RewriteRule ^blerg/([a-z_A-Z0-9_-]+)/([a-z_A-Z0-9_-]+)/([a-z_A-Z0-9_-]+)/$ /imovel.php?imovel=$1 
```

此规则工作正常，但此问题仅在我使用的 mac 上显示。在 Windows 7 上使用这些相同的规则可以正常工作。我需要在 apache 中进行任何配置来更改它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T16:18:56.307

从[这个问题](https://serverfault.com/questions/57243/apache-mod-rewrite-fails-when-file-by-same-name-exists)：

> 你 [`mod_negotiation`](http://httpd.apache.org/docs/2.2/mod/mod_negotiation.html) 安装了吗？如果是这样，那将接受您的新请求，并尝试找出您真正要发送的文件。确保你没有 `Options MultiViews`设置。所以，在`.htaccess`put`Options -MultiViews`中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-07T09:50:40.003

您的站点必须`MultiViews`启用。如果是这样，`/imovel.php`将通过输入加载`/imovel`，因此，它正在加载`/imovel.php`而不是您的重写代码。但是删除`MultiViews`你将消除这个问题。

为了解决这个问题，我必须使用终端在我的文件或文件下的文件`httpd.conf`中`vhost.conf`添加`user.conf`几行代码。`<Directory "/Users/User/Sites">`

```
sudo nano /etc/apache2/httpd.conf
sudo nano /etc/apache2/users/user.conf
sudo nano /private/etc/apache2/extra/httpd-vhosts.conf 
```

我不知道在哪里可以在 lion 中找到这些文件，但在 mac osx maverick 中，它位于 中`/etc/apache2/`，但它现在并且将在 Apache2 文件夹中，并且在这个文件中，上面的哪个文件都有你的站点目录，我的代码不得不`MultiViews`从`options`. `/Users/User/Sites`是我自己的文件夹，所以忽略它并查找您自己的站点文件夹。

```
<Directory "/Users/User/Sites">
    Options Indexes FollowSymLinks SymLinksifOwnerMatch MultiViews
    AllowOverride All
    Order allow,deny
    Allow from all
</Directory> 
```

所以现在看起来像这样

```
<Directory "/Users/User/Sites">
    Options Indexes FollowSymLinks SymLinksifOwnerMatch
    AllowOverride All
    Order allow,deny
    Allow from all
</Directory> 
```

一旦我这样做了，/index.php 页面就不能再通过键入 /index 来加载。因此，我可以使用我最初在 .htaccess 文件中使用的代码。一切都在天堂里解决了。

让我知道这是否有帮助。

# c# - 摩托罗拉设备的 DrawingCache 奇怪行为

> ID：11996013
> 
> 赞同：2
> 
> 时间：2012-08-16T21:55:49.377
> 
> 标签：c#, java, android, bitmap, xamarin.android

我在一些摩托罗拉设备上遇到了一个奇怪的问题，我得到一个`Bitmap`在`ImageView`. 这是为 android 4.2.4 以单声道编程的。

基本上我的问题是`DrawingCache`在某些设备上返回 null，即摩托罗拉设备。我已经四处寻找解决方案，但建议的方法都没有奏效。我只是不明白为什么这适用于某些设备而不适用于其他设备？

我可以使用 拉出整个图像`ImageView.Drawable`，但是缺少对其进行的所有操作，因此这并不是真正需要的。

有人对为什么会发生这种情况或可能的解决方法有任何建议吗？

```
 try
        {
            //pictureView is an ImageView
            pictureView.DrawingCacheEnabled = true;
            using (var bmp = pictureView.DrawingCache)
            {
                if (bmp != null)
                {

                }
            }
        }
        finally
        {
            _pictureView.DrawingCacheEnabled = false;
        } 
```

我们的应用程序是用 Mono for Android 编写的，但欢迎使用 Java 回答。

更新：我创建了一个 android 应用程序来显示我遇到的问题。[我正在使用的](https://github.com/MikeOrtiz/TouchImageView)开源项目是允许用户放大图像。使用摩托罗拉模拟器无法显示位图，而 x86 模拟器在显示位图时工作正常。

```
public class TouchImageViewActivity extends Activity implements OnClickListener{
/** Called when the activity is first created. */
Button mButton;
TouchImageView mImage;
ImageView mImageView;
Bitmap mBmp;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

   // ImageView img = new ImageView(this);
    Bitmap snoop = BitmapFactory.decodeResource(getResources(), R.drawable.snoopy);
    setContentView(R.layout.main);
    mButton = (Button)findViewById(R.id.button1);
    mButton.setOnClickListener(this);

    mImage = (TouchImageView)findViewById(R.id.imageButton1);
    mImage.setImageBitmap(snoop);
    mImage.setMaxZoom(4f);

    mImageView = (ImageView)findViewById(R.id.imageView1);
}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    if(v.getId() == mButton.getId())
    {
        try
        {
            mImage.setDrawingCacheEnabled(true);

            mBmp = mImage.getDrawingCache(false);

            if(mBmp != null && !mBmp.isRecycled())
            {
                Toast toast = Toast.makeText(v.getContext(), "BITMAP NOT NULL! ZOMG", Toast.LENGTH_LONG);
                toast.show();
                mImageView.setImageBitmap(mBmp);
                mImageView.invalidate();
            }
            else
            {
                Toast toast = Toast.makeText(v.getContext(), "BITMAP IS NULL! BOOO", Toast.LENGTH_LONG);
                toast.show();
            }
        }
        catch(Exception exc)
        {
            Log.e("Test", exc.getMessage());
        }
    }
} 
```

}

# database - 交易和 symfony2 实体管理器

> ID：11996014
> 
> 赞同：8
> 
> 时间：2012-08-16T21:55:49.773
> 
> 标签：database, symfony, doctrine, sqltransaction

有没有一种方法可以在 symfony2 中使用实体管理器（原则）手动指定事务，或者可能是在单个事务中完成我在下面两个中所做的自然方式？

```
// creating screen object...
//Creating user object...

        //flush the screen into database in order to get the Id to relate the server (user) to
        $em->persist($screen);
        $em->flush();

        //Get id of just inserted screen and attach that to new server (user)
        $tempRecordId = $screen->getId();
        $tempEntity = $em->getRepository('BizTVContainerManagementBundle:Container')->find($tempRecordId);
        $entity->setScreen($tempEntity);

        //Flush the user also into database
        $em->persist($entity);
        $em->flush(); 
```

请参阅我必须刷新我的第一个实体才能获得它的 ID，这样我就可以将我的第二个实体与我的第一个实体联系起来......

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-17T07:20:45.937

```
try {
    $em->getConnection()->beginTransaction();

    // do your thing here

    $em->getConnection()->commit();
} catch (\Exception $e) {
    $em->getConnection()->rollback();
    throw $e;
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-16T22:24:05.427

你为什么不这样做：

```
// creating screen object...
//Creating user object...
    $entity->setScreen($screen);
    $em->persist($screen);
    $em->persist($entity);
    $em->flush(); 
```

# c - 切换 If 和 Else 不会产生相同的结果

> ID：11996016
> 
> 赞同：2
> 
> 时间：2012-08-16T21:56:02.293
> 
> 标签：c, if-statement

我一直在研究 K&R 的 The C Programming Language 中的一些示例，但是我对我在练习 1-12 中切换 if 和 else 语句所做的测试感到有点困惑。

问题如下：编写一个程序，每行打印一个单词。

所以基本上是为了测试 \n 而忽略单词之间的多个空格，我首先写了这个。

```
#include <stdio.h>

int main()
{
    int c;

    while ((c = getchar()) != EOF) {
        if (c == ' ' || c == '\t') {
            printf("\n");

        }
        else {
            putchar(c);
        }

    }
} 
```

在这一个中，它会在看到空格或制表符时打印出一个新段落，如果没有，那么它会完全复制输入。

这段代码产生了我想要的结果（好吧，输入单词之间的额外空格仍然有额外的段落，但我现在忽略了）

然后我决定看看如果在更改条件的同时切换 if 和 else 语句会发生什么，但结果却不一样。

```
#include <stdio.h>

int main()
{
    int c;

    while ((c = getchar()) != EOF) {
        if (c != ' ' || c != '\t') {
            putchar(c);
        }
        else {
            printf("\n");
        }

    }

} 
```

在这一个中，我希望它打印出不是空格或制表符的任何内容，如果不是，它将创建一个新段落。

我预计新条件会产生相同的结果。相反，它只是复制了我输入的内容。有谁知道为什么这不起作用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-16T21:57:38.070

```
 if (c != ' ' || c != '\t') { 
```

此条件检查是否*不是* `c`空格*或* `c`不是制表符。这总是正确的，因为`c`不能同时是空格和制表符。尝试：

```
 if (c != ' ' && c != '\t') { 
```

[您可以在De Morgan's Laws](https://en.wikipedia.org/wiki/De_Morgan's_laws)中更详细地了解这一原则。

另一种方法是让编译器为您执行逻辑否定：

```
 if (!(c == ' ' || c == '\t')) { 
```

`!`但是，有些人（包括我在内）会认为由于多余的括号和左侧的小括号而难以阅读。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T21:58:02.790

与以下相反：

```
if (c == ' ' || c == '\t') { 
```

（参数`c`是空格或制表符）

是：

```
if (c != ' ' && c != '\t') { 
```

（参数`c`既不是空格也不是制表符）

应`||`更改为`&&`.

# tsql - Openquery中带参数的函数

> ID：11996018
> 
> 赞同：0
> 
> 时间：2012-08-16T21:56:15.047
> 
> 标签：tsql, function, parameters, return, openquery

我正在尝试创建一个使用 OpenQuery 中的参数的函数，如下所示：

```
CREATE FUNCTION fnMyFunction (@myVar INT) RETURNS TABLE AS
    DECLARE @Query VARCHAR(2000)
SET @Query = 'SELECT * FROM OPENQUERY(myLinkedServer, ''SELECT num FROM tblMyTable WHERE
myTableNum = '+ @myVar + '  '')'

RETURN EXEC(@Query) 
```

Openquery 应该只返回一个整数。我试过了

```
...RETURNS INT AS
...OPENQUERY...
DECLARE @num INT
SET @num = 0
@num = EXEC(@Query)
RETURN @num 
```

并且 get 不能在此上下文中使用带有返回值的 RETURN 语句。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:06:04.687

我认为您不能`openquery`在函数中使用这种类型的调用 ()。

用户定义的函数不允许使用动态 SQL，这被认为是动态 SQL。

所以我相信你唯一的选择是创建一个存储过程来返回该值。或者创建一个内联临时表并在使用它之前在存储过程中使用它。

这是一篇具有[UDF 其他限制的文章](http://blog.sqlauthority.com/2007/05/29/sql-server-user-defined-functions-udf-limitations/)

您必须在使用它之前进行该调用：

```
DECLARE @Query VARCHAR(2000)
DECLARE @myVar INT
SET @myVar = yourValue

SET @Query = 'SELECT * FROM OPENQUERY(myLinkedServer, ''SELECT num FROM tblMyTable WHERE
myTableNum = '+ @myVar + '  '')'

EXEC(@Query) 
```

# java - iTextPdf：动态更改单元格宽度

> ID：11996020
> 
> 赞同：3
> 
> 时间：2012-08-16T21:56:34.490
> 
> 标签：java, itextpdf

我正在使用 iTextPdf 为 pdf 构建一个表格。每个页面将有 9 到 15 列，确切的数字直到运行时才知道。iTextPDF 非常适合在页面宽度上创建相同大小的列。但我不知道如何创建不同宽度的列。

我不能使用固定的列宽，因为我想跨越整个页面宽度。因此，当写入 9 列时，每列必然比写入 12 或 15 列时更宽。固定的是这些列宽之间的关系。举个例子，我知道 A 列的宽度总是 B 列的 75%，而 B 列的宽度总是 C 列的 50%。我可以为每一列确定这一点。

有人对如何划分页面以正确调整这些列的大小有任何想法吗？这是我正在使用的一些代码，用于创建大小相同的列。我需要其他东西接近尾声

> `cell.setColspan(1);`

更改列的宽度，但不更改为固定值。谢谢！

```
public static void newPDF() throws DocumentException, IOException {
    PdfWriter writer;
    Document document;
    int cols = 9; //can be either 9, 12, or 15
    document = new Document();
    writer = PdfWriter.getInstance(document, new FileOutputStream("test.pdf"));
    document.open();
    document.add(createTable(cols));
    document.close();
}

public static PdfPTable createTable(int cols) {
        PdfPTable table = new PdfPTable(cols);
        PdfPCell cell;

        for (int i = 0; i < cols; i++) {
            ph = selector.process("some text");
            cell = new PdfPCell(ph);
            cell.setColspan(1); //repeated 9, 12, or 15 times
            table.addCell(cell);
        }
        return table;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-16T22:50:30.910

我找到了答案。

```
float[] columnWidths = new float[] {10f, 20f, 30f, 10f};
table.setWidths(columnWidths); 
```

此代码按照括号内的值的相对比例分配列的水平空间（例如，col A 是 col b 大小的 1/2 和 col C 大小的 1/3）。

很好的例子：[http ://www.kodejava.org/examples/833.html](http://www.kodejava.org/examples/833.html)

不管怎么说，还是要谢谢你！

# asp.net-mvc - 重用数据契约作为视图模型

> ID：11996023
> 
> 赞同：1
> 
> 时间：2012-08-16T21:56:54.213
> 
> 标签：asp.net-mvc, wcf

假设您的解决方案具有以下项目：

*   核心（实体）
*   合同（DTO、服务接口）
*   服务（服务实现）
*   服务主机 (WCF)
*   客户端 (ASP.NET MVC)

客户使用合同而不是实体。MVC 项目中的每个视图都有自己独特的视图模型。MVC 项目没有实体意识。

我正在考虑将数据协定作为视图模型重用的可能性，因此我不会从服务中检索 Widget DTO 并将 Widget DTO 映射到 Widget VM，而是检索 Widget DTO 并将其直接传递给视图。

这是好事还是坏事，为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T06:16:00.143

> 这是好事还是坏事，为什么？

如果这些 DTO 严格符合您的视图的要求（这让我非常惊讶），那么，是的，使用它们而不是编写视图模型是完全可以的。

但是，如果您发现自己使用 ViewBag 是因为您的视图所需的某些属性在您的 DTO 中不存在，请立即停止！去为这个特定的视图定义一个视图模型。

# javascript - Javascript 中的引用类容器

> ID：11996025
> 
> 赞同：0
> 
> 时间：2012-08-16T21:56:57.347
> 
> 标签：javascript

我有一个带有诸如 this.pic_w、this.pic_h 等方法的 Pic 类。在该类的一个方法中，我初始化了一个 Image 对象并重写了它的一个方法。如何从 Pic 的方法之一内部但不从 Pic 继承的 Image 重新定义方法访问我的 Pic 变量（this.pic_w、this.pic_h）？以下是类变量：

```
Pic.prototype = new DaVinci();
Pic.prototype.constructor = Pic;
function Pic(canvas) {
    this.canvas = canvas;
    this.pic = "";
    this.resize_w = 200;
    this.resize_h = 200;
    this.pic_w;
    this.pic_h;
} 
```

> ...一些其他方法...

```
Pic.prototype.draw = function( img_src, pos_x, pos_y ) {
    this.setPos(pos_x,pos_y);
    this.setPic(img_src);
    var ctx = this.setWidget();
    var x = this.pos_x;
    var y = this.pos_y;
    var img = new Image();
    img.src = this.pic;
    img.onload = function() {
        // How can I access Pic class methods and variables from here?
            ctx.drawImage(img, x, y, this.width, this.height);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:11:44.950

通常这是通过在同一个闭包中保存对对象的引用来完成的。就像是：

```
Pic.prototype.draw = function( img_src, pos_x, pos_y ) {
    var that = this; //Remember "this" so you can use it later

    this.setPos(pos_x,pos_y);
    this.setPic(img_src);
    var ctx = this.setWidget();
    var x = this.pos_x;
    var y = this.pos_y;
    var img = new Image();
    img.src = this.pic;
    img.onload = function() {
        // Here I can access this.width, this.height values.
        // I want to save those values as Pic.pic_w, and Pic.pic_h
        ctx.drawImage(img, x, y, this.width, this.height);
        that.pic_w = this.width; //Now you can set the properties of "that"
        that.pic_h = this.height;
    }
    return ss;
    // END
} 
```

# iphone - 为 iPhone 生成应用文件

> ID：11996026
> 
> 赞同：0
> 
> 时间：2012-08-16T21:56:57.930
> 
> 标签：iphone, objective-c, xcode

我不确定如何为 iPhone 生成应用程序文件。我在 xcode 4.2 中开发了应用程序。我只想获取 .app 文件，这样我就可以向我的朋友展示并在移动设备上进行测试。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:05:21.863

我想一种选择是生成一个配置文件，然后按照该过程中涉及的步骤将其上传到您朋友的 iPod。

**或者[这个问题](https://stackoverflow.com/questions/1812650/how-do-you-export-your-finished-application-from-xcode)可能会帮助你。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:03:58.053

阅读“在 iOS 设备上测试您的应用程序”部分：[在 Xcode 中管理您的工作流程](https://developer.apple.com/library/ios/#referencelibrary/GettingStarted/RoadMapiOS/chapters/CreateYourAppinXcode/StartYourProjectinXcode/StartYourProjectinXcode.htmlapple_ref/doc/uid/TP40011343-TP40007593-CH2-DontLinkElementID_1#//apple_ref/doc/uid/TP40011343-TP40007593-CH2-DontLinkElementID_1)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T22:45:33.113

在存档部分阅读[它](http://www.eridenttech.com/companion-guideline-submitting-iphone-apps-to-the-apple-app-store.html/%E2%80%9CThis%22)已经提到了非常具有描述性。如果您有任何问题，请告诉我。

# java - maven/surefire 在单元测试后清理的好方法是什么，无论它们是否通过？

> ID：11996027
> 
> 赞同：2
> 
> 时间：2012-08-16T21:57:01.370
> 
> 标签：java, unit-testing, maven, surefire

我们有一些单元测试不幸地创建了内存映射的 NIO 文件，这些文件不能被创建它们的进程删除（一些 Windows 问题）。

无论如何，我想在这些测试之后进行某种清理，无论它们是否通过。我打算在*准备包*阶段运行一个小型 ant 脚本，但如果任何测试失败，surefire 会立即退出。

除了进入具有后测试阶段的**故障安全**插件之外，有没有什么聪明的方法可以运行我的清理，而不管通过或失败？

我怀疑不是 - 我已经完成了所有的**surefire**配置选项......

[编辑：不能](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4715154)在同一个进程中删除内存映射的 nio 文件，即使是 deleteOnExit。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T06:09:52.773

您应该将您想做的事情绑定到集成测试后的生命周期阶段，该阶段在集成测试阶段之后运行，该阶段由[maven-failsafe-plugin](http://maven.apache.org/plugins/maven-failsafe-plugin/)处理。如果您配置 maven-clean-plugin 这样做，它可能会起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T08:16:54.850

我会确保在`target/`操作系统的临时目录中创建文件（使用`System.getProperty("java.io.tmpdir")`. 然后在您运行时自动清理它们`mvn clean`，或者最终由操作系统清理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-17T16:18:33.590

在 pom 中添加以下依赖项并从您的 POM 中删除现有依赖项

```
 <build>
            <plugins>
                <plugin>
                    <groupId>org.springframework.boot</groupId>
                    <artifactId>spring-boot-maven-plugin</artifactId>
                </plugin>

                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-surefire-plugin</artifactId>
                    <version>2.19.1</version>
                </plugin>
            </plugins>
        </build> 
```

# java - JodaTime 日期时间格式化程序

> ID：11996028
> 
> 赞同：2
> 
> 时间：2012-08-16T21:57:03.587
> 
> 标签：java, formatting, jodatime

我有这个 sql 查询和 Java 代码：

```
 select to_char(start_date, 'DD/MM/YYYY') AS start_date FROM table

    LogServiceFactory.getInstance().logError("-------From the Db " + rs.getString("start_date"));

    LogServiceFactory.getInstance().logError("-------Formatter " + DateTime.parse(rs.getString("start_date"), formatter));

    DateTimeFormatter formatter = DateTimeFormat.forPattern("dd/MM/YYYY");

    object.setStart_date(DateTime.parse(rs.getString("start_date"), formatter)); 
```

这是我的日志文件中的内容：

2012-08-16 17:48:26 - --------来自 Db 08/08/2012

2012-08-16 17:48:26 - --------格式化程序 2012-08-08T00:00:00.000-04:00

为什么格式化程序将 08/08/2012 转换为 2012-08-08T00:00:00.000-04:00

我的假设是该日期将返回为 08/08/2012。

我没有正确使用格式化程序吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-16T22:11:29.333

我认为这会`DateTime.parse`返回一个新[`DateTime`](http://www.joda.org/joda-time/apidocs/org/joda/time/DateTime.html)对象。因此，您调用标准`toString()`方法，该方法返回[ISO 8601](https://en.wikipedia.org/wiki/ISO_8601)格式的日期模式。

您可以使用`.toString("dd/MM/yyyy")`您的日志消息。

# hibernate - Hibernate.cfg.xml 和 Grails

> ID：11996032
> 
> 赞同：0
> 
> 时间：2012-08-16T21:57:26.277
> 
> 标签：hibernate, grails, grails-orm

我正在尝试为 grails 应用程序设置默认隔离级别。

在我的 conf/app/hibernate/hibernate.cfg.xml 我有这个指定：

```
<session-factory>
<property name="hibernate.connection.isolation">4</property>
<property name="connection.isolation">4</property>
</session-factory> 
```

不幸的是，当我检查与数据源的实际连接隔离时，它仍然是 read_committed (2)。

Grails 1.3.X 不支持这个吗？

我还缺少其他东西吗？

是的，我知道我指定了两次，文档有点不清楚，并且有两种形式都在使用的现存例子......

谢谢，-克拉克，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T15:46:13.553

为了节省人们实际关注链接的麻烦：

在 DataSource.groovy 中，添加

```
properties {
    defaultTransactionIsolation = java.sql.Connection.TRANSACTION_READ_UNCOMMITTED
  } 
```

到您的 dataSource 元素，并确保**pooled=true**：

```
dataSource {
pooled = true
driverClassName = "com.ibm.db2.jcc.DB2Driver"
dialect = 'org.hibernate.dialect.DB2Dialect'
logSql = false
properties {
    defaultTransactionIsolation = java.sql.Connection.TRANSACTION_READ_UNCOMMITTED
  } 
} 
```

# python - 使用 Flask-WTForms 字段描述呈现 html 标题属性

> ID：11996033
> 
> 赞同：7
> 
> 时间：2012-08-16T21:57:28.273
> 
> 标签：python, flask, wtforms

我正在使用[Flask-WFT 文档页面](http://flask.pocoo.org/docs/patterns/wtforms/) 上提供的 render_field 宏来跨不同模板呈现长格式的字段。

一个字段是这样定义的

```
year_built = IntegerField(label='Year Built', 
             description='Year built, not the year of a major renovation.',
             validators=[validators.NumberRange(
                                    min=1700,  
                                    max=2012, 
                                    message="Between %(min)s and %(max)s")]) 
```

宏看起来像这样...

```
{% macro render_field(field) %}
  <dt>{{ field.label }}
  <dd>{{ field(**kwargs)|safe }}
  {% if field.errors %}
    <ul class=errors>
    {% for error in field.errors %}
      <li>{{ error }}</li>
    {% endfor %}
    </ul>
  {% endif %}
  </dd>
{% endmacro %} 
```

在表单本身中，各个字段使用...

```
{{ render_field(form.year_built, class="input text")}} 
```

我想不通的是一种在创建 HTML 字段的宏部分中使用字段对象中的描述的方法`field(**kwargs)`。我知道我可以将关键字传递给 render_field 函数，但我正在处理具有 100 多个字段的表单，并在 forms.py 中设置描述，然后在 template.html 中再次将其设置为标题关键字，这似乎是不必要的补充。我真的很想使用宏将描述显示为标题（如果它存在），或者仅显示没有标题的字段（如果没有）。

有没有办法`kwargs`在 field() 函数运行之前添加新条目？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-16T22:07:03.733

所以这比我想象的要容易得多......

```
{% macro render_field(field) %}
  <dt>{{ field.label }}
  <dd>{{ field(title=field.description, **kwargs)|safe }}
  {% if field.errors %}
    <ul class=errors>
    {% for error in field.errors %}
      <li>{{ error }}</li>
    {% endfor %}
    </ul>
  {% endif %}
  </dd>
{% endmacro %} 
```

# ruby-on-rails - Ruby .each 没有像预期的那样在数组中循环

> ID：11996044
> 
> 赞同：1
> 
> 时间：2012-08-16T21:58:09.260
> 
> 标签：ruby-on-rails, ruby, arrays, tags, each

Extreme Ruby/Rails 新手在这里：我正在尝试为块中包含的每个单独的帖子链接到搜索操作：

```
<% split_tags = post.tags.split(',') %> # returns ["food", "computers", "health"] %>
<p>Keywords: <%= split_tags.each {|tag| link_to(tag, front_search_tag_path(:tag => tag))}) %></p> 
```

但它返回的只是`Keywords: ["food", "computers", "health"]`. .each 不应该遍历数组并以标签作为参数提供到每个 search_tag_path 的链接吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T22:10:40.490

不，#each 只是执行一个块，它不累积任何数据。

```
[1, 2, 3].each{ |n| "Link to item #{n}" } #=> [1, 2, 3] 
```

你有两个选择，使用 map 来积累数据：

```
[1, 2, 3].map{ |n| "Link to item #{n}" }.join("\n") #=> "Link to item 1\nLink to item 2\nLink to item 3" 
```

或者直接在块中输出：

```
[1, 2, 3].each{ |n| puts "Link to item #{n}" } 
```

印刷：

```
Link to item 1
Link to item 2
Link to item 3 
```

在您的情况下，这将是以下两个选项。我更喜欢后者。

```
<p>Keywords: <%=raw split_tags.map{|tag| link_to(tag)}.join %></p>

<p> Keywords:
  <% split_tags.each do |tag| %>
    <%= link_to(tag) %>
  <% end %>
</p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:10:13.207

你可能是说

```
<% split_tags = post.tags.split(',') %> # returns ["food", "computers", "health"] %>
<p>Keywords:
  <% split_tags.each do |tag| %>
  <%= link_to(tag, front_search_tag_path(:tag => tag)) %>
  <% end %>
</p> 
```

或者

```
<% split_tags = post.tags.split(',') %> # returns ["food", "computers", "health"] %>
<p>Keywords:
  <%= split_tags.map{|tag| link_to(tag, front_search_tag_path(:tag => tag))}.join %>
</p> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T22:11:21.557

不，返回值`Array#each`是数组本身（参见[http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-each](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-each)）

您将希望使用`Array#collect`（或其别名，`map`），它将返回链接数组（请参阅[http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-map](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-map)）。然后，您可以使用连接将该数组转换为单个字符串。所以，你的代码看起来像

```
<% split_tags = post.tags.split(',') %>
<p>Keywords: <%= split_tags.collect {|tag| link_to(tag, front_search_tag_path(:tag => tag))}).join %></p> 
```

`.html_safe`但是，这可能需要`.join`. 更好的是，执行以下操作：

```
<% split_tags = post.tags.split(',') %>
<p>Keywords: 
<% split_tags.each do |tag| %>
  <%= link_to(tag, front_search_tag_path(:tag => tag)) %>
<% end %>
</p> 
```

# c# - c# 锯齿状数组bug（元素并不总是被设置）

> ID：11996050
> 
> 赞同：2
> 
> 时间：2012-08-16T21:58:31.593
> 
> 标签：c#, multithreading, nullpointerexception, jagged-arrays

我正在使用锯齿状数组来保存我正在制作的游戏中的地图段（集群）。数组中的位置对应于集群在地图中的位置。此外，如果内部数组（锯齿状部分）不再加载任何集群（集群在未使用的超时后从数组中删除），则外部数组的元素设置回 null 以保持地图的内存使用向下。

当游戏试图从地图中获取集群时，问题似乎是随机出现的：

```
public Cluster getCluster(int xIndex, int yIndex)
{
    lock (xAxis)
    {
        loadCluster(xIndex, yIndex);
        return xAxis[xIndex][yIndex];
    }
}

public void loadCluster(int xIndex, int yIndex)
{
    lock (xAxis)
    {
        if (xAxis[xIndex] == null)
            xAxis[xIndex] = new Cluster[(int)worldSize.Y];
        if (xAxis[xIndex][yIndex] == null)
            xAxis[xIndex][yIndex] = new Cluster(this, new Vector2(xIndex * 256, yIndex * 256), worldLoader.loadClusterData(xIndex, yIndex));
    }
} 
```

该`loadCluster(int, int)`方法应确保在该方法检索集群之前将其加载到数组中`getCluster(int, int)`，并且几乎始终如此，但有时会`loadCluster(int, int)`以某种方式无法添加集群。

它似乎不会发生在任何特定的集群中，但总是在未添加内部数组时发生（但是，大多数情况下它创建的内部数组完全没有问题）。`loadCluster(int, int)`此外，当 Visual Studio 捕获随后的空指针异常时，退后一步并始终（至少到目前为止）重新调用正常工作。`loadCluster(int, int)`在方法中添加额外的调用`getCluster(int, int)`也大大降低了这个错误的频率。

老实说，我不知道是什么导致这个相当简单的功能不起作用，甚至看起来是随机的。任何帮助将非常感激

编辑：编辑 xAxis[][] 的其他代码

```
public override void Update(GameTime gameTime)
{
    for (int x = 0; x < worldSize.X; x++)
    {
        if (xAxis[x] == null) continue;
        int loaded = 0;
        for (int y = 0; y < worldSize.Y; y++)
        {
            if (xAxis[x][y] == null)
            {
                continue;
            }
            xAxis[x][y].Update(gameTime);

            if (xAxis[x][y].clusterLoaded)
            {
                loaded++;
            }
            else if (xAxis[x][y].clusterTimer == 0)
            {
                xAxis[x][y] = null;
            }
        }

        if(loaded == 0) xAxis[x] = null;
    }
} 
```

`Cluster.clusterLoaded`是一个布尔值，显示集群当前是否正在使用。 `Cluster.clusterTimer`是一个倒计时的 int，一旦`clusterLoaded`变为 false。如果`clusterLoaded`再次变为真，则将其重置为最大值。每次`Cluster.Update(GameTime)`运行时减1，而`clusterLoaded`为假。 `loaded`用于统计当前内部数组加载了多少个Cluster。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T22:13:35.120

此处要更改的第一件事是修改 loadCluster 方法以直接从中返回 xAxis[xIndex][yIndex] 值。这样就不需要锁定 getCluster 方法。代码的其他部分呢？从描述来看，这似乎是一个多线程问题。尽管您已锁定 xAxis 变量，但我不知道您在其他地方还做了什么。还有一点——语言中的数组确实是一项核心功能，所以那里有一个错误真的是出乎意料的（我的意思是微软）。

# google-chrome-extension - 检测 Google Chrome 扩展的 browser_action 表单中的按钮点击

> ID：11996053
> 
> 赞同：15
> 
> 时间：2012-08-16T21:58:57.830
> 
> 标签：google-chrome-extension

如此简单的事情怎么会如此不可能？

我要做的就是单击我的扩展程序的 browser_action 按钮，打开一个带有几个设置的表单，然后单击表单上的按钮来启动一个进程。

我一生都无法在后台表单中单击按钮来工作。

我试图让[http://developer.chrome.com/extensions/contentSecurityPolicy.html#H2-3](http://developer.chrome.com/extensions/contentSecurityPolicy.html#H2-3)上的示例工作，但它没有。browser_action 和 background 的规则有区别吗？这就是我的事件监听器没有触发的原因吗？

有人可以提供一个工作示例吗？

清单.json：

```
{
    "name": "Convert",
    "version": "0.1",
    "description": "Converts the current page",
    "browser_action": {
        "default_icon": "exticon.png",
        "default_popup": "background.html"
    },
    "content_scripts": [{
        "matches": ["*://*/*"],
        "js": ["contentscript_static.js"]
    }],
    "permissions": [
        "tabs", "http://*/*", "https://*/*"
    ]
} 
```

背景.html：

```
<html>
    <head>
        <title>Converter</title>
        <script src="background.js"/>
        <script>
        // Initialize the localStorage
        if (null == localStorage["htmlImport"])
           localStorage["htmlImport"] = false;

        // Called when the user clicks on the browser action icon.
        chrome.browserAction.onClicked.addListener(function(tab) {
            console.log('in listener');
                 // execute the content script
                 chrome.tabs.executeScript(null, 
                    {
                       file: "contentscript.js",
                       allFrames: true   // It doesn't work before 4.0.266.0.
                    });
              });

        // Listen to the requests from the content script
        chrome.extension.onRequest.addListener(
              function(request, sender, sendResponse)
              {
                 switch (request.name)
                 {
                    case "getPreferences":
                       sendResponse(
                          {
                             prefIgnoreLinks : localStorage["htmlImport"]
                          });
                       break;

                    case "PressShortcut":
                       sendResponse({});  // don't response.

                       // execute the content script
                       chrome.tabs.executeScript(null, 
                          {
                             file: "contentscript.js",
                             allFrames: true   // It doesn't work before 4.0.266.0.
                          });

                       break;

                    default:
                       sendResponse({});  // don't response.
                       break;
                 }
              });

        </script>
    </head>
    <body style='min-width:250px;'>
        Link depth: <input type='text' name='depth' value='3'/><br/>
        <input type='checkbox' name='changedomain'>Include external domains</input><br/>
        <button id='beginConvert'>Convert</button>
    </body>
</html> 
```

背景.js：

```
function awesome() {
  // Do something awesome!
  console.log('awesome')
}
function totallyAwesome() {
  // do something TOTALLY awesome!
  console.log('totallyAwesome')
}

function awesomeTask() {
  awesome();
  totallyAwesome();
}

function clickHandler(e) {
  setTimeout(awesomeTask, 1000);
}
// Add event listeners once the DOM has fully loaded by listening for the
// `DOMContentLoaded` event on the document, and adding your listeners to
// specific elements when it triggers.
//document.addEventListener('DOMContentLoaded', function () {
//  document.querySelector('button').addEventListener('click', clickHandler);
//});

// Add event listeners once the DOM has fully loaded by listening for the
// DOMContentLoaded event on the document, and adding your listeners to
// specific elements when it triggers.
document.addEventListener('DOMContentLoaded', function () {
//  console.log('event listener for button connected to beginConversion()');
    //document.querySelector('button').addEventListener('click', beginConversion);
    document.getElementById('beginConvert').addEventListener('click', clickHandler);
}); 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-08-16T23:47:07.233

# 你的目标

*   点击扩展按钮
*   扩展弹出窗口与控件一起打开
*   根据扩展弹出窗口中的控件在当前选项卡上执行脚本

# 尖端

*   将背景页面视为控制中心。它从您的 Chrome 扩展程序中的各种脚本接收传入请求，具有更高的权限来执行跨域请求（如果在清单中定义）等等。
*   您应该使用[清单版本 2](http://developer.chrome.com/extensions/manifest.html#manifest_version)，因为不推荐使用版本 1。
*   Manifest 版本 2 不允许内联脚本，因此所有脚本都需要作为自己的文件加载。

* * *

# 例子

## 清单.json

```
{
    "name": "Stackoverflow Popup Example",
    "manifest_version": 2,
    "version": "0.1",
    "description": "Run process on page activated by click in extension popup",
    "browser_action": {
        "default_popup": "popup.html"
    },
    "background": {
        "scripts": ["background.js"]
    },
    "permissions": [
        "tabs", "http://*/*", "https://*/*"
    ]
} 
```

## 背景.js

```
chrome.runtime.onMessage.addListener(
    function(request, sender, sendResponse) {
        switch (request.directive) {
        case "popup-click":
            // execute the content script
            chrome.tabs.executeScript(null, { // defaults to the current tab
                file: "contentscript.js", // script to inject into page and run in sandbox
                allFrames: true // This injects script into iframes in the page and doesn't work before 4.0.266.0.
            });
            sendResponse({}); // sending back empty response to sender
            break;
        default:
            // helps debug when request directive doesn't match
            alert("Unmatched request of '" + request + "' from script to background.js from " + sender);
        }
    }
); 
```

## popup.html

```
<html>
    <head>
        <script src="popup.js"></script>
        <style type="text/css" media="screen">
            body { min-width:250px; text-align: center; }
            #click-me { font-size: 20px; }
        </style>
    </head>
    <body>
        <button id='click-me'>Click Me!</button>
    </body>
</html> 
```

## popup.js

```
function clickHandler(e) {
    chrome.runtime.sendMessage({directive: "popup-click"}, function(response) {
        this.close(); // close the popup when the background finishes processing request
    });
}

document.addEventListener('DOMContentLoaded', function () {
    document.getElementById('click-me').addEventListener('click', clickHandler);
}) 
```

## 内容脚本.js

```
console.log("chrome extension party!"); 
```

* * *

# 运行示例截图

在浏览器窗口打开到 exampley.com 的情况下单击扩展按钮

![在浏览器窗口打开到 exampley.com 的情况下单击扩展按钮](../Images/012ca04a2f88ea80ae26fcab99539adf.png)

点击“点击我！”后 扩展弹出窗口中的按钮

![点击“点击我！”后  扩展弹出窗口中的按钮](../Images/0fd0a82be278ef98140b67ce89092c4a.png)

* * *

# zip 中的示例文件

[http://mikegrace.s3.amazonaws.com/stackoverflow/detect-button-click.zip](http://mikegrace.s3.amazonaws.com/stackoverflow/detect-button-click.zip)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-15T03:05:29.730

以前的答案不再起作用，我花了几个小时才了解如何管理解决方法。我希望这能让你比我走得更快。

**首先，你是**[这个](https://developer.chrome.com/extensions/browserAction)页面中的最后一个方法（在页面底部），它是异步的，所以记得给它一个回调。您需要的代码是这样的 smtg：

```
chrome.browserAction.onClicked.addListener(function (tab) {
    chrome.tabs.query({'active': true}, getActiveTabCallback);
}); 
```

**其次**，您需要了解一件让我费时费力的事情：如果您不使用背景 html 页面，您将无法`console.log`在 Chrome 主窗口中看到任何内容。您需要转到扩展页面 ( `chrome://extensions`) 并单击您的扩展`background page`链接（是的，您没有背景页面，但 Chrome 为您提供了一个假的）。这种类型的扩展（基于事件）应该具有包含 smtg 的 manifest.json，如下所示：

```
"background": {
    "scripts": ["background.js"],
    "persistent": false
}, 
```

问候！

# java - 如何在一个会话中打开两个连接？

> ID：11996057
> 
> 赞同：0
> 
> 时间：2012-08-16T21:59:34.787
> 
> 标签：java, android, session, httpsession

我的（聊天）程序几乎立即开始一个会话，然后在一个单独的线程中它使用长轮询来保持与它的连接，直到它接收到信息。

```
while(Globals.clientIsLoggedIn) {
    ...
    response = client.execute(getRequest); // waits up to a minute for changes
    ...
} 
```

^(（全局变量是一组“全局”变量）
客户端是我的 DefaultHTTPClient)

我希望它能够同时使用相同的会话向服务器发送消息！

```
response = client.execute(postMessageRequest);

...

client.execute(logoffRequest); 
```

我知道我一定在某处遗漏了一些东西，但是为此查找文档（也许在两个不同的 HTTPConnections 之间传递会话变量？）是一个真正的熊。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-31T18:57:33.917

好的，这是我还在寻找如何*解释*我的问题的时候，更不用说回答了。我找到的解决方案在这里详细说明：

[在 Java 程序中的两个 HTTPClient 之间共享会话的好方法是什么？](https://stackoverflow.com/questions/12097216/what-is-a-good-way-to-share-a-session-between-two-httpclients-in-a-java-program)

# c# - 吞下异常时如何返回值？

> ID：11996060
> 
> 赞同：2
> 
> 时间：2012-08-16T21:59:46.457
> 
> 标签：c#, exception, exception-handling

我在我的数据类中使用以下模式捕获块：

```
} catch (OracleException e) {
    log.Error(e, e);
    ExceptionNotification.Show(e, "Platypus data not found for Platypus");
    throw;
} 
```

*（“日志”是 log4net；之后是我们花哨的异常显示对话框）。*

当我删除“抛出”时，我得到“并非所有代码路径都返回值”

如果我到达异常块，我想要返回的对象（OracleDataTable、List、Dictionary<> 或自定义类，通常可能为 null，或者充其量感觉不太好。我可以返回什么来缓解编译器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T22:01:18.683

声明返回类型的方法的每个代码路径都必须返回一个值或抛出一个异常。

如果你不想抛出，你必须返回一个合适的值

```
} catch (OracleException e) {
    log.Error(e, e);
    ExceptionNotification.Show(e, "Platypus data not found for Platypus");
    return SomeMeaningfulReturnValue;
} 
```

但是，除非您可以返回的值对调用者实际上是有意义的（而不是说返回*null*并发明“null 表示存在问题”的代码协定），否则我会坚持在出现异常时抛出异常的约定错误的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T22:34:52.613

永远不要安抚编译器。领导他们，让他们做你需要的事情，否则他们会超越自己。

编译者有顺从的性格，喜欢被老板欺负；一旦你开始安抚他们，他们就会停止帮助你。他们中的一些人甚至自带桨。

如果你必须问这个问题，你可能采取了错误的方法。“吞下异常时返回什么值”的答案是“在这个地方吞下这个异常时要返回的值是显而易见的值”。如果没有什么明显的，那么它不应该被吞下（这同样适用于“在这个地方吞下这个异常后循环中明显的地方继续”）。然后仔细检查您的假设，因为“显而易见”的事情仍然可能是错误的。

您还应该清楚地注释任何吞咽，因为这通常是一件坏事，以至于任何阅读代码的人都会从假设它是坏代码开始，除非您解释为什么不是。

您最好使用以下方法之一：

```
throw; 
```

让异常过去。有东西处理它，或者没有东西，你会收到一条错误消息和关闭（并不总是更糟糕的事情，取决于应用程序和错误的可能性）。

```
throw e; 
```

这将引发完全相同的异常（实际上是相同的实例），但会被视为来自您的代码，而不是您调用的代码。这很少是正确的事情，以至于有些人会告诉你这是完全错误的。我不同意，但我同意这种情况很少见——比如吞咽，如果这不是明显的选择，那几乎肯定是错误的选择，如果是明显的选择，它可能仍然是错误的选择。

```
throw new ExceptionTypeAppropriateToThisMethodCall("a useful message"); 
```

或者

```
throw new ExceptionTypeAppropriateToThisMethodCall("a useful message", e); 
```

在这里，您将异常转换为与您的方法提供给调用代码的服务更密切相关的东西。第二种形式包装了诊断良好的内部异常。

在某些情况下，仅仅终止应用程序或卸载应用程序域可能是最好的选择，尽管这主要是因为在任何时候都没有处理异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T22:02:20.267

你能返回什么取决于你希望你的函数在失败时做什么，或者该函数的*调用者*期望什么，比如*故障*标志。

您可以添加`return null`（考虑您的帖子），

*   首先通知调用者返回值是`null`

*   第二不要传播异常（因为这是你想要的，据我所知）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-16T22:06:32.447

好吧，您要么抛出异常，要么返回一个值。这就是编译器抱怨的原因。您需要确定哪种模式在您的特定情况下最有效，采用它并确保编写调用代码以将其考虑在内。在这种特殊情况下，我可能只会传播异常，因为您*正在*捕获异常。除非您以某种方式对 Oracle 驱动程序的不守规矩行为进行补偿，否则它可能不应该抛出异常。

“我没有找到任何数据”或类似情况不等同于“我无法登录数据库，因为密码错误”。

# php - 正则表达式仅匹配用于 phpbb 的本地 URL

> ID：11996063
> 
> 赞同：1
> 
> 时间：2012-08-16T22:00:08.457
> 
> 标签：php, regex, phpbb3

我正在使用phpBB3 制作留言板。有一个内置功能可以获取帖子中的所有 URL，然后呈现为链接。我想做到这一点，以便只有本地链接可以点击。

phpbb3 在帖子的文本上使用正则表达式，并且对于每个匹配项将其更改为一个链接：

```
if ($somestuff){
// matches a xxxx://aaaaa.bbb.cccc. ...
$magic_url_match[] = '#(^|[\n\t (>.])(' . "[a-z]$scheme*:/{2}(?:(?:[a-z0-9\-._~!$&'($inline*+,;=:@|]+|%[\dA-F]{2})+|[0-9.]+|\[[a-z0-9.]+:[a-z0-9.]+:[a-z0-9.:]+\])(?::\d*)?(?:/(?:[a-z0-9\-._~!$&'($inline*+,;=:@|]+|%[\dA-F]{2})*)*(?:\?(?:[a-z0-9\-._~!$&'($inline*+,;=:@/?|]+|%[\dA-F]{2})*)?(?:\#(?:[a-z0-9\-._~!$&'($inline*+,;=:@/?|]+|%[\dA-F]{2})*)?" . ')#ie';
$magic_url_replace[] = "make_clickable_callback(MAGIC_URL_FULL, '\$1', '\$2', '', '$class')";

// matches a "www.xxxx.yyyy[/zzzz]" kinda lazy URL thing
$magic_url_match[] = '#(^|[\n\t (>])(' . "www\.(?:[a-z0-9\-._~!$&'($inline*+,;=:@|]+|%[\dA-F]{2})+(?::\d*)?(?:/(?:[a-z0-9\-._~!$&'($inline*+,;=:@|]+|%[\dA-F]{2})*)*(?:\?(?:[a-z0-9\-._~!$&'($inline*+,;=:@/?|]+|%[\dA-F]{2})*)?(?:\#(?:[a-z0-9\-._~!$&'($inline*+,;=:@/?|]+|%[\dA-F]{2})*)?" . ')#ie';
$magic_url_replace[] = "make_clickable_callback(MAGIC_URL_WWW, '\$1', '\$2', '', '$class')";
}
return preg_replace($magic_url_match, $magic_url_replace, $text); 
```

如何重写这些正则表达式，使它们只匹配我域上的链接？此外，自学正则表达式的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T03:43:28.747

这是第一个，逐段分解。即使这样做也不是微不足道的......

```
(
    ^
|
    [\n\t (>.]
) 
```

好的，这里我们只是有“行的开头，或者在换行符，制表符，空格，大于，句点之后。只是锚定正则表达式。

```
(
    [a-z]$scheme*:/{2} 
```

这是纯粹的精神错乱。`$scheme`大概成立`http`，这意味着这个正则表达式匹配`http://`. 为什么有人会使用`/{2}`而不是`//`，我无法开始猜测。

```
 (?:
        (?:
            [a-z0-9\-._~!$&'($inline*+,;=:@|]+
        |
            %[\dA-F]{2}
        )+
    | 
```

这匹配一系列字符，大概是那些在 URL 中合法的字符。值得注意的是`$inline`PHP 变量 - 无法猜测它包含什么 - 以及第二种选择，`%[\dA-F]{2}`. 这与`%20`空格等内容相匹配。该`%`符号在匹配（或 URL）中是不合法的。

同样重要的是，这`/`是不合法的。因此，这不能引用目录，只能引用域。这很可能是您想要更改的部分，以简单地匹配您网站的相应域。

不过，为了完整起见，这里是其余的。

```
 [0-9.]+
    | 
```

或者，我们可以有一系列数字和句点——一个 IP 地址。考虑到这个正则表达式有多复杂，我很惊讶他没有去`(?:\d{1,3}\.){3}\d{1,3}`......

```
 \[
        [a-z0-9.]+
        :
        [a-z0-9.]+
        :
        [a-z0-9.:]+
        \]
    ) 
```

这是我们的最后一个选择；我认为这是针对 IPv6 的。无论如何，它是一系列用冒号分隔的十六进制数字。它要求这些在方括号内，我觉得这很奇怪，特别是对于一个如此大量使用这些标签的论坛软件......

```
 (?:
        :
        \d*
    )? 
```

在这里，我们可以选择冒号后面的一些数字。也就是说，这适用于其中包含端口的 URL。

```
 (?:
        /
        (?:
            [a-z0-9\-._~!$&'($inline*+,;=:@|]+
        |
            %[\dA-F]{2}
        )*
    )* 
```

好的，这里我们已经到了子目录，如`/`开头所示。否则，这是相同的“合法 URL 字符”匹配。

```
 (?:
        \?
        (?:
            [a-z0-9\-._~!$&'($inline*+,;=:@/?|]+
        |
            %[\dA-F]{2}
        )*
    )?
    (?:
        \#
        (?:
            [a-z0-9\-._~!$&'($inline*+,;=:@/?|]+
        |
            %[\dA-F]{2}
        )*
    )?
) 
```

最后，正在传递的东西，由`GET`指示`\?`，以及链接到页面中间锚的 URL，由 . 指示`\#`。

# 底线：

本节：

```
 [a-z]$scheme*:/{2}
    (?:
        (?:
            [a-z0-9\-._~!$&'($inline*+,;=:@|]+
        |
            %[\dA-F]{2}
        )+
    |
        [0-9.]+
    |
        \[
        [a-z0-9.]+
        :
        [a-z0-9.]+
        :
        [a-z0-9.:]+
        \]
    ) 
```

应该用这样的东西代替：

```
 [a-z]$scheme*://
    www\.example\.com 
```

或许

```
 [a-z]$scheme*://
    (?:
        www\.example\.com
    |
        192\.168\.0\.1
    |
        ::ffff:192\.168\.0\.1
    ) 
```

域和 IP 地址与您的网站匹配的位置。显然，您将不得不删除我所做的换行符和缩进。我会为您做，但我认为这几乎不值得，因为您将很难找到将您的域置于所有这些中间的位置。

您可能希望为子域包含一些正则表达式，或者忽略`www.`您的内容。

您可能还想删除它：

```
 (?:
        :
        \d*
    )? 
```

因为您可能不希望人们链接到您域上的其他端口。

第二个看起来具有大致相同的结构；正如评论所说，它只是获取缺少协议指示符的 URL。

# powershell - Powershell & Plink - 如何捕获“拒绝访问”消息

> ID：11996069
> 
> 赞同：2
> 
> 时间：2012-08-16T22:00:41.683
> 
> 标签：powershell, powershell-2.0, powershell-1.0

我在文本文件中有一个 ips 列表。该脚本读取 ips 列表并尝试连接到每个 ips。这部分正在工作。

当脚本找到对用户无权访问的 IP 时，会返回一些消息。我想捕获字符串“拒绝访问”以创建一个无权访问我的用户的 ips 列表。

```
 PS X:\PATH\USER> .\script.ps1
    XXX.XXX.XXX.XXX
    Access denied
    Access denied
    Access denied
    Access denied
    Access denied
    FATAL ERROR: Server sent disconnect message
    type 2 (protocol error):
    "Too many authentication failures for XXXX"
    Using username "XXXX".
    Access denied 
```

文件（ips.txt）内部包含：

```
 xxx.xxx.xxx.xx1
    xxx.xxx.xxx.xx2
    xxx.xxx.xxx.xx3
    xxx.xxx.xxx.xx4
    .
    .
    .
    xxx.xxx.xxx.xxn 
```

脚本.ps1

```
 $ipsarray=(get-content ips.txt)
    $size=(get-content ips.txt).Length

    Function Invoke-SSHCommands {
        Param($Hostname,$Username,$Password, $CommandArray, $PlinkAndPath, $ConnectOnceToAcceptHostKey = $true)

        $Target = $Username + '@' + $Hostname

        $plinkoptions = "-ssh $Target -pw $Password"

        $CommandArray += "exit"
        $remoteCommand = ""

        if($ConnectOnceToAcceptHostKey)
        {
            $PlinkCommand  = [string]::Format('echo y | & "{0}" {1} exit', $PlinkAndPath, $plinkoptions )
            $msg = Invoke-Expression $PlinkCommand
        }

        $PlinkCommand = [string]::Format('& "{0}" {1} "{2}"', $PlinkAndPath, $plinkoptions , $remoteCommand)
        $msg = Invoke-Expression $PlinkCommand
    }

    $PlinkAndPath = "XXXX\plink.exe"
    $Username = "XXX"
    $Password = "XXX"

    for ($i=0; $i -lt $size; $i++) {
        $Hostname=$ipsarray[$i]
        Write-Host $Hostname
        Invoke-SSHCommands -User $Username -Hostname $Hostname -Password $Password -PlinkAndPath $PlinkAndPath -CommandArray $Commands
    } 
```

嗨大卫。我将重复结构中的代码更改为

```
for ($i=0; $i -lt $tamanho; $i++) {
  $Hostname=$vetor[$i]
  Write-Host $Hostname
  $response = Invoke-SSHCommands -User $Username -Hostname $Hostname -Password $Password -PlinkAndPath $PlinkAndPath -CommandArray $Commands

  if ($null -ieq $response) {
    write-host "EMPTY"
  }
  else {
    write-host $response
  } 
} 
```

该行正在与操作系统交互。我看不到如何捕捉它返回的内容。响应被发送到终端，换句话说，不返回到脚本。

```
$response = Invoke-SSHCommands -User $Username -Hostname $Hostname -Password $Password -PlinkAndPath $PlinkAndPath -CommandArray $Commands 
```

以下条件始终为 EMPTY

```
 if ($null -ieq $response) {
    write-host "EMPTY"
  }
  else {
    write-host $response
  } 
```

我更改了 if 语句以检查变量的类型

```
if ($null -ieq $response) {
  $response.GetType().Name
  write-host "EMPTY"
} 
```

变量 $response 的结果始终为空

```
You can not call a method on a null expression.
X:\PATH\USER\script.ps1:xx caractere:xx
+     $response.GetType <<<< ().Name
+ CategoryInfo          : InvalidOperation: (GetType:String) [], RuntimeException
+ FullyQualifiedErrorId : InvokeMethodOnNull 
```

现在我决定测试变量 $msg 返回的结果是什么，并将代码行更改为：

```
$msg = Invoke-Expression $PlinkCommand
return $msg 
```

循环（for）的示例更改为测试变量 $msg 的返回。

```
for ($i=0; $i -lt $tamanho; $i++) {
  $Hostname=$vetor[$i]
  Write-Host $Hostname
  $response = Invoke-SSHCommands -User $Username -Hostname $Hostname -Password $Password -PlinkAndPath $PlinkAndPath -CommandArray $Commands

  if ($null -eq $response) {
    write-host "NULL"
  }
  else {
   write-host $response
  } 
} 
```

函数调用后 if 中显示的示例。永远不要返回“拒绝访问”

```
user@xxx.xxx.xxx.xxx's password:  user@xxx.xxx.xxx.xxx's password:  user@xxx.xxx.xxx.xxx's password:  user@xxx.xxx.xxx.xxx's password:  root@xxx.xxx.xxx.xxx's password: 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:47:05.397

我没有尝试过你的代码，但大概是你的变量捕获了响应`$msg`，所以你似乎需要在你的函数中添加一个 return 语句，例如

```
return $msg 
```

然后你需要在你的主程序中对该返回做一些事情，例如

```
for ($i=0; $i -lt $size; $i++) {
    $Hostname=$ipsarray[$i]
    Write-Host $Hostname
    $response = Invoke-SSHCommands -User $Username -Hostname $Hostname -Password $Password -   PlinkAndPath $PlinkAndPath -CommandArray $Commands
    # Do something here with $response
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-07T10:49:16.467

我有同样的问题。不幸的是，我发现：“成绩单不会捕获 EXE 的任何输出。” [这是来自https://rkeithhill.wordpress.com/2007/09/16/effective-powershell-item-7-understanding-output/](https://rkeithhill.wordpress.com/2007/09/16/effective-powershell-item-7-understanding-output/)的旧帖子，但我认为它仍然是真实的。

# hudson - Hudson/Jenkins $WORKSPACE 变量在节点上不起作用

> ID：11996079
> 
> 赞同：2
> 
> 时间：2012-08-16T22:01:47.207
> 
> 标签：hudson, jenkins, environment-variables, workspace, slave

所以我的`version.txt`源代码管理中有一个文件。我在 master 和 build 上检查它，并通过一个文件设置环境变量，文件路径为 `$WORKSPACE/Version.txt`

在 master 上，它正确地找到了 Version.txt 并设置了`MAJOR=x`等等。

当我在从节点上进行相同的构建时，使用相同的配置，我总是得到一个

```
[envfile] Reading environment variables from file.
[envfile] Path to file: /var/hudson/workspace/DEV_BUILD/Version.txt
[envfile] Can not find environment file. Path to file=[/var/hudson/workspace/DEV_BUILD/Version.txt] 
```

但我之前看到：

```
Building remotely on cent5.5_64
Cleaning the workspace because project is configured to clean the workspace before each build.
server: 192.168.1.207
[UGCS_DEV_BUILD] $ sscm get / -wreplace  -d/var/hudson/workspace/DEV_BUILD -r 
```

从 main/DEV 获取：

```
/var/hudson/workspace/DEV_BUILD/Version.txt 
```

我猜`$WORKSPACE`是指高手？任何人有任何想法如何让它在奴隶上工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T11:27:38.037

似乎 EnvFile 插件不适用于奴隶： [https ://issues.jenkins-ci.org/browse/JENKINS-9546](https://issues.jenkins-ci.org/browse/JENKINS-9546)

此外，从这个 JIRA 的评论中，他们建议使用`EnvInject`插件：[https ://wiki.jenkins-ci.org/display/JENKINS/EnvInject+Plugin](https://wiki.jenkins-ci.org/display/JENKINS/EnvInject+Plugin)

问候，

# android - Facebook 请求，最终对象状态错误

> ID：11996097
> 
> 赞同：0
> 
> 时间：2012-08-16T22:03:48.360
> 
> 标签：android, facebook

收到以下错误：

```
The method request(String, Bundle, AsyncFacebookRunner.RequestListener, Object) in the type AsyncFacebookRunner is not applicable for the arguments (String, Bundle, String, AsyncFacebookRunner) 
```

我不明白，请求中的最终对象是什么？

我有以下代码（有人可以解释一下）

```
public void UpdateStatusWithAppInfo(String AccessToken)
{
    Bundle params = new Bundle();

    params.putString("message", "Test");
    params.putString("name", "American Virgin");
    params.putString("link", "http://bit.ly/12345");
    params.putString("description", "A Freshman College Girl on a scholarship from an ...");
    params.putString("picture", "http://xxx/MOV1026.jpg");

    mAsyncRunner.request("me/feed", params, "POST", mAsyncRunner.RequestListener
    {
        public void onComplete(String response, Object state){}
        public void onIOException(IOException e, Object state){}
        public void onFileNotFoundException(FileNotFoundException e, Object state) {}
        public void onMalformedURLException(MalformedURLException e, Object state) {}
        public void onFacebookError(FacebookError e, Object state) {}
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:17:43.210

对于其他坚持这一点的人，我这样做了：

```
public void UpdateStatusWithAppInfo(String AccessToken)
{
    Bundle params = new Bundle();

    params.putString("message", "Test");
    params.putString("name", "American Virgin");
    params.putString("link", "http://www.polygonattraction.com/images/lovebirds.jpg");
    params.putString("description", "A Freshman College Girl on a scholarship from an ...");
    params.putString("picture", "http://www.polygonattraction.com/images/lovebirds.jpg");
    params.putString(Facebook.TOKEN, AccessToken);

    mAsyncRunner.request("me/feed", params, "POST", new RequestListener()
    {
        public void onComplete(String response, Object state){System.out.println(response);}
        public void onIOException(IOException e, Object state){}
        public void onFileNotFoundException(FileNotFoundException e, Object state) {}
        public void onMalformedURLException(MalformedURLException e, Object state) {}
        public void onFacebookError(FacebookError e, Object state) {}
    }, null);

} 
```

# php - 如果 CSV 文件以不同的顺序放置，我如何让 CSV Uploader 选择某些值

> ID：11996098
> 
> 赞同：1
> 
> 时间：2012-08-16T22:03:48.497
> 
> 标签：php, csv

我目前正在开发一个 CSV Uploader 项目，并且它可以正常工作，但我的问题是 - 如果客户 CSV 文件以不同方式组合在一起，我将如何选择它（名字、姓氏、电子邮件、电话等）。或者上传文件的客户是否必须按照程序的制作顺序来拥有它？

这是php代码----------------------------------------------------------

```
try {  
  # MySQL with PDO_MYSQL  
  $DBH = new PDO("mysql:host=$hostname;dbname=$database", $username, $password);  
  $DBH->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );

}  
catch(PDOException $e) { 
    echo "I'm sorry, I'm afraid I can't do that.";  
    file_put_contents('PDOErrors.txt', $e->getMessage(), FILE_APPEND);   
}

if (isset($_POST['submit'])){

    $file = $_FILES['files']['tmp_name'];   

    $handle = fopen($file , "r");

    while (($fileop = fgetcsv($handle,1000,",")) !== false)
    {
        $firstname = $fileop[0];
        $lastname = $fileop[1];
        $email = $fileop[2];
        $phone = $fileop[3];

        $insertdata = $DBH->prepare("INSERT INTO csv (firtname, lastname, email, phone) VALUES ('$firstname','$lastname','$email','$phone')");
        $insertdata->execute();
    }
    if ($insetdata){
        echo "Successfully Uploaded. Thank you.";   
    }
} 
```

感谢您的时间！

更新 - - - - - - - - - - - - - - - - - - - - - - -

新代码

```
 try {  
      # MySQL with PDO_MYSQL  
      $DBH = new PDO("mysql:host=$hostname;dbname=$database", $username, $password);  
      $DBH->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION );

    }  
    catch(PDOException $e) { 
        echo "I'm sorry, I'm afraid I can't do that.";  
        file_put_contents('PDOErrors.txt', $e->getMessage(), FILE_APPEND);   
    }

    function returnBack(){

        header("Location:http://pcgprotects.com/PCG/csvuploader/csvuploaderform.php?seterror=1");
        exit;

    }

    if (isset($_POST['submit'])){

        /*******************************GET NAME OF COLUMNS IN CSV FILE *********************************************************/
        if (empty($_POST['files'])){
            returnBack();
        }
        if (empty($_POST['firstname'])){
            returnBack();
        }
        if (empty($_POST['lastname'])){
            returnBack();
        }if (empty($_POST['email'])){
            returnBack();
        }
        if (empty($_POST['phone'])){
            returnBack();
        }
$file = $_FILES['files']['tmp_name'];   

        $handle = fopen($file , "r");
        $fileop = fgetcsv($handle,1000,",");
        $firstname_index = array_search($_POST['firstname'],$fileop);
        if (empty($firstname_index)){
            returnBack();
        }
        $lastname_index = array_search($_POST['lastname'],$fileop);
        if (empty($lastname_index)){
            returnBack();
        }
        $email_index = array_search($_POST['email'],$fileop);
        if (empty($email_index)){
            returnBack();
        }
        $phone_index = array_search($_POST['phone'],$fileop);
        if (empty($phone_index)){
            returnBack();
        }

        /***********************ASSIGN COLUMN VALUES TO ACCORDING VARIABLES AND INSERT THEN INTO CSV TABLE IN DB *************************************/

        while (($fileop = fgetcsv($handle,1000,",")) !== false)
        {
            $firstname = $fileop[$firstname_index];
            $lastname = $fileop[$lastname_index];
            $email = $fileop[$email_index];
            $phone = $fileop[$phone_index];

            $insertdata = $DBH->prepare("INSERT INTO csv (firtname, lastname, email, phone) VALUES ('$firstname','$lastname','$email','$phone')");
            $insertdata->execute();
        }
        if ($insetdata){
            echo "Successfully Uploaded. Thank you.";   
        }
    } 
```

在我的 csv 试用文件中，我使用了名为 - 名字、姓氏、电话、电子邮件的列。然后在我的表单中输入了这些值，但我被踢了回来-这是我的表单代码 -----

```
 <table width="300" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#CCCCCC">
<tr>
<form method="post" action="csvuploader.php" enctype="multipart/form-data">
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<tr>
<td colspan="3"><strong>CSV Uploader </strong></td>
</tr>
<tr>
<td>Enter Name of First Name Column </td>
<td>:</td>
<td><input name="fisrtname" type="text" ><?php 
    $setError=$_GET['seterror']; 
    if($setError == 1){
    echo "<span class='errorMsg'>Need Exact Name</span>";
    }
        ?> </td>
</tr>
<tr>
<td>Enter Name of Last Name Column </td>
<td>:</td>
<td><input name="lastname" type="text" ><?php 
    $setError=$_GET['seterror']; 
    if($setError == 1){
    echo "<span class='errorMsg'>Need Exact Name</span>";
    }
        ?></td>
</tr>
<tr>
<td>Enter Name of Email Column </td>
<td>:</td>
<td><input name="email" type="text" ><?php 
    $setError=$_GET['seterror']; 
    if($setError == 1){
    echo "<span class='errorMsg'>Need Exact Name</span>";
    }
        ?></td>
</tr>
<tr>
<td>Enter Name of Phone Number Column </td>
<td>:</td>
<td><input name="phone" type="text" ><?php 
    $setError=$_GET['seterror']; 
    if($setError == 1){
    echo "<span class='errorMsg'>Need Exact Name</span>";
    }
        ?></td>
</tr>
<tr>
<td width="294"><input type="file" name="files" /><?php 
    $setError=$_GET['seterror']; 
    if($setError == 1){
    echo "<span class='errorMsg'>Select a File</span>";
    }
        ?></td>
</tr>
<br />
<tr>
<td><input type="submit" name="submit" value="Submit" /></td>
</tr>
</table>
</td>
</form>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:06:42.230

您可以要求客户在 CSV 的开头添加一行来显示结构，例如：

```
firstname,lastname,email,phone
joe,smith,j@gmail.com,41595648855
joe2,smith2,j2@gmail.com,41595648852 
```

...

通过阅读第一行 - 您将能够知道您应该使用哪个标记与哪个索引。

```
$file = $_FILES['files']['tmp_name'];   
$handle = fopen($file , "r");
$fileop = fgetcsv($handle,1000,",");
$firstname_index = array_search("firstname",$fileop);
$lastname_index = array_search("lastname",$fileop);
...
//and then
while (($fileop = fgetcsv($handle,1000,",")) !== false)
{
  $firstname = $fileop[$firstname_index];
  $lastname = $fileop[$lastname_index];
  ... 
```

# python - python中的类错误

> ID：11996100
> 
> 赞同：0
> 
> 时间：2012-08-16T22:03:55.370
> 
> 标签：python, oop

我编写了一些直接输入解释器时可以工作的代码，但在调用时会失败。

这是一些代码（这里有很多代码可以重现）：

```
import scikits.statsmodels.api as sm
import pandas as pd
data = sm.datasets.longley.load()
df = pd.DataFrame(data.exog, columns=data.exog_name)
y = data.endog
df['intercept'] = 1.
olsresult = sm.OLS(y, df).fit()
olsresult2 = sm.OLS(y, df[['GNP', 'UNEMP', 'ARMED']]).fit()
olsresult3 = sm.OLS(y, df[['GNP', 'POP', 'ARMED', 'YEAR']]).fit()
models = [olsresult, olsresult2, olsresult3]

class generateTable(object):

    def __init__(self, output, models, center='True', parens='se', var_names=None):
        self.output = output
        self.models = models
        self.center = center
        self.parens = parens
        self.var_names = var_names

    def createModel(self):
        results = []
        for model in self.models:
            params = dict(model.params)
            bse = dict(model.bse)
            pvals = dict(model.pvalues)
            results.append(dict((k, [params[k], bse[k], pvals[k]]) for k in sorted(params.iterkeys())))

        tempModel = {}
        for key in results[0]:
            tempModel[key] = [results[0][key]]

        for model in results[1:len(results)]:
            for key in model:
                if key not in tempModel:
                    tempModel[key] = [['', '', '']]

        for i in range(1,len(results)):
            diff = set(tempModel) - set(results[i])
            for key in results[i]:
                tempModel[key].append(results[i][key])
            for key in diff:
                tempModel[key].append(['','',''])

        if self.var_names == None:
            self.inputModel = tempModel
        elif type(self.var_names) == list:
            replace = self.var_names
            newResults = []
            resultsList = sorted(tempModel.iteritems())
            for item in resultsList:
                newVar = list(item)
                newResults.append(newVar)
            for i in range(len(newResults)):
                newResults[i][0] = replace[i]
                self.inputModel = dict(newResults) 
```

每当我尝试运行脚本时，都会收到错误消息`AttributeError: 'generateTable' object has no attribute 'model'`。IPython 指出了这一点`bse = dict(model.bse)`。同样，当我以交互方式运行它时（即逐块运行，无类），这有效，但是当我导入文件并尝试运行它时，我收到错误。

**编辑：**

1）它是如何创建的？

```
import project

a = project.generateTable('/path/to/test.tex', models, center='True', parens='se', var_names=None)
a.createModel() 
```

2）整个回溯是：

```
In [26]: a.createModel()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
/path/to/project/<ipython-input-26-6774b6d1804c> in <module>()
----> 1 a.createModel()

/path/to/project/project.py in createModel(self)
     39         for model in models:
     40             params = dict(model.params)
---> 41             bse = dict(model.bse)
     42             pvals = dict(model.pvalues)
     43             results.append(dict((k, [params[k], bse[k], pvals[k]]) for k in sorted(params.iterkeys()))) 
```

3）我将尝试将 var 名称更改为`model`其他名称。

4) 抱歉语法错误。谢谢你，asmeurer，为修复。

**编辑2：**

上面的 3（将 var 名称更改为`model`其他名称）不起作用。

## 编辑 3：

现在可以了。这是最新的代码：

```
def __init__(self, output, models, center='True', parens='se', var_names=None):
    self.output = output
    self.models = models
    self.center = center
    self.parens = parens
    self.var_names = var_names

def createModel(self):
    results = []
    for test_model in self.models:
        params = dict(test_model.params)
        bse = dict(test_model.bse)
        pvals = dict(test_model.pvalues)
        results.append(dict((k, [params[k], bse.get(k), pvals.get(k)]) for k in sorted(params.iterkeys()))) 
```

唯一不同的是 for 循环中的模型已更改为 test_model。我之前尝试过，但没有成功，所以我不太确定它是如何发生的。

感谢大家的帮助！如果有人能指出为什么这个改变摆脱了那个特定的错误信息，那将不胜感激。我想真正知道我在做什么，而不是继续前进并接受它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:09:19.513

每当您看到类似 的错误`AttributeError: 'xxx' object has no attribute 'yyy'`时，这只能意味着一件事：您有一个类型的对象`xxx`并且您正在尝试访问该属性`.yyy`，但该对象没有该属性。调试的第一条规则：假设错误说的是实话。

具体地说，在某处你正在做类似的事情：

```
a = project.generateTable()
...
foo=a.model 
```

当我查看您发布的代码时，我看不到`model`为 class 定义属性的地方`generateTable`。你认为你把它设置在某个地方吗？要么你不是（这似乎是这种情况），要么你是但你是在你第一次尝试访问它之后的某个时候设置它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-16T23:16:37.820

您必须将在全局范围内定义的变量`project`称为命名空间的成员`project`。在代码中，您调用

```
import project

a = project.generateTable('/path/to/test.tex', models, center='True', parens='se', var_names=None)
a.createModel() 
```

...变量`models`没有绑定到任何东西。它是一个空值，当您调用时，对象属性不会被绑定`_init_`，并且您会得到 Python 中的 nullref 等价物。为了使用它，您需要将其编写为`project.models`. （或者你可以写`from project import models`在顶部。）

更新：抱歉，查看您的更新，错误消息和代码之间似乎存在差异。错误消息说您正在迭代“模型”而不是“self.models”。您说您之前尝试过更改变量名但没有成功；我打赌你漏掉了“self.*”限定词。这将导致您使用不同的“模型”变量。

# iphone - iOS RestKit - 收到 26 个警告？

> ID：11996105
> 
> 赞同：1
> 
> 时间：2012-08-16T22:05:02.277
> 
> 标签：iphone, objective-c, ios, warnings, restkit

我正在按照本教程 - [RestKit 教程 - Ray Wenderlich 尝试使用 RestKit](http://www.raywenderlich.com/13097/intro-to-restkit-tutorial)。

一切似乎都按预期进行，但是我收到了 26 条警告（没有错误，因此可以编译）。现在我已经完全按照教程所说的做了，所以我无法解释其中的任何一个。它们在 RestKit 框架中（小白宫标志）

知道如何解决这些问题吗？我已经重做了几次练习，但它们总是出现。他们没有出现在示例项目中。

任何帮助都会很棒。此外，所有警告似乎都不同，所以我不确定我需要发布什么代码，因为这可能是整个框架？？？

我添加了最困扰我的警告图像。我想清除这些。 ![在此处输入图像描述](../Images/35f37d97f663d6ac2532014dcf050808.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:25:55.937

我会忽略或尝试修复它们。警告虽然很重要，但并不是世界上最大的交易，如果它们在一个像 RestKit 一样常见的框架中，那么假设代码可以正常工作并继续你的一天。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:41:34.573

您是否偶然使用了 xCode 的 beta 版本和/或以 iOS SDK 6.0 为目标？我在一个项目中也注意到了这一点，它使用 xCode 4.5，针对 iOS SDK 6.0。奇怪的是，如果我使用 xCode 4.3 将项目拉到笔记本电脑上，以 iOS SDK 5.1 为目标，则警告**为零。**我求助于忽略主机上的 RestKit 警告。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-19T20:02:24.997

对于它的价值，完全相同的事情发生在我身上。然而，这是 23 次警告。它们是由 Xcode 4.3 和 Xcode 4.4.1 之间的不兼容引起的。0.10.1 版本在 4.4.1 中有很多警告，而在 4.3 中构建良好。0.10.2 的更新解决了这些问题，并且在 git master 分支中可用，但它没有发布到我下载它的网站 ( [http://reskit.org )。](http://restkit.rg)更新到 0.10.2 为我修复了警告。

# ruby-on-rails - Rails 多个动作共享一个视图

> ID：11996110
> 
> 赞同：3
> 
> 时间：2012-08-16T22:05:21.760
> 
> 标签：ruby-on-rails

我有一个 Rails 控制器，它的所有动作都共享一个相似的视图布局。我不想在几个不同的视图中复制代码，我希望所有的动作都共享同一个视图（甚至可能来自另一个控制器的动作）。

我意识到这可以通过添加`render ...`对每个操作的调用并告诉它使用相同的视图文件来完成，但是有什么方法可以将它挂钩到一组操作中并避免在每个操作中都显式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T17:12:31.833

你能更好地解释为什么布局不起作用吗？我相信这段代码应该可以解决您的问题。

假设您拥有`UsersController`并且希望所有操作，除了 new 和 create 使用相同的视图。然后你可以很容易地做到：

```
def UsersController < ApplicationController
  layout "shared_layout", except: [:new, :create]
  layout "new_user_layout", only: [:new, :create]

  def show
    # Renders in app/views/layouts/shared_layout.html.erb
  end

  def index
    # Renders in app/views/layouts/shared_layout.html.erb
  end

  def new
    # Renders in app/views/layouts/new_user_layout.html.erb
  end

  def create
    # Renders in app/views/layouts/new_user_layout.html.erb
  end
end 
```

然后，您可以创建一个布局，说明需要在共享中呈现什么。在`app/views/layouts/shared_layout.html.erb`

```
<html>
  <body>
    <%= render "shared/shared_partial_1.html.erb" %>
    <%= render "shared/shared_partial_2.html.erb" %>
    <%= render "shared/shared_partial_3.html.erb" %>
    <%= yield %>
  </body>
</html> 
```

这将为控制器的所有操作以相同的方式呈现部分 1、2 和 3。那有什么问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:35:35.097

你有几个解决方案：

`views/layout`您可以专门为这些操作创建布局。

然后，您将在控制器中设置布局：

```
class LalasController < ApplicationController
    layout "your_action_layout"
end 
```

* * *

当您提到 时，您可能正在谈论这个`render ...`，但您可以从部分创建迷你布局：

在`views/controller_names/my_layout`

```
<div class="my-layout">
    <%= yield %>
</div> 
```

然后，在你的每一个动作中，你会：

```
<%= render layout: "my_layout" do %>
    <div></div> <!-- All the code of your view -->
<% end %> 
```

# android - Android 的新代码有问题

> ID：11996116
> 
> 赞同：0
> 
> 时间：2012-08-16T22:05:36.503
> 
> 标签：android

并提前感谢您的帮助。我一直在涉足这段代码，并且我遇到的大多数错误都能够修复。不过，这让我感到困惑。我已经阅读了一堆其他关于在你的第一个应用程序中使用 android 开发代码的帖子，但我没有分享同样的问题。因为没有拼写错误，没有丢失代码，afaict。无论如何，到手头的代码。

activity_main.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" 
android:orientation="horizontal" >

<EditText android:id="@+id/edit_message"
    android:layout_weight="1"
    android:layout_width="0dp"
    android:layout_height="wrap_content"
    android:hint="@string/edit_message" />
<Button
    android:layout_width="wrap_content" 
    android:layout_height="wrap_content" 
    android:text="@string/button_send" 
    android:onClick="sendMessage" />
</LinearLayout> 
```

MainActivity.java

```
package com.example.my.first.app;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.View;
import android.widget.EditText;

public class MainActivity<View> extends Activity {
public final static String EXTRA_MESSAGE = "com.example.myfirstapp.MESSAGE";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

/**Called when the user clicks the Send button */
public void sendMessage(View view) {
    Intent intent = new Intent(this, DisplayMessageActivity.class);
    EditText editText = (EditText) findViewById(R.id.edit_message);
    String message = editText.getText().toString();
    intent.putExtra(EXTRA_MESSAGE, message);
    startActivity(intent);
    // Do something in response to button
}
}

DisplayMessageActivity.java

package com.example.my.first.app;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.widget.TextView;

public class DisplayMessageActivity extends Activity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //Get the message from the intent
    Intent intent = getIntent();
    String message = intent.getStringExtra (MainActivity.EXTRA_MESSAGE);

    // Create the text view
    TextView textView = new TextView(this);
    textView.setTextSize(40);
    textView.setText(message);

    // Set the text view as the activity layout
    setContentView(textView);
}

} 
```

AndroidManifest.xml

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.my.first.app"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name=".MainActivity"
        android:label="@string/title_activity_main" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name=".DisplayMessageActivity"
        android:label="@string/title_activity_display_message" >
        <meta-data
            android:name="android.support.PARENT_ACTIVITY"
            android:value="com.example.my.first.app.MainActivity" />
    </activity>
</application>

</manifest> 
```

现在我真的希望这只是一个简单的时刻。我在 Eclipse 中没有收到任何错误，但是当我运行 LINT 时，它会发现这个错误：

```
Corresponding method handler 'public void sendMessage(android.view.View)' not found 
```

再次感谢您在这件事上的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:29:38.590

替换`MainActivity<View>`为`MainActivity`。

# ruby-on-rails - 是否无法将 Guard 与 RubyMine 一起使用？

> ID：11996124
> 
> 赞同：53
> 
> 时间：2012-08-16T22:06:49.963
> 
> 标签：ruby-on-rails, rspec, tdd, rubymine, guard

出于某种莫名其妙的原因，RubyMine 会自动保存您所做的每一次更改，因此每次击键都会触发 Guard 运行您的测试！最可笑的是，显然没有办法禁用这个自动保存“功能”。我只是想知道，RubyMine 似乎是 Rails 开发人员中非常流行的编辑器，而 Guard 似乎是用于自动化测试的不可或缺的工具。由于 Guard 无法与 RubyMine 一起合理使用，人们如何处理使用 RubyMine 进行测试的自动化？

* * *

## 回答 #1

> 赞同：149
> 
> 时间：2012-08-17T06:27:14.283

我整天都在使用 RubyMine 和 Guard，事实上，Guard 的某些部分已经在 RubyMine 本身中开发了。

`RubyMine > Preferences`您可以通过进入菜单并`sync`在搜索框中输入来配置自动安全行为，然后`System Settings`从列表中选择。

[![配置 RubyMine 自动安全行为](../Images/1bb7855d0d51d4d4358d86636a2d8038.png)](https://i.stack.imgur.com/vypwD.jpg)

图片显示了我的设置，这些工作正常。您可能还想禁用`Save files on frame deactivation`, 以仅在手动保存时保存文件。

我更喜欢从终端使用 Guard，但您可以通过从菜单中选择 添加*运行配置来配置 RubyMine 以直接运行 Guard：*`Run > Edit configurations`

现在您可以通过单击加号`+`并选择来添加新配置`IRB console`：

![添加新的运行配置](../Images/6b35f857af5381bc4b9069ed869a58e2.png)

现在命名配置`Guard`，在 IRB 脚本中输入 Guard 的路径并设置项目工作目录。您可能希望输入您的 Guard 参数作为 IRB 参数，如不同的 Guard 组等。

![配置运行配置](../Images/a625f001d2148f577ff46e3dbbd55e51.png)

我通过打开终端找到了通往 Guard 的路径，更改为项目工作目录并输入`which guard`，这导致`/Users/michi/.rvm/gems/ruby-1.9.3-p194/bin/guard`我的 Ruby 1.9.3-p194 SDK 由 RVM 管理。

接下来，您需要在选项卡中检查*在捆绑包的上下文中运行脚本。*`Bundler`

![使用 bundle exec 运行](../Images/0565c70a74afec9ba42e0d88a1832dc0.png)

现在按下`OK`，你就有了一个全新的运行配置。在启动 Guard 之前，您应该通过添加将交互器配置为简单

```
interactor :simple 
```

到你的`Guardfile`. 现在您可以直接在 RubyMine 中运行（甚至调试）Guard：

![警卫在行动](../Images/e11b3690d5198c98677fe312afc93c2e.png)

享受！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-29T21:27:01.917

当您使用 RubyMine 运行guard 进行测试时，为guard spec 配置单独的数据库环境非常有用，否则您会遇到奇怪的问题（一个进程或另一个进程冻结或给出不一致的结果。

将您的保护规范环境命名为“ci”并在 database.yml 中创建一个附加条目。我将“ci”用于持续自动化。

然后把它放在你的 Guardfile 中。关键是

```
'RAILS_ENV' => 'ci' 
```

这是我的设置：

```
group :spec do
  guard :spork, :rspec_port => 1234, :cucumber_env => { 'RAILS_ENV' => 'ci' }, :rspec_env => { 'RAILS_ENV' => 'ci' } do
    watch('config/application.rb')
    watch('config/environment.rb')
    watch(%r{^config/environments/.+.rb$})
    watch(%r{^config/initializers/.+.rb$})
    watch('spec/spec_helper.rb')
    watch(%r{app/models/.+\.rb})
    watch(%r{app/views/.+\.haml})
    watch('Gemfile')
    watch('Gemfile.lock')
    watch('test/test_helper.rb')
  end

  # environment is 'ci'
  guard :rspec, :cli => '--drb --drb-port 1234', :version => 2, :all_after_pass => false, :notification => true, :environment => 'ci' do
    watch(%r{^spec/.+_spec.rb$})
    watch(%r{^lib/(.+).rb$})     { |m| "spec/lib/#{m[1]}_spec.rb" }
    watch('spec/spec_helper.rb')  { "spec" }
  # Rails example
    watch(%r{^spec/.+_spec.rb$})
    watch(%r{^app/(.+).rb$})                           { |m| "spec/#{m[1]}_spec.rb" }
    watch(%r{^lib/(.+).rb$})                           { |m| "spec/lib/#{m[1]}_spec.rb" }
    watch(%r{^app/controllers/(.+)_(controller).rb$})  do |m|
      ["spec/routing/#{m[1]}_routing_spec.rb",
       "spec/#{m[2]}s/#{m[1]}_#{m[2]}_spec.rb",
       "spec/acceptance/#{m[1]}_spec.rb",
       "spec/requests/#{m[1]}_spec.rb"]
    end

    watch(%r{^spec/support/(.+).rb$})                  { "spec" }
    watch('config/routes.rb')                          { "spec/routing" }
    watch('app/controllers/application_controller.rb')  { "spec/controllers" }
    # Capybara request specs
    watch(%r{^app/views/(.+)/.*.(erb|haml)$})          { |m| "spec/requests/#{m[1]}_spec.rb" }
  end
end 
```

然后我跑

```
bundle exec guard -g spec 
```

我也不介意让 RubyMine 每 60 秒自动保存一次文件，即使这会启动 Guard，因为我的新 MBP Retina 在运行 Guard 时不会明显变慢。

顺便说一句，Guard running specs 真的很棒，因为你会发现失败的测试比尝试在 RubyMine 中自己运行测试要快得多。即，测试基本上是在我的手指从 cmd-s 释放以保存时完成的。

我从终端运行它。我还没有尝试使用 RubyMine 运行。有人想评论这样做的好处吗？我想让堆栈转储可点击会很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-06-15T21:09:48.447

这是一个非常令人沮丧的问题，并且很难将 RubyMine 与 guard 或 grunt 或其他任务运行器一起使用。

我创建了一个疯狂的解决方法，但它对我来说已经足够好了：

1.  添加一个外部工具来运行古老的 Unix“触摸”命令，该命令会更新文件的修改时间戳，从而生成文件系统事件。它应该如下所示： ![称为触摸的外部工具](../Images/eccdfe20b447fafae1aa19f3a5a63a58.png)
2.  为外部工具分配键盘快捷键。
3.  为“保存文档”命令分配键盘快捷键。
4.  录制一个运行保存文档的宏，然后是“触摸”外部工具。您需要使用您指定的键盘快捷键，因为保存文档不会出现在应用程序的菜单中。
5.  将 Cmd-S 指定为新宏的键盘快捷键。

我关于此的完整博客文章位于[http://singlebrook.com/blog/saving-files-in-rubymine](http://singlebrook.com/blog/saving-files-in-rubymine)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-10T11:40:16.717

或者，您可以使用以下代码在项目的根目录中添加 run_guard.rb 文件：

```
exec 'guard' 
```

小心！Rubymine 的 PATH 有问题。例如， /usr/local/bin 被过滤...

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-07T10:24:21.380

我将它作为一个`Gem`命令运行，它允许我同时利用 Bundler，因此 Guard 的版本对于项目是正确的。

[![我将它作为 Gem 命令运行](../Images/1d6cb73d3ff79edb5d35d0cf586c3fd8.png)](https://i.stack.imgur.com/9GMQC.png)

# c++ - 在 C++ 源代码中使用重音字符是不是很糟糕？

> ID：11996127
> 
> 赞同：14
> 
> 时间：2012-08-16T22:07:05.060
> 
> 标签：c++, unicode, portability

我希望我的程序尽可能便携。我在字符串中搜索重音字符，例如 è。这会是个问题吗？是否有 C++ 等效的 HTML 实体？

它将在 switch 语句中使用，例如：

```
switch(someChar) //someChar is of type char
{
   case 'é' :
        x = 1;
        break;
   case 'è' :
   ...
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-17T15:35:50.073

在 C++ 源代码中使用非 ASCII 字符的主要问题是编译器必须知道用于源代码的编码。如果源是 7 位 ASCII 则通常无关紧要，因为大多数编译器默认假定 ASCII 兼容编码。

此外，并非所有编译器都可以配置编码，因此两个编译器可能会无条件地使用不兼容的编码，这意味着使用非 ASCII 字符可能会导致源代码无法同时使用。

*   GCC：具有用于设置源、执行和广泛执行编码的命令行选项。默认值由语言环境设置，现在通常使用 UTF-8。
*   MSVC：使用所谓的“BOM”来确定源编码（在 UTF-16BE/LE、UTF-8 和系统语言环境编码之间），并且始终使用系统语言环境作为执行编码。**编辑：从 VS 2015 Update 2 开始，MSVC 支持编译器开关来控制源和执行字符集，包括对 UTF-8 的支持。[看这里](https://blogs.msdn.microsoft.com/vcblog/2016/02/22/new-options-for-managing-character-sets-in-the-microsoft-cc-compiler/)**
*   Clang：始终使用 UTF-8 作为源和执行编码

因此，如果要搜索的字符串是 UTF-8（可能是因为执行字符集是 UTF-8），请考虑您的代码在搜索重音字符时会发生什么情况。无论字符文字 'é' 是否按预期工作，您都不会找到重音字符，因为重音字符不会由任何单个字节表示。相反，您必须搜索各种*字节序列*。

* * *

C++ 允许在字符和字符串文字中使用不同类型的转义。通用字符名称允许您指定一个 Unicode 代码点，并且将按照该字符出现在源代码中的方式进行处理。例如`\u00E9`或`\U000000E9`。

[（其他一些语言必须`\u`支持高达 U+FFFF 的代码点，但缺乏 C++ 对超出此范围的代码点的支持，或者让您使用代理代码点。您不能在 C++ 中使用代理代码点，而是 C++ 具有 \U 变体来直接支持所有代码点.)]

UCN 也应该在字符和字符串文字之外工作。在此类文字之外，UCN 仅限于不在基本源字符集中的字符。然而，直到最近编译器还没有实现这个 (C++98) 特性。现在 Clang 似乎有相当完整的支持，MSVC 似乎至少有部分支持，而 GCC 声称提供带有选项的实验性支持`-fextended-identifiers`。

回想一下，UCN 应该与源中出现的实际字符被同等对待；因此，具有良好 UCN 标识符支持的编译器还允许您使用实际字符简单地编写标识符，只要编译器的源编码首先支持该字符。

C++ 还支持十六进制转义。这些是 \x 后跟任意数量的十六进制数字。十六进制转义将表示单个整数值，就好像它是具有该值的单个代码点，并且不会对该值执行到执行字符集的转换。如果您需要表示独立于编码的特定字节（或 char16_t、或 char32_t 或 wchar_t）值，那么这就是您想要的。

还有八进制转义，但它们不如 UCN 或十六进制转义有用。

* * *

这是当您在使用 ISO-8859-1 或 cp1252 编码的源文件中使用“é”时 Clang 显示的诊断：

```
warning: illegal character encoding in character literal [-Winvalid-source-encoding]
    std::printf("%c\n",'<E9>');
                       ^ 
```

Clang 仅将其作为警告发出，并且只会直接输出带有源字节值的 char 对象。这样做是为了向后兼容非 UTF-8 源代码。

如果你使用 UTF-8 编码的源代码，那么你会得到：

```
error: character too large for enclosing character literal type
    std::printf("%c\n",'<U+00E9>');
                       ^ 
```

Clang 检测到 UTF-8 编码对应于 Unicode 代码点 U+00E9，并且该代码点超出了单个 char 可以容纳的范围，因此报告错误。（Clang 也转义了非 ascii 字符，因为它确定运行它的控制台无法处理打印非 ascii 字符）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-08-16T22:13:44.980

形式上，C++ 甚至在标识符中也支持相当好的 Unicode 子集，因此理论上可以用挪威字符编写标识符，例如`antallBlåbærsyltetøyGlass`.

实际上，C++ 实现仅支持标识符中的 A 槽 Z、数字 0 到 9 和下划线。一些实现还允许使用美元符号 $。但是，该标准不允许使用美元符号。

要在文本文字中指定 Unicode 字符，您可以使用**通用字符 name**，它根本不是一个名称，而是更像一个转义序列，例如`\u20AC`（欧元符号 €）。如果您将源代码保存为 UTF-8，您也可以直接编写此类字符。请注意，Visual C++ 需要 BOM（字节顺序标记）才能识别 UTF-8 源代码。

如果您将字符串视为 UTF-8 编码（即`char`类型，这在 *nix 中很常见），那么 ASCII 范围 0...127 之外的“é”将不是单个`char`值，因此*不能用作 a`case`中的标签`switch`*。

但是，此特定字符是 Latin-1 的一部分，它是 Windows ANSI Western 的一个子集，它是一种每个字符一个字节的编码。因此，在 Windows 的西方安装中，对字符串值使用 ANSI 编码，它是单个值，可以这样使用。Latin-1 也是 Unicode 的一个子集（包括 Unicode 的前 256 个代码点），因此对于`wchar_t`基础字符串，例如`std::wstring`，以及将那些宽字符串作为 Unicode，“é”也是单个值，即与Latin-1 和 Windows ANSI Western。

尽管如此，使用`wchar_t`表示 Unicode 并不能保证任何任意字符都是单个值。

例如，在 Windows 中，a`wchar_t`仅为 16 位，标准编码为 UTF-16，其中所谓的*基本多语言平面*（原始 16 位 Unicode）之外的字符由称为*代理对*的两个值表示。更糟糕的是，即使使用 UTF-32 Unicode 也允许用两个或多个值表示重音字符，即首先是表示基本字符类型的值，然后是通过添加重音符号等来修改它的值，所以为了全面概括，您可以即使使用 32-bit ，也不要依赖字符是单个值`wchar_t`。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-16T22:32:59.077

**编辑：**要在 switch 语句中使用宏需要对我的原始解决方案进行两次更改。首先，每个字符都必须适合一个整数类型；确保这一点的最佳方法是将宽字符与`wchar_t`. 其次，宏必须是字符文字而不是字符串文字。例如

```
#define E_GRAVE L'\u00E8'

wchar_t someChar = ...;
switch(someChar)
{
   case E_GRAVE :
        x = 1;
        break;
   ...
} 
```

* * *

一种完全可移植的方法是为重音字符定义宏并依赖字符串连接。

```
// è (U+00E8) in UTF-8 encoding
#define E_GRAVE "\xC3\xA8"

cout << "Resum" E_GRAVE << endl; 
```

这当然假设您正在使用 UTF-8。您可以通过这种方式支持任何您想要的字符集。以下是在 Windows 上使用 UTF-16 的方法：

```
#define E_GRAVE L"\u00E8"

wchar_t * resume = L"Resum" E_GRAVE; 
```

# html - 用 IE 处理丢失的 quicktime 插件

> ID：11996128
> 
> 赞同：1
> 
> 时间：2012-08-16T22:07:07.463
> 
> 标签：html, plugins, quicktime

我的问题类似于[使用 Firefox 处理缺少的 QuickTime 插件](https://stackoverflow.com/questions/3613558/handle-missing-quicktime-plugin-with-firefox)但是，就我而言，Firefox 检测到该插件丢失并引导我到下载插件的正确页面。另一方面，Internet Explorer 8 仅显示损坏的图像图标（不是 QuickTime 符号）。

这是我的代码：

```
<embed 
starttime="00:05:22.5"
qtsrcdontusebrowser="true" 
pluginspage="http://www.apple.com/quicktime/download/" 
controller="false" 
autoplay="false" 
kioskmode="true" 
autohref="true" 
href="IITM%20-%2003%20-%20Mechanical%20Events.mov" 
src="IITM%20-%2003%20-%20Mechanical%20Events.mov" 
target="quicktimeplayer"
width="384"
height="128">
</embed> 
```

我错过了 IE 需要的东西吗？如果用户有 QuickTime 插件，视频在 IE 8 中可以正常播放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:13:08.570

> 我错过了 IE 需要的东西吗？

你错过了 IE 在阵营，`<object>`而 Firefox 在`<embed>`.

您可以在供应商网站上找到记录的 IE 软件：http: [//www.microsoft.com/](http://www.microsoft.com/)，它应该提供您可能需要找出来为您解决该问题的所有详细信息。

*   [Internet Explorer：对象元素 | 对象对象](http://msdn.microsoft.com/en-us/library/ie/ms535859%28v=vs.85%29.aspx)
*   [书摘：客户端标签](http://msdn.microsoft.com/en-us/library/ms952644.aspx)
*   ...

# java - 这种反向单链表算法的复杂性？

> ID：11996130
> 
> 赞同：1
> 
> 时间：2012-08-16T22:07:08.380
> 
> 标签：java, algorithm, complexity-theory

这个算法的复杂度是多少？我假设它是 O(N) 但我想澄清一下。如果我在链表中​​有一个尾巴，我会假设这会更快，因为我会完全避免让 while(current != null) 循环循环到链表的末尾。

```
public void reverse() {
    Stack<Node> stack = new Stack<Node>();
    if (this.head != null || this.head.next != null) {
        Node current = this.head;
        while (current != null) {
            stack.push(current);
            current = current.next;
        }
        Node last = null;
        while (!stack.empty()) {
            if (last==null) {
                this.head = stack.pop();
                last = this.head;
                continue;
            }
            last.next = stack.pop();
            last = last.next;
            if (stack.empty()) {
                last.next = null;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T22:15:21.923

您通过迭代列表将所有链接列表元素推入堆栈这是一个 N 然后您迭代堆栈是另一个 N 所以您在 O(2N) 中排序符号

看看[如何用 O(1) 空间和 O(n) 时间反转列表？](https://stackoverflow.com/questions/5985365/how-to-reverse-a-list-with-o1-space-and-on-time)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T22:24:57.723

该算法属于 O(N) 类。您正在使用 N 次静态操作量（第一个循环），然后再次使用静态操作量（第二个循环）；Stack.pop() 应该独立于“N”；所以这意味着它在 O(2N+c) 类中......而 O(2N+c) 在 O(2N) 类中，而 O(2N) 类在 O(N) 中。换句话说：例程的运行时间随着堆栈中元素的数量线性增加。

或者简单地说：是的，它属于 O(N) 类。

# r - 为每组数据帧中的行创建一个序号（计数器）

> ID：11996135
> 
> 赞同：40
> 
> 时间：2012-08-16T22:07:37.923
> 
> 标签：r, dataframe

我们如何在数据帧的每一组中生成唯一的 ID 号？以下是一些按“personid”分组的数据：

```
personid date measurement
1         x     23
1         x     32
2         y     21
3         x     23
3         z     23
3         y     23 
```

我希望为“personid”定义的每个子集中的每一行添加一个具有唯一值的 id 列，始终以`1`. 这是我想要的输出：

```
personid date measurement id
1         x     23         1
1         x     32         2
2         y     21         1
3         x     23         1
3         z     23         2
3         y     23         3 
```

我很感激任何帮助。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2015-06-02T12:33:22.813

一些`dplyr`替代方案，使用便利功能`row_number`和`n`.

```
library(dplyr)
df %>% group_by(personid) %>% mutate(id = row_number())
df %>% group_by(personid) %>% mutate(id = 1:n())
df %>% group_by(personid) %>% mutate(id = seq_len(n()))
df %>% group_by(personid) %>% mutate(id = seq_along(personid)) 
```

* * *

您也可以使用`getanID`from package `splitstackshape`。请注意，输入数据集以`data.table`.

```
getanID(data = df, id.vars = "personid")
#    personid date measurement .id
# 1:        1    x          23   1
# 2:        1    x          32   2
# 3:        2    y          21   1
# 4:        3    x          23   1
# 5:        3    z          23   2
# 6:        3    y          23   3 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-08-16T22:29:33.550

带有参数的误导性命名`ave()`函数`FUN=seq_along`将很好地完成此任务——即使您的`personid`列没有严格排序。

```
df <- read.table(text = "personid date measurement
1         x     23
1         x     32
2         y     21
3         x     23
3         z     23
3         y     23", header=TRUE)

## First with your data.frame
ave(df$personid, df$personid, FUN=seq_along)
# [1] 1 2 1 1 2 3

## Then with another, in which personid is *not* in order
df2 <- df[c(2:6, 1),]
ave(df2$personid, df2$personid, FUN=seq_along)
# [1] 1 1 1 2 3 2 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-08-16T23:12:00.877

使用`data.table`, 并假设您希望`date`在`personid`子集中排序

```
library(data.table)
DT <- data.table(Data)

DT[,id := order(date), by  = personid]

##    personid date measurement id
## 1:        1    x          23  1
## 2:        1    x          32  2
## 3:        2    y          21  1
## 4:        3    x          23  1
## 5:        3    z          23  3
## 6:        3    y          23  2 
```

如果您不想订购`date`

```
DT[, id := 1:.N, by = personid]

##    personid date measurement id
## 1:        1    x          23  1
## 2:        1    x          32  2
## 3:        2    y          21  1
## 4:        3    x          23  1
## 5:        3    z          23  2
## 6:        3    y          23  3 
```

以下任何一项也可以

```
DT[, id := seq_along(measurement), by =  personid]
DT[, id := seq_along(date), by =  personid] 
```

等效的命令使用`plyr`

```
library(plyr)
# ordering by date
ddply(Data, .(personid), mutate, id = order(date))
# in original order
ddply(Data, .(personid), mutate, id = seq_along(date))
ddply(Data, .(personid), mutate, id = seq_along(measurement)) 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-08-16T22:12:28.370

我认为有一个固定的命令，但我不记得了。所以这是一种方法：

```
> test <- sample(letters[1:3],10,replace=TRUE)
> cumsum(duplicated(test))
 [1] 0 0 1 1 2 3 4 5 6 7
> cumsum(duplicated(test))+1
 [1] 1 1 2 2 3 4 5 6 7 8 
```

这是有效的，因为`duplicated`返回一个逻辑向量。 `cumsum`evalues 数字向量，因此逻辑被强制为数字。

如果需要，您可以将结果作为新列存储到 data.frame 中：

```
dat$id <- cumsum(duplicated(test))+1 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-08-16T22:24:26.347

假设您的数据位于名为的 data.frame 中`Data`，这将起到作用：

```
# ensure Data is in the correct order
Data <- Data[order(Data$personid),]
# tabulate() calculates the number of each personid
# sequence() creates a n-length vector for each element in the input,
# and concatenates the result
Data$id <- sequence(tabulate(Data$personid)) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2012-08-17T03:21:40.007

您可以使用`sqldf`

```
df<-read.table(header=T,text="personid date measurement
1         x     23
1         x     32
2         y     21
3         x     23
3         z     23
3         y     23")

library(sqldf)
sqldf("SELECT a.*, COUNT(*) count
       FROM df a, df b 
       WHERE a.personid = b.personid AND b.ROWID <= a.ROWID 
       GROUP BY a.ROWID"
)

#  personid date measurement count
#1        1    x          23     1
#2        1    x          32     2
#3        2    y          21     1
#4        3    x          23     1
#5        3    z          23     2
#6        3    y          23     3 
```

# azure - ServerManager 类，我的站点不在 Azure Compute Emulator 上的站点集中

> ID：11996138
> 
> 赞同：1
> 
> 时间：2012-08-16T22:07:51.030
> 
> 标签：azure, emulation, azure-compute-emulator, servermanager

我有一个名为 Web 的 WebRole，我在 Azure Compute Emulator 中运行此代码：

```
 public override bool OnStart()
    {
        using (var serverManager = new ServerManager())
        {
            string strSiteName = RoleEnvironment.CurrentRoleInstance.Id + "_" + "Web";
            Site theSite = serverManager.Sites[strSiteName];

        }
        return base.OnStart();
    } 
```

但是 serverManager.Sites 只返回位于我本地 IIS 中的站点，但我需要托管在 Windows Azure 模拟器中的站点。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:33:13.720

我认为这些天模拟器默认使用 IIS Express。我敢打赌，如果您将其切换为使用完整的 IIS（在云项目的属性 IIRC 中的某处），一切都会按预期工作。

# dojox.charting - 从 JsonRest 商店更新 Dojo 图表

> ID：11996139
> 
> 赞同：0
> 
> 时间：2012-08-16T22:07:51.933
> 
> 标签：dojox.charting

我有一个使用 JsonRest 存储（具体来说是 /dojo/store/JsonRest）来填充系列的道场图表。商店设置有定期自我更新的间隔。虽然它确实拉回了正确的数据，但图表没有正确更新。我最初的印象是简单地更新商店应该更新图表。当这没有发生时，我尝试像这样手动更新系列，但它只会导致所有图形点都设置为 y 值为零：

```
var jStore = new JsonRest( {target: "/TestExecutionSummary/" } );
jStore = Observable(jStore);

// Creating chart
...
...
chart.addSeries("y", new dojox.charting.StoreSeries(jStore, { query: {} }, "totalPassed"));

var interval = setInterval(function() {
  var updates = jStore.query({});
  updates.then(function(result) {
    chart.updateSeries("y", result, true).render();
  });
}, 3* 1000); 
```

有什么方法可以让图表使用新商店进行自我更新，或者 JsonRest 商店是否真的不支持这种类型的工作流程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T19:51:30.250

我觉得这有点像黑客，但以下对我有用。我没有创建内联的 StoreSeries 实例，而是创建了一个单独的实例，然后我可以通过调用其 fetch() 方法手动更新该实例。

```
// Creating chart
...
var mySeries = new StoreSeries(testExecutionSummaryStore, { query: {} }, "totalTests");
chart.addSeries("Total Test Count", mySeries, {plot:"total"});
...

// Call this in the interval to update the chart
mySeries.fetch(); 
```

# android - 如果手机有 Android 版 Facebook 应用，则无法授权。

> ID：11996140
> 
> 赞同：0
> 
> 时间：2012-08-16T22:08:02.313
> 
> 标签：android, facebook

> **可能重复：**
> [android-facebook 应用程序的密钥哈希](https://stackoverflow.com/questions/4388992/key-hash-for-android-facebook-app)

我正在尝试修复有关 Facebook 的错误，我发现如果手机有 Facebook 应用程序，它就无法授权。

它以前运行得很好，当手机没有 Facebook 应用程序时也是如此。可能是因为最近更新了应用程序..??

这是下面的错误消息。它说invalid_key。

```
09-09 14:07:11.520: D/Facebook(30618): ::: onFacebookError :::
09-09 14:07:11.520: E/Facebook(30618): invalid_key:Android key mismatch. Your key "ig/T0MmkPGxn5mWnZCKub2mIHr0" does not match the allowed keys specified in your application settings. Check your application settings at http://www.facebook.com/developers 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:25:03.603

您需要在应用的 Facebook 仪表板上添加应用的签名。

转到我们文档中本[教程](https://developers.facebook.com/docs/mobile/android/build/)的第 5 步，然后按照说明进行操作。您需要将此文本“ig/T0MmkPGxn5mWnZCKub2mIHr0”（不带引号）放在应用程序仪表板的 Android 密钥哈希部分中。

# javascript - 如何检测何时 HTML5 是第一次玩吗？

> ID：11996142
> 
> 赞同：4
> 
> 时间：2012-08-16T22:08:18.690
> 
> 标签：javascript, jquery, html, html5-video

每次单击播放按钮时都会触发警报。因此，它将在第一次播放视频时触发，但也会在后续播放时触发，如果用户暂停然后再次播放：

```
$('video').bind('play', function() {
   alert('I have been played!');
}); 
```

第一次播放视频时，我只需要触发一次事件。如何才能做到这一点？

也许 jquery 一个功能可以与此结合以实现它？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-16T22:31:12.787

```
$('video').one('play', function () {
   //whatever you want to do
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-28T09:22:34.587

```
$(document).ready(function(){
   $('#video_id').one('play', function () {
       //code here
    });
}); 
```

# php - 将php变量传递给ajax url

> ID：11996146
> 
> 赞同：1
> 
> 时间：2012-08-16T22:09:05.227
> 
> 标签：php, ajax, variables

*更新

问题是有多个变量，我无法通过 php echo。由于“冲突”，我不能只在 php 中运行脚本

```
<?php
.....other stuff

 $i=0;
 while ($i < $num) {

$id=mysql_result($result,$i, "StudentID");
$first=mysql_result($result,$i,"First");
$last=mysql_result($result,$i,"Last");
$date= date("Y.m.d");
echo "<div id=\"list\"><div id=\"id\">$id</div><div id=\"name\"> $first $last  
<button onclick=\"addHit($id,$first,$last,$classname,$day,$times,$date)\">Checkin</button></div></div>  ";

$i++;
}

echo"</div></div></div></div>";

?>
<script>
function addHit(id, first, last, classname, day, times, date)
{
$.ajax({
   type: "POST",
   url: "checkinuser.php",
   data: "id=id&first=first&last=last&classname=classname&day=day&times=times&date=date",
   success: function(msg){
     alert( "Data Saved: " + msg ); //Anything you want
   }
 });
}
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T22:25:44.993

正如其他人所提到的，您不能直接在 HTML 中使用 PHP，因此您需要在 PHP 代码块中转义所有这些变量。如果这是我的代码，我会考虑重构一下，这样我就可以使用 JSON 编码的参数，例如：

```
<?php
    $rawData = array('id'=>$id, 'first'=>$first, 'last'=>$last, ... );
    $hitData = json_encode($rawData);
?>

<button onclick="addHit(<?php echo $hitData ?>)">Checkin</button>

function addHit(inputData)
{
    $.ajax({
        type: "POST",
        url: "checkinuser.php",
        data: inputData
        success: function(msg) {
            alert( "Checked In! " + msg ); 
        }
    });
} 
```

作为对您的编辑的回应，如果您想保留参数的方式，我会修改您的 while 循环：

```
<?php
$i=0;
while ($i < $num) {

    $id=mysql_result($result,$i, "StudentID");
    $first=mysql_result($result,$i,"First");
    $last=mysql_result($result,$i,"Last");
    $date= date("Y.m.d");
?>
<div id='list'>
    <div id='id'>
        <?php echo $id?>
    </div>
    <div id='name'>
        <?php echo "$first $last" ?>
        <button onclick='addHit( <?php echo "$id,$first,$last,$classname,$day,$times,$date" ?> )'
            Checkin
        </button>
    </div>
</div>

<?php 
    $i++;
}
?> 
```

这里的目标是使读/写更容易，因此尽可能将静态代码（例如 HTML）与动态代码分开可能是一件好事。一个很大的优点是您不必像您一样担心转义引号，尽管缺点是有相当数量的`<?php>`块。

另请注意，您正在为所有这些 div 设置 id='id' ，这将不起作用，因为当 id 在给定页面上需要唯一时，它们都将共享一个 id。你可能也想去`echo $id`那里。

同样，没有理由将其`echo"</div></div></div></div>";`移到 PHP 块之外，并将其保留为 HTML。

最后，在您的 javascript 中，您的 data 参数是文字字符串：

```
"id=id&first=first&last=last&classname=classname&day=day&times=times&date=date" 
```

这将不起作用，因为 id 字面意思是“id”，first 将是“first”，等等。

您需要使用我上面的方法（在其中传递整个参数），或者构建要作为数据参数传递的对象。 `.ajax()`将获取对象，因此我将其设为对象，然后将其传递，例如：

```
function addHit(id, first, last, classname, day, times, date)
{
inputData = { id: id, first: first, etc, etc}
$.ajax({
   type: "POST",
   url: "checkinuser.php",
   data: inputData,
   success: function(msg){
     alert( "Data Saved: " + msg ); //Anything you want
   }
 });
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T22:15:07.787

数据不应该看起来相似吗：

```
data: "id="+id+"&first="+first+"&last="+last+"&classname="+classname+"&day="+day+"&times="+times+"&date="+date, 
```

您还可以使用以下格式：

```
data : { id : id, first : first, last : last, classname : classname, day : day, times : times, date : date } 
```

加上mimiz所说的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T22:11:52.580

您不能将 PHP 变量直接插入到其他代码中。试试看`echo`。

```
<button onclick=\"addHit('<?php echo $id.","$first.",".$last.",",$classname.",".$day.",".$times.",".$date; ?>')\">Checkin</button> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-16T22:13:22.383

尝试这个 ：

```
<button onclick=\"addHit(<?php echo " '$id', '$first' ,'$last','$classname','$day', '$times','$date'"; ?>)\">Checkin</button> 
```

问候;

咪咪

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-16T22:19:13.930

尝试改变这个：

```
type: "POST", 
```

为了这：

```
type: "GET", 
```

您应该通过 GET 传递变量并在 PHP 代码中接收它们，因为它是通过 url 传递的。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-08-16T22:15:32.377

addHit('$id,$first,$last,$classname,$day,$times,$date') 必须为 addHit($id,$first,$last,$classname,$day,$times,$date)

（tnx 给穆萨）

数据："id=id&first=first&last=last&classname=classname&day=day×=times&date=date" 必须是数据："id=$id&first=$first&last=$last&classname=$classname&day=$day×=$times&date=$date"

# javascript - asp.net 中单选按钮的 javascript 验证（解释遗留代码）

> ID：11996149
> 
> 赞同：1
> 
> 时间：2012-08-16T22:09:30.380
> 
> 标签：javascript, asp.net, validation, radio-button

我正在开发一个 asp.net 网络应用程序，并试图解释由前开发人员创建的遗留代码。

我的网页有 6 个单选按钮

```
input type="radio" id="rbtnSearchBy1"  
input type="radio" id="rbtnSearchBy2"  
input type="radio" id="rbtnSearchBy3"  
input type="radio" id="rbtnSearchFor1"  
input type="radio" id="rbtnSearchFor2"  
input type="radio" id="rbtnSearchFor3" 
```

但是，当我查看 javascript 验证代码时，我看到

```
 if (!document.aspnetForm.Master$cphMainContent$rbtnSearchBy[0].checked) {
        if (document.aspnetForm.Master$cphMainContent$rbtnSearchBy[1].checked) {
            if (document.aspnetForm.Master$cphMainContent$rbtnSearchFor[1].checked || document.aspnetForm.Master$cphMainContent$rbtnSearchFor[2].checked) {
                document.aspnetForm.Master$cphMainContent$rbtnSearchBy[0].checked = true;
                ValidateUserFields()
                alert("Please select either location or facility name.");
                return false;
            }
        }
        else {
            if (document.aspnetForm.Master$cphMainContent$rbtnSearchFor[0].checked) {
                document.aspnetForm.Master$cphMainContent$rbtnSearchBy[0].checked = true;
                ValidateUserFields()
                alert("Please select either location or vendor name.");
                return false;
            }
        }
    } 
```

我无法理解**rbtnSearchBy[0]**或**rbtnSearchFor[0]**的用途？
有什么建议么？

# objective-c - 在 UIWebView 显示之前注释掉 HTML 中的字符串

> ID：11996152
> 
> 赞同：0
> 
> 时间：2012-08-16T22:09:36.823
> 
> 标签：objective-c, ios

由于我不太了解在显示页面之前如何读取 HTML，ObjC 是否可以在 HTML 文档的头部搜索一个字符串，然后如果该字符串在 HTML 打开之前存在，则将其注释掉UIWeb 视图？

如果是这样，你能提供一个片段吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T22:15:56.853

您可以根据需要构建 HTML 字符串，然后将其设置为 UIWebView，如下所示：

```
[webView loadHTMLString:html baseURL:nil]; 
```

至于解析字符串本身，NSMutableString 有一个非常实用的方法，可以帮上大忙。这就是我使用的：

```
[html replaceOccurrencesOfString:@"<div>Hello</div>" withString:@"<!--div>Hello</div-->" options:NSLiteralSearch range:NSMakeRange(0, [html length])]; 
```

因此，如果您一直在寻找某些东西，则可以将其替换为已注释掉的内容，然后将其设置为 webView。

希望有帮助！

# objective-c - Objective-C - 访问/初始化对象超出范围问题

> ID：11996159
> 
> 赞同：2
> 
> 时间：2012-08-16T22:10:18.350
> 
> 标签：objective-c, class, object, scope

我是 Objective-C 编程的新手，并且掌握了一些 C++。作为我的第一个程序之一，我正在尝试制作一个可以记录用户心率的相当简单的应用程序。

我创建了一个类来存储所有这些信息（称为 HeartRate），我想从中创建一个对象。但是，我在范围和初始化对象方面遇到问题。我正在尝试在名为“buttonPressed”的方法中对其进行初始化，但在此函数之外无法访问该对象。

我研究过使用 AppDelgate，但运气不佳 - 就像我提到的，我是 Objective-C 的初学者，所以可能可以完成，但我不知道该怎么做。

我在哪里可以安全地初始化它，以便其他功能可以访问它？

如果你们希望我发布任何代码或更详细地解释，我会很高兴。

这是 IBAction 的代码：

```
-(IBAction)buttonPressed:(id)sender{
HeartRate *HR = [[HeartRate alloc]init];
int beats = [HR getBeats];
[HR setBeats:(beats+1)];
NSString *outputBeats = [NSString stringWithFormat: @"%i", [HR getBeats]];
beatsText_.text = outputBeats; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:16:00.093

将对象声明为实例变量，以便在包含 HeartRate 的类中的任何位置访问它：

```
@interface AppDelegate: NSObject <UIApplicationDelegate> {
    HeartRate *rate;
}

@end

@implementation AppDelegate

- (void)buttonPressed {
    rate = [[HeartRate alloc] init];
    // etc.
}

@end 
```

# asp.net - 实体框架第一次加载很慢

> ID：11996164
> 
> 赞同：4
> 
> 时间：2012-08-16T22:10:45.633
> 
> 标签：asp.net, sql-server, entity-framework, entity-framework-4

我在我的网站上使用 EF 4 并发现了一个非常令人不安的问题 - 第一次运行加载时间非常慢。（大约 20-30 秒）。第一次运行后 - 它会运行得非常快。

我所说的“第一次跑步”是指长时间没有活动（10 分钟左右）后的跑步。

因此，如果有很多流量，该网站运行良好。如果有缓慢的日子 - 在长时间的交通中断后第一个来到该站点的人将获得非常糟糕的体验。

因为该网站还公开了一个 API - 那里也发生了同样的情况。第一个调用它 - 将在他身边获得超时。

我的数据库是 SQL Server 2008 R2。

任何想法为什么会发生这种情况？如何解决？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T22:16:49.570

可能是 EF，但同样可能是您的应用程序池在 IIS 或组合上被回收。

如果您的网站上的使用时间很慢，并且您希望每个页面都为随之而来的访问者快速加载，过去我已经设置了一个定时工作以特定时间间隔访问我的网站（大约 5 分钟工作对我来说），这确保了当访客来时它总是准备好去。

如果您可以访问任务调度程序，这很容易做到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T16:01:35.420

我也遇到了这个问题，我发现它与我的数据库中的大量视图有关。

[性能注意事项（实体框架）](http://msdn.microsoft.com/en-us/library/cc853327.aspx)确实有帮助，[减轻生成视图影响的步骤](http://msdn.microsoft.com/en-us/library/bb896240.aspx)将 45-60 秒的初始负载降低到 3-4 秒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T22:20:30.763

我会做更多的研究来确定它是 EF、DB 还是 IIS。正如@EJ Brennan 所说，我认为 IIS 看起来可能是罪魁祸首。

在 IIS 中，我会确保 IIS 应用程序池没有被回收，而正常情况下可以管理频率以减少对最终用户的影响。EF 可能不是问题，但应用程序或数据库中的缓存可能会隐藏潜在的 SQL 问题。捕获查询并分析执行计划以确保它是最优的。

希望这有助于查明问题。

# javascript - Onload清除所有文本字段jquery js

> ID：11996166
> 
> 赞同：2
> 
> 时间：2012-08-16T22:10:57.727
> 
> 标签：javascript, jquery

如何清除页面上的所有文本字段、取消选择按钮等？我只是想在页面加载时刷新页面.. 就像按住 Shift + Refresh 一样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-16T22:15:16.680

试试这个：

```
$(document).ready(function() {
    $('input[type!="button"][type!="submit"], select, textarea')
         .val('')
         .blur();
}); 
```

清除按钮和提交按钮上的值会给它们一个空白标签，因此选择器更复杂。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-16T22:14:54.910

如果所有元素都符合形式，

然后使用`document.getElementById('your-form-id').reset();`

或者`$('#your-form-id')[0].reset();`

否则：

```
$('input, textarea').each(function() {
    this.value = '';
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-16T22:15:28.647

我不确定是否有比这更优雅的解决方案，但要简单地清除值，您可以这样做：

```
$('input[type="text"], textarea').val('');
$('select').each(function() {
    $(this).val($(this).find('option').val());
}; 
```

# tsql - SQL Server 2000 传输登录名和关联的服务器角色以及对特定数据库的访问权限

> ID：11996170
> 
> 赞同：10
> 
> 时间：2012-08-16T22:11:12.237
> 
> 标签：tsql, login, sql-server-2000, roles

我在一家不到 50 人的相对较小的公司工作，我可能是我们拥有的最接近 DBA 的人……我实际上是一名程序员，但这无关紧要。我们有`SQL Server 2000`大约**100 个不同的数据库**。几乎所有这些都具有关联的 SQL 登录名，并且该登录名与`DB_OWNER`特定数据库的数据库角色相关联。我们还有一些设置为`DB_DATAREADER`数据库角色的登录名。

我们购买了一台全新的机器（目前是一台 12 岁的机器，担心硬件故障可能会导致我们的业务在不可接受的时间内倒闭）。我们不会升级 SQL Server 版本。我们将坚持2000。

我的问题是最简单的方法是什么。我的想法是分离所有数据库，将它们复制到新机器上，然后重新附加每个数据库。我将保持机器名称和 IP 相同，并在完成后删除旧服务器，因此无需修改任何连接字符串。这似乎并没有那么糟糕，并且可以在周末轻松完成。我对这种方法的问题是，在我这样做之后，我需要从数据库中删除用户，然后重新创建`login`使用用户名/密码，然后为每个用户分配适当的角色。我只在这里 5 年，我没有每个特定数据库和程序正在使用的所有可能的用户名/密码。我不想破坏任何现有的程序，也不想去每一台机器上更新它……或者甚至可能不得不找到旧的源代码并重新编译……是的，我们的一些遗留的东西有用户名/密码硬编码在源代码:(。

所以我想主要问题是`script`我可以在现有服务器上运行的一个，它将生成一个脚本以在新机器上运行以设置现有的`logins`, `users`，`roles`使用与以前相同的用户名/密码？

如果有更简单的方法将 sql server 实例从一台机器转移到另一台机器；我全是耳朵。

仅供参考，我们已尝试从现有服务器创建 VHD 以在虚拟机中使用，但已经耗尽了该路由。我们永远无法让机器启动进入 Windows。认为这是驱动程序问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-28T23:35:39.580

除非您在目标计算机上运行 64 位版本的 SQL Server，否则第一条评论中提供的链接应该允许您成功传输登录名。

[该链接](http://support.microsoft.com/kb/246133)中标题为“在不同版本的 SQL Server 之间传输登录名和密码的完整解决方案”的部分为您提供了实现目标的分步过程。

尽管这样做的风险很大，但您始终可以使用诸如[Norton Ghost](http://us.norton.com/ghost/)之类的工具创建现有服务器驱动器的映像，然后在新硬件上恢复该映像。

我在从传统驱动器迁移到固态驱动器时完成了此操作，尽管花费了很长时间（几个小时），但它工作得很好。当然，如果您要更改操作系统，这种方法将不起作用，并且由于硬件和驱动程序的差异可能无法正常工作。

它肯定会做更多的工作，但是这些类型的升级让您有机会纠正一些使您难以将数据库服务器迁移到新安装的问题（例如：硬编码凭据等） . 如果您有能力、时间和愿望来纠正这些问题，那么这样做可能是值得的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-23T15:44:10.677

我认为您可以关闭服务器，然后将所有与数据库相关的文件复制到新服务器并在那里重新启动新的 sqlserver，让它使用这些复制的文件。[尽管http://www.sqlservercentral.com/Forums/FindPost959329.aspx](http://www.sqlservercentral.com/Forums/FindPost959329.aspx)在此之外找不到更多

此链接为您提供有关如何操作的支持意见[http://support.microsoft.com/kb/314546](http://support.microsoft.com/kb/314546)

考虑到VHD路线，你是否也尝试过竞品？你可以试试 VMWare，我听说过它的好消息，它可能会在其他人失败的地方成功。[http://www.vmware.com/nl/products/datacenter-virtualization/vsphere-hypervisor/overview.html](http://www.vmware.com/nl/products/datacenter-virtualization/vsphere-hypervisor/overview.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-29T00:30:57.983

自从我破解 SQL 2000 以来已经很久很久了……但它是可破解的，但不适用于 2005 年及更高版本。以下是基于“如果我们这样做……会发生什么”的旧记忆的想法和*建议*；我不能给你具体的命令或例子，因为我现在没有访问任何 SQL 2000 实例的权限。

*   创建“新”主数据库的备份。
*   两个不同的盒子上的两个 SQL 2000 实例。称它们为“旧”和“新”。
*   关闭旧
*   将主数据库文件（master.mdf、master.log 或任何名称）复制到新服务器
*   确保您有“新”主数据库的备份。
*   将它们作为用户数据库附加到新实例。重命名文件，可能是“OldMaster”。
*   在两个主数据库中找到适当的系统数据库。系统登录？系统登录X？Books Online 将在这里提供帮助（这些系统表自 2000 年以来已完全修订）。
*   INSERT... SELECT... 从一个数据库到另一个。我很确定我曾经这样做过。（就在我们放弃 SA 帐户之前，只是想看看我们是否可以。）（哦，不要放弃 SA 帐户。）
*   我认为您必须翻转一些 sp_options 开关，以允许手动更新系统数据库。
*   您确实对“新”主数据库进行了备份，不是吗？（实际上，关闭实例，复制主数据库文件，然后再次启动它们也可以正常工作 - 只需关闭，将副本复制回您的混乱文件，然后重新启动，您就在是——只要你没有弄乱任何其他数据库。）

`sp_change_users_login`（使用“report”然后“autofix”）在这里应该证明是无价的——它可以用于将登录（主数据库中的定义）与用户（存储在数据库中的定义）同步。再一次，不适用于我现在所在的位置，但是每次我们将数据库从一个盒子移动到另一个盒子时，我都必须使用这个过程。嗯。有*一些*方法可以使用加密密码编写登录脚本，并在另一个盒子上运行“创建登录”，但我不记得它是什么。查看 sp_CreateLogin 的文档，或用于在 2000 上创建 SQL 登录的任何内容。

我所知道的大多数东西都来自于阅读**在线图书**，然后乱七八糟。我不知道你是否有时间，但如果你有要求，它最终可以工作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-29T15:07:11.583

我认为最简单的方法应该是在您安装新服务器之后（我会说重新考虑升级到 sql2008 或更高版本，原因有很多）。

然后使用复制数据库向导。按照描述的步骤

[http://msdn.microsoft.com/en-us/library/ms188664.aspx](http://msdn.microsoft.com/en-us/library/ms188664.aspx)

问候，哈科

# python - 金字塔自定义 oauth2 装饰器

> ID：11996171
> 
> 赞同：1
> 
> 时间：2012-08-16T22:11:17.860
> 
> 标签：python, decorator, pyramid, oauth-provider

目前使用 Kevin Van Wilder oauth2 服务器项目[http://code.google.com/p/pyramid-oauth2/](http://code.google.com/p/pyramid-oauth2/)，它正在开发中，但大部分功能在我的项目中运行良好，但我的一位装饰师遇到了这个问题，我是装饰器的新手，正如我所说的那样正在开发中，所以我不确定它是否已经完成或实际上是装饰器本身，我评论了一些相关的行大写我遇到了问题，我可以修复或使用这个吗？，或者做我需要使用 functools wrap 函数来制作它...一些指导将不胜感激

```
def oauth2(allowed_scopes=[], optional=False):
    def wrap(view_fn):
        def new_fn(incoming_request):
            # get token
            request = OAuth2Request(incoming_request)
            token = request.access_token
            # handle token
            if token:
                #oauth2_context = get_token_context.delay(token.get('token')).get() I AM NOT USING CELERY
                oauth2_context = get_token_context(token.get('token'))
                # stop if token contains no valid information
                if not oauth2_context.valid:
                    raise OAuth2ErrorHandler.error_invalid_token(token.get('type'))
                # not mandatory use of oauth, but valid token
                elif optional:
                    return view_fn(request=incoming_request, oauth2_context=oauth2_context)
                # validate scope
                elif has_valid_scope(oauth2_context.scopes, allowed_scopes):
                    return view_fn(request=incoming_request, oauth2_context=oauth2_context)
                # return oauth error for invalid token
                else:
                    return OAuth2ErrorHandler.error_invalid_token(token.get('type'))
            # no token
            else:
                if optional:
                    return view_fn(request=incoming_request, oauth2_context=None)
                else:
                    raise HTTPUnauthorized('request contained no access token.')

        new_fn.__doc__ = view_fn.__doc__
        #new_fn.__name__ = view_fn.__name__ WITH THIS IT DOESNT WORK, COMMENTED IT
        new_fn.view_name = view_fn.view_name MAYBE ITS LIKE THIS?
        #return new_fn CANT RETURN HERE, IT GOES DIRECTLY TO THE VIEW, COMMENTED IT
    return wrap 
```

# asp.net-mvc - 为什么 ASP.NET MVC 4 有这么多的 NuGet 包，哪些是真正重要的？

> ID：11996173
> 
> 赞同：38
> 
> 时间：2012-08-16T22:11:21.360
> 
> 标签：asp.net-mvc, asp.net-mvc-4, nuget, .net-assembly

正如标题所说，为什么 ASP.NET MVC 4 项目有这么多的 NuGet 包？现在整个框架都拆分成包了吗？哪些对于将是网站、没有 API 等的空项目真正重要？

**更新**

澄清一下，我没有问题，好吧，除非你把基本的混淆算作一个。我只想知道为什么新的MVC 4项目默认安装了这么多包？一个空的项目有一整页的包。一个互联网项目有三整页的包。

我只是好奇为什么这是因为我当前的 MVC 3 项目最多使用五个包。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-17T05:58:40.557

> 正如标题所说，为什么 ASP.NET MVC 4 项目有这么多的 NuGet 包？

这是您需要询问框架设计者的问题。

> 哪些对于将是网站、没有 API 等的空项目真正重要？

这是允许您配置路由并使用呈现 Razor 视图的操作定义控制器的严格最低要求：

```
<packages>
  <package id="Microsoft.AspNet.Mvc" version="4.0.20710.0" targetFramework="net40" />
  <package id="Microsoft.AspNet.Razor" version="2.0.20710.0" targetFramework="net40" />
  <package id="Microsoft.AspNet.WebPages" version="2.0.20710.0" targetFramework="net40" />
  <package id="Microsoft.Web.Infrastructure" version="1.0.0.0" targetFramework="net40" />
</packages> 
```

或者如果您只喜欢一页的 1/2：

![在此处输入图像描述](../Images/502b44860fb1960cdf475d44a17e0601.png)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-08-27T20:42:17.810

自 ASP.NET MVC 3 工具更新以来，越来越多的 ASP.NET MVC 通过 NuGet 包交付。这提供了几个优点：

*   升级到通过 NuGet 交付的组件 - MVC 本身和其他相关组件（Razor、Web API），而无需等待 ASP.NET MVC、.NET 或 Visual Studio 的新“大”版本。
*   这也意味着您可以在 MVC 之外随意使用各个部分——例如，可以在 ASP.NET 之外使用 Web API。
*   越来越多的组件在 UI 层和 ASP.NET 的其他部分之间共享。一些示例：路由与 Web 表单和网页共享，Razor 与网页共享，新的 OAuth 部分与 Web 表单共享。

您会注意到，在来自 Basic 模板的项目中，您将获得以下包：

*   Microsoft.AspNet.Mvc
*   Microsoft.AspNet.Razor
*   Microsoft.AspNet.WebApi
*   Microsoft.AspNet.WebApi.Client
*   Microsoft.AspNet.WebApi.Core
*   Microsoft.AspNet.WebApi.WebHost
*   Microsoft.AspNet.WebPages
*   Microsoft.Net.Http
*   Microsoft.Web.Infrastructure
*   牛顿软件.Json

九个中有五个用于 Web Api，它已经高度组件化，允许开发人员在哪里以及如何使用它们方面有很大的灵活性。如果要最小化 NuGet 包，可以使用 Basic 模板。

随着您进入 Basic 和 Internet 模板，您会看到更多的包来支持项目提供的附加功能。Internet 引入了多个开源、非 Microsoft 代码包，例如 OAuth 和 JavaScript 库。

有很多 JavaScript 包，仔细想想，这是一件非常好的事情，因为这意味着 NuGet 会自动为您处理 JavaScript 依赖项——如果您想升级 jQueryUI，而后者又需要新版本的 jQuery，它'会自动为你升级 jQuery。

# ruby-on-rails-3 - Rails 缓存消息

> ID：11996174
> 
> 赞同：2
> 
> 时间：2012-08-16T22:11:22.923
> 
> 标签：ruby-on-rails-3, memcached, ruby-on-rails-3.2, dalli

我正在使用 Rails.cache.read/write/fetch 方法。当我执行这些操作时，我会在我的日志中看到以下消息（见下文）。我想知道它们的意思，我理解读/写消息，但是 Fetch Hit and Generate 怎么样。

用例（**缓存为空**） - 所以当我使用时，`Rails.cache.fetch("city/#{key}") { return city_object }`我看到 3 条日志消息 - 读取、生成和写入。但是，如果我使用读取（检查密钥是否存在）/（否则）写入，我只会看到读取和写入消息，所以想知道什么更有效。

`CACHE Read city/key1`

`CACHE Write city/key1`

`CACHE Generate city/key1`

`CACHE Fetch Hit city/key1`

此外`fetch`，带有块的 a 会同时生成“Read...”和“Fetch Hit...”消息，而仅 a 会`read`生成“Read...”消息。在这两种情况下，缓存都有键/值对。

这是一个 Rails 3.2.8 应用程序，我使用 dalli gem 作为 memcached 客户端。

# javascript - 动画和 IE 文本阴影冲突

> ID：11996176
> 
> 赞同：0
> 
> 时间：2012-08-16T22:11:26.197
> 
> 标签：javascript, jquery, animation, css

我有 2 个小问题：1）我使用基于 Kilian Valkof 插件的脚本在 IE7/8/9 中设置了文本阴影。由于它们是动画的，当您在 IE 中将鼠标悬停然后鼠标移出时，它们后面会产生一个黑框，一旦每个字母的动画完成，黑框就会消失。如果我注释掉 IE 插件，那么阴影当然不会在 IE 中呈现，但是黑匣子问题已经消失，所以这两个插件之间发生了一些事情，需要一点帮助。我怎样才能让黑色闪烁停止？

这是一个 JSfiddle（已删除）

2）我试图在文本阴影插件中为任何 span.sl-w2 分配更大的宽度（参见代码注释“更新宽度”）。跨度的宽度设置为自动，那么我如何分配它，即原始宽度+某个数字？这是 textShadow 插件（已修改）：

```
/* jQuery textShadow plugin for IE
* Version 1.1 (26/02/2010)
* @requires jQuery v1.2+
*
* Copyright (c) 2008 - 2010 Kilian Valkhof (kilianvalkhof.com)
* Dual licensed under the MIT and GPL licenses:
* http://www.opensource.org/licenses/mit-license.php
* http://www.gnu.org/licenses/gpl.html
*
* MODIFICATIONS made **
*/
(function($) {
  $.fn.textShadowls = function(useroptions) {
   return this.each(function() {
    var obj = $(this);
    // obj.removeTextShadowls(); // Don't know why this is necessary? 
    var col = '#000000'; // %id=?somecolor?%       
    var blurrad = 3; // %id=shblur1%
    var gstr = 8; // %id=shx1%
    var text = "<span class='jQshadls'>" + obj.html() + "</span>";
    var pleft = 3 + 'px';
    var initwd2 = obj.width();  // Should pull width from .sl-w2? I think that's $(this)
    console.log('This Init Width:' + initwd2);        
    var wd = initwd2 + gstr + 'px !important';
    var defaults = {
      color: col,
      blur: blurrad,
      glowstr: gstr,
      opacity: 60
    };
    var options = $.extend(defaults, useroptions);
    options.color = (options.color.length == 4) ? options.color.replace(/#([0-9A-f])([0-9A-f])([0-9A-f])/i, '#$1$1$2$2$3$3') : options.color;
    var filtertext = "glow(strength="+options.glowstr+" color="+options.color+")blur(strength="+options.blur+" direction=45)blur(strength="+options.blur+" direction=90)blur(strength="+options.blur+" direction=135)blur(strength="+options.blur+" direction=180)blur(strength="+options.blur+" direction=225)blur(strength="+options.blur+" direction=270)blur(strength="+options.blur+" direction=315)blur(strength="+options.blur+" direction=360)progid:DXImageTransform.Microsoft.Alpha(opacity="+options.opacity+")";
    if($.browser.msie && options != "") {
      if (obj.is('.sl-w2')) {
        // obj.css({"zoom":"1"}).append(text);
        obj.append(text);  
        obj.children("span.jQshadls").css({
          "position":"absolute",
          "width":wd,  
          "padding-left":pleft,
          "z-index":"-1",
          "zoom":"1",
          "filter":filtertext,
          "-ms-filter":filtertext 
        });
        $('span.sl-w2').css({'width':wd, 'padding-left':pleft});// UPDATE WIDTH 
      } else {
        // obj.css({"zoom":"1"}).append(text);
        obj.append(text);  
        obj.children("span.jQshadls").css({
          "position":"absolute",
          "z-index":"-1",
          "zoom":"1",
          "filter":filtertext,
          "-ms-filter":filtertext 
        });
        //obj.parent().
      }   
    }
  });
};
$.fn.removeTextShadowls = function() {
  return this.each(function() {
    $(this).children("span.jQshadls").remove();
  });
};
})(jQuery); 
```

谢谢，比尔

BUMP：有人可以帮我解决这些问题吗？我真的很努力，但需要一些编码帮助 :-) 比尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T18:29:00.477

终于想通了 ;-) 只需要使用带 PixelRadius 和 ShadowOpacity 的模糊。

后来，比尔

# javascript - 如何一个接一个地运行一个脚本？

> ID：11996183
> 
> 赞同：0
> 
> 时间：2012-08-16T22:11:46.863
> 
> 标签：javascript, jquery, html, css

我有一个浏览器调整大小脚本：

```
$(document).ready(function() {
    $(window).on('resize', function() {
        if ($(this).height() <= 800) {
            $('.content').css('max-height', '500px'); //set max height
        } 
        else {
            $('.content').css('max-height', ''); //delete attribute
        }
    }).resize()
}) 
```

我想让 jscrollpane 在窗口调整大小后运行，因为那是我需要滚动条的时候。在当前代码中，我只显示常规滚动条。

```
$(function() {
    $('.scroll-pane').jScrollPane();
}); 
```

有没有办法在最大高度脚本完成后运行这个脚本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T22:14:28.133

```
<script type="text/javascript">
$(document).ready(function() {

   $(window).on('resize', function(){
     if ($(this).height() <= 800){
      $('.content').css('max-height', '500px'); //set max height
     } else{
      $('.content').css('max-height', ''); //delete attribute
   }

   $('.scroll-pane').jScrollPane(); //why not call it here?

 }).resize()
})
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:16:09.707

你只是在这里调用一个方法：

```
$('.scroll-pane').jScrollPane(); 
```

..JavaScript 完全有能力在单个脚本块中做更多的事情。您不必将每个操作视为单独的脚本。

因此，只需将您的方法调用放在 resize-event-handler 中，例如：

```
$(window).on('resize', function(){
    if ($(this).height() <= 800){
        $('.content').css('max-height', '500px'); //set max height
    } else{
      $('.content').css('max-height', ''); //delete attribute
    }

    $('.scroll-pane').jScrollPane(); // just call it here!
} 
```

..你完成了。

阅读一些关于 JavaScript 的文章可能会很有用。或者一些书。

一些不错的起点：
[http ://www.w3schools.com/js/default.asp](http://www.w3schools.com/js/default.asp)
[http://www.codecademy.com/](http://www.codecademy.com/)

享受！

# php - Symfony 2 子域的问题

> ID：11996188
> 
> 赞同：0
> 
> 时间：2012-08-16T22:12:42.847
> 
> 标签：php, .htaccess, symfony

我认为我对 htaccess 有问题。

我有一个重定向到文件夹的子域，例如`subdomain.domain.com --> home/subdomain`

问题是，如果我写`subdomain.domain.com`没有重定向到 app.php，如果我写 subdomain.domain.com/app.php 它可以工作。

另一方面，如果我编写`domain.com/subdomain/web`（假设这是通往应用程序的路径），则无需编写 app.php。

所以它适用于两者： `domain.com/subdomain/web/ and domain.com/subdomain/web/app.php`

我有以下htaccess：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ app.php [QSA,L]
</IfModule> 
```

我不知道htaccess

PS：不知道问题有没有理解，我想在写subdomain/domain.com的时候直接访问subdomain.domain.com/app.php

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:27:26.860

```
RewriteEngine on 
RewriteCond %{HTTP_HOST} ^(.*)\.mydomain\.com$
RewriteCond %{HTTP_HOST} !^www\.mydomain\.com$
RewriteRule (.*) http://mydomain.com/%1$1 
```

检查这个：[http](http://www.sitepoint.com/getting-started-apache-mod_rewrite-methods/) ://www.sitepoint.com/getting-started-apache-mod_rewrite-methods/ 并搜索“子域”

# extjs4 - ExtJS、Sencha Build Tools 和需要身份验证的网站

> ID：11996189
> 
> 赞同：0
> 
> 时间：2012-08-16T22:13:03.700
> 
> 标签：extjs4, extjs, extjs4.1

用户有什么方法可以将身份验证数据（用户名和密码）提交给以下 Sencha Build Tools 命令：

```
sencha create jsb -a https://localhost:8443/my/site -p app.jsb3 
```

发现[这](http://blog.lansdowntech.com/2012/02/creating-an-extjs-production-build-with-sencha-sdk-tools/)很有用；它指出：

> 似乎没有为 Sencha SDK 工具指定任何必要的用户名/密码，因此您需要针对不需要 HTTP 身份验证的本地 Web 服务器实例运行。

但是，如果没有经过身份验证的用户（会破坏服务器端），我就没有资格运行。

可以做什么？最新版本中添加/改进的任何功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T01:32:27.280

这是我的做法。我很想听听是否有人有更好的建议。

1.  `Ext.require`创建一个带有根级引用的测试网页。这不需要任何服务器端编码。请记住启用动态加载`Ext.Loader.setConfig( {enabled: true...})`
2.  使其无需身份验证即可访问。
3.  在 Firefox 中打开页面并使用 Firebug 的 Net 面板验证所有 js 文件是否已加载。
4.  现在您可以将此页面 URL 与 Sencha 工具一起使用。

# iphone - cocos2d，瓷砖地图游戏

> ID：11996193
> 
> 赞同：0
> 
> 时间：2012-08-16T22:13:16.373
> 
> 标签：iphone, xcode, cocos2d-iphone

你们中的任何一个人现在是否有一些技巧或技巧来制作一个有某些瓷砖在整个棋盘上移动的瓷砖地图游戏。我一直想学这个技巧，但我不知道该怎么做。我有瓷砖地图编辑器和一切设置。我正在尝试制作平台游戏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:40:49.190

我非常想查看本教程，以获得制作基于瓷砖的游戏的优秀指南，特别是在 cocos2d 中：[http ://www.raywenderlich.com/1163/how-to-make-a-tile-based-game- with-cocos2d](http://www.raywenderlich.com/1163/how-to-make-a-tile-based-game-with-cocos2d)

# java - 如何知道以“cmd start”启动的进程的状态？

> ID：11996197
> 
> 赞同：0
> 
> 时间：2012-08-16T22:13:29.630
> 
> 标签：java, process

我正在尝试编写一个小工具，如果它们已被终止，它会重新启动一定数量的 jar。

```
private static void checkAndRestartProcesses() {
    for ( int i=0; i<processes.size(); i++ ) {
        try {
            processes.get(i).exitValue();
            processes.remove(i);
        } catch (IllegalThreadStateException ex) {
        }
    }
    try {
        for ( int i=processes.size(); i<Config.NR_PROCESSES; i++ ) {
            ProcessBuilder pb = new ProcessBuilder("cmd", "/c start cmd /c java -jar bla.jar");
            Process p = pb.start();
            processes.add(p);
        }
    } catch (IOException ex) {
    }
} 
```

问题在于，以“cmd start”启动的进程在执行子进程后立即退出（因此，没有 IllegalThreadStateException）。我如何跟踪子进程（无论它们是否被终止）？或者：如何在不使用“cmd start”的情况下在单独的 cmd 中启动子进程。我需要启动的例程在一个新的 cmd 中。

提前非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:45:23.920

您需要在开始时使用 /wait 标志

```
cmd /c start /wait java -jar bla.jar 
```

# android - 在 EditText Changed Listener 上，Integer.parseInt() 不起作用

> ID：11996200
> 
> 赞同：0
> 
> 时间：2012-08-16T22:13:48.230
> 
> 标签：android, parsing, listener, onchange, android-edittext

当添加将文本解析为整数的行时，应用程序停止，并且没有此行它运行良好

```
final TextView secNumber= (TextView)findViewById(R.id.secNumber);
final EditText mainNumber=(EditText)findViewById(R.id.mainNumber);

mainNumber.addTextChangedListener(new TextWatcher(){
    public void afterTextChanged(Editable S){
        secNumber.setText(Integer.parseInt(S.toString())*100);
    }

    public void beforeTextChanged(CharSequence arg0, int arg1, int arg2,
            int arg3) {
        // TODO Auto-generated method stub

    }

    public void onTextChanged(CharSequence s, int start, int before,
            int count) {
        // TODO Auto-generated method stub

    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T03:26:36.683

尝试这个：

```
 secNumber.setText((Integer.parseInt(S.toString())*100).toString()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-07T14:14:15.460

您正在为 secNumber.setText( *Integer* ) 提供一个整数，并且该函数可能需要一个字符串。最后放一个 toString() 。

尝试类似的东西

```
Integer  pipi= Integer.parseInt(S.toString())*100);
secNumber.setText(pipi.toString()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T22:18:47.857

你需要找出里面有什么`S`。显然，它不可解析。将操作包装`parseInt`在一个`try` `catch`块中，或使用“TryParse”，如此[处所示](https://stackoverflow.com/a/1486082/102937)。

# regex - 如何查找包含文件中给定整数的行？

> ID：11996201
> 
> 赞同：1
> 
> 时间：2012-08-16T22:14:19.817
> 
> 标签：regex, search, awk, grep, pattern-matching

我有一个`dict`每行包含一个整数的文件

```
123
456 
```

我想在文件中找到*完全*`file`包含.*`dict`*

 *如果我使用

```
$ grep -w -f dict file 
```

我得到错误的匹配，例如

```
12345  foo
23456  bar 
```

这些是错误的，因为`12345 != 123`和`23456 != 456`。问题是该`-w`选项也将数字视为单词字符。该`-x`选项也不起作用，因为其中的行`file`可以有其他文本。请问最好的方法是什么？如果该解决方案能够在大尺寸上提供进度监控`dict`和良好的性能，那就太好了。`file`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:25:32.567

将单词边界添加到 dict 中，如下所示：

```
\<123\>
\<456\> 
```

-w 参数不是必需的。只需要：

grep -f 字典文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T22:21:05.743

您可以使用 Python 脚本轻松完成此操作，例如：

```
import sys

numbers = set(open(sys.argv[1]).read().split("\n"))
with open(sys.argv[2]) as inf:
    for s in inf:
        if s.split()[0] in numbers:
            sys.stdout.write(s) 
```

错误检查和恢复留给读者实施。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T23:23:51.620

一种相当通用的方法，使用`awk`：

```
awk 'FNR==NR { array[$1]++; next } { for (i=1; i<=NF; i++) if ($i in array) print $0 }' dict file 
```

**解释：**

```
FNR==NR { }  ## FNR is number of records relative to the current input file. 
             ## NR is the total number of records.
             ## So this statement simply means `while we're reading the 1st file
             ## called dict; do ...`

array[$1]++; ## Add the first column ($1) to an array called `array`.
             ## I could use $0 (the whole line) here, but since you have said
             ## that there will only be one integer per line, I decided to use
             ## $1 (it strips leading and lagging whitespace; if any)

next         ## process the next line in `dict`

for (i=1; i<=NF; i++)  ## loop through each column in `file`

if ($i in array)       ## if one of these columns can be found in the array

print $0               ## print the whole line out 
```

**使用 bash 循环处理多个文件：**

```
## This will process files; like file, file1, file2, file3 ...
## And create output files like, file.out, file1.out, file2.out, file3.out ...

for j in file*; do awk -v FILE=$j.out 'FNR==NR { array[$1]++; next } { for (i=1; i<=NF; i++) if ($i in array) print $0 > FILE }' dict $j; done 
```

**如果您有兴趣在`tee`多个文件上使用，您可能想尝试这样的事情：**

```
for j in file*; do awk -v FILE=$j.out 'FNR==NR { array[$1]++; next } { for (i=1; i<=NF; i++) if ($i in array) { print $0 > FILE; print FILENAME, $0 } }' dict $j; done 2>&1 | tee output 
```

这将向您显示正在处理的文件的名称和找到的匹配记录，并将“日志”写入名为`output`.*

# asp.net - ASP.NET MVC：新线程中的异常呈现视图

> ID：11996205
> 
> 赞同：10
> 
> 时间：2012-08-16T22:14:42.157
> 
> 标签：asp.net, asp.net-mvc, view, multithreading

我想在我的 ASP.NET 应用程序中创建一个手动触发的进程，并将一堆电子邮件发送给我的用户。由于这个过程需要一段时间，我正在创建一个新线程来发送这些消息并防止我的网络应用程序超时。（我知道如果应用程序池被回收或应用程序中有未处理的异常，这很容易出错，但这是另一个主题）。

为此，我正在做这样的事情：

```
public ActionResult SendMessages()
{
  Task.Factory.StartNew(() => { SendMessagesLongRunningProcess(); });
  return View();
} 
```

在长期运行的过程中，我试图呈现 HTML 电子邮件的视图并发送它。像这样：

```
private void SendMessagesLongRunningProcess()
{
  var users = GetUsers();
  foreach (var user in users)
  {
    string message = RenderView("EmailMessage", user);
    SendEmail(user.email, message);
  }
} 
```

现在，我知道我的 RenderView 方法工作得很好，因为我使用它在其他地方呈现电子邮件视图。问题是当我在这里尝试在新线程中执行它时。这是我的 RenderView 方法：

```
 public string RenderView(string viewName, object model)
    {
        ViewData.Model = model;
        using (var sw = new StringWriter())
        {
            var viewResult = ViewEngines.Engines.FindView(ControllerContext, viewName, null);
            var viewContext = new ViewContext(ControllerContext, viewResult.View, ViewData, TempData, sw);
            viewResult.View.Render(viewContext, sw);
            return sw.GetStringBuilder().ToString();
        }
    } 
```

我得到的错误是：

```
Value does not fall within the expected range. 
```

当调用 viewResult.View.Render 方法时。

我猜这与控制器上下文在新线程中不再有效的事实有关，但我不确定。

那么，解决这个问题的最佳方法是什么？我有什么选择？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-17T05:15:15.833

> 我猜这与控制器上下文在新线程中不再有效的事实有关，但我不确定。

恰恰。

> 那么，解决这个问题的最佳方法是什么？

从另一个进程发送电子邮件，而不是您的 ASP.NET MVC 应用程序。

> 我有什么选择？

一种可能性是使用[`RazorEngine`](http://razorengine.codeplex.com/)：

```
private void SendMessagesLongRunningProcess()
{
    var users = GetUsers();
    foreach (var user in users)
    {
        string view = Server.MapPath("~/Views/MailTemplates/SomeTemplate.cshtml");
        string template = System.IO.File.ReadAllText(view);
        string message = Razor.Parse(template, user);
        SendEmail(user.email, message);
    }
} 
```

您也可以[`MvcMailer`](https://github.com/smsohan/MvcMailer/wiki/MvcMailer-Step-by-Step-Guide)异步结帐和发送电子邮件（查看`Send Email Asynchronously`分步指南部分）。

# android - 完全方形按钮（带有图像和文本）

> ID：11996207
> 
> 赞同：0
> 
> 时间：2012-08-16T22:14:48.427
> 
> 标签：android, android-layout, android-button

我有 4 个图像 + 文本按钮排列在 4x4 网格中。我正在使用带有 android:drawableTop 属性的 a 。按钮背景是可绘制的状态列表。它们是两个嵌套的 LinearLayouts 的子元素，它们以 2x2 网格排列。

我的问题是，出于美学原因，我希望按钮完全是方形的。我该怎么做呢？在某些设备上，它们被拉得很高，而在其他设备上，它们被压扁。无论屏幕尺寸或方向如何，有什么方法可以指示 Android 使高度和宽度始终相等？

如果要求不高，如果可以通过 XML 完成而不需要自定义 Java，那就太好了。

提前致谢...

按钮：

```
<Button
    android:id="@+id/btn_help_support"
    style="@style/btn_home"
    android:drawableTop="@drawable/home_btn_help_support"
    android:text="@string/home_btn_help_support" /> 
```

按钮样式：

```
<style name="btn_home">
    <item name="android:gravity">center</item>
    <item name="android:layout_width">fill_parent</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:layout_gravity">center</item>
    <item name="android:layout_marginLeft">10dp</item>
    <item name="android:layout_marginRight">10dp</item>
    <item name="android:layout_marginTop">10dp</item>
    <item name="android:layout_weight">1</item>
    <item name="android:paddingTop">10dp</item>
    <item name="android:paddingBottom">10dp</item>
    <item name="android:paddingLeft">10dp</item>
    <item name="android:paddingRight">10dp</item>
    <item name="android:background">@drawable/btn_std</item>
    <item name="android:drawablePadding">10dp</item>
    <item name="android:textColor">@color/btn_std_text</item>
    <item name="android:textSize">@dimen/home_btn_font_size</item>
</style> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:26:34.897

我相信这是因为您的`layout_width`和`layout_height`分别设置为`fill_parent`和`wrap_content`。

现在，考虑不同的屏幕尺寸可能会很棘手，因此硬编码整数值可能不起作用，但值得一试。否则，您将不得不从样式中省略这些并在 Java 中定义它们。

# ruby-on-rails - Rails路由到资源集？

> ID：11996214
> 
> 赞同：0
> 
> 时间：2012-08-16T22:15:24.747
> 
> 标签：ruby-on-rails, rest, routes

典型的 Rails 路线如：

```
 resource :customer 
```

为索引、显示等设置路线。

要访问所有客户，我可以使用该路线

```
/customers 
```

要访问单个客户，我使用：

```
/customers/1 
```

什么是创建允许用户查看一组客户的路由和控制器操作的最简洁、RESTful 方式，例如

```
/customers/[1,2,3,4,5] 
```

***更新了基本原理***

用例：

*   此操作将通过 Javascript 调用以提供有关选定用户的详细信息。如果用户通过界面选择 3 个客户，我希望一个请求为所有 3 个提取信息，而不是必须提出 3 个单独的请求

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:26:30.810

你可以保持你的路线简单：`resources :customers`.

id 列表将被路由视为`:id`，您将`[1, 2, 3, 4]`进入`params[:id]`.

然后在您的控制器中，例如在 before_filter 中，您可以检查 id 是否与某个正则表达式匹配（例如... `/\[(\d,)*\d\]/`），如果是这种情况，您可以提取 id。

# visual-studio-2010 - Visual Studio 源代码管理恢复未完成的挂起更改？

> ID：11996217
> 
> 赞同：5
> 
> 时间：2012-08-16T22:15:41.830
> 
> 标签：visual-studio-2010, version-control, tfs

是的，我就是那个白痴。但我确实只在 Pending Changes 面板中*选择了我想要撤消的文件。*它打开了一个新对话框，我错误地认为它只包含我在主面板中所做的选择。我说撤消一切，然后！一堆我不想撤消的东西被撤消了（很像毛衣歌曲。我是一个工具）。所以我的问题是：有没有办法恢复我撤销的工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-10T12:53:50.470

我做了完全相同的事情。幸运的是，在我重建项目之前，我已经意识到了这一点。我使用 Telerik JustDecompile 从程序集中获取丢失的代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T09:34:42.533

不。

除非您在 VS 中打开项目时这样做。如果是，那么您应该会看到一个对话框，询问您是否要重新加载文件（在 IDE 之外已更改）。然后，您可以说“不”并重新保存您的更改。

否则，据我所知，它将被覆盖（因此您甚至无法取消删除）。

此外，与问题没有直接关系，但这[已经](http://visualstudiogallery.msdn.microsoft.com/080540cb-e35f-4651-b71c-86c73e4a633d/)保存了我的培根一两次。不过，您确实需要为加载速度付出代价！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-03-06T16:12:52.453

如果你有幸通过 live-server 等浏览器在浏览器中查看你的作品，并且你还没有关闭页面，你可以右键单击并查看源代码。这将至少恢复您的 html 更改。

# scope - 未捕获关闭范围？— 咖啡脚本

> ID：11996218
> 
> 赞同：5
> 
> 时间：2012-08-16T22:15:44.717
> 
> 标签：scope, coffeescript

好吧，我不知道如何表达这个问题的标题。

```
openDir = (path) ->
socket.emit "get_metadata", path, (data) ->
    columnBox = $ "<div/>", class: "columnbox"
    for item in data.contents
        itemBox = $ "<div/>", class: "itembox"
        itemBox.click ->
            columnBox_inner.children().removeClass "selected"
            itemBox.addClass "selected" # <<<--- Over here
            openDir item.path
        columnBox.append itemBox
    columnBox.appendTo "#columnscontainer" 
```

我知道该变量是在's 范围内`itemBox`定义的。`openDir`但是由于指出的行在 lambda 函数中，不应该`itemBox`捕获`itemBox`父范围引用的对象，而不是突变为它引用的最后一个对象吗？

说得清楚一点，我希望每个点击处理程序都能自行`itemBox`执行`addClass "selected"`。但是发生的情况是，`itemBox`在每个点击处理程序中总是引用最后一个 itemBox。

我可以通过更改 itemBox 的声明位置来轻松解决此问题。即改变

```
for item in data.contents 
```

进入

```
data.contents.forEach (item) -> 
```

但我想知道为什么 lambda 函数不捕获变量当前值。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-16T22:32:11.863

这个循环：

```
for item in data.contents
    itemBox = $ "<div/>", class: "itembox" 
```

如果您不习惯 (Coffee|Java)Script 范围，这有点欺骗性。范围实际上看起来更像这样：

```
itemBox = undefined
for item in data.contents
    itemBox = $ "<div/>", class: "itembox" 
```

所以只有一个`itemBox`变量，循环的每次迭代都会使用同一个变量。单击处理程序保留对变量的引用，`itemBox`但在调用单击处理程序之前不会评估变量，因此所有处理程序最终都具有相同的`itemBox`值，这将是`itemBox`循环结束时的值。

来自[精美手册](http://coffeescript.org/#loops)：

> 当使用 JavaScript 循环生成函数时，通常会插入一个闭包包装器，以确保循环变量是封闭的，并且所有生成的函数不只是共享最终值。CoffeeScript 提供了`do`关键字，它立即调用传递的函数，转发任何参数。

所以你可以这样做：

```
for item in data.contents
    do (item) ->
        # As before... 
```

将您的`itemBox`范围分别限定到循环的每次迭代。

使用`forEach`：

```
data.contents.forEach (item) -> 
```

而不是一个简单的循环是有效的，因为您有效地将一个函数用作循环的主体，并且该函数内的任何变量都将作用于该函数。

# php - 提交具有多个动态输入的唯一记录

> ID：11996223
> 
> 赞同：0
> 
> 时间：2012-08-16T22:16:05.577
> 
> 标签：php, forms, foreach

在 SO 上的许多人的帮助下，我一直在制作一个表格。我有一个表单，用户可以在其中获得 1 个字段集来最初填写所有输入。然后他们可以单击添加更多或按原样提交表单。如果他们单击“添加更多”，则用户将再次获得所有输入，并且 foreach 允许将它们与 1 次提交中的第一个字段集一起提交。可以有任意多的用户想要的。

问题是每个提交的内容都不是唯一的。它们都被归为一个提交。

这是提交代码：

```
 if ($reqtype=="accesschange"){
            $subject="Request Access Change(s)";
            $a=$_REQUEST['request'];        
            foreach ($a as $name) {         
              foreach ($name as $key => $desc) {
                switch (gettype($desc)) {
                  case 'array':
                    foreach ($desc as $i => $item) {                    

                      //show which queue to go to based on C or D
                      $drive = ($item == "File System") ? "162" : "161";

                      $note .= "{$key}";
                      $note .= "&nbsp;".$item."\n";
                    }
                    break;
                  case 'string':
                  default:
                    if ($desc !== '') {                     
                      $note.= $key;
                      $note.= "&nbsp;".$desc."\n";
                    }
                }
              }
                $note .="\n";

                $note = $UP->stripSpecialChars($note);
                $note = $UP->remSlash($note);
                $myxml  = "<connector>";
                $myxml .= "<function name=\"incident_create\">";
                $myxml .= "<pair name=\"lvl_id3\"  type=\"integer\">".$note."</pair>";          
                $myxml .= "</function>";
                $myxml .= "</connector>";       
                echo $myxml;
            }
        } 
```

我怎样才能使这些中的每一个都成为独特的提交？我一直在想我需要某种计数器或方法来使这些中的每一个都独一无二……如果这令人困惑，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:55:38.397

需要一个计数器，但我会在您的表单代码而不是提交代码上说。

您需要确保每个字段都是唯一的，然后提交表单。

# objective-c - Objective-C 中架构 x86_64 的未定义符号

> ID：11996227
> 
> 赞同：2
> 
> 时间：2012-08-16T22:16:25.923
> 
> 标签：objective-c

我正在尝试实现在 Xcode 项目中找到的 AVFoundation 示例代码：http: [//developer.apple.com/library/mac/#qa/qa1740/_index.html#//apple_ref/doc/uid/DTS40011007](http://developer.apple.com/library/mac/#qa/qa1740/_index.html#//apple_ref/doc/uid/DTS40011007)

我所做的唯一修改是删除对自动释放、释放和保留的引用，因为我为项目启用了自动引用计数。成功解决了这些构建错误后，我现在得到“架构 x86_64 的未定义符号”。

我在 Mountain Lion 10.8 上运行，将 AVFoundation.h 导入头文件时没有出错，但似乎找不到 AV* 符号？

下面是错误日志、.h 和 .m 代码。更有知识的人可以帮助我确定问题所在吗？

日志：

```
Undefined symbols for architecture x86_64:
  "_AVCaptureSessionPresetMedium", referenced from:
      -[Recorder screenRecording:] in screenAppDelegate.o
  "_OBJC_CLASS_$_AVCaptureMovieFileOutput", referenced from:
      objc-class-ref in screenAppDelegate.o
  "_OBJC_CLASS_$_AVCaptureScreenInput", referenced from:
      objc-class-ref in screenAppDelegate.o
  "_OBJC_CLASS_$_AVCaptureSession", referenced from:
      objc-class-ref in screenAppDelegate.o
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

。H

```
#import <Cocoa/Cocoa.h>
#import <Foundation/Foundation.h>
#import <AVFoundation/AVFoundation.h>

@interface screenAppDelegate : NSObject <NSApplicationDelegate>
@end

@interface Recorder : NSObject <AVCaptureFileOutputRecordingDelegate> {
    @private AVCaptureSession *mSession;
    AVCaptureMovieFileOutput *mMovieFileOutput;
    NSTimer *mTimer;
}

-(void)screenRecording:(NSURL *)destPath;

@end 
```

.m

```
#import "screenAppDelegate.h"

@implementation screenAppDelegate

- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    // Insert code here to initialize your application
}

@end

@implementation Recorder

-(void)screenRecording:(NSURL *)destPath 
{
    // Create a capture session
    mSession = [[AVCaptureSession alloc] init];

    // Set the session preset as you wish
    mSession.sessionPreset = AVCaptureSessionPresetMedium;

    // If you're on a multi-display system and you want to capture a secondary display,
    // you can call CGGetActiveDisplayList() to get the list of all active displays.
    // For this example, we just specify the main display.
    CGDirectDisplayID displayId = kCGDirectMainDisplay;

    // Create a ScreenInput with the display and add it to the session
    AVCaptureScreenInput *input = [[AVCaptureScreenInput alloc] initWithDisplayID:displayId];
    if (!input) {
        //[mSession release];
        mSession = nil;
        return;
    }
    if ([mSession canAddInput:input])
        [mSession addInput:input];

    // Create a MovieFileOutput and add it to the session
    mMovieFileOutput = [[AVCaptureMovieFileOutput alloc] init];
    if ([mSession canAddOutput:mMovieFileOutput])
        [mSession addOutput:mMovieFileOutput];

    // Start running the session
    [mSession startRunning];

    // Delete any existing movie file first
    if ([[NSFileManager defaultManager] fileExistsAtPath:[destPath path]])
    {
        NSError *err;
        if (![[NSFileManager defaultManager] removeItemAtPath:[destPath path] error:&err])
        {
            NSLog(@"Error deleting existing movie %@",[err localizedDescription]);
        }
    }

    // Start recording to the destination movie file
    // The destination path is assumed to end with ".mov", for example, @"/users/master/desktop/capture.mov"
    // Set the recording delegate to self
    [mMovieFileOutput startRecordingToOutputFileURL:destPath recordingDelegate:self];

    // Fire a timer in 5 seconds
    mTimer = [NSTimer scheduledTimerWithTimeInterval:5 target:self selector:@selector(finishRecord:) userInfo:nil repeats:NO];
}

-(void)finishRecord:(NSTimer *)timer
{
    // Stop recording to the destination movie file
    [mMovieFileOutput stopRecording];

    //[mTimer release];
    mTimer = nil;
}

// AVCaptureFileOutputRecordingDelegate methods

- (void)captureOutput:(AVCaptureFileOutput *)captureOutput didFinishRecordingToOutputFileAtURL:(NSURL *)outputFileURL fromConnections:(NSArray *)connections error:(NSError *)error
{
    NSLog(@"Did finish recording to %@ due to error %@", [outputFileURL description], [error description]);

    // Stop running the session
    [mSession stopRunning];

    // Release the session
    //[mSession release];
    mSession = nil;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-16T22:20:48.840

仅仅导入头文件是不够的，你还必须将 AVFoundation 框架添加到你的项目中。此错误来自链接器，而不是编译器本身 - 可以找到 AVFoundation 标头并且源文件的编译成功，但是链接器无法从生成的目标文件中生成可执行文件，因为您没有告诉它（通过 Xcode 的设置）链接到 AVFoundation 框架。

请参阅[这篇关于编译过程](http://caml.inria.fr/pub/docs/oreilly-book/html/book-ora065.html)的文章以了解为什么会发生这种情况。

# security - 成为您自己的证书颁发机构并为您的电子邮件加密进行自签名有什么问题？

> ID：11996229
> 
> 赞同：9
> 
> 时间：2012-08-16T22:16:32.803
> 
> 标签：security, public-key-encryption, private-key, certificate-authority, smime

是否有任何真正的理由为您自己的电子邮件安全使用第 3 方证书颁发机构？

（意思是使用 S/MIME）

我发现我能够成为我自己的 CAuthority 并创建我自己的自签名根证书......并且它们安装在我的机器和移动设备上工作得很好。

是否有令人信服的理由使用第 3 方的付费证书而不是我自己控制的自行生成和签名的证书？

我一直在想——我最信任的人或实体对我经过验证的加密电子邮件的授权......是我！......为什么我会让一个额外的无法被我验证的实体进入那个通信链？- 如果我向谁发送电子邮件是其他认识我并相信是我的人..？我为什么要付钱给他们？

如果通信是在我的商业网站和不认识我并正在交易金钱的未知外部个人之间进行的，我可以理解......但对于个人电子邮件？在家人和知名朋友或同事之间？

还有什么我不明白的关于公私钥加密的东西，这使得拥有经过验证的第三者给我值得支付的证书？

我了解在处理网站上的商业或使用您的安全连接信任网站时需要 SSL 3rd 方验证。但是个人之间呢​​？看起来不一样……你个人认识的人更不一样。不？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-16T22:22:07.113

使用外部 CA 的唯一原因是您和另一方之间有一个共享的信任根。如果您控制所有机器，例如域中的所有机器，那么您完全没有理由不能使用自己的 CA。我们有自己的 Exchange 域 CA。它实际上比外部 CA 容易得多，因为服务器和客户端将自动获得 CA 证书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T15:29:02.803

这篇文章很好地描述了它：

[http://www.davidpashley.com/articles/cert-authority.html](http://www.davidpashley.com/articles/cert-authority.html)

这一个也非常好 - 看看侧边栏评论：

[http://www.area536.com/projects/be-your-own-certificate-authority-with-openssl/](http://www.area536.com/projects/be-your-own-certificate-authority-with-openssl/)

他没有特别提到 SMIME 电子邮件——但我认为它属于这一类。

我相信在我的情况下（小型个人安全）成为您自己的 CA 是一种有效且可行的做事方式 - 只要您能够围绕流程并在仔细了解限制的情况下进行操作。

我仍然会等待有人说服我，否则在这里...感谢所有答案，每个人都有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-21T15:44:46.870

在我看来，使用自签名 CA 是绝对有效的选择。由该 CA 颁发并用于电子邮件加密的证书的工作方式与从全球受信任的 CA 颁发的证书相同，唯一的例外是最终用户必须手动信任该 CA 一次。

这意味着关键步骤是信任自签名 CA。但是，您可以确保自签名 CA 是正确的，这比依赖*您必须信任但无权选择*的全球信托公司更安全。

例如，我们在网络上发布我们的公共 CA 证书，询问我们希望与谁交换加密邮件的其他人下载、导入和信任它。通过与我们检查证书的指纹，很容易确保他们没有获得伪造的证书。

一旦他们信任了我们的 CA，加密电子邮件交换就与使用商业“专业”（中级）证书没有区别。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-12-21T15:53:24.037

现在可以免费获得证书。上面的很多答案都是有效的，但我仍然选择使用证书来给像 gmail/yahoo/hotmail 这样的主机更少的理由让我进入垃圾邮件（虽然并不总是有效）。

Spf，dkim，certs ..它们都是免费的，为什么不呢？

我正在使用 postfix+letsencrypt 并且工作出色。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2014-07-01T16:19:19.983

当人们加密他们的电子邮件时，他们只希望电子邮件通过网络传输并作为加密数据集存储在目标系统上，只有私钥持有者才能读取。

签署电子邮件是一项附加功能，应识别电子邮件的发件人。传统上，在西半球使用纸上签名，这很容易伪造。因此，重要文件需要签名证明。SMIME 的数字证书授权机构通常只证明请求者可以访问某个电子邮件地址，这可能一文不值——当然不是 20 美元/年。

对我来说，通过电子邮件发送我的私钥或在记忆棒上交换它是完全可以的。更重要的是在您真正想要安全通信时保护您的私钥。通常，每个可以访问您的 PC 的人也可以访问您的私钥！我正在使用智能卡来生成和存储私钥。钥匙永远不会离开卡片。但是，您必须信任智能卡。我确实信任我的卡，因为它是由我的团队开发的。这当然不是很多人的选择。

# jenkins - 用于源代码管理的 Jenkins 配置引发错误

> ID：11996235
> 
> 赞同：0
> 
> 时间：2012-08-16T22:17:36.530
> 
> 标签：jenkins, jenkins-plugins

我在源代码管理部分输入了颠覆 URL。我 100% 确定 URL 是正确的，并且我之前已经成功输入了很多次。但现在突然间，詹金斯抛出

> “状态码 500 异常：java.lang.NoSuchMethodError：org.tmatesoft.svn.core.internal.wc.DefaultSVNAuthenticationManager.setAuthenticationStorageOptions(Lorg/tmatesoft/svn/core/internal/wc/ISVNAuthenticationStorageOptions;)V Stacktrace:javax.servlet。 ServletException：java.lang.NoSuchMethodError：“

为什么会这样？如何解决这个问题？

ps：可以在浏览器上做一个Ctrl++查看图片

![在此处输入图像描述](../Images/85ea4fefcdeb5af8a5c06a6c44e28dfa.png)

# iphone - 如何在“聊天”应用程序中传输图像

> ID：11996236
> 
> 赞同：0
> 
> 时间：2012-08-16T22:17:38.213
> 
> 标签：iphone

我是 iphone 应用程序编程的新手，目前我使用“聊天”应用程序与其他 iPhone 进行通信。我想知道如何修改“聊天”以便在使用聊天应用程序时将图像从一部 iPhone 发送到另一部 iPhone。我感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:24:20.577

Chatty 目前只发送字符串，因此您需要[扩展它以支持任意消息类型](http://xkcd.com/974/)。所以不是只发送一个字符串，而是发送类型和数据，其中类型是字符串或图像，而数据是数据。

在 LocalRoom.m 和 RemoteRoom.m 中查找这行代码：

```
 BLIPRequest *req = [BLIPRequest requestWithBodyString: message]; 
```

Chatty 使用[BLIP](https://bytebucket.org/snej/mynetwork/wiki/Documentation/html/index.html)库。要发送图像，请调用 requestWithData。

# ruby-on-rails - Nginx + 乘客：多个域需要指向不同的根

> ID：11996240
> 
> 赞同：1
> 
> 时间：2012-08-16T22:17:48.657
> 
> 标签：ruby-on-rails, ruby, nginx, passenger

一直在与 Nginx 和乘客合作。我已成功让一个应用程序/域正常工作。但是对于我的服务器，我有 2 个以上的域，我计划从 nginx 到它们各自的根目录，每个 Rails 应用程序都将在该根目录中运行。

我尝试了许多技术，但没有一个奏效。所有域都采用第一个根设置，而不是它们应该是的根。

这是我的 nginx.conf 文件：

```
 server { 
    listen 80;
    server_name www.danielcw.info;
    root /root/public/danielcw.info/public;   # <--- be sure to point to 'public'!
    access_log  /root/public/danielcw.info/log/access.log;
    error_log /root/public/danielcw.info/log/error.log;
    passenger_enabled on;
    rails_env development;
  } 

  server {
    listen 80;
    server_name www.ericoppi.com;
    root /root/public/ericcoppi.com/public;   # <--- be sure to point to 'public'!
    access_log  /root/public/ericcoppi.com/log/access.log;
    error_log /root/public/ericcoppi.com/log/error.log;
    passenger_enabled on;
    rails_env development;
  } 
```

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:52:40.877

该配置应该可以正常工作 - 我要做的唯一更改是通过 nginx 提供 www 和 no-www 服务：

```
 server { 
    listen 80;
    server_name danielcw.info www.danielcw.info;
    root /root/public/danielcw.info/public;
    access_log  /root/public/danielcw.info/log/access.log;
    error_log /root/public/danielcw.info/log/error.log;
    passenger_enabled on;
    rails_env development;
  } 

  server {
    listen 80;
    server_name ericoppi.com www.ericoppi.com;
    root /root/public/ericcoppi.com/public;
    access_log  /root/public/ericcoppi.com/log/access.log;
    error_log /root/public/ericcoppi.com/log/error.log;
    passenger_enabled on;
    rails_env development;
  } 
```

确保在编辑配置文件后重新启动了 nginx。

# bash - Bash 脚本。带有通配符的 grep 不起作用

> ID：11996241
> 
> 赞同：1
> 
> 时间：2012-08-16T22:17:49.927
> 
> 标签：bash, grep, special-characters, wildcard

在 bash 中，我试图在命令 (ntp) 的输出中搜索 (grep) 以查找特定字符串。但是，输出中的一列是不断变化的。因此，对于该列，它可以是任何字符。

我可能没有正确执行此操作，但`*`并没有像我希望的那样工作。

```
ntpq -p | grep "10 l * 64  377  0.000  0.000  0.001" 
```

星号正在用第二个替换从 - 变为 1-64 的列。

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T22:31:52.450

`*`正则表达式中的A`*`与 shell 通配中的 a 不同。以下来自 regex(7) 联机帮助页：

```
An atom followed by '*' matches a sequence of 0 or more matches of  the  atom. 
```

这意味着在您的正则表达式中，您说的是“匹配 0 个或更多空间”。如果要匹配 0 个或多个任意字符，则需要`.*`.

```
ntpq -p | grep "10 L .* 64 377 0.000 0.000 0.001" 
```

虽然，您可能想要匹配“一个或多个任意字符”：

```
ntpq -p | grep -E "10 L .+ 64 377 0.000 0.000 0.001" 
```

更好的是，只匹配数字或`-`：

```
ntpq -p | grep -E "10 L [[:digit:].\-]+ 64 377 0.000 0.000 0.001" 
```

# php - jQuery在布局之间动态切换

> ID：11996251
> 
> 赞同：0
> 
> 时间：2012-08-16T22:18:33.647
> 
> 标签：php, jquery, ajax, layout, toggle

我希望有人可以在这里为我指明正确的方向。我有一个简单的媒体页面，`'1', '2' and '3'`在 MySql 数据库中有三个布局。当我加载页面时，我会检查数据库中设置的布局并使用下面的代码来显示正确的代码块 - 这非常有效。现在，使用 jQuery，我希望能够有 3 个图形按钮在 3 个布局之间动态切换。我想要实现的是：

1.  默认情况下，布局 1 已设置，图标 1 设置为翻转“开”状态。
2.  单击图标二将动态设置 $album['layout'] 为“2”并更新页面，将数据库从 1 更新为 2，并将图标一更改为翻转“关闭”状态并将图标二更改为翻转'开启状态。
3.  下次用户访问该页面时，将设置布局 2，并且图标 2 将处于翻转“打开”状态。

我对 PHP 比较陌生，我刚刚开始了解 jQuery - 但我了解所有基本概念 - 我只是想不出如何做到这一点，而且我似乎无法在网上找到任何可以指出的东西我朝着正确的方向实现这一目标。任何见解将不胜感激。

* * *

php中用于显示正确代码块的代码

```
<?php

    if ($album['layout'] == 1) {

        //Display Album Layout 1

    } else if ($album['layout'] == 2) {

        //Display Album Layout 2

    } else if ($album['layout'] == 3) {

        //Display Album Layout 3
    }

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:29:52.620

听起来像是典型的前端工作。让你成为一个小小提琴，因为这个问题对于一个直截了当的答案来说有点太宽泛了。

[http://jsfiddle.net/mNbLa/1/](http://jsfiddle.net/mNbLa/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T22:32:22.360

似乎 Ajax 是您的问题的解决方案。

使用 jQuery，您可以轻松地更新页面。您甚至可以切换整个样式表，请参阅[此问题](https://stackoverflow.com/questions/7846980/how-do-i-switch-my-css-stylesheet-using-jquery)以获取更多信息

使用 Ajax，您可以向服务器发送调用以更新存储在数据库中的值，而无需刷新页面。有关让 JavaScript 与 PHP 对话的更多信息，请参阅[此问题。](https://stackoverflow.com/questions/2269307/using-jquery-ajax-to-call-a-php-function)

* * *

例子：

显示的页面让我们称之为**`index.php`**：

```
<?php require_once("ajax.php"); //include your functions ?>

<html>
  <head>
    <title>Toggle</title>
    <!-- include jQuery -->
    <script 
      src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"
      type="text/javascript"></script>
    <!-- include your javascript -->
    <script src="js/functions.js" type="text/javascript"></script>
  </head>
  <body>

    <!-- This div will hold the current album layout -->
    <div id="albumLayoutDiv">
      <?php
        // Gets the album specified in $album['layout'] so it will
        // display on page load. This is defined in ajax.php
        echo GetAlbumLayout($album['layout']);
      ?>  
    </div>

    <input id="layout1" type="button" value="layout 1" /> 
    <input id="layout2" type="button" value="layout 2" /> 
    <input id="layout3" type="button" value="layout 3" /> 

  </body>
</html> 
```

如您所见，`GetAlbumLayout`此处未定义，我已将其移至名为的外部文件**`ajax.php`**：

```
<?php

function GetAlbumLayout($layout) {
  if ($layout == 1) {

    // UPDATE THE DATABASE TO LAYOUT 1
    return $htmlForLayout1; // Display Album Layout 1

  } else if ($layout == 2) {

    // UPDATE THE DATABASE TO LAYOUT 2
    return $htmlForLayout2; // Display Album Layout 2

  } else if ($layout == 3) {

    // UPDATE THE DATABASE TO LAYOUT 3
    return $htmlForLayout3; // Display Album Layout 3

  }
}

// Here is where we look at the values that were passed though
// Ajax. Remember the we used POST, and set the values in 'data'?
// You can see all of that here. You get the values by using 
// $_POST['key'] = value. In this case I am using "action" to 
// determine what PHP function we want to call.

// If 'action' is set from the Ajax call
if(isset($_POST['action']) && !empty($_POST['action'])) {

  $action = $_POST['action'];

  switch($action) {
    // We set action to 'changeLayout' in the Ajax call
    case 'changeLayout': 

      // likewise, we set "layoutNum" to be the number that the
      // user clicked on. We access this value in the same was as
      // the action
      GetAlbumLayout($_POST['layoutNum']);
      break;

    /* 
    case 'anotherAction' : 
      someOtherFunction();
      break; 
    */

    // ...etc... Add more here if you want to perform different
    // ajax calls down the road
  }
}

?> 
```

现在终于是 Ajax 调用和将其结合在一起的 Javascript **`functions.js`**：

```
// This function fetches the layout number that we want from
// php and updates the "albumLayout" div on the page when
// successful.
function changeLayout(layoutNumber) {

  // Start the Ajax call
  $.ajax({ 
    // set the url to your ajax.php file. This is what this
    // Ajax call will POST to.
    url: '/php/ajax.php', 
    type: 'post',
    // the data can be thought of as the paramaters that you can
    // use on the PHP side of things. Think of it as a dictionary
    // or a map of values. You can pass in anything here that you
    // need in PHP to call a function
    data: {
      action: 'changeLayout', // what we want to do
      layoutNum: layoutNumber    // the layout that was requested
    },
    // After we get the results back from PHP, it is stored as a 
    // string inside of output. Ajax is async - this won't happen 
    // until the results are received from PHP. In this case, I am
    // updating the albumLayout div with the output gathered from
    // the PHP function `GetAlbumLayout(layoutNumber)`
    success: function(output) {
      $('#albumLayout').html(output);
    }
  });
}

/* document ready waits till the DOM is fully loaded to do anything */
$(document).ready(function() {

  // When the user clicks button 1
  $('#layout1').click(function() {
    changeLayout(1);
  });

  // When the user clicks button 2
  $('#layout2').click(function() {
    changeLayout(2);
  });

  // When the user clicks button 3
  $('#layout3').click(function() {
    changeLayout(3);
  });

}); 
```

我没有测试提供的任何代码，但它应该让你朝着正确的方向前进。基本上，您最初使用数据库中的值加载页面。用户将单击页面上的按钮来更改布局。您对服务器进行 Ajax 调用以使用`UPDATE`数据库的默认值，并返回要在页面上显示的新 HTML。成功后，您将页面上的 HTML 更新为从 PHP 收集的新 HTML。

祝你好运！如果我误解了你的问题，请告诉我。

# sql - 将 SQL 与 XQuery 和 Linq To SQL 结合使用

> ID：11996252
> 
> 赞同：1
> 
> 时间：2012-08-16T22:18:36.500
> 
> 标签：sql, sql-server, linq-to-sql, xquery, expression-trees

如何有效地结合直接 SQL 查询和 Linq To SQL 查询？Linq To SQL 不支持 XQuery。所以我必须将 SQL 的结果与 XQuery 和基于列的 Linq To SQL 结合起来？

任何指针表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:34:09.457

Chris Cavanagh 有几篇博客文章提供了将 XQuery 与 LINQ to SQL 结合使用的选项。

1.  [带有 LINQ to SQL 的 SQL Server XQuery](http://chriscavanagh.wordpress.com/2011/03/15/sql-server-xquery-with-linq-to-sql/)为解决方案提供了框架，该解决方案涉及将 XQuery 嵌入到用户定义的函数中，这些函数**可以**从 LINQ to SQL 访问

2.  [修改 LINQ to SQL 命令文本](http://chriscavanagh.wordpress.com/2011/03/12/manipulating-linq-to-sql-command-text/)和[修改 LINQ to SQL 命令文本再次](http://chriscavanagh.wordpress.com/2012/07/06/modifying-linq-to-sql-command-text-again/)提供了一种扩展 LINQ to SQL 查询执行的方法，方法是操纵生成的命令文本以支持 XQuery 构造。

最终结果是您实际上可以直接从 DataContext 中使用 XQuery，方法是编写如下所示的代码：

```
var results = from r in MyXmlFieldTable
   let date = context.XQueryDateTime( r.XmlValues, "MyContainer/MyDateTime" )
   where date < DateTime.Now.AddDays( -5 )
   select new
   {
       Date = date,
       FirstName = context.XQueryString( r.XmlValues, "MyContainer/FirstName" ),
       LastName = context.XQueryString( r.XmlValues, "MyContainer/LastName" )
   }; 
```

（但是，如果您发现需要做很多此类事情，那么使用 MongoDB 或 RavenDB 之类的文档数据库可能会更好，它们用于处理分层/后关系模型）

*作为关于 XQuery 和 SQL 的一般说明，您将在不同版本中获得不同程度的支持。具体来说，SQL 2005 中的 XQuery 支持是后续版本中支持的有限子集。*

# sql - 2张表之间的2种不同关系

> ID：11996255
> 
> 赞同：0
> 
> 时间：2012-08-16T22:18:55.667
> 
> 标签：sql, sql-server

我有以下情况：有一堆地址来自女巫客户可以选择一个当前的。

> 地址（ID，CLIENT_ID，...）
> 
> 客户（ID，CURRENT_ADDRESS_ID，...）

一对多有明显的关系

> 地址[CLIENT_Id]>--->CLIENT[ID]

但也有另一个一对一。我不知道这是否正确。

> 客户[CURRENT_ADDRESS_ID]<--->地址[ID]

这应该由 SQL 关系完成，还是稍后在代码中完成？（示例 SQL 代码将不胜感激）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:32:23.473

客户（ID，...）

地址（ID，...）

CLIENT_ADDRESS（CLIENT_ID，ADDRESS_ID，IS_CURRENT_ADDRESS）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:32:57.530

当您想要考虑创建第三个表来链接客户和地址时，就会出现这种情况。它看起来像这样：

地址 (AddressID)

客户端地址（地址 ID、客户端 ID）

客户 (ClientID)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T22:39:09.337

如果客户端必须选择其中一个地址将其设置为当前地址，则不需要第二个关系，因此您可以执行以下操作

```
SELECT Client.ID ClientID, Address.ID AddressID, 
CASE WHEN Client.Current_Address_Id =  Address.ID THEN 'Current Address' ELSE '' END Current
FROM Client LEFT JOIN Address ON Client.ID = Address.Client_ID 
```

你会得到类似的东西

```
ClientID | AddressID | Current
1          20          'Current Address'
1          35          
1          15          
2          18          'Current Address'
.
.
. 
```

如果添加第二个条件

```
SELECT Client.ID ClientID, Address.ID AddressID, 
CASE WHEN Client.Current_Address_Id =  Address.ID THEN 'Current Address' ELSE '' END Current
FROM Client LEFT JOIN Address ON Client.ID = Address.Client_ID AND Client.Current-Address_ID = Addres.ID 
```

你会得到类似的东西

```
ClientID | AddressID | Current
1          20          'Current Address'
2          18          'Current Address'
.
.
. 
```

希望能帮助到你...

# php - 未声明 HTML 文档的字符编码

> ID：11996257
> 
> 赞同：225
> 
> 时间：2012-08-16T22:18:59.567
> 
> 标签：php, html

当我单击表单的提交按钮时，会出现以下错误消息：

> 未声明 HTML 文档的字符编码。如果文档包含 US-ASCII 范围之外的字符，则文档将在某些浏览器配置中呈现乱码。页面的字符编码必须在文档或传输协议中声明。

插入.html：

```
<!DOCTYPE html PUBLIC"-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>insert page</title></head>
    <body>
    <h1> Insert Page </h1>
        <form action="insert.php" method="post"  enctype="application/x-www-form-urlencoded" >
         <p>Title:<input type="text" name="title" size="40" /></p>
         <p>Price:<input type= "text" name="price" size="40" /></p>
         <p><input type="submit" value="Insert" />
         <input type="reset" value="Reset" /></p>
        </form>    
    </body>
</html> 
```

插入.php：

```
<?php
    $title = $_POST["title"];
    $price = $_POST["price"];

    echo $title;
?> 
```

我不知道我的代码中的问题在哪里。请帮我。

* * *

## 回答 #1

> 赞同：352
> 
> 时间：2012-10-10T12:58:18.780

将此添加为 HTML 模板的 HEAD 部分的第一行

```
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<meta content="utf-8" http-equiv="encoding"> 
```

* * *

## 回答 #2

> 赞同：75
> 
> 时间：2015-09-27T07:08:36.977

我在最基本的情况下遇到了同样的问题，我的问题通过将这个标签插入到文档的头部来解决：

```
<meta charset="utf-8"> 
```

未声明 html 文档的字符编码（实际上是 UTF-8）。

更多关于它[这里](https://html.spec.whatwg.org/multipage/semantics.html#charset)和[这里](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta#examples)。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2019-02-24T06:34:17.530

当我在 Firefox 中运行表单应用程序时，我遇到了同样的问题。添加`<meta charset="utf-8"/>`html 代码解决了我在 Firefox 中的问题。

```
<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Voice clip upload</title>
  <script src="voiceclip.js"></script>
</head>

<body>
  <h2>Upload Voice Clip</h2>
  <form id="upload_form" enctype="multipart/form-data" method="post">
    <input type="file" name="file1" id="file1" onchange="uploadFile()"><br>
    <progress id="progressBar" value="0" max="100" style="width:300px;"></progress>
  </form>
</body>

</html>
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2012-08-16T22:23:36.470

好吧，当您发布时，浏览器只会输出`$title`- 您所有的 HTML 标记和文档类型都会消失。您需要在`insert.php`文件中包含这些内容：

```
<!DOCTYPE html PUBLIC"-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>insert page</title></head>
<body>
<?php 

   $title = $_POST["title"];
   $price = $_POST["price"];

  echo $title;

 ?>  
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2017-03-05T03:09:21.360

您必须将文件从 .html 更改为 .php。

并添加以下行

```
header('Content-Type: text/html; charset=utf-8'); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-08-16T22:54:00.800

您的初始页面是一个包含表单的完整 HTML 页面，当单击提交按钮时，其内容会发布到 insert.php，但 insert.php 需要处理表单的内容并对它们进行处理，例如将它们添加到数据库，或将它们输出到新页面。您当前的 insert.php 仅输出标题字段的内容，因此您的浏览器尝试将其解释为 HTML 页面，但显然失败了，因为它不是有效的 HTML（即它不包含在“HTML”中标签等）。

您的 insert.php 需要输出必要的 HTML，并在某处插入表单数据。

例如：

```
<?php 

   $title = $_POST["title"];
   $price = $_POST["price"];

  echo '<html xmlns="http://www.w3.org/1999/xhtml">';
  echo '<head>';
  echo '<meta http-equiv="content-type" content="text/html; charset=utf-8" />';
  echo '<title>';
  echo $title;
  echo '</title>';
  echo '</head>';
  echo '<body>';
  echo 'Hello, world.';
  echo '</body>';

 ?> 
```

# windows-phone-7 - 检测从服务器推送的活动磁贴

> ID：11996258
> 
> 赞同：0
> 
> 时间：2012-08-16T22:18:59.920
> 
> 标签：windows-phone-7, push-notification, live-tile, mpns

有什么方法可以理解当前显示的主图块是从服务器端推送（更新）的？

我问的原因：我的应用程序可以从后台代理更新平铺图像，并且我希望在用户打开应用程序之前保持平铺图像不变。

PS。我使用反射器来了解瓷砖的实现，但没有找到我可能使用的任何东西（时间戳、任何图像信息、没有其他 ID）。

**编辑**

我发现推送的平铺图像以 png 格式存储在*Applications\Data{appguid}\Data\ShellContent*系统文件夹中。隔离存储根文件夹是*Applications\Data{appguid}\Data\IsolatedStore*。因此，我尝试使用“..\ShellContent”从 iso 根目录访问此文件夹，但出现 Operation Not Permitted 异常。“..\IsolatedStore”有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T14:17:09.280

我没有对从服务器更新的动态磁贴进行任何操作（我使用后台代理），但我的建议是在更新过程中在 IsolatedStorage 中设置一个标志，并让您的后台代理检查该标志。

# regex - 具有一定数量字符的 preg_replace 正则表达式

> ID：11996259
> 
> 赞同：0
> 
> 时间：2012-08-16T22:19:03.360
> 
> 标签：regex

我有一个类似这样的变量：

```
text1 http://www.server.com/10characters text2 http://www.server.com/10characters text3 
```

我想preg_replace所有“http://www.server.com/10characters”链接“点击”，但“http://www.server.com/”是一个必须出现的常量，“10characters”总是任何10 个字符（不多也不少）

例如。代替

```
text1 http://www.server.com/d19d2aj53f text2 http://www.server.com/a49ds5j3ax text3
http://www.otherserver.com/a49ds5j3ax text3 
```

至

```
text1 <a href="http://www.server.com/d19d2aj53f">Click</a> text2
<a href="http://www.server.com/a49ds5j3ax">Click</a>
text3 http://www.otherserver.com/xt92s5sfa2 text3 
```

我不知道该怎么做：/我尝试了几种方法，但没有好的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:25:52.060

我认为

```
preg_replace("http://www\.server\.com/[0-9a-zA-Z]{10}", " Click!", $myLink) 
```

应该管用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:21:52.820

如果域后总是 10 个字符，则不需要 preg_replace：

```
$url1 = substr($url,0,35); //length of http://www.server.com/10characters is 35 chars
echo "text1 <a href=\"$url1\">click</a><br>";
/// etc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T23:59:25.860

```
$str = 'text1 http://www.server.com/d19d2aj53f text2 http://www.server.com/a49ds5j3ax text3 http://www.otherserver.com/a49ds5j3ax text3';

echo preg_replace('~http://www\.server\.com/.{10}~i', '<a href="$0">click</a>', $str); 
```

在模式中，`.`是“任意字符”，所以`.{10}`表示任意十个字符。

在替换中，`$0`表示与整个模式匹配的内容（在本例中为完整的 URL）。

这是[一个工作示例](http://codepad.viper-7.com/kwACDS)。

# java - 代码执行时项目没有响应

> ID：11996263
> 
> 赞同：0
> 
> 时间：2012-08-16T22:19:15.503
> 
> 标签：java, swing, runtime, processbuilder

没有错误没有输出，不明白哪里出错了。

```
String[] commands = new String[] {"maude", "in 1.maude", "red f(a, b, e) ."};
Runtime rt = Runtime.getRuntime();
Process proc = rt.exec(commands);
InputStream stdin = proc.getInputStream();
InputStreamReader isr = new InputStreamReader(stdin);
BufferedReader br = new BufferedReader(isr);
String line = br.readLine();
while ( (line = br.readLine()) != null) {
    jTextArea4.append(line + "\n");
} 
```

最初，我有一个字符串数组，第一个运行 Maude 控制台，第二个是 Maude 控制台的命令，说明我们感兴趣的模块（文件）是什么（加载什么文件），最后一个是检查 Maude 模块中某些属性的实际命令！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:21:14.520

利用：

```
String maudeCommand = "full_path_to_maude\\maude.exe";
String[] commands = new String[] {"cmd.exe", "/c", maudeCommand, "in", "1.maude", "red", "f(a, b, e)", "."}; 
```

替换`full_path_to_maude`为*maude.exe*的位置。

# objective-c - 核心情节：在 iOS 上显示右对齐的 Y 轴

> ID：11996265
> 
> 赞同：0
> 
> 时间：2012-08-16T22:19:27.860
> 
> 标签：objective-c, ios, core-plot

我已经搜索了相当长的一段时间，发现了大量的旧资源，它们曾一度可以解决我当前的问题。但是，Core Plot 已经发展，如果以相同的方式实施，我发现的解决方案将不再起作用。我希望我能得到一个最新的答案，因为我确信这是各种图形和图表的共同特征。

我当前的问题是，当我尝试右对齐绘图上的 3 个轴之一，而轴本身（包括标题）确实移动时，没有刻度线或相关标签。我猜我所拥有的可能是不完整的。

这是我的相关轴生成代码：

```
CPTAxis *yRight = [[CPTXYAxis alloc] init];
yRight.Title = @"Right Axis";
yRight.titleOffset = 10.0f;
yRight.axisLineStyle = axisLineStyle;
yRight.majorTickLineStyle = axisLineStyle;
yRight.minorTickLineStyle = axisLineStyle;
yRight.labelTextStyle = axisTextStyle;
yRight.labelOffset = 3.0f;
yRight.majorIntervalLength = CPTDecimalFromFloat(10.0f);
yRight.minorTicksPerInterval = 5;
yRight.minorTickLength = 5.0f;
yRight.majorTickLength = 7.0f;

axisSet.axes = [NSArray arrayWithObjects:x, yRight, yLeft, nil];
self.hostView.hostedGraph.axisSet = axisSet;

//Next two lines are in charge of right aligning y axis
axisSet.yAxis.axisConstraints = [CPTConstraints constraintWithUpperOffset:0];
//axisSet.yAxis.tickDirection = CPTSignPositive; this is commented out because I havent found it to do anything, though may be necessary for it to work once complete.

CPTXYPlotSpace *plotSpace = (CPTXYPlotSpace *)hostView.hostedGraph.defaultPlotSpace;
x.plotSpace = plotSpace;
yLeft.plotSpace = plotSpace;
yRight.plotSpace = plotSpace; 
```

我有一种感觉，我所缺少的并不是很多，但我只是在这一点上没有关于寻找和尝试什么的想法。

小问题，iOS 是否支持浮动轴？axisSet.yAxis.isFloatingAxis 给我一个错误:(

感谢您提供任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:41:57.713

该`isFloatingAxis`属性已被删除以支持轴约束。

```
yRight.axisConstraints = [CPTConstraints constraintWithUpperOffset:0];
yRight.coordinate = CPTCoordinateY; 
```

什么是`yRange`情节空间？当前的标签设置会将刻度和标签放在 0、10、20 等处`yRight`。

# ruby-on-rails - Rails 3：Mongoid validates_inclusion_of 错误

> ID：11996267
> 
> 赞同：0
> 
> 时间：2012-08-16T22:19:39.293
> 
> 标签：ruby-on-rails, ruby-on-rails-3, validation, mongoid, activemodel

```
class Request
include Mongoid::Document 
field :code, type: String      
validates :code, :presence => true, 
                 :inclusion => { :in => proc { Listing.all_codes } } 
```

使用 Mongoid，我正在尝试验证提交表单上的 :code 输入，以确保他们使用数据库中已经存在的正确代码。列表模型 :code 字段也被命名为 :code。

这是错误：

```
undefined method `all_codes' for Listing:Class 
```

有什么建议么？Mongoid 中的参考等效项是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:32:41.967

这是一个 ruby​​ 级别错误，表示您没有类似的方法

```
class Listing
    def self.all_codes
       # stuff
    end
end 
```

`self.`部分很重要。

你可能已经实现了

```
class Listing
   named_scope :all_codes, :select => #...
end 
```

您可能只想`Listing.all`真正的错误是您的请求类和列表类之间的方法名称不一致。

# r - 在R中的qplot中绘制平滑线

> ID：11996268
> 
> 赞同：2
> 
> 时间：2012-08-16T22:19:57.677
> 
> 标签：r, ggplot2, line

我的问题是我想知道如何在 R 中的 qplot 中绘制平滑线，除非它们周围没有灰色带。例如，当我写这个时：

```
qplot(wt, mpg, data=mtcars, geom=c("smooth"), color=factor(cyl), method="lm", 
formula = y ~ ns(x,4)) 
```

出现的情节不仅有三条彩色线条，还有线条周围的这些灰色大云。如何在保持流畅线条的同时删除它们？Geom="line" 给了我非常锯齿状的线条来追踪每个嘈杂的点，所以那些也不会。

任何帮助表示赞赏。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T22:22:53.220

添加`se=FALSE`.

从 ggplot2 书的第 14 页开始（很贵，但值得）。

[bdemarest - 感谢您的编辑！（没有正确大写 FALSE）]

# matlab - Matlab：删除重叠行

> ID：11996271
> 
> 赞同：1
> 
> 时间：2012-08-16T22:20:21.297
> 
> 标签：matlab, matrix, overlap

我需要在一列中删除两个矩阵的重叠行。

例如：

矩阵 1：

```
1, 5;
2, 23;
3, 51;
4, 21;
5, 661; 
```

矩阵 2：

```
4, 11;
5, 601;
6, 341;
7, 5;
etc. 
```

会导致：

结果矩阵：

```
1, 5;
2, 23;
3, 51;
4, 11;
5, 601;
6, 341;
7, 5; 
```

谢谢！基督教

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T22:55:18.867

或者，始终保持所选列中的最后一次出现：

```
x = [x1;x2];
columnIndex = 1; % column 1 
[~, i] = unique(x(:, columnIndex), 'last');
xMerge = x(i, :); 
```

适用于多个矩阵和不同列进行索引。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T22:26:08.880

您可以使用`union`附加的索引输出。

```
x1 = [ ...
    1, 5; ...
    2, 23;...
    3, 51;...
    4, 21;...
    5, 661];

x2 = [ ...
    4, 11;...
    5, 601;...
    6, 341;...
    7, 5];

[~, ixs1, ixs2] = union(x1(:,1), x2(:,1));

xMerge = [...
    x1(ixs1,:); ...
    x2(ixs2,:)]; 
```

这导致：

```
>> xMerge 
xMerge =
     1     5
     2    23
     3    51
     4    11
     5   601
     6   341
     7     5 
```

# c# - 如何修改表单并从另一个表单刷新它

> ID：11996273
> 
> 赞同：0
> 
> 时间：2012-08-16T22:20:28.877
> 
> 标签：c#, winforms, forms, public-method

我使用两种形式：

Form1 包含 button1

Form2 包含 button2 和 Panel1

我的项目开始使用 Form2。然后我点击 button2 显示 Form1

```
 private void button2_Click(object sender, EventArgs e)
    {
        Form1 Frm = new Form1();
        Frm.Show();
    } 
```

然后在 Form1 上，我单击 button1 以在 Form2 上隐藏 Panel1

```
 private void button1_Click(object sender, EventArgs e)
    {
        Form2 FormInstance = new Form2();
        FormInstance.displayInit();
        FormInstance.Refresh();
    } 
```

displayInit() 是 Form2 内部的一个方法：

```
 public void displayInit()
    {
        panel1.Visible = false;
    } 
```

但是由于刷新问题，面板没有隐藏，请问有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:18:06.040

让两种形式（或任何两个类）相互交谈的标准方式是使用事件。

在您的情况下，将其添加到`Form1`代码的顶部：

```
public event ClosePanelHandler ClosePanel;
public delegate void ClosePanelHandler(object sender, EventArgs e); 
```

然后，在`Form1`的 Button1_Click 事件中（这会引发事件）：

```
 private void button1_Click(object sender, EventArgs e)
    {
     if (ClosePanel != null){
       ClosePanel(this, new EventArgs());
    }} 
```

-

最后，`Form2`需要处理事件（并监听它）以便采取行动：

```
 private void HandleCloseRequest(object sender, EventArgs e)
    {
     panel1.Visible = false;
    } 
```

还有，修改

```
private void button2_Click(object sender, EventArgs e)
    {
        Form1 Frm = new Form1();
        Frm.ClosePanel += HandleCloseRequest;
        Frm.Show();
    } 
```

我希望这个能有一点帮助。

# c++ - 如何在 C++ 中的两个不同对象中使用相同的变量名

> ID：11996276
> 
> 赞同：2
> 
> 时间：2012-08-16T22:20:52.257
> 
> 标签：c++, object

我正在尝试制作一个战锤 40K 军队计数器程序，所以我不必继续使用 excel。我的问题是我的程序出错，因为我有两个不同的对象及其具有相同变量名的头文件。

当我尝试运行我的程序时，g++ 抱怨该变量已在我的第一个对象中声明。

我如何做到这一点，这样就不会发生？

这是 Skulltaker.cpp 程序的代码片段

```
#include "SkullTaker.h"
#include <string>
int pointCost = 140;
int minSize = 1;
int maxSize = 1;
std::vector<std::string> rules; 
```

这是 SkullTaker.h

```
class SkullTaker {
public:

    SkullTaker();
    SkullTaker(const SkullTaker& orig);
    int getPointCost();
    int getMinSize();
    int getMaxSize();
    std::vector<std::string> getRules();
    std::string toString();
    virtual ~SkullTaker();
}; 
```

我的其他类是相同的，但在 KuGath 中的 .cpp 和 .h 文件的名称。

g++ 抱怨 PointCost 有多种定义。

谢谢，

多纳

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T22:29:55.780

使用“static”关键字来表示你的全局变量的范围应该仅限于它的翻译单元。

`static int pointCost = 140;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T22:38:51.857

使用“匿名”命名空间：

```
namespace {
int pointCost = 140;
int minSize = 1;
int maxSize = 1;
std::vector<std::string> rules;
}
//the code that uses these comes here. 
```

其中的所有内容都只会在该文件中可见。另一种选择 - 如果您只需要类定义的那些 - 将这些作为类的静态私有成员包括在内。

```
class Skulltaker {
    public:
    ...
    private: /* I believe this initialization syntax is allowed in C++11
                otherwise, initialize them in your .cpp file
                like this: int Skulltaker::pointCost(140);*/
    static int pointCost = 140;
    static int minSize = 1;
    static int maxSize = 1;
    static std::vector<std::string> rules;
}; 
```

好吧，但是这样想——现在你有一个第一手的经验，为什么人们一直告诉你尽可能不要使用全局变量（除了设计问题）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-16T22:47:09.380

您正在使您的 pointcost 全局化，并且不属于命名空间。您可以使其成为您的类的成员（私有：int pointcost；），然后在构造函数中的 cpp 或任何设置的 pointcost=140 中。由于这实际上看起来每个类都可以派生自一个名为“WarHammerUnit”的基类，因此它可能是那里的成员，您可以在构造函数中为每个单元设置它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-16T22:25:27.533

如果那是完整文件，则`using namespace std;`在包含之后需要一个命令。鉴于您有一个可能会解决它的命名空间问题...如果您的所有编译器指令都很好（包括、ifdefs 等），那么您的类中的变量名之间应该没有冲突。

此外，类属性应该在头文件中声明，看起来你把这两个混淆了（或者这只是写问题的一个错误）。如果这些值应该是常量，则可以`static const`在头文件中声明它们并在那里初始化它们，如果它们因实例而异，则应在构造函数中初始化它们。

# jquery - jQuery：如何选择 div 内的元素？

> ID：11996282
> 
> 赞同：0
> 
> 时间：2012-08-16T22:21:22.290
> 
> 标签：jquery

我有一个`video objects`以 HTML 呈现 的列表

```
 <div class="video">
        <p class='title'> {{ video.title }} </p>
        <p class='url'> {{ video.url }} </p> 
        <button class="btn btn-primary queue" href="#">queue</button>
    </div>
    <br /> 
```

**我想要的是？**

每当我点击任何视频列表时，都应该选择标题和网址

我有`jQuery`一个

```
$(function(){
    $('body').on('click', '.video', function(event) {
        var title = $(this).closest('.title');
        console.log(title);
        alert(title);
    });
}); 
```

当我在萤火虫中看到时，`console.log(title)`就像`jQuery( )`在萤火虫中一样，我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:26:39.837

`.closest('.title')`将向上 DOM 层次结构，直到找到与选择器匹配的元素。然后它将为该选择器返回一个 jQuery 对象。

您想要做的是向下遍历 DOM 层次结构，例如使用[children](http://api.jquery.com/children/)方法（搜索直接子项）或[find](http://api.jquery.com/find/)方法（搜索子项的子项），然后使用[文本](http://api.jquery.com/text/)或其 HTML 内容检索其文本使用[html](http://api.jquery.com/html/) 方法（而不是获取 jQuery 对象）：

```
var title = $(this).children('.title').text(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T22:23:23.413

`.closest()`上升到父链。如果要搜索子对象，请使用`.find()`. 您的代码还使它看起来像您想要 div 的内容，而不是 jQuery 对象。结合这些变化，你会得到：

```
$(function(){
    $('body').on('click', '.video', function(event) {
        var title = $(this).find('.title').html();
        console.log(title);
        alert(title);
    });
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-16T22:24:40.543

```
$(function(){
  $('body').on('click', '.video', function(event) {
    var title = $(this).find('.title').html();
    console.log(title);
    alert(title);
  });
});​ 
```

# java - 将数据库表（带 BLOB）导出为 CSV

> ID：11996283
> 
> 赞同：0
> 
> 时间：2012-08-16T22:21:30.960
> 
> 标签：java, csv, export-to-csv

有人可以教我如何使用 java 将带有 BLOB 的表导出到 CSV 吗？我稍后会导入它们。一些关于这个问题的概念和一些代码可以帮助解释事情。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:47:36.973

如果是我，我只会对二进制数据进行编码，然后像写任何其他字段一样将其写出来。[Apache Commons](http://commons.apache.org/codec/userguide.html)对此有很好的 API。我会根据您的需要使用 Base32 或 Base64 二进制编码器。这可能被称为 URL 编码，但我不是 100% 确定......这个概念仍然相同，您仍然只是获取二进制数据并将其编码为字符串：

```
byte[] myBlobData = \\ Retrieve from database
Base32 encoder = new Base32();
String encodedData = encoder.encodeToString(myBlobData);
// Write out data as you normally would for a CSV file 
```

然后将其读回，只需执行相反的操作：

```
String encodedData = \\ Read from file
byte[] myBlobData = encoder.decode(encodedData); 
```

我认为这对你很有效。URL 编码（或类似的编码）适用于此，因为它们旨在允许二进制数据作为字符串安全地传输。如果您不想使用 Apache Commons 库，则可以使用 Java 的[URLEncoder](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLEncoder.html)来获得。

# asp.net-mvc - ASP.Net MVC 4 的 WebAPI 没有正确绑定复选框？

> ID：11996285
> 
> 赞同：9
> 
> 时间：2012-08-16T22:21:52.720
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-web-api

我正在将 WebAPI 合并到我的开发中，并将所有表单提交发布到 WebAPI 控制器。我注意到复选框没有正确绑定到模型。我有一个表格使用：

```
@Html.CheckBoxFor(m => m.HasVideo) 
```

它产生一个复选框和一个隐藏的表单元素。当我选中复选框（表示“真”值）时，我的 WebAPI Post 中的模型绑定反映了 HasVideo 属性的假。我将整个方法移到了传统的 mvc 控制器上，并且绑定按预期工作。

是否有解决方法，或者我缺少什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-17T11:07:56.627

不要使用这个 html 助手：

```
@Html.CheckBoxFor(m => m.HasVideo) 
```

试试这个：

```
<input id="HasVideo" name="HasVideo" type="checkbox" value="true" @(((Model!=null) && Model.HasVideo) ? "checked=\"checked\"" : "" ) /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-17T11:01:19.880

我也见过这个。网络上没有太多关于此的内容，并且应该在某处进行更多记录。如果两者都找到，标准控制器会更喜欢 true 而不是 false，但 api 控制器看起来就像他们只使用找到的最后一个值。

此页面包含一些可能支持这一假设的信息：http: [//blogs.msdn.com/b/jmstall/archive/2012/04/16/how-webapi-does-parameter-binding.aspx](http://blogs.msdn.com/b/jmstall/archive/2012/04/16/how-webapi-does-parameter-binding.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T17:30:03.197

以前见过这个问题，它通常是 ViewData/ViewBag 干扰，这通常是调试的噩梦。

您可以在给您带来问题的函数中添加 ViewBag.Clear/ViewData.Clear。

干杯，J

# windows-8 - 从 App.OnSuspending 调用 StorageFolder.CreateFileAsync 时崩溃

> ID：11996288
> 
> 赞同：5
> 
> 时间：2012-08-16T22:21:59.933
> 
> 标签：windows-8, visual-studio-2012, async-await, windows-store

我的 Win RT 应用程序在 Windows 8 beta 上与 VS2012RC 一起工作，现在在 Visual Studio 和 Windows 8 Pro 的最终版本中出现了问题，只有在我将调试器断点设置为文件创建方法。

```
private void OnSuspending(object sender, SuspendingEventArgs e){                        
     var deferral = e.SuspendingOperation.GetDeferral();                       
     if (null != m_document) Save();
     deferral.Complete();
}

async void Save(){
    var folder = KnownFolders.DocumentsLibrary;       
    var file = await folder.CreateFileAsync(GetFileName(),Windows.Storage.CreationCollisionOption.ReplaceExisting);                

    var xDoc = GetXDocument();
    using (var stream = await file.OpenStreamForWriteAsync()){
       xDoc.Save(stream);                    
    }           
} 
```

*   如果我在 上设置断点`StorageFile file = await folder.CreateFileAsync(...`，调试器将进入，如果我继续，一切正常。

*   但是，如果我不设置断点，则会创建文件，但不会保存 xml 的内容（文件为空）。

*   如果我在该行下方设置断点`StorageFile file = await folder.CreateFileAsync(...`，则调试器永远不会进入！

有人有想法吗？我还测试了一个使用 的版本，`folder.OpenStreamForWriteAsync`效果完全相同。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T09:18:27.403

问题是对保存方法的调用。只有第一部分（文件的创建）被等待，第二部分（保存 XML）是异步完成的，因此暂停操作的延迟直到保存过程结束。

避免此问题的一种可能解决方案是显式等待保存操作的完成。这可以通过将 OnSuspending 方法声明为`aysnc`然后使用 await 关键字等待保存操作完成来完成（请注意保存方法的任务返回类型）。

```
private async void OnSuspending(object sender, SuspendingEventArgs e){                        
     var deferral = e.SuspendingOperation.GetDeferral();                       
     if (null != m_document) await Save();
     deferral.Complete();
}

async Task Save(){
    var folder = KnownFolders.DocumentsLibrary;       
    var file = await folder.CreateFileAsync(GetFileName(),Windows.Storage.CreationCollisionOption.ReplaceExisting);                

    var xDoc = GetXDocument();
    using (var stream = await file.OpenStreamForWriteAsync()){
       xDoc.Save(stream);                    
    }           
} 
```

我希望这篇文章能帮助其他陷入同样陷阱的人（我想知道为什么 w8 的 beta 版没有出现问题，但我认为 MS 已经优化了应用程序终止过程，因此时间更少暂停过程后的意外工作）...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T03:24:36.980

你的时间不多了。您开始时大约需要 5 秒，但如果您不声明将使用它，那么您的时间将被缩短。试试这个：

```
private async void OnSuspending(object sender, SuspendingEventArgs e)
{
    var deferral = e.SuspendingOperation.GetDeferral();
    try
    {
        await Task.Delay(1000);
        Debug.WriteLine("Done");
    }
    finally
    {
        deferral.Complete();
    }
} 
```

有关更多详细信息，请参见[此处](http://www.damirscorner.com/CommentView,guid,b60c0955-c86d-48a5-9d30-1cb6e117db51.aspx)。官方文档见[这里](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh465115%28v=win.10%29.aspx)：

> 注意如果您需要在您的应用程序暂停时执行异步工作，您需要将暂停的完成推迟到您的工作完成之后。您可以使用 SuspendingOperation 对象上的 GetDeferral 方法（可通过事件参数获得）来延迟挂起的完成，直到您对返回的 SuspendingDeferral 对象调用 Complete 方法之后。

# java - Java While 循环与 Java Programming for the Absolute Beginner 中提出的挑战有关

> ID：11996290
> 
> 赞同：2
> 
> 时间：2012-08-16T22:22:07.390
> 
> 标签：java, while-loop

我正在尝试自己学习 Java 编程（没有课程/教师/导师/等），所以这不是家庭作业。

我的问题在 Java 初学者挑战中已经提到过[：在 while 循环中生成随机数](https://stackoverflow.com/questions/9053987/java-challenge-while-loop)，但是，正如之前提出这个问题的程序员所说，我在本书中的进展还不够深入，无法涵盖 ArrayLists。

回答这个问题肯定会帮助大多数初学者程序员更好地理解如何为 while 循环编写语句，这是一个通常复杂的过程，尤其是对于初学者。

问题是：编写一个while循环，生成1到100之间的随机数，并在两次生成相同的数字后停止循环。

正如您将认识到的，每次运行该程序时，运行该程序只会创建一个介于 1 和 100 之间的两个随机数的输出。我相信由于第 17 行而遇到此错误：equal = numberCheck == values[i]; 不正确，因为这是定义 while 循环条件何时变为真并因此停止评估的语句。

任何帮助是极大的赞赏。谢谢你。

我的代码是：

```
import java.util.Random;

public class SameNumber {

    public static void main(String args[]) {

        Random rand = new Random();
        int[] values = new int[100];
        int counter = 0;
        boolean equal = false;

        for (int i = 0; i < 2; i++) {
            values[i] = rand.nextInt(100) + 1;
            System.out.println(values[i]);
            int numberCheck;
        }

        while (!equal) {
            for(int i = counter - 1; i >= 0; i--) {
                int numberCheck = values[i];
                equal = numberCheck == values[i];
             //}
                if (!equal) {
                    System.out.println(rand.nextInt(100) + 1);
                }

                for (int j = counter - 1; j >= 0; j--) {
                    if (numberCheck  == values[j]) {
                        break;
                    }
                }
            }
        }
    }
} 
```

PS：我知道这听起来很荒谬，但是我一直在研究这个问题大约一周并试图收集更多的研究，但我仍然无法找到正确的解决方案。我一直犹豫寻求帮助，因为我担心其他程序员会用我还没有学过的方法来回答。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T22:32:11.103

您的方法非常间接......让我们直接按照说明进行尝试：

1.  生成一个新的随机数
2.  确定你以前是否见过这个随机数
3.  不？记录你已经看到这个随机数并转到 1。
4.  是的？停止

那么真正的问题是，“我如何确定我以前是否见过随机数？”。

由于它是一个有限集，因此您可以拥有一个`boolean seen[100]`初始化为 false 的布尔数组 ( )。每当您看到一个数字时，标记`seen[<number>]`为`true`。如果`seen[<number from 2>]`曾经是真的，那么您之前已经生成过它。

顺便说一句，使用 an`ArrayList`来跟踪这些东西并不是数据结构的最佳选择。当您准备好查看 Java 集合时，请查看`HashSet`，它具有恒定时间（不取决于列表的大小）执行`contains`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T22:34:03.687

我将设置`values`为一个布尔值数组，如果您的号码在那里，则将其设置为 true。然后，您只需使用随机数作为该数组的*索引*：

```
boolean[] values = new boolean[100];

int index = Random.nextInt(100);
while(!values[index]){
    System.out.println(index+1);
    values[index] = true;
    index = Random.nextInt(100);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T22:32:02.960

试试这个： 1\. 创建一个介于 0 到 100 之间的随机数 2\. 如果它不在列表中，则将其添加到列表中。3.如果新生成的数字已经在arraylist里面了就停止

```
import java.util.ArrayList;
import java.util.Random;

public class SameNumber {
    public static void main(String args[]) {
        Random rand = new Random();
        ArrayList<Integer> list=new ArrayList<Integer>();       
        int newRand=rand.nextInt(100);
        while(!list.contains(newRand)){
            list.add(newRand);
            newRand=rand.nextInt(100);
        }
        System.out.print(list);
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-16T22:55:52.950

即使这不是家庭作业（我希望这不会引发自称是非家庭作业的家庭作业问题的趋势），但我仍然认为您更能得到指针的帮助，而不是解决方案。

我会用伪代码英语重写你的代码实际上做了什么，这样你就可以看到哪里出错了。

```
创建一个随机数生成器
创建一个 100 个元素的数组
初始化一个计数器
初始化一个布尔值
循环两次并将两个随机数分配给第一个
     100 元素数组中的两个元素（这是一个问题）
在循环中：打印出分配的数字的值
在循环中：编译器将忽略的无意义行
开始一个循环，直到上面初始化的布尔值变为真
开始一个循环，将计数变量初始化为-1，
    当它大于或等于零时将停止，减少它
    每次（这意味着这将永远不会运行）。
在循环中：引用数组中的非法位置（-1 及以下）
    并将其分配给一个变量（这是一个问题）
在循环中：检查您刚刚分配的变量是否等于
    你刚刚分配了它（这是一个问题）
在循环中：如果没有（那不可能发生）打印出一些随机数
    与迄今为止发生的任何事情无关（这是一个问题）
在循环中：启动一个嵌套循环，其问题与另一个循环相同
在嵌套循环中：检查所有值
    （尽管它们被非法引用）在数组中等于数字
    从外环拉出。[这有点意思，但只有
    到目前为止有太多问题甚至无法考虑纠正这条线]

```

# java - 在浏览器中打开 IPad 中的 docx 文件时出现问题

> ID：11996291
> 
> 赞同：2
> 
> 时间：2012-08-16T22:22:16.487
> 
> 标签：java, ios, ipad, web-applications, docx

我们有一个基于 java 的应用程序，它可以生成 docx 文件并将内容推送到浏览器

我们在应用程序中生成 docx 输出，并将 docx 文件的字节数据发送到浏览器窗口。

我们将内容类型标头设置为“application/vnd.openxmlformats-officedocument.wordprocessingml.document”

在普通笔记本电脑或 PC 上，所有浏览器都能正确打开文件（Chrome、IE、Firefox、Windows 版 Safari）。但在 iPad 上，chrome 和 Safari 都不会显示文件或提供下载文件的选项。它显示一个空白屏幕。

有没有人看到这个问题和潜在的修复

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-23T19:31:09.377

自从我使用 iOS 以来已经有一段时间了，所以我的回答可能已经过时了，但是这里......

据我所知，您的问题可能`application/vnd.openxmlformats-officedocumrent.wordprocessingml.document`是 Apple 平台默认不[支持](https://developer.apple.com/library/mac/#documentation/Miscellaneous/Reference/UTIRef/Articles/System-DeclaredUniformTypeIdentifiers.html#//apple_ref/doc/uid/TP40009259-SW1)的问题。除非您有一个与该 mime 类型[相关联](https://stackoverflow.com/questions/2774343/how-do-i-associate-file-types-with-an-iphone-application)的应用程序，否则您可能根本无法在 iPad 上打开它。您说它在笔记本电脑/PC 上运行良好，但这包括苹果笔记本电脑/台式机吗？[我怀疑它在那里也行不通](http://www.macworld.com/article/1152264/convertdocxtodoc.html)。如果您在 Mac 上成功打开它，那么您可能安装了一个程序（在基本操作系统之外）处理该类型并已在操作系统中注册。

我的 iPad/iPhone 越来越老了，自从我为 iOS 开发以来已经有一段时间了，但是除非他们在新版本中添加了一些东西，否则没有通用的“保存到磁盘”功能。您要么拥有处理它的应用程序，要么无法浏览它。

但是，鉴于您正在处理 MS 格式的世界，并且很多人在为这些格式提供服务时搞砸了这些 mime 类型，在您放弃之前我会尝试的一件事是使用错误的 mime/类型（应用程序/msword）。旧的 mime 类型的现有处理程序完全有可能已更新以处理错误提供的较新版本的文档（这样做可能是为了避免在某些时候没有正式承诺完全支持新类型的不良用户体验）。网络（尤其是网络浏览器）充满了“化妆代码”

*如果*这样可行，它可能不可靠，并且如果您仍然想支持苹果平台，那么最好选择具有成熟苹果支持的辅助格式，如 pdf 或较旧的 .doc 格式。当您检测到 iPad 或其他苹果设备时，您可以提供该服务。或者，您可以告知您的用户，他们需要一个第三方应用程序才能使用 Mac/iPad。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-27T17:57:54.443

通过 SkyDrive 免费使用 Microsoft Office Web 应用程序。

upd.：目前您还可以尝试具有多点触控功能的 MSO Web 应用程序的预览版。

# 3d - XNA：在 3D 中彼此靠近的纹理被剪裁

> ID：11996292
> 
> 赞同：0
> 
> 时间：2012-08-16T22:22:33.947
> 
> 标签：3d, xna, textures

我正在绘制两个几乎彼此同时定位的四边形。唯一的区别是一个垂直高于另一个。

当相机靠近四边形时，一切都很好。

但是，如果我离得更远，就好像图形在互相争斗，看谁能先画。图形显示正在发生的事情。

地板，黑色，与冰质地交战。当相机从远处缩放和旋转时，它会导致绘制随机线。

![黑线不应该在那里](../Images/bcb3b94a61f43cd2ccba0836149d3880.png)

我需要执行哪些步骤才能正确显示图形？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T02:02:47.793

这种事情是由深度值的分辨率限制引起的。您可以采取一些措施来避免它：

*   最有可能的是：您的“近”和“远”距离被设置得不必要的远。如果远近比太大，则远裁剪平面附近的深度分辨率会很差。如果一组固定的近/远平面无法处理所有可能的相机视图，您可能会考虑根据相机的位置或场景中的可见对象动态调整它们。
*   显而易见：尝试增加对象的分离。有时问题是表面被简单地指定得太靠近。
*   作弊：您可以添加深度偏差来调整问题对象。这是hacky和脆弱的，但它有时会起作用。在你的情况下，我猜地板应该比其他任何东西都更深 - 所以如果你不想真正将它向下移动，你可以添加一个深度偏差。
*   作为最后的手段：如果上述调整都不可行，您可能需要增加深度缓冲区的分辨率。我不确切知道 XNA 在这方面暴露了什么，所以我只是将其作为一种可能性来提及。

# javascript - jslint 中出现意外的“++”

> ID：11996293
> 
> 赞同：9
> 
> 时间：2012-08-16T22:22:35.193
> 
> 标签：javascript, jslint

> **可能重复：**
> [为什么要避免 JavaScript 中的递增（“++”）和递减（“--”）运算符？](https://stackoverflow.com/questions/971312/why-avoid-increment-and-decrement-operators-in-javascript)
> [jslint 中的“意外 ++”错误](https://stackoverflow.com/questions/3000276/the-unexpected-error-in-jslint)

jslint.com 给了我错误：

```
Unexpected '++'. 
```

对于这一行：

```
for (i = 0; i < l; ++i) { 
```

我试过`i++`但不行。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-16T22:24:21.577

JSLint 不喜欢递增和递减运算符。将其替换为`i += 1`或将`plusplus: true`指令添加到文件顶部（如果您不确定如何设置 JSLint 指令，这是一个示例。它们在文件顶部的普通注释中设置）：

```
/*jslint plusplus: true */ 
```

来自[JSLint 文档](http://www.jslint.com/help.html)：

> 众所周知，`++`(increment) 和`--`(decrement) 运算符会通过鼓励过多的技巧来导致糟糕的代码。它们在启用病毒和其他安全威胁方面仅次于错误的架构。

完全荒谬的规则？你可以自行脑补...

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-08-16T22:25:03.890

试试： for (var i = 0; i < l; i++) {

如果这不起作用，请通过在控制台中键入 i 并查看响应来查看是否定义了 i。

# c# - C#.net 识别 zip 文件

> ID：11996299
> 
> 赞同：19
> 
> 时间：2012-08-16T22:23:47.423
> 
> 标签：c#, zip, .net-4.5, sharpziplib

我目前正在使用 SharpZip api 来处理我的 zip 文件条目。它非常适合拉链和解压缩。不过，我无法确定文件是否为 zip。我需要知道是否有办法检测文件流是否可以解压缩。原来我用

```
FileStream lFileStreamIn = File.OpenRead(mSourceFile);
lZipFile = new ZipFile(lFileStreamIn);
ZipInputStream lZipStreamTester = new ZipInputStream(lFileStreamIn, mBufferSize);// not working
lZipStreamTester.Read(lBuffer, 0, 0);
if (lZipStreamTester.CanDecompressEntry)
{ 
```

LZipStreamTester 每次都变为 null 并且 if 语句失败。我试过有/没有缓冲区。任何人都可以就原因提供任何见解吗？我知道我可以检查文件扩展名。我需要比这更确定的东西。我也知道 zip 有一个神奇的#(PK something)，但它不能保证它会一直存在，因为它不是格式的要求。

我还阅读了有关 .net 4.5 具有本机 zip 支持的信息，因此我的项目可能会迁移到该版本而不是Sharpzip，但我仍然不需要在这里看到类似于 CanDecompressEntry 的方法/参数：http: [//msdn.microsoft.com/en-我们/图书馆/3z72378a%28v=vs.110%29](http://msdn.microsoft.com/en-us/library/3z72378a%28v=vs.110%29)

我最后的手段是使用 try catch 并尝试对文件进行解压缩。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-16T22:39:29.490

这是一个组件的基类，该组件需要处理未压缩、PKZIP 压缩 (sharpziplib) 或 GZip 压缩（内置于 .net）的数据。也许比你需要的多一点，但应该让你继续前进。这是使用@PhonicUK 的建议来解析数据流标头的示例。您在小工厂方法中看到的派生类处理了 PKZip 和 GZip 解压缩的细节。

```
abstract class Expander
{
    private const int ZIP_LEAD_BYTES = 0x04034b50;
    private const ushort GZIP_LEAD_BYTES = 0x8b1f;

    public abstract MemoryStream Expand(Stream stream); 

    internal static bool IsPkZipCompressedData(byte[] data)
    {
        Debug.Assert(data != null && data.Length >= 4);
        // if the first 4 bytes of the array are the ZIP signature then it is compressed data
        return (BitConverter.ToInt32(data, 0) == ZIP_LEAD_BYTES);
    }

    internal static bool IsGZipCompressedData(byte[] data)
    {
        Debug.Assert(data != null && data.Length >= 2);
        // if the first 2 bytes of the array are theG ZIP signature then it is compressed data;
        return (BitConverter.ToUInt16(data, 0) == GZIP_LEAD_BYTES);
    }

    public static bool IsCompressedData(byte[] data)
    {
        return IsPkZipCompressedData(data) || IsGZipCompressedData(data);
    }

    public static Expander GetExpander(Stream stream)
    {
        Debug.Assert(stream != null);
        Debug.Assert(stream.CanSeek);
        stream.Seek(0, 0);

        try
        {
            byte[] bytes = new byte[4];

            stream.Read(bytes, 0, 4);

            if (IsGZipCompressedData(bytes))
                return new GZipExpander();

            if (IsPkZipCompressedData(bytes))
                return new ZipExpander();

            return new NullExpander();
        }
        finally
        {
            stream.Seek(0, 0);  // set the stream back to the begining
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-05-19T12:38:33.853

查看[https://stackoverflow.com/a/16587134/206730](https://stackoverflow.com/a/16587134/206730)参考

检查以下链接：

[icsharpcode-sharpziplib-validate-zip-文件](https://stackoverflow.com/questions/9539730/icsharpcode-sharpziplib-validate-zip-file)

[如何检查文件是否在 C 中压缩#](http://blog.somecreativity.com/2008/04/08/how-to-check-if-a-file-is-compressed-in-c/)

ZIP 文件始终以 0x04034b50（4 个字节）开头
查看更多：[http ://en.wikipedia.org/wiki/Zip_(file_format)#File_headers](http://en.wikipedia.org/wiki/Zip_(file_format)#File_headers)

示例用法：

```
 bool isPKZip = IOHelper.CheckSignature(pkg, 4, IOHelper.SignatureZip);
        Assert.IsTrue(isPKZip, "Not ZIP the package : " + pkg);

// http://blog.somecreativity.com/2008/04/08/how-to-check-if-a-file-is-compressed-in-c/
    public static partial class IOHelper
    {
        public const string SignatureGzip = "1F-8B-08";
        public const string SignatureZip = "50-4B-03-04";

        public static bool CheckSignature(string filepath, int signatureSize, string expectedSignature)
        {
            if (String.IsNullOrEmpty(filepath)) throw new ArgumentException("Must specify a filepath");
            if (String.IsNullOrEmpty(expectedSignature)) throw new ArgumentException("Must specify a value for the expected file signature");
            using (FileStream fs = new FileStream(filepath, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
            {
                if (fs.Length < signatureSize)
                    return false;
                byte[] signature = new byte[signatureSize];
                int bytesRequired = signatureSize;
                int index = 0;
                while (bytesRequired > 0)
                {
                    int bytesRead = fs.Read(signature, index, bytesRequired);
                    bytesRequired -= bytesRead;
                    index += bytesRead;
                }
                string actualSignature = BitConverter.ToString(signature);
                if (actualSignature == expectedSignature) return true;
                return false;
            }
        }

    } 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-08-16T22:26:20.173

您可以：

*   使用 try-catch 结构并尝试读取潜在 zip 文件的结构
*   解析文件头看是否为zip文件

ZIP 文件始终以 0x04034b50 作为其前 4 个字节 ( [http://en.wikipedia.org/wiki/Zip_(file_format)#File_headers](http://en.wikipedia.org/wiki/Zip_(file_format)#File_headers) )

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-03-11T13:58:03.420

我使用了[https://en.wikipedia.org/wiki/List_of_file_signatures](https://en.wikipedia.org/wiki/List_of_file_signatures)，只是为我的 zip 文件添加了一个额外的字节，以区分我的 zip 文件和 Word 文档（它们共享前四个字节）。

这是我的代码：

```
public class ZipFileUtilities
{
    private static readonly byte[] ZipBytes1 = { 0x50, 0x4b, 0x03, 0x04, 0x0a };
    private static readonly byte[] GzipBytes = { 0x1f, 0x8b };
    private static readonly byte[] TarBytes = { 0x1f, 0x9d };
    private static readonly byte[] LzhBytes = { 0x1f, 0xa0 };
    private static readonly byte[] Bzip2Bytes = { 0x42, 0x5a, 0x68 };
    private static readonly byte[] LzipBytes = { 0x4c, 0x5a, 0x49, 0x50 };
    private static readonly byte[] ZipBytes2 = { 0x50, 0x4b, 0x05, 0x06 };
    private static readonly byte[] ZipBytes3 = { 0x50, 0x4b, 0x07, 0x08 };

    public static byte[] GetFirstBytes(string filepath, int length)
    {
        using (var sr = new StreamReader(filepath))
        {
            sr.BaseStream.Seek(0, 0);
            var bytes = new byte[length];
            sr.BaseStream.Read(bytes, 0, length);

            return bytes;
        }
    }

    public static bool IsZipFile(string filepath)
    {
        return IsCompressedData(GetFirstBytes(filepath, 5));
    }

    public static bool IsCompressedData(byte[] data)
    {
        foreach (var headerBytes in new[] { ZipBytes1, ZipBytes2, ZipBytes3, GzipBytes, TarBytes, LzhBytes, Bzip2Bytes, LzipBytes })
        {
            if (HeaderBytesMatch(headerBytes, data))
                return true;
        }

        return false;
    }

    private static bool HeaderBytesMatch(byte[] headerBytes, byte[] dataBytes)
    {
        if (dataBytes.Length < headerBytes.Length)
            throw new ArgumentOutOfRangeException(nameof(dataBytes), 
                $"Passed databytes length ({dataBytes.Length}) is shorter than the headerbytes ({headerBytes.Length})");

        for (var i = 0; i < headerBytes.Length; i++)
        {
            if (headerBytes[i] == dataBytes[i]) continue;

            return false;
        }

        return true;
    }

 } 
```

可能有更好的编码方法，特别是字节比较，但由于它是一个可变长度的字节比较（取决于被检查的签名），我觉得至少这段代码是可读的——至少对我来说是这样。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-08-16T22:36:12.267

如果您正在为 Web 编程，您可以检查文件内容类型：application/zip

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-16T10:52:59.140

感谢 dkackman 和 Kiquenet 提供上述答案。为了完整起见，以下代码使用签名来识别压缩 (zip) 文件。然后，您会增加复杂性，较新的 MS Office 文件格式也将返回匹配此签名查找（您的 .docx 和 .xlsx 文件等）。正如其他地方所说，这些确实是压缩档案，您可以使用 .zip 扩展名重命名文件并查看其中的 XML。

下面的代码，首先使用上面使用的签名检查 ZIP（压缩），然后我们对 MS Office 包进行后续检查。请注意，要使用 System.IO.Packaging.Package，您需要对“WindowsBase”的项目引用（即 .NET 程序集引用）。

```
 private const string SignatureZip = "50-4B-03-04";
    private const string SignatureGzip = "1F-8B-08";

    public static bool IsZip(this Stream stream)
    {
        if (stream.Position > 0)
        {
            stream.Seek(0, SeekOrigin.Begin);
        }

        bool isZip = CheckSignature(stream, 4, SignatureZip);
        bool isGzip = CheckSignature(stream, 3, SignatureGzip);

        bool isSomeKindOfZip = isZip || isGzip;

        if (isSomeKindOfZip && stream.IsPackage()) //Signature matches ZIP, but it's package format (docx etc).
        {
            return false;
        }

        return isSomeKindOfZip;
    }

    /// <summary>
    /// MS .docx, .xslx and other extensions are (correctly) identified as zip files using signature lookup.
    /// This tests if System.IO.Packaging is able to open, and if package has parts, this is not a zip file.
    /// </summary>
    /// <param name="stream"></param>
    /// <returns></returns>
    private static bool IsPackage(this Stream stream)
    {
        Package package = Package.Open(stream, FileMode.Open, FileAccess.Read);
        return package.GetParts().Any();
    } 
```

# vb.net - Visual Basic 2008 - 从列表框中获取某个值并在文本框中显示

> ID：11996300
> 
> 赞同：2
> 
> 时间：2012-08-16T22:23:50.037
> 
> 标签：vb.net, string, listbox

我一直在尝试这样做一段时间，但我不确定。

例如，列表框内容是：

```
id = 0 - Block
id = 1 - Cow 
```

我想要的是只获取要显示在文本框中的 ID 号

所以对于一个文本框，它看起来像这样：

```
0
1 
```

没有其他东西。

谢谢大家 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:36:02.890

也许：

```
Dim s = ListBox1.SelectedItem.ToString()
s = s.replace("id =","")  'remove "id ="
s = s.Substring(0,s.IndexOf("-")-1).Trim() 'truncate s from the start to the "-" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:47:43.103

还可以使用：

```
Dim id = Split(listbox.SelectedItem.ToString(),"-")(0) 
```

然后做你的替换：

```
id = id.Replace("id = ","") 
```

## 或者

```
id = listbox.SelectedItem.ToString()
id = id.Substring(id.IndexOf("=") +1), id.IndexOf("-") -1) 
```

+1 和 -1 将移动到一个空格之外并在一个空格之前停止。

这两种解决方案都需要减少 2 次方法调用，如果我没记错的话，这意味着在内存中创建更少的字符串副本，做你正在做的事情。不过，不要在最后一部分引用我的话。=)

# visual-studio-2012 - Visual Studio 2012，Razor 视图错误和构建成功

> ID：11996308
> 
> 赞同：1
> 
> 时间：2012-08-16T22:24:27.907
> 
> 标签：visual-studio-2012

> **可能重复：**
> [在构建期间检查剃刀错误](https://stackoverflow.com/questions/5667358/check-for-razor-errors-during-build)

当我在 VS2012 中编译 ASP.Net MVC 4 项目时，我收到通知

构建成功

是否存在与 Razor 视图相关的构建错误。输出选项卡没有列出任何错误。如果我检查错误列表选项卡，我只会看到与 Razor 视图相关的错误。

是否有可能与 Razor 视图相关的构建错误触发构建失败而不是构建成功消息？

# html - WebApi 不序列化空字段

> ID：11996314
> 
> 赞同：1
> 
> 时间：2012-08-16T22:24:47.853
> 
> 标签：html, asp.net-mvc, json, asp.net-web-api

我的 web api 中有以下命令：

```
return Request.CreateResponse(HttpStatusCode.OK, 
    MyDBContext.DB.Database.SqlQuery<MyCustomerClass>("SELECT * FROM CUSTOMER").ToList()); 
```

这是表格：

```
CREATE TABLE [dbo].[Customer] (
    [CustomerID] [int] NOT NULL,
    [FirstName] [nvarchar](50) NOT NULL,
    [LastName] [nvarchar](50) NULL,
    CONSTRAINT [PK_Customer] PRIMARY KEY CLUSTERED 
([CustomerID] ASC) WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE = OFF, 
      IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) 
      ON [PRIMARY]
) ON [PRIMARY]

GO 
```

我发现从 webApi 请求数据时，如果字段是`null`返回的 JSON 结果，则返回结果中不包含该字段。这是预期的行为吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T00:59:35.217

我发现解决方法是在 json 格式化程序序列化程序设置中指定以下内容：

```
jsonFormatter.SerializerSettings = new JsonSerializerSettings() 
{ 
   NullValueHandling = NullValueHandling.Include 
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:57:55.587

我不认为这是预期的行为。至少在 JSON 方面。关于 WebAPI，我不能说太多，因为我没有使用过它。在我的一个使用 JSON 的项目中，如果我要发出以下代码：

```
# Package our response into an array... 
$response = array("type"=>"remove_from_distribution_list","results");                   

# And send it back to XMLHttpRequest object encoded...       
echo json_encode($response); 
```

结果没有价值，**结果**仍然会被传递。旁边不会有任何值传递。

# objective-c - UITableView setDataSource - 释放对象错误

> ID：11996315
> 
> 赞同：1
> 
> 时间：2012-08-16T22:24:47.687
> 
> 标签：objective-c, ios, memory-management

我有一个`UIViewController`包含这个属性：

```
@property (weak, nonatomic) IBOutlet UITableView *customerTableView; 
```

在 UIViewController 的`viewDidLoad`方法中，我有以下内容：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // ...
    CustomerTableViewDataSource *dataSource = [[CustomerTableViewDataSource alloc]
        init];
    [dataSource setData:customersSource];
    [customerTableView setDataSource:dataSource];
} 
```

我在启用 NSZombies 的情况下收到此消息：

```
*** -[CustomerTableViewDataSource numberOfSectionsInTableView:]: message sent to 
deallocated instance 0x3e07a0 
```

释放的实例地址与数据源相同。

数据源没有“粘住”有什么原因吗？

使用模拟器和 Zombies，我看到引用正在发布`viewDidLoad`，我认为这并不奇怪，因为我在该方法中声明它并且它应该超出范围，但是我认为调用`setDatasource`会增加 refct。好吧，它显然没有。

有什么办法可以改变这种行为吗？

注意：如果我创建一个 ivar 并存储数据源，一切**正常**，但我觉得这让我的课堂变得混乱。这只是城市里的生活吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T22:39:58.557

从以下[文档](http://developer.apple.com/library/IOS/#documentation/UIKit/Reference/UITableView_Class/Reference/Reference.html)：`UITableView`

> @property(nonatomic, assign) id 数据源
> 
> **讨论**
> 
> 数据源必须采用 UITableViewDataSource 协议。**不保留数据源。**

这意味着`customerTableView`期望您保留数据源对象，而您没有这样做。' 的代表也是如此`UITableView`（事实上，对于可可中的几乎所有代表，除了`CALayer`' 代表）。做出这个设计决定是有原因的：`UITableView`经常持有的对象也充当其委托。如果委托被保留，程序员将不得不处理保留周期。

不幸的是，该决定的后果是您遇到的问题：现在您需要保留数据源（以及委托，如果有的话），例如通过设置 ivar。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:28:26.597

甚至在 Apple 引入 ARC 之前，表视图的数据源和委托（几乎每个委托，按照设计）总是被声明为（分配）而不是（保留）。如今在 ARC 世界中，我确信它已被声明为 __weak （否则它会导致保留周期）。所以，是的，继续在你的课堂上制作一个 ivar - 这正是 ivar 的用途。

P.s.：创建单独的“数据源”和“委托”类通常是一个糟糕的设计——只要事情不变得复杂，最好使用视图控制器作为你的委托/数据源——在MVC，就是为它设计的层——（视图）*控制器*，它将逻辑链接到显示。

# ruby - 模式加载时的 Nokogiri::XML::Schema SyntaxError

> ID：11996326
> 
> 赞同：6
> 
> 时间：2012-08-16T22:25:48.533
> 
> 标签：ruby, xsd, nokogiri, saml

我正在尝试加载 SAML 协议模式（特别是这个：[https](https://www.oasis-open.org/committees/download.php/3407/oasis-sstc-saml-schema-protocol-1.1.xsd) ://www.oasis-open.org/committees/download.php/3407/oasis-sstc-saml-schema-protocol-1.1.xsd ）但之后这样做：

```
schema = Nokogiri::XML::Schema(File.read('saml11_schema.xsd')) 
```

我得到这个输出：

```
Nokogiri::XML::SyntaxError Exception: Element '{http://www.w3.org/2001/XMLSchema}element', attribute 'ref': The QName value '{urn:oasis:names:tc:SAML:1.0:assertion}Assertion' does not resolve to a(n) element declaration. 
```

尝试用谷歌搜索错误，但没有关于可能发生的事情的线索，有人可以解释一下吗？

> 注意：在 Ruby 1.8.7-p370 中使用 RVM

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-04-09T18:49:43.170

如果所有 .xsd 文件都在同一个地方，并且所有命名空间都被声明为

```
<import namespace="urn:...:ns:name-1.0"
      schemaLocation="name-1.0.xsd"/> 
```

只需使用 File.open 而不是 File.read 来读取 .xsd 文件

Nokogiri 将处理打开所有依赖的模式。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-17T01:36:55.093

如果您引用远程模式，请下载它们并将它们全部放在一个目录中。如果您的机器中已经有 xsd 文件，只需将它们放在同一目录中即可。然后更改您的 xsd 以使用相对路径。例如：

改变这个

```
<xs:import namespace="http://www.w3.org/XML/1998/namespace"
schemaLocation="http://www.w3.org/2001/xml.xsd"/> 
```

至

```
<xs:import namespace="http://www.w3.org/XML/1998/namespace"
schemaLocation="xml.xsd"/> 
```

然后将验证代码包装在 Dir.chdir 调用中。像这样：

```
Dir.chdir(somewhere) do
schema = Nokogiri::XML::Schema(IO.read('your-schema.xsd'))
doc = Nokogiri::XML(IO.read(doc_path))
schema.validate(doc)
end 
```

# c# - DrawToBitmap - System.ArgumentException：参数无效

> ID：11996335
> 
> 赞同：6
> 
> 时间：2012-08-16T22:26:29.650
> 
> 标签：c#, .net, bitmap, system.drawing

我正在创建一个`Label`，有时我正在使用`.DrawToBitmap()`. 我不知道为什么，但是在我运行我的程序一段时间（并且`.DrawToBitmap()`经常调用）之后，我得到了异常：

```
System.ArgumentException: Parameter is not valid.
   at System.Drawing.Bitmap..ctor(Int32 width, Int32 height, PixelFormat format)
   at System.Drawing.Bitmap..ctor(Int32 width, Int32 height) 
```

不知何故，我不能经常调用这个函数。如果我从根本上试试这个：

```
while(true)
{

  System.Windows.Forms.Label label = new Label();

  label.Font = new Font("Arial", 20);
  label.Text = "test";

  try
  {
    Bitmap image = new Bitmap(300, 500);
    label.DrawToBitmap(image, label.ClientRectangle);
  }
  catch (Exception e)
  {
    Console.WriteLine(e);
  }
} 
```

我在 5-6 秒（1000-2000 次通话）后得到了异常。问题是什么？如何避免这种情况？

编辑：谢谢你们的想法`Dispose()`- 如果我在`label`. 即使我不在位图上使用它也很好。两个答案都很好，我只能接受其中一个:(

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-16T22:33:47.640

因此，该错误消息来自 GDI+ 的深处，并且可能出于*多种*原因出现。但是，我发现您的代码存在一个明显的问题，即候选代码：

```
 label.Font = new Font("Arial", 20); 
```

`Font`对象实现`IDisposable`，并且您在紧密循环中创建了很多对象，并且从不调用`Dispose()`. 位图本身也是如此。我敢打赌，GDI 的资源已经用完了。

很难理解您的代码。它基本上什么都不做，只是创建了大量的`Font`和`Bitmap`对象，所以我什至不能建议将这些声明中的每一个都包含在一个`using`语句中。除此之外，当您连续快速创建大量 GDI 对象而不处置它们时，您最终会遇到这个问题。

如果您需要这些对象在一段时间内有效，那么您需要确保`Dispose()`稍后调用它们以尽可能及时地释放本机资源（终结器会为您执行此操作，但最好不要等待它至）。如果它们是本地对象，则将它们包装在一个`using`语句中，以便`Dispose()`在块退出时调用：

```
using(var b = new Bitmap(w, h))
{
    // use 'b' for whatever
} // b.Dispose() is called for you 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-16T22:35:21.387

GDI+ 异常相当糟糕，它们通常不能很好地描述真正的问题。在这种情况下，它实际上意味着“位图太大”。它仍然不能很好地描述它，你实际上用完了非托管内存。位图太大，无法容纳仍然可用的内存量。

因为您没有在位图上调用 Dispose() 方法。您通常可以忽略这一点而不会注意到麻烦。但不是 Bitmap，它是一个占用很少垃圾回收内存但占用大量非托管内存的类。它不会足够快地触发垃圾收集器以让终结器释放非托管内存。

代码片段没有意义，但你会这样写以避免异常：

```
using (Bitmap image = new Bitmap(300, 500)) {
    label.DrawToBitmap(image, label.ClientRectangle);
} 
```

# c# - 从 windows mobile 6.0 连接到 SQL Server 2008 时出现异常

> ID：11996339
> 
> 赞同：4
> 
> 时间：2012-08-16T22:26:42.587
> 
> 标签：c#, windows-mobile, sql-server-2008-r2

我想从 Windows 移动应用程序连接到 SQL Server。我试图这样做，但是当代码尝试打开连接时会引发 SQL 异常。我搜索了这个问题，发现文章在 SQL Server 上进行了一些配置更改，我遵循了它，它引发了同样的异常

： http: [//netcf2.blogspot.com/2005/12/accessing-sql-server-express-from.html](http://netcf2.blogspot.com/2005/12/accessing-sql-server-express-from.html)

**工具 ：**

*   SQL Server 管理工作室 2008 R2
*   视窗移动 6.0
*   对比 2008
*   C#项目和SQL Server在同一台机器上，我使用相同的代码从桌面应用程序连接到SQL Server，它成功了。

**代码 ：**

```
SqlConnection conn = new SqlConnection("Data Source=.;Initial Catalog=DBNAME;Trusted_Connection=yes;");
conn.Open(); 
```

您的回复将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T05:19:16.503

您的连接字符串很可能是错误的来源：

```
Data Source=.;Initial Catalog=DBNAME;Trusted_Connection=yes;
           **** 
```

这`.`（点）表示：您正在尝试连接到该设备上的完整 SQL Server 实例**！**我非常怀疑您是否已将 SQL Server 安装到您的 Windows Mobile 设备上......

查看[ConnectionStrings.com](http://ConnectionStrings.com)以获取大量连接字符串示例和说明。基本上，您的连接字符串应该很可能是这样的：

```
Data Source=YourServerNameHere;Initial Catalog=DBNAME;Trusted_Connection=yes; 
```

**输入SQL Server 实际驻留**的计算机的名称（或 IP 地址）——它绝对不在您的移动设备上......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-30T06:30:11.727

尝试使用机器的 PPP IP 地址而不是“.”。请参阅[此](https://stackoverflow.com/questions/461957/get-ip-address-of-host-pc-from-windows-mobile-when-connected-via-activesync)链接以了解如何查找 PPP IP 地址。

链接：[通过 ActiveSync 连接时从 windows mobile 获取主机 pc 的 IP 地址](https://stackoverflow.com/questions/461957/get-ip-address-of-host-pc-from-windows-mobile-when-connected-via-activesync)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-27T16:15:19.173

确保您的移动设备（模拟器或物理设备）可以物理连接到运行 SQL Server 的远程 PC。

例如，如果您的 SQL Server 在名为“AppServer”的 PC 上运行，则进入移动文件资源管理器

![开始屏幕](../Images/cb28cb40ae86fda50b65d655f16547b5.png)

在文件资源管理器中，转到底部的菜单按钮并选择打开路径

![文件管理器](../Images/5356386ffd49a9aa2babad81c0e899e9.png)

在此处输入 SQL Server 的路径

![网络路径](../Images/7bc70616bec188c17f65f2a735780b83.png)

如果你可以从那里得到它，你应该能够从 Visual Studio 得到它。

如果您无法从那里得到它（正如我所怀疑的那样），Windows Mobile 应该会给您提供更多信息的错误消息，您会知道这不是您的项目的问题，而是网络连接问题。

**[更新]**如果您无法使用当前设置进行连接，则需要进入设备上的设置并设置设备用于连接网络的连接。

![连接截图](../Images/f6a01c592fa0579ecc4f8f4d99cc1ee8.png)

我的模拟器没有无线网卡（如上图所示），但您需要配置无线网卡和网络的无线路由器，以便它们可以协同工作。

如果您还没有这样做，那么这个问题已经得到解答，您需要努力让您的设备连接到您的网络。

这是我在网上找到的教程：[Texas A&M University Students: How to Connect to the Campus Wireless Network](http://tamulink.tamu.edu/Windows%20Mobile%205%20and%206.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-24T13:42:15.613

我也有同样的问题。

我使用了这个连接字符串

Data Source=My-PC;Initial Catalog=TestDB;Persist Security Info=True;User ID=Admin;Password= ***** ****** ";

然后我尝试了它的IP

"数据源=10.219.47.79；初始目录=TestDB；持久安全信息=True；用户ID=Admin；密码= ***** ****** "；

这就是你所说的IP吗？因为我认为我们可以在 SQL 服务器所在的同一台机器上运行移动应用程序

# ios - 设置 GLKView 渲染缓冲区大小

> ID：11996340
> 
> 赞同：1
> 
> 时间：2012-08-16T22:26:57.803
> 
> 标签：ios, ipad, opengl-es-2.0

我正在开发一个 iPad OpenGL ES 2.0 应用程序，需要一个 1024x768 的后备帧缓冲区。我使用 GLKView 和 iOS 5.1 来管理后端帧/渲染缓冲区的创建（使用 XCode 提供的自动生成的 OpenGL 游戏模板中的代码）。我在 iPad2 上获得了可以接受的性能，而且生活还不错。

然而，在测试期间，我得到了一台配备 Retina 显示屏的 iPad 3，当我的应用程序重新编译/安装到 iPad3 时，后端帧/渲染缓冲区以 2048x1536 运行，这削弱了我的性能。

现在我的问题：

1) 如何强制 GLKView 自动生成的帧缓冲区默认为 1024x768 而不是 2048x1536。

奖金问题：

2) 为什么我没有得到 x2 缩放按钮？这是因为我重新编译了附加 iPad3 的应用程序，并且 Xcode 做了一些幕后修改吗？如果我只在连接 iPad2 的情况下编译应用程序并将应用程序提交到 AppStore，那么运行 iPad3 的最终用户真的会得到 x2 缩放按钮吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:01:02.177

为了强制`GLKView`不使用完整的视网膜分辨率，只需将 设置`contentScaleFactor`为`1.0`。

是每点的`contentScaleFactor`像素数。所有 iPad 的屏幕分辨率均为 1024x768 点，因此内容比例因子为 1.0 的全屏视图将具有 1024x768 像素。否则，比例因子在 Retina 设备上默认为 2.0，否则为 1.0。

# python - irc 机器人自动模式

> ID：11996345
> 
> 赞同：1
> 
> 时间：2012-08-16T22:28:03.633
> 
> 标签：python, bots, irc

我一直在研究这个 irc 机器人，只是看看我是否可以重新创建 ChanServ 或任何其他机器人可以提供的一些基本功能，我尝试制作这个小东西，但它仅限于一个昵称：

```
if '@wikia/Example JOIN #channel' in line:
    print 'Giving op status to @wikia/Example'
    self.s.send('MODE #channel Example +o\n') 
```

仅当@wikia/Example 在开始时将#channel 与昵称Example 连接时才有效，但如果@wikia/Example 与昵称Example_rules 连接#channel，那么它将不起作用，因为我收到错误，昵称“Example”没有不存在。无论昵称是什么，@wikia/Example 怎么可能是 +o？

这是一条线的样子
`:Nickname!~login@wikia/Example PRIVMSG #channel :This is a message.`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T17:06:24.797

你应该给加入的昵称+o，而不是硬编码的昵称。改变：

```
self.s.send('MODE #channel +o Example\r\n') 
```

用保存连接缺口的变量更改“示例”，问题将得到解决。IRC 也是一个旧协议，它需要 \r\n。

# jquery - MVC - 将值从 javascript 传递到 View 渲染

> ID：11996352
> 
> 赞同：0
> 
> 时间：2012-08-16T22:29:50.793
> 
> 标签：jquery, asp.net-mvc

我希望你能帮我解决这个问题。

我需要执行以下操作，但我不知道是否可行。

在我看来，我有一个接收一个参数的函数。该值已存在于 texbox 字段中，但我不知道如何将其发送到我的函数。

```
 <% Permissions TV = new Permissions();  %>            
 <%: Html.TreeViewAsUnorderedList(TV.GetPermissionsItems((int?)document.getElementById('txtPerfil').value  ))%>  

 <%: Html.TextBox("txtPerfil","" , new { disabled = "true", style = "width:20px", id = "txtPerfil"  })%> 
```

问候，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T04:58:15.563

您的函数是服务器代码，但 javascript 是客户端代码，因此不可能。如果您向我们提供更多信息，我们会建议您如何做您需要的事情

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T05:28:35.997

好的，您在要发送到服务器端（函数/操作）的文本框中有一个值。

您应该有一个事件，您可以在该事件上将此值发送到您的操作方法。事件可以是任何简单的 javascript 事件，如 onBlur、onClick 等……我留给你决定。

现在将价值发送给功能。在这里，如果您不希望回复发生，我假设您这样做，您需要对您的操作进行 ajax/json 调用并在此处传递值。

示例代码：取自[本文](http://yassershaikh.com/how-to-call-an-action-from-javascript-or-jquery-in-mvc-3-razor/)

**Js/Jquery 代码**

```
var url = '@Url.Action("GetData")';
$.ajax({
url: url,
type: 'GET',
cache: false,
data: { value: strId},

success: function (result) {
$('#result).html(result);
  alert(result.foo + result.ball);
}
}); 
```

**CSharp 代码：操作方法（返回 Json）**

```
public ActionResult GetData(string value)
{
return Json(new {foo="bar", ball="dragon"});
} 
```

希望这可以帮助。

# configuration-files - 应该使用什么扩展名来为程序创建配置文件？

> ID：11996356
> 
> 赞同：0
> 
> 时间：2012-08-16T22:30:01.150
> 
> 标签：configuration-files, file-extension

在许多操作系统和编程语言中，有各种扩展用于配置或初始化文件。

一些示例包括：.cnf、.ini、.cfg

对于用于配置文件扩展的跨平台程序或脚本来说，什么是一个不错的选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:35:00.737

取决于：

*   您所采用的技术（例如 ASP.Net 使用无需重新编译即可修改的 web.config 文件）

*   你想在什么级别上使用配置文件

    *   XML 可能是合适的（并且被广泛使用）
    *   纯文本也可以（但可能更难解释）

..只要使用对你来说最酷的东西。

# c++ - C++ 我有一个模板类，它有一个 print() 方法，我需要根据类型采取不同的行动

> ID：11996358
> 
> 赞同：3
> 
> 时间：2012-08-16T22:30:10.107
> 
> 标签：c++, templates, typechecking

我知道模板的重点是概括您的代码，但是我希望该类的一个特定成员函数根据创建的对象类型做出不同的反应。具体来说，我创建了一个类字典，用于创建 DictionaryNoun 或 DictionaryAdjective 对象。我有一个 Dictionary::print() 我想要一个代码结构如下：

```
Dictionary::print(){
   if(this is a Dictionary<Noun> object){
       // Print my nouns in some special way
   }
   if(this is a Dictionary<Adjective> object){
       // Print my adjectives in some special way
   }
   else{ //Print objects in default way}
} 
```

我的问题是如何对我的对象进行类型检查？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T22:34:46.213

C++ 允许您专门针对特定模板参数的成员函数。例如，如果你有这样的事情：

```
template <typename T> class Dictionary {
    /* ... */
}; 
```

然后你可以通过写作来专门化`print`a 的作用`Dictionary<Noun>`

```
template <>
    void Dictionary<Noun>::print() {
    /* ... special code for printing nouns ... */
} 
```

你可以专攻`Adjective`相同的方式。最后，您可以编写一个默认实现，如果两者都不匹配，则通过编写

```
template <typename T>
    void Dictionary<T>::print() {
    /* ... catch-all code ... */
} 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T23:40:10.450

`Noun`虽然您可以使用专业化来处理这个问题，但我相信如果您在元素 ( , )中实现实际打印而不是这样设计会更好，`Adjective`然后`Dictionary<T>::print`遍历容器调用适当的重载/成员函数。

```
void print( std::ostream& o, Noun const & n );
void print( std::ostream& o, Adjective const & a );
// Alternatively
// void Noun::print( std::ostream& );
// void Adjective::print( std::ostream& );

template <typename T>
void Dictionary<T>::print( std::ostream& o ) {
   // iterate over all elements:
   for ( T const& r : container ) {
      print( o, r );
      // alternatively: r.print(o);
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T22:47:24.663

您不需要用于函数（或方法）重载的模板。

```
void print(std::ostream &os, const Noun &v) {}
void print(std::ostream &os, const Adjective &v) {} 
```

尽管您需要一个模板作为全部内容。

```
template<typename T>
  void print(std::stream &os, const T &v) {} 
```

# django - Django 管理员查询/搜索表单

> ID：11996359
> 
> 赞同：1
> 
> 时间：2012-08-16T22:30:30.897
> 
> 标签：django, django-admin

我想为多个 Django 更改列表表单添加简单的查询功能。我希望为表格提供类似于 phpMyAdmin 的“搜索”选项卡的功能（如此[处](http://www.siteground.com/tutorials/phpmyadmin/phpmyadmin_database_management.htm)和[此处](http://www.packtpub.com/article/searching-data-using-phpmyadmin-and-mysql)的图像所示）。

此功能（几乎）已经通过管理员更改列表上的 URL 查询参数提供。通过 GET 参数查询示例：

```
http://localhost:8000/admin/myapp/mymodel/?my_field=something&my_date__gt=2000-01-01 
```

另一种看待这个问题的方法是，我需要 Django 过滤器来处理任意字段和输入（不显示每个字段的数千/数百万个可能值）。

是否已经存在提供此功能的 Django 应用程序？

# types - Common Lisp：专门研究数组长度的泛型函数

> ID：11996360
> 
> 赞同：1
> 
> 时间：2012-08-16T22:30:42.037
> 
> 标签：types, common-lisp, generic-function

我刚刚开始使用通用函数，想知道这是否可能（我真的希望如此！）。

我制作了 3 个包来处理不同长度的向量：*vector2、vector3*和*vector4*。

每个包都有处理该长度向量的函数：

```
vector2:normalize - for normalizing *vector2s*
vector3:normalize - for normalizing *vector3s*
etc. 
```

我的向量是类型化数组（用于速度和内存使用，因为这是用于编写游戏）所以*vector3*是：

```
(make-array 3 :element-type `single-float). 
```

现在我正在编写一个名为*vectors*的包，它将包含处理任何向量类型的通用函数。

所以传递 vector:normalize a *vector3*应该返回一个*vector3*等等。

我试过这个：

```
(defmethod v+1 ((vec-a #.(class-of (make-array 3 
                       :element-type 
                       `single-float)))
        (vec-b #.(class-of (make-array 3 
                       :element-type 
                       `single-float))))
  (v3:v+1 vec-a vec-b))

(defmethod v+1 ((vec-a #.(class-of (make-array 4
                       :element-type 
                       `single-float)))
        (vec-b #.(class-of (make-array 4 
                       :element-type 
                       `single-float))))
  (v4:v+1 vec-a vec-b)) 
```

...基于我在[问题 6083238](https://stackoverflow.com/questions/6083238/in-common-lisp-how-can-i-check-the-type-of-an-object-in-a-portable-way)中看到的内容，但显然只专注于简单的单浮点数组：

```
V> (class-of (make-array 4 :element-type  `single-float))
#<BUILT-IN-CLASS SB-KERNEL::SIMPLE-ARRAY-SINGLE-FLOAT> 
```

考虑到它需要快速且不占用内存，这样做的最佳方法是什么？

提前干杯！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T07:24:41.517

CL 中的泛型函数可以用类或 EQL-specializer 来专门化（参见[关于 GFs 的 PCL 章节](http://www.gigamonkeys.com/book/object-reorientation-generic-functions.html)）。类不是类型，尽管有一些关系。但是在您的情况下，您只有一个类和一个类型。因此，实际上，您希望将方法专门用于某些任意属性。这只能通过 EQL-specializer 来实现：

```
(defmethod v+1 ((size (eql 3)) vec-a vec-b)
  (v3:v+1 vec-a vec-b))
(defmethod v+1 ((size (eql 4)) vec-a vec-b) 
  (v4:v+1 vec-a vec-b)) 
```

他们不做任何边界检查，而且有点笨拙。第一个问题可以通过在方法体中添加检查来解决：

```
(defmethod v+1 ((size (eql 3)) vec-a vec-b)
  (assert (= 3 (length vec-a) (length vec-b))
    "Vector size mismtach")
  (v3:v+1 vec-a vec-b)) 
```

您还可以定义一个宏来为任何大小生成此类方法。

另一种选择是在调用站点使用宏，这将提供更简单的界面并且还可以执行错误检查：

```
(defmacro v+1* (vec-a vec-b)
  (once-only (vec-a vec-b)
    `(if (= (length ,vec-a) (length ,vec-b))
         (v+1 (length ,vec-a) ,vec-a ,vec-b)
         (error "Vector size mismatch")))) 
```

有关宏的讨论，`ONCE-ONLY`请参见[PCL 章节](http://www.gigamonkeys.com/book/macros-defining-your-own.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T14:00:09.307

本质上，没有办法根据向量的大小进行调度。正如 Vsevolod 所指出的，CLOS 中的泛型函数基于类分派，而 Common Lisp 中数组的类不会因它所拥有的元素数量而改变。

但是，如果性能是您的主要目标，那么无论哪种方式都可能不是您想要做的事情；在如此低的级别上在每个操作中涉及多次调度可能会使您陷入困境。

可能的替代方案：

1.  像工程师一样思考。说服自己，2、3 和 4 向量上的运算符对于您的目的而言是根本不同的事物，并且可能出现在如此不同的情况下，因此为每个向量使用不同的符号是有意义的，然后尽可能调整这些函数。例如：只需定义和使用 +vector3、normalize-vector3 等。

2.  像数学家一样思考。尽可能定义最通用的运算符，这些运算符应该适用于任何向量长度。稍后再担心性能，只优化那些在实际运行的程序中减慢你速度的特定代码部分。例如：

    ```
    (defun v+ (&rest vectors)
      (apply #'map 'vector #'+ vectors))

    (defun normalize (vector)
      (sqrt (reduce (lambda (acc x) (+ acc (* x x))) vector
                    :initial-value 0))) 
    ```

    等等

3.  像人们想象的那样思考 Common Lisp 程序员的想法，然后将其宏观化。如果你想要效率但又觉得你需要一个一致的接口，那么如果泛型函数不能做你想做的事，或者做的不够快，你可以尝试这样的事情：

    ```
    (defvar *vector-op-table* '())   

    (defmacro defvectorops (dimensions &body mappings)   
        `(setf (getf *vector-op-table* ,dimensions) ',mappings))   

    (defun vector-op-reader (stream subchar numarg)   
      (declare (ignore subchar))   
      (let ((form (read stream))   
            (op-table (getf *vector-op-table* numarg)))   
        (sublis op-table form))) 

    (set-dispatch-macro-character
      #\# #\v #'vector-op-reader) 
    ```

    这将允许您定义标准矢量接口（v+1、规范化等）中的名称与用于执行相关操作的任何专用函数的名称之间的映射（如建议 1 中的名称或包限定的名称）。例如：

    ```
    (defvectorops 2
      (v+1 . +vector2)                ; or vector2::v+1, if you want
      (normalize . normalize-vector2)
      ...)

    (defvectorops 3
      (v+1 . +vector3)
      ...) 
    ```

    这会导致诸如

    ```
    #2v(normalize (v+1 a b)) ; => (normalize-vector2 (+vector2 a b))
    #3v(normalize (v+1 a b)) ; => (normalize-vector3 (+vector3 a b)) 
    ```

    以使用专用操作的形式读取，让您可以为向量的任何维度定义此类映射，如果您希望任何代码片段适用于向量的不同维度，则仅更改 #v 中的数字。

    （如果您使用标准命名约定，您可以让 DEFVECTOROPS 为您定义这些映射，但有时最好保持明确）。

请记住，上面的任何代码都未经测试（我在工作，没有可用的 lisp 系统），最后一个解决方案尤其充满了 Starship Troopers 级别的错误，这些错误会严重伤害你（有更明智的方法来这样做，但这只是为了说明），但我只是认为考虑一些可能的替代解决方案可能会很好。您选择哪一个取决于最适合程序/程序员的情况。（不过，我可能会选择选项 1 或 2。）

# php - 为 PHP 电子商务网站创建价格范围函数的想法

> ID：11996361
> 
> 赞同：1
> 
> 时间：2012-08-16T22:30:51.433
> 
> 标签：php, e-commerce

创建一个函数的任何想法，该函数将在一个数组中返回 5 个范围，其中包含起始价格和结束价格。该函数需要为类别或品牌或使用的任何过滤器创建这些范围。许多电子商务网站已经在使用价格范围过滤器。现在我能够创建这样的功能。但在这里我必须添加步数范围。有没有一种方法可以根据该类别的整体价格范围自动执行这些步骤。

```
function price_range($category_id=0, $step=199)
{   
$output = '';
$return = array();

$query = "SELECT * FROM products WHERE category = ".$category_id;
$query .= " ORDER BY PRICE";
$result = mysql_query($query);

if (!$result)
{
    return FALSE;
}
else
{
    if((mysql_num_rows($result) == 0))
    {
        return FALSE;
    }
    else
    { 
        while ($row = mysql_fetch_array($result)) 
        { 

            $prices = array($row['price']); 
        } 
        $ranges = array(); 

        foreach($prices as $p) 
        { 
            $index = floor($p / $step);  
            if(isset($ranges[$index])) 
                $ranges[$index]++; 
            else 
                $ranges[$index] = 1; 
        } 

        for($i = 0; $i <= max(array_keys($ranges)); $i++) 
        { 
            //$output = "(<a href=\"?start=" . ($step * $i) . "&end=" . ($step * ($i + 1)) . "\">" . ($step * ($i + 1)) . " - " . ($step * $i) . "(" . $ranges[$i] . ")<br>";
            $return[$i]['start'] =  ($step * $i);
            $return[$i]['end'] =  ($step * ($i + 1));
            $return[$i]['product_count'] = $ranges[$i];
        }  
    }
}
return $return;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:37:48.213

就像是

```
SELECT
   (MAX(PRICE) - MIN(PRICE)) / COUNT(product) AS step
FROM
   products
WHERE
   category = ?
GROUP BY
   category 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:11:08.963

尝试使用范围功能。

```
$steps = 5;
$delta = floor((max($prices) - min($prices)) / $steps);
$price_steps = range(min($prices), max($prices), $delta); 
```

$price_steps 变为：

```
array(6) {
  [0]=>
  float(0)
  [1]=>
  float(20)
  [2]=>
  float(40)
  [3]=>
  float(60)
  [4]=>
  float(80)
  [5]=>
  float(100)
} 
```

# java - Spring 版本变更导致 RESTful 功能中断

> ID：11996363
> 
> 赞同：2
> 
> 时间：2012-08-16T22:30:53.633
> 
> 标签：java, spring, rest

在升级我的应用程序以使用我可用的最新版本的 Spring (3.1.1) 时，我发现我的一个 REST 调用抛出 404 错误（当它曾经非常成功时）。我已经验证切换回旧库 (3.0.3) 可以正常工作，并且切换回新库失败，所有这些都没有更改我的代码。

```
@Controller
@RequestMapping("/group/{groupId}/template")
public class TemplateController extends AbstractController {
    ...

    @RequestMapping(value="/{templateId}", method=RequestMethod.GET) @ResponseBody
    public Template getTemplate(ServletWebRequest request, 
            @PathVariable("groupId") int groupId, 
            @PathVariable("templateId") int templateId) throws Exception {
        ...
    }

    ...

    @RequestMapping(value="/{templateId}", method=RequestMethod.DELETE) @ResponseBody
    public Task getTemplate(ServletWebRequest request, 
            @PathVariable("groupId") int groupId, 
            @PathVariable("templateId") int templateId) throws Exception {
        ...
    }

    ...
} 
```

我把 GET 方法放在那里只是为了比较，它可以工作。但是，当我请求 DELETE 方法时（同样，它曾经可以工作），我在日志中收到一条错误消息：

```
WARNING: No mapping found for HTTP request with URI [/*appname*/group/1/template/group/1/template/1] in DispatcherServlet with name '*appname*' 
```

现在，错误显然是正确的，我没有该映射的任何 URI，但为什么它试图找到该映射而不是指定的映射 ( `/*appname*/group/1/template/1`)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:43:06.153

它将值中的 / 视为根尝试通过删除方法 @RequestMapping 的值中的 / 来进行映射。

```
@RequestMapping(value="{templateId}", method=RequestMethod.DELETE) @ResponseBody
    public Task getTemplate(ServletWebRequest request, 
            @PathVariable("groupId") int groupId, 
            @PathVariable("templateId") int templateId) throws Exception {
        ...
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T15:06:05.310

我仍然不确定为什么会出现错误，因此对 Spring 的内部工作原理的深入了解将不胜感激，但我确实找出了导致它的原因。该方法与其他方法的唯一不同之处在于它抛出了异常，而其他方法则没有。在我注释掉我的 ExceptionHandler 后，该函数已正确注册。

```
@ExceptionHandler(Exception.class)
public Map<String, String> handleExceptions(Exception e) {
    ...
} 
```

我仍然不知道为什么这会导致它出错，但具有讽刺意味的是，这就是我首先升级库的原因：以便异常处理能够正常工作。在我添加`@ResponseBody`到函数之后（我本来打算这样做），一切正常。

# iphone - 使用调度机制时未单击 Tableview 单元格

> ID：11996366
> 
> 赞同：0
> 
> 时间：2012-08-16T22:31:13.047
> 
> 标签：iphone, objective-c, ios, cocoa, ipad

我正在尝试利用调度机制来获取后台内容，并在获取后更新tableview，但是，这种机制有效，但是一旦重新加载，tableviewcell 就无法点击。当我删除 [self._tableView reloadData] 时，它是可点击的。下面是我的代码。有什么建议么？

```
NSString *const cellIdentifier = @"AutoFill";    
    UITableViewCell *cell = [_tableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellIdentifier];
    }

dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, 0ul);

dispatch_async(queue, ^{
    NSString *te = [tableData objectAtIndex:indexPath.row];
    NSArray *a = [te componentsSeparatedByString:@" "];

    dispatch_sync(dispatch_get_main_queue(), ^{

        cell.accessoryType = UITableViewCellAccessoryNone;
        [self._tableView reloadData];
    });
});

return cell; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:14:54.623

无需在后台访问该数组 - 您只是为了增加复杂性而增加复杂性，这从来没有用处。

```
- The tableView loads it's data and asks the dataSource for a row
- You create a row but then ask the table to reload
- The tableView loads it's data and asks the dataSource for a row
- You create a row but then ask the table to reload
- The tableView loads it's data and asks the dataSource for a row
- You create a row but then ask the table to reload
- The tableView loads it's data and asks the dataSource for a row
- You create a row but then ask the table to reload 
```

我认为你说对了...

`reloadData`当您提供将显示在 tableView 中的行时，您不应该调用

**请注意**，如果您做了正常的事情并且没有在后台获取数据，这甚至不是您必须担心的问题

## 更新

您的代码在后台访问一个数组 - 对它没有任何用处，然后回调主线程以设置一个属性，该属性甚至不是由后台线程中的工作结果确定的。你到底想达到什么目的？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:14:25.823

你陷入了无限循环。当您调用`reloadData`它时，它会强制表重新加载，然后调用：

```
- (UITableViewCell*)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

然后你重新开始。您应该更新单元格，而不是表格。尝试`[cell setNeedsLayout];`或`[cell.contentView setNeedsLayout];`

# java - 添加 HTML 后阻止 WebView 滚动到页面顶部

> ID：11996368
> 
> 赞同：1
> 
> 时间：2012-08-16T22:31:18.860
> 
> 标签：java, javascript, android, android-webview

我正在编写一个使用 WebView 显示内容的 Android 应用程序。该应用程序的主要目的是显示文本供用户阅读。

我正在通过 JavaScript 将 HTML 动态添加到我的 WebView 中。将内容添加到页面底部时，这不是问题。将内容添加到顶部时，WebView 会自动滚动到顶部。那是我的问题。

**我需要尝试找到一种方法来防止我的 WebView 在内容添加到顶部时自动滚动到页面顶部。**

我确实有一些限制：

1) 我正在使用 JavaScript，但无法使用 jQuery。

2) 我目前仅限于 Android API 8 (v2.2)。

3）我不想只是滚动回到我原来的位置。 *（对于这个问题，我已经找到了许多关于 SO 的解决方案，在这些解决方案中，我只是以编程方式滚动回滚动之前的位置。我有一个当前的实现，但它不是一个足够平滑的过渡。）*

4）我需要允许用户在添加内容时不断向上滚动。*（虽然我对禁用滚动以防止 WebView 自行向上滚动的实现持开放态度，但我需要允许用户在我将内容添加到屏幕高度或高于它们的高度时继续向上滚动。）*

对不起，如果这看起来很局限，但你可以明白为什么我需要一些建议。

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:47:23.287

我找到了解决问题的方法。如果有人有另一个，尤其是更直接的答案，我仍然会感兴趣。

在某种程度上，我错误地诊断了我的问题。当我使用: 添加 HTML 时 `document.body.insertBefore(newDiv, topDiv.nextSibling);`，我将我的新 HTML 添加到文档顶部边缘的正下方。

我以为我正在向上滚动到屏幕顶部（坐标 [0,0]），但文档长度发生了变化，而我当前的 Y 位置保持不变。所以我查看的坐标是不变的，但是这些坐标显示的 HTML 发生了变化。效果是“向上滚动”页面。

我最终在可见文本上方添加了一个巨大的空白 div。每次我添加 HTML 时，它都会按添加的 HTML 的确切高度缩小。这抵消了添加的文本，使我的可见屏幕保持完全相同。这意味着**没有**滚动，这是一个***更加***流畅的 UI。

这提供了一套完全不同的解决方法，比如阻止用户滚动我的空白区域的整个长度，并确保我的 WebView 不会大于我的最大尺寸。不过，权衡是非常值得的，因为用户体验得到了极大的改善。

# python - Python如何访问子文件夹的子文件夹

> ID：11996370
> 
> 赞同：3
> 
> 时间：2012-08-16T22:31:37.593
> 
> 标签：python, python-2.7

我是 python 新手，无法访问子文件夹中的数学文本文件。

                    ![文件夹的层次结构](../Images/18fe455858c06b521679b030bfaa4ca5.png)

这是我到目前为止写的代码：

```
import os, sys
for folder, sub_folders, files in os.walk(my_directory):
   for special_file in files:
      if special_file == 'math.txt'
         file_path = os.path.join(folder, special_file)
         with open(file_path, 'r+') as read_file
            counter += 1
            print('Reading math txt file' + str(counter))

            for line in read_file:
               print(line) 
```

我无法打印`math.txt`所有班级、所有学校和所有区域内的所有文件。

在我有一个合并所有文件的脚本版本之前，但有些日志文件非常大（合并 > 16GB）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T23:25:44.117

这似乎对我有用。只有@jdi、@MRAB 和我指出的变化——缺少冒号和初始化`counter`变量。由于您使用的是 Windows，因此您可能需要确保正确指定了目录路径。

```
import os, sys

# Specify directory
# In your case, you may want something like the following
my_directory = 'C:/Users/<user_name>/Documents/ZoneA'

# Define the counter
counter = 1

# Start the loop
for folder, sub_folders, files in os.walk(my_directory):
  for special_file in files:
    if special_file == 'math.txt':
      file_path = os.path.join(folder, special_file)

      # Open and read
      with open(file_path, 'r+') as read_file:
        print('Reading math txt file ' + str(counter))

        # Print the file
        for line in read_file:
           print(line)

        # Increment the counter
        counter += 1 
```

# javascript - 如何编写一个简单的音乐播放器？

> ID：11996373
> 
> 赞同：0
> 
> 时间：2012-08-16T22:31:45.637
> 
> 标签：javascript, html, css, audio-player

我不确定为什么我的最后一个问题被删除了，但这次我会尝试更深入。

我正在寻找代码来制作具有以下功能的音乐播放器：

*   音量滑块/调节器
*   有一个歌曲的播放列表队列（所以如果你正在听曲目 1，在它的正下方，会有一个显示曲目 2、曲目 3 等的菜单，如果你点击曲目 3，它将更改为相应的曲目)
*   有控制按钮（播放、暂停、停止、ff、倒带）

我总是可以为我的 8 首歌曲中的每首歌曲配备一个单独的音乐播放器，但我认为为所有歌曲配备一个音乐播放器会容易得多。我不知道这是否可以用 HTML/CSS 制作（我是编码新手），但这会很棒；我只是想让这个工作。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-16T22:34:39.090

您可以尝试[http://schillmania.com/projects/soundmanager2](http://schillmania.com/projects/soundmanager2)。它是一个 HTML5 音频播放器，可以很好地回退到 Flash（作为选项）。

# video - FFmpeg / 创建视频 / 添加每个 jpg 文件的标题（时间戳）以生成 mp4

> ID：11996378
> 
> 赞同：2
> 
> 时间：2012-08-16T22:32:02.093
> 
> 标签：video, text, ffmpeg, screenshot, caption

我有一些图片，如 screenshot-1.jpg，...，screenshot-345.jpg，从我的计算机自动捕获的周期（周期为 30 秒）。我使用 FFmpeg 生成视频 mp4 格式，但是，我想在视频上添加每个 jpg 文件的时间戳。

这是我的 FFmpeg 命令行：

```
ffmpeg.exe -f image2 -r 4 -i screenshot-%0d.jpg -b 512000 -s 3840x1200 -sameq video.mp4 
```

在这种情况下，我可以在视频播放期间显示日期/时间。

*谢谢。低的*

# ms-access - 删除不同表中的相关记录

> ID：11996380
> 
> 赞同：3
> 
> 时间：2012-08-16T22:32:09.440
> 
> 标签：ms-access, asp-classic, while-loop

我有这三个表 [ Orders, order_Items, order_comment ]

```
|    -Orders-    |     |  -Order_Items-   |     | -Order_comment- |
|    order_id    |     |  order_RegCode   |     |    order_id     |
| order_RegCode  | 
```

如您所见，这三个表通过 2 个唯一键关联在一起！`order_id`和`order_RegCode`。

ps：`order_RegCode`不是主键，是字符串！

我想当我删除任何订单时`order_id`，删除存储在另外两个表中的所有相关信息。但是当我使用 Do While 我得到`error Operation is not allowed when the object is closed`.

请指导我。

该代码是：

```
Dim Order_ID
    Order_ID = Int(Request.Form("ID"))

Set Conn = server.createobject("adodb.connection")
Conn.open StrConn
Set Rs = Conn.execute("SELECT * From orders WHERE order_id="& Order_ID &"")
If NOT Rs.EOF then

    RegCode = Rs("order_RegCode")

    '//== Delete Order
    Set Rs = Conn.execute("Delete From orders where order_id = "& orderID &"")

    '//== Delete All Comments Belong to Order
    Set Rs = Conn.execute("Select * From order_comment where order_id = "& Order_ID &"")
    If NOT Rs.EOF then
        Do While NOT Rs.EOF
            Set Rs = Conn.execute("Delete From order_comment where order_id = "& Order_ID &"")
        Rs.MoveNext
        Loop
    End if

    '//== Delete All Items Belong to Order
    Set Rs = Conn.execute("Select * From order_items where order_code = '"& RegCode &"'")
    If NOT Rs.EOF then
        Do While NOT Rs.EOF
            Set Rs = Conn.execute("Delete From order_items where order_code = '"& RegCode &"'")
        Rs.MoveNext
        Loop
    End if

End if 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:56:22.860

您不得将记录集用于操作查询。这些行：

```
Set Rs = Conn.execute("Delete ... 
```

应该：

```
Conn.execute("Delete ... 
```

您不能对所有记录集使用相同的对象。您将需要一个记录集用于外部循环，另一个用于内部循环。不过，我建议：

```
Dim Order_ID
Order_ID = Int(Request.Form("ID"))

Set Conn = server.CreateObject("adodb.connection")
Conn.Open StrConn
Set rs = Conn.Execute("SELECT * From orders WHERE order_id=" & Order_ID)
If Not rs.EOF Then

    RegCode = rs("order_RegCode")

    '//== Delete Order
    Conn.Execute ("Delete From orders where order_id = " & orderID)
    Conn.Execute ("Delete From order_comment where order_id = " & Order_ID)
    Conn.Execute ("Delete From order_items where order_code = '" & RegCode & "'")

End If 
```

# python - 有没有办法从 python 中获取数据库的模式？

> ID：11996394
> 
> 赞同：24
> 
> 时间：2012-08-16T22:33:27.593
> 
> 标签：python, sqlite, database-schema

我正在尝试找到一种方法来查找数据库中表的名称（如果存在）。我发现从 sqlite cli 我可以使用：

```
>.tables 
```

然后对于字段：

```
>PRAGMA TABLE_INFO(table_name) 
```

这显然在 python 中不起作用。有没有办法用 python 做到这一点，或者我应该只使用 sqlite 命令行？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-08-16T22:51:01.910

从[sqlite 常见问题解答](https://www.sqlite.org/faq.html#q7)：

> 在 C/C++ 程序（或使用 Tcl/Ruby/Perl/Python 绑定的脚本）中，您可以通过`SELECT`对名为“SQLITE_MASTER”的特殊表执行 a 来访问表和索引名称。每个 SQLite 数据库都有一个`SQLITE_MASTER`定义数据库模式的表。该`SQLITE_MASTER`表如下所示：
> 
> ```
> CREATE TABLE sqlite_master (
>   type TEXT,
>   name TEXT,
>   tbl_name TEXT,
>   rootpage INTEGER,
>   sql TEXT
> ); 
> ```

因此，要获取所有表名的列表，请执行：

```
SELECT name FROM sqlite_master
WHERE type='table'
ORDER BY name; 
```

要获取给定表的列名，请使用[`pragma table_info`命令](https://www.sqlite.org/pragma.html#pragma_table_info)：

> 此编译指示为命名表中的每一列返回一行。结果集中的列包括列名、数据类型、列是否可以为 NULL，以及列的默认值。

这个命令在 python 中工作得很好：

```
>>> import sqlite3
>>> conn = sqlite3.connect(':mem:')
>>> for row in conn.execute("pragma table_info('sqlite_master')").fetchall():
...     print row
... 
(0, u'type', u'text', 0, None, 0)
(1, u'name', u'text', 0, None, 0)
(2, u'tbl_name', u'text', 0, None, 0)
(3, u'rootpage', u'integer', 0, None, 0)
(4, u'sql', u'text', 0, None, 0) 
```

不幸的是`pragma`，语句不适用于参数；您必须手动插入表名（确保它不是来自不受信任的来源并正确转义）。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-08-16T22:37:15.893

您应该能够从`sqlite_master`表中访问表名。

```
SELECT name FROM sqlite_master WHERE type='table'; 
```

列的名称不能直接访问。获取它们的最简单方法是查询表并从查询结果中获取列名。

```
SELECT * FROM table_name LIMIT 1; 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-01-29T19:45:32.880

这是我根据 Martijn 的回复编写的方便打印机：

```
def printSchema(connection):
    for (tableName,) in connection.execute(
        """
        select NAME from SQLITE_MASTER where TYPE='table' order by NAME;
        """
    ):
        print("{}:".format(tableName))
        for (
            columnID, columnName, columnType,
            columnNotNull, columnDefault, columnPK,
        ) in connection.execute("pragma table_info('{}');".format(tableName)):
            print("  {id}: {name}({type}){null}{default}{pk}".format(
                id=columnID,
                name=columnName,
                type=columnType,
                null=" not null" if columnNotNull else "",
                default=" [{}]".format(columnDefault) if columnDefault else "",
                pk=" *{}".format(columnPK) if columnPK else "",
            )) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-08-16T22:52:45.450

要获取字段名称，请在查询后使用 cur.description：

```
import sqlite3.dbapi2 as sqlite
con = sqlite.connect(":memory:")
cur = con.cursor()
con.executescript("""
    create table test (name, address);
    insert into test (name, address) values ("Jer", "Monterey Street");
""")

cur.execute("select * from test where 1=0")
rs = cur.fetchall()  ## will be [] because of where clause
field_names = [r[0] for r in cur.description] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-06-09T16:33:10.790

使用 sqlite 行对象。行对象具有将为您提供架构的 keys()。

来自 docs.python.org

```
conn.row_factory = sqlite3.Row
c = conn.cursor()
c.execute('select * from stocks')
  <sqlite3.Cursor object at 0x7f4e7dd8fa80>
r = c.fetchone()
type(r)
  <type 'sqlite3.Row'>
  r
  (u'2006-01-05', u'BUY', u'RHAT', 100.0, 35.14)
r.keys()
  ['date', 'trans', 'symbol', 'qty', 'price'] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-20T12:46:45.020

我刚试过

```
SELECT name FROM my_db.sqlite_master WHERE type='table'; 
```

结合 Tom Kerr 的答案和在附加数据库上检索信息的尝试。起初它没有用。原来我首先必须以这种方式附加另一个数据库：

```
ATTACH DATABASE 'file:my_other_database_file.db?cache=shared' as my_db; 
```

否则数据库将无法获得附加数据库的读锁`sqlite_master`（并且所有查询都将成功，结果为零）。只是一个提示，以防其他人偶然发现问题的那一部分。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-08-27T19:35:17.613

要获取架构信息，恕我直言，以下也适用：

```
select sql from sqlite_master where type='table'; 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-05-31T04:35:51.437

## 建立与数据库的连接

```
connection = connect_db('./database_name.db') 
```

## 打印表名

```
table_names = [t[0] for t in connection.execute("SELECT name FROM sqlite_master WHERE type='table';")]
print(table_names) 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-08-06T00:33:04.930

结果集有一个描述，您可以从中获取一些信息。它揭示了一些基本元数据，如列名和列数。

```
>>> rs = c.execute('''SELECT * FROM news WHERE 1=0''');
>>> dir(rs)
['__class__', '__delattr__', '__doc__', '__format__',  
'__getattribute__', '__hash__', '__init__', '__iter__', '__new__',  
'__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__',
'__str__', '__subclasshook__', 'arraysize', 'close', 'connection',
**'description'**, 'execute', 'executemany', 'executescript', 'fetchall',
'fetchmany', 'fetchone', 'lastrowid', 'next', 'row_factory',
'rowcount', 'setinputsizes', 'setoutputsize']

>>> print(rs.description)
(('id', None, None, None, None, None, None), 
('imageUrl', None, None, None, None, None, None), 
('headline', None, None, None, None, None, None), 
('who', None, None, None, None, None, None)) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-10-23T19:19:51.953

假设数据库名为 my_db，表名为 my_table，获取列名和数据类型：

```
con = sqlite.connect(my_db)
cur = con.cursor()
query =  "pragma table_info({})".format(my_table)
table_info = cur.execute(query).fetchall() 
```

它返回一个元组列表。每个元组都有顺序、列名和数据类型。

# java - 从 FileObserver 启动 IntentService

> ID：11996404
> 
> 赞同：0
> 
> 时间：2012-08-16T22:34:54.407
> 
> 标签：java, android, android-intent, intentservice, fileobserver

我正在编写一个使用 android 中的 fileobserver 的应用程序。当我以任何方式修改文件（创建等）时，它应该上传。为了实现一个队列并通过使用线程等来避免内存不足，我想使用一个 IntentService 一次上传一个文件，并在它失败时不执行，这样当用户重新连接时，它上传。但问题是：

Intent 的所有给定构造函数...

```
Intent();
Intent(Intent );
Intent(String );
Intent(Context, Class<?>); //The one I always use
Intent(String, Uri );
Intent(String, Uri, Context, Class<?> ); 
```

...不会工作。因为我在 FileObserver 的扩展中工作，所以没有可以接受的上下文来提供 Intent。无论如何我可以只使用字符串之一来启动 IntentService 吗？我不需要它返回任何东西，我只需要给它一些字符串就可以让它工作（文件名等）或者有另一种方法可以启动 IntentService。这个真的让我难住了。

感谢您在高级方面的任何帮助！

编辑：好的。我尝试了很多情况，但都没有看到工作。意图服务不会被应用程序或来自服务类的基本上下文触发，这些服务类在调用它们时通过构造函数传递。这是我的应用程序的基本布局：

Login Activity 转到 Menu Activity，Menu Activity 启动 Service，Service 启动 Service Handler（请参阅 android 文档中的服务示例以了解它是什么）并通过构造函数传递上下文。Service Handler 启动 FileSync 并通过构造函数传递上下文。FileSync 将上下文保存在类变量中。FileSync 然后等待文件被修改，然后使用上下文启动 IntentService 以上传通过 Intent 请求的文件。我知道这真的很复杂，但这确实是我目前唯一能做到的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:42:26.510

> Because I'm working in an extension of FileObserver, there is no acceptable context from which I can feed the Intent.

This `FileObserver` cannot exist in a vacuum. It needs to be managed by an activity or service, and that will give you your `Context`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T22:38:58.613

您可以通过覆盖应用程序来创建应用程序的静态字段。在 oncreate

```
sInstance = this; 
```

采用

```
MyApplication.sInstance.startActivity(intent); 
```

Edit: On second thought you could use PendingIntent if all you need to do is start a service without passing any information from FileObservver, you can create a [PendingIntent](http://developer.android.com/reference/android/app/PendingIntent.html) and set it at the time of creation of FileObserver and use

[`pendingintent.send()`](http://developer.android.com/reference/android/app/PendingIntent.html#send%28int%29)

# android - 如何修复由于 GPU 节流而导致的 Android 渲染性能不稳定？我不需要高帧率，只要一个一致的

> ID：11996409
> 
> 赞同：2
> 
> 时间：2012-08-16T22:35:27.120
> 
> 标签：android, opengl-es

我正在开发一个 GL 动态壁纸，它使用很少的 CPU 和只有适度的 GPU。在我的旧测试手机上，它大部分时间都可以以 58fps 左右的速度运行。但偶尔效果会上升，然后渲染时间会在每帧 16 毫秒到 50 毫秒之间抖动。例如，它会在 16 毫秒时渲染几帧，在十几帧左右滑动到 50 毫秒，在 50 毫秒时再渲染几帧，然后再向下滑动到 16 毫秒并重复。我发现，如果我将 CPU 调控器设置为“性能”（或“保守”，奇怪的是）而不是默认的“按需”，它将以全速呈现完整效果。或者，如果我不理会调速器并在我的代码中插入一个繁忙的循环（增加一个变量 100，

因此，在这款手机上，我的应用程序似乎受到 GPU 的限制，但只有当它减速时。现在，我不介意 GLSurfaceView 是否根据 GPU 时钟以较慢的速度呈现，但我的问题是我得到了交替的高帧率和低帧率的爆发，这使我的动画看起来流畅/frameskippy/fluid /frameskippy/等。每秒几次。似乎 GPU 时钟像疯了一样上下起伏？

通过使用 RENDERMODE_WHEN_DIRTY 并在严格定时的线程上调用 requestRender()，我得到了明显的改进，但是该死的 GPU 不断上升和下降。为什么它不能在较慢的时钟下尽可能快地渲染，或者只是跳到并停留在较高的时钟上？

到目前为止，我提出的最佳解决方案是使用滑动窗口来检测平均帧更新时间，然后应用与目标帧时间的差异，直到两个值收敛。渲染更新之间的时间较慢，但至少大致保持不变。所以这在理论上可行，但需要几秒钟才能达到稳定状态，同时看起来很糟糕。

我认为第三种选择可能是蚕食 GLSurfaceView 源并制作自定义版本。据我了解，阻塞的 GL 调用是在那里进行的，所以我更容易计时渲染调用并做出相应的反应。不过，我不太愿意尝试这样做，因为那里有很多代码，我必须花很多时间理解才能开始弄乱它。另外，我不得不担心 X 版 GLSurfaceView 与任何 Y 版 Android 的播放效果如何。

那么，说了这么多，我在这里还有其他选择吗？有没有更简单的解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T02:31:32.767

尝试通过在剩余时间内暂停线程（线程睡眠）以达到恒定帧速率来固定帧速率。

# objective-c - initWithContentsOfURL 是什么编码？

> ID：11996410
> 
> 赞同：0
> 
> 时间：2012-08-16T22:35:28.993
> 
> 标签：objective-c, xcode, nsurl, nsfilemanager, initwithcontentsofurl

嗨，我保存了一个 URL，该 URL 具有指向我将存储信息的目录的路径，现在我想检索信息但我不知道如何接收项目，我正在尝试使用 initWithContentsOfURL 但我不知道是什么编码会是什么？

这就是我保存 URL 的方式

```
//DirectoryPaths has the NSCAcheDirectory
 dirPath = [[directoryPaths objectAtIndex:0] URLByAppendingPathComponent:[NSString stringWithFormat:@"photos.jpg"]]; 
```

我现在如何获取 URL 的路径？我试过了

```
 NSString *pathToFile = [[NSString alloc] initWithContentsOfURL:dirPath
                                                 usedEncoding:nil
                                                        error:&error]; 
```

我不知道编码是什么，因为我没有使用一个来存储文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:48:41.097

我想你误解了；`initWithContentsOfURL:usedEncoding:error:`从 URL 加载字符串。因此，您需要指定用于字符串的编码——UTF-8、ASCII 或类似的东西。

要从您可能想要的 URL 获取磁盘路径`[dirPath path]`。实际上，您可能只从 URL 加载而不是硬编码本地磁盘行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:53:07.880

使用 NSUTF8StringEncoding 或 ASCII。这个对我有用。:)

# jquery - jquery - 如何在颜色框中加载谷歌方向小部件？

> ID：11996412
> 
> 赞同：0
> 
> 时间：2012-08-16T22:35:33.303
> 
> 标签：jquery, google-maps, colorbox

我在我的页面上加载了一个谷歌方向小部件，其中包含以下代码：

```
<div class="directions">
  <script src="http://www.gmodules.com/ig/ifr?url=http://hosting.gmodules.com/ig/gadgets/file/114281111391296844949/driving-directions.xml&amp;up_fromLocation=&amp;up_myLocations=<%= @meeting.location.address %>&amp;up_defaultDirectionsType=&amp;up_autoExpand=&amp;synd=open&amp;w=320&amp;h=55&amp;title=Directions+by+Google+Maps&amp;lang=en&amp;country=US&amp;border=%23ffffff%7C3px%2C1px+solid+%23999999&amp;output=js"></script>
</div> 
```

以上工作并且看起来很棒。我不想让上面的内容出现在页面上，而是希望在用户单击名为方向的链接时将其加载到颜色框中。问题是：我怎样才能让上面的内容在颜色框中打开？执行以下操作不起作用：

```
$.colorbox({href:"<the http link from above>"}); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:43:26.453

尝试这个：

```
$('.directions').click(function(){
    var src = $(this).find('script').attr('src');
    $.colorbox({ href: src });   
}) 
```

# django - 我需要优化 django 模板中的数据库访问吗？

> ID：11996415
> 
> 赞同：3
> 
> 时间：2012-08-16T22:35:59.953
> 
> 标签：django, django-templates, django-views

假设我有 3 个模型：

```
class Franchises
    name = models.CharField()

class Stores
    franchise = models.ForeignKey(Franchises)
    name = models.CharField()

class Items
    store = models.ForeignKey(Stores)
    name = models.CharField() 
```

# 在视野中

```
items = Items.objects.all() 
```

# 在模板中

```
{% for item in items %}
  <div>item.store.franchise.name</div>
{% endfor %} 
```

我想知道执行 item.store.franchise.name 是否会命中数据库？我需要做什么来优化数据库访问？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-16T22:38:11.613

django 中的查询是惰性的，这意味着它们会尝试尽可能少地解析，直到被访问。因此，现在您将访问数据库以获取`store`参考，然后再次访问`franchise`参考。这将适用于这些结果中的每个项目（许多查询）。

如果您知道您将需要这些关系，您可以告诉查询立即获取它们：

```
Items.objects.selected_related('store__franchise').all() 
```

Django 将提前进行连接，以确保每个结果都已为这些相关对象缓存。当您点击它们时，它不会触发更多查询。

有关 select_related 的更多信息在[这里](https://docs.djangoproject.com/en/dev/ref/models/querysets/#select-related)

一个非常酷的测试方法是启动 django shell `./manage.py shell`，然后查看发出的查询：

```
from django import db
from django.db import connection

db.reset_queries()

items = list(Items.objects.all())
print connection.queries

db.reset_queries()

items = list(Items.objects.selected_related('store__franchise').all())
print connection.queries 
```

# c# - 电子邮件消息文件扩展名

> ID：11996420
> 
> 赞同：1
> 
> 时间：2012-08-16T22:36:48.750
> 
> 标签：c#, asp.net, email, upload

我有一个 Web 应用程序，用户在其中上传电子邮件，然后管理员登录到管理视图查看电子邮件。我们正在使用 IIS7 和 ASP.NET 3.5SP1。我将 .msg 文件设置为在 Outlook 中打开，但今天遇到了另一种文件类型：olk14Message。有没有人有一个很好的电子邮件文件扩展名列表，我可以为其设置 mimetypes？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:56:53.203

我知道的唯一扩展名是 .EML。.MSG 不太可能是电子邮件，AFAIK。例如，它用于本地 Windows 消息信息。我很确定每个电子邮件程序都不同。olk14Message 是 Outlook 在 Mac 上为其数据选择扩展程序的示例。

# javascript - 如何仅通过 Javascript 更改类伪元素的 CSS 背景图像？

> ID：11996421
> 
> 赞同：1
> 
> 时间：2012-08-16T22:37:01.970
> 
> 标签：javascript, css, background, pseudo-element

我对此无能为力。我有一个元素，它使用 :before 伪选择器。

CSS是这样的：

```
 .initHandler:before { 
      width: 100%; 
      position: absolute; 
      top: 0; 
      bottom: 0; 
      left: 0; 
      right: 0; 
      display: block; 
      height: 110%; 
      z-index: 999999;  
      background-color: white; /*background:white  url(../images/ajax-loader.gif) no-repeat center center;*/    
      content: "initializing..."; 
      text-align: center; 
      font-color: #ccc; 
      line-height: 150px; 
      vertical-align: bottom; 
      } 
```

这为我的应用程序提供了一个白色背景，该应用程序正在“幕后”加载。在 iOS 上，我使用的是启动图像，我在页面头中设置`before`jquery 和 jquerymobile 已加载。

我现在想将`initHaendler:before`元素的背景更改为确定的 iOS 初始屏幕。

但是我需要在纯 javascript 中这样做，我不知道如何选择一个类/伪元素来设置一个 css 值。

有人可以帮忙吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:39:28.567

[从 JavaScript 设置 CSS 伪类规则](https://stackoverflow.com/questions/311052/setting-css-pseudo-class-rules-from-javascript)似乎表明您不能这样做，并通过将样式表附加到文档来提供一种解决方法。我不确定它是否可以在 iOS 上运行，但值得一试

# ruby-on-rails - 零时 Rspec 控制器测试失败

> ID：11996429
> 
> 赞同：0
> 
> 时间：2012-08-16T22:38:37.730
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec

导轨 3.2.6

我已经按照本文的建议设置了一个联系人控制器和表单：http: [//matharvard.ca/posts/2011/aug/22/contact-form-in-rails-3/](http://matharvard.ca/posts/2011/aug/22/contact-form-in-rails-3/)

我的`Message`模型课：

```
class Message
  include ActiveModel::Validations
  include ActiveModel::Conversion
  extend ActiveModel::Naming

  attr_accessor :name, :email, :message_body

  # validations are here...

  def initialize(attributes = {})
      attributes.each do |name, value|
      send("#{name}=", value)
      end
  end

  def persisted?
      false
  end
end 
```

`Contact Controller`：_

```
def create
    @message = Message.new(params[:message])

    if @message.valid?
        ContactMailer.new_message(@message).deliver
        redirect_to(root_path, :notice => "Message was successfully sent.")
    else
        render :new
    end
end 
```

我的 rspec 控制器测试：

```
describe "POST create" do
    context "with valid information" do
      let (:message) { FactoryGirl.build(:message) }
      it "creates a new message" do
        post :create, params: message
        assigns(:message).should eq(message)
    end
  end
end 
```

我已经验证了`message`变量 via`let`不是 nil，所以 FactoryGirl 正在做它的工作。

测试结果：

```
ContactController POST create with valid information creates a new message
 Failure/Error: post :create, params: message
 NoMethodError:
   undefined method `each' for nil:NilClass
 # ./app/models/message.rb:14:in `initialize'
 # ./app/controllers/contact_controller.rb:8:in `new'
 # ./app/controllers/contact_controller.rb:8:in `create'
 # ./spec/controllers/contact_controller_spec.rb:22:in `block (4 levels) in <top (required)>' 
```

我知道它失败是因为`Message`'`initialize`方法。但我现在确定它为什么初始化 nil。当我在开发环境中测试表单时，它似乎工作正常。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:36:04.177

我认为您应该使用明确的名称传递消息，如下所示：

```
it "creates a new message" do
    post :create, :message => message
    assigns(:message).should eq(message)
end 
```

或短样式：

```
post :create, message: message 
```

那么你将`'message'`在 params hash 中有一个键

```
params[:message] = ... # here's your message 
```

否则你将没有钥匙，`params`因此`params[:message]`回报为零

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T20:14:09.717

我必须将哈希值作为值传递给`post`'s hash 选项。像这样：

```
message_attributes = FactoryGirl.attributes_for(:message)
post :create, message: message_attributes 
```

为了比较测试中的两条消息，我不得不`Message`像这样修改模型：

```
attr_accessor :attributes, :name, :email, :message_body
def initialize(attributes = {})
    if not attributes.nil?
        attributes.each do |name, value|
            send("#{name}=", value)
        end
    end
    @attributes = attributes
end 
```

所以最终的通过测试看起来像这样：

```
it "creates a new message" do
    message_attributes = FactoryGirl.attributes_for(:message)
    post :create, message: message_attributes
    assigns(:message).attributes.symbolize_keys.should eq(message_attributes)
end 
```

我不确定这是否是最好的解决方案，但它确实创建了一个通过测试并验证控制器是否正确创建了一条消息。

# c# - 检查 URL 是否是有效的 Feed

> ID：11996430
> 
> 赞同：6
> 
> 时间：2012-08-16T22:38:42.143
> 
> 标签：c#, feed, argotic

我正在使用 Argotic Syndication Framework 来处理提要。

但问题是，如果我将 URL 传递给 Argotic，它不是有效的提要（例如，`http://stackoverflow.com`这是一个 html 页面，而不是提要），程序就会挂起（我的意思是，Argotic 停留在无限循环中）

那么，如何检查一个 URL 是否指向一个有效的提要呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-16T22:46:28.167

在 .NET 3.5 中，您可以在下面执行此操作。如果它不是有效的提要，它将引发异常。

```
using System.Diagnostics;
using System.ServiceModel.Syndication;
using System.Xml;

public bool TryParseFeed(string url)
{
    try
    {
        SyndicationFeed feed = SyndicationFeed.Load(XmlReader.Create(url));

        foreach (SyndicationItem item in feed.Items)
        {
            Debug.Print(item.Title.Text);
        }
        return true;
    }
    catch (Exception)
    {
        return false;
    }
} 
```

或者您可以尝试自己解析文档：

```
string xml = "<?xml version=\"1.0\" encoding=\"utf-8\" ?>\n<event>This is a Test</event>";
XmlDocument xmlDoc = new XmlDocument();
xmlDoc.LoadXml(xml); 
```

然后尝试检查根元素。它应该是 feed 元素并具有“ [http://www.w3.org/2005/Atom](http://www.w3.org/2005/Atom) ”命名空间：

```
<feed xmlns="http://www.w3.org/2005/Atom" xmlns:creativeCommons="http://backend.userland.com/creativeCommonsRssModule" xmlns:re="http://purl.org/atompub/rank/1.0"> 
```

参考资料：http: [//msdn.microsoft.com/en-us/library/system.servicemodel.syndication.syndicationfeed.aspx](http://msdn.microsoft.com/en-us/library/system.servicemodel.syndication.syndicationfeed.aspx) [http://dotnet.dzone.com/articles/systemservicemodelsyndication](http://dotnet.dzone.com/articles/systemservicemodelsyndication)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T23:01:50.100

您可以使用[Feed Validation Service](http://validator.w3.org/feed/)。它有[SOAP API](http://validator.w3.org/feed/docs/soap.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T22:49:03.780

您可以检查内容类型。它必须是`text/xml`。请参阅[此问题](https://stackoverflow.com/questions/11945201/how-to-get-content-type-of-a-web-address)以查找内容类型。

您可以使用以下代码：

```
var request = HttpWebRequest.Create("http://www.google.com") as HttpWebRequest;
if (request != null)
{
    var response = request.GetResponse() as HttpWebResponse;

    string contentType = "";

    if (response != null)
        contentType = response.ContentType;
} 
```

*感谢问题的[回答](https://stackoverflow.com/questions/11945201/how-to-get-content-type-of-a-web-address)*

**更新**

要检查它是否是提要地址，您可以使用[W3C 提要验证](http://validator.w3.org/appc/)服务。

**更新2**

正如 BurundukXP 所说，它有一个 SOAP API。要使用它，您可以阅读[此问题](https://stackoverflow.com/questions/2715914/how-to-use-soap-in-asp-net-mvc)的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-06T12:49:54.553

如果您只想将其转换为有效的 RSS/ATOM，您可以使用[http://feedcleaner.nick.pro/](http://feedcleaner.nick.pro/)对其进行清理。或者，您可以[分叉项目](https://github.com/nickmoline/feedsanitizer)。

# php - Debian 服务器上的 OpenSSL 问题

> ID：11996435
> 
> 赞同：0
> 
> 时间：2012-08-16T22:39:14.833
> 
> 标签：php, openssl, debian

我一直在与这个烦人的问题作斗争很长一段时间，这让我很烦恼，我找不到任何解决办法。

当我对我的文件使用“tail -f”`error_log`来检查我的网络服务器上的错误时，一个特定的错误一直在弹出，每个访问者和页面刷新都会产生这个问题。

我已经在 Stack Overflow 上搜索和搜索了很长时间，但没有任何东西与问题直接相关。

所以抛出的错误如下所示：

> [2012 年 8 月 17 日星期五 00:16:23] [错误] [客户端 xx.xx.xx.xx] PHP 警告：PHP 启动：无法加载动态库 '/usr/lib/php5/20090626/openssl.dll' - /usr/lib/php5/20090626/openssl.dll：无法打开共享对象文件：第 0 行的 Unknown 中没有此类文件或目录，引用者：http: [//mysite.dk/](http://mysite.dk/)

我能做什么？

我试图删除 OpenSSL，然后再次重新安装它，但没有成功。我已经尝试升级每个与 PHP 相关的软件包，但仍然无法正常工作。

```
grep -ir ssl /etc/php* 
```

给出：

```
/etc/php5/cli/conf.d/zend_extensions_psa.ini:extension=openssl.dll
/etc/php5/apache2/conf.d/zend_extensions_psa.ini:extension=openssl.dll
/etc/php5/apache2/php.ini.saved_by_psa.08.03;20:24:;extension=openssl.dll       ; moved to conf.d/zend_extensions_psa.ini by Plesk
/etc/php5/apache2/php.ini:;extension=openssl.dll        ; moved to conf.d/zend_extensions_psa.ini by Plesk
/etc/php5/conf.d/zend_extensions_psa.ini:extension=openssl.dll
/etc/php5/cgi/conf.d/zend_extensions_psa.ini:extension=openssl.dll 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:12:12.913

因此，您有四个副本，`zend_extensions_psa.ini`并且所有副本都在尝试加载这个不存在的文件。全部编辑，删除或注释掉提到的行`openssl.dll`，一切都应该很好。

Debian 软件包管理系统非常尊重您对配置文件的修改。当您升级或重新安装软件包时，它不会撤消它们，除非您删除该软件包`dpkg --purge`或使用`--force-confnew`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T12:35:35.020

可能是你的 PHP 配置中有这样的东西（`php.ini`也许）：

```
extension_dir=/usr/lib/php5/20090626/ 
```

接着

```
extension=openssl.dll 
```

它可能会导致问题，因为在给定的路径中没有这样的文件。这可能是由手动复制扩展和/或不同的扩展安装程序引起的。

# easymock - EasyMock：andReturn 能否给出运行时错误？

> ID：11996443
> 
> 赞同：0
> 
> 时间：2012-08-16T22:39:36.387
> 
> 标签：easymock

我正在使用 EasyMock 来模拟一个名为“Tuple”的类。Tuple.getString(int i) 方法应该返回元组中位置 i 处的字符串。如果该字段不是字符串，它将给出运行时错误。

为了使 andReturn 正常工作，我必须将值转换为 String ，如下所示： `expect(tuple.getString(i)).andReturn((String) json.get(list[i])).atLeastOnce();` 这不是所需的行为。

例如，如果 json.get(list[i]) 是一个整数，我想给出一个运行时错误，而不是将其转换为 String。
有没有办法解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T16:20:11.507

所以我实际上不必强制转换它，因为 JSONObject 有一个 getString() 方法。我不知道为什么我没有早点想到这个。

# php - ucwords 函数有异常

> ID：11996446
> 
> 赞同：3
> 
> 时间：2012-08-16T22:39:40.100
> 
> 标签：php

我需要一些帮助我有这个代码，将字符串中每个单词的第一个字符大写，但如果异常位于字符串的开头，我需要该函数忽略异常：

```
function ucwordss($str, $exceptions) {
$out = "";
foreach (explode(" ", $str) as $word) {
$out .= (!in_array($word, $exceptions)) ? strtoupper($word{0}) . substr($word, 1) . " " : $word . " ";
}
return rtrim($out);
}

$string = "my cat is going to the vet";
$ignore = array("is", "to", "the");
echo ucwordss($string, $ignore);
// Prints: My Cat is Going to the Vet 
```

这就是我正在做的事情：

```
$string = "my cat is going to the vet";
$ignore = array("my", "is", "to", "the");
echo ucwordss($string, $ignore);
// Prints: my Cat is Going to the Vet
// NEED TO PRINT: My Cat is Going to the Vet 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T22:46:28.107

```
- return rtrim($out);
+ return ucfirst(rtrim($out)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-16T22:43:58.450

像这样的东西：

```
function ucwordss($str, $exceptions) {
    $out = "";
    foreach (explode(" ", $str) as $key => $word) {
        $out .= (!in_array($word, $exceptions) || $key == 0) ? strtoupper($word{0}) . substr($word, 1) . " " : $word . " ";
    }
    return rtrim($out);
} 
```

或者更简单，`return`在你的函数之前 make strtoupper 第一个字母

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T22:44:34.833

只需始终将您的第一个单词大写，就可以非常便宜地做到这一点：

```
function ucword($word){
    return strtoupper($word{0}) . substr($word, 1) . " ";
}

function ucwordss($str, $exceptions) {
    $out = "";
    $words = explode(" ", $str);
    $words[0] = ucword($words[0]);
    foreach ($words as $word) {
        $out .= (!in_array($word, $exceptions)) ? ucword($word)  : $word . " ";
    }
    return rtrim($out);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-16T22:56:17.120

你把字符串中的第一个字母变成大写怎么样，所以无论你的混音如何，你仍然会通过

```
$string = "my cat is going to the vet";
$string = ucfirst($string);
$ignore = array("is", "to", "the");
echo ucwordss($string, $ignore); 
```

这样你字符串的第一个字母总是大写

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-12-03T04:07:12.197

`preg_replace_callback()`将允许您以无循环和动态的方式表达您的条件替换逻辑。考虑这种可以适当修改您的样本数据的方法：

代码：（[PHP 演示](https://3v4l.org/kYKBb)）（[模式演示](https://regex101.com/r/e6wrJk/1)）

```
$string = "my cat is going to the vet";
$ignore = array("my", "is", "to", "the");
$pattern = "~^[a-z]+|\b(?|" . implode("|", $ignore) . ")\b(*SKIP)(*FAIL)|[a-z]+~";
echo "$pattern\n---\n";
echo preg_replace_callback($pattern, function($m) {return ucfirst($m[0]);}, $string); 
```

输出：

```
~^[a-z]+|\b(?|my|is|to|the)\b(*SKIP)(*FAIL)|[a-z]+~
---
My Cat is Going to the Vet 
```

你看，模式的三个管道部分（按顺序）提出了这些要求：

1.  如果字符串的开头是单词，则将第一个字母大写。
2.  如果在“黑名单”中找到“整个单词”（利用`\b`单词边界元字符），则取消匹配并继续遍历输入字符串。
3.  否则将每个单词的第一个字母大写。

现在，如果您想特别了解缩略词和连字词，那么您只需要像这样将`'`和添加`-`到`[a-z]`字符类中：（`[a-z'-]` Pattern [Demo](https://regex101.com/r/e6wrJk/2)）

如果有人有会破坏我的片段的边缘案例（例如带有特殊字符的“单词”需要通过 转义`preg_quote()`），您可以提供它们，我可以提供补丁，但我的原始解决方案将充分服务于发布的问题。

# authentication - 更改限幅器代码以绕过旧程序的身份验证

> ID：11996447
> 
> 赞同：0
> 
> 时间：2012-08-16T22:39:49.420
> 
> 标签：authentication, dos, clipper

嗨，我的一个朋友让我恢复 1994 年用 Clipper 编写的程序的密码。我给自己弄了一个反编译器（Valkyrie 5）并反编译了 EXE 文件。我找到了一个名为 USERLOGIN 的过程。问题是我不知道如何在 Clipper 中编程。如果有人可以编辑该程序，我将非常感激，这样它就不会再要求身份验证了。

```
#include "common.ch"
#include "inkey.ch"

********************************
Function USERLOGON

   Local Local1:= -1, Local2:= .F., Local3, Local4, Local5:= 3, ;
      Local6:= 3, Local7:= 7, Local8:= 41, Local9, Local10, Local11, ;
      Local12, Local13, Local14, Local15
   Local3:= 1
   Local9:= {}
   Local13:= setcursor()
   If (!netuse(diskname() + ":" + dirname() + "\" + "sinusr.dbf", ;
         "users"))
      Return Local1
   EndIf
   dbSetFilter({ || users->valid })
   Local14:= box(Local5, Local6, Local7, Local8, Nil, ;
      coltonum("GR+/B"))
   Do While (!Local2)
      Local10:= Space(12)
      Local11:= Space(10)
      setcursor(1)
      If (!Empty(n_shellver()))
         Local10:= padr(nnetwhoami(), 12)
      EndIf
      wininfo(Local14, @Local5, @Local6, @Local7, @Local8)
      @ Local5 + 1, Local6 + 5 Say "User............." Color "GR+/B"
      SetPos(Row(), Col() + 1)
      AAdd(Local9, __Get({ |_1| IIf(ISNIL(_1), Local10, Local10:= ;
         _1) }, "cUName", "@K!", Nil, Nil):display())
      @ Local5 + 2, Local6 + 5 Say "Password........." Color "GR+/B"
      SetPos(Row(), Col() + 1)
      AAdd(Local9, __Get({ |_1| IIf(ISNIL(_1), Local11, Local11:= ;
         _1) }, "cUPass", "@K!", Nil, Nil):display())
      Local9[2]:reader({ |_1| gt_grpassw(_1) })
      wreadmodal(Local9, 0)
      Local11:= Local9[2]:cargo()
      Local9:= {}
      If (LastKey() == K_ESC .OR. !winisinuse(Local14))
         If (winisinuse(Local14))
            winclose(Local14)
         EndIf
         Return Local1
      EndIf
      Local10:= alltrim(Local10)
      Local12:= {}
      Locate For Local10 == alltrim(users->emri)
      Do While (Found())
         AAdd(Local12, users->id)
         Continue
      EndDo
      For Local4:= 1 To Len(Local12)
         If ((Local15:= upass(Local12[Local4])) != Nil)
            If (alltrim(Local11) == Local15)
               Local2:= .T.
               Exit
            EndIf
         EndIf
      Next
   EndDo
   If (users->id != Local12[Local4])
      users->(dbGoTop())
      Locate For Local12[Local4] == users->id
      If (!Found())
         msg("Fatal error in user's file !", 3)
         Return -1
      EndIf
   EndIf
   For Local4:= 1 To MaxCol()
      winchgpos(0, 3)
   Next
   boxc(Local14)
   setcursor(Local13)
   If (users->in)
      tone(500, 10)
      Local4:= al_box("User " + Trim(users->emri) + ;
         " is already IN;" + "Do You Want to Jump In ?", 2, ;
         {" Yes ", " No  "}, 2, "WARNING")
      If (Local4 == 1)
         msg("More than One User with the same Name might cause Trouble !", ;
            3)
      Else
         Close
         Return -1
      EndIf
   ElseIf (netrlock())
      Replace users->in With .T.
      Unlock
      dbcommit()
   Else
      Close
      Return -1
   EndIf
   Static148[1]:= users->id
   Static148[2]:= alltrim(users->emri)
   Static148[3]:= alltrim(users->dirpriv)
   Static148[4]:= users->gjuha1
   Static148[5]:= users->gjuha2
   Static148[6]:= alltrim(users->emriiplote)
   Local1:= Static148[1]
   Close
   Return Local1

* EOF 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-23T22:34:57.290

这部分是猜测，但这是我的解释：

将用户密码从控制台读入`Local9[2]`：

```
@ Local5 + 2, Local6 + 5 Say "Password........." Color "GR+/B"
...
Local9[2]:reader({ |_1| gt_grpassw(_1) })
wreadmodal(Local9, 0) 
```

将密码放入`Local11`：

```
Local11:= Local9[2]:cargo() 
```

`Local12`通过以下方式获取所有用户 ID `Local10`：

```
Locate For Local10 == alltrim(users->emri)
Do While (Found())
    AAdd(Local12, users->id)
    Continue
EndDo 
```

将每个用户的密码输入到`Local15`中，如果密码存在*并且*与 中的密码匹配`Local11`，则验证用户：

```
For Local4:= 1 To Len(Local12)
    If ((Local15:= upass(Local12[Local4])) != Nil)
        If (alltrim(Local11) == Local15)
            Local2:= .T.
            Exit
        EndIf
    EndIf
Next 
```

**修复**

只需删除密码检查码。不确定所有其余代码的目的，我建议不要管它。我保留了用户密码的检索，因为也许有充分的理由不登录根本没有密码的用户（也许这就是帐户被禁用的方式。上面的最后一个块可以更改为：

```
For Local4:= 1 To Len(Local12)
    If ((Local15:= upass(Local12[Local4])) != Nil)
        Local2:= .T.
    EndIf
Next 
```

# javascript - 在 Javascript 中表示复杂/嵌套数据

> ID：11996448
> 
> 赞同：0
> 
> 时间：2012-08-16T22:39:53.720
> 
> 标签：javascript, ruby-on-rails, ajax, dictionary

我正在尝试通过 JSON 将稍微复杂的 Rails 应用程序发送到 JS 脚本，以某种有趣的方式呈现页面。假设 Rails 中的数据是关于人和他们的资产的，看起来像这样：

```
[
  {:name => 'Bill Smith', :state => 'KS'} => [
    {:type => 'house', :valuation => 150000},
    {:type => 'car', :valuation => 10000}
  ], 
  {:name => 'Bubba Jack', :state => 'FL'} => [
    {:type => 'boat', :valuation => 12000}
  ]
] 
```

在 JS 方面，我希望能够访问各个字段，但是，JS 不允许对象的键是对象，因此 data.to_json 将所有人员详细信息转换为一个字符串，如下所示：

```
[{"{:name=>\"Bill Smith\", :state=>\"KS\"}":[{"type":"house","valuation":150000},{"type":"car","valuation":10000}],"{:name=>\"Bubba Jack\", :state=>\"FL\"}":[{"type":"boat","valuation":12000}]}] 
```

我不能做类似的事情

```
var people = Object.keys(data);
for(var i=0; i<people.length; i++) {
    var totAsset = 0;
    var person = people[i];
    for(var j=0;j<data[person].length; j++) {
        totAssset = totAsset + data[person][j].valuation
    }
    alert("got person named " +person.name+" having $"+totAsset);
} 
```

在 AJAX 应用程序的 JS 端表示和使用复杂数据的“正确”方式是什么？

**更新：**所以 sgrif 和 A​​ndrew 的答案都为这个特定问题提供了解决方案。我已经对他们两个都投了赞成票，但我会等待一些，看看是否有一个更普遍的想法，有人必须在接受之前将对象表示为键或具有该功能的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:49:19.303

```
[
  {name: "Bill Smith", state: "KS", possessions: [
    {type: "house", valuation: 1500000},
    {type: "car", valuation: 10000}
  ]},
  etc...
] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T22:59:13.750

这样组织您的记录会不会更容易：

```
@people = [
    {:name => 'Bill Smith', :state => 'KS', :assets => [
        {:type => 'house', :valuation => 150000},
        {:type => 'car', :valuation => 10000}
    ]}, 
    {:name => 'Bubba Jack', :state => 'FL', :assets => [
        {:type => 'boat', :valuation => 12000}
    ]}
] 
```

然后使用“render :json => @people”，它会给你。

```
{[ "name": 'Bill Smith', "state": 'KS', "assets": [
    {"type": 'house', "valuation": 150000},
    {"type": 'car', "valuation": 10000},
],
[ "name": 'Bubba Jack', "state": 'FL', "assets": [
    {"type": 'boat', "valuation": 12000}
]} 
```

然后访问这些值。

```
'Bill Smith' = people[0]["name"]
'house'      = people[0]["assets"][0]["type"] 
```

# html - W3C 验证：奇怪的 HTML 5 错误

> ID：11996451
> 
> 赞同：0
> 
> 时间：2012-08-16T22:40:10.270
> 
> 标签：html, tags, w3c, validation

验证以下 HTML5 代码时出现以下错误：

```
<article>
 <header>
  <num>1</num>
  <hgroup>
   <h2><a href="#">Title with link</a></h2>
   <address>Teststreet 11</address>
  </hgroup>
 </header>
 <footer>
 <ul>
  <li><a href="#">&raquo; Mehr</a></li>
 </ul>
 </footer>
</article> 
```

错误：

*   在此上下文中，不允许元素编号作为元素标头的子元素。
*   在此上下文中，元素地址不允许作为元素 hgroup 的子元素。
*   在此上下文中，不允许元素评级作为元素 hgroup 的子元素。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T22:59:55.203

我不知道有一个标签叫做`num`

hgroup 应该只包含`h1,h2,h3,h4,h5,h6`

这些错误很容易解释

> 在此上下文中，元素地址不允许作为元素 hgroup 的子元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:19:41.033

我相信您想使用类型为编号的输入元素：

```
<form action="demo_form.asp">
  Quantity (between 1 and 5): <input type="number" name="quantity" min="1" max="5" />
  <input type="submit" />
</form> 
```

# javascript - 在网络浏览器中优先下载图像的技术

> ID：11996454
> 
> 赞同：6
> 
> 时间：2012-08-16T22:40:20.833
> 
> 标签：javascript, html, browser

我有一个包含许多缩略图（大约 100 个）的网页。当您单击其中一个缩略图时，会创建一个模式弹出窗口，这实际上是 iframe 中的一个新网页。这个新网页包含 1 张大图。

当用户在父页面上的所有 100 多个缩略图完成下载之前打开弹出窗口时会出现此问题。用户现在必须等待很长时间才能在弹出窗口中看到大图像，因为浏览器不知道将这个新图像优先于它已经尝试检索的缩略图。

关于解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T22:54:08.327

当您加载该页面时，浏览器会为这些缩略图排队 100 个请求。我不知道从请求队列中删除项目。根据浏览器的不同，它可能同时请求最多 6 个（参考[这个线程](https://stackoverflow.com/questions/561046/how-many-concurrent-ajax-xmlhttprequest-requests-are-allowed-in-popular-browse)），但它们仍然会在模态对话框的大图像之前排队。您可以（从同一个线程）将模态对话框图像托管在单独的子域上，以便浏览器将它们放入单独的队列中，就好像它们位于完全不同的站点上一样。该新队列将被允许与您的缩略图请求同时运行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T22:56:59.487

您可以对所有小图像使用 BASE64 数据 URI。您的页面可以变得更大，但在某些安装中 - 整个页面加载变得更快。

另一个选项 - 从其他子域加载大图像，因为“队列”是主机名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T22:52:27.267

有趣的问题。我从来没有遇到过这样的情况。想到的一种解决方法是仅在用户查看缩略图时才加载它们。

如果你使用 jQuery，你可以尝试使用这个插件：

[用于 jQuery 的延迟加载插件](http://www.appelsiini.net/projects/lazyload)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-16T22:56:41.510

解决此问题的一种方法是将您的小缩略图组合成一个大的平铺图像，从而减少页面上的图像数量。

# facebook-javascript-sdk - Like Box - Blogger 错误

> ID：11996456
> 
> 赞同：1
> 
> 时间：2012-08-16T22:40:40.990
> 
> 标签：facebook-javascript-sdk, blogger, facebook-likebox

我正在尝试将 facebook Like Box 放到我的博客中，但是在我放入 Javascript SDK 之后（在打开正文之后它显示错误**

> 对实体“appId”的引用必须以“;”结尾 分隔符。

** 我无法修复它... :( 我需要做什么/编辑？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-23T19:02:23.750

100% full proof,simple solution to all such issues

Step 1 . Go to [http://htmlentities.net/](http://htmlentities.net/)

Step 2 Paste your code

Step 3 Click on encode

...................

Copy paste the new code in your template

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-04T05:26:23.060

我遇到了同样的问题： fbml=1 appId 我刚刚删除 & 并将关闭脚本放在 Load SDK 行之后。我用调试器检查了它，现在没有错误。

我不是要求其他权限，只是“喜欢我的页面”。

{编辑。不得不更改为结束脚本，因为括号和脚本没有显示。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-23T18:46:17.653

是的，将 &appId 更改为 &appId 就可以了。

# javascript - 对象中的 for 循环与数组中的循环

> ID：11996462
> 
> 赞同：-1
> 
> 时间：2012-08-16T22:41:27.217
> 
> 标签：javascript

> **可能重复：**
> [JavaScript for...in vs for](https://stackoverflow.com/questions/242841/javascript-for-in-vs-for)
> [for..in 和 for 循环之间的区别，以及计数器声明](https://stackoverflow.com/questions/7949504/difference-between-for-in-and-for-loops-and-counter-declaration)

是否有任何特殊原因应该像数组中的 for 循环那样编码，`for (var i = 0; i < foo.length; i++) {`而对象中的循环只是`for (var i in foo) {`因为对象的设置方式与数组的设置方式？（我知道数组是一种对象顺便说一句）或者只是另一个挑剔的编程约定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:59:53.860

**迭代列表**时应该使用`for(i=0; i<n; i++)`循环，因为它们可以**按整数索引**。

 ****```
arr = [1,2,3,4]; // arr[0] == 1; arr[1] == 2;
for(var i=0; i<arr.length; i++) { alert(arr[i]; } // 1, 2, 3, 4 
```

`for...in`迭代**对象**时应该使用循环，因为它可以**按键索引**。如果您将对象视为**键：值映射**。请记住检查对象**是否具有与每个 key 匹配的自己的属性**，因为该`in`语句将检查对象的**proptotype 链**并返回从上面继承的属性名称。

```
obj = { 
  foo: 1,
  bar: 2
}
for(key in obj) {
  if(obj.hasOwnProperty(key)) {
    alert(key);       // foo, bar
    alert(obj[key]);  // 1, 2
  }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-16T22:49:07.050

嗯，主要原因是因为`for...in`只迭代定义的成员。

所以，

```
var arr = [];
arr[10] = "hi";
for(var x in arr)
{
    alert(x);
} 
```

只会显示定义的一个*值*。有时这是一件好事——通常不是。

此外，`for...in`循环遍历属性，而不是数组索引（在 javascript 中，数组只是一个具有属性的常规对象，其名称是您分配给数组的值）

因此，当您使用 for..in 时，您会得到奇怪的结果，例如：

1

2

3

长度

等等

使用典型`for`语法只是数组的更好选择。对于对象，这`for...in`更有意义，因为未定义的问题不会经常出现。不过，无论哪种方式，我都喜欢使用`for(var x; x < y; x++)`语法。只是感觉在js中更好。****

# c# - 模型应该如何在 MVVM 中实现？

> ID：11996464
> 
> 赞同：0
> 
> 时间：2012-08-16T22:41:30.427
> 
> 标签：c#, .net, mvvm

我正在创建一个与一个或多个服务通信的简单网络应用程序，因此我计划使用一些队列（用于传出消息和传入消息）、一个表、一个包含每个活动连接状态的列表等：在其他换句话说，这些是确保应用程序本身运行所需的数据结构。

此应用程序还必须配备图形界面，显示应用程序本身的部分内部功能：例如，队列的填充状态、连接的状态（检测到的速度等）等。根据Model-View-ViewModel 模式，模型由要在 GUI 中显示的数据组成：在此应用程序中，上述数据结构表示模型。换句话说，*Model*实现了应用程序的业务逻辑。

*ViewModel*应该实现`INotifyPropertyChanged`接口以便通知*View*发生了变化，但是 Model 如何与 ViewModel 通信呢？看完[这篇文章](http://www.codeproject.com/Articles/36545/WPF-MVVM-Model-View-View-Model-Simplified)，我意识到`INotifyPropertyChanged`接口是由模型实现的。[这个答案](https://stackoverflow.com/questions/4453352/what-goes-in-model-in-mvvm/4453396#4453396)解释了一点，但它让我有点困惑：

> *INotifyPropertyChanged - 应该进入 ViewModel 和 Model（如果需要）*

为什么，*如果需要*？我应该什么时候实现这个接口？我什么时候不应该实施它？

此外，[`Dictionary`](http://msdn.microsoft.com/it-it/library/xfhwa508%28v=vs.100%29.aspx)没有实现`INotifyPropertyChanged`接口：如果我使用它，我应该用实现这个接口的类来包装它吗？

最后，模型应该是只读的，这意味着用户不能使用 GUI 更改内部数据结构的内容。如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:48:11.050

`how does the Model to communicate with the ViewModel`

任何你想要的方式。在我们编写的大多数应用程序中，视图模型都会调用业务逻辑层（模型）。但是，如果您需要在模型更改时立即通知视图模型（事件），您可以在模型上实现 INotifyPropertyChanged。或者您可以简单地让视图模型订阅模型上的事件。

`Moreover, the Dictionary does not implement the INotifyPropertyChanged interface: if I use it, should I wrap it with a class which implements this interface?`

您只需要让视图模型实现 INotifyPropertyChanged。视图模型（字典）中的属性将简单地调用 NotifyPropertyChanged（或任何您的实现看起来像）。

`Finally, the model should be read-only, meaning that the user does not be able to change the contents of internal data structures using the GUI. How to accomplish this?`

不要向用户提供让他们更改数据的功能。以一种方式进行绑定，或者干脆不为他们提供进行更改的 API。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:41:36.987

1.  INotifyPropertyChanged 主要由 ViewModel 类实现。这是为了方便数据绑定，以便视图中绑定到 ViewModel 属性的 UI 控件将在属性被修改时更新。
    在 MVVM 设计模式中，关系非常简单并且是单一方向的。View 知道它是 ViewModel，而 ViewModel 知道 Model。如果模型更新了，视图模型需要以某种方式知道，以便它可以反映更新并将其传播到视图。一种方法是让 Model 实现 INotifyPropertyChanged 并让 ViewModel 实现相应的事件处理程序。如果所有更改都是从 UI 驱动并被推送回模型，那么这可能没有必要。

2.  你不能真正绑定到字典。如果这适用于您的情况，则使用 ObservableCollection 将是理想的。或者，您可以按照以下方式查看实施 Observable Dictionary：http: [//drwpf.com/blog/2007/09/16/can-i-bind-my-itemscontrol-to-a-dictionary/](http://drwpf.com/blog/2007/09/16/can-i-bind-my-itemscontrol-to-a-dictionary/)

3.  MVVM 提供了 Model 与 View 的分离，因此 View 与 Model 之间应该没有直接关系。ViewModel 的实现控制着什么，如果有任何东西会被写回你的模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T00:35:53.993

`INotifyPropertyChanged`(INPC)*永远*不应出现在模型中，除非模型也是 ViewModel（即您没有“模型”）。INPC 应该只在视图模型中。

模型应该对视图模型一无所知，因此*永远无法*与之通信。只有视图模型可以与模型通信。

从 UI 的角度来看，只有视图模型对数据做任何事情；所以，如果你希望模型是“只读的”，那么就不要在视图模型中实现它。

绑定将使用视图模型完成，在这种情况下不要使用 Dictionary（除非您想编写代码来包装它以便绑定它）。如果 Dictionary 在模型中，那么您应该在视图模型中“包装”它——围绕集合编写一个可观察的包装器是相当简单的。您的视图模型很可能不会处理键/值对——它应该处理 UI 可以处理（并绑定到）的平面。

**更新**：
为数据绑定引入了 INPC。它将视图与特定的具体类解耦，因此它只需要了解 INPC（注意解耦的方向）。就 MVVM 而言，这将视图与视图模型解耦，在 PM 的情况下，这可以将视图与演示者解耦，在 MVC 的情况下，这可以将视图与控制器解耦，在 MVP 的情况下，这可以解耦来自主持人的看法。

数据绑定是一种将数据绑定到 UI 元素的技术。*它将数据源*绑定到*目标*，以便目标可以请求数据，无论它认为合适，或者源可以推送数据，但它认为合适（取决于绑定的*类型*——它可以是单向或静态的，限制如何经常会发生获取/推送）。

有时，数据源和目标之间解耦关系的必要性质导致人们相信数据绑定不是 UI 问题，数据绑定可以应用于任何地方。即数据绑定实现与 UI 完全分离。这通常是一个错误。数据绑定将视图与特定类的特定知识解耦（这是基本的分层和避免循环，我不会在这里讨论）。但是，它并没有将视图与数据源完全分离。没有数据源就无法进行绑定——那里仍然存在一定程度的耦合，只是已经减轻了编译时耦合（有助于测试、灵活性、健壮性等，但必须在*生产运行时存在*. 即，可以在运行时不绑定到 UI 元素的情况下测试 INPC 实现这一事实并不意味着它不依赖于 UI 框架）。视图仍然与数据源松散耦合的事实并不是这种关系中唯一的耦合。数据源通过其 UI 框架松散地（如果不是*更松散地*）耦合*到视图。*

每个 UI 框架都有一个限制，即 UI 元素的访问和修改必须在主线程或 UI 线程上完成。（至少在 Windows 上；它可能发生在其他平台上，我只是不精通其他平台）。使用数据绑定，源间接绑定到控件，任何数据更改都会直接更改一个或多个 UI 元素（取决于您可以拥有中介的框架。就像WinRT 中的*值转换器*，但它们的职责是转换或转换数据）。这意味着数据源需要深入了解它*绑定*到 UI 以及绑定到*什么类型*的 UI 框架。这种与 UI 框架的紧密耦合显然将数据源（仍然松散）耦合到 UI。

这意味着 INPC 的任何特定实现都真正绑定到一个且只有一个 UI 框架。该对象不能再在*任何地方*使用（显然*在任何地方*都是理想的，通常不可能使任何东西适用于每个场景——这里的重点是在不止一个或两个场景中的高内聚性）。例如，如果在多线程环境中使用 INPC 的实现，那么它需要在发送属性通知之前将数据“编组”回 UI 线程。在 WinForms 中，即 . `Control.BeginInvoke`，在 WPF 和 Silverlight 中，通过`System.Windows.Threading.Dispatcher`. 在 WinRT 中，这是通过`Windows.UI.CoreDispatcher`. 在所有情况下，INPC 实现都必须直接耦合到一个 UI 框架。在 Silverlight 的情况下，这是与“桌面”的直接耦合`Dispatcher`或 Windows Phone `Dispatcher`。

质量指标包括凝聚力等概念。内聚度是衡量两个代码单元相关程度的指标。由于支持特定 UI 框架所需的所有基础设施的性质，由 UI 以外的其他东西使用的 INPC 实现，虽然可能能够在 UI 之外使用，但内聚性较低，因为所有不会使用与 UI 框架相关的代码。即，与 UI 完全分离需要承担太多责任。是的，您*可以*在任何地方使用实现 INPC 的对象并且从不使用该`PropertyChanged`事件，但是您的凝聚力很低（被认为是不好的）。

如果我在我的模型中实现了 INPC，并且我想将该模型与我的 UI 和我的 WCF 或 Web 服务后端一起使用，我要么不能，要么我的后端将不得不参考一些 UI 框架。如果我想在另一种类型的 UI 中使用该模型，我不能，因为 INPC 实现依赖于一个特定的 UI 框架。我不得不写另一个“模型”；在这一点上，它显然是一个“视图模型”。

INPC 本身并不绑定到特定的 UI 框架（也不应该如此）。这导致了一种误解，即 INPC 可以在任何地方使用。 *是*的，它缺乏与高级命名空间的耦合意味着它*可以*，但是 INPC 的压倒性使用是当目标是 UI 时。我会挑战 INPC 的任何其他不涉及 UI 作为真正“绑定”的用途。与任何其他工具一样，您可以滥用它来获得有用的结果。INPC*可*用于投影数据，可用于转换数据等；但我相信这些是对 INPC 的滥用，并且确实超出了这个问题的重点......

# xml - SFString 或 MFString 类型的 X3D 字段的 XML 编码：一个困惑

> ID：11996465
> 
> 赞同：1
> 
> 时间：2012-08-16T22:41:32.067
> 
> 标签：xml, x3d

X3D 场景的 XML 编码在 ISO/IEC 19776-1.2:2009 中指定。X3D 字段由 XML 属性表示。SFString 和 MFString 的规则规定，表示 SFString 类型字段的属性*必须*用双引号括起来，例如 name="Alpha"; 并且表示 MFString 类型的字段*必须*用单引号括起来，组成字符串用双引号括起来，例如 names=' "Alpha" "Beta" '。

我正在编写一个程序，它将生成 X3D 场景的 XML 编码。我正在使用 Cocoa，它提供 XML 文档类型，并且可以将文档写出到文件中。我可以控制文件中的*所有*属性是用单引号还是双引号括起来；但是如果不复制大量 Cocoa 代码，我看不到如何获得更细粒度的控制。

这些规则似乎与 XML 中的处理方式不一致。它们实际上是否在 X3D 社区中强制执行？有没有可以提出这个问题的 X3D 论坛？我知道[http://www.web3d.org/message_boards/](http://www.web3d.org/message_boards/)，但我不确定它是否处于活动状态：自 2011 年 3 月以来似乎没有新消息发布在那里，好像每个人都去了其他地方。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T15:33:17.187

可悲的是，这一点对所有人都是免费的：一方面，您可以让自称最常用的查看器做任何想做的事情，而不管标准如何（例如，每个值都没有双引号），另一方面，遵循标准的其他查看者（每个值都用双引号引起来）。

因此，这取决于您定位的观众。

如果您想避免头痛，如果您可以选择的话，您可能希望坚持使用经典编码而不是 XML 编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-30T22:57:23.773

我实际上正在做与您非常相似的事情，遇到了这个问题，然后找到了这篇文章；

你只需要转义双引号；

IE

```
<NavigationInfo type="&quot;EXAMINE&quot;,Aquot;WALK&quot;"/> 
```

额外：刚刚注意到美国日期格式，8 月 16 日，我虽然是 2016 年，而不是 8 月 16 日，这比我想象的要老得多。

# php - 如何从 Smarty 中访问 Mysql 结果集？

> ID：11996466
> 
> 赞同：2
> 
> 时间：2012-08-16T22:41:32.113
> 
> 标签：php, mysql, smarty, smarty3

我的站点显示一组 div，每个 div 代表一个包含五种不同类型内容的集合。每个 div 显示该集合中每种内容的项目数量。

我目前从数据库中获取每种类型的编号，如下所示：

```
{section name=res loop=$results}

{assign var='wn' value=$db->num_rows($db->query("select * from content where type='1' and collection_id='{$results[res].collection_id}'"))}
{assign var='nn' value=$db->num_rows($db->query("select * from content where type='2' and collection_id='{$results[res].collection_id}'"))} 
```

ETC

问题是我们正在为每个 div 执行五个数据库查询，我们想尝试将它们合并为一个。使用 php，我们只需要做

```
$w=$db->query("select type, count(*) as number from content where collection_id='".$val['collection_id']."' GROUP by type"); 
```

然后使用带有“mysql_fetch_array”的“while”循环将类型数量分配给变量。

是否可以在 Smarty 中做类似的事情？Smarty 是否有 mysql_fetch_array 替代方法来访问结果集？

提前致谢！

**编辑：**有人建议我应该从 php 中执行此操作，但我不清楚它是如何工作的。在我的 php 文件中，我有以下内容：

```
<?php

$c=$db->query("select * from ".USERS_PIN."");

$cdata = array();

while ($row = mysql_fetch_array($c))
    {
        $cdata[] =  $row;
    }

$smarty->assign("results", $cdata); 

$smarty->display('stack.tpl');  

?> 
```

然后在 stack.tpl 我有以下内容：

```
<!DOCTYPE html>
<html lang="en">
<head>
</head>
<body >

<div id="ColumnContainer">

{if count($results) > 0}

            {section name=res loop=$results}

            {assign var='wn' value=$db->num_rows($db->query("select * from pinrest_users_pin where type='4' and board_id='{$results[res].board_id}'"))}
            {assign var='nn' value=$db->num_rows($db->query("select * from pinrest_users_pin where type='5' and board_id='{$results[res].board_id}'"))}
            {assign var='in' value=$db->num_rows($db->query("select * from pinrest_users_pin where (type='1' or type='2') and board_id='{$results[res].board_id}'"))}
            {assign var='vn' value=$db->num_rows($db->query("select * from pinrest_users_pin where type='3' and board_id='{$results[res].board_id}'"))}

<div class='item' style="height:70px;width:350px;float:left;border:2px solid aqua" data-id="{$results[res].id}">

    <div class="datadiv" >

<div style="margin-top:3px;width:40%;float:left;margin-left:15px">{$nn} news {$vn} videos {$in} images {$wn} webpages</div>

          </div>

  </div>

 {/section}

{/if}     

</div>

</body>
</html> 
```

我认为我是从 Smarty 循环中一次构建一个 div，我别无选择，只能在循环中一次获取每个 div 的 mysql 数据。有没有办法让我获取 php 文件中每个 div 的数据，然后在循环期间分配它并在 Smarty 中使用它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T22:45:44.060

在 Smarty 模板中执行 SQL 违背了使用模板系统的初衷。在你的控制器文件中处理这个。

我对 PHP 的 sql 方法有点生疏，所以用正确的方法来调整它以实现您的实现。解决方案1：

```
$smarty->display('beginning_of_view.tpl');
$q = $db->query('your query for all the divs');

while($row = mysql_fetch_assoc($q))
{
  $smarty->assign('row', $row);
  $smarty->display('my_div.tpl');
}
$smarty->display('end_of_view.tpl'); 
```

解决方案2（可能是更好的方法）：

```
$rows = array();
$q = $db->query('your query for all the divs');

while($row = mysql_fetch_assoc($q))
{
  $rows[] = $row;
}
$smarty->assign('rows', $rows);
$smarty->display('template.tpl');

//In your template
{foreach $rows as $row}
{$row}
{/foreach} 
```

希望这能传达这个想法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T22:46:17.527

您将 mysql_fetch_array 返回的数组分配给 smarty 变量，然后使用 smarty 循环

这是一个例子：

你的php文件：

```
<?php
$arr = array(1000, 1001, 1002);
$smarty->assign('myArray', $arr);
?> 
```

你的聪明模板

```
 {foreach from=$myArray item=foo}
     {$foo}
 {/foreach} 
```

**编辑：**

根据您的要求，您应该使用多提及/嵌套数组，看看这个问题： [php smarty loop multidimensional array](https://stackoverflow.com/questions/2562473/php-smarty-loop-multidimensional-array)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T06:26:23.733

在您的 php 中，在主查询循环中执行 4 个查询（来自您的 tpl 的查询）并将结果添加为 $row 上的字段：

```
<?php

$c=$db->query("select * from ".USERS_PIN."");        
$cdata = array();

while ($row = mysql_fetch_array($c))
            {
            $d = $db->query("select * from pinrest_users_pin where type='4' and     board_id=".$row['board_id']);
            $row['wn'] = mysql_fetch_array($d); // repeat 4X
            $cdata[] =  $row;
            }

$smarty->assign("results", $cdata);        
$smarty->display('stack.tpl');        
?> 
```

然后在 tpl 中使用 $results[res].wn 在您的 div 中。

# php - Wordpress 主题选项不保存选项

> ID：11996473
> 
> 赞同：2
> 
> 时间：2012-08-16T22:41:57.013
> 
> 标签：php, wordpress, wordpress-theming, options

我目前正在构建一个带有主题选项页面的 Wordpress 主题。我使用原始的 Wordpress 主题（二十十二）作为基础，并在我进行的过程中进行了调整和添加。我遇到的问题是该页面似乎确实保存了我的默认设置，但是当我在表单中更改它们并点击保存按钮时，它仍然只调出默认设置。

这是我的 theme-options.php，[就在这里](http://pastebin.com/kM4q1s6U)，包含在我的 functions.php 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:01:13.883

您与您的命名不一致，将`fatum_box_one`您的选项数组更改为`eerste_box`等，并将您的 textareas 的名称从更改为`fatum_box_one[eerste_box]`等`fatum_theme_options[eerste_box]`。

# javascript - 如何将更多的超链接放在 加入我的 javascript 生成列表

> ID：11996476
> 
> 赞同：1
> 
> 时间：2012-08-16T22:42:17.697
> 
> 标签：javascript, jquery, html-lists

我有一个创建列表的 javascript。所有作品，看我的小提琴：http: [//jsfiddle.net/mauricederegt/mjdyW/4/](http://jsfiddle.net/mauricederegt/mjdyW/4/)

现在这个脚本产生：

```
<div id="container">
  <ul>
    <li>
      <a href="/best-known-for">Link1</a>
    </li>
  </ul>
  <ul>
    <li>
      <a href="/life-events">Link1</a>
    </li>
  </ul>
</div> 
```

如您所见，该`<li>`部分中只有 1 个超链接。我想在`<li>`部件中添加更多超链接，以便脚本生成如下列表：

```
<div id="container">
  <ul>
    <li>
      <a href="/best-known-for">Link1</a>
      <a href="/best-antoher">Some oher link</a>
      <a href="/best-antoher2">Another oher link</a>
    </li>
  </ul>
  <ul>
    <li>
      <a href="/life-events">Link1</a>
      <a href="/life-events2">Link2</a>
    </li>
  </ul>
</div> 
```

如何编辑我的 javascript，以便从脚本中读取/创建更多超链接？

另外，我还想`<li>`在单个中添加更多内容`<ul>`，这也有点卡住了。我的最终目标必须看起来像这样：

```
<div id="container">
  <ul>
    <li>
      <a href="/best-known-for">Link1</a>
      <a href="/best-antoher">Some oher link</a>
      <a href="/best-antoher2">Another oher link</a>
    </li>
    <li>
      <a href="/best-known-for2">Link2</a>
      <a href="/best-antoher2">Some oher link2</a>
      <a href="/best-antoher22">Another oher link2</a>
    </li>
  </ul>
  <ul>
    <li>
      <a href="/life-events">Link1</a>
      <a href="/life-events2">Link2</a>
    </li>
  </ul>
</div> 
```

亲切的问候

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:09:34.620

```
var Menu = function(data) {
    this.data = data;
};

Menu.prototype.render = function() {
    //console.log(this.data)
    var ul = $("<ul />");
    $.each(this.data, function(i, e) {
        var li = $("<li />");
        $.each(e, function(j, f) {
            li.append($("<a></a>", {
                href: f.url,
                text: f.title
            }));
        });
        ul.append(li);
    });
    return ul;
};

Menu.renderMenus = function(menus, root) {
    $.each(menus, function(key, val) {
        var m = new Menu(val),
            ul = m.render();
        ul.appendTo(root);
    });
}

var menu = 
[
    [//first ul
        [ //first li 
            { //first <a> element
                title: "First UL, First li, First a",
                menuCaption: "Best Known For Caption",
                url: "/best-known-for"
            },
            { //second <a> element
                title: "First UL, First li, Second a",
                menuCaption: "Best Known For Caption",
                url: "/best-known-for"
            }
        ],
        [ //second li 
            { //only <a> element
                title: "First UL, Second li, First a (not first-child, and not red)",
                menuCaption: "Choose a life Event",
                url: "/life-events"
            }
        ]
    ],
    [//second ul
        [ //first li in second ul
            { //only <a> element
                title: "Second UL, First li, First a",
                menuCaption: "Hello Kitty",
                url: "/google"
            },
            { //second <a> element
                title: "Second UL, First li, Second a",
                menuCaption: "Best Known For Caption",
                url: "/best-known-for"
            }
        ]
    ] //you can add as many <li> or <a> elements you wish by following the 
      //pattern in this object literal
];

Menu.renderMenus(menu, $("#container"));​ 
```

[**小提琴**](http://jsfiddle.net/mjdyW/11/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:22:33.660

我稍微修改了代码以创建您想要的结构。检查评论。

```
var Menu = function(data) {
       this.data = (data.length) ? data : [data]; 
    };

    Menu.prototype.render = function(root) {
        // generate one li per menu item and one anchor for each element from data
        var li = $("<li></li>");
        $.each(this.data, function(link) { 
            $("<a></a>", {
                href: link.url,
                text: link.title
            }).appendTo(li);
        });
        li.appendTo($('#menuContainer'));
    };

    Menu.renderMenus = function(menus, root) {
        // create global ul here and add and id so you can point later to it
        var ul = $("<ul></ul>").attr('id','menuContainer');
        ul.appendTo(root);
        $.each(menus, function(key, val) {
            var m = new Menu(val);
            m.render(root);
        });
    }

    // modified the structure a little. you other arrays for anchors
    var menu = [
        [{
            title: "Link1",
            menuCaption: "Best Known For Caption",
            url: "/best-known-for",

        },{
            title: "Link2",
            menuCaption: "Best Kno2wn For Caption",
            url: "/best-known-for2",

        }
           ],

            {
            title: "Link1",
            menuCaption: "Choose a life Event",
            url: "/life-events",
        }

    ];

    Menu.renderMenus(menu, $("#container"));
}) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T22:54:40.470

您可以单独附加它们（如果将其合并到循环中，这也将起作用）：

```
Menu.prototype.render = function(root) {
    var ul = $("<ul></ul>");
    var li = $("<li></li>");
    li.append($("<a></a>", {
        href: this.data.url,
        text: this.data.title
    })).appendTo(ul);

    // More links can be added into the li
    li.append($("<a></a>", {
        href: this.data.url,
        text: this.data.title
    }));

    ul.appendTo(root);
}; 
```

您还可以将`li`项目添加到`ul`相同的方式：

```
ul.append(li.clone()); 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-08-16T22:43:17.640

```
<div id="container">
  <ul>
    <li>
      <a href="/best-known-for">Link1</a>
      <a href="/best-antoher">Some oher link</a>
      <a href="/best-antoher2">Another oher link</a>
    </li>
    <li>
      <a href="/best-known-for2">Link2</a>
      <a href="/best-antoher2">Some oher link2</a>
      <a href="/best-antoher22">Another oher link2</a>
    </li>
    <li>
      <a href="/life-events">Link1</a>
      <a href="/life-events2">Link2</a>
    </li>
  </ul>
</div> 
```

那会奏效吗？

# qt - 显示第二个窗口问题

> ID：11996478
> 
> 赞同：1
> 
> 时间：2012-08-16T22:42:37.067
> 
> 标签：qt, pyqt, pyqt4, qt-designer

我正在处理 2 个窗口。一个由 Qt Designer 创建，我将其导入 test.py 程序。我做了什么我在测试程序上制作了一个小部件，而不是向它添加一个按钮，然后在点击事件上我尝试弹出由 Qt Designer 创建的另一个窗口（gui1.py），但它从不弹出，当我使用 break 并执行逐行调试它在第 35 行 test.py 上运行此命令“myapp2 = MyForm()”后向我显示此消息。

QCoreApplication::exec: 事件循环已经在运行

一旦我在终端上按下回车，它就会弹出另一个窗口。

我很困惑我错在哪里。

谢谢 [test.py](http://www.mail-archive.com/pyqt@riverbankcomputing.com/msg26206/test.py) [gui1.py](http://www.mail-archive.com/pyqt@riverbankcomputing.com/msg26206/gui1.py)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:33:56.853

另一个窗口没有出现的原因是因为您没有保留对它的引用，因此它在显示后立即被垃圾收集。

要解决此问题，您可以将窗口实例存储为属性，或为其提供父级：

```
def local_manag(self):
    print "pressed"
    # store it as an attribute
    self.myapp2 = MyForm()
    self.myapp2.show()
    # or give it a parent
    # myapp2 = MyForm(self)
    # myapp2.show() 
```

# python - 基本蜘蛛程序将无法运行

> ID：11996479
> 
> 赞同：-3
> 
> 时间：2012-08-16T22:42:51.930
> 
> 标签：python, python-2.7

我在用 Python 构建基本的蜘蛛程序时遇到了麻烦。每当我尝试运行时，都会出现错误。错误发生在最后七行代码的某处。

```
#These modules do most of the work.
import sys
import urllib2
import urlparse
import htmllib, formatter
from cStringIO import StringIO

def log_stdout(msg):
    """Print msg to the screen."""
    print msg

def get_page(url, log):
    """Retrieve URL and return contents, log errors."""
    try:
        page = urllib2.urlopen(url)
    except urllib2.URLError:
        log("Error retrieving: " + url)
        return ''
    body = page.read()
    page.close()
    return body

def find_links(html):
    """Return a list links in html."""
    # We're using the parser just to get the HREFs
    writer = formatter.DumbWriter(StringIO())
    f = formatter.AbstractFormatter(writer)
    parser = htmllib.HTMLParser(f)
    parser.feed(html)
    parser.close()
    return parser.anchorlist

class Spider:

    """
    The heart of this program, finds all links within a web site.

    run() contains the main loop.
    process_page() retrieves each page and finds the links.
    """

    def __init__(self, startURL, log=None):
            #This method sets initial values
        self.URLs = set()
        self.URLs.add(startURL)
        self.include = startURL
        self._links_to_process = [startURL]
        if log is None:
            # Use log_stdout function if no log provided
            self.log = log_stdout
        else:
            self.log = log

    def run(self):
        #Processes list of URLs one at a time
        while self._links_to_process:
            url = self._links_to_process.pop()
            self.log("Retrieving: " + url)
            self.process_page(url)

    def url_in_site(self, link):
        #Checks whether the link starts with the base URL
        return link.startswith(self.include)

    def process_page(self, url):
        #Retrieves page and finds links in it
        html = get_page(url, self.log)
        for link in find_links(html):
            #Handle relative links
            link = urlparse.urljoin(url, link)
            self.log("Checking: " + link)
            # Make sure this is a new URL within current site
            if link not in self.URLs and self.url_in_site(link):
                self.URLs.add(link)
                self._links_to_process.append(link) 
```

错误消息与此代码块有关。

```
if __name__ == '__main__':
    #This code runs when script is started from command line
    startURL = sys.argv[1]
    spider = Spider(startURL)
    spider.run()
    for URL in sorted(spider.URLs):
            print URL

The error message:
        startURL = sys.argv[1]
    IndexError: list index out of range 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T22:45:28.377

你没有用参数调用你的蜘蛛程序。`sys.argv[0]`是您的脚本文件，并且`sys.argv[1]`将是您传递它的第一个参数。“列表索引超出范围”意味着您没有给它任何参数。

尝试将其称为`python spider.py http://www.example.com`（使用您的实际 URL）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:15:08.390

这并不能直接回答您的问题，但是：

我会这样做：

```
START_PAGE = 'http://some.url.tld'
ahrefs = lxml.html.parse(START_PAGE).getroottree('//a/@href') 
```

`lmxl.html`然后对对象和`multiprocess`链接使用可用的方法

这可以处理“半格式错误”的 HTML，您可以插入 BeautifulSoup 库。

如果您甚至想尝试跟踪 JavaScript 生成的链接，则需要做一些工作，但是 - 这就是生活！

# internet-explorer - @font-face 没有在 IE 中加载 https

> ID：11996484
> 
> 赞同：1
> 
> 时间：2012-08-16T22:43:29.697
> 
> 标签：internet-explorer, https, font-face

我注意到在 https 模式下我的字体不会加载 - 仅在 IE（8 或 9）上。

任何想法为什么？

这是一个示例页面：[https ://www.kby.org/test/font.asp](https://www.kby.org/test/font.asp)

你应该看到 3 个小图标。如果您看到字母 2PK 则 font-face 不起作用...

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-05T22:35:44.093

我有同样的问题 https 与 IE9 在 win7 64 位上没有显示，我改变了浏览器获取信息的方式。[fontsquirrel](http://www.fontsquirrel.com/blog/2010/11/troubleshooting-font-face-problems)建议的方式（用于以最新语法自动生成 font-face.css 文件的真正有用的站点）是放在 HTML 的 head 标签之间：样式表的链接和实际 HTML 页面上的 css，例如

```
 <link href="/includes/font-face.css" rel="stylesheet" type="text/css" />
    <style>
     body{font-family:modern_pictogramsnormal}
    </style> 
```

这对我不起作用，所以我尝试了其他方法将信息发送到浏览器。尝试将导入行放在将在此页面上使用的其他 CSS 文件之一的顶部，例如：

```
 @import "/includes/font-face.css"; 
```

在 heb.css 文件的顶部，并从 HTML 中取出指向“/includes/font-face.css”的样式表链接。那就是在页面中使用的另一个 css 文件上放置一个导入行，我将它放在我的主 CSS 文件中。

这个方法对我有用，但我仍然在 IE9 中得到 FOUT（无样式文本的 Flash），你搜索 FOUT 有关于这是好还是坏的讨论，以及可以延迟浏览器显示文本的 JavaScript/JQuery 插件，直到字体已正确加载。

如果这不起作用，你可以看看这个我发现对我不起作用的答案，它基本上涉及将你的 font-face.css 的大小加倍，而不是相对链接使用整个

```
http://mydomain.com/fontfile.xxx
```

描述 myfont0，另一个使用

```
https://mydomain.com/fontfile.xxx
```

描述 myfont1 然后在 CSS 中使用 body{myfont0, myfont1}，抱歉我找不到链接 - 我最近一直在清除我的缓存，如果你不明白，请看下面：

```
 @font-face {
font-family: 'droid_sansregular';
src: url('http://mydomain.com/fonts/droidsans-webfont-webfont.eot');
src: url('http://mydomain.com/fonts/droidsans-webfont-webfont.eot?#iefix') format('embedded-opentype'),
     url('http://mydomain.com/fonts/droidsans-webfont-webfont.woff') format('woff'),
     url('http://mydomain.com/fonts/droidsans-webfont-webfont.ttf') format('truetype'),
     url('http://mydomain.com/fonts/droidsans-webfont-webfont.svg#droid_sansregular') format('svg');
font-weight: normal;
font-style: normal;}

     @font-face {
font-family: 'droid_sansregular0';
src: url('https://mydomain.com/fonts/droidsans-webfont-webfont.eot');
. . .}

body{font-family: droid_sansregular, droid_sansregular0} 
```

# wordpress - Wordpress 自定义帖子类型按月组织

> ID：11996493
> 
> 赞同：0
> 
> 时间：2012-08-16T22:44:35.997
> 
> 标签：wordpress, custom-post-type

我已经看到很多这样的问题被问到，但还没有完全弄清楚如何去做。我拥有的是一个名为“游戏”的自定义帖子类型，其中我有一个名为“ecpt_date”的自定义字段。基本上我想做的是为我创建的运动队网​​站制定时间表。

我已经看到了根据今天的日期显示自定义帖子类型的问题和答案，我实际上已经在我的网站上工作以显示即将推出的游戏和最新的游戏。

我想做的是把我们的日程安排成几个月，这样我就可以分别展示九月、十月、十一月等的所有比赛。

我已经设法用不同的查询显示所有游戏，但没有太多运气尝试根据“ecpt_dates”月份过滤游戏。我假设它与 meta_query 中的日期值有关，但不确定如何继续。我可以获取日期并显示它我只是不能通过它订购我的自定义帖子。

这是我正在尝试的查询。

```
$posts = new WP_Query( array( 
        'post_type' => 'games', 
        'showposts' => 10, 
        'meta_key' => 'ecpt_date',
        'orderby' => 'meta_value',
        'order' => 'ASC',
        'meta_query' => array(array(
            'key' => 'ecpt_date',
            'value' => date(Assuming I use this),
            'type' => 'DATE'

        ))
    )); 
```

据我了解，这是因为时间在自定义字段中的格式。无论如何，我都不是 php 专家，但我希望有人能给我一些提示或想法，告诉我如何解决这个问题或如果可能的话。

# c++ - #pragma 警告(push) 没有 #pragma 警告(pop)

> ID：11996500
> 
> 赞同：2
> 
> 时间：2012-08-16T22:45:32.883
> 
> 标签：c++, visual-studio-2010, visual-c++

在 Visual Studio 2010 中使用 C++ 本机解决方案。

`#pragma warning (push)`在所有包含之后，在 cpp 文件的开头使用。之后，有几个禁用警告`#pragma warning(disable : XXXX)`。

`#pragma warning(pop)`在文件末尾省略的可能后果是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:14:58.733

如果您有`#include`该 cpp 文件的任何其他源文件，那么编译外部文件时的警告状态将被搞砸——当警告有保证时，它可能无法发出警告。

但是请注意，`#include`使用 cpp 文件被认为是错误的格式和代码异味；在某些罕见的情况下，它可能是正确的做法（例如构建系统将`#include`许多源文件合并为一个以减少编译时间，有点像预编译的头文件），但几乎总是做错事，即使它设法编译和链接没有错误。

如果该源文件`#include`在其他任何地方都没有 d ，那么没有 a`#pragma warning(pop)`不会产生任何不利后果，假设编译器首先没有抱怨这种不匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T22:48:57.460

由于这是仅编译器设置，因此不会对程序本身产生任何影响。它可能会搞砸外部包含的警告。

# java - 获取 spring:bind status.errorMessage 以填充的问题

> ID：11996501
> 
> 赞同：0
> 
> 时间：2012-08-16T22:45:38.323
> 
> 标签：java, spring, validation, spring-mvc, groovy

我有一个使用 Spring 框架及其验证器对表单的输入值进行完整性检查的 Groovy 项目。我想让 Spring 通过内置的输入表单字段旁边填充错误消息`${status.errorMessage}`；但是，我只能让它在我的模型对象（来自控制器）中填充“errorMessages”。所以让我们看一些代码。

登录.jsp：

```
<form method="post" action="<c:url value="/login" />">
    <spring:bind path="request.username">
        <label for="username"><fmt:message key="login.username"/>:
            <input type="text" id="username" size="20" maxlength="50" name="username" value="${request.username}"/>
        </label>
        <%-- This part does NOT display the validation errors. --%>
        <c:if test="${status.error}"><span class="error">${status.errorMessage}</span></c:if>
    </spring:bind>

    <spring:bind path="request.password">
        <label for="password"><fmt:message key="login.password"/>:
            <input type="password" id="password" size="20" maxlength="30" name="password" />
        </label>
        <%-- This part does NOT display the validation errors. --%>
        <c:if test="${status.error}"><span class="error">${status.errorMessage}</span></c:if>
    </spring:bind>

    <input id="login" type="submit" value="Login"/>
</form>

<%-- This part does display the validation errors. --%>
<c:if test="${ec > 0}">
    <p>
        <c:forEach items="${errorCodes}" var="error">
            <span class="error"><fmt:message key="${error.defaultMessage}"/></span><br/>
        </c:forEach>
    </p>
</c:if> 
```

登录控制器.groovy：

```
@RequestMapping(method = RequestMethod.GET, value = '/')
ModelAndView defaultView() {
    ModelMap model = new ModelMap()
    model.addAttribute('request', new LoginRequest())
    new ModelAndView('login', model)
}

@RequestMapping(method = RequestMethod.POST, value = '/login')
ModelAndView login(
        LoginRequest loginRequest, HttpServletResponse response,
        HttpSession session, BindingResult br, ModelMap model
) {
    validator.validate(loginRequest, br)

    if (br.hasErrors()) {
        model.addAttribute('request', loginRequest)
        return returnWithError(br, model, 'login')
    }
    ...
}

private ModelAndView returnWithError(BindingResult br, ModelMap model, String redirectTo) {
    br.allErrors.each {error ->
        log.error(error.toString())
    }

    def objectErrors = br.allErrors.findAll {e -> e instanceof ObjectError}

    model.addAttribute('ec', br.errorCount)
    model.addAttribute('errorCodes', objectErrors)
    new ModelAndView(redirectTo, model)
} 
```

LoginRequestValidator.groovy：

```
@Override
void validate(Object o, Errors errors) {
    ValidationUtils.rejectIfEmpty(errors, 'username', 'username.empty', 'username.empty')
    ValidationUtils.rejectIfEmpty(errors, 'password', 'password.empty', 'password.empty')
} 
```

我错过了 Spring Magic [TM] 的哪一部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T04:42:51.603

我认为您的 BindingResult 对象应该是紧跟在您的 LoginRequest 对象之后的参数。请参阅[http://static.springsource.org/spring/docs/3.0.x/reference/mvc.html#mvc-ann-requestmapping](http://static.springsource.org/spring/docs/3.0.x/reference/mvc.html#mvc-ann-requestmapping)，特别是示例 15.1。BindingResult 和 @ModelAttribute 的排序无效

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T18:09:45.583

查看@RequestMapping 上的Javadoc，因为我发现它是该主题的最佳： http: [//static.springsource.org/spring/docs/3.0.x/api/org/springframework/web/bind/annotation/RequestMapping.html](http://static.springsource.org/spring/docs/3.0.x/api/org/springframework/web/bind/annotation/RequestMapping.html)

尝试以下操作：

```
ModelAndView login(
        @Valid LoginRequest loginRequest, HttpServletResponse response,
        HttpSession session, BindingResult br, ModelMap model
) {} 
```

请参阅[Spring 中的 @Valid 注解表示什么？](https://stackoverflow.com/questions/3595160/what-does-the-valid-annotation-indicate-in-spring)

如果这不起作用，您应该尝试将一些代码转换为纯 Java 并运行调试器以查看发生了什么（我知道这不是一个答案，而只是一个想法）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-22T18:03:24.123

也许您会发现[这些](https://stackoverflow.com/a/634690/390462)来自[kgiannakakis](https://stackoverflow.com/users/24054/kgiannakakis)的帖子非常有用。它解释了这些功能的用途以及如何处理在[Spring 3.1 文档](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/spring.tld.html#spring.tld.bind)中进行了解释。

添加类似的东西可能会奏效，不是吗？

```
@Controller
public class MyController {

    @InitBinder
    protected void initBinder(WebDataBinder binder) {
        binder.setValidator(new FooValidator());
    }

    @RequestMapping("/foo", method=RequestMethod.POST)
    public void processFoo(@Valid Foo foo) { ... }

} 
```

看看 SpringSource 博客，尤其是[这些关于数据绑定新特性的文章](http://blog.springsource.com/2009/11/17/spring-3-type-conversion-and-validation/)。它可以为您的验证过程添加一些新外观。

# html - 将一个 div 再细分为 4 个 div 并将它们定位在 NE、SE、NW 和 SW 方向

> ID：11996504
> 
> 赞同：1
> 
> 时间：2012-08-16T22:45:49.340
> 
> 标签：html, css

我需要使用 html 和 css 绘制类似的东西。我不能这样做。

```
 _____________________
          |      |      |     |  
          |______|      |_____|
          |                   |  
          |______        _____|
          |      |       |    |
          |______|_______|____| 
```

我创建了一个主要的 div，一个外部矩形，然后创建了 4 个嵌套的 div，较小的矩形。对于左侧 2，我让它们向左浮动，另外 2 个向右浮动。但这不是我想要的。有人可以让我知道应该做什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:57:40.050

您需要使用绝对定位来实现这一点。每个内部 div 的绝对位置将有两个`top`, `left`, `right`, 或`bottom`设置为 0。

这是一个例子：

```
<html>
    <head>
        <title>CSS Based layouts</title>

        <style type="text/css">
            #rect {
              width: 300px;
                height: 300px;
                position: relative;
              border: 1px solid black;
            }

            #topleft {
              position: absolute;
              top: 0;
                left: 0;
              border: 1px solid black;
            }

            #bottomleft {
              position: absolute;
              bottom: 0;
                left: 0;
              border: 1px solid black;
            }

            #topright {
              position: absolute;
              top: 0;
                right: 0;
              border: 1px solid black;
            }

            #bottomright {
              position: absolute;
              bottom: 0;
                right: 0;
              border: 1px solid black;
            }

        </style>

    </head>
    <body>
        <h1>CSS Based layouts</h1>
        <p></p>

        <div id="rect">

            <div id="topleft">
                Top and Left
            </div>
            <div id="bottomleft">
                Bottom and Left
            </div>
            <div id="topright">
                Top and Right
            </div>
            <div id="bottomright">
                Bottom and Right
            </div>

        </div>

    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T22:55:26.700

使用绝对定位在这里看小提琴[http://jsfiddle.net/NPALD/](http://jsfiddle.net/NPALD/)

```
<div id="outer">
    <div id="NW"></div>
    <div id="NE"></div>
    <div id="SW"></div>
    <div id="SE"></div>
</div>
​
#outer
{
    width:300px;
    height: 300px;
    border:solid 1px red;
    position: relative;
}
#NW, #NE, #SW, #SE {
    position: absolute;
    width: 100px;
    height: 100px;
    border: solid 1px green;
}
#NW
{
    top: 0;
    left: 0;
}
#NE
{
    top: 0;
    right: 0;
}
#SW
{
    bottom: 0;
    left: 0;
}
#SE
{
    bottom: 0;
    right: 0;
}​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T23:02:55.083

你的布局似乎是表格的，所以让我们试试表格：

[http://jsfiddle.net/cvTak/2/](http://jsfiddle.net/cvTak/2/)

```
<table>
    <tr>
        <td class="t l">Top Left</td>
        <td class="t r">Top Right</td>
    </tr>
    <tr>
        <td class="b l">Bottom Left</td>
        <td class="b r">Bottom Right</td>
     </tr>
</table>​

table {
    border-collapse: collapse;
    border: 1px solid blue;
}
td {
    width: 100px;
    height: 100px;
}
.l {
    border-right: 100px solid yellow;
}

.t {
    border-bottom: 100px solid yellow;
}
​ 
```

# azure - 通过 FTP 访问 Azure，其中有两个网站

> ID：11996506
> 
> 赞同：0
> 
> 时间：2012-08-16T22:45:55.783
> 
> 标签：azure, ftp, orchardcms

我的 Azure 帐户中有 2 个网站，我想通过 FTP 访问第二个网站，但是，当我加载 FTP 站点时，我正在获取第一个站点的 FTP 区域，但我看不到第二个站点的任何数据.

我的第一个站点是一个简单的网站，但第二个站点是一个 Orchard 模板。当我访问 FTP 区域时，我期待看到 Orchard 文件夹结构，但似乎只有第一个站点可以通过 FTP 访问。

我已经查看了有关设置您自己的 FTP 的其他线程，但我想避免这样做，直到绝对必要。

**所以我的问题是：**有谁知道 Azure 生成的 Orchard 网站是否可以通过 FTP 访问，或者要获得访问权限，我可以安全地从第二个网站的仪表板重置凭据，以便它通过单独的一组有自己的 FTP 区域证书？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T00:25:03.747

我相信您用于 FTP 的用户名应该是`<web site name>\<username>`，因此您应该已经拥有两个站点的不同凭据。您能否确认您使用正确的凭据来尝试访问 Orchard 站点？检查门户右侧的“部署用户”并确保您正在使用它。

# java - 如何在 Maven 中启用 Ebean 增强？

> ID：11996507
> 
> 赞同：5
> 
> 时间：2012-08-16T22:46:08.240
> 
> 标签：java, maven, maven-3, maven-plugin, ebean

我一直在使用[Avaje.org ebean](http://www.avaje.org/ "Avaje.org ebean") ORM 层，但我不明白如何使用 Maven 启用[“Ebean v2.6.0 用户指南”](http://www.avaje.org/doc/ebean-userguide.pdf "参考指南")中描述的字节码增强功能。

我在 Avaje.org 主页上找到了一个[配置示例](http://www.avaje.org/ebean/maven.html)，但它不起作用。GitHub 上的[演示 Maven 样板](https://github.com/ebean-orm-demo/demo-maven-config)也没有。

帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-02T20:26:34.767

EBeans 现在有自己的 Maven 插件，但是我在网上找不到任何文档，所以这里是一个如何使用它的示例：

```
<plugin>
    <groupId>org.avaje.ebeanorm</groupId>
    <artifactId>avaje-ebeanorm-mavenenhancer</artifactId>
    <version>${ebean.version}</version>
    <executions>
        <execution>
            <id>main</id>
            <phase>process-classes</phase>
            <goals>
                <goal>enhance</goal>
            </goals>
            <configuration>
                <packages>com.package1.**,com.package2.**</packages>
                <transformArgs>debug=1</transformArgs>
                <classSource>${project.build.outputDirectory}</classSource>
                <classDestination>${project.build.outputDirectory}</classDestination>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

**使用日食**

如果您使用 Eclipse，您需要确保它在需要时运行插件，如下所示：

```
<build>
    <plugins>
        <!-- plugins here -->
    </plugins>
    <pluginManagement>
        <plugins>
            <!--This plugin's configuration is used to store Eclipse m2e settings only. It has no influence on the Maven build itself. -->
            <plugin>
                <groupId>org.eclipse.m2e</groupId>
                <artifactId>lifecycle-mapping</artifactId>
                <version>1.0.0</version>
                <configuration>
                    <lifecycleMappingMetadata>
                        <pluginExecutions>
                            <pluginExecution>
                                <pluginExecutionFilter>
                                    <groupId>org.avaje.ebeanorm</groupId>
                                    <artifactId>avaje-ebeanorm-mavenenhancer</artifactId>
                                    <versionRange>[3.3.2,)</versionRange>
                                    <goals>
                                        <goal>enhance</goal>
                                    </goals>
                                </pluginExecutionFilter>
                                <action>
                                    <execute>
                                        <runOnConfiguration>true</runOnConfiguration>
                                        <runOnIncremental>true</runOnIncremental>
                                    </execute>
                                </action>
                            </pluginExecution>
                        </pluginExecutions>
                    </lifecycleMappingMetadata>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>
</build> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T22:46:08.240

**过时的答案**

此答案适用于非常旧版本的 EBeans，请忽略它。

**原创内容**

Avaje 页面上的示例有一些错误。

1.  标签不正确：“process-ebean-enhancement”不是 Maven 生命周期，因此示例配置中的插件将无法正确运行。正确的阶段是“进程类”。
2.  “classSource”参数不正确。按照配置，ebean 插件将增强您的测试代码中的@Entity 类，而不是您的生产代码。正确的值是“${project.build.outputDirectory}”。
3.  确保更新项目的包空间。这是下面示例中的“com.mycompany.**”。

完整的配置应该是：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <executions>
                <execution>
                    <id>process-ebean-enhancement</id>
                    <phase>process-classes</phase>
                    <configuration>
                        <tasks>
                            <property name="compile_classpath" refid="maven.compile.classpath" />
                            <echo
                                message="Ebean enhancing test classes debug level -----------------------------------" />
                            <echo message="Classpath: ${compile_classpath}" />
                            <taskdef name="ebeanEnhance" classname="com.avaje.ebean.enhance.ant.AntEnhanceTask"
                                classpath="${compile_classpath}" />
                            <ebeanEnhance classSource="${project.build.outputDirectory}"
                                packages="com.mycompany.**" transformArgs="debug=1" />
                        </tasks>
                        <encoding>UTF-8</encoding>
                    </configuration>
                    <goals>
                        <goal>run</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
```

这将增强“src/main/java/com/mycompany”及以下所有@Entity 类。

您可以通过对要检查的包进行更多限制来缩短执行时间。

此外，如果您确实需要增强测试类，则可能需要复制此配置。在这种情况下，对第二个块使用“proces-test-classes”阶段。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-03T02:43:49.463

JBCP 的答案是针对旧的 ebean 版本 ( `org.avaje.ebeanorm`)。对于[较新的版本](http://ebean-orm.github.io/releases)( `io.ebean`)，您需要更改为`ebean-maven-plugin`.

```
<plugin>
    <groupId>io.ebean</groupId>
    <artifactId>ebean-maven-plugin</artifactId>
    <version>${ebean.version}</version>
    <executions>
        <execution>
            <id>main</id>
            <phase>process-classes</phase>
            <goals>
                <goal>enhance</goal>
            </goals>
            <configuration>
                <packages>com.package1.**,com.package2.**</packages>
                <transformArgs>debug=1</transformArgs>
                <classSource>${project.build.outputDirectory}</classSource>
                <classDestination>${project.build.outputDirectory}</classDestination>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

**注意：** ebean 插件版本应与 ebean 版本相同。

**参考：** [Maven 仓库](https://mvnrepository.com/artifact/io.ebean/ebean-maven-plugin)，[Github](https://github.com/ebean-orm-tools/ebean-maven-plugin)

# groovy - 编译 groovy 类

> ID：11996514
> 
> 赞同：0
> 
> 时间：2012-08-16T22:46:46.783
> 
> 标签：groovy, gradle

我尝试编译 gradle 附带的 groovy quickstart 示例（在 samples/groovy/quickstart 目录中）。`gradle compileGroovy`并且`gradle jar`都成功完成，但我无法运行其中任何一个：

```
c:\tmp\quickstart\build\classes\main\org\gradle>java Person
Exception in thread "main" java.lang.NoClassDefFoundError: Person (wrong name: org/gradle/Person)
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClassCond(Unknown Source)
        at java.lang.ClassLoader.defineClass(Unknown Source)
        at java.security.SecureClassLoader.defineClass(Unknown Source)
        at java.net.URLClassLoader.defineClass(Unknown Source)
        at java.net.URLClassLoader.access$000(Unknown Source)
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
Could not find the main class: Person.  Program will exit. 
```

和

```
c:\tmp\quickstart\build\libs>java -jar quickstart.jar
Failed to load Main-Class manifest attribute from
quickstart.jar 
```

然后我将清单属性添加到`bulid.gradle`：

```
jar {
    manifest {
        attributes("Main-Class": "org.gradle.Person")
    }
} 
```

现在得到：

```
c:\tmp\quickstart\build\libs>java -jar quickstart.jar
Exception in thread "main" java.lang.NoClassDefFoundError: groovy/lang/GroovyObject
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClassCond(Unknown Source)
        at java.lang.ClassLoader.defineClass(Unknown Source)
        at java.security.SecureClassLoader.defineClass(Unknown Source)
        at java.net.URLClassLoader.defineClass(Unknown Source)
        at java.net.URLClassLoader.access$000(Unknown Source)
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
Caused by: java.lang.ClassNotFoundException: groovy.lang.GroovyObject
        at java.net.URLClassLoader$1.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
        at java.lang.ClassLoader.loadClass(Unknown Source)
        ... 12 more
Could not find the main class: org.gradle.Person. Program will exit. 
```

如何运行创建的 jar？（或者我错过了重点......）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:57:57.277

Gradle 发行版中的`groovy/quickstart`示例并不意味着直接执行。除其他外，`Person`该类没有`main`方法。把它想象成一个图书馆。

# redis - 在数据存储中合并排序？

> ID：11996516
> 
> 赞同：4
> 
> 时间：2012-08-16T22:47:01.433
> 
> 标签：redis

我正在尝试为我正在进行的项目制作“朋友流”。我在 Redis ZSETS 中保存了个人用户流。就像是：

```
key : { stream_id : time }
user1-stream: { 1:9931112, 3:93291, 9:9181273, ...}
user2-stream: { 4:4239191, 2:92919, 7:3293021, ...}
user3-stream: { 8:3299213, 5:97313, 6:7919921, ...}
...

user4-friends: [1,2,3] 
```

现在，要制作 user4 的好友流，我会调用：

```
ZUNIONSTORE user4-friend-stream, [user1-stream, user2-stream, user3-stream] 
```

但是，当您尝试合并总计超过 1-2000 个元素的 ZSETS 时，ZUNIONSTORE 会很慢。

我真的很想让 Redis 在 ZSETS 上进行合并排序，并将结果限制为几百个元素。是否有任何现成的数据存储可以满足我的需求？如果没有，是否有任何框架来开发类似 redis 的数据存储？

我想我可以只 fork Redis 并添加我需要的功能，但我希望避免这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T19:17:56.967

人们倾向于认为 zset 只是一个跳过列表。这是错误的。它是一个跳过列表（有序数据结构）加上一个无序字典（实现为哈希表）。必须定义合并操作的语义。例如，您将如何合并其共同项目不具有相同分数的非不相交 zset？

要为 ZUNIONSTORE 实现合并算法，您必须对项目进行排序（使用跳过列表很容易），在构建输出时合并它们（恰好也是一个 zset：skiplist 加字典）。

因为在算法开始时无法猜测结果的基数，所以我认为不可能在线性时间内构建这个跳过列表+字典。充其量是 O(n log n)。所以合并是线性的，但构建输出不是：它破坏了使用合并算法的好处。

现在，如果您想实现 ZUNION（即直接返回结果，而不是将结果构建为 zset），并将结果限制为给定数量的项目，则合并算法是有意义的。

支持合并连接的 RDBMS 通常可以做到这一点（但这通常不是很有效，因为随机 I/O 的成本）。我不知道支持类似功能的 NoSQL 存储。

要在 Redis 中实现它，您可以尝试使用 Lua 服务器端脚本，但它可能很复杂，而且我认为只有当 zset 远大于 zunion 中提供的限制时才会有效。在这种情况下，项目数量的限制将抵消运行解释 Lua 代码的开销。

最后一种可能性是在 Redis 源代码中用 C 语言实现它，这并不难。缺点是为您使用的 Redis 版本维护补丁的负担。Redis 本身并没有提供框架来做到这一点，并且定义 Redis 插件（与 Redis 源代码隔离）的想法通常被作者拒绝。

# c - 从函数内部访问矩阵

> ID：11996519
> 
> 赞同：0
> 
> 时间：2012-08-16T22:47:10.103
> 
> 标签：c, arrays, string, character, header-files

我有大量字符串需要存储在字符数组中，并且我需要能够遍历所有字符串。

此外，这些字符串不会改变，所以我希望矩阵是永久的，最好存储在头文件中。

谁能指出我正确的方向？

我在 C 中工作，不知道解决这个问题的最佳方法。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:00:20.047

标头中的变量定义可能不是一个好主意，请考虑替代方案：

```
// source.c contains
const char *const strings[] = {
    "string1", "string2", NULL 
};

// source.h contains
extern const char *const strings[];

// include source.h anywhere and loop through the strings like this:
for (const char *const *str = strings; *str != NULL; ++str)
    // use *str 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:04:37.690

尝试声明一个两级指针：

```
 #define NUMBER_OF_ROWS 10
   #define MAX_NUMBER_OF_CHARS_IN_STRING 255

   char *strings = (char**)calloc(NUMBER_OF_ROWS * sizeof(char));
   const char copy_string[] = "default string";

   for(int i = 0; i < NUMBER_OF_ROWS; i++)
   {
      strings[i] = (char*)calloc(MAX_NUMBER_OF_CHARS_IN_STRING);
   }

   for(int i = 0; i < NUMBER_OF_ROWS; i++)
   {
      strcpy(strings[i], copy_string);
   } 
```

这是假设您使用的是 ANSI C

# ruby-on-rails - database_cleaner 没有清除我的一些测试（rspec、capybara、selenium）

> ID：11996522
> 
> 赞同：2
> 
> 时间：2012-08-16T22:47:22.470
> 
> 标签：ruby-on-rails, rspec, capybara

database_cleaner 在大多数情况下都有效，但在某些情况下，我希望在每次测试后清除 user_id 之类的东西，但事实并非如此。因此，user_id 将自始至终递增而不是清除，并且用户 id 可预测为 1、2、3 或为测试创建的许多。我可以只调用 id 而不是对预期结果进行硬编码，但稍后我真的需要它来清除更复杂示例中的内容。这是最容易展示的。任何帮助将不胜感激。

从 SPEC_HELPER.RB:

```
RSpec.configure do |config|

  config.mock_with :rspec
  config.include FactoryGirl::Syntax::Methods

  config.include(Capybara, :type => :integration)
  config.include Devise::TestHelpers, :type => :controller
  config.use_transactional_fixtures = false

  config.before(:each) do
    I18n.default_locale = :en
    I18n.locale = :en
    DatabaseCleaner.start
    ResqueSpec.reset!
    ActionMailer::Base.deliveries.clear
  end 

  config.after(:each) do
    DatabaseCleaner.clean
  end

  config.after(:all) do
    TestCleaner.clean
  end

  config.before(:suite) do
    DatabaseCleaner.clean_with(:truncation)
    DatabaseCleaner.strategy = :transaction
    Role.reset_cache!
  end

  config.after(:suite) do
    DatabaseCleaner.clean_with(:truncation)
  end 
```

从我的测试：

```
 it "should return one provider" do
        get :index

        response.body.gsub(/\s+/, "").should == {
            :experts => [{
                             :availability => false,
                             :name => "#{@provider.user.first_name}#{@provider.user.last_name}",
                             :expert_id => 1,
                             :photo => @provider.details.photo.url
                         }] }.to_json
      end

      it "should show return two providers"  do
        @provider2 = create(:provider)
        get :index

        response.body.gsub(/\s+/, "").should == {
            :experts => [{
                             :availability => false,
                             :name => "#{@provider.user.first_name}#{@provider.user.last_name}",
                             :expert_id => 1,
                             :photo => @provider.details.photo.url
                         },
                         {
                             :availability => false,
                             :name => "#{@provider.user.first_name}#{@provider.user.last_name}",
                             :expert_id => 2,
                             :photo => @provider.details.photo.url
                         }
            ] }.to_json
      end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T15:21:38.480

数据库清理器将您的每个规范包装在一个事务中，并在规范结束时回滚该事务以删除任何数据库更改。回滚事务不会重置用于自动分配主键的自动增量或序列值。

我强烈建议不要对 id 进行硬编码。您提到您的示例将变得更加复杂，在这种情况下，在您的代码中散布随机整数将比更简单的示例更难维护。假设您使用的是 mysql，那么使用截断策略将重置自动增量值，但它也会慢很多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-19T12:17:32.733

我在开始测试时遇到了很多。我最终发现这不是由于数据库清理器问题（我也怀疑），而是由于执行测试的代码结构。

我可以尝试和描述的最好方法是说，基本上，如果你在`before(:each)`设置块和实际之外做事情`it`，`should`它最终会在实际测试“之外”并导致这些问题。

具体来说，我怀疑这里可能存在问题：

```
 it "should show return two providers"  do
    @provider2 = create(:provider)
    get :index

    response.body.gsub(/\s+/, "").should == { 
```

我希望将其更改为更像：

```
 it "should show return two providers"  do
    before(:each) do { 
      @provider2 = create(:provider)
      get :index
    }

    response.body.gsub(/\s+/, "").should == { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-19T12:03:41.627

是数据库没有正确清理的请求/集成规范吗？如果是这样，可能是因为您正在使用事务策略而不是截断策略进行清理。

尝试添加这个，这会将策略更改为仅针对集成规范进行截断：

```
config.before type: :integration do
  DatabaseCleaner.strategy = :truncation
end 
```

您不能将事务策略用于集成规范，因为 Capybara 在具有不同数据库连接的单独线程中运行。

这篇文章在为 rspec/capybara 设置数据库方面帮助了我很多：[Sane Rspec config for clean, and稍快，specs](http://highgroove.com/articles/2012/04/06/sane-rspec-config-for-clean,-and-slightly-faster,-specs.html)。

# objective-c - 用于具有两级表格的 iPad 应用程序的控件/设计模式，这些表格通向详细信息视图

> ID：11996525
> 
> 赞同：0
> 
> 时间：2012-08-16T22:47:52.260
> 
> 标签：objective-c, ios, cocoa-touch

我有一个电子商务网站，我正在尝试为其制作一个 iPap 特定应用程序，并且正在努力寻找重新创建菜单结构的最佳方法。我们有一个列出产品类别的顶级菜单。单击它会显示所选类别中的产品列表。单击产品将带您进入产品详细信息页面。

这似乎是一个 UISplitViewController 的好地方，但我在两个级别的浏览中苦苦挣扎。我应该为产品类别做一个单表控制器，将您带到带有产品列表和产品详细信息的 UISplitViewController 吗？或者只是两个单独的 tableviews 导致一个正常的视图，而不是与 splitview 混淆？其他应用程序是如何处理这个问题的？老实说，我不是 iPad 用户，所以我不熟悉其他应用程序是如何完成此类事情的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:30:16.540

如果您准备只针对 iOS 6+，您可以等待并使用 UICollectionView。然后，您可以通过捏合/缩放和转动产品（而不是照片）来实现类似于 iPad 上的照片应用程序的功能。WWDC 2012 视频有示例可以查看和浏览示例代码。

如果您必须以 iOS 4+ 为目标，UISplitView 也会以更直接的方式完成这项工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:22:00.347

带有 的设计`UISplitViewController`是您应该追求的。然后，您可以或多或少地像在带有普通导航控制器的 iPhone 上那样处理您的层次结构 incode。

# rest - 制作只读 REST 接口的约定？

> ID：11996527
> 
> 赞同：2
> 
> 时间：2012-08-16T22:48:31.393
> 
> 标签：rest, conventions

我是 REST API 开发的新手，如果您不想支持所有操作，我无法找到任何指导。

例如，假设我想创建一个只读 API，如果我收到一个“写”动词（PUT、POST、DELETE 等），我该怎么办？有没有这样的约定（比如返回 404、500 或其他东西）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:58:50.737

[RFC 2616](http://www.ietf.org/rfc/rfc2616.txt)定义的约定是为您不支持的命令返回 501（未实现）响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:11:01.850

405 用于资源不支持的方法。501 是您的服务器无法识别该方法。我相信错误是 4xx 而不是 5xx，因为是客户端请求了不允许做的事情。客户可以解决这个问题。服务器没有错，它只是选择不实施该方法。

# opengl - 什么会全局影响 OpenGL 中的纹理坐标值？

> ID：11996529
> 
> 赞同：0
> 
> 时间：2012-08-16T22:48:46.650
> 
> 标签：opengl, coordinates, textures, texture-mapping

我正在为一个名为 Autodesk MotionBuilder 的应用程序编写一个插件，该应用程序有一个 OpenGL 渲染器，并且我正在尝试将纹理几何体渲染到场景中。我有一个嵌入了 3D 视图的窗口，每次渲染我的窗口时，这就是（简而言之）发生的情况：

1.  我告诉渲染器我将要绘制到一个给定大小的区域
2.  我告诉渲染器在该区域绘制 MotionBuilder 场景
3.  我在场景中和/或顶部画了一些额外的东西

这里的挑战是我从 MotionBuilder 的渲染器继承了一些任意的 OpenGL 状态，这取决于它正在绘制什么以及场景中存在什么。到目前为止，我一直在处理这个问题，但有一件事我无法弄清楚。OpenGL 解释我的 UV 坐标的方式似乎会根据 MotionBuilder 在我背后所做的事情而改变。

这是我的渲染代码。如果场景中没有纹理几何体，这意味着 MotionBuilder 尚未处理任何与纹理相关的属性，它会按预期工作。

```
// Tell MotionBuilder's renderer to draw the scene
RenderScene();

// Clear whatever arbitrary state MotionBuilder left for us
InitializeAttributes(); // includes glPushAttrib(GL_ALL_ATTRIB_BITS)
InitializePerspective(); // projects into the scene / loads matrices

// Enable texturing, bind to our texture, and draw a triangle into the scene
glEnable(GL_TEXTURE_2D);
glBindTexture(GL_TEXTURE_2D, mTexture);

glBegin(GL_TRIANGLES);
glColor4f(1.0, 1.0, 1.0, 0.5f);
    glTexCoord2f(1.0, 0.0); glVertex3f(128.0,   0.0, 0.0);
    glTexCoord2f(0.0, 1.0); glVertex3f(  0.0, 128.0, 0.0);
    glTexCoord2f(0.0, 0.0); glVertex3f(  0.0,   0.0, 0.0);
glEnd();

// Clean up so we don't confound MotionBuilder's initial expectations
RestoreState(); // includes glPopAttrib() 
```

现在，如果我引入一些带有纹理的网格，就会发生一些奇怪的事情。我的纹理坐标被放大了。这是之前和之后：

[![mbtexture.jpg](../Images/193d83189ac21520a59a3297f098778e.png)](https://i.stack.imgur.com/YEXlF.jpg)
[（来源：[awforsythe.com](http://awforsythe.com/i/mbtexture.jpg)）]

从右侧的特写可以看出，当 MotionBuilder 被要求渲染其文件找不到的纹理时，它会加载这个小问号纹理并将其平铺在几何体上。我唯一的假设是 MotionBuilder 正在更改一些全局纹理坐标标量，例如，glTexCoord2f(0.5, 1.0) 将被解释为 (50.0, 100.0)。OpenGL中有这样的功能吗？知道我需要修改什么以保留我输入的纹理坐标吗？

* * *

自从输入上述内容并进行了一些研究后，我发现有一个用于此效果的 GL_TEXTURE 矩阵。整洁的！事实上，当我最初得到这个矩阵的值时，它是好的 ol' 单位矩阵：

```
 1  0  0  0
 0  1  0  0
 0  0  1  0
 0  0  0  1 
```

当我在 MotionBuilder 捏造我的纹理坐标后再次检查它时：

```
16  0  0  0
 0 16  0  0
 0  0  1  0
 0  0  0  1 
```

多有话说！但这里有一个小问题：如果我在自己绘制之前尝试显式设置纹理矩阵，无论 MotionBuilder 在做什么，似乎我的纹理坐标都没有效果，它只是对纹理的左下角进行采样（ 0.0, 0.0) 对于每个顶点。

这是尝试的修复，位于`RenderScene`上面发布的代码之后：

```
glMatrixMode(GL_TEXTURE);
glLoadIdentity(); 
```

我可以验证 GL_TEXTURE_MATRIX 的值现在是单位矩阵，但无论我在 glTexCoord2f 中指定什么坐标，它总是像每个顶点的坐标是 (0.0, 0.0) 一样绘制：

[![mbtexturematrix.jpg](../Images/68d21929cc032debcbe3bf7f276cb993.png)](https://i.stack.imgur.com/lA3Lm.jpg)
[（来源：[awforsythe.com](http://awforsythe.com/i/mbtexturematrix.jpg)）]

知道还有什么会影响 OpenGL 如何解释我的纹理坐标吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:57:01.950

啊哈！这些电话：

```
glMatrixMode(GL_TEXTURE);
glLoadIdentity(); 
```

~~...必须在`GL_TEXTURE_2D`启用后进行。~~

...应该通过将矩阵模式设置回`GL_MODELVIEW`. 显然，我在重置纹理矩阵（`glViewport`和/或`gluPerspective`？）后立即调用的某些函数会影响当前的矩阵堆栈。所以这些调用影响了纹理矩阵，导致我的纹理坐标以意想不到的方式被转换。

我想我现在明白了。

# javascript - js - 单击时交换图像

> ID：11996532
> 
> 赞同：1
> 
> 时间：2012-08-16T22:49:00.197
> 
> 标签：javascript, html

我正在尝试用另一个替换一个 div 并关闭其他 div：

JS

```
function imgToSWF1() {
document.getElementById('movie-con2 movie-con3 movie-con4').style.display = 'none';
document.getElementById('movie-con').style.display = 'block';
}
function imgToSWF2() {
document.getElementById('movie-con movie-con3 movie-con4').style.display = 'none';
document.getElementById('movie-con2').style.display = 'block';
}
function imgToSWF3() {
document.getElementById('movie-con movie-con2 movie-con4').style.display = 'none';    
document.getElementById('movie-con3').style.display = 'block';
}
function imgToSWF4() {
document.getElementById('movie-con movie-con2 movie-con3').style.display = 'none';
document.getElementById('movie-con4').style.display = 'block';
} 
```

HTML

```
<span onmouseover="src=imgToSWF1();"><div class="numbers">01</div></span>
<span onmouseover="src=imgToSWF2();"><div class="numbers">02</div></span>
<span onmouseover="src=imgToSWF3();"><div class="numbers">03</div></span>
<span onmouseover="src=imgToSWF4();"><div class="numbers">04</div></span> 
```

我似乎无法让它工作，我相信这样定位多个 ID 是不可能的？无论如何，任何建议都会粉碎 - 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:52:37.650

你绝对不能直接用 javascript 做到这一点。document.getElementById 函数只返回 DOM 中的单个元素。

一些文档可以在这里： [http](http://www.w3schools.com/jsref/met_doc_getelementbyid.asp) ://www.w3schools.com/jsref/met_doc_getelementbyid.asp https://developer.mozilla.org/en-US/docs/DOM/document.getElementById

如果您要使用像 jQuery 这样的工具包，您可以执行以下操作：

```
$('div[id^="movie-con"]').hide(); // hide everything
$('div["movie-con"' + index + "]").show(); // show the one we want 
```

由于您没有使用 jQuery，所以它并不那么容易。就像是：

```
var matches = document.getElementById("containerDiv").getElementsByTagName("img");
for( var i = 0; i < matches.length; i++ )
    matches[i].style.display = "none";
document.getElementById('movie-con' + index).style.display = "block"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:58:34.927

您必须使用 document.getElementById 一次定位一个元素，例如。`document.getElementById('movie-con2').style.display='none'; document.getElementById('movie-con3').style.display='none';` 等等，等等。您还可以使用 Jquery 兄弟选择器来显示或隐藏父标记中的所有兄弟元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T22:54:01.360

你是正确的，你不能向`document.getElementById()`. 相反，您可以使用数组单独获取它们。有很多方法可以完成您正在尝试做的事情。这是一种基于遍历元素数组以隐藏和隐藏所有元素的简单方法。

此方法希望您定义要隐藏在每个函数中的节点数组，因此并不理想。

```
// Example:
function imgToSWF1() {
  var nodes = ['movie-con2', 'movie-con3', 'movie-con4'];

  // Loop over and hide every node in the array
  for (var i=0; i<nodes.length; i++) {
    document.getElementById(nodes[i]).style.display = 'none';
  }
  document.getElementById('movie-con').style.display = 'block';
} 
```

## 更好的：

但是，这可以重构为一个函数。创建一个函数来接收要显示为参数的节点。隐藏其他。该数组应包含在任何情况下可能隐藏的所有节点，并在比函数更高的范围内定义。

```
// Array holds all nodes ids
var nodes = ['movie-con', 'movie-con2', 'movie-con3', 'movie-con4'];
// Function receives a node id which will be shown
function imageToSWF(nodeId) {
 // Loop over and hide every node in the array
  for (var i=0; i<nodes.length; i++) {
    document.getElementById(nodes[i]).style.display = 'none';
  }
  // And unhide/show the one you want, passed as an argument
  document.getElementById(nodeId).style.display = 'block';
} 
```

### 调用为：

```
<span onmouseover="imageToSWF('movie-con');"><div class="numbers">01</div></span>
<span onmouseover="imageToSWF('movie-con2');"><div class="numbers">02</div></span>
<span onmouseover="imageToSWF('movie-con3');"><div class="numbers">03</div></span>
<span onmouseover="imageToSWF('movie-con4');"><div class="numbers">04</div></span> 
```

# python - django db查询中的复杂排序

> ID：11996536
> 
> 赞同：5
> 
> 时间：2012-08-16T22:49:15.310
> 
> 标签：python, django, django-models

我的数据库中有以下条目：

```
`title`            `status`
Titanic            WIP
Avatar             WIP
Terminator         Complete
Abyss              Default 
```

我想按对象的状态对这些对象进行排序：默认，然后是 WIP，然后是完成。正确的顺序是：

```
Abyss / Default
Avatar / WIP
Titanic / WIP
Terminator / Complete 
```

我将如何进行以下数据库调用？

```
Title.objects.order_by(status='Default', status='WIP', status='Complete',title) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T02:53:42.023

要执行此查询，您可以使用 django 的`extra`：

```
titles = Title.objects.all()
ordered_query = titles.extra(select={
                'ordering':"(
                    case when status='Default' then 1 
                         when status='WIP' then 2
                         when status='Complete' then 3
                    end)"
                }).order_by('ordering', 'title') 
```

# java - 一台机器上出现“数据库锁定”错误，但另一台机器上一切正常

> ID：11996540
> 
> 赞同：1
> 
> 时间：2012-08-16T22:49:45.960
> 
> 标签：java, sqlite, database-locking

在 Java 上使用带有 JDBC 连接器的 SQLite，我的代码中经常出现这个“数据库锁定”错误。奇怪的是，我将整个程序压缩到其中的 jar 文件**在我的 Macbook 上运行良好，但在 Windows 机器上运行时出现此错误**。此外：

该程序只有一个线程，因此它可能不是并发问题。

该代码在给出错误之前对数据库进行了一些操作，所以我也不认为这是文件权限问题。

我没有详细介绍我的代码，因为我认为这没有必要。顺便准备这样做。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T20:32:57.957

我终于解决了。我卸载了最新版本的 JRE（Java Update 7，在安装 jdk7 时出现）并移回 jre 6 Update 33。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:08:06.507

确保您在数据库正在写入的位置具有写入权限。

当我们升级到具有 UAC 和管理员权限的 Windows 7 并写入诸如“程序文件{我们的安装位置}”之类的位置时，我们遇到了问题

# math - 在程序代码中实现三角形、锯齿和反锯齿公式

> ID：11996541
> 
> 赞同：0
> 
> 时间：2012-08-16T22:49:49.787
> 
> 标签：math, trigonometry

我已经查看了这些波的公式，但我不知道如何实现它们。我能够计算出 SINE 和 SQUARE 波：

```
float x = note.frequency / AppSettings::sampleRate;
float theta_increment = 2.0f * M_PI * x;
float value = 0;

if(waveType == SINE){
    value = sin(theta_increment);
}
else if (waveType == SQUARE){
    value = sin(note.theta);
    value = (value > 0) - (value < 0);
} 
```

我尝试的公式是[基于这个例子](https://stackoverflow.com/a/3399925/393964)和wiki的解释：

```
square(t) = sgn(sin(2πt))

// this is how I tried to implement it
theta_increment - floor(theta_increment - 0.5f); 
```

但这会产生非常低的音调，并且频率变化似乎没有任何影响（无论如何我都听不到）。那么有人可以帮我实现锯齿和三角形吗？一些解释会非常有帮助，因为与正弦和平方不同，我不太了解这些公式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T04:27:25.273

德尔福代码。我希望公式很清楚。频率和幅度是一致的。

```
 w := 1.0;   // angular frequency
  for i := 0 to 999 do begin
    t := i * 2 * Pi / 400 - 3/2 * Pi; // just X-axis scale
    wt := w * t;
    f := wt / (2.0 * Pi); //frequency

    sn := sin(wt);                      // sine wave

    saw := 2.0 * (f - Floor(f)) - 1.0;  //sawtooth

    f := f + 0.25;
    tr := Abs(4 * (f - Floor(f + 0.5))) - 1.0;  //triangle

    Series1.AddXY(t, sn);
    Series2.AddXY(t, saw);
    Series3.AddXY(t, tr);
  end; 
```

结果：

![在此处输入图像描述](../Images/b12f63709c2483341cc9057f51a9a704.png)

# c# - YUI Compressor for .NET 的问题

> ID：11996543
> 
> 赞同：0
> 
> 时间：2012-08-16T22:50:19.083
> 
> 标签：c#, .net, yui, yui-compressor

我正在使用[http://yuicompressor.codeplex.com/](http://yuicompressor.codeplex.com/)上的 .NET 的 YUI Compressor 库 ，我在缩小 jQuery 插件文件时遇到了麻烦，因为它因语法错误而崩溃，我相信 YUI 认为代码中存在这些错误。在处理此类文件时，是否有我可能缺少的解决方法或选项？我的选择目前如下；

编码 = UTF-8

没有设置其他任何东西，所以我假设其余选项都有默认参数。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:16:27.440

我想我知道发生了什么。显然，这个插件使用了一个被 EcmaScript 视为保留字的标识符。我还没有找到哪个词打破了一切。但至少我现在有了一个起点。感谢大家的时间。

# regex - 为什么 perl 正则表达式 .* 无法识别空分隔记录中的 \n。$/="\0'

> ID：11996546
> 
> 赞同：2
> 
> 时间：2012-08-16T22:50:53.547
> 
> 标签：regex, perl, substitution

我正在尝试解析一些以`\x00`空值分隔的数据。我认为在一个`-pe/-ne`循环中，`$_`相当于`.*`在替换正则表达式的模式匹配端......但是正如我的示例所示，它们并不相同......

```
 #      ↓↓‾‾ works, but is not a regex
printf 'aaa\n\0bbb\n\0' | perl -ne 'BEGIN{ $/="\0"; }; s/$_/\"$.$&\"/ and print;' |xxd
printf 'aaa\n\0bbb\n\0' | perl -ne 'BEGIN{ $/="\0"; }; s/.*/\"$.$&\"/ and print;' |xxd
                                                  #      ↑↑__ gives un-expected output

# output                                          #      ↓       ↓ 
0000000: 2231 6161 610a 0022 2232 6262 620a 0022  "1aaa..""2bbb.."
0000000: 2231 6161 6122 0a00 2232 6262 6222 0a00  "1aaa".."2bbb"..
                                                  #    ↑       ↑ 
```

要获得一种`s/ / /`替代类型来识别完整的，需要`$_`什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T23:02:20.210

`.``\n`除非使用`/s`修饰符，否则不匹配。

```
printf 'aaa\n\0bbb\n\0' | perl -ne 'BEGIN{ $/="\0"; }; s/.*/\"$.$&\"/s and print;' |xxd 
```

或者，可以使用字符类代替`.`.

```
printf 'aaa\n\0bbb\n\0' | perl -ne 'BEGIN{ $/="\0"; }; s/[\s\S]*/\"$.$&\"/ and print;' |xxd 
```

在这里，`[\s\S]`匹配任何空格或非空格字符（换句话说，任何字符）。

# algorithm - 快速检测与祖先同级的相同节点

> ID：11996547
> 
> 赞同：3
> 
> 时间：2012-08-16T22:50:55.937
> 
> 标签：algorithm, optimization, language-agnostic, tree, tree-traversal

> 我正在尝试找到一种快速算法来识别包含相同数据的节点（A，B）对，这些节点（A，B）以这样的方式定位在树上，即**节点 A 作为祖先，节点 B OR B 是A 的祖先**。

以下面的树为例，其中颜色标识内容：

![示例树](../Images/3657775a78ac1ab7cbb154552d9216be.png)

*   **`n6`并且`n1`是匹配**的，因为`n1`是 的祖先`n6`。
*   **`n5`并且`n3`是匹配**的，因为`n3`是 的兄弟`n2`，它是 的祖先`n5`。
*   **`n3`并且`n7`**出于同样的原因**是匹配的。**
*   **`n5`并且`n7`不是匹配**项，因为`n7`既不是 的祖先`n5`，也不是 的祖先之一的兄弟姐妹`n5`。
*   **`n2`并且`n4`**出于同样的原因**不匹配。**

“规则检查器”的幼稚实现是微不足道的，但它需要多次遍历树（检查每个节点一次），但是我觉得我可以利用树的两个特殊属性来实现一些更好的解决方案. 有问题的两个属性是：

*   **我可以获得具有相同内容的所有节点的平面列表**（在上面的示例中，我会得到：`(n5, n3, n7)`, `(n1, n6)`, `(n2, n4)`.
*   **我的每个节点都存储对其父节点和所有子节点的引用**（可以递归地利用此属性，如链表）。

...但是尽管我坚信必须有一种快速的方法来找到匹配的节点，但我到目前为止还没有找到它。

我目前正在使用 python，但也欢迎使用其他不太开放的语言的伪代码或示例。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T02:49:40.497

我相信这是解决方案。在预先计算 dfs-visiting-time 成本 O(n) 之后，该解决方案需要 O(1) 来回答每个查询。

dfs 看起来像：

```
nowtime=0
def dfs(node):
    global nowtime
    nowtime+=1
    node.come_time=nowtime
    for i in node.sons:
        dfs(i)
    nowtime+=1
    node.leave_time=nowtime
dfs(root) 
```

然后，我们有：

B 是 A 的祖先，当且仅当我们有

**B.come_time < A.come_time**和**B.leave_time > A.leave_time**

我认为这是真的：

A 是 B 的兄弟姐妹的后代，**当且仅当**A 是 B 的直系父亲的后代。而且（感谢@mac）A 不是 B 的兄弟姐妹之一。而且A也不是B的后代。

所以我们可以检查：

**B.fa.come_time < A.come_time**和**B.fa.leave_time > A.leave_time**

和

**B.fa != A.fa**

总而言之，要回答一个查询，我们有：

```
def check(A,B):
    if B.come_time<A.come_time and B.leave_time>A.leave_time:
        return True
    if B.has_father() and A.has_father():
        if A.fa==B.fa:
            return False
        if B.fa.come_time<A.come_time and B.fa.leave_time>A.leave_time:
            return True
    return False 
```

该解决方案的关键思想是使用 dfs() 中的访问时间来检查节点 B 是否是另一个节点 A 的祖先。**[come_time, leave_time]**间隔正是节点保留在堆栈中的时间间隔。很容易验证在 dfs 过程中，祖先的访问时间间隔将包含其所有后代的时间间隔，因为它总是在堆栈中，而 dfs() 正在访问它的后代。

添加：

我们可以证明：

> A 是 B 的兄弟姐妹的后代，**当且仅当**A 是 B 的直系父亲的后代。而且（感谢@mac）A 不是 B 的兄弟姐妹之一。而且A也不是B的后代。

自从：

如果 A 是 B 的直系父亲的后代，那么 A 在以 B.fa 为根的子树中包含且仅包含：

1.  B.fa
2.  乙
3.  B的兄弟姐妹
4.  B的后代
5.  B的兄弟姐妹的后代

所以，如果 A 不是 1，不是 2，不是 3，不是 4，那么 A 一定是 5。

如果 A 不是 B 的直系父亲的后代，则 A 不在子树中。很明显，A 永远不可能是 B 的兄弟姐妹的后代，因为 B 的所有兄弟姐妹都在子树中。

# sql - t-sql 插入-选择-带参数

> ID：11996549
> 
> 赞同：2
> 
> 时间：2012-08-16T22:51:13.250
> 
> 标签：sql, sql-server, select, sql-insert

我有 4 张桌子。我们将在其中一张表中插入数据（表 A）。表 A 将接收来自表 B、C、D 的杂项数据以及一些未知的可变参数数据。

如何使用带有接收参数的 SELECT 设置 INSERT？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T22:55:01.083

像这样的东西？

```
Insert INTO TableA (col1, col2,col3,col4)
  SELECT b.col1, c.col2, d.col3, @myparam
  FROM TableB as b
  INNER JOIN TableC as c
    ON b.id = c.id
  INNER JOIN TableD as d
    on c.id = d.id 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T22:55:53.343

像这样的东西：

```
DECLARE @a int, @b int
SET @a = 5
SET @b = 7

INSERT INTO TableA(Column1, Column2)
SELECT SomeOtherColumn, @a
FROM TableB
UNION
SELECT YetAnotherColumn, @b
FROM TableC 
```

# perl - 尝试加载 Bugzilla 时出现 Perl 错误

> ID：11996550
> 
> 赞同：0
> 
> 时间：2012-08-16T22:51:30.833
> 
> 标签：perl, installation, bugzilla

我对 Perl 的了解为零，但我试图安装 Bugzilla，一切似乎都在进行，直到我去加载 Bugzilla，我得到了这个错误，然后是试图加载页面的 html。

```
dmake could not be found on the PATH. Please invoke it using the full pathname:

C:\Perl64\site\bin\dmake.exe

or put the Perl\site\bin directory on the PATH with:

path C:\Perl64\site\bin;%PATH% 
```

我尝试运行该命令并将路径名手动添加到路径环境变量中，但我仍然收到错误消息。这可能很简单，因为我没有将路径名正确放入 Path。

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:11:45.697

令我尴尬的是，重新启动计算机就可以了。我怀疑路径环境变量没有生效，所以需要重新启动来解决这个问题。

# shell - Jenkins：shell 脚本 - 创建目录访问被拒绝（Linux）

> ID：11996552
> 
> 赞同：1
> 
> 时间：2012-08-16T22:51:37.760
> 
> 标签：shell, jenkins

我尝试在 Jenkins 构建期间执行一个 shell 脚本，但是当我尝试创建一个新文件夹时，我得到一个：“访问被拒绝”。

我尝试在 shell 脚本中启动一个 php 脚本，但我也被拒绝访问

我从 .war 文件启动了 Jenkins。

我的问题是如何授予对执行写入特定文件夹的 shell 脚本或用户的访问权限？

*我不能把 chmod 放到这个文件夹的 777 上（太危险了）。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T22:58:16.567

简单的修复/破解是更改 Jenkins 尝试写入 777 的文件夹的权限。

`chmod 777 foldername`

从长远来看，我会弄清楚 Jenkins 以什么用户身份运行，或者将文件夹所有权更改为该用户，或者将 Jenkins 添加到文件夹权限所属的任何组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T17:22:19.617

我终于通过带有 curl 命令的 url 启动了我的脚本，并且效果很好。

这不是一个很好的解决问题的方法，但我没有找到任何其他解决方法；）

# serial-port - 什么字符代表串行通信的“Enter”？

> ID：11996553
> 
> 赞同：0
> 
> 时间：2012-08-16T22:51:51.830
> 
> 标签：serial-port, ascii, arduino

我正在尝试使用我的 Arduino 发送串行命令，但我不知道如何复制`Enter`密钥。我也试过`\r\n`了`\n`，但似乎都没有。

我已经尝试了 Arduino 功能`Serial.write()` `Serial.print()` `Serial.println()`，但这些功能也没有。

我可以使用什么来复制`Enter`密钥？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T22:57:12.747

尝试`\r`
它有 ASCII 0xD(13)，它被称为[回车](http://en.wikipedia.org/wiki/Carriage_return)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-11T06:06:20.653

通常，这取决于处理按键的应用程序。从键盘，典型的扫描代码 0x1C 被发送到应用程序的 Enter 键（和 0x9C 释放）。

[在 PuTTY（与此处](https://stackoverflow.com/questions/11997108/what-does-putty-send-when-i-press-enter-key)的 OP 问题相关）中，它仅发送 ASCII CR（回车）0x0D，即使在 Windows 机器上也是如此。

# c++ - 如何从一组已定义的描述符中动态构建新的 protobuf？

> ID：11996557
> 
> 赞同：29
> 
> 时间：2012-08-16T22:52:35.420
> 
> 标签：c++, dynamic, protocol-buffers

在我的服务器上，我们收到自我描述的消息（定义[在这里](https://developers.google.com/protocol-buffers/docs/techniques#self-description)......顺便说一句，这并不是那么容易，因为在 c++ 中没有任何“好的”例子）。

在这一点上，我从这些自我描述的消息中创建消息没有问题。我可以使用 FileDescriptorSet，遍历每个[FileDescriptorProto](https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.descriptor.pb#FileDescriptorProto)，将每个添加到 DescriptorPool（使用[BuildFile](https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.descriptor#DescriptorPool.BuildFile)，它也给了我每个定义的 FileDescriptor）。

从这里我可以创建在 FileDescriptorSet 中定义的任何消息，其中使用 DP 实例化的 DynamicMessageFactory 并调用[GetPrototype](https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.dynamic_message#DynamicMessageFactory.GetPrototype.details)（这很容易做到，因为我们的 SelfDescribedMessage 需要消息 full_name()，因此我们可以调用[FindMessageTypeByName](https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.descriptor#DescriptorPool.FindMessageTypeByName)方法DP，给我们正确编码的消息原型）。

问题是如何获取每个已定义的描述符或消息并动态构建一个“主”消息，其中包含所有已定义消息作为嵌套消息。这主要用于保存消息的当前状态。目前我们只是通过在服务器中实例化每条消息的一种类型来处理这个问题（以保持不同程序的中心状态）。但是当我们想要“保存”当前状态时，我们被迫将它们流式传输到[此处](https://developers.google.com/protocol-buffers/docs/techniques#streaming)定义的磁盘。它们一次流式传输一条消息（带有大小前缀）。我们希望有一条消息（一条来统治所有消息）而不是稳定的单独消息流。一旦解决，这可以用于其他事情（基于网络的共享状态，经过优化且易于序列化）

由于我们已经有了交叉链接和定义的描述符，人们会认为有一种简单的方法可以从那些已经定义的消息中构建“新”消息。到目前为止，解决方案已经暗示了我们。我们已经尝试创建自己的 DescriptorProto 并从我们已经定义的描述符中添加新的类型字段，但是迷路了（还没有深入研究这个）。我们还研究了可能将它们添加为扩展（目前未知如何这样做）。我们是否需要创建自己的[DescriptorDatabase](https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.descriptor_database#DescriptorDatabase)（目前也不知道怎么做）？

有什么见解吗？

* * *

BitBucket 上的链接[示例源](https://bitbucket.org/g19fanatic/prototest)。

* * *

希望这个解释会有所帮助。

我正在尝试从一组已定义的消息中动态构建消息。已经定义的消息集是通过使用官方 c++ protobuf 教程中解释（简要）的“自我描述”方法创建的（即这些消息以编译形式不可用）。这个新定义的消息需要在运行时创建。

已尝试对每条消息使用直接描述符并尝试构建 FileDescriptorProto。尝试查看 DatabaseDescriptor 方法。两者都没有运气。当前尝试将这些定义的消息作为扩展添加到另一条消息（即使在编译时这些定义的消息，并且它们的“描述符集”未被归类为扩展任何内容），这是示例代码开始的地方。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-04-17T01:17:54.940

你需要一个`protobuf::DynamicMessageFactory`：

```
{
  using namespace google;

  protobuf::DynamicMessageFactory dmf;
  protobuf::Message* actual_msg = dmf.GetPrototype(some_desc)->New();

  const protobuf::Reflection* refl = actual_msg->GetReflection();

  const protobuf::FieldDescriptor* fd = trip_desc->FindFieldByName("someField");
  refl->SetString(actual_msg, fd, "whee");

  ... 

  cout << actual_msg->DebugString() << endl;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-22T18:09:41.820

I was able to solve this problem by dynamically creating a .proto file and loading it with an [Importer](https://developers.google.com/protocol-buffers/docs/reference/cpp/google.protobuf.compiler.importer#Importer).

The only requirement is for each client to either send across its proto file (only needed at init... not during full execution). The server then saves each proto file to a temp directory. An alternative if possible is to just point the server to a central location that holds all of the needed proto files.

This was done by first using a DiskSourceTree to map actual path locations to in program virtual ones. Then building the .proto file to import every proto file that was sent across AND define an optional field in a 'master message'.

After the `master.proto` has been saved to disk, i Import it with the Importer. Now using the Importers DescriptorPool and a DynamicMessageFactory, I'm able to reliably generate the whole message under one message. I will be putting an example of what I am describing up later on tonight or tomorrow.

If anyone has any suggestions on how to make this process better or how to do it different, please say so.

I will be leaving this question unanswered up until the bounty is about to expire just in case someone else has a better solution.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-22T14:16:38.880

如何将所有消息序列化为字符串，并使主消息成为（字节）字符串序列，a la

```
message MessageSet
{
  required FileDescriptorSet proto_files = 1;
  repeated bytes serialized_sub_message = 2;
} 
```

# java - Java 获取引用 URI？

> ID：11996561
> 
> 赞同：9
> 
> 时间：2012-08-16T22:52:52.250
> 
> 标签：java, http, servlets

[我想要与getRequestURI()](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#getRequestURI%28%29)完全相同的方法，但我想在引用者上使用它。这可能吗？

我想`http://www.example.com/my/path?vars=true`变成`/my/path`

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-17T03:58:44.910

你想要这样的东西吗？

```
String refererURI = new URI(request.getHeader("referer")).getPath(); 
```

# passwords - 彩虹表的密码长度是多少？

> ID：11996564
> 
> 赞同：1
> 
> 时间：2012-08-16T22:53:19.350
> 
> 标签：passwords, password-protection, rainbowtable, rainbowattack

我的银行将我的密码限制为 14 个字符，我怀疑他们使用 MD5 或未加盐的 SHA 哈希进行加密。

是否有包含最多 14 个字符的所有可能散列的彩虹表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T22:57:16.410

这取决于使用的字符范围，但 10 个字符似乎是[此处下载](http://www.freerainbowtables.com/en/tables2/)的限制（完整字符范围较低）。

# c++ - C++ 访问冲突：TImage.Picture 为空

> ID：11996567
> 
> 赞同：0
> 
> 时间：2012-08-16T22:53:29.830
> 
> 标签：c++, c++builder, access-violation, timage

我最近在我的 c++-builder-project-settings 中进行了一些小的更改以分发构建的应用程序，但是现在似乎缺少某种初始化。

在我使用它之前（正常工作）：

```
TPngImage *img=new TPngImage;
img->LoadFromFile(pfad);
Image1->Picture->Assign(img); 
```

但是，突然我收到错误：访问违规...访问 0x0000000。我检查并注意到 Image1->Picture 为 Null。Image1 当然是每个设计师添加的 TImage-Object。我正在使用 embarcaderos XE2 16 c++-Builder。

有这个设置吗，或者你能告诉我，我必须做什么？我想到了 Image1->Picture=new TPicture(); 已经，但这也是 Null ......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T11:09:59.757

看来这是我的设置...
不知何故我搞砸了一些设置。

我导出了一个新项目的设置，复制了我的包含路径，用导出的设置覆盖了设置并插入了包含。

现在一切都恢复正常了。

# c# - 复选框 PropertyChanged 未触发

> ID：11996570
> 
> 赞同：1
> 
> 时间：2012-08-16T22:53:47.640
> 
> 标签：c#, wpf, data-binding, mvvm

我有一个 MVVM 应用程序正在运行并尝试在数据网格中绑定一个复选框，但 Propertychanged 事件只是没有触发。我已经在视图模型和基类上实现了 INotifypropertychanged，但该属性仍然没有触发并且复选框没有更新。我已经尝试了所有可能的方法，例如设置 updatesourcetrigger=explicit 或 propertychanged，但它确实不起作用。我可能做错了什么？我没有办法弄清楚。网格的数据上下文设置为绑定到 ObservableCollection 的 ListViewCollection。

```
 <DataGridCheckBoxColumn Header="Tier1" Binding="{Binding Tier1Check,Mode=TwoWay}"></DataGridCheckBoxColumn>
                    <DataGridCheckBoxColumn Header="Tier2" Binding="{Binding Tier2Check,Mode=TwoWay}"></DataGridCheckBoxColumn>
                    <DataGridCheckBoxColumn Header="Tier3" Binding="{Binding Tier3Check,Mode=TwoWay}"></DataGridCheckBoxColumn>
                    <DataGridCheckBoxColumn Header="DoNotUse" Binding="{Binding DoNotUseCheck,Mode=TwoWay}"></DataGridCheckBoxColumn>

                    <!--<DataGridCheckBoxColumn Header="Tier1" Binding="{Binding IsChecked}"  />
                    <DataGridCheckBoxColumn Header="Tier2" Binding="{Binding IsChecked}" />
                    <DataGridCheckBoxColumn Header="Tier3" Binding="{Binding IsChecked}"/>-->
            </DataGrid.Columns>
        </DataGrid> 
```

ViewModel...我有四个复选框，代码专门用于使它们互斥。

```
 public bool? Tier1Check
      {
          get
          {
              return Tier1Check;
          }

          set
          {
              Tier1Check = value;
              Tier2Check = false;
              Tier3Check = false;
              DoNotUseCheck = false;
              RaisePropertyChanged("Tier2Check");
              RaisePropertyChanged("Tier3Check");
              RaisePropertyChanged("Tier1Check");
              RaisePropertyChanged("DoNotUseCheck");
          }
      } 
```

# php - MySQL - 单个 DATETIME 还是单独的 DATE 和 TIME 列？

> ID：11996571
> 
> 赞同：3
> 
> 时间：2012-08-16T22:53:50.027
> 
> 标签：php, mysql

在我的应用程序中，我正在开发一种用于创建“提醒”的功能。

提醒具有日期和时间。在我的应用程序中，我有一个创建/编辑提醒的表单 - 它有两个单独的字段来输入此信息：

```
<input type="text" name="date"></input> <!-- datepicker plugin -->

<input type="text" name="time"></input> <!-- timepicker plugin --> 
```

现在，作为一项规则，每当我需要存储日期/时间时，我总是使用 DATETIME 列，但是这是我第一次必须存储用户输入的日期/时间。

我认为最好有单独的 DATE 和 TIME 列，因为将数据插入/检索到我的应用程序会更容易。例如，我不必组合来自两个输入字段的值来创建单个值以插入到数据库中。同样，我不必将单个值拆分为两个值以在编辑模式下填充表单字段。

但另一方面，如果我使用一列，查询表会不会更容易？你怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T22:56:59.593

您应该自下而上构建（数据库在底部）。不要考虑应用程序，只考虑数据库。现在，在数据库级别上什么是有意义的。约会时间。

因此，您需要在应用程序级别编写额外的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T22:56:37.050

请看

将 Timepicker 添加到 jQuery UI Datepicker

[http://trentrichardson.com/examples/timepicker/](http://trentrichardson.com/examples/timepicker/)

根据您的mysql格式转换您的日期时间并存储它

```
$mydate = strtotime($_POST['date']);
$myfinaldate = date("d-m-y", $mydate);

$mytime = strtotime($_POST['time']);
$myfinaltime = date("H:i:s", $mytime); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-10T20:37:16.747

如果您正在开发一个预约应用程序，并且一方面您需要知道为用户安排预约的日期和时间，另一方面，您需要将用户与医生的日程安排相匹配。您将医生的时间表保存在数据库中，并且您需要知道（除其他外）医生何时（在哪天）以及何时可用。让我们暂时忘记几天，首先关注时间安排……您需要制定一个可编程的时间表，以便如果您知道医生在特定日历年工作 6 个月。（Jan - Jun），他或她可能工作（9-5 M，W，Fr）和（10-3 T，Th）。周六和周日医生休息。因此，您开发了一个表格来保存每日时间表，其中包含 2 列来保存一周中每一天的每日开始时间和每日结束时间。总共 14 列和一个主键和可能的辅助键。所以现在是时候进行一些日期算术了（这是它变得毛茸茸的地方：-|...

你可以说我你的查询：（mySQL）

选择某某……

其中 form.theapptdatetime`doctorschedule_startime_tuesday`和`doctorschedule_endime_tuesday`

这将进行匹配以查看您的日期时间是否在您的医生计划开始时间和结束时间的日期范围内......但是如果您只需要时间怎么办？

如果时间值存储为日期时间，日期算术是否仍然有效？？？

换句话说，如果我有 01:00:00 作为我的医生计划开始时间，这是我的算术工作的合法日期值，还是将日期部分强加给我。

也许我应该将时间存储为 varchar，并将其转换为合适的日期时间值并在代码中执行算术而不是查询？？？？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T11:48:08.640

这不取决于您正在创建的系统。如果您想存储 2038 年以后的日期，我会将日期时间和时间分开存储。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-16T22:58:12.940

分隔列是不合逻辑的。您可以使用时间戳作为数据类型，并且可以使用 mktime 函数轻松解析日期和时间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-22T10:51:41.447

我想到了一个关于何时划分日期和时间的例子：

您可能希望拥有`DATE`唯一索引的一部分，以便用户每个日期只允许向某个表添加 1 条记录，但您仍然想知道`TIME`他添加了它，因此您保留`DATE`并`TIME`分开。

# ios - NSURLCache 是否删除过期的缓存响应？

> ID：11996572
> 
> 赞同：5
> 
> 时间：2012-08-16T22:53:50.547
> 
> 标签：ios, nsurlcache

Apple 从 iOS 5.0 开始支持磁盘缓存。我以前使用的是家庭解决方案，但我正在测试`NSURLCache`希望最终使用它，因为我过去曾看到过奇怪的行为。

我遇到的一个更令人困惑的问题是`cachedResponseForRequest:`返回过期的请求。我一直在通过在我正在使用的 iPhone 上设置时钟来进行测试。解析标头清楚地表明设备时间早于到期日期。

我愿意接受可能存在定期修剪过期请求的后台任务。我已经进行了测试，实际上我在等待查看请求是否“自然”过期，但事实并非如此。

*Apple 是否未能正确实现缓存失效？*

我正在使用[Charles](http://www.charlesproxy.com/)代理进行测试。这是一个[棘手的问题](https://stackoverflow.com/questions/1188587/cache-invalidation-is-there-a-general-solution)，我不羡慕任何必须实现缓存失效的人，但iOS现在应该是一个成熟的SDK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-12T13:15:16.853

有两种http缓存机制：过期和验证。
如果响应没有过期，客户端可以从缓存中提供它而不向服务器发出请求。
如果它已过期，则客户端可以使用`If-Match`或`If-Modified-Since`标头条目发出条件请求。
如果服务器以 响应`304 Not Modified`，则客户端可以使用缓存中的数据，即使它已过期。

有关更多详细信息，请查看[http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html](http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html)。

# php - php url查询没有索引的嵌套数组

> ID：11996573
> 
> 赞同：12
> 
> 时间：2012-08-16T22:53:50.517
> 
> 标签：php, arrays, function

我正在使用第三方 API，该 API 接收必须像这样编码的几个参数：

```
text[]=Hello%20World&text[]=How%20are%20you?&html[]=<p>Just%20fine,%20thank%20you</p> 
```

如您所见，此 API 可以接受多个文本参数，也可以接受 HTML（不在示例调用中）。

我已使用 http_build_query 为其他 API 正确构建查询字符串

```
$params['text'][] = 'Hello World';
$params['text'][] = 'How are you?';
$params['html'][] = '<p>Just fine, thank you</p>';

$http_query = http_build_query($params); 
```

这种方法的问题在于它将使用数字索引构建查询字符串：

`text[0]=Hello%20World&text[1]=How%20are%20you?&html[0]=<p>Just%20fine,%20thank%20you</p>`

不幸的是，我正在使用的 API 不喜欢数字索引并且失败了。

是否有任何 php 函数/类方法可以帮助我快速构建这样的查询？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-16T23:06:50.703

我不知道这样做的标准方法（我认为没有这种方法），但这是一个丑陋的解决方案：

由于`[]`由 编码`http_build_query`，您可以生成带有索引的字符串，然后替换它们。

```
preg_replace('/(%5B)\d+(%5D=)/i', '$1$2', http_build_query($params)); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-30T22:13:59.183

我非常同意 RiaD 的回答，但是您可能会在使用此代码时遇到一些问题（抱歉，由于缺乏代表，我不能只发表评论）。

首先，据我所知，[http_build_query](http://php.net/manual/en/function.http-build-query.php)返回一个 urlencode() 的字符串，这意味着您不会有 [ 和 ]，而是会有 %5B 和 %5D。

其次，PHP 的 PCRE 引擎将“[”字符识别为字符类的开头，而不仅仅是简单的“[”（[PCRE 元字符](http://www.php.net/manual/en/regexp.reference.meta.php "PCRE 元字符")）。这最终可能会用“[]”替换您请求中的所有数字。

你更有可能想要这样的东西：

```
preg_replace('/\%5B\d+\%5D/', '%5B%5D', http_build_query($params)); 
```

在这种情况下，您需要转义 % 字符，因为它们也具有特殊含义。如果您有一个带有实际括号而不是转义符的字符串，请尝试以下操作：

```
preg_replace('/\[\d+\]/', '[]', $http_query); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-08-16T23:04:43.327

似乎没有办法做到这一点`http_build_query`。对不起。但是在文档页面上，有人有这个：

```
function cr_post($a,$b=0,$c=0){
    if (!is_array($a)) return false;
    foreach ((array)$a as $k=>$v){
        if ($c) $k=$b."[]"; elseif (is_int($k)) $k=$b.$k;
        if (is_array($v)||is_object($v)) {
            $r[]=cr_post($v,$k,1);continue;
        }
        $r[]=urlencode($k)."=" .urlencode($v);    
    }
    return implode("&",$r);
}

$params['text'][] = 'Hello World';
$params['text'][] = 'How are you?';
$params['html'][] = '<p>Just fine, thank you</p>';

$str = cr_post($params);
echo $str; 
```

我没有测试过。如果它不起作用，那么你将不得不自己动手。也许您可以发布一个 github gist，以便其他人可以使用它！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-16T23:11:15.013

试试这个：

```
$params['text'][] = 'Hello World';
$params['text'][] = 'How are you?';
$params['html'][] = '<p>Just fine, thank you</p>';
foreach ($params as $key => $value) {
    foreach ($value as $key2 => $value2) {        
        $http_query.= $key . "[]=" . $value2 . "&";
    }
}
$http_query = substr($http_query, 0, strlen($http_query)-1); // remove the last '&'
$http_query = str_replace(" ", "%20", $http_query); // manually encode spaces
echo $http_query; 
```

# ruby-on-rails - Rails MVC 概念在实践中

> ID：11996583
> 
> 赞同：1
> 
> 时间：2012-08-16T22:55:17.007
> 
> 标签：ruby-on-rails, model-view-controller

我实际上并不是在问一个问题，而是关于如何编写代码以很好地适应 Rails MVC 模式的建议（或推荐）。希望rails老手或者熟悉MVC的人能给我一些反馈。

我有一个通过 ActiveResource 与 RESTful api 应用程序对话的网络应用程序。它可以使用 API 调用获取和更新内容。它完美地工作。但是，Web 应用程序没有任何模型。它的工作方式是当用户触发一个动作（索引、视图、编辑等）时，控制器将直接调用 REST api 来获取/更新数据。

我的问题是：**这样做是一种好习惯，还是应该在其中创建模型并填充数据而不是直接调用 api？**我想知道这是否只是对 MVC 的务实妥协。我刚刚开始使用 Rails（和 MVC），所以我愿意接受任何想法、评论或建议

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T22:54:15.297

这有点像第 22 条问题。（我确实写了一个很大的答案，但后来被删除了，因为它读起来太乏味了）

*如果您的意思是，*您可以在没有模型的情况下实现 MVC 模式，那么答案是否定的。M 表示型号。

*如果他们的意思是，*你可以在不使用模型的情况下使用 MVC，那么答案是“是”，但它不再是 MVC，你已经抹杀了**M** ie 模型。

我建议您详细阅读 MVC 模式，然后尝试了解您的应用程序实际尝试做什么。

如果您想了解设计模式，[http://c2.com/是一个非常好的地方。](http://c2.com/)

*   模型是表示数据或什至活动的对象，例如数据库表或什至某些车间生产机器过程。
*   视图是模型状态的某种形式的可视化。
*   控制器提供了更改模型状态的功能。

***现在在您的情况下（似乎）：***您确实有一个通过 api 传递的数据，所以我建议填充模型属性并将其传播。

还要考虑**MVC 中的务实妥协 以**基于实际而非理论考虑的方式明智和现实地处理事物。在 MVC 中省略 Model 的使用听起来不是一个好主意，它不再是 MVC。

**话虽如此**，从您的角度来看，您似乎是想说 Rails 不一定是严格的 MVC，因此为什么不使用您想要的方式，`:)` *但我建议保持 MVC 的完整性（并遵循纯粹的方法）。*

[http://c2.com/cgi/wiki?ModelViewController](http://c2.com/cgi/wiki?ModelViewController)

好读：杰夫阿特伍德： http: [//www.codinghorror.com/blog/2008/05/understanding-model-view-controller.html](http://www.codinghorror.com/blog/2008/05/understanding-model-view-controller.html)（随意跳过asp.net部分）

[https://stackoverflow.com/questions/1242908/in-english-what-really-is-model-view-controller](https://stackoverflow.com/questions/1242908/in-english-what-really-is-model-view-controller)

**总而言之，上面提到了所有** `:)`来源。

![在此处输入图像描述](../Images/ed737542c9991e825bcdea2338d92dc6.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:06:06.537

“模型由应用程序数据和业务规则组成”（维基百科）

模型本质上是本地数据库中的表。

如果您不存储任何数据，不验证任何数据，那么您就不需要模型。

如果你想清理你的代码，也许把一些函数放在帮助器或 /lib 中

# css - 扩展和缩小 div 中的文本 - 自动长度

> ID：11996591
> 
> 赞同：1
> 
> 时间：2012-08-16T22:55:45.973
> 
> 标签：css, html

我在一个页面中有一个在 CSS 中具有自动宽度和 30px 高度的 div。

当我放大窗口时，我希望该 div 显示更多单词并扩展文本，如果收回它会隐藏单词或一些字母，最后它会放 3 分......就像图片中所示：

我怎么能在 CSS 中这样做并且需要 JS ？？？

![在此处输入图像描述](../Images/1f3cf552e69f308b334cba6a1b140219.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:05:29.550

如果你有创意，你可以只用 css 来做这里是一个小提琴[http://jsfiddle.net/HZKMd/](http://jsfiddle.net/HZKMd/)

```
<div id="wrapper">
    <div id="text">here is some text. here is some text. here is some text. here is some text. here is some text. here is some text. here is some text. here is some text. here is some text. here is some text. here is some text. here is some text. here is some text. here is some text.</div>
    <div id="ellipse"><strong>. . .</strong></div>
</div>​

    #wrapper
{
    position: relative;
}
#text
{
    height: 30px;
    line-height: 30px;
    overflow:hidden;
}
#ellipse
{
    height: 30px;
    line-height:30px;
    width:20px;
    float:left;
    position: absolute;
    top: 0;
    right: 0;
    z-index: 5;
    background: #fff;
    padding: 0 3px;
}​ 
```

或者这里是使用 jquery 隐藏和显示椭圆[http://jsfiddle.net/HZKMd/1/的替代版本](http://jsfiddle.net/HZKMd/1/)

添加这个css类

```
.inner {
    float: left;
}​ 
```

并包含 jquery 并添加这些功能

```
$(document).ready(function() {
    if ($('.inner').width() >= ($('#wrapper').width() - 30)) {
        $('#ellipse').show();
    }
});

$(window).resize(function() {
    if ($('.inner').width() >= ($('#wrapper').width() - 30)) {
        $('#ellipse').show();
    }
    else {
        $('#ellipse').hide();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:15:11.327

您可以使用该`text-overflow`属性：[https](https://developer.mozilla.org/en-US/docs/CSS/text-overflow) ://developer.mozilla.org/en-US/docs/CSS/text-overflow 。

所以基本上它可能看起来像这样：http: [//jsfiddle.net/bbVD7/](http://jsfiddle.net/bbVD7/)。

# facebook - 是否有在移动设备上显示 Facebook 应用程序标签的解决方案？

> ID：11996593
> 
> 赞同：2
> 
> 时间：2012-08-16T22:55:51.240
> 
> 标签：facebook, facebook-timeline

当您将 Facebook 标签 URL 链接发送到移动设备时，您会收到以下响应“找不到您请求的页面” - 有没有人知道锻炼解决方案 - 可能使用允许显示的 fb 移动应用程序移动设备上的页面标签？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T08:18:15.530

我建议您提供 App Canvas URL 以向使用移动设备的用户显示应用程序的移动版本，而不是 Page Tab URL。请注意，如果用户在移动设备中访问 App Canvas URL，用户将在 facebook 应用设置中看到“Mobile Web URL”的内容，而用户在桌面浏览器中访问 App Canvas URL，则用户将查看“App Canvas URL”的内容。

1.  当用户在桌面浏览器中访问 App Canvas URL 时，只需重定向到页面标签 url
2.  当用户在移动设备中访问 App Canvas URL 时，Facebook 会将用户重定向到 Mobile Web URL，仅在 Mobile Web URL 中提供应用的移动版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T14:36:52.370

试试这个（从这里：[是否可以在移动设备上将 Facebook 应用程序显示为页面选项卡？](https://stackoverflow.com/questions/7220579/is-it-possible-to-show-a-facebook-app-as-a-page-tab-on-mobile-devices)）

```
https://www.facebook.com/fbpageurlname?sk=app_123403406338325&ref=ts 
```

将 &ref=ts 添加到 url 的末尾会阻止页面选项卡重定向到网站的移动版本。

另外，记得使用`/fbpageurlname?sk=app_APPID`而不是`/fbpageurlname/app_APPID`

否则，当您将 &ref=ts 添加到 url 的末尾时，您将收到一个找不到页面的错误

# javascript - 从表信息创建 url 的可点击行

> ID：11996596
> 
> 赞同：-2
> 
> 时间：2012-08-16T22:55:55.400
> 
> 标签：javascript, datatables

我有一个名称与它们的 url 对应的表

如果我单击该行，我想使用表中的信息来创建页面将转到的 url。

我正在使用数据表[http://www.datatables.net](http://www.datatables.net)，如果有人能指出我的代码或 api 那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:03:32.103

完整代码：文章逐步描述

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <title>Full Row Select Using jQuery</title>
  <script src="Scripts/jquery-1.4.2.min.js" type="text/javascript"></script>
  <style type="text/css">
    .Highlight
    {
      background-color: #dcfac9;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <table width="100%" border="1" cellpadding="0" cellspacing="0" id="link-table">
  <tr>
    <td><a href="http://www.yahoo.com/">http://www.yahoo.com/</a></td>
    <td>1</td>
    <td>2</td>
    <td>3</td>
  </tr>
  <tr>
    <td><a href="http://www.microsoft.com/">http://www.microsoft.com/</a></td>
    <td>4</td>
    <td>5</td>
    <td>6</td>
  </tr>
  <tr>
    <td><a href="http://imar.spaanjaars.com/">http://imar.spaanjaars.com/</a></td>
    <td>7</td>
    <td>8</td>
    <td>9</td>
  </tr>
  </table>
  <script type="text/javascript">
    $(function ()
    {
      // Hide the first cell for JavaScript enabled browsers.
      $('#link-table td:first-child').hide();

      // Apply a class on mouse over and remove it on mouse out.
      $('#link-table tr').hover(function ()
      {
        $(this).toggleClass('Highlight');
      });

      // Assign a click handler that grabs the URL 
      // from the first cell and redirects the user.
      $('#link-table tr').click(function ()
      {
        location.href = $(this).find('td a').attr('href');
      });
    });
  </script>
</body>
</html> 
```

以下是示例：

[http://imar.spaanjaars.com/549/how-do-i-make-a-full-table-row-clickable-using-jquery](http://imar.spaanjaars.com/549/how-do-i-make-a-full-table-row-clickable-using-jquery) http://imar.spaanjaars.com/312/how-do-i -make-a-full-table-row-clickable

# android - 更多的日食疯狂。如何在调试会话期间保持 logcat 视图不独占

> ID：11996608
> 
> 赞同：0
> 
> 时间：2012-08-16T22:57:01.283
> 
> 标签：android, eclipse

Eclipse 为我和其他人决定，如果 logcat 屏幕打开，那么当调试期间发生活动时，屏幕应该从调试切换到 logcat！感谢eclipse，那里有很好的用户友好逻辑。无需查看变量值，而不是在 logcat 中发生某些事情时。有谁知道如何防止这种情况发生。

更新：请注意，我从未请求或修改过与 logcat 相关的设置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:04:48.393

Preferences > Android > LogCat > 要么取消选中“Switch Perspective”或“Monitor logcat for messages from applications in workspace”，我想，以更适合您的工作流程为准。

# java - 授予对本地文件系统的 JApplet 读写访问权限

> ID：11996620
> 
> 赞同：0
> 
> 时间：2012-08-16T22:58:24.310
> 
> 标签：java, japplet

我有一个 JApplet，我想授予它读写打印等权限。此小程序仅从本地文件系统加载

我一直在阅读 Java 教程的控制小程序部分，并成功创建了一个策略文件，授予权限并指定代码库 [http://docs.oracle.com/javase/tutorial/security/tour1/index.html](http://docs.oracle.com/javase/tutorial/security/tour1/index.html)

为了让示例小程序成功写入本地系统，我必须将此行添加到 java.security 文件中。policy.url.3=file:/home/susanj/test/examplepolicy

问题是，如何通过代码实现相同的结果？

我假设您从 Policy 类开始 [http://docs.oracle.com/javase/6/docs/api/java/security/Policy.html#getInstance%28java.lang.String,%20java.security.Policy.Parameters %29](http://docs.oracle.com/javase/6/docs/api/java/security/Policy.html#getInstance%28java.lang.String,%20java.security.Policy.Parameters%29)

使用任一 getInstance 方法创建新策略

政策。**getInstance**（字符串类型，Policy.Parameters 参数）

政策。**getInstance**（字符串类型，Policy.Parameters 参数，Provider 提供者）

政策。**getInstance**（字符串类型，Policy.Parameters 参数，字符串提供程序）

并通过策略添加。**setPolicy** (Policy p) 方法然后使用Policy。**刷新**（）；

不幸的是，它似乎与 getInstance 方法分崩离析，事情开始变得相当混乱，我需要知道的是，我需要使用什么类型的策略参数作为参数来为我的小程序授予完全权限。

此小程序不是从 Internet 下载的，它是桌面应用程序的一部分，因此我可以在加载小程序之前以完全权限运行类/jar 文件。我假设您可以在小程序加载之前以这种方式设置策略文件？

我假设这实际上是正确的方法。

问候

布雷特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:14:18.927

如果您可以从沙箱中修改策略，那将是一个非常糟糕的主意……这听起来像是您正在尝试做的事情。

通读[设置策略文件以授予所需权限](http://docs.oracle.com/javase/tutorial/security/tour1/step2.html)。

您基本上需要先更新 Java 默认实例中的 Policy 文件，然后才能运行 Applet。

或者你可以签名。

*   [如何使用 RSA 签名证书对 Applet 进行签名](http://docs.oracle.com/javase/1.5.0/docs/guide/plugin/developer_guide/rsa_signing.html)
*   [是否可以免费签署 java 小程序？](https://stackoverflow.com/questions/1856552/is-is-possible-to-sign-a-java-applet-for-free)

# ruby-on-rails-3 - Ruby on Rails - 我们自己与 S3 服务资产

> ID：11996628
> 
> 赞同：0
> 
> 时间：2012-08-16T22:59:27.137
> 
> 标签：ruby-on-rails-3, amazon-s3

我们正在努力提高我们的网站性能。作为其中的一部分，我们计划做两件事：

1.  所有静态图像都通过 S3 提供。这样，图像的服务就没有 cookie。
2.  我们还有很多其他静态内容——javascript、CSS、我们的徽标等图像等。我们想知道提供这些内容的最佳方式是什么。

目前，它们只是存储在 assets 文件夹中。这很好也很简单，而且由于 Rails 将指纹附加到缓存中，我们当前的所有需求都得到了满足。然而，展望未来，我们意识到这不是提供这些图像（我们的徽标等）的正确方式。

那么提供此类内容的最佳方式是什么？

谢谢！林戈

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:03:41.623

如果您已经在使用 S3，那么我也会将所有这些文件放在 S3 上。然后使用 AWS CloudFront（内容交付网络），以便快速提供服务。CloudFront 的成本真的可以忽略不计。

您可以使用像[https://github.com/rumblelabs/asset_sync](https://github.com/rumblelabs/asset_sync)这样的 gem来简化管理。

# python - Python中的多处理同时限制运行进程的数量

> ID：11996632
> 
> 赞同：19
> 
> 时间：2012-08-16T22:59:53.657
> 
> 标签：python, multithreading, multiprocessing

我想同时运行 program.py 的多个实例，同时限制同时运行的实例数量（例如，限制在我的系统上可用的 CPU 内核数量）。例如，如果我有 10 个内核并且总共需要运行 1000 次 program.py，那么在任何给定时间只会创建并运行 10 个实例。

我尝试过使用多处理模块、多线程和使用队列，但在我看来，没有任何东西可以轻松实现。我遇到的最大问题是找到一种方法来限制同时运行的进程数量。这很重要，因为如果我一次创建 1000 个进程，它就相当于一个分叉炸弹。我不需要以编程方式从进程返回的结果（它们输出到磁盘），并且所有进程都彼此独立运行。

谁能给我建议或示例，说明如何在 python 甚至 bash 中实现它？我会发布到目前为止使用队列编写的代码，但它不能按预期工作，并且可能已经走错了路。

非常感谢。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-17T01:02:10.217

我知道您提到 Pool.map 方法对您没有多大意义。该地图只是为其提供工作源的一种简单方法，并且可以调用以应用于每个项目。地图的`func`可以是对给定参数进行实际工作的任何入口点。

如果这似乎不适合您，我在这里有一个关于使用生产者-消费者模式的非常详细的答案：[https ://stackoverflow.com/a/11196615/496445](https://stackoverflow.com/a/11196615/496445)

本质上，您创建了一个队列，并启动了 N 个工人。然后，您要么从主线程提供队列，要么创建一个提供队列的生产者进程。工作人员只是继续从队列中获取工作，并且发生的并发工作永远不会超过您启动的进程数。

您还可以选择对队列进行限制，以便在已经有太多未完成的工作时阻塞生产者，如果您还需要限制生产者消耗的速度和资源。

被调用的工作函数可以做任何你想做的事情。这可以是一些系统命令的包装器，或者它可以导入您的 python 库并运行主例程。那里有特定的进程管理系统，可让您设置配置以在有限的资源下运行任意可执行文件，但这只是执行此操作的基本 python 方法。

[我的另一个答案](https://stackoverflow.com/a/11196615/496445)的片段：

**基本池：**

```
from multiprocessing import Pool

def do_work(val):
    # could instantiate some other library class,
    # call out to the file system,
    # or do something simple right here.
    return "FOO: %s" % val

pool = Pool(4)
work = get_work_args()
results = pool.map(do_work, work) 
```

**使用流程管理器和生产者**

```
from multiprocessing import Process, Manager
import time
import itertools

def do_work(in_queue, out_list):
    while True:
        item = in_queue.get()

        # exit signal 
        if item == None:
            return

        # fake work
        time.sleep(.5)
        result = item

        out_list.append(result)

if __name__ == "__main__":
    num_workers = 4

    manager = Manager()
    results = manager.list()
    work = manager.Queue(num_workers)

    # start for workers    
    pool = []
    for i in xrange(num_workers):
        p = Process(target=do_work, args=(work, results))
        p.start()
        pool.append(p)

    # produce data
    # this could also be started in a producer process
    # instead of blocking
    iters = itertools.chain(get_work_args(), (None,)*num_workers)
    for item in iters:
        work.put(item)

    for p in pool:
        p.join()

    print results 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T00:18:00.793

您应该使用流程主管。一种方法是使用[Circus](https://github.com/mozilla-services/circus/)提供的 API “以编程方式”执行此操作，文档站点现在处于脱机状态，但我认为这只是一个暂时的问题，无论如何，您可以使用 Circus 来处理这个问题。另一种方法是使用[supervisord](http://supervisord.org)并将进程的参数设置为`numprocs`您拥有的核心数。

使用 Circus 的示例：

```
from circus import get_arbiter

arbiter = get_arbiter("myprogram", numprocesses=3)
try:
    arbiter.start()
finally:
    arbiter.stop() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-17T00:04:56.037

Bash 脚本而不是 Python，但我经常将它用于简单的并行处理：

```
#!/usr/bin/env bash
waitForNProcs()
{
 nprocs=$(pgrep -f $procName | wc -l)
 while [ $nprocs -gt $MAXPROCS ]; do
  sleep $SLEEPTIME
  nprocs=$(pgrep -f $procName | wc -l)
 done
}
SLEEPTIME=3
MAXPROCS=10
procName=myPython.py
for file in ./data/*.txt; do
 waitForNProcs
 ./$procName $file &
done 
```

或者对于非常简单的情况，另一个选项是 xargs 其中 P 设置 procs 的数量

```
find ./data/ | grep txt | xargs -P10 -I SUB ./myPython.py SUB 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-12-29T13:16:50.760

虽然关于使用 multiprocessing.pool 有很多答案，但关于如何使用 multiprocessing.Process 的代码片段并不多，这在内存使用问题时确实更有益。启动 1000 个进程会使 CPU 过载并杀死内存。如果每个进程及其数据管道都是内存密集型的，那么 OS 或 Python 本身就会限制并行进程的数量。我开发了以下代码来限制同时批量提交给 CPU 的作业数量。批量大小可以与 CPU 内核的数量成比例地缩放。在我的 Windows PC 中，每批作业的数量可以高达可用 CPU 课程的 4 倍。

```
import multiprocessing
def func_to_be_multiprocessed(q,data):
    q.put(('s'))
q = multiprocessing.Queue()
worker = []
for p in range(number_of_jobs):
    worker[p].append(multiprocessing.Process(target=func_to_be_multiprocessed, \
        args=(q,data)...))
num_cores = multiprocessing.cpu_count()
Scaling_factor_batch_jobs = 3.0
num_jobs_per_batch = num_cores * Scaling_factor_batch_jobs
num_of_batches = number_of_jobs // num_jobs_per_batch
for i_batch in range(num_of_batches):
    floor_job = i_batch * num_jobs_per_batch
    ceil_job  = floor_job + num_jobs_per_batch
    for p in worker[floor_job : ceil_job]:
                                         worker.start()
    for p in worker[floor_job : ceil_job]:
                                         worker.join()
for p in worker[ceil_job :]:
                           worker.start()
for p in worker[ceil_job :]:
                           worker.join()
for p in multiprocessing.active_children():
                           p.terminate()
result = []
for p in worker:
   result.append(q.get()) 
```

唯一的问题是，如果任何批次中的任何作业无法完成并导致挂起情况，则其余批次的作业将不会启动。因此，要处理的函数必须具有适当的错误处理例程。

# ruby-on-rails - 如何在多个域中使用控制器和视图

> ID：11996635
> 
> 赞同：0
> 
> 时间：2012-08-16T23:00:05.887
> 
> 标签：ruby-on-rails, ruby, modularity

这是我的问题。我需要使用相同的结构（在 RoR 中）生成许多站点并将它们托管在许多域上。域之间的唯一区别是存储在数据库中的模型数据和一个样式表.. 其他所有内容看起来和操作都相同。

我希望能够对其进行结构化，以便我只需要在一个地方更改“core.css”以使其更新每个单独的域。有什么方法可以使用 ruby​​ on rails 做到这一点？还是我应该使用更好的结构？

谢谢，

特洛伊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:17:57.157

不确定我是否完全理解。

我认为您希望多个域指向同一个项目。但是，您想根据域更改样式。

如果是这样，只需按域名命名您的 CSS 样式表。

```
<link rel="stylesheet" type="text/css" href="/assets/<%= request.request_uri %>.css" /> 
```

（那将是一种非常懒惰的方式）

我个人会在应用程序控制器中创建一个函数，以确定需要使用哪个样式表。然后输出@style 变量。

```
<link rel="stylesheet" type="text/css" href="/assets/<%= @style %>" /> 
```

# c# - 使用 WHERE IN 的 C# Dapper 查询

> ID：11996639
> 
> 赞同：2
> 
> 时间：2012-08-16T23:00:34.553
> 
> 标签：c#, dapper

我正在尝试执行这样的简洁查询：

```
string query = "select * from MyTable where someNumber in @Nums;";
...
connection.Query<ReturnObj>(query, new {Nums = nums}) 
```

如果 nums 为空，我会收到 MySql 语法错误。看起来 Dapper 将查询更改为如下所示：`WHERE 1 = 0)`所以我猜左边 ( 丢失了，这导致语法错误。是的，我意识到我可以在执行查询之前检查集合是否为空，但是我如果我不必这样做，我宁愿不这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2017-10-27T00:39:53.733

这是[Dapper](https://github.com/StackExchange/Dapper/issues/565)中的一个错误，它会创建一个对 MySQL Server 5.6（及更早版本）无效的 SQL 语句。

解决方法：

*   升级到 MySQL Server 5.7（接受 SQL Dapper 生成并返回预期结果）
*   如您所说，在执行查询之前检查集合是否为空

检查集合是否为空的一种变体（如果您有复杂的查询等，这可能很有用`NOT IN`）：

```
 var numsSql = nums.Any() ? "@Nums" : "(select null)";
  var query = $"select * from MyTable where someNumber in {numsSql};";
  conn.Query(query, new { Nums }); 
```

# c# - 如何在框架模型中发送事件？

> ID：11996641
> 
> 赞同：1
> 
> 时间：2012-08-16T23:00:51.347
> 
> 标签：c#, .net, unity3d

我们有一个框架模型和很多组件。几乎每个组件的几乎每个框架`Update()`函数都由框架模型控制器调用（比如 Unity3d，所有发生的事情都发生在一个线程中）。我们的组件会`"Targets"`改变其中的一些属性（例如位置）并希望提高其他组件`"Consumers"`（例如导弹）关于该事实的高度。

如果我们使用普通的 C# 事件模型并从中“引发”事件，`"Targets"`我们将得到非常长的`Update`调用。一个可以冻结我们所有基于框架的应用程序。所以我们不能像我们想要的那样真正使用 C# 事件。

我们做了什么：对于每个组件，我们通过将所有新数据推送到列表中的操作`"Consumer"`订阅事件，并且在更新调用时，我们遍历新数据列表并进行更新。`"Targets"``"Component"`

所以我的问题是：有没有办法概括这种方法（比如说，如果我们不仅希望目标影响我们的导弹，而且`"winds"`还有自己的传入数据（例如方向和温度））以使代码看起来不错？

有没有更正确的方式在框架模型中发送事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T08:34:06.967

如果我理解正确，那么您现在正在使用修改后的观察者模式。`Targets`然后是观察变化或发布者的*主题。*`Consumer`是声明通知方法的*观察者接口，订阅者。*如果您现在将观察者功能提取到一个单独的类中，其他类可以从中受益：

```
// info to send to all active missiles
public class MissileInfoMessage { }

// all missile classes should implement:
public interface MissileInfoSubscriber {
    void Notify (MissileInfoMessage msg);
}

public class MissileInfoBroker {
    List<MissileInfoSubscriber> missileInfoSubscribers;
    // targets, winds, airplanes calls this to get all missiles notified
    public void NotifyMissiles (MissileInfoMessage msg) {
        foreach (MissileInfoSubscriber missile in missileInfoSubscribers) {
            missile.Notify (msg);
        }
    }
    // missiles register when they got fired
    public void Register (MissileInfoSubscriber s) {
        missileInfoSubscribers.Add (s);
    }
    // and deregister if their job is done
    public void Unregister (MissileInfoSubscriber s) {
        missileInfoSubscribers.Remove (s);
    }
} 
```

# c# - EF 4.3 - 使用 TPT 仍然在基础上生成鉴别器字段

> ID：11996654
> 
> 赞同：1
> 
> 时间：2012-08-16T23:03:06.487
> 
> 标签：c#, ef-code-first, entity-framework-4.3

我在使用带有 Code First 的 EF 4.3 的 TPT 时遇到问题。我有以下课程：

```
public class Section
{
    public int Id { get; set; }

....

    public int SurveyId { get; set; }
    public virtual Survey Survey { get; set; }
}

public class IntroductionSection : Section
{
    public string ExampleText { get; set; }
}

public class QuestionSection : Section
{
    public int ExampleNumber { get; set; }
} 
```

使用 Fluent API 映射如下：

```
modelBuilder.Entity<Section>().Map(m => m.ToTable("Section"));
modelBuilder.Entity<Section>().HasRequired(m => m.Survey).WithMany(s => s.Sections).HasForeignKey(t => t.SurveyId);

modelBuilder.Entity<IntroductionSection>().Map(m => m.ToTable("Introduction"));
modelBuilder.Entity<QuestionSection>().Map(m => m.ToTable("Question")); 
```

一切似乎都运行良好，并且创建了三个表并填充了我在播种时期望的数据 - 唯一的问题是我仍然会像使用 TPH 一样在“Section”表中生成一个“Discriminator”字段。任何想法为什么会这样以及我如何摆脱它？

我尝试使用简单的 Animal/Cat/Dog 类型类来复制该问题，并且（令人讨厌）工作正常！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-20T07:58:42.177

我刚刚解决了我的问题。就我而言，我的模型有一个抽象基类。从基类继承的所有模型。

我一直使用 TPT，但数据库中突然出现了一个鉴别器。我花了一些时间试图摆脱鉴别器，最后注意到我有一个从带有鉴别器的模型派生的视图模型。

我在我的视图模型类中添加了 [NotMapped] 属性，并且不再有鉴别器了。

# actionscript-3 - 将变量添加到 flash 中的movieClip 以在 Flash builder 中使用

> ID：11996656
> 
> 赞同：1
> 
> 时间：2012-08-16T23:03:11.260
> 
> 标签：actionscript-3, flash, actionscript, flash-builder

我在 Flash Professional 中创建了一个带有多个矩形的 .fla。每个矩形都有不同的颜色，是一个单独的影片剪辑。然后我有一个包含所有矩形的影片剪辑 ( `RectContainer`)，并且我添加了“AS Linkage”，因此我可以在 Flash 构建器中创建这个容器类的实例（在我导出为 .swc 之后）。

我的问题是这个。如果我想为每个矩形添加一个变量，我如何从 Flash builder 中读取这个值。

例如，我想将字符串变量添加到带有单词 "red" 的红色矩形、带有 "blue" 的蓝色矩形等。

然后我想将侦听器添加到矩形，所以当它们被点击时，我可以获得被点击的矩形的颜色字符串。

```
for (var i:int = 0; i < rectContainer.numChildren; i++) {
    rectContainer.getChildAt(i).addEventListener(MouseEvent.MOUSE_DOWN, fl_Click);
}

function fl_click(event:MouseEvent):void
{
    event.currentTarget. ???
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:21:13.473

首先，在 Flash 中，您必须像图像一样设置名称。

![在此处输入图像描述](../Images/f4bd070fc5b38fbd699fb15384f4c9b1.png)

您可以像这样访问以下内容。

不使用 a`currentTarget`因为有潜在风险。如果子对象重叠，您的期望可能会有所不同。欲了解更多信息谷歌它。

正是您需要知道 和 之间的`target`区别`currentTarget`。这是非常重要的概念。

![在此处输入图像描述](../Images/889d99a78a2e937431ac4a4b79ddfb17.png)

* * *

```
public function Constructor()
{
   var container:RectContainer = new RectContainer();
   this.addEvent(container);
   var i:int = 0;
   while(i<container.numChildren)
   {
        container.addEventListener(MouseEvent.CLICK, onClick);
        i++;
   }
}

private function onClick(e:MouseEvent):void
{
    var mc:MovieClip = e.target as MovieClip;

    if(mc.name == "myCircle1")
    {

    }
    else if(mc.name == "myCircle2")
    {

    }
    else if(mc.name == "myCircle3")
    {

    }

    trace(mc.name);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:42:50.627

您应该为矩形创建一个自定义类以继承（或在自定义类中绘制矩形并完全放弃 .fla）。然后，您可以提供一个公共属性来保存您想要的值，创建任何常用函数，例如对颜色标签执行某些操作的单击处理程序。

```
public class MyRectangle extends Sprite {
    public var label:String;

    public function MyRectangle(){
        this.addEventListener(MouseEvent.CLICK, clickHandler,false,0,true);
    }

    private function clickHandler(e:MouseEvent):void {
        trace(label);
    }
} 
```

对于您的矩形，如果在 Flash IDE 中，在其符号属性中将您的自定义类作为基类。

# objective-c - 为什么我不能直接将 int 或 bool 传递给 OCMock 的“andReturnValue”参数？

> ID：11996659
> 
> 赞同：1
> 
> 时间：2012-08-16T23:03:27.680
> 
> 标签：objective-c, ocunit, ocmock

我试图做：

```
[[[mockQuestion stub] andReturnValue:YES] shouldNegate];
[[[mockQuestion stub] andReturnValue:123] randomNumberWithLimit]; 
```

但这给了我这个警告/错误“不兼容的整数指针转换将'BOOL'（又名'signed char'）发送到'NSValue *'类型的参数”

我能想出解决它的唯一方法是：

```
BOOL boolValue = YES;
int num = 123;

[[[mockQuestion stub] andReturnValue:OCMOCK_VALUE(boolValue)] shouldNegate];
[[[mockQuestion stub] andReturnValue:OCMOCK_VALUE(num)] randomNumberWithLimit]; 
```

但这让我的测试代码显得过于冗长。有没有办法在不需要设置变量的情况下内联完成这一切？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:11:28.033

您可以使用看起来像`(type){value}`. 这通常用于创建结构文字，但也适用于基本数据类型。这里的重要方面是这种类型的文字创建了一个可以处理的临时文件。这意味着您可以编写代码，例如

```
[[[mockQuestion stub] andReturnValue:OCMOCK_VALUE((BOOL){YES})] shouldNegate];
[[[mockQuestion stub] andReturnValue:OCMOCK_VALUE((int){123})] randomNumberWithLimit]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:12:58.703

该参数应该是一个对象指针。在这种情况下，它应该指向 NSValue 类的一个对象。

# android - Android Sherlock ActionBar 向上按钮

> ID：11996664
> 
> 赞同：12
> 
> 时间：2012-08-16T23:03:49.473
> 
> 标签：android, bitmap, actionbarsherlock

![在此处输入图像描述](../Images/fbf5b6c899e35df6c1e0a7ffc3ec305b.png)

在 Stream 附近有一个小箭头，单击时可将您带到上一个活动

我想在我的应用程序中做同样的事情，我用过

```
 getSupportActionBar().setDisplayHomeAsUpEnabled(true); 
```

我需要使用`onOptionsItemSelected`吗？

箭头出现了，但单击后什么也没有发生。

我的菜单中有两个项目，它们出现在我打电话的任何地方`OnCreateOptionsMenu`

这是我的项目代码，我只想在我的最后一个活动中出现，如何？

```
 <item 
android:id="@+id/bAbout"
android:title="About"
android:showAsAction="always"/> 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-16T23:09:41.600

是的，您必须实施`onOptionsItemSelected()`. 该按钮的 id 是`android.R.id.home`

```
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {

    case android.R.id.home:
         // Do whatever you want, e.g. finish()
         break;

    default:
        return super.onOptionsItemSelected(item);
    }
} 
```

> 我的菜单中有两个项目，它们出现在我调用 OnCreateOptionsMenu 的任何地方

我不确定这里的问题是什么。当然，您应该只`onCreateOptionsMenu()`在您想要的地方实现和扩充该菜单资源。删除`onCreateOptionsMenu()`不应该有这些选项的所有活动应该有效。

# sql-server - SQL Server 用户登录失败

> ID：11996668
> 
> 赞同：0
> 
> 时间：2012-08-16T23:04:42.853
> 
> 标签：sql-server, sql-server-2008

我在使用 SQL Server 登录时遇到了一个非常奇怪的问题。我们可以使用来自 SSMS 的凭据登录服务器而不会出现问题。我们还可以使用来自开发服务器的相同凭据登录；但是，当我们尝试从测试环境登录时，我们会收到登录失败消息。

*   我们通过目视检查和复制/粘贴尝试确认密码正确
*   我可以通过分析器查看所有登录尝试（失败和成功）
*   通过 SSMS 登录
*   从 DEV Web 环境登录
*   从 TEST Web 环境登录失败
*   DEV 和 TEST 中的连接字符串相同

我想到的前两件事要么是密码错误（例如用户错误），要么是我们遇到了端口/协议问题，但似乎已经排除了这些问题。

谁能想到它会这样失败的原因？

提前致谢！

黏土

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:12:11.280

您是否将数据库从一台服务器备份和还原到另一台服务器？我过去也遇到过类似的问题，这篇文章可能会有所帮助：

[http://sqlserverpedia.com/wiki/Missing_Object_Owners](http://sqlserverpedia.com/wiki/Missing_Object_Owners)

# android - 更改方向后，空意图返回到先前的 Activity

> ID：11996673
> 
> 赞同：0
> 
> 时间：2012-08-16T23:05:07.073
> 
> 标签：android, orientation, start-activity

我正面临这个奇怪的问题：我`startActivityForResult()`用来传递到下一个`Activity`. 在第二个中，`Activity`一切都很好，直到我开始更改手机方向，这在返回上一个时会导致一些问题`Activity`.. 似乎返回`Intent`的是**null**

我尝试使用`onSaveInstanceState()/onRestoreInstanceState()`但无法正常工作。

有任何想法吗？

**更新**

这是用于发回数据的代码**，如果我不改变方向，它可以正常工作**

```
// photosList is an ArrayList<String>
Intent resultIntent = new Intent();
resultIntent.putStringArrayListExtra("photos", photosList);
setResult(RESULT_OK, resultIntent); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:23:44.277

根据您的活动所做的事情，当您的方向改变时，您可能不需要重新加载您的活动。您可以将此添加到`<Activity>`AndroidManifest 的相应部分以禁用重新加载：

```
android:configChanges="screenOrientation" 
```

这实际上告诉设备您将自己处理配置更改，您可以通过回调来完成，或者如果您不关心方向更改，则可以忽略它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:32:32.670

好的，所以上面的答案在一定程度上有效，但你不应该做你正在做的事情`onStop`。您遇到的问题似乎来自您需要保存从调用活动中获得的额外内容。我将假设您发送的内容永远不会真正改变，并且您可以期望它始终发送相同数量的附加内容，但其中包含动态数据。

```
@Override
onSaveInstanceState(Bundle savedInstanceState) {
    super.onSaveInstanceState(savedInstanceState);
    Intent intent = getIntent();
    savedInstanceState.putStringArrayList("photos", intent.getStringArrayListExtra("some_string"));
} 
```

然后在 onCreate 你可以做这样的事情：

```
onCreate(Bundle savedInstanceState) {
    /*I assume you got stuff places so just fit it in somewhere nice*/
    Intent resultIntent = new Intent();
    if(savedInstanceState == null) {
        //we know here that this is the first call to the second Activity
        //So you can just put the Intent that was sent since we know it came from the calling Activity with the original stuff
        resultIntent = getIntent();
    } else {
    resultIntent.putStringArrayListExtra("photos", bundle.getStringArrayListExtra());  
    }  
} 
```

所以希望你明白我在那里做了什么。它本质上为您提供了一种方法来访问您需要在重新加载之后持久保存的任何内容。现在`setResult(RESULT_OK, resultIntent);`，如果定向问题从未存在，您通常可以在任何地方进行操作。因此，正如您看到的那样，必须覆盖您可能只需要的东西的代码更少。让我知道这是否有意义。哦，如果你这样做，不要添加任何东西来禁用方向:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-17T21:12:35.217

我有同样的问题。看来，如果您将结果代码设置为`Activity.RESULT_OK`(-1)，它会在 Android 更改方向时重置为 0。因此，您必须在某处重新创建您的意图并重置结果代码（可能在被覆盖的`finish()`方法中）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-09T04:51:43.050

> 当您更改方向时，Android 会重新创建您的活动

这可能是您面临的问题，尝试将数据存储到`Shared Preference`onCreate() 方法中并将值重新分配给您的变量。

您还可以尝试保存活动状态的方法`onsaveinstancestate()`。`onrestoreinstancestate()`

# c# - 服务应用程序不会继续运行

> ID：11996679
> 
> 赞同：3
> 
> 时间：2012-08-16T23:05:46.803
> 
> 标签：c#, windows, service

我正在构建一个应用程序监控服务来写入事件日志，这样我就可以大致了解计算机的使用频率。我可以安装该服务，当我尝试运行它时出现此错误：

“本地计算机上的应用程序监视器服务启动然后停止。某些服务如果没有工作会自动停止，例如性能日志和警报服务。”

我尝试了一个while循环，鼠标活动等等......但它一直在结束。关于我能做什么的任何想法？

```
 public ApplicationMonitor()
    {
        InitializeComponent();
        if (!System.Diagnostics.EventLog.SourceExists("Activity Usage"))
        {
            System.Diagnostics.EventLog.CreateEventSource("Activity Usage", "Computer Log");
        }

        eventLog1.Source = "Activity Usage";
        eventLog1.Log = "Computer Log";
    }

    protected override void OnStart(string[] args)
    {
        eventLog1.WriteEntry("In OnStart");
    }

    protected override void OnStop()
    {
        eventLog1.WriteEntry("In onStop.");
    }

    protected override void OnContinue()
    {
        eventLog1.WriteEntry("In OnContinue.");
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:08:43.243

因为没有活动线程。

您需要在服务的“OnStart”方法中启动执行轮询的线程。否则，当 OnStart 方法完成时，应用程序中没有活动线程，.Net CLR 将关闭应用程序。

即使线程只是每 30 秒进行一次线程睡眠，它也必须处于活动状态才能使应用程序保持打开状态。

# cocoa - 导致 CPU 使用率高的 Cocoa 约束

> ID：11996681
> 
> 赞同：14
> 
> 时间：2012-08-16T23:06:15.273
> 
> 标签：cocoa, nslayoutconstraint

我最近切换到`NSLayoutConstraint`我的应用程序，我突然注意到，在某些视图中，我的应用程序经常使用大约 20% 或更多的 CPU。正如我所说，它仅在某些视图出现在屏幕上并且仅在我切换到约束后才会发生。

通过运行时间分析器，我注意到`[NSView displayIfNeeded]`在这些视图中不断调用它，即使没有发生任何事情，也没有事件或用户交互。此外，如果我调整窗口大小，我可以找到 CPU 使用率降至正常值的某些配置。如果我将窗口恢复到原来的大小，CPU 使用率会再次增长并再次`[NSView displayIfNeeded]`被不断调用。

即使约束没有崩溃（控制台中没有不满足约束错误的迹象），似乎也有某些视图和大小的组合会不断刷新。

有没有人经历过这个？或者至少知道如何更好地跟踪问题？

经过一番尝试和错误后，我将其范围缩小到此视图![表格视图单元格](../Images/81a8877d0e97b94ca7326315599da5e0.png)

它是 TableView 中的自定义单元格。如果我用正常的单元格替换它，CPU 使用率就会恢复正常。我还检查了布局是否不明确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-03T13:32:43.263

这通常是由于约束的舍入问题而发生的。特别是如果您使用“等宽”约束。

![具有等宽约束的两个按钮](../Images/e0d4c0e981aa9e59034ea3236b4c0268.png)

类似问题的另一个原因是使用“容器中的中心”约束。这通常会导致舍入问题。

如果您使用了这些约束之一并降低它们的优先级，请检查您的约束。如果它们不适合，这允许忽略这些规则。或者更好的是，创建没有中心和相等宽度/高度约束的布局。

# apache - localhost:8080/solr/browse 给出延迟加载错误

> ID：11996682
> 
> 赞同：3
> 
> 时间：2012-08-16T23:06:24.710
> 
> 标签：apache, tomcat, solr, lucene

我是 Solr 的新手，刚刚在 CentOS 上安装了 Tomcat6 和 Solr 3.6.1。我设法从我的 MySQL 表中添加了一些数据，并使用 exampledoc 的 xml`http://localhost:8080/solr/update`来用示例数据填充索引。我正在使用的编辑`solrconfig.xml`版本`examplesdoc`

**问题：**当我转到 的浏览界面时`http://localhost:8080/solr/browse`，我在日志文件中收到以下错误。我不明白为什么会发生错误，有什么想法可以解决这个问题吗？

**错误：**

```
Aug 16, 2012 11:01:56 PM org.apache.solr.core.SolrCore execute
INFO: [] webapp=/solr path=/browse params={} hits=254 status=0 QTime=4 
Aug 16, 2012 11:01:56 PM org.apache.solr.common.SolrException log
SEVERE: org.apache.solr.common.SolrException: lazy loading error
    at org.apache.solr.core.SolrCore$LazyQueryResponseWriterWrapper.getWrappedWriter(SolrCore.java:1763)
    at org.apache.solr.core.SolrCore$LazyQueryResponseWriterWrapper.getContentType(SolrCore.java:1778)
    at org.apache.solr.servlet.SolrDispatchFilter.writeResponse(SolrDispatchFilter.java:338)
    at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:273)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:857)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:679)
Caused by: org.apache.solr.common.SolrException: Error loading class 'sol 
```

在我的**solrconfig.xml**中，我有`/browse`请求处理程序：

```
<requestHandler name="/browse" class="solr.SearchHandler">
 <lst name="defaults">
   <str name="echoParams">explicit</str>

   <!-- VelocityResponseWriter settings -->
   <str name="wt">velocity</str>

   <str name="v.template">browse</str>
   <str name="v.layout">layout</str>
   <str name="title">Solritas</str>

   <str name="df">text</str>
   <str name="defType">edismax</str>
   <str name="q.alt">*:*</str>
   <str name="rows">10</str>
   <str name="fl">*,score</str>
   <str name="mlt.qf">
     text^0.5 features^1.0 name^1.2 sku^1.5 id^10.0 manu^1.1 cat^1.4
   </str>
   <str name="mlt.fl">text,features,name,sku,id,manu,cat</str>
   <int name="mlt.count">3</int>

   <str name="qf">
      text^0.5 features^1.0 name^1.2 sku^1.5 id^10.0 manu^1.1 cat^1.4
   </str>

   <str name="facet">on</str>
   <str name="facet.field">cat</str>
   <str name="facet.field">manu_exact</str>
   <str name="facet.query">ipod</str>
   <str name="facet.query">GB</str>
   <str name="facet.mincount">1</str>
   <str name="facet.pivot">cat,inStock</str>
   <str name="facet.range.other">after</str>
   <str name="facet.range">price</str>
   <int name="f.price.facet.range.start">0</int>
   <int name="f.price.facet.range.end">600</int>
   <int name="f.price.facet.range.gap">50</int>
   <str name="facet.range">popularity</str>
   <int name="f.popularity.facet.range.start">0</int>
   <int name="f.popularity.facet.range.end">10</int>
   <int name="f.popularity.facet.range.gap">3</int>
   <str name="facet.range">manufacturedate_dt</str>
   <str name="f.manufacturedate_dt.facet.range.start">NOW/YEAR-10YEARS</str>
   <str name="f.manufacturedate_dt.facet.range.end">NOW</str>
   <str name="f.manufacturedate_dt.facet.range.gap">+1YEAR</str>
   <str name="f.manufacturedate_dt.facet.range.other">before</str>
   <str name="f.manufacturedate_dt.facet.range.other">after</str>

   <!-- Highlighting defaults -->
   <str name="hl">on</str>
   <str name="hl.fl">text features name</str>
   <str name="f.name.hl.fragsize">0</str>
   <str name="f.name.hl.alternateField">name</str>
 </lst>
 <arr name="last-components">
   <str>spellcheck</str>
 </arr>
 <!--
 <str name="url-scheme">httpx</str>
 -->
</requestHandler> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T09:40:14.667

对我来说，这看起来像是缺少图书馆。

查看[http://wiki.apache.org/solr/VelocityResponseWriter#Using_the_VelocityResponseWriter_in_Solr_Core](http://wiki.apache.org/solr/VelocityResponseWriter#Using_the_VelocityResponseWriter_in_Solr_Core)看看你有没有在正确的地方所有的图书馆。

# iphone - 如何在 iPhone 上启动应用程序时检查徽章编号

> ID：11996683
> 
> 赞同：1
> 
> 时间：2012-08-16T23:06:34.183
> 
> 标签：iphone, ios

如何检查我的应用程序是否有徽章编号。当我向用户发送推送通知时，它会在图标上添加一个“1”作为徽章编号。我想检查用户启动应用程序时是否有徽章编号并将他们引导到视图控制器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-10T16:33:22.763

我会适当地利用应用程序的`applicationIconBadgeNumber`属性`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`。

所以，要清楚：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {

     application.applicationIconBadgeNumber =  1; /*some number...*/

     //or to read the number

     int appIconBadge = application.applicationIconBadgeNumber;

} 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:25:52.930

我认为您需要在应用程序中自己跟踪它。您的代理应用程序：didFinishLaunchingWithOptions: 将在通知时调用，并且用户按下操作按钮并接收通知有效负载。

如果您的应用程序在前台运行，则代表 application:didReceiveRemoteNotification: 将被调用。在这种情况下，您可以拥有一个整数值并将其递增以跟踪您拥有的通知数量。它还接收通知有效负载。

或者，在对您的设计一无所知的情况下，您可以拥有一个 Web 服务，该应用程序可以查询该 Web 服务以确定您正在寻找的任何数量的项目，但这似乎要困难得多，并且取决于您正在使用的设计可能不可行.

参考：http: [//developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html#//apple_ref/doc/uid/TP40008194-CH103-SW1](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/IPhoneOSClientImp/IPhoneOSClientImp.html#//apple_ref/doc/uid/TP40008194-CH103-SW1)

# mysql - mysql 按内部查询字段排序

> ID：11996684
> 
> 赞同：1
> 
> 时间：2012-08-16T23:06:38.460
> 
> 标签：mysql, subquery

我的查询是：

```
select a from b where c in (
    select d from e where f in (
        select f from e where d=100)
    and e!=100 group by e order by count(e) desc
   )
) 
```

此查询将输出我想要的结果，但我想通过此子查询对其进行排序

```
select d from e where f in (
    select f from e where d=100)
and e!=100 group by e order by count(f) desc 
```

基本上我想按 count(f) 排序

我怎样才能实现主查询从子查询中获取 id 但它不会根据子查询对它们进行排序

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:17:50.367

从您添加的 SQL 中，我得出如下内容：

```
 SELECT e1.d
  FROM e e1,
       (SELECT *
          FROM e
         WHERE d = 100) e2
 WHERE e1.f = e2.f AND e1.e != 100
GROUP BY e1.e
ORDER BY COUNT (e2.f) 
```

# javascript - 如何将 Node.js 环境变量注入客户端 JavaScript？

> ID：11996687
> 
> 赞同：2
> 
> 时间：2012-08-16T23:06:53.657
> 
> 标签：javascript, node.js

在我们的项目中，我们在 Node.js 上托管了客户端 JavaScript。

该脚本使用来自服务器的另一个静态内容（类似于`http://host:port/static/content`）。我们不能使用本地路径，因为这个 JavaScript 可以注入不同的站点。

我们的开发、测试和生产环境有不同的主机和端口设置。所以我们必须为不同的环境手动硬编码这些属性。

解决此问题的最简单方法是在服务器端手动将 JavaScript 解析为字符串，同时为静态文件准备响应。

我认为这不是一个好主意。

对于这种情况，Node.js 中是否有任何内置机制？

PS对不起我的英语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T02:22:26.757

我在这里假设客户端代码是从一些动态生成的 HTML 调用的。

如果“配置”数据的数量相当少，您可以通过`data-*`生成的 HTML 中的属性传递它，例如`<body data-static="http://host:port/static/content">`，如果它更大，则可以通过内联`<script id="config" type="application/json">`元素传递。

这里的关键是避免动态生成仅用于表示*数据的**代码*（40 年前，Kernighan 和 Plauger 在*《编程风格的要素》中*写道，他们想知道典型计算机中心的日常活动有多少只是通过编译器输入参数）。使用解释性语言，代码/数据的区别很容易变得模糊，但值得在您的脑海中将它们分开。

 **PS 你的英语比我见过的大多数问题都要好。**

# ruby - 简单的 rest api 服务器将参数传递给 shell 脚本并在 shell 上执行它

> ID：11996689
> 
> 赞同：-4
> 
> 时间：2012-08-16T23:07:17.243
> 
> 标签：ruby, perl, api, sed, cgi

我只是想拥有一个休息 api 服务器，我可以调用它来通过 URL 更新文件，就是这样。

这是文件：

```
mytextfile:
       key1 = value1
       key2 = value2 
```

1.  在客户端上，将运行一个脚本，该脚本将一个或多个字符串发送到 API 服务器。
2.  例如，API 服务器将接收它们`/update.script?string1="blah"&string2="fun"`（假装其 url 编码）
3.  然后服务器应该解析这些字符串，然后调用 exec 函数，或者甚至在系统上执行一些 sed 命令来更新文件的另一个脚本

语言或实现并不重要。

寻找新鲜的想法。

所有建议表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T02:04:44.103

我不明白：您的问题/问题到底是什么？

我对*“使用 url 编码的参数从 cgi 脚本内部修改文件”*问题的方法是：

1.  选择一种你喜欢的语言并开始编码，在我的例子中是 Perl。

    ```
    #!/usr/bin/perl
    use strict; use warnings; 
    ```

2.  获取你所有的论点。我将在这里使用 Perl 的[CGI](http://search.cpan.org/~markstos/CGI.pm-3.60/lib/CGI.pm)模块：

    ```
    use CGI::Carp;
    use CGI;
    my $cgi = CGI->new;

    # assuming we don't have multivalued fields:
    my %arguments = $cgi->Values; # handles (almost) *all* decoding and splitting
    # validate arguments
    # send back CGI header to acknowledge the request
    # the server will make a HTTP header from that 
    ```

3.  现在要么用它们调用一个特殊的子程序/函数……</p>

    ```
    updateHandler(%arguments);
    ...;
    my $filename = 'path to yer file name.txt';
    sub updateHandler {
       my %arguments = @_;
       # open yer file, loop over yer arguments, whatever

       # read in file
       open my $fileIn, '<', $filename or die "Can't open file for reading";
       my @lines = <$fileIn>;
       close $fileIn;

       # open the file for writing, completely ignoring concurrency issues:
       open my $fileOut, '>', $filename or die "Can't open file for writing";

       # loop over all lines, make substitutions, and print it out
       foreach my $line (@lines) {
          # assuming a file format with key-value pairs
          # keys start at the first column
          # and are seperated from values by an '=',
          # surrounded by any number of whitespace characters
          my ($key, $value) = split /\s*=\s*/, $line, 2;

          $value = $arguments{$key} // $value;
          # you might want to make sure $value ends with a newline

          print $fileOut $key, " = ", $value;
       }
    } 
    ```

    请*不要使用*这个相当不安全和次优的代码！我只是写这个来证明这并不复杂。

4.  ……或者想办法将你的参数发送到另一个脚本（尽管 Perl 非常适合文件操作任务）。根据您需要的脚本输出，选择或命令之一`qw{}`，或者决定使用.`system``exec``open my $fh, '|-', $command``open`

5.  至于运行此脚本的服务器：Apache 对我来说看起来不错，除非您有非常特殊的需求（您自己的协议、单线程、低安全性、低性能），在这种情况下您可能想要编写自己的服务器。使用[HTTP::Daemon](http://search.cpan.org/~gaas/HTTP-Daemon-6.01/lib/HTTP/Daemon.pm)模块，您可以为一个简单的服务器管理 <50 行。

    使用 Apache 时，我强烈建议使用 mod_rewrite 将其`/path`放入`PATH_INFO`环境变量中。当使用一个脚本来表示您的整个 REST API 时，您可以使用`PATH_INFO`选择许多方法/子例程/函数之一。这也消除了在 URL 中命名脚本的需要。

    比如转网址

    ```
    http://example.com/rest/modify/filename?key1=value1 
    ```

    进入

    ```
    /cgi-bin/rest-handler.pl/modify/filename?key1=value1 
    ```

    在 Perl 脚本中，我们将`$ENV{PATH_INFO}`包含`/modify/filename`.

这有点以 Perl 为中心，但只需选择您熟悉的*任何语言并开始编码，利用您可以在途中使用的任何模块。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T03:20:07.487

我会使用更新的 Perl 框架，比如[Mojolicious](http://mojolicio.us)。如果我制作一个文件（`test.pl`）：

```
#!/usr/bin/env perl

use Mojolicious::Lite;
use Data::Dumper;

my $file = 'file.txt';

any '/' => sub {
  my $self = shift;
  my @params = $self->param;

  my $data = do $file;
  $data->{$_} = $self->param($_) for @params;

  open my $fh, '>', $file or die "Cannot open $file";

  local $Data::Dumper::Terse = 1;
  print $fh Dumper $data;

  $self->render( text => "File Updated\n" );
};

app->start; 
```

然后运行`morbo test.pl`

并访问`http://localhost:3000/?hello=world`（或运行`./test.pl get /?hello=world`）

然后我进去`file.txt`：

```
{
  'hello' => 'world'
} 
```

等等。

# mongodb - Golang/mgo：如何让 MongoDB 在字段中使用当前时间？

> ID：11996693
> 
> 赞同：17
> 
> 时间：2012-08-16T23:07:58.533
> 
> 标签：mongodb, go, mgo

我有这个结构与我正在使用的 MongoDB 集合的类型相匹配：

```
type AppInstance struct {
    Id bson.ObjectId "_id,omitempty"
    Url string
    Priority int
    LastSeen string
} 
```

我希望 LastSeen 字段保存与该特定应用程序的最后一次交互时间。因此，应用程序自己注册设置当前时间（作为字符串）。

我想要的是 Mongo 在插入时将其自己的当前时间动态设置到该字段中，就像 MySQL 的 NOW() 函数一样。

我有这个辅助功能：

```
func mongoNow() bson.JavaScript {
    return bson.JavaScript{Code: 
         "return (new Date()).ISODate('YYYY-MM-DD hh:mm:ss');"}
} 
```

我试过这个：

```
c := mongoSession.DB("myapp").C("instances")
rand.Seed(time.Now().UnixNano())
err := c.Insert(
   struct{Id, Serial, Priority, Url, LastSeen interface{}}{ 
      Id: bson.NewObjectId(), 
      Url: getInformedHost() + ":" + getRunningPortString(), 
      Priority: rand.Int(), 
      LastSeen: mongoNow() }
)
checkError(err, "Could not register on MongoDB server.", 3) 
```

LastSeen 字段被存储为脚本而不是评估：

```
[_id] => MongoId Object (
    [$id] => 502d6f984eaead30a134fa10
)
[id] => MongoId Object (
    [$id] => 502d6f98aa443e0ffd000001
)
[priority] => 1694546828
[url] => 127.0.0.1:8080
[lastseen] => MongoCode Object (
    [code] => (new Date()).ISODate('YYYY-MM-DD hh:mm:ss')
    [scope] => Array (
    )
) 
```

所以，我认为有几个问题：

首先，如何插入当前时间？

其次，我怎样才能得到一些 javascript 评估而不是插入？

第二个的答案可能足以回答第一个，但也可能不是。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-08-17T00:08:43.963

不要将时间存储为字符串。mgo 支持[time.Time](http://golang.org/pkg/time/#Time)，它就像`Date`Javascript 中的一个对象：

```
type Event struct {
    Id    bson.ObjectId "_id,omitempty"
    Which string
    Date  time.Time
} 
```

插入现在发生的事件：

```
e := Event{
    Which: "first event",
    Date: time.Now(),
}
c.Insert(e) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-10-25T08:56:15.460

在 Mongo 2.6 中，您可以使用[$currentDate](http://docs.mongodb.org/master/reference/operator/update/currentDate/#up._S_currentDate)运算符在本地完成此操作。

```
db.users.update( { _id: 1 }, {
   $currentDate: {
     lastModified: true,
     lastModifiedTS: { $type: "timestamp" }
   },
   $set: { status: "D" }
}) 
```

# php - 将 XML 结果保存到文档或数据库中

> ID：11996696
> 
> 赞同：-2
> 
> 时间：2012-08-16T23:08:18.390
> 
> 标签：php, xml, ajax, xml-parsing

我有一个将信息发送到 api 并以 XML 格式获取响应的表单。我需要知道记录/解析结果的最佳方式（文本文档或其他任何内容）。如果可能的话，我希望所有结果都保存到一个文档中，而不是每个结果的单个文档中。

我正在使用ajax post方法和需要结果代码的localproxy代码如下

```
<?php
$ch = curl_init(); 
curl_setopt ($ch, CURLOPT_URL, 'http://integrate.com/api/test.ashx'); 
curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, FALSE); 
curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6"); 
curl_setopt ($ch, CURLOPT_TIMEOUT, 60); 
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 0); 
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt ($ch, CURLOPT_POSTFIELDS, $_POST);
curl_setopt ($ch, CURLOPT_POST, 1);
$result = curl_exec ($ch);
curl_close($ch);

file_put_contents('mydata.xml', $result, FILE_APPEND);

die('<h1>Thanks!</h1>');

?> 
```

xml 数据采用以下格式

```
<result>
<success>0</success>
<leadid/>
<errors>
<error>Missing Field: </error>
</errors>
</result> 
```

文件被创建并且现在有内容，这是内容，这是一个错误

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN""http://www.w3.org/TR/html4/strict.dtd">

<HTML><HEAD><TITLE>Bad Request</TITLE>

<META HTTP-EQUIV="Content-Type" Content="text/html; charset=us-ascii"></HEAD>

<BODY><h2>Bad Request - Invalid Content Length</h2>

<hr><p>HTTP Error 400\. There is an invalid content length or chunk length in the request.</p>

</BODY></HTML> 
```

这是什么意思？api服务器不接受请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:46:01.277

至于解析xml，使用[`XML parser`](http://php.net/manual/en/book.xml.php)

要将结果保存在文件中，请将每个结果附加到您可以使用的文件末尾[`file_put_contents($filename, $data, FILE_APPEND)`](http://php.net/manual/en/function.file-put-contents.php)

例如

```
<?php
$ch = curl_init();
curl_setopt ($ch, CURLOPT_URL, 'http://integrate.com/api/test.ashx');
curl_setopt ($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt ($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.6) Gecko/20070725 Firefox/2.0.0.6");
curl_setopt ($ch, CURLOPT_TIMEOUT, 60);
curl_setopt ($ch, CURLOPT_FOLLOWLOCATION, 0);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
$result = curl_exec ($ch);
curl_close($ch);
file_put_contents('mydata.xml', $result, FILE_APPEND);
?> 
```

如果您需要发送发布请求，请添加：

```
curl_setopt ($ch, CURLOPT_POSTFIELDS, 'param=value&param=value'); // to be replace with valid query string
curl_setopt ($ch, CURLOPT_POST, 1); 
```

# windows - 如何让 Win64 C++ 控制台应用程序像服务一样运行，因为它控制其他可执行文件？

> ID：11996700
> 
> 赞同：0
> 
> 时间：2012-08-16T23:08:53.960
> 
> 标签：windows, winapi, windows-services

我有一系列 Win64 控制台应用程序，一个是“主”，另外 16 个是“从”。

这个逻辑的原始版本只有一个可执行文件，当使用命令行参数“init”启动时，它会初始化一个非常大的数据集（3gigs），然后坐在 Windows 消息泵上等待请求分析该大数据集的消息. 当需要对数据集进行分析时，启动同一个可执行文件并带有分析请求参数，新启动的可执行文件会找到自己已经初始化的实例的窗口句柄，并将分析请求和参数发送到已经初始化的实例通过Windows 消息 WM_COPYDATA。这就像一个单一的可执行架构的魅力。

但是，现在我有一个更强大的系统，我想同时运行多个分析可执行文件，每个都在不同的内核上。因此，我创建了一个新架构，其中有 16 个分析可执行文件充当充当“主”的管理器控制台应用程序的“从属”。（仅供参考，一个分析请求可能需要 0.5 到 4.0 秒 - 因此我希望一次运行多个。）

仍然使用 Windows 消息作为我的通信方式，使用 SendMessage() 会阻止调用者，直到消息被接收者处理。这不好，因为我希望同时处理这些消息。因此，我尝试使用异步 Windows 消息函数，例如 SendMessageCallback() 和 SendNotifyMessage()。它们要么失败，要么以阻塞方式执行，而不是同时执行。

更多的研究使我将“命名共享内存”作为我的可执行文件（本质上是内存映射文件）之间通信的一种方式。所以我设置了它，我的主人现在能够创建命名共享内存块，我所有的可执行文件都能够请求相同内存的视图，并且通过状态机处理命名共享内存中的数据，我主从之间有同步。

但是，我发现主人和奴隶似乎没有连续运行。

我仍在使用 master 的基本思想是通过保存分析参数的命令行启动的，该可执行文件使用命名共享内存设置以及所有从属的当前状态向已经运行的版本发送一条消息，然后一个可用的从机被选中，它的命名共享内存驻留状态机获取分析请求。

这部分工作正常。但是，从属设备似乎处于睡眠或其他休眠状态，因为我修改后的 Windows 消息循环似乎没有循环。

这是我当前的 Windows 消息处理循环的样子：

```
while (1) {
    int status = ::GetMessage(&msg, 0, 0, 0);
    if (status != 0) {
        if (status == -1) return -1
        ::DispatchMessage(&msg);
    } 
    else if (status == 0)
        break;
    HandleSharedMemoryDeliveredTasks(); // NOTE: checking Named Shared Memory
} 
```

除非收到 Windows 消息，否则不会触发在此循环内放置断点。

所以，我想知道如何让我的循环保持活动状态，以便继续检查命名共享内存而不必发送（阻塞）消息。

我知道我正在一个问题空间中操作，我应该将我的主从可执行文件转换为 Windows 服务。但是，我非常非常接近让这个工作（似乎），并且重写到 Windows 服务是我没有经验的领域。

此外，我在我的可执行文件中使用它来保持它们处于活动状态（但它似乎没有帮助）：

```
// during program init:
SetThreadExecutationState(ES_CONTINIOUS | ES_SYSTEM_REQUIRED | ES_AWAYMODE_REQUIRED); 
```

有什么建议可以在主设备设置状态机进行工作时异步“唤醒”从设备，并且在工作完成时让从设备“唤醒”主设备？

# java - java中的易失性和原子操作

> ID：11996702
> 
> 赞同：3
> 
> 时间：2012-08-16T23:09:25.987
> 
> 标签：java, atomic, volatile

我已阅读有关 Java 原子操作的文章，但仍有一些疑问需要澄清：

```
int volatile num;
public void doSomething() {
  num = 10;  // write operation
  System.out.println(num)   // read
  num = 20;  // write
  System.out.println(num);  // read
} 
```

所以我对 1 种方法做了 wrwr 4 操作，它们是原子操作吗？如果多个线程同时调用 doSomething() 方法会发生什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T00:20:58.137

如果没有线程会看到中间状态，则操作是原子的，即操作将完全完成或根本没有完成。

读取一个 int 字段是一个原子操作，即一次读取所有 32 位。编写一个 int 字段也是原子的，该字段要么已被完全写入，要么根本没有。

但是，doSomething() 方法不是原子的；当方法正在执行时，一个线程可能会将 CPU 让给另一个线程，并且该线程可能会看到一些（但不是全部）操作已被执行。

也就是说，如果线程 T1 和 T2 都执行 doSomething()，可能会发生以下情况：

```
T1: num = 10;
T2: num = 10;
T1: System.out.println(num); // prints 10
T1: num = 20;
T1: System.out.println(num); // prints 20
T2: System.out.println(num); // prints 20
T2: num = 20;
T2: System.out.println(num); // prints 20 
```

如果 doSomething() 是同步的，它的原子性将得到保证，而上述情况是不可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T00:22:15.423

[`volatile`](http://docs.oracle.com/javase/specs/jls/se7/html/jls-8.html#jls-8.3.1.4)确保如果您有一个线程 A 和一个线程 B，那么两者都会看到对该变量的任何更改。所以如果它在某个时候线程 A 改变了这个值，线程 B 可以在将来查看它。

原子操作确保所述操作的执行“一步到位”。这有点混乱，因为查看代码'x = 10;' 可能看起来是“一步”，但实际上需要 CPU 上的几个步骤。原子操作可以通过多种方式形成，其中一种是通过使用锁定[`synchronized`](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.1)：

*   volatile 关键字的承诺。
*   获取一个对象（或者静态方法的类）的锁，并且没有两个对象可以同时访问它。

正如您之前在评论中所问的那样，即使线程 A 在某个时间点执行了三个单独的原子步骤，线程 B 也有可能在这三个步骤的中间开始执行。为了确保对象的线程安全，所有三个步骤都必须组合在一起以像一个步骤一样运行。这是使用锁的部分原因。

需要注意的一个非常重要的事情是，如果你想确保你的对象永远不会被两个线程同时访问，那么你的所有方法都必须同步。您可以在对象上创建一个非同步方法，该方法将访问存储在对象中的值，但这会损害类的线程安全。

您可能对[`java.util.concurrent.atomic`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/package-tree.html)图书馆感兴趣。我也不是这些问题的专家，所以我会推荐一本推荐给我的书：[Java Concurrency in Practice](https://rads.stackoverflow.com/amzn/click/com/0321349601)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-16T23:51:17.203

对 volatile 变量的每个单独读取和写入都是原子的。这意味着线程在读取时不会看到 num 的值发生变化，但它仍然可以在每个语句之间发生变化。因此，一个线程`doSomething`在其他线程执行相同操作时运行，将打印一个 10 或 20，然后再打印一个 10 或 20。在所有线程完成调用后`doSomething`，num 的值将是 20。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-16T23:56:24.523

我的答案根据 Brian Roach 的评论进行了修改。

它是原子的，因为在这种情况下它是整数。

Volatile 只能在线程之间获取可见性，但不能是原子的。volatile 可以让你看到整数的变化，但不能让你看到变化中的积分。

例如，long 和 double 可能会导致意外的中间状态。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-31T06:15:30.770

***原子操作和同步：***

原子执行在单个任务单元中执行，不会受到其他执行的影响。多线程环境下需要原子操作，避免数据不规则。

如果我们正在读/写一个 int 值，那么它就是一个原子操作。但通常如果它在一个方法内，那么如果该方法不同步，许多线程可以访问它，这可能导致值不一致。但是，int++ 不是原子操作。因此，当一个线程读取它的值并将其加一时，另一个线程已经读取了导致错误结果的旧值。

为了解决数据不一致，我们必须确保对 count 的递增操作是原子的，我们可以使用同步来做到这一点，但 Java 5`java.util.concurrent.atomic`为 int 和 long 提供了包装类，可用于在不使用同步的情况下以原子方式实现这一点。

使用 int 可能会造成数据数据不一致，如下所示：

```
public class AtomicClass {

    public static void main(String[] args) throws InterruptedException {

        ThreardProcesing pt = new ThreardProcesing();
        Thread thread_1 = new Thread(pt, "thread_1");
        thread_1.start();
        Thread thread_2 = new Thread(pt, "thread_2");
        thread_2.start();
        thread_1.join();
        thread_2.join();
        System.out.println("Processing count=" + pt.getCount());
    }

}

class ThreardProcesing implements Runnable {
    private int count;

    @Override
    public void run() {
        for (int i = 1; i < 5; i++) {
            processSomething(i);
            count++;
        }
    }

    public int getCount() {
        return this.count;
    }

    private void processSomething(int i) {
        // processing some job
        try {
            Thread.sleep(i * 1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

} 
```

> **输出：**计数值在 5,6,7,8 之间变化

我们可以使用`java.util.concurrent.atomic`始终将计数值输出为 8 来解决此问题，因为该`AtomicInteger`方法`incrementAndGet()`以原子方式将当前值加一。如下图：

```
public class AtomicClass {

    public static void main(String[] args) throws InterruptedException {

        ThreardProcesing pt = new ThreardProcesing();
        Thread thread_1 = new Thread(pt, "thread_1");
        thread_1.start();
        Thread thread_2 = new Thread(pt, "thread_2");
        thread_2.start();
        thread_1.join();
        thread_2.join();
        System.out.println("Processing count=" + pt.getCount());
    }
}

class ThreardProcesing implements Runnable {
    private AtomicInteger count = new AtomicInteger();

    @Override
    public void run() {
        for (int i = 1; i < 5; i++) {
            processSomething(i);
            count.incrementAndGet();
        }
    }

    public int getCount() {
        return this.count.get();
    }

    private void processSomething(int i) {
        // processing some job
        try {
            Thread.sleep(i * 1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }

} 
```

资料来源：[java中的原子操作](http://www.journaldev.com/1095/atomicinteger-java)

# mobile - 与朋友组的移动应用程序

> ID：11996703
> 
> 赞同：0
> 
> 时间：2012-08-16T23:09:29.797
> 
> 标签：mobile, cordova, extjs

我想创建两种风格的移动应用程序。在完整版中，用户可以邀请好友加入他的群组，一旦好友接受邀请，好友将能够下载该应用程序的轻量级版本。将来，完整版应用程序用户可以向朋友发送通知，朋友可以回复。

必须有一些服务已经让这个邀请朋友和创建朋友组。我查找了几个平台 - Buddy (http://buddy.com) 和 Sencha.io (http://www.sencha.com/products/io/)

关于如何轻松制作此类应用程序的任何其他建议？
我更喜欢在 HTML5 中制作这个应用程序（可能使用 PhoneGap 和 jQuery Mobile）以使其跨平台。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-23T15:56:51.690

使用好友服务完成任务

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T01:17:59.850

以我自己的经验：

*   JQM & PG 对于某些应用程序来说工作得很好（足够）。
*   Sencha使用起来很痛苦。
*   对于通知，请使用 Urban Airship。

我可以提供更多建议，但你没有说你的应用程序会做什么。

# qt - QT C++ 等到特定时间执行函数

> ID：11996706
> 
> 赞同：0
> 
> 时间：2012-08-16T23:10:12.600
> 
> 标签：qt

我正在尝试创建一个包含任务列表的应用程序，并且每次都有截止日期，现在我想在达到截止日期后执行一个功能（显示一个弹出窗口）。

我有这个：

```
#ifndef TIMER_H
#define TIMER_H
#include <QWidget>
#include <QTimer>
#include <QtGui>
#include <QObject>

class Timer : public QWidget
{
    Q_OBJECT
public:
    Timer(QWidget * parent = 0);
    void setTimer(QString title, QString description, QDate date, QTime reminderTime);
public slots:
    void showWarning() {QString show = tit;
                        QPushButton * thanks = new QPushButton(QObject::tr("Thank you for reminding me!"));
                        show.append("\n");
                        show.append(des);
                        QMessageBox popup;
                        popup.setText(show);
                        popup.setWindowTitle("Calendar : Reminder");
                        popup.setDefaultButton(thanks);
                        popup.exec();
                       }
private:
    QString tit;
    QString des;
    QDateTime now;
    QDateTime timeoftheaction;
    QTimer *timer;
}; 
```

cpp文件：

```
#endif // TIMER_H
#include "timer.h"
#include <iostream>
using namespace std;

Timer::Timer(QWidget * parent)
    : QWidget(parent)
{
}

void Timer::setTimer(QString title, QString description, QDate date, QTime reminderTime)
{
    now.currentDateTime();
    timer = new QTimer;
    tit = title;
    des = description;
    timeoftheaction.setDate(date);
    timeoftheaction.setTime(reminderTime);
    connect(timer, SIGNAL(timeout()),this,SLOT(showWarning()));
    timer->start(now.secsTo(timeoftheaction)*1000);
} 
```

然而函数 showWarning 从未被调用......没有编译错误，函数 showWarning 完美运行（经过测试）

我认为错误在连接中，但我不确定......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:37:04.113

**简短的回答：**

改变：

```
now.currentDateTime(); 
```

到

```
now = QDateTime::currentDateTime(); 
```

**冗长的答案：**

[`currentDateTime()`](http://qt-project.org/doc/qt-4.8/qdatetime.html#currentDateTime)是一个静态函数，它实际上不会更改现有对象，而是返回一个新`QDataTime`对象。尽管您将其作为成员函数调用，但它仍被称为静态函数，并且您的对象完好无损，这仍然是无效的。

您稍后`secsTo()`对无效数据时间的调用可能会给您一个负数或非常大的数字，该数字要么已经过去（永远不会触发），要么在未来很晚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T18:07:47.400

这可能是一个更通用的解决方案。

```
#include <QThread>
#include <QTimer>
#include <QObject>

#include <map>

/**
*    Singleton to implement simple 'relative' timer.
*    Implements busy wait and also timeout-notifications (useful to monitor operations that could hang, etc).
*
*    If the whole application is stalled (e.g. when a new device is connected), and we only want to
*    wait for a period during which application was 'really' working (not just hanging waiting for OS)
*    - then ticks will be missed too. This way - it's should be possible to avoid unnecessary timeouts
*     that could happen if global time was measured (especially annoying on WINdows platforms)
*/
class RelativeTimer : public QObject
{
    Q_OBJECT

    typedef std::multimap <unsigned int, std::pair <QObject*, QString> > Notifications;

public:

    /**
    *    Call to busy-wait for number of ticks.
    */
    static void wait_num_of_ticks(unsigned int num_of_ticks_to_wait)
    {
        if(self.timer_id == 0)
        {
            qDebug("timer not initialised, call 'RelativeTimer::Init()'");
            return;
        }

        if(num_of_ticks_to_wait > 0)
        {
            unsigned long until = self.tick_counter + num_of_ticks_to_wait; // it's ok if it wraps around..
            while(self.tick_counter != until)
            {
                 QCoreApplication::processEvents(); // let others to their job..
                 // or comment above out and just busy wait..
            }
        }
    }

    /**
    *    Call to busy-wait until ms_to_wait have elapsed.
    *    If ms_to_wait is < tick period
    *    Interval will define 'tick' frequency (and accuracy).
    */
    static void wait_ms(unsigned int ms_to_wait)
    {
        wait_num_of_ticks(num_of_ticks_to_wait(ms_to_wait));
    }

    /**
    *    Call to schedule a notification after a given timeout.
    *    returns notification_id that can be used to cancel this notification.
    */
    static unsigned long notify_timeout_ms(unsigned int ms_to_wait,
                                           QObject *receiver,
                                           const char* method_name)
    {
        unsigned long ticks_to_wait = 0;
        if(receiver && method_name)
        {
            ticks_to_wait = num_of_ticks_to_wait(ms_to_wait);
            if(ticks_to_wait > 1)
            {
                ticks_to_wait += self.tick_counter;
                if(ticks_to_wait == 0) // avoid 0 - make it one tick more (to alow to see if successfully added this notif)
                {
                    ticks_to_wait = 1;
                }
                self.notifications.insert(std::make_pair(ticks_to_wait,
                                                         std::make_pair(receiver, method_name)));
                qDebug("added delayed call..");
            }
            else
            {
                QMetaObject::invokeMethod(receiver, method_name, Qt::QueuedConnection);
                ticks_to_wait = 0;
            }
        }
        return ticks_to_wait;
    }

    /**
    *    Call to cancel a notification with a given id.
    *    Specify name if there were more notification with the same id (scheduled for the same tick).
    *    returns true on successfull cancellation, false otherwise.
    */
    static bool cancel_timeout_notification(unsigned long notification_id, QString notification_name="")
    {
        bool cancelled = false;
        if(self.notifications.size())
        {
            std::pair<Notifications::iterator, Notifications::iterator> to_cancel = self.notifications.equal_range(notification_id);
            Notifications::iterator n = to_cancel.first;
            for( ;n != to_cancel.second; ++n)
            {
                if(notification_name.size()== 0 || n->second.second == notification_name)
                {
                    self.notifications.erase(n);
                    cancelled = true;
                    break;
                }
            }
        }
        return cancelled;
    }

    static const unsigned int default_tick_period_ms = 100;

    /**
    *    Call this method after event loop is created- to initiate (re-start) timer.
    *    tick period defines 'tick' frequency (and accuracy of the timer)
    *    (note on Windows that there's no point to go down below 100ms).
    */
    static void Init(unsigned int  tick_period_ms = default_tick_period_ms)
    {
        self.moveToThread(&self.thread);
        self.thread.start();

        while(!self.thread.isRunning());

        self.current_interval = tick_period_ms;

        // InitMe() should execute in the thread context..
        QMetaObject::invokeMethod(&self, "InitMe", Qt::QueuedConnection);
    }

private:

    /**
    *    Internal method to convert ms to number of ticks.
    */
    static unsigned int num_of_ticks_to_wait(unsigned int ms_to_wait)
    {
        if(ms_to_wait > self.current_interval)
        {
            if(ms_to_wait % self.current_interval)
            {
                // average it..
                ms_to_wait = ms_to_wait +  self.current_interval / 2;
            }
            ms_to_wait /= self.current_interval;
        }
        else
        {
            ms_to_wait = 0;
        }

        return ms_to_wait;
    }

    /**
    *    Internal method to handle tick. Increments counter and invokes notifications.
    */
    void timerEvent ( QTimerEvent* /*event*/ )
    {
        tick_counter++;

        if(notifications.size())
        {
            std::pair<Notifications::iterator, Notifications::iterator> to_notify = notifications.equal_range(tick_counter);
            Notifications::iterator n = to_notify.first;
            for( ;n != to_notify.second; ++n)
            {
                QMetaObject::invokeMethod(n->second.first,
                                          n->second.second.toStdString().c_str(),
                                          Qt::QueuedConnection);
            }
            notifications.erase(to_notify.first, to_notify.second);
        }
    }

private slots:
    /**
    *    Internal slot to initialize the timer. Should be called in this->timer context.
    */
    void InitMe()
    {
        if(timer_id != 0)
        {
            killTimer(timer_id);
            timer_id = 0;
        }

        tick_counter = 0;
        timer_id = self.startTimer(self.current_interval);
    }

private:
    RelativeTimer()
    {
    }

    ~RelativeTimer()
    {
        thread.quit();
        thread.wait();
    }

    QThread thread;
    Notifications notifications;
    int timer_id;
    unsigned int current_interval;
    unsigned long tick_counter;

    static RelativeTimer self; // implement it as a signleton.. Define it in your C file, e.g.:
                               //  RelativeTimer RelativeTimer::self;
}; 
```

可以像这样使用：

```
 CurrQObjectClass::OnTimeout()
 {
 // ...
 }

 CurrQObjectClass::SomeMethod()
 {

 RelativeTimer::notify_timeout_ms(5000, this, "OnTimeout");
 } 
```

但也适用于忙碌的等待：

```
RelativeTimer::wait_ms(2000); 
```

享受。

# sql-server-2008 - 检查 SQL Server 中的图像字段是否已更改

> ID：11996707
> 
> 赞同：1
> 
> 时间：2012-08-16T23:10:21.113
> 
> 标签：sql-server-2008, blob

我们有一个数据库，其中图像作为图像列类型存储在表中。我们希望定期启动一个进程，检查图像是否已更新。

该过程将：

1.  通过 HTTP 从源下载文件
2.  检查文件是否与db版本不同
3.  必要时更新数据库

我不确定如何进行第二步。我将如何检查文件是否不同？

编辑：

使用 检查图像大小的准确度如何`DATALENGTH`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T17:24:28.187

1.  将文件下载为`byte[]`数组
2.  从 SQL 服务器检索`DATALENGTH`BLOB 字段：
    *   `SELECT DATALENGTH(Content) AS ItemLength ...`
3.  比较两者。如果它们相等，则它们是相同的图像：
    *   `byte[].Length`== BlobLength ( `long`)

# iphone - MPMusicPlayerController 可以用来播放本地音频文件吗？

> ID：11996708
> 
> 赞同：0
> 
> 时间：2012-08-16T23:10:21.563
> 
> 标签：iphone, objective-c, ios, cocoa-touch, mpmusicplayercontroller

可`MPMusicPlayerController`用于播放本地音频文件，即在我的应用程序包中的一个，而不是在 iPod 中？我查看了文档和过去的帖子，但看起来不行。

如果不是，那么推荐的课程是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:28:01.527

我不相信，`MPMusicPlayerController`用于播放`MPMediaItems`和`MPMediaItemCollections`生成用户 iPod 库中的歌曲。

从文档：

> 媒体项目集合是来自 iPod 库的一组已排序的媒体项目（MPMediaItem 类的实例）。通常，您可以通过其 collections 属性从媒体查询中请求一个集合数组来使用此类。媒体查询在 MPMediaQuery 类参考中进行了描述。

`AVAudioPlayer`可能更适合您，这是一个如何使用`AVAudioPlayer`在您的应用程序包中播放文件的示例。

```
#import <AVFoundation/AVFoundation.h> 
```

一定要包括使用委托方法。

```
 AVAudioPlayer *data = [[AVAudioPlayer alloc] initWithContentsOfURL:[NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"nameOfSound" ofType:@"mp3"]] error:NULL];
    data.delegate = self;
    data.volume = 1.0;
    [data prepareToPlay];
    [data play]; 
```

# c# - 将一个 Using 块包装在另一个 Using 块中 - 是不是矫枉过正？

> ID：11996710
> 
> 赞同：3
> 
> 时间：2012-08-16T23:11:07.377
> 
> 标签：c#, using-statement

我的项目中有一段代码，我在另一个 Using 块中包装了一个 Using 块，我想知道这是一个好习惯还是只是矫枉过正（请注意，我知道这是一个非常简单的代码片段，它是仅用于说明目的）：

```
protected void Submit_Click(object sender, EventArgs e)
    {
        try
        {
            using (SqlConnection cn = new SqlConnection(ConfigurationManager.ConnectionStrings["RegConnectionString"].ConnectionString))
            {
                cn.Open();

                string cmdStr = "SELECT COUNT(*) FROM REGISTRATION WHERE UserName ='" + this.TextBoxUN.Text + "' ";
                using (SqlCommand selectUser = new SqlCommand(cmdStr, cn))
                {
                    int temp = Convert.ToInt32(selectUser.ExecuteScalar().ToString());

                    if (temp == 0)
                    {
                        string insCmd = "Insert INTO REGISTRATION (UserName, Password, EmailAddress, FullName, Country) VALUES (@UserName, @Password, @EmailAddress, @FullName, @Country)";
                        using (SqlCommand insertUser = new SqlCommand(insCmd, cn))
                        {
                            try
                            {
                                insertUser.Parameters.AddWithValue("@UserName", this.TextBoxUN.Text);
                                insertUser.Parameters.AddWithValue("@Password", this.TextBoxPass.Text);
                                insertUser.Parameters.AddWithValue("@EmailAddress", this.TextBoxEA.Text);
                                insertUser.Parameters.AddWithValue("@FullName", this.TextBoxFN.Text);
                                insertUser.Parameters.AddWithValue("@Country", this.DropDownListCountry.SelectedItem.ToString());

                                insertUser.ExecuteNonQuery();
                                Response.Redirect("~/Login.aspx");
                            }
                            catch (Exception ex)
                            {
                                Response.Write(ex.Message);
                            }
                        }
                    }
                    else
                    {
                        Response.Write("User already Exists in Database");
                    }
                }
            }
        }
        catch (Exception ex)
        {
            Response.Write(ex.Message);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-16T23:12:06.947

是的。好习惯。在尽可能小的范围内处理东西，否则你将把它留给 GC 一段时间后去做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:47:43.920

绝对可以嵌套`using`语句。每个`using`语句仅适用于一个对象，因此如果需要处理多个对象，请使用多个`using`语句。

此外，您可以通过在打开第二个命令之前关闭第一个命令来减少嵌套。

```
int temp;
using (SqlCommand selectUser = new SqlCommand(cmdStr, cn))
{
    temp = Convert.ToInt32(selectUser.ExecuteScalar().ToString());
}
if (temp == 0)
{
    string insCmd = ...;
    using (SqlCommand insertUser = new SqlCommand(insCmd, cn))
    {
        ...
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-17T01:27:25.893

我完全同意`using`在处理嵌套的一次性对象时必须使用语句。

但是，我建议对代码进行进一步更改。为了帮助您的代码具有可读性、可测试性和可维护性，使用函数组合是一个好主意。以下是我将如何更改代码的主体：

```
using (var cn = new SqlConnection(ConfigurationManager.ConnectionStrings["RegConnectionString"].ConnectionString))
{
    cn.Open();
    if (checkUserExists(cn, this.TextBoxUN.Text))
    {
        Response.Write("User already Exists in Database");
    }
    else
    {
        addUser(cn, this.TextBoxUN.Text, this.TextBoxPass.Text, this.TextBoxEA.Text, this.TextBoxFN.Text, this.DropDownListCountry.SelectedItem.ToString());
        Response.Redirect("~/Login.aspx");
    }
    cn.Close();
} 
```

这段代码更紧凑，更容易推理正在发生的事情。

在此代码之前，您需要定义`checkUserExists`和`addUser`lamdbas，如下所示：

```
Func<SqlConnection, string, bool> checkUserExists = (cn, un) =>
{
    var query = "SELECT COUNT(*) FROM REGISTRATION WHERE UserName = @UserName";
    using (var command = new SqlCommand(query, cn))
    {
        command.Parameters.AddWithValue("@UserName", un);
        return Convert.ToInt32(command.ExecuteScalar().ToString()) != 0;
    }
};

Action<SqlConnection, string, string, string, string, string> addUser = (cn, un, pw, e, fn, c) =>
{
    string query = "Insert INTO REGISTRATION (UserName, Password, EmailAddress, FullName, Country) VALUES (@UserName, @Password, @EmailAddress, @FullName, @Country)";
    using (var command = new SqlCommand(query, cn))
    {
        command.Parameters.AddWithValue("@UserName", un);
        command.Parameters.AddWithValue("@Password", pw);
        command.Parameters.AddWithValue("@EmailAddress", e);
        command.Parameters.AddWithValue("@FullName", fn);
        command.Parameters.AddWithValue("@Country", c);

        command.ExecuteNonQuery();
    }
}; 
```

每一个都非常简单明了，它们的意图很明确，很容易推理。

因为它们是 lambda，所以它们不会用不必要的方法阻塞你的类——它们都包含在一个方法中。漂亮，整洁。

当然，它们都使用`using`语句。

希望这可以帮助。

# php - Firebug 在 PHP 中取消设置我的会话

> ID：11996712
> 
> 赞同：0
> 
> 时间：2012-08-16T23:11:11.597
> 
> 标签：php, firebug

我正在使用在[http://stefangabos.ro/php-libraries/zebra-session/](http://stefangabos.ro/php-libraries/zebra-session/)中找到的 Zebra 会话类来处理我所有的 PHP 会话。我发现了一个问题，如果我打开了 Firebug，当我导航到站点中的另一个页面时，我会注销并且会话被丢弃。

我还安装了 addThis 工具栏。

否则，如果 Firebug 已关闭，会话将完美运行。

关于如何让会话与 Firebug 一起工作的任何建议？

# streaming - GStreamer UDP 发送/接收单线

> ID：11996715
> 
> 赞同：2
> 
> 时间：2012-08-16T23:11:24.130
> 
> 标签：streaming, udp, gstreamer

我正在尝试`v4l2src`使用 GStreamer 通过 UDP 流式传输。发送部分（显然）没问题，但接收部分缺少一些东西。

这些是实际的行：

发送： `gst-launch-0.10 -v gstrtpbin name=rtpbin v4l2src device=/dev/video0 ! 'video/x-raw-yuv, width=(int)320, height=(int)240, framerate=(fraction)15/1' ! rtpvrawpay ! rtpbin.send_rtp_sink_0 rtpbin.send_rtp_src_0 ! multiudpsink clients="127.0.0.1:9996" rtpbin.send_rtcp_src_0 ! multiudpsink clients="127.0.0.1:9997" sync=false async=false udpsrc port=10000 ! rtpbin.recv_rtcp_sink_0`

收到： `gst-launch-0.10 -v gstrtpbin name=rtpbin udpsrc caps="application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)RAW, sampling=(string)YUV, depth=(string)8, width=(string)320, height=(string)120, colorimetry=(string)SMPTE240M" port=9996 ! rtpbin.recv_rtp_sink_0 rtpbin. ! rtpvrawdepay ! video/x-raw-yuv,framerate=15/1 ! xvimagesink udpsrc port=9997 ! rtpbin.recv_rtcp_sink_0 rtpbin.send_rtcp_src_0 ! multiudpsink clients="127.0.0.1:10000" sync=false async=false`

我错过了什么？

问候

编辑：

一些帽子不见了，所以我添加了它们，现在接收器没有崩溃，只是空转而没有显示任何东西。

发送： `gst-launch-0.10 -v gstrtpbin name=rtpbin v4l2src device=/dev/video0 ! 'video/x-raw-yuv, width=(int)320, height=(int)240, framerate=(fraction)15/1' ! rtpvrawpay ! rtpbin.send_rtp_sink_0 rtpbin.send_rtp_src_0 ! multiudpsink clients="127.0.0.1:9996" rtpbin.send_rtcp_src_0 ! multiudpsink clients="127.0.0.1:9997" sync=false async=false udpsrc port=10000 ! rtpbin.recv_rtcp_sink_0`

收到： `gst-launch-0.10 -v gstrtpbin name=rtpbin udpsrc caps="application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)RAW, sampling=(string)YCbCr-4:2:0, depth=(string)8, width=(string)320, height=(string)240, colorimetry=(string)SMPTE240M, ssrc=(uint)956768427, payload=(int)96, clock-base=(uint)1415613946, seqnum-base=(uint)35008" port=9996 ! rtpbin.recv_rtp_sink_0 rtpbin. ! rtpvrawdepay ! video/x-raw-yuv,framerate=15/1 ! xvimagesink udpsrc port=9997 ! rtpbin.recv_rtcp_sink_0 rtpbin.send_rtcp_src_0 ! multiudpsink clients="127.0.0.1:10000" sync=false async=false`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T10:24:42.123

你犯的错误是你假设你的 v4l2src 会给出什么。如果你想要一个特定的帧率高度和宽度，你需要使用 videoscale 和 videorate 过滤器

```
gst-launch-0.10 -v gstrtpbin name=rtpbin v4l2src device=/dev/video0 ! videorate ! videoscale ! ffmpegcolorspace ! 'video/x-raw-yuv, width=(int)320, height=(int)240, framerate=(fraction)15/1' !  rtpvrawpay ! rtpbin.send_rtp_sink_0 rtpbin.send_rtp_src_0 ! multiudpsink clients="127.0.0.1:9996" rtpbin.send_rtcp_src_0 ! multiudpsink clients="127.0.0.1:9997" sync=false async=false udpsrc port=10000 ! rtpbin.recv_rtcp_sink_0 
```

现在，这将打印您需要在接收端使用的上限。例如。对我来说，这是打印出来的。/GstPipeline:pipeline0/GstRtpBin:rtpbin.GstGhostPad:send_rtp_src_0.GstProxyPad:proxypad2: caps = application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)RAW,采样=（字符串）YCbCr-4：4：4，深度=（字符串）8，宽度=（字符串）320，高度=（字符串）240，色度=（字符串）SMPTE240M，ssrc=（uint）1825678493，有效载荷= (int)96，时钟基数=(uint)4068866987，seqnum-base=(uint)24582

在接收器管道上使用它：

```
GST_DEBUG=2 gst-launch  udpsrc caps="application/x-rtp, media=(string)video, clock-rate=(int)90000, encoding-name=(string)RAW, sampling=(string)YCbCr-4:4:4, depth=(string)8, width=(string)320, height=(string)240, colorimetry=(string)SMPTE240M, ssrc=(uint)1825678493, payload=(int)96, clock-base=(uint)4068866987, seqnum-base=(uint)24582" port=9996 ! queue ! rtpvrawdepay  ! queue ! ffmpegcolorspace ! autovideosink 
```

这里的接收者无法知道确切的上限，因此必须从发送者端复制粘贴。如果您想要不同的采样，请在发件人上使用 ffmpegcolorspace 并在其后设置适当的上限。（除了宽度、高度和帧率）

上面的管道对我来说很好。请记住，每次运行 src 时，ssrc 和其他一些参数都会有所不同。

# asp.net-mvc - 验证 [MetadatType(typeof(myClass)] 中的多字段

> ID：11996719
> 
> 赞同：1
> 
> 时间：2012-08-16T23:11:41.170
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2

我有一个带有 [MetadataType(typeof(ThisEntityMetaData))] 和 [Bind(...)] 注释的模型类。我需要验证回发组合属性值和路由参数（viewType）。viewType 不是实体类的属性。到目前为止，我只能在动作的 [post] 中进行此验证。我想在实体类或 ThisEntityMetaData 类中进行此验证。我怎样才能做到这一点？谢谢。

```
 [HttpPost]
    [ActionName("Create")]
    [AcceptParameter(Name = "Save", Value = "Save")]
    [ValidateInput(false)]
    public ActionResult Create(int id, thisViewModel newViewModel,
        string cancel, enumViewType viewType)
    {
        /* code omitted */

        switch(viewType)
        {
        case enumViewType.OutAndNoReturn:
        case enumViewType.OutAndReturn:
            if(!thisEntity.Source.HasValue || !thisEntity.Reason.HasValue)
                ViewData["Message"] = "Source, Reason are required.";
            break;
        case enumViewType.DirectOut:
        case enumViewType.IndirectOut:
            if ((!thisEntity.Source.HasValue || !thisEntity.Reason.HasValue ||
                 !thisEntity.Desired.HasValue))
            {
                thisEntity.ShowOutBlock = true;
                ViewData["Message"] = "Source, Reason, Desired are required.";
                return View(thisEntity);
            }
            break;
        }

        /* code omitted */
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T05:11:09.497

> viewType 不是实体类的属性。

您可以使用真实的视图模型，而不是您命名为*视图模型*但实际上根本不是视图模型的东西：

```
[HttpPost]
[ActionName("Create")]
[AcceptParameter(Name = "Save", Value = "Save")]
[ValidateInput(false)]
public ActionResult Create(thisViewModel newViewModel)
{
    ...
} 
```

其中`thisViewModel`显然包含您需要的一切：

```
[MetadataType(typeof(ThisEntityMetaData))] 
public class thisViewModel
{
    public int Id { get; set; }
    public string Cancel { get; set; }
    public enumViewType ViewType { get; set; }

    ...
} 
```

现在，您`ThisEntityMetaData`可以在此视图模型中随意验证您想要的任何内容。

# javascript - 我的表单没有将访问者发送到正确的页面

> ID：11996721
> 
> 赞同：0
> 
> 时间：2012-08-16T23:11:49.403
> 
> 标签：javascript, forms

页面在这里：

[http://bluebeam.com/us/trials/punch/](http://bluebeam.com/us/trials/punch/)

它应该在填写后将访问者发送到下载页面，但事实并非如此。他们在填写后仍会收到电子邮件确认，但不会将其发送到新页面。

我对 javascript 的了解不够，无法解决这个问题。

有谁知道为什么他们没有被重定向？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:29:37.127

嗯。我不知道这是否与 javascript 相关，但您的表单操作说它转到`index.asp?src=99`. 您可能希望放置一个不同的页面，上面写着下载并让您的代码下载，然后重定向回索引。

和/或您可能想要编辑您的问题并添加代码片段或其他内容以查明您可能认为问题所在的位置。

# javascript - JQuery $.getJSON() 不适用于回调

> ID：11996731
> 
> 赞同：1
> 
> 时间：2012-08-16T23:13:01.387
> 
> 标签：javascript, jquery, ajax, json

已解决 - 等待标记（stackoverflow 延迟）

萤火虫没有错误。在我无法弄清楚为什么它不起作用之前，我已经这样做了。`asyncFetchContent()`是从其他地方解雇的。`contentController`在别处创建。

```
function ContentController() {

}

ContentController.prototype.asyncFetchContent = function(){ 

         $.getJSON( '/content/TestContent.json', 
            function(data){
                contentController.displayContentCallback( data ); 
                } 
         );
}

ContentController.prototype.displayContentCallback = function( javascriptObject ){ 
    alert( "in callback");
    $( "#testID" ).html( javascriptObject.title );
} 
```

Firebug 将在定义处接受断点`displayContentCallback()`并停止，但一旦您越过，就会静默失败。`javascriptObject`是`undefined`。

提前致谢，

圭多

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:16:19.733

从[手册](http://api.jquery.com/jQuery.getJSON/)：

> 重要提示：从 jQuery 1.4 开始，如果 JSON 文件包含语法错误，请求通常会静默失败。因此，请避免频繁手动编辑 JSON 数据。JSON 是一种数据交换格式，其语法规则比 JavaScript 的对象文字表示法更严格。例如，在 JSON 中表示的所有字符串，无论是属性还是值，都必须用双引号括起来。有关 JSON 格式的详细信息，请参阅[http://json.org/](http://json.org/)。

您的 JSON 是否包含错误？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:18:08.973

contentController.displayContentCallback(数据); 不存在。a）它是 ContentController，而不是 contentController 和 b）由于您使用的是原型，它必须类似于

```
function ContentController() {

}

ContentController.prototype.asyncFetchContent = function(){ 

     $.getJSON( '/content/TestContent.json', 
        function(data){
            var x = new ContentController();
            x.displayContentCallback( data ); 
        } 
     );
}

ContentController.prototype.displayContentCallback = function( javascriptObject ){ 
    alert( "in callback");
    $( "#testID" ).html( javascriptObject.title );
} 
```

我很确定这应该可行。

# asp.net-membership - 未在生产环境中创建 MVC4 成员表

> ID：11996733
> 
> 赞同：1
> 
> 时间：2012-08-16T23:13:22.203
> 
> 标签：asp.net-membership, asp.net-mvc-4

我试图在我的 MVC4 应用程序中使用 ASP.NET 通用提供程序。除其他地方外，[本文](http://dotnetnsqlcorner.blogspot.com/2012/04/membership-in-aspnet-mvc-4.html)还介绍了第一次尝试注册用户时，表应如何在我的数据库中自动创建。

我在我的内部应用程序/数据库上进行了这项工作，但我使用了 asp.net Web 配置工具来创建我的第一个用户。当我将它部署到生产环境时，我尝试注册一个用户并遇到错误，指示`dbo.Applications`不存在，这是应该创建的表之一。

关于为什么没有创建这些表的任何想法？我已确保将`System.Web.Providers`dll 复制到 bin 文件夹中。我也确信我的应用程序可以管理我的数据库上的 CRUD 任务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T00:43:53.737

啊，呃。原来我没有为正在调用的应用程序池身份设置创建权限。羞愧地低着头

# python - 从递归 python 函数的返回值创建平面列表

> ID：11996735
> 
> 赞同：1
> 
> 时间：2012-08-16T23:13:30.290
> 
> 标签：python, recursion

我正在尝试使用 python 中的 dircmp 函数比较两个目录

```
def cmpdirs(dir_cmp):
    for sub_dcmp in dir_cmp.subdirs.values():
        cmpdirs(sub_dcmp)
    return dir_cmp.left_only, dir_cmp.right_only, dir_cmp.common_files

if __name__ == '__main__':
    dcmp = dircmp('dir1', 'dir2')
    result = list(cmpdirs(dcmp)) 
```

我试图得到如下结果：

```
([file1,file2],[file3,file4],[file5,file6]) 
```

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:20:43.733

以前从未使用过 dircmp ...但我认为这应该可以查看您的代码...

```
def cmpdirs(dir_cmp):
    # make copies of the comparison results
    left   = dir_cmp.left_only[:]
    right  = dir_cmp.righ_only[:]
    common = dir_cmp.common_files[:]

    for sub_dcmp in dir_cmp.subdirs.values():
        sub_left, sub_right, sub_common = cmpdirs(sub_dcmp)

        # join the childrens results
        left   += sub_left
        right  += sub_right
        common += sub_common

    # return the merged results
    return (left, right, common)

if __name__ == '__main__':
    dcmp   = dircmp('dir1', 'dir2')
    result = cmpdirs(dcmp) 
```

# jquery - 在 IE 中滚动时元素位置从相对更改为固定

> ID：11996736
> 
> 赞同：0
> 
> 时间：2012-08-16T23:13:31.870
> 
> 标签：jquery, internet-explorer, position, fixed

我有一个我自己无法解决的问题，我也找不到解决方案。我在 jQuery 中编写了一个适用于 Chrome 和 Firefox 的脚本，但它不适用于 IE（即使是最新的）。

一目了然的 HTML 看起来像这样::

```
<div id="ContentThatIsAbove"></div>
<div id="someContainer">
      <div id="bonmenu_info_container" style="float: left;">
           <div id="bonmenu_info"></div> 
           <div id="1_info"></div> 
           <div id="2_info"></div> 
           <div id="3_info"></div> 
      </div>
      <div id="bonmenu" style="float: right;">
           <div class="1"></div>
           <div class="2"></div>
           <div class="3"></div>
      </div>

</div> 
```

像这样的 jQuery 脚本：（使用'$j'而不是'$'）

```
<script type="text/javascript">
var $j = jQuery.noConflict();
$j(window).load(function() {
    var MenuOffsetY = $j("#bonmenu").offset().top;
    $j(window).scroll(function(){
        if($j("html").position().top < -MenuOffsetY && $j("html").position().top >-1400 )
        {
            $j("#bonmenu_info_container").css('position', 'fixed');
            $j("#bonmenu_info_container").css('top', '0');  
            $j("#bonmenu_info_container").css('margin-top', '10px');
            $j("#bonmenu_info_container").fadeIn();
        }
        else if($j("html").position().top >= -MenuOffsetY)
        {
            $j("#bonmenu_info_container").css('position', 'relative');
            $j("#bonmenu_info_container").css('top', '');
            $j("#bonmenu_info_container").fadeIn(); 
        }
        else
        {
            $j("#bonmenu_info_container").fadeOut();
        }
    });
    $j("#bonmenu_info_container").children().hide();
    $j("#bonmenu_info").show();

    //This part below works perfectly everywhere.    
    $j("#bonmenu").mouseover(function(){
        $j(this).children().each(function(){
            var infoId = "#"+jQuery(this).attr('class')+"_info";
            $j(this).mouseover(function(){
                $j("#bonmenu_info_container").children().hide();
                $j(infoId).show();              
            });
        }); 
    }).mouseleave(function(){   
        $j("#bonmenu_info_container").children().hide();
        $j("#bonmenu_info").show();
    });
});
</script> 
```

解释它应该如何工作：

我不希望#bonmenu_info_container 在滚动页面时消失在窗口顶部。这就是为什么在第一个 if statemant 中，我通过检查 html 的 position.top 值来检查 #bonmenu 是否在顶部消失。当该语句为真时，#bonmenu_info_container 的 css 位置值应从相对更改为固定，反之亦然。

您可以查看它在 Chrome/FF 上的工作方式：http: [//bonappetea.com/menu](http://bonappetea.com/menu/)

我在 Chrome/FF $('html').position().top 中注意到的内容在滚动时会发生变化，而在 IE 中则不会。你知道为什么吗？或者你有比我更好的解决方案吗？

我完全不知道如何处理这段代码，我不想从零开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:32:56.130

是的，它没有。但是`body`的位置发生了变化，因此您需要检查发生了什么变化并采取相应的措施。

```
var preScrollHtml = document.getElementsByTagName('html').item(0).scrollTop,
    preScrollBody = document.getElementsByTagName('body').item(0).scrollTop;

$j(window).scroll(function(){
   var scrolledHtml = document.getElementsByTagName('html').item(0).scrollTop,
       scrolledBody = document.getElementsByTagName('body').item(0).scrollTop;

   var scrolledVal = scrolledHtml != preScrollHtml ? scrolledHtml : scrolledBody;

   if(scrolledVal < -MenuOffsetY && scrolledVal >-1400 ) {}

   // here all your logic is

   // just before end of the handler reset values of these
   preScrollHtml = scrolledHtml;
   preScrollBody = scrolledBody;
} 
```

等等

# templates - 追溯应用 Netbeans 模板

> ID：11996739
> 
> 赞同：0
> 
> 时间：2012-08-16T23:14:03.350
> 
> 标签：templates, netbeans, ant

我有一个包含大量文件的项目，但我现在才获得许可。我已经设置了我的许可证模板，但是在创建此模板之后，我的项目中的所有文件都没有构建。有没有办法追溯应用此标头模板以自动提供我的项目许可证标头中的所有文件？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T07:08:24.610

不只是 Netbeans 没有，而是[maven-license-plugin](http://code.google.com/p/maven-license-plugin/)应该完全符合您的要求。

或者，您可以[使用 sed](https://stackoverflow.com/a/3784886/800764)。（这就是我最终做的。）

# api - flickr API，带有许可证过滤器的 getClusterPhotos

> ID：11996740
> 
> 赞同：0
> 
> 时间：2012-08-16T23:14:17.150
> 
> 标签：api, flickr

我正在通过这个 flickr API 收集照片：

描述：[http](http://www.flickr.com/services/api/flickr.tags.getClusterPhotos.html) ://www.flickr.com/services/api/flickr.tags.getClusterPhotos.html 示例：[http ://www.flickr.com/services/api/explore/flickr.tags.getClusterPhotos](http://www.flickr.com/services/api/explore/flickr.tags.getClusterPhotos)

我看不到在 API 查询中包含许可参数的选项，因此我返回了受版权保护的图像，这是我不想要的。我看到我可以通过在每个单独的图像上调用 flickr.photos.getInfo 来获取许可证信息，但这将非常耗时。是否有任何其他方法可以从具有特定许可证的标签集群中获取照片集合？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T08:12:57.610

许可证是其 api 中列出的参数之一：http: [//www.flickr.com/services/api/flickr.photos.search.html](http://www.flickr.com/services/api/flickr.photos.search.html)

我会尝试只使用他们返回中列出的结果中的 ID：http: [//www.flickr.com/services/api/flickr.photos.licenses.getInfo.html](http://www.flickr.com/services/api/flickr.photos.licenses.getInfo.html)

例如：&license=4

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-02T02:58:31.420

It may be better to use "flickr.photos.search" instead. You can search for a specific tag and license (there is no need to do a second call on each image).

[https://www.flickr.com/services/api/explore/flickr.photos.search](https://www.flickr.com/services/api/explore/flickr.photos.search)

# javascript - Ajax 响应文本

> ID：11996747
> 
> 赞同：0
> 
> 时间：2012-08-16T23:15:03.930
> 
> 标签：javascript, ajax

我正在尝试解析 ajax 响应文本，我从 ajax 响应文本中获取了整个表单，但是如何将此表单附加到按钮下方的现有页面，此 ajax 调用发生在此按钮单击时。

尝试使用 appendchild 添加此响应文本，但没有奏效，任何人都可以帮我解决这个问题。在这种情况下我的方法是正确的，如果是这样，我怎样才能从响应文本中获取此表单到我的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:21:37.303

最简单的方法是创建一个空占位符，然后在 ajax 成功时将响应文本放入其中

HTML

```
<div id="ajxresult"></div> 
```

javascript

```
document.getElementById("ajxresult").innerHTML = ajaxresponse; 
```

# cuda - cudaEventRecord 的位置和来自不同流的重叠操作

> ID：11996748
> 
> 赞同：0
> 
> 时间：2012-08-16T23:15:03.750
> 
> 标签：cuda, gpu, nvidia

我有两个任务。它们中的每一个都执行复制到设备 (D)、运行内核 (R) 和复制到主机 (H) 操作。我将副本复制到 task2 (D2) 的设备与 task1 (R1) 的运行内核。另外，我将task2（R2）的运行内核与复制到task1（H1）的主机重叠。

我还使用 cudaEventRecord 记录每个任务的 D、R、H ops 的开始和停止时间。

我有 GeForce GT 555M、CUDA 4.1 和 Fedora 16。

我有三种情况：

**场景 1：**我为每个任务使用一个流。我在操作之前/之后放置开始/停止事件。

**场景 2：**我为每个任务使用一个流。我将第二个重叠操作的开始事件放在第一个开始之前（即，将start *R1放在**start D2*之前，并将*start H1放在**start R2*之前）。

**场景 3：**我为每个任务使用两个流。我使用 cudaStreamWaitEvents 在这两个流之间进行同步。一个流用于 D 和 H（复制）操作，另一个用于 R op。我在操作之前/之后放置开始/停止事件。

*Scenario1*无法重叠 ops（D2-R1 和 R2-H1 都不能重叠），而*Scenario2*和*Scenario3*成功。***我的问题是：为什么 Scenerio1 失败了，而其他的成功了？***

对于每个场景，我都会测量执行 Task1 和 Task2 的总时间。运行 R1 和 R2 分别需要 5 ms。由于*Scenario1*无法重叠 ops，因此总时间比*Scenario 2 和 3*多 10ms 。

以下是场景的伪代码：

**场景 1（失败）：**任务 1 使用流 1，任务 2 使用流 2

```
start overall 

start D1 on stream1 
D1 on stream1
stop D1 on stream1 

start D2 on stream2
D2 on stream2
stop D2 on stream2

start R1 on stream1
R1 on stream1
stop R1 on stream1

start R2 on stream2
R2 on stream2
stop R2 on stream2

start H1 on stream1
H1 on stream1
stop H1 on stream1

start H2 on stream2
H2 on stream2
stop H2 on stream2

stop overall 
```

**场景2（成功）：** task1使用stream1，task2使用stream2，上移第二个重叠操作的开始事件。

```
start overall

start D1 on stream1
D1 on stream1
stop D1 on stream1 

start R1 on stream1 //moved-up

start D2 on stream2
D2 on stream2
stop D2 on stream2

R1 on stream1
stop R1 on stream1

start H1 on stream1 //moved-up

start R2 on stream2
R2 on stream2
stop R2 on stream2

H1 on stream1
stop H1 on stream1

start H2 on stream2
H2 on stream2
stop H2 on stream2

stop overall 
```

**场景 3（成功）：** task1 使用 stream1 和 3，task2 使用 stream2 和 4

```
start overall

start D1 on stream1
D1 on stream1
stop D1 on stream1 

start D2 on stream2
D2 on stream2
stop D2 on stream2

start R1 on stream3
R1 on stream3
stop R1 on stream3

start R2 on stream4
R2 on stream4
stop R2 on stream4

start H1 on stream1
H1 on stream1
stop H1 on stream1

start H2 on stream2
H2 on stream2
stop H2 on stream2

stop overall 
```

以下是所有场景的总体时序信息：场景 1 = 39.390240 场景 2 = 29.190241 场景 3 = 29.298208

我还附上了下面的 CUDA 代码：

```
#include <stdio.h>
#include <cuda_runtime.h>
#include <sys/time.h>

__global__ void VecAdd(const float* A, const float* B, float* C, int N)
{
    int i = blockDim.x * blockIdx.x + threadIdx.x;
    if (i < N)
        {
        C[i] = A[i] + B[N-i];
        C[i] = A[i] + B[i] * 2;
        C[i] = A[i] + B[i] * 3;
        C[i] = A[i] + B[i] * 4;
        C[i] = A[i] + B[i];
        }
}

void overlap()
{

float* h_A;
float *d_A, *d_C;
float* h_A2;
float *d_A2, *d_C2;

int N = 10000000;
size_t size = N * sizeof(float); 

cudaMallocHost((void**) &h_A, size);
cudaMallocHost((void**) &h_A2, size);

// Allocate vector in device memory
cudaMalloc((void**)&d_A, size);
cudaMalloc((void**)&d_C, size);
cudaMalloc((void**)&d_A2, size);
cudaMalloc((void**)&d_C2, size);

float fTimCpyDev1, fTimKer1, fTimCpyHst1, fTimCpyDev2, fTimKer2, fTimCpyHst2;
float fTimOverall3, fTimOverall1, fTimOverall2;

for (int i = 0; i<N; ++i)
    {
    h_A[i] = 1;
    h_A2[i] = 5;
    }

int threadsPerBlock = 256;
int blocksPerGrid = (N + threadsPerBlock - 1) / threadsPerBlock;

cudaStream_t csStream1, csStream2, csStream3, csStream4;
cudaStreamCreate(&csStream1);
cudaStreamCreate(&csStream2);
cudaStreamCreate(&csStream3);
cudaStreamCreate(&csStream4);

cudaEvent_t ceEvStart, ceEvStop; 
cudaEventCreate( &ceEvStart );
cudaEventCreate( &ceEvStop );

cudaEvent_t ceEvStartCpyDev1, ceEvStopCpyDev1, ceEvStartKer1, ceEvStopKer1, ceEvStartCpyHst1, ceEvStopCpyHst1;
cudaEventCreate( &ceEvStartCpyDev1 );
cudaEventCreate( &ceEvStopCpyDev1 );
cudaEventCreate( &ceEvStartKer1 );
cudaEventCreate( &ceEvStopKer1 );
cudaEventCreate( &ceEvStartCpyHst1 );
cudaEventCreate( &ceEvStopCpyHst1 );
cudaEvent_t ceEvStartCpyDev2, ceEvStopCpyDev2, ceEvStartKer2, ceEvStopKer2, ceEvStartCpyHst2, ceEvStopCpyHst2; 
cudaEventCreate( &ceEvStartCpyDev2 );
cudaEventCreate( &ceEvStopCpyDev2 );
cudaEventCreate( &ceEvStartKer2 );
cudaEventCreate( &ceEvStopKer2 );
cudaEventCreate( &ceEvStartCpyHst2 );
cudaEventCreate( &ceEvStopCpyHst2 );

//Scenario1

cudaDeviceSynchronize();

cudaEventRecord(ceEvStart, 0);

cudaEventRecord(ceEvStartCpyDev1, csStream1);
cudaMemcpyAsync(d_A, h_A, size, cudaMemcpyHostToDevice, csStream1);
cudaEventRecord(ceEvStopCpyDev1, csStream1);

cudaEventRecord(ceEvStartCpyDev2, csStream2);
cudaMemcpyAsync(d_A2, h_A2, size, cudaMemcpyHostToDevice, csStream2);
cudaEventRecord(ceEvStopCpyDev2, csStream2);

cudaEventRecord(ceEvStartKer1, csStream1); 
VecAdd<<<blocksPerGrid, threadsPerBlock, 0, csStream1>>>(d_A, d_A, d_C, N);
cudaEventRecord(ceEvStopKer1, csStream1); 

cudaEventRecord(ceEvStartKer2, csStream2); 
VecAdd<<<blocksPerGrid, threadsPerBlock, 0, csStream2>>>(d_A2, d_A2, d_C2, N);
cudaEventRecord(ceEvStopKer2, csStream2);

cudaEventRecord(ceEvStartCpyHst1, csStream1);
cudaMemcpyAsync(h_A, d_C, size, cudaMemcpyDeviceToHost, csStream1);
cudaEventRecord(ceEvStopCpyHst1, csStream1);

cudaEventRecord(ceEvStartCpyHst2, csStream2);
cudaMemcpyAsync(h_A2, d_C2, size, cudaMemcpyDeviceToHost, csStream2);
cudaEventRecord(ceEvStopCpyHst2, csStream2);

cudaEventRecord(ceEvStop, 0);
cudaDeviceSynchronize();

cudaEventElapsedTime( &fTimOverall1, ceEvStart, ceEvStop);
printf("Scenario1 overall time= %10f\n", fTimOverall1);

//Scenario2 

cudaDeviceSynchronize();

cudaEventRecord(ceEvStart, 0);

cudaEventRecord(ceEvStartCpyDev1, csStream1);
cudaMemcpyAsync(d_A, h_A, size, cudaMemcpyHostToDevice, csStream1);
cudaEventRecord(ceEvStopCpyDev1, csStream1);

cudaEventRecord(ceEvStartKer1, csStream1); //moved up 

cudaEventRecord(ceEvStartCpyDev2, csStream2);
cudaMemcpyAsync(d_A2, h_A2, size, cudaMemcpyHostToDevice, csStream2);
cudaEventRecord(ceEvStopCpyDev2, csStream2);

VecAdd<<<blocksPerGrid, threadsPerBlock, 0, csStream1>>>(d_A, d_A, d_C, N);
cudaEventRecord(ceEvStopKer1, csStream1); 

cudaEventRecord(ceEvStartCpyHst1, csStream1); //moved up

cudaEventRecord(ceEvStartKer2, csStream2); 
VecAdd<<<blocksPerGrid, threadsPerBlock, 0, csStream2>>>(d_A2, d_A2, d_C2, N);
cudaEventRecord(ceEvStopKer2, csStream2);

cudaMemcpyAsync(h_A, d_C, size, cudaMemcpyDeviceToHost, csStream1);
cudaEventRecord(ceEvStopCpyHst1, csStream1);

cudaEventRecord(ceEvStartCpyHst2, csStream2);
cudaMemcpyAsync(h_A2, d_C2, size, cudaMemcpyDeviceToHost, csStream2);
cudaEventRecord(ceEvStopCpyHst2, csStream2);

cudaEventRecord(ceEvStop, 0);
cudaDeviceSynchronize();

cudaEventElapsedTime( &fTimOverall2, ceEvStart, ceEvStop);
printf("Scenario2 overall time= %10f\n", fTimOverall2);

//Scenario3
cudaDeviceSynchronize();

cudaEventRecord(ceEvStart, 0);

cudaEventRecord(ceEvStartCpyDev1, csStream1);
cudaMemcpyAsync(d_A, h_A, size, cudaMemcpyHostToDevice, csStream1);
cudaEventRecord(ceEvStopCpyDev1, csStream1);

cudaEventRecord(ceEvStartCpyDev2, csStream2);
cudaMemcpyAsync(d_A2, h_A2, size, cudaMemcpyHostToDevice, csStream2);
cudaEventRecord(ceEvStopCpyDev2, csStream2);

cudaStreamWaitEvent(csStream3, ceEvStopCpyDev1, 0);
cudaEventRecord(ceEvStartKer1, csStream3); 
VecAdd<<<blocksPerGrid, threadsPerBlock, 0, csStream3>>>(d_A, d_A, d_C, N);
cudaEventRecord(ceEvStopKer1, csStream3);

cudaStreamWaitEvent(csStream4, ceEvStopCpyDev2, 0);
cudaEventRecord(ceEvStartKer2, csStream4); 
VecAdd<<<blocksPerGrid, threadsPerBlock, 0, csStream4>>>(d_A2, d_A2, d_C2, N);
cudaEventRecord(ceEvStopKer2, csStream4);

cudaStreamWaitEvent(csStream1, ceEvStopKer1, 0);
cudaEventRecord(ceEvStartCpyHst1, csStream1);
cudaMemcpyAsync(h_A, d_C, size, cudaMemcpyDeviceToHost, csStream1);
cudaEventRecord(ceEvStopCpyHst1, csStream1);

cudaStreamWaitEvent(csStream2, ceEvStopKer2, 0);
cudaEventRecord(ceEvStartCpyHst2, csStream2);
cudaMemcpyAsync(h_A2, d_C2, size, cudaMemcpyDeviceToHost, csStream2);
cudaEventRecord(ceEvStopCpyHst2, csStream2);

cudaEventRecord(ceEvStop, 0);
cudaDeviceSynchronize();

cudaEventElapsedTime( &fTimOverall3, ceEvStart, ceEvStop);
printf("Scenario3 overall time = %10f\n", fTimOverall3);

cudaStreamDestroy(csStream1);
cudaStreamDestroy(csStream2);
cudaStreamDestroy(csStream3);
cudaStreamDestroy(csStream4);

cudaFree(d_A);
cudaFree(d_C);
cudaFreeHost(h_A);
cudaFree(d_A2);
cudaFree(d_C2);
cudaFreeHost(h_A2);

}

int main()
{

  overlap();
} 
```

非常感谢您提前抽出时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-28T18:09:38.763

（注意，我对Tesla系列设备比较熟悉，实际上并没有GT 555M可以试验，所以我的结果特指C2070。我不知道555m有多少复制引擎，但是我希望下面描述的问题是导致您所看到的行为的原因。）

问题是鲜为人知的事实，即 cudaEventRecords 也是 CUDA 操作，并且它们还必须在启动/执行之前放置在硬件队列之一中。（一个复杂的因素是，由于 cudaEventRecord 既不是复制操作，也不是计算内核，它实际上可以进入任何硬件队列。我的理解是它们通常与同一流的前面的 CUDA 操作进入相同的硬件队列，但由于文档中未指定，实际操作可能取决于设备/驱动程序。）

[如果我可以扩展您的符号以将“E”用于“事件记录”，并详细说明如何填充硬件队列（类似于“ CUDA C/C++ 流和并发](http://developer.download.nvidia.com/CUDA/training/StreamsAndConcurrencyWebinar.pdf)”网络研讨会中所做的），那么在您的场景 1 中例如，您有：

```
Issue order for CUDA operations:
   ED1
   D1
   ED1
   ED2
   D2
   ED2
   ER1
   R1
   ER1
   ... 
```

这些填充队列，如：

```
Hardware Queues:    copyH2D     Kernel
                    -------     ------
                    ED1       * R1
                    D1       /  ER1
                    ED1     /   ...
                    ED2    /
                    D2    /
                    ED2  /
                    ER1 * 
```

并且您可以看到 R1 由于位于流 1 中，因此在 ER1 完成之前不会执行，这在 D1 和 D2 都完成之前不会发生，因为它们都在 H2D 复制队列中序列化。

通过在场景 2 中向上移动 cudaEventRecord ER1，您可以避免这种情况，因为流 1 中的所有 CUDA 操作，在 R1 之前，在 D2 之前完成。这允许 R1 同时启动到 D2。

```
Hardware Queues:    copyH2D     Kernel
                    -------     ------
                    ED1      *  R1
                    D1      /   ER1
                    ED1    /    ...
                    ER1   *
                    ED2    
                    D2    
                    ED2 
```

在您的方案 3 中，ER1 被替换为 ER3。由于这是流 3 中的第一个操作，它可以去任何地方，并且（猜测）进入内核或复制 D2H 队列，它可以立即启动，（如果你没有

```
cudaStreamWaitEvent(csStream3, ceEvStopCpyDev1, 0); 
```

用于与流 1) 同步，因此不会导致与 D2 的错误序列化。

```
Hardware Queues:    copyH2D     Kernel
                    -------     ------
                    ED1     *   ER3
                    D1     /    R3
                    ED1   *     ER3
                    ED2         ...
                    D2    
                    ED2 
```

我的评论是

1.  考虑并发性时，CUDA 操作的发布顺序非常重要
2.  cudaEventRecord 和类似的操作会像其他所有操作一样被放置在硬件队列中，并可能导致错误的序列化。没有很好地描述它们是如何被放置在硬件队列中的，并且可能取决于设备/驱动程序。因此，为了获得最佳并发性，应将 cudaEventRecord 和类似操作的使用减少到必要的最低限度。
3.  如果内核需要为性能研究计时，可以使用事件来完成，但这会破坏并发性。这对于开发来说很好，但对于生产代码应该避免。

但是您应该注意到，即将推出的 Kepler GK110 (Tesla K20) 设备通过使用 32 个硬件队列在减少错误序列化方面做出了重大改进。有关详细信息，请参阅[GK110 白皮书](http://www.nvidia.com/content/PDF/kepler/NVIDIA-Kepler-GK110-Architecture-Whitepaper.pdf)（第 17 页）。

希望这可以帮助。

# javascript - 是否有类似强制布局但支持点击事件的 D3 布局引擎

> ID：11996754
> 
> 赞同：2
> 
> 时间：2012-08-16T23:15:27.163
> 
> 标签：javascript, d3.js, svg, dom-events, force-layout

我想绘制一个有向图，其中任何节点都可以链接到任何其他节点（即没有定义的层次结构），我正在使用强制布局引擎，但它不支持点击事件处理。我希望能够单击一个节点并使该节点居中并围绕它布置其他所有内容。

在D3中可能吗？

编辑：根据 d3.force.layout 的 API 文档：

> force.on（类型，监听器）
> 
> 注册指定的侦听器以从强制布局接收指定类型的事件。目前，仅支持“tick”事件

这表明简单地添加一个点击事件处理程序是行不通的。

此外，树布局需要（据我所知）层次结构，我的数据更加纠结。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T19:38:23.410

在对此感到困惑之后，我有一些接近我想要的东西，所以我会分享。

首先，布局引擎没有点击处理程序，但这不是必需的；我想单击一个节点并将其固定，因此我需要该节点上的单击处理程序。

其次，在力布局引擎的 d3 API 中描述的节点级别有一个“固定”属性。

结合这两者，我可以将点击处理程序添加到锁定或解锁节点位置的节点。

使用[此处](http://bl.ocks.org/1153292)的示例，我将以下内容添加到 CSS: `circle:hover { fill: red; }` 并将圆定义从：

```
var circle = svg.append("svg:g").selectAll("circle")
.data(force.nodes())
.enter().append("svg:circle")
.attr("r", 6)
.call(force.drag); 
```

到

```
var circle = svg.append("svg:g").selectAll("circle")
.data(force.nodes())
.enter().append("svg:circle")
.attr("r", 6)
.on("click", function(d){ d.fixed = 1 - d.fixed; force.start(); })
.call(force.drag); 
```

现在，当我将鼠标悬停在一个圆圈上时，它会变成红色（显示我捕获了它），然后如果我单击它，它会将其锁定到位。然后我可以在其他圈子上重复这个并将它们拖到我想要的位置。

# visual-studio - Visual Studio 2012 可用性错误

> ID：11996755
> 
> 赞同：3
> 
> 时间：2012-08-16T23:15:38.367
> 
> 标签：visual-studio, visual-studio-2012

我们的团队正在考虑升级到 Visual Studio 2012，是否有任何常见的错误可能会造成麻烦？通常，当系统发布时，开发团队会完全遗漏一些主要错误（例如，整个 Vista 操作系统）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:27:42.673

我不知道 VS 2012 的任何“已知”问题。自述文件中通常有一两个注释；但是，我找不到。您可以在 Connect [http://connect.microsoft.com/VisualStudio/SearchResults.aspx?FeedbackType=0&Status=1&Scope=0&SortOrder=5&TabView=0上查看所有错误（和其他反馈）](http://connect.microsoft.com/VisualStudio/SearchResults.aspx?FeedbackType=0&Status=1&Scope=0&SortOrder=5&TabView=0)

此外，还有一个用于 Visual Studio 的 UserVoice 站点，因此您可以查看其他人的建议，看看是否有任何东西可能会阻止显示：http: [//visualstudio.uservoice.com/forums/121579-visual-工作室](http://visualstudio.uservoice.com/forums/121579-visual-studio)

# python - QTreeWidget 选择第一项

> ID：11996756
> 
> 赞同：5
> 
> 时间：2012-08-16T23:15:39.193
> 
> 标签：python, qt, pyqt, pyside

我正在`QTreeWidget`从一个 XML 文件中创建一个。XML 如下所示，我想创建一个名称树：

```
<root>
    <f name='foo'>bar
        <f name='foo2'>baz</f>
    </f>
</root> 
```

目前我正在使用以下代码来执行此操作*（有些简化的代码）*：

```
import lxml.etree as et

#...

self.xml = et.XML(filters.filtersxml)
self.tree_widget = QTreeWidget(parent)

def add_items(parent, xmlroot):
    for i in xmlroot.getchildren():
        item = QTreeWidgetItem(parent, [i.get('name')])
        if len(i.getchildren()) != 0:
            add_items(item, i)

add_items(self.tree_widget, self.xml) 
```

我实际上对此有两个问题：

1.  **主要问题：**有没有办法选择树中的第一个项目，在这种情况下是 foo 。我试图用`setCurrentItem()`and做一些事情`setCurrentIndex()`，但无法让它工作。我用谷歌搜索了一下，但我发现的所有解决方案都适用于模型。
2.  （可选）这个递归函数是一个很好的方法，还是有更好的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-16T23:27:13.543

递归很好，会保持这种状态，并回答您的主要问题：

```
# after all your code
add_items(self.tree_widget, self.xml)

# select the root item
self.tree_widget.setCurrentItem(self.tree_widget.topLevelItem(0)) 
```

您只需确保在调用 setCurrentItem 时该项目已添加到树中 - 否则它不会真正起作用。某些方法要求项目已经与树相关联（如 setExpanded 和 setSelected）

**编辑**

要在不影响树的情况下递归构建，您可以执行以下操作：

```
import lxml.etree as et

#...

self.xml = et.XML(filters.filtersxml)
self.tree_widget = QTreeWidget(parent)

def add_items(parent, xmlroot):
    output = []
    for i in xmlroot.getchildren():
        item = QTreeWidgetItem(parent, [i.get('name')])
        output.append(item)
        if len(i.getchildren()) != 0:
            add_items(item, i)
    return output

items = add_items(None, self.xml)
self.tree_widget.addTopLevelItems(items)
self.tree_widget.setCurrentItem(items[0]) 
```

**编辑2：一次加载**

为了进一步深入兔子洞，我个人会尽可能减少不必要的调用和列表的方法是只为孩子构建一次循环：

```
import lxml.etree as et

#...

self.xml = et.XML(filters.filtersxml)
self.tree_widget = QTreeWidget(parent)

def create_item(parent, xmlroot):
    item = QTreeWidgetItem(parent, [xmlroot.get('name')])
    for xmlchild in xmlroot.getchildren():
       create_item(item, xmlchild)
    return item

items = [create_item(None, xmlchild) for xmlchild in self.xml.getchildren()]
self.tree_widget.addTopLevelItems(items)
if ( items ):
    self.tree_widget.setCurrentItem(items[0]) 
```

**编辑 3：动态加载**

并且由于它被提出......一种动态加载子级的方法是存储每个级别并在扩展后加载它们：

```
import lxml.etree as et
from PyQt4.QtGui import QTreeWidgetItem

# ...    

class XmlTreeWidgetItem(QTreeWidgetItem):
    def __init__( self, parent, xmlitem ):
        super(MyTreeWidgetItem, self).__init__(parent)
        self.setText(0, xmlitem.get('name'))
        self.setChildIndicatorPolicy(self.ShowIndicator)

        self._xmlitem = xmlitem
        self._loaded = False

    def loadChildren( self ):
        if ( self._loaded ):
            return

        self._loaded = True
        self.setChildIndicatorPolicy(self.DontShowIndicatorWhenChildless)
        for xmlchild in self._xmlitem.getchildren():
            XmlTreeWidgetItem(self, xmlchild)

# ...

class SomeClass(QWidget):
    def __init__( self, parent = None ):
        super(SomeClass, self).__init__(parent)

        self.tree_widget = QTreeWidget(parent)

        xml = et.XML(filters.filtersxml)
        items = [XmlTreeWidgetItem(None, xchild) for xchild in xml.getchildren()]
        self.tree_widget.addTopLevelItems(items)
        if ( items ):
            self.tree_widget.setCurrentItem(items[0])

        # create connections
        self.tree_widget.itemExpanded.connect(self.loadItem)

    def loadItem( self, item ):
        item.loadChildren() 
```

# iphone - 如何从 Facebook 获取使用我的应用程序的朋友列表

> ID：11996757
> 
> 赞同：0
> 
> 时间：2012-08-16T23:15:43.717
> 
> 标签：iphone, objective-c, facebook

我有一个要求，比如需要获取正在使用我的应用程序的朋友。与 Instagram 应用程序相同 从 Facebook 查找朋友。

我知道这是提供朋友列表的代码。

```
- (void) getFriendName :(id) sender {

        self.modeString = @"friendName";

        NSString * query = [NSString stringWithFormat:@"SELECT name FROM user WHERE uid IN (SELECT uid1 FROM friend WHERE uid2=me())",appDelegate.friendList];
        NSLog(@"query :%@",query);
    //    NSString * query = [NSString stringWithFormat:@"SELECT uid, first_name, last_name, birthday_date, sex, pic_square, current_location, hometown_location FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) AND strlen(birthday_date) != 0 ORDER BY birthday_date",appDelegate.friendList];
        NSMutableDictionary * params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                        query, @"query",
                                        nil];
        [_facebook requestWithMethodName:@"fql.query"
                               andParams:params
                           andHttpMethod:@"POST"
                             andDelegate:self];
    } 
```

在这些好友列表中，我怎样才能只检索使用我的应用程序的好友？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T04:49:54.587

如果您在服务器上维护数据，请在服务器端进行 Facebook 集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-10T01:11:08.340

这是我一直在使用的查询

```
 NSString *isAppUser = usesApp ? @"1" : @"0";
NSString *query = [NSString stringWithFormat:@"SELECT uid FROM user WHERE is_app_user = %@ AND uid IN (SELECT uid2 FROM friend WHERE uid1 = me()) LIMIT %d",
                   isAppUser, limit];
FBRequest *request = [FBRequest requestWithGraphPath:@"/fql" parameters:@{@"q":query} HTTPMethod:@"GET"]; 
```

您可以删除限制，让 isAppUser 始终为 @"1"

# r - 包含特定软件包的自定义 R 分发

> ID：11996766
> 
> 赞同：1
> 
> 时间：2012-08-16T23:16:41.457
> 
> 标签：r, package

如何使用核心 R 和一些特定的包/库创建 R 的自定义发行版，以使其对用户完全独立。我想创建一个自定义 R 发行版，使其具有 R 和 NLME 所需的包，用户可以轻松下载和安装，而无需下载和安装单个包。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:31:04.687

请参阅[“R 安装和管理”手册](http://cran.r-project.org/doc/manuals/R-admin.html)，它展示了如何为各种操作系统构建和安装 R。您可以在构建的库中包含额外的包。

# ruby-on-rails - 一次连接 2 个元素

> ID：11996767
> 
> 赞同：1
> 
> 时间：2012-08-16T23:17:04.003
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

在 Ruby 中从数组中加入 2 x 2 元素的最优雅方法是什么？

例如：我想加入数组：

```
ar = ['1', '2', '3', '4', '5'] 
```

并得到

```
ar = [ '12', '34', '5' ] 
```

感谢帮助

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-16T23:27:13.057

像往常一样，[Enumerable](https://ruby-doc.org/core/Enumerable.html#method-i-each_slice)是你的好朋友，它想让你的生活更轻松：

```
ar.each_slice(2).map(&:join) 
```

唯一的技巧是使用无块形式`each_slice`来获得一个可以`map`加入切片的枚举器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:32:45.857

我不知道*优雅*，但这是我刚刚提出的：

```
ar.each_slice(2).map { |x, y| "#{x}#{y}" } 
```

您不一定要给 一个块[`each_slice`](http://www.ruby-doc.org/core-1.9.3/Enumerable.html#method-i-each_slice)，它只是返回一个枚举器。因此可以调用`map`它，将每个切片的两个部分传递给它，然后返回一个不错的新数组。

# javascript - 表单提交与 AJAX 轮询调用

> ID：11996770
> 
> 赞同：1
> 
> 时间：2012-08-16T23:17:25.193
> 
> 标签：javascript, jquery, ajax, submit, onsubmit

跟进前几天的问题，我遇到了另一件事，现在我已经花了太多时间来敲打我的头。

大多数情况下，我无法提交 SUCCESS 表单。我也试过这个：

[jQuery表单提交](https://stackoverflow.com/questions/3638750/jquery-form-submit)

这是半功能小提琴中的代码：

[http://jsfiddle.net/ZcgqV/](http://jsfiddle.net/ZcgqV/)

基本上发生的事情是这样的：

1.  我通过 onSubmit 将方法绑定到表单的提交（而不是单击）
2.  提交时，它通过 jQuery .ajax() 调用调用远程服务器
3.  如果响应为“PENDING”，则每 1 秒重试 9 次
4.  失败时，不要提交表单
5.  成功后，提交表单

无论我尝试什么，我都无法让表单在我想要的时候提交而不进入循环，或者在它尝试远程服务器时不立即提交。

〜沮丧的尝试100件失败的事情是你的......

*如果您不喜欢小提琴，这是直接的代码：*

```
var retries = 0;
var success = false;
var token = "toki wartooth is not a bumblebee";

$(document).ready(function() {
    // Attach the action to the form
    $('#tehForm').attr('onSubmit', 'onsubmit_action(event)');
});

function async(fn) {
    setTimeout(fn, 1000);
}

function pollServer() {
    $.ajax({
        type: "POST",
        cache: "false",
        url: "/remoteCall",
        dataType: "json",
        data: {
            ref_token: token
        }
    }).done(function(data, code, jqXHR) {

        switch (data.status) {
        case "SUCCESS":
            alert("Success");
            success = true;

            // --> HERE IS WHERE I WANT THE FORM TO SUBMIT <--

            break;

        case "PENDING":
            if (retries < 9) {
                retries += 1;
                async(function() {
                    pollServer();
                });
            } else {
                alert("Failed after 9 tries");
            }
            break;

        case "ERROR":
            alert("Error");
            break;

        default:
            alert("Some kind of horrible error occurred");
            break;
        }

    }).fail(function(jqXHR, textStatus) {
        var statusCode = jqXHR.status;
        alert("Request failed: " + statusCode + " " + textStatus);
    });

}

function onsubmit_action(event) {
        pollServer();
        if (success === false) {
            // RETURN FALSE DIDN'T WORK, SO I FOUND THIS
            event.preventDefault();
        }
}​ 
```

编辑：

同样，这里真正的问题是我停止提交表单。成功后，我希望提交表单。目前，如果我在 SUCCESS 中使用 .submit()，则会再次调用 AJAX，重新开始该过程。我想要的是表单的操作仅在成功时触发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:44:51.137

尝试尽可能多地使用原始代码；这是一个解决方案：

*回发表单* [http://jsfiddle.net/tpm7v/4/](http://jsfiddle.net/tpm7v/4/)

*通过 Ajax* [http://jsfiddle.net/tpm7v/5/发布表单](http://jsfiddle.net/tpm7v/5/)

```
 var retries = 0,
    token = "toki wartooth is not a bumblebee",
    sendRequest,
    handelResponse,
    postFormToServer,
    $theForm = $('#tehForm');

$(document).ready(function() {
    // Attach the action to the form
    $theForm.bind('submit', onsubmit_action);
});

sendRequest = function() {
    $.ajax({
        type: "POST",
        cache: "false",
        url: "/remoteCall",
        dataType: "json",
        data: {
            ref_token: token
        },
        success: handelResponse
    });
};

postFormToServer = function() {
    $.ajax({
        type: "POST",
        cache: "false",
        url: "/remoteCallToTakFormData",
        dataType: "json",
        data: $form.serialize(),
        success: function() {
            alert('success!');
        }
    });
};

handelResponse = function(data, code, jqXHR) {
    switch (data.status) {
        case "SUCCESS":
            postFormToServer();
            break;

        case "PENDING":
            if (retries < 9) {
                retries += 1;
                setTimeout(sendRequest , 1000);
            } else {
                alert("Failed after 9 tries");
            }
            break;

        case "ERROR":
            alert("Error");
            break;

        default:
            alert("Some kind of horrible error occurred");
            break;
        }
};

function onsubmit_action(evt) {
    evt.preventDefault();
    sendRequest();
}
​
​ 
```

请记住，我将关闭您提供的代码。您应该能够将其移植到您的实际实现中。您可能还想尝试使用[https://github.com/webadvanced/takeCommand](https://github.com/webadvanced/takeCommand)之类的方法来帮助清理所有 Ajax 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:29:20.817

请参阅我上面的评论以获取更多信息，但我认为您在这里看到的问题是：

每次 pollServer() 触发时，它不仅会进行另一个 ajax 调用，而且会根据重试循环每秒进行 9 次可能的 ajax 调用。由于您随后使用 async() 方法设置了另一个 pollServer() 调用，因此您基本上使您的 ajax 调用失控。您想从重试循环中获取 ajax 调用，那么您至少应该每秒只收到 1 个请求，而不是 1、2、3 等。我可能读错了代码，但这是我最好的猜猜你看到了什么。

更新：我不确定我的解释是否清楚，所以我想我会添加一些额外的信息。基本上，每次调用 pollServer() 并获得 PENDING 响应时，它都会调用 async，它会注册一个 setTimeout()。setTimeout() 每秒运行一次，执行 pollServer()，然后调用 asynch，它注册另一个 setTimeout()，它也每秒运行一次。现在您有两个函数，然后每个函数调用 setTimeout()，假设它们仍然从服务器获得 PENDING 作为响应。因此，在 2 轮失败的调用之后，您有 4 个 setTimeout() 调用，每个调用每秒触发一个 ajax 调用（和一个新的 setTimeout）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T23:39:30.983

首先应该是：`$('#tehForm').submit(onsubmit_action);`或`$('#tehForm').on("submit",onsubmit_action);`类似的东西。永远不要使用字符串形式来传递函数。它使用邪恶的 eval 语句。

接下来，在 POST 之后，数据已经提交。这就是发帖的全部原因。为什么你需要在 done 部分进行各种错误处理。Fail 应该处理错误处理。

如果你问如何在超时后重试，试试这个： [Is it possible to check timeout on jQuery.post()?](https://stackoverflow.com/questions/4085605/is-it-possible-to-check-timeout-on-jquery-post)

我相信超时会失败。

所以试试这个：

```
var retries = 0,
    max_tries = 9,
    success = false,
    token = "toki wartooth is not a bumblebee";

$(document).ready(function() {
    // Attach the action to the form
    $('#tehForm').on("submit",submit_the_form);
});

function submit_the_form(e){
   var dfd = $.ajax({
       url : "sendTokenPolling", 
       data : {"token":token},
       timeout : 5000 //you may want 1000, but I really think that is too short
    });
   dfd.done(function(){
      //success, form posted
   });
   dfd.fail(function(){
      //did not work/timedout
      if (retries < max_tries){
         retries += 1;
         submit_the_form(e);
      }
   });
} 
```

# spring - 这是 Spring 3.1.2 中的错误（特别是 Spring Portlet MVC）吗？

> ID：11996771
> 
> 赞同：1
> 
> 时间：2012-08-16T23:17:35.027
> 
> 标签：spring, spring-mvc, portlet, spring-3

背景：我正在使用部署在 liferay 5.x 服务器中的 Spring MVC 框架开发一个 Portlet。目前我正在使用 3.0.0.RELEASE。一切都按预期正常工作。也就是说，当我使用 @RenderMapping(params="myaction=editFolderForm") @RenderMapping(params="myaction=editEntryForm") @RenderMapping
@ActionMapping(params="myaction=editEntry") 等注释时，DefaultAnnotationHandlerMapping 按预期工作为每个请求找到一个处理程序。

但是，出于某种正当理由，我必须使用更新的最新版本，即 3.1.2.RELEASE 而不是 3.0.0.RELEASE。

我观察到 DefaultAnnotationHandlerMapping 在为每个请求查找处理程序时没有按预期工作。通过调试 Spring 框架的内部，我弄清楚了问题所在。我想清楚地解释它，以便有人可以告诉我这是否是一个错误。

在 DefaultAnnotationHandlerMapping 的父类中 AbstractMapBasedHandlerMapping ：

```
package org.springframework.web.portlet.handler;
public abstract class AbstractMapBasedHandlerMapping<K> extends AbstractHandlerMapping {
....
.... 

/**
* Determines a handler for the computed lookup key for the given request.
* @see #getLookupKey
*/
@Override
@SuppressWarnings("unchecked")
protected Object getHandlerInternal(PortletRequest request) throws Exception {
   ...
   if (handler instanceof Map) {
     Map<PortletRequestMappingPredicate, Object> predicateMap =
                (Map<PortletRequestMappingPredicate, Object>) handler;
 List<PortletRequestMappingPredicate> predicates =
     new LinkedList<PortletRequestMappingPredicate>(predicateMap.keySet());

    LINE 81:    Collections.sort(predicates); ///////////////// PROBLEM

 for (PortletRequestMappingPredicate predicate : predicates) {
    if (predicate.match(request)) {
                predicate.validate(request);
                return predicateMap.get(predicate);
            }
        }
        return null;
    }
    return handler;
}
....
....
} 
```

这种排序在 Spring 3.1.2 中被搞砸了，在 Spring 3.0.0 中运行良好。在接下来的两节中，我将告诉你为什么排序很重要以及它在 Spring 3.1.2 中是如何搞砸的。

> **为什么排序很重要？**

此 HandlerMapping 正在逐个节点搜索已排序的链表，直到找到特定处理程序的匹配项。在我的代码库中，我有多个控制器，它们的方法映射有以下注释，例如

@RenderMapping ---> 默认

@RenderMapping(params="myaction=editEntryController")

@RenderMapping(params="myaction=editFolderController")

等等

Collections.sort() 取决于每个 XXXPredicate 类的 compareTo(..) 方法。

当请求首先出现时，应检查 myaction 参数是否等于“editEntryController”、“editFolderController”……最后如果没有匹配项，则仅应匹配带有 @RenderMapping 注释的默认控制器。

在 Spring 3.0.0 中，它的工作方式与预期完全一样。至于 Spring 3.2.1，它的行为不是那样的。

对于这两个版本，在排序之前，列表是相同的。

```
myaction=editEntry, 
myaction=editEntryForm, 
org.springframework.web.portlet.mvc.annotation.DefaultAnnotationHandlerMapping$ResourceMappingPredicate@123bea8a,
myaction=REDIRECT_TO_DEFAULT_PAGE, 
 ,      ---------------------------------> This empty string corrsponds to the default @RenderMapping
 myaction=selectFolderEntries, 
 myaction=searchResults, 
 myaction=addEntry, 
 myaction=addEntryForm, 
 myaction=showMyEntries, 
 myaction=showRecentEntries, 
 org.springframework.web.portlet.mvc.annotation.DefaultAnnotationHandlerMapping$ResourceMappingPredicate@4f1e9e2d, 
 myaction=editFolder, 
 myaction=editFolderForm,
 myaction=addFolder, 
 myaction=addFolderForm 
```

排序后，

使用 Spring 3.0.0，

```
org.springframework.web.portlet.mvc.annotation.DefaultAnnotationHandlerMapping$ResourceMappingPredicate@123bea8a, 
org.springframework.web.portlet.mvc.annotation.DefaultAnnotationHandlerMapping$ResourceMappingPredicate@4f1e9e2d, 
myaction=editEntry, 
myaction=editEntryForm, 
myaction=REDIRECT_TO_DEFAULT_PAGE, 
myaction=selectFolderEntries, 
myaction=searchResults, 
myaction=addEntry, 
myaction=addEntryForm, 
myaction=showMyEntries, 
myaction=showRecentEntries, 
myaction=editFolder, 
myaction=editFolderForm, 
myaction=addFolder, 
myaction=addFolderForm,
             ---------------> Default mapping i.e. @RenderMapping 
```

使用 Spring 3.1.2（忽略 [ ] 之类的内容），

```
[myaction=editEntry]
[myaction=editEntryForm]
deleteFolder
[myaction=REDIRECT_TO_DEFAULT_PAGE]
[]        --------------------------> this is wrongly placed in middle.
[myaction=selectFolderEntries]
[myaction=searchResults]
[myaction=addEntry]
[myaction=addEntryForm]
[myaction=showMyEntries]
[myaction=showRecentEntries]
deleteEntry
[myaction=editFolder]
[myaction=editFolderForm]
[myaction=addFolder]
[myaction=addFolderForm]
null 
```

这是一个链表。并且从第一个节点检查每个映射。当在列表中间找到默认的 [] 即空映射时，将返回 true ，就好像那是正确的处理程序一样，并且不检查其余处理程序。

那么这是 Spring 框架 3.2.1 中的错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-28T22:29:23.803

我有同样的问题。只有版本 3.1.4 对我有用。

# jquery - Jquery UI选项卡在AngularJS中不起作用

> ID：11996773
> 
> 赞同：5
> 
> 时间：2012-08-16T23:17:50.543
> 
> 标签：jquery, jquery-ui, angularjs

我在 angularJS 中使用 jquery UI 选项卡，并使用 ng-repeat 生成列表项和选项卡容器。选项卡正在工作，但选项卡容器无法正常工作。

**模板 - tabs.html**

```
<ul ng-sortable="pages">
    <li ng-controller="pageCtrl" ng-repeat="page in pages">
        <a class="pageName" href="#{{page.id}}">{{page.name}}</a>
    </li>
</ul>
<div id="{{page.id}}" ng-repeat="page in pages">
    <p>{{page.id}}</p>
</div> 
```

**指示**

```
.directive('ngTabs', function($rootScope) {
        return {
            restrict: 'E',
            templateUrl: "js/templates/tabs.html",
            link: function(scope, elm) {
                elm.tabs();
            }
        };
    }) 
```

jsfiddle 链接：http: [//jsfiddle.net/sanitesh/NLw6y/](http://jsfiddle.net/sannitesh/NLw6y/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T13:23:31.540

问题是当执行 ngTabs 指令时，该 div 的内容尚未生成。在 setTimeout 中包装对 .tabs() 的调用就可以了。

```
myApp.directive('ngTabs', function() {
    return function(scope, elm) {
        setTimeout(function() {
            elm.tabs();
        },0);
    };
}); 
```

见[jsFiddle](http://jsfiddle.net/NLw6y/32/)。这可能不是最好的方式/角度方式。

您可以查看[编译](http://docs.angularjs.org/api/ng.%24compile)服务，特别是如果实际选项卡在运行时发生更改。

# php - PHP SQL：从多个日期时间记录中选择 SUM 时间的 AVG？

> ID：11996781
> 
> 赞同：0
> 
> 时间：2012-08-16T23:18:48.723
> 
> 标签：php, sql, datetime, average

我正在尝试查询 mysql 以获取多个记录*的平均 SUM 时间*（取自日期时间字段），以获得如下输出：22: **38**

我的日期时间字段 checkin_time 包含如下数据：

```
2012-03-16 22:48:00 // the time here: 22:48 is what's interesting to me
2012-03-16 02:28:32
2012-03-16 00:28:47
0000-00-00 00:00:00 
```

我的计划是**从所有日期时间字段中提取和选择总和时间**，然后将总和转换为 unix 时间戳，将总和除以记录总数，最后将其转换回时间格式。然而，这（见下面的代码）什么也没给我，**没有错误，什么都没有**。我还意识到像：0000-00-00 00:00:00 这样的空字段在生成相关数据时**不会被考虑在内。**

谁能帮我*指出错误*，或者解释一下你将如何做到这一点的理论？这是我到目前为止得到的：

**编辑：**感谢**Damiqib**建议一个有效的 SQL 查询，但仍然不完全正确。下面的代码在**应该是 23:15**时输出***01:00***。

 **```
 $getCheckinTime = mysql_query("SELECT COUNT(id), SEC_TO_TIME( AVG( TIME_TO_SEC(  `checkin_time` ) ) ) AS averageTime FROM guests WHERE checkin_time != '0000-00-00 00:00:00'") or die(mysql_error());
while($checkIn = mysql_fetch_array($getCheckinTime)) { 

    $timestamp = strtotime($checkIn['averageTime']);
    $UnixTimeStamp = date("Y-m-d H:i:s", $timestamp); //converting to unix
    $avgUnix = $UnixTimeStamp / $checkIn['COUNT(id)']; // calculating average
    $avgTime = date('H:i', $avgUnix); // convert back to time his format
    echo $avgTime; //outputs 01:00, got to be incorrect should be 23:15 something

} 
```

提前致谢

**编辑：解决方案**（感谢 Damiqib）：

```
$avgCheckinTime = array();
$getCheckinTime = mysql_query("SELECT TIME(`checkin_time`) AS averageTime    FROM guests    WHERE checkin_time !=  '0000-00-00 00:00:00'") or die(mysql_error());
while($checkIn = mysql_fetch_array($getCheckinTime)) { 

    array_push($avgCheckinTime, $checkIn['averageTime']);
}

// = array('22:00:00', '22:30:00'...)
    $times = $avgCheckinTime;

    $fromReplace = array('22' => '00',
                   '23' => '01',
                   '00' => '02',
                   '01' => '03',
                   '02' => '04',
                   '03' => '05',
                   '04' => '06',
                   '05' => '07');

  $timeSum = 0;

  //Iterate through all given times and convert them to seconds
  foreach ($times as $time) {
   if (preg_match ('#^(?<hours>[\d]{2}):(?<mins>[\d]{2}):(?<secs>[\d]{2})$#',$time, $parse)) {
  $timeSum += (int) $fromReplace[$parse['hours']] * 3600 + (int) $parse['mins'] * 60 + (int) $parse['secs'] . '<br />';

  //echo $time . ' ' . ($fromReplace[$parse['hours']] *3600) .  '<br />'; 
  }
}

   $toReplace = array('00' => '22',
                 '01' => '23',
                 '02' => '00',
                 '03' => '01',
                 '04' => '02',
                 '05' => '03',
                 '06' => '04',
                 '07' => '05');

 $time = explode(':', gmdate("H:i:s", $timeSum / count($times)));

 $averageCheckinTime = $toReplace[$time[0]] . ':' . $time[1] . ':' . $time[2];

 //This is the final average time biased between 22-05
 echo $averageCheckinTime; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:48:22.853

这似乎适用于我的测试数据：

```
SELECT SEC_TO_TIME(AVG(TIME_TO_SEC(`time`))) AS averageTime
FROM guests 
WHERE checkin_time != '0000-00-00 00:00:00' 
```

**更新：**

```
-- Table structure for table `guests`
CREATE TABLE `guests` (
  `checkin_time` datetime NOT NULL,
  KEY `checkin_time` (`checkin_time`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

-- Dumping data for table `guests`
INSERT INTO `guests` VALUES('2012-08-17 17:30:00');
INSERT INTO `guests` VALUES('2012-08-17 18:30:00');
INSERT INTO `guests` VALUES('2012-08-17 19:30:00');
INSERT INTO `guests` VALUES('2012-08-17 20:30:00');
INSERT INTO `guests` VALUES('2012-08-17 21:30:00');

Showing rows 0 - 0 (1 total, Query took 0.0003 sec)
SELECT SEC_TO_TIME( AVG( TIME_TO_SEC(  `checkin_time` ) ) ) AS averageTime
FROM guests
WHERE checkin_time !=  '0000-00-00 00:00:00'
LIMIT 0 , 30 
```

**结果**

```
averageTime
19:30:00 
```

至少对于我的测试数据，这似乎有效？

**另一个更新**

```
<?php

  /*
    SELECT TIME(`checkin_time`) AS averageTime
    FROM guests
    WHERE checkin_time !=  '0000-00-00 00:00:00'
  */

  // = array('22:00:00', '22:30:00'...)
  $times = RESULT_FROM_QUERY_AS_AN_ARRAY_OF_TIMES;

  $fromReplace = array('22' => '00',
                       '23' => '01',
                       '00' => '02',
                       '01' => '03',
                       '02' => '04',
                       '03' => '05',
                       '04' => '06',
                       '05' => '07');

  $timeSum = 0;

  //Iterate through all given times and convert them to seconds
  foreach ($times as $time) {
    if (preg_match ('#^(?<hours>[\d]{2}):(?<mins>[\d]{2}):(?<secs>[\d]{2})$#',$time, $parse)) {
      $timeSum += (int) $fromReplace[$parse['hours']] * 3600 + (int) $parse['mins'] * 60 + (int) $parse['secs'] . '<br />';

      echo $time . ' ' . ($fromReplace[$parse['hours']] *3600) .  '<br />'; 
    }
  }

  $toReplace = array('00' => '22',
                     '01' => '23',
                     '02' => '00',
                     '03' => '01',
                     '04' => '02',
                     '05' => '03',
                     '06' => '04',
                     '07' => '05');

  $time = explode(':', gmdate("H:i:s", $timeSum / count($times)));

  $averageCheckinTime = $toReplace[$time[0]] . ':' . $time[1] . ':' . $time[2];

  //This is the final average time biased between 22-05
  echo $averageCheckinTime;   

?> 
```**

# ruby-on-rails-3 - 如何使用 UNIX 时间戳更新属性并自动设置 MySQL DATETIME？

> ID：11996782
> 
> 赞同：0
> 
> 时间：2012-08-16T23:18:52.360
> 
> 标签：ruby-on-rails-3, datetime, unix-timestamp

我只是假设一些 Rails 魔术会自动将带有 unix 时间 1345069440000 的传入帖子转换为后端的适当日期时间。但是，我有一个名为“start_at”的日期时间的模型事件，并且：

```
 e = Event.new()
 e.start_at = 1345069440000
 e.save 
```

似乎直接发送 1345069440000 然后 mysql 将其归零。与红宝石时间相同

```
 e = Event.new()
 e.start_at = 1345069440
 e.save 
```

如果我将它设置为一些任意字符串，它会更好地推断：

```
e.start_at = '1/1344/12'
e.save 
```

将日期设置为“1334-12-01 00:00:00 UTC +00:00”。所以，它正在尝试。

显然，我可以在我的类中覆盖 setter，但我希望将这种行为更改得更高，以便所有控制器都支持 unix 时间，以便传递任何日期时间。

导轨 3.2，红宝石 1.9.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:22:08.153

看起来这段代码`active_record/attribute_methods/time_zone_conversion.rb`正在尝试进行转换：

```
unless time.acts_like?(:time)
  time = time.is_a?(String) ? Time.zone.parse(time) : time.to_time rescue time
end 
```

一种选择（尽管有点笨拙）是猴子补丁 Fixnum 添加一个 .to_time 方法：

```
def to_time
  Time.at(self)
end 
```

# javascript - 请解释Javascript图像旋转代码

> ID：11996784
> 
> 赞同：3
> 
> 时间：2012-08-16T23:19:24.637
> 
> 标签：javascript, image-rotation

我正在使用以下代码来创建基本的图像旋转功能，并且我想更好地了解它的工作原理。我得到了大部分内容，但是旋转函数中使用“严格”等于&三元运算符的行，即 (i === (imgs.length -1) ) ？i=0 : i++ ;) 有点令人困惑。我知道它正在增加计数器，但在那之前它在做什么？

```
var i, imgs, pic;

function rotate()
{
    pic.src = imgs[i] ;
    (i === (imgs.length -1) ) ? i=0 : i++ ;
    setTimeout( rotate, 2500 );
}

function init()
{
    pic = document.getElementById("pic");

    imgs = [ 'images/shimano_offer.jpg', 'images/kids_bikes1.jpg', 'images/cycle_to_work.jpg' ] ;

    var preload= new Array();
    for( i=0; i< imgs.length; i++ )
    {
        preload[ i ] = new Image();
        preload[ i ].src = imgs[ i ];
    }

    i=0;

    rotate();
} 
```

代码来自[http://ineasysteps.com/products-page/all_books/javascript-in-easy-steps-4th-edition/](http://ineasysteps.com/products-page/all_books/javascript-in-easy-steps-4th-edition/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:22:37.157

线

```
(i === (imgs.length -1) ) ? i=0 : i++ ; 
```

可以（并且应该）写成：

```
if (i === (imgs.length - 1)) {
    i = 0;
} else {
    i += 1;
} 
```

是的，前者字节数更少，但更难理解和调试。

**编辑：** Norguard 指出了一种使用三元形式的有效方法。我使用三元组，但在这种情况下我不会，因为我可能想在调试时在“i = 0”条件上放置一个断点。如果您预计不需要断点，他的方法更加紧凑和简洁，并且可能更可取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:07:11.190

我不同意 Ares 的观点——这是推理`i`.

对那个特定的三元语句（就是它的本质）感到困惑的部分是三元应该设置***ONE VALUE***。

这是设置单个变量的理想情况。

一个有意义且易于推理的三元语句将类似于：

```
var mood = (bank_account_balance > 0) ? "happy" : "unhappy";
console.log(mood); 
```

这是一种非常干净的方式，`mood`如果平衡是积极的，那就是“快乐”，否则就是“不快乐”。这很好，简洁，不需要完整的：

```
if (....) {
    this_one_var = "one_thing";
} else if (...) {
    this_one_var = "something_else";
} else {
    this_one_var = "another_thing";
}

this_one_var = (...) ? "one_thing" : (...) ? "something_else" : "another_thing";
this_other_var = (...) ? "one_thing2" : (...) ? "something_else2" : "another_thing2"; 
```

你能想象根据不同的条件以第一种形式而不是第二种形式分配 6 个不同的变量吗？

我经常使用第二个，它使得赋值非常非常整洁。

问题是在示例中，他们没有这样做。他们使用三元作为 if 语句来触发代码... ...这就是 if 的用途。

请参阅 Ares 的答案，了解如何将其视为假设。

但作为三元赋值：

```
var length = imgs.length;
i = (i === length - 1) ? 0 : i + 1; 
```

如果`i`是数组的最后一个索引，则设置`i`为 0，否则设置`i`为自身加一。不再有任何疯狂的逻辑可以跳过来弄清楚你是如何到达那里的。

# unix - tomcat java.util.logging 进程

> ID：11996788
> 
> 赞同：3
> 
> 时间：2012-08-16T23:20:37.133
> 
> 标签：unix, memory-leaks, log4j, tomcat7, servlet-3.0

我有一个运行 tomcat7 的 linux (ubuntu) 服务器。服务器有 1GB 的内存，我收到了 java 抛出的堆空间错误。

基本上正在发生的事情是，我的 tomcat 服务器（运行我的 servlet 代码）正在抛出异常，因为没有更多的内存要分配。我的代码非常精简，所以我认为这不是问题。

当我查看 htop 时，我看到了很多 java 日志记录进程，我看到了大约 30 个这样的进程：

```
ps ax | grep java
 7412 pts/0    Sl     0:02 /usr/bin/java -Djava.util.logging.config.file=/usr/share/tomcat/apache-tomcat-7.0.29/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs=/usr/share/tomcat/apache-tomcat-7.0.29/endorsed -classpath /usr/share/tomcat/apache-tomcat-7.0.29/bin/bootstrap.jar:/usr/share/tomcat/apache-tomcat-7.0.29/bin/tomcat-juli.jar -Dcatalina.base=/usr/share/tomcat/apache-tomcat-7.0.29 -Dcatalina.home=/usr/share/tomcat/apache-tomcat-7.0.29 -Djava.io.tmpdir=/usr/share/tomcat/apache-tomcat-7.0.29/temp org.apache.catalina.startup.Bootstrap start
 7426 pts/0    D+     0:00 grep --color=auto java
25937 ?        Sl    13:12 /usr/bin/java -Djava.util.logging.config.file=/usr/share/tomcat/apache-tomcat-7.0.29/conf/logging.properties -Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager -Djava.endorsed.dirs=/usr/share/tomcat/apache-tomcat-7.0.29/endorsed -classpath /usr/share/tomcat/apache-tomcat-7.0.29/bin/bootstrap.jar:/usr/share/tomcat/apache-tomcat-7.0.29/bin/tomcat-juli.jar -Dcatalina.base=/usr/share/tomcat/apache-tomcat-7.0.29 -Dcatalina.home=/usr/share/tomcat/apache-tomcat-7.0.29 -Djava.io.tmpdir=/usr/share/tomcat/apache-tomcat-7.0.29/temp org.apache.catalina.startup.Bootstrap start 
```

随着时间的推移，这些 java 进程会慢慢泄漏内存，并且因为我只有 1gb 的 ram 可以使用我的 tomcat 服务器开始抛出堆空间异常。

我已经摆弄了 log4j（但它应该被关闭）并且我已经尽我所能关闭我能找到的配置中的日志记录。

任何帮助都会很棒，我只需要摆脱这些过程 - 它们是贪婪的方式。谢谢！

~ 丹

编辑：更多信息：

这可能是一个足够大的提示来完全解决这个问题 - 我检查了一些启动调试并想出了这个：

```
 Oct 02, 2012 8:50:08 AM org.apache.catalina.loader.WebappClassLoader clearReferencesThreads

SEVERE: The web application [/NMVServer] appears to have started a thread named [http-bio-8080-exec-53] but has failed to stop it. This is very likely to create a memory leak.
Oct 02, 2012 8:50:08 AM org.apache.catalina.loader.WebappClassLoader 
clearReferencesThreads

SEVERE: The web application [/NMVServer] appears to have started a thread named [http-bio-8080-exec-54] but has failed to stop it. This is very likely to create a memory leak.
Oct 02, 2012 8:50:08 AM org.apache.catalina.loader.WebappClassLoader 
clearReferencesThreads

SEVERE: The web application [/NMVServer] appears to have started a thread named [http-bio-8080-exec-62] but has failed to stop it. This is very likely to create a memory leak.
Oct 02, 2012 8:50:08 AM org.apache.catalina.loader.WebappClassLoader 
clearReferencesThreads

SEVERE: The web application [/NMVServer] appears to have started a thread named [http-bio-8080-exec-64] but has failed to stop it. This is very likely to create a memory leak. 
```

根据几个论坛，我发现的一个泄漏问题是由于 JDBC 驱动程序[http://bugs.mysql.com/bug.php?id=36565的一个错误。](http://bugs.mysql.com/bug.php?id=36565)这解决了我收到的另一条消息。

我一直在环顾四周，发现这非常有用：

[http://wiki.apache.org/tomcat/MemoryLeakProtection](http://wiki.apache.org/tomcat/MemoryLeakProtection)

现在我只是想解决你所有的建议，谢谢！

~ 丹

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-24T09:45:02.007

我一般希望java中的日志记录代码已经过很好的测试。如果您的日志配置没有生成日志输出，则开销较低。您的 htop 结果可能在 tomcat 中显示了一些空闲线程状态。

它可能正在记录，但您可能需要考虑[您的应用程序或其他组件可能泄漏内存的所有方式](https://stackoverflow.com/questions/6470651/creating-a-memory-leak-with-java)。

所有 JVM 都有非常好的诊断内存泄漏的工具。像[这样](https://stackoverflow.com/questions/1473510/general-strategy-to-resolve-java-memory-leak)的主题讨论了找出正在发生的事情的好方法。

**编辑：**更多的想法

如果有很多请求正在使用`HttpServletRequest.getSession()`. [Manager](http://tomcat.apache.org/tomcat-7.0-doc/config/manager.html)组件配置进入[Context](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html)内部，默认为 -1 表示无限会话。

如果您遇到已知的内存泄漏，请使用[当前问题修复列表](http://tomcat.apache.org/tomcat-7.0-doc/changelog.html)检查您的 tomcat 版本。

最后，Tomcat 7 包含一个[JreMemoryLeakPreventionListener](http://tomcat.apache.org/tomcat-7.0-doc/config/listeners.html#JRE_Memory_Leak_Prevention_Listener_-_org.apache.catalina.core.JreMemoryLeakPreventionListener)，它可能显示资源未释放。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T22:37:55.420

Tomcat 通常有一个线程池。Java EE 规范要求启动一个单独的线程来处理每个 HTTP 请求。Tomcat 有一个线程池，并重用该池中的线程，而不是创建和终止它们。更多详细信息可[在此处获得](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html)

您可以通过修改`setenv.sh`（或分别为 setenv.bat）设置 Tomcat 的最大内存限制，例如：

```
CATALINA_OPTS='-Xms512m -Xmx1024m' 
```

有关 Oracle JVM 的更多详细信息，请参见[此处](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html)

但实际上最重要的是跟踪 JVM 内部的内存分配。为此，您将需要[Java VisualVM](http://docs.oracle.com/javase/6/docs/technotes/guides/visualvm/index.html)。

# java - Java字节码到类

> ID：11996789
> 
> 赞同：0
> 
> 时间：2012-08-16T23:20:40.013
> 
> 标签：java, transform, bytecode

我从网络获取字节码。我将字节数组转换为类

```
package l2soft.utils;

public final class CustomClassLoader extends ClassLoader {

public static CustomClassLoader _instance;
public static CustomClassLoader getInstance() {
    return _instance;
}

public void defineCustomClass(byte[] bytecode) {
    Class<?> clazz = defineClass(null, bytecode, 0, bytecode.length);
    resolveClass(clazz);
}

} 
```

但是当应用程序启动时，无法找到派生类。

```
The import test.Test1 cannot be resolved 
```

（与收到的课程一起编译）

注意：我不知道类文件名。我不需要请求一个类，服务器自己发送

升级版：

```
package l2soft.utils;

import java.util.HashMap;
import java.util.Map;

public final class CustomClassLoader extends ClassLoader {

    private Map<String, Class<?>> cache;

    public static CustomClassLoader _instance;
    public static CustomClassLoader getInstance() {
        return _instance;
    }

    public CustomClassLoader(ClassLoader parent) {
        super(ClassLoader.getSystemClassLoader());
        _instance = this;
        cache = new HashMap<String, Class<?>>();
    }

    public void defineCustomClass(byte[] bytecode) {
        Class<?> clazz = defineClass(null, bytecode, 0, bytecode.length);
        resolveClass(clazz);
        cache.put(clazz.getName(), clazz);
    }

    @Override
    public synchronized Class<?> findClass(String name) throws ClassNotFoundException {
        Class<?> result = cache.get(name);

        if(result == null)
            super.findClass(name);

        return result;
    }

} 
```

这是我的自定义类加载器。SomeClass 由这个类加载器和 tes.Test1 加载。但我看到错误：import test.Test1 无法解决。此 CustomClassLoader 设置为默认加载程序 (-Djava system.loader=l2soft.utils.CustomClassLoader)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:35:09.687

由于您没有在问题中指定，我假设您正在导入`test.Test1`一个名为`SomeClass`. 我还假设当你运行 JVM 时这个类在你的初始类路径中（这似乎是由问题的本质所暗示的）。

当您的应用程序启动时，它将`SomeClass`使用默认的类加载器加载类路径（包括 ）上的所有类。为了确保它`SomeClass`可以正常运行，它还必须确保它导入的所有其他类（包括`test.Test1`）也被加载。

问题是，由于`test.Test1` **不在**类路径上，默认类加载器无法解决它，因此出现错误。`test.Test1`直到您使用自定义加载器手动加载它之后才能解析，这发生**在**从类路径进行初始类加载之后（当应用程序实际由 JVM 运行时）。

这可能不是一件容易解决的事情。可能最简单的方法是实现类路径**上**`test.Test1`的某个接口（例如`Test`）。然后，您可以导入和使用引用而不是引用来引用动态加载的类的对象。**`SomeClass``Test``Test``test.Test1`**

# c++ - 类函数宏的问题

> ID：11996791
> 
> 赞同：0
> 
> 时间：2012-08-16T23:20:45.917
> 
> 标签：c++, c++11, macros

我正在尝试缩短我的野牛解析器中的一些重复代码，这是其中一条规则的摘录：

```
expression : OBJECTID ASSIGN expression { $$ = std::make_shared<Assign>($1, $3); $$->setloc(@3.first_line, curr_filename); }
            | expression '.' OBJECTID '(' method_expr_list ')' { $$ = std::make_shared<DynamicDispatch>($1, $3, $5); 
                                                                 $$->setloc(@1.first_line, curr_filename); } 
```

我在想一些事情：

```
expression : OBJECTID ASSIGN expression { $$ = std::make_shared<Assign>($1, $3); SETLOC(@1); }
            | expression '.' OBJECTID '(' method_expr_list ')' { $$ = std::make_shared<DynamicDispatch>($1, $3, $5); 
                                                                 SETLOC(@1); } 
```

除了使用宏来做到这一点之外，我想不出任何其他方法来实现这一点。这就是我想出的：

```
#define SETLOC(node) $$->setloc((node).first_line, curr_filename) 
```

不幸的是，我收到一个编译错误，说 $$ 没有定义，这是有道理的，因为它是一个类似函数的宏。我想知道是否有办法实现第二个片段中的代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T05:37:00.563

这是因为这是`$$`Bison 识别和使用的特殊序列，它不在实际生成的 C 代码中。您必须将其作为参数传递给宏：

```
#define SETLOC(parent, node) parent->setloc((node).first_line, curr_filename) 
```

# c++ - 使用 Clang、libc++ 和 c++11 制作 SFML2 应用程序。对 SFML 库的未定义引用

> ID：11996792
> 
> 赞同：2
> 
> 时间：2012-08-16T23:20:54.690
> 
> 标签：c++, c++11, sfml, libc++, clang++

我在制作 SFML2 应用程序时遇到了一个奇怪的问题。我正在使用存储库中的 Clang++ 以及 libc++（今天都更新了）。SFML2 也从 SVN 存储库更新。我正在使用最新版本的 Kubuntu。大约一个月前，当我上次尝试使用当时最新的存储库时，我也遇到了同样的问题。

我传递给 c++11 和 stdlib 编译器的参数是： -std=c++11 -stdlib=libc++

这是我所说的完整版本：

```
clang++ -std=c++11 -stdlib=libc++ main2.cpp -o main -L/home/jonathan/OpenSource/sfml/SFML-Build/lib/ -I/home/jonathan/OpenSource/sfml/SFML/include/ -lsfml-system -lsfml-window -lsfml-graphics -v 
```

当我尝试编译应用程序时，我收到来自 Clang 的链接错误：

```
/tmp/main2-stOJMp.o: In function `main':
main2.cpp:(.text+0x108): undefined reference to `sf::Window::create(sf::VideoMode, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, unsigned int, sf::ContextSettings const&)' 
```

所有应用程序（当前）所做的就是创建一个 RenderWindow。这只是一个测试应用程序，但是对于我使用的大多数 SFML2 函数，都会有一些这样的链接问题。如果我不使用 libc++，程序编译得非常好。

据我所知，如果我包含 -stdlib=libc++，它不会在 SFML2 lib 文件夹中搜索 SFML2 库以正确链接。

当我使用 -v 命令调用 Clang 时，这里是 ld 调用：

```
"/usr/bin/ld" -z relro --hash-style=gnu --build-id --eh-frame-hdr -m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 -o main /usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crt1.o /usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6/crtbegin.o -L/home/jonathan/OpenSource/sfml/SFML-Build/lib/ -L/usr/lib/gcc/x86_64-linux-gnu/4.6 -L/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu -L/lib/x86_64-linux-gnu -L/lib/../lib64 -L/usr/lib/x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.6/../../.. -L/lib -L/usr/lib /tmp/main2-kOZbfN.o -lsfml-system -lsfml-window -lsfml-graphics -lc++ -lm -lgcc_s -lgcc -lc -lgcc_s -lgcc /usr/lib/gcc/x86_64-linux-gnu/4.6/crtend.o /usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crtn.o 
```

如果我不使用 -stdlib=libc++ ...

```
"/usr/bin/ld" -z relro --hash-style=gnu --build-id --eh-frame-hdr -m elf_x86_64 -dynamic-linker /lib64/ld-linux-x86-64.so.2 -o main /usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crt1.o /usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crti.o /usr/lib/gcc/x86_64-linux-gnu/4.6/crtbegin.o -L/home/jonathan/OpenSource/sfml/SFML-Build/lib/ -L/usr/lib/gcc/x86_64-linux-gnu/4.6 -L/usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu -L/lib/x86_64-linux-gnu -L/lib/../lib64 -L/usr/lib/x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.6/../../.. -L/lib -L/usr/lib /tmp/main2-2IOIxv.o -lsfml-system -lsfml-window -lsfml-graphics -lstdc++ -lm -lgcc_s -lgcc -lc -lgcc_s -lgcc /usr/lib/gcc/x86_64-linux-gnu/4.6/crtend.o /usr/lib/gcc/x86_64-linux-gnu/4.6/../../../x86_64-linux-gnu/crtn.o 
```

所以，如果我让人们感到困惑：如果我将 libc++ 与 Clang 一起使用，我会从第一个 ld 调用中得到上述错误。如果我不使用它，第二个 ld 调用会非常顺利，并且应用程序会成功运行。

我使用 libc++ 的原因是因为我想使用 C++11 中的线程。没有它，我的计算机拥有的 GNU C++ 标准库会出现大量错误。我不会为此发布错误列表，因为它很大并且与此问题无关。

有没有人知道我如何能够解决 SFML2 问题？如果不需要，我宁愿不使用 pthreads 库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-16T23:42:48.577

SFML2 库已针对 libc++ 以外的某些 C++ 库（可能是 libstdc++？）进行编译。要更正，请使用 -stdlib=libc++ 重新编译 SFML2，并确保链接器在将 SFML2 链接到您的应用程序时看到 -stdlib=libc++。

调试的关键是注意链接器正在寻找`sf::Window::create`符号`std::__1`。libc++ 使用`std::__1`. 但其他 std::libs 只用`std`. 这是一项安全功能，可防止您意外混合`std::string`来自两个不同的 std::libs 并最终导致运行时错误而不是链接时错误。

# ember.js - Emberjs 表单、提交函数和操作助手错误

> ID：11996794
> 
> 赞同：2
> 
> 时间：2012-08-16T23:21:11.930
> 
> 标签：ember.js

[http://jsfiddle.net/ACzaJ/7/](http://jsfiddle.net/ACzaJ/7/) 这个小提琴有以下问题：

1.  当您单击：“清除已完成按钮”时，您将收到错误消息：

    ```
    Uncaught Error: assertion failed: Target <Ember.View:ember116> does not have action clearCompletedTodos

      And this line generates that error:
     <button {{action clearCompletedTodos  target="Todos.todosController" }} >
          Clear Completed Todos
      </button> 
    ```

2.  我正在尝试两种不同的提交功能，每次评论一个以尝试另一个：

    2a. 当我单击“添加”按钮时，通过注释掉第二个提交功能来使用第一个提交功能时，不会添加新的待办事项，也不会出现错误。那是什么都没有发生。

    2b。当我注释掉第一个提交函数并使用第二个提交函数时，单击添加，会引发以下错误：

    ```
    Uncaught TypeError: Cannot call method 'createTodo' of null. 
    ```

我怎样才能制作这个待办事项应用程序，运行并添加和清除待办事项。谢谢

**更新**

问题 1 现在由 @pauldechov 解决。但**问题 2a 和 2b**尚未解决。jsfiddle 链接也已更新。谢谢@pauldechov。

**更新 2**

彼得在这里提供的解决方案后来出现了问题，彼得在这里解决了新问题：

[以前在 jsfiddle 上工作的 emberjs1.0-pre 表单返回“错误”：“请使用 POST 请求”](https://stackoverflow.com/questions/12150929/previously-working-emberjs1-0-pre-form-on-jsfiddle-returns-error-please-use)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T14:42:56.993

首先，看起来你已经给你`TodoView`的 an`id`空间了。这`id`需要是一个有效的 HTML id，这样肯定会导致一些问题。其次，该`submit`函数正在您的实例上寻找一个值`TodoFormView`。但是，该值是在您的`TodoView`实例上定义的。您需要在两者之间建立绑定。

我通过暂时摆脱`TodoView`并仅使用标准来简化了一些事情`TextField`。此外，您的`remaining`函数需要更改为`get('length')`使用引号而不是`get(length)`. 此外，复选框 API 已从一些较旧的示例中更改，请参阅[http://docs.emberjs.com/#doc=Ember.Checkbox](http://docs.emberjs.com/#doc=Ember.Checkbox)。

这是更新的小提琴：http: [//jsfiddle.net/wagenet/ACzaJ/8/](http://jsfiddle.net/wagenet/ACzaJ/8/)

# css - 为什么我的 td 不包装它的内容

> ID：11996795
> 
> 赞同：0
> 
> 时间：2012-08-16T23:21:18.023
> 
> 标签：css, word-wrap

我有一个表格单元格一直拒绝包装它的内容（跨度）。这是根据 Chrome 开发工具的场景：

有以下`<td>`规则：

```
overflow:visible;
white-space:normal; 
```

有`<table>`：

```
table-layout:fixed; 
```

表中的第一行有两列定义了固定宽度；有问题的单元格有`padding="2"`。

据我所知，应该这样做，但它不是包装内容。我尝试使用以下规则失败：

```
word-break: break-all;
word-wrap: break-word;
max-width: 120px; /*this is the max width I want to ensure*/ 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:45:31.953

我不知道您的代码到底如何，因为您没有发布它，但我按照您的指示操作，它对我有用。

在这里看到它：http: [//jsfiddle.net/FJ7dB/](http://jsfiddle.net/FJ7dB/)

HTML：

```
<table>
    <tr>
        <td>TD-1-1</td>
        <td padding="2">
            <span>TD-1-2 ContentContentContentContentContentContentContentContentContentContentContentContentContentContentContentContentContent</span>
        </td>
    </tr>
    <tr>
        <td>TD-2-1</td>
        <td>TD-2-2</td>
    </tr>
</table> 
```

CSS：

```
table{
    table-layout:fixed;
    border:1px solid blue;
}
td{
    width:120px;
    max-width:120px;
    word-break: break-all;
    word-wrap: break-word;
    border:1px solid red;
} 
```

使它起作用的是`max-width`，您说它不成功。

而且没有必要设置

```
overflow:visible;
white-space:normal; 
```

因为`visible`和`normal`是它们的默认值。

# c++ - Teamviewers 快速连接按钮是如何实现的？

> ID：11996801
> 
> 赞同：11
> 
> 时间：2012-08-16T23:21:43.973
> 
> 标签：c++, qt, button, titlebar

对于那些不知道我在说什么的人： [http ://www.teamviewer.com/images/presse/quickconnect_en.jpg](http://www.teamviewer.com/images/presse/quickconnect_en.jpg)

Teamviewer 会在所有窗口上覆盖该按钮，以允许您快速与其他人共享窗口。我想要任何关于实现类似东西的想法——如果你有示例代码，甚至更好（特别是按钮——而不是共享）。我对 C++ 和 QT 很感兴趣……但如果有的话，我会对其他语言/库中的好的解决方案感兴趣。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-30T14:28:25.400

要在外部窗口中绘制按钮或其他内容，您需要将代码注入外部进程。检查[SetWindowsHookEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644990%28v=vs.85%29.aspx)方法：

您很可能想为 WH_CALLWNDPROCRET 安装一个挂钩并注意[WM_NCPAINT](http://msdn.microsoft.com/en-us/library/windows/desktop/dd145212%28v=vs.85%29.aspx)消息。这将是绘制按钮的正确位置。但是，我不太确定，如果您可以在非客户区中放置一个窗口，那么在最坏的情况下，您必须“手动”绘制按钮。

只需从您的主应用程序（或从 DLL 中）调用它

`SetWindowsHookEx(WH_CALLWNDPROCRET, myCallWndRetProc, hModule, 0);`

请注意，myCallWndRetProc 必须驻留在 DLL 中，而 hModule 是此 DLL 的模块句柄。

您的 myCallWndRetProc 可能如下所示：

```
LRESULT CALLBACK myCallWndRetProc(int nCode, WPARAM wParam, LPARAM lParam)
{
    if (nCode == HT_ACTION) {
        CWPRETSTRUCT* cwpret = (CWPRETSTRUCT*)lParam;
        if (cwpret->message == WM_NCPAINT) {
            // The non-client area has just been painted.
            // Now it's your turn to draw your buttons or whatever you like
        }
    }
    return CallNextHookEx(0, nCode, wParam, lParam);
} 
```

我建议，在开始实施时，您只需创建一个简单的对话框应用程序并仅挂钩您自己的进程：

```
SetWindowsHookEx(WH_CALLWNDPROCRET, myCallWndRetProc, NULL, GetCurrentThreadId()); 
```

安装全局挂钩会将 DLL 注入所有进程，这使得调试非常困难，并且您的 DLL 在使用时可能会受到写保护。

# c# - c# - 放置txt文件的位置

> ID：11996803
> 
> 赞同：3
> 
> 时间：2012-08-16T23:22:11.070
> 
> 标签：c#, .net, file

我正在开发一个简单的程序，其中一部分从 txt 文件填充列表。

这可能不是一个聪明的问题，但是我没有找到任何关于此的信息。我想知道将文本文件放在应用程序目录中的最佳位置在哪里。

O知道`Resouces`但是，我无法获得存储在那里的文件的路径。

所以2个问题：

1.  放置txt文件的最佳位置在哪里？（或在应用程序中使用的任何其他重要文件）

2.  如果我把文件放在`Resources`我如何得到它的路径？

（对不起我的英语）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:30:07.960

如果这些是您不需要向用户公开并且仅用于内部目的的文件，那么您可以将它们作为资源嵌入到您的程序集中，并在需要时提取它们。

为此，请在您的应用程序中创建一个新目录。我们称之为“资源”。然后，向其中添加文本文件。使用每个文本文件的属性窗口将*BuildAction*设置更改为“嵌入式资源”。然后，在你的代码中，一旦你需要文件的内容，你可以使用这样的代码来提取它：

```
using System.Reflection;

// ...

using (Stream stream = Assembly.GetExecutingAssembly().GetManifestResourceStream("MyApplication.Resources.MyFile.txt")) {
    using (StreamReader reader = new StreamReader(stream)) {
        string contents = reader.ReadToEnd();
        // Do stuff with the text here
    }
} 
```

如果您不想这样做，放置文件的*正确*位置是您在 AppData 目录下创建的目录。这是一个已知的系统路径，您可以像这样获取它：

```
string folderLocation = Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData);
string myPath = Path.Combine(folderLocation, "MyAppName"); 
```

然后，您可以使用一个`StreamReader`或其他类`System.IO`来查找/枚举和读取文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:26:47.760

当应用程序具有关联/伴随数据文件时，有时将它们作为资源嵌入是有意义的，因为这样它们被篡改的机会就会减少，例如删除或修改数据。

在其他时候，保持文件松散是有意义的......所以你必须决定存储它们的最佳位置......你可以将它们定位在安装应用程序的地方，或者在 Application Data/AppData目录。

* * *

要在资源中嵌入文件，请查看此链接：

*   [http://support.microsoft.com/kb/319292](http://support.microsoft.com/kb/319292)

它有一个分步指南显示如何嵌入文件（例如，文本文件到资源中），然后使用 a`StreamReader`访问它并读取其内容。

* * *

要存储文件并从适当位置的目录访问它们，您可以使用：

`System.Environment.SpecialFolder.ApplicationData`

和

`Environment.GetFolderPath()`

找出 AppData 目录在哪里。

然后，当您创建应用程序安装程序/安装程序时，您应该让它在 AppData 下为您的应用程序创建一个目录，然后您可以决定要将哪些文件安装到该位置。

看：

*   [在 C# 中将文件保存到应用程序数据](https://stackoverflow.com/questions/1572442/saving-a-file-to-application-data-in-c-sharp)

请注意，ApplicationData“漫游”...即当您登录到另一台机器时，文件将作为您的配置文件的一部分传输到该机器上......您可能不想要这个......所以您可以改用：

```
System.Environment.SpecialFolder.CommonApplicationData 
```

# python - 我可以将 Artifactory 与 Python PIP 一起使用吗？

> ID：11996807
> 
> 赞同：19
> 
> 时间：2012-08-16T23:22:42.783
> 
> 标签：python, pip, artifactory

我可以使用 Pip 从 Artifactory 中提取 Python 工件吗？

我看到我可以使用 Python 在 Artifactory 中放置工件，但是如果我想使用 pip 从中提取工件怎么办？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2014-10-06T12:34:02.087

在 Artifactory 版本 3.4 中引入了对 python pip 的支持检查他们的 wiki 以获取有关实施的详细信息：[http ://www.jfrog.com/confluence/display/RTF/PyPI+Repositories](http://www.jfrog.com/confluence/display/RTF/PyPI+Repositories)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-19T08:31:21.227

我没有找到关于 PIP 的有线协议的任何具体信息（坦率地说，我没有搜索太多，只是用谷歌搜索），但如果它使用纯 HTTP，你应该没问题。弄清楚 PIP 用于其工件的布局是什么，以这种方式上传它们，它应该可以工作。

# java - 尝试存根包保护方法时，Mockito 模拟调用真实方法实现

> ID：11996809
> 
> 赞同：35
> 
> 时间：2012-08-16T23:22:50.207
> 
> 标签：java, mockito

我正在尝试使用 Mockito 1.8.5 对方法进行存根，但这样做会调用引发异常的真实方法实现（使用“”作为参数值）。

```
package background.internal; //located in trunk/tests/java/background/internal

public class MoveStepTest {

    @Test
    public void testMoveUpdate() {
        final String returnValue = "value";
        final FileAttachmentContainer file = mock(FileAttachmentContainer.class);
        doReturn(returnValue).when(file).moveAttachment(anyString(), anyString(), anyString());
        //this also fails
        //when(file.moveAttachment(anyString(), anyString(), anyString())).thenReturn(returnValue);

        final AttachmentMoveStep move = new AttachmentMoveStep(file);
        final Action moveResult = move.advance(1, mock(Context.class));
        assertEquals(Action.done, moveResult);
    }
} 
```

我试图模拟的方法看起来像这样。没有最终方法或类。

```
package background.internal; //located in trunk/src/background/internal

   public class FileAttachmentContainer {
        String moveAttachment(final String arg1, final String arg2, final String arg3) 
                throws CustomException {
            ...
        }

        String getPersistedValue(final Context context) {
           ...     
        }
    } 
```

我通过模拟的课程看起来像这样：

```
package background.internal; //located in trunk/src/background/internal
public class AttachmentMoveStep {

    private final FileAttachmentContainer file;

    public AttachmentMoveStep(final FileAttachmentContainer file) {
        this.file = file;        
    }

    public Action advance(final double acceleration, final Context context) {
        try {
            final String attachmentValue = this.file.getPersistedValue(context);
            final String entryId = this.file.moveAttachment(attachmentValue, "attachment", context.getUserName());

            //do some other stuff with entryId
        } catch (CustomException e) {
            e.log(context);
        }    
        return Action.done;
    }
} 
```

是什么导致真正的实现被调用，我该如何防止它？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-08-17T17:46:12.503

Mockito 代码无法访问您正在模拟的方法。

因为您的测试代码和被测代码在同一个包中，编译器允许您以这种方式设置您的模拟，但在运行时，Mockito 库必须尝试访问`moveAttachment`，但它不适用于您的情况。这似乎是 Mockito 中的一个[错误](http://code.google.com/p/mockito/issues/detail?id=127)或[已知限制](http://code.google.com/p/google-guice/wiki/OSGi)，因为它应该支持这种情况，（事实上，在大多数情况下确实支持它）。

最简单的方法是创建`moveAttachment`一个公共方法。如果这不是一个选项，那么首先要问你是否想模拟它。如果调用真正的方法会发生什么？

最后一个选项是使用[PowerMock](http://code.google.com/p/powermock/wiki/MockitoUsage13)将`moveAttachment`方法视为私有方法并以这种方式模拟它。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-18T05:50:14.327

我不同意接受的答复。

我认为，您必须提供有关您的环境的更多详细信息。我无法重现您的问题。我在一个 Maven 项目中编写了以下代码：

```
package background.internal; //located in src/main/java

public class FileAttachmentContainer {
    String moveAttachment(String arg1, String arg2, String arg3) {
        throw new IllegalStateException();
    }

    String getPersistedValue(Context context) {
        throw new IllegalStateException();
    }
} 
```

和

```
package background.internal;

public class AttachmentMoveStep {

    private FileAttachmentContainer file;

    public AttachmentMoveStep(FileAttachmentContainer file) {
        this.file = file;
    }

    public Action advance(double acceleration, Context context) {
        String attachmentValue = file.getPersistedValue(context);
        file.moveAttachment(attachmentValue, "attachment", context.getUserName());
        return Action.done;
    }
} 
```

以及以下测试通过

```
package background.internal; //located in src/test/java

import static org.junit.Assert.assertEquals;
import static org.mockito.Matchers.anyString;
import static org.mockito.Mockito.doReturn;
import static org.mockito.Mockito.mock;

import org.junit.Test;

public class MoveStepTest {

    @Test
    public void testMoveUpdate() {
        String returnValue = "value";
        FileAttachmentContainer file = mock(FileAttachmentContainer.class);
        doReturn(returnValue).when(file).moveAttachment(anyString(), anyString(), anyString());
        //this also works
        //when(file.moveAttachment(anyString(), anyString(), anyString())).thenReturn(returnValue);

        AttachmentMoveStep move = new AttachmentMoveStep(file);
        Action moveResult = move.advance(1, mock(Context.class));
        assertEquals(Action.done, moveResult);
    }
} 
```

我的项目使用以下依赖项：

*   jdk1.7.0_05
*   junit-4.10.jar
*   mockito-all-1.9.0.jar
*   javassist-3.16.1-GA.jar
*   objenesis-1.2.jar
*   hamcrest-core-1.1.jar

# ios - 显示上面有 3D 对象的平铺地图

> ID：11996810
> 
> 赞同：0
> 
> 时间：2012-08-16T23:23:08.413
> 
> 标签：ios, opengl-es-2.0, route-me

我需要在其上显示带有小型 3D 建筑模型的平铺世界地图。

我可以在这里看到两种可能的方法：

1.  使用 Route-Me 或类似工具显示平铺地图（顺便说一句，您可以建议哪些类似的平铺地图控件？）。然后在它上面放置透明的（我不知道这是否可能）OpenGL表面并在这里渲染建筑物。
2.  使用 OpenGL 显示图块和建筑物。

我不需要任何额外的功能。只需平移平铺地图（通过触摸或执行选择器）并在其上显示许多小型建筑物（需要处理建筑物的点击）。

我不知道哪种方法最好、更容易/更快地生产。我会很高兴获得一些关于如何制作它们的信息（尤其是第二个）。

如果您知道一些不费吹灰之力的方法，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:24:51.463

方法二可能是最好的，但你的问题很模糊，要正确回答这个问题，你需要很多不同的要求，有些甚至太具体而无法回答。

我将如何着手产生这种方法是使用 OpenGL 并设置两个不同的“世界”矩阵。一个用于 2D 平铺地图，另一个用于将在其之上的 3D 建筑物。（是的，在 OpenGL 中可以实现透明度。）

确保您的项目开始时不会太大！祝你好运！

# actionscript-3 - 减少与距离相关的 MovieClip 大小，有什么建议吗？AS3

> ID：11996813
> 
> 赞同：0
> 
> 时间：2012-08-16T23:23:20.283
> 
> 标签：actionscript-3, distance, movieclip

我有一个将被玩家踢的球，它是一个电影剪辑，我希望它随着它远离原始位置而逐渐变小，也许是一个 AS3 补间？这是移动球的代码：

```
speed=10;
var ease:int = 100;
var gravity:Number = 0.5;
function moveBall()
{  
  var targetX:Number = mouseX;
var targetY:Number = mouseY;
var angle = Math.atan2(targetY,targetX);
bola.x =  mouseX + Math.cos(angle);
bola.y =  mouseY + Math.sin(angle) ;
ballRotation = true;
stage.removeEventListener(MouseEvent.CLICK, kick); 
```

非常感谢您的耐心和帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:59:28.867

如果你有 tweenlite/tweenmax，你可以用这个代码得到一个非常逼真的球：

```
import com.greensock.*;
import com.greensock.plugins.*;
import flash.events.MouseEvent;
TweenPlugin.activate([BezierPlugin]);

ball.addEventListener(MouseEvent.CLICK, kickBall);
function kickBall(e:MouseEvent):void
{
    TweenMax.to(ball,2,{scaleX:0,scaleY:0,bezier:[{x:400, y:-250}, {x:315, y:200}]});
} 
```

显然，您可以随意调整这些值。

示例：[http ://ronnieswietek.com/_random/ball.swf](http://ronnieswietek.com/_random/ball.swf)

# python - Python 正则表达式：为什么这不起作用？

> ID：11996817
> 
> 赞同：2
> 
> 时间：2012-08-16T23:23:38.500
> 
> 标签：python, regex, replace, substitution

为什么这不起作用？

```
re.sub('\\b[a@](\\W|[a@])*[s5$](\\W|[s5$])*[s5$](\\W|[s5$])*($|\\W)', '*', '@ss') 
```

我不明白为什么`@ss`不替换为`*`. 同样，`@55`不更换。

这些被替换：a55、a5s、as5、ass

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:29:55.327

这是因为`@`不是单词字符，因此第一个`\b`不匹配。

这是我的建议：

```
re.sub('(\\ba|@)(\\W|[a@])*[s5$](\\W|[s5$])*[s5$](\\W|[s5$])*($|\\W)', '*', '@ss') 
```

（替换`\b[a@]`为`(\ba|@)`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:29:20.153

第一部分周围没有一对括号。试试这个：

```
re.sub('(\\b[a@])*(\\W|[a@])*[s5$](\\W|[s5$])*[s5$](\\W|[s5$])*($|\\W)', '*', '@ss') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T23:43:40.843

如果您正在尝试一种“亵渎”检查 - 我会将逻辑从正则表达式中取出。

```
look_alike = {'@': 'A', '$': 'S'}
test_string = ''.join(look_alike.get(c, c) for c in your_string.upper()) # also look at `string.translate` 
```

然后`if 'ASS' in test_string`- 或与使用 re 的单词边界类似。

# jquery - 我可以用 jquery 作为链接调用谁来调用 httpget 操作方法

> ID：11996821
> 
> 赞同：0
> 
> 时间：2012-08-16T23:24:22.150
> 
> 标签：jquery, asp.net-mvc

所以我使用 jtable 并且我需要添加一列，并且在该列中调用想要我在另一个控制器中的操作以显示新视图

用于在 jtable 中添加列

```
TestColumn: {
                    title: 'IrRuta',
                    display: function (data) {
var foo = '<a href="http://www.w3schools.com/">Visit W3Schools</a>';
 return foo;
} 
```

我需要这样做，但它应该调用我的行动

```
[HttpGet]
      public ActionResult Index(int? id)
            {
             //todo
            } 
```

我试过这样但没有用

```
var foo = '@Html.ActionLink("ruta", "Index", "Ruta") ';
var foo = '@Url.Action("Index", "Ruta")'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T13:36:52.137

我最后这样做

```
 IrRuta: {
                    title: 'IrRuta',
                    create: false,
                    edit: false,
                    display: function (data) {
                        return '<a href="/RutaCliente/Index?clienteId=' + data.record.ClienteId + '"><span>irRuta</span></a>';
                    } 
```

# ios - 空的uitableview部分的占位符

> ID：11996822
> 
> 赞同：1
> 
> 时间：2012-08-16T23:24:28.180
> 
> 标签：ios, uitableview

经过大量搜索，我似乎无法找到我想要的东西。

我有一个 UITableview，其中某些部分可能一开始是空白的。这是一张图片，可以帮助您了解我在说什么。我想在页脚和页眉之间的中间有一些**文本**（不是表格单元格）。有什么我可能忽略的吗？

![空白部分](../Images/0b155de4c3034b50ffe452593e5ee639.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:47:52.443

我所做的是创建一个与 tableview 大小相同的 UILabel 并将其添加到 tableview 中，例如：

```
UILabel* emptyLabel = [[UILabel alloc] init];
emptyLabel.textAlignment = UITextAlignmentCenter;
emptyLabel.backgroundColor = [UIColor clearColor];
emptyLabel.frame = self.tableView.bounds;
emptyLabel.text = @"Empty";
[self.tableView addSubview:emptyLabel]; 
```

然后您可以使用 hidden 属性来显示或隐藏它，例如`emptyLabel.hidden = TRUE;`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:34:07.970

由于 UITableViews 的性质，我不确定您是否可以用其他东西替换 UITableCell 视图。但是，您没有理由不能完全改变表格单元格本身，使其看起来像一个普通的 UITextLabel 而不是一个单元格！你可以这样做：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    /* Initial setup here... */

    if (thisCellHasNoDataYet) {
        // Prevent highlight on tap
        [cell setSelectionStyle:UITableViewCellSelectionStyleNone]; 
        cell.backgroundColor = [UIColor clearColor];
        cell.textLabel.textColor = [UIColor blackColor];
        cell.textLabel.text = @"TEXT YOU WANT THE 'CELL' TO DISPLAY";
        // etc...
    }
    else {
        // Otherwise we have data to display, set normal cell mode
        [cell setSelectionStyle:UITableViewCellSelectionStyleBlue];
        cell.backgroundColor = [UIColor whiteColor];
        // etc...
} 
```

这里的好处是，一旦满足您的条件，您只需将布尔值（我使用过`thisCellHasNoDataYet`）设置为`TRUE`并调用`reloadData`您的表！

# php - Cakephp 检查记录是否存在

> ID：11996823
> 
> 赞同：37
> 
> 时间：2012-08-16T23:25:08.410
> 
> 标签：php, cakephp

我想知道，是否有一个功能可以让我立即检查数据库中的记录是否存在？

现在我正在使用以下代码来检测记录是否存在，但我可以想象有一种更简单/更好的方法。

```
$conditions = array(
    'conditions' => array(
         'User.id' => $this->Session->read('User.id'),
         'User.activation_key' => $this->Session->read('User.key')
     )
);
$result = $this->User->find('first', $conditions);
if (isset($result['User'])){
    //do something
} 
```

有没有类似的东西：

```
$conditions = array(
    'conditions' => array(
         'User.id' => $this->Session->read('User.id'),
         'User.security_key' => $this->Session->read('User.key')
    )
);
if ($this->User->exists($conditions)){
    //do something
} 
```

好的，是的。它被称为`exists()`，但我需要相同的，但带有参数，因此我可以将自己的条件添加到检查中。

我已经搜索了谷歌，但我找不到任何关于此的主题。好吧，很多关于 php 和 mysql 的内容，但不是关于 cakephp 的。我需要一个蛋糕的具体答案。

谢谢你的时间 ：）

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-08-16T23:36:06.507

您正在寻找的是[Model::hasAny](http://api.cakephp.org/2.3/class-Model.html#_hasAny)

用法：

```
$conditions = array(
    'User.id' => $this->Session->read('User.id'),
    'User.security_key' => $this->Session->read('User.key')
);
if ($this->User->hasAny($conditions)){
    //do something
} 
```

# django - 从模型表单验证模型表单集

> ID：11996825
> 
> 赞同：0
> 
> 时间：2012-08-16T23:25:30.393
> 
> 标签：django, validation, django-forms

我的一个观点是使用带有自定义字段清理的模型表单。一种类型的清理是检查用户是否尝试提交对已设置为该值的字段的更改，并且它通过抛出 ValidationError 完全按照我希望的方式工作。问题当然是我一次只能提交一个表单，所以我想使用一个modelformset来提交多个表单。

我知道可以覆盖modelformset的clean方法，但**我问是否可以在modelformset上使用modelform的字段清理方法？**. 目前，当我提交带有空字段的模型表单集时，is_valid() 通过了，这对我来说似乎很奇怪......

我也想知道“通常”自定义modelformset验证代码会去哪里？我在考虑forms.py。

*编辑——带答案。我的 httpResponseRedirect 允许在未经验证的情况下提交表单。

```
def mass_check_in(request):
    # queryset
    qs = Part.objects.none()
    errlst=[]
    c = {}
    c.update(csrf(request))

    # Creating a model_formset out of PartForm
    PartFormSetFactory = modelformset_factory(model=Part,
                                              form=PartForm,
                                              formset=BasePartFormSet, 
                                              extra=2)
    if request.method == 'POST':
        PartFormSet = PartFormSetFactory(request.POST)
        if PartFormSet.is_valid():
            PartFormSet.save()
            return http.HttpResponseRedirect('/current_count/')

    else:        
        PartFormSet = PartFormSetFactory(queryset=qs, initial=[
                                                               {'serial_number':'placeholder',
                                                                },
                                                               {'serial_number':'placeholder'
                                                                }])

    return render(request,'mass_check_in.html',{
                                           'title':'Add Item',
                                           'formset': PartFormSet,
                                           'formset_errors': PartFormSet.non_form_errors(),
                                           }) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-17T01:02:19.613

如果您根本没有在模型表单集中的模型表单之一中输入任何数据，它将跳过对该表单的验证；[来自文档](https://docs.djangoproject.com/en/dev/topics/forms/formsets/#formset-validation)：

> 表单集足够聪明，可以忽略未更改的额外表单。

您实际上可以通过强制`empty_permitted=False`表单禁用此功能；有关更多信息，请参阅此问题的公认答案：[Django formsets: make first required?](https://stackoverflow.com/questions/2406537/django-formsets-make-first-required)

表单集确实[有自己的`clean`方法](https://docs.djangoproject.com/en/dev/topics/forms/formsets/#custom-formset-validation)，但它用于验证表单集中两个或多个表单之间的信息，而不是用于验证单个表单本身（应该在表单`clean`方法中处理 - 正如您现在所做的那样。

> 表单集有一个类似于 Form 类的干净方法。这是您定义自己的在表单集级别工作的验证的地方：

这是另一个类似的问题：

[Django formset 不验证](https://stackoverflow.com/questions/2452131/django-formset-doesnt-validate)

# iphone - iOS 的新分发证书

> ID：11996832
> 
> 赞同：1
> 
> 时间：2012-08-16T23:26:18.023
> 
> 标签：iphone, ios, xcode, certificate, distribution

大约一周前，我提交了一些应用更新。昨天，我由 Apple 全球开发者关系证书颁发机构颁发的 iOS 分发证书过期了。Xcode 管理器提示我更新一个，它安装了，我从钥匙串访问工具中删除了旧的。我的问题是：我必须更换分发证书会对我用旧证书提交的更新有任何不利影响吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T00:06:40.910

请注意，有两个证书：Apple WWDR 和分发证书，实际用于签署您的应用程序。Apple Worldwide Developer Relations 证书颁发机构证书基本上证明您的其他证书是有效的。

应该没有负面影响，因为它不是此证书，而是用于签署您的应用程序的分发证书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-17T00:13:09.203

添加到@gambit所说的内容。另一个值得关注的问题是 Apple 对应用程序客户的责任。今天我买了你 100 美元的应用程序，明天你决定接受圣徒身份并且永远不会更新你的证书 - 我为什么要浪费钱？应用程序一旦安装就永远存在，除非它因为更新而中断。

# c++ - 结构定义包含自身的静态实例？

> ID：11996833
> 
> 赞同：1
> 
> 时间：2012-08-16T23:26:35.727
> 
> 标签：c++, syntax, struct

当结构的定义包含其自身的静态实例时，这意味着什么？

```
struct Quaternion
{
    float q[4];
    static Quaternion IDENTITY;
}; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-16T23:28:51.220

这意味着此代码是 C++ 而不是 C。

静态成员具有静态生命周期，并且在四元数实例之间“共享”（即它不是其中任何一个的一部分）。

# intellij-idea - Groovy + Vaadin + IntelliJ IDEA：在我引用自定义 jar 之前工作正常

> ID：11996836
> 
> 赞同：1
> 
> 时间：2012-08-16T23:26:51.990
> 
> 标签：intellij-idea, groovy, vaadin

我已经成功创建了一个 IntelliJ IDEA Groovy + Vaadin 项目，该项目运行良好*，直到我尝试引用我编写的另一个 jar。* 我已将 jar 添加到`lib/`并`web/WEB-INF/lib/`包含在我的模块/依赖项中：

![模块/依赖项窗口](../Images/d283ebd9cc983de96e9488911143972f.png)

我什至将该`lib/`实例提升为“全局库”，这样我就可以将它添加到我的 Artifacts 中，如下所示：

![神器](../Images/98287c1861350078d9b7242b265b985f.png)

IntelliJ 构建良好并启动 Tomcat，但是当我尝试在浏览器中查看我的应用程序时，我收到 HTTP 状态 500 并出现错误：

`The server encountered an internal error that prevented it from fulfilling this request`

...和我的 Tomcat 日志状态：

`javax.servlet.ServletException: Failed to load application class: com.qview.client.QueueViewApplication`

有什么方法可以让我深入了解 QueueViewApplication 加载失败的原因？关于修复的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T20:57:07.177

这个问题涉及我如何构建我的自定义 jar。

在 IntelliJ IDEA 中，在**Project Structure » Artifacts » [+] » Jar » From modules with dependencies...**我选择***提取到目标 jar***

这将 QueueUpdater.jar 的依赖 jar 捆绑到一个巨大的 QueueUpdater.jar 中，以便于导入。

但是，当我将选择更改**为通过 manifest 复制到输出目录和链接时**，我能够将各个 jar 添加到`web/WEB-INF/lib/`并运行 Vaadin 应用程序而不会出错。

# jquery - Jquery：e.preventDefault 不起作用？

> ID：11996840
> 
> 赞同：0
> 
> 时间：2012-08-16T23:27:13.543
> 
> 标签：jquery

我有一个`HTML`片段

```
 <div class="playlist" id='{{ playlist.name }}'>
         {{ playlist.name }} 
        <button class="btn btn-primary queueAll" href="#">queue all</button> 
        <i class="icon-chevron-right icon-large"></i>
   </div> 
```

和相应`jQuery`的功能为

```
$(function(){
    $('#playlist').click(function(){
        $.ajax({
            url: '/getUserPlaylists',
            success: function(response, textStatus, jqXHR){
                // console.log(response);
                $('#feature').empty().append(response);
            },
            error: function(response, textStatus, jqXHR) {
                bootstrap_alert.error('error in receving playlists');
            }
        });
    });
}); 
```

**我想要的是**

*   当用户单击`queue all`按钮时，`alert`应该弹出并且没有任何反应

我的`jQuery`功能是

```
$(function(){
    $('body').on('click', '.queueAll', function(e) {
        e.preventDefault();
        alert('will queue all videos');
    });
}); 
```

**现在发生了什么事？**

我确实这样做了，`alert` `'will queue all videos'`但它随后会按照第一个函数中列出的方式进行 ajax 调用，`jQuery`并加载带有结果的下一页

怎么`e.preventDefault()`没有按预期工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:32:02.970

首先，您的按钮不应该有 href 属性，其次 preventDefault 会阻止元素的默认操作。它将阻止链接重定向到 href 中的 url 或阻止提交表单等。它不会阻止附加 javascript 的事件处理程序，因为您必须取消绑定处理程序。

您还针对具有 ID 的元素`playlist`，但它似乎是一个类，除非 playlist.name 只是`playlist`?

除非它是动态的，否则可能是这样的：

```
$(function(){
    $('.queueAll').on('click', function(e) {
        alert('will queue all videos');
        return false;
    });
}); 
```

或者 ：

```
$(function(){
    $('#playlist').click(function(e){
        if (e.target.tagName !== 'BUTTON') { //make sure it's not the button
            $.ajax({
                url: '/getUserPlaylists',
                success: function(response, textStatus, jqXHR){
                    // console.log(response);
                    $('#feature').empty().append(response);
                },
                error: function(response, textStatus, jqXHR) {
                    bootstrap_alert.error('error in receving playlists');
                }
            });
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:30:27.070

我相信你所追求的实际上`e.stopPropagation()`是它将阻止事件冒泡到它的父级。

编辑：就像亚当指出的那样，因为您正在使用`on()`并将事件实际附加到 body 元素而不是按钮，一旦您的代码触发，该事件将已经冒泡通过 #playlist 元素。

*如果目标（event.target）是按钮（或者更确切地说，不是*#playlist元素），我相信你需要做的是检查你的#playlist点击处理程序：

```
$('#playlist').click(function(e){
    if ($(e.target).is('#playlist')) {
        // Do stuff here as it was the #playlist element that was clicked - NOT a child of it
    }
}); 
```

# c# - 在完成时存储“this”

> ID：11996850
> 
> 赞同：5
> 
> 时间：2012-08-16T23:28:20.653
> 
> 标签：c#, garbage-collection, .net-2.0, finalizer

如何定义在类终结期间存储“this”的代码？垃圾收集器应该如何表现（如果在某处定义）？

在我看来，GC 应该多次终结类实例，下面的测试应用程序将打印“66”，但终结器只执行一次，导致应用程序打印“6”。

几行代码：

```
using System;

namespace Test
{
    class Finalized
    {
        ~Finalized()
        {
            Program.mFinalized = this;
        }

        public int X = 5;
    }

    class Program
    {
        public static Finalized mFinalized = null;

        static void Main(string[] args)
        {
            Finalized asd = new Finalized();
            asd.X = 6;
            asd = null;
            GC.Collect();

            if (mFinalized != null)
                Console.Write("{0}", mFinalized.X);

            mFinalized = null;
            GC.Collect();

            if (mFinalized != null)
                Console.Write("{0}", mFinalized.X);
        }
    }
} 
```

我要做的是了解终结器如何管理实例内存。在我的应用程序中，可能希望再次重用实例引用以进行进一步处理。

很明显，终结器不会“释放”内存（至少在我的测试应用程序中）。内存块可以用于其他目的吗？甚至被释放？如果不是，那将是内存泄漏还是什么？

现在，我比以前更困惑了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-16T23:32:25.290

这是由于复活。通过在终结期间将对象存储在另一个变量中（分配`this`给一个变量），就 GC 而言，您可以*复活对象实例。*您可以在 .NET 中复活您的对象，并且您实际上可以使 GC 多次完成对象，但您必须通过[GC.ReRegisterForFinalize](http://msdn.microsoft.com/en-us/library/system.gc.reregisterforfinalize.aspx)显式请求它。

有关详细信息，请参阅[Microsoft .NET Framework 中的自动内存管理](http://msdn.microsoft.com/en-us/magazine/bb985010.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-16T23:34:45.697

GC.Collect 进行扫描，使用终结器对任何对象进行特殊封装，而**不是**收集它们。一旦这些终结器对象完成，GC 就会再次在这些对象上运行。如果他们不再有资格收集（通过重新生根，就像你一样），那就这样吧。通常终结器只运行一次，但是 IIRC，您可以请求它再次运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T23:32:12.640

我对复活物体的任何良好用途感兴趣。

MSDN 声明“复活很少有好的用途，如果可能的话，你真的应该避免它”。Bill Wagner 在他的 Effective C# 中也说过“你不能让这种构造可靠地工作。不要尝试”。但是这本书已经有 2 年历史了，所以也许有些改变了？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-16T23:33:56.853

终结器只被调用一次。您可以自由地将 self 分配给某个地方，并防止对象被垃圾收集。但是一旦对象再次可用于 GC，它就不会运行终结器。

# python - 如何捕获语法错误信号

> ID：11996852
> 
> 赞同：1
> 
> 时间：2012-08-16T23:28:22.873
> 
> 标签：python

我正在创建一个运行一组脚本的 python 框架。每个脚本都会加载一些执行一般系统初始化和日志记录的通用代码。但是，我想在特定脚本出现语法错误时捕获并处理事件。是的，可以使用

```
except SyntaxError: 
```

但是随后每个脚本都必须包含此代码。有什么办法可以使这种情况变得普遍吗？捕捉信号会起作用，我只是不知道哪个信号会指示语法错误。

这些脚本与任何其他 Python 脚本一样运行：

```
test_script.py -l log_file.txt 
```

非常感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T23:35:50.207

实际上，*不可能*在模块中使用它，因为这`SyntaxError`是一个*编译时*异常。您将需要创建一个外部加载器，它将使用`import`,`execfile()`等来加载和编译代码。

# r - 计数组内的实例（子集）

> ID：11996855
> 
> 赞同：1
> 
> 时间：2012-08-16T23:28:51.907
> 
> 标签：r, plyr, subset

我为我的数据做了一个小例子：

```
mth <- c(rep(1,10))  
day <- c(rep(10,5),rep(11,5))  
hr <- c(3,4,5,6,7,3,4,5,6,7)  
v <- c(3,4,5,4,3,3,4,5,4,3)  
A <- data.frame(cbind(mth,day,hr,v)) 
```

我需要做的是每天获得多少值 < 4，我尝试使用该功能`rle`，但无法获得我需要的东西。输出应如下所示：

```
mth <- c(rep(1,2))  
day <- c(10,11)  
v <- c(2,2)  #each 2 here is the sum of 1(3)+1(3) for Oct. and Nov.  
A <- data.frame(cbind(mth,day,v)) 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-17T00:07:43.653

这是一个基本解决方案`tapply`：

```
> with(A, tapply(v, paste(mth,day, sep="_"), function(x) sum(x<4) ) )
1_10 1_11 
   2    2 
```

（它会比 plyr 解决方案快很多，但很可能仅次于 data.table 方法。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-16T23:53:04.977

使用 ddply 很容易

```
library(plyr)
ddply(A, .(mth, day), function(x)  sum(x$v<4))
#    mth day V1
# 1   1  10  2
# 2   1  11  2 
```

或者你可以使用`summarize`

```
ddply(A, .(mth, day), summarize, less4 = sum(v <4))
#   mth day less4
# 1   1  10  2
# 2   1  11  2 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-17T00:06:44.330

一个`data.table`解决方案

```
library(data.table)
A <- data.table(A)
A[, sum(v < 4), by = list(mth,day)]

##    mth day V1
## 1:   1  10 2
## 2:   1  11 2

# or 

A[v<4, .N, by = list(mth,day)]

##    mth day N
## 1:   1  10 2
## 2:   1  11 2 
```

## 基准测试

```
# I create a mock dataset of a `year` 

library(rbenchmark)
daily <- seq(as.Date("2000/1/1"), by="day", length.out=365)

A <- data.table(mth = month(daily),day = mday(daily))
A <-  A[, list(hr = 1:24), by = list(mth,day)]
A[['v']] <- sample(1:10, nrow(A), T)

# set up the various options
ddply1 <- function() ddply(A, .(mth, day), function(x)  sum(x$v<4))
ddply2 <- function() ddply(A, .(mth, day), summarize, less4 = sum(v <4))
base_tapply <- function() with(A, tapply(v, paste(mth,day, sep="_"), function(x) sum(x<4) ) )
dt1 <- function() A[, sum(v < 4), by = list(mth,day)]
dt2 <- function() A[v < 4, .N, by = list(mth,day)]  
sqldf_ <- function() sqldf("SELECT A.mth,A.day,sum(A.v<4) as sum FROM A GROUP BY day")

benchmark(ddply1(), ddply2(),base_tapply(),dt1(),dt2(), sqldf_(),
          replications = 5, 
          columns = c("test", "replications", "elapsed", "relative","user.self"))

##            test replications elapsed relative user.self
## 3 base_tapply()            5    0.08        8      0.08
## 1      ddply1()            5    0.72       72      0.72
## 2      ddply2()            5    1.04      104      1.03
## 4         dt1()            5    0.01        1      0.02
## 5         dt2()            5    0.00        0      0.00
## 6      sqldf_()            5    0.21       21      0.20 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T00:15:01.790

和`sqldf`

```
library(sqldf)

sqldf("SELECT A.mth,A.day,sum(A.v<4) as sum FROM A GROUP BY day")
#  mth day sum
#1   1  10   2
#2   1  11   2 
```

# r - 根据第二个数据帧中的值过滤数据帧

> ID：11996856
> 
> 赞同：9
> 
> 时间：2012-08-16T23:29:01.213
> 
> 标签：r, dataframe, subset

我有2个数据框：

```
at1 = data.frame(ID = c("A", "B", "C", "D", "E"), Sample1 = rnorm(5, 50000, 2500),
      Sample2 = rnorm(5, 50000, 2500), Sample3 = rnorm(5, 50000, 2500),
      row.names = "ID")

  Sample1  Sample2  Sample3
A 52626.55 51924.51 50919.90
B 51430.51 49100.38 51005.92
C 50038.27 52254.73 50014.78
D 48644.46 53926.53 51590.05
E 46462.01 45097.48 50963.39

bt1 = data.frame(ID = c("A", "B", "C", "D", "E"), Sample1 = c(0,1,1,1,1),
      Sample2 = c(0,0,0,1,0), Sample3 = c(1,0,1,1,0), 
      row.names = "ID")

   Sample1 Sample2 Sample3
A       0       0       1
B       1       0       0
C       1       0       1
D       1       1       1
E       1       0       0 
```

我想根据 bt1 中相应单元格中的值（0 或 1）过滤 at1 中的每个单元格，并将结果存储在新的数据帧 ct1 中。例如，如果 bt1[1, "Sample1"] = 1 则 ct1[1, "Sample1"] = at1[1, "Sample1"]。如果 bt1[1, "Sample1"] = 0 则 ct1[1, "Sample1"] = 0。我的原始数据框有 100 多列和 30,000 多行。

我想知道是否有比编写 if 循环更简单的方法（例如使用“应用”？）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-16T23:54:55.183

这是一个`data.table`解决方案，以及第二个简单的解决方案

注意，我在不是 出于思想和实际原因做`ID`了一个特定的专栏`data.frame``row.names`

*   a`data.table`没有行名
*   我认为将它们视为数据的一部分更容易

* * *

```
library(data.table)
library(reshape2)

bt1 <- data.frame(ID = c("A", "B", "C", "D", "E"), Sample1 = c(0,1,1,1,1),
   Sample2 = c(0,0,0,1,0), Sample3 = c(1,0,1,1,0))

at1 <- data.frame(ID = c("A", "B", "C", "D", "E"), Sample1 = rnorm(5, 50000, 2500),
  Sample2 = rnorm(5, 50000, 2500), Sample3 = rnorm(5, 50000, 2500))

# place in long form
at_long <- data.table(melt(at1, id.var = 1))
bt_long <- data.table(melt(bt1, value.name = 'bt_value', id.var = 1))
# set keys for easy merging with data.tabl
setkeyv(at_long, c('ID','variable'))
setkeyv(bt_long, c('ID','variable'))
# merge
combined <- at_long[bt_long]
# set those where 'bt_value == 0' as 0
set(combined, which(combined[['bt_value']]==0), 'value',0)
# or (using the fact that the `bt` data is only 0 or 1
combined[value := value * bt_value]
# then reshape to wide format
dcast(combined, ID~variable, value.var = 'value')
##   ID  Sample1  Sample2  Sample3
## 1  A     0.00     0.00 50115.24
## 2  B 50173.16     0.00     0.00
## 3  C 48216.31     0.00 51952.30
## 4  D 52387.53 50889.95 44043.66
## 5  E 50982.56     0.00     0.00 
```

# 第二种简单的方法

`bt1`如果您知道和（您的数据集）中的行顺序相同`at1`，您可以简单地将 data.frames 的适当组件相乘（按`*`元素工作）

```
sample_cols <- paste0('Sample',1:3)
at1[,sample_cols] * bt1[,sample_cols]

##    Sample1  Sample2  Sample3
## 1     0.00     0.00 50115.24
## 2 50173.16     0.00     0.00
## 3 48216.31     0.00 51952.30
## 4 52387.53 50889.95 44043.66
## 5 50982.56     0.00     0.00 
```

您可以`cbind`使用`ID`from`at1`或`bt1`如果保留`ID`as `row.names`，则 row.names 将持续存在。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-17T01:40:47.433

厚颜无耻的方法使用`sqldf`

```
library(sqldf)
variables <- "bt1.Sample1*at1.Sample1 Sample1,
    bt1.Sample2*at1.Sample2 Sample2,
    bt1.Sample3*at1.Sample3 Sample3"

fn$sqldf("SELECT $variables from at1,bt1 WHERE at1.ROWID=bt1.ROWID")

#   Sample1  Sample2  Sample3
#1     0.00     0.00 55778.34
#2 48819.24     0.00     0.00
#3 51896.14     0.00 52522.69
#4 47946.93 48604.23 47755.30
#5 49423.68     0.00     0.00 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-16T23:43:10.160

您可以使用矢量化（除其他外）。

例如：

```
ct1 <- at1                           # set ct1 equal to at1
ct1$Sample1[bt1$Sample1 == 0] <- 0   # if bt1$Sample1 = 0, set the value to 0 
```

对于第二行：`bt1$Sample1 == 0`是一个逻辑向量，`TRUE`如果`bt1$Sample1`为 0，然后我们将其用作索引`ct1`，以便将这些值设置为 0。由于`ct1`初始化为`at1`，所有其他行（其中`bt1$Sample1 == 1`）都设置为该值在`at1`.

另一种方法是使用`ifelse`，它是 if 语句的向量化形式：

```
ct1$Sample1 <- ifelse(bt1$Sample1 == 0, 0, at1$Sample1) 
```

这意味着“对于 中的每一行`bt1$Sample1`，如果`bt1$Sample1[row] == 0`替换为 0，否则替换为`at1$Sample1[row]`.

您可以对您感兴趣的每一列重复此操作。

您可以遍历列，*或者*您可以使用类似这样`vapply`的话：

```
for each column `col` in bt1:
    ct1$col <- ifelse(bt1$col == 0, 0, at1$col) 
```

这可以通过以下方式实现：

```
ct1 <- vapply(colnames(bt1), function (col) {
           ifelse(bt1[[col]] == 0, 0, at1[[col]])
        }, FUN.VALUE=at1$Sample1) 
```

见`?vapply`，但简而言之：

*   意思是“对于`colnames(bt1)`”中的每一列`bt`，
*   是`function (col) { ifelse(bt1[[col]] == 0, 0, at1[[col]]) }`上面伪代码中的语句：如果 bt1 为 0，则将值 eqqual 设置为 0，`at1`否则将其设置为 in 的值，
*   这`FUN.VALUE=at1$Sample1`是因为`vapply`需要一个函数将输出什么的示例（在我们的例子中，是数据框的一列）。

# javascript - 如何在 AngularJS 的过滤器中使用参数？

> ID：11996857
> 
> 赞同：75
> 
> 时间：2012-08-16T23:29:05.603
> 
> 标签：javascript, angularjs

当我用 ng-repeat 迭代一些数组时，我想在过滤器中使用参数

例子：

HTML部分：

```
<tr ng-repeat="user in users | filter:isActive"> 
```

JavaScript 部分：

```
$scope.isActive = function(user) {
    return user.active === "1";
}; 
```

但我希望能够使用过滤器

```
<tr ng-repeat="user in users | filter:isStatus('4')"> 
```

但它不起作用。我怎么能做这样的事情？

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2012-08-16T23:56:50.703

**更新：**我想我对文档的了解还不够好，但是您绝对可以使用具有这种语法的[过滤器过滤器（请参阅](http://docs.angularjs.org/api/ng.filter:filter)[this fiddle](http://jsfiddle.net/4PYZa/2/)）按对象上的属性进行过滤：

```
<tr ng-repeat="user in users | filter:{status:4}"> 
```

* * *

这是我的原始答案，以防它帮助某人：

使用[过滤](http://docs.angularjs.org/api/ng.filter:filter)器过滤器，您将无法传递参数，但您至少可以做两件事。

**1）在范围变量中设置要过滤的数据，并在过滤器函数中引用它，就像[这个小提琴](http://jsfiddle.net/4PYZa/1/)一样。**

JavaScript：

```
$scope.status = 1;
$scope.users = [{name: 'first user', status: 1},
                {name: 'second user', status: 2},
                {name: 'third user', status: 3}];

$scope.isStatus = function(user){
    return (user.status == $scope.status);
}; 
```

html:

```
<li ng-repeat="user in users | filter:isStatus"> 
```

或者

**2）创建一个新的过滤器，它接受像[这个小提琴](http://jsfiddle.net/ZMkQY/2/)这样的参数。**

JavaScript：

```
var myApp = angular.module('myApp', []);
myApp.filter('isStatus', function() {
  return function(input, status) {
    var out = [];
      for (var i = 0; i < input.length; i++){
          if(input[i].status == status)
              out.push(input[i]);
      }      
    return out;
  };
}); 
```

html:

```
<li ng-repeat="user in users | isStatus:3"> 
```

请注意，此过滤器假定`status`数组中的对象中有一个属性，这可能会降低其可重用性，但这只是一个示例。您可以阅读[此](http://docs.angularjs.org/guide/dev_guide.templates.filters.creating_filters)内容以获取有关创建过滤器的更多信息。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2013-07-23T15:05:58.573

[这个问题与Passing arguments to angularjs filters](https://stackoverflow.com/questions/11753321/passing-arguments-to-angularjs-filters/)几乎相同，我已经给出了答案。但是我会在这里再发布一个答案，以便人们看到它。

实际上还有另一个（可能是更好的解决方案），您可以使用 Angular 的本机“过滤器”过滤器并仍然将参数传递给您的自定义过滤器。

考虑以下代码：

```
 <li ng-repeat="user in users | filter:byStatusId(3)">
        <span>{{user.name}}</span>
    <li> 
```

要完成这项工作，您只需将过滤器定义如下：

```
$scope.byStatusId = function(statusId) {
    return function(user) {
        return user.status.id == statusId;
    }
} 
```

这种方法更通用，因为您可以对嵌套在对象深处的值进行比较。

检查 angular.js[过滤器的反向极性，](https://stackoverflow.com/questions/13464809/reverse-polarity-of-an-angular-js-filter/17811582#17811582)了解如何将其用于过滤器的其他有用操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-17T18:04:41.963

如果您已经创建了 AngularJs 自定义过滤器，您可以将多个参数发送到您的过滤器。这是模板中的用法

```
{{ variable | myFilter:arg1:arg2...  }} 
```

如果你在控制器中使用过滤器，你可以这样做

```
angular.module('MyModule').controller('MyCtrl',function($scope, $filter){
    $filter('MyFilter')(arg1, arg2, ...);
}) 
```

如果您需要更多示例和在线演示，您可以使用它

[AngularJs 过滤器示例和演示](http://www.w3docs.com/snippets/angularjs/how-to-use-angularjs-filters.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-03T09:30:06.557

这可能有点无关紧要，但如果您尝试使用自定义函数应用多个过滤器，您应该查看： [https ://github.com/tak215/angular-filter-manager](https://github.com/tak215/angular-filter-manager)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-09T03:27:17.610

示例我有一个学生列表如下：

```
$scope.students = [  
   { name: 'Hai', age: 25, gender: 'boy' },  
   { name: 'Hai', age: 30, gender: 'girl' },  
   { name: 'Ho', age: 25, gender: 'boy' },  
   { name: 'Hoan', age: 40, gender: 'girl' },  
   { name: 'Hieu', age: 25, gender: 'boy' }  
 ]; 
```

我想通过性别过滤学生成为男孩并按他们的名字过滤。

首先我创建了一个名为“filterbyboy”的函数，如下所示：

```
$scope.filterbyboy = function (genderstr) {  
   if ((typeof $scope.search === 'undefined')||($scope.search === ''))  
     return (genderstr = "")  
   else  
    return (genderstr = "boy");  
 }; 
```

说明：如果不过滤姓名，则显示所有学生，否则按输入姓名和性别过滤为“男孩”

这是完整的 HTMLcode 和演示[如何在 AngularJs 示例中使用和操作符](http://angularjsaz.blogspot.com/2015/10/filter-by-and-operator-in-angularjs.html)

# java - Java ListSet 某处？

> ID：11996863
> 
> 赞同：2
> 
> 时间：2012-08-16T23:29:34.793
> 
> 标签：java, collections, insertion-order

寻找一个插入顺序集合，该集合还允许高效查询和位置子集视图（如子列表）。似乎最直接的选择是采用 List 的链表方法，将节点嵌入为映射值，并在类上公开部分或全部列表接口。

有人会为此向甲骨文抱怨吗？为排序的地图和集合添加了 NavigableMap/Set 并且没有更常见的插入顺序等价物......

编辑：请不要建议 LinkedHashSet - 它没有任何方法可以查询位置或做一个相对子集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:34:42.717

你的意思是像[java.util.LinkedHashSet](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedHashSet.html)：

> Set 接口的哈希表和链表实现，具有可预测的迭代顺序。此实现与 HashSet 的不同之处在于它维护一个双向链表，该列表贯穿其所有条目。该链表定义了迭代顺序，即元素插入集合的顺序（插入顺序）。请注意，如果将元素重新插入集合中，则插入顺序不受影响。（如果 s.add(e) 被调用，而 s.contains(e) 将在调用之前立即返回 true，则元素 e 被重新插入到集合 s 中。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T10:13:20.457

编辑2：新的最终版本这是一个仅适用于功能稍有调整的集合的版本（分为两部分，不再接受 null 作为“地图的开始”），可能有更少的错误

```
public class LinkedSet<E> implements Set<E> {

private LinkedHashMap<E, Integer> m = new LinkedHashMap<E, Integer>();
private int monoticallyIncreasing;

/**
 * Returns true if the value target was added before (exclusive)
 * limitElem in insertion order.
 *
 * If target or limit are not present on the set this method returns false
 *
 * @param limitElem a E that may be a element of the set or not.
 * @return if target was added before limit (can be reset by removing and
 * re-adding the target, that changes iteration order).
 */
public boolean containsBefore(E target, E limitElem) {
    if (isEmpty()) {
        return false;
    }

    Integer targetN = m.get(target);
    if (targetN == null) {
        return false;
    }

    Integer highN = m.get(limitElem);
    if (highN == null) {
        return false;
    }
    return targetN < highN;
}

/**
 * Returns true if the value target was added after (exclusive)
 * previousElem in insertion order.
 *
 * If target or previous are not present on the set this method returns false
 *
 * @param previousElem a E that may be a element of the set or not.
 * @return if target was added before previous (can be reset by removing and
 * re-adding the target, that changes iteration order).
 */
public boolean containsAfter(E target, E previousElem) {
    if (isEmpty()) {
        return false;
    }

    Integer targetN = m.get(target);
    if (targetN == null) {
        return false;
    }

    Integer low = m.get(previousElem);
    if (low == null) {
        return false;
    }
    return low < targetN;
}

@Override
public boolean add(E e) {
    Integer pos = m.get(e);
    if (pos == null) {
        m.put(e, monoticallyIncreasing++);
        return true;
    }
    return false;
}

@Override
public int size() {
    return m.size();
}

@Override
public boolean isEmpty() {
    return m.isEmpty();
}

@Override
public boolean contains(Object o) {
    return m.containsKey(o);
}

@Override
public Object[] toArray() {
    Object[] result = new Object[size()];
    int i = 0;
    for (E e : this) {
        result[i++] = e;
    }
    return result;
}

@Override
@SuppressWarnings("unchecked")
public <T> T[] toArray(T[] a) {
    int size = size();
    if (a.length < size) {
        a = (T[]) java.lang.reflect.Array.newInstance(a.getClass().getComponentType(), size);
    }
    int i = 0;
    Object[] result = a;
    for (E e : this) {
        result[i++] = e;
    }
    if (a.length > size) {
        //peculiar toArray contract where it doesn't care about the rest
        a[size] = null;
    }
    return a;
}

@Override
public boolean remove(Object o) {
    return m.remove(o) != null;
}

@Override
public boolean addAll(Collection<? extends E> c) {
    boolean changed = false;
    for (E e : c) {
        changed |= add(e);
    }
    return changed;
}

@Override
public boolean containsAll(Collection<?> c) {
    return m.keySet().containsAll(c);
}

@Override
public boolean retainAll(Collection<?> c) {
    return m.keySet().retainAll(c);
}

@Override
public boolean removeAll(Collection<?> c) {
    return m.keySet().removeAll(c);
}

@Override
public void clear() {
    m.clear();
}

@Override
public Iterator<E> iterator() {
    return m.keySet().iterator();
}
} 
```

# opencpu - 向 OpenCPU Store 添加自定义函数

> ID：11996865
> 
> 赞同：1
> 
> 时间：2012-08-16T23:29:37.633
> 
> 标签：opencpu

我想弄清楚如何向我的 OpenCPU 商店添加自定义功能。

我知道我们必须在 R/tmp 中创建一个对象。在 /home/ 中创建商店后，我们必须将该对象从 R/tmp 移动到 /home/store/ 使用：

PUT /home/[商店名称]/[对象名称]

使用 R/pub 中已经存在的函数/包很容易，但是当我尝试使用自己的自定义函数时，我卡住了。

我可以在此网页上使用我自己的自定义函数以第三种形式创建一个 R/tmp/[hashkey] 对象：

[http://public.opencpu.org/userapps/opencpu/opencpu.demo/runco​​de/](http://public.opencpu.org/userapps/opencpu/opencpu.demo/runcode/)

返回：

```
{
    "object" : "x0188b9b9ce",
    "graphs" : [],
    "files" : {}
} 
```

所以我把它移到我的商店通过

PUT /home/[商店名称]/new.function

带参数：对象='x0188b9b9ce'

然后我看到：

```
[
 "/R/user/[user name]/[store name]/new.function"
] 
```

但是当我：

```
POST /R/user/[user name]/[store name]/new.function/save 
```

我得到这个回应：

```
HTTP 400 Bad Request
Object: new.function not found in /R/user/[user name]/[store name]/ 
```

那么我做错了什么？

是的，我已经用实际的字符串替换了 [user name] 和 [store name]，我只是想让它尽可能简单明了，并且与文档有明确的联系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-18T04:16:19.523

这是一个服务器端问题。通过上述发布和使用自定义功能将起作用。感谢 Jeroen 对主机服务器防火墙进行了必要的更改。

# android - Android Jersey 客户端 com.sun.jersey.api.client.ClientHandlerException

> ID：11996866
> 
> 赞同：0
> 
> 时间：2012-08-16T23:29:43.913
> 
> 标签：android, rest, jersey

我正在使用我的 android 应用程序中的 jersey 客户端连接到 Web 服务。的版本`android is 1.6 (api level 4)`

我已经引用了`jersey-core-1.12.jar and jersey-client-1.12.jar`库。

`MediaType.APPLICATION_FORM_URLENCODED`当我使用(application/x-www-form-urlencoded)调用请求时，出现以下异常：

```
com.sun.jersey.api.client.ClientHandlerException: A message body writer for Java type, class com.sun.jersey.core.util.MultivaluedMapImpl, and MIME media type, application/x-www-form-urlencoded, was not found 
```

**对 JDK 1.6 update 04 使用相同的代码 - 一切正常。**

这是我的请求的服务器代码示例：

```
@Path("/" + RequestNames.LOGIN)
public class Login {

    @POST
    @Consumes(MediaType.APPLICATION_FORM_URLENCODED)
    public Response login(
            @FormParam(RequestParams.USER_NAME_PARAM) String userName,
            @FormParam(RequestParams.PASSWORD_PARAM) String password) {
... 
```

这是我的请求的客户端代码示例：

```
MultivaluedMap<String, String> formData = new MultivaluedMapImpl();
        formData.add(RequestParams.USER_NAME_PARAM, userName);
        formData.add(RequestParams.PASSWORD_PARAM, password);
        ClientResponse response =
                service.path(REST_PATH).path(RequestNames.LOGIN).type(
                        MediaType.APPLICATION_FORM_URLENCODED).post(ClientResponse.class, formData); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T05:25:04.453

我有同样的问题

> Java 类型的消息正文编写器，类 com.sun.jersey.core.util.MultivaluedMapImpl

错误，它最终成为一个 Maven 依赖问题。而不是使用我包含的单个`jersey-*`工件`jersey-bundle`并且它有效。例如

```
 <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-bundle</artifactId>
        <version>1.14</version>
    </dependency> 
```

# linux - 关闭代理内部的套接字

> ID：11996867
> 
> 赞同：0
> 
> 时间：2012-08-16T23:29:50.100
> 
> 标签：linux, sockets, networking, tcp, proxy

我在 linux 中实现了一个转发代理，它监听几个端口。每当发生连接时，它就会进入外部世界。我的设置如下所示：

Outerworld<----->代理（监听端口A）<------->浏览器（配置代理设置为端口A）

但是，我不确定何时关闭代理外部世界和代理浏览器之间的连接。我的印象是，如果我看到一个数据大小为 0 (recv()) 的数据包，那么它就是来自客户端的通信结束。一旦我得到“recv()=0”，我就会对外部世界做“close()”。这是正确的做法吗？还是我应该做shutdown()？另外，我认为有时浏览器会发送带有数据包的“FIN”，但我无法捕捉到它。我有时会在从未关闭的套接字上看到来自浏览器的连接。（Linux 重复使用相同的 fd 编号。这就是原因之一，我相信我缺少套接字闭包。）

我哪里会出错。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:34:27.370

对于通用 TCP 转发器，关闭是正确的使用方法。当您从一侧读取 EOF 时，请停止读取该侧并关闭另一侧的写入。然后你可以继续读写另一个方向，直到它也给你一个EOF，然后你关闭两者。

# jquery - 带有 ASP .NET 的 Fancybox

> ID：11996871
> 
> 赞同：0
> 
> 时间：2012-08-16T23:30:09.567
> 
> 标签：jquery, asp.net, fancybox

我不确定如何让 fancybox 在 Visual Studio 中运行。

我已经启动了 jquery，如果您单击锚点以触发弹出窗口，它会触发 fancybox，这一切都很好。

问题是我想要一个专用的 .aspx 页面来填充“fancybox”，如果这有意义的话。

我只是不确定如何将我想使用的页面链接或连接到花哨的盒子。

这是我的jQuery：

```
// Category Results Add Basket Pop Up

$("#list-category-results li .add-basket").fancybox({
    width: 620,
    height: 500,
    autoDimensions: false
}); 
```

这是我的 HTML：

```
 <ul id="list-category-results" class="clearfix">
    <li>
        <a href="#">
            <img src="images/categorylist_child_dummy.jpg" alt="categorylist_child_dummy" />
            <span class="result-info">
                <span class="result-type">Moquito Net</span>
                <span class="result-price">$12</span>
            </span>
        </a>
        <a href="#" class="add-basket">Add to gift basket</a>
    </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:49:26.383

我认为您希望能够在不同的页面上一遍又一遍地重用fancybox。为此，您可能希望使用用户控件，而不是另一个 .aspx Web 表单。用户控件（除其他外）允许您在整个网站上一遍又一遍地使用相同的标记。

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="WebUserControl.ascx.cs" Inherits="WebUserControl" %>

<ul id="list-category-results" class="clearfix">
        <li>
            <a href="#">
                <img src="<%= ImageURL %>" alt="<%= AltText %>" />
                <span class="result-info">
                    <span class="result-type"><%= Type %></span>
                    <span class="result-price"><%= Price %></span>
                </span>
            </a>
            <a href="#" class="add-basket">Add to gift basket</a>
        </li>
    </ul> 
```

你背后的代码

```
 public partial class WebUserControl : System.Web.UI.UserControl
    {
        public string Type { get; set; }
        public string Price { get; set; }
        public string ImageURL { get; set; }
        public string AltText { get; set; }

        protected void Page_Load(object sender, EventArgs e)
        {
             // You can put code relevant to the fancybox images here
        }
    } 
```

并且在每个 Web 表单 (.aspx) 上

```
<%@ Page Title="FancyBox Test Page .aspx" Language="C#" %>
<%@ Register Src="~/WebUserControl.ascx" TagPrefix="MyPrefix" TagName="Thing" %>

<!-- jquery and fancybox JS goes here -->

<MyPrefix:FancyBox Type="type goes here" Price="90" ImageURL="SRC to image" runat="server" AltText="This is the First Fancybox Control" />

<MyPrefix:FancyBox Type="type2 goes here" Price="90" ImageURL="SRC to image2" AltText="This is a Second Fancybox Control, you can reuse this tag!" runat="server" /> 
```

# wso2 - WSO2 ESB - SOAP 寻址标头未从一个代理服务传递到另一个代理服务

> ID：11996877
> 
> 赞同：2
> 
> 时间：2012-08-16T23:30:43.197
> 
> 标签：wso2, wso2esb, wso2carbon

我试图将 wsa 寻址“来自”SOAP 标头从一项服务传递到另一项服务，但我无法传递。我有以下情况

我有代理服务，我们将从中调用另一个 WSO2 数据服务。如果代理服务从数据服务接收到故障，我将该故障消息转发到也是代理服务的常见错误处理程序。

在将消息转发到错误处理程序代理服务之前的代理服务中，我使用以下标头调解器在调用代理服务中设置标头

```
 <header name="Action" value="urn:mediate" />
   <header name="From" value="http://localhost:8280/services/TQS_SFA_CUST_SRCH" />
   <header name="To" value="http://localhost:8280/services/TQS_ERROR_HANDLER" /> 
```

但是，错误处理程序代理服务从未收到“From”标头，至少从未在日志或跟踪中显示。

由于这是常见的错误处理程序，我需要知道调用来自哪个服务，以便我可以根据调用服务处理错误。

如何设置 SOAP 寻址标头，以便能够在错误处理程序中看到“From”标头？我尝试了端点调解器以及属性的消息级别设置，以将消息发送到错误处理程序。我还在端点定义中启用了 WS 寻址。看起来没有任何工作。

以下是附加的跟踪日志供您参考。

```
16:05:55,451 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Start : Property mediator
16:05:55,452 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Setting property : FromWhichService at scope : transport to : TQS_SFA_CUST_SRCH (i.e. constant : TQS_SFA_CUST_SRCH)
16:05:55,452 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER End : Property mediator
16:05:55,452 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Start : Header mediator
16:05:55,452 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Set SOAP header : Action to : urn:mediate
16:05:55,453 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER End : Header mediator
16:05:55,453 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Start : Header mediator
16:05:55,453 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Set SOAP header : From to : /services/TQS_SFA_CUST_SRCH
16:05:55,453 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER End : Header mediator
16:05:55,453 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Start : Header mediator
16:05:55,453 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Set SOAP header : To to : http://localhost:8280/services/TQS_ERROR_HANDLER
16:05:55,454 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER End : Header mediator
16:05:55,454 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Start : Log mediator
16:05:55,455 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER To: http://localhost:8280/services/TQS_ERROR_HANDLER, From: /services/TQS_SFA_CUST_SRCH, WSAction: urn:mediate, SOAPAction: urn:mediate, MessageID: urn:uuid:0ccdd39d-e96b-491b-ba53-2411b84fa950, Direction: response, Envelope: <?xml version='1.0' encoding='utf-8'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Body><axis2ns233:DataServiceFault xmlns:axis2ns233="http://ws.wso2.org/dataservice">Error obtaining parser from data source:DS Fault Message: Error in 'SQLQuery.processNormalQuery'
DS Code: DATABASE_ERROR
Source Data Service:-
Name: CUST_SRCH_D_DS
Location: /CUST_SRCH_D_DS-1.0.0.dbs
Description: N/A
Default Namespace: http://ws.wso2.org/dataservice
Current Request Name: CUST_SRCH_OP
Current Params: {DSID={100008492,10001565,100016993,100097721}}
Nested Exception:-
DS Fault Message: Error in 'createProcessedPreparedStatement'
DS Code: UNKNOWN_ERROR
Nested Exception:-
com.teradata.jdbc.jdbc_4.util.JDBCException: [Teradata Database] [TeraJDBC 14.00.00.13] [Error 3810] [SQLState 42S22] Column/Parameter 'gca.a.peson_id' does not exist.

</axis2ns233:DataServiceFault></soapenv:Body></soapenv:Envelope>
16:05:55,455 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER End : Log mediator
16:05:55,455 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Start : Send mediator
16:05:55,455 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Receiving sequence is set to: Value {name ='null', keyValue ='conf:/tqs/common/ErrorRedirect_Seq.xml'}
16:05:55,455 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Sending response message using implicit message properties..
Sending To: http://localhost:8280/services/TQS_ERROR_HANDLER
SOAPAction: urn:mediate
16:05:55,457 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER End : Send mediator
16:05:55,457 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER End : Filter mediator 
16:05:55,458 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER Start : Log mediator
16:05:55,458 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER To: http://localhost:8280/services/TQS_ERROR_HANDLER,From: /services/TQS_SFA_CUST_SRCH,WSAction: urn:mediate,SOAPAction: urn:mediate,MessageID: urn:uuid:f71c97ef-1f32-43a4-9973-c68df81115db,Direction: response,OutSequence-ExitMessage = TQS_SFA_CUST_SRCH - Exiting OutSequence.,Envelope: <?xml version='1.0' encoding='utf-8'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Body><axis2ns233:DataServiceFault xmlns:axis2ns233="http://ws.wso2.org/dataservice">Error obtaining parser from data source:DS Fault Message: Error in 'SQLQuery.processNormalQuery'
DS Code: DATABASE_ERROR
Source Data Service:-
Name: CUST_SRCH_D_DS
Location: /CUST_SRCH_D_DS-1.0.0.dbs
Description: N/A
Default Namespace: http://ws.wso2.org/dataservice
Current Request Name: CUST_SRCH_OP
Current Params: {DSID={100008492,10001565,100016993,100097721}}
Nested Exception:-
DS Fault Message: Error in 'createProcessedPreparedStatement'
DS Code: UNKNOWN_ERROR
Nested Exception:-
com.teradata.jdbc.jdbc_4.util.JDBCException: [Teradata Database] [TeraJDBC 14.00.00.13] [Error 3810] [SQLState 42S22] Column/Parameter 'gca.a.peson_id' does not exist.

</axis2ns233:DataServiceFault></soapenv:Body></soapenv:Envelope>
16:05:55,459 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER End : Log mediator
16:05:55,459 [-] [HttpServerWorker-13]  INFO TRACE_LOGGER Proxy Service TQS_ERROR_HANDLER received a new message from : 127.0.0.1
16:05:55,460 [-] [HttpClientWorker-14]  INFO TRACE_LOGGER End : Sequence <anonymous>
16:05:55,461 [-] [HttpServerWorker-13]  INFO TRACE_LOGGER Message To: /services/TQS_ERROR_HANDLER
16:05:55,461 [-] [HttpServerWorker-13]  INFO TRACE_LOGGER SOAPAction: null
16:05:55,462 [-] [HttpServerWorker-13]  INFO TRACE_LOGGER WSA-Action: null
16:05:55,462 [-] [HttpServerWorker-13]  INFO TRACE_LOGGER Using the anonymous in-sequence of the proxy service for mediation
16:05:55,463 [-] [HttpServerWorker-13]  INFO TRACE_LOGGER Start : Sequence <anonymous>
16:05:55,463 [-] [HttpServerWorker-13]  INFO TRACE_LOGGER Setting the onError handler : conf:/tqs/common/FaultHandler_Seq.xml for the sequence : null
16:05:55,463 [-] [HttpServerWorker-13]  INFO TRACE_LOGGER Sequence <SequenceMediator> :: mediate()
16:05:55,463 [-] [HttpServerWorker-13]  INFO TRACE_LOGGER Start : Log mediator
16:05:55,464 [-] [HttpServerWorker-13] ERROR TRACE_LOGGER To: /services/TQS_ERROR_HANDLER,MessageID: urn:uuid:2893d313-b936-4b43-a551-538b26f7cb72,Direction: request,InSequence-EntryMessage = TQS_ERROR_HANDLER - Entering InSequence.,Envelope: <?xml version='1.0' encoding='utf-8'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Body><axis2ns233:DataServiceFault xmlns:axis2ns233="http://ws.wso2.org/dataservice">Error obtaining parser from data source:DS Fault Message: Error in 'SQLQuery.processNormalQuery'
DS Code: DATABASE_ERROR
Source Data Service:-
Name: CUST_SRCH_D_DS
Location: /CUST_SRCH_D_DS-1.0.0.dbs
Description: N/A
Default Namespace: http://ws.wso2.org/dataservice
Current Request Name: CUST_SRCH_OP
Current Params: {DSID={100008492,10001565,100016993,100097721}}
Nested Exception:-
DS Fault Message: Error in 'createProcessedPreparedStatement'
DS Code: UNKNOWN_ERROR
Nested Exception:-
com.teradata.jdbc.jdbc_4.util.JDBCException: [Teradata Database] [TeraJDBC 14.00.00.13] [Error 3810] [SQLState 42S22] Column/Parameter 'gca.a.peson_id' does not exist.

</axis2ns233:DataServiceFault></soapenv:Body></soapenv:Envelope>
16:05:55,464 [-] [HttpServerWorker-13]  INFO TRACE_LOGGER End : Log mediator 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T03:23:15.097

`<property name="PRESERVE_WS_ADDRESSING" value="true"/>`在 inSeq 中尝试。

参考：
[http ://wso2.org/project/esb/java/4.0.3/docs/properties_guide.html](http://wso2.org/project/esb/java/4.0.3/docs/properties_guide.html)

# c# - 直接在 .aspx 页面上输出静态属性

> ID：11996881
> 
> 赞同：1
> 
> 时间：2012-08-16T23:31:11.973
> 
> 标签：c#, asp.net, static, static-members

我想在 aspx 页面上输出这样的内容（不是代码隐藏）：

```
 <asp:text id="txt1" runat="server" value="<%# Fields.FirstName %>"> 

```

Fields.FirstName 是一个静态类。我该怎么做呢？我收到一条错误消息，提示“当前上下文中不存在名称‘字段’”。我错过了什么？我必须在 .aspx 页面上包含一些内容吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:41:53.580

你可以试试这个：

```
<input type="text" value="<%=Fields.FirstName %>" id="txt1" /> 
```

但是，请记住，它不再是服务器控件。

可以在服务器控件中使用 <%# Fields.FirstName %> 表示法，但是只有当您从代码隐藏调用 DataBind 时才会填充它们。在外部范围中使用单引号是很习惯的，因为在内部范围中通常需要双引号，如下所示：

```
<input type="text" value='<%=Fields["FirstName"] %>' id="txt1" /> 
```

但是，如果不需要引号，它也应该按照您的描述工作：

```
<asp:text id="txt1" runat="server" value="<%# Fields.FirstName %>"> 
```

只要你`txt1.DataBind()`在代码后面的某个地方调用。

另请参阅[此问题](https://stackoverflow.com/questions/957284/whats-the-deal)以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:35:37.197

使用完整的类名（包括所有嵌套的命名空间）和 = 符号，您不是数据绑定（由 # 符号表示）。我经常这样做...

```
<%=Namespace.MyStrings.MyConstantString%> 
```

此外，根据您的页面设置方式，您可能必须在响应写入括号中使用单引号......

```
<asp:TextBox ID="..." runat="server" Text='<%=Namespace.MyStrings.MyConstantString%>'></asp:TextBox> 
```

**更新：**

超级hacky，但我让它工作......

```
<supr:SuprTextBox ID="txt" runat="server" ClientIDMode="Static"></supr:SuprTextBox>
<div id="preload" style="display:none;"><%=Supr.Strings.ASSET_CONTROL_LOCATION%></div>
<script type="text/javascript">
    $(function () {
        $('#txt').val($('#preload').html());
    });
</script> 
```

在 <%= 语法不起作用后不得不自我救赎。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T23:34:31.827

您需要在 aspx 页面上的代码或代码片段中执行此操作。不能嵌套 asp 标签 ( `<%# %>`) 不能嵌套在`asp:text`元素中。

# java - ClassLoader util 用于测试 JVM 中的 ClassLoader 限制

> ID：11996887
> 
> 赞同：0
> 
> 时间：2012-08-16T23:31:56.277
> 
> 标签：java, jvm, limit, classloader

我正在努力寻找一个快速的解决方案来创建一个 ClassLoader 工具来达到 JVM ClassLoader 限制。限制在 17000 范围内，因此要么需要创建 17000 个类，要么有一些脚本可以做到这一点。基本上，我们正在尝试在服务器上进行中断测试，以查看影响的效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:40:27.023

我想您可能指的是永久代空间的大小限制（即“PermGen”）。如果是这样，您可以将大小设置为小得多以执行测试。命令行开关是“-XX:MaxPermSize=64m”（64m 是默认值；您应该尝试更低的值）。

# ruby-on-rails-3 - Rails 3 Asset Pipeline - 开发环境与公共/资产目录冲突

> ID：11996891
> 
> 赞同：0
> 
> 时间：2012-08-16T23:32:15.603
> 
> 标签：ruby-on-rails-3, asset-pipeline, development-environment, precompiled

只是为了确认一下，运行 rake assets:precompile 是否将所有 js 和 css 文件合并到 public/assets 目录下的 application.css 和 application.js 文件中？这个文件的目的是什么？我问的原因是，由于某种原因，我的开发模式与这个文件有很多资产加载冲突，但我的生产模式运行得很好。似乎我可以让我的应用程序在开发环境中正确地提供资产的唯一方法是删除这些文件。

我的 development.rb 文件中是否有可以设置的配置以防止我的应用程序在开发模式下依赖此文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:09:03.417

使用

```
rake assets:precompile:primary RAILS_ENV=production 
```

代替

```
rake assets:precompile 
```

应该防止没有 md5 的资产被添加到 public/assets 目录 - 这应该确保动态生成开发模式资产。

引用

> 要停止在公共使用中创建非散列文件名：
> 
> ```
> rake assets:precompile:primary RAILS_ENV=production 
> ```
> 
> 来自： [为什么rails预编译任务做非消化资产](https://stackoverflow.com/questions/11007034/why-does-rails-precompile-task-do-non-digest-assets)

# objective-c - NSArray 故障中的 NSDictionary

> ID：11996893
> 
> 赞同：0
> 
> 时间：2012-08-16T23:32:28.180
> 
> 标签：objective-c, ios

好的，我的代码正在返回数组。JSONArray bellow 的日志完美返回，所以我不明白为什么字典在此代码下方给出了疯狂的结果：

```
NSMutableArray *listOfparts = [[NSMutableArray alloc] init];
    for (NSDictionary *object in JSONArray) {
        Part *part = [[Part alloc] initWithpartName:object[@"case_name"]
                imageName:object[@"case_image"]];
        [listOfparts addObject:part];

    }
    NSLog(@"array: %@", JSONArray); 
```

// 记录 JSONArray - 看起来不错 //

```
array: (
        {
        "case_color" = White;
        "case_description" = "";
        "case_image" = "";
        "case_name" = "NZXT Phantom 410";
        "case_price" = "99.99";
        "case_type" = ATX;
        id = 1;
    },
        {
        "case_color" = Black;
        "case_description" = "";
        "case_image" = "";
        "case_name" = "Thermaltake MK+";
        "case_price" = "84.99";
        "case_type" = ATX;
        id = 2;
    }
) 
```

// 记录 listOfparts - 看起来不太好 //

```
array: (
    "<Part: 0x71b5530>",
    "<Part: 0x71b5640>"
) 
```

任何帮助，将不胜感激！

更新：我不认为我的桌子做得对

```
Part *eachpart = [listOfparts objectAtIndex:indexPath.row];
    cell.label.text = eachpart.part_name;
    cell.imageView.image = [UIImage imageNamed:eachpart.part_image]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:50:18.317

如果您谈论的是控制台上显示的值，那么您只会看到这些对象的内存地址。这是默认行为。如果您希望控制台显示您的属性值，只需子类化您的 NSObject 子类（在本例中为 Part）的 - (NSString *)description 方法，并返回一个字符串，该字符串具有您想要的属性值的格式在控制台上查看。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:46:02.870

您正在打印`Parts`我认为是您制作的类（例如`UIButton`or `UIView`），这些类是否具有`partName`or之类的属性`imageName`？打印那些。

顺便说一句，您的代码似乎运行良好:)

# sql - 十进制和浮点数据类型的 SQL 处理

> ID：11996894
> 
> 赞同：0
> 
> 时间：2012-08-16T23:32:28.850
> 
> 标签：sql, sql-server-2008

为什么会这样

```
weightedValue = CAST(prob*value as FLOAT(53))/CAST(totalValue as FLOAT(53)) 
```

完整返回十进制答案，但这

```
weightedValue = CAST(prob*value as DECIMAL(38,14))/CAST(totalValue as DECIMAL(38,14)) 
```

返回在小数点后 6 位截断的十进制答案？

'Prob' 被声明为 DECIMAL(16,14)，'value' 是 DECIMAL(17,0)，'weightedValue' 都是十进制值并假设总值不超过超出 DECIMAL(38,14) 规范.

除非我遗漏了什么，否则 DECIMAL(38,14) 符号应该给出一个最多 38 个总数和最多 14 个小数精度的值。因此，我不应该在结果中遇到任何截断，不是吗？

此外，我以前认为使用 DECIMAL(,) 总是优于使用 FLOAT() 基于浮点算术中隐含的不精确性以及与结果相关的不确定性——DECIMAL() 可用于做任何 FLOAT() 可以做的事情，但反之亦然。我错过了什么，事实上，不是这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:20:59.407

问题在于 SQL Server 如何处理小数除法（或乘法）。

结果精度的公式如下：

```
p1 - s1 + s2 + max(6, s1 + p2 + 1) 
```

所以，当你有 a 时`DECIMAL(38,14)/DECIMAL(38,14)`，你会得到一个精度

> 38 - 14 + 14 + 最大值（6, 14 + 38 + 1）= 81

因此，您的结果将是 DECIMAL(81,43)，远远超过允许的 (38,14)。因此，SQL Server 会自动截断答案。

有关更详细的说明，请参阅[blogs.msdn.com 。](http://blogs.msdn.com/b/sqlprogrammability/archive/2006/03/29/564110.aspx)

# email - Magento 如何投递邮件？

> ID：11996897
> 
> 赞同：2
> 
> 时间：2012-08-16T23:32:31.873
> 
> 标签：email, magento, smtp

我注意到 Magento 中没有明确的邮件设置用于发送邮件的 SMTP 服务器。

例如; 我可以设置我的邮件以表明它来自`test@mydomain.com`，同时使用 Google Apps 发送邮件。而且，即使在默认 Magento 安装中无法设置 SMTP 服务器设置。Magento 仍然设法传递邮件。这怎么可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T03:28:26.547

它做 Zend 做的事。

看看 /lib/Zend/Mail/

或者查看他们的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-17T14:06:36.683

`Zend_Mail`Magento 使用组件 发送电子邮件。[但是，您可以使用免费的SMTP Pro 扩展](http://www.magentocommerce.com/magento-connect/aschroder-com-smtp-pro-email-free-and-easy-magento-emailing-for-smtp-gmail-or-google-apps-email.html)
来分配自定义 SMTP 设置。

# ruby-on-rails - ActiveAdmin 为 belongs_to 自定义表单

> ID：11996898
> 
> 赞同：6
> 
> 时间：2012-08-16T23:32:37.870
> 
> 标签：ruby-on-rails, activeadmin

我有这些关联：

```
class Course < ActiveRecord::Base
  has_many :signup
  has_many :user, :through => :signup

  accepts_nested_attributes_for :signup
end

class User < ActiveRecord::Base
  has_many :signup
  has_many :course, :through => :signup

  accepts_nested_attributes_for :signup
end

class Signup < ActiveRecord::Base
  belongs_to :course
  belongs_to :user
end 
```

现在，我想为“注册”自定义 ActiveAdmin 表单，因此它将课程的标题和用户的名称显示为选择而不是文本字段。

默认表单已经这样做了，但是我需要进一步自定义表单并且我无法重现默认表单。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-16T23:48:04.600

您的表单块在您的`admin/signups.rb`:

```
form do |f|
    f.input :course
    t.input :user
end 
```

默认情况下，因为`course`和`user`是关联，所以这应该给你一个`collection_select`- 即 a ，`name`你的模型的属性作为标签，`id`s 作为值。如果您传递了您的`input`sa 输入类型，这将强制它们显示为该类型。

```
form do |f|
    f.input :course, :as => :string
end 
```

这只会为您提供一个`course_id`文本输入字段，您可能只需在其中输入关联对象的 ID。要“重现默认形式”，只需继续`input`为相关属性添加 s 即可。您甚至可以将它们包裹起来以将它们`f.inputs`分组并使它们看起来很漂亮。

```
form do |f|
    f.inputs "Basic Details" do
        f.input :course
        f.input :user
    end
end 
```

# django - 模板上的 direct_to_template 和 render_to_response - {{request}}

> ID：11996899
> 
> 赞同：0
> 
> 时间：2012-08-16T23:32:45.163
> 
> 标签：django, templates, django-generic-views

这些功能不应该完全一样吗？

```
def IndexView(request):
    return direct_to_template(request, template='index.html')

def IndexView2(request):
    return render_to_response('index.html',
                              {'request': request},
                              context_instance=RequestContext(request)) 
```

我不是在问两者之间的区别，但是为什么在模板上我使用 direct_to_template 时不能使用 {{request}} ...我阅读了很多类似的问题，但我无法弄清楚。

有谁知道为什么？谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-17T01:26:35.330

原因是默认情况下`direct_to_template`实际使用`RequestContext(request)`（所有通用视图也是如此），这意味着您的所有模板上下文处理器都在模板中可用（包括[`django.core.context_processors.request`](https://docs.djangoproject.com/en/dev/ref/templates/api/#django-core-context-processors-request)使`request`变量可访问的原因）。

当您使用 时[`RequestContext`](https://docs.djangoproject.com/en/dev/ref/templates/api/#subclassing-context-requestcontext)，它会扫描所有模板上下文处理器（ [`TEMPLATE_CONTEXT_PROCESSORS`在您的 settings.py](https://docs.djangoproject.com/en/dev/ref/settings/#std%3asetting-TEMPLATE_CONTEXT_PROCESSORS)中定义）并自动将它们添加到上下文中，以便它们在您的模板中可用。从文档：

> 第二个区别是它会根据您的 TEMPLATE_CONTEXT_PROCESSORS 设置自动使用一些变量填充上下文。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-16T23:51:02.143

您需要将 django.core.context_processors.request 添加到 settings.py 中的 TEMPLATE_CONTEXT_PROCESSORS。

# macos - 我将如何远程发送适用于 Mac 的 Cocoa 应用程序的更新？

> ID：11996903
> 
> 赞同：0
> 
> 时间：2012-08-16T23:33:00.470
> 
> 标签：macos

我的游戏处于 alpha 阶段，我想（当我发布它时）向运行我的程序的人发送更新。我该怎么做？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T23:34:41.343

您可以使用[Sparkle 框架](http://sparkle.andymatuschak.org/)。

其特点包括：

*   真正的自我更新——用户无需任何工作。
*   使用 appcast 获取发布信息。
*   通过 WebKit 向用户显示发行说明。
*   用户可以选择自动下载和安装所有更新。
*   向用户显示详细的进度窗口。
*   无缝集成——没有提到 Sparkle；使用您的图标和应用程序名称。
*   支持安装在安全位置的身份验证。
*   支持超安全更新的 DSA 签名。
*   真的，真的很容易安装。
*   Sparkle 在您的应用程序中不需要任何代码，因此升级或删除模块很简单。

Pixelmator、Transmission 和 Coda 等许多知名应用程序都使用它。

# ruby-on-rails - 将参数传递给范围定义 Ruby on Rails

> ID：11996904
> 
> 赞同：1
> 
> 时间：2012-08-16T23:33:03.573
> 
> 标签：ruby-on-rails, activerecord, join, parameters, scope

我正在尝试为我的应用程序编写一个通用排序库并且遇到了一些问题。我有一个范围定义`class WorkOrder`，如下所示：

```
scope :join, lambda {|join_model, sort_direction, sort_by| {:joins => join_model, :order => sort_by + " " + sort_direction}} 
```

将`join_model`作为参数传递给控制器​​，控制器根据传入的参数向模型询问排序列表。够简单...

```
@work_orders = @order.work_orders.join_to({:product_configuration => :product}, "ASC", "item").all 
```

这非常适用于 WorkOrders`belongs_to :product_configuration`和 ProductConfigurations `belongs_to :product`。

但如果我想这样称呼它：

```
work_orders = @order.work_orders.join_to("worker", "ASC", "item").all 
```

或者

```
work_orders = @order.work_orders.join_to(:worker, "ASC", "item").all 
```

我得到一个错误。我确定您想知道 WorkOrders`belongs_to :worker`

因此，总而言之，当我尝试访问时，`http://localhost:3000/foo?direction=ASC&join_to=worker&sort=name`出现以下错误：

```
ActiveRecord::StatementInvalid in FooController#index
PG::Error: ERROR:  invalid reference to FROM-clause entry for table "work_orders"
LINE 1: SELECT "work_orders".* FROM "work_orders" worker WHERE (work... 
```

任何建议都将不胜感激，因为我对 Ruby 和 Rails 还很陌生。

**更新**

如果我将范围定义更改为 `scope :join, lambda {|join_model, sort_direction, sort_by| {:joins => join_model.to_sym, :order => sort_by + " " + sort_direction}}`

我导航到时没有收到错误消息，`http://localhost:3000/foo?direction=ASC&join_to=worker&sort=name`但导航到时却收到了`http://localhost:3000/pretzel?direction=ASC&join_to%5Bproduct_configuration%5D=product&sort=item`

错误信息是

```
undefined method `to_sym' for {"product_configuration"=>"product"}:ActiveSupport::HashWithIndifferentAccess 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T18:29:59.747

尝试将此作用域重写为类方法，并使用方法 from`ActiveRecord::QueryMethods`而不是旧的哈希样式语法。我能够在虚拟应用程序中获得与此类似的东西。

```
def self.join_to(join_model, sort_column, sort_direction = 'ASC')
  joins(join_model).order("#{sort_column} #{sort_direction}")
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T19:10:53.530

我能够解决这个问题。没有必要加入`WorkOrders`和`Workers`。我只是传入`nil`确实需要对连接进行排序的列。

```
 def self.join_to(join_model, sort_direction = 'ASC', sort_column)
    if join_model == 'nil'
      order("#{sort_column} #{sort_direction}")
    else
      joins(join_model).order("#{sort_column} #{sort_direction}")
    end
  end 
```

我只是`worker_id`通过`sort_column`

谢谢，肖恩

# asp.net - 缓存网站的 Active Directory 查询

> ID：11996913
> 
> 赞同：2
> 
> 时间：2012-08-16T23:34:24.560
> 
> 标签：asp.net, caching, web-applications, active-directory, directoryservices

我经常向 AD 查询信息（例如获取 Windows 主体、安全组等），并且想知道缓存此类信息的好方法。例如：

```
var pc = new PrincipalContext(ContextType.Domain);
var up = UserPrincipal.FindByIdentity(pc, User.Identity.Name); 
```

我希望完成的是`FindByIdentity()`或类似的事情来决定“嘿，我最近运行了这个查询，我们不要再打扰 AD 了”并从本地缓存中获取它？

**问题 1：** DirectoryServices 或任何相关库是否提供此类机制？

**问题 2：**其次，这些查询是在 Http 请求上触发的，每秒可能有数百个。如果我必须编写自己的缓存机制，正如@HillBilly.Developer 下面建议的那样，缓存存储的首选范围是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T01:11:45.907

创建一个表示要存储的数据的类，填充它，将其存储在缓存中并过期。

**未经测试！，但应该给你的想法**

```
public class UserData 
{
     public string Username {get; set;}
     public string Email {get; set;} 
} 
```

然后，您需要填充它的位置：

```
List<UserData> ud;

ud = (List<UserData>)Cache["UserData"];

if(ud == null) 
{
        ud = AD.RetrieveUsers();
        Cache.Add("UserData", ud, null, DateTime.Now.AddHours(1), Cache.NoSlidingExpiration, CacheItemPriority.High, null);
} 
```

显然，调用`AD.RetrieveUsers()`将是您必须向 AD 查询数据的任何类/函数。

# c++ - std::mutex 和 condition_variable 无法访问类内的私有成员

> ID：11996916
> 
> 赞同：2
> 
> 时间：2012-08-16T23:34:39.037
> 
> 标签：c++, multithreading, mutex

我已经进行了一些谷歌搜索，并看到了有关此问题的堆栈溢出的类似问题，但我无法理解处理它的原因/解决方案。鉴于在 ThreadPool.hpp 中声明的以下类，我收到以下 2 个错误：

错误 1 ​​错误 C2248: 'std::mutex::mutex' : 无法访问在类 'std::mutex' c:\users\jesse\documents\school\summer term 2012\concurrent processing\project 2\ultra_grep 中声明的私有成员v2\ultra_grep\threadpool.hpp 39 1 ultra_grep2

错误 2 错误 C2248：“std::condition_variable::condition_variable”：无法访问在类“std::condition_variable”c:\users\jesse\documents\school\summer term 2012\concurrent processing\project 2\ultra_grep 中声明的私有成员v2\ultra_grep\threadpool.hpp 39 1 ultra_grep2

```
class ThreadPool
{
private:
std::queue<std::string> _consoleTasks;
std::queue<std::tr2::sys::path> _tasks;
std::map<std::string, std::vector<GrepMatch>> _grepMatches;
int _nThreads, _fileMatches, _totalMatches, _workingThreads;
std::vector<thread> _threads;
Arguments _args;
std::mutex _taskMutex, _wakeMutex, _consoleMutex, _threadCountMutex;
std::condition_variable _wakeCondition;

public:
ThreadPool( int threads, Arguments args );
~ThreadPool() {};
void GrepFunc();
void ConsoleFunc();
void SearchFile( std::string );
void SearchFileVerbose( std::string );
void DisplayGrepResults();

queue<std::tr2::sys::path> Tasks() { return _tasks; }

}; 
```

以及在 ThreadPool.cpp 中实现的代码：

```
#include "ThreadPool.hpp"

using namespace std;
namespace fs = std::tr2::sys;

ThreadPool::ThreadPool( int threads, Arguments args )
: _nThreads( threads ), _args( args ), _fileMatches( 0 ), _totalMatches( 0 ), _workingThreads( 0 )
{

for( int i = 0; i < _nThreads; ++i )
{
        _threads.push_back( thread( &ThreadPool::GrepFunc, this ) );
        _tasks.push( args.root() );
        ++_workingThreads;
        _wakeCondition.notify_one();
}

for( auto& t : _threads )
{
    t.join();
}

DisplayGrepResults();
}

void ThreadPool::GrepFunc()
{
// implement a barrier()

while( !_workingThreads )
{
    { unique_lock<mutex> lk( _wakeMutex );
    _wakeCondition.wait( lk ); }

    while( !_tasks.empty() )
    {
        fs::path task;
        bool gotTask = false;
        {
            lock_guard<mutex> tl( _taskMutex );
            if( !_tasks.empty() )
            {
                { lock_guard<mutex> tc( _threadCountMutex );
                ++_workingThreads; }
                task = _tasks.front();
                _tasks.pop();
                gotTask = true;
            }
        }

        if( gotTask )
        {
            if( fs::is_directory( task ) )
            {
                for( fs::directory_iterator dirIter( task ), endIter; dirIter != endIter; ++dirIter )
                {
                    if( fs::is_directory( dirIter->path() ) )
                    {
                        { lock_guard<mutex> tl( _taskMutex );
                        _tasks.push( dirIter->path() ); }
                        _wakeCondition.notify_one();
                    }
                    else
                    {
                        for( auto& e : _args.extensions() )
                        {
                            if( !dirIter->path().extension().compare( e ) )
                            {
                                { lock_guard<mutex> tl( _taskMutex );
                                _tasks.push( dirIter->path() ); }
                                _wakeCondition.notify_one();
                                //SearchFile( dirIter->path() );
                            }
                        }
                    }
                }
            }
            else
            {
                for( auto& e : _args.extensions() )
                {
                    if( !task.extension().compare( e ) )
                    {
                        if( _args.is_verbose() )
                            SearchFile( task );
                        else
                            SearchFileVerbose( task );
                    }
                }
            }

            { lock_guard<mutex> tc( _threadCountMutex) ;
            --_workingThreads; }
        }
    }
}
}

void ThreadPool::SearchFileVerbose( string path )
{
fstream file;
file.open( path );

if( !file )
{
    // error handling
}
else
{
    { 
        lock_guard<mutex> cm( _consoleMutex );
        cout << "\nGrepping: " << path << endl;

        int lineNumber = 1;
        string line;
        vector<GrepMatch> matches;
        while( getline( file, line ) )
        {
            int lineMatches = 0;
            sregex_token_iterator end;
            for (sregex_token_iterator i(line.cbegin(), line.cend(), _args.regular_expression() );
                i != end;
                ++i)
            {
                ++lineMatches;
            }

            if( lineMatches > 0 )
            {
                GrepMatch match = GrepMatch( lineNumber, lineMatches, line );
                matches.push_back( match );
                cout << "Matched " << lineMatches << ": " << path << " [" << lineNumber << "] " << line << endl; 
            }

            ++lineNumber;
        }

        if( !matches.empty() )
        {
            _grepMatches[ path ] = matches;
        }
    }
}
} 
```

我在互斥锁和 condition_variable 上都收到错误，说它们无法访问在类中声明的私有成员。据我了解，这是指复制构造函数？虽然我不明白为什么这会起作用，因为我看不到我要在哪里制作副本，因为它们只是班级的私人成员。

根据最初的评论，我只实例化了一个 ThreadPool 实例，它不会被复制到任何地方。我唯一一次尝试触摸互斥锁是在我的班级的 .cpp 实现中。

谁能帮助我更好地理解为什么会这样？

对于那些感兴趣的是编译器输出：

```
1>------ Build started: Project: ultra_grep2, Configuration: Debug Win32 ------
1>  ultra_grep_main.cpp
1>  Unknown compiler version - please run the configure tests and report the results
1>c:\users\jesse\documents\school\summer semester 2012\concurrent processing\project 2\ultra_grep v2\ultra_grep\threadpool.hpp(39): error C2248: 'std::mutex::mutex' : cannot access private member declared in class 'std::mutex'
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\mutex(116) : see declaration of 'std::mutex::mutex'
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\mutex(107) : see declaration of 'std::mutex'
1>          This diagnostic occurred in the compiler generated function 'ThreadPool::ThreadPool(const ThreadPool &)'
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\mutex(116) : see declaration of 'std::mutex::mutex'
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\mutex(107) : see declaration of 'std::mutex'
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\mutex(116) : see declaration of 'std::mutex::mutex'
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\mutex(107) : see declaration of 'std::mutex'
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\mutex(116) : see declaration of 'std::mutex::mutex'
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\mutex(107) : see declaration of 'std::mutex'
1>c:\users\jesse\documents\school\summer semester 2012\concurrent processing\project 2\ultra_grep v2\ultra_grep\threadpool.hpp(39): error C2248: 'std::condition_variable::condition_variable' : cannot access private member declared in class 'std::condition_variable'
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\condition_variable(45) : see declaration of 'std::condition_variable::condition_variable'
1>          c:\program files (x86)\microsoft visual studio 11.0\vc\include\condition_variable(30) : see declaration of 'std::condition_variable'
1>          This diagnostic occurred in the compiler generated function 'ThreadPool::ThreadPool(const ThreadPool &)'
1>  ThreadPool.cpp
1>  Generating Code...
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-17T00:44:18.680

问题出在你的想法上；编译器生成的复制构造函数和赋值运算符失败，因为 mutex 和 condition_variable 不可复制。在许多不容易看到的情况下，编译器仍然会为这两种情况生成代码，即使您不是故意调用它们。根据我的经验，此错误通常是由于尝试将类型与标准库容器一起使用而引起的。

即使您没有遇到此问题，您也应该添加一个空的私有复制构造函数和赋值运算符；我认为尝试复制线程池是不可取的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-17T12:51:55.370

错误在某处：

> 1> ultra_grep_main.cpp

*使用*的复制构造函数的`ThreadPool`位置：

 *> 此诊断发生在编译器生成的函数“ThreadPool::ThreadPool(const ThreadPool &)”中

我实际上很惊讶编译器没有指向源文件中隐式生成复制构造函数的哪一行。

在评论中，您询问复制构造函数的外观。一个更好的问题是复制一个对象是否有意义，`ThreadPool`答案是一般来说没有意义。要改进错误消息，您可以将复制构造函数标记为`deleted`，这样（希望）编译器将生成更好的错误报告，说明需要复制的位置：

```
class ThreadPool {
   ThreadPool( ThreadPool const & ) = delete;
// ...
}; 
```

如果您的编译器不支持此 C++11 功能，则另一种方法是*声明*复制构造函数但不定义它。这将在使用复制构造函数的地方触发访问错误。*

# django - 如何从视图返回变量并根据上下文输出模板或原始 JSON？

> ID：11996921
> 
> 赞同：0
> 
> 时间：2012-08-16T23:34:51.763
> 
> 标签：django, json, django-templates, django-views

我目前没有特别需要这样做。我只是好奇什么是最好的方法来做到这一点：

example.com/cars/honda/ -- 可能会返回一个汽车模板页面，其中包含有关 Hondas 的图片和信息 example.com/cars/honda.json -- 会返回一个带有 Honda 信息的 JSON 对象

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-16T23:38:38.067

通常，使用 RESTful API，这类事情是通过[内容类型协商](http://en.wikipedia.org/wiki/Content_negotiation)来处理的。我没用过，但是[Django REST framework](http://django-rest-framework.org/)可以提供内容协商。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:37:36.930

有一个函数负责整理信息，然后有两个单独的视图负责调用通用函数并渲染模板或编码为 JSON。

# html - 显示：无 - 在移动设备上显示，但在桌面上不显示

> ID：11996925
> 
> 赞同：1
> 
> 时间：2012-08-16T23:35:13.310
> 
> 标签：html, css, mobile, desktop

我正在尝试使用`display: none`这样一个元素将显示在较小的分辨率（或移动设备）上，但不会出现在较大的屏幕尺寸的主 css 上。

我认为它没有显示可能是合乎逻辑的，但我无法找到解决这个问题的方法。

```
footer {
    display: none;
}

@media handheld and (max-width:480px),
screen and (max-device-width: 480px),
screen and (max-width: 600px)
{
  footer {
    background-color: #colour;
    position:fixed;
    bottom: 0;
    left: 0;
    right: 0;
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:43:25.880

您可以将其设置为`display:block`在您的媒体查询中，这将覆盖 display:none;

另一种方法是 jQuery/Javascript 解决方案，可能是这样的： 注意：这是使用[jQuery](http://jquery.com/)库，可以很好地处理诸如此类的事情，因为它很容易提高浏览器的兼容性和易用性。

```
<script type="text/javascript">
$(document).ready(function (){
    if( navigator.userAgent.match(/Android/i) ||
     navigator.userAgent.match(/webOS/i) ||
     navigator.userAgent.match(/iPhone/i) ||
     navigator.userAgent.match(/iPod/i) ||
     navigator.userAgent.match(/BlackBerry/)
     ){
    $(.footer).css("display:none")  
    } else {

        $('.footer').css("display:block")
        });
    }
});
</script> 
```

# asp.net-mvc-3 - 将二进制数据转换为图像 -Silverlight 或 Asp.Net

> ID：11996932
> 
> 赞同：0
> 
> 时间：2012-08-16T23:36:09.643
> 
> 标签：asp.net-mvc-3, c#-4.0, silverlight-4.0

我们有购买应用程序，用户将在其中上传发票文件。我们将文档存储在具有 mime 类型的数据库中。文档类型因用户而异，例如 .doc、.docx、.xls、.xlsx、图像、.pdf 等。客户要求应用程序需要以 PDF 格式显示所有发票文件。附件示例文档.. 以下是需要即时创建的不同部分 1\. 标题中的用户详细信息。2\. 发票名称在页脚。3\. 发票汇总明细见表。4\. 发票跟单。我们正在使用带有 Telerik 控件的 Silverlight 4.0。我正在考虑将文档转换为图像并放置在 PDF 中。它看起来很简单，但是当我开始探索那些将不同类型的文档转换为图像时并不是一件容易的事。我完全没有想法了。您能否指导我正确的方向如何实现上述方案？真正感谢您提前提供的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T02:53:28.230

从长时间的解释来看，这就是我所理解的你所追求的：

```
public byte[] imageToByteArray(System.Drawing.Image imageIn)
{
 MemoryStream ms = new MemoryStream();
 imageIn.Save(ms,System.Drawing.Imaging.ImageFormat.Gif);
 return  ms.ToArray();
}

public Image byteArrayToImage(byte[] byteArrayIn)
{
 MemoryStream ms = new MemoryStream(byteArrayIn);
 Image returnImage = Image.FromStream(ms);
 return returnImage;
} 
```

希望对你有帮助，如果没有，请说出来

# javascript - 安全地实施用于 Facebook 身份验证的 Javascript SDK

> ID：11996935
> 
> 赞同：1
> 
> 时间：2012-08-16T23:36:36.007
> 
> 标签：javascript, facebook, facebook-graph-api

我目前正在尝试在我的网站中实施 Facebook 身份验证，但我看到了许多主要的安全漏洞。我可以与服务器就刚刚对我的应用程序进行身份验证的用户进行通信的唯一方法是使用某种 POST 或 GET 请求到另一个页面，该页面将 facebook ID 与填充了用户 facebook ID 和站点用户 id 的数据库相匹配。攻击者只需获取用户的 Facebook ID，并向服务器发送人工请求，即可访问该帐户。使用服务器端通信实现 Facebook Authentication Javascript SDK 的更安全方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:39:49.773

我认为最好将这个问题重复为：仅发送 facebook id 以登录某人时，如何最好地保护我的登录系统？那是对的吗？

我认为问题与正常登录相同。您至少需要 2 个字段才能正确确认用户的身份。为什么不选择他们的电子邮件、他们的 ID，我相信他们的访问令牌。此访问令牌应直接从 facebook 传递。然后，您可以使用此令牌服务器端并询问 facebook 令牌是否有效。

看看这个：[https ://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/](https://developers.facebook.com/blog/post/2011/05/13/how-to--handle-expired-access-tokens/)

另外：[自offline_access弃用以来如何扩展访问令牌的有效性](https://stackoverflow.com/questions/8982025/how-to-extend-access-token-validity-since-offline-access-deprecation/9035036#9035036)

# php - mysql，如何对存储为字段值的数组中的值求和？

> ID：11996936
> 
> 赞同：0
> 
> 时间：2012-08-16T23:36:39.283
> 
> 标签：php, mysql, arrays

用户表是这样的：

```
user_id  |  key     |   value
1          option      $array
2          other        abc
2         option      $array 
```

我需要查询所有用户的选项字段，值是这样的数组：

```
$array=array('item_id'=>123, 'key1'=>'abc', 'key2'=>'1', 'key3'=>'5',) 
```

然后，对该数组中 key2 的所有值求和。

我能想到的唯一方法是制作一个虚拟表，每个数组为一行。也许这是不可能的。那么，如何在选项字段中为所有用户的 key2 求和？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:15:40.063

除了 Cihan 的回答（对每一行求和），或在数据库中创建一个视图（并且该视图需要了解数组的序列化）之外，最快的方法是“正确”存储数据，而不是存储在一个 munged 字段中像那样。

如果您想要快速和定期求和，请创建第二个表：

```
user_id  |  key     |   array_key | value 
1          option      item_id        123
1          option      key1           abc 
1          option      key2           2
2          other       NULL           123
2          option      item_id        456 
```

如果它不是数组，您可以将 array_key 留空（或 NULL）。

将需要一些重新思考并可能重组一些代码，但如果你总结了很多，它会更干净，更容易调试并且最终更快。缺点是创建新条目时要更新更多行。

如果你想要单行，你可以使用 GROUP BY 和 GROUP_CONCAT。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:05:21.130

```
$query = mysql_query("SELECT * FROM table WHERE key = 'option'");

while($row = mysql_fetch_array($query)){    
   $array_sum_values[] = $row['value']['key2']; //We are creating a new array. }

$result = array_sum($array_sum_values); 
```

如果我完全理解你，这里就是解决方案。

或者，

```
 $query = mysql_query("SELECT * FROM table WHERE key = 'option'");
 $array_sum = 0;
while($row = mysql_fetch_array($query)){    
   $array_sum += $row['value']['key2']; //We are creating a new array.} 
```

# javascript - AngularJS：使用嵌套的 JQuery Sortables 时保持 Dom 和 Model 同步

> ID：11996941
> 
> 赞同：0
> 
> 时间：2012-08-16T23:37:16.173
> 
> 标签：javascript, angularjs

使用嵌套的 JQuery 可排序对象时，如何使 DOM 和模型保持同步？假设我有一个控制器，其定义如下：

```
function testCtrl($scope) {
    $scope.data = [{'name' : 'Test 1',
                   'index' : 0,
                   'values': [{'name' : 'sub test 1-1', 'index' : 0}, {'name' : 'sub test 1-2', 'index' : 1}]},
                   {'name' : 'Test 2',
                   'index' : 1,
                   'values': [{'name' : 'sub test 2-1', 'index' : 0}, {'name' : 'sub test 2-2', 'index' : 1}]}
   ];

   $scope.orderProp = 'index';
} 
```

现在我想使用以下模板在 JQuery sortables 中显示第一级数据和第二级数据：

```
<ul ng-sortable='data'>
    <li ng-repeat="d in data | orderBy:orderProp">
        <p>{{d.name}}</p>
        <ul ng-Sub-Sortable="d.values">
            <li ng-repeat="sub in d.values">{{sub.eg}}</li> 
        </ul>
    </li>
</ul> 
```

我使用指令来指定两种不同类型的可排序列表，因为它们的行为确实不同（为简洁起见，从下面删除）：

```
app.directive("ngSortable", function(){
    return {
        link: function(scope, element, attrs){                  
            element.sortable();
        }
    };
}

app.directive("ngSubSortable", function(){
    return {
        link: function(scope, element, attrs){                  
            element.sortable();
        }
    };
} 
```

现在，当用户对列表进行排序时，我如何更新模型以确保索引正确，从而将来正确输出列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-03T03:33:06.727

最好用 ngModel 和 dom 同步数据

你可以试试这个： [https ://github.com/JimLiu/Angular-NestedSortable](https://github.com/JimLiu/Angular-NestedSortable)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T21:59:57.677

对于嵌套排序中具有位置相关数据的项目，我发现保持模型与 DOM 同步的最佳方法是将当前位置作为属性添加到每个元素，如下所示：

```
<ul ng-sortable='data'>
    <li ng-sortable-index="{{$index}}" ng-repeat="d in data | orderBy:orderProp">
        <p>{{d.name}}</p>
        <ul ng-Sub-Sortable="d.values">
            <li ng-sortable-index="{{$index}}" ng-repeat="sub in d.values">{{sub.eg}}</li> 
        </ul>
    </li> 
```

然后在初始化 jQuery 可排序的指令中，可排序更新方法应指定如下：

```
element.sortable({
    update: function(event, ui) {
        var model = scope.$eval(attrs.ngSubSortable);

        // loop through items in new order
        element.children().each(function(index) {
            // get old item index
            var oldIndex = parseInt($(this).attr("ng-sortable-index"), 10);
            model[oldIndex].index = index;
         });

         scope.$apply();
     }
}); 
```

# visual-studio-2012 - Visual Studio 2012 Fakes 不会为具有 Stream 返回类型的方法的接口生成存根

> ID：11996943
> 
> 赞同：4
> 
> 时间：2012-08-16T23:37:25.193
> 
> 标签：visual-studio-2012, moles, stub, stubbing, microsoft-fakes

使用 Visual Studio 2012 生成带有“Add Fakes Assembly”的存根，一切都按预期工作，除了无法为此接口生成存根：

```
public interface IFileWrapper
{
    IEnumerable<string> ReadLines(string path);
    bool Exists(string path);
    Stream OpenReadStream(string path);
} 
```

当我将 Stream 更改为 FileStream 时（因为 Stream 是一个抽象类，我想检查这是否只发生在抽象类中），我仍然无法生成。当我完全删除方法签名（即删除`Stream OpenReadStream(string path);`）时，我能够生成存根。

这是我的 .fake 文件内容：

```
<Fakes xmlns="http://schemas.microsoft.com/fakes/2011/" Diagnostic="true" Verbosity="Noisy">
  <Assembly Name="System.IO.Abstractions"/>
  <StubGeneration>
    <Clear />
    <Add AbstractClasses="true"/>
    <Add Interfaces="true"/>
  </StubGeneration>
  <ShimGeneration>
    <Clear />
  </ShimGeneration>
</Fakes> 
```

1.  知道为什么会发生这种情况，我该如何避免？
2.  应该有一个 Visual Studio 输出面板，其中将显示 Fake 生成结果。我看不到任何东西，它们也没有显示在常规构建面板中。我可以在哪里找到它的任何想法？我搜索了所有 VS 2012 菜单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T19:20:15.610

这是由于 Fakes 当前实施的限制造成的。您可以通过将单元测试项目中的目标框架从 4.0 切换到 4.5 来解决此问题。

# mysql - 在mysql中检查行存在的最佳方法

> ID：11996945
> 
> 赞同：0
> 
> 时间：2012-08-16T23:37:25.970
> 
> 标签：mysql, performance

这不是问题，只是我的好奇心。以下哪种方式最适合从表中获取事件行并检查用户是否是其所有者？

我见过类似的问题，但我想了解为什么一个比另一个快？

```
$query = mysql_query("SELECT id FROM event WHERE uid='".$user_id."' AND event_id = '".$id."'");
$checkCreator = mysql_num_rows($query);
if ($query > 0) {
  //user is the event owner
} 
```

或者

```
$query = mysql_query("SELECT uid FROM event WHERE event_id='".$event_id."'");
$checkCreator = mysql_fetch_array($query);
if ($checkCreator['uid'] == $user_id) {
   //user is the event owner
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:50:44.233

据我所知，mysql_num_rows 函数比 mysql_fetch_array 快。但是查询数据库后会看到正确的答案。

# google-search - Google 搜索结果返回的链接不在我的网站上

> ID：11996948
> 
> 赞同：3
> 
> 时间：2012-08-16T23:37:59.283
> 
> 标签：google-search

如果您在 Google 上搜索“Colla Voce Music”，您会看到结果显示 Cialis、Viagra 和 Lipitor 作为网站上的页面。我到处搜索，网站本身并没有受到损害。我已经搜索了文件和数据库。谷歌网站管理员工具在网站上也没有显示恶意软件。我在哪里以及如何解决这个问题？我已经上传了结果的截图。我还不能上传图片，但是如果你用谷歌搜索就很明显了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T01:16:03.023

至少在您的一个页面中提供了伟哥产品。在此网址中查看：[http ://collavoce.com/index.php?option=com_zoo&task=item&item_id=328&Itemid=188](http://collavoce.com/index.php?option=com_zoo&task=item&item_id=328&Itemid=188)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-17T00:14:59.857

当 googlebot 抓取您的网站时，那里有指向这些项目的链接。查看站点建议背后的 URL，看起来这些 URL 很可能是从数据库提供的（请参阅：itemId194）。

您可能在某个时候遭受了 SQL 注入攻击，从而将这些项目放置在您的项目数据库中。

这些 URL 最终会过期，但您可以尝试使用 Google Webmaster tools 删除 URL 工具来请求加快删除。请参阅：[https ://www.google.com/webmasters/tools/removals](https://www.google.com/webmasters/tools/removals)

# jquery - jquery .contains() 语法奇怪的错误

> ID：11996949
> 
> 赞同：2
> 
> 时间：2012-08-16T23:38:02.247
> 
> 标签：jquery, syntax

我在 jquery 中发生了一个奇怪的错误。

当我到达：[http ://www.autopartscenter.net/](http://www.autopartscenter.net/)

尝试进行搜索时出现 .js 错误

但是，如果我去[http://www.autopartscenter.net/home](http://www.autopartscenter.net/home)（这是完全相同的页面），搜索工作正常。

我已经缩小了导致它崩溃的罪魁祸首 jquery：[http ://www.autopartscenter.net/assets/js/common.js](http://www.autopartscenter.net/assets/js/common.js)

```
$('#ddlMake option:contains(' + make[1] + ')').attr('selected', true); 
```

这似乎是某种语法错误。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-16T23:47:46.147

我想是因为这个

```
var make = location.pathname.split("/"); 
```

当您在此页面[http://www.autopartscenter.net/home](http://www.autopartscenter.net/home)中时，make[1] 等于 'home' 而在此页面中[http://www.autopartscenter.net](http://www.autopartscenter.net) make[1] 未定义，这就是为什么以下代码中断

```
$("#ddlMake option:contains(" + make[1] + ")").attr('selected', true); 
```

# javascript - Sammy.js 中的部分车把

> ID：11996951
> 
> 赞同：0
> 
> 时间：2012-08-16T23:38:28.733
> 
> 标签：javascript, html, templates, handlebars.js, sammy.js

我一直在搜索 sammy.js 和车把的文档很长一段时间，但我一辈子都无法确定[http://sammyjs.org/docs/api/0.7.1/all#的位置Sammy.Handlebars](http://sammyjs.org/docs/api/0.7.1/all#Sammy.Handlebars)（示例 #2）mypartial.hb 被指示加载到 {{>hello_friend}}。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-10T14:23:00.877

我这个问题很老，但对于所有 sammyjs 爱好者

```
var app = $.sammy('#app', function(){

    this.use('Mustache', 'ms');

    this.get('#/hello/:name/to/:friend', function(context){
        this.load('mypartial.ms')
        .then(function(partial){
            context.partials = {hello_friend: partial};
            context.name = context.params.name;
            context.friend = context.params.friend;

            context.partial('mytemplate.ms');
        });
    });
}); 
```

[http://sammyjs.org/docs/api/0.7.4/all#Sammy.Handlebars](http://sammyjs.org/docs/api/0.7.4/all#Sammy.Handlebars) 注意版本是 0.7.4

# citrix - 远程注销 citrix xenappsession

> ID：11996952
> 
> 赞同：0
> 
> 时间：2012-08-16T23:38:33.833
> 
> 标签：citrix, xenapp

如何以编程方式注销 citrix xen 应用程序会话（我知道服务器、uid、pwd）。C# 使用什么 api？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T07:07:31.920

您可以将 WTSLogoffSession 用于远程案例和本地案例。但是，您需要先使用 WTSOpenServer 获取服务器的句柄（然后使用 WTSCloseServer 将其关闭）。请注意，这些不是 C# API，它们是本机的。但是，您可以使用 Platform Invoke 从 C# 调用它们。

# vba - 使用 vba word 更改段落中的文本

> ID：11996956
> 
> 赞同：1
> 
> 时间：2012-08-16T23:39:18.187
> 
> 标签：vba, ms-word

我正在尝试使用 vba word 更改段落中的文本。以下代码导致 Next 不转到集合中的下一个元素。

```
 Sub ReadPara()
 Dim myString$
 Dim DocPara As Paragraph

 For Each DocPara In ActiveDocument.Paragraphs
   'Debug.Print DocPara.Range.ParagraphStyle '; " - "; DocPara.Range.Text
   If Left(DocPara.Range.ParagraphStyle, Len("Heading")) = "Heading" Then
     Debug.Print DocPara.Range.ListFormat.ListString
   End If
  'This section does not go to the next element in the collection
  If InStr(DocPara.Range.Text, "HW") > 1 Then
    Debug.Print DocPar; qa.Range.Text
    myString$ = DocPara.Range.Text
    DocPara.Range.Text = myString$ & "Changed"
   '  Debug.Print DocPara.Range.Text
  End If
 Next DocPara
 End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-19T08:20:47.753

第二个问题：

`ParagraphStyle`是只读的，请`Style`改用。两者都是 type `Variant`，所以你不要使用`Set`.

尝试这个：

```
DocPara.Range.Style = ActiveDocument.Styles("Normal") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-22T15:18:03.257

现在代码可以工作了，只是我仍然不去下一段。我似乎停留在同一段。下一个 DocPara 并没有像我预期的那样工作。

```
 Option Explicit
    Sub ReadPara()

    Dim myString$
    Dim myHeading$
    Dim DocPara As Paragraph
    For Each DocPara In ActiveDocument.Paragraphs
       If Left(DocPara.Range.ParagraphStyle, Len("Heading")) = "Heading" Then
          myHeading$ = DocPara.Range.ListFormat.ListString
       ElseIf InStr(DocPara.Range.Text, "HW") > 1 Then
          myString$ = DocPara.Range.Text
          With DocPara.Range
             myString$ = Replace(myString, "HW", "HW-" & myHeading$)
             .Text = myString$
             .Style = ActiveDocument.Styles("Normal")
          End With
       End If
    Next DocPara
    End Sub 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-17T15:28:42.987

我已经克服了我的第一个问题，不，这不是错字。错字只是在消息中，而不是在我的代码中。现在我似乎无法更改新修改段落的样式。

```
 Option Explicit
    Sub ReadPara()
     Dim myString$
     Dim myHeading$
     Dim DocPara As Paragraph

     For Each DocPara In ActiveDocument.Paragraphs
       If Left(DocPara.Range.ParagraphStyle, Len("Heading")) = "Heading" Then
         myHeading$ = DocPara.Range.ListFormat.ListString
       ElseIf InStr(DocPara.Range.Text, "HW") > 1 Then
         myString$ = DocPara.Range.Text
         myString$ = Replace(myString, "HW", "HW-" & myHeading$)
         DocPara.Range.Text = myString$
         'The line below doesn't work at all
         Set DocPara.Range.ParagraphStyle = ActiveDocument.Styles("Normal")
       End If
     Next DocPara
     End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T06:32:19.877

以下行将导致错误并且（取决于您的错误处理）可能会导致执行跳出循环：

```
Debug.Print DocPar; qa.Range.Text 
```

如果你`Option Explicit`在每个代码模块的顶部输入（为了强制每个变量都被显式声明），这种错误可能会更早发现。:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-30T07:12:42.503

而不是使用

```
 For Each DocPara In ActiveDocument.Paragraphs
   'Rest of your code it here
 Next DocPara 
```

利用

```
 For p = 1 to ActiveDocument.Paragraphs.Count
   'Rest of your code it here
    'use the script below when refering the the specific paragraph
    ActiveDocument.Paragraphs(p). 
 Next p 
```

# css - @fontface 没有正确安装

> ID：11996958
> 
> 赞同：0
> 
> 时间：2012-08-16T23:39:48.723
> 
> 标签：css, font-face

我刚刚带来了第一次使用的网络字体。我已经将它上传到我们的测试服务器，它可以在办公室的所有机器上运行，除了一台笔记本电脑。

在发现笔记本电脑无法工作后，我在 crossbrowsertesting.com 上跨所有平台进行了测试，发现它没有出现在任何平台上。

然后，我上传了 mywebsfontkit 文件夹，其中包含如何将 webfont 安装到我的服务器的说明，并进行了另一次跨浏览器检查，发现字体开始在某些浏览器上工作，但是当我尝试将其放入我自己的页面时它失败了。

我已经尝试了几种方法来使它工作。1 - 我将字体的完整 url 路径放入 - 没有发生任何事情 2 - 我已将 webfonts 放在我的服务器的根文件夹和根文件夹中 3 - 我尝试以不同的方式调用字体博物馆，即 font-family ：'Museo' 或字体系列：'Museo-700'。

在我发布的示例中，您会看到对于导航，我将 museo 称为 museo-700，而现在在我的机器上调用 arial 而在标题中的文本上，我将 museo 称为 font-family: 'Museo'。我知道该字体不适用于所有浏览器，但我无法弄清楚为什么它会在一个文件中而不是另一个文件中工作。

我还添加到我的 .htaccess 文件 AddType font/ttf .ttf AddType font/eot .eot AddType font/otf .otf AddType font/woff .woff

保存字体的样式表被称为如下

```
 <link rel="stylesheet" type="text/css" href="css/type.css" /> 
```

具有字体的样式表

```
 @font-face {font-family: 'Museo-900';src: url('webfonts/23C024_0_0.eot');src: url('webfonts/23C024_0_0.eot?#iefix') format('embedded-opentype'),url('webfonts/23C024_0_0.woff') format('woff'),url('webfonts/23C024_0_0.ttf') format('truetype');}

 @font-face {font-family: 'Museo-700';src: url('webfonts/23C024_1_0.eot');src: url('webfonts/23C024_1_0.eot?#iefix') format('embedded-opentype'),url('webfonts/23C024_1_0.woff') format('woff'),url('webfonts/23C024_1_0.ttf') format('truetype');}

 @font-face {font-family: 'Museo-500';src: url('webfonts/23C024_2_0.eot');src: url('webfonts/23C024_2_0.eot?#iefix') format('embedded-opentype'),url('webfonts/23C024_2_0.woff') format('woff'),url('webfonts/23C024_2_0.ttf') format('truetype');} 
```

以及我如何调用导航和标题的字体

```
 #nav ul li {
float: left;
position: relative;
color:#000;
font-family: 'Museo-700', Arial, sans-serif;
font-size: 12px;
font-weight: normal;
}

    .title-900 {
font-family: 'Museo-900', Arial, sans-serif !important;
font-weight: normal;
font-size:18px;
line-height:20px;
color:#9BC255;
padding-bottom:10px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-16T23:51:27.557

在`@font-face`您调用加载字体的部分中`Museo-900`，`Museo-700`您`Museo-500`必须在常规指令中**使用相同的字体系列，例如：**

```
font-family: "Museo-900", Arial, sans-serif !important; 
```

除此之外，我在您的沙箱中看不到任何其他可能导致此类问题的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-13T18:54:56.467

仅供日后阅读参考。以下是有助于解决此类问题的通用方法：

一种。首先检查您的 css 框架文件是否在您的自定义 css 文件之前加载。您的自定义 css 文件必须在框架/小部件 css 文件之后加载才能具有更高的优先级。

湾。字体属性是一个可继承的 CSS 属性。这意味着如果您已将它应用于 body 标签，那么所有 html 元素都将从 body 标签继承它，前提是没有中间元素具有不同的 font-family 属性指定值。确保您的 DOM 中不存在此类元素。此外，您的字体文件应该以 200 状态显示在网络选项卡中。

C。计算元素的字体族属性的特异性。有时，即使在下载新字体后我们也没有得到预期的结果，因为我们的字体系列具有较低的特异性（优先级）。

# javascript - JavaScript 函数在 IE9 中随机中断

> ID：11996960
> 
> 赞同：-1
> 
> 时间：2012-08-16T23:39:57.953
> 
> 标签：javascript

我的网站出现问题，主导航在 IE9 中不再工作。它以前工作过，但突然之间，它停止工作了。奇怪的是，如果我在 IE9 上访问该站点，它们可以工作，但是当我 ctrl+f5 页面时，它会中断。

我假设我的 custom.js 文件中存在问题，因为这是我的主要“导航栏”js 编码的文件。我不确定它的编码是否完全正确，但该网站在 chrome、firefox、safari 中完美运行，所以我真的不觉得 JS 搞砸了。

custom.js 就在这里：（关注 [4] Nav Bar I'm Assuming）

```
/* --------------------------------------------------------------

INDEX:

[1] Search
[2] Popout Window
[3] Form Numbers
[4] Nav Bar
[5] Smooth Scroll
[6] Similar Pages Sidebar
[7] Estimate Form

-------------------------------------------------------------- */

/* --------------------------------------------------------------

[1*] Search

-------------------------------------------------------------- */

document.getElementById('headerSearch').onsubmit = function() {
    window.location = "javascript:poptastic('http://www.google.com/search?q=site:northtownsremodeling.com ' + document.getElementById('headerInput').value);"
      return false;}

/* --------------------------------------------------------------

[2*] Popout Window

-------------------------------------------------------------- */

var newwindow; function poptastic(url){
  newwindow=window.open(url,'name', 'height=800,width=1020,scrollbars=yes');
    if (window.focus) {newwindow.focus()}}

/* --------------------------------------------------------------

[3*] Form Numbers

-------------------------------------------------------------- */

jQuery(function($){
    $("#menu-primary-number").mask("(999) 999-9999");
    $("#menu-zip").mask("99999");
});

/* --------------------------------------------------------------

[4*] Set Selected Menu Items & Hide

-------------------------------------------------------------- */
/*START FUNCTION*/
$(function() {

    $("#header-subnav ul").hide();
    $('.menu-option-set a[data-subid]').on('click', function(e) {
        e.preventDefault();
        var $s = $("#" + $(this).attr('data-subid'));                
        if($s.is(':hidden')) {
            $("#header-subnav").removeClass('hidden');
            $("#header-subnav ul").hide();
            $s.show();
        } else {
            $s.hide();
            $("#header-subnav").addClass('hidden');
        }
    });

    $('.menu-option-set a').click(function()
    {
        // if clicked item is selected then deselect it
        if ($(this).hasClass('selected'))
        {
            $(this).removeClass('selected');
        }

        // otherwise deselect all and select just this one
        else
        {
            $('.menu-option-set a').removeClass('selected');
            $(this).addClass('selected');
        }
    });
});

/* --------------------------------------------------------------

[5*] Smooth Scroll

-------------------------------------------------------------- */
$(function() {
    $('.navbar a, .scroll a, .smoothscroll a').bind('click',function(event){
        var $anchor = $(this);

        $('html, body').stop().animate({
            scrollTop: $($anchor.attr('href')).offset().top
        }, 850,'easeInOutExpo');
        /*
        if you don't want to use the easing effects:
        $('html, body').stop().animate({
            scrollTop: $($anchor.attr('href')).offset().top
        }, 1000);
        */
        event.preventDefault();
    });
});

/* --------------------------------------------------------------

[6*] Similar Pages Sidebar

-------------------------------------------------------------- */
$(function() {
  $("a.show-similar-pages").click(function(e) {
    $("#sidebar").removeClass('mobile-phone-hide');
    $("#show-similar-pages").addClass('hidden');
    $("#hide-similar-pages").removeClass('hidden');
    e.preventDefault();
  });
  $("a.hide-similar-pages").click(function(e) {
    $("#sidebar").addClass('mobile-phone-hide');
    $("#hide-similar-pages").addClass('hidden');
    $("#show-similar-pages").removeClass('hidden');
    e.preventDefault();
  });
});

/* --------------------------------------------------------------

[7*] Estimate Form

-------------------------------------------------------------- */
$(function() {
    // Setup any needed variables.
    var $form   = $('.estimate-menu-form'),
        $loader = '<img src="/img/loader.gif" height="11" width="16" alt="Loading..." />';

    $form.append('<div id="response" class="hidden">');
    var $response = $('#response');

    // Do what we need to when form is submitted.
    $form.on('click', 'input[type=submit]', function(e){

        // Hide any previous response text and show loader
        $response.hide().html( $loader ).show();

        // Make AJAX request 
        $.post('/resource/script/estimate-menu-send.php', $form.serialize(), function( data ) {

            // Show response message
            $response.html( data );

            // Scroll to bottom of the form to show respond message
            var bottomPosition = $form.offset().top + $form.outerHeight() - $(window).height();

            if( $(document).scrollTop() < bottomPosition )
                $('html, body').animate({ scrollTop : bottomPosition });

            // If form has been sent succesfully, clear it
            if( data.indexOf('success') !== -1 )
                $form.find('input:not(input[type="submit"], input[type="reset"]), textarea, select').val('').attr( 'checked', false );

        });

        // Cancel default action
        e.preventDefault();
    });
});/*END FUNCTION*/ 
```

这是标题导航的 HTML：

```
<div id="header-bottom">
    <nav>
      <ul class="menu-option-set">
        <li><a href="/" <?php echo $home ?>>Home</a></li>
        <li><a href="#" data-subid="services"<?php echo $services ?>>Services</a></li>
        <li><a href="#" data-subid="gallery"<?php echo $gallery ?>>Gallery</a></li>
        <li><a href="#" data-subid="customer"<?php echo $customer ?>>Customer</a></li>
        <li><a href="#" data-subid="about"<?php echo $about ?>>About</a></li>
        <li><a href="#" data-subid="contact"<?php echo $contact ?>>Contact</a></li>
        <li><a href="#" data-subid="estimate"<?php echo $estimate ?>>Estimate</a></li>
        <li><form id="headerSearch" class="textcenter headerSearch" method="get"><input id="headerInput" type="text" name="search"/></form></li>
      </ul>
    </nav>
  </div>
  <div id="header-subnav" class="hidden">
    <nav>
      <ul id="services">
        <li><a href="/bathroom/"<?php echo $bathroom ?>>Bathroom</a></li>
        <li><a href="/kitchen/"<?php echo $kitchen ?>><s>Kitchen</s></a></li>
        <li><a href="/accessibility/"<?php echo $accessibility ?>><s>Accessibility</s></a></li>
        <li><a href="/window/"<?php echo $window ?>><s>Windows</s></a></li>
        <li><a href="/deck/"<?php echo $deck ?>><s>Decks</s></a></li>
        <li><a href="/siding/"<?php echo $siding ?>><s>Siding</s></a></li>
      </ul>
      <ul id="gallery">
        <li><a href="/gallery.php"<?php echo $photo ?>>Photo Gallery</a></li>
        <li><a href="/project.php"<?php echo $project ?>>Project Gallery</a></li>
        <li><a href="/before-and-after.php" <?php echo $before_and_after ?>><s>Before &amp; After</s></a></li>
      </ul>
      <ul id="customer">
        <li><a href="/coupons.php"<?php echo $coupons ?>><s>Coupons</s></a></li>
        <li><a href="/testimonials.php"<?php echo $testimonials ?>>Testimonials</a></li>
        <li><a href="/things-to-know.php"<?php echo $things_to_know ?>>Things to Know</a></li>
        <li><a href="/financing.php"<?php echo $financing ?>>Financing</a></li>
        <li><a href="/reviews.php"<?php echo $reviews ?>>Reviews</a></li>
      </ul>
      <ul id="about">
        <li><a href="/about.php"<?php echo $about_us ?>>About Us</a></li>
        <li><a href="/privacy.php"<?php echo $privacy ?>>Privacy Policy</a></li>
        <li><a href="/alliances.php"<?php echo $alliances ?>>Strategic Alliances</a></li>
        <li><a href="/certified-contractor.php"<?php echo $certified_contractor ?>>Certified Contractor</a></li>
        <li><a href="/awards-and-accreditations.php"<?php echo $awards_and_accreditations ?>>Accreditations</a></li>
      </ul>
      <ul id="contact">
        <li><a href="/contact.php"<?php echo $contact_us ?>>Contact Us</a></li>
        <li><a href="/employment.php"<?php echo $employment ?>>Employment</a></li>
        <li><a href="/estimate.php"<?php echo $request_estimate ?>>Request Estimate</a></li>
      </ul>
      <ul id="estimate">
        <li>Menu estimate Form coming soon</li>
      </ul>
    </nav>
  </div> 
```

请注意，这在 IE9 中一切正常，但随机坏了，我没有更改 HTML，它一定是 JS 的东西。

谢谢大家，我真的很感激！

**编辑：对不起，我什至没有发布您可以查看问题的网站。可以在这里看到：[http ://www.remodeling-buffalo.com](http://www.remodeling-buffalo.com)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T01:26:53.817

IE9 中有一个脚本错误，它正在停止执行您的某些 javascript。看来您没有在此为 jQuery 定义 .mask 方法：

```
jQuery(function($){
    $("#menu-primary-number").mask("(999) 999-9999");
    $("#menu-zip").mask("99999");
}); 
```

而且，在准备好的处理程序中抛出的异常可能在某些浏览器中具有不同的后果。

* * *

在我看来，您还试图在 DOM 加载之前运行一些 javascript，例如：

```
document.getElementById('headerSearch').onsubmit = function() {
    window.location = "javascript:poptastic('http://www.google.com/search?q=site:northtownsremodeling.com ' + document.getElementById('headerInput').value);"
      return false;} 
```

这将导致它失败。由于您使用的是 jQuery 并且已经有一些准备好的处理函数块，因此您应该将所有在初始化时引用 DOM 的代码放在这些 document.ready 块之一中。

# python - 如何在 Django 中自动大写表单提交的字段？

> ID：11996963
> 
> 赞同：7
> 
> 时间：2012-08-16T23:40:05.930
> 
> 标签：python, django, sorting, django-models, django-forms

我有一个`ProductForm`用户可以在其中`Product`向数据库添加`title`,`price`和`condition`.

如何使当用户提交表单时，该`title`字段的第一个字母自动大写？

例如，如果用户在表单中输入“优质床垫”，django 会将其作为“优质床垫”保存到数据库中。

仅供参考，我问的原因是因为当我在页面上显示所有产品对象时，Django 的按标题排序功能是区分大小写的。因此，“Bravo”、“awful”、“Amazing”将被排序为“Amazing”、“Bravo”、“awful”，而作为用户，我们知道这不是按字母顺序排列的。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-08-17T07:05:36.267

[表单具有用于清理特定字段 ( docs](https://docs.djangoproject.com/en/1.4/ref/forms/validation/#cleaning-a-specific-field-attribute) )的内置钩子，这将是此代码的更清洁（双关语）位置：

```
class ProductForm(forms.Form):
    ...
    def clean_title(self):
        return self.cleaned_data['title'].capitalize() 
```

比接受的答案少得多的代码，并且没有不必要的覆盖。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-08-17T00:13:52.173

您可以[覆盖模型的`save`方法](https://docs.djangoproject.com/en/dev/topics/db/models/#overriding-model-methods)（它的好处是能够在一个地方简洁地处理多个字段）：

```
class Product(models.Model):
    ...
    def save(self, *args, **kwargs):
        for field_name in ['title', 'price', ... ]:
            val = getattr(self, field_name, False)
            if val:
                setattr(self, field_name, val.capitalize())
        super(Product, self).save(*args, **kwargs) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-16T23:57:30.203

使用 Python 的[`capitalize()`函数](http://docs.python.org/library/string.html#string.capitalize)。

# 编辑：

请参阅[Jeremy Lewis](https://stackoverflow.com/questions/11996963/how-to-automatically-capitalize-field-on-form-submission-in-django/12001244#12001244)关于在何处使用此功能的回答。

:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-17T07:18:32.590

如果你想确保你的数据是一致的，我不确定在表单/视图级别大写是最好的方法。

当您通过管理员添加产品而不使用该表单/保存方法时会发生什么？如果您忘记了资本，那么您将面临数据不一致的问题。

您可以改为使用模型的保存方法，甚至使用 django 发送的 pre_save 信号。

这样一来，无论数据来自何处，数据总是被同等对待。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-10-27T05:09:32.783

您可以在模型中使用[clean 方法](https://docs.djangoproject.com/en/dev/ref/models/instances/#validating-objects)，即：

```
class Product(models.Model):
    title = models.CharField(max_length=30)
    ...
    def clean(self):
        self.title = self.title.capitalize() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-08-07T23:32:59.373

如果您需要所有单词的所有首字母来大写`val.title()`Jeremy Lewis 的回答中的使用。如果你使用`val.capitalize()`，那么“hello world”将是“Hello world”，`title()`你可以得到“Hello World”

# sql - 查询一个 SQL 字段是否包含多个值中的任何一个

> ID：11996965
> 
> 赞同：14
> 
> 时间：2012-08-16T23:40:17.903
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures

我想查询 SQL 列的行是否包含多个值中的任何一个。

例如，返回表的行，其中 A 列包含以下任何单词： `('cow','farmer','milk')`.

当您知道单词是什么时就很容易了，但是我想编写一个存储过程，我可以在其中输入任何字符串数组，并且如果某一行的 A 列包含其中任何一个，它将返回该行。

我希望能够提供：

`('cow','farmer','milk')`

或者

`('cow','farmer','steak','yikes')`

或者

```
('cow','farmer','three', 'pigs', 'wolf') 
```

它必须相对简单，但我一生都无法弄清楚。我在 SQL Server 2008 上

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-16T23:45:15.010

一种简单的方法：

```
declare @candidates varchar = '|cow|farmer|three|pigs|wolf|'
select * from TableName where @candidates like '%|' + FieldName + '|%' 
```

在 SQL 2008 中执行此操作的最佳方法是使用[表值参数](http://msdn.microsoft.com/en-us/library/bb675163.aspx)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-16T23:50:46.370

SQL Server 不知道什么是“数组”。您可以编写一个拆分表值函数，将每个值转换为一行，然后与基表连接，但与 Av 的答案相比，这绝对是次优的。或者您可以针对表值参数进行测试。与所有拆分技术相比， TVP[绝对是表现最好的，甚至是 CLR](http://www.sqlperformance.com/2012/08/t-sql-queries/splitting-strings-now-with-less-t-sql)。

```
CREATE TYPE dbo.FarmItems AS TABLE(Item VARCHAR(32));
GO

CREATE PROCEDURE dbo.FindFarmItems
  @List dbo.FarmItems READONLY
AS
BEGIN
  SET NOCOUNT ON;

  SELECT t.col1, t.col2, ...
    FROM dbo.table AS t
    INNER JOIN @List AS L
    ON t.columnA = L.Item;
END
GO 
```

然后在 C# 中，您只需使用“数组”构造一个 DataTable 并将其传入：

```
DataTable dt = new DataTable();
dt.Columns.Add("Item", typeof(string));
dt.Rows.Add("cow");
dt.Rows.Add("farmer");
...

using (SqlConnection conn = new ...)
{
    SqlCommand c = new SqlCommand("dbo.FindFarmItems", conn);
    2.CommandType = CommandType.StoredProcedure;
    SqlParameter tvp = c.Parameters.AddWithValue("@List", dt);
    tvp.SqlDbType = SqlDbType.Structured;
    // execute, get a reader, etc...
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-17T00:22:07.977

您可以使用 XML 数据类型将列表数据传递给您的存储过程：

```
create procedure dbo.LookItUp

  @idList xml

as

  declare @lookup table
  (
    id int not null
  )

  insert @lookup (id)
  select distinct t.id.value('.','int')
  from @idList.nodes('/ids/id') as t( id )
  where t.id is not null

  select *
  from dbo.my_data_table t
  join @lookup           lu on lu.id = t.object_id

  return 0
go 
```

简单的！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-04-05T05:57:05.633

我有同样的困境，并想出了以下。例如，如果 table_a 包含 ('My Cow', 'My Goat', 'My Dog') 并且 table_b 包含 ('Dog', 'Cow')，那么...

```
create table #table_a (field1 varchar(128))
insert into #table_a values('My Cow')
insert into #table_a values('My Goat')
insert into #table_a values('My Dog')

create table #table_b (field1 varchar(128))
insert into #table_b values('Dog')
insert into #table_b values('Cow')

select * from #table_a table_a where (select count(*) from #table_b table_b where charindex(table_b.field1, table_a.field1) > 0) > 0 
```

返回（'我的牛'，'我的狗'）

希望这可以帮助。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-08-16T23:54:03.083

您不能将数组传递给存储过程，因为 TSQL 中不存在数组。你有几个选择，我给你两个。

**选项 1 - 快速而肮脏**（我不推荐它）
将值作为字符串传递并将其添加到动态 SQL 语句中。

```
CREATE PROCEDURE MyProc
  @Values varchar(1000)
AS

DECLARE @SQL VARCHAR(2000)

SET @SQL = 'SELECT blahblah WHERE SomeField IN (' + @Values + ')'

-- Execute the statement and return the result

END 
```

除了明显的 SQL 注入漏洞外，这种方法不适用于大集合，而且性能也不会太好。此外，如果任何值包含逗号，它将不起作用。我真的不推荐它，尽管它可能对快速测试有用。

**选项 2 - 更灵活的解决方案**
将所有值存储在一个临时表中，您将在存储过程中引用该表。

```
CREATE TABLE #MyTempTable
-- Fields...

INSERT INTO #MyTempTable
-- Insert the values

CREATE PROCEDURE MyProc
  @Values varchar(1000)
AS

SELECT 
  SomeFields
FROM
  MyTable
  JOIN
  #MyTempTable ON
    -- Add join clause

END 
```

此解决方案可能会更好地扩展。

正如其他人所建议的那样，您还可以使用内存表（我个人避免使用，因为我从来没有对它们很幸运，它们的性能总是比临时表差）或表参数，但您必须事先声明其类型.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-07-10T14:46:32.140

您可以简单地使用 WHERE 列 IN（逗号分隔的字符串）

这是我如何做到这一点的完整示例：

```
create table #bar (foo varchar(20))

insert into #bar (foo) values('cow')
insert into #bar (foo) values('cat')

select foo from #bar
where foo in ('cow','farmer','milk')

drop table #bar 
```

# php - 在 PHP 的公式中使用 MySQL 日期

> ID：11996968
> 
> 赞同：0
> 
> 时间：2012-08-16T23:40:47.423
> 
> 标签：php, mysql

我最终试图获得两个日期（ContractDate 和 CloseDate）之间的天数差异。它们的日期已经以 0000-00-00 格式存储在 MySQL 数据库中，但我无法将它们正确插入到公式中。我正在为此和其他一些项目使用以下查询。

```
$q_groups = mysql_query("SELECT CONCAT(contacts.last_name, ', ', contacts.first_name) as Name,
                        loans.subject_property as SubjectProperty, loans.fKeyUserLoanOfficer,
                        loan_types.name as LoanType, loans.closed_on as CloseDate, loans.contract_date as ContractDate, loans.amount as Amount, loan_status_types.name as LoanStatus,
                        loans._id, loans.fKeyReferral
                        FROM `loans`
                        LEFT JOIN `loan_status_types` ON (loans.fKeyLoanDetail = loan_status_types._id)
                        LEFT JOIN `loan_status` ON (loan_status._id = loan_status_types.fKeyType)
                        LEFT JOIN `loan_types` ON (loans.fKeyLoanType = loan_types._id)
                        LEFT JOIN `contacts` ON (contacts._id = loans.fKeyContact)
                        WHERE loans.fKeyGroup = '{$gid}' AND loan_status.name LIKE '%Closed%'
                        ORDER BY loans.closed_on DESC")
                        or die(ErrorLog::handle(mysql_error())); 
```

我想要做的是让上面查询中的两个日期（ContractDate 和 CloseDate）填充下面的日期（红色）：

```
$start = strtotime("2012-08-16");
$end = strtotime("2012-06-28");
$dayz = ($start - $end) / (60 * 60 * 24); 
```

当我查看数据库时，“close_on”字段的日期为 2012-08-16，当我查看“contract_date”字段时，日期为 2012-06-28 ...但我无法获取此信息正确插入，没有错误或根本没有数据显示。

** 我遇到的问题是......如何用字段数据替换静态日期？**

谢谢，埃德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-17T00:30:57.527

```
SELECT
TO_DAYS(closed_on) - TO_DAYS(contract_date) AS `dayz` 
```

添加到您现有的查询中：

```
$q_groups = mysql_query("SELECT CONCAT(contacts.last_name, ', ', contacts.first_name) as Name,
                        loans.subject_property as SubjectProperty, loans.fKeyUserLoanOfficer,
                        loan_types.name as LoanType, loans.closed_on as CloseDate, loans.contract_date as ContractDate, loans.amount as Amount, loan_status_types.name as LoanStatus,
                        loans._id, loans.fKeyReferral,
                        TO_DAYS(loans.closed_on) - TO_DAYS(loans.contract_date) AS `dayz`
                        FROM `loans`
                        LEFT JOIN `loan_status_types` ON (loans.fKeyLoanDetail = loan_status_types._id)
                        LEFT JOIN `loan_status` ON (loan_status._id = loan_status_types.fKeyType)
                        LEFT JOIN `loan_types` ON (loans.fKeyLoanType = loan_types._id)
                        LEFT JOIN `contacts` ON (contacts._id = loans.fKeyContact)
                        WHERE loans.fKeyGroup = '{$gid}' AND loan_status.name LIKE '%Closed%'
                        ORDER BY loans.closed_on DESC")
                        or die(ErrorLog::handle(mysql_error())); 
```

凭借正确性的额外好处，简单地将时间戳除以一天中的秒数将无法跨越 DST 边界等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-16T23:50:06.713

我建议你[让 MySQL 做数据操作](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html)。它具有比 PHP 更好的功能范围，以及本机日期/时间数据类型。您可以用明确的语言添加和减去时间和日期，并且不会遇到往返 Unix 时间戳的问题。

而且你*不想*用 Unix 时间戳来做这件事！这是因为对于日期操作，它提供了太多的精度：秒 vs 天，这是一个很好的迹象，它是错误的解决方案。他们也不允许诸如时区和夏令时转换之类的事情，并且试图自己处理是一个漫长的滑坡的开始。*使用正确的日期处理函数要*好得多，因为它们已经被广泛调试并且可以正常工作。

您也可以使用新的 PHP [DateTime](http://au2.php.net/manual/en/book.datetime.php)库，但如果您的日期来自 MySQL 并返回 MySQL，只需使用 MySQL；它的转换较少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-17T00:03:16.213

如果你被 PHP 困住，你可以使用[DateTime](http://php.net/manual/en/book.datetime.php)对象：

```
 $datetime1 = new DateTime('2009-10-11');  
  $datetime2 = new DateTime('2009-10-13');
  $interval = $datetime1->diff($datetime2);
  echo $interval->format('%R%a days'); 
```

[DateTime::diff()](http://www.php.net/manual/en/datetime.diff.php)手册。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-17T00:10:20.000

如果您的数据库中已经有数据，我建议您使用它，因为它更快，正如 staticsan 指出的那样。

一个例子是这样的，但是您将用表中的字段数据替换下面的静态日期：

```
SELECT DATEDIFF('2010-10-08 18:23:13', '2010-09-21 21:40:36') AS days; 
```

# css - html 选择标签错误导致 css 变换动画期间重排。解决方法的想法？

> ID：11996969
> 
> 赞同：1
> 
> 时间：2012-08-16T23:41:09.330
> 
> 标签：css, webkit, css-transitions, css-transforms, html-select

显然，将选择元素作为 css 变换动画的一部分会导致回流，并对动画的感知平滑度和渲染时间产生负面影响。现在在桌面浏览器中，这并不重要，也几乎不引人注意，但在移动设备上，不必要的重排非常昂贵！

这是一个演示该问题的基本小提琴：http: [//jsfiddle.net/w6NUT/](http://jsfiddle.net/w6NUT/) 打开开发工具时间线并注意将选择元素设置为如何`display: none;`导致“布局”记录停止。

我有一个相当复杂的网络应用程序，我正在创建一个具有许多子元素的节点的翻转动画，而这个“选择”元素是唯一有问题的子元素。

关于如何解决这个问题的任何想法？我最终可能会将此作为错误提交给 webkit 人员，但我也在寻找一个短期的 kludge hack 修复。

# visual-studio-2010 - 工厂从何而来？

> ID：11996976
> 
> 赞同：5
> 
> 时间：2012-08-16T23:41:58.623
> 
> 标签：visual-studio-2010, vsto, asp.net-3.5, excel-2010

我正在尝试将项目添加到拆分按钮和画廊。问题出在工厂。在下面的 OfficeRibbon 代码文件中，Factory 是未知的。在插件代码文件中也是未知的。我在某处缺少参考。我也试过 Globals.Factory 仍然未知。

```
RibbonButton rc = this.Factory.CreateRibbonButton(); 
```

我有以下 using 语句。

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Globalization;
using System.IO;
using System.Text.RegularExpressions;
using System.Threading;
using System.Windows.Forms;
using Microsoft.Office.Interop.Excel;
using Microsoft.Office.Tools.Ribbon;
//using Microsoft.Office.Tools.Excel.Extensions; 
```

此代码在我的项目中已重命名为 ReqCommon.cs 的 ThisAddin.cs 中也失败了。

我想要的最终目标是动态地将项目添加到这两个控件。我在这里和其他地方找到的例子似乎都基于这个难以捉摸的工厂。

该项目确实引用了 Microsoft.Office.Tools.Common.v9.0.dll

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-17T13:03:57.420

如果您使用的是[功能区设计器](http://msdn.microsoft.com/en-us/library/bb386089.aspx)- 它会自动为您创建此**工厂**( ) - 否则您需要通过[覆盖](http://msdn.microsoft.com/en-us/library/bb608623.aspx)(*您的 ReqCommon.cs* )`Globals.Factory.GetRibbonFactory()`创建自己的**工厂**[`CreateRibbonExtensibilityObject()`](http://msdn.microsoft.com/en-us/library/bb608623.aspx)`ThisAddin.cs`

 *```
protected override Microsoft.Office.Core.IRibbonExtensibility CreateRibbonExtensibilityObject()
{  
    Ribbon1 tempRibbon = new Ribbon1();
    tempRibbon.tab1.ControlId.ControlIdType = Microsoft.Office.Tools.Ribbon.RibbonControlIdType.Office;
    tempRibbon.tab1.ControlId.OfficeId = "TabHome";
    return Globals.Factory.GetRibbonFactory().CreateRibbonManager(new Microsoft.Office.Tools.Ribbon.IRibbonExtension[] { tempRibbon });   
} 
```

**功能区设计器**继承自[`Ribbon.RibbonBase`](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.ribbon.ribbonbase.aspx)其中包含[`RibbonBase.Factory`](http://msdn.microsoft.com/en-us/library/microsoft.office.tools.ribbon.ribbonbase.factory.aspx)可以在其中`this.Factory`使用的属性。*

# android - 编译错误：应改为 AnnotationName

> ID：11996983
> 
> 赞同：0
> 
> 时间：2012-08-16T23:43:24.120
> 
> 标签：android, eclipse, password-protection

我正在尝试自己对活动进行密码保护，但遇到了一些问题。代码中有一些错误。

```
import com.foo.avanos.AvanosActivity;
import com.foo.avanos.R;

import android.content.SharedPreferences;
import android.content.SharedPreferences.Editor;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;
import android.content.Intent;;

public class ChangePassword extends AvanosActivity{

    public void onCreate(Bundle savedInstanceState) {
        setContentView(R.layout.settings);
        Button submitButton = (Button) findViewById(R.id.button2);
        submitButton.setOnClickListener(this);

        Button ChangePasswordButton = (Button) findViewById(R.id.button2);
        ChangePasswordButton.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Intent intent = new Intent();
                setResult(RESULT_OK, intent);
                finish();
            }

        Button EnterButton2 = (Button) findViewById(R.id.button2);
        //Below, it's telling me 'Syntax error on tokens, AnnotationName expected instead'
        EnterButton2.setOnClickListener(new View.OnClickListener() {
            public void onClick2(View v) {
                EditText passwordEditText = (EditText) findViewById(R.layout.password);
                SharedPreferences prefs = this.getApplicationContext().getSharedPreferences("prefs_file",MODE_PRIVATE);
                String NewPassword = prefs.getString("password","");
                String CurrentPassword = prefs.getString("password","NewPassword");
                if(NewPassword.equals(CurrentPassword)){
                    Editor edit = prefs.edit();
                    edit.putString("password",passwordEditText.getText().toString());
                    edit.commit();
                }
                else {
                    Toast.makeText(getBaseContext(),"Passwords do not match",Toast.LENGTH_SHORT).show();
                    return;
                }
                //Below, it's telling me 'Syntax error, insert ";" to complete Statement'
            }
        }
    }
}
} 
```

首先，我想知道我这样做是否正确。如果我不是，请指导我做正确的事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-17T00:05:36.593

以未结束的 setOnclickListener`);`结束，因此您会收到编译错误。

```
ChangePasswordButton.setOnClickListener{
   public void onClick2(View v) {
        //code goes here
   }
}); 
```

情况也是如此

```
EnterButton2.setOnClickListener(new View.OnClickListener() {
   public void onClick(View v) {
}
}); 
```

并使用 Onclick 而不是 onClick2

将点击侦听器分配给一个变量，然后执行 setOnclickListener。它将是可读的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-29T17:09:47.983

您的上下文底部有第二个分号。删除它，然后重试。

# spring - Spring Roo 为重定向构建 URL - 在 URL 的末尾添加 :80

> ID：11996985
> 
> 赞同：0
> 
> 时间：2012-08-16T23:43:33.023
> 
> 标签：spring, jboss7.x

JBoss AS7.1.1.Final 与 Spring 3.1.0

我们使用的是 Spring Roo 生成的 Spring MVC 框架。

我们遇到了重定向 URL 的问题。

以下重定向代码由 Roo 生成并位于 AspectJ 文件中。这是在“创建”页面上保存数据完成后重定向到“显示”页面的示例。

```
@RequestMapping(method = RequestMethod.POST)
public String RequestorController.create(@Valid Requestor requestor, BindingResult bindingResult, Model uiModel, HttpServletRequest httpServletRequest) {
if (bindingResult.hasErrors()) {
uiModel.addAttribute("requestor", requestor);
addDateTimeFormatPatterns(uiModel);
return "requestors/create";
}
uiModel.asMap().clear();
requestor.persist();
return "redirect:/requestors/" + encodeUrlPathSegment(requestor.getId().toString(), httpServletRequest);
} 
```

这是我们的 JBoss AS7 Standalone.xml 连接器配置：

```
<connector name="ajp" protocol="AJP/1.3" socket-binding="ajp"/>
--> The URL Spring created was: ajp://servername/context/path 
```

我们当时尝试了这个：

```
<connector name="ajp" protocol="AJP/1.3" socket-binding="ajp" scheme="https">
--> The URL Spring created was: https://servername:80/context/path (Notice how the :80 is appended. So this was ALMOST RIGHT.) 
```

再试一次，我们将重定向端口添加为 443……</p>

```
<connector name="ajp" protocol="AJP/1.3" socket-binding="ajp" scheme="https" redirect-port="443">
--> Generated same thing, https://servername:80/context/path 
```

附加 :80 是怎么回事？

注意：这可能在 JBoss 4 和 5 中运行良好，因为它们基于 Tomcat 连接器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-06T19:18:40.000

这最终不是问题。

问题是我们没有为 JBoss AS7 中的元素设置 proxy-port 和 proxy-name 属性。

这从来都不是 Spring Roo 的问题。

# python - 如何开发 AI 脚本

> ID：11996987
> 
> 赞同：0
> 
> 时间：2012-08-16T23:43:42.840
> 
> 标签：python, artificial-intelligence, pygame, game-engine, game-physics

我是一名业余程序员，想开发一款游戏。我决定使用 Python 和 pygame。（我知道，有更好的选择，但我真的不太了解 C++ 或 java。）我遇到的问题是我真的不知道如何创建一个像样的 AI。我说的是那种让怪物在这个点移动，在那个点使用弓箭，然后在另一个点使用远程魔法攻击的 AI（是的，它是一个自上而下的 2-d奇幻游戏）。我真的不明白它是如何做出这些决定的，以及你如何对其进行编程来做出这些决定。我到处环顾四周，要么资源变得如此技术性以至于我根本无法理解它，要么它没有给我任何信息。我希望这里有人可以给我一些明确的建议，或者至少为我指出一些不错的资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-16T23:56:12.263

基本上它的

*   默认行为：随机游走
*   如果玩家在 X 距离内：近战攻击
*   如果玩家在 Y 距离内：冲锋玩家
*   如果玩家在 Z 距离内：施法
*   如果玩家在范围之外并且 MOB 向玩家移动

这就是大多数人工智能的范围......至少游戏人工智能

它的 CPU 密集度太高，无法为游戏小怪做神经网络和机器学习之类的事情

你可能想看看模糊逻辑人工智能......这主要是我在那里描述的，但它可以同时不止一个

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-16T23:59:54.510

[这](https://rads.stackoverflow.com/amzn/click/com/1556220782)是一本关于这个主题的好书。它包含许多示例，这些示例也在书中进行了解释。代码是 C++，但很容易理解。

以下是从亚马逊取来的关于这本书的简短描述：

> “通过示例编程游戏 AI”全面而实用地介绍了游戏开发行业使用的基本 AI 技术，引导读者完成使用 C++ 编程语言为动作游戏设计、编程和实现智能代理的过程. 涵盖的技术包括基于状态和目标的行为、代理间通信、个人和群体指导行为、团队 AI、图论、搜索、路径规划和优化、触发器、脚本、脚本化有限状态机、感知建模、目标评估、目标仲裁和模糊逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-16T23:57:05.850

我相信这会对你有用。它甚至在python中。

[http://www.udacity.com/overview/Course/cs373/CourseRev/apr2012](http://www.udacity.com/overview/Course/cs373/CourseRev/apr2012)

编辑：游戏 AI 的鲁棒性往往不如大多数其他 AI（因为它们在每个游戏滴答声中往往具有非常有限的 CPU 时间）。这仍然涵盖了游戏 AI 使用的基础知识。

# c++ - 与其他跨平台正则表达式库相比，Oniguruma 有多好？

> ID：11996988
> 
> 赞同：9
> 
> 时间：2012-08-16T23:44:02.857
> 
> 标签：c++, c, regex, performance, cross-platform

我们正试图摆脱 boost::regex ，它的性能很糟糕。根据[这个](http://lh3lh3.users.sourceforge.net/reb.shtml)基准，[Oniguruma](http://www.geocities.jp/kosako3/oniguruma/)是最好的整体。

我们有多个正则表达式（并且总是在变化），我们应用于从中等（100 个字符）到巨大（1k 个字符）的字符串......所以这是一个非常异构的环境。

你们中有人成功使用过它吗？您是否建议选择 PCRE 或 RE2 等更“标准”的产品？

谢谢 ！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-16T23:53:14.357

这两种实现（FSA 和 BT）具有完全不同的行为，您可以在右侧的列（电子邮件）中看到这些行为。

oniguruma 通常很快，但如果您对特定的正则表达式“不走运”，则可能会运行缓慢。那是因为它是一种回溯算法。

相比之下，虽然 re2 通常慢一点，但它没有相同的风险 - 它的时间永远不会[*] 以相同的方式爆炸（它没有最坏情况下的指数行为）。

所以这取决于细节。如果你确信你的正则表达式是安全的，或者愿意检测并中止慢匹配，那么 oniguruma 是有意义的。但就我个人而言，我倾向于为 re2 的安全性支付更多（不多）。

有关这方面的更多信息，请参阅[http://swtch.com/~rsc/regexp/regexp1.html](http://swtch.com/~rsc/regexp/regexp1.html)（由 re2 作者提供）。

[*] 好吧，也许永远不会太强大。对于某些正则表达式，我认为在某些情况下它必须依靠 BT 方法（可能涉及匹配以前的匹配和前瞻）。但在大多数正则表达式上它仍然更安全。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-08-22T12:36:17.497

我已经对以下库进行了基准测试：

*   促进
*   重2
*   鬼鬼座

基准测试包括执行一系列测试，这些测试在*非常*异构的正则表达式上大量使用正则表达式（分组、不分组、长的（484 个字符）、短的、管道、\?、*、. 等）。应用于从几个字符到大约 8k 个字符的文本。

每次计算正则表达式匹配时，我都会存储正则表达式并增加一个毫秒计数器，以累积计算正则表达式所花费的时间（称为多次）。

以下是每个库的所有正则表达式所花费的总时间：

*   提升：98840 毫秒
*   回复 2：51197 毫秒
*   鬼魂：16095 毫秒
*   re2（无 CAPUTRE* 见下文））：16162 毫秒

*我们（几乎）总是想在正则表达式中捕获组的内容，而 re2 在捕获组时表现得很**糟糕**（[见这里](http://code.google.com/p/re2/source/browse/re2/re2.h#80)）。在上面的结果中你看不到那么多，因为当组不能被捕获时，它表现得很好。例如在这个正则表达式上（执行了很多次）：

`^((?:https?://)?(?:[a-z0-9\-]{1,63}\.)+(?:[a-z0-9\-]{1,63}))(?:[^\?]*).*$`

以下是每个库的结果：

*   提升：140 毫秒
*   回复 2：5663 毫秒
*   鬼魂：53 毫秒
*   re2（无捕获）：37 毫秒。

查看 re2 从 5663 ms 到 37 ms 的下降。

## tl;博士

所以我的结论是，就我们的使用而言，Oniguruma 显然更胜一筹。

但如果你不需要捕获组，re2 是更好的选择，因为我发现它的 API 更易于使用。

# java - 如何部署基本的java应用程序

> ID：11996991
> 
> 赞同：5
> 
> 时间：2012-08-16T23:44:28.723
> 
> 标签：java

我对生产环境中的 java 应用程序很陌生，从未部署过。

我有一个连接到 mysql 数据库的应用程序，读取数据，执行一些 NLP 和其他数据操作，然后将数据保存回 mysql 数据库。

该应用程序将部署在机架空间云服务器上，并每隔几个小时运行一次（可能使用 cron 作业？）。

我一直在研究使用 maven 来帮助构建部署，但我不知道这是否是正确的工具，或者是否构建 .war 或 .jar。任何为我指明正确方向的帮助都会很棒！谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-16T23:51:14.447

基础知识 - 尽可能部署为可执行 Jar（或某种可执行容器）。当涉及到诸如设置类路径之类的事情时，只会让您的生活更简单。

我以前没有使用过 Maven，但我们正在研究如何帮助我们管理一个相当大且繁琐的依赖链。据我了解，Maven 的构建过程相当不错，但同样，我从未使用过它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T07:17:03.870

如果您的项目很简单，最好使用一个小的[Apache Ant](http://ant.apache.org/)脚本来构建它。使用生成的 jar 并将其放在服务器中的某个位置。使用一个小的 unix shell 脚本来触发 jar 中的主类。将此脚本添加到 cronjob。

PS：由于这是生产，请准备好部署计划以及所有要遵循的步骤。例子：

1.  使用某某用户名登录服务器
2.  `cd /path/to/the/jar`
3.  `cp xxx.jar /deployment/path/bin`
4.  crontab ...等等等等。

# android - 开发某些应用程序时，我的 Eclipse 出现错误

> ID：11996995
> 
> 赞同：0
> 
> 时间：2012-08-16T23:45:16.337
> 
> 标签：android

以下代码行：

```
this.mTexture = new Texture(512,512, TextureOptions.BILINEAR_PREMULTIPLYALPHA);
this.mSplashTextureRegion = TextureRegionFactory.createFromSource(this.mTexture, this, "gfx/Splashscreen.png", 0, 0); 
```

导致此错误：

```
Bound mismatch: The generic method createFromSource(ITextureAtlas<T>,
T, int, int, boolean) of type TextureRegionFactory is not applicable
for the acrguments(Texture, MainActivity, String, int, int). The
inferred type MainActivity is not a valid substitute for the bounded
parameter <T extends ITextureAtlasSource> 
```

我怎么能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-02T02:57:30.630

```
public void onLoadResources() {
this.mTexture = new BitmapTextureAtlas(512, 512,
    TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    this.mSplashTextureRegion =     BitmapTextureAtlasTextureRegionFactory.createFromAsset(this.mTexture,
    this, "gfx/Splashscreen.png", 0, 0);
    this.mEngine.getTextureManager().loadTexture(this.mTexture);
    } 
```

[http://metababy.blogspot.com](http://metababy.blogspot.com)

[http://www.andengine.org/forums/development/recent-build-change-t5514.html](http://www.andengine.org/forums/development/recent-build-change-t5514.html)