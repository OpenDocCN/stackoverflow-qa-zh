# StackOverflow 问答 12044000-12044999

# .net - 暂停和恢复 Zaber 控制台脚本

> ID：12044001
> 
> 赞同：2
> 
> 时间：2012-08-20T19:38:15.583
> 
> 标签：.net, zaber

我使用[Zaber 控制台](http://zaber.com/wiki/Software/Zaber_Console)编写了一个脚本来控制一个循环执行多个步骤的 Zaber 设备。如何在循环中间暂停它并恢复它而不必回到开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T19:38:15.583

我可以想到四个选项来支持这一点。

1.  让您的脚本在启动时以某种方式检测当前状态，并确定它应该从例程的哪个部分开始。根据您的例行程序，您可能能够读取[当前位置](http://zaber.com/wiki/T-Series/Compilation/All_Commands#Return_Current_Position_-_Cmd_60)以判断您处于哪一步。如果没有，您也可以使用[用户内存](http://zaber.com/wiki/Software/Zaber_Console#Reading_and_writing_user_memory)或将当前状态写入文本文件。其中一个示例脚本显示了如何[写入文本文件](http://zaber.com/wiki/Software/Zaber_Console#General_Move_Tracking)。
2.  除了主脚本之外，还要编写暂停脚本和恢复脚本。主脚本注意到来自其他两个脚本的响应。我将在下面包含一个示例。
3.  无需单独的脚本来暂停和恢复，而是使用[Zaber 操纵杆](http://www.zaber.com/products/product_group.php?group=T-JOY&name=Joystick)并对按钮进行编程以发送暂停和恢复命令。下面的示例也将涵盖这一点。
4.  将您的脚本转换为在[BackgroundWorker](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)中运行主例程的[插件](http://zaber.com/wiki/Software/Zaber_Console/Plug_Ins)。然后您可以在控件类中保持状态，并添加一个暂停/恢复按钮。

这是一个使用单独的脚本来暂停和恢复您的例程的示例。它还介绍了如何使用操纵杆按钮。

## 原始程序

首先，我创建了这个简单的例程。

```
/* C# example of how to pause and resume a Zaber Console script.
 * This script is the original routine without the pause and resume logic.
 * It moves to position zero, then makes four moves of 10000 microsteps each 
 * and goes back to zero. This loops forever.
 */
#template(simple)

while (true)
{
    for (var i = 0; i < 5; i++)
    {
        var position = i*10000;
        Output.WriteLine("moving to {0}", position);
        Conversation.Request(Command.MoveAbsolute, position);
    }
} 
```

## 暂停

这是暂停例程的脚本。

```
/* C# example of how to pause and resume a Zaber Console script.
 * This script pauses the main routine by sending a Stop command. Running this 
 * script twice will stop the routine.
 */
#template(simple)

Conversation.Request(Command.Stop); 
```

stop 命令将导致主脚本出错，但我们将更改主脚本以捕获该错误并添加暂停/恢复逻辑。

## 简历

这是恢复例程的脚本。

```
/* C# example of how to pause and resume a Zaber Console script.
 * This script resumes the main routine by sending an EchoData command with a
 * magic number.
 */
#template(simple)

const int RESUME_NUMBER = 42;// Matches the main routine.
Conversation.Request(Command.EchoData, RESUME_NUMBER); 
```

## 常规加暂停逻辑

暂停和恢复脚本非常简单；真正的工作是让主脚本监听来自停止命令的错误和恢复的幻数。这是添加了所有内容的新版本的例程。在主脚本编辑器窗口中运行此脚本，并从主窗口脚本选项卡的网格中运行另外两个。

```
/* C# example of how to pause and resume a Zaber Console script.
 * This script is the main routine that moves to position zero, then makes four
 * moves of 10000 microsteps each and goes back to zero. This loops forever.
 * To pause the routine, run the Pause.cs script. To resume the routine, run
 * the Resume.cs script. Running the pause script twice will stop the routine.
 */
#template(methods)

/* We switched to the methods template so we can put the move with pause and
 * resume into a helper method.
 */
public override void Run()
{
    while ( ! IsCanceled)
    {
        for (var i = 0; i < 5 && ! IsCanceled; i++)
        {
            var position = i*10000;
            MoveTo(position);
        }
    }
}

/* This wraps the pause and resume logic around a simple MoveAbsolute command.
 * If your resume logic is more complicated, you can put more commands inside 
 * the try/catch block, or use the return value of this function to tell the
 * main routine what to do next.
 * When this method returns, either the move has successfully completed, or
 * IsCanceled is true.
 */
private void MoveTo(int position)
{
    bool isComplete = false;
    while ( ! isComplete && ! IsCanceled)
    {
        try
        {
            Output.WriteLine("moving to {0}", position);
            Conversation.Request(Command.MoveAbsolute, position);
            isComplete = true;
        }
        catch (RequestReplacedException ex)
        {
            Pause();
        }
        catch (RequestCollectionException ex)
        {
            /* If you are running against device number zero
             * or some other alias, you get a slightly
             * different exception.
             */
            Pause();
        }
    }
}

/* Just wait for responses from your device. If a response is an EchoData 
 * command with the magic number, then this method will return. If the response
 * is a Stop command, then IsCanceled is set to true and this method will 
 * return. All other responses are ignored.
 */
private void Pause()
{
    Output.WriteLine("paused");

    /* Let the device finish processing the current stop command before
     * you start listening, otherwise you sometimes see the stop command
         * again.
         */
    Sleep(100); 

    const int RESUME_NUMBER = 42;// Matches the resume script.
    var listener = new DeviceListener(Conversation.Device);
    bool isPaused = ! IsCanceled;// Don't pause if already canceled.
    while (isPaused)
    {
        var response = listener.NextResponse();// wait
        if (response.Command == Command.EchoData && 
            response.Data == RESUME_NUMBER)
        {
            isPaused = false;
            Output.WriteLine("resumed");
        }
        else if (response.Command == Command.Stop)
        {
            isPaused = false;
            IsCanceled = true;
            Output.WriteLine("stopped");
        }
    }
} 
```

## 操纵杆

如果你有一个 Zaber 操纵杆，点击几个操纵杆按钮比在 Zaber 控制台中运行暂停和恢复脚本更方便。操纵杆上按钮 1 的默认命令是停止，因此您已经处理好暂停。如果您对其他按钮之一进行编程以发送 Echo Data 42，则可以恢复您的脚本。上面的最终脚本将运行带有暂停和恢复逻辑的例程，无论您是使用单独的脚本发送暂停和恢复命令还是使用操纵杆按钮发送它们。

# ant - Ant 任务在运行时选择文件？

> ID：12044011
> 
> 赞同：1
> 
> 时间：2012-08-20T19:38:49.770
> 
> 标签：ant

我需要在运行时使用 Ant 选择一个文件，现在我设法使用 exec 和 zenity 做到这一点，如下所示：

```
<exec executable="zenity" outputproperty="file">
  <arg line="--file-selection" />
  <arg line='--title "Pick a file to upload"' />
</exec>
<echo message="Uploading ${file} ..."/> 
```

我想知道是否有执行此操作的任务，因为此任务取决于平台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:01:49.783

通常，您在运行 Ant 时不使用用户输入。您可以在启动 Ant 时使用属性选择文件：

```
 $ ant -Dfile=my_file

 <project>
     <echo>You're using file "${file}"</echo>
 </project> 
```

但是，您可以为此使用[<input>](http://ant.apache.org/manual/Tasks/input.html)任务：

```
<project>
    <input addproperty="file"
    defaultvalue="foo.txt"
    message="What file do you want?"/>
    <echo>You've chosen file "${file}"</echo>
</project>

 $ ant
 What file do you want? [foo.txt]
 my.file.txt
 You've chosen file "my.file.txt" 
```

这是做你想做的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T15:04:28.913

我最终创建了一个 jar 文件来完成这项肮脏的工作，这就是我所做的：

1-下载并编译此 FileChooser 示例：[http](http://www.roseindia.net/tutorial/java/core/files/javafilechooser.html) : //www.roseindia.net/tutorial/java/core/files/javafilechooser.html，仅将 f.getName() 更改为 f.getAbsolutePath()

2-添加了一个java任务：

```
<java jar="FileChooser.jar" outputproperty="filepath" fork="true"/> 
```

现在我只需要在其他平台上携带 FileChooser.jar，它并不完美，但可以完成工作。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2016-08-19T11:58:11.280

AntForm 提供了一个 fileSelectionProperty 表单，在这里也可能会有所帮助。这是如何使用它的示例：

```
<?xml version="1.0" encoding="UTF-8"?>
<!--
getFile
    - get file name with a file selection box
-->
<project name="files" default="-getFile" basedir="."
            xmlns:antform="antlib:com.sardak.antform">

    <!--
    antform
    http://antforms.sourceforge.net/
    provides pop-up forms and menus for user input
        <antform>
        <antmenu>
    -->
    <taskdef uri="antlib:com.sardak.antform"
            resource="com/sardak/antform/taskdefs.properties"
            classpath="../../lib/antform.jar"/>

    <target name="-getFile">

        <!--
        pop-up form
        user selection form for the file selection
        -->
        <antform:antform title="Please Select a File">
            <fileSelectionProperty label="File: "
                    property="file.selection"
                    directoryChooser="false"/>
            <controlbar>
                <button label="OK" type="ok"/>
                <button label="QUIT" target="Quit"/>
            </controlbar>
        </antform:antform>
        <echo message="You chose file ${file.selection}"/>
    </target>

</project> 
```

# visual-studio - 使用 VWD 从 Web 服务调用 Web 服务

> ID：12044012
> 
> 赞同：1
> 
> 时间：2012-08-20T19:38:50.127
> 
> 标签：visual-studio, web-services, vwdexpress

我想在视觉 Web 开发人员的解决方案中开发一个 Web 服务，在同一个解决方案中调用另一个 Web 服务，我发现我可以通过“在解决方案中搜索”来添加 Web 引用但是我担心它发布后可能无法正常工作，因为它指向一个奇怪的端口，我认为它与 VWD 中的调试模式相关联 (54153)

有谁知道这是否可以正常工作，或者我是否需要在开发机器上本地发布并创建对 localhost 的引用，以便在实际发布到生产服务器时它可以正常工作。

问候马丁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T19:41:02.320

你是对的，你不能以这种方式添加参考。Web 参考与标准 .dll 或项目参考完全不同。

您需要在某处（甚至在 localhost 上）发布 Web 服务，并按照[这些说明](http://blogs.msdn.com/b/devschool/archive/2010/01/01/consuming-a-hosted-web-service-using-visual-studio-specifically-vwd-2010.aspx)添加 Web 引用。

# webgl - 如何为兰博基尼 Gallardo 创建 .bin 和 .js 模型文件（在示例中）

> ID：12044014
> 
> 赞同：1
> 
> 时间：2012-08-20T19:39:04.753
> 
> 标签：webgl, three.js

我想知道如何为兰博基尼 Gallardo 创建模型文件（在示例中）。我的意思是这个模型非常复杂，它存储在许多文件中，例如：

```
 .htaccess
    GallardoNoUv_bin.bin
    GallardoNoUv_bin.js

    and in parts folder:
    gallardo_body_bin.bin
    gallardo_body_bin.js
    gallardo_wheel_bin.bin
    gallardo_wheel_bin.js 
```

如何创建这些文件？因此，如果我在 Blender 或 Maya 中有我的模型，我如何将我的模型导出/转换为上述格式？为什么这个模型被分成许多 .js 和 .bin 文件？

那么，有人可以为我写一下如何将我的模型转换为这种格式的步骤吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T11:44:24.790

您可以从大多数 3D 软件中导出**.obj**文件，然后使用此 Python 命令行脚本 将它们转换为**.js/.bin文件：** [https ://github.com/mrdoob/three.js/blob/master/utils/converters /obj/convert_obj_three.py](https://github.com/mrdoob/three.js/blob/master/utils/converters/obj/convert_obj_three.py)

# android - 我需要在我的 android 主 xml 中以 24 小时格式编辑时间

> ID：12044015
> 
> 赞同：0
> 
> 时间：2012-08-20T19:39:07.707
> 
> 标签：android, android-layout, android-ui

我正在创建一个应用程序，我希望人们能够编辑某事发生的时间。我想在我的 main.xml 布局中以最小的方式实现它。

## **首先**：

我的第一个想法是在 Eclipse 上的常规 XML 布局编辑器中找到一个像可滚动时钟这样的小部件，例如 android 提供的。我的问题是它旁边有一个 AM/PM 按钮。我宁愿做 24 小时制（它会占用更少的空间）。

## **第二**：

无论我是否能找到类似的东西，这是对时间进行 UI 编辑的最佳方式吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T19:43:31.850

使用您看到的普通 TimePicker，但将其设置为 true：[setIs24HourPicker()](http://developer.android.com/reference/android/widget/TimePicker.html#setIs24HourView%28java.lang.Boolean%29)

在您的 XML 中可能有一个相应的 XML 属性来执行此操作，而不是以编程方式执行此操作，但我找不到它。

# c# - 通过下拉列表更新 sql 表

> ID：12044020
> 
> 赞同：0
> 
> 时间：2012-08-20T19:39:20.343
> 
> 标签：c#, asp.net, sql

我有下拉列表（`id="myDDL"`）。

我有`updateTable_byDDL`更新我的 sql 表的方法 ()，当我将手动值放入`SET="bla"`..

但是当我在 中写入时`SET= '"+ myDDL.Text.ToString() + "'`，SQL 上的列更新为空。

下拉列表是从我放在`page_load`（在类中）之外的数组绑定的，我在页面加载时绑定它：

```
 myDDL.DataSource = array;
    myDDL.DataBind(); 
```

在 aspx 页面中，我可以很好地看到下拉列表中的数组值，但是在我选择了我想要的项目后 - 并单击按钮，该列变为空。

我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T19:48:04.797

如果您在 page_load 中绑定 DDL，则每次加载页面时都会绑定。因此，在快速猜测您的代码时，您所要做的就是添加一个 if 语句来检查 page.isPostback

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!Page.IsPostBack)
    {
        ddlDemo.DataSource = new string[] { "asdf", "jklö" };
        ddlDemo.DataBind();
    }
}

protected void btnDemo_Click(object sender, EventArgs e)
{
    Debug.WriteLine(ddlDemo.Text);
    SqlConnection con = null;
    using (con = new SqlConnection("YOUR CON STRING"))
    {
        SqlCommand com = new SqlCommand( "update tblXYZ set ABC = @A", con);
        SqlParameter param = new SqlParameter("A", System.Data.SqlDbType.YOURTYPE);
        param.Value = ddlDemo.Text;
        com.Parameters.Add(param);
        con.Open();
        int affectedRows = com.ExecuteNonQuery();
        Debug.WriteLine(affectedRows + " affected!");
        con.Close();
    }
} 
```

在这个 aspx 页面中

```
<body>
  <form id="form1" runat="server">

    <asp:DropDownList ID="ddlDemo" runat="server">
    </asp:DropDownList>
    <asp:Button ID="btnDemo" runat="server" Text="Button" onclick="btnDemo_Click" />
  </form>
</body> 
```

无论如何，在使用它更新/插入/删除任何数据库记录之前，您应该始终检查用户输入！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T19:44:55.027

1.  你应该采取`myDDL.SelectedItem.Text`
2.  您应该使用参数来避免 SQL 注入

看看这个：

```
 YourUpdateCommand.CommandText = "UPDATE table SET column = @NewValue WHERE conditions";

   YourUpdateCommand.Parameters.Add("@NewValue", System.Data.SqlDbType.VarChar, 100); //or whatever

   YourUpdateCommand.Parameters["@NewValue"].Value = myDDL.SelectedItem.Text;

   YourUpdateCommand.ExecuteNonQuery(); 
```

# android - Android开发应用扩展Phonegap

> ID：12044026
> 
> 赞同：1
> 
> 时间：2012-08-20T19:39:47.463
> 
> 标签：android, cordova, android-emulator

这可能是一个很容易回答的问题，或者我可能不清楚直接进入 Android 开发。

我有一个 phonegap Android 应用程序，在平板电脑和手机尺寸的页面视图上具有不同的 mediaquery 视图。

当我尝试模拟器时，我必须选择手机的视图或尺寸，所以我选择了与我的应用程序相同的尺寸，这看起来很棒我的问题是有这么多的 Android 设备，我是否必须支持所有不同的尺寸才能让我的应用程序运行？我需要创建某种液体布局吗？

在准备好的 css 上做更好的处理`zoom: 75%;`是最好的方法吗？

当您向 Google Play 提交应用程序时，您必须选择您的应用程序是为哪种设备设计的？

我尝试向亚马逊商店提交应用程序，但多次被拒绝，因为我在专门为 Kindle Fire 设计应用程序时必须支持摩托罗拉 Zoom。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-20T23:46:34.363

这是一个重要的问题。**我认为 Phonegap/cordova 还没有准备好作为专业**应用程序开发的高端平台。但是总有一些技巧可以让它工作。

如果您正在为 Android 开发，我目前对您的问题的处理方法是；

1.  开始创建尺寸为 320x480（与 iPhone 3GS 相同）的设计，为什么？查看谷歌设备市场份额；[屏幕尺寸和密度](http://developer.android.com/about/dashboards/index.html#Screens)。
2.  我更喜欢使用 illustrator，因为它允许以后以更高分辨率导出资产。所以后来我在我的应用程序中包含图像，我没有指定宽度/高度；让容器决定。
3.  我的应用程序位于全局容器内。当我完成应用程序时，我使用脚本来检测当前窗口大小并设置全局容器的**-webkit-transform-origin**和**-webkit-transform**以适应屏幕。
4.  首先在浏览器中测试您的应用，然后在真实/模拟设备上测试；我建议使用 Chrome，因为它有一个设备仿真面板..

这有点hacky，但它现在有效..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:02:28.363

你试过 jQuerymobile 吗？它适应所有不同的尺寸，您不必担心。只需确保正确处理`mobileinit`和`deviceready`事件

# authentication - Coldfusion 跨站认证

> ID：12044028
> 
> 赞同：2
> 
> 时间：2012-08-20T19:40:09.133
> 
> 标签：authentication, coldfusion, cross-site

好的，所以在我正在开发的 Coldfusion 站点上，我刚刚安装了一个名为“Galleon”的第三方（开源）CF 论坛。

我刚才问了一个类似的问题，但现在我们已经取得了一些进展。

手头的问题是它无法识别父站点本身存在的任何变量（会话等）。论坛本身存储在站点目录中的一个子文件夹中。但是当我们尝试输出会话变量时，我们知道这些变量没有过期或诸如此类，它会吐出一个错误并且无法识别它们。

我扫描了任何清除变量的东西（如 structclear(session) 等）并且没有出现太多。我应该注意 application.cfm 中的某种设置吗？

一般来说，您如何在 CF 上进行跨应用程序身份验证？

我们要做的是根据用户登录主站点时创建的现有 session.userid 变量填充一个新的会话变量。我们想要这个，这样我们就可以绕过要求他们再次登录到 Galleon 论坛（以及由此引起的所有并发症）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T21:09:58.743

很有可能在论坛的 Application.cfc 中，您需要扩展根 Application.cfc。然后，您将更新论坛的 onApplicationStart() 以`super.onApplicationStart()`在其他任何事情之前调用。每个 Application.cfc 函数的情况可能相同，具体取决于父 Application.cfc 中发生的情况。

Galleon 的 Application.cfc 不再需要在父 Application.cfc 中设置应用程序名称和其他变量（如 @Ben 所述）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:41:46.867

确保两个应用程序之间的 application.cfms/application.cfc 中的应用程序名称相同，否则它们将不会共享相同的会话/应用程序数据。

并快速扫描“session.user”等应用程序之间可能存在的变量冲突。

# datetime - HH:MI:SS 中两次之间的差异

> ID：12044031
> 
> 赞同：2
> 
> 时间：2012-08-20T19:40:26.870
> 
> 标签：datetime, time, sap, business-objects

**我的问题：**我需要使用脚本以**HH:MI:SS**格式获取两个日期（时间）之间的差异。例如，如果我有两次：

```
2012/08/24 13:04:23
2012/08/24 14:15:32 
```

我的结果是：

```
1:11:09 
```

**要求：**我是使用 SAP 的 BusinessObjects 数据服务设计器编写的，所以我的脚本必须满足他们的语法规则（点击[这里](http://help.sap.com/businessobject/product_guides/boexir32SP1/en/xi321_ds_designer_en.pdf)查看长 pdf 文档...如果您不熟悉 SAP 的语法，只知道它真的很有限。 ..)。

* * *

**我试过的：**目前我有一个函数（见下文），它将为用户提供一个他们可以在`SQL`函数中使用的 SQL 语句，这将为他们提供他们正在寻找的东西，但我想让这个数据存储不可知.

这是我当前的功能（不是我真正想要的）：

```
#Use this with a SQL function. For example: SQL('DSS_USER', GetTimeDifferenceSQL($time_1, $time_2));

return '
with seconds as (
  select 24*60*60*(to_date(\'[$time_1]\', \'YYYY.MM.DD hh24:mi:ss\')
                    - to_date(\'[$time_2]\', \'YYYY.MM.DD hh24:mi:ss\')) seconds_diff 
  from dual
)
select to_char(trunc(sum(seconds_diff)/3600), \'FM999999990\')  || \':\' || to_char(trunc(mod(sum(seconds_diff),3600)/60), \'FM00\') || \':\' || to_char(mod(sum(seconds_diff),60), \'FM00\')
from seconds
'; 
```

这不起作用，因为我希望它独立于数据存储并单独在脚本中计算。

我还尝试将日期转换为十进制数字，然后`JED_Time(int)`在它们上使用该函数，这很有效，除了十进制是以 10 为基数而时间是以任何为基数......所以这行不通。

* * *

**我的拖延：**我很难接受时间并没有真正确定的基础这一事实......任何帮助都会非常棒！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T10:40:01.860

更简单的方法是使用数据类型 Interval。

要获取两个日期时间之间的秒数：

```
interval_to_char( $dtFrom - $dtTo , 'SS'); 
```

> 获取一个区间并返回该区间的字符表示。
> 
> interval_to_char( [in] InputInterval As interval, [in] FormatString As varchar ) As varchar

此函数还可用于获取分钟和小时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:05:23.147

这可能完全准确，也可能不完全准确，但我想我明白了。输入非常受欢迎。希望有一天这会对某人有所帮助！

```
#Make sure that when we're finding the difference, we always take the lesser date from the greater date. We'll negate it at the end.
if ($time_1 < $time_2)
begin
  $temp_time = $time_1;
  $time_1 = $time_2;
  $time_2 = $temp_time;
end

#Get all value differences from the two times
$nanoseconds = to_decimal(to_char($time_1, 'FF'), '.', null, 0) - to_decimal(to_char($time_2, 'FF'), '.', null, 0);
$seconds = to_decimal(to_char($time_1, 'SS'), '.', null, 0) - to_decimal(to_char($time_2, 'SS'), '.', null, 0);
$minutes = to_decimal(to_char($time_1, 'MI'), '.', null, 0) - to_decimal(to_char($time_2, 'MI'), '.', null, 0);
$hours = to_decimal(to_char($time_1, 'HH24'), '.', null, 0) - to_decimal(to_char($time_2, 'HH24'), '.', null, 0);
$days = interval_to_char($time_1 - $time_2, 'D');

#fix nanoseconds
if ($nanoseconds >= 1000000000)
begin
  $seconds = $seconds + 1;
  $nanoseconds = $nanoseconds - 1000000000;
end

if ($nanoseconds < 0)
begin
  $seconds = $seconds -1;
  $nanoseconds = $nanoseconds + 1000000000;
end

#fix seconds
if ($seconds >= 60)
begin
  $minutes = $minutes + 1;
  $seconds = $seconds - 60;
end

if ($seconds < 0)
begin
  $minutes = $minutes -1;
  $seconds = $seconds + 60;
end

#fix minutes
if ($minutes >= 60)
begin
  $hours = $hours + 1;
  $minutes = $minutes - 60;
end

if ($minutes < 0)
begin
  $hours = $hours -1;
  $minutes = $minutes + 60;
end

#fix hours
if ($hours >= 24)
begin
  $days = $days + 1;
  $hours = $hours - 24;
end

if ($hours < 0)
begin
  $days = $days - 1;
  $hours = $hours + 24;
end

#fix days
if (trunc($days/365, 0) >= 1)
begin
  $years = trunc($days/365, 0);
  $days = $days - ($years * 365);
end

if (round($days/7, 0) > 0)
begin
  $weeks = round($days/7, 0);
  $days = $days - ($weeks * 7);
end

$ret = '';

if ($years > 0)
begin
  $ret = $years||' year'||ifthenelse($years = 1, '', 's')||' ';
end

if ($weeks > 0)
begin
  $ret = $ret||$weeks||' week'||ifthenelse($weeks = 1, '', 's')||' ';
end

if ($days > 0)
begin
  $ret = $ret||$days||' day'||ifthenelse($days = 1, '', 's')||' ';
end

$ret = $ret||$hours||':'||lpad($minutes, 2, '0')||':'||lpad($seconds, 2, '0')||':'||lpad(round($nanoseconds/1000000, 0), 3, '0');

#Negate it if the parameter values were swapped at the beginning (using $temp_time)
if ($temp_time is not null)
begin
  $ret = '-'||$ret;
end

return $ret; 
```

# objective-c - iOS - @autoreleasepool 解决崩溃或解决方法？

> ID：12044034
> 
> 赞同：0
> 
> 时间：2012-08-20T19:40:52.330
> 
> 标签：objective-c, ios, memory-management, nsautoreleasepool

所以应用程序崩溃了，没有堆栈跟踪或任何异常，我每次都可以复制这个崩溃。我的第一个想法是它必须是双重发布，在运行僵尸10分钟后，我无法让应用程序崩溃，甚至一次都没有。

查看 Allocations 后，我注意到在调用该方法时分配的对象的大小发生了巨大的跳跃。所以我最终在 for 循环中有一个 @autoreleasePool 。这个自动释放池修复了崩溃；但是我如何确认这确实是内存不足的问题？（didRecieveMemoryWarning 在崩溃前的任何时候都没有被调用）

为什么 autoreleasePool 解决了这个问题？

为什么没有调用 didRecieveMemoryWarning？是不是因为在我们到达当前运行循环结束之前应用程序内存不足？

```
- (void)doSomething
{

   for (Item *item in self.items)
   {
      @autoreleasepool
      {
         // A bunch of initializations here that take a lot of memory
      }
   }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T19:43:19.920

使用 Instruments 监控分配，看看它是否在没有自动释放池的情况下上升。

如果崩溃发生得特别快，或者您正在阻塞发生内存通知的队列，您将看不到通知。

Autorelease 最有可能解决了这个问题，因为在你的初始化过程中创建了大量的 autoreleased 对象。在退出循环之前，池不会被排干。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T04:19:35.957

didRecieveMemoryWarning 不是异步调用的，您的主线程必须返回到 NSRunLoop 才能获取下一个事件，该事件可能是对 didRecieveMemoryWarning 的调用。此外，即使是你也无法清理自动释放池中的所有对象，所以如果问题是很多自动释放池的东西，你能否做很多事情是值得怀疑的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-20T19:55:01.473

这是否在 UIApplicationMain 的同一线程上运行？for 范围是否使用 alloc/init 分配大量对象？ARC 是否启用？

@autorelease pool 是堆的一部分，负责在没有显式调用 init 的情况下分配对象，如 / *[NSString stringWithFormat:"%@",format]* / 或使用自动释放返回，如 / *[[[NSObject alloc] init] autorelease]* / .

问题一定已经消失了，因为每次循环结束时，它都会执行 [pool drain]，释放该范围内所有静态分配的对象。我建议您创建另一个线程来执行此分配并在两者之间暂停主线程（也许使用 UIAlertView？）。当您在另一个自动释放池中创建一个自动释放池时，第二个可能会卡在第一个中，只会在应用程序结束时释放。希望能帮助到你。

# c++ - CPython API 与 C++ 类结合

> ID：12044036
> 
> 赞同：3
> 
> 时间：2012-08-20T19:40:55.263
> 
> 标签：c++, python, api

我正在尝试在 C++ 类中使用 C/Python API 中定义的结构。具体来说，我正在尝试为`PyMethodDef`and定义一个结构数组`PyMemberDef`（文档在[此处](http://docs.python.org/release/2.6.8/c-api/structures.html?highlight=pymemberdef#PyMethodDef)）：

对于`PyMethodDef`，我可以在类头中定义一个静态数组并在实现文件中声明它。但是，做同样的事情`PyMemberDef`会给我以下错误：

```
error: elements of array 'PyMemberDef members_ []' have incomplete type
error: storage size of 'members_' isn't known. 
```

我想我可以看到为什么`PyMethodDef`有效但`PyMemberDef`无效。在 Python 源代码中，`PyMethodDef`定义如下：

```
struct PyMethodDef {
    ...
    ...
};

typedef struct PyMethodDef PyMethodDef; 
```

而`PyMemberDef`定义如下：

```
typedef struct PyMemberDef {
   ...
   ...
} PyMemberDef; 
```

我通过在我的代码中定义`PyMemberDef`方式`PyMethodDef`并确认它编译没有错误来确认这是问题的原因。但是，我不知道如何纠正这一点。我不想自己硬编码和重新定义它。希望这足够清楚。我可以根据要求提供更多细节。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T20:42:11.467

如果您尝试使用 clang，它会给您一些更有意义的错误消息，例如：

```
pymountboot.cxx:45:20: error: variable has incomplete type 'PyMemberDef'
static PyMemberDef foo_members[] = {
                   ^
/usr/include/python2.7/object.h:381:12: note: forward declaration of 'PyMemberDef'
    struct PyMemberDef *tp_members;
           ^
1 error generated. 
```

所以，这里似乎`PyMemberDef`并没有真正声明。

快速 grep 显示它是在 中声明的`structmember.h`，并且该文件不包含在`Python.h`.

然后快速查看有关[定义新类型](http://docs.python.org/extending/newtypes.html#adding-data-and-methods-to-the-basic-example)的 Python 文档，您会注意到该示例以：

```
#include <Python.h>
#include "structmember.h" 
```

# sql-server - 什么数据库用于网络共享？

> ID：12044038
> 
> 赞同：0
> 
> 时间：2012-08-20T19:41:08.693
> 
> 标签：sql-server, sql-server-2012-express

我需要帮助来选择用于我正在编写的应用程序的数据库。基本上，我正在编写一个应用程序，该应用程序将有大约 5-10 个用户访问数据库以输入值、生成报告或只是查找信息。我们目前正在使用 Microsoft Access，但 VBA 很糟糕，我想用 C# 重写应用程序。

我需要一个同时允许多个用户的数据库。目前访问数据库位于网络共享上，但如果有更好的方法来做到这一点，我全力以赴。

使用该应用程序的每个人都可以在他们的计算机上安装任何东西。但是，我在一个无权更改设置的网络上。在这种情况下，我正在考虑使用 SQL Express，但如果没有专用服务器，我不知道这将如何工作，而且 SQLlite 并不真正支持网络上的多用户访问，我真的很讨厌 MS 访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T12:37:01.390

正如大卫在评论中所建议的那样，我将向大学计算机服务提出请求并请求 SQL Server 数据库。

# sql - sql验证两个表的关系

> ID：12044039
> 
> 赞同：0
> 
> 时间：2012-08-20T19:41:17.830
> 
> 标签：sql

我有两张桌子：A 和 B

表 A 列：
content_key data_key

表 B 列： content_key person_key

我需要验证每个 data_key 只有一个 person_key 与之关联，它可以多次具有相同的 person_key 但只有一个唯一值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T19:54:41.953

一个很好的方法是使用 COUNT(DISTINCT)：

```
select A.data_key, count(distinct person_key) as numPersons
from A join
     B
     on A.content_key = B.content_key
group by A.data_key
order by 2 desc 
```

我添加了顺序，因此您可以先查看重复项。

好吧，既然您想验证而不是查看重复项，请添加一个 HAVING 子句：

```
having count(distinct person_key) > 1 
```

如果查询未返回任何行，则数据符合您的条件。

此外，这假设 person_key 永远不会为 NULL。如果发生这种情况，计数会有点复杂：

```
(COUNT(distinct person_key) + max(case when person_key is null then 1 else 0 end)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:45:21.367

您应该能够使用`COUNT()`and`GROUP BY``data_key``person_key`

```
SELECT count(data_key) cnt, data_key, person_key
FROM tableA a
INNER JOIN tableB b
    ON a.content_key = b.content_key
GROUP BY data_key, person_key 
```

# math - 使用 MathJax 排版 Raphaël 文本节点

> ID：12044041
> 
> 赞同：1
> 
> 时间：2012-08-20T19:41:35.030
> 
> 标签：math, raphael, mathjax

是否可以将文本节点添加到 Raphaël 创建的 SVG 并使用 MathJax 排版其数学？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T21:46:55.950

[MathJax 用户组](https://groups.google.com/d/msg/mathjax-users/hpXzQSHwnMw/ldbopj0dq5YJ)也出现了类似的情况。去引用：

> MathJax 不在`<text>...</text>`SVG 内部渲染。`<text>`块只能包含文本，因此需要 MathJax 分解元素`<text>`、重新定位片段并插入 SVG（不是 HTML-CSS 或 NativeMML）输出。使用 SVG 输出 jax 是可能的，但目前不支持。该`<foreignObject>`方法是目前唯一有效的方法（IE9 除外，它没有实现`<foreignObject>`）。
> 
> 这当然是未来发展需要考虑的用例。

# ruby-on-rails - Link_to rails 嵌套表单编辑

> ID：12044042
> 
> 赞同：0
> 
> 时间：2012-08-20T19:41:37.620
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我只是按照以下教程进行操作，效果很好。[http://www.communityguides.eu/articles/6](http://www.communityguides.eu/articles/6)

然而，他对我来说很难的一件事就是编辑。

我打电话给我的link_to 编辑有跟随

```
<%= link_to 'Edit', edit_article_comment_path(@article, comment) %> 
```

然后将我带到一个错误的页面，不知道为什么。

```
NoMethodError in Comments#edit

Showing /home/jean/rail/voyxe/app/views/comments/_form.html.erb where line #1 raised:

undefined method `comment_path' for #<#<Class:0xa8f2410>:0xb65924f8>
Extracted source (around line #1):

1: <%= form_for(@comment) do |f| %>
2:   <% if @comment.errors.any? %>
3:     <div id="error_explanation">
4:       <h2><%= pluralize(@comment.errors.count, "error") %> prohibited this comment from being saved:</h2> 
```

现在这里是评论中的表格编辑

```
<%= form_for(@comment) do |f| %>
  <% if @comment.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@comment.errors.count, "error") %> prohibited this comment from being saved:</h2>

      <ul>
      <% @comment.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

这里是控制器文章控制器秀

```
 @article = Article.find(params[:id])
 @comments = @article.comments.find(:all, :order => 'created_at DESC') 
```

评论控制器编辑

```
 def edit
    @comment = Comment.find(params[:id])
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T19:55:02.917

看起来它`comment`是一个嵌套资源，因此您需要指定包含`article`在其中的资源`comment`。例如：

```
<%= form_for [@article, @comment] do |f| %> 
```

`comment_path`是一个未定义的方法，因为没有在顶层公开注释的路由。有时运行`rake routes`以查看可用的路线很有帮助。

更新：

您链接的文章仅提供评论`create`和`delete`操作。如果您需要支持编辑操作，那么您需要通过更改来修改路由：

```
resources :comments, :only => [:create, :destroy] 
```

至：

```
resources :comments, :only => [:create, :destroy, :edit, :update] 
```

您还需要实现编辑和更新操作 - 按照惯例，编辑将显示表单，更新将处理表单提交。您还需要确保它`@article`在您的编辑视图中可用。

# python - Python：py2app“ImportError：dlopen（）：未加载库”

> ID：12044043
> 
> 赞同：0
> 
> 时间：2012-08-20T19:41:40.050
> 
> 标签：python, macos, numpy, importerror, py2app

我编写了一个 python 脚本，它可以与 numpy 和 scikit 的 audiolab 一起工作。我想使用 py2app 创建一个独立的应用程序，但无论我在哪台 OS X 计算机上测试它，我都会遇到同样的错误。

```
ImportError: dlopen(/Users/transfer15/Desktop/app/dist/PCMAlign/app/Contents/Resources/lib/python2.7/numpy/linalg/lapack_lite.so, 2): Library not loaded: @rpath/libmkl_intel_lp64.dylib

Referenced from: /Users/transfer15/Desktop/app/dist/PCMAlign/app/Contents/Resources/lib/python2.7/numpy/linalg/lapack_lite.so

Reason: image not found 
```

这对我来说有点奇怪，因为如果我按照文件路径，我可以`lapack_lite.so`在正确的文件夹中看到。

有什么解决办法吗？或者，有什么方法可以排除这个库，因为我没有使用线性代数（几乎只是使用 numpy 数组）以避免这个错误？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-06-21T03:16:19.700

最近遇到了同样的问题（Python 2.7，试图导入numpy 1.11版本），降级numpy的版本清除了错误。

如果您使用 pip 安装 numpy，您可以使用以下命令降级：`pip install 'numpy<1.7'`. 更高版本可能适合您。

# solr - 将 Cassandra 连接的值拆分/映射到 Solr 字段中

> ID：12044049
> 
> 赞同：2
> 
> 时间：2012-08-20T19:42:06.027
> 
> 标签：solr, cassandra, datastax-enterprise

我正在使用 Solr 和 Cassandra（通过 DSE）。这是 Cassandra 中的一个数据条目（行）：

```
ORDER_INFO_CF
 -orderHistoryID=1000072459
   -SPECIAL_COLUMN_KEY=0800000002||1294034400000|113942 
```

我可以使用这个 schema.xml 毫无问题地索引 Cassandra 数据：

```
<schema name="ORDER_INFO_CF" version="1.1">
 <types>
  <fieldType name="string" class="solr.StrField"/>
  <fieldType name="text" class="solr.TextField">
    <analyzer><tokenizer class="solr.WikipediaTokenizerFactory"/></analyzer>
  </fieldType>
 </types>
 <fields>
    <field name="orderHistoryID"  type="string" indexed="true"  stored="true"/>
    <field name="SPECIAL_COLUMN_KEY"  type="text" indexed="true"  stored="true"/>
 </fields> 
```

当然，将所有数据集中到一个以竖线分隔的字符串中并没有多大帮助。所以我尝试使用 PatternTokenizerFactory 将其拆分，如下所示（schema.xml）：

```
<schema name="ORDER_INFO_CF" version="1.1">
 <types>
  <fieldType name="string" class="solr.StrField" />
  <fieldType name="splitField" class="solr.TextField">
   <analyzer><tokenizer class="solr.PatternTokenizerFactory" pattern="|" /></analyzer>
  </fieldType>
 </types>
 <fields>
    <field name="orderHistoryID"  type="string" indexed="true"  stored="true"/>
    <field name="AccountNumber"  type="splitField" indexed="true"  stored="true"/>
    <field name="ActionFlag"  type="splitField" indexed="false"  stored="true"/>
    <field name="CreatedDate"  type="splitField" indexed="true"  stored="true"/>
    <field name="CreatedTime"  type="splitField" indexed="true"  stored="true"/>
 </fields> 
```

orderHistoryID 仍在映射中，但该`SPECIAL_COLUMN_KEY`值未拆分为上述四个字段。我确定我只是在`PatternTokenizerFactory`. 我也看过`DataImportHandler RegexTransformer`，但这似乎只适用于 RDBMS 和 XML 导入。

本质上，我在 Solr 中的数据映射如下：

```
orderHistoryID=1000072459
SPECIAL_COLUMN_KEY=0800000002||1294034400000|113942 
```

我试图让它像这样映射：

```
orderHistoryID=1000072459
AccountNumber=0800000002
ActionFlag=
CreatedDate=1294034400000
CreatedTime=113942 
```

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T10:34:49.170

解决此问题的更简单方法是使用[Solrj](http://wiki.apache.org/solr/Solrj#Usage)。假设您已经有一个从 cassandra 读取记录的 api，您将能够使用 Solrj 将其提供给 solr。

另一种方法是创建一个自定义 POJO，然后使用 . 例如 -

```
import org.apache.solr.client.solrj.beans.Field;

public class CustomRecord {
   @Field
   private String orderHistoryID;
   @Field
   private String AccountNumber;
   @Field
   private String ActionFlag;
   @Field
   private String CreatedDate;
   @Field
   private String CreatedTime;
} 
```

然后使用

```
SolrServer server = new HttpSolrServer("http://HOST:8983/solr/");
server.addBean(customRecord); 
```

更多详情请参考[直接将 pojos 添加到 solr](http://wiki.apache.org/solr/Solrj#Directly_adding_POJOs_to_Solr)中。

# ruby - Elasticsearch JSON 查询的轮胎等效项

> ID：12044050
> 
> 赞同：0
> 
> 时间：2012-08-20T19:42:15.563
> 
> 标签：ruby, elasticsearch, tire

我有一个标准 JSON 格式的查询，当直接从命令行查询时效果很好。json是：

```
{"fields" : ["id"],
 "query":{
    "bool":{
      "must":[
        {
          "custom_score" : {
              "query" : {
                "bool" : {
                  "should" : [
                    {
                      "term" : {"a.in.group" : "abcd"}
                    },
                    {
                      "term" : {"a.in.group": "ALL"}
                    }
                   ]
                 }
              },
            "boost" : 1.0,
            "script" : "_score"
            }
        },

        {
          "custom_score" : {
              "query" : {
                "bool" : {
                  "should" : [
                    {
                      "term" : {"b.in.prefix" : pre}
                    },
                    {
                      "term" : {"b.in.group" : "abc"}
                    }
                   ]
                 }
              },
            "boost" : 1.0,
            "script" : "_score"
            }
        }
       ]
      }
    }
} 
```

这给了我想要的结果：

```
curl -X GET "localhost:9200/test/rule/_search" -d @query.json
{"took":6,"timed_out":false,"_shards":{"total":5,"successful":5,"failed":0},"hits":{"total":1,"max_score":2.3251607,"hits":[{"_index":"memphis","_type":"rule","_id":"1","_score":2.3251607,"fields":{"id":1}}]}} 
```

但是我无法为等效的轮胎查询找到正确的语法。我试过了：

```
s=Tire.search('test/rule') do
    query do
        boolean do
            must [
                query do
                    boolean do
                        should { string "a.in.group:abcd" }
                        should { string "a.in.group:ALL" }
                    end
                end
                query do
                    boolean do
                        should { string "b.in.prefix:pre" }
                        should { string "b.in.group:abc" }
                    end
                end
            ]
        end
    end

    fields :id
end 
```

但这给了我语法错误：

```
ruby -c query.rb 
query.rb:7: syntax error, unexpected keyword_do_block, expecting ']'
query.rb:19: syntax error, unexpected ']', expecting keyword_end
query.rb:46: syntax error, unexpected $end, expecting keyword_end 
```

我在任何其他论坛上都找不到任何帮助。当我尝试在 must 块中放置多个查询时会出现问题。请帮忙。

提前致谢

-阿兹塔布

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T21:12:07.580

看看这是否可以解决问题：

```
s = Tire.search 'test/rule' do
    query do
      boolean do
          must do
              custom_score :boost => 1.0, :script => "_score" do
                boolean do
                    should { term 'a.in.group', "abcd" }
                    should { term 'a.in.group', "ALL" }
                end
              end
          end
          must do
              custom_score :boost => 1.0, :script => "_score" do
                boolean do
                    should { term 'b.in.prefix', pre }
                    should { term 'b.in.group', "abc" }
                end
              end
          end
      end
    end
    fields :id
end 
```

# debugging - 在 Scala 中调试日志而不影响性能

> ID：12044054
> 
> 赞同：6
> 
> 时间：2012-08-20T19:42:22.977
> 
> 标签：debugging, scala, optimization, logging, preprocessor

在 C/C++/Objective-C 等语言中，通常使用预处理器宏来定义甚至不为已发布的二进制文件编译的日志记录机制，因此不会对性能造成影响。类似于以下内容：

```
#ifdef DEBUG
printf("some event we want to log\n");
#endif 
```

现在，我知道 Scala 中没有预处理器。所以我的问题是：实现一种机制来记录程序活动以进行调试的最佳方式是什么，同时在关闭时对性能的影响最小？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-20T20:04:06.343

您可以使用[`scala.annotation.elidable`](http://www.scala-lang.org/api/current/scala/annotation/elidable.html)

> 可能在生成的代码中删除调用的方法的注释。
> 
> 将 -Xelide-below 传递给 scalac 会影响行为。如果给定注释的优先级低于命令行参数，则标记为 elidable 的方法将从生成的代码中省略。例子：

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-20T19:46:54.897

当前的做法（在 Scala 2.9.x 或更早版本中）是使用 thunk 类型（例如，请参阅 Simple Logging Facade for Scala [SLFS](https://github.com/weiglewilczek/slf4s)）：

```
def log(x: =>Any) = if (logging) println(x)

// later in code
log("var1: " + myVar1) 
```

这通常比实际构造字符串更便宜，因为字符串创建（和任何后续活动）只有在`logging`为真时才完成。但是，它仍然会产生上述 thunk 的闭包创建成本`x`。

但是，从 Scala 2.10.x 开始，标准发行版中包含了一个实验性宏实现（请参阅[此页面](http://scalamacros.org/)或[SIP](http://docs.scala-lang.org/sips/pending/self-cleaning-macros.html)）。宏系统将允许您编写几乎不会产生运行时成本的日志调用（除了`logging`变量检查） - 它们允许您内联对 的调用`log`，因此：

```
log("var1: " + myVar1) 
```

变成：

```
if (logging) log("var1: " + myVar1) 
```

请注意，在这种情况下，没有为 创建闭包`log`，并且仅在为 true 时才评估日志消息字符串`logging`- 成本只是 if-check。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T19:45:23.220

[Log4J](http://logging.apache.org/log4j/1.2/)是一个常见的 JVM 日志框架。它专门设计用于将性能影响降至最低：

> 在运行 JDK 1.3.1 的时钟频率为 800Mhz 的 AMD Duron 上，确定是否应该记录日志语句需要大约 5 纳秒。实际的日志记录也相当快，从使用 SimpleLayout 的 21 微秒到使用 TTCCLayout 的 37 微秒不等。PatternLayout 的性能几乎与专用布局一样好，只是它更加灵活。

因此，当您拨打以下电话时：

```
LOG.debug("something here") 
```

框架将首先检查是否启用了“调试”日志记录。这个检查非常快。如果日志记录被禁用，则它不再做任何工作。

然而，有一个问题。如果你写

```
LOG.debug(expensiveOperation()) 
```

那么框架在执行昂贵的操作之前不会进行启用调试的检查。纠正这种情况的方法是：

```
if(LOG.isDebugEnabled) LOG.debug(expensiveOperation()) 
```

# c# - 如何保护 Windows 8 应用程序中的配置数据？

> ID：12044057
> 
> 赞同：3
> 
> 时间：2012-08-20T19:42:42.580
> 
> 标签：c#, windows-8, winrt-xaml

我的 Windows 8 (Metro) 应用程序使用不同的 Web 服务来访问和混合数据。这些服务中的每一个都需要一个密钥（一些多个密钥）来访问它们。结果，这些密钥**很有价值**，并且花了我钱（或者可以，根据使用情况）。我可以轻松地将这些键包含在我的应用程序中。但是我怎样才能保护我的密钥不被窥探和滥用呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T22:48:19.630

考虑重构您的应用程序以从您的服务器调用受保护的 Web 服务并将结果传递回客户端，从而消除将凭据放置在客户端的需要。

如果担心变成带宽，您可以让密钥本身不与二进制文件一起打包，而是下载并加密。请参阅[http://weblogs.asp.net/jgalloway/archive/2008/04/13/encrypting-passwords-in-a-net-app-config-file.aspx](http://weblogs.asp.net/jgalloway/archive/2008/04/13/encrypting-passwords-in-a-net-app-config-file.aspx)。

不管你怎么做，如果服务被客户端调用，用户仍然可以访问它。

编辑：问题：我如何保护暴露的服务答案：你不能，但你可以让它变得更难。

1.  首先，安装一个客户端证书，以保护从客户端到您的服务的通信通道。

2.  接下来，包括一个服务器生成的 nonce，它要求客户端从您部署的代码中的已知 dll 或 exe 中读取一串字节，该随机偏移量是服务器请求的随机偏移量。如果部署的对象受到法律措施的保护而不会再分发，如果有人写第三方客户端，您可以起诉月球，因为他们必须将您用于保护的图像与他们的应用程序一起重新分发。

3.  确保您的 Web 服务对每个用户进行限制。将每个用户限制为每小时 100 次点击 - 或者任何介于虚假和真实之间的界限。

4.  报告和审计。记录对昂贵 Web 服务的点击，并定期验证它们是否以与您的应用程序使用一致的方式生成。

5.  随机化。如果您想让任何试图对您的软件进行逆向工程的人感到困难，请确保您至少每天随机化用于访问您的服务的 URI。创建一个将日期用作种子并返回该日期的唯一 URI 的函数。

6.  混淆 - 在这一点上，你需要一个真正准备攻击你的应用程序的人。为了进一步毁掉他的一天，通过一个好的混淆器运行你编译的二进制文件，以确保

再一次，这些都不能确保该服务不能在您的服务之外使用，但是它们使它变得非常困难。如果您*确实*需要确保只有您的软件可以访问您的服务，请使用加密令牌来分发您的应用程序的私钥。这样，他们可以使用该服务的唯一方法是，如果有人将该设备物理连接到他们的计算机上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T19:49:16.427

你不能完全保护它。您需要将其视为完全妥协，因为您可以采取的所有措施都有解决方法。

WinForms 应用程序也是如此。

与我要求类似内容时相关：[WinForms 应用程序的常见漏洞](https://stackoverflow.com/questions/11346652/common-vulnerabilities-for-winforms-applications)

短版 - 即使您将这些密钥存储在其他地方，如果最终用户可以反编译您的代码并查看您的代码如何访问这些密钥，他们也可以获取它们。

你能做的最好的事情就是增加尽可能多的层（合理的）你的防御，使其尽可能地困难。我们的方法列在[这个答案](https://stackoverflow.com/questions/11977336/need-a-security-scenario-for-asp-net-webservice/11977611#11977611)中。你也许可以改进它。如果是这样，请分享，因为我们想改进我们的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T19:47:15.313

一种独立于平台的方式可能是存储加密密钥。或者，如果密钥在应用程序的生命周期内很少或永远不会更改，则对其进行硬编码。

# php - getElementById 用于多个无线电输入

> ID：12044058
> 
> 赞同：-1
> 
> 时间：2012-08-20T19:42:47.120
> 
> 标签：php, javascript, html

我知道您不能为一页中的元素提供相同的 id。但是我有一个 PHP 使用 SELECT * statemnt 生成的列表，该列表显示了 HTML 表中数据库中的所有行，每行数据旁边都有一个单选框，其值是 mysql 中该行的 id。我在这里要做的是，当您检查该行的 Radio 并运行 Func 时，JavaScript 会获取作为 id 号的值，因此我可以删除该行

像这样的东西：但我不能再给所有的收音机相同的 id

```
var age = document.getElementById('radio').value;
    var queryString = "?id=" + radio;
    ajaxRequest.open("GET", "coderemove.php" + queryString, true);
    ajaxRequest.send(null); 
```

当我运行它时，显然没有任何反应

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T19:54:20.657

您可以使用纯 JavaScript 方法 - 想象一下 PHP 代码输出以下内容：

```
Thing Number 1 <input type="radio" name="myRadioId" value="thingy1" />
Thing Number 2 <input type="radio" name="myRadioId" value="thingy2" /> 
```

那么我们的 JavaScript 代码可以是：

```
function getRadioValue(radioName){
    // Get all inputs on the page.
    var inputs = document.getElementsByTagName('input');

    for (var i = 0; i < inputs.length; i++) {
        // Check it is a radio of the correct name and is checked.
        if (inputs[i].type === 'radio' &&
            inputs[i].name === radioName &&
            inputs[i].checked) {

            // We have the checked radio - return its value.
            return inputs[i].value;
        }
    }
    return null;
}

var queryString = "?id=" + getRadioValue('myRadioId');
// Do stuff here 
```

但是如果我们使用[jQuery](http://jquery.com/) - 那么它就变得简单多了：

```
var queryString = "?id=" + $("input:radio[name=myRadioId]").val(); 
```

如果您不了解 JavaScript，并且希望使用它来编写网页，我鼓励您花一个小时来学习 jQuery 的基础知识。它会为您节省一些麻烦:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:47:22.307

采用

```
<input name="mygroupname" type="radio" value="1">
<input name="mygroupname" type="radio" value="2">
<input name="mygroupname" type="radio" value="3"> 
```

和

```
document.getElementsByName('mygroupname'); 
```

获取数组中的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T19:54:54.947

试试这个：

```
function test() {
    var getRadios = document.getElementById("input")
    for (var x = 0; x < getRadios.length; x++) {
        if ( getRadios[x].type == "radio" && getRadios[x].checked )
            alert(getRadios[x].value)
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T20:22:41.600

我想您需要动态更改单选按钮的 id。[PHP](http://en.wikipedia.org/wiki/PHP)部分是：

```
<?php
    $qry = "select * from table_name";
    $res = mysql_query($qry);
?>
<table>
    <?php
        $count = 1;
        while($data=mysql_fetch_array($res)) {
    ?>
    <tr>
        <td><input type = 'radio' value='<?php echo $data
        ['col']?>' id=<?php echo $count;?> onclick="alertId(this.id)"
        name="radio"></td>
        <td><?php echo $data['col'];?></td>
    </tr>
    <?php
            $count++;
        }
    ?>
</table> 
```

JavaScript 部分是：

```
<script type = "text/javascript">
    function alertId(id) {
        alert(id);
    }
</script> 
```

这将提醒单击的单选按钮的 id，然后您可以通过 获取值`documnet.getElementById(id).value`。

# objective-c - 属性名称中的 NSPredicate 通配符

> ID：12044064
> 
> 赞同：0
> 
> 时间：2012-08-20T19:43:14.473
> 
> 标签：objective-c, ios, cocoa-touch, nspredicate

有没有办法在 NSPredicate 的属性名称中包含通配符？

例如，我有一个这样的谓词：

```
keyPath CONTAINS 'C1b' 
```

我在一系列字典上使用这个谓词。在字典中，`keyPath`看起来像这样：

```
A2a1*;B1a*;C1*;D4* 
```

在此值上使用上述谓词`keyPath`，它不会作为匹配项出现。如果我更改`C1b`为 just `C1`then 它确实会匹配。如何使它与通配符一起使用？

如果我不清楚或者我可以提供更多信息，请告诉我。

谢谢你的帮助！

**编辑：**我应该提到我需要匹配`keyPath`. 因此，例如，我的谓词看起来像这样：

```
(keyPath CONTAINS 'B1a') AND (keyPath CONTAINS 'C1c1') AND (keyPath CONTAINS 'A2a1') AND (keyPath CONTAINS 'D4a') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T19:54:20.033

下面的代码可以正常工作

patternString 可以包含通配符

例如，patternString = A2a1*

```
-(NSMutableArray *)searchByPattern:(NSString *)patternString inputArray:(NSMutableArray *)inputArray
{
    NSLog(@"orginal Array count=%d",[inputArray count]);
    NSString *match=[NSString stringWithFormat:@"%@",patternString];
    NSLog(@"match = %@",match);
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF like %@",match];    
    NSMutableArray *mArrayFiltered = [[inputArray filteredArrayUsingPredicate:predicate] mutableCopy];
    //NSLog(@"mArrayFiltered = %@ count = %d",mArrayFiltered,[mArrayFiltered count]);
    return mArrayFiltered;
} 
```

# ajax - 单击后如何使用 ajax 隐藏 h:selectOneListbox 组件？

> ID：12044071
> 
> 赞同：1
> 
> 时间：2012-08-20T19:43:44.613
> 
> 标签：ajax, jsf, jsf-2

单击 a 时，我会`<h:selectOneListbox>`出现一个`<h:commandbutton>`。当用户从列表框中选择时，我希望所选值出现在 a 中`<h:inputText>`并隐藏列表框。

`<h:selectoneListbox>`一旦出现，我就无法停止渲染。该`rendered`属性在视图首次出现时工作正常，但在我单击列表并调用侦听器后被忽略。

有任何想法吗？

这是小面：

```
<h:panelGroup>
    <h:inputText id="TitleText" value="#{bindingScheduleHandler.title}"/>
    <h:commandButton value="Clients" actionListener= #bindingScheduleHandler.clientList}" />

    <h:selectOneListbox id="listBox" value="#{bindingScheduleHandler.clients}" size="5"  
        rendered="#{bindingScheduleHandler.showClients}">
        <f:selectItems value="#{bindingScheduleHandler.clientLabelsValues}" />
        <f:ajax event="click" listener="#{bindingScheduleHandler.clickListener}"  
            render="TitleText" />
    </h:selectOneListbox>
</h:panelGroup> 
```

这是支持bean：

```
public void clickListener(AjaxBehaviorEvent event) {
    this.title = clients;
    showClients = false;
    renderClientList = false;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T19:52:59.157

在 中`<f:ajax render>`，您不能引用由 JSF 有条件地呈现的组件。相反，您需要引用**始终**呈现的父组件。简单的解释是`<f:ajax>`使用 JavaScript 来更新由 JSF 组件表示的 HTML 元素的内容（节点值）。无法显示/隐藏 HTML 元素本身。

只需更新父组件即可。

```
<h:panelGroup id="group">
    <h:inputText id="TitleText" value="#{bindingScheduleHandler.title}"/>
    <h:commandButton value="Clients" actionListener= #bindingScheduleHandler.clientList}" />

    <h:selectOneListbox id="listBox" value="#{bindingScheduleHandler.clients}" size="5"  
        rendered="#{bindingScheduleHandler.showClients}">
        <f:selectItems value="#{bindingScheduleHandler.clientLabelsValues}" />
        <f:ajax event="click" listener="#{bindingScheduleHandler.clickListener}"  
            render="group" />
    </h:selectOneListbox>
</h:panelGroup> 
```

顺便说一句，这也将立即解决所选项目未显示在`<h:inputText>`:)中的问题

# c# - 带负参数的 Math.Round

> ID：12044072
> 
> 赞同：8
> 
> 时间：2012-08-20T19:43:52.767
> 
> 标签：c#, c++, rounding

全部，

我正在尝试将 Borland C++ 代码转换为 C#。在旧代码中，我看到以下内容：

```
double a = RoundTo( b, -2 ); 
```

查看 Borland 文档，我发现 RoundTo() 接受正参数和负参数以提高精度。正数表示舍入到 10^n，负数表示舍入到 10^-n。

查看 Math.RoundTo() 的 C# 文档，我找不到它是否会接受负数以确保精度的参考。并且所有样本都以正数表示。

在这种情况下转换代码的正确方法是什么？我是否应该忘记标志并写下：

```
double a = Math.Round( b, 2 ); 
```

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T20:19:04.173

我不知道针对您要进行的舍入类型的内置解决方案，但这并不意味着某处没有。一个快速的解决方案是创建一个方法甚至扩展方法来做你正在寻找的东西：

```
double DoubleRound(double value, int digits)
{
    if (digits >= 0)
    {
        return Math.Round(value, digits);
    }
    else
    {
        digits = Math.Abs(digits);
        double temp = value / Math.Pow(10, digits);
        temp = Math.Round(temp, 0);
        return temp * Math.Pow(10, digits);
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T19:49:56.180

[C# 中双精度数的Math.Round不能接受](http://msdn.microsoft.com/en-us/library/75ks3aby)*数字*的负值（事实上，如果数字小于 0 或大于 15，则在该页面中记录了抛出 ArgumentOutOfRangeException ）

该参数是在 Math.Round 的情况下，而不是要求一定数量的小数位，这意味着参数的符号将被反转，所以在你的情况下，是的，

```
double a = Math.Round( b, 2 ); 
```

将是带有 -2 参数的 RoundTo 的正确翻译。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T19:50:17.923

你试过了吗？我做了并得到了一个例外：

```
System.ArgumentOutOfRangeException：四舍五入的数字必须介于 0 和 15 之间，包括 0 和 15。
参数名称：数字
   在 System.Math.Round（双值，Int32 位）
   在 MyClass.RunSnippet()
   在 MyClass.Main()
```

# java - java从列表中分隔逗号并显示在单行中

> ID：12044074
> 
> 赞同：1
> 
> 时间：2012-08-20T19:44:05.917
> 
> 标签：java, list, comma

我已将键，值放在地图中，

```
map.put(id,list); 
```

id = 5 和

此列表包含的值为 ,

```
 A 
 OR    A,B, 
 OR    A,B,C 
 OR    sometimes no values. 
```

我正在遍历地图，

```
 Iterator itr=map.entrySet().iterator();
     while(itr.hasNext()){
        Map.Entry me=(Map.Entry)itr.next();
        int key =(Integer)me.getKey();
        List li = (List)me.getValue();
        System.out.println(key,li);
      } 
```

我想 system.out.println 像单行一样，

```
5 | A |         (if list contain A)
5 | A | B |     (if list contain A,B)
5 | A | B | C | (if list contain A,B,C)
5               (only 5 if there are no values as A B C) 
```

我不确定如何从列表中删除逗号并在单行的单独列中显示列表值，如上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T19:50:46.607

你有两个选择：

1.  您可以创建一个遍历所有元素并附加“|”的循环 介于两者之间。
2.  您可以覆盖 List ToString() 方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T19:59:57.813

```
 Iterator itr=map.entrySet().iterator();
     while(itr.hasNext()){
        Map.Entry me=(Map.Entry)itr.next();
        int key =(Integer)me.getKey();
        List myList = (List)me.getValue();
        System.out.println(key+"|"+StringUtils.join(myList.toArray(),'|'));

      } 
```

# crystal-reports - 水晶报表 2011 公式计算时间间隔并将其除以

> ID：12044076
> 
> 赞同：0
> 
> 时间：2012-08-20T19:44:14.753
> 
> 标签：crystal-reports

我需要帮助，我需要计算 1 小时内的时间间隔并将您的结果除以 12。

我的数据库中有一个表，它接收来自日期和时间的数据和一个以 5 分钟为周期的值字段，我在 1 小时内有 12 个值。我需要将这段 1 小时的值相加，然后除以 12。

我怎么能用水晶 2011 的公式来做到这一点？试图使用 DateDiff 传递一个参数时间间隔来过滤，但我没有成功。

我的参数使用类型日期和时间、静态、允许范围值​​​。

DateDiff ("h", {TB_Dados.Timestamp}, {?MyParameterDateRange})

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T13:27:48.480

您需要按小时对时间戳进行分组。扩展您的数据源以包含一个可用于按时间戳小时分组的字段，例如 yyyymmddhh。所有具有相同值的时间戳（在您的情况下最多为 12）都需要相加，然后您可以通过除以 12 或使用聚合函数来平均它们。

# c# - 实体框架中的异步等待支持？

> ID：12044079
> 
> 赞同：6
> 
> 时间：2012-08-20T19:44:29.130
> 
> 标签：c#, entity-framework, asynchronous, async-await

我一直在看`async`和`await`。我很喜欢。

我很好奇实体框架是否支持`async`和支持？`await`

> Entity Framework 满足 async/await 支持的用例，如果我想将 async/await 与 Entity Framework 一起使用，我该怎么做？

即：我能够在redis（booksleeve）周围有一个包装器。

那么当我有一个存储库模式时，我可以在 EF 中使用 async / await 吗？如何？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-20T19:49:12.793

对 async 和 await 的直接支持是[对 UserVoice for Entity Framework 强烈要求的建议](http://data.uservoice.com/forums/72025-entity-framework-feature-suggestions/suggestions/2726060-async-await-supported-asynchronous-calls)，并计划包含在 EF 6 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T21:37:35.300

在 NuGet 控制台中从 NuGet 获取 EF 6 PM> Install-Package EntityFramework -Pre 您将需要添加和删除一些引用

# php - XSS 过滤不会在 post codeigniter 上禁用

> ID：12044080
> 
> 赞同：3
> 
> 时间：2012-08-20T19:44:38.580
> 
> 标签：php, codeigniter, xss

我正在为我的网站开发一个基本的 WYSIWYG，我已经使用这条线来关闭 XSS 过滤

```
$this->input->post(NULL, FALSE); 
```

我也试过

```
$this->input->post(); 
```

据我了解，这应该给我所有的 postdata 而不是过滤它，但是，它似乎仍在删除我的`<script>`标签。暂时不考虑安全问题（我将继续处理这些问题）如何保证在不为整个站点禁用 XSS 的情况下不会删除我的脚本？

PS我还验证了`$config['global_xss_filtering']`设置为false。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:05:50.143

根据 CI 文档，如果您希望在没有 XSS 的情况下提取整个帖子数组，则应替换`$this->input->post(NULL, FALSE);` 为`$this->input->post();`

请参阅[http://codeigniter.com/user_guide/libraries/input.html](http://codeigniter.com/user_guide/libraries/input.html)

# jquery - 如果元素不适合屏幕，则添加滚动条

> ID：12044083
> 
> 赞同：2
> 
> 时间：2012-08-20T19:44:41.437
> 
> 标签：jquery, html, css, scrollbar

我有这样的：

```
 <li class="1"><a href="#">Link</a>
            <ul>
                <li class="item1"><a href="#">1</a></li>
                <li class="item2"><a href="#">2</a></li>
                <li class="item3"><a href="#">3</a></li>
            </ul>
        </li> 
```

当我按下链接时，那些 ul 项目会向下滑动，但如果它们太多，它们会从屏幕上滑出。如果存在许多 ul 项目并且它们开始向下滑动，我需要这样做，它会在屏幕末尾停止，并且会为这些 ul 链接出现一个滚动条。定义高度不是我想要的。我希望这是可以理解的：）谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T19:46:13.100

我认为您所要做的就是在最外面的 li 上设置一个最大高度并溢出：滚动它

```
max-height: 50px;
overflow: scroll; 
```

像这样[http://jsfiddle.net/yC32A/](http://jsfiddle.net/yC32A/)

似乎溢出： auto 也可以

机智溢出：自动[http://jsfiddle.net/yC32A/1/](http://jsfiddle.net/yC32A/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T19:53:48.307

为了限制`li`和防止它超出页面的“结束”，我相信你需要使用一些 jQuery/JavaScript。这是一个应该做你期望的片段：

```
var li = $(".item2");
var ul = $(".menu");
var bottom = ul.offset().top + ul.height();
var lim = $("body").height() - bottom + li.height();
li.css({"max-height":lim, "overflow-y":"auto"}); 
```

还要确保你的 CSS 中有这个：

```
body, html {
    height: 99%;
} 
```

希望有帮助！

# dart - 在 HttpRequest 中关闭监听器或监听器

> ID：12044088
> 
> 赞同：2
> 
> 时间：2012-08-20T19:45:04.700
> 
> 标签：dart

我看到使用 nodejs 可以在请求中添加侦听器：

```
req.addListener('close', .... ); 
```

但我找不到如何处理 Dart。我需要取消一个使用 SourceEvent 发送数据的计时器。如果不取消它，它会在客户端断开连接时继续运行。

编辑：我添加我的用例

```
_time(HttpRequest request, HttpResponse response) {
  response.headers..set(HttpHeaders.CONTENT_TYPE, 'text/event-stream')
              ..set(HttpHeaders.CACHE_CONTROL, 'no-cache')
              ..set(HttpHeaders.CONNECTION, 'keep-alive');
  var timer = new Timer.repeating(1000, (_){
    Date now = new Date.now();
    response.outputStream..writeString('data:${now.millisecondsSinceEpoch}\n\n');
  });
  // Here what I want to do
  request.onClose((event) => timer.cancel();  
} 
```

我的请求是我的请求处理程序对 url“/time”的经典 http 请求调用。我使用 SourceEvent 将时间推送给客户端，它工作正常。但我需要检测客户何时关闭他的连接。搜索后，如何做到这一点发现许多带有nodejs的样本都使用了这个`req.addListener('close', ... )`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-25T17:13:02.550

我没有尝试过，但我能想到的最好的方法是使用 inputStream：

```
request.inputStread.onClosed((_) => timer.cancel()); 
```

不过，我同意 Lars 的观​​点，即使这样可行，它也应该更容易找到并且更明确。可能想提交一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:55:15.527

您可以将事件处理程序添加到[HttpClientConnection](http://api.dartlang.org/docs/continuous/dart_io/HttpClientConnection.html)和响应/请求数据流。像这样：

```
var conn = httpClient.get(host, port, path);
conn.onResponse = (HttpClientResponse response) {
  if(response.statusCode == 200) {
    StringInputStream stream = new StringInputStream(response.inputStream);
    StringBuffer body = new StringBuffer();
    stream.onData = () => body.add(stream.read());
    stream.onClosed = () {
      // do something when its closed
    };
  }
}; 
```

# php - jQuery | Ajax，如何从外部 PHP 文件中接收到的数据中操作数组键？

> ID：12044089
> 
> 赞同：2
> 
> 时间：2012-08-20T19:45:03.137
> 
> 标签：php, jquery, json

我有一个脚本，其中使用 ajax 将密码发送到 PHP 文件。然后 PHP 文件检查密码是否正确，并发送回带有链接和成功代码的数组数据。收到数据后，alert的时候可以清楚的看到key和value，但是如何操作key从中获取value呢？

请参阅下面的示例，了解我如何使用 jQuery Ajax 与 PHP 进行通信：

jQuery 阿贾克斯：

```
$.ajax({
    type: "POST",
    url: "test.php",
    data: { pass: $("#pass-field").val() }
    }).done(function(data) {

        if(data.link != ""){
            alert("Link: " + data.link);
        }           
    }); 
```

PHP：

```
 if(strtolower($retrieved_password) == $original_password){
        echo json_encode(array("link" => "personal/cv.doc", "success" => "true")); 
    }else{
        echo json_encode(array("link" => "", "success" => "false")); 
    }
?> 
```

当我提醒 data.link 时，我会看到以下代码：

```
function link() {
    [native code]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:15:16.753

以下是您可以如何使用它：

*   PHP

```
<?php

    ...

    if (strtolower($retrieved_password) === $original_password) {
        // Use 'print json_encode(array(...));' if your PHP version is less than 5.4.
        print json_encode([
            'link'       => 'personal/cv.doc',
            'success'    => 'true',
        ]);
    } else {
        // Use 'print json_encode(array(...));' if your PHP version is less than 5.4.
        print json_encode([
            'link'       => '',
            'success'    => 'false',
        ]);
    }

    ...

?> 
```

*   jQuery

```
...

$.ajax({
    'data':       {
        'password': $('#password_input').val()
    },
    'success':    function (json_data) {
        if (json_data['success'] !== 'false') {
            alert(json_data['link']);
        }
    },
    'type':       'POST',
    'url':        '/path/to/php_script.php'
});

... 
```

`json_data`如果在 AJAX 调用中正确返回，这应该可以正常工作。如果它不起作用，请尝试更改`alert(json_data['link']);`并`console.log(json_data['link']);`检查您的控制台。在我看来，您可能希望在 Chrome 或 Safari 中这样做，因为开发人员工具对它们更好。您甚至可以尝试截取输出的屏幕截图并将其添加到您的帖子中，这样我们就可以看到数据是如何返回给您的。希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:22:45.670

您的问题是响应上有`text/html`类型。

回调中的`data`变量是 String 类型`done`

您应该`eval`对其进行操作以将其变成一个对象。

像这样的东西

```
$.ajax({
    type: "POST",
    url: "test.php",
    }).done(function(data) {
        var dataObj = {};
        eval ("dataObj = " + data); 
        console.log([dataObj]);         
    }); 
```

最好的解决方案当然应该是返回 type 的响应`text/json`。

这将使数据对象类型为`object`。

无论如何 - 你应该让你的回调支持这两种类型

```
$.ajax({
    type: "POST",
    url: "test.php",
    }).done(function(data) {
        var dataObj = null;

        switch ( typeof(data) ) {
            case "object" : { dataObj = data; break; }
            case "string" : { eval ("dataObj = " + data); break; }
            default : { throw "unsupported type [" + typeof(data) + "]"  }
        }

             //... more code here       
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:07:05.743

查看您的代码，对象返回似乎采用以下格式。

> {“链接”：“”，“成功”：“假”}

要访问对象的属性值，请使用以下内容。

`data.link`和/或`data.success`( `objectName.property`)

顺便说一句，`personal/cv.doc`并没有真正受到保护。根据您在此处输入的内容，我可以在没有密码的情况下下载它。

# javascript - 如何在 CoffeeScript 中编写这个简单的 javascript 代码？

> ID：12044098
> 
> 赞同：0
> 
> 时间：2012-08-20T19:46:00.590
> 
> 标签：javascript, coffeescript

我想要这段代码在 javascript 中：

```
beforeNode = children[  children.length -1 ] 
```

使用咖啡脚本中的这段代码：

```
beforeNode = children[  children.length -1 ] 
```

咖啡脚本生成：

```
beforeNode = children[children.length(-1)]; 
```

如何在 coffescript 中编写源代码以生成预期的 javascript 代码？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T19:57:39.217

不要使用空间！

```
// coffeescript
beforeNode = children[children.length-1] 
```

或者在每边使用一个空间`-`

```
// coffeescript
beforeNode = children[children.length - 1] 
```

结果是

```
// js
var beforeNode;

beforeNode = children[children.length - 1]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:05:59.487

或者使用两个空格！

```
# coffeescript
beforeNode = children[children.length - 1] 
```

结果是

```
// javascript
var beforeNode;

beforeNode = children[children.length - 1]; 
```

# nginx - 在 Google Chrome 中下载 mp4 文件

> ID：12044099
> 
> 赞同：0
> 
> 时间：2012-08-20T19:46:05.060
> 
> 标签：nginx, webserver

指定如何将服务器配置为他将 mp4 文件加载到 G Chrome 中的事实？当您单击链接下载时，会在浏览器中打开一个不太可接受的文件。我在找...他们说你必须配置标题，但我不太明白需要在哪里完成。还建议更改：应用程序/文件mp4；或删除此扩展名是相当 mimetypes

**我也试过：**

```
location /files { 

     if ($request_filename ~* ^.*?/([^/]*?)$) 
     { 
             set $filename $1; 
             add_header Content-Disposition "attachment; filename=$filename"; 
     } 
```

}

，但没有任何改变。

该怎么办？我很乐意接受任何建议。谢谢你。

* * *

我也知道 mp4 文件可以发给用户下载，在 savefrom.net 中实现

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T03:47:48.347

我认为你的标题有点错误`Content-Disposition`

```
add_header Content-Disposition "attachment; filename=\"$1\""; 
```

你也不需要`set filename $1;`（以我的例子）它应该被删除。
对我来说，这种方法效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-30T11:34:51.853

设置属性“下载”如

```
<a href='file.mp4' download='Very-Very-Good.mp4'>download</a> 
```

# tomcat - EntityManager 注入不适用于 Tomcat + OpenEJB

> ID：12044102
> 
> 赞同：0
> 
> 时间：2012-08-20T19:46:16.310
> 
> 标签：tomcat, netbeans, jsf-2, openejb

我正在使用 NetBeans IDE 7.1、Apache Tomcat 6.0.26、OpenEJB 3.0 和 JSF 2.0。首先我插入`openejb.war`文件夹：*Apache Tomcat 6.0.26\webapps*。看起来 Tomcat 服务器工作正常，因为在运行项目后 Tomcat 服务器会记录：

```
Apache OpenEJB 3.0    build: 20080408-04:13
http://openejb.apache.org/ 
```

这是我的代码：

**性别经理**

```
@Stateless
public final class GenderManager {
    private final static String QUERY_GET_GENDER = "from Gender gender";
    @PersistenceContext(unitName="ExampleWebPU", name="ExampleWebPU")
    private EntityManager em;
     public List<Gender> getAllGender() {
        try {
            Query query = em.createQuery(QUERY_GET_GENDER);
            return query.getResultList();
        } catch (Exception e) {
            return null;
        }
    }
} 
```

**性别控制器**

```
@ManagedBean
@RequestScoped
public class GenderController {
    @EJB
    private GenderManager gm;  
    public List<Gender> getAllGender() {
        return gm.getAllGender();
    }
} 
```

**持久性.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="1.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
  <persistence-unit name="ExampleWebPU" transaction-type="JTA">
    <jta-data-source>java:openejb/Resource/db1</jta-data-source>
    <non-jta-data-source>java:openejb/Resource/db1</non-jta-data-source>
    <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>
    <properties>
      <property name="openjpa.jdbc.SynchronizeMappings" value="buildSchema(foreignKeys=true" />
            <property name="openjpa.jdbc.SchemaFactory" value="native(foreignKeys=true)" />
            <property name="openjpa.jdbc.MappingDefaults"
                value="ForeignKeyDeleteAction=restrict, JoinForeignKeyDeleteAction=restrict" />
            <property name="openjpa.Log" value="DefaultLevel=TRACE,SQL=TRACE" />
    </properties>
  </persistence-unit>
</persistence> 
```

**openejb.xml**

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<Context>
  <Valve className="org.apache.catalina.valves.RemoteAddrValve" allow="127\.0\.0\.1,0:0:0:0:0:0:0:1(%.*)?" deny=""/>
   <openejb>
    <Resource id="db1" type="DataSource">
      JdbcDriver com.mysql.jdbc.Driver
      JdbcUrl jdbc:mysql://localhost:3306/example_db1
      UserName root
      Password root
      JtaManaged true
    </Resource>
    <Resource id="db2" type="DataSource">
      JdbcDriver com.mysql.jdbc.Driver
      JdbcUrl jdbc:mysql://localhost:3306/example_db2
      UserName root
      Password root
      JtaManaged true
    </Resource>
  </openejb>
</Context> 
```

我没有添加额外的代码。当`gm.getAllGender()`in行`GenderController`尝试执行时，我得到以下异常：

```
javax.el.ELException: /register.xhtml @50,119 value="#{genderController.allGender}": Error reading 'allGender' en el tipo com.example.GenderController
    at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:114)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:194)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:182)
    at javax.faces.component.UISelectItems.getValue(UISelectItems.java:129)
    at com.sun.faces.renderkit.SelectItemsIterator.initializeItems(SelectItemsIterator.java:202)
    at com.sun.faces.renderkit.SelectItemsIterator.hasNext(SelectItemsIterator.java:135)
    at com.sun.faces.renderkit.html_basic.MenuRenderer.renderOptions(MenuRenderer.java:762)
    at com.sun.faces.renderkit.html_basic.MenuRenderer.renderSelect(MenuRenderer.java:844)
    at com.sun.faces.renderkit.html_basic.MenuRenderer.encodeEnd(MenuRenderer.java:298)
    at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:875)
    at com.sun.faces.renderkit.html_basic.HtmlBasicRenderer.encodeRecursive(HtmlBasicRenderer.java:312)
    at com.sun.faces.renderkit.html_basic.GridRenderer.renderRow(GridRenderer.java:185)
    at com.sun.faces.renderkit.html_basic.GridRenderer.encodeChildren(GridRenderer.java:129)
    at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1756)
    at javax.faces.render.Renderer.encodeChildren(Renderer.java:168)
    at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1756)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1759)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1759)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:401)
    at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:131)
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:410)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.netbeans.modules.web.monitor.server.MonitorFilter.doFilter(MonitorFilter.java:393)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)
    at org.apache.coyote.http11.Http11AprProcessor.process(Http11AprProcessor.java:859)
    at org.apache.coyote.http11.Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:579)
    at org.apache.tomcat.util.net.AprEndpoint$Worker.run(AprEndpoint.java:1555)
    at java.lang.Thread.run(Thread.java:619)
Caused by: java.lang.NullPointerException
    at com.example.GenderController.getAllGender(GenderController.java:36)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at javax.el.BeanELResolver.getValue(BeanELResolver.java:62) 
```

这是如何引起的，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T19:57:22.750

不应将 EJB 类声明为 final。我想知道你是如何编译这个`GenderManager` `Stateless`类的。`final`从`GenderManager`类定义中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-23T18:25:39.407

您使用的 OpenEJB 版本已有 4 年历史。我不认为我们在 3.1 版之前添加了 JSF 支持——如果我没记错的话。

我真的建议您尝试最新版本的 Tomcat/OpenEJB 堆栈，TomEE [http://openejb.apache.org/download.html](http://openejb.apache.org/download.html)。

我们基本上采用了您正在使用的代码并完成了所有功能，并通过了 Java EE 6 TCK 并对其进行了官方认证。我们更改了名称，因为将其命名为“Tomcat/OpenEJB”对于经过认证的服务器来说有点误导。但它都是相同的开发人员和相同的代码（更好的代码版本......也许更好的开发人员版本:)。

# java - eclipse库导入jar文件问题

> ID：12044103
> 
> 赞同：0
> 
> 时间：2012-08-20T19:46:25.423
> 
> 标签：java, android, eclipse, jar

我有一个与日食相关的问题，也许有人可以帮助我。我已经从 github 下载并提取了一个库，并希望将其导入到我的应用程序中。它为您提供了两个带有该库的测试应用程序。我从 eclipse 中的现有文件系统创建新项目，但是这两个示例项目旁边有一个大的红色感叹号并且不会运行。它说它在库中找不到jar文件。当我查看库的 bin 文件夹时，那里没有 jar 文件。我真的不知道我做错了什么。我没有正确地从 github 中提取文件？我必须从库中创建自己的 jar 文件吗？我记得在我尝试使用的另一个库之前遇到过这个问题。任何帮助将非常感激！干杯，山姆。PS这是我正在尝试使用的库[https://github.com/robotmedia/AndroidBillingLibrary/](https://github.com/robotmedia/AndroidBillingLibrary/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T19:52:35.460

如果您从 github 获取库项目，则应将其设置为“isLibrary” `properties->android`，然后将其用作项目中的库，也来自`properties->android`

我希望这就是你要找的

# php - 获取此字符串的最后一个数字

> ID：12044104
> 
> 赞同：0
> 
> 时间：2012-08-20T19:46:31.950
> 
> 标签：php, regex

首先让我说我不太了解 Reg-Ex，所以我希望有人可以帮助我。

我有一个字符串，例如“/1/3”或“/1/34/2/6”，我试图在决赛之后得到最后一个数字`/`

一个朋友给我发了这个公式，但它给我的只是最后一个/

```
preg_replace('~^/([0-9]+)(/.*)?$~', '$1', $cat['path']); 
```

$cat[path] 是我得到的字符串。我应该如何改变这个给我最终的数字而不是斜线`/`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T19:49:10.540

我会在不使用正则表达式的情况下解决这个问题。

```
$parts = explode('/', $input);
$latest_one = array_pop($parts); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T19:48:19.260

你要：

```
#/(\d+)$# 
```

其中 # 是分隔符。它的意思是，

```
/      a slash,
\d+    a sequence of one or more digits,
$      then the end. 
```

括号表示您希望捕获序列。

PHP 代码将是：

```
$string = "1/12/26";

if (preg_match('#/(\d+)$#', $string, $results))
{
    $number = $results[1]; // [0] holds the whole string
    print "The last number is $number.";
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-08-20T19:59:04.260

是`$cat['path']`文件系统还是 URL 路径？PHP 已经有了处理这些的函数。

```
$cat['path'] = '/1/34/2/6';
var_dump(
    basename($cat['path']),
    pathinfo($cat['path'], PATHINFO_BASENAME)
); 
```

**有用的信息**

*   [http://php.net/basename](http://php.net/basename)
*   [http://php.net/pathinfo](http://php.net/pathinfo)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-20T19:48:53.493

```
preg_match('{/(\d)[^\d]*$}', $string, $matches);
$matches[0]; // this should be your number 
```

*   `{`and`}`是定界符——通常的定界符是`/`and`/`或`@`and`@`但如果方便，您可以选择允许您转义尽可能少的字符的定界符；
*   `/`匹配一个斜杠 - 如果我们使用`/`分隔符，我们需要用反斜杠转义这个斜杠；
*   `\d`匹配一个数字 - \d* 将匹配任意数量的数字，包括没有数字，\d+ 将匹配任意数量的数字，但至少匹配一个数字；
*   `[^\d]*`匹配任何不是数字的东西；如果您确定字符串结尾之前的最后一个字符除了数字之外绝不是其他任何东西，这可能是可选的；
*   `$`匹配字符串的结尾——这确保我们看到的是字符串的结尾；

使用分隔符的等效示例`/`：

```
preg_match('/\/(\d)[^\d]*$/', $string, $matches); 
```

# jquery - 选项卡内的垂直 jQuery 手风琴滑块

> ID：12044106
> 
> 赞同：1
> 
> 时间：2012-08-20T19:46:36.083
> 
> 标签：jquery, accordion

我有一个非常大的问题，我的一个设计基于这个插件，现在有一个市长问题。

这是插件的链接：http: [//tympanus.net/codrops/2011/07/22/vertical-sliding-accordion/](http://tympanus.net/codrops/2011/07/22/vertical-sliding-accordion/)

我的问题是我计划在切片内添加一个内容滑块，该滑块将由内部的导航元素触发，但是当我单击切片时它只会关闭所有内容，任何人都可以找到一种方法来关闭单击“va-title”？

另外，我如何在其中包含一个在单击时响应导航元素的滑块，假设在 ul 中我有一个

*   视频所以当我单击时，我将每个切片的视频内容加载到同一个 div 中？

谢谢和抱歉，如果这听起来太麻烦了。

# mysql - MySQL 查询超时

> ID：12044111
> 
> 赞同：0
> 
> 时间：2012-08-20T19:46:55.467
> 
> 标签：mysql, select, timeout

我有两个表，一个消息表和一个日志表。

我想返回消息表中已记录给用户并且其消息 # 大于传递的参数的所有行。

我所拥有的是：

```
SELECT * FROM message WHERE id IN ( SELECT msg_id AS id FROM msg_log WHERE user_num='1000' AND msg_id >='1660192') 
```

此查询不返回任何内容，不产生任何错误，只是超时......它是从 PHP 脚本还是从 phpMyAdmin 运行都没有关系。事实上，如果从 phpMyAdmin 运行，它甚至不会显示查询正在运行，但它不允许您执行另一个查询。

如果我打破`IN`选择

```
SELECT msg_id AS id FROM msg_log WHERE user_num='1000' AND msg_id >='1660192') 
```

这将返回 0 条记录（应该如此）

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T19:54:55.197

试试这个：

```
SELECT message.* FROM message 
INNER JOIN msg_log 
    ON message.id = msg_log.msg_id
   AND msg_log.user_num = '1000' 
   AND msg_logmsg_id >= '1660192' 
```

`INNER JOIN`语法应该比`IN`从句快。
自然，您可以加快查询速度

*   *message.id*为`INDEX`或`PRIMARY_KEY`
*   msg_log.id 作为`INDEX`并且可能与*message.id*相关`FOREIGN_KEY`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:53:50.417

您是否尝试过在没有 php 的情况下从 mysql 监视器执行此查询？您可能有大表，mysql 需要更多时间来执行查询，而不是 php 脚本所允许的时间。你可以试试：

1) 在 msg_log 表中的 user_num 上添加索引可以加快查询速度，

2）设置允许php执行更长的`php_max_execution_time`脚本`.htaccess`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:08:22.623

由于 MySQL 的特殊性，内连接比 IN 快。MySQL 所做的是*为它遇到的每一行*运行子查询。这对于数据库来说是不寻常的行为，但已记录在案。

加入解决了这个问题。但是，正确的等效语法需要一个不同的：

```
SELECT m.*
FROM message m join
     (select distinct msg_id
      from msg_log
      WHERE user_num='1000' AND msg_id >='1660192'
     ) ml
     on ml.msg_id = m.id 
```

如果您想避免每条消息有多行，则不同点很重要。

您还可以使用 EXISTS 子句修复它：

```
SELECT *
FROM message m
WHERE EXISTS (SELECT 1
              FROM msg_log ml
              WHERE user_num='1000' AND msg_id >='1660192' and m.id = ml.msg_id
             ) 
```

如果您更喜欢关联子查询而不是连接。

# jquery - jQuery Form Plugin - 带有文件上传的 utf-8 字符不起作用

> ID：12044112
> 
> 赞同：3
> 
> 时间：2012-08-20T19:47:00.857
> 
> 标签：jquery, content-type, jquery-forms-plugin

[在jQuery 表单插件](http://jquery.malsup.com/form/#getting-started)的帮助下，我们正在上传一个文件以及常规表单字段。一切正常。但是如果有任何 utf-8 特殊字符，那么它会被转换成一些垃圾字符服务器端。检查请求标头时，我们发现内容类型 charset=utf-8 缺失。尝试在提交时添加内容类型，但没有任何帮助。

```
 var options = {
         success:       successfunc,
         contentType: 'multipart/form-data; charset=utf-8',
 };
 $("#formid").ajaxSubmit(options); 
```

在分析 jQuery 脚本文件后我们发现

```
 var s = $.extend(true, {}, $.ajaxSettings, options, {
         contentType: false,
         processData: false,
         cache: false,
         type: 'POST'
     }); 
```

如果 jQuery 中的内容类型被更改，那么由于边界值问题，服务器代码无法获取请求参数。是否无法在单个 ajax 提交中上传文件并发送 utf-8 特殊字符？

# c# - ASP.NET 中的 Span Id 更改

> ID：12044113
> 
> 赞同：1
> 
> 时间：2012-08-20T19:47:07.333
> 
> 标签：c#, javascript, asp.net, html

`.master`我在使用服务器端的页面中有一个跨度`runat="server".`，c# 代码添加到这个跨度的 innerHtml 中。跨度为`id="tickerfade"`; 但是，当它在页面上呈现时，id 更改为`id=ctl00_tickerfade`. 为什么会发生这种情况，我该如何阻止它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T19:48:26.017

您可以将控件设置[`ClientIdMode`](http://msdn.microsoft.com/en-us/library/system.web.ui.control.clientidmode.aspx)为[`Static`](http://msdn.microsoft.com/en-us/library/system.web.ui.clientidmode.aspx).

> ClientID 值设置为 ID 属性的值。如果控件是命名容器，则该控件用作它所包含的任何控件的命名容器层次结构的顶部。

有关 ASP.NET Web 服务器控件标识的更多信息，请查看以下链接：

[http://msdn.microsoft.com/en-us/library/1d04y8ss.aspx](http://msdn.microsoft.com/en-us/library/1d04y8ss.aspx)

如果真正的问题是如何在客户端找到正确的 id，则可以使用该`ClientId`属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T07:10:07.913

之所以发生`Control`这种情况，是因为在侧面呈现的它`server`具有自动生成的客户端 ID。

如果您将使用 asp.net 开箱即用控制（`<asp:Label />`等等），您可以设置`ClientIdMode`为`Static`

如果你想在 javascript 中使用这个跨度，你可以写

`$('<%= tickerfade.ClientID %>).click(....)`

# php - PHP创建的文本没有颜色它应该有

> ID：12044115
> 
> 赞同：2
> 
> 时间：2012-08-20T19:47:08.573
> 
> 标签：php, image, colors, png

**使用imagettftext**创建的文本确实具有完全不同的颜色，因为它应该具有（主要是 insertet png 图的颜色）。为什么不上色？它必须是函数**resizePictureAndPlaceOnSign**中的某些内容，因为如果我将其注释掉，那就完美了。

```
 public function resizePictureAndPlaceOnSign($filename, $new_width,  $dst_x, $dst_y){

        // create figure in memory
        $figure = imagecreatefrompng($filename);

        /* 
            CALC RATIO
        */
        list($width, $height) = getimagesize($filename);

        $vh = ($height/$width);
        $new_height = $vh*$new_width;
        $rnd_new_height = round($new_height, 0); 
        /*  
        */

        // make the figure smaller
        imagecopyresampled($this->picture, $figure, $dst_x, $dst_y, 0, 0, $new_width, $new_height, $width, $height);

        imagedestroy($figure);

    }
    public function drawPicture()
    { 
       // $zufall = rand(1,999);

        // create picture
        $schild_leere_vorlage = imagecreatefrompng("schild_vorlage.png");
        $this->picture = imagecreate(600,192);

        // copy the image into the other image
        # int ImageCopy ( resource $dst_im , resource $src_im , int $dst_x , int $dst_y , int $src_x , int $src_y , int $src_w , int $src_h )
        imagecopy($this->picture, $schild_leere_vorlage, 0, 0, 0, 0, 600, 192);

            $filename = "figures/" . $_GET['figure'] . ".png";

            /*********************/
            $this->resizePictureAndPlaceOnSign($filename, 100, 25, 25);

        // create colors
        $color = 0x00000000FF;
        $color =  imagecolorallocate ($this->picture, 0, 0, 255);

        // create text
        imagettftext($this->picture, $this->fontSize , 0, 125, 100,$color , "cooperm.TTF", $this->name);

        // header("Content-Type: image/jpeg");

        imagepng($this->picture);

        //$this->checkFontSize();

        imagedestroy($this->picture);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:23:16.673

您正在创建调色板图像。当您在其上复制其他图像时，您正在使用所有可用颜色，因此 imagecolorallocate 失败并设置`$color`为 false。

要解决此问题，请在真彩色图像上进行合成。

```
$this->picture = imagecreatetruecolor(600,192); 
```

如果由于某种原因需要对输出进行调色板，您可以使用[`imagetruecolortopalette()`](http://www.php.net/manual/en/function.imagetruecolortopalette.php)它来转换它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T21:28:03.927

你可以试试

```
$color =  imagecolorclosest ($this->picture, 0, 0, 255); 
```

由于 mcrumley 解释的原因，你仍然不会得到*完全*纯蓝色，但它可能“足够接近”。

# c# - 检查字符串是否可以转换为另一种类型（C#）

> ID：12044117
> 
> 赞同：4
> 
> 时间：2012-08-20T19:47:13.033
> 
> 标签：c#, types, enums

我正在用 C# 做一些测试，现在我需要知道一些事情。我创建了一个类，如下所示：

```
class DChanger
{
    //Just ignore this:
    private string section = Csuc.CPanel.CPanelSection.Appearance;
    //Then the constructor: DChanger dchange = new DChanger(Internet);
    public void DChanger(string subsection)
    {
        //Code
    }
} 
```

所以，现在。我想检查“小节”是否可以转换为另一种类型。例如，我有一个枚举：

```
enum Subsections { Internet, Programming }; 
```

我想检查“subsection”是“Internet”还是“Programming”（在这个例子中，因为真正的枚举有很多更多的部分）。我可以这样做吗？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-20T19:51:32.947

您可以使用 Enum.Parse 并观察 ArgumentException 类型的异常。您也可以使用 Enum.TryParse。

更多信息在这里[http://msdn.microsoft.com/en-us/library/essfb559.aspx](http://msdn.microsoft.com/en-us/library/essfb559.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:08:29.750

要快速测试，最好使用 Enum 类进行测试：

```
public void DChanger(string subsection)
    {
       bool b = Enum.GetNames(typeof(Subsections)).Contains(subsection);
    } 
```

# ssrs-2008 - SSRS 2008 R2 - LookupSet 表达式的条件格式

> ID：12044119
> 
> 赞同：0
> 
> 时间：2012-08-20T19:47:16.210
> 
> 标签：ssrs-2008, lookup, conditional-formatting

我有一个使用 LookupSet 表达式生成的字段，该表达式返回一个数组以适应返回多个值的可能性。看起来像这样：=Join(LookupSet(Fields!ENTITYUID.Value,Fields!FACILITYID.Value,Fields!TLID.Value, "TielineView"), VBCRLF + "")

如果返回的某些值与指定列表匹配，则需要对它们进行条件格式设置。是否可以破解这个数组并对每个值执行条件格式化表达式？

提前致谢， DP

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T01:30:58.973

您能否对作为 Reportitems!whatever.value 的查找返回的值使用条件格式？

例如 =iif(reportitems!whatever.value = 0,"Red","Black")

# python - 将程序安装到 Program Files 时使用 pywin32

> ID：12044124
> 
> 赞同：2
> 
> 时间：2012-08-20T19:47:23.867
> 
> 标签：python, py2exe, pywin32, program-files

我正在尝试为使用 pywin32 绑定编辑一些 excel 电子表格的程序创建安装程序。我已经使用 py2exe 创建了一个可执行文件，并且在从桌面上的文件夹中运行可执行文件时一切正常。但是，我希望能够分发一个安装程序文件，它将程序安装到 C:\Program Files\ 或任何系统上的等效文件夹中。我也成功了，但是，当使用 pywin32 绑定时，无论工作目录在哪里，它们都会创建临时文件。

这是非常有问题的，因为较新版本的 Windows 已经做到了，因此只有管理员有权写入这些目录。因此，当应用程序从这些目录运行时，它会失败并出现以下错误：

```
WindowsError: [Error 5] Access is denied: 'C:\\Program Files (x86)\\DataPlotter\\.\\win32com\\gen_py\
\00020813-0000-0000-C000-000000000046x0x1x6' 
```

将应用程序更改为以管理员权限运行是一个糟糕的解决方案，因为它可能会引入漏洞。

是否有人知道此问题的修复方法或如何更改 pywin32 绑定用作临时文件位置的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T17:19:40.730

`contextlib.contextmanager`如果您希望在发生未处理的异常时恢复先前的当前目录，我在对您的回答的评论中描述的关于如何使用装饰器将代码转换为上下文管理器的方式稍微过于简单化了。要做到这一点，还需要在周围添加一个`try`...`finally`子句`yield`（见下文）。

另外，我认为将它作为一个独立的函数而不是某个类的方法以及将要切换到的目录作为参数传递给它会更好——这两者都使它更通用且易于重用。我之所以称它为它`pushd()`是因为它与 Windows 和 Unix 的同名 shell 命令有[相似之处。](http://en.wikipedia.org/wiki/Pushd_and_popd)

```
from contextlib import contextmanager
import os
import tempfile

@contextmanager
def pushd(dir=None):
    """ Context manager which saves the current working directory before
        changing either to the one passed or the default folder for temporary
        files and then restores the former after the controlled suite of
        statements have executed. This will happened even if an unhandled
        exception occurs within the block. """
    cwd = os.getcwd()
    os.chdir(dir if dir is not None else tempfile.gettempdir())
    try:
        yield
    finally:
        os.chdir(cwd)

# sample usage

with pushd():
    self.xl = win32com.client.gencache.EnsureDispatch("Excel.Application") 
```

做 a 而不是什么都不做也可能很有用，`yield cwd`这将允许任何可选`as`变量接收一个指示先前当前工作目录的值，以便在块内进行可能的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:12:38.183

这是一个愚蠢的 hack-y 解决方案，但可以通过在 pywin32 上运行来避免这个问题。

通过将当前工作目录切换到可以安全写入的目录，例如临时目录，可以避免该问题。

```
#Save the current working directory and then switch back once
#excel has been started. This is so pywin32 does not ruin everything
#by trying to write in the current directory without the proper 
#permission. This mainly happens (for me) when the program is installed in 
#program files which requires administrator permissions to write to.

import os
import tempfile
import win32com.client

cwd = os.getcwd()
tdir =  tempfile.gettempdir()
os.chdir(tdir)
self.xl = win32com.client.gencache.EnsureDispatch("Excel.Application") 
os.chdir(cwd) 
```

注意最后切换回原始工作目录不是必需的，但如果您需要它会起作用（就像我一样）。

martineau 在下面使用上下文管理器提出了一种更强大的方法：

```
from contextlib import contextmanager

@contextmanager
def tempManager(self):
    cwd = os.getcwd()
    tdir =  tempfile.gettempdir()
    os.chdir(tdir)
    yield
    os.chdir(cwd)

with self.tempManager():
    self.xl = win32com.client.gencache.EnsureDispatch("Excel.Application") 
```

# javascript - 如何使用 jQuery 从两个不同的元素启动函数

> ID：12044129
> 
> 赞同：0
> 
> 时间：2012-08-20T19:47:52.590
> 
> 标签：javascript, jquery, fadein

我有一个动作开始元素，单击此元素后开始 `.oven_program_01`的类面板。`.oven_panel`

我有另一个元素`.back_button`可以关闭此面板。

当我再次打开面板时，我无法关闭它。显示不变。

这是我的脚本：

开场动作：

```
$('.oven_program_01').live('click', function() {
    $('.back_button').addClass('oven_panel_close_button');
    $('.oven_panel').fadeIn(300);
});​ 
```

关闭动作：

```
$('.back_button').click(function() {
    if ($(this).hasClass("oven_panel_close_button")) {
        $('.oven_panel').fadeOut(300);
        $('.back_button').removeClass("oven_panel_close_button")
    }
    else {
        $(this).addClass("oven_panel_close_button")
    }
});​ 
```

# ruby - Ruby Kernel::system，shell 命令中的否定模式未按预期工作

> ID：12044130
> 
> 赞同：2
> 
> 时间：2012-08-20T19:47:57.427
> 
> 标签：ruby, bash, ubuntu, pattern-matching

以下 bash 命令从名为`foo`(excludes `.`and `..`) 的目录中删除所有隐藏文件：

```
rm -rf foo/.[^.]* 
```

我希望将相同的命令传递给 Ruby`Kernel::system`应该做同样的事情：

```
system("rm -rf foo/.[^.]*") 
```

但是，上面的 Ruby 代码会返回`false`并生成：

```
rm: cannot remove `..' directory `foo/..' 
```

* * *

如果我这样尝试：

```
system("rm", "-rf", "foo/.[^.]*") 
```

然后它返回`true`，但不删除任何内容。

* * *

如果我取消`-f`旗帜：

```
system("rm", "-r", "foo/.[^.]*") 
```

然后它返回`false`并产生这个：

```
rm: cannot remove `foo/.[^.]*': No such file or directory 
```

* * *

我想知道这个`system`调用是否将否定模式评估`[^.]`为文字字符或其他东西。我不确定问题是什么。

任何见解或建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:16:24.360

该`system`命令将单个字符串参数传递给`/bin/sh`用于处理（不是`/bin/bash`）。我找不到明确的引用，但它似乎`[^.]`是两个文字字符，^ 和 .，在`sh`. 试试`[!.]`吧。

在您的第二个和第三个示例中，“system”的参数直接传递给`exec`，而不是由 shell 处理，因此模式（*不是*正则表达式，顺便说一句）不会被扩展。第二，`-f`让它忽略没有文件“foo/.[^.]*”要删除的事实；第三，错误没有被抑制。

# windows-phone-7 - windows phone 上的视频流给出“3100 发生错误”

> ID：12044133
> 
> 赞同：3
> 
> 时间：2012-08-20T19:48:05.563
> 
> 标签：windows-phone-7, streaming, h.264

初始数据：

*   windows phone 7.1 应用程序；
*   视频流（视频：MPEG-4 AVC（第 10 部分）（H.264）；音频：MPEG AAC 音频（mp4a））；
*   不是流畅的流媒体；
*   在 VLC 中打开时出现任何问题；
*   包括所有功能（ID_CAP_MEDIALIB、ID_CAP_MICROPHONE、ID_CAP_NETWORKING 和其他）。

我正在使用 MediaElement 打开带有自定义 http url 的视频流：

```
media.Source = new Uri("streaming url");
media.DownloadProgressChanged += this.media_DownloadProgressChanged;
media.MediaFailed += this.media_MediaFailed;
media.MediaEnded += this.media_MediaEnded;
media.Play(); 
```

MediaFailed 给出“3100 发生错误”错误，没有任何附加说明。

似乎[支持列出的编解码器](http://www.wpcentral.com/windows-phone-7-audio-media-codecs)。

我也试过这段代码：

```
var mediaPlayerLauncher = new MediaPlayerLauncher
{
   Location = MediaLocationType.Install,
   Media = new Uri("streaming url", UriKind.Absolute),
   Controls = MediaPlaybackControls.All,
};
mediaPlayerLauncher.Show(); 
```

但媒体播放器无法播放视频。

什么会导致问题？如何测试视频流是否兼容Windows Phone？

提前致谢。

# joomla - 非营利内容管理系统

> ID：12044134
> 
> 赞同：4
> 
> 时间：2012-08-20T19:48:16.927
> 
> 标签：joomla, content-management-system, umbraco

我需要为非营利组织创建一个网站，该网站需要以下功能以及基本的页面编辑和创建（希望是免费的解决方案） - 时事通讯 - 事件列表 + 与 Google 日历的集成 - 可能与 guestlistapp 等系统集成以收集活动门票付款 - 会员管理系统 + 收款 - 贝宝捐赠

我看过 Umbraco，但似乎没有任何这些插件。请建议您过去可能使用过的其他系统，这些系统可能非常适合这种情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T19:58:30.980

Umbraco 并没有随这些插件开箱即用，但有一些“包”可用于其中的一些事情，并且通过一些自定义代码它可以完成所有这些事情 -

例如，这是一个时事通讯插件： http: [//our.umbraco.org/projects/website-utilities/newsletter](http://our.umbraco.org/projects/website-utilities/newsletter)

会员插件： http: [//our.umbraco.org/projects/website-utilities/membership-system](http://our.umbraco.org/projects/website-utilities/membership-system)

贝宝插件： http: [//our.umbraco.org/projects/paypal-ipn](http://our.umbraco.org/projects/paypal-ipn)

活动日历： http: [//our.umbraco.org/projects/website-utilities/pdcalendar](http://our.umbraco.org/projects/website-utilities/pdcalendar)

然而，底线是，对于所有这些软件包，它不仅仅是一个简单的安装并提供给客户，它们可能需要您进行定制，因此您的客户可能会更好地使用现成的非营利管理软件包如果这就是你要找的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T20:02:05.343

会为此推荐 Joomla 2.5.6。

JomSocial 有一个带有付费会员系统的套餐，价格为 268 美元。除了会员系统，我假设您知道 JomSocial 是一个非常大的扩展，并且使用正确的附加组件，将能够执行许多任务。看看这里：

[http://www.jomsocial.com/package/](http://www.jomsocial.com/package/)

付费会员的免费解决方案可能是[Akeeba 订阅](http://extensions.joomla.org/extensions/e-commerce/membership-a-subscriptions/19528?qh=YToxOntpOjA7czo2OiJha2VlYmEiO30=)，它是一个非常灵活的组件，并与许多其他扩展集成。

对于捐款，请在此处查看 JED 上的类别：

[http://extensions.joomla.org/extensions/e-commerce/donations](http://extensions.joomla.org/extensions/e-commerce/donations)

对于事件和新闻信件，我可能会推荐使用免费的[JEvents](http://extensions.joomla.org/extensions/calendars-a-events/events/events-calendars/95?qh=YToyOntpOjA7czo3OiJqZXZlbnRzIjtpOjE7czo5OiJqZXZlbnRzJ3MiO30=)和 [JNews](http://extensions.joomla.org/extensions/content-sharing/newsletter/11585?qh=YToyOntpOjA7czoxMDoibmV3c2xldHRlciI7aToxO3M6MTE6Im5ld3NsZXR0ZXJzIjt9)。

至于谷歌日历，请查看[GCalendar](http://extensions.joomla.org/extensions/calendars-a-events/events/events-calendars/1625)，它也是免费的。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T22:42:11.667

我建议您查看每年 11 月发布的“开源 cms 市场份额报告”，它对于确定哪些 CMS 占主导地位、哪些正在增长以及哪些正在衰退非常有用。例如，Joomla 是一个占主导地位的玩家，Umbraco 是一个成长中的玩家。

[2011 年开源 cms 市场份额报告](http://www.waterandstone.com/book/2011-open-source-cms-market-share-report)

> 2011 年开源 CMS 市场份额报告得出的结论是，三个品牌 - Joomla!、WordPress 和 Drupal - 主导着当今的市场。该报告得出的结论是，在经历了强劲的一年之后，WordPress 在品牌实力和市场份额方面处于领先地位。
> 
> 该报告跟踪了 20 个顶级系统的市场份额和品牌实力指标，并根据各种措施对每个系统进行了评估。该研究的重点是确定市场领导者，包括采用率和思想份额。
> 
> 而 WordPress，Joomla！和 Drupal 领导的调查涵盖了广泛的措施，该报告还确定了今年开源 CMS 市场的其他趋势。
> 
> ** DotNetNuke 继续引领 .NET CMS 竞赛，尽管 Umbraco 显示出实力。
> 
> ** Liferay 和 Alfresco 在 Java CMS 竞赛中并驾齐驱。
> 
> ** Concrete5 转弯在一个特殊的年份。

[2010 年开源 cms 市场份额报告](http://www.waterandstone.com/book/2010-open-source-cms-market-share-report)

# c++ - C ++将精度提高到双精度以上

> ID：12044145
> 
> 赞同：0
> 
> 时间：2012-08-20T19:49:02.850
> 
> 标签：c++, precision, pi, floating-point-precision

> **可能重复：**
> [是否有与 Java 的 BigDecimal 等效的 C++？](https://stackoverflow.com/questions/4798777/is-there-a-c-equivalent-to-javas-bigdecimal)

我最近发布了关于我正在制作的一个 C++ Pi 近似程序。你可以在这里找到代码：[C++ Pi approximation program](https://stackoverflow.com/questions/12040851/c-pi-approximation-program)但代码本身并不真正相关。只知道我需要做算术，包括所涉及数字的幂。

现在程序运行良好，但我在徘徊是否有可能以某种方式（可能使用自定义数据类型）将精度提高到 double 提供的微不足道的 15 位小数，因为程序可以在更少的时间内将 Pi 精确到小数点后 15 位超过一秒。

任何帮助表示赞赏。

# android - 第一次调用 Syncadapter onPerformSync 两次

> ID：12044152
> 
> 赞同：9
> 
> 时间：2012-08-20T19:49:27.013
> 
> 标签：android, android-syncadapter

我的同步适配器运行良好，除了一件事。用户安装应用程序后，我的应用程序会同步两次。稍后，如果我在“设置”中手动同步它，它只会按预期同步一次。这只是发生这种情况的应用程序的第一次运行。

这是我的“onCreate”中的代码，如果尚未创建帐户，则创建帐户并设置同步适配器。关于我做错了什么的任何想法？

```
 if (accountManager.addAccountExplicitly(appAccount, null, null)) {
       ContentResolver.setIsSyncable(appAccount, PROVIDER, 1);
       ContentResolver.setSyncAutomatically(appAccount, PROVIDER, true);

       Bundle extras = new Bundle();
       extras.putBoolean("dummy stuff", true);
       ContentResolver.addPeriodicSync(appAccount, PROVIDER, extras, 43200);
    } 
```

我想要的行为是让应用程序在安装后立即同步一次，然后根据“addPeriodicSync”语句定期同步。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-01-14T10:14:42.093

我也观察到了这种行为。

正确的是， addAccountExplicit() 将触发系统范围内的过期帐户重新同步。

### 澄清

但是，Zapek 关于 addPeriodic 同步或请求同步是“立即”同步的观察并不完全正确。两者都只是排队。此外，对于 addPeriodicSync()，以下内容成立：

> 这些定期同步遵循“syncAutomatically”和“masterSyncAutomatically”设置。尽管这些同步是按指定的频率安排的，但如果同步操作队列中其他同步在它之前，它可能需要更长的时间才能真正启动。这意味着实际开始时间可能会漂移。（[文档](https://developer.android.com/reference/android/content/ContentResolver.html#addPeriodicSync%28android.accounts.Account,%20java.lang.String,%20android.os.Bundle,%20long%29)）

### 与您的问题有关

在运行同步适配器的培训中描述了您的体验：

> addPeriodicSync() 方法不会禁用 setSyncAutomatically()，因此您可能会在相对较短的时间内获得多次同步运行。此外，在对 addPeriodicSync() 的调用中只允许使用少数同步适配器控制标志；addPeriodicSync() 的参考文档中描述了不允许的标志。 [Android 训练同步适配器](https://developer.android.com/training/sync-adapters/running-sync-adapter.html)

谷歌自己的解决方案看起来像你的，甚至频率更低（60*60=3600）：

```
 if (accountManager.addAccountExplicitly(account, null, null)) {
        // Inform the system that this account supports sync
        ContentResolver.setIsSyncable(account, CONTENT_AUTHORITY, 1);
        // Inform the system that this account is eligible for auto sync when the network is up
        ContentResolver.setSyncAutomatically(account, CONTENT_AUTHORITY, true);
        // Recommend a schedule for automatic synchronization. The system may modify this based
        // on other scheduled syncs and network utilization.
        ContentResolver.addPeriodicSync(
                account, CONTENT_AUTHORITY, new Bundle(),SYNC_FREQUENCY);
        newAccount = true;
    } 
```

### 主张

我建议使用 onPerformSync() 中的 SyncStats 将有关初始同步的一些信息实际返回到系统，以便更有效地进行调度。

```
syncResult.stats.numEntries++; // For every dataset 
```

如果已经安排了其他任务，这可能无济于事 - 调查

此外，可以设置一个标志“isInitialOnPerformSync”（w.sharedPreferences），以使其他任务备份。

```
syncResult.delayUntil = <time>; 
```

我个人不太喜欢在初始同步后创建固定的不同步时间范围。

### 进一步考虑 - 立即初始同步

如说明中所述，同步不会立即使用您的设置运行。有一个解决方案，可以让您立即同步。这不会影响同步设置，也不会导致它们回退，这就是为什么这不能解决您的问题，但它的效果是您的用户不必等待同步启动。如果您使用此功能很重要以这种方式在您的应用中显示主要内容。

代码：在您的正常应用程序进程中为*isInitialSync*设置一个标志（例如保存在 defaultSharedPreferences 中）。您甚至可以使用在初始完成安装或登录（如果需要身份验证）后，您可以调用立即同步，如下所示。

```
/**
 * Start an asynchronous sync operation immediately. </br>
 *
 * @param account
 */
public static void requestSyncImmediately(Account account) {
     // Disable sync backoff and ignore sync preferences. In other words...perform sync NOW!
    Bundle settingsBundle = new Bundle();
    settingsBundle.putBoolean(ContentResolver.SYNC_EXTRAS_MANUAL, true);
    settingsBundle.putBoolean(ContentResolver.SYNC_EXTRAS_EXPEDITED, true);
    // Request sync with settings
    ContentResolver.requestSync(account, SyncConstants.CONTENT_AUTHORITY, settingsBundle);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-28T18:46:24.993

除了 addPeriodicSync() 之外，您还请求同步吗？

首次添加帐户时，它应该自行同步。因此，任何额外的同步请求都会导致双重同步。

如果这没有帮助，您始终可以将上次同步的时间保存在首选项中，并检查每次同步的时间，以便您可以将同步频率限制为您想要的任何时间。

希望有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-26T09:58:35.383

addAccountExplicitely()**将**导致**所有**具有未知可同步状态的帐户同步（包括您新添加的 SyncAdapter）。

问题是执行可能需要几秒钟到几分钟的时间，具体取决于安装了多少具有 SyncAdapter 和已配置帐户的其他应用程序。

addPeriodicSync()（或 requestSync()）将立即执行同步，这在用户需要在启动应用程序时尽快查看数据的情况下是可取的。

除了确保在客户端和服务器之间没有数据更改的情况下优化同步以快速进行之外，您无能为力。

# android - 片段事务添加/分离和操作栏选项卡

> ID：12044153
> 
> 赞同：1
> 
> 时间：2012-08-20T19:49:28.830
> 
> 标签：android, android-actionbar

我正在使用操作栏选项卡来显示不同类别下的一些图像。例如：有三个选项卡：-cat1、cat2、cat3。所有三个选项卡都在网格视图中显示图像。选项卡侦听器类如下所示：-

```
@Override
    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        switch(id){
        case 1:{
            this.tagName="cat1";

            Cat1 genf=(Cat1)= getFragmentManager().findFragmentByTag(this.tagName);
            if(genf==null){
               genf=Cat1.newInstance();
               ft.add(R.id.therightframe,genf,tagName);
             }else{
               ft.attach(genf);
            }

            this.fragment=genf;
            break;
        }
        case 2:{
            this.tagName="cat2";
             Cat2 genf= (Cat2) getFragmentManager().findFragmentByTag(this.tagName);
             if(genf==null){
                 genf=Cat2.newInstance();
                 ft.add(R.id.therightframe,genf,tagName);

            }else{

              ft.attach(genf);

            }
             this.fragment=genf;
             break;
        }
        case 3:{
            this.tagName="Cat3";
            Cat3 genf= (Cat3) getFragmentManager().findFragmentByTag(this.tagName);
             if(genf==null){
             genf=Cat3.newInstance();

                    ft.add(R.id.therightframe,genf,tagName);

            }else{

                    ft.attach(genf);

            }
             this.fragment=genf;
             break;
        }

    }

    @Override
    public void onTabUnselected(Tab tab, FragmentTransaction ft) {

    ft.detach(fragment);

    } 
```

现在，如果有人单击 gridview 上的任何图像，我会执行 fragmenttransaction.replace 并在同一空间中加载新的 Fragment。是的，我不会开始新的活动。直到这一切正常。但是当我在此之后选择 Cat2 选项卡时，它不会替换在上一步中创建的片段（当单击网格中的图像时），这似乎也很自然，因为在选项卡侦听器类中我无处清空 ui，我只是添加和分离。这怎么能解决。我不想在选项卡侦听器中使用替换，因为如果这样做，我将不得不重新创建那些将是代价高昂的片段

# java - 类的 getter/setter 方法和单例模式中的 Java 细粒度同步

> ID：12044154
> 
> 赞同：0
> 
> 时间：2012-08-20T19:49:29.853
> 
> 标签：java, synchronization, locking, singleton

我正在尝试使用`synchronization`java 指令在类中实现细粒度同步，即同步尽可能少的代码。我将内联注释代码，以解释我所做的事情，在代码之后我会问你如何改进代码：

```
public class MyClass {
    private static volatile MyClass singletonInstance = null;

    private HashMap<String, Integer> mHashMap = null;
    private String mStringA = null;
    private String mStringB = null;

     // Use double check technique to use synchronization only 
     // at the first getInstance() invocation
    public static MyClass getInstance() {
        if (singletonInstance == null) {
            synchronized (MyClass.class) {
                if (singletonInstance == null)
                    singletonInstance = new MyClass();
                    // Initialize class member variables
                    singletonInstance.mHashMap = new HashMap<String,Integer>();
                    singletonInstance.mStringA = new String();
                    singletonInstance.mStringB = new String();
            }

        }
        return singletonInstance;
    }

    // The following two methods manipulate the HashMap mHashMap
    // in a secure way since they lock the mHashMap instance which
    // is always the same and is unique
    public Integer getIntegerFromHashmap(String key) {
        synchronized (mHashMap) {
            return mHashMap.get(key);
        }
    }

    public void setIntegerIntoHashmap(String key, Integer value) {
        synchronized (mHashMap) {
            mHashMap.put(key, value);
        }
    }

    // With the two String members mStringA and mStringB the problem is 
    // that the instance of String pointed by the member is varied by the 
    // setter methods, so we can not lock in a fine grained way and we
    // must lock on the singletonInstance.
    public String getStringA() {
        synchronized (singletonInstance) {
            return mStringA;
        }
    }

    public String getStringB() {
        synchronized (singletonInstance) {
            return mStringB;
        }
    }

    public void setStringA(String newString) {
        synchronized (singletonInstance) {
            mStringA = newString;
        }
    }

    public void setStringB(String newString) {
        synchronized (singletonInstance) {
            mStringB = newString;
        }
    }
} 
```

我不喜欢这两个`String`成员变量的 getter 和 setter 方法的是，锁定`singletonInstance`会使试图访问`mStringB`的线程等待，直到正在操作的线程`mStringA`释放其锁定。在这种情况下你会怎么做？你会创建两个像`private final Integer mStringALock = new Integer(0)` and `private final Integer mStringBLock = new Integer(0)`in这样的成员变量，并分别在`MyClass`and 的 getter 和 setter 方法的同步块中使用它们吗？`mStringA``mStringB`

如果您对如何改进上述代码以及成员变量的细粒度同步的建议变体有一些想法`String`，欢迎您:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:20:10.470

通常更简单的解决方案更容易实施。我还将使用 2004 年添加的并发库。

这不需要显式锁定，并且每个容器都是线程安全的。

您可以使用 AtomicReference，但在这种情况下，它不会给您任何 volatile 尚未给您的东西。（正如 kdgregory 指出的那样）您可能会在更复杂的情况下使用 AtomicReference。

```
public enum MyClass {
    INSTANCE;

    private final Map<String, Integer> mHashMap = new ConcurrentHashMap<String, Integer>();
    private volatile String mStringA = null;
    private volatile String mStringB = null;

    // The following two methods manipulate the HashMap mHashMap
    // in a secure way
    public Integer getIntegerFromHashmap(String key) {
        return mHashMap.get(key);
    }

    public void setIntegerIntoHashmap(String key, Integer value) {
        mHashMap.put(key, value);
    }

    public String getStringA() {
        return mStringA;
    }

    public String getStringB() {
        return mStringB;
    }

    public void setStringA(String newString) {
        mStringA = newString;
    }

    public void setStringB(String newString) {
        mStringB = newString;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:59:34.293

是的，如果您希望线程能够同时调用这两个方法，则需要两个单独的锁。我会说没有什么可以改进的。

但是，我注意到您的`getInstance()`方法试图最小化要同步的块的大小，但实际上您并没有做到这一点，即您也检查`singletonInstance == null`了同步块的内部。所以，我认为最好用`synchronized`.

它缩短了该方法的代码，也使它更自然一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:00:43.273

从哪里开始...

好的，双重检查锁定：它坏了（仍然），不要使用它。如果你觉得你必须使用单例（实际上，它们通常是个坏主意，请改用依赖注入），然后同步 getter 方法，并快速返回。在这种情况下，有争议的同步的可能性非常低，除非您拥有真正大量的内核（如数千个）并且不断调用 getter 方法。

将 替换`HashMap`为`ConcurrentHashMap`。Doug Lea 在并发编码方面比你我都好。

将字符串变量标记为 volatile 并且不要同步它们。

# javascript - 为什么 window.onerror 在 IE9 中无法捕获堆栈溢出错误？

> ID：12044155
> 
> 赞同：9
> 
> 时间：2012-08-20T19:49:32.390
> 
> 标签：javascript, error-handling, internet-explorer-9, stack-overflow

我`window.onerror`用来捕获和记录客户端错误。我已经阅读了有关这种方法的各种警告，但我无法找到有关此特定案例的任何信息。

由于某种原因，IE9 似乎没有捕获堆栈溢出异常。下面的示例在 Chrome 和 Firefox 中运行以及我在 IE9 中使用 devtools 并将浏览器模式设置为 IE8 或 IE7 时捕获了这两个错误。但是，在 IE9 模式下运行时，它只捕获`'test' is undefined`异常，而忽略堆栈溢出异常。

我整理了一个简单的例子来证明这一点：

```
window.onerror = errorHandler;

function errorHandler (msg) {
    alert(msg);        
}

setTimeout(function () {
    test.test = "test";
}, 1000);

setTimeout(function stackoverflow() {
    stackoverflow();
}, 2000);
​ 
```

这也是一个工作示例：http: [//jsfiddle.net/Mzvbk/1/](http://jsfiddle.net/Mzvbk/1/)

任何人都可以解释为什么会这样吗？

**2012 年 8 月 29 日更新**

[我也在Internet Explorer 开发人员中心](http://social.msdn.microsoft.com/Forums/en-US/iewebdevelopment/thread/bf3cf56b-b5cd-4985-ad61-534f8b2a8b9f)发布了这个问题，但到目前为止它并没有给我太多帮助。

在这一点上，最好的猜测（正如@RyanKinal 在他的评论中所建议的那样）是，由于超出了调用堆栈大小，因此没有空间将调用错误处理程序放在堆栈上。

我仍然愿意相信错误处理是与普通堆栈分开处理的，因为它似乎在其他浏览器（甚至是旧版本的 IE）中，但如果不是这种情况，很高兴看到参考，错误报告或某种声明，表明这实际上是 IE9 的情况。

**2012 年 9 月 5 日更新**

正如 Ren 和 Vega 在他们的评论中所描述的，Firefox 15 有时（似乎是随机的）似乎也吞下了这个例外。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-04T10:04:40.397

您是否尝试过在浏览器上禁用脚本调试？

> 当他们的 onerror 处理程序没有被调用时，会出现一个困扰许多开发人员的常见问题，因为他们为 Internet Explorer 启用了脚本调试。如果您安装了 Microsoft Script Debugger 或 Microsoft Visual Studio 6.0®（特别是 Visual InterDev 6.0™），则默认情况下会出现这种情况——错误处理是这些产品启动调试器的方式。

[来源](http://msdn.microsoft.com/en-us/library/ms976144.aspx)（包括有关如何禁用它的详细信息）。

* * *

跟进评论的其他信息：

然后我想知道它是否与此有关：

> Internet Explorer 9 使用 Visual Studio 2010 提供的新 C++ 编译器进行编译。此编译器包含一个称为增强型 GS （又称堆栈缓冲区溢出检测）的功能，它通过检测堆栈损坏并在遇到此类损坏时**避免** 执行来帮助防止堆栈缓冲区溢出。

（[来源](http://blogs.msdn.com/b/ie/archive/2011/03/07/internet-explorer-9-security-part-1-enhanced-memory-protections.aspx)）

听起来它可能是作为一种保护机制在溢出之前停止？

# putty - 腻子定制 - 不同会话的不同图标？

> ID：12044157
> 
> 赞同：5
> 
> 时间：2012-08-20T19:49:37.833
> 
> 标签：putty

我正在寻找自定义我的腻子会话，以便我可以根据腻子会话所在的“组”更改图标。我基本上希望我的任务栏（Windows 7）为我定义的每个组都有一个图标，但每个那些图标是不同的。有没有好的工具或方法来做到这一点？非常感谢您的任何回复！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-21T11:30:44.007

我是手动完成的。

1.  在桌面创建putty的快捷方式
2.  在右键单击属性中编辑“目标：”行（添加`-load <session name>`）
3.  按更改图标并选择您的图标 -

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-10T13:04:52.963

我使用 PuTTYTray：[https ://puttytray.goeswhere.com/](https://puttytray.goeswhere.com/)

它允许您在配置中选择图标： *窗口-行为-调整图标*。然后只需保存会话。

作为一个小烦恼，你没有太多的图标选项，因为它使用 .ico 格式。因此，我保留了原始程序 PUTTY.EXE 的副本，只是为了从那里捕获原始图标。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-05T12:52:20.440

我为 PuTTy 做了一个补丁，它允许您为窗口/会话指定自定义任务栏图标（而不是作为会话快捷方式的任务栏图标）。即，如果您有多个活动会话，则可以在任务栏中通过其自己的图标识别每个会话。下面的链接包含补丁（非常小）和带有补丁的预构建可执行文件（针对相当旧版本的 PuTTy）。

[http://www.bradgoodman.com/puttypatch.html](http://www.bradgoodman.com/puttypatch.html)

# javascript - Javascript意外令牌{

> ID：12044161
> 
> 赞同：-4
> 
> 时间：2012-08-20T19:49:51.413
> 
> 标签：javascript

我在这一行得到一个 Unexpected token { 错误

```
var isSplash =true;
//------DocReady-------------
--->    $(document).ready{(function()};
 if(location.hash.length == 0)
    location.hash="!/"+$('#content > ul > li').eq(2).attr('id'); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T19:50:58.340

您不需要将对象传递给准备就绪（或尝试传递它）

你有这个

```
 $(document).ready{(function()}; 
```

你需要这个

```
 $(document).ready(function() { }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:51:39.377

尝试这个...

```
var isSplash = true;
$(document).ready(function(){
 if(location.hash.length === 0) {
    location.hash="!/"+$('#content > ul > li').eq(2).attr('id');
 }
}); 
```

# android - Android adb 在 VMWare Workstation 中的 Ubuntu 上不起作用

> ID：12044162
> 
> 赞同：0
> 
> 时间：2012-08-20T19:49:53.223
> 
> 标签：android, ubuntu, adb, offline, vmware-workstation

我的主机运行 Ubuntu 12.04 64bit。在主机上`adb`工作正常。但在 VM（Ubuntu 12.04 32bit / VMWare Workstation 8.0.4）`adb`中显示没有设备或设备脱机。从`adb`as开始`root`没有帮助。lsusb 显示设备：

```
Bus 001 Device 004: ID 18d1:4e12 Google Inc. Nexus One (debug) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-24T01:44:39.803

您不会同时在主机 + 来宾中看到该设备，一次只能看到一个。例如，如果您连接一个普通的 USB 驱动器，您可以让主人使用它，也可以让其中一位客人使用它，但不能同时使用两者。通常，如果其中一个来宾 VM 在您插入时具有焦点（例如，当您单击它、键入时等），则连接的设备会转到来宾并且无法从主机访问。它会在主机上显示为连接的设备，但不能直接使用。在您的情况下，情况正好相反。所以...

如果它已在主机中连接并检测到，但在来宾中未检测到，请转到指示为“Google Nexus...”的设备下的`VM`菜单 --> --> 选择。`Removable Devices``Connect (Disconnect from Host)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T05:31:00.653

我的系统上也有这个问题。原来我的电脑上有 USB 3.0 和 USB 2.0 端口。只有 USB 2.0 端口可以工作。幸运的是，我的新系统有其中之一。

不确定它是否会对这种情况有所帮助，但值得研究。

顺便说一句，VMWare Workstation 9 支持 USB 3.0，但是当我插入主机上的 USB 3.0 端口时，它仍然无法识别 USB 2.0 设备，例如我的 HTC 手机。

# java - 窗户管挂

> ID：12044164
> 
> 赞同：2
> 
> 时间：2012-08-20T19:49:56.020
> 
> 标签：java, windows, pipe

这是一个令人沮丧的问题。我正在运行以下 Java 代码：

```
 try {
            String query = someQuery, input = someInput;
            ProcessBuilder pb = new ProcessBuilder("cmd", "/c", query); // Windows
            Process p = pb.start();

            BufferedReader stdInput = new BufferedReader(new InputStreamReader(p.getInputStream()));

            BufferedReader stdError = new BufferedReader(new InputStreamReader(p.getErrorStream()));

            try
            {
                // Input to the query
                OutputStream os = p.getOutputStream();
                os.write(input.getBytes());
                os.flush();
                os.close();
            } catch (IOException e)
            {
            }

            System.out.println("STDIN : \n");

            while ((s = stdInput.readLine()) != null)
            {
                System.out.println(s);
            }

            System.exit(0);
        } catch (IOException e)
        {
            e.printStackTrace();
        } 
```

`query`是一个管道命令。其中的每个子命令`query`都是一个类 unix 的 API 调用（专有的：Sirsi Unicorn API，如果有人感兴趣的话）；它也是一个数据库调用。Windows 命令提示符可以容纳这些 API 调用。

**问题：**

如果我尝试通过管道传输 2 个数据库命令，程序会成功运行，但如果我通过管道传输 3 个数据库命令，程序就会挂起。如果在 cygwin 上运行这些相同的命令，则程序可以正常工作。有趣的是，如果我将 3 管道命令分成两个单独的命令，程序运行良好。

**问题：**

我的问题是 - Windows 命令行上是否存在管道缓冲区问题？是否有窗户上的管道不起作用的情况？管道可以超时吗？

在这一点上，任何信息都值得赞赏。

# php - Codeigniter 2.1 - 活动记录

> ID：12044165
> 
> 赞同：0
> 
> 时间：2012-08-20T19:50:09.970
> 
> 标签：php, codeigniter-2

我的大脑已经走到了死胡同 oO 在 DB 中，我有两个表：

**store_module->caffe_id，module_id，位置，顺序**

**模块-> id_module、名称、描述、图像**

我有查询我将所有模块用于设置 ID（store_module 表），并且我需要获取出现在此查询中的所有模块（module_id）。我需要做什么？这是代码（我醒了 30 多个小时，我的大脑拒绝与我交流，截止日期快到了，这是我需要做的最后一件事。所以，请帮助 :D）：

```
function mar_get_modules($id){
            $q = $this->db->get_where('store_module', array('caffe_id' => $id));
            $modules = $q->result_array();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:06:19.190

从简单的开始，使用常规查询（如果我猜对了，你需要一个 JOIN ）。
此查询应该有效：

```
$sql = "SELECT m.*,sm.* FROM module m
       LEFT JOIN store_module sm ON sm.id_module = m.module_id
       WHERE sm.caffe_id = ?";
return $this->db->query($sql, array($id))->result_array(); 
```

现在，您可以将其转换为 AR 查询：

```
$query = $this->db->select('module.*,store_module.*')
                  ->from('module')
                  ->join('store_module', 'store_module.id_module = module.module_id','left')
                  ->where('store_module.caffe_id',$id)
                  ->get();
return $query->result_array(); 
```

虽然 AR 有时更快，但我通常更喜欢“手动”编写查询，利用绑定来防止 SQL 注入；如果您有一个完全在您眼中的查询，则更容易看到事情是如何工作的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:55:22.423

萨沙，

在上面的函数中，您没有返回任何内容。您需要更新第 3 行的内容以达到以下效果`return $q->result_array();`

# hibernate - postgresql上的流利nhibernate：将默认列值定义为当前UTC日期？

> ID：12044174
> 
> 赞同：0
> 
> 时间：2012-08-20T19:50:38.330
> 
> 标签：hibernate, nhibernate, postgresql, fluent-nhibernate, constraints

如何做到这一点？

我以为它是这样的：

```
Map(x => x.PersistedTimeStamp)
    .CustomType<UtcDateTimeType>()
    .Generated.Insert(); 
```

......但是，这没有任何作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:49:01.640

`Generated.Insert()`仅表示“数据库将在插入时生成此值；之后为我检索它”

相反，只需`DateTime.UtcNow`在构造函数中将属性设置为。

# regex - 分多个步骤处理文件中的所有匹配项并替换部分匹配项

> ID：12044180
> 
> 赞同：0
> 
> 时间：2012-08-20T19:50:58.330
> 
> 标签：regex, perl

我正在尝试在文件中查找正则表达式的所有匹配项并替换它们。我想在多个步骤中找到匹配项。例如，我想首先找到两个 $IDENTIFIER_ 之间的模式，然后在该模式中将所有 $ONE 替换为 $TWO。

这是我到目前为止所拥有的：

```
$entireFile = "Some random text here var_a 4456 var_b var_c 1122 var_d var_e 559 var_f Some random text here ";
my $ONE_="1";
my $TWO_="2";
my $IDENTIFIER_ =  "\\b[a-zA-Z_][a-zA-Z0-9_]*\\b";
my $id1;
my $id2;
my $item;
while ($entireFile =~ m/($IDENTIFIER_)(.*?)($IDENTIFIER_)/g)
{
  $id1  = $1; 
  $item = $2;
  $id2  = $3;
  #Check to see if $item has $ONE and replace with $TWO
  if ($item =~ s/(.*?)$ONE_(.*?)/$1$TWO_$2/g )
  {
    print $id1.$item.$id2."\n" ;
  }
} 
```

这打印：

```
var_c 2222 var_d 
```

我需要帮助的是如何打印文件的其余部分（第一个匹配之前的文本、后续匹配之间的文本以及最后一个匹配之后的文本）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:03:22.787

```
$entireFile = "Some random text here var_a 4456 var_b".
              " var_c 1122 var_d var_e 559 var_f Some random text here ";
my $ONE_="1";
my $TWO_="2";
my $re_id = qr/\b[a-zA-Z_][a-zA-Z0-9_]*/;
while ($entireFile =~ s/($re_id.*?)$ONE_(.*?$re_id)/$1$TWO_$2/) { } 
print $entireFile; 
```

如果您真的想分两个阶段进行匹配：

```
$entireFile = "Some random text here var_a 4456 var_b".
              " var_c 1122 var_d var_e 559 var_f Some random text here ";
my ($ONE_, $TWO_) = ("1", "2");
my $re_id = qr/\b[a-zA-Z_][a-zA-Z0-9_]*/;
my $printed=0;
while ($entireFile =~ /($re_id)(.*?)($re_id)/g) {
  my ($id1, $item, $id2) = ($1, $2, $3);
  my ($start, $end, $length) = ($-[0], $+[0], $+[0]-$-[0]);
  if ($printed < $start) {
    print substr($entireFile, $printed, $-[0]-$printed);
    $printed = $start;
  }
  if ($item =~ s/(.*?)$ONE_(.*?)/$1$TWO_$2/g ) { 
    print $id1.$item.$id2."\n" ;
    $printed = $end;
  } else {
    print substr($entireFile, $printed, $length)."\n";
    $printed = $end;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:06:17.350

一种方法是使用您在替换中执行的函数。

例如

```
$entireFile = "Some random text here var_a 4456 var_b var_c 1122 var_d var_e 559 var_f Some random text here ";
my $ONE_="1";
my $TWO_="2";
my $IDENTIFIER_ =  "\\b[a-zA-Z_][a-zA-Z0-9_]*\\b";

$entireFile =~ s/($IDENTIFIER_)(.*?)($IDENTIFIER_)/$1 . inner_func($2) . $3/egs;
print( $entireFile );

sub inner_func {
    my ( $text ) = @_;

    $text =~ s/$ONE_/$TWO_/g;
    return( $text );
} 
```

该`/e`标志指示替换运算符 ( `s///`) 执行替换文本，就好像它是代码一样。这对于递归下降解析特别有用......

如果您`/s`在替换时使用作为标志，您还告诉搜索和替换将换行符视为任何其他字符 - 使您能够跨行执行此全局替换（如果您已将整个文件放入您的变量中第一名）。

# vector - Into or vec：在 Clojure 中将序列转换回向量

> ID：12044181
> 
> 赞同：16
> 
> 时间：2012-08-20T19:51:04.170
> 
> 标签：vector, clojure, sequence

我有以下代码递增向量中每对的第一个元素：

```
(vec (map (fn [[key value]] [(inc key) value]) [[0 :a] [1 :b]])) 
```

但是我担心这段代码不优雅，因为它首先使用 map 创建一个序列，然后将其转换回向量。

考虑这个类比：

```
(into [] (map (fn [[key value]] [(inc key) value]) [[0 :a] [1 :b]])) 
```

在#clojure@irc.freenode.net 上，有人告诉我，使用上面的代码很糟糕，因为`into`展开成`(reduce conj [] (map-indexed ...))`，在此过程中会产生许多中间对象。然后我被告知实际上`into`不会扩展到`(reduce conj ...)`并在可以时使用瞬变。还测量经过的时间表明`into`实际上比 快`vec`。

所以我的问题是：

1.  `map`在向量上使用的正确方法是什么？
2.  当我使用`vec`和`into`使用向量时，下面会发生什么？

相关但不重复的问题：

*   [Clojure：序列返回向量](https://stackoverflow.com/q/1989301/596361)
*   [如何将减少实现的序列转换回惰性向量序列](https://stackoverflow.com/q/10132565/596361)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-20T20:17:58.447

实际上，从 Clojure 1.4.0 开始，这样做的首选方法是使用`mapv`，这就像`map`除了它的返回值是一个向量。这是迄今为止最有效的方法，根本没有不必要的中间分配。

Clojure 1.5.0 将带来一个新的 reducers 库，它将提供一个通用的方法来创建`map`、`filter`、等`take`，`drop`同时创建可用于`into []`. 您可以在 1.5.0 alpha 版和最近的 ClojureScript 标记版本中使用它。

As for `(vec some-seq)` and `(into [] some-seq)`, the first ultimately delegates to a Java loop which pours `some-seq` into an empty transient vector, while the second does the same thing in very efficient Clojure code. In both cases there are some initial checks involved to determine which approach to take when constructing the final return value.

`vec` and `into []` are significantly different for Java arrays of small length (up to 32) -- the first will alias the array (use it as the tail of the newly created vector) and demands that the array not be modified subsequently, lest the contents of the vector change (see the docstring); the latter creates a new vector with a new tail and doesn't care about future changes to the array.

# java - 如何在流口水中乘以多头

> ID：12044182
> 
> 赞同：1
> 
> 时间：2012-08-20T19:51:04.377
> 
> 标签：java, drools

我想写一行代码来计算30天的毫秒数。

```
long gracePeriod = 30/*days*/ * 24 * 60 * 60 * 1000; 
```

但是，在流口水中不起作用，因为它将 int 分配给 long。所以我想我可以做这样的事情。

```
long gracePeriod = 30l/*days*/ * 24l * 60l * 60l * 1000l; 
```

但是，这也行不通，所以我不得不做一些愚蠢的事情，比如：

```
long grace1 = 30;
long grace2 = 24;
long grace3 = 60;
long grace4 = 1000;
long grace = grace1 * grace2 * grace3 * grace3 * grace4; 
```

有什么办法可以让这更简单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:29:44.457

对我来说，所有这 4 个样本都有效（并且比你不得不求助的更干净）。如果一个或多个对您不起作用，则可能是您的 IDE 或 Java 环境有问题。如果是这样，请告诉我们您正在运行的 Java 版本和环境。

```
public class TempProject
{

    public static void main(String args[])
    {
        long gracePeriod = 30l /*days*/ * 24l * 60l * 60l * 1000l;
        long gracePeriod2 = 30l /*days*/ * 24 * 60 * 60 * 1000;
        long gracePeriod3 = ((long)30) /*days*/ * 24  * 60  * 60  * 1000;
        long gracePeriod4 = ((long) 30)/*days*/ * ((long) 24) * ((long) 60) * ((long) 60) * ((long) 1000);

        System.out.println(gracePeriod);
        System.out.println(gracePeriod2);
        System.out.println(gracePeriod3);
        System.out.println(gracePeriod4);
    }

} 
```

当然，最简单的方法是对数字进行硬编码；）

```
long gracePeriod = 2592000000l; 
```

# liferay - 通过模板禁用 Web 内容显示中的边框

> ID：12044183
> 
> 赞同：2
> 
> 时间：2012-08-20T19:51:10.710
> 
> 标签：liferay, velocity

我正在为 Liferay 站点上的 Web 内容显示创建一组自定义结构（和匹配的模板）。

为了使站点维护人员更方便，我希望这些模板之一默认抑制外观边框。

我在网上找到了文档和示例，展示了如何禁用嵌入在主题中的 portlet 的边框，但是我没有运气在 WCD 模板中应用这些技术。

这是我在主题中看到的代码：

```
#set ($VOID = $velocityPortletPreferences.setValue("portlet-setup-show-borders", "false"))
#set ($VOID = $theme.runtime("customportletname_WAR_pluginname", "", $velocityPortletPreferences.toString()))
$velocityPortletPreferences.reset() 
```

以下是我如何将它应用到我的模板：

```
#set ($VOID = $velocityPortletPreferences.setValue("portlet-setup-show-borders", "false"))
<div class="custom-wcd wcdnormal">
    <h2>$title.getData()</h2>
    $content.getData()
</div>
$velocityPortletPreferences.reset() 
```

我对它不起作用并不感到惊讶——没有什么类似于将首选项应用于 portlet 的 $theme.runtime 调用，但我也不知道 $theme.runtime 在这一层是否合适，并且如果是，作为第一个参数提供什么值。我怀疑这最后一个是最有可能的替代方案，但我不知道如何将 WCD portlet 识别为 $theme.runtime，也不知道如何跟踪该信息（无论如何我都不是 Java 开发人员） .

并且澄清一下：[默认情况下禁用所有 portlet 上的边框](https://www.liferay.com/documentation/liferay-portal/6.0/development/-/ai/portal-predefined-settings)是不可接受*的*，我也无法修改在呈现时使用 journal-article 组件的 Java 控制器。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T13:35:28.560

简单直接：

```
$velocityPortletPreferences.setValue("portletSetupShowBorders", "false") 
$velocityPortletPreferences.setValue("languageIds", "pt_BR,en_US")
$velocityPortletPreferences.setValue("displayStyle", "1")
$theme.runtime("82", "", $velocityPortletPreferences.toString())
$velocityPortletPreferences.reset() 
```

此示例用于将语言 portlet (Portlet ID = 82) 直接嵌入到 .vm 主题文件之一中，在我的情况下，此代码位于 navigation.vm 上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T10:41:27.317

Liferay 属性/首选项名称有时会发生变化。这周我创建了一个钩子来创建一个站点，用包含 portlet 的页面填充它，并为 CMS 提供一组默认的结构、模板和文章。我也不得不关闭我的 portlet 的边框，并且需要将以下首选项名称设置为 false 来实现：**portletSetupShowBorders**

我的java代码如下：

```
PortletPreferences prefs = PortletPreferencesFactoryUtil.getLayoutPortletSetup(page, portletInstanceId);
prefs.setValue("groupId", String.valueOf(page.getGroupId()));
prefs.setValue("articleId", article.name());
prefs.setValue("portletSetupShowBorders", "false");
prefs.store(); 
```

从 Liferay 日记模板中，您应该能够使用以下代码来关闭将显示使用该模板的文章的 portlet 的边框：

```
#set ($portletPreferencesService = $serviceLocator.findService('com.liferay.portal.service.PortletPreferencesLocalService'))
#set ($companyId = $getterUtil.getLong($companyId))
#set ($ownerId = 0) ## PortletKeys.PREFS_OWNER_ID_DEFAULT
#set ($ownerType = 3) ## PortletKeys.PREFS_OWNER_TYPE_LAYOUT
#set ($plid = $getterUtil.getLong($request.theme-display.plid))
#set ($portletId = $request.theme-display.portlet-display.id)
#set ($portletPreferences = $portletPreferencesService.getPreferences($companyId, $ownerId, $ownerType, $plid, $portletId))
#set ($VOID = $portletPreferences.setValue('portlet-setup-show-borders', 'false'))
#set ($VOID = $portletPreferences.store()) 
```

请记住，您还需要将以下行添加到您的 portal-ext.properties：

```
journal.template.velocity.restricted.variables= 
```

# javascript - 简化 jQuery 中的变量

> ID：12044201
> 
> 赞同：0
> 
> 时间：2012-08-20T19:52:12.727
> 
> 标签：javascript, jquery

如何简化以下代码？

它只是一个静态 ID。

```
<script>
    $x('input[id="id1"]').attr('checked', true);
    $x('input[id="idx4"]').attr('checked', true);
    $x('input[id="idk5"]').attr('checked', true);
</script> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T19:53:22.433

只需使用[ID 选择器](http://api.jquery.com/category/selectors/)。您可以通过逗号分隔来选择多个元素：

```
$x('#id1,#idx4,#idk5').attr('checked', true); 
```

或者，如果您使用的是 jQuery 1.6（或更高版本），您应该使用[.prop()](http://api.jquery.com/prop/)来设置选中的属性：

```
$x('#id1,#idx4,#idk5').prop('checked', true); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:54:38.453

jQuery 使用[类似于](http://api.jquery.com/category/selectors/)CSS 的选择器，但有一些添加。由于`[id]`属性必须是唯一的，因此您无需指定元素（在本例中`input`）。您可以使用[`id`选择器](http://api.jquery.com/id-selector/)。

此外，您不应该设置`checked`属性，因为这会更改复选框将重置为的值，您应该更改`checked`属性：

```
$('#id1, #idx4, #idk5').prop('checked', true); 
```

在 jQuery pre-1.6 中做同样的事情：

```
$('#id1, #idx4, #idk5').each(function () {
    this.checked = true;
}); 
```

# sql - 运行存储在表中的 SQL 预定义函数

> ID：12044203
> 
> 赞同：0
> 
> 时间：2012-08-20T19:52:26.713
> 
> 标签：sql, sql-server, sql-server-2008

我有一个存储 SQL 预定义函数的表，例如`CONVERT(VARCHAR(10), '2012-08-21 00:16:41.993', 101)`在行/列中。从表中检索结果时，它应该运行函数并将最终结果作为“2012-08-21”给出，而不是现在它返回相同的函数语句。我正在运行`select (select RunDate from RunDate)`并使用 SQL Server 数据库。

请帮忙！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T19:57:26.317

为此，您需要使用动态 SQL。您不能只嵌套表达式并让 SQL 评估输出......

```
DECLARE @x TABLE(sql NVARCHAR(255));

INSERT @x(sql) SELECT N'CONVERT(VARCHAR(10), ''2012-08-21 00:16:41.993'', 101)';

DECLARE @sql NVARCHAR(MAX);

SELECT @sql = N'SELECT ' + sql FROM @x;

EXEC sp_executesql @sql; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T19:56:47.767

它看起来像这样（相应调整）：

```
DECLARE @predef VARCHAR(1000);
DECLARE @sqlquery VARCHAR(1000);
SELECT  @predef = (SELECT top 1 Value FROM Parameters Where Name = 'MYFUNC');

SET @sqlquery = 'select ' + @predef + ' from SomeTable';
EXECUTE ( @sqlquery ); 
```

一个提示：这里是龙。谨防 SQL 注入。

# servlets - Clojure、Servlet 和 JWT

> ID：12044204
> 
> 赞同：4
> 
> 时间：2012-08-20T19:52:33.767
> 
> 标签：servlets, clojure, jetty, jwt

**编辑：**对于工作示例，请查看[此演示项目](https://bitbucket.org/ibraim/sample-jwt-with-clojure)。

*免责声明：*我**完全**是构建 Java Web 应用程序的菜鸟。

我正在尝试将[JWT](http://www.webtoolkit.eu/jwt)与 Clojure 一起使用，但我根本不知道如何处理这个“servlet”的东西。到目前为止，我的想法是：

1.  创建一个`WApplication`带有“Hello World”的表单。

    ```
    (defn make-hello-app [env]
      (let [wapp (WApplication. env)
            root (.getRoot wapp)]
        (.setTitle wapp "Hello world")
        (.addWidget root (WText. "Hello!!!!"))
        wapp)) 
    ```

2.  创建一个 servlet，继承自`WtServlet`.

    ```
    (def servlet
      (proxy [WtServlet] []
        (createApplication [env]
          (make-hello-app env)))) 
    ```

3.  启动码头并使用 servlet。这是我不知道该怎么做。到目前为止，这是我最好的镜头：

    ```
    (ns jwttest.core
      (:use compojure.core)
      (:use ring.adapter.jetty)
      (:import (org.eclipse.jetty.server Server))
      (:import (eu.webtoolkit.jwt WApplication WEnvironment WtServlet WText WPushButton WLineEdit WBreak)))

    ;; (the funcions above were defined here)

    ;; create a jetty server
    (defn create-a-jetty-server []
      (let [connector (doto (SelectChannelConnector.)
                            (.setPort 8080)
                            (.setHost "localhost"))
         server (doto (Server.)
                      (.addConnector connector)
                      (.setSendDateHeader true))]
         server))

     ;; start the application
     (defn start-the-app []
       (let [server (create-a-jetty-server)]
          ;; ???? .addServlet ? How?
          (.start server))) 
    ```

在我的`project.clj`我有：

```
[org.clojure/clojure "1.4.0"]
[eu.webtoolkit/jwt "3.2.0"]
[compojure "1.1.1"]
[ring "1.1.2"] 
```

我知道 ring 可以从处理程序创建一个 servlet，但在这种情况下，我已经有一个 servlet，所以......我应该怎么做才能运行它？

**注意：**我的代码基于[2009 年发表的这篇非常古老的帖子](http://www.nsa.be/index.php/eng/Blog/Using-Jwt-yes-it-s-a-J-with-Clojure)。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T03:37:58.687

我挖掘了一些[Jetty API](http://download.eclipse.org/jetty/stable-7/apidocs/)和[Ring](https://github.com/ring-clojure/ring/blob/master/ring-jetty-adapter/src/ring/adapter/jetty.clj) / [Noir](https://github.com/ibdknox/noir/blob/master/src/noir/server.clj)码头处理代码，这是我发现的摘要（并且没有机会测试）

*   Jetty Server 有一个“setHandler”方法，它接受一个处理程序（感谢 Ring）
*   有一个 ServletHandler 类，它看起来适合上面的内容，并且有许多类似于 addServlet 的方法，它们看起来就像你需要它们做的那样。

您应该能够将处理程序设置为 Servlet 处理程序并从那里开始。

# java - 使用 Salesforce CRUD 元数据 API 创建自定义对象时出现异常

> ID：12044206
> 
> 赞同：0
> 
> 时间：2012-08-20T19:52:38.807
> 
> 标签：java, api, wsdl, salesforce, crm

当我尝试使用 CRUD Matadata API 在 Salesforce 中创建自定义对象时，出现以下异常。

```
 com.sforce.ws.SoapFaultException: Must specify a {http://www.w3.org/2001/XMLSchema-instance}
 type attribute value for the {http://soap.sforce.com/2006/04/metadata}metadata element
        at com.sforce.ws.transport.SoapConnection.createException(SoapConnection.java:205)
        at com.sforce.ws.transport.SoapConnection.receive(SoapConnection.java:149)
        at com.sforce.ws.transport.SoapConnection.send(SoapConnection.java:98)
        at com.sforce.soap.metadata.MetadataConnection.create(MetadataConnection.java:273)
        at com.sfo.service.SalesforceObjectBootstrap.createCustomObject(SalesforceObjectBootstrap.java:226) 
```

我正在使用此链接中的代码，我唯一更改的是自定义对象的名称 [http://www.salesforce.com/us/developer/docs/api_meta/Content/meta_calls_intro.htm](http://www.salesforce.com/us/developer/docs/api_meta/Content/meta_calls_intro.htm)

这一步出现异常

```
AsyncResult[] asyncResults = metadataConnection.create(new CustomObject[]{customObject}); 
```

调用上述 create 方法之前的 Custom 对象具有以下参数值。

```
[CustomObject [Metadata  fullName='lead_5273_custom_reg__c'
]
 actionOverrides='{[0]}'
 articleTypeChannelDisplay='null'
 businessProcesses='{[0]}'
 customHelp='hey there help me'
 customHelpPage='null'
 customSettingsType='null'
 customSettingsVisibility='null'
 deploymentStatus='Deployed'
 deprecated='false'
 description='Created from backend Webcast API : Lead 5273 Custom Reg'
 enableActivities='false'
 enableDivisions='false'
 enableEnhancedLookup='false'
 enableFeeds='false'
 enableHistory='false'
 enableReports='false'
 fieldSets='{[0]}'
 fields='{[0]}'
 gender='null'
 household='false'
 label='Lead 5273 Custom Reg'
 listViews='{[0]}'
 nameField='[CustomField [Metadata  fullName='lead_5273_custom_reg__c'
]
 caseSensitive='false'
 customDataType='null'
 defaultValue='null'
 deleteConstraint='null'
 deprecated='false'
 description='field name for a metadata custom object'
 displayFormat='null'
 escapeMarkup='false'
 externalDeveloperName='null'
 externalId='false'
 formula='null'
 formulaTreatBlanksAs='null'
 inlineHelpText='null'
 label='Lead 5273 Custom Reg'
 length='0'
 maskChar='null'
 maskType='null'
 picklist='null'
 populateExistingRows='false'
 precision='0'
 referenceTo='null'
 relationshipLabel='null'
 relationshipName='null'
 relationshipOrder='0'
 reparentableMasterDetail='false'
 required='false'
 restrictedAdminField='false'
 scale='0'
 startingNumber='0'
 stripMarkup='false'
 summarizedField='null'
 summaryFilterItems='{[0]}'
 summaryForeignKey='null'
 summaryOperation='null'
 trackFeedHistory='false'
 trackHistory='false'
 type='Text'
 unique='false'
 visibleLines='0'
 writeRequiresMasterRead='false'
]
'
 namedFilters='{[0]}'
 pluralLabel='Lead 5273 Custom Regs'
 recordTypeTrackFeedHistory='false'
 recordTypeTrackHistory='false'
 recordTypes='{[0]}'
 searchLayouts='null'
 sharingModel='ReadWrite'
 sharingReasons='{[0]}'
 sharingRecalculations='{[0]}'
 startsWith='null'
 validationRules='{[0]}'
 webLinks='{[0]}'
] 
```

我使用这里提到的方法来生成 WSDL 文件及其 java 框架。 [http://www.salesforce.com/us/developer/docs/api_meta/Content/meta_quickstart.htm#topic-title-sample-code](http://www.salesforce.com/us/developer/docs/api_meta/Content/meta_quickstart.htm#topic-title-sample-code)

我的代码与上面提供的示例完全匹配。我只是复制粘贴了整个东西。

I found this link, which mentioned the same exception. But this link is relating to creating a Folder. [http://boards.developerforce.com/t5/Java-Development/Metadata-API-errors-Must-specify-a-type-attribute-value-for-the/td-p/175253](http://boards.developerforce.com/t5/Java-Development/Metadata-API-errors-Must-specify-a-type-attribute-value-for-the/td-p/175253)

Please let me know how to solve this problem.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T10:21:54.373

I've not played with this myself, but from the looks of the exception, the `MetaData` block here:

```
[CustomObject [Metadata  fullName='lead_5273_custom_reg__c'] 
```

needs to contain the object type, which I'm assuming in this case is `CustomObject__c` (all custom objects have the `__c` suffix), so maybe try the following:

```
[CustomObject [Metadata  fullName='lead_5273_custom_reg__c' type='CustomObject__c'] 
```

Unless of course, `fullname` is actually the object name, which could be a possibility.

# ruby-on-rails - Ruby 菜单调用未定义的方法

> ID：12044211
> 
> 赞同：1
> 
> 时间：2012-08-20T19:53:06.320
> 
> 标签：ruby-on-rails, undefined

我正在编写我的第一个 Ruby on Rails 程序，这是一个帮助管理/组织大学课程、参加课程的学生以及属于每个课程的模块的应用程序。

我目前有两个类：第一个类，称为 Application，是我用来与用户交互的类，如下所示：

```
class Application
  # To change this template use File | Settings | File Templates.
  require './courseModules.rb'
  def initialize
    mainMenu
  end

=begin
  def navigateTo(what)
    what.new(v).display
    mainMenu
  end  
=end

  def mainMenu
    puts "What would you like to do?
      1: Add module to a scheme
      2: Remove module from a scheme
      3: Query modules
      4: Modify module
      5: Register a student on a scheme
      6: Remove a student from a scheme
      7: Register a student on a module
      8: Remove a student from a module"
case gets.strip
  when "1"
    CourseModules.addModuleToScheme
  when "2"
    CourseModules.removeModuleFromScheme
  when "3"
    navigateTo CourseModules
  when "4"
    navigateTo CourseModules
  when "5"
    navigateTo Student
  when "6"
    navigateTo Student
  when "7"
    navigateTo Student
    end
  end
  Application.new
end 
```

第二个，称为 courseModules 是我将用来允许用户添加新课程并向这些课程添加模块的一个。这个类目前看起来像这样：

```
class CourseModules
   # To change this template use File | Settings | File Templates.
   @@moduleScheme = nil
   @@moduleYear = nil
   #@moduleTitle = ""
   @noOfModulesInScheme = 0

   def self.moduleYear
     @@moduleYear
   end

   def initialize(v)
     @val = v
   end

   # Set and get the @val object value
   def set (v)
     @val = v
   end
   def get
     return @val
   end

   def addModule
     moduleName = Module.new(30)
     moduleRefNo = Random(100)
     #moduleTitle = @moduleTitle
     moduleYear(4)

     print "What is the name of the module you would like to add?"
     moduleName = gets
     moduleRefNo
     printf "Which year does the module belong to?"
     @@moduleYear = gets
     puts "#{moduleName}, belonging to #{@@moduleYear} has been added to the system, with reference number #{moduleRefNo}."
     navigateTo Application

   end

   def addModuleToScheme

     # Create an empty hash for the schemes
     schemes = Hash.new()

     # Allow user to enter scheme names into a set of variables, and use each scheme name as a hash/ array of modules.
     # Then allow the user to enter the the modules for each scheme into each of the hashes

     # Create specific hash elements by using the following line:
     schemes = {:scheme1 => scheme1variable, :scheme2 => scheme2variable}

     puts "What is the name of the scheme that you would like to add a module to? "
     schemeName = gets

     # Need to use an if statement here to check whether or not the scheme already exists, if it doesn't, create it, if it does,
     # tell the user that it does.

     if schemes.has_key?(schemeName)
       puts "This scheme has already been added "
     else
       schemes.add(schemeName)
     end

     noOfModulesInScheme + 1
     moduleName.moduleScheme = schemeName
   end

   def removeModuleFromScheme
     moduleName.moduleScheme = nil
   end

   def queryModule

   end

 end 
```

目前，我正在处理菜单中的第一个选项 - “将模块添加到方案”。当我尝试从 Application.rb 类运行程序时，会显示菜单，我输入：“1”，这是我要选择的选项。

但是，然后我收到一条错误消息，说我的方法“addModuleToScheme”未定义。有人可以指出我的“addModuleToScheme”方法做错了什么吗？

非常感谢。

***编辑 21/08/2012 00:35***

好的，我认为这似乎已经解决了我的 addModuleToScheme 方法，但是当我尝试将方案名称实际添加到哈希时出现错误：

当我现在从菜单中选择“1”时，系统会要求我输入方案的名称，但是，当我输入该名称时，会出现未定义的方法错误，

```
undefined method 'add' for {}:Hash (NoMethodError)" 
```

在线上

```
schemes.add(schemeName) 
```

在我的 if else 语句中。有什么想法我在这里做错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:09:20.657

我敢打赌它告诉你这`CourseModules.addModuleToScheme`是未定义的。那是因为当您尝试将其用作类方法时，您已经将该方法实现为实例方法。

尝试将其定义为：

```
def self.addModuleToScheme
  # ... do stuff
end 
```

或尝试将其用作实例方法，在这种情况下，您必须首先创建`CourseModules`该类的新实例。

# rdf - RDF Triple 是 RDF 语句吗？

> ID：12044212
> 
> 赞同：9
> 
> 时间：2012-08-20T19:53:08.697
> 
> 标签：rdf, semantic-web

正如问题的主题所问的那样，这两个是一回事吗？它们可以互换吗？如果不是，请解释差异或举例说明。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-21T21:34:53.420

引用[RDF 概念规范（RDF 1.1 草案版本）](http://www.w3.org/TR/rdf11-concepts/)：

> 抽象语法的核心结构是三元组的集合，每个元组由一个主语、一个谓语和一个宾语组成。... RDF 三元组的断言表明谓词表示的某种关系在主语和宾语表示的资源之间保持不变。对应于 RDF 三元组的该语句称为 RDF 语句。

换句话说：由主语、谓语和宾语组成的抽象结构被称为“三元组”。三元组由 IRI、空白节点和/或文字组成。每个三元组都表达了关于世界的一些主张或事实——它表示两件事彼此之间存在某种关系。这种关于世界的主张是编码在三元组中的“陈述”。

所以，严格来说是有区别的。但这是一个非常微妙的区别，而且这些术语通常可以互换使用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-08-20T20:18:53.960

是的，在 RDF 中，*语句*基本上与*三元组*（或*3-tuple*）相同。

但是，还有另一个概念称为*陈述*的陈述，在这种情况下，您必须考虑一个事实，即三元组可以由不同的实体陈述（如在人/组织中，而不是 XML 实体中）。在这种情况下，三元组（主语、谓语、宾语）不是唯一的，应该根据谁声明它而进行不同的描述。

整个主题有点令人难以置信。我建议阅读[RDF Interest 邮件列表中的这个主题的摘要](http://ilrt.org/discovery/2000/11/statements/index.html)（带点零食）。它归结为 RDF 本身的语义描述。

总而言之，这完全取决于您的意思*三重*。无论是抽象的概念还是对它的实际*陈述*。如果是第一种情况，我认为可以安全地假设*三元组*和*语句*是可以互换的。而且大多数时候，在使用 RDF 时，它是第一种情况。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-02T19:27:52.720

我曾经在 Jena Java 代码中的 Statement-versus-Triple 区别（或类似的 Node-vs-RDFNode 区别）摸不着头脑时遇到了 Jena 邮件列表上的一些东西，并[在博客上写了一篇关于它](http://willware.blogspot.com/2010/02/jena-node-versus-rdfnode.html)的文章。以下是邮件列表中[的要点](http://tech.groups.yahoo.com/group/jena-dev/message/38299)：

> 我们发现 Model/Statement/RDFNode（API）作为应用程序接口工作，但它不适合存储抽象，而 Graph/Triple/Node（SPI）在规律性更有价值的地方工作得更好。也就是说，我们将面向应用程序的设计与面向子系统的设计分开。

# java - 寻找一种智能且快速的搜索算法

> ID：12044215
> 
> 赞同：1
> 
> 时间：2012-08-20T19:53:31.053
> 
> 标签：java, algorithm, data-structures, map, java-7

假设我有 2 个对象数组，它们在以下模式中相互映射：

数组1：

```
String [] prog_types1 = {"Program1","Program2","Program3","Program4"}; 
```

和 array2 ：

```
String [] prog_types2 ={"SubProgram1","SubProgram2","SubProgram3","SubProgram4",  
"SubProgram5","SubProgram6","SubProgram7","SubProgram8","SubProgram9","SubProgram10"}; 
```

正如它的名字所理解的那样，prog_types2 是 prog_types1 的扩展，但是有一些重复的值，所以这些程序之间的完整映射看起来像这样：

```
prog_types1     prog_types2
ProgramType1    SubProgramType1
ProgramType1    SubProgramType2
ProgramType1    SubProgramType7
ProgramType1    SubProgramType9
ProgramType2    SubProgramType12
ProgramType2    SubProgramType7
ProgramType2    SubProgramType9
ProgramType3    SubProgramType1
ProgramType3    SubProgramType2
ProgramType3    SubProgramType21
ProgramType3    SubProgramType27
ProgramType3    SubProgramType7
ProgramType5    SubProgramType12
ProgramType5    SubProgramType9 
```

我的问题是：从更快的处理和重用的角度来看，将这些数组相互映射的最佳方式是什么？我已将其实现为：

-- 类集（类 prog1 和 prog2 并在将其放入向量之后）...

-- 带有哈希集的哈希表

-- 可能还有一个数组

我正在寻找的方式不应该包括为 prog1 对象再次创建相同的 prog2 对象，就像前面描述的所有方式一样，而是通过例如索引位置或以任何其他方式映射它。只是寻找一种很好的算法方法来解决它......

提前致谢

ps 它应该只在几个类之间的 1 个包中使用，它的主要用途是基于 prog1 类型值的 prog2 类型值的填充

ps2 java7

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:10:18.487

使用Guava Libraries 中的[MultiMap ，您可以说：](https://guava-libraries.googlecode.com/svn/tags/release03/javadoc/com/google/common/collect/Multimap.html)

```
Multimap<String, String> mmap = ArrayListMultimap.create();
mmap.put("Program1", "SubProgramType1");
mmap.put("Program1", "SubProgramType2");
// etc.

mmap.get("Program1") 
```

看起来像：

```
[SubProgramType1, SubProgramType2, SubProgramType7, SubProgramType9] 
```

顺便说一句，Hashtable 现在不用于散列集合，已被[HashMap](http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html)取代:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:56:54.370

IMO最好的方法是：

```
Map<String, List<String>> programs = new HashMap<String, List<String>>(); 
```

将第一个列表中的字符串作为键，相应的子程序组成值列表。现在映射很明显：

```
ProgramType1 -> [SubProgramType1, SubProgramType2, SubProgramType7, SubProgramType9]
ProgramType2 -> [SubProgramType12, SubProgramType7, SubProgramType9]
ProgramType3 -> [SubProgramType1, SubProgramType2, SubProgramType21, SubProgramType27, SubProgramType7]
ProgramType5 -> [SubProgramType12, SubProgramType9] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:18:28.070

番石榴`ListMultimap`，这给了`List<E>`，不是`Collection<E>`- 更令人愉快。

```
private ListMultimap<String,Something> stuff = ArrayListMultimap.create();

// ...

public void add(String key, Something item) {
  stuff.put(key, item);
}

public List<Something> get(String key) {
  // might as well use the Lists convenience API while we're at it.
  return Lists.newArrayList(stuff.get(key));
} 
```

[http://www.coffee-bytes.com/2011/12/22/guava-multimaps](http://www.coffee-bytes.com/2011/12/22/guava-multimaps)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T15:00:30.187

顺便说一句，因为我需要：

-- 单独使用 Program1 值

-- 单独使用 SubProgram1 值

-- 根据 Program1 值填充 SubProgram1 值

这里最简单的解决方案是声明一个包含所有重复项的二维数组（因为它在完整地图模式中不正常显示）和 1）和 2）使用非重复算法和 3）从二维循环循环

所以没有理由声明 3 个对象，巨大的内存节省和不错的方法。我给自己一颗星：）

# objective-c - UIView 创建和定位

> ID：12044221
> 
> 赞同：0
> 
> 时间：2012-08-20T19:54:06.483
> 
> 标签：objective-c, ios, uiview

我的控制器中有两个 UIView 成员，progressLineView 和 buttonsView。在某些时候，我称这个方法为：

```
- (void) drawPlayProgressLine{

    progressLineView = [[UIView alloc] initWithFrame:CGRectMake(0.0, 0.0, 1, buttonsView.frame.size.height)];
    progressLineView.backgroundColor = [UIColor whiteColor];
    [buttonsView addSubview:progressLineView];

} 
```

一切正常，我还有一个改变视图位置的方法：

```
- (void) moveProgressLine{

    CGRect frame = progressLineView.frame;
    frame.origin.x++;
    progressLineView.frame = frame;
} 
```

在该`moveProgressLine`方法被调用了几次之后，我想`drawPlayProgressLine`再次调用，而不是将视图完全移动到起始位置，它会创建一个新视图。调用的越`drawPlayProgressLine`多，我在屏幕上获得的视图就越多，但我只需要一个。

我不明白当我只创建一个对象时会发生这种情况。如何移动视图而不是每次都创建一个新视图？还有一个问题：如何才能完全删除（直到`drawPlayProgressLine`调用该方法再次创建它）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T19:58:44.667

您应该在创建它之前检查它是否已创建，并在必要时移动它：

```
- (void) drawPlayProgressLine{

    if(progressLineView == nil)
    {
        progressLineView = [[UIView alloc] init];
        progressLineView.backgroundColor = [UIColor whiteColor];
        [buttonsView addSubview:progressLineView];
    }

    progressLineView.frame = CGRectMake(0.0, 0.0, 1, buttonsView.frame.size.height);

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:04:18.583

您可能不会使父视图无效。不会创建新对象，而是在移动它们后将它们的演示文稿留在屏幕上。

至于第二个问题：

```
[progressLineView removeFromSuperview]; 
[progressLineView release];  
progressLineView = nil; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:20:10.993

> 我不明白当我只创建一个对象时会发生这种情况。

每次调用`-drawPlayProgressLine`方法时都会创建一个新视图。调用 10 次，您将获得 10 次观看。

> 如何移动视图而不是每次都创建一个新视图？

不要每次都通过`-drawPlayProgressLine`. 相反，您可以执行以下任一操作：

*   `progressLineView`在创建视图控制器的视图层次结构时创建一次。`-viewDidLoad`是处理这类事情的理想场所。

*   `progressLineView`仅在当前为 nil 时检查并创建它的值。

无论您选择哪个，假设是一个实例变量，您都可以在您的方法`progressLineView`中执行您正在执行的操作。`-moveProgressLine`也就是说，就像`progressLineView`它已经存在一样使用，因为它确实存在。顺便说一句，移动视图的一种简单方法是修改它的`center`属性：

```
CGPoint *c = progressLineView.center;
c.x += 25.0;
progressLineView.center = c; 
```

> 还有一个问题：如何才能完全移除（直到调用drawPlayProgressLine方法重新创建）

一种方法是在不使用视图时简单地隐藏视图。另一种是将它从其超级视图中删除（如果您保留它，则将其释放），然后将您的设置`progressLineView`为 nil。因此，如果`progressLineView`是 ivar，请执行以下操作：

```
[progressLineView removeFromSuperview];
[progressLineView release];              // if you're not using ARC and have retained it
progressLineView = nil; 
```

# jquery - 提交ajax表单时调用函数

> ID：12044222
> 
> 赞同：0
> 
> 时间：2012-08-20T19:54:08.443
> 
> 标签：jquery, ajaxform

我正在使用 ajaxForm.js 进行 ajax 图像上传。

这是我使用的 js 函数：

```
$(document).ready(function() {
    $('#photoimg').live('change', function() {
        $("#hd_pic").html('');
        $("#loading").html('<img src="../img/common/loader.gif"/>').fadeIn(250);
        $("#imageform").ajaxForm({
            target: '#hd_pic'  
        }).submit();
    });
}); 
```

我不想将结果输出到目标：'#hd_pic'，但我想调用一个函数。例如，我在我的 ajax 调用中这样做：

```
$.ajax({
    type: "POST",
    url: "/ajax/add_url.php",
    data: dataString,
}).done(function(result) {
    myresult(result);
});​ 
```

我调用函数 myresult 并使用 ajax 调用的结果。我也想在 ajaxform 提交函数中执行此操作。是否有可能做到这一点？

这不起作用：

```
 $("#imageform").ajaxForm({
        success: myresult(result)
    }).submit(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T19:59:07.757

代替*target*，您可以使用*成功*回调属性作为[选项](http://jquery.malsup.com/form/#options-object)之一：

```
$("#imageForm").ajaxForm({
    success: function() {
        // your callback code goes here
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T19:59:43.117

我认为你可以这样做：

```
$("#imageform").ajaxForm({
    success: myresult
}).submit(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T19:59:52.887

你想要的确切语法

```
 $("#imageform").ajaxForm({
        target: '#hd_pic',
        success: function(){/*your code after here*/}
    }) 
```

[jQuery API：Ajax 选项](http://api.jquery.com/jQuery.ajax/)

# statistics - 将值扩展到算术平均值

> ID：12044223
> 
> 赞同：0
> 
> 时间：2012-08-20T19:54:16.080
> 
> 标签：statistics

可能是一个非常愚蠢的问题，我不确定它是属于这里还是属于数学。

我的问题：

我有几个 X 类型的元素，它们具有布尔属性 Y。

为了计算 Y 为真的元素的百分比，我计算了 Y 为真的所有 X 并将其除以元素的数量。

但我不想一直迭代所有元素以更新该百分比值。

我的想法是：

如果我有 33% 的 3 个元素，并且在 Y 为真的情况下添加第四个元素：

```
(0.33 * 3 + 1) / 4 = 0.4975 
```

显然，由于 0.33，这不能很好地工作。

有没有什么方法可以在没有迭代或保存 Y 为真的项目数量的情况下获得准确的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:02:23.717

记录元素总数和“真实”元素的总数。全局变量、对象成员变量等等。我假设程序启动时的某个时候，您的元素为零。每次添加、删除元素或其布尔属性更改时，都会根据需要增加或减少这些计数。您永远不必遍历列表（可能用于测试除外），但每次更改列表都必须包括摆弄这些变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:02:23.887

你的想法行不通，因为 0.33 不等于 1/3。这是一个近似值。如果你取确切的值，你会得到正确的答案：

```
(1/3 * 3 + 1) / 4 = (1 + 1) / 4 = 1/2 
```

我的问题是，如果您可以存储 33% 的值而无需迭代，为什么不只存储 1 和 3 的值并计算它们呢？也就是说，只保留真实值的数量和对象的数量。当你得到新的时增加。按需计算。没有必要每次都进行迭代。

# ruby-on-rails - 尝试更新 Rails 后无法安装 gem “termios”

> ID：12044227
> 
> 赞同：2
> 
> 时间：2012-08-20T19:54:24.420
> 
> 标签：ruby-on-rails, rubygems, bundler

我正在尝试将 Rails 从 3.1.3 更新到 3.2.8。更改 rails gem 值并运行“bundle update rails”会尝试安装名为“termios”版本 0.9.4 的 gem，但失败并显示以下消息：

```
Installing termios (0.9.4) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

    /Users/me/.rvm/rubies/ruby-1.9.3-p0/bin/ruby extconf.rb 
checking for termios.h... yes
checking for unistd.h... yes
creating Makefile

make
compiling termios.c
In file included from termios.c:10:
/Users/me/.rvm/rubies/ruby-1.9.3-p0/include/ruby-1.9.1/ruby/backward/rubyio.h:2:2:     warning: #warning use "ruby/io.h" instead of "rubyio.h"
termios.c: In function ‘Termios_to_termios’:
termios.c:182: error: ‘struct RArray’ has no member named ‘ptr’
termios.c:183: error: ‘struct RArray’ has no member named ‘ptr’
termios.c: In function ‘termios_tcgetattr’:
termios.c:200: error: ‘OpenFile’ undeclared (first use in this function)
make: *** [termios.o] Error 1

Gem files will remain installed in /Users/me/.rvm/gems/ruby-1.9.3-p0@mcp5/gems/termios-0.9.4 for inspection.
Results logged to /Users/me/.rvm/gems/ruby-1.9.3-p0@mcp5/gems/termios-0.9.4/./gem_make.out
An error occured while installing termios (0.9.4), and Bundler cannot continue.
Make sure that `gem install termios -v '0.9.4'` succeeds before bundling. 
```

另请注意，这是我自从使用 OS X Mountain Lion 以来第一次更新 Rails。

我已经看到关于这个问题的另一个答案，它说要安装一个名为“ruby-termios”的gem。我这样做了，并且那个 gem 安装得很好，但是在某个地方仍然有一个依赖项试图安装“termios”gem。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T14:31:17.090

我最终将[ruby​​-termios](https://github.com/arika/ruby-termios) gem 克隆到我的仓库中。出于某种未知的原因，作者将其命名为 ruby​​-termios 而不仅仅是 termios。所以我重命名了gemspec。然后我修改了我的 Gemfile 以使用：

```
gem 'termios', :path => 'termios' 
```

然后我跑了：

```
bundle update 
```

一切都恢复正常了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-28T01:35:45.693

似乎`gem 'engineyard'`在您的 Gemfile 中指定会导致捆绑器安装一些具有 termios 依赖项的古老版本（0.2.x）。

指定较新的 ( `gem 'engineyard', '~> 2.3'`) 将正确安装。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-25T19:06:44.263

`gem install ruby-termios`为我解决了制作问题；我希望`gem "ruby-termios"`在您的 Gemfile 中也可以使用。

看起来发生的事情是，名为`termios`(arika) 的 gem 的原始作者自 2004 年（v 0.9.4）以来没有更新 gem，但没有人拥有 ruby​​gems [http://rubygems.org/gems/termios](http://rubygems.org/gems/termios)上的命名空间。然后其他人（爱迪生）在 github [https://github.com/edison/ruby-termios](https://github.com/edison/ruby-termios)上做了一个分叉，还有其他*人*（tylerrick）推了一个新的 gem，名为`ruby-termios`... 但当然在 Ruby 内部，这个库仍然被命名`termios`所以命令还在`require "termios"`。

# homebrew - brew doctor 说我对 Homebrew 进行了未提交的修改，但 git status 说“没有提交”

> ID：12044242
> 
> 赞同：2
> 
> 时间：2012-08-20T19:55:26.817
> 
> 标签：homebrew

我是第一次安装 brew，当我运行 brew doctor 时出现一个错误：

```
Warning: You have uncommitted modifications to Homebrew
If this a surprise to you, then you should stash these modifications.
Stashing returns Homebrew to a pristine state but can be undone
should you later need to do so for some reason.
    cd /usr/local && git stash 
```

如果我 cd 到 /usr/local 并运行“git status”，我会得到：

```
On branch master
nothing to commit (working directory clean) 
```

如果我运行： cd /usr/local && git stash，我得到：

```
No local changes to save 
```

我应该忽略这个警告吗？我在 OSX 10.8 上。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-21T18:34:58.220

我遇到了同样的问题，上述建议都没有消除对我的警告。

似乎 Homebrew 会抱怨未提交/未隐藏的更改，即使它们没有被添加到提交中，如果它们没有被添加到提交中， git stash 不会做任何事情。

所以我必须做的是：

```
$ cd /usr/local
$ git add .    # add the unsaved changes homebrew is complaining about
$ git stash    # stash the changes, now that they're in a commit
$ brew update  # update homebrew
$ brew doctor  # running brew doctor now outputs 'raring to brew' 
```

或者，如果您愿意，一次运行所有内容：

```
cd /usr/local/Homebrew && git add . && git stash && git clean -d -f && brew update && brew doctor 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T21:06:51.440

我发现了问题，研究了一个不同的问题。我的电脑安装了旧版本的 git (1.5.6.56.g29b0d)。它位于 /usr/local/bin/git。我下载了安装在 /usr/local/git/bin/git 的最新版本（1.7.11.3）。在调整我的 PATH 以识别新的 git 之后，我能够克服上述错误。

```
brew doctor
Warning: Your Homebrew is outdated
You haven't updated for at least 24 hours, this is a long time in brewland! 
```

然后我能够成功运行 brew update ：

```
brew update
Updated Homebrew from ed127082 to 4a36c56a.
... 
```

现在看来我可以走了：

```
brew doctor
Your system is raring to brew. 
```

# asp.net - asp.net 动态数据实体站点排序行

> ID：12044249
> 
> 赞同：0
> 
> 时间：2012-08-20T19:56:35.243
> 
> 标签：asp.net, entities, asp.net-dynamic-data

我正在开发一个动态数据实体站点的管理区域。我的表有一个名为 OrderID 的 Int 列，它是为我的站点的管理员和前端显示的顺序。asp.net 动态数据站点是否在管理区域中构建了任何内容以允许用户自定义对其行进行排序，例如将更改 orderid 的向上和向下箭头？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:00:53.217

盒子里没有这样的功能。但是您可以更改某些列的显示模板并使用自定义用户控件。

# regex - 正则表达式不正确匹配

> ID：12044252
> 
> 赞同：1
> 
> 时间：2012-08-20T19:56:43.510
> 
> 标签：regex, vb.net, match

首先，如果使用正则表达式甚至是这里的最佳解决方案，我想提出一个意见，我对这个领域相当陌生，正则表达式是我发现的第一件事，而且它似乎有点容易使用，直到我需要长时间一行中的文本部分大声笑。我正在为正则表达式使用 vb.net 环境。

基本上，我在这里采取这条线：

```
21:24:55 "READ/WRITE: ['PASS',false,'27880739',[40,[459.313,2434.11,0.00221252]],[["ItemFlashlight","ItemWatch","ItemMap","ItemKnife","ItemEtool","ItemGPS","ItemHatchet","ItemCompass","ItemMatchbox","M9SD","ItemFlashlightRed","NVGoggles","Binocular_Vector","ItemToolbox","M4A1_AIM_SD_camo"],["ItemPainkiller","ItemMorphine","ItemSodaPepsi","FoodSteakCooked",["30Rnd_556x45_StanagSD",29],"30Rnd_556x45_StanagSD","30Rnd_556x45_StanagSD","30Rnd_556x45_StanagSD","30Rnd_556x45_StanagSD","30Rnd_556x45_StanagSD",["15Rnd_9x19_M9SD",12],["15Rnd_9x19_M9SD",10],"15Rnd_9x19_M9SD","15Rnd_9x19_M9SD","ItemBandage"]],["DZ_Backpack_EP1",[["BAF_AS50_TWS"],[1]],[["FoodSteakCooked","ItemPainkiller","ItemMorphine","ItemSodaCoke","5Rnd_127x99_as50","ItemBloodbag"],[2,1,1,2,4,1]]],[316,517,517],Sniper1_DZ,0.94]" 
```

使用以下正则表达式：

```
\[\[([\w|_|\""|,]*)\],\[([\w|_|\""|,|\[|\]]*)\]\], 
```

尝试获取以下内容：

```
[["ItemFlashlight","ItemWatch","ItemMap","ItemKnife","ItemEtool","ItemGPS","ItemHatchet","ItemCompass","ItemMatchbox","M9SD","ItemFlashlightRed","NVGoggles","Binocular_Vector","ItemToolbox","M4A1_AIM_SD_camo"],["ItemPainkiller","ItemMorphine","ItemSodaPepsi","FoodSteakCooked",["30Rnd_556x45_StanagSD",29],"30Rnd_556x45_StanagSD","30Rnd_556x45_StanagSD","30Rnd_556x45_StanagSD","30Rnd_556x45_StanagSD","30Rnd_556x45_StanagSD",["15Rnd_9x19_M9SD",12],["15Rnd_9x19_M9SD",10],"15Rnd_9x19_M9SD","15Rnd_9x19_M9SD","ItemBandage"]] 
```

但是，要么我的正则表达式有缺陷，要么我的 vb.net 代码有缺陷。它只显示以下数据：

```
[["ItemFlashlight","ItemWatch","ItemMap","ItemKnife","ItemEtool","ItemGPS","ItemHatchet","ItemCompass","ItemMatchbox","M9SD","ItemFlashlightRed","NVGoggles","Binocular_Vector","ItemToolbox","M4A1_AIM_SD_camo"],["ItemPainkiller","ItemMorphine","ItemSodaPepsi", 
```

如果您需要查看它，我的 vb.net 代码是：

```
ListView1.Clear()
    Call initList(Me.ListView1)
    My.Computer.FileSystem.CurrentDirectory = My.Settings.cfgPath
    My.Computer.FileSystem.CopyFile("arma2oaserver.RPT", "tempRPT.txt")
    Dim ScriptLine As String = ""
    Dim path As String = My.Computer.FileSystem.CurrentDirectory & "\tempRPT.txt"
    Dim lines As String() = IO.File.ReadAllLines(path, System.Text.Encoding.Default)
    Dim que = New Queue(Of String)(lines)
    ProgressBar1.Maximum = lines.Count + 1
    ProgressBar1.Value = 0
    Do While que.Count > 0
        ScriptLine = que.Dequeue()
        ScriptLine = LCase(ScriptLine)
        If InStr(ScriptLine, "login attempt:") Then
            Dim rtime As Match = Regex.Match(ScriptLine, ("(\d{1,2}:\d{2}:\d{2})"))
            Dim nam As Match = Regex.Match(ScriptLine, "\""([^)]*)\""")
            Dim name As String = nam.ToString.Replace("""", "")
            Dim next_line As String = que.Peek      'Read next line temporarily                'This is where it would move to next line temporarily to read from it
            next_line = LCase(next_line)
            If InStr(next_line, "read/write:") > 0 Then 'Or InStr(next_line, "update: [b") > 0 Then 'And InStr(next_line, "setmarkerposlocal.sqf") < 1 Then
                Dim coords As Match = Regex.Match(next_line, "\[(\d+)\,\[(-?\d+)\.\d+\,(-?\d+)\.\d+,([\d|.|-]+)\]\]")
                Dim inv As Match = Regex.Match(next_line, "\[\[([\w|_|\""|,]*)\],\[([\w|_|\""|,|\[|\]]*)\]\],") '\[\[([\w|_|\""|,]*)\],\[([\w|_|\""|,|\[|\]]*)\]\],
                '\[\[([\w|_|\""|,]*)\],\[([\w|_|\""|,|\[|\]]*)\]\]:\[([\w|_|\""|,|\[|\]]*)\]\:
                Dim back As Match = Regex.Match(next_line, "\""([\w|_]+)\"",\[\[([\w|_|\""|,]*)\],\[([\d|,]*)\]\],\[\[([\w|_|\""|,]*)\],\[([\d|,]*)\]\]")
                Dim held As Match = Regex.Match(next_line, "\[\""([\w|_|\""|,]+)\""\,\d+\]")
                With Me.ListView1
                    .Items.Add(name.ToString)
                    With .Items(.Items.Count - 1).SubItems
                        .Add(rtime.ToString)
                        .Add(coords.ToString)
                        .Add(inv.ToString)
                        .Add(back.ToString)
                        .Add(held.ToString)
                    End With
                End With
            End If
        End If
        ProgressBar1.Value += 1
    Loop
    My.Computer.FileSystem.DeleteFile("tempRPT.txt")
    ProgressBar1.Value = 0 
```

奇怪的是，当我在 Expresso 中测试我的正则表达式时，它得到了完整、正确的匹配。所以我不知道我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:09:35.993

我不确定你的正则表达式有什么问题，但是这个的第一个匹配似乎工作正常：

```
\[\[.*?\]\] 
```

希望这可以帮助。

-编辑-

问题不在于正则表达式，而在于 ListView 正在截断字符串的显示。[看这里](https://stackoverflow.com/questions/5559704/net-listview-max-number-of-characters-or-maximum-column-width-possible-to-ov)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:23:48.347

试试这个正则表达式：`\Q[[\E(?:(?!\Q[[\E).)+]]`

[http://regex101.com/r/zP1aC5](http://regex101.com/r/zP1aC5)

如果您需要反向引用，请使用`\Q[[\E((?:(?!\Q[[\E).)+)]]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:27:57.450

也许您应该指定是使用单行还是多行输入文本。根据您的输入文本格式，尝试使用：

```
Dim variableName as Match = Regex.Match("input", "pattern", RegexOptions.SingleLine); 
```

或者

```
Dim variableName as Match = Regex.Match("input", "pattern", RegexOptions.Multiline); 
```

# asp.net - 将 SMO 与 Windows 身份验证一起使用时，在 XP 中引发 ConnectionFailureException

> ID：12044257
> 
> 赞同：0
> 
> 时间：2012-08-20T19:57:20.500
> 
> 标签：asp.net, sql-server, windows-xp, windows-authentication, smo

我正在尝试在 ASP.NET Web 项目中使用 SMO 来获取服务器数据库的列表。我使用的方法似乎在 Windows 7 机器上运行良好，但第二次将它安装在 XP 机器上时，我得到了 ConnectionFailureException。我用来建立连接的代码是：

```
 ServerConnection connection = new ServerConnection(serverName);
        Server serverConnection = new Server(connection);
        string[] databases;
        try
        {
            databases = new string[serverConnection.Databases.Count];
        }
        catch { databases = new string[0]; } 
```

在 Windows 7 机器上，我得到一个长度为空的数组，不管有多少数据库，然后我将数据库名称添加到 foreach 循环中，但在 Windows XP 中，它在 try 块中失败，我得到：

```
ConnectionFailureException: Failed to connect to server localhost. 
-> Login failed for user 'ComputerName\\ASPNET'. 
```

我猜这是 ASPNET 用户的某种权限问题，但我似乎找不到任何解决问题的方法。在 IIS 中，我取消选择匿名访问并选择集成 Windows 身份验证，并设置

```
<authentication mode="Windows" /> 
```

在 web.config 中。

有人有任何建议/类似圣人的建议要分享吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T20:22:34.343

您是否希望 Web 应用程序模拟用户连接到 SQL？当您使用 SQL Management Studio 时，您将直接连接到 SQL；当您从 Web 应用程序执行此操作时，您正在调用它，而 IIS 调用您的 SQL。现在的问题是访问 SQL 时 IIS 使用哪个登录名 - 它是否在 W7 下冒充您而在 XP 下不这样做？

确保 XP 不会冒充您并使用错误消息中显示的“ComputerName\ASPNET”。[此处](http://technet.microsoft.com/pl-pl/library/cc730708%28v=ws.10%29.aspx)描述了IIS6 ASPNET 模拟设置，[此处](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/4ec9116c-7ca2-4126-9dc4-b7f82b67cd76.mspx?mfr=true)描述了IIS7 。默认情况下，两个 IIS 模拟都关闭，但我不确定 W7 上的当前配置是什么。也许你应该在 IIS6 下打开它？

# python - 在 paramiko 中使用 python 命令

> ID：12044262
> 
> 赞同：0
> 
> 时间：2012-08-20T19:57:29.610
> 
> 标签：python, ssh, paramiko

我今天一直在使用 Paramiko 来处理 Python SSH 连接，它很有用。

然而，我真正希望能够通过 SSH 做的一件事是利用一些 Pythonic 糖。据我所知，我只能使用内置的 Paramiko 函数，如果我想在远程端使用 Python 进行任何操作，我需要使用我放置在那里的脚本并调用它。

有没有一种方法可以通过 SSH 连接发送 Python 命令，而不必只使用 Paramiko SSH 连接的限制？由于我在 Python 脚本中通过 Paramiko 运行 SSH 连接，所以我可以这样做似乎是正确的，但我看不到这样做的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:14:17.410

[RPyC](http://rpyc.sourceforge.net/index.html)可能是您正在寻找的。它使您可以直接从本地脚本访问另一台机器的 Python 环境。

```
>>> import rpyc
>>> conn = rpyc.classic.connect("someremotehost.com")
>>> conn.modules.sys.path
['D:\\projects\\rpyc\\servers', 'd:\\projects', .....] 
```

要通过 SSL 或 SSH 建立连接，请参阅：

[http://rpyc.sourceforge.net/docs/secure-connection.html#ssl](http://rpyc.sourceforge.net/docs/secure-connection.html#ssl)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:05:39.917

嗯，这就是 SSH 创建的目的——成为一个安全的 shell，并且命令在远程机器上执行（你可以把它想象成你坐在远程计算机本身，但这并不意味着你可以在 shell 中执行 Python 命令，尽管您是在与机器进行物理交互）。

您不能仅仅因为 Python 没有命令而*发送 Python命令，它执行 Python 脚本。*

因此，您可以做的一切都是**“事情”**，它将进行下一步：

1.  将一段 Python 代码包装到文件中。
2.  `scp`它到远程机器。
3.  在那里执行它。
4.  删除脚本（或将其缓存以供进一步执行）。

基本上，shell 命令本身就是远程机器的程序，因此您可以将这些脚本想象成 shell 扩展（例如带有命令行参数的 python 程序）。

# scala - 将 scala.collection.immutable.Set 变量分配给其他变量

> ID：12044268
> 
> 赞同：-2
> 
> 时间：2012-08-20T19:58:19.673
> 
> 标签：scala, set

我有一个这样的 Set 变量

```
val setValues= Set (10,20,30,40) 
```

我想将其中一个分配给其他变量，例如 30。我怎样才能做到这一点？

例如在其他语言中，当我们有数组时，我们可以写

```
int a=array(2) 
```

它会将数组位置 3 的值分配给变量“a”但是如何将“集合”值的位置 2 的值分配给其他变量或检查它是否等于 80？

我尝试了例如 setValues(2), setValues->2 但在这个例子中结果不是 30

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T21:48:58.300

`Set`= 无序集。`Seq`= 可索引序列

```
val seqValues = Seq(10,20,30,40)
seqValues(2) 
```

为了获得更好的性能，请使用`IndexedSeq`访问速度快的。`seqValues(2)`是 的缩写`seqValues.apply(2)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:42:31.160

集合是无序的，所以你需要一些方法来挑选一个特定的元素——但是如果你已经有了那个确切的元素，你就不需要从集合中获取它（你已经得到了它！）。也许

```
val x = Set((0,"fish"),(1,"dish"),(2,"wish")).find(_._1 == 1).get 
```

是你想要的（即`find`，一个遵循完全相等以外的某些条件的元素；如果找到它，它会返回一个`Option`你可以`get`找到的元素）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:01:01.207

琐碎的答案？

```
val value = Set (10,20,30,40)
val variable = 30 
```

您需要更具体地了解用于选择将哪个项目设置为变量的标准。例如，对于 a `Set`，您不能选择第一项或最后一项，因为`Set`s 是无序的。但是，您*可以执行一些操作，例如将变量设置为最大值或最小值：*

```
val variable = value.max 
```

# javascript - 未能创建对 handelbars.js 模板的 ajax 请求

> ID：12044269
> 
> 赞同：0
> 
> 时间：2012-08-20T19:58:23.460
> 
> 标签：javascript, jquery, ajax, datatemplate, handlebars.js

我正在尝试为 handelbars.js 创建一个 AJAX 请求（使用 jQuery）（通过它掌握使用模板的概念。

我有这个数据对象和 ajax 请求：

```
var data = { users: [
  {username: { firstName: "Alan", lastName: "Johnson" } , email: "alan@test.com" },
  {username: { firstName: "Allison", lastName: "House" } , email: "allison@test.com" },
  {username: { firstName: "Ryan", lastName: "Carson" }, email: "ryan@test.com" }
]};

$(document).ready(function(){
    $.get('h1template.js', function(template_text){     
        var template = Handlebars.compile(template_text);
        var html = template(data);
        $('#content').html(html);
    });
}); 
```

这是 h1template.js 的内容：

```
<table>
    <thead>
      <th>Username</th>
      <th>Real Name</th>
      <th>Email</th>
    </thead>
    <tbody>
      {{#users}}
        <tr>
          <td>{{username}}</td>
          <td>{{firstName}} {{lastName}}</td>
          <td>{{email}}</td>
        </tr>
      {{/users}}
    </tbody>
  </table> 
```

**有些事情显然是不对的，因为这不起作用**

怎么了？我对 ajax 调用本身做错了什么傻事吗？称它为“ *.js”而不是“* .php”（例如）？

（我在本地主机中运行该文件，在查看网络属性时，“h1template.js”状态为 304-not-modified）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:08:30.390

因为模板名称是 .js，所以它被解析为 javascript 文件。因此，您需要将其更改为 .html 或 .php 或任何您喜欢的格式。

同样在 users 对象中，用户名是一个对象，所以在模板中输出 {{username}} 只会给你 [object, object]。您需要将其更改为 {{username.name}}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:19:36.527

我玩了一下代码，发现了如何编写它

h1template.html 文件（而不是 *.js"）：

```
<table>
...
</table> 
```

主页中的脚本是：

```
var data = { users: [
      {username: { firstName: "Alan", lastName: "Johnson" } , email: "alan@test.com" },
      {username: { firstName: "Allison", lastName: "House" } , email: "allison@test.com" },
      {username: { firstName: "Ryan", lastName: "Carson" }, email: "ryan@test.com" }
    ]};

$(document).ready(function(){
    $.get('h1template.html', function(template_text){   
        var source   = template_text;
        var template = Handlebars.compile(source);
        var html = template(data);
        $('#content').html(html);
    });
}); 
```

# android - 在android中的xml中创建缩放图像

> ID：12044272
> 
> 赞同：1
> 
> 时间：2012-08-20T19:58:30.487
> 
> 标签：android, scale, android-linearlayout

我有 5 个图像，我想将它们放在水平图像按钮中`LinearLayout`。图像以不同的大小保存在磁盘上，但是放置在布局中时，我希望它们具有相同的高度，但权重不同，分别为 0.5,1,1,1,0.5（即布局的权重总和）是 4)。我尝试使用此代码，但没有成功：

```
 <LinearLayout
    android:id="@+id/linearLayout2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:weightSum="4" >

    <ImageButton
        android:id="@+id/scrollLeft"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/left"
        android:layout_weight="0.5" />

    <ImageButton
        android:id="@+id/dog"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/dog"
        android:layout_weight="1" />

    <ImageButton
        android:id="@+id/fish"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/fish"
        android:layout_weight="1" />

    <ImageButton
        android:id="@+id/cat"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/cat"
        android:layout_weight="1" />

    <ImageButton
        android:id="@+id/scrollRight"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/right"
        android:layout_weight="0.5" />

</LinearLayout> 
```

是否有任何参数`layout_width`并且`layout_height`我可以更改以使其正常工作，或者我是否需要为每个按钮从 java 代码创建一个缩放位图？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:08:41.520

尝试定义相同的高度，然后缩放以保持比例

```
<ImageView
    .... 
    android:layout_height="match_parent"
    android:scaleType="centerInside"
    .... /> 
```

**使用高度进行**编辑**`match_parent`将使`ImageButtons`高度相同并使用保持比例`scaleType`**

# asp.net - 在按钮中执行存储过程

> ID：12044274
> 
> 赞同：0
> 
> 时间：2012-08-20T19:58:35.783
> 
> 标签：asp.net, sql, ado.net

我有一个绑定到存储过程 sp_selectyear 的下拉列表，它显示表中列的不同年份

例如：2010 2011 2012

我想在一个按钮上执行另一个存储过程 sp_deleteyear，该按钮根据下拉列表中选择的年份删除这些行/记录。我该怎么做？

我需要为 sp_selectyear 设置输出参数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:03:07.647

您可以从下拉列表控件的*SelectedValue*属性中提取选定的年份。因此，您应该能够在按钮单击处理程序中调用 *sp_deleteyear*，使用*myDropdownList.SelectedValue*作为存储过程参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:03:33.340

您可以通过 SelectValue 属性使用 c# 从下拉列表中实际获取 id，然后您可以像这样将 at 作为普通参数传递给您的存储过程；

```
CREATE PROC sp_selectyear
(
     @yearId (your datatype)
)
AS

DELETE FROM [TableName]
WHERE [ColiD] = @yearId 
```

**注意：**您不需要使用 OUTPUT 参数。可以使用普通参数处理。

# ruby-on-rails - 导轨路由。单一资源

> ID：12044275
> 
> 赞同：2
> 
> 时间：2012-08-20T19:58:37.080
> 
> 标签：ruby-on-rails

我有 Rails 路由问题。我想将单一资源与用户控制器一起使用，但它没有按我预期的那样工作。这是我的 routes.rb 文件的片段：

```
scope :module => "frontend" do
  root :to => "home#index"
  resource :user, :controller => "user"
  get "/sign_up" => "user#new"
  get "/sign_in" => "user#sign_in"
  get "/sign_out" => "user#sign_out"
  post "/authenticate" => "user#authenticate"
  resources :articles
  resources :article_categories
end 
```

我认为当我使用例如“/user”或“/user/new”URL时它会起作用，但它没有。我收到路由错误：

```
No route matches {:controller=>"frontend/user"} 
```

'rake routes' 命令输出为：

```
 user POST   /user(.:format)          frontend/user#create
 new_user GET    /user/new(.:format)      frontend/user#new
edit_user GET    /user/edit(.:format)     frontend/user#edit
          GET    /user(.:format)          frontend/user#show
          PUT    /user(.:format)          frontend/user#update
          DELETE /user(.:format)          frontend/user#destroy
  sign_up GET    /sign_up(.:format)       frontend/user#new
  sign_in GET    /sign_in(.:format)       frontend/user#sign_in
 sign_out GET    /sign_out(.:format)      frontend/user#sign_out 
```

验证 POST /authenticate(.:format) 前端/用户#authenticate

有趣的是，当我在用户控制器中为索引操作添加路由时，如下所示：

```
scope :module => "frontend" do
  root :to => "home#index"
  resource :user, :controller => "user"
  get "/user" => "user#index"
  get "/sign_up" => "user#new"
  get "/sign_in" => "user#sign_in"
  get "/sign_out" => "user#sign_out"
  post "/authenticate" => "user#authenticate"
  resources :articles
  resources :article_categories
end 
```

...有用！

但是用户控制器中没有定义索引操作！'rake routes' 命令为 GET /user 返回双行

```
 GET    /user(.:format)          frontend/user#show
          GET    /user(.:format)          frontend/user#index 
```

所以我想这不是解决方案。分配给“/users”URL 的其他操作不起作用。

是否有必要为索引操作定义路由，例如

```
get "/controller_name" => "controller_name#index" 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T20:31:31.363

在您的路由中定义单一资源不会生成指向索引操作的路由。单一资源意味着您总是要在不指定 ID 的情况下查找该资源，因此获取单一资源的索引没有逻辑意义。因此，对您的 url "/user" 的 GET 将路由到该单一资源而不是索引的显示操作。

编辑：由于您的问题并不明显，我会简化您的路线，直到您至少可以点击您期望的控制器，然后从那里构建。

**配置/路由.rb**

```
 scope :module=>"frontend" do
   resource :user
 end
 #ensure you don't have any other user routes listed before this that would match "/user". 
```

**应用程序/控制器/前端/users_controller.rb**

```
 module Frontend
   class UsersController < ApplicationController
     def show
       raise "in frontend/show"
     end
   end
 end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-24T12:02:23.017

非常感谢您的帮助！我发现了这个错误。

路由错误是由布局 html 文件的以下行引起的

```
<%= auto_discovery_link_tag(:rss, {:action => "index"}, {:title => "RSS"}) %> 
```

我正在寻找 erb 视图文件中的错误，但我忘记了布局。在这种情况下，我必须记得检查整个视图层。

# javascript - 如何验证使用 ng-repeat、ng-show (angular) 动态创建的输入

> ID：12044277
> 
> 赞同：170
> 
> 时间：2012-08-20T19:58:37.657
> 
> 标签：javascript, html, angularjs, validation, grid

我有一个使用 ng-repeat 创建的表。我想为表中的每个元素添加验证。问题是每个输入单元格与它上面和下面的单元格具有相同的名称。我尝试使用该`{{$index}}`值来命名输入，但尽管 HTML 中的字符串文字看起来正确，但它现在正在工作。

这是我现在的代码：

```
<tr ng-repeat="r in model.BSM ">
   <td>
      <input ng-model="r.QTY" class="span1" name="QTY{{$index}}" ng-pattern="/^[\d]*\.?[\d]*$/" required/>
      <span class="alert-error" ng-show="form.QTY{{$index}}.$error.pattern"><strong>Requires a number.</strong></span>
      <span class="alert-error" ng-show="form.QTY{{$index}}.$error.required"><strong>*Required</strong></span>
   </td>
</tr> 
```

我试过`{{}}`从索引中删除，但这也不起作用。截至目前，输入的验证属性工作正常，但未显示错误消息。

有人有什么建议吗？

**编辑：**除了下面的好答案之外，这里有一篇博客文章更详细地介绍了这个问题：[http ://www.thebhwgroup.com/blog/2014/08/angularjs-html-form-design-part-2 /](http://www.thebhwgroup.com/blog/2014/08/angularjs-html-form-design-part-2/)

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2015-10-02T12:27:46.370

自从提出这个问题以来，Angular 团队通过动态创建输入名称解决了这个问题。

使用**Angular 1.3 及更高版本，**您现在可以这样做：

```
<form name="vm.myForm" novalidate>
  <div ng-repeat="p in vm.persons">
    <input type="text" name="person_{{$index}}" ng-model="p" required>
    <span ng-show="vm.myForm['person_' + $index].$invalid">Enter a name</span>
  </div>
</form> 
```

[演示](http://plnkr.co/edit/50IwsP?p=preview)

Angular 1.3 还引入了 ngMessages，一个更强大的表单验证工具。您可以对 ngMessages 使用相同的技术：

```
<form name="vm.myFormNgMsg" novalidate>
    <div ng-repeat="p in vm.persons">
      <input type="text" name="person_{{$index}}" ng-model="p" required>
      <span ng-messages="vm.myFormNgMsg['person_' + $index].$error">
        <span ng-message="required">Enter a name</span>
      </span>
    </div>
  </form> 
```

* * *

## 回答 #2

> 赞同：197
> 
> 时间：2012-08-20T20:24:29.823

AngularJS 依赖输入名称来暴露验证错误。

不幸的是，截至今天，动态生成输入名称是不可能的（不使用自定义指令）。事实上，检查[输入文档](http://docs.angularjs.org/api/angular.module.ng.$compileProvider.directive.input)我们可以看到 name 属性只接受一个字符串。

要解决“动态名称”问题**，您需要创建一个内部表单（参见[ng-form](http://docs.angularjs.org/api/ng.directive:ngForm)）**：

```
<div ng-repeat="social in formData.socials">
      <ng-form name="urlForm">
            <input type="url" name="socialUrl" ng-model="social.url">
            <span class="alert error" ng-show="urlForm.socialUrl.$error.url">URL error</span>
      </ng-form>
  </div> 
```

另一种选择是为此编写自定义指令。

这是显示 ngForm 用法的 jsFiddle：http: [//jsfiddle.net/pkozlowski_opensource/XK2ZT/2/](http://jsfiddle.net/pkozlowski_opensource/XK2ZT/2/)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-06-28T20:00:52.570

如果您不想使用 ng-form，您可以使用自定义指令来更改表单的 name 属性。将此指令作为属性放置在与您的 ng-model 相同的元素上。

如果您同时使用其他指令，请注意它们没有设置“终端”属性，否则此函数将无法运行（假设它的优先级为 -1）。

例如，当将此指令与 ng-options 一起使用时，您必须运行这一行monkeypatch： [https ://github.com/AlJohri/bower-angular/commit/eb17a967b7973eb7fc1124b024aa8b3ca540a155](https://github.com/AlJohri/bower-angular/commit/eb17a967b7973eb7fc1124b024aa8b3ca540a155)

```
angular.module('app').directive('fieldNameHack', function() {
    return {
      restrict: 'A',
      priority: -1,
      require: ['ngModel'],
      // the ngModelDirective has a priority of 0.
      // priority is run in reverse order for postLink functions.
      link: function (scope, iElement, iAttrs, ctrls) {

        var name = iElement[0].name;
        name = name.replace(/\{\{\$index\}\}/g, scope.$index);

        var modelCtrl = ctrls[0];
        modelCtrl.$name = name;

      }
    };
}); 
```

我经常发现使用 ng-init 将 $index 设置为变量名很有用。例如：

```
<fieldset class='inputs' ng-repeat="question questions" ng-init="qIndex = $index"> 
```

这会将您的正则表达式更改为：

```
name = name.replace(/\{\{qIndex\}\}/g, scope.qIndex); 
```

如果您有多个嵌套的 ng-repeats，您现在可以使用这些变量名而不是 $parent.$index。

指令的“终端”和“优先级”的定义：[https](https://docs.angularjs.org/api/ng/service/) ://docs.angularjs.org/api/ng/service/ $compile#directive-definition-object

关于需要 ng-option monkeypatch 的 Github 评论： [https ://github.com/angular/angular.js/commit/9ee2cdff44e7d496774b340de816344126c457b3#commitcomment-6832095](https://github.com/angular/angular.js/commit/9ee2cdff44e7d496774b340de816344126c457b3#commitcomment-6832095) [https://twitter.com/aljohri/status/482963541520314369](https://twitter.com/aljohri/status/482963541520314369)

更新：

您也可以使用 ng-form 来完成这项工作。

```
angular.module('app').directive('formNameHack', function() {
    return {
      restrict: 'A',
      priority: 0,
      require: ['form'],
      compile: function() {
        return {
          pre: function(scope, iElement, iAttrs, ctrls) {
            var parentForm = $(iElement).parent().controller('form');
            if (parentForm) {
                var formCtrl = ctrls[0];
                delete parentForm[formCtrl.$name];
                formCtrl.$name = formCtrl.$name.replace(/\{\{\$index\}\}/g, scope.$index);
                parentForm[formCtrl.$name] = formCtrl;
            }
          }
        }
      }
    };
}); 
```

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2014-06-20T19:59:18.647

在使用 ng-repeat 指令的标签内使用 ng-form 指令。然后，您可以使用 ng-form 指令创建的范围来引用通用名称。例如：

```
 <div class="form-group col-sm-6" data-ng-form="subForm" data-ng-repeat="field in justificationInfo.justifications"">

        <label for="{{field.label}}"><h3>{{field.label}}</h3></label>
        <i class="icon-valid" data-ng-show="subForm.input.$dirty && subForm.input.$valid"></i>
        <i class="icon-invalid" data-ng-show="subForm.input.$dirty && subForm.input.$invalid"></i>
        <textarea placeholder="{{field.placeholder}}" class="form-control" id="{{field.label}}" name="input" type="text" rows="3" data-ng-model="field.value" required>{{field.value}}</textarea>

    </div> 
```

归功于：[http ://www.benlesh.com/2013/03/angular-js-validating-form-elements-in.html](http://www.benlesh.com/2013/03/angular-js-validating-form-elements-in.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-02-11T01:05:12.857

[在控制器http://jsfiddle.net/82PX4/3/](http://jsfiddle.net/82PX4/3/)一侧添加了带有“自定义验证”的更复杂示例

```
<div class='line' ng-repeat='line in ranges' ng-form='lineForm'>
    low: <input type='text' 
                name='low'
                ng-pattern='/^\d+$/' 
                ng-change="lowChanged(this, $index)" ng-model='line.low' />
    up: <input type='text' 
                name='up'
                ng-pattern='/^\d+$/'
                ng-change="upChanged(this, $index)" 
                ng-model='line.up' />
    <a href ng-if='!$first' ng-click='removeRange($index)'>Delete</a>
    <div class='error' ng-show='lineForm.$error.pattern'>
        Must be a number.
    </div>
    <div class='error' ng-show='lineForm.$error.range'>
        Low must be less the Up.
    </div>
</div> 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-04T17:57:18.460

查看这些解决方案，上面 Al Johri 提供的解决方案最符合我的需求，但他的指令没有我想要的可编程性。这是我对他的解决方案的版本：

```
angular.module("app", [])
    .directive("dynamicFormName", function() {
        return {
            restrict: "A",
            priority: 0,
            require: ["form"],
            compile: function() {
                return {
                    pre: function preLink(scope, iElement, iAttrs, ctrls) {
                        var name = "field" + scope.$index;

                        if (iAttrs.dnfnNameExpression) {
                            name = scope.$eval(iAttrs.dnfnNameExpression);
                        }

                        var parentForm = iElement.parent().controller("form");
                        if (parentForm) {
                            var formCtrl = ctrls[0];
                            delete parentForm[formCtrl.$name];
                            formCtrl.$name = name;
                            parentForm[formCtrl.$name] = formCtrl;
                        }
                    }
                 }
            }
        };
   }); 
```

此解决方案让您只需将名称生成器表达式传递给指令，并避免锁定到他正在使用的模式替换。

我最初在使用这个解决方案时也遇到了麻烦，因为它没有显示在标记中使用它的示例，所以这就是我使用它的方式。

```
<form name="theForm">
    <div ng-repeat="field in fields">
        <input type="number" ng-form name="theInput{{field.id}}" ng-model="field.value" dynamic-form-name dnfn-name-expression="'theInput' + field.id">        
    </div>
</form> 
```

我在[github](https://github.com/squareplanetdesign/Angular-Dynamic-Forms)上有一个更完整的工作示例。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-07-07T18:55:36.697

如果我使用以下语法，验证正在使用 ng repeat`scope.step3Form['item[107][quantity]'].$touched` 我不知道这是最佳实践或最佳解决方案，但它有效

```
<tr ng-repeat="item in items">
   <td>
        <div class="form-group">
            <input type="text" ng-model="item.quantity" name="item[<% item.id%>][quantity]" required="" class="form-control" placeholder = "# of Units" />
            <span ng-show="step3Form.$submitted || step3Form['item[<% item.id %>][quantity]'].$touched">
                <span class="help-block" ng-show="step3Form['item[<% item.id %>][quantity]'].$error.required"> # of Units is required.</span>
            </span>
        </div>
    </td>
</tr> 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-08-28T03:41:18.427

在 pkozlowski.opensource 的[答案](https://stackoverflow.com/a/12044600/756177)的基础上，我添加了一种动态输入名称的方法，该名称也可以与[ngMessages](https://docs.angularjs.org/api/ngMessages/directive/ngMessages)一起使用。注意元素`ng-init`上的`ng-form`部分和`furryName`. `furryName`成为包含`input`'`name`属性的变量值的变量名。

```
<ion-item ng-repeat="animal in creatures track by $index">
<ng-form name="animalsForm" ng-init="furryName = 'furry' + $index">
        <!-- animal is furry toggle buttons -->
        <input id="furryRadio{{$index}}"
               type="radio"
               name="{{furryName}}"
               ng-model="animal.isFurry"
               ng-value="radioBoolValues.boolTrue"
               required
                >
        <label for="furryRadio{{$index}}">Furry</label>

        <input id="hairlessRadio{{$index}}"
               name="{{furryName}}"
               type="radio"
               ng-model="animal.isFurry"
               ng-value="radioBoolValues.boolFalse"
               required
               >
        <label for="hairlessRadio{{$index}}">Hairless</label>

        <div ng-messages="animalsForm[furryName].$error"
             class="form-errors"
             ng-show="animalsForm[furryName].$invalid && sectionForm.$submitted">
            <div ng-messages-include="client/views/partials/form-errors.ng.html"></div>
        </div>
</ng-form>
</ion-item> 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-10-01T07:13:01.727

这是我如何做到这一点的一个例子，我不知道它是否是最好的解决方案，但效果很好。

首先，HTML 中的代码。看看 ng-class，它正在调用 hasError 函数。还要查看输入的名称声明。我使用 $index 创建不同的输入名称。

```
<div data-ng-repeat="tipo in currentObject.Tipo"
    ng-class="{'has-error': hasError(planForm, 'TipoM', 'required', $index) || hasError(planForm, 'TipoM', 'maxlength', $index)}">
    <input ng-model="tipo.Nombre" maxlength="100" required
        name="{{'TipoM' + $index}}"/> 
```

现在，这里是 hasError 函数：

```
$scope.hasError = function (form, elementName, errorType, index) {
           if (form == undefined
               || elementName == undefined
               || errorType == undefined
               || index == undefined)
               return false;

           var element = form[elementName + index];
           return (element != null && element.$error[errorType] && element.$touched);
       }; 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2017-01-24T15:38:10.860

为时已晚，但可能对任何人都有帮助

1.  为每个控件创建唯一名称
2.  使用验证`fromname[uniquname].$error`

示例代码：

```
<input 
    ng-model="r.QTY" 
    class="span1" 
    name="QTY{{$index}}" 
    ng-pattern="/^[\d]*\.?[\d]*$/" required/>
<div ng-messages="formName['QTY' +$index].$error"
     ng-show="formName['QTY' +$index].$dirty || formName.$submitted">
   <div ng-message="required" class='error'>Required</div>
   <div ng-message="pattern" class='error'>Invalid Pattern</div>
</div> 
```

在此处查看工作[演示](http://www.advancesharp.com/blog/1208/dynamic-angular-forms-validation-in-ngrepeat-with-ngmessage-and-live-demo)

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-06-16T11:41:05.460

如果您使用 ng-repeat $index 像这样工作

```
 name="QTY{{$index}}" 
```

和

```
 <td>
       <input ng-model="r.QTY" class="span1" name="QTY{{$index}}" ng-            
        pattern="/^[\d]*\.?[\d]*$/" required/>
        <span class="alert-error" ng-show="form['QTY' + $index].$error.pattern">
        <strong>Requires a number.</strong></span>
        <span class="alert-error" ng-show="form['QTY' + $index].$error.required">
       <strong>*Required</strong></span>
    </td> 
```

我们必须在 ng-pattern 中显示 ng-show

```
 <span class="alert-error" ng-show="form['QTY' + $index].$error.pattern">
   <span class="alert-error" ng-show="form['QTY' + $index].$error.required"> 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-11-22T01:20:19.443

这是可能的，这就是我如何使用输入表做同样的事情。

把桌子包成这样的形式

然后就用这个

我有一个包含多嵌套指令的表单，这些指令都包含输入、选择等......这些元素都包含在 ng-repeats 和动态字符串值中。

这是如何使用该指令：

```
<form name="myFormName">
  <nested directives of many levels>
    <your table here>
    <perhaps a td here>
    ex: <input ng-repeat=(index, variable) in variables" type="text"
               my-name="{{ variable.name + '/' + 'myFormName' }}"
               ng-model="variable.name" required />
    ex: <select ng-model="variable.name" ng-options="label in label in {{ variable.options }}"
                my-name="{{ variable.name + index + '/' + 'myFormName' }}"
        </select>
</form> 
```

注意：如果您可能需要序列化输入表，您可以添加和索引字符串连接；这就是我所做的。

```
app.directive('myName', function(){

  var myNameError = "myName directive error: "

  return {
    restrict:'A', // Declares an Attributes Directive.
    require: 'ngModel', // ngModelController.

    link: function( scope, elem, attrs, ngModel ){
      if( !ngModel ){ return } // no ngModel exists for this element

      // check myName input for proper formatting ex. something/something
      checkInputFormat(attrs);

      var inputName = attrs.myName.match('^\\w+').pop(); // match upto '/'
      assignInputNameToInputModel(inputName, ngModel);

      var formName = attrs.myName.match('\\w+$').pop(); // match after '/'
      findForm(formName, ngModel, scope);
    } // end link
  } // end return

  function checkInputFormat(attrs){
    if( !/\w\/\w/.test(attrs.rsName )){
      throw myNameError + "Formatting should be \"inputName/formName\" but is " + attrs.rsName
    }
  }

  function assignInputNameToInputModel(inputName, ngModel){
    ngModel.$name = inputName
  }

  function addInputNameToForm(formName, ngModel, scope){
    scope[formName][ngModel.$name] = ngModel; return
  }

  function findForm(formName, ngModel, scope){
    if( !scope ){ // ran out of scope before finding scope[formName]
      throw myNameError + "<Form> element named " + formName + " could not be found."
    }

    if( formName in scope){ // found scope[formName]
      addInputNameToForm(formName, ngModel, scope)
      return
    }
    findForm(formName, ngModel, scope.$parent) // recursively search through $parent scopes
  }
}); 
```

这应该可以处理许多您只是不知道表单在哪里的情况。或者您可能有嵌套的表单，但出于某种原因，您想将此输入名称附加到两个表单上？好吧，只需传入要附加输入名称的表单名称。

我想要的是一种将动态值分配给我永远不会知道的输入的方法，然后只需调用 $scope.myFormName.$valid。

你可以添加任何你想要的东西：更多的表格更多的表单输入，嵌套的表单，任何你想要的。只需传递您要验证输入的表单名称。然后在表单提交时询问 $scope.yourFormName.$valid

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-05-04T13:38:52.883

这将使 ng-repeat 中的名称在表单验证中单独出现。

```
<td>
    <input ng-model="r.QTY" class="span1" name="{{'QTY' + $index}}" ng-pattern="/^[\d]*\.?[\d]*$/" required/>
</td> 
```

但是我很难让它在其验证消息中查找，所以我不得不使用 ng-init 来让它将变量解析为对象键。

```
<td>
    <input ng-model="r.QTY" class="span1" ng-init="name = 'QTY' + $index" name="{{name}}" ng-pattern="/^[\d]*\.?[\d]*$/" required/>
    <span class="alert-error" ng-show="form[name].$error.pattern"><strong>Requires a number.</strong></span>
    <span class="alert-error" ng-show="form[name].$error.required"><strong>*Required</strong></span> 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2016-10-28T01:57:15.167

我的要求与原始问题中提出的要求有些不同，但希望我可以帮助遇到与我相同问题的人..

我必须根据范围变量定义是否需要字段。所以我基本上必须设置`ng-required="myScopeVariable"`（这是一个布尔变量）。

```
<div class="align-left" ng-repeat="schema in schemas">
    <input type="text" ng-required="schema.Required" />
</div> 
```

# javascript - 下载而不是执行

> ID：12044283
> 
> 赞同：1
> 
> 时间：2012-08-20T19:58:59.533
> 
> 标签：javascript, internet-explorer, jsp, download

我们有旧版 IBM 寄存器，它们使用一个非常古老的浏览器，称为“ICE”。它有一个收据打印机连接并正在运行。

我们有带有 Internet Explorer 8 的新 Windows XP 寄存器。它连接了一个收据打印机并正在运行。jsp - d

我有一台装有 Internet Explorer 8 的 Windows XP 机器。它有一个可用的网络打印机并且正在运行。

* * *

我们有一个带有一些 javascript 的 HTML 页面

```
document.form1.target = 'frameProcess';
document.form1.action = (jspFolder + 'TransferPrintOutput.jsp');
document.form1.submit(); 
```

* * *

这个 .jsp 文件执行了大量的*response.getWriter().println(...)*语句。

当 HTML 页面加载到 ICE 浏览器（来自旧版 IBM 寄存器）时，.jsp 页面会按预期运行，并将输出发送到打印机。

当 HTML 页面加载到 Windows 寄存器或我的 Windows PC 上时，浏览器会出现打开/保存/取消对话框。

JSP 页面位于服务器上的“Tomcat”目录中，我一直在阅读有关 Tomcat 将 JSP 托管到 Windows 客户端的许多问题。

如何让 JSP 运行而不是下载？

* * *

我刚刚[在一个地方](http://www.daniweb.com/web-development/jsp/threads/64219/how-to-execute-jsp-file)读到需要在客户端上运行 Tomcat，我认为这会导致这个问题，但很难相信。

# javascript - 寻找好的标签库

> ID：12044286
> 
> 赞同：5
> 
> 时间：2012-08-20T19:59:11.730
> 
> 标签：javascript, tags

我正在寻找一个好的标签库。我希望拥有 Ajax、自动完成功能，并且能够为每个标签存储值和标签。我找到了一些有前途的，但我无法根据我的需要进行开发。我广泛研究的一个如下：

[http://textextjs.com/](http://textextjs.com/)

我无法提交值和标签，它只接受标签作为值。有没有其他图书馆可以包含我正在寻找的东西？或者上面的库有什么我缺少的吗？我正在阅读它的文档，但无法让它接受标签和价值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T20:02:06.273

试试这个。它很灵活，您可以更改它以供自己使用。它也有一个缓存设施。

[jQuery 令牌输入](http://loopj.com/jquery-tokeninput/)

# facebook - 跨不同平台的 facebook 用户访问令牌

> ID：12044288
> 
> 赞同：9
> 
> 时间：2012-08-20T19:59:24.963
> 
> 标签：facebook, user-accounts, facebook-access-token

我想知道通过一个平台收到的用户访问令牌是否可用于通过另一个平台访问和拨打 Facebook 电话。

例如：

我有一个可以一起工作的移动应用程序和一个 Web 服务器。用户通过移动应用程序上的 facebook 登录（通过单点登录）。然后，用户以内部服务要求对 facebook 进行外部服务调用的方式使用移动应用程序。内部服务将此中继到 Web 服务器，然后 Web 服务器对 facebook 进行实际调用。

工作流程：

*   用户登录移动应用

*   移动应用程序向 Web 服务器发送所需的用户访问令牌 + 服务调用

*   Web 服务器对 facebook 进行外部调用并将信息返回到移动应用程序。

所以简而言之，移动应用程序不是在拨打 Facebook 电话，而是在网络服务器上。

我的问题是，如果我通过移动应用程序对用户进行身份验证，我可以传递（并存储）用户访问令牌并使用它通过网络服务器调用 facebook 吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-09-20T19:57:10.133

答案是肯定的。

我已经通过使用 Facebook 身份验证的移动 SDK（Android 和 iOS）成功完成了此操作以获取访问令牌，然后将此访问令牌传递给 PHP Web 应用程序，该应用程序成功地将其与 PHP SDK 客户端库一起使用。

访问令牌也是唯一需要传输的信息。

只要两个客户端上的应用程序密钥和秘密相同，访问令牌就应该在任何一个上都有效。

# c# - 在另一个程序中访问选定的文本

> ID：12044294
> 
> 赞同：0
> 
> 时间：2012-08-20T20:00:06.073
> 
> 标签：c#, shell, text

> **可能重复：**
> [应用程序如何挂钩到系统范围内的文本选择？](https://stackoverflow.com/questions/3526483/how-can-an-app-hook-into-text-selection-system-wide)

我将创建一个查找程序，它的运行方式可能类似于 Windows Shell 类型的应用程序。在 Outlook 中，我将选择一个 ID 号（文本），我的应用程序需要接受它作为参数来处理它。

如何在全局 (Windows) 范围内访问选定的文本？

我的解决方法可能是执行复制操作，然后读取剪贴板的内容。但如果可能的话，我想保持免费。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T03:48:43.163

请参阅此线程中的解决方案：[Copy Selected Text from any window](http://social.msdn.microsoft.com/Forums/en/winformsapplications/thread/1dc356e6-9441-44de-9eda-247003fa6ef5)

基本上，您将需要使用 PInovoke 从活动窗口中获取选定的文本。此外，您可以设置 Windows 键绑定来运行您的应用程序并触发操作。这种方法的额外好处是适用于所有应用程序，而不仅仅是 Outlook。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:14:54.053

1.  您可以使用 spy++ 在要获取 ID 的控件上设置目标
    1.  使用 API 窗口
        `[DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)] static extern int GetWindowText(IntPtr hWnd, StringBuilder lpString, int nMaxCount)`；它允许您从控件（文本框或其他标题）中获取文本

# php - 如何显示 Wordpress 子菜单？

> ID：12044295
> 
> 赞同：0
> 
> 时间：2012-08-20T20:00:10.893
> 
> 标签：php, wordpress, menu

我有一个“关于我们”页面，它有两个子页面。在我的 WP 模板 functions.php 中，我使用以下命令输出页面的标题：

```
if (is_page() && !is_front_page()) { ?>
   <h1 class="entry-title"><?php the_title(); ?></h1>
} 
```

我想在标题旁边列出子页面名称和链接，但我不知道从哪里开始。

如果您能指出正确的方向，我将不胜感激！

/伊斯梅尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T08:23:37.607

找到了答案！

```
 <?php
          if($post->post_parent)
          $children = wp_list_pages("title_li=&child_of=".$post->post_parent."&echo=0");
          else
          $children = wp_list_pages("title_li=&child_of=".$post->ID."&echo=0");
          if ($children) {
          $parent_title = get_the_title($post->post_parent);?>
          <span class="entry-title">/</span>
          <ul class="custom-sub-menu">
            <li><a href="<?php echo get_permalink($post->post_parent) ?>"><?php echo $parent_title;?></a></li>
          <?php echo $children; ?>
        <?php } ?>
          </ul> 
```

# format - 我们是否需要像二进制格式一样具有相同格式的所有功能？

> ID：12044296
> 
> 赞同：0
> 
> 时间：2012-08-20T20:00:11.627
> 
> 标签：format, weka

最近我开始使用 Weka Explorer 来解决分类问题。我有两种类型的功能

1.  大约 1200 个特征具有值为 {0,1} 的二进制特征
2.  大约 30 个特征具有一些数字整数值，例如 1213。

目前我正在使用朴素贝叶斯分类器。

我的问题是：为了获得更好的分类结果，我是否需要将所有功能都设置为与二进制格式相同的格式？

现在我正在使用 weka 无监督过滤器[NumericToBinary](http://weka.sourceforge.net/doc.dev/weka/filters/unsupervised/attribute/NumericToBinary.html)将所有数字特征转换为二进制特征。这是正确的方法吗？

任何指导都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T08:04:14.330

Weka 资源管理器界面可以快速确定分类器的能力。选择您的分类器并单击其名称。从该界面单击到功能按钮，请参见下图。

![Weka 分类器功能](../Images/57953e6bbeda1ff4dd846ce3dacc5b3e.png)

朴素贝叶斯能力如下。

> CAPABILITIES Class -- 标称类、二进制类、缺失类值
> 
> 属性 -- 数值属性、二元属性、缺失值、空标称属性、标称属性、一元属性
> 
> 额外的最小实例数：0

如您所见，它可以处理数字属性，因此您无需使用过滤器将数字属性更改为二进制。如果它可以提高分类器的性能，请使用此过滤器。

# c# - 令人费解的 API 限制

> ID：12044298
> 
> 赞同：3
> 
> 时间：2012-08-20T20:00:38.693
> 
> 标签：c#, multithreading, for-loop, revit

API 不正式支持线程（见下文）或关闭活动文档的方法。也就是说，关闭活动文档的解决方法是调用...

```
SendKeys.SendWait("^{F4}"); 
```

...来自一个单独的线程。这很好用，除了我需要循环打开和关闭几个文档。如果我在线程之后放置任何代码，它将在关闭前一个文档之前运行它。我尝试了许多标准线程回调方法，包括...

```
Task.Factory.StartNew(() =>

ThreadPool.QueueUserWorkItem(new WaitCallback

AutoResetEvent.WaitOne() 
```

没有运气。Thread.Sleep() 只是停止错误/崩溃。有没有人有任何想法。

“Revit 的内部仅在少数选定的隔离位置使用多处理。这些位置目前都不包含 Revit API 中的代码或其任何部分。因此 Autodesk 不建议从同时执行的内部对 Revit API 进行任何调用并行线程。可能是 Revit API 的某些部分足够隔离，以便能够在测试环境中从此类线程代码中成功执行；这不应被视为保证相同的源代码适用于任何模型或情况，或者 Revit 中的未来更改不会导致此代码停止运行。”

```
 public void OpenFile()
    {
        for (int i = 0; i < 3; i++)
        {
            uiApp.OpenAndActivateDocument(TargetPath(i));

            ThreadPool.QueueUserWorkItem(CloseDocProc);

            //any code here at all opens the next doc without closing the last
        }            
    }

    public void CloseDocProc(object stateInfo)
    {
        SendKeys.SendWait("^{F4}");

        //can run code here
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T20:18:08.693

就像他们说的那样，问题出在线程上。使用任何回调方法，它都会在此时冻结。而且你只能在线程中做有限的事情，它不会让我打开一个文件，无论如何！

答案是使用单线程计时器。

```
System.Windows.Forms.Timer; 
```

每 10 秒左右调用一次我的 Open() 方法，并在计数器达到某个点时停止计时器并运行最后一位代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-23T15:20:29.477

不确定它是否可以解决问题，但您也许可以使用这种技术：[http ://adndevblog.typepad.com/autocad/2012/06/use-thread-for-background-processing.html](http://adndevblog.typepad.com/autocad/2012/06/use-thread-for-background-processing.html)

它适用于 AutoCAD，但我认为它可以与 Revit 一起使用。Revit API 和 AutoCAD 一样，不支持多线程。您应该只从主线程调用 API 函数。

如果事实，您需要将调用编组到主线程。实现这一点的最简单方法是在主线程上创建一个 System.Windows.Forms.Control 对象，并从您要关闭文档的单独线程调用其 Invoke()。

或者您也可以创造性地使用空闲事件...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-24T15:31:37.553

在您的应用空闲事件处理程序中创建一个与您的线程交互并处理 revit 调用的状态机。

# asp.net - 最佳实践 - 何时使用服务器/客户端代码

> ID：12044303
> 
> 赞同：-1
> 
> 时间：2012-08-20T20:00:57.327
> 
> 标签：asp.net, ajax, client-server

我正在搜索有关我的疑问之一的信息，但找不到任何信息。我在*ASP.NET*站点工作并使用*AJAX*来要求数据，因为我目前正在自己​​工作，所以我不知道 Web 编程的最佳实践。

我通常从服务器获取我需要的所有信息，并使用 Javascript 显示/修改它并使用*AJAX*将其发送回服务器。我的一个朋友在大部分编程中使用 PHP，他很少使用任何 javascript，他告诉我这种方式更快，因为它不消耗客户端的资源。

基本问题实际上是：

> 根据最佳实践，服务器最好只提供应用程序所需的数据，还是将服务器用于更多用途？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:10:57.097

这将取决于网站的预期流量、生成的内容量以及最终用户的期望。

在高流量站点中，如果您让 javascript 在客户端生成部分内容，对于最终用户来说实际上“更快”。此外，与将内容完全加载到服务器上相比，您可以通过客户端脚本在较长的加载时间下提供更好的用户体验。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:11:59.187

在大多数情况下，您至少需要一些后端代码。例如，在验证用户输入或从真正的持久数据库中检索信息时。或者，如果有人在他的用户代理中禁用了 javascript，或者有人在使用屏幕阅读器或搜索引擎爬虫时会怎样？

恕我直言，您至少应该（同样在大多数情况下）拥有能够完成所有工作并向客户端吐出完整网页的后端代码。除此之外，您可以添加 javascript 功能以使用户界面“更流畅”，例如在将用户数据提交到服务器之前验证用户数据（请记住始终检查服务器端）或加载部分 html (AJAX)。

在服务器端执行此操作时更快或使用更少资源的观点没有多大意义。即使这样做也没关系（但我再次高度怀疑这种说法）。如果您使用客户端脚本仅加载所需的部分，则宁愿在客户端和服务器端使用更少的资源。

# vb.net - 更改数据网格中每个单元格的背景颜色

> ID：12044306
> 
> 赞同：-1
> 
> 时间：2012-08-20T20:01:02.560
> 
> 标签：vb.net, winforms, printing, datagridview

在我弄清楚如何使用 RGB 值更改不同单元格的边框颜色以生成随机颜色之后，我现在也想更改每个单元格的背景颜色。这是为了`DataGridView`. 下面是我的相关代码，它允许我更改单元格边框颜色，现在该代码中的某处有一种更改每个单元格背景颜色的方法，但我不熟悉此代码，因为它来自免费软件。有谁知道我必须在这段代码中更改什么来影响每个单元格的背景颜色？

这是我的代码：

[http://pastebin.com/WNBReUys](http://pastebin.com/WNBReUys)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T23:10:30.217

打印背景颜色的解决方案类似于钢笔解决方案，只是您需要使用画笔，通常是`SolidBrush`：

```
Dim brushColor as New SolidBrush(someColor)

e.Graphics.FillRectangle(brushColor ,_
                         New Rectangle(ColumnLeft(ColPage, ColAt), _
                                       tmpTop, _
                                       ColumnWidth(ColPage, ColAt), _
                                       CellHeight)) 
```

请注意，由于您在此矩形上绘制文本和其他图形，因此您可能希望先绘制背景颜色，然后再绘制所有其他图形。（否则，您最终会得到一个没有文字的纯色矩形。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-22T21:39:48.320

我使用以下代码更改 DataGrid BackColor。通常，您将数组、表或数据集指定为 DataGrid 的 DataSource。所以，我在我的数据源 DataTable 中循环，然后查找我想要更改的行的索引。

```
 Private Sub DataGridForm_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    dgr1.DataSource = TimeDifftbl
    dgr1.PreferredColumnWidth = 250
    Dim cellText As String
    Dim dr As DataRow
    For n As Integer = 0 To TimeDifftbl.Rows.Count - 1
        dr = TimeDifftbl.Rows(n)
        cellText = dr.Item(2)
        If cellText = "Tot. RunTime" Then
            dgr1.CurrentRowIndex = n
            dgr1.Select(n)
            dgr1.SelectionBackColor = BackColor.LightGray
        End If
    Next

End Sub 
```

# javascript - ui.selectmenu 抛出 'this.newelement.0' 为 null 或不是对象

> ID：12044309
> 
> 赞同：0
> 
> 时间：2012-08-20T20:01:34.940
> 
> 标签：javascript, jquery, dialog, jquery-ui-selectmenu

我正在尝试从这里[http://filamentgroup.com/lab/jquery_ui_selectmenu_an_aria_accessible_plugin_for_styling_a_html_select/](http://filamentgroup.com/lab/jquery_ui_selectmenu_an_aria_accessible_plugin_for_styling_a_html_select/)实现 ui.selectmenu ，但将其放置在 jQuery 对话框中。不确定这是否是冲突所在。

HTML 标记是：

```
<div id="selModeBox" title="Mode selection Form">
    <label for="mode">Select modes:</label>
    <select id="mode" name="mode">
        <option value="v0" selected="selected">-- Make a Selection --</option>
        <option value="v1">Mode 1.</option>
        <option value="v2">Mode 2.</option>
    </select>
</div> 
```

要实现的Javascript：

```
jQuery(document).ready(function() {
    $('#selModeBox').dialog({
        modal: true
    });
    $('#selModeBox select').selectmenu();

    $('#tabs').tabs();
});​ 
```

加载时出现的 javascript 错误指的是 ui.selectmenu javascript 代码的这一行（第 108 行）：

```
this.element.click(function() {
    this._refreshValue();
}).focus(function() {
    this.newelement[0].focus();
});​ 
```

有没有人经历过类似的事情或有任何解决方法的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T10:09:45.243

jQuery 1.8 可能会导致问题，因为它尚未经过测试，请参阅[https://github.com/fnagel/jquery-ui/issues/261](https://github.com/fnagel/jquery-ui/issues/261)

如果问题在 1.7.x 中仍然存在，请打开一个新问题（请参阅[https://github.com/fnagel/jquery-ui/issues/61](https://github.com/fnagel/jquery-ui/issues/61)）

# ruby - 为 Capistrano 任务创建通用方法

> ID：12044313
> 
> 赞同：0
> 
> 时间：2012-08-20T20:01:52.220
> 
> 标签：ruby, capistrano

假设在我的标准`deploy.rb`文件中，我有一组命名空间。我有一个常见的任务，它根据我传递给它的变量列出 RPM 包。当我按原样运行它时，它抱怨`capture`是一个未定义的方法。如果我在`deploy.rb`文件中包含该方法，它就可以正常工作。

请注意，我是 ruby​​ 和 OOP 的新手，所以我确定我这样做是错误的。:-)

# 部署.rb

```
load 'config/module'

namespace :lp_app do
desc "LP tasks"

co = Tasks::Commands.new()

    task :list do
        co.list_pkg("LP")
    end
end 
```

# 模块.rb

```
module Tasks
    class Commands
        def list_pkg(component)
            File.open("#{component}.file.list", "r").each_line do |line|
                pkg_name = "#{line}".chomp

                set :server_pkg, capture("rpm -q #{pkg_name}")

                puts "#{server_pkg}"
            end
        end
    end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T01:16:51.033

您正在尝试在 Capistrano 之外使用特定于 Capistano 的命令。如果要将变量设置为在命令行上运行的结果，请尝试使用反引号 (`)。

```
module Tasks
    class Commands
        def list_pkg(component)
            File.open("#{component}.file.list", "r").each_line do |line|
                pkg_name = "#{line}".chomp

                server_pkg = `rpm -q #{pkg_name}`

                puts server_pkg
            end
        end
    end
end 
```

# powershell - 如何消除输出文件中多余的 cr lf

> ID：12044314
> 
> 赞同：0
> 
> 时间：2012-08-20T20:01:56.243
> 
> 标签：powershell

我有一组字符串（一堆 HTML 元素），都以回车符（cr）和换行符（lf）结尾。集合中的每一行看起来像

```
<div>Some text</div>crlf 
```

当我将此集合发送到文件时，每行之间都有一个额外的 crlf。这两个都会在文本文件中产生一个额外的 crlf

```
$lines > tmp.txt
$lines -join "`r`n" > tmp.txt 
```

该文件看起来像

```
<div>Some text</div>crlf
crlf
<div>Some more text</div>crlf
crlf 
```

如果我使用 -join "" 我最终没有换行符。

如何每个数组成员只得到一个面包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:07:57.783

这些中的任何一个都应该工作

```
$lines |%{$_.TrimEnd()} > tmp.txt
$lines -replace '\r\n$', '' > tmp.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:30:59.573

评论无法格式化转义字符，所以我会在这里回答。这有效：

```
$lines -join "`r`n" -replace "`r`n`r`n", "`r`n" > tmp.txt 
```

# ios - 使用 prepareForSegue 在视图控制器之间传递数据

> ID：12044322
> 
> 赞同：0
> 
> 时间：2012-08-20T20:02:46.260
> 
> 标签：ios, storyboard, segue

我正在尝试创建一个简单的项目来在我使用情节提要设置的两个视图控制器之间传递一些数据。

该项目非常简单——在第一页我有一个文本字段，然后一个按钮将用户带到第二个视图控制器，希望在该控制器中显示文本，但到目前为止还没有运气。

我正在使用 Segue 的“模态”样式，这是代码：

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{

ViewController2 *vc2;

vc2 = [segue destinationViewController];

vc2.label.text = textField.text; 
```

}

如果有人可以帮助我提供正确的代码并向我解释为什么我目前拥有的代码不起作用，我将不胜感激。我四处搜索，虽然关于如何做到这一点似乎有几种变化，但这对我来说似乎非常正确。

我大约两周前才从控制台迁移到 iOS，所以请保持简单！

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:08:29.457

您的问题（可能！）是`destinationViewController`尚未在您尝试更新它的位置加载其视图层次结构。您可以通过以下方式验证这一点：

```
NSLog(@"Label: %@", vc2.label); 
```

解决这个问题的方法是创建一个属性，`ViewController2`它只是一个字符串并设置它。然后，在`viewDidLoad:`执行时`ViewController2`，将字符串属性复制到标签的文本中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T21:11:42.430

我知道它很丑，但尝试投射destinationviewcontroller。我已经尝试过了，它似乎有助于解决这种情况。

ViewController2 *vc2 = (ViewController * ) [segue destinationviewcontroller];

此外，如果您使用情节提要，您是否在 uinavigationcontroller 中？

# python - 使用 plt.draw() 时，奇怪地接收到传入的串行数据

> ID：12044323
> 
> 赞同：0
> 
> 时间：2012-08-20T20:02:51.290
> 
> 标签：python, matplotlib, serial-port, pyserial

这是一个非常奇怪的问题，其中一件事似乎对另一件完全不同的事情产生了很大的影响。

我有一个外部设备（通过 COM 端口连接），它不断发送传感器的值（10 位传感器 = 0-1023）。

我正在编写的代码获取这些数据并将其绘制在图表中。

目前底部有一行注释掉（`plt.draw()`）。像这样，图表显然没有正确绘制。不过，在这种状态下，来自串口的输入很好，正如您所期望的那样。

当您取消注释该行以允许绘制图表时，问题就出现了。当你这样做时，突然间，输入只是作为一个看似随机的值出现，并没有像预期的那样改变。这个随机值被打印并记录在图表上。

这是代码。

```
import serial
import matplotlib.pyplot as plt
from collections import deque 

size=50
plt.ion()
q=deque([0]*size)

ser=serial.Serial('COM3',57600)
lastbyte=None

line,= plt.plot(range(0,size),list(q))

if ser.isOpen():
  while True:
     x=ser.readline()
     try:
       x=int(x)
     except ValueError:
       x=0

     if x!=lastbyte:
       print x,
       lastbyte=x

     q.append(x)
     q.popleft()
     d=list(q)

     plt.axis([size,0,0,1024])

     line.set_ydata(d[::-1])

#    plt.draw()                  THIS LINE
ser.close()
plt.ioff() 
```

**那么我使用 matplotlib 的方式可能会弄乱输入吗？**

我已经用不同的方式广泛地测试了这个来获取和处理数据，但它总是归结为把`plt.draw()`它搞砸了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T14:06:40.310

在几乎放弃之后，问题得到了解决！

我注意到外部设备发送数据的速度比我的程序接收数据的速度快，在修复这个问题后，它工作了！

魔法！

# java - 如何在 JTextfield 内正确实现 SHIFT + BACKSPACE 击键

> ID：12044328
> 
> 赞同：2
> 
> 时间：2012-08-20T20:03:21.627
> 
> 标签：java, swing, keyboard-shortcuts, jtextfield, keylistener

所以我有一个基本的摇摆应用程序，它包含一个`JTextfield`，我添加以下`KeyListener`内容：

```
public class PromptKeyListener implements KeyListener {

    private boolean SHIFT_PRESSED;

    @Override
    public void keyPressed(KeyEvent e) {

        if (e.getKeyCode() == KeyEvent.VK_ENTER) {
            //Do Thing A
        } else if (e.getKeyCode() == KeyEvent.VK_SHIFT) {
            this.SHIFT_PRESSED = true;
        }

                     if (SHIFT_PRESSED
                && e.getKeyCode() == KeyEvent.VK_BACK_SPACE) {
            //Do Thing B
        }

       }

    @Override
    public void keyReleased(KeyEvent e) {

        if (e.getKeyCode() == KeyEvent.VK_SHIFT) {
            this.SHIFT_PRESSED = false;
        }
        System.out.println(SHIFT_PRESSED);
    }

    @Override
    public void keyTyped(KeyEvent e) {

    }

} 
```

问题是当我按住 SHIFT 和 Backspace 时，事情 B 确实发生了，但 Backspace 键也像往常一样从文本框中删除了一个字符。

按住 SHIFT 时，有没有办法防止 Backspace 从文本框中删除字符？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T00:13:21.307

虽然解决方案有效，但您采取了错误的方法（恕我直言）。

您应该利用[KeyBindings](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html) API

```
InputMap im = field.getInputMap(JComponent.WHEN_FOCUSED);
ActionMap am = field.getActionMap();

im.put(KeyStroke.getKeyStroke(KeyEvent.VK_DELETE, KeyEvent.SHIFT_DOWN_MASK), "DoThingB");
am.put("DoThingB", new AbstractAction() {

    @Override
    public void actionPerformed(ActionEvent e) {

        System.out.println("Do Think B");

    }
}); 
```

此外，您不应该使用 a`KeyListener`来捕获`enter`密钥，而应该使用`ActionListener`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:06:23.660

请参阅[在 Swing 中停止事件的默认行为](https://stackoverflow.com/questions/1068853/stopping-default-behavior-of-events-in-swing)

那个答案说你应该可以打电话

```
e.consume() 
```

以防止文本进入字段的默认行为。

# javascript - Jquery Chosen 插件 - 通过 Ajax 动态填充列表

> ID：12044330
> 
> 赞同：41
> 
> 时间：2012-08-20T20:03:29.620
> 
> 标签：javascript, jquery, jquery-plugins, jquery-chosen

**我正在尝试使用为Multiple Select 选择**的插件构建我的下拉菜单。这是我基于的行为：

[http://jsfiddle.net/JfLvA/](http://jsfiddle.net/JfLvA/)

所以，而不是在我的选择中有 3 个硬编码的 < 选项 >。我希望这个列表是由 ajax 请求填充的 json 数组的值。这将由自动完成触发。

因此，如果用户键入“汽车”，我会通过 ajax 调用发送这封信，然后我会返回一个这样的数组：

[{"id":"2489","name":"carrie"},{"id":"2490","name":"Caroline"},{"id":"2491","name": “卡罗尔”}]

编码：

```
$(function() {

$(".chzn-select").chosen();
$(".chzn-select-deselect").chosen({allow_single_deselect:true});

$('.chzn-choices input').autocomplete({
   source: function( request, response ) {
      $.ajax({
          url: "/change/name/autocomplete/"+request.term+"/",
          dataType: "json",
          success: function( data ) {
             response( $.map( data, function( item ) {
                $('ul.chzn-results').append('<li class="active-result">' + item.name + '</li>');

          }
       });
    }
}); 
```

结果：

我在下拉列表中输入“汽车”，我得到“汽车没有结果”，然后我得到了所有结果，如我所愿。

**1\. 为什么我收到“无结果”消息，因为我可以在我的 json 数组和列表中看到我得到了结果。**

```
 ----------------------------- 
```

当我删除“汽车”并输入“山姆”时。“sam”的结果显示在“car”结果之后。（基本上，我看到了两者的结果，而不仅仅是我当前搜索的结果）

**2.我想清除keyUp上的ul？？以为插件已经这样做了**

```
 ----------------------------- 
```

当我单击一个名称以实际选择它并将其添加到选择中时，我在 selected.js 文件中收到一个 javascript 错误

项目未定义
“item.selected = true;” 第 732 行

插件链接：http: [//harvesthq.github.com/chosen/chosen/chosen.jquery.js](http://harvesthq.github.com/chosen/chosen/chosen.jquery.js)

它没有在选择中添加任何内容。

**3\. 不知道为什么会这样**

```
 ----------------------------- 
```

你们知道我在做什么错吗？我完全被困在这里......！

哦，顺便说一句，我不介意更改插件源，因为它是我唯一使用它的地方....

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-26T12:29:26.973

**[您可以使用出色的Select2](http://ivaynberg.github.com/select2/)**插件通过 AJAX 动态填充列表。[从我对“有没有办法通过 jquery 选择的插件动态 ajax 添加元素？”的回答](https://stackoverflow.com/a/14536897/504611) ：

> 看看整洁的**[Select2](http://ivaynberg.github.com/select2/)**插件，它**基于[Chosen](http://harvesthq.github.com/chosen/)本身并支持远程数据源（又名 AJAX 数据）和无限滚动**。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2012-08-20T20:46:07.550

试试这个：

```
$('.chzn-choices input').autocomplete({
  source: function( request, response ) {
    $.ajax({
      url: "/change/name/autocomplete/"+request.term+"/",
      dataType: "json",
      beforeSend: function(){$('ul.chzn-results').empty();},
      success: function( data ) {
        response( $.map( data, function( item ) {
          $('ul.chzn-results').append('<li class="active-result">' + item.name + '</li>');
        }));
      }
    });
  }
}); 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2014-05-09T14:52:33.610

Ashirvad 的回答不再有效。请注意类名更改并使用**option**元素而不是**li**元素。我已经更新了我的答案，不使用已弃用的“成功”事件，而是选择 .done()：

```
$('.chosen-search input').autocomplete({
    minLength: 3,
    source: function( request, response ) {
        $.ajax({
            url: "/some/autocomplete/url/"+request.term,
            dataType: "json",
            beforeSend: function(){ $('ul.chosen-results').empty(); $("#CHOSEN_INPUT_FIELDID").empty(); }
        }).done(function( data ) {
                response( $.map( data, function( item ) {
                    $('#CHOSEN_INPUT_FIELDID').append('<option value="blah">' + item.name + '</option>');
                }));

               $("#CHOSEN_INPUT_FIELDID").trigger("chosen:updated");
        });
    }
}); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2012-10-10T12:41:41.067

这可能会有所帮助。你只需要触发一个事件。

```
$("#DropDownID").trigger("liszt:updated"); 
```

其中“DropDownID”是 的 ID `<select>`。

更多信息在这里： [http ://harvesthq.github.com/chosen/](http://harvesthq.github.com/chosen/)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-09-09T05:45:39.490

当 DOM 中的 OPTION 元素发生变化时，Chosen 插件不会自动更新其选项列表。您必须向它发送一个事件来触发更新：

预选 1.0： `$('.chzn-select').trigger("liszt:updated");`

选择 1.0 `$('.chosen-select').trigger("chosen:updated");`

如果您正在动态管理 OPTION 元素，那么您必须在 OPTION 更改时执行此操作。你这样做的方式会有所不同 - 在 AngularJS 中，尝试这样的事情：

```
$scope.$watch(
  function() {
    return element.find('option').map(function() { return this.value }).get().join();
  }, 
  function() {
    element.trigger('liszt:updated');
  }
 } 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-11-03T04:54:13.993

选择的答案已经过时，meltice /ajax-chosen 插件也是如此。

使用 Select2 插件有很多错误，我无法解决。

这是我对这个问题的回答。

我在用户输入后将我的解决方案与功能触发器集成在一起。感谢这个答案：[https](https://stackoverflow.com/a/5926782/4319179) ://stackoverflow.com/a/5926782/4319179 。

```
//setup before functions
  var typingTimer;                //timer identifier
  var doneTypingInterval = 2000;  //time in ms (2 seconds)
  var selectID = 'YourSelectId';    //Hold select id
  var selectData = [];           // data for unique id array

  //on keyup, start the countdown
  $('#' + selectID + '_chosen .chosen-choices input').keyup(function(){

      // Change No Result Match text to Searching.
      $('#' + selectID + '_chosen .no-results').html('Searching = "'+ $('#' + selectID + '_chosen .chosen-choices input').val() + '"');

      clearTimeout(typingTimer);  //Refresh Timer on keyup 
      if ($('#' + selectID + '_chosen .chosen-choices input').val()) {

           typingTimer = setTimeout(doneTyping, doneTypingInterval);  //Set timer back if got value on input

      }

  });

  //user is "finished typing," do something
  function doneTyping () {

      var inputData = $('#' + selectID + '_chosen .chosen-choices input').val();  //get input data

      $.ajax({
        url: "YourUrl",
         data: {data: inputData},
        type:'POST',
        dataType: "json",
        beforeSend: function(){
          // Change No Result Match to Getting Data beforesend
          $('#' + selectID + '_chosen .no-results').html('Getting Data = "'+$('#' + selectID + '_chosen .chosen-choices input').val()+'"');
    },
        success: function( data ) { 

          // iterate data before append
          $.map( data, function( item ) {

            // matching data eg: by id or something unique; if data match: <option> not append - else: append <option>
            // This will prevent from select the same thing twice.
            if($.inArray(item.attr_hash,selectData) == -1){

              // if not match then append in select
              $('#' + selectID ).append('<option id="'+item.id+'" data-id = "'+item.id+'">' + item.data + '</option>');

            }            

          });

          // Update chosen again after append <option>
          $('#' + selectID ).trigger("chosen:updated");

        }
      });

  }

  // Chosen event listen on input change eg: after select data / deselect this function will be trigger
  $('#' + selectID ).on('change', function() {

    // get select jquery object
    var domArray = $('#' + selectID ).find('option:selected');

    // empty array data
    selectData = [];

    for (var i = 0, length = domArray.length; i < length; i++ ){

      // Push unique data to array (for matching purpose)
      selectData.push( $(domArray[i]).data('id') );

    }

    // Replace select <option> to only selected option
    $('#' + selectID ).html(domArray);

    // Update chosen again after replace selected <option>
    $('#' + selectID ).trigger("chosen:updated");

  }); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2013-07-21T12:41:40.680

就像 Vicky 建议的那样，Select2 带有内置的 AJAX 功能，看起来像一个很棒的插件。

如果您不想从 Chosen 切换，请尝试 AJAX-Chosen [https://github.com/meltingice/ajax-chosen](https://github.com/meltingice/ajax-chosen)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-10-18T08:44:37.507

选择的 API 发生了很大变化。

如果给定的解决方案都不适合您，您可以试试这个：[https ://github.com/goFrendiAsgard/gofrendi.chosen.ajaxify](https://github.com/goFrendiAsgard/gofrendi.chosen.ajaxify)

这是功能：

```
// USAGE:
// $('#some_input_id').chosen();
// chosen_ajaxify('some_input_id', 'http://some_url.com/contain/');

// REQUEST WILL BE SENT TO THIS URL: http://some_url.com/contain/some_term

// AND THE EXPECTED RESULT (WHICH IS GOING TO BE POPULATED IN CHOSEN) IS IN JSON FORMAT
// CONTAINING AN ARRAY WHICH EACH ELEMENT HAS "value" AND "caption" KEY. EX:
// [{"value":"1", "caption":"Go Frendi Gunawan"}, {"value":"2", "caption":"Kira Yamato"}]

function chosen_ajaxify(id, ajax_url){
    console.log($('.chosen-search input').autocomplete);
    $('div#' + id + '_chosen .chosen-search input').keyup(function(){
        var keyword = $(this).val();
        var keyword_pattern = new RegExp(keyword, 'gi');
        $('div#' + id + '_chosen ul.chosen-results').empty();
        $("#"+id).empty();
        $.ajax({
            url: ajax_url + keyword,
            dataType: "json",
            success: function(response){
                // map, just as in functional programming :). Other way to say "foreach"
                $.map(response, function(item){
                    $('#'+id).append('<option value="' + item.value + '">' + item.caption + '</option>');
                });
                $("#"+id).trigger("chosen:updated");
                $('div#' + id + '_chosen').removeClass('chosen-container-single-nosearch');
                $('div#' + id + '_chosen .chosen-search input').val(keyword);
                $('div#' + id + '_chosen .chosen-search input').removeAttr('readonly');
                $('div#' + id + '_chosen .chosen-search input').focus();
                // put that underscores
                $('div#' + id + '_chosen .active-result').each(function(){
                    var html = $(this).html();
                    $(this).html(html.replace(keyword_pattern, function(matched){
                        return '<em>' + matched + '</em>';
                    }));
                });
            }
        });
    });
} 
```

这是您的 HTML：

```
<select id="ajax_select"></select> 
```

这是你的javascript：

```
// This is also how you usually use chosen
$('#ajax_select').chosen({allow_single_deselect:true, width:"200px", search_contains: true});
// And this one is how you add AJAX capability
chosen_ajaxify('ajax_select', 'server.php?keyword='); 
```

更多信息请参考[https://github.com/goFrendiAsgard/gofrendi.chosen.ajaxify#how-to-use](https://github.com/goFrendiAsgard/gofrendi.chosen.ajaxify#how-to-use)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-02-23T17:50:39.870

如果您有两个或更多选择并使用 Steve McLenithan 的答案，请尝试将第一行替换为：

```
$('#CHOSENINPUTFIELDID_chosen > div > div input').autocomplete({ 
```

不删除后缀：`_chosen`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2018-07-10T05:18:44.240

```
var object = $("#lstValue_chosen").find('.chosen-choices').find('input[type="text"]')[0];
var _KeyCode = event.which || event.keyCode;
if (_KeyCode != 37 && _KeyCode != 38 && _KeyCode != 39 && _KeyCode != 40) { 

    if (object.value != "") {
        var SelectedObjvalue = object.value;
        if (SelectedObjvalue.length > 0) {
            var obj = { value: SelectedObjvalue };
            var SelectedListValue = $('#lstValue').val();
            var Uniqueid = $('#uniqueid').val();

            $.ajax({
                url: '/Admin/GetUserListBox?SelectedValue=' + SelectedListValue + '&Uniqueid=' + Uniqueid,
                data: { value: SelectedObjvalue },
                type: 'GET',
                async: false,
                success: function (response) {
                    if (response.length > 0) {
                        $('#lstValue').html('');
                        var options = '';                            
                        $.each(response, function (i, obj) {
                            options += '<option value="' + obj.Value + '">' + obj.Text + '</option>';
                        });
                        $('#lstValue').append(options);
                        $('#lstValue').val(SelectedListValue);
                        $('#lstValue').trigger("chosen:updated");
                        object.value = SelectedObjvalue;
                    }
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //jAlert("Error. Please, check the data.", " Deactivate User");
                    alert(error.StatusText);
                }
            });
        }
    }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-04-22T17:01:11.677

如果您从 ajax 生成选择标签，请在成功函数中添加：

```
$('.chosen').chosen(); 
```

或者，如果您在单击添加更多按钮时生成选择标签，则添加：

```
$('.chosen').chosen(); 
```

函数内部。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-08-28T08:28:48.027

@Ashivad 的解决方案主要解决了我的问题，但我需要进行这一行添加以防止在显示结果下拉列表后删除输入：

在`success`触发后自动完成的回调中添加了这一行`chosen:updated`：

```
$combosearchChosen.find('input').val(request.term); 
```

完整清单：

```
var $combosearch = $('[data-combosearch]');
if (!$combosearch.length) {
  return;
}

var options = $combosearch.data('options');
console.log('combosearch', $combosearch, options);

$combosearch.chosen({
  no_results_text: "Oops, nothing found!",
  width: "60%"
});

// actual chosen container
var $combosearchChosen = $combosearch.next();

$combosearchChosen.find('input').autocomplete({
  source: function( request, response ) {
    $.ajax({
      url: options.remote_source + "&query=" + request.term,
      dataType: "json",
      beforeSend: function(){
        $('ul.chosen-results').empty();
      },
      success: function( data ) {
        response( $.map( data, function( item, index ) {
          $combosearch.append('<option value="' + item.id + '">' + item.label + '</option>');
        }));
        $combosearch.trigger('chosen:updated');
        $combosearchChosen.find('input').val(request.term);
      }
    });
  }
}); 
```

# php - 在与搜索表单相同的页面上显示 WordPress 搜索结果

> ID：12044332
> 
> 赞同：2
> 
> 时间：2012-08-20T20:03:34.610
> 
> 标签：php, wordpress, search

我在 WordPress 页面模板中有一个搜索表单。我想在与搜索表单相同的页面上显示结果，但我尝试的所有方法似乎都不起作用。我尝试将输入名称替换`s`为`search`as 以绕过 WordPress 的默认查询，将操作字段留空以及使用当前页面的永久链接`get_permalink`和`echo esc_url( get_permalink( get_page_by_title( 'Page_Template' ) ) )`，并编写自定义循环。我尝试的一切似乎要么抛出 404 page not found 错误，要么重定向到主页。

这是我正在使用的修改后的搜索表单和循环：

```
<form method="get" id="searchform" action="<?php echo esc_url( get_permalink( get_page_by_title( 'Page_Template' ) ) )?>">
    <label for="s" class="assistive-text">Search</label>
    <input type="text" class="field" name="search" id="search" placeholder="Search" />
    <input type="submit" class="submit" name="submit" id="searchsubmit" value="Search" />
</form>

<?php
    if ( isset( $_REQUEST[ 'search' ] ) ) {
        // run search query
        query_posts( array(
            's' => $_REQUEST[ 'search' ],
            'paged' => get_query_var('paged')
        ) );

        // loop
        if ( have_posts() ) : while ( have_posts() ) :
            echo '<li>';
            echo '<a href="'.the_permalink().'">'.the_title().'</a>';
            echo '</li>';
        endwhile; endif;

        // return to original query
        wp_reset_query();
    }?> 
```

此示例引发 404 page not found 错误。

任何帮助将不胜感激，我已经在这几个小时了，似乎无法得到它。提前致谢。

# mysql - MySQL 编译库

> ID：12044333
> 
> 赞同：1
> 
> 时间：2012-08-20T20:03:47.330
> 
> 标签：mysql, qt, dll

我在为 Windows 和 Mac 中的 Qt 编译 MySQL 库时遇到了真正的问题。本质上，由于缺少 QMYSQL 文件，我无法将 mysql 与 Qt 应用程序一起使用。在类 Unix 系统中配置和安装应用程序时，我非常陌生。但是，为 Qt 构建库看起来像这样。我已经阅读了一些关于 GNU C 和 GNU Make 的内容以了解所做的工作，但它仍然让我不知所措。

Qt Project 中的指南说我应该有文件夹 include 和 lib/opt 我应该有 libmysql.lib 文件。没有像 opt/ 这样的文件夹，但 /lib 文件夹中有文件 libmysql.lib 和 libmysql.dll。Qt Project 网站没有这么说，但我已将所有内容复制到 C:/QtSDK/QtSources/4.8.1/src/plugins/sqldriver/mysql ，在那里我还找到了 mysql.pro。我运行这个命令：

```
qmake "INCLUDEPATHS+=include" "LIB+=libmysql.lib" mysql.pro 
```

程序为我生成了一个 Makefile。当我运行“make”或“make release”等时，make 总是在同一点停止并声明没有“mysql.lib”文件。我在任何地方都找不到这个文件。

有人知道怎么做吗？请至少指导我从哪里开始寻找。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-04T13:36:22.120

以下对我有用：不幸的是，我不得不从源代码安装整个 Qt(v 4.8.2)。我强烈推荐它。它会对您的体验产生巨大影响，尽管有时它可能是一种真正的痛苦。

我有：

*   使用自安装器 + 附加工具安装了最新的 MinGW 4.7.0
*   通过 intaller MSI 安装了最新的 MySQL 数据库引擎 + 连接器/C（ZIP 存档不起作用）在其名称中没有空格的文件夹中（C:\Mysql-libs\ 等）
*   通过使用以下参数调用配置来构建生成文件：

    > 配置 -debug-and-release -opensource -shared -platform win32-g++-4.6 -plugin-sql-mysql -IC:\ApacheMysqlPhp\Mysql\include -LC:\ApacheMysqlPhp\Mysql\lib -LC:\ApacheMysqlPhp\Mysql\ lib\opt -plugin-sql-odbc -developer-build -no-qt3support -openssl -IC:\openssl\OpenSSL-Win32\include -LC:\openssl\OpenSSL-Win32

*   最后

    mingw32-make.exe

`-platform win32-g++4.6` 如果使用 MinGW 4.6.x+，应特别注意 。当我使用 etc 时它似乎不起作用 `-platform win32-g++`。我希望它可以帮助其他人为 Qt 构建 MySql 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:32:08.173

您是否下载并安装了 MySQL 连接器（包括所需的库）？[http://dev.mysql.com/downloads/connector/c/](http://dev.mysql.com/downloads/connector/c/)这些是您似乎缺少的要求。

确保安装这些，然后设置各种所需文件的路径。你应该可以从那里拿走它。

# wcf - Tridion CoreService 身份验证/模拟

> ID：12044338
> 
> 赞同：3
> 
> 时间：2012-08-20T20:04:26.687
> 
> 标签：wcf, tridion, tridion-2011

我开发了一个使用核心服务的 .Net 库。这个库是从工作流自动决策中的 VBScript 调用的，并使用核心服务来执行与该工作流过程相关的一些活动。

我能够使用我们为 Tridion 拥有的服务帐户成功连接到该服务：

```
CoreServiceClient client = new CoreServiceReference.CoreServiceClient(
                                                       binding, endpoint);
client.ChannelFactory.Credentials.Windows.ClientCredential = 
        new NetworkCredential(serviceAccountUsername, serviceAccountPassword);
client.ChannelFactory.Credentials.Windows.AllowedImpersonationLevel = 
        System.Security.Principal.TokenImpersonationLevel.Delegation; 
```

相关绑定属性设置如下：

```
binding.Security.Mode = BasicHttpSecurityMode.TransportCredentialOnly;
binding.Security.Transport.ClientCredentialType = 
        HttpClientCredentialType.Windows; 
```

我遇到的问题是，当我调用核心服务时，我在 CMS 框中收到以下 Tridion Content Manager 错误：

> 用户 NT AUTHORITY\NETWORK SERVICE 的访问被拒绝。

如何配置我的客户端以便使用 Tridion 服务帐户而不是 NT AUTHORITY\NETWORK SERVICE 执行操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T20:08:32.270

如果您想在服务帐户下运行，您可能应该使用 a`SessionAwareCoreServiceClient`然后模拟您要使用的帐户。

```
var client = new SessionAwareCoreServiceClient(binding, endpoint);
client.Impersonate("Administrator"); 
```

但是由于我的大多数核心服务客户端实际上是要在不同的机器上运行，所以我不能使用`Impersonate`（至少在没有引入***巨大***的安全漏洞的情况下不能使用），所以我像这样初始化我的客户端：

```
var client = ...
var credentials = CredentialCache.DefaultNetworkCredentials;
if (!string.IsNullOrWhiteSpace(userName) && !string.IsNullOrWhiteSpace(password))
{
    credentials = new NetworkCredential(userName, password);
}
client.ChannelFactory.Credentials.Windows.ClientCredential = credentials; 
```

# plsql - orce 日期过滤器未返回预期记录

> ID：12044339
> 
> 赞同：0
> 
> 时间：2012-08-20T20:04:27.767
> 
> 标签：plsql, oracle11g, nsdateformatter

我有一个 oracle DATE 列，该列的特定记录的值是

```
16/10/2005 11:13:34 AM. 
```

现在我正在放入一个像这样的过滤器，过滤器字符串是从前端传入的。

```
date_col between to_date('16-10-2005','DD-MM-YYYY') and to_date('16-10-2005','DD-MM-YYYY') 
```

它返回零记录。为什么会这样？我在想 oracle 会返回所有日期为 16/10/2005 的记录，无论时间如何。我是否还需要传递时间/从前端，我只得到日期而不是时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:10:46.707

```
date_col between to_date('16-10-2005','DD-MM-YYYY') 
     and to_date('16-10-2005','DD-MM-YYYY') 
```

只会返回`DATE`2005 年 10 月 16 日午夜的值。如果您想获取 2005 年 10 月 16 日任何时间的数据

```
date_col between to_date('16-10-2005','DD-MM-YYYY') 
             and to_date('16-10-2005 23:59:59','DD-MM-YYYY HH24:MI:SS') 
```

会做的。也会

```
date_col between to_date('16-10-2005','DD-MM-YYYY') 
             and to_date('17-10-2005','DD-MM-YYYY') - interval '1' second 
```

如果您未能减去那一秒，您最终还将拉`date_col`取值为 2005 年 10 月 17 日午夜的行。

您还可以将`trunc`功能应用于您的`date_col`

```
trunc(date_col) = date '2005-10-16' 
```

但这会阻止使用标准索引`date_col`。您通常需要在`trunc(date_col)`

```
CREATE INDEX idx_trunc_date_col
    ON table_name( trunc(date_col) ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:10:53.860

是的 - 你需要一个时间元素。

to_date('16-10-2005','DD-MM-YYYY') 默认为午夜 - 因此要检索 16/10/05 的所有记录，您可以使用

```
date_col >= to_date('16-10-2005','DD-MM-YYYY')
and date_col < to_date('17-10-2005','DD-MM-YYYY') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T20:08:47.747

将第二天的最后一个日期减去 1 秒...

```
date_col between to_date('16-10-2005','DD-MM-YYYY') 
    and to_date('16-10-2005 23:59:59','DD-MM-YYYY HH:MI:SS') 
```

# javascript - 使用选项在 jQuery 中触发？

> ID：12044341
> 
> 赞同：0
> 
> 时间：2012-08-20T20:04:39.203
> 
> 标签：javascript, jquery, html

我有例如：

```
$('#field').click(function(){
   alert('One');
   alert('Two');
}) 
```

我想使用触发器：

```
$('#field').trigger('click'); 
```

可以为此添加功能吗？

如果我使用触发器，我只想执行**alert('One');**

也许作为...

```
$('#field').click(function(){
   alert('One');
   if(this != trigger){
      alert('Two');
   }
}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:08:29.673

`.trigger`实际上可以向事件发送参数（它需要是一个数组）。

```
$('#field').trigger('click', [true]); 
```

然后像这样修改事件：

```
$('#field').click(function(e, trigger){
   alert('One');
   if(!trigger){
      alert('Two');
   }
}) 
```

演示：http: [//jsfiddle.net/NTICompass/Rkr9S/](http://jsfiddle.net/NTICompass/Rkr9S/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:14:00.613

在触发事件的情况下，相应的事件对象将具有一个属性`isTrigger: true`。所以你可以做这样的事情：

```
$('#field').click(function(e) {
   alert('One');
   if (!e.isTrigger) {
      alert('Two');
   }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T20:08:38.893

不确定我是否理解正确，但您可以使用第二个参数将变量传递给触发器：

```
$('#field').click(function(e, obj) {
    alert('One');
    if ( obj.two ) {
        alert('Two');
    }
});    

$('#field').trigger('click', {
   two: false
}); 
```

[http://jsfiddle.net/t5nZz/](http://jsfiddle.net/t5nZz/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T20:07:54.527

如果我正确地阅读了您的问题，那么您希望在手动触发它时做一些不同的事情。

第 1 节

```
someGlobalVariable = true;
$('#field').trigger('click'); 
```

第 2 节

```
$('#field').click(function(){
   alert('One');
   if(!someGlobalVariable){
      alert('Two');
   }
   someGlobalVariable = false;
}) 
```

# php - URL 编码可以绕过 xss 过滤吗？

> ID：12044342
> 
> 赞同：1
> 
> 时间：2012-08-20T20:04:43.037
> 
> 标签：php, xss

这里的第二段代码[http://anautonomouszone.com/blog/xss-cheat-sheet](http://anautonomouszone.com/blog/xss-cheat-sheet)，声称通过url编码绕过html特殊字符过滤（意思是，<>）：

```
Bypass filter when it strips <script> tags:
%253cscript%253ealert(document.cookie)%253c/script%253e 
```

显然这是 URL 编码，它使服务器不知道原始内容，但我不可能看到它何时转换回`<script>`.

服务器像这样获取它，然后将其发送回去。HTTP 内容未编码，因此用户将按原样获取。

我错过了什么？php函数是这样`htmlspecialchars`吗？

**编辑 ：**

在我在聊天中被误解之后，我会尽量让自己清楚。

这取自 XSS 备忘单。和其他 XSSes 教程。意思是，这是一种试图*绕过*一些*针对*XSS 的方法的方法。

我想理解的很简单：

*   它可以绕过哪些方法（即在什么情况下这对攻击者有帮助）？
*   *它是如何*发生的？它什么时候解码回到`<script>`http-respone？
*   我可以做些什么来避免在我的网站上出现这种情况？

请注意，这在许多站点中都有，因此它可能不是指百万分之一的开发人员错误，而是在某种程度上很可能发生的事情。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T20:18:22.917

几种方法：

*   寻找标签的简单 XSS 过滤器/IDS 等如果不解码两次可能会被愚弄
*   由于软件的复杂性，有时会发生应用服务器对值进行两次解码的情况
*   开发人员也会误解框架并添加额外的 url 解码，即使它已经由服务器完成

**编辑：** 这是描述攻击的 OWASP 页面。在底部有两个指向真正漏洞的链接： [https ://www.owasp.org/index.php/Double_Encoding](https://www.owasp.org/index.php/Double_Encoding)

# java - Restlet + jetty + https 在请求 http 时返回格式错误的响应

> ID：12044345
> 
> 赞同：1
> 
> 时间：2012-08-20T20:05:14.243
> 
> 标签：java, http, https, jetty, restlet

我已将我的 restlet 服务器配置为在码头 http 服务器上使用 https。配置非常简单：

```
 boolean https = c.getBoolean(CfgKeyNames.HTTPS, true);
  Protocol protocol = https ? Protocol.HTTPS : Protocol.HTTP;

  Component component = new Component();

  ServerList servers = component.getServers();
  for (Integer port : ports) {
    Server server = servers.add(protocol, port);
    if (https) {
      Series<Parameter> parameters = server.getContext().getParameters();
      parameters.add("sslContextFactory", PkixSslContextFactory.class.getName());
      parameters.add("keystorePath", Utils.getAbsolutePath(c, CfgKeyNames.KEYSTORE_PATH, "conf", "keystore.jks"));
      parameters.add("keystorePassword", c.getProperty(CfgKeyNames.KEYSTORE_PASSWORD));
      parameters.add("keyPassword", c.getProperty(CfgKeyNames.KEY_PASSWORD));
      parameters.add("keystoreType", c.getProperty(CfgKeyNames.KEYSTORE_TYPE, "jks"));
    }
  } 
```

它工作正常。除了发送 http 请求时，它根本不返回任何内容。运行 fiddler 报告以下响应：

```
HTTP/1.0 200 This buggy server did not return headers 
```

（响应由 Fiddler 生成。）

无论如何，我该如何解决这个问题？

谢谢。

**附言**

我正在使用 Restlet 2.0.14（它带有 Jetty 7.1）

**编辑**

我已经使用 WireShark 捕获了流量。此处提供完整的文本转储 - [http://pastebin.com/Yw80qvcT](http://pastebin.com/Yw80qvcT)

我使用的过滤器是`tcp.port == 11111 && ip.addr == 184.73.151.24`服务器在亚马逊云中的 AWS 机器上运行的端口 11111。

**编辑2**

这是二进制捕获文件 - [http://dl.dropbox.com/u/30319655/gl.pcap](http://dl.dropbox.com/u/30319655/gl.pcap) 这次端口是 443。

# asp.net - 命名空间“x”已经包含“y”的定义

> ID：12044353
> 
> 赞同：4
> 
> 时间：2012-08-20T20:05:58.137
> 
> 标签：asp.net, .net

我正在尝试在我的项目文件夹中创建一个 aspx 文件。我正在尝试在一个名为“NIITS”的文件夹中创建，但是当我创建时出现错误，

```
The namespace 'fig' already contains a definition for 'NIITS' 
```

我在 cs 和设计器文件中都看到了这个错误。可能是什么问题？

后面的代码：

```
namespace fig.NIITS.Ora    {
    public partial class Index : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:12:56.137

想到的直接原因之一可能是从 NIITS.designer.cs 或 NIITS.cs 中删除了“部分”。这将导致编译器相信您没有两个分部类文件，而是两个同名的单独类。

基本上，在您的文件中搜索类 / ... 在您的“fig”命名空间中创建一个“NIITS”条目。例如，当您有一个类 fig.NIITS 并尝试创建一个类 fig.NIITS.Whatever 时，可能会发生这种情况——“NIITS”部分已经用作类名，如果您的意思是类 NIITS 或命名空间“文件夹”NIITS。

当您尝试创建 ASPX 模板文件时收到该错误消息很奇怪。我希望这不会发生在不包含将安装在命名空间中的项目的文件上。但是对于代码隐藏文件（或类似的类文件），这可能是一个原因。

# html - 在现场嵌入 Foursquare 地图并标记一些地点

> ID：12044355
> 
> 赞同：0
> 
> 时间：2012-08-20T20:06:12.043
> 
> 标签：html, maps, foursquare

我需要在现场嵌入某些城市（带有标记的地方）的 Foursquare 地图，并通过给定的坐标标记一些地方。你能帮助我吗？我在 Foursquare Developer 上找不到需要的主题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:17:03.633

您可以使用带有参数的[搜索场所 API](https://developer.foursquare.com/docs/venues/search)`near`来获取您想要的每个城市的参数。

# c++ - printf 比 std::cout 快 5 倍以上？

> ID：12044357
> 
> 赞同：15
> 
> 时间：2012-08-20T20:06:19.567
> 
> 标签：c++, performance, printf, cout

```
#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <ctime>

int main(int argc, char* argv[])
{
    std::clock_t start;
    double duration;    

    std::cout << "Starting std::cout test." << std::endl;
    start = std::clock();

    for (int i = 0; i < 1000; i++)
    {
        std::cout << "Hello, World! (" << i << ")" << std::endl;
    }

    duration = (std::clock() - start) / (double) CLOCKS_PER_SEC;

    std::cout << "Ending std::cout test." << std::endl;
    std::cout << "Time taken: " << duration << std::endl;

    std::system("pause");

    std::cout << "Starting std::printf test." << std::endl;
    start = std::clock();

    for (int i = 0; i < 1000; i++)
    {
        std::printf("Hello, World! (%i)\n", i);
        std::fflush(stdout);
    }

    duration = (std::clock() - start) / (double) CLOCKS_PER_SEC;

    std::cout << "Ending std::printf test." << std::endl;
    std::cout << "Time taken: " << duration << std::endl;

    system("pause");

    return 0;
} 
```

现在，这里是前五次运行的时间：

*   std::cout 测试：**1.125**秒；printf 测试：**0.195**秒
*   std::cout 测试：**1.154**秒；printf 测试：**0.230**秒
*   std::cout 测试：**1.142**秒；printf 测试：**0.216**秒
*   std::cout 测试：**1.322**秒；printf 测试：**0.221**秒
*   std::cout 测试：**1.108**秒；printf 测试：**0.232**秒

如您所见，使用`printf`然后`fflush`ing 比使用 ing 花费的时间大约少 5 倍`std::cout`。

尽管我确实希望使用`std::cout`'s`<<`运算符可能会慢一些（几乎是最小的），但我并没有为这种巨大的差异做好准备。我在做一个公平的测试吗？如果是这样，那么是什么让第一个测试比第二个测试慢得多，如果他们基本上做同样的事情？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-08-20T21:33:01.870

尝试这个：

```
#include <cstdlib>
#include <cstdio>
#include <ctime>
#include <iostream>

int main(int argc, char* argv[])
{
#if defined(NOSYNC)
    std::cout.sync_with_stdio(false);
#endif

    std::cout << "Starting std::cout test." << std::endl;

    std::clock_t start = std::clock();

    for (int i = 0; i < 1000; i++)
    {   
        std::cout << "Hello, World! (" << i << ")" << std::endl;
    }   

    clock_t mid = std::clock();

    for (int i = 0; i < 1000; i++)
    {   
        std::printf("Hello, World! (%i)\n", i); 
        std::fflush(stdout);
    }   

    std::clock_t end = std::clock();

    std::cout << "Time taken: P1 " << ((mid-start)*1.0/CLOCKS_PER_SEC) << std::endl;

    std::cout << "Time taken: P2 " << ((end-mid)*1.0/CLOCKS_PER_SEC) << std::endl;

    return 0;
} 
```

然后我得到：

```
> g++ -O3 t13.cpp
> ./a.out
# lots of lines deleted
Time taken: P1 0.002517
Time taken: P2 0.001872

> g++ -O3 t13.cpp -DNOSYNC   
> ./a.out
# lots of lines deleted
Time taken: P1 0.002398
Time taken: P2 0.001878 
```

所以 P2 时间不会改变。
但是您可以使用`std::cout.sync_with_stdio(false);`. 因为代码不再尝试保持两个流 (std::cout stdout) 同步。如果您正在编写纯 C++ 并且仅使用 std::cout 不是问题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-08-20T20:45:36.957

对于真正的苹果对苹果的比较，重新编写你的测试，以便测试用例之间*唯一*改变的是正在使用的打印函数：

```
int main(int argc, char* argv[])
{
    const char* teststring = "Test output string\n";
    std::clock_t start;
    double duration;

    std::cout << "Starting std::cout test." << std::endl;
    start = std::clock();

    for (int i = 0; i < 1000; i++)
        std::cout << teststring;
    /* Display timing results, code trimmed for brevity */

    for (int i = 0; i < 1000; i++) {
        std::printf(teststring);
        std::fflush(stdout);
    }
    /* Display timing results, code trimmed for brevity */
    return 0;
} 
```

这样，您将只测试`printf`和`cout`函数调用之间的差异。您不会因多次`<<`调用等而产生任何差异。如果您尝试这样做，我怀疑您会得到截然不同的结果。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-04-28T14:37:18.773

利用

```
cout << "\n"; 
```

以防止缓冲。快多了

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-28T14:59:39.243

大约 10 年前，Scott Meyers 测试了*iostream*和*scanf/printf*的效率。取决于编译器和环境，有时 scanf/printf 比 iostream 快 20%，有时甚至快 200%。但是 iostream 从来没有比 scanf/printf 快。根据其他两个给定的示例，scanf/printf 仍然比 iostream 快。然而，迈耶斯说：“在一个真正有用的程序上，不会有任何差异。” 根据 Google 的编程风格（[ [http://google-styleguide.googlecode.com/svn/trunk/cppguide.html]](http://google-styleguide.googlecode.com/svn/trunk/cppguide.html])），除了日志记录之外，不应使用流。iostream 的替代方法是自己封装 scanf/printf。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-22T02:22:08.107

我只有一台计算机的编程范围，所以没有太多测试。无论如何，std::cout 在我的构建中使用精确的详细代码更快。我正在使用 Cpp14。

我只是认为某些人会选择 C++。是的，C 是很棒的语言，但从逻辑上讲，我看不出 printf 如何比 std cout 更快。Printf 必须在运行时从 void 指针进行类型转换。Cout 在编译时这样做。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-23T22:00:44.247

我在笔记本电脑上尝试了这个测试，运行 Windows 10、WSL Ubuntu、CLion 2018、GCC。无优化：

```
#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <ctime>

int main(int argc, char *argv[]) {
    std::ios_base::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::clock_t start;
    double duration1, duration2;

    std::cout << "Starting std::cout test.\n";
    start = std::clock();

    for (int i = 0; i < 100000; i++) {
        std::cout << "Hello, World! (" << i << ")" << std::endl;
    }

    duration1 = (std::clock() - start) / (double) CLOCKS_PER_SEC;

    std::cout << "Starting std::printf test.\n";
    start = std::clock();

    for (int i = 0; i < 100000; i++) {
        std::printf("Hello, World! (%i)\n", i);
        std::fflush(stdout);
    }

    duration2 = (std::clock() - start) / (double) CLOCKS_PER_SEC;

    std::cout << "Time taken: cout " << duration1 << std::endl;
    std::cout << "Time taken Printf: " << duration2 << std::endl;

    return 0;
} 
```

结果：

```
Test1: Cout: 2.25, Printf: 2.45312  (Cout run first)
Test2: Cout: 2.42188, Printf: 2.07812 (Printf Run first)
Test3: Cout: 2.26562, Printf: 2.25 (Cout run first)
Test4: Cout 2.46875, Printf: 2.57812 (Printf run first) 
```

TL;DR：使用`std::ios_base::sync_with_stdio(false)`和`std::cin.tie(nullptr)`将这两个功能带到几乎相同的位置。

# javascript - 如何将 CSS 背景位置属性从百分比转换为像素？

> ID：12044361
> 
> 赞同：4
> 
> 时间：2012-08-20T20:06:25.053
> 
> 标签：javascript, jquery, css, background, background-image

我现在将背景居中（使用`background-position: 50% 50%;`），我想使用 Javascript 制作动画。但是，我希望能够使用像素测量对其进行动画处理。实际上，我想将背景位置设置为“50% + 10px”。这可能使用Javascript吗？

我可以通过找到背景图像的高度和浏览器屏幕的高度并做一些算术来做到这一点，但这似乎是一个复杂的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T20:15:52.563

将来，这将可能使用 CSS3 的[`calc`](https://developer.mozilla.org/en-US/docs/CSS/calc)功能。但由于目前还没有得到广泛支持，下面是一个更实用的解决方案。

只需对这些属性使用[jQuery 支持的增量表示法。](http://api.jquery.com/animate/#animation-properties)例如

```
$(some-element).css({ "background-position": "+=10px" }); 
```

此语法在 $.css 支持之前由 $.animate 支持，但最近的 jQuery 版本在这两种情况下都支持它。

[这是一个 jsfiddle 演示它的实际操作](http://jsfiddle.net/g7mSk/)。

# xcode - 多个警报按钮出错并无效

> ID：12044362
> 
> 赞同：0
> 
> 时间：2012-08-20T20:06:31.893
> 
> 标签：xcode, timer, alert, void

```
-(void)checkCollision{
if (CGRectIntersectsRect(player.frame, enemy.frame)) {

    [randomMain invalidate];
    [start setHidden:NO];

    CGRect frame = [player frame];
    frame.origin.x = 137.0f;
    frame.origin.y = 326.0;
    [player setFrame:frame];

    CGRect frame2 = [enemy frame];
    frame2.origin.x = 137.0f;
    frame2.origin.y = 20.0;
    [enemy setFrame:frame2];

    [randomMain invalidate];
    [start setHidden:NO];

    [timer invalidate];
    time.text = @"0"; 
```

您好，我面临的问题是我尝试在下面创建一个警报视图，但我收到一条错误消息：一元表达式的参数类型“void”无效。在线阅读：-(void) alert1:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)ButtonIndex { 干杯

```
 time.text = @"0"; 
    [timer invalidate];

          NSString *timemessage = [NSString stringWithFormat:@"Unlucky! You survived for %i seconds!", timenumber];
              UIAlertView *alert1 = [[UIAlertView alloc] initWithTitle:@"You've Been Caught!" message:timemessage delegate:nil cancelButtonTitle:@"Try Again" otherButtonTitles:@"Show Leaderboard", @"Submit To game Center",nil];
    [alert1 show];

              -(void) alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)ButtonIndex {
        if (ButtonIndex == 1) {
        GKScore *myScore = [[GKScore alloc]
                            initWithCategory:@"*****"];
            myScore.value = timenumber;

        }
        }

                }}
            ; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:10:22.440

这条线`-(void) alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)ButtonIndex {`是一种新方法的开始。它不能被封闭在里面`checkCollision`。你需要把它和它的所有代码移到外面。`checkCollision`如果你愿意，它可以在结束后 立即进行。您还需要将 UIAlertView 的委托设置为要接收`alertView:clickedButtonAtIndex:`回调的对象。通常是这样`self`。像这样的东西：

```
-(void)checkCollision {
    // Blah, blah, ....
    NSString *timemessage = [NSString stringWithFormat:@"Unlucky! You survived for %i seconds!", timenumber];
    UIAlertView *alert1 = [[UIAlertView alloc] initWithTitle:@"You've Been Caught!" message:timemessage delegate:self cancelButtonTitle:@"Try Again" otherButtonTitles:@"Show Leaderboard", @"Submit To game Center",nil];
    [alert1 show];
}

-(void) alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)ButtonIndex {
    if (ButtonIndex == 1) {
        GKScore *myScore = [[GKScore alloc] initWithCategory:@"*****"];
        myScore.value = timenumber;
    }
    // Handle other button choices ....
} 
```

# c++ - C ++ 11 type_traits：如果浮点类型相同，则如果整数类型则为双精度

> ID：12044364
> 
> 赞同：2
> 
> 时间：2012-08-20T20:06:44.430
> 
> 标签：c++, c++11, typetraits

我有一个类型`Type`和一个变量`tmp`：

```
template<typename Type> myFunction()
{
    /* SOMETHING */ tmp = 0;
}; 
```

我想声明`tmp`好像是浮点类型并且`Type`好像是整数类型。如何在 C++11 中做到这一点？`Type``double``Type`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T20:21:03.760

```
typedef typename std::conditional<
     std::is_floating_point<T>::value, 
     T,                                //if floating, ::type = T
     double                            //else,        ::type = double
>::type value_type;

value_type tmp; //declare variable 
```

我假设`T`只能是算术类型。如果你愿意，你可以[`std::is_arithmetic`](http://en.cppreference.com/w/cpp/types/is_arithmetic)先检查一下。在此处查看其他有用的类型特征：

*   [类型特征](http://en.cppreference.com/w/cpp/types)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T20:20:48.650

查找并使用以下特征：

```
template <bool, class T, class F> struct conditional;
template <class T> struct is_integral;
template <class T> struct is_floating_point; 
```

如果这对您不起作用，请发布您尝试过的内容以及由此产生的错误消息。

# php - 在 Zend 中使用 dompdf？

> ID：12044366
> 
> 赞同：0
> 
> 时间：2012-08-20T20:07:03.347
> 
> 标签：php, zend-framework, dompdf

在开始使用 Zend Framework 之前，我只是将 dompdf 安装在一个目录中，并且能够通过 URL 调用 PDF 下载，类似于以下内容：

`http://*url*dompdf/dompdf.php?base_path=**path**&name=**name**`

我想我会尝试变得聪明，只需将 dompdf 插入 Zend /public 目录。但后来我意识到它不会正确调用 dompdf 使用的类，例如 DOMPDF_Exception 等。

有没有解决的办法？我真的不知道如何整合这两者，而且它们必须可以通过 URL 访问（如上所示）

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-11T22:17:53.980

您可以通过执行以下操作来添加两者。

```
require_once 'Zend/Loader/Autoloader.php';
require_once('Zend/dompdf/dompdf_config.inc.php');
$load = Zend_Loader_Autoloader::getInstance();
$load->pushAutoloader('DOMPDF_autoload',''); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T14:25:49.547

我正在使用带有 Zend 的 DOMPDF，只需将 dompdf 文件夹放在 /library/dompdf 中。在我的 application.ini 中，我有以下行：

```
includePaths.library = APPLICATION_PATH "/../library" 
```

我通过以下方式包含图书馆：

```
require_once('dompdf/dompdf_config.inc.php'); 
```

然后我通过这样做来调用：

```
 $dompdf = new DOMPDF();
  $dompdf->load_html($pdfLayout);
  $dompdf->render();
  $pdfOutput = $dompdf->output(); 
```

奇迹般有效！

# html - 将导航列表项中图像下方的文本居中对齐

> ID：12044375
> 
> 赞同：1
> 
> 时间：2012-08-20T20:07:55.500
> 
> 标签：html, css, image, list

我正在尝试构建一个具有四个图像的导航栏，每个图像下方都有一个文本链接。每个图像链接对都在它自己的列表项中。

但是，当前匹配的文本位于每个图像的右侧。我想将每张图片下方的文本居中对齐（也许左对齐；取决于看起来最好的），但到目前为止我什至无法将文本放到下一行。我尝试了多种浮动组合，或者所有图片都向左浮动（在所有文本链接的左侧），反之亦然。

我确信有一个简单的方法可以做到这一点，我只是很难弄清楚。

这是我用于导航栏的 CSS：

```
#navbar {
width: 100%;
float: left;
background-color: #FFFFCC;
box-shadow: 5px 5px 30px #888888;
margin-bottom: 5%;
}

#navbar ul {
list-style-type: none;
margin:0;
padding:0;
} 

#navbar li {
display:inline;
padding:2.5%;
}

#navbar a {}

#navpiclist img {
height: 100px;
width: 10%;
} 
```

我在此处添加了 HTML：http: [//jsfiddle.net/AhZzX/2/](http://jsfiddle.net/AhZzX/2/) 我没有看到添加图像的方法，我将尝试弄清楚如何添加它们。

关于如何解决此问题的任何想法？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:23:29.430

[http://jsfiddle.net/AhZzX/17/](http://jsfiddle.net/AhZzX/17/)

如果我所做的更改不清楚，请随时问我任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:27:54.250

这是一个浮动/显示问题。修复很简单。将 li 更改为 display: block float: left，这会使菜单按您期望的方式工作。然后到一个添加显示：块和文本对齐：中心。更新在这里 - [http://jsfiddle.net/puJcT/](http://jsfiddle.net/puJcT/)

我仅在 Mac 上的 Chrome 中进行测试，但这应该适用于所有现代浏览器。

# java - 谷歌日历 API Java

> ID：12044380
> 
> 赞同：2
> 
> 时间：2012-08-20T20:08:05.523
> 
> 标签：java, google-calendar-api

我想为我的一个应用程序实现日历/事件。所以我决定使用 Google Calendar API (Java)。但是我看不到它的实现的 Web 部分（前端）。任何人都可以帮助我获得 Google Calendar API（包括前端）的整个实现。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T16:16:44.527

也许这就是您正在寻找的：

[https://developers.google.com/accounts/docs/OAuth2WebServer](https://developers.google.com/accounts/docs/OAuth2WebServer)和[https://developers.google.com/google-apps/calendar/auth](https://developers.google.com/google-apps/calendar/auth)

这使您能够编写一个基于 Web 的应用程序，使用户能够登录到 google 并让您查看或修改用户日历

授权后（此处的漂亮序列图：[https](https://developers.google.com/accounts/docs/OAuth2#webserver) ://developers.google.com/accounts/docs/OAuth2#webserver ），您可以使用 Google Java API 添加删除或查看日历或日历项或直接从 Javascript [https 使用 REST： //developers.google.com/google-apps/calendar/firstapp#rest](https://developers.google.com/google-apps/calendar/firstapp#rest)

或者，您可以将旧版日历小部件用于此处的公共日历： [https ://developers.google.com/gdata/samples/cal_sample](https://developers.google.com/gdata/samples/cal_sample)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2019-05-15T06:08:37.293

**，首先，您必须在console.developer.google.com 上创建一个项目并启用日历API，然后您必须设置OauthScope 并创建Credentials，然后下载credentials.json 文件并粘贴到您的项目中，然后运行它程序将生成您的事件**

```
public class Test {
    private static final String APPLICATION_NAME = "GoogleCalenderApi";
    private static final JsonFactory JSON_FACTORY = JacksonFactory.getDefaultInstance();
    private static final String TOKENS_DIRECTORY_PATH = "tokens";
    private static final List<String> SCOPES = Collections.singletonList(CalendarScopes.CALENDAR);
    private static final String CREDENTIALS_FILE_PATH = "/credentials.json";

    private static Credential getCredentials(final NetHttpTransport HTTP_TRANSPORT) throws IOException {
        InputStream in = Test.class.getResourceAsStream(CREDENTIALS_FILE_PATH);
        if (in == null) {
            throw new FileNotFoundException("Resource not found: " + CREDENTIALS_FILE_PATH);
        }
        GoogleClientSecrets clientSecrets = GoogleClientSecrets.load(JSON_FACTORY, new InputStreamReader(in));
        GoogleAuthorizationCodeFlow flow = new GoogleAuthorizationCodeFlow.Builder(
                HTTP_TRANSPORT, JSON_FACTORY, clientSecrets, SCOPES)
                .setDataStoreFactory(new FileDataStoreFactory(new java.io.File(TOKENS_DIRECTORY_PATH)))
                .setAccessType("offline")
                .build();
        LocalServerReceiver receiver = new LocalServerReceiver.Builder().setPort(8888).build();
        return new AuthorizationCodeInstalledApp(flow, receiver).authorize("user");
    }

    public static void main(String... args) throws IOException, GeneralSecurityException {
        final NetHttpTransport HTTP_TRANSPORT = GoogleNetHttpTransport.newTrustedTransport();
        Calendar service = new Calendar.Builder(HTTP_TRANSPORT, JSON_FACTORY, getCredentials(HTTP_TRANSPORT)).setApplicationName(APPLICATION_NAME).build();
        Event event = new Event();
        event.setSummary("Title of the Event");
        event.setLocation("Location");
        event.setDescription("Something about the event");
        event.setId("event id");
        ArrayList<EventAttendee> attendees = new ArrayList<EventAttendee>();
        attendees.add(new EventAttendee().setEmail("example@gmail.com"));
        attendees.add(new EventAttendee().setEmail("1234@gmail.com"));
        event.setAttendees(attendees);
        String startDate = "2019-10-16 09:00:00";
        Timestamp sDate = Timestamp.valueOf(startDate);
        String endDate = "2019-10-18 18:15:00";
        Timestamp eDate = Timestamp.valueOf(endDate);
        DateTime start = new DateTime(sDate, TimeZone.getTimeZone("UTC"));
        event.setStart(new EventDateTime().setDateTime(start));
        DateTime end = new DateTime(eDate, TimeZone.getTimeZone("UTC"));
        event.setEnd(new EventDateTime().setDateTime(end));
        EventReminder[] reminderOverrides = new EventReminder[] {
                new EventReminder().setMethod("email").setMinutes(24 *60),
                new EventReminder().setMethod("popup").setMinutes(10),
        };
        Event.Reminders reminders = new Event.Reminders()
                .setUseDefault(false)
                .setOverrides(Arrays.asList(reminderOverrides));
        event.setReminders(reminders);
        Event createdEvent = service.events().insert("primary", event).execute();
        System.out.println(createdEvent);
        DateTime now = new DateTime(System.currentTimeMillis());
        Events events = service.events().list("primary")
                .setMaxResults(10)
                .setTimeMin(now)
                .setOrderBy("startTime")
                .setSingleEvents(true)
                .execute();
        List<Event> items = events.getItems();
        if (items.isEmpty()) {
            System.out.println("No upcoming events found.");
        } else {
            System.out.println("Upcoming events");
            for (Event event1 : items) {
                DateTime start1 = event1.getStart().getDateTime();
                if (start1 == null) {
                    start1 = event1.getStart().getDate();
                }
                System.out.println(event1);
                //System.out.printf("%s (%s)\n", event1.getId(), start1);
            }
        }
    } 
```

# javascript - jQuery、jScrollPane 和 Raphael JS

> ID：12044381
> 
> 赞同：3
> 
> 时间：2012-08-20T20:08:09.330
> 
> 标签：javascript, jquery, raphael, jscrollpane

我有以下使用标准 jquery、jscrollpane 和 raphael js 文件的源代码。文档就绪函数中的 javascript 应该在用于向上滚动的 .jspArrowUp 元素中绘制一个箭头。当我使用 firebug 时，svg 元素被添加到 .jspArrowUp 元素中，但是它是不可见的。我似乎无法弄清楚为什么。有人可以帮忙吗？

```
<html>
<head>
    <link rel="stylesheet" type="text/css" href="jquery.jscrollpane.css">
    <script src="jquery.js"></script>
    <script src="jscrollpane.js"></script>
    <script src="raphael-min.js"></script>
    <script>
        $(document).ready(function() {
            var ele = $(".scroll-pane").jScrollPane({showArrows:true});
            $(".jspArrowUp").each(function () {
                var paper = new Raphael(this);
                var xCenter = $(this).width()/2;
                var yCenter = $(this).height()/2;
                paper.path("M" + xCenter + " " + (yCenter + 2).toString() + "L" + (xCenter + 4).toString() + " " + (yCenter + 2).toString() + "L" + (xCenter + 2).toString() + " " + yCenter + "Z").attr("stroke", "#444").attr("fill", "#444");
            });
        });
    </script>
    <style>
    .scroll-pane
        {
            width: 100%;
            height: 200px;
            overflow: auto;
        }
    </style>
</head>
<body>
    <div style="width: 300px;">
    <div class="scroll-pane">
            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec in ligula id sem tristique ultrices
                eget id neque. Duis enim turpis, tempus at accumsan vitae, lobortis id sapien. Pellentesque nec orci
                mi, in pharetra ligula. Nulla facilisi. Nulla facilisi. Mauris convallis venenatis massa, quis
                consectetur felis ornare quis. Sed aliquet nunc ac ante molestie ultricies. Nam pulvinar ultricies
                bibendum. Vivamus diam leo, faucibus et vehicula eu, molestie sit amet dui. Proin nec orci et elit
                semper ultrices. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus
                mus. Sed quis urna mi, ac dignissim mauris. Quisque mollis ornare mauris, sed laoreet diam malesuada
                quis. Proin vel elementum ante. Donec hendrerit arcu ac odio tincidunt posuere. Vestibulum nec risus
                eu lacus semper viverra.
            </p>
            <p>
                Vestibulum dictum consectetur magna eu egestas. Praesent molestie dapibus erat, sit amet sodales
                lectus congue ut. Nam adipiscing, tortor ac blandit egestas, lorem ligula posuere ipsum, nec
                faucibus nisl enim eu purus. Quisque bibendum diam quis nunc eleifend at molestie libero tincidunt.
                Quisque tincidunt sapien a sapien pellentesque consequat. Mauris adipiscing venenatis augue ut
                tempor. Donec auctor mattis quam quis aliquam. Nullam ultrices erat in dolor pharetra bibendum.
                Suspendisse eget odio ut libero imperdiet rhoncus. Curabitur aliquet, ipsum sit amet aliquet varius,
                est urna ullamcorper magna, sed eleifend libero nunc non erat. Vivamus semper turpis ac turpis
                volutpat non cursus velit aliquam. Fusce id tortor id sapien porta egestas. Nulla venenatis luctus
                libero et suscipit. Sed sed purus risus. Donec auctor, leo nec eleifend vehicula, lacus felis
                sollicitudin est, vitae lacinia lectus urna nec libero. Aliquam pellentesque, arcu condimentum
                pharetra vestibulum, lectus felis malesuada felis, vel fringilla dolor dui tempus nisi. In hac
                habitasse platea dictumst. Ut imperdiet mauris vitae eros varius eget accumsan lectus adipiscing.
            </p>
            <p>
                Quisque et massa leo, sit amet adipiscing nisi. Mauris vel condimentum dolor. Duis quis ullamcorper
                eros. Proin metus dui, facilisis id bibendum sed, aliquet non ipsum. Aenean pulvinar risus eu nisi
                dictum eleifend. Maecenas mattis dolor eget lectus pretium eget molestie libero auctor. Praesent sit
                amet tellus sed nibh convallis semper. Curabitur nisl odio, feugiat non dapibus sed, tincidunt ut
                est. Nullam erat velit, suscipit aliquet commodo sit amet, mollis in mauris. Curabitur pharetra
                dictum interdum. In posuere pretium ultricies. Curabitur volutpat eros vehicula quam ultrices
                varius. Proin volutpat enim a massa tempor ornare. Sed ullamcorper fermentum nisl, ac hendrerit sem
                feugiat ac. Donec porttitor ullamcorper quam. Morbi pretium adipiscing quam, quis bibendum diam
                congue eget. Sed at lectus at est malesuada iaculis. Sed fermentum quam dui. Donec eget ipsum dolor,
                id mollis nisi. Donec fermentum vehicula porta.
            </p>
            <p>
                Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.
                Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero
                sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.
                Quisque sit amet est et sapien ullamcorper pharetra. Vestibulum erat wisi, condimentum sed,
                commodo vitae, ornare sit amet, wisi. Aenean fermentum, elit eget tincidunt condimentum, eros
                ipsum rutrum orci, sagittis tempus lacus enim ac dui. Donec non enim in turpis pulvinar facilisis.
                Ut felis. Praesent dapibus, neque id cursus faucibus, tortor neque egestas augue, eu vulputate magna
                eros eu erat. Aliquam erat volutpat. Nam dui mi, tincidunt quis, accumsan porttitor, facilisis
                luctus, metus
            </p>
            <p>
                Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.
                Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit
                amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo.
            </p>
        </div>
        </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T11:11:10.767

SVG 元素在那里，但它不可见，因为`text-indent`class 属性的值为负`.jspArrow`。

注释`text-indent`文件中的属性`jquery.jscrollpane.css`（第 81 行）：

```
.jspArrow
{
    background: #50506d;
    /*text-indent: -20000px;*/
    display: block;
    cursor: pointer;
} 
```

或者覆盖 HTML 中的属性：

```
.jspArrow
{
    text-indent: 0;
} 
```

# javascript - 如何在 Javascript 中为不同的页面访问存储变量

> ID：12044383
> 
> 赞同：1
> 
> 时间：2012-08-20T20:08:19.957
> 
> 标签：javascript

我编写了一个 javascript 代码嵌入到我的 Google 网站（通过 Google 小工具编辑器）这是一项调查！

我想存储一个数字，所以每次另一个用户访问该页面时，他们都会看到最后一个用户的最终结果。

不使用数据库可以吗？

非常感谢你提前

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:10:07.247

不，HTTP 本质上是无状态的。您需要在服务器端做一些事情来将这样的结果推送到网页。

如果您使用 javascript，则可以保持运行计数，但每次用户刷新页面时，计数都会重置。另外，计数仅对该浏览器本地。因此，如果您写入 cookie，则该计数仅适用于该浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:15:13.337

不，您应该尝试查找外部存储，也许使用其他站点的免费调查

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-08-20T20:11:00.577

是的。有几条不同的路线。我认为您可以将所需的数据存储在文件中。然后让JS读取文件以获取数据。可能是 XML。然后在下一次调查完成时让 JS 添加新条目或覆盖 xml 文件。嘿，如果您不明白，请不要投票。您可以使用 JS 进行 AJAX 调用以获取 php 或让 php 对文件进行原始解析。就像问题一样，没有数据库是可能的。

# php - 在 PHP 中从循环中删除文件

> ID：12044396
> 
> 赞同：0
> 
> 时间：2012-08-20T20:09:10.100
> 
> 标签：php, loops, foreach

所以目前我有两个循环在另一个循环中运行（我不知道这是否像禁忌或什么：D）但我的目标是一个目录（页面）中的文件数量是否多于另一个目录（帖子），我希望它删除Pages文件夹中的相应文件。Pages文件夹中的所有文件都有编号，每在Posts目录下有一个新的文本文件，就会在Pages目录下创建一个对应的相同编号的页面（即12.txt会创建12.html） .

这是我得到的：

```
<?php
if($postcount<=$pagecount){
 do{
  foreach(glob($pagedir . "*html")as $filename);
  //something in here to remove the .html, calculate what is above the $postcount
  //number, then unlink the files that don't meet the while loop
 }
 while($postcount<=$pagecount);
?> 
```

我仍然真的想把我的头绕在 foreach 循环上，所以也许我拥有的那个不正确，或者我什至不需要它。

我想知道的是执行我在 foreach 循环下方的评论中所说的最有效的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:19:46.407

您可以使用函数来比较 2 个目录，然后删除不相同的文件。

查看[此链接中的功能](http://blog.crondesign.com/2009/11/php-how-to-compare-directory-attributes.html)

您只需对其稍作修改，以便它检查目录中的不同文件名，但您随后想要做的是遍历返回的数组，然后取消链接文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:34:29.107

我建议从第一个目录创建一个数组。然后运行第二个目录并使用 in_array() 来确定它是否在最后一个文件夹中。如果不是，则 unlink() 文件。

# linux - 无法在自定义 Linux 上运行 mongod

> ID：12044398
> 
> 赞同：1
> 
> 时间：2012-08-20T20:09:15.677
> 
> 标签：linux, mongodb

我有一台运行 linux 内核版本 2.6 的设备。我已将 mongodb 的 Linux 32 位二进制文​​件复制到 /usr/local/bin 中。当我运行 mongod 我得到以下输出

```
./mongod: line 1: syntax error: unexpected "(" 
```

mongo 的输出是

```
 /usr/local/bin # ./mongo
 ./mongo: line 1:ELFPª: not found
 ./mongo: line 2: syntax error: unexpected ")" 
```

谁能告诉我可能是什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T22:06:00.007

看起来二进制文件已损坏，或者它正在由您的 shell 解释而不是执行。如果我强制解释 shell，我可以获得类似的输出：

```
$ sh /usr/bin/mongod
/usr/bin/mongod: 2: /usr/bin/mongod: E: not found
/usr/bin/mongod: 3: /usr/bin/mongod: �BA��RƄ,@�@@: not found
/usr/bin/mongod: 4: /usr/bin/mongod: Syntax error: ")" unexpected
/usr/bin/mongod: 1: /usr/bin/mongod: �P�x@�4�: not found
/usr/bin/mongod: 2: /usr/bin/mongod: E�@E��: not found
/usr/bin/mongod: 2: /usr/bin/mongod: cq�1A�A�: not found
/usr/bin/mongod: 1: /usr/bin/mongod: cannot create ��Q@�/�@8: Directory nonexistent
/usr/bin/mongod: 1: /usr/bin/mongod: ELF: not found 
```

如果您担心它可能是一个损坏的下载，您可以查阅[这个列表](http://dl.mongodb.org/dl/linux/i686)，其中包含每个 MongoDB 二进制版本（针对 32 位 i686 平台）的 md5 哈希值。或者，如果可能，您可以尝试通过包管理器安装 MongoDB。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-07T17:16:31.853

我在 32 位 ubuntu linux 机器上安装 64 位 mongodb 时遇到了同样的错误。当我安装 32 位软件包时它消失了。

# mongodb - 使用 mongocsharpdriver 更新文档的正确方法

> ID：12044406
> 
> 赞同：0
> 
> 时间：2012-08-20T20:10:11.707
> 
> 标签：mongodb, mongodb-.net-driver

我正在为一个虚拟项目创建一个简单的文档管理器

现在我有**插入**和**更新**方法

```
public ObjectId Insert(T model)
{

    _collection.Insert(model);

    return model.Id;
}

public void Update(T model)
{
    var query = Query.EQ("_id", model.Id);

    var bson = model.ToBsonDocument();
    bson.Remove("_id");

    var update = new UpdateDocument
    {
        { "$set" , bson }
    };
    _collection.Update(query, update);
} 
```

这是这样做的正确方法吗？我是 mongo 和 mongossharpdriver 的新手。我在保存 List<> 等属性时遇到问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T05:04:09.303

将文档保存回数据库的最简单方法是使用 Save 方法：

```
collection.Save(model); 
```

这确实会导致将整个文档发送到服务器，因此如果您知道只有几个字段正在更改，您可以使用 Update.Set 仅更改这些字段。

请参阅在线文档：

[http://www.mongodb.org/display/DOCS/CSharp+Driver+Tutorial#CSharpDriverTutorial-Save%3CTDocument%3Emethod](http://www.mongodb.org/display/DOCS/CSharp+Driver+Tutorial#CSharpDriverTutorial-Save%3CTDocument%3Emethod)

[http://www.mongodb.org/display/DOCS/CSharp+Driver+Tutorial#CSharpDriverTutorial-Updatemethod](http://www.mongodb.org/display/DOCS/CSharp+Driver+Tutorial#CSharpDriverTutorial-Updatemethod)

# c++ - C++ 和 OpenMP——线程的执行时间大不相同

> ID：12044407
> 
> 赞同：1
> 
> 时间：2012-08-20T20:10:17.353
> 
> 标签：c++, openmp

我在使用 OMP 线程时遇到问题，因为并行部分中的线程需要非常不同的时间来执行。我在 Linux 集群上运行。该代码是纯 OpenMP 代码；例如，没有混合 MPI 代码。它是用 C++ 编写的。我使用的是 gcc 4.5.3，因此使用的是 OpenMP 3.0。我正在使用编译优化级别 2；即，-O2。我先给出代码，然后给出从中生成的数据。由于我想循环遍历映射的键，我首先将键复制到向量 vec_keys 中，然后对 vec_keys 的元素运行并行 for 循环。有一个与 OMP 并行的 for 循环。必须处理 800,000 个“节点”或条目。并行 for 循环中有 3 个“命令”。

1.  根据键获取地图迭代器。见行：node = vec_keys.at(itime);

2.  使用第 1 步中的迭代器，获取指向 C++ 对象的指针，该对象将在其上调用方法。见行：p_nim = p_dmb->getModel(node);

3.  在步骤 2 中从地图中检索到的对象上调用该方法。参见语句：
    isStateUpdate = p_nim->computeNextState(day, iteration, fsmId, p_dmb, tid, node, p_np,p_ep,p_cp,p_fg,newStateNp, outStream);

请注意，在第 2 步中，地图条目被检索但不被写入。在第 3 步中，地图的内容正在发生变化，但通过间接方式进行。也就是说，映射键不会改变。这些值（在映射条目中）是指向在堆上实例化的原始数组的指针。因此，通过不改变值指针，我可以改变原始数组的内容。关键是我正在使用地图，每个键在 OMP for 循环中被调用一次，并且没有竞争条件或不一致的内存。我用 1、2、4 和 8 个线程运行了很多次，并且输出总是正确的。上面第 1 步和第 2 步的操作对于每个 map 键都是一样的；只有第 3 步可以不同。代码是：

```
 #pragma omp parallel num_threads(numSpecOmpThreads) \
                private(itime,node,index,modelId,isStateUpdate,tid, \
                        b1time, \
                        e1time) \
                shared(numkeys,vec_keys,p_graph,p_cp,ifsm,p_np,p_dmb, \
                       p_ep,p_fg,newStateNp,day,iteration,fsmId, \
                       fakeMpiRankOpenMp,cout,outStream, \
                       startWtime,endWtime,counter, \
                       sinnertime,einnertime, \
                       dt1time, \
                       dt2time, \
                       dt3time, \
                       countChange) \
                default(none)
       {
           // Any variable in here is private.
           tid=omp_get_thread_num();
           NodeInteractModel02IF *p_nim=0;
           startWtime[tid] = omp_get_wtime();
           if (tid==0) {
               gettimeofday(&sinnertime,0);
           }

           #pragma omp for nowait
           for (itime=0; itime<numkeys; ++itime) {

               ++(counter[tid]);

               // node is a tail, or owned node.
               // This is step 1.
               gettimeofday(&b1time,0);
               node = vec_keys.at(itime);
               gettimeofday(&e1time,0);

               dt1time[tid] += (1000000  * (e1time.tv_sec - b1time.tv_sec) +
                        e1time.tv_usec - b1time.tv_usec);

               // This is step 2.
               gettimeofday(&b1time,0);
               p_nim = p_dmb->getModel(node);
               gettimeofday(&e1time,0);

               dt2time[tid] += (1000000  * (e1time.tv_sec - b1time.tv_sec) +
                        e1time.tv_usec - b1time.tv_usec);

               // This is step 3.
               gettimeofday(&b1time,0);
               isStateUpdate =  p_nim->computeNextState(lots of args);
               gettimeofday(&e1time,0);

               dt3time[tid] += (1000000  * (e1time.tv_sec - b1time.tv_sec) +
                        e1time.tv_usec - b1time.tv_usec);

               if (isStateUpdate) {
                   ++(countChange[tid]);
               }

           }  // End FOR over vector of owned nodes.

           endWtime[tid] = omp_get_wtime();

           if (tid==0) {
               gettimeofday(&einnertime,0);
           }

       }  // End pragma on OMP parallel. 
```

现在，问题。以8线程执行为例。执行结果如下所示。这些是典型的。dt1 是运行上述第一步的累积时间，以秒为单位；dt2 是运行上述第二步的累计时间；dt3 是运行上述步骤 3 的累积时间。cum=dt1+dt2+dt3。countChange 是步骤 3 中发生变化的“节点”数量的计数。有 8 行数据，每个线程一个（tid=0 是第一行数据，...，tid=7 是最后一行）。这次运行有 800,000 个“节点”，因此最多可以有 8 x 100,000 = 800,000 个 countChanges。我已经确认每个线程正在处理总共 800,000 个节点中的 100,000 个。因此，每个线程的工作——就要处理的节点数量而言——是相同的。但是，如下所述，

+++++++++++++++++++++++++++++++

dt1 dt2 dt3 cum (s) countChange

0.013292 0.041117 3.10149 3.1559 15

0.009705 0.041273 3.17969 3.23067 21

0.009907 0.040998 3.29188 3.34279 16

0.009905 0.040169 3.38807 3.43814 26

0.023467 0.039489 0.198228 0.261184 100000

0.023945 0.038114 0.187334 0.249393 100000

0.023648 0.042231 0.197294 0.263173 100000

0.021285 0.046682 0.219039 0.287006 100000

正如预期的那样，dt1 小于 dt2。正如预期的那样，两者都小于 dt3，因为步骤 3 涉及计算。但是请注意，dt3 值的问题：它们的变化超过一个数量级，并且它们分为两组：一组具有 dt3 ~ 3.2，一组具有 dt3 ~ 0.19。此外，执行速度最快的线程是执行*最多的线程*工作; 后四个线程中的每一个都更改所有 100,000 个值，而前四个线程在 15-26 个值之间更改（这显然是小于 100,000 的数量级）。后 4 个线程做更多的工作，因为当一个节点改变时有更多的计算。此外，我正在运行的机器是一个 2 节点、每节点 4 核的计算节点。我希望主线程是 tid=0 并且时间会更短（如果有的话），但它在时间更长的组中。此外，单线程代码产生 cum ~ 11.3 秒。现在，11.3/8 = 1.41 秒。

由于代码执行此循环以及其他类似循环数百万次，因此理想时间（1.41 秒）和最大测量时间（以上 3.44 秒）之间的差异是巨大的，而且似乎过大。

此外，如果使用 4 个线程而不是 8 个线程运行上述示例，则前两个线程的时间过多，后两个线程的时间快。参见以下 4 线程数据：

+++++++++++++++++++++++++++++++

dt1 dt2 dt3 cum (s) countChange

0.023794 0.073054 5.41201 5.50886 36

0.018677 0.072956 5.77536 5.86699 42

0.027368 0.066898 0.341455 0.435721 200000

0.026892 0.076005 0.363742 0.466639 200000

同样，前两个线程和后两个线程之间的差异在时间上是一个数量级（~5.5 vs ~0.4）；再一次，运行最快的线程做的工作最多。

这是示例 2 线程数据。第二个线程做的工作更多——更改了 400,000 个节点，而第一个线程只更改了 78 个节点——但运行速度却快了一个数量级（10.8 对 0.8）。+++++++++++++++++++++++++++++++

dt1 dt2 dt3 cum (s) countChange

0.025298 0.144209 10.6269 10.7964 78

0.019307 0.126661 0.619432 0.7654 400000

我已经多次单独使用 OpenMP 以及在组合 OpenMP + MPI 代码上重复这个实验，并且每次都得到相同的结果（当然，这些值稍微调整了一下，但趋势相同）。前一半的线程（tid 最小的线程）运行时间最长且工作较少。此外，使用 gcc 4.7.0，因此 OpenMP 3.1 给出了相同的结果。

对于为什么这些线程在执行时间上有如此大的差异以及我能做些什么来消除它的任何帮助，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:46:14.367

首先，您真的确定花费更长的线程做的工作更少吗？因为奇怪的是，那些只在少数项目上工作的线程总是花费最长的时间。如果是这种情况，您可以尝试考虑以下因素：

*   是否存在错误共享（多个线程访问同一缓存行，至少其中一些线程在写入）？
*   您提到它在 2 节点机器上工作。您可以尝试查看哪个节点执行哪些线程以及分配内存蜂的位置。除非节点之间的互连真的很糟糕，否则我怀疑这是问题所在。

虽然不是关于为什么某些线程较慢的答案，但您可能想要尝试`guided`或`dynamic`调度循环（例如`#pragma omp for nowait schedule(dynamic, 10000)`，您当然想要微调以`chunk_size`获得最大性能），通过使工作负载更均匀地分布在线程之间更快的线程需要更多的负载。

作为旁注：考虑到c ++允许在任何结构化块内声明变量，并且在并行部分内声明的变量无论如何都是线程私有的，为什么您需要所有这些私有变量。因此，在并行部分内首次使用时声明变量可能是提高可读性甚至性能的好主意（尽管在这种情况下不太可能）。

# javascript - 检查javascript中的单选按钮

> ID：12044419
> 
> 赞同：0
> 
> 时间：2012-08-20T20:11:08.900
> 
> 标签：javascript, javascript-events

我页面上单选框的默认值设置为选中。我注意到，当我更改选择并重新加载页面时，检查会恢复为默认值。我想知道 javascript 中是否有办法以编程方式设置我的单选元素的值检查属性。

这是我的html

```
<body>
<TD><INPUT TYPE="radio" NAME="Performer" VALUE="Aitken"   >Aitken</TD>
  <TD><INPUT TYPE="radio" NAME="Performer" VALUE="Coltrane"  CHECKED>Coltrane</TD>
  <TD><INPUT TYPE="radio" NAME="Performer" VALUE="Julliard" >Julliard</TD>
  <TD><INPUT TYPE="radio" NAME="Performer" VALUE="Kronos"  >Kronos</TD>
  <TD><INPUT TYPE="radio" NAME="Performer" VALUE="Waits"  >Waits</TD>
<input type="submit" id="submit_button"name="sunmit">
</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:20:02.537

Html 本质上是无状态的。更改页面上某些内容的值绝对没有任何作用，除非您真的对它进行了某些操作。

为了保持此值，您必须将其发送回您的服务器（通过 AJAX 或传统的表单提交），并且不要使用硬编码值，而是使用您选择的动态语言。

您还可以使用[本地存储](https://stackoverflow.com/questions/2010892/storing-objects-in-html5-localstorage)来拥有特定于用户/机器的 javascript 实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:19:19.427

您可以在每次有人选中/取消选中包含所有选中元素时设置一个 cookie，然后根据页面加载时的 cookie 数据重新检查它们。

但除非您知道自己在做什么，否则我不会推荐它，因为当您对表单执行“意外”操作时，您将危及可用性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:30:00.730

一旦您知道应该检查哪个按钮，使用 cookie 值或 localStorage 作为其他答案的建议，您确实可以使用 javascript 检查按钮。这是一个 jQuery 片段：

```
var valueToCheck = "Kronos";  // assume you have a known value like this one
$('input[name="Performer"][value="'+ valueToCheck +'"]').prop('checked', true); 
```

如果您没有可用的 jQuery，您可以使用本机代码。每个输入元素都有一个`value`属性，单选按钮也有一个`checked`属性：

```
var buttons = document.getElementsByTagName('input'), button;
for (var i = 0; i < buttons.length; i += 1) {
    button = buttons[i];
    if (button.name === "Performer" && button.value === valueToCheck) {
        button.checked = true;
        break;
    }
} 
```

# c# - C#后台工作者更新状态标签

> ID：12044421
> 
> 赞同：7
> 
> 时间：2012-08-20T20:11:11.203
> 
> 标签：c#, winforms, label, backgroundworker

这应该是一件相当简单的事情；但是，我一直无法弄清楚这一点。

```
/// This section is located in the InitializeComponent() method
/// form's class, i.e. partial class frmMain { .... }
this.bgw = new System.ComponentModel.BackgroundWorker();
this.bgw.WorkerReportsProgress = true;
this.bgw.DoWork += new System.ComponentModel.DoWorkEventHandler(this.bgw_DoWork);
this.bgw.ProgressChanged += new System.ComponentModel.ProgressChangedEventHandler(this.bgw_ProgressChanged);

/// This code is located in public partial class frmMain : Form { .... }
private void bgw_DoWork(object sender, DoWorkEventArgs e)
{
    for (int i = 1; i <= 100; i++)
    {
        Thread.Sleep(100); // Wait 100 milliseconds
        //Console.WriteLine(i);
        bgw.ReportProgress(i);
    }
}
private void bgw_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
    // Update status label
    lblStatus.Text = e.ProgressPercentage.ToString();
}
// New code added to question after edit
public frmMain()
{
    InitializeComponent();
    bgw.RunWorkerAsync();
    // some more stuff...
} 
```

后台工作人员运行正常；但是，它没有正确更新其进度。如果我取消注释 DoWork 事件中的注释行，我能够看到正确更新的状态；但是，在主线程中的任务（繁重的数据库计算内容）完成之后，才会触发 ProgressChanged 事件。

这是使用 .NET Framework 4 并且是 Windows 窗体应用程序。

**编辑**

有关代码所在的位置，请参见上述代码中的注释。

*更多细节*

正在执行的代码涉及在数据库上执行多个查询。我无权透露该代码。至于代码是如何执行的，我实际上不知道，因为另一个开发人员给了我一个 .dll，并被告知只能在访问数据库时使用它......

**编辑**

“一些更多的东西”部分中的代码被移动如下

```
private void frmMain_Load(object sender, EventArgs e)
{
   // some more stuff... aka run queries!
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T20:47:58.187

你的`BackgroundWorker`代码很好。问题是您在其他地方（在这种情况下，在您的构造函数中`FormLoad`）有阻塞 UI 线程（通过执行同步数据库请求）的代码。您需要做一些事情来确保此代码在非 UI 线程中运行。这可能意味着使用这个现有的`BackgroundWorker`来执行那些其他长期运行的任务；它也可以通过使用`Task.Factory.StartNew`或其他一些线程机制让它在非 UI 线程中运行来完成。

一旦 UI 线程没有被阻塞，您将看到在 UI 中反映的 `ProgressChanged 事件处理程序中所做的更新。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T21:06:44.597

[@Servy 当然是正确的。](https://stackoverflow.com/a/12044899/11808)

我只是想加入重现问题的代码：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
        bgw.RunWorkerAsync();

        Task.Factory.StartNew(SomeMoreStuff);
    }

    private void SomeMoreStuff()
    {
        for (int i = 0; i < 5; i++)
        {
            Thread.Sleep(50);
            this.Invoke((Action)HogTheUIThread);
        }
    }

    private void HogTheUIThread()
    {
        Thread.Sleep(1000);
    }

    private void bgw_DoWork(object sender, DoWorkEventArgs e)
    {
        for (int i = 1; i <= 100; i++)
        {
            Thread.Sleep(100); // Wait 100 milliseconds
            //Console.WriteLine(i);
            bgw.ReportProgress(i);
        }
    }

    private void bgw_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        // Update status label
        lblStatus.Text = e.ProgressPercentage.ToString();
    }
} 
```

# cakephp - 基于用户的权限

> ID：12044422
> 
> 赞同：0
> 
> 时间：2012-08-20T20:11:15.757
> 
> 标签：cakephp, cakephp-2.0, acl

如何制作基于用户的权限系统？

基本是：我将拥有页面（帐户、foo、bar 等）和操作（添加、编辑、删除等），并且每个用户都可以根据职责拥有权限。

例如，如果我希望用户添加新用户，我需要添加页面“用户”和操作“添加”。

我试过 Cake ACL，但是，我不知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T22:30:29.533

Cake 使用函数 isAuthorized() 为您提供了一个很好的解决方案来解决这些问题。

您可以从[这里](http://www.youtube.com/watch?v=zvwQGZ1BxdM)学习，也可以从[文档](http://book.cakephp.org/2.0/en/core-libraries/components/authentication.html)中阅读。

```
public function isAuthorized($data){
    return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T01:56:39.393

Auth 和 ACL 组件的实现是基于用户权限的最佳思路，详细研究可以参考以下 url：

[http://book.cakephp.org/2.0/en/tutorials-and-examples/simple-acl-controlled-application/simple-acl-controlled-application.html](http://book.cakephp.org/2.0/en/tutorials-and-examples/simple-acl-controlled-application/simple-acl-controlled-application.html)

此网址为我们提供了带有示例数据的 ACL 组件的完整实现...试试这个，如果有任何问题，请告诉我

# salesforce - Visualforce Five9 CTI 电话号码可链接

> ID：12044423
> 
> 赞同：0
> 
> 时间：2012-08-20T20:11:31.597
> 
> 标签：salesforce, apex-code, visualforce, force.com

我正在考虑从可与 Five9 链接的 Visualforce 页面上的联系人对象中制作电话号码字段。目前，这些数字并未显示为可链接到 Five9。我可以实施任何顶点或 Visualforce 脚本来完成这项工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T16:48:16.630

实现点击拨号的最简单方法是向以下地址发送 GET 请求，并带有参数（number、campaignId、checkDnc）：

```
http://127.0.0.1:9998/makeCall?number=9252012000&campaignId=0&checkDnc=true 
```

它希望在新窗口中打开，例如，下面的代码使用 HTML 链接在新窗口中打开链接（target="blank"）：

```
<a target="blank" href="http://127.0.0.1:9998/makeCall?number=9252012000&campaignId=0&checkDnc=true">9252012000</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T17:58:44.193

```
 <script>

function callFunction(telephone) {
    var newStr = telephone.replace(/[\s\-\(\)]/gi, ""); 
    var url = 'http://localhost:9998/makeCall?number=' + newStr + '&campaignId=0&checkDnc=true';
    $.get(url, function(data) {
    return;
    });
}
</script> 
```

此解决方案不会打开新的浏览器选项卡。

# android - 不提交持久存储的值

> ID：12044425
> 
> 赞同：0
> 
> 时间：2012-08-20T20:11:44.763
> 
> 标签：android, string, sharedpreferences, commit

有人可以帮我看看我在这里忽略了什么吗？

问题是，这些值不会提交到持久存储 -`.commit()`返回 true 和所有内容，但这些值根本不存在......

```
public void onPause() {
    super.onPause();

    if (timerStarted) {
    // Save the values
            settings.edit().putInt(getString(beer).toString(), savedVal_beer);
            settings.edit().putInt(getString(lightBeer).toString(), savedVal_ltBeer);
            settings.edit().putInt(getString(strongBeer).toString(), savedVal_stBeer);
            settings.edit().putInt(getString(wine).toString(), savedVal_wine);
            settings.edit().putInt(getString(fortifiedWine).toString(), savedVal_fortWine);
            settings.edit().putInt(getString(liqeur).toString(), savedVal_liqeur);
            settings.edit().putInt(getString(spirits).toString(), savedVal_spirits);
            if (counterStarted) {
                settings.edit().putString(getString(R.string.key_counter_lastTypeUsed), selectedType);
            }
            settings.edit().commit();
            if (settings.edit().commit()) {
                Toast.makeText(this, "saved", Toast.LENGTH_SHORT).show();
            }
    }
} 
```

我在最后添加了一个断点并使用调试器来验证要存储的变量确实存在，但是当我使用 adb 拉出 sharedPrefs xml 文件时，实际上并没有保存任何值......

`timerStarted`并且`counterStarted`都是真实的，因为它们应该是。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:12:51.043

你必须使用一个[`edit()`](http://developer.android.com/reference/android/content/SharedPreferences.html#edit%28%29)电话，只有。并删除对[`commit()`](http://developer.android.com/reference/android/content/SharedPreferences.Editor.html#commit%28%29).

```
Editor editor = settings.edit();
editor.putInt(getString(beer).toString(), savedVal_beer);
editor.putInt(getString(lightBeer).toString(), savedVal_ltBeer);
editor.putInt(getString(strongBeer).toString(), savedVal_stBeer);
editor.putInt(getString(wine).toString(), savedVal_wine);
editor.putInt(getString(fortifiedWine).toString(), savedVal_fortWine);
editor.putInt(getString(liqeur).toString(), savedVal_liqeur);
editor.putInt(getString(spirits).toString(), savedVal_spirits);
if (counterStarted) {
    editor.putString(getString(R.string.key_counter_lastTypeUsed), selectedType);
}
if (editor.commit()) {
    Toast.makeText(this, "saved", Toast.LENGTH_SHORT).show();
} 
```

# javascript - Javascript多数组不起作用

> ID：12044428
> 
> 赞同：2
> 
> 时间：2012-08-20T20:12:00.810
> 
> 标签：javascript, html, arrays

您好我正在尝试打印出数组中的第一个元素和附加到该元素的元素。我在 Firefox 中得到“helloh”，在 IE 中得到“helloundefined”。有谁知道为什么这不起作用。

这是一个jsfiddle .. [http://jsfiddle.net/ZtuAu/](http://jsfiddle.net/ZtuAu/)

```
<script language=javascript> 
var test = new Array();
test[0] = new Array();

test[0] = "hello";
test[0][0] = "world";
document.write(test[0] + test[0][0]);
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:15:25.707

`test[0]`只能有一个值。你试图给它两个值。而且，您还会发现只有一些浏览器允许使用数组语法来检索字符串中的特定字符。

首先，你这样做：

```
test[0] = new Array(); 
```

然后，你这样做：

```
test[0] = "hello"; 
```

第二个替换您的第一个，因此`test[0]`不包含数组，它包含一个字符串`"hello"`，因此何时执行此操作：

```
test[0][0] = "world" 
```

您正在尝试分配字符串对象不允许的字符串（因此它什么也不做） `[0]`。`"hello"``test[0]`

然后，当您尝试读取语句时，`test[0][0]`您正在`document.write()`尝试`[0]`对. 字符串对象在技术上不允许使用数组语法对字符串进行索引，但一些浏览器仍然允许它作为从字符串中检索单个字符的快捷方式。这就是为什么您在不同的浏览器中得到不同结果的原因（它返回字符串的第 0 个字符，即）。`"hello"``test[0]``"hello"``"h"`

注意：如果您确实想要检索字符串的特定字符，请使用`charAt(n)`. 有关文档，请参阅[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/charAt)。

也许你想做的是：

```
<script language=javascript> 
var test = new Array();
test[0] = "hello";
test[1] = "world";
document.write(test[0] + test[1]);
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:15:51.160

在第三行 ( `test[0] = new Array();`)，您设置`test[0]`了一个新数组。

在下一行 ( `test[0] = "hello";`) 中，将其设置为字符串。

然后`test[0][0] = "world";`尝试将该字符串的第一个索引设置为“world”。
这就像尝试做的那样`"hello"[0] = "world";`。你不能那样做。JavaScript 中的 String 对象是不可变的。

* * *

`var test = Array();`制作一维结构......像这样：

```
0 - [_]
1 - [_]
2 - [_]
3 - [_]
4 - [_] 
```

然后，将第一个点设置为一个新数组为其提供了第二个维度（但仅在第一个点中）。

```
0 - [_][_][_][_][_]
1 - [_]
2 - [_]
3 - [_]
4 - [_] 
```

然后，将第一个位置设置为`"Hello"`摆脱您放置在那里的阵列。

```
0 - ["Hello"]
1 - [_]
2 - [_]
3 - [_]
4 - [_] 
```

此时，`test[0]`是`"Hello"`。不是`Array`您想要的标准。你不能设置`[0]`一个字符串。

* * *

当您要求尝试设置`[0]`String like`"Hello"`时，实际上什么也没发生，因此该行`test[0][0] = "world";`根本没有做任何事情！

在内心深处，字符串与数组相同。数组操作甚至可以应用于字符串。浏览器暴露潜在相似性的程度并不一致。在 FF、Chrome 和 Safari 中，您将`test[0][0]`获得`[0]`. `"Hello"`在那些浏览器中，Hello 有点像`["H","e","l","l","o"]`. 所以，`test[0][0]`= `"Hello"[0]`= `"H"`。IE 不会那样处理字符串。这就是为什么您会看到不一致的行为。

希望这有帮助！

编辑：正如其他人已经建议的那样， using`charAt(x)`是您在尝试从字符串中提取特定位置的字符时应该使用的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:16:29.260

您首先将 test[0][0] 设为一个数组，然后将一个字符串放入其中。也是，因为它`test[0]`是字符串的第 0 个元素。所以你得到+`hello``test[0][0]``h``hello``hello``h`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T20:17:18.000

你有一个数组

```
var test = new Array(); 
```

如果要在其中插入项目，请使用`push`

```
test[0] = new Array(); // not this way
test.push(new Array()); // this way 
```

因为您希望数组更新其长度属性等。

所以，你这样做：

```
test[0] = new Array();
test[0] = "hello"; 
```

您将同一件事分配两次，因此很自然，只有第二次分配成立。所以我们有

```
test[0] == "hello" 
```

然后，在 FireFox 中，您可以使用`[]`访问字符串的任何字符

```
test[0][0] == "hello"[0] == "h" 
```

显然，在 IE 中你不能这样做，所以你得到`undefined`.

# php - 通过 PUT 更新 Shopify 变体的库存数量时遇到问题

> ID：12044431
> 
> 赞同：1
> 
> 时间：2012-08-20T20:12:17.900
> 
> 标签：php, xml, api, curl, shopify

我正在尝试使用其中一个 PHP API 库的 XML 版本通过 API 更新变体库存数量，但遇到了问题。我觉得我真的很接近但到目前为止我得到的只是“错误”......没有比这更具体的了。

虽然这确实与此处的另一个问题相似，但该问题的回答是“您的库已过时，请使用其中一个”。在这一点上，我没有时间换出或试验不同的库。我需要让这个工作。

所以，这就是我通过 cURL“PUT”传递的内容：

```
<?xml version="1.0"?>
<variant>
   <inventory-quantity type="integer">123456</inventory-quantity>
   <id type="integer">123456789</id>
</variant> 
```

这是返回的内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<hash>
   <errors>Error</errors>
</hash> 
```

我的功能如下：

```
function updateProductVariant($id,$qty) {
    $url = $this->buildDataURL('variants/'.$id);

    $string = '<variant>
   <id type="integer">'.$id.'</id>
   <inventory-quantity type="integer">'.$qty.'</inventory-quantity>
</variant>';

    $simpleXML = new SimpleXMLElement($string);
    $xml = $simpleXML->asXML();

    $putData = tmpfile();
    fwrite($putData,$xml);
    fseek($putData,0);

    $result = $this->curlPost($url,$xml,$putData);
    return $xml . "\n" . $result;
    #return $result;
} 
```

cURL函数如下：

```
function curlPost($url,$request=null,$put=null,$post=null) {

    $ch = curl_init();

    curl_setopt($ch, CURLOPT_HEADER, 0);
    if ($put) {
        curl_setopt($ch, CURLOPT_PUT, true);
        curl_setopt($ch, CURLOPT_INFILE, $put);
        curl_setopt($ch, CURLOPT_INFILESIZE, strlen($request));
    }
    if ($post) {
        curl_setopt($ch, CURLOPT_POST, 1);
        curl_setopt($ch, CURLOPT_POSTFIELDS, $request);
        curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: text/xml; charset=utf-8', 'Content-length: '.strlen($request)));
    }
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_TIMEOUT, 60);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

    if(!curl_errno($ch)) {
        $result = curl_exec($ch);
    } else {
        $result = curl_errno($ch).": ".curl_error($ch);
    }
    curl_close($ch);

    return $result;
} 
```

在这一点上，我猜这是 cURL 或 PUT 的问题，或者两者都有问题，但是如果没有特定的错误数据，我很难知道发生了什么。感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T01:01:57.297

未为放置请求设置内容类型标头。

# powershell - 如何通过 PowerShell 获取注册表项的所有权？

> ID：12044432
> 
> 赞同：5
> 
> 时间：2012-08-20T20:12:20.513
> 
> 标签：powershell, registry, acl

我正在尝试通过 PowerShell 获取注册表项的所有权，但它默默地失败了。我正在使用以下代码：

```
# get the username of the current user
$uname = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name

# create an identity reference for the owner
$user = new-object System.Security.Principal.NTAccount($uname)

# create a "drive" for HKEY_CLASSES_ROOT
new-psdrive -name HKCR_zf -psprovider Registry -root HKEY_CLASSES_ROOT

# change the current location
set-location HCKR_zf:\CLSID

# set ACLs
(get-acl '{E88DCCE0-B7B3-11d1-A9F0-00AA0060FA31}').setowner($user) 
```

直到最后一行，一切都运行良好，但 .setowner() 调用静默失败（所有者未更改）。

如何获得注册表项的所有权？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-03-07T12:11:00.417

有时脚本没有必要的所有权、特权或权限来更改注册表值。它需要管理员权限。下一个脚本递归地获取所有子项的权限。

调用示例：

```
# group BULTIN\Users takes full control of key and all subkeys
Take-Permissions "HKLM" "SOFTWARE\test"

# group Everyone takes full control of key and all subkeys
Take-Permissions "HKLM" "SOFTWARE\test" "S-1-1-0"

# group Everyone takes full control of key WITHOUT subkeys
Take-Permissions "HKLM" "SOFTWARE\test" "S-1-1-0" $false 
```

你只需要定义下一个函数：

```
function Take-Permissions {
    # Developed for PowerShell v4.0
    # Required Admin privileges
    # Links:
    #   http://shrekpoint.blogspot.ru/2012/08/taking-ownership-of-dcom-registry.html
    #   http://www.remkoweijnen.nl/blog/2012/01/16/take-ownership-of-a-registry-key-in-powershell/
    #   https://powertoe.wordpress.com/2010/08/28/controlling-registry-acl-permissions-with-powershell/

    param($rootKey, $key, [System.Security.Principal.SecurityIdentifier]$sid = 'S-1-5-32-545', $recurse = $true)

    switch -regex ($rootKey) {
        'HKCU|HKEY_CURRENT_USER'    { $rootKey = 'CurrentUser' }
        'HKLM|HKEY_LOCAL_MACHINE'   { $rootKey = 'LocalMachine' }
        'HKCR|HKEY_CLASSES_ROOT'    { $rootKey = 'ClassesRoot' }
        'HKCC|HKEY_CURRENT_CONFIG'  { $rootKey = 'CurrentConfig' }
        'HKU|HKEY_USERS'            { $rootKey = 'Users' }
    }

    ### Step 1 - escalate current process's privilege
    # get SeTakeOwnership, SeBackup and SeRestore privileges before executes next lines, script needs Admin privilege
    $import = '[DllImport("ntdll.dll")] public static extern int RtlAdjustPrivilege(ulong a, bool b, bool c, ref bool d);'
    $ntdll = Add-Type -Member $import -Name NtDll -PassThru
    $privileges = @{ SeTakeOwnership = 9; SeBackup =  17; SeRestore = 18 }
    foreach ($i in $privileges.Values) {
        $null = $ntdll::RtlAdjustPrivilege($i, 1, 0, [ref]0)
    }

    function Take-KeyPermissions {
        param($rootKey, $key, $sid, $recurse, $recurseLevel = 0)

        ### Step 2 - get ownerships of key - it works only for current key
        $regKey = [Microsoft.Win32.Registry]::$rootKey.OpenSubKey($key, 'ReadWriteSubTree', 'TakeOwnership')
        $acl = New-Object System.Security.AccessControl.RegistrySecurity
        $acl.SetOwner($sid)
        $regKey.SetAccessControl($acl)

        ### Step 3 - enable inheritance of permissions (not ownership) for current key from parent
        $acl.SetAccessRuleProtection($false, $false)
        $regKey.SetAccessControl($acl)

        ### Step 4 - only for top-level key, change permissions for current key and propagate it for subkeys
        # to enable propagations for subkeys, it needs to execute Steps 2-3 for each subkey (Step 5)
        if ($recurseLevel -eq 0) {
            $regKey = $regKey.OpenSubKey('', 'ReadWriteSubTree', 'ChangePermissions')
            $rule = New-Object System.Security.AccessControl.RegistryAccessRule($sid, 'FullControl', 'ContainerInherit', 'None', 'Allow')
            $acl.ResetAccessRule($rule)
            $regKey.SetAccessControl($acl)
        }

        ### Step 5 - recursively repeat steps 2-5 for subkeys
        if ($recurse) {
            foreach($subKey in $regKey.OpenSubKey('').GetSubKeyNames()) {
                Take-KeyPermissions $rootKey ($key+'\'+$subKey) $sid $recurse ($recurseLevel+1)
            }
        }
    }

    Take-KeyPermissions $rootKey $key $sid $recurse
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-21T06:13:38.280

只是调用`SetOwner`不会提交更改。您需要将 acl 对象传回`Set-Acl`以提交更改。

查看这个线程，有一个很好的描述和完整的示例代码。似乎还有一些其他的箍要跳过，以及：[http ://social.technet.microsoft.com/Forums/en/winserverpowershell/thread/e718a560-2908-4b91-ad42-d392e7f8f1ad](http://social.technet.microsoft.com/Forums/en/winserverpowershell/thread/e718a560-2908-4b91-ad42-d392e7f8f1ad)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-21T10:04:30.057

好吧，这是另一个帖子的澄清，但这真的很重要！

对于最后发布的脚本，请务必添加检查 $key 的安全性。否则，您将覆盖特定根密钥中的所有 RegKey。

回到还原点不起作用，因为计算机帐户无法再访问漏洞根密钥。

类似于： if ($key.length -eq 0) { write-host "key parameter must be set" return }

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-02T15:03:14.450

使用`{E88DCCE0-B7B3-11d1-A9F0-00AA0060FA31}`您需要使用的 ID 时`""`

例如：`(HKLM:\SOFTWARE\Classes\CLSID\"{031E4825-7B94-4dc3-B131-E946B44C8DD5}",Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree,[System.Security.AccessControl.RegistryRights]::takeownership)`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-07-21T14:32:23.637

另一个答案的变体。这仅设置所有权。

```
<#
.SYNOPSIS 
 Give ownership of a file or folder to the specified user.

.DESCRIPTION
 Give the current process the SeTakeOwnershipPrivilege" and "SeRestorePrivilege" rights which allows it
 to reset ownership of an object.  The script will then set the owner to be the specified user.

.PARAMETER Path (Required)
 The path to the object on which you wish to change ownership.  It can be a file or a folder.

.PARAMETER User (Required)
 The user whom you want to be the owner of the specified object.  The user should be in the format
 <domain>\<username>.  Other user formats will not work.  For system accounts, such as System, the user
 should be specified as "NT AUTHORITY\System".  If the domain is missing, the local machine will be assumed.

.PARAMETER Recurse (switch)
 Causes the function to parse through the Path recursively.

.INPUTS
 None. You cannot pipe objects to Take-Ownership

.OUTPUTS
 None

.NOTES
 Name:    Take-Ownership.ps1
 Author:  Jason Eberhardt
 Date:    2017-07-20
#>
function Take-Ownership {
  [CmdletBinding(SupportsShouldProcess=$false)]
  Param([Parameter(Mandatory=$true, ValueFromPipeline=$false)] [ValidateNotNullOrEmpty()] [string]$Path,
        [Parameter(Mandatory=$true, ValueFromPipeline=$false)] [ValidateNotNullOrEmpty()] [string]$User,
        [Parameter(Mandatory=$false, ValueFromPipeline=$false)] [switch]$Recurse)

  Begin {
    $AdjustTokenPrivileges=@"
using System;
using System.Runtime.InteropServices;

  public class TokenManipulator {
    [DllImport("kernel32.dll", ExactSpelling = true)]
      internal static extern IntPtr GetCurrentProcess();

    [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
      internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr prev, IntPtr relen);
    [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
      internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);
    [DllImport("advapi32.dll", SetLastError = true)]
      internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    internal struct TokPriv1Luid {
      public int Count;
      public long Luid;
      public int Attr;
    }

    internal const int SE_PRIVILEGE_DISABLED = 0x00000000;
    internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
    internal const int TOKEN_QUERY = 0x00000008;
    internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

    public static bool AddPrivilege(string privilege) {
      bool retVal;
      TokPriv1Luid tp;
      IntPtr hproc = GetCurrentProcess();
      IntPtr htok = IntPtr.Zero;
      retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
      tp.Count = 1;
      tp.Luid = 0;
      tp.Attr = SE_PRIVILEGE_ENABLED;
      retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
      retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
      return retVal;
    }

    public static bool RemovePrivilege(string privilege) {
      bool retVal;
      TokPriv1Luid tp;
      IntPtr hproc = GetCurrentProcess();
      IntPtr htok = IntPtr.Zero;
      retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
      tp.Count = 1;
      tp.Luid = 0;
      tp.Attr = SE_PRIVILEGE_DISABLED;
      retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
      retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
      return retVal;
    }
  }
"@
  }

  Process {
    $Item=Get-Item $Path
    Write-Verbose "Giving current process token ownership rights"
    Add-Type $AdjustTokenPrivileges -PassThru > $null
    [void][TokenManipulator]::AddPrivilege("SeTakeOwnershipPrivilege") 
    [void][TokenManipulator]::AddPrivilege("SeRestorePrivilege") 

    # Change ownership
    $Account=$User.Split("\")
    if ($Account.Count -eq 1) { $Account+=$Account[0]; $Account[0]=$env:COMPUTERNAME }
    $Owner=New-Object System.Security.Principal.NTAccount($Account[0],$Account[1])
    Write-Verbose "Change ownership to '$($Account[0])\$($Account[1])'"

    $Provider=$Item.PSProvider.Name
    if ($Item.PSIsContainer) {
      switch ($Provider) {
        "FileSystem" { $ACL=[System.Security.AccessControl.DirectorySecurity]::new() }
        "Registry"   { $ACL=[System.Security.AccessControl.RegistrySecurity]::new()
                       # Get-Item doesn't open the registry in a way that we can write to it.
                       switch ($Item.Name.Split("\")[0]) {
                         "HKEY_CLASSES_ROOT"   { $rootKey=[Microsoft.Win32.Registry]::ClassesRoot; break }
                         "HKEY_LOCAL_MACHINE"  { $rootKey=[Microsoft.Win32.Registry]::LocalMachine; break }
                         "HKEY_CURRENT_USER"   { $rootKey=[Microsoft.Win32.Registry]::CurrentUser; break }
                         "HKEY_USERS"          { $rootKey=[Microsoft.Win32.Registry]::Users; break }
                         "HKEY_CURRENT_CONFIG" { $rootKey=[Microsoft.Win32.Registry]::CurrentConfig; break }
                       }
                       $Key=$Item.Name.Replace(($Item.Name.Split("\")[0]+"\"),"")
                       $Item=$rootKey.OpenSubKey($Key,[Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree,[System.Security.AccessControl.RegistryRights]::TakeOwnership) }
        default { throw "Unknown provider:  $($Item.PSProvider.Name)" }
      }
      $ACL.SetOwner($Owner)
      Write-Verbose "Setting owner on $Path"
      $Item.SetAccessControl($ACL)
      if ($Provider -eq "Registry") { $Item.Close() }

      if ($Recurse.IsPresent) {
        # You can't set ownership on Registry Values
        if ($Provider -eq "Registry") { $Items=Get-ChildItem -Path $Path -Recurse -Force | Where-Object { $_.PSIsContainer } }
        else { $Items=Get-ChildItem -Path $Path -Recurse -Force }
        $Items=@($Items)
        for ($i=0; $i -lt $Items.Count; $i++) {
          switch ($Provider) {
            "FileSystem" { $Item=Get-Item $Items[$i].FullName
                           if ($Item.PSIsContainer) { $ACL=[System.Security.AccessControl.DirectorySecurity]::new() }
                           else { $ACL=[System.Security.AccessControl.FileSecurity]::new() } }
            "Registry"   { $Item=Get-Item $Items[$i].PSPath
                           $ACL=[System.Security.AccessControl.RegistrySecurity]::new()
                           # Get-Item doesn't open the registry in a way that we can write to it.
                           switch ($Item.Name.Split("\")[0]) {
                             "HKEY_CLASSES_ROOT"   { $rootKey=[Microsoft.Win32.Registry]::ClassesRoot; break }
                             "HKEY_LOCAL_MACHINE"  { $rootKey=[Microsoft.Win32.Registry]::LocalMachine; break }
                             "HKEY_CURRENT_USER"   { $rootKey=[Microsoft.Win32.Registry]::CurrentUser; break }
                             "HKEY_USERS"          { $rootKey=[Microsoft.Win32.Registry]::Users; break }
                             "HKEY_CURRENT_CONFIG" { $rootKey=[Microsoft.Win32.Registry]::CurrentConfig; break }
                           }
                           $Key=$Item.Name.Replace(($Item.Name.Split("\")[0]+"\"),"")
                           $Item=$rootKey.OpenSubKey($Key,[Microsoft.Win32.RegistryKeyPermissionCheck]::ReadWriteSubTree,[System.Security.AccessControl.RegistryRights]::TakeOwnership) }
            default { throw "Unknown provider:  $($Item.PSProvider.Name)" }
          }
          $ACL.SetOwner($Owner)
          Write-Verbose "Setting owner on $($Item.Name)"
          $Item.SetAccessControl($ACL)
          if ($Provider -eq "Registry") { $Item.Close() }
        }
      } # Recursion
    }
    else {
      if ($Recurse.IsPresent) { Write-Warning "Object specified is neither a folder nor a registry key.  Recursion is not possible." }
      switch ($Provider) {
        "FileSystem" { $ACL=[System.Security.AccessControl.FileSecurity]::new() }
        "Registry"   { throw "You cannot set ownership on a registry value"  }
        default { throw "Unknown provider:  $($Item.PSProvider.Name)" }
      }
      $ACL.SetOwner($Owner)
      Write-Verbose "Setting owner on $Path"
      $Item.SetAccessControl($ACL)
    }
  }
}

Take-Ownership -Path "Registry::HKCR\CLSID\{0D43FE01-F093-11CF-8940-00A0C9054228}" -User "Administrator" -Recurse -Verbose 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2018-11-17T22:34:19.567

@Slogmeister 和原著的作者，我必须说谢谢，我无法对此进行排序。你帮我这样做了，只有一个问题，你能否详细说明这背后的逻辑，管理员之上的权限结构是什么，这样管理员试图获得所有权就会失败（就像在你的脚本之前所做的那样）？此外，涉及哪些子系统以及可以去哪里了解它们。即，脚本与什么交互以及如何交互以及为什么交互 :) 我知道......但是知道这一点很重要，正如这个小练习所证明的那样。我基本上是在尝试重新安装 SSDT，因为某些密钥不允许更改它失败，以及许多其他包，基本上所有 SQL 相关。感谢磨坊，无论您是否有时间详细说明...

```
Registry::HKEY_CLASSES_ROOT\Installer\Components 
```

那是令人讨厌的关键。

# database - “..引用一个空值或瞬态值。” （糟糕的设计？） - 至少两列之一不能为空

> ID：12044434
> 
> 赞同：0
> 
> 时间：2012-08-20T20:12:32.593
> 
> 标签：database, nhibernate, model, mapping, fluent

一个品牌有一个图像（徽标 - 不可为空）。一个产品有许多图像。图像必须有品牌*或*产品，但我不能在任何一个字段上使用“不可为空”，因为图像只属于其中一个？

你将如何映射这种关系？

品牌 1----1 图片 *----1 产品

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:21:16.950

所以无论如何，一个图像总是有一个品牌或产品？一个品牌可以有多个图像吗？在大多数情况下，品牌或产品与图像是一对多的关系。

这意味着产品或品牌在任何给定时间都可以拥有图像。

我不确定你的措辞是否有意义。但通常在大多数情况下，Image 表将是一个查找表，并且必然与 Product 或 Brand 有关系，但 Brand 或 Product 会有一个 ImageID 列，因此是一对多的关系。

# entity-framework - EF 5 同步模型到数据库项目

> ID：12044435
> 
> 赞同：4
> 
> 时间：2012-08-20T20:12:32.480
> 
> 标签：entity-framework

目前，我们正在使用带有模型优先方法的 EF 4.1，然后我们使用 Entity Designer Database Generation Power Pack 将模型同步到 Visual Studio 2010 数据库项目。从那里我们使用数据库项目的部署功能来升级实际的数据库。这工作正常。我不得不编写一个干净的脚本来清除数据库项目中无关的注释，但这一切都解决了。

问题是 SQL Server 2012。我做了一个测试，我安装了 Sql Server 2012，而我们的 VS 2010 数据库项目不想部署到它。它说 Sql Server 2012 不是受支持的目标版本。好的，这只是意味着我需要安装 SSDT 并将项目转换为 Sql 数据库项目。这里的问题是没有将实体模型同步到 SSDT 项目的工具。Entity Designer Database Generation Power Pack 仅针对 VS 2010 数据库项目而非 SSDT 数据库项目构建。

这使我们无法升级到 SQL Server 2012 和 SSDT 项目。

我真的很喜欢数据库项目，因为它们允许我们对数据库模式进行源代码控制。我们可以添加额外的东西，比如报告存储过程等等。

我看过 Code First Migrations，但似乎没有 SSDT 项目丰富的功能。而且我不能 100% 确定您是否可以将该迁移与 edmx 设计器一起用于 Model First 实施。

那么我们该怎么办呢？

埃里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-27T22:10:08.213

事实上，从 edmx 同步到 SSDT 数据库项目是不可能的。您是否考虑过从 edmx 构建数据库并使用 SSDT 的模式比较工具将其同步到数据库项目？

与您之前的过程的唯一区别是构建这个中间数据库。

# jquery - IE 8 - 慢速点击事件识别 - 100 个可点击的表格单元格

> ID：12044438
> 
> 赞同：2
> 
> 时间：2012-08-20T20:12:41.980
> 
> 标签：jquery, internet-explorer-8, delegates, cell, html-table

我遇到的问题是客户大多都在使用 IE8。屏幕上有这么多元素，IE8 难以识别单击或导航到哪个单元格。速度是不可接受的，所以我正在寻找提高点击识别速度的方法。我已经安装了一个 jQuery Pagination 插件，它使用户能够更改显示的行数，这提高了一些速度，但还不够。

让我提出这个问题的原因是，使用 .delegation() 和 .click() 时点击识别速度没有区别。在 IE8 中，即使 .delegate 应该快得多。下面的 JSFiddle 是我最大的表的表示，大约 10,000 个单元格。它启用了“单击”和箭头键导航，因此您可以看到 IE8 和 Firefox/Chrome/etc 之间的速度明显差异。此外，IE8 中的 JSFiddle 可能很难呈现示例。

[http://jsfiddle.net/RaySuave/Q6vex/1/](http://jsfiddle.net/RaySuave/Q6vex/1/)
（jQuery 代码来自这个网站上的另一个帖子，我做了一些模组来满足我的需要）

我试图解决这个问题的最巧妙的失败尝试是将委派分配给固定数量的行，而不是像这样的模式中的整个表：

```
$(function(){
   $('table tr').slice(0, 5).delegate("td","click",function);
});

$(function(){
   $('table tr').slice(5,10).delegate("td","click",function);
});

$(function(){
   $('table tr').slice(10, 15).delegate("td","click",function);
}); 
```

仅供参考 - 在不同浏览器中测试 jQuery 事件处理方法的速度
[http://jsperf.com/bind-vs-click/41](http://jsperf.com/bind-vs-click/41)

为什么需要这么大的桌子？
我正在将过去手动填充到 excel 中的大型电子表格转换为动态的基于 Web 的站点，用户可以在其中通过单元格单击和箭头键导航来填充 HTML 表格单元格。单元格值将保存在数据库中。所有授权人员都可以通过网站访问这些表格以供查看。

我已经完成了所有的编码，包括用于使单元格可编辑的 jQuery、用于列标题的垂直文本以及通过 Coldfusion 和 MS-SQL 将值写入数据库。

提前感谢您的任何意见或建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-10T21:46:27.893

如果它可以帮助某人搜索缓慢的 ie8 问题：[How to force ie8 to repaint after adding a class to a dom element](https://stackoverflow.com/questions/13783840/how-to-force-ie8-to-repaint-after-adding-a-class-to-a-dom-element)。尽可能减少 DOM 上的元素和事件的数量，并使用`[some-attr]`选择器而不是`.some-class`选择器。

# c# - 我应该添加我的项目的哪些文件来部署我的 .NET3.5 Windows 应用程序？

> ID：12044442
> 
> 赞同：0
> 
> 时间：2012-08-20T20:12:57.550
> 
> 标签：c#, deployment, winapp

我已经通过 .NET 3.5 开发了一个 windows 应用程序，现在我想部署它以进行安装，我不知道我应该在 windows 安装程序中添加哪些文件？这是我的项目结构： - 我有一个名为“Images”的文件夹，其中有我的图像 - 我的 bin 文件夹中有几个 .dll 文件 - 我的 Windows 应用程序使用我开发的 Web 服务，因此我有一个 Web 参考我项目中的文件夹 - 我的 app.config 文件在根目录中 - 我必须在我的根目录中添加 .ico 文件 - .exe 文件在我的 bin 文件夹中

现在我应该添加哪些文件？而且我还想预编译我的项目并将其部署为 .dll 文件，请帮助我这是我第一次部署 win 应用程序项目。感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:16:47.947

一般来说，你不添加文件，你只是添加项目输出。Visual Studio 确定需要哪些文件。（参见文档）[http://msdn.microsoft.com/en-us/library/cc766795.aspx](http://msdn.microsoft.com/en-us/library/cc766795.aspx)

（编辑 - 这比上面的链接更好：[http](http://www.dreamincode.net/forums/topic/58021-deploying-a-c%23-application-visual-studio-setup-project/) ://www.dreamincode.net/forums/topic/58021-deploying-ac%23-application-visual-studio-setup-project/ ）

内容文件例外。假设您有要安装为项目的一部分的图像或 pdf 文件。但是，即使使用这些，您在定义安装程序时也无需指定任何内容，您只需确保为原始项目中的内容文件选择“始终复制”或“如果更新则复制”。

在您的情况下，应自动包含 .dll 文件、Web 引用和实际代码组件，但您可能需要在图像上指定“复制”选项。（见[http://www.flatredball.com/frb/docs/index.php?title=Tutorials:Adding_files_to_your_project](http://www.flatredball.com/frb/docs/index.php?title=Tutorials:Adding_files_to_your_project)）

# c# - ASP.net Web 应用程序 HTTP Post 数据库同步

> ID：12044443
> 
> 赞同：0
> 
> 时间：2012-08-20T20:13:00.137
> 
> 标签：c#, asp.net, web-services, post

我正在与客户合作为他们使用的程序设置数据库同步。该程序称为[Aljex](http://www.aljex.com/)；它是软件即服务。

Aljex 有一个用于数据库同步的 API，它给我的信息很少（和零示例）。有问题的部分如下：

> 全天使用来自 Aljex 的 HTTP post 将更改发送到客户的数据库服务器。白天从 Aljex 发送给客户的所有数据更改都使用包含单个记录数据的标准 HTTP 发布请求发送。HTTP post 的参数将包括一个指示数据表名称的参数，以及一个指示使用数据执行的适当操作（创建、更新或删除）的操作代码。

我目前使用 ASP.net Web 应用程序 (C#) 为该客户端托管了一个 winhost.com 站点。目标是将 Aljex 数据库与我可以读/写的数据库同步，以便为程序添加功能。

**问题：** 在 ASP.net 中处理这些发布请求需要什么？我对 Web 表单和 ASP.net 中的其他标准 Web 项目有经验，但我没有使用以下任何项目，我不确定这需要哪些：

*   启用 AJAX 的 WCF 服务
*   ASP.NET 处理程序
*   ASP.NET 模块
*   通用处理程序
*   WCF 数据服务
*   WCF 服务
*   网络服务
*   （*或者我可以使用 Web 表单来解决这个问题吗？）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T22:47:20.173

给猫剥皮的方法不止一种。

**选项1**

编写一个基本的 asp.net 处理程序来获取数据，解析它，创建提交的 post 参数的 json 字符串，并使用一些约定逻辑来调用处理 json 字符串的内部服务。

**选项 2**

编写一个基本的 MVC3 应用程序，它充当具有单个控制器和操作的代理。它获取数据、解析数据、创建提交的 post 参数的 json 字符串，并通过使用一些约定逻辑调用 REST 服务的另一个 url，该 REST 服务为您的资源提供 CRUD 操作。

您可以使用 ServiceStack 或 Web API 轻松开发 REST 服务。

# android - Android Activity 无法实例化

> ID：12044446
> 
> 赞同：1
> 
> 时间：2012-08-20T20:13:19.477
> 
> 标签：android, android-activity, actionbarsherlock, runtimeexception, instantiationexception

最近我安装了 Ubuntu 12.04 来代替我的 Win7。我使用 Eclipse Juno / Java7。但是当我尝试运行我的应用程序时，尽管一切都在它的位置，但我得到了以下错误行。我的清单有正确的类名。我的活动文件名也与我的清单中的一样正确。但奇怪的是，此错误仅在我使用 ActionBarSherloock 的项目中引起。是不是很奇怪？

现在来自我的 logcat 的错误行：

```
08-20 19:31:59.545: E/AndroidRuntime(764): FATAL EXCEPTION: main
08-20 19:31:59.545: E/AndroidRuntime(764): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.app.android/com.app.android.SplashActivity}: java.lang.ClassNotFoundException: com.app.android.SplashActivity
08-20 19:31:59.545: E/AndroidRuntime(764):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1880)
08-20 19:31:59.545: E/AndroidRuntime(764):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
08-20 19:31:59.545: E/AndroidRuntime(764):  at android.app.ActivityThread.access$600(ActivityThread.java:123)
08-20 19:31:59.545: E/AndroidRuntime(764):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
08-20 19:31:59.545: E/AndroidRuntime(764):  at android.os.Handler.dispatchMessage(Handler.java:99)
08-20 19:31:59.545: E/AndroidRuntime(764):  at android.os.Looper.loop(Looper.java:137)
08-20 19:31:59.545: E/AndroidRuntime(764):  at android.app.ActivityThread.main(ActivityThread.java:4424)
08-20 19:31:59.545: E/AndroidRuntime(764):  at java.lang.reflect.Method.invokeNative(Native Method)
08-20 19:31:59.545: E/AndroidRuntime(764):  at java.lang.reflect.Method.invoke(Method.java:511)
08-20 19:31:59.545: E/AndroidRuntime(764):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
08-20 19:31:59.545: E/AndroidRuntime(764):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
08-20 19:31:59.545: E/AndroidRuntime(764):  at dalvik.system.NativeStart.main(Native Method)
08-20 19:31:59.545: E/AndroidRuntime(764): Caused by: java.lang.ClassNotFoundException: com.app.android.SplashActivity
08-20 19:31:59.545: E/AndroidRuntime(764):  at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:61)
08-20 19:31:59.545: E/AndroidRuntime(764):  at java.lang.ClassLoader.loadClass(ClassLoader.java:501)
08-20 19:31:59.545: E/AndroidRuntime(764):  at java.lang.ClassLoader.loadClass(ClassLoader.java:461)
08-20 19:31:59.545: E/AndroidRuntime(764):  at android.app.Instrumentation.newActivity(Instrumentation.java:1023)
08-20 19:31:59.545: E/AndroidRuntime(764):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1871)
08-20 19:31:59.545: E/AndroidRuntime(764):  ... 11 more 
```

另请注意，我的 ABS 库很好。没有 jar 依赖错误和或类似的错误。总而言之，我在预编译过程中没有看到问题。仅抛出 RuntimeException。

谁能说可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:34:54.847

你的目录 说：

```
java.lang.ClassNotFoundException: com.app.android.SplashActivity 
```

**将 Splash Activity 添加到您的 Android 清单中！**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:58:32.837

这也可能是来自 Windows 的文件设置的问题 - Windows 使用奇怪/不同的方式`end of line`-`end of file`我遇到了从 Windows 到 Mac 的问题。

* * *

如上述问题所述，从具体错误来看，`SplashActivity.`如果它在子文件夹中，则必须是`/`链接`\`问题清单。

进入活动选项卡并单击您的`SplashActivity`- 从这里您应该单击类名称并让自动检测为您重新输入值。（我这台电脑上没有eclipse，所以我不能给你确切的说明，也许其他人可以？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:31:08.123

你提到这个应用程序使用 ActionBarSherlock。您的 Activity 是否扩展了 SherlockActivity？

好的，SherlockActivity 不是问题。嗯...您的应用程序链接的支持库版本与 ActionBarSherlock 使用的版本完全相同吗？（确保这一点的最佳方法是链接与编译 ABS 的同一个。）

# iphone - 构建一个非常简单的 LE 蓝牙外设

> ID：12044448
> 
> 赞同：0
> 
> 时间：2012-08-20T20:13:28.507
> 
> 标签：iphone, bluetooth, ios6, core-bluetooth, peripherals

出于教育和书呆子的原因，我正在尝试使用 CoreBluetooth 为 iPhone 4S 构建一个非常简单的蓝牙 LE 外围设备。对于外围设备本身，哪里可以买到便宜的 10 到 25 美元的蓝牙芯片来玩？谷歌和苹果都只给我带来了 100-150 美元的筹码。外围设备所要做的就是在按下按钮时向附近的 iPhone 发送一个“0”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:12:14.657

BLE芯片很便宜。例如，TI CC2540 的价格约为 2 美元，您可以免费获得一些样品芯片来玩。 [http://www.ti.com/product/cc2540#samplebuy](http://www.ti.com/product/cc2540#samplebuy)

只需 99 美元，您就可以获得一个易于使用的开发套件。2 美元解决方案的问题是您必须安装自己的开发板。

# objective-c - NSString 后缀的大小写不敏感检查

> ID：12044450
> 
> 赞同：9
> 
> 时间：2012-08-20T20:13:34.810
> 
> 标签：objective-c, nsstring, compare

我想检查一个字符串是否有某个后缀，但想做一个不区分大小写的检查。我需要一个替代方案：

```
if ([selectedFile hasSuffix:@"jpg"] ||
    [selectedFile hasSuffix:@"JPG"]) 
```

或JPG，JPG，JPG。有没有什么捷径可以做到这一点？我不知道我如何`caseInsensitiveCompare:`在这种情况下申请。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-08-20T20:15:35.777

```
[[selectedFile lowercaseString] hasSuffix:@"jpg"] 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-08-21T05:32:40.427

如果`selectedFile`是文件名，最好查看整个扩展名。您不太可能但可能会找到一个名为**ThisIsNotAnImage.asdfjpg**的文件。如果你只检查后缀，你会错误地断定这是一张图片。

幸运的是`NSString`，有许多处理路径的方法，包括`pathExtension`.

此外，您是否希望始终且仅接受 JPEG 图像，或者您可以加载的所有图像？大多数 Apple 的图像类都支持一系列令人印象深刻的文件格式。

如果您正在为 iOS 编写代码，则[UIImage 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html)`UIImage`中列出了被识别的图像格式，以及它们的扩展名。

如果您正在为 Mac OS 编写，`NSImage`则有一个名为 的类方法`imageFileTypes`，允许在运行时更改支持的格式。

如[UIImage 类参考](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html)中所述，JPEG 文件有时具有扩展名**.jpeg**。如果您手动查找 JPEG，则应同时检查**.jpg**和**.jpeg**。

## 仅测试 JPEG

```
NSString *extension = [selectedFile pathExtension];
BOOL isJpegImage = 
    (([extension caseInsensitiveCompare:@"jpg"] == NSOrderedSame) || 
     ([extension caseInsensitiveCompare:@"jpeg"] == NSOrderedSame));

if (isJpegImage)
{
    // Do image things here.
} 
```

## 测试 UIImage 可以加载的所有内容

```
NSString *loweredExtension = [[selectedFile pathExtension] lowercaseString];
// Valid extensions may change.  Check the UIImage class reference for the most up to date list.
NSSet *validImageExtensions = [NSSet setWithObjects:@"tif", @"tiff", @"jpg", @"jpeg", @"gif", @"png", @"bmp", @"bmpf", @"ico", @"cur", @"xbm", nil];
if ([validImageExtensions containsObject:loweredExtension])
{
    // Do image things here.
} 
```

## 测试 NSImage 可以加载的所有内容

```
NSString *loweredExtension = [[selectedFile pathExtension] lowercaseString];
NSSet *validImageExtensions = [NSSet setWithArray:[NSImage imageFileTypes]];
if ([validImageExtensions containsObject:loweredExtension])
{
    // Do image things here.
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T20:25:39.183

mipadi 的建议是最好的，但既然你提到`caseInsensitiveCompare:`了，这就是你将如何使用它：

```
BOOL hasSuffix = (NSOrderedSame == [[selectedFile substringFromIndex:[selectedFile length] - 3]] caseInsensitiveCompare:@"JPG"]); 
```

那是一口！

你也可以使用[`rangeOfString:options:`](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/doc/uid/20000154-rangeOfString_options_)，传递你的后缀和`NSCaseInsensitiveSearch`.

# ruby - ruby：将模式与延迟加载的文件匹配

> ID：12044452
> 
> 赞同：0
> 
> 时间：2012-08-20T20:13:38.887
> 
> 标签：ruby, regex, file-io, pattern-matching

有没有办法将 Ruby 模式与文件的内容进行匹配，只加载与模式匹配所需的文件？

例如，给定模式

```
p = /(abc)*/ 
```

和包含内容的文件 f

```
abcabcdefdef 
```

有没有办法在不从磁盘读取文件的最后三个字母（“def”）的情况下将 p 与 f 的内容进行匹配？基本上，我希望只根据需要加载一个大文件，同时仍然能够将模式与文件的任意长部分进行匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:33:30.723

使用 Enumerator 延迟加载文件块：

```
CHUNK_SIZE = 1024 # adjust to best fit the size of your matching regex
def file_overlapping_chunks filename
  Enumerator.new do |yielder|
    pos = 0
    while pos < File.size(filename)
      data = File.open(filename,'r') { |f| f.seek(pos); f.read(CHUNK_SIZE) }
      yielder.yield(data)
      pos += (CHUNK_SIZE / 2) # adjust to best fit size of your matching regex
    end
  end
end

chunker = file_overlapping_chunks('my_big_file')
chunker.find { |chunk| chunk =~ /xyz/ } 
```

枚举器允许延迟加载文件的各个部分。文件块是重叠的，这样匹配的数据就不会落在块边界上而丢失。当我（草率地）实现它时，文件没有保持打开状态，因此不需要 open() 或 close() 来使用它。这也不是最快的方法，但它很容易使用 - 只需使用文件名调用并使用提供的枚举器。

# jquery-mobile - 桌面浏览器的 jquerymobile 站点演示（身高问题）

> ID：12044453
> 
> 赞同：0
> 
> 时间：2012-08-20T20:13:40.693
> 
> 标签：jquery-mobile

我试图向客户展示 jquerymobile 网站的外观。但我想在桌面浏览器中演示它。我已经将样式应用于身体

```
<body style="position:relative; margin-left: auto; margin-right: auto; width:320px; height:480px;"> 
```

但是 height:480px 没有任何效果。似乎jquerymobile总是根据视口高度调整页面高度请告知jquerymobile如何适应480高度谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-29T15:59:34.033

我使用了一个[由 Brian Apps 开发的名为 Sizer](http://www.brianapps.net/sizer/)的小 Windows 应用程序，它可以让我通过右键单击标题栏快速将窗口调整为精确尺寸。我有 iPhone 和 iPad 的分辨率，以及笔记本电脑的常用分辨率，因此我可以快速预览这些区域的网站。

当然，这并不是 100% 准确的，因为它没有考虑到每个设备的不同 DPI，但是如果您需要这样做，可以使用更全面（且更昂贵）的模拟器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T22:17:42.250

为什么不直接调整浏览器窗口的大小？如果您将浏览器窗口（即 Safari）的宽度和高度缩小到所需的高度和宽度，Jquery mobile（如果您使用正确的话）将正确显示。我觉得您正在尝试以艰难的方式实现这一目标。

# asp.net - 在查询字符串中传递值以自动填充表单上的字段

> ID：12044457
> 
> 赞同：4
> 
> 时间：2012-08-20T20:14:04.263
> 
> 标签：asp.net, html, forms, query-string

我想将一些字段（例如名称信息）传递到表单中。我可能不是这个表单的开发者，所以我不确定页面加载或查询字符串是如何处理的。

通过环顾四周，您可以通过某些 Web 表单的`name`属性调用文本字段，并自动设置这些字段。例如，SO 就是这样做的。如果您访问[https://stackoverflow.com/questions/ask?title=THISISMYTITLE](https://stackoverflow.com/questions/ask?title=THISISMYTITLE)，第一个字段（标题字段）将填写 THISISMYTITLE。

另一个很好的例子是 redmine。在这种情况下，我可以通过查询字符串将任何一个字段（甚至是自定义字段）设置为值。

最后，有像 1Password 这样的工具可以在 Mac 和 Windows 上执行类似的操作——它将密码存储在本地数据库中。您可以让它启动您的浏览器，然后放入内容中。

出于某种原因，当我尝试将这样的查询字符串传递给我开发的一些 asp.net Web 应用程序时，页面加载方法似乎通过了它们。它知道它们在那里（我可以在 Request.QueryString 对象中看到它们），但它不会填写这些字段。

有没有一种可靠的方法可以做到这一点，而不必要求开发人员更新代码？为什么有些网页允许这样做，而有些则不允许？它似乎也与浏览器无关 - IE 和 Chrome 的行为方式相同。

**注意**- 这是给我的，通过使用查询字符串或类似的东西将字段传递到任何网页。这不适用于访问网页本身的字段。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:22:33.770

这不会自动发生，您必须在表单中显式设置值以读取`QueryString`. 如果 SO 和其他网站似乎这样做是因为他们的代码正在 URL 中查找这些参数并在表单中填充适当的元素。

就像是：

```
txtTitle.Text = Request.QueryString["Title"]; 
```

等等...

# python - urwid 不会在 loop.draw_screen() 上更新屏幕

> ID：12044463
> 
> 赞同：3
> 
> 时间：2012-08-20T20:14:49.733
> 
> 标签：python, urwid

这很奇怪，但是当我运行程序时，它只更新了 20 次屏幕中的 1 次......而且如果我按任意键 - 它也不会更新。如果像`python code.py 2>log`. 而且`mylog.log`我用于内部日志记录 - 它说`refresh()`工作正确......

```
import urwid
from random import randint
import thread,logging
from time import sleep
logging.basicConfig(format = u'%(levelname)-8s [%(asctime)s] %(message)s', level = logging.CRITICAL, filename = u'mylog.log')

class ArRow (urwid.WidgetWrap):
    def __init__ (self):
        self.build_row()
        w = urwid.Columns(self.item)
        self.__super.__init__(w)
    def build_row(self):
        w=5
        self.item = [
            ('fixed',w,urwid.AttrWrap(urwid.Text(str(randint(1,100))), 'body', 'focus')),
            ('fixed',w,urwid.AttrWrap(urwid.Text(str(randint(1,100))), 'body', 'focus')),
            ('fixed',w,urwid.AttrWrap(urwid.Text(str(randint(1,100))), 'body', 'focus')),
        ]
    def refresh(self):
        self.build_row()
        w = urwid.Columns(self.item)
        self.__super.__init__(w)
        logging.critical(str(self.item))
    def selectable (self):
        return True
    def keypress(self, size, key):
        return key

palette = [
    ('body','dark cyan', '', 'standout','#0f6',''),
    ('focus','dark red', '', 'standout','light red',''),
    ]

def keystroke (input):
    if input in ('q', 'Q'):
        raise urwid.ExitMainLoop()

items=[ArRow()]#,ArRow(),ArRow(),ArRow(),ArRow()]
listbox = urwid.ListBox(urwid.SimpleListWalker(items))
view = urwid.Frame(urwid.AttrWrap(listbox, 'body'))
loop = urwid.MainLoop(view, palette, unhandled_input=keystroke)
loop.screen.set_terminal_properties(colors=256)

def live_report(*a):
    while True:
        items[0].refresh()
        loop.draw_screen()
        sleep(2)

thread.start_new(live_report,(0,))
loop.run() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:51:20.093

解决方案：

```
class ArRow (urwid.WidgetWrap):
    def __init__ (self):
        self.build_row()
        self._w = AColumns(self.item)
        self.__super.__init__(self._w)
    def build_row(self):
        w=5
        self.item = [
            ('fixed',w,urwid.AttrWrap(urwid.Text(str(randint(1,100))), 'body', 'focus')),
            ('fixed',w,urwid.AttrWrap(urwid.Text(str(randint(1,100))), 'body', 'focus')),
            ('fixed',w,urwid.AttrWrap(urwid.Text(str(randint(1,100))), 'body', 'focus')),
        ]
    def refresh(self):
        self.build_row()
        self._w = AColumns(self.item)
        #self.__super.__init__(w)
        logging.critical(str(self.item))
......

def refresh(_loop,_data):
    for item in items:
        item.refresh()
    #loop.draw_screen()
    _loop.set_alarm_in(2,refresh)

loop.set_alarm_in(2,refresh)
loop.run() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-14T23:34:46.127

你为什么不只是

```
import threading

def refreshScreen(mainloop):
    while 1:
        logging.debug("looping")
        mainloop.draw_screen()
        time.sleep(1)

mainloop = urwid.MainLoop(top, palette)
refresh = Thread(target=refreshScreen, args=(mainloop,))
refresh.start()
mainloop.run() 
```

# c# - 检查 C# Expando 类中是否存在属性

> ID：12044465
> 
> 赞同：10
> 
> 时间：2012-08-20T20:14:56.917
> 
> 标签：c#, dynamic, expandoobject

我想看看 C# Expando 类中是否存在属性。

很像 python 中的[hasattr](https://stackoverflow.com/questions/6339032/app-engine-check-to-see-if-a-property-exists-within-expando-class)函数。我想要 hasattr 的 c# 等价物。

像这样的东西......

```
if (HasAttr(model, "Id"))
{
  # Do something with model.Id
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-08-20T20:16:54.833

尝试：

```
dynamic yourExpando = new ExpandoObject();
if (((IDictionary<string, Object>)yourExpando).ContainsKey("Id"))
{
    //Has property...
} 
```

ExpandoObject 显式实现`IDictionary<string, Object>`，其中 Key 是属性名称。然后，您可以检查字典是否包含密钥。如果你需要经常做这种检查，你也可以写一个小辅助方法：

```
private static bool HasAttr(ExpandoObject expando, string key)
{
    return ((IDictionary<string, Object>) expando).ContainsKey(key);
} 
```

并像这样使用它：

```
if (HasAttr(yourExpando, "Id"))
{
    //Has property...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T10:30:03.323

根据 vcsjones 的回答，它会更好：

```
private static bool HasAttr(this ExpandoObject expando, string key)
{
    return ((IDictionary<string, Object>) expando).ContainsKey(key);
} 
```

进而：

```
dynamic expando = new ExpandoObject();
expando.Name = "Test";

var result = expando.HasAttr("Name"); 
```

# c# - Linq 到 SQL 到 DataGridView

> ID：12044466
> 
> 赞同：1
> 
> 时间：2012-08-20T20:15:05.903
> 
> 标签：c#, sql, linq, datagridview

如果这看起来有点奇怪，请原谅我。我是一个相当新的 C# 初学者。

我有一个 linq to sql 查询，它填充表单上的各个字段。表单的另一部分需要根据文本框“employeeNumberTextBox”的值从另一个表中提取信息。然后将该数据显示在`DataGridView`.

我尝试使用以下代码；但是，我认为可能让我感到困惑的是以下事实：a）表上有一个日期字段，b）此表中的employeeNumber 有多行。会是一个准确的假设吗？

```
 int searchValue = Convert.ToInt32(employeeNumberTextBox.Text.Trim());

        var qry = (from p in Globals.db.Employees_Histories
                   where p.employeeNumber.Equals(searchValue)
                   select p).ToList();

        employees_HistoryDataGridView.DataSource = qry; 
```

我不断收到错误消息，说类型不匹配；但是，我试图弄清楚这到底是什么意思，这让我有点困惑。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:01:48.273

在我的选项中，employeeNumber 文件是 Number，您应该使用 Int32.Pars 转换为 Int，如下所示：

```
var searchValue = Int32.Parse(employeeNumberTextBox.Text.Trim()); 
```

确保您的输入是数字

# gis - 有没有办法将地图划分为方形网格并从那里检索纬度/经度信息？

> ID：12044467
> 
> 赞同：7
> 
> 时间：2012-08-20T20:15:09.303
> 
> 标签：gis, kml, latitude-longitude, google-earth

我有一张特定区域的地图，我需要确定给定位置（带有经纬度坐标）是否落入覆盖该地图的任何网格中。

我决定使用 Google Earth 将我获得的区域地图划分为 1 公里 x 1 公里的正方形网格 - 使用 CTRL+L 启用正方形网格并缩放到适当的比例，使网格线彼此相距 1000 米- 并将整个数据提取为 KML，以便获取地图中每个网格角的纬度和经度值并从那里进行查找 - 查看给定的 lon/lat 是否落入任何方形网格以及是否确实如此，哪个网格等等-但我不知道这是否可以完成-如果Google Earth允许我以KML格式提取其自己的方形网格坐标-。

有人可以提供有关这是否可能的任何信息，如果可能的话，如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T06:39:19.940

例如，考虑纬度 89N 和纬度 90N（北极）之间的区域。地球在纬度 90N 的周长为 0，因此，这个总面积是圆形的。

不可能将球体或椭圆体表面的任何部分划分为不重叠的、可调整的矩形。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T22:11:54.700

不太确定这是否是您要问的，但您可以获得当前全球视图的纬度和经度。

```
var view = ge.getView().copyAsLookAt(ge.ALTITUDE_RELATIVE_TO_GROUND);
view.getLatitude();
view.getLongitude(); 
```

以下是有关当前视图和相机的更多信息：[https ://developers.google.com/earth/documentation/camera_control](https://developers.google.com/earth/documentation/camera_control)

# c# - 将时间格式 00:44:50 转换为 ('00:44:50.240000')

> ID：12044471
> 
> 赞同：0
> 
> 时间：2012-08-20T20:15:22.757
> 
> 标签：c#, sql, sql-server

```
 string val;
            val = Request.Form["timerData"].ToString();            
            TimeSpan ts = TimeSpan.FromMilliseconds(Convert.ToInt32(val.ToString()));
            lbTime.Text = ts.ToString(); 
```

*   这里 lbTime.Text 以 00:44:50 格式返回我的时间值。

*   在我的 Sql 数据库中，我使用 Time(7) 数据类型作为时间，其
    默认值为 ('00:00:00.0000000')

*   我想将此格式 00:44:50 转换为 ('00:44:50.240000') 并使用更新语句将其输入数据库。

*以上时间仅供参考*

请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:35:31.760

如果您的更新语句是*参数化*的或者您使用存储过程，则将 a[传递`TimeSpan`给`time(7)`列应该可以正常工作](http://msdn.microsoft.com/en-us/library/ms131092.aspx)。像这样的东西：

```
public static void UpdateTimestamp( int id , TimeSpan ts )
{
  using ( SqlConnection connection = new SqlConnection( "some-connect-string" ) )
  using ( SqlCommand    command    = connection.CreateCommand() )
  {
    command.CommandText = "update foo set duration = @duration where id = @id" ;

    command.Parameters.AddWithValue( "@id"       , id ) ;
    command.Parameters.AddWithValue( "@duration" , ts ) ;

    connection.Open() ;
    int rowsAffected = command.ExecuteNonQuery() ;
    connection.Close() ;

    if ( rowsAffected == 0 ) throw new InvalidOperationException( "That didn't work B^(" ) ;
    if ( rowsAffected >  0 ) throw new InvalidOperationException( "That shouldn't have happend B^(" ) ;

  }

  return ;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:18:44.830

尝试其中之一：

```
DateTime date1 = new DateTime(2008, 8, 29, 19, 27, 15, 18);
CultureInfo ci = CultureInfo.InvariantCulture;

Console.WriteLine(date1.ToString("hh:mm:ss.f", ci));
// Displays 07:27:15.0
Console.WriteLine(date1.ToString("hh:mm:ss.F", ci));
// Displays 07:27:15
Console.WriteLine(date1.ToString("hh:mm:ss.ff", ci));
// Displays 07:27:15.01
Console.WriteLine(date1.ToString("hh:mm:ss.FF", ci));
// Displays 07:27:15.01
Console.WriteLine(date1.ToString("hh:mm:ss.fff", ci));
// Displays 07:27:15.018
Console.WriteLine(date1.ToString("hh:mm:ss.FFF", ci));
// Displays 07:27:15.018 
```

您甚至可以使用更多的“FFFFF”来表示秒分数的最多**七个**最高有效数字。

取自：http: [//msdn.microsoft.com/en-us/library/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)

它有帮助吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T21:24:16.250

我使用了相同的代码，唯一的错误是我在将值传递给时间跨度之前将其转换为 int

```
string val;
            val = Request.Form["timerData"].ToString();            
            TimeSpan ts = TimeSpan.FromMilliseconds(Convert.ToDouble(val.ToString()));
            lbTime.Text = ts.ToString(); 
```

**解决了**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T21:17:13.470

在你最后的表达中你说

```
ts.ToString() 
```

如果不是所有数字都为零，则此重载仅显示小数秒。您可能想要使用自定义格式字符串，如

```
ts.ToString(@"hh\:mm\:ss\.fffffff") 
```

反而。这应该适用于 .NET 4.5 和 4.0。请参阅[MSDN：自定义 TimeSpan 格式字符串](http://msdn.microsoft.com/en-us/library/ee372287.aspx)。

# wordpress - 如何获取 WP 电子商务产品的高度和宽度？

> ID：12044477
> 
> 赞同：1
> 
> 时间：2012-08-20T20:15:43.530
> 
> 标签：wordpress, wordpress-theming

我是 wordpress 的新手。我正在使用 WP 电子商务插件开发一个 wordpress 电子商务主题，并试图在主题中获取产品尺寸信息。但它没有发生。你可以在这里看到[http://screencast.com/t/ajb18CXi](http://screencast.com/t/ajb18CXi)。是否有任何内置的 wpsc 功能或其他东西来完成这项工作？

提前致谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T08:54:12.963

您只需要获取产品元数据：

```
$metadata = get_post_meta(wpsc_the_product_id(), '_wpsc_product_metadata', true); 
```

然后像这样使用它：

```
$height = $metadata['dimensions']['height'];
$width = $metadata['dimensions']['width'];
... 
```

# objective-c - 使用 Objective C 向 Web 服务器发送 POST

> ID：12044484
> 
> 赞同：0
> 
> 时间：2012-08-20T20:16:08.880
> 
> 标签：objective-c, ios, xcode, post, webserver

我有一个非常基本的内部 iOS 应用程序，我想将 POST 发送到网络服务器。你基本上有一堆按钮，根据你按下的按钮，它会向网络服务器发送一个预定义的“消息”。

按下按钮后，它会将它们带到另一个视图并表示感谢您选择您按下的按钮。我还希望将预定义的消息发送到网络服务器，格式化，然后通过电子邮件发送到静态电子邮件地址。

这就是我到目前为止所拥有的......我只是想找出发送 POST 的最佳方式。我设置的方式是最好的方式吗？还是有更聪明的方法来做到这一点？

对不起，如果它是混乱和无组织的。我对 iOS 开发很陌生。

```
@interface DrinkViewController () {
NSString *buttonlabel;
NSString *urlEncodeUsingEncoding;
}
@end

@implementation DrinkViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
}

-(IBAction)selectButton:(id)sender{
    NSLog(@"Button Pressed:%d",((UIButton *)sender).tag);
    NSString *dvalue;
    switch (((UIButton *)sender).tag) {
        case 1:
            dvalue = @"Button 1";
            break;
        case 2:
            dvalue = @"Button 2";
            break;
        case 3:
            dvalue = @"Button 3";
            break;
        case 4:
            dvalue = @"Button 4";
            break;
        case 5:
            dvalue = @"Button 5";
            break;
        case 6:
            dvalue = @"Button 6";
            break;
        case 7:
            dvalue = @"Button 7";
            break;

    }
    buttonlabel = dvalue;

    [self performSegueWithIdentifier:@"selectionTransition" sender:sender];

    NSData *postData = [buttonlabel dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
    NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];
    NSMutableURLRequest *request =  [NSMutableURLRequest alloc];
                                    [request setURL:[NSURL URLWithString:@"http://www.abc.com/form.php"]];
                                    [request setHTTPMethod:@"POST"];
                                    [request setValue:postLength forHTTPHeaderField:@"Content-Length"];
                                    [request setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
                                    [request setHTTPBody:postData];
    NSLog(@"POST: %@ sent to %@", buttonlabel, request);
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"selectionTransition"]) {

        NSLog(@"%@", buttonlabel);
        // Get destination view
        DetailViewController *vc = [segue destinationViewController];

        // Pass the information to your destination view
        [vc setLabelValue:buttonlabel];
    }
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:01:11.417

以下是您需要使用的：NSURLRequest、NSURLConnection、NSURLResponse、NSURL。您可能会使用另一个库，但我建议您尝试了解这些类是如何工作的（因为您是新手）。

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLRequest_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLRequest_Class/Reference/Reference.html)

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsurlconnection_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/nsurlconnection_Class/Reference/Reference.html)

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLResponse_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLResponse_Class/Reference/Reference.html)

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURL_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURL_Class/Reference/Reference.html)

它是这样工作的：你使用服务器 url，创建一个 NSURLRequest，分配正确的 HTTP 方法（POST、GET 等）和其他必要的请求头，然后你会调用 NSURLConnection 来获取响应和服务器数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:53:56.587

我的建议是使用 3rd 方库。它将大大简化您的流程并为您节省大量时间。我通常使用 AFNetworking 库。

[https://github.com/AFNetworking/AFNetworking](https://github.com/AFNetworking/AFNetworking)

这里有一个 POST 示例：

[http://www.6foot3foot.com/developer-journal/afnetworking-php](http://www.6foot3foot.com/developer-journal/afnetworking-php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:59:14.247

看看[这篇文章](https://stackoverflow.com/questions/10618056/how-to-post-more-parameters-with-image-upload-code-in-ios)。我编写了一个使用 AFNetworking（我最喜欢的第 3 方库）的 NetworkClient 类。这非常灵活，可以随意修改以满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T21:58:52.053

到目前为止，我还不是专家，但我确实在我的代码中进行了网络调用。我选择了[MKNetworkKit](https://github.com/MugunthKumar/MKNetworkKit)来替换我抱歉的网络代码。

以下是您如何在项目中使用它的示例：

```
- (void)myFunctionToSendDataToTheServer
{
    /*
     *  So here is a basic idea of how you could quickly use MKNetworkKit.
     *  the [op addData:postData forKey:@"postDataKey"]; call is where you're
     *  add that post data to the request body.
     */
    NSString *someVariableYouWantPosted;
    NSData *postData = [someVariableYouWantPosted dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];

    MKNetworkEngine *engine = [[MKNetworkEngine alloc] initWithHostName:@"abc.com"];

    MKNetworkOperation *op = [engine operationWithPath:@"/form.php"];
    [op addData:postData forKey:@"postDataKey"];

    /*
     *  If you're not familiar with blocks then this "onCompletion^" might look weird.
     *  Inside of the curly braces will get called when the request is done.
     */

    [op onCompletion:^(MKNetworkOperation *completedOperation) {
        NSLog(@"Successful response from server: %@", [completedOperation responseString]);

        /*
         *  There are also some nice helper methods for extracting the response data in a different form
         *  [completedOperation responseJSON];
         *  [completedOperation responseImage];
         *  [completedOperation responseData];
         */

    } onError:^(NSError *error) {
        if ([error code] == kCFURLErrorNotConnectedToInternet) {
            /*
             *  Maybe retry? 
             *  This network kit also comes with a "freezable" property on the MKNetworkOperation.
             *  If you set that to YES then you don't need to worry about internet connectivity,
             *  the kit will try to send later when it reconnects.
             */
        }
        else {
            /*
             *  You'll have your work cut out for you here. Sourcing the problem can be difficult.
             *  Simply an alert message or loggin the NSError to find out where you went wrong.
             */
        }

    }];

    /*
     * Don't forget to call "enqueueOperation:".
     *  This actually gets the request going and sends it off to the server.
     */

    [engine enqueueOperation:op];
} 
```

如果您对此主题有任何其他问题，或者我不清楚，请告诉我。

# python - scrapy错误：exceptions.IOError：无法识别图像文件

> ID：12044488
> 
> 赞同：3
> 
> 时间：2012-08-20T20:16:20.897
> 
> 标签：python, scrapy

在不知道图像文件名或跟踪它的响应 url 的情况下，我多次收到以下错误：

```
2012-08-20 08:14:34+0000 [spider] Unhandled Error
Traceback (most recent call last):
  File "/usr/lib/python2.7/dist-packages/twisted/internet/defer.py", line 545, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
  File "/usr/lib/python2.7/dist-packages/twisted/internet/defer.py", line 362, in callback
    self._startRunCallbacks(result)
  File "/usr/lib/python2.7/dist-packages/twisted/internet/defer.py", line 458, in _startRunCallbacks
    self._runCallbacks()
  File "/usr/lib/python2.7/dist-packages/twisted/internet/defer.py", line 545, in _runCallbacks
    current.result = callback(current.result, *args, **kw)
--- <exception caught here> ---
  File "/usr/lib/pymodules/python2.7/scrapy/contrib/pipeline/images.py", line 204, in media_downloaded
    checksum = self.image_downloaded(response, request, info)
  File "/usr/lib/pymodules/python2.7/scrapy/contrib/pipeline/images.py", line 252, in image_downloaded
    for key, image, buf in self.get_images(response, request, info):
  File "/usr/lib/pymodules/python2.7/scrapy/contrib/pipeline/images.py", line 261, in get_images
    orig_image = Image.open(StringIO(response.body))
  File "/usr/lib/python2.7/dist-packages/PIL/Image.py", line 1980, in open
    raise IOError("cannot identify image file")
exceptions.IOError: cannot identify image file 
```

那么，我该如何解决这个问题呢？因为它在我已经在 settings.py 中定义的特定数量的错误之后停止了我的蜘蛛

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:04:29.383

违规行在`Image.open()`scrapy.contrib.pipelines.images.ImagesPipeline 中使用 PIL：

```
def get_images(self, response, request, info):
    key = self.image_key(request.url)
    orig_image = Image.open(StringIO(response.body)) 
```

media_downloaded() 中的 try 块捕获了这一点，但本身会发出错误：

```
except Exception:
    log.err(spider=info.spider) 
```

您可以使用以下方法破解此文件：

```
try:
    key = self.image_key(request.url)
    checksum = self.image_downloaded(response, request, info)
except ImageException, ex:
    log.msg(str(ex), level=log.WARNING, spider=info.spider)
    raise
except IOError, ex:
    log.msg(str(ex), level=log.WARNING, spider=info.spider)
    raise ImageException
except Exception:
    log.err(spider=info.spider)
    raise ImageException 
```

但更好的选择是创建自己的管道并覆盖 pipelines.py 文件中的 image_downloaded() 方法：

```
from scrapy import log
from scrapy.contrib.pipeline.images import ImagesPipeline

class BkamImagesPipeline(ImagesPipeline):

    def image_downloaded(self, response, request, info):
        try:
            super(BkamImagesPipeline, self).image_downloaded(response, request, info)
        except IOError, ex:
            log.msg(str(ex), level=log.WARNING, spider=info.spider) 
```

请务必在您的设置文件中声明此管道：

```
ITEM_PIPELINES = [
    'bkam.pipelines.BkamImagesPipeline',
] 
```

# haskell - 在 Haskell 中存储多态回调

> ID：12044490
> 
> 赞同：10
> 
> 时间：2012-08-20T20:16:23.610
> 
> 标签：haskell, callback, monads, polymorphism

提前，很抱歉这篇长文。

我正在用 Haskell 编写一个事件驱动的应用程序，因此我需要存储几个回调函数以供进一步使用。我希望这样的回调是：

*   *丰富*：使用`ReaderT`, `ErrorT`，`StateT`而不是裸`IO`s ；
*   *多态*：类型`(MonadIO m, MonadReader MyContext m, MonadState MyState m, MonadError MyError m) => m ()`，而不是`ReaderT MyContext (StateT MyState (ErrorT MyError IO)))`

为了简单起见，让我们忘记`State`and层。`Error`

我开始写所有回调的记录，存储在里面`MyContext`，比如：

```
 data MyContext = MyContext { _callbacks :: Callbacks {- etc -} }

    -- In this example, 2 callbacks only
    data Callbacks = Callbacks {
        _callback1 :: IORef (m ()),
        _callback2 :: IORef (m ())} 
```

主要问题是：在哪里放置类型类约束`m`？我尝试了以下，但没有编译：

*   我想我可能会参数化`Callbacks`，`m`例如：

    ```
    data (MonadIO m, MonadReader (MyContext m) m) => Callbacks m = Callbacks {
       _callback1 :: IORef (m ()),
       _callback2 :: IORef (m ())} 
    ```

    作为`Callbacks`的一部分`MyContext`，后者也必须进行参数化，这会导致无限类型问题 ( `MonadReader (MyContext m) m`)。

*   然后我想到了使用*存在量词*：

    ```
    data Callbacks = forall m . (MonadIO m, MonadReader MyContext m) => Callbacks {
       _callback1 :: IORef (m ()),
       _callback2 :: IORef (m ())} 
    ```

    在我编写在以下位置注册新回调的实际代码之前，它似乎工作正常`Callbacks`：

    ```
    register :: (MonadIO m, MonadReader MyContext m) => m () -> m ()
    register f = do
      (Callbacks { _callback1 = ref1 }) <- asks _callbacks -- Note the necessary use of pattern matching
      liftIO $ modifyIORef ref1 (const f) 
    ```

    但我收到以下错误（此处简化）：

    ```
    Could not deduce (m ~ m1)
      from the context (MonadIO m, MonadReader MyContext m)
        bound by the type signature for
             register :: (MonadIO m, MonadReader MyContext m) => m () -> m ()
      or from (MonadIO m1, MonadReader MyContext m1)
        bound by a pattern with constructor
             Callbacks :: forall (m :: * -> *).
                       (MonadIO m, MonadReader MyContext m) =>
                       IORef (m ())
                       -> IORef (m ())
                       -> Callbacks,
      Expected type: m1 ()
      Actual type: m () 
    ```

    我找不到解决方法。

如果有人能启发我，我将不胜感激。如果有的话，设计这个*的好方法是什么？*

预先感谢您的意见。

**[编辑]**据我了解 ysdx 的回答，我尝试在`m`不施加任何类型类约束的情况下参数化我的数据类型，但后来我无法创建;`Callbacks`的实例`Data.Default`。写这样的东西：

```
instance (MonadIO m, MonadReader (MyContext m) m) => Default (Callbacks m) where
  def = Callbacks {
    _callback1 = {- something that makes explicit use of the Reader layer -},
    _callback2 = return ()} 
```

...导致 GHC 抱怨：

```
Variable occurs more often in a constraint than in the instance head
  in the constraint: MonadReader (MyContext m) m 
```

它建议使用 UndecidableInstances，但我听说这是一件非常糟糕的事情，虽然我不知道为什么。这是否意味着我必须放弃使用`Data.Default`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T22:11:56.917

简单的改编（使东西编译）：

```
data MyContext m = MyContext { _callbacks :: Callbacks m }

data Callbacks m = Callbacks {
  _callback1 :: IORef (m ()),
  _callback2 :: IORef (m ())}

-- Needs FlexibleContexts:
register :: (MonadIO m, MonadReader (MyContext m) m) => m () -> m ()
register f = do
  (Callbacks { _callback1 = ref1 }) <- asks _callbacks
  liftIO $ modifyIORef ref1 (const f) 
```

但是 -XFlexibleContexts 是必需的。

你真的需要 IORef 吗？为什么不使用简单的状态单子？

```
import Control.Monad.State
import Control.Monad.Reader.Class
import Control.Monad.Trans

data Callbacks m = Callbacks {
  _callback1 :: m (),
  _callback2 :: m ()
  }

-- Create a "new" MonadTransformer layer (specialization of StateT):

class Monad m => MonadCallback m where
  getCallbacks :: m (Callbacks m)
  setCallbacks :: Callbacks m -> m ()

newtype CallbackT m a = CallbackT (StateT (Callbacks (CallbackT m) ) m a)

unwrap (CallbackT x) = x

instance Monad m => Monad (CallbackT m) where
  CallbackT x >>= f = CallbackT (x >>= f')
    where f' x = unwrap $ f x
  return a =  CallbackT $ return a
instance Monad m => MonadCallback (CallbackT m) where
  getCallbacks = CallbackT $ get
  setCallbacks c = CallbackT $ put c
instance MonadIO m => MonadIO (CallbackT m) where
  liftIO m = CallbackT $ liftIO m
instance MonadTrans (CallbackT) where
  lift m = CallbackT $ lift m
-- TODO, add other instances

-- Helpers:

getCallback1 = do
  c <- getCallbacks
  return $ _callback1 c

-- This is you "register" function:
setCallback1 :: (Monad m, MonadCallback m) => m () -> m ()
setCallback1 f = do
  callbacks <- getCallbacks
  setCallbacks $ callbacks { _callback1 = f }   

-- Test:

test :: CallbackT IO ()
test = do
  c <- getCallbacks
  _callback1 c
  _callback2 c

main = runCallbackT test s
  where s = Callbacks { _callback1 = lift $ print "a" (), _callback2 = lift $ print "b" } 
```

即使没有 MonadIO，此代码代码也可以工作。

定义“默认”似乎工作正常：

```
instance (MonadIO m, MonadCallback m) => Default (Callbacks m) where
def = Callbacks {
  _callback1 = getCallbacks >>= \c -> setCallbacks $ c { _callback2 = _callback1 c },
  _callback2 = return ()} 
```

# c# - 如何将 WPF GUI 表单导入 MFC 应用程序

> ID：12044494
> 
> 赞同：2
> 
> 时间：2012-08-20T20:16:51.440
> 
> 标签：c#, wpf, mfc

我有简单的 MFC 遗留应用程序。我需要创建 5 个带有非常好的 GUI 的新屏幕——所以我决定用 WPF 来做。我正在使用 VS 2010

我的问题是

1.  我看不到在创建新项目菜单时创建 WPF 库的任何可能。
2.  如何将我将创建的 WPF Dll 导入到 MFC 中？
3.  如何创建 WPF 表单 MFC 的实例并进行表单“DoModol()”调用？

# php - 我想选择一组指定的行，然后从中选择一个随机行

> ID：12044496
> 
> 赞同：0
> 
> 时间：2012-08-20T20:17:00.553
> 
> 标签：php, mysql, random

我将创建下表

```
 $sql[] = "CREATE TABLE IF NOT EXISTS #__GmQuestions(
  QnID int(11) NOT NULL AUTO_INCREMENT,
  Question text COLLATE utf8_unicode_ci NOT NULL,
  Answer text COLLATE utf8_unicode_ci NOT NULL,
  QnLevel int(11) NOT NULL,
  QnPrize text COLLATE utf8_unicode_ci,
  QnPoints  DECIMAL( 10, 2 ) NOT NULL,
  PRIMARY KEY (QnID),

)"; 
```

和下表

```
 $sql[] = "CREATE TABLE IF NOT EXISTS #__GmHistory(
  HsID int(11) NOT NULL AUTO_INCREMENT,
  HsGamerID int(11) NOT NULL,
  HsQnID int(11) NOT NULL,
  Hspoints  DECIMAL( 10, 2 ) NOT NULL,
  HsAnswer varchar(55) COLLATE utf8_unicode_ci NOT NULL,
  HsStatus varchar(55) COLLATE utf8_unicode_ci NOT NULL DEFAULT 'Pending',
  HsDateCreated timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  HsPrize varchar(50) COLLATE utf8_unicode_ci DEFAULT NULL,
  PRIMARY KEY (HsID)
)"; 
```

级别列将具有 1 - 10 的整数。我想从 Qnlevel=1 的问题中选择一个随机问题，并且该问题以前一定没有被用户回答过。所以我有这个查询

```
//SELECT GAMERS question HISTORY
$result = mysql_query("SELECT HsQnID FROM #__QnHistory WHERE HsGamerID LIKE GamerID");
$Answeredquestions = Array();
while ($row = mysql_fetch_array($result, MYSQL_ASSOC)) {
    $Answeredquestions[] =  $row['QnID'];  
}
// I now select questions making sure the user hasent anweres them  
$query="SELECT * FROM #__GmQuestions WHERE QnLevel = 1 AND QnID NOT IN ('.implode(',', $Answeredquestions).')"; 
```

我的大问题是我需要从这些选定的问题中选择一个随机问题。我的数据库多达 600,000 个问题，我在大型数据库上看到了一些关于 rand() 的投诉。艾米想出如何只选择一个用户尚未回答的随机问题。我仍在开发中，因此欢迎所有回答，即使这意味着要更换我的桌子

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:23:21.413

如果您不使用`RAND()`它，因为它需要搜索整个表格（我仍然认为您应该计时，它可能“足够快”）；您可以构建一个包含未回答问题和用户 ID列表的 PK 表*。*

第二个查找表应该小于所有可能的问题。然后，您可以从查找表中获取随机主键，并直接从主问题表中选择它。

唯一的问题是您需要保持查找表的刷新；这可以是触发器或计划任务，可以根据系统的使用模式完成。

您还可以缓存查找的结果，例如`SELECT id, userid, answer`在客户端，并使用 PHP 的随机函数从该列表中进行选择。

如果你打算这样做；我建议使用外部缓存，这样多个进程就不会一直从这个未回答的集合中选择同一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:21:22.867

我可能会使用以下方法解决它

计算用户未回答的所有问题，即 400,000。可以说计数= 400000

在你的脚本中得到一个介于 1 之间的随机数来计数，即 323875。让我们说 random=323875

使用随机数作为偏移量和限制 1，然后您可以获得单个问题记录。

# c# - 通过传递参数从另一个事件方法调用一个事件方法

> ID：12044499
> 
> 赞同：0
> 
> 时间：2012-08-20T20:17:19.290
> 
> 标签：c#, event-handling

我试图从另一个调用一个 EventHandler 方法。例如，我想将注销按钮与表单退出链接，所以我有以下代码：

```
private void FormMain_FormClosing(object sender, FormClosingEventArgs e)
{
    if (MessageBox.Show("Bla, bla?", "Logout", MessageBoxButtons.OKCancel, MessageBoxIcon.Warning) == DialogResult.OK)
    {
        e.Cancel = false;
    }
    else
    {
        e.Cancel = true;
    }
} 
```

我想从这个事件中调用它：

```
private void btnLogOut_Click(object sender, EventArgs e)
{            
    FormMain_FormClosing(null, 'not sure what goes here');
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:21:12.160

试试这个：

```
private void btnLogOut_Click(object sender, EventArgs e)
{            
    FormMain_FormClosing(null, null);
} 
```

或者

```
private void button1_Click(object sender, EventArgs e)
{
    Form1_FormClosing(
        null, 
        new FormClosingEventArgs(CloseReason.UserClosing, false));
} 
```

即使我的回答涵盖了如何链接事件处理程序部分，这个特定的解决方案也会给您带来一个问题：表单不会关闭单击按钮。
正确的解决方案是

```
private void button1_Click(object sender, EventArgs e)
{
    Close();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:34:50.417

处理事件和请求确认是分开的事情：

```
private static bool UserConfirmedToLogout() 
{
    return MessageBox.Show("Bla, bla?", "Logout", MessageBoxButtons.OKCancel, MessageBoxIcon.Warning) == DialogResult.OK;
}

private void FormMain_FormClosing(object sender, FormClosingEventArgs e)
{
    e.Cancel = !UserConfirmedToLogout();
}

private void btnLogOut_Click(object sender, EventArgs e)
{            
    Close();
} 
```

调用 Close() 时，也会触发 FormClosing 事件。

# google-maps-api-3 - 即使谷歌返回地理编码，如何找到地址无效？

> ID：12044503
> 
> 赞同：0
> 
> 时间：2012-08-20T20:18:18.677
> 
> 标签：google-maps-api-3, plsql, oracle-apex

我正在使用 Oracle APEX 从谷歌获取地理编码，但有些地址实际上是无效的，谷歌仍然返回一个替代的地理编码，很可能是市中心。有什么方法可以让我知道它实际上是一个无效地址，这样我就可以避免使用这些不准确的地理编码？例如，以下地址不准确，那么即使 Google 地图服务返回地理编码，我如何才能找到它是无效地址？

```
{
declare

l_address varchar2(4000);
l_url varchar2(32000);
l_response varchar2(3200);

BEGIN
    /* TODO implementation required */

    l_address:=APEX_UTIL.URL_ENCODE('Rt. 1 Box 97-5 Braggs Muskogee Oklahoma 74423');
    dbms_output.put_line(l_address);
    l_address := replace(l_address,' ','+');

    l_url := 'http://maps.google.com/maps/geo?q='||l_address||'&'||'output=csv';
    l_response := utl_http.request(l_url, APEX_APPLICATION.G_PROXY_SERVER);
    dbms_output.put_line(l_response);
    l_response:=substr(l_response,instr(l_response,',',1,2)+1);

    dbms_output.put_line('In function: l_response ='||l_response);

END;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T21:12:25.540

[地理编码](http://en.wikipedia.org/wiki/Geocoding)器获取地址并返回相关的地理坐标。它不是[地址验证器](https://www.google.com/?q=address+validation&output=search&sclient=psy-ab#hl=en&output=search&sclient=psy-ab&q=address+validation&oq=address+validation)（尽管人们一直试图将其用作一个）。

[这篇文章](http://gabesumner.com/address-validation-using-the-google-maps-api)是在上面搜索地址验证中找到的，显示了一个人是如何使用它的。

# c# - 如何使用 {} 而不是 ; 来设置自己的属性？

> ID：12044505
> 
> 赞同：3
> 
> 时间：2012-08-20T20:18:23.233
> 
> 标签：c#, .net, stack-overflow

这是一个有趣的花絮，我在互联网上找不到。这个想法是，如果你有一个属性，比如 int a { get; 放; } 它可以设置自己。

如何使用 int a { get { } set { } } 设置属性？

集合内部发生了什么；？

这是我试图做的：

```
public string Symbol { get { return Symbol; } set { Symbol = value; NotifyPropertyChangedEvent("Symbol");  } } 
```

但它显然会造成*堆栈溢出*，因为它本质上是一遍又一遍地调用自己。

而且我不想创建 10-20 个私有变量来与我的属性一起工作，我想知道 set; 中发生了什么。

谢谢你。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-20T20:19:56.533

`set;`只是创建一个你看不到的私有变量。抱歉，您需要这 10-20 个私有变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:20:12.287

您必须创建私有变量。

不幸的是，这是您在此处遇到的特定情况下的唯一方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T20:21:12.717

如果您需要自定义逻辑，则需要自己提供支持字段：

```
private string symbol;
public string Symbol 
{ 
    get { return symbol; } 
    set { symbol = value; NotifyPropertyChangedEvent("Symbol");  } 
} 
```

* * *

> 而且我不想创建 10-20 个私有变量来与我的属性一起工作，我想知道 set; 中发生了什么。

使用自动属性（即：）`public string Symbol { get; set; }`，编译器会自动创建支持字段。但是，如果不自己管理支持字段，就无法引入逻辑（即：引发您的事件）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T20:21:50.413

它在编译时为您生成一个支持字段。您无法通过智能感知访问它，因为它尚未创建。它等效于以下尚未生成“_a”的情况。

```
private int _a;
public int a
{
    get { return _a; }
    set { _a = value; }
} 
```

但是，您可以简单地从类内部设置属性本身。

```
public int a { get; set; }

a = ...; 
```

此外，如果您只想在内部设置它，您可以在 get 和 set 上设置修饰符；

```
public int a { get; private set; } 
```

# c# - 如何在选项页面中使用 ValidationAttribute 进行用户输入？

> ID：12044509
> 
> 赞同：1
> 
> 时间：2012-08-20T20:18:46.457
> 
> 标签：c#, attributes, data-annotations, validation, options

我正在编写一个 Visual Studio 扩展。我有一个代表选项页面的 C# 类。选项由公共属性表示，如下所示：

```
public class OptionsPageGeneral : DialogPage
{
  [Range(1, 100)]
  [Category("Misc")]
  [DisplayName("Integer option")]
  public string IntOption { get; set; }
  ...
} 
```

![在此处输入图像描述](../Images/cbdb7b7ffc00a37e9e19b1708a3ebad4.png)

我正在尝试使用[验证属性](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.validationattribute.aspx)来限制用户输入。但是，对于给定的代码，用户仍然可以输入任何值，不仅来自 [1; 100] 范围。[`RangeAttribute`](http://msdn.microsoft.com/query/dev10.query?appId=Dev10IDEF1&l=EN-US&k=k%28SYSTEM.COMPONENTMODEL.DATAANNOTATIONS.RANGEATTRIBUTE%29;k%28TargetFrameworkMoniker-%22.NETFRAMEWORK,VERSION=V4.0%22%29;k%28DevLang-CSHARP%29&rd=true)

我见过很多 ValidationAttribute 用法的例子，但都是针对 ASP.NET MVC 项目的。该属性是否仅适用于该上下文？

无论如何，如何验证在选项页面中完成的用户输入？我知道我可以简单地覆盖属性`set`方法，但验证属性需要编写的代码少得多，并且可以重复用于类似的属性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T13:20:55.063

我不知道如何使用选项页面，但是如果您想要 1-100 之间的范围而不是`Range`.

```
 [Category("Misc")]
  [DisplayName("Integer option")]
  [RegularExpression(@"[0-9]{2}")]//This will only allow you to enter only 2 digits
  public string IntOption { get; set; } 
```

# jsoup - Jsoup - 如何提取固定html标签之间的所有元素

> ID：12044511
> 
> 赞同：0
> 
> 时间：2012-08-20T20:18:51.797
> 
> 标签：jsoup

我需要从两个强大的 html 标记元素之间的这个 html 标记中提取文本

```
<h6>Main Heading</h6>
<ul>
<strong>Sub heading 1</strong>
<li>text1</li>
…
<li>textn</li>
<strong>Sub heading 2</strong>
<li>text1</li>
…
<li>textn</li>
</ul> 
```

因为我需要在元素数组中获取所有强元素和 li 元素（文本）。我试图获得所有强大的元素

```
Element ulElement = doc.select("h6:matchesOwn(Main Heading).first();
Elements subHeadings = ulElement.select("strong");
Elements subLIElements = ulElement.select("strong ~ li"); 
```

所以我有 subHeadings 变量中的所有子标题和 subLIElements 变量中的所有 li 元素......但我需要将这两者联系起来，因为 subHeadings[0] 映射到强元素之前的所有 li 元素。我想我需要遍历树来获取这些 li 元素？有没有其他方法可以在选择查询中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-27T12:52:55.427

> 获取 Elements 数组中的所有 strong 和 li 元素（文本）

您只需要每个元素的文本、数组`Element`还是数组`Elements`？

**如果只有文字：**

```
List<String> result = new ArrayList<>();
Elements elements = doc.select("strong, li");

for( Element e : elements )
{
    result.add(e.text());
} 
```

**结果：** [子标题 1，text1，textn，子标题 2，text1，textn]

在这个例子`elements`中是一个包含所有 Strong / Li`Element`按出现顺序的列表：

```
<strong>Sub heading 1</strong>
<li>text1</li>
<li>textn</li>
<strong>Sub heading 2</strong>
<li>text1</li>
<li>textn</li> 
```

也许您可以使用每个元素的索引来排序不需要的东西。

# objective-c - 具有固定背景纹理的 NSScrollView

> ID：12044517
> 
> 赞同：1
> 
> 时间：2012-08-20T20:19:07.320
> 
> 标签：objective-c, macos, cocoa, nsscrollview

我有一个 IKImageBrowserView，它是 NSScrollView 的文档视图。如何设置背景图像（纹理），以便在用户滚动时背景保持固定。

我尝试了很多方法，但要么它们不起作用，要么它没有保持固定。

我试过让 IKImageBrowserView 和 NSScrollView 透明，但这不起作用，背景是黑色的。

我尝试将纹理添加为图像浏览器的背景层：

```
NSColor* browserBackgroundColor = [NSColor colorWithPatternImage:[NSImage imageNamed:@"linenTile"]];
CALayer *layer = [CALayer layer];
[layer setBackgroundColor:[browserBackgroundColor CGColor]];
[self.imageBrowserView setBackgroundLayer:layer]; 
```

向下滚动时它保持固定，但向上滚动时。这是我得到的最接近的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:44:12.433

如果你`scrollView`是全屏的，你可以把你的图像设置为你的背景`self.view`，然后设置你的`scrollView`透明背景。

`NSView`或者您可以在您的下方添加一个单独的`scrollView`，使其覆盖与您相同的区域`scrollView`，并设置其背景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T21:07:41.227

终于把组合弄对了。

继承 NSScrollView 并在 drawRect 中绘制图案图像：

```
- (void)drawRect:(NSRect)rect {
    [[NSColor colorWithPatternImage:[NSImage imageNamed:@"linenTile"]] set];
    NSRectFill(rect);
} 
```

将文档视图的背景设置为清除（对于像这样的 IKImageBrowserView）：

```
[self.imageBrowserView setValue:[NSColor clearColor] forKey:IKImageBrowserBackgroundColorKey]; 
```

并且必须取消选中滚动视图上界面生成器中的绘制背景复选框。或者在代码中将值设置为 NO。

如果您希望图案随内容滚动。不要将 NSScrollView 子类化，只需将滚动视图的背景颜色设置为模式，并将文档视图的背景颜色设置为清除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-20T02:14:12.107

子类化`-drawRect:`是不必要的，只需使用`backgroundColor`NSScrollView 的属性即可。[文档](https://developer.apple.com/reference/appkit/nsscrollview/1403473-backgroundcolor?language=objc)说“这种颜色用于在内容视图内绘制文档视图未覆盖的区域。”

```
scollView.backgroundColor = [[NSColor colorWithPatternImage:[NSImage imageNamed:@"linenTile"]] set]; 
```

# javascript - Facebook 发送消息对话框而不重定向

> ID：12044518
> 
> 赞同：2
> 
> 时间：2012-08-20T20:19:10.620
> 
> 标签：javascript, facebook

我希望在我的网站上添加一些功能，以允许人们通过 facebook 发送对话框向他们的朋友发送消息。问题是它需要一个 redirect_uri 参数，当用户单击发送/取消时，窗口会重定向到该参数。我想知道是否有任何方法可以在用户单击发送/取消而不重定向时自动关闭发送消息弹出窗口（就像不支持的 facebook.com/sharer.php 一样）？我到目前为止的代码是：

```
 FB.init({appId: '*****'});
        FB.ui({
            method: 'send',
            name: *****,
            picture: *****,
            link: *****,
            display: 'popup'
        }); 
```

# c++ - Unix 函数 gmtime_r 的 Windows 等效项是什么？

> ID：12044519
> 
> 赞同：10
> 
> 时间：2012-08-20T20:19:12.000
> 
> 标签：c++, visual-studio-2010, unix, time, porting

我正在将一些 Unix 代码移植到 Windows Visual Studio 2010 中。我遇到了以下行

```
gmtime_r(&now, &tm_time); 
```

我发现 gmtime_r() 是一个标准的 Unix 函数，但我希望找到 Windows 的等效函数。我在 time.h 中发现了很多 gmtime 函数，但是我很难找到哪个是等效的，如果它甚至存在的话。有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-08-21T18:19:34.960

gmtime_r() 是 gmtime() 的线程安全版本。gmtime() 的 MSVC 实现已经是线程安全的，返回的 struct tm* 分配在线程本地存储中。

如果在同一个线程上多次调用该函数并存储返回的指针，这并不能使它免于麻烦。您可以改用 gmtime_s()。最接近 gmtime_r() 但参数颠倒了;)

# apache - 通过 Apache mod_proxy 过滤非 OAuth 身份验证的会话到 CouchDB

> ID：12044524
> 
> 赞同：1
> 
> 时间：2012-08-20T20:19:38.653
> 
> 标签：apache, oauth, couchdb, mod-proxy

这些是我的要求：

1.  Apache mod_proxy 使 CouchDB 在全球范围内可用。
2.  couchdb 还必须在 localhost:5984 端口上*完全可用，无需身份验证。*
3.  只有通过了 oauth 身份验证的通过 mod_proxy 的请求*才*应该被接受

这是可能吗？mod_proxy 可以过滤掉非 OAuth 请求吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T11:12:19.087

您检查了吗：[https](https://github.com/YasuhiroABE/CouchDB-WebProxy_Auth_Handler) ://github.com/YasuhiroABE/CouchDB-WebProxy_Auth_Handler ？在 Apache 中，您需要配置身份验证不转发未经身份验证的条目

# javascript - NodeJS：创建哈希并返回函数的值

> ID：12044525
> 
> 赞同：0
> 
> 时间：2012-08-20T20:19:40.360
> 
> 标签：javascript, jquery, node.js, variables

我有一个需要提取的标签列表。该列表称为`list`.

我正在尝试查找与列表相对应且在获取的 html 中可用的所有 'og:*' 元数据。然后我需要以包含这些元标记的 JSON 格式向用户返回一个哈希值。但是该`process`方法返回`undefined`而不是哈希。

```
var http = require('http');
var url = require('url');
var request = require('request');
var jsdom = require("jsdom");
var fs = require('fs');
var cssom = require('cssom');

var list = ['title', 'description']; //here the og-tags I need to extract
var meta = {};

function process(url) {
  request(url, function (error, response, body) {
    if (!error && response.statusCode == 200) {  
      jsdom.env({
        html: body,
        scripts: [
          'http://code.jquery.com/jquery-1.5.min.js'
        ],
        done: function(errors, window) {
          var $ = window.$;

          $('meta[property^="og:"]').each(function() {
            for (var element in list) {
              if ($(this).attr('property') == 'og:' + list[element]) {
                meta[list[element]] = $(this).attr('content');

                // this works well, if I do console.log(meta), I get the hash correctly filled.
              }
            }
          });
        }
      });
    }
  });

  return meta; // this is where the probleme is. This return undefined.
}

http.createServer(function (request, response) {
  request.setEncoding('utf8');
  response.writeHead(200, {'Content-Type': 'text/plain'});

  process(url.parse(request.url, true).query['content'], function(result) {
    console.log(result); // prints no result
  });

  response.end();
}).listen(8124);

console.log('Server running at http://0.0.0.0:8124'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:26:37.293

因为`request`是异步的，所以也需要`process`异步。这意味着`process`接受一个它会调用一次的回调参数`meta`是可用的。就像现在一样，在回调填充它之前`process`返回。`meta``request`

```
function process(url, callback) {
  request(url, function (error, response, body) {
    if (!error && response.statusCode == 200) {  
      jsdom.env({
        html: body,
        scripts: [
          'http://code.jquery.com/jquery-1.5.min.js'
        ],
        done: function(errors, window) {
          var $ = window.$;

          $('meta[property^="og:"]').each(function() {
            for (var element in list) {
              if ($(this).attr('property') == 'og:' + list[element]) {
                meta[list[element]] = $(this).attr('content');
                callback(null, meta);
              }
            }
          });
        }
      });
    } else {
      callback(error);
    }
  });
}

http.createServer(function (request, response) {
  request.setEncoding('utf8');
  response.writeHead(200, {'Content-Type': 'text/plain'});

  process(url.parse(request.url, true).query['content'], function(error, result) {
    console.log(result); // prints no result
  });

  response.end();
}).listen(8124); 
```

# sql - FROM 子句中的 SQL 语法错误

> ID：12044528
> 
> 赞同：1
> 
> 时间：2012-08-20T20:19:54.317
> 
> 标签：sql

这是我遇到错误的代码：

```
FROM
    IndexPID
    INNER JOIN Demographics ON
        IndexPID.NDoc_Number = Demographics.NDoc_Number,
    PatientSupply
    INNER JOIN Demographics ON
        PatientSupply.NDocNum = Demographics.NDoc_Number 
```

我也试过这样：

```
FROM
    IndexPID, PatientSupply
    INNER JOIN Demographics ON
        IndexPID.NDoc_Number = Demographics.NDoc_Number
    INNER JOIN Demographics ON
        PatientSupply.NDocNum = Demographics.NDoc_Number 
```

但是没有雪茄。有人告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T20:22:08.863

如果您发布整个 SQL 会更容易！

尝试

```
FROM
IndexPID
INNER JOIN Demographics ON
    IndexPID.NDoc_Number = Demographics.NDoc_Number
INNER JOIN PatientSupply ON
    PatientSupply.NDocNum = Demographics.NDoc_Number 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T20:22:30.507

你非常接近：

```
FROM IndexPID
INNER JOIN Demographics 
   ON IndexPID.NDoc_Number = Demographics.NDoc_Number
INNER JOIN PatientSupply
   ON Demographics.NDoc_Number = PatientSupply.NDocNum 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T20:22:01.147

您`JOIN`在这里以一种奇怪的方式混合了隐式（逗号分隔）和显式 s。它应该如下所示，仅使用显式s，表名或子句`INNER JOIN`之间没有逗号：`ON`

```
FROM
  IndexPID
  INNER JOIN Demographics 
    ON IndexPID.Ndoc_Number = Demographics.NDoc_Number
  INNER JOIN PatientSupply 
    ON PatientSupply.NDocNum = Demographics.NDoc_Number 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T20:30:09.263

您使用内部联接，因此您可以使用：

```
FROM Demographics
inner join IndexPID on Demographics.NDoc_Number=IndexPID.NDoc_Number
inner join PatientSupply on Demographics.NDoc_Number=PatientSupply.NDocNum 
```

# c# - Visual Studio 2012 c#'代码隐藏'和默认'事件处理程序'代码？它在 Snippets 中的什么地方或其他地方？

> ID：12044533
> 
> 赞同：2
> 
> 时间：2012-08-20T20:20:05.620
> 
> 标签：c#, code-snippets, visual-studio-2012

我想尝试提出一些我忘记的旧片段，以便在为我定义的每个事件在 c# 后面创建代码时更改 VS2010 的默认行为

1.  从 XML，或
2.  从控制属性面板，或
3.  从分配和定义事件处理程序加载（重载？）（`control.event.handler += event handler;`）进入未定义处理程序的事件处理程序将在文件末尾为您提供一个存根子例程。

所有三个编码操作都可以在三个不同的设置中发生，但应该在后面创建相同的代码。现在我想把我的花里胡哨和标记我的行动与调试，ifdefs，并让代码在诊断输出中向我解释它在做什么，这通常与我想要它做的不同。它可以变成很多打字。片段很酷。并且是高度个人化的。我敢肯定，当我变得更有经验时，我会摆脱我的训练轮。但我记得在 vs2010 中通过在 VS 内部片段或 xml 设置中入侵 VS 来完成此操作。它不是一个常规的片段；或者是吗？还有一种方法可以将其保存在本地目录中，以便覆盖生成/片段后面的默认代码。我似乎再也找不到这个了。什么是工作流程，这就是我要找的吗？我' m 安装 VS2010 express 和 pro 并测试/移植代码。我很想采取行动。它在 VS2012 中在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T06:36:34.337

关闭主菜单工具->代码片段管理器或通过快速启动类型“片段”。此外，您可能希望通过“工具”->“扩展和更新”添加“代码段设计器”。

在 2012 年，如果您忘记了某个命令的位置，请使用快速启动来帮助您找到它。

# iphone - iPhone 3gs 4.2.1 上的 UITableViewCell 中的 CALayer 动画跳跃

> ID：12044540
> 
> 赞同：1
> 
> 时间：2012-08-20T20:20:18.183
> 
> 标签：iphone, ios, uitableview

我创建了一个自定义视图，可在触发平移手势时调整 CALayers 的大小。当控件添加到 normal`UIVIew`时，动画的行为与预期完全一样。

当视图`UITableViewCell`通过`addSubView`动画被添加到时是跳跃的。我`NSLog`在手势处理程序中放置了一些语句，它的行为完全符合预期。

是否有任何事情`UITableView`或`UITableViewCell`会导致我遇到这种意外行为？使用 addSubView 添加自定义视图是否正确？

**编辑**

我有更多关于这个问题的信息。这个问题似乎只出现在某些环境中。

*iPhone 3GS、iOS 4.2.1 -*是*
iPod Touch (Retnia)、5.1 -*没有*
iPod 模拟器 4.2 -*没有*
iPod 模拟器 5.1 -*没有*

我还采纳了 Lorean 和 DavidH 的建议，但并没有解决问题。

*当我从 XCode 构建时，3gs 设备旁边有一条消息，上面写着“Overriding base SDK to 4.3”

这可能是一个潜在的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:31:29.717

您应该只将自定义视图添加到单元格的内容视图中。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewCell_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewCell_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T21:27:05.413

虽然我同意视图应作为子视图放置在 contentView 中，但还有另一个潜在问题。移动滚动视图中的动画在历史上是很糟糕的，因为整个系统并非旨在支持两个非耦合动画。

该问题的解决方案是当用户触摸单元格时，禁用滚动（即 myTableView.scrollEnabled = NO，然后当平移手势完成（所有动画）时，再次启用它。

编辑：这听起来有点时髦，但应该像我过去所做的那样工作。当你得到第一个触摸事件时，计算layer的frame是什么self.view坐标，然后使用这个frame将它添加到view中，但是保存旧frame。用户什么都看不到，现在您的观点已得到提示。显然，您还必须防止桌子移动。完成用户交互后，使用旧框架将视图移回单元格。

根据您进行触摸的方式，您可能需要在覆盖所需平移视图的清晰 UIView 中拦截第一次触摸，当它被触摸时，执行上述所有操作，然后将初始触摸转发到视图。希望这一步不需要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T01:54:08.560

我已经实施了一个解决问题的hack。我可能会决定完全关闭动画，因为它并不是真正需要的，但如果有人有比这更好的答案，我会很乐意接受。

```
if ([[[UIDevice currentDevice] systemVersion] floatValue]<5.0) 
{    
    [CATransaction begin];
    [CATransaction setDisableActions: YES];
}

//do stuff

if ([[[UIDevice currentDevice] systemVersion] floatValue]<5.0) [CATransaction commit]; 
```

# java - android对数组进行排序

> ID：12044542
> 
> 赞同：0
> 
> 时间：2012-08-20T20:20:21.400
> 
> 标签：java, android, sorting

我正在尝试对数组进行排序，但由于某种原因，我的 compareTo 函数中出现以下错误：

```
Cannot invoke compareTo(int) on the primitive type int 
```

我的代码：

```
private void sortFriendList()
{
    Arrays.sort(friendsList, new Comparator<FacebookUser>() {

        @Override
        public int compare(FacebookUser lhs, FacebookUser rhs) {                
            ChatMessage[] firstChatMessages = app.getDatabaseManager().getChatMessages(lhs.getId());
            ChatMessage[] lastChatMessages = app.getDatabaseManager().getChatMessages(rhs.getId());
            int firstLastMessageTime = (int) firstChatMessages[firstChatMessages.length-1].getTime();
            int lastLastMessageTime = (int) lastChatMessages[firstChatMessages.length-1].getTime();
            return firstLastMessageTime.compareTo(lastLastMessageTime);
        }
    });     
 } 
```

应该对存储在 long 类型中的数组购买时间进行排序的代码（我已将其转换为 int）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:28:48.450

该`compareTo`方法仅适用于对象。原语`int`不是对象。您必须手动比较 int 值并返回负值、零或正值，如果此值小于、等于或大于另一个值。

为此使用 Integer 包装器类只是在浪费资源。

今天早上我更愿意提供一些代码：

```
long firstLastMessageTime = ...
long lastLastMessageTime = ...
if (firstLastMessageTime < lastLastMessageTime) {
    return -1;
}
if (firstLastMessageTime > lastLastMessageTime) {
    return 1;
}
return 0; 
```

在某些情况下，您可以使用 firstLastMessageTime 减去 lastLastMessageTime，但如果您处理负值或差异可能大于 32 位 int 值，则可能会导致错误。所以要100%确定，只要一直使用上述方法。

* * *

附加评论：

该值真的是 int 值吗？通常时间在 Java 中定义为自 1.1.1970 以来的毫秒数，因为数据类型很长。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:24:14.907

尝试这样的事情

```
 return Integer.valueof(firstLastMessageTime).compareTo(lastLastMessageTime); 
```

在调用 comapreTo 方法之前，您必须包装`int`到`Integer`对象中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T20:28:01.013

不要投到`long`以`int`避免精度损失。而是将其装箱`Long`

```
long firstLastMessageTime = //...
long lastLastMessageTime = //...
return Long.valueOf(firstLastMessageTime).compareTo(Long.valueOf(lastLastMessageTime)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T20:28:00.910

您不能在原始类型上调用 compareTo，您应该使用它们的包装类。**整数**而不是**整数**

# node.js - 在 node.js 中打开套接字时发送数据

> ID：12044543
> 
> 赞同：1
> 
> 时间：2012-08-20T20:20:23.387
> 
> 标签：node.js, push-notification, socket.io, push

我正在配置一个 nodejs 服务器，以便将其用作推送通知的服务器。

我有这个代码：

```
io.sockets.on('connection', function(socket) {
    console.log(socket);
    // watching the xml file
    fs.watchFile('client.xml', function(curr, prev) {
        // on file change we can read the new xml
        fs.readFile('client.xml', function(err, data) {
            if (err)
                throw err;
            // parsing the new xml datas and converting them into json file
            parser.parseString(data);
        });
    });
    // when the parser ends the parsing we are ready to send the new data to the
    // frontend page
    parser.addListener('end', function(result) {
        socket.volatile.emit('notification', result);
    });
}); 
```

在服务器上。而在客户端这个：

```
<script>
    function test(data) {
        console.log(data);
        jQuery('#' + data.id).html(data.content);
    }
</script>

<script>
    // creating a new websocket
    var socket = io.connect('http://10.0.0.113:8000');
    // on every message recived we print the new datas inside the #container div
    socket.emit('data', {id : 'id'});
    socket.set('nickname', {id : 'test'});
    socket.on('notification', function(data) {
        _efbn(data.callback, window, data.response, data);
    });

    /**
     * Función que ejecuta una función por nombre. Puede usar namespaces
     * (algo.algo.algo.funct)
     * 
     * @see http://stackoverflow.com/questions/359788/javascript-function-name-as-a-string/359910#359910
     */
    function _efbn(functionName, context) {
        var args = Array.prototype.slice.call(arguments);
        args = [ args[2], args[3] ]; // Fix para IE.
        var namespaces = functionName.split(".");
        var func = namespaces.pop();
        for ( var i = 0; i < namespaces.length; i++) {
            context = context[namespaces[i]];
        }
        try {
            if (typeof context[func] == 'function') {
                return context[func].apply(this, args);
            }
        } catch (e) {
            console.log(e);
        }
        return null;
    }
</script> 
```

一切都如我所愿。但是，我想发送如下内容：

```
socket.set('site', '12345');
socket.set('object', 'ABCDE'); 
```

为了确定我应该听哪个 xml，而不是一直听 client.xml。

我该怎么做？我在 server.js 上有这个：

```
id = require('url').parse(req.url, true).query.id; 
```

但是，由于服务器只在连接打开时执行，而在套接字打开时不执行，如果客户端和服务器之间的连接失败，当 jquery 重试打开套接字时，id 将为空......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T21:05:48.747

我会在服务器上这样做，

```
io.sockets.on('connection', function(socket) {
    console.log(socket);
    socket.on('setup', function(config) {
        // use your connection specific config variables like
        var id = config.id; // and then use id in your logic below.
        // watching the xml file
        fs.watchFile('client.xml', function(curr, prev) {
            // on file change we can read the new xml
            fs.readFile('client.xml', function(err, data) {
                if (err)
                    throw err;
                // parsing the new xml datas and converting them into json file
                parser.parseString(data);
            });
        });
        // when the parser ends the parsing we are ready to send the new data to the
        // frontend page
        parser.addListener('end', function(result) {
            socket.volatile.emit('notification', result);
        });
    });
}); 
```

而在客户端，

```
// creating a new websocket
var socket = io.connect('http://10.0.0.113:8000');
socket.on("connect", function() {
    // Setup your connection on the server-side by providing it
    // some config variables.
    var config = {
        id: "id",
        nickname: "test"
    };
    socket.emit("setup", config);
    // on every message recived we print the new datas inside the #container div
    socket.on('notification', function(data) {
        _efbn(data.callback, window, data.response, data);
    });
}); 
```

这样，每当建立新连接时，`setup`首先在服务器上使用所需的配置变量调用事件。

# python - ImportError：没有名为 pysqlite2 的模块

> ID：12044548
> 
> 赞同：10
> 
> 时间：2012-08-20T20:21:10.377
> 
> 标签：python, sqlite, pysqlite

为什么

```
from pysqlite2 import dbapi2 as sqlite 
```

原因

> ImportError：没有名为 pysqlite2 的模块

pysqlite2 不是已经安装在 Python 2.6.5 中了吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-08-20T20:23:18.207

该模块称为`sqlite3`. `pysqlite2`是模块在成为 Python 标准库的一部分之前的名称。

您可能想在代码中使用它：

```
import sqlite3 
```

标准文档在这里：[http ://docs.python.org/library/sqlite3.html](http://docs.python.org/library/sqlite3.html)

编辑：只是为了涵盖所有基础：

该`sqlite3`模块还有一个`dbapi2`子成员，但您不需要直接使用它。该`sqlite3`模块直接公开所有`dbapi2`成员。

# c# - IOException 与检查 File.Exists？

> ID：12044551
> 
> 赞同：5
> 
> 时间：2012-08-20T20:21:14.620
> 
> 标签：c#, wpf, performance, file-io, exception-handling

（我搜索了类似的线程，但找不到任何解决这个特定问题的东西，尽管有几个类似的，比如[这里](https://stackoverflow.com/questions/567579/how-expensive-are-exceptions)和[这里](https://stackoverflow.com/questions/6891/performance-considerations-for-throwing-exceptions)。）

我正在评估我们的应用程序的性能，我注意到我们收到了一些 IOExceptions “无法找到资源”。我不确定它到底发生了多少次（很大程度上取决于用户如何使用该应用程序），但至少有十几个左右。

我假设异常通常是性能昂贵的文件 I/O 调用，如`File.Exists()`. 我知道在尝试加载文件之前检查文件是否存在总是一个好习惯。我的问题是，如果我检查这个特定文件是否存在，我会看到多少性能提升？（再次，忽略“无论如何你都应该这样做”，我只是想了解性能）。

**选项1：**

```
try
{
    return (ResourceDictionary) Application.LoadComponent(uri);
}
catch (Exception)
{
    //If it's not there, don't do anything
} 
```

这不会进行额外的 IO 调用，但有时会抛出并吞下异常。

**选项 2**：

```
if(File.Exists(uri))
{
    return (ResourceDictionary) Application.LoadComponent(uri);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T20:26:23.027

一般来说，如果文件*应该*存在（即：它是应用程序部署的一部分），那么我将使用异常检查，仅此而已。这是因为，在这种情况下，异常确实是一种异常和意想不到的情况。

如果文件是用户输入的东西，那么检查是否存在就变得很有意义。但是，这仍然不能消除异常处理的需要，因为文件*可能*会在您检查和打开/使用它的时间之间被删除。因此，您仍然需要异常处理 - 在这种情况下，您*可能*仍只想使用您的第一个选项代码，但请确保异常处理足够干净以始终提供行为，即使文件不存在也是如此.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:46:03.517

我看不出你的两个选项之间有很大的性能差异。大部分工作是定位和读取文件，所以在这两种情况下你都必须这样做。如果您不希望用户在应用程序运行时添加/删除此文件，那么缓存结果可能很有用。所以你可能会做类似的事情

```
private static Dictionary<Uri, ResourceDictionary> _uriToResources =
  new Dictionary<Uri, ResourceDictionary>();
public static ResourceDictionary GetResourceDictionary(Uri uri)
{
  ResourceDictionary resources;
  if (_uriToResources.TryGetValue(uri, out resources))
  {
    return resources;
  }

  try
  {
     resources = (ResourceDictionary)Application.LoadComponent(uri);
  }
  catch
  {
     // could prompt/alert the user here.
     resources = null; // or an appropriate default.
  }

  _uriToResources[uri] = resources;
  return resources;
} 
```

这将防止您重复尝试加载不存在的资源。在这里，我返回一个空对象，但使用一些默认值作为后备可能会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-12-04T02:35:27.383

File.Exists 也会在内部引发异常。所以性能会非常相似。

这是来自 File.cs 的代码，其中包含 File.Exists 调用的辅助方法。

```
 [SecurityCritical]
    private static bool InternalExistsHelper(string path, bool checkHost)
    {
      try
      {
        if (path == null || path.Length == 0)
          return false;
        path = Path.GetFullPathInternal(path);
        if (path.Length > 0 && Path.IsDirectorySeparator(path[path.Length - 1]))
          return false;
        FileIOPermission.QuickDemand(FileIOPermissionAccess.Read, path, false, false);
        return File.InternalExists(path);
      }
      catch (ArgumentException ex)
      {
      }
      catch (NotSupportedException ex)
      {
      }
      catch (SecurityException ex)
      {
      }
      catch (IOException ex)
      {
      }
      catch (UnauthorizedAccessException ex)
      {
      }
      return false;
    } 
```

# android - Android使用AlertDialog激活gps：如何等待用户采取行动？

> ID：12044552
> 
> 赞同：10
> 
> 时间：2012-08-20T20:21:14.067
> 
> 标签：android

`AlertDialog`我读过不同的帖子，因为它阻塞了 UI ，所以无法等待用户在显示时采取行动。

但是，`Facebook`诸如显示*Gps 之类的应用程序当前已被禁用。你想启用gps吗？*警报对话框并等待用户按是/否。我认为可以使用 2 种不同的活动，第一个仅包含 gps 警报对话框，但这似乎不正确，并且绝对不是 facebook 这样做的方式。

谁能告诉我如何实现这一目标？

这是我的代码：

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    InitializeComponents();

    EnableGPSIfPossible();

        ListAsync lAsync = new ListAsync(this);
        lAsync .execute();
    }

    private void EnableGPSIfPossible()
{   
    final LocationManager manager = (LocationManager) getSystemService( Context.LOCATION_SERVICE );
     if ( !manager.isProviderEnabled( LocationManager.GPS_PROVIDER ) ) {
            buildAlertMessageNoGps();
        }
}

 private  void buildAlertMessageNoGps() {
        final AlertDialog.Builder builder = new AlertDialog.Builder(this);
        builder.setMessage("Yout GPS seems to be disabled, do you want to enable it?")
               .setCancelable(false)
               .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                   public void onClick(@SuppressWarnings("unused") final DialogInterface dialog, @SuppressWarnings("unused") final int id) {
                     startActivity(new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS));
                   }
               })
               .setNegativeButton("No", new DialogInterface.OnClickListener() {
                   public void onClick(final DialogInterface dialog, @SuppressWarnings("unused") final int id) {
                        dialog.cancel();
                   }
               });
        final AlertDialog alert = builder.create();
        alert.show();
    } 
```

因此，在我的代码中，`AsynTask`无需等待用户激活 gps 即可立即启动。（这是正常行为）

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-20T20:25:38.783

您实际上可以做的是：

GPSManager.java：

```
public class GPSManager {

    private Activity activity;
    private LocationManager mlocManager;
    private LocationListener gpsListener;

    public GPSManager(Activity activity) {
        this.activity = activity;
    }

    public void start() {
        mlocManager = (LocationManager) activity
                .getSystemService(Context.LOCATION_SERVICE);

        if (mlocManager.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
            setUp();
            findLoc();
        } else {
            AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
                    activity);
            alertDialogBuilder
                    .setMessage("GPS is disabled in your device. Enable it?")
                    .setCancelable(false)
                    .setPositiveButton("Enable GPS",
                            new DialogInterface.OnClickListener() {
                                public void onClick(DialogInterface dialog,
                                        int id) {
                                    Intent callGPSSettingIntent = new Intent(
                                            android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS);
                                    activity.startActivity(callGPSSettingIntent);
                                }
                            });
            alertDialogBuilder.setNegativeButton("Cancel",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {
                            dialog.cancel();
                        }
                    });
            AlertDialog alert = alertDialogBuilder.create();
            alert.show();

        }
    }

    public void setUp() {
        gpsListener = new GPSListener(activity, mlocManager);
    }

    public void findLoc() {
        mlocManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 1, 1,
                gpsListener);

        if (mlocManager.getLastKnownLocation(LocationManager.GPS_PROVIDER) == null)
            Toast.makeText(activity, "LAST Location null", Toast.LENGTH_SHORT)
                    .show();
        else {
            gpsListener.onLocationChanged(mlocManager
                    .getLastKnownLocation(LocationManager.GPS_PROVIDER));
        }
    }
} 
```

GPSListener.java：

```
public class GPSListener implements LocationListener {

    private Activity activity;
    private LocationManager lm;
    private int numberOfUpdates;

    public static final int MAX_NUMBER_OF_UPDATES = 10;

    public GPSListener(Activity activity, LocationManager lm) {
        this.activity = activity;
        this.lm = lm;
    }

    @Override
    public void onLocationChanged(Location loc) {
        if (numberOfUpdates < MAX_NUMBER_OF_UPDATES) {
            numberOfUpdates++;

            Log.w("LAT", String.valueOf(loc.getLatitude()));
            Log.w("LONG", String.valueOf(loc.getLongitude()));
            Log.w("ACCURACY", String.valueOf(loc.getAccuracy() + " m"));
            Log.w("PROVIDER", String.valueOf(loc.getProvider()));
            Log.w("SPEED", String.valueOf(loc.getSpeed() + " m/s"));
            Log.w("ALTITUDE", String.valueOf(loc.getAltitude()));
            Log.w("BEARING", String.valueOf(loc.getBearing() + " degrees east of true north"));

            String message;

            if (loc != null) {
                message = "Current location is:  Latitude = "
                        + loc.getLatitude() + ", Longitude = "
                        + loc.getLongitude();
                // lm.removeUpdates(this);
            } else
                message = "Location null";

            Toast.makeText(activity, message, Toast.LENGTH_SHORT).show();
        } else {
            lm.removeUpdates(this);
        }
    }

    @Override
    public void onProviderDisabled(String provider) {
        Toast.makeText(activity, "Gps Disabled", Toast.LENGTH_SHORT).show();
    }

    @Override
    public void onProviderEnabled(String provider) {
        Toast.makeText(activity, "Gps Enabled", Toast.LENGTH_SHORT).show();
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {

    }

} 
```

然后从您的活动中：

```
GPSManager gps = new GPSManager(
                                    yourActivity.this);
                            gps.start(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-14T11:24:23.360

我通过使用简单的功能做到了这一点，但没有显示警告框，我将用户控件重定向到设置页面

**这是我使用的功能**

```
public void isGPSEnable(){
        LocationManager service = (LocationManager) getSystemService(LOCATION_SERVICE);
        boolean enabled = service
          .isProviderEnabled(LocationManager.GPS_PROVIDER);
        if (!enabled) {
          Intent intent = new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS);
          startActivity(intent);
        } 

} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-16T11:07:24.113

我设法让它发挥作用。我从 stackoverlfow 上找到的这篇文章中得到启发。[http://developmentality.wordpress.com/2009/10/31/android-dialog-box-tutorial/](http://developmentality.wordpress.com/2009/10/31/android-dialog-box-tutorial/)

我基本上移动了我需要在警报对话框的“是”和“取消”按钮上执行的逻辑。在执行“是”和“取消”按钮所需的逻辑后，我开始异步逻辑执行。

这是我的代码：

```
public interface ICommand
{
    void execute();
} 
```

用于警报对话框的启用 Gps 和取消按钮的两个具体命令：

```
public class CancelCommand implements ICommand
{
    protected Activity m_activity;

    public CancelCommand(Activity activity)
    {
        m_activity = activity;
    }

    public void execute()
    {
        dialog.dismiss();
        //start asyncronous operation here
    }
}

public class EnableGpsCommand extends CancelCommand
{
    public EnableGpsCommand( Activity activity) {
        super(activity);
    }

    public void execute()
    {
        // take the user to the phone gps settings and then start the asyncronous logic.
        m_activity.startActivity(new Intent(Settings.ACTION_LOCATION_SOURCE_SETTINGS));
        super.execute();
    }
} 
```

现在，从活动：

```
//returns true if the GpsProviderIsDisabled
//false otherwise
private boolean EnableGPSIfPossible()
{   
    final LocationManager manager = (LocationManager) getSystemService( Context.LOCATION_SERVICE );
    if ( !manager.isProviderEnabled( LocationManager.GPS_PROVIDER ) ) {
        buildAlertMessageNoGps();
        return true;
    }
    return false;
}

private  void buildAlertMessageNoGps()
{
    final AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setMessage("Yout GPS seems to be disabled, do you want to enable it?")
        .setCancelable(false)
        .setPositiveButton("Yes", new CommandWrapper(new EnableGpsCommand(this)))
        .setNegativeButton("No", new CommandWrapper(new CancelCommand(this))); 

    final AlertDialog alert = builder.create();
    alert.show();
} 
```

现在从 Activity OnCreate 方法中调用：

```
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.newfriendlist);

    InitializeComponents();

    if (!EnableGPSIfPossible())
    {
        //then gps is already enabled and we need to do StartFriendRetrievalAsync from here.
        //otherwise this code is being executed from the EnableGpsIfPossible() logic.

        //Asyncronous logic here.
    }
} 
```

我真的希望这会在您陷入困境时对您有所帮助:)。

干杯

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-06-12T13:01:29.097

```
 final AlertDialog.Builder builder = new AlertDialog.Builder(this);
         final String action = Settings.ACTION_LOCATION_SOURCE_SETTINGS;
         final String message = "your message";

         builder.setMessage(message)
             .setPositiveButton("OK",
                 new DialogInterface.OnClickListener() {
                     public void onClick(DialogInterface d, int id) {
                         getActivity().startActivity(new Intent(action));
                         d.dismiss();
                     }
             })
             .setNegativeButton("Cancel",
                 new DialogInterface.OnClickListener() {
                     public void onClick(DialogInterface d, int id) {
                         d.cancel();
                     }
             });
         builder.create().show(); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-20T15:58:14.663

（对不起我的英语）当我看到你的问题并且你的问题给出了答案时，我正在寻找解决方案。

问题是在对话框警报打开时活动继续启动，当用户按下“是”时，新活动将启动“gps 设置..”当用户在设置他的 gps 后返回第一个活动或只是忽略了你，这个相同的活动不会做任何更新或认为某些事情（如 gps 开启）已经发生，因为它已经加载，所以你必须收听更新并应用更改，或者在用户“返回”时重新启动活动，对我来说，我刚刚添加：

```
<activity
    ...
    android:noHistory="true"
    ... /> </activity> 
```

现在，每次用户按下“后退按钮”时，您的活动都会重新开始，考虑到它对我有用的新更新，希望这可以帮助您或帮助其他人

# c# - Ajax Chat 长轮询

> ID：12044555
> 
> 赞同：-3
> 
> 时间：2012-08-20T20:21:21.110
> 
> 标签：c#, asp.net, ajax, wcf

阅读[这篇文章后](http://anthymecaillard.wordpress.com/2012/06/06/wcf-real-time-web-development-with-long-polling/)，我决定编写自己的聊天应用程序。

与上面的帖子不同，我的应用程序允许更多轮询，例如当用户按下任何键时（为了通知另一个用户 1 正在写东西），显然当用户发送消息时。

这会导致一些问题：通常没有一个通知被正确读取，并且发送的消息并不总是从另一端读取。

如果有某种方式可以发送和接收不同类型的通知（消息、关于新写作的警报、新用户加入等），那就太好了。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T04:43:17.697

我很高兴地通知您我的聊天应用程序现在正在运行。

问题是关于在同一个 javascript 事件处理程序中对 wcf 服务的两次调用（发送消息按钮，我在其中通知了新消息和诸如“用户没有写任何东西”之类的警报，是的，我需要重置以前的警报（“用户正在写信息..”）。

现在我可以发送和接收许多通知并且一切正常。我已经用 10 个聊天页面对其进行了测试。

当然，我知道通过使用您建议我的框架，我可以实现更多的功能和稳定性，但我很高兴找到了一个相对简单、可定制和良好的解决方案来满足我的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:50:15.957

Signal R 是您问题的解决方案。我了解您想开发自己的解决方案，并且阴谋可能很诱人，但请考虑研究 SignalR - 能够掌握和操纵 SignalR 将带来好处，并让您更轻松地解决类似问题 - 它是添加到您的开发库中的绝佳工具。

事实上，无论如何继续开发您的解决方案，但让 SignalR 一次性完成其他项目或其他项目，作为在 .net 中实现此类客户端服务器通信的事实上的方法，它确实值得一看。可以使用下面的链接在 NuGet 上找到它，因此只需点击几下！

[http://nuget.org/packages/SignalR](http://nuget.org/packages/SignalR)

# c# - 将 ac char 数组 [128] 编组到 c#

> ID：12044559
> 
> 赞同：6
> 
> 时间：2012-08-20T20:21:35.000
> 
> 标签：c#, dll, struct, interop, marshalling

简单的问题，但我找不到直接的答案：我想在我的 C 结构中有一个 128 字节的 char 数组。我在 64 位 Windows 下运行它。我想使用以下命令将其编组到 c#：

C代码：

```
typedef struct s_parameterStuct
{
    int count;
    char name[ 128 ];
} parameterStruct; 
```

和 c# 代码：

```
[StructLayout(LayoutKind.Sequential, CharSet = CharSet.Ansi)]
public class parameterStuct
{
    public int count;

    [MarshalAs(UnmanagedType.ByValArray, SizeConst = 128)]
    public char[] name;
} 
```

由于 char 在 c# 中是 2 个字节，因此 SizeConst 应该是 128 还是 256。两者似乎都可以正常工作，但我知道其中只有一个是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T21:15:40.960

大小为 64，因为 64 个 2 字节数量与 128 个 1 字节数量具有相同的大小。

我会使用字节数组进行封送处理，否则您将不得不忍受拆分值才能获得 C 字符（它们是单字节）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:24:22.443

如果要编组到 C# char 数组（不知道为什么要这样做），则在 C# 端将大小设置为 64。

但是，您应该编组为字节数组（大小为 128），然后使用适当的 Text.Encoding 调用将字节数组转换为 .net 字符串（假设您需要字符串）。

# c# - 在 .Net WCF 服务框架中公开多个数据对象/方法的最佳设计策略是什么？

> ID：12044563
> 
> 赞同：0
> 
> 时间：2012-08-20T20:21:55.237
> 
> 标签：c#, .net, wcf

我对 Microsoft WCF 的世界比较陌生。关于用于实现一项或多项满足我需求的服务的最佳设计模式/方法，我有几个问题。

我有一个现有的 DataLayer，我想将其推送到 1 个或多个 WCF 服务中。后端数据库是 ORACLE（我有一个与正确版本的 ODAC 通信的整个数据访问层）。

当我查看现有数据层时，我（或多或少）支持多个数据对象（类）。

*   用户信息
*   用户活动历史审计
*   评价
*   评估工作流程和审查
*   评估报告

我有几个问题涉及在 WCF 中实现这一点的最佳方法。

1.  最好将其实现为一项服务或多项服务（与每个数据类/功能一致的服务）？

2.  最后，我想分享与 ORACLE ODAC 库通信的底层数据访问层。最好将它嵌入到共享库、程序集中吗？

3.  如果我使用多个服务，将它们全部挂在同一个端点上是否更清洁？

设计时使用的最佳策略是什么？

谢谢，约翰B

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:34:16.517

通常，您的业务层也将在服务器上实现。在这种情况下，您将简单地包装您的业务层。如果您在服务器端没有业务层，请根据相同的概念为您的服务建模。您正在公开一组功能以针对特定消费者（或一组消费者）。您通常会向每个消费者（或一组消费者）提供一项服务。话虽如此，您不希望一个大型的单体服务仅仅满足您所有的潜在需求。将其分解为逻辑区域。

大多数时候，包装单个数据层对象太小而无法自行包装。例外情况是，如果您只是为每个人提供通用的数据服务（在 REST 和 ODATA 服务中很常见）。

============================

1.  根据消费需求为您的服务建模。每个消费者集一项服务。
2.  如果您将在不同二进制文件中的多个业务层之间共享数据层，则数据层应存在于其自己的独立库中并共享。
3.  只要您保持一致，服务的端点布局通常并不重要。在一天结束时，您的消费者将简单地复制/粘贴您提供的端点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:36:58.817

最好的方法是使用一项服务，即 WCF 数据服务 (OData)，您可以在此处下载一个示例 [http://code.msdn.microsoft.com/WCF-Data-Service-OData-ebb4214a](http://code.msdn.microsoft.com/WCF-Data-Service-OData-ebb4214a)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-28T12:39:20.587

您是否考虑过使用工厂和存储库模式？像这样的东西。

```
`public interface IEmployee
{
    // define your model here (properties, for example)
    string FirstName {get; set;}
    string LastName {get; set;}
}

public interface IEmployeeBizFactory
{
    IEmployee CreateEmployee();
}

public class CustomEmployee : IEmployee
{
    // Implementation here
}

public class CustomEmployeeBizFactory : IEmployeeBizFactory
{
    public IEmployee CreateEmployee()
    {
        return new CustomEmployee();
    }
}`
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-08-20T21:19:30.770

考虑每个数据对象的数据协定

[使用数据契约](http://msdn.microsoft.com/en-us/library/ms733127.aspx)

# php - Smarty (& Codeigniter)：当前的路径是什么？

> ID：12044568
> 
> 赞同：0
> 
> 时间：2012-08-20T20:22:10.617
> 
> 标签：php, codeigniter, smarty, codeigniter-2

这是我第一次玩 CI 和 Smarty，我正在尝试构建一个相对 URI，以便我可以加载一个 JS 文件。

我猜测了用于导入小 js 插件的适当路径，并且可以使用一些指导。
我将插件放入`www/js`中，并且由于所有初始调用都通过`www/index.php`，所以我的第一次尝试很简单`src='js/blah/blah/blah.js'`。

如果有办法从 TPL 中回显路径，我认为这会给我足够的信息。
这些信息在 Smarty 中有用吗？有没有更好的方法来实现我的预期目标（加载 JS 文件）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:24:49.733

在 html 文件（js、css、图像等）中加载资源时，最好使用绝对路径。请求这些资源的是浏览器，而不是 CI 或 Smarty，所​​以我会使用：

```
/js/blah/blah/blah.js 
```

您的根目录是网络服务器根目录（`www/`在您的示例中）。

# eclipse - 如何在 Eclipse 的编辑器窗格一侧显示编辑器选项卡？

> ID：12044572
> 
> 赞同：2
> 
> 时间：2012-08-20T20:22:25.550
> 
> 标签：eclipse

在 Eclipse Indigo（我在 3.7.2）中，是否可以将编辑器选项卡从编辑器窗格的顶部移动到编辑器窗格的一侧，从而创建一个垂直的选项卡堆栈？这将允许一次查看更多选项卡。鉴于我的宽屏显示和大量活动文件，我在这之间切换将是一个有用的配置。我找不到可以这样做的设置或插件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-22T03:20:16.210

还不可能。看[这里](https://bugs.eclipse.org/bugs/show_bug.cgi?id=58945)和[这里](https://bugs.eclipse.org/bugs/show_bug.cgi?id=168379)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-24T23:21:44.273

我厌倦了无法做到这一点并编写了一个 eclipse 插件。您可以在市场上找到它：[https ://marketplace.eclipse.org/content/open-editors](https://marketplace.eclipse.org/content/open-editors)

[这是一个截图](https://i.stack.imgur.com/hfS6J.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:31:37.767

我不知道有什么插件可以做到这一点。

这（ [在 Eclipse 中，我可以查看当前以垂直堆栈而不是水平堆栈打开的文件吗？](https://stackoverflow.com/questions/6956065/in-eclipse-can-i-view-the-files-i-currently-have-open-in-a-vertical-stack-inste)）不幸地证实了这一点。

我只是搜索了一下。我可以看到很多关于拥有多行标签的讨论，但垂直标签似乎并没有出现很多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-03-09T09:39:39.347

Open-Editors 插件有问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-04T10:20:34.473

在`Windows10 + Eclipse 4.8 + OpenJDK11`. 100%

1.  刚刚测试过。不要忘记将您的 Eclipse 链接到 JDK-11
    [https://wiki.eclipse.org/Eclipse.ini](https://wiki.eclipse.org/Eclipse.ini)
2.  安装插件
    [https://marketplace.eclipse.org/content/open-editors#comment-6750](https://marketplace.eclipse.org/content/open-editors#comment-6750)

# bash - 让“完整”和“菜单完整”一起工作

> ID：12044574
> 
> 赞同：24
> 
> 时间：2012-08-20T20:22:28.767
> 
> 标签：bash, bash-completion

我发现 Bash shell 支持一种与“传统”自动完成不同的自动完成，其中所有可能性都列在下一行中。

使用“传统”自动完成功能，如果我键入`ch`然后按下`Tab`键，我会得到如下信息：

```
$ ch
chacl  chgrp  chmod  chown  chvt 
```

但是，如果我将以下行添加到我的`/etc/inputrc`（将 Tab 键重新映射到内置`menu-complete`函数）：

```
Tab: menu-complete 
```

然后 shell 的行为发生了变化：要完成的单词被替换为“内联”，从可能的完成列表中找到一个匹配项，如果我再次按 Tab 键，该单词将被下一个匹配项替换。

我发现这很有用，但我仍然想保留传统的自动完成并将其绑定到 key combination `Ctrl + Tab`。`/etc/inputrc`因此，根据`readline`库文档的建议，我在文件中添加了以下行：

```
Ctrl-Tab: complete 
```

但是，添加这一行似乎只能同时`Tab`调用`Ctrl-Tab`传统`complete`函数。

有谁知道我做错了什么？

提前致谢！

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-08-20T21:29:27.950

首先，我不是这方面的专家，但我想我可以回答你的问题。首先，当您使用 Bash 时，Bash 是一个 shell，它解释从终端/控制台接收到的键盘命令。当您通知 Bash 如何对 inputrc 文件中的特定组合键做出反应时，您的终端会在 inputrc 文件甚至进入等式之前精确地确定哪个字符被“发送”到 Shell。

不幸的是，在我的系统上（当然，它是 OSX - 但与 Linux 相比，我认为这不是奇怪的行为），两者都`Tab`向`Ctrl-Tab`shell 发送相同的键盘输入。事实上，Tab 和向 shell`Ctrl-Tab`发送`Ctrl-I`命令，实际上，如果我`Ctrl-I`在使用终端时输入，它会执行完成，就像我按 Tab 一样。

该软件（默认安装在大多数 Linux 系统上）showkey 将告诉您当您按下特定键盘输入时，shell 正在接收哪些键。

无论如何，我对你的建议是使用`Shift-Tab`，它似乎确实将它自己的密钥代码发送到外壳。`Shift-Tab`在我的电脑上显示（使用 showkey）为“<ESC>[Z”，我认为这是非常标准的。因此，具有以下绑定的 inputrc 文件应该允许您使用`shift-tab`而不是`ctrl-tab`实现您想要的：

```
Tab: menu-complete
"\e[Z": complete 
```

第二个绑定中的 \e 代表转义字符，而 [Z 只是使用 showkey 显示的字符。您可以通过简单地使用 cat 在 OSX 上获得类似的效果，从终端中运行 cat 并按下`Shift-Tab`将显示“^[[Z”，其中 ^[ 表示转义字符，其他字符与以前一样。

我知道这并不能准确地解决您的问题，但是因为我认为您不能将其`Ctrl-Tab`用作组合键，而无需重新映射`Ctrl-Tab`到终端中的另一个键绑定（如果您使用的是 GUI，则可能会更容易终端），这很可能在不费力的情况下尽可能接近！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2017-11-26T10:09:01.517

我已经`Shift``Tab`绑定到`menu-complete-backward`，所以如果我跳过正确的完成，它会后退一步，并且我已经映射`Ctrl``q`到`complete`，所以如果有几个可能的完成，我会点击`Ctrl``q`列出它们而不必循环它们。

```
# Make Tab cycle between possible completions
# Cycle forward: Tab
# Cycle backward: Shift-Tab

TAB: menu-complete
"\e[Z": menu-complete-backward

# Make C-q display the list of possible completions

Control-q: complete

# Display the list of matches when no further completion is possible

set show-all-if-unmodified on 
```

**Edit:** `Ctrl``q`默认绑定到`quoted-insert`，也就是说，它告诉 shell 从字面上获取下一个键。`quoted-insert`也绑定到`Ctrl``v`，所以如果你重新绑定，你不会失去那个功能`Ctrl``q`。无论如何，我发现`Alt``ESC`默认情况下，它也适用于显示可能的完成（据我所知，它相当于`TAB`）；请注意，它可能被 Gnome 占用，然后在设置 → 设备 → 键盘 → 导航中双击`ESC`或重新绑定“直接切换窗口”。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-08-07T17:27:11.953

以下应该实现您正在寻找的东西（如果我理解正确！）

在你的`.inputrc`

```
# display all possible matches for an ambiguous pattern at first tab
set show-all-if-ambiguous on

# next tab(s) will cycle through matches
TAB: menu-complete
# shift tab cycles backward
"\e[Z": menu-complete-backward 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T20:44:25.537

我不确定 Ctrl-Tab 是不是一个真实的角色；例如，我的终端会忽略该组合。我认为使用 Ctrl-Tab 的唯一方法是使用终端仿真器将其映射到其他未使用的转义序列，然后将该序列绑定到`complete`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-29T04:14:31.420

从哪里开始，如果你能或不能这样做取决于你的键盘和你的驱动程序，并且没有一个包罗万象的答案。每次按键和释放都会生成一个有序的键对（按键和释放）（扫描码）这些代码然后由内核翻译成键码，例如在我的笔记本电脑键盘上 0x3a 0xba 被翻译成键码 15（向下和向上）然后这些是翻译成诸如返回字母ca之类的动作/您可以使用键码/十六进制/二进制/八进制表示法将动作分配给键符哪些代码匹配哪些字母由相当标准化的内核翻译表确定，但是第一部分信号被翻译成大多数键盘的键码都不同。

继续我之前的示例 shift 选项卡（以及 alt 和 control 以及任何组合）产生键码 15 但是在十六进制中它产生 0x2a 0x2a 0x2a 0x2a 0x2a 0x2a 0x2a 0x2a 0x2a 0x2a 0x2a 这是因为 shift alt 和 control 是特殊键（修饰符）这些与键码相乘并填写转储键表内核也仅限于分配的数量，这取决于您选择的键映射并与您的终端颜色共享资源（如果您的 char 将其定义为高于阈值它限制您的终端颜色范围）。如果您在 xserver 中并且拥有全新的系统，那么这一切都会消失。大多数这些东西都可以由用户和安装的程序来改变、修改和操作。我对这一切的观点是要强调，tab 键的映射并没有包罗万象，它会将键盘驱动程序更改为 kbd 驱动程序（现在，如果你找到一个恰好对你有用的解决方案 :)）但是机会如果您更改键盘并且可能无法在 xserver 和 tui 之间转换，它是否不便携并且可能无法工作。我推荐的是学习在旅途中修改 kbd 的步骤。

 `将为您在同一行上的按键提供十进制八进制十六进制表示法

```
--full-table -1 >> keytable 
```

将为您提供一份包含完整 keycode->keysym 配对列表的文档，格式可以让您更好地了解您的布局，从那里您可以使用 loadkey 更改键值或在 .inputrc 或您的主 rc 文件。您还可以创建自定义 key.map 文件。进一步的转义序列转换由“$TERM”变量决定，每个虚拟终端模拟器可以不同

```
infocmp "$TERM" 
```

将为您提供终端转义序列的列表

**资源：**

[https://man7.org/linux/man-pages/man4/console_codes.4.html](https://man7.org/linux/man-pages/man4/console_codes.4.html)

[https://www.gnu.org/software/screen/manual/html_node/Input-Translation.html](https://www.gnu.org/software/screen/manual/html_node/Input-Translation.html)

[http://kbd-project.org/docs/scancodes/scancodes.html](http://kbd-project.org/docs/scancodes/scancodes.html)

[https://www.vt100.net/](https://www.vt100.net/)

所以总结一下。您的键盘驱动程序 您的 kemap 选择 您的虚拟终端仿真器和您的内核构成了重新映射困难键 (tab/s-tab/a-tab) 的主干`

# delphi - delphi7中使用PSafeArray调用COM时出错

> ID：12044591
> 
> 赞同：4
> 
> 时间：2012-08-20T20:24:03.487
> 
> 标签：delphi, com, safearray

我有一个需要使用 COM 调用的过程，它在 C# 中声明如下：

```
public string ali(int[] num)
{
    string r;
    r ="";
    foreach (int a in num)
    {
        r = r + Convert.ToString(a) + ";";   
    }
    return r;
} 
```

导入的 TypeLibrary 中的 Delphi 声明为：

```
function TSqr.ali(num: PSafeArray): WideString;
begin
  Result := DefaultInterface.ali(num);
end; 
```

我有这段代码可以将整数数组转换为 PSafeArray：

```
Function ArrayToSafeArray2 (DataArray: array of integer):PSafeArray;
var
  SafeArray: PSafeArray;
  InDataLength,i: Integer;
  vaInMatrix: Variant;
begin
  InDataLength := Length(DataArray);
  vaInMatrix := VarArrayCreate([Low(DataArray), High(DataArray)], varInteger);
  for i:= Low(DataArray) to High(DataArray) do
  begin
    vaInMatrix[I] :=  DataArray[I];
  end;
  SafeArray := PSafeArray(TVarData(vaInMatrix).VArray);
  Result := SafeArray;
  VarClear(vaInMatrix);
  SafeArrayDestroy(SafeArray);
end; 
```

这段代码调用我的 COM 函数

```
var
  a:array of integer;
  Answer:String;
begin
  SetLength(a,3);

  a[0] := 1;
  a[1] := 2;
  a[2] := 2;

  Answer := Sqr1.ali(ArrayToSafeArray2(a));
  ShowMessage(Answer);
end; 
```

但错误发生：

“ EOLeExeption 带有消息 'SafeArray of rank 0 已被传递给期望 rank 1 数组的方法' ...”

我应该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-21T05:11:08.550

您的转换例程在调用者可以使用它之前破坏了 SafeArray。与 Delphi 数组不同，COM 数组没有引用计数。在将 SafeArray 传递给 COM 程序之前，不要破坏它，例如：

```
function ArrayToSafeArray2 (DataArray: array of integer): Variant;
var
  i: Integer;
begin
  Result := VarArrayCreate([Low(DataArray), High(DataArray)], varInteger);
  for i:= Low(DataArray) to High(DataArray) do
  begin
    Result[I] := DataArray[I];
  end;
end; 
```

.

```
var
  a:array of integer;
  v: Variant;
  Answer:String;
begin
  SetLength(a,3);

  a[0] := 1;
  a[1] := 2;
  a[2] := 2;

  v := ArrayToSafeArray2(a);

  Answer := Sqr1.ali(TVarData(v).VArray);
  ShowMessage(Answer);
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T09:42:44.843

VarUtils 单元有[SafeArrayCreate](http://docwiki.embarcadero.com/Libraries/en/System.VarUtils.SafeArrayCreate)函数，记得调用[SafeArrayDestroy](http://docwiki.embarcadero.com/Libraries/en/System.VarUtils.SafeArrayDestroy)（最好在 try/finally 部分）！

# .net - 对数据网格进行排序后索引不会更改

> ID：12044592
> 
> 赞同：1
> 
> 时间：2012-08-20T20:24:10.170
> 
> 标签：.net, wpf, wpfdatagrid

我有一个问题请帮助我：我在 WPF 中有一个名为 contacts_datagrid 的数据网格。它从具有 2 个字段（姓名、电话号码）的 CSV 文件加载数据。在运行我的应用程序时，它会从此 csv 文件加载数据。我已经放置了一个导入函数，它导入另一个 csv 文件并使用以下代码将其数据附加到第一个 csv 文件的底部：

```
foreach (DataRow drow in second_csv_file.Rows)
  {
   First_csv_file.Rows.Add(drow.ItemArray);
  } 
```

它工作正常。然后我想按字母顺序对我的列进行排序，我使用这个：

```
ICollectionView dataView = CollectionViewSource.GetDefaultView(contacts_datagrid.ItemsSource);
dataView.SortDescriptions.Clear();
dataView.SortDescriptions.Add(new SortDescription("Name", ListSortDirection.Ascending));
dataView.Refresh(); 
```

这也可以正常工作，并且在这样做之后，我的新表中的所有合并数据都采用升序格式。当我尝试使用以下方法删除所选索引的行时，问题是在执行此操作后：

```
table.Rows.RemoveAt(contacts_datagrid.SelectedIndex); 
```

该程序不会删除正确的索引。例如，我的第一个 csv 是 [a,c,c,d]，第二个 csv 是 [z,a,d,k] 排序后的表格包含并显示 [a,a,c,c,d,d,k ,z] 我想要的，但是当我单击行“z”时，它不会删除“z”行，而是删除“k”。换句话说，索引是相同的，但行的位置已更改，删除函数现在根据排序前的最后一个索引删除。我已经尝试刷新数据网格并重新加载数据网格但没有成功，请帮助我谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T07:36:43.283

在对网格进行排序操作后，DataGrid 中的 SelectedIndex 将不会指向与源中的索引相同的项目。尝试使用 SelectedItem 和 Remove(item) 而不是 RemoveAt(index)。

# javascript - 与 Javascript 中的算术运算符混淆

> ID：12044595
> 
> 赞同：2
> 
> 时间：2012-08-20T20:24:16.437
> 
> 标签：javascript

虽然我知道以下问题很简单，但它与我无法通过 Google 找到的特定情况有关。以下代码使用 Javascript。

假设有一个变量

```
x = x + 1; 
```

我可以从教程中看到这应该可以工作。但是，我们应该如何在计算中使用这个变量呢？

我尝试过以下代码

```
var name = name + 1;
alert(name); 
```

以上输出“NaN”；不管那是什么...

```
var name = name + 1;
name = 2;
alert(name); 
```

上面的输出 2 只是简单地覆盖了原始变量。

```
name = prompt("input any number");
var name = name + 1
alert(name); 
```

上面将提供的输入 + 1 作为**字符串**输出，即 01 ，其中输入为“0”，不带引号。

我记得在 ruby​​ 课程中，我们使用 .to_i 将字符串转换为整数。我们如何在 Javascript 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:25:37.083

`+`在不同的语境下有不同的意思。如果两个操作数是数字，那么它会加法。如果一个操作数是一个字符串，它会进行字符串连接，所以

```
var x = "2"; // x is the String "2"
alert(x+2); // "22"

var x = 2; // x is the number 2
alert(x+2); // 4 
```

如果要将字符串转换为数字，可以执行

`if (x) x = parseInt(x, 10);`

其中第二个参数是基数（即数字系统的基数），您应该使用它。例如，如果有人输入 02，则基数会阻止 javascript 将其视为八进制（或其他）数字。

当然，您始终需要确保在使用变量之前定义它们。我敢打赌，您的 NaN 结果来自未定义的变量。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T20:26:43.923

```
var name = name + 1; 
```

上面的代码声明了一个名为的*新*变量`name`，它包含之前包含的任何`name`内容，加上 1。由于`name`刚刚出现，它没有数值（“非数字”或 NaN）。NaN 加 1 得到 NaN。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T20:27:15.767

您的问题是您从不*初始化*名称。例如：

```
var name = 0;
alert(name); // Name is 0
name = name + 1;
alert(name); // Name is 1 
```

如果你不初始化它，它会给你 NaN: Not a Number。

要将字符串转换为数字，请使用`parseInt`or `parseFloat`：

```
var name = prompt("input any number"); // I input 3
name = parseFloat(name);
name = name + 1;
alert(name); // Name is 4 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T20:26:29.370

用于`parseInt`将字符串转换为数字。

该行`x = x + 1`表示“取 的现有值`x`，将其加一，然后将结果值重新存储`x`”。

该行`var name = name + 1`没有意义，因为`name`在执行语句时没有现有值。这与说`undefined + 1`which is `NaN`(Not a Number) 相同。

`+`以下是运算符在 JavaScript中如何工作的一些示例：

```
 1  +  2  // number + number is a number -> 3
"1" +  2  // string + anything is a string => "12"
 1  + "2" // anything + string is a string => "12"
"1" + "2" // string + string is a string => "12" 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-20T20:28:59.647

NaN 的意思是“不是数字”。由于 name 在第一次声明时没有值，所以说“var name = name + 1”没有数字含义，因为 name 在第一次使用时正在被声明。

在第二个示例中，name 被确定为字符串。Javascript 不像其他语言那样对类型敏感，所以它使用 + 作为连接运算符而不是数字运算符，因为它在上下文中更有意义，

# python - S3 不读取相对路径？

> ID：12044598
> 
> 赞同：1
> 
> 时间：2012-08-20T20:24:24.647
> 
> 标签：python, django, amazon-s3

嗨，在将静态文件加载到 S3 后，我在为应用程序同步 CSS 的一些部分时遇到了一些麻烦。我的图标和背景图像都没有加载，我怀疑这是因为路径的路由方式。在样式表中，它们当前都加载为：

```
background-image: url("../img/glyphicons-halflings.png");

background: url("../img/background.png"); 
```

当我加载托管在我自己计算机上的静态文件时，这工作正常。我有点困惑为什么在 S3 上加载这种类型的路径时不会加载。那里的相对路径都是一样的。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T20:27:54.020

确保文件夹和图像可公开访问。默认情况下，S3 将内容设为私有，从而阻止浏览器加载您的图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:33:42.880

此外，除了授予权限之外，您确定您生成的图像 url 是

`https://s3.amazonaws.com/<bucketname>/img/background.png`

如果没有，你可能想这样做。您还应该在存储桶中有 img 文件夹，并且您的文件应该存在于该文件夹中。

# c# - 从网页预填充网页

> ID：12044606
> 
> 赞同：1
> 
> 时间：2012-08-20T20:25:14.507
> 
> 标签：c#, javascript, asp.net

我们在 Windows 应用程序中有一个功能，它可以打开 Web 浏览器，导航到某些预配置的网站，并使用我们数据库中的数据自动填充表单——这对用户来说是一个方便的功能。

现在我们要构建此功能的 Asp.Net 版本，以便从我们的 Web 应用程序中，用户单击链接/按钮，然后我们打开页面（使用重定向？使用 JavaScript？）。然后我们填写表格，以便用户可以查看数据并提交。

为此，我认为我们要么需要将 javascript 注入正在加载外部窗口的浏览器框架中，要么我们需要能够与该窗口进行交互。

我们担心浏览器安全可能不允许这样做——它可能看起来像是某种欺骗攻击。什么是这样做的好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T21:26:36.333

如果打开弹出窗口的网站和在弹出窗口中打开的网站之间的域、协议和端口不匹配，那么您的代码将违反[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，要么被忽略，要么抛出异常。

这是一个示例来演示：

```
<!doctype html>
<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<script type="text/javascript">
    openPopUp = function(href) {
        var props = "width=500,height=500,menubar=no,toolbar=no,scrollbars=yes";
        var win = window.open(href, href, props);
        if (win == null) alert("Your popup blocker is ruining my demo.");
        return win;
    };

    openMe = function(url){
        href = (url=="")?document.location:url;

        pu = openPopUp(href);

        //This will be ignored silently if Same Origin Policy is violated
        pu.onload = function() { 
            p = pu.document.createElement("p");
            p.appendChild(pu.document.createTextNode("onload was here."));
            pu.document.body.appendChild(p);
        };

        //This will throw an exception if Same Origin Policy is violated
        setTimeout(function() { 
            p = pu.document.createElement("p");
            p.appendChild(pu.document.createTextNode("setTimeout was here."));
            pu.document.body.appendChild(p);
        },3000);

        return false;
    }
</script>
<body>
<a href="" onclick="return openMe(this.href);">Self</a>
<a href="https://www.google.com/" onclick="return openMe(this.href);">Google</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:33:15.180

你需要做一个书签。从您的 asp.net 页面，创建一个链接，用户将其拖到他的浏览器书签中。用户单击指向您要填写的页面的链接。然后他单击新创建的书签。

在纯 javascript 中这是不可能的，这就是您需要使用书签的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T21:01:41.463

场景：你有两个页面 base.aspx 和 popup.aspx。单击 base.aspx 上的链接时，您希望打开填充了所需数据的 popup.aspx。您可以同时控制 base.aspx 和 popup.aspx

这些是我认为你可以实现这一目标的几种方法

1.  如果您想要在 popup.aspx 上的数据已经加载到 base.aspx。然后在查询字符串中发送此数据（如果它不太长）
2.  如果您想要在 popup.aspx 上的数据已经加载到 base.aspx。使用 popup.aspx 中的 window.opener 从 base.aspx 读取表单字段。注意：window.opener 仅在 base 和 popup 都在同一个域中时才有效。
3.  在 popup.aspx URL (http:///popup.aspx?actiodId=1234QWE6789) 中发送标识符字符串，现在在 popup.aspx 的 page_load 中从数据库查询 actiodId 获取数据

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-20T21:17:50.370

做你想做的事情的最好方法是创建一个浏览器插件。尝试在[此处](https://developers.google.com/chrome-developer-tools/)查找更多信息。但是使用浏览器插件，您可以完全控制 DOM，并且可以注入 javascript 代码来完成您正在做的事情。如果需要，您甚至可以从插件中调用 Web 服务。

# java - 将 JPanel 类传递给 JAVA 中的主类

> ID：12044612
> 
> 赞同：0
> 
> 时间：2012-08-20T20:25:45.720
> 
> 标签：java, swing, jpanel, paintcomponent

我需要将 JPanel 扩展类传递给主类。

到目前为止，这是我所拥有的：主要课程

```
import java.awt.Color;
import javax.swing.*;

public class main {

    private gamePanel gamepanel = new gamePanel();

    public JPanel createContentPane(){
        // We create a bottom JPanel to place everything on.
        JPanel totalGUI = new JPanel();

        //We set the Layout Manager to null so we can manually place
        // the Panels.
        totalGUI.setLayout(null);

        //Now we create a new panel and add it to the bottom JPanel.

        totalGUI.add(gamepanel);

        totalGUI.setOpaque(true);
        return totalGUI;
    }

    private static void createAndShowGUI(){
        JFrame.setDefaultLookAndFeelDecorated(true);
        JFrame frame = new JFrame("[=] There's a JPanel in here! [=]");

        //Create and set up the content pane.
        main demo = new main();
        frame.setContentPane(demo.createContentPane());

        //The other bits and pieces that make your program a bit more stable.
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(700,500);
        frame.setVisible(true);

    }
    public static void main(String[] args) {
        //Schedule a jog for the event-dispatching thread:
        //creating and showing this application's GUI.
        System.out.println(gamepanel);
        SwingUtilities.invokeLater(new Runnable() {
            public void run(){
                createAndShowGUI();
            }
        });
    }
} 
```

游戏面板类

```
public class gamePanel extends JPanel implements Commons {

    private Dimension d;
    private ArrayList snowmens;
    private coreFunctions functions = new coreFunctions();
    private int snowmenX = 150;
    private int snowmenY = 5;
    private final String snowmenpix = "snowman.png";
    private JPanel background;

public gamePanel() {

    add(new JLabel("TEST"));
    setFocusable(true);

    setDoubleBuffered(true);
}

@Override
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    g.setColor(Color.BLUE);
    g.fillRect(0, 0, 700, 700);

}
} 
```

我不知道为什么没有显示蓝色背景和标签......

编辑：

以下是更多详细信息：

好的，所以我正在尝试制作一个小 2D 游戏。为此，我需要在 gamePanel 类上创建一些雪人并通过主类显示它。要启动它，createContentPane 会创建一个背景面板，如果需要，它是根面板。createandshowgui 创建一个 JFrame。

gamepanel 类实际上是一个 JPanel，到目前为止有 1 个面板，即背景面板。现在，我只希望它有蓝色背景。

我试着这样说是因为我看到了一些例子，它们与我所拥有的非常相似，但由于某种原因，我无法让它工作......

谢谢你，阿拉

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T20:39:46.023

您应该使用`LayoutManager`代替，`setLayout(null);`如果只添加一个组件，则也不需要它（除非添加其他组件，否则该组件将拉伸以填充）

`LayoutManager`有关s的教程，请参见此处：

*   [http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)
*   [http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/using.html)

如果您要做的只是拥有蓝色背景（您可以在其上添加组件），那么只需覆盖`paintComponent()`您的`gamePanel`并将背景涂成蓝色：

```
 @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.setColor(Color.BLUE);
        g.fillRect(0, 0, this.getWidth(), this.getHeight());
    } 
```

然后你可以添加你的`JLabel`，就好像它是一个普通的面板一样，因为背景现在被涂成蓝色，而不是由/作为组件设置。

如果你有图片看看`g.drawImage(Image image,int x,int y,ImageObserver iO)`

编辑

拨打电话至：

`setLayout(null);`

它会起作用

# epub - 将 JavaScript 状态保存在 ePub 的主干中

> ID：12044613
> 
> 赞同：1
> 
> 时间：2012-08-20T20:25:46.560
> 
> 标签：epub, ibooks

是否可以在 ePub 中跨页面保持代码状态？更具体地说，像 iBooks 这样的阅读器是否允许这种状态？

```
 spine.js
        +---------+----------+        
        |         |          | 
+--------+   +--------+  +--------+
| Page 1 |   | Page 2 |  | Page   |
| Quiz1  |   |  Quiz2 |  | (n)    |
|        |   |        |  | Result |
|        |   |        |  |        |
+--------+   +--------+  +--------+ 
```

在这个例子中，最后一页可能包含一个分数，但状态是必需的。WebSQL 是不可能的，因为 webkit 电子阅读器不支持它，并且 websockets 需要连接。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-28T07:38:02.547

不，每个 HTML 文件都是独立的。要共享信息，您需要使用某种本地存储，例如 window.localStorage，但很难找出哪些设备支持什么级别的 HTML5。

更新：[这个线程](https://discussions.apple.com/thread/3686472?start=0&tstart=0)说 localStorage 实际上是受支持的。

# php - 如何使用 PHP 将米转换为英尺

> ID：12044615
> 
> 赞同：1
> 
> 时间：2012-08-20T20:26:17.357
> 
> 标签：php

我使用了显示错误的代码：即，如果我的仪表是 175m，但是当我转换它并没有显示那个东西

```
<?php
function metersToFeetInches($meters, $echo = true)
{
    $m = $meters;
    $valInFeet = $m*3.2808399;
    $valFeet = (int)$valInFeet;
    $valInches = round(($valInFeet-$valFeet)*12);
    $data = $valFeet."&prime;".$valInches."&Prime;";
    if($echo == true)
    {
            echo $data;
    } else {
            return $data;
    }
}
?>
<?php
$feetInches = metersToFeetInches(1.75,false);
echo $feetInches;
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T20:35:10.090

这是您可以在[Google](http://www.google.nl/search?q=meter%20to%20foot%20php)上轻松找到的内容之一，但我猜您没有比第一个链接看得更远。

无论如何，你应该这样做。

```
<?php

function metersToFeet($meters) {
    return floatval($meters) * 3.2808399;
}

?> 
```

但是为什么这比您发布的代码更好？好吧，函数不应该做所有事情。您应该为某个动作编写一个函数，而不是一个包含您可能需要的一切的大函数。因为**如果**你需要向那个函数添加一些东西或者改变动作的顺序，那就是大量的工作。

此外，您的函数有一个选项`$echo`。但是你为什么需要那个？您可以为每个函数添加这样一个选项，但是 PHP 有一个很好的命令：`echo`. 所以相反，写`echo metersToFeet(10)`. 或者`$value = metersToFeet(10)`，如果您需要将结果保存在变量中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-07-05T08:02:36.913

```
<?php
function metersToFeetInches($meters, $echo = true)
{
    $m = $meters;
    $valInFeet = $m*3.2808399;
    $valFeet = (int)$valInFeet;
    $valInches = round(($valInFeet-$valFeet)*12);
    $data = $valFeet."&prime;".$valInches."&Prime;";
    if($echo == true)
    {
        echo $data;
    } else {
        return $data;
    }
}
?> 
```

# r - 交替、交织或交错两个向量

> ID：12044616
> 
> 赞同：18
> 
> 时间：2012-08-20T20:26:18.717
> 
> 标签：r, vector

我想交错两个相同模式和相等长度的向量。说：

```
a <- rpois(lambda=3,n=5e5)
b <- rpois(lambda=4,n=5e5) 
```

我想将这两个向量交织或交错，以创建一个等效的向量`c(a[1],b[1],a[2],b[2],...,a[length(a)],b[length(b)])`

我的第一次尝试是这样的：

```
sapply(X=rep.int(c(3,4),times=5e5),FUN=rpois,n=1) 
```

但它需要`rpois`被调用的次数远远超过需要的次数。

到目前为止，我最好的尝试是将其转换为矩阵并重新转换回向量：

```
d <- c(rbind(rpois(lambda=3,n=5e5),rpois(lambda=4,n=5e5)))
d <- c(rbind(a,b)) 
```

有没有更好的方法去做呢？或者 base 中是否有一个功能`R`可以完成同样的事情？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-08-20T20:28:32.160

你的`rbind`方法应该很好用。你也可以使用

```
rpois(lambda=c(3,4),n=1e6) 
```

因为 R 会自动将 lambda 值的向量复制到所需的长度。速度差别不大：

```
library(rbenchmark)
benchmark(rpois(1e6,c(3,4)),
     c(rbind(rpois(5e5,3),rpois(5e5,4))))

#                                        test replications elapsed relative
# 2 c(rbind(rpois(5e+05, 3), rpois(5e+05, 4)))          100  23.390 1.112168
# 1                      rpois(1e+06, c(3, 4))          100  21.031 1.000000 
```

并且优雅是旁观者的眼中...当然，该`c(rbind(...))`方法通常适用于构造交替向量，而另一种解决方案特定于`rpois`或其他以这种方式复制其参数的函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-08-20T22:55:02.953

一些速度测试，结合 Ben Bolker 的回答：

```
 benchmark(
 c(rbind(rpois(lambda=3,n=5e5),rpois(lambda=4,n=5e5))),
 c(t(sapply(X=list(3,4),FUN=rpois,n=5e5))),
 sapply(X=rep.int(c(3,4),times=5e5),FUN=rpois,n=1),
 rpois(lambda=c(3,4),n=1e6),
 rpois(lambda=rep.int(c(3,4),times=5e5),n=1e6)
 )
                                                                  test
1 c(rbind(rpois(lambda = 3, n = 5e+05), rpois(lambda = 4, n = 5e+05)))
2                 c(t(sapply(X = list(3, 4), FUN = rpois, n = 5e+05)))
4                                   rpois(lambda = c(3, 4), n = 1e+06)
5           rpois(lambda = rep.int(c(3, 4), times = 5e+05), n = 1e+06)
3      sapply(X = rep.int(c(3, 4), times = 5e+05), FUN = rpois, n = 1)
  replications elapsed   relative user.self sys.self user.child sys.child
1          100    6.14   1.000000      5.93     0.15         NA        NA
2          100    7.11   1.157980      7.02     0.02         NA        NA
4          100   14.09   2.294788     13.61     0.05         NA        NA
5          100   14.24   2.319218     13.73     0.21         NA        NA
3          100  700.84 114.143322    683.51     0.50         NA        NA 
```

# php - 镜像mysql表结构

> ID：12044619
> 
> 赞同：1
> 
> 时间：2012-08-20T20:26:29.323
> 
> 标签：php, mysql, database

有人将如何维护具有相似结构的不同表：

示例：我有 600 个包含 20 个字段的表，并且我已经使用这个结构几个月了，如果我需要删除 1 个字段并添加 2 个新字段怎么办，如何仅通过更改包含该结构的主表来完成必须由所有其他克隆表使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-16T11:29:44.733

好吧，您可能知道您的结构远非最佳，最好的解决方案是重新组织它。但是，使用遗留系统并不总是那么容易，因此仍然可以仅使用 MySQL 执行该任务。

您将需要只能在存储过程中使用的“游标”，因此您需要先创建一个存储过程（其示例代码如下），然后执行 as `CALL alter_many_tables()`;

```
CREATE PROCEDURE alter_many_tables()
BEGIN
    -- reading names of the table to update in a cursor
    DECLARE tables_cursor CURSOR FOR 
        SELECT DISTINCT 
            `TABLE_NAME`
        FROM
            `information_schema`.`columns`
        WHERE
            `TABLE_NAME` LIKE '%\_modulep'
    ;

    -- condition for the loop over found tables to stop
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;

    -- looping
    read_loop: LOOP
        -- reading table name into a variable
        FETCH tables_cursor INTO table_name;

        -- check if the loop is over
        IF done THEN
            LEAVE read_loop;
        END IF;

        -- forming a table update SQL (modify it as you need)
        SET @sql = CONCAT('ALTER TABLE ', @table_name, ' ADD COLUMN `new_column` VARCHAR(45) NULL DEFAULT NULL');

        -- executing the SQL we have composed above
        PREPARE stmt FROM @sql;
        EXECUTE stmt;
     END LOOP;

     -- closing the cursor
     CLOSE table_cursor;
END; 
```

上面的代码段中可能有一些小的语法错误，因为我目前无法测试，但你明白了。

# c# - 将 Word DOCX 文件另存为 PDF

> ID：12044620
> 
> 赞同：7
> 
> 时间：2012-08-20T20:26:31.927
> 
> 标签：c#, .net, pdf, openxml, docx

我正在使用 openxml 创建 Word DOCX 文件。一旦将这些文档创建为 PDF 文件，我想保存它们。有没有办法在openxml中做到这一点？我认为答案是否定的。如果不是，是否有推荐的库或工具可用于将 DOCX 文件保存/打印为 PDF（以编程方式，在 .NET 中）？我查看了 sharpPDF (PDFSharp)，似乎这个库仅用于从头开始生成 PDF，而不是将 DOCX 保存为 PDF。

我能否以某种方式以全自动方式打印到已安装的 PDF 打印机，Cute PDF 或 Windows 7 内置的 PDF 打印机？

更新：寻找免费的非病毒许可，最好不需要额外的安装。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-08-21T12:55:39.280

您可以使用 Word 自动化来做到这一点。你需要安装word。

```
var TheDocument = TheWordApp.Documents.Open(docName);

TheDocument.ExportAsFixedFormat(
            docName.Replace(".docx", ".pdf"),
            Word.WdExportFormat.wdExportFormatPDF, 
            OptimizeFor: Word.WdExportOptimizeFor.wdExportOptimizeForOnScreen, 
            BitmapMissingFonts: true, DocStructureTags: false);

((Word._Document)TheDocument).Close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-21T01:26:37.463

要从 DocX -> PDF 获取，您需要能够呈现 DocX 文件并提供 PDF 导出/保存功能的东西。不用说，可以渲染 DocX 的工具并不多（Word、OpenOffice/LibreOffice 和下面提到的一些其他许可产品）。根据您的运行时限制/要求，您可以尝试：

1.  使用 MS 自动化让 Word 加载 docx 并另存为 PDF。
2.  位于 OpenOffice (JODConverter/Docmosis) 之上的工具来进行转换。
3.  尝试嵌入其他文档库（Aspose、Windward）

我不确定自动打印要求抱歉。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T12:57:24.067

我过去曾为此成功使用过[Aspose](http://www.aspose.com/categories/.net-components/aspose.total-for-.net/default.aspx)工具套件：[https](https://stackoverflow.com/a/5513946/54762) ://stackoverflow.com/a/5513946/54762 。它不是免费的，但您可以在购买前进行演示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-08-21T15:26:00.447

我已经使用[了这个](http://www.suodenjoki.dk/us/productions/articles/word2pdf.htm)VBScript，它运行良好。它在后台工作（打开 docx 并使用“保存/导出为 PDF”选项另存为 PDF）。检查页面上列出的系统要求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-21T12:36:16.147

我们生产 WordGlue .NET，这是一个可以处理 doc/docx 的通用 WP 布局引擎。

它是完全托管的，可用于导出为各种格式，如图像、XPS 或（在 ABCpdf 等 PDF 库的帮助下）PDF。

我在 ABCpdf .NET 软件组件上工作，因此我的回复可能包含基于 ABCpdf 的概念。这只是我所知道的。:-)

# facebook - 无法向 FB 提交错误报告

> ID：12044625
> 
> 赞同：5
> 
> 时间：2012-08-20T20:26:52.410
> 
> 标签：facebook

在[https://developers.facebook.com/bugs](https://developers.facebook.com/bugs)上浏览 FB 错误后，没有找到我的问题的答案，我在 SO - [https://stackoverflow.com/questions/12042372/facebook-like-button上发布了一个问题-不安全的javascript尝试](https://stackoverflow.com/questions/12042372/facebook-like-button-unsafe-javascript-attempt)。

尽管我仍然希望 SO 社区中的某个人有答案，但我认为最好在 FB 上创建一个错误报告。不幸的是，我看不到创建错误报告的方法。几个谷歌出现了这个教程 - [https://developers.facebook.com/blog/post/559/](https://developers.facebook.com/blog/post/559/)，但是“创建”按钮没有出现在我的页面上。

我觉得发布一个关于如何发布错误的问题很愚蠢，但我已经用尽了我有限的资源。

**附加信息**

我已经尝试过这里提到的解决方案：[如何向 Facebook 提交错误报告？](https://stackoverflow.com/questions/9234386/how-to-submit-a-bug-report-to-facebook)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T20:29:42.820

转到：[https ://developers.facebook.com/bugs](https://developers.facebook.com/bugs)

在“搜索错误或提交新错误...”字段中，输入错误报告的标题（或者只是几个随机字符，实际上）。

从出现的下拉列表中选择“创建新的错误报告”按钮。

如果这不起作用，请尝试使用其他浏览器。

# asp.net-mvc-3 - 安装 MVC4 后 System.Web.WebPages 出现问题

> ID：12044627
> 
> 赞同：2
> 
> 时间：2012-08-20T20:26:55.893
> 
> 标签：asp.net-mvc-3, asp.net-mvc-4

我已经安装了 MVC4 和我现在拥有的 MVC3 应用程序给我带来了问题。我得到错误：

无法加载文件或程序集“System.Web.WebPages，Version=2.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配

但是，我在我的代码中找不到任何对 WebPages v2 的引用，我想知道为什么会出现此错误。有人可以帮忙吗？

编辑：这是完整的堆栈跟踪：

[FileLoadException：无法加载文件或程序集“System.Web.WebPages，版本=2.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。找到的程序集的清单定义与程序集引用不匹配。（HRESULT 异常：0x80131040）] ljMVC.Helpers.EditableHelpers.Editable（HtmlHelper 助手，字符串 htmlElement，字符串 cssId，字符串 defaultContent，对象 htmlAttributes）在 C:\Users\M\Desktop\Development\ASP.NET 项目\ljMVC\ ljMVC\ljMVC\Helpers\EditableHelpers.cs:90 ASP._Page_Areas_Gameplan_Views_MainGP_Index_cshtml.Execute() 在 e:\web\lovelyjubbl\htdocs\Areas\Gameplan\Views\MainGP\Index.cshtml:85 System.Web.WebPages.WebPageBase.ExecutePageHierarchy () +208 System.Web.Mvc.WebViewPage.ExecutePageHierarchy() +89 System.Web.WebPages.WebPageBase。*DisplayClass1c.b* _19() +23 System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func `1 continuation) +264 System.Web.Mvc.<>c__DisplayClass1e.<InvokeActionResultWithFilters>b__1b() +20 System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult) +176 System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) + 329 System.Web.Mvc.Controller.ExecuteCore() +115 System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) +94 System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) +10 System.Web.Mvc.<>c_ *DisplayClassb.b* _5() +37 System.Web.Mvc.Async.<>c_ *DisplayClass1.b* _0() +21 System.Web.Mvc.Async.<>c_ *DisplayClass8 `1.<BeginSynchronous>b__7(IAsyncResult _) +12 System.Web.Mvc.Async.WrappedAsyncResult`1.End() +55 System.Web.Mvc.<>c* _DisplayClasse。b_*d() +31 System.Web.Mvc.SecurityUtil.b* _0(动作 f) +7 System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(动作动作) +23 System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) + 59 System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult 结果) +9 System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +8970061 System.Web.HttpApplication.ExecuteStep(IExecutionStep步骤，布尔值和完成同步）+184

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:34:43.757

这里：

```
EditableHelpers.cs:90 
```

我猜你正在使用一些 NuGet 或依赖于 WebPages 2.0（又名`System.Web.WebPages, Version=2.0.0.0`）的东西。您可能更新了此 NuGet 或其他任何内容，现在您已依赖此程序集。

# mysql - 通过正则表达式匹配搜索 MySQL 数据库（反向）

> ID：12044628
> 
> 赞同：5
> 
> 时间：2012-08-20T20:27:03.787
> 
> 标签：mysql, regex

如果我有一个数据库表，其中有一列包含正则表达式模式，是否可以返回字符串匹配的行（无需系统地依次测试每一行）？

例如，这样的表：

```
RowID     RegExPattern
1         foo\.$
2         bar\.$
3         baz\.$
4         (foo|bar)\.$ 
```

和这样的输入字符串：

```
foo.php 
```

将返回`RowID`s`1`和`4`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T20:30:56.027

> 如果我有一个数据库表，其中有一列包含正则表达式模式，是否可以返回字符串匹配的行 [...]？

是的，这是可能的。

```
SELECT RowID
FROM yourtable
WHERE 'foo.php' REGEXP RegExPattern 
```

请注意，您的正则表达式将不匹配。如果你省略了，`$`那么他们会。

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/91f663/1)

> （没有系统地依次测试每一行）

呃……不。您需要测试每一行。

# wpf - SurfaceListBox isSelected - System.Windows.Data 错误：4：找不到与引用“RelativeSource FindAncestor”进行绑定的源

> ID：12044632
> 
> 赞同：1
> 
> 时间：2012-08-20T20:27:19.323
> 
> 标签：wpf, pixelsense

我有一个具有以下样式的表面列表框：

```
<s:SurfaceListBox.ItemContainerStyle>
    <Style TargetType="s:SurfaceListBoxItem">
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="FontSize" Value="13" />
        <Setter Property="Foreground" Value="Black" />
        <Setter Property="FontWeight" Value="Normal" />
        <Setter Property="RenderTransformOrigin" Value="0.5,0.5" />
        <Setter Property="MinHeight" Value="30" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type s:SurfaceListBoxItem}">
                    <ContentPresenter />
                </ControlTemplate>
            </Setter.Value>
        </Setter>
        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="HorizontalContentAlignment" Value="Center" />
                <Setter Property="HorizontalAlignment" Value="Center" />
                <Setter Property="FontWeight" Value="Bold"/>
                <Setter Property="Foreground" Value="#FF7E0123" />
                <Setter Property="RenderTransform">
                    <Setter.Value>
                        <ScaleTransform ScaleX="1.25" ScaleY="1.25"/>
                    </Setter.Value>
                </Setter>
            </Trigger>
        </Style.Triggers>
    </Style>
</s:SurfaceListBox.ItemContainerStyle> 
```

我正在通过代码填充这个表面列表框，然后添加一个“显示全部”项：

```
private void AddShowAllCategories(int totalItems)
{
    SurfaceListBoxItem CategoriesListBoxItem = new SurfaceListBoxItem();
    CategoriesListBox.Items.Insert(0, CategoriesListBoxItem);
    CategoriesListBoxItem.Content = "Show All " + "(" + totalItems + ")";
    CategoriesListBoxItem.Margin = new Thickness(0,30,0,0);
    CategoriesListBoxItem.IsSelected = true;  //This is what is causing the issue
} 
```

一切正常，在我通过代码设置`IsSelected`为之前我没有收到任何错误。`true`然后我得到这个错误：

> System.Windows.Data 错误：4：找不到与引用“RelativeSource FindAncestor，AncestorType='System.Windows.Controls.ItemsControl'，AncestorLevel='1''的绑定源。BindingExpression:Path=Horizo​​ntalContentAlignment; 数据项=空；目标元素是'SurfaceListBoxItem'（名称=''）；目标属性是“Horizo​​ntalContentAlignment”（类型“Horizo​​ntalAlignment”）

如果我不通过代码设置`IsSelected`而是`true`单击一个项目，一切都很好。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T05:19:23.623

由于您没有提供使用代码选择项目背后的代码，我不知道您是否正在使用 MVVM、使用后面的代码或您是否已经尝试过以下方法。

我遵循您的方案并设法使用“ItemContainerGenerator”从代码中选择一个项目：

```
 // Selecting an item given the actual item
        object requestedItem = null; // TODO - You should set here the actual item
        SurfaceListBoxItem itemContainer = itemsList.ItemContainerGenerator.ContainerFromItem(requestedItem) as SurfaceListBoxItem;
        itemContainer.IsSelected = true;

        // Selecting an item given his index in the item source
        SurfaceListBoxItem itemContainer2 = itemsList.ItemContainerGenerator.ContainerFromIndex(2) as SurfaceListBoxItem;
        itemContainer2.IsSelected = true; 
```

如果您有对要选择的项目的引用，请使用第一种方法，如果您只知道提供的列表中的索引，请使用第二种方法。

让我知道它是否对您有用。

伊兰。

# php - php 获取所有命令行参数作为关联数组

> ID：12044633
> 
> 赞同：0
> 
> 时间：2012-08-20T20:27:33.393
> 
> 标签：php

是否可以将所有 php 命令行参数作为关联数组以以下格式获取：

```
argument --option1 --option2 argument2 --option1 
```

将输出为

```
'arguments' => array(
    'argument' => array(
        'option1', 'option2'  
     ),
     'argument2' => array(
         'option1'
     )
) 
```

但解决方案应该是通用的

# php - PHP PDO MySQL可滚动游标不起作用

> ID：12044636
> 
> 赞同：4
> 
> 时间：2012-08-20T20:27:45.360
> 
> 标签：php, mysql, pdo, scrollableresults

例如，我有一个包含两个字段的表：id、value。我在这个表中插入了近 100k 行。

我想使用可滚动光标。我写了以下代码：

```
<?php
...
$sql = 'SELECT id FROM cursor_test;';
$stmt = $dbh->prepare($sql, array(PDO::ATTR_CURSOR => PDO::CURSOR_SCROLL));
$stmt->execute();

$row = $stmt->fetch(PDO::FETCH_ASSOC, PDO::FETCH_ORI_ABS, 3);
var_dump($row['id']); // 1, expected value is 3 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T23:21:49.690

似乎 mysql 不支持可滚动游标。

[https://bugs.php.net/bug.php?id=34625](https://bugs.php.net/bug.php?id=34625)

[http://www.php.net/manual/en/pdostatement.fetch.php#105277](http://www.php.net/manual/en/pdostatement.fetch.php#105277)

[PDO laststatment->fetchAll(PDO::FETCH_COLUMN, $column) 是否会在每次调用时重新运行查询？](https://stackoverflow.com/questions/3282310/will-pdo-laststatment-fetchallpdofetch-column-column-rerun-the-query-each)

# visual-studio-2010 - .vcxproj.filters 文件中使用的 UniqueIdentifier 值是什么？

> ID：12044637
> 
> 赞同：10
> 
> 时间：2012-08-20T20:27:46.420
> 
> 标签：visual-studio-2010

我有一个 Visual C++ 10 (VS2010) .vcxproj 项目文件，我想复制它并在与原始项目相同的解决方案文件中使用该副本。

我知道我需要在新的 .vcxproj 文件中生成一个新的 ProjectGuid，但我不知道我需要对 .vcxproj.filters 文件进行哪些编辑。

在 .vcxproj.filters 文件中，我看到有许多具有 GUID 值的 UniqueIdentifier 元素。我假设我需要在新的 .vcxproj.filters 中重新生成所有这些，但 Visual Studio 没有报告任何错误，并且在两个不同的 .vcxproj 中具有相同的 GUID 似乎没有任何问题。过滤同一解决方案文件中的文件。

有谁知道在同一个解决方案文件中的不同 .vcxproj.filters 文件中重复唯一标识符是否安全？有谁知道这些 UniqueIdentifiers 是干什么用的？

是否有一种更简单的方法可以复制 .vcxproj / .vcxproj.filters 对，而无需重新生成 .vcxproj.filters 文件中使用的每个 GUID？

# mysql - 使用来自其他表 MySql 的特定选择更新新表

> ID：12044638
> 
> 赞同：0
> 
> 时间：2012-08-20T20:27:48.667
> 
> 标签：mysql, select, sql-update

这个让我头疼。将客户的旧文章评级从旧数据库移动到新数据库，其中它们之间的唯一引用是第一个单词，在文章标题中用破折号分隔。我可以使用 SELECT 提取我需要的信息，但我不知道如何使用结果来更新新表

需要更新的表

```
UPDATE 
newDB.newtable.rating
SET  newDB.newtable.rating.rating_count = oldvotes 
```

为我提供有关 oldvotes 信息的选择

```
SELECT 
    oldvotes.votes AS oldvotes, old.title AS oldtitle,newtable.news_items.title as newtitle,newtable.news_items.id AS newID
FROM 
    oldDB.news_items AS old
INNER JOIN 
     oldDB.news_items.rating_count AS oldvotes 
ON 
     oldvotes.article_id = old.id
INNER JOIN 
      newDB.newtable.news_items
ON 
      newDB.newtable.news_items.title 
LIKE CONCAT
      (  '%', SUBSTRING_INDEX( old.title,  '- ', 1 ) ,  '%' ) 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:46:33.277

*如果*我理解正确，您在 old.title 中有类似 thisisauniquekey-september-2012 的内容，而在 news_items.title 中有值“thisisauniquekey-somethingelse”。

`oldratings`您可以使用您现在运行的相同查询选择一个键（比标题更快的键）和 oldvotes 到一个临时表中，例如：

```
SELECT news_items.keytobeusedonnewtable AS keyforrating, oldvotes.votes as oldvotes FROM etc. 
```

然后您可以使用以下命令运行更新`oldratings`：

```
UPDATE newDB.newtable.rating SET rating_value = oldvotes FROM
newDB.newtable.rating JOIN oldratings
    ON rating.keyforrating = oldvotes.keyforrating; 
```

# iphone - 通过基于 Web 的布局强制 iphone 和 ipad 进入横向模式

> ID：12044639
> 
> 赞同：0
> 
> 时间：2012-08-20T20:27:52.003
> 
> 标签：iphone, tablet

有没有办法强制 ipad 和 iphone 仅在横向模式下呈现基于 Web 的布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:31:22.613

您无法强制 Safari 停留在特定方向，但您可以检测到它。

`body[orient="landscape"]`或者`body[orient="portrait"]`可以在你的 CSS 中使用来呈现两种不同的布局。如果您选择，其中一个（在这种情况下为纵向）可以显示某种“未针对此布局优化”屏幕。

我想你可以尝试`-webkit-transform: rotate(-90deg)`在页面的正文上做一个，但如果页面滚动，那可能是不可行的。但是，如果您的布局大小正好合适，它可能看起来非常接近正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:37:37.817

您必须防止视图旋转：

```
 -(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
return NO;
} 
```

那么你必须以这种方式启动横向视图，这样可以防止视图旋转。

# ruby-on-rails - 嵌套属性显示“未知属性”，但已声明！（轨道 3.2.4）

> ID：12044643
> 
> 赞同：1
> 
> 时间：2012-08-20T20:27:58.357
> 
> 标签：ruby-on-rails, nested-attributes

我有一个名为***local***的模型，这个模型有很多这样的***门户***：

```
class Portal < ActiveRecord::Base
    belongs_to :local, :class_name => "Local"   
end

class Local < ActiveRecord::Base
    has_many :portales, :class_name => "Portal", :dependent => :destroy
    accepts_nested_attributes_for :portales, :allow_destroy => true
end 
```

问题是当我将参数分配给本地时，控制台显示：

```
NoMethodError Exception: undefined method `portal' for #<Local:0x007f9cd50a7f20> 
```

这是我的控制器和表单：

控制器：

```
def new_portal
    @local = Local.new
    if request.post?
        @local.update_attributes params[:local]
    end
end 
```

形式：

```
<%= form_for @local, :url => {:action => 'new_portal'}, :html => {:id => 'formulario_local', :multipart => true, :method => 'post'} do |f| %>
    <%= f.fields_for :portal do |portal_form| -%>
      <div id="porcentaje_barra">
        <%= portal_form.select 'opacidad_barra', generate_options_from_hash(@porcentaje_opacidad) %>
      </div>
      <div id="texto_barra">
        <%= image_tag 'editor/texto.png', :size => '30x30'%>
        <h5>Texto</h5>
      </div>
      <div id="tipo_de_letra_barra">
        <%= portal_form.select 'tipo_letra_barra', generate_options_from_hash(@tipos_de_letra),:prompt => 'Selecciona' %>
      </div>
      <div id="estilo_fuente_barra">
        <%= portal_form.select 'estilo_letra_barra', generate_options_from_hash(@estilo_de_letra), style: 'width:70px'%>
      </div>
      <div id="tam_fuente_barra">
        <%= portal_form.select 'tamano_letra_barra', generate_options_from_hash(@tamano_de_letra), style: 'width:50px'%>
      </div>
    <% end %>
<% end %> 
```

而且，这是我的变化：

```
ActiveSupport::Inflector.inflections do |inflect|
inflect.irregular 'usuario', 'usuarios'
inflect.irregular 'producto', 'productos'
inflect.irregular 'portal', 'portales'
inflect.irregular 'local', 'locales'
end 
```

我不知道是什么问题，视图显示了所有表单。

感谢您的帮助（对不起我的英语），

乔治 -

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:50:31.573

第一的，

```
<%= f.fields_for :portal do |portal_form| -%> 
```

到

```
<%= f.fields_for :portales do |portal_form| -%> 
```

# jquery - 在 jQuery/AJAX 远程调用之前显示消息

> ID：12044646
> 
> 赞同：0
> 
> 时间：2012-08-20T20:28:01.477
> 
> 标签：jquery, validation

我正在使用 jQuery 验证器来处理初始验证，如果通过，我希望在处理远程调用时在 div 标记中显示“正在验证...”。div 标签的 id 和 name 都是“验证”。

在启动远程测试*之前*，我需要在哪里显示此代码？我希望用户明白这可能需要几秒钟，他们需要等待片刻。

```
$(document).ready(function(){
$.validator.addMethod("noSpecialChars", function(value, element) {
    return this.optional(element) || /^[a-zA-Z0-9-_.]+$/i.test(value);
}, "Ignored");

$('[name=po_number]').focus();

jQuery.validator.messages.required = "";
$("#verifying").text("Msg #1"); // On entry
$("#form1").validate({
    invalidHandler: function(e, validator) {
        $("#verifying").text("Verifying...");
        var errors = validator.numberOfInvalids();

        if (errors) {
            var message = errors == 1
                ? 'PO must contain only letters, numbers, dashed, underscores or periods and must be between 2 and 15 characters long.'
                : 'You missed ' + errors + ' fields.  They have been highlighted below';
            $("div.productError span").html(message);
            $("div.productError").show();
        } else {
            $("div.productError").hide();
        }
    },

    onkeyup: false,
    submitHandler: function(form) {
        $("div.productError").hide();
        // start nested, remote validate
        var HTMLtable = '';
        var po_number = $('[name=po_number]').val().toUpperCase();  // Force PO to uppercase
        $('[name=po_number]').val(po_number);                               // Load upper PO back to web page

        $.ajax({ type: "GET",
            url: "remote_dup_po_check.asp?company="+company+"&customer="+customer+"&po_number="+po_number,
            async: false,
            success : function(results) {
                if (results != 0) {
                    // The remote call to Avante will generate the entire HTML
                    // table that is returned OR 0 if there are no duplicates
                    HTMLtable = results;
                }
            }
        });
        if (HTMLtable != "") {
            var msg = 'PO <b>' + po_number + '</b> has already been used by your account on the following transactiosn:<br>'
            msg = msg + HTMLtable;
            msg = msg + '<br>';
            msg = msg + 'Do you still wish to use this PO?';

            // We need to set the options to correctly drive the prompting
            var options;
            options = { };
            options['pid'] = '0';   // Needed by the returnTrue which is STORED in payment.asp but
            options['sid'] = '0';   // which is CALLED from jquery.modaldialog.js (damn confusing!)
            options['title'] = 'Duplicate PO!';
            options['width'] = '600';
            $.modaldialog.prompt(msg, options);

            // Turn off the faded background and restore to normal.
            // Appears to be needed due to the sub-level of calling?
            $('#dialog-mask').fadeOut("fast");
            verifyMsg = "Msg2";
        } else {
            alert("Unique PO\n\nSubmit disabled for debugging");
            form.submit();      // PO is unique
        }
        // end nested, remote validate
    },

    rules: {
        po_number: {
            required: true,
            noSpecialChars: true,
            rangelength:[2,15]
        }
    },

    messages: {
        po_number: {
            required: 'Please enter a PO #.',
            noSpecialChars: 'The PO must be made of letters digits, underscores, dashes and/or periods (no spaces).',
            rangelength: 'The PO must be between 2 and 15 characters.'
        }
    },
    debug:true  // this lets it hit Firebug
}); 
```

});

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:29:58.623

我错过了什么吗？

在你打电话之前把它放好`$.ajax(....`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:50:39.440

如果我正确理解您的问题，您需要在进行 ajax 调用时显示“正在验证...”。并且只有在本地验证通过后才会进行 ajax 调用。

这将要求您在 jquery 表单验证完成***后***使用“正在验证...”文本更新 div 。这意味着您可能希望在 submitHandler 中执行此操作，而不是在 invalidHandler 中显示消息。

所以你的 submitHandler 可能看起来像：

```
$("div.productError").hide();
var po_number = $('[name=po_number]').val().toUpperCase();  // Force PO to uppercase
$('[name=po_number]').val(po_number);

$("#verifying").text("Verifying...");

$.ajax({ type: "GET",
        url: "remote_dup_po_check.asp?company="+company+"&customer="+customer+"&po_number="+po_number,
        async: false,
        success : function(results) {
            if (results != 0) {
                // The remote call to Avante will generate the entire HTML
                // table that is returned OR 0 if there are no duplicates
                var HTMLtable = results;
                if (HTMLtable != "") {
                    var msg = .......
                    //Do something with result
                }

            }
        }
}); 
```

此外，您可能只使用 asynch 调用而不是使其成为可能会停止其余脚本执行的同步调用。

**更新：显示同步调用的动画**

如果你使用 jQuery animate，代码会一直执行到动画完成，所以这里有一个适合我的解决方法：

```
$("#verifying").text("Verifying...");

$('#verifying').animate({
    opacity: 1
  }, 500, function() {
        //animation complete, call ajax here
        $.ajax({ 
            type: "GET",
            url: "remote_dup_po_check.asp?company="+company+"&customer="+customer+"&po_number="+po_number,
            async: false,
            success : function(results) {
            if (results != 0) {
                // The remote call to Avante will generate the entire HTML
                // table that is returned OR 0 if there are no duplicates
                var HTMLtable = results;
                if (HTMLtable != "") {
                    var msg = .......
                    //Do something with result
                }

                }
            }
        });
  }); 
```

# .net - AppDomain 地址空间

> ID：12044648
> 
> 赞同：16
> 
> 时间：2012-08-20T20:28:18.993
> 
> 标签：.net, memory, pointers, appdomain, address-space

首先，问题是：CLR 规范是否保证在同一进程内的多个应用程序域中执行的代码将共享相同的地址空间？通过“共享地址空间”，我的意思是指向在某个应用程序域中分配的内存的指针对于在同一进程内托管的所有应用程序域进行读写都是有效的。

考虑这个说明问题的独立示例：程序`Worker`在单独的应用程序域中分配一个对象。为 10,000个`Worker`整数分配一个内存块，并用数据填充它。然后程序跨应用程序域边界调用以获取指向已分配块的指针，并验证它是否可以读取 10,000 项中的每一项。

```
using System;
using System.Reflection;
using System.Runtime.InteropServices;

namespace crossapp {
    public class Worker : MarshalByRefObject {
        private readonly IntPtr myData;
        public const int DataLength = 10000;
        public Worker() {
            Console.Error.WriteLine(
                "Memory allocation happens in app domain '{0}'"
            ,   Assembly.GetExecutingAssembly().FullName
            );
            myData = Marshal.AllocHGlobal(sizeof(int) * DataLength);
            unsafe {
                var ptr = (int*) myData.ToPointer();
                for (var i = 0 ; i != DataLength ; i++) {
                    ptr[i] = 2*i + 1;
                }
            }
        }
        public IntPtr GetData() {
            return myData;
        }
    }
    class Program {
        static void Main() {
            var ad = AppDomain.CreateDomain("New domain");
            var wrk = (Worker)ad.CreateInstanceAndUnwrap(
                Assembly.GetExecutingAssembly().FullName
            ,   "crossapp.Worker"
            );
            var data = wrk.GetData();
            var badCount = 0;
            unsafe {
                var ptr = (int*)data.ToPointer();
                for (var i = 0 ; i != Worker.DataLength ; i++) {
                    var expect = 2*i + 1;
                    if (ptr[i] != expect) {
                        Console.Error.WriteLine(
                            "Mismatch in position {0}: {1} != {2}"
                        ,   i, expect, ptr[i]
                        );
                        badCount++;
                    }
                }
                if (badCount == 0) {
                    Console.Error.WriteLine(
                        "All {0} items have matched."
                    ,   Worker.DataLength
                    );
                } else {
                    Console.Error.WriteLine(
                        "Found {0} mismatches out of {1}."
                    ,   badCount
                    ,   Worker.DataLength
                    );
                }
            }
        }
    }
} 
```

我跑了很多次，每次都有效。直觉上它应该可以工作：毕竟，应用程序域在一个进程中，所以它们必须共享相同的虚拟地址空间。但是，这感觉就像是在利用 Microsoft 可能随时取消的功能。CLR 的规范中是否有某些内容确认或否认此技巧的合法性？

* * *

如果您想知道我为什么要问这样一个奇怪的问题，我正在寻找一种跨应用程序域边界传递大量（以千兆字节为单位）数据的方法，同时在空间和时间上都具有最小的开销。如果我能证明它的合法性，这将是我理想的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-14T13:58:40.293

看看：[任何人都可以解释 MarshalByRefObject 的主要用途](https://stackoverflow.com/questions/4295894/anyone-can-explain-the-major-use-of-marshalbyrefobject)。在您的场景中，您只传递了一个代理而不是实际的对象，并且没有复制内存。

编辑：

1.  “合法性”！=“技巧”，您的黑客通过不编组对另一个 AppDomain 中的数据的调用来破坏 AppDomains。运行时容器可能会设置/更改可能会破坏您的应用程序的安全限制，例如它是否在 IIS 中运行？（在您的情况下，您访问的不是对象而是内存，因此它可能“还不错”。）这是您在客户站点上部署的产品吗？
2.  我认为通过代理进行封送处理存在性能问题，因此您求助于 IntPtr（去掉中间人）
3.  各种“工人”AppDomain 是否在操纵 blob？如果是这样，我会担心最终内存会被破坏......因为你没有编组你的电话。
4.  这是在 C# 中创建的非托管内存。如果实际上，blob 是由非托管 DLL 分配的，那么您必须确保未卸载非托管 DLL。同样，如果要部署到 IIS，那么您无法控制 AppDomain 的生命周期，而 IIS 可以。这将打破你的黑客。
5.  是的，虚拟内存是每个进程而不是每个 AppDomain，因此所有 AppDomain 共享相同的虚拟地址空间。
6.  不管我有什么保留，这很酷:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-20T20:47:38.000

我没有直接的答案给你。MarshalByRefObject 的存在可能表明使用了公共地址空间，但可能没有。

您还可以查看[内存映射文件](http://weblogs.asp.net/gunnarpeipman/archive/2009/06/21/net-framework-4-0-using-memory-mapped-files.aspx)

# mysql - Mysql - GPS 位置 x 3 以及如何从搜索中排除任何位置结果

> ID：12044649
> 
> 赞同：0
> 
> 时间：2012-08-20T20:28:21.100
> 
> 标签：mysql, math, gps

所以我已经在这个问题上工作了几天。目的是根据用户当前位置 (A Lat/Lon) 生成数据的半径搜索。我想如何通过计算 B Lat/Lon 和 B Lat/Lon（我可以做到）为搜索添加一些智能，然后从半径搜索中删除该三角形内的任何匹配 GPS 点....

我设法达到的最接近的是将B匹配到C，但不匹配到A的点...

这是部分数学和部分 MySQL，因为这是我想用来实现它的最终方法。

有什么想法吗 ？

人族

![主图](../Images/ebe35da5f6d4c94b7bb7941e91e32c0f.png)

![最终结果](../Images/c18b9ff2e31415c5624c4c8d522893c7.png)

从别处

问：如果要返回结果的唯一半径是 A，为什么 B 和 C 周围有半径？A这只是为了显示每个点的纬度...我添加了一个附加图表来显示如何使用它。

问：B 和 C 实际代表什么（A 是当前位置） A：B 和 C 将是根据用户当前位置、方位和速度计算出的位置（通过数学）。

“测试一个点是否在三角形中很容易——想想三角形边向量和从三角形角到测试点的向量的叉积。内部点在所有三个边内。”

链接 - 三角形内部计算 - [http://www.mathworks.com/matlabcentral/fileexchange/22690-inside-triangle/content/inside_triangle.m](http://www.mathworks.com/matlabcentral/fileexchange/22690-inside-triangle/content/inside_triangle.m)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T22:27:04.163

这个过程有几个步骤。

找到圆的边界框内的点。如果在经度维度上稍微草率，这可以很好地有效地工作，

```
 SELECT *
     FROM points p
    WHERE p.lat >= alat-radius
      AND p.lat <= alat+radius
      AND p.lon >= alon-radius
      AND p.lon <= alon+radius 
```

接下来，排除三角形内的点。您需要编写一个存储函数来执行三角形包含来处理此问题。

```
 SELECT *
     FROM points p
    WHERE p.lat >= alat-radius
      AND p.lat <= alat+radius
      AND p.lon >= alon-radius
      AND p.lon <= alon+radius
      AND NOT Inside_Triangle(p.lat, p.lon, alat, alon, blat, blon, clat, clon) 
```

您可以在此处查找进行三角形包含的算法。 [如何确定二维点是否在多边形内？](https://stackoverflow.com/questions/217578/point-in-polygon-aka-hit-test)

最后，排除半径外的点。

```
 SELECT *
     FROM points p
    WHERE p.lat >= alat-radius
      AND p.lat <= alat+radius
      AND p.lon >= alon-radius
      AND p.lon <= alon+radius
      AND NOT Inside_Triangle(p.lat, p.lon, alat, alon, blat, blon, clat, clon)
      AND Haversine(p.lat,p.lon,alat,alon) > radius 
```

这是 Haversine 函数的示例。请注意，您必须仔细整理半径单位。 [为什么这个 MySQL 存储函数给出的结果与在查询中进行计算不同？](https://stackoverflow.com/questions/6389859/why-does-this-mysql-stored-function-give-different-results-than-to-doing-the-cal)

你有它。如何获得包含所需点的结果集。

# android - Android NDK memcpy 崩溃并在 libc.so 中使用 proguard 中断回溯

> ID：12044650
> 
> 赞同：3
> 
> 时间：2012-08-20T20:28:29.883
> 
> 标签：android, android-ndk, gdb, proguard, kindle-fire

在解决 Android 2.3.4 附带的 Amazon Kindle Fire 问题时遇到一些困难，崩溃是 SIGSERV 并且并不总是重现。

该应用程序本身是一个原生游戏，并会在几个点崩溃。很难通过日志语句确定究竟是什么导致了崩溃。我已经能够在保存游戏中捕获游戏状态，以继续恢复和运行一个麻烦的部分。

该问题只会在启用 Proguard 时重现，我尝试了 Proguard 的各种配置以禁用各种功能。proguard中使用了以下内容，对问题没有影响：

```
-keepclasseswithmembers class *{
  native <methods>;
}

-keepclasseswithmembers class * { 
  *** *Callback(...);
}

-dontshrink
-dontoptimize
-dontpreverify
-keep class javax.** { *; }
-keep class java.** { *; }
-keep class org.** { *; }
-keep class android.** { *; }
-keep class com.** { *; } 
```

添加 -dontobfuscate 似乎可以解决问题，但是由于效果的随机性，我无法 100% 确认。

堆栈跟踪如下：

```
I/DEBUG   (23231): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
I/DEBUG   (23231): Build fingerprint: 'generic/blaze/blaze:2.3.4  GINGERBREAD/6.3.1_user_4107720:user/release-keys'
I/DEBUG   (23231): pid: 23238, tid: 23409  >>> mypackage <<<
I/DEBUG   (23231): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 00000000
I/DEBUG   (23231):  r0 00000000  r1 0045ae68  r2 00000fc0  r3 006f003b
I/DEBUG   (23231):  r4 003b0059  r5 00040013  r6 fff60000  r7 0004fff5
I/DEBUG   (23231):  r8 00080009  r9 0046d350  10 00100000  fp 00000001
I/DEBUG   (23231):  ip 00120008  sp 48c2ee24  lr 00070013  pc afd0cfe0  cpsr 20000110
I/DEBUG   (23231):  d0  0000001900000110  d1  be94da8200000000
I/DEBUG   (23231):  d2  bfd180bc00000000  d3  3feec709dc3a0300
I/DEBUG   (23231):  d4  be86935e00000000  d5  bfd5a7f8c70233a6
I/DEBUG   (23231):  d6  458000009eb93fdb  d7  00000b9a00000b9a
I/DEBUG   (23231):  d8  00000000103a3c9d  d9  0000000000000000
I/DEBUG   (23231):  d10 0000000000000000  d11 0000000000000000
I/DEBUG   (23231):  d12 0000000000000000  d13 0000000000000000
I/DEBUG   (23231):  d14 0000000000000000  d15 0000000000000000
I/DEBUG   (23231):  d16 3fe7356a68b6af7e  d17 3ff0000000000000
I/DEBUG   (23231):  d18 be607fc1c458778e  d19 bfa7cc5f02a59422
I/DEBUG   (23231):  d20 4000000000000000  d21 3f114aff86ff44bc
I/DEBUG   (23231):  d22 bebbaaeb53350f0d  d23 bfd48eb6ede7d000
I/DEBUG   (23231):  d24 3e66376972bea4d0  d25 3fd193d7807f5e77
I/DEBUG   (23231):  d26 3ff4000000000000  d27 bfa7cc5f02a59424
I/DEBUG   (23231):  d28 c002b4ff18e04675  d29 bfd48eb70ee75389
I/DEBUG   (23231):  d30 3c6ad5a68fb54afb  d31 be607fc1c4800000
I/DEBUG   (23231):  scr 80000012
I/DEBUG   (23231): 
I/DEBUG   (23231):          #00  pc 0000cfe0  /system/lib/libc.so
I/DEBUG   (23231):          #01  lr 00070013  <unknown>
I/DEBUG   (23231): 
I/DEBUG   (23231): code around pc:
I/DEBUG   (23231): afd0cfc0 24c04001 24c05001 e2522020 ba000005 
I/DEBUG   (23231): afd0cfd0 f5d1f060 f5d1f080 e8b151f8 e2522020 
I/DEBUG   (23231): afd0cfe0 e8a051f8 aafffffa e2922020 0a00000c 
I/DEBUG   (23231): afd0cff0 e1b0ce02 28b10078 48b10180 28a00078 
I/DEBUG   (23231): afd0d000 48a00180 e1b0cf02 24913004 40d140b2 
I/DEBUG   (23231): 
I/DEBUG   (23231): code around lr:
I/DEBUG   (23231): 0006fff0 00000000 00000000 00000000 00000000 
I/DEBUG   (23231): 00070000 00000000 00000000 00000000 00000000 
I/DEBUG   (23231): 00070010 00000000 00000000 00000000 00000000 
I/DEBUG   (23231): 00070020 00000000 00000000 00000000 00000000 
I/DEBUG   (23231): 00070030 00000000 00000000 00000000 00000000 
I/DEBUG   (23231): 
I/DEBUG   (23231): stack:
I/DEBUG   (23231):     48c2ede4  00000000  
I/DEBUG   (23231):     48c2ede8  00000000  
I/DEBUG   (23231):     48c2edec  00000000  
I/DEBUG   (23231):     48c2edf0  00000000  
I/DEBUG   (23231):     48c2edf4  00000000  
I/DEBUG   (23231):     48c2edf8  00000000  
I/DEBUG   (23231):     48c2edfc  00000000  
I/DEBUG   (23231):     48c2ee00  00000000  
I/DEBUG   (23231):     48c2ee04  00000000  
I/DEBUG   (23231):     48c2ee08  00000000  
I/DEBUG   (23231):     48c2ee0c  00000000  
I/DEBUG   (23231):     48c2ee10  002275c4  
I/DEBUG   (23231):     48c2ee14  00000001  
I/DEBUG   (23231):     48c2ee18  df002777  
I/DEBUG   (23231):     48c2ee1c  e3a070ad  
I/DEBUG   (23231):     48c2ee20  48c2ee5c  
I/DEBUG   (23231): #00 48c2ee24  002275a0  
I/DEBUG   (23231):     48c2ee28  00001000  
I/DEBUG   (23231):     48c2ee2c  48c2ee5c  
I/DEBUG   (23231):     48c2ee30  00001000  
I/DEBUG   (23231):     48c2ee34  a811cda9  /system/lib/libutils.so
I/DEBUG   (23231):     48c2ee38  00000000  
I/DEBUG   (23231):     48c2ee3c  81004f45  /system/lib/libOpenSLES.so
I/DEBUG   (23231):     48c2ee40  00000000  
I/DEBUG   (23231):     48c2ee44  002275a0  
I/DEBUG   (23231):     48c2ee48  00227eb8  
I/DEBUG   (23231):     48c2ee4c  00000800  
I/DEBUG   (23231):     48c2ee50  48c2ee5c  
I/DEBUG   (23231):     48c2ee54  a903181b  /system/lib/libmedia.so
I/DEBUG   (23231):     48c2ee58  00000000  
I/DEBUG   (23231):     48c2ee5c  00000000  
I/DEBUG   (23231):     48c2ee60  00000001  
I/DEBUG   (23231):     48c2ee64  00000001  
I/DEBUG   (23231):     48c2ee68  00000800 
```

为了获取调试信息，我将 proguard 启用到调试模式并启用调试符号并运行 gdb。当崩溃发生时，通过 gdb，回溯被丢弃，因为帧上的返回指针已被覆盖。

使用 addr2line，内存引用显示它在 memcpy 中崩溃了。使用 gdb 进行一些挖掘表明它是 memcpy 的第一个参数被传递了一个 NULL 指针。

已经尝试了很多方法来试图找到这个问题的根源，甚至尝试用我自己定制的函数替换 memcpy 函数来解决这个问题。但是，在 ARM 指针数学下的重定向遇到了一些问题。

堆栈上的返回指针，而不是 lr 寄存器似乎指向 JITed 代码。这不是我的本机代码调用 memcpy。

在手动检查堆栈时，似乎没有任何东西指向我的任何本机代码。

有关获取更多有用信息以查明问题甚至使用 memcpy 执行替换功能的任何建议？或者从本机崩溃中获取有用的 dalvik 堆栈跟踪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-22T15:19:11.777

我有同样的问题。在 Android 3.x 上工作得很好，然后在 Android 4 上发生了同样的事情。只要你想使用 memcpy，就使用 memmove。

# firefox - 获取 HTTP 请求的内容类型

> ID：12044657
> 
> 赞同：1
> 
> 时间：2012-08-20T20:29:19.217
> 
> 标签：firefox, firefox-addon, firefox-addon-sdk

我正在 Addon SDK (V1.9) 上开发一个 Firefox 扩展。

**客观的**

我需要在加载之前检查特定内容类型的 HTTP 请求（在发送请求之前）。

**问题**

通过“观察者服务”模块添加观察者时，我使用“http-on-modify-request”来检查所有 HTTP 请求。这提供了标题。但是，在检查内容类型时，它永远不会根据请求设置。

内容类型确实是在响应中设置的，我使用“http-on-examine-response”进行检查。但这意味着请求已经加载，违背了我扩展的目的。

**编辑**

@Wladimir *Palant*感谢您指出在发送请求标头时未设置内容类型。

我正在尝试在一堆与​​我相关的正则表达式上测试 HTTP 请求的 url 并阻止它们。但是，我希望能够跳过某些内容类型（例如图像），因为它们与我的应用程序无关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T19:09:34.827

所以，总结一下这个问题。完全控制加载到浏览器中的资源的最佳方法似乎是使用[nsIContentPolicy](https://developer.mozilla.org/en-US/docs/XPCOM_Interface_Reference/nsIContentPolicy)。

@WladimirPalant[在这里](https://stackoverflow.com/questions/10788489/an-example-of-nsicontentpolicy-for-firefox-addon)写了一个很好的例子。这就是他的代码适应 Addon SDK (v1.9) 的样子：

```
const { Cc, Ci, Cu, Cm, components } = require('chrome');
const { XPCOMUtils } = Cu.import("resource://gre/modules/XPCOMUtils.jsm");

let policy =
{
    classDescription: "Test content policy",
    classID: components.ID("{12345678-1234-1234-1234-123456789abc}"),
    contractID: "@adblockplus.org/test-policy;1",
    xpcom_categories: ["content-policy"],

    init: function()
    {
        let registrar = Cm.QueryInterface(Ci.nsIComponentRegistrar);
        registrar.registerFactory(this.classID, this.classDescription, this.contractID, this);

        let catMan = Cc["@mozilla.org/categorymanager;1"].getService(Ci.nsICategoryManager);
        for each (let category in this.xpcom_categories)
            catMan.addCategoryEntry(category, this.contractID, this.contractID, false, true);
},

    // nsIContentPolicy interface implementation
    shouldLoad: function(contentType, contentLocation, requestOrigin, node, mimeTypeGuess, extra)
    {
        dump("shouldLoad: " + contentType + " " +
                      (contentLocation ? contentLocation.spec : "null") + " " +
                      (requestOrigin ? requestOrigin.spec : "null") + " " +
                      node + " " +
                      mimeTypeGuess + "\n");
        return Ci.nsIContentPolicy.ACCEPT;
    },

    shouldProcess: function(contentType, contentLocation, requestOrigin, node, mimeTypeGuess, extra)
    {
        dump("shouldProcess: " + contentType + " " +
                        (contentLocation ? contentLocation.spec : "null") + " " +
                        (requestOrigin ? requestOrigin.spec : "null") + " " +
                        node + " " +
                        mimeTypeGuess + "\n");
        return Ci.nsIContentPolicy.ACCEPT;
    },

    // nsIFactory interface implementation
    createInstance: function(outer, iid)
    {
        if (outer)
            throw Cr.NS_ERROR_NO_AGGREGATION;
        return this.QueryInterface(iid);
    },

    // nsISupports interface implementation
    QueryInterface: XPCOMUtils.generateQI([Ci.nsIContentPolicy, Ci.nsIFactory])
};

policy.init(); 
```

# ios - 没有为应用程序“MyApp”找到有效的“aps-environment”权利字符串：（null）。不会发送通知

> ID：12044658
> 
> 赞同：3
> 
> 时间：2012-08-20T20:29:23.070
> 
> 标签：ios, xcode, ios-provisioning, rubymotion

我已经在 Provisioning Portal 中设置了我的应用程序并为 APS 启用了它。

我为应用程序设置了两个配置文件，都特定于这个 App ID。

我正在使用我公司的分发证书和临时配置文件构建我的应用程序。

我已经刷新并重新下载了配置文件。

当我在我的设备上运行我的应用程序时，我仍然收到此错误（查看设备的日志）

```
No valid 'aps-environment' entitlement string found for application 'MyApp': (null). Notifications will not be delivered. 
```

任何人都可以建议我可能错过的内容或帮助我解决这个问题吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T18:41:12.083

这个问题是由于我没有正确配置 Rubymotion 的 Rakefile

查看[此线程](https://twitter.com/gavin_morrice/status/237980675049922561)以获取更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T15:21:37.697

我不确定您是否按顺序执行了上述步骤，但是对于 APN 在开发环境（分布式 AdHoc）中工作（至少获得一个令牌）至关重要的是您在之后创建新的 AdHoc 分发配置文件（并使用它，当然）您确实为开发包 ID 设置了 APN。

在我这样做之后（好的，并从 XCode 中删除旧的 AdHoc 配置文件，然后重新启动 XCode，只是为了运气:)）它就像一个魅力。

希望这会对某人有所帮助。

执行于： - XCode 4.6、Mac OS X 10.8.2 - iPad 3、iOS 5.1.1

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-08-20T20:57:06.467

我遇到了这个问题，我必须**重建我的项目**才能让它工作，即开始一个新项目并复制你的文件。我认为有人说这可能是您的项目中包含的图像部分损坏的问题，或者项目文件本身已部分损坏。

# javascript - webViewDidFinishLoad 自调用？

> ID：12044659
> 
> 赞同：0
> 
> 时间：2012-08-20T20:29:36.420
> 
> 标签：javascript, iphone, html, ios, uiwebview

我正在开发一个 iPhone 应用程序。这是我第一次使用 XCode 和 Objective-C，尽管我有很多 PHP、JS 和 Java 经验。我现在遇到了一个问题。

我在`webViewDidFinishLoad`调用函数时将 JavaScript 注入 UIWebView。该 JavaScript 包括将 iFrame 注入正文，这就是我的问题所在。似乎注入的 iFrame 再次调用了该`webViewDidFinishLoad`函数，从而导致了无限循环。

这是个常见的问题吗？谢谢你！雅克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T16:47:58.083

我建议您更改您的 javascript 注入代码 - 为您的 iframe 分配一个 id，然后在将其注入页面之前，检查以确保该 id 不存在。这样，即使`webViewDidFinishLoad`被调用了两次，帧也只会在第一次被注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:38:38.140

hacky 方法是在你的类中添加一个 BOOL 来检查它是否是 webview 的第一次加载完成。

另一种可能性是在第一次加载完成后将 Web 视图委托设置为 nil。

# php - CakePHP 上传插件：不作为附件上传

> ID：12044660
> 
> 赞同：5
> 
> 时间：2012-08-20T20:29:41.400
> 
> 标签：php, cakephp, upload

我正在使用（或尝试）来自 Jose Gonzalez 的上传插件：[https](https://github.com/josegonzalez/upload) ://github.com/josegonzalez/upload ，我想将我的图像记录存储在一个单独的表中。我遵循了 github 上的自述文件，但它没有指出如何在添加/编辑视图和控制器中启用此功能。这是我到目前为止所做的：

应用程序/模型/Image.php：

```
class Image extends AppModel {

    public $actsAs = array(
      'Upload.Upload' => array(
        'image' => array(
          'thumbnailSizes' => array('thumb' => '20x20')
        ),
      ),
    );

    public $belongsTo = array(
      'Profession' => array(
        'className' => 'Profession',
        'foreignKey' => 'foreign_key'
      )
    );

} 
```

应用程序/模型/专业.php：

```
class Profession extends AppModel {

    public $hasMany = array(
      'Image' => array(
        'className' => 'Image',
        'foreignKey' => 'foreign_key',
        'conditions' => array(
          'Image.model' => 'Profession'
        )
      )
    );

} 
```

app/View/Professions/add.php（相关部分）：

```
$this->Form->input('Image.image', array('type' => 'file', 'label' => '')); 
```

应用程序/控制器/ProfessionsController.php：

```
public function add() {
  if ($this->request->is('post')) {
    if ($this->Profession->saveAll($this->request->data)) {
      $this->redirect(array('action' => 'index'));
    } else {
      $this->Session->setFlash(__('Error'));
    }
  }
} 
```

文件没有上传，我`images`表中的记录如下：

```
id | model | foreign_key | name     | image | dir  | type      | size | active
---+-------+-------------+----------+-------+------+-----------+------+--------
 1 |       |           1 | test.png |       | NULL | image/png |  814 |      1 
```

模型、图像和目录不应为空/null。

-function的调试输出`debug($this->request->data)`是`add()`：

```
array(
    'Profession' => array(
        [...]
    ),
    'Image' => array(
        'image' => array(
            'name' => 'test.png',
            'type' => 'image/png',
            'tmp_name' => '/Applications/MAMP/tmp/php/phpTMHMF9',
            'error' => (int) 0,
            'size' => (int) 1473
        )
    )
) 
```

问题是，正如我上面所说，上传不起作用并且图像记录不完整。我希望这是可以理解的，我真的不想将图像信息存储在与模型相同的表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:26:32.430

请原谅我迟到的答案，但我遇到了同样的问题，我花了一段时间（大约 4 小时）才弄清楚，所以这是我的解决方案，以供将来参考。

在我的例子中，上传（附件）模型类看起来像这样（app\Model\Upload.php）

```
class Upload extends AppModel {
    public $actsAs = array(
        'Upload.Upload' => array('upload')
    );

    public $belongsTo = array(
        'Product' => array(
            'className' => 'Product',
            'foreignKey' => 'foreign_key'
        )
    );
} 
```

我的产品看起来像这样（app\Model\Product.php）

```
class Product extends AppModel {
    public $hasMany = array(
        'Image' => array(
            'className' => 'Upload',
            'foreignKey' => 'foreign_key',
            'conditions' => array(
                'Image.model' => 'Product'
            )
        )
    );

    // rest of the code
} 
```

我的数据库方案：

```
id | model | foreign_key | name     | upload | dir  | type       | size | active
---+-------+-------------+----------+--------+------+------------+------+--------
 1 |       |           1 | test.jpg |        | NULL | image/jpeg | 5820 |      1 
```

现在 2 解决方案在产品的添加视图中 (appView\Products\add.ctp)

```
echo $this->Form->create('Product', array('type' => 'file'));
echo $this->Form->input('name');
echo $this->Form->input('Image.upload.upload', array('type' => 'file'));
echo $this->Form->input('Image.upload.model', array('type' => 'hidden', 'value' => 'Product'));
echo $this->Form->end('Save Product'); 
```

您需要通过向表单添加隐藏字段来手动添加模型，并且您需要将数据库字段添加到文件字段。在您的情况下，它将变为：

```
this->Form->input('Image.image.image', array('type' => 'file', 'label' => '')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-10T00:17:12.243

试试这个：

看法

echo $this->Form>input('Attachment.1.model',array('type'=>'hidden','value'=>'Sludge'));

那现在对我有用。

# wpf - WPF ComboBox中的DataTextField和DataValueField？

> ID：12044663
> 
> 赞同：2
> 
> 时间：2012-08-20T20:29:47.043
> 
> 标签：wpf, visual-studio-2010, vb.net-2010

有什么方法可以让我们在 WPF ComboBox 中拥有像 DataTextField 和 DataValueField 这样的功能。

我有这个查询：

```
 Select UID, EmployeeName from tblSystemEmployee; 
```

我想在组合框中显示 EmployeeName，但它一直显示 UID。有什么办法可以实现吗？感谢您的帮助？

这就是我填充数据集的方式：

```
 Try
        cbEmp.Items.Clear()
        Dim QueryString As String = "SELECT UID, EmployeeName FROM tblSystemEmployee"
        Dim drow As DataRow
        drow = Nothing
        dsEmp = New DataSet

        dsEmp = GetResult(QueryString, True)
        If IsValidDataset(dsEmp) Then
            For Each drow In dsEmp.Tables(0).Rows
                cbEmp.Items.Add(drow(0).ToString())

            Next
        End If 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:34:40.753

您需要`DisplayMemberPath`显示的`SelectedValuePath`属性和值的属性

```
<Combobox DisplayMemberPath="EmployeeName" SelectedValuePath="UID" /> 
```

然后，您可以使用该属性访问整个选定对象（例如 UID、EmployeeName 对），`SelectedItem`但如果您只想要 UID，那么该`SelectedValue`属性就是您所需要的。

您可以在 MSDN 了解有关属性工作原理的更多信息：

*   [显示成员路径](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.displaymemberpath.aspx)
*   [选定值路径](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selectedvaluepath.aspx)

要使用值填充 ComboBox，您需要使用列表设置[ItemsSource](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.itemssource.aspx)属性：

而不是`cbEmp.Items.Clear()`使用`cbEmp.ItemsSource = Nothing`和

和

```
If IsValidDataset(dsEmp) Then
        cbEmp.ItemsSource = dsEmp.Tables(0).DefaultView
End If 
```

一篇关于[WPF 数据绑定和组合框](http://www.codeproject.com/Articles/20439/WPF-DataBinding)的好介绍文章。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:35:20.527

您正在寻找的属性是：[`DispalyMemberPath`](http://msdn.microsoft.com/en-us/library/system.windows.controls.itemscontrol.displaymemberpath.aspx)和[`SelectedValuePath`](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selectedvaluepath.aspx)。

# django - 编写 django 自定义后端

> ID：12044664
> 
> 赞同：0
> 
> 时间：2012-08-20T20:29:56.870
> 
> 标签：django, backend, custom-backend

我想为我的网站的搜索功能编写 django 自定义后端（使用 mysql 匹配查询/全文搜索），那么我应该在哪里写呢？我应该在一个新的单独应用程序的模型中编写它。? 或者我应该把它写在一些现有的应用程序中。还是应该将其写入某些现有应用程序的模型中？

我在 django 方面没有太多经验，以前从未写过任何后端。我知道无论如何都可以做到，但我想知道推荐的方式。我认为它也可以在其他项目或应用程序中使用。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T22:34:40.860

只需将其放入需要中间件的应用程序中即可。或者创建一个包含所有中间件的 django 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:32:06.137

您的后端是普通的 Python 代码，就像其他 Python 模块一样，这些文件可以存在于任何地方。只要您能够使用 Python shell 导入它，django 就可以使用它。

换句话说，只要它在 中`PYTHONPATH`，那么您的应用程序就可以使用它。

它不需要是应用程序或项目的一部分。

# c++ - C++编译器用作模板参数时不区分类型和函数名

> ID：12044667
> 
> 赞同：1
> 
> 时间：2012-08-20T20:30:03.610
> 
> 标签：c++, parsing, types

`g++`我已经用和尝试了以下代码`clang++`。`foo`两者都无法`foo`区分`foo`. 为什么会这样？C++ 标准是否规定了这一点？编译器不应该至少尝试两者吗？

```
enum foo {
    FOO = 0,
    BAR,
    BAZ
};

class Bar {
    public:

    foo foo () const
    {
        // does not compile if I write static_cast<foo>(...)
        return static_cast< ::foo>(m_bar);
    }

    int m_bar;
};

int main ()
{
    Bar bar;
    bar.m_bar = 0;
    foo foo_bar = bar.foo(); 
    return 0;
} 
```

我可以用 替换`::foo`，`enum foo`它会编译得很好。但是，如果我更改`enum foo {...}`为`typedef enum _foo {...} foo`，同样的问题仍然存在（[http://ideone.com/d1GiO](http://ideone.com/d1GiO)）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T22:31:01.260

在 C 和 C++ 中（这是继承的）有两个单独的标识符空间：一个用于通用符号，包括变量、函数……另一个用于用户定义的类型（枚举、结构）。表达式为通用标识符空间内的`typedef`用户定义类型创建别名。

因为标识符空间是分开的，所以即使在相同的上下文中，该语言也允许您定义同名的函数和类型：

```
enum foo { no, yes };
void foo() {} 
```

在 C 中，您被迫明确限定用户定义类型空间中的标识符，因此在前面的示例中，要使用`foo`您必须执行的类型`enum foo`：

```
void foo( enum foo ) {} 
```

现在， a`typedef`在全局标识符空间中创建了一个别名，因此通过使用 typedef，您无需限定即可逃脱：

```
typedef enum bar { no, yes } bar;
void foo( bar ) {}                     // uses the typedef 
```

^(及时向 C++ [*])前进，两个标识符空间仍然在语言中，改变的是查找规则。在全局标识符空间中查找标识符时（即没有前面的`enum`,`struct`或`class`关键字，并且在允许非类型的上下文中），编译器将从最内层范围开始查找到外部范围，并针对每个范围它将首先在全局标识符空间中查找，如果在那里没有找到，那么它还将查找用户定义的类型。这就是使`enum`,`struct`或`class`可选的原因。在*大多数情况下*，就是这样。

在您的特定情况下，您正在做一些可以使结果令人惊讶的事情。首先，您有一个声明，它使用相同的标识符来引用两个不同的事物。这很好，因为在到达函数名称之前，唯一调用的实体`foo`是`enum`：

```
foo         // No need for 'enum', at this point function 'foo' is not declared
foo();      // No collision, this is 'foo' in global id space, not 'enum foo' 
```

现在，在里面`Bar::foo`，如果你单独使用`foo`它，它将开始在函数的范围内查找，在那里它不会找到任何东西。然后它将移动到`Bar`类范围，在那里它会看到有一个`foo`函数并且查找将在那里停止。请注意，无论您是否具有枚举器的 typedef 都没有区别，因为查找在离开`Bar`类之前停止，因此在可能在命名空间级别找到任一标识符之前停止。

正如您所指出的，如果您添加`enum`关键字，那么您会突然更改规则。您现在正在寻找*用户定义类型*，搜索将遵循相同的范围，但只会在标识符空间中查找用户定义类型。所以它会在没有的地方离开`Bar::foo`，进入，所以它会继续向外，直到找到命名空间级别的枚举。`Bar``enum foo`

如果您提供命名空间限定，则会发生同样的事情：在全局命名空间级别`foo`开始之前`::`需要查找。在该级别中，唯一`foo`定义的是用户定义类型`enum foo`。请注意，这与添加或不添加`enum`关键字是正交的。在原始代码中，您可以`foo`在命名空间级别拥有一个函数，这会导致类似的问题：

```
enum foo { no, yes };
void foo() {}
class Bar {
   foo foo() {                            // Error [1]
      return static_cast<::foo>(0);       // Error [2]
   }
}; 
```

在这个例子中，有两个错误。声明返回类型的时候，函数`Bar::foo`还没有声明，但是有`::foo()`，按照上面的规则，lookup 会向外直到全局命名空间，find`::foo()`在检查之前`enum foo`。第二个错误，基本相同，是`static_cast`请求全局命名空间中的限定在此处无济于事。原因是查找会在找到`::foo()`之前再次找到`enum foo`。正确的代码是：

```
class Bar {
   enum foo foo() {
      return static_cast<enum ::foo>(0);  // :: is optional!
   }
}; 
```

在这种情况下，命名空间限定再次是可选的，但这只是因为没有`foo`用户定义的类型可以通过查找找到。但是我们可以让代码更复杂一些......

```
enum foo { no, yes };
void foo() {}
class Bar {
   struct foo {};
   enum ::foo foo() { 
      return static_cast<enum ::foo>(0);
   }
}; 
```

没有`::`限定条件，`Bar::foo()`声明和`static_cast`都将失败，因为在找到之前有一个用户定义的类型`Bar::foo`将被命中`enum ::foo`。如果没有`enum`，代码也将无法编译，因为全局函数`::foo()`将在`enum`.

总结一下，经过长时间的解释：**不要**。避免创建与类型同名的函数，因为这很可能只会引起混淆。

* * *

^([*])重读标准后，C++ 语言没有为用户定义类型定义单独的标识符空间。另一方面，标准中的规则与上述描述一致。主要区别在于，在 C++ 中，`typedef`别名不能与任何现有类型相同，而不是它所使用的类型：

```
struct foo {};
typedef int foo; // Error 
```

但对于大多数其他目的，行为是一致的。我在答案正文中没有提到几个极端案例，但这远远超出了这个问题的范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:37:59.330

除非明确限定范围，否则命名空间是由内而外的。所以你的`static_cast<foo>(...)`意思`static_cast<first foo found>(...)`。C 语言也是如此，因此可能是语言本身的一个属性。由于所有名称都是完全限定的，因此第一个命中`foo`是唯一重要的。

# sql - 加入表导致查询时间呈指数增长

> ID：12044673
> 
> 赞同：0
> 
> 时间：2012-08-20T20:30:23.970
> 
> 标签：sql, sql-server, sql-server-2008, tsql

到目前为止，我的查询已经运行了 30 分钟：

```
SELECT 
   d.accn_id,
   cast(d.load_date as DATE) as LoadDate,
   cast (d.final_rpt_date as DATE) as FinalReportDate,
   sum(p.paid_amt) as SumPaidAmt,
   payors.PAYOR_ID
FROM accn_demographics d
    JOIN accn_payments p
        ON d.ACCN_ID=p.ACCN_ID    
    JOIN accn_payors payors
        ON payors.X_PAYOR_ID=p.X_PAYMENT_PAYOR_ID
WHERE
      p.POSTED = 'y'
  AND p.PMT_DATE between '20120401' and '20120430'    
GROUP BY
    d.accn_id,
    d.load_date,
    d.final_rpt_date,
    payors.PAYOR_ID 
```

在我添加此表之前：

```
accn_payors 
```

查询花了几分钟，但添加此表后，我仍在等待 30 分钟。

这是3张桌子：

```
USE [zzzDataEOMTestingApril]
GO

/****** Object:  Table [dbo].[accn_payors]    Script Date: 08/20/2012 13:28:20 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[accn_payors](
    [ACCN_ID] [varchar](40) NULL,
    [PAYOR_PRIORITY] [int] NULL,
    [PAYOR_ID] [varchar](15) NULL,
    [PAYOR_NAME] [varchar](40) NULL,
    [GROUP_ID] [varchar](40) NULL,
    [PLAN_ID] [varchar](40) NULL,
    [SUBSCRIBER_ID] [varchar](40) NULL,
    [INSURED_RELATIONSHIP] [varchar](6) NULL,
    [INSURED_L_NAME] [varchar](40) NULL,
    [INSURED_F_NAME] [varchar](40) NULL,
    [INSURED_HOME_PHN] [varchar](40) NULL,
    [INSURED_WORK_PHN] [varchar](40) NULL,
    [INSURED_ADDR1] [varchar](60) NULL,
    [INSURED_ADDR2] [varchar](60) NULL,
    [INSURED_CITY] [varchar](60) NULL,
    [INSURED_STATE] [varchar](2) NULL,
    [INSURED_ZIPCODE] [varchar](10) NULL,
    [PAID_IN_FULL] [varchar](1) NULL,
    [CLAIM_COMMENT] [varchar](4000) NULL,
    [OTHER_INFO1] [varchar](4000) NULL,
    [OTHER_INFO2] [varchar](4000) NULL,
    [OTHER_INFO3] [varchar](4000) NULL,
    [OTHER_INFO4] [varchar](4000) NULL,
    [INTERNAL_NOTES] [varchar](4000) NULL,
    [SYSTEM_ADDED_PAYOR] [varchar](1) NULL,
    [ELIG_OK] [varchar](1) NULL,
    [ELIG_STATUS] [varchar](40) NULL,
    [ELIG_SERVICE] [varchar](40) NULL,
    [ELIG_VERIF_ID] [varchar](15) NULL,
    [AUD_REC_ID] [int] NOT NULL,
    [INSURED_DOB] [varchar](50) NULL,
    [INSURED_SEX] [varchar](3) NULL,
    [EMPLOYER_NAME] [varchar](40) NULL,
    [EMPLOYER_ADDR1] [varchar](60) NULL,
    [EMPLOYER_ADDR2] [varchar](60) NULL,
    [EMPLOYER_CITY] [varchar](60) NULL,
    [EMPLOYER_STATE] [varchar](2) NULL,
    [EMPLOYER_ZIPCODE] [varchar](10) NULL,
    [EMPLOYER_COUNTRY] [varchar](40) NULL,
    [EMPLOYER_PHONE] [varchar](40) NULL,
    [EMPLOYMENT_STATUS] [varchar](40) NULL,
    [GROUP_NAME] [varchar](40) NULL,
    [X_PAYOR_ID] [int] NULL,
    [AUDIT_DATE] [varchar](50) NULL,
    [OCCURRENCE_CODE] [varchar](30) NULL,
    [INSURED_SSN] [int] NULL,
    [OCCURRENCE_CODE_DATE] [datetime] NULL,
    [DELAY_REASON_CODE] [varchar](15) NULL,
    [CASE_ID] [varchar](60) NULL,
    [PAYOR_CODE_TYPE] [varchar](400) NULL,
    [AUTH_NUM] [varchar](40) NULL,
 CONSTRAINT [PK_accn_payors] PRIMARY KEY CLUSTERED 
(
    [AUD_REC_ID] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

USE [zzzDataEOMTestingApril]
GO

/****** Object:  Table [dbo].[accn_payments]    Script Date: 08/20/2012 13:28:35 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[accn_payments](
    [ACCN_ID] [varchar](40) NULL,
    [PMT_SEQUENCE] [int] NULL,
    [DEPOSIT_ID] [int] NULL,
    [DEPOSIT_BATCH_ID] [int] NULL,
    [DEPOSIT_BATCH_SEQ] [int] NULL,
    [PROC_CODE] [varchar](40) NULL,
    [PMT_TYPE] [varchar](40) NULL,
    [USER_ID] [varchar](20) NULL,
    [NOTE] [varchar](4000) NULL,
    [PMT_DATE] [datetime] NULL,
    [CHECK_NUM] [varchar](40) NULL,
    [RECEIPT_NUM] [varchar](40) NULL,
    [ALLOWED_AMT] [float] NULL,
    [DEDUCT_AMT] [float] NULL,
    [PAID_AMT] [float] NULL,
    [COPAY_AMT] [float] NULL,
    [POSTED] [varchar](1) NULL,
    [BULK] [varchar](1) NULL,
    [UNITS_PAID] [int] NULL,
    [BILL_AMT_FROM_EOB] [float] NULL,
    [PAYMENT_PAYOR_ID] [varchar](15) NULL,
    [PRICED_PAYOR_ID] [varchar](15) NULL,
    [AUD_REC_ID] [int] NULL,
    [X_ACCN_BILLED_PROCEDURE_ID] [int] NULL,
    [X_PRICED_PAYOR_ID] [int] NULL,
    [X_PAYMENT_PAYOR_ID] [int] NULL,
    [CLIENT_PRIMARY_FACILITY_ID] [varchar](15) NULL,
    [REMIT_FILE_NAME] [varchar](128) NULL,
    [BATCH_POSTED] [varchar](1) NULL,
    [DEPOSIT_POSTED] [varchar](1) NULL,
    [AUDIT_DATE] [datetime] NULL,
    [ACCEPT_ASSIGNMENT] [varchar](1) NULL,
    [EXPECT_PRICE_DISCREPENCY_AMT] [float] NULL,
    [PRINT_NOTE] [varchar](1) NULL,
    [PATIENT_RESP_AMT] [float] NULL,
    [EOB] [varchar](40) NULL,
    [ICN] [varchar](30) NULL,
    [DEPOSIT_NOTE] [varchar](40) NULL,
    [NETWORK_ID] [varchar](100) NULL,
    [USE_EXPECT_PRICE] [varchar](1) NULL,
    [CO_INS_AMT] [float] NULL,
    [REMIT_DATE] [datetime] NULL
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

USE [zzzDataEOMTestingApril]
GO

/****** Object:  Table [dbo].[accn_demographics]    Script Date: 08/20/2012 13:28:48 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[accn_demographics](
    [ACCN_ID] [varchar](40) NULL,
    [STATUS] [varchar](15) NULL,
    [CLIENT_ID] [varchar](15) NULL,
    [CLIENT_NAME] [varchar](60) NULL,
    [REQ_ID] [varchar](20) NULL,
    [DOS] [datetime] NULL,
    [SEX] [varchar](3) NULL,
    [PT_ID] [varchar](40) NULL,
    [ORDERING UPIN] [bit] NULL,
    [PT_L_NAME] [varchar](40) NULL,
    [PT_F_NAME] [varchar](40) NULL,
    [PT_AGE] [varchar](40) NULL,
    [DOB] [date] NULL,
    [PT_HOME_PHM] [varchar](40) NULL,
    [PT_WORK_PHN] [varchar](40) NULL,
    [PT_ADDR1] [varchar](60) NULL,
    [PT_ADDR2] [varchar](60) NULL,
    [PT_ZIPCODE] [varchar](10) NULL,
    [PT_CITY] [varchar](60) NULL,
    [PT_ST_ID] [varchar](2) NULL,
    [PT_SSN] [int] NULL,
    [RECEIPT_DATE] [datetime] NULL,
    [INDIGENT_PCT] [float] NULL,
    [PRICE_DATE] [datetime] NULL,
    [EXPECT_PRICE] [float] NULL,
    [BILL_PRICE] [float] NULL,
    [GROSS_PRICE] [float] NULL,
    [DUE_AMT] [float] NULL,
    [ACCOUNTING_DATE] [datetime] NULL,
    [FINAL_RPT_DATE] [datetime] NULL,
    [TIME_OF_SERVICE] [varchar](20) NULL,
    [NO_CHARGE] [varchar](1) NULL,
    [AUD_REC_ID] [int] NULL,
    [ORIGINAL_ACCOUNTING_DATE] [datetime] NULL,
    [PT_COUNTRY] [varchar](40) NULL,
    [PHLEB_FACILITY] [varchar](40) NULL,
    [FASTING_TYPE] [varchar](40) NULL,
    [PT_LOCATION] [varchar](40) NULL,
    [PHLEB_USER_ID] [varchar](40) NULL,
    [PRIMARY_CLIENT_ID] [varchar](15) NULL,
    [PHYSICIAN_SOF] [varchar](1) NULL,
    [PATIENT_SOF] [varchar](1) NULL,
    [STAT] [varchar](1) NULL,
    [CALLBACK] [varchar](1) NULL,
    [PT_REPORT_COPY] [varchar](1) NULL,
    [PT_EMAIL] [varchar](40) NULL,
    [PAID_IN_FULL] [varchar](1) NULL,
    [CLIENT_STATEMENT_DATE] [datetime] NULL,
    [RETRO_BILL_PRICE] [float] NULL,
    [PATIENT_TYPE] [varchar](40) NULL,
    [REFERRING_UPIN] [bit] NULL,
    [PRIMARY_UPIN] [bit] NULL,
    [LOAD_DATE] [datetime] NULL,
    [TRIP_STOPS] [int] NULL,
    [TRIP_MILES] [int] NULL,
    [ROUND_TRIP] [varchar](1) NULL,
    [TRIP_PATIENT_COUNT] [int] NULL,
    [ADMISSION_SOURCE] [varchar](40) NULL,
    [EMERGENCY] [varchar](1) NULL,
    [ACCIDENT_CAUSE] [varchar](40) NULL,
    [PATIENT_MARITAL_STATUS] [varchar](40) NULL,
    [ADMISSION_TYPE] [varchar](40) NULL,
    [PATIENT_STATUS] [varchar](200) NULL,
    [WORPCOMP_CASE_WORKER] [varchar](80) NULL,
    [MRO] [varchar](40) NULL,
    [X_CLIENT_ID] [int] NULL,
    [X_PRIMARY_CLIENT_ID] [int] NULL,
    [AUDIT_DATE] [datetime] NULL,
    [ORDERING_NPI] [bit] NULL,
    [REFERRING_NPI] [bit] NULL,
    [PRIMARY_NPI] [bit] NULL,
    [CLIENT_PRODUCT] [int] NULL,
    [ONSET_DATE] [date] NULL,
    [ONSET_TYPE] [varchar](10) NULL,
    [ACCIDENT_STATE_ID] [varchar](2) NULL,
    [TRADE_DISCOUNT_AMOUNT] [float] NULL,
    [RETRO_TRADE_DISC_AMT] [float] NULL,
    [PATIENT_PREGNANT] [varchar](1) NULL,
    [PATIENT_GRAVIDA] [int] NULL,
    [ORDERING_PHYS_NAME] [varchar](80) NULL,
    [X_ORDERING_PHYS_ID] [int] NULL,
    [REFERRING_PHYS_NAME] [varchar](80) NULL,
    [X_ REFERRING_PHYS_ID] [int] NULL,
    [PRIMARY_PHYS_NAME] [varchar](80) NULL,
    [X_ PRIMARY _PHYS_ID] [int] NULL,
    [ADMISSION_DT] [date] NULL,
    [ADMISSION_TIME] [varchar](5) NULL,
    [DISCHARGE_DT] [date] NULL,
    [DISCHARGE_TIME] [varchar](5) NULL
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO 
```

**问题**我怎样才能加快这个查询？我缺少一些索引吗？为什么只添加一个表会成倍地增加返回此查询结果所需的时间？也许我应该改变一些数据类型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:42:30.537

你确定加入付款人是正确的吗？payors 表中有一个 accnid 以及付款人 ID。

尝试将您的加入条件更改为：

```
join accn_payors payors
     on  payors.X_PAYOR_ID=p.X_PAYMENT_PAYOR_ID and
        payors.ACCN_ID = p.ACCN_ID 
```

是否有另一个表格，其中包含独立于帐户的付款人信息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:34:01.133

在列上添加和索引，`accn_payors.X_PAYOR_ID`并添加`accn_payors.PAYOR_ID`到该索引上的“包含的列”。还要在列上添加索引`accn_payments.X_PAYMENT_PAYOR_ID`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-20T20:35:01.900

索引你的外键肯定会有所帮助——在这种情况下，accn_payors.X_PAYOR_ID 上的索引应该会有所作为。

您的表中有多少数据？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T21:17:08.737

试试下面

```
Select 
    sum(p.paid_amt) as SumPaidAmt,
    p.ACCN_ID,
    p.X_PAYMENT_PAYOR_ID,
    cast(d.load_date as DATE) as LoadDate,
    cast (d.final_rpt_date as DATE) as FinalReportDate,
From
(
    SELECT     
            p.paid_amt,
            p.ACCN_ID,
            p.X_PAYMENT_PAYOR_ID
    From    accn_payments p
    Where   p.POSTED = 'y'
    AND     p.PMT_DATE between '20120401' and '20120430'    
)p
INNER Join accn_demographics    d           ON d.ACCN_ID=p.ACCN_ID
JOIN accn_payors                payors      ON payors.X_PAYOR_ID=p.X_PAYMENT_PAYOR_ID
GROUP BY
    d.accn_id,
    d.load_date,
    d.final_rpt_date,
    payors.PAYOR_ID 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-20T20:52:37.670

您是否尝试过查看 SQL Management Studio 中计划的查询执行？它有时会提供有关缺失索引的提示。

# android - Android：旋转图像而不将其加载到内存中

> ID：12044674
> 
> 赞同：24
> 
> 时间：2012-08-20T20:30:32.303
> 
> 标签：android

我想知道是否可以旋转存储在 sdcard 上的图像而不将其加载到内存中。

原因是我正在寻找著名的 OutOfMemoryError。我知道我可以通过对大图像进行下采样来避免它，但实际上我不想减小该图像的大小，我想要原始图像但旋转 90 度。

对此的任何建议都将受到热烈赞赏:)

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2015-04-19T19:14:54.350

![在此处输入图像描述](../Images/861cb44a5212ab89452cdf8b1cbf457b.png)

对于 90 度的旋转，我真的很喜欢[**RenderScript**](http://developer.android.com/guide/topics/renderscript/compute.html)，它是专为处理位图而设计的，而且出乎意料地比默认的`Bitmap.createBitmap()`. 进程内位图不存储在 Java 堆中，因此不会将您推入`OutOfMemoryError`.

用几行代码在项目中设置 RenderScript 支持后，这里是要使用的 RenderScript 算法：

1) 创建`app\src\main\rs\rotator.rs`具有以下内容的 RenderScript 文件。

```
#pragma version(1)
#pragma rs java_package_name(ua.kulku.rs)

rs_allocation inImage;
int inWidth;
int inHeight;

uchar4 __attribute__ ((kernel)) rotate_90_clockwise (uchar4 in, uint32_t x, uint32_t y) {
    uint32_t inX  = inWidth - 1 - y;
    uint32_t inY = x;
    const uchar4 *out = rsGetElementAt(inImage, inX, inY);
    return *out;
}

uchar4 __attribute__ ((kernel)) rotate_270_clockwise (uchar4 in, uint32_t x, uint32_t y) {
    uint32_t inX = y;
    uint32_t inY = inHeight - 1 - x;

    const uchar4 *out = rsGetElementAt(inImage, inX, inY);
    return *out;
} 
```

请注意`ua.kulku.rs`，这是您为自动生成 RS Java 接口选择的一些包名称。

2) 在您的 Java 代码中引用它：

```
import ua.kulku.rs.ScriptC_rotator;

    public Bitmap rotate(Bitmap bitmap) {
        RenderScript rs = RenderScript.create(mContext);
        ScriptC_rotator script = new ScriptC_rotator(rs);
        script.set_inWidth(bitmap.getWidth());
        script.set_inHeight(bitmap.getHeight());
        Allocation sourceAllocation = Allocation.createFromBitmap(rs, bitmap,
                Allocation.MipmapControl.MIPMAP_NONE,
                Allocation.USAGE_SCRIPT);
        bitmap.recycle();
        script.set_inImage(sourceAllocation);

        int targetHeight = bitmap.getWidth();
        int targetWidth = bitmap.getHeight();
        Bitmap.Config config = bitmap.getConfig();
        Bitmap target = Bitmap.createBitmap(targetWidth, targetHeight, config);
        final Allocation targetAllocation = Allocation.createFromBitmap(rs, target,
                Allocation.MipmapControl.MIPMAP_NONE,
                Allocation.USAGE_SCRIPT);
        script.forEach_rotate_90_clockwise(targetAllocation, targetAllocation);
        targetAllocation.copyTo(target);
        rs.destroy();
        return target;
    } 
```

* * *

![在此处输入图像描述](../Images/d66a3bca735cb32bd74222b13fd0fdc9.png)

对于 180 度旋转，**NDK**解决方案优于 RenderScript，就我而言，由于使用了顺序数组项访问，因为 180 度旋转实际上是图像像素数组的反转。我在这些比较中使用的 NDK 算法来自 [https://github.com/AndroidDeveloperLB/AndroidJniBitmapOperations](https://github.com/AndroidDeveloperLB/AndroidJniBitmapOperations)。进程内位图也不存储在 Java 堆上，防止`OutOfMemoryError`.

*统计条显示我在三星 S4 (Android 5.0) 上获得的 13 MP 照片的毫秒数。*

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-08-20T20:33:57.360

您应该使用 decode 解码图像`Bitmap`。你应该按照谷歌提供的[加载大图像](http://developer.android.com/training/displaying-bitmaps/load-bitmap.html)来了解如何做到这一点。它对我有很大帮助，你会注意到 RAM 使用量的巨大差异。

**更新**如果你想要的只是旋转你可以使用这个代码的图像

```
Matrix matrix = new Matrix();
matrix.setRotate(90);
result = Bitmap.createBitmap(bitmap, 0, 0, bitmap.getWidth(),bitmap.getHeight(), matrix, false); 
```

如果您只需要设置图像方向（例如拍摄时的照片方向），您可以使用

```
ExifInterface exif = new ExifInterface(filePath); 
```

`ExifInterface.TAG_ORIENTATION` 我希望这对你有帮助

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-02-26T21:27:11.720

注意：这个答案实际上只是扩展了 riwnodennyk 的答案更容易实现。这都是渲染脚本，不关心任何 NDK。

涵盖所有常见的旋转和获取方向。

要获得旋转，您需要使用 ExifInterface。使用支持库中的那个，因为 sdk 版本存在问题。它适用于 JPEG 和 RAW（及类似）文件，因为此信息嵌入在文件中（而不是在解码的位图中）。

添加到 build.gradle

```
implementation "com.android.support:exifinterface:28.0.0" 
```

如果您有文件的句柄，请使用它

```
import android.renderscript.Allocation;
import android.renderscript.RenderScript;
import your.application.package.rs.ScriptC_rotator;
...

public static Bitmap getCorrectlyRotatedBitmap(@NonNull Context context, @NonNull File imageFile) throws IOException {
    ExifInterface ei = new ExifInterface(imageFile.getPath());
    Bitmap bitmap = BitmapFactory.decodeFile(imageFile.getPath());
    int neededRotationClockwise = ei.getRotationDegrees() % 360;
    return rotateClockwise(context, bitmap, neededRotationClockwise);
} 
```

对于位图旋转本身

```
public static Bitmap rotateClockwise(@NonNull Context context, @NonNull Bitmap bitmap, int degrees) {
    Log.i(TAG, "rotate bitmap degrees: " + degrees);
    if (degrees == 0F) return bitmap;

    RenderScript rs = RenderScript.create(context);
    ScriptC_rotator script = new ScriptC_rotator(rs);
    script.set_inWidth(bitmap.getWidth());
    script.set_inHeight(bitmap.getHeight());
    Allocation sourceAllocation = Allocation.createFromBitmap(rs, bitmap,
            Allocation.MipmapControl.MIPMAP_NONE,
            Allocation.USAGE_SCRIPT);
    bitmap.recycle();
    script.set_inImage(sourceAllocation);

    Bitmap.Config config = bitmap.getConfig();

    switch (degrees) {
        case 90: {
            Bitmap target = Bitmap.createBitmap(bitmap.getHeight(), bitmap.getWidth(), config);
            final Allocation targetAllocation = Allocation.createFromBitmap(rs, target,
                    Allocation.MipmapControl.MIPMAP_NONE,
                    Allocation.USAGE_SCRIPT);

            script.forEach_rotate_90_clockwise(targetAllocation, targetAllocation);
            targetAllocation.copyTo(target);
            rs.destroy();
            return target;
        }
        case 180: {
            Bitmap target = Bitmap.createBitmap(bitmap.getWidth(), bitmap.getHeight(), config);
            final Allocation targetAllocation = Allocation.createFromBitmap(rs, target,
                    Allocation.MipmapControl.MIPMAP_NONE,
                    Allocation.USAGE_SCRIPT);

            script.forEach_rotate_180(targetAllocation, targetAllocation);
            targetAllocation.copyTo(target);
            rs.destroy();
            return target;
        }
        case 270: {
            Bitmap target = Bitmap.createBitmap(bitmap.getHeight(), bitmap.getWidth(), config);
            final Allocation targetAllocation = Allocation.createFromBitmap(rs, target,
                    Allocation.MipmapControl.MIPMAP_NONE,
                    Allocation.USAGE_SCRIPT);

            script.forEach_rotate_270_clockwise(targetAllocation, targetAllocation);
            targetAllocation.copyTo(target);
            rs.destroy();
            return target;
        }
        default:
            throw new IllegalArgumentException("rotateClockwise() only supports 90 degree increments");
    }

} 
```

还有渲染脚本，在其中创建文件`src/main/rs/rotator.rs`，这是使用渲染脚本的默认位置，但您必须自己创建目录。

`your.application.package.rs`酌情更改

```
#pragma version(1)
#pragma rs java_package_name(your.application.package.rs)

rs_allocation inImage;
int inWidth;
int inHeight;

uchar4 __attribute__ ((kernel)) rotate_270_clockwise (uchar4 in, uint32_t x, uint32_t y) {
    uint32_t inX  = inWidth - 1 - y;
    uint32_t inY = x;
    const uchar4 *out = rsGetElementAt(inImage, inX, inY);
    return *out;
}

uchar4 __attribute__ ((kernel)) rotate_90_clockwise (uchar4 in, uint32_t x, uint32_t y) {
    uint32_t inX = y;
    uint32_t inY = inHeight - 1 - x;

    const uchar4 *out = rsGetElementAt(inImage, inX, inY);
    return *out;
}

uchar4 __attribute__ ((kernel)) rotate_180 (uchar4 in, uint32_t x, uint32_t y) {
    uint32_t inX = inWidth - 1 - x;
    uint32_t inY = inHeight - 1 - y;

    const uchar4 *out = rsGetElementAt(inImage, inX, inY);
    return *out;
}

uchar4 __attribute__ ((kernel)) flip_vertical (uchar4 in, uint32_t x, uint32_t y) {
    uint32_t inX = x;
    uint32_t inY = inHeight - 1 - y;

    const uchar4 *out = rsGetElementAt(inImage, inX, inY);
    return *out;
}

uchar4 __attribute__ ((kernel)) flip_horizontal (uchar4 in, uint32_t x, uint32_t y) {
    uint32_t inX = inWidth - 1 - x;
    uint32_t inY = y;

    const uchar4 *out = rsGetElementAt(inImage, inX, inY);
    return *out;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-13T21:00:59.000

[我在这里](https://stackoverflow.com/a/14308060/878126)做了一个非常缓慢但对内存友好的解决方案。

我确信有更好的方法并且很想知道它们

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-20T22:11:08.293

如果您必须处理不同的格式，那将会很痛苦。您必须能够理解不同的格式并能够读取/写入/转换它们，可能是通过流。在普通 PC 上，我会说查看具有非常大图像支持的[ImageMagick 。](http://www.imagemagick.org/script/index.php)我搜索了一个 Android 端口并想出了[这个](https://github.com/lilac/Android-ImageMagick)。可能值得一试。不过，它看起来还没有完成，因此您可能需要做一些工作才能获得更好的格式覆盖率。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-09-14T11:29:27.810

我建议您使用一些在位图上操作时不将数据存储在进程堆上的第三方库。就我而言，我使用了我已经在项目中用于其他目的的 ffmpeg。

# c# - Visual Studio 2012 找不到模板

> ID：12044675
> 
> 赞同：5
> 
> 时间：2012-08-20T20:30:44.990
> 
> 标签：c#, asp.net, visual-studio-2012

在 Visual Studio 2012 RC 之上安装 Visual Studio 2012 RTM 并创建新的 ASP.Net 空 Web 应用程序项目后，我无法将新 Web 窗体添加到我的项目中。尝试添加新的 Web 表单时，我收到错误消息：

> 找不到路径的一部分 ....\WebForm.zip\WebForm.vstemplate

此问题列在此处的连接站点上：

[https://connect.microsoft.com/VisualStudio/feedback/details/758581/could-not-find-itemtemplate-path](https://connect.microsoft.com/VisualStudio/feedback/details/758581/could-not-find-itemtemplate-path)

我不能在那里注册解决方法，所以我要在这里做，所以希望其他人能找到这个。（有人知道为什么 d@mnded 注册链接不起作用吗？）

更新：我还必须为 Class 模板执行此操作：（我的路径）

```
 C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\ide\ItemTemplatesCache\web\csharp\1033\Class
Copied the Class folder and renamed it Class.zip 
```

.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T20:32:22.883

要解决此问题：

1.  打开路径的资源管理器窗口。在我的情况下，路径是 C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\ide\ItemTemplatesCache\web\csharp\1033

2.  制作 WebForm 文件夹的副本并将副本命名为 WebForm.zip。

3.  尝试向项目中添加一个新的 Web 表单。这次应该会成功。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-27T17:59:22.460

试试 devenv /installvstemplates 它对我有用。#vs2010

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-30T22:55:33.697

Chris 的解决方法对我不起作用。但是在解决了他的路径和我的路径之间的路径差异之后，它确实有效！谢谢克里斯！

## 首先，我尝试了什么以及结果：

Chris 的解决方法中给出的路径存在于我的机器上，该路径中的 WebForm 文件夹也存在，所以我尽职尽责地遵循了 Chris 的指示：

1.  我将 WebForm 文件夹复制并粘贴回 1033 文件夹（我使用的是 Windows 7，因此在同一文件夹中复制和粘贴会导致创建“WebForm - Copy”文件夹）。
2.  根据 Chris 的说明，我将文件夹重命名为“WebForm.zip”。
3.  然后我尝试在我的项目中添加一个新的 WebForm 并...

***和以前一样的错误！***

## 我注意到了什么，然后我尝试了什么，结果：

克里斯说：

> ***在我的情况下***，路径是 C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\ide\ItemTemplatesCache\web\csharp\1033

我决定仔细查看错误对话框中显示的路径。这是我的错误消息和路径：

> 找不到路径 C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\ItemTemplatesCache\CSharp\Web\1O33\WebForm.zip\WebForm.vstemplate 的一部分。

请注意，`CSharp\Web`我的路径与`web\csharp`Chris 的路径不同。我原以为克里斯在复制他的路径时打错了，但***两条路径都存在于我的机器上！世界卫生大会...？！***

因此，在离开诱饵后找到了这个新文件夹（我确信这对 Chris 和其他人来说是正确的路径），我在另一个文件夹中再次尝试了 Chris 的解决方法，一切都运行良好。

我很惊讶在 Visual Studio 文件结构中有这样的重复，但是，嘿 - 为什么我首先会收到这个错误？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-23T22:29:21.767

也有讨厌的问题

这对我有用，将文件复制到 C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE>

在cmd中运行命令：

C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE>vsixinstaller /s :premium /v:11.0 dnntemplates.vsix

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-19T15:25:06.040

这非常令人沮丧。它正在寻找一个 .zip 文件夹。

我使用的快速修复方法是将所有目录复制到它抱怨的任何模板文件夹中，并在末尾添加一个 .zip。Xcopy 让您可以有效地做到这一点。我不得不这样做几次，因为 VS 为模板使用了许多不同的位置。

在此处打开控制台：C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\ItemTemplatesCache\CSharp\Web\1033

如果您向上导航到一个文件夹（即 Web）并按住 Shift 并单击 1033 文件夹，您将获得“在此处打开命令窗口”选项

运行此命令将所有文件夹重命名为 folder.zip

```
for /d %d in (*.) do ren %d %d.zip 
```

# symfony - Symfony2：如何创建注释路由包含特殊字符

> ID：12044681
> 
> 赞同：0
> 
> 时间：2012-08-20T20:31:12.727
> 
> 标签：symfony, routing, character

在我的控制器中，我需要创建注释路由，它必须与此相同：
/getservice?from=2012-06-01&to=2012-06-25

我已经尝试过了，但它不起作用

```
/**
 * @Route("/getservice",defaults={"from" = "","to" = ""})
 * @Route("/getservice?from={from}&to={to}")
 * @Template()
 */ 
```

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:06:27.117

只需为 getservice 部分创建一个路由并从 GET 请求中获取参数

```
/**
 * @Route("/getservice")
 * @Template()
 */
public function getServiceAction (Request $request) {

    $from = $request->query->get('from');
    $to = $request->query->get('to');
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T22:43:45.667

你也可以做这样的事情

```
/**
 * @Route("/getservice/{from}/{to}")
 * @Template()
 */
public function getServiceAction($from, $to){
  // ...
} 
```

# jquery - 如何找到紧跟错误跨度的 jquery 元素

> ID：12044689
> 
> 赞同：2
> 
> 时间：2012-08-20T20:32:01.477
> 
> 标签：jquery, jquery-plugins, twitter-bootstrap, jquery-validate

我正在使用 twitter bootstrap 和 jquery validate 插件

我有一个看起来像这样的表单行：

```
<div class="form_row" >
<div class="control-group">
    <label class="control-label" for="input01">home phone</label>
      <div class="controls">
        <input type="number" class="span4" class="input-xlarge" id="home_phone" name="home_phone" value="<?php echo $this->property->home_phone ?>" rel="popover" data-content="Re-enter your home phone." data-original-title="homephone" >
        <input type="number" class="span4" class="input-xlarge" id="cell_phone" name="cell_phone" value="<?php echo $this->property->cell_phone ?>"  rel="popover" data-content="Re-enter your cell_phone." data-original-title="cell_phone" >
      </div>
</div> 
```

验证后，当我在 firebug 中查看它时，有错误的输入后面是 span.error。我想选择这些输入。到目前为止，我有：

```
$.filter(function() { return $(this).next("span.error"); }) 
```

但我收到以下错误：

类型错误：elems 未定义 [中断此错误]

返回 elems.length === 1 ？

任何人都可以在这里帮我一把吗？

谢谢，

账单

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T20:34:58.413

你试过这个吗？

```
$("input").filter(function() { return $(this).next("span.error").length == 1; }) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:41:45.477

试试这个：

```
$('input').filter(function(index) { return typeof($(this).next("span.error")!='undefined'); }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T21:01:32.673

只需选择`span.error`元素，然后返回到`input`元素：

```
​var inputs = $('span.error').prev('input'); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/cKaka/)。

顺便说一句，这种方法（在 Chromium 19 中）比使用这些方法更快（尽管只是*略微*`filter()`） 。显然，这是一个微优化。当然，假设浏览器支持`document.querySelectorAll()`和`previousElementSibling`，使用原生 DOM 方法会更快。但老实说，并没有我预期的那么多。

参考：

*   [`prev()`](http://api.jquery.com/prev/).

# .net - 通过 form.Control(ItemIndex).Custom 属性访问时不会出现自定义控件属性

> ID：12044690
> 
> 赞同：0
> 
> 时间：2012-08-20T20:32:04.223
> 
> 标签：.net, vb.net

我刚刚使用 vb.net 2010 制作了一个自定义按钮控件，并在该控件中提供了一些自定义属性。

现在一切看起来都很好，但是在新表单上添加该自定义控件并尝试访问我的自定义控件属性后，我看不到自定义属性（`CustomProperty1,CustomProperty2 and CustomProperty3`）我正在使用该代码访问：

```
Form1.Controls(MyCustomControlIndex).CustomProperty1 
```

这里我在智能菜单中看不到`CustomeProperty1`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:42:14.600

我认为这很正常：返回一个 Control 对象（从[MSDN](http://msdn.microsoft.com/en-us/library/333f9hk4%28v=vs.100%29)`Form1.Controls(MyCustomControlIndex)`可以看到），因此它没有用户定义的属性。 您应该将其转换为用户控件的类型，然后每个属性都应该使用 IntelliSense 显示。

# c - 使用 LoadLibraryExA(...,...,LOAD_LIBRARY_AS_DATAFILE) 时 GetModuleInformation 失败？

> ID：12044691
> 
> 赞同：1
> 
> 时间：2012-08-20T20:32:04.827
> 
> 标签：c, winapi, dll, code-signing

我`dliNotePreLoadLibrary`在我自己的延迟加载钩子中使用它来验证要在实际加载之前加载的 DLL 的代码签名。为了避免它执行*任何*代码，我通过`LoadLibraryExA(...,...,LOAD_LIBRARY_AS_DATAFILE)`（钩子只提供ANSI名称，所以没关系）加载它并在验证后卸载它，以便它可以作为带有代码的DLL加载。

单步调试调试器中的代码，我可以看到我收到了一个句柄，并且该句柄`<baseaddress>+1`与“数据模块”的预期一致。但是，一旦我尝试将此句柄传递到`GetModuleFileName`库函数内部（这也是我不能传递名称的原因，只能传递模块句柄），函数返回`0`并且 GetLastError 给了我`ERROR_MOD_NOT_FOUND`. 但是，该模块已加载，因此肯定找到了。此外，这是在当前进程中，因此访问“目标进程”在这里没有问题。

所以我想为什么不使用`VirtualQuery`检索`MEMORY_BASIC_INFORMATION::BaseAddress`我刚刚加载的 DLL 的实际基地址 ( )（以防万一`<baseaddress>+1`出现问题），但结果保持不变`ERROR_MOD_NOT_FOUND`：

我没主意了。有谁知道这里发生了什么？

测试平台：Windows 7 SP1，x64（最新补丁）

这是以下代码：

```
FARPROC WINAPI MyDliHook(unsigned dliNotify, PDelayLoadInfo pdli)
{
    switch(dliNotify)
    {
    case dliNotePreLoadLibrary:
        if(0 == lstrcmpiA(pdli->szDll, "DLLNAME.dll"))
        {
            HMODULE hVerifiedDll = LoadLibraryExA(pdli->szDll, NULL, LOAD_LIBRARY_AS_DATAFILE);
            if(hVerifiedDll)
            {
                MEMORY_BASIC_INFORMATION mbi;
                if(0 != VirtualQuery(hVerifiedDll, &mbi, sizeof(mbi)));
                {
                    VerifyModuleSignature((HMODULE)mbi.BaseAddress, pdli->szDll);
                }
                FreeLibrary(hVerifiedDll);
            }
        }
        break;
    default:
        break;
    }
    return NULL;
}
PfnDliHook __pfnDliNotifyHook2 = MyDliHook; 
```

该函数`VerifyModuleSignature`首先调用`GetModuleFileName`以检索文件名，但在该步骤失败。我验证了`.exe`创建过程的代码签名验证工作正常。

**旁注：**我已经验证了`ERROR_MOD_NOT_FOUND`错误来自`GetModuleFileName`而不是，例如，来自之前对`LoadLibraryExA`. 为了确保`SetLastError(ERROR_SUCCESS)`在调用`GetModuleFileName`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T06:56:37.627

如[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms684179%28v=vs.85%29.aspx)中所述，当使用 LOAD_LIBRARY_AS_DATAFILE 时，您无法使用 GetModuleHandle 检索模块：

> 如果使用此值，系统会将文件映射到调用进程的虚拟地址空间，就好像它是一个数据文件一样。没有做任何事情来执行或准备执行映射的文件。因此，您不能使用此 DLL 调用 GetModuleFileName、GetModuleHandle 或 GetProcAddress 等函数。

**编辑：**实际上 Hans Passant 比这个答案更接近原因。虽然这个答案重申了 MS 所说的，但它没有给出理由。然而，原因是它`GetModuleFileName`基本上遍历了[`LDR_MODULE`](http://undocumented.ntinternals.net/UserMode/Structures/LDR_MODULE.html)列表`PEB`，并且仅在您“加载代码”时填充了详细信息。

# java - 不能将 Guava Optional 用于默认构造函数？

> ID：12044694
> 
> 赞同：1
> 
> 时间：2012-08-20T20:32:16.760
> 
> 标签：java, guava

我想不出正确的方法来拥有一个 Guava Optional 的默认构造函数参数。以下代码无法使用 Java 1.6 编译

```
public class ShoppingCart implements Serializable {
private final Optional<DiscountCoupon> discountCoupon;

public ShoppingCart() {
    this(Optional.absent());
}
public ShoppingCart(Optional<DiscountCoupon> dc) {
    Preconditions.checkNotNull(dc);
    if (dc.isPresent()) {
        Preconditions.checkArgument(dc.get().getPennyDiscount() != 0 || 
                        dc.get().getPercentDiscount() != 0);
    }
    discountCoupon = dc;
} 
```

报告的错误是：

```
/Users/pfarrell/sandbox//com/wayfinderdigital/struct/ShoppingCart.java:29: cannot find symbol
symbol  : constructor ShoppingCart(com.google.common.base.Optional<java.lang.Object>)
location: class com.wayfinderdigital.struct.ShoppingCart
    this(Optional.absent()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T20:34:44.567

Java 无法从您编写的代码中自动推断出泛型。相反，使用

```
public ShoppingCart() {
  this(Optional.<DiscountCoupon>absent());
} 
```

（尽管我不得不问——你确定这`Optional`真的合适吗？）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T20:35:11.657

尝试改变

```
this(Optional.absent()); 
```

至

```
this(Optional.<DiscountCoupon>absent()); 
```

第二种使用显式类型参数规范，因此不需要类型参数推断。类型参数推断可以基于输入参数或基于表达式被分配到的类型来完成，但许多其他使用站点推断不会自动工作，因此类型参数假定其下限。

# php - 从 IIS 6.0 和 PHP 读取/写入 NAS 的问题

> ID：12044695
> 
> 赞同：0
> 
> 时间：2012-08-20T20:32:20.707
> 
> 标签：php, iis, permissions, fopen, isapi-rewrite

我无法让脚本写入连接的网络驱动器/NAS。奇怪的是，同一个网络服务器从服务器上的现有脚本读取/写入同一目录没有问题。我不擅长使用 Windows/IIS 网络服务器，所以我会尽量列出尽可能多的东西。

首先，我使用一个简单的测试脚本来执行 is_dir 和 is_writeable。我使用与工作脚本中的变量相同的 $dir 变量。

这是一个例子：

```
$aftn_path = "\\\\skynas01\\shared_files\\";
if(is_dir($aftn_path)) echo "$aftn_path is a directory."; else echo "$aftn_path is not a directory"; 
```

返回的是：

> \\skynas01\shared_files\ 不是目录

我可以将目录字符串复制/粘贴到运行命令中，并且目录可以正常打开。我检查了该目录的权限并显示“每个人”都可以从该目录读取/写入/执行。同样，具有完全相同目录字符串的另一个脚本与 fopen() 调用工作没有问题，我可以在那里写文件。

我能想到的唯一另一件事可能是 IIS 服务器使用 helicon ISAPI Rewrite 模块，并且有效的脚本确实有一个指向该 PHP 文件的规则（我也不明白）

这是 ISAPI 重写规则

```
 RewriteRule /sys/filing(.*)   /phpsys/filing.php [I,L] 
```

对我来说，它看起来只是别名 /sys -> /phpsys。

\skynas01 网络挂载映射到服务器上的内部驱动器，也不能通过驱动器号访问 (G:/shared_files)。我也尝试过使用正斜杠（//skynas01/shared_files）。有谁知道为什么我的脚本看不到这个目录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T02:39:55.597

这绝对不是 ISAPI_Rewrite。您可以通过从配置文件中删除规则来检查并请求您需要的东西。它仍然会抛出错误。

# c++ - 如何重置 librocket 库？

> ID：12044697
> 
> 赞同：2
> 
> 时间：2012-08-20T20:32:24.013
> 
> 标签：c++, librocket

我正在尝试重置库，但我似乎不能。

我找到[了这篇文章](http://forums.librocket.com/viewtopic.php?f=2&t=323)，但即使有那里的解释，我也无法做到。

**在您看到我的代码之前，我要做的是在选项菜单中更改窗口的分辨率。也许有一种我不知道的方法，这是一种矫枉过正。**

这就是我正在做的事情（对“渲染器”的引用将它们作为 OpenGL 处理程序）：

此代码在 EventHandlerOptions.cpp 中，在函数 ProcessEvent 中

```
 if(ResolutionChanged)
        {
            // Change the resolution
            Renderer *renderer = GameSettings::GetRenderer();
            GUIScene *gui = GameSettings::GetGUI();
            if(renderer != NULL && gui != NULL)
            {
                bool ok;
                // Shutdown old ones
                gui->Shutdown();
                renderer->Shutdown();

                // Initialize the new ones
                ok = renderer->Init(GameSettings::GetResolutionWidth(), GameSettings::GetResolutionHeight(), 16, (bool)GameSettings::GetRepresentation());
                assert(ok);

                ok = gui->Init(GameSettings::GetResolutionWidth(), GameSettings::GetResolutionHeight());
                assert(ok);
            }
        } 
```

GUI 的相关代码（我正在使用库附带的示例代码，因此您将看到对 Shell 的引用）：

```
bool GUIScene::Init(int width, int height)
{
// Generic OS initialisation, creates a window and attaches OpenGL.
if (!Shell::Initialise("."))
{
    Shell::Shutdown();
    return false;
}

//Rocket initialisation.
Rocket::Core::SetRenderInterface(new ShellRenderInterfaceOpenGL());
Rocket::Core::SetSystemInterface(new ShellSystemInterface());

Rocket::Core::Initialise();
// Initialise the Rocket Controls library.
Rocket::Controls::Initialise();

// Create the main Rocket context and set it on the shell's input layer.
context = Rocket::Core::CreateContext("main", Rocket::Core::Vector2i(width, height));
if (context == NULL)
{
    Rocket::Core::Shutdown();
    Shell::Shutdown();
    return false;
}

Rocket::Debugger::Initialise(context);
Input::SetContext(context);

Shell::LoadFonts("Data/");

// Initialise the event instancer and handlers.
EventInstancer* event_instancer = new EventInstancer();
Rocket::Core::Factory::RegisterEventListenerInstancer(event_instancer);
event_instancer->RemoveReference();

EventManager::SetContext(context);
EventManager::RegisterEventHandler("options", new EventHandlerOptions());

EventManager::LoadWindow("demo");

return true;
}

void GUIScene::Shutdown()
{
// Shutdown Rocket.
EventManager::Shutdown();
context->RemoveReference();
Rocket::Core::Shutdown();

Rocket::Core::SetSystemInterface(NULL);
Rocket::Core::SetRenderInterface(NULL);

Shell::Shutdown();
} 
```

**这在 EventManager.cpp 上崩溃（我认为在 ProcessEvent 函数中）**

消息是：“Game.exe 中 0x773515de 中的未处理异常：0xC0000005：....位置 0x2ab60ee1”

看起来它与事件管理器有关，但我正在关闭它所以......？

谢谢。

# django - 获取 django-storages 文件的内容进行处理

> ID：12044698
> 
> 赞同：2
> 
> 时间：2012-08-20T20:32:43.500
> 
> 标签：django, celery, django-storage, celery-task, django-media

当我在本地提供媒体服务并且需要处理获取文件内容的任务时，这非常简单。但是，我只是转移到了 django-storages，这并不是替代品。有人可以为我提供一种将文档从 S3 中提取出来的方法，以便我可以处理它。

老办法：

```
filename = settings.MEDIA_ROOT + "/" + document.name
xlsx = XLSXParser(filename = filename, uniq_header_column='XYX') 
```

但是我转移到 django-storages 并且这（显然）不起作用。如何从 s3 中提取文件的本地副本来处理它。我以为我可以简单地这样做：

新（失败）方式：

```
filename = settings.MEDIA_ROOT + "/" + document.name

if not os.path.isfile(filename):
    new_filename = tempfile.NamedTemporaryFile(delete=False)
    new_filename.write(document.read())
    filename = new_filename

xlsx = XLSXParser(filename = filename, uniq_header_column='XYX') 
```

但是我不能在它爆炸时对此进行 read() 。

```
Traceback (most recent call last):
  File ".../celery/task/trace.py", line 212, in trace_task
    R = retval = fun(*args, **kwargs)
  File ".../tasks.py", line 63, in process_homes
    process_homes_non_task(**kwargs)
  File ".../tasks.py", line 33, in process_homes_non_task
    new_filename.write(document.read())
  File ".../django/core/files/utils.py", line 16, in <lambda>
    read = property(lambda self: self.file.read)
  File ".../django/db/models/fields/files.py", line 46, in _get_file
    self._file = self.storage.open(self.name, 'rb')
AttributeError: 'FieldFile' object has no attribute 'storage' 
```

最后，我需要它同时适用于旧方式和新方式。显然我有点想多了..

**更新：**

遵循[文档](http://django-storages.readthedocs.org/en/latest/backends/amazon-S3.html)也无济于事。

```
filename = settings.MEDIA_ROOT + "/" + document.name
if not os.path.isfile(filename):
    from django.core.files.storage import default_storage
    s3_file = default_storage.open(document.name, 'rb')
    new_filename = tempfile.NamedTemporaryFile(delete=False)
    new_filename.write(s3_file.read())
    filename = new_filename

xlsx = XLSXParser(filename = filename, uniq_header_column='Lot_Number')
xlsx.load_workbook_and_sheet() 
```

谢谢您的帮助。

# objective-c - 核心情节Legent不显示

> ID：12044699
> 
> 赞同：2
> 
> 时间：2012-08-20T20:32:51.400
> 
> 标签：objective-c, core-plot

我对 Core Plot 完全陌生，无法在视图中添加图例。我一直在尝试各种教程并阅读了很多信息，但我不明白如何显示图例。

我真的很感激一些帮助，因为我已经花了很多时间来尝试让它发挥作用。

请注意，我此时的目标是显示一个图例，例如：

![我想要的是](../Images/c4a0429e56b5d7a82494b20e836ddd5d.png)

这是我得到的：

![现在的传奇](../Images/0221d2f83ab68cbe8e0cf5a37daf8031.png)

唯一出现的是右边的小粗线。我可以移动它，但不能得到传说。

编码：

```
// Create pieChart from theme
pieChart = [[CPTXYGraph alloc] initWithFrame:CGRectZero];
CPTTheme *theme = [CPTTheme themeNamed:kCPTDarkGradientTheme];
[pieChart applyTheme:theme];

//Create host view
self.hostingView = [[CPTGraphHostingView alloc] 
                    initWithFrame:[[UIScreen mainScreen]bounds]];
[self.view addSubview:self.hostingView];

hostingView_.hostedGraph = pieChart;
pieChart.axisSet = nil;
pieChart.plotAreaFrame.borderLineStyle = nil; 

pieChart.paddingLeft   = 10.0;
pieChart.paddingTop    = 120.0;
pieChart.paddingRight  = 10.0;
pieChart.paddingBottom = 80.0;

pieChart.fill = [CPTFill fillWithColor:[CPTColor clearColor]];
pieChart.plotAreaFrame.fill = [CPTFill fillWithColor:[CPTColor clearColor]];

CPTMutableTextStyle *whiteText = [CPTMutableTextStyle textStyle];
whiteText.color = [CPTColor whiteColor];
whiteText.fontSize = 14;
whiteText.fontName = @"Helvetica";

pieChart.titleTextStyle = whiteText;

//==================================================//
// LEGENDS //

// 1 - Get graph instance
CPTGraph *graph = self.hostingView.hostedGraph;
// 2 - Create legend
CPTLegend *theLegend = [CPTLegend legendWithGraph:graph];
// 3 - Configure legen
theLegend.numberOfColumns = 1;
theLegend.fill = [CPTFill fillWithColor:[CPTColor whiteColor]];
theLegend.borderLineStyle = [CPTLineStyle lineStyle];
theLegend.cornerRadius = 5.0;
// 4 - Add legend to graph
graph.legend = theLegend;     
graph.legendAnchor = CPTRectAnchorRight;
CGFloat legendPadding = -(self.view.bounds.size.width / 8);
graph.legendDisplacement = CGPointMake(legendPadding, 0.0);

//==================================================//

// Add pie chart
CPTPieChart *piePlot = [[CPTPieChart alloc] init];
piePlot.dataSource      = self;
piePlot.pieRadius       = 70.0; //140.0;  //131.0;
piePlot.identifier      = @"Pie Chart 1";
piePlot.startAngle      = M_PI_4;
piePlot.sliceDirection  = CPTPieDirectionCounterClockwise;   //CPTPieDirectionCounterClockwise;
piePlot.centerAnchor    = CGPointMake(0.5, 0.5); //(0.5, 0.38);
piePlot.borderLineStyle = [CPTLineStyle lineStyle];

piePlot.delegate        = self;
[pieChart addPlot:piePlot]; 
```

xx

```
-(NSString *)legendTitleForPieChart:(CPTPieChart *)pieChart recordIndex:(NSUInteger)index {
return [NSString stringWithFormat:@"Pie Slice %lu", (unsigned long)index];
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-21T01:29:12.327

在设置图例之前将绘图添加到图形中。也可以`-addPlot:`直接在图例上使用该方法，但让图形来做会更容易。

# php - getDataAsJSON() 是 PHP 中未定义的函数，但许多解释如何使用 JSONP 的网站都说要使用它

> ID：12044701
> 
> 赞同：0
> 
> 时间：2012-08-20T20:32:52.477
> 
> 标签：php, javascript, jquery, ajax, jsonp

Javascript Ajax：

```
<script type="text/javascript" src="http://www.MyFirstDomain.com/jquery.js"></script>
<script type="text/javascript">

$(document).ready( function () {

    var referrer = document.referrer;
    var currentpage = $(location).attr('href');
    var data_object = {
        'ref':      referrer,
        'curpg':    currentpage,
        'shizz1e':  '21'
    };

    $.ajax({
        'dataType': 'jsonp',
        'jsonp': 'jsonp_callback',
        'url': "http://www.myOtherDomain.com/ajaxreceiver.php",
        'data': data_object
    });
}); 
```

PHP：

```
<?php
$data = getDataAsJSON($_GET['curpg']);
echo $data;
?> 
```

我正在尝试将一些变量从一台服务器上的 Javascript 发送到另一台服务器上的 PHP。我正在使用 Ajax 和 JSONP（解决相同的来源策略）。我曾经尝试理解 JSONP 的网站说使用 getDataAsJSON() 在 PHP 中获取 JSON，但这显然不是一个真正的函数。我要解决这个问题了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:34:24.653

在 PHP 中，您可以使用 json_decode。

PHP 没有名为 getDataAsJSON 的函数。这可能是某人编写的自定义函数。

函数 json_decode 创建一个 json 字符串的对象。所以你将无法回显它，因为它会给你一个错误。您可以使用 print_r($data) 来获取对象的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:46:13.133

`json_decode()`返回一个带有属性的新 STDClass 对象。失败时为 NULL。

`json_encode()`返回一个包含这些 json 属性的字符串。

此外，您应该检查函数是否返回了有效的 json 对象/字符串或 NULL。所以，使用一些基本的验证对你来说是一件好事。

我更喜欢`var_dump()`用于跟踪对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:48:21.250

`getDataAsJSON`不存在。但是，您可以像这样加载 JSON 文件：

```
json_decode(file_get_contents($url)); 
```

您可能希望将 的第二个参数（`json_decode`将对象转换为关联数组）设置为 true，以便您可以像访问数组一样访问解码的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-24T22:39:45.417

```
//define getDataAsJson():
function getDataAsJson($param) {
  $ary = array(
    "symbol" => $param || 'IBM',
    "price" => "199.0"
  );
  return json_encode($ary);
} 
```

# php - 我如何运行 phpunit 测试？

> ID：12044702
> 
> 赞同：1
> 
> 时间：2012-08-20T20:32:53.960
> 
> 标签：php, unit-testing, phpunit

[https://github.com/phpseclib/phpseclib/tree/master/tests](https://github.com/phpseclib/phpseclib/tree/master/tests)

我对 phpunit 的熟悉程度非常低。我如何运行这些测试？我使用以下命令（根据[本网站](http://www.phpunit.de/manual/3.6/en/installation.html)）安装了 phpunit：

```
pear config-set auto_discover 1
pear install pear.phpunit.de/PHPUnit 
```

我尝试`phpunit MD5Test`从 tests/Crypt/Hash 目录执行并获得以下信息：

```
PHP Fatal error:  Class 'Crypt_Hash_TestCase' not found in /root/phpseclib/trunk/tests/Crypt/Hash/MD5Test.php on line 9 
```

这并不奇怪，因为 Crypt_Hash_TestCase 不包含在任何地方。有一个 bootstrap.php 文件，但我也不知道如何使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T00:10:11.867

从此目录运行 phpunit：[https](https://github.com/phpseclib/phpseclib) ://github.com/phpseclib/phpseclib 线索是找到 phpunit.xml.dist 文件的位置。

要运行所有测试，您只需简单地启动它：

```
phpunit 
```

如果您只想运行 MD5Test 测试，那么（仍然来自同一个根目录）：

```
phpunit tests/Crypt/Hash/MD5Test.php 
```

# ruby-on-rails - 当我添加简单验证时，为什么我的测试开始失败？

> ID：12044704
> 
> 赞同：1
> 
> 时间：2012-08-20T20:33:05.130
> 
> 标签：ruby-on-rails, ruby-on-rails-3

这是我的控制器测试：

```
 test "should get create" do
    sign_in(FactoryGirl.create(:user, admin: true))
    assert_difference('Event.count') do
      post :create, FactoryGirl.build(:event)
    end
    assert_not_nil assigns(:event)
    assert_response :success
  end 
```

当我向 events.rb 添加最简单的验证时

```
class Event < ActiveRecord::Base
  attr_accessible :city, :date, :name, :state, :street
  has_many :periods

  validates :name, presence: true
end 
```

我得到：

```
1) Failure:
test_should_get_create(EventsControllerTest) [/Users/noahc/Dropbox/mavens/test/functional/events_controller_test.rb:37]:
"Event.count" didn't change by 1.
<2> expected but was
<1>. 
```

但是，然后我查看 events_factory.rb

```
 factory :event do
    name 'First Event'
    street '123 street'
    city 'Chicago'
    state 'IL'
    date Date.today
  end 
```

并且似乎没有需要名称的问题。

更新：

当我进行测试时：

```
test "should get create" do
    sign_in(FactoryGirl.create(:user, admin: true))

    assert_not_nil assigns(:event)
    assert_response :success
  end 
```

我得到：

```
 1) Failure:
test_should_get_create(EventsControllerTest) [/Users/noahc/Dropbox/mavens/test/functional/events_controller_test.rb:38]:
<nil> expected to not be nil. 
```

当我删除该行并留在 assert_response :success 中时，它通过了。

更新2：

```
def create
    @event = Event.new(params[:event])
    @event.save
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T22:12:11.470

如何改变这个：

```
post :create, FactoryGirl.build(:event) 
```

到：

```
post :create, event: FactoryGirl.attributes_for(:event) 
```

**说明**：

`post`期望具有您正在创建的记录的属性的哈希。`FactoryGirl.build(:event)`创建一个新的未保存的模型实例 ( `event`)，这不是您想要的。由于您没有对模型进行验证，因此不知何故这被忽略了，所以实际上工厂对新创建的事件没有影响（我假设它是用空白属性创建的）。

`attributes_for`，相反，将工厂的属性作为哈希返回，因此：

```
attributes_for(:event) #=> { name: 'First Event', street: '123 street', ... } 
```

这正是你想要的。当您将此传递给 时`post`，它会将哈希中的属性分配给`params`，然后用于在以下行中创建一个新事件：`Event.new(params[:event])`。

# url - wordpress 上的自定义重定向

> ID：12044708
> 
> 赞同：0
> 
> 时间：2012-08-20T20:33:22.933
> 
> 标签：url, mod-rewrite, url-rewriting

我正在尝试创建一个自定义重写规则，该规则将接收第二个查询字符串。

当前： http://mysite.com/daily-deals/?category= [alldeals](http://mysite.com/daily-deals/?category=alldeals)

我希望它是： http: [//mysite.com/daily-deals/alldeals/](http://mysite.com/daily-deals/alldeals/)

我已经尝试了下面的解决方案，但它似乎不起作用。

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^daily-deals/(.*)$ index.php?page_id=508&category=$1 [L,NC]

</IfModule>
RewriteEngine Off

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

任何想法将不胜感激！

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:43:26.600

**想法#1**

```
RedirectMatch 301 daily-deals/(.*)$ [[GENERATED URL WHERE YOU WANT TO REDIRECT]] 
```

**想法#2**

您可以使用 [Wordpress 重定向插件进行重定向](http://wordpress.org/extend/plugins/redirection/)

# spring - 在 Spring-AOP 中没有被调用的建议

> ID：12044710
> 
> 赞同：8
> 
> 时间：2012-08-20T20:33:31.143
> 
> 标签：spring, spring-aop

我已经声明了以下建议 dao 调用的 Aspect，我正在尝试运行 @Before 建议，但它不起作用。

这里是方面。

```
package com.hedgebenefits.aop;

import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;
@Aspect
public class AccessControlAspect {
    @Before("within(com.hedgebenefits.daos..*) && execution(public * *(..))")
    public void daoCall() {
        System.out.println("Before advice invoked for DAO method called ");
    }
} 
```

我的 application-context.xml 有以下标签

```
<aop:aspectj-autoproxy/> 
```

我的道课如下：

```
package com.hedgebenefits.daos.impl;

import com.hedgebenefits.daos.AdminDao;
import com.hedgebenefits.domain.Admin;
import org.springframework.stereotype.Repository;

@Repository
public class AdminDaoImpl implements AdminDao{
    @Override
    public void save(Admin admin) {
    }
} 
```

我放了一个断点，但我可以看到它没有激活，我肯定在这里犯了一些愚蠢的错误，但无法弄清楚。PL。建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-20T20:43:20.700

您的方面需要成为应用程序上下文的一部分。

1.  如果您正在使用`component-scan`，请添加`@Component`到您的`AccessControllerAspect`，或设置`component-scan`过滤器以包含`@Aspect`注释。要设置过滤器，请查看[Spring 文档的第 3.10.3 节（使用过滤器自定义扫描）](http://static.springsource.org/spring/docs/3.0.x/reference/beans.html#beans-annotation-config)。
2.  如果您使用的是 xml 配置，请为`AccessControllerAspect`.

添加的行为`aop:aspectj-autoproxy`是不够的。这告诉**已经成为应用程序上下文一部分的**bean如何进行切面，它不会自动包含它们。

# git - 在这种情况下，为什么结帐会覆盖我在 Git 中的本地更改？

> ID：12044716
> 
> 赞同：5
> 
> 时间：2012-08-20T20:33:54.630
> 
> 标签：git, version-control, merge, branch, branching-and-merging

假设我有一个分支 A，然后从那个分支 B。我在 A 上进行了一系列更改，然后签出 B 并执行`git pull`. 现在我对 B 进行了更改，但意识到它应该在 A 中。如果我现在尝试这样做`git checkout A`，我会在我触摸的文件中收到“您对以下文件的本地更改将被结帐覆盖”。

如果我只是在 B 中做了一个 git pull 并且从那以后没有触及 A 中的那个文件，为什么我的更改会被覆盖？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-20T20:36:49.863

您收到该消息的原因是分支 A 和分支 B 之间的基础文件（在您未提交的修改之前）*不同。如果文件相同，Git 将切换分支并在切换到分支 A 后保留相同的未提交修改。*

实现这些更改的一种方法是隐藏它们：

```
(on branch B)$ git stash
git checkout A
git stash pop 
```

如果有冲突的更改，您可能必须在此时解决冲突。如果有更改但它们不冲突，那么这将成功。

# jquery - IE8 中的下拉列表很窄，向上打开

> ID：12044718
> 
> 赞同：0
> 
> 时间：2012-08-20T20:34:00.560
> 
> 标签：jquery, asp.net, html, css, internet-explorer-8

> **可能重复：**
> [选择具有固定宽度的下拉菜单，在 IE 中截断内容](https://stackoverflow.com/questions/682764/select-dropdown-with-fixed-width-cutting-off-content-in-ie)

在 chrome 甚至 IE 9 中，下拉列表显示正常，下拉列表的宽度不会切断任何文本，当您打开下拉列表时，选项会正常显示，即它会打开下面的选项或朝向浏览器的底部。

在 IE8 中，由于某种原因，下拉列表非常窄，可以说列表向上打开，即选项触及浏览器窗口的顶部。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-08-20T20:46:06.550

您应该能够通过明确设置下拉菜单的宽度来修复文本的剪切。或者你可以申请一个`CssClass`.

DropDown 在它具有更真实状态的方向打开，可用于显示列表中的大多数项目。如果您滚动到页面顶部并单击下拉菜单，它将向底部显示，前提是该方向比顶部有更多空间。话虽如此，[您对此无能为力。](https://stackoverflow.com/questions/570642/height-of-an-html-select-box-dropdown/570651#570651)无法控制下拉列表中可滚动区域的高度。

# java - 字符串到布尔转换的最佳性能

> ID：12044721
> 
> 赞同：4
> 
> 时间：2012-08-20T20:34:05.403
> 
> 标签：java

从以下选项将字符串转换为布尔值时性能最佳。

1.  `boolean value = new Boolean("true").booleanValue();`
2.  `boolean value = Boolean.valueOf("true");`
3.  `boolean value = Boolean.parseBoolean("true");`

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-20T20:38:45.323

```
boolean value = new Boolean("true").booleanValue(); 
```

最糟糕的是，一直在创建新`Boolean`对象。顺便说一句`booleanValue()`，没有必要，拆箱将为您完成。

```
boolean value = Boolean.valueOf("true"); 
```

更好的是，使用缓存`Boolean`实例，但执行不必要的（虽然非常便宜）拆箱。

```
boolean value = Boolean.parseBoolean("true"); 
```

最好，没有任何浪费，几乎不使用原语，不涉及内存分配。顺便说一句，他们都委托给（Sun/Oracle）：

```
private static boolean toBoolean(String name) { 
  return ((name != null) && name.equalsIgnoreCase("true"));
} 
```

如果您是偏执狂，您可以创建自己的`toBoolean(String name)`不忽略案例 - 速度快得可以忽略不计：

```
boolean value = "true".equals(yourString); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T20:40:26.680

这是来源，看起来 Tomasz 击败了我来回答原因：

```
public static Boolean valueOf(String s) {
return toBoolean(s) ? TRUE : FALSE;
}
public static boolean parseBoolean(String s) {
    return toBoolean(s);
}
public Boolean(String s) {
this(toBoolean(s));
}
private static boolean toBoolean(String name) { 
return ((name != null) && name.equalsIgnoreCase("true"));
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T20:39:14.050

第二个和第三个是最好的选择，因为它们是**静态工厂方法**并且在内部可以重用引用。

查看`Boolean.valueOf("true")`和`Boolean.parseBoolean("true")`实现它们都做相同的事情（它们都调用`toBoolean(s);`），不同之处在于`valueOf`返回 Boxed 类型。

# ios - 对导航控制器上的图层进行四舍五入

> ID：12044722
> 
> 赞同：0
> 
> 时间：2012-08-20T20:34:15.123
> 
> 标签：ios, rubymotion

看到这篇关于圆形布局通常看起来更好的文章：[http ://blog.edwardmarks.com/post/9859783254/improve-usability-with-a-black-status-bar-and-rounded](http://blog.edwardmarks.com/post/9859783254/improve-usability-with-a-black-status-bar-and-rounded)

听起来不错，但实际上没有指向源代码的链接！我正在用 RubyMotion 编写我的应用程序。

我在设置 UIStatusBar 时没有遇到任何问题

```
 UIApplication.sharedApplication.setStatusBarStyle(UIStatusBarStyleBlackOpaque) 
```

但我似乎无法得到我想要的圆润边缘。我在我的 AppDelegate 中尝试了以下内容

```
 @window.layer.cornerRadius = 5
 @window.layer.masksToBounds = true 
```

但无济于事。当我在视图上执行此操作时，它不会围绕导航标题。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-04T23:15:41.410

尝试：@window = UIWindow.alloc.initWithFrame(UIScreen.mainScreen.bounds, cornerRadius: 5, maskToBounds: true)

# javascript - 为每个列表元素生成不同的、随机颜色的 DIV

> ID：12044730
> 
> 赞同：1
> 
> 时间：2012-08-20T20:34:38.810
> 
> 标签：javascript, jquery, html, css, dom

我想在每个列表元素后面生成三个随机彩色 div 框。我从这个开始，但是它不起作用 - DIV 似乎不可见:(

[http://jsfiddle.net/dgweu/1/](http://jsfiddle.net/dgweu/1/)

非常感谢帮助！

HTML

```
<div id="wrapper">
    <ul>
        <li>li1</li>
        <li>li2</li>
        <li>li3</li>
    </ul>
</div>​ 
```

JS

```
$("li").each(function(){
    var randomColor = "#"+Math.floor(Math.random()*16777215).toString(16);
        for (var i = 0; i < 3; i++) {
            stripe = document.createElement('div');
            stripe.setAttribute('style', 'width:100px; height:3px; background-color' + randomColor);  
            wrapper = document.getElementById("wrapper");
            wrapper.appendChild(stripe);
        }
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T20:40:45.643

div 不可见，因为您的 CSS 中存在语法错误。你缺少一个`:`after `background-color`。

要使 div 出现在`li`s 后面，您可以将 div 绝对定位，将`li`s 相对定位。

看看这个[**演示**](http://jsfiddle.net/dgweu/20/)。我也整理了你的 JS。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:40:06.723

您在 javascript 中的 background-color 元素之后错过了一个冒号。[jsFiddle](http://jsfiddle.net/dgweu/2/)

`stripe.setAttribute('style', 'width:100px; height:3px; background-color:' + randomColor);`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T20:42:59.087

您的想法是正确的，但是您的 JavaScript 中有一个简单的语法错误。

```
stripe.setAttribute('style', 'width:100px; height:3px; background-color:' + randomColor); 
```

您只是忘记了函数中的冒号 ( `:`) 。`background-color``setAttribute()`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T20:43:50.233

你的背景颜色后面缺少一个冒号

另一件事，你说你想在每个列表元素后面插入彩色 div。你的脚本只会在最后添加元素

我相信这就是你想要的
[http://jsfiddle.net/dgweu/4/](http://jsfiddle.net/dgweu/4/)
更频繁地使用 jquery，它非常方便。jQuery 的 insertbefore 方法让一切变得更简单你创建一个元素，查询它，然后在每个 li 元素之前插入它

# ruby - 在`class << self`中为eval提供回溯的正确方法是什么？

> ID：12044741
> 
> 赞同：3
> 
> 时间：2012-08-20T20:35:08.217
> 
> 标签：ruby, eval, backtrace

我正在使用一个在类上动态定义一些方法的 gem，类似于：

```
class << self
  some_strings.each do |string|
    eval <<-RUBY
      def #{string}
      ....
      end
    RUBY
  end
end 
```

在那些动态定义的方法中引发的任何异常都有无用的回溯；它们导致类似于`(eval):2`而不是实际的行号。

我想按照以下方式修改此代码：

```
eval <<-RUBY, nil, __FILE__, __LINE__ + 1 
```

...为了获得更好的回溯。

但是，与`class_eval`and不同`instance_eval`，plain old`eval`有一个可选`binding`参数，我不确定传递`nil`给它是否是个好主意，如上所示。

它似乎确实有效，并且[eval 的文档](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-eval)说绑定是可选的：

```
If binding is given, which must be a Binding object, the evaluation is 
performed in its context. 
```

尽管如此，我还是喜欢一些有用的解释，因为我还没有很好地掌握绑定和动态评估。

**动态评估`class << self`块内代码并确保有用的回溯的正确方法是什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-21T04:30:35.223

绑定并不是您正在寻找的解决方案，因为所有这些所做的只是更改的上下文，`eval`并且它已经在您想要的上下文中。

更好的做法是尽可能避免使用`eval`字符串。Ruby 有大量的元编程辅助方法，可以让您在除极少数情况外的所有情况下避免字符串评估。

在您的具体示例中，它看起来`Module#define_method`或`Object#define_singleton_method`可能有用。

# ios - iPhone app - 基于经度和纬度的距 离

> ID：12044745
> 
> 赞同：0
> 
> 时间：2012-08-20T20:35:15.300
> 
> 标签：ios, database, gps, latitude-longitude

看起来我将在一个 iPhone 应用程序上工作，该应用程序执行以下操作： - 获取当前位置（经度和纬度） - 查询包含坐标 + 该位置详细信息的私人数据库 - 从数据库中查找 5 个最近的记录位置并显示到 iPhone

本质上，我需要做的是星巴克应用程序的位置部分。

我的问题：

1）为了搜索 5 个位置，这是否意味着我还需要为服务器编写一个程序？如果是，如果要在 Apache 服务器上运行，使用什么语言（通常/最好）？

2）如果我想在地图上显示这些坐标，如果我不是自己设计地图（远离我的联盟），我将如何创建谷歌地图集成？

3) 目前我有一个 KML 文件中列出的坐标列表。如果要由 iPhone 应用程序和 HTML 页面查询，您建议我使用什么数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:51:12.093

您可以使用 iOS 的 mapkit 框架进行地图集成。将框架添加到您的项目中，创建一个以 MKMapView 作为主视图的新 viewController，并将视图控制器分配为 MapView 委托和数据源。

对于服务器端，只需使用带有 JSON/XML 的基于 REST 的 API 来与应用程序和服务器进行通信。服务器的后端对应用程序来说并不重要。在服务器端实现方面，做你知道的。可能是 PHP、ruby 等。

您可以基于这些 KML 文件创建数据库。将数据库字段分开后，您可以从应用程序获取用户的位置，将该信息发送到服务器，然后在您的服务器上，您将查询与用户位置相差一个增量范围内的位置。

# c# - 使用 Invoke 执行方法时遇到问题

> ID：12044746
> 
> 赞同：2
> 
> 时间：2012-08-20T20:35:18.717
> 
> 标签：c#, invoke

我有一个使用 Flash 控件播放电影的 C# 程序。我遇到的问题是，当我在电影完全加载之前尝试向 Actionscript 发送消息时收到错误消息。为了解决这个问题，我设置了一个计时器等待 1 秒再继续。这反过来又产生了一个不同的问题，因为我现在在不同的线程上运行。为了解决这个问题，我尝试在计时器事件处理程序中使用 Invoke，但由于某种原因它似乎并没有实际调用该方法。我可以看到进程正在使用 50% 的 cpu，但它永远不会从 Invoke 语句中返回。我查看了许多问题，并尝试了 4 或 5 种不同的方法来使用 Invoke 和 BegainInvoke 方法。我的应用程序的设计是我有一个实例化表单的主类。表单的构造函数加载并开始播放电影。主类设置计时器并尝试显示表单，这是问题发生的地方。

```
 public MyClass()
    {
        demoForm = new DemoForm();

        timer.Elapsed += new ElapsedEventHandler(engine);

        timer.Interval = 1000;
        timer.Enabled = true;

        for (int i = 0; ; i++)
            counter++;
    }

    private void engine(Object source, ElapsedEventArgs e)
    {

        timer.Enabled = false;

        if (demoForm.InvokeRequired)
        {
            demoForm.BeginInvoke(new MethodInvoker(sendNextMessage));
        }
        else
        {
            sendNextMessage();
        }

    }

    private void sendNextMessage()
    {
        // It never gets here!!!
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:38:15.120

这是一个无限繁忙的循环：

```
 for (int i = 0; ; i++)
        counter++; 
```

您的对象的构造永远不会完成，您可能会阻塞 GUI 线程，这将阻止任何消息被处理，包括`Invoke`.

您可能会看到 50% 的 CPU 使用率，因为您有一个双核处理器。其中一个核心处于繁忙循环中，不断增加计数器。另一个核心空闲。

您说您正在使用循环来防止应用程序终止，但这不是正确的方法。您应该`Application.Run`从 main 方法调用。当您创建新的 Windows 窗体项目时，Visual Studio 会自动为您添加此代码。

**建议**

Create two forms. Put the Flash control in its own form and show that form first. When that form is closed, you can then open the second form to show the rest of your application.

# javascript - 如何处理可排序手风琴中的项目发布事件？

> ID：12044752
> 
> 赞同：1
> 
> 时间：2012-08-20T20:35:45.457
> 
> 标签：javascript, jquery

在 jQuery UI 可排序手风琴中，如何处理项目发布事件？我试过这个：

```
$('#accordion').mousedown(function() {
    alert('Handler for .mousedown() called.');
}); 
```

但结果不正确。该项目始终粘在鼠标上...在鼠标按下时，弹出窗口会显示，如果您单击“确定”，该项目仍会粘在鼠标上。

```
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>jQuery UI Example Page</title>
        <link type="text/css" href="css/ui-lightness/jquery-ui-1.8.23.custom.css" rel="stylesheet" />
        <script type="text/javascript" src="js/jquery-1.8.0.min.js"></script>
        <script type="text/javascript" src="js/jquery-ui-1.8.23.custom.min.js"></script>

        <style>
        /* IE has layout issues when sorting (see #5413) */
        .group { zoom: 1 }
        </style>
        <script>
        $(function() {
            $( "#accordion" )
                .accordion({
                    header: "> div > h3"
                })
                .sortable({
                    axis: "y",
                    handle: "h3",
                    stop: function( event, ui ) {
                        // IE doesn't register the blur when sorting
                        // so trigger focusout handlers to remove .ui-state-focus
                        ui.item.children( "h3" ).triggerHandler( "focusout" );
                    }
                });
        });

        function show_progress() {
            var items = $('.group', '#accordion');
            for(var i=0; i<items.length; i+=1) {
                alert(items[i].innerHTML);
            }
        }

        </script>

        <div id="accordion">
            <div class="group">
                <h3><a href="#">Section 1</a></h3>
                <div>
                    <a href="#">Edit Item</a>
                    <span class="svr_rlv_url"></span>
                </div>
            </div>
            <div class="group">
                <h3><a href="#">Section 2</a></h3>
                <div>
                    <a href="#">Edit Item</a>
                    <span class="svr_rlv_url"></span>
                </div>
            </div>
            <div class="group">
                <h3><a href="#">Section 3</a></h3>
                <div>
                    <a href="#">Edit Item</a>
                    <span class="svr_rlv_url"></span>
                </div>
            </div>
            <div class="group">
                <h3><a href="#">Section 4</a></h3>
                <div>
                    <a href="#">Edit Item</a>
                    <span class="svr_rlv_url"></span>
                </div>
            </div>
        </div>

        <br/>

        <a href="#" onclick="show_progress();">CLICK</a>

        <script>
            $('#accordion').mousedown(function() {
              alert('Handler for .mousedown() called.');
            });
        </script>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:45:52.297

您不应该在脚本中间发出警报，这就是脚本中发生的情况：

*   鼠标按下 - 项目可拖动
*   警报 - javascript 暂停
*   您释放鼠标单击确定，但 javascript 不知道这一点，因为脚本已暂停
*   当警报关闭时，javascript 仍然认为您正在按住鼠标按钮，因此该项目会粘在您的鼠标上。

只需删除警报并`console.log('Handler for .mousedown() called.');`改为

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:51:28.093

您在 mousedown 中的警报正在弄乱脚本。无论如何，您不需要寻找 mousedown，您已经有一个停止回调函数附加到您的可排序初始值设定项。只需通过查找`ui.item`当前拖动的项目来添加您的代码。

我在这里设置了一个小提琴：http: [//jsfiddle.net/nQ4Zq/](http://jsfiddle.net/nQ4Zq/)

# php - 包括（）不工作

> ID：12044753
> 
> 赞同：0
> 
> 时间：2012-08-20T20:35:49.257
> 
> 标签：php, include

所以基本上我所有的文件都有`include('http://website.com/static/header.php')`nav.php和footer.php。它在我的主机上运行，​​但现在我自己在 Ubuntu 上托管它。它根本不起作用！在 php.ini`allow_url_include = On` 中可以并且是的，文件都在那里，并且案例是正确的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:53:18.743

对于您正在尝试做的事情，绝对不需要包含来自远程服务器的文件。我会告诉你**不**要这样做。如果您在问题中声明需要一些随机横幅，只需包含本地文件：

主文件

```
<?php
// some php code...

include('/path/to/file/banner.php'); 
```

横幅.php

```
<?php

$banners = array('banner1.jpg', 'banner2.jpg');

echo '<img src="' . $banners[mt_rand(0, 1)] . '" alt="some banner">'; 
```

# asp.net - 调整菜单以覆盖菜单宽度

> ID：12044754
> 
> 赞同：1
> 
> 时间：2012-08-20T20:36:02.717
> 
> 标签：asp.net, html, css

我有一个使用第三方控件的水平菜单。菜单的宽度是 100%，我必须安排菜单项，使它们覆盖页面的整个宽度并自动调整，但是如果屏幕很小并且如果屏幕以某种方式最后一个菜单项滚动到另一行大然后它们在同一条线上调整。下面是我的代码。如何制作菜单项，以便它们根据屏幕宽度进行相应调整。

```
 <div style="background-color:#8e2826; margin-left:15%; margin-right:17%;   color:#8e2826">
       <uc1:NavigationBar ID="NavigationBar" runat="server"  />
  </div> 
```

导航栏的代码是

```
<MainMenu ID="RadMenu1" runat="server" EnableRoundedCorners="false" EnableShadows="false"
            Height="25px" Width="100%" BackColor="#8e2826" BorderColor="#8e2826" BorderWidth="0" width="100%" >

                <MenuItem Text="Query" BackColor="#8e2826" ForeColor="#cea70b"  Font-Names="Calibri" width="12.5%" >

                <MenuItem>
                <MenuItem Text="Metrics" BackColor="#8e2826" ForeColor="#cea70b"  Font-Names="Calibri" width="12.5%" >

                <MenuItem>
                <MenuItem Text="Reports" BackColor="#8e2826" ForeColor="#cea70b"  Font-Names="Calibri" width="12.5%" >

                <MenuItem>
                <MenuItem Text="Exports" BackColor="#8e2826" ForeColor="#cea70b"  Font-Names="Calibri" width="12.5%" >

                <MenuItem>
                <MenuItem Text="Imports" BackColor="#8e2826" ForeColor="#cea70b"  Font-Names="Calibri" width="12.5%" >

                <MenuItem>
                <MenuItem Text="Web Service" BackColor="#8e2826" ForeColor="#cea70b"  Font-Names="Calibri" width="12.5%" >

                <MenuItem>
                <MenuItem Text="Versions &Fixes" BackColor="#8e2826" ForeColor="#cea70b" Font-Names="Calibri" width="12.5%" >

                <MenuItem>

            </Items>
        </MainMenu>

below is the style sheet

<style type="text/css">

 .style1
 {

    display:inline-block; zoom:1; *display:inline; 

 }
</style> 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-22T06:07:34.330

有一个 jQuery 插件，它可以为您服务。

[https://github.com/lukaszklis/AutoScalingMenu](https://github.com/lukaszklis/AutoScalingMenu)

# php - xampp 找不到我的主文件夹--Mac os x

> ID：12044756
> 
> 赞同：5
> 
> 时间：2012-08-20T20:36:19.917
> 
> 标签：php, netbeans, xampp

我正在尝试将 XAMPP 与用于 PHP 的 NetBeans 一起使用。当我将文件移动到 htdocs 文件夹时，一切正常。但是，当它们位于主文件夹中时，XAMPP 找不到它们。以下是我遵循的 XAMPP 的说明，但它不起作用。

```
 **Where should I put my Websites?**
     You can put your Websites in /Applications/XAMPP/htdocs/ 
     and access them via http://localhost/

     Or you put your Websites in the Sites-Folder in your Home 
     and access them via http://localhost/~leslie/. 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-20T22:24:47.713

您可以按照以下说明轻松更改文档根目录：

* * *

1.  找到名为`httpd.conf`. 我的位于此目录中：`/Applications/XAMPP/etc`
2.  找到写着：

    `DocumentRoot "/Applications/XAMPP/xamppfiles/htdocs"`

3.  将路径更改为您希望文件所在的位置。使用根目录的绝对路径（即`/`，如果您使用的是 Unix/Linux，则它应该以 a 开头，如果您使用的`\`是 Windows，它应该以 a 开头）。

4.  仍在`httpd.conf`文件中，向下滚动几行，直到看到以下文本：

    ```
    # This should be changed to whatever you set DocumentRoot to.
     <Directory "/Applications/XAMPP/xamppfiles/htdocs"> 
    ```

    并将路径替换为您在步骤 3 中键入的任何内容。

5.  **这部分很重要**。为了使这些更改发生，您需要重新启动 Apache（否则它将不起作用）。由于您使用的是 XAMPP，因此只需使用 GUI 来执行此操作（单击停止，然后单击 Apache 标签旁边的开始）。

现在，您可以将您的网页内容放在新目录中（即您的主文件夹）

* * *

* * *

另一方面，如果您想添加一个额外的目录来提供文件，请找到`httpd.conf`上面步骤 1 中提到的文件，然后添加以下行：

```
Alias /home ~/
<Directory ~/>
Order allow,deny
Allow from all
</Directory> 
```

**重新启动 Apache** 现在，您可以`localhost/home`在浏览器中访问，它会从您的主目录提供文件以及文档根目录中的文件（默认情况下为 htdocs，或者使用上述步骤将其更改为任何内容）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-04-09T07:04:01.643

如果您使用的是**mac osx 10.9.x**并使用 XAMPP 1.8.3（或更高版本）

Apple 决定删除内置的 Apache

1.  `/etc/extras/httpd-userdir.conf`在您的 XAMPP 应用程序文件夹中打开
2.  将 UserDir public_html 替换为 UserDir 站点
3.  替换`<Directory "/home/*/public">`为`<Directory "/Users/*/Sites">`
4.  打开`/etc/http.conf`
5.  搜索`httd-userdir.conf`您应该找到如下条目

    `#Include etc/extra/httpd-userdir.conf`

    将其替换为

    `Include etc/extra/httpd-userdir.conf`

6.  重启阿帕奇

玩得开心 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T23:09:36.610

您是否将其放入 ~/Sites 或 ~/Sites-Folder 中？

听起来你把它放进去~/

# ios - 将 tableview 用于文件夹系统

> ID：12044759
> 
> 赞同：0
> 
> 时间：2012-08-20T20:36:55.927
> 
> 标签：ios, cocoa-touch, core-data

我想在表格视图中加载员工。第一次加载我的表格视图时，我想加载所有没有主管的员工，然后，当我单击一个单元格（其中包含一个员工）时，我想加载那个特定员工的所有主管。我正在使用导航控制器，所以我想来回导航。我想我需要一遍又一遍地推送我的 tableview 的新实例。但问题是，我正在启动一个新的 Employee 对象，而且一遍又一遍，但我该如何管理呢？因为例如，我需要将 supervisorx 的 superviseex 保存到 supervisorx。我点击 supervisorx，一个新的 tableview 加载，其中没有员工。我在此表中添加了一个 superviseex，但这意味着我的员工对象现在是 superviseex。我该如何管理我可以将 superviseex 保存到 supervisorx，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:36:40.903

我不确定我是否理解，但我会尝试。

您正在推送视图控制器的新实例，而不是视图，因此您可以在控制器中有一个属性，说明它正在为哪个主管显示数据。如果它有 nil 作为主管，它可以检索所有没有主管的员工，如果给它一个有效的主管，它可以显示向该主管报告的员工。核心数据只是读取集合的内容（假设是一对多的关系），而不必获取任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T21:34:29.513

尝试在员工身上挂上一面旗帜，说明他们是主管。然后你可以用它来区分它们。

我会有另一个地方让我看到所有没有主管的非主管。

您还为员工建立了两个关系以指向员工实体一个称为主管，这是一个多对一的关系。反之是雇员，这是一对多的关系。

现在你需要 3 个控制器。

1.  应用程序的主根控制器，显示具有默认设置的默认表。（isSupervisor == YES 的所有员工）... 对表使用 NSFetchedResultController

2.  雇员表控制器。它接收一个 Employee 并在该员工之外创建一个 NSFetchedResultsController 以显示所有附加到该员工的员工。该表应使用该 NSFetchedResultsController 来显示其员工。

3.  员工信息控制器。显示员工数据并让您链接回他们的主管（用于员工信息）或他们的员工（员工表控制器的另一个副本）

导航为您保存控制器。所以你可以分配，初始化（如果你的非弧，则自动释放）并推送。

如果他们堆叠 100 件物品，那么他们将是处理它的人。

如果您想在他们关闭应用程序时清除堆栈，您可以手动设置 navigationController.viewControllers 数组以停用和激活应用程序。

除此之外。让控制器处理自己的数据访问。当您保存上下文项目时，您有两个选择。

选项 1\. 使用一个上下文（重要：将所有数据访问与上下文保持在同一个线程上。如果使用串行线程，则必须使用 @synchronized(managedObjectContext)

选项 2\. 实现 managedObjectContext 的保存通知以在对象上下文的其余部分中传播您的保存

**注意：**如果您使用多个线程，您可以使用 managedObjectContext.objectID 跨线程传递对象，此时您可以从中加载，`-[NSManagedObjectContext objectWithID:(NSManagedObjectID*)]`您可以在任何托管对象 ID 上执行此操作`managedObjectID.isTemporaryID == NO`

Ray 有一篇关于如何使用 NSFetchedResultsController 的精彩文章，甚至包括在 FetchedResults 发生变化时让表格优雅地更新。

这是文章[核心数据教程如何使用 NSFetchedResultsController的链接](http://www.raywenderlich.com/999/core-data-tutorial-how-to-use-nsfetchedresultscontroller)

# php - SQL 选择 rand 并更新结果

> ID：12044761
> 
> 赞同：0
> 
> 时间：2012-08-20T20:37:01.650
> 
> 标签：php, mysql, sql

我有这个横幅系统可以在我的网站上运行。我有一个 SQL 表，其中存储 id、链接、标题、打印和点击等内容。

所以，我需要在给定的页面上随机打印它们，并使用 prints + 1 值更新打印列（这是显示此横幅的次数）。我正在使用 2 个查询，一个用于选择，然后一个用于更新，但我知道只使用一个查询是可能的，但我听说 SQL + PHP 不太健康。但是，当我运行脚本时，它添加了两次值，应该多打印一次，它添加了 2。已经检查了脚本是否每个 id 运行两次，但不是，它运行正常。代码如下：

```
$query = 'SELECT * FROM banners WHERE (NOW() BETWEEN ban_start_date AND ban_final_date) AND ban_paid = "y" AND ban_active = "a" ORDER BY RAND() LIMIT 3';
    $query = mysql_query($query) or die(mysql_error());
    while($response = mysql_fetch_array($query)){
        extract($response); 
        $banners[] = array('id' => $ban_id, 'code' => $ban_code, 'img' => $ban_img, 'title' => $ban_title, 'link' => $ban_link, 'prints' => $ban_prints);
        $ban_qr = 'UPDATE banners SET ban_prints = ban_prints + 1 WHERE ban_id = "' . $ban_id . '"';
        $ban_qr = mysql_query($ban_qr) or die(mysql_error);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:35:15.387

您不能在一个查询中既选择行又更新它们。您可以更新您在一个查询中选择的所有行（使用`WHERE ban_id IN (list of IDs)`），但您仍然至少需要两个查询。

```
$query = "
    SELECT 
        `ban_id` AS `id`, 
        `ban_code` AS `code`, 
        `ban_img` AS `img`, 
        `ban_title` AS `title`, 
        `ban_link` AS `link`, 
        `ban_prints` AS `prints` 
    FROM
        `banners`
    WHERE 
        `ban_paid` = 'y'
    AND 
        `ban_active` = 'a'
    AND
        `ban_start_date` < CURRENT_TIMESTAMP
    AND
        `ban_final_date` > CURRENT_TIMESTAMP
    ORDER BY
        RAND()
    LIMIT 
        3
    ";

$result = mysql_query($query) or die(mysql_error());
while ($row = mysql_fetch_array($result)) {
  $banners[] = $row;
  $ids[] = $row['id'];
}

$query = "
    UPDATE 
        `banners` 
    SET 
        `ban_prints` = `ban_prints` + 1 
    WHERE 
        `ban_id` IN (" . implode(',', $ids) . ")
    ";

mysql_query($query) or die(mysql_error()); 
```

# javascript - 如何使用 Jquery 逐步获取 PHP 数据？

> ID：12044765
> 
> 赞同：0
> 
> 时间：2012-08-20T20:37:46.567
> 
> 标签：javascript, php, jquery, multi-step

我对带有 php 组合的 jquery 有一点问题。让我从代码开始。

**PHP代码：**

```
if ($_POST["request"]==10)
    progress();

function progress()
{
    $files = getfiles();
    $progress = 0;
    $progressRate = 100/$files->number;
    for ($i=0;$i<$files->number;$i++)
    {
        sendfile($files->location[$i]);
        $progress+=$progressRate;
        echo $progress;
    }
} 
```

**代码输出：** 例如 files->number = 2 那么输出将是 50 100。

**jQuery代码：**

```
jQuery.post("functions.php",{request:10},function(data){

            alert(data);

   }); 
```

**问题：**我想要的是先alert 50，然后alert 100，我的意思是当第一个循环在php中结束并回显第一个进度值时，jquery应该能够拦截它，但是jquery在整个循环之后警告数据完成，这意味着我在一个警报中得到 50100，jQuery 有什么办法可以处理这个吗？我知道还有其他解决方案使用 PHP 并生成例如隐藏 div 或属性中的循环数，然后在 jQuery 中使用循环，但我真的很想直接做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T20:45:06.347

这不是 AJAX 的工作方式。它发出一个请求并对响应执行“某些操作”，就像浏览器在导航到 URL 时所做的那样。

PHP 脚本将在服务器端执行，将结果打印到“屏幕”并将它们作为响应发回。

如果要返回多个变量，则应将它们作为 JSON 数据返回并在 javascript 中解析 JSON 字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:47:31.293

jQuery（实际上是 AJAX 默认情况下）仅在服务器完成请求后才返回响应。

因此，无法对 php 页面执行单个请求并获得多个响应。一种方法是使用带有[上传进度](http://php.net/manual/en/session.upload-progress.php)支持的 php，但我怀疑这实际上会对您的情况有所帮助，因为它仅用于上传文件。

# javascript - 即使域不匹配，也可以从 iframe 访问父级？

> ID：12044771
> 
> 赞同：0
> 
> 时间：2012-08-20T20:38:36.733
> 
> 标签：javascript, dns

我有一个正在尝试访问父级的 iframe 中运行的 javascript 脚本，但出现以下错误：

```
Unsafe JavaScript attempt to access frame with URL mysite.com from frame with URL myothersite.com?. Domains, protocols and ports must match. 
```

iframe html 位于不同的域中，但我认为这无关紧要。这是生成 JS 错误的代码：

```
var parent_site = parent.document; 
```

有没有解决的办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:44:01.050

如果父域是 iframe 域的尾随部分（即 iframe 是 child.parent.com，父域是 parent.com），您可以设置 iframe 文档的域`document.domain = "parent.com"`并避免该问题。

如果父域和 iframe 的域不相关，则无法解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:45:39.523

对CORS（跨源资源共享）做一些研究：http: [//www.w3.org/TR/cors/](http://www.w3.org/TR/cors/)

您基本上需要将其添加到父域的 .htaccess 中：

```
Header set Access-Control-Allow-Origin *
Header set Access-Control-Allow-Headers x-requested-with 
```

理想情况下，您应该将 替换`*`为您希望允许访问的域。

# python - 如何在 Celery 任务中使用 Flask-SQLAlchemy

> ID：12044776
> 
> 赞同：49
> 
> 时间：2012-08-20T20:38:53.943
> 
> 标签：python, flask, celery, flask-sqlalchemy

我最近切换到 Celery 3.0。在此之前，我使用[Flask-Celery](https://github.com/ask/flask-celery/)将 Celery 与 Flask 集成。虽然它有很多问题，比如隐藏一些强大的 Celery 功能，但它允许我使用 Flask 应用程序的完整上下文，尤其是 Flask-SQLAlchemy。

在我的后台任务中，我正在处理数据和 SQLAlchemy ORM 来存储数据。Flask-Celery 的维护者已经放弃了对该插件的支持。该插件在任务中腌制 Flask 实例，因此我可以完全访问 SQLAlchemy。

我试图在我的 tasks.py 文件中复制这种行为，但没有成功。您对如何实现这一目标有任何提示吗？

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-01-03T20:07:57.170

### 更新：我们已经开始使用更好的方法来处理应用程序的拆卸和设置，基于[最近的烧瓶文档中](https://flask.palletsprojects.com/en/1.1.x/patterns/celery/)描述的模式。

扩展程序.py

```
import flask
from flask.ext.sqlalchemy import SQLAlchemy
from celery import Celery

class FlaskCelery(Celery):

    def __init__(self, *args, **kwargs):

        super(FlaskCelery, self).__init__(*args, **kwargs)
        self.patch_task()

        if 'app' in kwargs:
            self.init_app(kwargs['app'])

    def patch_task(self):
        TaskBase = self.Task
        _celery = self

        class ContextTask(TaskBase):
            abstract = True

            def __call__(self, *args, **kwargs):
                if flask.has_app_context():
                    return TaskBase.__call__(self, *args, **kwargs)
                else:
                    with _celery.app.app_context():
                        return TaskBase.__call__(self, *args, **kwargs)

        self.Task = ContextTask

    def init_app(self, app):
        self.app = app
        self.config_from_object(app.config)

celery = FlaskCelery()
db = SQLAlchemy() 
```

应用程序.py

```
from flask import Flask
from extensions import celery, db

def create_app():
    app = Flask()

    #configure/initialize all your extensions
    db.init_app(app)
    celery.init_app(app)

    return app 
```

一旦你以这种方式设置了你的应用程序，你就可以运行和使用 celery，而无需在应用程序上下文中显式运行它，因为如果需要，你的所有任务都将自动在应用程序上下文中运行，而你没有明确担心任务后拆解，这是一个需要管理的重要问题（请参阅下面的其他回复）。

### 故障排除

那些不断获得的人`with _celery.app.app_context(): AttributeError: 'FlaskCelery' object has no attribute 'app'`确保：

1.  将`celery`导入保持在`app.py`文件级别。避免：

应用程序.py

```
from flask import Flask

def create_app():
    app = Flask()

    initiliaze_extensions(app)

    return app

def initiliaze_extensions(app):
    from extensions import celery, db # DOOMED! Keep celery import at the FILE level

    db.init_app(app)
    celery.init_app(app) 
```

2.  在你之前开始你的芹菜工人`flask run`并使用

```
celery worker -A app:celery -l info -f celery.log 
```

注意`app:celery`，即从 加载`app.py`。

您仍然可以从扩展导入来装饰任务，即`from extensions import celery`.

### 下面的旧答案仍然有效，但不是一个干净的解决方案

我更喜欢通过创建一个单独的文件来在应用程序上下文中运行所有 celery，该文件使用应用程序的上下文调用 celery.start()。这意味着您的任务文件不必到处都是上下文设置和拆卸。它也很适合烧瓶“应用程序工厂”模式。

扩展程序.py

```
from from flask.ext.sqlalchemy import SQLAlchemy
from celery import Celery

db = SQLAlchemy()
celery = Celery() 
```

任务.py

```
from extensions import celery, db
from flask.globals import current_app
from celery.signals import task_postrun

@celery.task
def do_some_stuff():
    current_app.logger.info("I have the application context")
    #you can now use the db object from extensions

@task_postrun.connect
def close_session(*args, **kwargs):
    # Flask SQLAlchemy will automatically create new sessions for you from 
    # a scoped session factory, given that we are maintaining the same app
    # context, this ensures tasks have a fresh session (e.g. session errors 
    # won't propagate across tasks)
    db.session.remove() 
```

应用程序.py

```
from extensions import celery, db

def create_app():
    app = Flask()

    #configure/initialize all your extensions
    db.init_app(app)
    celery.config_from_object(app.config)

    return app 
```

RunCelery.py

```
from app import create_app
from extensions import celery

app = create_app()

if __name__ == '__main__':
    with app.app_context():
        celery.start() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-06-22T07:55:04.347

~~我使用[Paul Gibbs 的答案](https://stackoverflow.com/a/14146403/1198943)有两个不同之处。我使用了worker_process_init 而不是task_postrun。而不是 .remove()，我使用了 db.session.expire_all()。~~

~~我不是 100% 确定，但据我了解，它的工作方式是当 Celery 创建一个工作进程时，所有继承/共享的数据库会话都将过期，并且 SQLAlchemy 将根据需要创建该工作进程独有的新会话。~~

~~到目前为止，它似乎已经解决了我的问题。使用 Paul 的解决方案，当一名工作人员完成并删除会话时，使用同一会话的另一名工作人员仍在运行其查询，因此 db.session.remove() 在使用时关闭了连接，给我一个“与 MySQL 的连接丢失查询期间的服务器”异常。~~

~~感谢保罗引导我朝着正确的方向前进！~~

没关系，那没有用。如果 Celery 调用它，我最终在我的 Flask 应用程序工厂中有一个参数不运行 db.init_app(app) 。相反，在 Celery 分叉后，工人们会调用它。我现在在我的 MySQL 进程列表中看到了几个连接。

```
from extensions import db
from celery.signals import worker_process_init
from flask import current_app

@worker_process_init.connect
def celery_worker_init_db(**_):
    db.init_app(current_app) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-08-21T12:42:08.947

在您的 tasks.py 文件中执行以下操作：

```
from main import create_app
app = create_app()

celery = Celery(__name__)
celery.add_defaults(lambda: app.config)

@celery.task
def create_facet(project_id, **kwargs):
    with app.test_request_context():
       # your code 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-06T04:40:11.557

```
from flask import Flask
from werkzeug.utils import import_string
from celery.signals import worker_process_init, celeryd_init
from flask_celery import Celery
from src.app import config_from_env, create_app

celery = Celery()

def get_celery_conf():
    config = import_string('src.settings')
    config = {k: getattr(config, k) for k in dir(config) if k.isupper()}
    config['BROKER_URL'] = config['CELERY_BROKER_URL']
    return config

@celeryd_init.connect
def init_celeryd(conf=None, **kwargs):
    conf.update(get_celery_conf())

@worker_process_init.connect
def init_celery_flask_app(**kwargs):
    app = create_app()
    app.app_context().push() 
```

*   在 celeryd init 更新 celery 配置
*   使用您的烧瓶应用程序工厂来初始化所有烧瓶扩展，包括 SQLAlchemy 扩展。

通过这样做，我们能够维护每个工作人员的数据库连接。

如果你想在烧瓶上下文下运行你的任务，你可以子类化`Task.__call__`：

```
class SmartTask(Task):

    abstract = True

    def __call__(self, *_args, **_kwargs):
        with self.app.flask_app.app_context():
            with self.app.flask_app.test_request_context():
                result = super(SmartTask, self).__call__(*_args, **_kwargs)
            return result

class SmartCelery(Celery):

    def init_app(self, app):
        super(SmartCelery, self).init_app(app)
        self.Task = SmartTask 
```

# jquery - JQuery 小部件 - 记住位置 (Cookies)

> ID：12044779
> 
> 赞同：0
> 
> 时间：2012-08-20T20:39:31.293
> 
> 标签：jquery, cookies

所以我有这个来自 NetTuts 的脚本，我已经修改了它，它完全可以工作，因为现在可以在列周围移动小部件。我现在需要的是它使用 jQuery.cookie 保存小部件位置，因此当页面刷新时，小部件的顺序正确。

可悲的是，我完全不知道从哪里开始！我有一些使用 jQuery.cookie 保存小部件是打开还是关闭的经验，但我不确定在这个 jQuery 代码中将它粘贴在哪里，所以它会记住小部件的顺序。

JQuery 代码在这里：

[http://pastebin.com/di94EaGR](http://pastebin.com/di94EaGR)

你可以在这里看到正在工作的小部件：

[http://dev.evaske.com/HXWP/](http://dev.evaske.com/HXWP/)

提前感谢您的任何输入:)

# c#-4.0 - 如何在 c#.net 中运行批处理文件的输出

> ID：12044784
> 
> 赞同：0
> 
> 时间：2012-08-20T20:39:43.210
> 
> 标签：c#-4.0

我正在尝试安装一个 Windows 安装程序文件，即包含 DOS 命令的 BAT 文件。我想运行 BAT 文件并从 BAT 文件中提取 DOS 命令并重新运行 DOS 命令，以便安装正确的驱动程序。我确实搜索了很多，但我无法找到解决方案。我能够运行 .exe 文件。

这是我的代码-

```
ProcessStartInfo aProcessInfo;
Process aProcess = new Process();

aProcessInfo = new ProcessStartInfo(command);
aProcessInfo.UseShellExecute = false;             
aProcessInfo.RedirectStandardOutput = true;
aProcessInfo.RedirectStandardError = true;
aProcessInfo.CreateNoWindow = true;

aProcess = Process.Start(aProcessInfo);
aProcess.WaitForExit(); 
```

我的 BAT 文件是 install.bat；当我点击编辑打开 DOS 命令时

分类

msiexec /quiet /passive /i lcild_v207230.msi

在记事本中。

谁能解释我如何从 BAT 文件中提取和安装驱动程序。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:12:31.130

好吧，这个只是突然出现在我的脑海中。您可以使用 File.Read 或 StreamReader 类将 BAT 文件作为文本文件读取，然后读取具有实际安装命令的行，即带有 msiexec 的行，然后使用 ProcessStartInfo 类启动“msiexec”。确保传递该命令所需的任何参数，显然是文件名。看看这是否有效。

# javascript - goog.ui.ProgressBar 奇怪的行为

> ID：12044786
> 
> 赞同：0
> 
> 时间：2012-08-20T20:39:51.717
> 
> 标签：javascript, google-closure-library

我必须加载一个非常大的 JSON 对象并执行各种昂贵的过程。出于这个原因，我展示了一个总共增加五次的进度条。如果我必须加载 10000 个项目，它将每 2000 次更新一次，等等。

问题是效果不可见，因为所有堆栈都是在整个函数完成后执行的，而不是在每 20% 的过程中更新进度条。不管我尝试加载 10000 个项目还是 200 万个项目，都会发生同样的事情，并且从控制台日志之间的计算延迟来看，肯定有足够的处理时间来显示可见的进度效果。也许我不了解javascript（我知道这不是这样做的方法）。您如何跟踪昂贵的流程并正确制作可见的进度条效果？

[这是.js文件。](http://www.instantrepair.co.uk/ajax/niuzly.base.page.index.js)

登录

用户名：管理员

密码：testit

```
 var initItems = function(publicationItems) {
    var publications = new Array();
    var numberOfItems = goog.object.getCount(publicationItems);
    var minStep = 20;
    var currentProgress = 20;
    var progressBarStep = parseInt(numberOfItems / 5);
    var i = 0;
    goog.object.forEach(publicationItems, function() {
            var currentName = publicationItems.name;
            var currentCat = publicationItems.categories;
            // Insert clear div to break line after every 5 items.
            if (i % 5 == 0 && i != 0)
                publications.push(this.clear);
            if(i % progressBarStep == 0)  
            {
                progressBar.setValue(currentProgress);
                console.log(i + ' ' + progressBarStep + ' ' + currentProgress + ' ' + progressBar.getValue());
                currentProgress += minStep;             
            }
            i++;
            publications.push(goog.dom.createDom('div', {
            'style' : 'width:' + this.currentPublicationDimension + 'px;height:' +
            this.currentPublicationDimension + 'px;border:1px solid #B3B3B3;' +
            'float: left;margin-top: 5px;background-color: #FCFCFC;' +
            'max-width:' + this.currentPublicationDimension + 'px;max-height:' +
            this.currentPublicationDimension + 'px;_height:' +
            this.currentPublicationDimension +
            'px;_width:' + this.currentPublicationDimension + 'px;margin-left:' +
            this.publicationLeftMargin + 'px;',
            'class' : 'publication'
            }, currentName, currentCat));
        }, this);
        return publications;
    }; 
```

以及调用此函数的上下文：

```
// Bind COMPLETE event listener to ajaxHandler.
goog.events.listen(ajaxHandler, goog.net.EventType.SUCCESS,
goog.bind(function(e) {
    //goog.style.showElement(progressBarContainer, false);
    goog.dom.append(this.mainViewPublications, initItems.call(this, e.target.getResponseJson()));
}, this), false, this); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T16:18:32.170

问题是 JavaScript 是单线程的，并且首先尝试执行计算。ProgressBar 是异步的，只有在线程不忙时才会更新。

您可以使用如下回调

```
function a () {
  /* do one iteration */
  progressBar.setValue(currentProgress);
  goog.Timer.callOnce(a, 10);
} 
```

问题在于，您不能将参数传递给函数，而必须使用全局变量（或至少是“对象”范围的变量）。

我目前有同样的问题，还没有找到一个很好的解决方案。所以这是第一种方法。如果我找到另一个解决方案，我会在这里更新。

# sql-server-2008 - SQL Server 视图中的列名冲突加入数据库体系结构

> ID：12044792
> 
> 赞同：0
> 
> 时间：2012-08-20T20:40:30.843
> 
> 标签：sql-server-2008, database-design, sql-view

首先，对不起我的写作方式，这里的英语不好。

请考虑以下情况：

我使我的数据库架构结合了这样的视图：

*   实体`City`具有列 { `city_id, city_name, state_name, ...`}
*   实体`User`具有列 { `user_id, user_name, user_login, city_id, ...`}

每个实体都有一个视图，该`city`视图没有任何其他实体的 FK，所以它是一个简单的选择。

`User`实体对实体有一个 FK `city`，因此它与`city`视图中的实体进行连接。

如下例：

```
create view vw_user as
    select user.user_id,
           user.user_name,
           user.user_login,
           vw_city.*
    from user (nolock)
    inner join vw_city (nolock) on vw_city.city_id = user.city_id
go 
```

因此，如果您有一个像 user_access 这样的实体，并且对用户有一个 FK，那么 的视图`user_access`将具有到 的内部连接`vw_user`，并且它将显示来自`user`和`city`实体的所有列。

最后，我只是对视图进行查询，它会返回包含所有外部引用的完整实体。

这很好用，并且使维护过程变得非常容易，如果需要对其中一个实体进行任何更改，我有一个存储过程可以重新编译所有视图。

但是，它有一个问题，我在一个非常糟糕的情况下发现了这个，使用这种架构的系统已经运行得非常快速和流畅，例如我需要加入两个共享实体城市的实体，所以它会生成一个列冲突，SQL Server 不允许在视图中这样做，您可以毫无问题地执行冲突查询，但不能在视图中执行此操作。

所以，这是我的问题，我需要找到解决这个问题的方法，但我自己找不到答案。

我最终做的唯一一件事就是制作一个硬编码的视图，并重命名了列。

但我想要一个针对整个架构的解决方案，是永久性的，比如升级。

代码中遵循此体系结构，使用 C#，因此依赖于列名。

当我从查询中读取数据时，我需要从列名中获取数据，因此此代码可以与其他类重用，在 c# 代码中执行与视图在查询中所做的相同的事情。

因此，用序数获取数据是不可能的。

有任何想法吗？

谢谢，对不起，但这很难描述。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T18:15:41.017

好吧，只是为了结束主题，正如 SMC 建议的那样，我使用别名来识别查询中的列和表。

所以查询现在看起来像这样 - 使用主题中的示例：

```
Select 1.user_id as 1,
       1.user_name as 2,
       1.user_login as 3,
       1.city_id as 4,
       2.city_id as 5,
       2.city_name as 6,
       2.state_name as 7
from user as 1
inner join city as 2 on 2.city_id = 1.city_id 
```

请注意第 4 列和第 5 列，它们现在不会发生碰撞 :)

文我的应用程序进行此查询，他还使`Classes`相关人员知道他们在当前查询中的别名。

它工作正常，解决了我的问题，我不再需要使用视图。

最后，应用程序比以前更快。

就是这样:)希望它可以帮助任何人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:01:23.657

这是因为`Column Name`每个`View`or中的 都`Function`必须是唯一的。选择列名称时需要具体。使用别名，然后引用列名称。

您尝试在语句中多次使用单个列名创建 VIEW。

删除 * 并给出明确的列名

# eclipse - 在 Eclipse 中跨项目自动导出 jar

> ID：12044799
> 
> 赞同：0
> 
> 时间：2012-08-20T20:40:50.297
> 
> 标签：eclipse, google-app-engine, jar, export

我有一个 Google Web Toolkit 项目，为此我在构建路径中包含了第二个项目。这个另一个项目有很多我常用的函数和类。构建项目工作正常，但为了避免运行时错误，我必须将第二个项目放入 GAE 项目的 WAR 文件夹中。将第二个项目 jar/导出到第一个项目的过程是一个手动过程，我在 Eclipse 中右键单击。

有没有办法将第二个项目的 jar/导出到 WAR 的过程自动化到第一个位置？

我会用 ANT 脚本来做这件事吗？或者有没有办法可以在 Eclipse 本身内完成。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:58:14.997

你在找一些阅读伙伴:)

第 1 步：创建第一个项目的 JAR（阅读**[此](http://www.avajava.com/tutorials/lessons/how-do-i-create-a-jar-file-using-ant.html)**内容）。在`jar`任务中，您可以将 GAE 文件夹 lib 的路径放置为如下`destfile`所示：

```
<target name="jar">
        <jar basedir="bin" destfile="../GAE_PROJECT/war/WEB-INF/lib/${project-name}.jar">
            <manifest>
                <attribute name="Built-By" value="${builder}" />
                <attribute name="Built-On" value="${build-info.current-date}" />
                <attribute name="Built-At" value="${build-info.current-time}" />
            </manifest>
        </jar>
    </target> 
```

**[第 2 步：为您的 GAE 项目创建 WAR（在此处](https://developers.google.com/appengine/docs/java/tools/ant)**阅读官方文档）。该文档显示了如何包含 lib 中的 jar：

```
 <fileset dir="war/WEB-INF/lib">
      <include name="**/*.jar" />
 </fileset> 
```

# html - 响应式网页设计和调整图像大小

> ID：12044801
> 
> 赞同：11
> 
> 时间：2012-08-20T20:41:03.893
> 
> 标签：html, css, image, responsive-design

响应式网页设计适用于除图像之外的大多数 html 元素。我发现它一团糟。调整视口大小时，不能在图像上使用调整大小百分比，因为它将占用父元素的宽度和高度。您需要为图像设置固定的宽度和高度......或者我错过了什么？

那么，您究竟如何进行响应式设计，其中包含容器元素/父级将拉伸到其原生宽度以上并缩小到其原生宽度以下的图像？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-08-20T20:48:55.877

在响应式设计中完成的事情是在你的 css 中为图像和其他一些元素设置它：

```
img, embed, object, video {
max-width:100%;
    height:auto;
} 
```

然后在您的 html 中，图像仅占用其容器的大小。

您不设置图像大小本身，只是让它自己增长/缩小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:49:53.540

好吧 - 你可以写： .selector img{width: 100%; height: auto;} 然后使用它所在的 div 的大小来确定它的比例。或者您也可以将图像设置为背景并使用类似的方法，甚至可能会弄乱背景大小：封面。我会做一个jsfiddle ...

```
.image-w img {
  display: block;
  width: 100%;
  height: auto;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-04T14:18:39.157

我在我的网站上所做的是：

页面内容....

```
div class=picr>

img src="/Images/Home/MountainPine.jpg" alt="Mountain Pine" id="mountainpine" >

<p>Caption about mountain pine</p>

/div> 
```

然后在 CSS

```
pic, pic6 {
    float: left;
    }

...

.pic, .picr {
    width: 37%;
    }

#content  img {
    width: 100% ;
    } 
```

所以 div 类被样式化了，图片被设置为填充它。通过使用 div，我也可以设置样式

在 .pic 类中与正文区分开来。

# java - 调用和等待与子类交互

> ID：12044803
> 
> 赞同：0
> 
> 时间：2012-08-20T20:41:06.927
> 
> 标签：java, swing, try-catch, invokelater, invokeandwait

我发现了很多关于稍后调用以及在整个站点调用和等待的好例子。但是我遇到的问题是我想从一个由 main 方法调用的类中获得响应

任何人都可以提供一些主要方法调用子方法的代码，以查看它是如何使用 invoe 和 wait 方法构造的吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:49:58.903

[SwingUtilities#invokeAndWait 或 invokeLater](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingUtilities.html#invokeAndWait%28java.lang.Runnable%29)将 a`Runnable`作为参数，因此您无法返回结果。
查看[SwingWorkers](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)，您可以在其中在后台线程中执行操作并获取结果以更新 EDT 内的 UI

# forms - 为什么我的访问表单失去焦点

> ID：12044804
> 
> 赞同：1
> 
> 时间：2012-08-20T20:41:14.023
> 
> 标签：forms, ms-access, lost-focus

我有一个用于输入客户信息的 Microsoft Access 表单：

名字
姓氏
等。

我的问题是当我离开访问表单以查看需要输入的信息时，焦点在访问中丢失了。我需要用鼠标单击表单以重新获得焦点。

这很烦人！

这里有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:51:14.150

据我所知，当您单击对象之外的任何内容时，访问对象的焦点就会丢失……包括表单。

我可以建议你两种方法来解决这个问题：

1.  在表单中使用控件（组合框或列表框），以便查看所需的数据。
2.  使用“弹出”表单：您可以创建一个包含所需数据的表单，并在主表单中使用一个按钮来打开此“弹出”表单。如果您希望表单作为弹出窗口打开，您可以在 VBA 中指定......如果我没记错的话，是这样的：

    ```
    ...
    docmd.openform("frmYourForm",,,acDialog)
    ... 
    ```

希望这可以帮助你

# javascript - 在进行异步 AJAX 调用后运行函数，传递变量

> ID：12044805
> 
> 赞同：2
> 
> 时间：2012-08-20T20:41:17.847
> 
> 标签：javascript, jquery

我正在处理的一些代码有问题。我有一个通用函数 ( `ajaxContent`)，它可以从多个方面使用。我需要的是在进行 AJAX 调用之后运行一个函数，但是我需要传递一些我在调用之前拥有的数据（所以不是从 AJAX 调用返回的数据。

```
function ajaxContent(url, id, target, data, callbackFunction) {

  $.ajax({
    async : true,
    ....    
    complete: function(){
      if(typeof callbackFunction == "function"){
        callbackFunction(); // function get's executed here, lead_id is not available
      }
    }
  });
}    

$(document).on("click", "#something", function(){
  var leaf_id = $(this).attr('rel');

  ajaxContent(url, id, target, data, function(leaf_id){

    url = "/path/" + leaf_id;
    window.location = url;

  })
})

$(document).on("click", "#action", function() {

    ajaxContent(url, id, target, data, function(){

        if ($(this).attr('rel') == "M_0") // $(this).attr('rel') not available here, so need to pass through some way
            $('#treedata').css('background', 'url(/img/rotonde.png) 50% 50% no-repeat');
  });

}); 
```

我也许可以使用类似的东西

```
function ajaxContent(url, id, target, data, callbackFunction, varA, varB, varC, varD) { 
   callbackFunction(varA, varB, varC, varD);
} 
```

和

```
ajaxContent(url, id, target, data, function(varA){
}, varA, varB, varC, varD)` 
```

但不是真正可扩展的。

我希望这很清楚:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:44:38.710

`leaf_id`未定义，因为您在调用`callbackFunction();`.

您可以通过回调传递变量，但您需要一直传递它，这是您如何编写代码以使其`leaf_id`传递的方法：

```
function ajaxContent(url, id, target, data, callbackFunction, leaf_id) {
    $.ajax({
        async : true,
    ....        
        complete: function(){
          if(typeof callbackFunction == "function"){
            callbackFunction(leaf_id);
          }
        }
    });
}

ajaxContent(url, id, target, data, function(leaf_id){
    url = "/path/" + leaf_id;
    window.location = url;
}, $(this).attr('rel')); 
```

[http://jsfiddle.net/qaWNp/2/](http://jsfiddle.net/qaWNp/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:57:25.077

在您现在答案中的代码中，是处理程序函数`leaf_id`内的局部变量。`document.ready()`因此，它在该上下文之外不可用。

你有几个选择来解决这个问题：

1.  您可以在处理函数中移动 ajaxContent 函数的定义，`document.ready()`以便它能够看到 leaf_id。

2.  您可以创建`leaf_id`一个全局变量，以便可以从任何地方访问它。

3.  您可以将`leaf_id`ajaxContent 作为函数参数传递给。

如果没有更多关于您正在做什么的上下文，并且因为这是一个仅与特定操作相关的瞬态值，我认为最好的选择是＃3：

```
function ajaxContent(url, id, target, data, leafID, callbackFunction) {

    $.ajax({
        async : true,
    ....        
        complete: function(){
          if(typeof callbackFunction == "function"){
            // you can access any of the ajaxContent function arguments here
            callbackFunction(leafID);
          }
        }
    });
}       

$(document).on("click", "#something", function(){
  var leaf_id = $(this).attr('rel');

  ajaxContent(url, id, target, data, leaf_id, function(leafID){

    url = "/path/" + leafID;
    window.location = url;

  })
}) 
```

或者，如果您有很多变量要传递，您可以创建一个空对象，然后将每个变量作为该对象的属性，然后将单个对象传递给 ajaxContent 和回调，如下所示：

```
function ajaxContent(url, id, target, data, settings, callbackFunction) {

    $.ajax({
        async : true,
    ....        
        complete: function(){
          if(typeof callbackFunction == "function"){
            // you can access any of the ajaxContent function arguments here
            callbackFunction(settings);
          }
        }
    });
}       

$(document).on("click", "#something", function(){
  var args = {};
  args.leafID = $(this).attr('rel');

  ajaxContent(url, id, target, data, args, function(settings){

    // access args.leafID here
    url = "/path/" + leafID;
    window.location = url;

  })
}) 
```

请注意，在我的代码示例中，我将参数命名为与其他变量不同的名称，以避免混淆哪个是哪个。

# python - python正则表达式强制换行

> ID：12044811
> 
> 赞同：1
> 
> 时间：2012-08-20T20:42:00.133
> 
> 标签：python, regex

为什么我的正则表达式在结束标记之前添加换行符？

```
string = '\s ప్రపంచ ప్రారంభం'
re.sub(r'\\s (.*)', r'<h3>\1</h3>', string) 
```

我得到了什么

```
<h3>ప్రపంచ ప్రారంభం
</h3> 
```

我想要的是

```
<h3>ప్రపంచ ప్రారంభం</h3> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:51:46.337

查看字符串的文本部分，确保没有任何内容创建换行符。当我尝试时：

```
s = '\s hi world'
re.sub(r'\\s (.*)', r'<h3>\1</h3>', s) 
```

我有：

```
'<h3>hi world</h3>' 
```

我使用的是 Python 2.7.3。

# c1-cms - 复合 C1 页面无法保存在托管站点上

> ID：12044814
> 
> 赞同：0
> 
> 时间：2012-08-20T20:42:26.163
> 
> 标签：c1-cms

之前问了一个问题，因为太含糊而关闭了：[Composite C1 pages cannot be saved](https://stackoverflow.com/questions/12028959/composite-c1-pages-cannot-be-saved)

我现在有更多关于这个问题的信息：我在 Composite C1 中保存页面时遇到问题。它工作了很长时间。现在，当我在经常更改的页面上单击保存并发布时，它会弹出一条消息，提示“保存资源？-'页面名称'已被修改。保存更改？” 我单击是，但保存和发布按钮一直处于活动状态。它不会保存我的更改。

我无法在本地运行 i Visual Studio 时重现该错误，但是当我登录到托管站点上的管理面板时，我遇到了很多问题。C1 中的日志没有显示任何错误，并且页面中没有给出验证错误的字段。

我可以更改 web.config 或其他地方的设置以打开更广泛的登录或在保存时设置超时吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-02T16:20:42.770

对于遇到此问题的其他人，这是作者的博客文章（8 月 31 日）（带有补丁！）：

[复合保存问题 - 补丁](http://community.composite.net/Blog/2012/08/31/Patch-available-fixing-NET-45-issues)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-26T03:39:59.090

这可能与 .net 4.5 有关。我最近安装了 4.5，我有多个网站停止保存。如果您最近安装了 .net 4.5，您可以尝试卸载它，或者希望他们尽快发布修复程序。

编辑：我可以确认 .net 4.5 是我的问题，卸载它后，我所有的 Composite C1 网站都再次保存！

# c++ - 纯虚方法称为错误

> ID：12044819
> 
> 赞同：3
> 
> 时间：2012-08-20T20:42:32.473
> 
> 标签：c++, exception, virtual-functions

我有以下定义：

```
class PartitioningMethod {
public:
  virtual void addConstraints(ConstraintManager& cm) = 0;
  virtual bool hasMoreConstraints() = 0;
  virtual void setQuery(const Query& q) = 0;
  virtual ~PartitioningMethod(){ }
};

class Random : public PartitioningMethod {
private:
  vector< ref<Expr> > constraints;
  vector< ref<Expr> >::iterator it;
  vector< ref<Expr> >::iterator end;
  int numConstraints;
  RNG theRNG;

public:
  void setQuery(const Query& q) { 

    constraints.clear();

    //Set random number
    //srand ( unsigned ( time (NULL) ) * theRNG.getInt32() );
    srand ( theRNG.getInt32() );

    //Copy constraints    
    copy(q.constraints.begin(),q.constraints.end(),std::back_inserter(constraints));

    //Shuffle Randomly
    std::random_shuffle(constraints.begin(),constraints.end(), p_myrandom);

    it = constraints.begin();
    end = constraints.end();
    numConstraints = constraints.size();
  }

  void addConstraints(ConstraintManager& cm) {
    int step = rand() % numConstraints + 1;
    while(step != 0) {
      cm.addConstraint(*it);
      ++it;
      --step;
      --numConstraints;
    }   
  }

  bool hasMoreConstraints() {
    return it != end;
  }
};

bool PartitioningSolver::computeInitialValues(const Query& query,
                            const std::vector<const Array*> &objects,
                            std::vector< std::vector<unsigned char> > &values,
                            bool &hasSolution) {

  fprintf(stderr,"INIT\n");  
  // If there are no constraints in the query
  if(query.constraints.size() == 0 || query.constraints.size() == 1)
    return solver->impl->computeInitialValues(query, objects, values, hasSolution);

  // If the number constraints in the query are > 0 
  method->setQuery(query);

  ConstraintManager cm;
  ref<Expr> expr = query.expr;

  fprintf(stderr,"Begin partitioning\n");
  fprintf(stderr,"---------------------\n");  

  while(method->hasMoreConstraints()){
    fprintf(stderr, "HERE");
    //Add Constraints
    method->addConstraints(cm);

    //Construct a query
    Query temp_query(cm,expr);

     ExprPPrinter::printQuery(std::cerr,temp_query.constraints,temp_query.expr); 
     fprintf(stderr,"---------------------\n");

    //Query STP to check if satisfiable
    values.clear(); 

    if(!solver->impl->computeInitialValues(temp_query, objects, values, hasSolution))
      return false;

    //If not, return immediately (a win!) 
    if(!hasSolution)
      return true; 

    //If a solution is returned, check if the solution satisfies the entire set of constraints
    vector<const Array*> obj = objects;
    Assignment solution(obj, values);
    bool satisfiesAll = checkSolution(solution, query.constraints);

    //  fprintf(stderr,"Satisfies all: %i\n", satisfiesAll);

    // If it is successful, return the solution (a win again!), 
    if(satisfiesAll)
      return true;

    // If not add more constraints (if there is more) and repeat
  }
  return true;
} 
```

Partitioning求解器类的部分定义：

```
class PartitioningSolver : public SolverImpl {
private:
  Solver*             solver;
  PartitioningMethod* method;
  bool checkSolution(Assignment& solution,  const ConstraintManager& constraints);  
public:
  PartitioningSolver(Solver *s,  PartitioningMethod* pm) : solver(s), method(pm) { }
  ~PartitioningSolver() { delete solver; delete method; }
}; 
```

很抱歉粘贴了这么长的代码片段，但我已经研究了几个小时并且不断收到错误

```
pure virtual method called
terminate called without an active exception 
```

我不确定出了什么问题。它所在的 computeInitialValues 函数似乎失败了`fprintf(stderr,"Begin partitioning\n");`。我尝试添加打印语句作为最后的手段，但即使它们不打印任何东西..任何想法都值得赞赏。

编辑：
好的，所以我将名称 Random 更改为 Ran 并开始工作。我正在动态创建这个类实例作为 new Random() 的参数我猜它与另一个构造函数或其他我不知道的东西混合在一起。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-08-20T21:01:03.180

还有另一种类型的错误，可能会导致打印此错误消息。

您删除了该对象，然后您尝试对其进行调用。这是未定义的行为，在某些编译器上，如果幸运的话，这就是您将看到的。尝试使用 valgrind 运行您的代码。

[http://tombarta.wordpress.com/2008/07/10/gcc-pure-virtual-method-call/](http://tombarta.wordpress.com/2008/07/10/gcc-pure-virtual-method-called/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:54:02.763

您在一些代码中从构造函数调用纯虚函数，这些代码您没有包含在我们看到的代码中。

[当我的基类的构造函数在它的 this 对象上调用一个虚函数时，为什么我的派生类对该虚函数的覆盖没有被调用？](http://www.parashift.com/c++-faq-lite/strange-inheritance.html#faq-23.5)

# html - Ipad / iphone 使用 safari / chrome 在本地访问图像

> ID：12044820
> 
> 赞同：0
> 
> 时间：2012-08-20T20:42:37.473
> 
> 标签：html, ipad, google-chrome, safari

是否有任何文件路径或方法可以访问 ipad/iphone 上的图像存储/保存？我想要做的是构建一个演示文稿，它将在 safari/chrome 上运行并在本地访问图像，这样演示文稿将在有/没有互联网连接的情况下工作。有没有其他方法可以让这个演示文稿在有或没有互联网的情况下工作？

这样的事情会很棒

```
 <img src="ipad://pic.jpg" /> 
```

附言。我知道 Ipad/iphone 没有文件管理器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:47:24.880

As far as I know you cannot access photos from the browser. This might have changed with more recent updates but I doubt it. You can use something like [PhoneGap](http://www.phonegap.com/) to make a native app in HTML5 that has access to system components like photos.

# qt - QScrollArea 保存为图片 (jpg,tiff,png)

> ID：12044825
> 
> 赞同：0
> 
> 时间：2012-08-20T20:43:16.723
> 
> 标签：qt, qscrollarea

我有几条“曲线”（[类似这样](http://www.qtcentre.org/attachment.php?attachmentid=8139&d=1345494542)），这些曲线包含在 QVBoxLayout 中，而这又包含在 QScrollArea 中。

我的问题是，有没有办法将这些“曲线”保存为图像文件？即 jpg、png、tiff 等。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T21:14:54.860

您始终可以使用`QPixmap::grabWidget`从小部件创建像素图并保存它。

或者`QWidget::render`使用特定的 QPainter 渲染小部件，您可以将其分配给可保存的图像

# sql - 生成编号 使用临时表

> ID：12044833
> 
> 赞同：-6
> 
> 时间：2012-08-20T20:44:02.573
> 
> 标签：sql, sql-server

我想在不使用循环的情况下生成从 1 到 100 的数字。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:50:29.987

递归 CTE：

```
with nums as (
   select 1 as num
   union all
   select num+1 from nums where num < 100
)
select num from nums 
```

现在哲学问题是：你的作业是否考虑递归循环？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:47:58.880

您可以在 T-SQL 中执行此操作 - 这是此博客条目中的第二条语句：

[http://trycatchfinally.net/2012/03/return-a-list-of-all-dates-between-a-start-and-end-date/](http://trycatchfinally.net/2012/03/return-a-list-of-all-dates-between-a-start-and-end-date/)

基本上，您使用系统表中的行，然后使用 RANK() OVER() 在您想要的任何范围内对它们进行编号：

```
DECLARE @Start INT,
        @End   INT

    SET @Start = 1
    SET @End   = 100

;WITH numberlist(number)
   AS (SELECT RANK() over(order by c1.object_id,
                                   c1.column_id,
                                   c2.object_id,
                                   c2.column_id)
         from sys.columns c1
        cross
         join sys.columns c2)
SELECT @Start + number - 1
  FROM numberlist
 WHERE @Start + number - 1 <= @End 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:50:28.397

创建并执行以下存储过程：

```
DECLARE @sequence int
UPDATE YourTable SET sequence  = sequence  + 1, @sequence  = sequence  + 1
SELECT @sequence  AS ‘sequence’ 
```

# python - qtextbrowser 右对齐或居中

> ID：12044836
> 
> 赞同：1
> 
> 时间：2012-08-20T20:44:19.290
> 
> 标签：python, html, qt, pyqt

我试图为我的应用程序制作某种帮助系统。QTextBrowser 和一个静态 HTML 文件对我来说似乎很完美。唯一的问题是 QTextBrowser 没有正确读取对齐 - 一切都左对齐。

我的 HTML 文件是一个大的无边框表格，其中一些行居中对齐，其他行左对齐或右对齐。我可以发布整个文件，但没有意义，这是一行一行的代码；其他单元格只是复制/粘贴。

```
<tr align="center">
  <td><img src="10.png"></img></td>
</tr> 
```

该图像应该居中，但事实并非如此。整个页面在 Chromium 和 Firefox 中看起来都不错，只有 QTextBrowser 给我带来了麻烦。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:45:53.267

尝试通过 QWebView 与 QTextBrowser 来查看它。并非所有 HTML/CSS 功能都存在于 QTextBrowser 中。如果它在 Chrome 中看起来正确，那么它在 WebKit 中可能看起来正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T21:24:01.640

该`QTextBrowser`小部件仅支持有限[的 html/css 子集](http://doc-snapshot.qt-project.org/4.8/richtext-html-subset.html)。

在这种特殊情况下，`tr`标签不支持该`align`属性，但`td`and`th`标签支持（请参阅[表格单元格属性](http://doc-snapshot.qt-project.org/4.8/richtext-html-subset.html)部分以获取完整列表）。

# php - php cron脚本没有从推荐行读取参数

> ID：12044844
> 
> 赞同：1
> 
> 时间：2012-08-20T20:45:05.740
> 
> 标签：php, cron, switch-statement, crontab

我有两个文件。

一个是一个简单的文本文件，其中包含我的 scron 脚本的所有真实路径链接以及参数

另一个文件是我的 cron 脚本本身。

我的 contab 文本文件就是这样的：

```
#!/bin/sh 
/usr/bin/php -f /home/path/reports/report.php arg1

/usr/bin/php -f /home/path/reports/report.php arg2 
```

cron 脚本读取 crontab 文件中的参数，并根据它的参数运行。

报告.php——

```
php $args = $argv[1];
 $count = 0;
switch($args){
   case 'arg1':
     code and create certain file .... 
   exit;
   case 'arg2':
         code and create certain file  ... 
   exit;

    }   // <--- this script runs perfectly if I run script manually through putty commend line, meaning it will run exactly what I want depending on what $argv[1]  I put in manual commend line,  BUT doesn't run automatically from crontab script 
```

这个文件没有运行，也不知道为什么，当我通过命令行手动运行 report.php 时它运行，它可以工作。

我注意到并让它发挥作用的一件事是将report.php更改为：

报告.php——

```
$args = $argv[1];
 $count = 0;
switch($args){
   case ($args ='arg1'): // <- just putting the equal sign makes it work
     code and create certain file .... 
   exit;
   case ($args = 'arg2'):
         code and create certain file  ... 
   exit;

    } // <-- this script was a test to see if it had anything to do with the equal sign, surprisingly script actually worked but only for first case no what matter what argv[1] I had, this is not what I am looking for. 
```

问题是它只适用于第一种情况，无论我在 crobtab 的文本文件中输入什么参数，它总是运行第一种情况。可能是因为我在声明 $args = 'arg1'，所以它总是将其视为 arg1。

所以我试图通过这样做来使其工作：

报告.php——

```
$args = $argv[1];
 $count = 0;
switch($args){
   case ($args =='arg1'): // <- == does not work at all....
     code and create certain file .... 
   exit;
   case ($args == 'arg2'):
         code and create certain file  ... 
   exit;

    } // <--- this script runs perfectly if I run script manually through putty commend line, but not automatically from crontab script 
```

这什么也没有运行，它根本没有接受我的论点，只是要注意这个带有比较“==”的report.php文件如果我在推荐行上手动运行就可以完美运行。

到底是怎么回事？当我使用“==”从 crontab 文件中查找我的参数时，为什么 cron 脚本不能正确读取我的参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:50:56.500

至于 $argv -> “注意：当 register_argc_argv 被禁用时，此变量不可用。”。我建议切换到 $_SERVER['argv'] 和 $_SERVER['argc'] （是的，你没看错）而不是 $argv/$argc 的东西。

至于这个

```
case ($args ='arg1'): // <- just putting the equal sign makes it work 
```

伙计，你显然不明白你在做什么以及 ($args=='arg1') 和 ($args='arg1') 之间有什么区别！

--[评论代码如下]----

将此另存为 test.php：

```
<?php
echo $_SERVER['argv'][1] ."\n"; 
```

并测试它。

```
$ php test.php abd
abd 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:52:38.207

第一个工作的原因是因为如果您使用 = 而不是 == 您正在 if 语句中设置变量。

尝试 var_dump($argv) 并查看是否为变量分配了任何内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-20T20:54:44.917

正如@arxanas 在评论中提到的那样，您的开关是AFU。[在此处](http://php.net/manual/en/control-structures.switch.php)阅读文档。`case`语句已经相当于`$x == [value]`，所以你只需要使用`case [value]:`.

```
switch($args) {
    case ($args =='arg1'):
        .
        .
        .
        break;
    .
    .
    .
} 
```

应该

```
switch($args) {
    case 'arg1':
        .
        .
        .
        break;
    .
    .
    .
} 
```

# python - 如何将电子邮件地址映射到 SOA RNAME 字段？

> ID：12044852
> 
> 赞同：2
> 
> 时间：2012-08-20T20:45:49.700
> 
> 标签：python, dns, dnspython

是否存在将电子邮件地址映射到 SOA 记录的 RNAME 字段（及其逆向）的现有/标准算法？我正在使用[dnspython](https://github.com/rthalley/dnspython)包，但我在他们的源代码树中看不到任何东西来处理这个问题。我遇到了有句号“。”的边缘情况。在需要转义的用户名中，并想知道是否还有其他我遗漏的边缘情况。 [RFC 1035](https://www.rfc-editor.org/rfc/rfc1035#section-3.3.13)简单说明：

> <domain-name> 指定负责此区域的人员的邮箱。

[除了RFC 1183](https://www.rfc-editor.org/rfc/rfc1183#section-2.2)中的简短提及之外，更新 1035 的 RFC 都没有扩展 RNAME 字段。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:45:49.700

这是我使用[dnspython 想到的](https://github.com/rthalley/dnspython)：

```
from dns.name import from_text

def email_to_rname(email):
    """Convert standard email address into RNAME field for SOA record.

    >>> email_to_rname('johndoe@example.com')
    <DNS name johndoe.example.com.>
    >>> email_to_rname('john.doe@example.com')
    <DNS name john\.doe.example.com.>
    >>> print email_to_rname('johndoe@example.com')
    johndoe.example.com.
    >>> print email_to_rname('john.doe@example.com')
    john\.doe.example.com.

    """
    username, domain = email.split('@', 1)
    username = username.replace('.', '\\.')  # escape . in username
    return from_text('.'.join((username, domain)))

def rname_to_email(rname):
    """Convert SOA record RNAME field into standard email address.

    >>> rname_to_email(from_text('johndoe.example.com.'))
    'johndoe@example.com'
    >>> rname_to_email(from_text('john\\.doe.example.com.'))
    'john.doe@example.com'
    >>> rname_to_email(email_to_rname('johndoe@example.com'))
    'johndoe@example.com'
    >>> rname_to_email(email_to_rname('john.doe@example.com'))
    'john.doe@example.com'

    """
    labels = list(rname)
    username, domain = labels[0], '.'.join(labels[1:]).rstrip('.')
    username = username.replace('\\.', '.')  # unescape . in username
    return '@'.join((username, domain)) 
```

# python - 日志搜索，将第一个特定条目打印到日志文件

> ID：12044863
> 
> 赞同：0
> 
> 时间：2012-08-20T20:46:11.313
> 
> 标签：python, for-loop, syslog, python-2.4

问：我正在尝试在系统日志（Linux 服务器）中搜索特定事件的第一个条目，然后执行命令（未来开发），然后记录信息。我不确定我是否以正确的方式处理了这个问题。

问题：不确定如何在找到第一个有效条目时退出循环。

```
import os
import commands
from time import strftime

file = "server.log.1" # sample log
nlogFile =("/home/nsoper/log/logfile_%s.txt") %(strftime("%Y_%m_%d_ %H_%M_%S")) # create logfile
caption="SN" # sample serach
condition2 = "java error"

F=open(file, 'r')
nF=open(nlogFile, 'a')
nF.write("output for results search:\n\n")

print(strftime("%Y_%m_%d_ %H_%M_%S"))

for line in F:
       for item in line.split("\n"):
                 if caption in item:
                        line1=item.strip()
                        if condition2 in line1:
                                print line1.strip()
                                nF.write(line1.strip()+"\n")
                                #command execute

nF.close()
F.close() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-24T01:22:06.977

这是我发现使用 python 2.4（Linux prod env 服务器。无法/无法升级 python）完成此任务的最佳方法。在这种特定情况下，我想获取最后一行，然后使用另一个循环处理它。

```
index=[]
con1 = "First Condition"
con2 = "Second Condition"

file=open("log.txt",'r')

print("Reading.. "+ file)
for line in F:
    for item in line.split("\n"):
            if con1 in item:
                    con1Line=item.strip()
                    if con2 in con1Line:
                            index.append(con1Line)
F.close()
l=index[-1]
print(l)
# do stuff now will value l
del index[:] 
```

# .net - 释放后仍然可以访问控件的属性

> ID：12044864
> 
> 赞同：0
> 
> 时间：2012-08-20T20:46:11.607
> 
> 标签：.net, vb.net, winforms, using

我正在使用下面的模板来显示模态表单

```
Using tempForm As New CustomForm

    'Do Something

    StaticClass.StaticMemeber = tempForm
    tempForm.ShowDialog

End Using

'I can still access the properties of tempForm here
MsgBox(StaticClass.StaticMemeber.Text)

'However this below returns True
MsgBox(StaticClass.StaticMember.IsDisposed)

Public Class StaticClass

    Public Shared StaticMember as Control

End Class 
```

有人可以帮我理解为什么会这样。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:54:51.640

在垃圾收集器删除并释放它正在使用的内存之前，已释放的对象仍然存在。IDispose 接口只是一种模式。实现该模式的对象应该做的一件事是在其被释放后为属性和方法返回一个 ObjectDisposed 异常。但是，编译器或 CLR 中没有任何内容强制对象这样做，它只是编写对象的程序员应该实现的模式。在垃圾收集器实际删除对象之前，您仍然可以访问其属性。在这种情况下，StaticMember 仍然引用该对象。GarabageCollector 不会杀死该对象，直到该引用被释放。

# asp.net - ASP.Net 异步 SQL 查询和 Ajax 更新面板

> ID：12044867
> 
> 赞同：1
> 
> 时间：2012-08-20T20:46:17.073
> 
> 标签：asp.net, sql, ajax, asynchronous, updatepanel

这是我遇到麻烦的场景...

我有一个要执行的 SQL 存储过程，在等待它完成时（这将需要几秒钟），我想用计数器更新更新面板内的标签。

当我调用它的更新方法时，下面的代码不会更新 updatePanel，我不知道为什么。它只会在整个通话结束后更新面板。

有什么建议么？

ASPX：

```
<form id="form1" runat="server">
<div>
    <asp:ScriptManager ID="ScriptManager1" runat="server" EnablePartialRendering="true"></asp:ScriptManager>

    <asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
        <ContentTemplate>
            <asp:Label ID="Label1" runat="server" Text="Label"></asp:Label>
        </ContentTemplate>
    </asp:UpdatePanel>
</div>
</form> 
```

代码隐藏：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

'assume code for sql command is already setup and the stored proc does indeed execute

Dim count As Integer = 0
Dim result As IAsyncResult = cmd.BeginExecuteNonQuery()
While Not result.IsCompleted
    Label1.Text = count
    UpdatePanel1.Update()
    Threading.Thread.Sleep(500)
    count += 1
End While

End Sub 
```

例如，存储过程需要 10 秒才能执行，我最终在标签中看到数字 20（基本上每秒 2 个），但我想看到它显示 0，然后更新为 1，然后更新为 2，等等，等等...... UpdatePanel 似乎只更新一次，而不是每次`UpdatePanel1.Update()`被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T21:24:27.487

由于操作是异步的，与睡眠相比，[await](http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx#BKMK_AsyncandAwait)将为您提供以下优势：

*   状态信息
*   状态更新
*   如果操作永远不会完成，请避免可能的无限循环

# android - 用于 Google Play 发布的 Android Facebook 密钥

> ID：12044868
> 
> 赞同：3
> 
> 时间：2012-08-20T20:46:19.827
> 
> 标签：android, facebook

我已经能够成功开发一个使用带有调试密钥的 Facebook SSO 的应用程序。当我发布用于测试 Facebook SSO 的应用程序时，它不再有效。我需要一个**不是调试密钥的新 Facebook 密钥**。我的问题是，我不知道如何生成它。任何帮助将非常感激。

我正在使用 Windows 7 和 Eclipse。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:10:57.320

以下是创建新密钥和签署应用程序以进行分发的操作。

1) 在 Eclipse 的 Package Explorer 部分中右键单击您的项目，然后选择 Android Tools > Export Signed Application Package...

![在此处输入图像描述](../Images/d89602ae1d87d4ab32006c0670dffce5.png)

2）通过向导，确保您的项目被选为要导出的项目

3) 下一步是创建一个新的密钥库。指定路径和您想要的密码

![在此处输入图像描述](../Images/54cfaa2770e38fc60b889f3cdc81caab.png)

4) 您可以根据需要更改别名，但默认为“android”就足够了。设置此别名的密码，设置此密钥的有效期（0-1000 年之间），以及至少您的名字和姓氏。您还可以添加您希望与此密钥关联的任何其他详细信息（但不是必需的）。

![在此处输入图像描述](../Images/10de1ce1e44a7de5544102d87a52d2b7.png)

5) 通过指定要将 APK 导出到的路径来完成该过程。按 Finish，Eclipse 将需要一段时间来打包您的应用程序。完成后，您将在您指定的路径中获得新密钥，以及由该新密钥签名的 APK 文件。

让我知道这是否有帮助！

# linq - LINQ Lambda 连接错误 - 无法从使用中推断

> ID：12044873
> 
> 赞同：33
> 
> 时间：2012-08-20T20:46:35.053
> 
> 标签：linq, join, lambda

我在加入两个 DbSet 时遇到了麻烦，并继续收到“无法推断错误”。我努力寻找解决方案，所以我想我会分享我的简单答案。Jon Skeet 和其他人有几篇很棒的帖子，但大多数答案都在我脑海中。

这是给我带来麻烦的代码：

```
using(var db = new SomeDataContext())
    {
    db.DemandData
        .Where(demand=> demand.ID == SearchID)
        .Join(db.CUST_ORDER_LINE,
            supply=> new { supply.LINE, supply.SALES_ORDER_ID },
            demand=> new { demand.LINE_NO, demand.CUST_ORDER_ID },
            (supply, demand) => new { custOrderLineReturn = demand })
        .Select(s => s.custOrderLineReturn )
        .ToList();
    } 
```

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-08-20T20:46:35.053

我已经多次执行此连接，以至于我无法弄清楚为什么它不起作用，直到我在[这里](https://stackoverflow.com/a/5808143/752974)找到 Justin Niessner 的帖子说*“匿名类型（以及它们的类型）中的属性名称必须完全匹配。”* 这让我看到了这段代码：

```
using(var db = new SomeDataContext())
    {
  return db.DemandData
        .Where(demand=> demand.ID == SearchID)
        .Join(db.CUST_ORDER_LINE,
            supply=> new { LINE_NO = supply.LINE, CUST_ORDER_ID = supply.SALES_ORDER_ID },
            demand=> new { demand.LINE_NO, demand.CUST_ORDER_ID },
            (supply, demand) => new { custOrderLineReturn = demand })
        .Select(s => s.custOrderLineReturn )
        .ToList();
    } 
```

在第六行中，我添加了与第七行中的字段名称匹配的变量**LINE_NO =**和**CUST_ORDER_ID =**。

# c# - 如何以编程方式调用设置魅力？

> ID：12044875
> 
> 赞同：6
> 
> 时间：2012-08-20T20:46:40.250
> 
> 标签：c#, windows-8, microsoft-metro

我想从点击事件中调用设置魅力。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-08-20T20:54:45.850

查看 SettingsPane 类：http: [//msdn.microsoft.com/en-us/library/windows/apps/windows.ui.applicationsettings.settingspane.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.applicationsettings.settingspane.aspx)

似乎调用 Show() 方法可以解决问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-05-14T06:30:53.430

```
Windows.UI.ApplicationSettings.SettingsPane.Show(); 
```

# c# - 如何将图像从图像列表添加到图片框

> ID：12044877
> 
> 赞同：1
> 
> 时间：2012-08-20T20:46:55.010
> 
> 标签：c#

嗨，我有一个 Imagelist 和一个图片框。我想将图像添加到我的图片框。

我试过这样

```
picbox.Image = imagelst.Images[0]; 
```

但它没有用。
Visual Studio 不允许我在 imagelist 之后写图像

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-08-20T20:57:05.110

它有效，我认为您没有在 imagelist 中设置图像。

1.  我在 imagelist 中设置了一个图像。
2.  我设置了这个代码。

    ```
    namespace WindowsFormsApplication1
    {
        public partial class Form1 : Form
        {
            public Form1()
            {
                InitializeComponent();
            }

            private void button1_Click(object sender, EventArgs e)
            {
                pictureBox1.Image = imageList1.Images[0];
            }
        }
    } 
    ```

3.  有用。

![在此处输入图像描述](../Images/773f1bffab392eee0808884d3a5b18a7.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-21T12:32:55.717

这是一个老问题，但从 OP 的评论来看，我认为他没有实例化的 imagelist 对象。

将 imagelist 控件拖到窗体上，默认情况下为“imagelist1”。您可以将其重命名为您想要的名称，然后使用它。

# iphone - AFNetworking：返回 200 且无内容时运行失败块

> ID：12044880
> 
> 赞同：3
> 
> 时间：2012-08-20T20:47:15.320
> 
> 标签：iphone, objective-c, ios, afnetworking

我正在使用 AFNetworking 处理从我的移动应用程序到我的 Rails 服务器的重置密码请求。

api正在返回：head：ok（结果为200）

但是，这会导致 AFNetworking 在我发出`getPath`请求时运行失败块。

我可以做两件事来运行成功块：

1.  有 api 返回`head :no_content`（导致 204）
2.  不要将我的 Accept 标头设置为 `application/json'

当状态码为 200 且 Accept 标头为`application/json`.

我没有完全控制 api，所以是否有可能有一个没有内容的 200 仍然触发我的成功块，或者 204 应该用于这种确切的情况，它成功但不会返回任何内容服务器？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T20:11:21.790

`AFHTTPRequestOperation`您可以自己使用和处理响应代码，而不是使用 AFNetworking 的成功和完成块。例如：

```
// Setup HTTP client
AFHTTPClient *client = [AFHTTPClient clientWithBaseURL:[NSURL URLWithString:@"http://website.com"]];

// Create the request
NSURLRequest *request = [client requestWithMethod:@"GET" path:@"authenticate" parameters:params];

// Create an HTTP operation with your request
AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];

// Setup the completion block
[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
    switch (operation.response.statusCode) {
        case 200:
            // Do stuff
            break;
        default:
            break;
    }
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    switch (operation.response.statusCode) {
        case 400:
            // Do stuff
            break;
        default:
            break;
    }
}];

// Begin your request
[operation start]; 
```

# c - 权限被拒绝错误开发 C++

> ID：12044884
> 
> 赞同：0
> 
> 时间：2012-08-20T20:47:17.953
> 
> 标签：c, dev-c++

当我尝试在 DEV C++ 中再次编译 C 代码时，该工具给出以下错误。如果我尝试在新文件中复制相同的代码，它可以正常工作，但我再次无法编译新代码，需要再次复制到另一个文件。

```
 Permission denied  ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-08-20T20:50:43.807

该程序可能正在运行。你需要在重新编译之前杀死它。

# verilog - 是否有支持 SystemVerilog 类的线路覆盖的工具/模拟器？

> ID：12044898
> 
> 赞同：1
> 
> 时间：2012-08-20T20:47:55.443
> 
> 标签：verilog, system-verilog

我的 SystemVerilog 组件有一些自测试代码，我想确保我的测试涵盖所有内容，尤其是我的类中的失败案例。我所需要的只是行/分支覆盖，就像其他面向对象语言（如 Java）通常使用的一样。

我尝试使用 VCS（2012.06 版）覆盖，我发现它仅对 SystemVerilog 的支持有限，并且不支持对 SystemVerilog 类的任何覆盖。是否有任何模拟器或工具具有此支持？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T13:17:55.577

SpringSoft 的 Certitude 工具（刚刚被 Synopsys 购买）是一个检查测试台有效性的工具。它本质上分析了您的测试台代码的覆盖率，并做了更多的工作。

[http://www.springsoft.com/products/functional-qualification/certitude](http://www.springsoft.com/products/functional-qualification/certitude)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-25T16:03:17.073

2012/08/25

在另行通知之前，答案是：

不，没有工具/模拟器支持 SystemVerilog 类的线路覆盖。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-21T12:22:24.223

我原以为[Modelsim](http://www.mentor.com/products/fv/multimedia/using-code-coverage-modelsim-webseminar/)或[Aldec 的](http://www.aldec.com/en/solutions/functional_verification/code_coverage/)覆盖范围可以满足您的需要。老实说，看起来[VCS](http://www.synopsys.com/Tools/Verification/FunctionalVerification/Pages/VCS.aspx)也是如此，所以也许其他工具也有同样的缺陷？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-10-05T09:31:25.743

我已经在 Mentor **Questasim 模拟器**中尝试过这个新功能。他们从 Modelsim/Questa 10.2 开始实现了 SV（systemverilog）类代码覆盖。

**要在systemverilog 文件/类**中激活该功能，您需要：

例子 ：

```
 vlog +cover my_design.sv
   vsim –voptargs=+acc  –coverage  mydesign 
```

[![screenshot_sv_class_ethernet_driver](../Images/1b1350a670d06d4836910725596e36c1.png)](https://i.stack.imgur.com/HxVa6.png)

vcover 可以采用以下规范。当没有规范时，+vcover 等价于“+vcover=bcesft”。

b — 收集分支统计信息。

c — 收集条件统计信息。仅收集 FEC 统计信息，除非指定了 -coverudp。

e — 收集表达式统计信息，仅收集 FEC 统计信息，除非指定了 -coverudp。

s - 收集语句统计信息。

t - 收集切换统计信息。如果在别处指定了“x”，则覆盖

x - 收集扩展切换统计信息。如果在其他地方指定了“t”，则优先。

f — 收集有限状态机统计信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-27T08:04:25.407

我找到[了 Covered](http://covered.sourceforge.net/)，但我自己没有使用它。它是开源的，这是一个优点，但似乎自 2010 年以来就没有开发... :-/

# c++ - 添加可绘制对象层以将逻辑与图形分开

> ID：12044903
> 
> 赞同：0
> 
> 时间：2012-08-20T20:48:19.873
> 
> 标签：c++, rtti

我正在尝试编写经典的蛇游戏。我有逻辑工作（吃饭，成长移动等）。现在我想添加一些漂亮的图形。到目前为止，我用这段代码制作了一些丑陋的图形：（伪代码）

```
void drawWorld(const std::vector<Tileable*> world_map) {
    for each Tileable {
         get position of Tileable
         get color of Tileable
         draw rectangle at position with color
    }
} 
```

Tileable 类表示 Snakes 地图上的对象 -> 苹果、墙壁甚至是蛇本身。它存储对象的位置，当蛇与对象等碰撞时会发生什么-> 逻辑。

但

如果苹果是圆形而不是矩形会更好吗？

所以我想用方法 .draw() 和派生类 DrawableSnake、DrawableApple、DrawableWall、DrawableWhatever 添加类 Drawable，每个类都有自己的 draw() 方法。问题是将 Tielable 子类从集合 world_map 转换为 Drawable 的适当子类，以具有如下内容：

```
void drawWorld(const std::vector<Tileable*> world_map) {
    for each Tileable {
         get drawable from tileable
         drawable.draw()
    }
} 
```

我正在考虑使用带有 RTTI 的工厂之类的东西：（伪代码）

```
Drawable convertToDrawable(Tileable* tileable){
     if tileable is Apple return DrawableApple
     if tileable is Wall return DrawableWall
     etc.
} 
```

有没有更好的方法来做到这一点，而不使用 RTTI？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T00:53:15.810

这是设计游戏引擎时的常见问题。解决此问题的一种方法是迁移到基于实体组件的系统。

苹果、墙壁和蛇都属于同一类——“实体”。对于每个实体，您将附加一个组件列表。在您的情况下，“ComponentDrawable”可能是一个组件，而“ComponentTileable”可能是另一个。当您创建实体时，您使用绘制该特定实体所需的数据初始化 ComponentDrawable。

您需要一种从实体中获取特定类型组件的方法。一个简单的系统可以让每个实体都有一个组件指针数组。每个组件类型在该数组中都有一个唯一的索引。数组中的空槽将具有 NULL 值。

```
template<typename T> T* getComponent( Entity *entity ) {
    entity.component_array[T::index]
} 
```

然后，您修改后的伪代码示例将最终看起来像这样：

```
void drawWorld(const std::vector<Entity*> world_map) {
    for each entity in world_map {
         ComponentDrawable *drawable = getComponent<ComponentDrawable>( entity )
         if( drawable )
             drawable->draw()
    }
} 
```

有些人喜欢将功能保留在组件之外，只将它们用作数据的载体。如果您想走这条路，那么数据驱动系统可以使用来自 ComponentDrawable 的数据来绘制每个实体的正确表示。

# java - Maven 术语——依赖和插件、存储库与 pluginRepository

> ID：12044909
> 
> 赞同：33
> 
> 时间：2012-08-20T20:48:52.767
> 
> 标签：java, maven

我已经使用 Maven 工作了好几天，但仍然对一些术语感到困惑：

`repository`第一个问题是和有什么区别`pluginRepository`？如果存在功能差异，那么我应该为两者都放一个网址吗？

`dependency`第二个问题是和有什么区别`plugin`？也许它们是完全不同的比较项目，因为`plugin`可以包含`dependencies`，但对我来说`plugins`看起来像是构建中的某种依赖项？就像“这`build`取决于这些插件，而其中一个插件取决于那个依赖项”，我一直认为依赖项是一种库 jar，而插件是库 jar 或依赖于 jar 中的项目......

对不起，如果这个问题有点愚蠢，但我真的很困惑。请给个提示，谢谢。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2012-08-20T20:59:10.080

回到 Maven1.0，插件和普通工件位于不同的存储库中（据我所知）。在 Maven2+ 中，它们一起存储在存储库中。但是有来自许多不同公司和项目的许多不同的存储库，因此您必须选择您需要的存储库。

插件是您在执行 maven 构建时使用的工具。例如，编译器插件将您的 Java 代码编译成字节码。正常的依赖项是您在应用程序中使用的工件，例如库。

插件和工件都可以具有传递依赖关系。这意味着他们自己有依赖关系。

# java - 无法启动休眠会话工厂 bean

> ID：12044911
> 
> 赞同：0
> 
> 时间：2012-08-20T20:48:57.687
> 
> 标签：java, spring, hibernate, h2, hibernate-annotations

这是我的休眠配置

```
 <bean id="datasource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="org.h2.Driver"/>
        <property name="url" value="jdbc:h2:mem:/localhost/testDB"/>
        <property name="username" value="sa"/>
        <property name="password" value=""/>
    </bean>

    <bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
        <property name="dataSource" ref="datasource" />
        <property name="packagesToScan" value="sample.model"/>
        <property name="annotatedPackages">
            <list>
                <value>sample.model</value>
            </list>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect"> org.hibernate.dialect.H2Dialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">create</prop>
            </props>
        </property>
    </bean> 
```

我包括了这个依赖

```
 <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-annotations</artifactId>
            <version>3.5.6-Final</version>
</dependency> 
```

这是例外

```
Caused by: java.lang.IllegalStateException: Expected method not found: java.lang.NoSuchMethodException: org.hibernate.cfg.Configuration.addAnnotatedClass(java.lang.Class)
    at org.springframework.util.ClassUtils.getMethod(ClassUtils.java:627)
    at org.springframework.orm.hibernate4.LocalSessionFactoryBuilder.<clinit>(LocalSessionFactoryBuilder.java:79)
    ... 39 more 
```

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:00:59.430

看起来您的休眠注释 jar 文件的版本不正确。

你应该已经有了`hibernate-core`依赖。`hibernate-annotations`如果是这样，您可以在 POM 文件中注释掉您的依赖项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T22:02:13.227

解决方案是使用hibernate 3并添加这个

```
<prop key="hibernate.current_session_context_class">org.hibernate.context.ThreadLocalSessionContext</prop> 
```

所以最终的配置是

```
<bean id="sessionFactory" class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
        <property name="dataSource" ref="datasource" />
        <property name="packagesToScan" value="sample.model"/>
        <property name="annotatedPackages">
            <list>
                <value>sample.model</value>
            </list>
        </property>
        <property name="hibernateProperties">
            <props>
                <prop key="hibernate.dialect"> org.hibernate.dialect.H2Dialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">create</prop>
                   <prop key="hibernate.current_session_context_class">org.hibernate.context.ThreadLocalSessionContext</prop>
               </props>
        </property>
    </bean> 
```

# objective-c - 使用 NSMutableDictionary 缓存图像

> ID：12044914
> 
> 赞同：0
> 
> 时间：2012-08-20T20:49:18.180
> 
> 标签：objective-c

我正在尝试创建一个应用程序来处理来自网络的各种图像，并旨在将它们缓存到 iPhone 上以供离线使用。我目前正在使用的代码是：

```
NSMutableDictionary *Cache;
- (UIImage *)CachedImage: (NSString*)url {
    UIImage *image = [Cache objectForKey:url];
if (image == nil) {
    image = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:url]]];
    [Cache setObject:image forKey:url];
    //NSLog (@"Stored");
    return image;
} else {
    //NSLog (@"Taken");
    return image;
} } 
```

我调用该函数并使用下面的代码条将图像放入 ImageView 中。

```
 [self.imageView setImage:[self CachedImage:url]]; // Change url to desired URL. 
```

使用 NSLog，我发现的问题是代码实际上并没有存储该值，因为该值始终读取为零。为什么会这样？还有其他存储图像以供离线使用的方法吗？提前致谢。

-贡

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T20:52:38.623

你正在寻找

## NSCache

在这里查看：http: [//nshipster.com/nscache/](http://nshipster.com/nscache/)

> 可怜的 NSCache，在最不合适的情况下总是被 NSMutableDictionary 所掩盖。就像没有人知道它在那里一样，随时准备提供开发人员煞费苦心地重新实现自己的所有垃圾收集行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T20:53:23.997

使用 NSCache 缓存 UIImages。您还可以将图像保存在本地（如果您多次重复使用这些图像并且在多次启动期间），因此每当您的应用程序关闭或刷新缓存时，您都可以立即从本地目录获取图像。

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSCache_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSCache_Class/Reference/Reference.html)

# django - Heroku-Django South 迁移到 Cloudinary Image Field

> ID：12044915
> 
> 赞同：0
> 
> 时间：2012-08-20T20:49:18.717
> 
> 标签：django, web-applications, heroku, django-south, cloudinary

我正在开发一个严重依赖实时用户图像创建上传的应用程序。由于 Heroku 不支持实时上传（定期刷新新文件），我将所有图像移动到[Cloudinary](http://cloudinary.com/)。

对于带有图像字段的模型，我添加了这个字段：

```
 c_image = CloudinaryField('image') 
```

所有导入都有效，我确保添加了南自省规则：

```
add_introspection_rules([], ["^cloudinary\.models\.CloudinaryField"]) 
```

当我尝试迁移时，我收到错误消息，指出此字段`NOT NULL`尚未指定默认值。

如何设置默认值或允许`null=true, blank=true`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:59:27.600

`CloudinaryField`是 a 之上的包装器`CharField`- 您可以添加`null=True, blank=True`到字段定义中。

# asp.net - 在sql中将DateTime转换为不同的格式

> ID：12044919
> 
> 赞同：1
> 
> 时间：2012-08-20T20:49:46.713
> 
> 标签：asp.net, sql, c#-4.0, sql-update

如何转换/转换此日期时间格式：**06/17/2012 12:00:00 AM**

至此日期格式：**2012/06/17**

在 SQL 更新语句中？

我需要更改字段。开始日期和结束日期。两种日期时间类型。

到目前为止，这是我的更新声明：

```
Update discount set DiscountPromotionalID = @DiscountPromotionalID,
   isActive =@isActive, Title = @Title, BeginDate = @BeginDate, EndDate = @EndDate, 
    DiscountPercentage = @DiscountPercentage

    where DiscountPromotionalID = @DiscountPromotionalID;" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:54:35.143

如果您将其存储为 NVARCHAR （您不应该这样），您可以在执行插入/更新语句时使用以下内容对其进行转换。我建议将此列转换为适当的 DateTime 字段，然后您可以按照评论者的建议在表示层中随意格式化。

查看此资源以满足您的所有 SQL 数据格式化需求（使用示例 sql！）

[http://www.sql-server-helper.com/tips/date-formats.aspx](http://www.sql-server-helper.com/tips/date-formats.aspx)

我相信您正在寻找这样的东西（来自上面的资源）：

```
CONVERT(VARCHAR(10), GETDATE(), 111) AS [YYYY/MM/DD] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T23:39:17.757

与 C#`DateTime`值一样，SQL Server`DateTime`值没有格式：它只是一个由两个 32 位整数组成的 64 位字段。第一个计算纪元以来的天数（1900 年 1 月 1 日 00:00:00.000）；秒以 1/300 秒为单位计算自一天开始以来的时间。

[在使用CONVERT()](http://msdn.microsoft.com/en-us/library/ms187928%28v=sql.100%29.aspx)在 SQL 中或在客户端代码中显示或将其转换为 char/varchar 时应用格式。

您的`update`陈述不关心格式：它关心价值。如果您将 C#`DateTime`值作为 a`SqlParameter`传递给您的存储过程或参数化查询，那么正确的事情将会发生：CLR 会神奇地为您将一个转换为另一个。

如果从 C# 将字符串作为 DateTime 参数传递，则它需要采用 SQL Server 将识别为 DateTime 字符串的格式。假设是这种情况，从 C# 字符串到 SQL Server DateTime 值的转换同样会神奇地发生。

鉴于您的`update`陈述，您应该使用以下代码：

```
public int UpdateDiscount( int discountPromotionalID , bool isActive , string title , DateTime beginDate , DateTime endDate , int discountPercentage )
{
  const string updateQuery = @"
Update discount
set DiscountPromotionalID   = @DiscountPromotionalID ,
    isActive                = @isActive              ,
    Title                   = @Title                 ,
    BeginDate               = @BeginDate             ,
    EndDate                 = @EndDate               ,
    DiscountPercentage      = @DiscountPercentage    
where DiscountPromotionalID = @DiscountPromotionalID
" ;

  int rowsAffected ;

  using ( SqlConnection connection = new SqlConnection( SomeConnectString ) )
  using ( SqlCommand    cmd        = connection.CreateCommand() )
  {

    cmd.CommandText = updateQuery ;
    cmd.CommandType = CommandType.Text ;

    cmd.Parameters.AddWithValue( "@DiscountPromotionalID" , discountPromotionalID ) ;
    cmd.Parameters.AddWithValue( "@isActive"              , isActive ? 1 : 0 ) ; // C# bools are true/false; SQL bools are 1/0
    cmd.Parameters.AddWithValue( "@Title"                 , title ) ;
    cmd.Parameters.AddWithValue( "@BeginDate"             , beginDate ) ;
    cmd.Parameters.AddWithValue( "@EndDate"               , endDate   ) ;
    cmd.Parameters.AddWithValue( "@DiscountPercentage"    , discountPercentage ) ;

    connection.Open() ;
    rowsAffected = cmd.ExecuteNonQuery() ;
    connection.Close() ;

  }

  return rowsAffected ;

} 
```

# python - python中超过50k条目的哈希函数和表实现

> ID：12044925
> 
> 赞同：3
> 
> 时间：2012-08-20T20:50:05.010
> 
> 标签：python, hash

任何人都可以提供一个关于如何通过将键散列到值并避免/处理python中的冲突来创建散列表的好教程吗？我在这里和那里看到了很多小代码，但我想知道是否有人可以帮助我。

基本上：

*   创建表
*   选择一个散列函数并将键散列到表中
*   处理碰撞
*   在所述表上执行查找

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T20:53:45.393

您是否尝试过自定义对象以使用内置的[dict](http://wiki.python.org/moin/DictionaryKeys)类型？它是一个哈希表。要自定义散列，您需要做的就是确保您的关键对象是[Hashable](http://docs.python.org/glossary.html#term-hashable)：

```
class Foo(object)
    def __hash__(self)
         #return good (int) hash for a Foo

    def __eq__(self, other)
         #return true if self == other

    def __ne__(self, other)
         #return true if self != other 
```

现在 Foo 可以成为 dict 的关键

```
d = {Foo(): "value1", Foo(): "value2"} 
```

# c# - 如何在 C# System.Windows.Forms.Panel 中禁用水平滚动条

> ID：12044926
> 
> 赞同：0
> 
> 时间：2012-08-20T20:50:06.410
> 
> 标签：c#, user-interface

我尝试添加上一个线程中的代码，但它对我不起作用。

[如何禁用面板中的水平滚动条](https://stackoverflow.com/questions/5489273/how-to-disable-the-horizontal-scrollbar-in-a-panel)

我只是想删除它，因为无论它是否需要出现在我的屏幕上，它都会显示出来。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:08:44.730

面板不会显示条形，除非它通过`Panel.AutoScroll = false`和静态设置`panel1.HorizontalScroll.Visible = true`。我建议您验证没有控件超出面板，而不是强制状态。

将以下内容插入表单的某些部分。这将验证您没有超出面板两侧的控件。将 panel1 更改为有问题的面板的名称。

```
 foreach (Control comp in panel1.Controls)
        {
            if (comp.Right >= panel1.Width || comp.Bottom >= panel1.Height)
            {
                System.Diagnostics.Debugger.Break();
            }
        } 
```

如果你仍然找不到问题，`Panel.AutoScroll = false`应该`panel1.HorizontalScroll.Visible = false`做的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-25T01:42:53.910

我发现这个解决方案是首选。

```
public class MongoDataPanel : Panel
{

    [DllImport("user32.dll")]
    static public extern bool ShowScrollBar(IntPtr hWnd, int wBar, bool bShow);
    private const int SB_HORZ = 0;
    private const int SB_VERT = 1;

    protected override void OnResize(EventArgs eventargs)
    {
        base.OnResize(eventargs);
        if (this.Parent != null)
        {
            if (this.Parent.Width > this.PreferredSize.Width - 10)
            {
                try
                {
                    ShowScrollBar(this.Handle, SB_HORZ, false);
                }
                catch (Exception e) { }
            }
        }
    }
} 
```

# python - 向文件中插入行的 Pythonic 方式

> ID：12044927
> 
> 赞同：2
> 
> 时间：2012-08-20T20:50:10.563
> 
> 标签：python, file-io, insert

因此，正如描述所描述的，我想按顺序将文本添加到文件中。比如说，我有一个像这样的文件（不是 HTML，这只是一种想象的语言）让我们称之为 ALLTHEITEMS：

```
<items>
</items> 
```

说另一个名为ITEMS的文件：

```
banana
apple
blueberry
pickle 
```

而且我已经阅读了项目并创建了一个数组：`['banana','apple','blueberry','pickle']`

我想遍历数组中的每个项目并将其写入标签之间的 ALLTHEITEMS。

所以最后 ALLTHEITEMS 应该是这样的：

```
<items>
banana
apple
blueberry
pickle
</items> 
```

最pythonic的方式是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-20T20:55:02.513

我会这样做：

```
with open(outputfile,'w') as out, open(inputfile) as f:
    for line in f:
        out.write(line)
        if tag_match(line):  #Somehow determine if this line is a match where we want to insert text.
           out.write('\n'.join(fruits)+'\n') 
```

您*可能会*想出一种让它更快的方法，但我怀疑它是否值得。这很简单，易于阅读，并且可以完成工作。“pythonic”对我来说足够了:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:04:25.200

解析标记的最 Pythonic 方式是使用合适的[模块](http://docs.python.org/library/markup.html)来解析它。

# cuda - 多 GPU 分析（多个 CPU，MPI/CUDA 混合）

> ID：12044928
> 
> 赞同：5
> 
> 时间：2012-08-20T20:50:12.837
> 
> 标签：cuda, gpu, mpi, profiling, nvidia

我在论坛上快速浏览了一下，我认为这个问题还没有被问过。

我目前正在使用其他人在博士期间制作的 MPI/CUDA 混合代码。每个 CPU 都有自己的 GPU。我的任务是通过运行（已经工作的）代码来收集数据，并实现额外的东西。将这段代码变成单个 CPU / 多 GPU 的代码目前不是一种选择（以后可能会。）。

我想利用性能分析工具来分析整个事情。

* * *

目前的一个想法是让每个 CPU 为自己的 GPU 启动 nvvp 并收集数据，而另一个分析工具将负责一般的 CPU/MPI 部分（我计划使用 TAU，就像我通常做的那样）。

问题是，同时启动 nvvp 的界面 8 次（如果使用 8 个 CPU/GPU 运行）非常烦人。我想避免通过界面，并获得一个直接将数据写入文件的命令行，我可以稍后将其提供给 nvvc 的界面并进行分析。

我想获得一个命令行，它将由每个 CPU 执行，并为每个 CPU 生成一个文件，提供有关他们自己的 GPU 的数据。8（GPU/CPU）= 8 个文件。然后我打算用 nvcc 一个一个地单独馈送和分析这些文件，手动比较数据。

任何的想法 ？

谢谢 ！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-08-21T14:48:59.330

查看[CUDA 5.0 Toolkit](http://developer.nvidia.com/cuda/cuda-toolkit)`nvprof`的一部分（目前可作为候选发布版）。有一些限制 - 它只能在给定的传递中收集有限数量的计数器并且它不能收集指标（所以现在如果你想要多个事件，你必须编写多个启动脚本）。您可以从 nvvp 内置帮助中获取更多信息，包括示例 MPI 启动脚本（在此处复制，但如果您有任何比 5.0 RC 更新的版本，我建议您查看 nvvp 帮助以获取最新版本）。

```
#!/bin/sh
#
# Script to launch nvprof on an MPI process.  This script will
# create unique output file names based on the rank of the 
# process.  Examples:
#   mpirun -np 4 nvprof-script a.out 
#   mpirun -np 4 nvprof-script -o outfile a.out
#   mpirun -np 4 nvprof-script test/a.out -g -j
# In the case you want to pass a -o or -h flag to the a.out, you
# can do this.
#   mpirun -np 4 nvprof-script -c a.out -h -o
# You can also pass in arguments to nvprof
#   mpirun -np 4 nvprof-script --print-api-trace a.out
#

usage () {
 echo "nvprof-script [nvprof options] [-h] [-o outfile] a.out [a.out options]";
 echo "or"
 echo "nvprof-script [nvprof options] [-h] [-o outfile] -c a.out [a.out options]";
}

nvprof_args=""
while [ $# -gt 0 ];
do
    case "$1" in
        (-o) shift; outfile="$1";;
        (-c) shift; break;;
        (-h) usage; exit 1;;
        (*) nvprof_args="$nvprof_args $1";;
    esac
    shift
done

# If user did not provide output filename then create one
if [ -z $outfile ] ; then
    outfile=`basename $1`.nvprof-out
fi

# Find the rank of the process from the MPI rank environment variable
# to ensure unique output filenames.  The script handles Open MPI
# and MVAPICH.  If your implementation is different, you will need to
# make a change here.

# Open MPI
if [ ! -z ${OMPI_COMM_WORLD_RANK} ] ; then
    rank=${OMPI_COMM_WORLD_RANK}
fi
# MVAPICH
if [ ! -z ${MV2_COMM_WORLD_RANK} ] ; then
    rank=${MV2_COMM_WORLD_RANK}
fi

# Set the nvprof command and arguments.
NVPROF="nvprof --output-profile $outfile.$rank $nvprof_args" 
exec $NVPROF $*

# If you want to limit which ranks get profiled, do something like
# this. You have to use the -c switch to get the right behavior.
# mpirun -np 2 nvprof-script --print-api-trace -c a.out -q  
# if [ $rank -le 0 ]; then
#     exec $NVPROF $*
# else
#     exec $*
# fi 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-22T16:22:41.193

另一种选择是，由于您已经在使用 TAU 来分析应用程序的 CPU 端，您也可以使用 TAU 来收集 GPU 性能数据。TAU 支持多 GPU 执行以及 MPI，请查看[http://www.nic.uoregon.edu/tau-wiki/Guide:TAUGPU](http://www.nic.uoregon.edu/tau-wiki/Guide:TAUGPU)了解如何开始使用 TAU 的 GPU 分析功能的说明。TAU 在下面使用 CUPTI（CUda 性能工具接口），因此您可以使用 TAU 收集的数据与使用 nVidia 的 Visual Profiler 可以收集的数据非常相似。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-10-02T20:49:36.990

自 CUDA 5.0 以来，情况发生了变化，现在我们可以简单地使用`%h`,`%p`和[这里](http://docs.nvidia.com/cuda/profiler-users-guide/index.html#mpi-nvprof-manual-profiling)`%q{ENV}`提到的，而不是使用包装脚本：

```
$ mpirun -np 2 -host c0-0,c0-1 nvprof -o output.%h.%p.%q{OMPI_COMM_WORLD_RANK} ./my_mpi_app 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-19T13:19:17.653

显然，自 2015 年以来，在使用 nvprof 分析器时，可以通过 NVTX 和 mpi_interceptions.so 库自动注释 MPI 调用：

[https://devblogs.nvidia.com/gpu-pro-tip-track-mpi-calls-nvidia-visual-profiler/](https://devblogs.nvidia.com/gpu-pro-tip-track-mpi-calls-nvidia-visual-profiler/)

[http://on-demand.gputechconf.com/gtc/2017/presentation/s7495-jain-optimizing-application-performance-cuda-profiling-tools.pdf](http://on-demand.gputechconf.com/gtc/2017/presentation/s7495-jain-optimizing-application-performance-cuda-profiling-tools.pdf)

根据这个介绍，TAO 仍然不支持分布式深度学习：

[http://on-demand.gputechconf.com/gtc/2017/presentation/s7684-allen-malony-performance-analysis-of-cuda-deep-learning-networks-using-tau.pdf](http://on-demand.gputechconf.com/gtc/2017/presentation/s7684-allen-malony-performance-analysis-of-cuda-deep-learning-networks-using-tau.pdf)

# c# - 在 C# 中的字符串中搜索部分子字符串

> ID：12044929
> 
> 赞同：3
> 
> 时间：2012-08-20T20:50:13.507
> 
> 标签：c#, string, hex, match, partial

好的，所以我正在尝试在 C# 中制作一个基本的恶意软件扫描程序，我的问题是说我有特定代码位的十六进制签名

例如

```
 {
            System.IO.File.Delete(@"C:\Users\Public\DeleteTest\test.txt");
        }

        //Which will have a hex of 53797374656d2e494f2e46696c652e44656c657465284022433a5c55736572735c5075626c69635c44656c657465546573745c746573742e74787422293b 
```

更改为 -

```
 {
            System.IO.File.Delete(@"C:\Users\Public\DeleteTest\notatest.txt");
        }
//Which will have a hex of 53797374656d2e494f2e46696c652e44656c657465284022433a5c55736572735c5075626c69635c44656c657465546573745c6e6f7461746573742e74787422293b 
```

请记住，这些位将包含在程序的整个十六进制中 - 我如何才能获取我的基本签名并寻找部分匹配，说有 90% 匹配因此被标记。

我会做一个通配符，但这不适用于稍微复杂的事情，因为它的编码可能*略有*不同，但大部分是相同的。那么有没有办法可以对子字符串进行百分比匹配？我正在研究 Levenshtein 距离，但我不知道如何将它应用到这个给定的场景中。

提前感谢您的任何输入

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:57:29.743

使用编辑距离就可以了。您可以取两个字符串并计算编辑距离，这将是一个整数值，表示将一个字符串带到另一个字符串需要多少次操作。您根据该数字设置自己的阈值。

例如，您可以静态设置如果距离小于五次编辑，则更改是相关的。

你也可以取你正在比较的字符串的长度并取其中的一个百分比。您的示例长度为 36 个字符，因此`(int)(input.Length * 0.88m)`是一个有效的阈值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T21:17:04.830

首先，您的程序位应该完全匹配，否则它已被修改或损坏。通常，您将在原始二进制文件中存储一个 MD5 散列，并根据新版本检查 MD5 以查看它们是否“足够相同”（MD5 不能保证 100% 匹配）。

除此之外，为了检测随机二进制文件中的恶意软件，您必须知道要寻找什么样的模式。例如，如果我知道某个恶意软件注入了带有一些二进制 XYZ 的代码，我将在可执行文件的位中查找 XYZ。当然，模式比这复杂得多，因为恶意软件位可以以块的形式散布。更有趣的是，有些病毒是自我变形的。这意味着每次运行时，它都会修改自己，这意味着扫描仪不知道要找到的确切模式。在这些情况下，扫描仪必须知道可以生成的衍生产品的类型并查找所有这些类型。

在查找 % 匹配方面，除非您有限制，否则此操作非常耗时。通过比较 2 个字符串，您无法判断哪些部分被删除、添加或替换。例如，如果我有一个起始字符串“ABCD”，那么自从添加内容后，“AABCDD”是否匹配 100% 或更少？那么'ABCDABCD'呢？在这里它匹配了两次。“AXBXCXD”怎么样？“CDAB”呢？

现有的许多 DIFF 工具可以告诉您文件的哪些部分已更改（可能导致 %）。不幸的是，由于我上面描述的问题，它们都不是完美的。你会发现你有误报、误报等。这对你来说可能“足够好”。

在确定适合您的特定算法之前，您必须确定搜索的限制是什么。否则，您的扫描将是 NP 难的，这会导致运行时间不合理（您的扫描仪可能会运行一整天来检查一个文件）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T05:02:51.783

我建议您查看[Levenshtein distance](http://en.wikipedia.org/wiki/Levenshtein_distance)和[Damerau-Levenshtein distance](http://en.wikipedia.org/wiki/Damerau%E2%80%93Levenshtein_distance)。

前者告诉您将一个字符串转换为另一个字符串需要多少次添加/删除操作；后者告诉您将一个字符串转换为另一个字符串需要多少添加/删除/替换操作。

在编写用户可以搜索事物的程序时，我经常使用这些，但他们可能不知道确切的拼写。

两篇文章都有代码示例。

# javascript - setInterval - 我可以让它识别“这个”

> ID：12044933
> 
> 赞同：1
> 
> 时间：2012-08-20T20:50:24.230
> 
> 标签：javascript

我什至不知道如何问这个问题，但我已将代码缩减为最简单的示例：

```
function Handler() {}
Handler.prototype.texts = [];
Handler.prototype.add = function(d) {
  this.texts.push(d);
};
Handler.prototype.tick = function() {
  console.log( this.texts );
};

var x = new Handler();
setInterval( x.tick, 5000 );

x.add('beatles'); 
```

当 setInterval 调用 x.tick 时，它会为 this.texts 提供 undefined 的值——当然还有 for `this`。虽然我可以通过

```
setInterval( x.tick, 5000, x );

// and ... in the prototype
Handler.prototype.tick = function(myObj) {
    console.log( myObj.texts );
} 
```

感觉有点笨拙。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-20T20:51:50.970

`x`像这样进行升值

```
setInterval(function(){
  x.tick()
}, 5000); 
```

触发时`setInterval`，将围绕`x`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T20:52:02.240

采用`Function.prototype.bind`

```
setInterval( x.tick.bind(x), 5000 ); 
```

也有支持旧浏览器的工作垫片： [https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)

# d3.js - 交叉过滤查询

> ID：12044935
> 
> 赞同：28
> 
> 时间：2012-08-20T20:50:29.623
> 
> 标签：d3.js, crossfilter

是否可以过滤以数组为值的交叉过滤器数据集？

例如，假设我有以下数据集：

```
var data = [
  {
    bookname: "the joy of clojure",
    authors: ["Michael Fogus", "Chris Houser"],
    tags: ["clojure", "lisp"]
  },
  {
    bookname: "Eloquent Ruby",
    authors: ["Russ Olsen"],
    tags: ["ruby"]
  },
  {
    bookname: "Design Patterns in Ruby",
    authors: ["Russ Olsen"],
    tags: ["design patterns", "ruby"]
  }
]; 
```

是否有一种简单的方法可以访问由特定标签标记的书籍？还有那些有特定作者的书？到目前为止，我理解如何使用交叉过滤器的方式让我做了这样的事情：

```
var filtered_data = crossfilter(data);
var tags = filtered_data.dimension(function(d) {return d.tags});
var tag = tags.group(); 
```

然后当我访问分组时（像这样）：

```
tag.all() 
```

我明白了：

```
[{key: ["clojure", "lisp"], value: 1}, 
 {key: ["design patterns", "ruby"], value: 1}, 
 {key: ["ruby"], value: 1}] 
```

当我宁愿有这个时：

```
[{key: "ruby", value: 2}, 
 {key: "clojure", value: 1}, 
 {key: "lisp", value: 1},
 {key: "design patterns", value: 1}] 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-08-30T07:15:14.767

我在下面的代码中添加了注释。大图：使用reduce函数。

```
var data = ...
var filtered_data = crossfilter(data);
var tags = filtered_data.dimension(function(d) {return d.tags});

tags.groupAll().reduce(reduceAdd, reduceRemove, reduceInitial).value() 
```

请注意我是如何使用**groupAll()**而不是**group()** b/c 我们希望我们的 reduce 函数（定义如下）对一组而不是 3 个组进行操作。

现在 reduce 函数应该如下所示：

```
/*
 v is the row in the dataset

 p is {} for the first execution (passed from reduceInitial). 
 For every subsequent execution it is the value returned from reduceAdd of the prev row
*/
function reduceAdd(p, v) {
  v.tags.forEach (function(val, idx) {
     p[val] = (p[val] || 0) + 1; //increment counts
  });
  return p;
}

function reduceRemove(p, v) {
   //omitted. not useful for demonstration
}

function reduceInitial() {
  /* this is how our reduce function is seeded. similar to how inject or fold 
   works in functional languages. this map will contain the final counts 
   by the time we are done reducing our entire data set.*/
  return {};  
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T22:06:55.657

我从未使用过“crossfilter”（我假设这是一个 JS 库）。不过，这里有一些纯 JS 方法。

这...

```
data.filter(function(d) {
  return d.authors.indexOf("Michael Fogus") !== -1;
}) 
```

返回这个：

```
[{bookname:"the joy of clojure", authors:["Michael Fogus", "Chris Houser"], tags:["clojure", "lisp"]}] 
```

这...

```
var res = {};
data.forEach(function(d) {
  d.tags.forEach(function(tag) {
    res.hasOwnProperty(tag) ? res[tag]++ : res[tag] = 1
  });
}) 
```

返回这个：

```
({clojure:1, lisp:1, ruby:2, 'design patterns':1}) 
```

对于其中任何一个，您都可以申请`d3.entries`获取您的`{key:"ruby", value: 2}`格式。

# sql - 使用大型数据集更新语句需要 10 分钟

> ID：12044938
> 
> 赞同：0
> 
> 时间：2012-08-20T20:50:38.450
> 
> 标签：sql, sql-server-2005

我有一个 SQL 存储过程，其中一个语句需要 95% 的总时间（10 分钟）才能完成。`#Records`大约有 133,000 行和`Records`大约 12,000 行。

```
 -- Check Category 1 first
  UPDATE #Records
    SET Id = (SELECT TOP 1 Id FROM Records WHERE Cat1=#Records.Cat1)
    WHERE Cat1 IS NOT NULL 
```

我尝试`Cat1`在 in 中添加索引`#Records`，但语句时间没有改善。

```
CREATE CLUSTERED INDEX IDX_C_Records_Cat1 ON #Records(Cat1) 
```

随后的类似语句只需要一小部分时间

```
 -- Check Category 2
  UPDATE #Records
    SET Id = (SELECT TOP 1 Id FROM Records WHERE Cat2=#Records.Cat2)
    WHERE ID IS NULL 
```

关于为什么会发生这种情况或我可以做些什么来使这个陈述更有效的任何想法？

提前致谢。

我在 Microsoft SQL Server 2005 上运行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:53:43.200

我会说您的问题可能是您使用的是相关子查询而不是联接。连接在集合中工作，相关的子查询逐行运行，本质上是游标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T22:07:58.247

更新加入也许

```
update t
set t.ID = r.ID
FROM (Select Min(ID) as ID,Cat1 From Records group by cat1) r 
INNER JOIN #Records t ON r.Cat1 = t.cat1 
Where t.cat1 is not null 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-08-21T10:43:39.790

根据我的经验，当您尝试更新大量记录时，有时使用游标并遍历记录而不是使用更新查询会更快。

也许这对您有帮助。

# xml - clojurescript：使用 xml？

> ID：12044942
> 
> 赞同：11
> 
> 时间：2012-08-20T20:50:51.650
> 
> 标签：xml, clojure, clojurescript

我的 Clojurescript 应用程序需要处理基于 XML 的 API。我知道大多数透明的远程处理解决方案，如[fetch](https://github.com/ibdknox/fetch)，但它们似乎要求两端都用 Clojure 编写（即 fetch 似乎是一个 noir/clojurescript 解决方案）。

使用 Clojurescript 使用 XML API 的“正确方法”是什么？

我只是满足于能够将 XML 片段翻译成嵌套的 Clojure 数据结构（嵌套向量），打嗝式，但一个好的处理 API 将不胜感激（`unify`可能像 C2 的东西？）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-08-28T15:35:25.443

您是否为此尝试过 Google Closure 库？

*编辑*Google Closure 库已移至 github。[https://github.com/google/closure-library](https://github.com/google/closure-library)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-05T14:54:07.273

我知道这是一个老问题，但对于那些在这里寻找它的人（比如我）。您可以尝试使用[Tubax](https://github.com/funcool/tubax)库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-08-26T10:13:01.130

我建议将 clojure XML 库之一移植到 clojurescript 来执行此操作

# cuda - cudaMemcpySymbolToSymbol 在哪里？

> ID：12044944
> 
> 赞同：1
> 
> 时间：2012-08-20T20:51:07.770
> 
> 标签：cuda

我正在尝试在同一设备上将一个符号的内容复制到另一个符号。我没有找到任何支持。

```
__device__ int someData;
__constant__ int someConst; 
```

;

```
int temp;
cudaMemcpyFromSymbol(&temp,"someConst",sizeof(int),0,cudaMemcpyFromHostToDevice);
cudaMemcpyToSymbol("someData",&temp,sizeof(int),0,cudaMemcpyDeviceToHost); 
```

或者

```
int *tmp
cudaMalloc((void**)tmp,sizeof(int);
cudaMemcpyFromSymbol(tmp,"someConst",sizeof(int),0,cudMemcpyDeviceToDevice);
cudaMemcpy(toSymbol("someData",tmp,sizeof(int),0,cudaMemcpyDeviceToDevice);
cudaFree(tmp); 
```

有没有更简单的从符号复制到符号的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-21T05:12:45.547

没有符号到符号 API 调用。如果您要多次执行此操作，最好的方法可能是在设置代码中是这样的：

```
__device__ int someData;
__constant__ int someConst;

int * _D, * _C;
cudaGetSymbolAddress((void **)&_D, someData);
cudaGetSymbolAddress((void **)&_C, someConst); 
```

它可以让你获得 GPU 内存中两个符号的地址，然后使用它`cudaMemcpy`，所以：

```
cudaMemcpy(_C, _D, sizeof(int), cudaMemcpyDeviceToDevice); 
```

这样做可以消除符号查找开销并减少对设备到设备复制调用的操作。

# php - Facebook SDK 保持以特定用户身份登录

> ID：12044948
> 
> 赞同：0
> 
> 时间：2012-08-20T20:51:27.030
> 
> 标签：php, facebook, facebook-php-sdk

我有一个网站，我需要在其中提取与我的伴侣一起标记的所有照片。这需要两个用户的扩展访问权限。我已经设法让它工作，但每次访问权限到期时，我都需要以自己的身份登录 Facebook。

我需要做的是***无限期地***授予我的应用程序这些扩展访问权限，这样我就不需要登录 Facebook 来查看照片。

基本上，我希望我网站的任何随机访问者都可以看到我和我的伴侣 [来自 Facebook] 的照片，而无需登录 Facebook。

这甚至可能吗？

# python - 如何更新已检索到的文档？

> ID：12044950
> 
> 赞同：0
> 
> 时间：2012-08-20T20:51:28.467
> 
> 标签：python, mongodb, pymongo

我正在检索这样的文档：

`user = db.users.find_one( { '_id' : ObjectId( 'anID' ) } )`

但是如果我想更改“性别”的值，我不知道如何更新文档。这不起作用：

```
newValue = { 
        'gender' : gender
        }

db.users.update( user, newValue, False ) 
```

我的语法错了吗？更新用户的最佳方式是什么

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T22:29:54.660

您的更新语法不正确，应该是：

```
update(spec, document, upsert=False, multi=False, ...) 
```

`spec`您用于查找的过滤器在哪里，即`{ '_id' : ObjectId( 'anID' ) }`

您可以通过将文档替换为修改后的文档来更新文档，也可以使用有针对性的更新来仅更改某个值。有针对性的更新的优点是它节省了您到服务器获取用户文档的第一次往返。

更换更新：

```
user = db.users.find_one( { '_id' : ObjectId( 'anID' ) } )
user['gender'] = newGender
db.users.update( { '_id' : user['_id'] }, user, False) 
```

有针对性的更新：

```
db.users.update( { '_id' : ObjectId( 'anID' ) }, \
                 { '$set': { 'gender' : newGender } }, False ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:13:05.303

如果您不想替换整个文档，则应使用[$set](http://www.mongodb.org/display/DOCS/Updating#Updating-%24set)运算符：

```
db.users.update( { '_id': user['_id'] }, { '$set': newValue }, False ) 
```

# android - 在 Android 中长期运行的服务上读取、存储和发送读取的 GPS 位置

> ID：12044952
> 
> 赞同：2
> 
> 时间：2012-08-20T20:51:34.947
> 
> 标签：android, multithreading, sqlite, gps, locationlistener

**设想**

**第 1 步：**初始化位置管理器以每 50 米读取一次 GPS 位置：

```
locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 50, locationListenerGps); 
```

**第 2 步：**每次读取位置时：

```
@Override
    public void onLocationChanged(Location location) {
        new Thread(new Runnable() {
            @Override
            public void run() {
                sendLocation(location);
            }
        }).start();
    } 
```

**第 3 步：**在 sendLocation 上，我做了几件事：

*   查询本地sqlite数据库发送失败记录
*   如果有，将它们与当前位置一起发送到 Web 服务
*   如果没有，只发送当前位置
*   如果发送失败（主要是因为数据连接），则在数据库中插入位置以供将来读取
*   如果发送成功，则从数据库中删除所有行

**问题**

所有这些都是在服务的后台完成的。对于每个 sendLocation 调用，我都会创建一个新线程。虽然连接正常，但一切正常。但是，当发送失败并且用户正在开车时，位置读取会经常发生，并且很有可能有 2-3 个线程都试图发送相同的未发送位置。如果 Thread1 收到列表并尝试发送它，Thread2 和 Thread3 应该无法读取它并尝试发送它，因为 Thread1 可能会成功发送它。我怎样才能防止这种情况发生？如何确保 Thread2 不读取列表？

从我现在的想法来看，我可以在“处理”表中添加一个新字段，并且对于检索到的所有发送行，将该字段更新为 true。在这种情况下，Thread2 只会得到 processing=false 行。这是一个解决方案吗？还有其他建议吗？我仍然认为 Thread2 获取数据有细微的变化，而 Thread1 正在更新处理...谢谢。

**稍后编辑：我尝试过这种方法的**额外想法和想法****

 **```
private ExecutorService threadPool;

@Override
public void onCreate() {
    scheduleTaskExecutor = Executors.newSingleThreadScheduledExecutor();
    threadPool = Executors.newSingleThreadExecutor();

     //also need to send location every 60 seconds if no other location was read
    scheduleTaskExecutor.scheduleAtFixedRate(new Runnable() {
        @Override
        public void run() {
              sendLocation(lastLocation);
                  }
    }, 60, 60, TimeUnit.SECONDS);
}

@Override
    public void onLocationChanged(Location location) {
         threadPool.execute(new Runnable() {
         @Override
         public void run() {
             sendLocation(location);
         }
     });
    }

@Override
public void onDestroy() {
    threadPool.shutdownNow();
} 
```

根据我的阅读，这个 threadPool 应该强制线程一个接一个地执行，对吧？（即使我确实感觉我误解了它的目的）如果是这样，如果我一个小时没有连接会发生什么？对于读取的每个位置，都会添加一个新线程......但是这个线程持续多长时间？我担心如果用户开得非常快会发生什么，我可以每 1-2 秒读取一次位置，这种机制是否会将我的 Web 访问保持在一个队列中，一个线程接一个线程？

在另一个想法中，如果我创建一个新线程的服务的 onCreate 方法会怎样。就像是：

```
 @Override
    public void onCreate() {
            new Thread(new Runnable() {
                @Override
                public void run() {
                     startLocationListener();
                }
            }).start();
        } 
```

在 startLocationListener() 中，我开始读取 GPS 位置。onLocationChanged 会在这个线程上执行并且不会干扰我的 UI 线程吗？

使用在自己的线程中运行的服务会更明智吗？所以我不必担心线程？

使用当前的方法，应用程序完成了工作，但是随机发生了一些错误并且无法找出原因：我的一个活动绑定到服务以接收更新，当应用程序启动时我小心地取消绑定它 onPause.. . 但有时服务会继续运行，因为我可以看到它的通知图标显示。我将对此进行更多调查，但我需要确定一种强大/可靠的方式来处理位置读取和发送。

**稍后稍后编辑**

这种方法怎么样：

```
private ExecutorService scheduleTaskExecutor;

    @Override
    public void onCreate() {
        scheduleTaskExecutor = Executors.newSingleThreadScheduledExecutor();

         //also need to send location every 60 seconds if no other location was read
        scheduleTaskExecutor.scheduleAtFixedRate(new Runnable() {
            @Override
            public void run() {
                  sendLocation(lastLocation);
                      }
        }, 60, 60, TimeUnit.SECONDS);
    }

    @Override
        public void onLocationChanged(Location location) {
             scheduleTaskExecutor.submit(new Runnable() {
             @Override
             public void run() {
                 sendLocation(location);
             }
         });
        }

    @Override
    public void onDestroy() {
        scheduleTaskExecutor.shutdownNow();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:58:07.200

> 对于每个 sendLocation 调用，我都会创建一个新线程。

为什么？

> 但是，当发送失败并且用户正在开车时，位置读取会经常发生，并且很有可能有 2-3 个线程都试图发送相同的未发送位置。

这就是为什么我问“为什么？” 多于。

> 如果 Thread1 收到列表并尝试发送它，Thread2 和 Thread3 应该无法读取它并尝试发送它，因为 Thread1 可能会成功发送它。我怎样才能防止这种情况发生？如何确保 Thread2 不读取列表？

恕我直言，首先没有 Thread2 和 Thread3。一次使用一个线程，发送所有未发送的数据。这可能是一个长期存在的线程，在工作队列中工作（加上某种计时器机制来处理您之前未能更新的情况，并希望确保您在 X 时间段后再次尝试，如果没有其他事件迫使你早点尝试）。我不明白为什么你需要更多的东西来实现你的目标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-04T07:40:45.757

所以让我直截了当地说：你想从后台线程一个接一个地发送位置。实现此目的的一个简单方案是（类似于您编辑的代码，但我看不出原因`ScheduledExecutor`）：

```
private ExecutorService exec;

@Override
public void onCreate() {
    exec = Executors.newSingleThreadExecutor();
}

@Override
public void onLocationChanged(Location location) {
    exec.submit(new Runnable() {
         @Override
         public void run() {
             sendLocation(location);
         }
    });
}

@Override
public void onDestroy() {
    exec.shutdownNow();
} 
```

这在幕后所做的基本上是创建一个后台线程和一个任务队列。每次读取位置时，都会将新任务放入队列中。线程不断地轮询队列并按顺序执行任务。**

# java - Java HashSet 二维数组重复识别

> ID：12044953
> 
> 赞同：1
> 
> 时间：2012-08-20T20:51:38.247
> 
> 标签：java

我需要检查 2d char 数组的列表/集是否包含我作为参数传递的另一个 2d char 数组的完全相同的副本。我的想法是制作一个`HashSet`然后使用该`contains()`方法，但这并没有真正起作用；我认为这与我传递二维数组方法有关。如果可能的话，我不想遍历列表中的每个项目，因为这太昂贵了。请帮帮我。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T21:00:51.077

这永远不会奏效，因为`hashCode`数组的 's 是基于`Object`'s 的，所以除非你试图找到相同的引用，否则你永远不会得到 a`contains`来评估`true`。

您应该为您的数组和 and 创建一个`override`包装`hashCode`器`equals`。您可以为此目的使用[Arrays.deepEquals](http://docs.oracle.com/javase/6/docs/api/java/util/Arrays.html#deepEquals%28java.lang.Object%5B%5D,%20java.lang.Object%5B%5D%29)

# c - 声明一个足够大的数组来容纳一个类型

> ID：12044955
> 
> 赞同：2
> 
> 时间：2012-08-20T20:51:47.467
> 
> 标签：c, arrays, embedded, size, sizeof

假设我得到了一个具有以下签名的函数：

```
void SendBytesAsync(unsigned char* data, T length) 
```

我需要一个足够大的缓冲区来容纳可以由 type 指定的最大长度的字节数组`T`。如何声明该缓冲区？我不能只使用`sizeof`它，因为它将返回 T 类型的大小（以字节为单位），而不是该类型可以包含的最大值。我不想使用limits.h，因为基础类型可能会改变并且我的缓冲区太小。我不能使用 math.h 中的 pow 因为我需要一个常量表达式。那么如何在 C 的编译时获得一个类型的最大大小的常量表达式呢？

## 编辑

该类型将是无符号的。由于每个人似乎都对在编译时确定的静态分配缓冲区的想法感到震惊，所以我将提供一些背景知识。这适用于可靠性和速度是优先考虑的嵌入式应用程序（在微控制器上）。`malloc`因此，为了运行时完整性（没有问题）和性能（每次我需要缓冲区时没有内存分配开销），我完全可以浪费静态分配的内存。我理解如果最大大小`T`太大我的链接器将无法分配那么大的缓冲区的风险，但这将是编译时失败，可以适应，而不是运行时失败，这不能容忍。例如，如果我使用`size_t`对于有效负载的大小和动态分配内存，系统很有可能没有那么多可用内存。我宁愿在编译时知道这一点，而不是在运行时这会导致数据包丢失、数据损坏等。看看我提供的函数签名，提供一个类型作为动态的大小参数是荒谬的分配的缓冲区并且不期望调用者将使用该类型的最大值的可能性。所以我不知道为什么似乎有这么多关于分配内存的惊愕，永远。我可以看到这在 Windows 世界中是一个巨大的问题，其中多个进程正在争夺相同的内存资源，但在嵌入式世界中，只有一项任务需要完成，如果你不能有效地做到这一点，那么它就不会。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T21:10:17.400

使用`_Generic`：

```
#define MAX_SIZE(X) _Generic((X),
                             long: LONG_MAX,
                             unsigned long: ULONG_MAX,
                             /* ... */) 
```

在 C11 之前，没有一种可移植的方法来找到 T 类型对象的精确最大值（`CHAR_BIT`例如，所有使用 的计算都可能由于填充位而产生高估）。

编辑：请注意，在某些条件下（想想现实生活中的分段内存），您可能无法分配足够大的缓冲区以等于任何给定类型 T 的最大值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T21:24:25.470

您是否有理由分配最大可能的缓冲区大小而不是仅与您需要一样大的缓冲区？为什么不让调用者简单地指定所需的内存量？

回想一下，该`malloc()`函数接受一个类型为 的参数`size_t`。这意味着`(size_t)(-1)`（`SIZE_MAX`在 C99 及更高版本中）将表示可以传递给`malloc`. 如果您`malloc`用作分配器，那么这将是您的绝对上限。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-08-20T21:03:19.570

如果 T 是无符号的，那么 ((T) -1) 会起作用吗？

（这可能真的很糟糕，如果是这样，请告诉我原因:-)）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-08-20T21:07:06.730

也许尝试使用位移？

让我们来看看：

`unsigned long max_size = (1 << (8 * sizeof(T))) - 1`

sizeof(T) 为您提供 T 在内存中占用的字节数。（技术上不正确。通常编译器会将结构与内存对齐......所以如果 T 是一个字节，它实际上会分配 4 或其他东西。）

分解它：

`8 * sizeof(T)`给你 size 代表的位数

`1 << x`是一样的说法`2 to the x power`。因为每次你向左移动，你就乘以 2。就像每次以 10 为基数向左移动一样，您乘以 10。

`- 1`一个 8 位数可以容纳 256 个值。0..255。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-08-20T21:07:03.623

有趣的问题。我将首先在“限制”标题中查找数字类型 T 的最大值。我没有尝试过，但我会做一些使用 T::max 的事情

# javascript - BackboneJS 路由

> ID：12044956
> 
> 赞同：0
> 
> 时间：2012-08-20T20:51:49.657
> 
> 标签：javascript, backbone.js, backbone-routing

我的应用程序的索引页面位于`http://cms/admin`（我在本地主机上）。在索引页面上只有一个`a`元素：

```
<a href="/admin/test">deneme</a> 
```

当我单击链接时，它转到`/cms/admin/test`

我想使用 BackboneJS 的路由机制将我的应用程序转换为对 ajax 友好的应用程序，但直到现在我才能做到。这是我的 JS 代码：

```
$(function() {
    var AppRouter = Backbone.Router.extend({
        routes: {
            "test": "defaultRoute"
        },

        defaultRoute: function() {
            console.log('its here');
        }
    });

    var appRouter = new AppRouter();

    Backbone.history.start({
        pushState: true,
        slient: true,
        root: '/admin/'
    });
}); 
```

当我运行该页面并单击该链接时，它不会将任何内容记录到控制台并且浏览器会跟随该链接。页面加载后，它会记录“它在这里”消息。

我已经在没有根参数的情况下尝试过，“/admin/test”而不是“test”。我尝试了各种组合：“test”、“/test”、“test/”、“/admin/test”、“admin/test”等。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-08-20T21:05:00.227

您必须覆盖链接的默认行为。

您必须在显式调用`appRouter.navigate("test", {trigger: true});`. 因此，尝试在[View.events](http://backbonejs.org/#View-delegateEvents)中捕获链接上的*点击事件*，[防止链接的默认行为](http://api.jquery.com/event.preventDefault/)并调用[appRouter.navigate()](http://backbonejs.org/#Router-navigate)

### 更新

您也可以批量执行此操作：

```
$("a.bb_link").each( function( index, link ){
  $(link).click( function( event ){
    event.preventDefault();
    appRouter.navigate( $(this).attr( "href" ), {trigger: true} );
  });
});​ 
```

每个类的链接`bb_link`都将使用 Backbone.Router。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T21:03:45.440

尝试如下设置您的锚标记：

`<a href="#admin/test">deneme</a>`

注意哈希 (#)

# ssh - SSH：成功登录后本地主机关闭连接

> ID：12044958
> 
> 赞同：10
> 
> 时间：2012-08-20T20:51:55.410
> 
> 标签：ssh, terminal, osx-server

当我尝试 ssh 进入 localhost 时，它接受公钥并立即关闭连接。我已经浏览了几个小时的 Google 结果页面，但没有任何进展。这是我得到的`ssh -v user@localhost`：

```
OpenSSH_5.9p1, OpenSSL 0.9.8r 8 Feb 2011
debug1: Reading configuration data /Users/user/.ssh/config
debug1: Reading configuration data /etc/ssh_config
debug1: /etc/ssh_config line 20: Applying options for *
debug1: Connecting to localhost [::1] port 22.
debug1: Connection established.
debug1: identity file /Users/user/.ssh/id_rsa type -1
debug1: identity file /Users/user/.ssh/id_rsa-cert type -1
debug1: identity file /Users/user/.ssh/id_dsa type 2
debug1: identity file /Users/user/.ssh/id_dsa-cert type -1
debug1: Remote protocol version 2.0, remote software version OpenSSH_5.9
debug1: match: OpenSSH_5.9 pat OpenSSH*
debug1: Enabling compatibility mode for protocol 2.0
debug1: Local version string SSH-2.0-OpenSSH_5.9
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: server->client aes128-ctr hmac-md5 none
debug1: kex: client->server aes128-ctr hmac-md5 none
debug1: SSH2_MSG_KEX_DH_GEX_REQUEST(1024<1024<8192) sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_GROUP
debug1: SSH2_MSG_KEX_DH_GEX_INIT sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_REPLY
debug1: Server host key: RSA 67:2f:0b:c8:40:e8:87:0f:57:ee:c7:68:ae:8a:5a:02
debug1: Host 'localhost' is known and matches the RSA host key.
debug1: Found key in /Users/user/.ssh/known_hosts:1
debug1: ssh_rsa_verify: signature correct
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: Roaming not allowed by server
debug1: SSH2_MSG_SERVICE_REQUEST sent
debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey,keyboard-interactive
debug1: Next authentication method: publickey
debug1: Trying private key: /Users/user/.ssh/id_rsa
debug1: Offering DSA public key: /Users/user/.ssh/id_dsa
debug1: Server accepts key: pkalg ssh-dss blen 433
debug1: read PEM private key done: type DSA
Connection closed by ::1 
```

我正在运行 OSX 10.8，通过终端使用 ssh。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-08-20T23:31:33.743

好的，所以最终起作用的是明确允许来自`user`. 设置`System Prefs > Sharing > Remote Login > Allow access for:`为`All Users`不起作用；相反，我必须检查`Only these users:`并手动添加所有用户。希望这可以帮助其他有同样问题的人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-08-20T21:14:26.133

很久以前，我在使用 Telnet 时遇到过同样的问题，如果我没记错的话，问题是用户在 /etc/passwd 中没有主目录。我假设您正在尝试创建无密码连接，对吗？当你用谷歌搜索时，这里有一个很好的解释：http: [//diuf.unifr.ch/main/tech/node/57](http://diuf.unifr.ch/main/tech/node/57) 另外，这里有一个解释如何快速使无密码连接[http://greg -n-blog.blogspot.com/search/label/scp](http://greg-n-blog.blogspot.com/search/label/scp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T20:10:40.967

这在 Cygwin 中使用 Windows 在大型域中对我有用：

将您的 Windows 用户 ID 添加到`/etc/passwd`. 您可以通过键入 $ 来获取它`mkpasswd -d | grep [username]`。在大型域中，您可能需要等待几个小时。

确保给出的用户 ID`/etc/passwd`与 $ 中的用户 ID 匹配`id -u`，并且组 ID 与管理员的用户 ID 匹配`/etc/group`

# css - 我如何让字体像这样平滑显示？

> ID：12044962
> 
> 赞同：0
> 
> 时间：2012-08-20T20:52:16.100
> 
> 标签：css, fonts

嘿，如果你看看下面的这个链接

[http://www.thesun.co.uk/sol/homepage/showbiz/4491771/Cheryls-been-married-she-may-hurt-my-son-Tre.html](http://www.thesun.co.uk/sol/homepage/showbiz/4491771/Cheryls-been-married-she-may-hurt-my-son-Tre.html)

你会注意到故事的标题，“Cheryl Cole 结婚了……她可能伤害了我的儿子，Tre”，非常流畅，看起来就像在 Photoshop 中完成的文字，我想知道，字体是如何变得如此流畅的看，我多年来一直想知道这一点。是 css 还是 html，当我查看他们的源代码时，它似乎是某种 javascript。

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:59:57.913

他们只是使用标准字体（`font-family: Impact`）并使其变大（`font-size: 50px`）。根据您的浏览器、操作系统和您自己的设置，不同大小的不同字体可能会触发抗锯齿（您非常喜欢的平滑效果）。

编辑：

某些设置仅“平滑”字体大于特定大小（比如说 16 像素或更高）。因此，为了便于阅读，小于 16px 的文本不会被平滑，而 16+ px 的文本将被消除锯齿（平滑）。

有些设置不做任何抗锯齿。有些人总是做抗锯齿。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-08-20T20:59:49.740

那场直播的计算风格是这样的，我已经突出显示了字体系列......也许这就是你的意思。

`-webkit-background-clip: border-box; -webkit-background-origin: padding-box; -webkit-background-size: auto; -webkit-border-image: none; background-attachment: scroll; background-clip: border-box; background-color: transparent; background-image: none; background-origin: padding-box; background-size: auto; border-bottom-color: black; border-bottom-style: none; border-bottom-width: 0px; border-left-color: black; border-left-style: none; border-left-width: 0px; border-right-color: black; border-right-style: none; border-right-width: 0px; border-top-color: black; border-top-style: none; border-top-width: 0px; clear: none; color: black; display: block;` **`font-family: impact, helvetica, sans-serif;`** `font-size: 50px; font-weight: normal; height: 100px; line-height: 50px; list-style-image: none; list-style-position: outside; list-style-type: none; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; max-width: none; outline-color: black; outline-style: none; outline-width: 0px; overflow-x: visible; overflow-y: visible; padding-bottom: 10px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; width: 620px;`

# git - Git SVN rebase 失败，没有有意义的错误

> ID：12044963
> 
> 赞同：0
> 
> 时间：2012-08-20T20:52:27.880
> 
> 标签：git, git-svn

以下情况最近发生在我身上。

我在 Linux (RHEL) 上的一个分支上使用 git svn。我提交了一些本地更改，然后尝试 git svn rebase。错误信息如下：

```
First, rewinding head to replay your work on top of it...
Applying: My Commit Message
Patch failed at 0001 My Commit Message

When you have resolved this problem run "git rebase --continue".
If you would prefer to skip this patch, instead run "git rebase --skip".
To restore the original branch and stop rebasing run "git rebase --abort".

rebase refs/remotes/trunk: command returned error: 1 
```

中止工作正常。这里面没有什么我知道如何解决的。有小费吗？

谢谢参观，

泰迪熊

**更新**

我设置东西的方式是一个主要的 git-svn 存储库，我在 svn 外部的子目录中使用 3 个 git-svn 存储库。SVN 主干头似乎是这些外部设备之一的签到。有没有人能够阐明这是否会导致这个问题出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:58:30.407

“补丁失败”是一个有意义的错误。基本上，这意味着您对分支所做的更改不会完全适用于主干。尝试`git status`查看冲突在哪里，解决它并执行`git rebase --continue`.

# php - PHP 使用 Cookie 在数据库中存储当前会话 ID

> ID：12044964
> 
> 赞同：3
> 
> 时间：2012-08-20T20:52:28.573
> 
> 标签：php, security

我创建了一个使用 cookie 并将会话 ID 存储在数据库中的登录系统，因此您的登录仅适用于该特定会话 ID。我意识到这有几个问题：

1.  如果您在另一台设备上登录，则会话 ID 会更改（没有多次登录）
2.  会话 ID 实际上是唯一将用户标识为已登录的东西（我不确定这是否存在安全风险，因为 cookie 是特定于域的）

但是，我想保留 cookie 附带的持久登录，同时仍然保持安全。

实际上，我想知道是否有更好的方法可以使用 cookie 将用户安全地登录到网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-21T01:36:40.340

首先，保持东西的安全和持久登录不能一起使用。您总是会通过以某种方式引入持久登录来损害安全性。

话虽如此，查尔斯米勒的[一篇文章概述了这样一个系统：](http://fishbowl.pastiche.org/2004/01/19/persistent_login_cookie_best_practice)

1.  创建一个（足够大的）随机键，最好使用`/dev/urandom`or`openssl_random_pseudo_bytes()`并将其与帐户相关联（在数据库术语中：一个单独的表，其中随机键作为主（或唯一）索引，帐户作为外键）；关键将是 cookie 值。

2.  当未登录的用户出示 cookie 时，会查找密钥和帐户并登录用户；之后，使用的密钥被一个新的随机密钥替换（cookie 也被更新）。

3.  仅通过 cookie 登录的用户在访问敏感（帐户）信息时应再次被要求输入密码。

4.  用户应该可以选择从他的所有设备中注销。

`session_regenerate_id()`每当用户登录时（通过表单或 cookie），使用更新会话 ID 也是一个好习惯。这可以防止某人对其他人发起会话固定攻击并可能窃取他们的身份。

[可以在此处](http://jaspan.com/improved_persistent_login_cookie_best_practice)找到 Barry Jaspen 对这种设计的改进，它还可以处理身份盗窃检测。

# iphone - popToRootViewController 以及如何在此处更新信息

> ID：12044965
> 
> 赞同：0
> 
> 时间：2012-08-20T20:52:28.717
> 
> 标签：iphone, ios

**设想**

我的项目结构是

```
A---B---C---D---E 
```

A 是根视图，我在 E

成功完成一些交易后，我正在做

```
- (void) successfulToDoTransaction: {
    [self.navigationController popToRootViewControllerAnimated:YES];
} 
```

这将带我回到 A 控制器，并且在 AI 中希望显示在 E 中已成功完成的一些信息。

**目标 ：**

告诉视图控制器重新加载以获取最新信息的最佳方法是什么...我正在考虑使用如下通知（伪代码）但不确定这是最好的方法...

如果您对此有任何想法，请提出建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:55:10.727

使您的根视图控制器“A”成为“E”的**代表**

您可以通过将“A”设为中间视图控制器的属性来传递它。

有关委托的一个很好的例子，请查看 Apple 的食谱示例代码：http: [//developer.apple.com/library/ios/#samplecode/iPhoneCoreDataRecipes/Introduction/Intro.html](http://developer.apple.com/library/ios/#samplecode/iPhoneCoreDataRecipes/Introduction/Intro.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-08-20T20:54:42.897

您可以随时添加 -(void)viewDidAppear 方法来重新加载内容。如果这不是您要采用的路线，则在视图控制器 A 中使用 NSNotificationCenter 和 addObserver ，在视图控制器 E 中使用 postNotification 。

# python - （不继承列表）Deck 类（纸牌游戏）可用于 for 循环，无需 __iter__

> ID：12044970
> 
> 赞同：2
> 
> 时间：2012-08-20T20:52:42.123
> 
> 标签：python, for-loop, iteration

伙计们，

几天之内，我只是在考试前做我通常的随机小程序，我决定写一张五张抽牌扑克。因为它只是为了玩一点代码，所以我没有从基本类继承任何东西。我的卡片组包含一个列表属性，该属性已被赋予简单的可读性和功能所需的功能：

```
import random

from card import Card

class Deck():

    def __init__(self):
        self.cards = self.__generate_cards()
        random.shuffle(self.cards)

    def __str__(self):
        cards_str = ""
        for card in self.cards:
            cards_str += str(card)
        return cards_str

    def __getitem__(self,index):
        return self.cards[index]

    def __generate_cards(self):
        cards = []
        for i in range(4):
            for j in range(13):
                cards.append(Card(i,j+1))
        return cards

    def pop(self,index):
        return self.cards.pop(index) 
```

正如你所看到的，没有`.__iter__`方法可以找到，这意味着我不能迭代一个`Deck()`对象，对吧？Python 向我展示了一个不同的故事：由于某种原因，下一个代码导致循环卡对象`self.cards`并实际打印卡而不需要`iterator`：

```
deck = Deck()
for card in deck:
    print(card)    # cards have a __str__ method 
```

对我来说没有多大意义，除非它是 python 魔法的一部分，给任何对象一个可能循环的机会。;p 谁能给我看一下这个灯？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T20:55:10.703

[为什么在类上定义 __getitem__ 使其在 python 中可迭代？](https://stackoverflow.com/questions/926574/why-does-defining-getitem-on-a-class-make-it-iterable-in-python)

这是一个向后兼容的事情。使其`__getitem__`可迭代。

# java - 使非同步数据结构线程安全的方法

> ID：12044972
> 
> 赞同：5
> 
> 时间：2012-08-20T20:52:56.553
> 
> 标签：java, thread-safety, synchronized

我想知道除了使用and之`synchronized`类的数据结构或使用or之类的包装器之外，还有其他方法可以使非同步数据结构成为线程安全的吗？`Hashtable``Vector``Collections.synchronizedList(List<T> arg)``Collections.synchronizedMap(Map<K,V> arg)`

面试时有人问我如何使 hashmap 线程安全，我告诉他使用`Hashtable`或`ConcurrentHashMap`使用`Collections.synchronizedMap`包装器，但是，这些答案似乎不是他想要的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-08-20T20:58:23.790

是的，你可以让它[不可变](http://docs.oracle.com/javase/tutorial/essential/concurrency/immutable.html)。这实际上是在许多情况下使代码线程安全的好方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-08-20T20:55:16.043

是的。如果您自己进行构造的同步。但由于明显的原因，不建议这样做......

# c# - 带有和不带有调试器的 WinPhone 7.1 上的 HttpWebRequest

> ID：12044975
> 
> 赞同：0
> 
> 时间：2012-08-20T20:53:04.580
> 
> 标签：c#, windows-phone-7, windows-phone-7.1.1

我正在尝试向 Web 服务发出一个简单的请求。代码在后台执行，而不是 UI 线程。Uri 包含正确的地址，该地址始终返回带有 200 HTTP 代码的结果。一切都在模拟器上进行。

```
var request = WebRequest.Create(uri);
try
{
    var ar = request.BeginGetResponse(_ => { }, null);
    using (var response = request.EndGetResponse(ar)) //NullReferenceException rises here
    using (var stream = response.GetResponseStream())
    {
        var serializer = new DataContractJsonSerializer(typeof(AuthResult));
        return (AuthResult)serializer.ReadObject(stream);
    }
}
catch (Exception e)
{
    return new AuthResult { Error = e.Message };
} 
```

没有调试器代码总是失败。附加调试器时，它很少失败。

```
System.NullReferenceException occurred
  Message=NullReferenceException
  StackTrace:
   at System.Net.Browser.ClientHttpWebRequest.InvokeGetResponseCallback(Object state)
   at System.Net.Browser.ClientHttpWebRequest.Completed(Object sender, EventArgs e)
   at MS.Internal.InternalWebRequest.OnCompleted(Object sender, EventArgs args)
   at MS.Internal.CoreInvokeHandler.InvokeEventHandler(Int32 typeIndex, Delegate handlerDelegate, Object sender, Object args)
   at MS.Internal.JoltHelper.FireEvent(IntPtr unmanagedObj, IntPtr unmanagedObjArgs, Int32 argsTypeIndex, Int32 actualArgsTypeIndex, String eventName) 
```

下一个：

```
System.Net.WebException occurred
Message=The remote server returned an error: NotFound.
StackTrace:
   at System.Net.Browser.ClientHttpWebRequest.EndGetResponse(IAsyncResult asyncResult)
   at Contest.InteropApi.SignIn(Uri uri)
   at Contest.ViewModel.LoginViewModel.<PerformSignIn>b__4()
   at System.Reactive.Linq.QueryLanguage.<>c__DisplayClass3b`1.<>c__DisplayClass3d.<ToAsync>b__3a()
   at System.Reactive.Concurrency.Scheduler.Invoke(IScheduler scheduler, Action action)
   at System.Reactive.Concurrency.DefaultScheduler.<>c__DisplayClass1`1.<Schedule>b__0(Object _)
   at System.Reactive.Concurrency.ConcurrencyAbstractionLayerImpl.<>c__DisplayClasse.<QueueUserWorkItem>b__d(Object _)
   at System.Threading.ThreadPool.WorkItem.WaitCallback_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadPool.WorkItem.doWork(Object o)
   at System.Threading.Timer.ring() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-21T22:52:22.633

Http 是异步使用的——你必须`EndGetResponse`在方法的回调（第一个参数）中调用`BeginGetResponse`。您的代码`EndGetResponse`在响应未准备好时调用。

查看本网站末尾的示例：http: [//msdn.microsoft.com/en-us/library/system.net.httpwebrequest%28v=vs.95%29.aspx](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest%28v=vs.95%29.aspx)

也许这个 http 类可以帮助您进行 http 调用：http: [//mytoolkit.codeplex.com/wikipage ?title=Http](http://mytoolkit.codeplex.com/wikipage?title=Http)

# wcf - 如何限制特定 Windows 用户组的 WCF 方法？

> ID：12044976
> 
> 赞同：1
> 
> 时间：2012-08-20T20:53:04.457
> 
> 标签：wcf

我有一个托管在 Windows 服务中的 WCF 服务，使用 https 进行安全连接。同一台机器上有两个 Windows 用户组（比如`Group A`和）。`Group B`

我需要一些可以被调用的方法`Group A`和一些被调用的方法`Group B`。

以及两者的一些方法。

我已经使用了`[PrincipalPermissionAttribute]`上述方法，但它只需要用户角色（即`Administrator`等`User`）而不是用户组。

请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:10:51.220

如果您`ClientCredentialType = "Windows"`在服务配置中使用，那么您的“角色”（在 中定义`[PrincipalPermissionAttribute]`）**是**Windows 组。

看：

**MS 模式和实践组的WCF 安全指南**- 关于 [如何限制特定 Windows 用户访问 WCF 操作的主题？](http://wcfsecurity.codeplex.com/wikipage?title=How%20do%20I%20restrict%20access%20to%20WCF%20operations%20to%20specific%20Windows%20users?)

# html - How does exactlly line-height work in this case

> ID：12044983
> 
> 赞同：0
> 
> 时间：2012-08-20T20:53:30.830
> 
> 标签：html, css, text-indent

In this question [positioning text of anchor within a div](https://stackoverflow.com/questions/11997161/positioning-text-of-anchor-within-a-div/11997261#11997261) and given the same code which I repeat here:

**HTML Markup**

```
<div id="header"> 
    <a href="cattle.html" class="current">Cattle Farms</a> 
</div> 
```

**CSS Style**

```
#header a { 
    width: 100%; 
    height: 100%; 
    display: block; 
    font-size: 25px; 
} 
```

**Answer**

```
div#header a { 
    width: 100%; 
    height: 100%; 
    display: block; 
    text-indent: 20px; 
    line-height: 350px; 
} 
```

[Fiddle](http://jsfiddle.net/fnX9n/1/)

My question is why does not the line-height make the a break out of the div

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:21:50.730

It does break out of the div. If you put a `span` inside the `a` tag and give it a display of inline-block (and a background-color so you can see it) you'll realize it does. Remember the span inherits the line-height. Take a look:

[http://jsfiddle.net/fnX9n/6/](http://jsfiddle.net/fnX9n/6/)

Give the `a` a bigger line-height and without anything else you'll also be able to realize it is breaking out of the div: [http://jsfiddle.net/fnX9n/7/](http://jsfiddle.net/fnX9n/7/)

# html - Youtube 嵌入不会在 IE 中显示

> ID：12044988
> 
> 赞同：1
> 
> 时间：2012-08-20T20:53:50.740
> 
> 标签：html, object, internet-explorer-8, youtube, embed

它不会出现在 IE8 中。我不确定出了什么问题。

```
<object type="application/x-shockwave-flash" style="width:360px; height:295px;" data="http://www.youtube.com/v/nwzbAnyThGU?rel=0&amp;loop=1&amp;showsearch=0">
<param name="movie" value="http://www.youtube.com/v/nwzbAnyThGU?rel=0&amp;loop=1&amp;showsearch=0" />
<param name="allowFullScreen" value="true" />
<param name="allowscriptaccess" value="always" />
</object> 
```

我很感激你们能给我的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:20:35.737

如果您不打算使用使用 iframe 的新嵌入代码，请尝试以下代码：

```
<object width="360" height="295">
   <param name="movie" value="http://www.youtube.com/v/nwzbAnyThGU&rel=0&hl=en_US&feature=player_embedded&version=3"></param>
   <param name="allowFullScreen" value="true"></param>
   <param name="allowScriptAccess" value="always"></param>
   <embed src="http://www.youtube.com/v/nwzbAnyThGU&rel=0&hl=en_US&feature=player_embedded&version=3" type="application/x-shockwave-flash" allowfullscreen="true" allowScriptAccess="always" width="360" height="295">
   </embed>
</object> 
```

新的嵌入代码本身就是这样的：

```
<iframe width="360" height="295" src="http://www.youtube.com/embed/nwzbAnyThGU?rel=0" frameborder="0" allowfullscreen></iframe> 
```

# apache-camel - Apache Camel - 监听路由事件，如路由完成

> ID：12044989
> 
> 赞同：1
> 
> 时间：2012-08-20T20:53:54.497
> 
> 标签：apache-camel

我在骆驼中遇到了一个特定要求，我正在处理一组文件，当发生任何异常时，我向异常队列发送一条消息，并从异常队列中发送一封关于失败的电子邮件，该功能正在运行很好，但我最终发送了很多邮件，比如如果 10 个文件失败我发送 10 封电子邮件，有没有办法只发送一封邮件，就像我想等待整个路线完成，然后去查看异常队列并发送一封说明失败的邮件（通过处理异常队列）

我愿意接受建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-08-20T22:52:26.860

我不得不做一次这个场景（虽然相反 - 成功发送邮件）。我已经配置并准备好了一个方便的 MySQL 数据库，所以我只是将队列中的每个事件添加到数据库中。然后不时地提取所有信息（并将其删除） - 只需`select * from events; delete from events;`从数据库中提取并创建邮件。

您可以使用聚合器模式处理错误队列，这对这些任务非常有用。[http://camel.apache.org/aggregate-example.html](http://camel.apache.org/aggregate-example.html)。您仍然需要知道聚合器何时应该触发消息。如果可以，请触发“完成，发送邮件”事件，例如上面链接中的示例。

最简单的方法是安排这些邮件通知的时间。看看：[http](http://camel.apache.org/simplescheduledroutepolicy.html) ://camel.apache.org/simplescheduledroutepolicy.html 。您可以将其设置为运行您的路线选择一些好的时间，然后当它启动时，您将聚合器设置为在超时时完成，并使超时足够好以清空任何合理的错误队列大小，但不要太大。

至少这是我对你的问题的建议

# javascript - 使用后退按钮时，delegateEvents 无法按预期工作

> ID：12044992
> 
> 赞同：1
> 
> 时间：2012-08-20T20:53:55.003
> 
> 标签：javascript, jquery, backbone.js

下面是我的主干视图。

```
define([
    'app',
    'backbone',
    'twig',
    'templates/report',
    'data/reportViewCollection',
    'data/reportViewModel'
], function (app, Backbone, Twig, template, Collection, Model) {

    var collection = new Collection();
    var fetching;

    return Backbone.View.extend({
        setParams: function (rlId, viewId, categoryId, depth) {
            // reset any possible pending previous repests.
            fetching = false;

            var model = collection.getModel(rlId, viewId, categoryId, depth);
            if (!model) {
                model = new Model({
                    rlId: rlId,
                    viewId: viewId,
                    categoryId: categoryId,
                    depth: depth
                });
                fetching = model.fetch({
                    success: function (model) {
                        collection.add(model);
                    },
                    error: function (model) {
                        alert('error getting report view');
                    }
                });
            }
            this.model = model;
        },
        render: function () {
            var that = this;
            var done = function() {
                app.vent.trigger('domchange:title', that.model.get('title'));
                that.$el.html(Twig.render(template, that.model.toJSON()));

                that.delegateEvents(that.events);
                fetching = false;
            };
            if (fetching) {
                app.loading(this);
                fetching.done(done);
            } else {
                done();
            }
            return this;
        },
        events: {
            'change select.view-select': 'viewSelect',
            'click #dothing': function (e) {e.preventDefault(); alert('hi');}
        },
        viewSelect: function(e) {
            var selectedView = $(e.target).val();
            var rlId = this.model.get('rlId');
            if (!rlId) rlId = 0;
            var url = 'report/' + rlId + '/' + selectedView;
            console.log(this, e, url);
            Backbone.history.navigate(url, {trigger: true});
        }
    });
}); 
```

**功能说明：**

当导航到特定的 url 时会发生什么，该`setParams()`函数被调用以从服务器获取模型。当调用 render 方法时，它会检查我们当前是否正在获取模型，如果是，则使用设置延迟回调来在完成获取时渲染模板。当模型被获取并且我们准备好渲染时，渲染模板并填充视图`that.$el.html()`。

**问题：**

发生的情况是，当我第一次导航到一个 url 时，我的事件可以完美运行，但是当我点击后退按钮时，我的事件不会被附加。

我已经浏览了代码，看不到任何差异。唯一真正的区别是我`collection`立即从缓存中加载模型，而不是执行 ajax 请求来获取它。

任何线索是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-08-20T21:27:37.877

尝试改变：

```
that.$el.html(Twig.render(template, that.model.toJSON())); 
```

到

```
that.$el.html("");
that.$el.append(Twig.render(template, that.model.toJSON())); 
```

有同样的问题，这解决了它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-21T12:31:14.017

我解决了我的问题。@mu 的评论让我朝着正确的方向前进。

我正在使用[Marionette](https://github.com/derickbailey/backbone.marionette)，我的视图包含在一个区域中。在 Region 的开放功能中，它正在执行`this.$el.html(view.el);`在某些情况下清除事件的操作。我仍然不确定为什么它在某些情况下会发生，但在其他情况下会发生。

解决方案被证明是在`onShow`我的视图中添加一个调用的函数`this.delegateEvents()`。现在一切都很顺利！

我最终通过单步执行代码并观察在视图的 div 上注册的事件找到了答案。

# sql - 将新数据导入 table1 时触发将 table1 中的几列自动复制到 table2

> ID：12044996
> 
> 赞同：1
> 
> 时间：2012-08-20T20:54:05.807
> 
> 标签：sql, sql-server-2008, triggers

我有一个`table1`带列 ( `date, field1, field2, field3, field4, field5, field6, field7, field8`)

我有另一个`table2`列 ( `date, field1,someothercolumns, field3, field5, field7, unrelatedcolumns1, someothercolumns2`)

现在每次将新数据导入 时`table2`，我还希望将列 ( `date, field1, field3, field5, field7`)中的数据`table2`自动复制到`table1`( `date, field1, field3, field5, field7`) 中。

中的缺失列`table1`可以有空值

是否可以使用触发器或任何存储过程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T20:57:59.447

尝试这样的事情：

```
CREATE TRIGGER YourTriggerName
ON dbo.Table2
AFTER INSERT 
AS BEGIN

   INSERT INTO dbo.Table1(date, field1, field3, field5, field7)
     SELECT
         date, field1, field3, field5, field7
     FROM
         Inserted
END 
```

在触发器中，您可以访问“伪”表`Inserted`（以及`Deleted`for`UPDATE`和`DELETE`触发器），其中包含受导致触发器触发的语句影响的所有行。

这很重要：如果您有一个`INSERT`插入 10 行的语句，您的触发器将触发**一次**，并且伪表`Inserted`中将有 10 行。永远不要假设您的触发器每插入一行就会触发一次 - 事实并非如此。

因此，在此触发器中，每当`INSERT`发生in 时，就会`table2`从伪表中提取相关列`Inserted`并插入到`table1`.

这能解决你的问题吗？

# php - 调整哪个文件以允许显示 .php 文件（不下载）

> ID：12044998
> 
> 赞同：0
> 
> 时间：2012-08-20T20:54:28.317
> 
> 标签：php, .htaccess

我在浏览器中打开 .php 文件时遇到了一些问题，这些文件似乎在下载。

我搜索了一下，发现这是因为服务器不知道如何解析文件，我需要添加一些东西才能使它工作。

我已经阅读过，似乎我需要在 .htcaccess 文件中添加一些内容，但我不确定它在哪里或应该在哪里创建它。

如果有人可以帮助我，下面是我服务器上目录的屏幕截图。

![在此处输入图像描述](../Images/c78eefe2cbedc7ec2bc703e6fc8851de.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-08-20T21:39:30.390

你的意思是

```
AddHandler x-httpd-php5 .php 
```

...如果正确安装了 PHP，这应该已经在主 Apache 文件中（或适当的 .conf 包含 - 在某些发行版中，配置指令可能在几个配置文件之间打包）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-08-20T21:36:15.160

如果您安装了 Web 服务器和 php 并正确配置它们，则不需要为此问题生成 htaccess 文件。

# java - android如何提醒数组值

> ID：12044999
> 
> 赞同：1
> 
> 时间：2012-08-20T20:54:32.980
> 
> 标签：java, android, arrays, alert

我有以下代码

```
StarIOPort port = null;
port = StarIOPort.getPort("BT:", "mini", 10000, ctx); 
```

如何提醒端口值？

我不知道端口是数组还是其他东西。