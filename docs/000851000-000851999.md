# StackOverflow 问答 000851000-000851999

# c# - 从 SWF 中提取文本

> ID：851001
> 
> 赞同：0
> 
> 时间：2009-05-12T03:15:04.470
> 
> 标签：c#, flash, extract

我们目前使用 print2flash ( [http://print2flash.com](http://print2flash.com) ) 将用户提交的文档（Word 文档、RTF、PowerPoint 等）转换为可以在线查看的基于 Flash 的文档（a la docstoc 和 scribd）。

我们希望对这些文件中的文本进行索引以进行全文索引。我们可以使用任何工具或库来完成此任务吗？

我们正在使用 ASP.NET / C# 进行开发，并尝试使用 SWFTools ( [http://www.swftools.org](http://www.swftools.org) ) 等 3rd 方工具，但结果不一致且低于标准。

PS：我们希望在将原始文档转换为 Flash 之后进行索引，因为这样可以减少我们需要处理的文件格式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-08-24T23:44:59.207

您最好的选择是第三方 Flash 解析库。Flash 的格式非常密集，解析起来很痛苦。话虽如此，格式很好理解。您可以在此处找到官方规范：http: [//www.adobe.com/devnet/swf/](http://www.adobe.com/devnet/swf/)

# python - 如何使用 python 检查磁盘是否在驱动器中？

> ID：851010
> 
> 赞同：4
> 
> 时间：2009-05-12T03:20:00.953
> 
> 标签：python, windows

假设我想操作软盘驱动器或 USB 读卡器上的一些文件。如何检查相关驱动器是否准备就绪？（也就是说，有一个物理插入的磁盘。）

驱动器号*存在*，因此 os.exists() 在这种情况下将始终返回 True。此外，在此过程中，我还不知道任何文件名，因此检查给定文件是否存在也不起作用。

一些澄清：这里的问题是异常处理。当您尝试访问未准备好的驱动器时，大多数有问题的 win32 API 调用都会引发异常。通常，这可以正常工作 - 寻找可用空间之类的东西，然后捕获引发的异常并假设这意味着不存在磁盘。然而，即使我捕捉到任何和所有异常，我仍然会从 Windows 收到一个愤怒的异常对话框，告诉我软盘/读卡器尚未准备好。所以，我想真正的问题是 - 我如何抑制 Windows 错误框？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-06-19T22:47:36.227

和很多事情一样，答案竟然在[十年前的一篇关于 C++/Win32 编程的文章](http://bcbjournal.org/articles/vol2/9806/Detecting_disk_errors.htm)中。

简而言之，问题在于 Windows 处理软盘错误的方式与其他类型的驱动器错误略有不同。默认情况下，无论您的程序做什么或**认为**它在做什么，Windows 都会拦截设备抛出的任何错误并向用户显示一个对话框，而不是让程序处理它——这正是我遇到的问题。

但是，事实证明，有一个 Win32 API 调用来解决这个问题，主要是`SetErrorMode()`

简而言之（我在这里介绍了很多细节），我们可以`SetErrorMode()`用来让 Windows 停止如此偏执，做我们的事情并让程序处理这种情况，然后重置 Windows 错误模式回到以前的样子，就好像我们从未去过那里一样。（这里可能有一个 Keyser Soze 的玩笑，但我今天喝了错误的咖啡因，无法找到它。）

改编链接文章中的 C++ 示例代码，看起来像这样：

```
int OldMode; //a place to store the old error mode
//save the old error mode and set the new mode to let us do the work:
OldMode = SetErrorMode(SEM_FAILCRITICALERRORS); 
// Do whatever we need to do that might cause an error
SetErrorMode(OldMode); //put things back the way they were 
```

在 C++ 中，以正确的方式检测错误需要 `GetLastError()' 函数，幸运的是我们在这里不必担心，因为这是一个 Python 问题。在我们的例子中，Python 的异常处理工作正常。那么，这就是我拼凑起来检查驱动器号是否“准备就绪”的功能，如果其他人需要它，所有这些都可以复制粘贴：

```
import win32api
def testDrive( currentLetter ):
    """
    Tests a given drive letter to see if the drive is question is ready for 
    access. This is to handle things like floppy drives and USB card readers
    which have to have physical media inserted in order to be accessed.
    Returns true if the drive is ready, false if not.
    """
    returnValue = False
    #This prevents Windows from showing an error to the user, and allows python 
    #to handle the exception on its own.
    oldError = win32api.SetErrorMode( 1 ) #note that SEM_FAILCRITICALERRORS = 1
    try:
        freeSpace = win32file.GetDiskFreeSpaceEx( letter )
    except:
        returnValue = False
    else:
        returnValue = True
    #restore the Windows error handling state to whatever it was before we
    #started messing with it:
    win32api.SetErrorMode( oldError )
    return returnValue 
```

过去几天我一直在使用它，它在软盘和 USB 读卡器上运行良好。

一些注意事项：几乎所有需要磁盘访问的函数都可以在 try 块中工作——我们在异常中寻找的所有内容都是由于媒体不存在而导致的。

此外，虽然 python`win32api`包公开了我们需要的所有功能，但它似乎没有任何标志常量。在访问了 MSDN 的古老肠道后，发现 SEM_FAILCRITICALERRORS 等于 1，这让我们的生活变得非常轻松。

我希望这可以帮助其他有类似问题的人！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T03:37:44.247

您可以与`len(os.listdir("path"))`零进行比较以查看目录中是否有任何文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T03:40:20.747

如果你有 pythonwin，[这个](http://www.microsoft.com/technet/scriptcenter/scripts/python/storage/disks/drives/stdvpy05.mspx?mfr=true)秘籍中的任何信息有帮助吗？

猜测一下，“可用性”和“状态”可能值得一看。或者您可以测试卷名，如果驱动器中没有任何内容，我猜它会是“X：”或“”。或者，哎呀，寻找可用空间或块总数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T11:51:42.657

为此，您可以通过出色的 pywin32 ( [http://sourceforge.net/projects/pywin32/ ) 使用 win32 函数。](http://sourceforge.net/projects/pywin32/)

我建议看一下`GetDiskFreeSpace`功能。您可以检查目标驱动器上的可用空间并根据该信息继续。

作为替代方案，您可以使用该`ReadDirectoryChangesW`功能查看目录或文件的更改。您会收到有关文件更改等的通知。但是您必须检查这是否适合您。你可以自己看看这个例子：http: [//timgolden.me.uk/python/downloads/watch_directory.py](http://timgolden.me.uk/python/downloads/watch_directory.py)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T03:36:26.417

不确定您的平台，但[SNMP](http://pysnmp.sourceforge.net/)可能是您的答案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-29T16:52:54.563

我希望这能解决你的问题。

```
import os

cmd = 'Powershell "Get-PhysicalDisk"'

drive_details = []
for each_line in os.popen(cmd).readlines():
    try:
        disk_info = str(each_line)

        if int(disk_info[0]) >= 0:
            each_line = each_line.split()

            drive_details.append({
                'sequence':each_line[0],
                'disk_type':str(each_line[-7]),
                'health_status':str(each_line[-4]),
                'disk_size':str(each_line[-2]) + str(each_line[-1])

            })
    except:
        pass

print(drive_details) 
```

# javascript - 用于 jquery 和点击事件的 DataTables 插件

> ID：851011
> 
> 赞同：6
> 
> 时间：2009-05-12T03:20:04.820
> 
> 标签：javascript, jquery, datatable

我试图成功地让这个 jquery 插件正常工作。我需要的是一个单击事件，它允许我单击一行并有一个 js 窗口，该窗口将使用作为数据库中的主键的 row_id 加载另一个页面。我真的迷失了 javascript，但我喜欢这个插件，如果可能的话，我真的很想拥有这项工作。我已经在这里待了几天了。我知道我已经接近了，但还没有达到目标。如果有人可以帮助我，我将不胜感激。我正在使用 json 导入数据。

* * *

这是我当前的代码。它现在可以编译，但不会触发 .click 事件。：/

```
$(document).ready(function() {
  oTable = $('#search').dataTable(
  {
    "sPaginationType": "full_numbers",
    "bProcessing": true,
    "iDisplayLength": 15,
    "sAjaxSource": 'json.php',
    "fnInitCallback": function ()
    {
      $(oTable.fnGetNodes() ).click(function ()
      {
        //alert();
      });
    }
  });
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T05:59:09.710

您需要将**fnInitCallBack**替换为**fnInitComplete**并且它会起作用。

```
oTable = $('#search').dataTable({
    "sPaginationType": "full_numbers",
    "bProcessing": true,
    "iDisplayLength": 15,
    "sAjaxSource": 'json.php',
    "fnInitComplete": function (){
        $(oTable.fnGetNodes()).click(function (){
          // my js window....
        });
    }
}); 
```

# python - 如何在 except 子句中比较异常

> ID：851012
> 
> 赞同：-2
> 
> 时间：2009-05-12T03:20:08.237
> 
> 标签：python, exception

在以下代码段中：

```
try:
    raise Bob()
except Fred:
    print "blah" 
```

Bob 和 Fred 的比较是如何实现的？

从玩弄它似乎在下面调用isinstance，这是正确的吗？

我之所以这样问是因为我试图颠覆这个过程，特别是我希望能够构建一个 Bob 以便它被 execpt Fred 捕获，即使它实际上不是 Fred 或其任何子类的实例。

有几个人问我为什么要这样做...

我们有一个 RMI 系统，它是围绕使其尽可能无缝的理念构建的，这里有一个使用中的快速示例，注意 RMI 系统中没有特定于套接字的代码，套接字只是提供了一个方便的示例。

```
import remobj
socket = remobj.RemObj("remote_server_name").getImport("socket")
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
s.bind(("", 0))
print "listening on port:", s.getsockname()[1]
s.settimeout(10)
try:
    print "received:", s.recv(2048)
except socket.timeout:
    print "timeout" 
```

现在在这个特定的示例中，except 没有按预期工作，因为引发的对象不是 socket.timeout 的实例，它是我们的代理助手类之一的实例。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T03:35:50.380

我相信您的猜测在比较的工作方式上是正确的，唯一的拦截方法是将 Fred 作为基类添加到 Bob。例如：

```
# Assume both Bob and Fred are derived from Exception
>>> class Bob(Bob, Fred):
...     pass
... 
>>> try:
...     raise Bob()
... except Fred:
...     print 'blah'
blah 
```

据我所知，这是使它在您编写时工作的唯一方法。但是，如果您只是将 except: 行重写为

```
... except (Bob, Fred): 
```

它将捕获 Bob 和 Fred，而无需修改 Bob 的定义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T03:28:51.140

> 我希望能够构建一个 Bob 以便它被 execpt Fred 捕获，即使它实际上不是 Fred 或其任何子类的实例。

好吧，你可以捕捉到“异常”——但这不是很pythonic。您应该尝试捕获正确的异常，然后作为最后的手段使用一般异常（所有异常都是从其子类化）。如果这对您不起作用，那么您的设计阶段出现了严重错误。

[请参阅 Code Like A Pythonista 中的此注释](http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html#eafp-try-except-example)

> 注意：始终指定要捕获的异常。切勿使用裸 except 子句。裸的 except 子句将捕获意外的异常，使您的代码极难调试。

然而，Python 之禅中的成语之一是

> 特殊情况不足以打破规则。虽然实用胜过纯洁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T06:53:52.133

```
>>> class Fred(Exception):
    pass
>>> class Bob(Fred):
    pass
>>> issubclass(Bob, Fred)
True
>>> issubclass(Fred, Bob)
False
>>> try:
    raise Bob()
except Fred:
    print("blah")

blah 
```

所以基本上捕获了异常，因为 Bob 是 Fred 的子类，我假设，要么他们必须实现类似于`issubclass(Bob, Fred)`

看，这就是你想要的实现方式，随你所愿。当然不是**init**，而是其他一些方法。

```
>>> class Bob(Exception):
    def __init__(self):
        raise Fred

>>> try:
    b = Bob()
except Fred:
    print('blah')

blah 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T06:37:42.883

我不清楚如何将您的异常隐藏在 socket.timeout 中符合“无缝”理念？捕获定义的预期异常有什么问题？

```
try:
    print "received:", s.recv(2048)
except socket.timeout:
    print "timeout"
except our_proxy_helper_class:
    print 'crap!' 
```

或者，如果你真的想把它当作 socket.timeout，为什么不在 our_proxy_helper_class 中提高 socket.timeout 呢？

```
raise socket.timeout('Method x timeout') 
```

因此，当您在 our_proxy_helper_class 中提出 socket.timeout 时，它应该被 'except socket.timeout' 捕获。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T21:50:50.687

至少在 CPython 中，看起来有一个类型为 10 的 COMPARE_OP 操作（异常匹配）。你不可能做任何事情来破解这个计算。

```
>>> 导入磁盘
>>> def foo():
... 尝试：
... 引发 OSError()
...除了例外，e：
... 经过
...
>>> dis.dis(foo)
  2 0 SETUP_EXCEPT 13（至 16）

  3 3 LOAD_GLOBAL 0（操作系统错误）
              6 CALL_FUNCTION 0
              9 RAISE_VARARGS 1
             12 POP_BLOCK           
             13 JUMP_FORWARD 21（至 37）

  4 >> 16 DUP_TOP             
             17 LOAD_GLOBAL 1（例外）
             20 COMPARE_OP 10（异常匹配）
             23 JUMP_IF_FALSE 9（至 35）
             26 POP_TOP             
             27 POP_TOP             
             28 STORE_FAST 0 (e)
             31 POP_TOP             

  5 32 JUMP_FORWARD 2（至 37）
        >> 35 POP_TOP             
             36 结束_最终         
        >> 37 LOAD_CONST 0（无）
             40 返回值        
```

# mysql - 网站评论系统的数据库结构

> ID：851021
> 
> 赞同：6
> 
> 时间：2009-05-12T03:24:06.967
> 
> 标签：mysql, database-design, comments

我目前正在开发一个需要评论系统的网站。由于这个网站是全新的，并且数据库结构尚未确定，我想就如何最好地处理这样的评论系统提出一些建议：

*   评论必须能够放在任何东西上。包括未来表格中的项目。
*   评论必须是快速（并且容易？）可查询的。

我知道仅此一点并没有什么可做的，所以这里的想法是：每所大学都有学院，每所学院都有大楼，每栋大楼都有房间。每个用户都应该能够评论这四个项目中的任何一个（以及我们以后可能添加的未来项目），但我想避免为每个项目创建一个评论表。

到目前为止，我提出的解决方案似乎有效，但我也对其他想法持开放态度。我的解决方案是使用 UUID 作为每个项目（大学、学院、建筑物、房间）表的主键，然后将评论表中的参考 ID 设为该 UUID。虽然我不认为我可以建立一个外键系统来链接所有内容，但我相信没有什么会破坏，因为只有可用的项目可能有评论，因此一个项目可以没有评论，或者如果它被删除，那么评论将永远不会被返回。

```
University:
    UniversityID - CHAR(36)  //UUID()       & primary key
    ...

Comments:
    CommentID - CHAR(36)     //UUID()       & primary key
    CommentItemID - CHAR(36) //UUID of item & indexed
    CommentUserID - INTEGER
    CommentBody - TEXT 
```

然后查询将如下所示：

```
SELECT * FROM University, Comments WHERE UniversityID = CommentItemID; 
```

那么大家怎么看呢？这个系统会随着大量数据扩展，还是有更好的（可能是最佳实践或模式）方式？

我提前谢谢你。

**编辑 1：** 我已更改 Comment 定义以包含主键和索引列，以解决迄今为止提出的问题。这样系统也可以有注释的注释（不确定这在实际代码中会有多混乱，但我喜欢它具有一定的数学完整性）。在我接受答案之前，我想让系统尽可能地相似。

到目前为止，Sebastian Good 和 Bryan M. 的两个答案都建议使用两个整数的双主键，例如 ItemID 和 TableID。我对这种方法的唯一犹豫是我要么必须有一个新表列出 TableID 及其对应的字符串表名称，要么将全局变量引入引用它们的代码中。除非我缺少另一种方法，否则这对我来说似乎是可以避免的额外代码。

大家怎么看？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T01:36:39.680

我只会采用更传统的方法来处理评论与其绑定的任何内容之间的外键关系。

```
UNIVERSITY
  UniversityID // assuming primary key

COMMENTS
  CommentID // assuming primary key
  TypeID  // Foreign Key
  Type    // Name of the table where the foreign key is found (ie, University) 
```

这对我来说感觉有点干净。有些关于使用另一个表的外键作为您的评论的主键感觉不对。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-13T01:58:38.797

如果您使用 UUID，则很难知道它来自哪个表。如果您只想从实体向下查看评论，就像在您的查询中一样，它会正常工作。如果您想查看评论并找出它的内容，您必须查看所有可能的表格（大学、建筑物等）才能找到答案。

使您能够对基本实体的键使用简单的连续整数的一种可能性（这通常是为了可读性、索引碎片等而需要的）是使您的注释表的键包含两列。一个是注释适用的表的名称。第二个是该表的键。这类似于 Bryan M. 建议的方法，但请注意，您将无法实际从评论表中定义外键到所有可能的父级。如有必要，您的查询将双向工作，您无需担心 UUID，因为表名 + ID 的组合在整个数据库中是唯一的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T01:16:57.067

好吧，既然似乎没有人想回答，我想我会坚持我的方法。但是，我仍然愿意接受其他建议。

# c - C 指针算术片段

> ID：851023
> 
> 赞同：4
> 
> 时间：2009-05-12T03:24:48.760
> 
> 标签：c, pointers, while-loop, nested-loops

我有一个正在尝试解码的程序。它是从另一种语言（[这里没有说出它的名字](http://en.wikipedia.org/wiki/Brainfuck)）翻译成 C 语言的，因为我想了解它是如何工作的，所以我正在慢慢地重写代码并简化它以使用 C 必须提供的所有良好的逻辑结构。

以下一点点在我的代码中不断弹出，具有不同的值`X`和`Y`：

```
ptr[X]--;
while(ptr[X])
  {
    ptr[X]--;
    ptr += Y;
  } 
```

`ptr`是 type `char *`，我不能在任何时候对数组的状态做出假设，因为它非常深入地嵌入在循环中并且依赖于输入和输出。我可以成功地将其“简化”为：

```
for(ptr[X]--; ptr[X]; ptr[X]--, ptr += Y); 
```

但这太可怕了。稍微好一点的是：

```
for(ptr[X]--; ptr[X]; ptr += Y) ptr[X]--; 
```

我想知道是否有人可以更好地简化上述代码，我将不胜感激。这发生在不少于五个地方，并且削弱了我简化和理解流控制的能力，所以如果有人能提供更简洁/可读的版本，那就太棒了。如果任何人都可以提供对该代码的任何花哨的洞察力，那也太棒了，尽管我基本上了解它的作用。

深入了解特定代码`X`和/或`Y`也可以提供帮助。`Y`往往介于 -2 和 2 之间，并且`X`通常为 1，因为它的价值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T03:56:59.410

`ptr[X]`等价于`*(ptr + X)`，所以我们可以改写如下：

```
for((*(ptr + X))--; *(ptr + X); (*(ptr + X))--, ptr += Y); 
```

现在这里有很多冗余，所以我们可以将其简化为：

```
char *ptr_plus_x = ptr + X;
for((*ptr_plus_x)--; *ptr_plus_x; (*ptr_plus_x)--, ptr_plus_x += Y); 
```

然后我们可以完全摆脱`ptr_plus_x`：

```
ptr += X;
for((*ptr)--; *ptr; (*ptr)--, ptr += Y); 
```

在英语中，我们访问偏移量 X、X+Y、X+2Y、X+3Y、... 处的内存位置，递减每个内存位置，直到找到一个为 0 的内存位置。但是，总是测试 0发生在递减之后，因此我们实际上是在寻找该序列中值为 1 的第一个内存位置。一旦找到，我们将其递减为 0 并退出。

如果 Y 为 1，那么我们将向前递减一串连续的内存位置，直到并包括第一个 1。如果 Y 为 -1，同样的事情会发生，但从偏移量 X 向后搜索。如果 Y 为 0，则无限循环发生。如果 Y 是任何其他值，则搜索模式会跳过各种条目。

这不是一个非常直观的功能，所以我明白你为什么感到困惑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T03:31:06.597

我会投入：

```
ptr[X]--
while (ptr[X]--) ptr+=Y; 
```

先求值，再递减（即对于 while 条件）

编辑：好吧，我早上会恨自己。Goto 在这个级别上还可以，对吧？

```
dec:  ptr[x]--
      while (ptr[X]){
           ptr+=Y;
           goto dec;
      } 
```

（老实说，我不知道是否要离开这个。）

EDIT2：那么，这个怎么样？（tcc没有抱怨）

```
 while (ptr[X]--?ptr[X]--,ptr+=Y:0){} 
```

编辑 2 1/2；

```
 //longshot
  while (ptr[X]--?ptr[X]--,ptr+=Y, ptr[X]:0){} 
```

如果一切都失败了..

EDIT3：今晚的最后一个。

```
while (ptr[X]--?ptr[X]--,ptr+=Y:0){
      if (!ptr[X]) break;
 }//good luck with this, it has been very amusing. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T04:32:40.397

it-which-shall-not-be-named 的网站指出：

```
The semantics of the it-which-shall-not-be-named states commands can also
be succinctly expressed in terms of C, as follows (assuming that p has 
been previously defined as a char*):

>   becomes     ++p;
<   becomes     --p;
+   becomes     ++*p;
-   becomes     --*p;
.   becomes     putchar(*p);
,   becomes     *p = getchar();
[   becomes     while (*p) {
]   becomes     } 
```

因此，将其转换为 C 似乎应该相当容易。

**编辑：** [这是转换为 C++ 的 Hello World BF。](http://pastebin.com/f7a469805 "这是转换为 C++ 的 Hello World BF。")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T04:24:03.593

这已经很简单了。与其试图写更少的陈述，我更愿意尝试抓住意图并添加一些评论。

片段的“a”含义示例：减少 Y 列矩阵的列 (X) 的所有元素。例如，在没有直接赋值的语言中，您将需要它来绘制一条垂直线 +'ses。

您可以通过直接显示索引来阐明此含义：

```
// set elements of column to cGoal
for( int decrementsToGoal = cGoal; decrementsToGoal != 0; --decrementsToGoal ) {
    // decrease all elements of column X
    for( int row = cMaxRows; M[ row*matrixsizeY + columnX ]; --row ) {
        --M[ row*matrixsizeY + columnX ];
    }
} 
```

祝你好运 ：）

# c++ - 在 Qt 中，如何正确实现委托？

> ID：851031
> 
> 赞同：3
> 
> 时间：2009-05-12T03:33:30.807
> 
> 标签：c++, qt, qt4

我遵循模型/视图/控制器范式。我很确定模型和视图是正确的，但我认为我的代表做错了一些事情。一切都“正常工作”，除了第一次单击控件只是“点亮控件”并且第二个与之交互。这就是代表通常的实现方式吗？我的实现需要大量的构造和破坏（由 scoped_ptr 隐藏），因此任何有关这方面的提示也很有帮助。

```
QWidget *ParmDelegate::createWidget(const QModelIndex &index) const {
    if (!index.isValid())
        return NULL;
    const Parm  *p = static_cast<const Parm*>(index.internalPointer());
    QWidget *w = p->createControl();
    w->setAutoFillBackground(true);
    w->setBackgroundRole(QPalette::Base);  // white background instead of grey
    return w;
}

QWidget*
ParmDelegate::createEditor(QWidget *parent, const QStyleOptionViewItem &option, const QModelIndex &index) const {
    QWidget *retval = createWidget(index);
    if (dynamic_cast<QComboBox*>(retval))
        connect(retval, SIGNAL(activated(int)), this, SLOT(commitAndCloseEditor()));
    else if (dynamic_cast<QSlider*>(retval))
        connect(retval, SIGNAL(sliderReleased()), this, SLOT(commitAndCloseEditor()));
    else if (dynamic_cast<QAbstractButton*>(retval))
        connect(retval, SIGNAL(clicked()), this, SLOT(commitAndCloseEditor()));
    else
        connect(retval, SIGNAL(editingFinished()), this, SLOT(commitAndCloseEditor()));
    retval->setFocusPolicy(Qt::StrongFocus);
    retval->setParent(parent);
    return retval;
}

void
ParmDelegate::setEditorData(QWidget *editor, const QModelIndex &index) const {
    const Parm  *p = static_cast<const Parm*>(index.internalPointer());
    p->setEditorData(editor);
}

void
ParmDelegate::setModelData(QWidget *editor, QAbstractItemModel *model, const QModelIndex &index) const {
    ParmControl::Base*  base = dynamic_cast<ParmControl::Base*>(editor);
    model->setData(index, base->toQVariant());
}

void
ParmDelegate::updateEditorGeometry(QWidget *editor, const QStyleOptionViewItem &option, const QModelIndex &index) const {
    editor->setGeometry(option.rect);
}

void
ParmDelegate::paint(QPainter *painter, const QStyleOptionViewItem &option, const QModelIndex &index) const {
    scoped_ptr<QWidget> w(createWidget(index));
    if (!w)
        return;
    const Parm  *p = static_cast<const Parm*>(index.internalPointer());
    setEditorData(w.get(), index);
    w->setGeometry(option.rect);
    w->render(painter, option.rect.topLeft());
}

QSize
ParmDelegate::sizeHint(const QStyleOptionViewItem &option, const QModelIndex &index) const {
    scoped_ptr<QWidget> w(createWidget(index));
    if (!w)
        return QSize(0,0);
    return w->sizeHint();
}

void
ParmDelegate::commitAndCloseEditor() {
    QWidget *editor = static_cast<QWidget *>(sender());
    ParmControl::Base* base = dynamic_cast<ParmControl::Base*>(editor);
    emit commitData(editor);
    emit closeEditor(editor, QAbstractItemDelegate::EditNextItem);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T17:17:12.350

如果您有兴趣更改自定义编辑器的显示条件，请使用`QAbstractItemView::setEditTriggers()`. 尽管您的委托负责将信息传入和传出自定义编辑器，但视图决定了编辑器的启动时间。

文档参考：[http](http://doc.qt.digia.com/4.5/qabstractitemview.html#editTriggers-prop) ://doc.qt.digia.com/4.5/qabstractitemview.html#editTriggers-prop 。

# php - 在 MySQL 服务器或 PHP 中更快地随机化许多结果

> ID：851032
> 
> 赞同：6
> 
> 时间：2009-05-12T03:34:16.390
> 
> 标签：php, mysql

在 MySQL 服务器上或在我收到 PHP 中的数据之后，随机化大量结果的排序顺序是否更快？

有没有人有任何数据可以备份任何一方，甚至是轶事经验？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T03:34:41.710

我有根据的猜测是 MySQL 胜出。它以这种方式处理数据。必须将所有数据移至 PHP 进行排序的巨大开销使其具有启动优势。

当然，您可以通过做一些基准测试自己找出答案。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T12:37:18.143

当然，你应该在`MySQL`旁边做。

但请注意，这`ORDER BY RAND()`是*非常*低效的，`MySQL`因为它需要`filesort`.

了解如何`10`通过单表扫描有效地选择随机行：

```
SELECT  *
FROM    (
        SELECT  @cnt := COUNT(*) + 1,
                @lim := 10
        FROM    t_random
        ) vars
STRAIGHT_JOIN
        (
        SELECT  r.*,
                @lim := @lim - 1
        FROM    t_random r
        WHERE   (@cnt := @cnt - 1)
                AND RAND() < @lim / @cnt
        ) i 
```

有关性能详细信息，请参阅我的博客中的这篇文章：

*   [**选择随机行**](http://explainextended.com/2009/03/01/selecting-random-rows/)

对于`1,000,000`记录表，它在不到一秒的时间内运行，而不是`15`使用`ORDER BY RAND()`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T04:07:51.373

在 MySQL 中使用 RAND()**肯定**会更快。

要通过 PHP 进行随机化，您必须查询数据库并将数据推送到内存中，因此您有一个额外的步骤来增加排序过程的开销。

在 MySQL 中，这种类型的查询不会像按索引值排序那样快，但仍会进行高度优化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T12:31:06.960

请注意，您使用 rand() 作为 order by 语句的对象：

```
 select * from foo_table order by rand() limit 100 
```

# sql - Sql Server 复制中使用的系统表有哪些？

> ID：851036
> 
> 赞同：3
> 
> 时间：2009-05-12T03:35:42.847
> 
> 标签：sql, sql-server

Sql Server 复制中使用的系统表有哪些？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T04:00:13.290

从[网上书](http://msdn.microsoft.com/en-us/library/ms179855%28SQL.90%29.aspx)...

**主**数据库中的复制表...

*   MSreplication_options

**msdb**数据库中的复制表...

*   MSagent参数列表
*   数据库管理系统
*   MSdbms_map
*   MSdbms_datatype
*   `MSdbms_datatype_mapping`
*   MSreplmonthresholdmetrics
*   系统复制警报

**分发**数据库中的复制表...

*   MSagent_parameters
*   MSagent_profiles
*   文章
*   MScached_peer_lsns
*   MSdist 出版商
*   MSdistribution_agents
*   MSdistribution_history
*   MSdistributiondbs
*   分销商
*   MSlogreader_agents
*   MSlogreader_history
*   MSmerge_agents
*   MSmerge_history
*   MSmerge_sessions
*   MSmerge_subscriptions
*   MSpublication_access
*   MS出版门槛
*   MS出版物
*   MSpublisher_databases
*   MSreplication_objects
*   MSreplication_subscriptions
*   MSrepl_commands
*   MSrepl_errors
*   MSrepl_originators
*   MSrepl_transactions
*   MSrepl_version
*   MSsnapshot_agents
*   MSsnapshot_history
*   MSsubscriber_info
*   MSsubscriber_schedule
*   MS订阅
*   MSsubscription_properties
*   MStracer_history
*   MStracer_tokens

**此外，分发**数据库中的这些表用于从非 SQL Server 发布者复制数据...

*   文章
*   IH 列
*   约束类型
*   索引类型
*   IH出版物
*   IHpublishercolumnconstraints
*   IH出版商栏目索引
*   IH发布者栏目
*   IH发布者约束
*   IH出版商索引
*   IH 出版商
*   IH发布者表
*   IH 订阅

**发布**数据库中的复制表...

*   MSdynamicsnapshotjobs
*   MSdynamicsnapshotviews
*   MSmerge_altsyncpartners
*   MSmerge_conflicts_info
*   MSmerge_contents
*   MSmerge_current_partition_mappings
*   MSmerge_dynamic_snapshots
*   MSmerge_errorlineage
*   MSmerge_generation_partition_mappings
*   MSmerge_genhistory
*   MSmerge_identity_range
*   MSmerge_metadataaction_request
*   MSmerge_partition_groups
*   MSmerge_past_partition_mappings
*   MSmerge_replinfo
*   MSmerge_settingshistory
*   MSmerge_tombstone
*   MSpeer_lsns
*   MSpeer_request
*   MSpeer_response
*   MSpub_identity_range
*   系统文章列
*   系统文章
*   系统文章更新
*   系统合并文章列
*   系统合并文章
*   系统合并分区信息
*   系统出版物
*   系统合并模式文章
*   系统合并模式改变
*   系统合并订阅
*   系统合并子集过滤器
*   系统刊物
*   系统架构文章
*   系统订阅
*   系统转换

**订阅**数据库中的复制表...

*   MSdynamicsnapshotjobs
*   MSdynamicsnapshotviews
*   MSmerge_altsyncpartners
*   MSmerge_conflicts_info
*   MSmerge_contents
*   MSmerge_current_partition_mappings
*   MSmerge_dynamic_snapshots
*   MSmerge_errorlineage
*   MSmerge_generation_partition_mappings
*   MSmerge_genhistory
*   MSmerge_identity_range
*   MSmerge_metadataaction_request
*   MSmerge_partition_groups
*   MSmerge_past_partition_mappings
*   MSmerge_replinfo
*   MSmerge_settingshistory
*   MSmerge_tombstone
*   MSpeer_lsns
*   MSrepl_queuedtraninfo
*   MSsnapshotdeliveryprogress
*   MSsubscription_properties
*   系统合并文章列
*   系统合并文章
*   系统合并分区信息
*   系统出版物
*   系统合并模式文章
*   系统合并模式改变
*   系统合并订阅
*   系统合并子集过滤器
*   系统转换

# c++ - 如何从另一个父类是数据类的朋友类的派生类访问数据类的私有成员变量？

> ID：851041
> 
> 赞同：2
> 
> 时间：2009-05-12T03:40:03.587
> 
> 标签：c++, friend, derived, private-members

我有三个班级：

1.  使用 Pimpl 模式的数据持有者类 CDataHolder

    ```
    类 CDataHolder
    {
    上市：
      // ...
    私人的：
    朋友类 CBase;
    结构 PImpl;
    PImpl* iPimpl；
    };

    ```

2.  一个基类CBase，需要访问CDataHolder中的iPImpl成员，所以是CDataHolder的友元类

    ```
    CBase 类：
    {
    受保护：
    CDataHolder::Pimpl* getDataHolderPimpl();
    };

    ```

3.  CBase 的派生类 CDerived，它也需要访问相同的 iPimpl 成员。这里出现问题。尽管其父类是友元类，但派生类不能使用 iPimpl 成员。像这样：

    ```
    CDrived 类：公共 CBase
    {
    上市：
    无效doSth（）{
       CDataHolder::Pimpl *pImpl = getDataHolderPimpl(); // 此行引发错误：
                                                         // "从 CDataHolder 非法访问受保护/私有成员 CDataHolder::PImpl"
    }
    };

    ```

    有很多派生类，所以每个派生类在 CDataHolder 类中放置“朋友类 CDerivedXXX”行并不是一个好方法。如何克服这个问题？有一个更好的方法吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T03:45:42.720

由于您已`struct PImpl`在 CDataHolder 类的私有部分中声明，因此只有 CDataHolder 的朋友可以访问它。你为什么不在`struct PImpl`公共部分或者在 CDataHolder 类之前更好地提出一个前向声明？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T03:52:32.803

朋友（理所当然地）非常有限，不能被继承。我不想提出这个问题，但也许 A）您需要对 PImpl 或其某些方面的公共访问，或者 B）您需要 DataHolder 类为您使用 PImpl 做一些事情。

# iphone - 如何以编程方式创建翻页效果？

> ID：851042
> 
> 赞同：2
> 
> 时间：2009-05-12T03:40:07.940
> 
> 标签：iphone, objective-c, cocoa-touch

我很确定我可以使用一系列 PNG 创建翻页效果来模拟动画，但是有没有办法以编程方式来实现呢？尝试谷歌搜索并查看 Apple 示例代码，但没有看到任何解决该特定动画的内容。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T03:49:36.957

我假设您的意思是iPhone，对吗？

来自 UIView 的[Apple API](http://developer.apple.com/iphone/library/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/occ/clm/UIView/setAnimationTransition:forView:cache:)文档：

```
+ (void)setAnimationTransition:(UIViewAnimationTransition)transition forView:(UIView *)view cache:(BOOL)cache 
```

其中`UIViewAnimationTransition`定义为：

```
typedef enum {
   UIViewAnimationTransitionNone,
   UIViewAnimationTransitionFlipFromLeft,
   UIViewAnimationTransitionFlipFromRight
   UIViewAnimationTransitionCurlUp,
   UIViewAnimationTransitionCurlDown,
} UIViewAnimationTransition; 
```

`UIViewAnimationTransitionCurlUp`就是你要找的。有关如何启动、设置和提交动画到视图的信息，请参阅这些文档。

# sql - 在 DB 中存储时间-温度数据

> ID：851046
> 
> 赞同：0
> 
> 时间：2009-05-12T03:40:55.910
> 
> 标签：sql, mysql, database, postgresql

我将时间-温度数据存储在数据库中，这实际上只是 CSV 数据。第一列是以秒为单位的时间，从零开始，以下（一个或多个）列是温度：

```
0,197.5,202.4 
1,196.0,201.5
2,194.0,206.5 
3,192.0,208.1 ....etc 
```

每个图代表大约 2000 秒。目前我在将数据存储在`output_profile longtext`字段中之前对其进行压缩。

```
CREATE TABLE `outputprofiles` (
  `id` int(11) NOT NULL auto_increment,
  `output_profile` longtext NOT NULL,
PRIMARY KEY  (`id`) 
```

这很有帮助...我可以将 10K 纯文本的绘图压缩到大约 2.5K。不需要对此数据进行搜索或索引，因为它只是在另一个表中引用。

我的问题：有没有其他方法来存储这些数据，我没有考虑哪种方法在存储空间方面更有效？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T03:44:22.053

是否有任何理由认为存储空间将成为您应用程序的限制因素？与访问和使用的便利性相比，在将其置于更高优先级之前，我会尽量确定情况是否如此；出于这个目的，听起来你所拥有的东西是令人满意的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T04:57:20.310

我实际上不太明白您所说的“压缩情节”是什么意思。这意味着您正在压缩 2000 个测量值还是正在压缩每一行？

无论如何，空间很便宜。我会以传统方式制作，即两列，每个测量一个条目。

如果由于某种原因这不起作用，并且如果您想将 2000 个测量值保存为一条记录，那么您可以做得更好。

. 使用您的测量结果创建一个 csv 文件。. 压缩它（gzip -9 为您提供最大压缩）。将其保存为**blob**（或**longblob**，具体取决于您使用的数据库）而不是longtext

然后将其保存在数据库中。

这将为您提供最大的压缩。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T12:26:04.383

PostgreSQL 的存储空间开销很大，因为每个元组（表中行的表示）都是 28 字节，不包括数据（PostgreSQL 8.3）。整数有 2、4 和 8 字节，时间戳为 8 字节。我认为浮点数是 8 个字节。因此，在 PostgreSQL 中存储 1,000,000,000 行将需要比 MySQL 多 GiB 的存储空间（取决于您在 MySQL 中使用的存储引擎）。但与 MySQL 相比，PostgreSQL 在处理海量数据方面也很出色。尝试对一个巨大的 MySQL 表运行一些 DDL 查询，你就会明白我的意思。但是您存储的这些简单数据可能应该很容易进行大量分区，因此一个简单的 MySQL 可以很好地处理这项工作。但是，正如我常说的，如果您不确定是否需要特定的 MySQL 功能，您应该选择 PostgreSQL。

我将这篇文章仅限于 MySQL 和 PostgreSQL，因为这个问题只标记了这两个数据库。

编辑：抱歉，我没有看到您实际上将 CSV 存储在数据库中。

# c# - VSTO 使用 C# 将菜单项添加到 Excel 2003

> ID：851048
> 
> 赞同：0
> 
> 时间：2009-05-12T03:43:20.807
> 
> 标签：c#, .net, excel, vsto

我正在开发一个 Excel 2003 插件并尝试制作我自己的菜单，如下所示：

```
Application.ScreenUpdating = true;
Application.MenuBars.Add("MyMenu");
Application.MenuBars["MyMenu"].Menus.Add("MyMenuItem1", null, null); 
```

它似乎运行得很好，但我根本看不到我的菜单。

任何想法为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T03:50:43.197

您必须在自己的代码中保留对菜单项的引用。否则，一旦您的“菜单添加”方法退出，菜单项就会被销毁。

所以试试这个：

```
class MyAddin {

     private Office.CommandBarButton myMenuItem;

     private void AddMenuItem() 
     {
         Application.ScreenUpdating = true;
         Application.MenuBars.Add("MyMenu");
         myMenuItem = Application.MenuBars["MyMenu"].Menus.Add("MyMenuItem1", null, null);
     }
} 
```

有关更多详细信息，请参阅MSDN 上的[这篇文章](http://msdn.microsoft.com/en-us/library/0batekf4(VS.80).aspx)。

# vb.net - 更改高度引用类的命名空间的最佳方法是什么？

> ID：851050
> 
> 赞同：11
> 
> 时间：2009-05-12T03:44:45.530
> 
> 标签：vb.net, visual-studio-2008, namespaces

我正在尝试将高度引用的类从一个命名空间移动到另一个命名空间。只需将文件移动到具有不同根命名空间的新项目中，就会在我的解决方案中导致超过 1100 个错误。

对类的一些引用涉及完全限定的名称景观引用，而其他引用涉及命名空间的导入。

我曾尝试使用重构工具 (Refactor Pro) 重命名命名空间，希望对类的所有引用都会更改，但这导致了上述问题。

任何人都知道如何应对这一挑战，而无需手动钻取每个文件并更改完全限定的命名空间或导入新的命名空间（如果它不存在）？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T03:50:38.187

尝试使用[Resharper。](http://www.jetbrains.com/resharper/download)我过去曾使用它来重构高度引用的命名空间，无论是完全限定的还是导入的，都没有任何问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-19T17:41:11.377

这是我用来完成痛苦的命名空间重命名的[Powershell脚本。](http://www.microsoft.com/windowsserver2003/technologies/management/powershell/default.mspx)在我的情况下，大约有 5000 个 VB.Net 和 C# 源文件大量使用公共库 ( [CSLA](http://www.lhotka.net/cslanet/) )。由于不值得讨论的原因，我需要将命名空间*Csla*重命名为*CslaLegacy*. 只需最少的努力，您应该能够根据您的特定需求调整此脚本。该脚本递归地搜索源代码树以查找 .vb 和 .cs 文件。$repValues 哈希表包含需要替换的字符串。如果您的重命名包含程序集名称更改，则此脚本的变体也可用于更新项目引用。您可以添加对源代码控制工具的调用，以在修改前签出文件。我最初是为 TFS 执行此操作的，但发现执行 tf.exe 很慢。最后，在运行脚本之前简单地检查整个源代码树要快得多。我使用[PowerGUI](http://powergui.org/index.jspa)脚本编辑器来调试和运行 powershell 脚本。

```
$root = "c:/path/to/your/source"

cd $root
$files = Get-ChildItem -Path $root -Recurse -include *.cs,*.vb 

$repValues = 
@{
'using Csla;'              = 'using CslaLegacy;';
'using Csla.Validation;'   = 'using CslaLegacy.Validation;';
'using Csla.Data;'         = 'using CslaLegacy.Data;';
'Imports Csla'             = 'Imports CslaLegacy';
'Imports Csla.Validation'  = 'Imports CslaLegacy.Validation';
}

$stmtsToReplace = @()
foreach ($key in $repValues.Keys) { $stmtsToReplace += $null }
$repValues.Keys.CopyTo($stmtsToReplace, 0)

foreach ($file in $files)
{
$path = [IO.Path]::Combine($file.DirectoryName, $file.Name)

$sel = Select-String -Pattern $stmtsToReplace -Path $path -l

if ($sel -ne $null)
{
    write "Modifying file $path" 

    (Get-Content -Encoding Ascii $path) | 
    ForEach-Object {
        $containsStmt = $false
        foreach ($key in $repValues.Keys) 
        {
            if ($_.Contains($key))
            { 
                $_.Replace($key, $repValues[$key])
                $containsStmt = $true
                break
            }
        }
        if (!$containsStmt) { $_ } 
    } |
    Set-Content -Encoding Ascii $path
}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T03:49:48.393

如果它对你的情况有帮助，我不会。

1.  修改命名空间，VS IDE 会在命名空间的末尾显示一个红色的小矩形。
2.  按 Ctrl+。并选择您最喜欢的选项。

如果您使用 ReSharper 之类的工具，请单击命名空间并按 Ctrl+R。按照重命名命名空间对话框中的说明进行操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T03:53:02.850

似乎您不应该在完全限定名称上进行全局搜索和替换时遇到太多麻烦。因此，在 oldspace::myclass 上搜索所有内容并将其替换为 newspace::myclass。在文件顶部添加行也不是很困难，您可以替换

```
using oldspace; 
```

和

```
using oldspace;
using newspace; 
```

当然，这样的方法存在一些风险。很容易给自己造成微妙的问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2010-04-12T16:49:35.180

切换到升c的另一个原因。在 VS 2008 中免费重构源代码。

# iphone - 引用 AppDelegate 方法 - iphone

> ID：851054
> 
> 赞同：15
> 
> 时间：2009-05-12T03:47:04.230
> 
> 标签：iphone, xcode

我有一个 AppDelegate 有 3 个视图。我添加所有三个

```
[window addSubview:gameViewController.view];
[window addSubview:viewSettings.view];
[window addSubview:viewController.view];
[window makeKeyAndVisible]; 
```

在应用程序委托中，我有一些通过调用交换视图的方法

```
[window bringSubviewToFront:gameViewController.view]; 
```

当我在 viewController 中时，我使用

```
pinkAppDelegate *appDelegate=  (pinkAppDelegate *)[[UIApplication sharedApplication] delegate];

[appDelegate switchToSettings]; 
```

切换我的子视图...到目前为止一切顺利。

但是，当我在我的 viewSetting UIViewController 中并执行相同的 appDelegate 调用时，它会阻塞，就像它不明白如何调用 appDelegate 方法一样。

我的所有视图都挂在我的主窗口 xib 中，但不知道为什么我不能遍历主 appdelegate 中的方法

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-05-12T05:17:06.673

在 viewController 中，您正在设置一个名为 appDelegate 的局部变量，它指向您的应用委托。这就是这条线的作用：

```
pinkAppDelegate *appDelegate= (pinkAppDelegate *)[[UIApplication sharedApplication] delegate]; 
```

这个变量是 viewController 的本地变量，所以你不能在设置视图控制器中使用它。您需要在那里设置另一个变量。

或者，在整个应用程序中使用这个漂亮的#define。（您需要将其放入项目中每个文件中包含的 .h 头文件中。）

```
#define myAppDelegate (MyAppDelegate *)[[UIApplication sharedApplication] delegate] 
```

然后，您可以在任何地方执行以下操作：

```
[myAppDelegate doSomething]; 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2010-10-06T23:09:29.437

作为参考，上面仍然有一个错字，我还有另一个补充，这有助于避免每次都必须投射的警告。如果您使用：

```
#import "MyAppDelegate.h"
#define myAppDelegate (MyAppDelegate *) [[UIApplication sharedApplication] delegate] 
```

我把上面的内容放在一个constants.h中，然后可以使用

```
[myAppDelegate doSomething]; 
```

我在任何地方导入 constants.h

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-08-23T06:29:41.870

简的回答有错字。

在您在每个类中导入的头文件（例如，define.h）中使用以下行：

```
#define myAppDelegate [[UIApplication sharedApplication] delegate] 
```

您还可以在前缀头文件中使用该行 - 这是一种在任何地方都可以访问它的简单方法。

然后在任何方法中，您都可以使用以下任何方法：

```
[myAppDelegate doSomething]; 
 myAppDelegate.property=value;
 myAppDelegate.childClassOfMyAppDelegate.property=value;
[myAppDelegate.ChildOfMyAppDelegate doSomething]; 
```

# .net - 如何防止.Net中挂起（或为其设置超时）的正则表达式

> ID：851057
> 
> 赞同：2
> 
> 时间：2009-05-12T03:49:21.780
> 
> 标签：.net, regex

我正在使用正则表达式来删除 html 文件中的注释标记（模式为：“ `<!--(.|\s)*?--!?>`”）

但是有些网站没有使用标准的 html 标签，示例：

```
<script language="javascript">
    <!-- 
     js code ...
    </script> 
```

在这种情况下，我的正则表达式会挂起，并且 try-catch 也不会捕获错误。我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-14T12:39:06.313

正则表达式的性能问题是微不足道的。不要这样做：

```
(.|\s)* 
```

量词是懒惰还是贪婪完全无关紧要。问题是。和 \s 不是互斥的。两者都可以匹配空格。和\s。因此，如果您的正则表达式遇到空格，它将首先将空格与 . 匹配，如果正则表达式的其余部分失败，它将再次与 \s 匹配。如果您有两个空格，它将首先与 . 匹配，然后与 . 匹配。第二个用\s，然后第一个用\s，第二个用.，然后两个都用\s。如您所见，当您的正则表达式遇到一系列空格后跟正则表达式的其余部分无法匹配的内容时，它的复杂度为 O(2^N)。如果您有 10 个空格，则有 1024 个排列。如果你有 32 个空间，就有 40 亿个排列。

您只在 regex 失败时看到问题的原因是，当 regex 成功时，. 简单地匹配所有空格，并且 \s 永远不会得到任何动作。

我知道你想要做什么：你想匹配“任何”字符的运行，包括换行符，通常不匹配点。正确的解决方案是设置 RegexOptions.SingleLine 并改用此正则表达式：

```
.* 
```

如果您无法设置 RegexOptions.SingleLine，请使用此模式修饰符执行相同操作：

```
(?s).* 
```

如果您不能使用该模式修饰符，例如因为 JavaScript 不支持它，请使用具有两个互补速记的字符类：

```
[\S\s]* 
```

一旦你从你的正则表达式中得到那个可怕的 (.|\s) 交替，它就会完美地工作。无需使用其他人建议的任何复杂的正则表达式。单个惰性量词总是线性扩展。不互斥的交替总是会杀死你的正则表达式。我确实称这[为灾难性的回溯](http://www.regular-expressions.info/catastrophic.html)。

如果你想要一个允许标签终止评论的正则表达式，试试这个：

```
(?s)<!--.*?(-->|</script>) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T18:01:13.977

您可以重写正则表达式，以便在无法匹配时尽快失败，如下所示：

```
<!--(?>(?:[^-]+|-(?!->))*)--> 
```

如果您的示例中未关闭的注释后面跟着完整的注释，则此正则表达式将从 first 匹配`<!--`到 first `-->`，如下所示：

```
<!-- blah <!-- blah --> 
```

这就是您的浏览器应该如何处理 SGML 注释的方式。事实上，如果没有匹配`-->`，则后面的所有内容都会`<!--`被注释掉。所以正则表达式应该是：

```
<!--(?>(?:[^-]+|-(?!->))*)(?:-->|\z) 
```

但我怀疑这不是你真正想要的。为了获得更好的答案，我们需要知道您想对格式错误的 HTML 执行什么操作，例如您发布的代码段。

# visual-studio-2008 - VS 2008 配色方案

> ID：851069
> 
> 赞同：3
> 
> 时间：2009-05-12T03:55:01.193
> 
> 标签：visual-studio-2008

我正在寻找 'Oren Ellenbogen's Dark Scheme' 配色方案的 VS 2008 版本。[http://www.lnbogen.com/VisualStudioNet2005Colors.aspx](http://www.lnbogen.com/VisualStudioNet2005Colors.aspx)提供的方案是 VS 2005 版本。谁有2008版的。

VS 2008 不接受[http://tech-nous.blogspot.com/2008/10/visual-studio-2008-colour-schemes.html](http://tech-nous.blogspot.com/2008/10/visual-studio-2008-colour-schemes.html)上的转换版本。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T04:47:39.513

~~我想你会发现 Rob Conery 的主题非常接近：[http ://blog.wekeroad.com/blog/textmate-theme-for-visual-studio-take-2/](http://blog.wekeroad.com/blog/textmate-theme-for-visual-studio-take-2/)~~

Scott Hanselman 拥有我找到的最好的收藏：[http ://www.hanselman.com/blog/VisualStudioProgrammerThemesGallery.aspx](http://www.hanselman.com/blog/VisualStudioProgrammerThemesGallery.aspx)

Scott 还有一个指向 XSLT 的链接，该链接有助于将 2005 主题转换为 2008。

编辑：Rob Conery 链接因博客重新设计而失效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-07-12T11:32:19.453

它在我的 VS.NET 2008 上为我工作（提示：我写的；））

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T04:00:24.523

您可以从[http://winterdom.com/2007/11/vs2008colorschemes获得一些 VS2008 配色方案](http://winterdom.com/2007/11/vs2008colorschemes)

# vb.net - 检查DataTable是否有行的有效方法

> ID：851075
> 
> 赞同：9
> 
> 时间：2009-05-12T03:58:21.810
> 
> 标签：vb.net, datatable

我有一个搜索关键字然后返回 DataTable 的函数。我想检查里面是否有行，因为有时找不到查询。

```
 'which one shoud I use ?
    If dtDataTable Is Nothing Then
        'some code
        lbl_count.Text = "Found 0 result"
    End If

    If dtDataTable.Rows.Count > 0 Then
        'some code
        lbl_count.Text = "Found " & dtDataTable.Rows.Count.ToString & " results"
    End If 
```

谢谢。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2009-05-12T04:24:22.877

怎么样：

```
If dtDataTable IsNot Nothing AndAlso dtDataTable.Rows.Count > 0 Then
    'some code
    lbl_count.Text = "Found " & dtDataTable.Rows.Count.ToString & " results"
Else
    'some code
    lbl_count.Text = "Found 0 result"
End If 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T05:02:13.313

如果您使用的是 VB 9.0 (VS 2008)，您可以简单地使用以下内容

```
lbl_count.Text = String.Format("Found {0} result(s)", if(dbDataTable, dbDataTable.Rows.Count,0)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T04:01:19.903

您应该使用第二个，我认为第一个不起作用，如果它起作用，第二个将不起作用，因为 dtDataTable.Rows 会引发空引用异常。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T17:20:06.650

史蒂夫·埃科尔斯（Steve Echols）的两个钉子都钉在了头上，所以您知道**Andalso**检查第一个条件，如果第一个条件失败，则返回 FALSE；如果第一个条件为 TRUE，那么它才会检查第二个条件。

这样John Boker的观点也得到了照顾！

向双方致敬！

# haskell - 为什么这第一个 Haskell 函数无法处理无限列表，而第二个代码片段成功处理无限列表？

> ID：851078
> 
> 赞同：12
> 
> 时间：2009-05-12T04:00:03.213
> 
> 标签：haskell, functional-programming, fold

我有两个 Haskell 函数，这两个函数看起来都与我非常相似。但是第一个对无限列表失败，第二个对无限列表成功。我已经尝试了几个小时来确切地确定这是为什么，但无济于事。

这两个片段都是 Prelude 中“单词”功能的重新实现。两者都适用于有限列表。

这是不处理无限列表的版本：

```
myWords_FailsOnInfiniteList :: String -> [String]
myWords_FailsOnInfiniteList string = foldr step [] (dropWhile charIsSpace string)
   where 
      step space ([]:xs)      | charIsSpace space = []:xs    
      step space (x:xs)       | charIsSpace space = []:x:xs
      step space []           | charIsSpace space = []
      step char (x:xs)                            = (char : x) : xs
      step char []                                = [[char]] 
```

这是处理无限列表的版本：

```
myWords_anotherReader :: String -> [String]
myWords_anotherReader xs = foldr step [""] xs
   where 
      step x result | not . charIsSpace $ x = [x:(head result)]++tail result
                    | otherwise             = []:result 
```

注意：“charIsSpace”只是对 Char.isSpace 的重命名。

以下解释器会话说明第一个对无限列表失败，而第二个成功。

```
*Main> take 5 (myWords_FailsOnInfiniteList  (cycle "why "))
*** Exception: stack overflow

*Main> take 5 (myWords_anotherReader (cycle "why "))
["why","why","why","why","why"] 
```

**编辑：感谢下面的回复，我相信我现在明白了。这是我的结论和修改后的代码：**

**结论：**

1.  我第一次尝试的最大罪魁祸首是两个以“step space []”和“step char []”开头的方程。**将 step 函数的第二个参数与 [] 匹配是不可以的**，因为它强制评估整个第二个参数（但需要在下面解释一个警告）。
2.  有一次，我认为 (++) 可能会比 cons 更晚地评估它的右手参数，不知何故。所以，我想我可以通过将“= (char:x):xs”更改为“= [char:x] ++ xs”来解决这个问题。但那是**不正确**的。
3.  在某一时刻，我认为将第二个 arg 与 (x:xs) 匹配的模式会导致该函数在无限列表中失败。我*几乎*是对的，但并不完全正确！正如我在上面的模式匹配中所做的那样，针对 (x:xs) 评估第二个 arg*将*导致一些递归。它会“转动曲柄”，直到碰到“：”（又名“缺点”）。如果这从未发生过，那么我的函数将无法针对无限列表成功。但是，*在这种特殊情况下*，一切正常，因为我的函数最终会遇到一个空格，此时会出现“cons”。并且通过匹配 (x:xs) 触发的评估将停在那里，避免无限递归。此时，“x”将被匹配，但 xs 仍将是一个 thunk，所以没有问题。（感谢 Ganesh 真正帮助我理解这一点）。
4.  一般来说，您可以随意**提及**第二个 arg，只要您不**强制评估它**。如果你匹配了 x:xs，那么你可以随意提及 xs，只要你不强制评估它。

所以，这是修改后的代码。我通常尽量避免 head 和 tail，仅仅因为它们是偏函数，也因为我需要练习编写模式匹配等价物。

```
myWords :: String -> [String]
myWords string = foldr step [""] (dropWhile charIsSpace string)
   where 
      step space acc | charIsSpace space = "":acc
      step char (x:xs)                   = (char:x):xs
      step _ []                          = error "this should be impossible" 
```

这对无限列表正确有效。请注意，看不到头、尾或 (++) 运算符。

**现在，有一个重要的警告：** 当我第一次编写更正的代码时，我没有与“step_[]”匹配的第三个等式。结果，我收到了有关非详尽模式匹配的警告。显然，避免该警告是个好主意。

但我以为我会遇到问题。我已经在上面提到过，*将第二个 arg 与 [] 进行模式匹配是不行的*。但我必须这样做才能摆脱警告。

**但是，当我添加“step_[]”等式时，一切都很好！无限列表仍然没有问题！**. 为什么？

**因为从未达到更正代码中的第三个等式！**

事实上，考虑以下 BROKEN 版本。它与正确的代码完全相同，只是我将空列表的模式移到了其他模式之上：

```
myWords_brokenAgain :: String -> [String]
myWords_brokenAgain string = foldr step [""] (dropWhile charIsSpace string)
   where 
      step _ []                              = error "this should be impossible"
      step space acc | charIsSpace space     = "":acc
      step char (x:xs)                       = (char:x):xs 
```

我们回到堆栈溢出，因为调用 step 时发生的第一件事是解释器检查第一个等式是否匹配。为此，它必须查看第二个参数是否为 []。为此，它必须评估第二个参数。

将方程向下移动到其他方程的下方可确保永远不会尝试第三个方程，因为第一个或第二个模式*总是匹配*。第三个等式只是为了省去非详尽的模式警告。

这是一次很棒的学习经历。感谢大家的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T04:52:31.300

尝试手动扩展表达式：

```
 take 5 (myWords_FailsOnInfiniteList  (cycle "why "))
 take 5 (foldr step [] (dropWhile charIsSpace (cycle "why ")))
 take 5 (foldr step [] (dropWhile charIsSpace ("why " ++ cycle "why ")))
 take 5 (foldr step [] ("why " ++ cycle "why "))
 take 5 (step 'w' (foldr step [] ("hy " ++ cycle "why ")))
 take 5 (step 'w' (step 'h' (foldr step [] ("y " ++ cycle "why ")))) 
```

下一个扩展是什么？您应该看到，为了对 进行模式匹配`step`，您需要知道它是否为空列表。为了找出答案，你必须至少评估一下。但是第二个术语恰好是`foldr`您要进行模式匹配的功能的减少。换句话说，step 函数不能在不调用自己的情况下查看其参数，因此您有无限递归。

将其与您的第二个功能的扩展进行对比：

```
myWords_anotherReader (cycle "why ")
foldr step [""] (cycle "why ")
foldr step [""] ("why " ++ cycle "why ")
step 'w' (foldr step [""] ("hy " ++ cycle "why ")
let result = foldr step [""] ("hy " ++ cycle "why ") in
    ['w':(head result)] ++ tail result
let result = step 'h' (foldr step [""] ("y " ++ cycle "why ") in
    ['w':(head result)] ++ tail result 
```

您可能会看到这种扩展将继续，直到达到一个空间。一旦达到一个空格，“head result”将获得一个值，并且您将产生答案的第一个元素。

我怀疑第二个函数会溢出不包含任何空格的无限字符串。你能看出为什么吗？

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-12T05:05:11.030

其他人指出了这个问题，即 step 总是在产生任何输出之前评估它的第二个参数，但它的第二个参数最终将取决于当 foldr 应用于无限列表时另一个 step 调用的结果。

它不一定要这样写，但你的第二个版本有点难看，因为它依赖于初始参数来 step 具有特定格式，而且很难看出头/尾永远不会出错。（我什至不能 100% 确定他们不会！）

您应该做的是重组第一个版本，使其至少在某些情况下产生输出而不依赖于输入列表。特别是我们可以看到，当字符不是空格时，输出列表中总是至少有一个元素。因此，将第二个参数的模式匹配延迟到生成第一个元素之后。字符是空格的情况仍然取决于列表，但这很好，因为这种情况可以无限递归的唯一方法是传入一个无限的空格列表，在这种情况下不会产生任何输出并进入loop 是单词的预期行为（它还能做什么？）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T04:14:20.193

第二个版本直到开始产生自己的部分答案后才真正`result`进行评估*。*第一个版本通过对其进行模式匹配`result` *立即进行评估。*

这些无限列表的关键是您必须在开始要求列表元素之前产生*一些东西*，以便输出始终“领先于”输入。

（我觉得这个解释不是很清楚，但这是我能做的最好的。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T15:35:43.653

库函数`foldr`有这个实现（或类似的）：

```
foldr :: (a -> b -> b) -> b -> [a] -> b
foldr f k (x:xs) = f x (foldr f k xs)
foldr _ k _ = k 
```

的结果`myWords_FailsOnInfiniteList`取决于`foldr`哪个结果哪个取决于哪个结果`step`哪个取决于内部的结果`foldr`取决于...等等一个无限的列表，`myWords_FailsOnInfiniteList`在产生它的第一个词之前会用完无限量的空间和时间.

在产生第一个单词的第一个字母之前，函数`step`in`myWords_anotherReader`不需要 inner 的结果。`foldr`不幸的是，正如 Apocalisp 所说，它在产生下一个词之前使用了 O（第一个词的长度）空间，因为随着第一个词的产生，尾部 thunk 不断增长`tail ([...] ++ tail ([...] ++ tail (...)))`。

* * *

相比之下，比较

```
myWords :: String -> [String]
myWords = myWords' . dropWhile isSpace where
    myWords' [] = []
    myWords' string =
        let (part1, part2) = break isSpace string
        in part1 : myWords part2 
```

使用可以定义为的库函数

```
break :: (a -> Bool) -> [a] -> ([a], [a])
break p = span $ not . p

span :: (a -> Bool) -> [a] -> ([a], [a])
span p xs = (takeWhile p xs, dropWhile p xs)

takeWhile :: (a -> Bool) -> [a] -> [a]
takeWhile p (x:xs) | p x = x : takeWhile p xs
takeWhile _ _ = []

dropWhile :: (a -> Bool) -> [a] -> [a]
dropWhile p (x:xs) | p x = dropWhile p xs
dropWhile _ xs = xs 
```

请注意，生成中间结果永远不会被未来的计算所阻碍，并且只需要 O(1) 空间，因为结果的每个元素都可以使用。

* * *

### 附录

> 所以，这是修改后的代码。我通常尽量避免 head 和 tail，仅仅因为它们是偏函数，也因为我需要练习编写模式匹配等价物。
> 
> ```
> myWords :: String -> [String]
> myWords string = foldr step [""] (dropWhile charIsSpace string)
>    where 
>       step space acc | charIsSpace space = "":acc
>       step char (x:xs)                   = (char:x):xs
>       step _ []                          = error "this should be impossible" 
> ```

（旁白：您可能不在乎，但`words "" == []`来自图书馆，但您的`myWords "" = [""]`. 与尾随空格类似的问题。）

看起来大大改进了`myWords_anotherReader`，并且非常适合`foldr`基于 - 的解决方案。

```
\n -> tail $ myWords $ replicate n 'a' ++ " b" 
```

不可能比 O(n) 时间做得更好，但两者都`myWords_anotherReader`在`myWords`这里占用 O(n) 空间。鉴于使用`foldr`.

更差，

```
\n -> head $ head $ myWords $ replicate n 'a' ++ " b" 
```

`myWords_anotherReader`是 O(1) 但新`myWords`的是 O(n)，因为模式匹配`(x:xs)`需要进一步的结果。

你可以解决这个问题

```
myWords :: String -> [String]
myWords = foldr step [""] . dropWhile isSpace
   where 
      step space acc | isSpace space = "":acc
      step char ~(x:xs)              = (char:x):xs 
```

`~`引入了一种“无可辩驳的模式” 。无可辩驳的模式永远不会失败，也不会强制立即评估。

# ajax - 如何使用谷歌地图的“自动加载”功能？

> ID：851087
> 
> 赞同：2
> 
> 时间：2009-05-12T04:04:06.107
> 
> 标签：ajax, http, google-maps, map, autoload

我开始阅读有关自动加载谷歌地图的信息：

[http://code.google.com/apis/ajax/documentation/#AutoLoading](http://code.google.com/apis/ajax/documentation/#AutoLoading)

我不清楚的是如何实际**加载**谷歌地图。

我努力了：

```
<script src="http://www.google.com/jsapi?autoload=%7B%22modules%22%3A
%5B%7B%22name%22%3A%22search%22%2C%22version%22%3A%221.0%22%2C
%22language%22%3A%22en%22%7D%2C%7B%22name%22%3A%22maps%22%2C%22version
%22%3A%222.X%22%7D%2C%7B%22name%22%3A%22elements%22%2C%22version%22%3A
%221.0%22%2C%22packages%22%3A%5B%22localsearch%22%5D%7D%5D
%7D&key=MY_KEY"></script>
<script type="text/javascript">
//<![CDATA[
        google.load("maps", "2.x");
        google.setOnLoadCallback(function() {
                map = new google.maps.Map2(document.getElementById("map"));
                map.setCenter(new GLatLng(37.4419, -122.1419), 6);
                map.addControl(new GSmallMapControl());
                }
        );
//]]>
</script> 
```

**但是地图加载不出来。**

奇怪的是，如果我只是`autoload=`从 URL 中删除“...” - 地图会加载并正常工作。

如果我将`autoload=`... 保留在 url 中并注释掉手动加载的“ `google.load("maps", "2.x");`”，它仍然不起作用。

关于如何正确使用自动加载功能以获得最大性能（最小延迟）的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-10-10T00:57:55.517

你应该使用：

```
<script src="http://www.google.com/jsapi?autoload=%7B%22modules%22%3A
%5B%7B%22name%22%3A%22search%22%2C%22version%22%3A%221.0%22%2C
%22language%22%3A%22en%22%7D%2C%7B%22name%22%3A%22maps%22%2C%22version
%22%3A%222.X%22%7D%2C%7B%22name%22%3A%22elements%22%2C%22version%22%3A
%221.0%22%2C%22packages%22%3A%5B%22localsearch%22%5D%7D%5D
%7D&key=MY_KEY"></script> 
```

别的什么都没有。在您的示例中删除此之后的代码

# javascript - 在 JavaScript 中嵌入 HTML 标签

> ID：851089
> 
> 赞同：0
> 
> 时间：2009-05-12T04:06:25.090
> 
> 标签：javascript

我想在 Javascript 中的 script> 标签之间嵌入一个 html 标签

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T04:19:53.833

嘿，也许你正在寻找 jQuery。

```
$("p").text("<b>Some</b> new text."); 
```

请参阅嵌入的 HTML 标记。

少写多做

[jQuery](http://jquery.com/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T04:13:31.117

你不能。如果您希望 Javascript 编写 HTML，则必须使用`document.write()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T04:14:48.897

[E4X](https://developer.mozilla.org/en-US/docs/E4X)是您想要的吗？它允许您在 JavaScript 中嵌入 XML/XHTML，如下所示：

```
var someXml = <div><b>Some Text</b></div>; 
```

我怀疑这就是你所需要的，但这是你可以做你所要求的唯一方法。~~另外，我认为它不适用于 Internet Explorer。~~从头开始，它*仅*适用于 Firefox。

如果这不是您想要的，请`document.write()`按照其他人的建议使用 。

* * *

**编辑：** E4X 现在已被弃用，并已从较新版本的 Firefox 中删除。不要使用它。您应该使用 jQuery，正如我下面的答案所建议的那样，或者只是通过和朋友创建元素`document.createElement`并将它们注入到文档中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T04:24:52.580

如果你把它写在你的 body 标签中，那么你也可以使用你的 javascript 来访问它。

如果你想检查文档是否准备好，那么你可以使用[JQuery](http://jquery.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T04:12:15.470

你不能那样做。标签可以只包含文本（通常是 javascript）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T04:13:36.513

文档.write('

颜色1：'+颜色1+ '
颜色2：'+颜色2+'

');

# java - Java RSA 解密不适用于在 iPhone 中使用其公钥解密的数据

> ID：851093
> 
> 赞同：0
> 
> 时间：2009-05-12T04:09:26.240
> 
> 标签：java, iphone, encryption, rsa

嗨，我已经在 java 中创建了我的 rsa 公钥并发送给我的朋友。我的朋友正在使用 iPhone，他用那个密钥加密了数据并将解密的数据发送给我，然后我用我的私钥解密了数据。但是我收到错误填充错误。我和我的朋友都没有为 RSA 明确使用任何填充。

谢谢巴皮

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T04:16:54.247

你的问题不清楚它被解密了两次？

编辑您的编辑：您仍然错了，在询问有关您的具体实施的问题之前，您可能需要阅读公钥加密的工作原理。听起来你对这个过程很陌生

# sql-server - sql_who2 在 BlkBy 列中给出 -2

> ID：851094
> 
> 赞同：0
> 
> 时间：2009-05-12T04:10:31.743
> 
> 标签：sql-server, locking

我们今天在我们的开发服务器上遇到了一个问题，其中一个进程锁定了一个表，停止了该表上的所有其他查询工作。运行`sql_who2`时 blkBy 列值为 -2，但 -2 不在进程列表中。

运行时`DBCC INPUTBUFFER (-2)`出现异常*Invalid SPID -2 specified*。

运行[beta_lockinfo](http://www.sommarskog.se/sqlutil/beta_lockinfo.html)时，我看到它锁定的所有表和索引，但所有其他信息均为空，除了 ownertype 是 Transaction。

重新启动 webapp（在 web.config 中进行了更改）时，锁消失了，-2 SPID 的所有痕迹也是如此

我的问题是为什么 SPID 是负值，为什么我无法获得任何有关它的信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T04:19:31.713

SPID 为 -2 表示您的进程被孤立的分布式事务阻塞。

您可以使用`KILL 'GUID-OF-THE-UOW'`终止孤立的分布式事务或任何其他分布式事务。为此，您需要从`sys.dm_tran_locks.request_owner_guid`.

```
SELECT
    [tl].[request_owner_guid]
FROM
    sys.dm_tran_locks   tl
WHERE
    [tl].[request_session_id] = -2 
```

-2 只是一个人为的关联。-2 的会话 ID 只是通过查询动态管理视图中的会话 ID 列更容易识别孤立的事务。

# java - 从 JMenuBar 控制 JFrame

> ID：851096
> 
> 赞同：1
> 
> 时间：2009-05-12T04:10:59.963
> 
> 标签：java, swing, jframe

我试图从 JMenuBar 中最大化 JFrame，我无法传递对框架的引用。是否可以获得对其使用的框架的引用？

我可以进入顶级组件，但它没有办法最大化和最小化框架。

```
 public Container getApplicationFrame(ActionEvent event){
         JMenuItem menuItem = (JMenuItem) event.getSource();  
         JPopupMenu popupMenu = (JPopupMenu) menuItem.getParent();  
         Component invoker = popupMenu.getInvoker(); 
         JComponent invokerAsJComponent = (JComponent) invoker;  
         Container topLevel = invokerAsJComponent.getTopLevelAncestor();  
         return topLevel;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T04:34:54.933

您可以通过以下方式获取包含 JPanel 的窗口

```
Window window = SwingUtilities.getWindowAncestor(popupMenu); 
```

然后，您可以使用`window.setSize()`-- 最大化它，或者，因为您似乎知道它是一个 JFrame，所以将它转换为 Frame 并使用`setExtendedState`Kevin 提到的方法。[Java Developers' Almanac 中的示例代码](http://www.exampledepot.com/egs/java.awt/frame_FrameIconify.html)：

```
// This method minimizes a frame; the iconified bit is not affected
public void maximize(Frame frame) {
    int state = frame.getExtendedState();

    // Set the maximized bits
    state |= Frame.MAXIMIZED_BOTH;

    // Maximize the frame
    frame.setExtendedState(state);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T04:21:15.113

当然，您可以将有问题的框架存放在某个局部变量中吗？

至于实际最大化 Frame 一旦你掌握了它， Frame.setExtendedState(MAXIMIZED_BOTH) 可能是你想要的。[Javadoc](http://java.sun.com/j2se/1.4.2/docs/api/java/awt/Frame.html#setExtendedState(int))

虽然不像它可能的那样优雅，但在现有代码上的快速路径：

```
public Frame getApplicationFrame(ActionEvent event){
         if(event.getSource() == null) return null;

         Window topLevel = SwingUtilities.getWindowAncestor(event.getSource());

         if(!(topLevel instanceof Frame)) return null;

         return (Frame)topLevel;
}

...
//Somewhere in your code
Frame appFrame = getApplicationFrame(myEvent);
appFrame.setExtendedState(appFrame.getExtendedState() | Frame.MAXIMIZED_BOTH);
... 
```

最低 Java 版本 1.4.2。请注意，我没有测试过上面的代码，但你应该明白了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T04:28:27.550

创建框架和菜单栏的类也可以充当菜单项的 ActionListener，因为它可以访问框架和菜单栏。

# sharepoint - MOSS 2007 Standard 中发布网站的权限的最佳做法是什么？

> ID：851097
> 
> 赞同：3
> 
> 时间：2009-05-12T04:11:46.593
> 
> 标签：sharepoint, permissions, publishing

这是场景：

我有一个网站集，发布基础设施功能已激活。低于此的几个级别我有一个发布网站，发布功能已打开。我对这个网站也有独特的权限。

问题是除了网站集管理员之外没有人可以“创建页面”。我已经给了个人一切，包括完全控制权，但他们仍然无法创建页面。他们可以编辑页面，但不能创建。

难道我做错了什么？设置网站分类的正确方法是什么？我正在尝试创建一个层次结构以匹配我的组织，并且主要在每个站点/子站点上使用唯一权限。这工作正常，直到我需要一个发布网站，但我不希望他成为网站集管理员。我将不胜感激有关如何使发布网站按我的方式工作的任何帮助或想法，或者指导我以正确的方式布置网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T03:15:56.520

您正在使用发布功能这一事实不应影响权限。发布（在大多数情况下）确实对处理编辑的方式有更大的影响——即立即部署或签入并在稍后发布。这过于简单化了 - 但回到你的问题。

最有可能 - 发生的事情是您没有向用户授予他们需要访问模板以创建页面的库的权限。我 99% 确定这就是这里发生的事情。有道理 - 他们有权访问网站 - 并有权编辑现有页面 - 但创建页面需要他们访问不同库中的新文件。如果他们没有对该模板库的权限 - 您会收到拒绝访问错误。

当您的用户尝试创建页面时，他们会收到拒绝访问错误页面，对吗？复制该页面的 URL，并仔细检查。它应该显示他们尝试访问但没有权限的模板文件夹的位置。对该模板库的只读访问权限应该让您的用户获得他们需要的访问权限。

另一项建议 - 查看 Codeplex 中的访问检查器 Web 部件。 [http://accesschecker.codeplex.com/](http://accesschecker.codeplex.com/)。此 Web 部件作为解决方案加载，并允许您显示特定用户有权访问的站点的分层列表。非常有助于确认您已授予您认为拥有的权限。

最后 - 就权限最佳实践而言 - 我认为你做得很好。您有点沮丧，因为您在网站上采取了不同的路径（即发布）并且它的行为不同。但没有什么是错的。我去过那里:) 您确实有两个带有 SP 权限的选项 - 基于 SP 的组（访问者、成员、所有者等）或拉入 AD 组。无论哪种方式，您都将对唯一权限或继承权限做出相同的决定。您要么使用与父站点相同的权限，要么使用独特的权限。高温高压

# firefox - 创建 Firefox 插件需要什么编程语言？

> ID：851109
> 
> 赞同：16
> 
> 时间：2009-05-12T04:18:41.183
> 
> 标签：firefox, plugins, firefox-addon

创建 Firefox 插件的最低编程要求是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-05-12T04:21:47.763

您需要学习用于 UI 的[XUL](https://developer.mozilla.org/en/XUL)和用于编程的 Javascript。

更多信息在这里：

[https://developer.mozilla.org/En/Developing_add-ons](https://developer.mozilla.org/En/Developing_add-ons)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-12T04:27:59.827

Firefox 插件（例如 Flash 播放器之类的东西）是您在 NPAPI（插件的跨浏览器 API）中开发的二进制组件。

查看[Mozilla 插件开发者中心](https://developer.mozilla.org/en/Plugins)

您可能还会查看 Firefox Extensions 有时[Firefox 插件是作为扩展提供的](https://developer.mozilla.org/en/Shipping_a_plugin_as_an_extension)。Firefox 扩展修改或增强了浏览器本身的功能。Javascript 主要是您编写 Firefox 插件的语言。

查看[Mozilla 扩展开发者中心](https://developer.mozilla.org/en/Extensions)

一些在开发 Firefox 插件时派上用场的 Firefox 插件是[Venkman Javascript Debugger](http://www.mozilla.org/projects/venkman/)和[Firebug Javascript debugger](https://addons.mozilla.org/en-US/firefox/addon/1843)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-12T05:50:20.397

如果您喜欢有条理的阅读方式，并且喜欢一本好书，请从这里开始。 [http://www.amazon.com/Programming-Firefox-Building-Internet-Applications/dp/0596102437](https://rads.stackoverflow.com/amzn/click/com/0596102437) 它将让您开始了解 XUL 的基础知识，而 XUL 又用于构建插件。如果您对 javascript 有所了解，它肯定会对您有所帮助。

否则，从这里开始。 [https://developer.mozilla.org/En](https://developer.mozilla.org/En) 您可以开始学习开始开发 Firefox 插件甚至 Firefox 本身所需的一切。

如果您相当精通 Javascript 和 DOM，那么，请跳到这里。 [https://developer.mozilla.org/En/Developing_add-ons](https://developer.mozilla.org/En/Developing_add-ons)。唯一的问题可能是，它们对于新手程序员来说并不全面。如果你有一些编程方面的专业背景，并且可以从示例代码中学习一门语言，那么从这里开始。

但我肯定会推荐一本组织良好的书，就像我上面提到的那样。市场上很少有 XUL 书，这是我的第一个 google 结果，所以在这里链接它。

[在http://www.amazon.com/](http://www.amazon.com/)上搜索 XUL 。选择一个，至少是 2006 年 7 月之后出版的一本书。

[编辑] 刚刚发现这篇好文章 [http://kb.mozillazine.org/Getting_started_with_extension_development](http://kb.mozillazine.org/Getting_started_with_extension_development)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-12-24T22:29:10.127

这里似乎有一个巨大的误解；您是在尝试创建插件还是扩展程序？正如 Dougnukem 所说，插件与 XUL 或扩展无关。它们是共享库（用于 win、linux、mac 的 .dll、.so 或 .dylib），提供浏览器无法单独提供的功能。

如果您刚刚开始，我建议您查看[FireBreath 插件框架](http://www.firebreath.org)并阅读一些文档。一个不错的起点是：[http ://colonelpanic.net/2009/03/building-a-firefox-plugin-part-one/](http://colonelpanic.net/2009/03/building-a-firefox-plugin-part-one/)

此外，您还没有为这个问题选择答案；是因为你还没有找到答案，还是因为你忘记了？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T04:22:20.587

高级 DOM，Firefox API

# c++ - 大型二维数组给出分段错误

> ID：851122
> 
> 赞同：31
> 
> 时间：2009-05-12T04:22:49.837
> 
> 标签：c++, linux, stack-overflow

我正在 Linux 中编写一些 C++ 代码，其中我声明了一些 2D 数组，如下所示：

```
 double x[5000][500], y[5000][500], z[5000][500]; 
```

在编译过程中没有错误。当我执行时，它说“分段错误”。

文我把数组的大小从5000减少到50，程序运行正常。我怎样才能保护自己免受这个问题的影响？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2009-05-12T04:47:44.397

如果你的程序看起来像这样......

```
int main(int, char **) {
   double x[5000][500],y[5000][500],z[5000][500];
   // ...
   return 0;
} 
```

...然后你溢出堆栈。解决此问题的最快方法是添加单词*static*。

```
int main(int, char **) {
   static double x[5000][500],y[5000][500],z[5000][500];
   // ...
   return 0;
} 
```

解决此问题的第二快方法是将声明移出函数：

```
double x[5000][500],y[5000][500],z[5000][500];
int main(int, char **) {
   // ...
   return 0;
} 
```

解决此问题的第三个最快方法是在堆上分配内存：

```
int main(int, char **) {
   double **x = new double*[5000];
   double **y = new double*[5000];
   double **z = new double*[5000];
   for (size_t i = 0; i < 5000; i++) {
      x[i] = new double[500];
      y[i] = new double[500];
      z[i] = new double[500];
   }
   // ...
   for (size_t i = 5000; i > 0; ) {
      delete[] z[--i];
      delete[] y[i];
      delete[] x[i];
   }
   delete[] z;
   delete[] y;
   delete[] x;

   return 0;
} 
```

第四种最快的方法是使用 std::vector 在堆上分配它们。文件中的行更少，但编译单元中的行更多，您必须为派生的向量类型考虑一个有意义的名称，或者将它们放入匿名命名空间中，这样它们就不会污染全局命名空间：

```
#include <vector>
using std::vector
namespace { 
  struct Y : public vector<double> { Y() : vector<double>(500) {} };
  struct XY : public vector<Y> { XY() : vector<Y>(5000) {} } ;
}
int main(int, char **) {
  XY x, y, z;
  // ...
  return 0;
} 
```

第五种最快的方法是在堆上分配它们，但使用模板，这样维度就不会离对象那么远：

```
include <vector>
using namespace std;
namespace {
  template <size_t N>
  struct Y : public vector<double> { Y() : vector<double>(N) {} };
  template <size_t N1, size_t N2>
  struct XY : public vector< Y<N2> > { XY() : vector< Y<N2> > (N1) {} } ;
}
int main(int, char **) {
  XY<5000,500> x, y, z;
  XY<500,50> mini_x, mini_y, mini_z;
  // ...
  return 0;
} 
```

最高效的方法是将二维数组分配为一维数组，然后使用索引算法。

以上所有假设你有一些理由，一个好的或一个糟糕的，想要制作你自己的多维数组机制。如果你没有理由，并且希望再次使用多维数组，强烈考虑安装一个库：

*   一种与 STL 相得益彰的方法是使用[Boost Multidimensional Array](http://www.boost.org/doc/libs/1_39_0/libs/multi_array/doc/user.html#sec_introduction)。

*   一种快速的方法是使用[Blitz++](http://www.oonumerics.org/blitz/docs/blitz_2.html#SEC34)。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2009-05-12T04:28:30.840

这些数组在堆栈上。堆栈的大小非常有限。您可能会遇到...堆栈溢出:)

如果你想避免这种情况，你需要把它们放在免费商店：

```
double* x =new double[5000*5000]; 
```

但是你最好养成使用标准容器的好习惯，它为你包装了所有这些：

```
std::vector< std::vector<int> > x( std::vector<int>(500), 5000 ); 
```

另外：即使堆栈适合数组，您仍然需要空间来放置函数的框架。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-12T05:03:50.690

您可能想尝试使用[Boost.Multi_array](http://www.boost.org/doc/libs/1_39_0/libs/multi_array/doc/user.html#sec_example)

```
typedef boost::multi_array<double, 2> Double2d;
Double2d x(boost::extents[5000][500]);
Double2d y(boost::extents[5000][500]);
Double2d z(boost::extents[5000][500]); 
```

实际的大内存块将在堆上分配，并在必要时自动释放。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-12T04:27:30.140

你的声明应该出现在顶层，在任何过程或方法之外。

到目前为止**，诊断**C 或 C++ 代码中的段错误的最简单方法是**使用[valgrind](http://valgrind.net)**。如果您的一个阵列出现故障，valgrind 将准确指出在哪里以及如何发生。如果故障出在其他地方，它也会告诉你。

valgrind 可用于任何 x86 二进制文件，但如果使用`gcc -g`.

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T06:52:06.003

关于始终使用向量的一项保留：据我了解，如果您离开数组的末尾，它只会分配一个更大的数组并复制所有内容，当您真正想要使用时，可能会产生微妙且难以发现的错误一个固定大小的数组。至少对于一个真正的数组，如果你离开最后，你会出现段错误，从而使错误更容易被发现。

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char **argv) {

typedef double (*array5k_t)[5000];

array5k_t array5k = calloc(5000, sizeof(double)*5000);

// should generate segfault error
array5k[5000][5001] = 10;

return 0;
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T04:31:08.857

在我看来，你有一个诚实的 Spolsky 堆栈溢出！

尝试使用 gcc 的 -fstack-check 选项编译您的程序。如果您的数组太大而无法在堆栈上分配，您将收到 StorageError 异常。

不过，我认为这是一个不错的选择，因为 5000*500*3 双倍（每个 8 字节）达到大约 60 兆 - 没有平台有足够的堆栈。你必须在堆上分配你的大数组。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T05:03:56.337

前一个解决方案的另一个解决方案是执行

```
ulimit -s stack_area 
```

扩展最大堆栈。

# javascript - 排序组合 和 使用 jQuery

> ID：851123
> 
> 赞同：0
> 
> 时间：2009-05-12T04:22:51.957
> 
> 标签：javascript, jquery, jquery-ui-sortable

我是 Jquery 的新手。我想对我的数据列表使用 sortableUI。datalist 中的每一行都包含带有序列号的文本。我已经成功使用了可排序的 ui。但现在我想在排序时移动文本而不是序列号。这是我的示例代码。div 在每个 li 的左上角显示序列号。现在，如果我尝试用 3rd li 对例如 2nd Li 进行分层拖动，则第 3 个项目按规则进入第 2 个位置，但问题是它在第 2 个项目的 div 之后（它应该在 div 之前像第一次加载一样）。结果，根据 div 的样式.. 序列号 1 和 2 在第一个项目的位置重叠。

有什么方法可以用来在排序时保持 div 对应的 li 之后的 div 吗？

```
<ul id="ulSortable" class="ui-sortable" >
        <li class="Decide_Rank_Item_Li">test A</li>
        <div class="DisplayOrder">1</div>

        <li class="Decide_Rank_Item_Li">Test B</li>
        <div class="DisplayOrder">2</div>

        <li class="Decide_Rank_Item_Li">Test C</li>
        <div class="DisplayOrder">3</div>

        <li class="Decide_Rank_Item_Li">Test D</li>
        <div class="DisplayOrder">4</div>
</ul> 
```

排序前的图像：

[看不到图片](http://i41.tinypic.com/34fzaqp.png)

现在如果我开始稍微移动，你可以看到包含序列号的 div 仍然显示在正确的位置

[看不到图片](http://i42.tinypic.com/14n0ll5.png)

* * *

## 将第 2 项排序到第 3 项后

```
<ul id="ulSortable" class="ui-sortable" >
        <li class="Decide_Rank_Item_Li">test A</li>
        <div class="DisplayOrder">1</div>
       <div class="DisplayOrder">2</div>

        <li class="Decide_Rank_Item_Li">Test C</li>

        <li class="Decide_Rank_Item_Li">Test B</li>
        <div class="DisplayOrder">3</div>

        <li class="Decide_Rank_Item_Li">Test D</li>
        <div class="DisplayOrder">4</div>
</ul> 
```

排序后的图像：

## [看不到图片](http://i42.tinypic.com/180n4x.png)

这里显示 Li 和 Div 的样式 Style：

```
.Decide_Rank_Item_Li
{
        position: relative;
       display: block;
        border-color: #C0C0C0;
        border-width: 1px;
        border-style: solid;
        vertical-align:  bottom;
        width: 110px;
        height: 100px;
        float:left;
        background-color: #F8F8F8;

}

.DisplayOrder
{
        position: relative;
        display: block;
        float: left;
        top: 5px;
        left: -105px;
        z-index: 100;
        font-family: Arial, Helvetica, sans-serif;
        font-size: 12px;
        font-weight: bold;
        padding: 0px;
        margin: 0px;
        width: 0px;
        clear: right;
        color: #808080; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T07:25:31.410

我不得不更改 HTML 和 CSS，但我认为这可以达到您所追求的效果。

这是一个托管演示： http: [//jsbin.com/erigu](http://jsbin.com/erigu)（可通过[http://jsbin.com/erigu/edit](http://jsbin.com/erigu/edit)编辑）

```
<html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" type="text/css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js"></script>

    <style type="text/css" media="screen">
      * { margin: 0; padding: 0; }

      #numbers>div, #sortables>div {
        width: 110px;
        height: 100px;
        float: left;
        border: 1px solid #C0C0C0;
      }

      #numbers>div {
        padding-bottom: 20px;
        font: bold 12px Arial, Helvetica, sans-serif;
        color: #808080; 
        background-color: #F8F8F8;
      }

      #sortables>div {
        padding-top: 20px;
        text-align: center;
        color: black;
      }

      #sortables {
        position: absolute;
        left: 0px;
      }
    </style>
  </head>
  <body>
    <div id="numbers">
      <div>1</div>
      <div>2</div>
      <div>3</div>
      <div>4</div>
    </div>

    <div id="sortables">
      <div>Test A</div>
      <div>Test B</div>
      <div>Test C</div>
      <div>Test D</div>
    </div> 

    <script>
      $(function(){
        $('#sortables').sortable({
          /*
            The helper option allows you to customize the dragged element.
            in this case we are adding a background.
          */  
          helper: function(evt, el){
            return el.clone().css({background:'#F8F8F8'});
          }
        });
      });
    </script>  
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T08:50:51.100

只是想到了一个更优雅的替代解决方案：http: [//jsbin.com/udina](http://jsbin.com/udina)

```
<html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" type="text/css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/jquery-ui.min.js"></script>

    <style type="text/css" media="screen">
      body { background-color: #000; font: 16px Helvetica, Arial; color: #fff; }
      li {
        width: 100px;
        height: 100px;
        float: left;
        background: #F8F8F8;
        border: 1px solid #C0C0C0;
        list-style-position: inside;
        color: #C0C0C0;
      }
      div {
        text-align: center;
        color: #C0C0C0;
        font-size: 120%;
      }
      .placeholder {
        list-style-type:decimal;
      }
    </style>
  </head>
  <body>
    <ol>
      <li><div>Test Content A</div></li>
      <li><div>Test Content B</div></li>
      <li><div>Test Content C</div></li>
      <li><div>Test Content D</div></li>
      <li><div>Test Content E</div></li>
      <li><div>Test Content F</div></li>
      <li><div>Test Content G</div></li>
      <li><div>Test Content H</div></li>
      <li><div>Test Content I</div></li>
      <li><div>Test Content J</div></li>
      <li><div>Test Content K</div></li>
      <li><div>Test Content L</div></li>
      <li><div>Test Content M</div></li>
      <li><div>Test Content N</div></li>
      <li><div>Test Content O</div></li>
      <li><div>Test Content P</div></li>
      <li><div>Test Content Q</div></li>
      <li><div>Test Content R</div></li>
      <li><div>Test Content S</div></li>
      <li><div>Test Content T</div></li>
      <li><div>Test Content U</div></li>
      <li><div>Test Content V</div></li>
      <li><div>Test Content W</div></li>
      <li><div>Test Content X</div></li>
      <li><div>Test Content Y</div></li>
      <li><div>Test Content Z</div></li>
    </ol>
    <script>
      $(function(){
        $('ol').sortable({
          helper: function(evt, el){
            return el.clone().css('color', '#F8F8F8');
          },
          placeholder: 'placeholder'
        });
      });
    </script>
  </body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T05:13:46.477

最简单的事情可能是将`li`/`div`对放在另一个元素中，然后根据它进行排序。

像这样的东西应该可以工作，尽管有很多关于你想要如何做的选择。可排序功能不需要您使用`li`元素。

```
<ul id="ulSortable" class="ui-sortable" >
    <li class="Decide_Rank_Item_Li">
        <span>test A</span>
        <div class="DisplayOrder">1</div>
    </li>
    <li class="Decide_Rank_Item_Li">
        <span>test B</span>
        <div class="DisplayOrder">2</div>
    </li>
    <li class="Decide_Rank_Item_Li">
        <span>test C</span>
        <div class="DisplayOrder">3</div>
    </li>
    <li class="Decide_Rank_Item_Li">
        <span>test D</span>
        <div class="DisplayOrder">4</div>
    </li>
</ul> 
```

# plugins - 卡在 Vim 中安装 Taglist

> ID：851124
> 
> 赞同：6
> 
> 时间：2009-05-12T04:23:38.977
> 
> 标签：plugins, tags, vim

我试图在 VIM 中安装 Taglist，但我不明白这一步：

> 如果 PATH 中不存在 exuberant ctags 实用程序，则将 Tlist_Ctags_Cmd 变量设置为指向 .vimrc 文件中 exuberant ctags 实用程序的位置（而不是目录）。

这是什么意思？如果有人使用这个插件，你能帮我配置一下吗？

我下载了 ctags 并将我的变量设置为

:let Tlist_Ctags_Cmd='C:\Program Files\Vim\ctags-5.7\ctags.exe'

但我仍然收到“无法生成标签”错误。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T04:46:21.717

ctags 是一个单独的程序，您需要在系统上安装。

[http://ctags.sourceforge.net/](http://ctags.sourceforge.net/)

您需要查找特定操作系统的安装说明。

安装完成后，如果该变量不在 PATH 中，则可以按指定设置该变量

这里似乎有详尽的安装信息。

[http://vim-taglist.sourceforge.net/faq.html](http://vim-taglist.sourceforge.net/faq.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-02-07T16:04:41.290

如果你已经安装了 ctags 并且你仍然`Taglist: Failed to generate tags`像我一样收到错误，请确保在你的 vimrc 中使用这种格式：

```
let Tlist_Ctags_Cmd = '"C:\Program Files\ctags58\ctags.exe"' 
```

注意单引号内的双引号。我相信当你的字符串中有空格时这是必要的，这就是让事情对我有用的原因。

# c# - 我应该为我的应用程序使用 C#/.Net 还是 C++？

> ID：851128
> 
> 赞同：0
> 
> 时间：2009-05-12T04:25:44.230
> 
> 标签：c#, c++, performance, optimization, porting

我正在开发一个与之对话的项目，`SQL Server`并且大部分后端代码都在`C++`.

这是一个应用程序，可在将少量流体加载到载体中时控制它们的流动。与控制器通信的一些后端模块反过来控制流体的流动`C++`。由于它们存在内存泄漏和其他一些错误，因此已尝试将它们迁移到`.Net`.

我的理解是，当我们使用后端模块时，性能`.Net`会**下降**。所以我的意见不是将这些后端模块转换为 .Net，而是解决 C++ 本身的问题。

讨论中的代码是与控制器固件交互的应用程序。它基本上需要一些命令并从控制器获得响应。此代码没有 UI，并且相同的代码`SQL`也与之交互以更新数据。两者都是一个**exe**的一部分。

`.Net`当预期性能不严格时，被认为是好的。如果必须编写新代码，尤其是涉及 UI 设计时，这将是合适的。另一种思想流派是，.Net 适用于较高层，但不适用于多层架构中的较低层。

我想从不同的角度了解其他人的意见。需要考虑的一些方面是：

*   速度
*   代码的可维护性
*   未来与移民相关的风险
*   等等

请从重写现有代码的角度发表评论。如果我们决定去做的话，这将是一对一的 C++ 行到 C# 的转换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T04:59:56.873

快速回答：

如果您有能够使用调试器并了解他们的应用程序域以及如何使用控制器的有能力的 C++ 程序员，那么仔细审查并修复内存错误和问题可能会更容易。毕竟，时间和精力已经花在代码上了，除非是琐碎的代码，否则用 C# 重写可能会引入新的逻辑错误。

OP的问题：

> 讨论中的代码是与控制器固件交互的驱动程序代码。它基本上需要一些命令并从控制器获得响应。此代码没有 UI，并且相同的驱动程序代码也与 SQL 交互以更新数据

您是在谈论您命名为“驱动程序”的用户模式软件，还是在谈论内核模式设备驱动程序？

如果您可以提供有关这些控制器运行控制流体流动的固件的更多信息，将会有所帮助。C++ 后端是否通过 RS232（串行）连接到控制器？以太网？USB？TCP/IP？PCI？

如果您通过 TCP/IP 或 RS232（串行）连接到控制器硬件，C#/.NET 可以很好地处理该任务。对于 USB、PCI、以太网等其他任何东西，您将需要一个设备驱动程序，该驱动程序必须根据驱动程序的要求用 C 或 C++ 编程。当然你可以封装 C++ 中的用户模式部分，或者封装直接调用 Win32，但它会给你的项目增加更多的开发任务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T04:54:35.260

显然，现有 C++ 代码的唯一问题是内存泄漏。

在我看来，这似乎不足以用 C# 重写它。

相反，我建议运行内存泄漏检测软件来查找泄漏。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-15T13:50:19.830

“语言有其独特之处” 伙计，我需要一个拥抱，真的。不要因为代码写得不好而改变语言……编写更好的代码并使用可用的资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T04:33:24.110

每种语言都有自己的特殊性，您应该找出最适合该场景的语言

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T05:17:19.047

不要因为一些错误而用不同的语言重写整个程序——新产品中只会有不同的错误，而问答周期将不得不重新开始。我会修复 C++ 程序中的错误。如果问题是内存管理，我会强烈研究`std::auto_ptr`or `std::tr1::shared_ptr`，它会在完成后自动为您删除内存。如果这不是一个选项，我敢肯定，通过 valgrind 运行某些东西甚至为商业内存检查器付费会比重写整个东西（在时间和金钱上）更便宜。

# text-editor - vim72 和 vimfiles 文件夹有什么区别？

> ID：851133
> 
> 赞同：25
> 
> 时间：2009-05-12T04:28:13.477
> 
> 标签：text-editor, vim

我正在学习 VIM。windows中的VIM文件夹有两个子目录VIM72和VIMFILE。它们之间有什么区别？我应该在哪里安装我的插件？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-12T04:39:42.943

通常**VIM72**（取决于 vim 版本）是“运行时”目录，我相信这是 vim 在“运行时”期间搜索它需要的所有内容的地方。**您将在 linux 上的 ' $HOME/.vim** ' 目录中安装自定义的东西，例如插件（ **$HOME/.vim/plugin**中的插件）。

在 Windows 上，它似乎是**vimfiles**目录（您在我的 Windows 系统上询问了**VIMFILE**而 vim71 它是**vimfiles**）。

所以我会尝试将插件存储在系统上的**vimfiles\plugin**目录中。不同之处在于，在**VIM72**中，您将拥有与 vim 一起预打包的所有运行时内容，包括二进制文件。**你可以在你的vimfiles**目录中安装你自己的东西，通常会首先搜索语法高亮、配色方案、插件、文档等内容。

您可以从 vim 中找到**vim72**目录的位置、自定义内容的位置，例如`vim72/plugins`、`vim72/colors`colorshemes 等：

`:echo $VIMRUNTIME`

最后，**vim72**被 vim 7.2 使用，因此当版本更改时，它将使用不同的目录，如 vim73 等。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-05-19T09:01:06.893

**稍微扩展 stefan 的回答：**
就像他说的，`~/.vim`对于与 linux 相关的系统，通常`vimfiles`对于 Windows 上的 gvim - 这是您的 vim 主目录。

您应该将所有自己的插件放入 vimfiles 以确保在升级 vim 安装时不会丢失任何自定义插件或修改。

**例如**
有一个语法文件叫做 cpp.vim 在`vim72/syntax`.
如果您现在想更改此语法文件中的一些内容（例如添加一个额外的关键字），您可以在 vimfiles/syntax 中拥有此语法文件的副本，其中包含附加的关键字语法规则。
现在，当您将 vim 升级到 7.3 时，您仍然拥有所有自定义插件和设置。

如果你改为 change `vim72/syntax/cpp.vim`，当你下次升级 vim 时，这些文件将被新版本覆盖，你所做的任何更改都将丢失。
另外，由于`vim72/syntax/`包含所有原始语法文件，因此更难判断您自定义了哪些。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-10T22:13:19.223

'vimfiles' 目录是你可以在不接触 Vim 的安装目录（'vim72'）的情况下安装系统范围内的东西的地方。升级时目录 'vim72' 可能会发生变化，新的主要或次要版本将使用不同的目录（例如，Vim 7.1 使用 'vim71' 而 Vim 8.0 将使用 'vim80'）。

# javascript - 如何访问特定类的特定 div 子级？

> ID：851137
> 
> 赞同：0
> 
> 时间：2009-05-12T04:30:24.737
> 
> 标签：javascript, jquery

在我的 div 中，我有一个“someClass”类的子 div。我想通过类名而不是 id 访问那个孩子。

编辑：仅在这个特定的 div 中，而不是所有其他具有相同类名的 div

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T04:37:37.130

```
var childOfNamedDiv = $('#namedDiv>.someClass') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T04:32:22.957

```
var div = $('.someClass'); 
```

请参阅[jQuery 选择器](http://docs.jquery.com/Selectors)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T04:32:40.710

只需使用类选择器：

```
$('div>.someClass').toggle() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T05:29:08.183

如果您已经引用了作为您要查找的 div 的父级的 jquery 对象：

```
var parent = $("#someDiv"); // this is the div that you may alread have found earlier
var child = parent.children(".someClass"); 
```

# javascript - jQuery-请向我解释闭包，变量上下文

> ID：851138
> 
> 赞同：0
> 
> 时间：2009-05-12T04:30:56.233
> 
> 标签：javascript, jquery

好的，所以我不明白为什么 Firefox 说 $("#canvas")[0].getContext('2d'); 未定义。我把它放在函数之外，这样所有的函数都可以访问它，但是这里的 ctx 仍然是未定义的。

```
(function($) {
        // Undefined
        var ctx = $('#canvas')[0].getContext("2d");
        var x = 150;
        var y = 150;
        var dx = 2;
        var dy = 4;
        $(function() {
            setInterval(draw, 10);
        })
        function draw() {
            ctx.clearRect(0,0,300,300);
            ctx.beginPath();
            ctx.arc(x,y,10,0,Math.PI*2,true);
            ctx.closePath();
            ctx.fill();
            x+=dx;
            y+=dy;
        }
    })(jQuery); 
```

但是，当我将 ctx 的位置转移到未命名的函数时，ctx 不是未定义的：

```
(function($) {
        var ctx;
        var x = 150;
        var y = 150;
        var dx = 2;
        var dy = 4;
        $(function() {
              //Not Undefined
            ctx = $("#canvas")[0].getContext('2d');
            setInterval(draw, 10);
        })
        function draw() {
            ctx.clearRect(0,0,300,300);
            ctx.beginPath();
            ctx.arc(x,y,10,0,Math.PI*2,true);
            ctx.closePath();
            ctx.fill();
            x+=dx;
            y+=dy;
        }
    })(jQuery); 
```

第一个代码有什么问题？我的意思是 var ctx 在顶部声明。所以这将使它成为一个全局变量。嗯，我得到的错误是 $("#canvas")[0] 未定义。意味着它无法访问#canvas .. 为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T05:50:48.740

我想你弄错了问题。并不是你误解了你的变量上下文，而是你可能在你的画布标签被声明*之前运行了 javascript。*

下面的代码演示了这个问题。它将显示消息“canvasOne 未定义！” 因为我们试图`canvasOne`在声明之前访问（注意`<canvas>`标签的位置）。

我在这里创建了一个托管演示：http: [//jsbin.com/afuju](http://jsbin.com/afuju)（可通过[http://jsbin.com/afuju/edit](http://jsbin.com/afuju/edit)编辑）

```
<html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
  </head>
  <body>
    <script>
      /* 
        The following line of code is run as soon as the browser sees it.
        Since the "canvasOne" tag is not declared yet, the variable will be undefined.
      */
      var canvasOne = $('#canvasOne')[0];

      $(function() {
        // The following code is run after the whole document has finished loading.
        if (canvasOne === undefined) {
          alert('canvasOne is undefined!');
        }
        else {
          canvasOne.getContext("2d").fillRect(5, 5, 15, 15);
        }
      });
    </script>
    <canvas id="canvasOne"></canvas>

    <canvas id="canvasTwo"></canvas>

    <script>
      /* 
        The following line of code is run as soon as the browser sees it.
        But since the "canvasTwo" tag *is* declared above, the variable will *not* be undefined.
      */
      var canvasTwo = $('#canvasTwo')[0];

      $(function() {
        // The following code is run after the whole document has finished loading.
        if (canvasTwo === undefined) {
          alert('canvasTwo is undefined!');
        }
        else {
          canvasTwo.getContext("2d").fillRect(5, 5, 15, 15);
        }
      });
    </script>

    <script>
      $(function() {
        /*
          The following code is run after the whole document has finished loading.
          Hence, the variable will *not* be undefined even though the "canvasThree" tag appears after the code.
        */
        var canvasThree = $('#canvasThree')[0];
        if (canvasThree === undefined) {
          alert('canvasThree is undefined!');
        }
        else {
          canvasThree.getContext("2d").fillRect(5, 5, 15, 15);
        }
      });
    </script>

    <canvas id="canvasThree"></canvas>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T04:37:57.080

这是因为在您的第一次调用中，您实际上是在创建一个 Function 对象，该对象仅在 DOM 加载后在另一个上下文中进行处理。

当页面中的所有元素都已加载时，将调用该匿名函数，因此调用者将是一个 jQuery 核心函数，其上下文与您在此处编码的上下文完全不同。

我建议将所有内容都包含在`$()`调用中，因此应该可以：

```
(function($) {
        $(function() {
            var ctx = $("#canvas")[0].getContext('2d');
            var x = 150;
            var y = 150;
            var dx = 2;
            var dy = 4;

            setInterval(draw, 10);

            function draw() {
                    ctx.clearRect(0,0,300,300);
                    ctx.beginPath();
                    ctx.arc(x,y,10,0,Math.PI*2,true);
                    ctx.closePath();
                    ctx.fill();
                    x+=dx;
                    y+=dy;
            }
        });
})(jQuery); 
```

# url - 为数字 ID 格式化漂亮 URL 的最佳方法

> ID：851140
> 
> 赞同：8
> 
> 时间：2009-05-12T04:31:13.787
> 
> 标签：url, seo, url-rewriting, friendly-url

好的，假设我正在编写一个论坛应用程序，并且我想要漂亮的 URL。但是，我所有的表都使用数字 ID，所以我不确定格式化这些资源的 URL 的最佳方法。假设我正在尝试获取 ID 为 123456 且标题为*This is a forum post 的*主题。我已经看到它做了几种方式：

1.  www.example.com/topic/123456
2.  www.example.com/topic/this-is-a-forum-post
3.  www.example.com/topic/123456/this-is-a-forum-post

考虑到所有因素（包括 SEO），您会说哪一个是最佳 URL？

抱歉，如果这个问题太含糊，但它似乎与编程相关，而且并不是非常开放，因为我只想听听每种方法的优缺点。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-12T04:35:45.103

我会选择选项 3，并使 slug（最后一点）可选

因为？

*   ID 将始终是唯一的...例如 2 个人可能会创建一个名为“好消息”的主题
*   搜索机器人可以访问 slug 以获得一些 SEO 优势
*   slug 应该是可选的......仅使用 ID 仍然可以让您访问该站点。如果 slug 不存在，如果您担心重复的内容，您可以转发到 slug 的版本。您始终可以使用规范元标记告诉 Google 索引 slugged 版本。
*   可选 slug 的另一个好处是，如果有人将 URL 复制并粘贴到文档中，则它有可能在结尾处截断字符（因为 URL 通常没有空格，因此它们不会换行）。拥有可选的 slug 意味着人们更有可能找到您的页面。

我相信这就是 Stack Overflow 所做的......并且还注意到他们在搜索引擎中的表现相当不错。

### 更新

从评论中，确保 301 将任何缺失的 slug 版本重定向到正确的 slug。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-12T04:36:15.227

URL 1 绝对不是最理想的。URL 2 很吸引人，但如果标签发生冲突，您会冒着混淆的风险，尤其是当它们仅在标点符号上有所不同时。所以我会说 URL 3 是明显的赢家。

另请注意，仅仅因为您*显示*URL 3 并没有理由不*接受*所有 3 个，而其他两个重定向。如果 URL 2 不明确，则应重定向到消歧页面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T04:35:26.557

我认为第二个 URL 将是 SEO 的最佳选择，因为它有意义且深度较小。这对人们也更好，因为您可以查看 URL 并了解内容的内容。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T04:36:27.927

1.  不包含标题，因此您将失去在 URL 中包含这些关键字的额外 SEO 价值。

2.  效果不好，因为它没有唯一的数字 ID，所以如果其他人试图发布标题为“这是一个论坛帖子”的主题，你会怎么做？然后你开始进入 digg 所做的奇怪的事情，它必须给第二个 url “ [http://www.example.com/topic/this-is-a-forum-post_2](http://www.example.com/topic/this-is-a-forum-post_2) ”，等等。这使得获取他们尝试加载的 URL 并准确确定他们试图访问的主题变得更加困难。

3.  两全其美，这将是我选择的风格。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T04:36:20.657

Stackoverflow 似乎使用模式 3，标题被完全忽略（只使用了 id）。

这使得 URL 语义很好，并且也很容易实现，并且在标题稍后更改时仍然有效。

当然，标题可能完全是假的：

[为数字 ID 格式化漂亮 URL 的最佳方法](https://stackoverflow.com/questions/851140/who-is-the-best-captain-the-uss-enterprise-has-ever-had)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T04:38:21.793

我会去第一个。你知道现在这真的不重要了。由于有长 URL 转换器，它只会激增，并将成为未来的常态。请记住，您的 URL 越长，您获得的 SEO 积分就越少。

而且您无法控制人们命名论坛主题的方式。所以真的，为了简单和规范，我会选择第一个。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T04:42:40.507

对于 SEO/流量，毫无疑问绝对是第二名。每次都从 URL 中取出那些无意义的数字。

www.example.com/topic/this-is-a-forum-post

从您的数据库中提取“this-is-a-forum-post”并通过查询将其映射回数据库中的 ID 号。然后将内部 URL 重写到真实页面，例如 /topic.php?ID=324342

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-05-12T05:11:31.177

我会选择选项 2，因为 SEO 可以更好地理解。

Stack Overflow 可能使用了第三种方式，这就是 Stack Overflow url 没有针对 SEO 进行优化的原因。我不确定上面的答案。

但根据我使用 Google 的经验，我经常可以从其他论坛看到解决方案，而 stackoverflow 解决方案几乎是不可见的。

[为数字 ID 格式化漂亮 URL 的](https://stackoverflow.com/questions/851140/best-way-to-format-pretty-urls-for-numeric-ids) [最佳方法 为数字 ID 格式化漂亮 URL 的最佳方法](https://stackoverflow.com/questions/851140)

如果两个 url 相同，则 SEO 只需使用选项 2，该选项的优化程度较低。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-06-10T14:30:33.137

我不相信更长的 URL 是 SEO 的麻烦。深度似乎是一个更大的问题，不是通过计算斜线，而是通过从具有排名的索引页面到内容页面所需的步骤。我最近创建了一个名为 /content/roofing/how-much-does-a-shingle-roof-cost.html 的虚拟测试页面，并将其扔到服务器上只是为了测试路径并确保我的目录正常工作。我什至不确定谷歌是如何发现这个页面的，但它确实发现了，并且开始获得流量，所以我不得不给它内容并让它成为家庭的一部分。虚拟内容是我们关于页面的副本，因此它不是空的，但我很惊讶未升级的页面会受到关注，并且认为 URL 与此有关。

这为 URL 提供了上述 3 个选项的替代方案。如果您选择 3 号但在末尾添加 .html 会怎样？我通常使用动态 URL 来执行此操作，但我没有具体证据表明它有帮助。据谷歌称，他们吹嘘他们可以很好地索引动态 URL，因此根本不需要重写 URL。如果其他引擎不那么擅长，谷歌一点也不介意。我信任的几个网站在末尾添加了 html（例如博客），它不会受到伤害，所以我仍然这样做。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-12T04:38:19.780

我建议第一个，因为为了清楚起见，管理员可以更改主题标题，然后 url 将不一致。

```
www.example.com/topic/123456 
```

还允许仅编辑 url 的最后一位（数字并跳转到另一个主题），不太可能发生但仍然是一个可用的功能。

# unit-testing - [在此处插入语言] 的测试框架

> ID：851144
> 
> 赞同：3
> 
> 时间：2009-05-12T04:33:12.767
> 
> 标签：unit-testing, testing, fitnesse, fitnesse-slim, dataflex

我正在寻找一个测试框架来为[没有太多测试支持的语言](http://www.visualdataflex.com/)引入自动化测试。据我所知，我需要一个能够使用某种形式的协议运行 VDF 测试的框架。我更愿意花时间编写测试而不是编写 VDF 代码来与测试框架交互，因此更喜欢轻量级协议。

[Slim with Fitnesse](http://www.fitnesse.org/FitNesse.SliM.SlimProtocol)似乎是一个不错的候选人，但我对*所有*建议都很感兴趣。

能够跨编程语言使用相同的测试框架将是一个额外的好处。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-13T16:39:39.843

这假设您在 API 级别工作。如果我读错了，并且您在 GUI 级别工作，那么您更倾向于考虑 selenium 或 watir 之类的东西。

您是否考虑过编写自己的简单测试框架来输出 TAP 结果（测试任何协议） - 然后使用grind 或 TAP2HTML 对其进行解析？

说真的，TAP 输出如下所示：

```
1..7
ok 1 - 带有 null 值的 hello world 返回“hello world”字符串
ok 2 - hello world with bob 返回 'hello, bob'
ok 3 - hello world with 123 return 'hello, 123'
ok 4 - 带有 5K 字符串的 hello world 返回 hello 加字符串
好的 5 - 特殊字符
好的 6 - 国际化，法国
好的 7 - 国际化，ja
看起来你没有通过 0 次 7 次测试。

```

（如果它在第 5 步之后死了，1..7 会告诉你有问题）

输出是直接的 ASCII。您基本上将拥有两个全局变量，numTestsTotal 和 numTestExecuted，并编写如下函数：

```
sub ok (boolean bExpected, 字符串注释) {
  如果（b预期）{
    打印“好”。numTestsExecuted 。“”。评论 。"\n";    
  }别的 {
    打印“不好”。测试总数。“”。评论 。"\n";
  }
  numTestsExecuted++；
}

sub eq（int iExpected，int iResult，字符串注释）{
  如果（iExpected==iResult）{
     打印“好”。numTestsExecuted 。“”。评论 。"\n";
  } 别的 {
     打印“不好”。numTestsExecuted 。“”。评论 。\n";
  }
  numTestsExecuted++；
}

```

您在库中编写常规代码，然后您的测试应用程序包含库和测试模块。

您可以为每种类型的值重载 eq ，而 write 是比较数组等。

请参阅有关 TAP 的文档：http: [//testanything.org/wiki/index.php/Main_Page](http://testanything.org/wiki/index.php/Main_Page)

和[测试::更多](http://metacpan.org/pod/Test::More)

是的，你可以争辩说 eq() 应该“只是”调用 ok()。或者您可以在输出中插入预期和实际结果。由你决定。

无论如何，有很多 TAP 解析器和解释器可用于更多命令式语言。

# asp.net - 如何从日期时间格式中获取日期

> ID：851146
> 
> 赞同：3
> 
> 时间：2009-05-12T04:33:34.950
> 
> 标签：asp.net, vb.net

我有一个日期时间，例如：23/9/2009 10:00:00 AM。我想从日期时间获取日期。意思是 23/9/2009。有人可以帮忙吗

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T04:39:33.257

做就是了

```
DateTime dateOnly = myDateTime.Date; 
```

要将其显示为日期，您可以执行

```
string dateString = dateOnly.ToShortDateString(); 
```

请注意，即使使用时间组件，ToShortDateString 也可以使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T04:37:41.763

你可以这样做：

```
DateTime.Parse("23/9/2009 10:00:00").Date.ToString() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T04:42:51.567

是的，.Date 属性会给你你需要的东西。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T04:37:35.087

搜索网络总是有帮助的。

谷歌“datetime msdn”，你会得到最好的[参考资料](http://msdn.microsoft.com/en-us/library/system.datetime.aspx)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-17T19:43:48.817

除了 ToShortDateString 函数之外的另一种方法。这里我们使用格式字符串来获取我们的结果。

```
dim myDateFormat as String = "MM/d/yyyy"
dim myDateTime as DateTime = DateTime.Now    'Displays: 1/17/2014 2:33:23 PM
dim myDateOnly as DateTime = myDateTime.ToString(format)     'Displays: 1/17/2004 
```

# xmpp - 谁真正使用完整的 JID？

> ID：851156
> 
> 赞同：6
> 
> 时间：2009-05-12T04:37:41.137
> 
> 标签：xmpp, smack

通过 smack 登录 XMPP 服务器时，我只发送用户 ID/密码组合。

服务器组件是否真的在完整的 JID 中使用“资源”参数？

例如 ali@someplace/resource

发送它有什么好处？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T21:50:13.353

如果您有多个客户端登录，资源会很有用。

例如，如果我在家中和工作时使用不同的资源为每个连接登录，那么我可以为每个连接设置我的状态。也许我在家，所以工作已设置*xa*，而家已设置为*聊天*。

当您拥有异构客户端并且您可以使用功能 (XEP-0115) 来区分客户端可以使用的功能时，资源真的很有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-11-11T22:51:20.813

XMPP 有 3 种类型的节：message、presence 和 iq。只有裸 JID 的消息和存在才会被路由到客户端。带有裸 JID 的 iq 节将由服务器处理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-10-12T23:50:54.470

我认为对于大多数 jabber 用户来说，主要优势是为同时连接的不同客户端设置不同的存在。将此与`priority`存在节的子项结合起来，您可以控制未定向 (to="user@server") 消息（阅读：消息节！）的去向。如果有一个，您的服务器将选择一个具有最高优先级的客户端，如果有多个，我认为实际行为未指定。并且，仅当所选客户端的优先级为非负时，才会传递消息。

# iphone - Cocoa Touch 中跨多个视图的一个实例

> ID：851158
> 
> 赞同：1
> 
> 时间：2009-05-12T04:37:46.957
> 
> 标签：iphone, objective-c, cocoa-touch

我想知道我将如何访问一个类的一个实例，比如跨多个视图的“船类”。

假设我有一个 rootViewController 和三个子视图，一个主视图、一个战斗视图和一个着陆视图。我究竟将在哪里实现一个类的实例，该实例存储我船上的所有信息并通过其他视图访问它。如果我的船还剩下 x 枚导弹，另一个视图如何访问该信息以显示它。如果我在主视图上实现它，登陆视图如何获取该信息？

我知道必须有一种简单的方法来做到这一点，而且我敢打赌，你应该有一种方法来做到这一点，而无需在任何视图本身中实现 ​​ship 类。不过，我对 iPhone 编程还是很陌生。

预先感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T05:28:31.693

创建 Ship 类的单个实例后，您需要告诉任何其他视图该实例是什么。因此，您可以将 Ship 设为创建它的类的公共属性。

```
@property (nonatomic, retain) Ship* myShip; 
```

假设该类是应用程序委托 - 然后，在另一个文件中，您将编写类似

```
[[[UIApplication sharedApplication] delegate].myShip getNumberOfMasts]; 
```

这很简单，适用于一个简单的项目，但它确实使 Ship 对象可用于项目中的任何文件 - 它实际上变成了全局数据，在较大的项目中很难调试。（如果 myShip 发生了问题，是哪个对象负责？如果它可能是您应用程序中的任何对象，那么与访问权限仅限于需要它的两个类相比，这是一个更难调试的问题。）所以，如果您想要限制对 ship 的访问，那么不要让 myShip 成为公共属性 - 而是让创建 myShip 的对象在创建其他需要访问的对象时在初始化调用中传递它。像这样的东西

```
[[myBattleController alloc] initWithShip:myShip]; 
```

如果这确实是整个应用程序的唯一一个船舶对象，请搜索堆栈溢出以获取有关创建单例对象的建议。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T05:00:36.653

您的船类是 MVC（模型视图控制器）中的模型。这将是一个独立的课程。您的 3 个视图是 MVC 的视图部分。你所缺少的只是一个控制器。控制器创建您的模型（例如船类）和您的视图并保存对所有这些的引用。

控制器是应用程序的“中心”。它从视图接收用户输入并对模型执行操作，然后告诉视图刷新显示。

有几种方法可以将数据传递给查看。两种可能的选择：添加方法以将数据传递给视图（例如在视图上显示一些信息）。第二个选项，可能在这里更适用，是让每个视图保持对模型的引用——这仅用于“只读”访问。例如，当您的视图需要重新显示时，它们会从模型（船级）中获取准确的数据。

看看 MVC 模式，即使在苹果文档中也有很多关于它的信息。

# jquery - 如何在 ASP.NET MVC 中返回 JsonResult

> ID：851160
> 
> 赞同：3
> 
> 时间：2009-05-12T04:38:06.910
> 
> 标签：jquery, asp.net-mvc, json

我的 Action 方法中有以下数据作为字符串：

```
string json = "[[1,2],[3,4],[5,6]]"; 
```

简单的。

当我调用 Json 视图时，它将结果封装在两个双引号中。这会阻止客户端 javascript 将此结果加载到 javascript 对象中。

```
eg. 
return Json(json);

result => "[[1,2],[3,4],[5,6]]" 
```

但是，如果我将结果作为 ContentResult 返回，那么结果会被加载到一个 javascript 对象中，我可以用它做任何我需要做的事情。

```
eg.
return new ContentResult
{
    Content = json,
    ContentType = "application/json",
    ContentEncoding =System.Text.Encoding.UTF8
};

result => [[1,2],[3,4],[5,6]]      
          (notice how the double quotes are missing?). 
```

那么，有人可以解释一下我应该做对的事情吗？我觉得 ContentResult 不是正确的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T05:30:15.810

我猜想`JsonResult`序列化你传入的对象。因为你的字符串或多或少是“序列化”（用 Json 术语），所以它所能做的就是看到对象是一个字符串，并且在 'Json land '，字符串文字会在它们周围加上引号。

也许如果您将字符串更改为某种强类型的列表/集合/数组（代表字符串中的数据），它将正确序列化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T05:33:58.237

我意识到您可能想要一个服务器端解决方案 - 但万一您找不到，您可以在 Javascript 客户端评估返回的字符串：

```
var jsonResult = eval(resultWithQuotes); 
```

请注意，仅当您从安全来源获取结果时才应执行此操作，因为这可能会导致加载恶意脚本。

# c# - 您如何将任何文档转换为预览图像？

> ID：851161
> 
> 赞同：7
> 
> 时间：2009-05-12T04:38:16.643
> 
> 标签：c#, .net, ms-office, document, preview

我正在使用 .NET，并且正在寻找一种将几乎任何文档转换为预览图像的方法。我说任何，但优先级是 Office 文档、PDF 和大多数图像文件。

我会假设我可以以某种方式构建 Windows Explorer 预览文档的能力......但我不知道如何。

你会怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T04:47:04.150

在 Windows Vista 上，您可以使用[预览处理程序 API](http://www.codeproject.com/KB/vista/PreviewApp.aspx)编写预览处理程序或使用预览处理程序在应用程序中显示预览。该链接包含向您展示如何操作的代码。[这是一个示例 Photoshop 预览处理程序](http://www.codeproject.com/KB/vista/PhotoshopPreviewHandler.aspx)，它还检查了一些可能有用的背景信息。

最后，[这是一个使用 C# 的示例](http://www.codeproject.com/KB/WPF/wpf_vista_preview_handler.aspx)。这是一个 WPF 应用程序，它使用 C# 类`COMStream`从预览处理程序（这是一个非托管 COM 对象）获取预览数据。

# c - gcc 能准确捕捉无用的条件吗？

> ID：851162
> 
> 赞同：17
> 
> 时间：2009-05-12T04:38:16.877
> 
> 标签：c, gcc, memory-leaks

请检查以下代码：

```
if (foo->bar == NULL);
   foo->bar = strdup("Unknown"); 
```

我花了三个小时的最后一部分与 Valgrind 一起寻找泄漏，当我发现虚假的 ';' 时感觉很傻**。**

我知道上面的代码是有效的 C，但是我希望 gcc 能够告诉我是否使用条件作为语句。

有没有我可以通过的标志，这将有助于在未来发现这种类型的错误？在我看来，gcc 将能够知道条件是否无用。

**即**：

```
if (1 == 1);
  code_that_is_always_reached_since_conditional_is_a_statement(); 
```

没有任何 lints 对此有异议。Valgrind 很高兴找到这些东西.. 但实际上代码中的泄漏比最初分配指针的位置要晚得多。

任何帮助都会受到赞赏，即使是“不，它不会那样做”。

编辑：

哇，感谢您如此快速而出色的回复！总而言之，以下是您的选择：

*   -Wextra 收集了 -Wall 没有的各种东西，包括空/无用的语句。
*   -Wempty-body 拾取无用的语句，由 -Wextra 启用（但可以破坏旧版本的 gcc，适用于 4.3.x）

有些人可能会发现 -Wextra 很烦人。您可能会比较不同签名的类型，但您**知道**只有在它们相同时才会进行比较。

IE

```
int ret;
unsigned int i;

ret = foo(bar); /* foo() is known to return a signed errno on failure */
if (ret < 0)
  return 1;

/* Enter GCC complaining that ret differs in signedness
 * (but you know it doesn't and get the urge to cast it) */
for (i = 0; i < ret; i ++)
   ... 
```

再次感谢您的提示！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2009-05-12T04:42:55.840

```
/* foo.c */
int main() {
   if (1) ; 
   return 0;
}

gcc -Wextra -c foo.c
foo.c: In function ‘main’:
foo.c:2: warning: empty body in an if-statement 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-12T04:52:26.590

在深入研究 gcc 手册后：

```
-Wempty-body
    Warn if an empty body occurs in an `if', `else' or `do while' statement. This warning is also enabled by
-Wextra. 
```

正如其他一些海报所写，-Wextra 应该这样做

示例代码：

```
int main(){

        if (0);
                printf("launch missiles");
        return 0;
}

$gcc -Wempty-body foo.c
warn.c: In function ‘main’:
warn.c:5: warning: suggest braces around empty body in an ‘if’ statement 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-05-12T04:44:24.857

试试 -Wextra

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-05-12T05:12:21.923

作为编译器的替代方案，我发现在代码上运行自动缩进器有助于发现这些情况。

以 vim 为例：

```
gg=G 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T05:51:48.863

除了上述之外，如果您发现自己在使用 valgrind 或类似的执行分析器寻找错误时感到沮丧，您或许应该考虑使用静态分析工具，例如[lint](http://en.wikipedia.org/wiki/Lint_programming_tool)。就个人而言，我使用[PC-LINT](http://www.gimpel.com/)，它可以捕获各种类型的错误。

# xml - 同一个元素，多种类型的 XML Schema

> ID：851182
> 
> 赞同：0
> 
> 时间：2009-05-12T04:47:17.130
> 
> 标签：xml, xsd, schema

我想构造以下 XML：

```
<?xml version="1.0"?>
<foo>
  <bar type="alpha">
    <first />
    <second />
  </bar>
  <bar type="bravo">
    <third />
    <fourth />
  </bar>
</foo> 
```

重点是我希望“bar”根据其类型具有不同的子元素——如果类型是“alpha”，那么子元素必须是“first”和“second”，如果类型是“bravo”那么孩子必须是“第三”和“第四”。XSD 验证器似乎不喜欢用两个不同的规则集定义同一个元素的想法。

如何构建 XML 模式文档来强制执行此规则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T05:05:51.390

不幸的是，您不能使用 XDS 执行此操作，请参阅架构组件约束[cos-element-consistent](http://www.w3.org/TR/xmlschema-1/#cos-element-consistent)。您可以更改内容模型作为解决方法，也可以使用允许这样做的 Relax NG。

# javascript - 如何在 Flash 中访问 html 元素？

> ID：851183
> 
> 赞同：0
> 
> 时间：2009-05-12T04:47:32.340
> 
> 标签：javascript, html, flash, actionscript, dhtml

我有一个嵌入了 Flash 电影的 html 页面，该 Flash 电影包含一个按钮。我想将包含 html 页面上的元素的 id 传递给 flash 电影，以便在单击按钮时，我可以在 flash 中获取该元素的文本（即 innerHTML）。

所以，我的问题基本上是两个问题：

*   如何将某些内容从 HTML/Javascript 传递到 Flash？
*   如何从 Flash 访问包含 html 页面上的元素？（需要什么 ActionScript 代码才能做到这一点？）

非常感谢 ...

编辑：

我找到了第一个问题的答案（使用 Flash Vars），希望有人可以帮助我解决另一个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T05:00:40.540

有关在 ActionScript中使用[ExternalInterface类的信息，](http://livedocs.adobe.com/flex/2/langref/flash/external/ExternalInterface.html)[请参阅此 StackOverflow 答案。](https://stackoverflow.com/questions/312880/actionscript3-to-javascript-communication-best-practices)

# module - 使用 ExpressionEngine Core 安装结构模块

> ID：851184
> 
> 赞同：0
> 
> 时间：2009-05-12T04:47:33.167
> 
> 标签：module, structure, core, expressionengine

我正在尝试使用**ExpressionEngine Core安装****Structure 模块。**我重新安装了所有东西：

 **1.  表达式引擎 1.6.7

2.  结构 1.2.5（根据[http://expressionengine.com/forums/viewthread/91290/将空的 lang.pages.php 文件添加到 /language/english](http://expressionengine.com/forums/viewthread/91290/)

3.  [按照http://expressionengine.com/forums/viewthread/91290/](http://expressionengine.com/forums/viewthread/91290/)上安装结构的说明进行操作

4.  遵循[http://jambor-ee.com/tutorials/structure上的结构教程](http://jambor-ee.com/tutorials/structure)

现在我被封锁了。我添加的所有新顶级页面都获取地址，例如**domain.com/-1/**、**domain.com/-2/**等。除了地址不正确之外，这些链接还会导致 404 错误。

如果我添加一个子页面（**/contact/contactmail**），它会在 Modules » Structure 下显示为**domain.com/-4/contactmail**，也已损坏。

唯一有效的页面是我的主页——有没有人知道我做错了什么，或者我是否需要修改有关 Structure 安装的某些内容以使其与 ExpressionEngine Core 一起工作？

我已经安装了 3 次，并且拥有正确版本的 PHP。每次我最终得到这些顶级页面的负整数链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-26T05:26:51.710

乍一看，这看起来像是我（和其他几个人）遇到的 Structure 的一个类似错误，其中“-1”会被附加到来自 Structure 的某些路径的 URL 上。

原问题：[http](http://expressionengine.com/forums/viewthread/91290/P774/#618754) ://expressionengine.com/forums/viewthread/91290/P774/#618754 如果是同样的问题，目前的修复方法是查看数据库字段Structure用来存储页面URL的一些序列化数据，修复一下，然后重新序列化。[http://expressionengine.com/forums/viewthread/91290/P810/#621769](http://expressionengine.com/forums/viewthread/91290/P810/#621769)

如需更多帮助，您需要发布您的博客详细信息和结构设置。老实说，最好的地方可能是在官方结构支持线程中发布，以便开发人员可以掌握所有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-01T19:57:42.603

我也遇到了这个问题，我看到的解决方案是在 /system/languages/english/ 文件夹中创建一个 lang.pages.php 文件。如果我没记错的话，只要它在那里，它就可以是一个空文件。

# asp.net - 网络视频会议

> ID：851188
> 
> 赞同：0
> 
> 时间：2009-05-12T04:49:45.753
> 
> 标签：asp.net, flash

我必须为我们的网站创建一个语音会议

你觉得什么是最好的选择

.Net 还是 Flash？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T05:19:02.787

ASP.NET 是服务器端技术，所以我不确定你想如何将它用于语音会议，也许你的意思是 Silverlight？

Flash 是 IMO 的赢家，因为 99% 的用户已经安装了 Flash。另一方面，Silverlight 只有 25%。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T06:23:22.667

检查“Adobe Flash Media Server”这是一个非常酷的视频和音频流服务器。您可以查看 Flash Media Server 开发人员中心：[这里](http://www.adobe.com/devnet/flashmediaserver/)

# sql-server - SQL Server 2000 中可用的魔术表有哪些？

> ID：851189
> 
> 赞同：1
> 
> 时间：2009-05-12T04:51:19.493
> 
> 标签：sql-server

SQL Server 2000 中可用的魔术表有哪些？

我想知道，为什么它们是“魔术”表？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T05:01:12.503

“魔术表”是**INSERTED**和**DELETED**表，以及**update()**和**columns_updated()**函数，用于确定 DML 语句导致的更改。

*   对于 INSERT 语句，INSERTED 表将包含插入的行。
*   对于 UPDATE 语句，INSERTED 表将包含更新后的行，而 DELETED 表将包含更新前的行。
*   对于 DELETE 语句，DELETED 表将包含要删除的行。

这些表的主要用途是在触发触发器时进行更复杂的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T04:59:18.467

全球经济论坛：

> INSERTED 和 DELETED 表，通常称为 MAGIC TABLES，以及 update () 和 columns_updated() 函数可用于确定由 DML 语句引起的更改。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-04T04:56:59.397

*   魔术表只不过是插入和删除，它们是服务器内部创建的临时对象，用于在插入的情况下保存最近插入的值，在删除的情况下保存最近删除的值，在更新值之前或更新值之后保存更新的情况。

*   这两个表，插入和删除，称为魔术表。

# c++ - 如何禁用 QDoubleSpinBox 中的向上/向下按钮

> ID：851190
> 
> 赞同：2
> 
> 时间：2009-05-12T04:51:56.623
> 
> 标签：c++, qt, user-interface

我在 QT 中有一个 QDoubleSpinBox。我想有条件地禁用向上和/或向下按钮。我不知道该怎么做。

我看到在 QAbstractSpinBox 中有一个名为 StepEnabledFlag 的标志。但我不确定如何设置。

任何人都可以帮我解决这个问题。

谢谢阿琼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T17:12:41.700

使用`QAbstractSpinBox::setButtonSymbols()`. 您可以将一个或两个箭头按钮设置为禁用。

文档参考：[http](http://doc.trolltech.com/4.5/qabstractspinbox.html#buttonSymbols-prop) ://doc.trolltech.com/4.5/qabstractspinbox.html#buttonSymbols-prop 。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T12:40:44.747

您需要创建一个 QDoubleSpinBox 子类，其中包含启用步进功能的自定义实现。（[http://doc.qt.digia.com/4.5/qabstractspinbox.html#stepEnabled](http://doc.qt.digia.com/4.5/qabstractspinbox.html#stepEnabled)）

# windows-authentication - 如何让 Vault 使用来自 NAnt 的 Windows 身份验证？

> ID：851203
> 
> 赞同：2
> 
> 时间：2009-05-12T04:57:37.300
> 
> 标签：windows-authentication, nant, integrated-security, sourcegear-vault

我想用 NAnt (V0.86.3317.0) 在 SourceGear Vault (V4.1.4) 中执行一些任务。

有什么方法可以让 Vault 使用 NAnt 的 Windows 身份验证来创建连接？

我用来初始化保险库连接的 NAnt 块是：

```
<target name="InitialiseVaultSettings">
<echo>InitialiseVaultSettings</echo>
<vaultsetloginoptions user="${vault.Username}" password="${vault.Password}" URL="${vault.Host}" repository="${vault.Repository}" />
<vaultsetworkingfolder repositoryFolderPath="${vault.Folder}" diskPath="${vault.WorkingDirectory}" createDiskPath="true" /> 
```

由于我正在与其他开发人员一起开发该项目，因此将用户名和密码硬编码到 NAnt 构建文件中并不是一个好主意。`username`和都是命令`password`中的必需选项。`vaultsetloginoptions`

其他替代品（全部带有渔获物）包括：

(a) 将“管理员”帐户硬编码到 NAnt 属性中并使用该帐户登录保险库。这不是很好，因为我们随后松散了谁负责 NAnt 脚本执行的签入/签出操作的审计跟踪。当解决方案签出文件时，它也会导致问题（部分脚本确保在 Vault 中生成标签之前将所有文件签回源代码管理）。

(b) 使用 NAnt 代码中的 C# 脚本来动态设置用户名和密码的属性...除了我们仍然遇到从用户获取密码的问题

(c) 从 Vault 客户端读取存储的配置文件信息并使用它进行连接（除非我不确定它的存储位置）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-19T16:44:59.263

我对 Vault 不熟悉，所以请原谅这个答案可能含糊不清。我与 NAnt 合作过很多次，任何被执行的东西（任务、执行人员等）都具有在集成身份验证模式下运行的内在潜力。

最后，身份验证会传递给恰好正在运行父 NAnt 进程的任何用户。话虽如此，这可能表明 Vault 的 NAnt 任务不*支持*集成身份验证？这意味着，如果**vaultsetloginoptions**任务*需要*用户和密码参数，那么就没有传递凭据的好方法（正如您所指出的）。

如果碰巧没有*解决*Vault 的 NAnt 任务可能缺少的解决方法，则可以使用[`<exec`>](http://nant.sourceforge.net/release/latest/help/tasks/exec.html)任务调用其客户端工具的命令行版本（甚至不确定是否有）。如果这是一个选项，只要运行 NAnt 进程的用户与需要连接到 Vault 的用户相同，集成身份验证就会自动启动。

对于我们在构建过程中集成的一些东西，我们必须这样做。我们要么执行到命令行版本，要么通过扩展 NAnt 框架编写了我们自己的任务。不管怎样，这应该是可能的。

### 更新

在 Vault 论坛上环顾四周，似乎*AD 集成*只是让 Vault Client 提示用户并将其传递给服务器的一种方式。[来自论坛](http://support2.sourcegear.com/viewtopic.php?f=5&t=8231&p=33617#wrap)：

> Vault 客户端将始终提示输入用户名/密码。我们的 AD 集成仅限于验证输入的密码是否与 Active Directory 中的密码匹配的服务器。

因此，客户端没有*真正*的方式以内置方式传递 Windows 身份验证信息。Vault 客户端程序在 AD 模式下运行时需要输入用户名和密码。可悲的是，如果不存储用户名/密码，*无缝*集成 NAnt 的可能性很小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-14T22:41:13.940

我已经成功地实现了原型来解决这个问题。

下面描述的解决方法的完整源代码和二进制文件可以在这里找到：

[保险柜登录扩展](http://support.sourcegear.com/viewtopic.php?f=5&t=11663&p=50062#p50062)

我创建了一些自定义的 NAnt 任务和功能。

`<VaultLogin>`检查 Windows 注册表中以前存储的用户名和密码信息。如果未找到，则会使用登录窗口提示用户。它将条目存储在两个函数中并清除注册表（以防登录失败 - 见`<SaveVaultLogin>`下文）：

```
${VaultLoginFunctions::UserName()}
${VaultLoginFunctions::Password()} 
```

然后该`<vaultsetloginoptions>`任务可以使用以下功能：

```
<vaultsetloginoptions user="${VaultLoginFunctions::UserName()}" password="${VaultLoginFunctions::Password()}" URL="${vault.Host}" repository="${vault.Repository}" /> 
```

调用`<vaultsetloginoptions>`任务后，我们再调用`<SaveVaultLogin>`将用户名和密码值写回注册表的任务。这可确保仅存储成功的身份验证详细信息（因为如果用户名和密码不正确，脚本将在任务中失败。

这是放在一起的代码块：

```
 <target name="InitialiseVaultSettings">
<echo>InitialiseVaultSettings</echo>

<loadtasks assembly="CompassHealth.NAntExtensions.Tasks.dll" />

<VaultLoginGet />
<echo message="UserName = ${VaultLoginFunctions::UserName()}" />

<vaultsetloginoptions user="${VaultLoginFunctions::UserName()}" password="${VaultLoginFunctions::Password()}" URL="${vault.Host}" repository="${vault.Repository}" />

<vaultsetworkingfolder repositoryFolderPath="${vault.Folder}" diskPath="${vault.WorkingDirectory}" createDiskPath="true" />

<!-- need to save the login here, as it is cleared once VaultLoginGet is called, this ensures that only correct username and password are stored -->
<VaultLoginSave /> 
```

更新：现在在帖子顶部链接到二进制文件和解决方法的源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-31T10:15:40.910

在查看 Scott Saad 的建议后，不幸的是，命令行工具中似乎没有选项可以使用 Windows 身份验证来调用它。

我目前的想法与上面的（b）一致。

我将创建一个可以从 Nant 脚本调用的库，询问当前 Windows 用户的 Vault 用户名和密码。

库将在注册表项中查找先前输入的 Vault 用户名并登录此 Windows 用户。如果存在，它将被传递给脚本而无需任何用户交互。

如果此用户名/密码未能通过 Vault 登录，或者它不存在，则库将提供一个对话框供用户输入当前的 Vault 用户名和密码。

用户的条目将存储在注册表中（加密），这意味着每次更改 Vault 用户名和密码时只需输入一次。

不是一个理想的解决方案，但应该是相对简单的并且是可以接受的足够解决方法。

你怎么看？

# c++ - 对于 QDoubleSpinBox，我可以给一个范围 0.0 我正在使用一个QDoubleSpinBox， 并且在某个时候，我有一个最小值和最大值小于 1 且大于 0 的范围。如果我设置该范围，当我向下按步 问问题 问问题 2009-05-12T05:01:51.690 536 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我正在使用一个QDoubleSpinBox， 并且在某个时候，我有一个最小值和最大值小于 1 且大于 0 的范围。如果我设置该范围，当我向下按步时，微调框中的值会更改为 0.0，而向上将导致 1.0，尽管它们超出范围。我想知道是否有特殊的方法可以避免这个问题。 您可能想尝试使用Boost.Multi_array typedef boost::multi_array<double, 2> Double2d; Double2d x(boost::extents[5000][500]); Double2d y(boost::extents[5000][500]); Double2d z(boost::extents[5000][500]); 实际的大内存块将在堆上分配，并在必要时自动释放。 c++qtuser-interface 4 2 回答 2 This answer is useful 2 正如帕克所说，您需要使用 setSingleStep() 以便您不会增加 1.0。 更重要的是，不支持“独占”范围，即不能给出 0 到 1.0 的范围，除非您也希望能够使用值 0 和 1.0。 相反，一旦你决定了你的步长，你可以像这样设置你的最小值和最大值： minimum = exclusive_minimum + step_size maximum = exclusive_maximum - step_size 然而，这可能是不可取的，因为用户可以通过直接在旋转框中输入来选择步长之间的值。所以更好的解决方案是选择微调框应该精确到多少小数位，并将最小值和最大值设置为最接近 Exclusive_minimum 和 Exclusive_maximum 值的最小和最大数字。 例如，如果 Exclusive_minimum 为 0.0，exclusive_maximum 为 1.0，并且精确到小数点后五位，则将最小值设置为 0.00001，最大值设置为 0.99999。 于 2009-05-14T17:19:27.137 回答 This answer is useful 2 使用 setSingleStep() 将步长设置为适合您的范围的合理值。（http://doc.trolltech.com/4.5/qdoublespinbox.html#singleStep-prop） 于 2009-05-12T12:33:15.377 回答 Related 1 excel - 动态更改工作表标题 1 qt - Qt场景项目组边界矩形没有跟随旋转 2 java - 在地图中存储具有多个值的键 1 forms - 仅当没有其他组件的消息时才显示消息 1 jquery - 复选框的错误放置 1 asp.net-mvc-3 - 下拉列表中的选定值不起作用 3 r - 解析要为 data.frame 读取的 .txt 文件 1 c++ - 从另一个类 c++ 访问 UI 元素 2 function - 函数的返回值 1 ssh - rsync 和权限被拒绝 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：851210
> 
> 赞同：1
> 
> 时间：
> 
> 标签：c++, qt, user-interface

我正在使用一个`QDoubleSpinBox`，

并且在某个时候，我有一个最小值和最大值小于 1 且大于 0 的范围。如果我设置该范围，当我向下按步时，微调框中的值会更改为 0.0，而向上将导致 1.0，尽管它们超出范围。我想知道是否有特殊的方法可以避免这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-14T17:19:27.137

正如帕克所说，您需要使用 setSingleStep() 以便您不会增加 1.0。

更重要的是，不支持“独占”范围，即不能给出 0 到 1.0 的范围，除非您也希望能够使用值 0 和 1.0。

相反，一旦你决定了你的步长，你可以像这样设置你的最小值和最大值：

```
minimum = exclusive_minimum + step_size
maximum = exclusive_maximum - step_size 
```

然而，这*可能*是不可取的，因为用户可以通过直接在旋转框中输入来选择步长之间的值。所以更好的解决方案是选择微调框应该精确到多少小数位，并将最小值和最大值设置为最接近 Exclusive_minimum 和 Exclusive_maximum 值的最小和最大数字。

例如，如果 Exclusive_minimum 为 0.0，exclusive_maximum 为 1.0，并且精确到小数点后五位，则将最小值设置为 0.00001，最大值设置为 0.99999。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T12:33:15.377

使用 setSingleStep() 将步长设置为适合您的范围的合理值。（[http://doc.trolltech.com/4.5/qdoublespinbox.html#singleStep-prop](http://doc.trolltech.com/4.5/qdoublespinbox.html#singleStep-prop)）

# lucene - 有没有推荐的 IndexSearcher 方法？

> ID：851219
> 
> 赞同：1
> 
> 时间：2009-05-12T05:04:31.983
> 
> 标签：lucene, lucene.net

我在基于 Web 的应用程序中使用 Lucene 搜索 API。Lucene 的 IndexSearcher 类的哪个方法推荐使用？有没有比其他方法更快的方法？

1.IndexSearcher(目录目录) 2.IndexSearcher(IndexReader r) 3.IndexSearcher(字符串路径)

谢谢阅读。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T05:55:25.957

内部接受目录和索引路径的构造函数使用接受 IndexReader 的构造函数。因此，没有一个比其他的性能优势。请记住，如果您使用 IndexReader 创建搜索器，则必须在关闭搜索器后显式关闭阅读器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T13:27:28.160

一切都是为了方便。

如果您只想创建一个`IndexSearcher`，请使用接受路径的那个。

如果您已经有一个`Directory`对象，请使用接受 a的对象`Directory`。

如果你有一个`IndexReader`......你明白了。请记住，如果您提供了`IndexReader`，则需要在关闭 后自己关闭它`IndexSearcher`。

[我强烈建议获取 Lucene源代码](https://svn.apache.org/repos/asf/incubator/lucene.net//trunk/)的副本。它的可读性很强，可以回答很多这样的问题。

# c# - 如何按字母顺序遍历哈希表的键？

> ID：851220
> 
> 赞同：2
> 
> 时间：2009-05-12T05:04:33.467
> 
> 标签：c#, key, hashtable, traversal

按字母升序遍历哈希表键的最简单方法是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-12T05:06:59.890

这在很大程度上取决于密钥的类型。但是让我们假设它们是字符串。您可以使用以下 LINQ 查询

```
Hashtable table = GetHashTable();
var keys = table.Keys.Cast<String>().OrderBy(x => x); 
```

对于更复杂的结构，LINQ 查询仅略有不同。假设您对键有以下定义

```
struct Name {
  public string First;
  public string Last;
  // Equality code omitted
} 
```

LINQ 代码如下

```
Hashtable table = GetHashtable();
var keys = table.Keys.Cast<Name>().OrderBy(x => x.First).ThenBy(x => x.Last); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-05-12T07:44:09.600

好吧，我发现这个片段最适合我的情况：

```
哈希表设置 = GetSettings();
ArrayList 键 = 新 ArrayList();
键.AddRange(settings.Keys);
键.排序（）；
foreach（键中的对象键）
{
    // 这里的逻辑
}

```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T05:16:55.647

如果您想要一张保持其键自然顺序的地图，我建议您不要使用`Hashtable`开始。如果您仍在使用 1.1，请使用[`System.Collections.SortedList`](http://msdn.microsoft.com/en-us/library/System.Collections.SortedList.aspx). 如果您使用的是 2.0 或更高版本，请使用[`SortedList<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/ms132319.aspx)或[`SortedDictionary<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)。后两者在 API 方面*基本*相同，但具有不同的性能特征 - 有关更多信息，请参阅文档。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T05:07:07.190

这并不是哈希表的真正设计目的（它们被设计成具有统一的键分布）。使用排序树？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T11:48:33.837

使用 SortedList 可能会稍微快一些 -

```
SortedList settings = new SortedList(GetSettings());
foreach (object key in settings.Keys)
{
    //logic
} 
```

创建和排序ArrayList是O（n）+ O（nlog n）= O（nlog n），而SortedList构造函数（根据文档）是O（n），所以直接使用SortedList会更快比使用数组列表和显式排序

# ruby-on-rails - 在 Rails 中使用回形针设置原始图像的路径？

> ID：851226
> 
> 赞同：8
> 
> 时间：2009-05-12T05:07:19.547
> 
> 标签：ruby-on-rails, ruby, paperclip

## 情况

我有一个简单的模型，带有一个使用回形针的附加图像，它有几个经过处理的样式（缩略图、完整、功能）。此时它可以正常工作，并为 中的每个对象创建一个目录结构`/public/assets/foo/`，其中包含原始、缩略图、完整和功能的子目录。

## 问题

我不希望将原始（高分辨率）图像暴露给用户获取。所以我希望有一种方法可以指定不同的路径来将原件存储在`/public/`. 理想情况下，回形针应该仍然能够使用原始图像作为源重新处理样式，就像它目前所做的那样。

对于使外部用户无法访问原件的替代建议，我也持开放态度。这里最实用的解决方案是什么。谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-12T13:23:39.430

我建议使用自定义插值，将您的原始文件放在公共目录之外。像这样的东西：

```
 Paperclip.interpolates :maybe_public do |attachment, style|
  style == :original ? "private" : "public"
end

has_attached_file :image, :path => ":rails_root/:maybe_public/:attachment..." 
```

这会将您的 :original 文件保存在不可公开访问的目录中以进行保护，但仍允许 Paperclip 访问。它会将您的缩略图保存在公共目录中以进行标准访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T07:18:32.327

如果可以接受，您可以通过设置默认样式跳过保存原件。

```
 has_attached_file :image,
                    :styles => { :normal => "800x600>" },
                    :default_style => :normal 
```

如果没有，并且您想保留原件，如果您使用的是 apache，则可以使用 .htaccess 文件来限制对 originals 目录的访问

```
<FilesMatch "^\.(jpe?g|gif|png)$">
   Order allow,deny
   Deny from all
</Files> 
```

# sql - WHERE 子句查找特定月份的所有记录

> ID：851236
> 
> 赞同：103
> 
> 时间：2009-05-12T05:15:45.820
> 
> 标签：sql, sql-server-2008

我希望能够为存储过程提供月份和年份，并让它返回该月份发生的所有事情，我该怎么做，因为我无法比较某些月份的天数等？

最好的方法是什么？我可以要求根据年份和月份进行比较吗？

谢谢。

* * *

## 回答 #1

> 赞同：223
> 
> 时间：2009-05-12T05:24:28.800

我认为您正在寻找的功能是[`MONTH(date)`](http://msdn.microsoft.com/en-us/library/ms187813.aspx). 您可能也想使用 [“YEAR”](http://msdn.microsoft.com/en-us/library/ms187813.aspx)。

假设您有一个名为的表`things`，如下所示：

```
id happend_at
-- ----------------
1  2009-01-01 12:08
2  2009-02-01 12:00
3  2009-01-12 09:40
4  2009-01-29 17:55 
```

假设您要执行以查找`happened_at`在 2009/01（2009 年 1 月）期间具有 a 的所有记录。SQL 查询将是：

```
SELECT id FROM things 
   WHERE MONTH(happened_at) = 1 AND YEAR(happened_at) = 2009 
```

哪个会返回：

```
id
---
1
3
4 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-12T07:00:47.317

使用大多数响应中建议的 MONTH 和 YEAR 函数的缺点是 SQL Server 将无法使用您的日期列上可能存在的任何索引。这可能会影响大型表的性能。

我倾向于将 DATETIME 值（例如 @StartDate）传递给代表您感兴趣的月份的第一天的存储过程。

然后你可以使用

```
SELECT ... FROM ...
WHERE DateColumn >= @StartDate 
AND DateColumn < DATEADD(month, 1, @StartDate) 
```

如果您必须将月份和年份作为单独的参数传递给存储过程，则可以使用 CAST 和 CONVERT 生成表示该月第一天的 DATETIME，然后按上述方式进行操作。如果你这样做，我建议编写一个从整数年、月、日值生成 DATETIME 的函数，例如[SQL Server 博客](http://weblogs.sqlteam.com/jeffs/archive/2007/01/02/56079.aspx)中的以下内容。

```
create function Date(@Year int, @Month int, @Day int)
returns datetime
as
    begin
    return dateadd(month,((@Year-1900)*12)+@Month-1,@Day-1)
    end
go 
```

然后查询变为：

```
SELECT ... FROM ...
WHERE DateColumn >= Date(@Year,@Month,1)
AND DateColumn < DATEADD(month, 1, Date(@Year,@Month,1)) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-25T17:56:18.333

更多关于oracle db的提示非常简单。你也可以使用[to_char](http://www.techonthenet.com/oracle/functions/to_char.php)函数，看：

月份：

> **to_char** (happened_at , 'MM') = 01

年份：

> **to_char** (happened_at , 'YYYY') = 2009

对于一天：

> **to_char** (happened_at , 'DD') = 01

*to_char*函数由 sql 语言支持，而不是由一个特定的数据库支持。

我希望能帮助任何人更多...

腹肌！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-05-12T06:43:53.583

作为 MONTH 和 YEAR 函数的替代方案，常规 WHERE 子句也可以使用：

```
select *
from yourtable
where '2009-01-01' <= datecolumn and datecolumn < '2009-02-01' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T05:22:43.700

如果您使用的是 SQL Server，请查看 DATEPART。

[http://msdn.microsoft.com/en-us/library/ms174420(SQL.90).aspx](http://msdn.microsoft.com/en-us/library/ms174420(SQL.90).aspx)

日期部分（毫米，[您正在查看的日期]）

然后，您可以使用普通整数逻辑。年份相同，只需使用 yy 而不是 mm。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T05:24:19.330

> 我可以要求根据年份和月份进行比较吗？

你可以。这是一个使用 AdventureWorks 示例数据库的简单示例...

```
DECLARE @Year       INT
DECLARE @Month      INT

SET @Year = 2002
SET @Month = 6

SELECT 
    [pch].* 
FROM 
    [Production].[ProductCostHistory]   pch
WHERE
    YEAR([pch].[ModifiedDate]) = @Year
AND MONTH([pch].[ModifiedDate]) = @Month 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T09:53:43.213

我发现将值作为时间数据类型（例如`DATETIME`）传递更容易，然后使用时间功能，特别是`DATEADD`和`DATEPART`，来查找该期间的开始和结束日期，在这种情况下是月份，例如这可以找到开始日期和结束日期对对于当前月份，只需替换`CURRENT_TIMESTAMP`您的类型参数`DATETIME`（注意 1990-01-01 值完全是任意的）：

```
SELECT DATEADD(M, 
          DATEDIFF(M, '1990-01-01T00:00:00.000', CURRENT_TIMESTAMP), 
          '1990-01-01T00:00:00.000'), 
       DATEADD(M, 
          DATEDIFF(M, '1990-01-01T00:00:00.000', CURRENT_TIMESTAMP), 
          '1990-01-31T23:59:59.997') 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T05:27:28.967

这样的事情应该这样做：

```
select * from yourtable where datepart(month,field) = @month and datepart(year,field) = @year 
```

或者，您可以在创建记录时将月份和年份分成各自的列，然后对其进行选择。

伊恩

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T05:31:25.747

一种方法是创建一个代表当月第一天的变量（即 2009 年 5 月 1 日），将其传递到 proc 或构建它（连接月/1/年）。然后使用 DateDiff 函数。

```
WHERE DateDiff(m,@Date,DateField) = 0 
```

这将返回具有匹配月份和年份的任何内容。

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2015-08-05T17:55:15.207

```
SELECT * FROM yourtable WHERE yourtimestampfield LIKE 'AAAA-MM%'; 
```

`AAAA`你想要的年份和`MM`月份在哪里

# c# - C# 反射：在解决方案中获取 *所有* 活动程序集？

> ID：851248
> 
> 赞同：37
> 
> 时间：2009-05-12T05:23:05.993
> 
> 标签：c#, reflection

这是我的问题：

我有 2 个项目 - 一个“通用”项目，其行为类似于具有各种支持代码的库，以及在许多调用中使用所述项目的实际程序。我们将这些项目称为“Common”和“Program”。他们都在同一个解决方案中。

在“Common”中，我有一个用于常见反射任务的类，例如创建实例。如果我调用 GetExecutingAssembly，它会获得所有“通用”类型，但是当我使用 GetEntryAssembly 时，我会获得“程序”类型。

虽然我当然可以编辑代码以使用 2 组 asm，但我担心解决方案中不仅有 2 个项目 - 让我们说 5（不知道为什么，但让我们去那里现在），而且我担心调用 GetExecutingAssembly 和 GetEntryAssembly 不会得到整个程序中的所有 Types。

我还能做些什么来获得*解决方案*中的所有类型吗？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2009-05-12T05:35:56.177

```
Assembly[] assemblies = AppDomain.CurrentDomain.GetAssemblies(); 
```

这将获取当前 AppDomain 中所有已加载的程序集。

如评论中所述，可以生成多个 AppDomain，在这种情况下，每个 AppDomain 都可以拥有自己的程序集。这样做的直接好处是您可以通过卸载包含的 AppDomain 来卸载程序集。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2012-04-20T21:14:45.613

这是一个*非常*古老的问题，但为了将来参考，这里有一个完整的实现：

```
 public static IEnumerable<Assembly> GetAssemblies()
    {
        var list = new List<string>();
        var stack = new Stack<Assembly>();

        stack.Push(Assembly.GetEntryAssembly());

        do
        {
            var asm = stack.Pop();

            yield return asm;

            foreach (var reference in asm.GetReferencedAssemblies())
                if (!list.Contains(reference.FullName))
                {
                    stack.Push(Assembly.Load(reference));
                    list.Add(reference.FullName);
                }

        }
        while (stack.Count > 0);

    } 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-12T05:38:30.273

[GetReferencedAssemblies](http://msdn.microsoft.com/en-us/library/system.reflection.assembly.getreferencedassemblies.aspx)如何处理 AssemblyRef 元数据条目？“解决方案”不是 CLR 知道或关心的。它处理组件。

```
private static List<Assembly> GetListOfEntryAssemblyWithReferences()
{
  List<Assembly> listOfAssemblies = new List<Assembly>();
  var mainAsm = Assembly.GetEntryAssembly();
  listOfAssemblies.Add(mainAsm);

  foreach (var refAsmName in mainAsm.GetReferencedAssemblies())
  {
    listOfAssemblies.Add(Assembly.Load(refAsmName));
  }
  return listOfAssemblies;
} 
```

注意事项：

1.  您仍然需要过滤核心组件 System.*
2.  这只是在 ref 链中深入一层，但可以递归地完成 - 使用更多代码。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-05-12T05:57:23.007

另外：有些程序集不会立即加载，因此您还应该在 AppDomain 的程序集加载事件上放置一个事件处理程序。

```
AppDomain.CurrentDomain.AssemblyLoad += .... 
```

# iphone - 苹果手机开发

> ID：851249
> 
> 赞同：0
> 
> 时间：2009-05-12T05:23:42.250
> 
> 标签：iphone, objective-c, nsxmlparser

我还是objective-c的新手。我想在 iphone 上创建一个应用程序，在其中我使用 NSXMLParser 从 XML 获取数据。所以当我启动应用程序时，它将读取 XML 和数据来自它，但是在运行应用程序之间，如果 XML 被更新，那么我的应用程序如何知道它并获取刷新数据？请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T05:49:08.167

似乎您的应用程序将受益于在 3.0 操作系统中使用新的[推送通知API。](http://developer.apple.com/iphone/program/sdk/apns.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T06:44:11.667

只需寻找推送通知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T06:25:20.090

没有魔法。您的应用程序必须轮询，或者您可以保持连接打开并在数据更改时从服务器发送指示。

Apple 推送通知可能会也可能不会这样做，但无论哪种方式，您现在最简单的方法就是轮询您的服务器。

# svn - 为所有代码和内容备份 SVN 服务器的最佳方法是什么？

> ID：851263
> 
> 赞同：2
> 
> 时间：2009-05-12T05:29:45.313
> 
> 标签：svn, backup, visualsvn

有没有一种好方法可以备份 SVN 服务器上的所有代码和内容？因为如果那个硬盘死了，那么所有的工作都会丢失。

我认为如果我们使用多台计算机定期对其进行 SVN 更新，大多数文件都存在于这些计算机上，因此代码不会丢失更安全。

我也在考虑编写一个脚本来复制`c:\repositories`到`w:\`，这是一个 2TB 的外部硬盘驱动器，白天大部分时间都是空闲的。复制过程可以由 cron 或 windows 调度程序每晚运行...但是复制所有内容会不会过大？一天中可能有十几个文件被更改，总共有 0.5MB，复制整个存储库可能涉及 50MB 或更多。如果我在该 cron 作业运行时进行 SVN 签入怎么办。这些文件不会处于不一致的状态吗？

或者将存储库放在什么位置`c:\`以便 SVN 更新速度快（`w:`如果空闲时间过长，驱动器需要时间唤醒），然后只需在下面创建一个项目`w:\`并签出所有文件`w:\all_code`，它将 SVN 更新到整个存储库，然后运行 ​​cron 作业到 SVN 更新`w:\`以每晚同步到存储库，以便所有文件的额外副本都在`w:`?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T05:38:27.013

您有多种选择：

*   svnadmin 热拷贝：http: [//svnbook.red-bean.com/en/1.2/svn.ref.svnadmin.c.hotcopy.html](http://svnbook.red-bean.com/en/1.2/svn.ref.svnadmin.c.hotcopy.html)

*   svnadmin 转储和 svnadmin 加载：[http ://svnbook.red-bean.com/en/1.2/svn.ref.svnadmin.c.dump.html](http://svnbook.red-bean.com/en/1.2/svn.ref.svnadmin.c.dump.html)

*   svnsync 创建存储库的只读镜像：http: [//svn.collab.net/repos/svn/trunk/notes/svnsync.txt](http://svn.collab.net/repos/svn/trunk/notes/svnsync.txt)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T05:33:51.717

查看

```
svnadmin dump 
```

命令。[http://svnbook.red-bean.com/en/1.1/re31.html](http://svnbook.red-bean.com/en/1.1/re31.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T05:34:40.810

在谷歌找到这个：

[http://justinram.wordpress.com/2006/05/03/subversion-server-windows-backup/](http://justinram.wordpress.com/2006/05/03/subversion-server-windows-backup/)

大多数命中都是针对 Linux 的，但那是针对 Windows 的特定答案。确保您注意有关用户已签出文件/更改文件的部分。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T05:41:41.550

[获取hot-backup.py](http://svn.apache.org/repos/asf/subversion/trunk/tools/backup/hot-backup.py.in)的副本。

然后新建一个Sheduled Task，每晚执行python脚本。

这是我传递给脚本的示例：

```
"C:\Program Files\Python25\python.exe" D:\SvnBackupUtil\hot-backup.py --archive-type=zip --num-backups=30 C:\Repositories\svn_root \\core-ad01l\backup\ 
```

此示例将存储库的 zip 备份创建到`\\core-ad01l\backup\`并保留最多 30 个备份。

您需要安装 python 来运行脚本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-03T15:45:33.140

如果您在 Linux 服务器上，则每周或每小时创建存储库快照。

或者

你可以去

> svnadmin 转储或 svnadmin 热拷贝

创建它的zip之后。

# java - 无法从其他应用程序访问 udp 客户端

> ID：851266
> 
> 赞同：3
> 
> 时间：2009-05-12T05:30:45.107
> 
> 标签：java, network-programming, udp

我正在尝试使用 UDP 在 Java 中实现客户端服务器应用程序。问题是当客户端连接到服务器时，服务器注册客户端并且另一个应用程序尝试使用 clientIP 和 clientPort 连接到客户端；客户端无法获取任何数据。

我能够重新创建 DatagramSocket 以使用他的 IP 和端口连接到客户端，但是当这由不同的应用程序完成时，无法实现通信。

我想提一下我在服务器上监听客户端的端口与服务器应用程序正在使用的端口不同。

我们如何才能实现这种沟通？

请帮我。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-06-17T09:08:18.837

您的评论“当客户端连接到服务器时..”让我想知道您是否在客户端的 DatagramSocket 上使用了 connect()。如果是这样，请不要在套接字上调用 connect()。UDP 是无连接协议，不需要 connect()。通过在 UDP 套接字上调用 connect()，套接字只能向/从使用 connect() 指定的主机发送/接收数据。

如果不是这种情况，那么我能想到的唯一原因是您的客户端计算机可能启用了某些防火墙，或者您的客户端与服务器或其他主机之间存在 NAT/防火墙。使用 Wireshark 检查您的客户端是否正在接收来自其他应用程序的任何数据包。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-31T07:52:27.273

我可能错过了重点，但我认为为了让您的客户端能够接受在您的服务器上运行的其他应用程序的连接尝试，您需要在客户端中实现一些监听模块（接受传入连接的类似服务器的部分）。你可以在这里找到一些有用的例子：[http ://www.java2s.com/Code/Java/Network-Protocol/UDP.htm](http://www.java2s.com/Code/Java/Network-Protocol/UDP.htm)

# vba - Outlook：如何使用 VBA 将所选邮件发布到 Web 服务器？

> ID：851269
> 
> 赞同：2
> 
> 时间：2009-05-12T05:31:04.547
> 
> 标签：vba, http, outlook

目标：在 Outlook 工具栏中有一个按钮，当按下该按钮时，将整个当前消息（可能作为 .msg 文件）通过 post 发送到 URL。在此过程中必须打开某种浏览器窗口，以便用户可以在 URL 处输入应用程序的登录详细信息（除非我能以某种方式解决这个问题，想法？）。

我已经创建了一个 VBA 宏，并在 Outlook 2007 中为其放置了一个按钮（尽管至少在 Outlook 2003 中我也需要它才能工作）。

我已经阅读了有关 VBA FollowHyperlink 方法的信息，但我无法让小 VBA 宏 IDE 识别它（Application.FollowHyperlink 和其他几个尝试给出了错误）。

（我是 VBA 的新手 .Net 程序员，所以如果在 VB.NET 或 C# 中有更简单的方法，一定要指出我正确的方向）。

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T07:00:14.620

这是我认为它应该如何工作的大纲。

*   对于通信，使用`"WinHttp.WinHttpRequest.5"`COM 对象（调查`FollowHyperlink()`将毫无意义）。这个对象可以做任何你能想到的 HTTP 请求。在 Outlook VBA 项目中引用它以获取 Intellisense 和早期绑定。
*   对于用户名和密码，创建一个带有两个文本框的小型自定义表单。您甚至可以使用该表单来缓存用户名和密码（当表单不可见时调用“隐藏” - 所有表单级别的变量都将被保留，以便您可以再次使用它们）。
*   为了准备有效负载，请使用此方法 ( [KB240935](http://support.microsoft.com/kb/240935) ) 获取当前选定的项目，检查其类型 ( `If TypeOf currentItem Is MailItem Then ...`)，然后调用`SaveAs()`以将其保存为 .msg 在临时文件夹中。将其附加到您准备好的 POST 请求中，您就可以开始了。
*   对于用户界面，在自定义中放置一个按钮`CommandBar`（您甚至可以在应用程序启动时以编程方式创建一个）。将按钮链接到`Public Sub`普通 VBA 模块中的 a。在此`Sub`，确定您是否需要`Show()`自定义用户名/密码对话框，或者是否存在缓存凭据，并进行必要的 HTTP 请求处理。

祝你好运！它不应该太复杂。

# hibernate - Hibernate IllegalArgumentException

> ID：851274
> 
> 赞同：0
> 
> 时间：2009-05-12T05:31:42.080
> 
> 标签：hibernate, jpa

我得到一个 java.lang.IllegalArgumentException：未知实体：path.to.MyEntity。我已使用以下命令在 persistence.xml 中明确指定了提供程序：

```
<persistence-unit ...>
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
</persistence-unit> 
```

并且 MyEntity 被适当地注释。异常跟踪的休眠部分：...

```
at org.hibernate.ejb.AbstractEntityManagerImpl.find(AbstractEntityManagerImpl.java:186) 
```

...我会错过什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T08:42:54.903

这是一个类路径问题。我必须将 META-INF 文件夹（其中保留 persistence.xml）放在根类路径中。

# lucene - 重用索引搜索器

> ID：851277
> 
> 赞同：1
> 
> 时间：2009-05-12T05:32:53.670
> 
> 标签：lucene, lucene.net

我在基于 Web 的应用程序中使用 Lucene，并希望对所有传入请求重用 Indexsearcher 的相同实例。

这个逻辑（使用 C#）有意义吗？请提出建议。

```
DateTime lastWriteTime = System.IO.Directory.GetLastWriteTime(myIndexFolderPath);

if (HttpRuntime.Cache["myIndexSearcher"] == null) //Cache is empty

{
    searcher = new IndexSearcher(myIndexFolderPath);
    HttpRuntime.Cache.Insert("myIndexSearcher", searcher);
    HttpRuntime.Cache.Insert("myIndexTimeStamp", lastWriteTime);
}
else //Cache is not empty
{
    DateTime cachedDateTime = (DateTime)HttpRuntime.Cache["myIndexTimeStamp"];
    if (cachedDateTime == lastWriteTime)//Cache is not yet stale
    {
        searcher = (IndexSearcher)HttpRuntime.Cache["myIndexSearcher"]; 
    }
    else
    {
        searcher = new IndexSearcher(myIndexFolderPath); //index folder is modified...update searcher
        HttpRuntime.Cache.Insert("myIndexSearcher", searcher);
        HttpRuntime.Cache.Insert("myIndexTimeStamp", lastWriteTime); 
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T18:11:53.943

您需要同步创建 Searcher 以避免竞争条件。另外，我不确定通过 == 运算符比较 DateTime 对象是否是正确的方法。不过，我不是 C# 专家。通过组合条件 1 和条件 3，可以在一处创建搜索器。

# c++ - 如何使用movntdqa避免缓存污染？

> ID：851286
> 
> 赞同：13
> 
> 时间：2009-05-12T05:34:43.213
> 
> 标签：c++, assembly, memcpy

我正在尝试编写一个不会将源内存加载到 cpu 缓存的 memcpy 函数。目的是避免缓存污染。下面的 memcpy 函数可以工作，但会像标准 memcpy 一样污染缓存。我正在使用 P8700 proccesoor 和 Visual C++ 2008 express。我看到了英特尔 vtune 的 cpu 缓存使用情况。

```
void memcpy(char *dst,char*src,unsigned size){
    char *dst_end=dst+size;
    while(dst!=dst_end){
        __m128i res = _mm_stream_load_si128((__m128i *)src);
        *((__m128i *)dst)=res;
        src+=16;
        dst+=16;
    }
} 
```

我有另一个版本，具有相同的结果 - 工作但污染缓存。

```
void memcpy(char *dst,char*src,unsigned size){

        char *dst_end = dst+size;

        __asm{
        mov edi, dst 
        mov edx, dst_end 
        mov esi,src
        inner_start: 
        LFENCE 
      MOVNTDQA xmm0,    [esi ]
      MOVNTDQA xmm1, [esi+16] 
      MOVNTDQA xmm2, [esi+32] 
      MOVNTDQA xmm3, [esi+48] 
      //19\. ; Copy data to buffer 
      MOVDQA [edi], xmm0 
      MOVDQA  [edi+16], xmm1 
      MOVDQA  [edi+32], xmm2 
      MOVDQA  [edi+48], xmm3 
    //  25\. ; Increment pointers by cache line size and test for end of loop 
      add esi, 040h 
      add edi, 040h 
      cmp edi, edx 
      jne inner_start 

}
} 
```

更新：这是测试程序

```
 void test(int table_size,int num_iter,int item_size){
            char *src_table=alloc_aligned(table_size*item_size);//return value is aligned on 64 bytes
            char *dst=alloc_aligned(item_size); //destination is always the same buffer
            for (int i=0;i<num_iter;i++){
                int location=my_rand()%table_size;
                char *src=src_table+location*item_size;//selecting a different src every time
                memcpy(dst,src,item_size);
            }

        }
main(){
       test(1024*32,1024*1024,1024*32)
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-12T21:56:00.147

引用[英特尔](http://software.intel.com/en-us/articles/increasing-memory-throughput-with-intel-streaming-simd-extensions-4-intel-sse4-streaming-load)：

> “流式加载指令旨在加速来自 USWC 内存类型的数据传输。对于其他内存类型，例如可缓存 (WB) 或不可缓存 (UC)，该指令的行为类似于典型的 16 字节 MOVDQA 加载指令。但是，未来的处理器可以使用其他内存类型（如 WB）的流式加载指令作为提示，即应将预期的缓存行从内存直接流式传输到内核，同时最大限度地减少缓存污染。”

这就解释了为什么代码不起作用——内存是 WB 类型的。

# windows - MS RPC 中的 SRV 是什么，我应该知道什么？

> ID：851294
> 
> 赞同：0
> 
> 时间：2009-05-12T05:38:42.833
> 
> 标签：windows, rpc

[这篇](http://msdn.microsoft.com/en-us/library/aa373954%28VS.85%29.aspx)关于接口注册标志的 MSDN 文章在描述`RPC_IF_ALLOW_LOCAL_ONLY`标志时谈到了一些名为*SRV*的实体：

...注册此接口标志后，RPC 运行时拒绝远程客户端进行的调用。... RPC 仅在调用不是来自**SRV**时才允许 ncacn_NP 调用...

我已经浏览了[RFC 2782](http://www.ietf.org/rfc/rfc2782.txt)，但仍然不明白。首先什么是 SRV，我如何判断呼叫是来自它还是其他方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T05:54:30.187

SRV.SYS 是 SMB 服务器驱动程序。这篇文章的意思是允许命名管道请求，除非它们来自该驱动程序（即，除非它们来自本地机器以外的其他地方）。

这是有道理的，因为您正在注册您的服务器以仅接受本地连接。您不希望命名管道连接通过网络潜入。

[本页](http://msdn.microsoft.com/en-us/library/cc243786(PROT.10).aspx)详细介绍了通过 SMB 使用命名管道。

# solaris - solaris 上 pmap 中的高 sys cpu 和高 ithr

> ID：851295
> 
> 赞同：0
> 
> 时间：2009-05-12T05:39:04.797
> 
> 标签：solaris

我有一个在 solaris 上运行的 mysql 数据库，从 mpstat，我可以看到一个线程具有非常高的 ithr 和高 sys cpu。我怎样才能找到ithr来自哪里以及为什么sys cpu相对较高？

CPU minf mjf xcal intr itr csw icsw migr smtx srw syscl usr sys wt idl

0 0 0 0 440 146 269 1 17 52 0 833 0 1 0 99 .................................... .....................................

7 0 0 0 19798 19738 914 22 4 242 0 3569 5 14 0 81 .................................... ...................................................

15 0 0 0 1005 0 2035 2 0 52 0 8912 12 3 0 85

CPU minf mjf xcal intr itr csw icsw migr smtx srw syscl usr sys wt idl

0 0 0 0 632 143 678 1 26 46 0 2243 4 2 0 94 .................................... ...................................................

7 0 0 0 21068 20978 1409 27 9 276 0 5591 9 15 0 76

..................................................... …………………………………………………………………………

15 0 0 0 531 0 1071 2 2 45 0 4707 7 2 0 91

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2010-02-03T20:04:52.833

这可能是 NIC 的中断开销。mpstat 将在 ithr 中显示 CPU 处理任何 NIC 或 HBA 的高值，以及相应的高系统时间。如果您有 Solaris 10，则 intrstat 将准确显示每个 CPU 处理硬件中断所花费的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T17:29:20.707

Sun Studio 工具包括一个性能分析器，旨在利用 Solaris 中的所有最新功能。您可以尝试使用它来收集 mysql 服务器上的数据。我们正在接近下一个正式版本，但您可以使用最近的“快速”版本来查看最新功能。它不是开源的，但可以免费使用。[http://developers.sun.com/sunstudio/downloads/express/index.jsp](http://developers.sun.com/sunstudio/downloads/express/index.jsp)

# java - 如何理解 Java 热点错误

> ID：851298
> 
> 赞同：8
> 
> 时间：2009-05-12T05:40:13.687
> 
> 标签：java, jvm, crash, jvm-hotspot

伙计们，当 JVM 崩溃时，它会写入错误日志 hs_err_pid.log。我想找出导致 JVM 崩溃的原因？如何理解这些日志，是否在任何地方记录了该日志的排列方式。我试图在网上搜索但无济于事:-(

指出相关的 URL 将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T06:09:01.643

除非您调用本机代码 (JNI)，否则代码中的任何内容都不会导致 JVM 崩溃；因此，该日志文件中的堆栈跟踪信息可能对大多数开发人员没有多大用处。这可能就是为什么它可能没有被记录（至少在外部）。因此，最好的办法可能是按照错误消息的建议提交错误报告。

但是，如果你真的想了解它，[Kohsuke 的博客](https://community.oracle.com/blogs/kohsuke/2009/02/19/crash-course-jvm-crash-analysis)有货。照常。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T06:26:48.200

首先，寻找看起来像“ntdll.dll+0x2000”的最上面一行。

如果热点出现在*您的*本机代码中（即 DLL 是您的代码之一），那么请了解如何说服您的编译器生成从 DLL 偏移量到行号的映射列表。显然，这可能意味着您需要使用新编译的 DLL 重新运行并等待问题再次出现。

否则，请查看搜索该特定行是否会在 Google 中显示某些内容，请记住，相同的错误可能意味着很多事情。并查看 DLL 名称是否看起来是可识别的，例如打印机驱动程序名称、图形驱动程序或您可以追踪到特定调用的其他组件。无论该组件是什么，您都可以将其升级到固定版本，或者避免进行有问题的调用。如果您不确定该组件是什么，它可能只是您需要升级的“JVM”——至少升级到您使用的任何版本的最新更新/次要版本可能是个好主意。

在过去，我还看到 JIT 编译器中的错误可以通过告诉它不要尝试编译有问题的特定方法来临时解决——我模糊地记得，在这些情况下，热点错误提供了一些线索它是哪种方法（可能只是 Java 堆栈的转储），但我没有示例可以回忆细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T08:46:59.093

这非常有用：[http ://weblogs.java.net/blog/kohsuke/archive/2009/02/crash_course_on.html](http://weblogs.java.net/blog/kohsuke/archive/2009/02/crash_course_on.html)

好的，第一个回答者已经提到了这个网址，没关系

# sql-server - SQLSERVER2005中维护计划有什么用

> ID：851300
> 
> 赞同：0
> 
> 时间：2009-05-12T05:40:39.240
> 
> 标签：sql-server, sql-server-2005, maintenance

sqlserver维护计划有什么需求和用途，如何配置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T05:53:52.870

谷歌解释一切：[http ://www.sql-server-performance.com/articles/dba/creating_backup_jobs_p1.aspx](http://www.sql-server-performance.com/articles/dba/creating_backup_jobs_p1.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T05:50:24.747

它们使创建计划备份、重新索引和其他维护任务变得更加容易。它是一个简单的向导，询问您要做什么、访问哪些数据库以及多久执行一次。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T05:54:41.497

## [维护计划](http://msdn.microsoft.com/en-us/library/ms187658.aspx)

> 维护计划创建了一个工作流，以确保您的数据库得到优化、定期备份并且没有不一致。这些维护任务可以手动运行，也可以按计划的时间间隔自动运行。-- 来源：MSDN

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T08:01:05.860

简而言之，维护计划是使用 SQL Server Integrations Services (SSIS) 组件自动执行特定 SQL Server 管理任务的基本工具。

典型的使用场景包括：

*   索引优化
*   数据库备份
*   作业历史清理

他们还处理辅助组件的创建，例如作业和时间表。

如果您有一个直接或简单的数据库平台，那么维护计划通常可以满足您的所有需求。更复杂环境的数据库管理员 (DBA) 通常更愿意为这些场景实施他们自己的定制解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T06:46:29.650

维护计划为您提供本机工具，使您的 SQL Server 保持正常运行。您可以通过维护计划安排诸如索引维护、数据库备份等任务（另请参见 SQL Server 代理）。查看 StackOverflow 的孪生站点 ServerFault，了解相关问题。我见过 ServerFault 的专家对类似的查询做出响应。查看[http://sqlserverpedia.com/](http://sqlserverpedia.com/)您可以在该站点中找到有用的信息。;-)

# asp.net-mvc - 选择实体不会子选择关联实体

> ID：851314
> 
> 赞同：1
> 
> 时间：2009-05-12T05:53:19.720
> 
> 标签：asp.net-mvc, linq, entity-framework, linq-to-entities

我正在学习 ASP.NET MVC（和一般的 MVC），我发现的所有在线帮助仅演示了使用单个表，而不是多个表之间的关系。我正在运行一个我期望也应该返回关联实体的查询，但它不是也无法弄清楚我缺少什么。我感谢您的帮助！

我有以下数据：

```
Ticket
   TicketID  CompanyID  Subject  ...
   --------  ---------  -------
   1         1          "stuff"
   2         1          "things"

Company
   CompanyID  Name      ...
   ---------  --------
   1          "FredCo" 
```

因此，每张票都与特定的公司相关联。我正在尝试为工单创建详细信息视图，并且我想显示公司名称。这是我目前设置的。

**模型**

一个`Ticket`实体和一个`Company`实体，它们之间有一个关联，称为关联`CompanyTicket`。导航属性是 Ticket.Company 和 Company.Tickets。

在关联的映射详细信息中，我有：

```
Maps to Ticket
    Company.CompanyID <-> CompanyID
    Ticket.TicketID   <-> TicketID 
```

**控制器**

我的 TicketController.Details 方法如下所示：

```
public ActionResult Details( int id )
{
    var tickettoview = ( from m in _db.Ticket
                         where m.TicketID == id
                         select m ).First();
    return View( tickettoview );
} 
```

**编辑**：经过马克汉密尔顿的建议后，我意识到问题出在我的查询上。在 return 上放置一个断点表明`tickettoview`从未填充过 Customer。所以这缩小了范围，但我仍然不确定如何填充公司属性。

再次谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T07:12:53.880

马特的回答给了我我需要的词汇，并最终把我带到了[这个页面](http://www.thejoyofcode.com/Sub_selects_in_code_with_the_Entity_Framework.aspx)。添加`.Include("Company")`到我的数据集中填充了 Company 属性。

```
var tickettoview = ( from t in _db.Ticket.Include("Company")
                     where t.TicketID == id
                     select t ).First(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T06:07:21.693

这听起来和我问[这个问题](https://stackoverflow.com/questions/223713/can-i-pass-an-anonymous-type-to-my-asp-net-mvc-view)时遇到的问题一样。请参阅我发布的描述我如何修复它的[答案。](https://stackoverflow.com/questions/223713/can-i-pass-an-anonymous-type-to-my-asp-net-mvc-view/225159#225159)

我使用的是 Linq to SQL 而不是 Linq to Entities，但我假设 DataLoadOptions 和 LoadWith 方法（或类似方法）仍然有效。如果我错了，对实体框架更了解的人可以纠正我。

# asp.net-mvc - asp.net mvc 1 到许多保存帖子和上传文件

> ID：851318
> 
> 赞同：0
> 
> 时间：2009-05-12T05:54:13.323
> 
> 标签：asp.net-mvc, linq-to-sql, entity-relationship

我是 asp.net mvc 的新手。

我正在使用 Linq to Sql 并尝试做所有松散耦合的事情。

我有两张桌子：

1.  消息
2.  新闻档案

我正在尝试做的是保存新闻并同时上传其文件。

如何将新闻与他的文件一起保存到 NewsFiles 表中？

Linq to Sql 模型是好的，它包括对象 NewsFile 到 News 对象。

我的新闻表的具体存储库类（葡萄牙语中的 noticia）：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;

namespace MagixCMS.Models
{
    public class NoticiaRepository : INoticiaRepository
    {
        #region INoticiaRepository Members

        magixcmsEntities _entities = new magixcmsEntities();

        public noticia CreateNoticia(noticia noticiaToCreate)
        {
            _entities.AddTonoticiaSet(noticiaToCreate);
            _entities.SaveChanges();
            return noticiaToCreate;
        }

        public void DeletaNoticia(noticia noticiaToDelete)
        {
            var noticiaOriginal = GetNoticia(noticiaToDelete.Id);
            _entities.DeleteObject(noticiaOriginal);
            _entities.SaveChanges();
        }

        public noticia EditNoticia(noticia noticiaToEdit)
        {
            var noticiaOriginal = GetNoticia(noticiaToEdit.Id);
            _entities.ApplyPropertyChanges(noticiaToEdit.EntityKey.EntitySetName, noticiaToEdit);
            _entities.SaveChanges();
            return noticiaToEdit;
        }

        public noticia GetNoticia(int id)
        {
            return (from c in _entities.noticiaSet where c.Id == id select c).FirstOrDefault();
        }

        public IEnumerable<noticia> ListNoticias()
        {
            return _entities.noticiaSet.ToList();
        }

        #endregion
    }
} 
```

看这不是对 NewsFile 对象的任何提及。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T05:57:14.143

**强烈**建议：在创建“附加目标”记录**后**上传/附加文件。

我有类似的情况，我有（实际上几乎相同）“公告”对象，我可以将图像或 PDF 附件附加到该对象。*我最初的想法是允许发布带有*要上传的文件的新公告（标题、类别、正文等） 。现在，诚然，我正在尝试设计同时上传许多文件（以及对失败上传的巧妙响应/验证）.. 但重点是：这种方法太难了。帮自己一个忙，让用户先创建记录，然后附加/上传文件。存在主键表记录也会使事情变得更容易。

**编辑：有关文件和上传的更多信息：**

我使用一个`File`对象将文件存储在我的数据库中（所以是的，我需要一个二进制/图像字段`byte[]`）。然后我有其他代表具体文件的对象，比如`Image`和`PdfDoc`继承自`File`- 这些包括其他属性（如`Image`类型的宽度和高度）。我有一个部分视图，它将可重用的上传控件呈现给详细视图，当提交帖子到特定的`AttachImage()`或`AttachPdfDoc()`方法时`Announcement`（创建后 - 见上文）。服务层负责在验证后存储文件等并链接对象。然后重新加载详细视图，并列出附件供公众下载。（注意：顺便说一句，这是经过大量总结的——我也只允许在经过身份验证的用户的详细视图上编辑控件（上传表单））

# c++ - 如何检查系统是否处于注销状态？

> ID：851321
> 
> 赞同：3
> 
> 时间：2009-05-12T05:54:46.003
> 
> 标签：c++, windows, winapi

我想在VC++中检查系统是否处于注销状态，有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T06:22:48.953

*   您可以使用各种机制获取登录/注销通知（如果您的程序是服务，则 SENS、SCM 通知，如果您使用的是 XP，则为 Winlogon 通知）
*   您可以使用 WMI 枚举活动会话。
*   您可以使用 WTS API 来枚举会话和查询会话信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T06:33:28.780

在 AutoIt 中，我总是通过检查活动窗口句柄来检测系统是否已注销，如果系统记录了活动窗口句柄将返回 0x0000000。在 AutoIt 中，它看起来像......

```
If WinGetHandle("") == 0x00000000 Then MsgBox(0,"","We are logged out!") 
```

希望有帮助...

# java - C++ 中的反射

> ID：851323
> 
> 赞同：12
> 
> 时间：2009-05-12T05:56:21.027
> 
> 标签：java, c++, reflection

我多年来一直在使用 Java。在那些年里，我广泛（或者可能只是频繁地）使用反射，发现它有用且令人愉快。但是 8 个月前我换了工作，现在 Java 只是一个记忆，我开始接触 C++。所以现在我想知道C++中是否有任何反射机制。我读过关于 RTTI 的文章，但我觉得这绝不是 Java（或其他语言）反思的力量。我开始认为在 C++ 中没有办法做到这一点。我错了吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-12T06:02:02.467

由于 C++ 标准不涵盖诸如“元数据”之类的概念，因此除了您已经提到的 RTTI 之外，没有可移植的（跨不同的编译器和平台，就此而言）运行时反射方法。

在 C++ 中，也有编译时反射的可能性（想想`boost::type_traits`和`boost::type_of`），但与 Nemerle 或 LISP 相比，它也受到限制。

大多数主要框架（MFC、Qt 等）都允许您在运行时提取元信息，但它们需要各种特殊的注释才能工作（参见[RUNTIME_CLASS](http://msdn.microsoft.com/en-us/library/a3tc49sy(VS.80).aspx)等人作为示例）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T14:37:57.470

如果您正在寻找一种在运行时操作对象的完全通用方法，而您在 C++ 中编译时不知道它们的类型，那么您基本上需要：

1.  为类可能支持的每个功能定义一个接口（具有所有纯虚方法且没有成员的抽象基类）。
2.  每个类必须从它想要实现的所有接口虚拟继承（可能在其他类中）。

现在，假设`pFoo`拥有指向`IFoo*`某个对象的类型接口指针`x`（您不需要知道`x`的具体类型）。您可以通过以下方式查看此对象是否支持接口`IBar`：

```
if (IBar* pBar = dynamic_cast<IBar*>(pFoo)) {
    // Do stuff using pBar here
    pBar->endWorldHunger();
} else {
    // Object doesn't support the interface: degrade gracefully
    pFoo->grinStupidly();
} 
```

**这种方法假定您在编译时知道所有相关接口**——如果您不知道，您将无法使用正常的 C++ 语法来调用方法。但是很难想象调用程序不知道它需要什么*接口*的情况——我能想到的唯一情况是，如果您想通过交互式解释器公开 C++ 对象。即使这样，您也可以设计一种（丑陋的、维护密集型的）将其硬塞到上述范例中的方法，以便可以通过将方法的名称和参数指定为字符串来调用方法。

要考虑的另一个方面是**对象创建**。要在不知道具体类型的情况下完成此操作，您将需要一个工厂函数，以及类的唯一标识符来指定您想要的具体类。[正如 C++ 专家 Herb Sutter 所描述](http://www.ddj.com/cpp/184403786)的，可以安排类在启动时向全局工厂注册自身——这避免了维护巨大的`switch`语句，大大简化了维护。可以使用单个工厂，但这意味着系统中的每个对象都必须实现一个接口（工厂将返回指向此接口类型的指针或引用）。

归根结底，你最终得到的基本上是（同构于）[COM——](http://www.microsoft.com/com/default.mspx)`dynamic_cast<IFoo*>`与.`QueryInterface(IID_IFoo)``IUnknown`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T09:30:22.987

看看[我对类似问题的回答](https://stackoverflow.com/questions/87932/attribute-reflection-libraries-for-c/88215#88215)。提出的两种解决方案（XRTTI 和 OpenC++）都基于在构建过程中为您生成反射元数据的外部工具。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-12T07:11:25.863

您需要使用访问者模式。任何可以反映的类都需要继承一个基类，该基类给它一个`Reflect`成员函数，该函数将接受一个访问者类。然后该`Reflect`函数会将有关其他成员的信息或能力传递给访问者。

许多流行的库在特定情况下使用这种模式，例如，`Serialize`MFC 中的函数这样做但专门用于序列化。

您可能可以设计一个系统，使访问者能够对成员函数进行动态调用，获取或设置数据成员的值等。但是每个类都有责任维护`Reflect`由手，这将是类结构的重复。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T06:00:54.310

RTTI 是一种解决方案（您认为 Java 中的哪些部分不在 RTTI 中？），否则您可以实现自己的对象框架 - 让您自己的每个 C++ 对象都继承一些反射接口，然后它应该可以工作。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T07:16:00.007

反射是计算机程序可以观察和修改其自身结构和行为的过程。我不明白如何在 C++ 中进行反射。RTTI 仅对运行时内存中对象的数据类型有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T06:11:48.817

如果您使用它的只是依赖注入（某些接口^H^H^H^H^H^ 纯抽象类的实现），您可以尝试动态加载包含实现的 .dll 或 .so 文件- 无论插件是什么。

可能只是抓住稻草，因为这不适用于同时实现多个事物。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-08-19T19:53:18.617

你需要在 C++ 中做什么，你在使用什么平台？我知道一种获取完整类定义并使用此数据调用函数的方法，它适用于 Windows，但我不知道其他平台。这个想法是从 DLL 或 exe 导出表中获取数据。这并不容易——我们花了几个月的时间才得到一个体面的实现——但它会做反射支持语言所做的一切。

# sql - 连续日期的最小有效日期和期限日期

> ID：851324
> 
> 赞同：0
> 
> 时间：2009-05-12T05:56:40.387
> 
> 标签：sql, sql-server

有没有办法使用 SQL 2000 查询来实现以下操作，我到处查看，但找不到任何工作片段。

我有连续的日期段，要求获取每个连续日期的最小生效日期和最大生效日期。

如果不可能使用不同的查询获得连续段的最小生效日期和最大期限日期也对我有用。

```
ID  effdate     termdate
1   2007-05-01  2007-05-31
2   2007-06-01  2007-06-30
3   2007-07-01  2007-09-30
4   2008-03-01  2008-03-31
5   2008-05-01  2008-05-31
6   2008-06-01  2008-06-30 
```

预期结果 ：

```
2007-05-01  2007-09-30
2008-03-01  2008-03-31
2008-05-01  2008-06-30 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T17:48:15.653

我做了这样的事情来获得 effdate 和 termdate 相同，将它们作为两个单独的视图并得到最终结果。

```
SELECT distinct e0.effdate,e0.ID
  FROM  dbo.datatable e0    LEFT OUTER JOIN dbo.datatable PREV ON       
       PREV.ID = e0.ID 
 AND  PREV.termdate = DATEADD(dy, -1, e0.Effdate)        
  WHERE PREV.ID IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T06:34:11.337

不幸的是，您可能不得不使用光标。像这样的东西应该工作。

```
DECLARE @Results TABLE
(
    effdate DATETIME,
    termdate DATETIME
)

DECLARE @Date1 DATETIME, 
        @Date2 DATETIME,
        @StartDate DATETIME, 
        @EndDate DATETIME

DECLARE @Cursor CURSOR 

SET @Cursor = CURSOR FAST_FORWARD
FOR
SELECT effdate, termdate FROM <TABLE>

OPEN @Cursor
FETCH NEXT FROM @Cursor
INTO @Date1,@Date2

WHILE @@FETCH_STATUS = 0
BEGIN
    IF @StartDate IS NULL
    BEGIN
        SELECT  @StartDate = @Date1,
                @EndDate = @Date2
    END
    ELSE
    BEGIN
        IF DateDiff(d,@EndDate,@Date1) = 1
        BEGIN
            SET @EndDate = @Date2
        END
        ELSE
        BEGIN
            INSERT INTO @Results
            SELECT @StartDate, @EndDate

            SELECT  @StartDate = @Date1,
                    @EndDate = @Date2
        END
    END

    FETCH NEXT FROM @Cursor
    INTO @Date1,@Date2
END

INSERT INTO @Results
SELECT @StartDate, @EndDate

CLOSE @Cursor
DEALLOCATE @Cursor 

SELECT * FROM @Results 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T06:59:23.887

select min(effdate),max(termdate) from tab1 where year(effdate) = year(termdate) group by year(effdate) order by min(effdate)

结果

2007-05-01 00:00:00.000 2007-09-30 00:00:00.000

2008-03-01 00:00:00.000 2008-06-30 00:00:00.000

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T12:27:09.653

如果不使用临时表，我认为这是不可能的。（您不排除它们的使用，但在迈克贝内特发布他的答案之前，您也没有排除使用游标）

我有理由相信这是一个通用的解决方案 - 它使用了一个未记录的功能，可以在更新语句期间多次更改变量的值。

如果您的表中的记录按 effdate 的顺序输入，您可以跳过创建人工标识列以保证顺序（我的查询中的 autoID）。

```
-- Setup test data

IF object_id('tempdb..#test1') IS NOT NULL
        DROP TABLE #test1
GO

CREATE TABLE #test1
(id INT
,effdate DATETIME
,termdate DATETIME
)

INSERT #test1
      SELECT 1,'2007-05-01','2007-05-31'
UNION SELECT 2 ,'2007-06-01','2007-06-30'
UNION SELECT 3 ,'2007-07-01','2007-09-30'
UNION SELECT 4 ,'2008-03-01','2008-03-31'
UNION SELECT 5 ,'2008-05-01','2008-05-31'
UNION SELECT 6 ,'2008-06-01','2008-06-30'
GO

IF object_id('tempdb..#t') IS NOT NULL
        DROP TABLE #t

GO

-- Order the records by effdate
SELECT IDENTITY(INT,1,1) AS autoId
,cast(NULL AS INT) groupID
,*
INTO #t
FROM #test1
ORDER BY effdate

UPDATE #t
SET groupID = 1
WHERE autoID = 1

DECLARE @gp INT
SET @gp = 1

--update groupID using the undocumented variable-update method
UPDATE t2
SET @gp = CASE WHEN t1.termdate = t2.effdate - 1
               THEN @gp 
               ELSE @gp + 1
          END
,groupID = @gp
FROM #t AS t1
JOIN #t AS t2
ON t1.autoID = t2.autoID - 1

--output results
select min(effdate), max(termdate)
from #t
group by groupID
order by groupID 
```

# sparql - Protege 中的 SPARQL 查询

> ID：851332
> 
> 赞同：1
> 
> 时间：2009-05-12T05:59:39.040
> 
> 标签：sparql, protected, protege

我正在尝试通过[Protégé](http://protege.stanford.edu/) Tool 查询我的本体。但是我得到的查询结果是“未找到匹配项”。

下面给出了我的 SPARQL 查询。

```
SELECT ?g
WHERE { ?g rdfs:subClassOf "#bomb" . } 
```

请谁能告诉我为什么我会得到这样的结果。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-25T10:59:26.177

图形模式

```
?g rdfs:subClassOf "#bomb" . 
```

尝试将语句与文字字符串“ `#bomb`”匹配。由于谓词是`rdfs:subClassOf`，您可能想要匹配一个类 URI。因此，更改`"#bomb"`为`<your-full-uri-here>`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-01T02:16:30.303

Protege 4 不支持 SPARQL 语言。现在你可以使用这样的简单查询：

**有**孩子的人**有些** **真**

结果是作为父亲的个人的列表。

# java - 幻影断点让我抓狂！

> ID：851334
> 
> 赞同：5
> 
> 时间：2009-05-12T06:00:06.370
> 
> 标签：java, eclipse, breakpoints

我不知道它来自哪里，它没有出现在我的断点视图中，但是每次我启动我的程序时，在它到达我的代码之前它会在 FileInputStream.class 的开头中断

这真的很烦人。我正在使用 eclipse 3.4 和 java 1.6。谢谢！约书亚

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T06:10:40.580

您是否检查[过为什么我的 Eclipse 项目有幻像调试器断点？](https://stackoverflow.com/questions/723199/why-does-my-eclipse-project-have-phantom-debugger-breakpoints)?

更具体地说，
“ `Window > Preferences > Java > Debug : Suspend execution on uncaught exceptions`”
选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T06:18:47.667

我曾经在嵌入式系统的 µVision 中遇到过类似的行为。有没有像“杀死所有断点”这样的命令？这对我帮助很大。也许您在 IDE 中对该类进行了一些配置？（右键单击该类？）

问候萨沙

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T06:12:17.160

好像您正在尝试打开文件或其他输入设备并出现异常。这就是 Eclipse 表现得像有断点的原因。

# django - 在 django 中使用相同的输入名称上传多个文件

> ID：851336
> 
> 赞同：27
> 
> 时间：2009-05-12T06:01:02.017
> 
> 标签：django, file, upload, file-upload

我在上传具有相同输入名称的多个文件时遇到问题：

```
<input type=file name="file">
<input type=file name="file">
<input type=file name="file"> 
```

在 django 这边

```
print request.FILES :

<MultiValueDict: {u'file': [
<TemporaryUploadedFile: captcha_bg.jpg (image/jpeg)>,
<TemporaryUploadedFile: 001_using_git_with_django.mov (video/quicktime)>,
<TemporaryUploadedFile: ejabberd-ust.odt (application/vnd.oasis.opendocument.text)>
]}> 
```

所以所有三个文件都在单个 request.FILES['file'] object 下。我如何处理从这里上传的每个文件？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2009-05-13T04:55:34.377

```
for f in request.FILES.getlist('file'):
    # do something with the file f... 
```

编辑：我知道这是一个旧的答案，但我刚刚遇到它并编辑了答案以使其实际上是正确的。以前建议您可以直接迭代`request.FILES['file']`. 要访问 MultiValueDict 中的所有项目，请使用`.getlist('file')`. 使用 just`['file']`只会返回它为该键找到的最后一个数据值。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-10-16T09:43:41.610

鉴于您的 url 指向*envia*，您可以像这样管理多个文件：

```
#!/usr/bin/env python
# -*- coding: UTF-8 -*-
from django.http import HttpResponseRedirect

def envia(request):
    for f in request.FILES.getlist('file'):
        handle_uploaded_file(f)
    return HttpResponseRedirect('/bulk/')

def handle_uploaded_file(f):
    destination = open('/tmp/upload/%s'%f.name, 'wb+')
    for chunk in f.chunks():
        destination.write(chunk)
    destination.close() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T06:16:34.127

我认为所有三个文件都不会位于单个`request.FILES['file']`对象下。`request.FILES['file']`可能具有该列表中的第一个文件或最后一个文件。

您需要像这样唯一地命名输入元素：

```
<input type=file name="file1">
<input type=file name="file2">
<input type=file name="file3"> 
```

..例如。

**编辑：[贾斯汀的回答](https://stackoverflow.com/questions/851336/multiple-files-upload-using-same-input-name-in-django/851372#856126)更好！**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-29T05:37:07.407

此代码是示例

```
 for f in request.FILES.getlist('myfile[]'):
        if request.method == 'POST' and f:
            myfile = f
            filesystem = FileSystemStorage()
            filename = filesystem.save(myfile.name, myfile) 
```

# html - 没有Flash如何知道swf文件的尺寸？

> ID：851337
> 
> 赞同：17
> 
> 时间：2009-05-12T06:01:17.397
> 
> 标签：html, windows, flash

我有一个 swf 文件，我想将此文件嵌入 HTML 页面，但我不知道 swf 的确切尺寸。Windows XP 文件属性不显示尺寸，并且我没有 Adob​​e Flash 软件。那我怎么知道维度。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2009-05-12T06:13:14.010

有一组用于处理 SWF 文件的实用程序，称为[SWFTOOLS](http://www.swftools.org/)。您可以从[下载页面](http://www.swftools.org/download.html)获取 Windows 二进制文件。

此包中的工具之一是`swfdump`，它可以告诉您 SWF 文件的尺寸。它还可以生成用于嵌入的正确 HTML 代码（从我的 Linux 机器输出）：

```
# swfdump -X flash.swf
-X 724
# swfdump -Y flash.swf
-Y 147
# swfdump -E flash.swf
<object type="application/x-shockwave-flash"
 data="flash.swf" width="724" height="147">
<param name="movie" value="flash.swf"/>
<param name="play" value="true"/>
<param name="quality" value="high"/>
</object> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T06:14:52.570

使用 Flash 播放器从硬盘驱动器中打开它 - 双击它 - 然后使用[JR Screen Ruler](http://www.spadixbd.com/freetools/jruler.htm)查看它的尺寸。如果它恰好以全屏模式打开，只需按 ESC ;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T06:17:51.363

SWF 文件的开头有一个标题，其中以缇为单位的帧大小存储为 RECT 结构。当图像以 100% 缩放比例播放时，一个像素有 20 缇。

有关详细信息，请参阅[此文档](http://www.adobe.com/devnet/swf/pdf/swf_file_format_spec_v10.pdf)。

# applescript - Apple 脚本 - 如何注册应用程序？

> ID：851345
> 
> 赞同：1
> 
> 时间：2009-05-12T06:06:10.650
> 
> 标签：applescript

我编写了一个 Apple Script 文件，该文件在我将使用的应用程序从实际目录更改为链接后停止工作。进行此更改是为了简化应用程序的更改版本。

如何将链接重新关联为应用程序，以便脚本启动正确的文件？目前，我在运行脚本时总是收到错误“未知应用程序”。

编辑：我现在手动启动应用程序。因此它与启动无关

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T06:21:03.387

Apple 在您运行它们时注册所有应用程序，也许启动该应用程序可能会有所帮助。

# sql-server - SQL Server 中的 DTS/SSIS 是什么？

> ID：851346
> 
> 赞同：3
> 
> 时间：2009-05-12T06:06:22.727
> 
> 标签：sql-server, sql-server-2005

SQL Server 中的 DTS/SSIS 是什么？我需要单独安装这些服务吗？

这个 DTS/SSIS 在 SQL Server 中有什么用？如何配置 DTS/SSIS？

请在这方面帮助我

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T06:09:31.627

SSIS = SQL Server 集成服务。来自微软：

> Microsoft Integration Services 是一个用于构建企业级数据集成和数据转换解决方案的平台。您可以使用集成服务通过复制或下载文件、发送电子邮件消息以响应事件、更新数据仓库、清理和挖掘数据以及管理 SQL Server 对象和数据来解决复杂的业务问题。这些软件包可以单独使用，也可以与其他软件包一起使用，以满足复杂的业务需求。Integration Services 可以从各种源（例如 XML 数据文件、平面文件和关系数据源）中提取和转换数据，然后将数据加载到一个或多个目标。集成服务包括一组丰富的内置任务和转换；构建包的工具；以及用于运行和管理包的集成服务服务。您可以使用图形集成服务工具来创建解决方案，而无需编写任何代码；或者，您可以对广泛的 Integration Services 对象模型进行编程，以编程方式创建包，并对自定义任务和其他包对象进行编码。

[http://msdn.microsoft.com/en-us/library/ms141026.aspx](http://msdn.microsoft.com/en-us/library/ms141026.aspx)

这实际上是很酷的东西。Oracle 也为他们的 dbms 提供了一个非常酷的商业智能编辑器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T06:39:32.203

在 SSIS 上，看看这个相关的问题。我在这个问题上为 SSIS 发布了有用的链接：[什么是 SSIS 包，它有什么作用？](https://stackoverflow.com/questions/454802/what-is-ssis-package-what-does-it-do/454955#454955)

# c++ - 标记并转换为猪拉丁语

> ID：851351
> 
> 赞同：0
> 
> 时间：2009-05-12T06:08:56.027
> 
> 标签：c++, tokenize

这看起来像是家庭作业，但请放心，这不是家庭作业。只是我们在 c++ 课程中使用的书中的一个练习，我正在尝试提前阅读指针..

书中的练习告诉我将一个句子拆分为标记，然后将它们中的每一个转换为拉丁语然后显示它们。

这里的 pig latin 基本上是这样的：ball 在 piglatin 中变成 allboy.. boy 变成 oybay.. 取出第一个字母，放在最后，然后添加“ay”..

到目前为止，这就是我所拥有的：

```
#include <iostream>
using std::cout;
using std::cin;
using std::endl;

#include <cstring>
using std::strtok;
using std::strcat;
using std::strcpy;

void printPigLatin( char * );

int main()
{
    char sentence[500];
    char *token;

    cout << "Enter string to tokenize and convert: "; 
    cin.getline( sentence, 500 );

    token = strtok( sentence, " " );

    cout << "\nPig latin for each token will be: " << endl;

    while( token != NULL ) 
    {
        printPigLatin( token );
        token = strtok( NULL, " " );
    }

    return 0;
}

void printPigLatin( char *word )
{
    char temp[50];

    for( int i = 0; *word != '\0';  i++ )
    {
        temp[i] = word[i + 1];
    }

    strcat( temp, "ay" );
    cout << temp << endl;
} 
```

我很清楚地理解了标记化部分，但我不知道如何做猪拉丁语..我试着从简单地在标记中添加“ay”开始，看看结果会是什么..不确定程序为什么会进入一个无限循环并继续显示“ayay”..有什么提示吗？

编辑：这个现在工作正常，但我不确定如何在添加“ay”之前添加令牌的第一个字母

编辑：这就是我“看到”它完成但不确定如何正确实现它的方式..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T06:15:07.720

您正在使用 strcat 遍历您的输入字符串。您需要为每个令牌创建一个新字符串，复制令牌和“ay”，或者简单地打印令牌然后打印“ay”。但是，如果您使用 C++，为什么不使用 istream 迭代器和 STL 算法呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T06:47:14.623

老实说，从你的例子来看，我严重怀疑 C++ 书的质量。C++ 中的“基本内容”不是 C 指针样式编程。相反，它正在应用高级库功能。正如“On Freund”所指出的，C++ 标准库提供了出色的功能来解决您的任务。您可能想要[搜索](https://stackoverflow.com/questions/189090/a-good-c-book)更好的 C++ 书籍的推荐。

关于问题：您`printPigLatin`可以使用现有功能`strcpy`（或更好：`strncpy`就缓冲区溢出而言更安全）。您的手动副本省略了输入中的第一个字符，因为您使用的是`i + 1`st 位置。您还有一个坏循环条件，它总是测试相同的（第一个）字符。此外，这无论如何都会导致溢出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T06:55:30.977

正如我之前的人所指出的，还有其他几种方法可以实现您想做的事情。

但是，您的代码的实际问题似乎是 strcat 的使用，我看到您在编辑中对其进行了一些更改。这是对为什么最初的不工作的解释[char* 和大小问题](http://irc.essex.ac.uk/www.iota-six.co.uk/c/g6_strcat_strncat.asp)

基本上，指针没有分配足够的内存来将“ay”添加到提供的字符串中。如果您使用链接中显示的技术创建指针，它应该可以正常工作。

我让你的程序正常工作，取出 strcat 并使用

> cout << word << "ay" << endl

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T07:09:43.840

由于 *word != '\0'，您的循环是无限的。

字指针在循环中的任何时候都不会改变。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T22:46:44.323

这似乎奏效了：

```
void printPigLatin( char *word )
{
    cout << word + 1 << word[0] << "ay" << endl;
} 
```

只是不确定这样做是否是个好主意。

# text - 哪个代码编辑器是免费的，可以通过按键通过 ftp 上传，并且有一个用于文件夹浏览的侧面板？

> ID：851353
> 
> 赞同：0
> 
> 时间：2009-05-12T06:09:05.730
> 
> 标签：text, editor, notepad++, textmate

我喜欢 PhpEd，因为使用 CTRL-SHIFT-S，它会上传到测试服务器，所以不需要切换到 FTP 客户端，找到文件并上传。

我也喜欢 TextMate，因为它的显示效果很好（Monaco 字体比 Lucida Console 更简洁，并且比 Courier 更容易查看）......并且还有一个用于文件夹和文件列表的左侧面板。

那么在PC/Mac/Linux上，有没有这样的编辑器可以做到

1) Easy FTP
2) 侧面板文件/文件夹列表
3) 好看的字体
4) 自动缩进
5) 自动重新缩进
6) 显示匹配 { 和 }，以及匹配 <div> 和 </div>

我尝试了一些……比如 Notepad++、jEdit 或 Programmer's Editor，但似乎还没有找到这些功能。你认识一个接近的编辑器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T06:37:38.710

Emacs 可以做*任何*其他编辑器可以做的任何事情，你只需要学习 Scheme/Lisp 来编写宏:-)。

我不怀疑 Vim 也可以做到这一点（我自己也是一个 Vim 人，我写过宏，但我从来没有觉得有必要专门做你要求的事情）。

这是一个人为的问题。你不妨问问哪个编辑器可以：

*   大写 COBOL 代码。
*   添加序列号。
*   上传到主机。
*   向操作员发送 SMS 消息以启动编译器运行。

*如今，*大多数编辑器都具有令人难以置信的可配置性。**

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T08:25:45.867

我使用 PSPad - 如果您从 FTP 打开文件，则每次保存时都会将其上传到 FTP 服务器。

它还支持编写脚本宏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T08:20:45.547

我想提供一个开箱即用的解决方案，而不是发明一个可以做特定事情的 IDE，我使用将 FTP 和 SFTP 带给我的工具。

特别是，[ExpanDrive](http://www.expandrive.com/windows/)（以前称为 sftpdrive）将通过 sftp 将远程机器安装为本地驱动器。这样，任何本地应用程序都会将已安装的驱动器视为本地驱动器，并且您不必跳过箍来远程保存数据。

[同样，对于 FTP，也有类似此处](http://cybernetnews.com/2007/09/27/cybernotes-map-a-ftp-to-a-drive-in-windows/)描述的方法。

如果您可以访问远程机器上的 samba，请使用它。这是 IO 方面最快和最好实现的方法，您可以将 samba 挂载直接挂载为 Windows 中的驱动器。这是我在办公室使用共享开发箱的首选开发方法。

希望这可以帮助。

PS 我最喜欢的编辑器是 EditPadPro，因为它与 RegexBuddy 集成，并提供真正完整的 Perl 风格的正则表达式支持，以及所有标准的东西，如代码突出显示、插件（如 XML/HTML 格式化程序）等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-04T18:38:36.280

您问题的最佳答案是恐慌尾声。只需使用本地文件夹设置站点并关联远程文件夹。现在您对该本地文件夹所做的每项更改都会自动镜像到远程文件夹。不仅在您编辑文件时，而且在您创建子文件夹或创建新文件或在其中放置一些图像时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-06T12:25:00.360

[Zeus Lite](http://www.zeusedit.com/lite)具有 FTP/SFTP 编辑功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-28T13:19:42.393

我用过很多不同的编辑器，但 HTMLEdit 对我很有帮助。它有 ftp 部分和扩展，但可能不是所有你需要的花里胡哨的东西。它适用于 Windows

# c# - Transaction Scope 这么多交易的细节及其优势

> ID：851354
> 
> 赞同：1
> 
> 时间：2009-05-12T06:09:19.193
> 
> 标签：c#, asp.net

我一口气完成了 20 多笔交易。我想对此使用事务范围。可能吗？如果可能的话，那么使用事务范围类比简单事务有什么优势。

使用事务范围的最佳实践是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T07:13:22.710

的优点`TransactionScope`是：

*   您不必传递事务（ADO.NET 应该自动登记）
    *   这意味着您甚至可以使用 a`TransactionScope`将事务添加到现有的封闭源代码（即不需要更改）
*   一个`TransactionScope`可以（通过 DTC）跨越多个资源（即多个数据库，或一个数据库和一个 MSMQ 服务器等）

但是，您需要为此付出*一点*速度。基于连接的事务稍快（不多），但只能跨越单个资源，需要手动附加到所有 DAL 代码。但是，如果您只与单个 SQL2005/SQL2008 实例通信，那么它可以使用“LTM”——这意味着它不必涉及 DTC（这是大部分性能成本的来源），除非它绝对需要。许多`TransactionScope`操作因此可以完成只与数据库对话。

如果你想跨越 20 个操作，那么`TransactionScope`应该是理想的 - 它可以让你不必传递事务，并允许每个操作在本地管理它们的连接 - 使代码具有高度可重用性。确实，`TransactionScope`可以按照您期望的方式嵌套，因此您可以拥有：

```
void Deposit(...) { /* uses TranScope to do a deposit */ }
void Debit(...) { /* uses TranScope to do a debit */ }
void Transfer(...) { /* uses a TranScope to span Debit/Deposit */ } 
```

要使用数据库事务执行此操作，您需要将连接*和*事务对象传递给每个方法，这很快就会变得笨拙 - 特别是如果您需要编写代码以使用/不使用现有的打开事务（大量“ `if(tran==null)`”等）。

有关详细信息，请参阅[.net 中的事务](https://stackoverflow.com/questions/224689/transactions-in-net/224702#224702)

# c# - C# - 自定义属性

> ID：851366
> 
> 赞同：1
> 
> 时间：2009-05-12T06:13:29.623
> 
> 标签：c#, .net-3.5, attributes

我想记录对具有特定属性的所有类方法的所有调用。我该怎么做？

这是我到目前为止所拥有的：

```
class ExecutionLogAttribute : Attribute
{
}

public class Human
{
    private Int32 age;

    [ExecutionLog]
    public void HaveBirthday()
    {
        age++;
    }
} 
```

现在将所有呼叫记录到 HaveBirthday 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T06:19:12.017

简单的答案：[PostSharp](http://www.postsharp.org/)。更复杂的一个：使用[ContextBoundObject的](http://www.codeproject.com/KB/architecture/aopsimplestscenario.aspx)[Spring.NET](http://springframework.net/)或自定义 AOP（这是您需要的：面向方面的编程）实现。

# php - 如何在变量中执行和获取 .php 文件的内容？

> ID：851367
> 
> 赞同：22
> 
> 时间：2009-05-12T06:13:53.213
> 
> 标签：php, file, return, file-get-contents

我想在其他页面上的变量中获取 .php 文件的内容。

我有两个文件，`myfile1.php`和`myfile2.php`.

**myfile2.php**

```
<?PHP
    $myvar="prashant"; // 
    echo $myvar;
?> 
```

现在我想在 myfile1.php 的一个变量中获取 myfile2.php 回显的值，我尝试了以下方式，但它也获取了包括 php tag () 在内的所有内容。

```
<?PHP
    $root_var .= file_get_contents($_SERVER['DOCUMENT_ROOT']."/myfile2.php", true);
?> 
```

请告诉我如何将一个 PHP 文件返回的内容放入另一个 PHP 文件中定义的变量中。

谢谢

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-05-12T08:41:11.850

你必须区分两件事：

*   是否要捕获包含文件的输出 ( `echo`, `print`,...) 并在变量（字符串）中使用输出？
*   您想从包含的文件中返回某些值并将它们用作*主机*脚本中的变量吗？

包含文件中的局部变量将始终移动到*主机*脚本的当前范围 - 应该注意这一点。您可以将所有这些功能合二为一：

`include.php`

```
$hello = "Hello";
echo "Hello World";
return "World"; 
```

`host.php`

```
ob_start();
$return = include 'include.php'; // (string)"World"
$output = ob_get_clean(); // (string)"Hello World"
// $hello has been moved to the current scope
echo $hello . ' ' . $return; // echos "Hello World" 
```

`return`-feature 派上用场，尤其是在使用配置文件时。

`config.php`

```
return array(
    'host' => 'localhost',
     ....
); 
```

`app.php`

```
$config = include 'config.php'; // $config is an array 
```

**编辑**

为了回答您关于使用输出缓冲区时性能损失的问题，我只是做了一些快速测试。在我的 Windows 机器上， 1,000,000 次迭代`ob_start()`和相应的`$o = ob_get_clean()`需要大约 7.5 秒（可以说不是 PHP 的最佳环境）。我会说性能影响应该被认为很小......

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-12T06:26:49.743

如果您只想要`echo()`包含页面的内容，您可以考虑使用输出缓冲：

```
ob_start();
include 'myfile2.php';
$echoed_content = ob_get_clean(); // gets content, discards buffer 
```

见[http://php.net/ob_start](http://php.net/ob_start)

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2015-05-03T13:08:36.107

我总是尽量避免**`ob_`**使用函数。相反，我使用：

```
<?php
$file = file_get_contents('/path/to/file.php');
$content = eval("?>$file");
echo $content;
?> 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-12T06:18:09.273

您可以使用[include](http://www.php.net/include)指令来执行此操作。

文件 2：

```
<?php
    $myvar="prashant";
?> 
```

文件 1：

```
<?php 

include('myfile2.php');
echo $myvar;

?> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-05-12T08:39:19.730

“实际上我只是在寻找可以直接给我价值的任何返回类型方法”-您刚刚回答了自己的问题。

请参阅[http://sg.php.net/manual/en/function.include.php](http://sg.php.net/manual/en/function.include.php)，示例 #5

文件1.php：

```
<? return 'somevalue'; ?> 
```

文件2.php：

```
<?

$file1 = include 'file1.php';
echo $file1; // This outputs 'somevalue'.

?> 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-06-13T19:19:29.837

您可以使用输出缓冲区，它将存储您输出的所有内容，并且除非您明确告诉它，否则不会将其打印出来，或者在执行路径结束时不结束/清除缓冲区。

```
// Create an output buffer which will take in everything written to 
// stdout(i.e. everything you `echo`ed or `print`ed)
ob_start()
// Go to the file
require_once 'file.php';
// Get what was in the file
$output = ob_get_clean(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-12-07T10:46:51.917

如果您想通过

```
<?php
$URL = 'http://www.example.com/';
$homepage = file_get_contents($URL);
echo $homepage;
?> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-10T12:55:40.470

请尝试此代码

myfile1.php

```
<?php
    echo file_get_contents("http://domainname/myfile2.php");
?> 
```

myfile2.php

```
<?PHP
    $myvar="prashant";
    echo $myvar;
?> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-04-24T19:33:22.723

如果您想从文件中的代码返回输出，只需对其进行 RESTful API 调用即可。这样，您可以将相同的代码文件用于 ajax 调用、REST API 或您的内部 PHP 代码。

它需要安装 cURL，但没有输出缓冲区或不包含，只需执行页面并返回到字符串中。

我会给你我写的代码。它适用于几乎所有 REST/Web 服务器（甚至适用于 Equifax）：

```
$return = PostRestApi($url); 
```

或者

```
$post = array('name' => 'Bob', 'id' => '12345');
$return = PostRestApi($url, $post, false, 6, false); 
```

这是功能：

```
/**
 * Calls a REST API and returns the result
 *
 * $loginRequest = json_encode(array("Code" => "somecode", "SecretKey" => "somekey"));
 * $result = CallRestApi("https://server.com/api/login", $loginRequest);
 *
 * @param string $url The URL for the request
 * @param array/string $data Input data to send to server; If array, use key/value pairs and if string use urlencode() for text values)
 * @param array $header_array Simple array of strings (i.e. array('Content-Type: application/json');
 * @param int $ssl_type Set preferred TLS/SSL version; Default is TLSv1.2
 * @param boolean $verify_ssl Whether to verify the SSL certificate or not
 * @param boolean $timeout_seconds Timeout in seconds; if zero then never time out
 * @return string Returned results
 */
function PostRestApi($url, $data = false, $header_array = false,
    $ssl_type = 6, $verify_ssl = true, $timeout_seconds = false) {

    // If cURL is not installed...
    if (! function_exists('curl_init')) {

        // Log and show the error
        $error = 'Function ' . __FUNCTION__ . ' Error: cURL is not installed.';
        error_log($error, 0);
        die($error);

    } else {

        // Initialize the cURL session
        $curl = curl_init($url);

        // Set the POST data
        $send = '';
        if ($data !== false) {
            if (is_array($data)) {
                $send = http_build_query($data);
            } else {
                $send = $data;
            }
            curl_setopt($curl, CURLOPT_CUSTOMREQUEST, 'POST');
            curl_setopt($curl, CURLOPT_POSTFIELDS, $send);
        }

        // Set the default header information
        $header = array('Content-Length: ' . strlen($send));
        if (is_array($header_array) && count($header_array) > 0) {
            $header = array_merge($header, $header_array);
        }
        curl_setopt($curl, CURLOPT_HTTPHEADER, $header);

        // Set preferred TLS/SSL version
        curl_setopt($curl, CURLOPT_SSLVERSION, $ssl_type);

        // Verify the server's security certificate?
        curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, ($verify_ssl) ? 1 : 0);

        // Set the time out in seconds
        curl_setopt($curl, CURLOPT_TIMEOUT, ($timeout_seconds) ? $timeout_seconds : 0);

        // Should cURL return or print out the data? (true = return, false = print)
        curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);

        // Execute the request
        $result = curl_exec($curl);

        // Close cURL resource, and free up system resources
        curl_close($curl);
        unset($curl);

        // Return the results
        return $result;

    }
} 
```

# .net - 静态成员的垃圾收集

> ID：851370
> 
> 赞同：11
> 
> 时间：2009-05-12T06:15:19.153
> 
> 标签：.net, garbage-collection

静态成员会被垃圾收集器收集吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-12T06:17:39.930

静态变量引用的对象只有在相关对象被垃圾回收时才会被垃圾`AppDomain`回收。在客户端应用程序中，通常只有一个`AppDomain`在整个过程中存在。（例外情况是应用程序使用插件架构时 - 不同的插件可能会在不同`AppDomain`的 s 中加载，并且`AppDomain`可能稍后卸载。）

在 ASP.NET 中，“`AppDomain`回收”会定期发生（出于各种原因）——当这种情况发生时，其中的静态变量`AppDomain`将不再充当 GC 根，因此不会阻止对象被垃圾收集。

但是，如果您担心一个对象被垃圾回收，而您仍然通过静态变量引用它，那么您可以放松。虽然您可以访问该对象，但它不会被垃圾收集。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-12T06:16:38.513

不收集成员...对象是。
因此，如果您设置 Ref. 将静态成员类型为 null，它之前指向的任何对象都将被收集。如果没有，它会一直徘徊，直到 AppDomain 关闭（每个 AppDomain 都有自己的一组静态内容）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-07-06T13:10:36.713

简短的回答......不; .NET 垃圾收集器的所有当前实现都不会收集静态类成员字段强引用的对象，直到与那些静态类成员字段强引用关联的应用程序域被拆除。

更长的答案......可能是的；垃圾收集器根据对象的可达性而不是对象的引用（强或弱）来决定收集对象。理论上，如果垃圾收集器可以确定没有代码从某个点开始再次需要某个对象（即，该对象无法从任何代码路径访问），则允许 GC 收集该对象，即使如果它仍然被静态类成员字段强烈引用。这是完全允许的，因为您永远不会注意到，因为没有代码会尝试访问包含对对象的引用的静态类成员字段。你可能会问，我为什么要关心我是否永远不会通过我持有的任何强引用再次访问该对象？你关心的原因是副作用。例如，您可能会假设通过为静态类成员字段分配对代表非托管资源的 SafeHandle 对象的引用，SafeHandle 对象将永远不会关闭，从而使其代表的非托管“对象”保持活动状态。这仅适用于 GC 的当前实现。GC 的未来实现可以收集静态类成员字段强烈引用的对象，如果这些对象不再被任何剩余的程序代码访问。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T06:20:07.133

引用类型的静态成员是一个引用，它可能指向一个实例，也可能不指向一个实例。如果它指向一个实例，则在卸载静态成员之前不会收集该实例。如果该类型在特定的 AppDomain 中加载，则可以卸载。否则它只会在应用程序终止时发生。

# delphi - 辅助快捷方式不触发

> ID：851371
> 
> 赞同：3
> 
> 时间：2009-05-12T06:16:14.767
> 
> 标签：delphi, shortcuts, taction, tactionlist

我正在使用 Delpho 2006。场景：

在数据模块上，我有一个 ActionList。其中一个操作有一个快捷键 Ctrl+F4，我想要一个辅助快捷键 Ctrl+W。我尝试了以下所有方法：

将 Ctrl+W 添加到 IDE 中的操作 SecondaryShortcut 列表中。

使用以下任一方法将其添加到 DataModuleCreate 过程中

```
ActFileCloseFile.SecondaryShortCuts.Add('Ctrl+W'); 
```

或者

```
ActFileCloseFile.SecondaryShortCuts.AddObject('Ctrl+W',
  TObject(Menus.ShortCut(87, [ssCtrl]))); 
```

在将要使用它的窗体的 Create 或 FormShow 过程中使用这两种方法。

主要快捷方式始终有效，但次要快捷方式无效。

当我将 ActionList 放在主窗体而不是数据模块上时，只需在 IDE 中添加 Ctrl+W 即可。我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T07:36:11.347

迄今为止发现的最优雅的解决方案是：

在要处理 SecondaryShortCut 的表单上，将其添加到 OnShortCut 事件：

```
procedure TMyForm.FormShortCut(var Msg: TWMKey; var Handled: Boolean);
begin
  Handled := dmDataModule.ActionList1.IsShortCut(Msg);
end; 
```

选择：

（这不是真正的解决方案，而是一种解决方法。）

在表单上放置一个与数据模块上的动作相同的动作列表。在其执行和更新事件中，它仅将事件转发给数据模块操作。表单上的菜单使用本地操作。

在这种情况下，只需使用 IDE 将 Ctrl+W 添加到 SecondaryShortCuts 属性即可。

显然，当数据模块上的操作发生变化时，我也必须更改所有本地操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T07:21:13.023

不是一个真正的解决方案，但如果您从主窗体中创建数据模块，它可以工作：

```
procedure TMainForm.FormCreate(Sender: TObject);
begin
  FDataModule := TMyDataModule.Create(self);
  TMyButton.Action := FDataModule.TheAction;
end;

procedure TMyDataModule.DataModuleCreate(Sender: TObject);
begin
  TheAction.SecondaryShortCuts.Add('Ctrl+W');
end; 
```

我认为快捷方式由具有当前焦点的表单处理。所以如果你以另一种形式使用它们，你可能会遇到同样的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-09T15:55:22.003

简短回答：操作快捷方式不会跨表单和数据模块*自动触发。*

如果您按照问题中的说明进行操作，您会发现即使是主要的捷径也不会着火。这是因为说明中遗漏了一个关键步骤。这将有助于解释为什么 OP 经历了主要的捷径射击而不是次要的捷径。

如果您包括额外的步骤：

*   向表单添加菜单。
*   并将菜单项链接到操作。

然后主快捷方式将能够触发该动作。这是因为 Action 组件将其设置推送到菜单项（包括`ShortCut`属性）。但是，`TMenuItem`没有实现二级快捷方式的概念。这就是为什么一个有效而另一个无效的原因。

* * *

暂停考虑具有许多表单和数据模块的应用程序；以及动作捷径是否会在所有这些方面触发的含义。很明显，如果没有明确的代码允许，它们不应该能够*自动触发。*您不希望后台表单做很多事情，因为它配置的快捷键恰好在其他不相关工作的上下文中被按下。

该[文档](http://docwiki.embarcadero.com/Libraries/en/Vcl.ActnList.TActionList)指出了将操作列表放在数据模块上的好处。但似乎没有提供任何解释如何*正确地*在数据模块上使用**带有快捷**方式的操作。当然，在预期的地方没有提到任何内容，即：[ShortCut](http://docwiki.embarcadero.com/Libraries/XE6/en/Vcl.ActnList.TAction.ShortCut)和[SecondaryShortcuts](http://docwiki.embarcadero.com/Libraries/XE6/en/Vcl.ActnList.TAction.SecondaryShortCuts)。（我会很失望，但我对体面文档的期望被拖得很低。）

 *所以...

### *应该*怎么做才能使用跨表单和数据模块的快捷方式执行操作？

我做了一些调查，发现了一些选择。与往常一样，评估相对于您要实现的目标的权衡。

*   当您将操作列表放在（非主）表单上时，所有快捷方式都会按预期工作。这是最常见的场景，适用于本地操作和特定形式的操作。

*   当您在主窗体上放置一个操作列表时，所有这些快捷方式都可以从任何其他窗体触发。这对于应用程序范围的快捷方式非常有用，例如打开其他表单。

*注意：*对于首先测试捷径的位置有一个优先顺序。因此，如果活动表单在主表单上有一个与主表单匹配的快捷方式，则该快捷方式将在本地处理。可以理解，主要形式不会得到它。

*   当测试表单以查看它是否处理快捷方式时，还会检查所有*拥有的组件。*（这实际上就是上述前两个有效的原因。）这意味着只需`Owner`适当地设置数据模块的 ，就可以将其快捷方式应用于您选择的表单。

即代替：

```
Application.CreateForm(TDataModule1, DataModule1); 
```

您可以使用以下内容：

```
DataModule1 := TDataModule1.Create(LocalForm); 
```

但是，由于数据模块的每个实例只能有一个所有者：您必须创建多个实例才能让多个表单共享快捷方式。这是否是一种选择取决于您的情况。但是，您也可以将主窗体设置为数据模块的所有者，这在某种程度上等同于上面的第二个选项。

*   提供最多控制的最后一个选项是 OP 自己的答案。即任何需要支持“外部快捷方式”的表单都可以使用以下代码处理 OnShortCut 事件：

从代码示例中可以看出，您可以根据您选择的优先级委托给不同位置的多个操作列表。

```
procedure TMyForm.FormShortCut(var Msg: TWMKey; var Handled: Boolean);
begin
  Handled := DataModule1.ActionList3.IsShortCut(Msg);
  Handled := Handled or DataModule2.ActionList1.IsShortCut(Msg);
  Handled := Handled or DataModule1.ActionList1.IsShortCut(Msg);
end; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-13T13:36:38.627

动作被表单吞没了...如果您想要辅助表单/框架/数据模块来处理该动作...您必须首先从主表单中禁用动作列表...

Form1.ActionList1.State := asSuspended;

DataModule1.ActionList1.State := asNormal;

# svn - 如何从主干正确创建 SVN 标签？

> ID：851377
> 
> 赞同：289
> 
> 时间：2009-05-12T06:17:44.657
> 
> 标签：svn, tags

我正在[Subversion](http://en.wikipedia.org/wiki/Apache_Subversion)创建我的第一个项目。到目前为止我有

```
 branches
 tags
 trunk 
```

我想我需要立即使分支变得单一并重新开始。 **更新分支**是常态。

我一直在后备箱中工作并将内容移动到标签中，如下所示。

```
mkdir tags/1.0
cp -rf trunk/* tags/1.0
svn add tags/1.0
svn commit -m " create a first tagged version" 
```

我的直觉告诉我这是完全错误的，我应该使用`svn copy`. 我以这种方式创建的文件彼此之间没有任何关系，而且我肯定会错过 Subversion 的功能。我对么？

我应该对单个文件使用 svn copy 吗？

```
mkdir tags/1.0
svn add tags/1.0
svn copy trunk/file1 tags/1.0
svn copy trunk/file2 tags/1.0
svn copy trunk/file3 tags/1.0
svn commit -m " create a first tagged version" 
```

我应该在整个目录上使用 svn copy 吗？

```
svn copy cp -rf trunk tags/1.0
svn commit -m " create a first tagged version" 
```

* * *

## 回答 #1

> 赞同：431
> 
> 时间：2009-05-12T06:23:46.957

采用：

```
svn copy http://svn.example.com/project/trunk \
      http://svn.example.com/project/tags/1.0 -m "Release 1.0" 
```

速记：

```
cd /path/to/project
svn copy ^/trunk ^/tags/1.0 -m "Release 1.0" 
```

* * *

## 回答 #2

> 赞同：188
> 
> 时间：2009-05-12T06:22:48.750

您是正确的，将文件添加到标签文件夹是不“正确的”。

您已经正确猜到`copy`了要使用的操作；它让 Subversion 跟踪这些文件的历史记录，并且（我假设）更有效地存储它们。

以我的经验，最好复制整个项目（即“快照”），即根签出位置的所有文件。这样，快照可以独立存在，作为整个项目在特定时间点的状态的真实表示。

[“本书”的这一部分](http://svnbook.red-bean.com/nightly/en/svn.branchmerge.tags.html)展示了该命令的典型用法。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-06-15T11:03:50.653

正如@victor hugo 所指出的，“正确”的方法是使用svn copy。不过有一个警告。以这种方式创建的“标签”将不是真正的标签，它将是指定修订版的精确副本，但它本身将是不同的修订版。因此，如果您的构建系统以某种方式使用 svn 修订版（例如，将使用 'svn info' 获得的数字合并到您构建的产品的版本中），那么您将无法从标签构建完全相同的产品（结果将具有标签的修订版而不是原始代码的修订版）。

从设计上看，svn 无法创建真正合适的元标记。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-05-12T06:20:02.187

可以使用乌龟：

[http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-branchtag.html](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-branchtag.html)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2014-11-18T03:34:29.577

只需使用这个：

```
svn  copy  http://svn.example.com/project/trunk  
           http://svn.example.com/project/branches/release-1
           -m  "branch for release 1.0" 
```

（当然，都在一条线上。）您应该始终创建整个主干文件夹和内容的分支。当然可以对主干的子部分进行分支，但这几乎不是一个好习惯。您希望分支的行为与现在的主干完全一样，为此您必须对整个主干进行分支。

在我的博客上查看 SVN 使用的更好总结： [SVN Essentials](http://agiletribe.wordpress.com/2014/10/20/svn-essentials/)和[SVN Essentials 2](http://agiletribe.wordpress.com/2014/11/17/svn-essentials-2/)

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2012-12-10T03:43:34.323

@victor hugo 和 @unwind 是正确的，而 victor 的解决方案是迄今为止最简单的。但是请注意您的 SVN 项目中的外部因素。如果您引用外部库，则在您标记具有外部引用的目录时，外部的修订引用（无论是标签、HEAD 还是编号）将保持不变。

可以创建一个脚本来处理标记的这一方面，有关该主题的讨论，请参阅此 SO 文章：[使用外部标记 SVN 结帐](https://stackoverflow.com/questions/1517205/tagging-an-svn-checkout-with-externals-on-development-branches)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-03-11T16:24:47.073

标记 Subversion 存储库的另一个选项是将标记添加到 svn:log 属性，如下所示：

```
 echo "TAG: your_tag_text" > newlog
   svn propget $REPO --revprop -r $tagged_revision >> newlog
   svn propset $REPO --revprop -r $tagged_revision -F newlog
   rm newlog 
```

我最近开始认为这是最“正确”的标记方式。这样您就不会创建额外的修订（就像使用“svn cp”一样），并且仍然可以通过在“svn log”输出上使用 grep 轻松提取所有标签：

```
 svn log | awk '/----/ {
                      expect_rev=1;
                      expect_tag=0;
                  }
                  /^r[[:digit:]]+/ {
                      if(expect_rev) {
                          rev=$1;
                          expect_tag=1;
                          expect_rev=0;
                      }
                  }
                  /^TAG:/ {
                      if(expect_tag) {
                          print "Revision "rev", Tag: "$2;
                      }
                      expect_tag=0;
                  }' 
```

此外，如果需要，您可以通过这种方式无缝*删除标签。*所以标签变成了一个完整的元信息，我喜欢它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-12-03T07:42:03.643

```
svn copy http://URL/svn/trukSource http://URL/svn/tagDestination -m "Test tag code" 
  $error[0].Exception | Select-object Data 
```

您所要做的就是更改 URL 路径。此命令将创建新目录“tagDestination”。如果发生任何错误，第二行将告知您完整的错误详细信息。如果未创建，则创建 svn**环境变量。**可以检查 (Cmd:- set, Powershell:- Get-ChildItem Env:) 默认路径是“C:\Program Files\TortoiseSVN\bin\TortoiseProc.exe”

* * *

## 回答 #9

> 赞同：-4
> 
> 时间：2014-09-11T10:01:48.210

试试这个。这个对我有用：

```
mkdir <repos>/tags/Release1.0
svn commit <repos>/tags/Release1.0 
svn copy <repos>/trunk/* <repos>/tag/Release1.0
svn commit <repos/tags/Release1.0 -m "Tagging Release1.0" 
```

# asp.net - 是否可以在 javascript 中进行两个 .click 方法调用

> ID：851384
> 
> 赞同：0
> 
> 时间：2009-05-12T06:19:25.903
> 
> 标签：asp.net, javascript, ajax, updatepanel

我有以下 javascript 代码：

```
function ClickButtons() {
   document.getElementById('Button1').click();
   document.getElementById('Button2').click();
} 
```

似乎只有 Button2 被点击了。如果我颠倒语句的顺序，那么似乎只有 Button1（那时将被称为 2nd）起作用。

仅供参考（不要认为这会影响这个问题，这里有更多信息）：按钮点击正在执行 ajax/部分页面更新（它们调用数据服务并在页面上填充数据）

编辑：解决方案 setTimeout 有效，但对性能设置了下限。我做了更多的查找，这两个按钮是 asp.net 按钮，位于更新面板内。如果我按顺序单击它们，它们可以正常工作，但是如果我单击一个然后快速单击第二个（在第一个完成之前），那么第二个将起作用而第一个将失败。这似乎是更新面板和 asp.net 的问题？在这方面我可以做些什么来启用上述 javascript 并避免 setTimeout 选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T06:49:44.480

使用 IE 的 fireEvent() 函数怎么样？

```
function ClickButtons() {
  document.getElementById("Button1").fireEvent("onclick");
  document.getElementById("Button2").fireEvent("onclick");
} 
```

工作示例（在 IE6 中测试）：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Click Test</title>
  </head>

  <body>
    <button id="Button1" onclick="alert('Button1 Clicked');">Click 1</button>
    <button id="Button2" onclick="alert('Button2 Clicked');">Click 2/button>
    <script type="text/javascript">
      document.getElementById("Button1").fireEvent("onclick");
      document.getElementById("Button2").fireEvent("onclick");
    </script>
  </body>
</html> 
```

据我所知，由于您使用的`click()`是特定于 IE 的，所以这个答案也是如此。事件在不同的浏览器中以不同的方式触发，但制作包装器并隐藏差异应该不会太难。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T06:27:32.207

它应该工作。尝试在单击第一个按钮后对第二个按钮进行 setTimeout 调用。这很丑陋，但也许它会起作用。

```
function clickButton() {
 document.getElementById('#button1').click();
 setTimeout(button2, 300);
}

function button2() {
 document.getElementById('#button2').click();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T06:22:08.923

他们都应该触发一个点击事件。如果您删除您的 ajax 请求和其他繁重的工作并在每个事件侦听器中放置一个警报或 console.log 会发生什么。哦，你是如何收听事件的？

# ruby - 突出显示文本字段值

> ID：851390
> 
> 赞同：0
> 
> 时间：2009-05-12T06:20:42.263
> 
> 标签：ruby

嗨，大家，我正在使用具有值的下拉列表，请指定其他时，当在提示字段中选择该值的文本字段，该值的textfield具有值，请指定其他，但要使用户在TextField中输入任何内容，他必须删除该值手动..我正在寻找一个可以在用户在文本字段中键入时自动删除值的代码..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T06:23:27.237

使用 jQuery，您可以制作文本框提示。更好的是，重用别人的代码：

[http://remysharp.com/2007/01/25/jquery-tutorial-text-box-hints/](http://remysharp.com/2007/01/25/jquery-tutorial-text-box-hints/)

示例：[http ://remysharp.com/wp-content/uploads/2007/01/input_hint.html](http://remysharp.com/wp-content/uploads/2007/01/input_hint.html)

# c++ - 从 C++ 文件中读取 X 行直到 Y 行

> ID：851391
> 
> 赞同：0
> 
> 时间：2009-05-12T06:20:52.030
> 
> 标签：c++, file, input

我有一个相对简单的问题。假设我有一个文件，但我只想访问文件的 X 行直到 Y 行，这样做最简单的方法是什么？

我知道我可以逐行阅读并保持计数，直到达到我实际需要的行，但是有更好更优雅的解决方案吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T06:24:05.457

在 C++ 中，不，不是真的（嗯，不是我熟悉的*任何语言，真的）。*

您必须从文件的开头开始，这样您才能确定第 X 行的开始位置（除非它是一个固定记录长度的文件，但对于文本来说不太可能）。

同样，您必须这样做，直到找到您感兴趣的最后一行。

如果您害怕缓冲区溢出漏洞，您可以读取字符而不是行，或者您可以读取固定大小的块并计算换行符以提高速度，但这一切都归结为读取和检查每个字符（通过您的代码显式或隐式语言库）来计算换行符。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T06:37:58.150

您可以使用 istream::ignore() 来避免缓冲不需要的输入。

```
bool skip_lines(std::istream &is, std::streamsize n)
{
  while(is.good() && n--) {
     is.ignore(std::numeric_limits<std::streamsize>::max(), '\n');
  }

  return is.good();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T06:24:09.403

搜索 \n X 次，开始“阅读”（无论需要什么处理），直到到达 YX \n 或 EOF。假设 unix 风格的新行。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T06:24:55.020

由于您必须确保每行内的结束行字符才能计算行数，因此您仍然需要遍历文件。我能想到的唯一优化不是逐行读取文件，而是缓冲它然后迭代计算行数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T00:58:06.933

使用 C 或 C++，存在一些可用于跳过文件中指定字节数的函数（在 stdio 中使用 fseek，在 istreams 和 ostreams 中使用 seekp）。但是，您不能指定给定的行数，因为每行可能有可变数量的字符，因此无法计算正确的偏移量。文件不是每行占据一个“行”的某种数组：您宁愿将其视为连续的内存空间（这里不是在谈论硬件......）

# c# - 如何为我的控件指定智能标签？

> ID：851394
> 
> 赞同：0
> 
> 时间：2009-05-12T06:21:53.230
> 
> 标签：c#, .net, asp.net, controls, smart-tags

如果我正在创建一个自定义 ASP.NET 控件（或者，我想是一个 Windows 窗体控件），我如何为其指定一个或多个智能标记，以及随之而来的行为？我想提供一些丰富的设计师支持。

编辑：更喜欢 C# 代码，但不是必需的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T06:24:16.597

看到[这个](http://www.devx.com/codemag/Article/32650/0/page/3)。

# java - 监控应用程序

> ID：851396
> 
> 赞同：1
> 
> 时间：2009-05-12T06:22:30.950
> 
> 标签：java

如何从 java 监控外部应用程序（如记事本/word/exce/媒体播放器..）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T06:27:47.073

如果您自己开始[`Runtime`](http://java.sun.com/j2se/1.4.2/docs/api/java/lang/Runtime.html)上课，您可能可以通过这种方式监控他们。

但是，如果它们是在您无法控制的范围内启动的，那么 WMI 就是我要走的路。

[Win32_Process](http://msdn.microsoft.com/en-us/library/aa394372(VS.85).aspx)类是您正在寻找的类，此[页面](http://www.dreamincode.net/code/snippet3297.htm)详细介绍了如何在 Java/JACOB（Java COM 桥）中执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T06:27:59.977

我不知道您所说的监控到底是什么意思，我猜您指的是 Windows 平台。这样做的唯一方法是使用 COM 接口。看看[JACOB 项目](http://danadler.com/jacob/)。

# eclipse - 根据选择的工作区更改 Eclipse 的图标

> ID：851402
> 
> 赞同：9
> 
> 时间：2009-05-12T06:24:00.107
> 
> 标签：eclipse, personalization

是否可以根据选择的工作区以某种方式更改 Eclipse 工作区的图标？我在不同的 Eclipse 实例中打开了多个工作区，并且识别起来变得很复杂。我尝试了显示位置的 location 参数，但它会根据 Package Explorer/Navigator 中的目录选择而变化。有小费吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T14:37:40.700

[在 Eclipse 中，使用产品扩展点](http://help.eclipse.org/ganymede/index.jsp?topic=/org.eclipse.platform.doc.isv/guide/product_def_extpt.htm)定义产品。除其他外，此扩展点定义了品牌图标。这些会影响 Windows 任务栏，以及 alt-tab 列表中的图标。

您可以做的是创建自己的插件来定义每个使用不同图标的新产品，然后这些产品可以运行常规的 eclipse 应用程序。您可以在命令行上切换产品。

产品扩展点是这样的：

```
 <extension id="my_product_1" point="org.eclipse.core.runtime.products">
      <product application="org.eclipse.ui.ide.workbench" name="My Product">
         <property name="windowImages" value="icons/sample2.gif" />
         <property name="appName"      value="My Product"/>
         <property name="aboutImage"   value="product_lg.gif"/>
         <property name="aboutText"    value="My Product"/>
      </product>
   </extension> 
```

您可以在同一个插件中创建多个，每个插件引用不同的图标。您可以通过使用 RCP 邮件模板创建新插件来查看示例。

您在命令行中使用“-product [plug-in id].[product-id]”来引用该产品。因此，您可以使用不同的命令行创建多个 Windows 快捷方式，指定不同的产品和工作区：

```
eclipse -product org.my.plugin.my_product_1 -data /path/workspace1
eclipse -product org.my.plugin.my_product_2 -data /path/workspace2 
```

在 Eclipse 3.3 及更早版本中，您只需将插件复制到 eclipse/plugins 目录中即可使用。在 3.5 中，在插件导出期间有一个“安装到主机”选项。在 3.4（和 3.5）中有 dropins 文件夹。

# c# - 如何为依赖于 SerialPort 的类编写单元测试？

> ID：851413
> 
> 赞同：10
> 
> 时间：2009-05-12T06:27:19.477
> 
> 标签：c#, unit-testing, mocking

我知道简短的答案是 Mocks，但任何例子都会很好。我需要能够测试以下内容：

1.  连接/断开
2.  以设定的时间间隔接收数据
3.  暂停数据传输，导致我的班级尝试重新连接
4.  测试事件是否按预期触发。

作为开始，我正在考虑定义一个接口，它将使用一个流，这将允许我简单地让我的类连接到任何流，我可以比串行端口更好地控制它，并允许我这样做以编程方式。如果有人有更好的主意，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-09-24T15:36:45.200

听起来您想执行集成测试而不是单元测试？

如果您的意思是单元测试，您可以：

1.  在串行端口周围创建一个包装器
2.  给包装器一个接口，也许是 IPort
3.  将此传递给需要 SerialPort 的类
4.  模拟传入的 SerialPost

* * *

```
internal interface IPort
{
   void Connect(); 
   //Other members
}

internal class SerialPort : IPort
{
   public void Connect() 
   {
      //Implementation
   }
}

public class DataRetriever
{
   private IPort _port;
   public DataRetriever(IPort port)
   {
       _port = port;
   }

   public void ReadData()
   {
      _port.Connect();
   }
} 
```

现在您可以测试 Data Retriever 类。不幸的是，当您接近框架（例如 SerialPort 包装器）时，您无法对其进行单元测试。您需要将其留给集成测试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T06:33:35.410

[http://en.wikipedia.org/wiki/COM_port_redirector](http://en.wikipedia.org/wiki/COM_port_redirector)列出了一些免费/开源的虚拟 COM 端口驱动程序/重定向器，它们对您的测试很有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T06:36:08.760

我已经成功使用了以下内容，但仅用于测试数据处理和内部计时。这无法应对 TestingClass 关闭/打开 SerialPort 本身。

```
 using (NamedPipeServerStream input = new NamedPipeServerStream("Test", PipeDirection.InOut))
        using (NamedPipeClientStream pipeClient = new NamedPipeClientStream("Test"))
        using (MemoryStream output = new MemoryStream())
        using (StreamReader inSerial = new StreamReader(pipeClient))
        using (StreamWriter outSerial = new StreamWriter(svpConsumer))
        {
            StartPipeServer(input);
            pipeClient.Connect();
            using (TestingClass myTest = new TestingClass(onSerial, outSerial))
            {
               input.Write(...);
               input.Flush(...);
               Assert on checking output
            }
        } 
```

在哪里：

```
 internal void StartPipeServer(NamedPipeServerStream pipeServer)
    {
        Thread thread = new Thread(WaitForConnections);
        thread.Start(pipeServer);
    }

    internal void WaitForConnections(object o)
    {
        NamedPipeServerStream pipe = (NamedPipeServerStream)o;
        pipe.WaitForConnection();
    } 
```

HTH，翻录

# java - 从另一个调用java程序

> ID：851414
> 
> 赞同：1
> 
> 时间：2009-05-12T06:27:29.540
> 
> 标签：java, integration, execution

如何从独立的 Java 程序调用 Java 命令。

我了解 Runtime.getRuntime().exec("cmd c/javac <>.java"); 会工作。但是，这将是特定于平台的。

任何其他可用的 API 可以使它在 j2sdk1.4 中工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T07:15:19.587

如果您可以在同一个 JVM 中运行所有内容，则可以执行以下操作：

```
public class Launcher {
    ...
    public static void main(String[] args) throws Exception {
        launch(Class.forName(args[0]), programArgs(args, 1));
    }

    protected static void launch(Class program, String[] args) throws Exception {
        Method main = program.getMethod("main", new Class[]{String[].class});
        main.invoke(null, new Object[]{args});
    }

    protected static String[] programArgs(String[] sourceArgs, int n) {
        String[] destArgs = new String[sourceArgs.length - n];
        System.arraycopy(sourceArgs, n, destArgs, 0, destArgs.length);
        return destArgs;
    } 
```

并使用如下命令行运行它：

```
java Launcher OtherClassWithMainMethod %CMD_LINE_ARGS% 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T08:25:43.560

调用 Runtime.getRuntime().exec() 不仅是特定于平台的，而且效率极低。它将导致产生一个全新的 shell 和整个 jvm，这可能会非常昂贵，具体取决于此应用程序的依赖关系（没有双关语）。

执行“外部”Java 代码的最佳方式是将其放在您的 CLASSPATH 中。如果您必须调用应用程序的 main 方法，您可以简单地导入并直接调用该方法。这可以这样做：

```
import my.externals.SomeMain

// call as if we are running from console
SomeMain.main(new String[] {"some", "console", "arguments"}) 
```

当然，最好的情况是简单地将其用作外部库并访问您需要的代码，而无需调用 SomeMain.main()。遵循最佳实践并编写适当的封装模块化对象可以在其他应用程序使用时实现更大的可移植性和易用性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T06:34:07.470

当您离开 JVM 并转向系统命令时，您必须自己处理特定于平台的命令。JVM 提供了一种很好的抽象方式，那么为什么要放弃呢？

如果要执行 java 特定的二进制文件，请查看 java 的 ant 库。您可以从执行平台相关命令的 java 执行 ant 脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-11-04T10:02:59.603

GAE 上来自 quercus php 的 Java 编程：

```
import com.newatlanta.commons.vfs.provider.gae.GaeVFS;
import org.apache.commons.io.IOUtils;
import java.lang.Long;
import java.lang.Boolean;
GaeVFS::setRootPath(quercus_servlet_request()->getSession(true)->getServletContext()->getRealPath('/'));
define('VFSM', GaeVFS::getManager());

//VFSM->resolveFile('gae://gaevfs')->createFolder();
$file=VFSM->resolveFile('gae://gaevfs/tmp1');
//$file->createFile();

$text='pp';
$method=$file->getClass()->getDeclaredMethod('updateContentSize', array(Long::TYPE, Boolean::TYPE));
$method->setAccessible(true);
$method->invoke($file, strlen($text), true);
$out=$file->getContent()->getOutputStream();
IOUtils::write($text, $out, 'UTF8');
$out->close();

$in=$file->getContent()->getInputStream();
$method=$file->getClass()->getDeclaredMethod('doGetContentSize',array());
$method->setAccessible(true);
$len=$method->invoke($file);
$whole=IOUtils::toString($in, 'UTF8').':'.$len."<br>";
$in->close();
echo $whole;

GaeVFS::clearFilesCache();
GaeVFS::close(); 
```

# python - Python 如何从 .egg 文件中导入模块？

> ID：851420
> 
> 赞同：19
> 
> 时间：2009-05-12T06:31:41.543
> 
> 标签：python, module, packages

我怎么能`__init__.pyc`在这里打开？

```
 >>> import stompservice
    <module 'stompservice' from 'C:\Python25\lib\site-packages\stompservice-0.1.0-py2.5.egg\stompservice\__init__.pyc'> 
```

我看到的`C:\Python25\lib\site-packages\`只是 .egg 文件，但是包的内部文件在哪里？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-19T10:54:35.457

例如，如果您想导入 .egg 文件形式的 suds 模块：

在您的 python 脚本中：

```
egg_path='/home/shahid/suds_2.4.egg'

sys.path.append(egg_path)

import suds
#... rest of code 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-05-12T06:35:16.127

[http://peak.telecommunity.com/DevCenter/PythonEggs](http://peak.telecommunity.com/DevCenter/PythonEggs)

.egg 文件只是重命名的 zip 文件。

使用您的 zip 程序打开 egg，或者只是将扩展名重命名为 .zip，然后解压缩。

# objective-c - 您将如何将 iChat 之类的群组功能添加到您的 Core Data 应用程序中？

> ID：851422
> 
> 赞同：-1
> 
> 时间：2009-05-12T06:32:13.900
> 
> 标签：objective-c, cocoa

我正在开发一个核心数据应用程序，并且想在我的应用程序中添加一个功能，例如 iChat 中的组功能。特征将显示在具有正常表行的表中，并且可以创建更多组。可以将表格的其他行拖到组中，并且可以折叠和打开组。我需要什么代码才能做到这一点，这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T08:42:04.233

查看[NSOutlineView](http://developer.apple.com/documentation/Cocoa/Reference/ApplicationKit/Classes/NSOutlineView_Class/Reference/Reference.html)。基本上，您需要的是两个不同的核心数据实体：`Group`和`Child`. 与对象`Group`有一对多关系 ,与一个实体有一对一关系 , 。`children``Child``Child``parent``Group`

这足以定义基本模型。除此之外，您需要进一步分解您的问题。例如，如何使用 Core Data 实现拖放？这已经回答了很多次了。如何在一个大纲视图中混合两种不同的实体类型？之前也回答过。将问题分解为每个单独的子任务并寻找答案——我敢打赌，他们中的大多数人在 Stack Overflow 上都有答案。

# java - G1 的 Android 设备更新

> ID：851426
> 
> 赞同：4
> 
> 时间：2009-05-12T06:33:54.537
> 
> 标签：java, android

我正在使用 android G1 手机，现在我已将我的 SDK 升级到 1.5，我想在物理设备上运行我的应用程序，但是当我将手机连接到 PC 时，我只能在选择 1.1 时安装我的应用程序SDK 但不是在选择 1.5 时。

那么设备是否需要任何更新，以便我可以继续使用 1.5 SDK？另外，如果可能的话，你能提供一个正确的链接吗？那太好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T06:39:42.267

您的手机更新将由您的运营商 OTA 推送，请稍候。如果是开发手机，请查看[HTC 页面](http://www.htc.com/www/support/android/adp.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-02T00:45:36.120

如果您在美国或英国，您可以在此处找到有关如何强制升级的[说明](http://www.androidcentral.com/how-manually-install-android-15-cupcake-us-version)。我在我的身上做了，一切顺利。

# c - 是否有任何 C 函数来获取目录权限？

> ID：851429
> 
> 赞同：0
> 
> 时间：2009-05-12T06:34:56.000
> 
> 标签：c, permissions

我正在尝试`ls`在不使用该`system`函数的情况下在 C 中实现该命令。

是否有 C 函数来获取目录/文件权限，以便我可以显示它们？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T06:40:55.867

stat() 系统调用接受一个文件名字符串并返回以下结构：

```
struct stat {
    dev_t     st_dev;     /* ID of device containing file */
    ino_t     st_ino;     /* inode number */
    mode_t    st_mode;    /* protection */
    nlink_t   st_nlink;   /* number of hard links */
    uid_t     st_uid;     /* user ID of owner */
    gid_t     st_gid;     /* group ID of owner */
    dev_t     st_rdev;    /* device ID (if special file) */
    off_t     st_size;    /* total size, in bytes */
    blksize_t st_blksize; /* blocksize for filesystem I/O */
    blkcnt_t  st_blocks;  /* number of blocks allocated */
    time_t    st_atime;   /* time of last access */
    time_t    st_mtime;   /* time of last modification */
    time_t    st_ctime;   /* time of last status change */
}; 
```

这同样适用于目录条目和文件，并且`st_mode`是您要查找的特定字段。

头`<sys/stat.h>`文件应包含该结构和所有定义以及`#defines`和/或用于智能解码字段的宏（请参阅[此处](http://opengroup.org/onlinepubs/007908775/xsh/sysstat.h.html)的示例）。

如果您对它的真正实现方式感兴趣，可以查看GNU [coreutils](http://ftp.gnu.org/pub/gnu/coreutils/)`ls`中的源代码。但只能用它来教育自己。它是 GPL，所以你不能仅仅为了自己的目的而抓住它，如果这是家庭作业，如果你提交的东西看起来太相似，你的教育工作者几乎肯定会让你失望。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T06:37:29.727

调查`[stat()](http://linux.die.net/man/2/stat)`。听起来您使用的是 Linux 或 POSIX 系统，所以应该这样。

然后查看 的`st_mode`字段`struct stat`，它包含有关保护位的信息，这些信息通常统称为文件的“模式”（如`chmod`更改设置的命令所反映的那样）。

从二进制位到像 ls' 这样的文本表示是……一个有趣的挑战。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T06:39:44.870

`stat`函数族 ( , [`stat()`](http://www.opengroup.org/onlinepubs/000095399/functions/stat.html), [`lstat()`](http://www.opengroup.org/onlinepubs/000095399/functions/lstat.html)) [`fstat()`](http://www.opengroup.org/onlinepubs/000095399/functions/fstat.html)。

# sockets - 哪些进程间通信方法适用于终端服务器？

> ID：851438
> 
> 赞同：3
> 
> 时间：2009-05-12T06:37:41.223
> 
> 标签：sockets, ipc, named-pipes, terminal-services, dde

在终端服务器会话中，某些标准 IPC 技术可能无法像在单用户环境中那样工作，因为所需的**资源没有被虚拟化**。

例如，TCP/IP 端口没有虚拟化，因此不同会话中的应用程序尝试侦听同一端口会导致端口冲突。

**在同一用户会话中运行的应用程序**需要交互的终端服务器环境中，哪种 IPC 技术可以工作？

*   消息（WM_COPYDATA）？
*   命名管道？
*   DDE？
*   内存映射文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-19T11:27:56.880

消息将正常工作。[DDE](http://msdn.microsoft.com/en-us/library/ms648775(VS.85).aspx)也会，因为它是基于消息的。[命名管道](http://msdn.microsoft.com/en-us/library/aa365783(VS.85).aspx)不会，因为它们是每个系统而不是每个会话。您也可以考虑 COM 或 OLE。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-06-13T00:01:49.067

所有 IPC 都可以在 TS 环境中使用——您只需巧妙地命名对象即可获得所需的最终结果。使用套接字比较棘手，但可以做到。我在下面列出了一些方法。

对于可以命名的 IPC 对象（管道、事件、互斥体、内存映射文件等），将会话 ID 合并到对象名称中将实现所需的*虚拟化*。要进一步锁定 IPC 对象，请使用对象的安全属性来阻止任何其他用户访问 IPC 对象的可能性。这可能是由于终端服务器上的错误或来自其他用户的恶意而意外发生的。

类似地，在 IPC 对象的名称中使用登录用户的身份验证 ID。在 C++ 中，请参阅[GetTokenInformation](http://msdn.microsoft.com/en-us/library/aa446671(VS.85).aspx)上的 MSDN，将 TokenStatistics 用于 TokenInformationClass。我确信有一个等效的.NET 方法。再次保护 IPC 对象。

如果您必须在 TS 上使用套接字（我个人会选择另一种方法在 TS 上的应用程序之间进行通信），然后使用端口号。选择一个基本端口号并添加会话号以获取用于会话的端口。为了确保正确的应用程序正在通信，请在传输数据之前使用身份验证方法和/或握手。从理论上讲，会话最多可以编号为 65535，因此当您使用 2000 的基本端口号并且会话您的应用程序在会话 65500 中运行时，您可能会遇到问题。如果您真的想使用套接字，那么代理服务可能会有所帮助。

# web-services - 底层连接已关闭：无法为 SSL/TLS 安全通道建立信任关系

> ID：851440
> 
> 赞同：1
> 
> 时间：2009-05-12T06:38:12.797
> 
> 标签：web-services

我有一个调用soap请求的网络服务。在 VS.NET 2008 中调试时，soap 请求成功。但是，当我部署它时，出现以下错误

基础连接已关闭：无法为 SSL/TLS 安全通道建立信任关系。

这一定是我需要更改的某种安全设置，但我不知道是什么？

我尝试使用以下方式部署代码：

System.Security.Cryptography.X509Certificates.X509Certificate cert = null; cert = new System.Security.Cryptography.X509Certificates.X509Certificate(); cert.Import("c:\customerCertFile.cer"); objRequest.ClientCertificates.Add(cert);

//WebProxy iBproxy = new WebProxy("196.2.124.252",true); WebProxy iBproxy = new WebProxy("192.1.1.1", true); iBproxy.Credentials = new NetworkCredential("username", "password"); objRequest.Proxy = iBproxy;

没运气。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T06:43:13.273

如果您尝试在本地 IIS 服务器上使用 SSL，则需要使用[makecert](https://stackoverflow.com/questions/496658/using-makecert-for-development-ssl)或类似工具使用自签名证书对其进行配置。

# sql - sql server 中的嵌套事务

> ID：851441
> 
> 赞同：6
> 
> 时间：2009-05-12T06:38:30.707
> 
> 标签：sql, sql-server, tsql, transactions

sql server 允许嵌套事务吗？如果是这样，那么事务的优先级是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-12T06:45:09.277

来自 SQL Server 上的 MSDN 文档。**[嵌套事务](http://msdn.microsoft.com/en-us/library/ms189336(SQL.90).aspx)**：

> SQL Server 数据库引擎会忽略提交内部事务。基于在最外层事务结束时采取的操作，事务要么被提交，要么被回滚。如果提交了外部事务，则也提交了内部嵌套事务。如果外部事务被回滚，那么所有内部事务也会被回滚，而不管内部事务是否被单独提交。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T07:52:54.737

只是为了限定这一点并直接回答问题，是的，SQL Server 确实允许嵌套事务。

ichiban 友情提供的引用参考，详细说明最外层事务的结果将决定是否提交嵌套事务。

# class - 我们可以在单元测试中使用多个模拟对象吗？

> ID：851452
> 
> 赞同：1
> 
> 时间：2009-05-12T06:42:58.687
> 
> 标签：class, unit-testing, user-interface, private, public

我读过很多关于单元测试的文章。大多数文章都说我们不应该在测试中使用多个模拟对象，但我不明白为什么。有时我们在测试中确实需要多个模拟对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T07:05:05.983

根据上下文，您可以在单元测试中拥有多个模拟。

但是我认为“文章”可能暗示的是

*   防止**过度嘲笑**。当一个单元测试模拟出所有的合作者时，你把门开着；当您替换真正的合作者时，该场景可能会失败。通过尽量减少模拟的数量并尽可能地使用真正的合作者，您可以最大限度地减少这种风险。
*   **高耦合**警报：如果您发现自己必须模拟许多协作者才能编写单元测试，这可能是一种设计气味，表明您具有高耦合。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T06:53:05.770

我不确定您指的是哪些文章，但对于被测类，我通常每个依赖项都有一个模拟对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T20:14:01.547

您应该根据需要添加尽可能多的模拟来隔离您的测试类。您需要为每个不应该成为测试一部分的依赖项进行模拟。

有时为了简单起见，您将两个或三个类放在一起进行测试，因为它们构建了类似于组件的东西并且高度耦合。其他一切都应该被嘲笑。

我知道这个“最佳实践”只有一个模拟并且也不理解它。在我们的单元测试中，我们有很多模拟，一些环境模拟是由我编写的测试框架设置的（例如 TransactionService、SecurityService、SessionService）。只有一件事需要考虑，正如 Gishu 在他的回答中已经提到的那样，许多模拟表明高度依赖。当它太多时，由你来考虑。我们有很多小接口，这需要在测试中进行很多模拟。

为了扭转你的答案，你不应该*在*以下情况下模拟依赖：

*   它是被测类的高度耦合部分，如内部类、私有类等。
*   它是一个常见的 .NET 框架类，如 Collection 等
*   您想编写一个集成测试来准确测试与该类的交互。（您仍然模拟其他所有内容，并且您仍然对每个涉及的类进行单独的单元测试。）
*   模拟某个课程太昂贵了。小心决定它太昂贵，模拟似乎很难设置，但与使用真实类的可维护性问题相比，它变得轻而易举。但是有些框架和技术没有针对接口实现，并且很难模拟。如果将此框架类放在您自己的接口后面太昂贵，您需要在测试中使用它们。

# objective-c - 使用对象容器中的标记填充 NSTokenField

> ID：851459
> 
> 赞同：2
> 
> 时间：2009-05-12T06:44:08.543
> 
> 标签：objective-c, cocoa, macos, tags, nstokenfield

我在一个窗口中有一个 NSTableView 和一个 NSTokenField 。我已经实现了以下委托方法：

```
tokenField:completionsForSubstring:indexOfToken:indexOfSelectedItem:
tokenField:representedObjectForEditingString:
tokenField:displayStringForRepresentedObject: 
```

我想这样做，以便当在其中选择一行时，NSTokenField 会填充包含在行对象的 NSMutableSet 中的标签。如果我有一个包含它们所代表的对象的容器（以及因此需要制作成标记的字符串），我如何用标记填充 NSTokenField？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T09:50:29.987

我想到了。在下面的代码中 ms 是一个包含我的对象的 NSMutableSet。

```
 //set the token field
        NSMutableArray *ma = [[NSMutableArray alloc] init];
        for (MyClass *anObject in ms){
            [ma addObject:anObject];
        }

        //sort the array
        NSSortDescriptor *sorter = [[NSSortDescriptor alloc] initWithKey: @"title" ascending: YES];
        NSArray *sortDescriptorArray = [[NSArray alloc] initWithObjects:sorter, nil];

        [ma sortUsingDescriptors:sortDescriptorArray];
        [tokenField setObjectValue:ma]; 
```

关键是最后一行：**[tokenField setObjectValue:ma];**

# hashmap - 使用数据库中的值填充枚举

> ID：851466
> 
> 赞同：28
> 
> 时间：2009-05-12T06:46:11.163
> 
> 标签：hashmap, enumeration, java

我有一个映射字符串-> 整数的表。

我不想静态创建枚举，而是想用数据库中的值填充枚举。这可能吗 ？

因此，而不是静态地对此进行处理：

```
public enum Size { SMALL(0), MEDIUM(1), LARGE(2), SUPERSIZE(3) }; 
```

我想动态创建这个枚举，因为数字 {0,1,2,3} 基本上是随机的（因为它们是由数据库的 AUTOINCREMENT 列自动生成的）。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2009-05-12T06:50:12.373

不，枚举总是在编译时固定的。您可以做到这一点的唯一方法是动态生成相关的字节码。

话虽如此，您可能应该弄清楚您真正感兴趣的枚举的哪些方面。大概您不想对`switch`它们使用语句，因为这意味着静态代码并且您不知道静态值。 .. 代码中的任何其他引用也是如此。

如果您真的只想要一个从`String`to的地图`Integer`，您可以使用`Map<String, Integer>`在执行时填充的 a ，然后就完成了。如果您想要这些`EnumSet`功能，以相同的效率重现它们会有些棘手，但通过一些努力可能是可行的。

因此，在进一步考虑实施之前，我建议您弄清楚您的真正需求是什么。

（编辑：我一直假设这个枚举是完全动态的，即您不知道名称，甚至不知道有多少值。如果名称集是固定的，您*只需*要从数据库中获取 ID ，这是一个非常不同的问题 - 见[安德烈亚斯的回答](https://stackoverflow.com/questions/851466/populate-an-enum-with-values-from-database/851506#851506)。）

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2009-05-12T07:01:00.920

这有点棘手，因为这些值的填充发生在类加载时。因此，您将需要对数据库连接的静态访问。

尽管我很重视他的回答，但我认为 Jon Skeet 这次可能错了。

看看这个：

```
public enum DbEnum {
    FIRST(getFromDb("FIRST")), SECOND(getFromDb("second"));

    private static int getFromDb(String s) {
        PreparedStatement statement = null;
        ResultSet rs = null;
        try {
            Connection c = ConnectionFactory.getInstance().getConnection();
            statement = c.prepareStatement("select id from Test where name=?");
            statement.setString(1, s);
            rs = statement.executeQuery();
            return rs.getInt(1);

        }
        catch (SQLException e) {
           throw new RuntimeException("error loading enum value for "+s,e);
        }
        finally {
            try {
                rs.close();
                statement.close();
            } catch (SQLException e) {
                //ignore
            }
        }
        throw new IllegalStateException("have no database");
    }

    final int value;

    DbEnum(int value) {
        this.value = value;
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-20T12:27:59.267

改进[Andreas 所做](https://stackoverflow.com/questions/851466/populate-an-enum-with-values-from-database/851506#851506)的，您可以将数据库的内容加载到地图中，以减少所需的数据库连接数。

```
public enum DbEnum {
    FIRST(getFromDb("FIRST")),
    SECOND(getFromDb("second"));

    private Map<String,Integer> map;
    private static int getFromDB(String s)
    {
        if (map == null)
        {
           map = new HashMap<String,Integer>();
           // Continue with database code but get everything and
           // then populate the map with key-value pairs.
           return map.get(s);
        }
        else {
            return map.get(s); }
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-12T06:50:44.540

枚举不是动态的，所以简短的回答是你不能这样做。

另请查看 Stack Overflow 问题*[Dynamic enum in C#](https://stackoverflow.com/questions/725043)*。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T07:09:16.053

您需要在代码中复制数据库中的内容（反之亦然）。有关一些好的建议，请参阅此[问题](https://stackoverflow.com/questions/229856/ways-to-save-enums-in-database)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T06:57:14.157

在我知道的所有语言中，枚举都是静态的。编译器可以对它们进行一些优化。因此，简短的回答是否定的，你不能。

问题是为什么要以这种方式使用枚举。你能指望什么？或者换句话说，为什么不使用集合呢？

# jquery - 在 Delphi 的 TWebBrowser 中拥有 jQuery UI 框架

> ID：851475
> 
> 赞同：8
> 
> 时间：2009-05-12T06:51:20.983
> 
> 标签：jquery, delphi, jquery-ui, browser

我正在开发一个应用程序，许多 UI 元素将位于 TWebBrowser 中。所以我想我添加一个 jQuery UI 来方便我。

[感谢http://www.jasontpenny.com/blog/2008/11/21/jquery-in-a-twebbrowser-in-a-self-contained-delphi-app/](http://www.jasontpenny.com/blog/2008/11/21/jquery-in-a-twebbrowser-in-a-self-contained-delphi-app/)，我能够插入 JQuery 和 UI javascript 文件

我被困在样式表上，我做到了

```
 doc2 := Web.Document as IHTMLDocument2;
  doc2.createStyleSheet(FileProtocol(AppPath( 'templates\css\' + JQueryUITheme + '\jquery-ui-1.7.1.custom.css')), 0);
  // FileProtocol and AppPath are to return a current application path and converted to FileProtocol URL format. 
```

Javascripts 运行良好，但我无法让图像工作。我也尝试 StringReplace 所有图像引用，但没有结果。

```
 stylesheet.cssText := StringReplace(stylesheet.cssText,
    'url(images/','url(' + FileProtocol(AppPath('templates/css/' +
    JQueryUITheme + '/images/')), [rfReplaceAll]); 
```

有人尝试过类似的东西吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-13T03:55:48.263

运行快速测试，这似乎有效。

您确定 FileProtocol() 和 AppPath() 正常工作吗？

这些似乎对我有用：

```
function FileProtocol(const s: String): String;
begin
   Result := 'file:///' + StringReplace(s, '\', '/', [rfReplaceAll]); // '
end;

function AppPath(const s: String): String;
begin
   Result := IncludeTrailingPathDelimiter( ExtractFilePath(Forms.Application.ExeName) ) + s;
end; 
```

**[更新]**

我从主页下载链接 [ [Current (stable)](http://jqueryui.com/download/jquery-ui-1.7.1.custom.zip) ] 下载了 JQuery UI，并从[http://jqueryui.com/demos/progressbar/#animated](http://jqueryui.com/demos/progressbar/#animated)

参见 GitHub 上的演示项目：[http://github.com/jasonpenny/democode/tree/057f0ad22fc5c3272909de346b6e67b0444d8981/JQueryUIProgBar](http://github.com/jasonpenny/democode/tree/057f0ad22fc5c3272909de346b6e67b0444d8981/JQueryUIProgBar)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:49:28.173

你的 HTML 有`<base href="" />`标签吗？因为看起来相对路径已经破产了。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-05-31T11:37:03.670

访问 CGDevTools，他们有一个用于 Intraweb 的 jQuery 组件套件。

# iphone - 如何判断我的视图控制器是否可见并接受事件？

> ID：851476
> 
> 赞同：3
> 
> 时间：2009-05-12T06:51:31.077
> 
> 标签：iphone

我有一个观点，当它的数据发生变化时我会告诉我要更新。但有时当视图不可见时数据会发生变化。那么如何检测视图控制器是否可见并接受事件呢？我可以添加一个在 viewWillAppear 和 viewWillDisappear 中更改的布尔值，但似乎应该有一种方法可以直接检测状态......

谢谢，加里

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-12T15:53:16.790

简短回答：如果您使用的是 UINavigationController，则可以使用它的 visibleViewController，这样您就不必跟踪单独的布尔值。

长答案：通常当​​我发现自己在 viewWillAppear 中调用 reloadData 时，这表明我的视图需要观察我的模型的一些额外部分。reloadData 的问题在于它会重新加载整个表。很多时候，你真的只需要更新表的一小部分。我的策略通常是只更新我需要的内容，无论当时是否可见特定视图。我知道这是一个非常模糊的回应......也许你的一些示例代码会帮助我更具体......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T08:00:54.300

如果它是一个表格视图，您可以执行以下操作：

```
[(UITableView *)[self view] reloadData]; 
```

在 viewController 的 viewWillAppear 中。我不确定，这就是你要问的，但无论如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T10:07:32.253

您可能可以检查视图的窗口属性：

```
- (BOOL)isVisible
{
  return view.window != NULL;
} 
```

但我认为保持一个`BOOL`变量更好。

# visual-studio-2008 - Visual Studio 2008 一打开就退出

> ID：851477
> 
> 赞同：0
> 
> 时间：2009-05-12T06:52:00.437
> 
> 标签：visual-studio-2008

我的 Visual studion 2008 有问题。我一打开它就会退出。我尝试了这些选项， devenv /ResetSettings devenv /SafeMode devenv /resetuserdata devenv /resetskippkgs

即使我尝试重新安装 Visual Studion 2008。有什么办法可以解决这个问题。

谢谢你。普拉尚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T14:53:35.863

创建一个新的用户帐户并尝试使用它来确定问题是由于您的用户环境还是系统范围的问题。如果新用户没有出现这种情况，请清除您的常规用户设置：

```
rd /s /q %USERPROFILE%\AppData\Local\Microsoft\VisualStudio
rd /s /q %USERPROFILE%\AppData\Local\Microsoft\VSCommon
rd /s /q %USERPROFILE%\AppData\Roaming\Microsoft\VisualStudio 
```

（对于 XP，用“本地设置”和“应用程序数据”替换“AppData\Local”和“AppData\Roaming”）

```
Windows Registry Editor Version 5.00

[-HKEY_CURRENT_USER\Software\Microsoft\VisualStudio]
[-HKEY_CURRENT_USER\Software\Microsoft\VSCommon] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T06:54:30.913

什么操作系统？如果您使用的是 Vista，请尝试在管理模式下运行 devenv，看看会发生什么。

# logging - 如何在不破坏新旧数据关系的情况下匿名化新日志记录？

> ID：851481
> 
> 赞同：2
> 
> 时间：2009-05-12T06:53:46.440
> 
> 标签：logging, foreign-keys, privacy

我正在生成有关用户操作的日志记录。出于隐私原因，这些需要在 N 天后匿名。但是，我还需要针对这些匿名数据运行报告。

我希望真实用户 A 的所有操作都列在匿名日志中的假用户 X 下 - 一个用户的记录必须仍然是日志中一个（假）用户的记录。这显然意味着我需要在真实用户和虚假用户之间进行一些映射，我在匿名新记录时使用它。当然，这完全违背了匿名化的意义——如果有映射，则可以恢复原始用户数据。

例子：

> 用户 Frank Müller 买了 3 罐汤。
> 
> 三天后，用户 Frank Müller 要求退款 3 罐汤。

当我匿名化第二个日志条目时，第一个已经被匿名化了。我仍然希望两个日志记录都指向同一个用户。嗯，这在实践中对我来说似乎几乎是不可能的，所以我想使用一些拆分数据的方法，希望能让我在数据中保持尽可能多的完整性。也许将日志用作数据仓库 - 将所有内容分解为事实并接受某些维度无法分析的事实？

你以前遇到过这样的场景吗？我在这里有什么选择？我显然需要做出某种妥协——什么对你有效？如何充分利用这些数据？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T08:33:55.840

冒着迂腐的风险，你描述的不是*匿名*数据，而是*假名*数据。也就是说，您是否考虑过使用某种键控散列函数（例如[HMAC-SHA1](http://en.wikipedia.org/wiki/HMAC)）来执行假名生成？您可以通过以下方案达成公平妥协：

*   分离您的分析和 OLTP 数据库。尽量减少可以同时访问两者的人数。
*   将 HMAC 密钥保留给将数据复制到分析数据库的应用程序私有，不能从任一数据库访问。也许让应用程序在安装时生成它并使用硬编码的密钥对其进行混淆，这样系统管理员和软件开发人员都不会发现在没有串通的情况下获得它是微不足道的。
*   不要从 OLTP 数据库中复制真实姓名和地址*或任何等效或易于链接的键，例如用户编号、发票编号等，而不对其进行散列处理。*

如果这样做，则有两种主要的攻击途径可以从假名中获取真实身份。

*   直接攻击：获取 HMAC 密钥，计算每个已知用户的假名，并在结果表中反向查找。（HMAC 是不可逆的：只给定一个假名和密钥，您无法获得原始值。）
*   信息融合攻击：在不知道密钥和身份列表的情况下，下一个最好的方法就是尝试将假名数据与其他数据相关联——甚至可能是 OLTP 数据库的被盗副本。

[众所周知](https://arxiv.org/abs/cs/0610105)，假名数据集容易受到信息融合攻击——您必须剥离或“模糊”许多关键的相关信息才能使数据集抵抗此类攻击，但究竟需要剥离多少是[当前的话题研究](https://arxiv.org/abs/0801.1715)。

# performance - ssl 对 web 服务器的影响

> ID：851483
> 
> 赞同：0
> 
> 时间：2009-05-12T06:53:53.553
> 
> 标签：performance, web, openssl, ssl

我们中的许多人都有使用纯 TCP 的 Web 和应用程序服务器。

我们中的一些人拥有使用 SSL 等安全层的 Web 和其他服务器。

我对 SSL 的理解是，握手的计算量非常大，并且持续连接的加密（相对）便宜。

我的假设让你更正：一个普通的主机箱（以及关于云主机的平均信息也很酷）可能很容易被 AES 加密数据包饱和其网络连接，但很难做到一千个每秒 RSA 握手次数。对于服务器而言，使用证书进行客户端身份验证也比匿名客户端昂贵得多。

SSL 的每秒会话设置数有哪些经验法则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T07:12:32.023

为什么不只是测量？它将为您提供有关您正在使用的确切软件和硬件的真实数字。您还可以衡量服务器基础架构更改的影响（添加更多设备、SSL 加速器、调整参数等）。

你是对的，你很难在一个盒子上达到每秒一千次 SSL 握手。事实上，我会说这可能是不可能的。每秒几十个，不是问题。一千，不是没有很多$$$。

您也可能并不需要每秒 1000 次握手。这相当多，而且您已经需要相当多的流量才能需要类似的东西：请参阅：[我需要什么 SSL TPS 性能？](http://lbwiki.com/index.php/What_do_I_need_in_SSL_TPS_Performance%3F)

请记住，通常您不会一直进行新的 SSL 握手。浏览器只进行一次握手，并在多次请求和/或页面浏览时保持连接打开，因此您每秒握手的需求可能比您想象的要低得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T07:17:30.597

正如 Ville 所说，没有真正的选择可以在您的配置上进行尝试。但是不要小看建立链接后数据的对称加密。它可能更便宜，但如果您要通过加密通道下载大量数据，则可能比初始协商花费更多。

因此，为此您必须为您的网站的使用构建一个通用场景，然后进行压力测试。

# java - java.lang.Integer 的 Java 反序列化 - 异常

> ID：851491
> 
> 赞同：0
> 
> 时间：2009-05-12T06:57:27.133
> 
> 标签：java, serialization, integer

反序列化 a 时收到以下异常`HashMap<String, Integer>`：

```
java.io.InvalidClassException: java.lang.Integer; 本地类不兼容：stream classdesc serialVersionUID = 1360826667802527544，本地类serialVersionUID = 1360826667806852920
```

在同一台机器上使用相同的 JRE 进行序列化和反序列化。JDK 1.6.0_12

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T07:18:55.493

通过查看 JDK 源代码，1360826667806852920 是正确`serialVersionUID`的`Integer`. 我无法使用`serialVersionUID`1360826667802527544 在 JDK 中找到任何类。

有趣的是，在 Google 上搜索 1360826667802527544 时发现了一些其他人遇到了这个问题，尤其是Sun 论坛上的[这个帖子。](http://forum.java.sun.com/thread.jspa?threadID=479051&messageID=2228486)那里的问题是这个人将字节存储在一个字符串中，并且序列化的数据被破坏了。由于您得到了相同的`serialVersionUID`结果，因此您很可能遇到了类似的问题。

永远不要将字节存储在`String`. 使用字节数组或设计用于保存字节而不是字符的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T07:11:42.993

检查 Integer 的源代码，这是我在几个 java 版本中对 Integer 的代码：

```
/** use serialVersionUID from JDK 1.0.2 for interoperability */
private static final long serialVersionUID = 1360826667806852920L; 
```

所以我会说问题来自你的一类，你在序列化和反序列化之间进行了更改，并且没有特定的serialVersionUID ...

也许你应该看看[这个](http://forums.sun.com/thread.jspa?threadID=479051&messageID=2228486)，同样的问题描述，它看起来像错误的序列化/反序列化代码......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T07:13:11.243

那不应该发生。请注意，ID 仅在最后几位数字上有所不同；第二个是我在我的 JDK 源代码中看到的那个。

我的猜测是序列化流以某种方式损坏了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-05-11T15:27:05.937

我遇到了同样的问题，这是因为当我们尝试将 Integer 对象存储到 String 时，字符编码变得混乱，并且在反序列化时 serialVersionUID 读取是错误的。这就是这个错误的根本原因。为避免此错误，请在将其存储到 String 之前 使用**Base64** **编码。**[看到这个答案](https://stackoverflow.com/a/134918/3661654)，问题就为我解决了。

```
 /** Read the object from Base64 string. */
   private static Object fromString( String str ) throws IOException, ClassNotFoundException {
        byte [] data = Base64.getDecoder().decode(str);
        ObjectInputStream ois = new ObjectInputStream(new ByteArrayInputStream(data));
        Object o = ois.readObject();
        ois.close();
        return o;
   }

    /** Write the object to a Base64 string. */
    private static String toString( Serializable o ) throws IOException {
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ObjectOutputStream oos = new ObjectOutputStream( baos );
        oos.writeObject( o );
        oos.close();
        return Base64.getEncoder().encodeToString(baos.toByteArray()); 
    } 
```

# mysql - 使用 .netcf 2.0 从 POcket pc 应用程序连接 Mysql

> ID：851492
> 
> 赞同：0
> 
> 时间：2009-05-12T06:57:47.040
> 
> 标签：mysql, database, compact-framework, pocketpc, database-connectivity

我们正在使用 .netcf 2.0 中的 C# 在 PDA 中开发一个订单接收系统。所以我们有 mysql 服务器作为我们的后端。网络服务是连接 mysql 和 PDA 的唯一方法吗？还是有其他可用的方法..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-14T14:06:22.343

MySql 网站上有一个 .netcf 连接器可供下载。我建议使用版本 5.2.7 并且不要忘记将 "pooling=false" 放入连接字符串，否则连接将失败并出现异常 "MissingManifestResourceException" 。

连接字符串示例：“Persist Security Info=False;database=DATABASE_NAME;server=SERVER_IP_ADDRESS;user id=USERNAME_TO_LOGON;Password=PASSWORD; **pooling=false** ”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T07:24:38.790

我不相信 Compact Framework 中有 MySQL 的数据提供者。

我建议您阅读[移动应用程序架构指南](http://blogs.msdn.com/jmeier/archive/2008/11/24/mobile-application-architecture-pocket-guide.aspx)，尤其是数据层一章，看看您有哪些选择。

# charts - 在条形图中的每个条形中提供链接和标记 [label]

> ID：851495
> 
> 赞同：0
> 
> 时间：2009-05-12T06:59:14.853
> 
> 标签：charts, dojo

我最近开始研究道场。我在以下情况下遇到问题。

1.  如何在条形图中的每个条形中提供唯一链接（href）？当用户点击一个栏或标签时，他应该被带到一个相关的 jsp/html 页面。基本上，我正在寻找一个可点击的栏或工具提示。

此代码不起作用，因为它将被呈现为特殊字符。

```
 chart2.addAxis("y", {
        vertical: true, 
        fixLower: "none", 
        fixUpper: "none", 
        natural: true,
        majorTick: { length: 3 },
           labels: [{value: 1, text: <a href="url">Link text</a> }, ...]
    });

<div id="chart2" style="height: 100px;">
<div style="margin: 0px; padding: 0px; ...">
<div style="margin: 0px; padding: 0px; ... ">Link&nbsp;text</div> //label
</div>
... 
```

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-07-10T03:40:34.893

不幸的是，目前还无法使用`dojox.charting`.

FWIW，有一个很好的例子说明你可以`dojox.charting`在[SitePen 做什么。](http://www.sitepen.com/blog/2009/04/01/stocker-advanced-dojo-made-easy/)

# iphone - 如何在不使用 UITableView 上的自定义单元格的情况下添加按钮？

> ID：851498
> 
> 赞同：2
> 
> 时间：2009-05-12T06:59:32.950
> 
> 标签：iphone, cocoa-touch, uitableview

如何在 a 上添加自定义按钮`UITableViewCell`，然后在不使用 Interface Builder 和自定义单元格的情况下删除带有该按钮的单元格？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-14T06:17:25.920

如果您真的想添加自定义按钮而不进行子类化，只需将按钮添加到单元格的 contentView 中：

```
[cell.contentView addSubview:customButton]; 
```

您可以设置按钮的所有特性：框架、目标、选择器等......然后使用上面的调用将其添加到单元格中。

```
UIButton *customButton = [UIButton buttonWithType:UIButtonTypeCustom];
customButton.frame=//whatever
[customButton setImage:anImage forState:UIControlStateNormal];
[customButton setImage:anotherImage forState:UIControlStateHighlighted];
[customButton addTarget:self action:@selector(delete) forControlEvents: UIControlEventTouchUpInside];
//yadda, yadda, ..... 
```

你也可以标记它

```
customButton.tag = 99999; 
```

所以你可以稍后找到它：

```
UIButton *abutton = (UIButton*) [cell.contentView viewWithTag:99999]; 
```

您将需要决定何时添加按钮，可能是在单元格选择中，可能是在编辑模式中......只需将代码放在您选择的委托方法中即可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T07:55:48.163

如果按钮的唯一目的是提供删除，您应该查看`UITableViewDataSource`哪个有一个名为`- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath`. 像这样实现它：

```
 - (BOOL)tableView:(UITableView *)tableView 
canEditRowAtIndexPath:(NSIndexPath *)indexPath 
{ 
   return YES; 
} 
```

然后实现：

```
 - (void)tableView:(UITableView *)tableView 
commitEditingStyle:(UITableViewCellEditingStyle)editingStyle 
 forRowAtIndexPath:(NSIndexPath *)indexPath 
{
   // Database removal code goes here...
} 
```

要使用这些方法，让您通过执行以下操作来`UITableViewController`实现`UITableViewDataSource`协议：

```
MyClass : UITableViewController <UITableViewDataSource> 
```

在你的头文件中，一定要记住将 viewController 的数据源设置为`self`.

# uml - Holocentric - 有人用它来建模吗？

> ID：851500
> 
> 赞同：0
> 
> 时间：2009-05-12T06:59:51.093
> 
> 标签：uml

本质上是一个简单的民意调查......在谷歌搜索 Holocentric 几乎没有发现产品的使用情况。有人用过吗？有什么好处吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-19T02:50:15.170

他们是一家澳大利亚公司，我相信他们的大部分销售都在澳大利亚，我只见过该产品在各种澳大利亚政府组织中使用，似乎很受欢迎。一般来说，它最终往往被更多地用作业务建模工具而不是设计工具。

虽然它确实支持 UML，但它并不擅长它。

# vb.net - 在 VB6 代码中处理 VB.NET 事件

> ID：851501
> 
> 赞同：4
> 
> 时间：2009-05-12T06:59:58.287
> 
> 标签：vb.net, debugging, events, vb6

我有一些 VB6 代码实例化一个类，该类处理从 VB.NET 组件引发的事件。VB6 非常简单：

```
private m_eventHandler as new Collection

...

public sub InitSomething()
  dim handler as EventHandler

  set handler = new EventHandler
  m_eventHandler.Add handler
  ...
  m_engine.Start

end sub 
```

请注意，事件处理程序对象必须超出 init 方法的范围（这就是它存储在 Collection 中的原因）。另请注意，这 `m_engine.Start`表示程序中 VB.NET 组件将开始引发事件的点。

实际的事件处理程序（根据要求）：

```
Private WithEvents m_SomeClass As SomeClass
Private m_object as Object
...

Private Sub m_SomeClass_SomeEvent(obj As Variant)
    Set obj = m_object
End Sub 
```

请注意，在创建`m_object`实例时初始化`EventHandler`。

引发事件的 VB.NET 代码更简单：

```
Public ReadOnly Property SomeProp() As Object
    Get
        Dim obj As Object
        obj = Nothing
        RaiseEvent SomeEvent(obj)
        SomeProp = obj
    End Get
End Property 
```

我的问题是，当我**调试**VB6 程序时，第一次`InitSomething`被调用，事件**不会**被处理（VB6 事件处理程序永远不会进入）。随后的调用`InitSomething`确实有效。

当我在调试器之外运行程序时，一切都按照我的预期工作。在这一点上，我什至不确定这是否是我应该担心的事情。

它可能相关也可能不相关，但 VB.NET 是使用 Visual Studio 代码转换工具从 VB6 转换而来的（随后手动清理）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-17T23:56:52.823

我发现，如果您在 VB6（或任何其他 COM 环境）中编写用于消费的 .Net 组件，那么接口的使用绝对是至关重要的。

VStudio 开箱即用的 COM 模板还有很多不足之处，尤其是当您试图让事件工作时。

这是我用过的。

```
Imports System.Runtime.InteropServices
Imports System.ComponentModel

<InterfaceType(ComInterfaceType.InterfaceIsDual), Guid(ClientAction.InterfaceId)> Public Interface IClientAction
        <DispId(1), Description("Make the system raise the event")> sub SendMessage(ByVal theMessage As String)
    End Interface

    <InterfaceType(ComInterfaceType.InterfaceIsIDispatch), Guid(ClientAction.EventsId)> Public Interface IClientActionEvents
        <DispId(1)> Sub TestEvent(ByVal sender As Object, ByVal e As PacketArrivedEventArgs)
    End Interface

    <ComSourceInterfaces(GetType(IClientActionEvents)), Guid(ClientAction.ClassId), ClassInterface(ClassInterfaceType.None)> _
    Public Class ClientAction
        Implements IClientAction

        Public Delegate Sub TestEventDelegate(ByVal sender As Object, ByVal e As PacketArrivedEventArgs)

        Public Event TestEvent As TestEventDelegate

    public sub New()
        //Init etc
    end sub

    public sub SendMessage(theMessage as string) implements IClientAction.SendMessage
        onSendMessage(theMessage)
    end sub 

        Protected Sub onSendMessage(message as string)
            If mRaiseEvents Then
                RaiseEvent TestEvent(Me, New PacketArrivedEventArgs(theMessage))
            End If
        End Sub

    end Class 
```

我已经能够让程序集/组件的 COM 和 .Net 消费者与事件一起正常工作，并能够在组件内外进行调试。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T13:43:28.680

只是尝试一下-我对“ As New ..”有一种与生俱来的不信任

你能试一下吗

```
private m_eventHandler as Collection

public sub InitSomething()
  dim handler as EventHandler

  set handler = new EventHandler

  If m_eventHandler Is Nothing Then
    Set m_eventHandler = New Collection
  End if

  m_eventHandler.Add handler
 ...

  m_engine.Start

end sub 
```

唉，我不知道为什么这在正常执行中有效，而不是在调试中，除了一些模糊的怀疑，它与 .NET 无法实例化 VBA.Collection 对象有关（MS 建议您编写一个快速的 VB6 组件来做所以），但是由于您不是在 .NET 代码中创建集合，所以它仍然只是一个模糊的怀疑。

# nhibernate.search - 使用 Lucene.Net 进行 NHibernate 搜索的示例项目

> ID：851504
> 
> 赞同：2
> 
> 时间：2009-05-12T07:00:38.783
> 
> 标签：nhibernate.search

是否有任何使用 Lucene Dotnet 的 Asp Dotnet 项目示例

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-20T16:34:33.570

[我个人是LINQ to Lucene 项目](http://linqtolucene.codeplex.com/)的忠实粉丝。

它并没有满足我们的所有要求，但是有了可用的源代码，可以快速进行调整。

可以在[Hacky Hacky找到一个易于遵循的简单使用示例](http://vijay.screamingpens.com/archive/2008/07/21/linq-amp-lambda-part-4-lucene.net.aspx)

此外，在 Code Project 上进行快速搜索将很快向您展示 Lucene.net 的众多用途。虽然它们通常不是开箱即用的 ASP.NET 项目；稍加调整，您应该能够在 webform 项目中使用许多库。

一篇很棒的入门文章可以在[Introducing Lucene.Net](http://www.codeproject.com/KB/library/IntroducingLucene.aspx)中找到。

# c# - 在加载到树视图时过滤 XML 标记

> ID：851507
> 
> 赞同：0
> 
> 时间：2009-05-12T07:01:30.107
> 
> 标签：c#, .net, xml, treeview

我正在尝试将 XML 文件加载到树视图控件中，对其进行编辑并将其保存为不同的 XML 格式。

```
<MyConfig>
  <description>
    <![CDATA[Add All config data]]>
  </description>
  <group name="Server">
    <description>
      <![CDATA[Server info]]>
    </description>
    <parameter name="Host" type="string">
      <description>
        <![CDATA[Host Name]]>
      </description>
      <value>cccc.ac.lk</value>
    </parameter>
    <parameter name="Port" type="integer">
      <description>
        <![CDATA[port no]]>
      </description>
      <range>0-65536</range>
      <value>47110</value>
    </parameter>
  </group>
</MyConfig> 
```

我正在使用以下方法加载 XML 数据

```
private void populateTreeControl(System.Xml.XmlNode document, 
System.Windows.Forms.TreeNodeCollection nodes)
{
  foreach (System.Xml.XmlNode node in document.ChildNodes)
  {
    string text = (node.Value != null ? node.Value : 
      (node.Attributes != null && node.Attributes.Count > 0) ? 
        node.Attributes[0].Value : node.Name);
    TreeNode new_child = new TreeNode(text);
    nodes.Add(new_child);
    populateTreeControl(node, new_child.Nodes);
  }
} 
```

现在我想过滤掉一些节点并将其加载到树视图中。例如，在上述情况下加载描述标签等对我来说是没有用的。我只想用 MyConfig --> Group --> Server---> Host 和 MyConfig --> Group --> Server---> Port 创建树

**我应该如何修改 populateTreeControl() 方法来获得这个？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T07:20:06.567

```
private void populateTreeControl(
  System.Xml.Node context, 
  System.Windows.Forms.TreeNodeCollection treeNodes,
  List<string> xpath,
  int depth
)
{
  if (xpath.Count > depth) {
    foreach (System.Xml.XmlNode xmlNode in context.SelectNodes(xpath[depth]))
    {
      string text = "";
      if (xmlNode.Value != null) 
        text = xmlNode.Value;
      else if (xmlNode.Attributes.Count > 0)
        text = xmlNode.Attributes[0].Value;
      else 
        text = xmlNode.Name;

      TreeNode new_child = new TreeNode(text);
      treeNodes.Add(new_child);

      populateTreeControl(xmlNode, new_child.Nodes, xpath, depth + 1);
    }
  }
} 
```

称为

```
List<string> xpath = new List<string>();
xpath.Add("/MyConfig/group/[@name='Server']");
xpath.Add("parameter[@name='Host' or @name='Port']");

populateTreeControl(xmlDoc, tree.Nodes, xpath, 0); 
```

# javascript - 如何生成tinymce到ajax生成的textarea

> ID：851508
> 
> 赞同：0
> 
> 时间：2009-05-12T07:04:32.817
> 
> 标签：javascript

我有一个图像多上传器脚本，每个上传的项目在提交之前都是第一次预览，每个图像都有其以下文本区域，这些文本区域也是由 JavaScript 生成的。我想对 ajax 生成的每个文本区域使用 tinymce 编辑器。

这是我的脚本：

```
function fileQueueError(file, errorCode, message) {
    try {
        var imageName = "error.gif";
        var errorName = "";
        if (errorCode === SWFUpload.errorCode_QUEUE_LIMIT_EXCEEDED) {
            errorName = "You have attempted to queue too many files.";
        }

        if (errorName !== "") {
            alert(errorName);
            return;
        }

        switch (errorCode) {
        case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:
            imageName = "zerobyte.gif";
            break;
        case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:
            imageName = "toobig.gif";
            break;
        case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:
        case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:
        default:
            alert(message);
            break;
        }

        addImage("images/" + imageName);

    } catch (ex) {
        this.debug(ex);
    }

}

function fileDialogComplete(numFilesSelected, numFilesQueued) {
    try {
        if (numFilesQueued > 0) {
            this.startUpload();
        }
    } catch (ex) {
        this.debug(ex);
    }
}

function uploadProgress(file, bytesLoaded) {

    try {
        var percent = Math.ceil((bytesLoaded / file.size) * 100);

        var progress = new FileProgress(file,  this.customSettings.upload_target);
        progress.setProgress(percent);
        if (percent === 100) {
            progress.setStatus("Creating thumbnail...");
            progress.toggleCancel(false, this);
        } else {
            progress.setStatus("Uploading...");
            progress.toggleCancel(true, this);
        }
    } catch (ex) {
        this.debug(ex);
    }
}

function uploadSuccess(file, serverData) {
    try {
        var progress = new FileProgress(file,  this.customSettings.upload_target);

        if (serverData.substring(0, 7) === "FILEID:") {

            addRow("tableID","thumbnail.php?id=" + serverData.substring(7),file.name);
            //setup();
            //generateTinyMCE('itemdescription[]');
            progress.setStatus("Thumbnail Created.");
            progress.toggleCancel(false);
        } else {
            addImage("images/error.gif");
            progress.setStatus("Error.");
            progress.toggleCancel(false);
            alert(serverData);

        }

    } catch (ex) {
        this.debug(ex);
    }
}

function uploadComplete(file) {
    try {
        /*  I want the next upload to continue automatically so I'll call startUpload here */
        if (this.getStats().files_queued > 0) {
            this.startUpload();
        } else {
            var progress = new FileProgress(file,  this.customSettings.upload_target);
            progress.setComplete();
            progress.setStatus("All images received.");
            progress.toggleCancel(false);
        }
    } catch (ex) {
        this.debug(ex);
    }
}

function uploadError(file, errorCode, message) {
    var imageName =  "error.gif";
    var progress;
    try {
        switch (errorCode) {
        case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:
            try {
                progress = new FileProgress(file,  this.customSettings.upload_target);
                progress.setCancelled();
                progress.setStatus("Cancelled");
                progress.toggleCancel(false);
            }
            catch (ex1) {
                this.debug(ex1);
            }
            break;
        case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:
            try {
                progress = new FileProgress(file,  this.customSettings.upload_target);
                progress.setCancelled();
                progress.setStatus("Stopped");
                progress.toggleCancel(true);
            }
            catch (ex2) {
                this.debug(ex2);
            }
        case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:
            imageName = "uploadlimit.gif";
            break;
        default:
            alert(message);
            break;
        }

        addImage("images/" + imageName);

    } catch (ex3) {
        this.debug(ex3);
    }

}

function addRow(tableID,src,filename) 
{  
    var table           = document.getElementById(tableID);  

    var rowCount        = table.rows.length;  
    var row             = table.insertRow(rowCount);  
        rowCount + 1;
        row.id              = "row"+rowCount;
    var cell0           = row.insertCell(0);
        cell0.innerHTML = rowCount;
        cell0.style.background  = "#FFFFFF";
    var cell1           = row.insertCell(1);  
        cell1.align     = "center";
        cell1.style.background  = "#FFFFFF";
    var imahe           = document.createElement("img");  
        imahe.setAttribute("src",src);

    var hidden          = document.createElement("input");
        hidden.setAttribute("type","hidden");
        hidden.setAttribute("name","filename[]");
        hidden.setAttribute("value",filename);
    /*var   hidden2         = document.createElement("input");
        hidden2.setAttribute("type","hidden");
        hidden2.setAttribute("name","filename[]");
        hidden2.setAttribute("value",filename);
        cell1.appendChild(hidden2);*/
        cell1.appendChild(hidden);
        cell1.appendChild(imahe);  

    var cell2           = row.insertCell(2);  
        cell2.align     = "left";
        cell2.valign    = "top";
        cell2.style.background  = "#FFFFFF";

        //tr1.appendChild(td1);

    var div2            = document.createElement("div");
       div2.style.padding   ="0 0 0 10px";
       div2.style.width = "400px";
       var alink        = document.createElement("a");
        //alink.style.margin="40px 0 0 0";
        alink.href      ="#";
        alink.innerHTML ="Cancel";
        alink.onclick= function () {
            document.getElementById(row.id).style.display='none';
            document.getElementById(textfield.id).disabled='disabled';
        };
       var div          = document.createElement("div");
            div.style.margin="10px 0";
            div.appendChild(alink);

    var textfield           = document.createElement("input");  
       textfield.id             = "file"+rowCount;
       textfield.type           = "text"; 
       textfield.name           = "itemname[]";
       textfield.style.margin   = "10px 0";
       textfield.style.width    = "400px";
       textfield.value          = "Item Name";
       textfield.onclick= function(){
                                    //textfield.value="";
                                    if(textfield.value=="Item Name")
                                    textfield.value="";
                                    if(desc.innerHTML=="")
                                        desc.innerHTML      ="Item Description";
                                    if(price.value=="")
                                        price.value="Item Price";
                                   }

      var desc                  = document.createElement("textarea");
          desc.name             = "itemdescription[]";
          desc.cols             = "80";
          desc.rows             = "4";
          desc.innerHTML        = "Item Description";
          desc.onclick          = function(){
                                    if(desc.innerHTML== "Item Description")
                                    desc.innerHTML      = "";
                                    if(textfield.value=="Item name" ||  textfield.value=="")
                                    textfield.value="Item Name";
                                    if(price.value=="")
                                    price.value="Item Price";
                                }
     var price                  = document.createElement("input");
        price.id            = "file"+rowCount;
       price.type           = "text"; 
       price.name           = "itemprice[]";
       price.style.margin   = "10px 0";
       price.style.width    = "400px";
       price.value          = "Item Price";
       price.onclick= function(){
                                    if(price.value=="Item Price")
                                        price.value="";
                                    if(desc.innerHTML=="")
                                        desc.innerHTML      ="Item Description";
                                    if(textfield.value=="")
                                        textfield.value="Item Name";
                                   }
    var span                = document.createElement("span");
        span.innerHTML      = "View";
        span.style.width    = "auto";
        span.style.padding  = "10px 0";
    var view                    = document.createElement("input");
        view.id             = "file"+rowCount;
       view.type            = "checkbox"; 
       view.name            = "publicview[]";
       view.value           = "y";
       view.checked         = "checked";
    var div3                = document.createElement("div");   
        div3.appendChild(span);
       div3.appendChild(view);
    var div4                = document.createElement("div");
        div4.style.padding  = "10px 0";
    var span2               = document.createElement("span");
        span2.innerHTML     = "Default Display";
        span2.style.width   = "auto";
        span2.style.padding = "10px 0";
    var radio               = document.createElement("input");
        radio.type          = "radio";
        radio.name          = "setdefault";
        radio.value         = "y";

        div4.appendChild(span2);
        div4.appendChild(radio);
        div2.appendChild(div);
       //div2.appendChild(label);
        //div2.appendChild(table);
       div2.appendChild(textfield);
       div2.appendChild(desc);
       div2.appendChild(price);
       div2.appendChild(div3);
       div2.appendChild(div4);
   cell2.appendChild(div2);
}  

function addImage(src,val_id) {
        var newImg = document.createElement("img");
    newImg.style.margin = "5px 50px 5px 5px";
    newImg.style.display= "inline";
    newImg.id=val_id;
    document.getElementById("thumbnails").appendChild(newImg);
    if (newImg.filters) {
        try {
            newImg.filters.item("DXImageTransform.Microsoft.Alpha").opacity = 0;
        } catch (e) {
            // If it is not set initially, the browser will throw an error.  This will set it if it is not set yet.
            newImg.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=' + 0 + ')';
        }
    } else {
        newImg.style.opacity = 0;
    }

    newImg.onload = function () {
        fadeIn(newImg, 0);
    };
    newImg.src = src;
}

function fadeIn(element, opacity) {
    var reduceOpacityBy = 5;
    var rate = 30;  // 15 fps

    if (opacity < 100) {
        opacity += reduceOpacityBy;
        if (opacity > 100) {
            opacity = 100;
        }

        if (element.filters) {
            try {
                element.filters.item("DXImageTransform.Microsoft.Alpha").opacity = opacity;
            } catch (e) {
                // If it is not set initially, the browser will throw an error.  This will set it if it is not set yet.
                element.style.filter = 'progid:DXImageTransform.Microsoft.Alpha(opacity=' + opacity + ')';
            }
        } else {
            element.style.opacity = opacity / 100;
        }
    }

    if (opacity < 100) {
        setTimeout(function () {
            fadeIn(element, opacity);
        }, rate);
    }
}

/* ******************************************
 *  FileProgress Object
 *  Control object for displaying file info
 * ****************************************** */

function FileProgress(file, targetID) {
    this.fileProgressID = "divFileProgress";

    this.fileProgressWrapper = document.getElementById(this.fileProgressID);
    if (!this.fileProgressWrapper) {
        this.fileProgressWrapper = document.createElement("div");
        this.fileProgressWrapper.className = "progressWrapper";
        this.fileProgressWrapper.id = this.fileProgressID;

        this.fileProgressElement = document.createElement("div");
        this.fileProgressElement.className = "progressContainer";

        var progressCancel = document.createElement("a");
        progressCancel.className = "progressCancel";
        progressCancel.href = "#";
        progressCancel.style.visibility = "hidden";
        progressCancel.appendChild(document.createTextNode(" "));

        var progressText = document.createElement("div");
        progressText.className = "progressName";
        progressText.appendChild(document.createTextNode(file.name));

        var progressBar = document.createElement("div");
        progressBar.className = "progressBarInProgress";

        var progressStatus = document.createElement("div");
        progressStatus.className = "progressBarStatus";
        progressStatus.innerHTML = "&nbsp;";

        this.fileProgressElement.appendChild(progressCancel);
        this.fileProgressElement.appendChild(progressText);
        this.fileProgressElement.appendChild(progressStatus);
        this.fileProgressElement.appendChild(progressBar);

        this.fileProgressWrapper.appendChild(this.fileProgressElement);

        document.getElementById(targetID).appendChild(this.fileProgressWrapper);
        fadeIn(this.fileProgressWrapper, 0);

    } else {
        this.fileProgressElement = this.fileProgressWrapper.firstChild;
        this.fileProgressElement.childNodes[1].firstChild.nodeValue = file.name;
    }

    this.height = this.fileProgressWrapper.offsetHeight;

}
FileProgress.prototype.setProgress = function (percentage) {
    this.fileProgressElement.className = "progressContainer green";
    this.fileProgressElement.childNodes[3].className = "progressBarInProgress";
    this.fileProgressElement.childNodes[3].style.width = percentage + "%";
};
FileProgress.prototype.setComplete = function () {
    this.fileProgressElement.className = "progressContainer blue";
    this.fileProgressElement.childNodes[3].className = "progressBarComplete";
    this.fileProgressElement.childNodes[3].style.width = "";

};
FileProgress.prototype.setError = function () {
    this.fileProgressElement.className = "progressContainer red";
    this.fileProgressElement.childNodes[3].className = "progressBarError";
    this.fileProgressElement.childNodes[3].style.width = "";

};
FileProgress.prototype.setCancelled = function () {
    this.fileProgressElement.className = "progressContainer";
    this.fileProgressElement.childNodes[3].className = "progressBarError";
    this.fileProgressElement.childNodes[3].style.width = "";

};
FileProgress.prototype.setStatus = function (status) {
    this.fileProgressElement.childNodes[2].innerHTML = status;
};

FileProgress.prototype.toggleCancel = function (show, swfuploadInstance) {
    this.fileProgressElement.childNodes[0].style.visibility = show ? "visible" : "hidden";
    if (swfuploadInstance) {
        var fileID = this.fileProgressID;
        this.fileProgressElement.childNodes[0].onclick = function () {
            swfuploadInstance.cancelUpload(fileID);
            return false;
        };
    }
}; 
```

我正在使用 swfuploader，当它预览准备上传的图像时，我只是添加了一个输入字段和一个文本区域。

从我的 HTML 我有这个脚本：

```
<script type="text/javascript">
    var swfu;
    window.onload = function () {
        swfu = new SWFUpload({
            // Backend Settings
            upload_url: "../we_modules/upload.php", // Relative to the SWF file or absolute
            post_params: {"PHPSESSID": "<?php echo session_id(); ?>"},

            // File Upload Settings
            file_size_limit : "20 MB",  // 2MB
            file_types : "*.*",
            //file_types : "",
            file_types_description : "jpg",
            file_upload_limit : "0",
            file_queue_limit : "0",

            // Event Handler Settings - these functions as defined in Handlers.js
            //  The handlers are not part of SWFUpload but are part of my website and control how
            //  my website reacts to the SWFUpload events.
            //file_queued_handler : fileQueued,
            file_queue_error_handler : fileQueueError,
            file_dialog_complete_handler : fileDialogComplete,
            upload_progress_handler : uploadProgress,
            upload_error_handler : uploadError,
            upload_success_handler : uploadSuccess,
            upload_complete_handler : uploadComplete,

            // Button Settings
            button_image_url : "../we_modules/images/SmallSpyGlassWithTransperancy_17x18.png",  // Relative to the SWF file
            button_placeholder_id : "spanButtonPlaceholder",
            button_width: 180,
            button_height: 18,
            button_text : '<span class="button">Select Files<span class="buttonSmall">(2 MB Max)</span></span>',
            button_text_style : '.button { font-family: Helvetica, Arial, sans-serif; font-size: 12pt;cursor:pointer } .buttonSmall { font-size: 10pt; }',
            button_text_top_padding: 0,
            button_text_left_padding: 18,
            button_window_mode: SWFUpload.WINDOW_MODE.TRANSPARENT,
            button_cursor: SWFUpload.CURSOR.HAND,

            // Flash Settings
            flash_url : "../swfupload/swfupload.swf",

            custom_settings : {
                upload_target : "divFileProgressContainer"
            },

            // Debug Settings
            debug: false
        });
    };
</script> 
```

正如您在下面提到的，我应该在哪里使用 tinymce 功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T07:38:51.687

直接取自[TinyMCE 文档](http://tinymce.moxiecode.com/examples/simple.php)：

```
<script type="text/javascript" src="<your installation path>/tiny_mce/tiny_mce.js"></script>
<script type="text/javascript">
tinyMCE.init({
    mode : "textareas",
    theme : "simple"
});
</script>

<form method="post" action="somepage">
    <textarea name="content" style="width:100%">
    </textarea>
</form> 
```

请阅读文档以了解此类基本问题。如果您在完成此操作后遇到困难或需要帮助，请清楚地解释您的问题（如果可能，请提供示例代码），以便我们为您提供帮助。

## 编辑：

好的，我已经尝试了解决问题的方法。以下代码动态加载 20 个图像和文本区域，然后将文本区域转换为 TinyMCE 编辑器（希望您不要介意 jQuery）：

```
<html>
  <head>
    <script src="TinyMCE/jscripts/tiny_mce/tiny_mce.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <style>
      img { height: 100px; display: block;}
      li { border: 1px solid black; margin: 1em; padding: 1em; }
      #message { position: fixed; top: 0; left: 50%; margin-left: -100px; width: 200px; text-align: center; background-color: white; border: 1px solid black;}
    </style>
  </head>
  <body>
    <ul>
    </ul>
    <div id="message">Loading...</div>
    <script>
      $(function(){
        var numImages = 20;

        for (var i = 0; i < numImages; i++) {
          // Create an img element with a random image
          var img = $('<img />').attr('src', randomXKCD);

          // Attach a callback to the image's load event
          img.load(function(){
            numImages--;
            if (numImages === 0) {
              // When all the images have loaded,
              // turn the textareas into tinyMCE editors
              tinyMCE.init({
                mode: 'textareas',
                theme: 'simple',
                oninit: function(){$('#message').hide()}
              });
            }
          });

          // Add the image and a textarea to the document.
          $('ul').append(
            $('<li />')
              .append(img)
              .append('<textarea />')
          );
        }

        // helper function to get a random image.
        function randomXKCD() {
          var xkcds = [
            'http://imgs.xkcd.com/comics/barrel_mommies.jpg',
            'http://imgs.xkcd.com/comics/su_doku.jpg',
            'http://imgs.xkcd.com/comics/linux_user_at_best_buy.png',
            'http://imgs.xkcd.com/comics/commented.png',
            'http://imgs.xkcd.com/comics/typewriter.png',
            'http://imgs.xkcd.com/comics/pirate_bay.png',
            'http://imgs.xkcd.com/comics/quirky_girls.png',
            'http://imgs.xkcd.com/comics/firefly.jpg',
            'http://imgs.xkcd.com/comics/kepler.jpg',
            'http://imgs.xkcd.com/comics/centrifugal_force.png',
            'http://imgs.xkcd.com/comics/trebuchet.png',
            'http://imgs.xkcd.com/comics/egg_drop_failure.png',
            'http://imgs.xkcd.com/comics/too_old_for_this_shit.png',
            'http://imgs.xkcd.com/comics/2008_christmas_special.png',
            'http://imgs.xkcd.com/comics/braille.png',
            'http://imgs.xkcd.com/comics/impostor.png',
            'http://imgs.xkcd.com/comics/not_enough_work.png'
          ];
          return xkcds[Math.floor(Math.random() * xkcds.length)];
        }
      });
    </script>
  </body>
</html> 
```

# wpf - WPF Grid - 如何为一列应用样式？

> ID：851511
> 
> 赞同：15
> 
> 时间：2009-05-12T07:05:36.730
> 
> 标签：wpf, grid

我有一个包含许多行和列的 WPF 网格，所有行和列都包含诸如 TextBlocks 和 TextBoxes 之类的东西。

对于这种特定情况，我希望第 1 列中的所有内容都有填充，并且第 2 列中的所有内容都正确对齐。必须在网格中的每个项目上设置这些属性似乎是非常非 WPF 的。

我知道我可以通过执行以下操作为网格中的所有 TextBlocks 创建样式：

```
<Grid>
  <Grid.Resources>
    <Style TargetType="{x:Type TextBox}">
      <Setter Property="HorizontalAlignment" Value="Right"/>
    </Style>
  </Grid.Resources>
</Grid> 
```

但是有没有办法将该样式仅应用于第 2 列中的控件？

我应该使用不同的控件吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2009-05-12T14:28:21.047

这是我通常做的：

```
<Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource {x:Type TextBlock}}">
    <Style.Triggers>
        <Trigger Property="Grid.Column" Value="0">
            <Setter Property="Margin" Value="0,0,2,0" />
        </Trigger>

        <Trigger Property="Grid.Column" Value="2">
            <Setter Property="Margin" Value="20,0,2,0" />
        </Trigger>
    </Style.Triggers>
</Style> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T08:41:31.160

您可以定义一些样式，如下所示，并将它们分配给您的 Column.ElementStyle 属性：

```
<Window.Resources>
       <Style x:Key="elementStyle" TargetType="TextBlock">
           <Setter Property="VerticalAlignment" Value="Center" />
           <Setter Property="Margin" Value="2,0,2,0" />
       </Style>

       <Style x:Key="rightElementStyle" BasedOn="{StaticResource elementStyle}" TargetType="TextBlock">
           <Setter Property="HorizontalAlignment" Value="Right" />
       </Style>

       <Style x:Key="centerElementStyle" BasedOn="{StaticResource elementStyle}" TargetType="TextBlock">
           <Setter Property="HorizontalAlignment" Value="Center" />
       </Style>
</Window.Resources>

<dg:DataGrid AutoGenerateColumns="False">
      <dg:DataGrid.Columns>
           <dg:DataGridTextColumn Binding={Binding Path=Name} 
                                  Header="Name" 
                                  ElementStyle="{StaticResource centerElementStyle}"/>
           <dg:DataGridTextColumn Binding={Binding Path=Amount} 
                                  Header="Amount" 
                                  ElementStyle="{StaticResource rightElementStyle}"/>
    </dg:DataGrid.Columns>
</dg:DataGrid> 
```

# asp.net - 更新面板 asp.net

> ID：851512
> 
> 赞同：0
> 
> 时间：2009-05-12T07:06:40.380
> 
> 标签：asp.net, updatepanel

我在 asp.net 页面中使用 UpdatePaenl。它有一个按钮来触发它。按下按钮时，我可以显示“正在加载”。这是我的问题，我需要它在第一次调用页面时显示“正在加载”，而不仅仅是在按下按钮时。

任何想法都非常感谢。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T02:47:12.443

这是我为相册小部件创建的一些示例代码：

```
<div>
    <asp:UpdateProgress ID="UpdateProgress1" AssociatedUpdatePanelID="updatePanel1" runat="server">
        <ProgressTemplate> 
            <img src="images/busybar.gif" alt="Loading..." style="margin-right:auto; margin-left:auto; position:fixed; top:60%; left:50%;" />
        </ProgressTemplate>
    </asp:UpdateProgress>
    <asp:UpdatePanel ID="updatePanel1" runat="server">
    <ContentTemplate>
        <uc1:PhotoAlbumThumbnails ID="PhotoAlbumThumbnails1" runat="server" ItemsPerPage="30" />
    </ContentTemplate>
</asp:UpdatePanel>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T07:55:58.507

您检查过 UpdateProgress 控件吗？ [http://www.asp.net/Ajax/Documentation/Live/overview/UpdateProgressOverview.aspx](http://www.asp.net/Ajax/Documentation/Live/overview/UpdateProgressOverview.aspx)

# asp.net - VS2008发布网站后无法解析全局资源

> ID：851522
> 
> 赞同：13
> 
> 时间：2009-05-12T07:10:26.147
> 
> 标签：asp.net, visual-studio-2008, resources, publishing, pre-compilation

我有一个在 VS 2008 中运行的网络项目。我们在 App_GlobalResources 文件夹中有一些全局资源文件 (*.resx) 用于国际化。所有这些都像我在 VS 中安装的本地 IIS 的魅力一样。

但是当我将我的网络项目发布到本地文件系统和/或另一台服务器时，所有资源都找不到了。所以我猜预编译会以某种方式破坏东西。当我调用预编译的 web 时，我得到一个错误，即无法找到带有键 xyz 的资源对象，尽管它之前可以找到。

我使用 .NET 反射器检查了资源是否进入 *.dll。所有这些标识符都在那里（bin/Web.dll、bin/<culture>/Web.resources.dll）。标识符的加载方式如下：

```
<asp:MenuItem NavigateUrl="~/OrderNew.aspx" Text="<%$ Resources:MyProject, MenuNewOrder %>" Value="NewOrder"> 
```

资源文件称为 MyProject.resx 和 MyProject.<culture>.resx，其中 <culture> 对应于特定的文化（即 MyProject.de-DE.resx）。

任何想法如何解决这个问题？

我真的很感激任何帮助。

谢谢

**编辑：**

如果我手动将 App_GlobalResources 文件夹复制到输出，则资源可能会正常加载。所以我真的很想知道这个预编译是关于什么的。

我仍然对“以正确的方式”解决问题感兴趣。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-06-02T02:23:54.893

我遇到了同样的问题，不得不对 resx 文件属性进行两次更改。

1.  将“构建操作”设置为内容
2.  将“复制到输出目录”设置为始终复制

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2010-05-27T09:07:35.837

（我无法评论之前的答案......还没有声誉......？）

恐怕这并没有解决我的问题。

在尝试“始终内容/复制”解决方案时，我收到一个异常，指出编译时的链接不起作用。

为什么asp.net编译资源的时候需要resx文件！？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-01-12T08:57:39.693

从另一个项目复制资源文件时出现此错误。

我通过删除全局资源、添加新资源并将`data`元素从旧 XML 复制到新 XML 来解决这个问题。

这会导致资源的以下设置：

```
 <ItemGroup>
    <Content Include="App_GlobalResources\Global.resx">
      <Generator>GlobalResourceProxyGenerator</Generator>
      <LastGenOutput>Global.Designer.cs</LastGenOutput>
    </Content>
  </ItemGroup> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T15:09:13.970

我遇到过同样的问题。每当我将我的应用程序发布到 Small Business Server (SBS2008) 时，它都会停留在控制名称行上，但实际上是 meta:resourcekey 的一部分。上述解决方案都没有帮助我。

我花了 6 个小时解决这个问题，最后我意识到这是在我在服务器上进行一些文件夹清理时发生的。一开始我所有的应用程序都位于 E: 在他们的文件夹中，但后来我创建了文件夹，其名称指示应用程序 ApplicationPools 并且我将相应的应用程序移动到那里。

我不知道我的 SBS 上的 IIS7 是如何寻找资源文件的，但这绝对是问题所在。当我带着我的应用程序回到 E: 时，一切又开始像魅力一样工作了。

# c# - 我无法使用 c# 从 Mozilla 和 Opera 浏览器获取 url

> ID：851527
> 
> 赞同：2
> 
> 时间：2009-05-12T07:12:44.677
> 
> 标签：c#

请帮帮我。我如何从地址栏中获取 url。我为此使用c#。它是窗口应用程序

例如：如果我在地址栏中输入 www.google.com，那么我会得到“www.google.com”标题。

我已经对 IExplorer 进行了此操作，它很成功，但我无法从 Mozilla 和 Opera 浏览器获取 url。请帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T07:26:16.573

如果您在 ASP .Net 页面中使用 C#，您可以使用

```
string url = Request.Path; 
```

或者 Request.Url 包含 URI 信息

```
Uri uri = Request.Url 
```

如果您在客户端上使用 Javascript，请使用

```
var url = window.location; 
```

# windows-ce - Windows CE 6 写字板替换

> ID：851531
> 
> 赞同：0
> 
> 时间：2009-05-12T07:13:25.783
> 
> 标签：windows-ce, platform-builder, wordpad

我正在开发一个 Win CE 6 OS 映像，并希望使其适合“Windows Embedded CE 6.0 Core Run-Time License”。

这意味着，除其他外，我必须删除写字板应用程序。从产品服务和开发的角度来看，我想用类似但免费的东西来代替它。

一个想法是在 C#/CF.Net 中做一个简单的编辑器，但我宁愿找到可以插入并工作的东西，最好是免费的，或者至少比每单位 15 美元的增加许可证的成本便宜。

是否有适用于 Win CE 6 的适当许可的文本编辑器？

我不需要富文本编辑器，只需一个简单的文本编辑器即可编辑 xml 和文本配置文件。编辑器必须能够处理 utf-8/unicode。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T09:26:05.503

[cke](http://www.animaniak.com/cke/cke_main.asp)非常好，我相信你可以和它的作者达成某种交易。[CEdit](http://www.logicalsky.com/CEdit_Download.php)是另一个不错的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-15T11:39:43.703

我最终用 C#/WinForms 编写了自己的简单文件编辑器。不是很好，但可以完成工作。

# vb6 - VB6.0：加载 VB 项目时调用的用户控件的初始化方法

> ID：851536
> 
> 赞同：4
> 
> 时间：2009-05-12T07:16:33.017
> 
> 标签：vb6, initialization, user-controls

每当我们加载一个 VB 项目时，它都会调用`Initialize`一个用户控件的事件（如果项目中有的话）。我的问题是我有一些代码`UserControl_Initialize`会尝试创建其他 COM 对象的实例。在我的构建机器上，这些控件未注册。一种选择是将代码移至其他方法，`Initialize`但我想知道是否有更好的解决方案？在某个地方我发现我们可能会检查调用应用程序是否是 VB 编辑器然后跳过初始化代码......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T07:41:59.607

您可以使用：

```
If Not Me.DesignMode Then
  ...
End If 
```

我们使用的另一个解决方案是一个可以全局使用的小函数：

```
Public Function IsRuntime() as Boolean
   On Error Goto NotRuntime
   Debug.Print(1 / 0)
   IsRuntime = True
   Exit Function
NotRuntime:
   IsRuntime = False
End If 
```

不知道它的语法格式是否正确，但思路应该很清楚：只有在 IDE 中调用了调试语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T07:23:30.477

只有当您的项目在表单设计器打开的情况下保存时才会发生这种情况：这意味着在启动时会显示表单（可能在后台），因此需要初始化其上的所有控件。**因此，如果**在表单上使用此控件，则会调用您的用户控件初始化程序。

为了防止这种情况，只需在关闭表单设计器的情况下保存项目。

# c# - 如何防止用户共享同一个帐户？(ASP.NET MVC)

> ID：851538
> 
> 赞同：3
> 
> 时间：2009-05-12T07:17:46.853
> 
> 标签：c#, asp.net-mvc, security

我有一个基于订阅的网站（按月收费），我想阻止用户共享帐户以避免支付月费。

有没有办法做到这一点？

干杯，

麦克风

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T07:42:47.327

使用 IP 的方法不适合，因为有些用户使用相同的外部 ip 来上网。但在某些情况下，这是一种合适的方法（例如，在 Intranet Web 应用程序中）。您可以监控同一登录的并发会话数。不止一种方法是在同一登录存在超过 1 个并发会话时进行记录。比你可以分析日志。根据这些数据，您可能会采取一些行动。祝你好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T07:31:51.040

记录帐户的 IP 地址。如果它快速且经常发生变化，我认为假设该帐户被多人使用是安全的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T07:44:38.617

没有办法明确地做到这一点。但是，您可以在顶部添加一层身份验证，向他们询问某种形式的安全问题，例如出生日期、出生地点等。

我会更不愿意给一堆人这些信息！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T07:22:06.580

不幸的是，你在这里很不走运。您可以在此处采用的唯一潜在途径是检查 IP 地址，但这对于这种机制来说极其不可靠。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T09:23:19.440

您是否试图阻止多人同时或不同时间使用同一个帐户？

您可以通过在用户会话中存储 GUID 并根据您在 cookie 中设置的值检查它来停止前者。没问题。

你只是不能可靠地阻止后者。存储 IP 将在一定程度上起作用，但大多数家庭用户经常被分配一个新 IP（如之前另一条评论所述）。您可以使用 IP -> 位置并检查位置是否经常变化。

不幸的是，精明的用户也会使用代理服务器来破坏这种机制。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T09:19:38.603

我还没有听说有人这样做，所以我们必须考虑并想出一些办法。

使用帐户 ID 和活动时间戳记录 IP 地址。寻找可以告诉您该 IP 来自何处的 Web 服务。在不同 IP 上查找来自同一帐户的连接。

例如，如果我在同一个 IP 上有 2 个并发会话，您无法确定。也许我同时打开了 Firefox 和 Chrome。

如果我有 2 个具有不同 IP 的并发会话，那么您肯定我正在共享帐户（如果这种情况经常发生）。

如果我在一周内使用几个不同的 IP，你无法分辨，因为我被允许使用不同的计算机，或者在我访问时使用我朋友的互联网连接。即使IP位于不同的国家。

所以，我建议记录 IP 地址，寻找定位服务，并测试根据实时数据编写的规则。

# c# - WPF 的 ICollectionView.filter 与大量数据集

> ID：851545
> 
> 赞同：24
> 
> 时间：2009-05-12T07:20:05.787
> 
> 标签：c#, wpf, listview, filter

我正在开发一个 wpf 应用程序，其中包含一个包含大量数据（10 000 到 100 000）行的列表视图。用户可以将各种过滤器应用于此列表视图，从而使过滤器逻辑非常先进（而且速度很慢）。目前，我的代码的相关部分如下所示：

```
ICollectionView view = CollectionViewSource.GetDefaultView(hugeList.ItemsSource);
view.Filter = new Predicate<object>(FilterCallback);

private bool FilterCallback(object item)
{
  //Filter logic
} 
```

但这会在 UI 线程中运行，并在过滤时阻塞整个应用程序，从而给用户带来非常糟糕的体验。所以我对你们所有人的问题是：有人知道在 wpf 中过滤列表视图的“更好”方法还是应该过滤底层`ObservableCollection`？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-05-12T14:22:15.117

密切注意您的过滤功能。确保您没有进行任何不必要的装箱/拆箱，并且您没有在其中进行大量计算。您还应该注意您使用的是哪种 CollectionView，有些比其他更快。来自[Bea 关于排序的帖子](http://bea.stollnitz.com/blog/?p=24)：

*   如果您的源实现 IEnumerable，则会创建一个**CollectionView 。**如果源实现 IEnumerable *only*，您将无法对集合进行排序或分组（您只能对其进行过滤）。此外，如果源具有大量项目或执行动态操作（例如插入和删除），则 perf 不会是最好的。如果这是您的方案，您应该考虑让您的源实现更强大的接口。ICollection 稍微好一点，因为它提供了一个 Count 属性。

*   **ListCollectionView**是源实现 IList 时创建的视图类型。与 IEnumerable 和 ICollection 相比，IList 对于大型或动态列表的性能要好得多，因为它提供了一个索引器，允许我们快速随机访问。此外，IList 允许排序、分组和过滤。但理想情况下，您的源集合派生自 ObservableCollection，它是数据绑定眼中的所有集合之母，因为它提供了一些额外的好处，例如属性和集合更改通知。

*   **BindingListCollectionView**是 Avalon 在源集合实现 IBindingList 时创建的视图类型。这是我们在 ADO.NET 场景中处理的视图。它支持排序和分组，但不支持传统的过滤。相反，它有一个附加的 CustomFilter 属性，将过滤委托给 DataView（有关详细信息，请参阅我在 ADO.NET 上的帖子）。

正如@mihi 所说，您可以将过滤踢到不同的线程，但我已经使用 CollectionViews 在 ObservableCollection 上同时运行多个过滤器，对象上有约 60 个变量（数据库表中的列）的 50,000 个项目，没有明显的滞后。

我在您的过滤器函数中立即注意到的一件事是输入是 Object 类型，这可能意味着您正在函数内进行类型转换并且可能不需要。您还使用不包含返回类型的 Predicate，因此可能需要在 CollectionView 的过滤方法中进行一些类型转换或反射，并且可能会减慢您的速度。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T07:41:04.833

您是否考虑过在另一个线程中过滤或使用调度程序？

[WPF 线程：使用调度程序构建更具响应性的应用程序](http://msdn.microsoft.com/en-us/magazine/cc163328.aspx)可以很好地概述一些可用的线程选项。

# java - 用户未与受信任的 SQL Server 连接关联

> ID：851549
> 
> 赞同：4
> 
> 时间：2009-05-12T07:21:29.187
> 
> 标签：java, sql, sql-server-2005

我写了这样的代码来连接 sqlserver 数据库。我加载了驱动程序类，但我没有得到连接。

```
Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");      
System.out.println("class Loaded");         
connection = 
    DriverManager.getConnection(
        "jdbc:sqlserver://10.171.160.114:2001",
        "XXXXXX",
        "XXXXXX");      
System.out.println("connected"); 
```

我收到此错误“用户未与受信任的 SQL Server 连接关联。”。请就此向我提出建议。非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-12T07:42:42.427

SQL 服务器已配置为在“Windows 身份验证模式（Windows 身份验证）”下运行，并且不允许使用 SQL 帐户。在 Management Studio 中右键单击您的 SQL Server 节点，然后选择“属性”。在出现的对话框中，转到安全选项卡并确保选中“SQL Server 和 Windows 身份验证模式”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T07:36:35.760

它可能与您使用的身份验证机制有关。有关详细信息，请参阅此[问题](https://stackoverflow.com/questions/167464/can-i-connect-to-sql-server-using-windows-authentication-from-java-ee-webapp)。

如需更多信息，请阅读[此处](http://www.datadirect.com/developer/jdbc/topics/winauth/index.ssp)。

# c# - C#：解析 Lating1Encoded 文档时 Xpath 中的“瑞典语”字符

> ID：851551
> 
> 赞同：2
> 
> 时间：2009-05-12T07:22:22.633
> 
> 标签：c#, xpath, latin1, file-encodings

我有一组需要解析的 html 文档。它们以 Latin1Encoded 编码。我正在使用 HtmlAgiliy 包进行“解析”。

我有一个 Xpath 查询（带有瑞典字符），由于文档和编码之间的编码不同，我无法工作 VS 将 XPath 查询存储在？

Xpath 查询：

```
doc.DocumentNode.SelectNodes(@"//h2[text()='Företag']/../div//span[text()='Resultat:']/../div"); 
```

xpath 查询在 Firefox 扩展 xpath 检查器中运行良好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T09:03:29.817

您能否提供更多示例代码和一些输入 XML 文档？根据给定的信息，我编写了一个按预期工作的小示例程序。以下内容对您有用吗？

**样本文件：**

```
<?xml version="1.0" encoding="iso-8859-1"?>
<doc>
  <test>Företag</test>
  <test>Hallå</test>
</doc> 
```

**C＃**

```
using System;
using System.Xml.XPath;

class Program
{
    static void Main(string[] args)
    {
        XPathDocument xpdoc = new XPathDocument(@"sample.xml");
        XPathNavigator nav = xpdoc.CreateNavigator();
        XPathNodeIterator iter = nav.Select("//*[text() = 'Företag']");

        while (iter.MoveNext())
        {
            Console.WriteLine(iter.Current.ToString());
        }
    }
} 
```

**输出**

```
Företag 
```

从给出的示例代码看来，您正在使用[`Microsoft.Windows.Design.Documents.Trees.DocumentNode`](http://msdn.microsoft.com/de-de/library/microsoft.windows.design.documents.trees.documentnode.aspx)该类。但是，文档指出该类不打算直接使用。请问你想做什么？

更新：可能是您面临空白规范化问题（这可能由您的 FireFox 插件完成，而不是在您的代码中完成）。您是否尝试通过将测试替换为（仅排除存在额外前导或尾随空格的情况）来更改您的`text() = 'Företag'`XPath `normalize-space() = 'Företag'`？

# xml - 黑莓中的 TransformerFactory？

> ID：851552
> 
> 赞同：1
> 
> 时间：2009-05-12T07:22:26.767
> 
> 标签：xml, blackberry, java-me, sax, xml-parsing

如何在 BlackBerry 中使用 TransformerFactory 创建 XML？

Java 有 TransformerFactory 方法。但巴拉克贝瑞没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T08:41:06.747

您可以尝试将 xerces.jar/xalan.jar 放入您的设备。然后您可以使用 Xalan 的原生 api 进行 XML 转换。

见[http://xalan.apache.org/](http://xalan.apache.org/)

我不能保证 xalan 真的可以在 BlackBerry 上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-18T06:05:43.707

由于 BlackBerry 使用 J2ME 作为他们的软件平台，因此您可以在项目中使用的第三方 Java 库在一定程度上受到限制。您可能想看看[Javolution](http://javolution.org/) 或其他专门针对 J2ME 的库。

# c# - 用户控制实例数量的上限（合理）限制

> ID：851553
> 
> 赞同：3
> 
> 时间：2009-05-12T07:22:33.460
> 
> 标签：c#, winforms, user-controls

我有一个菜单，它曾经是一个树视图控件，但现在我想让每个项目更加直观，并向树中的每个对象添加更多信息。

我的第一个意图是制作一个代表项目的用户控件，并在运行时将它们添加到面板中。这是一个好的方法吗？有时可能有超过一百个项目。我知道理论上你可以在表单上拥有的控件数量是最大的，但这不是我主要关心的问题。我关心的主要是性能。

我正在考虑的另一种方法是制作一个列表框并在 onPaint 方法中做一些额外的事情。但这似乎有点不稳定，而且维护起来有点过于复杂。

有什么想法吗？

* * *

**编辑：**

我已经通过向面板 att form_Load 添加 200 个用户控件来测试用户控件方法，实际添加需要相当长的时间，但除此之外似乎没有任何性能问题。滚动工作正常，我已经让每个用户控件可折叠，并且该功能不会以任何方式滞后，即使面板中有大约 100 个上方和 100 个下方。

但仍然......我在这里完全正常吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-14T07:33:53.380

UserControls 是非常“重”的动物，System.Windows.Forms.Control 的任何实例也是如此，因为每个实例都包装了一个实际的底层本机 Win32 窗口。每个窗口都需要由操作系统管理、命中测试、发送绘制消息等。

Windows 中这种情况的传统解决方案是“虚拟化”控件。与其创建 200 个用户控件，不如维护一个由 200 个“对象”组成的数组，代表每个项目。创建一个代表整个菜单的“大”控件，向其中添加一个 ScrollBar，并覆盖 OnPaint，仅绘制可见项。

这就是像 ListBox 和 TreeView 这样的老式原生控件所做的。

现在，我相信 Windows 可以在这里为您提供一些帮助，具体取决于您需要获得的花哨程度。您要查找的关键字是“所有者绘制”。从[另一个答案](https://stackoverflow.com/questions/188248/c-custom-listview)抄袭：

> 子类列表框。在 ctor 中，将绘制模式设置为 OwnerDrawVariable 并覆盖 OnDrawItem 和 OnMeasureItem。

这样，本机控件将处理所有必要的滚动和数学运算，以确定您在列表中的位置以及开始绘画的位置。

# asp.net - 找出 asp.net 身份验证票证过期的原因

> ID：851557
> 
> 赞同：5
> 
> 时间：2009-05-12T07:23:43.160
> 
> 标签：asp.net, asp.net-mvc, authentication, cookies, asp.net-membership

我需要帮助找出为什么我的身份验证票在我托管的网站上大约一个小时后过期。但是，如果我在本地运行该站点，则身份验证票证会在正确的时间内保持活动状态。

这是我的本地主机 web.config：

```
<authentication mode="Forms">
    <forms loginUrl="~/Account/LogOn" timeout="20160" slidingExpiration="true" path="/" />
</authentication> 
```

这是我托管的 web.config：

```
<authentication mode="Forms">
    <forms loginUrl="~/Account/LogOn" timeout="20160" slidingExpiration="true" domain=".mywebsite.com" path="/" />
</authentication> 
```

我知道正在创建身份验证票证，因为：

*   我可以在浏览器 cookie 中看到它
*   即使关闭浏览器并重新打开，我仍然保持登录状态
*   即使在网站回收后我仍然保持登录状态（更改并保存 web.config 以回收它）

当我在浏览器中查看 cookie 的过期日期时，已经是 2 周后了。但是，大约一个小时后，我的身份验证总是过期。

我该怎么做才能弄清楚为什么托管网站的身份验证会过早到期？我不知道如何解决这个问题，因为我的托管网站是唯一有问题的网站。

更新 1：等待 1 小时后，我检查浏览器，发现 cookie 仍然存在。事实上，它的到期日期设置为 2 周后。但是，如果我重新加载页面或尝试访问任何需要身份验证的页面，我将被带到登录页面。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-16T22:04:09.823

我在 system.net 中添加了一个机器密钥条目。像这样的东西：

```
 <machineKey validationKey="aaa"
    decryptionKey="bbb" validation="SHA1" /> 
```

现在它使用户保持登录状态。但是，现在看来我遇到了性能问题。过去加载大约需要 500 毫秒的页面现在大约需要两倍的时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T13:03:29.907

我会尝试几件事来解决这个问题：

*   本地主机和主机之间的 IIS 版本和设置。应用程序池设置很可能存在一些差异
*   在 IIS 7 中，对此有一个特殊设置：[阅读此处](http://technet.microsoft.com/en-us/library/cc772290.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T13:17:14.617

您是否询问过您的托管服务提供商 machine.config 是否将此设置为不同的值？machine.config 上的设置将覆盖 web.config。

# iphone - 如何为 iphone 应用程序配置 AD Hoc 分发？

> ID：851562
> 
> 赞同：2
> 
> 时间：2009-05-12T07:25:23.033
> 
> 标签：iphone, objective-c

如何为我的 iphone 产品创建 AD Hoc 分发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T07:33:43.767

登录“iPhone Developer Program Portal”后，下载并阅读右侧的“Program Portal User Guide”。遵循该指南可以解决很多问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T12:42:38.393

此外，请确保您阅读并遵循[Craig Hockenberry 的说明](http://furbo.org/2008/08/06/beta-testing-on-iphone-20/)。他们会为你节省很多时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-01-10T15:51:25.210

我在这里用屏幕截图写了一个冗长的教程：http: [//www.cannonballbounce.com/content/iphone-wireless-ad-hoc-app-distribution](http://www.cannonballbounce.com/content/iphone-wireless-ad-hoc-app-distribution)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2011-12-08T09:50:21.010

进入 www.developer.apple.com > Login > iOS dev center > Provisioning portal

在 Provision > Distribution 中使用“ad hoc”分布生成一个新的配置文件

下载配置文件。使用拖放或文件 > 添加到资料库将其添加到 iTunes

在 Xcode 中，通过右键单击项目 > 编辑方案 > 存档 > 确定来创建一个新存档

在 Xcode > Window > Organizer 中选择存档并单击共享

要使用 iTunes 同步应用程序，请选择 iOS App Store Package (.ipa)

在 Finder 中找到生成的文件并添加到 iTunes

将设备连接到 iTunes 并执行同步以添加应用程序

看：

[http://developer.apple.com/library/ios/#documentation/Xcode/Conceptual/ios_development_workflow/145-Distributing_Applications/distributing_applications.html](http://developer.apple.com/library/ios/#documentation/Xcode/Conceptual/ios_development_workflow/145-Distributing_Applications/distributing_applications.html)

[https://developer.apple.com/library/ios/#recipes/xcode_help-scheme_editor/Articles/SchemeArchive.html#//apple_ref/doc/uid/TP40010402-CH6](https://developer.apple.com/library/ios/#recipes/xcode_help-scheme_editor/Articles/SchemeArchive.html#//apple_ref/doc/uid/TP40010402-CH6)

[https://developer.apple.com/library/ios/#featuredarticles/FA_Wireless_Enterprise_App_Distribution/Introduction/Introduction.html](https://developer.apple.com/library/ios/#featuredarticles/FA_Wireless_Enterprise_App_Distribution/Introduction/Introduction.html)

# android - 如何在 Eclipse 的 ADT 插件中更改 XML 布局预览面板的大小（宽度 + 高度）？

> ID：851571
> 
> 赞同：4
> 
> 时间：2009-05-12T07:29:22.760
> 
> 标签：android, eclipse-plugin, adt

如果可能的话，我还想要一种更改默认值的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T18:52:04.160

![ADT 截图](https://farm4.static.flickr.com/3611/3526320066_79373ef326_o.png)

A & B 允许您设置预览面板的宽度（A）和高度（B）。C 允许您更改所涉及的主题（包括禁用顶部栏、标题栏等）。

*不确定如何更改默认值。*

# php - 如何在 PHP 中获得格林威治标准时间？

> ID：851574
> 
> 赞同：45
> 
> 时间：2009-05-12T07:30:40.543
> 
> 标签：php, timezone

我有一个设置为 EST 的服务器，并且数据库中的所有记录都设置为 EST。我想知道如何将其设置为 GMT。我想为我的用户提供时区选项。

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2009-05-12T08:32:11.613

我*强烈*建议避免弄乱 UNIX 时间戳，使其看起来像一个不同的时区。这是我经历过很多次的惨痛教训。

时间戳是自格林威治标准时间 1970 年 1 月 1 日午夜以来的秒数。无论您身在何处，给定的时间戳都代表完全相同的时刻，而与时区无关。是的，时间戳“0”表示澳大利亚 1 月 1 日上午 10 点，伦敦 1 月 1 日午夜，洛杉矶 69 年 12 月 31 日下午 5 点，但这并不意味着您可以简单地添加或减去值并保证准确性。

每年让我困扰太久的黄金例子是夏令时出现的时候。夏令时意味着世界某些地区不存在“时钟时间”。例如，在美国的大部分地区，没有 2006 年 4 月 2 日凌晨 2:01 这样的时间。

不过，足够的准可理解的咆哮。我的建议是将您的日期作为时间戳存储在数据库中，然后...

*   如果您需要服务器上的本地时间，请使用[`date()`](http://php.net/date)
*   如果您需要获取 GMT，请使用[`gmdate()`](http://php.net/gmdate)
*   如果您需要获得不同的时区，请使用[`date_default_timezone_set()`](http://php.net/date_default_timezone_set)然后`date()`

例如，

```
$timestamp = time();

echo "BRISBANE: " . date('r', $timestamp) . "\n";
echo "     UTC: " . gmdate('r', $timestamp) . "\n";
date_default_timezone_set('Africa/Johannesburg');
echo "  JOBURG: " . date('r', $timestamp) . "\n";

// BRISBANE: Tue, 12 May 2009 18:28:20 +1000
//      UTC: Tue, 12 May 2009 08:28:20 +0000
//   JOBURG: Tue, 12 May 2009 10:28:20 +0200 
```

这将使您的值保持干净（您不必担心添加偏移量，然后在保存之前减去），它将遵守所有夏令时规则，您甚至不必查找该地点的时区你要。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-05-12T07:39:17.753

无论服务器位于哪个 GMT 时区，这里都是获取任何时区时间和日期的极其简单的方法。这是通过`time()`and`gmdate()`函数完成的。该`gmdate()`函数通常为我们提供 GMT 时间，但通过使用该`time()`函数我们可以获得 GMT+N 或 GMT-N，这意味着我们可以获得任何 GMT 时区的时间。

例如，如果您必须获取 GMT+5 的时间，您可以按如下方式进行

```
<?php 
  $offset=5*60*60; //converting 5 hours to seconds.
  $dateFormat="d-m-Y H:i";
  $timeNdate=gmdate($dateFormat, time()+$offset);
?> 
```

现在，如果您必须获取 GMT-5 的时间，您只需从 中减去偏移量`time()`而不是添加到它，就像在下面的示例中，我们正在获取 GMT-4 的时间

```
<?php 
  $offset=4*60*60; //converting 4 hours to seconds.
  $dateFormat="d-m-Y H:i"; //set the date format
  $timeNdate=gmdate($dateFormat, time()-$offset); //get GMT date - 4
?> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-02-17T13:06:10.480

以下是与 GMT 不同的时区列表，希望对您有所帮助！

```
echo '<pre>';
$zones_array = array();        
$timestamp = time();         
# to maintain the original timezone, store before
$default_timezone = date_default_timezone_get();
foreach (timezone_identifiers_list() as $key => $zone) {    
    date_default_timezone_set($zone);
    $zones_array[$key]['zone'] = $zone;
    $zones_array[$key]['diff_from_GMT'] = date('P', $timestamp);
}
# to maintain the original timezone, re-set after
date_default_timezone_set($default_timezone);    
print_r($zones_array); 
```

谢谢！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-07-12T11:32:31.467

请务必注意，如果您使用 date('Z') 转换存储在数据库中的日期，则将时间戳作为第二个参数提供日期，否则您的结果将不准确。

例如

在英国，有时 date('Z') 会给出 3600，有时会给出 0。

```
echo date('Z', strtotime('2012-01-01')); 
```

给出 0

```
echo date('Z', strtotime('2012-07-01')); 
```

给3600

所以纯粹使用 strtotime($dbDateValue) - date('Z') 可能是错误的

而是使用：

```
$dbDateTimestamp = strtotime($dbDateValue); // where $dbDateValue something like 2012-01-01 22:34:00

$utcTimestamp = strtotime($dbDateTimestamp) - date('Z', $dbDateTimestamp); 
```

这当然依赖于 PHP 和数据库都设置为相同的时区。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-08-26T19:48:18.080

我受到这个问题的启发，编写了一个替代函数来将时间戳转换为所需的时区。

因此，正确的程序步骤来记录、显示（转换）时间：

```
1) record timestamp with time()
2) If you need to get a different timezone, use:
   2.1) Class based:
       2.1.1) DateTime class + setTimezone
       or
       2.1.2) date_default_timezone_set() and then date()

       2.1.1) is better and more flexible than 2.1.2)

    Function:

      function getLTime_class($ts, $uTZ, $format_str="Y.m.d H:i", $sTZ="America/Toronto"){
        // $ts - timestamp recorded with time(); if have date => convert to timestamp: strtotime($date_input); //for ex strtotime('2012-02-17 12:00:00'); => 1345219200 - same value for summer and winter (for toronto timezone);
        // $uTZ - TZ string (ex: 'America/Toronto'); convert timestamp to this TimeZone
        // $sTZ - TZ string (ex: 'America/Toronto'); convert timestamp from this TimeZone
        $TimeZone_server=new DateTimeZone($sTZ);
        $date_obj=new DateTime("@$ts", $TimeZone_server);
        $TimeZone_local=new DateTimeZone($uTZ);
        $date_obj->setTimeZone($TimeZone_local);
        return $date_obj->format($format_str);
      }

    Usage:

     $date_input=$_POST['date_input']; //read from POST
     $ts=strtotime($date_input); //for ex strtotime('2012-02-17 12:00:00'); => 1345219200 - same value for summer and winter (for toronto timezone);
     $userTZ='America/Toronto'; //read from user params
     $result=getLTime_class($ts, $userTZ, 'Y-m-d H:i:s');

   2.2) Non-Class based:

Function:

      //this function replaces the function with DateTime class. It's faster. $uTZoffset is integer.
      function getLTime_nonclass($ts, $uTZoffset, $format_str="Y.m.d H:i"){
        // $ts - timestamp recorded with time(); if have date => convert to timestamp: strtotime($date_input); //for ex strtotime('2012-02-17 12:00:00'); => 1345219200 - same value for summer and winter (for toronto timezone);
        // $uTZoffset - TZ offset (integer) $uTZoffset must consider DTS (for ex: in summer $uTZoffset=-4; in winter $uTZoffset=-5)
        $ts_offset=date('Z',$ts);
        if ($uTZoffset) $add_offset=$ts_offset-date('Z'); //when not UTC
        else $add_offset=0; //when UTC
        return date($format_str,$ts-$ts_offset+$uTZoffset*3600+$add_offset);
      }

    Usage:

     $date_input=$_POST['date_input']; //read from POST
     $ts=strtotime($date_input); //for ex strtotime('2012-02-17 12:00:00'); => 1345219200 - same value for summer and winter (for toronto timezone);
     $uTZoffset=-4; //read from user params. $uTZoffset - TZ offset (integer) $uTZoffset must consider DTS (for ex: in summer $uTZoffset=-4; in winter $uTZoffset=-5)
     $result=getLTime_nonclass($ts, $uTZoffset, 'Y-m-d H:i:s'); 
```

结果：

$date_input = 2012-08-17 12:00:00

```
Server date: summer (2013-08-26)
    getLTime_class      =>  $userTZ='America/Toronto'   =>  2012-08-17 12:00:00
    getLTime_nonclass   =>  $uTZoffset=-4               =>  2012-08-17 12:00:00
    getLTime_class      =>  $userTZ='UTC'               =>  2012-08-17 16:00:00
    getLTime_nonclass   =>  $uTZoffset=0                =>  2012-08-17 16:00:00

Server date: winter (2013-02-26)
    getLTime_class      =>  $userTZ='America/Toronto'   =>  2012-08-17 12:00:00
    getLTime_nonclass   =>  $uTZoffset=-5               =>  2012-08-17 12:00:00
    getLTime_class      =>  $userTZ='UTC'               =>  2012-08-17 16:00:00
    getLTime_nonclass   =>  $uTZoffset=0                =>  2012-08-17 16:00:00 
```

$date_input = 2012-02-17 12:00:00

```
Server date: summer (2013-08-26)
    getLTime_class      =>  $userTZ='America/Toronto'   =>  2012-02-17 12:00:00
    getLTime_nonclass   =>  $uTZoffset=-4               =>  2012-02-17 12:00:00
    getLTime_class      =>  $userTZ='UTC'               =>  2012-02-17 17:00:00
    getLTime_nonclass   =>  $uTZoffset=0                =>  2012-02-17 17:00:00

Server date: winter (2013-02-26)    
    getLTime_class      =>  $userTZ='America/Toronto'   =>  2012-02-17 12:00:00
    getLTime_nonclass   =>  $uTZoffset=-5               =>  2012-02-17 12:00:00
    getLTime_class      =>  $userTZ='UTC'               =>  2012-02-17 17:00:00
    getLTime_nonclass   =>  $uTZoffset=0                =>  2012-02-17 17:00:00 
```

我决定 getLTime_nonclass 希望使转换比使用类更快。我只想确认 getLTime_nonclass 是 getLTime_class 的有效替代品。请随时发表您的意见。谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-24T14:18:25.403

很多时候有任务需要在 GMT+0 中记录 DB 中的时间，但函数 time() 将返回服务器的时间。它可能通过下一个功能解决：

```
/**
     * Converts a local Unix timestamp to GMT
     *
     * @param   int Unix timestamp
     * @return  int
     */
    function local_to_gmt($time = '')
    {
        if ($time === '')
        {
            $time = time();
        }

        return mktime(
            gmdate('G', $time),
            gmdate('i', $time),
            gmdate('s', $time),
            gmdate('n', $time),
            gmdate('j', $time),
            gmdate('Y', $time)
        );
    } 
```

# visual-studio - 完成后停止 Visual Studio 关闭程序

> ID：851578
> 
> 赞同：8
> 
> 时间：2009-05-12T07:32:13.910
> 
> 标签：visual-studio, visual-studio-2008

这可能是一个简单的 Visual Studio 问题，但我在网站上找不到。

当我“开始调试”控制台程序时，它会在完成后立即退出。有没有办法让它在结束时暂停而不在程序末尾放置显式暂停命令？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-12T07:36:58.443

在应用程序完成之前添加一个断点。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-12T07:35:57.913

您可以将 Console.ReadLine 放在程序的末尾。这将迫使程序等待换行符输入。或者您可以在程序的末尾放置断点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T07:34:48.213

“在不调试的情况下运行”可以做到这一点，但我想你还是想调试 :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T08:02:34.643

是的，正如[@matthew](https://stackoverflow.com/questions/851578/stop-visual-studio-from-closing-program-after-finish/851586#851586)所说， Console.ReadKey() 将在执行程序后等待您的输入，但您可以使用 Console.ReadLine() ，它仅在按下 <ENTER> 键时才会终止：

```
void main()
{
    Console.WriteLine("Hello World!"); //:)
    Console.ReadLine();//this will do the trick.
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T07:35:20.910

Console.ReadKey() 应该这样做。它将暂停程序的执行，直到按下键盘上的键。

# apache-flex - AS3/Flex：如何让通过 ViewStack 加载的 mxml 文件看到它们父级的变量等？

> ID：851581
> 
> 赞同：2
> 
> 时间：2009-05-12T07:33:54.690
> 
> 标签：apache-flex, actionscript-3, oop, flex3

对于我在 Flex 中进行的一个项目，我决定为每个可以使用的“主题”创建几个单独的文件。由于每个主题都可以并且将需要特定的代码、图像、样式和几乎任何其他东西，经典的纯 CSS 选项实际上是不可能的。

我对这种方法有一个问题，那就是每个“子”mxml 文件都无法读取在父应用程序中创建的变量等。使用 Application.application 解决了一半的问题，但任何类型的全局变量解决方案对我来说似乎都失败了。由于这个原因，代码也没有变得那么干净。

我创建了一个在主应用程序中加载的类，其中包含一个静态变量，我将其用作与 AS3 等效的全局变量。遗憾的是，无法从这些“子”mxml 文件中访问它，我只能重新启动该类，或者在获取这些变量的主应用程序中编写一个包装函数。同样，这绝不是完美的，并且仍然让我无法使用在父应用程序中启动的类中的方法。

让它正常工作的最佳方法是什么？

应用程序的概要：

1) 主应用程序加载几个类/包，使用适当的设置启动一些等 2) 主应用程序有一个 ViewStack，每个主题都来自外部文件 (themes/ThemeName.mxml) 3) 每个主题都需要访问至少 2 个由主应用程序设置的变量（通过使用已加载的类和方法），有些可能还需要直接访问对主应用程序和特定主题都应该全局可用的某些功能xml。

我希望我的解释有点清楚。请提出任何可能有助于您进一步理解这一点的问题。提前非常感谢！

-戴夫

**小更新：**为了更清楚一点：我有一个类可以让我轻松创建相机视图。我在主应用程序中初始化并使用该类，然后将新的 (web)cam(era) 实例放入一个变量中，以便在需要的任何地方使用。视图文件 (themes/theTheme.mxml) 然后以任何它想要的方式显示 2 个摄像头。我希望视图文件使用在主应用程序中创建的相机，这样我就不必要求主题创建人员一遍又一遍地实现所有这些。这是我为什么需要这个的一个例子。

感谢您到目前为止对我的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-13T00:24:06.410

来自 php 背景，我知道你可能哪里出错了。它不像 php，其中每个文件只是一个可以包含到其他 php 文件中的大块代码。

每个 mxml 文件都是一个成熟的 Actionscript 类。您不是“包括那些 mxml 文件”，您实际上是在您的主 mxml 类中创建属性，并且这些属性的类型是“子”mxml 对象。

如果您的子 mxml 组件确实需要来自父级的一些信息，您应该将这些数据传递给它们。

但是稍微退后一点。您确定要让这些子 mxml 文件完成所有这些工作吗？它们是否只是简单的没有任何逻辑的愚蠢布局？然后你可以让主 mxml 操作它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T22:01:05.693

听起来你已经准备好使用框架了！您可以使用 Dependency Injection 在创建应用程序时对其进行设置。

以下是一些有助于依赖注入的框架。

*   [Bifff](http://bifff.seanhess.net) - 允许您通过 css 选择器在任何视图上设置内容
*   [Glue](http://bifff.seanhess.net) - 基于 bifff 的 MVC 框架
*   [Mate](http://mate.asfusion.com/) - MVC 框架

注意：我是 Bifff and Glue 的作者。

例如，使用 bifff 您可以说以下内容（在 stylename="customStyleName" 的任何组件上设置“thePropertyFromMyFile”变量）

```
<Selector match=".customStyleName">
  <Set thePropertyFromMyFile="{myGlobalSettings.property}"/>
</Selector> 
```

但是，阅读您的描述会使您看起来好像直接需要为您的应用程序提供一个完整的框架。MVC 框架可帮助您将应用程序的数据（在您的情况下，您所处的显示模式）与视图分开，而不需要视图调用 Application.application 或全局单例。

这将需要您进行更多研究，但这是正确的道路。任何 flex 应用程序都可以从框架中受益，选择最适合您的框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-10-08T18:27:40.750

你可以很容易地做到这一点。以 OOP 方式考虑它。每个 mxml 都是不同的类。您想在另一个类中调用一个类的方法。如果您希望它在其原始范围内运行，请将方法变量设为静态并通过 MXMLFileName.MethodName(); 调用它

如果要在其自己的范围内执行，请创建父 MXML 的对象，然后调用该方法。

# c++ - 默认模板类参数混淆 g++？

> ID：851584
> 
> 赞同：9
> 
> 时间：2009-05-12T07:34:07.870
> 
> 标签：c++, templates, gcc, g++, intel

昨天我遇到了一个 g++ (3.4.6) 编译器问题，我使用 Intel (9.0) 编译器编译的代码没有问题。这是一个显示发生了什么的代码片段：

```
template<typename A, typename B>
class Foo { };

struct Bar {
   void method ( Foo<int,int> const& stuff = Foo<int,int>() );
}; 
```

g++ 编译器错误是：

```
foo.cpp:5: error: expected `,' or `...' before '>' token
foo.cpp:5: error: wrong number of template arguments (1, should be 2)
foo.cpp:2: error: provided for `template<class A, class B> struct Foo'
foo.cpp:5: error: default argument missing for parameter 2 of `void Bar::method(const Foo<int, int>&, int)' 
```

显然，以这种方式编写时不接受默认参数，并且编译器假定指定了新的函数参数而不是第二个模板参数，然后它需要一个默认值，因为该`stuff`参数有一个。我可以通过创建 typedef 来帮助编译器，然后一切都编译得很好：

```
template<typename A, typename B>
class Foo { };

struct Bar {
   typedef Foo<int,int> FooType;
   void method ( FooType const& stuff = FooType() );
}; 
```

所以我可以解决我的问题，但我不明白发生了什么。我是否在这里错过了 C++（模板？）语言功能，我做错了什么，还是 g++ 编译器不接受第一段代码是错误的？

注意顺便说一句，这也编译...

```
template<typename A, typename B>
class Foo { };

void method ( Foo<int,int> const& stuff = Foo<int,int>() ); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-12T08:38:08.670

我不太确定这是 g++ 中的错误（从 4.2.4 版开始）。代码现在在 g++ 4.4 中传递（参见下面的更新）。为了让此代码为其他版本的编译器编译，您可以在默认参数周围添加一组括号：

```
template<typename A, typename B>
class Foo { };

struct Bar {
  void method ( Foo<int,int> const& stuff = ( Foo<int,int>() ) );
}; 
```

IMO，这些括号是必要的，因为还有一个额外的要求，即默认参数可以引用类的成员，该成员可以稍后在类主体中声明：

```
struct Bar {
  void method ( int i = j);  // 'j' not declared yet
  static const int j = 0;
}; 
```

上面的代码是合法的，当解析“方法”的声明时，还没有看到成员“j”。因此，编译器只能使用*语法*检查来解析默认参数（即匹配括号和逗号）。当 g++ 解析您的原始声明时，它实际看到的是以下内容：

```
void method ( Foo<int,int> const& stuff = Foo<int // Arg 1 with dflt.
              , int>() );                         // Arg 2 - syntax error 
```

添加额外的括号集可确保正确处理默认参数。

以下案例显示了 g++ 成功但 Comeau 仍然生成语法错误的示例：

```
template<int J, int K>
class Foo { };

struct Bar {
  void method ( Foo<0, 0> const & i = ( Foo<j, k> () ) );
  static const int j = 0;
  static const int k = 0;
}; 
```

**编辑：**

回应评论：“你也可以在那里有一个带有多个参数的函数调用”，这不会导致问题的原因是函数调用中的逗号被括号括起来：

```
int foo (int, int, int);
struct Bar {
  void method ( int j =
                    foo (0, 0, 0) ); // Comma's here are inside ( )
}; 
```

因此，可以仅使用表达式的*语法对其进行解析。*在 C++ 中，所有的 '(' 必须与 ')' 匹配，所以这很容易解析。这里问题的原因是 '<' 不需要匹配，因为它在 C++ 中被重载，因此可以是小于运算符或模板参数列表的开头。以下示例显示了在默认参数中使用 '<' 并暗示小于运算符的位置：

```
template<int I, int J>
class Foo { };

struct Bar {
  template <typename T> struct Y { };

  void method ( ::Foo<0,0> const& stuff = Foo<10 , Y < int >  = Y<int>() );

  struct X {
    ::Foo<0, 0> operator< (int);
  };

  static X Foo;
}; 
```

上面的“Foo<10”是对“X”中定义的“operator<”的调用，而不是模板参数列表的开始。同样，Comeau 在上述代码上生成语法错误，而 g++（包括 3.2.3）会正确解析它。

仅供参考，适当的参考是 8.3.6/5 中的注释：

> [注意：在成员函数声明中，默认参数表达式中的名称按照 3.4.1 中的描述进行查找...

然后在 3.4.1/8

> 在函数的 declaratorid29 之后的类 X 的成员函数 (9.3) 的定义中使用的名称应以下列方式之一声明：

...

> — 应为 X 类的成员或 X (10.2) 的基类的成员，或

这里的这个项目符号是强制编译器“延迟”查找默认参数的含义的部分，直到所有类成员都被声明。

**<更新>**

正如“Employed Russian”所指出的，g++ 4.4 现在能够解析所有这些示例。但是，在 C++ 标准委员会解决[DR](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#325)之前，我还没有准备好将其称为“错误”。我相信需要长期的额外括号来确保对其他编译器/工具（甚至可能是 g++ 的未来版本）的可移植性。

根据我的经验，C++ 标准并没有规定编译器供应商都应该使用相同的解析器技术，他们也不能期望所有技术都同样强大。因此，解析需求通常不需要供应商执行超人的壮举。为了说明这一点，请考虑以下两个示例：

```
typedef T::TYPE TYPE;
T::TYPE t; 
```

如果'T'是依赖的，那么给定每个上下文'TYPE'**必须**是一个类型名，但是标准仍然需要*类型名*关键字。这些示例是明确的并且只能表示一件事，但是标准（为了允许所有解析器技术）仍然需要*typename*关键字。

只要额外的括号允许代码解析，DR 可能会以这样一种方式解决，即无法解析这些示例的编译器仍将是“符合标准的”。

**</更新>**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T19:50:20.117

这是 gcc 中的一个已知[错误](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=57)。它已在 gcc-4.4 中修复，它可以很好地编译原始源代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T07:55:37.210

看起来像一个编译器错误。我在 IBM 的 xlC 编译器 V7.0（我发现它比 gcc 更符合标准）上进行了尝试，它编译得很好。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-08-15T15:08:29.097

```
template <bool> class A {};
typedef A<static_cast<bool>(1>0)> B;//buggy
int main() { B b; } 
```

# python - 使用 ctypes.c_void_p 作为 glTexImage2D 的输入？

> ID：851587
> 
> 赞同：1
> 
> 时间：2009-05-12T07:35:45.620
> 
> 标签：python, opengl, ctypes, pyopengl

我正在使用第 3 方 DLL 加载一些原始图像数据，并且我想将此原始图像数据用作 openGL 中的纹理。但是，c 函数返回一个 void*，我需要以某种方式将其转换为 glTexImage2D 的“像素”参数。现在我的代码看起来像这样：

```
data = c_void_p(vdll.vlImageGetData()) 
glTexImage2D(GL_TEXTURE_2D, 1, GL_RGB8, 1024, 1024, 0, GL_RGB, GL_UNSIGNED_BYTE, data ) 
```

但是，我收到一个 TypeError 抱怨数据“无法转换为指针”。有谁知道如何让它工作？

编辑：想通了。基本上我做的是这样的：

```
data = create_string_buffer( BUFFER_SIZE )
data = dll.vlImageGetData()
glTexImage2D(GL_TEXTURE_2D, 1, GL_RGB8, 1024, 1024, 0, GL_RGB, GL_UNSIGNED_BYTE, data ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T08:00:35.533

建议使用类似[问题](https://stackoverflow.com/questions/318067/python-converting-strings-for-use-with-ctypes-cvoidp)的[答案](https://stackoverflow.com/questions/318067/python-converting-strings-for-use-with-ctypes-cvoidp/318140#318140)。`ctypes.cast()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T05:04:26.233

这可能有帮助，也可能没有帮助。使用 c_void_p 作为返回类型也有类似的问题。相反，我必须返回 c_longlong 并做一些恶作剧：

如果我要返回一个指针 c_types obejct，我必须将其对 POINTER 的引用转换为 c_longlong 以获取要返回的整数值。（注意 CFUNCTYPE 不接受 POINTER(x) 类型作为返回类型）：

retvalp = cast( byref(retval), POINTER(c_longlong)) #retval 是我想要返回的 return retvalp.contents.value

# webpage - 我想知道一个特定的网页是否使用 javascript 完全加载

> ID：851593
> 
> 赞同：2
> 
> 时间：2009-05-12T07:37:38.037
> 
> 标签：webpage

我想知道一个特定的网页是否使用 javascript 完全加载

例如）一个网页可以有通过 Ajax 显示的动态内容，或者通过 javascript、所有图像和 css 显示的内容。我需要找出所有这些内容何时正确加载以及网页是否稳定。

我得到了一些指针，例如 ondocumentready，它是 window.onload、onreadystatechange 的替代方案，但这些解决方案不可靠，有时它可以工作，有时它不能

此外，该解决方案应该独立于浏览器，即它应该适用于所有浏览器

对此的任何指示将不胜感激

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T07:41:03.023

使用[jQuery](http://jquery.com/)及其简单：

```
<script type="text/javascript">
    $(document).ready(function() {
        alert('doc is ready');
        });
    });
</script> 
```

*   独立于浏览器
*   高度可靠
*   惊人的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T07:44:08.430

您还可以使用以下内容。这是@cottsak 发布的代码的简写版本

```
$(function() 
{ 
     // your code 
}); 
```

如果您使用**jQuery.noConflict()**（用于将 $ 变量的控制权交还给首先实现它的任何库），您可以这样做：

通过添加jQuery.noConflict()，jquery不会与其他库的$变量冲突

```
jQuery(function($) 
{ 
       // your code
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T07:51:37.717

使用纯 javascript，您可以将 javascript 放在 body 标记的 onload 事件中，如下所示：

```
<body onload="function"> 
```

这将在页面完成加载时触发。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-10T08:27:26.577

作为[@Rigobert](https://stackoverflow.com/a/851633/1587329)和[@cottsack](https://stackoverflow.com/a/851602/1587329)两个答案的比较：

`window.onload`：

> 应该只用于检测完全加载的页面。

所以它应该很适合你的问题。

而`$(document).ready(`火灾（在大多数情况下，取决于浏览器）

> 当初始 HTML 文档已完全加载和解析时，无需等待样式表、图像和子框架完成加载。

另请参阅[window-onload-vs-document-ready](https://stackoverflow.com/questions/3698200/window-onload-vs-document-ready)和[DOMContentLoaded 事件](https://developer.mozilla.org/en-US/docs/Web/Events/DOMContentLoaded)（这似乎触发了 JQuery 的 $(document).ready()）。[jquery-ready-vs-window-onload](https://stackoverflow.com/questions/21742867/jquery-ready-vs-window-onload)也有一个很好的答案。

# regex - [Perl]：读取目录和文件，以及正则表达式

> ID：851594
> 
> 赞同：2
> 
> 时间：2009-05-12T07:38:04.230
> 
> 标签：regex, perl

从这个字符串中`(champs1 (champs6 donnee_o donnee_f) [(champs2 [] (champs3 _YOJNJeyyyyyyB (champs4 donnee_x)) (debut 144825 25345) (fin 244102 40647)), (champs2 [] (champs3 _FuGNJeyyyyyyB (champs4 donnee_z)) (debut 796443 190570) (fin 145247 42663))] [] []).`，我想提取单词“debut”之后的第一个数字，以及单词“fin”之后的第一个数字。我写这个：

```
while (my $readfile = <FILE>) #read each line and check the first value X1 after the word "coorDeb" and the first value X2 after the word "coorFin"
{
    my ($line) = $_;
    chomp ($line);

    ($first, $second)= ~m/coorDeb/\s\S*\s\S*\s\S*\s\S*\s\S*; #CoorDeb first, following by X1

    $X1=$first; $X4=$second;
    $lenght1=$second-$first; # Calculation of the lenght of first segment

    $line  =~ m//coorFin/(\s*)\S*\s*\S*\s*\S*\s*\S*\s*(\S*/); #CoorFin first, following by X1
    $lenght2=$second-$first; # Calculation of the lenght of first segment

    push(@elements1, $lenght1); #Push the lenght into a table to compute the mean of lenght for the segment n°1
    push(@elements2, $lenght2); #Push the lenght into a table to compute the mean of lenght for the segment n°2
} 
```

任何人都可以帮我使用正则表达式吗？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T10:39:39.393

通过尝试对字段进行计数并计算行中的偏移量等，您使这种*方式变得过于复杂。*假设您正在寻找匹配的首次亮相/鳍对，您可以使用

```
#!/usr/bin/perl

use strict;
use warnings;

my @elements;
while (<DATA>) {
  my $line = $_;
  push @elements, $line =~ /debut (\d+).*?fin (\d+)/g;
}

print join ',', @elements;
print "\n";
__DATA__
(champs1 (champs6 donnee_o donnee_f) [(champs2 [] (champs3 _YOJNJeyyyyyyB (champs4 donnee_x)) (debut 144825 25345) (fin 244102 40647)), (champs2 [] (champs3 _FuGNJeyyyyyyB (champs4 donnee_z)) (debut 796443 190570) (fin 145247 42663))] [] []) 
```

此代码生成输出

```
144825,244102,796443,145247 
```

（`$line`甚至不需要，因为默认情况下`m//`运行`$_`，但我把它留在那里，以防你真的需要对其进行其他处理。并且`push @elements, /debut (\d+).*?fin (\d+)/g;`比我觉得在这里更合适。）

如果您不关心匹配对，您还可以使用两个单独的数组并将该`push`行替换为

```
push @debuts, $line =~ /debut (\d+)/g;
push @fins, $line =~ /fin (\d+)/g; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T10:28:28.693

如果我理解正确，您只需要读取一个文件，然后找到两个值。这些值是单词“fin”和单词“debut”之后的一系列数字。现在，您正试图通过查找出现在您感兴趣的字符串之前的内容来匹配这些内容。也许您应该寻找感兴趣的实际信息。

在正则表达式中，寻找有趣的文本几乎总是比尝试跳过不感兴趣的文本更好。像下面这样的东西会更好。

请注意，我已经更改了您读取的文件，因为您正在读取一个变量然后处理 $_ 这（几乎肯定）不是您的意思。

```
while (my $line = <FILE>) #read each line from FILE.
{
    chomp ($line);

    # These two lines could be combined but this is a little clearer.
    # Matching against [0-9] because \d matches all unicode digits.
    my ($fin_digits) = $line =~ /fin\s+([0-9]+)/;   
    my ($debut_digits) = $line =~ /debut\s+([0-9]+)/; # as above.

    # Continue processing below...
} 
```

现在，一个区别是您的示例数据在一行中显示了多次出现的 fin 和 detail 。如果是这种情况，您将需要一个稍微不同的正则表达式。让我们都知道是否真的是这样。

更新

鉴于您确实在同一行上确实有匹配对，您可能希望使用类似以下的内容。同样，我只输入了正则表达式匹配，而不是处理代码。这段代码实际上允许在一行上任意数量的对。

```
while (my $line = <FILE>) #read each line from FILE.
{
    chomp ($line);

    # These two lines could be combined but this is a little clearer.
    # Matching against [0-9] because \d matches all unicode digits.
    # In list context, m// returns the matches in order, the /g modifier
    # makes this a global match - in a loop this means each pair of
    # matches will be returned in order.
    while (my ($debut, $fin) =~ /debut\s+([0-9]+).+?fin\s+([0-9]+)/g)
    {
           # result processing here.
    }

} 
```

# c# - 为什么 INotifyPropertyChanged 不更新 XAML 中的变量？

> ID：851595
> 
> 赞同：4
> 
> 时间：2009-05-12T07:38:34.680
> 
> 标签：c#, wpf, xaml, data-binding, inotifypropertychanged

我想模拟模型中的数据更改并将该数据反映在 XAML 中。据我了解，我需要实现 INotifyPropertyChanged。

但是，在以下代码示例中，XAML 仅显示来自客户的数据一次，但日期和时间不会更改。

**在以下示例中，我必须更改哪些内容才能使 XAML 在模型中更改时不断显示当前日期和时间？**

特别是，我不明白绑定如何知道何时检查模型，每秒？每秒10次？它没有响应任何事件。我在这里想念什么？

**XAML：**

```
<Window x:Class="TestBinding99382.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:TestBinding99382"
    Title="Window1" Height="300" Width="300">

    <Window.Resources>
        <ObjectDataProvider 
              x:Key="DataSourceCustomer" 
              ObjectType="{x:Type local:ShowCustomerViewModel}" 
              MethodName="GetCurrentCustomer"/>
    </Window.Resources>

    <DockPanel DataContext="{StaticResource DataSourceCustomer}">
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
            <TextBlock Text="{Binding Path=FirstName}"/>
            <TextBlock Text=" "/>
            <TextBlock Text="{Binding Path=LastName}"/>
        </StackPanel>
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
            <TextBlock Text="{Binding Path=TimeOfMostRecentActivity}"/>
        </StackPanel>

    </DockPanel>
</Window> 
```

**代码背后：**

```
using System.Windows;
using System.ComponentModel;
using System;

namespace TestBinding99382
{
    public partial class Window1 : Window
    {
        public Window1()
        {
            InitializeComponent();
        }
    }

    //view model
    public class ShowCustomerViewModel : INotifyPropertyChanged
    {
        private Customer _currentCustomer;

        public Customer CurrentCustomer
        {
            get
            {
                return _currentCustomer;
            }

            set
            {
                _currentCustomer = value;
                this.RaisePropertyChanged("CurrentCustomer");
            }
        }

        public ShowCustomerViewModel()
        {
            _currentCustomer = Customer.GetCurrentCustomer();
        }

        public Customer GetCurrentCustomer()
        {
            return _currentCustomer;
        }

        public event PropertyChangedEventHandler PropertyChanged;
        private void RaisePropertyChanged(string property)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(property));
            }
        }
    }

    //model
    public class Customer : INotifyPropertyChanged
    {
        private string _firstName;
        private string _lastName;
        private DateTime _timeOfMostRecentActivity;

        public string FirstName
        {
            get
            {
                return _firstName;
            }
            set
            {
                _firstName = value;
                this.RaisePropertyChanged("FirstName");
            }
        }

        public string LastName
        {

            get
            {
                return _lastName;
            }
            set
            {
                _lastName = value;
                this.RaisePropertyChanged("LastName");
            }
        }

        public DateTime TimeOfMostRecentActivity
        {

            get
            {
                return _timeOfMostRecentActivity;
            }
            set
            {
                _timeOfMostRecentActivity = value;
                this.RaisePropertyChanged("TimeOfMostRecentActivity");
            }
        }

        public static Customer GetCurrentCustomer()
        {
            return new Customer 
                     { FirstName = "Jim"
                       , LastName = "Smith"
                       , TimeOfMostRecentActivity = DateTime.Now};
        }

        public event PropertyChangedEventHandler PropertyChanged;
        private void RaisePropertyChanged(string property)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(property));
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T08:26:06.833

也许我没有得到你希望这段代码做的事情。

您已经创建了一个实现 INotifyPropertyChanged 的​​客户对象。您有另一个类，它是 XAML 获取实例的工厂。现在，您创建一个具有预定义属性的 Customer 实例。视图显示它们。除非您以某种方式更改属性，否则视图将不会更新。

我在您的 WPF 视图中添加了一个按钮

```
<Button DockPanel.Dock="Bottom" 
        x:Name="UpdateTime" 
        Click="UpdateTime_Click">
                 Update Activity Timestamp
 </Button> 
```

C#代码隐藏：

```
private void UpdateTime_Click(object sender, RoutedEventArgs e)
{
     Customer.GetCurrentCustomer().TimeOfMostRecentActivity = DateTime.Now;
} 
```

我还更改了客户类型以为当前客户创建单个实例

```
private static Customer _CurrentCustomer;

public static Customer GetCurrentCustomer()
{
    if (null == _CurrentCustomer)
    {
        _CurrentCustomer = new Customer 
        {   FirstName = "Jim"
           , LastName = "Smith"
           , TimeOfMostRecentActivity = DateTime.Now 
         };
    }
         return _CurrentCustomer;
} 
```

现在每次我单击按钮时，`DateTime`属性都会被修改，并且视图会由于`INotifyPropertyChanged`机制而自动更新。该代码似乎正在运行 AFAISee。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T08:06:23.277

您的代码工作正常。当前日期和时间不会被魔法自动更新。您必须实现一些计时器来更新它。

例如，您可以将其添加到您的客户类中：

```
private Timer _timer;

public Customer()
{
    _timer = new Timer(UpdateDateTime, null, 0, 1000);
}

private void UpdateDateTime(object state)
{
    TimeOfMostRecentActivity = DateTime.Now;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T07:42:18.917

您似乎绑定到`Customer`，并且`Customer` *没有*实现`INotifyPropertyChanged`。尝试实施`INotifyPropertyChanged`on `Customer`，看看是否可以解决它。这将需要移动到手动属性（而不是自动实现的属性）以引发事件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T07:44:01.397

您的客户类需要实现 INotifyPropertyChanged，并且您需要在客户属性的 setter 方法期间调用该事件。

**编辑**：再次查看了您的代码，我想知道您的 ShowCustomerViewModel 类是否需要侦听 _currentCustomer PropertyChanged 事件并将其作为自己的 PropertyChangedEvent 转发。值得一试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T07:56:49.020

你能检查 GetCurrentCustomer() 被调用了多少次吗？也许它只是一直在重新创建新实例。

# php - 我在哪里可以找到 facebook php 类参考？

> ID：851599
> 
> 赞同：2
> 
> 时间：2009-05-12T07:40:15.990
> 
> 标签：php, class, facebook

例如，有一个 set_user 函数

$facebook->set_user

但我在 facebook 开发者 wiki 搜索框中输入了 set_user，它返回“没有标题为“set_user”的页面”

[http://wiki.developers.facebook.com/index.php/Special:Search?search=set_user&go=Go](http://wiki.developers.facebook.com/index.php/Special:Search?search=set_user&go=Go)

在哪里可以找到 facebook 对象用户对象等的函数和属性列表？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-22T13:08:43.907

Developers wiki 基本上只记录原始 API。官方的 PHP 库是这个 API 的一个精简（-nish）包装器，并在其注释中包含一些最小的 phpdoc 文档。

如果您想为该库生成文档，您需要一份[phpDocumentor](http://www.phpdoc.org/)（以及安装的 CLI 版本的 PHP）。然后你可以运行：

```
./phpdoc -t /path/to/write/documentation -o HTML:default:default -d /path/to/facebook-platform/php/ 
```

或在 Windows 中：

```
php.exe "C:\Path\To\phpdoc" -t C:\Path\For\Documentation -o HTML:default:default -d C:\Path\To\facebook-platform\php 
```

生成一些本地 HTML 文档。但是就像我说的那样，它非常小，并且与仅阅读与代码内联的文档相比没有太大的好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-07-22T07:29:11.710

我可能已经找到了你要找的东西。检查[http://wiki.developers.facebook.com/index.php/JS_API_T_FB.Facebook](http://wiki.developers.facebook.com/index.php/JS_API_T_FB.Facebook)

如果向下滚动，您可以查看整个命名空间。

花了很多时间才找到这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T14:29:38.330

[从http://wiki.developers.facebook.com/index.php/PHP](http://wiki.developers.facebook.com/index.php/PHP)下载官方 Facebook PHP 客户端库包，如果打开 facebookapi_php5_restlib.php，您可以看到方法和属性。

# architecture - 集会中的责任分离

> ID：851609
> 
> 赞同：1
> 
> 时间：2009-05-12T07:43:58.930
> 
> 标签：architecture

我们正在开发一个 Asp.net 项目。它有两部分，第一部分供公众用户使用（用于互联网），另一部分供组织内部使用。**内网**侧的流程和对象更加复杂、庞大和复杂。

尽管两个站点都将使用相同的数据库（使用由[SubSonic](http://subsonicproject.com)生成的 DAL 连接），因此两者可以有相同的库，但它们操作对象和所涉及的业务逻辑的方式在双方都非常不同。现在我的困境是：

1) 将 bll 文件保存在不同的命名空间中，例如 ( `public.bll`, `internal.bll`) 和不同的项目（*请注意两者的职责和业务逻辑不同*）
或
2) 将所有 bll 保存在一个命名空间中 ( `project.bll`)

（bll：[业务逻辑层](http://en.wikipedia.org/wiki/Business_layer)，在[Visual Studio](http://dotnetstories.wordpress.com/2008/11/26/working-with-dal-data-access-layer-bllbusiness-logic-layer-in-aspnet-web-applications/)中使用）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T07:57:45.383

我认为你应该考虑第三种选择——分成*三*组：

1) **`public.bll`**- 所有仅特定于公共区域的逻辑。
2) **`internal.bll`**- 仅特定于内部区域的所有逻辑。
3) **`shared.bll`**- 两个区域都将使用的所有逻辑，例如 DAL。

然后，您将包括**`shared.bll`**在这两个项目中。

# flex3 - Adobe Air 中的屏幕共享

> ID：851614
> 
> 赞同：3
> 
> 时间：2009-05-12T07:44:25.327
> 
> 标签：flex3, air, adobe

我正在 Adob​​e Air 中制作白板应用程序。我想与其他用户共享我的屏幕并允许他访问我的桌面，类似于远程桌面。

我试着用谷歌搜索，但没有发现任何有用的信息。

任何人都可以给我一些有用的指针来调查它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T19:23:43.157

我认为没有任何东西可以开箱即用地满足您的需求。

我认为，理论上，您可以每 x 毫秒抓取一次舞台的屏幕截图并将其发送到另一端。但这将是要传输的大量数据。您应该制定一种算法，该算法仅发送有关屏幕中哪些像素实际发生变化的信息，以提高效率。也许你可以移植一个开源 C 库？

一旦你有了一个超级高效的算法，你就可以使用[Flash player 10 的新 P2P 功能](http://blog.zarate.tv/2008/11/28/adobe-stratus/)来加速信息的交换。但看起来工作量很大。

您也可以走开源路线，忘记 AIR 及其启动外部应用程序的限制，并使用[SWHX](http://haxe.org/com/libs/swhx)和任何 C 库来完成实际工作。对我来说听起来更合理。

或者也许已经完成了一些我只是不知道的事情。

我把这更多地作为奖励，Darron Schall之前[在 AS3 中写了一个 VNC 客户端](http://osflash.org/fvnc)，它不完全是你需要的，但它是相关的。

祝你好运 ： ）

胡安

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-06-11T09:21:58.120

好的，经过大量的谷歌搜索、研究和浏览论坛和博客后，我能找到的最佳解决方案是使用 Adob​​e-Java Merapi Bridge。

Merapi 允许您将 adobe air 应用程序连接到 java 应用程序并调用其方法。

谷歌搜索默拉皮，你的问题就解决了！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-11-05T15:46:41.363

使用 Jscrcap 来做到这一点，但它不会让你控制其他用户的屏幕。

这是链接：

[http://www.splitmedialabs.com/vh-java-capture-sdk](http://www.splitmedialabs.com/vh-java-capture-sdk)

# testing - 指定简单模型方法的方法

> ID：851618
> 
> 赞同：1
> 
> 时间：2009-05-12T07:45:16.510
> 
> 标签：testing, rspec, bdd

现在我有一个类似这样的模型函数：

```
Class Address
  def first_line
    "#{self.building_name} #{self.street_name} #{self.suburb}".squeeze(" ").strip
  end
end 
```

我的地址工厂是这样定义的：

```
Factory.define :address do |f|
  f.building_name "Alpha"
  f.street_name "Bravo St"
  f.suburb "Charlie"
end 
```

编写规范基本上有两种方法，第一种是：

```
before(:each) do
  @address = Factory.build(:address)
end

@address.first_line.should == @address.building_name + " " +
                              @address.street_name + " " + 
                              @address.suburb 
```

而另一种方式是

```
@address.first_line.should == "Alpha Bravo St Charlie" 
```

你认为哪种方式更好？支持一个反对另一个的原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T09:42:10.250

两者都不。第一个有点冗长，并且感觉与该方法的实现有点过分。第二个将您的规格与您的工厂紧密结合在一起，当您需要更改工厂时，这将是一个巨大的痛苦。

相反，使用短秒样式，但在规范中明确使用数据：

```
@address = Factory.build(:address, :building_name => "Alpha",
                                   :street_name => "Bravo St.",
                                   :suburb => "Charlie")

@address.first_line.should == "Alpha Bravo St. Charlie" 
```

这也很好，因为您可以为该方法提供不同的测试数据，这是测试它的一些其他功能所必需的：

```
@address = Factory.build(:address, :building_name => "Alpha    ",
                                   :street_name => "   Bravo St. ",
                                   :suburb => "   Charlie   " )

@address.first_line.should == "Alpha Bravo St. Charlie" 
```

# asp-classic - 页面加载 - 在经典 asp 中强制刷新？

> ID：851619
> 
> 赞同：4
> 
> 时间：2009-05-12T07:45:34.577
> 
> 标签：asp-classic, refresh, pageload

话题说了算。短版：我需要一种方法来强制刷新页面仅在第一个页面加载。在 asp.net 中会很容易，但我不知道如何在经典 asp 中解决这个问题。

更长的版本：我正在尝试更新一个相当大的应用程序，它的一个问题是当您登录时，它还没有将必要的信息存储到会话中，除非您单击一些特定按钮或刷新页面。 . 这会在客户尝试浏览页面时导致问题。

我可以跟踪会话并手动设置它们，但我已经失败了几个小时，所以强制刷新会容易得多。如果只有一种方法可以检测初始页面加载，那么我就不会导致循环。重定向也是不可能的，因为应用程序有太多代码（所有这些实际上都没有注释和杂乱无章），我无法看到它实际上是如何构建所有验证校验和等的。

编辑：感谢您的回复，并对迟到的答案感到抱歉。从你们那里得到了一些好主意。:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T07:54:18.697

1.  检查会话 cookie 是否是第一次加载（`true`= 之前已加载，`false`= 第一次加载）。

2.  一种。如果`false`，添加一个将页面重新加载到响应中的 js，并将 cookie 设置为`true`
    b。如果`true`，什么也不做。页面已重新加载。

只要用户不断更新会话，这应该只会使第一次加载立即重新加载。

**编辑：**作为对评论的回应，以下是会导致客户端页面重新加载的 javascript 示例。据我所知，这是独立于浏览器的：

```
<script type="text/javascript">window.reload();</script> 
```

* * *

*（我确实承认这看起来有点像 hack，但它会起作用。可能有其他方法可以使页面重新加载，而无需发送额外的 javascript 命令，但我不知道 Classic ASP 中的任何方法。）*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T08:05:25.993

尝试以下 3 个步骤：

1.  *在表单标签内添加一个名为firstload*的隐藏文本框 ，并将其默认值设置为“true”
2.  在 Window.Onload() 期间将 javascript 方法添加到页面以执行。javascript 应该检查*firstload*文本框的值，如果它为“true”，则重新加载页面，并将参数附加到查询字符串 (?reloaded=true)
3.  在服务器端代码中，检查重新加载的查询字符串是否为真。如果是，则将*firstload*的值设置为“false”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T08:19:42.913

只需在您的应用程序中添加一个新页面，登录后重定向该页面.. 我的意思是，当客户端在 login.asp 中完成登录作业时。重定向 login2.asp.. 将 login2.asp 内容设置为一个简单的脚本..

```
<script type="text/javascript">window.location.href="home.asp"</script> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T08:44:38.537

使用 VBScript。

您可以通过重定向到自身并使用**查询字符串**变量来重新加载页面：

```
<%
  Dim reload: reload = Request.Querystring("re") 
  If reload = "" Then
    Response.Redirect("samepage.asp?re=true")
  End If
%> 
```

作为替代方案，您可以设置**会话**变量并检查：

```
<%
  If Session("reload") = "" Then
    Session("reload") = "true"
    Response.Redirect("samepage.asp")
  End If
%> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T07:55:19.753

`window.location="currentUrl?reloaded=true"`如果说查询字符串参数'reloaded' == true，则在文档准备好的jQuery中重新加载页面。

像这样的东西：

```
<script type="text/javascript">
    $(document).ready(function() {
        if(!urlContainsReloadedIsTrue())
            window.location="currentUrl?reloaded=true";
        });
    });
</script> 
```

[你可以用这样](http://www.mail-archive.com/discuss@jquery.com/msg06376.html)`urlContainsReloadedIsTrue()`的东西来构建函数。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-25T11:58:21.393

由于某种未知的原因，我在让 javascripts 工作时遇到了问题，所以最后我使用了这个简单的 codelet：

```
    如果会话（“Firstupdate”）<>“更新”那么
        Response.AddHeader "刷新", "0"
        session("Firstupdate") = "更新"
    别的
        Response.AddHeader "刷新", ""
        Session.Contents.Remove("Firstupdate")
    万一

```

这似乎独立于任何脚本，并且对于我的目的来说工作得很好。理想情况下，删除会话意味着虽然任何额外的刷新将再次强制页面进行 2 次刷新，但至少当更多客户涌入时，服务器不会加载无用的会话。我宁愿设置“Session.Timeout”明确地为“Firstupdate”变量，但显然超时对于整个会话对象及其包含的变量是通用的。

再次抱歉，回复晚了，感谢您的帮助。

# java - 为什么java安全编码很重要？

> ID：851623
> 
> 赞同：6
> 
> 时间：2009-05-12T07:47:20.640
> 
> 标签：java, encapsulation, security

我无法理解为什么 java 安全编码很重要。例如，为什么将变量声明为私有很重要？我的意思是我知道这将使从类外部访问这些变量变得不可能，但我可以简单地反编译类来获取值。类似地，将一个类定义为 final 将使该类无法子类化。什么时候子类化一个类会对安全造成危险？如果有必要，我可以再次反编译原始类并使用我想要的任何恶意代码重新实现它。当应用程序被用户“信任”时，问题是否会出现？然后人们会以某种方式滥用这种信任吗？基本上我正在寻找的是一个很好的例子，说明为什么应该遵循安全编码准则。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-12T07:50:11.557

编程很难。

如果你定义了严格的 API，不暴露不应该暴露的变量（我们喜欢称之为[封装](http://en.wikipedia.org/wiki/Encapsulation_%28computer_science%29)），你可以帮助你的 API 的用户，从而使编程更容易。这被认为是一件好事。

原因主要不是“安全性”，如将秘密事物保密，而是清晰、简单和易于理解。

作为奖励，如果您知道 API 的用户没有在您背后更改“您的”变量，那么使事情正常工作会容易得多，当然。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T07:51:53.833

它是“安全的”，意味着类内部工作对任何使用它的人都是隐藏的。

术语安全不是在“保护服务器”中使用的，用于表示一个类的用户不必担心该类将如何执行他想要的任务。

以你为例：

暴露一个类的变量会让你的类的用户知道他们的存在，这是你不想要的，例如：你只需按下一个按钮来打开灯，你现在不需要在里面是铜还是执行任务所需的其他东西。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T08:07:53.307

Java 是一[门面向对象的编程](http://en.wikipedia.org/wiki/Object-oriented_programming)语言，而面向对象编程的关键概念之一就是[封装](http://en.wikipedia.org/wiki/Encapsulation_(computer_science))。

封装背后的想法是“隐藏”实现细节，例如保存对象状态的内部变量和算法等内部工作，只提供其他对象可以使用的接口，以便与对象执行功能.

使用这个概念，人们想通过使用`private`变量来隐藏内部状态，以防止其他对象直接影响内部状态。在 Java 中，通常会看到 getter 和 setter（例如`getColor`和`setColor`）来处理对象。

此外，封装也可以增加代码的健壮性。

例如，通过限制对内部状态的访问，可以在更改对象之前执行一些健全性检查。

作为一个可靠的例子，假设有一个`Score`对象的`percent`值介于`0`和之间`100`。通过提供一种`setPercent(int)`验证指定值是否在允许范围内的方法，可以防止将`Score`对象设置为不可接受的状态。

因此，如果方法导致错误或如果指定的值不可接受，则尝试通过编写类似语句来直接操作内部状态`score.percent = 150`是可以避免的。`setPercent``Exception`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-12T08:07:24.477

这里有两个问题。

第一次将变量声明为受保护或私有时，它们不会成为您的公共 API 的一部分。未来其他类可能取决于您的类，如果您想包含新功能、提高性能等，请尽可能自由地进行更改。如果您的所有价值观都是公开的，而不是您内部的所有价值观价值观和机制是公开的。更改它们可能会破坏其他依赖于您的课程。

第二，当暴露变量时，它允许其他类改变你的值。如果他们改变了你的内部价值观，可能会破坏你的程序，并产生奇怪的意外行为。如果您创建的系统依赖于您的类的准确性能，并且内部值发生了变化，那么您将无法再依赖该系统。子类化使这更加复杂。您的系统可能依赖某个特定类型的类来执行预期的操作。通过子类化，可以创建一个看起来是相同类型但不执行预期操作的新类。

例如，如果您有一个带有受保护函数 getArea() 的类 square，您希望返回正方形的面积。但是，可以创建一个扩展正方形的新类，例如矩形类扩展正方形。现在rectange 可以覆盖getArea()，但它仍然是square 类型，这可能会破坏一些依赖于square 功能的东西。通过使您的课程成为最终课程，您断言这永远不会在您的系统中发生。

这种类型的“安全编码”不会阻止别人看到你的源代码，但它有助于使你的代码在未来更加可靠和可用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T07:55:19.753

只是补充一下其他人已经说过的话：其中一些功能也可以简单地视为一种表达意图的方式。如果我创建一个成员`private`，我会让其他人“不可能”访问它（这是可能的，但这不是这里的重点），但更重要的是我告诉用户这是一个实现细节，他们不应该依赖它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-12T10:03:01.997

想象一下，如果您的对象具有非私有（隐藏）的内部属性，并且您访问此属性的代码恰好在多线程环境中运行，因此 N 个线程将同时开始访问它，5 个线程想更改此属性，4 个到读。您无法确保事情会整齐地运行，两个线程都不知道它当前保存了哪些数据，并且它是否成功地更改了该对象的属性。

您将必须编写一段特殊的代码，该代码将负责处理同步访问，但这仍然不能保证您的代码将正常工作，因为您仍然必须检查程序中访问该属性的其余 680 个类而不是直接访问它.

简而言之，您遇到了一个大问题，调试是一场噩梦，因为您不知道数据何时被更改，哪个线程执行此操作，从何处发生等。

如果您不封装，这只是发生的一种情况......

好东西，你的代码运行速度快了 1%，堆栈上的负载更少，你已经获得了可能微不足道的性能提升，你将付出系统周期性崩溃和成功调试的小机会。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T10:07:22.003

术语“安全编码”是指构建明显试图避免安全漏洞的软件，无论是 C、Java、Ruby、汇编语言还是其他任何语言。在选择安全的语言系统之后，其中最核心的部分可能是保持良好的编程实践。如果一个程序不清楚，那么你几乎没有机会相信它。

对于 Java，有两个值得注意的指南：

*   [Java 编程语言的安全编码指南，2.0 版。](http://java.sun.com/security/seccodeguide.html)两年前更新，需要更新。
*   [用于 Java 的 CERT Sun Microsystems 安全编码标准。](https://www.securecoding.cert.org/confluence/display/java/The+CERT+Sun+Microsystems+Secure+Coding+Standard+for+Java;jsessionid=D7F6736F0B3F822C4AAB3D848A110B01)CERT 和 Sun 都支持的新 wiki，可以根据您认为重要的内容进行更新。这比 Sun 的指导方针要宽泛得多。例如，Sun 指南并不真正关心整数溢出，因为所有数组边界都经过检查，但 wiki 这样做是因为它仍然会导致程序错误。

在 Java 中有两种不同的安全编码模式。

一方面，您正在处理的代码可能不具备您的代码所具有的所有特权。例如，如果您正在编写库或签名代码，则需要这样做。恶意代码应该不可能以意想不到的方式利用您的权限。这是困难的！

更常见的是，您正在处理仅处理不受信任数据的程序。例如，Web 服务器（想想 XSS 和 SQL 注入）和处理不受信任文件的桌面应用程序（通常问题在于 C 代码具有缓冲区溢出 - 真正的 C++ 更好）。在某些情况下，拒绝服务 (DoS) 可能是一个严重的问题。

有一些重叠。例如，解释器以解释器代码的权限运行，并且可能非常“强大”。

# c# - C# 单声道 p/调用失败

> ID：851624
> 
> 赞同：1
> 
> 时间：2009-05-12T07:47:27.350
> 
> 标签：c#, mono, pinvoke, segmentation-fault

最近我尝试在单声道（.NET for Linux 平台）中使用 p/invoke 编写一个简单的 OpenGL 应用程序，以了解它在 C# 上的工作原理（我已经在 windows 上成功完成了）。我听说过 tao 框架，但我不想要一个简单的“hello world”之类的程序。

我刚开始就卡住了。我 p/invoked 了一些 GL 函数以查看它们是否有效。我立即调用了 glClearColor 和 glClear 来查看它是否设置了 glGetError （由于那时 opengl 还没有被初始化）。

它只是崩溃并转储以下堆栈跟踪和其他调试信息，而不是调用该函数。不会抛出异常。

堆栈跟踪：

```
 at (wrapper managed-to-native) Calmarius.OGL.OpenGLLibrary.glClearColor (single,single,single,single) <0x00004>
  at (wrapper managed-to-native) Calmarius.OGL.OpenGLLibrary.glClearColor (single,single,single,single) <0xffffffff>
  at Calmarius.RTS.GameForm.OnPaint (System.Windows.Forms.PaintEventArgs) [0x00000] in /home/calmarius/Development/csharp/RTS/RTS/Form1.cs:60
  at System.Windows.Forms.Control.WmPaint (System.Windows.Forms.Message&) <0x000b0>
  at System.Windows.Forms.Control.WndProc (System.Windows.Forms.Message&) <0x001e2>
  at System.Windows.Forms.ScrollableControl.WndProc (System.Windows.Forms.Message&) <0x0000d>
  at System.Windows.Forms.ContainerControl.WndProc (System.Windows.Forms.Message&) <0x00054>
  at System.Windows.Forms.Form.WndProc (System.Windows.Forms.Message&) <0x001da>
  at ControlWindowTarget.OnMessage (System.Windows.Forms.Message&) <0x00014>
  at ControlNativeWindow.WndProc (System.Windows.Forms.Message&) <0x00022>
  at System.Windows.Forms.NativeWindow.WndProc (intptr,System.Windows.Forms.Msg,intptr,intptr) <0x001b7>
  at System.Windows.Forms.XplatUIX11.DispatchMessage (System.Windows.Forms.MSG&) <0x00016>
  at System.Windows.Forms.XplatUI.DispatchMessage (System.Windows.Forms.MSG&) <0x00015>
  at System.Windows.Forms.Application.RunLoop (bool,System.Windows.Forms.ApplicationContext) <0x00997>
  at System.Windows.Forms.Application.Run (System.Windows.Forms.ApplicationContext) <0x0006a>
  at System.Windows.Forms.Application.Run (System.Windows.Forms.Form) <0x00025>
  at Calmarius.RTS.Program.Main () [0x0000b] in /home/calmarius/Development/csharp/RTS/RTS/Program.cs:19
  at (wrapper runtime-invoke) System.Object.runtime_invoke_void (object,intptr,intptr,intptr) <0xffffffff> 
```

glClearColor 的签名是：

```
//gllibname="opengl32.dll" --> mapped to libGL.so
[DllImport(gllibname)]

public static extern void glClearColor(float red, float green, float blue, float alpha); 
```

C规范是：

```
void glClearColor( GLclampf red,GLclampf green,GLclampf blue,GLclampf alpha ); 
```

GLclampf 是浮动的，因为我在标题中看到了它的声明。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T07:17:45.860

您可以使用 gdb 运行该程序，并查看 SEGV 发生的确切位置（有关说明，请参见 mono [wiki](http://www.mono-project.com/Debugging)）。

一个可能的原因是其他一些不正确的 p/invoke 声明和调用代码损坏了内存，所以稍后你会崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2011-03-05T12:34:33.693

我发现了。我在执行 p/invoke 时使用了错误的函数签名。

# sql - 外键约束可能导致循环或多个级联路径？

> ID：851625
> 
> 赞同：197
> 
> 时间：2009-05-12T07:47:58.957
> 
> 标签：sql, sql-server, constraints

当我尝试向我的表添加约束时遇到问题。我得到错误：

> 在表 'Employee' 上引入 FOREIGN KEY 约束 'FK74988DB24B3C886' 可能会导致循环或多个级联路径。指定 ON DELETE NO ACTION 或 ON UPDATE NO ACTION，或修改其他 FOREIGN KEY 约束。

我的约束是在一个`Code`表和一个`employee`表之间。该`Code`表包含`Id`、`Name`、`FriendlyName`和`Type`a `Value`。有许多引用代码的`employee`字段，因此可以对每种类型的代码进行引用。

如果引用的代码被删除，我需要将字段设置为 null。

任何想法我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：198
> 
> 时间：2009-05-12T10:03:56.847

SQL Server 对级联路径进行简单计数，而不是尝试确定是否确实存在任何循环，而是假设最坏的情况并拒绝创建引用操作 (CASCADE)：您可以而且应该仍然在没有引用操作的情况下创建约束。如果你不能改变你的设计（或者这样做会影响事情），那么你应该考虑使用触发器作为最后的手段。

FWIW 解决级联路径是一个复杂的问题。其他 SQL 产品将简单地忽略该问题并允许您创建循环，在这种情况下，将竞相看哪个将最后覆盖该值，这可能是设计者的无知（例如 ACE/Jet 就是这样做的）。我知道一些 SQL 产品会尝试解决简单的情况。事实仍然存在，SQL Server 甚至没有尝试，通过禁止多个路径来保证它的安全性，至少它告诉你是这样的。

Microsoft 自己[建议](https://support.microsoft.com/en-us/help/321843/error-message-1785-occurs-when-you-create-a-foreign-key-constraint-tha)使用触发器而不是 FK 约束。

* * *

## 回答 #2

> 赞同：117
> 
> 时间：2010-08-23T13:55:17.177

具有多个级联路径的典型情况是这样的：具有两个详细信息的主表，例如“Master”和“Detail1”和“Detail2”。两个细节都是级联删除。到目前为止没有问题。但是，如果这两个细节都与某个其他表（例如“SomeOtherTable”）具有一对多的关系怎么办。SomeOtherTable 有一个 Detail1ID 列和一个 Detail2ID 列。

```
Master { ID, masterfields }

Detail1 { ID, MasterID, detail1fields }

Detail2 { ID, MasterID, detail2fields }

SomeOtherTable {ID, Detail1ID, Detail2ID, someothertablefields } 
```

换句话说：SomeOtherTable 中的一些记录与 Detail1-records 相关联，SomeOtherTable 中的一些记录与 Detail2 记录相关联。即使保证 SomeOtherTable-records 永远不属于这两个 Details，现在也不可能对两个 Details 进行 SomeOhterTable 的记录级联删除，因为从 Master 到 SomeOtherTable 有多个级联路径（一个通过 Detail1，一个通过 Detail2）。现在你可能已经明白了。这是一个可能的解决方案：

```
Master { ID, masterfields }

DetailMain { ID, MasterID }

Detail1 { DetailMainID, detail1fields }

Detail2 { DetailMainID, detail2fields }

SomeOtherTable {ID, DetailMainID, someothertablefields } 
```

所有 ID 字段都是关键字段和自动增量。关键在于 Detail 表的 DetailMainId 字段。这些字段既是关键又是参考约束。现在可以通过仅删除主记录来级联删除所有内容。缺点是对于每个 detail1-record 和每个 detail2 记录，还必须有一个 DetailMain-record（实际上是首先创建它以获得正确且唯一的 id）。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2010-05-04T19:29:02.167

我会指出（功能上）SCHEMA 和 DATA 中的周期和/或多条路径之间存在很大差异。虽然 DATA 中的循环和多路径肯定会使处理复杂化并导致性能问题（“正确”处理的成本），但模式中这些特征的成本应该接近于零。

由于 RDB 中最明显的循环出现在层次结构（组织结构图、部分、子部分等）中，不幸的是 SQL Server 假设了最坏的情况。即模式周期==数据周期。事实上，如果您使用 RI 约束，您实际上无法在数据中构建循环！

我怀疑多路径问题是相似的；即，模式中的多个路径不一定意味着数据中的多个路径，但我对多路径问题的经验较少。

当然，如果 SQL Server*确实*允许循环，它仍然会受到 32 深度的影响，但这对于大多数情况来说可能已经足够了。（太糟糕了，这不是数据库设置！）

“代替删除”触发器也不起作用。第二次访问表时，将忽略触发器。因此，如果您真的想模拟级联，则必须在存在循环的情况下使用存储过程。然而，替代删除触发器将适用于多路径情况。

Celko 提出了一种“更好”的方式来表示不引入循环的层次结构，但需要权衡取舍。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2015-05-28T14:38:50.837

有一篇文章解释了如何使用触发器执行多个删除路径。也许这对于复杂的场景很有用。

[http://www.mssqltips.com/sqlservertip/2733/solving-the-sql-server-multiple-cascade-path-issue-with-a-trigger/](http://www.mssqltips.com/sqlservertip/2733/solving-the-sql-server-multiple-cascade-path-issue-with-a-trigger/)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-05-12T07:52:03.457

通过它的声音，您在现有外键之一上有一个 OnDelete/OnUpdate 操作，这将修改您的代码表。

所以通过创建这个外键，你会创建一个循环问题，

例如，更新员工，导致代码被更新操作更改，导致员工被更新操作更改......等等......

如果您发布两个表的表定义和外键/约束定义，我们应该能够告诉您问题出在哪里......

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-12-16T16:58:24.483

这是因为员工可能有其他实体的集合，比如资格和资格可能有一些其他集合大学，例如

```
public class Employee{
public virtual ICollection<Qualification> Qualifications {get;set;} 
```

}

```
public class Qualification{

public Employee Employee {get;set;}

public virtual ICollection<University> Universities {get;set;} 
```

}

```
public class University{

public Qualification Qualification {get;set;} 
```

}

在 DataContext 上可能如下所示

```
protected override void OnModelCreating(DbModelBuilder modelBuilder){

modelBuilder.Entity<Qualification>().HasRequired(x=> x.Employee).WithMany(e => e.Qualifications);
modelBuilder.Entity<University>.HasRequired(x => x.Qualification).WithMany(e => e.Universities); 
```

}

在这种情况下，存在从员工到资格以及从资格到大学的链。所以它向我抛出了同样的异常。

当我改变时它对我有用

```
 modelBuilder.Entity<Qualification>().**HasRequired**(x=> x.Employee).WithMany(e => e.Qualifications); 
```

到

```
 modelBuilder.Entity<Qualification>().**HasOptional**(x=> x.Employee).WithMany(e => e.Qualifications); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-12-03T14:18:10.357

触发器是这个问题的解决方案：

```
IF OBJECT_ID('dbo.fktest2', 'U') IS NOT NULL
    drop table fktest2
IF OBJECT_ID('dbo.fktest1', 'U') IS NOT NULL
    drop table fktest1
IF EXISTS (SELECT name FROM sysobjects WHERE name = 'fkTest1Trigger' AND type = 'TR')
    DROP TRIGGER dbo.fkTest1Trigger
go
create table fktest1 (id int primary key, anQId int identity)
go  
    create table fktest2 (id1 int, id2 int, anQId int identity,
        FOREIGN KEY (id1) REFERENCES fktest1 (id)
            ON DELETE CASCADE
            ON UPDATE CASCADE/*,    
        FOREIGN KEY (id2) REFERENCES fktest1 (id) this causes compile error so we have to use triggers
            ON DELETE CASCADE
            ON UPDATE CASCADE*/ 
            )
go

CREATE TRIGGER fkTest1Trigger
ON fkTest1
AFTER INSERT, UPDATE, DELETE
AS
    if @@ROWCOUNT = 0
        return
    set nocount on

    -- This code is replacement for foreign key cascade (auto update of field in destination table when its referenced primary key in source table changes.
    -- Compiler complains only when you use multiple cascased. It throws this compile error:
    -- Rrigger Introducing FOREIGN KEY constraint on table may cause cycles or multiple cascade paths. Specify ON DELETE NO ACTION or ON UPDATE NO ACTION, 
    -- or modify other FOREIGN KEY constraints.
    IF ((UPDATE (id) and exists(select 1 from fktest1 A join deleted B on B.anqid = A.anqid where B.id <> A.id)))
    begin       
        update fktest2 set id2 = i.id
            from deleted d
            join fktest2 on d.id = fktest2.id2
            join inserted i on i.anqid = d.anqid        
    end         
    if exists (select 1 from deleted)       
        DELETE one FROM fktest2 one LEFT JOIN fktest1 two ON two.id = one.id2 where two.id is null -- drop all from dest table which are not in source table
GO

insert into fktest1 (id) values (1)
insert into fktest1 (id) values (2)
insert into fktest1 (id) values (3)

insert into fktest2 (id1, id2) values (1,1)
insert into fktest2 (id1, id2) values (2,2)
insert into fktest2 (id1, id2) values (1,3)

select * from fktest1
select * from fktest2

update fktest1 set id=11 where id=1
update fktest1 set id=22 where id=2
update fktest1 set id=33 where id=3
delete from fktest1 where id > 22

select * from fktest1
select * from fktest2 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-10-10T11:35:32.533

这是数据库触发策略类型的错误。**触发器是代码，可以将一些智能或条件添加到级联关系中，例如级联删除。**您可能需要专门针对此相关的表选项，例如*Turning off CascadeOnDelete*：

```
protected override void OnModelCreating( DbModelBuilder modelBuilder )
{
    modelBuilder.Entity<TableName>().HasMany(i => i.Member).WithRequired().WillCascadeOnDelete(false);
} 
```

或完全关闭此功能：

```
modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>(); 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-24T17:51:55.903

一些数据库，尤其是 SQL Server，对形成循环的级联行为有限制。有两种方法可以处理这种情况： 1.将一个或多个关系更改为不级联删除。2\. 将数据库配置为没有这些级联删除中的一项或多项，然后确保加载所有依赖实体，以便 EF Core 可以执行级联行为。请参考此链接：
[数据库级联限制](https://docs.microsoft.com/en-us/ef/core/saving/cascade-delete)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-15T10:38:34.703

大规模数据库更新以抵消 PK：改为制作数据库副本。

特殊用例：公司 A 使用与公司 B 具有相同架构的数据库。因为他们已经合并，他们想使用单个数据库。因此，B公司数据库中的许多表必须有它们的主键偏移，以避免与A公司的记录发生冲突。

一种解决方案可能是将外键定义为 ON UPDATE CASCADE，并偏移具有外键的主键。但是如果你这样做，会有很多障碍（Msg 1785，Msg 8102，...）。

所以我想到的一个更好的主意是简单地制作数据库的副本，DROP 并重新创建必须具有 PKs|FKs 偏移量的表，然后复制数据（在这样做的同时，偏移主键和外键键）。

避免所有的麻烦。

* * *

## 回答 #11

> 赞同：-2
> 
> 时间：2017-11-28T20:37:46.267

我使用 ASP.NET Core 2.0 和 EF Core 2.0 遇到的这个问题的解决方案是按顺序执行以下操作：

1.  在包管理控制台 (PMC) 中运行`update-database`命令以创建数据库（这会导致“引入 FOREIGN KEY 约束......可能导致循环或多个级联路径。”错误）

2.  在 PMC 中运行`script-migration -Idempotent`命令以创建一个可以运行的脚本，而不管现有的表/约束如何

3.  获取生成的脚本并查找`ON DELETE CASCADE`并替换为`ON DELETE NO ACTION`

4.  对数据库执行修改后的 SQL

现在，您的迁移应该是最新的，并且不应该发生级联删除。

太糟糕了，我无法在 Entity Framework Core 2.0 中找到任何方法来做到这一点。

祝你好运！

# python - Django -- User.DoesNotExist 不存在？

> ID：851628
> 
> 赞同：36
> 
> 时间：2009-05-12T07:49:16.707
> 
> 标签：python, django, authentication, django-models, pydev

我正试图抓住 Django。我在 Eclipse 上使用 Pydev。我写了一个简单的注册页面，但我无法开始工作。Eclipse 抱怨 User.DoesNotExist 未定义。很可能，我错过了一些微不足道的东西。这是代码的相关部分：

```
from django.contrib.auth.models import User
...
class SignUpForm (forms.Form):
    ...
    def clean_username (self): 
        try:
            User.objects.get(username=self.cleaned_data['username'])
        except User.DoesNotExist:
            return self.cleaned_data['username']
        raise forms.ValidationError(USERNAME_ALREADY_IN_USE)
    ... 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-05-12T09:11:26.387

问题出在 PyDev 上，而不是你的代码上。您所做的是绝对正确的，但 IDE 总是难以解析 Python 等动态语言中的属性。在 DoesNotExist 异常的情况下，它是通过 a`__metaclass__`而不是通过正常的对象继承添加的，因此 PyDev 不太可能找到它。但是，它绝对应该有效。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-09-07T23:00:34.663

我刚刚发现 Pydev 实际上有一个很好的解决方法。

转到**Window** > **Preferences**，然后**Pydev** > **Editor** > **Code Analysis**。

单击**未定义**选项卡并将“DoesNotExist”添加到标题为**将以下名称视为全局变量**的文本框中。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-05-12T09:29:50.333

Pydev 有针对这种情况的解决方法（当成员在运行时定义时）。只需在导致警告的字符串末尾添加#@UndefinedVariable（或当光标位于“DoesNotExist”时键盘上的ctrl+1），它不会抱怨。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T09:03:12.703

Eclipse 可以通过`__metaclass__`es 解析创建运行时的属性吗？

请注意，您从未在任何模型上定义 a ，也没有`DoesNotExist`在任何模型上定义它`django.db.models.base.Model`。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2010-04-07T10:34:25.543

您也可以用不同的方式解决它：只需转到 User 类，然后在文档字符串中添加 @DynamicAttrs。
这将告诉 PyDev 该类的属性是动态添加的，并且不会再抱怨像 DoesNotExist 这样的“问题”。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-06-18T12:13:58.100

我在 VirtualEnv 中的 Ubuntu 上遇到了同样的问题，以解决我使用这个片段的问题。

> [http://djangosnippets.org/snippets/191/#c3091](http://djangosnippets.org/snippets/191/#c3091)

在 parituclar 中，他使用代码制作了自定义用户字段：

```
class UserField(forms.CharField):
    def clean(self, value):
        super(UserField, self).clean(value)
        try:
            User.objects.get(username=value)
            raise forms.ValidationError("Someone is already using this username. Please pick an other.")
        except User.DoesNotExist:
            return value 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-12T09:10:16.980

> Eclipse 抱怨 User.DoesNotExist 未定义。

你是什​​么意思？你有python错误和堆栈跟踪吗？此代码必须有效（如[文档](http://docs.djangoproject.com/en/1.0/topics/auth/#writing-an-authentication-backend)中所示）。看起来像一个日食问题。只需运行开发服务器，看看它是否有效：

```
manage.py runserver 
```

# asp.net-mvc - Thunderdome 动作调用程序 asp.net mvc

> ID：851631
> 
> 赞同：3
> 
> 时间：2009-05-12T07:50:37.673
> 
> 标签：asp.net-mvc, controller, fubumvc

我知道 Thunderdome 原理的基本概念（一个对象进入，一个对象离开），但我在 asp.net mvc 中没有看到任何真实世界的示例。是雷电原理的好例子吗

```
 public ActionResult Index(Employee employee)
        {
             //some actions here
             return View(employeeViewModel);
        } 
```

但是声明呢

> Controller 类永远不会直接暴露给与 HttpContext 相关的任何内容

动作调用者应该是什么样子？你能提供一些例子和单元测试吗？

* * *

来自[http://codebetter.com/blogs/jeremy.miller/archive/2008/10/23/our-opinions-on-the-asp-net-mvc-introducing-the-thunderdome-principle.aspx](http://codebetter.com/blogs/jeremy.miller/archive/2008/10/23/our-opinions-on-the-asp-net-mvc-introducing-the-thunderdome-principle.aspx)

“Thunderdome 原则”——所有 Controller 方法都接受一个 ViewModel 对象（或在某些情况下为零个对象）并返回一个 ViewModel 对象（一个对象进入，一个对象离开）。Controller 类永远不会直接暴露给与 HttpContext 相关的任何内容。没有什么比看到人们尝试编写模拟或存根新 IHttpContextWrapper 接口的测试更让我哭泣的了。同样，Controller 方法不返回 ViewResult 对象，并且通常与所有 MVC 基础结构分离。我们很早就采用了这种策略，以使控制器测试在机械上更简单。

但我想知道该怎么做？如何编写这样的控制器动作调用程序？因为通常我们必须模拟 httpcontext

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T13:14:44.507

在 Oxite rev2 源代码中有一个如何在 ASP.NET MVC 中实现 OMIOMO (Thunderdome) Action 调用程序的示例。

特别是 OxiteActionInvoker： [http ://oxite.codeplex.com/SourceControl/changeset/view/31497#442766](http://oxite.codeplex.com/SourceControl/changeset/view/31497#442766)

在这里你可以看到一个 OMIOMO 控制器：http: [//oxite.codeplex.com/SourceControl/changeset/view/31497#442745](http://oxite.codeplex.com/SourceControl/changeset/view/31497#442745)

同样有趣的是，Oxite 人员能够做到这一点，这样您就可以拥有 IoC-able 动作过滤器（而不是必须在动作上指定所有过滤器 - 可能违反 OCP，因为动作必须知道所有可能的使用方式）。您可以在 OxiteActionInvoker 方法“GetFilters”中看到这一点，它点击 FilterRegistry 以加载该操作的所有注册过滤器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T09:12:55.527

这是 MVC 应用程序最干净的方法“thunderdome 原则（一个对象进入，一个对象离开）”。您应该始终尝试以这种方式进行操作，并避免使用 ViewData 或 ViewTemp 以在视图中获取必要的数据。

对于一个简单的示例，您可以在此处查看 jscportal 项目[链接文本](http://jscportal.codeplex.com/)

例如在`jscportal\JSC.Portal.Web\Controllers\TemplatesController.cs` 你会得到他们想要的例子：

```
public ActionResult List()
{
    IList<Template> templates = Service.GetAll();
    return View(templates);
}

public ActionResult Edit(int id)
{
    Template t = Service.GetById(id, false);
    return View(t);
} 
```

祝你好运！

# python - Django admin 中的默认过滤器

> ID：851636
> 
> 赞同：105
> 
> 时间：2009-05-12T07:52:20.027
> 
> 标签：python, django, django-admin

如何从“全部”更改默认过滤器选项？我有一个名为 as 的字段，`status`它具有三个值`activate`：`pending`和`rejected`。当我`list_filter`在 Django admin 中使用时，过滤器默认设置为“全部”，但我想默认将其设置为挂起。

* * *

## 回答 #1

> 赞同：115
> 
> 时间：2013-05-15T04:17:12.077

为了实现这一点*并*在您的侧边栏中有一个可用的“全部”链接（即显示全部而不是显示待处理的链接），您需要创建一个自定义列表过滤器，`django.contrib.admin.filters.SimpleListFilter`默认情况下从“待处理”继承和过滤。这些方面的东西应该起作用：

```
from datetime import date

from django.utils.translation import ugettext_lazy as _
from django.contrib.admin import SimpleListFilter

class StatusFilter(SimpleListFilter):
    title = _('Status')

    parameter_name = 'status'

    def lookups(self, request, model_admin):
        return (
            (None, _('Pending')),
            ('activate', _('Activate')),
            ('rejected', _('Rejected')),
            ('all', _('All')),
        )

    def choices(self, cl):
        for lookup, title in self.lookup_choices:
            yield {
                'selected': self.value() == lookup,
                'query_string': cl.get_query_string({
                    self.parameter_name: lookup,
                }, []),
                'display': title,
            }

    def queryset(self, request, queryset):
        if self.value() in ('activate', 'rejected'):
            return queryset.filter(status=self.value())    
        elif self.value() == None:
            return queryset.filter(status='pending')

class Admin(admin.ModelAdmin): 
    list_filter = [StatusFilter] 
```

编辑：需要 Django 1.4（感谢西蒙）

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-05-21T06:22:14.300

```
class MyModelAdmin(admin.ModelAdmin):   

    def changelist_view(self, request, extra_context=None):

        if not request.GET.has_key('decommissioned__exact'):

            q = request.GET.copy()
            q['decommissioned__exact'] = 'N'
            request.GET = q
            request.META['QUERY_STRING'] = request.GET.urlencode()
        return super(MyModelAdmin,self).changelist_view(request, extra_context=extra_context) 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2010-09-24T02:54:29.127

采用上面 ha22109 的答案并修改为允许通过比较`HTTP_REFERER`和选择“全部” `PATH_INFO`。

```
class MyModelAdmin(admin.ModelAdmin):

    def changelist_view(self, request, extra_context=None):

        test = request.META['HTTP_REFERER'].split(request.META['PATH_INFO'])

        if test[-1] and not test[-1].startswith('?'):
            if not request.GET.has_key('decommissioned__exact'):

                q = request.GET.copy()
                q['decommissioned__exact'] = 'N'
                request.GET = q
                request.META['QUERY_STRING'] = request.GET.urlencode()
        return super(MyModelAdmin,self).changelist_view(request, extra_context=extra_context) 
```

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2014-01-09T04:38:05.183

我知道这个问题现在已经很老了，但它仍然有效。我相信这是最正确的做法。它本质上与 Greg 的方法相同，但被表述为一个可扩展的类以便于重用。

```
from django.contrib.admin import SimpleListFilter
from django.utils.encoding import force_text
from django.utils.translation import ugettext as _

class DefaultListFilter(SimpleListFilter):
    all_value = '_all'

    def default_value(self):
        raise NotImplementedError()

    def queryset(self, request, queryset):
        if self.parameter_name in request.GET and request.GET[self.parameter_name] == self.all_value:
            return queryset

        if self.parameter_name in request.GET:
            return queryset.filter(**{self.parameter_name:request.GET[self.parameter_name]})

        return queryset.filter(**{self.parameter_name:self.default_value()})

    def choices(self, cl):
        yield {
            'selected': self.value() == self.all_value,
            'query_string': cl.get_query_string({self.parameter_name: self.all_value}, []),
            'display': _('All'),
        }
        for lookup, title in self.lookup_choices:
            yield {
                'selected': self.value() == force_text(lookup) or (self.value() == None and force_text(self.default_value()) == force_text(lookup)),
                'query_string': cl.get_query_string({
                    self.parameter_name: lookup,
                }, []),
                'display': title,
            }

class StatusFilter(DefaultListFilter):
    title = _('Status ')
    parameter_name = 'status__exact'

    def lookups(self, request, model_admin):
        return ((0,'activate'), (1,'pending'), (2,'rejected'))

    def default_value(self):
        return 1

class MyModelAdmin(admin.ModelAdmin):
    list_filter = (StatusFilter,) 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2014-09-11T15:23:27.180

这是我使用重定向的通用解决方案，它只检查是否有任何 GET 参数，如果不存在，则使用默认的 get 参数重定向。我也有一个 list_filter 集，所以它会选择它并显示默认值。

```
from django.shortcuts import redirect

class MyModelAdmin(admin.ModelAdmin):   

    ...

    list_filter = ('status', )

    def changelist_view(self, request, extra_context=None):
        referrer = request.META.get('HTTP_REFERER', '')
        get_param = "status__exact=5"
        if len(request.GET) == 0 and '?' not in referrer:
            return redirect("{url}?{get_parms}".format(url=request.path, get_parms=get_param))
        return super(MyModelAdmin,self).changelist_view(request, extra_context=extra_context) 
```

唯一需要注意的是，当您使用“？”直接访问该页面时。存在于 url 中，没有设置 HTTP_REFERER，因此它将使用默认参数并重定向。这对我来说很好，当您单击管理过滤器时效果很好。

**更新**：

为了绕过警告，我最终编写了一个自定义过滤器函数，它简化了 changelist_view 功能。这是过滤器：

```
class MyModelStatusFilter(admin.SimpleListFilter):
    title = _('Status')
    parameter_name = 'status'

    def lookups(self, request, model_admin):  # Available Values / Status Codes etc..
        return (
            (8, _('All')),
            (0, _('Incomplete')),
            (5, _('Pending')),
            (6, _('Selected')),
            (7, _('Accepted')),
        )

    def choices(self, cl):  # Overwrite this method to prevent the default "All"
        from django.utils.encoding import force_text
        for lookup, title in self.lookup_choices:
            yield {
                'selected': self.value() == force_text(lookup),
                'query_string': cl.get_query_string({
                    self.parameter_name: lookup,
                }, []),
                'display': title,
            }

    def queryset(self, request, queryset):  # Run the queryset based on your lookup values
        if self.value() is None:
            return queryset.filter(status=5)
        elif int(self.value()) == 0:
            return queryset.filter(status__lte=4)
        elif int(self.value()) == 8:
            return queryset.all()
        elif int(self.value()) >= 5:
            return queryset.filter(status=self.value())
        return queryset.filter(status=5) 
```

如果不存在，则 changelist_view 现在只传递默认参数。这个想法是摆脱泛型过滤器的能力，通过不使用获取参数来查看所有内容。要查看我为此目的分配的所有状态 = 8。：

```
class MyModelAdmin(admin.ModelAdmin):   

    ...

    list_filter = ('status', )

    def changelist_view(self, request, extra_context=None):
        if len(request.GET) == 0:
            get_param = "status=5"
            return redirect("{url}?{get_parms}".format(url=request.path, get_parms=get_param))
        return super(MyModelAdmin, self).changelist_view(request, extra_context=extra_context) 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-02-17T16:22:12.160

```
def changelist_view( self, request, extra_context = None ):
    default_filter = False
    try:
        ref = request.META['HTTP_REFERER']
        pinfo = request.META['PATH_INFO']
        qstr = ref.split( pinfo )

        if len( qstr ) < 2:
            default_filter = True
    except:
        default_filter = True

    if default_filter:
        q = request.GET.copy()
        q['registered__exact'] = '1'
        request.GET = q
        request.META['QUERY_STRING'] = request.GET.urlencode()

    return super( InterestAdmin, self ).changelist_view( request, extra_context = extra_context ) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-01-25T10:23:25.357

您可以简单地使用SimpleListFilter 的`return queryset.filter()`or和 Override 方法`if self.value() is None`

```
from django.utils.encoding import force_text

def choices(self, changelist):
    for lookup, title in self.lookup_choices:
        yield {
            'selected': force_text(self.value()) == force_text(lookup),
            'query_string': changelist.get_query_string(
                {self.parameter_name: lookup}, []
            ),
            'display': title,
        } 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2020-06-09T21:55:36.003

创建了一个可重用的过滤器子类，灵感来自这里的一些答案（主要是 Greg 的）。

## 好处：

**可重用**- 可插入任何标准`ModelAdmin`类

**可扩展**- 易于添加额外的/自定义的`QuerySet`过滤逻辑

**易于使用**- 在其最基本的形式中，只需要实现一个自定义属性和一个自定义方法（除了 SimpleListFilter 子类化所需的那些）

**直观的管理员**- “全部”过滤器链接按预期工作；和其他人一样

**无重定向**- 无需检查`GET`请求有效负载，与`HTTP_REFERER`（或任何其他与请求相关的东西，以其基本形式）无关

**没有（更改列表）视图操作**- 也没有模板操作（上帝保佑）

## 代码：

*（大多数`import`s 仅用于类型提示和异常）*

```
from typing import List, Tuple, Any

from django.contrib.admin.filters import SimpleListFilter
from django.contrib.admin.options import IncorrectLookupParameters
from django.contrib.admin.views.main import ChangeList
from django.db.models.query import QuerySet
from django.utils.encoding import force_str
from django.utils.translation import gettext_lazy as _
from django.core.exceptions import ValidationError

class PreFilteredListFilter(SimpleListFilter):

    # Either set this or override .get_default_value()
    default_value = None

    no_filter_value = 'all'
    no_filter_name = _("All")

    # Human-readable title which will be displayed in the
    # right admin sidebar just above the filter options.
    title = None

    # Parameter for the filter that will be used in the URL query.
    parameter_name = None

    def get_default_value(self):
        if self.default_value is not None:
            return self.default_value
        raise NotImplementedError(
            'Either the .default_value attribute needs to be set or '
            'the .get_default_value() method must be overridden to '
            'return a URL query argument for parameter_name.'
        )

    def get_lookups(self) -> List[Tuple[Any, str]]:
        """
        Returns a list of tuples. The first element in each
        tuple is the coded value for the option that will
        appear in the URL query. The second element is the
        human-readable name for the option that will appear
        in the right sidebar.
        """
        raise NotImplementedError(
            'The .get_lookups() method must be overridden to '
            'return a list of tuples (value, verbose value).'
        )

    # Overriding parent class:
    def lookups(self, request, model_admin) -> List[Tuple[Any, str]]:
        return [(self.no_filter_value, self.no_filter_name)] + self.get_lookups()

    # Overriding parent class:
    def queryset(self, request, queryset: QuerySet) -> QuerySet:
        """
        Returns the filtered queryset based on the value
        provided in the query string and retrievable via
        `self.value()`.
        """
        if self.value() is None:
            return self.get_default_queryset(queryset)
        if self.value() == self.no_filter_value:
            return queryset.all()
        return self.get_filtered_queryset(queryset)

    def get_default_queryset(self, queryset: QuerySet) -> QuerySet:
        return queryset.filter(**{self.parameter_name: self.get_default_value()})

    def get_filtered_queryset(self, queryset: QuerySet) -> QuerySet:
        try:
            return queryset.filter(**self.used_parameters)
        except (ValueError, ValidationError) as e:
            # Fields may raise a ValueError or ValidationError when converting
            # the parameters to the correct type.
            raise IncorrectLookupParameters(e)

    # Overriding parent class:
    def choices(self, changelist: ChangeList):
        """
        Overridden to prevent the default "All".
        """
        value = self.value() or force_str(self.get_default_value())
        for lookup, title in self.lookup_choices:
            yield {
                'selected': value == force_str(lookup),
                'query_string': changelist.get_query_string({self.parameter_name: lookup}),
                'display': title,
            } 
```

## 完整使用示例：

```
from django.contrib import admin
from .models import SomeModelWithStatus

class StatusFilter(PreFilteredListFilter):
    default_value = SomeModelWithStatus.Status.FOO
    title = _('Status')
    parameter_name = 'status'

    def get_lookups(self):
        return SomeModelWithStatus.Status.choices

@admin.register(SomeModelWithStatus)
class SomeModelAdmin(admin.ModelAdmin):
    list_filter = (StatusFilter, ) 
```

希望这对某人有所帮助；反馈总是很感激。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-05-28T11:09:28.907

请注意，如果您不想预先选择过滤器值，而是希望始终在将数据显示在管理员中之前对其进行预先过滤，则应改写该`ModelAdmin.queryset()`方法。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-09-20T08:22:37.887

使用 DjangoChoices、Python >= 2.5 和当然 Django >= 1.4 对 Greg 的回答略有改进。

```
from django.utils.translation import ugettext_lazy as _
from django.contrib.admin import SimpleListFilter

class OrderStatusFilter(SimpleListFilter):
    title = _('Status')

    parameter_name = 'status__exact'
    default_status = OrderStatuses.closed

    def lookups(self, request, model_admin):
        return (('all', _('All')),) + OrderStatuses.choices

    def choices(self, cl):
        for lookup, title in self.lookup_choices:
            yield {
                'selected': self.value() == lookup if self.value() else lookup == self.default_status,
                'query_string': cl.get_query_string({self.parameter_name: lookup}, []),
                'display': title,
            }

    def queryset(self, request, queryset):
        if self.value() in OrderStatuses.values:
            return queryset.filter(status=self.value())
        elif self.value() is None:
            return queryset.filter(status=self.default_status)

class Admin(admin.ModelAdmin):
    list_filter = [OrderStatusFilter] 
```

感谢格雷格的好解决方案！

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-10-13T15:20:17.873

我知道这不是最好的解决方案，但我更改了管理模板中的 index.html，第 25 行和第 37 行，如下所示：

25:`<th scope="row"><a href="{{ model.admin_url }}{% ifequal model.name "yourmodelname" %}?yourflag_flag__exact=1{% endifequal %}">{{ model.name }}</a></th>`

37:`<td><a href="{{ model.admin_url }}{% ifequal model.name "yourmodelname" %}?yourflag__exact=1{% endifequal %}" class="changelink">{% trans 'Change' %}</a></td>`

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2020-02-13T18:28:44.640

这是我能够生成的过滤器的最干净版本，该过滤器具有重新定义的“全部”和选择的默认值。

如果默认情况下向我显示当前正在发生的旅行。

```
class HappeningTripFilter(admin.SimpleListFilter):
    """
    Filter the Trips Happening in the Past, Future or now.
    """
    default_value = 'now'
    title = 'Happening'
    parameter_name = 'happening'

    def lookups(self, request, model_admin):
        """
        List the Choices available for this filter.
        """
        return (
            ('all', 'All'),
            ('future', 'Not yet started'),
            ('now', 'Happening now'),
            ('past', 'Already finished'),
        )

    def choices(self, changelist):
        """
        Overwrite this method to prevent the default "All".
        """
        value = self.value() or self.default_value
        for lookup, title in self.lookup_choices:
            yield {
                'selected': value == force_text(lookup),
                'query_string': changelist.get_query_string({
                    self.parameter_name: lookup,
                }, []),
                'display': title,
            }

    def queryset(self, request, queryset):
        """
        Returns the Queryset depending on the Choice.
        """
        value = self.value() or self.default_value
        now = timezone.now()
        if value == 'future':
            return queryset.filter(start_date_time__gt=now)
        if value == 'now':
            return queryset.filter(start_date_time__lte=now, end_date_time__gte=now)
        if value == 'past':
            return queryset.filter(end_date_time__lt=now)
        return queryset.all() 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2013-03-13T17:36:19.473

我必须进行修改才能使过滤正常工作。加载页面时，以前的解决方案对我有用。如果执行了“操作”，过滤器将返回“全部”，而不是我的默认设置。此解决方案使用默认过滤器加载管理员更改页面，但当页面上发生其他活动时，还会维护过滤器更改或当前过滤器。我没有测试所有情况，但实际上它可能会限制默认过滤器的设置仅在页面加载时发生。

```
def changelist_view(self, request, extra_context=None):
    default_filter = False

    try:
        ref = request.META['HTTP_REFERER']
        pinfo = request.META['PATH_INFO']
        qstr = ref.split(pinfo)
        querystr = request.META['QUERY_STRING']

        # Check the QUERY_STRING value, otherwise when
        # trying to filter the filter gets reset below
        if querystr is None:
            if len(qstr) < 2 or qstr[1] == '':
                default_filter = True
    except:
        default_filter = True

    if default_filter:
        q = request.GET.copy()
        q['registered__isnull'] = 'True'
        request.GET = q
        request.META['QUERY_STRING'] = request.GET.urlencode()

    return super(MyAdmin, self).changelist_view(request, extra_context=extra_context) 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2014-06-18T19:55:14.207

有点跑题了，但我对类似问题的搜索把我带到了这里。我希望按日期进行默认查询（即，如果未提供输入，则仅显示带有`timestamp`“今天”的对象），这使问题有点复杂化。这是我想出的：

```
from django.contrib.admin.options import IncorrectLookupParameters
from django.core.exceptions import ValidationError

class TodayDefaultDateFieldListFilter(admin.DateFieldListFilter):
    """ If no date is query params are provided, query for Today """

    def queryset(self, request, queryset):
        try:
            if not self.used_parameters:
                now = datetime.datetime.now().replace(hour=0, minute=0, second=0, microsecond=0)
                self.used_parameters = {
                    ('%s__lt' % self.field_path): str(now + datetime.timedelta(days=1)),
                    ('%s__gte' % self.field_path): str(now),
                }
                # Insure that the dropdown reflects 'Today'
                self.date_params = self.used_parameters
            return queryset.filter(**self.used_parameters)
        except ValidationError, e:
            raise IncorrectLookupParameters(e)

class ImagesAdmin(admin.ModelAdmin):
    list_filter = (
        ('timestamp', TodayDefaultDateFieldListFilter),
    ) 
```

这是对默认值的简单覆盖`DateFieldListFilter`。通过设置`self.date_params`，它确保过滤器下拉列表将更新为任何与`self.used_parameters`. 出于这个原因，您必须确保`self.used_parameters`这些下拉选项之一将使用的正是这些（即，找出`date_params`使用“今天”或“过去 7 天”时会使用的内容，并构造`self.used_parameters`以匹配它们）。

这是为与 Django 1.4.10 一起工作而构建的

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-11-06T15:38:09.787

这可能是一个旧线程，但我想我会添加我的解决方案，因为我在谷歌搜索中找不到更好的答案。

做什么（不确定是 Deminic Rodger 还是 ha22109）在 ModelAdmin 中回答 changelist_view

```
class MyModelAdmin(admin.ModelAdmin):   
    list_filter = (CustomFilter,)

    def changelist_view(self, request, extra_context=None):

        if not request.GET.has_key('decommissioned__exact'):

            q = request.GET.copy()
            q['decommissioned__exact'] = 'N'
            request.GET = q
            request.META['QUERY_STRING'] = request.GET.urlencode()
        return super(MyModelAdmin,self).changelist_view(request, extra_context=extra_context) 
```

然后我们需要创建一个自定义的 SimpleListFilter

```
class CustomFilter(admin.SimpleListFilter):
    title = 'Decommissioned'
    parameter_name = 'decommissioned'  # i chose to change it

def lookups(self, request, model_admin):
    return (
        ('All', 'all'),
        ('1', 'Decommissioned'),
        ('0', 'Active (or whatever)'),
    )

# had to override so that we could remove the default 'All' option
# that won't work with our default filter in the ModelAdmin class
def choices(self, cl):
    yield {
        'selected': self.value() is None,
        'query_string': cl.get_query_string({}, [self.parameter_name]),
        # 'display': _('All'),
    }
    for lookup, title in self.lookup_choices:
        yield {
            'selected': self.value() == lookup,
            'query_string': cl.get_query_string({
                self.parameter_name: lookup,
            }, []),
            'display': title,
        }

def queryset(self, request, queryset):
    if self.value() == '1':
        return queryset.filter(decommissioned=1)
    elif self.value() == '0':
        return queryset.filter(decommissioned=0)
    return queryset 
```

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-12-02T09:30:46.837

使用 ha22109 的答案，我为 ModelAdmin 类编写了一个 mixin：

```
from urllib.parse import urlencode
from django.contrib.admin.views.main import SEARCH_VAR
from django.http import HttpRequest, QueryDict

class DefaultFilterMixin:

    default_filters: Sequence[tuple[str, Any]] | dict[str, Any] | None = None

    def get_default_filters(
        self,
        request: HttpRequest,
    ) -> Sequence[tuple[str, Any]] | dict[str, Any] | None:
        return self.default_filters

    def changelist_view(
        self,
        request: HttpRequest,
        extra_context: dict[str, str] | None = None,
    ):
        if request.method == 'GET' and not request.GET:
            if default_filters := self.get_default_filters(request):
                request.GET = QueryDict(
                    f"{urlencode(default_filters)}&{SEARCH_VAR}=",
                    encoding=request.encoding,
                )
                request.META['QUERY_STRING'] = request.GET.urlencode()

        return super().changelist_view(request, extra_context=extra_context) 
```

简单的例子：

```
class MyModelAdmin(DefaultFilterMixin, admin.ModelAdmin):

    default_filters = (("status__exact", "pending"),)
    ... 
```

或更复杂的 rangefilter.DateTimeRangeFilter 动态过滤器：

```
class MyModelAdmin(DefaultFilterMixin, admin.ModelAdmin):

        def get_default_filters(
            self,
            request: HttpRequest,
        ) -> Sequence[tuple[str, Any]] | dict[str, Any] | None:
            now = timezone.now()
            date_fmt = '%d.%m.%Y'
            return (
                ('created_at__range__gte_0', now.strftime(date_fmt)),
                ('created_at__range__gte_1', '00:00:00'),
                ('created_at__range__lte_0', (now + timedelta(1)).strftime(date_fmt)),
                ('created_at__range__lte_1', '00:00:00'),
            ) 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-12-04T14:05:08.933

使用默认 mixin回复第一个答案（来自[Evgeni Shudzel](https://stackoverflow.com/users/9601060/evgeni-shudzel)）......这是一个导入和复杂性较少的解决方案

```
from urllib.parse import urlencode
from django.contrib.admin.views.main import SEARCH_VAR
from django.http import HttpRequest, QueryDict

class DefaultFilterMixin:
    default_filters: None

    def get_default_filters(self, request: HttpRequest):
        return self.default_filters

    def changelist_view(self, request: HttpRequest, extra_context=None):
        if request.method == 'GET' and not request.GET:
            if default_filters := self.get_default_filters(request):
                request.GET = QueryDict(
                    f"{urlencode(default_filters)}&{SEARCH_VAR}=",
                    encoding=request.encoding,
                )
                request.META['QUERY_STRING'] = request.GET.urlencode()

        return super().changelist_view(request, extra_context=extra_context)

class SampleUsageAdmin(DefaultFilterMixin, admin.ModelAdmin):
    default_filters = (("fulfillments_complete__exact", "0"),) 
```

# sql - 如何使用 Union 方法或左外连接？

> ID：851640
> 
> 赞同：1
> 
> 时间：2009-05-12T07:54:23.640
> 
> 标签：sql, sql-server, sql-server-2005

我无法使用 scr_SecuristLog 加入 #Temp。我该怎么做？

```
CREATE TABLE #Temp (VisitingCount int, [Time] int )
 DECLARE @DateNow DATETIME,@i int,@Time int
    set @DateNow='00:00'  
    set @i=1;  
    while(@i<48)  
        begin  
set @DateNow = DATEADD(minute, 30, @DateNow)
set @Time = (datepart(hour,@DateNow)*60+datepart(minute,@DateNow))/30 
insert into #Temp(VisitingCount,[Time]) values(0,@Time )
set @i=@i+1
                end
select VisitingCount, [Time]
from #Temp as t
left outer join (
    select count(page) as VisitingCount, 
    (datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time]
    from scr_SecuristLog
    where Date between '2009-05-04' and '2009-05-05'
) as s
    on t.VisitingCount = s.VisitingCount
        and t.Time = s.Time
```

此代码给出错误：

* * *

消息 8120，级别 16，状态 1，行 1 列 'scr_SecuristLog.Date' 在选择列表中无效，因为它不包含在聚合函数或 GROUP BY 子句中。
消息 8120，级别 16，状态 1，行 1 列 'scr_SecuristLog.Date' 在选择列表中无效，因为它不包含在聚合函数或 GROUP BY 子句中。
消息 209，级别 16，状态 1，第 1 行不明确的列名称“访问计数”。
消息 209，级别 16，状态 1，第 1 行不明确的列名称“时间”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T07:59:44.833

由于您没有提及特定错误，我猜您的错误来自您没有为选择值添加前缀的事实。

```
select t.VisitingCount, t.[Time] 
```

* * *

**编辑**

您的第二个错误应该通过这个 group by 解决。

```
select count(page) as VisitingCount, 
(datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time]
from scr_SecuristLog
where Date between '2009-05-04' and '2009-05-05'
GROUP BY (datepart(hour,Date)*60+datepart(minute,Date))/30 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T08:01:03.427

我认为您需要在派生表 scr_SecuristLog 中添加一个 GROUP BY，您需要按时间对其进行分组，因为您使用的是聚合函数计数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T08:04:33.623

```
 CREATE TABLE #Temp (
  VisitingCount INT,
  [Time] INT)
DECLARE @DateNow DATETIME,
  @i INT,
  @Time INT
SET @DateNow = '00:00'

SET @i = 1 ;

WHILE(@i < 48)

  BEGIN

    SET @DateNow = DATEADD(minute, 30, @DateNow)
    SET @Time = (DATEPART(hour, @DateNow) * 60 + DATEPART(minute, @DateNow))
      / 30 
    INSERT  INTO #Temp (VisitingCount, [Time])
    VALUES  (0, @Time)
    SET @i = @i + 1
  END
SELECT  VisitingCount,
        [Time]
FROM    #Temp AS t
UNION
SELECT  COUNT(page) AS VisitingCount,
        (DATEPART(hour, Date) * 60 + DATEPART(minute, Date)) / 30 AS [Time]
FROM    scr_SecuristLog
WHERE   Date BETWEEN '2009-05-04' AND '2009-05-05'
GROUP BY Date

DROP TABLE #Temp 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T08:03:14.530

好的试试这个

```
CREATE TABLE #Temp (VisitingCount int, [Time] int )
DECLARE @DateNow DATETIME,@i int,@Time int
set @DateNow='00:00'  
set @i=1;  
while(@i<48)  
    begin  
        set @DateNow = DATEADD(minute, 30, @DateNow)
        set @Time = (datepart(hour,@DateNow)*60+datepart(minute,@DateNow))/30 
        insert into #Temp(VisitingCount,[Time]) values(0,@Time )
        set @i=@i+1
    end
    select t.VisitingCount, t.[Time]
    from #Temp as t
    left outer join (
         select count(page) as VisitingCount, 
       (datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time]
       from scr_SecuristLog
       where Date between '2009-05-04' and '2009-05-05'
       GROUP BY scr_SecuristLog.Date
   ) as s
    on t.VisitingCount = s.VisitingCount
    and t.Time = s.Time 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T08:04:10.990

您的内部选择（您正在加入）没有正确聚合。你有一个计数和一个列。这意味着您需要按列分组以便 SQL 正确理解它。

```
select t.VisitingCount, t.[Time]
from #Temp as t
left outer join (
    select count(page) as VisitingCount, 
    (datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time]
    from scr_SecuristLog
    where Date between '2009-05-04' and '2009-05-05'
    GROUP BY [Date]
) as s
    on t.VisitingCount = s.VisitingCount
        and t.Time = s.Time 
```

您可能实际需要的是按计算列分组，在这种情况下，您的分组依据应该是：

```
GROUP BY (datepart(hour,Date)*60+datepart(minute,Date))/30 
```

# sql - 计数不同且 Null 值被聚合消除

> ID：851642
> 
> 赞同：7
> 
> 时间：2009-05-12T07:55:07.773
> 
> 标签：sql, sql-server, sql-server-2005, null, aggregate

我正在使用 SQL Server 2005。使用下面的查询（从我的真实查询中简化）：

```
select a,count(distinct b),sum(a) from 
(select 1 a,1 b union all
select 2,2 union all
select 2,null union all
select 3,3 union all
select 3,null union all
select 3,null) a
group by a 
```

有什么方法可以在没有得到的情况下进行计数

“警告：空值被聚合或其他 SET 操作消除。”

以下是我能想到的替代方案：

1.  关闭 ANSI_WARNINGS
2.  分成两个查询，一个带有 count distinct 和一个 where 子句以消除空值，一个带有总和：

    ```
    select t1.a, t1.countdistinctb, t2.suma from
    (
        select a,count(distinct b) countdistinctb from 
        (
            select 1 a,1 b union all
            select 2,2 union all
            select 2,null union all
            select 3,3 union all
            select 3,null union all
            select 3,null
        ) a
        where a.b is not null
        group by a
    ) t1
    left join
    (
        select a,sum(a) suma from 
        (
            select 1 a,1 b union all
            select 2,2 union all
            select 2,null union all
            select 3,3 union all
            select 3,null union all
            select 3,null
        ) a
        group by a
    ) t2 on t1.a=t2.a 
    ```

3.  忽略客户端中的警告

有一个更好的方法吗？我可能会沿着路线 2 走，但不喜欢代码重复。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T09:29:58.930

```
select a,count(distinct isnull(b,-1))-sum(distinct case when b is null then 1 else 0 end),sum(a) from 
    (select 1 a,1 b union all
    select 2,2 union all
    select 2,null union all
    select 3,3 union all
    select 3,null union all
    select 3,null) a
    group by a 
```

感谢 Eoin，我找到了一种方法来做到这一点。您可以计算不同的值，包括空值，然后删除由于空值而导致的计数（如果有任何使用 sum distinct）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T08:00:44.427

任何可能返回 null 的地方，请使用

```
CASE WHEN Column IS NULL THEN -1 ELSE Column END AS Column 
```

这将在查询期间将所有 Null 值替换为 -1 并且它们将被计算/聚合，然后你可以在你的精细包装查询中做相反的事情......

```
SELECT  
    CASE WHEN t1.a = -1 THEN NULL ELSE t1.a END as a
    , t1.countdistinctb
    , t2.suma 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-10-25T18:37:09.193

这是一个迟到的笔记，但由于它是谷歌的回报，我想提一下。

将 NULL 更改为另一个值是一个坏主意（tm）。

COUNT() 正在这样做，而不是 DISTINCT。

相反，在子查询中使用 DISTINCT 并返回一个数字，然后在外部查询中聚合它。

一个简单的例子是：

```
WITH A(A) AS (SELECT NULL UNION ALL SELECT NULL UNION ALL SELECT 1)
SELECT COUNT(*) FROM (SELECT DISTINCT A FROM A) B; 
```

这允许`COUNT(*)`使用，它不会忽略 NULL（因为它计算记录，而不是值）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T09:41:19.193

如果您不喜欢代码重复，那么为什么不使用公用表表达式呢？例如

```
WITH x(a, b) AS 
        (
                select 1 a,1 b union all
                select 2,2 union all
                select 2,null union all
                select 3,3 union all
                select 3,null union all
                select 3,null
        ) 
select t1.a, t1.countdistinctb, t2.suma from
(
        select a,count(distinct b) countdistinctb from 
        x a
        where a.b is not null
        group by a
) t1
left join
(
        select a,sum(a) suma from 
        x a
        group by a
) t2 on t1.a=t2.a 
```

# visual-studio-2008 - 如何使用 msbuild/web 部署项目删除多个文件？

> ID：851647
> 
> 赞同：11
> 
> 时间：2009-05-12T07:55:53.607
> 
> 标签：visual-studio-2008, msbuild, web-deployment-project

我对 msbuild 在 VS2008 Web 部署项目中的行为有一个奇怪的问题，我想知道为什么它似乎随机行为不端。

我需要从部署文件夹中删除一些应该只存在于我的开发环境中的文件。这些文件是在开发/测试期间由 Web 应用程序生成的，不包含在我的 Visual Studio 项目/解决方案中。

我使用的配置如下：

```
<!--  Partial extract from Microsoft Visual Studio 2008 Web Deployment Project -->
<ItemGroup>
  <DeleteAfterBuild Include="$(OutputPath)data\errors\*.xml" /> <!-- Folder 1: 36 files -->
  <DeleteAfterBuild Include="$(OutputPath)data\logos\*.*" />    <!-- Folder 2: 2 files -->
  <DeleteAfterBuild Include="$(OutputPath)banners\*.*" />       <!-- Folder 3: 1 file -->
</ItemGroup>

<Target Name="AfterBuild">
  <Message Text="------ AfterBuild process starting ------" Importance="high" />
    <Delete Files="@(DeleteAfterBuild)">
      <Output TaskParameter="DeletedFiles" PropertyName="deleted" />
    </Delete>
    <Message Text="DELETED FILES: $(deleted)" Importance="high" />
  <Message Text="------ AfterBuild process complete ------" Importance="high" />
</Target> 
```

我遇到的问题是，当我对 Web 部署项目进行构建/重建时，它“有时”会删除所有文件，但有时它不会删除任何东西！或者它只会删除 DeleteAfterBuild 项目组中三个文件夹中的一个或两个。构建过程何时决定删除文件似乎没有一致性。

当我编辑配置以仅包含文件夹 1（例如）时，它会正确删除所有文件。然后添加文件夹 2 和 3，它开始根据需要删除所有文件。然后，似乎在随机时间，我将重建项目，它不会删除任何文件！

我已经尝试将这些项目移动到 ExcludeFromBuild 项目组（这可能是它应该在的位置），但它给了我同样不可预测的结果。

有没有人经历过这个？难道我做错了什么？为什么会这样？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2009-05-13T07:51:13.683

在`<ItemGroup>`脚本加载时和处理之前评估`<Target>`。

似乎有不止一种方法可以正确地做到这一点 -

1.  包括`<ItemGroup>`内部，`<Target>`它应该在正确的时间进行评估。这将适用于 MS-Build v3.5+

2.  用于`<CreateItem>`生成项目列表

示例构建脚本 -

```
<!-- Using ItemGroup -->
<Target Name="AfterBuild">
  <ItemGroup>
    <DeleteAfterBuild Include="$(OutputPath)data\errors\*.xml" />
  </ItemGroup>
  <Delete Files="@(DeleteAfterBuild)" />
</Target>

<!-- Using CreateItem -->
<Target Name="AfterBuild">
  <CreateItem Include="$(OutputPath)data\errors\*.xml">
    <Output TaskParameter="Include" ItemName="DeleteAfterBuild"/>
  </CreateItem>
  <Delete Files="@(DeleteAfterBuild)" />
</Target> 
```

解释为什么删除过程会产生“不可预测”的结果 -

1.  从干净的构建输出路径开始
2.  构建 #1 - 构建 Web 部署项目。`@(DeleteAfterBuild)`将评估没有文件，因为文件夹中不存在`$(OutputPath)`文件，并且不会删除任何文件作为`AfterBuild`目标的一部分
3.  构建 #2 - 构建 Web 部署项目。`@(DeleteAfterBuild)`将使用文件夹中的所有预期文件进行评估，`$(OutputPath)`并将文件作为`AfterBuild`目标的一部分删除
4.  基本上我们现在回到第 2 阶段。重复。结果当然是可以预测的——不再挠头。

参考资料： [如何：动态创建项目组](http://blogs.msdn.com/msbuild/archive/2005/10/04/476725.aspx)，MSBUILD 文件中项目的 [延迟评估](http://social.msdn.microsoft.com/forums/en-US/msbuild/thread/19933220-b296-41ac-a33e-0236ebc26168/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-03-18T21:59:26.310

我意识到这已经得到了回答，但我想我会加我的 5 美分。对于 Web 部署项目，无需使用提供的目标，只需添加包含*ExcludeFromBuild*元素的项组。我提供了部署项目文件底部的相关部分以供参考。

```
 <Import Project="$(MSBuildExtensionsPath)\Microsoft\WebDeployment\v9.0\Microsoft.WebDeployment.targets" />
  <!-- To modify your build process, add your task inside one of the targets below and uncomment it. 
       Other similar extension points exist, see Microsoft.WebDeployment.targets.
  <Target Name="BeforeBuild">
  </Target>
  <Target Name="BeforeMerge">
  </Target>
  <Target Name="AfterMerge">
  </Target>
  <Target Name="AfterBuild">
  </Target>
  -->
  <ItemGroup>
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\obj\**\*.*" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\Properties\**\*.*" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\*.csproj*" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\*.resx" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\**\*.Publish.xml" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\LocalTestRun.testrunconfig" />
    <ExcludeFromBuild Include="$(SourceWebPhysicalPath)\TestResults\**\*.*" />
  </ItemGroup> 
```

# wcf - 如何配置 WCF 端到端日志记录？

> ID：851653
> 
> 赞同：1
> 
> 时间：2009-05-12T07:56:54.980
> 
> 标签：wcf, logging, msmq, certificate

我有一个我想解决的问题，但我不知道如何在 WCF 中配置端到端日志记录（我不确定即使启用了端到端日志记录我也能解决我的问题） . 我有三个应用程序（A、B、C），它们通过 NetMsmqBinding 使用 WCF 服务相互通信。A 是主机，B 和 C 是 WCF 服务的客户端。该服务使用带有证书的消息安全性。B 和 A 之间的通信工作正常，但是 C 和 A 之间的通信却不行。所以我想使用日志记录并找出为什么消息从队列中删除（在 C -> A 的情况下）并且没有被主机处理......我们如何为这种情况配置日志记录以便诊断问题...（应用程序 B 和应用程序 C 在同一台机器上，应用程序 A 在不同的机器上）。（乙-> A 可以在有证书和没有证书的情况下工作）（C -> A 只能在没有证书的情况下工作）。我需要配置 C -> A 以使用证书，但我不知道为了修复它出了什么问题。请帮忙！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-08-08T17:09:33.900

以下是如何进行 WCF 端到端跟踪：

[http://msdn.microsoft.com/en-us/library/aa738749.aspx](http://msdn.microsoft.com/en-us/library/aa738749.aspx)

在您的情况下，我会使用 Enterprise Library Logging。记录发送参数的每个方法的进入和退出，以及在代码的关键部分周围使用 try catch，并记录异常。

希望这可以帮助。

# c++ - 如何检查套接字是否仍然打开？

> ID：851654
> 
> 赞同：8
> 
> 时间：2009-05-12T07:57:12.857
> 
> 标签：c++, sockets

我有一个使用标准套接字调用的 C++ 应用程序，我想知道是否可以在不发送或接收任何数据的情况下判断套接字是否仍然打开。我可以打一个可靠的电话`select`或电话吗？`ioctlsocket`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T08:49:58.403

如果你尝试接收一个字节，你可能会收到几个错误，如果你有一个非阻塞套接字，并尝试在一个有效的连接上接收，你会得到错误 WSAEWOULDBLOCK。

知道了这一点，我们可以像这样检查非阻塞套接字

```
bool connected(SOCKET sock)
{
     char buf;
     int err = recv(sock, &buf, 1, MSG_PEEK);
     if(err == SOCKET_ERROR)
     {
          if(WSAGetLastError() != WSAEWOULDBLOCK)
          {return false;}
     }
     return true;
} 
```

[从 recv 的返回值](http://msdn.microsoft.com/en-us/library/ms740121(VS.85).aspx)可以看出，recv 可能会返回超时或其他几个断开连接的错误，我相信 WSAEWOULDBLOCK 是它可能返回的唯一值，如果有错误但仍然连接，但您可能需要仔细检查该列表返回值。另外recv中使用的flag（MSG_PEEK）意味着当你检查后去查看时数据仍然是可读的，所以你不必担心丢失一个字节的数据。

我相信这只适用于非阻塞套接字，因为它可能会阻塞，直到它接收到数据。如果您想使用阻塞套接字，您可能希望在此检查之前使用[ioctlsocket](http://msdn.microsoft.com/en-us/library/ms738573(VS.85).aspx)将其设置为非阻塞，然后将其恢复为原来的状态。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T08:12:29.853

“打开”的套接字并不能帮助您进行端到端连接。确定您可以与另一端通信的唯一方法是与另一端通信。

在您设计的任何协议中，您都应该考虑实现这种检查行为。如果这不是您的协议，有时有办法偷偷摸摸地做到这一点（例如，FTP 上传一个非常小的、无用的文件来检查 FTP 端口是否仍然打开）。

# c# - 多线程服务器中的 Monitor.Wait/Pulse 竞争条件

> ID：851662
> 
> 赞同：8
> 
> 时间：2009-05-12T08:00:58.280
> 
> 标签：c#, multithreading, client-server

我在多线程 TCP 服务器中遇到了联锁 Monitor.Wait 和 Monitor.Pulse 的问题。为了演示我的问题，这是我的服务器代码：

```
public class Server
{
    TcpListener listener;
    Object sync;
    IHandler handler;
    bool running;

    public Server(IHandler handler, int port)
    {
        this.handler = handler;
        IPAddress address = Dns.GetHostEntry(Dns.GetHostName()).AddressList[0];
        listener = new TcpListener(address, port);
        sync = new Object();
        running = false;
    }

    public void Start()
    {
        Thread thread = new Thread(ThreadStart);
        thread.Start();
    }

    public void Stop()
    {
        lock (sync)
        {
            listener.Stop();
            running = false;
            Monitor.Pulse(sync);
        }
    }

    void ThreadStart()
    {
        if (!running)
        {
            listener.Start();
            running = true;
            lock (sync)
            {
                while (running)
                {
                    try
                    {
                        listener.BeginAcceptTcpClient(new AsyncCallback(Accept), listener);
                        Monitor.Wait(sync);  // Release lock and wait for a pulse
                    }
                    catch (Exception e)
                    {
                        Console.WriteLine(e.Message);
                    }
                }
            }
        }
    }

    void Accept(IAsyncResult result)
    {
        // Let the server continue listening
        lock (sync)
        {
            Monitor.Pulse(sync);
        } 

        if (running)
        {
            TcpListener listener = (TcpListener)result.AsyncState;
            using (TcpClient client = listener.EndAcceptTcpClient(result))
            {
                handler.Handle(client.GetStream());
            }
        }
    }
} 
```

这是我的客户代码：

```
class Client
{
    class EchoHandler : IHandler
    {
        public void Handle(Stream stream)
        {
            System.Console.Out.Write("Echo Handler: ");
            StringBuilder sb = new StringBuilder();
            byte[] buffer = new byte[1024];
            int count = 0;
            while ((count = stream.Read(buffer, 0, 1024)) > 0)
            {
                sb.Append(Encoding.ASCII.GetString(buffer, 0, count));
            }
            System.Console.Out.WriteLine(sb.ToString());
            System.Console.Out.Flush();
        }
    }

    static IPAddress localhost = Dns.GetHostEntry(Dns.GetHostName()).AddressList[0];

    public static int Main()
    {
        Server server1 = new Server(new EchoHandler(), 1000);
        Server server2 = new Server(new EchoHandler(), 1001);

        server1.Start();
        server2.Start();

        Console.WriteLine("Press return to test...");
        Console.ReadLine();

        // Note interleaved ports
        SendMsg("Test1", 1000);
        SendMsg("Test2", 1001);
        SendMsg("Test3", 1000);
        SendMsg("Test4", 1001);
        SendMsg("Test5", 1000);
        SendMsg("Test6", 1001);
        SendMsg("Test7", 1000);

        Console.WriteLine("Press return to terminate...");
        Console.ReadLine();

        server1.Stop();
        server2.Stop();

        return 0;
    }

    public static void SendMsg(String msg, int port)
    {
        IPEndPoint endPoint = new IPEndPoint(localhost, port);

        byte[] buffer = Encoding.ASCII.GetBytes(msg);
        using (Socket s = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp))
        {
            s.Connect(endPoint);
            s.Send(buffer);
        }
    }
} 
```

客户端发送 7 条消息，但服务器只打印 4 条：

```
按回车测试...

按回车键终止...
回声处理程序：Test1
回声处理程序：Test3
回声处理器：Test2
回声处理程序：Test4

```

我怀疑监视器通过允许在发生（在方法中）之前发生`Pulse`（在服务器的方法中）而感到困惑，即使在它调用之前应该仍然拥有对象上的锁，然后该方法可以获得锁并发送它的. 如果您在服务器的方法中注释掉这两行：`Accept``Wait``ThreadStart``ThreadStart``sync``Monitor.Wait()``Accept``Pulse``Stop()`

```
//listener.Stop();
//running = false; 
```

调用服务器的方法时会出现剩余的消息`Stop()`（即唤醒服务器的`sync`对象会导致它分派剩余的传入消息）。在我看来，这只能发生在`ThreadStart`and`Accept`方法之间的竞争条件下，但是对象周围的锁`sync`应该可以防止这种情况发生。

有任何想法吗？

非常感谢，西蒙。

附言。请注意，我知道输出出现乱序等，我特别询问锁和监视器之间的竞争条件。干杯，SH。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T10:13:19.920

问题是您使用 Pulse/Wait 作为信号。正确的信号，例如 AutoResetEvent 具有这样的状态，即它保持信号状态，直到线程调用 WaitOne()。在没有任何线程等待的情况下调用 Pulse 将成为一个 noop。

这与同一个线程可以多次获取锁的事实相结合。由于您使用的是异步编程，因此接受回调可以由执行 BeginAcceptTcpClient 的同一线程调用。

让我来说明一下。我注释掉了第二台服务器，并更改了您服务器上的一些代码。

```
void ThreadStart()
{
    if (!running)
    {
        listener.Start();
        running = true;
        lock (sync)
        {
            while (running)
            {
                try
                {
                    Console.WriteLine("BeginAccept [{0}]", 
                        Thread.CurrentThread.ManagedThreadId);
                    listener.BeginAcceptTcpClient(new AsyncCallback(Accept), listener);
                    Console.WriteLine("Wait [{0}]", 
                        Thread.CurrentThread.ManagedThreadId);
                    Monitor.Wait(sync);  // Release lock and wait for a pulse
                }
                catch (Exception e)
                {
                    Console.WriteLine(e.Message);
                }
            }
        }
    }
}

void Accept(IAsyncResult result)
{
    // Let the server continue listening
    lock (sync)
    {
        Console.WriteLine("Pulse [{0}]", 
            Thread.CurrentThread.ManagedThreadId);
        Monitor.Pulse(sync);
    }
    if (running)
    {
        TcpListener localListener = (TcpListener)result.AsyncState;
        using (TcpClient client = localListener.EndAcceptTcpClient(result))
        {
            handler.Handle(client.GetStream());
        }
    }
} 
```

我运行的输出如下所示。如果您自己运行此代码，则值会有所不同，但通常是相同的。

```
Press return to test...
BeginAccept [3]
Wait [3]

Press return to terminate...
Pulse [5]
BeginAccept [3]
Pulse [3]
Echo Handler: Test1
Echo Handler: Test3
Wait [3] 
```

如您所见，调用了两个 Pulse，一个来自单独的线程（Pulse [5]），它唤醒了第一个等待。线程 3 然后执行另一个 BeginAccept，但有待处理的传入连接，该线程决定立即调用 Accept 回调。由于 Accept 是由同一个线程调用的，因此 Lock(sync) 不会阻塞，而是会立即在空线程队列上执行 Pulse [3]。

调用两个处理程序并处理这两个消息。

一切都很好，ThreadStart 再次开始运行并无限期地等待。

现在，这里的根本问题是您正在尝试将监视器用作信号。由于它不记得第二个 Pulse 丢失的状态。

但是有一个简单的解决方案。使用 AutoResetEvents，这是一个正确的信号，它会记住它的状态。

```
public Server(IHandler handler, int port)
{
    this.handler = handler;
    IPAddress address = Dns.GetHostEntry(Dns.GetHostName()).AddressList[0];
    listener = new TcpListener(address, port);
    running = false;
    _event = new AutoResetEvent(false);
}

public void Start()
{
    Thread thread = new Thread(ThreadStart);
    thread.Start();
}

public void Stop()
{
    listener.Stop();
    running = false;
    _event.Set();
}

void ThreadStart()
{
    if (!running)
    {
        listener.Start();
        running = true;
        while (running)
        {
            try
            {
                listener.BeginAcceptTcpClient(new AsyncCallback(Accept), listener);
                _event.WaitOne();
            }
            catch (Exception e)
            {
                Console.WriteLine(e.Message);
            }
        }
    }
}

void Accept(IAsyncResult result)
{
    // Let the server continue listening
    _event.Set();
    if (running)
    {
        TcpListener localListener = (TcpListener) result.AsyncState;
        using (TcpClient client = localListener.EndAcceptTcpClient(result))
        {
            handler.Handle(client.GetStream());
        }
    }
} 
```

# oracle - Oracle - 在过程中选择和删除

> ID：851675
> 
> 赞同：3
> 
> 时间：2009-05-12T08:07:24.353
> 
> 标签：oracle, plsql

我需要从 Oracle 过程中返回一个行集，然后在同一个过程中删除它们。没有临时表有没有一种巧妙的方法？可能是内存中的光标之类的东西？

基本上我正在从队列中弹出记录，并且我想避免两次往返，因为这是一个非常频繁的过程。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T13:16:35.127

实际上，这些天你可以在没有 SELECT 的情况下做到这一点。您可以简单地删除您感兴趣的记录，并使用 RETURNING 子句在这些记录被删除时将它们提取到局部变量中。

```
DELETE FROM my_table
  WHERE <whatever conditions>
  RETURNING column1, column2, ...
  INTO array1, array2, ... 
```

这个方法有点烦人的部分是你需要将每一列提取到一个单独的变量中。您不能在此上下文中使用记录类型。所以如果你有很多列，它会变得很麻烦。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T08:44:06.960

您可以使用游标进行更新，例如

```
DECLARE
  CURSOR c_updates
  IS
    SELECT *
    FROM table1 t1
    LEFT JOIN table2 t2 ON t1.field = t2.field
    WHERE t2.field IS NULL
  FOR UPDATE OF t1.field;

  l_record c_updates%ROWTYPE;
BEGIN
  OPEN c_updates;

  LOOP
    FETCH c_updates INTO l_record;
    EXIT WHEN c_updates%NOTFOUND;

    --Do what you want with l_record

    DELETE FROM table1
    WHERE CURRENT OF c_updates;
  END LOOP;

  CLOSE c_updates;
END; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T11:34:27.727

您可以从过程或匿名块返回游标：

```
BEGIN
        OPEN :cur FOR
        SELECT  *
        FROM    table
        WHERE   condition;

        DELETE
        FROM    table
        WHERE   condition;

END; 
```

删除后光标将保持不变。

详细解释见我博客中的条目：

*   [**Oracle：返回已删除的记录**](http://explainextended.com/2009/05/13/oracle-returning-deleted-records/)

，简而言之，这里是这个条目：

```
CREATE TABLE t_deleter (id INT NOT NULL PRIMARY KEY, value VARCHAR2(50))
/
INSERT
INTO    t_deleter (id, value)
VALUES (1, 'Value 1')
/
INSERT
INTO    t_deleter (id, value)
VALUES (2, 'Value 2')
/
COMMIT
/
SELECT  *
FROM    t_deleter
/
VAR cur REFCURSOR
BEGIN
        OPEN    :cur FOR
        SELECT  *
        FROM    t_deleter
        WHERE   id = 1;
        DELETE
        FROM    t_deleter
        WHERE   id = 1;
END;
/
PRINT cur
SELECT  *
FROM    t_deleter
/

Table created.

1 row created.

1 row created.

Commit complete.

        ID VALUE
---------- --------------------------------------------------
         1 Value 1
         2 Value 2

PL/SQL procedure successfully completed.

/*
   PRINT CUR
   This is what returned to the client
*/

        ID VALUE
---------- --------------------------------------------------
         1 Value 1

/*
   SELECT  *
   FROM    t_deleter

   This is what's left after the procedure completed
*/

        ID VALUE
---------- --------------------------------------------------
         2 Value 2 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-12T08:45:54.290

将数据填充到 TYPE 中并返回？

例如

```
CREATE TYPE blah as (data-columns-go-here)
/

CREATE TYPE blah_table AS TABLE OF blah;
/ 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-05-12T09:31:36.197

基于[reubenpeeris 的回答](https://stackoverflow.com/questions/851675/oracle-select-and-delete-in-a-procedure/851789#851789)和[ca​​gcowboy 的回答](https://stackoverflow.com/questions/851675/oracle-select-and-delete-in-a-procedure/851798#851798)：

**警告：**我目前无法访问 PL/SQL 编译器，因此有可能出现问题。

```
TYPE popped_records_table_type IS TABLE OF my_table%ROWTYPE INDEX BY BINARY_INTEGER;

FUNCTION pop_records(...) RETURN popped_records_table_type IS
    popped_records popped_records_table_type;
    popped_record my_table%ROWTYPE;
    next_popped_record_index BINARY_INTEGER;

    CURSOR popped_records_cursor IS
        SELECT * FROM my_table WHERE ... FOR UPDATE;
BEGIN
    next_popped_record_index := 1;

    OPEN popped_records_cursor;

    LOOP
        FETCH popped_records_cursor INTO popped_record;
        EXIT WHEN popped_records_cursor%NOTFOUND;

        DELETE FROM my_table WHERE CURRENT OF popped_records_cursor;

        popped_records(next_popped_record_index) := popped_record;
        next_popped_record_index := next_popped_record_index + 1;
    END LOOP;

    CLOSE popped_records_cursor;

    RETURN popped_records;
END; 
```

编辑：我相信这也适用于存储过程，只要您提供 popped_records_table_type 的实例作为 IN/OUT 参数：

```
PROCEDURE pop_records(popped_records IN OUT popped_records_table_type, ...) IS
    -- Pretty much the same as above 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T15:03:17.390

Oracle 有一个叫做高级队列的东西，也许使用这个特性比构建自己的队列系统更好。

# wix - 如何在 WiX 3.0 中检查已安装的软件包？

> ID：851677
> 
> 赞同：5
> 
> 时间：2009-05-12T08:07:44.227
> 
> 标签：wix, wix3

我想检查是否已安装 Crystal Reports Basic for Visual Studio 2008 作为我自己的安装包的条件。

我在该产品的引导程序描述中找到了这一点 (C:\Program Files\Microsoft SDKs\Windows\v6.0A\Bootstrapper\Packages\CrystalReports10_5\product.xml)：

```
<InstallChecks>
  <MsiProductCheck Property="CRVSInstalled" Product="{AA467959-A1D6-4F45-90CD-11DC57733F32}"/>
  <MsiProductCheck Property="CRVSRunTimex86Installed" Product="{CE26F10F-C80F-4377-908B-1B7882AE2CE3}"/>
  <MsiProductCheck Property="CRVSRunTimex64Installed" Product="{2BFA9B05-7418-4EDE-A6FC-620427BAAAA3}. "/>
</InstallChecks> 
```

试图在 WiX 中模仿这种行为，我做了以下事情：

```
<Property Id="CRVSINSTALLED">
  <ComponentSearch Id="CRVSInstalledSearch" Guid="{AA467959-A1D6-4F45-90CD-11DC57733F32}" />
</Property>
<Property Id="CRVSRUNTIMEX86INSTALLED">
  <ComponentSearch Id="CRVSRunTimex86InstalledSearch" Guid="{CE26F10F-C80F-4377-908B-1B7882AE2CE3}" />
</Property>
<Property Id="CRVSRUNTIMEX64INSTALLED">
  <ComponentSearch Id="CRVSRunTimex64InstalledSearch" Guid="{2BFA9B05-7418-4EDE-A6FC-620427BAAAA3}" />
</Property>
<Condition Message="!(loc.CrystalReportsRequired)">Installed OR CRVSINSTALLED OR CRVSRUNTIMEX86INSTALLED OR CRVSRUNTIMEX64INSTALLED</Condition> 
```

但似乎`ComponentSearch`是在寻找具有自己 id 的包组件（文件、目录），而不是寻找包本身。

那么我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T12:58:25.867

正如[这里](http://article.gmane.org/gmane.comp.windows.devel.wix.user/38210)所建议的：

> 尝试在`HKLM\Software\Microsoft\Windows\CurrentVersion\Uninstall\`*`{productcode}`*. `HKCU`如果您的产品和依赖项都是每个用户的产品，还可以考虑搜索。

这是这样的：

```
<Property Id="CRVSINSTALLED">
  <RegistrySearch Id="CRVSInstalledSearch" Root="HKLM" Key="Software\Microsoft\Windows\CurrentVersion\Uninstall\{AA467959-A1D6-4F45-90CD-11DC57733F32}" Name="InstallDate" Type="raw" />
</Property>
<Property Id="CRVSRUNTIMEINSTALLED">
  <RegistrySearch Id="CRVSRunTimeInstalledSearch" Root="HKLM" Key="Software\Microsoft\Windows\CurrentVersion\Uninstall\{CE26F10F-C80F-4377-908B-1B7882AE2CE3}" Name="InstallDate" Type="raw" />
</Property>
<Property Id="CRVSRUNTIMEINSTALLED">
  <RegistrySearch Id="CRVSRunTimeInstalledSearch" Root="HKLM" Key="Software\Microsoft\Windows\CurrentVersion\Uninstall\{2BFA9B05-7418-4EDE-A6FC-620427BAAAA3}" Name="InstallDate" Type="raw" />
</Property> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-29T16:52:49.133

您可以使用[升级表](http://msdn.microsoft.com/en-us/library/aa372379%28VS.85%29.aspx)

```
<Upgrade Id="36E76465-5548-390F-955A-2776582C6A6C">
  <UpgradeVersion OnlyDetect="yes" Property="TFSCLIENT" Minimum="11.0.50727" />
</Upgrade>
<Condition Message="ERROR: Team Explorer for Microsoft Visual Studio 2012 is not installed">
  Installed OR TFSCLIENT
</Condition> 
```

现在棘手的一点是找到升级代码（在上面的 Id 属性中指定）。如果您有 MSI 软件包，请查看 Orca 提供的内容。如果你不 - 试试[这个解决方案](https://stackoverflow.com/a/5065023/902415)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-13T00:20:30.520

Windows 安装程序 API 具有执行此操作的[`MsiQueryProductState`](http://msdn.microsoft.com/en-us/library/aa370363(VS.85).aspx)功能`msi.dll`。不幸的是，您必须编写自定义操作才能在安装程序中使用它。中的组件`C:\Program Files\Windows Installer XML v3\SDK`可能会使这更容易。

# c++ - 在 OpenCV 中保存图像

> ID：851679
> 
> 赞同：34
> 
> 时间：2009-05-12T08:07:57.877
> 
> 标签：c++, opencv, computer-vision

我是 OpenCV 的新手，正在尝试捕获图像，然后将其保存到文件中。我在下面发布代码供您参考。

正在保存 jpg 文件，但它是黑色的。

```
// Capture the Image from the webcam
CvCapture *pCapturedImage = cvCreateCameraCapture(0);

// Get the frame
IplImage *pSaveImg = cvQueryFrame(pCapturedImage);

// Save the frame into a file
cvSaveImage("test.jpg". ,pSaveImg); // A JPG FILE IS BEING SAVED
                                    // OF 6KB , BUT IT IS BLACK 
```

所有的功能都成功了。我在 XP 和 Vista 中都尝试过上面的代码——结果都是黑色图像。请让我知道我错过了什么。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-12-04T17:27:42.180

如果你使用 C++，最好**使用 C++ 接口**：

```
using namespace cv;
// Capture the Image from the webcam
VideoCapture cap(0);

// Get the frame
Mat save_img; cap >> save_img;

if(save_img.empty())
{
  std::cerr << "Something is wrong with the webcam, could not get frame." << std::endl;
}
// Save the frame into a file
imwrite("test.jpg", save_img); // A JPG FILE IS BEING SAVED 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T21:22:30.170

有时第一次调用 cvQueryFrame() 会返回一个空图像。尝试：

```
IplImage *pSaveImg = cvQueryFrame(pCapturedImage);
pSaveImg = cvQueryFrame(pCapturedImage); 
```

如果这不起作用，请尝试自动选择捕获设备：

```
CvCapture *pCapturedImage = cvCreateCameraCapture(-1); 
```

或者您可以尝试选择 n=1,2,3... 的其他捕获设备

```
CvCapture *pCapturedImage = cvCreateCameraCapture(n); 
```

PS：另外，我认为查看您的变量名时捕获的图像存在误解。变量 pCapturedImage 不是 Image 它是 Capture。您始终可以从捕获中“读取”图像。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2011-02-22T12:25:58.630

`SaveImage`根据我的经验，当给定一个位深度不同于 8 位的矩阵时， OpenCV 会写入一个黑色图像。事实上，这是有记录的：

> 使用此功能只能保存 8 位单通道或 3 通道（具有“BGR”通道顺序）图像。如果格式、深度或通道顺序不同，保存前使用`cvCvtScale`and `cvCvtColor`进行转换，或者使用universal`cvSave`将图像保存为XML或YAML格式。

在您的情况下，您可以首先调查捕获的图像类型，更改捕获属性（我想`CV_CAP_PROP_CONVERT_RGB`可能很重要）或之后手动转换它。

这是一个如何使用 OpenCV 转换为 8 位表示的示例。`cc`这是一个类型的原始矩阵`CV_32FC1`，`cc8u`是它的缩放版本，实际上是由`SaveImage`：

```
# I want to save cc here
cc8u = CreateMat(cc.rows, cc.cols, CV_8U)
ccmin,ccmax,minij,maxij = MinMaxLoc(cc)
ccscale, ccshift = 255.0/(ccmax-ccmin), -ccmin
CvtScale(cc, cc8u, ccscale, ccshift)
SaveImage("cc.png", cc8u) 
```

（抱歉，这是 Python 代码，但应该很容易将其翻译成 C/C++）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-05-13T22:28:10.617

对不起，如果这太明显了。您确定 OpenCV 正确地看到和检测到网络摄像头，换句话说，当您将捕获的帧重定向到“highGui”窗口时，您是否得到图像？比如像这样：

```
 frame = cvQueryFrame( capture );
 cvNamedWindow( "myWindow", CV_WINDOW_AUTOSIZE );
 cvShowImage( "myWindow", frame ); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2010-04-18T21:50:45.773

我知道问题所在！您只需在“test.jpg”之后添加一个点！

cvSaveImage("test.jpg". ,pSaveImg);

我可能错了，但我认为它不好！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-05-05T05:21:40.510

我的 Microsoft WebCam 也有类似的问题。我查看了Matlab中的图像采集工具箱，发现最大支持的分辨率为640*480。

我只是更改了openCV中的代码并添加了

```
cvSetCaptureProperty(capture, CV_CAP_PROP_FRAME_WIDTH, 352); 
cvSetCaptureProperty(capture, CV_CAP_PROP_FRAME_HEIGHT, 288); 
```

在 cvQueryFrame 函数（它是下一个支持的分辨率并更改之前）在保存图像之前跳过了一些初始帧并最终让它工作。

我正在分享我的工作代码

```
#include "cv.h" 
#include "highgui.h" 
#include <stdio.h> 

using namespace cv;
using namespace std;

int main() 
{
CvCapture* capture = cvCaptureFromCAM( CV_CAP_ANY );
cvSetCaptureProperty(capture, CV_CAP_PROP_FRAME_WIDTH, 352); 
cvSetCaptureProperty(capture, CV_CAP_PROP_FRAME_HEIGHT, 288)

 // Get one frame
IplImage* frame;

for (int i = 0; i < 25; i++) 
{
frame = cvQueryFrame( capture );
}

printf( "Image captured \n" );  
//IplImage* RGB_frame = frame;
//cvCvtColor(frame,RGB_frame,CV_YCrCb2BGR);
//cvWaitKey(1000);
cvSaveImage("test.jpg" ,frame);
//cvSaveImage("cam.jpg" ,RGB_frame);

printf( "Image Saved \n" );

//cvWaitKey(10);

// Release the capture device housekeeping
cvReleaseCapture( &capture );
//cvDestroyWindow( "mywindow" );
return 0;
} 
```

我的建议：

1.  **不要以最高分辨率抓取帧**
2.  **跳过一些帧以进行正确的相机初始化**

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-05-13T22:16:14.270

I use the following code to capture images:

```
CvCapture* capture = cvCaptureFromCAM( CV_CAP_ANY );
if(!capture) error((char*)"No Capture");
IplImage *img=cvQueryFrame(capture); 
```

I know this works for sure

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2011-06-20T18:51:43.837

萨恩特刘易斯是对的。当您使用 cvCaptureFromCAM 激活相机时，尚未调整自动白平衡（这是一个缓慢的过程），因此您可能会在第一帧上获得大部分白色或大部分黑色（取决于相机和您的光照条件）。当场景的闪电突然变化时，也会发生同样的情况。打开相机后稍等片刻，冲洗缓冲区即可。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-07-07T15:42:06.530

我建议你运行 OpenCV 健全性检查

它是一系列位于 opencv 的 bin 目录中的小型可执行文件。

它将检查您的相机是否正常

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2010-08-19T16:21:05.177

我在 Windows Vista 上遇到了同样的问题，我之前只是添加了这段代码`cvQueryFrame`：

```
cvSetCaptureProperty(capture, CV_CAP_PROP_FRAME_WIDTH, 720);
cvSetCaptureProperty(capture, CV_CAP_PROP_FRAME_HEIGHT, 480); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2011-03-17T23:31:58.893

很抱歉提出一个旧帖子，但我想为遇到此线程的任何人提供另一个答案。

我有同样的问题。无论我做什么，图像看起来都是全黑的。我尝试对 cvQueryFrame 进行多次连续调用，并注意到当我进行 5 次或更多时，我可以看到图像。于是我开始一一删除调用，看看“断点”在哪里。我最终发现，当我删除每个呼叫时，图像变得越来越暗。只打一个电话就提供了一个几乎全黑的图像，但如果我仔细观察，我可以辨认出我的图像。

我连续尝试了 10 次电话来测试我的理论，果然，考虑到我在一个光线昏暗的房间里，我得到了一个非常明亮的图像。希望这与您遇到的问题相同。

我对成像知之甚少，但看起来多次连续调用 cvQueryFrame 会增加相机的曝光时间。这绝对可以解决问题，尽管它似乎不是最优雅的解决方案。我将看看是否可以找到一个可以增加曝光的参数，或者是否可以找到其他可以使我的图像变亮的参数。

祝你好运！

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-01-26T15:49:58.697

希望这会从您的网络摄像头中保存图像

```
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>
#include <opencv2/imgproc/imgproc.hpp>
#include <iostream>

using namespace std;
using namespace cv;

int main()
{
   VideoCapture cap(0);

   Mat save_img;

   cap >> save_img;

   char Esc = 0;

   while (Esc != 27 && cap.isOpened()) {        
    bool Frame = cap.read(save_img);        
    if (!Frame || save_img.empty()) {       
        cout << "error: frame not read from webcam\n";      
        break;                                              
    }
    namedWindow("save_img", CV_WINDOW_NORMAL);  
    imshow("imgOriginal", save_img);            
    Esc = waitKey(1);
}
imwrite("test.jpg",save_img); 
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2009-07-04T07:54:51.777

根据我的经验，使用时捕获的前几帧：

```
frame = cvQueryFrame( capture );
```

倾向于空白。您可能需要稍等片刻（约 3 秒），然后尝试捕捉图像。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2011-04-25T09:15:18.303

在 OSX 上，仅当我提供 cvSaveImage 的完整路径时，保存视频帧和静止图像才对我有用：

```
cvSaveImage("/Users/nicc/image.jpg",img); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2010-05-15T11:10:54.530

我想，只是相机没有在第一帧初始化。尝试在 10 帧后保存图像。

# .net - 在没有 WebBrowser 控件的 Windows.Forms 中托管 Silverlight

> ID：851681
> 
> 赞同：8
> 
> 时间：2009-05-12T08:08:22.027
> 
> 标签：.net, winforms, silverlight, com, webbrowser-control

是否可以在没有 WebBrowser 控件的情况下在 Windows.Forms 中托管 Silverlight 以避免不必要的 COM 封送处理？

**编辑**：目标是在 Windows 2000 等旧平台上使用丰富的图形内容，如 WPF 或 Silverlight。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-07-27T17:14:39.243

下面列出了在 Windows 应用程序等主机上托管 Silverlight 的所有可用选项：

[微软文档](http://msdn.microsoft.com/en-us/library/dd550717(VS.95).aspx#using_silverlight_in_a_browser_control)

Rahul Gangwar
技术顾问
Microsoft

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-19T22:00:20.860

尽管可以一起破解不使用 IE 作为 Silverlight 内容主机的解决方案，但 Microsoft 不支持它（因此您可能会遇到设计和稳定性问题）。您最好的选择是将浏览器用作直接主机，并尽量减少您正在使用的实例数量（以限制托管 Internet Explorer 实例使用的内存量）。

您提到了 WPF——Windows 2000 上没有必要的平台部件来支持 WPF。

在对直接在 WinForm 上托管 Silverlight 内容进行了短暂（但失败）的实验之后，很明显它不是为这种情况而设计的。您可以尝试将控件添加到 WinForm（只需将其作为 COM 引用添加到控件中，它称为“Microsoft Silverlight”）。它作为控件正确定位，但设置源 URL 是不够的，并且没有明显的方法可以使其“运行”。它无法下载，也无法正确绘制。

# c# - 查找序列中的所有非最后序列

> ID：851683
> 
> 赞同：2
> 
> 时间：2009-05-12T08:09:07.253
> 
> 标签：c#, list

我似乎无法理解这个......我有一个看起来有点像这样的序列：

```
A  1  1  50
A  1  2  50
A  2  1  20
A  2  2  60
B  1  1  35
B  1  2  35
C  1  1  80
D  1  1  12
D  1  2  12
D  1  3  15
D  2  1  12 
```

我需要做的是将这些最后一列的值设置为 0，它们不是最后一个值。例如，我需要将 A11 设置为 0，因为有一个 A12。我需要将 A21 设置为 0，因为有一个 A22。B11 必须为 0，因为有一个 B12。剩下 C11，因为没有 C12。由于 D13，D11 和 D12 变为 0，而 D21 保持原样。

在实际数据集中，第 1 列是用户名，第 2 列是日期，第 3 列是登录时间，最后是金额。而且我需要将与某个用户在某个日期的最后一次登录时间无关的所有这些金额设置为 0。

任何人都能够以简单的方式做到这一点？我正在考虑多个嵌套的 foreach 语句或加入和分组等，但我无法决定如何做到最好......或者如何做到这一点真的......

（如果您想出更好的标题，请编辑我的标题！）

* * *

**更多信息**

抱歉，我当然应该告诉你更多关于语言等的信息。我正在使用 C# 和 .NET 3.5。我正在使用 Linq to SQL 从数据库中获取数据，并且我将所有这些数据作为对象（属于一种简单的容器类型类）放在一个通用列表中。我希望我可以调整查询以仅获取最后一行，但问题是这些数据将进入报告，并且必须显示所有行。我希望我可以在报告中做到这一点，但这似乎[并不那么容易](https://stackoverflow.com/questions/829569/ssrs-how-to-make-a-sum-that-only-includes-the-last-item-in-a-group). 或者至少我不知道该怎么做，也没有得到任何有效的答案。所以这就是为什么我认为我需要复制该列并清除那些重复值。这样我就可以显示所有值的列，然后对只有最后一个值的列进行求和。希望这是有道理的：P

哦，还有，要清除单独列中的日期和登录时间问题：事情是它们都是日期时间，并且日期不需要与登录日期时间具有相同的日期。这是一个奇怪的问题，因为我一天的工作可能不需要是 00:00 到 23:59。例如，一天可能从凌晨 3:00 开始。

* * *

**更新**

刚刚发现整个问题可能会以不同的方式解决......（甚至可能应该）通过创建一个新列（在我的情况下是一个新属性），然后仅将这些最后的值复制到该新属性中。但是我必须再次找到所有这些值......与我已经拥有的问题一样，但有点倒退或如何称呼它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T08:27:10.547

如果数据按用户/日期/时间升序排列，那么简单：

```
 Foo lastRow = null;
    foreach (Foo row in list)
    {
        if (lastRow != null && row.User == lastRow.User
            && row.Date == lastRow.Date)
        {
            lastRow.Value = 0;
        }
        lastRow = row;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T08:29:32.243

假设 DataTable 未排序，您可以将行复制到一个数组中，然后使用 Array.Sort 函数对其进行排序，以便它以正确的顺序将一天的所有用户登录分组在一起。然后只需传递行并将最后一个实例的值设置为 0 excpet。

例如：

```
 private void Filter(DataTable tbl)
    {
        DataRow[] rows = new DataRow[tbl.Rows.Count];
        rows.CopyTo(rows, 0);
        Array.Sort<DataRow>(rows, FilterOrder);

        for (int i = 0; i < rows.Length - 1; i++)
        {
            if ((string)rows[i][0] != (string)rows[i + 1][0])
                continue;
            if ((DateTime)rows[i][1] != (DateTime)rows[i + 1][1])
                continue;
            rows[i][3] = 0;
        }
    }

    private int FilterOrder(DataRow row1, DataRow row2)
    {
        string r1c1 = (string)row1[0];
        string r2c1 = (string)row2[0];
        if (r1c1 != r2c1) return r1c1.CompareTo(r2c1);

        DateTime r1c2 = (DateTime)row1[1];
        DateTime r2c2 = (DateTime)row2[1];
        if (r1c2 != r2c2) return r1c2.CompareTo(r2c2);

        DateTime r1c3 = (DateTime)row1[2];
        DateTime r2c3 = (DateTime)row2[2];
        return r1c3.CompareTo(r2c3);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T08:12:55.030

如果您使用的是 .NET 3.5，那么[LINQ](http://blogs.msdn.com/charlie/archive/2006/10/05/Links-to-LINQ.aspx)可能会为您提供构建合理查询的工具，该查询比一堆嵌套`foreach`循环更容易理解。

假设您的数据在数据库中，您可以使用 LINQ to SQL 或 LINQ to Entities 构造强类型对象来表示数据库表中的记录。

这个类是否准确地代表了您正在使用的数据？

```
class User
{
    public string Username { get; set; }
    public DateTime LastLoginDateTime { get; set; }
    public int LoginCount { get; set; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T08:25:44.603

不是世界上最干净的代码，但这将完成它。你应该考虑一两个方法，我把它留给你。

```
 static void ClearRepeatValues()
    {
        var arr = new[] {
        new [] {"A","1","1","50",},
        new [] {"A","1","2","50",},
        new [] {"A","2","1","20",},
        new [] {"A","2","2","60",},
        new [] {"B","1","1","35",},
        new [] {"B","1","2","35",},
        new [] {"C","1","1","80",},
        new [] {"D","1","1","12",},
        new [] {"D","1","2","12",},
        new [] {"D","1","3","15",},
        new [] {"D","2","1","12"}
        };

        if (arr == null || arr.Length == 0)
        {
            return;
        }
        var lastRow = arr[0];
        for (int i = 1; i < arr.Length; i++)
        {
            var currentRow = arr[i];
            if (lastRow[0] == currentRow[0] && lastRow[1] == currentRow[1])
            {
                lastRow[3] = "0";
            }
            lastRow = currentRow;
        }
    } 
```

但是，一个简单的 SQL 查询可能是只获取您关心的值的更好方法，例如：

```
select * from Session s1 where s1.Id in 
(select top 1 s2.Id from Session s2 where s2.User = s1.User order by s2.Date) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T08:58:15.673

这是我的 SQL Server 兼容解决方案。

*您可以在下面找到表格布局。*

## 解决方案

我的想法是找出您感兴趣的列，将该结果集与表连接并修改表中的*每一*行：

```
with SequencesToKeep(col1, col2, col3Max) as
(
    select 
        col1, 
        col2, 
        max(col3) col3Max 
    from 
        sequences
    group by 
        col1, 
        col2
)
update
    sequences
set
    col4 = 0
from
    sequences s
    left join SequencesToKeep sk 
        on  s.col1 = sk.col1 
        and s.col2 = sk.col2
        and s.col3 = sk.col3Max
where
    sk.col1 is null 
```

## 结果

```
select * from sequences

col1 col2        col3        col4
---- ----------- ----------- -----------
A    1           1           0
A    1           2           50
A    2           1           0
A    2           2           60
B    1           1           0
B    1           2           35
C    1           1           80
D    1           1           0
D    1           2           0
D    1           3           15
D    2           1           12 
```

## 表格布局和演示数据

```
create table sequences (col1 varchar(1), col2 int, col3 int, col4 int)
go
insert into sequences values ('A', 1, 1, 50)
insert into sequences values ('A', 1, 2, 50)
insert into sequences values ('A', 2, 1, 20)
insert into sequences values ('A', 2, 2, 60)
insert into sequences values ('B', 1, 1, 35)
insert into sequences values ('B', 1, 2, 35)
insert into sequences values ('C', 1, 1, 80)
insert into sequences values ('D', 1, 1, 12)
insert into sequences values ('D', 1, 2, 12)
insert into sequences values ('D', 1, 3, 15)
insert into sequences values ('D', 2, 1, 12)
go 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T14:07:10.030

好吧，我决定反其道而行之。我添加了另一列，然后运行以下代码：

```
data
    .GroupBy(x => new
        {
            x.Col1,
            x.Col2,
        })
    .Select(x => x.MaxBy(y => y.Col3)
    .ForEach(x =>
        {
            x.Col5 = x.Col4,
        }); 
```

不过，这个解决方案并没有真正回答我原来的问题。但是，根据我的做法，就如何做到这一点提出建议：

*   像其他例子一样分组
*   对于基于 Col3 降序排列的每个组序列
    *   将除第一个项目之外的所有项目设置为 0（也许只使用 bool 或其他东西）

未经测试，但在我看来，这至少应该有效：p

**注意：** MaxBy和[ForEach](http://code.google.com/p/morelinq/wiki/OperatorsOverview)方法[来自](http://code.google.com/p/morelinq/)[MoreLinq](http://code.google.com/p/morelinq/wiki/OperatorsOverview)。

# python - 如何从 txt 文件中读取路径并将这些文件复制到新目录？

> ID：851689
> 
> 赞同：2
> 
> 时间：2009-05-12T08:12:54.157
> 
> 标签：python, file-io, copy

> ```
> from shutil import  copy
> f = open(r'C:\temp.txt', 'r')
> for i in f.readlines():
>     print i
>     copy(i,r"C:\opencascade")    
> 
> f.close() 
> ```

我正在从 temp.txt 文件中读取路径，该文件每行有 500 行，是要复制到位置“C:\opencascade”的特定文件的路径 如何将上面代码中的 'i' 转换为原始字符串以使代码工作

来自解释器的错误

```
 copy(i,r"C:\opencascade")    
  File "C:\Python26\lib\shutil.py", line 88, in copy
    copyfile(src, dst)
  File "C:\Python26\lib\shutil.py", line 52, in copyfile
    fsrc = open(src, 'rb')
IOError: [Errno 22] invalid mode ('rb') or filename: 'C:\\OPENCASCADE6.2.0\\ROS\\INC\\toptools_hsequenceofshape.hxx\n' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-05-12T08:46:03.307

你有一个`\n`at 和 of 文件名。

尝试：

```
copy(i.strip(), r"C:\opencascade") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-07-15T10:28:07.937

错误是路径中的单个“\”而不是双“\”。

# asp.net - 如何在部署的 ASPX 文件中设置断点

> ID：851694
> 
> 赞同：0
> 
> 时间：2009-05-12T08:13:46.730
> 
> 标签：asp.net, visual-studio, iis, debugging

我在具有 IIS7 和 Visual Studio 2008 的测试机器中部署了一些 ASPX 文件。

现在我用 VS2008 附加到 w3wp 进程并打开一个 ASPX 文件。ASP 文件有一些内联代码，例如

```
<% DoSomthing() %> 
```

我将光标移动到该行并按 F9，但状态栏显示“这不是断点的有效位置”。我在 web.config 文件中进行了以下设置。

```
<compilation defaultLanguage="c#" debug="true"> 
```

那么，如何为已部署的 aspx 文件设置断点呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T09:24:16.660

您应该至少具有在 IIS 服务器上显示的相同源代码，将调试器附加到本地计算机（测试）连接到 IIS 应用程序使用的数据库，并模拟错误。你不应该有任何问题。祝你好运。

# java - jsp 标记文件是否有 DTD 或 Schema 文件？

> ID：851698
> 
> 赞同：3
> 
> 时间：2009-05-12T08:14:26.807
> 
> 标签：java, jsp, jsp-tags

我正在编写一些 JSP 2.x 标记文件。我已经搜索了几个小时，但是我找不到基于 jsp 的标记文件的 doctype/schema 定义/dtds。

有人知道是否有 dtd/schema 文件可以减轻编写这些标签文件的痛苦吗？在 Eclipse 中没有自动完成等功能是非常痛苦的。我必须检查我在编写标签时找到的一些教程。

澄清一下：我不是在谈论基于 java 的标签，也不是在 taglib tld 文件。我说的是由 jsp 代码组成的标记文件，通常以 .tag 或 tagx 结尾，它们位于 META-INF/tags 或 WEB-INF/tags 中。

高度赞赏提示

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T08:20:50.290

就在这里。 [看这里](https://svn.codehaus.org/jetty/servlet-api/branches/servlet-2.5/src/main/resources/javax/servlet/jsp/resources/jspxml.dtd)

带有 dtd 链接的语法参考在[这里](http://java.sun.com/products/jsp/syntax/2.0/syntaxref20.html)。

# screen - Xrandr 错误。BadName（命名的颜色或字体不存在）

> ID：851704
> 
> 赞同：59
> 
> 时间：2009-05-12T08:17:53.727
> 
> 标签：screen, xrandr

通过这个小“脚本”，我成功地使用**xrandr**在我的工作场所扩展了我的桌面。

```
#!/bin/sh

xrandr --newmode 1920x1080  220.64  1920 2056 2264 2608  1080 1081 1084 1128  -HSync +Vsync
xrandr --addmode VGA 1920x1080
xrandr --output VGA --mode 1920x1080 
```

一切都很顺利，直到有一天神奇地停止工作。当我尝试使用它时。我刚收到这个消息。

> X Error of failed request: BadName (named color or font does not exist)

笔记本电脑显示屏以一种奇怪的方式调整大小，但扩展显示器没有任何反应。

我已经恢复了 gnome 桌面默认配置。我更改了字体配置，尝试使用其他布局和显示器，但总是相同。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2010-08-05T12:58:54.297

您是否尝试过为该模式使用不同的名称？我收到此错误并尝试使用名称“1080p”（例如 xrandr --newmode “1080p”...）而不是我通常使用的名称“1920x1080”并且它有效。我不确定是什么导致了错误，因为 xrandr 甚至没有列出 1920x1080 模式，也不能通过 --rmmode 删除它，但是创建一个具有不同名称的新模式似乎对我有用。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2010-10-30T15:25:57.273

我遇到了类似的问题，我相信这是因为我之前已经创建了该设置（然后重新启动）。如果我跳过那个阶段并直接进入：

$ xrandr --addmode LVDS1 1280x720

在终端中它会立即执行此操作，也许我们正在尝试创建系统中已经存在的东西？如果它在第一次尝试时就这样做了，尽管我无法给出解释，对不起，我是使用 ubuntu 代码的新手，9.04 完美运行，升级到 10.10 有点让人头疼！

希望它适用于其他人。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-08-22T04:55:49.187

迟到了，但请尝试`arandr`改用。使用可视化配置工具而不是`xrandr`.

# javascript - Firefox 后退按钮仅在第一次有效，第二次无效

> ID：851705
> 
> 赞同：0
> 
> 时间：2009-05-12T08:17:55.583
> 
> 标签：javascript, html, firefox, forms

我有一个网站，您可以在其中搜索带有日期等的内容。当我发布表单时，我会进入结果页面，当我点击后退按钮时，我会返回我的搜索页面并重新填写值。这适用于 IE 和 FF。

**但是，无论我做什么，当我第二次**搜索并返回时，这些值在 Firefox 中丢失了，而 IE 和其他浏览器仍然记得填充的值。无论我在搜索页面上做什么，它都不会记住新状态，而只会记住原始的第一状态。即使我在发布之前检查表单值，它也会显示正确的值，但是在返回时它会丢失。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T09:56:29.307

行，

我做了一个干净的测试用例，没有我所拥有的所有额外的东西，并得出了一个简单的结论，即 # 导致了混乱和我的问题。

当你这样做时

```
<a href="#" onclick="DoSomethingFirstBeforeSubmittingTheForm()">Go!</a> 
```

Firefox 回到页面的 .html 变体，而 IE 回到页面的 .html# 变体。

当你这样做的时候

```
<a href="javascript:DoSomethingFirstBeforeSubmittingTheForm()">Go!</a> 
```

FF 和 IE 都返回到 html 页面，并使用正确的缓存。

# javascript - 如何为相应的浏览器调用不同的css，比如使用jquery

> ID：851708
> 
> 赞同：0
> 
> 时间：2009-05-12T08:18:43.493
> 
> 标签：javascript, jquery, css

这已经被问到[如何使用 jquery 为特定浏览器调用特定的 css](https://stackoverflow.com/questions/848227/how-do-call-specific-css-for-specific-browser-using-jquery)

我想将一个 css 文件用于 safari，另一个用于 Mozilla，另一个用于 IE

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T08:30:32.710

您可能应该在服务器端执行此操作（甚至更好，根本不这样做）。但是如果你不想做这个客户端，你需要这样的东西。

```
var writeStyleSheet = function(url){
    var linkTag = document.createElement('link');
    linkTag.type = 'text/css';
    linkTag.rel = 'stylesheet';
    linkTag.href = url;
    linkTag.media = 'screen';
    document.getElementsByTagName("head")[0].appendChild(linkTag);
}
if(jQuery.brwoser.msie){
    writeStyleSheet('ie.css');
}
else if(jQuery.browser.safari){
    writeStyleSheet('safari.css');
}
else if(jQuery.browser.mozilla){
    writeStyleSheet('mozalla.css');
} 
```

但是请注意，jQuery.browser 在 1.3 中已弃用。您应该创建一个适用于所有浏览器的样式表。可能为 IE 特定的 hack 添加一些条件注释：

```
 <!--[if IE]>
  <link type='text/css' href='ieHacks.css' rel='stylesheet' />
 <![endif]--> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T08:44:45.273

您可以使用 $.browser 对象检测浏览器。

为了获得所需的样式表，我从这个[博客条目中得到了关注](http://www.rickardnilsson.net/post/2008/08/02/Applying-stylesheets-dynamically-with-jQuery.aspx)

```
$(document).ready(function() {
    $("a").click(function() {
        $('head').append('<link rel="stylesheet" href="style2.css" 
         type="text/css" />');
    });
}); 
```

这是[Kelvin Luck](http://www.kelvinluck.com/2006/05/switch-stylesheets-with-jquery/)的另一篇不错的文章，描述了使用 jquery 动态替换和应用样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T08:26:45.040

您可以嗅探浏览器，然后创建一个`link`元素并将其附加到`head`标签中。

```
if(jQuery.browser.msie)
    $('head').append('<link href="css/ie.css" rel="stylesheet" />');
... // and so on. 
```

编辑：[jQuery.browser](http://www.tvidesign.co.uk/blog/CSS-Browser-detection-using-jQuery-instead-of-hacks.aspx "jQuery.browser")的参考。

# c - 计算数组中的重复元素

> ID：851716
> 
> 赞同：0
> 
> 时间：2009-05-12T08:24:14.777
> 
> 标签：c, arrays, count

计算数组中重复的元素.....输入是`{1,1,1,1,2,2,2,3,3,4}` 输出是

```
1=4
2=3
3=2
4=1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T08:41:45.233

```
prev = input[0];
count = 1;
for (i = 1; i < ARRAYSIZE; i++)
{
  if (input[i] == prev) count++;
  else
  {
    printf("%d=%d ", prev, count);
    prev = input[i];
    count = 1;
  }
}
// Printing the last element
printf("%d=%d ", prev, count); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T08:56:05.460

如果已经排序，可能有更快的方法

将列表分成两半。以这种方式处理每个部分：测试第一个和最后一个数字。如果它们相同，您就知道结果。如果不一样，则将其拆分为中间并再次递归每一半。

对于相同数量的长时间运行，这将是有效的。如果部分很小，它应该恢复为一对一的方法。您可以在随机点对数据进行采样，测试 s、s+1，以获得一个数字从其前身增加的时间百分比。数字越高，您应该越早切换到一对一的方法。

这种方法也是可并行的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T08:59:53.330

如果值的范围很小，您可以使用另一个数组来保存每个元素的计数，就像[计数排序](http://en.wikipedia.org/wiki/Counting_sort)一样。如果值的范围很大，您将需要一个[哈希表](http://en.wikipedia.org/wiki/Hash_table)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T08:42:12.330

似乎数组已排序（根据示例）。如果是这样，您只需要选择第一个元素并遍历数组，直到找到一个不同的值。在此过程中，您可以在循环中使用一个计数器来计算出现次数。

然后选择找到的不同值而不是第一个元素并重复该过程。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-13T11:27:16.123

简单的例子解释。

// 计算每个元素的数量 创建一个排序散列来保存原始数组中的每个唯一元素（也可以作为链表完成） 如果散列元素已经存在，则从数组中读取每个元素 增加该键的计数（值）如果哈希元素不存在创建键值对（value = 1）循环

// 通过散列的键和 printf("%d: %d\n", key, value); 打印每个元素循环 如果您还需要表示零值，请实现 lastKey 并与 lastKey 进行比较以确定键是否为零

排序和简单的程序/功能

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T08:27:18.877

一个好的方法是遍历数组中的元素并计算你看到的每个元素的数量。一旦你完成了，你打印出你得到的计数。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-13T07:36:34.130

```
void count_elements(int * pArray, long nElements)
{
    int * pStart;
    for ( pStart = pArray++; nElements > 1; nElements--, pArray++ )
    {
        if ( *pStart != *pArray )
        {
            printf("%i = %u ", *pStart, (pArray - pStart));
            pStart = pArray;
        }
    }
    printf("%i = %u ", *pStart, (pArray - pStart));
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-13T12:07:59.473

已处理：
1) 数组项结束
2) 空案例
3) 单例案例

```
#include <stdio.h>

int main() {

  int input[] = {1,1,1,1,2,2,2,3,3,4};

  if (sizeof(input) == 0) return 0;

  int prev = input[0];
  int count = 1;
  int i;
  int ARRAYSIZE = sizeof(input) / sizeof(int);

  for (i = 1; i < ARRAYSIZE; i++) {
    if (input[i] == prev) {
      count++;
    } else {
      printf("%d=%d ", prev, count);
      prev = input[i];
      count = 1;
    }

  }
  printf("%d=%d\n", prev, count);
  return 0;
} 
```

和测试用例：

```
when input is {}
-----------------------------------
jianlin@ubuntu:~$ gcc try.c
jianlin@ubuntu:~$ ./a.out

when input is {123}
-----------------------------------
jianlin@ubuntu:~$ gcc try.c
jianlin@ubuntu:~$ ./a.out
123=1 

when input is {1,123}
-----------------------------------
jianlin@ubuntu:~$ gcc try.c
jianlin@ubuntu:~$ ./a.out
1=1 123=1 

when input is {1,1,1,1,2,2,2,3,3,4}
-----------------------------------
jianlin@ubuntu:~$ gcc try.c
jianlin@ubuntu:~$ ./a.out
1=4 2=3 3=2 4=1 

when input is {1,1,1,1,2,2,2,3,3,4,4}
-----------------------------------
jianlin@ubuntu:~$ gcc try.c
jianlin@ubuntu:~$ ./a.out
1=4 2=3 3=2 4=2 
```

# css - CSS background-image - 正确的用法是什么？

> ID：851724
> 
> 赞同：151
> 
> 时间：2009-05-12T08:25:58.440
> 
> 标签：css

CSS background-image 属性的正确用法是什么？我想了解的关键是

1.  它是否需要在引号中，即：`background-image: url('images/slides/background.jpg');`
2.  它可以是相对路径（如上所述）还是必须是完整的 URL？
3.  我应该注意的任何其他点，以确保它在符合标准的浏览器中正常工作。

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2009-05-12T08:36:31.543

路径可以是完整的或相对的（当然，如果图像来自另一个域，则它必须是完整的）。

您不需要在 URI 中使用引号；语法可以是：

```
background-image: url(image.jpg); 
```

或者

```
background-image: url("image.jpg"); 
```

但是，从[W3](http://www.w3.org/TR/CSS2/syndata.html#value-def-uri)开始：

> 出现在不带引号的 URI 中的某些字符，例如括号、空格字符、单引号 (') 和双引号 (")，必须使用反斜杠进行转义，以便生成的 URI 值是 URI 标记：'\(', '\)'。

因此，在此类情况下，要么必须使用引号或双引号，要么转义字符。

* * *

## 回答 #2

> 赞同：49
> 
> 时间：2009-05-12T08:32:01.053

1.  不，您不需要引号。

2.  是的你可以。但请注意，相对 URL 是从样式表的 URL 解析的。

3.  最好不要使用引号。我认为有些客户不理解他们。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-05-12T08:34:33.590

1) 加引号是个好习惯

2）它可以是相对路径，例如：

```
background-image: url('images/slides/background.jpg'); 
```

将在从中加载 css 的文件夹中查找 images 文件夹。因此，如果图像在另一个文件夹中或 CSS 文件夹树之外，您应该使用绝对路径或相对于根路径（以 / 开头）

3）您应该使用完整的背景图像声明，以使其在符合标准的浏览器中表现一致，例如：

```
background:blue url('/images/clouds.jpg') no-repeat scroll left center; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-05-12T08:37:29.077

相对路径很好，不需要引号。另一件有用的事情是使用“速记”`background`属性来指定背景颜色，以防图像无法加载或由于某种原因不可用。

```
#elementID {
    background: #000 url(images/slides/background.jpg) repeat-x top left;
} 
```

另请注意，您可以指定图像是否将重复以及在哪个方向（如果不指定，默认为水平和垂直重复），以及图像相对于其容器的位置。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-08-13T07:15:36.010

如果您的图像位于 css 文件的单独目录中，并且您希望相对路径从您网站的根目录开始：

```
background-image: url('/Images/bgi.png'); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-27T08:58:25.130

只需检查图像所在的目录结构，假设您在 css 文件夹之外有一个 css 文件夹和 images 文件夹，那么您将不得不使用“../images/image.jpg”，它会像我一样工作，只需确保目录结构。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-26T08:42:12.487

只需像下面这样写在你的css文件中

```
background:url("images/logo.jpg") 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-07-27T06:50:04.950

如果说 use 正在使用您的 css 文件中的图像，您真的不需要引号

```
{background-image: url(your image.png/jpg etc);} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-05-12T08:29:31.337

你不需要使用引号，你可以使用任何你喜欢的路径！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-05-12T08:36:36.660

查看[背景图像](http://reference.sitepoint.com/css/background-image)和[URI的相应站点点参考页面](http://reference.sitepoint.com/css/uris)

1.  它不必在引号中，但如果您愿意，可以使用它们。（我认为 IE5/Mac 不支持单引号）。
2.  相对和绝对都是可能的；相对路径是相对于 css 文件的路径。

# perl - 如何从 Perl 访问 Intranet 网页？

> ID：851726
> 
> 赞同：3
> 
> 时间：2009-05-12T08:26:15.103
> 
> 标签：perl

我正在编写一个 Perl 脚本来访问具有身份验证的 Intranet 页面。是否有任何 Perl 模块可以访问 Intranet 网页？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T10:03:44.693

通常处理它的方法是使用 WWW::Mechanize。对于初学者，安装 WWW::Mechanize::Shell，然后运行：

```
perl -e 'use WWW::Mechanize::Shell; shell' 
```

然后你可以使用“help”、“get”、“open”、“fillout”和其他很酷的命令。

当您完成基本工作（例如进入页面、登录、页面上的一些导航）时，键入命令“脚本” - 这将生成有效的 perl 程序，该程序将重复您刚刚以交互方式执行的相同步骤。您可以将此程序复制/粘贴到某个 .pl 文件中，并根据您的需要对其进行修改。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-12T08:39:53.660

看看[LWP](http://search.cpan.org/~gaas/libwww-perl-5.800/lib/LWP.pm)和[Authentication with LWP](http://lwp.interglacial.com/ch11_03.htm)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-05-12T09:17:52.943

就软件而言，Intranet 和 Internet 之间没有区别——它们使用相同的技术，其中一种只是私有的。

您如何处理身份验证取决于身份验证的实现方式。[WWW:Mechanize](http://search.cpan.org/dist/WWW-Mechanize/)可能会处理大多数事情，但我对一些专有的 Microsoft 系统有一个挥之不去的记忆，它允许 Internet Explorer 使用用户的域身份验证详细信息，如果您正在使用它，那么您可能会发现[Win32::IE::Mechanize](http://search.cpan.org/~abeltje/Win32-IE-Mechanize-0.009/)将处理给你的。

# scrum - Scrum 和跨职能团队与专家

> ID：851728
> 
> 赞同：9
> 
> 时间：2009-05-12T08:27:05.320
> 
> 标签：scrum

***为澄清而编辑的帖子（底部的原始帖子）。***

我希望将研发人员从水平（即基于专业或基于组件的）团队重组为垂直（即功能，自给自足）团队。我最终可能会组建 3-4 个团队，其中包括开发人员和 QA 工程师，他们可以协作处理产品的大部分方面。但是，我只有一名合格的 DBA 和一名技术作家。我可以在一个团队中拥有 DBA，并为他的团队提供需要最复杂的 DB 工作的功能，并为*没有*DBA 的团队分配与 DB 相关的更琐碎方面的任务。

但是，几乎每个功能都需要更新文档，而文档是几乎每个功能都必须完成的任务，才能**完成**。我只有一位技术作家。其余的开发人员没有（也无法学习）编写文档所需的技能，因为它不是用他们的母语编写的。

我如何在垂直团队中处理这些资源？

1.  我是否让作者*不*属于任何团队？这将使团队不可能靠自己“完成”。
2.  我是否让作家成为所有团队的一员？如果是这样，他如何参加所有团队的会议（每日、计划、回顾）？
3.  我让他成为一个团队的成员吗？哪一个？所有球队都同样需要他。没有他，其他团队如何“完成”？

谢谢，阿萨夫。

* * *

**原来的：**

我们公司希望采用 Scrum 的生活方式，并且能够为团队分配一个特性，并在团队内将该特性“完成”（即根据完成的定义）。

但是，有些技能需要团队中没有足够多的人拥有的技能，才能为每个团队分配一项（例如技术作家、DBA、集成专家等）。

您将如何与大多数垂直团队的资源有限专家打交道？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-18T14:06:57.277

在做了一些研究（很多网站，以及 Glenn M. Parker 的一本名为“跨职能团队”的书）之后，我得出了以下结论：

1.  一个团队应该由***集体有资格***让团队的功能“完成”的人组成。这意味着，**不**期望每个成员能够执行所需的每项任务，但所需的每项任务都可以由团队中的至少一个成员以足够的质量执行。
2.  虽然团队应该是*跨职能的*，但当有多个团队时，还应该有某种形式的*职能部门*，无论是官方的还是其他的，由该领域的专家领导。专家可能是一个团队的成员，也可能不是，但在任何情况下，所有执行特定功能任务的成员都应该与专家进行足够频繁的沟通和协作，作为**如何**完成工作的专业权威。

在我的示例中，这意味着 DBA 和技术作家都将领导各自的专业论坛或部门（取决于正式程度），他们*可能*各自是一个团队的成员。数据库和文档工作将由有能力的团队成员完成，并在专家的监督下（专业权威）进行。

通过这种方式，组织中可能存在专家、通才以及介于两者之间的人。

当然，在这种方法中，团队能够以自给自足的方式完成分配给它的所有业务级任务（功能、用户故事），这正是我们想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T17:11:41.343

首先，我不会混淆 Scrum 团队和组织结构。组织方面，你的技术。writer 可以属于任何团队。从 Scrum 的角度来看，我会将技术作家的时间专门用于团队（分配取决于您的 sprint 大小），例如每周一天给每个团队或上午/下午（2 个团队）。这样一来，每个 Scrum 团队都知道技术编写者分配给他们的数量和时间，并可以做出相应的计划。如果可能的话，我也会让技术作家参加所有的日常会议（如果有 2 个团队，这应该是可行的）。这样，技术作家（或任何稀缺资源）将成为所有团队的一部分（scrum-wise）。我认为唯一的问题可能是只为指定的团队和指定的时间工作的纪律，但我相信你会在一两个冲刺中对我们进行排序。我不确定计划会议，

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-04-12T22:15:04.333

显然，你不能共享这些资源，除非你想在你的公司中引入“上帝对象”和“信息瓶颈”反模式。

我建议**传播他们的知识，而不是将所有相关工作分配给他们，而是强迫您的 DBA 和技术作家****与其他团队成员**分享他们的经验。使用敏捷中最好的技术之一——结对编程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T01:55:33.063

1.  我是否让作者不属于任何团队？这将使团队不可能靠自己“完成”。

    即使您有一个技术作家，也应该组建一个文档团队，由一个人领导，显然同一个人将成为该团队的成员。跨职能团队成员可访问的通用任务存储库应通过两个主要文档（即只读和可编辑文档）进行访问，并将它们与每日 Scrum 会议一起进行版本控制。

2.  我是否让作家成为所有团队的一员？如果是这样，他如何参加所有团队的会议（每日、计划、回顾）？

    不。技术作家需要独立地对自己的工作负责，除了他/她自己的 ScrumMaster 之外，没有人向任何人报告。

3.  我让他成为一个团队的成员吗？哪一个？所有球队都同样需要他。没有他，其他团队如何“完成”？

    如果每个团队在如上所述的通用文档存储库中看到 LVIE 的可用性和进度，他们就会完成他们的任务。

希望能帮助到你。如果您不能欣赏所有这些人的意见，因为我可以很容易地看到您在做什么，请尝试至少返回他们的 2 美分以发表他们的意见，帮助您:)

# c++ - boost::bind 和返回 auto_ptr 的成员函数的问题

> ID：851732
> 
> 赞同：1
> 
> 时间：2009-05-12T08:28:21.777
> 
> 标签：c++, boost-bind

为什么这段代码无法用 VS 2005 编译：

```
#include <boost/bind.hpp>
#include <boost/function.hpp>

struct X
{
    typedef std::auto_ptr<int> IntType;
    // typedef int IntType; // this works

    IntType memfunc () const
    {
        return IntType ();
    }

    X ()
    {
        boost::bind (&X::memfunc, this);
    }
}; 
```

出现此警告和错误：

```
1>j:\libraries\boost\boost_1_37_0\boost\bind.hpp(1643) : warning C4180: qualifier applied to function type has no meaning; ignored
1>        j:\libraries\boost\boost_1_37_0\boost\bind.hpp(1677) : see reference to class template instantiation 'boost::_bi::add_cref<Pm,I>' being compiled
1>        with
1>        [
1>            Pm=std::auto_ptr<int> (__thiscall X::* )(void),
1>            I=1
1>        ]
1>        j:\dev\test\test\listtest.cpp(16) : see reference to class template instantiation 'boost::_bi::dm_result<Pm,A1>' being compiled
1>        with
1>        [
1>            Pm=X::IntType (__thiscall X::* )(void),
1>            A1=X *
1>        ] 
```

?

将 IntType typedef 更改为只是一个 int 允许它编译。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T08:53:19.567

似乎，尽管文档声称它们是等效的，但以下替代方法有效：

```
boost::bind<IntType> (boost::mem_fn (&X::memfunc), this); 
```

去搞清楚...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T08:46:43.867

我不知道，但是您是否尝试过`bind`指定返回类型的替代语法？

```
bind<IntType>(&X::memfunc, this);
bind<std::auto_ptr<int> >(&X::memfunc, this); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T09:27:24.103

仅供参考：gcc 4.3.3 可以很好地编译代码。

# c# - asp.net 中的用户跟踪

> ID：851733
> 
> 赞同：0
> 
> 时间：2009-05-12T08:29:05.707
> 
> 标签：c#, asp.net

我正在开发一个 asp.net 应用程序，在该应用程序中我正在创建一个跟踪用户活动的页面，例如在我的应用程序中没有访问过的页面。

其中我还需要找出自登录以来收到的总 KB（数据）和自每个用户登录后发送的总 KB（数据）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T10:15:11.353

首先，我会考虑您是否需要自己实现此功能，Google Analytics 可以很好地跟踪使用情况并且是免费的。您可以在[http://www.google.com/analytics](http://www.google.com/analytics)上找到它，您需要做的就是在所有页面中添加一些 javascript。您的母版页是执行此操作的好地方。

如果您一心想自己做这件事，实现它的一个好方法是使用 HttpModule。在每个页面请求期间都会调用一个 HttpModule。

在 HttpModule 的 Init 方法中，您可以捕获 BeginRequest 和 EndRequest 事件。您可以查看 BeginRequest 中的 Request 对象和 EndRequest 中的 Response 对象。您可以在 ContentLength 属性中找到发送的数据量。您需要将所需的任何信息存储在数据库中。在显示用户活动的页面上，您只需从数据库中检索这些值。

不过，我会认真考虑使用 Google Analytics。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T10:48:52.060

该问题实际上并未阐明“发送/接收的总数据”中包含的*内容。*虽然 HttpModule 可以帮助您处理 aspx 输出，但它不包括图像、css、js 等文件的大小。虽然我不确定他为什么想要这个，但它超出了 Google Analytics 的能力。

我猜 HTTPModule 可以做到（？）如果您将所有资源类型映射为由 .NET 框架处理，那么您可以在为它们提供服务时“测量”所有不同文件的大小。通过跟踪登录 cookie（或您使用的任何东西），可能很容易将所有这些数据写入数据库并以接近实时的方式报告（虽然可能很慢）。

**存储**发送/接收字节的明显位置是 IIS 日志文件。使用[LogParser](http://www.microsoft.com/downloads/details.aspx?familyid=890cd06b-abf8-4c25-91b2-f8d975cf8c07&displaylang=en)将使您能够*报告*该数据 - 如果您编写会话 cookie（或跟踪 IP 地址或其他内容），您可以将该数据链接到每个单独的用户登录。但是，仅基于 IIS 日志，几乎不可能“实时”完成。

我见过的另一个可能对您有帮助的开发人员项目是[Matt Berseth 的“openurchin”](http://mattberseth.com/blog/2008/10/updates_to_my_live_traffic_pag.html)和[LiveTraffic 页面](http://mattberseth2.com/livetraffic/)——他的示例使用了类似 Google Analytics 的 javascript，但会将数据发回给您。您需要自己编写代码来解析/保存数据，包括找出发送/接收信息的字节数。

也许如果您提供更多关于您要完成的工作的信息，我们可以提供更好的解决方案？[谷歌分析](http://www.google.com/analytics)在它的作用上*很棒；*并提供有关页面访问、进入、退出、唯一用户等的详细报告 - 非常直观的报告，易于使用。不过，并没有真正下降到“用户级别”。所以这一切都取决于你*需要*做什么......

# .net - WinForms 中具有 Alpha 通道透明度/不透明度的启动画面

> ID：851738
> 
> 赞同：2
> 
> 时间：2009-05-12T08:30:27.030
> 
> 标签：.net, winforms, transparency, opacity, splash-screen

如何在 WinForms 中使用具有 alpha 通道透明度/不透明度的图像实现启动画面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T10:36:36.683

看看[C# 中的 Per Pixel Alpha Blend](http://www.codeproject.com/KB/GDI-plus/perpxalpha_sharp.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T08:52:10.940

取决于你的图像是什么样的形状。它是你可以使用代码绘制的东西吗？如果是这样，您可以将表单绘制区域设置为形状，如下所示：

```
yourForm.Region = new Region(someShape); 
```

例如，该形状可以是与您的图像具有相同形状的多边形。

# php - Zend 发生了什么

> ID：851748
> 
> 赞同：1
> 
> 时间：2009-05-12T08:35:03.433
> 
> 标签：php, zend-server

我提前道歉，因为这不是一个严格的编码问题，但是，我想尽可能广泛地征求意见。

多年来，我一直在使用 hte Zend php 堆栈（其中包括），主要是因为 htey 提供最好的 ORACLE 支持，并且他们提供商业支持，让我的企业客户满意（中层管理人员只是喜欢花钱！）。

但是最近我在很短的时间内遇到了两个问题。首先，他们在没有通知的情况下放弃了 AIX 支持（我检查了我想要的版本是否可用，检查了是否支持正确的 Oracle 版本等。两周后我去下载并发现 - 没有 AIX 版本）。其次，我在 Windows 2003 服务器上进行安装并且安装挂起，当用谷歌搜索该问题时，我发现有几个人在 2008 年初遇到了同样的问题——但没有解决方案。

是否值得再为 Zend 烦恼？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-15T12:41:15.817

我个人对商界的需求不感兴趣，但如果你有兴趣的话，我对 Zend 作为一个**业余编码器有一个拙见。**

最近我对 PHP 框架进行了相当深入的调查，并回顾了最流行的框架。当然，大公司选择 Zend Framework 是因为无限的需求。

如果您还没有设法查看此框架，请这样做。你会发现一大堆丑陋的代码，这些代码在编程习惯方面计划完美，但最终还是它。只是。没有。切。它。

Zend 显示为*PHP*公司。他们可能知道 PHP 是什么，但不知道公司是什么。

# c# - 如何检测哪个窗口是前景窗口？

> ID：851749
> 
> 赞同：2
> 
> 时间：2009-05-12T08:35:24.790
> 
> 标签：c#, window, foreground

我需要编写一个程序集（C#.net 2.0 类库）来监视当前在 PC 中运行的所有应用程序。特别是，我需要知道哪个窗口是最上面的，即当一个窗口变成前景窗口时捕获事件。我应该使用 WndProc() 来捕获相关的窗口消息吗？（我不想使用计时器）。

任何参考论文或示例源代码？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T08:45:20.673

如果你想要通知，你需要一个[CBT Hook](http://msdn.microsoft.com/en-us/library/ms644977(VS.85).aspx)。

# java - Java 枚举、JPA 和 Postgres 枚举 - 如何让它们一起工作？

> ID：851758
> 
> 赞同：51
> 
> 时间：2009-05-12T08:37:42.667
> 
> 标签：java, postgresql, jpa

我们有一个带有 postgres 枚举的 postgres 数据库。我们开始将 JPA 构建到我们的应用程序中。我们也有反映 postgres 枚举的 Java 枚举。现在最大的问题是如何让 JPA 一方面理解 Java 枚举，另一方面理解 postgres 枚举？Java 方面应该相当容易，但我不知道如何做 postgres 方面。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2017-03-30T17:54:22.007

实际上，我一直在使用一种比 PGObject 和 Converters 更简单的方法。由于在 Postgres 中枚举很自然地转换为文本，你只需要让它做它最擅长的事情。如果他不介意，我将借用 Arjan 的情绪示例：

Postgres 中的枚举类型：

```
CREATE TYPE mood AS ENUM ('sad', 'ok', 'happy'); 
```

Java中的类和枚举：

```
public @Entity class Person {

  public static enum Mood {sad, ok, happy};

  @Enumerated(EnumType.STRING)
  Mood mood; 
```

}

@Enumerated 标签表示枚举的序列化/反序列化应该在文本中完成。没有它就用int，比什么都麻烦。

此时，您有两个选择。你要么：

1.  将*stringtype=unspecified*添加到连接字符串中，如[JDBC 连接参数](https://jdbc.postgresql.org/documentation/94/connect.html)中所述。这让 Postgres 猜测右侧类型并充分转换所有内容，因为它接收到类似 'enum = unknown' 的内容，这是一个它已经知道要做什么的表达式使用（将 ? 值提供给左侧类型的反序列化器）。**这是首选选项，**因为它应该一次性适用于所有简单的 UDT，例如枚举。

    ```
    jdbc:postgresql://localhost:5432/dbname?stringtype=unspecified 
    ```

或者：

2.  创建从 varchar 到数据库中枚举的隐式转换。因此，在第二种情况下，数据库接收到一些赋值或比较，例如“enum = varchar”，它在其内部目录中找到一条规则，说明它可以通过 varchar 的序列化函数传递右手值，然后是反序列化函数枚举。这比应该需要的步骤多；并且在目录中有太多的隐式转换会导致任意查询有模棱两可的解释，所以要谨慎使用它。演员阵容如下：

    CREATE CAST (CHARACTER VARYING as mood) with INOUT 作为隐含的；

应该与它一起工作。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2009-05-13T10:38:26.483

这涉及进行多个映射。

首先，JDBC 驱动程序将 Postgres 枚举作为 PGObject 类型的实例返回。它的 type 属性具有您的 postgres 枚举的名称，而 value 属性具有其值。（但是序数没有被存储，所以从技术上讲，它不再是一个枚举，因此可能完全没用）

无论如何，如果你在 Postgres 中有这样的定义：

```
 CREATE TYPE mood AS ENUM ('sad', 'ok', 'happy'); 

```

然后结果集将包含一个类型为“mood”且值为“happy”的 PGObject，该列对应于具有此枚举类型的列和值为“happy”的行。

接下来要做的是编写一些拦截器代码，这些代码位于 JPA 从原始结果集中读取并在您的实体上设置值的位置之间。例如，假设您在 Java 中有以下实体：

```
 public @Entity class Person {

  public static enum Mood {sad, ok, happy}

  @Id Long ID;
  Mood mood;

} 

```

不幸的是，JPA 没有提供一个简单的拦截点，您可以在其中进行从 PGObject 到 Java 枚举 Mood 的转换。然而，大多数 JPA 供应商对此都有一些专有支持。例如，Hibernate 对此有 TypeDef 和 Type 注释（来自 Hibernate-annotations.jar）。

```
 @TypeDef(name="myEnumConverter", typeClass=MyEnumConverter.class)
public @Entity class Person {

  public static enum Mood {sad, ok, happy}

  @Id Long ID;
  @Type(type="myEnumConverter") Mood mood; 

```

这些允许您提供执行实际转换的 UserType 实例（来自 Hibernate-core.jar）：

```
 public class MyEnumConverter implements UserType {

    private static final int[] SQL_TYPES = new int[]{Types.OTHER};

    public Object nullSafeGet(ResultSet arg0, String[] arg1, Object arg2) throws HibernateException, SQLException {

        Object pgObject = arg0.getObject(X); // X is the column containing the enum

        try {
            Method valueMethod = pgObject.getClass().getMethod("getValue");
            String value = (String)valueMethod.invoke(pgObject);            
            return Mood.valueOf(value);     
        }
        catch (Exception e) {
            e.printStackTrace();
        }

        return null;
    }

    public int[] sqlTypes() {       
        return SQL_TYPES;
    }

    // Rest of methods omitted

} 

```

这不是一个完整的工作解决方案，而只是一个希望正确方向的快速指针。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-05-05T15:10:38.700

我提交了一个包含 Hibernate 补丁的错误报告：[HHH-5188](https://hibernate.atlassian.net/browse/HHH-5188)

该补丁适用于我使用 JPA 将 PostgreSQL 枚举读入 Java 枚举。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-05T19:29:45.520

我尝试了上述建议但没有成功

我唯一能做的就是将 POSTGRES def 设置为 TEXT 类型，并在实体中使用 @Enumerated(STRING) 注释。

前（在 Kotlin 中）：

```
CREATE TABLE IF NOT EXISTS some_example_enum_table
(
    id                      UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    some_enum               TEXT NOT NULL,
); 
```

示例 Kotlin 类：

```
enum class SomeEnum { HELLO, WORLD }

@Entity(name = "some_example_enum_table")
data class EnumExampleEntity(
    @Id
    @GeneratedValue
    var id: UUID? = null,

    @Enumerated(EnumType.STRING)
    var some_enum: SomeEnum = SomeEnum.HELLO,
) 
```

然后我的 JPA 查找实际上起作用了：

```
@Repository
interface EnumExampleRepository : JpaRepository<EnumExampleEntity, UUID> {
    fun countBySomeEnumNot(status: SomeEnum): Int
} 
```

# select - socket编程中如何使用select()函数？

> ID：851759
> 
> 赞同：2
> 
> 时间：2009-05-12T08:37:44.723
> 
> 标签：select, sockets, file-descriptor

原型是：

```
int select (int nfds,
            fd_set *read-fds,
            fd_set *write-fds,
            fd_set *except-fds,
            struct timeval *timeout); 
```

很长一段时间以来，我一直在努力理解这个功能。我的问题是，如果它检查从 0 到 nfds-1 的所有文件描述符，并在返回时修改 read-fds、write-fds 和 except-fds，为什么我需要使用 FD_SET 将文件描述符添加到集合一开始，它会检查所有文件描述符，还是不检查？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T08:41:19.603

它不会检查从 0 到`nfds`-1。第一个参数只是提供了一个上限，即所使用的文件描述符在数字上的大小。这是因为集合本身可能表示为位向量，而无法知道实际使用了多少位。将其指定为单独的参数有助于`select()`避免检查未使用的文件描述符。

此外，根本不会检查调用时不在读取集中的描述符`select()`，因此当调用返回时它也不会出现在集合中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T09:02:06.213

我曾经和你有同样的疑问。您可以查看以下问题和答案：

[查询选择系统调用](https://stackoverflow.com/questions/644370/query-on-select-system-call)

# wpf - 包含 i 列表的属性上的 INotifyPropertyChanged

> ID：851761
> 
> 赞同：0
> 
> 时间：2009-05-12T08:38:12.510
> 
> 标签：wpf, inotifypropertychanged

嗨，我在 myClass 中使用此代码来更改我的 wpf 应用程序中的内容

```
 public event PropertyChangedEventHandler PropertyChanged;
  protected void Notify(string propertyName)
  {
     if (this.PropertyChanged != null)
     {
        PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
     }
  } 
```

每次我更改 myClass 中的属性时，它都会更改我的应用程序中的标签。

```
 <Label Content="{Binding Category}" Padding="7,0,0,0" /> 
```

这工作得很好，但在 myClass 我有一个属性包含另一个类的 ilist 文章

```
private IList<Article> m_articles = new List<Article>(); 
```

现在我的问题是，Notify 方法不会更新我的 Ilist 中的内容，我是否可以通过 ilist 和视图使其更新。如果 myclass 是 string 或 int，则 myclass 中的所有属性都可以正常工作，但是当它是 Ilist 时，它不会更新。希望你们明白我的意思是我的英语不好。谢谢你的帮助

这里是xaml中的代码

```
 <ListBox Name="ArtInfo" ItemsSource="{Binding Path=Articles}">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Label Content="{Binding Artnr}" />
                                </DataTemplate>
                            </ListBox.ItemTemplate> 
```

{Binding Path=Articles} <-- 这是包含 ilist 的属性 <-- 这是 Article 类中的属性

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T08:41:36.013

您应该使用 ObservableCollection<Article> 而不是 List<Article>

# c# - 在 Windows Mobile 设备上托管 WebService/WCF？

> ID：851762
> 
> 赞同：2
> 
> 时间：2009-05-12T08:38:38.733
> 
> 标签：c#, wcf, web-services, windows-mobile, compact-framework

我有兴趣编写一个在 windows mobile 上运行的应用程序。我已经准备好一个托管 WCF 服务的 winform 应用程序。我不想将应用程序移植到 windows mobile (6.0) 及更高版本。[MSDN](http://msdn.microsoft.com/en-us/library/bb397842.aspx)在 Compact Framework 上托管了一篇关于 WCF 的文章，但它说托管还不是一种选择。

我是否必须通过 TCP 侦听器自己编写所有内容？

再见马可

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T08:43:25.247

基本上，是的；您需要自己使用`TcpListener`. Even`HttpListener`不在 Compact Framework 中，这很遗憾（否则会很容易）。

但是，可能有可用的预装解决方案。

*出于兴趣，我有一个几乎*存在的开源框架- 它具有所有序列化/调度/等代码，但我还没有添加原始`TcpListener`支持，这很遗憾。但也许很快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-09-27T04:54:29.820

您不能将单声道 HttpListener 类移植到 Compact Framework。至少您将从一个经过良好测试的代码库和作为基线开始。

# java - 最好的 java twitter 库？

> ID：851767
> 
> 赞同：64
> 
> 时间：2009-05-12T08:40:30.883
> 
> 标签：java, twitter

twitter API 站点列出了 4 个 java twitter 库。

*   [推特4j](https://github.com/yusuke/twitter4j)
*   [爪哇推特](http://code.google.com/p/java-twitter/)
*   [推特](http://www.winterwell.com/software/jtwitter.php)
*   [叽叽喳喳](https://github.com/redouane59/twittered)

你认识其他人吗？您在支持、易用性、稳定性、社区等方面的经验如何？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2009-06-15T18:15:43.613

我只是看了看他们。

JTwitter 绝对看起来是三者中最弱的。它最近似乎没有更新，没有涵盖 Twitter API 的大部分内容，并且除了最初的版本之外似乎没有任何版本。从好的方面来说，它是 LPGL 许可的，附带了它需要的少量额外代码，并且看起来小而易于理解。

另外两个，java-twitter 和 Twtter4J 在质量上看起来更接近。两者都涵盖了核心 API，并且都具有正常开源项目的所有配置：公开可用的源代码存储库、在线文档、活动邮件列表和最近的开发活动。

然而，Twitter4J 看起来是领导者。从文档来看，它的 API 覆盖范围似乎更完整。邮件列表肯定更活跃。文档要好得多。对我来说最重要的是，发布更加频繁。java-twitter 发布了一个版本，大约 4 个月前发布了“0.9-SNAPSHOT”版本。Twitter4J 在此期间发布了多个版本，包括 2.0.0 和 2.0.8 之前的增量版本，修复了问题并添加了对新 Twitter API 的支持。

我将从 Twitter4J 开始；如果您没有收到回复，请假设这对我来说很棒。

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2009-05-12T10:23:58.170

我认为 Twitter4j 很好，它是最新的 API

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2010-05-24T10:52:40.767

咳咳；[JTwitter](http://www.winterwell.com/software/jtwitter.php)得到积极维护，定期更新（今天发布 1.6.2 版），并涵盖了大部分 Twitter API。

它只缺少一种设置您的个人资料图片和其他一些个人资料设置的方法。除此之外，它非常完整。状态更新、时间线、友谊、列表、搜索、流媒体等。

它也快速而强大。Twitter 在某些地方可能会出现问题，而 JTwitter 有变通方法和信息丰富的例外，可以让您的生活更轻松。

作为主要的 JTwitter 开发者，我是比较有偏见的！但使用 JTwitter 的开发者的反馈也非常积极。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-11-14T22:24:50.267

我使用 Twitter4J 并且还没有遇到问题。我其实非常喜欢它。

他们在他们的网站上提供的 OAuth 示例是最大的麻烦——它没有帮助。如果您有兴趣（或其他任何人），这是我的 OAuthServlet 代码。我知道这个问题已经很老了，所以我把它放在这里更多是为了搜索结果。

```
package com.example.oauth;

import java.io.PrintWriter;
import java.io.IOException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;
import twitter4j.*;
import twitter4j.http.*;

@SuppressWarnings("serial")
public class OAuthServlet extends HttpServlet {

    public void doGet(HttpServletRequest req, HttpServletResponse resp) throws IOException {

        HttpSession sess = req.getSession(true);
        RequestToken requestToken = (RequestToken) sess.getAttribute("requestToken");

        if (sess.getAttribute("twitter_user_id") != null) {
            resp.setContentType("text/plain");
            PrintWriter out = resp.getWriter();
            if (req.getRequestURI().indexOf("logout") > 3) {
                sess.removeAttribute("twitter_user_id");
                out.println("You're now logged out.");
            } else {
                out.println("You're already logged in!");
            }
        } else if (req.getRequestURI().indexOf("callback") > 3 && req.getParameter("oauth_token").length() > 0 && requestToken != null) {

            handleCallback(req, resp, sess);
            if (sess.getAttribute("oauth_previous") != null) {
                resp.sendRedirect((String) sess.getAttribute("oauth_previous"));
                sess.removeAttribute("oauth_previous");
            }

        } else {

            sendToTwitter(resp, sess);
            sess.setAttribute("oauth_previous", req.getHeader("Referer"));
        }

    }

    private void sendToTwitter(HttpServletResponse resp, HttpSession sess) throws IOException {

        RequestToken requestToken = (RequestToken) sess.getAttribute("requestToken");

        try {
            Twitter twitter = new TwitterCnx().registerOAuth().get();

            requestToken = twitter.getOAuthRequestToken();
            sess.setAttribute("requestToken", requestToken);

            resp.sendRedirect(requestToken.getAuthorizationURL());

        } catch (TwitterException e) {
            PrintWriter out = resp.getWriter();
            out.println(e.getStackTrace());
        }
    }

    private void handleCallback(HttpServletRequest req, HttpServletResponse resp, HttpSession sess) throws IOException {

        RequestToken requestToken = (RequestToken) sess.getAttribute("requestToken");
        sess.removeAttribute("requestToken");
        String secret = req.getParameter("oauth_token");

        resp.setContentType("text/plain");
        PrintWriter out = resp.getWriter();

        try {
            Twitter t = new TwitterCnx().registerOAuth().get();

            AccessToken accessToken = t.getOAuthAccessToken(requestToken.getToken(), secret);
            long id = (long) t.verifyCredentials().getId();

            storeAccessToken(id, accessToken,sess);
            sess.setAttribute("twitter_user_id", id);

            out.println("You're now logged in!");

        } catch (TwitterException e) {
            out.println("Something went wrong. Sorry about that. Please try again.");
        }

    }

    private void storeAccessToken(Long id, AccessToken at, HttpSession sess) {
        //you probably want to persist this somewhere other than in sessions.
        sess.setAttribute("secret", at.getTokenSecret() );
        sess.setAttribute("token", at.getToken());
        //also, don't forget to persist the user id alongside the token.
    }
} 
```

我使用类 TwitterCnx 作为 twitter4j.Twitter 的包装器。TwitterCnx 定义了我的 OAuth 消费者资料并返回一个 Twitter 对象。它是具有静态方法的最终类，因此我不会为每个应用实例生成多个 Twitter 对象。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-07-23T03:06:18.300

对于仍在关注这个问题的任何人，值得一提的是，Twitter[目前在其网站上列出](https://dev.twitter.com/docs/twitter-libraries)的唯一适用于 Java 的 API 是 Twitter4J。所以，如果你需要更多的说服力来证明这是可以使用的，那么，给你！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-09-22T08:39:36.617

我选择 Twitter4j 是因为很多人都在研究它。并且很容易在互联网上找到一些关于它的内容。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-05-30T23:27:45.353

还有**[TweetStream4J](http://github.com/seejohnrun/tweetStream4J)**，它是 Twitter 流 API 的 Java 绑定。它非常简单，并且与我上次使用它不同，作者对其进行了更新以包含一个 pom.xml 文件，以便您可以构建它。当我上次使用它时（来自 Scala），它非常简单快捷。

# c# - 是否可以使 ClickOnce 证书的有效期超过 12 个月？

> ID：851768
> 
> 赞同：5
> 
> 时间：2009-05-12T08:40:48.497
> 
> 标签：c#, deployment, clickonce, certificate

我可以使内部生成的证书/密钥持续超过 12 个月吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T08:47:13.243

这是一篇旧文章，但它在 Visual Studio 2005 时间框架内对我有用。我自己生成的证书不会再过期 50 年左右。:)

[http://geekswithblogs.net/kobush/archive/2005/05/30/41068.aspx](http://geekswithblogs.net/kobush/archive/2005/05/30/41068.aspx)

# c# - selecteditems 和 selectedindex c#

> ID：851781
> 
> 赞同：3
> 
> 时间：2009-05-12T08:42:22.080
> 
> 标签：c#, selecteditem, selectedindex

我是 C# 新手，我开始学习如何编程我正在学习编程到 Visual Studio Microsoft 版中，我使用 WindowsApplication 而不是控制台。在尝试编写此代码时，我遇到了这个命令：Selected Index 和 Selected Item，我想知道两者之间的区别。我现在对我的代码感到很困惑。我正在尝试执行的代码是在列表框中添加和删除文本。

谢谢你的帮助。

附加问题：在我的代码中，我有这一行：

```
int listBoxSelectedItem = listBox1.SelectedIndex;
listBox1.Items.RemoveAt(listBox1.SelectedIndex); 
```

我想了解这部分：第一行有一个名为“listBoxSelectedItem”的变量，类型为“int”。您选择的项目的位置将存储到名为“listBoxSelectedItem”的变量中。那是对的吗？

第二行是，“listBox1.SelectedIndex”是传递给方法的信息，“RemoveAt”我的理解是否正确？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-12T08:45:37.473

选定的项目将返回被选择的对象。选定索引以 int 形式返回列表中的位置。

例如，您可能有一个字符串列表：

```
Cat
Dog
Hamster
Horse 
```

如果您从此列表中选择“Dog”，则 SelectedItem 属性是字符串“Dog”，而 SelectedIndex 为 1（索引从零开始，因此第一项为 0，第二项为 1 等）

# .net - System.Configuration.ConfigurationManager 不可用？

> ID：851783
> 
> 赞同：56
> 
> 时间：2009-05-12T08:42:58.587
> 
> 标签：.net, configurationmanager

在 VS2005 C# 项目中，我添加了对 System.configuration 的引用。在对象浏览器中，我可以看到 System.Configuration.ConfigurationManager。在 Intellisense System.Configuration 中只有旧的 ConfigurationSettings，没有 ConfigurationManager。

我的代码 System.Configuration.ConfigurationManager.AppSettings["MySetting"]

突出显示为语法错误且无法编译。

在另一个项目中，完全相同的设置工作得很好......关于发生了什么的任何线索？

* * *

## 回答 #1

> 赞同：129
> 
> 时间：2009-05-13T20:31:20.370

虽然 *使用 System.Configuration* ; 命令在 using 部分自动生成，由于某种原因未设置实际参考。

进入*add reference*， .Net 选项卡，然后选择*System.Configuration*。

ConfigurationManager 现在将被解析。

如果您转到完全相同的设置工作正常的项目并查看引用，您将看到对 System.Configuration 的引用。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-08-16T22:21:05.673

要回答这个问题（不是说它还没有被回答 5 次以上）是添加 System.Configuration 作为对您的项目的引用。

**然而，我真正想强调的是**，在许多情况下，我已经将 System.Configuration.dll 添加到我的项目引用中，但无论出于什么特殊原因，有时即使在添加对 System.Configuration 的引用之后，ConfigurationManager 仍然不会出现在智能感知中。配置。即使我删除了引用并再次添加它。

这个问题的非常简单的解决方案是：

1.  将对 System.Configuration.dll 的引用添加到您的项目中
2.  保存您的文件
3.  保存您的解决方案
4.  关闭给您带来困难的 Visual Studio 实例
5.  重新打开您的解决方案

这个简单的练习将使 Visual Studio 再次运行，并停止告诉您您没有添加对 System.Configuration 的引用。这个练习通常可以帮助我解决所有莫名其妙的 Visual Studio 行为。

我在 VS2008 和 VS2010 中都多次遇到过这种情况，并且每次都有效。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-05-12T09:00:18.823

呃 - PICNIC 错误。在解决方案中添加了 ref 到错误的项目...

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2009-07-02T11:35:24.083

对于在开发 ASP.NET WebForms 和 WinForms 之间来回切换的任何人来说，这个技巧可能会派上用场。

如果您在 C# WinForms 项目中进行开发，您会发现尝试使用 a`ConfigurationManager`来获取您的`app.config`设置会导致以下错误：

> 当前上下文中不存在名称“ConfigurationManager”

由于这默认包含在 ASP.NET 项目中，这可能会让人感到意外。只需右键单击项目中的“参考”节点并查看“.NET”选项卡。向下滚动，您应该会找到`System.Configuration`. 将此添加到您的项目中，您应该可以启动并运行。

### 添加对 System.Configuration 的引用

如果您已经添加`System.Configuration`到代码顶部的 using 部分，您现在应该能够使用配置设置（例如连接字符串）和以下代码：

```
con.ConnectionString = ConfigurationManager.ConnectionStrings[sConnection].ConnectionString; 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-06-17T18:54:54.403

从 MSDN 文档 -

> 要使用 ConfigurationManager 类，您的项目必须引用 System.Configuration 程序集。默认情况下，某些项目模板（如控制台应用程序）不引用此程序集，因此您必须手动引用它。

[https://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx](https://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-06-27T06:31:52.610

1.  转到*管理 NuGet 包*
2.  浏览*系统.配置*
3.  安装包 System.Configuration.ConfigurationManager。[![看法](https://i.stack.imgur.com/iqqVo.jpg)](https://i.stack.imgur.com/iqqVo.jpg)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-05-12T09:46:16.610

我认为您需要隐式引用**System.Configuration**程序集。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T08:54:23.700

这只是一个猜测，但也许您应该检查您的项目是否至少使用 .NET 框架 2.0。ConfigurationManager 类自 .NET 2.0 起可用，如下所述： [msdn 上的链接](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager(VS.80).aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-01-14T19:40:28.610

哇——这对我来说很难解决；最后，我发现我的 vb.net 程序只有在包含引用（如预期）并从我的模块中删除“Imports System.Net”语句（如我所料）时才能编译。

# php - 如何仅将 Zend Framework 用于布局？

> ID：851785
> 
> 赞同：4
> 
> 时间：2009-05-12T08:43:09.210
> 
> 标签：php, zend-framework, model-view-controller, layout

我最近被请来帮助一个项目，该项目由单个 HTML 文件组成，PHP 联系表单除外。因此，甚至没有任何面向对象编程、MVC 或布局（甚至是 PHP）的提示。

项目挺大的，但是我想慢慢把 Zend 框架集成到这个项目中，主要是开始使用布局。有太多的冗余，以至于进行应该在一个文件中进行的小更新是浪费时间。

在 PHP 的早期，您可以通过在每个页面中包含内容块（例如页眉和页脚）来分隔内容块。现在，使用像 Zend 框架这样的 MVC 框架，您可以使用视图助手创建包含单个页面内容（视图）的布局文件。我真的很喜欢这个，因为这意味着我只需要在一个地方“包含”我的页眉或页脚。

但是，我不确定如果不调度/引导应用程序（即使用 Zend Framework MVC 组件作为独立组件代替），这将如何工作。切换网站以使用布局的最佳方法是什么？它将如何运作？这甚至是个好主意吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-10-11T18:16:50.857

我最近开始转换混合文件结构*，以利用 ZF 的布局和视图。目标是将所有包含 html 的文件移动到推荐的布局和视图[文件结构中。](http://framework.zend.com/manual/en/project-structure.project.html)这是如何准备的：

1.  从每个文件中提取所有标记，保留变量但没有逻辑。将此文件命名为 /application/views/scripts/ **page** / **view** .phtml（例如 /application/views/scripts/index/login.phtml）
2.  创建一个适合大多数页面的骨架，如 /application/layouts/scripts/ **layout** .phtml 并让它包含如下内容：

    ```
    <?php echo $this->doctype('XHTML1_STRICT'); ?>
    <html>
    <head>
        <?php echo $this->headLink(); ?>
    </head>
    <body>
        <div id="wrapper">
        <?php echo $this->layout()->content; ?>
        </div>
    </body>
    </html> 
    ```

3.  （将 Zend 添加到您的包含路径并注册它的 Autoloader。）创建一个将包含在所有文件中的文件（除非您有一个[入口点](http://martinfowler.com/eaaCatalog/frontController.html)，在这种情况下 - 将它放在那里！）创建对您的布局的引用，相当于：

    ```
    $view = new Zend_View();
    $view->setScriptPath('/application/views/scripts');

    $layout = new Zend_Layout();
    $layout->setLayoutPath('/application/layouts/scripts');
    $layout->setView($view);

    Zend_Registry::getInstance()->set('layout', $layout); 
    ```

4.  您留下的每个 php 文件（带有逻辑，而不是 html）都需要访问布局并对其进行修改：

    ```
    $layout = Zend_Registry::getInstance()->get('layout');

    $view = $layout->getView();
    $view->headLink()->appendStylesheet('/css/a_css_file.css');

    // most important step, done automatically when using MVC, but now you have to do it manually
    $layout->content = $view->render('index/login.phtml');

    echo $layout->render(); 
    ```

5.  最重要的下一步是添加另一个布局：

    ```
    // /application/layouts/scripts/blank.phtml
    <?php echo $this->doctype('XHTML1_STRICT'); ?>
    <html>
        <head></head>
        <body>
            <?php echo $this->layout()->content; ?>
        </body>
    </html> 
    ```

    并在您的一个包含逻辑的文件中

    ```
    $layout = Zend_Registry::getInstance()->get('layout');
    $layout->setLayout('blank'); 
    ```

理想情况下，在不久的将来，您可以通过查看像 Front Controller 这样的设计模式来开始适应类似 MVC 的结构。

*一个文件：模型、控制器、html，没有逻辑顺序。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-05-15T18:04:24.790

您当然可以单独使用 Zend_Layout，它在手册中有详细说明：

[28.2.3\. 使用 Zend_Layout 作为独立组件](http://framework.zend.com/manual/en/zend.layout.quickstart.html#zend.layout.quickstart.standalone)

我相信您随后需要通过输出缓冲捕获脚本的输出，并将其传递给要回显的布局。

这种情况并不理想，如果不转向完整的 MVC，我可能会建议使用不同的基本模板系统或遵循此处其他评论中的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T08:47:32.103

就个人而言，如果您只打算将 Zend 框架用于模板/布局管理，我建议您不要使用它。使用 PHP 进行模板化有很多更好的解决方案，[Smarty](http://smarty.net/)是显而易见的选择（以前是 PHP 项目的一部分）。

Smarty 确实提供了与 Zend 框架的相当容易的集成，如果您以后需要这样做，[Zend DevZone](http://devzone.zend.com/article/120)上有几篇关于它的文章。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-15T14:42:08.257

我不确定这是否是您正在寻找的内容，但 bbc 有一些视频，他们使用 zend 框架的一部分而不使用整个 MVC。我认为它们在第 4 和第 5 部分，[http://bbcwebdevelopers.blip.tv/](http://bbcwebdevelopers.blip.tv/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-07-21T20:55:08.957

Zend_Layout 并不是真正包含页眉或页脚，而是最好用于将各种内容位插入到单个大模板中。它非常复杂，并且与常见用例（例如插入内容主体）一样，您可以插入 HEAD 标记（例如 CSS、脚本或标题标记）和自定义占位符（例如导航）。

根据您的描述，我会选择一个简单的 PHP 包含页眉和页脚解决方案。这将更容易实现，并将删除任何常见模板元素的重复。

如果你真的想用它来学习 Zend Framework，你可以按照 dcaunt 的建议在独立模式下使用 Zend_Layout。尝试使用 MVC 引导系统是没有意义的，因为您的站点似乎不需要它。我只是做一些事情，比如使用 URL 重写将所有 *.html 请求发送到单个 PHP 文件，然后启动 Zend_Layout 并通过类似 file_get_contents() 的东西将请求的文件加载到 $layout->content 变量中

如果您愿意，您也可以使用 ZF 进行表单处理。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2009-05-12T08:55:19.440

我不认为您可以默认执行此操作，我认为您还需要使用 Zend View。但我相信您可以修改 Zend_Layout 以使用您现有的设置。抱歉，我不能更具体地说明如何做到这一点，因为这取决于很多目前的情况。

作为一个起点，我建议研究一下 Smarty 与 Zend 的集成，看看如何修改它。

# javascript - 从 JavaScript 调用 JSF 中的服务器端代码

> ID：851795
> 
> 赞同：0
> 
> 时间：2009-05-12T08:45:36.910
> 
> 标签：javascript, ajax, jsf

我正在寻找一种简单的方法来调用不带参数并在 JSF 中返回字符串的 bean 方法。我真正不需要的是该方法返回一个操作结果，然后使用整个 JSF 生命周期来让我进入另一个视图。我需要从 JavaScript 中执行此操作，以便我可以将应用程序的一些客户端部分放在一起，并且查看 RichFaces 的 A4J 部分到目前为止没有给我带来任何好处。

因此，这里又是一步一步的场景：

1.  来自 JS 在某个地址上发出 GET
2.  在 GET 并返回 JSON 或 HTML（基本上是字符串）的服务器进程上
3.  一旦请求被发送回客户端，我希望能够使用 JS 进一步处理它。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T09:49:43.390

使用***a4j:jsFunction***和 data 属性。

所以大致你想要这样的东西：

```
<button onclick="callBackend();">Go</button>

<a4j:jsFunction name="callBackend" action="#{myBean.someMethod}" data="#{myBean.someString}" oncomplete="handleResponse(data);"/>

<script>
function handleResponse(response) {
   alert(response);
}
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T21:46:31.067

Damo：你能解释一下为什么它可能只在方法 callBackend 第一次执行时起作用吗？我遇到了一个奇怪的行为，第一个调用成功，下一个调用被阻止。我看到服务器端代码正在执行，但一些奇怪的结果被发送回浏览器（类似于 _viewstate 之类的东西）。

# informix - (Informix-)4gl 代码的漂亮打印

> ID：851797
> 
> 赞同：1
> 
> 时间：2009-05-12T08:45:54.197
> 
> 标签：informix, pretty-print, 4gl

我正在为 Informix-4GL 源搜索漂亮的打印程序（脚本、代码等）。

你知道任何 ？比你，彼得。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T19:47:08.953

您看过 IIUG（国际 Informix 用户组）[软件](http://www.iiug.org/software)档案吗？那里有两台漂亮的打印机（质量不确定）。

另一个值得关注的地方是[Aubit4GL](http://aubit4gl.sf.net/)站点——I4GL 的开源变体。同样，我不确定他们是否有一台漂亮的打印机，但这可能是他们拥有的东西（尽管随便检查一下没有显示出来）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-14T07:59:53.730

我不知道是否有人正在阅读这篇文章，但获得某种漂亮的 4gl 代码“漂亮打印”的最简单方法是在 Openedge Developer Studio 中查看它，然后使用 ctrl-I 设置缩进。您可以通过说出“标签”的长度来调整编辑器设置中的缩进。（默认为 4，我使用 3）然后执行 ctrl-shift-f 使所有命令字大写。

接下来，您可以使用正则表达式搜索和替换，通过将所有“DO:”语句向上移动到“THEN”语句旁边的一行，将代码压缩几行。ctrl-f: search "\s*\n\s*DO[:]" replace " DO:" 确保你点击了标记正则表达式的复选框。

在这一点上，代码很好而且整洁。执行 ctrl-a 和 ctrl-c 将其复制到剪贴板。将其作为电子邮件粘贴到 Outlook 中而不发送。用彩色打印。

# c# - 从泛型类型加载泛型集合

> ID：851802
> 
> 赞同：1
> 
> 时间：2009-05-12T08:46:45.803
> 
> 标签：c#, generics, collections

我有以下代码，我正在尝试为我的 DAL 中的对象创建一个通用集合（只是一个练习，而不是实际的生产代码）。我的问题是我想使用传入的类型 Read 方法（这是类实现的接口的一部分）。

我无法创建一个`new T`，因此我没有要使用的对象的实例，并且我无法将其声明为基本类型，因为我需要由基本对象的子对象指定的读取方法。

这实际上是可能的还是我叫错了树？

```
public class ItemDictionary<T> where T : ILoadable, DataItem
{

    public void Load()
    {
        using (IDataReader reader = SqlHelper.ExecuteReader(_connection, CommandType.StoredProcedure, _proc)) {
            Read(reader);
        }
    }

    bool Read(IDataReader reader)
    {
        while (reader.Read) 
        {
            T item = default(T);            //Here be the problem

            if (item.Read(reader)) 
            {
                this.Add(item.Guid, item);
            }
        }

        return true;
    }

}

public class ExampleObject : DataItem, ILoadable
{

    bool Read(IDataReader reader)
    {
        _var1 = reader.getString(0);
        _var2 = reader.getString(1);
        _var3 = reader.getString(2);

        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T08:51:23.360

你不能在集合持有的类型上没有默认构造函数并将 new() 指令添加到 where T : 指令吗？

```
public class ItemDictionary<T> where T : ILoadable, DataItem, new() 
```

进而：-

```
 T item = new T(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T08:52:22.330

我不清楚你*为什么*不能使用`new T()`（对 有适当的约束`T`）。我也不清楚您为什么要使用显式接口实现，以及为什么您的`ILoadable`接口有一个名为 的方法`ILoadable`，请注意。

问题是你不能总是保证对象类型中有一个无参数的构造函数吗？如果是这种情况，您肯定需要*一些东西*来创建`T`. 也许你真的需要`T`从它的工厂中分离出来，也许是用另一个接口：

```
public interface IFactory<T>
{
    // Roughly matching your current API
    bool TryRead(IDataReader reader, out T);

    // Simpler if you can just throw an exception on error
    T Read(IDataReader reader);
} 
```

然后你可以将一个`IFactory<T>`实现传递给你的`ItemDictionary<T>`构造函数。

# .net - Settings 和 *.config 有什么区别？

> ID：851806
> 
> 赞同：4
> 
> 时间：2009-05-12T08:48:38.560
> 
> 标签：.net, configuration

过去我使用过一些 *.config 文件，但我根本没有使用过设置文件。简单来说，项目的 Settings 文件和 *.config 文件有什么区别？是否有关于哪些信息放在哪个位置的约定？什么时候应该使用一个而不是另一个？设置文件是如何构建的——它们是嵌入到程序集中，还是像 *.config 文件一样保存在外部？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T08:55:24.213

当您查看数据的存储位置时并不多。
设置为您提供

*   一个 GUI（在项目属性窗口中）来创建键值对，而不是手动调整 app.config
*   设计器生成类型安全类来访问键值对。
*   它还区分了应用程序级别和用户级别的设置。

在内部，键值对存储在 app.config 本身的一个部分中。设置为您提供了一个更好的 API 来处理这个问题，因此应该首选读写 app.config 文件。

在您的项目中创建一个设置文件，然后双击相应的 app.config 文件。您应该在 applicationSettings/userSettings 节点中看到您的设置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T08:58:57.547

项目的设置文件驱动部分 .config。有点儿。

如果您添加设置，您将看到在您的配置文件中创建了一个自定义配置部分。设置文件不是指定 ConfigurationSettings.Application("myKey") 而是用于自动生成一个强类型类，它将您的设置作为属性公开，但实际设置仍保存在配置文件中。

然而，一个区别是用户设置（对于某些项目类型）。这些您可以设置以及获取并将它们持久保存到用户的本地配置文件目录中，而无需自己编写这些位。

# linux - 如何在windows中使用timeval等Linux lib

> ID：851809
> 
> 赞同：0
> 
> 时间：2009-05-12T08:50:20.273
> 
> 标签：linux, cygwin, dev-c++

如何在 windows 中使用诸如 timeval 之类的 Linux lib 我已经安装了 cygwin 和 dev c++ 我不喜欢在 cygwin 中编译 在 dev c++ 下编译总是错误，例如 `gettimeofday' 未声明（首先使用此功能）

不幸的是，我没有足够的硬盘空间来安装 linux 或任何虚拟机

多谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T08:54:49.597

当然，您不能直接在 Windows 中使用 Linux 代码。

但是您似乎正在尝试使用 Cygwin 来执行此操作，它应该支持 Linux/POSIX API。

如果您收到的错误是编译时（而不是链接器）错误，则您可能缺少正确的头文件：

```
 #include <sys/time.h> 
```

这些都记录在`gettimeofday()`手册[页上](http://linux.die.net/man/2/gettimeofday)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T09:26:26.963

毕竟似乎我们不能直接在windows中使用linux lib我的cygwin遇到各种问题最后我安装了vmware，一台虚拟的linux机器并完成了这可能不是一个明智的方法，而是一个实用的方法

# c# - 从资源加载 XML

> ID：851813
> 
> 赞同：13
> 
> 时间：2009-05-12T08:50:55.203
> 
> 标签：c#, xml, resources

我有一个嵌入式 XML 作为资源。当尝试像这样加载它时：

```
XDocument quoteDocument = XDocument.Load(Properties.Resources.Quotes); 
```

我收到一个错误：

> UriFormatException

如何从资源中正确加载 XML？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-05-12T08:51:25.013

将以下内容用于 XDocument

```
XDocument quoteDocument = XDocument.Parse(Properties.Resources.Quotes); 
```

虽然此代码适用于 XmlDocument

```
XmlDocument quoteDocument = new XmlDocument();
quoteDocument.LoadXml(Properties.Resources.Quotes); 
```

# php - PHP 转换器 Html(css) 到 Pdf？

> ID：851816
> 
> 赞同：0
> 
> 时间：2009-05-12T08:51:39.147
> 
> 标签：php, html-to-pdf

**重复：** [使用 PHP 将 HTML + CSS 转换为 PDF？](https://stackoverflow.com/questions/391005/convert-html-css-to-pdf-with-php)

我正在寻找基于 php 的 HTML->PDF 转换器库，用于在我的应用程序中生成报告。到目前为止，我找到[了一个](http://code.google.com/p/dompdf/)，它看起来不错，但有一些限制。任何人都可以推荐任何其他高级的吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T08:55:10.250

您的问题可能会通过**[这个先前发布](https://stackoverflow.com/questions/560583/which-is-the-best-pdf-library-for-php)**的问题得到回答。但是，您可能还想查看[HTML2PDF](http://sourceforge.net/projects/html2fpdf)或任何可以通过 Google 快速搜索找到的各种 PHP PDF 库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T20:06:51.730

如果使用[FPDF](http://www.fpdf.org/)，则有一个脚本可以扩展该类以执行一些基本的 HTML 格式（虽然不是 CSS）。可在此处获得：[http ://www.fpdf.org/en/script/script41.php](http://www.fpdf.org/en/script/script41.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T13:08:19.657

前段时间我使用`html2ps`然后`ghostscript`将html页面转换为pdf，因为它给出了更好的结果，然后是所有html2pdf库。

但可能随着时间的推移发生了变化。最好是尝试一些库，因为生成的 pdf 的质量还取决于您用作基础的 html 的样式。

# networking - LDAP理论推荐

> ID：851817
> 
> 赞同：-1
> 
> 时间：2009-05-12T08:51:53.970
> 
> 标签：networking, ldap

我需要实现支持 LDAP 身份验证的应用程序。

我想详细了解这样的网络是如何工作的。你能推荐一些关于它的阅读，一本书可能对 LDAP 身份验证网络进行更广泛的解释，或者至少有一些在线教程。我希望看到创建此类网络的分步指南，如果可能的话，使用 Win 和 *nx 系统中的示例进行跨平台理论。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T08:56:51.167

[LDAP System Administration](http://oreilly.com/catalog/9781565924918/)是我第一次接触 LDAP 时阅读的书。

那和[OpenLDAP 管理员指南](http://www.openldap.org/doc/admin24/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T09:00:56.730

除了[gacrux](https://stackoverflow.com/questions/851817/theory-recomendation-about-ldap/851838#851838)，我建议看看

*   [用于介绍的轻量级目录访问协议](http://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol)（维基百科）
*   Luiz Ernesto Pinheiro Malère 的[LDAP Linux HOWTO](http://www.tldp.org/HOWTO/LDAP-HOWTO/)
*   在 devshed.com 上[了解 LDAP（第 1 部分）](http://www.devshed.com/c/a/Administration/Understanding-LDAP-part-1/)和[了解 LDAP（第 2 部分）](http://www.devshed.com/c/a/Administration/Understanding-LDAP-part-2/)
*   [LDAP 和 OpenLDAP（在 Linux 平台上）](http://www.uvm.edu/ets/projects/ldap/ldapv3.pdf)幻灯片

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T22:35:31.860

您是要构建新的 LDAP 服务器基础架构，还是要使用现有服务？

如果您正在构建基础架构，那么[了解和部署目录服务](https://rads.stackoverflow.com/amzn/click/com/1578700701 "了解和部署 LDAP 目录服务")长期以来一直是您要阅读的书。它清楚地解释了 LDAP 是什么，如何设计架构和目录信息树布局，以及如何选择合适的目录拓扑。

如果您尝试根据现有的 LDAP 服务对用户进行身份验证，最好阅读适合您语言的库文档。验证用户的典型过程如下所示：

1.  获取用户的用户 id 并在 LDAP 中搜索该用户以获得可区分的名称（或 DN，LDAP 树中每个条目的唯一名称）。
2.  使用检索到的 DN 和用户提供的密码“绑定”，或以该用户身份针对 LDAP 服务器进行身份验证。
3.  检查服务器的返回码以确定绑定是否成功。
4.  根据上一步的结果，允许或禁止用户。

# iphone - 在后台线程上加载视图

> ID：851824
> 
> 赞同：2
> 
> 时间：2009-05-12T08:53:57.180
> 
> 标签：iphone, cocoa, cocoa-touch

是否可以在后台线程上加载视图？

我正在使用缓冲将视图呈现到屏幕外的缓冲区中，以便稍后将它们滚动到视图中。我想让 UI 做出更多响应，这似乎是罪魁祸首的屏幕外缓冲，我想知道我是否可以在后台线程上加载缓冲视图，因为我不需要它立即可用。这样做的问题似乎是线程有自己的自动释放池，然后在线程退出时被清除。后台线程和ui线程是否可以共享内存或池？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T09:57:32.427

辅助线程应该有它自己的自动释放池。如果存在辅助线程，则应将其释放。

当您在线程之间传递数据时，发送者应该保留它，而接收者线程应该释放/自动释放它。但在大多数情况下，如果您使用属性或`performSelectorOnMainThread`例如，这是“自动”完成的。

# javascript - 显示文本区域的当前行号和列号

> ID：851825
> 
> 赞同：6
> 
> 时间：2009-05-12T08:54:03.247
> 
> 标签：javascript, prototypejs, textarea

我正在我的网络应用程序中创建一个文件编辑界面，我有一个包含文件内容的文本区域。

当 textarea 聚焦时，我想输出光标的位置，即行号和列：这很有用，因为例如错误消息通常会产生行号。

问题是：如何确定光标在 textarea 中的位置？我正在使用原型库。也许已经有解决方案了？

我对那些高级小部件提供的 textarea 的精美工具栏并不感兴趣。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-09-13T12:58:40.577

当我想要 textarea 的当前行号和 textarea 的当前列时，我这样解决：

```
<textarea  onkeyup="getLineNumberAndColumnIndex(this);" onmouseup="this.onkeyup();" >
</textarea>

function getLineNumberAndColumnIndex(textarea){
     var textLines = textarea.value.substr(0, textarea.selectionStart).split("\n");
     var currentLineNumber = textLines.length;
     var currentColumnIndex = textLines[textLines.length-1].length;
     console.log("Current Line Number "+ currentLineNumber+" Current Column Index "+currentColumnIndex );
  } 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-05-12T09:12:17.103

您可能想查看以下 2 个链接：

[http://www.dedestruct.com/2008/03/22/howto-cross-browser-cursor-position-in-textareas/](http://web.archive.org/web/20090221140237/http://www.dedestruct.com/2008/03/22/howto-cross-browser-cursor-position-in-textareas/) ^(【原源已不存在，修改后的链接指向最新版本网络档案])

[https://developer.mozilla.org/En/DOM:Selection](https://developer.mozilla.org/En/DOM:Selection)

..一旦你有一个选择（文本中的光标索引），你可以用换行符分割你的文本，从而得到行号。您可以通过从行首确定索引来获取列

# python - Django ImageField 问题

> ID：851830
> 
> 赞同：10
> 
> 时间：2009-05-12T08:55:06.880
> 
> 标签：python, django, django-models

我有一个类似的模型

```
Class Student(models.Model):
"""A simple class which holds the basic info
of a student."""

name = models.CharField(max_length=50)
age = models.PositiveIntegerField()
photo = models.ImageField(upload_to='foobar', blank=True, null=True) 
```

正如我们所见，照片字段是可选的。我希望所有将图像保存在大学数据库中的学生。为此我做了这个

```
>>> Student.objects.exclude(photo__name=None) 
```

但我收到此错误：

```
FieldError: Join on field 'photo' not permitted. 
```

那么，我怎样才能提取所有有照片的学生呢？

任何有关这方面的帮助将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-12T09:57:01.523

它不起作用，因为[字段查找](http://docs.djangoproject.com/en/dev/topics/db/queries/#field-lookups)仅适用于其他模型。这里，`name`是您的`photo`字段返回值的一个属性。

试试这个：

```
Student.objects.exclude(photo__isnull=True) 
```

最好使用`isnull`，而不是比较相等`None`。

### 编辑：

[Jeff Ober](https://stackoverflow.com/users/89182/jeff-ober)的建议：

```
Student.objects.exclude(photo='') 
```

他说过滤是对存储在数据库中的实际值执行的。在文件字段的情况下，文件的路径。

# javascript - 运行时的 Google chrome 链接样式表标签

> ID：851832
> 
> 赞同：0
> 
> 时间：2009-05-12T08:55:14.430
> 
> 标签：javascript, css, google-chrome

我在运行时添加了一个 CSS 链接标签，它适用于除 chrome 之外的所有浏览器，它只是拒绝使用 CSS，它是一个 PHP 脚本文件，其中有一个 header('Content-Type: text/css;); 已添加如下

```
var css;
css = '<link rel="stylesheet" type="text/css" href="http:/domain.com/cm.css?c=someval"/>';
$(css).appendTo("body"); 
```

如您所见，我正在使用 jQuery 附加链接。它适用于所有浏览器，IE6+、Firefox、Safari（windows），但不适用于 Chrome。有什么帮助！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T09:07:12.307

尝试将标签添加到头部：

```
$('head').append(css); 
```

# oracle - 使用 ADODB 时未捕获 Oracle 触发器错误

> ID：851837
> 
> 赞同：1
> 
> 时间：2009-05-12T08:56:27.143
> 
> 标签：oracle, triggers, adodb

我有一个使用 Adodb 在 Oracle 表（客户数据库）中插入数据的应用程序。

1.  如果没有错误，则数据插入成功。
2.  如果有任何错误，如无效数据类型等。错误由我的应用程序引发并捕获并转储到日志文件中。
3.  我的客户在这个特定的表上编写了他们自己的触发器。插入记录时，在插入数据之前会进行一些其他检查

现在一切都很好，直到现在。

但是最近我们发现很多时候数据没有插入到oracle表中。

1.  签入日志文件时未发现错误。
2.  然后我记录了执行的查询。
3.  将查询复制到 oracle Sql 提示符并执行它给出了触发器错误。

我的问题是

1.  客户尚未准备好分享触发器的详细信息。
2.  插入到 oracle 表时不会引发错误，因此我们无法记录它或采取任何行动。
3.  在 oracle 中直接执行相同的 qry 时会显示触发错误。

需要帮助

1.  为什么 ADODB 中没有引发错误
2.  我是否必须通知客户实施任何错误引发
3.  您可以为解决问题提出的任何建议

我对 Oracle 有 0% 到 10% 的知识

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-07-11T09:49:15.410

1.  您可以在日志表中记录您的业务逻辑。
2.  但是您必须使用存储过程来记录消息。
3.  存储过程应该有 pragma Transaction 以便您的日志数据必须保存在日志表中。
4.  您是触发器应该有错误处理 - 在错误处理中，您必须调用 Logged 存储过程（具有编译指示事务）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T23:02:40.927

“将查询复制到 oracle Sql 提示符并执行它给出了触发错误。” 由于 ADO 会话不报告错误，因此可能是来自触发器的错误具有误导性。它可能只是对“嘿，除非通过应用程序，否则不允许您插入此表”行进行检查。

“插入到 oracle 表时不会引发错误，因此我们无法记录它或采取任何行动。” 如果在插入时未引发错误，则可能在提交时引发错误。延迟约束和物化视图可以做到这一点。

假设地，我可以按如下方式重现您的经验： 1\. 创建一个表 tab_a 具有最初延迟的可延迟约束（例如 val_a > 10） 2\. ADO 会话插入违反约束的行但它不会出错，因为约束被延迟3\. 提交发生并且约束违反异常触发并且事务被回滚而不是被提交。

所以看看你是否在考虑提交错误的可能性。

也可能是事务后期的其他事情导致整个事务回滚（例如死锁）。会话跟踪会很好。如果失败，请查看用户的 SERVERERROR 触发器以记录错误（例如在文件中，因此不会回滚）

[http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_7004.htm#i2153530](http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_7004.htm#i2153530)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T12:29:16.620

我从未使用过 adodb （我假设这是您使用的，而不是 ADO.NET？）.. 但是，快速查看它的引用会导致这个问题.. 您实际上是在检查查询的返回状态吗？

```
$ok = $DB->Execute("update atable set aval = 0");
if (!$ok) mylogerr($DB->ErrorMsg()); 
```

# sql - 如何生成这个 sql 查询？

> ID：851839
> 
> 赞同：0
> 
> 时间：2009-05-12T08:56:51.153
> 
> 标签：sql, sql-server, sql-server-2005

“0”是VisitingCount ---数值日期部分，例如：00:00--1, 00:30--2, 01:00--2, 01:30--3

```
CREATE TABLE #Temp (VisitingCount int, [Time] int )
DECLARE @DateNow DATETIME,@i int,@Time int
set @DateNow='00:00'  
set @i=1;  
while(@i<48)  
    begin  
        set @DateNow = DATEADD(minute, 30, @DateNow)
        set @Time = (datepart(hour,@DateNow)*60+datepart(minute,@DateNow))/30 
        insert into #Temp(VisitingCount,[Time]) values(0,@Time )
        set @i=@i+1
    end

select Sum(VisitingCount), [Time]
    from #Temp group by [Time]
    Union All
         select count(page) as VisitingCount, 
       (datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time]
       from scr_SecuristLog
       where Date between '2009-05-04 10:30' and '2009-05-04 12:30'
       GROUP BY (datepart(hour,Date)*60+datepart(minute,Date))/30--scr_SecuristLog.Date 
```

我的查询返回下表

```
 0   1

0   2

..(removed repeating)..

0   45

0   46

0   47

825 23

526 21

1064    24

885 22 
```

* * *

这是我梦寐以求的桌子。我需要这个：

```
 0   1

0   2

..(removed repeating)..

0   19

0   20

526 21

885 22

825 23

1064    24

0   25

0   26

..(removed repeating)..

0   46

0   47 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-12T08:58:47.593

添加`Order By 2 desc`到您的选择

```
 select Sum(VisitingCount), [Time]
  from #Temp group by [Time]
Union All
  select count(page) as VisitingCount, 
  (datepart(hour,Date)*60+datepart(minute,Date))/30 as [Time]
  from scr_SecuristLog
  where Date between '2009-05-04 10:30' and '2009-05-04 12:30'
  GROUP BY (datepart(hour,Date)*60+datepart(minute,Date))/30--scr
order by 2 desc 
```

[请参阅UNION (Transact-SQL)](http://msdn.microsoft.com/en-us/library/ms180026.aspx)中的示例 A

# wpf - 使用 WPF，向下滚动 ListView 很快，向上滚动很慢

> ID：851840
> 
> 赞同：1
> 
> 时间：2009-05-12T08:57:37.860
> 
> 标签：wpf, listview, c#-3.0

我的 ListView 有一个奇怪的问题。此 ListView 链接到包含数千个项目的 DataSource，因此它非常大。

我的问题是向上滚动非常慢......而向下滚动是可以的。知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2011-07-22T22:16:18.600

您是否尝试过 Recycling 和 DeferredScrolling

```
 <ListBox VirtualizingStackPanel.VirtulizationMode="Recycling" ...
    <ListBox ScrollView.IsDeferredScrollingEnabled="True" ... 
```

# .net - 基于 .NET 的安装项目在安装时失败

> ID：851841
> 
> 赞同：7
> 
> 时间：2009-05-12T08:57:49.777
> 
> 标签：.net, deployment, windows-installer, installation

我使用[Visual Studio 2008](http://en.wikipedia.org/wiki/Microsoft_Visual_Studio#Visual_Studio_2008)创建了一个安装项目。在另一台机器上安装时，出现以下错误：

> 在安装 MyApplication 之前安装程序被中断。您需要重新启动安装程序才能重试。

我该如何解决这个问题？

日志文件显示以下内容。

```
MSI (s) (D8:20) [14:06:01:020]: Executing op: ComponentUnregister(ComponentId={533BAFA2-3A54-B4D7-B625-38EB0DB9BBB7},ProductKey={B10107EF-3C57-451E-9080-40FB1F4A8B95},BinaryType=0,)
MSI (s) (D8:20) [14:06:01:020]: Executing op: ComponentUnregister(ComponentId={B55DBDAF-0BCB-061A-9EA2-5AC798377ABA},ProductKey={B10107EF-3C57-451E-9080-40FB1F4A8B95},BinaryType=0,)
MSI (s) (D8:20) [14:06:01:020]: Executing op: End(Checksum=0,ProgressTotalHDWord=0,ProgressTotalLDWord=0)
MSI (s) (D8:20) [14:06:01:020]: Error in rollback skipped.  Return: 5
MSI (s) (D8:20) [14:06:01:030]: No System Restore sequence number for this installation.
MSI (s) (D8:20) [14:06:01:030]: Unlocking Server
MSI (s) (D8:20) [14:06:01:030]: PROPERTY CHANGE: Deleting UpdateStarted property. Its current value is '1'.
Action ended 14:06:01: INSTALL. Return value 3.
MSI (s) (D8:20) [14:06:01:060]: MainEngineThread is returning 1603
MSI (s) (D8:40) [14:06:01:060]: Destroying RemoteAPI object.
MSI (s) (D8:B8) [14:06:01:060]: Custom Action Manager thread ending.
MSI (c) (10:80) [14:06:01:130]: Back from server. Return value: 1603
MSI (c) (10:80) [14:06:01:140]: Decrementing counter to disable shutdown. If counter >= 0, shutdown will be denied.  Counter after decrement: -1
MSI (c) (10:80) [14:06:01:140]: PROPERTY CHANGE: Deleting SECONDSEQUENCE property. Its current value is '1'.
Action ended 14:06:01: ExecuteAction. Return value 3.
MSI (c) (10:80) [14:06:01:150]: Doing action: FatalErrorForm
Action start 14:06:01: FatalErrorForm.
DEBUG: Error 2826:  Control Line1 on dialog FatalErrorForm extends beyond the boundaries of the dialog to the right by 3 pixels
The installer has encountered an unexpected error installing this package. This may indicate a problem with this package. The error code is 2826\. The arguments are: FatalErrorForm, Line1, to the right
DEBUG: Error 2826:  Control Line2 on dialog FatalErrorForm extends beyond the boundaries of the dialog to the right by 3 pixels
The installer has encountered an unexpected error installing this package. This may indicate a problem with this package. The error code is 2826\. The arguments are: FatalErrorForm, Line2, to the right
DEBUG: Error 2826:  Control BannerBmp on dialog FatalErrorForm extends beyond the boundaries of the dialog to the right by 3 pixels
The installer has encountered an unexpected error installing this package. This may indicate a problem with this package. The error code is 2826\. The arguments are: FatalErrorForm, BannerBmp, to the right
Action ended 14:06:04: FatalErrorForm. Return value 1.
Action ended 14:06:04: INSTALL. Return value 3.
MSI (c) (10:80) [14:06:04:475]: Destroying RemoteAPI object.
MSI (c) (10:F4) [14:06:04:485]: Custom Action Manager thread ending.
=== Logging stopped: 5/12/2009  14:06:04 ===
MSI (c) (10:80) [14:06:04:495]: Note: 1: 1708 
MSI (c) (10:80) [14:06:04:505]: Product: CMS -- Installation failed.

MSI (c) (10:80) [14:06:04:515]: Grabbed execution mutex.
MSI (c) (10:80) [14:06:04:525]: Cleaning up uninstalled install packages, if any exist
MSI (c) (10:80) [14:06:04:545]: MainEngineThread is returning 1603
=== Verbose logging stopped: 5/12/2009  14:06:04 === 
```

`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-07-01T20:16:15.743

我们遇到了类似的问题，并在[MSDN 论坛上](http://social.msdn.microsoft.com/Forums/en-US/winformssetup/thread/6bead7aa-cdc5-4b3d-af0c-82f246b2a3b8)找到了一个有用的提示：

答案是安装“IIS 管理兼容性”服务器角色。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-12T09:07:47.140

尝试通过命令行安装以获取日志文件。那应该包含错误信息。

[msiexec](http://technet.microsoft.com/en-us/library/cc759262.aspx) /i 程序名 /lv mylogfile.log

您可以使用[Wilogutl](http://msdn.microsoft.com/en-us/library/aa372811(VS.85).aspx)来更轻松地分析日志文件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-05-12T09:12:13.420

Visual Studio 安装项目将为您创建两个文件：一个 MSI 文件和一个 setup.exe 引导程序。后者安装应用程序的任何先决条件，然后启动 MSI 文件。

启动 setup.exe 引导程序时，将在 %TMP% 文件夹的子文件夹中创建一个日志文件。检查此文件中的任何错误消息。

您也可以直接启动 MSI 文件并让它创建一个日志文件：

```
msiexec /i mySetup.msi /l*vx log.txt 
```

分析日志应该可以帮助您找到问题所在。如果您需要有关错误消息的任何帮助，您可以编辑您的问题并添加错误消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-26T00:08:47.877

1.  浏览到注册表中 BFE 服务的位置 (HKLM\System\CurrentControlSet\Services\BFE\Parameters\Policy)，右键单击并选择权限。
2.  在“策略权限”窗口中，单击高级 | 添加。
3.  出现“选择用户、计算机或组”框后，将“从此位置：”更改为指向本地计算机名称。
4.  更改搜索位置后，在“输入要选择的对象名称”框中输入“NT Service\BFE”，然后单击“检查名称”——这将允许您添加 BFE 帐户。
5.  为 BFE 帐户授予以下权限：

# sql - 哪些索引通过四个连接优化了这个查询？

> ID：851844
> 
> 赞同：4
> 
> 时间：2009-05-12T08:58:45.953
> 
> 标签：sql, sql-server, join, indexing

我有一个 sql 查询，其中包含四个表的内部连接，当前索引和查询结构需要 30 多秒。我想让它尽可能快；至少快于 5 秒。

我首先想到了非规范化，但[在这里](https://stackoverflow.com/questions/173726/when-and-why-are-database-joins-expensive/174047#174047)阅读，通常应该可以通过正确的索引等进行优化。在这种情况下我无法弄清楚。当前查询计划包含对最小表的索引扫描和对其中一个内部连接的“无连接谓词”警告。

*   如何优化以下速度？
*   哪些指标？
*   哪种查询结构？
*   其他考虑？

我们有以下表格（标明行数和相关字段）：

```
表名行字段
-------------------- ----- -------------- --------------------
项目类型 150 项目类型 ID、项目类型名称
员工 200 员工 ID、参考部门 ID
项目 0.2M ProjectID, RefProjectTypeID
ProjectTransaction 350 万小时、RefEmployeeID、RefProjectID、日期、类型

```

查询应该总结给定部门、日期范围等的小时数。目前我尝试：

```
SELECT E.RefDepartmentID, SUM(PTran.Hours)
FROM Employee E
JOIN ProjectTransaction PTran
    ON E.EmployeeID = PTran.RefEmployeeID
JOIN Project P
    ON PTran.RefProjectID = P.ProjectID
JOIN ProjectType PType
    ON P.RefProjectTypeID = PType.ProjectTypeID
WHERE E.RefDepartmentID = @departmentID
    AND @from <= PTran.Date AND PTran.Date <= @to
    AND PTran.Type = 0
    AND PType.ProjectTypeName NOT IN (N'1', N'2', N'3')
GROUP BY E.RefDepartmentID 
```

* * *

感谢所有快速回答。（我已经有关于“外键”的索引和`WHERE`子句中的条件。）我对查询进行了重新排序，首先有两个小表，然后是中型表，最后是大表。瞧，大约需要一秒钟：

```
SELECT E.RefDepartmentID, SUM(PTran.Hours)
FROM Employee E
JOIN ProjectType PType
    ON E.RefCustomerID = PType.RefCustomerID
JOIN Project P
    ON PType.ProjectTypeID = P.RefProjectTypeID
JOIN ProjectTransaction PTran
    ON E.EmployeeID = PTran.RefEmployeeID
    AND P.ProjectID = PTran.RefProjectID
WHERE E.RefDepartmentID = @departmentID
    AND @from <= PTran.Date AND PTran.Date <= @to
    AND PTran.Type = 0
    AND PType.ProjectTypeName NOT IN (N'1', N'2', N'3')
GROUP BY E.RefDepartmentID 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T09:02:09.007

它并不总是有效，但尝试：

1.  将连接中的表从最小的一个重新排序到最大的一个。
2.  使用子查询而不是`ProjectTransaction`表：

    JOIN (SELECT RefEmployeeID, RefProjectID 从 ProjectTransaction WHERE @from <= PTran.Date AND PTran.Date <= @to AND PTran.Type = 0) AS trans

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T09:01:45.637

确保您在外键列上有索引。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T09:08:05.033

假设`P.ProjectID`和`PType.ProjectTypeID`是`PRIMARY KEY`，创建这个索引：

```
CREATE INDEX ix_ptran_emloyee_type_date ON ProjectTransaction(RefEmployeeID, Type, Date) 
```

，并摆脱`GROUP BY`：

```
SELECT  @departmentID, SUM(PTran.Hours)
FROM    Employee E
JOIN    ProjectTransaction PTran
ON      PTran.RefEmployeeID = E.EmployeeID
JOIN    Project P
ON      P.ProjectID = PTran.RefProjectID
JOIN    ProjectType PType
ON      PType.ProjectTypeID = P.RefProjectTypeID
WHERE   E.RefDepartmentID = @departmentID
        AND PTran.Date BETWEEN @from AND @to
        AND PTran.Type = 0
        AND PType.ProjectTypeName NOT IN (N'1', N'2', N'3') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T09:10:25.123

显然，所有外键的索引。

ProjectTransaction 也是您唯一真正的大表，并且您在 Where 子句中对其进行了大量过滤。我会为您要过滤的所有列添加索引：

ProjectTransaction.Date
ProjectTransaction.Type

编辑：由于您有一个包含 350 万行的表，因此您可能要考虑的另一种优化“技术”是升级 SQL Server 上的硬件。一些额外的内存或一些额外的处理器有时可能比用于优化的开发时间更具成本效益（显然取决于开发成本和您正在进行多少优化）......例如，请参阅[硬件便宜，程序员昂贵](http://www.codinghorror.com/blog/archives/001198.html)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T09:08:11.150

你的查询计划是怎么说的？如果您在同一个表上有两个索引扫描，然后在它们的结果之间进行哈希连接（或类似），请使用来自两个索引扫描的字段创建一个复合索引 - 然后数据库可以执行单个索引查找在复合索引中。

确保您拥有最新的统计数据。提供这些时，数据库可以更好地优化。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T09:32:25.180

如果您只是询问，[数据库引擎优化顾问](http://www.exforsys.com/tutorials/sql-server-2005/sql-server-database-tuning-advisor.html)会告诉您。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T09:33:00.937

到目前为止，所有建议都是合理的，但如果您想要专家（即 SQL Server）的观点，您可能会比使用[数据库引擎优化顾问](http://msdn.microsoft.com/en-us/library/ms173494.aspx)做得更糟。即使您没有大量的真实数据，Adviser 也可以根据一小部分测试数据提出一些明智的建议。

# javascript - 使用 JavaScript 的 onclick 属性中的变量范围

> ID：851847
> 
> 赞同：0
> 
> 时间：2009-05-12T08:58:59.417
> 
> 标签：javascript, variables, prototype

我正在使用`Prototype`并尝试在循环中动态访问变量。

代码比我说得更好：

```
for (var i=0;i<5;i++) {
  $('parent' + i).insert(
    '<input type="button" value="Cancel" onclick="$('parent' + i).remove()" />',
    {position: 'after'}
  );
} 
```

问题是`i is not defined`当我单击任何`Cancel`按钮时。

如何更改变量范围，以便`i`为每个按钮保持正确的值？

我对任何变通方法都不感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T09:01:31.473

你可以这样做 -

```
for (var i = 0; i < 5; i++) {

    $('parent' + i).insert('<input type="button" value="Cancel" onclick="$(\'parent' + i + '\').remove()" />', {position: 'after'});
} 
```

它将像这样呈现 -

```
<input type="button" value="Cancel" onclick="$('parent1').remove()" />
<input type="button" value="Cancel" onclick="$('parent2').remove()" />
<input type="button" value="Cancel" onclick="$('parent3').remove()" />
... 
```

等等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-12T09:03:34.637

我认为您将`i`其放入带引号的字符串中，而不是`parent`因此它处于错误的范围级别（从概念上讲）。

```
for (var i=0;i<5;i++)
{
    $('parent' + i).insert(
      '<input type="button" value="Cancel" onclick="$(\'parent' + i +
         '\').remove()" />', {position: 'after'});
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T09:05:03.790

你不需要那个 i 变量。如果要删除该输入的父级，请执行以下操作：

```
<input type="button" value="Cancel" onclick="this.parentNode.parentNode.removeChild(this.parentNode)" /> 
```

或者如果你真的想要，你可以：

```
for (var i=0;i<5;i++) {
    $('parent' + i).insert('<input type="button" value="Cancel" onclick="$(\'parent' + i + '\').remove()" />', {position: 'after'});
} 
```

# language-agnostic - 用于构建、源代码控制和集成服务器的监控系统

> ID：851848
> 
> 赞同：1
> 
> 时间：2009-05-12T08:59:51.863
> 
> 标签：language-agnostic, monitoring

您是否知道任何轻量级系统可以根据磁盘空间、CPU 使用率、正常运行时间/可用性来监控服务器？

我主要谈论 DB、Subversion、Hudson、集成、质量保证和构建服务器。所有高级服务器监控工具都很难配置和使用。所以我正在寻找一些简单的东西。

开源工具更可取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T14:41:33.893

[纳吉奥斯](http://www.nagios.org/)非常好。超级灵活，几乎可以监控任何东西。当某些事件/警报发生时，它还可以执行工作流。它是免费的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T09:28:45.827

我们正在使用[Hostmonitor](http://www.ks-soft.net/hostmon.eng/)。
易于设置、使用且价格非常合理。

> HostMonitor 可以检查任何 TCP 服务、ping 主机、检查路由、监控 Web、FTP、邮件、DNS 服务器。它可以检查可用磁盘空间，监控文件或文件夹的大小，检查文件和网站的完整性；它测试您的 SQL 服务器、监控网络流量等等。

# ruby-on-rails - 在 Rails 中缺少请求的模板时呈现默认模板

> ID：851851
> 
> 赞同：4
> 
> 时间：2009-05-12T09:00:28.837
> 
> 标签：ruby-on-rails, render, actionview

对于一个插件，我想将以下功能破解到 Rails 中：

当（部分）模板不存在时（无论格式如何），我想呈现默认模板。

因此，假设如果 users/index.html.erb 不存在（或其他格式），我将操作称为“users/index”，则应该呈现“default/index.html.erb”。

同样，如果我调用操作“locations/edit”并且“locations/edit.html.erb”不存在，则应该呈现“default/edit.html.erb”

对于部分，如果我调用一个动作'locations/index'并且模板'locations/index.html.erb'调用不存在的部分'locations/_location'，它应该呈现'default/_object'

解决方案是 seek 让我可以访问模板变量（例如@users、@locations）和有关请求路径的信息（例如用户/索引、位置/编辑）。它也应该适用于部分。

我已经想到了一些我将在下面发布的选项。没有一个是完全令人满意的。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-05-12T09:12:10.690

解决方案2：

在 ApplicationController 中使用“rescue_from”

```
 class ApplicationController > ActionController::Base
  rescue_from ActionView::MissingTemplate do |exception|
    # use exception.path to extract the path information
    # This does not work for partials
  end
end 

```

缺点：不适用于局部。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2011-09-05T18:18:13.980

在查看 controller/template.html.erb 之后，Rails 3.1 会自动在 application/template.html.erb 中查找文件，您可以在 Exception 中看到如下所示：

```
Missing template [controller name]/index, application/index with {:locale=>[:en, :en], :formats=>[:html], :handlers=>[:erb, :coffee, :builder]}. Searched in: * "/path/to/rails_project/app/views" 
```

所以，只需将您的默认模板放在 app/views/application

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T15:53:41.987

我找到了一个相对干净的补丁，它只修补了模板的查找，这正是问题中所需要的。

```
 module ActionView
  class PathSet

    def find_template_with_exception_handling(original_template_path, format = nil, html_fallback = true)
      begin
        find_template_without_exception_handling(original_template_path, format, html_fallback)
      rescue ActionView::MissingTemplate => e
        # Do something with original_template_path, format, html_fallback
        raise e
      end
    end
    alias_method_chain :find_template, :exception_handling

  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-05-12T09:08:16.157

解决方案1：

猴子补丁 ActionView::Base#render

```
 module ActionView
  class Base
    def render_with_template_missing(*args, &block)
      # do something if template does not exist

      render_without_template_missing(*args, &block)
    end
    alias_method_chain :render, :template_missing
  end
end 
```

这个猴子补丁需要查看 Rails 的（变化的）内部结构并导致代码丑陋，但可能有效。

# iphone - 给定字体的字符串长度以适合 UITextView

> ID：851856
> 
> 赞同：6
> 
> 时间：2009-05-12T09:01:59.473
> 
> 标签：iphone, ios, cocoa-touch

我需要将用户输入的大多行文本移动`UITextView`到较小的（但仍然是多行的）`UITextView`*。如果用户输入的文本比在较小视图中显示的要多，我想截断文本，使其适合所有可见的（截断的）文本。（大`UITextView`的和小的都不应该滚动。）

最好的方法是什么？

我可以使用循环，每次将字符串缩短一个字符，然后使用`NSString`'s`sizeWithFont: constrainedToSize: lineBreakMode:`找出这个较短字符串所需的高度，然后将其与我的较小字符串中可用的高度进行比较，`UITextView`当字符串会适合 - 但这似乎很慢而且很尴尬。肯定有更好的办法。

我只想告诉目的地`UITextView`在屏幕上显示它时截断它的 displayText 成员，但我无法找到一种方法来做到这一点。

*更多背景信息，来自我在下面的评论：

我有一个风景应用程序。我根据用户选择的照片更改视图的布局。如果是风景照片，标题会更小 - 只是照片底部的一条线。如果她选择一张人像照片，那么我可以在照片的侧面有足够的空间用于标题，因此标题更大。

如果用户将她的照片方向从纵向更改为横向，那么我想截断文本，然后允许她对其进行编辑以使其有意义。我可以直接删除它，但我更愿意保留它以尽量减少她的打字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-07-08T00:35:01.873

我编写了以下递归方法和公共 API 来正确执行此操作。丑陋的软糖因素是[这个问题](https://stackoverflow.com/questions/1095545/string-length-with-given-font-to-fit-uitextview-2-the-return)的主题。

```
#define kFudgeFactor 15.0
#define kMaxFieldHeight 9999.0

// recursive method called by the main API
-(NSString*) sizeStringToFit:(NSString*)aString min:(int)aMin max:(int)aMax
{
if ((aMax-aMin) <= 1)
    {
    NSString* subString = [aString substringToIndex:aMin];
    return subString;
    }

int mean = (aMin + aMax)/2; 
NSString* subString = [aString substringToIndex:mean];

CGSize tallerSize = CGSizeMake(self.frame.size.width-kFudgeFactor,kMaxFieldHeight);
CGSize stringSize = [subString sizeWithFont:self.font constrainedToSize:tallerSize lineBreakMode:UILineBreakModeWordWrap];

if (stringSize.height <= self.frame.size.height)
    return [self sizeStringToFit:aString min:mean max:aMax]; // too small
else    
        return [self sizeStringToFit:aString min:aMin max:mean];// too big
}

-(NSString*)sizeStringToFit:(NSString*)aString
{

CGSize tallerSize = CGSizeMake(self.frame.size.width-kFudgeFactor,kMaxFieldHeight);
CGSize stringSize = [aString sizeWithFont:self.font constrainedToSize:tallerSize lineBreakMode:UILineBreakModeWordWrap];

// if it fits, just return
if (stringSize.height < self.frame.size.height)
    return aString; 

// too big - call the recursive method to size it       
NSString* smallerString = [self sizeStringToFit:aString min:0 max:[aString length]];
return smallerString;   
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-05-14T06:33:46.473

这实际上不是一个修复，但它确实为计算提供了一个良好的起点。

如果您使用 NSString `sizeWithFont: constrainedToSize: lineBreakMode:`，您将获得文本的垂直高度。如果将它除以字体的前导高度，则得到整个字符串中的行数。[NSString count] 除以该数字可以得到每行字符数的近似值。这假设字符串是同质的，并且如果有人键入（例如）'iiiiiiiiiiii...' 与“MMMMMMMMM...”相对，则该字符串将不准确。

您还可以将边界框除以相关字体的`leading`高度，以获得适合边界框的行数。

将每行的字符乘以行数为您提供了查找适合文本的起点。

您可以通过对那些“iiiiii...”和“MMMMMM...”字符串进行相同的计算来计算该图中的误差范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T14:00:21.963

我建议采取稍微不同的方法，看看是否可以使用 UILabel 而不是较小的 UITextView。

UILabel 可以通过它们的 numberOfLines 属性设置为像 UITextView 一样的多行。

UILabel 还有一个 lineBreakMode 属性，我相信该属性的默认值会产生您正在寻找的确切截断效果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-14T06:04:56.480

我认为乔纳森对 UILabel 有所了解...

因此，用户完成了 UITextView 的编辑，您将获取文本字符串并将其传递给 UILabel。您将 UITextView 的 alpha 更改为 0 和/或将其从超级视图中删除。可能将未截断的全文存储在 ivar 中。

UILabel 不是“可编辑的”，但是您可以使用 UILabel（或者它的超级视图）检测触摸。当您检测到 UILabel 上的触摸时，您只需恢复隐藏的 UITextView 并恢复您保存的字符串。

有时 SDK 很痛苦，但它几乎总能赢得战斗。很多时候，最好将您的设计调整为 UIKit 约定

# oracle - Oracle 将模式从一台服务器移动/传输到另一台服务器

> ID：851857
> 
> 赞同：0
> 
> 时间：2009-05-12T09:02:03.093
> 
> 标签：oracle

我不得不将数据库从一台服务器移动到另一台服务器。

服务器 A 上的 Oracle 已死，因此我无法备份现有数据库以移动它们。

我想知道是否有另一种方法可以在 Oracle 中跨服务器移动数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T09:43:24.413

有一种方法可以处理一些数据和控制文件并将它们安装在新服务器中。

请参阅：用户管理的备份和恢复指南 [http://download.oracle.com/docs/cd/B10501_01/server.920/a96572/toc.htm](http://download.oracle.com/docs/cd/B10501_01/server.920/a96572/toc.htm) （但要查找数据库的正确版本）

例如：

```
% cp /disk1/oracle/dbs/*.dbf /disk2/backup
% cp /disk1/oracle/dbs/*.cf /disk2/backup
% cp /disk1/oracle/network/admin/*.ora /disk2/backup
% cp /disk1/oracle/rdbms/admin/*.ora /disk2/backup

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T14:14:30.450

如果旧数据库相对干净地关闭，您应该能够将 db 文件复制到新主机。“db 文件”包括数据文件、临时文件、控制文件和在线重做日志（我想不到）。如果您可以使新主机上的目录结构与旧主机上的目录结构相同，那么您应该能够获取正确的环境（包括 ORACLE_SID），然后从 SQL*Plus 发出启动。您在回答我的问题时使用了短语“Oracle 服务”，所以我猜您使用的是 Windows - 我不知道您如何将其重新注册为 Windows 服务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-14T16:24:26.273

如果服务器是相同的操作系统，那么是的。您可以在新服务器上创建与旧服务器相同的目录结构。安装 oracle 软件并将其修补到与旧窗口服务器上相同的版本。将所有数据文件、控制文件、 spfile 等复制到新服务器上的相应位置。使用您安装 oracle 的具有管理员权限并属于 dba 组的帐户，运行 oradim 将服务添加到 windows 以启动 oracle，将其指向数据库的 spfile。

ORADIMxx -NEW -SID -INTPWD -STARTMODE -PFILE

或使用较新的数据库版本：

ORADIM-新-SID | -ASMSID [-SYSPWD 密码] [-STARTMODE auto | 手册] [-SRVCSTART 系统 | 需求] [-PFILE 文件名 | -SP文件]

# php - cron 作业会杀死最后一个 cron 执行吗？

> ID：851872
> 
> 赞同：10
> 
> 时间：2009-05-12T09:06:23.023
> 
> 标签：php, cron, scheduled-tasks

我有一个执行 PHP 脚本的 cron 作业。cron 设置为每分钟运行一次，这仅用于测试目的。它正在执行的 PHP 脚本旨在将用户上传到服务器的视频转换为 flash 格式（例如....flv）。通过命令行手动执行该脚本时，该脚本执行良好，但是通过 cron 执行时，它开始正常，但一分钟后它就停止了。

似乎在执行下一个 cron 时，它会“杀死”最后一个 cron 执行。我添加了以下 PHP 函数：

```
ignore_user_abort(true); 
```

希望它不会中止最后一次执行，我测试了将 cron 设置为每 5 分钟运行一次，效果很好，但是视频的转换可能需要 5 分钟以上，所以我需要弄清楚为什么当另一个 cron 运行时它会停止执行。

任何帮助，将不胜感激。

谢谢！

编辑：我的 cron 看起来像：

```
*/1 * * * * php /path_to_file/convert.php 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-05-12T09:29:03.440

我认为 cron 不会杀死任何进程。但是，cron 并不真正适合长时间运行的进程。这里可能发生的情况是，您的脚本在多次执行时会完全践踏自己。例如，两个 PHP 进程可能试图同时写入同一个文件。

首先，确保您不仅查看 php 错误日志，还尝试从 PHP 文件本身捕获输出。例如：

```
*/1 * * * * * php /path/to/convert.php & >> /var/log/convert.log 
```

您还可以使用简单的锁定文件来确保不会多次执行 convert.php。就像是：

```
if (file_exists('/tmp/convert.lock')) {
    exit();
}

touch('/tmp/convert.lock');
// convert here
unlink('/tmp/convert.lock'); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-05-12T09:23:31.653

`cron`它本身不会停止先前运行的作业实例，因此，如果出现问题，几乎可以肯定您的 PHP 中有一些东西在做这件事。您需要发布该代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T12:22:11.197

不，它不会。您可以通过创建脚本在每次运行时检查的锁定文件来阻止第二个进程运行。如果文件存在，则不会运行。如果合适的话，这也应该与最大执行时间一起使用，这样一个进程就不会无限期地停止未来的执行。锁定文件可以只是一个名为 /tmp/foo.lock 的空纯文本文件。

# ado - ADO SQLServer dbGo 生成 EAccessViolation

> ID：851876
> 
> 赞同：0
> 
> 时间：2009-05-12T09:07:56.673
> 
> 标签：ado, sql-server-2005-express

我有一个在单个线程中填充数据库的程序。I 对所有查询使用一个连接。这就是我将能够在事务中运行它们。

每一秒我都会得到一组新的文件，这些文件必须输入到 SQL Server 2005 Express 中。

该应用程序可以运行 24 到 36 小时，然后在查询中突然获得“EAccessViolation”。

该查询将执行至少 24 * 60 * 60 次。

我不确定它是否也发生在没有参数的查询中，因为大多数查询（90%）都有参数。它们是插入/更新或带有参数的选择。

当发生这种情况时，之后的所有查询都会得到相同的 EAccessViolation，过了一会儿我得到了 StackOverflow。

虽然代码是以这样一种方式构造的，即异常将被处理，并且下次代码应该运行没有问题。

事实上，这发生在各种查询中（与以前的版本相比没有改变），唯一的改变是我们没有使用 BCB Builder 2007 中的 dbGo，而是使用 Cpp Builder 6.0 进行了 ADO。

我认为它在 Windows 版本的 MDAC(2.8) 或 CodeGear 的 de dbGo 中有一些软件。事实上，在以前的版本（ADO BCB6.0）中我们没有遇到它，而现在（dbGO 和 BCB2007）我们有，这使得这部分非常可疑。

我希望有些人有一些不错的想法，这可能是这一切的原因。

目前我无法在桌面上重现它。我仍在尝试复制它，这将明确提供更多信息。

我愿意接受建议。

问候

合资公司。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T09:22:08.303

我会怀疑驱动程序 - 尝试使用不同的驱动程序来查看是否可以隔离问题。还尝试重写查询以使用不同的语法，也许您可​​以经常回收连接？

# jsp - 使用 JSTL 检查集合大小

> ID：851880
> 
> 赞同：241
> 
> 时间：2009-05-12T09:08:51.337
> 
> 标签：jsp, collections, jstl

如何使用 JSTL 检查集合的大小？

就像是：

```
<c:if test="${companies.size() > 0}">

</c:if> 
```

* * *

## 回答 #1

> 赞同：445
> 
> 时间：2009-05-12T09:31:12.780

```
<c:if test="${companies.size() > 0}">

</c:if> 
```

此语法仅适用于 EL 2.2 或更新版本（Servlet 3.0 / JSP 2.2 或更新版本）。如果您因为使用 JSPX 或 Facelets 而不是 JSP 而遇到 XML 解析错误，请`gt`使用`>`.

```
<c:if test="${companies.size() gt 0}">

</c:if> 
```

如果您实际上面临 EL 解析错误，那么您可能使用的是太旧的 EL 版本。然后你需要 JSTL`fn:length()`函数。从[文档中](https://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/fn/tld-summary.html)：

> **length(java.lang.Object)** - 返回集合中的项目数，或字符串中的字符数。

将其放在 JSP 页面的顶部以允许`fn`命名空间：

```
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %> 
```

或者，如果您使用的是 JSPX 或 Facelets：

```
<... xmlns:fn="http://java.sun.com/jsp/jstl/functions"> 
```

并在您的页面中使用这样的：

```
<p>The length of the companies collection is: ${fn:length(companies)}</p> 
```

所以要测试一个集合的长度：

```
<c:if test="${fn:length(companies) gt 0}">

</c:if> 
```

或者，对于这种特定情况，您也可以简单地使用 EL`empty`运算符：

```
<c:if test="${not empty companies}">

</c:if> 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-06-12T10:38:16.177

正如@Joel 和@Mark Chorley 在之前的评论中所建议的：

```
${empty companies} 
```

这将检查 null 和空列表/集合/数组。它不会让你得到长度，但它满足 OP 中的示例。如果你能侥幸成功，这比导入标签库及其硬朗的语法（如`gt`.

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-04-29T13:54:24.200

你可以这样使用

```
${fn:length(numList)} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2014-03-21T07:03:29.397

用于`${fn:length(companies) > 0}`检查尺寸。这将返回一个布尔值

# c++-cli - 如何在托管代码中的 c++ cli 中使用 foreach

> ID：851881
> 
> 赞同：20
> 
> 时间：2009-05-12T09:09:00.803
> 
> 标签：c++-cli

嗨，如何使用 vs2003 在托管代码 c++ 中使用 foreach 循环。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-05-12T09:15:06.193

我从未使用过它，但[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms177202(VS.80).aspx)表明一般语法只是：

```
for each(Type t in IEnumerable)
{

} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2011-04-19T22:13:04.083

Matthew 大部分是正确的，但这里有一个工作代码块；

```
///////
array<Type^>^ iterate_me = gcnew array<Type^>(2);
iterate_me[0] = Type::GetType("Type");
iterate_me[1] = Type::GetType("System.Int32");
///////

for each(Type^ t in iterate_me)
    Console::WriteLine(t); 
```

更改是 Type 是一个引用类，因此您使用“Type^”而不是“Type”，并且您需要一个实际的对象引用 (iterate_me)...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T09:20:21.050

就像是：

```
String ^ MyString = gcnew String("abcd");

for each ( Char c in MyString )

    Console::Write(c); 
```

* * *

## 回答 #4

> 赞同：-9
> 
> 时间：2009-05-12T09:11:31.767

我不认为 VC++ 有 foreach

# android - 构建Android UI的简单方法？

> ID：851882
> 
> 赞同：82
> 
> 时间：2009-05-12T09:09:02.630
> 
> 标签：android, user-interface

是否有工具或网站可以帮助我使用拖放为 Android 应用程序创建 UI？

我找到[了这个网站](http://www.droiddraw.org/)，但想知道是否有更稳定的工具或网站来解决这个问题？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2011-12-08T21:44:59.837

请允许我在这个话题上加入一点现实。没有用于 Android 的良好 GUI 工具。如果您来自像 Delphi 这样的原生应用程序 GUI 环境，您将会对 ADK 编辑器和 DroidDraw 的用户体验感到非常失望。我已经尝试过几次以高效的方式使用 DroidDraw，但我总是重新手动滚动 XML。

ADK 是一个很好的起点，但它并不容易使用。在布局中定位组件是一场噩梦。DroidDraw 看起来很棒，但我什至无法用它打开现有的功能性 XML 布局。它以某种方式丢失了一半的布局，并且无法提取我为按钮、背景等指定的图像。

严峻的现实是，Android 开发人员领域迫切需要一种灵活、易于使用、功能强大的 GUI 开发工具，类似于用于 .NET 和 Delphi 开发的工具。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2009-05-12T22:23:37.573

Eclipse 的 Android 开发工具 (ADT) 插件包括一个用于 android 应用程序布局文件的可视化编辑器：

[http://developer.android.com/tools/help/adt.html](http://developer.android.com/tools/help/adt.html)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-09-02T19:25:04.153

最简单的方法是使用 REBOL 3：

[http://rebolforum.com/index.cgi?f=printtopic&permalink=Nick25-Aug-2013/10:08:38-7:00&archiveflag=new](http://rebolforum.com/index.cgi?f=printtopic&permalink=Nick25-Aug-2013/10:08:38-7:00&archiveflag=new)

这里有 10 个功能齐全的演示程序，带有 GUI。它们在 Android*和*桌面操作系统上运行，使用完全相同的代码：

```
REBOL []
load-gui
view [text "Hello World!"]

REBOL [title: "Tiny Note Editor"]
do %r3-gui.r3  ; download this file manually or just use load-gui as above
view [
    a1: area
    button "Save" on-action [write %notes.txt get-face a1]
    button "Load" on-action [set-face a1 to-string read %notes.txt]
]

REBOL [title: "Data Entry to CSV File"]
do %r3-gui.r3
view [
    text "First Name:"
    f1: field
    text "Last Name:"
    f2: field
    button "Submit" on-action [
        write/append %cntcts.txt rejoin [
            mold get-face f1 " " mold get-face f2 newline
        ]
        request "" "Saved"
    ]
    a1: area
    button "Load" on-action [set-face a1 to-string read %cntcts.txt]
]

REBOL [title: "Text File Reader (How to use a text list file selector)"]
do %r3-gui.r3
view [
    a1: area
    button "Load" on-action [
        files: read %./
        view/modal [
            text "File Name:"
            t2: text-list files on-action [
                set-face a1 to-string read(to-file pick files get-face t2)
                unview
            ]
        ]
    ]
]

REBOL [title: "List-View (Grid) Example"]
do %r3-gui.r3
view [
    text-table ["1" 200 "2" 100 "3"][
        ["asdf" "a" "4"]
        ["sdfg" "b" "3"]
        ["dfgh" "c" "2"]
        ["fghj" "d" "1"]
    ] 
]

REBOL [title: "Calculator"]
do %r3-gui.r3
stylize [
    btn: button [
        facets: [init-size: 50x50]
        actors: [on-action:[set-face f join get-face f get-face face]]
    ]
]
view [
    hgroup [
        f: field return
        btn "1"  btn "2"  btn "3"  btn " + "  return
        btn "4"  btn "5"  btn "6"  btn " - "  return
        btn "7"  btn "8"  btn "9"  btn " * "  return
        btn "0"  btn "."  btn " / "   btn "=" on-action [
            attempt [set-face f form do get-face f]
        ]
    ]
]

REBOL [title: "Sliding Tile Puzzle"]
do %r3-gui.r3
stylize [
    p: button [
        facets: [init-size: 60x60  max-size: 60x60]
        actors: [
            on-action: [
                t: face/gob/offset
                face/gob/offset: x/gob/offset
                x/gob/offset: t
            ]
        ]
    ]
]
view/options [
    hgroup [ 
        p "8"   p "7"   p "6"   return
        p "5"   p "4"   p "3"   return
        p "2"   p "1"   x: box 60x60 white
    ]
] [bg-color: white]

REBOL [title: "Math Test"]
do %r3-gui.r3
random/seed now
x: does [rejoin [random 10 " + " random 20]]
view [
    f1: field (x)
    text "Answer:"
    f2: field on-action [
        either (get-face f2) = (form do get-face f1) [
            request "Yes!" "Yes!"][request "No!" "No!"
        ]
        set-face f1 x
        set-face f2 ""
        focus f2
    ]
]

REBOL [title: "Minimal Cash Register"]
do %r3-gui.r3
stylize [fld: field [init-size: 80]]   
view [
    hgroup [
        text "Cashier:"   cashier: fld 
        text "Item:"      item: fld 
        text "Price:"     price: fld on-action [
            if error? try [to-money get-face price] [
                request "Error" "Price error" 
                return none
            ]
            set-face a rejoin [
                get-face a mold get-face item tab get-face price newline
            ]
            set-face item copy "" set-face price copy ""
            sum: 0
            foreach [item price] load get-face a [
                sum: sum + to-money price
            ]
            set-face subtotal form sum
            set-face tax form sum * .06
            set-face total form sum * 1.06 
            focus item
        ]
        return
        a: area 600x300
        return
        text "Subtotal:"   subtotal: fld 
        text "Tax:"        tax: fld 
        text "Total:"      total: fld
        button "Save" on-action [
            items: replace/all (mold load get-face a) newline " "
            write/append %sales.txt rejoin [
                items newline get-face cashier newline now/date newline
            ]
            set-face item copy "" set-face price copy "" 
            set-face a copy ""    set-face subtotal copy ""
            set-face tax copy "" set-face total copy ""
        ]
    ]
]

REBOL [title: "Requestors"]
do %r3-gui.r3
x: request/ask "Question" "Do you like this?."
either x = false [print "No!"] [print "Yes!"]
x: request/custom "" "Do you like this?" ["Yay" "Boo"]
either x = false [print "Boo!"] [print "Yay!"]
view [button "Click me" on-action[request "Ok" "You clicked the button."]] 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2010-06-27T13:30:11.013

[DroidDraw](http://www.droiddraw.org/)似乎非常有用。它有一个干净和简单的界面，它是一个免费软件。适用于 Windows、Linux 和 Mac OS X。我建议捐赠。

如果你不喜欢它，你应该看看[这个网站](http://speckyboy.mobify.me/2010/05/10/android-app-developers-gui-kits-icons-fonts-and-tools/)。还有一些其他选项和其他有用的工具。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-05-01T11:22:42.993

你也可以试试[这个](https://github.com/bitstars/SimpleUi)。如果您喜欢模型视图控制器概念和快速原型设计，那么我会说您会喜欢它背后的想法；）

[SimpleUi ( https://github.com/bitstars/SimpleUi )](https://github.com/bitstars/SimpleUi)

生成的用户界面（代码如下）：

![在此处输入图像描述](https://i.stack.imgur.com/abiLt.png)

[创建此 Android UI 的完整代码](https://github.com/bitstars/SimpleUi/blob/master/SimpleUiExamples/src/de/rwth/StartExampleUi.java)：

![在此处输入图像描述](https://i.stack.imgur.com/WG4oS.png)

我在实际应用程序中使用它，不仅用于快速原型设计或对话，而且多年来经过良好测试。该概念基于模型视图控制原理，对于大多数常见场景，有现成的组件可以在任何设备上自动看起来正确。我并不是说它应该用于任何 UI（例如，列表视图应该手动完成），但对于大多数用例来说，这应该非常方便；）哦，如果你愿意，可以随意分叉并进一步改进它

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-05-15T12:22:32.320

Droiddraw 不错。我一直在使用它很久，还没有遇到任何问题（虽然它有时会崩溃，但没关系）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-02-11T14:42:00.970

[https://play.google.com/store/apps/details?id=com.mycompany.easyGUI](https://play.google.com/store/apps/details?id=com.mycompany.easyGUI)试试这个工具，它不是免费的，但提供了在手机上创建 android ui 的简单方法

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-11-07T03:28:10.500

这看起来像是一个更有前途的解决方案：IntelliJ Android UI Designer。

[http://blogs.jetbrains.com/idea/2012/06/android-ui-designer-coming-in-intellij-idea-12/](http://blogs.jetbrains.com/idea/2012/06/android-ui-designer-coming-in-intellij-idea-12/)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2013-04-01T18:51:59.270

这是一个古老的问题，不幸的是，即使是几年后也没有一个好的解决方案。我刚刚将一个应用程序从 iOS (Obj C) 移植到 Android。最大的问题不是后端代码（对于许多/大多数人来说，如果你可以用 Obj C 编码，你就可以用 Java 编码）而是移植本机接口。Todd 上面所说的，UI 布局仍然是一个完整的痛苦。以我的经验，开发支持多种格式等的可靠 UI 的最快方法是使用良好的 HTML。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2012-04-09T00:51:02.083

[http://www.appinventor.mit.edu/](http://www.appinventor.mit.edu/)

> 创建 App Inventor 应用程序从您的浏览器开始，您可以在其中设计应用程序的外观。然后，就像拼图一样，设置应用程序的行为。一直以来，通过您的计算机和手机之间的实时连接，您的应用程序会出现在您的手机上。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-04-09T00:45:51.083

并不是说这是最好的方法，但有选择是件好事。[Necessitas](http://labs.qt.nokia.com/2011/02/28/necessitas/)是一个将 Qt 移植到 android 的项目。它仍处于早期阶段并且缺乏完整的功能，但对于那些了解 Qt 并且不想为 Android UI 缺乏好的工具而烦恼的人来说，至少考虑使用它是明智的。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-12-07T16:37:55.840

我发现将[http://pencil.evolus.vn/](http://pencil.evolus.vn/)与[http://code.google.com/p/android-ui-utils/](http://code.google.com/p/android-ui-utils/)项目中的铅笔模板一起使用效果非常好。使用非常简单，很容易模拟复杂的设计

# architecture - 您如何描述您的解决方案/系统？

> ID：851884
> 
> 赞同：16
> 
> 时间：2009-05-12T09:09:19.370
> 
> 标签：architecture

我即将编写一些项目经理、开发人员和业务分析师会使用的标准/指南和模板。目标是更好地理解正在开发或已经开发的解决方案。

其中一部分是提供有关记录解决方案的标准/指南。例如，记录解决/满足业务案例/用户需求的软件。

现在，作为一名程序员，我可以看到不可能规定并说“每个解决方案都必须使用 Y 定义 X 并根据 Z 呈现它。”，因为 XYZ 并不总是适用等。

然而，我知道，即使对于我的爱好项目，我总是以一种或另一种方式描述我的解决方案，模块/组件、源代码注释、API、数据库模型、使用的一些分类法、日志日志、xml 格式等。

因此，为了继续我的工作，如果您能分享您记录的内容以描述您的解决方案（最好还有如何以及为什么），我将不胜感激 - 我知道它会因许多事情而有很大差异，但任何一般或具体答案很有趣。谢谢。

**更新** 不清楚，但我不是指 XY Z 的用户需求。我指的是系统可能拥有的所有可能类型的文档。因此，将其解读为“不可能说明每个解决方案都必须具备：所需框架列表；服务器软件的操作手册；所需的主数据；用户需求与测试的矩阵；用户界面规范。虽然产生这样一个有限的一组需求，很难清晰和准确，因为最重要/相关的内容因项目而异。

另外，我很久以前就问过这个问题，但从未接受过答案，对此感到抱歉。也许，既然这是一个悬而未决的问题，那么作为社区 wiki 会更好吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T13:33:03.280

如果您的这个项目将享受任何形式的长寿，您可能想要开始考虑使用一些行业一致的方法。最后，您可能会花费更多时间，并可能最终得到相同的最终结果。

它还取决于您所讨论的文档级别：有关基于应用程序的架构指南，请查看[Microsoft 应用程序架构指南 2.0](http://www.codeplex.com/AppArchGuide)（最近发布）。

如果它低于此级别，请从[SandCastle](http://msdn.microsoft.com/en-us/vstudio/bb608422.aspx)之类的东西开始，然后在逻辑上扩展它产生的内容。

就个人而言，我喜欢从交互图开始，简单地展示系统的所有组件如何相互交互，然后将每个组件分解为类。将类分解为序列图，并继续进行，直到您到达方法级别的状态图或对您的项目有意义的程度。

如果您需要更高级别，请查看我之前的帖子：[企业、系统和应用程序架构（最佳实践）](https://stackoverflow.com/questions/755540/enterprise-systems-and-application-architecture-best-practise/760643#760643)

归根结底，只要它对阅读它的人来说合乎逻辑，并且它是有用的（而不是你必须交付并且永远不会再次使用的东西），你就做得对了。

更大的问题通常是使文档保持最新。这将很快将您带到流程和程序创建/改进任务。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T09:21:11.597

文档始终是任何项目中最棘手的部分。如果您想重新开始，那么您可能需要查看[Domain Driven Design](http://domaindrivendesign.org/resources/what_is_ddd)。

如果您有正确的模板，使用故事模板会非常有益。

**作为**[X]
**我想要**[Y]
**以便**[Z]

以类似的方式，您可能想查看[用例](http://en.wikipedia.org/wiki/Use_case)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T09:34:29.407

使用当前域的单词。如果有一个常用的业务领域词，那么在文档和代码中一致地使用相同的词。如果有一个常用的编程术语（例如众所周知的设计模式），请在编写代码和记录技术细节时使用它。

为了记录程序如何工作，作为用户界面设计的一部分，我制作了图片序列（在纸上或 powerpoint 上），显示用户将如何使用用户界面执行他们的任务。这是每个人都能理解的通用语言，从用户到客户，从经理到程序员。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-05-14T10:55:04.427

基本上有很多方法可以为项目做文档。我过去使用的 2 种方法是 1) 用例驱动开发，以及 2) 测试驱动开发。由于我只使用过一次测试驱动开发，因此我建议如何使用用例驱动开发。

这里的关键是彻底使用 UML 表示法。用户、业务分析师和开发人员（显然）讲不同的语言，而您尝试做的是使您的文档有意义。有 3 个基本文件是关键。

1.  业务规范 - 本文档由用户制作，无需任何干扰或与开发团队协商。为什么？因为这个文档需要纯粹捕捉用户需要的东西。例如，用户想要一个程序来煮咖啡。现在用户的咖啡机必须手动打开。用户的大脑在早上需要时间来运行所有的气缸。

2.  软件需求规范 - 这是分析师将用户需求分解为功能规范的地方。分析师根据用户的需求创建流程。这是您开始使用 UML 的地方。从用例和活动图开始，了解系统的感受。获取其他衍生规范，如安全要求和其他需求，如基础设施约束。

3.  软件设计描述 - 这是架构或解决方案设计者为设计解决方案以满足需求而生成的技术文档。架构师分解功能规范并将流程转换为技术规范。每个用例都可以分解为序列图和通信图。你可以用这些图做的是开始为类创建函数。这些图可用于开发类图。您可能知道状态机分解类图，但我通常不会走那么远。您还可以使用组件结构记录整个架构并在本文档中分解其组件。该文档还可以包括系统将要放入的部署基础设施。

一起使用这 3 个文档可以帮助读者更好地了解系统中的工作原理。程序员可以了解技术规范的来源，以及它们最终需要如何发挥作用。如果您无法使程序员能够理解技术规范以制作正确的功能，那么不妨告诉他们最终需要如何运作。

为了与来自不同级别的团队成员（例如，用户、经理、业务分析师、解决方案架构师和程序员）进行协调，我创建了一个矩阵，将业务规范、功能规范、技术/设计规范连接起来。该矩阵还将包括将与要测试的元素相协调的测试模块。在实施 V-Model 开发方法时，该矩阵非常有价值。

矩阵示例：“业务需求 A”->“功能规格 A”和“功能规格 B”“功能规格 A”->“组件 A”、“组件 B”和“组件 C”“组件 B”->“ A级”和“B级”

当然，这在电子表格上总是看起来更好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T09:23:03.230

不幸的是很少！

但是，如果您的指南是针对经理和开发人员的，那么您使用的语言与您呈现它的方式一样重要。避免使用流行语和营销术语，（[这是一个很好的清单！](http://news.bbc.co.uk/2/hi/uk_news/politics/7949077.stm "英国广播公司文章")）

我个人发现图表和绘图有助于强化想法，预期用户与系统交互的流程图可能有助于更好地展示系统*应*该做什么。（当然还要深入分析系统是如何实现这一目标的！）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-05-14T05:37:41.460

为了扩展您的项目的范围，您最好使用领域词进行交流。对于需求发现，[原型工具](https://stackoverflow.com/questions/112803/what-is-the-best-web-prototyping-tool)可用于快速构建 UI，以确保充分理解需求。如果您的目的是找到记录解决方案的最佳方式，我认为它确实与[解决方案架构](http://msdn.microsoft.com/en-us/library/bb447671.aspx)有关。此外，我认为[IEEE 1471](http://www.iso-architecture.org/ieee-1471/)标准为记录软件架构提供了一种整体方法。还要查看[观点和观点](http://www.viewpoints-and-perspectives.info/)方法。当然，您可以使用您喜欢的 UML 工具来完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T09:34:55.990

也许是因为我刚读过它，它仍然在我脑海中嗡嗡作响，但我认为值得一读[37signals Getting Real](http://gettingreal.37signals.com/)。虽然它是关于启动一个项目，但我（作为一名程序员）对文档的处理方法非常满意。这并不符合每个人的口味，但如果其他人都支持这种方法，那么它甚至可能使文档变得令人愉快。我是这样发现的。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T13:09:34.160

以下是我在描述解决方案时我认为有意义的事情的清单。我把它做成了一个wiki，所以请加入并挑战和添加。

1.  数据存储库（数据存储在哪里？如何访问？）
2.  数据格式（使用哪些格式？是否有新引入？规范）大小增长？
3.  配置（可以配置什么，默认什么）
4.  库/框架/包依赖项（供应商、许可证、版本）
5.  构建解决方案（如何获取所有文件等并逐步构建）
6.  模块（定义范围/为什么引入模块）
7.  类/源代码文档（由 Doxygen 或同等工具生成）

还感兴趣： 1\. 安全性（解决方案的哪个区域处于安全状态，密码/加密等） 2\. 数据传输（磁盘/网络之间传输什么？通过哪些变量执行

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-05-20T14:08:21.813

TOGAF（开放组架构框架）定义了架构师应该如何定义解决方案的“方法”。TOGAF 的一部分还涉及定义作为架构项目的一部分应该产生哪些输入和输出。

但是，对于您需要哪些文档在不同的人（BA、程序员、测试人员、经理等）之间共享的问题，您应该查看 TOGAF 中的视图和视点。你提到的所有这些人都是你的利益相关者，观点和观点解决了利益相关者的担忧。因此，我鼓励您尝试一下 Views 和 ViewPoints。

# c# - MSMQ：无法检索某些消息

> ID：851885
> 
> 赞同：0
> 
> 时间：2009-05-12T09:10:02.177
> 
> 标签：c#, wcf, msmq

我昨天在使用 MSMQ 时遇到了一个问题，我想知道它的原因。

我有一个向 MSMQ 发送消息的服务器，以及一个使用这些消息的客户端。昨天，客户端停止检索一种类型的消息，但能够检索之后发送的另一种类型的消息。我已经阅读了一些关于毒药消息的东西，但是这种行为不适合我所看到的任何描述的情况，因为如果是这种情况，客户端不应该能够检索在毒药消息之后到达的消息. 在我手动清理消息队列后问题就消失了。

我还检查了 svc 日志，没有异常。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-06-05T19:22:53.183

是否有可能另一个客户端应用程序或服务正在使用您不期望的“MessageFormatter”提供消息？

# php - 在服务器端处理 Web 请求

> ID：851896
> 
> 赞同：1
> 
> 时间：2009-05-12T09:13:21.890
> 
> 标签：php, apache, http

**情况：**用户点击链接，服务器获取请求并开始处理。同时，用户点击另一个链接，服务器在处理第一个链接时获取新请求。发生什么了？在客户端，我们只看到来自第二个请求的网页，但是当接收到第二个请求时，来自第一个请求的进程是否在服务器上被杀死？它是由服务器管理还是由语言（Apache 或 PHP）管理？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-05-12T09:17:08.403

依靠。如果浏览器没有断开与服务器的连接，它绝对不知道客户端已经导航到其他地方。如果它确实断开了连接，则由 Web 服务器来选择检测它并中止处理线程。

无论哪种情况，这都是 HTTP 无状态的本质。在这方面你不应该依赖任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T09:18:10.540

两个请求都得到服务（如果浏览器确实发送了第二个请求）。

您只会看到第二页，但如果您查看 access_log，您肯定会注意到两个请求。

这就是 HTTP 的工作原理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T09:31:45.573

您可以使用[`ignore_user_abort()`](http://www.php.net/ignore_user_abort)来告诉脚本在连接终止后继续（或不继续）。

# php - 另一个表中的用户选项：检查选项是否存在的最佳做法是什么？

> ID：851900
> 
> 赞同：0
> 
> 时间：2009-05-12T09:14:51.310
> 
> 标签：php, mysql

我有几个用户可以选择的选项，主要是为了验证他在站点周围的存在。

表格是这样的：

用户：

```
id=1
username=stackoverflow
password=oSKAJMMS;
address=xyz
... 
```

选项：

```
user_id=1
option=AD3 
```

* * *

```
user_id=1
option=AC1 
```

在某些时候，我需要检查他在“选项”表中是否有特定选项（如：AD3、AC1 等），注意没有选项的用户根本不存在于“选项”表中。

对此的最佳做法是什么？我虽然关于 JOIN 但每次阅读 stackoverflow 时都会发现更简单有效的方法，所以我问你我该怎么办！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T09:17:02.400

```
SELECT  *
FROM    users u
WHERE   EXISTS (
        SELECT  1
        FROM    options o
        WHERE   o.user_id = u.id
                AND o.option = 'AC1'
        ) 
```

确保你有一个索引`options (user_id, option)`

# javascript - 如何在 JavaScript 中处理 cookie？

> ID：851905
> 
> 赞同：1
> 
> 时间：2009-05-12T09:17:56.110
> 
> 标签：javascript, cookies

> **可能重复：**
> [使用 JavaScript 获取和设置单个 cookie 值的“最佳”方式是什么](https://stackoverflow.com/questions/260749/what-is-the-best-way-to-get-and-set-a-single-cookie-value-using-javascript)

我正在做一个项目，它需要检查 cookie 并判断它是否存在 20 分钟。所以我写了一次这样的代码。这只是我粘贴的javascript代码。

```
function checkcookie()
{
    var difftime= getcookie();
    // further operation comes here
}

var cookieminutes;

function getcookie()
{
    var start = document.cookie.indexOf("expires");
    var cookiedate;

    if(start==-1)
    {
        cookiedate = new Date();
        document.write("Start equal to -1");
        document.cookie="expires="+cookiedate+",path=0,domain=0";
        cookieminutes= cookiedate.getMinutes();
    }
    else
    {
        document.write("Start not equal to -1");

        var date =  new Date();
        var minutes = date.getMinutes();

        document.write("The difference is "+minutes);
        document.write("<br />Cookie minutes is "+cookieminutes);
        return (minutes-cookieminutes);

    }
} 
```

在函数 getcookie 中，变量 cookieminutes 未定义。但据我所知，因为它是一个全局变量，它应该具有值。

任何人都可以请告诉这是什么解决方案。？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T10:05:33.303

您只是在 if 语句的顶部设置 cookieminutes 的值，因此 else 部分中的任何引用都将为空。

尝试这个：

```
function getcookie()
{
    var start = document.cookie.indexOf("expires");
    var cookiedate;

    cookiedate = new Date();
    cookieminutes = cookiedate.getMinutes();

    if(start==-1)
    {    
        document.write("Start equal to -1");
        document.cookie="expires="+cookiedate+",path=0,domain=0";    
    }
    else
    {
        document.write("Start not equal to -1");

        var date =  new Date();
        var minutes = date.getMinutes();

        document.write("The difference is "+minutes);
        document.write("<br />Cookie minutes is "+cookieminutes);
        return (minutes-cookieminutes);

    }
} 
```

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2009-05-12T09:24:19.483

如果您想使用全局变量（通常是糟糕的设计），请使用 window.set 设置并显式访问它们。例如：

```
window.cookieminutes = cookiedate.getMinutes(); 
```

然后：

```
document.write("Cookie minutes is "+window.cookieminutes); 
```

并放下`var cookieminutes;`

正如我在评论中所说，看起来如果在给定页面加载时第一次调用 getcookie，并且 cookie 存在（开始！= -1），cookieminutes 永远不会设置。您需要确保不使用未定义的变量。

# sql - 关系表的最佳索引策略是什么？

> ID：851908
> 
> 赞同：11
> 
> 时间：2009-05-12T09:20:02.207
> 
> 标签：sql, database-design, indexing

关系表是表示多对多 (m:n) 关系的常用解决方案。

在最简单的形式中，它将引用两个相关表的外键组合成一个新的复合主键：

```
A ATO B B
---- ---- ----
*id *援助 *id
数据 *投标数据

```

应该如何对其进行索引以在每种 JOIN 情况下提供最佳性能？

1.  ( ) 上的聚集索引（`Aid ASC, Bid ASC`我猜这无论如何都是强制性的）
2.  `Bid ASC, Aid ASC`选项 #1 加上 ( )上的附加索引
3.  `Bid ASC`或选项 #1 加上 ( )上的附加索引
4.  还有其他选择吗？供应商特定的东西，也许？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-05-12T09:24:17.597

我做了一些测试，这里是**更新：**

要涵盖所有可能的情况，您需要具备：

```
CLUSTERED INDEX (a, b)
INDEX (b) 
```

这将涵盖所有`JOIN`情况和`ORDER BY`

请注意，索引`B`实际上是排序的，`(B, A)`因为它引用了聚集的行。

只要您的`a`和`b`表`PRIMARY KEY`在 id 上有 '，您**就**不需要创建额外的索引来处理`ORDER BY ASC, DESC`.

有关详细信息，请参阅我的博客中的条目：

*   [**索引链接表**](http://explainextended.com/2009/05/12/indexing-a-link-table)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T09:24:13.057

我猜解决方案 2 是最佳的。我会通过查看值并期望哪个具有更多不同的行来选择聚集索引的顺序。那一个先。在父表上拥有`unique`或索引也很重要。`primary key`

根据 DBMS，数字 3 可能与数字 2 一样好。它可能足够聪明，也可能不够聪明，可以考虑非聚集索引中的值（聚集索引的键），而不是参考实际行。如果它可以使用它，那么3号会更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T10:01:46.430

我通过检查 SQL Server 2005 中的执行计划进行了一些快速而肮脏的测试。这些计划表明，对于大多数查询，SQL 使用 Aid,Bid 上的聚集索引。在 Bid (ASC) 上添加索引表明它用于查询类型

```
select * from A
    inner join AtoB on Aid = A.id
    inner join B on Bid = B.id
where Bid = 1 
```

所以我投票支持解决方案#3。

# c# - WPF Listbox 在 SelectedItem 之后显示下一个元素

> ID：851912
> 
> 赞同：1
> 
> 时间：2009-05-12T09:21:30.830
> 
> 标签：c#, .net, wpf, listbox, listboxitem

我有带有一堆元素的 TextBox 和 ListBox 。

TextBox 具有 KeyDown 事件处理程序，其背后的想法是允许用户在焦点位于 TextBox 时按上下键在 ListBox 内滚动。

当用户多次按下“向下键”时，所选元素将成为屏幕上最后一个可见元素。如果用户已到达屏幕上可见列表元素的底部，我希望他也能看到所选元素之后的下一个元素。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-05-12T09:24:34.070

查看列表框上的[ScrollIntoView](http://msdn.microsoft.com/en-us/library/system.windows.controls.listbox.scrollintoview.aspx)方法。您可以使用它来确保所选元素的下一个元素始终可见。

在向下箭头按下：

```
if (listbox.SelectedIndex < listbox.Items.Count - 1)
    listbox.ScrollIntoView(listbox.Items[listbox.SelectedIndex + 1]); 
```

在向上箭头按下：

```
if (listbox.SelectedIndex > 0)
    listbox.ScrollIntoView(listbox.Items[listbox.SelectedIndex - 1]); 
```

# algorithm - *nix 上的 c4.5 算法实现

> ID：851913
> 
> 赞同：3
> 
> 时间：2009-05-12T09:21:55.887
> 
> 标签：algorithm, unix, implementation

我正在尝试在我的 mac os 机器上编译和执行[c4.5 算法](http://www2.cs.uregina.ca/~dbd/cs831/notes/ml/dtrees/c4.5/tutorial.html)（也有一台 red hat enterprise linux 4.6 机器），但无法在任何地方使用相同的机器。

有没有人尝试过这个并成功地在他们的机器上编译和执行？如果是这样，请你能分享一下步骤吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-05-24T11:21:46.297

要编译它，请添加

```
#define cfree    free 
```

进入 R8/Src/defns.i 并将 R8/Src/average.c 的第 51 行更改为

```
if ( i != Numbers ) exit(1); 
```

（即将 1 传递给退出命令）。除此之外，请遵循网站说明（即打开终端，使用 tar xvzf 解压缩，键入“cd R8/Src; make all”进行编译）。

如果这没有帮助，请发布有关问题所在的更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T11:49:49.390

您可能想使用[Weka](http://www.cs.waikato.ac.nz/ml/weka/)，它是一个数据挖掘工具，它包含 C4.5（在 Weka 的命名中也称为 J48）。它是用 Java 编写的，应该可以在任何最近的 JVM 上运行。

我知道它并不能真正回答你的问题，但我自己运行 C4.5 很困难，通过 weka 使用它要容易*得多*

# xml - Web 服务速度问题 - 是浏览器吗？

> ID：851915
> 
> 赞同：0
> 
> 时间：2009-05-12T09:22:24.840
> 
> 标签：xml, web-services, browser

我有一个返回 XML 的旧版 CGI Web 服务。我已经添加了日志记录来为服务中的各种方法调用添加时间戳，并在几秒钟内完成。

但是，由于返回的 XML 量很大，浏览器需要大约 15 秒才能显示它。

我明白发生了什么，但其他人不明白。是否有一些工具/插件可以用来显示速度问题所在，并且它不在 WebService 中？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-05-12T09:27:23.223

证明浏览器问题的一个简单解决方案是不使用浏览器并显示它确实在 2 秒内完成 - 使用 wget 或类似的东西。您甚至可以创建一个指向该服务的链接并右键单击 -> 将目标另存为。无论哪种方式，您都将渲染排除在等式之外。

或者，Firefox 的 YSlow 插件将在加载中标记不同的点，尽管我不确定这是否适用于 XML 文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T09:28:15.953

使用[Fiddler](http://www.fiddler2.com/fiddler2/)显示“性能统计”选项卡上的服务器响应时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-12T09:32:30.360

您可以尝试使用firefox的[firebug](http://getfirebug.com/net.html)网络窗格来显示/测量加载页面的速度。或者正如格雷格所说，只需使用 wget。

# c - Vim 中的紧凑型 C 折叠

> ID：851916
> 
> 赞同：3
> 
> 时间：2009-05-12T09:22:47.523
> 
> 标签：c, vim, folding

我正在尝试制作一个简单的 Vim 脚本，该脚本将为 c 文件创建非常紧凑的顶级折叠。理想情况下，如果它在此代码上运行：

```
static void funca(...)
{
   ... 
}

/* Example comment */
static void funcb(...)
{
   ... 
} 
```

然后它会创建折叠，关闭时看起来像这样：

```
+-- x Lines: static void funca(...)----------------------
+-- x Lines: static void funcb(...)---------------------- 
```

所以基本上它就像 foldmethod=syntax with foldlevel=1，除了每个折叠会开始一个更远的行，并且会进一步向下延伸以包括所有后续的空白行。

我知道如何制作这些折叠之一（假设 foldmethod=manual）：

```
/^{<cr>kVnn?^$<cr>zf 
```

但我不确定如何将其放入函数中。这是我的努力：

```
function Cfold()
  set foldmethod=manual  " Manual folds
  ggzE                   " Delete all folds
  while (/^{<cr>)        " Somehow loop through each match
     kVnn?^$<cr>zf       " This would work fine except for the last function
  endwhile
endfunction
map <Leader>f  :call Cfold()<cr> 
```

但它是无效的，我不完全确定函数是如何工作的。此外，它不适用于文件中的最后一个函数，因为它不会再次找到 '^{'。如果有人可以帮助我完成这项工作，并以某种方式为文件中的最后一个函数添加一个案例，我将非常感激。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-13T06:25:57.990

`foldexpr`您可以使用和以编程方式创建折叠`foldtext`。试试这个，虽然你可能需要调整`CFoldLevel`，所以它不会吞噬代码的非功能部分：

```
function! CFoldLevel(lnum)
  let line = getline(a:lnum)
  if line =~ '^/\*'
    return '>1' " A new fold of level 1 starts here.
  else
    return '1' " This line has a foldlevel of 1.
  endif
endfunction

function! CFoldText()
  " Look through all of the folded text for the function signature.
  let signature = ''
  let i = v:foldstart
  while signature == '' && i < v:foldend
    let line = getline(i)
    if line =~ '\w\+(.*)$'
      let signature = line
    endif 
    let i = i + 1
  endwhile

  " Return what the fold should show when folded.
  return '+-- ' . (v:foldend - v:foldstart) . ' Lines: ' . signature . ' '
endfunction

function! CFold()               
  set foldenable
  set foldlevel=0   
  set foldmethod=expr
  set foldexpr=CFoldLevel(v:lnum)
  set foldtext=CFoldText()
  set foldnestmax=1
endfunction 
```

有关`:help 'foldexpr'`更多详细信息，请参阅。

# objective-c - 在 Objective C 中将对象添加到 NSMutableArray 时遇到问题

> ID：851926
> 
> 赞同：1
> 
> 时间：2009-05-12T09:25:04.100
> 
> 标签：objective-c, iphone, cocoa, cocoa-touch

我正在使用 iPhone SDK，但在做一些简单的事情时遇到了问题。我正在尝试将**NSNumber**对象添加到**NSMutableArray**实例变量。我尝试将 NSNumber**卡****添加**到 NSMutableArrayviewedCardsArray ，但是没有中断，它不会被添加到数组中。这是代码。

```
 /////////////////////////////////////////////////////
// Inside the header file Class.h
@interface MyViewController : UIViewController {
   NSMutableArray *viewedCardsArray;
   //snip ...
}
@property (nonatomic, retain) NSMutableArray *viewedCardsArray;
@end

/////////////////////////////////////////////////////
// Inside the methods file Class.m
#import "StudyViewController.h"

@implementation StudyViewController
@synthesize viewedCardsArray
  //snip ...

- (IBAction)doShowCard {
   //snip ...
   NSNumber *cardIdObject = [[NSNumber alloc] initWithInt:(int)[self.currentCard cardId]];
   [viewedCardsArray addObject: cardIdObject];
   [cardIdObject release];
} 
```

所以这段代码执行了，并且似乎没有泄漏（根据 Leaks 性能工具）。但是，在单步执行代码时，**CardIdObject 绝不**会出现在**viewedCardsArray**中。

通过 SO，我知道这些基本问题对于 ObjC 新手（比如我）来说很常见，所以提前道歉！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-05-12T09:32:36.930

你的初始化了`viewedCardsArray`吗？如果不需要，您需要在某个地方 - 这通常在`init`您的班级的方法中完成：

```
- (id)init
{
    self = [super init];
    if(self) {
        viewedCardsArray = [[NSMutableArray alloc] init];
    }
    return self;
} 
```

然后在`dealloc`方法中释放：

```
- (void)dealloc
{
    [viewedCardsArray release];
    [super dealloc];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T14:08:29.107

Perspx 概述了一种初始化数组的方法。但是，您也可以使用 NSArray 提供的类方法：

```
self. viewedCardsArray = [NSMutableArray array]; 
```

这可以在 init 或其他地方进行。

注意：该对象将被自动释放。

# vb.net - VSTO CommandBarButton 位置

> ID：851928
> 
> 赞同：0
> 
> 时间：2009-05-12T09:26:33.523
> 
> 标签：vb.net, outlook, vsto, outlook-addin, outlook-2003

我正在编写一个 VSTO 加载项来为 Outlook 2003 中的所有新 MailItems 添加一个标准工具栏按钮。

我已经完成了大部分工作，但我不知道如何设置按钮在任务栏上的位置——理想情况下，我想把它放在发送按钮旁边。

这是我到目前为止的代码。

```
Private Sub colInsp_NewInspector(ByVal Inspector As Microsoft.Office.Interop.Outlook.Inspector) Handles colInsp.NewInspector
    Dim msg As Outlook.MailItem
    Dim commandBar As Office.CommandBar
    Dim encryptButton As Office.CommandBarButton
    Dim olkitem As Object
    olkitem = Me.ActiveInspector().CurrentItem

    If TypeOf Inspector.CurrentItem Is Outlook.MailItem Then
        msg = CType(Inspector.CurrentItem, Outlook.MailItem)
        commandBar = Inspector.CommandBars("Standard")
        encryptButton = commandBar.FindControl(Tag:="EncryptMail")
        If Not (encryptButton Is Nothing) Then
            encryptButton.Delete()
        End If
        encryptButton = CType(commandBar.Controls.Add(1), Office.CommandBarButton)
        encryptButton.Style = Office.MsoButtonStyle.msoButtonIconAndCaption
        encryptButton.FaceId = 718
        encryptButton.Caption = "Secure Email"
        encryptButton.Tag = "EncryptMail"
        If olkitem.Sensitivity = Outlook.OlSensitivity.olConfidential Then
            encryptButton.State = Office.MsoButtonState.msoButtonDown
        End If
        AddHandler encryptButton.Click, AddressOf encryptButton_Click
        msg = Nothing
    End If
End Sub 
```

任何帮助将不胜感激！

谢谢，吉姆。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T13:58:15.300

我应该改用`commandBar.AddControl(control, position)`语法

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-08-15T10:30:54.863

在 Outlook 2007 中：

```
(Office.CommandBarButton)commandBars["Standard"].Controls.Add(Office.MsoControlType.msoControlButton, System.Reflection.Missing.Value, System.Reflection.Missing.Value,2,true); 
```

其中`2`是职位的数量。

# apache-flex - 使用其他 MXML 文件中定义的函数

> ID：851929
> 
> 赞同：1
> 
> 时间：2009-05-12T09:26:57.953
> 
> 标签：apache-flex, function, mxml

我有一个 Main.mxml 文件和一个 RoutePlanner.xmlm 文件。RoutePlanner 定义了一个自定义 Canvas 组件，而 Main.mxml 使用该自定义组件。

问题是 RoutePlanner 组件包含很多事件，例如 Click() 和 MouseMove() 等。但是这些事件引用的函数都在 Main.mxml 中定义。

Main.mxml 是我试图拆分的一个巨大文件。由于函数中使用了类变量，我不能只将函数从 Main 移动到自定义组件。

可以`include`在组件中使用Main，所以我可以使用这些方法吗？或者我应该将所有方法移动到一个 AS 文件中，然后简单地将其包含在 Main 和组件中？（不过，这需要安静的多一点工作）

或者是否可以在组件中创建占位符函数，然后使这些占位符可绑定，并且在 Main.mxml 中创建组件之后，将 Main.xml 中定义的实际方法绑定到组件中的事件？

提前致谢，

夸克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T14:55:56.720

随着您的应用程序变得越来越复杂，您应该考虑使用像 Cairngorm 或 Pure MVC 这样的微架构框架。

这些确实有助于组织您的应用程序。

查看这些对 Cairngorm 的介绍：[http ://www.davidtucker.net/2008/04/01/cairngorm-videos-available-as-flv-downloads/](http://www.davidtucker.net/2008/04/01/cairngorm-videos-available-as-flv-downloads/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T13:48:12.080

自己使用事件发现了它：

自定义组件.mxml：

```
[Event(name="onCreateRoute", type="Event")]
...  
<mx:Button label="Plan Route" click="dispatchEvent(new Event('onCreateRoute'))"/> 
```

主.mxml

```
<custom:CustomComponent onCreateRoute="CreateRoute(event);" /> 
```

# .net - OSX上的Silverlight，是否意味着微软将大量的.NET Framework移植到了OSX上？

> ID：851931
> 
> 赞同：1
> 
> 时间：2009-05-12T09:27:44.800
> 
> 标签：.net, silverlight, macos

Silverlight 在 OSX 上工作，Silverlight 使用 .NET Framework（至少有很大一部分）。

这是否意味着微软实际上将 .NET Framework 移植到 OSX 但没有告诉我们？或者您认为我们可以很快接受 OSX 的官方 .NET 框架吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-05-12T09:30:35.887

无论如何，很大一部分 .NET 都在可移植的 IL 中。重要的一点是他们已经移植了 CLR - 我们知道他们已经为[共享源 CLI](http://en.wikipedia.org/wiki/Shared_Source_Common_Language_Infrastructure)（又名转子）做了这个。

不过，我不希望很快在 Mac 上正式发布 .NET - 相反，我没有任何内部知识，我很想看到它，但我认为不太可能。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T15:14:55.280

MSDN 上有一篇[非常好的文章，](http://msdn.microsoft.com/en-us/magazine/cc721609.aspx)介绍了他们如何为 Silverlight 重构 CLR 和 .NET 框架。

# delphi - 将 Windows 演示应用程序移植到 WinCE/XP Embedded

> ID：851934
> 
> 赞同：0
> 
> 时间：2009-05-12T09:28:55.640
> 
> 标签：delphi, embedded, windows-ce, lazarus, windows-xp-embedded

我们为我们的微控制器产品提供了一系列 PC 演示程序。这些程序通常连接到微控制器板上的 USB HID 芯片。USB 芯片充当通信桥，允许程序通过 SPI/I2C/UART 与微控制器通信。程序可以配置微控制器，并取回状态信息以显示给用户。

我们现在正在寻求使用单板 PC 构建一些独立的演示。我们希望尽可能多地重用我们现有的演示应用程序源代码。理想情况下，我们可以按原样运行它们。

有人对最好的前进方式有任何建议吗？基本选项似乎是 WinCE 或 XP Embedded 板。WinCE 板似乎消耗更少的电量，从电池寿命的角度来看，这将是一个优势。

我们现有的演示是用 Borland Builder 下的 C++ 或 Delphi 构建的。

提前致谢。

编辑：请参阅下面的答案以及来自电路板供应商的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-22T08:40:50.860

Free Pascal/Lazarus 可以将某些形式的 Delphi 应用程序编译成 WinNCE/arm。甚至是视觉的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-13T07:23:19.703

WinCE 没有 Delphi 版本，因此您需要重写应用程序。这同样适用于 Borland Builder 的控件库。只有使用普通的 Win32 API，才能轻松地将应用程序移植到 WinCE。您也可能会遇到硬件访问部分的问题。串行端口驱动程序可能无法按原样工作。此外，您需要找到可以充当 USB 主机并提供​​ HID 驱动程序的 WinCE 板（这不是很常见）。

总之，我相信您使用 Windows XP Embedded 主板会更好。这些应该按原样运行您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-09T11:54:46.867

作为更新和未来参考，我想我会在此处发布我们与 WinCE 板供应商讨论的结果。警告：我实际上没有尝试过任何这些。

最重要的是，没有一种直接的方法可以实现我们所希望的（即重新编译我们现有的演示应用程序以在 WinCE 下运行）。原因是 Windows 桌面风格中存在的通用 HID 驱动程序和标准 API 在 WinCE 中不存在。

要在 WinCE 中与 HID 设备通信，您需要实现自定义 HID 驱动程序。这需要支持一个接口，允许用户模式应用程序与驱动程序通信，并构建 HID 报告以发送到物理设备。由于此接口本身是自定义的，因此需要相应地更新应用程序代码。

WinCE 应用程序开发通常使用 Visual Studio 和 Microsoft 编译器完成。向我们推荐的方法是：

1.  创建自定义 HID 类驱动程序。例如，这可能基于 Microsoft 键盘 HID 驱动程序。
2.  创建一个用于与驱动程序对话的 API。
3.  使用 .net 创建我们的 GUI 应用程序，并使用 PInvoke 与 API 进行实际对话。

所有这些令人头疼的最终结果是，为了避免与这种方法相关的时间和学习曲线，我们将选择运行 XP 的电路板。然后，我们可以直接使用现有的演示应用程序。权衡是我们将不得不忍受大大缩短的电池寿命。

# payment - 如何获得合同工作的报酬并与债务人打交道

> ID：851936
> 
> 赞同：4
> 
> 时间：2009-05-12T09:29:20.193
> 
> 标签：payment

三周前，我为一个人完成了一个项目。我的前任 CEO 给了他一个很好的参考。

在我为这个人工作的整个过程中，我给了他他可以看到的更新，并告诉他他需要确保告诉我他是否需要任何更改。

最后，他告诉我它看起来很棒，正是他想要的，他会给我寄一张支票。第二天，他让他的朋友检查了一下，发现他需要做很多改变。

我告诉他我会继续从事这个项目——以实施这些改变——只要他支付我迄今为止他委托的工作的费用。

他现在是 MIA，不回复我的电子邮件或电话。我为此投入了价值 2,000 美元的工作。

我应该尝试收集这个吗？如果是这样，怎么做？我应该带他去小额索赔法庭吗？忘掉它？什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-05-12T09:35:53.630

联系律师。

并且在未来，除非您已获得报酬，否则不要将成品提供给新客户。哦，试着提前获得一定的报酬。设置您的合同，以便有“阶段”，每个阶段完成后，您都会获得一定的报酬。

但是现在，和律师谈谈。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-05-12T09:34:55.833

在变得沉重之前先给他寄一张书面发票。如果你表现得专业，那么他可能会意识到你是认真的，不会被推来推去。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T09:35:44.083

承包商方面非常糟糕。当您单独工作或是一家小公司时，这始终是问题。

尝试使用你们都认识的人施加压力。尝试亲自与他交谈。

对于未来，如果您想在小型（小预算/小时间线）项目中担任承包商，您应该尝试从[Odesk](http://www.odesk.com)或其他作为开发商和承包商之间调解人的站点获得工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T09:47:21.740

多年前我有过类似的经历，并研究过使用小额索赔。现在这是英国，所以在美国几乎可以肯定是不同的。事实证明，即使你成功了，你也不能保证付款。如果他们拒绝付款，它将出现在他们未来进行的任何信用检查中，这对他们来说是唯一的缺点。获得这笔钱的机会很小，这是一项非常艰巨的工作。如果您能找到愿意接受的律师，那么聘请律师对您来说只是更多的成本。

我知道这听起来很难，但这是我个人的经历——最后我只是不付钱，并确保我总是向任何愿意听的人强调这个事实（大约十五年前，那个人叫特里什么的，他曾为 Jumping Bean 做酒吧测验机软件）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T10:03:44.570

所有其他建议都很好。

我的律师给我的最好建议是，人脉几乎一文不值，关键在于你和谁做生意。在高达 30K 美元的约 15 年的联系工作中，我已经僵硬了几次。可悲，但这是业务的一部分。尝试与您信任的人做生意。不要对你有不好感觉的人做任何事。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T11:56:19.927

咬紧牙关，继续你的生活。无法从石头上取血。律师不会在应急基础上受理此案，任何提交的文件都会变成您的更多费用。

只需给你的前任 CEO 写一封电子邮件和一封信（抄送那个坏人），说明那个人是多么不专业。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-06-28T03:35:31.773

至少你在那个时候停止了工作......我听说有些人一直在工作，认为这将帮助他们获得报酬。不要这样做！

# dependency-injection - 温莎城堡注入构造对象的属性

> ID：851940
> 
> 赞同：5
> 
> 时间：2009-05-12T09:30:10.507
> 
> 标签：dependency-injection, castle-windsor

一些依赖注入容器使您能够将配置的服务注入到已经构建的对象中。

这是否可以使用 Windsor 来实现，同时考虑到目标对象上可能存在的任何服务依赖关系？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2011-06-08T09:52:05.793

这是一个老问题，但谷歌最近把我带到了这里，所以我想我会分享我的解决方案，以免它帮助有人寻找类似 StructureMap 的 Windsor 的 BuildUp 方法。

我发现我可以相对容易地自己添加这个功能。这是一个示例，它只是将依赖项注入到一个对象中，在该对象中它找到了一个空接口类型的属性。当然，您可以进一步扩展概念以查找特定属性等：

```
public static void InjectDependencies(this object obj, IWindsorContainer container)
{
    var type = obj.GetType();
    var properties = type.GetProperties(BindingFlags.Public | BindingFlags.Instance);
    foreach (var property in properties)
    {
        if (property.PropertyType.IsInterface)
        {
            var propertyValue = property.GetValue(obj, null);
            if (propertyValue == null)
            {
                var resolvedDependency = container.Resolve(property.PropertyType);
                property.SetValue(obj, resolvedDependency, null);
            }
        }
    }
} 
```

这是此方法的简单单元测试：

```
[TestFixture]
public class WindsorContainerExtensionsTests
{
    [Test]
    public void InjectDependencies_ShouldPopulateInterfacePropertyOnObject_GivenTheInterfaceIsRegisteredWithTheContainer()
    {
        var container = new WindsorContainer();
        container.Register(Component.For<IService>().ImplementedBy<ServiceImpl>());

        var objectWithDependencies = new SimpleClass();
        objectWithDependencies.InjectDependencies(container);

        Assert.That(objectWithDependencies.Dependency, Is.InstanceOf<ServiceImpl>());
    }

    public class SimpleClass
    {
        public IService Dependency { get; protected set; }
    }

    public interface IService
    {
    }

    public class ServiceImpl : IService
    {
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-05-12T12:13:02.987

不，它不能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T14:38:47.547

正如 Krzysztof 所说，对此没有官方解决方案。不过，您可能想尝试[这种解决方法](http://groups.google.com/group/castle-project-users/browse_thread/thread/98f27000d07683e4)。

就个人而言，我认为必须这样做是一种代码味道。如果是你的代码，为什么没有在容器中注册？如果它不是您的代码，请为它编写一个工厂/适配器/等。

# iphone - 蒙版后图像看起来模糊

> ID：851942
> 
> 赞同：0
> 
> 时间：2009-05-12T09:30:27.650
> 
> 标签：iphone, objective-c, cocoa-touch

我正在开发一款游戏，我想放大放置放大镜图像的图像。为此，我使用了掩蔽的概念。蒙版后，我正在缩放图像，但看起来很模糊。我希望图像应该更清晰，就像我们通过步枪放大镜看一样。因此，如果有人有解决方案，请回复

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-13T11:47:03.907

are you sure that the problem is the masking?

perhaps your resources are too low resolution? high resolution images scaled down always look better than low resolution images scaled up. Maybe you need to look at the problem backwards... so that your image when looking through the rifle magnifier [scope?] is viewed at a 1:1 resolution and when not viewed through the scope it is zoomed out (1:2 resolution?). so this way your 'normal' mode is the zoomed out mode and the "magnified view" is actually just the image at 1:1.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T06:57:42.500

如果您有一个大小为 293x184 的 UIImage，但您创建了一个初始大小为 40x30 的 UIImageView，则 iPhone 会根据以下属性缩放 UIImage 以适应：contentMode。默认 contentMode 是：UIViewContentModeScaleToFill，它会缩放您的图像。

因此，即使您从一个大图像开始，它现在也只有 40x30 并以 40x30 渲染。当您缩放时，它仍然是 40x30，但会以更大的尺寸渲染，这会导致模糊。

一种解决方案是在缩放后替换图像，然后您将拥有一个全新的全分辨率 UIImage。

```
[self.view setFrame:reallyBigFrame];
[self.view setImage:newUIImage]; 
```

另一个是最初将 UIImage 放置在全尺寸 293x184 UIImageView 中，然后使用 AffineTransform 将其缩小：

```
view.transform = CGAffineTransformScale(view.transform, 0.25, 0.25); 
```

# excel - 从自定义应用程序获取数据到 EXcel

> ID：851946
> 
> 赞同：1
> 
> 时间：2009-05-12T09:30:53.220
> 
> 标签：excel, com, dde

我希望能够将自定义应用程序中的一些数据链接到 Excel 中的单元格。

你会用什么技术来做到这一点？我主要是一名 Unix 开发人员，并不深入了解 win32 技术。但据我了解，DDE 将是最简单的，即使它是非常古老的技术。

能够将它与 OpenOffice 等其他办公套件一起使用将是一个很大的好处。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-05-12T20:47:07.250

“将自定义应用程序中的数据链接到 Excel 中的单元格”是什么意思？

您是否希望 Excel 工作表显示由某些外部应用程序生成的数据？

如果是这种情况，则有多种选择。Excel 数据提供程序是一种方法。如果您有大量要加载的数据，则此方法有效。对于一个细胞，这可能是矫枉过正。

如果可以通过网络接口（比如 HTTP）访问外部数据，那么您可以编写一些 Excel 宏代码来使用它。您可以在 Excel 中使用 ServerXmlHttp 对象来使用它。一些指导是在[这里。](https://stackoverflow.com/search?q=serverxmlhttp+excel)

另一种方法是通过自定义 COM 对象公开数据，这是 Excel 非常容易使用的重用构造。您必须编写一些代码才能做到这一点，但这并不太复杂。您可以用 .NET、C++、Javascript、VBScript、PerlScript 等编写它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T19:12:14.627

在 .NET 中，我会使用 Excel 的 COM 库。您可以使用 Workbook、Worksheet 和 Range 对象来处理特定工作表和工作簿中的特定单元格。这些在 .NET（尤其是 VB.NET）中运行良好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-12T19:17:11.467

COM 接口非常简单。你首先录制一个宏，然后做你想做的事。之后将生成的代码翻译成您选择的编程语言。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-13T07:18:55.267

我在这里看到的所有解决方案都有将数据推送到 Excel 的方法。为什么不负责将这些数据拉到 Excel 本身呢？Excel 确实能够通过 oleDB 和 ODBC 添加数据。（至少从我知道的版本来看）我只能在Office2007中测试，这是我机器上唯一的版本。

您所要做的就是将此选项添加到带有数据选项卡的电子表格中。很简单。这样，您还可以免除维护应用程序中的代码以打开 Excel、运行一些代码以将代码推送到单元格等的负担。您可以为此录制一个宏并在打开 Excel 工作表时运行该宏。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T19:05:41.830

链接到单元格值的最简单方法是通过 Visual Studio 2008 中的 .net 数据提供程序。这里是一些更常用方法的链接。 [关联](http://davidhayden.com/blog/dave/archive/2006/05/26/2973.aspx)

由于数据提供者不一样，因此很难尝试将其用于开放办公室。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T19:08:15.803

我建议使用 Java/JVM 及其 Apache POI 库。

它可以读写Excel文件，是纯跨平台的java。在实践中非常可靠。

[http://poi.apache.org/](http://poi.apache.org/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-12T19:16:18.363

乔纳坦，

如果源应用程序将数据存储在数据库或文本文件中，则可以使用 excels 的内置数据函数来检索它。否则我会同意代顿与 VS2008 的集成。您可以使用 VS2005，但它需要您安装 VSTO。

关于 DDE - 除了几乎已经过时，使用不同版本的 Excel 和不同的语言时会出现问题，这将需要您对相同的操作使用不同的关键字

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-12T20:56:23.473

澄清一下：DDE 适用于开放式办公室。我是 Bloomberg 用户，我在 open office 中打开了一个 office 2003 电子表格，其中包含通过 DDE 更新的股票价格的 Bloomberg 链接，它就像一个魅力。

# .net - .NET 集合类的渐近复杂度

> ID：851949
> 
> 赞同：34
> 
> 时间：2009-05-12T09:31:25.543
> 
> 标签：.net, collections, big-o, asymptotic-complexity

是否有关于 .NET 集合类（等）的方法的渐近复杂性（big-O 和其他）的任何`Dictionary<K,V>`资源`List<T>`？

我知道 C5 库的文档包含一些关于它的信息（[示例](http://www.itu.dk/research/c5/Release1.1/c5doc/types/C5.LinkedList_1.htm)），但我也对标准 .NET 集合感兴趣......（并且 PowerCollections 的信息也很好）。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2009-05-12T09:34:00.170

MSDN 列出了这些：

*   [`Dictionary<,>`](http://msdn.microsoft.com/en-us/library/xfhwa508.aspx)
*   [`List<>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)
*   [`SortedList<,>`](http://msdn.microsoft.com/en-us/library/system.collections.sortedlist.aspx)（编辑：错误的链接；这是[通用版本](http://msdn.microsoft.com/en-us/library/ms132319.aspx)）
*   [`SortedDictionary<,>`](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)

等等例如：

> SortedList(TKey, TValue) 泛型类是具有 O(log n) 检索的二叉搜索树，其中 n 是字典中的元素数。在这方面，它类似于 SortedDictionary(TKey, TValue) 泛型类。这两个类具有相似的对象模型，并且都具有 O(log n) 检索。这两个类的不同之处在于内存使用和插入和删除速度：
> 
> SortedList(TKey, TValue) 使用的内存比 SortedDictionary(TKey, TValue) 少。
> 
> SortedDictionary(TKey, TValue) 对未排序的数据具有更快的插入和删除操作，O(log n) 相对于 SortedList(TKey, TValue) 的 O(n)。
> 
> 如果列表是从排序数据中一次性填充的，SortedList(TKey, TValue) 比 SortedDictionary(TKey, TValue) 快。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2009-05-12T09:38:48.870

[本页](http://leepoint.net/notes-java/algorithms/big-oh/bigoh.html)总结了使用 Java 的各种集合类型的一些时间复杂性，尽管它们对于 .NET 应该完全相同。

我已经从该页面获取了表格，并为 .NET 框架更改/扩展了它们。另请参阅[SortedDictionary](http://msdn.microsoft.com/en-us/library/f7fta44c.aspx)和[SortedList](http://msdn.microsoft.com/en-us/library/ms132319.aspx)的 MSDN 页面，其中详细说明了各种操作所需的时间复杂度。

* * *

## 搜索

```
搜索类型/集合类型 复杂性 注释
线性搜索 Array/ArrayList/LinkedList O(N) 未排序的数据。
Binary search sorted Array/ArrayList/ O(log N) 需要已排序的数据。
Search Hashtable/Dictionary<T> O(1) 使用散列函数。
二进制搜索 SortedDictionary/SortedKey O(log N) 排序是自动的。

```

## 检索和插入

```
操作 Array/ArrayList LinkedList SortedDictionary SortedList
返回 O(1) O(1) O(log N) O(log N)
访问前 O(1) O(1) NANA
访问中间 O(1) O(N) NANA
在后面插入 O(1) O(1) O(log N) O(N)
在前面插入 O(N) O(1) NANA
插入中间 O(N) O(1) NANA

```

删除应该与关联集合的插入具有相同的复杂性。

SortedList 在插入和检索方面有一些显着的特点。

*插入（添加方法）：*

> 此方法是对未排序数据的 O(n) 操作，其中 n 是 Count。如果将新元素添加到列表的末尾，则这是一个 O(log n) 操作。如果插入导致调整大小，则操作为 O(n)。

*检索（项目属性）：*

> 检索此属性的值是一个 O(log n) 操作，其中 n 是 Count。如果键已经在 SortedList<(Of <(TKey, TValue>)>) 中，则设置该属性是 O(log n) 操作。如果键不在列表中，则设置属性对于未排序的数据是 O(n) 操作，如果在列表末尾添加新元素，则为 O(log n)。如果插入导致调整大小，则操作为 O(n)。

请注意，就所有操作的复杂性而言，这`ArrayList`等价于。`List<T>`

* * *

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2011-06-15T12:45:35.683

我一般不知道（刚刚发布的另一个答案可能会为您提供您所追求的确切内容） - 但您当然可以使用 ILSpy 来反映这个和其他方法（FSharp 代码有点尴尬，真的），这最终会产生此函数为 C#：

```
internal static a maximumElementAux<a>(SetTree<a> s, a n)
{
  while (true)
  {
    SetTree<a> setTree = s;
    if (setTree is SetTree<a>.SetOne)
    {
      break;
    }
    if (setTree == null)
    {
      return n;
    }
    SetTree<a>.SetNode setNode = (SetTree<a>.SetNode)s;
    SetTree<a> arg_23_0 = setNode.item3;
    n = setNode.item1;
    s = arg_23_0;
  }
  return ((SetTree<a>.SetOne)s).item;
  return n;
} 
```

好的，所以这不是 C# 术语中的“正确”代码——但`while(true)`循环的存在意味着它至少不能是 O(1)；至于它实际上是什么......好吧，我的头很痛，无法找到:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-08-18T07:58:34.597

本页简要介绍了大多数 .NET 集合的一些主要优点和缺点：

[http://geekswithblogs.net/BlackRabbitCoder/archive/2011/06/16/c.net-fundamentals-choosing-the-right-collection-class.aspx](http://geekswithblogs.net/BlackRabbitCoder/archive/2011/06/16/c.net-fundamentals-choosing-the-right-collection-class.aspx)

> | 收藏 | 订购 | 连续存储 | 直接访问 | 查找效率 | 操纵效率 | 笔记 |
> | --- | --- | --- | --- | --- | --- | --- |
> | 字典 | 无序 | 是的 | 通过密钥 | 键：O(1) | O(1) | 最适合高性能查找。 |
> | 排序字典 | 已排序 | 不 | 通过密钥 | 键：O(log n) | O(log n) | 字典速度和排序的妥协，使用二叉搜索树。 |
> | 排序列表 | 已排序 | 是的 | 通过密钥 | 键：O(log n) | 上） | 与 SortedDictionary 非常相似，除了树是在数组中实现的，因此对预加载数据的查找速度更快，但加载速度较慢。 |
> | 列表 | 用户可以精确控制元素排序 | 是的 | 通过索引 | 索引：O(1) 值：O(n) | 上） | 最适合需要直接访问且无需排序的较小列表。 |
> | 链表 | 用户可以精确控制元素排序 | 不 | 不 | 值：O(n) | O(1) | 最适合在中间插入/删除很常见且不需要直接访问的列表。 |
> | 哈希集 | 无序 | 是的 | 通过密钥 | 键：O(1) | O(1) | 唯一的无序集合，就像字典一样，除了键和值是同一个对象。 |
> | 排序集 | 已排序 | 不 | 通过密钥 | 键：O(log n) | O(log n) | 唯一的排序集合，就像 SortedDictionary 一样，除了键和值是同一个对象。 |
> | 堆 | 后进先出 | 是的 | 只有顶部 | 顶部：O(1) | O(1)* | 与 List 基本相同，只是仅作为 LIFO 处理 |
> | 队列 | 先进先出 | 是的 | 只有前面 | 前：O(1) | O(1) | 与 List 基本相同，只是仅作为 FIFO 处理 |

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-05-12T09:35:58.593

没有“集合类的复杂性”之类的东西。相反，对这些集合的不同操作具有不同的复杂性。例如，将元素添加到`Dictionary<K, V>`[...](http://msdn.microsoft.com/en-us/library/k7z0zy8k.aspx)

> ...接近*O(1)*操作。如果必须增加容量以容纳新元素，则此方法变为*O(n)*操作，其中`n`is `Count`。

[而从...](http://msdn.microsoft.com/en-us/library/9tee9ht2.aspx)中检索元素`Dictionary<K, V>`

> ...接近 O(1) 操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2011-06-29T13:56:21.767

文档说它是建立在二叉树上的，并且没有提到跟踪最大元素。如果文档是正确的，这意味着它应该是 O(log n)。集合文档中曾经至少存在一个错误（将数组支持的数据结构称为二叉搜索树），但已更正。

# oracle - 为 Oracle 指定 Easy Connect 字符串的防弹方法是什么？

> ID：851956
> 
> 赞同：1
> 
> 时间：2009-05-12T09:33:52.590
> 
> 标签：oracle

Oracle 将 Easy Connect 字符串描述为

用户名@[//]host[:port][/service_name][:server][/instance_name]

（来自[http://www.oracle.com/technology/products/oraclenet/files/OracleNetServices_NetEasyConnect.pdf](http://www.oracle.com/technology/products/oraclenet/files/OracleNetServices_NetEasyConnect.pdf)）

但是，我们的一些服务人员经常遇到这种格式在客户站点上不起作用的问题，为了方便起见，我们求助于 TNSNAMES.ORA 和别名，这使得 Oracle Instant Client 不那么“即时”。

但是，事实上，连接字符串是集中管理的，因此这个别名在系统中连接到数据库的所有机器上都需要相同，这是一个维护麻烦。

失败是由于我们对Oracle命名系统的所有点点滴滴，“SID”，“服务名”，“主机名”，“全局服务名”的含义，命名方法，数据库本地和全局命名设置一无所知。 、SQLNET 和 TNS 侦听器配置。

由于我无法找到关于该主题的单一、一致和全面的参考资料，我想我会将这个问题传递给社区。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-05-12T12:30:52.530

如果您要将客户端应用程序软件安装到现有的客户环境中，那么最简单的做法可能是对其 SQL*Net 配置进行逆向工程。我会这样做：

*   使用完整的 Oracle 客户端进入工作站，该客户端已使用正确的 tnsnames.ora 和 sqlnet.ora 文件配置了 SQL*Net
*   针对感兴趣的数据库运行 tnsping 实用程序，这将产生类似于以下内容的输出：

$ tnsping 测试数据库

适用于 Linux 的 TNS Ping 实用程序：版本 11.1.0.6.0 - 生产于 2009 年 5 月 12 日 08:28:11

版权所有 (c) 1997、2007，甲骨文。版权所有。

使用的参数文件：/home/oracle/oracle/product/11.1.0/network/admin/sqlnet.ora

使用 TNSNAMES 适配器解析别名 Attempting to contact (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP) (HOST = testhost (PORT = 1521))) (CONNECT_DATA = (SERVICE_NAME=testdb.world))) OK (0毫秒）

这将告诉您主机名以及数据库侦听器期望连接的方式（端口和 SERVICE_NAME 与 SID）。您现在拥有指定 Easy Connect 字符串的信息。顺便说一句，tnsping 实用程序也可以在 Window 客户端上使用。

# c - malloc() 和 free() 在哪里存储分配的大小和地址？

> ID：851958
> 
> 赞同：18
> 
> 时间：2009-05-12T09:34:02.853
> 
> 标签：c, memory, heap-memory, free

在哪里存储分配的地址及其大小（Linux GCC）`malloc()`？`free()`我读过一些实现将它们存储在实际分配的内存之前的某个地方，但我无法在我的测试中确认这一点。

背景，也许有人对此有另一个提示：

我正在尝试分析一个进程的堆内存，以确定另一个进程中字符串的当前值。访问进程堆内存并浏览它是没有问题的。但是，由于字符串的值发生变化，并且进程每次都分配新的内存部分，因此字符串的地址发生了变化。因为字符串具有固定格式，仍然很容易找到，但经过一些更改后，字符串的旧版本仍然在堆内存中（可能已释放，但仍未重用/覆盖），因此我无法判断哪个字符串是当前字符串。

因此，为了仍然找到当前的字符串，我想通过将其地址与地址进行比较`malloc()`并`free()`了解是否仍在使用我在内存中找到的字符串。

ciao，埃尔玛

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-05-12T09:40:22.533

malloc/free 可以通过多种方式存储内存区域的大小。例如，它可能存储在 malloc 返回的区域之前。或者它可能存储在其他地方的查找表中。或者它可能被隐式存储：某些区域可能为特定大小的分配保留。

要了解 Linux 中的 C 库 (glibc) 是如何做到这一点的，请从[http://ftp.gnu.org/gnu/glibc/](http://ftp.gnu.org/gnu/glibc/)获取源代码并查看该`malloc/malloc.c`文件。顶部有一些文档，它指的是 Doug Lea 的[A Memory Allocator](http://gee.cs.oswego.edu/dl/html/malloc.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-12T09:41:15.480

当然，这取决于标准库的实现。所以你最好的选择可能是挖掘库的源代码（[glibc](http://www.gnu.org/software/libc/)是 Linux 上的默认值），看看你是否能弄清楚。这可能不会是微不足道的。

# unit-testing - TFS UnitTesting 在构建服务器上时未部署本地复制程序集以测试目录

> ID：851960
> 
> 赞同：4
> 
> 时间：2009-05-12T09:34:03.557
> 
> 标签：unit-testing, tfs

我有一个程序集需要在测试输出目录中才能运行我的测试。我在项目中将程序集作为本地副本引用，但在构建服务器上这会被忽略。我发现解决此问题的两种方法是

1.  为测试方法添加一个特殊属性，以确保每个测试的文件都存在。

    [部署项（“我的程序集”）]

    这不是很实用，因为几乎每个程序集中的测试都需要此程序集。

2.  添加带有特殊部署部分的测试运行配置文件。我在构建脚本中使用 TestContainer 来运行测试我认为这可能是我包含的测试运行配置没有被拾取并且程序集没有被复制的原因。我宁愿没有 vsmdi 测试列表文件，因为我正在尝试运行所有测试，我觉得这会违反 DRY。

关于如何让我的测试运行的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-05-14T14:48:33.553

当我的程序集被动态加载时，单元测试框架没有复制它。我通过在程序集中的一种类型上调用 typeof 为其添加了显式引用，一切都很好。

感谢杰罗姆·拉班 (Jerome Laban) 为您提供的帮助。

# windows - 如果端口正在使用，Windows 批处理脚本将打印错误消息

> ID：851962
> 
> 赞同：6
> 
> 时间：2009-05-12T09:34:24.243
> 
> 标签：windows, batch-file, dos, port

我正在尝试编写一个批处理脚本，如果端口 1099 已在使用中，则会出错。

不幸的是，我必须在 DOS 批处理脚本中编写它（我无法安装任何东西）。

我知道我可以手动打印占用端口 1099 的进程的 PID：

```
netstat -aon | findstr ":1099" 
```

但是我希望能够在批处理脚本中运行该命令并在该命令有任何输出时退出脚本并显示错误消息。

我想在一次推送中我可以将输出重定向到一个临时文件并测试它的大小，但这看起来真的很hacky......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-05-12T09:43:36.990

```
 netstat -an | FINDSTR ":1099" | FINDSTR LISTENING && ECHO Port is in use && EXIT 1 
```

`&&`仅当前一个命令成功（基于其退出代码/ `ERRORLEVEL`）时，您才能在批处理脚本中运行命令。这允许您仅在 netstat 的输出中找到您要查找的字符串时显示一条消息并退出。

此外，您还想明确查找`LISTENING`端口。

`FINDSTR`支持正则表达式，因此您还可以执行以下操作来缩短命令行：

```
netstat -an | findstr /RC:":1099 .*LISTENING" && ECHO Port is in use && EXIT 1 
```

# wpf - 类似于 SL3 for WPF 中的 DataForm 控件

> ID：851967
> 
> 赞同：2
> 
> 时间：2009-05-12T09:35:33.553
> 
> 标签：wpf, wpf-controls, dataform

我正在寻找一个像 DataForm 这样的控件，它是 Silverlight 3 中的新控件，用于处理 WPF 的整个绑定和验证逻辑（声明性地使用属性等）。

我一直认为 SL 是 WPF 的一个子集，但似乎没有 DataForm 控件，至少`System.Windows.Controls`不像 SL 那样在命名空间中（我知道 SL 使用另一个 CLR）

我忽略了什么吗？感谢帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-10-20T15:16:44.133

查看

[http://wpf.codeplex.com/Thread/View.aspx?ThreadId=57614](http://wpf.codeplex.com/Thread/View.aspx?ThreadId=57614)

[http://wpfdataform.codeplex.com/](http://wpfdataform.codeplex.com/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-08-10T12:06:49.673

该代码可在此处获得[http://www.rudigrobler.net/Blog/will-the-real-dataform-please-stand-up](http://www.rudigrobler.net/Blog/will-the-real-dataform-please-stand-up)（这包括用于比较的桌面和 Silverlight 版本）

该页面已移至：[http ://rudigroblerwp.wordpress.com/2011/09/27/will-the-real-dataform-please-stand-up/](http://rudigroblerwp.wordpress.com/2011/09/27/will-the-real-dataform-please-stand-up/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2010-03-22T17:48:24.670

结帐，这在 WPF 和 Silverlight 上都可用...

[http://uiatoms.neurospeech.com/parent-page/form-controls/](http://uiatoms.neurospeech.com/parent-page/form-controls/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-07-11T17:30:46.183

当 .NET 4 和 Visual Studio 2010 发布时，SL3 中的大多数（如果不是全部）新内容最终会出现在 WPF 4 中。应包括 DataForm。随着 SL2，Microsoft 开始在 WPF 之前在 SL 中提供一些功能。这似乎在当前的发布周期中继续存在。

# f# - F# 会像 C# 一样成为主流语言吗？还是它仍然是一种小众语言？

> ID：851973
> 
> 赞同：8
> 
> 时间：2009-05-12T09:39:13.750
> 
> 标签：f#

F# 会像 C# 一样成为主流语言吗？还是它仍然是一种小众语言？您是否预见到任何客户会带着在 F# 中执行的项目来找您？
专业程序员是否能够以 F# 为生。您预测 F# 程序员会有什么样的需求？

亲切的问候，

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-05-12T12:58:51.720

今天有人以函数式编程为生。例如，请参阅每年举办[的函数式编程研讨会的商业用户。](http://cufp.galois.com/)

对于 F# 的第一个版本，Microsoft 的目标是工程、数学、金融和数据处理应用程序（如果我没记错的话）。这是否是一个利基取决于你的观点:) 但它似乎是一个合理的市场。

由于 F# 出色的 .NET 集成，您可以在很大程度上选择使用 F# 制作您的项目。您的客户应该关心什么。如果你从中获得了相对于 C# 程序员的竞争优势，也许你最好希望 F#*不会*成为主流......

最后，当然 F#（和 Scala）是至少函数式编程将成为“更主流”的指标。但是什么时候一种语言被认为是主流？如果 C 和 COBOL 中的代码行数比 C#、VB 和 Java 的总和多得多，我不会感到惊讶。所以从 C 程序员的角度来看，C# 是一种小众语言。我认为，由于虚拟机，编程语言总体上变得更加多样化（例如，还可以考虑 Ruby、Python 和 Haskell，没有考虑到 Clojure、Ioke 等所有较小的语言……）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-05-12T09:46:46.483

我不能肯定地回答这个问题。当然，这是非常主观的。我们可以等着看会发生什么。但有一件事是肯定的。即使 F# 仍然是一种小众语言，编程的思想和函数式风格也会逐渐被进一步添加到其他语言中。您不能说 C# 3.0 与 C# 1.0 相同。这只是名称相似性的问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-05-12T18:10:57.223

我认为 F# 永远不会达到 C# 或其他命令式语言的流行程度，因为大多数应用程序都是命令式设计的，并且大多数程序员都以这种方式思考。

但是 F# 提供了许多非常有趣的功能，例如 LOP、编译器编译器、计算表达式（异步工作流）、引用、度量单位。

许多问题可以用函数式编程语言更好、更简洁地表述（看看那些使用 async {} 或 seq {} 的 F# 示例），并且因为 F# 比 Haskell 更主流一些（它有 .NET 框架简化了许多任务并且不是纯粹的函数式编程！），许多程序员将更容易进入函数式编程并了解它的优点。

此外，在 F# 中编写错误代码比在 C 中更难，因为您有良好的类型检查、编译器推断出的许多强类型和不可变的值 - 您可以直观地证明函数式算法的正确性，这在命令式中通常很难一。想想这段代码，它应该计算数组中零的数量：

```
int countZeros;
for (int i = 1; i <= length; i++) {
  if (data[i] = 0) {
   countZeros++;
 }
} 
```

这些都是促使人们使用 F# 的因素。剩下的就是营销了（微软VS2010应该有F# Express版！！）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-05-12T09:48:13.550

我看不到函数式语言作为一个整体成为主流。最终，任何与普通人类思维方式格格不入的事物都不会成为主流。

然而，函数式编程将不仅仅是利基市场。它在表达可以通过多个处理器解决的问题方面的好处是引人注目的。我看到的是用于特定目的的 F# 库和/或迁移到 C# 的 F# 概念。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-05-12T10:18:40.473

我不是专家，但我认为函数式编程的优点之一是并行和多核处理的相对轻松的方法。因此，鉴于微软最近在该领域的公告，即 Axum [http://msdn.microsoft.com/en-us/devlabs/dd795202.aspx](http://msdn.microsoft.com/en-us/devlabs/dd795202.aspx)这是另一种并行编程方法，我真的怀疑 F# 会永远成为主流。如果采用 Axum，它可能会与 C# 集成（如代码合同从 Lab 转移到 C# 4.0），而 F# 将仅用于非常特定的领域。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-05-12T09:42:29.113

***在函数式编程***成为主流之前，我看不到它会发生。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-05-14T13:44:14.143

F# 的伟大之处在于它允许的编程范式的强大组合。您可以以函数式风格编写大部分程序 - 简洁、优雅且没有副作用（常见错误）。但是，当您遇到无法通过功能解决的问题时，您可以输入一小段命令式代码来解决它。将代码部分标记为异步也很容易，如果您有多个内核/处理器，它将并行运行。该解决方案将比 C# 等价物容易得多。在见证了 F# 的一位创建者的演示之后，我的印象是他们已经设法从 Python 和 Erlang 中提取了出色的特性。F# 很可能会作为 .NET 对这两类语言的回答而出现在前面，并且最终可能会达到相当程度的主流采用率。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-05-14T14:44:35.187

OTOH，如果您使用 F#，那将是一个更主流的程序员....

避免它是一个自我实现的预言。

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2009-05-12T10:09:18.617

在业务线发展中，它永远不会发生。它太难了，所以普通的 LOB 开发人员永远无法维护它。不过，在高端软件公司中，它可能会发生。

# java - 如何将字符串对象（包含 XML）“转换”为现有 JSP 页面上的元素

> ID：851987
> 
> 赞同：23
> 
> 时间：2009-05-12T09:42:40.173
> 
> 标签：java, xml, xslt

目前，我有一个包含 XML 元素的 String 对象：

```
String carsInGarage = garage.getCars(); 
```

我现在想将此字符串作为输入/流源（或某种源）传递，但不确定选择哪一个以及如何实现它。

我看过的大多数解决方案都导入包：javax.xml.transform 并接受 XML 文件 (stylerXML.xml) 并输出到 HTML 文件 (outputFile.html)（参见下面的代码）。

```
try 
{
    TransformerFactory tFactory = TransformerFactory.newInstance();
    Transformer transformer = tFactory.newTransformer(new StreamSource("styler.xsl"));

    transformer.transform(new StreamSource("stylerXML.xml"), new StreamResult(new FileOutputStream("outputFile.html")));
}
catch (Exception e)
{
    e.printStackTrace();
} 
```

我想接受一个字符串对象并输出（使用 XSL）到现有 JSP 页面中的一个元素。我只是不知道如何实现这一点，即使看过上面的代码。

有人可以建议/协助。我一直在寻找解决方案，但我就是无法拿出任何东西。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2009-05-12T09:53:09.970

使用 a[`StringReader`](http://java.sun.com/javase/6/docs/api/java/io/StringReader.html)和 a [`StringWriter`](http://java.sun.com/javase/6/docs/api/java/io/StringWriter.html)：

```
try {
    StringReader reader = new StringReader("<xml>blabla</xml>");
    StringWriter writer = new StringWriter();
    TransformerFactory tFactory = TransformerFactory.newInstance();
    Transformer transformer = tFactory.newTransformer(
            new javax.xml.transform.stream.StreamSource("styler.xsl"));

    transformer.transform(
            new javax.xml.transform.stream.StreamSource(reader), 
            new javax.xml.transform.stream.StreamResult(writer));

    String result = writer.toString();
} catch (Exception e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-12T10:03:24.960

如果在某些时候您希望源包含的不仅仅是单个字符串，或者您不想手动生成 XML 包装器元素，请创建一个包含您的源的 DOM 文档并使用[DOMSource](http://java.sun.com/javase/6/docs/api/javax/xml/transform/dom/DOMSource.html)将其传递给转换器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-19T12:29:16.940

这对我有用。

```
String str = "<my>xml</my>"    
StreamSource src = new StreamSource(new StringReader(str));
ByteArrayOutputStream baos = new ByteArrayOutputStream();
Result res = new StreamResult(baos);
transformer.transform(src, res); 
```

# blackberry - 黑莓外部罐子

> ID：851993
> 
> 赞同：1
> 
> 时间：2009-05-12T09:45:55.613
> 
> 标签：blackberry, java-me, build

我正在使用 JDom jar，我想添加到我的黑莓项目中。我正在为 blacberry 使用 eclipse 插件。从 Eclipse 构建黑莓应用程序时，错误在控制台上显示为

```
"JDOMAbout$info:error!missing stack map @label.... " 
```

该项目的 rapc falied 以及这几个警告也显示出来......所以任何人都遇到过这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-12T14:03:49.507

[堆栈映射是预验证](http://en.wikibooks.org/wiki/J2ME_Programming/MIDlet_Preverify)jar 文件时生成的内容的一部分。听起来你的 jar 还没有准备好 J2ME。假设它与 J2ME 兼容，标准方法是从 .jar 创建一个 .cod 文件，并[在您的项目中引用它](http://www.blackberry.com/knowledgecenterpublic/livelink.exe/fetch/2000/348583/800901/How_To_-_Compile_a_JAR_file_into_a_BlackBerry_Library.html?nodeid=801017&vernum=0)。不幸的是，Eclipse 插件无法做到这一点，但是一旦有了 .cod，就可以在 Eclipse 项目中引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-16T15:34:22.663

[也许您可以在kXML 项目](http://kxml.sourceforge.net/)的 kDom 包中找到一些有用且对 J2ME 更友好的东西

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-13T06:45:40.373

您必须创建一个 Blackberry 存档或库项目（或任何名称）并将您的库添加到其中，然后从您的应用程序项目中引用它。您可能需要也可能不需要使用 Blackberry JDE 来处理 jdp 文件，但我可以保证它可以在 Eclipse 中工作。我们将 kSOAP 库包含在我们的库中，Eclipse 将使用 rapc“构建”它并生成正确的文件（您必须手动完成，通过告诉项目构建）。

不幸的是，我现在没有一个环境来检查事情，但基本的想法是有第二个项目，包括 jar，然后引用它。

所有这些，并且 jar 必须与 J2ME 兼容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-10-06T08:56:14.077

[教程：如何在您的应用程序中使用 3rd 方库](http://supportforums.blackberry.com/rim/board/message?board.id=java_dev&message.id=22441)

# programming-languages - 您对 Falcon 语言有何看法？

> ID：851997
> 
> 赞同：3
> 
> 时间：2009-05-12T09:46:59.230
> 
> 标签：programming-languages, falcon

[Falcon](http://www.falconpl.org/)是一种编程语言，支持多种范式，如消息传递、OO、函数式，但代码看起来又漂亮又干净。

你怎么看，它有机会起飞并被用作通用编程胶水语言吗？值得探索吗？如果您在实际项目中使用它，到目前为止您的印象是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2010-03-03T12:58:56.533

它目前有一个小而活跃的开发者社区，因此它目前处于酷炫功能真正固化的状态。鉴于解释器目前几乎完全未优化，它仍然以非常令人印象深刻的速度运行。

我知道有人在他们的游戏中使用所有脚本（替换 Lua），据我所知，他们发现使用它很愉快。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-09-21T09:37:07.813

我已经下载了。它功能强大、灵活、支持 Unicode，并且可以在实际情况中使用，即作为[AuroraUX](http://www.auroraux.net/index.php/Main_Page)的脚本语言。

> Falcon 是我们选择的脚本语言。“简单、快速且功能强大的编程语言，易于学习且使用起来很舒服，并且脚本引擎已准备好为任务关键型多线程应用程序提供支持。” -- [http://www.auroraux.org/index.php/AuroraUX:关于](http://www.auroraux.org/index.php/AuroraUX:About)

说到 Unicode，这是一个真正的 Falcon 脚本：

```
// International class; name and street
class 国際( なまえ, Straße )
   // set class name and street address
   नाम = なまえ
   شَارِع   =  Straße
   // Say who am I!
   function 言え!()
     >@"I am $(self.नाम) from ",self.شَارِع
   end
end
// all the people of the world! 
民族 = [ 国際( "高田　Friederich", "台湾" ),
   国際( "Smith Σωκράτης", "Cantù" ),
   国際( "Stanisław Lec", "południow" ) ]

for garçon in 民族: garçon.言え!() 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-05-12T11:25:51.237

虽然它看起来很有趣，并且有一些很酷的想法，但我认为学习它并没有多大用处，除非它被用于工业和/或学术界。

编程语言的历史上到处都是伟大的语言，但由于没有人采用它们，它们就被淘汰了。

然而，它们的功能通常被合并到更流行的语言中。

也就是说，Ruby 是在 1993 年创建的，在它被用于 Ruby on Rails 之前很少听说过它。现在它是下一个闪亮的新事物。

所以也许在 2023 年我会吃掉我的话，但是如果 Falcon 是一门很好的语言并且我需要使用它，那么它应该很容易学会它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-20T03:35:00.600

*你怎么看，它有机会起飞并被用作通用编程胶水语言吗？* 没人知道！
*值得探索吗？*我想任何语言都值得一看，
*如果您在实际项目中使用它，到目前为止您的印象是什么？*我没有用过它
今天存在一场比赛，看谁创造了最复杂的语言借用语法。
关于易于阅读的程序，我们可以从汇编语言（和深奥的语言！）出发，跟随接近英语的程序（我最喜欢 C、Java、PHP 和 Delphi），最后是类似英语的程序。例如，COBOL。
¿ 我们真的需要一门新语言吗？很难说。Java 被视为一种新奇事物，并迅速在业界产生了强大的影响力。另一方面，Dart 承诺了很多，但仍然没有听说有人使用它。*猎鹰*将定位
在哪里？只有时间会给出答案。就个人而言，我发现它的语法过于复杂（还有 Java、PHP 和 C）。我多年来一直在使用 Pascal（及其变体）进行编程，并且更喜欢以下内容： 比 C++： 我想所有程序员都有一种最喜欢的（或者在某些情况下只有一种）编程语言。这导致了一句话“当你知道的唯一工具是锤子时，所有问题看起来都像钉子！” （数据库引擎也可以这么说）有多少用户使用工作表创建“数据库”？ *`Writeln('I am ',age,'years old and my zipcode is ',zipcode);`

`cout << "I am " << age << " years old and my zipcode is " << zipcode;`

所以，总而言之，我将探索它来增强我的工具箱，并拥有一把锤子、螺丝刀甚至六分仪！*****