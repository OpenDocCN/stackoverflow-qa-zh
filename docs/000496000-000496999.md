# StackOverflow 问答 000496000-000496999

# python - 是否存在 len(someObj) 不调用 someObj 的 __len__ 函数的情况？

> ID：496009
> 
> 赞同：14
> 
> 时间：2009-01-30T15:58:58.850
> 
> 标签：python, magic-methods

有`len(someObj)`没有不调用someObj`__len__`函数的情况？

我最近用后者替换了前者，以（成功）加快了一些代码的速度。我想确保`len(someObj)`在与`someObj.__len__()`.

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-01-30T20:21:55.093

如果`__len__`返回长度超过`sys.maxsize`，`len()`将引发异常。这不适用于`__len__`直接调用。（实际上，您可以返回任何`__len__`不会被捕获的对象，除非它通过`len()`.）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-30T16:07:33.687

你看到了什么样的加速？我无法想象它很明显是吗？

来自[http://mail.python.org/pipermail/python-list/2002-May/147079.html](http://mail.python.org/pipermail/python-list/2002-May/147079.html)

> 在某些情况下没有区别，但出于几个原因，首选使用 len()。
> 
> 首先，不建议自己去调用`__methods__`，它们是为python的其他部分使用的。
> 
> `len()`将适用于任何类型的序列对象（`lists`、、`tuples`和所有）。 `__len__`仅适用于具有`__len__`方法的类实例。
> 
> `len()`将在没有长度的对象上返回更合适的异常。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T16:03:57.093

我认为答案是它总是有效的——根据 Python 文档：

```
__len__(self): 
```

调用以实现内置函数 len()。应返回对象的长度，整数 >= 0。此外，未定义`__nonzero__()`方法且其`__len__()`方法返回零的对象在布尔上下文中被认为是假的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-05T20:59:31.000

在某些情况下，`len(someObj)`与validates的返回值不同。以下是 Python 3.6.9 中可能出现的错误：`someObj.__len__()``len()``__len__()`

*   太小，即小于0

    ```
    ValueError: __len__() should return >= 0 
    ```

*   太大，即大于`sys.maxsize`（CPython-specific，per the [docs](https://docs.python.org/3.6/reference/datamodel.html#object.__len__)）

    ```
    OverflowError: cannot fit 'int' into an index-sized integer 
    ```

*   无效的类型，例如`float`

    ```
    TypeError: 'float' object cannot be interpreted as an integer 
    ```

*   缺失，例如`len(object)`

    ```
    TypeError: object of type 'type' has no len() 
    ```

    我提到这一点是因为`object.__len__()`引发了一个不同的异常，`AttributeError`.

还值得注意的是这`range(sys.maxsize+1)`是有效的，但它`__len__()`引发了一个例外：

```
OverflowError: Python int too large to convert to C ssize_t 
```

* * *

## 回答 #5

> 赞同：-4
> 
> 时间：2009-01-30T16:01:46.413

根据马克朝圣者的说法，它看起来不像。 与;`len(someObj)`相同`someObj.__len__()`

干杯!

# java - 你推荐什么 Java 的 CVS 客户端？

> ID：496012
> 
> 赞同：0
> 
> 时间：2009-01-30T16:00:13.560
> 
> 标签：java, cvs

我正在寻找一个嵌入到我的 Java 应用程序中的 CVS 客户端。你有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T16:03:31.697

试试[JavaCVS](http://javacvs.netbeans.org/library/)。哦，是的，并且重复数十人无疑会添加到这个问题的内容，如果在您的系统中完全可以使用 SVN 而不是 CVS，那就去做吧。

# iphone - iPhone SDK - 将项目从 2.1 转换为 2.2.1

> ID：496017
> 
> 赞同：1
> 
> 时间：2009-01-30T16:01:29.220
> 
> 标签：iphone, cocoa-touch, xcode

刚刚在网上看到一篇文章说2.2.1不支持以前的sdk。我想知道这意味着什么？我刚刚下载了 2.2.1 并想使用更新/最新的 API 框架。

如何转换我的项目，以便它使用 2.2.1 版中更新/最新的 API/框架？是否需要任何特殊步骤，或者我应该只是 1.) 删除 2.1 和 2.) 安装 2.2.1，和 3.) 删除框架并从 iPhoneOS2.2.sdk 目录重新加载它们，这将起到神奇的作用。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T19:49:19.667

安装是安全的。你不必“转换”任何东西。您的项目将继续有效。2.2.1 中没有新的 API。该文档是一个单独的页面，告诉您参考 2.2 文档。

# sql - T-SQL 从开始日期到结束日期按月缺勤

> ID：496018
> 
> 赞同：0
> 
> 时间：2009-01-30T16:01:36.553
> 
> 标签：sql, tsql, sql-server-2000

我有一个有趣的查询要做，并试图找到最好的方法。基本上我在我们的人事数据库中有一个缺勤表，它记录了员工ID，然后是缺勤的开始日期和结束日期。如果尚未输入（未返回），则结束日期为空。我不能改变设计。

他们希望按月报告缺勤次数（12 个月趋势）。由于员工在一个月内休假，因此显然可能难以计算。

例如，员工于 2008 年 11 月 25 日至 08 年 5 月 12 日（日/月/年）休假。我希望 11 月的日子进入 11 月的计数，而 12 月的日子则进入 12 月的计数。

我目前正在考虑为了计算我需要将开始日期和结束日期分隔到缺勤每一天的记录中的天数，将其分配给它所在的月份。然后对数据进行分组以进行报告。至于那些没有结束日期的我会假设 null 是当前日期，因为它们目前仍然不存在。

最好的方法是什么？

还有更好的方法吗？

编辑：这是目前的 SQL 2000 服务器。希望尽快升级。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T16:11:51.430

我有一个类似的问题，其中有一个为数据存储而设计的开始/结束日期表，但不是为报告而设计的。

我找到了“最快执行”的解决方案，发现它是创建一个包含每月值的第二张表。我用 2000 年 1 月到 2070 年 1 月的几个月来填充它。我期待它就足够了，或者我会在 2070 年获得一大笔工资支票来更新它......

```
DECLARE TABLE months (start DATETIME)
-- Populate with all month start dates that may ever be needed
-- And I would recommend indexing / primary keying by start

SELECT
    months.start,
    data.id,
    SUM(CASE WHEN data.start < months.start
            THEN DATEDIFF(DAY, months.start, data.end)
            ELSE DATEDIFF(DAY, data.start, DATEADD(month, 1, months.start))
        END) AS days
FROM
    data
INNER JOIN
    months
        ON data.start < DATEADD(month, 1, months.start)
        AND data.end > months.start
GROUP BY
   months.start,
   data.id 
```

由于各种原因，该连接可能会很慢，我将搜索另一个问题的另一个答案，以说明为什么以及如何优化连接。

编辑：

这是与重叠日期范围以及如何加快连接速度有关的另一个答案...

[查询最大同时事件数](https://stackoverflow.com/questions/452499/query-max-number-of-simultaneous-events/453180#453180)

# algorithm - 我将如何实现这个算法？

> ID：496026
> 
> 赞同：9
> 
> 时间：2009-01-30T16:04:06.440
> 
> 标签：algorithm, compression, brute-force

不久前，我试图暴力破解发送 12 位二进制“密钥”的遥控器。

我制作的设备可以工作，但速度很慢，因为它以每秒约 50 位的速度尝试每种组合（4096 个代码 = 49152 位 = 约 16 分钟）

我打开接收器，发现它正在使用移位寄存器来检查代码，并且尝试之间不需要延迟。这意味着接收器只是查看要接收的最后 12 位，以查看它们是否与密钥匹配。

这意味着如果流`111111111111000000000000`被发送，它已经有效地尝试了所有这些代码。

```
111111111111    111111111110    111111111100    111111111000
111111110000    111111100000    111111000000    111110000000
111100000000    111000000000    110000000000    100000000000
000000000000 
```

在这种情况下，我使用 24 位来尝试 13 种 12 位组合（>90% 压缩）。

有谁知道可以利用这一点减少我发送的 49152 位的算法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-30T16:30:49.410

您在说的是[de Bruijn 序列](http://en.wikipedia.org/wiki/De_Bruijn_sequence)。如果你不关心它是如何工作的，你只想要结果，[这里是](http://www.hakank.org/comb/debruijn.cgi?k=2&n=12&submit=Ok).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T16:13:41.427

在我的脑海中，我想在每个 12 位序列中翻转一位会处理另外 13 种组合，例如 111111111101000000000010，然后是 1111111110110000000000100 等。但是你仍然需要做很多排列，即使我有一个位认为你仍然需要做 111111111101000000000100 等。然后在一侧翻转两位，在另一侧翻转 1，等等。

# c++ - IsBadReadPtr 的最有效替代品？

> ID：496034
> 
> 赞同：9
> 
> 时间：2009-01-30T16:05:43.613
> 
> 标签：c++, windows, visual-c++, memory

我有一些 Visual C++ 代码接收指向缓冲区的指针，其中包含需要由我的代码处理的数据以及该缓冲区的长度。由于我无法控制的错误，有时此指针未初始化或不适合读取我的代码（即当我尝试访问缓冲区中的数据时它会导致崩溃。）

所以，我需要在使用它之前验证这个指针。我不想使用 IsBadReadPtr 或 IsBadWritePtr，因为每个人都同意它们是错误的。（谷歌他们的例子。）它们也不是线程安全的——在这种情况下这可能不是问题，尽管线程安全的解决方案会很好。

我在网上看到了通过使用 VirtualQuery 或仅在异常处理程序中执行 memcpy 来完成此任务的建议。但是，需要执行此检查的代码是时间敏感的，因此我需要最有效的检查，而且也是 100% 有效的。任何想法，将不胜感激。

只是要明确一点：我知道最好的做法是只读取错误的指针，让它导致异常，然后将其追溯到源并修复实际问题。但是，在这种情况下，错误指针来自我无法控制的 Microsoft 代码，因此我必须验证它们。

另请注意，我不在乎指向的数据是否有效。我的代码正在寻找特定的数据模式，如果没有找到它们将忽略这些数据。我只是想防止在对这些数据运行 memcpy 时发生崩溃，并且在尝试 memcpy 时处理异常将需要更改遗留代码中的十几个位置（但如果我有类似 IsBadReadPtr 的调用我只会必须在一处更改代码）。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2016-02-23T11:48:04.150

```
bool IsBadReadPtr(void* p)
{
    MEMORY_BASIC_INFORMATION mbi = {0};
    if (::VirtualQuery(p, &mbi, sizeof(mbi)))
    {
        DWORD mask = (PAGE_READONLY|PAGE_READWRITE|PAGE_WRITECOPY|PAGE_EXECUTE_READ|PAGE_EXECUTE_READWRITE|PAGE_EXECUTE_WRITECOPY);
        bool b = !(mbi.Protect & mask);
        // check the page is not a guard page
        if (mbi.Protect & (PAGE_GUARD|PAGE_NOACCESS)) b = true;

        return b;
    }
    return true;
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-30T16:17:19.080

> 一个线程安全的解决方案会很好

我猜只有 IsBadWritePtr 不是线程安全的。

> 只是在异常处理程序中执行 memcpy

这实际上是 IsBadReadPtr 正在做的事情......如果您在代码中执行此操作，那么您的代码将具有与 IsBadReadPtr 实现相同的错误：http: [//blogs.msdn.com/oldnewthing/archive/2006/09/ 27/773741.aspx](http://blogs.msdn.com/oldnewthing/archive/2006/09/27/773741.aspx)

**- 编辑： -**

我读到的 IsBadReadPtr 的唯一问题是错误指针可能指向（因此您可能会不小心触摸）堆栈的保护页。也许您可以通过以下方式避免这个问题（因此可以安全地使用 IsBadReadPtr）：

*   了解您的进程中正在运行哪些线程
*   知道线程的堆栈在哪里，它们有多大
*   在开始调用 isBadReadPtr 之前，遍历每个堆栈，故意触摸堆栈的每个页面至少一次

此外，与上述 URL 相关的一些评论也建议使用 VirtualQuery。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-30T16:22:07.587

这些功能不好用的原因是不能可靠地解决问题。

如果您正在调用的函数返回一个指向已分配内存的指针，那么它*看起来*是有效的，但它指向的是其他不相关的数据，并且如果您使用它会损坏您的应用程序。

最有可能的是，您调用的函数实际上行为正确，而您正在滥用它。（不能保证，但*通常*是这样。）

它是哪个功能？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-05-31T13:59:10.113

我能想到的最快的解决方案是咨询虚拟内存管理器[`VirtualQuery`](https://msdn.microsoft.com/en-us/library/windows/desktop/aa366902(v=vs.85).aspx)，看看给定地址是否有可读页面，并*缓存结果*（但是任何缓存都会降低检查的准确性）。

示例（无缓存）：

```
BOOL CanRead(LPVOID p)
{
  MEMORY_BASIC_INFORMATION mbi;
  mbi.Protect = 0;
  ::VirtualQuery(((LPCSTR)p) + len - 1, &mbi, sizeof(mbi));
  return ((mbi.Protect & 0xE6) != 0 && (mbi.Protect & PAGE_GUARD) == 0);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T16:23:58.270

为什么不能调用api

AfxIsValidAddress((p), sizeof(type), FALSE));

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-09-15T17:49:48.033

如果变量未初始化，您将被冲洗掉。迟早它会成为你不想玩的东西的地址（比如你自己的堆栈）。

如果你认为你需要这个，并且 (uintptr_t)var < 65536 还不够（Windows 不允许分配底部 64k），那么没有真正的解决方案。VirtualQuery 等似乎“工作”，但迟早会烧毁你。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T16:13:56.560

恐怕你不走运 - 没有办法可靠地检查指针的有效性。什么 Microsoft 代码给了你不好的指示？

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T19:12:52.690

检查内存有效性的任何实现都受制于使 IsBadReadPtr 失败的相同约束。您能否发布一个示例调用堆栈，用于检查从 Windows 传递给您的指针的内存有效性？这可能会帮助其他人（包括我）首先诊断您为什么需要这样做。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-01-03T16:31:52.207

如果您必须求助于检查数据中的模式，这里有一些提示：

*   如果您提到使用 IsBadReadPtr，您可能正在为 Windows x86 或 x64 进行开发。

*   您也许可以对指针进行范围检查。指向对象的指针将是字对齐的。在 32 位窗口中，用户空间指针在 0x00401000-0x7FFFFFFF 范围内，或者对于大地址感知应用程序，改为 0x00401000-0xBFFFFFFF（编辑：0x00401000-0xFFFF0000 用于 64 位窗口上的 32 位程序） . 上面的 2GB/1GB 是为内核空间指针保留的。

*   对象本身将存在于不可执行的读/写内存中。它可能存在于堆中，也可能是全局变量。如果它是一个全局变量，您可以验证它是否位于正确的模块中。

*   如果您的对象有一个 VTable，并且您没有使用其他类，请将其 VTable 指针与来自已知良好对象的另一个 VTable 指针进行比较。

*   范围检查变量以查看它们是否可能有效。例如，bools 只能是 1 或 0，所以如果你看到一个值为 242，那显然是错误的。指针也可以进行范围检查和对齐检查。

*   如果其中包含对象，请同时检查其 VTable 和数据。

*   如果有指向其他对象的指针，您可以检查该对象是否存在于可读写且不可执行的内存中，如果适用，请检查 VTable，以及范围检查数据。

如果没有已知 VTable 地址的好对象，可以使用以下规则检查 VTable 是否有效：

*   虽然对象存在于读/写内存中，并且 VTable 指针是对象的一部分，但 VTable 本身将存在于只读且不可执行的内存中，并将与字边界对齐。它也将属于该模块。
*   VTable 的条目是指向代码的指针，它将是只读和可执行的，而不是可写的。代码地址没有对齐限制。代码将属于该模块。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-12-19T12:09:29.313

这是我使用的，它只是通过使用`#define`'s 替换官方的 microsoft 的，这样您就可以使用 microsoft 的，而不必担心它们会让您失望。

```
// Check memory address access
const DWORD dwForbiddenArea = PAGE_GUARD | PAGE_NOACCESS;
const DWORD dwReadRights = PAGE_READONLY | PAGE_READWRITE | PAGE_WRITECOPY | PAGE_EXECUTE_READ | PAGE_EXECUTE_READWRITE | PAGE_EXECUTE_WRITECOPY;
const DWORD dwWriteRights = PAGE_READWRITE | PAGE_WRITECOPY | PAGE_EXECUTE_READWRITE | PAGE_EXECUTE_WRITECOPY;

template<DWORD dwAccessRights>
bool CheckAccess(void* pAddress, size_t nSize)
{
    if (!pAddress || !nSize)
    {
        return false;
    }

    MEMORY_BASIC_INFORMATION sMBI;
    bool bRet = false;

    UINT_PTR pCurrentAddress = UINT_PTR(pAddress);
    UINT_PTR pEndAdress = pCurrentAddress + (nSize - 1);

    do
    {
        ZeroMemory(&sMBI, sizeof(sMBI));
        VirtualQuery(LPCVOID(pCurrentAddress), &sMBI, sizeof(sMBI));

        bRet = (sMBI.State & MEM_COMMIT) // memory allocated and
            && !(sMBI.Protect & dwForbiddenArea) // access to page allowed and
            && (sMBI.Protect & dwAccessRights); // the required rights

        pCurrentAddress = (UINT_PTR(sMBI.BaseAddress) + sMBI.RegionSize);
    } while (bRet && pCurrentAddress <= pEndAdress);

    return bRet;
}

#define IsBadWritePtr(p,n) (!CheckAccess<dwWriteRights>(p,n))
#define IsBadReadPtr(p,n) (!CheckAccess<dwReadRights>(p,n))
#define IsBadStringPtrW(p,n) (!CheckAccess<dwReadRights>(p,n*2)) 
```

这种方法基于我对 Raymond Chen 的博客文章的理解，[如果我不应该调用 IsBadXxxPtr，我如何检查指针是否坏？](https://devblogs.microsoft.com/oldnewthing/20100723-00/?p=13343)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-08T16:27:11.847

这是一个老问题，但这部分：

> 需要进行此检查的代码是时间敏感的，所以我需要最有效的检查，而且也是 100% 有效的

VirtualQuery() 接受内核调用，因此对于大部分时间都可以读取内存的情况，异常处理程序中的简单 memcpy() 会更快。

```
__try
{
  memcpy(dest, src, size);
}__except(1){} 
```

当没有异常时，所有都保持在用户模式。对于内存不好读多于好的用例可能会慢一些（因为它会引发异常，这是通过内核往返的往返）。

您还可以使用自定义 memcpy 循环和 *size 对其进行扩展，以便您可以准确返回实际读取的字节数。

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2009-01-30T18:58:02.343

如果您使用的是 VC++，那么我建议使用微软特定的关键字 __try __except 来捕获硬件异常

# java - 从 sun 应用程序服务器中删除 server.policy

> ID：496050
> 
> 赞同：1
> 
> 时间：2009-01-30T16:11:38.717
> 
> 标签：java

`java.lang.StackOverflowError`部署 Java Web 应用程序 ( ) 后遇到错误`.war`。如果我删除`server.policy`文件。我不会遇到这个错误，但这意味着没有安全性。我意识到如果我包含以下`server.policy`默认情况下包含权限的内容，则会发生错误`java.lang.RuntimePermission`- `modifyThreadGroup`;

如果在`server.policy`文件中，我只是删除此权限`java.lang.RuntimePermission` - `modifyThreadGroup`;

我将被拒绝访问，因为默认情况下安全管理器将检查此权限。

任何人都知道出了什么问题，我该如何解决？

`java.lang.StackOverflowError`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T16:26:51.930

启用安全性的明显方法`StackOverflowError`是不提供涉及安全检查权限的代码。所以我想这与您的配置有关，可能是 codeBase 已更改或完全相同的代码出现在被授予权限的代码之前的搜索顺序中。

# javascript - jQuery - 通过文本描述设置选择控件的选定值

> ID：496052
> 
> 赞同：544
> 
> 时间：2009-01-30T16:12:17.297
> 
> 标签：javascript, jquery

我有一个选择控件，在一个 javascript 变量中我有一个文本字符串。

使用 jQuery，我想将选择控件的选定元素设置为具有我拥有的文本描述的项目（而不是我没有的值）。

我知道按值设置它非常简单。例如

```
$("#my-select").val(myVal); 
```

但我有点难过通过文字描述来做这件事。我想一定有一种方法可以从文本描述中获取价值，但我的大脑在星期五下午太忙了，无法解决。

* * *

## 回答 #1

> 赞同：776
> 
> 时间：2009-01-30T16:25:11.997

## jQuery v1.6+ 按描述选择

```
var text1 = 'Two';
$("select option").filter(function() {
  //may want to use $.trim in here
  return $(this).text() == text1;
}).prop('selected', true);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<select>
  <option value="0">One</option>
  <option value="1">Two</option>
</select>
```

## [jQuery 版本低于 1.6 且大于等于 1.4](https://stackoverflow.com/a/3644500/31532)

```
var text1 = 'Two';
$("select option").filter(function() {
  //may want to use $.trim in here
  return $(this).text() == text1;
}).attr('selected', true);
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.4.0/jquery.min.js"></script>

<select>
  <option value="0">One</option>
  <option value="1">Two</option>
</select>
```

请注意，虽然此方法适用于高于 1.6 但低于 1.9 的版本，但自 1.6 起已被弃用。它*[不适](https://stackoverflow.com/questions/14366220/optionselected-not-working-jquery-1-9)*用于 jQuery 1.9+。

* * *

## 之前的版本

`val()`应该处理这两种情况。

```
$('select').val('1'); // selects "Two"
$('select').val('Two'); // also selects "Two"
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.2.3/jquery.min.js"></script>

<select>
  <option value="0">One</option>
  <option value="1">Two</option>
</select>
```

* * *

## 回答 #2

> 赞同：146
> 
> 时间：2009-01-30T16:22:59.363

我没有测试过这个，但这可能对你有用。

```
$("select#my-select option")
   .each(function() { this.selected = (this.text == myVal); }); 
```

* * *

## 回答 #3

> 赞同：93
> 
> 时间：2009-01-30T16:51:28.760

试试这个...选择带有文本 myText 的选项

```
$("#my-Select option[text=" + myText +"]").prop("selected", true); 
```

* * *

## 回答 #4

> 赞同：49
> 
> 时间：2015-09-15T15:17:32.537

我这样做（jQuery 1.9.1）

```
$("#my-select").val("Dutch").change(); 
```

注意：不要忘记更改（），因此我不得不搜索很长时间:)

* * *

## 回答 #5

> 赞同：21
> 
> 时间：2009-01-30T16:36:25.967

```
$("#myselect option:contains('YourTextHere')").val(); 
```

将返回包含您的文本描述的第一个选项的值。对此进行了测试并且有效。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2013-05-08T15:49:51.690

为了避免所有 jQuery 版本的复杂性，老实说，我建议使用这些非常简单的 javascript 函数之一......

```
function setSelectByValue(eID,val)
{ //Loop through sequentially//
  var ele=document.getElementById(eID);
  for(var ii=0; ii<ele.length; ii++)
    if(ele.options[ii].value==val) { //Found!
      ele.options[ii].selected=true;
      return true;
    }
  return false;
}

function setSelectByText(eID,text)
{ //Loop through sequentially//
  var ele=document.getElementById(eID);
  for(var ii=0; ii<ele.length; ii++)
    if(ele.options[ii].text==text) { //Found!
      ele.options[ii].selected=true;
      return true;
    }
  return false;
} 
```

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2013-12-12T19:42:22.537

这条线有效：

```
$("#myDropDown option:contains(myText)").attr('selected', true); 
```

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2013-10-02T13:54:57.010

我知道这是一篇旧文章，但我无法使用 jQuery 1.10.3 和上述解决方案通过文本选择它。我最终使用了以下代码（spoulson 解决方案的变体）：

```
 var textToSelect = "Hello World";

      $("#myDropDown option").each(function (a, b) {
            if ($(this).html() == textToSelect ) $(this).attr("selected", "selected");
        }); 
```

希望它可以帮助某人。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2011-07-07T13:14:29.737

```
 $("#Test").find("option:contains('two')").each(function(){
     if( $(this).text() == 'two' ) {
        $(this).attr("selected","selected");
     }
 }); 
```

if 语句与“二”完全匹配，“二三”将不匹配

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2012-08-31T16:01:56.940

1.7+ 最简单的方法是：

```
$("#myDropDown option:text=" + myText +"").attr("selected", "selected"); 
```

1.9+

```
$("#myDropDown option:text=" + myText +"").prop("selected", "selected"); 
```

测试和工作。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2017-09-07T04:34:31.067

这是非常简单的方法。请使用它

```
$("#free").val("y").change(); 
```

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2009-01-30T16:59:46.607

看看[jquery selectedbox插件](http://www.texotela.co.uk/code/jquery/select/)

```
selectOptions(value[, clear]): 
```

按值选择选项，使用字符串作为参数`$("#myselect2").selectOptions("Value 1");`，或正则表达式`$("#myselect2").selectOptions(/^val/i);`。

您还可以清除已选择的选项：`$("#myselect2").selectOptions("Value 2", true);`

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-06-01T07:33:25.070

只是在旁注。我选择的值没有被设置。我在网上到处搜索。实际上，我必须在从 Web 服务回调后选择一个值，因为我正在从中获取数据。

```
$("#SelectMonth option[value=" + DataFromWebService + "]").attr('selected', 'selected'); 
$("#SelectMonth").selectmenu('refresh', true); 
```

所以选择器的刷新是我唯一缺少的东西。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-06-17T11:59:21.637

我发现通过使用`attr`您最终会选择多个选项，而您不想这样做 - 解决方案是使用`prop`：

`$("#myDropDown option:text=" + myText +"").prop("selected", "selected");`

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2012-01-18T13:39:38.973

我在上面的示例中遇到了问题，问题是由于我的选择框值预先填充了 6 个字符的固定长度字符串，但传入的参数不是固定长度。

我有一个 rpad 函数，它将正确填充一个字符串，到指定的长度，并使用指定的字符。因此，在填充参数后它可以工作。

```
$('#wsWorkCenter').val(rpad(wsWorkCenter, 6, ' '));

function rpad(pStr, pLen, pPadStr) {
if (pPadStr == '') {pPadStr == ' '};
while (pStr.length < pLen)
    pStr = pStr + pPadStr;
return pStr; 
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2014-09-16T14:22:24.467

```
 $('#theYear').on('change', function () {
 FY = $(this).find('option:selected').text();
 $('#theFolders').each(function () {
     $('option:not(:contains(' + FY + '))', this).hide();
 });
 $('#theFolders').val(0);
});

$('#theYear').on('mousedown', function () {
 $('#theFolders option').show().find('option:contains("Select")', this).attr('selected', 'selected');
}); 
```

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2020-08-03T21:12:48.547

尝试

```
[...mySelect.options].forEach(o=> o.selected = o.text == 'Text C' ) 
```

```
[...mySelect.options].forEach(o=> o.selected = o.text == 'Text C' );
```

```
<select id="mySelect">
  <option value="A">Text A</option>
  <option value="B">Text B</option>
  <option value="C">Text C</option>
</select>
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2015-01-16T18:30:26.967

这是一个简单的选择。只需设置您的列表选项，然后将其文本设置为选定值：

```
$("#ddlScheduleFrequency option").selected(text("Select One...")); 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-04-22T15:48:31.977

这个接受的答案似乎不正确，而 .val('newValue') 对函数是正确的，尝试按名称检索选择对我不起作用，我不得不使用 id 和类名来获取我的元素

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2020-07-10T09:38:02.250

非常繁琐，似乎没有其他工作

$('select[name$="dropdown"]').children().text("Mr").prop("selected", true);

为我工作。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2020-10-15T07:06:25.610

如果您尝试将 select 与 ID 绑定，那么以下代码对我有用。

```
<select name="0product_id[]" class="groupSelect" id="groupsel_0" onchange="productbuilder.update(this.value,0);">
    <option value="0" class="notag" id="id0_0">--Select--</option>
    <option class="notag" value="338" id="id0_338"  >Dual Promoter Puromycin Expression Plasmid - pSF-CMV-PGK-Puro  > £114.00</option>
    <option class="notag" value="282" id="id0_282"  >EMCV IRES Puromycin Expression Plasmid - pSF-CMV-EMCV-Puro  > £114.00</option>
    <option class="notag" value="265" id="id0_265"  >FMDV IRES Puromycin Expression Plasmid - pSF-CMV-FMDV-Puro  > £114.00</option>
    <option class="notag" value="101" id="id0_101"  >Puromycin Selection Plasmid - pSF-CMV-Ub-Puro AscI  > £114.00</option>
    <option class="notag" value="105" id="id0_105"  >Puromycin Selection SV40 Ori Plasmid - pSF-CMV-Ub-Puro-SV40 Ori SbfI  > £114.00</option></select> 
```

这是 TEH JS 代码

```
$( document ).ready(function() {
      var text = "EMCV IRES Puromycin Expression Plasmid - pSF-CMV-EMCV-Puro  > £114.00";
      alert(text);
$("#groupsel_0 option").filter(function() {
  //may want to use $.trim in here
  return $(this).text() == text;
}).prop('selected', true);
}); 
```

* * *

## 回答 #22

> 赞同：-1
> 
> 时间：2009-01-30T16:23:15.900

获取选择框的孩子；遍历它们；找到所需的选项后，将其设置为选定选项；返回 false 停止循环。

# windows - 没有声卡的 DirectSound/FFDShow

> ID：496053
> 
> 赞同：0
> 
> 时间：2009-01-30T16:12:19.947
> 
> 标签：windows, 64-bit, directsound, ffdshow

我有一个使用 DirectShow/DirectSound 的应用程序，它可以播放视频并提取视频/声音。在没有声卡的服务器上运行它意味着无法抓取音频，有没有办法解决这个问题？我简要地看了一下 Virtual Audio Cable 4，但这似乎并没有在终端会话中模拟声卡..

棘手的部分是它在 x64 上运行，所以我可能有点受限..

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T17:12:21.620

VAC 确实可以解决问题，但它在某种程度上受到限制，因为当您通过 RDP 会话连接到服务器时它不起作用。

目前我已经通过在 VNC 上启动进程来解决这个问题......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-23T12:20:00.710

我还没有测试过，但是，请确保您将“RDP -> 选项 -> 本地资源 -> 远程计算机声音”设置为“住在远程计算机上”，否则您将找不到任何音频播放器。

# sharepoint - 在 SharePoint 中显示 SSRS 报告？

> ID：496055
> 
> 赞同：11
> 
> 时间：2009-01-30T16:12:43.973
> 
> 标签：sharepoint, reporting-services

我有一系列由 SSRS 提供的报告。他们很棒，用户喜欢他们。

在这种情况下，高层管理人员希望投入工作并提供来自 Sharepoint 服务器的报告。

是否有一种真正轻松的方式让用户从 sharepoint 访问报告？有人怎么会去做这样的事情？还是我只需要硬着头皮努力阻止这种疯狂？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-30T16:46:59.877

我不确定您使用的是哪个版本的 SSRS 或 Sharepoint，但传统上，RSWebParts.CAB 文件中的 Sharepoint 附带了 Report Viewer 和 Report Explorer Web 部件（我认为至少从 SQL Server 2005 SP2 开始） ）。您可以从那里开始，但如果您想要快速和低技术，您可以放入 IFRAME Web 部件并将其指向 SSRS 服务器上的 Reports 文件夹。由于您使用的是 Sharepoint，因此也假设您使用的是 Windows 身份验证，因此这不会成为问题。

这是一个可能有用的链接： [使用 SharePoint 2.0 Web 部件查看报告](http://msdn.microsoft.com/en-us/library/ms159772.aspx)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-08-31T15:18:15.647

最简单的方法是在本机模式下运行 SSRS，这听起来就像您已经在做的那样，然后在您的 WSS/MOSS 服务器上安装 SSRS Web 部件。

您将不得不使用除了 sharepoint 之外的其他一些方法来管理安全性和报告源控制，但是您不必处理在 SSRS 框上安装 WSS/MOSS 并将其添加到您的 SharePoint 场。

更痛苦的选择是以集成模式运行 SSRS。这允许您将所有 SharePoint 文档管理内容用于您的报告并共享相同的安全设置，但是，服务器配置可能很长且难以设置。

[http://msdn.microsoft.com/en-us/library/bb677365.aspx](http://msdn.microsoft.com/en-us/library/bb677365.aspx)

希望这可以帮助！

本

# c# - c# 我是否正确处理多个线程

> ID：496057
> 
> 赞同：4
> 
> 时间：2009-01-30T16:13:17.310
> 
> 标签：c#, multithreading

我有一个 winform 应用程序，它创建 5 个线程以连接到数据库并以非常慢的连接（某些查询需要 90 秒）从数据库中检索信息。每个线程都有自己的类实例，用于执行 sql 查询。当查询的数据被检索到时，主线程会收到运行查询的类触发的事件的通知。接收到事件后，主线程的各个组件都会更新，例如显示项目或只是保存数据以供以后使用的数据表。根据查询的信息类型，查询以不同的间隔重复。

一切都很好......但我不开心。我觉得应该以不同的方式完成，但我不确定哪种方式。

以下是我当前设置每个线程的方式：

```
string ConnectionString = @"Data Source=mySrv;Initial Catalog=myTbl;Connect Timeout=30;UID=sa;pwd=mypwd";

//thread #1    
 SQL_Requests ReasonRequests;
 Thread Reason_Thread;
 ReasonRequests = new SQL_Requests();
 ReasonRequests.ProcessFinished += new SQL_Requests.ProcessFinished(ReasonRequests_Completed);
 Reason_Thread = new Thread(ReasonRequests.ExecuteQuery);
 ReasonRequests.DBQueryString = "select * from ReasonTable where staralingment = goodalignment"
 ReasonRequests.DBConnection = ConnectionString;

//thread #2
SQL_Requests EventRequests; 
Thread Event_Thread;
EventRequests = new SQL_Requests();
EventRequests.ProcessFinished += new SQL_Requests.ProcessFinished(EventRequests_Completed);
Event_Thread= new Thread(EventRequests.ExecuteQuery);

EventRequests.DBQueryString = "select * from EventTable where somefield = somevalue"
EventRequests.DBConnection = ConnectionString; 
```

每个 Thread.start 都在不同的时间间隔。

有什么建议吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T17:26:07.817

而不是旋转你自己的线程，你应该看看执行查询的异步方法，即[http://msdn.microsoft.com/en-ca/library/system.data.sqlclient.sqlcommand.beginexecutereader.aspx](http://msdn.microsoft.com/en-ca/library/system.data.sqlclient.sqlcommand.beginexecutereader.aspx)

您提到您的连接速度很慢，是低带宽连接还是高延迟连接？如果由于带宽不足而导致数据返回缓慢，则触发多个查询只会使事情变慢。如果这只是一个延迟问题，一次执行多个查询可能会提高响应能力。

如果您正在执行一组相关查询，您可能还需要考虑将它们分组到一个命令中，或者使用存储过程在服务器上对它们进行分组。您可以通过使用 SqlDataReader 上的 NextResult 方法来获取其他结果集。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T17:03:56.693

如果您的线程通过非常慢的连接从同一服务器获取数据（意味着有限的带宽是主要因素），您将不会通过使用多个线程获得任何收益。

OTOH 实际上，对所有数据获取操作使用单个线程可能会更好：

*   一段时间后，您将获得一部分数据，因此您可以使用它来更新 UI。并行取可能会分割带宽，你会很长时间没有任何数据，最终结果会一个接一个地到达。这样你的 UI 会显得反应迟钝。

*   如果选择在服务器上导致大量 I/O，那么不让它们并行执行实际上可能会导致更好的吞吐量。考虑到其他操作也会在服务器上执行。

恕我直言，您应该将提取保留在一个线程中以获得最佳的 UI 响应，但只使用一个。

**编辑：**您在评论中声明获取可能需要不同的时间。如果您可以估计哪些查询将最快地完成传输，请先执行它们。当然仍然假设大部分时间是数据传输，而不是服务器上的查询执行。

如果您无法估计查询需要多长时间，或者如果带宽不是唯一的限制，那么使用多线程当然可能最适合您。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T16:55:34.277

您想要这样做的典型原因是，如果 5 个数据库查询中的每一个都很长，并且通过并行运行它们可以获得一些性能提升。如果您不打算从这样做中获得性能提升，我会简单地使用**一个**线程来完成数据库工作并将其进度报告给 UI。

如果并行处理有性能优势，我会使用内置的线程池（System.Threading.ThreadPool.QueueUserWorkItem）。除非您需要对线程进行更多控制，否则线程池非常适合“即发即弃”类型的操作。您将操作排队，并在完成后调用委托。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T16:26:18.623

在不知道细节的情况下，这也会在我的嘴里留下不好的味道。我确信它有效。是否危险取决于您的主类是否是线程安全的。听起来您需要进行一些认真的测试：当两个请求同时完成时会发生什么，而这两个请求都只是用相同的数据做了一些事情。

老实说，如果我要寻找一种“不同的方式”来做到这一点，我可能会跳过对数据库的多线程访问，让一个线程完成所有数据库工作，而工作线程则完成任何需要的额外工作发生（如果有的话），然后报告回主线程以进行数据库访问。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-23T10:17:48.190

不要使用纯线程来开发并​​发软件，还请考虑任务并行性。

请阅读以下文章： [http://blog.rednael.com/2009/02/05/ParallelProgrammingUsingTheParallelFramework.aspx](http://blog.rednael.com/2009/02/05/ParallelProgrammingUsingTheParallelFramework.aspx) [http://blog.rednael.com/2009/03/16/ParallelFrameworkDownloadAndSupport.aspx](http://blog.rednael.com/2009/03/16/ParallelFrameworkDownloadAndSupport.aspx)

这些是有关基本并行编程的文章，还包含对有关并行背景的其他文章的参考。包括 C# .Net 中的示例。此外，它还描述了一个轻量级的并行框架来处理任务。与其他一些框架相比，这个框架非常轻巧且易于使用。阅读这些文章后，您应该能够使用并行性编写代码。

问候，马丁

# project-management - 你如何告诉你的客户他们不知道你的专长？

> ID：496064
> 
> 赞同：4
> 
> 时间：2009-01-30T16:14:01.630
> 
> 标签：project-management

您和我都想成为计算机编程或网站设计方面的专家，但有时客户宁愿尝试您的专业，也不愿专注于房地产销售、营销或成为以色列军队的前成员。然后我们有一个选择：要么弄清楚如何告诉棘手的客户，他们的标志在 3-d 中用正义的镜头光晕旋转会更好，或者可能会因为直接反对让链接文本尽可能冗长而遭受小小的侮辱。任何曾经写过的风格指南。

您是否能够说服您的客户专注于他们受过培训的任何事情，以便他们让您尽最大努力执行您的技术技能？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T16:19:34.597

我总是试图在设计方面为我的客户指明正确的方向。有时这是不可能的；他们想要一些糟糕的设计，但他们确信这对他们的系统至关重要。如果他们在一个适度的推销之后不相信，我只是做他们想做的事。毕竟，他们是支付我（通常）数千美元来构建他们的规格的人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T16:47:05.557

诀窍是让他们做出正确的决定，但认为这是他们的想法。:-)

你不能在抽象的情况下轻松地与他们进行这种对话，但你可以深入研究并引导他们在每个单独的决定中走向正义的一面。最终，在你经历了几次之后，他们会开始信任你。

**如果可能的话，等待一天**会有所帮助。明天他们可能不太清楚他们到底要求什么。（他们是否真的把心放在了一个燃烧的标志上，还是只是一时兴起？）然后，在你的回应中，你：描述你推荐的东西，以及为什么。重申商定的目标，并展示解决方案如何满足目标。**让它听起来像是他们的**主意。（“你昨天关于 xxx 的观点非常好，我认为这提出了一个 yyy 解决方案。”）

在这一点上，你有一个选择。理想情况下，您可以假装从未听过他们愚蠢的建议。或者，如果您觉得必须这样做，请巧妙地回应并解释成本。（“我有点担心动画标志的想法，因为它可能无法按照您要求的方式传达品牌形象。当然，如果您想走这条路，我们当然可以——在这种情况下，我建议我们让我们的平面设计顾问参与进来。如果您想进一步探索这个问题并从顾问那里获得他的服务报价，请告诉我。”）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T16:53:38.070

**客户想要参与的原因通常是他们有意或无意地担心您不了解他们的业务细节或他们是如何做的。**

最好的方法是与客户一起学习他们的业务。这涉及零假设和学习他们的业务“他们是如何做的”。从那里，发现他们使用的所有数据，数据在他们的过程中处于什么状态。

继续把它还给他们，最终他们会意识到，你不仅了解他们的东西、他们想要什么以及他们想要进入的方向，而且你甚至可能比他们更了解其中的含义或影响。

在此之后，它们通常会远离你的头发。但是，在与微观管理类型或工程师一起工作时，这可能会很困难。从本质上讲，他们想知道一切是如何运作的，这很棒。何时最好了解它的工作原理是困难的部分。

通常，您可能会陷入更多关于解决问题的对话，而不是仅仅解决问题。也许你可以告诉我们更多关于客户的个性。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T18:44:27.613

我发现通过“视觉证据”总是比通过理论论证更容易说服客户——因此，您可以例如向他们展示徽标或网站上使用的一般风格，从而为他们的可用性赢得了价格，或者甚至可以向他们展示一些大竞争对手是如何正在做，然后根据他们所看到的指出好处。

我也曾经设法通过制作这个功能的实际外观和工作方式的屏幕模型来摆脱一个非常糟糕的用户界面建议 - 我确保让这些模型尽可能不吸引人;-)我介绍了他们，客户很快意识到有更好的方法来实现他的目标。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T16:20:16.610

知识就是力量。当您知道客户做错了什么时，请准备好有关原因的事实，**并以简单的英语快速**呈现。你需要提醒他们为什么他们首先雇用你。

考虑到这一点，有时客户坚持要在脚上开枪。准备好备份，使用版本控制，但最重要的是：不要对抗它们。您的声誉比他们的 3d-logo-spinny 网站更有价值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-30T16:22:45.747

很小心。

你有几个相互矛盾的问题：你想保持关系（和收入），你想做好工作，你不想让你的名字在火鸡上结束。

首先要问很多关于*业务*方面的问题：你想让它*做什么*，你想接触谁，你想给人什么样的印象。有时这会让你把讨论转向更有用的话题。

如果这不起作用，有时模拟客户的想法和您的想法并进行比较会有所帮助；如果你的明显优越，他们可能会看到。

如果不是，有时您必须记住，承包/咨询是卖淫的一种形式；你做客户想要的，不管它是不是你最喜欢的。

要记住的另一件事是几年前我从另一位顾问那里得到的教训：有些客户不值得麻烦。他建议，一旦你有足够的生意来维持生计，你就要养成解雇最不喜欢的 10% 客户的做法。随着时间的推移，您开发了一个可以与之合作的客户群，并将火鸡交给其他人。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T16:20:05.220

客户的问题在于他们是客户。他们聘请你按照他们的规格做一个项目。在您的示例中，他们似乎忽略了他们雇用您是因为您的经验。你需要以温和的方式提醒他们这个事实。也许是这样的故事：“在一个客户，我们使用了这样的徽标，他们的流量下降了。一旦我们切换到平面图标，流量就会返回。” 本身不一定是真的，但你需要卖掉它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T16:25:05.727

你所能做的就是向你的客户解释他们雇用你是因为你在设计方面的专业知识，但归根结底，客户永远是对的。

如果您发现自己不喜欢为这样的客户工作，只需在新项目开始时声明您需要完全的创意控制。如果他们仍然想要旋转徽标，那么您将不得不为该项目忍受它，但至少您将来可以拒绝同一客户的任何报价。

# .net - 升级到 ASP.NET MVC RC1 后，Html.DropDownList 不再工作

> ID：496065
> 
> 赞同：0
> 
> 时间：2009-01-30T16:14:39.477
> 
> 标签：.net, asp.net-mvc

我在 ASP.NET MVC Beta 上运行的 Web 应用程序中有以下代码：

```
<%= Html.DropDownList("Instances", new { style="width:270px;", onchange = "UpdateReport(this)" }) %> 
```

其中“Instances”是存储在 ViewData 中的 SelectList，如下所示：

```
ViewData["Instances"] = new SelectList(instanceList, "Id", "ClientName", report.SelectedId); 
```

升级到 MVC RC1 后，我在 DropDownList 中收到以下错误：

CS1928：“System.Web.Mvc.HtmlHelper”不包含“DropDownList”的定义和最佳扩展方法重载“System.Web.Mvc.Html.SelectExtensions.DropDownList(System.Web.Mvc.HtmlHelper, string, string )' 有一些无效的参数

我已更新我的引用以指向正确的（新）Mvc Dll，并且我还将 Microsoft.Web.Mvc.dll 更新为来自 codeplex 的 RC MVC Futures dll。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T23:57:52.253

试试这个：

```
<%= Html.DropDownList("Instances", (SelectList)ViewData["Instances"], new { style="width:270px;", onchange = "UpdateReport(this)" }) %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T16:27:56.843

Html.DropDownList 签名在 RC 中有所更改。第二个参数现在是 SelectList 对象，而不是属性对象。您只需要更改视图代码即可调用正确的重载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T17:36:02.097

这实际上是这两个答案的组合......

第二个参数必须是 SelectList，但是根据[ericness](https://stackoverflow.com/users/60874/ericness)的回答，解决您遇到的特定错误还需要将 ViewData 对象转换为 SelectList：

```
<%= Html.DropDownList("Instances", (SelectList)ViewData["Instances"], new { style="width:270px;", onchange = "UpdateReport(this)" }) 
```

# .net - 在使用 asp.net 进行登录重定向时需要帮助

> ID：496068
> 
> 赞同：1
> 
> 时间：2009-01-30T16:15:02.000
> 
> 标签：.net, asp.net, login

我的登录页面有问题。如果我不输入用户名或密码，它应该说“请输入用户名或密码”，而不是进入目标页面，我的意思是如果我点击提交按钮，则无需在登录字段中输入任何内容，它会受到欢迎页面实际上不应该发生。

这是我的代码，请有人告诉我我的错误在哪里：

```
public class Login
{
  public string str = ConfigurationManager.ConnectionStrings["ConnectionString"].ConnectionString.ToString();
    public int GetLogin(string UserName, string Password)
    {
      SqlConnection con = new SqlConnection(str);
      SqlDataAdapter da = new SqlDataAdapter("select * from Login where UserName='"+UserName+"' and Password='"+Password+"'",con);
 DataSet ds = new DataSet();
        da.Fill(ds);
        if (ds.Tables[0].Rows.Count > 0)
        {
            if ((ds.Tables[0].Rows[0].ItemArray[0].ToString() == UserName) && (ds.Tables[0].Rows[0].ItemArray[1].ToString() == Password))
            {
                return 1;
            }
            else
            {
                return 0;
            }
        }

        else
        {
            return -1;
        }
    }
Login.aspx.cs:
protected void BtnLogin_Click(object sender, EventArgs e)
    {
        Session["UserName"] = TxtUserName.Text;      

        Login lg = new Login();    

        if ((lg.GetLogin(TxtUserName.Text, TxtPassword.Text) == 1))
        {
            Response.Redirect("c1.aspx");

        }

        else if((TxtUserName.Text=="")&&(TxtPassword.Text==""))
        {
            Lbl1.Text = "Please Enter the UserName and Password";
        }

        else
        {

            Lbl1.Text = "Sorry,Invalid UserName or Password";
        }             

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T16:21:58.697

所有这些功能都已内置到 ASP.NET 中。

查看[RequiredFieldValidator](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.requiredfieldvalidator.aspx)以验证您的字段，或使用[登录控件](http://msdn.microsoft.com/en-us/library/ms178329.aspx)为您处理所有表单功能。

查看[FormsAuthentication](http://msdn.microsoft.com/en-us/library/aa480476.aspx)和[Membership](http://msdn.microsoft.com/en-us/library/yh26yfzy.aspx)以进行用户身份验证。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T16:24:25.477

我真的不知道问题是什么，因为它看起来应该可以工作，但是你有一个巨大的 SQL 注入问题。在测试数据库上对此进行测试，但将其输入为您的用户名。

```
' and 1 = 1; drop table Login; -- 
```

我建议您查找 SqlParameter 并搜索“SqlParameter SQL Injection Attack”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T16:27:07.187

1.- 用户和通过空验证是在 db 调用之后，所以如果你有一个空白用户和一个空白密码，登录将成功

2.-您正在创建对 sql 注入开放的 sql 查询，请使用参数化查询。

# sql - 我应该在子查询中使用 Top(1)

> ID：496070
> 
> 赞同：4
> 
> 时间：2009-01-30T16:15:35.027
> 
> 标签：sql, subquery

示例查询：

```
select * 
from A join B on A.ID = B.SOMEVALUE
where A.VALUE="something" and
B.ID = 
       (select ID from B where SOMEVALUE = A.ID and 
              THISDATE = (select max(SOMEDATE) from B where ...)) 
```

因此，如果您可以阅读 SQL，您应该会看到我正在执行几个相关的子查询来缩小 join 的结果。（是的，这太简单了）。

在某些情况下，子查询：

```
select ID from B where SOMEVALUE = A.ID and 
    THISDATE = (select max(SOMEDATE) from B where ...) 
```

可以返回超过 1 个值，这会导致错误

> “子查询返回的值超过 1 个。当子查询跟随 =、!=、<、<=、>、>= 或将子查询用作表达式时，这是不允许的。”

我完全期待。这显然不是一件好事，我有代码（希望）首先防止这些重复项进入数据库（即表 B*应该*只有 1 行与

```
SOMEVALUE = A.ID and max(SOMEDATE) 
```

标准），但是最终用户如果没有创造性地寻找我想不出的破坏软件的方法，那将一事无成。

所以现在我的问题：

将第一个子查询更改为

```
select top 1 * from B ... 
```

防止用户在/如果（希望永远不会）出现这种情况时看到错误，或者让错误发生。我倾向于不添加顶部语句并让错误出现，而不是让用户看到可能不正确的数据。我想知道在这种情况下是否有人对最佳实践有任何想法......

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-30T16:20:51.523

通常TOP 1是个好主意。

考虑一个包含数百万行的大表，在您匹配的列上没有索引，但是您只查找单行。

SELECT TOP 1 意味着一旦找到一项，表扫描就会停止。

如果没有 TOP 1，表扫描将一直持续到最后。

与任何涉及扫描（或蛮力）进行搜索的事情一样。使用 TOP 1，平均应该比不使用 TOP 1 快 50%。

但是，根据您需要返回的内容，通常可以通过使用 EXISTS 来获得真正的性能提升。

而不是写

```
SELECT * FROM table t
WHERE t.id = (SELECT TOP 1 foreignid from table2) 
```

您可以使用

```
SELECT * FROM table t
WHERE EXISTS (SELECT 1 from table2 WHERE foreignid = t.id) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T16:22:17.417

你为什么要加入表 A 和 B...然后在子查询中从 B 中选择...并与 A 中的列进行比较？？？

这不是等效的吗：

```
select * 
from A join B on A.ID = B.SOMEVALUE
where A.VALUE="something" and
THISDATE = (select max(SOMEDATE) from B where ...)) 
```

此外，如果您希望从整个查询中获得一行总数......这不起作用：

```
select top 1 * 
from A join B on A.ID = B.SOMEVALUE
where A.VALUE="something" 
Order by B.SOMEDATE DESC 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-30T16:24:05.073

编码实践：将 top1 放在需要返回单个值的子查询中。

优点：

*   允许继续执行。
*   允许查询忽略无关紧要的额外值。
*   找到第一个值时停止寻找新值（执行）。

缺点：

*   防止查询抱怨重要的额外值。
*   如果查询中未指定 order，则无法控制 top1 将选择哪个元素。当第二次执行查询时，这可能会导致不同的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T16:23:08.990

我会推荐 TOP 1 方法。它可能会帮助性能（不太可能伤害它）。

没有它你会发现错误的想法是光荣的，但有点错位。如果从现在开始几个月后这里发生错误，那么它发生的原因或正在发生的事情根本不直观。相反，我会专注于在其他地方强制执行数据完整性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T16:20:45.127

为什么不在`LIMIT 1`子选择的末尾使用？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T16:21:52.253

如果你只想返回一行，你可以做两件事之一。首先是改变你的平等检查，而不是像这样检查遏制

```
select ID from B where SOMEVALUE = A.ID and 
THISDATE IN (select max(SOMEDATE) from B where ...) 
```

（注意输入）

其次你可以做

```
select TOP 1 ID from B where SOMEVALUE = A.ID and 
THISDATE IN (select max(SOMEDATE) from B where ...) 
```

如果您只寻找一个值。

或者正如您所说，您可以将子查询更改为 SELECT TOP 1 在我看来这没问题，因为只要 WHERE 子句不依赖于外部查询，它可能只会执行一次嵌套查询并且从那里开始依赖静态存储的值

```
select ID from B where SOMEVALUE = A.ID and 
THISDATE = (select TOP 1 * from B where ...) 
```

所以有一些选择，但我不完全确定它们的效率。

# visual-studio - 调试 Winform 应用程序时 Visual Studio 2005 挂起

> ID：496072
> 
> 赞同：0
> 
> 时间：2009-01-30T16:16:12.670
> 
> 标签：visual-studio, visual-studio-2005

在调试 Windows 应用程序时，我的 Visual Studio 突然挂起。回复需要一段时间，但它正在关闭我的应用程序。在每个调试会话中，我每次都会遇到这个问题。

请帮助解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T16:48:36.927

您的应用程序也停止响应对吗？如果是这样，我认为您的应用程序给 VS 带来了问题。大概是因为某些操作正在占用主线程。当它被绑定时，无法处理其他事件（按钮单击、屏幕重绘、关闭按钮等）。这可能是由不定式循环、磁盘 IO 或等待网络连接或数据库查询结果或死锁引起的。

我的建议是进行某种类型的日志记录，这样您就可以确定问题出在哪里。例如，在主要函数的顶部和底部放置一个断点。在你打破顶部之后，点击播放。如果你没有打到底部，你就知道问题出在那个区域的某个地方。

或者，进行某种日志记录，例如将 Console.WriteLn("Entering MyFunction()") 放在代码的不同位置。

一旦你知道问题出在哪里，你就可以解决它。

# objective-c - CoreData 应用程序中的“保存”

> ID：496073
> 
> 赞同：0
> 
> 时间：2009-01-30T16:16:47.537
> 
> 标签：objective-c, cocoa, core-data

我在这里有一个 CoreData 应用程序（不基于文档）、1 个实体和 1 个表格视图，用于编辑/添加/删除实体的“实例”。现在我可以手动添加和保存，但我想

> `a)`自动保存更改
> `b`）在第一次启动时自动添加一些“实例”。

我认为`a)`可以用 NSNotifications 解决。但是实体使用哪个？

任何想法如何解决`a)`或`b)`？

感谢您的`every`回答。=)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T18:17:03.910

有时，自动保存可能比您最初预期的要复杂一些，因为有时您的应用程序数据处于无效状态（例如，当用户正在编辑实体时）并且无法保存或无法保存节省的意义。不幸的是，没有简单的`setAutosaves:YES`属性，所以你必须自己实现它。在某些操作后使用通知保存是一种方法，如果它对您的应用程序有意义，您还可以设置一个计时器以定期保存。

要填充一个空的数据文件，只需检查启动时数据存储是否为空（`applicationDidFinishLaunching`并且`awakeFromNib`是两个可能的放置位置），以及它是否正常插入一些实体。唯一棘手的部分是在此过程中禁用撤消管理。这是我的一个应用程序的示例：

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification;
{       
    NSURL *fileURL = [NSURL fileURLWithPath:[self.applicationSupportFolder stringByAppendingPathComponent:WLDataFileName]];

    NSManagedObjectModel *model = [NSManagedObjectModel mergedModelFromBundles:nil];    
    NSPersistentStoreCoordinator *coordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:model];
    NSManagedObjectContext *context = [[NSManagedObjectContext alloc] init];
    NSFetchRequest *request = [[NSFetchRequest alloc] init];

    [coordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:fileURL options:nil error:NULL];
    [context setPersistentStoreCoordinator:coordinator];
    [request setEntity:[NSEntityDescription entityForName:@"Shelf" inManagedObjectContext:context]];

    if ( [context countForFetchRequest:request error:NULL] == 0 )
        [self _populateEmptyDataStore:context];

    _managedObjectContext = [context retain];

    [request release];
    [coordinator release];
    [context release];

    // finish loading UI, etc...
}

- (void)_populateEmptyDataStore:(NSManagedObjectContext *)context;
{
    [[context undoManager] disableUndoRegistration];

    WLSmartShelfEntity *allItems = [NSEntityDescription insertNewObjectForEntityForName:@"SmartShelf" inManagedObjectContext:context];
    WLSmartShelfEntity *trash = [NSEntityDescription insertNewObjectForEntityForName:@"SmartShelf" inManagedObjectContext:context];

    allItems.name = NSLocalizedString( @"All Items", @"" );
    allItems.predicate = [NSPredicate predicateWithFormat:@"isTrash = FALSE"];
    allItems.sortOrder = [NSNumber numberWithInteger:0];
    allItems.editable = [NSNumber numberWithBool:NO];

    trash.name = NSLocalizedString( @"Trash", @"" );
    trash.predicate = [NSPredicate predicateWithFormat:@"isTrash = TRUE"];
    trash.sortOrder = [NSNumber numberWithInteger:2];
    trash.editable = [NSNumber numberWithBool:NO];

    [context processPendingChanges];
    [[context undoManager] enableUndoRegistration];

    DebugLog( @"Filled empty data store with initial values." );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T16:23:24.637

查看Apple 邮件列表中有关自动保存和核心数据的[此线程。](http://lists.apple.com/archives/Cocoa-dev/2006/Apr/msg01285.html)

# java - 第三方类的 AOP

> ID：496080
> 
> 赞同：1
> 
> 时间：2009-01-30T16:18:06.893
> 
> 标签：java, spring, aop, spring-aop

我在 spring 中使用了 AOP，没有遇到任何实际问题，主要用于事务管理，这很有吸引力。

我的问题是……到目前为止，我看到的关于 AOP 的唯一示例是切入您自己创建的类。是否可以在第三方库中切入一个类，例如数据库连接类。上下文是我希望在 oracle 数据源执行对数据库的调用时创建一些日志并收集信息，不幸的是，该调用包含在一堆 oracle 类文件中。执行 SQL 时，您将如何切入此类/方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T16:54:41.407

我认为这会起作用：

1.  让 Spring 负责初始化你的 DataSource
2.  对 DataSource 上的 getConnection() 方法应用方面
3.  在您的建议中，将返回的 Connection 包装在一个新类（“LoggingConnection”）中，该类实现 Connection 并将所有方法委托给“真实”包装的 Connection（我相信这是装饰器模式）
4.  将您需要的任何日志记录代码添加到“LoggingConnection”类

请记住，这种方法会创建原始 DataSource 的代理，并为每个方法调用委托给它。在数据库操作的上下文中，这不应该产生很多额外的开销。您将需要非常小心您的代码正在做什么，以免它引发异常并阻止连接正常运行。也许使用 try/catch/finally 并将委托给“真实”连接的调用放在 finally 块中。

另一种完全不同的方法是使用 AspectJ 并进行加载时编织。这样一来，您就可以在 ClassLoader 加载类时使用新功能来装饰类。

# apache-flex - 在 Flex 中使用未停靠的 ApplicationControlBar 而不是普通的 HBox 有什么优势？

> ID：496082
> 
> 赞同：0
> 
> 时间：2009-01-30T16:18:34.240
> 
> 标签：apache-flex, coding-style

我看到 Flex3 有一个名为`ApplicationControlBar`专门用于“保存提供全局导航和应用程序命令的组件”的类。（引自[langref](http://livedocs.adobe.com/flex/3/langref/mx/containers/ApplicationControlBar.html)）。问题是：使用这个类而不是仅仅添加一个`HBox`带有灰色背景的平原有什么好处，还是只是一个品味问题？

在我当前的代码中，我使用以下框：

```
<mx:HBox verticalAlign="middle" horizontalGap="5" backgroundColor="0xCCCCCC"
         width="100%" paddingTop="5" paddingRight="5" paddingBottom="5"
         paddingLeft="5"> 
```

当然，这需要明确指定一些属性，但除此之外呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T16:46:55.010

ApplicationControlBar 本质上是一个 HBox，滚动策略设置为 false 和透明背景。它提供的唯一其他功能是对接的能力。来自 Livedocs：

停靠模式：该栏始终位于应用程序绘图区域的顶部，并成为应用程序镶边的一部分。任何应用程序级别的滚动条都不适用于组件，因此它始终保持在可见区域的顶部，并且滚动条会扩展以填充应用程序的宽度。要创建停靠栏，请将停靠属性的值设置为 true。

如果您查看 ApplicationControlBar 和 Application.dockControlBar 的源代码，您会发现当 docked=true 时，该栏被添加到 rawChildren 而不是 children，这使得它可以“忽略”scollbars 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T17:06:54.393

除了我可以添加的上一个答案之外，如果您不使用特殊边框类型，当然可以将渐变背景设置为 ApplicationControlBar，HBox 不允许这样做:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-31T02:12:34.167

但即使使用 HBox，您仍然可以在不设置边框样式的情况下绘制自己的渐变背景。

# c# - 在 CLR 中强制转换与使用“as”关键字

> ID：496096
> 
> 赞同：404
> 
> 时间：2009-01-30T16:20:52.940
> 
> 标签：c#, casting, clr

在编程接口时，我发现我正在做很多转换或对象类型转换。

这两种转换方法有区别吗？如果是这样，是否存在成本差异或这对我的计划有何影响？

```
public interface IMyInterface
{
    void AMethod();
}

public class MyClass : IMyInterface
{
    public void AMethod()
    {
       //Do work
    }

    // Other helper methods....
}

public class Implementation
{
    IMyInterface _MyObj;
    MyClass _myCls1;
    MyClass _myCls2;

    public Implementation()
    {
        _MyObj = new MyClass();

        // What is the difference here:
        _myCls1 = (MyClass)_MyObj;
        _myCls2 = (_MyObj as MyClass);
    }
} 
```

另外，“一般”首选方法是什么？

* * *

## 回答 #1

> 赞同：538
> 
> 时间：2009-01-30T16:34:15.863

行下的答案写于 2008 年。

C# 7 引入了模式匹配，它在很大程度上取代了`as`运算符，您现在可以编写：

```
if (randomObject is TargetType tt)
{
    // Use tt here
} 
```

请注意，`tt`此后仍在范围内，但未明确分配。（它肯定*是*在主体内分配的`if`。）在某些情况下这有点烦人，所以如果你真的关心在每个范围内引入尽可能少的变量，你可能仍然希望使用`is`后跟强制转换。

* * *

到目前为止，我认为没有任何答案（在开始此答案时！）真正解释了值得在哪里使用哪个。

*   不要这样做：

    ```
    // Bad code - checks type twice for no reason
    if (randomObject is TargetType)
    {
        TargetType foo = (TargetType) randomObject;
        // Do something with foo
    } 
    ```

    这不仅检查了两次，而且可能检查不同的东西，如果`randomObject`是字段而不是局部变量。如果另一个线程更改了`randomObject`两者之间的值，则“if”可能会通过但强制转换失败。

*   如果`randomObject`真的*应该*是 的一个实例`TargetType`，即如果不是，则意味着存在错误，那么强制转换是正确的解决方案。这会立即引发异常，这意味着在不正确的假设下不再进行任何工作，并且异常正确地显示了错误的类型。

    ```
    // This will throw an exception if randomObject is non-null and
    // refers to an object of an incompatible type. The cast is
    // the best code if that's the behaviour you want.
    TargetType convertedRandomObject = (TargetType) randomObject; 
    ```

*   如果`randomObject` *可能*`TargetType`是并且`TargetType`是引用类型的实例，则使用如下代码：

    ```
    TargetType convertedRandomObject = randomObject as TargetType;
    if (convertedRandomObject != null)
    {
        // Do stuff with convertedRandomObject
    } 
    ```

*   如果`randomObject` *可能*`TargetType`是并且是值类型的实例`TargetType`，那么我们不能`as`与`TargetType`自身一起使用，但我们可以使用可为空的类型：

    ```
    TargetType? convertedRandomObject = randomObject as TargetType?;
    if (convertedRandomObject != null)
    {
        // Do stuff with convertedRandomObject.Value
    } 
    ```

    （注意：目前这[实际上比 is + cast 慢](https://stackoverflow.com/questions/1583050/performance-surprise-with-as-and-nullable-types)。我认为它更优雅和一致，但我们开始了。）

*   如果你真的不需要转换后的值，但你只需要知道它是否*是*TargetType 的实例，那么`is`操作符就是你的朋友。在这种情况下，TargetType 是引用类型还是值类型都没有关系。

*   可能还有其他涉及泛型`is`的情况有用（因为您可能不知道 T 是否是引用类型，因此您不能使用 as），但它们相对模糊。

*   我几乎可以肯定`is`在此之前使用过值类型的情况，没有考虑过使用可空类型并`as`一起使用:)

* * *

编辑：请注意，除了值类型案例之外，以上都没有谈到性能，我注意到拆箱到可空值类型实际上更慢 - 但一致。

根据 naasking 的回答，is-and-cast 或 is-and-as 都与现代 JIT 的空值检查一样快，如下面的代码所示：

```
using System;
using System.Diagnostics;
using System.Linq;

class Test
{
    const int Size = 30000000;

    static void Main()
    {
        object[] values = new object[Size];
        for (int i = 0; i < Size - 2; i += 3)
        {
            values[i] = null;
            values[i + 1] = "x";
            values[i + 2] = new object();
        }
        FindLengthWithIsAndCast(values);
        FindLengthWithIsAndAs(values);
        FindLengthWithAsAndNullCheck(values);
    }

    static void FindLengthWithIsAndCast(object[] values)        
    {
        Stopwatch sw = Stopwatch.StartNew();
        int len = 0;
        foreach (object o in values)
        {
            if (o is string)
            {
                string a = (string) o;
                len += a.Length;
            }
        }
        sw.Stop();
        Console.WriteLine("Is and Cast: {0} : {1}", len,
                          (long)sw.ElapsedMilliseconds);
    }

    static void FindLengthWithIsAndAs(object[] values)        
    {
        Stopwatch sw = Stopwatch.StartNew();
        int len = 0;
        foreach (object o in values)
        {
            if (o is string)
            {
                string a = o as string;
                len += a.Length;
            }
        }
        sw.Stop();
        Console.WriteLine("Is and As: {0} : {1}", len,
                          (long)sw.ElapsedMilliseconds);
    }

    static void FindLengthWithAsAndNullCheck(object[] values)        
    {
        Stopwatch sw = Stopwatch.StartNew();
        int len = 0;
        foreach (object o in values)
        {
            string a = o as string;
            if (a != null)
            {
                len += a.Length;
            }
        }
        sw.Stop();
        Console.WriteLine("As and null check: {0} : {1}", len,
                          (long)sw.ElapsedMilliseconds);
    }
} 
```

在我的笔记本电脑上，这些都在大约 60 毫秒内执行。有两点需要注意：

*   它们之间没有显着差异。（事实上​​，在某些情况下，as-plus-null-check 肯定*会*更慢。上面的代码实际上使类型检查变得容易，因为它是针对密封类的；如果您正在检查接口，则余额会稍微提示支持 as-plus-null-check。）
*   他们都快得*离谱*。这根本*不会*成为您代码中的瓶颈，除非您之后真的不打算对这些值做*任何事情*。

所以我们不用担心性能。让我们担心正确性和一致性。

我坚持认为 is-and-cast（或 is-and-as）在处理变量时都是不安全的，因为它所引用的值的类型可能会由于测试和强制转换之间的另一个线程而改变。那将是一种非常罕见的情况-但我宁愿有一个可以始终使用的约定。

我还认为 as-then-null-check 可以更好地分离关注点。我们有一个尝试转换的语句，然后有一个使用结果的语句。is-and-cast 或 is-and-as 执行测试，*然后*再次尝试转换值。

换句话说，有人会*写*：

```
int value;
if (int.TryParse(text, out value))
{
    value = int.Parse(text);
    // Use value
} 
```

这就是 is-and-cast 正在做的事情——尽管显然是以一种相当便宜的方式。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2009-01-30T16:23:04.153

**如果无法强制转换，**“as”将返回 NULL。****

 ****强制转换之前**会引发异常。

对于性能，引发异常通常会花费更多的时间。

* * *

## 回答 #3

> 赞同：28
> 
> 时间：2009-01-30T17:02:14.747

这是另一个答案，有一些 IL 比较。考虑类：

```
public class MyClass
{
    public static void Main()
    {
        // Call the 2 methods
    }

    public void DirectCast(Object obj)
    {
        if ( obj is MyClass)
        { 
            MyClass myclass = (MyClass) obj; 
            Console.WriteLine(obj);
        } 
    } 

    public void UsesAs(object obj) 
    { 
        MyClass myclass = obj as MyClass; 
        if (myclass != null) 
        { 
            Console.WriteLine(obj);
        } 
    }
} 
```

现在看看每种方法产生的 IL。即使操作码对您没有任何意义，您也可以看到一个主要区别 - 在 DirectCast 方法中调用 isinst 后跟 castclass。所以基本上是两个电话而不是一个。

```
.method public hidebysig instance void  DirectCast(object obj) cil managed
{
  // Code size       22 (0x16)
  .maxstack  8
  IL_0000:  ldarg.1
  IL_0001:  isinst     MyClass
  IL_0006:  brfalse.s  IL_0015
  IL_0008:  ldarg.1
  IL_0009:  castclass  MyClass
  IL_000e:  pop
  IL_000f:  ldarg.1
  IL_0010:  call       void [mscorlib]System.Console::WriteLine(object)
  IL_0015:  ret
} // end of method MyClass::DirectCast

.method public hidebysig instance void  UsesAs(object obj) cil managed
{
  // Code size       17 (0x11)
  .maxstack  1
  .locals init (class MyClass V_0)
  IL_0000:  ldarg.1
  IL_0001:  isinst     MyClass
  IL_0006:  stloc.0
  IL_0007:  ldloc.0
  IL_0008:  brfalse.s  IL_0010
  IL_000a:  ldarg.1
  IL_000b:  call       void [mscorlib]System.Console::WriteLine(object)
  IL_0010:  ret
} // end of method MyClass::UsesAs 
```

**isinst 关键字与 castclass**

[这篇博客文章](http://m3mia.blogspot.com/2007/11/comparing-isinst-to-castclass.html)对这两种方法进行了很好的比较。他的总结是：

*   在直接比较中，isinst 比 castclass 快（虽然只是稍微）
*   当必须执行检查以确保转换成功时，isinst 比 castclass 快得多
*   不应使用 isinst 和 castclass 的组合，因为这比最快的“安全”转换要慢得多（慢 12% 以上）

我个人总是使用 As，因为它易于阅读并且被 .NET 开发团队（或者 Jeffrey Richter 无论如何）推荐

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2009-01-30T16:38:21.563

两者之间更细微的区别之一是，当涉及强制转换运算符时，“as”关键字不能用于强制转换：

```
public class Foo
{
    public string Value;

    public static explicit operator string(Foo f)
    {
        return f.Value;
    }

}

public class Example
{
    public void Convert()
    {
        var f = new Foo();
        f.Value = "abc";

        string cast = (string)f;
        string tryCast = f as string;
    }
} 
```

这不会在最后一行编译（尽管我认为它在以前的版本中编译过），因为“as”关键字不考虑强制转换运算符。这条线`string cast = (string)f;`工作得很好。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2009-01-30T16:24:28.037

*如果as*不能执行返回*null*的转换，则永远不会抛出异常（*as*仅对引用类型进行操作）。所以使用*as*基本上相当于

```
_myCls2 = _myObj is MyClass ? (MyClass)_myObj : null; 
```

另一方面，当无法进行转换时，C 风格的强制转换会抛出异常。

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2009-01-30T16:26:52.447

不是你的问题的真正答案，但我认为是一个重要的相关点。

如果您正在对接口进行编程，则不需要强制转换。希望这些演员非常罕见。如果不是，您可能需要重新考虑您的一些界面。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2009-11-14T13:44:16.707

请忽略 Jon Skeet 的建议，重新：避免测试和投射模式，即：

```
if (randomObject is TargetType)
{
    TargetType foo = randomObject as TargetType;
    // Do something with foo
} 
```

这比强制转换和空测试花费更多的想法是一个**神话**：

```
TargetType convertedRandomObject = randomObject as TargetType;
if (convertedRandomObject != null)
{
    // Do stuff with convertedRandomObject
} 
```

这是一个不起作用的微优化。我运行了[一些真实的测试](http://higherlogics.blogspot.com/2009/02/cost-of-type-tests-and-casts-in-c.html)，测试和转换实际上比转换和空值比较快，而且它也更安全，因为你不可能在 if 应该转换的范围内有一个空引用失败。

如果你想知道为什么 test-and-cast 更快，或者至少不慢，有一个简单而复杂的原因。

**很简单：**即使是简单的编译器也会将两个类似的操作（如测试和转换）合并为一个测试和分支。cast-and-null-test 可能会强制执行两个测试和一个分支，一个用于类型测试并在失败时转换为 null，另一个用于 null 检查本身。至少，它们都将优化到单个测试和分支，因此测试和转换不会比转换和空测试慢也不会快。

**复杂：**为什么 test-and-cast 更快：cast-and-null-test 将另一个变量引入外部范围，编译器必须跟踪该变量的活性，并且它可能无法优化该变量，具体取决于您的控件的复杂程度 -流是。相反，test-and-cast 只在分隔范围内引入新变量，因此编译器知道该变量在范围退出后已死，因此可以更好地优化寄存器分配。

所以，请让这个“cast-and-null-test is better than test-and-cast”的建议消亡。请。test-and-cast 既安全又快速。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-30T16:23:36.947

如果转换失败，'as' 关键字不会抛出异常；而是将变量设置为 null（或值类型的默认值）。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-01-30T16:36:49.320

这不是问题的答案，而是对问题代码示例的评论：

通常，您不必将对象从例如 IMyInterface 转换为 MyClass。接口的好处在于，如果您将一个对象作为实现接口的输入，那么您就不必关心您获得的是哪种对象。

如果您将 IMyInterface 转换为 MyClass，那么您已经假设您获得了一个 MyClass 类型的对象并且使用 IMyInterface 没有任何意义，因为如果您将代码与实现 IMyInterface 的其他类一起提供，它会破坏您的代码......

现在，我的建议是：如果你的界面设计得很好，你可以避免大量的类型转换。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-30T16:31:16.913

操作符只能用于引用类型，`as`不能重载，`null`操作失败会返回。它永远不会抛出异常。

转换可以用于任何兼容的类型，它可以被重载，如果操作失败，它会抛出异常。

选择使用哪个取决于具体情况。首先，您是否想在转换失败时抛出异常是一个问题。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2013-09-25T16:28:16.817

我的回答只是在我们不检查类型并且在转换后不检查空值的情况下的速度。我在 Jon Skeet 的代码中添加了两个额外的测试：

```
using System;
using System.Diagnostics;

class Test
{
    const int Size = 30000000;

    static void Main()
    {
        object[] values = new object[Size];

        for (int i = 0; i < Size; i++)
        {
            values[i] = "x";
        }
        FindLengthWithIsAndCast(values);
        FindLengthWithIsAndAs(values);
        FindLengthWithAsAndNullCheck(values);

        FindLengthWithCast(values);
        FindLengthWithAs(values);

        Console.ReadLine();
    }

    static void FindLengthWithIsAndCast(object[] values)
    {
        Stopwatch sw = Stopwatch.StartNew();
        int len = 0;
        foreach (object o in values)
        {
            if (o is string)
            {
                string a = (string)o;
                len += a.Length;
            }
        }
        sw.Stop();
        Console.WriteLine("Is and Cast: {0} : {1}", len,
                          (long)sw.ElapsedMilliseconds);
    }

    static void FindLengthWithIsAndAs(object[] values)
    {
        Stopwatch sw = Stopwatch.StartNew();
        int len = 0;
        foreach (object o in values)
        {
            if (o is string)
            {
                string a = o as string;
                len += a.Length;
            }
        }
        sw.Stop();
        Console.WriteLine("Is and As: {0} : {1}", len,
                          (long)sw.ElapsedMilliseconds);
    }

    static void FindLengthWithAsAndNullCheck(object[] values)
    {
        Stopwatch sw = Stopwatch.StartNew();
        int len = 0;
        foreach (object o in values)
        {
            string a = o as string;
            if (a != null)
            {
                len += a.Length;
            }
        }
        sw.Stop();
        Console.WriteLine("As and null check: {0} : {1}", len,
                          (long)sw.ElapsedMilliseconds);
    }
    static void FindLengthWithCast(object[] values)
    {
        Stopwatch sw = Stopwatch.StartNew();
        int len = 0;
        foreach (object o in values)
        {
            string a = (string)o;
            len += a.Length;
        }
        sw.Stop();
        Console.WriteLine("Cast: {0} : {1}", len,
                          (long)sw.ElapsedMilliseconds);
    }

    static void FindLengthWithAs(object[] values)
    {
        Stopwatch sw = Stopwatch.StartNew();
        int len = 0;
        foreach (object o in values)
        {
            string a = o as string;
            len += a.Length;
        }
        sw.Stop();
        Console.WriteLine("As: {0} : {1}", len,
                          (long)sw.ElapsedMilliseconds);
    }
} 
```

结果：

```
Is and Cast: 30000000 : 88
Is and As: 30000000 : 93
As and null check: 30000000 : 56
Cast: 30000000 : 66
As: 30000000 : 46 
```

不要试图专注于速度（就像我所做的那样），因为这一切都非常非常快。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-07-20T15:05:22.093

除了这里已经公开的所有内容之外，我还发现了一个我认为值得注意的实际区别，即显式转换

```
var x = (T) ... 
```

与使用`as`运算符相比。

这是示例：

```
class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine(GenericCaster<string>(12345));
        Console.WriteLine(GenericCaster<object>(new { a = 100, b = "string" }) ?? "null");
        Console.WriteLine(GenericCaster<double>(20.4));

        //prints:
        //12345
        //null
        //20.4

        Console.WriteLine(GenericCaster2<string>(12345));
        Console.WriteLine(GenericCaster2<object>(new { a = 100, b = "string" }) ?? "null");

        //will not compile -> 20.4 does not comply due to the type constraint "T : class"
        //Console.WriteLine(GenericCaster2<double>(20.4));
    }

    static T GenericCaster<T>(object value, T defaultValue = default(T))
    {
        T castedValue;
        try
        {
            castedValue = (T) Convert.ChangeType(value, typeof(T));
        }
        catch (Exception)
        {
            castedValue = defaultValue;
        }

        return castedValue;
    }

    static T GenericCaster2<T>(object value, T defaultValue = default(T)) where T : class
    {
        T castedValue;
        try
        {
            castedValue = Convert.ChangeType(value, typeof(T)) as T;
        }
        catch (Exception)
        {
            castedValue = defaultValue;
        }

        return castedValue;
    }
} 
```

**底线：** GenericCaster2 不适用于结构类型。GenericCaster 将。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2015-12-08T09:31:08.907

如果您使用面向 .NET Framework 4.X 的 Office PIA，则应使用**as**关键字，否则将无法编译。

```
Microsoft.Office.Interop.Outlook.Application o = new Microsoft.Office.Interop.Outlook.Application();
Microsoft.Office.Interop.Outlook.MailItem m = o.CreateItem(Microsoft.Office.Interop.Outlook.OlItemType.olMailItem) as Microsoft.Office.Interop.Outlook.MailItem; 
```

**但是，在面向 .NET 2.0 时可以进行**投射：****

 **```
Microsoft.Office.Interop.Outlook.MailItem m = (Microsoft.Office.Interop.Outlook.MailItem)o.CreateItem(Microsoft.Office.Interop.Outlook.OlItemType.olMailItem); 
```

以 .NET 4.X 为目标时，错误是：

**错误 CS0656：缺少编译器所需的成员“Microsoft.CSharp.RuntimeBinder.Binder.Convert”**

**错误 CS0656：缺少编译器所需的成员“Microsoft.CSharp.RuntimeBinder.CSharpArgumentInfo.Create”**

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2009-01-30T16:26:23.693

该`as`关键字的作用与兼容引用类型之间的显式转换相同，主要区别在于如果转换失败，它不会引发异常。相反，它在目标变量中产生一个空值。由于异常在性能方面非常昂贵，因此它被认为是一种更好的强制转换方法。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-30T16:33:37.470

这取决于，您想在使用“as”后检查 null 还是希望您的应用程序抛出异常？

我的经验法则是，如果我总是希望变量是我希望使用强制转换时所期望的类型。如果变量可能不会转换为我想要的，并且我准备处理使用 as 的空值，我将使用 as。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-30T16:59:04.237

你选择什么很大程度上取决于需要什么。我更喜欢显式转换

```
IMyInterface = (IMyInterface)someobj; 
```

因为如果对象应该是 IMyInterface 类型而不是 - 这绝对是问题。最好尽早获得错误，因为将修复确切的错误而不是修复其副作用。

但是，如果您处理接受`object`作为参数的方法，那么您需要在执行任何代码之前检查其确切类型。在这种情况下`as`会很有用，因此您可以避免`InvalidCastException`.

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2013-02-08T09:14:21.683

看看这些链接：

*   [http://gen5.info/q/2008/06/13/prefix-casting-versus-as-casting-in-c/](http://gen5.info/q/2008/06/13/prefix-casting-versus-as-casting-in-c/)
*   [http://www.codeproject.com/Articles/8052/Type-casting-impact-over-execution-performance-in](http://www.codeproject.com/Articles/8052/Type-casting-impact-over-execution-performance-in)

他们向您展示了一些细节和性能测试。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-07-02T18:11:39.910

OP的问题仅限于特定的铸造情况。标题涵盖了更多情况。
以下是我目前能想到的所有相关铸造情况的概述：

```
private class CBase
{
}

private class CInherited : CBase
{
}

private enum EnumTest
{
  zero,
  one,
  two
}

private static void Main (string[] args)
{
  //########## classes ##########
  // object creation, implicit cast to object
  object oBase = new CBase ();
  object oInherited = new CInherited ();

  CBase oBase2 = null;
  CInherited oInherited2 = null;
  bool bCanCast = false;

  // explicit cast using "()"
  oBase2 = (CBase)oBase;    // works
  oBase2 = (CBase)oInherited;    // works
  //oInherited2 = (CInherited)oBase;   System.InvalidCastException
  oInherited2 = (CInherited)oInherited;    // works

  // explicit cast using "as"
  oBase2 = oBase as CBase;
  oBase2 = oInherited as CBase;
  oInherited2 = oBase as CInherited;  // returns null, equals C++/CLI "dynamic_cast"
  oInherited2 = oInherited as CInherited;

  // testing with Type.IsAssignableFrom(), results (of course) equal the results of the cast operations
  bCanCast = typeof (CBase).IsAssignableFrom (oBase.GetType ());    // true
  bCanCast = typeof (CBase).IsAssignableFrom (oInherited.GetType ());    // true
  bCanCast = typeof (CInherited).IsAssignableFrom (oBase.GetType ());    // false
  bCanCast = typeof (CInherited).IsAssignableFrom (oInherited.GetType ());    // true

  //########## value types ##########
  int iValue = 2;
  double dValue = 1.1;
  EnumTest enValue = EnumTest.two;

  // implicit cast, explicit cast using "()"
  int iValue2 = iValue;   // no cast
  double dValue2 = iValue;  // implicit conversion
  EnumTest enValue2 = (EnumTest)iValue;  // conversion by explicit cast. underlying type of EnumTest is int, but explicit cast needed (error CS0266: Cannot implicitly convert type 'int' to 'test01.Program.EnumTest')

  iValue2 = (int)dValue;   // conversion by explicit cast. implicit cast not possible (error CS0266: Cannot implicitly convert type 'double' to 'int')
  dValue2 = dValue;
  enValue2 = (EnumTest)dValue;  // underlying type is int, so "1.1" beomces "1" and then "one"

  iValue2 = (int)enValue;
  dValue2 = (double)enValue;
  enValue2 = enValue;   // no cast

  // explicit cast using "as"
  // iValue2 = iValue as int;   error CS0077: The as operator must be used with a reference type or nullable type
} 
```

# entity-framework - 将实体框架实体集合从 DAL 传递到业务层的最佳方式？

> ID：496108
> 
> 赞同：2
> 
> 时间：2009-01-30T16:23:01.953
> 
> 标签：entity-framework, generics, collections, object, data-access-layer

我有一个调用我的实体框架模型的 DAL。这些调用返回诸如 IOrderedQueryable 和 IQueryable 对象之类的东西。我应该将它们转换为我的 DAL 中更通用的东西，例如 List 吗？但我假设如果我不需要枚举整个集合，这可能是浪费......那么最好的方法是什么？只需让 DAL 返回 IQueryable<> 并在需要时转换它？还是有其他更灵活的东西？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T21:21:20.183

我有同样的问题，但我不确定完美的答案是什么。我觉得让 DAL 返回 IQueryable<> 实际上是最灵活的，因为您可以轻松地在代码的另一层执行另一个 LINQ 查询（如果需要）。

要考虑的另一件事是，当返回 IQueryable 时，结果尚未加载到内存中。所以返回的实际上是 LINQ“查询”。因此，它的行为与人们可能习惯的行为略有不同，即当从模型返回某些东西时，它实际上是来自数据库的结果。

在我的情况下，我们从 DAL 返回列表（通过调用 IQueryable<>.ToList() 创建）。如果此列表需要过滤，那么我们将创建另一个 DAL 方法，该方法将返回过滤后的列表。我们选择这个是因为调用 DAL 的其他层不需要知道我们以这种方式使用实体框架（没有引入依赖项）。

# c# - C#/ASP.NET/JS - onclick 事件显示行，回发隐藏行

> ID：496112
> 
> 赞同：0
> 
> 时间：2009-01-30T16:23:11.097
> 
> 标签：c#, asp.net, javascript

```
rbnResubmission.Items.FindByValue("Yes").Attributes.Add("onclick", "getCheckedRadioFieldResubmission(this)");
rbnResubmission.Items.FindByValue("No").Attributes.Add("onclick", "getCheckedRadioFieldResubmission(this)"); 
```

所以我有这些点击事件来显示表格中的行 - 这部分工作正常。

这是代码作用的示例（我没有显示“否”选项）

```
function getCheckedRadioFieldResubmission(radio){
    if(radio.value == "Yes"){
         document.getElementById('<%=ApprovingInstituteRow.ClientID%>').style.display ="block";
         document.getElementById('<%=ApprovalNumberRow.ClientID%>').style.display ="block";
         document.getElementById('<%=IRBApprovalRow.ClientID%>').style.display ="block";
         document.getElementById('<%=ExpectedDateRow.ClientID%>').style.display ="none";
     }
} 
```

表单需要经过验证，如果有任何问题，因为显示这些行的事件仅发生在“onclick”中 - 它们将在回发时消失。我可以更改什么以使它们永久显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T16:26:20.217

我猜你是在 onLoad 期间对单选按钮列表进行数据绑定。您必须在回发时重新绑定它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T20:01:42.450

您可能希望将 getCheckedRadioFieldResubmission 函数的相同功能添加到 html`<body>`标记的 onload 事件中。但是，由于该`this`对象将引用 body 元素而不是收音机，因此您需要在其中放置此类内容才能找到收音机：

`var radio = document.getElementById('radio_id');`

如果您的收音机列表具有维护状态，这将起作用。如，它在回发后保持其状态。

# memory - 黑莓内存使用情况

> ID：496113
> 
> 赞同：2
> 
> 时间：2009-01-30T16:23:13.810
> 
> 标签：memory, blackberry, java-me

我正在寻找一些关于移动设备内存使用的建议，尤其是黑莓。使用一些分析工具，我们计算出 RAM 中的工作集大小为 525kb。问题是我们真的不知道这是可以接受的还是太高了？

任何人都可以深入了解他们自己在黑莓上的内存使用经验吗？我们应该瞄准什么样的数字？

我也想知道我们应该特别注意哪些事情来减少内存使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T18:59:46.927

512KB 在当前的黑莓设备上是完全可以接受的。您可以查看[JBenchmark](http://www.jbenchmark.com/)以了解您可以为每个模型所期望的确切 JVM 堆，但目前没有任何设备低于 20MB 的堆。大多数都比这大得多。

在 JBenchmark 上，您可以从页面右侧的下拉列表中选择您感兴趣的设备。然后，导航到设备的 JVM 选项卡。

在减少内存使用方面，如果您真正内联 525K，我不会担心此应用程序使用的总字节数，而只需考虑分配/重新分配的频率。尽量池化/重用对象，避免任何不必要的分配。例如，使用 StringBuffer 类而不是运算符来连接字符串，因为将使用运算符为每个连接创建多个 String 对象，其中 StringBuffer 只会将字符放入数组中，并且仅在需要时扩展。谷歌是查找更多提示的好方法。

最后，依靠 BlackBerry JDE 拥有的分析工具是准确了解如何优化堆内存使用的非常重要的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T16:31:00.720

如果我没记错的话，黑莓应用程序是用 Java 编写的……这是一个托管环境，这意味着使用更少内存的唯一可靠方法是创建更少的对象。我认为，你对工作集无能为力，因为它是由运行时管理的（这实际上可能是在这样的设备上使用 Java 的重点）。

# c++ - 比较向量中的元素并返回对象的最佳方法

> ID：496118
> 
> 赞同：1
> 
> 时间：2009-01-30T16:23:46.850
> 
> 标签：c++, stl

我有一个用例，其中数字在整数向量中单调递增

```
vec[0] = 2
vec[1] = 5
vec[2] = 8
vec[3] = 10
.. 
```

如果我通过了 6 号，我想返回 vec[1]，因为它位于 vec[1] 和 vec[2] 之间，类似地，如果通过 9 号则必须返回 vec[2]。我对 STL 的经验是有限的，所以想检查一下我们是否可以用 STL 解决这个问题，或者你必须通过存储前一个来迭代每个，并且当点击一个大于你返回的传递数字的数字时

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-30T16:43:04.737

STL 在标头中有四种可重用的二进制搜索算法`<algorithm>`：[`lower_bound`](http://en.cppreference.com/w/cpp/algorithm/lower_bound)、[`upper_bound`](http://en.cppreference.com/w/cpp/algorithm/upper_bound)、[`equal_range`](http://en.cppreference.com/w/cpp/algorithm/equal_range)和[`binary_search`](http://en.cppreference.com/w/cpp/algorithm/binary_search).

`lower_bound`不完全符合您的要求：当序列中不存在所需的元素时，它返回一个迭代器，该迭代器引用您想要的元素之后的元素。但是，您应该能够使用实现您的行为的代码来包装它，而不会有太多麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T16:26:26.003

您可以使用二进制搜索。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T16:38:15.073

标题中有一个`binary_search()`功能。`<algorithm>`不幸的是，这个函数只返回一个布尔值。您可以在排序后的向量上编写自己的二进制搜索，对于大型列表，这比进行原始帖子中暗示的线性搜索要快。（如果我误读了帖子，请道歉）。

# php - 萨贾克斯死了吗？用什么代替？

> ID：496128
> 
> 赞同：1
> 
> 时间：2009-01-30T16:25:58.407
> 
> 标签：php, javascript, ajax, lamp, sajax

我们使用 Sajax 向站点添加小的 Ajax 代码。在遇到问题并进行了一些挖掘之后，该库似乎自 2005 年以来就没有更新过。

我很欣赏 Sajax 的轻量级、易于使用和易于安装（只需将文件包含在 PHP 中）。

那么，在 LAMP 堆栈上，如果您以前使用过 Sajax，您会升级到什么？易于使用是关键，因为一些半程序员 Web 开发人员也使用该代码。

我知道很多人会说 jQuery，但它和 Sajax 一样简单吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T16:35:02.197

我会说它更容易使用[`jQuery`。`ajax`](http://api.jquery.com/jQuery.ajax/)：

```
$.ajax({
    type: 'GET',
    url: './example.json',
    dataType: 'json'
}).done(function (data) {
    // Use data...
});

$.getJSON('./some.php', { q: 'thing' }).done(function (data) {
    // Use data...
});

$.ajax({
    type: 'POST',
    url: './api.php',
    data: {
        action: 'save',
        info: APP.getInfo(),
        token: APP.getToken()
    }
}); 
```

`jQuery`是一个很棒的工具，有很多[例子](http://api.jquery.com/jQuery.ajax/#entry-examples)和[插件](http://frontendbook.com/10-must-have-jquery-plugins-and-extensions/)，可以让你做一些非常了不起的事情！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T16:28:52.287

听起来很像[xajax](http://www.xajax-project.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T16:33:24.150

如果我错了，请纠正我，但 Sajax 是一个 PHP 库，而 jQuery 是一个 javascript 库。只是觉得需要做出区分。

在我们公司，我们使用 jQuery，我认为它非常棒。不会用它换任何东西。但我建议您尝试其他许多 javascript 库（Prototype、MooTools、YUI）中的任何一个，然后找出适合您的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-03-02T07:38:58.030

或者你可以使用 S2ajax：http: [//github.com/Fusion/s2ajax/tree/master](http://github.com/Fusion/s2ajax/tree/master)

我终于有时间把它推到 Github 上 :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T16:53:11.190

如果您正在寻找 jQuery 与 PHP 的集成，Zend 框架中有一些类。请参阅：http: [//framework.zend.com/manual/en/zendx.jquery.html](http://framework.zend.com/manual/en/zendx.jquery.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-12-14T04:08:40.570

在[http://sajax.info/](http://sajax.info/)上还有我的分支，它主要只是修复了 0.12 的突出问题，并专注于加快 sajax 的速度。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-30T16:43:37.873

我推荐 jQuery。Sajax 更直接，它试图成为您的两个端点。此外，有时它可能会因输出缓冲而变得混乱。

# c# - 读取 .xlsx 文件时出现问题？

> ID：496137
> 
> 赞同：1
> 
> 时间：2009-01-30T16:27:20.853
> 
> 标签：c#, excel, excel-2007, xlsx

我制作了一个测试文件，并很好地运行了excel文件，但是当我插入一个包含大量数据的文件时，我收到以下错误：

```
The Microsoft Office Access database engine could not find the object 'Sheet1$' 
```

这似乎非常明显，但肯定存在“Sheet1”，就像在我的测试文件中一样 - 我已经检查了大约 30 次。第一个工作表上只有数据，并且像默认值一样清楚地命名为“Sheet1”。知道为什么我仍然会收到此错误吗？

代码：

```
string path = Server.MapPath("~") + "\\attachments\\ejmaps\\ejmaps.xlsx";
string connString = string.Format("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + path + ";Extended Properties=\"Excel 12.0 Xml;HDR=YES\";");
OleDbDataAdapter adapter = new OleDbDataAdapter("SELECT * FROM [Sheet1$]", connString); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T16:38:30.237

奇怪...我已将名称改回原来的名称（EJMaps Pull.xlsx）并且它有效？

任何想法为什么会这样？

# javascript - AJAX 安全规范

> ID：496152
> 
> 赞同：4
> 
> 时间：2009-01-30T16:30:10.193
> 
> 标签：javascript, ajax, security, encryption

AJAX 安全性是否有规范？

发出 XMLHttpRequest 时，如果查询 HTTPS url，浏览器会处理所有的证书业务并正确加密请求（或使用已经存在的经过身份验证的隧道）吗？此模型是否存在任何安全漏洞？

然后还有 AJAX 的用户身份验证问题。这让我认为使用用户的密码来加密部分或全部 AJAX 请求可以解决一些身份验证问题。我见过一些令人印象深刻的基于 javascript 的加密工具。似乎有很大的潜力可以构建一个同时处理加密和身份验证（主机级别和应用程序用户级别）的单一系统。然而，我没有看到任何似乎“尝试过的真实”的东西。

**我的问题可以概括为：**

> 是否有使用浏览器技术或客户端 javascript 的安全 AJAX 规范？它是什么？如果没有，是什么阻止我们使用 javascript 构建一个？

谢谢你，一如既往。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T16:49:57.237

SSL 通过 HTTPS 是一种与目标服务器的合作。目标服务器将使用其身份证书报告其身份（发送回客户端）。这是将加密客户端和服务器之间的数据流的协议的一部分。

然而，这只是加密流，它对其他几个安全问题没有任何作用。通过其他方式处理发出请求的用户实体的标识和认证。如果您使用 SSL 加密流，使用 HTTP 基本身份验证应该是安全的。之后，对身份验证的响应应该是发送回客户端的会话 ID，该会话 ID 将在所有后续请求中传回。应用程序服务器通常管理这些会话 ID 的创建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T16:41:45.707

> Ajax 本身并没有在 Web 应用程序领域中引入新的安全漏洞。相反，这些应用程序面临与经典 Web 应用程序相同的安全问题。不幸的是，尚未开发出常见的 Ajax 最佳实践，这为出错留下了很大的空间。

来自：[http ://www.securityfocus.com/infocus/1868](http://www.securityfocus.com/infocus/1868)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T17:09:21.377

基本身份验证是有意义的。我发现[这篇](http://coderseye.com/2007/how-to-do-http-basic-auth-in-ajax.html)文章解释了如何做到这一点。

不知何故，我仍然渴望不使用所有浏览器技术并自己加密/验证事物。不确定这是否有意义。密钥缓存将很难完成。

我仍在寻找这（SSL + 在 ajax 调用中使用基本身份验证）是否是常态。

# sql-server - 我的日志文件太大

> ID：496168
> 
> 赞同：5
> 
> 时间：2009-01-30T16:34:17.860
> 
> 标签：sql-server, logging, backup

我在 SQL Server 中的日志文件用完了我磁盘上的所有空间。我每晚都运行完整备份，但日志文件不断增长。我能做些什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T17:24:19.710

在某些情况下，您可能会发现即使运行日志备份，日志文件也不会正确截断。您可以使用 TRUNCATE_ONLY 进行备份以检查它。当您运行它时，它应该截断事务日志：

```
BACKUP LOG dbname WITH TRUNCATE_ONLY 
```

此问题的原因是日志的早期部分中有一个打开的事务。SQL 不会截断此事务之后的日志，这可能会导致日志越来越大。您需要找出哪些交易未完成以及原因。您可以通过以下方式监控您的日志空间：

```
DBCC SQLPERF (LOGSPACE) 
```

可以使用以下方法找到有关长期运行事务的信息：

```
DBCC OPENTRAN 
```

或者：

```
select * from sys.dm_tran_database_transactions 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T16:39:07.460

在大多数繁忙的系统上，您需要查看全天计划日志备份，然后是每晚的完整备份。这是很常见的做法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T17:01:38.600

如果您有一项计划进行完整备份的工作，这很好，应该是您的起点，但是，您还需要定期执行事务日志备份。

备份事务日志会导致空间被回收。一旦定义了常规事务日志备份计划，您可能会考虑将事务日志缩小到更合适的大小。因为它将不再无限增长。

完全恢复的备份策略包括：

```
* Database backups.

* Differential backups (optional).

* Transaction log backups. 
```

我建议您查阅以下 Microsoft 参考资料。

[http://msdn.microsoft.com/en-us/library/aa173551(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa173551(SQL.80).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T16:41:06.800

您必须备份日志以及主数据库

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T16:36:59.617

您可以使用某种日志轮换，并仅保留固定时间的日志，例如过去 7 天。这应该绰绰有余。或者您可以每晚重置日志，因为您应该将其保存在备份中。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T16:41:44.380

这应该缩小它：

```
dbcc shrinkfile('databasename_log', 0) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T16:44:38.823

试试这个：

```
dump transaction <dbname> with no_log 
```

然后通过在 sql server 设置中设置 autoshrink 选项或 by 来缩小日志文件。

我想你也可以使用 dbcc 来缩小它，但我不记得语法了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-23T08:29:32.650

最好将事务日志备份添加到您的计划中。

`BACKUP LOG database TO DISK = 'D:/database_log.bak'`

请记住，在完整或批量日志恢复模型中，事务日志在进行事务日志备份时会被截断，因此有必要定期备份日志以管理事务日志的大小。否则，事务日志文件将增长，直到没有剩余空间。

如果不需要时间点恢复并且数据库更改不频繁，则最好使用简单的恢复模型（没有事务日志）。在这种情况下，事务日志会自动截断以删除任何不活动的虚拟日志文件。在简单恢复模型中，事务日志截断发生在每个检查点之后。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2009-01-30T16:35:56.827

删除日志文件？

编辑：显然删除日志文件是不好的，它只是*SQL*服务器的日志。我留下这个来重申什么不该做。

# c# - 为什么我会收到“无法将类型‘十进制’隐式转换为‘布尔’”错误？

> ID：496173
> 
> 赞同：2
> 
> 时间：2009-01-30T16:35:06.003
> 
> 标签：c#, conditional, boolean, decimal, if-statement

当 numericUpDown 的值改变时，我想隐藏一些东西，所以我写了这个：

```
if (numericUpDown1.Value = 1)
{
    Label1.Hide();
} 
```

但我收到此错误消息：

> ***无法将类型“十进制”隐式转换为“布尔”***

为什么会这样？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-30T16:39:30.003

我想你的意思是“ `if (numericUpDown1.Value == 1)`”。

在大多数语言中，“ `==`”是相等性的测试，而“ `=`”是赋值运算符。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T16:41:24.693

您没有进行比较（将**= 更改为 ==**）...尝试：

```
if (numericUpDown1.Value == 1)
{
    Label1.Hide();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T16:46:21.533

您使用的是哪种语言和单个“=”符号？在 VB 中，您将进行比较，而在 C# 中，您将使用“if”语句分配一个数字。保护自己免受这种情况影响的一种方法是首先列出数字： if (1 = numericUpDown) 如果在该语言中允许比较并且您打算进行分配则不好。错误会在你身上跳出来！

# delphi - ADOQuery 主/详细信息

> ID：496181
> 
> 赞同：-1
> 
> 时间：2009-01-30T16:36:41.757
> 
> 标签：delphi

如何设置 ADOQuery 来过滤数据以显示 DBGrid 中所有有溪鳟的湖泊？

**数据：**

内特池塘 - LakeMaps.Lake_Name

```
Brook trout - Species.Species_Name

Creek chub

Golden shiner 
```

黑塘

```
Brook trout

Brown bullhead

Common shiner 
```

普莱西德湖

```
Lake trout

Smallmouth bass

Yellow perch 
```

**数据库**

ADoTable1 = LakeMaps **MASTER**

ADOTable2 = 物种**详情**

**关系**

```
LakeMaps Table
LakeMaps.Field[0] = Lake_ID: Autonumber --- ]
LakeMaps.Field[1] = Lake_Name: Text---      |
                                            |Relationship set in the access database
Species Table                               |
Species.Field[0] = Species_ID: numeric ---  ]    
Species.Field[1] = Species_Name: text 
```

物种表是细节，LakeMaps 是大师

如何设置 ADOQuery 来过滤数据以显示 DBGrid 中所有有溪鳟的湖泊？

**过滤数据：**

内特池塘

```
Brook trout

Creek chub

Golden shiner 
```

黑塘

```
Brook trout

Brown bullhead

Common shiner 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T17:00:47.370

您可以设置`Filtered = true`然后使用`OnFilterRecord`事件并检查详细数据集是否包含请求的值（这可以在循环或`Locate`数据集的过程中完成）

对于大量数据，这可能会非常慢。在这些情况下，我通常直接在 SQL 中过滤主记录。像这样的东西：

```
SELECT * FROM LakeMaps 
WHERE Lake_ID in (SELECT Lake_ID 
         FROM Species INNER JOIN SpeciesLakesRelation 
             ON (Species.Species_ID = SpeciesLakesRelation.Species_Id) 
         WHERE SPECIES_NAME = 'Brook Trout') 
```

此 SQL 从 Lakes 中返回具有“Brook Trout”的记录。

`SpeciesLakesRelation`是包含 LakeMaps 和 Species 之间关系的表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T19:47:34.833

您查询的问题是查询中的文本必须使用撇号。如果`ComboBoxSpecies.Text`有 value `Brook Trout`，则 SQL 计算结果为：

```
SELECT * FROM LakeMaps WHERE Lake_ID in 
  (SELECT Lake_ID FROM Species INNER JOIN LakeMaps ON 
     (Species.Species_ID = LakeMaps.Lake_Id) 
   WHERE SPECIES_NAME = Brook Trout) 
```

请注意，Brook Trout 不在撇号中，因此您会从 MsAccess 收到语法错误。

**编辑：**
正如格里在评论中指出的那样：

*   应使用`QuotedStr`函数添加撇号，而不是双撇号。
*   最好的解决方案是使用查询参数

使用 的 Delphi 代码`QuotedStr`应如下所示：

```
ADOQuery1.SQL.Add( 'SELECT * FROM LakeMaps WHERE Lake_ID in ' +
  '(SELECT Lake_ID FROM Species INNER JOIN LakeMaps ON ' +
  '(Species.Species_ID = LakeMaps.Lake_Id) ' +
  'WHERE SPECIES_NAME = ' + QuotedStr(ComboBoxSpecies.Text) + ')'); 
```

现在，如果`ComboBoxSpecies.Text` 有 value `Brook Trout`，那么这个字符串：

```
'WHERE SPECIES_NAME = ' + QuotedStr(ComboBoxSpecies.Text) + ')' 
```

评估为：

```
WHERE SPECIES_NAME = 'Brook Trout') 
```

# linux - 如何让 Emacs 从文件中加载字体？

> ID：496188
> 
> 赞同：5
> 
> 时间：2009-01-30T16:37:39.897
> 
> 标签：linux, emacs, ide, fonts, customization

为了使我的 emacs 设置更便携，我希望能够通过指定文件而不是字体名称来设置当前字体，即“加载 ~/config/myfont.ttf 并使用大小 12”。有没有办法在我的 .emacs 中做到这一点？我找到的所有说明都假定字体已经安装在系统上。我在 Linux 上使用 XFT 支持，因此特定于 linux 的 hack 可以，但我更喜欢适用于所有目标的东西。

更新：需要明确的是，我使用的字体不是 Windows / OS X / Linux 上的标准字体。我不仅希望根据平台设置不同的字体，还希望指定我拥有的特定字体文件（TTF 在 Windows 和 Linux 上工作，如果不在 Mac 上，我将获得另一个版本的文件，但我仍然想要通过文件而不是名称指定字体）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T23:57:22.973

不幸的是，你不能。

不同平台上的 Emacs 使用不同的窗口工具包，所有这些工具包都负责字体处理。我不相信您可以在任何平台上的 Emacs 中指定字体*文件名*——它只是不能那样工作。

至于如何找到字体：

*   在 Linux 上，您可以使用 XFT 对特定于用户的字体配置文件的支持，该文件通常`~/.fonts.conf`（但请`/etc/fonts/font.conf`务必检查）添加您将字体放入的任何目录。

*   在 Mac 上，您可以将字体添加到`~/Library/Fonts`. TTF 在 Mac 上运行良好，顺便说一句。

*   在 Windows 上，我认为您只需将其添加到系统字体目录即可。

从那里，您然后去告诉 Emacs（通过自定义或不通过自定义）使用您的字体。您会发现每个平台上的命名方案都不同（不确定 Windows 是什么样子），但自定义应该有助于为您解决这个问题 - 如果需要，只需为每台机器保留一个单独的自定义文件。

...因此，基本上您的便携式 Emacs 设置必须包含的不仅仅是 Emacs 配置文件（考虑到您携带了一个字体文件，它已经包含了）。

# actionscript-3 - 使用嵌套 switch/case 语句的最佳/最简单方法是什么？

> ID：496189
> 
> 赞同：0
> 
> 时间：2009-01-30T16:37:50.613
> 
> 标签：actionscript-3, scripting, conditional, switch-statement

以下两个 switch/case 语句的更好做法是什么？

有没有更简单的方法（更少的代码）来做到这一点？

```
switch (myValue)
{
    case 1:
    {
        methodFor1();

        break;
    }
    case 2:
    case 3:
    {
        methodFor2or3();

        if (myValue == 2)
                methodFor2();

        if (myValue == 3)
                methodFor3();

        break;
    }
}

...or...

switch (myValue)
{
    case 1:
    {
        methodFor1();

        break;
    }
    case 2:
    case 3:
    {
        methodFor2or3();

        switch (myValue)
        {
            case 2:
            {
                methodFor2();

                break;
            }
            case 3:
            {
                methodFor3();

                break;
            }
        }

        break;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-30T16:43:25.033

```
switch (myValue)
{
  case 1:
    methodFor1();
    break;
  case 2:
    methodFor2or3();
    methodFor2();
    break;
  case 3:
    methodFor2or3();
    methodFor3();
    break;
} 
```

为什么所有的麻烦只是为了避免重复`methodFor2or3()` *一次*？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T16:42:06.753

另一种选择：

```
switch (myValue)
{
    case 1:
    {
        methodFor1();
        break;
    }
    case 2:
    {
        methodFor2or3();
        methodFor2();
        break;
    }
    case 3:
    {
        methodFor2or3();
        methodFor3();
        break;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T16:45:48.197

由于函数是 actionscript3 中的第一类对象，因此您可以将值的哈希值构建到函数中，如下所示：

```
var myDict:Dictionary = new Dictionary(); 
myDict[1] = methodFor1; 
myDict[2] = methodFor2;

function handleStuff(myVal:Number):void{
    var myFunction:Function = myDict[myVal];
    myFunction();
} 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T18:28:22.357

在我的语句编程中`switch`，我的目标是让每个案例最多有一行代码 + a `break;`。这是因为`switch`会很快变得大而复杂，而我的大脑不擅长复杂。

所以，在你的情况下，我会写：

```
switch (myValue)
{
    case 1:
    {
        methodFor1();
        break;
    }
    case 2:
    {
        methodFor2();
        break;
    }
    case 3:
    {
        methodFor3();
        break;
    }
} 
```

然后拨打`methodFor2`和`methodFor3`每次通话`methodFor2or3`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T16:45:16.060

如果这两种情况之间只有一条（相当简单的）线（如您的示例中的函数调用），那么我宁愿将这条线加倍，以提高可读性。否则，这是一个品味问题。我倾向于更喜欢语句中`if`的条件`case`，因为这样你就不会混淆各个级别。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T16:48:39.110

更像是：

```
var method:String = "methodFor" + String(value);
this[method]();
if (value == 3) methodFor2or3(); 
```

如果您想要更简单的代码，您可能会考虑拆分 or3 调用：

```
switch (value) {
    case 1: methodFor1(); break;
    case 2: methodFor2(); break;
    case 3: methodFor3(); break;
}
if (value == 2 || value == 3) methodFor2or3(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T17:10:35.040

当您处理控制问题的编程流程时，“更少的代码”并不是您真正想要优化的属性。解决结构性问题，让代码变得简单易读要好得多。

因此，对于上述情况，第一个选项还不错，尽管很容易错过 2 的“流通”情况。更好的是只在 1 或 2 上进行父开关，然后在第二种情况下调用另一个处理子案例（正式为 2 和 3）的函数，并使其由不同的（子案例）变量驱动（到确保您没有重载初始“值”变量的“含义”。

从哲学上讲，所有三种情况都是同一个开关的一部分，或者它们不是。如果是，那么他们应该被平等对待（并且彼此没有区别）。如果不是，那么它们应该由两个单独的变量驱动并在两个单独的函数中处理。试图通过组合它们来节省“带宽”会使事情变得不必要地复杂化。

保罗。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T17:12:39.000

我的回答是假设您知道您提供的示例案例是人为的，并且以其他方式编写得更好。如果您只想知道最好是嵌套开关还是在开关中使用 if-else，这完全取决于品味和个人情况。

在我看来，你的块在开关内这一事实没有任何区别。如果逻辑可以通过开关更好地服务，请使用开关（嵌套或不嵌套）。如果 if-else 会更好地服务，请使用它。

# c# - 如何让 Linq to SQL 识别动态存储过程的结果集？

> ID：496195
> 
> 赞同：8
> 
> 时间：2009-01-30T16:38:51.673
> 
> 标签：c#, sql, sql-server, linq-to-sql, stored-procedures

我正在使用带有 SQL Server 后端的 Linq-to-SQL（当然）作为项目的 ORM。我需要从从动态创建的表返回的存储过程中获取结果集。这是proc的样子：

```
CREATE procedure [RetailAdmin].[TitleSearch] (
@isbn varchar(50), @author varchar(50),
 @title varchar(50))
as

declare @L_isbn varchar(50)
declare @l_author varchar(50)
declare @l_title varchar(50)
declare @sql nvarchar(4000)

set  @L_isbn = rtrim(ltrim(@isbn))
set @l_author = rtrim(ltrim(@author))
set @l_title = rtrim(ltrim(@title))

CREATE TABLE #mytemp(
    [storeid] int not NULL,
    [Author] [varchar](100) NULL,
    [Title] [varchar](400) NULL,
    [ISBN] [varchar](50) NULL,
    [Imprint] [varchar](255) NULL,
    [Edition] [varchar](255) NULL,
    [Copyright] [varchar](100) NULL,
    [stockonhand] [int] NULL
)

set @sql  = 'select  a.storeid, Author,Title, thirteendigitisbn ISBN,  
Imprint,Edition,Copyright ,b.stockonhand from ods.items a join ods.inventory b on     
a.itemkey = b.itemkey where b.stockonhand <> 0  ' 

if len(@l_author) > 0
set @sql =  @sql + ' and author like ''%'+@L_author+'%'''

if len(@l_title) > 0
set @sql =  @sql + ' and title like ''%'+@l_title+'%'''

if len(@L_isbn) > 0
set @sql =  @sql + ' and thirteendigitisbn like ''%'+@L_isbn+'%'''

print @sql

if len(@l_author) <> 0 or len(@l_title) <>  0 or len(@L_isbn) <> 0 

begin
    insert into #mytemp
    EXECUTE sp_executesql  @sql
end 

select * from #mytemp
drop table #mytemp 
```

我没有写这个程序，但如果有一个非常严重的问题，可能会影响改变。

我现在的问题是，当我将这个过程添加到我的模型中时，设计器会生成这个函数：

```
[Function(Name="RetailAdmin.TitleSearch")]
public int TitleSearch([Parameter(DbType="VarChar(50)")] string isbn,  
  [Parameter(DbType="VarChar(50)")] string author, 
  [Parameter(DbType="VarChar(50)")] string title)
{
    IExecuteResult result = this.ExecuteMethodCall(this, 
        ((MethodInfo)(MethodInfo.GetCurrentMethod())), isbn, author, title);

    return ((int)(result.ReturnValue));
} 
```

这看起来不像我手动运行 proc 时得到的结果集：

![结果集](https://lh5.ggpht.com/_g6k7SWc-6HY/SYMrST6oPaI/AAAAAAAAAE8/KD6-NFPxcN0/s400/storedproc.jpeg)

谁能告诉我这里出了什么问题？

[这与这个问题](https://stackoverflow.com/questions/404186/problem-with-the-return-type-of-a-stored-procedure)基本上是相同的问题，但由于 OP 的措辞不佳，它从未真正得到回答。

* * *

感谢马克的回复。我会看到有关进行您建议的更改的信息。

问题是临时表。Linq to Sql 只是不知道如何处理它们。这特别难以诊断，因为 Visual Studio 缓存了有关存储过程的信息，因此当它最初未能找到结果集时，它将返回设置为默认整数类型，并且在我对存储过程进行更改时没有更新。让 VS 识别更改需要您：

*   从 dbml 中删除 proc
*   从服务器资源管理器中删除服务器连接
*   保存 dbml 以强制重新编译
*   关闭项目并重启VS
*   重新创建服务器连接并导入 proc

您可能不必执行这些步骤中的每一个，但这对我有用。如果您必须使用临时表，您需要做的是创建一个准系统 proc，它只返回正确的模式，然后在将其导入 OR 设计器后对其进行更改以执行您想要的操作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T16:45:47.040

没有真正简单的方法可以做到这一点。我过去也遇到过同样的问题。我认为问题在于 Linq to Sql 无法“确定”将返回哪种类型，因为您在执行时构建了 SELECT 语句。我为解决这个问题所做的工作是在存储过程中，我只做了一个选择并选择了我可能需要的所有列。然后，我让 Linq to Sql 以此为基础生成函数。然后，我回到 SQL 并将存储过程更改回它应该的方式。这里的诀窍是不要重新生成您的 DBML。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-30T22:12:13.717

首先 -**重要**- 您的 SQL 容易受到注入；内部命令应参数化：

```
if len(@l_author) > 0
set @sql =  @sql + ' and author like ''%''+@author+''%'''

EXECUTE sp_executesql  @sql, N'@author varchar(100)', @L_author 
```

这会将 in 的值`@L_author`作为`@author`动态命令中的参数传递 - 防止注入攻击。

* * *

第二 - 你真的不需要临时表。它没有为你做任何事情......你只是插入和选择。也许只是执行并让结果自然地流向调用者？

在其他情况下，表变量会更合适，但这不适用于 INSERT/EXEC。

* * *

每次调用的列都相同吗？如果是这样，请手动编写 dbml，或使用临时 SP（仅使用“WHERE 1=0”或其他内容）以便`SET FMT_ONLY ON`可以工作。

如果不是（每次使用不同的列），那么就没有一个简单的答案。在这种情况下，也许使用常规的 ADO.NET（`ExecuteReader`/ `IDataReader`- 甚至可能`DataTable.Fill`）。

当然，您可以让 LINQ 承担压力……（C#）：

```
...
if(!string.IsNullOrEmpty(author)) {
    query = query.Where(row => row.Author.Contains(author));
}
... 
```

ETC

# visual-studio - 手动编辑项目文件时如何将文件添加到源代码管理？

> ID：496196
> 
> 赞同：0
> 
> 时间：2009-01-30T16:38:51.797
> 
> 标签：visual-studio, version-control, project

我正在使用代码生成，并希望在生成完成后将新生成的文件自动添加到项目文件中。如果我通过修改项目文件来添加文件，它们不会像通过 IDE 添加它们时那样在它们旁边获得加号图标。因此，当我签入文件时，它们不会被添加到源代码管理中。

有没有办法以编程方式将文件添加到项目文件中，使其旁边有加号图标以将其添加到源代码管理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-01T20:29:39.583

您看到此行为的原因是，只有通过解决方案资源管理器添加文件才能调用 Visual Studio 源代码控制提供程序接口。直接修改项目文件不会通知源代码管理提供者需要向源代码管理添加新文件。如果您生成新文件，则生成这些文件的例程还需要调用源代码控制库（通常通过命令行界面，但也可以有 .net api）以将新创建​​的文件添加到源头控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T16:42:55.127

使用[CMake](http://cmake.org)而不是维护 VStudio 项目/工作区/解决方案文件。跟踪 CMakeLists.txt 文件，然后生成有效的构建环境。

# sql - 数据库性能和数据类型

> ID：496197
> 
> 赞同：3
> 
> 时间：2009-01-30T16:38:52.187
> 
> 标签：sql, sql-server, database-design, datetime

我正在支持由另一个开发人员编写的现有应用程序，并且我有一个问题，即开发人员选择存储日期的数据类型的选择是否会影响某些查询的性能。

相关信息：该应用程序大量使用了我们其中一张表中的“营业日期”字段。此业务日期的数据类型是 nvarchar(10) 而不是 datetime 数据类型。日期格式为“MM/DD/YYYY”，因此 2007 年圣诞节存储为“12/25/2007”。

长话短说，我们有一些每周运行一次的重型查询，并且需要很长时间才能执行。

我正在从头开始重写此应用程序，但是由于我正在查看此应用程序，因此我想知道使用 datetime 数据类型与在当前数据库中存储日期相比是否存在性能差异。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T16:43:20.337

如果您使用 datetime 而不是 nvarchar(10)，您将节省磁盘空间并提高性能。

如果您使用日期字段进行日期计算（*DATEADD*等），您将看到查询执行速度大幅提高，因为这些字段不需要在运行时转换为日期时间。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T16:43:23.787

在 s 上的操作比在s 上转换为s`DATETIME`更快。`VARCHAR``DATETIME`

如果您的日期出现在`SELECT`子句之外的任何地方（例如，您添加它们，`DATEDIFF`它们，在子句中搜索它们`WHERE`等），那么您应该将它们保持为内部格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T16:43:38.607

您实际上应该使用 DateTime 而不是 varchar 来存储日期的原因有很多。性能是一个......但我会担心这样的查询：

```
SELECT *
FROM Table
WHERE DateField > '12/25/2007' 
```

给你错误的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T16:44:15.063

我不能用数字来支持这一点，但是 datetime-type 应该快得多，因为它可以很容易地进行比较，不像 varchar。在我看来，将 UNIX 时间戳作为您的数据类型也值得一试。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T16:46:55.137

是的。对于日期计算，datetime 将比 varchar 或 nvarchar 更有效（为什么是 nvarchar - 你不可能在其中获得真正的 unicode，对吧？）。Plus 字符串可能无效和被误解。

如果您只使用日期部分，您的系统可能有一个较小的仅日期版本的日期时间。

此外，如果您只是在执行连接和某些类型的操作（`>/</=`比较但不是 datediff），那么在数据仓库中通常会使用实际上是 yyyymmdd 形式的 int 的日期“id”列。不幸的是，这确实允许“无效”日期，但它也允许**更明显**的保留、“特殊”日期，而在日期时间中，您可能会使用`NULL`1/1/1900 或其他日期。完整性通常通过对日期“维度”的外键约束来强制执行。

看到您将问题标记为“sql server”，我假设您使用的是 SQL Server 的某个版本，因此我建议您查看 using`datetime`或`smalldatetime`. 此外，在 SQL Server 2008 中，您有一个`date`类型以及一个`datetime2`范围更大的 a。查看[此链接](http://aspnet.4guysfromrolla.com/articles/101508-1.aspx#postadlink)，其中提供了一些详细信息

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T16:48:53.697

我相信从架构的角度来看，日期时间将是一种更有效的数据类型，因为它将存储为两个 4 字节整数，而您的 nvarchar(10) 将存储为最多 22 个字节（输入字符数的两倍+ 2 个字节。）。因此，与使用日期时间相比，现在可能需要两倍以上的存储空间。

这当然可能对索引产生影响，因为数据项越小，索引数据页上可以容纳的记录就越多。这反过来会产生一个较小的索引，它当然可以更快地遍历，因此会更快地返回结果。

总之，日期时间是要走的路。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T16:49:38.500

datetime 类型可能更紧凑、更快，但更重要的是，使用 DATETIMES 存储日期和时间是更好的架构选择。在查找某个日期范围之间的记录时，您不太可能遇到奇怪的问题，并且大多数数据库会将它们映射到您的语言 Date 类型，因此代码更简洁，从长远来看，这确实更重要。

即使速度较慢，您将花费更多时间来调试字符串作为日期，而不是所有用户所看到的节省的总和。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T16:54:07.477

nvarchar 字段中的日期过滤并不容易，因为索引中的数据按字典顺序排序，这与您期望的日期排序不匹配。这是日期格式“mm/dd/yyyy”的问题。这意味着“12/25/2007”将在 nvarchar 索引中的“12/01/2008”之后，但这不是您想要的。“yyyy/mm/dd”会很好。

因此，您应该使用日期字段并将字符串值转换为日期。你肯定会得到很大的性能提升。那是如果您可以更改表架构。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-30T20:21:29.507

使用 varchar（或任何其他字符串数据类型）的另一个问题是数据可能包含无效日期，因为它们不会在输入时自动验证。如果您尝试将文件更改为日期时间字段，您可能会遇到转换问题，因为人们添加了 ASAP、Unknown、1/32/2009 等日期。您需要使用方便的 isdate 函数，并在您尝试更改数据类型之前将它们修复或清空。

您可能还有很多代码可以即时将 varchar 类型转换为日期数据类型，以便您也可以进行日期数学运算。所有这些代码也需要修复。

# c++ - 如何为 7z 归档格式编写二进制数据？

> ID：496204
> 
> 赞同：3
> 
> 时间：2009-01-30T16:40:43.387
> 
> 标签：c++, std, 7zip, ofstream

我一直在倾注 7z 存档格式的格式描述和源代码，但我仍然无法编写有效的容器。我假设我可以创建一个空容器......无论如何这是我的开始：

```
std::ofstream ofs(archivename.c_str(), std::ios::binary|std::ios::trunc);

Byte signature[6] = {'7', 'z', 0xBC, 0xAF, 0x27, 0x1C};
Byte major = 0;
Byte minor = 3;

ofs.write((const char*)signature, 6);
ofs.write((const char*)major, 1);
ofs.write((const char*)minor, 1);

UInt64 offset = 0;
UInt64 size = 0;
UInt32 crc = 0;

ofs.write((const char*)offset, 4);
ofs.write((const char*)size, 8);
ofs.write((const char*)crc, 8);
ofs.write((const char*)CrcCalc(0, 0), 8);

ofs.close(); 
```

我认为我的主要问题是缺乏对 std::ofstream::write() 的理解。字节是“无符号字符”，UInt64 和 UInt32 都是“无符号长”。

**UPDATE0**：正如每个人都指出的那样，如果我在大端机器上运行它会是一个问题。这不是这里的情况。根据 Fredrik Janssen，我应该投射非数组的地址。我还应该提到 CrcCalc() 是 LZMA SDK 中的一个函数。添加 & 有点帮助，这是第一个 unsigned char[6] 有一些问题。

**UPDATE1**：工作代码在下面获取一个空的存档文件。

```
static void SetUInt32(Byte *p, UInt32 d)
{
  for (int i = 0; i < 4; i++, d >>= 8)
    p[i] = (Byte)d;
}

static void SetUInt64(Byte *p, UInt64 d)
{
  for (int i = 0; i < 8; i++, d >>= 8)
    p[i] = (Byte)d;
}

void make_7z_archive()
{
  CrcGenerateTable();

  std::ofstream ofs(archivename.c_str(), std::ios::binary|std::ios::trunc);

  Byte signature[6] = {'7', 'z', 0xBC, 0xAF, 0x27, 0x1C};
  Byte major = 0;
  Byte minor = 3;

  ofs.write((const char*)signature, 6);
  ofs.write((const char*)&major, 1);
  ofs.write((const char*)&minor, 1);

  UInt64 offset = 0;
  UInt64 size = 0;
  UInt32 crc = 0;

  Byte buf[24];
  SetUInt64(buf + 4, offset);
  SetUInt64(buf + 12, size);
  SetUInt32(buf + 20, crc);
  SetUInt32(buf, CrcCalc(buf + 4, 20));

  ofs.write((const char*)buf, 24);

  ofs.close();
} 
```

注意：CrcGenerateTable() 和 CrcCalc() 来自 LZMA SDK。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T16:45:16.823

不知道 7z 的格式，但我注意到当你写下偏移量、大小和 crc 时，这些将以 little-endian 格式写入文件（我假设你有一个 little-endian CPU）。

编辑：可能更糟的是，您在major、minor、offset、size 和crc 之前缺少&，即您将实际值转换为指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T18:25:52.127

呃……我很困惑。它有一个[SDK](http://www.7-zip.org/sdk.html) ......你在你的帖子中提到......还有[7-zip 源代码在线](http://www.7-zip.org/7z.html)。另请参阅SourceForge 上的[p7zip](http://sourceforge.net/projects/p7zip/)。我只是浏览了 p7zip 的源代码，有一堆以“7z”开头的文件看起来可以解决问题。

我自己没有以编程方式使用 7z 格式（仅通过命令行 util/GUI），但为什么您需要自己处理这些低级的事情而不是通过 SDK？（除了因为 LGPL 许可）

# sql-server - SQL 物理数据库文件位置（恢复）？

> ID：496212
> 
> 赞同：1
> 
> 时间：2009-01-30T16:42:07.440
> 
> 标签：sql-server, recovery

我最近刚刚更换了所有硬盘驱动器，在再次设置一些项目的过程中，我注意到我正在备份的数据库文件实际上是错误的文件，因为它只包含我运行的数据库的 30%。我有我的旧驱动器，所有数据都应该完好无损，但我一直无法真正找到正确的数据库文件......

有什么方法可以从死 SQL Server 中读取物理文件位置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T16:56:32.603

从旧的 SQL Server 实例中获取主数据库并将其附加到新系统，或者恢复主数据库的备份，以便您可以查询它。（只是不要覆盖/替换实时系统的主数据库！）

从 sysdatabases 中选择 [名称]、文件名

将为您提供该服务器上的数据库列表以及完整的文件路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T16:08:19.447

Sys.Databases 接受的答案不会为您提供物理文件位置。对于仍在寻找它的任何人，您需要查询：

```
SELECT [name], [physical_name] FROM sys.database_files 
```

# c++ - 如何在 VS C++ 项目中使用 T4 代码生成模板？

> ID：496214
> 
> 赞同：12
> 
> 时间：2009-01-30T16:42:56.563
> 
> 标签：c++, visual-studio, t4

T4 模板文件可在 C# 项目下由 IDE 自动识别，但我不知道如何将它们集成到 C++ 项目中（除了使用 make 文件）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-02-02T06:26:12.547

T4 模板文件可以集成到 C++ 项目中，但它比 C#/VB 项目需要更多的工作。在您的 C++ 项目中创建一个新的文本文件并为其提供 .tt 扩展名。然后像往常一样编写模板。然后，C++ 项目需要进一步的工作以使其转换模板。我让它工作的快速而肮脏的方法是添加一个自定义构建步骤并让它直接调用“C:\Program Files\Common Files\Microsoft Shared\TextTemplating\1.1\TextTransform.exe”。我发现的另一种方法是添加自定义 MSBuild 任务。说明可以在[这里找到](http://geekswithblogs.net/EltonStoneman/archive/2008/07/25/an-msbuild-task-to-execute-t4-templates.aspx)

[此](http://www.hanselman.com/blog/T4TextTemplateTransformationToolkitCodeGenerationBestKeptVisualStudioSecret.aspx)页面包含更多信息和一些关于使用 T4 代码生成的其他页面的良好链接。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-06-27T00:10:12.770

MSBuild 任务将不起作用，因为这是一个 vcproj 文件 (C++)，因此使用了 vcbuild。编译 tt 的最简单方法是添加一个自定义构建步骤，如下所示。

```
"C:\Program Files (x86)\Common Files\Microsoft Shared\TextTemplating\1.1\TextTransform.exe" -out "$(ProjectDir)\VSProject.cpp" -I "$(ProjectDir)" "$(ProjectDir)\VSProject.tt" 
```

我花了几个小时研究上面的 MSBuild Task 解决方案，它对于托管代码非常好，但我看不到任何将它用于 C++ 的方法（将 vcproj 转换为 csproj eek）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-07-19T17:35:43.807

### 对于 Visual Studio 2017（也许是 2015 年？）

其他答案中列出的命令部分不正确，因为文件`TextTransform.exe`已移动到新目录：`devenv`根文件夹，例如：

```
C:\Progra~1\Visual Studio 2017\Enterprise\Common7\IDE 
```

该命令现在应该更新为以下内容：

```
"$(DevEnvDir)TextTransform.exe" -out "$(ProjectDir)xxx.cpp" "$(ProjectDir)xxx.tt" 
```

你的模板文件`xxx`的文件名在哪里`.tt`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-09T11:45:24.103

在尝试了上述一些方法（发现它们不适合我的具体情况）后，我采取了另一种方法，其他人可能会觉得有帮助。

我没有努力让 VS 在 C++ 项目中接受 T4 模板，而是在我的解决方案中添加了一个单独的（空的）C# 项目。我将我的模板文件放在解决方案的根目录，并从 C# 项目中添加一个指向它的链接。我#include 从我的 C++ 项目中生成的 .h 文件。

我使用模板生成了一个版本字符串，该字符串会随着每次构建而更新。我将[AutoT4](https://marketplace.visualstudio.com/items?itemName=BennorMcCarthy.AutoT4)工具添加到 VS，以便每次构建解决方案时都会更新字符串。

# c# - 在 .NET (C#) Web 服务中本机返回 XML？

> ID：496222
> 
> 赞同：11
> 
> 时间：2009-01-30T16:44:03.673
> 
> 标签：c#, .net, xml, web-services

我意识到 .NET 中的 SOAP Web 服务返回 Web 方法返回的任何对象的 XML 表示，但是如果我想以 XML 格式返回数据格式，存储它的最佳对象是什么？

我正在使用[这个问题的](https://stackoverflow.com/questions/220867/how-to-deal-with-xml-in-c)[答案](https://stackoverflow.com/questions/220867/how-to-deal-with-xml-in-c/220981#220981)来编写我的 XML，代码如下：

```
XmlWriter writer = XmlWriter.Create(pathToOutput);
writer.WriteStartDocument();
writer.WriteStartElement("People");

writer.WriteStartElement("Person");
writer.WriteAttributeString("Name", "Nick");
writer.WriteEndElement();

writer.WriteStartElement("Person");
writer.WriteStartAttribute("Name");
writer.WriteValue("Nick");
writer.WriteEndAttribute();
writer.WriteEndElement();

writer.WriteEndElement();
writer.WriteEndDocument();

writer.Flush(); 
```

现在我可以将此输出作为字符串返回给我的调用 web 方法，但它显示为`<string> XML HERE </string>`，无论如何只返回完整的 xml 吗？

请在您的回答中，举例说明如何将所述对象与 XmlWriter 或另一个内部对象一起使用（如果您认为 XmlWriter 是一个糟糕的选择）。System.Xml 包（命名空间）有很多对象，但我无法找到关于如何一起使用这些对象或在什么情况下使用什么的合适文档。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-30T19:32:09.717

这就是我最终这样做的方式；

```
StringBuilder sb = new StringBuilder();
XmlWriter writer = XmlWriter.Create(sb, settings);

writer.WriteStartDocument();
writer.WriteStartElement("People");

writer.WriteStartElement("Person");
writer.WriteAttributeString("Name", "Nick");
writer.WriteEndElement();

writer.WriteStartElement("Person");
writer.WriteStartAttribute("Name");
writer.WriteValue("Nick");
writer.WriteEndAttribute();
writer.WriteEndElement();

writer.WriteEndElement();
writer.WriteEndDocument();

writer.Flush();

XmlDocument xmlDocument = new XmlDocument();
xmlDocument.LoadXml(sb.ToString());
return xmlDocument; 
```

可能不是最好的方法，但它似乎有效。如果您有更好的方法，请告诉我。谢谢。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-30T17:26:12.637

只需返回一个 XmlDocument。例如

```
[WebMethod]
public XmlDocument Quux()
{

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-27T05:52:04.210

XmlElement，而不是 XmlDocument。

[返回一个 XmlElement](http://msdn.microsoft.com/en-us/library/aa480498.aspx)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T17:31:51.923

您可以有一个代表您的 XML 的类并返回该类，或者也可以在 XMLNode 中返回您的 xml

# c++ - char a[] 的语义

> ID：496226
> 
> 赞同：14
> 
> 时间：2009-01-30T16:44:29.853
> 
> 标签：c++, c, pointers, semantics

我最近在向同事解释原因时让自己感到尴尬

```
char a[100];
scanf("%s", &a); // notice a & in front of 'a' 
```

非常糟糕，稍微好一点的方法是：

```
char a[100];
scanf("%s", a); // notice no & in front of 'a' 
```

好的。对于每个准备告诉我为什么出于安全原因无论如何都不应该使用 scanf 的人：放轻松。这个问题实际上是关于“&a”与“a”的含义。

问题是，在我解释了它为什么不起作用之后，我们尝试了它（使用 gcc）并且它起作用了 =))。我跑了一个快

```
printf("%p %p", a, &a); 
```

它会打印两次相同的地址。

任何人都可以向我解释发生了什么事吗？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-30T16:52:01.863

好吧，`&a`案子应该很明显了。您完全按照预期获取数组的地址。 `a`有点微妙，但答案是`a` *数组*。并且正如任何 C 程序员都知道的那样，数组倾向于在最轻微的刺激下退化为指针，*例如*在将它作为函数参数传递时。

所以`scanf("%s", a)`需要一个指针，而不是数组，所以数组退化为指向数组第一个元素的指针。

当然`scanf("%s", &a)`也可以，因为那是数组的明确地址。

*编辑：*哎呀，看起来我完全没有考虑 scanf 实际期望的参数类型。这两种情况都会产生一个指向相同地址但类型不同的指针。（指向字符的指针，而不是指向字符数组的指针）。

我很乐意承认我对省略号 (...) 的语义知之甚少，我总是像瘟疫一样避免这种情况，所以看起来转换为 scanf 最终使用的任何类型都可能是未定义的行为。阅读评论和 litb 的答案。你通常可以相信他能把这些东西做好。;)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-01-30T17:03:29.143

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-30T17:30:47.403

自从我用 C 编程以来已经有一段时间了，但这是我的 2c：

`char a[100]`不会为数组的地址分配单独的变量，因此内存分配如下所示：

```
 ---+-----+---
 ...|0..99|...
 ---+-----+---
    ^
    a == &a 
```

为了比较，如果数组是 malloc 的，那么指针有一个单独的变量，并且`a != &a`.

```
char *a;
a = malloc(100); 
```

在这种情况下，内存如下所示：

```
 ---+---+---+-----+---
 ...| a |...|0..99|...
 ---+---+---+-----+---
    ^       ^
    &a  !=  a 
```

[K&R 第 2 版。](http://en.wikipedia.org/wiki/C_(programming_language)#K.26R_C)p.99 很好地描述了它：

> 索引和指针算法之间的对应关系非常密切。根据定义，数组类型的变量或表达式的值是数组元素零的地址。因而赋值后又具有相同的`pa=&a[0];` `pa`值`a`。由于数组的名称是初始元素位置的同义词，因此赋值`pa=&a[0]`也可以写为`pa=a;`

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-30T17:20:43.833

AC 数组可以隐式转换为指向其第一个元素的指针（C99:TC3 6.3.2.1 §3），即在很多情况下`a`（具有 type `char [100]`）的行为方式与`&a[0]`（具有 type `char *`）相同。这解释了为什么`a`作为参数传递会起作用。

但是不要开始认为情况总是如此：数组和指针之间存在重要差异，例如关于赋值，`sizeof`以及我现在想不到的其他任何东西......

`&a`实际上是这些陷阱之一：这将创建一个指向数组的指针，即它具有类型`char (*) [100]`（而*不是* `char **`）。这意味着`&a`并且`&a[0]`将指向相同的内存位置，但将具有不同的类型。

据我所知，这些类型之间没有隐式转换，也不保证它们也具有兼容的表示形式。我能找到的只有 C99:TC3 6.2.5 §27，它没有太多关于指向数组的指针：

> [...]指向其他类型的指针不需要具有相同的表示或对齐要求。

但也有 6.3.2.3 §7：

> [...]当指向对象的指针转换为指向字符类型的指针时，结果指向对象的最低寻址字节。结果的连续增量，直到对象的大小，产生指向对象剩余字节的指针。

所以演员`(char *)&a`应该按预期工作。实际上，我在这里假设数组的最低寻址字节将是其第一个元素的最低寻址字节 - 不确定这是否得到保证，或者编译器是否可以自由地在数组前面添加任意填充，但是如果是这样，那就太奇怪了……

无论如何，要使其正常工作，`&a`仍然必须强制转换为`char *`（或`void *`- 标准保证这些类型具有兼容的表示形式）。问题是除了默认参数提升之外，不会有任何转换应用于变量参数，即您必须自己显式地进行转换。

* * *

**总结一下：**

`&a`是 类型`char (*) [100]`，它可能具有与 不同的位表示`char *`。因此，程序员必须进行显式转换，因为对于变量参数，编译器无法知道它应该将值转换为什么。这意味着只会进行默认参数提升，正如*litb 所*指出的那样，它不包括转换为`void *`. 它遵循：

*   `scanf("%s", a);`- 好的
*   `scanf("%s", &a);`- 坏的
*   `scanf("%s", (char *)&a);`- 应该可以

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-30T16:57:20.077

抱歉，有点跑题了：

这让我想起了大约 8 年前我在全职编写 C 时读到的一篇文章。我找不到这篇文章，但我认为它的标题是“数组不是指针”或类似的东西。无论如何，我确实遇到了这个[C 数组和指针常见问题解答](http://www.lysator.liu.se/c/c-faq/c-2.html)，这很有趣。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T17:06:34.473

`char [100]`是 100 个相邻 的复数类型`char`，`sizeof`等于 100。

被强制转换为指针 ( `(void*) a`)，此变量产生第一个的地址`char`。

引用这种类型的变量 ( `&a`) 产生整个变量的地址，而这又恰好是第一个变量的地址`char`

# java - 你最好的 Swing 设计模式和技巧是什么？

> ID：496233
> 
> 赞同：37
> 
> 时间：2009-01-30T16:45:59.287
> 
> 标签：java, user-interface, design-patterns, swing

我正在使用 Swing 为应用程序编写 GUI，并且为了代码维护和可读性，我希望在整个系统中遵循一致的模式。

我读过的大多数文章和书籍（或至少书籍部分）似乎都提供了大量关于如何创建和安排各种组件的示例，但忽略了编写完整 GUI 的大局。

应用程序 GUI 设计的最佳技巧是什么？在设计或重构 GUI 应用程序时，您遵循哪些模式？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-30T18:13:20.890

永远不要从 JDialog、JFrame 或 JInternalFrame 派生来定义您的表单、对话框......

而是派生自JPanel。这将为您带来以下优势：

*   例如，以后可以从 JFrame 更改为 JDialog（因为用户改变了主意）
*   您可以将一个面板实例从一个 JDialog 重用到另一个（JDialog 通常不可重用，因为它们是通过对其“父级”、框架或另一个对话框的引用来构建的）
*   您可以稍后更改将 JDialog 替换为来自 3rd-party 框架的功能更强大的子类。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-30T16:49:07.067

使用布局管理器。您可能认为现在用硬编码位置定位所有内容更简单（特别是如果您使用图形布局工具），但是当需要更新 gui 或将其国际化时，您的继任者会讨厌您。（相信我，我是那个从一开始就说要使用布局管理器的人，也是那个忽略我的人的继任者。）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2009-01-30T16:52:20.257

避免使用 GUI 布局设计器（构建器）。稍后它将使您的代码更清晰，更易于维护。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-01-31T02:28:56.193

我认为良好的**并发**工作知识通常被低估了。您确实需要熟悉 Swing 的线程策略和通用同步技术来构建响应式 GUI 和高效的后端。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-01-30T18:30:24.910

当用户多次单击操作按钮时，避免产生过多线程。在第一次单击时禁用按钮，在后台线程中生成您的操作，完成后，再次启用按钮。对于短期运行的任务，这可能不是问题。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-01-30T16:59:03.643

mvc 是你的朋友。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2009-01-30T18:03:54.560

这是关于你的 GUI 代表什么的更抽象的高级答案，而不是它的机制。

根据您的任务，制作它可能有点困难，因此您的用户可以从概念上掌握 GUI 正在做什么。我已经完成了一些涉及 GUI 的非常棘手的工作，而我最成功的方法是采用一组复杂的控件并将它们放入用户期望的布局中。

例如，我编写了一个系统来管理 T1 线路两端的 2 个设备（有点像调制解调器）。控件真的很难理解——诸如“创建环回、测试远端信号、测试近端位模式、发送各种位模式……”（这是一个巨大的过度简化，比这更糟糕）

我必须真正理解这个问题，所以我去找了一位技术支持代表，他一直在帮助客户解决这个问题。他向我展示了手册中的图表，并引导我了解了不同控件在该图表上的作用。

我拿了图表，使用图形重新创建它（大部分只是简单的线条图，但它显示了两端和它们之间的连接），然后使用图形区域来表示控件和反馈（颜色变化） . 您可以直观地看到信号正在发出。当您在远端打开环回时，您可以看到线路将信号循环回其输出线路，然后您可以看到颜色发生变化，因为您的近端开始获得它正在发送的模式，它是另一条线路.

“控件”比这要复杂得多，但 GUI 将其简化为客户理解问题所需的确切内容。

在此之后，我们有客户回来告诉我们，他们以前从未能够弄清楚这些东西，但现在他们完全明白了！

这个演示比 GUI 实现的布线重要得多。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2009-01-30T17:02:30.797

养成让你的回调产生线程来完成实际工作的习惯，然后当你的一个回调变成一个耗时的怪物时，你就不会有冻结的 GUI。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2009-01-30T18:28:27.177

当组合更容易时避免继承。

例如我见过很多这样的：

```
public class CustomerSupportApp extends JFrame { 
     JList<Customer> customers;
     OtherBusinessComponent importantComponent;

     etc. etc

} 
```

这是将业务逻辑与表示混合在一起。它只会使改变从困难变为不可能。

更好的是：

```
public class CustomerSupportApp { 
     JList<Customer> customers;
     OtherBusinessComponent importantComponent;
     // The app HAS-A frame but not IS-A frame
     JFrame frame;
     etc. etc
} 
```

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2009-03-30T17:09:06.707

大量使用 MVC 模式。这是我的意思的一个简单示例：

```
class Person
{
  String firstName;
  String lastName;
  // and getters and setters...
}

class PersonSwingModel
{
  private Person person;
  private javax.swing.text.PlainDocument firstName;
  private javax.swing.text.PlainDocument lastName;
  // and getters and setters...
  // Create some method like init() that initializes PlainDocument values
  // to attributes in model.
}

class SavePersonAction extends AbstractAction
{
  private PersonSwingModel model;
  // and getters and setters...
}

class PersonSwingView extends JFrame
{
  private PersonSwingModel model;
  private javax.swing.JTextField firstName;
  private javax.swing.JTextField lastName;
  private SavePersonAction savePersonAction; // hook up to JButton/JMenuItem
  // and getters and setters...
  // Create some method like init() which binds PlainDocument to JTextField
  // and Actions to JButtons or JMenuItems
} 
```

我看到有些人不同意扩展 JFrame 或 JPanel。我不。为我工作。

此外，使用 LayoutManagers。GridBagLayout 非常强大。如果您使用它，请定义一些 GridBagConstraints 常量（如 LABEL_GBC 和 FIELD_GBC）并继续重用它们。

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2011-03-02T23:47:36.630

*   Karsten Lentzsch 的 JGoodies 对我的架构设计非常有帮助，尤其是在表示模型模式、绑定和验证方面。查看他的[文章](http://www.jgoodies.com/articles/)和[图书馆](http://www.jgoodies.com/downloads/libraries.html)。
*   使用类似 MVC 的模式。我说“喜欢”是因为目标实际上是将视图与模型分开，而不是符合 MVC 的特定风格。我更喜欢自己使用[演示模型](http://martinfowler.com/eaaDev/PresentationModel.html)。
*   [MiGLayout](http://www.miglayout.com/) - 除非有基本的布局管理器，否则我将它用于一切。
*   尽可能模块化和重用。
*   [WindowBuilder Pro](http://code.google.com/javadevtools/download-wbpro.html) for Eclipse - 最好的可视化设计器，因为它适用于现有/编辑过的代码，不会把你锁在里面。而且它现在是免费的！我对使用设计器没有意见，因为视图应该与其他代码分开。
*   [Netbeans Platform](http://netbeans.org/features/platform/) (RCP) - 唯一真正的 Swing 框架。我希望在有时间的时候学习和使用它，因为框架的一部分工作就是解决像你这样的问题。
*   [JavaBuilders](http://code.google.com/p/javabuilders/) - Cool project that allows declarative UIs, but I'm not sure it's mature enough to risk it, especially with an existing project. However it's interesting to read their PDF book if only to understand the problems they're trying to solve.

* * *

## 回答 #12

> 赞同：5
> 
> 时间：2009-01-30T17:52:53.520

尽量不要将文本编码到您的应用程序中。Swing gui 可以很容易地编写为数据驱动，考虑在 xml 文件中定义您的 GUI（包括组件名称和位置/布局属性）。

我在具有大量属性表的系统上工作（它们只是一堆控件，一页又一页）——如果不使其成为数据驱动的，几乎不可能维护或国际化。

如果您决定使用 GUI 构建器，请不要修改它输出的代码（如果可以避免的话）——最好从外部类绑定到 GUI。想想如果你不得不在没有构建器的情况下做会发生什么——移植会很困难吗？不可能的？

了解 Swing 中的陷阱——仅从 AWT 线程修改 GUI 组件，尽快返回 AWT 线程（如果您必须执行任何超过 100 毫秒的操作，则生成一个新线程），

尽量保持代码干燥——使用 Swing GUI 可能是一个真正的编程挑战——再一次，数据驱动代码是我发现的唯一方法，它不会像 new JButton("...") 这样不断重复代码;

如果您的数据是基于属性表的，请认真考虑创建一种绑定机制来将您的控件与数据联系起来。DRY 代码的一个好的目标是每个控件使用 0（零）行特定于控件的代码，以便从数据库中获取一段数据到 GUI，让用户对其进行编辑并将其返回到您的数据库中。这意味着您应该能够通过修改数据来添加新控件。

* * *

## 回答 #13

> 赞同：5
> 
> 时间：2009-01-30T18:27:39.723

您不应该扩展 JFrame、JDialog、JPanel、JButton、Janything 类（尽管某些对表行为的扩展只有在扩展时才可用）。如果您想做自定义组件，可以扩展 JComponent。如果应该实现模型（例如通过扩展抽象模型）、侦听器（例如通过扩展适配器），仅此而已。您通常不需要/必须扩展 swing 组件，最好不要这样做，因为它会使您的代码与超类的实现相关联。

* * *

## 回答 #14

> 赞同：4
> 
> 时间：2009-01-30T17:29:11.587

绝对将 GUI 放在一个类中，将逻辑放在另一个类或多个类中——尽最大可能。如果您使用[MVC（模型-视图-控制器）](http://en.wikipedia.org/wiki/Model-view-controller)模式，这将自动发生。如果不这样做，GUI 将很快变得复杂到难以维护。

* * *

## 回答 #15

> 赞同：3
> 
> 时间：2009-01-30T18:09:20.070

查看应用程序框架 API（[https://appframework.dev.java.net/](https://appframework.dev.java.net/)和[http://java.sun.com/developer/technicalArticles/javase/swingappfr/](http://java.sun.com/developer/technicalArticles/javase/swingappfr/)。它是构建您的摇摆应用程序的绝佳 API . 例如：所有样式（颜色、字体、图标...）都在一个简单的配置文件中定义。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-01-30T19:12:06.183

我认为您将面临的主要问题是您的 gui 应用程序的可测试性。

因此，关于单元测试的可维护性和易用性，我倾向于“Presenter first”，而不是 Model View Controller (MVC) 和其他指示您让视图了解实际应用程序逻辑 (Model) 的派生词。最好的资源是把它作为一种想法引入的小组的[网站。](http://www.atomicobject.com/pages/Presenter+First)

由于使用这样的方法需要大量样板代码来初始化应用程序的各种元素，我还建议使用依赖注入框架。我已经和[Guice](http://code.google.com/p/google-guice/)和好了。

# c# - TextRenderingHint.SingleBitPerPixel 不删除条码上的抗锯齿

> ID：496243
> 
> 赞同：0
> 
> 时间：2009-01-30T16:47:24.993
> 
> 标签：c#, barcode, antialiasing

我希望有人能帮忙。TextRenderingHint.SingleBitPerPixel 在从 .net 打印条形码时显然没有关闭抗锯齿功能。

这是实际呈现条形码的代码片段：

```
 graphics.TextRenderingHint = TextRenderingHint.SingleBitPerPixel;

    graphics.DrawString(
        barCodeText,
        humanReadableFont,
        Brushes.Black,
        currentXPosition,
        currentYPosition,
        StringFormat.GenericTypographic); 
```

为了在调试期间仔细检查输出，我通过“Microsoft Office Document Image Writer”打印机打印到 .tiff 格式的文件。放大 .tiff 时，抗锯齿清晰可见，为黑色条码条周围的灰色光环。

同样，当打印到实际打印机（HP Laser Jet 仿真模式下的 BOCA 票据打印机）时，条码渗色/显示比预期的更粗。

我知道条形码在语法上是正确的，因为在较大的点尺寸下它可以扫描。我也知道打印机能够打印至少与我要求的一样小的清晰条形码，因为在它的本机“FGL”模式下，它打印的清晰条形码甚至比我的还小。

我使用的字体是 Elfring Fonts Inc 的“Code 128AB”和“Code 128AB HR”。

谢谢

约阿希姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-25T16:31:57.120

好的，最终这里出现了两个问题：

1）条形码字体的制造商没有设计要打印的字体像我试图打印的那样小。我不是字体专家，所以我相信他们的话。但我并不完全相信我正在打印的打印机可以使用它的“演示”模式准确打印比这更小的条形码。

2) 我看到的“光环”效果实际上是 Windows 的“图片和传真查看器”，它试图让我的东西变得漂亮。当我尝试不同的软件时，条形图清晰明了。

# sql - SQL Server 2005 中可以进行条件连接吗？

> ID：496244
> 
> 赞同：1
> 
> 时间：2009-01-30T16:47:33.107
> 
> 标签：sql, sql-server

我需要编写一个选择查询，根据条件（在本例中，基于其中一列中的值）连接表。我想做这样的事情：

```
SELECT *
  FROM TableA
       INNER JOIN TableB ON (TableA.Column1 = TableB.Column1 OR TableA.Column1 = 0) -- Does not work! 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T16:53:23.547

我不确定您在做什么，但似乎您正在寻找外部连接：

```
SELECT *
FROM TableA LEFT OUTER JOIN TableB ON TableA.Column1 = TableB.Column1
WHERE TableB.Column1 IS NOT NULL
   OR TableA.Column1 = 0 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T16:59:26.373

这应该可以实现您所需要的：

```
SELECT *
FROM TableA A
WHERE A.Column1 = 0
   OR EXISTS(
            SELECT B.Column1
            FROM TableB B
            WHERE B.Column1 = A.Column1
            ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T17:16:15.390

如果您想要表 A 中的行和表 B 中的行，只需使用由**UNION**命令分隔的两个选择语句。

# user-interface - 完全在 QtScript 中创建 GUI 应用程序，您的意见是什么？

> ID：496245
> 
> 赞同：7
> 
> 时间：2009-01-30T16:47:45.913
> 
> 标签：user-interface, qt, qtscript

由于宣布了 QT 许可证更改，我开始研究 QT 框架。它看起来不错，但我不喜欢使用 C++。我知道各种语言有不同的绑定，但**QtScript**对我来说似乎最有趣。

是否可以使用 QtScript 编写完整的 GUI 应用程序（当然，在 UI 设计师的帮助下），或者它仅用于编写现有应用程序的部分脚本。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-03-07T23:12:03.220

是的，完全有可能这样做。但是，由于 Qt（直到 4.5）默认情况下不提供 Qt 脚本绑定，因此您需要生成它并可能将其包含在您的应用程序中。但这只是一次性步骤，请参阅[http://labs.trolltech.com/page/Projects/QtScript/Generator](http://labs.trolltech.com/page/Projects/QtScript/Generator)以获取绑定。

这是一个示例： http: [//labs.trolltech.com/blogs/2009/01/06/simple-qtscript-based-bar-chart/](http://labs.trolltech.com/blogs/2009/01/06/simple-qtscript-based-bar-chart/)。应用程序逻辑完全在 QtScript 中。您只需要使用解释器启动（参见上面的绑定生成器）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T20:34:41.697

QtScript 旨在让您将应用程序的部分内容导出到脚本引擎，从而获得更大的灵活性。您还必须编写一些 C++ 代码来支持 QtScript 部分。根据您的喜好，我会坚持使用您已经检查过的替代方案，例如 PyQt 或 QtRuby。

# c# - 托管 SilverLight 网站

> ID：496247
> 
> 赞同：0
> 
> 时间：2009-01-30T16:48:06.257
> 
> 标签：c#, silverlight-2.0

我是网络开发新手，正在寻求帮助:-)

我按照银光教程构建了一个基本的银光应用程序。

[http://weblogs.asp.net/scottgu/pages/silverlight-2-end-to-end-tutorial-building-a-digg-search-client.aspx](http://weblogs.asp.net/scottgu/pages/silverlight-2-end-to-end-tutorial-building-a-digg-search-client.aspx)

然后我在aspspider上托管了这个应用程序。我现在已经修改了应用程序以连接到 SQLExpress Db。这使用“WCF 服务”和“Linq to sql 类”来执行数据库搜索。这一切都在 Visualstudio 中完美运行，但是我不确定如何使其在 aspSpider 主机中运行。

到目前为止，我已经成功地连接了 Db，并让银灯 xap 工作。但显然，当我单击网站中的搜索按钮时，由于服务失败，我得到一个空白屏幕。

任何帮助都会很棒！

Bellow 是项目中的文件列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-08T06:58:16.410

问题是由于silverlight的跨域策略。参考以下链接 [http://blogs.msdn.com/silverlightws/archive/2008/03/30/some-tips-on-cross-domain-calls.aspx](http://blogs.msdn.com/silverlightws/archive/2008/03/30/some-tips-on-cross-domain-calls.aspx)

# asp.net - 匿名访问 (IIS) 和 SQL Server

> ID：496255
> 
> 赞同：9
> 
> 时间：2009-01-30T16:49:28.860
> 
> 标签：asp.net, security, iis

我刚刚在雷德蒙德接受了一次采访，他们问了我很多关于 asp.net 的安全问题。他们提出的问题之一是关于配置安全的 Intranet 应用程序以使用约束委派访问 SQL Server。在这种情况下，AD 用户帐户被委派访问 SQL Server。当然，整个目的是 a) 不在 Web 服务器 (web.config) 的任何位置存储任何用户名/密码，并且 b) 提供可以在 Active Directory 中管理的抽象安全模型。

这让我开始思考这些年来我是如何将我的网站配置为匿名访问的。通常我会使用默认匿名帐户运行我的 IIS 网站，并将连接字符串存储在 web.config 中（加密，有时以明文形式）。当然，这需要您的 SQL Server 以混合模式运行。所以我的问题是，如果我们根本不将连接字符串存储在 web.config 中，而只是为在 SQL Server 中具有 db_datareader 访问权限的特定网站创建了一个唯一的匿名域帐户，该怎么办？有什么理由说明这样做是个坏主意吗？

我试图考虑所有这将是一个坏主意的场景，而我唯一能想到的是“黑客”破坏了 Web 服务器上的代码，然后以某种方式访问​​了您的 SQL Server.. .但这可能发生在任何一种情况下。

有谁知道这里的最佳做法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T18:06:32.743

也许您可以使用 ODBC 为 SQL Server 连接创建 DSN。那么你的 web.config 只需要知道 DSN。这可能需要您使用 System.Data.OleDb。我从未见过在 ASP.NET 中使用过 DSN，但它曾经是经典 ASP 的标准。而且我从未听说过使用 Active Directory 来管理 ODBC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T18:28:23.527

在我工作的地方，我们有一个在特定域帐户下运行的 Windows 服务。该帐户在 SQL Server 中设置为登录名，并且它在需要访问的数据库中具有匹配的用户。我们从来没有遇到过任何问题。

我认为最重要的是正确配置您的数据库用户（或角色），以便它只能访问它需要的内容。

我考虑过使用 AD 以您在第一段中描述的类似方式管理 SQL 访问。（AD 组 -> SQL Server 登录 -> DB 用户 -> DB 对象）到目前为止，我看到的唯一缺点是，如果用户直接连接到数据库，他们将绕过您应用程序中的任何逻辑。一个好处是，您知道哪些域用户正在访问您的数据库。

# asp.net - ASP.NET 页面说我需要引用一个不存在的程序集！

> ID：496269
> 
> 赞同：12
> 
> 时间：2009-01-30T16:52:32.770
> 
> 标签：asp.net, compilation

我的 asp.net 站点必须在多个客户端服务器上运行。它在大多数情况下都可以正常工作，但是有几个在几页上遇到了错误消息：

> 编译器错误消息：CS0012：“MetaNameValuePair”类型在未引用的程序集中定义。您必须添加对程序集“App_Code.t_3vcono，Version=0.0.0.0，Culture=neutral，PublicKeyToken=null”的引用。

'MetaNameValuePair' 类型实际上是在我的 App_Code 文件夹中的 .cs 文件中定义的，而不是外部程序集。是否无法编译该 .cs 文件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-30T16:56:16.723

尝试1：

几个月前有人问了[一个类似的问题，看看这些答案。](https://stackoverflow.com/questions/284433/strange-error-cs0012-the-type-x-is-defined-in-an-assembly-that-is-not-referenc)

尝试2：

您是否清除了站点的“临时 ASP.Net 文件”，通常位于 C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files？可能有一个旧副本徘徊。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2010-12-10T13:13:51.297

对于某些特殊情况，如果您在 Web.config 文件中禁用[批处理编译，如下所示：](https://msdn.microsoft.com/en-us/library/s10awwz0%28v=vs.100%29.aspx)

```
<system.web>
    ...
    <compilation debug="true" targetFramework="4.0" batch="false" />
    ...
</system.web> 
```

编译后可以将值改回True或者去掉“batch”属性，然后rebuild成功。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-08-22T08:41:37.990

经历过无数次。解决方案是关闭并打开 Visual Studio。

至少在我的情况下，它似乎有什么可做的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-27T13:47:26.467

没有一个解决方案对我有用。它抱怨的代码是这样的：

```
thisSession = ((SiteMasterPage)this.Master).foo; 
```

我将页面的通用母版页转换为特定的母版页，它允许我访问页面母版页上的 foo 对象，这是一个包含微不足道的用户数据的复杂对象。

如果你想知道我为什么要这样做，那是因为到目前为止它是最好的解决方案。要求规定我不能扩展页面类、会话变量或 cookie，并且它必须是用户特定的数据。

我没有足够的声誉来发表评论，所以我必须回复一个答案。:(

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-30T10:05:50.337

上述解决方案过去对我有用，但这次不行。

我终于找到了原因：aspx页面上控件的属性中的一个服务器端标签（如**<%# Eval("Something") %>**）。

我在问题出现前不久添加了它，删除它使问题消失了。它位于 GridView 上的 TemplateField 中。

奇怪，但这就是诀窍。

# windows - Git错误：致命：无法连接套接字（无效参数）

> ID：496277
> 
> 赞同：49
> 
> 时间：2009-01-30T16:54:32.110
> 
> 标签：windows, git, proxy, msysgit

我的 msysGit（Windows 上的 Git）在我的家用机器上工作得很好，但是在工作中，我们在 Microsoft ISA 代理后面，当我执行 git clone 时出现以下错误：

```
H:\>git clone git://github.com/akitaonrails/vimfiles.git
Initialized empty Git repository in H:/vimfiles/.git/
github.com[0: 65.74.177.129]: errno=Invalid argument
fatal: unable to connect a socket (Invalid argument) 
```

我尝试将 http_proxy 环境变量设置为：

```
http://our-proxy-server:8088 
```

我已经设置了 git http.proxy 配置指令：

```
git config --global http.proxy http://our-proxy-server:8088 
```

以上都没有区别。

`http://`使用而不是执行 git clone会`git://`产生以下结果：

```
H:\>git clone http://github.com/akitaonrails/vimfiles.git
Initialized empty Git repository in H:/vimfiles/.git/
fatal: http://github.com/akitaonrails/vimfiles.git/info/refs download error - The    requested URL returned error: 407 
```

407 当然是身份验证错误。

所以我的问题是：有没有人设法让 git 从代理后面工作，特别是 ISA 代理？我不知道这是否值得追求。非常感谢任何帮助。

谢谢！

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2009-01-30T17:57:26.147

我有完全相同的错误；但[`~/.gitconfig`全局配置文件](http://git-scm.com/docs/git-config)是关键。

如果你有一个带身份验证的代理，你需要把它放进去：

```
git config --global http.proxy http://login:password@our-proxy-server:8088 
```

它只是工作（使用' `git clone http:`'）

详细介绍相同设置的博客示例：[通过 HTTP 进行 GIT 克隆：谁知道？](http://rip747.wordpress.com/2008/09/12/git-clone-over-http-who-knew/)

* * *

如果它仍然在 407 中失败，则可能与[git-fetch 在第二个 HTTP GET 上丢失身份验证令牌](http://kerneltrap.org/mailarchive/git/2007/1/3/234850/thread)的问题有关。可能需要更新[版本的 libcurl 。](http://daniel.haxx.se/blog/2008/12/08/scp-and-sftp-with-libcurl-on-windows/)

* * *

2011 年 1 月更新：[jbustamovej](https://stackoverflow.com/users/567525/jbustamovej)在[他的回答（赞成）](https://stackoverflow.com/questions/496277/git-error-fatal-unable-to-connect-a-socket-invalid-argument/4630559#4630559)他的博客文章“[企业代理背后的 GitHub”](http://jmjpro.wordpress.com/2011/01/07/github-behind-corporate-proxy/)中提到，其中添加了以下内容：

> 需要注意的是，**如果您的登录有反斜杠**，如 中`domain\login`，**您必须转义反斜杠**，如：

```
git config --global http.proxy http://domain\\\login:password@our-proxy-server:8088 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-05-13T19:06:34.080

即使在配置代理之后，您也可能无法连接，因为代理不允许 git 协议流量。在这种情况下，您可能想尝试使用“http”而不是“git”

> H:>git 克隆 [http://github.com/akitaonrails/vimfiles.git](http://github.com/akitaonrails/vimfiles.git)

此外，如果您使用的是自动代理配置文件 (.pac)，只需在文本编辑器中打开它。这是一种很容易遵循的脚本语言，有很多条件可以重定向到最有效的代理。找到允许通用流量的那个（通常是最后配置的代理），并按照上面评论中的说明进行配置。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T16:59:25.500

你有 SOCKS 代理吗？如果你有，你可以试试**FreeCap**来整理你的 git 连接。我以这种方式使用 git 已经有一段时间了。

如果没有，仍然尝试 FreeCap。IIRC 它可能能够使用 http 代理，但我还没有尝试过。

**编辑：我通常使用 FreeCap 对cmd.exe**进行socksify ，从那时起（几乎）我从该会话开始的所有 cmdline 程序也都进行了 socksified。这就是我推荐 Free Cap 的原因，因为 SocksCap（另一种选择）不能那样工作。

至于使用 http.proxy，由于某种原因，它对我的​​ mingw 版本和我的公司 http 代理没有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T18:33:11.770

我设法通过一条非常复杂的路线让它工作。就是这样：

1.  我[在 Cygwin 下运行的家用机器（Vista 机器）上运行OpenSSH](http://www.petri.co.il/setup-ssh-server-vista.htm)
2.  我正在[通过集成的 SOCKS/HTTP CONNECT 代理使用 Bitvise Tunnelier 的动态隧道](http://www.bitvise.com/tunnelier.html#port-forwarding)。
3.  然后我使用[Freecap](http://www.freecap.ru/eng/)（感谢 Marko）来“SOCKify”GIT-GUI。不幸的是，您必须单独设置每个 .exe 并从 Freecap 中运行它们，因此您不能通用地对所有 git 命令行工具进行 SOCKify。您可以在 Freecap 中设置显式命令行命令，但您必须单独设置每个命令，这与目的不符。这就是为什么我刚刚在这个疯狂的精心设计的系统中设置了 GIT-GUI

令人惊讶的是，它似乎工作，虽然我还没有测试一切。当然，它会克隆，这是一个开始。

如果有人有更好的解决方案，我会全力以赴。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-12T14:32:44.713

Python 2.7 和[ntlmaps](http://ntlmaps.sourceforge.net/)在从 GitHub 收到 407 错误和其他垃圾后为我工作。

.gitconfig ：

```
[http]
      proxy = http://127.0.0.1:5865 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-03T20:35:33.630

这对我有用：

```
git config --global http.proxy http://login:password@PROXY_SERVER:PORT
git config --global http.sslVerify false 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2010-08-11T13:04:42.417

我在windows7上遇到了这个问题：

```
$ git clone git://github.com/facebook/php-sdk.git
Initialized empty Git repository in c:/Users/Jay/temp/php-sdk/.git/
github.com[0: 207.97.227.239]: errno=No error
fatal: unable to connect a socket (No error) 
```

终于意识到是AVG杀毒软件在运行。我在 AVG 中禁用了“驻留盾牌”，现在就像一个魅力一样工作。

```
$ git clone git://github.com/facebook/php-sdk.git
Initialized empty Git repository in c:/Users/Jay/temp2/php-sdk/.git/
remote: Counting objects: 223, done.
remote: Compressing objects: 100% (179/179), done.
emote: Total 223 (delta 84), reused 0 (delta 0)
Receiving objects: 100% (223/223), 37.32 KiB, done.
Resolving deltas: 100% (84/84), done. 
```

# sql-server - 是否有从 XML 模式生成数据库模式的工具？

> ID：496296
> 
> 赞同：0
> 
> 时间：2009-01-30T16:59:53.970
> 
> 标签：sql-server, xsd

我希望从一个严格的行业标准 xsd 文件中生成一个 MSSQL 模式。关于使用哪个工具的任何建议？我玩过 XMLspy，但我需要在数据类型映射方面更灵活一些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-01T10:35:41.233

您可能已经尝试过，但我之前使用过 MS XML Bulk Load。

几篇有用的相关文章：

[http://support.microsoft.com/kb/316005](http://support.microsoft.com/kb/316005)

[http://msdn.microsoft.com/en-us/library/aa225763(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa225763(SQL.80).aspx)

# wix - comctl32.msm（合并模块）在 Vista 上失败

> ID：496299
> 
> 赞同：2
> 
> 时间：2009-01-30T17:00:44.203
> 
> 标签：wix, windows-installer

我将 comctl32.msm 卡在安装程序（comctl32.ocx 合并模块）中。在 XP 上，comctl32.ocx 出现在 system32 中，一切正常。在 vista 上，它不起作用。任何猜测我做错了什么？

我还尝试在一个组件中用一个和很多注册表更改替换合并模块`<file>`，但文件没有移动，也没有进行注册表更改。

```
 <Directory Id="SystemFolder" Name="Sys">
    <Merge Id="VBRunMod" Language="1033" SourceFile="Merge\msvbvm60.msm" DiskId="1" />
    <Merge Id="ComCatMod" Language="1033" SourceFile="Merge\comcat.msm" DiskId="1" />
    <Merge Id="OleautMod" Language="1033" SourceFile="Merge\oleaut32.msm" DiskId="1" />
    <Merge Id="ComCtlMod" Language="1033" SourceFile="Merge\comctl32.msm" DiskId="1" />
    <Merge Id="MSCtlMod" Language="1033" SourceFile="Merge\mscomctl.msm" DiskId="1" />
  </Directory> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T18:56:56.560

我有`<Condition Level="0">VersionNT &gt;= 600</Condition>`这个功能，阻止 Vista 安装它。我在第一次学习 Wix 时添加了该代码，原因我不记得了。哇，我觉得自己很傻。

# c++ - 从 C++ 调用 Ruby 类方法

> ID：496304
> 
> 赞同：6
> 
> 时间：2009-01-30T17:01:43.110
> 
> 标签：c++, ruby

我正在尝试从 C++ 调用类方法。我已经尝试了所有我能想到的 rb_intern 组合来使它工作，但我什么也没得到。

示例类

```
类 CallTest
   定义去
    （在这里做点什么）
   结尾
结尾

```

尝试在 C++ 中调用：

```
rb_funcall(?, rb_intern("去"), 0);
```

里面有什么？空间？我知道如果我在那里使用 Qnil，它会调用全局函数，但我更喜欢类方法。

我走错方向了吗？

此外，如果可能的话，我宁愿不必提前知道类名，但如果我必须要求我知道它是什么，我可以尝试按名称将它传递给我的应用程序。

我正在使用 SWIG 生成绑定。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-30T18:28:07.710

首先`go`，正如您所定义的，它不是类方法，而是**实例方法**。

作为一种面向对象的语言，所有 ruby​​ 方法都需要一个接收器，即调用该方法的对象。对于实例方法，接收者是类的实例，对于类方法，接收者是类对象本身。

这 ？您拥有的占位符是方法调用接收者的插槽。

如果要将其保留为实例方法，则需要执行以下操作：

```
rb_funcall(a_CallTest_instance, rb_intern("go"), 0); 
```

`a_CallTest_instance`您使用创建的 CallTest 实例在哪里`rb_class_new_instance()`。

如果你把它变成一个类方法：

```
class CallTest
  def self.go
    # ...
  end
end 
```

然后你需要使用`CallTest`类本身作为接收者：

```
rb_funcall(klass, rb_intern("go"), 0); 
```

您可以`CallTest`使用`rb_const_get()`

```
VALUE klass = rb_const_get(rb_cObject, rb_intern('CallTest')); 
```

在那里使用`rb_cObject`，因为`CallTest`是在全局上下文中定义的。

我建议阅读 Pickaxe 中关于扩展 ruby​​ 的章节。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-08-29T07:54:06.070

我也使用 SWIG。这些特定的示例文件应该对您有所帮助。

1) 测试.rb

```
require 'test.so'
class A
    def func1(buffer)
        puts "ruby instance method: #{buffer}"
    end
end
def func2(buffer)
    puts "ruby global method: #{buffer}"
end
module Z
    def Z.func3(buffer)
        puts "ruby module method: #{buffer}"
    end
end

a = A.new
t = Test::Test1.new()
t.call(a, "func1", "Hello", 5)
t.call(method(:func2), "func2", "Yabaaa", 6)
t.call(Z, "func3", "Yahooooooo", 10) 
```

2）测试.h：

```
#include <ruby.h>
class Test1
{
public:
    void call(VALUE obj, char* func_name, const char* buffer, int size)
    {
        VALUE val = rb_str_new(buffer, size);   
        rb_funcall(obj, rb_intern(func_name), 1, val);
    }
}; 
```

3）测试.i：

```
%module test

%{
#include "test.h"
%}

%exception
{
    try
    {
        $action
    }
    catch (std::exception& ex)
    {
        static VALUE cpperror = rb_define_class("test Exception", rb_eStandardError);
        rb_raise(cpperror, ex.what());
    }
    catch (...)
    {
        static VALUE cpperror = rb_define_class("test UnknownException", rb_eStandardError);
        rb_raise(cpperror, "Unknown catched");
    }
}

%include "test.h" 
```

输出：

```
ruby ./test.rb 
ruby instance method: Hello
ruby global method: Yabaaa
ruby module method: Yahooooooo 
```

# c++ - 小部件摇摆 = *new Widget()

> ID：496305
> 
> 赞同：3
> 
> 时间：2009-01-30T17:02:13.827
> 
> 标签：c++

我刚刚遇到了一个 C++ SDK，它大量使用了这种非常奇怪的`*new`模式。我完全不明白他们为什么要那样做。

用 *new 构造对象有什么意义，例如 `Widget wag = *new Widget();`？

更新：有趣的是，他们实际上在做`XPtr<T> p = *new T;`- 一定是一些智能指针魔术的语义。仍然没有多大意义。我确实相信 SDK 是高质量的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T17:10:30.907

也许他们正在尝试内存泄漏？使用 new 的默认实现，它将在堆上分配一个 Widget，然后从中复制构造 wag，然后它会立即泄漏新对象。

底线：不要模仿。我会怀疑该 SDK。

**编辑：**如果这是在智能指针的上下文中完成的，那么他们肯定有可能保存指针以供以后删除。如果有一个 XPtr 模板正在执行此操作，您应该能够查看代码并查看它是否正在执行此操作。SDK 还应该在某处为您提供有关该构造的某种文档，因为它不正常，而且我并没有真正看到它有多大优势。尽管如此，我仍然坚持我所说的：即使它不能保证泄漏，我仍然不会模仿它。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T17:11:52.073

它构造一个新对象，然后*复制*它。指向原始对象的指针被丢弃，因此可能存在内存泄漏。

*但是，不一定*存在内存泄漏。它可能会`Widget`维护其所有实例的列表，并在其构造函数和析构函数中更新该列表。可能有其他方法可以获取列表的内容。

但这似乎毫无意义。原因可能是对代码的实际工作方式有误解。找出代码为何如此编写的最佳选择是询问编写代码的人。代码注释中可能有线索。您能否透露有关您正在查看的代码的更多细节？

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T17:06:50.307

这基本上是这样做的：

```
Widget wag = *(new Widget());

// or
Widget wag; 
```

我不知道这是否会正确释放它。我猜它不会。

要回答你的问题，我觉得它的设计选择很糟糕。可能他们想开始使用指针，但后来变得丑陋了。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T18:22:09.827

引用计数对象的常见智能指针模式是以​​下代码将存储对象并 IncRef 它：

```
SmartPtr<Type> ptr = new Type(); 
```

以下代码将存储对象而*不是*IncRef 它：

```
SmartPtr<Type> ptr = *new Type(); 
```

如果对象的构造函数应用第一个 IncRef，则第二种形式很有用。否则，您的对象的引用计数将为 2，并且当智能指针超出范围时，它仍然不会释放该对象。

不知道您正在使用的库中是否是这种情况。不过，快速阅读 XPtr 代码可能会告诉您。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T18:17:40.040

它不一定会泄漏。例如考虑以下

```
int &a = *new int();
delete &a; 
```

它分配给一个参考。它将保留所创建对象的身份（而不是创建副本），因此它不会丢失对它的跟踪，并且之后会很好地删除它。将其放入代码的形式中，该类可以定义为

```
template<typename T>
struct XPtr {
    T *ptr;
    XPtr(T &t):ptr(&t) { }
    ~XPtr() { delete ptr; }
};

...
XPtr<T> p = *new T; 
```

或者更复杂的是，使用引用计数 - 这样 p 可以被复制，并且 XPtr 跟踪它的所有副本，等等。

# sql-server-2005 - 如何设置 MSSQL2005 以同时响应“localhost”和另一个名称？

> ID：496307
> 
> 赞同：0
> 
> 时间：2009-01-30T17:02:25.073
> 
> 标签：sql-server-2005

我正在开发一个代码库，该代码库具有许多通过指定名称访问数据库服务器的连接字符串。

```
<add name="myConnection" 
     connectionString="Data Source=DevServer;Initial Catalog='devData';Persist Security Info=True;User ID=devUser;Password=devPass;" 
     providerName="System.Data.SqlClient" /> 
```

我所在的位置无法访问命名的“DevServer”数据源。
我有一个本地托管在“localhost”中的数据库版本。
我想做的是通过名为“DevServer”的数据源访问我的“localhost”数据库。

我不想失去通过“localhost”访问服务器的能力，因为我有其他项目使用它作为数据源。我*可以*更改配置文件，但我必须确保我不签入它们，因为这会破坏其他人的配置。我仍然希望收到配置文件的任何更新，因此不能选择本地可写版本。

我曾尝试使用 SQL Server 配置管理器创建别名，但我认为我做错了，因为我仍然无法使用“DevServer”进行连接。

SQL Server 配置管理器应该能够实现我想要的吗？
谁能建议我可以实现这一目标的方法？

我想我的问题与[此](https://stackoverflow.com/questions/449607/point-to-localhost-sqlexpress-using-only-localhost)类似，但没有公认的答案，它是针对 SQL Express 的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T17:05:05.160

您可以更新您的[主机文件](http://en.wikipedia.org/wiki/Hosts_file)以将您的机器名别名为 DevServer：

```
127.0.0.1       localhost

# Comment this line out when back on the normal network:
127.0.0.1       DevServer 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T17:33:04.997

SQL Server 配置管理器允许您在本机客户端配置下使用一个别名。我认为这对我来说更容易，但主机文件解决方案应该也能正常工作。

如果您使用 SSCM，请确保在访问主网络（或对其进行编辑）时将其退出，否则您将无法访问正确的服务器。

# calendar - 重复规则定义 (RFC2445) 问题

> ID：496308
> 
> 赞同：6
> 
> 时间：2009-01-30T17:02:27.833
> 
> 标签：calendar, rule, recurrence, rfc2445

我正在使用 Google 的 RFC2445 实现 ( [http://code.google.com/p/google-rfc-2445/](http://code.google.com/p/google-rfc-2445/) ) 作为重复规则。如果我从 1 月 30 日开始定义 MONTHLY 重复，则将完全跳过少于 30 天的月份（即 2 月）。所以谷歌 API 会在 1 月 30 日、3 月 30 日、4 月 30 日等返回。不好。我希望它会返回：1 月 30 日、2 月 28 日、3 月 30 日、4 月 30 日。

同样，如果我选择 1 月 31 日作为开始日期，那么任何少于 31 天的月份都将被跳过。

根据 RFC2445 规范，这可能是正确的，也可能是错误。你怎么看？

我的主要问题是，有没有办法定义一条规则，上面写着“每月 30 日重复；如果 30 日不存在，则为每月的最后一天”。我不相信有。有什么建议么？

提前致谢。

问候， 科马克

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-01T17:06:28.277

答案是：FREQ=MONTHLY;BYMONTHDAY=28,29,30;BYSETPOS=-1，这意味着“每月 30 日重复；如果不存在 30 日，则为每月的最后一天”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T17:18:10.207

好吧，看看[RFC 2445](http://www.ietf.org/rfc/rfc2445.txt)本身，您看到的行为肯定是正确的：

> 如果发现超出可用范围的 BYxxx 规则部分值（即，二月份的 BYMONTHDAY=30），它们将被简单地忽略。

我能想到的唯一解决方案是使用多个重复规则，即每个月的 30 日一个，二月的最后一天另一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T17:22:57.043

看起来您对 RFC 跳过这些日期是正确的。如果您`DTSTART`是 1 月 31 日，并且您没有`BYMONTHDAY`在重复规则中指定 a（或者如果`BYMONTHDAY`是 31 日），那么它会在没有这样一天的月份内忽略该规则：

> 如果发现超出可用范围的 BYxxx 规则部分值（即，二月份的 BYMONTHDAY=30），它们将被简单地忽略。

**但是**，您应该能够指定 -1`BYMONTHDAY`并让它使用该月的最后一天，无论它可能发生什么。

> BYMONTHDAY 规则部分指定以逗号字符（ASCII 十进制 44）分隔的月份日期列表。有效值为 1 到 31 或 -31 到 -1。例如，-10 表示该月的第十天到最后一天。

# silverlight - Visual Basic 2005 中的 Silverlight 开发

> ID：496311
> 
> 赞同：1
> 
> 时间：2009-01-30T17:03:03.560
> 
> 标签：silverlight

是否可以在 Visual Basic 2005 中开发 Silverlight？在 Microsoft 网站上，我只找到了 2008 年的 SDK。

谢谢亚历山大·纳吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T17:14:14.097

以下是开发 Silverlight 2 应用程序所需的工具列表 [来源：[http://silverlight.net/getstarted/]](http://silverlight.net/getstarted/])。虽然过去您可以使用 VS2005 进行开发，但最新的工具仅适用于 VS2008：

*   [Visual Studio 2008 SP1](http://msdn.microsoft.com/en-us/vs2008/products/cc268305.aspx)或[带有 SP1 的 Visual Web Developer Express](http://www.microsoft.com/express/vwd/)
*   [适用于 Visual Studio 2008 SP1 的Silverlight 工具](http://go.microsoft.com/fwlink/?LinkId=129043)或带有 SP1 的 Visual Web Developer Express。这将安装必要的 Visual Studio 更新、Silverlight 项目模板、开发人员运行时和 SDK。有关更多信息，请阅读概述和 Silverlight 2 自述文件说明。

如果您刚开始使用 Silverlight，那么我强烈建议您同时安装[Expression Blend 2](http://www.microsoft.com/downloads/details.aspx?FamilyId=5FF08106-B9F4-43CD-ABAD-4CC9D9C208D7&displaylang=en)和[SP1](http://www.microsoft.com/downloads/details.aspx?FamilyId=EB9B5C48-BA2B-4C39-A1C3-135C60BBBE66&displaylang=en)

就 VB 而言，您绝对可以使用它开发 Silverlight 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T17:38:17.823

VS2005 的模板仅适用于 Silverlight 1.0 (Javascript) 应用程序。*要使用 Visual Studio*开发 Silverlight 2 应用程序，您需要 VS 2008（或 Visual Web Developer Express 2008 的免费速成版之一）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T17:05:45.660

是的，有可能，我以前使用过，寻找它们应该在某个地方的 SDK 和项目模板

这是[项目模板的链接](http://ox.no/posts/silverlight-project-template-for-visual-studio-2005)

# c# - MSDN C# ProcessController 示例

> ID：496320
> 
> 赞同：0
> 
> 时间：2009-01-30T17:05:50.853
> 
> 标签：c#, msdn, sample

我发现这篇 MSDN 文章解释了如何使用 C# 监视进程和服务：

[ProcessController 示例：演示流程和服务监控](http://msdn.microsoft.com/en-us/library/aa645519(VS.71).aspx)

但是，我无法在任何地方下载或找到此示例！这真的很有帮助。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T17:10:10.097

您正在寻找的信息在这里：

[http://msdn.microsoft.com/en-us/library/z9hsy596(VS.80).aspx](http://msdn.microsoft.com/en-us/library/z9hsy596(VS.80).aspx)

您需要安装 QuickStart 示例随附的 Microsoft .NET Framework SDK v2.0。

回应您的评论：

我从[这个页面](http://www.microsoft.com/downloads/details.aspx?FamilyID=FE6F2099-B7B4-4F47-A244-C96D69C35DEC&displaylang=en)下载。然后我运行`setup.exe`并在标题为**Installation Options**的页面上检查了**QuickStart Samples**框并完成了安装。然后我按照[此处](http://msdn.microsoft.com/en-us/library/z9hsy596(VS.80).aspx)的说明访问我系统上的快速入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-03T10:28:13.853

好的，我终于找到了！

此 ProcessController 示例是 Microsoft Visual Studio .NET 7.0 版的一部分。

我可以从[VisualStudio .NET Help Documentation Samples](http://www.microsoft.com/downloads/details.aspx?FamilyID=41c68033-775c-4d92-a9c4-2db8e8238f37&DisplayLang=en)下载它。

# unicode - UTF-8、UTF-16 和 UTF-32

> ID：496321
> 
> 赞同：584
> 
> 时间：2009-01-30T17:05:59.810
> 
> 标签：unicode, utf-8, utf-16, utf, utf-32

UTF-8、UTF-16 和 UTF-32 之间有什么区别？

我知道它们都将存储 Unicode，并且每个都使用不同数量的字节来表示一个字符。选择一个比另一个有优势吗？

* * *

## 回答 #1

> 赞同：454
> 
> 时间：2009-01-30T17:15:19.197

UTF-8 在 ASCII 字符代表文本块中的大多数字符的情况下具有优势，因为 UTF-8 将这些字符编码为 8 位（如 ASCII）。另一个优点是仅包含 ASCII 字符的 UTF-8 文件与 ASCII 文件具有相同的编码。

UTF-16 在 ASCII 不占优势的情况下更好，因为它主要使用每个字符 2 个字节。UTF-8 将开始为高阶字符使用 3 个或更多字节，而 UTF-16 对大多数字符仅保留 2 个字节。

UTF-32 将覆盖 4 个字节中所有可能的字符。这使它非常臃肿。我想不出使用它有什么好处。

* * *

## 回答 #2

> 赞同：382
> 
> 时间：2009-01-30T17:10:09.520

简而言之：

*   UTF-8：可变宽度编码，向后兼容 ASCII。ASCII 字符（U+0000 到 U+007F）占用 1 个字节，代码点 U+0080 到 U+07FF 占用 2 个字节，代码点 U+0800 到 U+FFFF 占用 3 个字节，代码点 U+10000 到 U+10FFFF占用 4 个字节。适合英文文本，不适合亚洲文本。
*   UTF-16：可变宽度编码。代码点 U+0000 到 U+FFFF 占用 2 个字节，代码点 U+10000 到 U+10FFFF 占用 4 个字节。不适合英文文本，适合亚洲文本。
*   UTF-32：固定宽度编码。所有代码点占用四个字节。一个巨大的内存猪，但操作起来很快。几乎没有使用过。

长篇大论：参见维基百科：[UTF-8](http://en.wikipedia.org/wiki/UTF-8)、[UTF-16](http://en.wikipedia.org/wiki/UTF-16)和[UTF-32](http://en.wikipedia.org/wiki/UTF-32)。

* * *

## 回答 #3

> 赞同：141
> 
> 时间：2009-01-30T17:10:29.830

*   UTF-8 是可变的**1 到 4**个字节。

*   UTF-16 是可变的**2 或 4**个字节。

*   UTF-32 固定为**4**个字节。

注意：UTF-8 可以采用 1 到 6 个字节的最新约定：[https ://lists.gnu.org/archive/html/help-flex/2005-01/msg00030.html](https://lists.gnu.org/archive/html/help-flex/2005-01/msg00030.html)

* * *

## 回答 #4

> 赞同：97
> 
> 时间：2009-01-30T17:18:33.200

Unicode 定义了一个巨大的字符集，为每个图形符号分配一个唯一的整数值（这是一个主要的简化，实际上并不正确，但对于这个问题来说已经足够接近了）。UTF-8/16/32 只是不同的编码方式。

简而言之，UTF-32 对每个字符使用 32 位值。这允许他们为每个字符使用固定宽度的代码。

UTF-16 默认使用 16 位，但这只能为您提供 65k 个可能的字符，这对于完整的 Unicode 集来说还远远不够。所以有些字符使用成对的 16 位值。

而 UTF-8 默认使用 8 位值，这意味着前 127 个值是固定宽度的单字节字符（最高位用于表示这是一个多字节序列的开始，剩下 7实际字符值的位）。所有其他字符都被编码为最多 4 个字节的序列（如果有记忆的话）。

这使我们获得了优势。任何 ASCII 字符都直接与 UTF-8 兼容，因此对于升级旧版应用程序，UTF-8 是一个常见且显而易见的选择。在几乎所有情况下，它也会使用最少的内存。另一方面，您不能对字符的宽度做出任何保证。它可能是 1、2、3 或 4 个字符宽，这使得字符串操作变得困难。

UTF-32 则相反，它使用最多的内存（每个字符固定为 4 个字节宽），但另一方面，您*知道*每个字符都有这个精确的长度，因此字符串操作变得简单得多。您可以简单地根据字符串的字节长度计算字符串中的字符数。你不能用 UTF-8 做到这一点。

UTF-16 是一种妥协。它让*大多数*字符适合固定宽度的 16 位值。所以只要你没有中文符号、音符或其他，你可以假设每个字符都是16位宽。它使用的内存比 UTF-32 少。但它在某些方面是“两全其美”。它几乎总是比 UTF-8 使用更多的内存，并且仍然无法避免困扰 UTF-8（可变长度字符）的问题。

最后，使用平台支持的内容通常会有所帮助。Windows 内部使用 UTF-16，因此在 Windows 上，这是显而易见的选择。

Linux 略有不同，但它们通常对所有符合 Unicode 的内容使用 UTF-8。

如此简短的回答：所有三种编码都可以编码相同的字符集，但它们将每个字符表示为不同的字节序列。

* * *

## 回答 #5

> 赞同：52
> 
> 时间：2013-05-15T13:02:36.337

*Unicode*是一种标准，关于*UTF-x*，您可以将其视为出于某些实际目的的技术实现：

*   **UTF-8** - “**大小优化**”：最适合基于拉丁字符的数据（或 ASCII），每个字符只需要 1 个字节，但大小会相应增加符号种类（在最坏的情况下，每个字符可能增长到 6 个字节）
*   **UTF-16** - “**平衡**”：每个字符至少需要 2 个字节，这对于现有的一组具有固定大小的主流语言来说足够了，以简化字符处理（但大小仍然是可变的，每个字符最多可以增长到 4 个字节)
*   **UTF-32** - “**性能**”：允许使用简单算法作为固定大小字符（4 字节）的结果，但内存不足

* * *

## 回答 #6

> 赞同：41
> 
> 时间：2016-02-03T16:16:07.583

我试图在我的博文中给出一个简单的[解释](https://dev.to/marounmaroun/unicode-and-character-sets-2p86)。

# UTF-32

需要 32 位（4 个字节）来编码*任何*字符。例如，为了使用此方案表示“A”字符代码点，您需要将 65 写入 32 位二进制数：

```
00000000 00000000 00000000 01000001 (Big Endian) 
```

如果您仔细观察，您会注意到最右边的七位在使用 ASCII 方案时实际上是相同的位。但是由于 UTF-32 是*固定宽度方案*，我们必须附加三个额外的字节。这意味着如果我们有两个只包含“A”字符的文件，一个是 ASCII 编码的，另一个是 UTF-32 编码的，它们的大小将分别为 1 字节和 4 字节。

# UTF-16

很多人认为 UTF-32 使用固定宽度 32 位来表示代码点，因此 UTF-16 是固定宽度 16 位。错误的！

在 UTF-16 中，代码点可能以 16 位或 32 位表示。所以这个方案是变长编码系统。与 UTF-32 相比有什么优势？至少对于 ASCII，文件大小不会是原来的 4 倍（但仍然是两倍），所以我们仍然不能向后兼容 ASCII。

由于 7 位足以表示“A”字符，我们现在可以使用 2 个字节而不是 UTF-32 中的 4 个字节。它看起来像：

```
00000000 01000001 
```

# UTF-8

你猜对了。在 UTF-8 中，代码点可能使用 32、16、24 或 8 位来表示，并且作为 UTF-16 系统，这也是可变长度编码系统。

最后，我们可以像使用 ASCII 编码系统一样表示“A”：

```
01001101 
```

### UTF-16 实际上比 UTF-8 更好的一个小例子：

考虑中文字母“语” - 它的 UTF-8 编码是：

```
11101000 10101010 10011110 
```

虽然它的 UTF-16 编码更短：

```
10001010 10011110 
```

要了解表示形式及其解释方式，请访问原始帖子。

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2015-03-05T20:05:10.273

### UTF-8

*   没有字节顺序的概念
*   每个字符使用 1 到 4 个字节
*   ASCII 是兼容的编码子集
*   完全自同步，例如从流中任何地方丢弃的字节最多会损坏一个字符
*   几乎所有欧洲语言都以每个字符两个字节或更少的字节编码

### UTF-16

*   必须使用已知的字节顺序或读取字节顺序标记 (BOM) 进行解析
*   每个字符使用 2 或 4 个字节

### UTF-32

*   每个字符是 4 个字节
*   必须使用已知的字节顺序或读取字节顺序标记 (BOM) 进行解析

除非大多数字符来自 CJK（中文、日文和韩文）字符空间，否则 UTF-8 将是最节省空间的。

UTF-32 最适合通过字符偏移到字节数组中进行随机访问。

* * *

## 回答 #8

> 赞同：15
> 
> 时间：2009-01-30T17:24:45.153

在 UTF-32 中，所有字符都用 32 位编码。优点是可以轻松计算字符串的长度。缺点是对于每个 ASCII 字符，您会浪费额外的三个字节。

在 UTF-8 中字符长度可变，ASCII 字符编码为一个字节（八位），大多数西方特殊字符编码为两个字节或三个字节（例如 € 是三个字节），并且可以占用更多外来字符到四个字节。明显的缺点是，您无法先验地计算字符串的长度。但与 UTF-32 相比，对拉丁（英语）字母文本进行编码所需的字节数要少得多。

UTF-16 也是可变长度的。字符以两个字节或四个字节编码。我真的不明白这一点。它具有可变长度的缺点，但没有像 UTF-8 那样节省空间的优点。

在这三个中，显然 UTF-8 是传播最广泛的。

* * *

## 回答 #9

> 赞同：14
> 
> 时间：2013-01-08T11:25:52.760

我做了一些测试来比较 MySQL 中 UTF-8 和 UTF-16 之间的数据库性能。

## 更新速度

### UTF-8

![在此处输入图像描述](https://i.stack.imgur.com/AK6CK.png)

### UTF-16

![在此处输入图像描述](https://i.stack.imgur.com/FwSHZ.png)

## 插入速度

![在此处输入图像描述](https://i.stack.imgur.com/3HYaA.png)

![在此处输入图像描述](https://i.stack.imgur.com/3cUGV.png)

## 删除速度

![在此处输入图像描述](https://i.stack.imgur.com/3QcMo.png)

![在此处输入图像描述](https://i.stack.imgur.com/corSh.png)

* * *

## 回答 #10

> 赞同：7
> 
> 时间：2021-01-07T03:31:17.403

我很惊讶这个问题已经 11 岁了，而且没有一个答案提到 utf-8 的 #1 优势。

utf-8 通常适用于不支持 utf-8 的程序。这部分是它的设计目的。其他答案提到前 128 个代码点与 ASCII 相同。所有其他代码点均由设置高位的 8 位值（值从 128 到 255）生成，因此从非 unicode 感知程序的 POV 中，它只会将字符串视为带有一些额外字符的 ASCII。

举个例子，假设您编写了一个程序来添加有效地执行此操作的行号（为了简单起见，我们假设行尾只是 ASCII 13）

```
// pseudo code

function readLine
  if end of file
     return null
  read bytes (8bit values) into string until you hit 13 or end or file
  return string

function main
  lineNo = 1
  do {
    s = readLine
    if (s == null) break;
    print lineNo++, s
  } 
```

将 utf-8 文件传递​​给该程序将继续工作。同样，拆分制表符、逗号、解析 ASCII 引号或其他只有 ASCII 值有意义的解析都只适用于 utf-8，因为 utf-8 中不会出现 ASCII 值，除非它们实际上是那些 ASCII 值

其他一些答案或评论提到 utf-32 的优点是您可以分别处理每个代码点。例如，这建议您可以采用“ABCDEFGHI”之类的字符串，并在每个第三个代码点将其拆分为

```
ABC
DEF
GHI 
```

这是错误的。[许多代码点会影响其他代码点](https://en.wikipedia.org/wiki/Unicode_control_characters)。例如，让您在 ‍‍‍‍‍ 之间进行选择的颜色选择器代码点。如果您在任意代码点拆分，您将破坏这些代码点。

另一个例子是双向代码点。以下段落**没有**倒着输入。它前面只是 0x202E 代码点

> *   此行未向后键入，仅向后显示

所以不，utf-32 不会让你随意操作 unicode 字符串而不考虑它们的含义。它将让您无需额外代码即可查看每个代码点。

仅供参考，utf-8 的设计是为了查看任何单个字节，您可以找到当前代码点或下一个代码点的开始。

如果您在 utf-8 数据中取任意字节。如果它 < 128 它本身就是正确的代码点。如果它 >= 128 并且 < 192（前 2 位是 10），那么要找到代码点的开始，您需要查看前面的字节，直到找到值 >= 192 的字节（前 2 位是 11 ）。在该字节处，您已找到代码点的开头。该字节编码了多少后续字节构成代码点。

如果您想找到下一个代码点，只需扫描到字节 < 128 或 >= 192，这就是下一个代码点的开始。

| 字节数 | 第一个代码点 | 最后一个代码点 | 字节 1 | 字节 2 | 字节 3 | 字节 4 |
| --- | --- | --- | --- | --- | --- | --- |
| 1 | `U+0000` | `U+007F` | `0xxxxxxx` |  |  |  |
| 2 | `U+0080` | `U+07FF` | `110xxxxx` | `10xxxxxx` |  |  |
| 3 | `U+0800` | `U+FFFF` | `1110xxxx` | `10xxxxxx` | `10xxxxxx` |  |
| 4 | `U+10000` | `U+10FFFF` | `11110xxx` | `10xxxxxx` | `10xxxxxx` | `10xxxxxx` |

`xxxxxx`代码点的位在哪里。连接字节中的 xxxx 位以获取代码点

* * *

## 回答 #11

> 赞同：6
> 
> 时间：2009-01-30T17:22:19.387

根据您的开发环境，您甚至可能无法选择您的字符串数据类型将在内部使用什么编码。

但是对于存储和交换数据，如果您可以选择，我将始终使用 UTF-8。如果您主要有 ASCII 数据，这将为您提供最少量的数据传输，同时仍然能够对所有内容进行编码。优化最少的 I/O 是现代机器上的方法。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-30T17:17:07.883

如前所述，区别主要在于基础变量的大小，在每种情况下都会变大以允许表示更多字符。

然而，字体、编码和东西都非常复杂（不必要？），所以需要一个大链接来填写更多细节：

[http://www.cs.tut.fi/~jkorpela/chars.html#ascii](http://www.cs.tut.fi/~jkorpela/chars.html#ascii)

不要期望全部理解，但是如果您不想以后遇到问题，那么值得尽可能早地学习（或者只是让其他人为您解决问题）。

保罗。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2022-02-06T04:21:53.267

通读答案后，UTF-32 需要一些爱。

C＃：

```
Data1 = RandomNumberGenerator.GetBytes(500_000_000);

sw = Stopwatch.StartNew();
int l = Encoding.UTF8.GetString(Data1).Length;
sw.Stop();
Console.WriteLine($"UTF-8: Elapsed - {sw.ElapsedMilliseconds * .001:0.000s}   Size - {l:###,###,###}");

sw = Stopwatch.StartNew();
l = Encoding.Unicode.GetString(Data1).Length;
sw.Stop();
Console.WriteLine($"Unicode: Elapsed - {sw.ElapsedMilliseconds * .001:0.000s}   Size - {l:###,###,###}");

sw = Stopwatch.StartNew();
l = Encoding.UTF32.GetString(Data1).Length;
sw.Stop();
Console.WriteLine($"UTF-32: Elapsed - {sw.ElapsedMilliseconds * .001:0.000s}   Size - {l:###,###,###}");

sw = Stopwatch.StartNew();
l = Encoding.ASCII.GetString(Data1).Length;
sw.Stop();
Console.WriteLine($"ASCII: Elapsed - {sw.ElapsedMilliseconds * .001:0.000s}   Size - {l:###,###,###}"); 
```

UTF-8 -- 经过 9.939 秒 - 大小 473,752,800

Unicode -- 经过 0.853 秒 - 大小 250,000,000

UTF-32 - 经过 3.143 秒 - 大小 125,030,570

ASCII -- 经过 2.362 秒 - 大小 500,000,000

UTF-32 -- 麦克风丢弃

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2015-05-21T15:12:32.467

简而言之，使用 UTF-16 或 UTF-32 的唯一原因是分别支持非英语和古文字。

我想知道为什么有人会选择使用非 UTF-8 编码，因为它显然对 Web/编程目的更有效。

一个常见的误解 - 后缀数字并不表示其能力。它们都支持完整的 Unicode，只是 UTF-8 可以处理单个字节的 ASCII，因此对 CPU 和互联网来说更高效/不易损坏。

一些不错的阅读：[http](http://www.personal.psu.edu/ejp10/blogs/gotunicode/2007/10/which_utf_do_i_use.html) ://www.personal.psu.edu/ejp10/blogs/gotunicode/2007/10/which_utf_do_i_use.html 和[http://utf8everywhere.org](http://utf8everywhere.org)

# c - 帮助自定义 getline() 函数

> ID：496330
> 
> 赞同：2
> 
> 时间：2009-01-30T17:07:45.750
> 
> 标签：c, kr-c

谁能向我解释为什么这不起作用？

```
#include <stdio.h>
#include <stdlib.h>

char *getline(int lim)
{
    char c;
    int i;
    char *line;
    line = malloc(sizeof(char) * lim);

    i = 0;
    while((c = getchar()) != '\n' && c != EOF && i < lim-1)
    {
        *line = c;
        line++;
        i++;
    }
    *line = '\0';
    printf("%s", line);
    return line;
} 
```

我现在不担心返回值 - 只是为什么`printf("%s", line)`不工作的原因。

谢谢！

**编辑：**固定，`line = malloc(sizeof(char) * lim);`但它仍然无法正常工作。

**解决方案：**的地址`*line`在整个函数中递增。当它被传递给 时`printf()`，`*line`指向 '\0' 因为那是它的地址被递增到的地方。使用一个临时指针来存储由`malloc()`to分配的原始地址`*line`，然后将该指针传递给`printf()`，允许函数向上遍历指针。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T17:11:45.973

因为您只为这一行中的单个字符分配了足够的空间：

```
line = malloc(sizeof(char)); 
```

那就是你的陈述`\0`之前的内容。`printf`

我猜您想将此行更改为：

```
/* Allocate enough room for 'lim' - 1 characters and a trailing \0 */
line = malloc(sizeof(char) * lim); 
```

甚至更好：

```
char *line, *tmp;
tmp = line = malloc(sizeof(char) * lim); 
```

然后`tmp`在所有指针数学中使用，这种方式`line`仍将指向字符串的开头。

而且我知道这是您开发的早期阶段，但您需要确保您`free()`的记忆力`malloc()`。

* * *

这是您的功能的工作版本，包括我建议的更改：

```
#include <stdio.h>
#include <stdlib.h>

char *getline(int lim)
{
    char c;
    int i;
    char *line, *tmp;
    tmp = line = malloc(sizeof(char) * lim);

    i = 0;
    /* NOTE: 'i' is completely redundant as you can use 'tmp',
     * 'line,' and 'lim' to determine if you are going to
     * overflow your buffer */
    while((c = getchar()) != '\n' && c != EOF && i < lim-1)
    {
        *tmp = c;
        tmp++;
        i++;
    }
    *tmp = '\0';
    printf("%s", line);
    return line;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T17:10:42.153

看起来您正在打印一个长度为零的字符串。

```
*line = '\0';
printf("%s", line); 
```

我假设您想存储`line`最初的内容（从 返回的内容`malloc`）并打印出来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T17:12:07.847

您似乎只为一个角色分配了足够的空间。您的意思是不是以下内容：

```
line = malloc(lim * sizeof(char)); 
```

此外，您不想`line`在阅读每个字符后进行更改。将以下块用于您的 while 循环：

```
*(line + i) = c;
i++; 
```

最后，要对字符串进行空终止，请使用：

```
*(line + i) = '\0'; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T17:20:20.920

更新-这是一个简单的拼写错误，但你不必投票反对我

代替

```
 char *line= malloc(sizeof(char)); 
```

尝试

```
 int space= //number of how many characters you need on the line
    char *line= malloc(sizeof(char)*space); 
```

抱歉，我的意思是

```
 char *line= malloc( sizeof(char)*lim) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T17:25:31.250

每个人都已经涵盖了这些要点，但这里将所有内容放在一起：

**编辑：**稍微改进了代码

```
#include <stdio.h>
#include <stdlib.h>

char *getline(int lim)
{
    char *result = malloc(sizeof(char) * lim); // allocate result buffer

    int i = 0;
    char c;
    char *line = result;
    while((c = getchar()) != '\n' && c != EOF && i < lim-1)
    {
        *line = c;
        line++;
        i++;
    }
    *line = '\0';

    printf("%s", result); // print the result
    return result; // return the result buffer (remember to free() it later)
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T17:12:57.283

你也在覆盖你不拥有的内存。您正在 malloc'ing 一个字符，将 *line 设置为 c，然后增加 line 并重复。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T17:21:55.550

您需要了解指针的概念，以及它与缓冲区的不同之处。在您的代码中，您将“行”同时视为指针和缓冲区。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T17:30:46.577

你在两点上犯了错误（但你可以说同样的错误或两个，这取决于你）。首先你的指针应该像

*(行+i) = c; 由于这个原因，当您在循环结束时设置 Null 字符时，您实际上是在说编译器仅将指针指向该位置。因此，指针仅指向 Null 字符串而不是整个字符串。因为它在循环的每个步骤中不断移动。因此，当您尝试打印时，指针没有可打印的内容。因此，如果您更改指针循环内的语句并将值分配给一个明确的地址，而不是实际移动指针，那么您的问题将得到解决。

笔记。如果更改该行，则还需要像这样修改 Null 终止符分配；*(行+限制) = '\0';

# css - 链接图像边框样式

> ID：496338
> 
> 赞同：1
> 
> 时间：2009-01-30T17:10:15.633
> 
> 标签：css, image, border, visited

我希望能够链接我的图像。点击它。返回页面并查看它是否已被访问。我希望我访问的图像在返回时具有不同的颜色边框。

我的代码：

```
a:link img{border-color:#FFF; border-style:solid; border-width:1px;}
a:hover img{border-color:#03F; border-style:solid; border-width:1px;}
a:visited img, a:active img{border-color:#036; border-style:solid; border-width:1px;} 
```

任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T17:22:35.813

链接 CSS 可能很难正确处理，因为许多浏览器可能对此很奇怪。声明链接 CSS 的最佳顺序是

*   关联
*   参观过
*   徘徊
*   积极的

（也被称为助记符 LoVe/HAte）。

另外，尝试声明你的css：

```
a:hover img {border: 1px solid #036;} 
```

而不是在三个不同的声明中指定它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T17:21:44.737

告诉我们哪个浏览器不工作可能会有所帮助，因为它们都以不同的方式处理嵌入文本的锚链接。

# apache - 如何为我的网站制作友好的网址？

> ID：496354
> 
> 赞同：3
> 
> 时间：2009-01-30T17:13:31.087
> 
> 标签：apache, mod-rewrite

到目前为止，我将所有内容都包含在 index.php 中：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ index.php?page=$1 [QSA,L] 
```

还有一些页面我像这样使用 $_GET ：

```
SELECT * FROM news WHERE id = ".intval($_GET['id']) 
```

如果我想查看我键入`news?id=1` 而不是`?page=news&id=1`但我希望能够使用的新闻`news/1`。

我是否必须为使用 GET 的每个页面添加重写规则？或者，还有更好的方法？

我希望我不必为我的所有页面都这样做。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T17:16:53.313

```
RewriteRule ^([^/]*)/?([^/]*)$ index.php?page=$1&id=$2 [QSA,L] 
```

应该允许您的页面输入为`www.example.com/page/id`

您的大多数页面将在内部看起来像`www.example.com/index.php?page=text&id=`，但这不应该影响任何事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T17:25:00.817

这个单一的规则应该允许有和没有 id （并且还使斜线可选）：

```
RewriteRule ^([^/]*)(/([^/]*)/?)?$ index.php?page=$1&id=$3 [QSA,L] 
```

如果您不想允许 / 和 //，请将 's 更改`*`为`+`'s

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T17:22:33.630

只需使用 news/1，它已经适用于您当前的重写规则并将该值放入 page 参数中。然后在 index.php 中创建一个通用 URL 调度程序，将页面参数的值解析为组件片段，并根据这些片段决定做什么。

例如，一个非常简单的通用调度程序只会在“/”上拆分页面参数，然后根据从拆分返回的第一项的值（例如“新闻”）调用处理程序，传递其余部分（例如“1”）作为处理程序的参数。

编辑：语法，以及[指向 PHP 中 URL 调度教程的链接](http://www.phpaddiction.com/tags/category/url-routing/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T17:34:06.117

试试这个规则：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^/]+)$ index.php?page=$1 [QSA,L]
RewriteRule ^([^/]+)/(\d+)$ index.php?page=$1&id=$2 [QSA,L] 
```

或者您可以使用 PHP 解析请求的路径：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule !^index\.php$ index.php [QSA,L]

// remove the query string from the request URI
$_SERVER['REQUEST_URI_PATH'] = preg_replace('/\?.*/', $_SERVER['REQUEST_URI']);
// removes leading and trailing slashes and explodes the path
$segments = explode('/', trim($_SERVER['REQUEST_URI_PATH'], '/'));
var_dump($segments); 
```

# visual-studio - Crystal Reports 将文本更改为小写

> ID：496367
> 
> 赞同：6
> 
> 时间：2009-01-30T17:17:15.073
> 
> 标签：visual-studio, crystal-reports

我在 Visual Studio 中的 Crystal Report 上有文本对象，初始大写。当我打印报告时，文本都是小写的。

原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-12-13T06:41:08.060

我们找到了解决此问题的方法。不知道这是如何工作的:) - 任何专家都可以解释吗？

我们发现，只要报告的任何页面/部分中的文本范围超出为报告设置的页面大小减去装订线、左/右页边距、上/下边距的设置，就会发生这种大小写变化的问题。

作为一种解决方法，我们已要求所有报告开发人员将文本（对于 A4 尺寸报告）保持在 7.5 英寸 X 7.5 英寸以内。坚持这一点就不会发生问题。

肯定想知道不当行为的确切原因。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2010-08-16T05:50:05.177

这可能会受到某些设置的影响。但是如果你去编辑这个字段，你可以看到它自动变为小写。如果您再次将其更改回您的案例，那么它将正常工作。

看起来它曾经发生过一次。老实说，我不知道为什么会这样

# java - 如何判断 XML 文档是针对 DTD 还是 XSD 进行验证？

> ID：496369
> 
> 赞同：4
> 
> 时间：2009-01-30T17:17:27.163
> 
> 标签：java, xml, validation, xsd, dtd

在 Java 中，我可以使用 javax.xml.validation.Validator 针对 XSD 模式验证 XML 文档，或者通过使用 org.xml.sax.XMLReader 简单地解析文档来针对 DTD 验证 XML 文档。

不过，我需要的是一种以编程方式确定文档本身是否针对 DTD（即它包含一条`<!DOCTYPE ...>`语句）或 XSD 进行验证的方法。理想情况下，我需要在不将整个 XML 文档加载到内存的情况下执行此操作。有人可以帮忙吗？

（或者，如果有一种*在*Java 中验证 XML 文档的方法既适用于 XSD 也适用于 DTD - 并且允许自定义资源解析 - 那会更好！）

非常感谢，

一种

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T17:45:11.040

请参阅[javax.xml.validation](http://java.sun.com/javase/6/docs/api/javax/xml/validation/package-summary.html)的包说明。它包含有关验证 XSD 和 DTD 的信息和示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-21T14:08:03.567

没有确定如何验证任意 XML 文档的 100% 万无一失的过程。

例如，这个 2.4 版[Web 应用程序部署描述符](http://en.wikipedia.org/wiki/Deployment_Descriptor)指定了一个[W3 模式](http://www.w3.org/XML/Schema)来验证文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app id="WebApp_ID" version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"> 
```

然而，这是表达同一件事的同样有效的方式：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app id="WebApp_ID" version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee"> 
```

[RELAX NG](http://relaxng.org/)似乎没有在文档中提供*任何*提示您应该使用它的机制。验证机制由文档消费者而非生产者决定。如果我没记错的话，这是推动从 DTD 转向更现代的验证机制的动力之一。

在我看来，最好的办法是根据您正在处理的文档类型集定制机制检测器，读取标题信息并酌情解释它。[StAX 解析器](http://java.sun.com/javase/6/docs/api/javax/xml/stream/package-summary.html)对此很有用——因为它是一种拉机制，您可以只读取文件的开头，然后在第一个元素上退出解析。

[链接到更多相同和示例代码等等。](http://illegalargumentexception.blogspot.com/2009/02/java-finding-validation-mechanism-for.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T22:44:19.203

你可以只使用字符串比较吗？

```
public enum Type {
    XSD,
    DTD,
    UNKNOWN
};

public Type findType(File f) throws FileNotFoundException, IOException {
    BufferedReader reader = null;
    try {
        reader = new BufferedReader(new FileReader(f));
        String line;
        // may want to cut this loop off after a certain number of lines
        while ((line = reader.readLine()) != null) {
            line = line.toLowerCase();
            if (line.contains("<!doctype"))
                return Type.DTD;
            else if (line.contains("xsi:schemaLocation"))
                return Type.XSD;
        }
    } finally {
        if (reader != null) {
            try {
                reader.close();
            } catch (IOException ex) {}
        }
    }
    return Type.UNKNOWN;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-10T14:56:43.773

您能否发布一个代码示例，说明如何针对给定的 dtd 验证 xml。模式似乎很容易，但我正在努力寻找如何使用 dtd 来完成它。

非常感谢，

丹尼斯。

好的，我找到了：

```
 XMLReader reader = XMLReaderFactory.createXMLReader();

    // try to activate validation
    try {
          // Turn on validation
          reader.setFeature("http://xml.org/sax/features/validation", true);
          // Ensure namespace processing is on (the default)
          reader.setFeature("http://xml.org/sax/features/namespaces", true);
    } catch (SAXException e) {
        System.err.println("Cannot activate validation.");
    }

    try {
        reader.parse("testFiasRequest.xml");
    } catch (IOException e) {
        System.err.println("I/O exception reading XML document");
    } catch (SAXException e) {
        System.err.println("XML exception reading document.");
    } 
```

# .net - 检查当前线程是否拥有锁

> ID：496388
> 
> 赞同：17
> 
> 时间：2009-01-30T17:22:14.800
> 
> 标签：.net, multithreading, locking

假设我有以下代码：

```
public class SomeClass()
{
    private readonly object _lock = new object();

    public void SomeMethodA()
    {
        lock (_lock)
        {
            SomeHelperMethod();

            //do something that requires lock on _lock
        }
    }

    public void SomeMethodB()
    {
        lock (_lock)
        {
            SomeHelperMethod();

            //do something that requires lock on _lock
        }
    }

    private void SomeHelperMethod()
    {
        lock (_lock)
        {
            //do something that requires lock on _lock
        }
    }
} 
```

锁定内部`SomeHelperMethod`似乎是多余和浪费的，因为所有调用者都已经锁定了。然而，简单地移除锁`SomeHelperMethod`似乎很危险，因为我们以后可能会重构代码并忘记`_lock`在调用之前锁定对象`SomeHelperMethod`。

理想情况下，我可以通过断言当前线程在`_lock`inside上拥有一个锁来解决这个问题`SomeHelperMethod`：

```
private void SomeHelperMethod()
{
    Debug.Assert(Monitor.HasLock(_lock));

    //do something that requires lock on _lock
} 
```

但似乎没有这样的方法。`Monitor.TryEnter`没有帮助，*因为*锁是可重入的。因此，如果当前线程已经拥有锁，`TryEnter`仍然会成功并返回`true`。唯一会失败的情况是另一个线程拥有锁并且调用超时。

那么，这样的方法存在吗？如果不是，为什么？这对我来说似乎一点也不危险，因为它只是告诉你当前线程（而不是另一个线程）是否拥有锁。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-08-20T07:19:35.590

这在 .NET 4.5 中使用[`Monitor.IsEntered(object)`](http://msdn.microsoft.com/en-US/library/system.threading.monitor.isentered%28v=vs.110%29.aspx).

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-02T11:18:19.993

锁定或重新锁定实际上是免费的。这种低成本的缺点是您没有其他同步机制那么多的功能。就像您在上面所说的那样，只要锁定至关重要，我就会简单地锁定。

如果您非常想省略“不必要的”锁而不冒潜在重构的风险，请添加注释。如果有人更改了您的代码并且它中断了，那里有一条注释来解释原因。如果他们仍然无法弄清楚，那是他们的问题，而不是你的问题。另一种选择是创建一个用作锁定对象的类，该对象包含一个可以打开和关闭的布尔值。但是，这样做带来的开销（包括 try/finally 块，它们不是免费的）可能不值得。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T19:08:48.517

您的请求存在根本问题。假设有一个 IsLockHeld() 方法，你会像这样使用它：

```
if (not IsLockHeld(someLockObj)) then DoSomething() 
```

这不能按设计工作。您的线程可能在 if() 语句和方法调用之间被抢占。允许另一个线程运行并锁定对象。现在 DoSomething() 将运行，即使持有锁。

避免这种情况的唯一方法是尝试获取锁并查看它是否有效。Monitor.TryEnter()。

您会在 Windows 中看到完全相同的模式。除了尝试打开文件之外，没有办法检查文件是否被另一个进程锁定。出于完全相同的原因。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-06-07T21:02:42.303

> 但似乎没有这样的方法。Monitor.TryEnter 没有帮助，因为锁是可重入的。因此，如果当前线程已经拥有锁，TryEnter 仍然会成功并返回 true。唯一会失败的情况是另一个线程拥有锁并且调用超时。

我找到了一种类似于 Monitor.TryEnter() 的解决方法，但没有重入问题。基本上，您可以使用 Monitor.Pulse()，而不是使用 Monitor.TryEnter()。如果当前线程没有持有锁，此函数将引发 SynchronizationLockException 异常。

例子：

```
try
{
    System.Threading.Monitor.Pulse(lockObj);
}
catch (System.Threading.SynchronizationLockException /*ex*/)
{
    // This lock is unlocked! run and hide ;)
} 
```

文档：http: [//msdn.microsoft.com/en-us/library/system.threading.monitor.pulse.aspx](http://msdn.microsoft.com/en-us/library/system.threading.monitor.pulse.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T17:56:22.420

好的，我现在明白你的问题了。从概念上讲，我现在正在考虑一个信号量对象。您可以轻松检查信号量值（大于或等于 0 的值表示资源可用）。此外，这实际上并不会通过增加或减少信号量值来锁定正在执行的资源。[Semaphore](http://msdn.microsoft.com/en-us/library/system.threading.semaphore_methods.aspx)对象存在于 .NET 框架中，但我没有使用它，因此无法提供适当的示例。如有必要，我可以构建一个简单的示例并将其发布在这里。让我知道。

亚历克斯。

LE 我现在不确定您是否真的可以控制应用程序中的同步机制。如果您只能访问可以锁定或不锁定的对象，我的解决方案可能会（再次）证明没有用。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T18:29:10.513

我希望这是可能的，这将使我的代码更加简洁。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-03T08:42:53.753

我对 .NET 编程没有任何经验，但是在我自己的代码（Delphi）中，我曾经通过在临界区类中使用自定义 Acquire() 和 Release() 方法来实现这样的断言，其中的 id 为私有成员变量获取cs的线程。在 EnterCriticalSection() 之后写入 GetCurrentThreadID 的返回值，在 LeaveCriticalSection() 之前重置字段值。

但我不知道.NET 是否允许类似的事情，或者你是否可以在你的程序中实现它......

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-06-30T22:53:18.693

我对检查锁是否被当前线程锁定有类似的要求，所以我可以做这样的事情。

```
public void Method1()
{
    if(!lockHeld()) lock();
    //DO something
}
public void Method2()
{
    if(!lockHeld()) lock();
    //DO something
}
public void Method3()
{
    if(!lockHeld()) lock();

    //Do something

    unlock()
} 
```

所以我为此给自己写了一个类：

```
public class LockObject
{
    private Object internalLock;

    private bool isLocked;
    public bool IsLocked
    {
        get { lock (internalLock) return isLocked; }
        private set { lock (internalLock) isLocked = value; }
    }

    public LockObject()
    {
        internalLock = new object();
    }

    public void UsingLock(Action method)
    {
        try
        {
            Monitor.Enter(this);
            this.IsLocked = true;

            method();
        }
        finally
        {
            this.IsLocked = false;
            Monitor.Exit(this);
        }
    }
} 
```

然后我可以将其用作：

```
 public void Example()
    {
        var obj = new LockObject();

        obj.UsingLock(() =>
        {
            //Locked, and obj.IsLocked = true
        });
    } 
```

注意：我在这个类上省略了 Lock() Unlock() 方法，但几乎只是将 IsLocked 设置为 true 的 Monitor.Enter/Exit 的包装器。这个例子只是说明它在风格上与 lock(){ } 非常相似。

可能没有必要，但这对我很有用。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-15T18:04:00.920

如果您在 .NET 4.5 下需要此功能，请参阅@Dave 接受的答案。

但是，如果您在 .NET 3.5 或 4 下需要此功能，您可以按如下方式替换 ReaderWriterLockSlim 的监视器锁的使用。

[根据 Joeseph Albahari 的说法，](http://www.albahari.com/threading/part2.aspx#_Locking)这将使您的（无争议的）锁定开销大约翻倍，但它仍然非常快（估计 40nS）。（免责声明，该页面没有说明测试是否使用递归锁定策略完成。）

```
public class SomeClass()
{
private readonly ReaderWriterLockSlim _lock = new ReaderWriterLockSlim(LockRecursionPolicy.SupportsRecursion);

public void SomeMethodA()
{
    _lock.EnterWriteLock();
    try
    {
        SomeHelperMethod();

        //do something that requires lock on _lock
    }
    finally
    {
       _lock.ExitWriteLock();
    }
}

private void SomeHelperMethod()
{
    Debug.Assert(_lock.IsWriteLockHeld);

    //do something that requires lock on _lock
}
} 
```

如果您觉得这太不高效，您当然可以围绕 Monitor 锁编写自己的包装类。但是，其他帖子提到了一个布尔标志，该标志具有误导性，因为问题不是“任何线程都持有锁吗？” （这是一个愚蠢而危险的问题）。正确的问题是“这个线程是否持有锁？”。不过没问题，只需将“标志”设置为[ThreadLocal](https://stackoverflow.com/questions/4190764/thread-local-storage)计数器（用于递归锁支持）并确保在 Monitor.Enter 和 Monitor.Exit 之前完成更新。作为一项改进，断言计数器在“解锁”时不会降至 0 以下，因为这表明进入/退出调用不平衡。

包装器的另一个原因是避免有人滑入 _lock.EnterReadLock 调用。根据类的使用情况，这些实际上可能会有所帮助，但数量惊人的编码人员不理解读写器锁。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2009-01-30T19:32:09.467

不是最好的事情，但......

```
bool OwnsLock(object someLockObj)
{
  if (Monitor.TryEnter(someLockObj))
  {
    Monitor.Exit();
    return false;
  }
  return true;
}

Debug.Assert(OwnsLock(_someLockObject), "_someLockObject should be locked when this method is called") 
```

# asp.net-mvc - 您如何测试您的 ASP MVC 应用程序以实现基于用户的安全性？

> ID：496393
> 
> 赞同：5
> 
> 时间：2009-01-30T17:22:42.990
> 
> 标签：asp.net-mvc, authentication, testing

一段时间以来，我一直在为我的域对象编写测试，但我仍然不太确定如何在我的 Web 项目中进行安全性测试。某些环境中的某些用户可以访问我的模型的某些属性等，但是您将如何测试呢？现在，我基于当前经过身份验证的用户，但我将如何注入假身份验证提供程序？

这可能是一个愚蠢的问题，但如果有人能帮助我摆脱测试的黑暗时代，将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-26T06:03:44.877

该链接是一种方式，但使用 Mock 更好：

```
 Mock<ControllerContext> MockContext(string userName)
    {
        var mockContext = new Mock<ControllerContext>();
        // mock an authenticated user
        mockContext.SetupGet(p => p.HttpContext.User.Identity.Name).Returns(userName);
        mockContext.SetupGet(p => p.HttpContext.User.Identity.IsAuthenticated).Returns(true);
        return mockContext;
    }

    [TestMethod]
    public void DinnersController_Delete_Should_Fail_With_InvalidOwner_Given_Wrong_User()
    {
        //set by default
        var mockContext = MockContext("scottha");

        // mock an authenticated user
        _dinnerController.ControllerContext = mockContext.Object;

        ViewResult result = _dinnerController.Delete(1, "") as ViewResult;
        Assert.AreEqual("InvalidOwner", result.ViewName);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-25T08:59:19.877

如果使用 TDD，您的测试应该只测试有问题的代码，所有其他关联对象应该是模拟/伪造

除其他外，您需要一个模拟安全提供程序来模拟您需要测试的用户案例（访客、用户 1、用户 2、管理员等）

当您使用当前 MVC RC 创建一个空白 MVC 项目时，您将获得一个带有模拟安全提供程序（成员资格/角色等）的基本测试框架。他们需要一些充实，但要给出基本的设计

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-26T17:33:12.830

还有第三种选择，即使用[Xania.AspNet.Simulator](https://www.nuget.org/packages/Xania.AspNet.Simulator/)

首先准备控制器动作

```
// arrange
var controllerAction = new AccountController().Action(c => c.ChangePassword())
    .Authenticate(<username>, <roles>); 
```

接下来，根据您的实施，您有两个选择，

第一种情况，如果您返回一个 HttpUnauthorizedResult，即当使用 Authorize 属性或当您覆盖控制器的 AuthorizeCore 时，那么您可以像下面一样对其进行测试，在这种情况下，不会调用实际的操作方法。

```
// act, assert
controllerAction.Authorize().Should().BeNull(); 
```

第二种情况是当您在操作方法中实际验证用户时：

```
// act
var result = controllerAction.Execute();
// assert
result.ActionResult.Should().NotBeOfType<HttpUnauthorizedResult>(); 
```

# macos - 如何在我的 Mac 上安装 MonoDevelop？

> ID：496395
> 
> 赞同：3
> 
> 时间：2009-01-30T17:23:20.383
> 
> 标签：macos, monodevelop

我刚刚为我的 Mac 下载了 MonoDevelop，但我不知道如何安装它。

有谁知道在终端中输入*什么*来安装它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T17:25:07.210

最近更新的用于 MacOS X 的 Mono 1.2.6 包包含[Imendio 的 Native Gtk+ for OSX](http://developer.imendio.com/projects/gtk-macosx)、Gtk# 和支持 Mac 的 MonoDevelop 0.18.1。现在可以从[Mono 的下载页面](http://www.go-mono.com/mono-downloads/download.html)获得。

看来您必须运行所有这三个安装才能使其正常工作：

*   [Mono 2.2_5 框架 - 通用](http://ftp.novell.com/pub/mono/archive/2.2/macos-10-universal/5/MonoFramework-2.2_5.macos10.novell.universal.dmg)
*   [MonoDevelop 2.0 阿尔法 2](http://ftp.novell.com/pub/mono/monodevelop/MonoDevelop-1.9.1-1.dmg)
*   [Cocoa# 0.9.4 源码](http://go-mono.com/sources/cocoa-sharp/cocoa-sharp-0.9.4.tar.bz2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-03T11:28:38.710

此链接可能对新手有所帮助。 [单声道：OSX](http://www.mono-project.com/Mono:OSX#Using_Mono_on_MacOS_X)

如果您对在 os X 中构建 Monodevelop 感兴趣，请点击以下链接：

[构建单声道开发](http://monodevelop.com/Developers/Mac_Support/Building_MonoDevelop_on_OS_X)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-04T14:18:17.433

Xamarin Studio 可以使用 Homebrew 安装。

> 对于 Mac 和 Windows，您可以下载 Xamarin Studio，它是 MonoDevelop 以及 Xamarin iOS/Android 插件和品牌的捆绑包。
> 
> –[下载 | 单声道开发](http://www.monodevelop.com/download/)。

Xamarin Studio 有一个 Homebrew Cask。
安装可以如下进行：

```
$ brew install Caskroom/cask/xamarin-studio 
```

这个问题可能很有用：[How to use Homebrew's version of Mono with Xamarin - 堆栈内存溢出](https://stackoverflow.com/questions/23553233/)。

# sed - 文件中的 DOS 到 UNIX 路径替换

> ID：496408
> 
> 赞同：4
> 
> 时间：2009-01-30T17:26:56.507
> 
> 标签：sed, cygwin, awk, gcov, lcov

我有一个包含这种路径的文件：

```
C:\bad\foo.c
C:\good\foo.c
C:\good\bar\foo.c
C:\good\bar\[variable subdir count]\foo.c 
```

我想得到以下文件：

```
C:\bad\foo.c
C:/good/foo.c
C:/good/bar/foo.c
C:/good/bar/[variable subdir count]/foo.c 
```

请注意，不应修改不匹配的路径。

我知道如何使用 sed 为固定数量的子目录执行此操作，但是可变数量给我带来了麻烦。实际上，我将不得不使用许多`s/x/y/`表达式（与最大深度一样多......不是很优雅）。

可能是用awk，但这种魔法超出了我的技能。

仅供参考，我需要这个技巧来纠正 cygwin 平台上的一些 gcov 二进制文件。

* * *

我正在处理二进制文件；因此，我可能有以下类型的数据：

```
bindata\bindata%bindataC:\good\foo.c 
```

应该翻译为：

```
bindata\bindata%bindataC:/good/foo.c 
```

第一个`\`不能翻译，尽管它在同一行。

但是，我刚刚`.gcno`在编辑此文本时检查了我的文件，看起来所有路径的两侧都带有零，因此下面的大多数答案都应该适合。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T17:35:46.440

```
sed -e '/^C:\\good/ s/\\/\//g' input_file.txt 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T17:36:07.283

我建议您查看该`cygpath`实用程序，它将路径名从一种格式转换为另一种格式。例如在我的机器上：

```
$ cygpath `pwd`
/home/jericson

$ cygpath -w `pwd`
D:\root\home\jericson

$ cygpath -m `pwd`
D:/root/home/jericson 
```

这是您要求的 Perl 实现：

```
$ echo 'C:\bad\foo.c
C:\good\foo.c
C:\good\bar\foo.c
C:\good\bar\[variable subdir count]\foo.c' | perl -pe 's|\\|/|g if /good/'
C:\bad\foo.c
C:/good/foo.c
C:/good/bar/foo.c
C:/good/bar/[variable subdir count]/foo.c 
```

它直接与字符串一起工作，因此它可以在任何地方工作。您可以将它与 结合使用`cygpath`，但它仅适用于具有该路径的机器：

```
perl -pe '$_ = `cygpath -m $_` if /good/' 
```

（因为我的机器上没有 C:\good，所以我得到的输出类似于`C:goodfoo.c`。如果您在机器上使用真实路径，它应该可以正常工作。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T17:32:24.000

您想用 ' `/`' 代替所有 ' `\`'，但只能在与良好目录路径匹配的行上。sed 和 awk 都可以让您通过 LHS（匹配）表达式来执行此操作，该表达式仅选择具有正确路径的行。

执行此操作的简单 sed 脚本如下所示：

```
/[Cc]:\\good/ s/\\/\//g 
```

对于文件：

```
c:\bad\foo
c:\bad\foo\bar
c:\good\foo
c:\good\foo\bar 
```

您将获得以下输出：

```
c:\bad\foo
c:\bad\foo\bar
c:/good/foo
c:/good/foo/bar 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T17:50:06.023

以下是我在 awk 中的做法：

```
# fixpaths.awk
/C:\\good/ {
   gsub(/\\/,"/",$1);
   print $1 >> outfile;
} 
```

然后使用以下命令运行它：

```
awk -f fixpaths.awk paths.txt; mv outfile paths.txt 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T17:41:32.717

或者在好的 ol' Bash 的帮助下：

```
#!/bin/bash

cat file | while read LINE
do
        if <bad_condition>
        then
                echo "$LINE" >> newfile
        else
                echo "$LINE" | sed -e "s/\\/\//g" >> newfile
        fi
done 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-21T08:05:52.870

试试这个

`sed -re '/\\good\\/ s/\\/\//g' temp.txt`

或这个

`awk -F"\\" '{if($2=="good"){OFS="\/"; $1=$1;} print $0}' temp.txt`

# .net - 重复 WinForms 数据有比 DataGridView 更好的选择吗？

> ID：496409
> 
> 赞同：2
> 
> 时间：2009-01-30T17:27:04.227
> 
> 标签：.net, winforms, datagridview

我面临在*WinForms*应用程序中输入“参差不齐”的数据的需要。某些类型的输入行需要某些列，而其他输入行不允许使用某些列，并且后面列中的组合框数据需要根据前面的列而变化。

我的问题是：有没有更好的方法来处理不像 DataGridView 优化支持的那样规则的数据。我知道如何使用“EditingControlShowing”根据早期的条目信息更新下拉菜单，但这是否太过分了？

可视化需要输入的数据的一些示例：

```
班级 | 子类 | 公司 | 账单金额 | 委员会 ％
甲级 | ClassA.Sub1 | | $ 1,500.00 | 12%
B类 | | | $ 250.00 | 0%
C类 | | C.C1 类 | $ 450.00 | 0%
D 类 | D 类.Sub1 | D.Sub1.C1 类 | $ 800.00 | 12%

```

我使用虚线表示法表示组合框取决于它们之前的虚线项目（因此 ClassD.Sub1.C1 将是一个查找选项“WHERE Class = 'ClassD' and Sub = 'Sub1 '”。

我已经破解了 DataGridView 以使其工作，但它看起来非常丑陋。有没有更好的办法？*您将使用什么控件/方法来呈现在WinForms*中逐行变化的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-31T09:19:10.170

[SourceGrid](http://www.codeproject.com/KB/grid/csharpgridcontrol.aspx)怎么样？我没有在生产中使用它，但我玩过它，它看起来很灵活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-31T22:58:55.353

也许中继器控件可以为您提供所需的灵活性， http: [//msdn.microsoft.com/en-us/vbasic/bb735936.aspx](http://msdn.microsoft.com/en-us/vbasic/bb735936.aspx)。

我已经将它用于自定义用户控件，并且效果很好。

# sql-server - 确定表的行大小

> ID：496413
> 
> 赞同：54
> 
> 时间：2009-01-30T17:29:13.070
> 
> 标签：sql-server, tsql

如何确定表的最大行大小？我正在寻找执行此操作的工具或脚本，因此我不必手动添加每列的大小。

我的目标是生成一个太宽的表格的报告，以便我们可以研究重组它们。我知道我们有几个非常宽，每个 8K 页面上只有 1 行，但我想找到其余的。

* * *

## 回答 #1

> 赞同：82
> 
> 时间：2009-01-30T17:44:07.487

另一种方法，运行它然后查看MaximumRecordsize

```
dbcc showcontig ('YourTableNameHere') with tableresults 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2016-07-16T09:06:32.220

由于[DBCC SHOWCONTIG](https://msdn.microsoft.com/en-us/library/ms175008.aspx)将被弃用，`Microsoft`建议改用[sys.dm_db_index_physical_stats](https://msdn.microsoft.com/en-us/library/ms188917.aspx)。您还可以获得每个索引和其他统计信息的最大、最小和平均行大小：

```
SELECT * FROM sys.dm_db_index_physical_stats (DB_ID(N'AdventureWorks2014'), OBJECT_ID(N'[sales].[SalesOrderHeader]'), NULL, NULL , 'DETAILED') 
```

输出：

```
database_id object_id   index_id    partition_number index_type_desc                                              alloc_unit_type_desc                                         index_depth index_level avg_fragmentation_in_percent fragment_count       avg_fragment_size_in_pages page_count           avg_page_space_used_in_percent record_count         ghost_record_count   version_ghost_record_count min_record_size_in_bytes max_record_size_in_bytes avg_record_size_in_bytes forwarded_record_count compressed_page_count
----------- ----------- ----------- ---------------- ------------------------------------------------------------ ------------------------------------------------------------ ----------- ----------- ---------------------------- -------------------- -------------------------- -------------------- ------------------------------ -------------------- -------------------- -------------------------- ------------------------ ------------------------ ------------------------ ---------------------- ---------------------
6           1266103551  1           1                CLUSTERED INDEX                                              IN_ROW_DATA                                                  3           0           0.439882697947214            28                   24.3571428571429           682                  98.8644304423029               31465                0                    0                          154                      195                      171.487                  NULL                   0
6           1266103551  1           1                CLUSTERED INDEX                                              IN_ROW_DATA                                                  3           1           0                            2                    1                          2                    54.7442550037064               682                  0                    0                          11                       11                       11                       NULL                   0
6           1266103551  1           1                CLUSTERED INDEX                                              IN_ROW_DATA                                                  3           2           0                            1                    1                          1                    0.296515937731653              2                    0                    0                          11                       11                       11                       NULL                   0
6           1266103551  2           1                NONCLUSTERED INDEX                                           IN_ROW_DATA                                                  2           0           0                            4                    25.5                       102                  99.0670990857425               31465                0                    0                          24                       24                       24                       NULL                   0
6           1266103551  2           1                NONCLUSTERED INDEX                                           IN_ROW_DATA                                                  2           1           0                            1                    1                          1                    31.4801087225105               102                  0                    0                          23                       23                       23                       NULL                   0
6           1266103551  3           1                NONCLUSTERED INDEX                                           IN_ROW_DATA                                                  2           0           0                            3                    36.3333333333333           109                  99.8363355572029               31465                0                    0                          26                       26                       26                       NULL                   0
6           1266103551  3           1                NONCLUSTERED INDEX                                           IN_ROW_DATA                                                  2           1           0                            1                    1                          1                    36.3355572028663               109                  0                    0                          25                       25                       25                       NULL                   0
6           1266103551  4           1                NONCLUSTERED INDEX                                           IN_ROW_DATA                                                  2           0           0                            2                    27.5                       55                   98.9285025945145               31465                0                    0                          12                       12                       12                       NULL                   0
6           1266103551  4           1                NONCLUSTERED INDEX                                           IN_ROW_DATA                                                  2           1           0                            1                    1                          1                    11.527057079318                55                   0                    0                          15                       15                       15                       NULL                   0
6           1266103551  5           1                NONCLUSTERED INDEX                                           IN_ROW_DATA                                                  2           0           0                            2                    27.5                       55                   98.9285025945145               31465                0                    0                          12                       12                       12                       NULL                   0
6           1266103551  5           1                NONCLUSTERED INDEX                                           IN_ROW_DATA                                                  2           1           0                            1                    1                          1                    13.5656041512231               55                   0                    0                          18                       18                       18                       NULL                   0 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-30T18:56:13.097

这是我得到的另一个查询，但是像 Tomalak 的查询一样，它被破坏了，因为它没有考虑到诸如可变长度列的开销之类的事情。

```
SELECT OBJECT_NAME (id) tablename
     , COUNT (1)        nr_columns
     , SUM (length)     maxrowlength
FROM   syscolumns
GROUP BY OBJECT_NAME (id)
ORDER BY OBJECT_NAME (id) 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-07-18T12:39:18.170

可能不是最好的，但这显示了数据类型为日期、时间等的列的行数+

```
SELECT 
    t.NAME AS TableName,
    s.Name AS SchemaName,
    p.rows AS RowCounts,
    SUM(a.total_pages) * 8 AS TotalSpaceKB, 
    CAST(ROUND(((SUM(a.total_pages) * 8) / 1024.00), 2) AS NUMERIC(36, 2)) AS TotalSpaceMB,
    SUM(a.used_pages) * 8 AS UsedSpaceKB, 
    CAST(ROUND(((SUM(a.used_pages) * 8) / 1024.00), 2) AS NUMERIC(36, 2)) AS UsedSpaceMB, 
    (SUM(a.total_pages) - SUM(a.used_pages)) * 8 AS UnusedSpaceKB,
    CAST(ROUND(((SUM(a.total_pages) - SUM(a.used_pages)) * 8) / 1024.00, 2) AS NUMERIC(36, 2)) AS UnusedSpaceMB
FROM 
    sys.tables t
INNER JOIN      
    sys.indexes i ON t.OBJECT_ID = i.object_id
INNER JOIN 
    sys.partitions p ON i.object_id = p.OBJECT_ID AND i.index_id = p.index_id
INNER JOIN 
    sys.allocation_units a ON p.partition_id = a.container_id
LEFT OUTER JOIN 
    sys.schemas s ON t.schema_id = s.schema_id
INNER JOIN  sysobjects so on t.object_id = so.id
INNER JOIN  syscolumns SC on (so.id = sc.id)
INNER JOIN systypes st on (st.type = sc.type)
WHERE 
    t.NAME NOT LIKE 'dt%' 
    AND t.is_ms_shipped = 0
    AND i.OBJECT_ID > 255 
    AND so.type = 'U'
and st.name IN ('DATETIME', 'DATE', 'TIME')
GROUP BY 
    t.Name, s.Name, p.Rows
ORDER BY 
    p.rows DESC 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-30T17:38:31.897

看看`INFORMATION_SCHEMA.COLUMNS`。您可以添加表中每列的大小，以了解哪些表有可能超出 8k/行规则。

```
SELECT * FROM INFORMATION_SCHEMA.COLUMNS 
```

当您看到查询结果时，您将弄清楚其余部分。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-12-17T09:22:56.903

获得表格大小的更好选择

```
SELECT 
    t.NAME AS TableName,
    s.Name AS SchemaName,
    p.rows AS RowCounts,
    SUM(a.total_pages) * 8 AS TotalSpaceKB, 
    CAST(ROUND(((SUM(a.total_pages) * 8) / 1024.00), 2) AS NUMERIC(36, 2)) AS TotalSpaceMB,
    SUM(a.used_pages) * 8 AS UsedSpaceKB, 
    CAST(ROUND(((SUM(a.used_pages) * 8) / 1024.00), 2) AS NUMERIC(36, 2)) AS UsedSpaceMB, 
    (SUM(a.total_pages) - SUM(a.used_pages)) * 8 AS UnusedSpaceKB,
    CAST(ROUND(((SUM(a.total_pages) - SUM(a.used_pages)) * 8) / 1024.00, 2) AS NUMERIC(36, 2)) AS UnusedSpaceMB
FROM 
    sys.tables t
INNER JOIN      
    sys.indexes i ON t.OBJECT_ID = i.object_id
INNER JOIN 
    sys.partitions p ON i.object_id = p.OBJECT_ID AND i.index_id = p.index_id
INNER JOIN 
    sys.allocation_units a ON p.partition_id = a.container_id
LEFT OUTER JOIN 
    sys.schemas s ON t.schema_id = s.schema_id
WHERE 
    t.NAME NOT LIKE 'dt%' 
    AND t.is_ms_shipped = 0
    AND i.OBJECT_ID > 255 
GROUP BY 
    t.Name, s.Name, p.Rows
ORDER BY 
    t.Name 
```

# .net - 使用 System.IO.Ports.SerialPort 类打开串行端口时出错

> ID：496415
> 
> 赞同：3
> 
> 时间：2009-01-30T17:29:48.620
> 
> 标签：.net, serial-port

我正在尝试使用 System.IO.Ports.SerialPort 类打开和读取串行端口。我将串行端口从工具窗格 (Visual Studio 2008) 拖到我的 Windows 窗体应用程序上。

我已经设置了一个属性网格，因此我可以在运行时轻松更改串行端口的属性。当我尝试打开端口时，我收到如下所示的错误。我不明白为什么，因为我可以使用超级终端打开和读取端口。

有任何想法吗？

```
System.IO.IOException Error connection: A device attached to the system is not functioning
   at System.IO.Ports.InternalResources.WinIOError(Int32 errorCode, String str)
   at System.IO.Ports.InternalResources.WinIOError()
   at System.IO.Ports.SerialStream.set_DtrEnable(Boolean value)
   at System.IO.Ports.SerialStream..ctor(String portName, Int32 baudRate, Parity parity, Int32 dataBits, StopBits stopBits, Int32 readTimeout, Int32 writeTimeout, Handshake handshake, Boolean dtrEnable, Boolean rtsEnable, Boolean discardNull, Byte parityReplace)
   at System.IO.Ports.SerialPort.Open()
   at Test.CardReader.frmMain.Connect() in D:\Develop\2.0\Projects\Kiosk\EmbeddedBrowser\Windows Forms\Test.CardReader\Form1.cs:line 166 
```

注意，这是一个 USB 连接，所以它实际上是一个虚拟串口。

我的设置如下：

BaudRate = 9600
DataBits = 8
DiscardNull = false
DtrEnable = false
Handshake = None
Parity = None
ParityReplace = 63
PortName = COM3
ReadBufferSize = 4096
ReadTimeout = -1
ReceivedBytes = 1
TrsEnable = False
StopBits = One
WriteBufferSize = 2048
WriteTimeout = -1

我从[Sysinternals](https://en.wikipedia.org/wiki/Sysinternals)下载[了 PortMon](https://docs.microsoft.com/en-us/sysinternals/downloads/portmon)。我已经捕获了两个日志。第一个是[超级终端](https://en.wikipedia.org/wiki/HyperACCESS)打开端口时发生的情况的日志，第二个是 .NET SerialPort 类尝试打开端口时发生的情况：

超级终端：

```
IRP_MJ_CREATE                  USBSER000  SUCCESS       Options: Open
IOCTL_SERIAL_SET_QUEUE_SIZE    USBSER000  SUCCESS       InSize: 8192 OutSize: 8192
IOCTL_SERIAL_CONFIG_SIZE       USBSER000  SUCCESS       Size: 0
IOCTL_SERIAL_GET_BAUD_RATE     USBSER000  SUCCESS
IOCTL_SERIAL_GET_LINE_CONTROL  USBSER000  SUCCESS
IOCTL_SERIAL_GET_CHARS         USBSER000  SUCCESS
IOCTL_SERIAL_GET_HANDFLOW      USBSER000  SUCCESS
IOCTL_SERIAL_GET_BAUD_RATE     USBSER000  SUCCESS
IOCTL_SERIAL_GET_LINE_CONTROL  USBSER000  SUCCESS
IOCTL_SERIAL_GET_CHARS         USBSER000  SUCCESS
IOCTL_SERIAL_GET_HANDFLOW      USBSER000  SUCCESS
IOCTL_SERIAL_SET_BAUD_RATE     USBSER000  SUCCESS       Rate: 9600
IOCTL_SERIAL_SET_RTS           USBSER000  SUCCESS
IOCTL_SERIAL_SET_DTR           USBSER000  * 0xC0000001
IOCTL_SERIAL_SET_LINE_CONTROL  USBSER000  SUCCESS       StopBits: 1 Parity: NONE WordLength: 8
IOCTL_SERIAL_SET_CHAR          USBSER000  SUCCESS       EOF:1a ERR:0 BRK:0 EVT:1a XON:f6 XOFF:6
IOCTL_SERIAL_SET_HANDFLOW      USBSER000  SUCCESS       Shake:80000001 Replace:80000040 XonLimit:80 XoffLimit:200
IOCTL_SERIAL_SET_TIMEOUTS      USBSER000  SUCCESS       RI:10 RM:0 RC:0 WM:0 WC:5000
IOCTL_SERIAL_SET_WAIT_MASK     USBSER000  SUCCESS       Mask: RLSD ERR
IOCTL_SERIAL_GET_MODEMSTATUS   USBSER000  SUCCESS
IOCTL_SERIAL_WAIT_ON_MASK      USBSER000
IRP_MJ_READ    USBSER000                                Length 80 
```

.NET 串行端口：

```
IRP_MJ_CREATE                  USBSER000  SUCCESS       Options: Open
IOCTL_SERIAL_GET_PROPERTIES    USBSER000  SUCCESS
IOCTL_SERIAL_GET_MODEMSTATUS   USBSER000  SUCCESS
IOCTL_SERIAL_GET_BAUD_RATE     USBSER000  SUCCESS
IOCTL_SERIAL_GET_LINE_CONTROL  USBSER000  SUCCESS
IOCTL_SERIAL_GET_CHARS         USBSER000  SUCCESS
IOCTL_SERIAL_GET_HANDFLOW      USBSER000  SUCCESS
IOCTL_SERIAL_GET_BAUD_RATE     USBSER000  SUCCESS
IOCTL_SERIAL_GET_LINE_CONTROL  USBSER000  SUCCESS
IOCTL_SERIAL_GET_CHARS         USBSER000  SUCCESS
IOCTL_SERIAL_GET_HANDFLOW      USBSER000  SUCCESS
IOCTL_SERIAL_SET_BAUD_RATE     USBSER000  SUCCESS       Rate: 9600
IOCTL_SERIAL_CLR_RTS           USBSER000  SUCCESS
IOCTL_SERIAL_CLR_DTR           USBSER000  * 0xC0000001
IOCTL_SERIAL_SET_LINE_CONTROL  USBSER000  SUCCESS       StopBits: 1 Parity: NONE WordLength: 8
IOCTL_SERIAL_SET_CHAR          USBSER000  SUCCESS       EOF:1a ERR:0 BRK:0 EVT:1a XON:11 XOFF:13
IOCTL_SERIAL_SET_HANDFLOW      USBSER000  SUCCESS       Shake:0 Replace:0 XonLimit:4096 XoffLimit:4096
IOCTL_SERIAL_GET_BAUD_RATE     USBSER000  SUCCESS
IOCTL_SERIAL_GET_LINE_CONTROL  USBSER000  SUCCESS
IOCTL_SERIAL_GET_CHARS         USBSER000  SUCCESS
IOCTL_SERIAL_GET_HANDFLOW      USBSER000  SUCCESS
IOCTL_SERIAL_SET_BAUD_RATE     USBSER000  SUCCESS       Rate: 9600
IOCTL_SERIAL_CLR_RTS           USBSER000  SUCCESS
IOCTL_SERIAL_CLR_DTR           USBSER000  * 0xC0000001
IOCTL_SERIAL_SET_LINE_CONTROL  USBSER000  SUCCESS       StopBits: 1 Parity: NONE WordLength: 8
IOCTL_SERIAL_SET_CHAR          USBSER000  SUCCESS       EOF:1a ERR:0 BRK:0 EVT:1a XON:11 XOFF:13
IOCTL_SERIAL_SET_HANDFLOW      USBSER000  SUCCESS       Shake:0 Replace:0 XonLimit:4096 XoffLimit:4096
IOCTL_SERIAL_CLR_DTR           USBSER000  * 0xC0000001
IRP_MJ_CLEANUP                 USBSER000  SUCCESS
IRP_MJ_CLOSE                   USBSER000  SUCCESS 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T22:44:28.690

关于超级终端和.NET 串口对象的区别，超级终端是一个商业的、稳定的应用程序。如果底层串行端口对象死亡或抛出异常，超级终端会将其隐藏起来。.NET 串行端口对象比我使用过的任何其他 .NET 对象都抛出更多异常。

要点：

*   每当您更改设置时，请先关闭它，然后再更改它，然后重新打开它。当您在打开时更改它时，有些端口真的很讨厌它。
*   期望围绕你的串口对象做很多“try-catch”，围绕你做的每一件事。
*   确保列出的每个可能的异常都有一个，并确保每个都检查消息（在不同的情况下可能会有所不同）。许多都可以通过关闭和重新打开来恢复。
*   尝试准确跟踪引发异常的位置。看看修改你设置的顺序是否可以修复它......这个对象真的很挑剔。

如果您在打开之前尝试将 DTR 显式设置为 false，那么您可能只需要咧嘴一笑并忍受该设备。SerialPort 对象不是 .NET 中实现良好的库的发光示例之一。如果您注意到，超级终端会收到同样的错误，但它只是忽略了它。

如果可以，请尝试使用普通串口或其他品牌的 USB 设备。如果您仍然遇到相同的错误，则可能是您的应用程序方面的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T17:41:43.230

在真正的[UART](http://en.wikipedia.org/wiki/Universal_asynchronous_receiver/transmitter)中，*DTREnable*将断言 UART 的*DTR*引脚以指示您已准备好接收数据。

根据您的驱动程序的实现，您可能需要将*DTREnable*设置`true`为打开端口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T19:36:10.630

请参阅此[论坛帖子](http://www.eggheadcafe.com/software/aspnet/31664937/setcommstate-fails-with.aspx)。我怀疑这与硬件或驱动程序故障有关。这并不能解释为什么它可以与超级终端一起使用。遵循 Joseph M. Newcomer 的建议，了解 HyperTerminal 的不同之处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-17T12:18:34.283

看起来不同的是握手。

我没有遇到串行端口类的问题，并且编写了以 800,000 位/秒运行的应用程序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-17T18:33:52.143

我的串口监听器有问题，主进程卡住了——因为它是同步的。过程，通过创建一个线程和一个计时器来解决

```
try
            {
                if (_serialConnection.IsOpen) _serialConnection.Close();
                _serialConnection.Open();
                Thread newThread = new Thread((obj) =>
                {
                    System.Timers.Timer timer = new System.Timers.Timer();
                    timer.Interval = 1000;
                    timer.Elapsed += (sender, e) =>
                    {
                        _slave.Listen();
                    };
                    timer.Enabled = true;
                    timer.Start();

                });
                newThread.IsBackground = true;
                newThread.Start();
            }
            catch (Exception ex)
            {
                throw ex;
            } 
```

# c# - C# - 获取字段类型

> ID：496430
> 
> 赞同：2
> 
> 时间：2009-01-30T17:33:35.493
> 
> 标签：c#, .net-2.0, odbc, dataset

在 C# 2.0 中，我有一个字段列表和一个值列表（存储为字符串）、一个表名和一个 ODBC 连接。

我需要获取该表上字段的数据类型，所以我知道如何生成我的 sql。

从我所拥有的信息中获取这些信息的最佳方式是什么？

我唯一的想法是`SELECT TOP 0 * FROM @TableName`在数据适配器中做一个，取回数据集，然后根据数据表中的数据列遍历字段名称列表。

有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T17:35:57.843

试试这个

```
select * from sys.columns where object_id = object_id('MyTable') 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T18:38:09.170

您最好的选择是像 Nick Beradi 提到的那样查询您的数据库系统表。如果出于某种原因这不是一个选项，您可以执行以下操作：

```
using (SqlConnection conn = new SqlConnection(myConnectionString))
            {
                using (SqlDataAdapter adapter = new SqlDataAdapter("SELECT * from MyTable", conn))
                {
                    DataTable table = new DataTable();
                    adapter.FillSchema(table, SchemaType.Mapped);
                    //at this point, table will have no rows, but will have all the columns of which you can get their datatypes
                }
            } 
```

# c++ - 来自构造函数的 C++ 虚函数

> ID：496440
> 
> 赞同：59
> 
> 时间：2009-01-30T17:37:03.880
> 
> 标签：c++, oop, class, constructor, virtual

**为什么下面的示例打印“0”以及必须更改什么才能按我的预期打印“1”？**

```
#include <iostream>
struct base {
   virtual const int value() const {
      return 0;
   }
   base() {
      std::cout << value() << std::endl;
   }
   virtual ~base() {}
};

struct derived : public base {
   virtual const int value() const {
      return 1;
   }
};

int main(void) {
   derived example;
} 
```

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2009-01-30T17:41:02.937

因为`base`是先构建的，还没有“成熟”成一个`derived`。当它不能保证对象已经正确初始化时，它不能调用对象上的方法。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2009-01-30T17:43:23.057

在构造派生对象时，在调用派生类构造函数的主体之前，必须完成基类构造函数。在调用派生类构造函数之前，正在构造的对象的动态类型是基类实例而不是派生类实例。因此，当您从构造函数调用虚函数时，只能调用基类虚函数覆盖。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-31T08:07:10.630

实际上，有一种方法可以实现这种行为。“软件中的每个问题都可以通过一定程度的间接来解决。”

```
/* Disclaimer: I haven't done C++ in many months now, there might be a few syntax errors here and there. */
class parent
{
public:
     parent( ) { /* nothing interesting here. */ };
protected:
     struct parent_virtual
     {
         virtual void do_something( ) { cout << "in parent."; }
     };

     parent( const parent_virtual& obj )
     {
          obj.do_something( );
     }
};

class child : public parent
{
protected:
     struct child_virtual : public parent_virtual
     {
         void do_something( ) { cout << "in child."; }
     };
public:
      child( ) : parent( child_virtual( ) ) { }
}; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-01-26T21:14:39.247

它是如何工作**[的问题是一个常见问题解答项目](http://www.parashift.com/c++-faq/calling-virtuals-from-ctors.html)**。

总而言之，在`T`构造类时，动态类型是`T`，它可以防止对派生类函数实现的虚拟调用，如果允许，可以在相关类不变量建立之前执行代码（Java 和 C# 中的常见问题，但 C++ 是安全的在这方面）。

如何在基类构造函数中进行派生类特定初始化的问题也是**[一个常见问题解答项目](http://www.parashift.com/c++-faq/calling-virtuals-from-ctor-idiom.html)**，直接在前面提到的问题之后。

总而言之，使用静态或动态多态可以将相关的函数实现传递给基类构造函数（或类）。

One particular way to do that is to pass a **[“parts factory” object](http://alfps.wordpress.com/2010/05/12/how-to-avoid-post-construction-by-using-parts-factories/)** up, where this argument can be defaulted. For example, a general `Button` class might pass a button creation API function up to its `Widget` base class constructor, so that that constructor can create the correct API level object.

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-31T01:15:34.750

您不应该从构造函数中*多态*地调用虚方法。相反，您可以在构造对象后调用它们。

您的代码可以重写如下

```
struct base {
   virtual const int value() const {
      return 0;
   }
   base() {
      /* std::cout << value() << std::endl; */
   }
   virtual ~base() {}
};

struct derived : public base {
   virtual const int value() const {
      return 1;
   }
};

int main(void) {
   derived example;
   std::cout << example.value() << std::endl;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T17:40:01.487

一般规则是您不要从构造函数中调用虚函数。

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2011-03-28T17:10:17.647

在 C++ 中，您不能从构造函数调用虚拟/覆盖方法。

现在，您可以这样做是有充分理由的。作为“软件中的最佳实践”，您应该尽可能避免从构造函数调用其他方法，甚至是非虚拟方法。

但是，该规则总是有一个例外，因此您可能希望使用“伪构造函数方法”来模拟它们：

```
#include <iostream>

class base {
   // <constructor>
   base() {
      // do nothing in purpouse
   }
   // </constructor>

   // <destructor>
   ~base() {
      // do nothing in purpouse
   }
   // </destructor>

   // <fake-constructor>
   public virtual void create() {
      // move code from static constructor to fake constructor
      std::cout << value() << std::endl;
   }
   // </fake-constructor>

   // <fake-destructor>
   public virtual void destroy() {
      // move code from static destructor to fake destructor
      // ...
   }
   // </fake-destructor>

   public virtual const int value() const {
      return 0;
   }

   public virtual void DoSomething() {
      // std:cout << "Hello World";
   }
};

class derived : public base {
   // <fake-constructor>
   public override void create() {
      // move code from static constructor to fake constructor
      std::cout << "Im pretending to be a virtual constructor," << std::endl;
      std::cout << "and can call virtual methods" << std::endl;
   }
   // </fake-constructor>

   // <fake-destructor>
   public override void destroy() {
      // move code from static destructor to fake destructor
      std::cout << "Im pretending to be a virtual destructor," << std::endl;
      std::cout << "and can call virtual methods" << std::endl;
   }
   // </fake-destructor>

   public virtual const int value() const {
      return 1;
   }
};

int main(void) {
   // call fake virtual constructor in same line, after real constructor
   derived* example = new example(); example->create();

   // do several stuff with your objects
   example->doSomething();

   // call fake virtual destructor in same line, before real destructor
   example->destroy(); delete example();
} 
```

另外，我建议程序员仅将“struct”用于字段结构，将“class”用于具有字段、方法、构造函数等的结构...

# linq - 使用存储过程更新 LINQ to DATASET

> ID：496441
> 
> 赞同：0
> 
> 时间：2009-01-30T17:37:58.323
> 
> 标签：linq, dataset, linq-to-dataset

过去，我使用带有更新存储过程的 LINQ to SQL 来更新数据库。我想知道 LINQ to Dataset 中是否有类似的东西

LINQ to SQL 更新的示例：

```
Dim lqUpdate = lqUpdate.sprocUpdate(ColumnName, NewValue, ID) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T18:23:50.447

DataSet 是完全断开连接的实体，因此您找不到从 DataSet 或 DataTable 到存储过程的任何方法，但 Linq DataContext 的 ADO.Net 等效项是 TableAdapter，它确实支持存储过程。

# c - 如何在 C 中正确使用 extern 关键字

> ID：496448
> 
> 赞同：277
> 
> 时间：2009-01-30T17:40:38.333
> 
> 标签：c

我的问题是关于何时应该用`extern`C 中的关键字引用函数。

我看不到什么时候应该在实践中使用它。在我编写程序时，我使用的所有功能都可以通过我包含的头文件获得。`extern`那么，为什么访问头文件中未公开的内容会有用呢？

我可能正在考虑如何`extern`工作不正确，如果是这样，请纠正我。

`extern`另外..当它是头文件中没有关键字的默认声明时，您应该做些什么吗？

* * *

## 回答 #1

> 赞同：323
> 
> 时间：2009-01-30T17:49:12.687

`extern`改变联动。使用关键字，函数/变量被假定在其他地方可用，解析被推迟到链接器。

`extern`函数和变量之间存在差异。

对于**变量**，它不实例化变量本身，即不分配任何内存。这需要在其他地方完成。因此，如果您想从其他地方导入变量，这一点很重要。

对于**函数**，这只告诉编译器链接是外部的。由于这是默认设置（您使用关键字 `static`来指示函数未使用外部链接绑定），因此您无需显式使用它。

* * *

## 回答 #2

> 赞同：218
> 
> 时间：2009-01-31T18:54:01.570

`extern`告诉编译器该数据在某处定义并将与链接器连接。

在此处的回复和与几个朋友交谈的帮助下，这里是使用`extern`.

**示例 1 -**显示一个陷阱：

`stdio.h`：

```
int errno; 
```

`myCFile1.c`：

```
#include <stdio.h>

// Code using errno... 
```

`myCFile2.c`：

```
#include <stdio.h>

// Code using errno... 
```

如果`myCFile1.o`和`myCFile2.o`被链接，则每个 c 文件都有单独的`errno`. 这是一个问题，因为`errno`应该在所有链接文件中都可用。

**示例 2 -**修复。

`stdio.h`：

```
extern int errno; 
```

`stdio.c`：

```
int errno; 
```

`myCFile1.c`：

```
#include <stdio.h>

// Code using errno... 
```

`myCFile2.c`：

```
#include <stdio.h>

// Code using errno... 
```

现在，如果两者`myCFile1.o`和`MyCFile2.o`都由链接器链接，它们都将指向同一个`errno`。因此，使用`extern`.

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2009-01-31T01:48:33.763

已经说过`extern`关键字对于函数是多余的。

对于跨编译单元共享的变量，您应该在头文件中使用 extern 关键字声明它们，然后在单个源文件中定义它们，而不使用 extern 关键字。为了最佳实践，单一源文件应该是共享头文件名称的文件。

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2016-12-17T04:45:36.573

许多年后，我发现了这个问题。在阅读了每一个答案和评论后，我想我可以澄清一些细节......这对于通过谷歌搜索到达这里的人来说可能很有用。

问题是专门关于使用`extern`函数的，所以我将忽略使用`extern`全局变量。

让我们定义 3 个函数原型：

```
// --------------------------------------
// Filename: "my_project.H"
extern int function_1(void);
static int function_2(void);
       int function_3(void); 
```

主要源代码可以使用的头文件如下：

```
// --------------------------------------
// Filename: "my_project.C"
#include "my_project.H"

void main(void) {
    int v1 = function_1();
    int v2 = function_2();
    int v3 = function_3();
}

int function_2(void) return 1234; 
```

为了编译和链接，我们必须`function_2`在调用该函数的同一源代码文件中定义。其他两个函数可以在不同的源代码中定义，`*.C`也可以位于我们可能没有源代码的任何二进制文件（ `*.OBJ`, `*.LIB`, ）中。`*.DLL`

让我们再次将标题包含`my_project.H`在不同的`*.C`文件中，以更好地理解差异。在同一个项目中，我们添加以下文件：

```
// --------------------------------------
// Filename: "my_big_project_splitted.C"
#include "my_project.H"

void old_main_test(void){
    int v1 = function_1();
    int v2 = function_2();
    int v3 = function_3();
}

int function_2(void) return 5678;

int function_1(void) return 12;

int function_3(void) return 34; 
```

需要注意的重要功能：

*   当函数`static`在头文件中定义时，编译器/链接器必须在使用该包含文件的每个模块中找到具有该名称的函数的实例。

*   通过仅在该模块中重新定义原型，可以仅在一个模块中替换作为 C 库一部分的函数`static`。例如，替换任何调用`malloc`并`free`添加内存泄漏检测功能。

*   `extern`函数实际上并不需要说明符。如果`static`未找到，则始终假定函数为`extern`。

*   但是，`extern`这不是变量的默认值。通常，任何定义变量以在多个模块中可见的头文件都需要使用`extern`. 唯一的例外是如果一个头文件被保证包含在一个且只有一个模块中。

    然后，许多项目经理会要求将此类变量放在模块的开头，而不是放在任何头文件中。一些大型项目，例如视频游戏模拟器“Mame”甚至要求这些变量只出现在使用它们的第一个函数之上。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2009-01-30T20:03:42.163

在 C 中，`extern`对于函数原型是隐含的，因为原型声明了在其他地方定义的函数。也就是说，一个函数原型默认是有外部链接的；使用`extern`很好，但是是多余的。

（如果需要静态链接，该函数必须`static`在其原型和函数头中声明，并且这些通常都应该在同一个 .c 文件中）。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2014-01-16T12:59:42.713

我关于`extern`关键字的一篇非常好的文章以及示例：[http ://www.geeksforgeeks.org/understanding-extern-keyword-in-c/](http://www.geeksforgeeks.org/understanding-extern-keyword-in-c/)

虽然我不同意`extern`在函数声明中使用是多余的。这应该是编译器设置。所以我建议`extern`在需要时在函数声明中使用。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-30T17:47:58.833

如果您的程序中的每个文件都首先编译为一个目标文件，然后将目标文件链接在一起，您需要`extern`. 它告诉编译器“这个函数存在，但它的代码在别的地方。不要惊慌。”

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-30T19:22:51.497

头文件中函数和变量的所有声明都应该是`extern`.

此规则的例外是在标题中定义的内联函数和变量 - 尽管在标题中定义 - 必须是翻译单元的本地（包含标题的源文件）：这些应该是`static`.

在源文件中，`extern`不应用于文件中定义的函数和变量。只需为本地定义添加前缀`static`，对共享定义不做任何事情 - 默认情况下它们将是外部符号。

在源文件中使用的唯一原因`extern`是声明在其他源文件中定义且没有提供头文件的函数和变量。

* * *

声明函数原型`extern`实际上是不必要的。有些人不喜欢它，因为它只会浪费空间，而且函数声明已经有溢出行限制的趋势。其他人喜欢它，因为这样，函数和变量可以以相同的方式处理。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-30T17:52:02.493

其他源文件中实际*定义*的函数只能在头文件中*声明*。在这种情况下，您应该在标头中*声明*原型时使用*extern 。*

 *大多数时候，您的功能将是以下之一（更像是最佳实践）：

*   静态（在该 .c 文件之外不可见的普通函数）
*   静态内联（来自 .c 或 .h 文件的内联）
*   extern （在下一种标题中的声明（见下文））
*   [没有任何关键字]（普通函数意味着使用 extern 声明访问）

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-01-30T17:43:05.460

当您在不同的 dll 或 lib 上定义该函数时，编译器会根据链接器来查找它。典型情况是当您从 OS API 调用函数时。

# xml - XML 排序

> ID：496456
> 
> 赞同：1
> 
> 时间：2009-01-30T17:42:28.080
> 
> 标签：xml, sorting

我有以下 XML

```
<fields>
  <field position="4" tablename="Students" headername="First Name" fieldreference="FirstName" orderbydirection="ASC" />
  <field position="2" tablename="Students" headername="Last Name" fieldreference="LastName" orderbydirection="ASC" />
  <field position="3" tablename="Students" headername="Race" fieldreference="Race" orderbydirection="ASC" />
  <field position="1" tablename="Students" headername="Sex" fieldreference="Sex" orderbydirection="ASC" />
  <field position="5" tablename="Students" headername="State" fieldreference="State" orderbydirection="ASC" />
</fields> 
```

我想根据“位置”对其进行排序

怎么做到呢？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T00:57:51.697

**这个 XSLT 1.0 转换**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:strip-space elements="*"/>

    <xsl:template match="node()|@*">
      <xsl:copy>
        <xsl:apply-templates select="node()|@*"/>
      </xsl:copy>
    </xsl:template>

    <xsl:template match="fields">
      <xsl:copy>
        <xsl:apply-templates select="@*"/>
        <xsl:apply-templates>
          <xsl:sort select="@position" data-type="number"/>
        </xsl:apply-templates>
      </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<fields>
    <field position="4" tablename="Students" headername="First Name" fieldreference="FirstName" orderbydirection="ASC" />
    <field position="2" tablename="Students" headername="Last Name" fieldreference="LastName" orderbydirection="ASC" />
    <field position="3" tablename="Students" headername="Race" fieldreference="Race" orderbydirection="ASC" />
    <field position="1" tablename="Students" headername="Sex" fieldreference="Sex" orderbydirection="ASC" />
    <field position="5" tablename="Students" headername="State" fieldreference="State" orderbydirection="ASC" />
</fields> 
```

**产生想要的结果**：

```
<fields>
  <field position="1" tablename="Students" headername="Sex" fieldreference="Sex" orderbydirection="ASC" />
  <field position="2" tablename="Students" headername="Last Name" fieldreference="LastName" orderbydirection="ASC" />
  <field position="3" tablename="Students" headername="Race" fieldreference="Race" orderbydirection="ASC" />
  <field position="4" tablename="Students" headername="First Name" fieldreference="FirstName" orderbydirection="ASC" />
  <field position="5" tablename="Students" headername="State" fieldreference="State" orderbydirection="ASC" />
</fields> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T18:04:57.630

请参阅使用 XSLT 排序[http://www.xml.com/pub/a/2002/07/03/transform.html](http://www.xml.com/pub/a/2002/07/03/transform.html)

# wpf - 这个 ContentTemplate 有什么问题？

> ID：496466
> 
> 赞同：2
> 
> 时间：2009-01-30T17:45:16.047
> 
> 标签：wpf, templates, xaml, datatemplate

我在样式中收到此内容模板的错误：“必须为 Setter 指定属性和值。” 我不这样做吗？

```
<Style x:Key="LinkButton" TargetType="Button">
<Setter Property="Template">
    <Setter.Value>
        <ControlTemplate TargetType="Button">
            <ContentPresenter/>
        </ControlTemplate>
    </Setter.Value>
</Setter>
<Setter Property="ContentTemplate">
    <Setter.Value>
        <DataTemplate>
            <Label x:Name="ContentRoot">
                <StackPanel Orientation="Horizontal">
                    <Viewbox Width="24" Height="24" VerticalAlignment="Center">
                        <Image x:Name="ButtonImage" Source="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Button}}, Path=Tag}" />
                    </Viewbox>
                    <TextBlock VerticalAlignment="Center" x:Name="ButtonText" Text="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Button}}, Path=Content}"></TextBlock>
                </StackPanel>
            </Label>
            <DataTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="ButtonText" Property="TextBlock.TextDecorations" Value="Underline"/>
                </Trigger>
            </DataTemplate.Triggers>
        </DataTemplate>
    </Setter.Value>
</Setter> 
```

这是一个将使用此样式的按钮：

```
<Button Name="HelpButton" Style="{StaticResource LinkButton}" Height="30" Content="Help" Tag="Help.png"/> 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-01-30T18:14:41.137

我已经加载了这个并且没有这样的问题。我看到的唯一问题是您的按钮永远不会应用样式。这是因为如果要应用样式，则需要从样式中删除 x:Key。否则，如果您希望仅将样式应用于 HelpButton，则定义应如下所示：

```
<Button Name="HelpButton" Style="{StaticResource LinkButton}" Height="30" Content="Help" Tag="Help.png"/> 
```

但我看不到您看到的错误。

# f# - 使用异步工作流进行并行化的最佳实践

> ID：496468
> 
> 赞同：8
> 
> 时间：2009-01-30T17:45:39.777
> 
> 标签：f#, asynchronous, async-workflow

假设我想抓取一个网页，并提取一些数据。我很可能会写这样的东西：

```
let getAllHyperlinks(url:string) =
    async {  let req = WebRequest.Create(url)
             let! rsp = req.GetResponseAsync()
             use stream = rsp.GetResponseStream()             // depends on rsp
             use reader = new System.IO.StreamReader(stream)  // depends on stream
             let! data = reader.AsyncReadToEnd()              // depends on reader
             return extractAllUrls(data) }                    // depends on data 
```

告诉 F#在`let!`另一个线程中执行代码，然后将结果绑定到一个变量，然后继续处理。上面的示例使用了两个 let 语句：一个用于获取响应，一个用于读取所有数据，因此它至少会产生两个线程（如果我错了，请纠正我）。

尽管上面的工作流产生了几个线程，但执行顺序是连续的，因为工作流中的每个项目都依赖于前一个项目。在其他线程返回之前，实际上不可能进一步评估工作流程中的任何项目。

**`let!`在上面的代码中拥有多个有什么好处吗？**

**如果不是，如何更改此代码以利用多个`let!`语句？**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-01-30T17:50:52.947

关键是我们*没有*产生任何新线程。在整个工作流过程中，有 1 个或 0 个活动线程从 ThreadPool 中被消耗。（一个例外，直到第一个'！'，代码在执行 Async.Run 的用户线程上运行。）“让！” 在 Async 操作在海上时释放一个线程，然后在操作返回时从 ThreadPool 中拾取一个线程。（性能）优势是对 ThreadPool 的压力较小（当然，主要的用户优势是简单的编程模型 - 比您编写的所有 BeginFoo/EndFoo/callback 内容好一百万倍）。

另请参阅[http://cs.hubfs.net/forums/thread/8262.aspx](http://cs.hubfs.net/forums/thread/8262.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T17:54:31.660

我正在写一个答案，但布赖恩打败了我。我完全同意他的看法。

我想补充一点，如果您想并行化同步代码，正确的工具是 PLINQ，而不是异步工作流，正如[Don Syme 解释](http://blogs.msdn.com/dsyme/archive/2007/10/11/introducing-f-asynchronous-workflows.aspx)的那样。

# .net - 如何使用 .net 配置文件配置多个模块

> ID：496469
> 
> 赞同：0
> 
> 时间：2009-01-30T17:46:21.210
> 
> 标签：.net, configuration

我从我的主应用程序中引用了一些 .net 模块/库。每个模块/库都可以配置，在我构建它们之后，它们每个都有一个配置文件，例如 MyModule1.dll.config、MyModule2.dll.config。

当我构建我的主应用程序时，一个 app.config 文件被输出到输出目录。

我想知道如何配置 MyModule1、MyModule2 等。我应该在 app.config 文件中包含每个模块的配置部分，还是应该为每个模块有一个单独的配置文件，为每个模块加载一个配置文件？每个模块的单独配置如下所述：http: [//social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/2710647c-6414-42c4-90b7-fd7603f55ae0/](http://social.msdn.microsoft.com/Forums/en-US/netfxbcl/thread/2710647c-6414-42c4-90b7-fd7603f55ae0/)？这意味着我也会将 MyModule1.dll.config 和 MyModule2.dll.config 复制到输出目录。

谁能给我一些建议，告诉我什么是最佳实践/正确的方法？

编辑：

从 MyModule1.dll 我可以使用显式加载 MyModule1.dll.config

```
Uri p = new Uri(System.Reflection.Assembly.GetExecutingAssembly().CodeBase);
Configuration config = ConfigurationManager.OpenExeConfiguration(p.LocalPath); 
```

但是如果 MyModule1.dll 引用并使用我的一个公共库 MyCommonLib.dll 我如何才能从同一个配置文件 MyModule1.dll.config 配置 MyCommonLib.dll？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T05:58:16.487

在不确切知道您拥有什么配置的情况下，我会说您应该将配置文件合并到主 exe 配置中。这样您就不需要任何额外的代码来使事情正常进行。这是大多数 .NET 应用程序的工作方式，也是大多数人所期望的。（查看 web.config ——来自各地的部分最终都在那里。）

如果您在 Visual Studio 提供的属性中使用强类型设置，这将正常工作。您只需合并 configSections 并将每个配置文件中的特定部分复制到主要部分。我们已经这样做了一段时间，而且效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T19:58:36.323

如果您在 Visual Studio 中使用*Properties*文件夹系统，并希望 Visual Studio 自动同步它们，您将需要使用您为提高生产力而描述的 config-per-module 方法。

或者，如果您只是处理或条目，则从一个配置文件可能会更容易。我在这里唯一的建议是，对于其他正在/将要从事该项目的人来说，采用最简单、最自然的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-06T06:47:39.927

您是否考虑过使用[Spring.NET](http://springframework.net/)来管理您的配置？当然，您也可以获得大量其他功能，但配置是从 Spring 开始的好地方。

您可以将一些配置放在每个库的本地文件中，然后在主应用程序的配置文件中引用这些文件。使用您的库的人可以决定是否要引用您的配置文件、编写自己的配置文件或介于两者之间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T06:25:49.867

如果您不必管理太多配置信息，我建议您使用 exe.config。

或者您可以考虑使用 Microsoft Enterprise Library 或 Spring.net 中包含的配置管理框架

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-09T06:35:10.577

这完全取决于您的库与您的应用程序的分离程度。

如果您将相同的库部署到多个应用程序，最好将配置分开。

如果只是一个应用程序，请使用一个配置文件。然后您的所有配置都在一个地方。

# asp.net - 使用 ASP.Net MVC 对网格进行分页和排序

> ID：496470
> 
> 赞同：53
> 
> 时间：2009-01-30T17:46:37.200
> 
> 标签：asp.net, asp.net-mvc, gridview, objectdatasource

我是 MVC 的新手，并没有遵循您如何在网格上进行分页和排序。我习惯于将 asp.Net GridView 控件与指向我们业务层中对象的 ObjectDataSource 一起使用——在这种情况下，ODS 使用我们的 ORM 在对象上生成的方法处理所有分页和排序。

我已经研究过将相同的 ORM 与 MVC 一起使用 - 那里的情况很好 - 我只是循环遍历集合以在页面上构建表格 - 但没有 ODS 来处理分页和排序，我很困惑我将如何处理。我会有一个单独的控制器来进行分页和排序吗？

我知道我需要自己动手——但我从哪里开始呢？我创建了一个 CustomerController，以及一个显示如下所示客户表的视图 - 我想对 FirstName 或 LastName 列进行排序。我的模型上有一个 Sort() 方法，它将采用 GridView/ODS 对使用的格式的字符串排序表达式。我会在我的 CustomerController 上创建一个名为 Sort 的新动作，并在我的标题中放置一个 ActionLink 吗？

```
 <table>
    <tr>
        <th>
            First Name
        </th>
        <th>
            Last Name
        </th>
    </tr>
    <% foreach (var item in Model)
       { %>
    <tr>
        <td>
            <%= Html.Encode(item.FirstName) %>
        </td>
        <td>
            <%= Html.Encode(item.LastName) %>
        </td>
    </tr>
    <% } %>
</table> 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2011-03-18T09:02:36.113

现在 MVC 3 现在有一个开箱即用的 webGrid。我知道这个问题是不久前提出的，但是在寻找有关 webGrid 的内容时，我最终想到了它。所以我认为它应该有一个提到新 webGrid 的答案。

这里有一些关于如何使用它的好帖子：

[http://www.dotnetcurry.com/ShowArticle.aspx?ID=615](http://www.dotnetcurry.com/ShowArticle.aspx?ID=615)

[http://cnug.co.in/blogs/shijuv/archive/2010/10/08/using-the-webgrid-helper-in-asp-net-mvc-3-beta.aspx](http://cnug.co.in/blogs/shijuv/archive/2010/10/08/using-the-webgrid-helper-in-asp-net-mvc-3-beta.aspx)

[http://www.nickharris.net/tag/webgrid/](http://www.nickharris.net/tag/webgrid/)

它支持排序、分页和一些 Ajax 的东西。它已经可以为您做很多事情，但您也可以单独指定每个单独的列。

**更新：**
还有许多可用的 JavaScript 库可以为您完成表格。我个人喜欢使用[DataTables](http://www.datatables.net/)。您可以为它提供一个在服务器上生成的现有 html 表，或者给它一个端点，它可以检索数据（全部或仅一页）。

还有更多，只是谷歌。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2009-01-30T22:43:23.980

您可以使用相同的控制器，只需添加一个附加参数并将其命名为排序。然后在控制器中检查 sort 的值，并根据该参数对数据进行排序。

或者如果你想在客户端做事，你可以使用类似[tablesorter](http://tablesorter.com/docs/)的东西，一个 jquery 的插件。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-30T17:58:33.073

使用 MVC，您必须自己进行排序、分页等。我建议您使用[YUI DataTable](http://developer.yahoo.com/yui/datatable/)或其他一些 JavaScript 网格。

此外，如果您发现自己在做繁重的数据网格工作，您可能想看看 ASP.NET 动态数据，它是专门为这些类型的 ORM 交互而设计的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T21:55:23.173

首先使用[jQuery](http://jquery.com/)。jQuery 是你的朋友。[然后为 jQuery jqGrid](http://www.secondpersonplural.ca/jqgriddocs/index.htm)使用这个很棒而且可能是最好的 Grid 控件。

在您的 CustomerController 中创建一个名为 CustomerData 的操作。所有与 Grid 的交互都应该指向这个动作。

去[这里](http://trirand.com/jqgrid/jqgrid.html)查看有关如何使用 jqGrid 的大量示例。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-02-23T11:59:37.100

我们一直在使用来自[JqWidgets](http://www.jqwidgets.com/)的客户端控件 JqxGrid，并且对它与大量记录相关的性能以及内置的分页、过滤、排序非常满意。[这](http://www.jqwidgets.com/jquery-widgets-documentation/documentation/asp.net-integration/asp.net-binding-to-sql-database-mvc4.htm)是在 ASP.Net MVC 中绑定它的示例

# c# - 为什么 StringBuilder 类不是继承自 Stream？

> ID：496472
> 
> 赞同：4
> 
> 时间：2009-01-30T17:46:59.023
> 
> 标签：c#, stream, stringbuilder

我只是对此感到好奇。令我震惊的是，StringBuilder 的行为在功能上（如果不是技术上）与 Stream 相同——它是一个可以添加其他数据的数据箱。

再次，只是好奇。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-30T17:51:15.583

`StringBuilder`不仅仅是附加功能。它还具有插入功能，这对于流来说是不自然的。如果`StringWriter`您想要一个包含`StringBuilder`.

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-30T18:31:18.170

Stream 是*二进制*数据的输入和输出。

StringBuilder 是构建*文本*数据的方法。

除此之外，还有状态问题 - StringBuilder 只有当前值，不知道“位置”。它允许您在其中的任何位置访问和更改数据。另一方面，流在逻辑上是一个潜在的无限数据流，在中间的某个地方有一个光标来说明你要去哪里。您通常只是向前读/写，使用 Seek/Position 跳到数据流的特定部分。

试着想象一下用 StringBuilder 实现 Stream API ......它只是不适合。你可以*这样*做，但基本上你会得到 StringReader 和 StringWriter。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-01-30T17:50:15.647

流通常是指外部输入/输出源（文件、网络）。StringBuilder 没有这样的特点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-30T17:50:16.443

因为它不是真正的流。它更像是一个增长的缓冲区。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T17:50:16.817

虽然两者都可以添加数据，但整体功能不同。

Stream 用于从/向某个源输入或输出数据，而不是用于构建某些东西。StringBuilder 不需要 Stream 提供的功能，如缓冲等来构建资源。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-30T18:47:16.920

另一方面，您会在 System.IO 中找到**StringReader** / **Writer类。****StringWriter**例如针对底层**StringBuilder实现****TextWriter**。

 **就我个人而言，我从未使用过它，但如果你有一个文本文件写入例程，你可以让它对**TextWriter**起作用。然后在您的测试中，不是实例化**StreamWriter** ，而是实例化**StringWriter**，然后您可以通过查看底层**StringBuilder**来检查写入的内容。

现在我头晕...

# c++ - 为什么g++ 4.0版本的map ::擦除（地图:: iterator) 不返回迭代器？

> ID：496473
> 
> 赞同：3
> 
> 时间：2009-01-30T17:47:17.183
> 
> 标签：c++, gcc, stl

我正在将一个中型 C++ 项目从 Visual Studio 2005 移植到 MacOS、XCode / GCC 4.0。

我刚刚偶然发现的差异之一与从地图中删除元素有关。在 Visual Studio 中，我可以擦除由迭代器指定的元素并将返回值分配给迭代器以获取下一个元素的位置。这样迭代器在擦除后不会指向某个无效地址。

换句话说，在 Visual Studio 中我可以这样做：

itor=m_ResourceMap.erase(itor);

在 GCC 4.0 中，擦除函数返回 void，所以我不能这样做。这是否意味着以下地图元素向后移动，因此迭代器自动指向下一个元素，或者这是否意味着我必须在之后增加迭代器？[在线 STL 文档](http://www.sgi.com/tech/stl/Map.html)在该 主题上不是很简洁，XCode 似乎也没有。

谢谢你的帮助，

阿德里安

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-30T17:53:41.443

不，您必须在擦除之前增加迭代器。像这样

```
m_ResourceMap.erase(itor++); 
```

迭代器因擦除而无效，因此您不能在之后增加它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T18:05:08.160

从外观上看，gcc 遵循 STL 标准，所以我想您将不得不更改您的代码。

```
void erase(iterator pos)     Associative Container  Erases the element pointed to by pos. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T20:12:36.017

我相信，erase() 的 C++ 标准库实现的 DinkumWare 实现被定义为在要删除的元素之后返回迭代器。这也让我感到难过，当我向 DinkumWare 询问这件事时，他们说这是一个“符合标准的扩展”。

有一些 STL 容器（例如向量），当您执行插入或擦除操作时，可能会使该容器的所有迭代器失效。我不记得地图是否是其中之一，但如果是，则您在循环中擦除地图元素的方法存在潜在的潜在漏洞。

# ms-access - Access DB 查询 - 需要帮助更新某些记录

> ID：496483
> 
> 赞同：2
> 
> 时间：2009-01-30T17:50:40.000
> 
> 标签：ms-access, sql-update

我有一个用于跟踪票证的访问数据库。由于与该票证相关的不同编程更改，每张票证可能有多次出现。每条记录还有一个 program_type 字段，即 SVR 或 VB。例子：

```
123456 - SVR - SomeCode

123456 - VB - SomeVBCode 
```

我在数据库中添加了一个名为 VB_Flag 的列，默认为 0，我想为每张包含 VB 代码的票将其更改为数字 1。所以，这里的结果是：

```
123456 - SVR - SomeCode - 1

123456 - VB - SomeVBCode - 1 
```

但是，我一生都无法弄清楚如何编写此更新查询。起初我试过：

```
UPDATE table SET VB_Flag = 1 WHERE program_type = 'VB' 
```

但这显然遗漏了所有与 VB 代码共享票号的 SVR 代码。

我不知所措。帮助？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T18:08:04.520

你可以这样做：

```
UPDATE tickets SET VB_Flag = 1
WHERE ticket_id IN (SELECT ticket_id FROM tickets WHERE program_type = 'VB'); 
```

内部 SELECT 语句返回具有 program_type 为“VB”的所有票证 ID 的列表。

然后，更新将 VB_Flag 设置为 1，用于具有这些票证 ID 之一的所有记录（包括那些 program_type 为“SVR”的记录）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T18:05:44.603

这应该有效：

```
UPDATE table SET VB_Flag = 1 
WHERE TicketNum IN (SELECT TicketNum FROM Table WHERE program_type = 'VB') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T18:07:46.330

UPDATE Table INNER JOIN Table AS Table2 ON Table.TicketNumber = Table2.TicketNumber SET Table2.VB_Flag = 1 WHERE (([Table].[program_type]="VB"))

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T18:06:43.540

一个简单的嵌套选择应该可以解决您的问题：

```
UPDATE myTable
SET VB_Flag = 1 
WHERE TicketID in (Select TicketID from myTable WHERE program_type = 'VB') 
```

# c++ - 不释放内存是否可以接受

> ID：496487
> 
> 赞同：15
> 
> 时间：2009-01-30T17:51:33.913
> 
> 标签：c++, c, oop, memory-management, memory-leaks

我正在开发一个应该从命令行使用以下语法的项目：

```
program-name input-file 
```

该程序应该处理输入，计算一些东西并在标准输出上吐出结果。

我选择的语言是 C++ 有几个我不愿意争论的原因。计算阶段将是高度符号化的（想想编译器），并将使用非常复杂的动态分配数据结构。特别是，它不适合 RAII 风格的编程。

我想知道是否可以忘记释放内存，因为我希望整个计算消耗的内存少于可用内存，并且操作系统可以在程序完成后一步回收所有内存（假设程序终止片刻之间）。你对此有何感想？

作为备用计划，如果我的项目需要作为服务器或交互方式运行，我认为我总是可以将垃圾收集器重新安装到源代码中。有没有人有使用 C++ 垃圾收集器的经验？他们运作良好吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-01-30T17:56:41.343

在描述问题的特定情况下，它不应该引起任何问题。

但是，这并不完全正常。静态分析工具会抱怨它。最重要的是，它会养成坏习惯。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-02-02T06:58:25.227

有时不释放内存是正确的做法。

我曾经写过编译器。在构建解析树并遍历它以编写中间代码之后，我们只需退出。释放树会有

*   给编译器增加了一点速度，我们当然希望它尽可能快。
*   占用代码空间
*   花时间编码和测试释放器
*   违反了“没有代码比‘没有代码’执行得更好”的格言。

！FWIW，这是“回到过去”的时候，内存是非虚拟的和最小的，盒子要慢得多，前两个是不重要的考虑因素。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2009-01-30T18:12:56.773

我的感觉会像“WTF !!!”

这样看：

*   你选择了一种不包含垃圾收集器的编程语言，我们不能问为什么。

*   您基本上是在说您懒得关心释放内存。

好吧，又是WTF。懒惰不是任何事情的好理由，最起码是在玩弄内存而不释放它。

只是释放内存，这是一个不好的做法，场景可能会改变，然后可能有一百万个你需要释放内存的原因，而不这样做的唯一原因是懒惰，不要养成坏习惯，习惯这样做事情是对的，那样你将来会倾向于做对的！

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2009-01-30T17:53:10.913

不释放内存应该不是问题，但这是一种不好的做法。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2009-01-30T18:02:55.153

Joel Coehoorn 是对的：

> 它不应该引起任何问题。
> 
> 但是，这并不完全正常。静态分析工具会抱怨它。最重要的是，它会养成坏习惯。

我还想补充一点，在编写代码时考虑解除分配可能比事后对其进行改造*要*容易得多。所以我可能会让它释放内存；您不知道将来如何使用您的程序。

如果您想要一种非常简单的方法来释放内存，请查看[Apache 使用的“池”概念](http://apr.apache.org/docs/apr/0.9/group__apr__pools.html)。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2009-01-30T18:18:26.073

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-30T18:20:00.017

引用计数智能指针（如 boost 和 TR1 中的 shared_ptr ）也可以帮助您以简单的方式管理内存。

缺点是您必须包装使用这些对象的每个指针。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-30T18:59:40.517

我以前做过这个，只是发现，很久以后，我需要程序能够在没有单独命令的情况下处理多个输入，或者程序的内容非常有用，需要将它们变成一个库例程可以从另一个预计不会终止的程序中多次调用它。与从一开始就使其无泄漏相比，稍后再返回并重新设计程序要困难得多。

因此，尽管正如您所描述的要求，它在技术上是安全的，但我建议您不要采用这种做法，因为您的要求有一天可能会发生变化。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-30T18:14:50.183

> 将使用相当复杂的动态分配数据结构。特别是，它不适合 RAII 风格的编程。

我几乎可以肯定这是懒惰编程的借口。为什么不能使用 RAII？是因为您不想跟踪您的分配，没有指向您保留的指针吗？如果是这样，您希望如何使用分配的内存 - 总是有一个指向它的指针，其中包含一些数据。

是不是因为不知道什么时候发布？将内存留在 RAII 对象中，每个对象都被某些东西引用，当包含的对象被释放时，它们都会相互释放——如果你想有一天将它作为服务器运行，这一点尤其重要，每次迭代服务器有效地运行一个包含所有其他对象的“主”对象，因此您可以删除它并且所有内存都消失了。它还有助于防止您改装 GC。

是不是因为你所有的内存都被分配并一直在使用，最后才被释放？如果是这样，请参见上文。

如果你真的真的想不出一个不能泄漏内存的设计，至少有礼貌地使用私有堆。在你退出之前摧毁那个堆，你就会有一个更好的设计，如果有点“hacky”的话。

在某些情况下，内存泄漏是可以的——静态变量、全局初始化数据等。不过，这些通常并不大。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-02-02T05:56:01.173

如果您的程序的运行时间很短，那应该不是问题。然而，懒得释放你分配**的东西和忘记你分配**的东西是两件完全不同的事情。如果您只是迷失了方向，那么是时候问问自己是否真的知道您的代码对计算机做了什么。

如果您只是匆忙或懒惰，并且程序的生命周期相对于它实际分配的内容来说很小（即，如果运行 30 秒，每秒分配 10 MB 的空间并不小）.. 那么您应该没问题。

关于在程序退出时释放分配的内存集的唯一“高尚”论点..应该释放所有东西以防止 valgrind 抱怨泄漏，还是让操作系统来做？这完全取决于操作系统以及您的代码是否可能成为库而不是短期运行的可执行文件。

运行时的泄漏通常很糟糕，除非您**知道**您的程序将在很短的时间内运行并且不会导致其他程序比您的程序更重要，就操作系统而言，它会滑到脏分页。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-01-30T17:58:01.373

> 你对此有何感想？

某些 O/Ses 可能不会回收内存，但我猜您并不打算在这些 O/Ses 上运行。

> 作为备用计划，如果我的项目需要作为服务器或交互方式运行，我认为我总是可以将垃圾收集器重新安装到源代码中。

相反，我认为您可以生成一个子进程来完成脏活，从子进程中获取输出，然后让子进程尽快死亡，然后期望 O/S 进行垃圾收集。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-30T18:00:10.183

我没有亲自使用过，但由于您是从头开始，您可能希望考虑使用[Boehm-Demers-Weiser 保守垃圾收集器](http://www.hpl.hp.com/personal/Hans_Boehm/gc/)

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2009-01-30T18:22:22.527

答案实际上取决于您的程序有多大以及它需要展示哪些性能特征。如果您从不释放内存，您的进程的内存占用量将比其他方式大得多。取决于系统，这可能会导致大量分页并降低您或系统上其他应用程序的性能。

除此之外，上面每个人所说的都是正确的。它可能不会在短期内造成伤害，但您应该避免这是一种不好的做法。您将永远无法再次使用该代码。之后尝试改造 GC 将是一场噩梦。想想去你分配内存的每个地方并尝试对其进行改造，但不要破坏任何东西。

避免这样做的另一个原因是：声誉。如果你未能解除分配，维护代码的每个人都会诅咒你的名字，你在公司的代表会受到打击。“你能相信他有多笨吗？看看这个代码。”

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-02-02T06:07:02.210

如果确定在哪里释放内存对您来说并非易事，我会担心数据结构操作的其他方面也可能无法完全理解。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2009-01-30T18:24:08.590

总的来说，我同意这是一种不好的做法。

对于一个单一的程序，它可以是好的，但它有点像你不知道你在做什么。

不过，您的问题有一个解决方案 - 使用自定义分配器，它从 malloc 预分配较大的块，然后在计算阶段之后，而不是从自定义分配器中释放所有小块，只需释放较大的预分配内存块。然后，您不需要跟踪需要解除分配的所有对象以及何时解除分配。许多年前，一位编写编译器的人也向我解释了这种方法，所以如果它对他有用，那么它可能也对你有用。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2009-01-30T18:10:15.467

除了操作系统（内核和/或 C/C++ 库）可以选择在执行结束时不释放内存这一事实之外，您的应用程序应始终提供适当释放已分配内存的良好做法。为什么？假设您决定扩展该应用程序或重用代码；如果您之前编写的代码在完成其工作后不必要地占用了内存，那么您很快就会遇到麻烦。这是内存泄漏的秘诀。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2009-01-30T20:13:30.210

尝试在方法中使用自动变量，以便它们会自动从堆栈中释放。

不释放堆内存的唯一有用原因是节省 free() 方法中使用的少量计算能力。如果由于需要大量虚拟内存和少量物理内存资源而导致页面错误成为问题，您可能会失去任何优势。需要考虑的一些因素是：

如果您要分配一些巨大的内存块或许多小块。

内存是否需要锁定到物理内存中。

您是否绝对肯定所需的代码和内存将适合 Win32 系统的 2GB，包括内存孔和填充。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2009-02-02T05:48:34.573

这通常是个坏主意。您可能会遇到一些情况，即程序会尝试消耗比可用内存更多的内存。另外，您可能无法启动该程序的多个副本。

如果您不关心上述问题，您仍然可以这样做。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-11-21T06:25:10.197

当您退出程序时，分配的内存将分配`automatically returned`给系统。所以你可能不会释放你分配的内存。

但是，当您使用更大的程序时，释放分配就变得很有必要了，例如一个`OS`或`Embedded systems`该程序打算用于的地方`run forever`，因此小的内存泄漏可能是恶意的。

因此，它始终`recommended to deallocate`是您分配的内存。

# c# - XmlSerialization 集合作为数组

> ID：496488
> 
> 赞同：5
> 
> 时间：2009-01-30T17:51:55.863
> 
> 标签：c#, .net, xml-serialization

我正在尝试序列化需要使用多个同名元素的自定义类。
我尝试过使用 xmlarray，但它将它们包装在另一个元素中。

我希望我的 xml 看起来像这样。

```
<root>
     <trees>some text</trees>
     <trees>some more text</trees>
</root> 
```

我的代码：

```
[Serializable(), XmlRoot("root")]
public class test
{
      [XmlArray("trees")]
      public ArrayList MyProp1 = new ArrayList();

      public test()
      {
           MyProp1.Add("some text");
           MyProp1.Add("some more text");  
      }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-31T23:09:04.553

尝试使用`[XmlElement("trees")]`：

```
[Serializable(), XmlRoot("root")]
public class test
{
    [XmlElement("trees")]
    public List<string> MyProp1 = new List<string>();

    public test()
    {
        MyProp1.Add("some text");
        MyProp1.Add("some more text");
    }
} 
```

注意我改为`ArrayList`清理`List<string>`输出；在 1.1 中，`StringCollection`将是另一种选择，尽管它有不同的区分大小写规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-31T11:03:07.403

（编辑：已过时-我的[第二篇文章](https://stackoverflow.com/questions/496488/xmlserialization-collection-as-array/499768#499768)（`[XmlElement]`）是要走的路-我将把它留给后代使用`xsd.exe`）

`xsd.exe`是你的朋友。将所需的 xml 复制到文件 ( `foo.xml`) 中，然后使用：

```
xsd foo.xml
xsd foo.xsd /classes 
```

现在阅读`foo.cs`；你可以直接使用它，也可以仅仅为了灵感。

（编辑：输出被剪断 - 不再有帮助）

# sql - 标准化要走多远？

> ID：496508
> 
> 赞同：21
> 
> 时间：2009-01-30T17:59:05.083
> 
> 标签：sql, database-design, database-normalization

我有这些表：

```
Projects(projectID, CreatedByID)
Employees(empID,depID)
Departments(depID,OfficeID)
Offices(officeID) 
```

`CreatedByID`是 的外[键](http://en.wikipedia.org/wiki/Foreign_key)。`Employees`我有一个几乎在每次页面加载时都会运行的查询。

`OfficeID`只添加一个冗余列`Projects`来消除三个连接是不好的做法吗？或者我应该执行以下操作：

```
SELECT * 
FROM Projects P
JOIN Employees E   ON P.CreatedBY = E.EmpID
JOIN Departments D ON E.DepID = D.DepID
JOIN Offices O     ON D.officeID = O.officeID
WHERE O.officeID = @SomeOfficeID 
```

在应用程序编程中，我“先编写最佳实践，然后再优化”，但数据库管理员总是警告连接成本。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2009-01-30T18:09:58.243

规范化直到它受伤，然后去规范化直到它工作

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2009-01-30T18:07:28.873

`SELECT`非规范化在大型查询上具有fast s的优势。

缺点是：

*   确保完整性需要更多的编码和时间（这在您的情况下最重要）

*   DML（插入/更新/删除）速度较慢

*   它需要更多空间

至于优化，您可以针对更快的查询或更快的 DML 进行优化（通常，这两者是对立的）。

为更快的查询进行优化通常意味着复制数据，无论是非规范化、索引还是额外的表。

在索引的情况下，[RDBMS](http://en.wikipedia.org/wiki/Relational_database_management_system)会为您完成，但在非规范化的情况下，您需要自己编写代码。如果`Department`搬到另一个地方`Office`怎么办？您需要在三个表而不是一个表中修复它。

因此，正如我从您的表格名称中看到的那样，那里不会有数百万条记录。所以你最好规范化你的数据，这样管理起来会更简单。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2009-01-30T18:15:12.447

始终尽可能规范化以消除数据库完整性问题（即潜在的重复或丢失数据）。

即使非规范化带来了性能提升（通常情况并非如此），失去数据完整性的代价也太高了，无法证明是合理的。

只需询问任何必须努力解决遗留数据库中所有晦涩问题的人，他们是否更喜欢良好的数据或微不足道的（如果有的话）速度提升。

此外，正如约翰所提到的 - 如果您最终需要非规范化数据（用于速度/报告/等），则在单独的表中创建它，保留原始数据。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2009-01-30T18:04:46.837

加入的成本本身不应该让你太担心（除非你试图扩展到数百万用户，在这种情况下你绝对应该担心）。

我会更担心对调用它的代码的影响。规范化的数据库更容易编程，并且几乎总是可以提高应用程序本身的效率。

也就是说，不要超出理性的范围进行规范化。我已经看到为了规范化而进行的规范化，它通常最终出现在一个数据库中，该数据库有一个或两个实际数据表，以及 20 个只填充外键的表。这显然是矫枉过正。我通常使用的规则是：如果列中的数据会重复，则应该对其进行规范化。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2009-01-30T19:54:02.357

最好将该模式保留在第三范式中，让您的 DBA 抱怨连接成本。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-30T18:05:45.040

如果您的数据库一开始没有正确规范化，则 DBA 应该关注。在您仔细测量性能并确定您有瓶颈之后，您可能会开始反规范化，但我会非常谨慎。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-01-30T20:04:29.403

我最关心的是那些警告你加入成本的 DBA，除非你处于高度病态的情况。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2009-01-30T21:58:08.533

在尝试其他所有方法之前，您不应该查看非规范化。

这真的是一个问题吗？您的数据库是否有任何功能可以用来加快速度而不影响完整性？您可以通过缓存来提高性能吗？

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-30T18:31:37.857

规范化以对设计中的概念及其关系进行建模。想想什么样的关系可以改变，以及这样的改变对你的设计意味着什么。

在您发布的架构中，在我看来，这是一个明显的错误（如果您的组织运作方式有特殊情况，这可能不是错误）——隐含假设每个部门都在一个办公室，并且同一部门的所有员工都在该办公室工作。

如果部门占用两个办公室怎么办？

如果一名员工名义上属于一个部门，但在不同的办公室工作（假设您指的是实体办公室）怎么办？

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-31T14:03:53.060

不要反规范化。

根据简单而合理的设计原则设计您的表格，这将使您的系统的其余部分易于实施。易于构建、填充、使用和管理数据库。轻松快速地运行查询和更新。当情况需要时，易于修改和扩展表格设计，并且由于轻微和临时原因而无需这样做。

一组设计原则是规范化。规范化导致表易于更新（包括插入和删除）。规范化避免了更新异常，并避免了数据库自相矛盾的可能性。这通过使它们变得不可能来防止大量错误。它还通过使它们变得不必要来防止大量更新瓶颈。这很好。

还有其他一些设计原则。它们导致表格设计未完全标准化。但这不是“非规范化”。这只是一个不同的设计，与规范化有些不兼容。

导致设计与规范化完全不同的一组设计原则是星型模式设计。星型模式对于查询来说非常快。考虑到良好的 DBMS、良好的物理设计和足够的硬件来完成工作，即使是大规模的连接和聚合也可以在合理的时间内完成。如您所料，星型模式会出现更新异常。当您使数据库保持最新时，您必须围绕这些异常进行编程。您通常需要一个严格控制和精心构建的 ETL 流程，从其他（可能是规范化的）数据源更新星型模式。

使用存储在星型模式中的数据非常容易。使用某种 OLAP 和报告引擎非常简单，您无需编写任何代码即可获得所需的所有信息，并且不会过多牺牲性能。

设计一个良好的规范化模式需要良好且有些深入的数据分析。数据分析中的错误和遗漏可能会导致未发现的功能依赖关系。这些未被发现的 FD 将导致不自觉地偏离规范化。

设计和构建良好的星型模式还需要良好且有些深入的数据分析。数据分析中的错误和遗漏可能会导致维度和粒度的不幸选择。这将使 ETL 几乎不可能建立，和/或使恒星的信息承载能力不足以满足新兴需求。

好的和有些深入的数据分析不应该成为分析瘫痪的借口。分析必须在短时间内正确且合理地完成。较小的项目更短。设计和实现应该能够经受住对数据分析和需求的一些后期添加和更正，但不是稳定的需求修订洪流。

此响应扩展了您的原始问题，但我认为这与数据库设计师有关。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2015-09-11T14:15:17.727

**标准化**是一个质量决策。

**非规范化**是一种性能决策。

这就是为什么 -

> 正常化直到它受伤; 去规范化直到它起作用。

* * *

**质量决策告诉您哪种是您可以忍受的最不正常的形式：**

1.  多少非冗余对您的表很重要？
2.  您想要多快的数据管理速度？
3.  您希望表之间的关系有多清晰？

* * *

**性能决策说明什么是可接受的最高范式：**

1.  我的数据库响应速度够快吗？
2.  连接过多会导致速度变慢吗？

* * *

当您确定了您的情况下可接受的最低和最高范式后，请选择介于两者之间的范式。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-30T18:12:34.120

如果您使用整数（或 BIGINT）作为 ID，并且它们是集群主键，那么您应该没问题。

尽管从项目中找到办公室似乎总是更快，因为您总是在查找主键，但在外键上使用索引将使差异最小化，因为索引也将覆盖主键。

如果您以后发现需要对数据进行非规范化，您可以按计划或触发器创建缓存表。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-01-30T18:33:28.227

在示例中，在表上正确设置的给定索引应该允许连接发生得非常快，并且可以很好地扩展到 100,000 行。这通常是我解决问题的方法。

尽管有时数据只写入一次，并且在其余生中被选中，但每次执行十几个连接确实没有意义。

# asp.net - 同步 Ajax 工具包日历扩展器

> ID：496509
> 
> 赞同：0
> 
> 时间：2009-01-30T17:59:12.400
> 
> 标签：asp.net, asp.net-ajax

我有两个 Ajax Toolkit 日历扩展器。其中一个是开始日期，另一个是相应的结束日期。我想要发生的是当在开始日历中选择一个日期时，结束日历将跳转到该日期。这听起来很简单，但我一直很难让它发生。

有人把我从痛苦中解救出来……有什么方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T18:11:58.007

给你，这对我有用

```
<asp:TextBox runat="server" ID="txt1" OnTextChanged="txt1_TextChanged" AutoPostBack="true"></asp:TextBox>
<ajaxToolkit:CalendarExtender runat="server" ID="cal1" TargetControlID="txt1"></ajaxToolkit:CalendarExtender>
<asp:TextBox runat="server" ID="txt2"></asp:TextBox>
<ajaxToolkit:CalendarExtender runat="server" ID="cal2" TargetControlID="txt2"></ajaxToolkit:CalendarExtender>

protected void txt1_TextChanged(object sender, EventArgs e)
{
    cal2.SelectedDate = Convert.ToDateTime(txt1.Text);
} 
```

或者你可以通过javascript做到这一点我建议使用jquery来查找文本框而不是使用直接的javascript

```
<asp:TextBox runat="server" ID="txt1" onchange="SetEndDate()"></asp:TextBox>
<ajaxToolkit:CalendarExtender runat="server" ID="cal1" TargetControlID="txt1"></ajaxToolkit:CalendarExtender>
<asp:TextBox runat="server" ID="txt2"></asp:TextBox>
<ajaxToolkit:CalendarExtender runat="server" ID="cal2" TargetControlID="txt2"></ajaxToolkit:CalendarExtender>

  <script type="text/javascript">
        function SetEndDate()
        {
            var txt1 = document.getElementById("txt1");
            var txt2 = document.getElementById("txt2");

            txt2.value = txt1.value
        }
    </script> 
```

# c# - 在 C# .cs 文件中放置 using 语句的位置

> ID：496510
> 
> 赞同：3
> 
> 时间：2009-01-30T17:59:15.847
> 
> 标签：c#

**DUPE：[“使用”语句应该在命名空间内部还是外部？](https://stackoverflow.com/questions/125319/should-usings-be-inside-or-outside-the-namespace)**

如果我使用 Visual Studio 向项目添加一个新类，它会在命名空间之前添加所有 using 语句，但对于同一个项目，FxCop 表示将命名空间放在命名空间内。哪种编码风格更好？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T18:01:19.743

请参阅[“使用”语句应该在命名空间内部还是外部？](https://stackoverflow.com/questions/125319/should-usings-be-inside-or-outside-the-namespace)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T18:01:27.980

我更喜欢文件顶部的默认值。这完全取决于您，但我猜大多数人使用 Visual Studio 的默认模板并将它们放在顶部，预计会在那里。

使用名称空间之外的名称空间，它确实变得更具可读性，因为对我来说，名称空间并不像您正在编写的代码那么重要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T18:02:25.297

如果将 Using 放在命名空间内，它们仅适用于该命名空间。
如果它们在外部，它们将应用于文件中的任何命名空间

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T18:03:06.683

这取决于你的个人口味。FxCop 基于 Microsoft 标准。但老实说，我更喜欢 Visual Studio 默认方式，即位于命名空间之外。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T18:05:40.280

使用指令将名称带入范围。考虑到该定义，并注意您可以在同一个文件中拥有多个命名空间，因此使用指令影响的那些名称仅适用于特定命名空间是有意义的，因为分组名称是命名空间的用途。

没关系，FxCop 也可能抱怨每个文件有多个命名空间。

但在这种情况下，我更喜欢 VS 默认值。为什么要为自己做额外的工作？

# c# - 在 C# 中应该使用 try-catch 进行 is-numeric 测试吗？

> ID：496519
> 
> 赞同：2
> 
> 时间：2009-01-30T18:03:02.970
> 
> 标签：c#

我听说使用异常捕获不是数字测试的推荐做法。

例如：

```
bool isnumeric
try
{
int i = int.parse(textbox1.text);
isnumeric = true;
}

catch {isnumenric=false} 
```

还有其他方法可以测试 C# 中的数字吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2009-01-30T18:05:09.703

是的，尝试使用

```
int i;    
bool success = Int32.TryParse(textBox1.text, out i); 
```

TryParse方法基本上完成了您**在**上面所做的工作。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-30T18:05:04.667

使用内置的[TryParse](http://msdn.microsoft.com/en-us/library/f02979c7.aspx)

例如

```
int number;
bool result = Int32.TryParse(value, out number); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-30T18:05:39.297

是的。请改用 int.TryParse、double.TryParse 等，它们都返回布尔值。

Alternately, there's an IsNumeric function buried in the VB assemblies (in the Microsoft.VisualBasic namespace in Microsoft.VisualBasic.dll) that you can also call from your C# code:

bool Microsoft.VisualBasic.Information.IsNumeric(value)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-01-30T18:06:23.663

TryParse()

```
int i;
if(Int32.TryParse(someString,out i))
{
    //now use i because you know it is valid
    //otherwise, TryParse would have returned false
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-30T18:05:56.163

```
int result = -1;
bool isNumeric = Int32.TryParse(text, out result); 
```

isNumeric will be true if the number is numeric, false otherwise; if the number is numeric, result will have the numeric value of the number.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-30T18:05:36.693

bool TryParse(string, out int)

如果它能够解析整数，它将返回一个布尔值，并且 out 参数将包含整数（如果解析成功）。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-01-30T21:00:46.713

If you just need to do number testing and do not need the integer number, you may use the function below. This is faster than Int32.TryParse(...) methods.

Edit for Barry Fandango: Handles negative numbers now. This is only for testing integers.

```
 public static bool IsNumber(string s)
    {
       if (s == null || s.Length == 0)
        {
            return false;
        }

        if (s[0] == '-')
        {
            for (int i = 1; i < s.Length; i++)
            {
                if (!char.IsDigit(s[i]))
                {
                    return false;
                }
            }
        }
        else
        {
            foreach (char c in s)
            {
                if (!char.IsDigit(c))
                {
                    return false;
                }
            }
        }

        return true;
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T22:11:08.087

If you want the integer then Int32.TryParse(...) is what you want else Information.IsNumeric(...) (From the Microsoft.VisualBasic.dll) if you don't care what the actual integer is.

# asp-classic - 经典 ASP Server.MapPath() 在 global.asa 中无法按预期工作

> ID：496524
> 
> 赞同：2
> 
> 时间：2009-01-30T18:04:36.913
> 
> 标签：asp-classic, server.mappath, global.asa, mappath

在经典 ASP 中，**Server.MapPath()**并不总是在**global.asa内的****Application_OnStart**事件中正常工作。我在虚拟根目录中的**"\testfolder\test.asp"**有一个 ASP 页面，在**"\xsl\transform.xsl"**有一个 XSLT 文件。我的虚拟根目录位于**"c:\inetpub\wwwroot\testapp\"**。

 ******我在 ASP 页面中使用**MapPath**来获取 XSLT 文件的完整路径。电话是：

```
sXslPath = Server.MapPath("xsl\transform.xsl") 
```

有时 MapPath 按预期返回**"c:\inetpub\wwwroot\testapp\xsl\transform.xsl"**，有时它错误地返回**"c:\inetpub\wwwroot\testapp\ *testfolder* \xsl\transform.xsl"**。不正确的路径显然会导致严重的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T18:05:29.173

*我在这里回答我自己的问题：*

出现此问题是因为在**Application_OnStart**中调用时，**MapPath**错误地包含导致应用程序启动的页面上下文。如果在应用程序尚未启动时要运行的第一个 ASP 页不在虚拟根目录的根目录中，则**MapPath**会混淆，并将调用的 ASP 页的路径添加到它返回的路径中。

例如，如果启动应用程序的页面位于**“c:\inetpub\wwwroot\testapp\folder1\folder2\test.asp”**，则 MapPath 会错误地将**“\folder1\folder2”**添加到路径中间并返回**“ c:\inetpub\wwwroot\testapp\folder1\folder2\xsl\transform.xsl"**

如果您的网站只有根文件夹中的文件，或者在**global.asa**中不使用**MapPath** ，那么您将永远不会注意到这个小怪异。我怀疑有很多 ASP Classic 站点有时因此无法正常启动，但它们的所有者只是快速进行了 iisreset，不知道出了什么问题。

 **这样做的结果是，如果您的网站在除根文件夹之外的任何位置都有 ASP 文件，那么您就无法在**global.asa中可靠地使用****MapPath 。**

 **如果它是一次性网站，那么最简单的解决方案就是硬编码您在**global.asa**中使用的任何路径。

如果您基于 ASP Classic 向其他人销售产品，那么硬编码路径不是一种选择。您要么必须将**MapPath**的所有使用移出应用程序启动，要么通过将路径写入 ASP 文件作为安装程序的一部分来处理该问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-08-28T16:11:28.133

或者使用 sXslPath = Server.MapPath("\xsl\transform.xsl")

然后将从根目录映射路径

自然，如果您在非服务器操作系统中的 iis 上进行开发，root 将是默认网站，您必须记住在部署时进行更改...

# recaptcha - reCAPTCHA CAPTCHA 是越来越难还是只有我

> ID：496545
> 
> 赞同：66
> 
> 时间：2009-01-30T18:07:44.160
> 
> 标签：recaptcha

由于我一直在测试网站，我发现[reCAPTCHA](http://www.recaptcha.net)越来越难以阅读。是只有我还是其他人也有这个问题？

除此之外，今天早上我有一个用户抱怨在他们的 reCAPTCHA 中收到了一个英镑字符。当然，用户不知道该怎么做，即使我有消息表明他们可以单击重新加载/刷新图标来获取新的验证码。

不幸的是，这个实现是在一个经常被 60 岁以上的人使用的网站上，所以更复杂或令人困惑的验证码是一个问题，但该网站仍然收到很多试图制造垃圾邮件的人。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-01-30T18:32:27.450

尽管到目前为止提出了意见，但我实际上喜欢 reCAPTCHA 系统。我喜欢它主要是因为我认为它设法同时解决了两个问题：验证人类身份并帮助将作品数字化（对于那些不知道这里为什么它使用两个词而不是一个词的人：[reCAPTCHA 哲学](http://recaptcha.net/learnmore.html)

因此，我鼓励你们所有人尽可能多地尝试通过 reCAPTCHA 测试，因为你们真的在帮助一个好的事业。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2009-01-30T18:42:43.607

最糟糕的是那些区分大小写的。L, l, I, o O 0 ?

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2009-01-30T18:08:33.630

我很难阅读大多数验证码，但我同意 reCAPTCHA 是一个特别的麻烦。

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2009-01-30T18:21:36.397

是的，验证码越来越难以阅读。

[验证码图片 http://img165.imageshack.us/img165/1253/picture3rs8.png](http://img165.imageshack.us/img165/1253/picture3rs8.png)

我现在找不到链接，但我相信 Microsoft Passport（MSN 和 Hotmail）是最难破解的。

问题是，每当软件在检测文本方面变得更好时，文本就必须变得更难阅读。

我猜具有讽刺意味的是，CAPTCHA 代表“完全自动化的公共图灵测试，以区分计算机和人类”，但计算机很快就会赶上，而且它们对大多数人来说太难阅读了。此时它们将消失，将使用其他版本的 CAPTCHA。

也许使用谷歌图像标签系统的基于照片的验证码？

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-30T18:24:09.433

具有讽刺意味的是，尽管计算机肯定变得越来越聪明，但人们也可能越来越愚蠢。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-01-30T20:11:08.157

我认为他们变得越来越难，我知道我至少尝试一次验证码时往往会失败，有时会失败两次。不过，也有不错的替代品出现。例如，[Geoff Appleby 展示了九张照片并提供了文字说明供您选择其中三张](http://blogs.crankygoblin.com/blogs/geoff.appleby/archive/2008/03/11/hmm-look-at-that-time-passes.aspx)（向下滚动到评论表单）。

您概述的个人资料（照片可能很大）非常容易访问这样的系统。也更容易实现。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2010-08-23T15:56:18.657

现在肯定越来越难了。我最近的一个有一些完全无法区分的东西，旁边的“是”是颠倒的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-01-30T18:16:05.033

我发现 reCAPTCHA 的可用性绝对是最差的。我经常避开使用它们的网站。

我不介意网站需要进行这些测试，但它们不需要那么几乎不可能弄清楚。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2009-01-30T18:22:42.073

也许 reCAPTCHA，因为它开始在人们正确理解的单词上运行得越来越低，当人们过滤掉所有简单的单词时，它开始削减越来越难的“未知”单词？

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2009-01-30T19:03:59.837

我认为最终验证码将不再可行，并且必须有某种普遍认可的网站“护照”系统。您支付几美元购买的某种帐户，当您注册网站时，它会将您识别为人类。

然后，如果您开始将该帐户用于垃圾邮件机器人，您可能会被普遍禁止。网站甚至可以根据这些禁令追溯清理帖子。*耸耸肩*只是一个想法

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2009-01-30T20:18:14.133

[Stack Overflow 博客](https://blog.stackoverflow.com/2009/01/updated-wmd-editor/)评论验证码多次将我识别为非人类。现在我只是不断地请求新的验证码，直到我得到一个我可以阅读的验证码。通常只需要 3 次尝试。

**更新：**根据 reCAPTCHA 的总工程师 Ben Maurer 的说法，[他在我的博客上对此发表了评论](http://www.billthelizard.com/2009/03/worst-captcha-ever.html)，超过 96% 的 reCAPTCHA 得到了正确解决。所以也许我们作为一个群体变得越来越愚蠢？

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-01-30T18:57:05.793

reCAPTCHA 总是会变得更难。

当他们制作破解 reCAPTCHA 的工具时，他们将使用相同的技术来帮助数字化文本，因此只有最新技术无法读取的内容才会用作 CAPTCHA。

它的间谍与间谍，除了它是 reCAPTCHA 和人类知识的双赢。

他们面临的唯一问题是，如果他们的阅读器非常好，永远不会失败，reCAPTCHA 将不再有效，但对于人类知识的数字化来说，这将是一个很好的问题。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-04-04T15:04:36.010

不少下载网站刚刚停止使用验证码。您真正需要做的就是记录客户端的 IP 地址并在 x 分钟内停止授予他们访问权限。

同样的东西可以用于密码。用户是否输错密码 3 次？让他们等五分钟再试一次。并让他们选择通过向他们发送电子邮件来刷新它。

大约是时候摆脱那些验证码了。计算机和算法已经变得足够快，甚至可以破解最难的算法。虽然只会让人们感到沮丧。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2009-01-30T18:16:23.240

是的。越来越难了。如果每个人都意识到 reCAPTCHA 是如何工作的，那么每个人都应该通过一个不可读的单词。reCAPTCHA 总是显示 2 个单词：其中一个单词 reCAPTCHA 通过 OCR 知道它的 ASCII 表示，另一个，你可能会失败，因为 reCAPTCHA 不知道正确答案。当我发现一个太难的 reCAPTCHA 时，我只需键入“verydifficultword”和可读的单词。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2009-04-04T02:04:36.290

关于 ReCAPTCHA 要记住的一点是，它们是从真实书籍和文章中实际扫描的图像。因此，您必须意识到时髦的标点符号和其他东西可以使它进入 - 它不仅仅是单词。例如，我见过以连字符结尾的部分单词（显然出现在行尾）以及美元符号、数字（如 1.Something）等。

我发现，如果您牢记起源，它会更有意义并且更容易解决。

同样有趣的是，您只需要正确输入一个 reCAPTCHA 单词，因为另一个用于帮助数字化。但是你不会知道哪个是哪个。:)

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2009-04-04T03:58:29.107

是的，越来越难了。无论它做了什么好事，它都应该是可用的。我在他们的音频验证码上尝试了 3 或 4 次，但每次都失败了。虽然验证码试图解决一个实际问题，但对于那些看不到验证码图像而不得不依赖音频验证码的人来说，这是一个大问题。此外，并非所有使用验证码的网站都提供音频选项。无论如何，我认为我们必须在很长一段时间内不断向这些机器证明我们确实是人类。

# dynamics-crm - Microsoft Dynamics Crm 4.0 中的派对列表

> ID：496554
> 
> 赞同：0
> 
> 时间：2009-01-30T18:11:25.277
> 
> 标签：dynamics-crm, dynamics-crm-4

是否可以在 Microsoft Dynamics Crm 4.0 中创建类型为 Partylist 的属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T21:26:40.733

PartyList 类型基本上是一个系统控件，用于在电子邮件上显示：n 关系。目前，我们不允许创建 PartyList 类型的新属性。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2009-02-20T12:12:45.927

```
<attribute PhysicalName="to">
  <Type>partylist</Type>
  <ValidForCreateApi>1</ValidForCreateApi>
  <ValidForUpdateApi>1</ValidForUpdateApi>
  <ValidForReadApi>1</ValidForReadApi>
  <IsLogical>1</IsLogical>
  <AttributeTypeId>00000000-0000-0000-00aa-110000000039</AttributeTypeId>
  <DisplayMask>ValidForForm|ValidForGrid|RequiredForForm</DisplayMask>
  <Descriptions>
    <Description description="Sending Mails to the specified Users." languagecode="1033" />
  </Descriptions>
  <ImeMode>auto</ImeMode>
  <RequiredLevel>none</RequiredLevel>
  <Format />
  <LookupClass>SystemUsers</LookupClass>
  <LookupStyle>multi</LookupStyle>
  <LookupTypes>
    <LookupType id="f93fb506-2341-db11-898a-0007e9e17ebd">8</LookupType>
  </LookupTypes>
  <displaynames>
    <displayname description="Users" languagecode="1033" />
  </displaynames>
</attribute> 
```

只需将代码添加到您想要派对列表属性的任何实体。测试工作正常。

# asp.net - 错误：服务器不支持安全连接

> ID：496566
> 
> 赞同：0
> 
> 时间：2009-01-30T18:14:59.637
> 
> 标签：asp.net, gmail, system.net.mail

好的，我已经使用以下脚本一年多来从我的主机发送电子邮件（通过 gmail），它工作得很好（**Settings.Get()**只是返回字符串）：

```
public class Email : SmtpClient
{
    public MailMessage Message { get; private set; }

    public Email(string to, string from, string subject, string body) : base(Settings.Get("smtp"), 25)
    {
        this.EnableSsl = Convert.ToBoolean(Settings.Get("ssl"));
        if(this.EnableSsl)
            this.Credentials = new System.Net.NetworkCredential(Settings.Get("gm"), Settings.Get("gmp"));
        this.Message = new MailMessage(from, to, subject, body);
    }

    public void Send()
    {
        try { this.Send(Message); }
        catch (Exception ex) { throw ex; }
    }
} 
```

但是，从昨天开始，我收到了这个错误：

**错误：服务器不支持安全连接。**

现在当然我的主人认为这不是他们的错，但我没有改变任何东西。此外，它在我的本地和测试机器上仍然可以正常工作。知道是什么原因造成的，所以我可以告诉他们修复它吗？

谢谢...这让我发疯了！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T18:23:50.027

您使用的是什么 SMTP 服务器和端口？如果您直接连接到 smtp.gmail.com 以发送 ssl 邮件，则需要使用端口 465 或 587。

看起来您正在使用端口 25，您确定您的`Settings.Get("ssl")`返回错误吗？

[阅读此处了解详细信息。](http://mail.google.com/support/bin/answer.py?hl=en&answer=13287)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-08-09T01:17:14.710

改变：

```
 SmtpServer.EnableSsl = true; 
```

到：

```
SmtpServer.EnableSsl = false; 
```

这将对问题进行排序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T18:21:54.023

检查您的事件日志，可能是您的 PC 和服务器无法正常握手。或者证书没有被下载，或者它可能包含错误，这可能是来自 gmail 的一些奇怪的东西

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-11-06T17:20:44.207

指定使用 587 的端口也为我解决了这个问题 -

**错误：服务器不支持安全连接。**

我工作的公司创建了一个 Windows 服务，它会做一些事情，然后从 gmail 发送电子邮件。一开始它发送的电子邮件很好，没有任何问题。在 Vista 机器上安装该服务后，我们注意到它不会发送电子邮件。一旦我们将它安装在 Windows 2008 服务器上，同样的事情。我们甚至已经开始注意到少数 XP 机器。一旦我们将端口更改为 587，它就可以再次正常工作并发送电子邮件。

这是一些在我们尝试过的所有机器（XP、Vista、Server 2008）上运行的示例代码。

```
 Dim client As New Net.Mail.SmtpClient("smtp.gmail.com")
        client.Port = 587
        client.EnableSsl = True
        client.UseDefaultCredentials = False
        client.Credentials = loginInfo
        client.Send(mm) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-25T00:34:28.977

```
SmtpServer.Port = 587;
SmtpServer.UseDefaultCredentials = false;
SmtpServer.Credentials = new System.Net.NetworkCredential("xx@xx.com", "password");
SmtpServer.EnableSsl = true; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-26T18:04:20.790

转到 C:\Program Files\Microsoft SQL Server Reporting Services\SSRS\ReportServer\rsreportserver.config 并找到“True”并将其设置为 false，如下所示：“False”

重新启动 SSRS 服务，你应该会很好。

# c# - 如何在 .net 中获取可用的 wifi AP 及其信号强度？

> ID：496568
> 
> 赞同：29
> 
> 时间：2009-01-30T18:15:54.083
> 
> 标签：c#, .net, networking, mono, wifi

有没有办法使用 .NET 访问所有 WiFi 接入点及其各自的 RSSI 值？如果我可以在不使用非托管代码的情况下做到这一点，那就太好了，如果它在单声道和 .NET 中工作就更好了。

如果可能的话，我会应用一个代码示例。谢谢

* * *

以下是我发现的一些类似的 stackoverflow 问题：

-[获取我在 Windows Vista 上使用 C# .Net 连接的无线网络的 SSID](https://stackoverflow.com/questions/431755/get-ssid-of-the-wireless-network-i-am-connected-to-with-c-net-on-windows-vista)

-[在 C# 中管理无线网络连接](https://stackoverflow.com/questions/285665/managing-wireless-network-connection-in-c)

-[从 C# 获取无线接入点的 BSSID（MAC 地址）](https://stackoverflow.com/questions/187777/get-bssid-mac-address-of-wireless-access-point-from-c)

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-31T04:07:02.347

[它是一个包装项目，在http://www.codeplex.com/managedwifi](http://www.codeplex.com/managedwifi)中使用 c# 中的托管代码

它支持 Windows Vista 和 XP SP2（或更高版本）。

示例代码：

```
using NativeWifi;
using System;
using System.Text;

namespace WifiExample
{
    class Program
    {
        /// <summary>
        /// Converts a 802.11 SSID to a string.
        /// </summary>
        static string GetStringForSSID(Wlan.Dot11Ssid ssid)
        {
            return Encoding.ASCII.GetString( ssid.SSID, 0, (int) ssid.SSIDLength );
        }

        static void Main( string[] args )
        {
            WlanClient client = new WlanClient();
            foreach ( WlanClient.WlanInterface wlanIface in client.Interfaces )
            {
                // Lists all networks with WEP security
                Wlan.WlanAvailableNetwork[] networks = wlanIface.GetAvailableNetworkList( 0 );
                foreach ( Wlan.WlanAvailableNetwork network in networks )
                {
                    if ( network.dot11DefaultCipherAlgorithm == Wlan.Dot11CipherAlgorithm.WEP )
                    {
                        Console.WriteLine( "Found WEP network with SSID {0}.", GetStringForSSID(network.dot11Ssid));
                    }
                }

                // Retrieves XML configurations of existing profiles.
                // This can assist you in constructing your own XML configuration
                // (that is, it will give you an example to follow).
                foreach ( Wlan.WlanProfileInfo profileInfo in wlanIface.GetProfiles() )
                {
                    string name = profileInfo.profileName; // this is typically the network's SSID

                    string xml = wlanIface.GetProfileXml( profileInfo.profileName );
                }

                // Connects to a known network with WEP security
                string profileName = "Cheesecake"; // this is also the SSID
                string mac = "52544131303235572D454137443638";
                string key = "hello";
                string profileXml = string.Format("<?xml version=\"1.0\"?><WLANProfile xmlns=\"http://www.microsoft.com/networking/WLAN/profile/v1\"><name>{0}</name><SSIDConfig><SSID><hex>{1}</hex><name>{0}</name></SSID></SSIDConfig><connectionType>ESS</connectionType><MSM><security><authEncryption><authentication>open</authentication><encryption>WEP</encryption><useOneX>false</useOneX></authEncryption><sharedKey><keyType>networkKey</keyType><protected>false</protected><keyMaterial>{2}</keyMaterial></sharedKey><keyIndex>0</keyIndex></security></MSM></WLANProfile>", profileName, mac, key);

                wlanIface.SetProfile( Wlan.WlanProfileFlags.AllUser, profileXml, true );
                wlanIface.Connect( Wlan.WlanConnectionMode.Profile, Wlan.Dot11BssType.Any, profileName );
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-09-11T07:32:25.497

如果平台是Windows10，你可以使用`Microsoft.Windows.SDK.Contracts`包访问所有可用的wifi。

首先，`Microsoft.Windows.SDK.Contracts`从 nuget 安装软件包。

然后，您可以使用下一个代码来获取 ssid 和信号强度。

```
var adapters = await WiFiAdapter.FindAllAdaptersAsync();
foreach (var adapter in adapters)
{
    foreach (var network in adapter.NetworkReport.AvailableNetworks)
    {
        Console.WriteLine($"ssid: {network.Ssid}");
        Console.WriteLine($"signal strength: {network.SignalBars}");
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-01-31T02:12:03.327

使用所有 Vista 和 XP SP3 系统上的原生 Wifi API。XP SP2 有一个不同的 API，您可以使用它来做同样的事情。

**[如何枚举网络](http://msdn.microsoft.com/en-us/library/ms706749(VS.85).aspx)**

**[如何获得信号强度](http://msdn.microsoft.com/en-us/library/ms706839.aspx)**

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-02-21T16:48:16.440

我正在`netsh wlan show networks mode=bssid`从 C# 代码运行命令。

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.IO;
using System.Linq;
using System.Reflection;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading.Tasks;

namespace ConsoleApp2
{
    class AccessPoint
    {
        public string SSID { get; set; }
        public string BSSID { get; set; }
        public byte Signal { get; set; }
    }

    class Program
    {
        private static async Task Main(string[] args)
        {
            var apList = await GetSignalOfNetworks();

            foreach (var ap in apList)
            {
                WriteLine($"{ap.BSSID} - {ap.Signal} - {ap.SSID}");
            }

            Console.ReadKey();
        }

        private static async Task<AccessPoint[]> GetSignalOfNetworks()
        {
            string result = await ExecuteProcessAsync(@"C:\Windows\System32\netsh.exe", "wlan show networks mode=bssid");

            return Regex.Split(result, @"[^B]SSID \d+").Skip(1).SelectMany(network => GetAccessPointFromNetwork(network)).ToArray();
        }

        private static AccessPoint[] GetAccessPointFromNetwork(string network)
        {
            string withoutLineBreaks = Regex.Replace(network, @"[\r\n]+", " ").Trim();
            string ssid = Regex.Replace(withoutLineBreaks, @"^:\s+(\S+).*$", "$1").Trim();

            return Regex.Split(withoutLineBreaks, @"\s{4}BSSID \d+").Skip(1).Select(ap => GetAccessPoint(ssid, ap)).ToArray();
        }

        private static AccessPoint GetAccessPoint(string ssid, string ap)
        {
            string withoutLineBreaks = Regex.Replace(ap, @"[\r\n]+", " ").Trim();
            string bssid = Regex.Replace(withoutLineBreaks, @"^:\s+([a-f0-9]{2}(:[a-f0-9]{2}){5}).*$", "$1").Trim();
            byte signal = byte.Parse(Regex.Replace(withoutLineBreaks, @"^.*(Signal|Sinal)\s+:\s+(\d+)%.*$", "$2").Trim());

            return new AccessPoint
            {
                SSID = ssid,
                BSSID = bssid,
                Signal = signal,
            };
        }

        private static async Task<string> ExecuteProcessAsync(string cmd, string args = null)
        {
            var process = new Process()
            {
                StartInfo = new ProcessStartInfo
                {
                    FileName = cmd,
                    Arguments = args,
                    RedirectStandardInput = false,
                    RedirectStandardOutput = true,
                    RedirectStandardError = true,
                    UseShellExecute = false,
                    CreateNoWindow = true,
                    StandardOutputEncoding = Encoding.UTF8,
                }
            };

            process.Start();

            string result = await process.StandardOutput.ReadToEndAsync();

            process.WaitForExit();

#if DEBUG
            if (result.Trim().Contains("The Wireless AutoConfig Service (wlansvc) is not running."))
            {
                return await GetFakeData();
            }
#endif

            return result;
        }

        private static async Task<string> GetFakeData()
        {
            var assembly = Assembly.GetExecutingAssembly();
            var resourceName = "ConsoleApp2.FakeData.txt";

            using (Stream stream = assembly.GetManifestResourceStream(resourceName))
            using (StreamReader reader = new StreamReader(stream))
            {
                return await reader.ReadToEndAsync();
            }
        }

        private static void WriteLine(string str)
        {
            Console.WriteLine(str);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T18:20:52.030

您*也许*可以使用 WMI 查询来实现它。看看这个[线程](http://social.msdn.microsoft.com/Forums/en-US/windowsgeneraldevelopmentissues/thread/369109bc-5177-4dcc-8353-325bbec8d310/)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T18:28:00.470

如果您正在使用 vista wmi 不适用于所有网络适配器，则 vista 的另一种替代方法是使用 netsh 命令。看看[这篇 codeproject 文章。](http://www.codeproject.com/KB/gadgets/WifiScanner.aspx)

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2009-02-01T15:33:24.127

我找到了另一种方法，虽然它确实需要一些钱。

[rawether.net](http://www.rawether.net/)上有一个 .NET 库，可让您获取以太网驱动程序。

# visual-studio - 从 Visual Studio 2008 中删除 SourceSafe 集成

> ID：496576
> 
> 赞同：6
> 
> 时间：2009-01-30T18:18:31.970
> 
> 标签：visual-studio, visual-studio-2008, svn, visual-sourcesafe

最近有人问了一个关于[从 Visual Studio 6 中删除 SourceSafe 集成](https://stackoverflow.com/questions/471056/removing-sourcesafe-integration-from-visual-studio-6)的问题。我需要对 Visual Studio 2008 做同样的事情。

我们的团队使用 Subversion，我已经安装了 AnkhSVN，这是 VS2008 的 Subversion 插件（团队的其他一些成员使用 VisualSVN）。我发现 SourceSafe “坚持”成为首选的集成源代码控制工具 - 工具 > 选项 > 源代码控制中的源代码控制插件设置似乎在每次关闭 VS2008 时都会自行重置。这很烦人，我想摆脱 SourceSafe。

我尝试运行 VS2008 安装以关闭（有效卸载）SourceSafe 插件，但没有选项。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-01-30T18:27:00.613

Visual Studio 将源代码管理首选项存储在解决方案和项目文件中。要切换提供者，您必须首先“解除绑定”旧提供者。

*   选择“文件”>“源代码管理”>“更改源代码管理”，选择解决方案和所有项目文件，然后单击“取消绑定”。
*   保存解决方案。
*   然后，您可以使用工具 > 选项 > 源代码管理更改提供程序。

手动编辑 .sln 和 .proj 文件也可以，但并不完全推荐。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-01-30T18:50:25.853

找到了！[MS 的帮助和支持站点](http://msdn.microsoft.com/en-us/library/bb166193.aspx)对其进行了描述，请参阅第 2 节

在以下位置添加 DWORD 注册表项：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe\HideInVisualStudio 
```

设置为1。重启VS2008，SourceSafe插件选项消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T18:22:48.077

您通常可以毫无问题地编辑 *.sln 文件和 *.??proj 文件来删除这些绑定。这两个文件只是文本文件，因此您可以在记事本、写字板或 Visual Studio 中打开它们。

只需慢慢删除内容，然后保存并尝试加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T18:25:17.667

不确定这是否有效，但您可以尝试：

*   工具/选项/源代码控制：将当前源代码控制插件设置为“无”
*   打开解决方案 - 希望它会告诉您缺少提供程序并为您提供删除绑定的选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-05-26T12:09:45.113

我的情况有几个限制/行为：

1）机器和项目由几个开发人员共享，他们应该不受我的变化的影响，

2）vs2008自动重新启用SourceSafe控件（没有尝试HideInVisualStudio注册表解决方案，因为它是全局标志），

3) 我无法删除项目中的绑定，也无法卸载 SourceSafe

所以我找到了一种不完美但对我来说足够好的方法：

1）打开regedit并转到此键：

```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe 
```

应该有一个条目

```
SCCServerPath 
```

其中应该包含如下内容：C:\Program Files\Microsoft Visual SourceSafe\ssscc.dll

2) 修改 ssscc.dll 的权限，以拒绝您的用户 ID 的“读取和执行”访问权限。

现在，这并不完美，因为在 VS2008 中加载解决方案时有时会出现错误消息消息（初始化 Microsoft Visual SourceSafe 源代码控制提供程序时出现故障。您不能使用此提供程序执行源代码控制操作。），但目标已经实现：

1) VS2008 中不再有源代码安全集成，

2) Source Safe 独立版仍在工作，

3) 其他用户不受修改影响。

# memory - 将数据存储在内存中：会话 vs 缓存 vs 静态

> ID：496579
> 
> 赞同：10
> 
> 时间：2009-01-30T18:20:37.600
> 
> 标签：memory, session, caching, static

一些背景故事：我正在开发一个 Web 应用程序，该应用程序需要相当多的时间来准备/处理数据，然后再将其提供给用户进行编辑/操作。数据请求任务 ~ 15 / 20 秒完成，几秒处理。在那里，用户可以即时操作值。对值的任何操作都需要完全重新处理数据。

更新：为避免混淆，我只进行 1 次数据调用（命中 15 秒），然后希望将结果保存在内存中，这样我就不必再次调用它，直到用户 100% 完成使用它. 因此，第一次拉取需要一段时间，但是，使用 Ajax，我将访问内存中的数据以不断更新并将响应时间保持在 2 秒左右（我希望如此）。

为了提高效率，我将初始数据移动到内存中并使用 Ajax 调用回服务器，这样我就可以减少处理时间来处理此用户更新时发生的重新计算。

这是我的问题，考虑到性能，什么是存储这些数据的最佳方式，假设在任何给定时刻只有 1 个用户将使用这些数据。

此外，用户可能会在此过程中工作几个小时。当用户使用数据工作时，如果他们的会话以某种方式中断，我将需要某种故障保护来保存用户的当前数据（在数据库或序列化二进制文件中）。换句话说，我需要一个具有适当钩子的解决方案，以允许我在用户断开连接/分心太久的情况下转储内存对象的数据。

到目前为止，这是我的想法：

会话状态 - 优点：锁定一个用户。具有符合我的故障安全要求的会话结束事件。缺点：我当前选项中最慢的性能。会话结束事件有时很难确保正确触发。

缓存 - 优点：良好的性能。可以访问依赖项，这可能是以后的奖励，但在当前范围内并不真正有用。缺点：除了基于时间间隔的写入之外，没有简单的故障保护步骤。全球范围 - 必须确保用户不会与彼此的工作发生冲突。

静态 - 优点：最佳性能。易于维护，因为我可以直接利用我当前的班级结构。缺点：除了基于时间间隔的写入之外，没有简单的故障保护步骤。全球范围 - 必须确保用户不会与彼此的工作发生冲突。

有人对我应该选择的选项有任何建议/意见吗？

谢谢！

更新：忘了提，我正在使用 VB.Net、Asp.Net 和 Sql Server 2005 来执行此任务。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T18:45:29.717

我将投票给秘密选项#4：为此使用数据库。如果您谈论的是 20 秒以上的数据周转时间，那么考虑到您提供的选项的限制，您不会通过尝试在内存中执行此操作来获得任何收益。您也可以在数据库中设置它（给它一个自己的表，如果需求那么大，甚至可以给它一个单独的数据库）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T18:34:34.280

使用 Session，但不要依赖它。

简单地说，让用户“命名”数据集，并为用户主动保存它，无论是自动的，还是通过像“保存”按钮这样简单的东西。

您不能仅仅因为会话（通常）绑定到用户浏览器实例而依赖会话。如果他们不小心关闭了浏览器（单击 X 按钮、他们的 PC 崩溃等），那么他们将丢失所有工作。这会很讨厌。

一旦用户对数据的“持久”状态进行了这种控制，您就可以依靠 Session 将其保存在内存中并将其用作缓存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T18:34:58.320

我认为您几乎只是用优点/缺点回答了您的问题。但是，如果您正在寻找一些同行验证，我会投票给 Session。尽管性能较慢（您知道慢多少吗？），但无论如何您的处理都需要很长时间。你认为用户会知道 15 秒和 17 秒之间的区别吗？两者在网络术语中都是“永远”的，所以选择似乎最容易实现的那个。

也许有点跑题了。我建议将这些长处理调用放在异步（不要与 AJAX 的异步混淆）页面中。

看看这篇文章，如果没有意义，请回复我。

[http://msdn.microsoft.com/en-us/magazine/cc163725.aspx](http://msdn.microsoft.com/en-us/magazine/cc163725.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-09T16:34:00.090

我建议在将初始结果发送给用户时，在新的数据库表中创建数据副本（我们称之为 EDIT）。如果性能是一个问题，请在后台线程中执行此操作。

当用户编辑数据时，更新表（如果性能成为问题，也可以在后台线程中）。如果必须使用线程，则必须确保在开始更新行之前完成第一个线程。

这允许用户在对结果感到满意时离开、返回，甚至重新启动浏览器并提交。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-11T22:04:46.573

我会使用在任何页面加载中存储数据的缓存方法。您可以命名要存储数据的缓存以避免冲突。

为了跟踪用户所做的更改，我会采用更老式的方法：每次用户进行更改时附加到文本文件，然后每隔一段时间扫描该文件以将更改保存回 DB。如果您根据用户/帐户或其他会话唯一指示符命名文件，则不会出现冲突问题，并且应用程序（或其他一些支持应用程序，这通常可能是一个更好的主意）可以扫描所有此类文件并即使会话结束也更新数据库。

可以调整第一部分以错开更多的写入：将更改保存到 Session，然后每隔一段时间将其写入文件，然后以更大的间隔扫描文件。您可以将其调整为性能并选择可能的用户更改损失级别。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-12T00:23:03.137

其他人提到的一种可能的替代方法是将数据存储在客户端上。假设数据集不是太大，并且操作它的代码可以在客户端处理。您可以将数据存储为 XML 数据岛或 JSON 对象。然后可以操纵/处理这些数据并处理所有客户端，而无需往返服务器。如果您需要将此数据持久保存回服务器，则最终生成的数据可以通过 AJAX 或标准回发来发布。

如果这不符合您的要求，我会按照其他评论的建议将其存储在 SQL 服务器上。

# python - 在 Python 中跟踪类实例变量的好方法是什么？

> ID：496582
> 
> 赞同：11
> 
> 时间：2009-01-30T18:21:13.493
> 
> 标签：python, variables

我是一名刚开始学习 Python 的 C++ 程序员。我想知道您如何跟踪大型 Python 类中的实例变量。我习惯于拥有一个`.h`文件，该文件为我提供了所有班级成员的整洁列表（完整的评论）。但是由于 Python 允许您动态添加新的实例变量，那么您如何跟踪所有这些变量呢？

我正在想象一个场景，当我已经有一个新的实例变量时，我错误地添加了一个 - 但它距离我工作的地方有 1000 行。有避免这种情况的标准做法吗？

**编辑：**看来我对“成员变量”一词造成了一些混淆。我的意思是实例变量，我已经相应地编辑了我的问题。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-31T04:45:58.897

我想说，避免这种情况的标准做法是*不要编写距离任何东西 1000 行的类！*

说真的，这对于任何有用的类来说都太过分了，尤其是在像 Python 一样富有表现力的语言中。使用更多标准库提供的内容并将代码抽象到单独的模块中应该有助于减少您的 LOC 计数。

标准库中最大的类的行数远低于 100 行！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-01-30T18:39:58.433

首先：类属性，还是实例属性？或两者？=)

*通常*你只需在类定义中添加实例属性`__init__`和类属性，通常在方法定义之前......这可能应该涵盖 90% 的用例。

如果代码动态添加属性，它可能（希望 :-) 有充分的理由这样做......利用动态特性、内省等。除此之外，以这种方式添加属性可能没有您想象的那么普遍。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-01-31T07:15:15.117

[pylint](http://www.logilab.org/project/pylint)可以静态检测 中未检测到的属性`__init__`以及许多其他潜在错误。

我还建议编写单元测试并经常运行代码来检测这些类型的“whoopsie”编程错误。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-01-30T19:18:27.153

实例变量应该在类的`__init__()`方法中初始化。（一般来说）

如果那是不可能的。您可以使用`__dict__`在运行时获取对象的所有实例变量的字典。如果您确实需要在文档中跟踪这一点，请将您正在使用的实例变量列表添加到类的文档字符串中。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-30T18:50:16.230

听起来您在谈论实例变量而不是类变量。请注意，在以下代码中，a 是类变量，b 是实例变量。

```
class foo:
  a = 0 #class variable

  def __init__(self):
    self.b = 0 #instance variable 
```

关于假设您创建一个不需要的实例变量，因为另一个实例变量大约有一千行：最好的解决方案是不要有一千行长的类。如果您无法避免冗长，那么您的课程应该有一个明确的目的，这将使您能够一次将所有复杂性放在脑海中。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-30T19:36:39.257

诸如[Epydoc](http://epydoc.sourceforge.net/)之类的文档生成系统可用作对象具有哪些实例/类变量的参考，如果您担心通过拼写错误意外创建新变量，您可以使用[PyChecker](http://pychecker.sourceforge.net/)来检查您的代码。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2009-01-31T06:45:25.600

这是我从许多来自 C、C++ 或其他预先声明变量的静态类型语言的程序员那里听到的常见问题。事实上，当我们说服组织中的程序员放弃 C 语言而使用高级程序并改用 Python 时，这是我们听到的最大担忧之一。

理论上，是的，您可以随时向对象添加实例变量。是的，它可能是由拼写错误等引起的。在实践中，它很少会导致错误。当它发生时，通常不难找到错误。

只要你的类没有臃肿（1000 行是相当大的！）并且你有足够的单元测试，你应该很少遇到真正的问题。如果你这样做了，几乎任何时候都可以很容易地进入 Python 控制台并根据需要进行检查。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2009-01-31T07:31:21.903

在我看来，这里的主要问题是当你在 python 中工作时，你正在考虑 C++。

无论如何，在 python 中拥有一个 1000 行的类并不是一件非常明智的事情，（我知道它在 C++ 中经常发生），

学习利用 python 赋予你的活力，例如，你可以以非常有创意的方式组合列表和字典，并为你自己节省数百行无用的代码。

例如，如果您将字符串映射到函数（用于调度），您可以利用函数是第一类对象并且具有如下字典的事实：

```
d = {'command1' : func1, 'command2': func2, 'command3' : func3}
#then somewhere else use this list to dispatch
#given a string `str`
func = d[str]
func() #call the function! 
```

在 C++ 中这样的事情会占用很多代码行！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-30T18:35:43.637

最简单的是使用 IDE。PyDev 是一个 Eclipse 插件。

我不是所有方面的pythonic专家，但一般来说，我在python中的类定义下定义我的类成员，所以如果我添加成员，它们都是相对的。

我个人的意见是，出于这个特定原因，应该在一个部分中声明班级成员。

局部范围的变量 otoh 应该在最接近使用它们的时候定义（除了在 C 中——我相信它仍然需要在方法的开头声明变量）。

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2009-01-30T19:56:27.983

考虑使用[**插槽**](http://docs.python.org/reference/datamodel.html#id3)。

例如：

```
   Foo类：
     __slots__ = "ab c".split()
   x = Foo()
   xa =1 # 好的
   xb =1 # 好的
   xc =1 # 好的
   x.bb = 1 # 将引发“AttributeError: Foo instance has no attribute 'bb'”

```

在任何动态编程语言（任何不需要变量声明的语言）中，通常都会担心变量名中的拼写错误会创建一个新变量，而不是引发异常或导致编译时错误。插槽对实例变量有帮助，但对模块范围变量、全局变量、局部变量等没有帮助。对此没有灵丹妙药；这是不必声明变量的权衡的一部分。

# wpf - 在 Xaml 中动态调整窗口大小

> ID：496583
> 
> 赞同：11
> 
> 时间：2009-01-30T18:21:27.287
> 
> 标签：wpf, xaml, resize, window

有没有办法让我的 WPF 应用程序的窗口随内容动态调整大小？我尝试将宽度和高度设置为自动，但不行。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-30T18:45:25.457

在窗口上设置 SizeToContent="WidthAndHeight" ，窗口将根据其内容大小动态调整大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-02T18:23:12.920

使用像 Grid 这样的可调整大小的控件，并将所有控件放在行/列中。还要为 Grid 内的每个控件设置 Horizo​​ntalAlignment 以拉伸。

# java - Disinheriting(?) / 覆盖 .ToString 以访问 COM 对象 .toString

> ID：496591
> 
> 赞同：1
> 
> 时间：2009-01-30T18:23:48.870
> 
> 标签：java, .net, com, tostring

我有一个通过 COM 在 VB.NET 中访问的 java 库。java 端的对象公开了我调试所需的非平凡 .toString 方法。不幸的是，当我在 COM 对象上调用 .toString 时，调用被 Object 类的 .ToString 函数拦截。

如何强制调用 COM 端 .toString 并防止 Object.ToString 触发？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-01T20:55:44.087

您是否有权访问 java 对象的 IDL？您是否为 COM 对象生成运行时可调用包装器？

我认为您应该更改互操作程序集或手动生成包装器以将 toString() 方法更改为 toStringJava() 或 to_String() 或其他不与 object.ToString() 的语法冲突的东西。[这是 MSDN 上自定义运行时可调用包装器的起点。](http://msdn.microsoft.com/en-us/library/e753eftz.aspx)

# iphone - iPhone 相机图像作为 OpenGL ES 纹理

> ID：496599
> 
> 赞同：2
> 
> 时间：2009-01-30T18:26:38.397
> 
> 标签：iphone, opengl-es, camera, texture-mapping

是否可以将 iPhone 相机拍摄的图像用作纹理，然后在 OpenGL ES 中进行操作（旗波效果等）？主要问题是 iPhone 屏幕的尺寸为 320x480（无状态栏），因此图像不会具有 2 次方的尺寸。主要选项是将其复制到 512x512 纹理并调整顶点吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T18:34:18.430

是的，这就是这样做的方法。

只需使用更大的纹理。这是浪费内存，但不幸的是没有办法解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-11-05T15:47:17.273

另一种方法是将图片分成长度和高度为 32 像素的正方形（也称为平铺），从而形成 15x8 的平铺。然而，在绘制时显示它会涉及许多纹理切换，这可能会成为瓶颈。另一方面，使用平铺方法可以节省大量内存。

# .net - 调查网络应用程序

> ID：496624
> 
> 赞同：2
> 
> 时间：2009-01-30T18:32:36.153
> 
> 标签：.net, survey

是否有任何（最好是开源或成本）Web 控件可用于 .NET 环境中的调查管理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T19:04:53.267

ASP.NET 站点有几个选项：

[http://www.asp.net/community/control-gallery/browse.aspx?category=44](http://www.asp.net/community/control-gallery/browse.aspx?category=44)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-31T00:52:28.183

DotNetNuke 带有它自己的一系列调查组件，包括一个非常基本的开箱即用的组件。不过，对于一次性要求来说，这是一个很大的安装/框架。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T19:47:44.147

曾经有一个免费的开源调查产品，叫做 nsurvey。我看到仍然有链接，但我不是 100% 确定该项目仍在运行。

[http://www.theserverside.net/news/thread.tss?thread_id=33070](http://www.theserverside.net/news/thread.tss?thread_id=33070)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-04-29T16:12:30.667

试用surveymonkey 或ClassApps SelectSurvey (.NET)

[http://www.classapps.com/](http://www.classapps.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-03-26T14:31:06.923

Codeplex 上的 WebSurvey： [http ://websurvey.codeplex.com/](http://websurvey.codeplex.com/)

# sql-server - sqlserver 排序规则是否意味着列名必须是正确的大小写？以及如何处理

> ID：496628
> 
> 赞同：3
> 
> 时间：2009-01-30T18:33:54.547
> 
> 标签：sql-server, sql-server-2005, collation, case-sensitive

在 SQL Server（2000 或 2005）中，是否可以设置数据库或服务器排序规则，以便标识符名称（表、列等）需要使用正确的大小写？如果是这样，所有区分大小写的排序规则都是如此，还是单独设置？（我一直认为区分大小写适用于数据，而不是对象名称）。

如果应用程序存储的过程和查询不是以一致的大小写编写的，大概这会破坏应用程序？有没有办法处理这个问题而不必确保所有查询都使用正确的大小写，例如设置数据库连接的排序规则？

我从现有应用程序的角度来看待这个问题，该应用程序中可能包含不一致的大小写 sql 代码，并且我希望能够针对具有不同排序规则的数据库运行它。我需要哪些设置或哪些数据库/服务器排序规则不能与应用程序一起使用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T19:22:56.007

排序规则决定了您的查询是否不区分大小写。因此，确保您的架构适用于多种环境的唯一方法是让您的查询区分大小写。如果您的查询不一致，那么您的排序规则必须不区分大小写，否则它将不起作用。

[http://msdn.microsoft.com/en-us/library/aa174903(SQL.80).aspx](http://msdn.microsoft.com/en-us/library/aa174903(SQL.80).aspx)

需要注意的一点是，一旦您使用某种排序规则设置了 SQL Server 环境，您就不能在不创建新的 SQL Server 实例的情况下更改它。所以不区分大小写通常是要走的路。然后努力使您的查询保持一致。

我相信，一旦设置了排序规则，它就适用于数据和元数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T19:34:17.823

排序规则在 SQL Server 的早期版本中设置，但在 2005 年及以后版本中，您可以在创建对象时按对象更改它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T20:34:49.933

数据库默认排序规则确定数据库中的对象是否在查询中以区分大小写的方式处理 - 这适用于所有对象名称：表、列等。

如果您的应用程序代码来自不区分大小写的排序规则数据库，则如果对象被错误引用，它可能无法在区分大小写的排序规则数据库上运行（当您尝试运行语句或创建存储过程时会收到一条消息，或者在存储过程架构，除非你有大量的动态 SQL，否则你会很快捕捉到所有这些）。

请记住，即使您的代码运行，也可以使用与数据库不同的排序规则设置各个列，因此使用不同的排序规则，您的代码总是可能出现意外行为（例如，GROUP BY 的行为不同）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T18:36:48.363

您可以为每个对象设置排序规则，也可以为数据库和服务器设置默认值。

如何处理？您需要在这里执行标准。你可以很容易地让自己与不同的人用不同的案例纠缠在一起。

排序规则也适用于数据，所以 "bob" != "Bob"

# c# - 是否可以记录谁启动或停止了 Windows 服务？

> ID：496632
> 
> 赞同：23
> 
> 时间：2009-01-30T18:34:20.240
> 
> 标签：c#, windows-services

我有一些用 C# 编写的 Windows 服务。当有人停止或启动服务时，我希望能够确定是谁并记录该信息。

我尝试了日志记录`Environment.UserName`，但即使在我的本地机器上也会评估为 SYSTEM 。

此外，目前这些服务都在 Windows 2000 服务器上运行。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-30T18:44:17.583

在系统选项卡上的事件查看器（控制面板 | 管理工具 | 事件查看器）中，服务控制管理器记录谁启动和停止每个事件。我刚刚自己测试了这个并查看了结果。这让我想到两件事：

1.  当这些事件发生时，您可能能够从服务控制管理器中查询或挂钩这些事件，或者
2.  您绝对可以只查询事件查看器的“系统”日志来为您的服务查找这些事件。

希望这会引导您找到解决方案。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2018-11-14T03:39:09.267

*   您可以通过服务控制管理器过滤系统事件日志 [![在此处输入图像描述](https://i.stack.imgur.com/xpcxp.png)](https://i.stack.imgur.com/xpcxp.png)

事件 ID 7040 - 涵盖服务启动类型更改（例如禁用、手动、自动）

事件 ID 7036 - 涵盖服务启动/停止

[![在此处输入图像描述](https://i.stack.imgur.com/NnxBw.png)](https://i.stack.imgur.com/NnxBw.png)

对于其他拥有 PowerShell 的人，您可以使用以下命令：

```
get-eventlog -source "Service Control manager" -LogName System | select message, timegenerated, username | Out-GridView 
```

[![在此处输入图像描述](https://i.stack.imgur.com/kty7S.png)](https://i.stack.imgur.com/kty7S.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-03-26T08:31:50.963

您可以根据本文启用审核

[http://windowsitpro.com/systems-management/access-denied-auditing-users-who-might-be-starting-and-stopping-services](http://windowsitpro.com/systems-management/access-denied-auditing-users-who-might-be-starting-and-stopping-services)

此外，在 OnStop() 方法中提醒自己电子邮件可能是个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T18:38:18.703

应该是没有办法了。您在环境用户处获得的任何正常 .NET 方式都将返回运行服务所使用凭据的用户（通常是 SYSTEM、LOCAL SERVICE、NETWORK SERVICE 等）。

我可能会这样做是轮询系统以查看用户是否已登录，并假设用户已登录。当然，这会打折那些由于某种原因被系统关闭的服务（可能你的服务不会），并且只能在多个用户同时登录的情况下帮助你缩小范围（但是，你可以始终记录它们）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-16T09:09:26.387

1.  只需打开事件查看器（开始菜单 -> 搜索“事件”事件查看器就会出现，打开它）
2.  展开事件查看器左侧菜单上的“Windows 日志”。
3.  单击应用程序。（它将在“常规”选项卡中显示您的应用程序错误和描述。
4.  再次尝试启动您的服务，并从事件查看器查看在“常规”选项卡中短暂停止的确切原因。

# windows - 是否有适用于 Windows 的 Glade3 安装程序？

> ID：496635
> 
> 赞同：3
> 
> 时间：2009-01-30T18:34:34.683
> 
> 标签：windows, installation, gtk, glade

我下载的文件：

[http://downloads.sourceforge.net/gladewin32/glade-3.4.3-win32-1.zip](http://downloads.sourceforge.net/gladewin32/glade-3.4.3-win32-1.zip)

当我从 /bin 文件夹中提取运行 glade-3.exe 时，出现“no libxml2.dll”错误。

现在，我想找到安装glade3的安装程序（如[GTK+ 的GTK+ 包](http://ftp.gnome.org/pub/gnome/binaries/win32/gtk+/2.14/gtk+-bundle_2.14.7-20090119_win32.zip)）以及它对Windows XP 的**所有依赖项。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T20:09:51.590

下载后，glade3 对我有用：

*   图标v.dll
*   libxml2.dll

并将其放在路径中

这不是答案，但它可以帮助运行它。

另一件事。我之前安装了 GTK+ 包，所以如果你不这样做，你可能需要更多的 dll 等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-05-14T10:35:12.647

[仅作记录，http: //downloads.sourceforge.net/gladewin32/](http://downloads.sourceforge.net/gladewin32/)上提供的较新版本是一个已经包含 libxml 的安装程序。

# internet-explorer-7 - IE7 的 Internet Developer Toolbar 是否有替代品？

> ID：496640
> 
> 赞同：6
> 
> 时间：2009-01-30T18:35:43.467
> 
> 标签：internet-explorer-7

有谁知道我可以用于 dom 浏览和 css 调试的 IE7 **[Internet Developer Toolbar的替代品？](http://www.microsoft.com/downloads/details.aspx?familyid=E59C3964-672D-4511-BB3E-2D5E1DB91038&displaylang=en)**我过去使用过 Firebug，相比之下 IDT 似乎很乏力。它似乎也使我的浏览器崩溃了很多。

或者：IE7 的 IDT 是否改进到几乎与 Firebug 一样好？

更新：写完这篇文章后不久，我开始使用开发者工具栏。嗯，这是一个强有力的术语。我*尝试*使用它。它根本不起作用。具体来说，我需要通过单击选择元素，它不会做任何该死的事情。即使重新启动 IE7，所有菜单选项也会变灰。幸好我问了这个问题，看起来 IDT 和我记得的一样有问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T18:40:58.477

[Debug Bar](http://www.debugbar.com/)很不错，而且是免费供个人使用的。如果在商业上使用，您必须为此付费。

**更新：**我应该补充一点，当有一些相当先进的 javascript 时，它确实崩溃了一次或两次。没有杀死整个浏览器，但工具栏在我重新启动 IE 之前变得无用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T18:58:52.887

查看 Firebug Lite： http: [//getfirebug.com/lite.html](http://getfirebug.com/lite.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T18:41:59.677

IE7没有。但是IE8有。Beta 2 和 RC1 中包含的开发人员工具非常非常好。远高于萤火虫的水平。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T18:43:50.033

检查并查看您是否拥有最新版本的工具栏。我曾经使用过我现在使用的版本之前的版本，而旧版本确实使 IE7 崩溃了很多。

就功能而言，了解您认为自己缺少什么会有所帮助。拥有很多功能与拥有很多您使用的功能不同。

# cocoa - 在 Interface Builder 中保留窗口位置

> ID：496645
> 
> 赞同：5
> 
> 时间：2009-01-30T18:36:51.747
> 
> 标签：cocoa, xcode, interface-builder

有没有办法在 Interface Builder 中保留窗口位置？每次我重新打开一个 nib 文件时，MainWindow.xib 窗口都会回到屏幕的左上角，位于包含我正在布局的界面的窗口后面。每次将它移回我之前的位置开始让我感到紧张。似乎应该有一个简单的方法来做到这一点，但如果有的话我还没有找到它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-05-20T16:36:30.323

Interface Builder 不会在每个 nib 的基础上保存窗口位置/大小，但它会自动记住最后一个 nib 窗口的大小和位置，并在打开未来的 nib 文件时使用它。例如，如果我打开 nib 文件 A，更改其窗口位置，然后退出 IB，然后打开 nib 文件 B，它的 nib 窗口显示的位置/大小与我为 nib 文件 A 设置的位置/大小相同。

但是，当您打开它们时，Interface Builder 似乎还会将多个窗口向下和向右轻微级联，因此第二个 nib 文件的窗口不会直接出现在已经打开的窗口之上 - 这是有道理的。问题似乎是，如果您的 nib 窗口一直位于屏幕底部，因此没有足够的空间来打开下一个 nib 窗口，则会导致窗口一直位于屏幕的顶部屏幕。当然，一旦发生这种情况，IB 会将该窗口位置记住为默认位置，因此后续窗口也会在屏幕顶部打开。

因此，“解决方案”是 a) 在 Bug Reporter 上提交增强请求以记住每个 nib 窗口的位置 :-)，并且 b) 同时注意将窗口定位得太靠近屏幕底部。

# javascript - 页面中脚本标记的位置如何影响其中定义的 JavaScript 函数？

> ID：496646
> 
> 赞同：45
> 
> 时间：2009-01-30T18:36:59.360
> 
> 标签：javascript, html, function, tags

我读到您应该在`<head>`标签中定义您的 JavaScript 函数，但是`<script>`（无论是在`<head>`、`<body>`或任何其他标签中）的位置如何影响 JavaScript 函数。

具体来说，它如何影响函数的范围以及您可以从哪里调用它？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-02-03T06:10:38.163

告诉人们`<SCRIPT>`只在头脑中添加**听起来**是一件合理的事情，但正如其他人所说，不推荐甚至不实用的原因有很多——主要是速度和动态生成 HTML 页面的方式。

这就是[HTML 4 规范所说](http://www.w3.org/TR/REC-html40/interact/scripts.html)的：

> SCRIPT 元素将脚本放置在文档中。这个元素可以在 HTML 文档的 HEAD 或 BODY 中出现任意次数。

还有一些示例 HTML。这里的格式看起来不是很漂亮吗:)

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
     "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
<HEAD>
<TITLE>A document with SCRIPT</TITLE>
<META http-equiv="Content-Script-Type" content="text/tcl">
<SCRIPT type="text/vbscript" src="http://someplace.com/progs/vbcalc">
</SCRIPT>
</HEAD>
<BODY>
<SCRIPT type="text/javascript">
...some JavaScript...
</SCRIPT>
</BODY>
</HTML> 
```

[在HTML 5](http://www.w3schools.com/tags/html5_script.asp)中值得期待的东西：

中的新异步属性`<SCRIPT>`：

> 注意：有一些方法可以执行脚本：
> 
> async 属性为“true”：脚本将与页面的其余部分异步执行，因此脚本将在页面继续解析时执行。
> 
> async 属性为“false”，但 defer 属性为“true”：当页面完成解析时，将执行脚本。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-01-30T20:24:18.690

正常的比赛规则仍然有效；在定义之前不要使用东西。:)

另外，请注意“将所有内容放在底部”的建议并不是本书中*的*唯一规则——在某些情况下它可能不可行，而在其他情况下，将脚本放在其他地方可能更有意义。

将脚本放在文档底部的主要原因是为了提高性能，与其他 HTTP 请求不同，脚本不会并行加载，这意味着它们会减慢页面其余部分的加载速度。将脚本放在底部的另一个原因是您不必使用任何“DOM 就绪”函数。由于脚本标签位于所有元素下方，因此 DOM 将准备好进行操作！

编辑：阅读：http: [//developer.yahoo.com/performance/rules.html#js_bottom](http://developer.yahoo.com/performance/rules.html#js_bottom)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-30T18:43:02.123

安置的一个方面是性能。请参阅[YSlow 讨论中的这篇精彩文章，](http://developer.yahoo.com/yslow/)了解为什么有时建议您将它们放在文档的底部。

至于范围问题，据我所知，Javascript 的常见可见性规则（在函数内部或外部定义的变量、本地、全局、闭包等）不受影响。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-05-11T12:38:32.533

脚本标签的位置确实很重要。如果将函数与文档元素绑定，则必须先加载文档元素，然后才能实现函数。假设 getTeachers() 是 getTeachers.js 文件中的函数。这会给你一个错误：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Unit Teachers</title>
<head>
 <script type="text/javascript" src="getTeachers.js"></script>
 <script type="text/javascript">
document.getElementById("buttonId").onclick=function(){getResults()};

</script>
 </head>
 <body>
 <form>
 <input type = "button" id="buttonId" value = "Press for Results"  /><br />
 </form>

<span id="results" /></span>
</body>
</html> 
```

它在 head 首次加载之前给出错误，并且找不到指定 id 的元素。下面的代码是更正：

```
<html xmlns="http://www.w3.org/1999/xhtml">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Unit Teachers</title>
<head>
 <script type="text/javascript" src="getTeachers.js"></script>

 </head>
 <body>
 <form>
 <input type = "button" id="buttonId" value = "Press for Results"  /><br />
 </form>
<script type="text/javascript">
document.getElementById("buttonId").onclick=function(){getResults()};

</script>
<span id="results" /></span>
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-30T18:43:48.287

如果您的脚本引用了页面上的一个 ID 并且该页面尚未呈现（即脚本在 HTML 之前，或者您的脚本是使用 onload 执行的，而不是 DOM 已准备好），您也会收到错误消息。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-30T18:39:47.997

它没有。大多数编程框架将脚本分散在整个页面中。因此，我很少看到问题（并且仅来自较旧的浏览器）。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2011-04-29T18:45:06.750

如果您像 Diodeus 所说的那样通过 XMLHttpRequest 引入 Javascript，它可能无法正常工作。就我而言，没有错误，浏览器只是忽略了新脚本。

我最终使用了这个，不是非常优雅，但到目前为止对我有用：

[http://zeta-puppis.com/2006/03/07/javascript-script-execution-in-innerhtml-the-revenge/](http://zeta-puppis.com/2006/03/07/javascript-script-execution-in-innerhtml-the-revenge/)

如何使用 execJS：http: [//zeta-puppis.com/2006/02/23/javascript-script-execution-in-innerhtml/](http://zeta-puppis.com/2006/02/23/javascript-script-execution-in-innerhtml/)

注意：注意`&lt;`这一行：`for(var i=0;i<st.length; i++)`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-30T18:39:16.470

如果你有一个内联脚本（外部函数）位于它可能调用的函数之前，你可能会收到一个错误，因为它们可能还不可用。并不是说它总是会发生，只是它可能取决于浏览器类型或版本。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2009-01-30T18:46:37.610

Javascript 的作用域规则类似于 perl - 您可以在当前或任何更高的作用域级别调用任何函数。唯一的限制是该函数必须在您调用它时定义。源中的位置无关紧要——只有时间位置很重要。

如果可能，您应该避免将脚本放入其中`<head>`，因为它会减慢页面显示速度（请参阅 Alan 发布的链接）。

# java - 连接到需要使用 Java 进行身份验证的远程 URL

> ID：496651
> 
> 赞同：135
> 
> 时间：2009-01-30T18:38:33.663
> 
> 标签：java, httpurlconnection

如何连接到需要身份验证的 Java 中的远程 URL。我正在尝试找到一种方法来修改以下代码，以便能够以编程方式提供用户名/密码，因此它不会抛出 401。

```
URL url = new URL(String.format("http://%s/manager/list", _host + ":8080"));
HttpURLConnection connection = (HttpURLConnection)url.openConnection(); 
```

* * *

## 回答 #1

> 赞同：141
> 
> 时间：2009-01-30T18:51:15.743

您可以为 http 请求设置默认身份验证器，如下所示：

```
Authenticator.setDefault (new Authenticator() {
    protected PasswordAuthentication getPasswordAuthentication() {
        return new PasswordAuthentication ("username", "password".toCharArray());
    }
}); 
```

此外，如果您需要更大的灵活性，您可以查看[Apache HttpClient](http://hc.apache.org/httpclient-3.x/)，它将为您提供更多的身份验证选项（以及会话支持等）

* * *

## 回答 #2

> 赞同：139
> 
> 时间：2011-02-28T01:42:29.887

有一个原生且侵入性较小的替代方案，仅适用于您的呼叫。

```
URL url = new URL(“location address”);
URLConnection uc = url.openConnection();
String userpass = username + ":" + password;
String basicAuth = "Basic " + new String(Base64.getEncoder().encode(userpass.getBytes()));
uc.setRequestProperty ("Authorization", basicAuth);
InputStream in = uc.getInputStream(); 
```

* * *

## 回答 #3

> 赞同：81
> 
> 时间：2012-09-26T14:08:25.557

您还可以使用以下内容，不需要使用外部包：

```
URL url = new URL(“location address”);
URLConnection uc = url.openConnection();

String userpass = username + ":" + password;
String basicAuth = "Basic " + javax.xml.bind.DatatypeConverter.printBase64Binary(userpass.getBytes());

uc.setRequestProperty ("Authorization", basicAuth);
InputStream in = uc.getInputStream(); 
```

* * *

## 回答 #4

> 赞同：46
> 
> 时间：2012-10-29T13:00:12.447

如果您在协议和域之间输入用户名和密码时使用正常登录，这更简单。它也适用于登录和不登录。

示例网址： [http://user:pass@domain.com/url](http://user:pass@domain.com/url)

```
URL url = new URL("http://user:pass@domain.com/url");
URLConnection urlConnection = url.openConnection();

if (url.getUserInfo() != null) {
    String basicAuth = "Basic " + new String(new Base64().encode(url.getUserInfo().getBytes()));
    urlConnection.setRequestProperty("Authorization", basicAuth);
}

InputStream inputStream = urlConnection.getInputStream(); 
```

请在 valerybodak 的评论中注意它是如何在 Android 开发环境中完成的。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2014-12-06T10:42:41.373

当我来到这里寻找 Android-Java-Answer 时，我将做一个简短的总结：

1.  使用[James van Huis](https://stackoverflow.com/a/496707)所示的*java.net.Authenticator*
2.  使用*Apache Commons HTTP Client*，如[this Answer](https://stackoverflow.com/a/24071189)
3.  使用基本的*java.net.URLConnection*并手动设置 Authentication-Header，如下[所示](https://stackoverflow.com/a/5137446)

如果您想在**Android中使用***java.net.URLConnection*和基本身份验证，请尝试以下代码：

 **```
URL url = new URL("http://www.mywebsite.com/resource");
URLConnection urlConnection = url.openConnection();
String header = "Basic " + new String(android.util.Base64.encode("user:pass".getBytes(), android.util.Base64.NO_WRAP));
urlConnection.addRequestProperty("Authorization", header);
// go on setting more request headers, reading the response, etc 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2019-03-26T18:53:20.113

能够使用 HttpsURLConnection 设置身份验证

```
 URL myUrl = new URL(httpsURL);
            HttpsURLConnection conn = (HttpsURLConnection)myUrl.openConnection();
            String userpass = username + ":" + password;
            String basicAuth = "Basic " + new String(Base64.getEncoder().encode(userpass.getBytes()));
            //httpsurlconnection
            conn.setRequestProperty("Authorization", basicAuth); 
```

从这篇文章中获取的更改很少。Base64 来自 java.util 包。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-06-05T22:23:34.403

小心使用“Base64().encode()”方法，我和我的团队遇到了 400 个 Apache 错误请求问题，因为它在生成的字符串末尾添加了一个 \r\n。

由于 Wireshark，我们发现它可以嗅探数据包。

这是我们的解决方案：

```
import org.apache.commons.codec.binary.Base64;

HttpGet getRequest = new HttpGet(endpoint);
getRequest.addHeader("Authorization", "Basic " + getBasicAuthenticationEncoding());

private String getBasicAuthenticationEncoding() {

        String userPassword = username + ":" + password;
        return new String(Base64.encodeBase64(userPassword.getBytes()));
    } 
```

希望能帮助到你！

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2017-05-29T07:58:00.860

使用此代码进行基本身份验证。

```
URL url = new URL(path);
String userPass = "username:password";
String basicAuth = "Basic " + Base64.encodeToString(userPass.getBytes(), Base64.DEFAULT);//or
//String basicAuth = "Basic " + new String(Base64.encode(userPass.getBytes(), Base64.No_WRAP));
HttpURLConnection urlConnection = (HttpURLConnection)url.openConnection();
urlConnection.setRequestProperty("Authorization", basicAuth);
urlConnection.connect();
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2018-01-01T15:48:33.130

对于您无法控制打开连接的代码的情况，我想提供一个答案。就像我使用`URLClassLoader`从受密码保护的服务器加载 jar 文件时所做的那样。

该`Authenticator`解决方案可以工作，但缺点是它首先尝试在没有密码的情况下访问服务器，并且只有在服务器要求输入密码后才提供密码。如果您已经知道服务器需要密码，那将是不必要的往返。

```
public class MyStreamHandlerFactory implements URLStreamHandlerFactory {

    private final ServerInfo serverInfo;

    public MyStreamHandlerFactory(ServerInfo serverInfo) {
        this.serverInfo = serverInfo;
    }

    @Override
    public URLStreamHandler createURLStreamHandler(String protocol) {
        switch (protocol) {
            case "my":
                return new MyStreamHandler(serverInfo);
            default:
                return null;
        }
    }

}

public class MyStreamHandler extends URLStreamHandler {

    private final String encodedCredentials;

    public MyStreamHandler(ServerInfo serverInfo) {
        String strCredentials = serverInfo.getUsername() + ":" + serverInfo.getPassword();
        this.encodedCredentials = Base64.getEncoder().encodeToString(strCredentials.getBytes());
    }

    @Override
    protected URLConnection openConnection(URL url) throws IOException {
        String authority = url.getAuthority();
        String protocol = "http";
        URL directUrl = new URL(protocol, url.getHost(), url.getPort(), url.getFile());

        HttpURLConnection connection = (HttpURLConnection) directUrl.openConnection();
        connection.setRequestProperty("Authorization", "Basic " + encodedCredentials);

        return connection;
    }

} 
```

这将注册一个新协议，当添加凭据时该协议`my`将被替换。`http`因此，在创建新的时`URLClassLoader`只需替换`http`为`my`，一切都很好。我知道`URLClassLoader`提供了一个构造函数，`URLStreamHandlerFactory`但如果 URL 指向 jar 文件，则不使用此工厂。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-07-19T11:22:58.843

从 Java 9 开始，您可以这样做

```
URL url = new URL("http://www.example.com");
HttpURLConnection connection = (HttpURLConnection)url.openConnection();
connection.setAuthenticator(new Authenticator() {
    protected PasswordAuthentication getPasswordAuthentication() {
        return new PasswordAuthentication ("USER", "PASS".toCharArray());
    }
}); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2018-04-05T07:57:23.290

我是这样做的，您需要这样做，只需复制粘贴就可以了

```
 HttpURLConnection urlConnection;
    String url;
 //   String data = json;
    String result = null;
    try {
        String username ="danish.hussain@gmail.com";
        String password = "12345678";

        String auth =new String(username + ":" + password);
        byte[] data1 = auth.getBytes(UTF_8);
        String base64 = Base64.encodeToString(data1, Base64.NO_WRAP);
        //Connect
        urlConnection = (HttpURLConnection) ((new URL(urlBasePath).openConnection()));
        urlConnection.setDoOutput(true);
        urlConnection.setRequestProperty("Content-Type", "application/json");
        urlConnection.setRequestProperty("Authorization", "Basic "+base64);
        urlConnection.setRequestProperty("Accept", "application/json");
        urlConnection.setRequestMethod("POST");
        urlConnection.setConnectTimeout(10000);
        urlConnection.connect();
        JSONObject obj = new JSONObject();

        obj.put("MobileNumber", "+97333746934");
        obj.put("EmailAddress", "danish.hussain@mee.com");
        obj.put("FirstName", "Danish");
        obj.put("LastName", "Hussain");
        obj.put("Country", "BH");
        obj.put("Language", "EN");
        String data = obj.toString();
        //Write
        OutputStream outputStream = urlConnection.getOutputStream();
        BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(outputStream, "UTF-8"));
        writer.write(data);
        writer.close();
        outputStream.close();
        int responseCode=urlConnection.getResponseCode();
        if (responseCode == HttpsURLConnection.HTTP_OK) {
            //Read
        BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(urlConnection.getInputStream(), "UTF-8"));

        String line = null;
        StringBuilder sb = new StringBuilder();

        while ((line = bufferedReader.readLine()) != null) {
            sb.append(line);
        }

        bufferedReader.close();
        result = sb.toString();

        }else {
        //    return new String("false : "+responseCode);
        new String("false : "+responseCode);
        }

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    } catch (JSONException e) {
        e.printStackTrace();
    } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2016-12-15T23:04:18.030

**ANDROD 实现** 一种从 Web 服务请求数据/字符串响应的完整方法，请求使用用户名和密码进行授权

```
public static String getData(String uri, String userName, String userPassword) {
        BufferedReader reader = null;
        byte[] loginBytes = (userName + ":" + userPassword).getBytes();

        StringBuilder loginBuilder = new StringBuilder()
                .append("Basic ")
                .append(Base64.encodeToString(loginBytes, Base64.DEFAULT));

        try {
            URL url = new URL(uri);
            HttpURLConnection connection = (HttpURLConnection) url.openConnection();
            connection.addRequestProperty("Authorization", loginBuilder.toString());

            StringBuilder sb = new StringBuilder();
            reader = new BufferedReader(new InputStreamReader(connection.getInputStream()));
            String line;
            while ((line = reader.readLine())!= null){
                sb.append(line);
                sb.append("\n");
            }

            return  sb.toString();

        } catch (Exception e) {
            e.printStackTrace();
            return null;
        } finally {
            if (null != reader){
                try {
                    reader.close();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }
        }
    } 
```

# c# - 在 C# 和 DB 中创建 Guid 键的区别

> ID：496655
> 
> 赞同：12
> 
> 时间：2009-01-30T18:39:50.853
> 
> 标签：c#, sql, guid

我们使用 Guid 作为数据库中实体的主键。传统上，我们遵循让数据库在插入期间为实体设置 ID 的模式，我认为主要是因为这通常是您使用自动增量字段或其他方式处理事情的方式。

我越来越发现在对象构造期间在代码中进行键分配要方便得多，主要原因有两个：

1.  您知道，一旦对象的构造函数运行，它的所有字段都已初始化。您永远不会有“半生不熟”的物体在四处乱窜。
2.  如果您需要执行一批操作，其中一些操作取决于知道对象的键，您可以一次完成所有操作，而无需往返数据库。

有什么令人信服的理由*不*这样做吗？也就是说，当使用 Guid 作为键时，是否有充分的理由将键分配留给数据库？

**编辑：** 很多人对是否应该将Guids用于PK（我知道）有强烈的意见，但这并不是我问题的重点。

除了集群问题（如果您正确设置索引，这似乎不是问题），我还没有看到避免在应用程序层创建键的令人信服的理由。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T18:44:44.087

我认为通过在客户端创建它们你做得很好。正如您所提到的，如果您让数据库这样做，您必须找到某种方法（真的想不出任何方法）来获取该密钥。如果您使用的是身份，则可以使用调用来获取为表创建的最新身份，但我不确定是否存在这样的 guid。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T18:44:53.087

通过在 C# 中执行此操作，您可能会冒重新分配 GUID 并将其保存回数据库的风险。通过让数据库负责它，您可以保证此 PK 不会更改，也就是说，如果您设置了适当的约束。话虽如此，您可以在 C# 代码中设置类似的约束，以防止在分配唯一 id 后更改它，但是您必须在所有应用程序中执行相同的操作......在我看来，在 C# 中使用它听起来比数据库更需要维护，因为数据库已经内置了防止更改主键的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T21:07:26.343

有趣的问题。

传统上，我也使用数据库分配的 guid，但最近我正在开发一个 Windows Mobile 应用程序，而 SQL CE 数据库不允许使用 newguid，所以我不得不在代码中进行。

我使用 SQL 复制将数据从移动设备获取到服务器。在过去的 6 个月中，我有 40 个 SQL CE 客户端将超过 100000 条记录同步回 SQL 2005 服务器，没有一个丢失或重复的 guid。

所需的额外编码可以忽略不计，在插入之前了解 guid 的好处实际上减少了一些复杂性。

我没有进行任何性能检查，因此除了性能之外，我看不出有任何理由不按照您的建议实施 guid 处理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T18:45:16.317

GUID 对性能来说很糟糕

我会把它留在数据库中，特别是现在 SQL Server 有[NEWSEQUENTIALID()](http://msdn.microsoft.com/en-us/library/ms189786.aspx)不再导致插入页面拆分，因为值是随机的，创建的每个 NEWSEQUENTIALID 都将大于前一个......唯一的问题是它只能用作默认值

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T21:05:46.360

如果您必须在 GUI 之外进行插入（考虑从其他供应商导入数据或从您购买的公司导入数据并且必须与您的数据合并），则不会自动分配 GUID。这不是一个无法克服的问题，但仍然需要考虑。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-01-30T18:46:44.347

我让一个空的 Guid 指示该对象虽然已构建，但尚未插入（或从）数据库中检索。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T21:23:29.307

正如 SQLMenace 所指出的，标准 GUID 会对索引和分页产生负面影响。在 C# 中，您可以使用一点 P/Invoke 的乐趣来生成像 NEWSEQUENTIALID() 这样的顺序 GUID。

```
[DllImport("rpcrt4.dll", SetLastError = true)]
static extern int UuidCreateSequential(out Guid guid); 
```

这样，您至少可以继续使用 GUID，但在生成它们的方式和位置方面获得更大的灵活性。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T21:52:18.747

好的，是时候插话了。我会说生成的 GUID 客户端保存到数据库是最好的方法——前提是你碰巧使用 GUID 作为你的 PK，我只在一种情况下推荐：断开连接环境。

当您使用断开连接的模型进行数据传播（即 PDA/手机应用程序、用于有限连接场景的笔​​记本电脑应用程序等）时，作为 PK 生成客户端的 GUID 是最好的方法。

对于其他所有情况，使用自动增量身份 PK 可能会更好。

为什么？嗯，有几个原因。首先，通过使用跨行聚集 PK 索引，您确实获得了很大的性能提升。GUID PK 和聚集索引不能很好地配合使用——即使使用 NEWSEQUENTIALID，顺便说一下，我认为它完全忽略了 GUID 的意义。其次，除非您的情况迫使您不要这样做（即您必须使用断开连接的模型），否则您确实希望保持一切事务性并同时插入尽可能多的相互关联的数据。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-01-31T09:29:42.460

*除了集群问题（如果您正确设置索引，这似乎不是问题），*

作为索引的 GUID 总是非常混乱 - 没有“适当的”设置可以避免这种情况（除非您在 SQL Server 引擎中使用 NEWSEQUENTIALGUID 函数）。

恕我直言，最大的缺点是大小 - GUID 是 16 字节，INT 是 4。PK 不仅存储在主键树中，而且还存储在每个非聚集索引条目上。

有几千个条目，这可能不会有很大的不同 - 但如果您有一个包含数百万或数十亿个条目和几个非聚集索引的表，则使用 16 字节 GUID 与 4 字节 INT 作为 PK 可能会所需空间的巨大差异 - 在磁盘和 RAM 中。

马克

# iis - 使用 makecert 开发 SSL

> ID：496658
> 
> 赞同：55
> 
> 时间：2009-01-30T18:40:04.597
> 
> 标签：iis, ssl, makecert

这是我的情况：

我正在尝试创建一个 SSL 证书，该证书将安装在所有开发人员的机器上，以及两个内部服务器（一切都是非生产的）。

我需要做什么来创建可以安装在所有这些地方的证书？

现在我已经有了这些方面的东西，使用 Microsoft Visual Studio 8\SDK\v2.0\Bin 中的 makecert 应用程序：

```
makecert -r -pe -n "CN=MySite.com Dev" -b 01/01/2000 -e 01/01/2033 -eku 1.3.6.1.5.5.7.3.1 -ss Root -sr localMachine -sky exchange -sp "Microsoft RSA SChannel Cryptographic Provider" -sy 12 mycert.cer 
```

但是，我不确定如何将此 .cer 文件放在其他计算机上，并且当我将其安装在本地计算机 IIS 上时，每次通过 https: 访问页面时，我都会收到安全提示（即使在我'已经安装了证书）。有没有人这样做过？

* * *

## 回答 #1

> 赞同：140
> 
> 时间：2009-01-30T18:58:48.753

这是我执行此操作的脚本：

### 创建证书颁发机构

创建一个自签名证书 (-r)，使用可导出的私钥 (-pe)，使用 SHA1 (-r) 进行签名（-sky 签名）。私钥被写入文件 (-sv)。

```
makecert -r -pe -n "CN=My Root Authority" -ss CA -sr CurrentUser ^
         -a sha1 -sky signature -cy authority -sv CA.pvk CA.cer 
```

(^= 允许批处理命令行换行)

### 创建服务器证书

使用可导出的私钥 (-pe) 创建服务器证书，使用 SHA1 (-a) 进行密钥交换 (-sky exchange)。它可以用作 SSL 服务器证书（-eku 1.3.6.1.5.5.7.3.1）。颁发证书在文件 (-ic) 中，密钥 (-iv) 也是如此。使用特定的加密提供程序（-sp、-sy）。

```
makecert -pe -n "CN=fqdn.of.server" -a sha1 -sky Exchange ^
         -eku 1.3.6.1.5.5.7.3.1 -ic CA.cer -iv CA.pvk ^
         -sp "Microsoft RSA SChannel Cryptographic Provider" ^
         -sy 12 -sv server.pvk server.cer

pvk2pfx -pvk server.pvk -spc server.cer -pfx server.pfx 
```

然后，您可以在服务器应用程序中使用 .PFX 文件（或将其安装在 IIS 中）。请注意，默认情况下，**`pvk2pfx`不对输出 PFX 文件应用密码**。您需要为此使用`-po`开关。

要使您的所有客户端计算机都信任它，请将**CA.cer**安装在其证书存储区（在 Trusted Root Authorities 存储区中）。如果您在域中，则可以使用 Windows 组策略在全局范围内执行此操作。如果没有，您可以使用**certmgr.msc** MMC 管理单元或**certutil**命令行实用程序：

```
certutil -user -addstore Root CA.cer 
```

要以编程方式在 IIS 6.0 中安装证书，请查看[此 Microsoft 知识库文章](http://support.microsoft.com/?id=313624)。对于 IIS 7.0，我不知道。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2010-03-24T20:49:49.980

您应该`-cy authority`在创建证书颁发机构时添加开关，否则某些证书存储不会将其视为正确的 CA。

# c# - c#如何计算文本文件中的行数

> ID：496663
> 
> 赞同：10
> 
> 时间：2009-01-30T18:41:53.470
> 
> 标签：c#

这样做有什么问题吗？

```
int  i = new StreamReader("file.txt").ReadToEnd().Split(new char[] {'\n'}).Length 
```

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-01-30T18:49:36.853

您发布的方法不是特别好。让我们分开：

```
// new StreamReader("file.txt").ReadToEnd().Split(new char[] {'\n'}).Length
//     becomes this:
var file = new StreamReader("file.txt").ReadToEnd(); // big string
var lines = file.Split(new char[] {'\n'});           // big array
var count = lines.Count; 
```

您实际上将该文件保存在内存中两次：一次读取所有行，一次将其拆分为数组。垃圾收集器讨厌这样。

如果你喜欢一个衬里，你可以写`System.IO.File.ReadAllLines(filePath).Length`，但这仍然会在一个数组中检索整个文件。如果您不打算保留阵列，那么这样做是没有意义的。

更快的解决方案是：

```
int TotalLines(string filePath)
{
    using (StreamReader r = new StreamReader(filePath))
    {
        int i = 0;
        while (r.ReadLine() != null) { i++; }
        return i;
    }
} 
```

上面的代码在任何给定时间（最多）在内存中保存一行文本。只要线路相对较短，它就会很有效。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-01-30T18:44:27.050

好吧，这样做的问题是在大文件上执行此操作时会分配*大量*内存。

我宁愿逐行读取文件并手动增加一个计数器。这可能不是单行的，但它的内存效率更高。

或者，您可以以均匀大小的块加载数据并计算其中的换行符。这可能是最快的方法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-30T18:49:25.137

如果您正在寻找一个简短的解决方案，我可以给您一个单行，至少可以让您不必拆分结果：

```
int i = File.ReadAllLines("file.txt").Count; 
```

但这与将大文件读入内存的问题与原始文件相同。您真的应该使用流式阅读器并在阅读它们时计算换行符，直到到达文件末尾。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T18:45:37.533

当然 - 它将整个流读入内存。这很简洁，但我今天可以创建一个文件，但会失败。

一次读取一个字符并增加换行符的计数。

编辑 - 经过一些快速研究如果您想要简洁并想要那种闪亮的新通用感觉，请考虑一下：

```
public class StreamEnumerator : IEnumerable<char>
{
    StreamReader _reader;

    public StreamEnumerator(Stream stm)
    {
        if (stm == null)
            throw new ArgumentNullException("stm");
        if (!stm.CanSeek)
            throw new ArgumentException("stream must be seekable", "stm");
        if (!stm.CanRead)
            throw new ArgumentException("stream must be readable", "stm");

        _reader = new StreamReader(stm);
    }

    public IEnumerator<char> GetEnumerator()
    {
        int c = 0;
        while ((c = _reader.Read()) >= 0)
        {
            yield return (char)c;
        }
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }
} 
```

它定义了一个允许您枚举流的新类，那么您的计数代码可能如下所示：

```
StreamEnumerator chars = new StreamEnumerator(stm);
int lines = chars.Count(c => c == '\n'); 
```

它为您提供了一个简洁的 lambda 表达式来执行（或多或少）您想要的操作。

我还是更喜欢 Old Skool：

```
 public static int CountLines(Stream stm)
    {
        StreamReader _reader = new StreamReader(stm);
        int c = 0, count = 0;
        while ((c = _reader.Read()) != -1)
        {
            if (c == '\n')
            {
                count++;
            }
        }
        return count;
    } 
```

注意：Environment.NewLine 版本留给读者作为练习

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-08-05T15:01:08.170

这应该够了吧：

```
using System.Linq;

....

int i = File.ReadLines(file).Count(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-08-07T07:57:42.123

可能比这个？

```
string file = new StreamReader("YourFile.txt").ReadToEnd();
string[] lines = file.Split('\n');
int countOfLines = lines.GetLength(0)); 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2009-01-30T18:47:40.353

假设文件存在并且您可以打开它，这将起作用。

它不是很可读或安全...

# c++ - Linux 上的 C++ 动态共享库

> ID：496664
> 
> 赞同：184
> 
> 时间：2009-01-30T18:41:56.307
> 
> 标签：c++, linux, shared-libraries

[这是使用 g++ 进行动态共享库编译](https://stackoverflow.com/q/483797/1288)的后续。

我正在尝试在 Linux 上用 C++ 创建一个共享类库。我能够编译库，并且可以使用我在[此处](https://stackoverflow.com/questions/496664/c-dynamic-shared-library-on-linux/497067#497067)和[此处](https://rads.stackoverflow.com/amzn/click/com/0470147628)找到的教程调用一些（非类）函数。当我尝试使用库中定义的类时，我的问题就开始了。我链接到的第二个教程展示了如何加载符号以创建库中定义的类的对象，但没有*使用*这些对象来完成任何工作。

有谁知道创建共享 C++ 类库的更完整的教程，该教程还展示了如何在单独的可执行文件中*使用这些类？*一个非常简单的教程，展示了对象的创建、使用（简单的 getter 和 setter 就可以了），以及删除会很棒。说明使用共享类库的一些开放源代码的链接或引用也同样好。

* * *

尽管[codelogic](https://stackoverflow.com/q/483797/1288)和[nimrodm](https://stackoverflow.com/questions/496664/c-dynamic-shared-library-on-linux/497067#497067)的答案确实有效，但我只想补充一点，自从提出这个问题后，我拿起了一份《[Beginning Linux Programming](https://rads.stackoverflow.com/amzn/click/com/0470147628) 》的副本，它的第一章有示例 C 代码以及创建和使用静态库和共享库的很好的解释. 这些示例可通过 Google 图书搜索在[该书的旧版本中](http://books.google.com/books?hl=en&id=7q0TFMi7FIkC&dq=beginning+linux+programming&printsec=frontcover&source=web&ots=ko8ox73Gd6&sig=Fbp6iqNbeRaADHOUB0Px-99uaY8&sa=X&oi=book_result&resnum=3&ct=result#PPA10,M1)找到。

* * *

## 回答 #1

> 赞同：176
> 
> 时间：2009-01-30T20:37:27.293

**我的班级.h**

```
#ifndef __MYCLASS_H__
#define __MYCLASS_H__

class MyClass
{
public:
  MyClass();

  /* use virtual otherwise linker will try to perform static linkage */
  virtual void DoSomething();

private:
  int x;
};

#endif 
```

**我的班级.cc**

```
#include "myclass.h"
#include <iostream>

using namespace std;

extern "C" MyClass* create_object()
{
  return new MyClass;
}

extern "C" void destroy_object( MyClass* object )
{
  delete object;
}

MyClass::MyClass()
{
  x = 20;
}

void MyClass::DoSomething()
{
  cout<<x<<endl;
} 
```

**class_user.cc**

```
#include <dlfcn.h>
#include <iostream>
#include "myclass.h"

using namespace std;

int main(int argc, char **argv)
{
  /* on Linux, use "./myclass.so" */
  void* handle = dlopen("myclass.so", RTLD_LAZY);

  MyClass* (*create)();
  void (*destroy)(MyClass*);

  create = (MyClass* (*)())dlsym(handle, "create_object");
  destroy = (void (*)(MyClass*))dlsym(handle, "destroy_object");

  MyClass* myClass = (MyClass*)create();
  myClass->DoSomething();
  destroy( myClass );
} 
```

在 Mac OS X 上，编译：

```
g++ -dynamiclib -flat_namespace myclass.cc -o myclass.so
g++ class_user.cc -o class_user 
```

在 Linux 上，编译：

```
g++ -fPIC -shared myclass.cc -o myclass.so
g++ class_user.cc -ldl -o class_user 
```

如果这是针对插件系统的，您将使用 MyClass 作为基类并定义所有必需的虚拟函数。然后插件作者将从 MyClass 派生，覆盖虚拟对象并实现`create_object`和`destroy_object`. 您的主应用程序不需要以任何方式进行更改。

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2009-01-30T20:16:05.727

下面显示了共享类库 shared.[h,cpp] 和使用该库的 main.cpp 模块的示例。这是一个非常简单的例子，makefile 可以做得更好。但它有效并且可以帮助你：

shared.h 定义了类：

```
class myclass {
   int myx;

  public:

    myclass() { myx=0; }
    void setx(int newx);
    int  getx();
}; 
```

shared.cpp 定义了 getx/setx 函数：

```
#include "shared.h"

void myclass::setx(int newx) { myx = newx; }
int  myclass::getx() { return myx; } 
```

main.cpp 使用该类，

```
#include <iostream>
#include "shared.h"

using namespace std;

int main(int argc, char *argv[])
{
  myclass m;

  cout << m.getx() << endl;
  m.setx(10);
  cout << m.getx() << endl;
} 
```

以及生成 libshared.so 并将 main 链接到共享库的 makefile：

```
main: libshared.so main.o
    $(CXX) -o main  main.o -L. -lshared

libshared.so: shared.cpp
    $(CXX) -fPIC -c shared.cpp -o shared.o
    $(CXX) -shared  -Wl,-soname,libshared.so -o libshared.so shared.o

clean:
    $rm *.o *.so 
```

要实际运行 'main' 并与 libshared.so 链接，您可能需要指定加载路径（或将其放在 /usr/local/lib 或类似文件中）。

以下将当前目录指定为库的搜索路径并运行 main（bash 语法）：

```
export LD_LIBRARY_PATH=.
./main 
```

要查看程序是否与 libshared.so 链接，您可以尝试 ldd：

```
LD_LIBRARY_PATH=. ldd main 
```

在我的机器上打印：

```
 ~/prj/test/shared$ LD_LIBRARY_PATH=. ldd main
    linux-gate.so.1 =>  (0xb7f88000)
    libshared.so => ./libshared.so (0xb7f85000)
    libstdc++.so.6 => /usr/lib/libstdc++.so.6 (0xb7e74000)
    libm.so.6 => /lib/libm.so.6 (0xb7e4e000)
    libgcc_s.so.1 => /usr/lib/libgcc_s.so.1 (0xb7e41000)
    libc.so.6 => /lib/libc.so.6 (0xb7cfa000)
    /lib/ld-linux.so.2 (0xb7f89000) 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-01-30T20:20:45.313

基本上，您应该在要在共享库中使用该类的代码中包含该类的头文件。然后，当您链接时，[使用“-l”标志](http://gcc.gnu.org/onlinedocs/gcc-4.3.2/gcc/Link-Options.html#Link-Options)将您的代码与共享库链接。当然，这要求 .so 位于操作系统可以找到它的位置。见[3.5。安装和使用共享库](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html)

当您在编译时不知道要使用哪个库时，使用 dlsym。这听起来不像这里的情况。也许令人困惑的是，无论您是在编译时还是运行时（使用类似方法）进行链接，Windows 都会调用动态加载的库？如果是这样，那么您可以将 dlsym 视为 LoadLibrary 的等价物。

如果您确实需要动态加载库（即，它们是插件），那么[这个常见问题解答](http://www.faqs.org/docs/Linux-mini/C++-dlopen.html)应该会有所帮助。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2019-02-07T21:33:33.083

除了以前的答案之外，我想提高对这样一个事实的认识，即您应该使用[RAII（资源获取是初始化）习语](https://en.wikipedia.org/wiki/Resource_acquisition_is_initialization)来确保处理程序销毁的安全。

这是一个完整的工作示例：

接口声明`Interface.hpp`：：

```
class Base {
public:
    virtual ~Base() {}
    virtual void foo() const = 0;
};

using Base_creator_t = Base *(*)(); 
```

共享库内容：

```
#include "Interface.hpp"

class Derived: public Base {
public:
    void foo() const override {}
};

extern "C" {
Base * create() {
    return new Derived;
}
} 
```

动态共享库处理程序`Derived_factory.hpp`：：

```
#include "Interface.hpp"
#include <dlfcn.h>

class Derived_factory {
public:
    Derived_factory() {
        handler = dlopen("libderived.so", RTLD_NOW);
        if (! handler) {
            throw std::runtime_error(dlerror());
        }
        Reset_dlerror();
        creator = reinterpret_cast<Base_creator_t>(dlsym(handler, "create"));
        Check_dlerror();
    }

    std::unique_ptr<Base> create() const {
        return std::unique_ptr<Base>(creator());
    }

    ~Derived_factory() {
        if (handler) {
            dlclose(handler);
        }
    }

private:
    void * handler = nullptr;
    Base_creator_t creator = nullptr;

    static void Reset_dlerror() {
        dlerror();
    }

    static void Check_dlerror() {
        const char * dlsym_error = dlerror();
        if (dlsym_error) {
            throw std::runtime_error(dlsym_error);
        }
    }
}; 
```

客户端代码：

```
#include "Derived_factory.hpp"

{
    Derived_factory factory;
    std::unique_ptr<Base> base = factory.create();
    base->foo();
} 
```

笔记：

*   为了简洁起见，我将所有内容都放在头文件中。在现实生活中，您当然应该在文件之间拆分`.hpp`代码`.cpp`。
*   为简化起见，我忽略了您要处理`new`/`delete`重载的情况。

两篇清晰的文章以获得更多详细信息：

*   [C++ dlopen 迷你操作指南](https://www.tldp.org/HOWTO/C++-dlopen/index.html)
*   [C++ 在运行时动态加载共享对象](https://0x00sec.org/t/c-dynamic-loading-of-shared-objects-at-runtime/1498)

# php - php字符串是不可变的吗？

> ID：496669
> 
> 赞同：16
> 
> 时间：2009-01-30T18:43:15.697
> 
> 标签：php, string

或者：我应该在 PHP 中优化我的字符串操作吗？我试图询问 PHP 的手册，但我没有得到任何提示。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-30T18:52:47.970

PHP 已经对其进行了优化——变量是[使用 copy-on-write](http://php.net/debug_zval_dump)分配的，对象是通过引用传递的。在 PHP **4**中它没有，但无论如何都没有人应该将 PHP 4 用于新代码。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-08-03T19:59:55.460

许多语言中最基本的速度优化技术之一是实例重用。在这种情况下，速度的提高至少来自两个因素：

**1\. 更少的实例化意味着更少的构建时间。**

**2\. 应用程序使用的内存量越少，[CPU 缓存未命中](http://en.wikipedia.org/wiki/CPU_cache#Cache_Misses)的可能就越少。**

对于速度是第一要务的应用程序，CPU 和 RAM 之间存在真正紧密的瓶颈。瓶颈的原因之一是 RAM 的延迟。

PHP、Ruby、Python 等与缓存未命中相关的事实是，即使它们在 RAM 中存储了解释程序的至少一些（可能全部）运行时数据。

字符串实例化是经常进行的操作之一，相对“大量”，它可能会对速度产生显着影响。

这是一个测量实验的 run_test.bash：

```
#!/bin/bash

for i in `seq 1 200`;
do
        /usr/bin/time -p -a -o ./measuring_data.rb  php5 ./string_instantiation_speedtest.php
done 
```

以下是 ./string_instantiation_speedtest.php 和测量结果：

```
<?php

// The comments on the
// next 2 lines show arithmetic mean of (user time + sys time) for 200 runs.
$b_instantiate=False; // 0.1624 seconds
$b_instantiate=True;  // 0.1676 seconds
// The time consumed by the reference version is about 97% of the
// time consumed by the instantiation version, but a thing to notice is
// that the loop contains at least 1, probably 2, possibly 4,
// string instantiations at the array_push line.
$ar=array();
$s='This is a string.';
$n=10000;
$s_1=NULL;

for($i=0;$i<$n;$i++) {
    if($b_instantiate) {
        $s_1=''.$s;
    } else {
        $s_1=&$s;
    }
    // The rand is for avoiding optimization at storage.
    array_push($ar,''.rand(0,9).$s_1);
} // for

echo($ar[rand(0,$n)]."\n");

?> 
```

我从这个实验和我用 Ruby 1.8 做的另一个实验得出的结论是，通过引用传递字符串值是有意义的。

允许在整个应用程序范围内进行“按引用传递字符串”的一种可能方法是，只要需要使用字符串的修改版本，就始终如一地创建一个新的字符串实例。

为了增加局部性，从而提高速度，可能需要减少每个操作数消耗的内存量。以下实验演示了字符串连接的情况：

```
<?php

// The comments on the
// next 2 lines show arithmetic mean of (user time + sys time) for 200 runs.
$b_suboptimal=False; // 0.0611 seconds
$b_suboptimal=True;  // 0.0785 seconds
// The time consumed by the optimal version is about 78% of the
// time consumed by the suboptimal version.
//
// The number of concatenations is the same and the resultant
// string is the same, but what differs is the "average" and maximum
// lengths  of the tokens that are used for assembling the $s_whole.
$n=1000;
$s_token="This is a string with a Linux line break.\n";
$s_whole='';

if($b_suboptimal) {
    for($i=0;$i<$n;$i++) {
        $s_whole=$s_whole.$s_token.$i;
    } // for
} else {
    $i_watershed=(int)round((($n*1.0)/2),0);
    $s_part_1='';
    $s_part_2='';
    for($i=0;$i<$i_watershed;$i++) {
        $s_part_1=$s_part_1.$i.$s_token;
    } // for
    for($i=$i_watershed;$i<$n;$i++) {
        $s_part_2=$s_part_2.$i.$s_token;
    } // for
    $s_whole=$s_part_1.$s_part_2;
} // else

// To circumvent possible optimization one actually "uses" the
// value of the $s_whole.
$file_handle=fopen('./it_might_have_been_a_served_HTML_page.txt','w');
fwrite($file_handle, $s_whole);
fclose($file_handle);

?> 
```

例如，如果一个人组装了包含大量文本的 HTML 页面，那么可能需要考虑顺序，即生成的 HTML 的不同部分是如何连接在一起的。

可以使用 BSD 许可的[PHP 实现](http://longterm.softf1.com/2014/comments/2014_06_21_sirel_text_concatenation_php.txt)和分水岭字符串连接算法的[Ruby 实现](http://longterm.softf1.com/2014/comments/2014_06_21_kibuvits_str_concat_array_of_strings_rb.txt)。可以（我已经）推广相同的算法以加速任意精度整数的乘法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-04-10T08:40:27.213

数组和字符串具有写时复制行为。它们是可变的，但是当您最初将它们分配给变量时，该变量将包含完全相同的字符串或数组实例。只有当您修改数组或字符串时，才会进行复制。

例子：

```
$a = array_fill(0, 10000, 42);  //Consumes 545744 bytes
$b = $a;                        //   "         48   "
$b[0] = 42;                     //   "     545656   "

$s = str_repeat(' ', 10000);    //   "      10096   "
$t = $s;                        //   "         48   "
$t[0] = '!';                    //   "      10048   " 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-30T18:48:12.317

一个快速的谷歌似乎暗示它们是可变的，但首选的做法是将它们视为不可变的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-09-23T16:15:01.717

PHP 7.4 使用了可变字符串：

```
<?php
$str = "Hello\n";
echo $str;
$str[2] = 'y';
echo $str; 
```

输出：

```
Hello
Heylo 
```

测试：[PHP 沙盒](http://sandbox.onlinephpfunctions.com/code/15b142eb8022aa1ff9e13b2a43299116b50dcbf0)

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2013-08-04T21:21:10.973

PHP 字符串是不可变的。

试试这个：

```
 $a="string";
    echo "<br>$a<br>";
    echo str_replace('str','b',$a);
    echo "<br>$a"; 
```

它回响：

```
string
bing
string 
```

如果字符串是可变的，它将继续显示“bing”。

# wpf - 在设计时如何让 WPF 像 Forms 一样工作？

> ID：496677
> 
> 赞同：1
> 
> 时间：2009-01-30T18:44:24.477
> 
> 标签：wpf, controls, resize

WPF 有点新……似乎无论我用水平和垂直对齐方式改变什么，WPF 在设计时调整我的控件大小时都有自己的想法。我创建了一个新窗口，放置了几个按钮和文本框，每当我更改窗口大小时，所有控件都会调整大小。有没有办法将其锁定或我错过了一些明显的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T18:49:16.073

您使用的布局可能是网格。尝试用***Canvas***替换它，您将获得与 win 表单设计类似的行为。

建议：当我们使用 WPF 时，我们可以获得的优势是可调整大小并且能够在布局内动态排列（更改）控件等。所以尝试使用动态布局而不是像“Canvas”这样的静态布局

# bash - shell脚本可以设置调用shell的环境变量吗？

> ID：496702
> 
> 赞同：506
> 
> 时间：2009-01-30T18:50:22.033
> 
> 标签：bash, shell, csh, tcsh

我正在尝试编写一个 shell 脚本，该脚本在运行时将设置一些环境变量，这些环境变量将保持在调用者的 shell 中。

```
setenv FOO foo 
```

在 csh/tcsh 中，或

```
export FOO=foo 
```

在 sh/bash 中仅在脚本执行期间设置它。

我已经知道了

```
source myscript 
```

将运行脚本的命令而不是启动新的 shell，这可能会导致设置“调用者”环境。

但问题是：

我希望这个脚本可以从 bash 或 csh 调用。换句话说，我希望任一 shell 的用户都能够运行我的脚本并改变他们的 shell 环境。所以'source'对我不起作用，因为运行 csh 的用户无法获取 bash 脚本，而运行 bash 的用户无法获取 csh 脚本。

有没有不需要在脚本上编写和维护两个版本的合理解决方案？

* * *

## 回答 #1

> 赞同：508
> 
> 时间：2015-02-12T23:04:57.163

使用“点空间脚本”调用语法。例如，以下是使用脚本的完整路径的方法：

```
. /path/to/set_env_vars.sh 
```

如果您与脚本位于同一目录中，请执行以下操作：

```
. set_env_vars.sh 
```

它们在当前 shell 下执行脚本，而不是加载另一个脚本（如果你这样做了会发生这种情况`./set_env_vars.sh`）。因为它在同一个 shell 中运行，所以你设置的环境变量在它退出时将可用。

这与 call 相同，但它的输入时间更短，并且可能在某些不需要`source set_env_vars.sh`的地方工作。`source`

* * *

## 回答 #2

> 赞同：312
> 
> 时间：2009-01-30T19:06:58.643

您的 shell 进程拥有父进程环境的副本，并且无法访问父进程的环境。当您的 shell 进程终止时，您对其环境所做的任何更改都会丢失。获取脚本文件是配置 shell 环境最常用的方法，您可能只想硬着头皮为两种 shell 中的每一种维护一个。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2009-01-30T19:06:58.550

您将无法修改调用者的 shell，因为它位于不同的进程上下文中。当子进程继承你的 shell 的变量时，它们自己继承了副本。

您可以做的一件事是编写一个脚本，根据调用方式为 tcsh 或 sh 发出正确的命令。如果您的脚本是“setit”，那么请执行以下操作：

```
ln -s setit setit-sh 
```

和

```
ln -s setit setit-csh 
```

现在直接或在别名中，您从 sh 执行此操作

```
eval `setit-sh` 
```

或者这个来自 csh

```
eval `setit-csh` 
```

setit 使用 $0 来确定其输出样式。

这让人想起人们如何使用 TERM 环境变量集。

这里的优点是 setit 只是写在你喜欢的任何 shell 中，如下所示：

```
#!/bin/bash
arg0=$0
arg0=${arg0##*/}
for nv in \
   NAME1=VALUE1 \
   NAME2=VALUE2
do
   if [ x$arg0 = xsetit-sh ]; then
      echo 'export '$nv' ;'
   elif [ x$arg0 = xsetit-csh ]; then
      echo 'setenv '${nv%%=*}' '${nv##*=}' ;'
   fi
done 
```

使用上面给出的符号链接和反引号表达式的 eval，这具有所需的结果。

要简化 csh、tcsh 或类似 shell 的调用：

```
alias dosetit 'eval `setit-csh`' 
```

或者对于 sh、bash 等：

```
alias dosetit='eval `setit-sh`' 
```

这样做的一个好处是您只需将列表维护在一个地方。从理论上讲，您甚至可以将列表粘贴在文件中并放在`cat nvpairfilename`“in”和“do”之间。

这几乎是过去登录 shell 终端设置的完成方式：脚本将输出要在登录 shell 中执行的语句。别名通常用于简化调用，如“tset vt100”。正如另一个答案中提到的，INN UseNet 新闻服务器中也有类似的功能。

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2011-11-19T23:46:30.900

在我的 .bash_profile 我有：

```
# No Proxy
function noproxy
{
    /usr/local/sbin/noproxy  #turn off proxy server
    unset http_proxy HTTP_PROXY https_proxy HTTPs_PROXY
}

# Proxy
function setproxy
{
    sh /usr/local/sbin/proxyon  #turn on proxy server 
    http_proxy=http://127.0.0.1:8118/
    HTTP_PROXY=$http_proxy
    https_proxy=$http_proxy
    HTTPS_PROXY=$https_proxy
    export http_proxy https_proxy HTTP_PROXY HTTPS_PROXY
} 
```

因此，当我想禁用代理时，函数会在登录 shell 中运行并按预期设置变量。

* * *

## 回答 #5

> 赞同：35
> 
> 时间：2011-07-08T22:03:34.663

通过使用 gdb 和[setenv(3)](http://linux.die.net/man/3/setenv)可以“有点” ，尽管我很难建议实际这样做。（此外，即最新的 ubuntu 实际上不会让您在不告诉内核对 ptrace 更加宽容的情况下执行此操作，其他发行版也可能如此）。

```
$ cat setfoo
#! /bin/bash

gdb /proc/${PPID}/exe ${PPID} <<END >/dev/null
call setenv("foo", "bar", 0)
END
$ echo $foo

$ ./setfoo
$ echo $foo
bar 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2009-01-30T22:17:05.827

这行得通——这不是我要使用的，但它“有效”。让我们创建一个脚本`teredo`来设置环境变量`TEREDO_WORMS`：

```
#!/bin/ksh
export TEREDO_WORMS=ukelele
exec $SHELL -i 
```

它将由 Korn shell 解释，导出环境变量，然后用新的交互式 shell 替换它自己。

在运行这个脚本之前，我们已经在环境中设置了C shell，并且没有设置`SHELL`环境变量：`TEREDO_WORMS`

```
% env | grep SHELL
SHELL=/bin/csh
% env | grep TEREDO
% 
```

当脚本运行时，你在一个新的 shell 中，另一个交互式 C shell，但是设置了环境变量：

```
% teredo
% env | grep TEREDO
TEREDO_WORMS=ukelele
% 
```

当您退出此 shell 时，原始 shell 将接管：

```
% exit
% env | grep TEREDO
% 
```

环境变量未在原始 shell 的环境中设置。如果您使用`exec teredo`来运行该命令，则原来的交互式 shell 将被设置环境的 Korn shell 替换，然后又被新的交互式 C shell 替换：

```
% exec teredo
% env | grep TEREDO
TEREDO_WORMS=ukelele
% 
```

如果您键入`exit`(或`Control-D`)，则您的 shell 将退出，可能会将您从该窗口中注销，或者将您带回到实验开始的上一个 shell 级别。

相同的机制适用于 Bash 或 Korn shell。您可能会发现退出命令后的提示出现在有趣的地方。

* * *

注意评论中的讨论。这不是我推荐的解决方案，但它确实实现了单个脚本的既定目的，以设置适用于所有 shell（接受`-i`创建交互式 shell 的选项）的环境。您还可以`"$@"`在中继任何其他参数的选项之后添加，这可能会使 shell 可用作一般的“设置环境和执行命令”工具。`-i`如果还有其他参数，您可能想省略，导致：

```
#!/bin/ksh
export TEREDO_WORMS=ukelele
exec $SHELL "${@-'-i'}" 
```

该`"${@-'-i'}"`位表示'如果参数列表包含至少一个参数，则使用原始参数列表；否则，替换`-i`不存在的参数'。

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2009-02-04T18:52:14.927

您应该使用模块，请参阅[http://modules.sourceforge.net/](http://modules.sourceforge.net/)

编辑：模块包自 2012 年以来尚未更新，但仍然适用于基础知识。所有新功能、花里胡哨的东西都发生在今天的 lmod 中（我更喜欢它）：[https ://www.tacc.utexas.edu/research-development/tacc-projects/lmod](https://www.tacc.utexas.edu/research-development/tacc-projects/lmod)

* * *

## 回答 #8

> 赞同：10
> 
> 时间：2013-07-26T19:21:34.467

我没有提到的另一个解决方法是将变量值写入文件。

我遇到了一个非常相似的问题，我希望能够运行最后一组测试（而不是我的所有测试）。我的第一个计划是编写一个用于设置环境变量 TESTCASE 的命令，然后使用另一个命令来运行测试。不用说我和你有同样的问题。

但后来我想出了这个简单的技巧：

第一个命令（`testset`）：

```
#!/bin/bash

if [ $# -eq 1 ]
then
  echo $1 > ~/.TESTCASE
  echo "TESTCASE has been set to: $1"
else
  echo "Come again?"
fi 
```

第二个命令（`testrun`）：

```
#!/bin/bash

TESTCASE=$(cat ~/.TESTCASE)
drush test-run $TESTCASE 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2014-06-16T12:43:43.550

在 bash 脚本的顶部添加 -l 标志，即

```
#!/usr/bin/env bash -l

...

export NAME1="VALUE1"
export NAME2="VALUE2" 
```

带有`NAME1`和的值`NAME2`现在将被导出到您当前的环境中，但是这些更改不是永久性的。如果您希望它们是永久的，您需要将它们添加到您的`.bashrc`文件或其他初始化文件中。

从手册页：

```
-l Make bash act as if it had been invoked as a login shell (see INVOCATION below). 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2014-09-25T14:23:48.723

您可以指示子进程打印其环境变量（通过调用“env”），然后在父进程中循环打印的环境变量并在这些变量上调用“export”。

以下代码基于[捕获 find 的输出。-print0 到 bash 数组中](https://stackoverflow.com/questions/1116992/capturing-output-of-find-print0-into-a-bash-array)

如果父 shell 是 bash，则可以使用

```
while IFS= read -r -d $'\0' line; do
    export "$line"
done < <(bash -s <<< 'export VARNAME=something; env -0')
echo $VARNAME 
```

如果父 shell 是破折号，`read`则不提供 -d 标志并且代码变得更加复杂

```
TMPDIR=$(mktemp -d)
mkfifo $TMPDIR/fifo
(bash -s << "EOF"
    export VARNAME=something
    while IFS= read -r -d $'\0' line; do
        echo $(printf '%q' "$line")
    done < <(env -0)
EOF
) > $TMPDIR/fifo &
while read -r line; do export "$(eval echo $line)"; done < $TMPDIR/fifo
rm -r $TMPDIR
echo $VARNAME 
```

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2018-08-31T15:50:33.523

这不是我所说的出色，但如果您无论如何都需要从 shell 调用脚本，这也有效。这不是一个好的解决方案，但是对于单个静态环境变量来说，它已经足够好了。

1.) 创建一个脚本，其条件退出 0（成功）或 1（不成功）

```
if [[ $foo == "True" ]]; then
    exit 0
else
    exit 1 
```

2.) 创建一个依赖于退出代码的别名。

```
alias='myscript.sh && export MyVariable' 
```

您调用别名，该别名调用脚本，该脚本评估条件，需要通过“&&”退出零，以便在父 shell 中设置环境变量。

这是漂浮物，但在紧要关头它可能很有用。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2010-10-29T06:15:02.647

您可以使用不同的 bash_profile 调用另一个 Bash。此外，您可以创建特殊的 bash_profile 以在多 bashprofile 环境中使用。

请记住，您可以在 bashprofile中使用*函数，并且这些函数将在全局范围内可用。*例如“function user { export USER_NAME $1 }”可以在运行时设置变量，例如：user olegchir && env | grep 奥莱基尔

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-10-23T20:02:45.473

另一种选择是使用“环境模块”（[http://modules.sourceforge.net/](http://modules.sourceforge.net/)）。不幸的是，这将第三种语言引入了混合中。您使用 Tcl 语言定义环境，但有一些方便的命令可用于典型的修改（前置、附加和设置）。您还需要安装环境模块。然后，您可以使用`module load *XXX*`来命名您想要的环境。module 命令基本上是`eval`Thomas Kammeyer 上述机制的一个奇特别名。这里的主要优点是您可以用一种语言维护环境并依靠“环境模块”将其翻译成 sh、ksh、bash、csh、tcsh、zsh、python（？！？！！）等。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-09-21T21:43:53.537

我使用管道、评估和信号创建了一个解决方案。

```
parent() {
    if [ -z "$G_EVAL_FD" ]; then
            die 1 "Rode primeiro parent_setup no processo pai"
    fi
    if [ $(ppid) = "$$" ]; then
            "$@"
    else
            kill -SIGUSR1 $$
            echo "$@">&$G_EVAL_FD
    fi
}
parent_setup() {
    G_EVAL_FD=99
    tempfile=$(mktemp -u)
    mkfifo "$tempfile"
    eval "exec $G_EVAL_FD<>'$tempfile'"
    rm -f "$tempfile"
    trap "read CMD <&$G_EVAL_FD; eval \"\$CMD\"" USR1
}
parent_setup #on parent shell context
( A=1 ); echo $A # prints nothing
( parent A=1 ); echo $A # prints 1 
```

它可能适用于任何命令。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2017-01-19T09:26:51.197

在 OS X bash 下，您可以执行以下操作：
创建 bash 脚本文件以取消设置变量

```
#!/bin/bash
unset http_proxy 
```

使文件可执行

```
sudo chmod 744 unsetvar 
```

创建别名

```
alias unsetvar='source /your/path/to/the/script/unsetvar' 
```

只要您将包含脚本文件的文件夹附加到路径中，它就应该可以使用了。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2017-11-23T09:25:36.253

我没有看到任何记录如何通过合作流程解决此问题的答案。一个常见的模式`ssh-agent`是让子进程打印父进程可以打印的表达式`eval`。

```
bash$ eval $(shh-agent) 
```

例如，`ssh-agent`具有选择 Csh 或 Bourne 兼容输出语法的选项。

```
bash$ ssh-agent
SSH2_AUTH_SOCK=/tmp/ssh-era/ssh2-10690-agent; export SSH2_AUTH_SOCK;
SSH2_AGENT_PID=10691; export SSH2_AGENT_PID;
echo Agent pid 10691; 
```

（这会导致代理开始运行，但不允许您实际使用它，除非您现在将此输出复制粘贴到您的 shell 提示符。）比较：

```
bash$ ssh-agent -c
setenv SSH2_AUTH_SOCK /tmp/ssh-era/ssh2-10751-agent;
setenv SSH2_AGENT_PID 10752;
echo Agent pid 10752; 
```

（如您所见，`csh`用于`tcsh`设置`setenv`变量。）

您自己的程序也可以做到这一点。

```
bash$ foo=$(makefoo) 
```

您的`makefoo`脚本将简单地计算并打印该值，并让调用者对它做任何他们想做的事情——将它分配给一个变量是一个常见的用例，但您可能不想硬编码到产生该值的工具中.

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2011-05-18T13:23:39.377

从技术上讲，这是正确的——只有 'eval' 不会分叉另一个 shell。但是，从您尝试在修改后的环境中运行的应用程序的角度来看，区别为零：子代继承其父代的环境，因此（修改后的）环境被传递给所有下行进程。

事实上，改变的环境变量'sticks'——只要你在父程序/shell下运行。

如果在父（Perl 或 shell）退出后环境变量绝对需要保留，则父 shell 有必要承担繁重的工作。我在文档中看到的一种方法是让当前脚本使用必要的“导出”语言生成一个可执行文件，然后诱使父 shell 执行它——始终意识到您需要在前面加上如果您试图留下修改后环境的非易失版本，则使用“source”命令。充其量是克鲁格。

第二种方法是修改启动 shell 环境（.bashrc 或其他）的脚本以包含修改后的参数。这可能很危险——如果您对初始化脚本进行软管处理，它可能会在下次尝试启动时使您的 shell 不可用。有很多工具可以修改当前的 shell；通过对“启动器”进行必要的调整，您也可以有效地推动这些变化。通常不是一个好主意；如果您只需要更改特定应用程序套件的环境，则必须返回并将 shell 启动脚本返回到其原始状态（使用 vi 或其他）。

简而言之，没有好的（简单的）方法。据推测，这很难确保系统的安全性不会受到不可挽回的损害。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-02-28T06:41:39.053

简短的回答是否定的，你不能改变父进程的环境，但看起来你想要的是一个具有自定义环境变量和用户选择的 shell 的环境。

那么为什么不简单地像

```
#!/usr/bin/env bash
FOO=foo $SHELL 
```

然后，当您完成环境时，只需`exit`.

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2014-04-10T23:14:57.643

你总是可以使用别名

```
alias your_env='source ~/scripts/your_env.sh' 
```

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2015-10-30T15:14:45.430

很多年前我就这样做了。如果我没记错的话，我在 .bashrc 和 .cshrc 中都包含了一个别名，带有参数，将环境设置为通用形式的相应形式别名。

然后，您将在两个 shell 中的任何一个中获取的脚本都有一个具有最后一种形式的命令，该命令在每个 shell 中都适合别名。

如果我找到具体的别名，我会发布它们。

* * *

## 回答 #21

> 赞同：-11
> 
> 时间：2009-01-30T19:08:12.200

除了写作条件取决于 $SHELL/$TERM 的设置，没有。使用 Perl 有什么问题？它无处不在（我想不出一个没有它的 UNIX 变体），它会为您省去麻烦。

# c# - 如何一次迭代两个数组？

> ID：496704
> 
> 赞同：15
> 
> 时间：2009-01-30T18:50:39.957
> 
> 标签：c#, iterator, enumerator

我在解析文本文件时构建了两个数组。第一个包含列名，第二个包含当前行的值。我需要一次遍历两个列表来构建地图。现在我有以下内容：

```
var currentValues = currentRow.Split(separatorChar);
var valueEnumerator = currentValues.GetEnumerator();

foreach (String column in columnList)
{
    valueEnumerator.MoveNext();
    valueMap.Add(column, (String)valueEnumerator.Current);
} 
```

这工作得很好，但它并不能完全满足我的优雅感，如果数组的数量大于两个（我偶尔必须这样做），它会变得非常毛茸茸。有没有人有另一个更简洁的成语？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2009-01-30T19:01:29.187

您的初始代码中有一个不明显的伪错误 -`IEnumerator<T>`扩展`IDisposable`，因此您应该处理它。这对于迭代器块非常重要！对于数组来说不是问题，但对于其他`IEnumerable<T>`实现来说会是问题。

我会这样做：

```
public static IEnumerable<TResult> PairUp<TFirst,TSecond,TResult>
    (this IEnumerable<TFirst> source, IEnumerable<TSecond> secondSequence,
     Func<TFirst,TSecond,TResult> projection)
{
    using (IEnumerator<TSecond> secondIter = secondSequence.GetEnumerator())
    {
        foreach (TFirst first in source)
        {
            if (!secondIter.MoveNext())
            {
                throw new ArgumentException
                    ("First sequence longer than second");
            }
            yield return projection(first, secondIter.Current);
        }
        if (secondIter.MoveNext())
        {
            throw new ArgumentException
                ("Second sequence longer than first");
        }
    }        
} 
```

然后，您可以在需要时重复使用它：

```
foreach (var pair in columnList.PairUp(currentRow.Split(separatorChar),
             (column, value) => new { column, value })
{
    // Do something
} 
```

或者，您可以创建一个通用的 Pair 类型，并去掉 PairUp 方法中的投影参数。

编辑：

对于 Pair 类型，调用代码如下所示：

```
foreach (var pair in columnList.PairUp(currentRow.Split(separatorChar))
{
    // column = pair.First, value = pair.Second
} 
```

这看起来很简单。是的，您需要将实用程序方法放在某个地方，作为可重用代码。在我看来几乎不是问题。现在对于多个数组...

如果数组是不同类型的，我们就有问题了。您不能在泛型方法/类型声明中表达任意数量的类型参数 - 您可以为任意数量的类型参数编写 PairUp 版本，就像最多 4 个委托参数的委托一样 - 但您`Action`可以`Func`不要随意。

但是，如果这些值都是相同的类型——并且你很乐意坚持使用数组——那就很容易了。（非数组也可以，但是您不能提前进行长度检查。）您可以这样做：

```
public static IEnumerable<T[]> Zip<T>(params T[][] sources)
{
    // (Insert error checking code here for null or empty sources parameter)

    int length = sources[0].Length;
    if (!sources.All(array => array.Length == length))
    {
        throw new ArgumentException("Arrays must all be of the same length");
    }

    for (int i=0; i < length; i++)
    {
        // Could do this bit with LINQ if you wanted
        T[] result = new T[sources.Length];
        for (int j=0; j < result.Length; j++)
        {
             result[j] = sources[j][i];
        }
        yield return result;
    }
} 
```

那么调用代码将是：

```
foreach (var array in Zip(columns, row, whatevers))
{
    // column = array[0]
    // value = array[1]
    // whatever = array[2]
} 
```

当然，这涉及到一定数量的复制——您每次都在创建一个数组。您可以通过引入另一种类型来改变这种情况：

```
public struct Snapshot<T>
{
    readonly T[][] sources;
    readonly int index;

    public Snapshot(T[][] sources, int index)
    {
        this.sources = sources;
        this.index = index;
    }

    public T this[int element]
    {
        return sources[element][index];
    }
} 
```

不过，这可能被大多数人认为是矫枉过正；）

老实说，我可以不断想出各种想法……但基础是：

*   通过一些可重用的工作，您可以使调用代码更好
*   对于任意类型的组合，由于泛型的工作方式，您必须分别执行每个数量的参数（2、3、4...）
*   如果你乐于为每个部分使用相同的类型，你可以做得更好

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2009-01-30T18:56:00.197

如果列名的数量与每行中的元素数量相同，您可以不使用 for 循环吗？

```
var currentValues = currentRow.Split(separatorChar);

for(var i=0;i<columnList.Length;i++){
   // use i to index both (or all) arrays and build your map
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-30T19:48:39.153

在函数式语言中，您通常会找到一个“zip”函数，它有望成为 C#4.0 的一部分。[Bart de Smet](http://community.bartdesmet.net/blogs/bart/archive/2008/11/03/c-4-0-feature-focus-part-3-intermezzo-linq-s-new-zip-operator.aspx)基于现有的 LINQ 函数提供了一个有趣的 zip 实现：

```
public static IEnumerable<TResult> Zip<TFirst, TSecond, TResult>(
  this IEnumerable<TFirst> first, 
  IEnumerable<TSecond> second, 
  Func<TFirst, TSecond, TResult> func)
{
  return first.Select((x, i) => new { X = x, I = i })
    .Join(second.Select((x, i) => new { X = x, I = i }), 
    o => o.I, 
    i => i.I, 
    (o, i) => func(o.X, i.X));
} 
```

然后你可以这样做：

```
 int[] s1 = new [] { 1, 2, 3 };
  int[] s2 = new[] { 4, 5, 6 };
  var result = s1.Zip(s2, (i1, i2) => new {Value1 = i1, Value2 = i2}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-01-30T18:55:39.167

如果你真的在使用数组，最好的方法可能就是使用`for`带有索引的常规循环。没有那么好，当然，但据我所知.NET 并没有提供更好的方法来做到这一点。

您还可以将您的代码封装到一个名为的方法`zip`中——这是一个常见的高阶列表函数。但是，C# 缺少合适的 Tuple 类型，这很麻烦。你最终会返回一个`IEnumerable<KeyValuePair<T1, T2>>`不是很好的。

顺便说一句，您是否真的使用`IEnumerable`而不是`IEnumerable<T>`或为什么要转换该`Current`值？

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2009-01-30T19:32:24.240

对两者都使用 IEnumerator 会很好

```
var currentValues = currentRow.Split(separatorChar);
using (IEnumerator<string> valueEnum = currentValues.GetEnumerator(), columnEnum = columnList.GetEnumerator()) {
    while (valueEnum.MoveNext() && columnEnum.MoveNext())
        valueMap.Add(columnEnum.Current, valueEnum.Current);
} 
```

或者创建一个扩展方法

```
public static IEnumerable<TResult> Zip<T1, T2, TResult>(this IEnumerable<T1> source, IEnumerable<T2> other, Func<T1, T2, TResult> selector) {
    using (IEnumerator<T1> sourceEnum = source.GetEnumerator()) {
        using (IEnumerator<T2> otherEnum = other.GetEnumerator()) {
            while (sourceEnum.MoveNext() && columnEnum.MoveNext())
                yield return selector(sourceEnum.Current, otherEnum.Current);
        }
    }
} 
```

用法

```
var currentValues = currentRow.Split(separatorChar);
foreach (var valueColumnPair in currentValues.Zip(columnList, (a, b) => new { Value = a, Column = b }) {
    valueMap.Add(valueColumnPair.Column, valueColumnPair.Value);
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-01-30T18:56:24.080

您可以创建一个二维数组或字典（这会更好），而不是创建两个单独的数组。但实际上，如果它有效，我不会尝试改变它。

# cvs - 自动添加、删除和提交的 CVS 脚本

> ID：496708
> 
> 赞同：0
> 
> 时间：2009-01-30T18:51:23.963
> 
> 标签：cvs

我正在寻找一个脚本，它获取 CVS 模块的工作副本，执行任何必要的“cvs add”和“cvs remove”命令，并提交所有内容。最终结果是存储库副本变得与工作副本完全相同。

我想我以前见过类似的东西，但我在谷歌上找不到。有没有人用过类似的脚本？我知道我可以运行“cvs -nq update”并自己解析结果，这就是我可能最终会做的事情。但是 CVS 有各种奇怪的边缘情况，所以我想找到一个已经测试过的脚本，如果它存在的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-08T00:09:31.990

I wrote something similar as a macro for [WinCvs](http://cvsgui.sf.net) that still comes bundled with it. You can find it under Macros|CVS|Copy to branch/trunk...

It will prompt you for a branch name to copy the current selection to (just leave blank if you want it copied to the trunk) and then makes all the necessary preparations you mentioned except for the final commit.

I only used it in practice a couple of times myself but it has been out there for a couple of years now and I haven't had any complaints...

From the docstring:

> ======
> Usage:
> 
> *   Select one or more CVS-controlled files or folders.
>     
>     
> *   Run the macro from the Macros|CVS menu.
>     
>     
> *   Enter the name of the branch you want to copy the selection to or just hit OK if you want to copy to `HEAD`.
>     
>     
> 
> =============
> Known Issues / "Un-niceties":
> 
> *   When copying individual files that were added on a branch the automatic adding will not work as CVS will assume the tag of the directory which would be incorrect (this results in a "foo.txt added independently by a second party" error message). It's usually better to always use the macro on directory selections.
>     
>     
> *   An `update -P` in a .cvsrc file could potentially mess up recreation of folders added on a branch, so I explicitly disable use of .cvsrc and set compression fixedly to `-z7` (reasonable IMO). All other .cvsrc options will be lost.

# java - 将预先构造的 Bean 添加到 Spring 应用程序上下文

> ID：496711
> 
> 赞同：24
> 
> 时间：2009-01-30T18:52:31.043
> 
> 标签：java, spring

我正在编写一个实现以下方法的类：

```
public void run(javax.sql.DataSource dataSource); 
```

在此方法中，我希望使用类似于以下的配置文件来构造 Spring 应用程序上下文：

```
<bean id="dataSource" abstract="true" />

<bean id="dao" class="my.Dao">
  <property name="dataSource" ref="dataSource" />
</bean> 
```

是否可以强制 Spring 在配置文件中引用“dataSource”bean 的任何地方使用传递给我的方法的 DataSource 对象？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2010-03-08T17:31:01.507

我一直处于完全相同的情况。由于没有人提出我的解决方案（而且我认为我的解决方案更优雅），我会在这里为后代添加它:-)

解决方案包括两个步骤：

1.  创建父 ApplicationContext 并在其中注册您现有的 bean。
2.  创建子 ApplicationContext（传入父上下文）并从 XML 文件加载 bean

第1步：

```
//create parent BeanFactory
DefaultListableBeanFactory parentBeanFactory = new DefaultListableBeanFactory();
//register your pre-fabricated object in it
parentBeanFactory.registerSingleton("dataSource", dataSource);
//wrap BeanFactory inside ApplicationContext
GenericApplicationContext parentContext = 
        new GenericApplicationContext(parentBeanFactory);
parentContext.refresh(); //as suggested "itzgeoff", to overcome a warning about events 
```

第2步：

```
//create your "child" ApplicationContext that contains the beans from "beans.xml"
//note that we are passing previously made parent ApplicationContext as parent
ApplicationContext context = new ClassPathXmlApplicationContext(
        new String[] {"beans.xml"}, parentContext); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2009-01-31T01:05:33.723

我发现两个 Spring 接口可以用来实现我所需要的。[BeanNameAware](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/BeanNameAware.html)接口允许 Spring通过调用[setBeanName(String)](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/BeanNameAware.html#setBeanName(java.lang.String))方法在应用程序上下文中告诉对象其名称。FactoryBean接口告诉 Spring[不要](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/FactoryBean.html)使用对象本身，而是调用[getObject()](http://static.springframework.org/spring/docs/2.5.x/api/org/springframework/beans/factory/FactoryBean.html#getObject())方法时返回的对象。把它们放在一起，你会得到：

```
public class PlaceholderBean implements BeanNameAware, FactoryBean {

    public static Map<String, Object> beansByName = new HashMap<String, Object>();

    private String beanName;

    @Override
    public void setBeanName(String beanName) {
        this.beanName = beanName;
    }

    @Override
    public Object getObject() {
        return beansByName.get(beanName);
    }

    @Override
    public Class<?> getObjectType() {
        return beansByName.get(beanName).getClass();
    }

    @Override
    public boolean isSingleton() {
        return true;
    }

} 
```

bean 定义现在简化为：

```
<bean id="dataSource" class="PlaceholderBean" /> 
```

占位符在创建应用程序上下文之前接收其值。

```
public void run(DataSource externalDataSource) {
    PlaceholderBean.beansByName.put("dataSource", externalDataSource);
    ApplicationContext context = new ClassPathXmlApplicationContext("beans.xml");
    assert externalDataSource == context.getBean("dataSource");
} 
```

事情似乎很顺利！

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2010-09-21T09:25:05.167

第二种解决方案由于刷新问题导致异常。一种更优雅的方法是将对象添加到上下文中，然后使用 xmlreader 加载 xml 定义。因此：

```
 ObjectToBeAddedDynamically objectInst = new ObjectToBeAddedDynamically();
  DefaultListableBeanFactory parentBeanFactory = new DefaultListableBeanFactory();  
  parentBeanFactory.registerSingleton("parameterObject", objectInst);

  GenericApplicationContext parentContext = new GenericApplicationContext(parentBeanFactory);

  XmlBeanDefinitionReader xmlReader = new XmlBeanDefinitionReader(parentContext);
   xmlReader.loadBeanDefinitions(new FileSystemResource("beandefinitions.xml"));
   parentContext.refresh();

   ObjectUsingDynamicallyAddedObject userObjectInst= (ObjectUsingDynamicallyAddedObject )parentContext.getBean("userObject"); 
```

和

```
 <?xml version="1.0" encoding="UTF-8"?>
    <beans xmlns="http://www.springframework.org/schema/beans"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="userObject" class="com.beanwiring.ObjectUsingDynamicallyAddedObject"
      >
      <constructor-arg ref="parameterObject" />

</bean>

</beans> 
```

工作完美！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T20:23:11.783

您可以为 a 创建一个包装类，`DataSource`它只是委托给一个包含的`DataSource`

```
public class DataSourceWrapper implements DataSource {

DataSource dataSource;

public void setDataSource(DataSource dataSource) {
    this.dataSource = dataSource;
}

@Override
public Connection getConnection() throws SQLException {
    return dataSource.getConnection();
}

@Override
public Connection getConnection(String username, String password)
        throws SQLException {
    return dataSource.getConnection(username, password);
}
//delegate to all the other DataSource methods
} 
```

然后在 Spring 上下文文件中声明`DataSourceWrapper`并将其连接到所有 bean。然后在您的方法中，您将获得对 DataSourceWrapper 的引用，并将包装的 DataSource 设置为传递给您的方法的那个。

这一切工作很大程度上取决于加载时 Spring 上下文文件中发生的情况。如果 bean 要求在上下文加载时 DataSource 已经可用，那么您可能必须编写一个在加载时`BeanFactoryPostProcessor`更改 Spring 上下文文件，而不是在加载后执行操作（尽管可能延迟初始化可以解决此问题） .

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T18:58:22.733

如果你通过调用“new”来创建一个对象，它就不受 Spring 工厂的控制。

为什么不让 Spring 将 DataSource 注入对象而不是将其传递给 run()？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-08-06T14:04:44.173

有一种更优雅的方式，您可以使用外部 xml 文件并使用文件系统资源加载它，然后将其中配置的 bean 注入您的应用程序上下文中。因此：

```
import org.springframework.beans.BeansException;
import org.springframework.beans.factory.InitializingBean;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.beans.factory.support.BeanDefinitionRegistry;
import org.springframework.beans.factory.xml.XmlBeanDefinitionReader;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;
import org.springframework.context.support.GenericApplicationContext;
import org.springframework.core.annotation.Order;
import org.springframework.core.io.FileSystemResource;
import org.springframework.stereotype.Service;

@Service
@Order(-100)
public class XmlBeanInitializationService implements ApplicationContextAware, InitializingBean {

    private ApplicationContext applicationContext;

    @Value("${xmlConfigFileLocation}")
    private String xmlConfigFileLocation;

    @Override
    public void afterPropertiesSet() throws Exception {
        XmlBeanDefinitionReader reader = new XmlBeanDefinitionReader((BeanDefinitionRegistry)applicationContext);
        reader.loadBeanDefinitions(new FileSystemResource(xmlConfigFileLocation));
    }

    @Override
    public void setApplicationContext(ApplicationContext applicationContext) throws BeansException {
        this.applicationContext = applicationContext;

    }
} 
```

其中 ${xmlConfigFileLocation} 是 application.properties 文件中指定的属性，它指向系统中的文件位置，因此：

```
xmlConfigFileLocation="your-file-path-anywhere-in-your-system" 
```

并且您的 xml 文件可能包含：

```
<?xml version="1.0" encoding="UTF-8"?>
    <beans xmlns="http://www.springframework.org/schema/beans"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

        <bean class="com.yourpackage.YourBean1Class"></bean>
        <bean class="com.yourpackage.YourBean2Class"></bean>
        <bean class="com.yourpackage.YourBean3Class"></bean>

    </beans> 
```

因此，当您的应用程序启动时，spring 会加载类并将 bean 加载到应用程序上下文中。

希望这可以帮助某人。

# svn - 如何更正省略了主干的 Subversion 项目？

> ID：496713
> 
> 赞同：5
> 
> 时间：2009-01-30T18:52:49.250
> 
> 标签：svn

我有一个颠覆项目，叫做 inboundem。这是我的第一个，当我创建它时，我省略了主干。我需要将它作为 inboundem/trunk 放入正确的结构中。我有另一个这样的项目，但由于没有修改，我做了`svn delete`，然后`svn import`效果很好。但是我有很多关于 inboundem 的修改，我不想失去历史。

我不能这样做`svn move`，因为 svn 不会让我将项目移入其自身。

我怀疑我需要走下 svnadmin 转储/加载路径，所以我做了：

```
svnadmin dump /subversion/active | svndumpfilter include inboundem > inboundem.dump 
```

这已经创建了一个转储文件，其中包含我所有的 inboundem 历史记录。但是我现在该怎么办？

我怀疑我应该`svn delete`删除项目，然后手动编辑转储文件并将节点路径从 inboundem 更改为 inboundem/trunk，然后执行

```
svnadmin load /subversion/active < inboundem.dump 
```

这安全吗？有没有更简单的方法？也许我应该只是暴力破解它，并将所有修订一一检查，删除项目，然后逐个修订重新创建项目修订。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-01-30T18:58:11.983

```
svn mv svn://repo/inboundem svn://repo/trunk
svn mkdir svn://repo/inboundem
svn mv svn://repo/trunk svn://repo/inboundem/trunk 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T18:55:01.977

为什么不在项目根目录中创建一个名为“trunk”的文件夹，然后将根目录中的所有文件/文件夹移动到该文件夹​​中？

我以前在 Tortoise 中做过这个，我不确定它使用什么底层命令，因为你说 svn move 对你不起作用。也许尝试复制然后删除？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T18:55:27.747

您可以使用 svn export 然后将导出的源移动到 /trunk 然后提交更改（在 /trunk 中添加新文件夹）

然后在旧文件夹上删除（并调用删除），如果必须的话，仍然会有它们的历史供您恢复，但它会将它们恢复到旧文件夹，而不是新主干。svn export 所做的只是将所选目录移动到没有 .svn 文件夹的新位置，这样它就好像它不是工作副本一样，然后您可以从那里将其添加到工作副本中。

# c# - 如果将通用集合实例化为包含 iDisposable 项，这些项是否会被释放？

> ID：496722
> 
> 赞同：4
> 
> 时间：2009-01-30T18:55:02.053
> 
> 标签：c#, .net, idisposable

例如：

```
Queue<System.Drawing.SolidBrush> brushQ = new Queue<System.Drawing.SolidBrush>();
...
brushQ.Clear(); 
```

如果我没有明确地将每个项目出列并单独处理它们，那么在调用 Clear() 时是否会处理剩余的项目？当队列被垃圾收集时怎么样？

假设答案是“否”，那么最佳实践是什么？您是否必须始终遍历队列并处理每个项目？

这可能会变得很难看，特别是如果您必须尝试..finally 围绕每个处置，以防引发异常。

**编辑**

因此，通用集合的用户似乎有责任知道，如果这些项目是一次性的（意味着它们可能正在使用不会被垃圾收集器清理的非托管资源），那么：

1.  当你从集合中移除一个项目时，确保你 Dispose() 它。
2.  不要调用 Clear()。遍历集合并处理每个项目。

也许通用集合的文档应该提到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-01-30T19:04:07.417

通用集合实际上并不知道它们包含的对象的类型，因此调用 Clear 不会导致它们对项目调用 Dispose()。一旦集合本身被处置，GC 最终将处置它们，前提是没有其他任何东西对这些项目之一具有活动引用。

如果要确保在对集合调用 Clear 时调用对象的 Dispose 方法，则需要派生自己的集合并覆盖适当的方法并自己进行调用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T18:58:12.763

您预计它们何时被处置？集合如何知道其中是否存在对对象的其他引用？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-01-30T19:34:24.940

让我看看我是否可以为此编写一个示例代码。

编辑：

以下代码实现了一个 IDisposable 队列：

```
class DisposableQueue<T>:Queue<T>,IDisposable where T:IDisposable

    #region IDisposable Members

    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    public virtual void Dispose(bool disposing) {
        if (disposing) {
            foreach (T type in this) {
                try
                {
                    type.Dispose();
                }
                finally {/* In case of ObjectDisposedException*/}
            }
        }
    }
    #endregion
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T19:14:23.857

正如其他人所说，这不会发生。但是，如果需要，您可以构建自己的扩展方法来处理它们。

# asp.net - Asp.net 和 JavaScript 弹出窗口

> ID：496749
> 
> 赞同：0
> 
> 时间：2009-01-30T19:00:51.167
> 
> 标签：asp.net, javascript

我正在编写一个 Intranet 应用程序，并且正在考虑使用弹出窗口。我不担心可访问性，因为它是一个 Intranet 应用程序。

该场景例如我需要能够在服务器页面以及进程中间使用相同的代码；这就是为什么我决定在过程中间使用它时，最好将它作为一个弹出窗口来用完屏幕上的不动产。

对此有什么想法吗？我对使用弹出窗口的方式犹豫不决，因为我通常只将它用于错误消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T19:19:16.107

我不完全理解您要做什么，但我认为如果用户的浏览器自动阻止弹出窗口，弹出窗口可能会有些问题。另外，如果您试图在弹出窗口中运行一个进程，用户可以关闭它并且不再有办法检查该进程。

是否可以使用 Ajax 回调提供有关进程的页面信息的 Web 服务？您可以为用户提供一种方法来进行 Ajax 调用以检查进程的状态，或者让它在后台不断轮询。

编辑：

你说你对 Ajax 不太熟悉。在大多数情况下，有一些库可以处理所有硬细节。我会推荐[jQuery](http://docs.jquery.com/Ajax)，因为我已经使用了一段时间了。

如果您采用 Ajax 路线，您将能够在一个页面上包含所有内容，并在 Ajax 调用成功时进行所需的更新。根据你编写代码的方式，如果你做得对，它应该是非常可重用的。这实际上取决于您对每个页面的需求的具体程度。

不过，请查看 jQuery 文档。它可能已经内置了您需要的东西。否则，其他人可能会提出一些为什么他们最喜欢的 JavaScript 库更适合您尝试做的事情的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T20:05:57.387

我想你可能想做这样的事情：

父页面内部：

```
<input id="btnShowModal" runat="server" type="button" value='Show Modal' onclick="ShowModal()" />

function ShowModal()
{
   var retVal = window.showModalDialog("MyPopup.aspx?param1=value","","center=yes;dialogWidth=200px;dialogHeight=200px;status:0;help:0")

   if(retVal !=  "" && retVal != undefined)
   {
       //This code will be executed when the modal popup is closed, retVal will contain the value assigned to window.returnValue               
    }
} 
```

在模态弹出窗口内部：

```
<input id="btnSave" runat="server" type="button" value='Save' onclick="Save()" />

function Save()
{
   window.returnValue = "Whatever you want returned to the parent here"
   window.close()
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T19:17:13.880

反对弹出窗口的通常论点是它们不可靠。用户可能禁用了脚本启动的弹出窗口，我知道我有。
在受控环境中，例如 Inranet，您可能可以保证情况并非如此，但即便如此，为什么要冒险，还有另一种选择。
无需弹出一个新窗口，只需将一个新的、绝对定位的 <div> 插入到文档中，然后使用 ajax 甚至 <iframe> 将您的内容插入其中。网络上有很多示例/库。例如 jQuery 的
[厚盒。](http://jquery.com/demo/thickbox/)当然有些脚本不需要库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T19:27:45.857

我试图避免使用 AJAX，只是因为我从未使用过并且现在没有时间学习它。不过，我并不完全反对。

简而言之，我需要做的是弹出窗口与页面交互。想象一下，在页面上我正在构建链的链接。每个链接都有独特的属性。当用户点击“添加链接”按钮时，我在想有一个带有小表单和保存按钮的弹出窗口。唯一的问题是弹出窗口需要与页面交互；我们需要知道某些东西何时被保存或未被保存。

同一页面上的 div 是一种方法。弹出窗口是另一种方式。另一个问题是这段代码（添加新链接）需要可重用，因为我还将拥有一个只创建新链接的页面。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T20:13:07.823

我通常使用带有 z-index 和绝对定位的 div；.show() 可以按需编写和调用，它会有一个用于 .close() 的按钮，并且 AJAX 可以使它看起来像模态，因此如果您愿意，必须单击它来关闭它。再说一次，我讨厌消息框。

# iphone - 单击后刷新 NSTableView - 不刷新

> ID：496750
> 
> 赞同：-1
> 
> 时间：2009-01-30T19:01:18.763
> 
> 标签：iphone

我有一个带有 UITableView 的应用程序，同时使用图标和显示按钮。我想用“已选择”图标更新一行上的图标，并用“未选择”图标更新先前选择的行。我有代码，但是当我单击行时，它会将两行都设置为“选定”状态，即使通过调试我可以看到我的状态变量被设置为正确的行。如果我继续单击行，有时会显示“未选择”状态。我怀疑这是一个刷新问题，但我已经在单元格和 tableView 本身上尝试了 setNeedsDisplay 方法，但没有运气。有人遇到过这个吗？顺便说一句，这是在模拟器（2.2.1）中 - 尚未在设备上尝试过。

这是代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
    {
        int newRow = [indexPath row];
        int oldRow = [lastIndexPath row];

        if (newRow != oldRow)
        {
            [[tableView cellForRowAtIndexPath:indexPath] setImage: [UIImage imageNamed:@"IsSelected.png"]];

            c_oListPtr.c_sCurItem = [[tableView cellForRowAtIndexPath:indexPath] text];

            [[tableView cellForRowAtIndexPath:lastIndexPath] setImage: [UIImage imageNamed:@"NotSelected.png"]];

            [lastIndexPath release];
            lastIndexPath = indexPath;

            [[tableView cellForRowAtIndexPath:lastIndexPath] setNeedsDisplay];
            [[tableView cellForRowAtIndexPath:indexPath] setNeedsDisplay];
            [tableView setNeedsDisplay];
        }

        [tableView deselectRowAtIndexPath:indexPath animated:YES];
    } 
```

谢谢-迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T21:47:01.410

你试过`[tableView reloadData]`吗？

# encoding - VBScript中的Base64编码字符串

> ID：496751
> 
> 赞同：31
> 
> 时间：2009-01-30T19:01:22.400
> 
> 标签：encoding, vbscript, base64, wsh

我有一个 Web 服务加载驱动程序，它是一个 Windows 脚本文件 (WSF)，其中包括一些 VBScript 和 JavaScript 文件。我的 Web 服务要求传入的消息是 base64 编码的。我目前有一个 VBScript 函数可以执行此操作，但效率非常低（内存密集型，主要是由于 VBScripts 糟糕的字符串连接）

*[在旁边; 是的，我看过[Jeff 的最新博文](http://www.codinghorror.com/blog/archives/001218.html)。连接发生在一个循环中，跨越大小为 1,000 到 10,000 字节的消息。]*

我尝试过使用一些自定义字符串连接例程；一个使用数组，一个使用 ADODB.Stream。这些有一点帮助，但我认为如果我有其他方式来编码消息而不是通过我自己的 VBS 函数，它会更有帮助。

是否有其他方式对我的消息进行编码，最好使用本机 Windows 方法？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2009-02-03T13:03:25.473

我最初使用的是 Antonin Foller 的一些 VBScript 代码： [Base64 Encode VBS Function](http://www.motobit.com/tips/detpg_Base64Encode/)和[Base64 Decode VBS Function](http://www.motobit.com/tips/detpg_Base64/)。

搜索 Antonin 的网站，我看到他有一些[引用可打印编码的代码，使用 CDO.Message 对象](http://www.motobit.com/tips/detpg_quoted-printable-encode/)，所以我尝试了一下。

最后，我移植了 Mark 对 VBScript 的回答中提到的代码（也使用了[这个](https://stackoverflow.com/questions/188793/can-i-use-vbscript-to-base64-encode-a-gif)SO question 中的一些代码），并使用了Antonin 网站上的[Stream___StringToBinary](http://www.motobit.com/tips/detpg_BinASP/)和[Stream_BinaryToString](http://www.motobit.com/tips/detpg_binarytostring/)函数来获取使用 MSXML 编码的函数。

我运行了一个快速测试来测量所有四种方法中 1,500 个字符的消息（我需要发送到我的 Web 服务的平均消息大小）的编码时间：

*   本机 VBScript (VBScript)
*   引用可打印，使用 CDO.Message (QP)
*   引用的可打印二进制文件，使用 CDO.Message（QP 二进制文件）
*   MSXML/ADODB.Stream (MSXML)

结果如下：

```
迭代次数：10,000
消息大小：1,500

+-------------+------------+
+ 方法 | 时间（毫秒） +
+-------------+------------+
| VB脚本 | 301,391 |
+-------------+------------+
| QP | 12,922 |
+-------------+------------+
| QP（二进制）| 13,953 |
+-------------+------------+
| MSXML | 3,312 |
+-------------+------------+

```

我还在测试运行时监控了内存利用率（Windows 任务管理器中 cscript.exe 进程的内存使用情况）。我没有任何原始数字，但引用的可打印和 MSXML 解决方案的内存利用率均低于 VBScript 解决方案（前者为 7,000K，VBScript 约为 16,000K）。

我决定为我的驱动程序使用 MSXML 解决方案。对于那些感兴趣的人，这是我正在使用的代码：

```
base64.vbs
Function Base64Encode(sText)
    Dim oXML, oNode

    Set oXML = CreateObject("Msxml2.DOMDocument.3.0")
    Set oNode = oXML.CreateElement("base64")
    oNode.dataType = "bin.base64"
    oNode.nodeTypedValue =Stream_StringToBinary(sText)
    Base64Encode = oNode.text
    Set oNode = Nothing
    Set oXML = Nothing
End Function

Function Base64Decode(ByVal vCode)
    Dim oXML, oNode

    Set oXML = CreateObject("Msxml2.DOMDocument.3.0")
    Set oNode = oXML.CreateElement("base64")
    oNode.dataType = "bin.base64"
    oNode.text = vCode
    Base64Decode = Stream_BinaryToString(oNode.nodeTypedValue)
    Set oNode = Nothing
    Set oXML = Nothing
End Function

'Stream_StringToBinary Function
'2003 Antonin Foller, http://www.motobit.com
'Text - string parameter To convert To binary data
Function Stream_StringToBinary(Text)
  Const adTypeText = 2
  Const adTypeBinary = 1

  'Create Stream object
  Dim BinaryStream 'As New Stream
  Set BinaryStream = CreateObject("ADODB.Stream")

  'Specify stream type - we want To save text/string data.
  BinaryStream.Type = adTypeText

  'Specify charset For the source text (unicode) data.
  BinaryStream.CharSet = "us-ascii"

  'Open the stream And write text/string data To the object
  BinaryStream.Open
  BinaryStream.WriteText Text

  'Change stream type To binary
  BinaryStream.Position = 0
  BinaryStream.Type = adTypeBinary

  'Ignore first two bytes - sign of
  BinaryStream.Position = 0

  'Open the stream And get binary data from the object
  Stream_StringToBinary = BinaryStream.Read

  Set BinaryStream = Nothing
End Function

'Stream_BinaryToString Function
'2003 Antonin Foller, http://www.motobit.com
'Binary - VT_UI1 | VT_ARRAY data To convert To a string 
Function Stream_BinaryToString(Binary)
  Const adTypeText = 2
  Const adTypeBinary = 1

  'Create Stream object
  Dim BinaryStream 'As New Stream
  Set BinaryStream = CreateObject("ADODB.Stream")

  'Specify stream type - we want To save binary data.
  BinaryStream.Type = adTypeBinary

  'Open the stream And write binary data To the object
  BinaryStream.Open
  BinaryStream.Write Binary

  'Change stream type To text/string
  BinaryStream.Position = 0
  BinaryStream.Type = adTypeText

  'Specify charset For the output text (unicode) data.
  BinaryStream.CharSet = "us-ascii"

  'Open the stream And get text/string data from the object
  Stream_BinaryToString = BinaryStream.ReadText
  Set BinaryStream = Nothing
End Function 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-10-18T21:06:56.583

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-08-05T15:04:30.047

在没有 ADODB.Stream 和 MSXml2.DOMDocument 的情况下，可以在纯 vbscript 中编码 base64。

例如：

```
Function btoa(sourceStr)
    Dim i, j, n, carr, rarr(), a, b, c
    carr = Array("A", "B", "C", "D", "E", "F", "G", "H", _
            "I", "J", "K", "L", "M", "N", "O" ,"P", _
            "Q", "R", "S", "T", "U", "V", "W", "X", _
            "Y", "Z", "a", "b", "c", "d", "e", "f", _
            "g", "h", "i", "j", "k", "l", "m", "n", _
            "o", "p", "q", "r", "s", "t", "u", "v", _
            "w", "x", "y", "z", "0", "1", "2", "3", _
            "4", "5", "6", "7", "8", "9", "+", "/")
    n = Len(sourceStr)-1
    ReDim rarr(n\3)
    For i=0 To n Step 3
        a = AscW(Mid(sourceStr,i+1,1))
        If i < n Then
            b = AscW(Mid(sourceStr,i+2,1))
        Else
            b = 0
        End If
        If i < n-1 Then
            c = AscW(Mid(sourceStr,i+3,1))
        Else
            c = 0
        End If
        rarr(i\3) = carr(a\4) & carr((a And 3) * 16 + b\16) & carr((b And 15) * 4 + c\64) & carr(c And 63)
    Next
    i = UBound(rarr)
    If n Mod 3 = 0 Then
        rarr(i) = Left(rarr(i),2) & "=="
    ElseIf n Mod 3 = 1 Then
        rarr(i) = Left(rarr(i),3) & "="
    End If
    btoa = Join(rarr,"")
End Function

Function char_to_utf8(sChar)
    Dim c, b1, b2, b3
    c = AscW(sChar)
    If c < 0 Then
        c = c + &H10000
    End If
    If c < &H80 Then
        char_to_utf8 = sChar
    ElseIf c < &H800 Then
        b1 = c Mod 64
        b2 = (c - b1) / 64
        char_to_utf8 = ChrW(&HC0 + b2) & ChrW(&H80 + b1)
    ElseIf c < &H10000 Then
        b1 = c Mod 64
        b2 = ((c - b1) / 64) Mod 64
        b3 = (c - b1 - (64 * b2)) / 4096
        char_to_utf8 = ChrW(&HE0 + b3) & ChrW(&H80 + b2) & ChrW(&H80 + b1)
    Else
    End If
End Function

Function str_to_utf8(sSource)
    Dim i, n, rarr()
    n = Len(sSource)
    ReDim rarr(n - 1)
    For i=0 To n-1
        rarr(i) = char_to_utf8(Mid(sSource,i+1,1))
    Next
    str_to_utf8 = Join(rarr,"")
End Function

Function str_to_base64(sSource)
    str_to_base64 = btoa(str_to_utf8(sSource))
End Function

'test

msgbox btoa("Hello")   'SGVsbG8=
msgbox btoa("Hell")    'SGVsbA==

msgbox str_to_base64("中文한국어")  '5Lit5paH7ZWc6rWt7Ja0 
```

如果您的字符串中有宽字符（*AscW(c) > 255 或 < 0*），您可以在调用 btoa 之前将其转换为 utf-8。

utf-8 转换也可以用纯 vbscript 编写。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2010-06-12T20:20:53.940

所以我还有一些其他完整的编码器和解码器示例：

编码器：

```
' This script reads jpg picture named SuperPicture.jpg, converts it to base64
' code using encoding abilities of MSXml2.DOMDocument object and saves
' the resulting data to encoded.txt file

Option Explicit

Const fsDoOverwrite     = true  ' Overwrite file with base64 code
Const fsAsASCII         = false ' Create base64 code file as ASCII file
Const adTypeBinary      = 1     ' Binary file is encoded

' Variables for writing base64 code to file
Dim objFSO
Dim objFileOut

' Variables for encoding
Dim objXML
Dim objDocElem

' Variable for reading binary picture
Dim objStream

' Open data stream from picture
Set objStream = CreateObject("ADODB.Stream")
objStream.Type = adTypeBinary
objStream.Open()
objStream.LoadFromFile("SuperPicture.jpg")

' Create XML Document object and root node
' that will contain the data
Set objXML = CreateObject("MSXml2.DOMDocument")
Set objDocElem = objXML.createElement("Base64Data")
objDocElem.dataType = "bin.base64"

' Set binary value
objDocElem.nodeTypedValue = objStream.Read()

' Open data stream to base64 code file
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFileOut = objFSO.CreateTextFile("encoded.txt", fsDoOverwrite, fsAsASCII)

' Get base64 value and write to file
objFileOut.Write objDocElem.text
objFileOut.Close()

' Clean all
Set objFSO = Nothing
Set objFileOut = Nothing
Set objXML = Nothing
Set objDocElem = Nothing
Set objStream = Nothing 
```

解码器：

```
' This script reads base64 encoded picture from file named encoded.txt,
' converts it in to back to binary reprisentation using encoding abilities
' of MSXml2.DOMDocument object and saves data to SuperPicture.jpg file

Option Explicit

Const foForReading          = 1 ' Open base 64 code file for reading
Const foAsASCII             = 0 ' Open base 64 code file as ASCII file
Const adSaveCreateOverWrite = 2 ' Mode for ADODB.Stream
Const adTypeBinary          = 1 ' Binary file is encoded

' Variables for reading base64 code from file
Dim objFSO
Dim objFileIn
Dim objStreamIn

' Variables for decoding
Dim objXML
Dim objDocElem

' Variable for write binary picture
Dim objStream

' Open data stream from base64 code filr
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFileIn   = objFSO.GetFile("encoded.txt")
Set objStreamIn = objFileIn.OpenAsTextStream(foForReading, foAsASCII)

' Create XML Document object and root node
' that will contain the data
Set objXML = CreateObject("MSXml2.DOMDocument")
Set objDocElem = objXML.createElement("Base64Data")
objDocElem.DataType = "bin.base64"

' Set text value
objDocElem.text = objStreamIn.ReadAll()

' Open data stream to picture file
Set objStream = CreateObject("ADODB.Stream")
objStream.Type = adTypeBinary
objStream.Open()

' Get binary value and write to file
objStream.Write objDocElem.NodeTypedValue
objStream.SaveToFile "SuperPicture.jpg", adSaveCreateOverWrite

' Clean all
Set objFSO = Nothing
Set objFileIn = Nothing
Set objStreamIn = Nothing
Set objXML = Nothing
Set objDocElem = Nothing
Set objStream = Nothing 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-03-22T17:58:53.263

这是一个不使用 ADODB 对象的解码示例。

```
option explicit
dim inobj,outobj,infile,myname,state,rec,outfile,content,table(256),bits,c,x,outword
state = 0
const r64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
myname = wscript.scriptfullname
set inobj = createobject("Scripting.FileSystemObject")
set outobj = createobject("Scripting.FileSystemObject")
set infile = inobj.opentextfile(myname,1)
set outfile = outobj.createtextfile("q.png")
for x = 1 to 256 step 1
    table(x) = -1
next
for x = 1 to 64 step 1
    table(1+asc(mid(r64,x,1))) = x - 1
next
bits = 0
do until(infile.atendofstream)
    dim size
    rec = infile.readline
    if (state = 1) then 
        content = mid(rec,2)
        size = len(content)
        for x = 1 to size step 1
            c = table(1+asc(mid(content,x,1)))
            if (c <> -1) then
                if (bits = 0) then
                    outword = c*4
                    bits = 6
                elseif (bits = 2) then
                    outword = c+outword
                    outfile.write(chr(clng("&H" & hex(outword mod 256))))
                    bits = 0
                elseif (bits = 4) then
                    outword = outword + int(c/4)
                    outfile.write(chr(clng("&H" & hex(outword mod 256))))
                    outword = c*64
                    bits = 2
                else
                    outword = outword + int(c/16)
                    outfile.write(chr(clng("&H" & hex(outword mod 256))))
                    outword = c*16
                    bits = 4
                end if
            end if
        next
    end if
    if (rec = "'PAYLOAD") then
        state = 1
    end if
loop
infile.close
outfile.close
wscript.echo "q.png created"
wscript.quit
'PAYLOAD
'iVBORw0KGgoAAAANSUhEUgAAAD4AAAA+CAIAAAD8oz8TAAABoklEQVRo3u2awQrDMAxDl7H/
'/+Xu0EsgSDw7hRF7vWywpO0UW5acjOu6Xmde79ex1+f+GGPACfcqzePXdVvvts7iv6rx56Ou
'8FNYkgyZx9xzZ3TVHfg7VEHdR+o6ZsWV54O/yDvUQj2KzYyH5wof5f14fR97xdPrmjy1ArVQ
'55yteMYzEqma5B2qoM5VBK+OuXUrHutjJ8c59l4z/vV6Vv15PbOjiFRunB/rOcYgIz1jEPek
'nnh+rBPsiYbOaRu/DipzKrqkqNOJdgEIF3mNVLGa7jM9YSReg+t6U/UvFTYqmn13gGeUr9C1
'ul85rlCVgVTHnGeo2xGIdnT3PRR3vbUYhjAJqXxRHxTtslfsrxOe8aziWdlnAukRVPGmuX9P
'KnG0y9Wjv+71IPf8JEMIZxeP9ZHDkvO0z6XoXmlF1APTMIpR38R5qd8ZAa7gc76JaMl+ZwR4
'N0vdn6hRf89+ZwRIXZy/e473bks9sd9uterERvmbKP4end6cVlFRHt2n9mxTN9b3PTzfIco5
'4Ip9mGd1ud8bUriS3Oh6RuC318GofwHqKhl/Nn0DHQAAAABJRU5ErkJggg== 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2019-06-27T18:26:17.590

So you can use this object to Encode or Decode Base64 = `CreateObject("Msxml2.DOMDocument.3.0")`

And use Array to Encode or Decode It.

More info [VBS_Array](https://www.tutorialspoint.com/vbscript/vbscript_arrays.htm)

Here is my way :

```
Function Base64Encode(sText)
 Set oNode = CreateObject("Msxml2.DOMDocument.3.0").CreateElement("base64")
 oNode.dataType = "bin.base64"
 oNode.nodeTypedValue =Stream_StringToBinary(sText)
 Base64Encode = oNode.text
 Set oNode = Nothing
End Function

Function Base64Decode(ByVal vCode)
 Set oNode = CreateObject("Msxml2.DOMDocument.3.0").CreateElement("base64")
 oNode.dataType = "bin.base64"
 oNode.text = vCode
 Base64Decode = Stream_BinaryToString(oNode.nodeTypedValue)
 Set oNode = Nothing
End Function

Function Stream_StringToBinary(Text)
 Set BinaryStream = CreateObject("ADODB.Stream")
 BinaryStream.Type = 2
' All Format =>  utf-16le - utf-8 - utf-16le
 BinaryStream.CharSet = "us-ascii"
 BinaryStream.Open
 BinaryStream.WriteText Text
 BinaryStream.Position = 0
 BinaryStream.Type = 1
 BinaryStream.Position = 0
 Stream_StringToBinary = BinaryStream.Read
 Set BinaryStream = Nothing
End Function

Function Stream_BinaryToString(Binary)
 Set BinaryStream = CreateObject("ADODB.Stream")
 BinaryStream.Type = 1
 BinaryStream.Open
 BinaryStream.Write Binary
 BinaryStream.Position = 0
 BinaryStream.Type = 2
 ' All Format =>  utf-16le - utf-8 - utf-16le
 BinaryStream.CharSet = "utf-8"
 Stream_BinaryToString = BinaryStream.ReadText
 Set BinaryStream = Nothing
End Function

''''''''''''''''''''''''''''''''''''''''''''''Testing'''''''''''''''''''''''''''''''''''''''''

arr=array("Hello","&Welcome","To My Program")
For Each Endcode In arr
 WSH.Echo Base64Encode(Endcode)
Next

arr=array("2LPZhNin2YU==","R29vZA==","QnkhIQ==")
For Each Decode In arr
 WSH.Echo Base64Decode(Decode)
Next 
```

# abap - 在哪里可以找到新手 BAPI 编码指南？

> ID：496760
> 
> 赞同：1
> 
> 时间：2009-01-30T19:03:47.620
> 
> 标签：abap, bapi

一段时间以来，我一直在处理通过 Web 服务与 SAP 交互的应用程序，并且我也想着手编写 Web 服务背后的 BAPI。我的公司一直在使用 SAP 顾问进行 BAPI 编程，我也想担任该职位。

作为最终用户，我对 SAP 的核心功能有相当多的经验，所以我在这方面并不完全陌生。但我以前从未做过任何 BAPI 编程，而且我很难找到好的初学者指南。我想为有经验的程序员找到一些东西，将您从 SAP 的“hello world”等价物带到编写业务关键 BAPI。

我听说 BAPI 编码类似于 SQL 中的编码，是这样吗？

另外，我想找到一个免费的在线指南，但我意识到这可能是一厢情愿的想法，所以任何综合性书籍也会有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-31T08:05:02.613

我不确定在线资源，但是有几本很好的书可以学习 ABAP 编程，您会寻找 ABAP 基础知识和/或 ABAP 对象（后者听起来更好，更“高级”，但通常是只是该语言的更现代版本）。我过去使用过的一个非常有用的建议是[这本书](http://www.amazon.de/ABAP-Objects-w-2-CD-ROM/dp/0201750805/ref=sr_1_9?ie=UTF8&s=books-intl-de&qid=1233388055&sr=1-9 "霍斯特凯勒书")。由于这些是“企业书籍”，因此请准备好花比平装书更多的钱。

应涵盖的主题：

*   数据字典（用于定义表、结构等的 SAP 术语）
*   报告编程
*   GUI 编程（不是必需的）
*   函数（不确定“Funktionsbaustein”的英文翻译，它是一个带有参数等的函数，但在数据字典中定义）
*   交易

这将是您在了解 BAPI 之前应该了解的一些基础知识。

BAPI 只是 SAP 提供的函数（以 ABAP 编码并且可扩展），它们在版本之间更“稳定”（即它们不会发生太大变化），并且可以从 SAP 系统内部或从“外部”（另一个SAP 系统或非 SAP 程序）。

SAP 提供了很多 BAPI（如果需要，可以添加自己的），允许程序执行很多/更多用户可以通过 SAPGUI 执行的操作。尽管 SAP 的偏好“每天”都在变化，但它是在比 ABAP 更高级别上对 SAP 系统进行编程的首选方式，可与纯 Java 与使用复杂类库的编程相媲美。

很多 ABAP 编程就像在 4GL 中工作（这就是它曾经被称为 ABAP/4 的原因），大量处理您正在读取/写入数据库的数据，而且还要将这些数据输出给用户并处理用户输入。我将其描述为 COBOL 和 VB 之间的一种奇怪的混合体，当然，这是一项很好的技能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T15:27:00.677

您的开发人员所说的“BAPI 编码”实际上是 RFC 编码。BAPI 是一种面向对象的编码方法，其中每个方法都是一个 RFC。如果你想编写 RFC（远程功能调用），那么这里有一个很好的循序渐进的 RFC 教程：

[http://help.sap.com/saphelp_nw04/helpdata/en/26/64f61dfa8911d386e70000e82011b8/content.htm](http://help.sap.com/saphelp_nw04/helpdata/en/26/64f61dfa8911d386e70000e82011b8/content.htm) （只有第 1 步和第 2 步对您来说真正重要）

最大的初学者错误是：

*   *未*设置远程可调用标志

但请注意，ABAP 看起来很简单，而且我见过一些开发人员编写的糟糕的东西，他们认为了解语法和 SE11 就足够了。作为初级 ABAPer，您应该始终让高级 ABAP 编码人员审查您的规范/代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-05-11T09:14:32.570

BAPI 编程也有一些细节——不仅仅是接口是稳定的，或者是 RFC 功能模块的花哨名称。

如果要将可远程调用的 ABAP 功能模块称为 BAPI，则它必须满足特定的事务标准 (ACID)。

请参阅[http://help.sap.com/saphelp_nw04/helpdata/en/a5/3ec8654ac011d1894e0000e829fbbd/frameset.htm](http://help.sap.com/saphelp_nw04/helpdata/en/a5/3ec8654ac011d1894e0000e829fbbd/frameset.htm)

# java - 为非常简单的类实现 `hashCode()`

> ID：496779
> 
> 赞同：9
> 
> 时间：2009-01-30T19:07:17.020
> 
> 标签：java, hashcode

我有一个非常简单的类，只有一个字段成员（例如字符串）。可以实现`hashCode()`简单地返回`fieldMember.hashCode()`吗？或者我应该以某种方式操纵该字段的哈希码？另外，如果我应该操纵它，那是为什么呢？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-01-30T19:10:29.980

如果 fieldMember 是唯一标识对象的好方法，我会说是的。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-30T19:16:40.123

[Joshua Bloch 在“Effective Java”第 3 章](http://java.sun.com/developer/Books/effectivejava/Chapter3.pdf)中阐述了如何正确覆盖 equals 和 hashCode 。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-30T19:49:00.697

乘法、加法或异或不会使其更加独特。从数学上讲，您会将常量函数应用于单个变量，这不会增加变量可能值的数量。

这种技术对于组合多个哈希码并仍然保持相对较小的冲突风险很有用；它与单个哈希码无关。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-01-30T19:09:22.070

是的，这很标准。如果类反映了数据库行，我只返回主键。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-01-30T19:46:00.483

只有两个真正的要求`hashCode`：第一，`equals`实例具有相同的哈希码，第二，`hashCode`运行速度相当快。第一个要求是实践中最重要的要求；没有它，您可以将某些东西放入集合中，但在那里找不到。第二个只是性能问题。

如果您的字段的哈希码算法满足上述条件，那么它的算法也适用于您的类，如果您的类`equals`也仅取决于这些字段是否为`equals`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-01-30T19:50:59.007

如果“fieldMember”变量已经实现了“hashCode”函数，那么你可以直接从你的父类中使用它。如果 'fieldMember' 变量是自定义类实例，则必须自己正确实现。阅读[java.lang.Object](http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Object.html#hashCode()) API 文档作为实现“hashCode”的指南。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-01-30T19:18:00.213

是的。这是很好的编程习惯。我通常使用：

返回变量^ 1；

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-01-30T20:42:45.673

通常，除非您将此对象用作 *HashMap 的键或 *HashSet 中的元素，否则不需要覆盖 hashCode()。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2009-02-02T16:58:17.013

正如其他人提到的，您应该遵循 Effective Java 中的建议。如果你重写 hashCode() 方法，你也应该重写 equals() 方法。此外，这两种方法应该是一致的。

为了简化编写好的 equals() 和 hashCode() 方法，我使用Apache Commons Lang 的[EqualsBuilder](http://commons.apache.org/lang/api/org/apache/commons/lang/builder/EqualsBuilder.html)和[HashCodeBuilder](http://commons.apache.org/lang/api/org/apache/commons/lang/builder/HashCodeBuilder.html)

以下是示例：

```
public boolean equals(Object o) {
    if (this == o) {
        return true;
    }
    if (o == null || getClass() != o.getClass()) {
        return false;
    }
    User other = (User) o;
    return new EqualsBuilder()
            .append(this.getUniqueId(), other.getUniqueId())
            .isEquals();
}

public int hashCode() {
    return new HashCodeBuilder()
            .append(this.getUniqueId())
            .toHashCode();
} 
```

# .net - LINQBridge 用户：功能齐全吗？

> ID：496787
> 
> 赞同：2
> 
> 时间：2009-01-30T19:08:53.493
> 
> 标签：.net, linq, linqbridge

对于桌面程序员，您是否避免在客户端计算机上部署 .NET 3.5 框架，因为它[占用空间大](http://www.west-wind.com/weblog/posts/292203.aspx)？如果是这样，[LINQBridge](http://www.albahari.com/nutshell/linqbridge.aspx)功能是否完整？

[编辑]

.NET 3.5 Framework 唤起了 OLE 2.0（又名 COM）的感觉。当 2.0 新出来的时候，一些用户就在问是否会有 OLE 版本 3.0。但不会有。OLE 2.0 是一个可靠的体系结构，可以在不触及底层体系结构的情况下进行所有未来的改进。

我认为 .NET Framework 2.0 的 CLR 与坚实的架构相同，无需更改底层架构以适应未来的改进。.NET 3.5 的发布无需更改其底层 CLR(2.0)。如果微软可以在不改变底层架构（CLR 2.0）的情况下改进 .NET（5.0），这证明 CLR 2.0 从一开始就有良好的基础，对他们表示敬意。

JVM 也不能这样说，它的基础是有缺陷的。他们的泛型无法从其 VM/CLR 中获得一流的支持。

话虽如此，.NET 3.5 只是额外的库，其中一些我不需要的功能，一些我可以愉快地交换（例如 LINQBridge）。其余的只是[语法糖](http://codebetter.com/blogs/james.kovacs/archive/2008/01/15/syntactic-sugar-compiler-candy-and-other-sweets.aspx)（不依赖于 3.5）。仍然可以继续使用 VS 2008，面向 .NET 2.0（仅 20 MB），但仍然可以获得简洁的功能：lambda、扩展方法、推断变量、匿名类型、自动属性等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T19:15:38.097

我使用 LINQBridge 是因为我们这里有一些用户在 Win2k 上使用的 PC，因此不支持 .net 3.5。我发现 IEnumberable 的东西非常好，它的性能与微软不相上下。但是，它缺少整个 IQueryable 的东西，而且我认为它没有 XElement 的东西或 LINQ-TO-SQL 的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T19:11:57.993

庞大的规模？即使是 200mb，这真的很重要吗？戴上一次就开心了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T19:19:47.073

必须在 500 多台计算机上安装 200mb（就像我们在这里必须做的那样）是一种巨大的痛苦。

您可以使用 ASUS 来帮助发送垃圾邮件，但 200MB 的空间仍然很大。

话虽如此，是的。它让我们停下来重新考虑是迁移到 3.5 还是继续在 2.0 中编写所有内容。在这一点上，我们正在用 2.0 编写大部分内容，并且我们正在根据需要将 3.5 分发给机器，以用于我们使用 3.5 的一次性项目。

当我们实现了 3.5 的良好用户群并且旧机器（具有较小驱动器）已被消耗所取代时，那么我们可能会完全迁移到 3.5 框架。

到那时，MS 可能会有 5.0，但是，嘿.. 我们正在前进。=)

至于LinqBridge……不。如果我要使用 Linq 编写代码，我会正确地做，而不是半途而废。

# c++ - C++ 字符串到布尔数组

> ID：496789
> 
> 赞同：2
> 
> 时间：2009-01-30T19:09:42.133
> 
> 标签：c++, string, binary

我有一个约 100 位的字符串，它表示以 10 为底的数字，我想将其转换为表示以 2 为底的数字的字符串，或以二进制表示数字的数字的 bool 数组。我可以使用 BigInteger 在 Java 中轻松地做到这一点，但我不确定 C++ 中是否有等价物。

功能将类似于：

字符串 toBinaryString（字符串 numInDecimal）；

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T19:27:51.677

使用[http://gmplib.org](http://gmplib.org)上提供的 GNU 多精度算术库 (GMP) 。然后[mpz set str](http://gmplib.org/manual/Assigning-Integers.html#Assigning-Integers)可能是您从字符串创建“BigInteger”所需的。并且[mpz get str](http://gmplib.org/manual/Converting-Integers.html#Converting-Integers)再次创建一个字符串。这两个函数都以基数作为参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T19:25:21.697

不幸的是，没有标准的 C++ 类/函数可以做到这一点。无论如何，在这里至少给你一些帮助是一些或多或少有用的起点来开发你自己的 bigInt C++ 类：

[StackOverflow：如何在 C++ 中实现大整数](https://stackoverflow.com/questions/269268/how-to-implement-big-int-in-c)

[SourceForge：C++ BigInt 类](http://sourceforge.net/projects/cpp-bigint/)

[Matt McCutchen：BigInt 类](http://mattmccutchen.net/bigint)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T19:18:27.717

呃...二进制中有很多数字，你将有一些有趣的时间来处理它。

要么，要么你可以使用[GMP](http://gmplib.org/)来帮助你......

# sql - 如何：匹配（搜索空间）与（与其他表中的列连接）

> ID：496799
> 
> 赞同：1
> 
> 时间：2009-01-30T19:14:07.397
> 
> 标签：sql, mysql, full-text-search

我不擅长 SQL 查询，所以这可能是一个愚蠢的问题。但是，这大致是我想做的事情：

> 表语料库//我想通过标题正文搜索的东西...
> 
> 表搜索//要应用于语料库的搜索词列表 term
> ...

我想写的查询或多或少如下：我相信我需要某种连接，但我不知道该怎么做。此外，我不确定 against() 运算符是否会采用除文字之外的任何内容 - 文档似乎没有提及任何一种方式。

> select * from corpuses where match (title, body) against (select term from search);

我正在使用 MySQL 5

任何想法都非常感谢。

谢谢！布赖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T19:33:37.513

听起来您需要在连接条件中使用 FULLTEXT 匹配表达式。

我从来没有在连接条件中使用全文匹配，所以我不确定这是否可行，但假设这可能会做到：

```
SELECT DISTINCT c.*
FROM corpuses c JOIN searches s 
  ON (MATCH(c.title, c.body) AGAINST (s.term)); 
```

* * *

好的，我已经使用您的表定义和 MySQL 手册中的一些示例数据进行了尝试。这是一个有效的查询（用 MySQL 5.1.30 测试）：

```
SELECT *
FROM corpuses 
WHERE MATCH(title, body)
  AGAINST ( (SELECT GROUP_CONCAT(term SEPARATOR ' ') FROM searches) 
    IN BOOLEAN MODE); 
```

# sql-server-2005 - 用完整版替换 SQL Server 2005 Express Management Studio

> ID：496805
> 
> 赞同：2
> 
> 时间：2009-01-30T19:15:20.640
> 
> 标签：sql-server-2005, installation, ssms

我一直在运行 SQL Server 2005 Express Management Studio（“SSMSE”），现在需要安装完整版的 Management Studio（“SSMS”）。这是一个已知的麻烦，但我还没有找到一个全面的方法来执行它。

起初，我卸载了 SSMSE，然后运行`SqlRun_Tools.msi`安装工具集。我收到此错误消息：

```
A component that you have specified in the ADD_LOCAL property is already
installed. To upgrade the existing component, refer to the template.ini
and set the UPGRADE property to the name of the component. 
```

我不知道 template.ini 是什么。[因此，我环顾四周，并决定按照 Microsoft 在 KB 909967 “如何手动卸载 SQL Server 2005 实例”](http://support.microsoft.com/default.aspx/kb/909967)中的建议卸载我计算机上的 SQL Server 2005 Express 最小安装的其余部分。那一点非常成功。

但是当我尝试`SqlRun_Tools.msi`再次运行时，当安装程序是“准备安装向导”时，我遇到了这个混乱：

```
The setup has encountered an unexpected error in datastore. The action
is SetDialogs. The error is : Source File Name:
...\datastorecachexmlschema.cpp
**** Compiler Timestamp: Fri Jul 29 01:13:50 2005
****    Function Name: DataStoreCacheXMLSchema::initScopeRecord*****Sour... 
```

*（但用方框字符替换星号，这可能是原始消息中的 CR-LF）*

这非常令人沮丧。有人对在 SSMSE 之上安装完整版 SSMS 有什么建议吗？您能提供的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T02:02:28.507

我还安装了 SQL Management Studio，然后才使用该`SqlRun_Tools.msi`软件包而没有任何问题，但我认为如果您以前安装了任何其他 SQL Server 2005 组件，那么您需要先安装安装支持文件，因为这可能是设置组件的原因安装顺序。这可以通过从 SQL Server 安装媒体安装或`sqlsupport.msi`按照 Microsoft 知识库文章中所述运行文件来完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-03-29T17:43:13.230

我解决了这个问题

脚步

1.  转到添加\删除程序
2.  卸载 SQL Server 浏览器
3.  从 CD 安装支持文件
4.  安装 SQL_Tools.MSI

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T22:50:31.487

好吧，根据几个不同论坛中提到的一个[有点神秘的解决](http://groups.google.com.tw/group/microsoft.public.sqlserver.tools/browse_thread/thread/ccfcac307f20b7cc)方案，我大致发现了问题所在。此解决方案建议我需要安装安装支持文件。也许是*重新安装，*因为我在卸载 SQL2K5 Express 时删除了同名的东西。我不确定它们是否是相同的文件，在完整版和 Express Edition 之间。

我曾尝试重新安装 SQLXML4、Native Client 和 MSXML6，只是为了看看我是否可以解决涉及的错误`datastorecachexmlschema.cpp`，但每次，我都会再次遇到相同的错误。但是我尝试了上面链接中提到的技术，并且效果很好。

基本上，您插入 CD 并运行安装过程的第一部分，它会安装安装工具，包括安装支持文件。然后取消其余的安装过程，然后运行`SqlRun_Tools.msi`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-04-24T13:10:40.317

通过（运行设置）首先进入维护->升级版，然后（因为管理工具等仍然是“快速”并且我主要需要 Sql Profiler），我在将 2008 express 升级到 2008 developer 时得到了很好的结果，我也做了一个完整的“新”安装（安装->“新安装或添加功能..”），选择现有实例，然后选择所有功能。无需卸载或命令行。之后的行为相同，只是具有新功能。

# assembly - 你还有什么古老的旧学校代码？

> ID：496807
> 
> 赞同：7
> 
> 时间：2009-01-30T19:15:51.183
> 
> 标签：assembly, legacy-code, 68000

最近几天因为生病而感到无聊，我决定尝试挖掘一些旧代码。我可以找到一些我写的古代 Atari ST 东西的二进制版本，但我找不到任何来源。我确实设法从传奇的旧 x2ftp 站点的存档中挖掘出我在许多个月前用 ASM 编写的旧 ModeX 库：

[http://ftp.lanet.lv/ftp/mirror/x2ftp/msdos](http://ftp.lanet.lv/ftp/mirror/x2ftp/msdos)

过去的爆炸:-)

```
; Actually Sticks Us Into ModeX - With 240 Scanlines Per Page
; Set The Variable LSCAN To The Virtual Scanline Length You Want
; Trashes AX, CX, DX, DS, SI
; Shouldn't Matter Though As This Should Be The First Thing You Call!
Set_X_240   PROC
        Call    Set_Graph       ; Set Mode 13h
        mov     dx, Seq_Port
        mov     ax, 00604h      ; Index 4 (Memory Mode Reg.) In AL
                                ; Bit 3 = Chain 4
        out     dx, ax          ; Kill Chain 4 Mode
        mov     ax, 00100h      ; Index 0 (Reset Reg.) In AL
        out     dx, ax          ; Reset Syncronous (At End Of Cycle)
        dec     dx              ; Change Port
        dec     dx              ; To Misc. S--t Port :)
        mov     al, 11100011b
        out     dx, al          ; Sets 480 Line Mode, 25Mhz Dot Clock
        inc     dx              ; Change Port
        inc     dx              ; Back To Sequencer Port
        mov     ax, 00300h
        out     dx, ax          ; Restart Controller
        mov     dx, Crtc_Port
        mov     al, 011h
        out     dx, al          ; Select Index 11h (Vert.Retrace End)
        inc     dx              ; Data Port
        in      al, dx          ; Read In Current Bit Mask
        and     al, 07Fh        ; 01111111 - Clear Top Bit (Write Protect)
        out     dx, al          ; Un-Write Protect Index 0-7 Of CRTC Reg.
        dec     dx              ; Restore Port To Index
        mov     ax, seg CRTC_Data_240           ; Address Of Our CRTC Data
        mov     ds, ax
        mov     si, offset CRTC_Data_240
        mov     cx, LCRTC_Data_240      ; Length Of Data
        repz    outsw                       ; Chuck It At The Port
        mov     ax, lscan
        shr     ax, 3           ; Number Of Words Per Scan Line
        mov     ah, al          ; Into AH
        mov     al, 013h        ; Port Index 013h - Logical Screen Width
        out     dx, ax

        mov     NScan, 240
    Call    Set_Pages
    ret
Set_X_240   ENDP 
```

还有其他人想让自己看起来很老并发布一些旧学校代码吗？:-) 很遗憾，我的 68000 ASM 东西仍然没有，尽管我现在可能都认不出来了！

啊..回忆:-)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2011-08-09T23:02:24.203

从很久以前就有一大堆旧的 Atari 8 位 BASIC 和 Atari ST 的东西（我仍然有 ST，但它没有联网，所以我几乎从不使用它）。

我曾经输入过 David Ahl 的“BASIC Computer Games: Microcomputer Edition”中的大部分游戏，将它们移植到 8 位和 ST BASIC。

我很想将那些旧游戏移植到 Processing/Arduino 上，以进行老式的踢球。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-17T21:51:55.043

我有一个 MUD，我在 1990-1993 年大学期间编写并维护。All C. 是 Diku MUD 的衍生版本，叫做 SillyMUD，是我当时的骄傲和喜悦。

您仍然可以在这里和那里找到 Intertubes 上的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-17T22:09:44.813

我在 1998 年编写的一些绝对糟糕的 Perl 代码仍在某个网站上使用......

可怕的是，我的意思是没有`use strict;`，没有`my`任何地方......

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-01T11:58:56.637

我从 Atari ST 获得的大部分代码都在 GFA-Basic 中，我不想碰那些满是灰尘的软盘。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-17T22:01:02.073

来自旧的 EISPACK Fortran 例程：

```
C 这个子程序是 ALGOL PROCEDURE ELMHES 的翻译，
C NUM. 数学。12, 349-368(1968) 由马丁和威尔金森撰写。
C 自动手册。比较，第二卷线性代数，339-358（1971）。
C
C 给定一个真正的通用矩阵，这个子程序
C 减少位于行和列中的子矩阵
C LOW 到 HIGH 到 UP HESSENBERG FORM BY
C 稳定的基本相似变换。
...
C 问题和评论应直接发送至 BURTON S. GARBOW，
C 数学和计算机科学部，阿贡国家实验室
C
C 此版本日期为 1983 年 8 月。

```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-17T22:09:30.023

我们有一个最初编写为在 Windows 3.1 上运行的测试工具。虽然单板已经更新了很多，但胆量仍然是一样的。它的核心仍然有一些远/长指针术语。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2009-02-17T21:53:53.243

复制粘贴作为核心发展策略让我非常非常难过。

# c# - 如何从对象中仅获取 1 行

> ID：496809
> 
> 赞同：1
> 
> 时间：2009-01-30T19:16:40.870
> 
> 标签：c#, asp.net, database, oop, foreach

这个查询将只有一行作为结果

```
 myDataContext db = new myDataContext();
    var query = from u in db.users
                where u.userId == myUserId
                select u; 
```

我通常使用“foreach”从“查询”对象中获取结果

```
 foreach(var i in query){
        username =  i.username;
    } 
    Response.Write(username); 
```

但是，如果对象只有一行，那是没有意义的，那么
当我确定它只有一行时，从对象获取数据的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T19:18:12.630

只需使用 query.Single()。

# sql-server - 您能否提供在 Amazon EC2 实例上运行 SQL Server 的任何提示/最佳实践？

> ID：496812
> 
> 赞同：10
> 
> 时间：2009-01-30T19:17:11.480
> 
> 标签：sql-server, amazon-ec2, cloud

在 Amazon 的云上设置基于 Windows 的 Web 应用程序绝对是一种学习体验。有很多意想不到的问题需要跳过，尤其是要绕过与临时本地驱动器相关的限制。

我希望利用那些走在我前面的人的集体智慧，并深入了解在 Amazon EC2 实例上运行 SQL Server 的最佳实践和/或技巧。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T19:17:15.793

在 EBS 中存储 Web 目录和 SQL Server 文件是解决本地存储脆弱性的一种简单方法。

我制作了一个用于将 SQL-Server 备份到 S3 的脚本：

[http://friism.com/ec2-sql-server-backup-strategies-and-tactics](http://friism.com/ec2-sql-server-backup-strategies-and-tactics)

以下是关于在 EC2 之外运行 ASP.Net 网站的一些更一般的想法：

[http://friism.com/rent-vs-buy-or-ec2-vs-building-your-own-iron](http://friism.com/rent-vs-buy-or-ec2-vs-building-your-own-iron)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-01-30T20:10:45.333

Brent Ozar 非常喜欢云计算，我相信他的博客上有很多与此相关的文章。

通过[http://www.brentozar.com/](http://www.brentozar.com/)搜索一下词云。

例如，我看到了他关于如何在 Amazon EC2 上设置托管的教程。

[http://www.brentozar.com/archive/2008/10/running-sql-server-2005-on-amazon-ec2/](http://www.brentozar.com/archive/2008/10/running-sql-server-2005-on-amazon-ec2/)

希望这可以帮助。干杯。

# python - 操作过程中进度条不更新

> ID：496814
> 
> 赞同：9
> 
> 时间：2009-01-30T19:17:39.497
> 
> 标签：python, user-interface, gtk, progress-bar, pygtk

在我的 python 程序中将文件上传到互联网，我使用 GTK 进度条来显示上传进度。但我面临的问题是进度条在上传完成之前不显示任何活动，然后它突然指示上传完成。我使用 pycurl 发出 http 请求...我的问题是 - 我是否需要一个多线程应用程序来上传文件并同时更新 gui？还是我犯了其他错误？

提前致谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-01-30T21:26:52.090

我将引用[PyGTK 常见问题解答](http://faq.pygtk.org/index.py?req=show&file=faq23.020.htp)：

> 您已经在窗口中创建了一个进度条，然后您开始运行一个循环来完成一些工作：

```
while work_left:
    ...do something...
    progressbar.set_fraction(...) 
```

> 您会注意到该窗口甚至没有显示，或者如果显示，进度条将保持冻结状态，直到任务结束。解释很简单：gtk 是事件驱动的，您正在从 gtk 主循环中窃取控制权，从而阻止它处理正常的 GUI 更新事件。
> 
> 最简单的解决方案是在每次进度更改时暂时将控制权交还给 gtk：

```
while work_left:
    ...do something...
    progressbar.set_fraction(...)
    while gtk.events_pending():
        gtk.main_iteration() 
```

> 请注意，使用此解决方案，用户无法退出应用程序（gtk.main_quit 由于新循环 [gtk.main_iteration()] 而无法工作），直到您完成了重载工作。
> 
> 另一种解决方案是使用 gtk 空闲函数，当 gtk 主循环无事可做时，它会调用这些函数。因此，gtk 处于控制之中，idle 函数必须做一些工作。如果还有更多工作要做，它应该返回 True，否则返回 False。
> 
> James Henstridge 指出了最好的解决方案（它没有缺点）。它利用python的生成器作为空闲函数，让python自动为我们保存状态。它是这样的：

```
def my_task(data):
    ...some work...
    while heavy_work_needed:
        ...do heavy work here...
        progress_label.set_text(data) # here we update parts of UI
        # there's more work, return True
        yield True
    # no more work, return False
    yield False

def on_start_my_task_button_click(data):
    task = my_task(data)
    gobject.idle_add(task.next) 
```

> 上面的“while”只是一个例子。唯一的规则是它应该在做一些工作之后产生 True 并且还有更多工作要做，并且它必须在任务完成时产生 False。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T19:57:36.077

问题很可能是在您的进度回调中，我认为您正在更新进度条，您没有调用手动更新显示，即通过 GUI 的事件循环运行。不过，这只是推测，如果您可以提供更多代码，则进一步缩小范围可能会更容易。

您需要手动更新显示的原因是因为您的主线程也在执行上传，这是它阻塞的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T21:15:17.857

在 python 2.x 中，整数操作数导致整数除法。试试这个：

```
#Callback function invoked when download/upload has progress
def progress(download_t, download_d, upload_t, upload_d):
    print 'in fileupload progress'
    mainwin.mainw.prog_bar.set_fraction(float(upload_d) / upload_t) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-03T02:51:56.707

是的，您可能需要并发，是的，线程是一种方法，但如果您确实使用线程，请使用这样的方法： http: [//unpythonic.blogspot.com/2007/08/using-threads-in-pygtk .html](http://unpythonic.blogspot.com/2007/08/using-threads-in-pygtk.html)将消除痛苦，让您专注于重要方面。

（我没有因为懒惰而重复该博客文章中的所有内容，因此社区维基）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-03-19T05:00:58.070

如果您没有与 pycurl 结婚，一种选择是使用 GObject 的 IO 观察程序。

[http://pygtk.org/pygtk2reference/gobject-functions.html#function-gobject--io-add-watch](http://pygtk.org/pygtk2reference/gobject-functions.html#function-gobject--io-add-watch)

使用它，您可以将文件上传与正常的 PyGTK 事件循环交错，甚至在您的 IO 监视回调中执行 set_progress 调用。如果您正在卸载所有上传到 pycurl 的工作，这实际上是不可行的，但如果您只是通过 HTTP 上传文件，io_add_watch 也会使使用套接字的痛苦少得多。

# sql-server - 在 SQL Server 中，如何确定每页的行数？

> ID：496822
> 
> 赞同：3
> 
> 时间：2009-01-30T19:19:05.547
> 
> 标签：sql-server

在 SQL Server 中，如何确定每页的（平均或预期）行数？

我知道如何确定平均和最大行大小，但我不知道这与实际行/页有何关系。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-01-30T19:29:38.567

每页 8060 字节，每个范围 8 页...请记住，如果您的行是 4040 字节，那么您只能在页面上放置一行

DBCC SHOWCONTIG 会告诉你你的表正在使用多少页

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T19:29:05.463

页面大小为 8K，包括 96 字节的标题。因此，如果您知道行大小，您可以估计有多少行适合页面的数据部分。

# html - 我应该为我的电子邮件模板使用 HTML 4.0 标记吗？

> ID：496825
> 
> 赞同：5
> 
> 时间：2009-01-30T19:19:40.087
> 
> 标签：html, email, newsletter

一位设计师使用 CSS 最佳实践编写了一个 html 模板。我想将此模板用作电子邮件通讯模板，但我听说有人说 hotmail、yahoo 和 gmail 对 CSS 的支持有限。

我应该使用表格布局和字体标签重新编码这些模板吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-01-30T19:24:01.900

简短的回答是**Yes**。

通过尽可能使用最基本和最简单的 HTML，您将获得跨网络邮件帐户和电子邮件客户端的最佳兼容性。

*   不要使用任何 CSS 文件或 <style> 标签。内联做**所有事情**。
*   使用具有明确宽度的嵌套表处理定位
    *   在这些情况下，我大量使用 HTML 注释，以确保我不会对我在布局中的位置感到困惑。
*   所有文本都应该被带有字体样式信息的 <font> 标签包围。
*   图片应该有明确的宽度和高度。
    *   这有助于电子邮件在图像被阻止时保持其正确的布局。

* * *

我通常至少测试以下内容：

*   展望 2003
*   展望 2007
    *   你的大部分头痛都来自这里。
*   雷鸟
*   随行人员（OSX 版本的 Outlook）
*   邮箱
*   热邮件
*   雅虎邮箱

如果您在所有这些上都得到了正确显示的东西，那么您通常处于非常好的状态。

我们使用 Exact Target，他们有 HTML 预览功能，但并不完美。我遇到**过很多**情况，其中一封电子邮件在预览中看起来不错，但在 Outlook 2007 中仍然出现问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T19:30:41.747

上面的 Mark 说了开发电子邮件模板所需的一切（又是 90 年代），但我想添加最后一件事：

[http://www.email-standards.org/](http://www.email-standards.org/)是了解不同电子邮件客户端如何解释 HTML 和 CSS 的绝佳资源。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T19:26:51.273

以马克所说的为基础：

如果可能，请完全避免使用 CSS（不过，对于文本之类的东西通常没问题）。使用表格进行所有定位，空`<td>`元素用于填充/较小的定位位。

即使有这一切，它也只会在一些电子邮件程序/网站中看起来很完美。HTML 电子邮件，我相当有信心地说，完全不可能以这样一种方式完美地显示在所有邮件客户端/应用程序中。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-01-30T19:32:06.003

您必须回到石器时代的 HTML，才能按照 Mark 的建议处理 HTML 电子邮件。html 中内联的所有样式。没有 STYLE 标签或外部样式表。

[MailChimp](http://www.mailchimp.com/resources/templates/)和[CampaignMonitor](http://www.campaignmonitor.com/templates/)都提供出色的免费 HTML 电子邮件模板。他们还提供电子邮件测试服务，将您的 html 电子邮件发送到几个不同的电子邮件客户端，然后将结果的屏幕截图发送给您。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-04-13T15:43:56.743

使用具有固定高度/重量的 div 标签并将所有 HTML 放入其中。在大多数客户中看起来都是一样的。我以前试过，效果很好。

# database - 是否有一种简单的方法可以为关系数据库进行 GUI 输入？

> ID：496832
> 
> 赞同：1
> 
> 时间：2009-01-30T19:21:16.493
> 
> 标签：database, user-interface, input, relational

我正在为一个朋友构建一个学生排班应用程序，除了 GUI 之外，我即将完成。我正在用 wxpython 编写它，但我不确定如何处理输入字段，因为它是一个关系数据库。有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T22:47:23.270

这可能很容易，但也很乏味，因为您必须验证、解析、转换等……每个输入字段。无论如何，您可以使用适当的 SQL 查询为数据库上的每个实体创建一个 DAO。然后使用将与您的 GUI（验证、解析等）和 DAO 交互的一些模型对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T19:29:41.127

这是业务应用程序编程。这是基本模型：为每个字段创建一堆输入，可能是文本框。创建一个标有“添加记录”或其他内容的按钮。单击它时，向数据库发出*插入*，从表单输入中传递列值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T19:37:07.990

为了让您的生活更轻松，您可以使用 SQLAlchemy 之类的内省来生成类，然后从那里进行 CRUD。鉴于您（大概）已经完成了后端，但是：

为表格提供下拉框，然后填写列名。插入值并单击“提交”（或您想调用的任何名称）后，将其提交到数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-01T01:33:07.047

我是 wxPython 的忠实粉丝，我个人会在 wxPython 中完成这一切，因为它是一个非常好的工具包。也就是说，在 wxPython 之上编写了一个以数据库为中心的框架，称为[Dabo](http://dabodev.com/)。你应该看看那个。

# time - 推荐个人使用的基于 Web 的时间/任务管理解决方案？

> ID：496846
> 
> 赞同：19
> 
> 时间：2009-01-30T19:24:25.490
> 
> 标签：time, project-management, time-management, task-tracking

我知道这与编程无关，而与时间管理有关，但我重视本网站用户的反馈。这个学期我发现自己特别忙，管理工作和学校之间的各种任务和时间表。此外，我发现自己在实验室、工作、家庭、图书馆等之间奔波。出于这些原因，我认为基于 Web 的解决方案是理想的。这就引出了一个问题，您是否有推荐的基于 Web 的个人使用任务/项目管理解决方案？Ideal 将是免费的（或几乎免费），并且可以安装在我的服务器上。会计不是必需的，只是时间和任务的管理（甘特图会很棒）。然而，svn 集成会非常好，因为我把我的学业留在那里。

谢谢！

**更新**

我对此给予了赏金，因为一个好的解决方案对我来说非常有价值（比代表更有价值）。到目前为止，答案都很好，但没有一个适合个人使用。理想的东西是用我可以自己托管的东西来管理文件和时间。当我们在校园实验室中使用 MAC OSX 时，这将是 MAC+PC 解决方案的一个优势。目前，SVN 和基于网络的时间管理器似乎是要走的路。

**更新 2**

首先，感谢您的精彩回复！FogBugz、Trac 和 Request Tracker 要么被强烈推荐，要么被多次推荐。Trac 和 Request Tracker 也是免费和自托管的，但是，它们的优势似乎在于团队开发。我将试一试 FogBugz on Demand，看看效果如何。我也将按照建议开始使用 Drop Box，好主意！此外，SVN***将***用于“一切”的长寿。这应该围绕 2 gig 问题和自托管需求。我正在考虑使用 SVNNotifier 来保持机器最新。再次感谢！

**结论**

我决定按照 Zabbala 的建议使用[FogBugz 。](http://www.fogcreek.com/FogBugz/)正如他所说，它确实可以满足我从任务跟踪到时间管理的所有需求。这是 FogCreek 提供的惊人而慷慨的免费产品。谢谢大家，我真的很感谢所有的反馈。

**跟进**

只是为了跟进这个项目。我已经使用 FogBugz 两个星期了；再开心不过了。我已经开始将[LiveScribe 的 SmartPen](https://rads.stackoverflow.com/amzn/click/com/B001AAN4PW)与 FogBugz 结合使用。我将长期项目保留在 FogBugz 中，并将本周的项目复制到道路的“期刊”中。SmartPen 使数字化“日记”变得轻松。

为了管理文件，我混合使用了 FogBugz、DropBox、SVN 和 Unison。我使用 DropBox 在网络上共享，例如在家庭和实验室之间共享，并使用 Unison 在更大的 SVN 工作副本中同步 DropBox 文件夹（并非所有内容都在 DropBox 中）。

**长期跟进**

我一直在使用fogbugz 来支持LiveScribe 的日记。似乎传统的笔和纸具有难以超越的效率。关于 LiveScribe，我遇到了一些问题，这让我对他们的文件格式感到不舒服。他们的文件在命名约定和格式上都被掩盖了。如果他们有一个开放的格式，我会觉得把我的数据委托给它会好得多。

***长期随访（3 年以上）***

我已经改用维基媒体来记录我的工作/时间/研究。对于任务管理，我一直在使用 Google 应用***Insightly***。这种组合感觉更自然，并且“卡住”了。wiki 路线真的很有用...

***更长期的随访（7 年以上）***

我已经切换到使用 Trello 板进行任务管理。在我的一个错误导致数据库丢失后，我已经不再使用 wikimedia。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-01-30T19:50:15.513

我会使用 Fogbugz OnDemand（[这里）](http://discuss.joelonsoftware.com/default.asp?biz.5.482288.59)。它对 2 位用户免费，可以满足您从任务跟踪到时间管理的所有需求。我自己将它用于各种宠物项目，它满足了我的所有要求，而且设置起来非常容易。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-01-31T15:48:01.073

试试[rememberthemilk](http://www.rememberthemilk.com)。很好的工具，有很多有用的界面。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2009-01-31T01:25:50.440

在多台计算机上工作时，我喜欢 Dropbox ( [http://www.getdropbox.com/](http://www.getdropbox.com/) )。免费帐户可为您提供在您的计算机（Windows、Mac、Linux）之间同步的充足 2 GB 空间。这不会解决您的时间管理问题，但它可能是另一个解决方案的基石。因此，如果您找到自己喜欢的桌面应用程序，您*或许*可以使用 Dropbox 在您的机器上同步文件，并使其成为“网络”解决方案。

例如，KeePass ( [http://keepass.info/](http://keepass.info/) ) 与 Dropbox 配合得非常好。您可以在计算机之间同步您的加密密码数据库，以便您的密码始终是最新的。

顺便说一句，Lifehacker 向我介绍了整个计划。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-02T19:49:03.130

[背包](http://www.backpackit.com/)是 37signals 的一款不错的背包。他们有免费帐户、多个用户和一个 API。不过，我不确定 SVN 访问。

您还可以考虑[TRAC](http://trac.edgewall.org/)。它可以很好地插入 SVN，虽然它更多地用于开发，但我认为它可以很好地满足您的需求。

**更新：**你提到 Trac 是面向团队的，虽然这是真的，但我认为这并不是一件坏事。我认为其中没有任何真正需要多个用户的功能，或者会减慢您自己使用它的速度。而且，如果您需要与其他人协作，它已经准备好执行此操作。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-01-30T19:57:34.267

我目前正在评估[TargetProcess](http://targetprocess.com/)，它看起来真的很棒！它是一个敏捷项目管理应用程序，因此它的功能可能超出您的预期。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2009-02-05T15:46:14.503

大约 6 个月前，我的情况与您几乎相同。我对跟踪我的项目和任务感到不知所措，需要一些能够让我跟踪项目、涉及的子任务以及我在它们上的进度的东西。我还需要一些可以让我在必要时与他人协作并且可以自定义的东西。

我是一名开发人员，所以我知道 SVN 是必须的。我想要一个与 SVN 集成的 PM 系统，并且希望它是自托管的。我开始使用 Fogbugz on Demand 只是为了试一试，但这对我的需求来说太过分了，而且我从来没有觉得我应该使用它。不要误会我的意思，该系统构造精美，比市面上的大多数 PM 工具都要好，但它不适合我。

在尝试了许多其他选项之后，我最终决定使用[Redmine](http://redmine.org)。它是一个基于 Ruby on Rails 构建的 PM 系统，它灵活、美观且速度相当快。它将为您创建的每个项目自动创建 SVN 存储库（如果您设置得当）并为您绘制甘特图。Redmine 作为用于跟踪项目和任务的 PM 系统非常棒。我唯一不喜欢的是它缺少计时系统。有手动时间输入，但我想要一个像秒表一样点击的小部件来跟踪我的时间。

我决定使用[Harvest](http://getharvest.com)作为我的时间跟踪解决方案。他们有适用于 Windows Vista 和 OS X 的小部件，可让您轻松掌握时间跟踪。你必须在 Harvest 中设置你的项目和客户（听起来你的客户就是你自己，所以你不会有很多），但在那之后你应该很高兴。他们有一组非凡的报告，您可以随时查看这些报告，了解您的时间花在哪里。

所以，差不多就是这样。我几乎每天都使用 Redmine + Harvest，但我并没有更快乐。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-03-02T14:59:26.007

[http://www.redmine.org/](http://www.redmine.org/)

*   多项目支持
*   灵活的基于角色的访问控制
*   灵活的问题跟踪系统
*   甘特图和日历
*   新闻、文件和文件管理
*   提要和电子邮件通知
*   每个项目维基
*   每个项目论坛
*   时间跟踪
*   问题、时间条目、项目和用户的自定义字段
*   SCM 集成（SVN、CVS、Git、Mercurial、Bazaar 和 Darcs）
*   通过电子邮件创建问题
*   多个 LDAP 身份验证支持
*   用户自助注册支持
*   多语言支持
*   多数据库支持

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2009-02-05T00:43:22.940

我爱[redmine](http://www.redmine.org/)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2009-01-30T19:43:53.860

[http://www.clockingit.com/](http://www.clockingit.com/)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-01-30T20:02:06.317

我们正在使用[请求跟踪器](http://bestpractical.com/rt/)。它是**免费**的，并且有一个 API。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2009-02-02T19:45:23.900

如果您可以处理不自己托管的问题[——Toggl.com](http://www.toggl.com)

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2009-02-02T19:48:01.883

我过去使用过[Assembla.com](http://www.assembla.com)并喜欢它们。但是，他们不再自由了。我已将我的项目转移到[Unfuddle.com](http://www.unfuddle.com)，它具有与 SVN 相同的任务管理功能。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2009-02-05T02:33:05.230

使用[GMail 中的任务](http://gmailblog.blogspot.com/2008/12/new-in-labs-tasks.html)。它们很有用，很轻巧，你可以有一个任务层次结构。如果您已经在使用 GMail，那就太好了。

GMail还有一个[Remember The Milk 插件](http://www.rememberthemilk.com/services/gmail/)。这里不能有子任务，不过也挺好的，总而言之。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-05T02:47:20.770

你听说过这个：[Tiddly Wiki](http://wiki.43folders.com/index.php/Tiddly_Wiki)吗？

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-05T03:18:01.537

[Tracks](http://www.getontracks.org/)是一个基于 Ruby 的时间跟踪器，遵循 Getting Things Done™ 方法。您可以将它托管在您自己的 Web 服务器上，或者如果您在计划使用它的所有计算机上都安装了 ruby​​，您可以从闪存驱动器运行它。它可让您设置截止日期，以便向您显示最紧迫的任务。它有几种不同的方法来组织事物，这给了你很大的灵活性。这是一个[屏幕投射](http://bsag.bingodisk.com/public/movies/intro_tracks15.mov)和一些[屏幕截图](http://www.getontracks.org/screenshots/index)。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2009-02-05T15:21:59.153

axosoft [http://www.axosoft.com/](http://www.axosoft.com/)为其 OnTime 2009 pro 应用程序提供免费的个人许可证。有一个 Visual Studio 插件、windows 和 web ui。我自己用它。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-01-30T19:54:46.287

Fogbugz 有一些插件，例如 timesprite，可让您处理系统中的案例，但如果您愿意，可以独立跟踪时间。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-05T03:30:09.717

我强烈推荐[Request Tracker](http://www.bestpractical.com/rt)，就像 JJ 一样，它可以自己托管，而且我相信它可以在 Windows 上运行。（因为它在 UNIX 上运行，它应该在 Mac OS 上运行。）我不知道它有任何甘特图功能，但我敢打赌，有报告可以做到这一点。

我只是回答插入请求跟踪器，而不是为了赏金。如果出于某种原因您决定使用 RT，请确保按照 JJ 的建议给予赏金！

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2009-02-06T02:51:33.163

Agilo for Scrum 似乎是一个不错的 Agile Trac 插件，值得尝试。

[http://www.agile42.com/cms/pages/download/](http://www.agile42.com/cms/pages/download/)

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2009-02-06T06:18:47.283

[PositiveWare](http://www.positiveware.com)做了很多这样的事情：时间管理、项目管理、待办事项列表、预算、简单的发票创建和报告。

没有 SVN 集成，但它是基于 Web 的（带有针对高级用户的 AIR 应用程序），因此您实际上不需要安装任何软件。

它通常面向公关/营销公司，但我将它用于我的软件开发团队。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2009-02-06T08:35:23.703

我喜欢谷歌日历——你可以输入你所有的截止日期、会议、约会等。它基于网络并且是免费的。您可以在同一个日历上拥有多个帐户，例如工作和家庭，它甚至会通过短信发送提醒。

您的待办事项列表当然有一个记住牛奶插件。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2009-02-06T13:08:32.403

为自己获取一个具有 2GB 存储空间（PC 或 Mac）的免费[DropBox](http://www.getdropbox.com/)帐户。

然后在您的 My DropBox 文件夹中 复制（或创建）一个免费的[TiddlyWiki 。](http://www.tiddlywiki.com/)

TiddlyWiki 是一个独立的/可更新的 html 文件，您可以在其中存储任何内容（也支持搜索），非常适合时间管理、任务跟踪、知识库等。

此外，作为纯 html，它在 Firefox、IE、Safari 等中受支持。

然后，在任何新计算机上，只需安装 DropBox，您现在就可以完全同步访问同一个 TiddlyWiki 文件。例如。您在学校或工作中所做的更改/更新会立即或同步后在您的家用 PC 上等着您（如果 PC 已关闭）。

主要优点：

*   跨多台计算机的万无一失的同步。
*   跨平台（PC/Mac）。
*   轻量级，只需要网络浏览器和 Dropbox。
*   信息存储在非专有 html 中。
*   使用非常简单。
*   无需网络服务器，只需访问互联网。
*   自由。

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2009-02-08T18:58:25.550

如果不需要 Web 访问，Drop Box 中的 Microsoft Project 也提供了一个有趣的解决方案。这提供了出色的时间线管理，尤其是在任务相关性方面。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2009-02-09T13:25:55.473

还没有人提到 SlimTimer ( [www.slimtimer.com](http://www.slimtimer.com) )。这是一个漂亮的小网络工具，非常灵活且易于使用。

恕我直言，最好的部分是每个任务在您的任务列表中都有一个显示名称以及可用于报告的 0..n 个标签。这样，我的待办事项列表就有了我可以关联的简单名称，并且每个任务都标有相应的项目标识符，我必须报告我的时间。

我的 SlimTimer 记录我每天或每周花费的时间，当我觉得需要时，我会拿出一份报告并将数据填入我的公司计费系统。

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2009-02-13T00:12:21.843

Project Path 也适用于单个项目：[ [http://projectpath.com/][1]](http://projectpath.com/][1])

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2009-06-06T18:12:11.743

也许为时已晚，但为了记录，[这](https://stackoverflow.com/questions/25707/how-do-you-track-your-hours/960198#960198)也可以帮助你。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2009-03-08T20:24:09.763

[http://www.myhours.com/](http://www.myhours.com/)

跟踪您的工作、您的私人项目、计算成本、通过电子邮件发送报告等。按照 3 个简单的步骤开始时间跟踪：

* * *

## 回答 #28

> 赞同：-1
> 
> 时间：2011-04-15T08:00:12.893

Swift To-Do List Standard 是我的首选应用程序之一，它可以管理和跟踪我的任务。它以树状结构组织它们，具有友好的界面，非常适合我的需求。

[http://bstdownload.com/reviews/swift-do-list-standard-7/](http://bstdownload.com/reviews/swift-do-list-standard-7/)

# java - 在 Windows 上安装多个 Java

> ID：496847
> 
> 赞同：2
> 
> 时间：2009-01-30T19:24:39.000
> 
> 标签：java, windows, vista64

在 Vista x64 上可以同时安装 32 位和 64 位 Java 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T19:28:12.610

是的，事实上，这是获取 Java Webstart 的唯一途径，因为没有 64 位版本。

编辑：据说 64 位 Java WebStart[将](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4802695)在 Java 6u12 中可用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T19:29:49.660

考虑到当你更新 Java 时，它永远不会删除旧版本的 Java，你应该可以同时运行 32 位和 64 位 Java 没有问题。

# .net - 对于 Windows 窗体，PostMessage 与 self 的等价物是什么？

> ID：496854
> 
> 赞同：3
> 
> 时间：2009-01-30T19:25:33.583
> 
> 标签：.net, windows, winforms, controls

我正在编写一个从`System.Windows.Forms.Control`.

控件正在使用该`Control.KeyDown`事件来观察击键：我应该将一些击键（例如`<Ctrl>-K`）作为热键处理，这会导致我启动一个对话框。

如果我从我的`onKeyDown`事件处理程序启动对话框，对话框会在我设置并`KeyEventArgs.SuppressKeyPress`返回之前显示`true`（因此我无法抑制`K`按键）。相反，我想从`onKeyDown`事件处理程序返回，然后启动对话框。为此，在我从`onKeyDown`事件处理程序返回后，我需要以某种方式再次被调用，并带有某种“启动对话框”事件。

在 Win32 上，我可以使用`PostMessage`API 生成此事件，向自己发送一条已注册的窗口消息：我将在消息队列中的任何先前消息之后立即收到此消息，并将其用作启动对话框的信号。但是在这里我不能使用`PostMessage`函数（也不能使用`WndProc`方法），因为我想使用严格**管理**的API（不需要`SecurityPermissionFlag::UnmanagedCode`）。

那么，对于一个线程（我的 UI 线程）来说，调度异步回调的托管等价物是什么：也许是某种计时器？某种自我`Invoke`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T20:02:02.543

*我的第一个想法是“在打开对话框之前*设置 SurpressKeyPress 属性”，但这并没有真正回答你的问题。如果您确实需要在打开对话框之前从事件处理程序返回，请查看 BeginInvoke 方法。

你可以这样做：

```
...
this.BeginInvoke(new InvokeDelegate(showDlg));
KeyEventArgs.SuppressKeyPress = true;
...

public void showDlg()
{
   // create and show dialog here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T19:48:51.227

您可以从表单中定义的方法启动对话框，并从新线程启动该方法（在您的 using 语句中包含 System.Threading）。按钮单击事件中的代码如下所示：

```
Thread thread = new Thread(new ThreadStart(LaunchDialog));
thread.Start(); 
```

其中 LaunchDialog 是启动新对话窗口的方法。

# database - 为什么实体框架连接需要元数据属性？

> ID：496856
> 
> 赞同：34
> 
> 时间：2009-01-30T19:25:58.747
> 
> 标签：database, entity-framework, connection, connection-string, data-access-layer

我将我的 DAL 从使用 LINQ 切换到实体框架。因为我的应用程序根据当前用户连接到不同的数据库，所以我需要在运行时动态创建 DataContext 并传入适当的连接字符串。但是，当我尝试使用旧连接字符串以编程方式创建实体框架连接时，连接失败。它抱怨它无法识别连接字符串中的键，确切地说是“服务器”。

我发现我需要这样做才能使实体框架连接正常工作：

```
EntityConnectionStringBuilder entityBuilder = new EntityConnectionStringBuilder();
entityBuilder.Provider = "System.Data.SqlClient";
entityBuilder.ProviderConnectionString = clientConnectionString;
entityBuilder.Metadata = "res://*/xxxxxxxxxx.csdl...";
Entities entities = new Entities(entityBuilder.ToString()); 
```

为什么是这样？
元数据属性有什么用？
对于多个不同的连接，它总是相同的，这会是一个问题吗？
应该是什么？
有没有办法解决？

提前致谢！

更新 1：感谢 Randolpho 的更新，但是......
我遇到这个问题的全部原因是我无法将连接字符串存储在配置文件中。连接字符串在运行时由用户连接动态确定。

这是我的确切场景：
如果用户 A 正在连接，应用程序从数据库 A 中提取数据。如果用户 B 正在连接，应用程序从数据库 B 中提取数据。
连接字符串存储在主数据库中，并且数量可能是无限的. 每次添加用户时，我都不想进入 web.config，更不用说它最终会变得巨大的事实！

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2009-01-30T19:48:32.553

扩展 Randolpho 的答案：

元数据属性专门指向 .SSDL（存储模型）、.CSDL（概念模型）和 .MSL（映射模型）文件的位置。这三个文件本质上是实体数据模型。“res://” URI 样式限定符表示文件作为资源嵌入到已编译的 EDM 程序集中。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2009-01-30T19:33:52.973

您会发现这些链接非常有用：

[http://msdn.microsoft.com/en-us/library/system.data.entityclient.entityconnection.connectionstring.aspx](http://msdn.microsoft.com/en-us/library/system.data.entityclient.entityconnection.connectionstring.aspx)

[http://weblogs.asp.net/pgielens/archive/2006/08/21/ADO.NET-Entity-Framework-Metadata.aspx](http://weblogs.asp.net/pgielens/archive/2006/08/21/ADO.NET-Entity-Framework-Metadata.aspx)

底线？实体框架需要元数据来构建您的实体映射。

此外，您应该考虑将连接信息移到配置文件中，而不是在代码中构建它。第一个链接将向您展示如何做到这一点。

# c++ - C ++中受保护访问中的数据损坏

> ID：496873
> 
> 赞同：0
> 
> 时间：2009-01-30T19:28:58.037
> 
> 标签：c++, private, protected

“受保护”的变量容易被派生类恶意更改？我应该在基类变量中使用“private”而不是“protected”吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-30T19:31:01.623

如果您担心“恶意”修改，那么即使将数据标记为`private:`也无济于事。

C++ 访问说明符仅对本质上按规则运行的代码有用。

将成员标记为`private`将防止您班级的普通用户与他们混淆。然而，即使是有错误的非恶意代码也可能破坏这些成员。溢出、错误的指针算术或不正确使用强制类型转换让 C++ 程序员导致这些问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T19:31:48.237

在 C++ 中无法阻止“恶意”访问，因为您总能以某种方式绕过编译器限制。如果您担心“意外”更改，请继续将其设为私有。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T19:31:19.827

好吧，*受保护*的成员确实会被继承。如果您不希望这种情况发生，请将它们设为*private*。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T20:36:42.487

一般来说，如果你打算声明一个私有变量，你应该退后一步，问问自己为什么还要在头文件中发布声明？

而不是在 foo.h 中向全世界公开您的成员变量：

```
class foo {
private:
    int    please_dont_modify_me;
    double pretend_you_dont_see_this_declaration;
    char   dont_look_at_this [128];
public:
    ....
}; 
```

只需使用未定义的*不完整私有类型：*

```
class foo {
    struct foo_privates & mine;   // incomplete type
public:
    ...
}; 
```

然后在 foo.cpp *ONLY*中：

```
struct foo_privates {
     int    i;
     double d;
     char   str[128];
}; 
```

当然， foo 的构造函数必须分配单独的对象，而析构函数必须销毁它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-01-30T19:32:13.507

看看： http: [//www.parashift.com/c++-faq-lite/private-inheritance.html#faq-24.5](http://www.parashift.com/c++-faq-lite/private-inheritance.html#faq-24.5)

你可能想要私人的。

# java - 使用 Java 或 .NET 库对来自 ColdFusion 的 PDF 执行光学字符识别？

> ID：496875
> 
> 赞同：1
> 
> 时间：2009-01-30T19:29:16.837
> 
> 标签：java, pdf, coldfusion, ocr

我正在寻找一个 PDF 并从中提取任何文本。然后，我想使用 ColdFusion 的可用 Verity 搜索来搜索内容。

是否有任何图书馆已经做得很好？我在范围内包括 Java 或 .NET（首选 Java）库，因为它们可以从 CF 调用。

任何见解或经验将不胜感激......谢谢！

编辑：据我所知，当文本嵌入到 PDF 中时，索引 PDF 文件有效。我必须处理的 PDF 将文本扫描为图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T19:31:27.270

默认情况下，Verity 应该能够索引 PDF 文件：

[http://livedocs.adobe.com/coldfusion/6/Developing_ColdFusion_MX_Applications_with_CFML/indexSearch2.htm#1142322](http://livedocs.adobe.com/coldfusion/6/Developing_ColdFusion_MX_Applications_with_CFML/indexSearch2.htm#1142322)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T19:45:27.803

如果您有能力运行自己的软件（即专用/VPS），那么您可以研究使用[Tesseract OCR](http://code.google.com/p/tesseract-ocr/)将`cfexecute`PDF 转换为文本吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-30T19:38:37.613

[Ray Camden 有一个关于在 ColdFusion 8 中处理 PDF](http://www.coldfusionjedi.com/index.cfm/2007/7/9/ColdFusion-8-Working-with-PDFs-Part-1)的八部分系列。

[该系列的第 7 部分](http://www.coldfusionjedi.com/index.cfm/2007/7/24/ColdFusion-8-Working-with-PDFs-Part-7)介绍了使用 DDX 从 PDF 中获取文本。

虽然不确定这是否符合您的 OCR 需求，但可能仍然值得一看。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T19:57:30.290

在一个半相关的笔记上，我发现了一篇关于在冷融合中编码和读取二维矩阵条形码的非常简洁的帖子。

[http://www.stillnetstudios.com/2007/12/15/2d-barcodes-coldfusion/](http://www.stillnetstudios.com/2007/12/15/2d-barcodes-coldfusion/)

这可能会解决我需要提取编码信息的一些问题，但我仍然关注文本的主体。

关于 tessnet，也找到了一个 .net 版本。 [http://www.pixel-technology.com/freeware/tessnet2/](http://www.pixel-technology.com/freeware/tessnet2/) 如果我可以在本地输入 PDF 而不是 TIFF .. :)

# java - Javadoc 只有一个使用 Ant 的包中的一个类

> ID：496884
> 
> 赞同：3
> 
> 时间：2009-01-30T19:31:18.657
> 
> 标签：java, javadoc, ant

我正在使用 apache ant 为我的项目生成 javadoc。我的一个包中有许多类，我只想展示一个。我该怎么做呢？这是我当前的代码。

```
<javadoc
    sourcepath="jig-engine/src"
    destdir="${target.path}/docs/javadoc/"
    packagenames="jig.engine.util.Vector2D" >
</javadoc> 
```

（为清楚起见进行了简化）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-01-30T19:37:43.357

使用 sourcefiles 参数而不是 sourcepath：

```
<javadoc
    sourcefiles="jig-engine/src/path/to/your/file.java"
    destdir="${target.path}/docs/javadoc/">
</javadoc> 
```

# c# - C#如何从数组中删除一个元素

> ID：496896
> 
> 赞同：182
> 
> 时间：2009-01-30T19:33:29.620
> 
> 标签：c#, .net, arrays

假设我有这个数组，

```
int[] numbers = {1, 3, 4, 9, 2}; 
```

如何按“名称”删除元素？，让我们说4号？

连`ArrayList`删都没帮忙？

```
string strNumbers = " 1, 3, 4, 9, 2";
ArrayList numbers = new ArrayList(strNumbers.Split(new char[] { ',' }));
numbers.RemoveAt(numbers.IndexOf(4));
foreach (var n in numbers)
{
    Response.Write(n);
} 
```

* * *

## 回答 #1

> 赞同：389
> 
> 时间：2009-01-30T19:59:44.683

***如果要删除 4 的所有实例而不需要知道索引：***

***LINQ：（.*** NET 框架 3.5）

```
int[] numbers = { 1, 3, 4, 9, 2 };
int numToRemove = 4;
numbers = numbers.Where(val => val != numToRemove).ToArray(); 
```

***非 LINQ：（.*** NET Framework 2.0）

```
static bool isNotFour(int n)
{
    return n != 4;
}

int[] numbers = { 1, 3, 4, 9, 2 };
numbers = Array.FindAll(numbers, isNotFour).ToArray(); 
```

***如果您只想删除第一个实例：***

***LINQ：（.*** NET 框架 3.5）

```
int[] numbers = { 1, 3, 4, 9, 2, 4 };
int numToRemove = 4;
int numIndex = Array.IndexOf(numbers, numToRemove);
numbers = numbers.Where((val, idx) => idx != numIndex).ToArray(); 
```

***非 LINQ：（.*** NET Framework 2.0）

```
int[] numbers = { 1, 3, 4, 9, 2, 4 };
int numToRemove = 4;
int numIdx = Array.IndexOf(numbers, numToRemove);
List<int> tmp = new List<int>(numbers);
tmp.RemoveAt(numIdx);
numbers = tmp.ToArray(); 
```

***编辑：***以防万一您还没有弄清楚，正如 Malfist 指出的那样，您需要以 .NET Framework 3.5 为目标才能使 LINQ 代码示例正常工作。如果您的目标是 2.0，则需要参考非 LINQ 示例。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2012-01-24T07:24:04.857

```
int[] numbers = { 1, 3, 4, 9, 2 };
numbers = numbers.Except(new int[]{4}).ToArray(); 
```

* * *

## 回答 #3

> 赞同：27
> 
> 时间：2010-12-20T20:10:00.640

您还可以将数组转换为列表并在列表上调用 remove。然后，您可以转换回您的数组。

```
int[] numbers = {1, 3, 4, 9, 2};
var numbersList = numbers.ToList();
numbersList.Remove(4); 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2009-01-30T20:10:49.343

问题中编写的代码中有一个错误

您的数组列表包含字符串“1”“3”“4”“9”和“2”（注意空格）

所以 IndexOf(4) 什么也找不到，因为 4 是一个 int，甚至“tostring”也会将其转换为“4”而不是“4”，并且不会删除任何内容。

数组列表是做你想做的事情的正确方法。

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2013-07-24T18:14:25.393

我在[这里](https://stackoverflow.com/questions/457453/remove-element-of-a-regular-array/17841639#17841639)发布了我的解决方案。

这是一种在不复制到另一个数组的情况下删除数组元素的方法 - 就在同一个数组实例的框架中：

```
 public static void RemoveAt<T>(ref T[] arr, int index)
    {
        for (int a = index; a < arr.Length - 1; a++)
        {
            // moving elements downwards, to fill the gap at [index]
            arr[a] = arr[a + 1];
        }
        // finally, let's decrement Array's size by one
        Array.Resize(ref arr, arr.Length - 1);
    } 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2009-01-30T19:57:03.597

从数组中删除本身并不简单，因为您必须处理调整大小。这是使用类似 a 的最大优势之一`List<int>`。它在 2.0 中提供`Remove`/ `RemoveAt`，并为 3.0 提供了许多 LINQ 扩展。

如果可以，重构以使用 a`List<>`或类似的。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-01-30T20:04:34.877

如果要删除元素的所有实例，Balabaster 的答案是正确的。如果您只想删除第一个，您可以执行以下操作：

```
int[] numbers = { 1, 3, 4, 9, 2, 4 };
int numToRemove = 4;
int firstFoundIndex = Array.IndexOf(numbers, numToRemove);
if (numbers >= 0)
{
    numbers = numbers.Take(firstFoundIndex).Concat(numbers.Skip(firstFoundIndex + 1)).ToArray();
} 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-03-19T05:22:01.660

作为通用扩展，兼容 2.0：

```
using System.Collections.Generic;
public static class Extensions {
    //=========================================================================
    // Removes all instances of [itemToRemove] from array [original]
    // Returns the new array, without modifying [original] directly
    // .Net2.0-compatible
    public static T[] RemoveFromArray<T> (this T[] original, T itemToRemove) {  
        int numIdx = System.Array.IndexOf(original, itemToRemove);
        if (numIdx == -1) return original;
        List<T> tmp = new List<T>(original);
        tmp.RemoveAt(numIdx);
        return tmp.ToArray();
    }
} 
```

用法：

```
int[] numbers = {1, 3, 4, 9, 2};
numbers = numbers.RemoveFromArray(4); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-04-12T19:09:31.803

'**根据字典键值从字符串中删除项目。** ' VB.net 代码

```
 Dim stringArr As String() = "file1,file2,file3,file4,file5,file6".Split(","c)
 Dim test As Dictionary(Of String, String) = New Dictionary(Of String, String)
 test.Add("file3", "description")
 test.Add("file5", "description")
 stringArr = stringArr.Except(test.Keys).ToArray() 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-07-18T10:35:51.333

你可以这样做：

```
int[] numbers= {1,3,4,9,2};     
List<int> lst_numbers = new List<int>(numbers);
int required_number = 4;
int i = 0;
foreach (int number in lst_numbers)
{              
    if(number == required_number)
    {
        break;
    }
    i++;
}
lst_numbers.RemoveAt(i);
numbers = lst_numbers.ToArray(); 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-13T01:14:31.077

```
 public int[] DeletePart(int position, params int[] numbers)
    {
        int[] result = new int[numbers.Length - 1];
        int z=0;

        for (int i = 0; i < numbers.Length; i++)
        {
            if (position - 1 != i)
            {
                result[z] = numbers[i];
                z++;
            }
        }
        return result;
    } 
```

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2021-03-19T15:20:24.123

我们可以使用`for`循环和`continue`语句来删除数组元素：

```
string[] cars = {"volvo", "benz", "ford", "bmw"};
for (int i = 0; i < cars.Length; i++)
{
    if (cars[i] == "benz")
    {
        continue;
    }
    Console.WriteLine(cars[i]);
} 
```

# flash - ActionScript 2，嵌套影片剪辑列表

> ID：496900
> 
> 赞同：2
> 
> 时间：2009-01-30T19:34:14.737
> 
> 标签：flash, list, actionscript, movieclip

有没有人尝试过在 Flash 8、AS 2 中的指定停止（和当前）帧处获取舞台上的所有影片剪辑（甚至是嵌套的影片剪辑）的列表？

我做了以下事情：

```
for(i in _root){
if(typeof(_root[i])=="movieclip"){
trace(_root[i]);}
} 
```

但这对于一级搜索很有用：也就是说，如果在movieclips 中有其他movieclips，则无法访问它们。此外，在一个movieclip 内可以有多个movieclip。

有没有人试图做我想做的事？

再见！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2010-05-31T04:21:32.543

完全按照 inkedmn 的建议

printStuff 首先检查它找到的值是否是 mc，如果是，则跟踪并检查其中是否有更多 mc。

```
printStuff = function(object){
    for(var x in object){
        if(typeof(object[x])=="movieclip"){
            trace(object[x]);
            printStuff(object[x]);
        }
    }
}
printStuff(_root); 
```

哦....对不起，迟到了一年，有些改变...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-01-30T20:04:34.440

你只是想追查吗？如果是这样的话，有一个不错的小无证实用程序叫做 ObjectDumper 可以做到这一点。

[这可能是对它最好的解释](http://blogs.adobe.com/jdehaan/2005/04/hidden_component_goodness_obje.html)

所以你可以做的是：

```
import mx.data.binding.ObjectDumper;

trace(ObjectDumper.toString(_root)); 
```

里面可能有很多额外的东西（函数、变量等），所以你可以使用一些额外的参数：

```
ObjectDumper.toString(obj, showFunctions, showUndefined, showXMLstructures, maxLineLength, indent) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-07-14T22:28:26.007

您可以通过向 MovieClip 类添加一个函数来执行类似的操作：

```
MovieClip.prototype.StopEverything = function()
{
    stop();
    for (var i in this) {
        if (typeof(this[i]) == "movieclip") {
            this[i].StopEverything();
        }
    }
}
ASSetPropFlags(MovieClip.prototype, ["StopEverything"], 1); 
```

最后一点 ASSetPropFlags 是我发现的，它允许 StopEverything 迭代内置类，如 MovieClip 使用 for..in 用于每个字段，甚至是隐藏的属性和项目。如果没有 ASSetPropFlags，StopEverything() 可能不会命中每个包含的影片剪辑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T19:44:22.967

我的 AS2 经验非常有限（我已经完成了一点 AS3），但这里有：

如果您编写了一个递归函数，如果遇到一个影片剪辑，它会查看它的所有子对象以查找其他影片剪辑（并且对在那里找到的任何影片剪辑执行相同的操作，等等）怎么办？该函数可以采用对象参数，以及在每次传递时添加的“找到”剪辑数组。

我希望我能编写能做到这一点的代码，但是（正如我所说），我不是一个 AS2 人：\

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-06-18T21:29:37.003

我今天做了与此非常相似的事情。我的剪辑是导航的一部分，是一个电影剪辑的副本。为了找出有多少，我在主舞台上放置了一个变量，该变量由电影剪辑中的动作递增。我设置了一个间隔，等到所有剪辑都被考虑在内，然后使用一个循环来填充我导航的交互性。效果也很好。希望这可以帮助某人。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2010-03-29T12:11:55.557

AS2.0 未记录的 ObjectDumper 功能没有在根目录枚举动画剪辑的原因是因为它忽略了对象根级别的 nameValue 对，这是一个严重的缺陷（至少可以说），因为关联数组的定义本身就是一个由根处的 nameValue 对组成的数组/对象。

例如：trace(ObjectDumper.toString({myName:"myValue"})) //output = ""。难怪他们没有记录这个“功能”。坦率地说，我认为在 AS2 和 AS3 中都没有内置方法可以轻松可靠地枚举对象的所有内容以用于调试目的，这真是令人惊讶。如果你在网上搜索，你会发现 for...in 循环的黑客工作只查看数组的根......没有递归。

# c# - 用属性扩展字符串类？

> ID：496911
> 
> 赞同：2
> 
> 时间：2009-01-30T19:38:16.100
> 
> 标签：c#, string, extension-methods

我有一个应用程序，我需要用公司名称填充一个文本框，并且我已经用数据库中所有可用的公司名称填充了一个自定义 AutoCompleteStringColection。当用户通过键入并从列表中选择一个新公司名称来更改公司名称时，我需要拥有所选公司的 id (Guid)，以便我可以进行查找并获取公司的其余信息。因为公司名称不能保证是唯一的，所以我无法对名称进行查找并期望拥有正确的记录。我查看了扩展字符串类，但我能找到的只是添加方法的示例。我尝试通过添加一个变量来存储 id 以及获取和设置 id 的方法，但是在检索 id 时它始终是最后一个 id 集。可以通过扩展将属性添加到类中吗？我已经改变了我试图做的事情来查找公司名称并显示一个列表，如果返回多个匹配项，用户将从中选择，但我仍然想知道我是否可以通过这种方式添加属性以防万一它又出现了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-01-30T19:40:50.557

不，您不能使用属性扩展类。此外，您不能通过继承来扩展它`String`。`sealed`唯一的办法是组合：封装`string`在你自己的类中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-01-30T19:57:04.690

听起来您应该创建自己的类：

```
class Company {
    public string Name {get;set;}
    public override string ToString() {return Name;}
    // etc
} 
```

现在绑定到一组`Company`对象；覆盖将`ToString`确保`Name`默认显示 ，您可以添加所需的任何其他内容。对于更复杂的场景，您可以使用（例如）`DisplayMember`和`ValueMember`（组合框的）指向不同的属性（而不是默认的`ToString`）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T19:57:07.950

您应该使用 ComboBox 而不是 TextBox。创建一个包含您的公司名称和 ID 的自定义类型，确保它覆盖 ToString 以返回公司名称。将这些自定义类型添加到 ComboBox 而不是直接字符串，并使用 ListItems 的 AutoCompleteSource。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-06-12T20:27:23.887

我使用了 Konrad 的答案，为了完整起见，我在这里发布了我的解决方案。我需要向我的用户显示公司名称的自动完成列表，但由于他们可能有多个同名公司，我需要 Guid id 才能在数据库中找到他们的选择。所以我写了我自己的继承自 AutoCompleteStringCollection 的类。

```
 public class AutoCompleteStringWithIdCollection : AutoCompleteStringCollection
{
    private List<Guid> _idList = new List<Guid>();

    /*-- Properties --*/

    public Guid this[int index]
    {
        get
        {
            return _idList[index];
        }
    }

    public Guid this[string value]
    {
        get
        {
            int index = base.IndexOf(value);
            return _idList[index];
        }
    }

    /*-- Methods --*/

    public int Add(string value, Guid id)
    {
        int index = base.Add(value);
        _idList.Insert(index, id);
        return index;
    }

    public new void Remove(string value)
    {
        int index = base.IndexOf(value);
        if (index > -1)
        {
            base.RemoveAt(index);
            _idList.RemoveAt(index);
        }
    }

    public new void RemoveAt(int index)
    {
        base.RemoveAt(index);
        _idList.RemoveAt(index);
    }

    public new void Clear()
    {
        base.Clear();
        _idList.Clear();
    }

} 
```

# c# - 注册热键

> ID：496913
> 
> 赞同：1
> 
> 时间：2009-01-30T19:39:06.910
> 
> 标签：c#, .net, windows, vb.net

我有这个功能：RegisterGlobalHotKey(Keys.F6, MOD_SHIFT | MOD_CONTROL); 它调用API在系统中注册全局快捷键。void RegisterGlobalHotKey(Keys hotkey, int 修饰符)

我创建了一个小选项表单来将此键设置为变量而不是像这样的固定值：RegisterGlobalHotKey(VARIABLE1, VARIABLE2 | VARIABLE3);

请参阅随附的选项表以了解更多信息

主要问题是如何将组合框字符串值转换为 Keys 枚举值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T19:47:04.617

假设您可以要求用户准确地输入枚举值的名称，您可以将文本传递给`Enum.Parse`，这将返回具有指定名称的枚举值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T19:48:56.907

将您的字符串映射到键，以及将其他字符串映射到修饰符怎么样？

地图 地图

这样可以避免代码中的一堆 if-else 字符串比较。

编辑：实际上，我想我过去也使用过安迪的建议。

# deployment - 当 basedir 是变量时，Nant Zip 任务压缩 0 个文件？

> ID：496916
> 
> 赞同：1
> 
> 时间：2009-01-30T19:39:58.267
> 
> 标签：deployment, nant

我有以下 Nant 脚本片段。

```
<zip zipfile="${devEnvironment}..\dev-${datetime::get-year(datetime::now())}${datetime::get-month(datetime::now())}${datetime::get-day(datetime::now())}.zip">
    <fileset basedir="${devEnvironment}">
        <include name="**/*"/>
    </fileset>
</zip> 
```

该`devEnvironment`属性设置为脚本其他位置的复制任务中使用的有效 UNC 路径。当我运行上述`zip`任务时，它告诉我有 0 个文件要存档（本质上，它会生成一个空的 zip 文件）。如果我用 UNC 路径替换属性`devEnvironment`中的变量`basedir`，它可以正常工作。

我看过网上的例子，大多数都显示了一个用于`basedir`;的变量。但是，我的尝试似乎不起作用。

难道我做错了什么？

编辑：为了完整起见，这里是包含在`devEnvironment`变量中的 UCN 路径，省略了特定信息。

```
\\serverName\wwwroot\appName\site\ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T20:00:05.807

详细运行它。我敢打赌，宏观扩张正在评估你意想不到的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T20:07:01.847

在详细模式下运行脚本而不对脚本本身进行任何更改（甚至没有再次点击保存）后，它工作正常。我会在没有详细模式的情况下再试一次。很奇怪，但至少它现在可以工作了。

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-01-31T02:59:30.280

Nant 对字符串中的反斜杠做了什么？我的第一个猜测是字符串真的扩展到

```
\serverNamewwwroot[BEL]ppNamesite 
```

# apache-flex - 如何在 Flex 3 中更改 LinkBut ton 标签的子字符串的颜色？

> ID：496921
> 
> 赞同：1
> 
> 时间：2009-01-30T19:42:44.780
> 
> 标签：apache-flex, actionscript

我试图找出最优雅的方法来更改 LinkBut​​ton 控件上标签的一个字符的颜色。鉴于这样的事情：

```
<mx:Style>

    myLinkButtonStyle
    {
        textRollOverColor: #FFFFFF;
    }

</mx:Style>

<mx:LinkButton label="My Label" styleName="myLinkButtonStyle" /> 
```

... 什么是最合适、最“适合灵活”（如果你愿意的话）的改变方式，例如，*仅在翻转时将“标签”一词从白色变为红色？* 看起来这应该相对简单，我敢肯定那里可能有一个 TextRange ，但我想我会先在这里问这个问题，然后再沿着一条盲道（或严重黑客攻击）。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-31T19:28:50.487

我真的不认为这是内置的。我的猜测是您需要继承 LinkBut​​ton，覆盖 commitProperties 和 updateDisplayList，并在子类上有一个额外的属性，让您定义需要突出显示的单词或范围。

# c# - 我可以强制 svcutil.exe 为 WCF 服务生成数据合同吗？

> ID：496922
> 
> 赞同：6
> 
> 时间：2009-01-30T19:43:09.117
> 
> 标签：c#, wcf, datacontractserializer, svcutil.exe

我想强制`svcutil`在 WCF 使用的程序集中生成所有数据合同，无论给定操作合同是否引用了类型。

```
[DataContract]
public class Foo { }

[DataContract]
public class Bar : Foo { }

[ServiceContract]
public interface IService
{
    [OperationContract]
    void Get(Foo foo);
} 
```

鉴于此设置，我无法`svcutil`生成 的版本，`Bar`因为当前没有引用它的操作合同。有没有办法强制`svcutil`生成数据合同`Bar`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2009-01-30T19:52:50.627

向 Foo 类添加 KnownType 属性

```
[KnownType(typeof(Bar))]
[DataContract]
public class Foo { } 
```

# java - instanceof 和 Class.isAssignableFrom(...) 有什么区别？

> ID：496928
> 
> 赞同：485
> 
> 时间：2009-01-30T19:44:24.013
> 
> 标签：java, instanceof, reflection

以下哪个更好？

```
a instanceof B 
```

或者

```
B.class.isAssignableFrom(a.getClass()) 
```

我知道的唯一区别是，当“a”为空时，第一个返回 false，而第二个抛出异常。除此之外，他们总是给出相同的结果吗？

* * *

## 回答 #1

> 赞同：531
> 
> 时间：2009-01-30T19:58:18.790

使用时`instanceof`，需要`B`在编译时知道类。使用时`isAssignableFrom()`，它可以是动态的，并且在运行时会发生变化。

* * *

## 回答 #2

> 赞同：213
> 
> 时间：2009-01-30T19:53:16.633

`instanceof`只能用于引用类型，不能用于原始类型。 `isAssignableFrom()`可以与任何类对象一起使用：

```
a instanceof int  // syntax error
3 instanceof Foo  // syntax error
int.class.isAssignableFrom(int.class)  // true 
```

看[http://java.sun.com/javase/6/docs/api/java/lang/Class.html#isAssignableFrom(java.lang.Class)](http://java.sun.com/javase/6/docs/api/java/lang/Class.html#isAssignableFrom(java.lang.Class))。

* * *

## 回答 #3

> 赞同：119
> 
> 时间：2012-08-24T09:21:49.037

谈性能：

**TL;博士**

使用具有相似性能的**isInstance**或**instanceof 。****isAssignableFrom**稍微慢一些。

按性能排序：

1.  **是实例**
2.  **实例**（+ 0.5%）
3.  **isAssignableFrom** (+ 2.7%)

*基于 JAVA 8 Windows x64 上 2000 次迭代的基准测试，其中包含 20 次预热迭代。*

**理论上**

使用类似[字节码查看器](http://bytecodeviewer.com/)的软件，我们可以将每个运算符转换为字节码。

在以下情况下：

```
package foo;

public class Benchmark
{
  public static final Object a = new A();
  public static final Object b = new B();

  ...

} 
```

爪哇：

```
b instanceof A; 
```

字节码：

```
getstatic foo/Benchmark.b:java.lang.Object
instanceof foo/A 
```

爪哇：

```
A.class.isInstance(b); 
```

字节码：

```
ldc Lfoo/A; (org.objectweb.asm.Type)
getstatic foo/Benchmark.b:java.lang.Object
invokevirtual java/lang/Class isInstance((Ljava/lang/Object;)Z); 
```

爪哇：

```
A.class.isAssignableFrom(b.getClass()); 
```

字节码：

```
ldc Lfoo/A; (org.objectweb.asm.Type)
getstatic foo/Benchmark.b:java.lang.Object
invokevirtual java/lang/Object getClass(()Ljava/lang/Class;);
invokevirtual java/lang/Class isAssignableFrom((Ljava/lang/Class;)Z); 
```

测量每个运算符使用了多少字节码指令，我们可以预期**instanceof**和**isInstance**比**isAssignableFrom**快。但是，实际性能不是由字节码决定的，而是由机器码（取决于平台）决定的。让我们为每个运营商做一个微基准测试。

**基准**

信用：根据@aleksandr-dubinsky 的建议，感谢@yura 提供基本代码，这里是一个[JMH](http://openjdk.java.net/projects/code-tools/jmh/)基准测试（请参阅此[调整指南](http://java-performance.info/jmh/)）：

```
class A {}
class B extends A {}

public class Benchmark {

    public static final Object a = new A();
    public static final Object b = new B();

    @Benchmark
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    public boolean testInstanceOf()
    {
        return b instanceof A;
    }

    @Benchmark
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    public boolean testIsInstance()
    {
        return A.class.isInstance(b);
    }

    @Benchmark
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    public boolean testIsAssignableFrom()
    {
        return A.class.isAssignableFrom(b.getClass());
    }

    public static void main(String[] args) throws RunnerException {
        Options opt = new OptionsBuilder()
                .include(TestPerf2.class.getSimpleName())
                .warmupIterations(20)
                .measurementIterations(2000)
                .forks(1)
                .build();

        new Runner(opt).run();
    }
} 
```

给出如下结果（分数是*一个时间单位内的操作次数*，所以分数越高越好）：

```
Benchmark                       Mode   Cnt    Score   Error   Units
Benchmark.testIsInstance        thrpt  2000  373,061 ± 0,115  ops/us
Benchmark.testInstanceOf        thrpt  2000  371,047 ± 0,131  ops/us
Benchmark.testIsAssignableFrom  thrpt  2000  363,648 ± 0,289  ops/us 
```

**警告**

*   基准是 JVM 和平台相关的。由于每个操作之间没有显着差异，因此在不同的 JAVA 版本和/或 Solaris、Mac 或 Linux 等平台上可能会得到不同的结果（也可能是不同的顺序！）。
*   该基准比较了“B 直接扩展 A”时“B 是 A 的实例”的性能。如果类层次结构更深更复杂（例如 B 扩展 X 扩展 Y 扩展 Z 扩展 A），结果可能会有所不同。
*   通常建议首先选择一个运算符（最方便）编写代码，然后分析您的代码以检查是否存在性能瓶颈。也许这个运算符在您的代码上下文中可以忽略不计，或者......
*   关于前一点，`instanceof`在您的代码上下文中可能比例如更容易优化`isInstance`......

举个例子，采用以下循环：

```
class A{}
class B extends A{}

A b = new B();

boolean execute(){
  return A.class.isAssignableFrom(b.getClass());
  // return A.class.isInstance(b);
  // return b instanceof A;
}

// Warmup the code
for (int i = 0; i < 100; ++i)
  execute();

// Time it
int count = 100000;
final long start = System.nanoTime();
for(int i=0; i<count; i++){
   execute();
}
final long elapsed = System.nanoTime() - start; 
```

多亏了 JIT，代码在某些时候得到了优化，我们得到：

*   实例：6ms
*   isInstance：12ms
*   isAssignableFrom : 15ms

**笔记**

*最初，这篇文章是在原始 JAVA 中使用for*循环进行自己的基准测试，这给出了不可靠的结果，因为诸如 Just In Time 之类的一些优化可以消除循环。所以它主要是测量 JIT 编译器优化循环所花费的时间：有关更多详细信息，请参阅[独立于迭代次数的性能测试](https://stackoverflow.com/questions/12106799/performance-test-independent-of-the-number-of-iterations)

**相关问题**

*   [instanceof 运算符会产生很多开销吗？为什么？](https://stackoverflow.com/questions/4973359/does-instanceof-operator-generate-a-lot-of-overhead-why)
*   [JAVA内部是如何实现instanceof的？](https://stackoverflow.com/questions/14190189/how-instanceof-is-implemented-inside-java)
*   [在 Java 中使用 instanceof 对性能的影响](https://stackoverflow.com/questions/103564/the-performance-impact-of-using-instanceof-in-java)

* * *

## 回答 #4

> 赞同：34
> 
> 时间：2011-08-15T20:58:53.560

更直接的等价`a instanceof B`于

```
B.class.isInstance(a) 
```

`a`这在is `null`too时也有效（返回 false） 。

* * *

## 回答 #5

> 赞同：29
> 
> 时间：2010-09-07T10:51:30.387

除了上面提到的基本区别外，instanceof 运算符和 Class 中的 isAssignableFrom 方法之间还有一个核心的细微差别。

读`instanceof`作“这是（左半部分）this 的实例还是它的任何子类（右半部分）”，读`x.getClass().isAssignableFrom(Y.class)`作“我可以写`X x = new Y()`”。换句话说，instanceof 运算符检查左对象是否相同或右类的子类，同时`isAssignableFrom`检查我们是否可以将参数类（from）的对象分配给调用方法的类的引用。
请注意，这两个都考虑实际实例而不是引用类型。

考虑 3 个类 A、B 和 C 的示例，其中 C 扩展 B，B 扩展 A。

```
B b = new C();

System.out.println(b instanceof A); //is b (which is actually class C object) instance of A, yes. This will return true.  
System.out.println(b instanceof B); // is b (which is actually class C object) instance of B, yes. This will return true.  
System.out.println(b instanceof C); // is b (which is actually class C object) instance of C, yes. This will return true. If the first statement would be B b = new B(), this would have been false.
System.out.println(b.getClass().isAssignableFrom(A.class));//Can I write C c = new A(), no. So this is false.
System.out.println(b.getClass().isAssignableFrom(B.class)); //Can I write C c = new B(), no. So this is false.
System.out.println(b.getClass().isAssignableFrom(C.class)); //Can I write C c = new C(), Yes. So this is true. 
```

* * *

## 回答 #6

> 赞同：14
> 
> 时间：2010-12-10T14:37:16.327

还有一个区别：

null instanceof X`false`不管 X 是什么

null.getClass().isAssignableFrom(X) 将抛出 NullPointerException

* * *

## 回答 #7

> 赞同：13
> 
> 时间：2011-01-25T16:16:10.970

还有另一个区别。如果要测试的类型（类）是动态的，例如作为方法参数传递，那么 instanceof 不会为您删除它。

```
boolean test(Class clazz) {
   return (this instanceof clazz); // clazz cannot be resolved to a type.
} 
```

但你可以这样做：

```
boolean test(Class clazz) {
   return (clazz.isAssignableFrom(this.getClass())); // okidoki
} 
```

糟糕，我看到这个答案已经涵盖了。也许这个例子对某人有帮助。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2011-12-08T16:04:19.213

这个帖子让我了解了`instanceof`与 的不同之处`isAssignableFrom`，所以我想我会分享一些我自己的东西。

我发现使用`isAssignableFrom`to 是唯一（可能不是唯一，但可能是最简单的）方法来询问自己一个类的引用是否可以采用另一个类的实例，而当一个类的实例都没有进行比较时。

因此，当我只有类时，我发现使用`instanceof`运算符比较可分配性并不是一个好主意，除非我打算从其中一个类创建一个实例；我以为这会很草率。

* * *

## 回答 #9

> 赞同：6
> 
> 时间：2013-09-09T19:30:32.433

instanceof 也不能与原始类型或泛型类型一起使用。如以下代码所示：

```
//Define Class< T > type ... 

Object e = new Object();

if(e instanceof T) {
  // Do something.
} 
```

错误是：无法对类型参数 T 执行 instanceof 检查。请改用它的擦除对象，因为更多的泛型类型信息将在运行时被擦除。

由于删除运行时引用的类型擦除而无法编译。但是，下面的代码将编译：

```
if( type.isAssignableFrom(e.getClass())){
  // Do something.
} 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2010-03-18T20:03:58.073

考虑以下情况。假设你想检查类型 A 是否是 obj 类型的超类，你可以去

... A.class.isAssignableFrom(obj.getClass()) ...

或者

... obj instanceof A ...

但是 isAssignableFrom 解决方案要求 obj 的类型在此处可见。如果不是这种情况（例如，obj 的类型可能是私有内部类），则此选项无效。但是，instanceof 解决方案将始终有效。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-03-18T13:59:30.137

```
isAssignableFrom(A, B) =

if (A == B) return true
else if (B == java.lang.Object) return false
else return isAssignableFrom(A, getSuperClass(B)) 
```

上面的伪代码是一个定义，如果类型/类 A 的引用可以从类型/类 B 的引用中分配。它是一个递归定义。对某些人来说，它可能会有所帮助，而对另一些人来说，它可能会令人困惑。我添加它以防有人发现它有用。这只是试图捕捉我的理解，它不是官方定义。它用于某个 Java VM 实现并适用于许多示例程序，因此虽然我不能保证它捕获了 isAssignableFrom 的所有方面，但它并没有完全关闭。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-08-20T17:05:04.177

谈论性能“2”（与JMH）：

```
class A{}
class B extends A{}

public class InstanceOfTest {

public static final Object a = new A();
public static final Object b = new B();

@Benchmark
@BenchmarkMode(Mode.AverageTime)
@OutputTimeUnit(TimeUnit.NANOSECONDS)
public boolean testInstanceOf()
{
    return b instanceof A;
}

@Benchmark
@BenchmarkMode(Mode.AverageTime)
@OutputTimeUnit(TimeUnit.NANOSECONDS)
public boolean testIsInstance()
{
    return A.class.isInstance(b);
}

@Benchmark
@BenchmarkMode(Mode.AverageTime)
@OutputTimeUnit(TimeUnit.NANOSECONDS)
public boolean testIsAssignableFrom()
{
    return A.class.isAssignableFrom(b.getClass());
}

public static void main(String[] args) throws RunnerException {
    Options opt = new OptionsBuilder()
            .include(InstanceOfTest.class.getSimpleName())
            .warmupIterations(5)
            .measurementIterations(5)
            .forks(1)
            .build();

    new Runner(opt).run();
}
} 
```

它给：

```
Benchmark                            Mode  Cnt  Score   Error  Units
InstanceOfTest.testInstanceOf        avgt    5  1,972 ? 0,002  ns/op
InstanceOfTest.testIsAssignableFrom  avgt    5  1,991 ? 0,004  ns/op
InstanceOfTest.testIsInstance        avgt    5  1,972 ? 0,003  ns/op 
```

这样我们就可以得出结论：**instanceof和****isInstance()**一样快，并且**isAssignableFrom()**不远（+0.9% 的执行时间）。所以无论你选择什么都没有真正的区别

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-04-13T17:29:48.257

一些例子来展示它的实际效果如何......

```
@Test
public void isInstanceOf() {
    Exception anEx1 = new Exception("ex");
    Exception anEx2 = new RuntimeException("ex");
    RuntimeException anEx3 = new RuntimeException("ex");

    //Base case, handles inheritance
    Assert.assertTrue(anEx1 instanceof Exception);
    Assert.assertTrue(anEx2 instanceof Exception);
    Assert.assertTrue(anEx3 instanceof Exception);

    //Other cases
    Assert.assertFalse(anEx1 instanceof RuntimeException);
    Assert.assertTrue(anEx2 instanceof RuntimeException);
    Assert.assertTrue(anEx3 instanceof RuntimeException);
}

@Test
public void isAssignableFrom() {
    Exception anEx1 = new Exception("ex");
    Exception anEx2 = new RuntimeException("ex");
    RuntimeException anEx3 = new RuntimeException("ex");

    //Correct usage = The base class goes first
    Assert.assertTrue(Exception.class.isAssignableFrom(anEx1.getClass()));
    Assert.assertTrue(Exception.class.isAssignableFrom(anEx2.getClass()));
    Assert.assertTrue(Exception.class.isAssignableFrom(anEx3.getClass()));

    //Incorrect usage = Method parameter is used in the wrong order
    Assert.assertTrue(anEx1.getClass().isAssignableFrom(Exception.class));
    Assert.assertFalse(anEx2.getClass().isAssignableFrom(Exception.class));
    Assert.assertFalse(anEx3.getClass().isAssignableFrom(Exception.class));
} 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2010-08-24T22:05:49.943

我们在团队中进行的一些测试表明，它的`A.class.isAssignableFrom(B.getClass())`运行速度比`B instanceof A`. 如果您需要对大量元素进行检查，这将非常有用。

# c# - 您将如何许可您的 Mono 代码？

> ID：496929
> 
> 赞同：4
> 
> 时间：2009-01-30T19:44:50.627
> 
> 标签：c#, licensing, mono

对于 winForms 环境中的 C#，我已经通过将详细信息写入 regestry，加密了我的课程。

在 Mono 下，您无法使用某些功能。注册表就是其中之一。你会用什么方法在 Mono 下授权你的代码？

我不希望恶意用户能够删除应用程序目录、重置试用计时器或复制 .LIC 文件并突然访问该程序。

任何想法，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T20:00:07.990

任何类型的加密证书许可证在 Mono 上都应该至少与在 Windows 上一样安全。在没有证书的情况下部署应用程序。如果它没有检测到证书，则它处于“缩减功能”模式。如果是这样，那么它处于“完整模式”。仅在购买时签发证书。对于功能齐全的限时试用，您会遇到更大的问题，但归根结底，没有什么能阻止用户弄乱他们的注册表，即使是在虚拟机中运行您的应用程序或使用系统大方地恢复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T20:10:32.480

您可以使用标准的 .Net Registry 类来使用注册表。您可以在那里写入您的加密值，并在以后检索它们。

然而，Linux 上的注册表只是用户主目录中的一个文件，所以你不能真正做的是从 Mono 外部修改它，比如从 .msi（例如，.msi 在 Linux 上不存在） .

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T20:13:05.703

您始终可以根据 CPUID 加密文件并将其存储在目录中。我不确定在硬盘上存储文件与在注册表中存储文件有何不同。用户仍然可以根据需要找到注册表项导出/导入它。只有当您使用 CPUID 或主板信息来加密数据时，它才会仅限于该机器。

# sql - MS SQL 更新查询，一定要简单

> ID：496935
> 
> 赞同：1
> 
> 时间：2009-01-30T19:46:15.850
> 
> 标签：sql, sql-server, tsql, syntax

我试图在表 tblCheckbook 中将每一行的 CheckColor 设置为*蓝色*（为什么人们会在每张表的开头添加 tbl，我想我知道这是一张表）。

我正在使用这个查询

```
UPDATE    tblCheckbook
SET       CheckColor = Blue 
```

但是，Microsoft SQL Server Management Studio Express 抱怨列名“蓝色”无效。

这必须是一个简单的修复。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-01-30T19:47:31.543

试试这个：

```
UPDATE    tblCheckbook
SET       CheckColor = 'Blue' 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-01-30T19:47:23.163

使用“蓝色”而不是蓝色

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-01-30T19:48:21.993

尝试在蓝色周围添加报价

```
UPDATE tblCheckbook SET CheckColor = 'Blue' 
```

# .net - 您是否应该请求 .NET 中的锁定超时？

> ID：496940
> 
> 赞同：6
> 
> 时间：2009-01-30T19:47:30.513
> 
> 标签：.net, multithreading, scalability

在[释放它！](http://www.pragprog.com/titles/mnee), Michael Nygard 解释说，许多灾难性的系统故障往往是由一连串的错误引起的。例如，两个线程死锁。现在线程池中的线程减少了两个，因此其他线程上的负载增加，从而增加了死锁*的*可能性。突然，服务器根本没有响应，因为线程池耗尽，这导致负载均衡器将流量转移到其他服务器（它们都运行相同的代码），这增加*了它们*发生死锁的可能性。突然整个农场都离线了。

大多数 RDBMS 服务器检测死锁并决定一个“失败者”（一个事务被中止，另一个可以继续）。相比之下，在 C# 中，**lock**语句将无限期地等待获取锁。

但是，您可以调用[Monitor.TryEnter(lockObject, TimeSpan)](http://msdn.microsoft.com/en-us/library/system.threading.monitor.tryenter.aspx)来请求锁定或超时。如果超时到期并且无法获取锁，则返回 false。有些人将其[包装在 using 语句](http://www.interact-sw.co.uk/iangblog/2004/03/23/locking)中以保持良好的语法。

所以我的问题是，您是否总是使用超时获取锁？与死锁场景相比，超时会产生哪些问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-01-30T19:52:46.040

我通常使用超时。这里最大的问题是，如果达到超时，请求操作将被中止。这显然比死锁更可取。但是那里有一个更大的问题：如果操作很关键并且您因为其他事情陷入僵局而开始中止，如果您的设计不合理，您最终可能会导致您通过这种方法描述的农场下降问题（虽然更软：你的应用程序将不再工作，但你并没有失去控制）。

主要区别在于您实际上在这里拥有控制权，而如果线程开始死锁，那么一旦故障开始，您就无法在代码中解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T19:54:14.587

作为一般规则，我*从不*创建具有无限超时的锁。它只会导致难以发现和难以调试的死锁。添加超时检查不需要任何额外的工作，即使它只是抛出异常，并且如果您遇到死锁，它几乎会立即通知您。更重要的是，它可以帮助您找到可能不会导致完全死锁的 bu 锁的瓶颈。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-01-30T19:58:01.070

您能否从锁定尝试超时的情况中优雅地恢复？如果可以，那么一定要使用超时。如果你不能，那么超时就没有什么意义了。当你恢复执行时你会做什么？充其量您可以退出并显示错误消息。超时有其用途，但它们也可以用作隐藏微妙线程错误的一种方式，因此我认为最好的建议是谨慎使用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-01-30T19:54:29.483

可以证明不会发生死锁。也可以在运行时证明即使不依赖于竞争条件也可能发生死锁（例如，参见 Linux 的[*lockdep*](http://www.mjmwired.net/kernel/Documentation/lockdep-design.txt)）。

因此，*总是*尝试锁定是没有意义的。这取决于情况。

# .net - 托管在开发环境中的 IIS 中时的 asp-mvc 路由

> ID：496943
> 
> 赞同：0
> 
> 时间：2009-01-30T19:47:44.083
> 
> 标签：.net, asp.net-mvc, url-routing

我在“localhost/mvcapplication1”下的 IIS 5.1 环境中有应用程序

路由配置类似于：

```
 routes.MapRoute("mvc-default", "{controller}.mvc/{action}/{id}"
        , new { controller = "Home", action = "Index", id = (string)null });

    routes.MapRoute("Root", ""
        , new { controller = "Home", action = "Index", id = (string)null }); 
```

当页面通过“根”路由时，视图上的链接将指向

*[http://localhost/mvcapplication1/MvcApplication1/Product.mvc](http://localhost/mvcapplication1/MvcApplication1/Product.mvc)*

，这显然是不存在的。但是，当使用第一个“mvc-default”时，它运行良好。

如果应用程序托管在[http://......./](http://......./)下也可以正常工作。

关于如何解决它的任何提示？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-01T13:06:49.337

您遇到 404 错误，因为您设置了路由规则“{controller}.mvc/{action}/{id}”，这显然在控制器名称后添加了 .mvc 扩展名，而“”路由规则不会优先考虑，甚至可以工作，因为您使用的是未配置的 IIS。

要在不配置 IIS 的情况下修复它，您可以将 .mvc 更改为 ASP.Net 当前处理的内容，例如 .aspx、.asmx 或其他内容。
如果您想要修复 IIS，请访问下面的链接，按照说明操作，然后删除 .mvc 扩展名。

[ASP.Net](http://www.asp.net/learn/mvc/tutorial-08-cs.aspx)
[Phil Haack 的博客](http://haacked.com/archive/0001/01/01/asp.net-mvc-on-iis-6-walkthrough.aspx)
如果您只是 Google 一下，您可以找到更多关于它的帖子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T10:42:09.707

也许这有效：
更改：

 `````
HttpContext.Current.RewritePath(Request.ApplicationPath); 
```` 

`至`

 ``````
HttpContext.Current.RewritePath(Request.ApplicationPath, false); 
```` 

`在 default.aspx.cs（或 default.aspx.vb）中`

 `* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-30T12:53:20.313

晚了一年，但也许这会帮助别人。我有同样的问题，因为我们使用 IIS6，我通过将这两个条目作为我的路由配置中列出的最后两个条目来让它工作：

```
 routes.MapRoute(null, "{controller}.aspx/{action}");
        routes.MapRoute(
            "Default",                                              // Route name
            "{controller}.aspx/{action}/{id}",                           // URL with parameters
            new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
        ); 
```

将“.aspx”更改为您的“.mvc”或您需要的任何内容。

# javascript - 使用字符串调用 JavaScript 函数名？

> ID：496961
> 
> 赞同：50
> 
> 时间：2009-01-30T19:50:28.120
> 
> 标签：javascript

如何将事件连接到我定义为字符串的函数名称？

我正在使用 Prototype.js，尽管这不是 Prototype 专用的。

```
$(inputId).observe('click', formData.fields[x].onclick); 
```

这将导致 JavaScript 抱怨我的处理程序不是函数。我不希望我们使用`eval()`.

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2009-01-30T19:53:52.793

[属性访问](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Property_Accessors)器可用于访问任何对象的属性或函数。

如果函数在全局范围内，您可以使用 window 对象获取它：

```
var myFunc = window[myFuncName]; 
```

这也适用于以下`this`范围：

```
var myFunc = this[myFuncName]; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2010-10-26T11:19:25.093

我已经解决了这个问题，因为我需要这样的功能。这是我的沙盒代码，未经彻底测试，但可以作为其他人的起点。请注意，代码中有一个 eval() ，因为我不知道如何绕过该步骤，可能是 javascript 怪癖，无法以任何其他方式完成。让我知道是否有办法在这里摆脱 eval() ！

```
executeFunctionByName = function(functionName)
{
    var args = Array.prototype.slice.call(arguments).splice(1);
    //debug
    console.log('args:', args);

    var namespaces = functionName.split(".");
    //debug
    console.log('namespaces:', namespaces);

    var func = namespaces.pop();
    //debug
    console.log('func:', func);

    ns = namespaces.join('.');
    //debug
    console.log('namespace:', ns);

    if(ns == '')
    {
        ns = 'window';
    }

    ns = eval(ns);
    //debug
    console.log('evaled namespace:', ns);

    return ns[func].apply(ns, args);
}

core = {
    paragraph: {
        titlebar: {
            user: "ddd",
            getUser: function(name)
            {
                this.user = name;
                return this.user;
            }
        }
    }
}

var testf = function()
{
    alert('dkdkdkd');
}

var x = executeFunctionByName('core.paragraph.titlebar.getUser', 'Ikon');
executeFunctionByName('testf'); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-01-30T19:57:57.607

...或者这个[myFuncName];

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2011-11-09T10:51:11.080

也许？

```
setTimeout ( "myFunc()", 1 ); 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-03-28T16:33:49.307

只是一个`eval`会做的工作

```
var call = eval("method_name").call(args); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2009-01-30T19:54:56.347

```
window.myFunction === window["myFunction"] 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2009-01-30T19:58:50.163

看起来像`formData.fields[x].onclick`持有一个全局函数的名称？如果是这样尝试：

```
$(inputId).observe('click', window[formData.fields[x].onclick]); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2009-01-31T23:33:39.120

你知道 onclick 属性包含什么或它是什么类型吗？我认为这是特定于原型的东西，因为 DOM 表单中不存在“字段”。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-09-19T11:47:10.940

如果您需要使用参数调用字符串函数，请执行以下操作：

```
window[stringFunctionName].apply( window, arrayOfArguments ) 
```

如果愿意`scope`，您可以使用`window`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-12-10T09:15:59.073

更新：--- 使用 ES6 导出和导入

一个.js

```
const fn = {
  aaa: function() {
    //code
  },
  bbb: function() {
    //code
  },
  //codes ....
  nnn: function() {
    //code
  }
}

export default fn 
```

b.js

```
 import someFn from './a'
  //eg
  const str1='aaa'
  const str2 = 'bbb'

  someFn[str1]() 
```

* * *

*   `eval('str')`（过时的功能[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Deprecated_and_obsolete_features](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Deprecated_and_obsolete_features)）

*   `setTimeout('str')` `setInterval('str')`

*   `window['str']`（但是......有时，全局对象不是窗口）

*   `new Function('str')`

由于某些原因，上述这些方法总是不被推荐，但它们使用起来确实很方便。下面的这些方法是安全的，但确实不方便使用。

*   switch...case（或 if...else）

    ```
    switch(str){
        case 'str1': 
            fn1()
            break
        case 'str2':
            fn2
            //and so on
    } 
    ```

*   将函数放入对象中

    ```
    const fn={
        str1:fn1,
        str2:fn2
        //and so on
    }
    fn[str1] //call function 
    ```

# .net - 向下箭头不会触发 KeyPress 事件

> ID：496974
> 
> 赞同：4
> 
> 时间：2009-01-30T19:54:10.017
> 
> 标签：.net, winforms

有谁知道为什么当用户按下向下箭头时 KeyPress 事件不会被触发？我必须在 KeyDown 事件中寻找它。这只是我做错了什么吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-01-30T19:56:25.737

根据 KeyPress 事件的文档（假设您使用的是 WinForms）：

> 非字符键不会引发 KeyPress 事件；但是，非字符键确实会引发 KeyDown 和 KeyUp 事件。

向下箭头键不是字符键，因此不应为此引发此事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-01-30T19:57:54.393

改用 KeyDown

```
Public Class Form1
    Private Sub TextBox1_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles TextBox1.KeyDown
        Debug.WriteLine(e.KeyData.ToString + " KeyDown")
    End Sub

    Private Sub TextBox1_KeyPress(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyPressEventArgs) Handles TextBox1.KeyPress
        Debug.WriteLine(e.KeyChar.ToString + " KeyPress")
    End Sub
End Class 
```

# apache-flex - 在 mxml 中使用组件引用是否安全

> ID：496982
> 
> 赞同：1
> 
> 时间：2009-01-30T19:55:24.710
> 
> 标签：apache-flex, radio-button, mxml

考虑以下单选按钮示例。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml">
<mx:Script>
<![CDATA[
    private function getRb1():RadioButton {
        trace(rb1 == null);
        return rb1;                     
    }   
]]>
 </mx:Script>
<mx:VBox>
    <mx:RadioButtonGroup **id="rbg" selection="{getRb1()}**"/>      
    <mx:RadioButton id="rb1" label="Radio Button 1" />
    <mx:RadioButton id="rb2" label="Radio Button 2" />
    <mx:RadioButton id="rb3" label="Radio Button 3" />
</mx:VBox>  
 </mx:Application> 
```

问题是我在定义 RadioButtonGroup 时不能引用 rb1，当时 rb1 为空，但我可以使用 selectedValue 来设置初始选择。

我只是想知道这是一些特殊情况还是在一般情况下引用 mxml 中的组件是不安全的。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-01-30T21:02:05.090

我不太确定你在问什么，但希望这能回答你的问题——来自 Flex 文档：

> **RadioButtonGroup.selection**
> 包含对组中当前选定的 RadioButton 控件的引用。您只能在 ActionScript 中访问该属性；*它在 MXML 中不可设置*。将此属性设置为 null 会取消选择当前选定的 RadioButton 控件。

不过，总的来说，在 MXML 中进行组件引用是完全可以的。这就是通常处理效果的方式，以及许多其他事情。例如：

```
<mx:Glow id="g" />
<mx:Label showEffect="{g}" /> 
```

但是，在您的情况下，假设您在设置所选项目时遇到问题，可能是因为您没有`group`在单选按钮上指定属性；省略将组组件与各个按钮分离。添加后，您可以使用`Bindable`包含对组件的引用的变量来绑定组的选择属性，如下所示：

```
<mx:Script>
    <![CDATA[

        [Bindable]
        private var selectedRadioButton:RadioButton;    

        private function this_creationComplete(event:Event):void
        {
            selectedRadioButton = rb1;
        }

        private function btn_click(event:Event):void
        {
            selectedRadioButton = rb2;
        }

    ]]>
 </mx:Script>
<mx:VBox>
    <mx:RadioButtonGroup id="rbg" selection="{selectedRadioButton}" />
    <mx:RadioButton id="rb1" group="{rbg}" label="Radio Button 1" />
    <mx:RadioButton id="rb2" group="{rbg}" label="Radio Button 2" />
    <mx:RadioButton id="rb3" group="{rbg}" label="Radio Button 3" />

    <mx:Button label="Choose a Different Button" click="btn_click(event)" />
</mx:VBox> 
```

这有意义吗？希望它不是完全偏离标准。回帖让我知道，我会尽我所能提供帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-31T01:20:10.420

通常：仅仅因为在 MXML 中声明了控件并不意味着它在运行时可用（它可能从 AS 中删除，尚未创建，未添加到阶段，因此某些属性尚不可用）。这表明在运行时访问组件并依赖于值是不安全的。

# asp.net-mvc - 在 MVC RC1 中创建强类型视图

> ID：496987
> 
> 赞同：0
> 
> 时间：2009-01-30T19:56:31.603
> 
> 标签：asp.net-mvc

我正在尝试向创建新 MVC 项目时创建的示例应用程序添加强类型视图，但我没有得到任何东西。我在 Models 文件夹中添加了一个“Warehouse.dbml”LINQ to SQL 文件，其中包含一个表。当我转到 Views 文件夹并右键单击并选择 Add | 查看，我在“创建强类型视图”下看到的只是示例应用程序附带的类型：

*   MyProject.AccountMembershipService
*   MyProject.FormsAuthenticationService

我缺少哪些步骤才能使我的表成为可用类型？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-01-30T22:59:10.733

您是否尝试过查看您的 web.config 并包含这些命名空间？

```
<namespaces>
    <add namespace="System.Web.Mvc"/>
    <add namespace="System.Web.Mvc.Ajax"/> 
```

您将添加另一个元素，例如

```
<add namespace="MyProject.Data" /> 
```

那应该解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-01-30T22:39:12.210

今天遇到同样的事情，我自己的课程没有出现在下拉框中。奇怪的是后来他们做到了。也许您需要先编译您的项目？

还看到论坛/博客上的其他人也遇到了同样的问题。如果您只是在下拉列表/文本框中输入模型的名称，这行得通吗？

# capistrano - 如何使用 capistrano 回滚到之前部署的版本？

> ID：496998
> 
> 赞同：79
> 
> 时间：2009-01-30T19:57:59.337
> 
> 标签：capistrano

我尝试使用“上限回滚”，但出现以下错误：

> $上限回滚
> 
> 任务“回滚”不存在

我需要做一些额外的设置才能让回滚工作吗？

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2009-01-30T19:59:49.147

刚刚在这里找到了答案[http://github.com/leehambley/railsless-deploy](http://github.com/leehambley/railsless-deploy)：

> 上限部署：回滚

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-07-11T18:31:55.283

如果您使用多阶段gem（例如您`require 'capistrano/ext/multistage'`在deploy.rb 文件中的）使用不同的环境（例如登台、生产），那么Capistrano 默认为登台。因此，要回滚生产环境，您将执行以下操作：

```
cap production deploy:rollback 
```

并且，假设您设置了默认值，这将回滚暂存：

```
cap deploy:rollback 
```

值得知道您是否使用不同的环境，并想知道为什么它不适用于生产。

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2015-05-27T13:34:42.737

**简单回滚：**

```
$ cap deploy:rollback 
```

**回滚到特定版本：**

```
$ cap deploy:rollback -s previous_release= [path to previous release under releases folder ] 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2012-03-13T12:34:12.447

其实是

```
cap deploy:rollback:code 
```

**deploy:rollback**可以回滚到以前的版本，不一定是以前部署的版本。````*******************