# StackOverflow 问答 000513000-000513999

# c++ - 有什么我可以用 C 做但我不能用 C++ 做的事情吗？

> ID：513009
> 
> 赞同：13
> 
> 时间：2009-02-04T19:58:59.893
> 
> 标签：c++, c

有什么我可以用 C 做但我不能用 C++ 做的事情吗？我在一个样本面试问题网站上偶然发现了这个问题......

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2010-07-30T13:42:25.660

声明一个名为 'class' 的变量，如下所示：

```
int class = 0; 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2010-07-30T13:26:55.660

> ...那是我可以在 C 中做的任何事情，但在 C++ 中却不行。

两种语言都是图灵完备的，因此理论上您可以在两者中编写功能相同的应用程序。

OTOH，C++ 不是 C 的超集。特别是 C99 有一些 C++ 没有的特性。例如，指定的初始化器、结构中的可变长度数组和自动变量。根据您的“任何事情”，这可能是 C++ 无法做到但 C 可以做到的事情。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2009-02-04T20:08:52.307

在 C 中，您可以创建数组文字（“复合文字”），但在 C++ 中，您不能

```
/* p points to the first element of an array of 4 int */
int *p = (int[]){1, 2, 3, 4}; 
```

您还可以创建一个大小在编译时未知的数组，但 C++ 没有这种可能性（“可变长度数组”）：

```
// create array. size is known at runtime only.
int p[rand() % 5 + 1]; 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2009-02-04T20:02:43.817

```
int new = 0; 
```

在 C 中工作，但显然不能在 C++ 中工作，因为“新”是保留字。

保留字还有其他一些“技巧”，但除此之外，您几乎可以在 C 中完成所有可以在 C++ 中完成的操作。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2009-02-04T21:31:29.223

C++ 缺少 C99 的[`restrict`限定符](http://developers.sun.com/solaris/articles/cc_restrict.html). 因此，没有办法告诉编译器基于知道指针不是别名来执行优化。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2010-07-30T13:34:59.063

不少东西。例如，在 C 中，您可以编写如下代码：

```
void * v = 0;
char * p = v; 
```

你可以像这样创建数组：

```
int main() {
    int n = 42;
    int a[n];
    return 0;
} 
```

两者都不会在 C++ 下编译。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-04T20:06:12.453

有些东西你可以在 C 中**说**，而在 C++ 中你不能（因为 C++ 有更严格的语法检查，而 C 有更广泛的“遗留”语法）。

另外，可能有一些运行时环境（O/S+library+compiler）支持C但不支持C++，所以你可以在那些你不能**做**C++的平台上做C。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-04T20:20:10.850

从语法上讲，有些东西可以用 C 编写，但不能在 C++ 中编译（请参阅[ISO C 和 ISO C++ 之间](http://david.tribble.com/text/cdiffs.htm)的不兼容性了解详细信息。）。如果你在更高的层次上问，如果有一些程序可以用 C 编写，但不能用 C++ 编写，那么答案是“不”。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2009-02-05T02:46:09.620

您可以在 C 中稀疏地初始化数组。我喜欢用它来映射 int->sometype 以获得相对密集的静态映射，其中未映射的值可以解释为 0：

```
int my_array[] = { [1] = 3, [4] = 2 };
printf("%d %d %d\n", sizeof my_array, my_array[0], my_array[1]);
/* prints 20, 0, 3 */ 
```

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2009-02-04T20:23:01.500

在“C”中，您不需要前向声明。这允许您传递被错误解释的参数。 *（并不是说这是一个很棒的功能，但你不能在 C++ 中做到这一点）*

在文件 A 中：

```
float sum(float a, float b)
{
   return a+b;
} 
```

在文件 B

```
main()
{
  printf("%f\n", sum(1,2));
} 
```

使用 C 编译，但打印 0.000

使用 C++，您需要`float sum(float,float);`在 printf 之前添加一个，它会给出预期的结果。

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2012-04-15T16:22:01.163

在 C 中，您可以使用以下名称声明变量：

```
bool, class, new, delete, template, typename, this, throw, catch, 
typeid, operator, virtual, static_cast, reinterpret_cast, 
dynamic_cast, mutable, public, private, protected, friend; //many more 
```

那么你可以这样做：

```
int namespace = private + protected + public;
int decltype  = static_cast + dynamic_cast + reinterpret_cast;
int constexpr = (new + delete) * (template + typename); 
```

它们都是 C++11 中的关键字。

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2010-07-30T13:41:16.317

其实，我可以想到一个例子：

当您创建要由其他应用程序共享的库（.lib 文件或 .dll 文件）时，最好使用 C 而不是 C++，因为结果更便于移植。不过，您可以在 C++ 编译器中使用“extern "C"”块来执行此操作。

具体来说，C++ 有一个怪癖，其中没有名称修饰的标准约定 - 用于将库的函数签名转换为编译器使用的更底层的名称。因此，例如，如果您有一个像“int addNumbers (int a, int b)”这样的函数，不同的 C++ 编译器可能会将这个函数翻译成不同的名称，这可能会在您想要导入库时导致问题。如果您使用 C 编译器或使用 C 块包围您的库导入和导出代码，尽管您不会看到这个问题，因为在 C 中只有一种方法可以破坏函数名称。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2010-07-30T13:52:52.567

1998 年 C++ 标准有一个与 1990 年 C 标准不兼容的列表，长达 13 页（附件 C）。当然，与描述语言的页面数量相比，它并不多，但仍然涵盖了一些基础。

它列出的差异类型的快速摘要：

*   添加了新关键字（任何使用它们作为标识符的 C 程序都不是 C++）
*   字符文字的类型从 int 更改为 char（`sizeof('a')`在 C 和 C++ 中进行比较！）
*   字符串文字变成了 const （不能做`char* q = expr ? "abc" : "de";`）
*   “暂定定义”已从语言中删除。
*   “兼容类型”已从语言中删除。
*   从 void* 转换为任何其他指针现在需要强制转换。
*   从任何 const/volatile 指针转换为 void* 现在需要强制转换。
*   “隐式声明”已从语言中删除。
*   表达式不能再创建新类型（如`p = (void*)(struct x {int i;} *)0;`）
*   一些表达式的结果变成了左`sizeof(0, arr)`值（比较`char arr[100];`）

...那是附件 C 的前 3 页。

如果您使用 1999 年的 C 标准，那么这些差异将永远无法描述。尽管 C++0x 确实包含了一些 C99 特性，但其中许多特性本质上是不兼容的，比如复杂类型。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2009-02-04T20:05:15.060

你几乎可以用任何编程语言做任何事情。当然表达的方式会有所不同，还有代码的数量、代码的清晰度、进一步维护的难易程度。有些任务可以用 Prolog 中的几行代码和 C++ 中的几页代码来编写，等等。

一些限制因素是可用的库、可用的编译器和低级问题。但是，当您在典型 PC 上考虑 C 和 C++ 时，它们中的任何一个都可以完成的事情没有区别。

当然，除非你问的是 C 和 C++ 之间的区别——因为这些其他人已经给了你这个想法。

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2009-02-04T20:05:29.227

```
char *c = malloc(sizeof(char)); 
```

在 C 中有效，而不是在 C++ 中有效，即自动转换`void*`. 这当然是一个语法问题，而不是你能做和不能做的事情（即完成）。

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2010-07-30T13:28:59.220

如果标准是解决一个特定的编程问题，那么两者都可以完成这项工作，尽管在某些情况下，由于更高级别的抽象，在 C++ 中完成它可能会更容易一些

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2009-02-04T20:20:19.447

这是指最新的C标准吗？最初的 C 标准（ANSI 1989 或 ISO 1990，以及 1995 年的更新）非常接近于成为 C++ 的子集。存在差异，但它们大多是人为的（最大的例外可能是 void * 可以自由转换 C 中的任何数据指针，但不能使用 C++）。

然而，一个[新的 C 标准](http://en.wikipedia.org/wiki/C99)于 1999 年问世，在我停止用最现代的 C 做任何事情之后的一段时间。它有新的特性，其中一些将在今年或明年进入 C++ 标准，但不是全部。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2009-02-04T20:04:24.827

简短的回答是......不，不是真的。见[http://www.research.att.com/~bs/bs_faq.html#difference](http://www.research.att.com/~bs/bs_faq.html#difference)

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2010-07-30T13:45:13.960

C++ 显然不是 C 的超集，原因很简单：新关键字已添加到 C++
类、virtual、new 等，因此不能再用作 C++ 中的标识符。

有些原因更微妙。
您可以在 Bjarn Stroustrup 的网站上找到该问题的详尽答案： [C++ 编程语言 | 附录 B](http://www2.research.att.com/~bs/3rd_compat.pdf)

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2009-02-05T10:24:02.563

C++ 不支持命名结构成员初始化，在 C 中你可以这样做：

结构 { int x, y; } a = { .x = 3 };

您还可以将其与[Matt Havener](https://stackoverflow.com/users/62723/matt-havener)显示的功能结合使用：

结构 { int a[3], b; } w[] = { [0].a = {1}, [1](https://stackoverflow.com/users/62723/matt-havener) .a[0] = 2 };

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2010-07-30T13:29:52.460

“如果不能在组装中完成，那就不值得了！”

好的，除了幽默，我*认为*OP 是在语法上而不是在操作上询问。

我认为有一些晦涩难懂的东西在 C（至少 C89）中是合法的，但在 C++ 中是不合法的，或者至少已被弃用......但是（如果它们存在的话）它们非常模糊。C++ 在功能上是 C 的超集。

# php - PHP XML 解析

> ID：513010
> 
> 赞同：6
> 
> 时间：2009-02-04T19:59:02.233
> 
> 标签：php, xml, parsing, simplexml, domdocument

在 PHP 中解析 XML 文件的最佳方法是什么？

**首先**
使用 DOM 对象

```
//code
$dom = new DOMDocument();
$dom->load("xml.xml");

$root = $dom->getElementsByTagName("tag");
foreach($root as $tag)
{
$subChild = $root->getElementsByTagName("child");

// extract values and loop again if needed
} 
```

**二**
使用 simplexml_load 方法

```
// code
$xml = simplexml_load_string("xml.xml");
$root = $xml->root;
foreach($root as $tag)
{
$subChild = $tag->child;
// extract values and loop again if needed
} 
```

注意：这是我知道的两个。如果有更多的填写。

想知道哪种方法最适合解析巨大的 XML 文件，也想知道哪种方法**最快**，而不管该方法需要实现的方式

大小从 500KB 到 2MB 不等。如果可能的话，解析器应该能够在最少的时间内解析大文件和小文件，并具有良好的内存使用率。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T20:47:45.863

这取决于您传递的文档，但 XMLReader 通常比 simplexml 和 DOM ( [http://blog.liip.ch/archive/2004/05/10/processing_large_xml_documents_with_php.html](http://blog.liip.ch/archive/2004/05/10/processing_large_xml_documents_with_php.html) ) 都快。就个人而言，虽然我从未使用过 XMLReader 并且通常根据我是否需要编辑它来决定使用哪个：

*   simplexml 如果我只是在阅读文档
*   DOM 如果我正在修改 DOM 并将其保存回来

您还可以在 simplexml 和 DOM 之间转换对象。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-06T07:48:55.713

我已经开始使用 XMLReader 来解析 XML 文件。在进行了一些谷歌搜索后，发现它是解析 XML 文件的最佳方式，因为它不会将整个 XML 文件加载到内存中。假设假设我的 XML 文件为 5 MB，而使用 XMLReader 解析它时，我的 5MB 内存不会被浪费。

```
//usage
$xml = new XMLReader();
$xml->XML($xmlString);
while($xml->read)
{
if($xml->localName == 'Something') // check if tag name equals something
{
//do something
}
} 
```

使用 XML Reader，我们可以找到当前标签是开始标签还是结束标签，并根据需要进行必要的操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T12:25:52.083

如果您正在处理**大**文件，请不要解析它们。改为应用[XSLT 。](http://www.php.net/manual/en/book.xslt.php)这将为您节省大量内存和处理时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T20:29:05.123

我更喜欢 simplexml_load_string 以方便使用。如果两者使用不同的文件解析方法，处理速度很可能取决于 XML 文件的格式 - 在您自己的文件上尝试一下，看看哪个更适合您。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T21:35:38.030

现在我开发时，所有 XML 都由 PHP 中的 simpleXML 处理。它很容易扩展，并在需要时覆盖方法。

# python - 从 Apache 调用 Wine

> ID：513023
> 
> 赞同：0
> 
> 时间：2009-02-04T20:01:09.140
> 
> 标签：python, apache, mod-python, wine

我有使用在 Gentoo linux 下运行的 mod_python 3.3.1/Python 2.5 的 Apache/2.2.11。在我的 python 脚本中，我使用 wine（os.popen2 调用）调用了一个 win32 exe。这在 Apache 之外运行良好，但在 mod_python 下我得到：

```
wine: cannot open /root/.wine : Permission denied 
```

在 /var/log/apache/error_log 中。我的 apache 安装没有作为 root 用户/组运行。有什么想法为什么要调查 /root/.wine 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T20:03:02.477

可能是因为`$HOME`设置不正确...

顺便提一句。你真的确定从 mod_python 调用 wine 是个好主意吗？

如果你确定，这样的事情可能会奏效......

```
from subprocess import Popen        

HOME = '/the/home/of/www-data' #PLEASE edit
proc = Popen(cmd, shell=False, stdin=PIPE,
             stdout=PIPE, stderr=PIPE, close_fds=True,
             cwd=HOME, env={"HOME":HOME) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-06-07T09:46:32.903

我也过得很艰难，做了很多研究，但失败了。最后通过添加文件找到`'WINEPREFIX="/srv/www/.wine"'`了最简单的方法：`/etc/init.d/httpd`

```
case $ARGV in
start|stop|restart|graceful|graceful-stop)
    WINEPREFIX="/srv/www/.wine" $HTTPD -k $ARGV
    ERROR=$?
    ;; 
```

将所有者复制`/root/.wine to /srv/www/.wine`并更改为 apache（从根目录）。希望这能解决问题。

# sql - SQL 性能问题

> ID：513026
> 
> 赞同：4
> 
> 时间：2009-02-04T20:01:35.613
> 
> 标签：sql, optimization, performance

我有一个关于 SQL 性能的问题。我将用伪代码说明我的问题。

我想知道哪个会更好，多少？在每个页面加载时说 10 个项目。在 .NET 中。是不是快很多？快一点？SQL 上的差异不明显？

```
foreach(item in mylist) {
CallSQLStoredProc(item.id);
} 
```

对比

```
int[] ids; // array of ids
CallSQLStoredProc(ids)  // stored procedure returns more than one row for each id 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T20:06:03.843

第二种选择肯定会更快，因为它是单个网络往返，以及单个 SP 调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T20:08:31.233

绝对是第二个，从大约 10 倍快到快一点不等。

如果您对 id 所做的任何事情都可以在一组操作中完成，那么您将获得比单独调用 SP 几倍的性能增益。

我经常有看起来像这样的过程：

> ```
> create procedure proc ( @ids varchar(max) ) as
> select * from users_tbl u
> inner join spiltCSVs(@ids) c
>   on c.id = u.id
> --so on and so forth 
> ```

这是一个基于集合的操作；与在 proc 中使用游标或使用 for 循环迭代调用具有单独 id 的过程的过程方法相反。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T20:11:03.583

因为这不适合对 ocdecio 的回答发表评论......

只是为了扩展它......在我见过的大多数系统中，网络流量是性能的限制因素（假设一个合理调整的数据库和前端代码并不是绝对可怕的）。即使您的 Web 服务器和数据库服务器在同一台机器上，如果您在两者之间频繁来回调用，进程间通信也可能是一个限制因素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T21:04:13.023

如果您希望应用程序具有可伸缩性，您将希望尽可能多地使用缓存。您应该只运行一次任何共享查询并将结果存储在缓存中。

至于您的查询，如果您没有在查询中为每个 ID 使用游标，那么如果网络延迟对您的操作有有意义的影响，它应该会更快。如有疑问，请测量。当我实际在我的函数上实现计时以查看不同的事情需要多长时间时，我多次感到非常惊讶。

在.net System.Diagnostics.StopWatch 是你的朋友:)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T20:25:56.890

迭代任何东西总是会导致更多的开销。迭代提高性能的情况并不多。

我的建议一直是在编程中避免两件事：

1.  if then else 语句
2.  迭代

您总会遇到同时使用这两种方法的情况，但使用它们的次数越少，您的应用程序就越有可能运行得更快、更流畅。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T20:07:37.490

在每次页面加载时，还是在第一次加载页面时？我不想对 ASP.NET 页面中的每个回发都这样做。

要更直接地回答您的问题，如果您能够通过发送多个 ID 获得多条记录，请执行此操作。如果您需要超过 10 个项目，则更高效且更具可扩展性。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T20:07:53.277

这完全取决于 proc 的编码方式，如果您在第二个 proc 中传入 10 个项目，然后该 proc 使用游标来获取这些行，那么第一次调用可能会更快

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T20:13:02.923

第二个会快多少真的取决于太多的事情。与结果集的大小相比，网络开销可能微不足道。

还有另一种选择（根据锁定行为，它应该比任何一种都快），即[异步调用所有它们](http://www.devx.com/dotnet/Article/26747)- 然后您的页面可以在最长的页面完成时有效地完成。显然，这将需要一些额外的编码。

在此示例中，只有一个 SP 开销。我们假设 SP 返回客户端将拆分/处理的单个行集或多个行集：

```
int[] ids; // array of ids
CallSQLStoredProc(ids)  // stored procedure returns more than one row for each id 
```

在此示例中，SP 调用开销是单个调用的 n 倍。并且调用是序列化的：

```
foreach(item in mylist) {
    CallSQLStoredProc(item.id);
} 
```

在第三种选择中：

```
foreach(item in mylist) {
    StartSQLStoredProc(item.id);
}

// Continue building the page until you reach a point where you absolutely have to have the data

wait(); 
```

这仍然有 n 个 DB 调用开销，但性能改进可能取决于 SQL Server 和网络的容量，以便并行化工作负载。此外，您还可以在页面构建时启动 SQL Server 的工作。

单个 SP 解决方案仍然可以胜出，特别是如果它可以使用 UNION 组合单个结果集，其中 SQL Server 可以并行化任务。但是，如果结果集具有单独的模式或 UNION 不能很好地执行，多 SP 异步解决方案可以击败它（并且还可以利用在页面中执行其他工作的能力）。

# c# - C# 等效于 Java 'implements' 关键字？

> ID：513028
> 
> 赞同：24
> 
> 时间：2009-02-04T20:02:28.747
> 
> 标签：c#, java

在 Java 中，如果你有这样的声明：

```
public class MyClass implements LargerClass { 
```

你会用更多的方法来扩展 LargerClass 吗？

C# 中这个类定义的等价物是什么？

我问是因为我对 Java 不是很熟悉，目前正在将一些 Java 代码转换为 C# 代码，这给我带来了一些麻烦。

提前致谢。

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2009-02-04T20:06:05.777

```
public class MyClass implements LargerClass 
```

在 Java 中， this 声明`MyClass`实现了[接口](http://java.sun.com/docs/books/tutorial/java/IandI/createinterface.html) `LargerClass`；也就是说，为`LargerClass`.

要从Java 中的另一个类[继承](http://java.sun.com/docs/books/tutorial/java/IandI/subclasses.html)`extends`，请使用，例如

```
public class MyClass extends LargerClass 
```

在这两种情况下，C# 等效项都指定为

```
public class MyClass : LargerClass 
```

由于这种语法没有明确说明`LargerClass`是接口还是另一个类被继承，您会发现 C#/.NET 开发人员采用接口名称以大写“I”为前缀的约定，例如`IEnumerable`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T20:04:04.737

```
public class MyClass : LargerClass
{

} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T20:04:06.403

```
public class MyClass : LargerClass {...} 
```

# c++ - 如何在 C++ 中创建类型安全的 int - enum？

> ID：513033
> 
> 赞同：2
> 
> 时间：2009-02-04T20:03:11.210
> 
> 标签：c++, class, enums

我需要创建许多介于整数和枚举之间的类。即具有整数的算术，但也没有隐式转换为int。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T20:16:31.527

看看[这个问题](https://stackoverflow.com/questions/352341/multiple-integer-type-classes-in-c)的答案- BOOST_STRONG_TYPEDEF 正是我想要的。

```
// macro used to implement a strong typedef.  strong typedef
// guarentees that two types are distinguised even though the
// share the same underlying implementation.  typedef does not create
// a new type.  BOOST_STRONG_TYPEDEF(T, D) creates a new type named D
// that operates as a type T. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T20:11:25.517

一种可能性是创建一个类，将“枚举”定义为具有 ::GetValue() 方法的类的不变成员，并且您需要使用重载的数学运算来使用 GetValue() 进行有问题的数学运算。

# internet-explorer - 如何让 IE 7 打开 XHTML 文件？

> ID：513034
> 
> 赞同：3
> 
> 时间：2009-02-04T20:03:25.203
> 
> 标签：internet-explorer, xhtml

我正在构建的一个应用程序正在生成 XHTML 文档，这些文档将以多种不同的方式分发，包括电子邮件。我可以在 Firefox 或 Chrome 中打开这些文档（“打开”是指从 Windows 资源管理器，而不是通过 Web 服务器）。但是，对于 IE 7，我遇到了两个（可能是三个）不同的问题。

如果文件以扩展名“.xhtml”命名，则 IE 启动然后关闭。有时它仍在任务管理器中运行，我必须杀死它。有时不是。

如果我用扩展名“.htm”或“.html”命名它们，那么它们可以正常打开，除了 IE 信息栏出现告诉我它已经阻止了某种内容。这些文档不包含任何脚本或 iframe 或对象——它们尽可能是普通的 XHTML。他们甚至不引用外部 CSS。

当我为其开发此功能的客户在*他的*环境中打开文档时（此时他只是使用“.xhtml”扩展名），IE 会打开它们并将它们呈现为 XML 文档。

我在 Google 上花了相当多的时间来尝试了解这一点，我发现的所有内容都与在 HTTP 标头中指定 MIME 类型有关，这并不是特别有用，因为我实际上并没有提供这些文件。

所有文件（似乎）都有正确的 DOCTYPE、处理指令和命名空间声明；每个的顶部看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T00:43:10.257

所以，有趣的故事。 [IE7 实际上并不支持严格的 XHTML](http://blogs.msdn.com/ie/archive/2005/09/15/467901.aspx)。

具体来说，如果您为它提供内容类型为 的 XHTML `application/xhtml+xml`，它会“哦，那个新奇的 XHTML 东西，我对此一无所知”，并将其视为 XML 文档。另一方面，如果你为它提供内容类型为 的 XHTML `text/html`，它会说，“这个 HTML 尝起来有点滑稽，但我能忍住。”

有一个了不起的 hack -[由 W3C 建议，同样](http://www.w3.org/MarkUp/2004/xhtml-faq#ie)如此 - 使 IE 将它认为的 XML 内容呈现为 HTML。您基本上将仅 IE`xsl:stylesheet`处理指令添加到文档并引用具有 HTML 输出类型的 XSLT 身份转换。其他浏览器忽略它；IE 将它认为是 XML 文档的内容（对其自身）进行转换，然后将其呈现为 HTML。我不知道是对这种黑客行为印象深刻还是感到震惊。

但是只有当文档可以解析对转换的引用时，这种技巧才有效。打开附有这些文档的电子邮件的人不一定能够执行此操作。我想有一种方法可以将转换包含在 XML 本身中，但我已经在这方面花费了太多时间。如果它让我得到正确的答案，我会花更多的时间，但这只会让我得到不同的错误答案。

所以我要做一件愚蠢的事情，并用.htm 扩展名命名文件。注册表设置将文件扩展名映射到内容类型。所以.htm 扩展名意味着`text/html`，.xhtml 扩展名意味着`application/xhtml+xml`。IE，以及使用注册表来确定内容类型的所有其他东西，会将这些文档视为`text/html`，并且它们将呈现，并且整个事情或多或少都会起作用。但我对此并不高兴。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T20:25:49.230

> IE 打开它们并将它们呈现为 XML 文档。

这是正常的。如果您想将 XHTML 作为文件分发以在 IE 中查看，您将不得不坚持使用 .html。

我不知道您的设置出了什么问题，也许是文件关联混乱？

> 如果我用扩展名“.htm”或“.html”命名它们，那么它们可以正常打开，除了 IE 信息栏出现告诉我它已经阻止了某种内容。

好奇的。在您发现 IE 到底认为什么是活动内容之前，请尝试插入 Mark Of The Web 来安抚 IE。这需要丢失 XML 序言，但这只是使用默认值，所以包括它并没有得到任何东西。

```
<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

请注意，您必须使用 CRLF 行尾（至少在第一行）才能正常工作。啊。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T20:28:15.263

您可以尝试将它们保存为 .html 但在头部部分添加一个元行，将内容描述为 HTMl 而不是活动的内容：

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T20:12:24.033

查看 Windows 注册表部分中的`.html`条目`HKEY_CLASSES_ROOT`：然后尝试克隆它以创建相应的`.xhtml`条目。

`<`*关于如何搞乱注册表是危险的标准免责声明*`>`

# .net - 有哪些适用于 .Net 的快速报告解决方案？

> ID：513048
> 
> 赞同：3
> 
> 时间：2009-02-04T20:05:38.383
> 
> 标签：.net, reporting-services, reporting

我正在寻找与 .Net（特别是 C#）兼容的快速报告服务。此外，由于这些公司中的许多公司对其定价（例如 Cognos）都含糊其辞，因此了解它们的价格可能会有所帮助。

我们正在从 SQL Server 2005 数据库对 PDF 和 Excel 进行连续报告。特别是因为一次生成的报告数量（例如 6,000 个 20 打印页报告），我们正在寻找一种快速的解决方案。

我们将报告转储为 PDF，然后他们将报告通过 FTP 传输到外部实体以供其使用。我们生成大约 30 种不同类型的报告，但我们可能会为数据库中的每个关键项目生成数千次相同的报告。每个报告将由 5-15 个简单查询提供（只有几个连接，有时是一个分组）。我并不特别关心查询时间，而是渲染到内存流的时间（或者如果这与解决方案之间的解决方案显着不同，则序列化到磁盘）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T20:08:50.123

如果您已经拥有 sql 2005，那么报告服务是免费的。它本机支持将报告呈现为 Excel 和 PDF，并具有非常丰富的文档和示例来帮助您入门。

设计器集成到 Visual Studio 中，服务器端的管理选项甚至可以使一些非常复杂的订阅和交付场景非常容易完成。例如，数据驱动订阅为您提供了一种内置方式来驱动通过多个交付选项（电子邮件、文件共享等（您可以添加更多））交付的报告的计划创建。

当您说快速时-我认为 SSRS 适合这两种情况。不仅因为您已经在使用 SQL，因此您了解 MSFT 工具集，因此提升速度应该很快，而且性能和体系结构（仅从报告服务器轻松扩展）将足以满足您的工作需求。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T20:24:26.100

Cognos、SAP Business Objects、Oracle BI Suite、MicroStrategy 和 Reporting Services 在从各自的报表生成器呈现到 Excel 和 PDF 时的性能基本相当。如果您尝试输出太大的报告，所有这些都可能会遇到内存错误。页数并不是报告大小的良好指标。您可以有一个输出 100 万行 HTML 的 1 页报表，也可以有一个 20 页报表，每页只输出 40 行。由于内存限制，1 页的报告可能无法呈现，而 20 页的报告可能不会出现呈现问题。

Cognos 和 Business Objects 通常会花费您数十万美元的初始许可费用和年度维护支持合同费用。如果您已经在使用 SQL Server 2000 / 2005 / 2008，Reporting Services 显然不存在这个问题。如果您只运行 Oracle、MySQL 或其他非 Microsoft 数据库后端，那么仅为报告购买 SQL Server 可能会从许可的角度来看更便宜。但是，如果您的公司不具备 SQL Server 方面的专业知识，则从运营开销的角度来看，它可能会更加昂贵。我不建议使用 Reporting Services 作为非 Microsoft 数据库的前端。去过那里，做过，不值得。Reporting Services 可能适用于非 Microsoft 数据库，

您可能需要确定是否支持允许非 IT 最终用户构建报告。如果您正在为最终用户寻找一个好的解决方案，请使用 Analysis Services 构建 OLAP 多维数据集，并通过 Excel 为他们提供访问权限。无需为他们提供基于 Web 的报表生成器。如果您为最终用户提供基于 Web 的报告生成器，您只是在要求 Universe/框架/模型蔓延。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T20:08:13.307

我会看看使用 Data Dynamics Active Reporting[点击这里](http://www.datadynamics.com/Products/ProductOverview.aspx?Product=ARNET3)。您可以像 Crystal Reports 一样使用它们，并且可以将它们设置为导出为 PDF、Excel、Word 等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T20:10:23.507

您将 Reporting Services 作为标签——您是否查看过 SQL Server Reporting Services？它执行 PDF 和 Excel 报告。我无法一次说出 6000 份 20 页报告的速度（6000 份不同的报告？？）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T20:29:07.243

如果您确实需要良好的性能，您可能希望构建自己的报告服务，而不是使用预构建的。这当然会限制灵活性，但如果事先知道您的报告，那么使用第三方 excel 库向 excel 报告将非常容易。

向 pdf 报告会更困难，但使用 xsl-fo 并以这种方式构建 pdf 文档可能是一个很好的解决方案，具体取决于您的需要。

# filesystems - 在 C++ 中使用通配符和其他条件搜索子文件夹的 Windows API 方法？

> ID：513055
> 
> 赞同：0
> 
> 时间：2009-02-04T20:07:06.103
> 
> 标签：filesystems, c++builder, search, wildcard

我想我曾经看到可以在代码中使用 Windows 搜索功能的功能。可以使用 sql 查询搜索文件（例如“从文件存储中选择文件名，其中目录 = 'c:\somedir' 和 ('.doc','.txt','.me') 和 datemodified >= '2009-01-01 00:00:00'"

无论如何，即使没有办法通过查询来做到这一点，Windows API 中是否有任何功能或任何简单的代码来完成这种类型的事情？

这似乎是一件显而易见的事情，因为没有一种简单的方法可以做到这一点。

我有一个函数可以查找目录中的所有文件（带有子目录），但它基本上是愚蠢的。它无法使用通配符进行搜索，也无法使用其他条件进行搜索，例如比给定日期新的日期。

如果可能的话，我不想下载任何第 3 方共享软件库来执行此操作。我在 vista 中使用 C++ builder，如果有任何仅适用于 vista 的功能，那没关系。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T04:21:01.237

实际上，您可以使用 FindFirstFileEx() 来实现您的搜索条件。不幸的是，大多数时候你必须自己实现这个..这并不难..

基本上，您可以检查[WIN32_FIND_DATA](http://msdn.microsoft.com/en-us/library/aa365740(VS.85).aspx)结构中要搜索的条件。例如，如果您只想查找创建日期大于某个日期的文件，您将根据需要检查 WIN32_FIND_DATA 结构成员 ftCreationTime 还是 ftLastWriteTime。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T20:09:26.783

您可以使用[FindFirstFileEx()](http://msdn.microsoft.com/en-us/library/aa364419(VS.85).aspx)使用通配符和属性进行搜索。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-05T06:28:40.497

自 90 年代以来，C 代码已在 Google Groups 上发布了数千次（news://comp.os.ms-windows.programmer.win32 等）

# encryption - 哪个“好”的块加密算法输出最短？

> ID：513056
> 
> 赞同：19
> 
> 时间：2009-02-04T20:07:21.437
> 
> 标签：encryption

我想给客户一个看起来随机的订单号，但在后端使用 0, 1, 2, ...。这样，客户将获得一个带有加密订单号的不受密码保护的订单状态 URL，并且他们无法通过加或减 1 来查看其他客户的订单号。这可能会取代生成随机订单密钥、检查唯一性的方案在所有先前的订单中，并重新生成直到唯一。当 Web 服务器收到查看订单的请求时，它会解密订单号并检索订单。

为了保持 URL 简短，什么“好的”加密算法具有最短的块大小？这个方案是个好主意吗？（如果我对 Apple, Inc. 的员工 ID 进行加密以防止史蒂夫·乔布斯要求 Employee #0 怎么办？）

请注意，所有包裹跟踪网站都允许您无需身份验证即可跟踪包裹。可以限制无密码订单状态页面上显示的信息量。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-04T20:15:19.673

出于安全原因，大多数块密码将使用大于 32 位大小的块。

但是，我找到了一个专门为您正在做的事情：[Skip32](http://search.cpan.org/~esh/Crypt-Skip32/lib/Crypt/Skip32.pm)

您可能会考虑使用 GUID，但也许您有理由要避免这种情况。（比如说，你的应用程序已经完成了。）

*编辑：* 实际上，如果允许使用 GUID，那么这将为您提供 128 位的范围。您可以轻松使用任何其他分组密码。拥有更大空间的好处（以长 ID 字符串为代价）是您将获得更多保护，防止人们猜测 ID。（并不是说它本身就是一个订单 ID 应该是一个安全令牌......）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T21:00:22.453

如果您的想法是只知道订单号（或 URL）就足以获取订单信息，那么：

*   订单号空间需要非常大，否则攻击者和/或客户可能会搜索订单空间，以查看可以看到的内容。
*   您应该考虑到攻击者可能会从多台机器开始逐步探测，并且可能会耐心等待。
*   可以通过速率限制来减轻对订单号空间的探测，但这很难在 Web 环境中应用——很难将您的客户访问与攻击者访问区分开来。
*   还要考虑到订单号并不是什么秘密，人们可能会通过电子邮件发送；一旦出来，就不可能收回。

因此，为了方便一键查看我的订单而无需登录，您已经产生了永久的安全风险。

即使您使订单号空间变得很大，您仍然会遇到这些 URL 漂浮在外面的问题，可能是那些不应该得到它们的人拥有。

要求登录会话以查看任何内容会好得多，然后只向他们显示他们有权查看的订单。然后您不必担心隐藏订单号或攻击者猜测订单号，因为仅订单号不足以获取任何信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-04-05T21:28:17.137

最近我开始使用[Hashids](http://hashids.org/)的一组小型库。这个想法是将数字或数字列表加密为散列字符串，例如：

```
12345 => "NkK9"
[683, 94108, 123, 5] => "aBMswoO2UB3Sj" 
```

这些库由各种作者以流行的编程语言实现。它们也是交叉兼容的，这意味着您可以在 Python 中对数字进行编码，然后在 JavaScript 中对其进行解码。它支持盐、字母定义，甚至排除坏词。

Python：

```
hashids = Hashids(salt="this is my salt")
id = hashids.encode(683, 94108, 123, 5) 
```

JS：

```
var hashids = new Hashids("this is my salt"),
numbers = hashids.decode("aBMswoO2UB3Sj"); 
```

这不是政府证明加密，但对于一些不可预测的永久链接共享站点来说完全足够了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T21:14:09.680

我使用 Blowfish 制作了这个想法的原型，这是一种 64 位块的分组密码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-03-15T11:24:33.330

关于你是否真的应该这样做的问题，这里有一个非常简单的带有固定密钥的分组密码（因为你似乎只需要一个排列）。

```
static uint permute(uint id)
{
  uint R = id & 0xFFFF, L = (id>>16) ^ (((((R>>5)^(R<<2)) + ((R>>3)^(R<<4))) ^ ((R^0x79b9) + R)) & 0xFFFF);
  R ^= ((((L>>5)^(L<<2)) + ((L>>3)^(L<<4))) ^ ((L^0xf372) + L)) & 0xFFFF;
  return ((L ^ ((((R>>5)^(R<<2)) + ((R>>3)^(R<<4))) ^ ((R^0x6d2b) + R))) << 16) | R;
} 
```

就 32 位分组密码而言，Skip32 要好得多，但是当三行（长）行可以做到时，它就有点重量级了。:-)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T20:09:25.207

guid 是实现这一目标的方法

*** 编辑 ***

你可能想看看这个 [http://csharpfeeds.com/post/4382/A_shorter_and_URL_friendly_GUID.aspx](http://csharpfeeds.com/post/4382/A_shorter_and_URL_friendly_GUID.aspx)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T20:14:05.213

我不认为这个计划是个好主意。为什么不验证用户是否已登录并有权查看指定订单？

如果您真的想在没有任何身份验证的情况下将所有订单都放在那里，那么最好使用 GUID。

或者，您可以尝试提供以客户信息为前缀的订单号。喜欢（电话号码）（1...100）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T20:15:13.183

为了满足要求，您可以简单地在索引上使用诸如[SHA-1](http://en.wikipedia.org/wiki/SHA_hash_functions)或[MD5之类的哈希。](http://en.wikipedia.org/wiki/MD5)这些将提供您所需的足够安全性。

要减小大小，您可以更改为不同的编码；比如64位。

我也~~强烈建议~~ **坚持**使用盐，否则哈希值很容易被破坏。

# sql - 当总和达到某个阈值时如何返回记录

> ID：513065
> 
> 赞同：3
> 
> 时间：2009-02-04T20:08:32.777
> 
> 标签：sql

我正在使用 SQL，并且我有一个包含三个列的表：帐户、事务日期、点数。每个帐户将有多个 transaction_dates 和每次交易赚取的积分。

当每个帐户达到某个阈值（即累积 100 点）时，我如何返回 transaction_date。假设第一个账户有 2000 笔交易，前五个账户各有 21 点。我希望查询返回事务#5，因为那是帐户达到 100 的时候。

有人可以帮忙吗？谢谢！猫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T20:25:32.913

```
select min(a.transaction_date), a.account from

(select sum(t1.points) as thesum, t2.transaction_date, t2.account 
from table t1
inner join table t2 on t1.account = t2.account and t1.transaction_date <= t2.transaction_date
group by t2.transaction_date, t2.account
having thesum >= 100) a 

group by a.account 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T20:32:53.647

使用三角连接：

在 T-SQL 中：

```
SELECT account, MIN(dt), MIN(points) 
FROM 
(
    SELECT t1.account, t1.date, sum(t2.points) AS points
    FROM table t1
      INNER JOIN table t2 ON t1.account = t2.account AND t1.dt >= t2.dt
    GROUP BY t1.account, t1.date
    HAVING SUM(t2.points) > 100
) iq
GROUP BY account 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T20:20:09.587

这应该让你得到你所追求的。

`SELECT account_id, MIN(transaction_date) FROM table t1 WHERE (SELECT SUM(points) FROM table t2 WHERE t2.transaction_date < t1.transaction_date) <= 100 GROUP BY account_id`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T20:24:29.187

您可以在存储过程中使用游标来执行此操作。然后，您可以逐步浏览该帐户的记录并累积积分。一旦您通过阈值，您就会返回当前记录。

但是，如果您有一个大型数据集，这可能会很慢，因此如果您在运行查询之前知道您所追求的阈值，您可以添加一个额外的表，在其中标记您跨越阈值的记录。更新这个额外的表可以在事务表的触发器中完成。

# android - 发布带有数据库的应用程序

> ID：513084
> 
> 赞同：989
> 
> 时间：2009-02-04T20:11:52.363
> 
> 标签：android, android-sqlite, android-database

如果您的应用程序需要一个数据库并且它带有内置数据，那么发布该应用程序的最佳方式是什么？我是不是该：

1.  预先创建 SQLite 数据库并将其包含在`.apk`?

2.  在应用程序中包含 SQL 命令并让它创建数据库并在首次使用时插入数据？

我看到的缺点是：

1.  可能的 SQLite 版本不匹配可能会导致问题，我目前不知道数据库应该去哪里以及如何访问它。

2.  在设备上创建和填充数据库可能需要很长时间。

有什么建议么？指向有关任何问题的文档的指针将不胜感激。

* * *

## 回答 #1

> 赞同：212
> 
> 时间：2011-01-26T21:22:02.230

**创建和更新数据库有两种选择。**

一种是在外部创建一个数据库，然后将其放在项目的 assets 文件夹中，然后从那里复制整个数据库。如果数据库有很多表和其他组件，这会更快。 ***通过更改 res/values/strings.xml 文件中的数据库版本号来触发升级。***然后通过在外部创建一个新数据库、用新数据库替换 assets 文件夹中的旧数据库、以另一个名称将旧数据库保存在内部存储中、将新数据库从 assets 文件夹复制到内部存储、转移所有将旧数据库（之前已重命名）中的数据转移到新数据库中，最后删除旧数据库。您最初可以使用**SQLite Manager FireFox 插件**来执行你创建的 sql 语句。

另一种选择是从 sql 文件内部创建数据库。这不是那么快，但如果数据库只有几个表，用户可能不会注意到延迟。***通过更改 res/values/strings.xml 文件中的数据库版本号来触发升级。*** 然后将通过处理升级 sql 文件来完成升级。数据库中的数据将保持不变，除非删除其容器，例如删除表。

**下面的示例演示了如何使用这两种方法。**

这是一个示例 create_database.sql 文件。内部方法要放在项目的assets文件夹中，或者复制到SQLite Manager的“Execute SQL”中，为外部方法创建数据库。 ***（注意：注意Android所需表的注释。）***

```
--Android requires a table named 'android_metadata' with a 'locale' column
CREATE TABLE "android_metadata" ("locale" TEXT DEFAULT 'en_US');
INSERT INTO "android_metadata" VALUES ('en_US');

CREATE TABLE "kitchen_table";
CREATE TABLE "coffee_table";
CREATE TABLE "pool_table";
CREATE TABLE "dining_room_table";
CREATE TABLE "card_table"; 
```

这是一个示例 update_database.sql 文件。内部方法要放在项目的assets文件夹中，或者复制到SQLite Manager的“Execute SQL”中，为外部方法创建数据库。 ***（注意：注意所有三种SQL注释都将被忽略通过本示例中包含的 sql 解析器。）***

```
--CREATE TABLE "kitchen_table";  This is one type of comment in sql.  It is ignored by parseSql.
/*
 * CREATE TABLE "coffee_table"; This is a second type of comment in sql.  It is ignored by parseSql.
 */
{
CREATE TABLE "pool_table";  This is a third type of comment in sql.  It is ignored by parseSql.
}
/* CREATE TABLE "dining_room_table"; This is a second type of comment in sql.  It is ignored by parseSql. */
{ CREATE TABLE "card_table"; This is a third type of comment in sql.  It is ignored by parseSql. }

--DROP TABLE "picnic_table"; Uncomment this if picnic table was previously created and now is being replaced.
CREATE TABLE "picnic_table" ("plates" TEXT);
INSERT INTO "picnic_table" VALUES ('paper'); 
```

这是添加到 /res/values/strings.xml 文件中的数据库版本号的条目。

```
<item type="string" name="databaseVersion" format="integer">1</item> 
```

这是一个访问数据库然后使用它的活动。（***注意：如果使用大量资源，您可能希望在单独的线程中运行数据库代码。***）

```
package android.example;

import android.app.Activity;
import android.database.sqlite.SQLiteDatabase;
import android.os.Bundle;

/**
 * @author Danny Remington - MacroSolve
 * 
 *         Activity for demonstrating how to use a sqlite database.
 */
public class Database extends Activity {
     /** Called when the activity is first created. */
     @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        DatabaseHelper myDbHelper;
        SQLiteDatabase myDb = null;

        myDbHelper = new DatabaseHelper(this);
        /*
         * Database must be initialized before it can be used. This will ensure
         * that the database exists and is the current version.
         */
         myDbHelper.initializeDataBase();

         try {
            // A reference to the database can be obtained after initialization.
            myDb = myDbHelper.getWritableDatabase();
            /*
             * Place code to use database here.
             */
         } catch (Exception ex) {
            ex.printStackTrace();
         } finally {
            try {
                myDbHelper.close();
            } catch (Exception ex) {
                ex.printStackTrace();
            } finally {
                myDb.close();
            }
        }

    }
} 
```

这是数据库帮助程序类，如果需要，可以在其中创建或更新数据库。 ***（注意：Android 要求您创建一个扩展 SQLiteOpenHelper 的类才能使用 Sqlite 数据库。）***

```
package android.example;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;

import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

/**
 * @author Danny Remington - MacroSolve
 * 
 *         Helper class for sqlite database.
 */
public class DatabaseHelper extends SQLiteOpenHelper {

    /*
     * The Android's default system path of the application database in internal
     * storage. The package of the application is part of the path of the
     * directory.
     */
    private static String DB_DIR = "/data/data/android.example/databases/";
    private static String DB_NAME = "database.sqlite";
    private static String DB_PATH = DB_DIR + DB_NAME;
    private static String OLD_DB_PATH = DB_DIR + "old_" + DB_NAME;

    private final Context myContext;

    private boolean createDatabase = false;
    private boolean upgradeDatabase = false;

    /**
     * Constructor Takes and keeps a reference of the passed context in order to
     * access to the application assets and resources.
     * 
     * @param context
     */
    public DatabaseHelper(Context context) {
        super(context, DB_NAME, null, context.getResources().getInteger(
                R.string.databaseVersion));
        myContext = context;
        // Get the path of the database that is based on the context.
        DB_PATH = myContext.getDatabasePath(DB_NAME).getAbsolutePath();
    }

    /**
     * Upgrade the database in internal storage if it exists but is not current. 
     * Create a new empty database in internal storage if it does not exist.
     */
    public void initializeDataBase() {
        /*
         * Creates or updates the database in internal storage if it is needed
         * before opening the database. In all cases opening the database copies
         * the database in internal storage to the cache.
         */
        getWritableDatabase();

        if (createDatabase) {
            /*
             * If the database is created by the copy method, then the creation
             * code needs to go here. This method consists of copying the new
             * database from assets into internal storage and then caching it.
             */
            try {
                /*
                 * Write over the empty data that was created in internal
                 * storage with the one in assets and then cache it.
                 */
                copyDataBase();
            } catch (IOException e) {
                throw new Error("Error copying database");
            }
        } else if (upgradeDatabase) {
            /*
             * If the database is upgraded by the copy and reload method, then
             * the upgrade code needs to go here. This method consists of
             * renaming the old database in internal storage, create an empty
             * new database in internal storage, copying the database from
             * assets to the new database in internal storage, caching the new
             * database from internal storage, loading the data from the old
             * database into the new database in the cache and then deleting the
             * old database from internal storage.
             */
            try {
                FileHelper.copyFile(DB_PATH, OLD_DB_PATH);
                copyDataBase();
                SQLiteDatabase old_db = SQLiteDatabase.openDatabase(OLD_DB_PATH, null, SQLiteDatabase.OPEN_READWRITE);
                SQLiteDatabase new_db = SQLiteDatabase.openDatabase(DB_PATH,null, SQLiteDatabase.OPEN_READWRITE);
                /*
                 * Add code to load data into the new database from the old
                 * database and then delete the old database from internal
                 * storage after all data has been transferred.
                 */
            } catch (IOException e) {
                throw new Error("Error copying database");
            }
        }

    }

    /**
     * Copies your database from your local assets-folder to the just created
     * empty database in the system folder, from where it can be accessed and
     * handled. This is done by transfering bytestream.
     * */
    private void copyDataBase() throws IOException {
        /*
         * Close SQLiteOpenHelper so it will commit the created empty database
         * to internal storage.
         */
        close();

        /*
         * Open the database in the assets folder as the input stream.
         */
        InputStream myInput = myContext.getAssets().open(DB_NAME);

        /*
         * Open the empty db in interal storage as the output stream.
         */
        OutputStream myOutput = new FileOutputStream(DB_PATH);

        /*
         * Copy over the empty db in internal storage with the database in the
         * assets folder.
         */
        FileHelper.copyFile(myInput, myOutput);

        /*
         * Access the copied database so SQLiteHelper will cache it and mark it
         * as created.
         */
        getWritableDatabase().close();
    }

    /*
     * This is where the creation of tables and the initial population of the
     * tables should happen, if a database is being created from scratch instead
     * of being copied from the application package assets. Copying a database
     * from the application package assets to internal storage inside this
     * method will result in a corrupted database.
     * <P>
     * NOTE: This method is normally only called when a database has not already
     * been created. When the database has been copied, then this method is
     * called the first time a reference to the database is retrieved after the
     * database is copied since the database last cached by SQLiteOpenHelper is
     * different than the database in internal storage.
     */
    @Override
    public void onCreate(SQLiteDatabase db) {
        /*
         * Signal that a new database needs to be copied. The copy process must
         * be performed after the database in the cache has been closed causing
         * it to be committed to internal storage. Otherwise the database in
         * internal storage will not have the same creation timestamp as the one
         * in the cache causing the database in internal storage to be marked as
         * corrupted.
         */
        createDatabase = true;

        /*
         * This will create by reading a sql file and executing the commands in
         * it.
         */
            // try {
            // InputStream is = myContext.getResources().getAssets().open(
            // "create_database.sql");
            //
            // String[] statements = FileHelper.parseSqlFile(is);
            //
            // for (String statement : statements) {
            // db.execSQL(statement);
            // }
            // } catch (Exception ex) {
            // ex.printStackTrace();
            // }
    }

    /**
     * Called only if version number was changed and the database has already
     * been created. Copying a database from the application package assets to
     * the internal data system inside this method will result in a corrupted
     * database in the internal data system.
     */
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        /*
         * Signal that the database needs to be upgraded for the copy method of
         * creation. The copy process must be performed after the database has
         * been opened or the database will be corrupted.
         */
        upgradeDatabase = true;

        /*
         * Code to update the database via execution of sql statements goes
         * here.
         */

        /*
         * This will upgrade by reading a sql file and executing the commands in
         * it.
         */
        // try {
        // InputStream is = myContext.getResources().getAssets().open(
        // "upgrade_database.sql");
        //
        // String[] statements = FileHelper.parseSqlFile(is);
        //
        // for (String statement : statements) {
        // db.execSQL(statement);
        // }
        // } catch (Exception ex) {
        // ex.printStackTrace();
        // }
    }

    /**
     * Called everytime the database is opened by getReadableDatabase or
     * getWritableDatabase. This is called after onCreate or onUpgrade is
     * called.
     */
    @Override
    public void onOpen(SQLiteDatabase db) {
        super.onOpen(db);
    }

    /*
     * Add your public helper methods to access and get content from the
     * database. You could return cursors by doing
     * "return myDataBase.query(....)" so it'd be easy to you to create adapters
     * for your views.
     */

} 
```

这是 FileHelper 类，其中包含字节流复制文件和解析 sql 文件的方法。

```
package android.example;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.FileReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.Reader;
import java.nio.channels.FileChannel;

/**
 * @author Danny Remington - MacroSolve
 * 
 *         Helper class for common tasks using files.
 * 
 */
public class FileHelper {
    /**
     * Creates the specified <i><b>toFile</b></i> that is a byte for byte a copy
     * of <i><b>fromFile</b></i>. If <i><b>toFile</b></i> already existed, then
     * it will be replaced with a copy of <i><b>fromFile</b></i>. The name and
     * path of <i><b>toFile</b></i> will be that of <i><b>toFile</b></i>. Both
     * <i><b>fromFile</b></i> and <i><b>toFile</b></i> will be closed by this
     * operation.
     * 
     * @param fromFile
     *            - InputStream for the file to copy from.
     * @param toFile
     *            - InputStream for the file to copy to.
     */
    public static void copyFile(InputStream fromFile, OutputStream toFile) throws IOException {
        // transfer bytes from the inputfile to the outputfile
        byte[] buffer = new byte[1024];
        int length;

        try {
            while ((length = fromFile.read(buffer)) > 0) {
                toFile.write(buffer, 0, length);
            }
        }
        // Close the streams
        finally {
            try {
                if (toFile != null) {
                    try {
                        toFile.flush();
                    } finally {
                        toFile.close();
                    }
            }
            } finally {
                if (fromFile != null) {
                    fromFile.close();
                }
            }
        }
    }

    /**
     * Creates the specified <i><b>toFile</b></i> that is a byte for byte a copy
     * of <i><b>fromFile</b></i>. If <i><b>toFile</b></i> already existed, then
     * it will be replaced with a copy of <i><b>fromFile</b></i>. The name and
     * path of <i><b>toFile</b></i> will be that of <i><b>toFile</b></i>. Both
     * <i><b>fromFile</b></i> and <i><b>toFile</b></i> will be closed by this
     * operation.
     * 
     * @param fromFile
     *            - String specifying the path of the file to copy from.
     * @param toFile
     *            - String specifying the path of the file to copy to.
     */
    public static void copyFile(String fromFile, String toFile) throws IOException {
        copyFile(new FileInputStream(fromFile), new FileOutputStream(toFile));
    }

    /**
     * Creates the specified <i><b>toFile</b></i> that is a byte for byte a copy
     * of <i><b>fromFile</b></i>. If <i><b>toFile</b></i> already existed, then
     * it will be replaced with a copy of <i><b>fromFile</b></i>. The name and
     * path of <i><b>toFile</b></i> will be that of <i><b>toFile</b></i>. Both
     * <i><b>fromFile</b></i> and <i><b>toFile</b></i> will be closed by this
     * operation.
     * 
     * @param fromFile
     *            - File for the file to copy from.
     * @param toFile
     *            - File for the file to copy to.
     */
    public static void copyFile(File fromFile, File toFile) throws IOException {
        copyFile(new FileInputStream(fromFile), new FileOutputStream(toFile));
    }

    /**
     * Creates the specified <i><b>toFile</b></i> that is a byte for byte a copy
     * of <i><b>fromFile</b></i>. If <i><b>toFile</b></i> already existed, then
     * it will be replaced with a copy of <i><b>fromFile</b></i>. The name and
     * path of <i><b>toFile</b></i> will be that of <i><b>toFile</b></i>. Both
     * <i><b>fromFile</b></i> and <i><b>toFile</b></i> will be closed by this
     * operation.
     * 
     * @param fromFile
     *            - FileInputStream for the file to copy from.
     * @param toFile
     *            - FileInputStream for the file to copy to.
     */
    public static void copyFile(FileInputStream fromFile, FileOutputStream toFile) throws IOException {
        FileChannel fromChannel = fromFile.getChannel();
        FileChannel toChannel = toFile.getChannel();

        try {
            fromChannel.transferTo(0, fromChannel.size(), toChannel);
        } finally {
            try {
                if (fromChannel != null) {
                    fromChannel.close();
                }
            } finally {
                if (toChannel != null) {
                    toChannel.close();
                }
            }
        }
    }

    /**
     * Parses a file containing sql statements into a String array that contains
     * only the sql statements. Comments and white spaces in the file are not
     * parsed into the String array. Note the file must not contained malformed
     * comments and all sql statements must end with a semi-colon ";" in order
     * for the file to be parsed correctly. The sql statements in the String
     * array will not end with a semi-colon ";".
     * 
     * @param sqlFile
     *            - String containing the path for the file that contains sql
     *            statements.
     * 
     * @return String array containing the sql statements.
     */
    public static String[] parseSqlFile(String sqlFile) throws IOException {
        return parseSqlFile(new BufferedReader(new FileReader(sqlFile)));
    }

    /**
     * Parses a file containing sql statements into a String array that contains
     * only the sql statements. Comments and white spaces in the file are not
     * parsed into the String array. Note the file must not contained malformed
     * comments and all sql statements must end with a semi-colon ";" in order
     * for the file to be parsed correctly. The sql statements in the String
     * array will not end with a semi-colon ";".
     * 
     * @param sqlFile
     *            - InputStream for the file that contains sql statements.
     * 
     * @return String array containing the sql statements.
     */
    public static String[] parseSqlFile(InputStream sqlFile) throws IOException {
        return parseSqlFile(new BufferedReader(new InputStreamReader(sqlFile)));
    }

    /**
     * Parses a file containing sql statements into a String array that contains
     * only the sql statements. Comments and white spaces in the file are not
     * parsed into the String array. Note the file must not contained malformed
     * comments and all sql statements must end with a semi-colon ";" in order
     * for the file to be parsed correctly. The sql statements in the String
     * array will not end with a semi-colon ";".
     * 
     * @param sqlFile
     *            - Reader for the file that contains sql statements.
     * 
     * @return String array containing the sql statements.
     */
    public static String[] parseSqlFile(Reader sqlFile) throws IOException {
        return parseSqlFile(new BufferedReader(sqlFile));
    }

    /**
     * Parses a file containing sql statements into a String array that contains
     * only the sql statements. Comments and white spaces in the file are not
     * parsed into the String array. Note the file must not contained malformed
     * comments and all sql statements must end with a semi-colon ";" in order
     * for the file to be parsed correctly. The sql statements in the String
     * array will not end with a semi-colon ";".
     * 
     * @param sqlFile
     *            - BufferedReader for the file that contains sql statements.
     * 
     * @return String array containing the sql statements.
     */
    public static String[] parseSqlFile(BufferedReader sqlFile) throws IOException {
        String line;
        StringBuilder sql = new StringBuilder();
        String multiLineComment = null;

        while ((line = sqlFile.readLine()) != null) {
            line = line.trim();

            // Check for start of multi-line comment
            if (multiLineComment == null) {
                // Check for first multi-line comment type
                if (line.startsWith("/*")) {
                    if (!line.endsWith("}")) {
                        multiLineComment = "/*";
                    }
                // Check for second multi-line comment type
                } else if (line.startsWith("{")) {
                    if (!line.endsWith("}")) {
                        multiLineComment = "{";
                }
                // Append line if line is not empty or a single line comment
                } else if (!line.startsWith("--") && !line.equals("")) {
                    sql.append(line);
                } // Check for matching end comment
            } else if (multiLineComment.equals("/*")) {
                if (line.endsWith("*/")) {
                    multiLineComment = null;
                }
            // Check for matching end comment
            } else if (multiLineComment.equals("{")) {
                if (line.endsWith("}")) {
                    multiLineComment = null;
                }
            }

        }

        sqlFile.close();

        return sql.toString().split(";");
    }

} 
```

* * *

## 回答 #2

> 赞同：131
> 
> 时间：2012-08-03T21:08:03.337

该`SQLiteAssetHelper`库使这项任务变得非常简单。

它很容易添加为 gradle 依赖项（但 Ant/Eclipse 也可以使用 Jar），并且可以在以下位置找到它的文档：
[https ://github.com/jgilfelt/android-sqlite-asset-helper](https://github.com/jgilfelt/android-sqlite-asset-helper)

**注意：**该项目不再如上述 Github 链接所述维护。

如文档中所述：

1.  将依赖项添加到模块的 gradle 构建文件中：

    ```
    dependencies {
        compile 'com.readystatesoftware.sqliteasset:sqliteassethelper:+'
    } 
    ```

2.  将数据库复制到 assets 目录中，位于名为`assets/databases`. 例如：
    `assets/databases/my_database.db`

    （或者，您可以将数据库压缩为 zip 文件，例如`assets/databases/my_database.zip`。这不是必需的，因为 APK 已经作为一个整体进行了压缩。）

3.  创建一个类，例如：

    ```
    public class MyDatabase extends SQLiteAssetHelper {

        private static final String DATABASE_NAME = "my_database.db";
        private static final int DATABASE_VERSION = 1;

        public MyDatabase(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }
    } 
    ```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2017-11-07T20:23:00.557

# 在 Android Studio 3.0 中发送带有数据库文件的应用程序

将应用程序与数据库文件一起发送对我来说是个好主意。优点是您不需要进行复杂的初始化，如果您的数据集很大，这有时会花费大量时间。

**第一步：准备数据库文件**

准备好数据库文件。它可以是 .db 文件或 .sqlite 文件。如果您使用 .sqlite 文件，您需要做的就是更改文件扩展名。步骤是一样的。

在本例中，我准备了一个名为 testDB.db 的文件。它有一个表和一些示例数据，如下所示 [![在此处输入图像描述](https://i.stack.imgur.com/gjCcm.png)](https://i.stack.imgur.com/gjCcm.png)

**第 2 步：将文件导入您的项目**

如果您没有资产文件夹，请创建资产文件夹。然后将数据库文件复制并粘贴到此文件夹中

[![在此处输入图像描述](https://i.stack.imgur.com/WX3cB.gif)](https://i.stack.imgur.com/WX3cB.gif)

**第 3 步：将文件复制到应用程序的数据文件夹**

您需要将数据库文件复制到应用程序的数据文件夹中，以便与它进行进一步的交互。这是复制数据库文件的一次性操作（初始化）。如果多次调用此代码，data 文件夹中的数据库文件将被 assets 文件夹中的数据库文件覆盖。当您希望将来在应用程序更新期间更新数据库时，此覆盖过程很有用。

请注意，在应用程序更新期间，此数据库文件不会在应用程序的数据文件夹中更改。只有卸载才会删除它。

需要将数据库文件复制到`/databases`文件夹中。打开设备文件资源管理器。输入`data/data/<YourAppName>/`位置。这是上面提到的应用程序的默认数据文件夹。默认情况下，数据库文件将放置在该目录下的另一个名为 databases 的文件夹中

[![在此处输入图像描述](https://i.stack.imgur.com/IUIeI.gif)](https://i.stack.imgur.com/IUIeI.gif)

现在，复制文件的过程很像 Java 正在做的事情。使用以下代码进行复制粘贴。这是启动代码。它还可以用于将来更新（通过覆盖）数据库文件。

```
//get context by calling "this" in activity or getActivity() in fragment
//call this if API level is lower than 17  String appDataPath = "/data/data/" + context.getPackageName() + "/databases/"
String appDataPath = context.getApplicationInfo().dataDir;

File dbFolder = new File(appDataPath + "/databases");//Make sure the /databases folder exists
dbFolder.mkdir();//This can be called multiple times.

File dbFilePath = new File(appDataPath + "/databases/testDB.db");

try {
    InputStream inputStream = context.getAssets().open("testDB.db");
    OutputStream outputStream = new FileOutputStream(dbFilePath);
    byte[] buffer = new byte[1024];
    int length;
    while ((length = inputStream.read(buffer))>0)
    {
        outputStream.write(buffer, 0, length);
    }
    outputStream.flush();
    outputStream.close();
    inputStream.close();
} catch (IOException e){
    //handle
} 
```

然后刷新文件夹以验证复制过程

[![在此处输入图像描述](https://i.stack.imgur.com/Xxyr9.gif)](https://i.stack.imgur.com/Xxyr9.gif)

**第四步：创建数据库打开助手**

`SQLiteOpenHelper`为, 使用 connect、close、path 等创建一个子类。我将其命名为`DatabaseOpenHelper`

```
import android.content.Context;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

public class DatabaseOpenHelper extends SQLiteOpenHelper {
    public static final String DB_NAME = "testDB.db";
    public static final String DB_SUB_PATH = "/databases/" + DB_NAME;
    private static String APP_DATA_PATH = "";
    private SQLiteDatabase dataBase;
    private final Context context;

    public DatabaseOpenHelper(Context context){
        super(context, DB_NAME, null, 1);
        APP_DATA_PATH = context.getApplicationInfo().dataDir;
        this.context = context;
    }

    public boolean openDataBase() throws SQLException{
        String mPath = APP_DATA_PATH + DB_SUB_PATH;
        //Note that this method assumes that the db file is already copied in place
        dataBase = SQLiteDatabase.openDatabase(mPath, null, SQLiteDatabase.OPEN_READWRITE);
        return dataBase != null;
    }

    @Override
    public synchronized void close(){
        if(dataBase != null) {dataBase.close();}
        super.close();
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    }
} 
```

**第 5 步：创建顶级类以与数据库交互**

这将是读取和写入数据库文件的类。还有一个示例查询可以打印出数据库中的值。

```
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.util.Log;

public class Database {
    private final Context context;
    private SQLiteDatabase database;
    private DatabaseOpenHelper dbHelper;

    public Database(Context context){
        this.context = context;
        dbHelper = new DatabaseOpenHelper(context);
    }

    public Database open() throws SQLException
    {
        dbHelper.openDataBase();
        dbHelper.close();
        database = dbHelper.getReadableDatabase();
        return this;
    }

    public void close()
    {
        dbHelper.close();
    }

    public void test(){
        try{
            String query ="SELECT value FROM test1";
            Cursor cursor = database.rawQuery(query, null);
            if (cursor.moveToFirst()){
                do{
                    String value = cursor.getString(0);
                    Log.d("db", value);
                }while (cursor.moveToNext());
            }
            cursor.close();
        } catch (SQLException e) {
            //handle
        }
    }
} 
```

**第 6 步：测试运行**

通过运行以下代码行来测试代码。

```
Database db = new Database(context);
db.open();
db.test();
db.close(); 
```

点击运行按钮并欢呼！

[![在此处输入图像描述](https://i.stack.imgur.com/SmR4h.gif)](https://i.stack.imgur.com/SmR4h.gif)

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-03-26T14:56:20.943

我的解决方案既不使用任何第三方库，也不强迫您在`SQLiteOpenHelper`子类上调用自定义方法来在创建时初始化数据库。它还负责数据库升级。所有需要做的就是继承`SQLiteOpenHelper`.

## 先决条件：

1.  您希望随应用程序一起提供的数据库。**它应该包含**一个 1x1 表，该表的名称除了您的应用程序独有的表之外，还包含一个具有该值`android_metadata`的属性。`locale``en_US`

## 子类化`SQLiteOpenHelper`：

1.  子类`SQLiteOpenHelper`。
2.  在子类中创建一个`private`方法`SQLiteOpenHelper`。此方法包含将数据库内容从“assets”文件夹中的数据库文件复制到应用程序包上下文中创建的数据库的逻辑。
3.  覆盖`onCreate`和`onUpgrade` **的** `onOpen`方法`SQLiteOpenHelper`。

说够了。这是`SQLiteOpenHelper`子类：

```
public class PlanDetailsSQLiteOpenHelper extends SQLiteOpenHelper {
    private static final String TAG = "SQLiteOpenHelper";

    private final Context context;
    private static final int DATABASE_VERSION = 1;
    private static final String DATABASE_NAME = "my_custom_db";

    private boolean createDb = false, upgradeDb = false;

    public PlanDetailsSQLiteOpenHelper(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
        this.context = context;
    }

    /**
     * Copy packaged database from assets folder to the database created in the
     * application package context.
     * 
     * @param db
     *            The target database in the application package context.
     */
    private void copyDatabaseFromAssets(SQLiteDatabase db) {
        Log.i(TAG, "copyDatabase");
        InputStream myInput = null;
        OutputStream myOutput = null;
        try {
            // Open db packaged as asset as the input stream
            myInput = context.getAssets().open("path/to/shipped/db/file");

            // Open the db in the application package context:
            myOutput = new FileOutputStream(db.getPath());

            // Transfer db file contents:
            byte[] buffer = new byte[1024];
            int length;
            while ((length = myInput.read(buffer)) > 0) {
                myOutput.write(buffer, 0, length);
            }
            myOutput.flush();

            // Set the version of the copied database to the current
            // version:
            SQLiteDatabase copiedDb = context.openOrCreateDatabase(
                DATABASE_NAME, 0, null);
            copiedDb.execSQL("PRAGMA user_version = " + DATABASE_VERSION);
            copiedDb.close();

        } catch (IOException e) {
            e.printStackTrace();
            throw new Error(TAG + " Error copying database");
        } finally {
            // Close the streams
            try {
                if (myOutput != null) {
                    myOutput.close();
                }
                if (myInput != null) {
                    myInput.close();
                }
            } catch (IOException e) {
                e.printStackTrace();
                throw new Error(TAG + " Error closing streams");
            }
        }
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        Log.i(TAG, "onCreate db");
        createDb = true;
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.i(TAG, "onUpgrade db");
        upgradeDb = true;
    }

    @Override
    public void onOpen(SQLiteDatabase db) {
        Log.i(TAG, "onOpen db");
        if (createDb) {// The db in the application package
            // context is being created.
            // So copy the contents from the db
            // file packaged in the assets
            // folder:
            createDb = false;
            copyDatabaseFromAssets(db);

        }
        if (upgradeDb) {// The db in the application package
            // context is being upgraded from a lower to a higher version.
            upgradeDb = false;
            // Your db upgrade logic here:
        }
    }
} 
```

最后，要获得数据库连接，只需在子类上调用`getReadableDatabase()`or ，如果数据库不存在，它将负责创建数据库，从“assets”文件夹中的指定文件复制数据库内容。`getWritableDatabase()``SQLiteOpenHelper`

简而言之，您可以使用`SQLiteOpenHelper`子类访问 assets 文件夹中提供的数据库，就像使用`onCreate()`方法中使用 SQL 查询初始化的数据库一样。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2017-11-28T17:21:34.497

2017 年 11 月，Google 发布了[Room Persistence Library](https://developer.android.com/topic/libraries/architecture/room.html)。

从文档中：

> Room 持久性库在 SQLite 之上提供了一个抽象层，以允许流畅的数据库访问，同时利用 **SQLite**的全部功能。
> 
> 该库可帮助您在运行您的应用的设备上创建应用数据的缓存。此缓存用作您的应用程序的单一事实来源，无论用户是否有互联网连接，用户都可以在您的应用程序中查看一致的关键信息副本。

Room 数据库在首次创建或打开数据库时有一个回调。您可以使用 create 回调来填充数据库。

```
Room.databaseBuilder(context.applicationContext,
        DataDatabase::class.java, "Sample.db")
        // prepopulate the database after onCreate was called
        .addCallback(object : Callback() {
            override fun onCreate(db: SupportSQLiteDatabase) {
                super.onCreate(db)
                // moving to a new thread
                ioThread {
                    getInstance(context).dataDao()
                                        .insert(PREPOPULATE_DATA)
                }
            }
        })
        .build() 
```

此[博客文章](https://medium.com/google-developers/7-pro-tips-for-room-fbadea4bfbd1)中的代码。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2009-02-04T23:32:28.170

目前没有办法预先创建一个 SQLite 数据库来与你的 apk 一起提供。您可以做的最好的事情是将适当的 SQL 保存为资源并从您的应用程序中运行它们。是的，这会导致数据重复（相同的信息作为资源和数据库存在），但目前没有其他方法。唯一的缓解因素是 apk 文件被压缩。我的经验是 908KB 压缩到小于 268KB。

下面的线程有我发现的最好的讨论/解决方案，带有很好的示例代码。

[http://groups.google.com/group/android-developers/msg/9f455ae93a1cf152](http://groups.google.com/group/android-developers/msg/9f455ae93a1cf152)

我将 CREATE 语句存储为要使用 Context.getString() 读取的字符串资源，并使用 SQLiteDatabse.execSQL() 运行它。

我将插入的数据存储在 res/raw/inserts.sql 中（我创建了 sql 文件，7000 多行）。使用上面链接中的技术，我进入了一个循环，逐行读取文件并将数据连接到“INSERT INTO tbl VALUE”并执行另一个 SQLiteDatabase.execSQL()。当它们可以被连接时，保存 7000 个“INSERT INTO tbl VALUE”是没有意义的。

在模拟器上大约需要 20 秒，我不知道在真手机上需要多长时间，但它只发生一次，当用户第一次启动应用程序时。

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2009-02-04T20:14:43.637

从我所看到的情况来看，您应该运送一个已经具有表设置和数据的数据库。但是，如果您愿意（并且取决于您拥有的应用程序类型），您可以允许“升级数据库选项”。然后你要做的是下载最新的sqlite版本，获取在线托管的文本文件的最新插入/创建语句，执行语句并将数据从旧数据库传输到新数据库。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2014-02-14T09:03:58.350

最后我做到了！！我已经使用了这个链接[帮助 Using your own SQLite database in Android applications](http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/)，但不得不稍微改变一下。

1.  如果你有很多包，你应该把主包名称放在这里：

    `private static String DB_PATH = "data/data/masterPakageName/databases";`

2.  我更改了将数据库从本地文件夹复制到模拟器文件夹的方法！当该文件夹不存在时，它有一些问题。所以首先，它应该检查路径，如果它不存在，它应该创建文件夹。

3.  在前面的代码中，`copyDatabase`当数据库不存在并且该`checkDataBase`方法导致异常时，该方法永远不会被调用。所以我稍微改变了代码。

4.  如果您的数据库没有文件扩展名，请不要将文件名与一个一起使用。

它对我很好，我希望它对你也有用

```
 package farhangsarasIntroduction;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.ArrayList;
import java.util.HashMap;

import android.content.Context;
import android.database.Cursor;

import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteException;
import android.database.sqlite.SQLiteOpenHelper;

import android.util.Log;

    public class DataBaseHelper extends SQLiteOpenHelper{

    //The Android's default system path of your application database.
    private static String DB_PATH = "data/data/com.example.sample/databases";

    private static String DB_NAME = "farhangsaraDb";

    private SQLiteDatabase myDataBase;

    private final Context myContext;

    /**
      * Constructor
      * Takes and keeps a reference of the passed context in order to access to the application assets and resources.
      * @param context
      */
    public DataBaseHelper(Context context) {

        super(context, DB_NAME, null, 1);
            this.myContext = context;

    }   

    /**
      * Creates a empty database on the system and rewrites it with your own database.
      * */
    public void createDataBase() {

        boolean dbExist;
        try {

             dbExist = checkDataBase();

        } catch (SQLiteException e) {

            e.printStackTrace();
            throw new Error("database dose not exist");

        }

        if(dbExist){
        //do nothing - database already exist
        }else{

            try {

                copyDataBase();

            } catch (IOException e) {

                e.printStackTrace();
                throw new Error("Error copying database");

            }
    //By calling this method and empty database will be created into the default system path
    //of your application so we are gonna be able to overwrite that database with our database.
        this.getReadableDatabase();

    }

    }

    /**
      * Check if the database already exist to avoid re-copying the file each time you open the application.
      * @return true if it exists, false if it doesn't
      */
    private boolean checkDataBase(){

    SQLiteDatabase checkDB = null;

    try{
        String myPath = DB_PATH +"/"+ DB_NAME;

        checkDB = SQLiteDatabase.openDatabase(myPath, null, SQLiteDatabase.OPEN_READONLY);
    }catch(SQLiteException e){

    //database does't exist yet.
        throw new Error("database does't exist yet.");

    }

    if(checkDB != null){

    checkDB.close();

    }

    return checkDB != null ? true : false;
    }

    /**
      * Copies your database from your local assets-folder to the just created empty database in the
      * system folder, from where it can be accessed and handled.
      * This is done by transfering bytestream.
      * */
    private void copyDataBase() throws IOException{

            //copyDataBase();
            //Open your local db as the input stream
            InputStream myInput = myContext.getAssets().open(DB_NAME);

            // Path to the just created empty db
            String outFileName = DB_PATH +"/"+ DB_NAME;
            File databaseFile = new File( DB_PATH);
             // check if databases folder exists, if not create one and its subfolders
            if (!databaseFile.exists()){
                databaseFile.mkdir();
            }

            //Open the empty db as the output stream
            OutputStream myOutput = new FileOutputStream(outFileName);

            //transfer bytes from the inputfile to the outputfile
            byte[] buffer = new byte[1024];
            int length;
            while ((length = myInput.read(buffer))>0){
            myOutput.write(buffer, 0, length);
            }

            //Close the streams
            myOutput.flush();
            myOutput.close();
            myInput.close();

    }

    @Override
    public synchronized void close() {

        if(myDataBase != null)
        myDataBase.close();

        super.close();

    }

    @Override
    public void onCreate(SQLiteDatabase db) {

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

    }

     you to create adapters for your views.

} 
```

* * *

## 回答 #9

> 赞同：5
> 
> 时间：2017-04-12T17:14:01.087

我修改了类和问题的答案，并编写了一个允许通过 DB_VERSION 更新数据库的类。

```
public class DatabaseHelper extends SQLiteOpenHelper {
    private static String DB_NAME = "info.db";
    private static String DB_PATH = "";
    private static final int DB_VERSION = 1;

    private SQLiteDatabase mDataBase;
    private final Context mContext;
    private boolean mNeedUpdate = false;

    public DatabaseHelper(Context context) {
        super(context, DB_NAME, null, DB_VERSION);
        if (android.os.Build.VERSION.SDK_INT >= 17)
            DB_PATH = context.getApplicationInfo().dataDir + "/databases/";
        else
            DB_PATH = "/data/data/" + context.getPackageName() + "/databases/";
        this.mContext = context;

        copyDataBase();

        this.getReadableDatabase();
    }

    public void updateDataBase() throws IOException {
        if (mNeedUpdate) {
            File dbFile = new File(DB_PATH + DB_NAME);
            if (dbFile.exists())
                dbFile.delete();

            copyDataBase();

            mNeedUpdate = false;
        }
    }

    private boolean checkDataBase() {
        File dbFile = new File(DB_PATH + DB_NAME);
        return dbFile.exists();
    }

    private void copyDataBase() {
        if (!checkDataBase()) {
            this.getReadableDatabase();
            this.close();
            try {
                copyDBFile();
            } catch (IOException mIOException) {
                throw new Error("ErrorCopyingDataBase");
            }
        }
    }

    private void copyDBFile() throws IOException {
        InputStream mInput = mContext.getAssets().open(DB_NAME);
        //InputStream mInput = mContext.getResources().openRawResource(R.raw.info);
        OutputStream mOutput = new FileOutputStream(DB_PATH + DB_NAME);
        byte[] mBuffer = new byte[1024];
        int mLength;
        while ((mLength = mInput.read(mBuffer)) > 0)
            mOutput.write(mBuffer, 0, mLength);
        mOutput.flush();
        mOutput.close();
        mInput.close();
    }

    public boolean openDataBase() throws SQLException {
        mDataBase = SQLiteDatabase.openDatabase(DB_PATH + DB_NAME, null, SQLiteDatabase.CREATE_IF_NECESSARY);
        return mDataBase != null;
    }

    @Override
    public synchronized void close() {
        if (mDataBase != null)
            mDataBase.close();
        super.close();
    }

    @Override
    public void onCreate(SQLiteDatabase db) {

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        if (newVersion > oldVersion)
            mNeedUpdate = true;
    }
} 
```

使用一个类。

在活动类中，声明变量。

```
private DatabaseHelper mDBHelper;
private SQLiteDatabase mDb; 
```

在 onCreate 方法中，编写以下代码。

```
mDBHelper = new DatabaseHelper(this);

try {
    mDBHelper.updateDataBase();
} catch (IOException mIOException) {
    throw new Error("UnableToUpdateDatabase");
}

try {
    mDb = mDBHelper.getWritableDatabase();
} catch (SQLException mSQLException) {
    throw mSQLException;
} 
```

如果您将数据库文件添加到文件夹 res/raw 中，则使用该类的以下修改。

```
public class DatabaseHelper extends SQLiteOpenHelper {
    private static String DB_NAME = "info.db";
    private static String DB_PATH = "";
    private static final int DB_VERSION = 1;

    private SQLiteDatabase mDataBase;
    private final Context mContext;
    private boolean mNeedUpdate = false;

    public DatabaseHelper(Context context) {
        super(context, DB_NAME, null, DB_VERSION);
        if (android.os.Build.VERSION.SDK_INT >= 17)
            DB_PATH = context.getApplicationInfo().dataDir + "/databases/";
        else
            DB_PATH = "/data/data/" + context.getPackageName() + "/databases/";
        this.mContext = context;

        copyDataBase();

        this.getReadableDatabase();
    }

    public void updateDataBase() throws IOException {
        if (mNeedUpdate) {
            File dbFile = new File(DB_PATH + DB_NAME);
            if (dbFile.exists())
                dbFile.delete();

            copyDataBase();

            mNeedUpdate = false;
        }
    }

    private boolean checkDataBase() {
        File dbFile = new File(DB_PATH + DB_NAME);
        return dbFile.exists();
    }

    private void copyDataBase() {
        if (!checkDataBase()) {
            this.getReadableDatabase();
            this.close();
            try {
                copyDBFile();
            } catch (IOException mIOException) {
                throw new Error("ErrorCopyingDataBase");
            }
        }
    }

    private void copyDBFile() throws IOException {
        //InputStream mInput = mContext.getAssets().open(DB_NAME);
        InputStream mInput = mContext.getResources().openRawResource(R.raw.info);
        OutputStream mOutput = new FileOutputStream(DB_PATH + DB_NAME);
        byte[] mBuffer = new byte[1024];
        int mLength;
        while ((mLength = mInput.read(mBuffer)) > 0)
            mOutput.write(mBuffer, 0, mLength);
        mOutput.flush();
        mOutput.close();
        mInput.close();
    }

    public boolean openDataBase() throws SQLException {
        mDataBase = SQLiteDatabase.openDatabase(DB_PATH + DB_NAME, null, SQLiteDatabase.CREATE_IF_NECESSARY);
        return mDataBase != null;
    }

    @Override
    public synchronized void close() {
        if (mDataBase != null)
            mDataBase.close();
        super.close();
    }

    @Override
    public void onCreate(SQLiteDatabase db) {

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        if (newVersion > oldVersion)
            mNeedUpdate = true;
    }
} 
```

[http://blog.harrix.org/article/6784](http://blog.harrix.org/article/6784)

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2012-08-12T20:28:39.927

将数据库传送到 apk 中，然后将其复制到`/data/data/...`数据库大小会加倍（apk 中为 1，apk 中为 1 `data/data/...`），并且会增加 apk 大小（当然）。所以你的数据库不应该太大。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2014-10-28T06:41:37.760

Android 已经提供了一种版本感知的数据库管理方法。这种方法已在 BARACUS 框架中用于 Android 应用程序。

[它使您能够在应用程序的整个版本生命周期内管理数据库，能够将 sqlite 数据库从任何先前版本更新到当前版本。](http://baracusframework.blogspot.de/2014/05/baracus-from-scratch-part-8-lifecycle.html)

[此外，它还允许您运行 SQLite 的热备份和热恢复。](http://baracusframework.blogspot.de/2014/03/baracus-from-scratch-part-7-android.html)

我不能 100% 确定，但**特定**设备的热恢复可能使您能够在应用程序中发布准备好的数据库。但我不确定可能特定于某些设备、供应商或设备代的数据库二进制格式。

由于这些东西是 Apache License 2，请随意重用代码的任何部分，[可以在 github 上找到](https://github.com/gorefest/baracus-framework)

编辑 ：

如果您只想传送数据，您可能会考虑在应用程序首次启动时实例化和持久化 POJO。BARACUS 对此提供了内置支持（用于配置信息的内置键值存储，例如“APP_FIRST_RUN”加上一个 after-context-bootstrap 挂钩，以便在上下文上运行启动后操作）。这使您能够将紧密耦合的数据与您的应用程序一起提供；在大多数情况下，这适合我的用例。

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2009-12-21T10:12:08.873

如果所需的数据不是太大（我不知道的限制，将取决于很多事情），您也可以从网站/webapp 下载数据（以 XML、JSON 等格式）。接收后，使用接收到的数据执行 SQL 语句，创建表并插入数据。

如果您的移动应用程序包含大量数据，那么以后使用更准确的数据或更改更新已安装应用程序中的数据可能会更容易。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2016-07-10T05:41:59.987

我写了一个[库](https://github.com/gazman-sdk/SQLite-Assets-Helper)来简化这个过程。

```
dataBase = new DataBase.Builder(context, "myDb").
//        setAssetsPath(). // default "databases"
//        setDatabaseErrorHandler().
//        setCursorFactory().
//        setUpgradeCallback()
//        setVersion(). // default 1
build(); 
```

它将从`assets/databases/myDb.db`文件创建一个数据库。此外，您将获得所有这些功能：

*   从文件加载数据库
*   同步访问数据库
*   通过 requery使用[sqlite-android](https://github.com/requery/sqlite-android)，Android 特定分发最新版本的 SQLite。

[从github](https://github.com/gazman-sdk/SQLite-Assets-Helper)克隆它。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2017-07-12T06:27:28.807

我正在使用 ORMLite，下面的代码对我有用

```
public class DatabaseProvider extends OrmLiteSqliteOpenHelper {
    private static final String DatabaseName = "DatabaseName";
    private static final int DatabaseVersion = 1;
    private final Context ProvidedContext;

    public DatabaseProvider(Context context) {
        super(context, DatabaseName, null, DatabaseVersion);
        this.ProvidedContext= context;
        SharedPreferences preferences = PreferenceManager.getDefaultSharedPreferences(context);
        boolean databaseCopied = preferences.getBoolean("DatabaseCopied", false);
        if (databaseCopied) {
            //Do Nothing
        } else {
            CopyDatabase();
            SharedPreferences.Editor editor = preferences.edit();
            editor.putBoolean("DatabaseCopied", true);
            editor.commit();
        }
    }

    private String DatabasePath() {
        return "/data/data/" + ProvidedContext.getPackageName() + "/databases/";
    }

    private void CopyDatabase() {
        try {
            CopyDatabaseInternal();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private File ExtractAssetsZip(String zipFileName) {
        InputStream inputStream;
        ZipInputStream zipInputStream;
        File tempFolder;
        do {
            tempFolder = null;
            tempFolder = new File(ProvidedContext.getCacheDir() + "/extracted-" + System.currentTimeMillis() + "/");
        } while (tempFolder.exists());

        tempFolder.mkdirs();

        try {
            String filename;
            inputStream = ProvidedContext.getAssets().open(zipFileName);
            zipInputStream = new ZipInputStream(new BufferedInputStream(inputStream));
            ZipEntry zipEntry;
            byte[] buffer = new byte[1024];
            int count;

            while ((zipEntry = zipInputStream.getNextEntry()) != null) {
                filename = zipEntry.getName();
                if (zipEntry.isDirectory()) {
                    File fmd = new File(tempFolder.getAbsolutePath() + "/" + filename);
                    fmd.mkdirs();
                    continue;
                }

                FileOutputStream fileOutputStream = new FileOutputStream(tempFolder.getAbsolutePath() + "/" + filename);
                while ((count = zipInputStream.read(buffer)) != -1) {
                    fileOutputStream.write(buffer, 0, count);
                }

                fileOutputStream.close();
                zipInputStream.closeEntry();
            }

            zipInputStream.close();
        } catch (IOException e) {
            e.printStackTrace();
            return null;
        }

        return tempFolder;
    }

    private void CopyDatabaseInternal() throws IOException {

        File extractedPath = ExtractAssetsZip(DatabaseName + ".zip");
        String databaseFile = "";
        for (File innerFile : extractedPath.listFiles()) {
            databaseFile = innerFile.getAbsolutePath();
            break;
        }
        if (databaseFile == null || databaseFile.length() ==0 )
            throw new RuntimeException("databaseFile is empty");

        InputStream inputStream = new FileInputStream(databaseFile);

        String outFileName = DatabasePath() + DatabaseName;

        File destinationPath = new File(DatabasePath());
        if (!destinationPath.exists())
            destinationPath.mkdirs();

        File destinationFile = new File(outFileName);
        if (!destinationFile.exists())
            destinationFile.createNewFile();

        OutputStream myOutput = new FileOutputStream(outFileName);

        byte[] buffer = new byte[1024];
        int length;
        while ((length = inputStream.read(buffer)) > 0) {
            myOutput.write(buffer, 0, length);
        }

        myOutput.flush();
        myOutput.close();
        inputStream.close();
    }

    @Override
    public void onCreate(SQLiteDatabase sqLiteDatabase, ConnectionSource connectionSource) {
    }

    @Override
    public void onUpgrade(SQLiteDatabase sqLiteDatabase, ConnectionSource connectionSource, int fromVersion, int toVersion) {

    }
} 
```

请注意，代码从资产中的 zip 文件中提取数据库文件

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2020-11-21T17:12:58.167

如果您使用的是**ROOM** ，那么官方文档中已经有一条非常直接的路径[https://developer.android.com/training/data-storage/room/prepopulate](https://developer.android.com/training/data-storage/room/prepopulate)。以下是从资产文件重新填充数据库的实际操作：

```
Room.databaseBuilder(appContext, AppDatabase.class, "Sample.db")
    .createFromAsset("database/myapp.db")
    .build() 
```

或从文件中：

```
Room.databaseBuilder(appContext, AppDatabase.class, "Sample.db")
    .createFromFile(File("mypath"))
    .build() 
```

如果你不使用 Room，我强烈建议你这样做

# svn - Netbeans颠覆右边距

> ID：513091
> 
> 赞同：0
> 
> 时间：2009-02-04T20:14:09.113
> 
> 标签：svn, ide, netbeans

如何更改 Netbeans 右边距中的颜色编码？Subversion 跟踪更改、删除、添加等的部分。我发现的唯一参考是 Netbeans Subversion 指南，它告诉您它们是什么，但没有解释如何配置或禁用它。（它甚至可以配置吗？）

所以我做了更多搜索，一个站点提到更改配置文件以更改文件浏览器中文件的配色方案，有人知道右边距是否存在配置文件吗？我想禁用它的 Subversion 部分，因为它会干扰有用的东西，如断点、错误和警告（太杂乱）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-09T11:36:31.147

以下已在 Netbeans 6.1 上得到验证：

1.  转到工具 > 选项
2.  点击“字体和颜色”
3.  在出现的选项卡窗口中选择“差异”。
4.  选择您喜欢的颜色：

[替代文字 http://img49.imageshack.us/img49/1954/diffpu3.jpg](http://img49.imageshack.us/img49/1954/diffpu3.jpg)

单击确定，一旦您满意。

就是这样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-09T13:24:33.727

看起来这不起作用，并且有 2 个关于此问题的未决案例。

```
http://www.netbeans.org/issues/show_bug.cgi?id=134346
http://www.netbeans.org/issues/show_bug.cgi?id=104632 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-08T04:04:42.687

AFAIK，这可能无法配置。但是，您可以考虑在 NetBeans 用户邮件列表/论坛上询问它。更多信息[请访问 http://wiki.netbeans.org/NetBeansUserFAQ](http://wiki.netbeans.org/NetBeansUserFAQ)

祝你好运！

# sql - 获取同一个表中的公共行

> ID：513098
> 
> 赞同：4
> 
> 时间：2009-02-04T20:15:50.343
> 
> 标签：sql, mysql, database, relational, self-join

我进行了一些搜索，但没有找到与我想要实现的目标完全一样的东西。

基本上，我试图找到两个用户投票习惯之间的相似之处。

我有一个表格存储每个单独的投票，其中存储：

```
voteID
itemID     (the item the vote is attached to)
userID     (the user who voted)
direction  (whether the user voted the post up, or down) 
```

我的目标是通过找出两件事来计算用户 A 和 B 之间的相似度：

1.  **他们共有的票数**。也就是说，他们都在同一个帖子上投票的次数（此时方向无关紧要）。
2.  **他们在共同投票中朝同一个方向投票的次数**。

（然后简单地将#2 计算为#1 的百分比，以获得粗略的相似性评级）。

我的问题是，**我如何找到两个用户的投票集之间的交集？**（即我如何充分计算第 1 点，而不会以非常低效的方式循环每一次投票。）如果他们在不同的表中，我想一个 INNER JOIN 就足够了......但这显然行不通在同一张桌子上（或者会吗？）。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T20:31:41.467

像这样的东西：

```
SELECT COUNT(*)
FROM votes v1
INNER JOIN votes v2 ON (v1.item_id = v2.item_id)
WHERE v1.userID = 'userA'
AND v2.userUD = 'userB' 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T20:48:00.403

如果您想为单个用户执行此操作（而不是在一开始就知道两个用户）以找到他们最接近的匹配对象：

```
SELECT
     v2.userID,
     COUNT(*) AS matching_items,
     SUM(CASE WHEN v2.direction = v1.direction THEN 1 ELSE 0 END) AS matching_votes
FROM
     Votes v1
INNER JOIN Votes v2 ON
     v2.userID <> v1.userID AND
     v2.itemID = v1.itemID
WHERE
     v1.userID = @userID
GROUP BY
     v2.userID 
```

然后，您可以限制您认为合适的内容（返回前 10 名、前 20 名、全部等）

我还没有对此进行测试，所以如果它没有按预期运行，请告诉我。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T20:35:25.780

这是一个应该让您更接近的示例：

```
SELECT COUNT(*)
FROM (
      SELECT u1.userID
      FROM vote u1, vote u2
      WHERE u1.itemID = u2.itemID
      AND u1.userID = user1
      AND u2.userID = user2) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T20:35:46.637

假设将 userID 1 与 userID 2 进行比较

为了找出他们有多少共同的选票：

```
SELECT COUNT(*)
FROM Votes AS v1
INNER JOIN Votes AS v2 ON (v2.userID = 2
                            AND v2.itemID = v1.itemID)
WHERE v1.userID = 1; 
```

查找他们何时也投票相同：

```
SELECT COUNT(*)
FROM Votes AS v1
INNER JOIN Votes AS v2 ON (v2.userID = 2
                            AND v2.itemID = v1.itemID
                            AND v2.direction = v1.direction)
WHERE v1.userID = 1; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T20:40:19.920

自联接是有序的。这是您所要求的所有内容：

```
SELECT v1.userID user1, v2.userID user2,
  count(*) n_votes_in_common,
  sum(case when v1.direction = v2.direction then 1 else 0 end) n_votes_same_direction,
  (n_votes_same_direction * 100.0 / n_votes_in_common) crude_similarity_percent 
FROM votes v1
INNER JOIN votes v2
ON v1.item_id = v2.item_id 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T20:27:54.577

您当然可以将表连接到自身。事实上，这就是你必须要做的。将表连接到自身时必须使用别名。如果您的表没有 PK 或 FK，则必须改用 Union。Union 将删除重复项，Union All 不会。

# winapi - GetTickCount() 是否包括暂停或休眠的时间？

> ID：513099
> 
> 赞同：9
> 
> 时间：2009-02-04T20:15:51.780
> 
> 标签：winapi

*澄清一下，我的意思是系统*挂起/休眠时花费的时间，而不是调用线程（GetTickCount() 返回自系统启动以来的毫秒数）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T20:22:44.510

据我所知，GetTickCount 与线程无关，它计算系统启动以来的时间。但最好使用[GetTickCount64](http://msdn.microsoft.com/en-us/library/ms724411(VS.85).aspx)来避免 49.7 天的角色转移。

顺便说一句，要得到你想要的，你需要[GetThreadTimes](http://msdn.microsoft.com/en-us/library/ms683237(VS.85).aspx)函数。它记录创建和退出时间以及线程在用户或内核空间中花费的时间。所以你有一个很好的方法来计算花费的时间。

好的，我错过了问题的“系统”部分。但这很简单。当处于休眠状态时，GetTickCount 会继续计数。因为当计算机大部分时间处于休眠状态时，人们已经遭受了 49.7 天的错误。有关更多信息，请参见此处的[链接文本。](http://dot-y.blogspot.com/2008/07/windows-programming-funny-gettickcount.html)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T20:52:13.157

简短的回答：是的。

更长的答案：阅读[GetTickCount()](http://msdn.microsoft.com/en-us/library/ms724408(VS.85).aspx)文档：这是自系统启动以来***经过***的时间，甚至 MS 也不会建议您的计算机休眠时时间静止...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2010-10-30T20:02:00.013

是的，GetTickCount 确实包括挂起/休眠时间。

在下面的 python 脚本中，我调用 Sleep API 等待 40 秒，让我有机会将计算机置于休眠模式，然后打印之前和之后的时间，以及之后的滴答计数差异。

```
导入win32api
进口时间
print time.strftime("%H:%M:%S", time.localtime())
之前 = win32api.GetTickCount()
打印“睡眠”
win32api.Sleep(40000)
print time.strftime("%H:%M:%S", time.localtime())
打印 str(win32api.GetTickCount()-之前)
```

输出：

```
17:44:08
睡觉
17:51:30
442297
```

如果 GetTickCount 不包括休眠期间的时间，它将比我休眠的时间少得多，但它与实际经过的时间相匹配（7 分 22 秒等于 442 秒，即 442000 毫秒“滴答声”）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-06-03T08:46:40.673

对于任何在 Windows CE 平台下寻找答案的人，来自文档：

[http://msdn.microsoft.com/en-us/library/ms885645.aspx](http://msdn.microsoft.com/en-us/library/ms885645.aspx)

你可以阅读：

> 对于 Release 配置，此函数返回自设备启动以来的毫秒数，***不包括系统暂停的任何时间***。GetTickCount 在启动时从 0 开始，然后从那里开始计数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T20:23:15.990

`GetTickCount()`为您提供自计算机启动以来的毫秒数。它与调用它的进程无关。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2009-11-08T13:37:16.150

不，`GetTickCount()`不包括系统在休眠期间花费的时间。一个简单的测试证明了这一点。

在 Python 中：

```
import win32api
win32api.GetTickCount() 
```

-- 休眠 --

```
win32api.GetTickCount() 
```

你会看到结果...

# javascript - 当字符串包含html实体时，在Javascript中设置文本节点的nodeValue

> ID：513112
> 
> 赞同：8
> 
> 时间：2009-02-04T20:22:04.417
> 
> 标签：javascript, dom, html-entities, nodevalue

当我设置文本节点的值时

```
node.nodeValue="string with &#xxxx; sort of characters" 
```

＆符号被逃脱。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T20:33:44.287

您需要对 Unicode 字符使用 Javascript 转义：

```
node.nodeValue="string with \uxxxx sort of characters" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-06-08T14:27:03.443

从[http://code.google.com/p/jslibs/wiki/JavascriptTips](http://code.google.com/p/jslibs/wiki/JavascriptTips)：

（转换实体引用和数字实体）

```
const entityToCode = { __proto__: null,
apos:0x0027,quot:0x0022,amp:0x0026,lt:0x003C,gt:0x003E,nbsp:0x00A0,iexcl:0x00A1,cent:0x00A2,磅:0x00A3,
当前:0x00A4,日元:0x00A5,brvbar:0x00A6,sect:0x00A7,uml:0x00A8,copy:0x00A9,ordf:0x00AA,laquo:0x00AB,
not:0x00AC,shy:0x00AD,reg:0x00AE,macr:0x00AF,deg:0x00B0,plusmn:0x00B1,sup2:0x00B2,sup3:0x00B3,
急性：0x00B4，微：0x00B5，para：0x00B6，middot：0x00B7，cedil：0x00B8，sup1：0x00B9，ordm：0x00BA，raquo：0x00BB，
frac14:0x00BC,frac12:0x00BD,frac34:0x00BE,iquest:0x00BF,Agrave:0x00C0,Aacute:0x00C1,Acirc:0x00C2,Atilde:0x00C3,
Auml:0x00C4,Aring:0x00C5,AElig:0x00C6,Ccedil:0x00C7,Egrave:0x00C8,Eacute:0x00C9,Ecirc:0x00CA,Euml:0x00CB,
Igrave:0x00CC,Iacute:0x00CD,Icirc:0x00CE,Iuml:0x00CF,ETH:0x00D0,Ntilde:0x00D1,Ograve:0x00D2,Oacute:0x00D3,
Ocirc:0x00D4,Otilde:0x00D5,Ouml:0x00D6,times:0x00D7,Oslash:0x00D8,Ugrave:0x00D9,Uacute:0x00DA,Ucirc:0x00DB,
Uuml:0x00DC,Yacute:0x00DD,THORN:0x00DE,szlig:0x00DF,agrave:0x00E0,aacute:0x00E1,acirc:0x00E2,atilde:0x00E3,
auml:0x00E4,aring:0x00E5,aelig:0x00E6,ccedil:0x00E7,egrave:0x00E8,eacute:0x00E9,ecirc:0x00EA,euml:0x00EB,
igrave:0x00EC,iacute:0x00ED,icirc:0x00EE,iuml:0x00EF,eth:0x00F0,ntilde:0x00F1,ograve:0x00F2,oacute:0x00F3,
ocirc:0x00F4,otilde:0x00F5,ouml:0x00F6,divide:0x00F7,oslash:0x00F8,ugrave:0x00F9,uacute:0x00FA,ucirc:0x00FB,
uuml:0x00FC,yacute:0x00FD,刺:0x00FE,yuml:0x00FF,OElig:0x0152,oelig:0x0153,Scaron:0x0160,scaron:0x0161,
Yuml:0x0178,fnof:0x0192,circ:0x02C6,波浪号:0x02DC,Alpha:0x0391,Beta:0x0392,Gamma:0x0393,Delta:0x0394,
Epsilon:0x0395,Zeta:0x0396,Eta:0x0397,Theta:0x0398,Iota:0x0399,Kappa:0x039A,Lambda:0x039B,Mu:0x039C,
Nu:0x039D,Xi:0x039E,Omicron:0x039F,Pi:0x03A0,Rho:0x03A1,Sigma:0x03A3,Tau:0x03A4,Upsilon:0x03A5,
Phi:0x03A6,Chi:0x03A7,Psi:0x03A8,Omega:0x03A9,alpha:0x03B1,beta:0x03B2,gamma:0x03B3,delta:0x03B4,
epsilon:0x03B5,zeta:0x03B6,eta:0x03B7,theta:0x03B8,iota:0x03B9,kappa:0x03BA,lambda:0x03BB,mu:0x03BC,
nu:0x03BD,xi:0x03BE,omicron:0x03BF,pi:0x03C0,rho:0x03C1,sigmaf:0x03C2,sigma:0x03C3,tau:0x03C4,
upsilon:0x03C5,phi:0x03C6,chi:0x03C7,psi:0x03C8,omega:0x03C9,thetasym:0x03D1,upsih:0x03D2,piv:0x03D6,
ensp:0x2002,emsp:0x2003,thinsp:0x2009,zwnj:0x200C,zwj:0x200D,lrm:0x200E,rlm:0x200F,ndash:0x2013,
mdash:0x2014,lsquo:0x2018,rsquo:0x2019,sbquo:0x201A,ldquo:0x201C,rdquo:0x201D,bdquo:0x201E,dagger:0x2020,
Dagger:0x2021,bull:0x2022,hellip:0x2026,permil:0x2030,prime:0x2032,Prime:0x2033,lsaquo:0x2039,rsaquo:0x203A,
在线：0x203E，frasl：0x2044，欧元：0x20AC，图像：0x2111，weierp：0x2118，真实：0x211C，贸易：0x2122，alefsym：0x2135，
larr:0x2190,uarr:0x2191,rarr:0x2192,darr:0x2193,harr:0x2194,crarr:0x21B5,lArr:0x21D0,uArr:0x21D1,
rArr:0x21D2,dArr:0x21D3,hArr:0x21D4,forall:0x2200,part:0x2202,exist:0x2203,empty:0x2205,na​​bla:0x2207,
isin:0x2208,notin:0x2209,ni:0x220B,prod:0x220F,sum:0x2211,minus:0x2212,lowast:0x2217,radic:0x221A,
prop:0x221D,infin:0x221E,ang:0x2220,and:0x2227,or:0x2228,cap:0x2229,cup:0x222A,int:0x222B,
there4:0x2234,sim:0x223C,cong:0x2245,asymp:0x2248,ne:0x2260,equiv:0x2261,le:0x2264,ge:0x2265,
sub:0x2282,sup:0x2283,nsub:0x2284,sub:0x2286,supe:0x2287,oplus:0x2295,otimes:0x2297,perp:0x22A5,
sdot:0x22C5,lceil:0x2308,rceil:0x2309,lfloor:0x230A,rfloor:0x230B,lang:0x2329,rang:0x232A,loz:0x25CA,
黑桃：0x2660，梅花：0x2663，红心：0x2665，直径：0x2666
};

var charToEntity = {};
for ( var entityName in entityToCode )
        charToEntity[String.fromCharCode(entityToCode[entityName])] = entityName;

function EscapeEntities(str) str.replace(/[^\x20-\x7E]/g, function(str) charToEntity[str] ? '&'+charToEntity[str]+';' : str);
```

```
功能 unescapeEntities(str) {
    返回 str.replace(
     /&(.+?);/g,
     函数（str，ent）{
        return String.fromCharCode( ent[0]!='#' ? entityToCode[ent] : ent[1]=='x' ? parseInt(ent.substr(2),16): parseInt(ent.substr(1) ));
     });
}

```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T20:52:41.267

发生这种情况的原因是您的字符串中的 & 正在被浏览器扩展为 & 实体。要解决此问题，您需要自己转换实体。

```
<html>
<body>
    <div id="test"> </div>
</body>

<script type="text/javascript">

onload = function()
{
    var node = document.getElementById( 'test' );
    node.firstChild.nodeValue = convertEntities( 'Some &#187; entities &#171; and some &#187; more entities &#171;' );
}

function convertEntities( text )
{
    var matches = text.match( /\&\#(\d+);/g );

    for ( var i = 0; i < matches.length; i++ )
    {
        console.log( "Replacing: " + matches[i] );
        console.log( "With: " + convertEntity( matches[i] ) );
        text = text.replace( matches[i], convertEntity( matches[i] ) );
    }

    return text;

    function convertEntity( ent )
    {
        var num = parseInt(ent.replace(/\D/g, ''), 16);
        var esc = ((num < 16) ? '0' : '') + num.toString(16);
        return String.fromCharCode( esc );
    }
}

</script>

</html> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T23:33:46.170

如其他答案所述，我需要用 javascript 编码的实体替换 html 编码的实体。从[BaileyP 的回答](https://stackoverflow.com/questions/513112/setting-nodevalue-of-text-node-in-javascript-without-escaping/513277#513277)开始，我做了这个：

```
function convertEntities( text )
{
    var ret = text.replace( /\&\#(\d+);/g, function ( ent, captureGroup )
    {
        var num = parseInt( captureGroup );
        return String.fromCharCode( num );
    });
    return ret;
} 
```

# opengl - 多头显示系统

> ID：513114
> 
> 赞同：4
> 
> 时间：2009-02-04T20:22:39.660
> 
> 标签：opengl, 3d, hardware, directx

我可以使用哪些工具、API、库来创建能够在由 4、8、9、16 等屏幕/投影仪组成的显示器中实时渲染高分辨率 3D 场景的系统？对于具有 8 台投影仪的设置，我应该选择集群解决方案，还是应该使用具有 4 个双头视频卡的单个节点？有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T20:46:46.770

[均衡器](http://www.equalizergraphics.com/)可能是您能找到的更好的解决方案之一。

它专为拆分渲染并将它们分布在显示器上而设计。

**描述：**

> 均衡器允许用户缩放渲染性能、视觉质量和显示尺寸。基于均衡器的应用程序无需修改即可在任何可视化系统上运行，从简单的工作站到大型图形集群、多 GPU 工作站和虚拟现实安装。

均衡器的示例用法：

[![渲染墙](https://i.stack.imgur.com/e3dVy.jpg)](https://i.stack.imgur.com/e3dVy.jpg)
[（来源：[equalizergraphics.com](http://www.equalizergraphics.com/screenshots/wall2-small.jpg)）]

我曾参与过尝试在没有均衡器的情况下做类似事情的项目，老实说，这非常糟糕。我们只是勉强工作。后来找到均衡器后，我无法想象使用这样的工具会变得多么容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T23:24:05.533

我在家里的游戏设备上使用这些漂亮的[TripleHead2Go之一从一张视频卡驱动 3 个显示器（即使在 Vista 中）。](http://www.matrox.com/graphics/en/products/gxm/th2go/)两个中间有一个挡板的显示器对于游戏来说有点糟糕。 [![TripleHead2Go](https://i.stack.imgur.com/o7EXm.png)](https://i.stack.imgur.com/o7EXm.png)
[（来源：[maximumpc.com](http://www.maximumpc.com/files/u21826/header-3htgo.png)）]

我发现它们是因为我们正在考虑在工作中使用它们中的几个来驱动我们的具有大约 9 个显示器的系统。我认为为此我们最终选择了一个具有 5 个 PCI-X 插槽和一个双头卡的系统。如果您无法在主板上安装那么多 PCI 插槽，可以使用 PCI-X 总线扩展系统。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T20:34:38.933

在使用 X11/Xorg 时，您可以使用*Xinerama*或*XRandR 。*但是要引用[Xinerama](http://en.wikipedia.org/wiki/Xinerama)上的维基百科：

> 在大多数实现中，OpenGL (3D) 直接渲染仅适用于其中一个屏幕。应该在其他屏幕上显示 3D 图形的窗口往往只是显示为黑色。这在 3D 屏幕保护程序中最常见，它在一个屏幕上显示而在其他屏幕上显示为黑色。（Solaris SPARC OpenGL 实现允许在 Xinerama 模式下直接渲染到所有屏幕，当两个显示器在同一个视频卡上时，nvidia 驱动程序也是如此。）

我建议你先阅读维基百科的文章。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-05-13T21:20:54.093

你应该看看“ [AMD Radeon HD 5870 Eyefinity 6-edition](http://www.amd.com/us/products/desktop/graphics/ati-radeon-hd-5000/hd-5870-eyefinity-6-edition/Pages/overview.aspx) ”显卡。这支持同时输出到六个显示器，并允许在驱动程序中设置有关输出排列的多个选项（连续 3 个、2x3 水平/垂直）等）。

关于 API：使用这样的卡（但也使用 TripleHead2Go），您将获得一个虚拟画布，它支持完整的 3D 加速而不会损失性能（比扩展桌面好得多）。在 AMD，他们称之为单一大表面（可能相当于 NVidia 所说的水平/垂直跨度）。这里需要注意的是，所有输出都需要具有相同的分辨率、帧速率和颜色深度。这样的表面可能具有 5760 x 3240 或更高的分辨率，具体取决于设置，因此 5870 的速度如此之快是件好事。

然后，在您的应用程序中，您渲染到这个大型虚拟画布（使用 OpenGL、Direct3D 或其他方式），您就完成了……除了您没有说是否要让显示器与每个画布成一定角度其他或平面配置。在后一种情况下，您可以只使用单个透视相机并渲染到整个后缓冲区。但是如果你有更多的“环绕”设置，那么你需要在你的场景中有多个摄像机，所有摄像机都从同一个点向外看。

执行此渲染的最快循环可能是：

```
for all all objects
    set textures and shader and renderstate
    for all viewports
        render object to viewport 
```

并不是

```
for all viewports
    for all objects
         set textures and shader and renderstate
         render object to viewport 
```

因为切换对象会导致 GPU 从其状态和缓存中丢失比切换视口更多的有用信息。

您可以联系 AMD 以检查是否可以将其中两张卡（电源允许）添加到单个系统以驱动多达 12 台显示器。

请注意，并非*所有*配置都受支持（例如，不支持 5x1，正如我从常见问题解答中看到的那样）。

我在这方面的很多经验都是在创建[Future Flight Experience](http://www.youtube.com/watch?v=BoxyqbnvKD0)项目期间收集的，该项目使用三个投影仪（每个投影仪在 3D 场景中都有自己的摄像头）、SLI 中的双 Nvidia GTX 280 和 Windows XP 上的 Matrox TripleHead2Go .

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T00:41:35.533

我知道 python 的 pyglet OpenGL 包装器 ( [http://www.pyglet.org](http://www.pyglet.org) ) 具有多平台多监视器支持；您可能想查看他们的源代码并弄清楚它是如何实现的。

# sql - 要添加到每个字段的 SQL 语句

> ID：513119
> 
> 赞同：0
> 
> 时间：2009-02-04T20:23:06.647
> 
> 标签：sql

我的表，例如：

```
Table money
_uid____cash_
0   |   500
1   |   740
2   |   800 
```

在 MySQL 中，有没有办法编写一条语句，将现金列中的每个条目加 100？

提前致谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T20:23:51.747

```
UPDATE money
SET cash = cash + 100; 
```

# c# - 从给定 AD 组中的 Active Directory 获取用户列表

> ID：513124
> 
> 赞同：19
> 
> 时间：2009-02-04T20:23:30.017
> 
> 标签：c#, active-directory

我有搜索部门中所有用户的代码：

```
string Department = "Billing";
DirectorySearcher LdapSearcher = new DirectorySearcher();
LdapSearcher.PropertiesToLoad.Add("displayName");
LdapSearcher.PropertiesToLoad.Add("cn");
LdapSearcher.PropertiesToLoad.Add("department");
LdapSearcher.PropertiesToLoad.Add("title");
LdapSearcher.PropertiesToLoad.Add("memberOf");
LdapSearcher.Filter = string.Format("(&(objectClass=user)(department={0}))", Department);
SearchResultCollection src = LdapSearcher.FindAll(); 
```

如果我只希望“经理只读”AD 组中的每个人都需要，过滤器应该是什么样子？

我对这一切都错了吗？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2009-02-04T22:11:13.793

看着你的搜索，我有几点要给你。首先，搜索使用 objectClass（非索引）而不是 objectCategory（索引）。该查询存在巨大的性能问题。根据您要检索的内容，您最总是希望将两者结合在一起：

```
(&(objectCategory=person)(objectClass=user)) = All users (no contacts)
(&(objectCategory=person)(objectClass=contact)) = All contacts (no users)
(&(objectCategory=person)) = All users and contacts 
```

至于查找组中的用户，您可以枚举特定组的成员对象列表。在 group 对象的 member 属性中是每个用户的 distinctName。

[本文介绍了枚举组的成员...](http://www.codeproject.com/KB/system/everythingInAD.aspx#24)

不要忘记您可能必须处理父组的嵌套组，因为 LDAP 查询没有默认的处理方式。为此，您可能需要评估成员对象是否为组，然后获取该子组的成员属性。

最后，您应该养成为查询指定 dns 前缀的习惯。

没有 DNS 前缀：

```
LDAP://ou=ouname,dc=domain,dc=com 
```

使用 DNS 前缀（所有三个工作）：

```
LDAP://servername/ou=ouname,dc=domain,dc=com
LDAP://servername.domain.com/ou=ouname,dc=domain,dc=com
LDAP://domain.com/ou=ouname,dc=domain,dc=com 
```

单个域不会给您带来太多问题，但是当您尝试在多域环境中运行搜索时，如果没有此添加，您将被咬。希望这能帮助你更接近你的目标。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-02-04T20:35:34.673

我一直发现[Howto: (Almost) Everything In Active Directory via C#](http://www.codeproject.com/KB/system/everythingInAD.aspx)有助于解决大多数 AD 问题。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2009-02-04T20:47:08.127

如果您已经知道该组的 AD 路径，则可能更容易在其上打开 DirectoryEntry，然后从那里执行 DirectorySearcher。

```
using (DirectoryEntry de = new DirectoryEntry("LDAP://somedomain/CN=FooBar"))
{
   DirectorySearcher search = new DirectorySearcher(de, ("(objectClass=user)"));
} 
```

Searcher 上还有一个标志，用于指示是否向下钻取到子容器，我忘记了名称。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-10T14:32:30.670

我使用以下代码（来自[http://blogs.technet.com/b/brad_rutkowski/archive/2008/04/15/c-getting-members-of-a-group-the-easy-way-with-net- 3-5-discussion-groups-nested-recursive-security-groups-etc.aspx](http://blogs.technet.com/b/brad_rutkowski/archive/2008/04/15/c-getting-members-of-a-group-the-easy-way-with-net-3-5-discussion-groups-nested-recursive-security-groups-etc.aspx)）它工作正常。

```
IList<string> getMembers(string domainName, string groupName)
    {
        PrincipalContext ctx = new PrincipalContext(ContextType.Domain, domainName);
        GroupPrincipal grp = GroupPrincipal.FindByIdentity(ctx, IdentityType.Name, groupName);

        if (grp == null) { 
            throw new ApplicationException("We did not find that group in that domain, perhaps the group resides in a different domain?");
        }

        IList<string> members = new List<String>();

        foreach (Principal p in grp.GetMembers(true))
        {
            members.Add(p.Name); //You can add more attributes, samaccountname, UPN, DN, object type, etc... 
        }
        grp.Dispose();
        ctx.Dispose();

        return members;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-30T21:12:40.310

```
 //Search for Group and list group members

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.DirectoryServices.AccountManagement;

namespace ExportActiveDirectoryGroupsUsers
{
    class Program
    {
        static void Main(string[] args)
        {
            if (args == null)
            {
                Console.WriteLine("args is null, useage: ExportActiveDirectoryGroupsUsers OutputPath"); // Check for null array
            }
            else
            {
                Console.Write("args length is ");
                Console.WriteLine(args.Length); // Write array length
                for (int i = 0; i < args.Length; i++) // Loop through array
                {
                    string argument = args[i];
                    Console.Write("args index ");
                    Console.Write(i); // Write index
                    Console.Write(" is [");
                    Console.Write(argument); // Write string
                    Console.WriteLine("]");
                }
                try
                {
                    using (var ServerContext = new PrincipalContext(ContextType.Domain, ServerAddress, Username, Password))
                    {
                        /// define a "query-by-example" principal - here, we search for a GroupPrincipal 
                        GroupPrincipal qbeGroup = new GroupPrincipal(ServerContext, args[0]);

                        // create your principal searcher passing in the QBE principal    
                        PrincipalSearcher srch = new PrincipalSearcher(qbeGroup);

                        // find all matches
                        foreach (var found in srch.FindAll())
                        {
                            GroupPrincipal foundGroup = found as GroupPrincipal;

                            if (foundGroup != null)
                            {
                                // iterate over members
                                foreach (Principal p in foundGroup.GetMembers())
                                {
                                    Console.WriteLine("{0}|{1}", foundGroup.Name, p.DisplayName);
                                    // do whatever you need to do to those members
                                }
                            }

                        }
                    }
                    //Console.WriteLine("end");
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Something wrong happened in the AD Query module: " + ex.ToString());
                }
                Console.ReadLine();
            }
        }
    }
} 
```

# linux - 什么是适合初学者内核开发的好的准系统 Linux 发行版？

> ID：513126
> 
> 赞同：9
> 
> 时间：2009-02-04T20:23:47.193
> 
> 标签：linux, kernel, osdev

在我的操作系统课程中，我们希望使用我们自己的一些简单的 C 系统调用来修改 Linux 内核。

什么是适合此目的的好发行版？我们不需要任何装饰，没有 GUI，香草内核等。越基本越好。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T20:27:01.257

使用最小的 Gentoo 安装，我可以很容易地修改内核。只需安装 gentoo，按照安装说明进行操作，然后：

> ```
> $ emerge gentoo-sources
> $ emerge emacs
> $ cd /usr/src/linux 
> ```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-22T19:57:39.007

在我上学期的操作系统课程中，我们使用了[用户模式 ​​Linux](http://user-mode-linux.sourceforge.net/index.html)，最大的优势是当您使用系统时，您可以简单地终止进程，而不会对主机环境造成风险。

无论您使用什么内核，添加/修改系统调用都是乏味但微不足道的。然而，2.6 内核明显更大更复杂，因此如果您要以显着的方式修改代码，旧内核更易于使用并且文档更好。（即：更容易找到书籍和参考资料）

快乐的黑客:)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2009-02-04T20:40:54.020

Archlinux++

但真的.. gentoo、slack 和 arch 或多或少都是不错的选择

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-09-11T19:12:05.227

Arch Linux 为内核开发提供了一个很好的平台，它也非常实用。如果你学会使用 pacman，它实际上会让测试你的内核修改变得相当容易，并以一种理智的方式提供源代码和工具。

我确实认为，如果您认真学习 linux 和内核黑客，那么从头开始安装 Linux 应该在您的列表中。这是一本很棒的发行版/书籍，可以让您自己构建开发平台。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T20:32:58.717

在所有发行版上，您都可以安装 vanilla kernel.org 源代码而不是与发行版相关的内核包，这在您想要进行内核开发时可能是个好主意。

但是，当您想使用任何具有非 2.6 内核的最新发行版时，您会遇到麻烦，因为它们通常以无法在 2.4 上运行的方式构建 libc6。此外，许多硬件管理（如 udev）都需要相当新的内核。

除此之外，使用 Debian 为您提供了一个准系统，并且使用[kernel-package](http://packages.debian.org/search?keywords=kernel-package)安装您自己的内核是一件轻而易举的事。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T20:28:37.947

我不一定会说任何特定的发行版都面向内核开发，但是如果您想要一个不会在您和内核之间堆积太多自定义配置的传统 Linux 发行版，那么 Slackware 是一个不错的选择。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T20:46:46.397

我的建议是获取最新的内核。它内部的调试功能将比旧内核中的更多。此外，较旧的内核看起来几乎与新手的最新内核一样复杂。

至于发行版本身，你不会真的出错。如果您只想尝试一些自定义系统调用，那么请使用任何主流发行版来为您提供良好的开发环境。然后编译并尝试您自定义的 glibc，而无需在发行版上安装它。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-22T20:17:25.107

在为内核开发选择发行版时，请记住您要破解的是**内核，而不是发行版本身。**因此，您将需要一个尽可能不妨碍您的简单发行版。Ubuntu 说得很好。

伊纳赫

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-09-06T22:36:40.740

好吧，我发现了一个名为“minix”的版本，它并不是真正的 linux 发行版，但它是专门为教学而制作的，但是如果您只能使用 linux 发行版，那没关系，我很确定所有发行版都有同一个内核

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2009-11-12T11:30:27.720

非 linux 替代品是[Geek OS](http://geekos.sourceforge.net/ "极客操作系统")，但这主要针对教育水平，并不是一个实用的内核。虽然它非常简单。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-02-27T11:56:07.610

Gentoo 如果你不介意自动编译（大多数人认为 gentoo 是 Linux From Scratch => 你必须自己做所有事情）。

如果您的计算机（笔记本电脑）速度较慢，请使用 Arch。

这两个最大的优点是他们有非常非常好的文档，只有安装 Gentoo fe 才能让你了解有关 init 系统和必须运行哪些服务的基本知识。如果从指南中复制和粘贴命令，它就毫无价值（幸运的是手册让人们思考了一下，从而阻止孩子们安装 gentoo 并接管我们整洁的#irc）：D

# c# - C# 编译错误：“在创建窗口句柄之前，不能对控件调用 Invoke 或 BeginInvoke。”

> ID：513131
> 
> 赞同：8
> 
> 时间：2009-02-04T20:24:21.137
> 
> 标签：c#, delegates, invoke, handle, runtime-error

我刚刚发布了一个关于如何让代表更新另一个表单上的文本框的问题。就在我认为我使用 Invoke 得到答案的时候……这发生了。这是我的代码：

**主窗体代码：**

```
using System;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;
using System.IO;
using System.Data.OleDb;
using System.Collections.Specialized;
using System.Text;
using System.Threading;

delegate void logAdd(string message);

namespace LCR_ShepherdStaffupdater_1._0
{
    public partial class Main : Form
    {
        public Main()
        {
            InitializeComponent();
        }

        public void add(string message)
        {
            this.Log.Items.Add(message);
        }
        public void logAdd(string message)
        {   /////////////////////////// COMPILER ERROR BELOW ///////////
            this.Invoke(new logAdd(add), new object[] { message }); // Compile error occurs here     
        }////////////////////////////// COMPILER ERROR ABOVE ///////////

        private void exitProgramToolStripMenuItem_Click(object sender, EventArgs e) 
        {
            Application.Exit(); 
        }
        private void aboutToolStripMenuItem1_Click(object sender, EventArgs e)
        {
            Form aboutBox = new AboutBox1(); 
            aboutBox.ShowDialog(); 
        }

        private void settingsToolStripMenuItem_Click(object sender, EventArgs e)
        {
        }

        private void settingsToolStripMenuItem1_Click(object sender, EventArgs e)
        {
            settingsForm.settings.ShowDialog();
        }

        private void synchronize_Click(object sender, EventArgs e)
        {
            string message = "Here my message is"; // changed this
            ErrorLogging.updateLog(message);  // changed this
        }

    }

    public class settingsForm 
    {
        public static Form settings = new Settings();
    }

} 
```

**记录类代码：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace LCR_ShepherdStaffupdater_1._0
{
    public class Logging
    {
        static Main mainClass = new Main();
        static logAdd logAddDelegate;

        public static void updateLog(string message)
        {
            logAddDelegate = mainClass.logAdd;
            logAddDelegate(message);
        }
    }
} 
```

*   **编译错误：**

    *InvalidOperationException 未处理 - 在创建窗口句柄之前，不能对控件调用 Invoke 或 BeginInvoke。*

我已经尝试在 Log 项上创建一个句柄……但这没有用。问题是我不知道我在做什么，我在谷歌上**进行了广泛**的搜索，却发现了模糊的答案。

在我调用这个委托之前，请告诉我如何创建句柄。当你在做的时候，给我一些方法可以让这个代码更简单。例如，我不想要两个 Add 函数……我必须这样做，因为我无法从 Logging 类中找到要调用的项目。有没有更好的方法来完成我需要做的事情？

谢谢！！！

**编辑：**

我的项目相当大，但这些是导致此特定问题的唯一项目。

**Log**是我的 RichTextBox1 (Log.Items.Add(message)) 我将其重命名为 Log，以便重新键入。

我正在从不同的表单调用 updateLog(message) ......让我在这里更新它（尽管我从它调用 updateLog(message) 没有区别仍然给我这个错误）

你们将不得不让事情对我来说更简单......并提供示例。我不明白你们在这里所说的一切......我不知道如何使用方法和句柄的调用。我也研究了它的废话...

**第二次编辑：**

我相信我已经找到了问题，但不知道如何解决它。

在我的日志记录类中，我使用此代码创建 mainClass：

**静态主 mainClass = new Main();**

我正在为 Main() 创建一个全新的蓝图副本，包括**Log**（我正在尝试更新的 Richtextbox）

当我调用 updateLog(message) 时，我相信我正在尝试更新 Main() 的第二个实体上的日志（富文本框），也称为 mainClass。当然，这样做会抛出这个异常，因为我什至没有看到我正在使用的当前 Main 的副本。

这就是我所追求的，感谢其中一位给出答案的人：

```
Main mainClass = Application.OpenForms.OfType<Main>().First();
logAddDelegate = mainClass.logAdd; 
logAddDelegate(message); 
```

我需要不使用 new() 运算符创建 mainClass，因为我不想创建表单的新蓝图，我希望能够编辑当前表单。

上面的代码不起作用，我什至找不到 Application. 这甚至是 C# 语法吗？

如果我能让上面的代码工作，我想我可以解决我的问题，并在几个小时寻求答案后最终解决这个问题。

**最终编辑：**

感谢下面的一位用户，我想通了。这是我更新的代码：

**主窗体代码：**

```
using System;
using System.Drawing;
using System.Collections;
using System.ComponentModel;
using System.Windows.Forms;
using System.Data;
using System.IO;
using System.Data.OleDb;
using System.Collections.Specialized;
using System.Text;
using System.Threading;

delegate void logAdd(string message);

namespace LCR_ShepherdStaffupdater_1._0
{
    public partial class Main : Form
    {
        private static Main mainFormForLogging;
        public static Main MainFormForLogging
        {
            get
            {
                return mainFormForLogging;
            }
        }

        public Main()
        {
            InitializeComponent();
            if (mainFormForLogging == null)
            {
                mainFormForLogging = this;
            }
        }

        public void add(string message)
        {
            this.Log.Items.Add(message);
        }
        public void logAdd(string message)
        {
            this.Log.BeginInvoke(new logAdd(add), new object[] { message });
        }

        private void exitProgramToolStripMenuItem_Click(object sender, EventArgs e) 
        {
            Application.Exit(); 
        }
        private void aboutToolStripMenuItem1_Click(object sender, EventArgs e)
        {
            Form aboutBox = new AboutBox1(); 
            aboutBox.ShowDialog(); 
        }

        private void settingsToolStripMenuItem_Click(object sender, EventArgs e)
        {
        }

        private void settingsToolStripMenuItem1_Click(object sender, EventArgs e)
        {
            settingsForm.settings.ShowDialog();
        }

        private void synchronize_Click(object sender, EventArgs e)
        {
            add("test");
            Logging.updateLog("testthisone");
            //DatabaseHandling.createDataSet();
        }

    }

    public class settingsForm 
    {
        public static Form settings = new Settings();
    }

} 
```

**记录类代码：**

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace LCR_ShepherdStaffupdater_1._0
{
    public class Logging
    {

        static Main mainClass = Main.MainFormForLogging;
        static logAdd logAddDelegate;

        public static void updateLog(string message)
        {
            logAddDelegate = mainClass.logAdd;
            logAddDelegate(message);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T20:47:10.967

我过去使用以下方法解决了这个问题：

```
private void invokeOnFormThread(MethodInvoker method)
{
    if (IsHandleCreated)
         Invoke(new EventHandler(delegate { method(); }));
    else
        method();
} 
```

调用`invokeOnFormThread`而不是调用。如果句柄已经创建，它将只使用表单的线程，否则它将使用调用者的线程。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-04T21:53:04.563

对了，我要重新开始了。

为了了解正在发生的事情，您需要了解 .NET 和 Windows 如何相互关联。.NET 在 Windows 上运行并封装了许多本机的 Win32 概念，例如窗口、列表视图、编辑框（标准文本框的 Win32 名称）。这意味着您可以拥有 TextBox 或 Form 的有效 .NET 实例，但还没有该项目的基础 Windows 版本（EditBox 或 Window）。当 HandleCreated 为 true 时，将创建项目的 Windows 版本。

出现您的问题是因为在创建窗体的窗口之前调用了 logAdd 方法。这意味着在 Form 实例被实例化之后但在 Window 句柄创建之前的启动过程中的某个地方，正在尝试调用 logAdd。如果您向 logAdd 添加断点，您应该能够看到该调用在做什么。您会发现调用是在您在 logger 类中创建的 Main 实例上进行的，而不是在实际运行的 Main 实例上进行的。由于记录器实例从未显示，因此未创建窗口句柄，因此您会收到错误消息。

应用程序运行的一般方式是在您的启动方法中调用 Application.Run(new Main())，该方法通常在 Program 类中并称为 Main。你需要你的记录器指向这个 main 实例。

有几种方法可以获取表单的实例，每种方法都有自己的注意事项，但为简单起见，您可以将实例暴露在 Main 类本身之外。例如：

```
public partial class Main : Form
{
    private static Main mainFormForLogging;
    public static Main MainFormForLogging
    {
        get
        {
            return mainFormForLogging;
        }
    }

    public Main()
    {
        InitializeComponent();

        if (mainFormForLogging == null)
        {
            mainFormForLogging = this;
        }
    }

    protected void Dispose(bool disposing)
    {
         if (disposing)
         {
             if (this == mainFormForLogging)
             {
                mainFormForLogging = null;
             }
         }

         base.Dispose(disposing);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T20:30:50.673

当您收到此错误时，几乎总是意味着您在实际创建控件或表单之前尝试对其进行操作。

在 WinForms 中，GUI 元素有两个半独立的生命：作为内存中的类和作为操作系统中的实体。因此，可以在 .net 中引用尚未实际创建的控件。“正在创建的句柄”是指由操作系统为控件分配一个编号，以允许程序操纵其属性。

在这种情况下，大多数错误可以通过在表单的加载事件结束时设置一个标志来消除，并且仅在设置该标志后才尝试操作表单的控件。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T21:07:44.153

这是运行时错误，而不是编译器错误。

在您可以调用 BeginInvoke 或 Invoke 之前，必须显示您的表单“Main”（因此创建了一个窗口句柄）。

在这些情况下，我通常做的是将它留给 Form 来确定它是否需要使用对 BeginInvoke 或 Invoke 的调用。您可以通过调用 InvokeRequired 来测试它（查看 MSDN）。

所以对于初学者来说，我会去掉 Loggin 类的 updateLog 方法中的 logAddDelegate 调用。只需直接调用表单即可添加日志。像这样：

```
public partial class Main : Form
{
    public Main()
    {
        InitializeComponent();
    }

    private delegate void AddNewLogMessageEventHandler(string message);

    public void AddLogMessage(string message)
    {
        object[] args = new object[1];
        args[0] = message;

        if (InvokeRequired)
            BeginInvoke(new AddNewLogMessageEventHandler(AddLog), args);
        else
            Invoke(new AddNewLogMessageEventHandler(AddLog), args);
    }

    private void AddLog(string message)
    {
        this.Log.Items.Add(message);
    }
 } 
```

}

所以你可以看到，Form 本身负责确定它是否需要异步调用该方法。

但是，这仍然无法修复您的运行时错误，因为您在显示表单之前对其进行了调用。您可以检查表单的句柄是否为空，这至少可以让您验证您是否正在处理有效的表单。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T21:13:39.323

如果您在尚未“显示”的窗口上调用，则往往会发生该错误。您确定您没有在 Logging 类（特别是第一行）中使用您的代码创建主类的第二个实例吗？您调用登录的主要表单可能不是您正在查看的主要表单。如果要检查，请在日志记录调用中添加对“MainClass.Show()”的调用。如果您弹出主表单的第二个副本，那么问题是您的日志记录类没有引用表单的正确“实例”。

将课程视为“蓝图”。类的每个实例（使用单词“new”创建）都是另一个对象，从蓝图创建。仅仅因为两个对象（在这种情况下，您的两个主要表单）共享相同的蓝图，并不意味着您可以互换使用它们。在这种情况下，您已经有一个主表单，并且您想“重用”它。你可以试试：

```
MainClass myMainForm = Application.OpenForms.OfType<MainClass>().First();
logAddDelegate = myMainForm.logAdd; 
logAddDelegate(message); 
```

在您的日志功能中，而不是您当前拥有的。不同之处在于对 Application.OpenForms.OfType().First 的调用将进入您的应用程序，并检索您所看到的 ACTUAL 主表单（从技术上讲，它将检索它的第一个实例）并对其进行调用形式，直接。

希望这可以帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2011-03-02T15:27:28.807

这是为了帮助以防任何其他人遇到此问题。我的问题：VB.net：“在创建窗口句柄之前，不能在控件上调用 Invoke 或 BeginInvoke。” 我关闭了一个表单，该表单具有正在调用以更新委托的事件处理程序，而没有删除该事件的处理程序。

我做了什么：当我关闭表单时，我删除了所有处理程序，并在我打开表单时将它们分配回来。它解决了这个问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T20:35:25.733

> logAddDelegate(消息);

我认为您在引发 Form_Load 事件之前调用它。修复您的代码以在调用 logAddDelegate(...) 之前等待表单加载，即在调用 Logging.updateLog() 之前

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T20:51:31.893

这是您的确切代码吗？您正在调用`this.Log.Items.Add(message);`add(string) 方法，但您的日志记录类称为 Logging，而不是 Log。您是否有另一种名为 Log 的表单？如果在您调用 add 方法时该表单尚未创建，您将收到此异常。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-06-15T05:56:56.033

我发现`InvokeRequired`不可靠，所以我只是使用

```
if (!this.IsHandleCreated)
{
    this.CreateHandle();
} 
```

# javascript - 浏览器中的特殊鼠标事件：滚轮、右键单击？

> ID：513150
> 
> 赞同：1
> 
> 时间：2009-02-04T20:29:55.197
> 
> 标签：javascript, cross-browser, sample, mousewheel, right-click

Google 地图令人印象深刻地展示了您可以使用 JavaScript 和 Ajaxy 做些什么。甚至我的鼠标滚轮和右键单击也可以提供特定的功能。

在标准 HTML 规范中，我看不到`onmouserightclick`鼠标滚轮的事件或类似的基本 JavaScript 处理。也许我在寻找错误的地方。

我认为这些事件是特定于浏览器和平台的（或“敏感”而不是特定的）。我想知道在所有浏览器中利用这些事件需要什么基本的纯 HTML 和 JavaScript。

自然，在设计网站时，这些功能必须是额外的，因为有些人仍然使用一键鼠标。

如何使用鼠标滚轮和右键单击事件？我正在寻找示例代码。

**编辑：**感谢 jQuery 代码的家伙！不过，我的系统开发人员仍然有问题和疑虑。主要是我担心似乎适用于此的平台限制。是否有某些浏览器无法使用这些功能？鼠标滚轮向上和向下事件是否也允许鼠标滚轮单击事件？我只是希望那里会有一些限制，并且想知道它是否有正式记录。我想知道它在低级别是如何工作的。我很高兴看到它在 jQuery 中很容易，这是我进入它的另一个原因。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T21:18:10.110

***鼠标滚轮***：
ol' no-jquery-or-prototype-library 方法：[这里](http://adomas.org/javascript-mouse-wheel/)

原型方法：[这里](http://www.ogonek.net/mousewheel/demo.html)

jQuery方法：[这里](http://www.ogonek.net/mousewheel/jquery-demo.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T20:34:27.607

如果您使用的是 jQuery，则使用右键菜单执行操作非常简单：

```
$(document).bind("contextmenu",function(e){
    alert("You right clicked!");
    return false; //disable the context menu
}); 
```

否则，您可以使用 quirskmode 提供的此脚本： [http ://www.quirksmode.org/js/events_properties.html#link6](http://www.quirksmode.org/js/events_properties.html#link6)

至于鼠标滚轮，这是我过去使用过的一个很棒的脚本：

[http://adomas.org/javascript-mouse-wheel/](http://adomas.org/javascript-mouse-wheel/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T20:33:08.093

你说的是跨浏览器，所以你一定是指 jQuery ：P

[http://www.ogonek.net/mousewheel/jquery-demo.html](http://www.ogonek.net/mousewheel/jquery-demo.html)

[http://abeautifulsite.net/notebook_files/68/demo/](http://abeautifulsite.net/notebook_files/68/demo/)

我敢打赌你可以找到可以做到这一点的 JavaScript，但我认为使用组件（或插件）总是更好，因为它可能有错误（或者可能是跨浏览器错误），并且制作它的人会收到来自某人的电子邮件正在使用它并修复它。使用纯 JavaScript，您始终应该在每个浏览器的每个版本中检查它。

# crystal-reports - 在 Crystal Reports XI 中抑制后向上移动字段

> ID：513153
> 
> 赞同：1
> 
> 时间：2009-02-04T20:30:30.830
> 
> 标签：crystal-reports

有没有人知道如何在压制后向上移动剩余的字段？我在报表的页脚中隐藏了一个数字字段，并希望将其下方的其余字段向上移动，使其看起来不“空白”。

任何和所有的帮助表示赞赏！

联合部队

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T21:56:28.767

将数字字段放在其自己的部分中，然后有条件地抑制该部分。

# mysql - 唯一 varchar 字段与唯一 bigint 的 MySQL 性能

> ID：513157
> 
> 赞同：11
> 
> 时间：2009-02-04T20:30:55.603
> 
> 标签：mysql, database-design

我正在开发一个应用程序，它将实现一个十六进制值作为业务键（除了作为主键的自动增量字段），类似于在 Gmail 中看到的 URL id。我将向列添加一个唯一约束，最初考虑将该值存储为 bigint 以避免搜索 varchar 字段，但想知道如果该字段是唯一的，这是否有必要。

内部连接将使用自动增量字段完成，十六进制值将在 where 子句中用于过滤。

将值简单地存储为 varchar(x)，或者可能是 char(x)，而不是在进行与十六进制之间的转换以将值作为整数存储在数据库中的额外工作上，会有什么样的性能影响？是否值得额外的复杂性？

我对少量行（50k）进行了快速测试，并且搜索结果时间相似。如果存在很大的性能问题，它是线性的还是指数的？

我使用 InnoDB 作为引擎。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T20:59:04.733

你的十六进制值是 GUID 吗？尽管我曾经担心索引等长项的性能，但我发现在现代数据库中，即使是数百万条记录的性能差异也相当微不足道。

一个可能更大的问题是索引消耗的内存（例如，16 字节与 4 字节 int），但在我控制的服务器上，我可以为此分配内存。只要索引可以在内存中，我发现其他操作的开销更大，索引元素的大小不会产生明显的差异。

On the upside, if you use a GUID you gain server independence for records created and more flexibility in merging data on multiple servers (which is something I care about, as our system aggregates data from child systems).

There is a graph on this article that seems to back up my suspicion: [Myths, GUID vs Autoincrement](http://krow.livejournal.com/497839.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T22:02:00.567

十六进制值是从 UUID（Java 的实现）生成的；它被散列并截断为更小的长度（可能是 16 个字符）。仍在讨论中的算法（当前为 SHA）。我看到将值存储在十六进制与整数中的一个优点是，如果我们需要增加大小（我没有看到这个应用程序在 16 字符时发生这种情况），我们可以简单地增加截断长度并保留旧值而不必担心的碰撞。转换为整数值不会那么好。

截断与仅使用 GUID/UUID 的原因只是为了使 URL 和 API（将在其中使用它们）更友好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T09:46:03.670

在其他条件相同的情况下，保持数据更小将使其运行得更快。主要是因为它会占用更少的空间，所以更少的磁盘 i/o，更少的内存需要保存索引等等。50k 行不足以注意到这一点......

# sql - MSSQL: How do you script Stored Procedure creation with code?

> ID：513158
> 
> 赞同：4
> 
> 时间：2009-02-04T20:31:05.693
> 
> 标签：sql, sql-server, tsql, stored-procedures, information-schema

I am trying to query for a list of stored procedure definitions using information_schema.routines that exist in one database but not in another.

```
SELECT 
    t1.Routine_Definition
FROM
    [server1].MyDatabase.INFORMATION_SCHEMA.Routines t1 
LEFT JOIN
    [server2].MyDatabase.INFORMATION_SCHEMA.Routines t2 ON t1.Routine_Name = t2.Routine_Name
WHERE
    t2.Routine_Name is null 
```

This gives me the query definitions in a single line so when I have a comment like this

```
--Some comment
SELECT Column
FROM Somewhere 
```

The SQL gets commented out and I cannot use the definition to create the SP.

How to I parse this back with the proper line breaks?
or
Is there a better way to get these scripts (using code)?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T20:40:41.043

The stored procedure is only displayed on one line in Management Studio. If you run the query with results to text, **or** use the following, you will get the correct line breaks:

```
declare @sql varchar(8000) -- varchar(max) in SQL 2005+

SELECT 
        @sql = t1.Routine_Definition
FROM
        INFORMATION_SCHEMA.Routines t1 

print @sql 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T20:58:36.107

```
DECLARE MY_CURSOR Cursor
FOR

SELECT 
        t1.Routine_Definition
FROM
        [server1].MyDatabase.INFORMATION_SCHEMA.Routines t1 
LEFT JOIN
        [server2].MyDatabase.INFORMATION_SCHEMA.Routines t2 ON t1.Routine_Name = t2.Routine_Name
WHERE
        t2.Routine_Name is null AND
        LEN(t1.Routine_Definition) < 4000

Open My_Cursor
DECLARE @sql VARCHAR(MAX) 

FETCH NEXT FROM MY_Cursor INTO @sql
While (@@FETCH_STATUS <> -1)
BEGIN
IF (@@FETCH_STATUS <> -2)

Print @sql

FETCH NEXT FROM MY_CURSOR INTO @sql
END
CLOSE MY_CURSOR
DEALLOCATE MY_CURSOR
GO 
```

Here is how I implemented ck's solution...

the INFORMATION_SCHEMA view only returns the first 4000 characters in the definition. (Ideally you wont have SP that are that long)You will want to script those manually or some other way.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-04T20:33:41.680

I think the easiest way of getting your stored procedures is to use the Import/Export utility that is built into SQL Server Management Studio. From there you can export your Stored Procedure Objects into the code window or to a file that you can immediately run.

# php - 纯基于 Web 的版本控制系统

> ID：513173
> 
> 赞同：2
> 
> 时间：2009-02-04T20:34:13.490
> 
> 标签：php, python, version-control, web-applications

我的托管服务目前没有在他们的服务器上运行/允许 svn、git、cvs。我真的希望能够将我的开发机器上的当前源与我的生产服务器“同步”。

我正在寻找一个**纯 php/python/ruby 版本控制系统**（不仅仅是版本控制系统的*客户端*），它不需要在服务器机器上运行任何服务，可以使用 http 接口上传/下载和同步的东西文件 - 基本上为我的“实时”站点提供后端以进行版本控制。

此外，我认为这样的系统很容易开发一个“在线”ide，这样我就可以直接在生产服务器上开发。（当然测试问题除外）

有谁知道这样的系统是否存在？

==编辑==

真的，我想要一个用于版本控制/开发系统的 wiki 前端 - 基本上看起来像一个 wiki 并编辑开发文件，以便我可以轻松地通过 Web 进行更改和回滚更改。我怀疑这是否存在，但扩展现有的 svn php 端口会很容易......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T20:45:06.337

获得更好的托管服务。严重地。即使你找到了在 PHP/Ruby/Perl/Whatever 中工作的东西，它仍然是一个低于标准的解决方案。它很可能不会与您拥有的任何 IDE 集成，并且没有可用于使用它的良好工具集。正确地做真的很笨拙。

另一种选择是获得免费的 SVN 主机，或在您自己的机器上托管 SVN，然后只需通过 ftp 从您的 SVN 主机推送更新到您的网站。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T20:59:22.893

不要在您的 Web 服务器上托管您的存储库。从您的服务器部署到 ftp/sftp - 随便。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T20:41:30.387

您可以查看[mercurial](http://www.selenic.com/mercurial/wiki/)或[bazaar-ng](http://bazaar-vcs.org/)，它们都是用 python 编写的，并且至少支持 http 下载 afaik，不是真正基于 Web 的，但如果标签正确，则使用您的主机支持的一种语言编写。高温高压

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T21:10:53.510

我认为这实际上是一个非常好的主意，但不要相信这样的版本控制系统存在（还）所以希望你会继续做一个。

我认为调整现有解决方案并不容易，但可能值得研究一下，因为如果您使用现有解决方案，您将完成所有客户端支持，并解决大多数版本控制困难。

从头开始并非易事。

-亚当

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-05T13:52:10.787

使用集市：

> 轻的。不需要安装 Bazaar 的专用服务器，只需通过 FTP 访问 Web 服务器。智能服务器可用于那些需要额外性能或安全性的人，但在许多情况下不需要它 - Bazaar 1.x 优于普通 http 性能良好。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T20:47:51.667

[Mercurial](http://www.selenic.com/mercurial/)有一个网络界面，允许通过 http 提交。它使用了几个 C 扩展，但我猜它们都有纯 Python 的对应物。

当您的主机提供时，您也可以只使用 WebDAV。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-04T23:34:14.703

你为什么不想要一个客户..？一个简单的客户端，您可以在生产机器上运行，然后同步到在某处另一台服务器上运行的存储库。

SVN 可通过 HTTP 使用，因此在 python 或 php 中编写能够同步代码的客户端非常容易。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-04T20:48:38.547

你可以尝试相反的方式

*   使用例如免费的在线 svn/git 服务来控制您的开发机器上的源代码
*   使用通常的方法来更新“生产”机器又名站点，例如 FTP

# android - 当您在 Eclipse 中使用堆栈中的 SDK 类获得堆栈跟踪时，您如何查看 SDK 源代码？

> ID：513177
> 
> 赞同：6
> 
> 时间：2009-02-04T20:34:40.320
> 
> 标签：android, eclipse

当您使用 Eclipse 插件和调试器开发 Android 应用程序并获得堆栈跟踪时，您将看不到任何 SDK 源代码。您需要采取哪些步骤来解决此问题？假设初学者 Java 程序员。

澄清一下，我希望 Eclipse 在我跳入堆栈帧时自动向我显示正确的源文件和行。我假设我需要找到正确的 SDK 源，将它们放在我的本地系统上，然后告诉 Eclipse 如何查找和使用它们。问题是，我究竟如何执行这些步骤。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T06:17:54.840

感谢#android IRC 频道上的lukehutch，我得到了一篇描述如何解决问题的[博客文章。](http://blog.michael-forster.de/2008/12/view-android-source-code-in-eclipse.html)

这甚至是一个问题的原因是因为谷歌没有在 SDK 中包含源代码。有一个[错误](http://code.google.com/p/android/issues/detail?id=1142)可以解决这个问题。

解决方法，如博客文章中更详细描述的那样，是[使用 git 获取源代码](http://source.android.com/download/)（我为 repo 命令指定了 release-1.0 分支，我希望与 SDK 1.0-r2 对应），收集所有 java 源文件并放置它们在sources/目录下的正确目录结构中（它就在SDK中你的android.jar旁边），然后在Eclipse中刷新jar，此时你可以浏览SDK类的源代码。

最后，在调试器中运行您的应用程序，直到您从 SDK 类获得堆栈跟踪，您将看到一个用于配置源的按钮：添加您创建的源目录。

上面的博客链接有一个小的 Python 脚本，可以收集所有 java 文件并从中创建正确的目录结构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T02:09:13.890

如果您在 Eclipse 中查看启动配置（Debug->Run as...），您将看到一个名为“sources”的选项卡

如果您选择“添加”，然后提供包含相关源的存档或文件系统目录，则调试器应该允许您跟踪它们。

您可以从 Android 站点获取 SDK 的源代码，只需确保您的 Jar 和源代码版本相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2011-09-02T05:57:07.903

一些好心人现在已经在 Google 代码项目中放置了源 zip（最高 2.3.3），所以只需这样做：

```
cd path\to\android-sdk\platforms
svn checkout http://fanfq-android-demo.googlecode.com/svn/trunk/android-sdk-src/ . 
```

然后，进入 Eclipse，然后：

*   单击一个 SDK 类并按 F3
*   单击“附加源”按钮 > 外部文件
*   选择路径\to\android-sdk\platforms\android-xxx-y-src.zip

现在，在任何 Android 类以及调试器等中按 F3 时，您应该可以看到源代码。

# opengl - 在 OpenGL 中选择构面的最简单方法是什么？

> ID：513188
> 
> 赞同：0
> 
> 时间：2009-02-04T20:36:05.497
> 
> 标签：opengl

我想找出 OpenGL 应用程序中鼠标光标下的哪个方面。使用选择缓冲区对我来说似乎很不准确。还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T21:15:57.617

使用光线相交手动完成。使用您的相机矩阵（如果不明确，您可以从 OpenGL 中查询它），使用它在世界空间中生成拾取射线，并查看它是否与您的特定面部相交。根据深度 (t) 对交叉点进行排序，您将在光标下找到最近的面。

根据您的数据结构（层次结构等）和大小，这可能非常缓慢或非常有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T20:57:08.747

一个常见的技巧是用不同的颜色（简单地从 0x000001 到 n）绘制每个面，并在屏幕外渲染并获取鼠标点下的颜色。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T12:32:32.337

另请查看 OpenGL 常见问题解答的[这一部分](http://www.opengl.org/resources/faq/technical/selection.htm)。

# visual-studio-2008 - 有没有办法在每个解决方案或每个项目的基础上设置 Visual Studio 2008 构建详细程度？

> ID：513191
> 
> 赞同：0
> 
> 时间：2009-02-04T20:36:54.107
> 
> 标签：visual-studio-2008, msbuild

我通常会同时打开多个解决方案，手动更改 MSBuild 详细程度已成为一项真正的苦差事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T20:43:41.787

我不知道如何在每个项目中使用 Visual Studio（或者如果可能的话），但是如果您使用 Cruise Control（或任何构建工具），您可以即时修改配置文件并使用 CC 中的构建日志。这就是我为完全相同的场景所做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-09-25T05:15:43.350

您可以编写自己的构建工具（是的，我知道您肯定已经想到它并且正在寻找开箱即用的解决方案！！:-)）。我们这样做是为了处理构建输出并以非交错方式显示它......

行首的数字标识了项目（如果这对您来说已经很清楚但可能对其他人有所帮助，请原谅我）。因此，它很容易解析和重新分发，调整详细程度，然后您可以设置参数甚至修改其中涉及的项目 (XML) 的部分。

这将是有益的，因为您随后将能够添加一些检查，例如所有设置是否相互兼容，例如 wchar_t 作为本机类型或异常处理形式（如果您在一个大团队中工作并且有些人在其中调整内容时很有用错误的方法）

然后，您还可以使用它在持续集成服务器下构建，生成的日志将更易于阅读......

# wcf - WCF REST 参数不能包含句点？

> ID：513201
> 
> 赞同：5
> 
> 时间：2009-02-04T20:39:46.927
> 
> 标签：wcf, rest, .net-3.5

所以这里有一个超级简单的接口，用于在 WCF 中进行休息。

```
 [ServiceContract]
    public interface IRestTest
    {
        [OperationContract]
        [WebGet(UriTemplate="Operation/{value}")]
        System.IO.Stream Operation(string value);
    } 
```

它工作得很好，直到我尝试传递一个带有句点的字符串，例如 DNS 名称......我从 asp.net 得到一个 404。

更改 UriTemplate 以将参数粘贴到查询字符串中会使问题消失。其他人看到这个或有解决方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-06T03:36:07.893

确实，路径部分不能包含句点或许多其他特殊字符。不久前我遇到了同样的问题，并收到了 TechNet 团队的答复，指出查询字符串是您可以找到的唯一选择。对不起

[http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/d03c8331-1e98-4d5d-82a7-390942a93012/](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/d03c8331-1e98-4d5d-82a7-390942a93012/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T18:30:55.530

我有一项几乎完全一致的服务。我可以传递带有“。”的值。在名字里。例如，这适用于我的：

```
[OperationContract]
[WebGet(UriTemplate = "category/{id}")]
string category(string id); 
```

使用 url，`http://localhost/MyService.svc/category/test.category`我得到作为字符串值传入的值“test.category”。

所以肯定还有别的问题。你是如何访问 URL 的？直接在浏览器中？还是通过 javascript 调用？只是想知道这是否是客户端的一些错误。服务器传递值就好了。我建议尝试在您的浏览器中访问该 url，如果它不起作用，请准确发布您使用的 URL 以及错误消息是什么。

另外，您使用的是 WCF 3.5 SP1 还是仅使用 WCF 3.5？在我正在阅读的 RESTFul .Net 书中，我看到 UriTemplate 发生了一些变化。

最后，我从 RESTFul .Net 书籍中修改了一个简单的服务，并且我得到了正确的响应。

```
class Program
{
    static void Main(string[] args)
    {
        var binding = new WebHttpBinding();
        var sh = new WebServiceHost(typeof(TestService));
        sh.AddServiceEndpoint(typeof(TestService),
            binding,
            "http://localhost:8889/TestHttp");
        sh.Open();
        Console.WriteLine("Simple HTTP Service Listening");
        Console.WriteLine("Press enter to stop service");
        Console.ReadLine();
    }
}

[ServiceContract]
public class TestService
{
    [OperationContract]
    [WebGet(UriTemplate = "category/{id}")]
    public string category(string id)
    {
        return "got '" + id + "'";
    }   
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-05-29T00:14:36.093

这是一个示例 HttpModule，它修复了 REST 参数中出现的“句点”。请注意，我只在开发服务器（又名 Cassini）中看到过这种情况，在 IIS7 中，它似乎可以在没有这种“hack”的情况下工作。我在下面包含的示例也替换了我从这个答案改编的文件扩展名“.svc”。[如何删除 RESTful WCF 服务中的“.svc”扩展名？](https://stackoverflow.com/questions/355165/how-to-remove-thie-svc-extension-in-restful-wcf-service)

```
public class RestModule : IHttpModule
{
    public void Dispose()
    {
    }

    public void Init(HttpApplication context)
    {
        context.BeginRequest +=
            delegate
            {
                HttpContext ctx = HttpContext.Current;
                string path = ctx.Request.AppRelativeCurrentExecutionFilePath;

                int i = path.IndexOf('/', 2);
                if (i > 0)
                {
                    int j = path.IndexOf(".svc", 2);
                    if (j < 0)
                    {
                        RewritePath(ctx, path, i, ".svc");
                    }
                    else
                    {
                        RewritePath(ctx, path, j + 4, "");
                    }
                }
            };
    }

    private void RewritePath(HttpContext ctx, string path, int index, string suffix)
    {
        string svc = path.Substring(0, index) + suffix;
        string rest = path.Substring(index);
        if (!rest.EndsWith(ctx.Request.PathInfo))
        {
            rest += ctx.Request.PathInfo;
        }
        string qs = ctx.Request.QueryString.ToString();
        ctx.RewritePath(svc, rest, qs, false);
    }
} 
```

# c# - 如何在 Silverlight 中序列化派生类

> ID：513215
> 
> 赞同：2
> 
> 时间：2009-02-04T20:42:52.223
> 
> 标签：c#, .net, silverlight, json, serialization

我在 XAML 中创建了一个自定义控件，并添加了一些自定义属性。现在，如果可能，我想将其序列化为 JSON。这是（基本上）我所拥有的：

```
public partial class MyCustomClass : UserControl
{
    public Dictionary<char, int[]> ValueMap;
    public int Value { get; set; }
} 
```

在处理序列化的代码中：

```
public static string Serialize(object objectToSerialize)
{
    using (MemoryStream ms = new MemoryStream())
    {
        DataContractJsonSerializer serializer = 
          new DataContractJsonSerializer(objectToSerialize.GetType());
        serializer.WriteObject(ms, objectToSerialize);
        ms.Position = 0;
        using (StreamReader reader = new StreamReader(ms)) 
          return reader.ReadToEnd();
    }
} 
```

然而，`serializer.WriteObject(ms, objectToSerialize);`抛出

`System.Runtime.Serialization.InvalidDataContractException`：

> 考虑使用 DataContractAttribute 属性对其进行标记，并使用 DataMemberAttribute 属性标记您想要序列化的所有成员。或者，您可以确保该类型是公共的并且具有无参数的构造函数——然后该类型的所有公共成员都将被序列化，并且不需要任何属性。”

现在，当我将这些属性添加到 时`MyCustomClass`，我当然会得到相同的异常，只是这次是 for`System.Windows.UIElement`而不是`MyCustomClass`.

那么，有没有办法用现有的序列化方法序列化我的自定义派生类，或者我应该只编写一个自定义序列化方法`MyCustomClass`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T04:39:38.860

我认为你最好在这里实现 IXmlSerializable ，因为你真的不想不加选择地序列化基类中的所有内容（坦率地说，我不相信你可以）。

相反，在 MyCustomClass 上实现 IXmlSerializable，然后 DataContractJsonSerializer 将能够使用该实现来序列化到 JSON 或从 JSON 序列化。

# c# - 验证函数参数？

> ID：513216
> 
> 赞同：6
> 
> 时间：2009-02-04T20:42:54.547
> 
> 标签：c#, validation, function, parameters, arguments

我会定期验证我的函数参数：

```
 public static void Function(int i, string s)
{
  Debug.Assert(i > 0);
  Debug.Assert(s != null);
  Debug.Assert(s.length > 0);
} 
```

当然，检查在函数的上下文中是“有效的”。

这是常见的行业惯例吗？关于函数参数验证的常见做法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T20:53:55.337

如果值无效或稍后将导致异常，则可接受的做法如下：

```
if( i < 0 )
   throw new ArgumentOutOfRangeException("i", "parameter i must be greater than 0");

if( string.IsNullOrEmpty(s) )
   throw new ArgumentNullException("s","the paramater s needs to be set ..."); 
```

所以基本参数异常列表如下：

```
参数异常
参数NullException
参数OutOfRangeException

```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T20:59:38.180

您所写的是**先决条件**，也是**按合同设计**的基本要素。谷歌（或“StackOverflow”:) 这个词，你会发现很多关于它的好信息，也有一些不好的信息。请注意，该方法还包括**后置条件**和**类不变量**的概念。

让我们明确一点，断言是一种有效的机制。

当然，它们通常（[并非总是](https://stackoverflow.com/questions/17732/when-should-assertions-stay-in-production-code)）*不会*在发布模式下检查，因此这意味着您必须在发布代码之前对其进行测试。

如果断言保持启用并且断言被违反，则在某些使用断言的语言中（尤其是在 Eiffel 中）的标准行为是抛出断言违反异常。

如果您要发布代码库，那么未经检查的断言*不是一种方便或可取的机制，也不是（显然）验证直接可能不正确的输入的方法。*如果您有“可能不正确的输入”，则必须将输入验证*层*设计为程序正常行为的一部分；但是您仍然可以在内部模块中自由使用断言。

* * *

其他语言，如 Java，有更多**显式检查参数并在错误时抛出异常**的传统，主要是因为这些语言没有强大的“断言”或“契约式设计”传统。

（对某些人来说可能看起来很奇怪，但我发现传统上的差异是值得尊重的，不一定是邪恶的。）

另请参阅[此相关问题](https://stackoverflow.com/questions/117171/design-by-contract-tests-by-assert-or-by-exception)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T20:53:13.683

您不应该使用断言来验证实时应用程序中的数据。据我了解，断言旨在测试该功能是否以正确的方式使用。或者该函数正在返回正确的值，即您得到的值是您所期望的。它们在测试框架中被大量使用。它们应该在系统部署时关闭，因为它们很慢。如果您想处理无效案件，您应该按照上面提到的海报明确地这样做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T20:53:50.393

任何可通过网络或进程间通信调用的代码都必须具有参数验证，否则它是一个安全漏洞 - 但您必须抛出异常 Debug.Assert 不会这样做，因为它只检查调试版本。

您团队中其他人将使用的任何代码也应该具有参数验证，因为这将帮助他们在他们向您传递无效值时知道这是他们的错误，这次您应该再次抛出异常，因为您可以添加一个很好的描述例外，并解释他们做错了什么以及如何解决它。

函数中的 Debug.Assert 只是为了帮助您进行调试，它是一个很好的第一道防线，但它不是“真正的”验证。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T21:00:07.180

对于*公共*函数，尤其是 API 调用，您应该抛出异常。消费者可能会很高兴知道他们的代码中存在错误，并且有保证的方法是例外。

对于内部或私有函数，Debug.Assert 很好（但不是必需的，IMO）。您不会接受未知参数，并且您的测试应该通过预期输出捕获任何无效值。但是，有时，Debug.Assert 会让您更快地发现错误或防止错误。

对于不是 API 调用的公共函数，或受其他人调用它们的内部方法，您可以采用任何一种方式。我通常更喜欢公共方法的异常，并且（通常）让内部方法没有异常。如果内部方法特别容易被误用，则需要例外。

当您想要验证参数时，您不希望 4 个级别的验证必须保持同步（并为此支付性能损失）。因此，在外部接口上进行验证，并相信您和您的同事能够适当地调用函数和/或修复不可避免的错误。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T20:51:07.620

大多数时候我不使用Debug.Assert，我会做这样的事情。

```
public static void Function(int i, string s)
{
  if (i > 0 || !String.IsNullOrEmpty(s))
         Throw New ArgumentException("blah blah");
} 
```

警告：这是空气代码，我还没有测试过。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T21:01:27.083

您应该使用 Assert 来验证程序假设；也就是说，对于这种情况

1.  你是唯一一个调用那个方法的人
2.  应该是不可能进入的状态

Assert 语句将允许您仔细检查是否永远不会达到不可能的状态。在没有验证的情况下您会感到舒服的地方使用它。

对于为函数提供错误参数的情况，但您可以看到它并非不可能接收这些值（例如，当其他人可以调用该代码时），您应该抛出异常（例如[@Nathan W](https://stackoverflow.com/questions/513216/validating-function-arguments/513268#513268)和[@Robert Paulson](https://stackoverflow.com/questions/513216/validating-function-arguments/513284#513284)）或优雅地失败（a la [@Srdjan Pejic](https://stackoverflow.com/questions/513216/validating-function-arguments/513250#513250)）。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2009-02-04T20:47:46.613

我尽量不使用 Debug.Assert，而是写守卫。如果函数参数不是预期值，我退出函数。像这样：

```
public static void Function(int i, string s)
{
    if(i <= 0)
    {
        /*exit and warn calling code */
    }
} 
```

我发现这减少了需要发生的争吵。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2009-02-04T20:47:32.463

我不会谈论行业标准，但您可以将底部的两个断言组合成一行：

```
Debug.Assert(!String.IsNullOrEmpty(s)); 
```

# internet-explorer-6 - 为什么这个网页会导致 IE6 锁定？

> ID：513227
> 
> 赞同：0
> 
> 时间：2009-02-04T20:44:35.310
> 
> 标签：internet-explorer-6

我难住了。据我们所知，此页面没有任何问题，并且在其他任何地方（IE7/IE8、FireFox、Opera、Safari 等）都呈现良好。问题是如果它在 Windows XP SP3 的 IE6 中加载，它只会锁定浏览器，并且在大多数情况下必须通过任务管理器强制关闭。我们的一些测试计算机可以很好地加载它，但其他一些只是像加入了邪教并喝了酒一样死了。我们正在竭尽全力试图找出问题所在，甚至找出它工作或不工作的计算机有什么特别之处。有什么想法吗？

[http://www.centerforsight.net/doctors-staff/providerDisplay.cfm?staID=8](http://www.centerforsight.net/doctors-staff/providerDisplay.cfm?staID=8)

诸如“你为什么使用 ColdFusion”或“因为 IE6 很烂”之类的回答对我没有帮助。在可预见的未来，我们的客户仍坚持使用 IE6，并且需要他们的网站在该版本中运行。但是，非常感谢对实际问题的任何见解。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T20:52:10.410

听起来 JS 文件中的某些内容在 IE 上被锁定为无限循环。为什么不尝试将警报放入被调用的 JS 函数中，以尝试隔离锁定浏览器的代码。

IE 的 JS 引擎充满了 bug，你可能发现了一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T20:55:14.320

尝试在[IE Tester](http://www.my-debugbar.com/wiki/IETester/HomePage)中加载它，看看它是否提供任何线索。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T21:20:17.467

使用 Firefox 在本地计算机上保存页面的副本。加载页面 IE 6，它挂起吗？如果不是，找出什么 Firefox 没有加载，如果是，则开始从页面中删除内容。开始一一删除脚本标签，直到阻止它崩溃，当您找到特定问题时，请尝试重新发布问题以获得有关如何解决 JS 问题的更好答案:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T21:16:09.677

他们有最新版本的 IE6 吗？他们最近是否运行过 Windows 更新？也许在补丁或服务包中修复了一些模糊的错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T20:54:20.750

也许它与Javascript代码有关。毫无疑问，IE6 的引擎设计不如其他浏览器好。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T20:56:07.533

它要么是 javascript，要么正在等待从缓冲区中转储信息。如果整个页面加载在一个巨大的 blob 中并被发送（并且有很多内容），它也可能压倒 IE 并将其锁定。（或至少将其锁定直到呈现 glob）

# delphi - 可以模仿 Firefox 的“附加组件|扩展列表”的 Delphi 控件？

> ID：513229
> 
> 赞同：6
> 
> 时间：2009-02-04T20:44:45.947
> 
> 标签：delphi, user-interface, firefox, controls

我的目标是在我的应用程序中更新 GUI 的外观。目前我的 GUI 包含许多列表框，用于以老式方式编辑某些对象，即用户双击一个项目并显示一个对话框来修改相应的对象。

我认为一个很好的现代方法是 Firefox 如何显示已安装的扩展（下面的快照）。

我的问题是关于如何在 Delphi(win32) 中轻松构建这样的 GUI？您是否使用任何组件来模仿这种行为，或者我只需要使用面板从stratch 对此进行编码？（我想避免 IMO 一项非常繁琐的工作 - 选择逻辑、调整大小等......）

[![替代文字](https://i.stack.imgur.com/TTLW9.png)](https://i.stack.imgur.com/TTLW9.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-05T12:43:00.240

您可以使用标准组件执行类似（不完全）的操作；TDBCtrlGrid，TSpeedButton，...

[替代文字 http://img8.imageshack.us/img8/9585/imagen29ox3.png](http://img8.imageshack.us/img8/9585/imagen29ox3.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T21:15:17.277

如果您使用的是 Delphi 2007 或 Delphi 2009，您也许可以使用 TCategoryButtons（来自“附加”组件面板页面）执行类似的操作。将其放在表单上并右键单击以显示弹出菜单，然后单击“类别编辑器...”。使用结果对话框添加一个类别，设置它的标题，并可选择设置它包含的项目。不完全相同，但它可能会满足您的需求。

您还可以使用带有 TTreeView（如果您有对象类别）或 TListView 的对话框来模拟 Delphi 2007 Projects->Options 对话框。单击 TreeView 或 ListView 中的项目会显示 TPageControl 的正确页面以配置对象。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T20:55:22.480

为每个列表项使用 TFrame 并将它们全部对齐顶部放在 TScrollBox 上可能会起作用。另请参阅 TDBCtrlGrid，它结合数据集执行类似操作。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T21:12:27.437

可以使用现有的 Delphi 控件来完成。

例如，在*TCustomListBox*控件中，您可以创建自己的**OnDrawItem**事件来绘制自己的列表项。您还需要创建自己的**OnMeasureItem**来更改项目高度。

在某些情况下，它非常有限，所以如果你想要更多的自由，你需要从头开始。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T22:38:43.770

我基本同意 Lars，但我会为每个项目使用框架而不是面板。这将分离到它自己的文件中，并且您将获得对它的简单设计时支持。

# usability - 正式表达可用性要求的最佳方式是什么？

> ID：513230
> 
> 赞同：11
> 
> 时间：2009-02-04T20:45:00.223
> 
> 标签：usability, requirements, hci

我正在编写系统需求文档，需要包含与系统可用性相关的非功能性需求，但我不确定表达这一点的最佳方式。

“系统应易于使用”对我来说似乎有点模糊，不可测试。是否有任何与程序可用性相关的“官方”标准/指南可以遵守？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-04T20:55:16.503

通常，我们会尝试制定一个特定于应用程序的“易于使用”的定义。例如，对于我们当前的项目，易于使用意味着：

- 系统中所有超过 0.5 秒的延迟都会产生一个对话框，上面写着“请稍候”。

- 只需单击 3 次，即可从主窗口访问任何给定的系统功能。

- 无需鼠标，只需键盘即可完成任何给定任务。

- 系统中的所有按钮都将遵守已建立的按钮约定（链接到已建立的关于大小、命名、位置等的按钮约定）

- 所有屏幕都有一个帮助按钮。给定屏幕上的每个帮助按钮必须为屏幕上的每个控件提供至少一个“主题”。

-ETC。

这些东西是可测试的，并且综合起来，构成了一个“相当不错”的可用性标准。也就是说，没有什么可以替代实际用户的尝试。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T20:59:07.713

可用性要求很难，因为了解您的系统是否可用的唯一方法是让真实用户试用。你怎么知道你的要求是否得到满足？为此，您需要正式的可用性指标。这些指标必须以某种方式从可用性测试的结果中提取出来，如果你将可用性测试抽象到你只是得到指标的地步，你就错过了它的用处。

诸如“必须能够通过 Y 多次点击完成 X”或“系统必须在 Z 毫秒或更短的时间内响应”这样的项目很有用，但它们实际上是与可用性有关的功能要求，而不是可用性要求本身。很有可能（如果不可能的话）您可以设计和实现一个满足所有这些正式要求但仍然让用户感到沮丧的系统。同样，知道的唯一方法是通过可用性测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T21:10:37.003

好吧，“系统应该易于使用”正是那种让设计人员和开发人员都感到沮丧的文档，所以让我们看看我们是否可以做得更好一点，好吗？:)

首先，您可能会发现坐下来准确想象目标用户是谁很有帮助。给他们一个背景，给他们一点颜色，然后将它们发送到你想象的应用程序中，并尝试弄清楚他们作为个人想要如何与之交互。

请记住，不同的用户关注可用性的不同方面。如果您使用该应用程序，不要只专注于您认为会遵循的故事*路径*。

接下来，将站点分解为可用性组件可能会有所帮助。它有很多图片吗？如果是这样，向用户呈现大量图片的最佳方式是什么。它有深度嵌套的菜单结构吗？是否有比站点树更好的方法来帮助您的用户导航？可用性设计模式将在这里为您提供帮助。可以在[此处](http://www.welie.com/patterns/)和[此处](http://developer.yahoo.com/ypatterns/)找到有关可用性设计模式的良好资源。设计模式很好，因为它们清楚地向所有相关人员解释了某些功能应该如何工作。

花点时间考虑可访问性和可用性。网站如何在关闭 javascript 的情况下工作始终是一个很好的起点，对于那些往往厌倦了看着他们的设计师`<a>`在需要提交表单的页面上粘贴另一个链接的开发人员来说，这将是一个很大的帮助.

请记住，可用性与清晰度有关，它始于与构建系统的人员进行清晰的沟通。如果您不能清楚地说明您想要构建什么，您如何期望开发人员构建一些功能性的东西？如果需要，请花额外的时间来制作原型。

我的回复可能有点过于“网络”，对您没有太大用处，但我希望它在我的咆哮中提供一些有用的花絮。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T21:13:53.207

**指标和用例。**

我们有许多角色来封装我们不同的客户类型。

我们有用户超级用户（乔治，他是个书呆子，大学类型），非技术人员（弗兰克，他几乎不会使用计算器）和介于两者之间的人（苏西，她知道如何上网并且可以与技术人员交谈支持但不要问她emacs是什么）。

基于此，我们说：

*   对于功能 X，George 应该能够在不使用帮助或暂停超过几秒钟的情况下访问它，Suzie 可能需要查看帮助但可能不会，如果 Frank 这样做更好，因为他没有有很大的耐心。

现在，对于指标，我们还有可用性研究指南，比如 10 个人中，有 8 个人应该能够在不查看帮助的情况下访问功能 Y，或者能够在 30 秒内完成。

这些确实是主观的，但它可能会帮助您朝着正确的方向前进。另外，它可以帮助您与“只希望它工作并且简单”的非开发人员类型交谈。

阅读 Joel 关于软件的文章也不会有什么坏处。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-06T22:31:41.377

我能找到的在需求文档中包含可用性需求的最明确的方法是：制作大量的屏幕模型（并将它们与所执行操作的“流程”联系起来，例如通过在 image1 的一个项目中添加一个箭头到 image2 等相关的下一项）。如果人们真正看到了某些东西应该如何工作，那么它会更容易理解并且解释的空间更少。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T20:55:50.717

[这](http://library.gnome.org/devel/hig-book/stable/)是 GNOME 关于人机交互的文档。这旨在作为*如何*指定的示例，而不是指定*什么*（因为我不同意他们在那里所说的一切）。

# c# - .NET 中的良好 zlib 实现？

> ID：513234
> 
> 赞同：8
> 
> 时间：2009-02-04T20:45:58.473
> 
> 标签：c#, .net, zlib

我正在构建一个网络应用程序，它需要能够从正常的网络流量切换到[zlib](http://zlib.net/)压缩流、中间流。我对此事的想法涉及布尔开关，当打开时将导致网络代码通过我可以输入的类传递所有数据`IEnumerable<byte>`，然后提取解压缩的流，将其传递给已经存在的协议解析代码。

我看过的东西：

*   [ZLib.NET](http://www.componentace.com/zlib_.NET.htm) - 看起来有点……不拘一格，并不是我想要的。尽管如此，仍然会是一个不错的开始。（[Jon Skeet 在这里的评论](https://stackoverflow.com/questions/185690/how-to-inflate-a-file-with-zlib-net/185736#185736)也几乎没有启发我。）
*   [SharpZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/) - 这似乎根本不支持 zlib？任何人都可以确认或否认这一点吗？

我非常喜欢所有托管解决方案，但让我们来看看......在.NET中是否有这个库的任何其他实现，这可能更适合我想要做的事情，或者我应该使用ZLib。 NET 并以此为起点？

**PS：**

乔恩要求提供更多细节，所以就在这里。

我正在尝试实施[MCCP 2](http://mccp.smaugmuds.org/protocol.html)。这涉及到在网络流中发送的信号，并且该信号之后的所有内容都是 zlib 压缩数据流。在上面的链接中有指向它们的确切含义的链接。无论如何，要清楚，我在这个（客户端，而不是服务器）的接收端，我已经从网络流中读取了一堆数据，并且切换将在这个中间（总共至少可能），因此任何解决方案都需要能够在接管 NetworkStream 之前将一些额外的数据输入其中（或者我手动输入其余数据）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T20:56:42.103

SharpZipLib 确实支持 ZLib。查看[常见问题解答](https://github.com/icsharpcode/SharpZipLib/wiki/FAQ)。

此外，您是否检查过 System.IO.Compression 命名空间是否支持您需要的内容？

虽然我不会使用`IEnumerable<byte>`- 流被设计为链接在一起。

编辑：好的......听起来你需要一个支持缓冲的流，但控制比`BufferedStream`提供更多。如果您看到解压缩切换，则需要“倒带”流，然后在其上创建 GZipStream。您的缓冲区至少需要与您对 Read() 的最大调用一样大，以便您始终可以有足够的缓冲区来回退。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-03-06T16:14:34.420

[DotNetZip](http://dotnetzip.codeplex.com)中包含一个[ZlibStream](http://dotnetzip.codeplex.com/SourceControl/changeset/view/29776#383308)，用于压缩或解压缩 zlib 数据流。你没有问，但还有一个 GZipStream 和一个 DeflateStream。还有一个 ZlibCodec 类，如果那是你的事。（只是膨胀或缩小缓冲区，而不是流）。

DotNetZip 是一个具有自由许可证的完全托管库。您无需使用任何 .zip 功能即可获取 Zlib 内容。为了这个目的，zlib 的东西被打包为一个单独的（更小的）DLL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T21:13:56.590

据我所知，ZLib (gzip) 库不支持在标题中列出文件。假设这对您很重要，但这似乎是一个很大的缺点。这是我前一段时间使用Sharp zip库的时候，所以我愿意删除它:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T20:55:04.447

我可以向您推荐 Gerry Shaw 的 .NET 的 zlib 包装器：

> [http://www.organicbit.com/zip/](http://www.organicbit.com/zip/)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2020-09-21T15:12:16.250

老问题，但`System.IO.Compression.DeflateStream`如果您需要适当的 zlib 支持，这实际上是正确的答案：

> 从 .NET Framework 4.5 开始，DeflateStream 类**使用 zlib 库**。因此，它提供了更好的压缩算法，并且在大多数情况下，它提供的压缩文件比早期版本的 .NET Framework 中提供的更小。

没有比这更好的了。

# lua - 如何在 Lua 中快速初始化关联表？

> ID：513239
> 
> 赞同：38
> 
> 时间：2009-02-04T20:46:42.497
> 
> 标签：lua, initialization, lua-table

在 Lua 中，您可以通过以下方式创建表：

```
local t = { 1, 2, 3, 4, 5 } 
```

但是，我想创建一个关联表，我必须这样做：

```
local t = {}
t['foo'] = 1
t['bar'] = 2 
```

以下给出了一个错误：

```
local t = { 'foo' = 1, 'bar' = 2 } 
```

有没有办法类似于我的第一个代码片段？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2009-02-04T21:08:33.093

写这个的正确方法是

```
local t = { foo = 1, bar = 2} 
```

或者，如果表中的键不是合法标识符：

```
local t = { ["one key"] = 1, ["another key"] = 2} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2011-12-06T09:24:23.760

我相信如果你这样看，它会更好，更容易理解

```
local tablename = {["key"]="value",
                   ["key1"]="value",
                   ...} 
```

找到结果：**tablename.key=value**

> > 表作为字典
> 
> 表也​​可用于存储未按数字或顺序索引的信息，如数组。这些存储类型有时称为字典、关联数组、散列或映射类型。我们将使用术语字典，其中元素对具有键和值。键用于设置和检索与其关联的值。请注意，就像数组一样，我们可以使用 table[key] = value 格式将元素插入表中。键不必是数字，它可以是字符串，或者几乎任何其他 Lua 对象（nil 或 0/0 除外）。让我们构建一个包含一些键值对的表：
> 
> ```
> > t = { apple="green", orange="orange", banana="yellow" }
> > for k,v in pairs(t) do print(k,v) end
> apple   green
> orange  orange
> banana  yellow 
> ```

来自： http: [//lua-users.org/wiki/TablesTutorial](http://lua-users.org/wiki/TablesTutorial)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2011-06-01T10:10:30.860

要初始化具有与字符串值匹配的字符串键的关联数组，您应该使用

```
local petFamilies = {["Bat"]="Cunning",["Bear"]="Tenacity"}; 
```

但**不是**

```
local petFamilies = {["Bat"]=["Cunning"],["Bear"]=["Tenacity"]}; 
```

# ruby-on-rails - Rails : Retrieved Object 没有属性，无法与真实的对象进行比较

> ID：513242
> 
> 赞同：0
> 
> 时间：2009-02-04T20:47:04.353
> 
> 标签：ruby-on-rails, ruby, authentication, development-environment

这个问题真的让我很失落。

我有一个身份验证模型：用户。我有一个评论模型：comment。我有一个可评论的模型：weburl。

Weburl 1..* 评论 Weburl *..1 用户评论 *..1 用户

我遇到的问题是不可测试的（我的测试都通过了），并且不会一直发生。通常它会在我第二次生成相同的控制器动作时发生。

问题是我的用户与我的评论相关联，并通过评论检索。用户变得不等于 current_user，即使属性相同。例如 ：

```
(comment.user.login == current_user.login == User.find(1).login)
     ==> True
(comment.user.id)
     ==> Unknown in the current context
(comment.user.class == User == current_user.class)
     ==> True 
```

我仔细检查了关系`belongs_to`和`has_one has_many`我的模型

我的猜测是这与缓存有关，我在我的开发环境中遇到过这种情况，但在我的自动化测试和生产中都没有。

我想了解是什么问题。

谢谢

***编辑*** 添加我的 development.rb 初始化文件

```
config.cache_classes = false                                    #Set to true for prod
config.whiny_nils = true
config.action_controller.consider_all_requests_local = true     #Set to false for prod
config.action_view.debug_rjs                         = true
config.action_controller.perform_caching             = false    #Set to true for prod 
```

***编辑 #2*** 如果 config.cache_classes 为真，则错误不会发生

Doc 说： # 在开发环境中，您的应用程序代码在每次请求时都会重新加载。这会减慢响应时间，但非常适合开发，因为您在更改代码时不必重新启动网络服务器。

找到以下票证，可能是相互关联的[http://dev.rubyonrails.org/ticket/10722](http://dev.rubyonrails.org/ticket/10722) 另外，Mongrel 和 WebRick 也会出现问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T21:07:37.227

我认为您的问题的意思是：为什么这不起作用：`comment.user == current_user`。

当您将两个 Ruby 对象相互比较时，即`comment.user == current_user`比较它们的引用，因为它们是两个独特的对象并且位于不同的内存区域，这是正确的行为。

相反，您必须比较其他一些唯一字段，例如登录名或 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T21:12:13.163

这里抛出的错误到底是什么：（comment.user.id）？如果您无法从 Comment 对象访问 User 对象，则您可能在模型中遗漏了某些内容。不过，我没有靠近控制台来验证这一点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T15:18:30.780

我有一个类似的问题，并通过转储和重新读取数据库来解决它。

# c# - C# Julian 日期解析器

> ID：513247
> 
> 赞同：1
> 
> 时间：2009-02-04T20:47:24.757
> 
> 标签：c#, .net, julian-date

我在电子表格中有一个单元格，它是 Excel 中的一个日期对象，但是当它来自 C1 的 xls 类时，它变成了一个双精度对象（类似于 2009 年 1 月 7 日的 39820.0）。我读到这是儒略日期格式。有人可以告诉我如何将它解析回 C# 中的 DateTime 吗？

更新：看起来我可能没有儒略日期，而是自 1899 年 12 月 30 日以来的天数。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-04T21:42:33.273

我认为 Excel 只是使用标准的 OLE 自动化[DATE](http://msdn.microsoft.com/en-us/library/cc237601.aspx)类型，可以使用该`DateTime.FromOADate`方法进行转换。

这段代码，

```
using System;

namespace DateFromDouble
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine(DateTime.FromOADate(39820.0));
        }
    }
} 
```

输出：

```
1/7/2009 12:00:00 AM 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-04T20:51:57.307

System.Globalization 中有一个 JulianCalendar 类；以下是您将如何使用它：

```
 JulianCalendar c = new JulianCalendar();
            DateTime time = c.ToDateTime(2009, 1, 7, 0, 0, 0, 0);
            Console.WriteLine(time.ToShortDateString()); 
```

编辑：

如果实际上是“1900”以来的几天，那么您可以这样做：

```
public static DateTime DaysSince1900(int days)
{
    return new DateTime(1900, 1, 1).AddDays(days);
}

 DateTime time = DaysSince1900(39820);
 Console.WriteLine(time.ToShortDateString()); //will result in "1/9/2009" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T20:51:10.380

该数字看起来像“自 1900 年以来的天数”值。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T20:50:37.277

看看这篇文章：[http ://dotnet-jeeves.blogspot.com/2006/02/convert-julian-date-to-systemdatetime.html](http://dotnet-jeeves.blogspot.com/2006/02/convert-julian-date-to-systemdatetime.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-04-18T21:22:24.897

给你。

[http://dotnetblogger.com/post/2009/02/26/Convert-DateTime-to-Julian-Date-in-C.aspx](http://dotnetblogger.com/post/2009/02/26/Convert-DateTime-to-Julian-Date-in-C.aspx)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-04-18T21:34:04.187

在处理 Excel 日期时，日期可能是日期的字符串表示形式，也可能是 OA 日期。这是我不久前写的一个扩展方法，以帮助促进日期转换：

```
/// <summary>
/// Sometimes the date from Excel is a string, other times it is an OA Date:
/// Excel stores date values as a Double representing the number of days from January 1, 1900.
/// Need to use the FromOADate method which takes a Double and converts to a Date.
/// OA = OLE Automation compatible.
/// </summary>
/// <param name="date">a string to parse into a date</param>
/// <returns>a DateTime value; if the string could not be parsed, returns DateTime.MinValue</returns>
public static DateTime ParseExcelDate( this string date )
{
    DateTime dt;
    if( DateTime.TryParse( date, out dt ) )
    {
        return dt;
    }

    double oaDate;
    if( double.TryParse( date, out oaDate ) )
    {
        return DateTime.FromOADate( oaDate );
    }

    return DateTime.MinValue;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-12-16T19:10:17.910

有两种方法可以进行此转换 -

1.  OLE 自动化日期方法 --

    ```
    double doubleDate = 43153.0;
    DateTime normalDate = DateTime.FromOADate(doubleDate);
    /* {2/22/2018 12:00:00 AM} */ 
    ```

2.  DateAdd() 方法，使用该方法，可以指定要转换为的日期类型

    ```
    double doubleDate = 43153.0;
    DateTime normalDate = new DateTime(1899, 12, 30, 0, 0, 0, DateTimeKind.Utc).AddDays(doubleDate);
    /* {2/22/2018 12:00:00 AM} */ 
    ```

注意：这个日期常数 {12h December 31, 1899} 称为都柏林儒略日，记录在[儒略日](https://en.wikipedia.org/wiki/Julian_day)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-11-19T23:10:51.367

只需将有问题的单元格格式化为日期，使用 CTRL+1，然后选择所需的格式。

# .net - 如何使用 .NET 打开文件以进行非独占写入访问

> ID：513260
> 
> 赞同：7
> 
> 时间：2009-02-04T20:49:37.843
> 
> 标签：.net, file-io

是否可以在 .NET 中打开具有非独占写入访问权限的文件？如果是这样，怎么做？我希望有两个或多个进程同时写入同一个文件。

**编辑：**这是这个问题的上下文：我正在为 IIS 编写一个简单的日志记录 HTTPModule。由于在不同应用程序池中运行的应用程序作为不同的进程运行，因此我需要一种在进程之间共享日志文件的方法。我可以编写一个复杂的文件锁定例程，或者一个懒惰的作家，但这是一个扔掉的项目，所以它并不重要。

这是我用来弄清楚该过程的测试代码。

```
using System;
using System.Collections.Generic;
using System.Text;
using System.IO;
using System.Threading;

namespace FileOpenTest
{
    class Program
    {
        private static bool keepGoing = true;

        static void Main(string[] args)
        {
            Console.CancelKeyPress += new ConsoleCancelEventHandler(Console_CancelKeyPress);

            Console.Write("Enter name: ");
            string name = Console.ReadLine();
            //Open the file in a shared write mode
            FileStream fs = new FileStream("file.txt", 
                                           FileMode.OpenOrCreate, 
                                           FileAccess.ReadWrite, 
                                           FileShare.ReadWrite);

            while (keepGoing)
            {
                AlmostGuaranteedAppend(name, fs);
                Console.WriteLine(name);
                Thread.Sleep(1000);
            }

            fs.Close();
            fs.Dispose();
        }

        private static void AlmostGuaranteedAppend(string stringToWrite, FileStream fs)
        {
            StreamWriter sw = new StreamWriter(fs);

            //Force the file pointer to re-seek the end of the file.
            //THIS IS THE KEY TO KEEPING MULTIPLE PROCESSES FROM STOMPING
            //EACH OTHER WHEN WRITING TO A SHARED FILE.
            fs.Position = fs.Length;

            //Note: there is a possible race condition between the above
            //and below lines of code. If a context switch happens right
            //here and the next process writes to the end of the common
            //file, then fs.Position will no longer point to the end of
            //the file and the next write will overwrite existing data.
            //For writing periodic logs where the chance of collision is
            //small, this should work.

            sw.WriteLine(stringToWrite);
            sw.Flush();
        }

        private static void Console_CancelKeyPress(object sender, ConsoleCancelEventArgs e)
        {
            keepGoing = false;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T20:53:44.963

使用File.Open 打开文件时使用[FileShare枚举。](http://msdn.microsoft.com/en-us/library/system.io.fileshare.aspx)具体来说，使用 FileShare.ReadWrite。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-04T20:55:51.403

FileStream 类有一个[构造函数](http://msdn.microsoft.com/en-us/library/5h0z48dh.aspx)，它接受多个选项，包括[FileShare](http://msdn.microsoft.com/en-us/library/system.io.fileshare.aspx)

```
new FileStream(filePath, FileMode.Create, FileAccess.ReadWrite, FileShare.ReadWrite); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-24T17:36:17.957

[我在procbits.com](http://procbits.com/2011/02/18/streamwriter-share-read-access-in-another-process)上找到了一个非常有用的答案：

> 日志文件生成器：（第一个过程）

```
static void Main(string[] args) {
    var file = @"C:\logfile.txt";
    var fs = File.Open(file, FileMode.Append, FileAccess.Write, FileShare.Read);
    var sw = new StreamWriter(fs);
    sw.AutoFlush = true;
    sw.WriteLine("some data");
    sw.WriteLine("some data2"); //set breakpoint here

    sw.Close();
} 
```

> 日志文件阅读器：（第二个过程）

```
static void Main(string[] args) {
    var file = @"C:\logfile.txt";
    var fs = File.Open(file, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
    var sr = new StreamReader(fs);

    var l1 = sr.ReadLine();
    var l2 = sr.ReadLine();

    sr.Close();
} 
```

> 简而言之，这是因为 FileShare 权限设置正确。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-04T20:53:17.973

不可能。了解如何将文件读/写到光盘。

编辑：由于所有的反对票，我想我会再解释一下。多个进程同时写入同一个文件是绝对不可能的。当一个进程正在写入时，该文件通常对其他写入者不可用，这意味着其他进程将不得不等到第一个进程不再写入该文件。

# c# - 如何在两个不同的选项卡上显示相同的控件？

> ID：513276
> 
> 赞同：8
> 
> 时间：2009-02-04T20:52:31.597
> 
> 标签：c#, vb.net, winforms, controls, tabcontrol

我正在使用 VB.NET

我需要在 2 个不同的选项卡上显示相同的控件（列表框）。

是否必须创建 2 个不同的 ListBox 实例？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-04T21:00:06.900

如果您不需要设计时支持，您可以简单地在运行时将 ListBox 实例的 Parent 从一个选项卡更改为另一个选项卡（当然，请确保正确设置位置）。

本质上，它是：

`listBox1.Parent = tabControl1.TabPages[1];`

最后，您可能会发现只有两个具有相同数据源的 ListBox 会更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T20:54:36.910

是的，我认为每个选项卡上都需要一个 ListBox 控件。如果它们具有相同的数据，您可以为两者使用相同的 DataSource。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T20:56:09.107

是的，在每个选项卡上添加一个新实例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T20:56:24.583

如果你想要完整的设计师支持，你需要两个盒子。如果在代码中这样做就足够了，您可以在表单加载时创建一个列表框，并手动添加对每个标签页的引用。

# python - 各种 Python 日期时间问题

> ID：513291
> 
> 赞同：2
> 
> 时间：2009-02-04T20:54:50.577
> 
> 标签：python, datetime

我有两种方法用作模板引擎中的自定义标签：

```
# Renders a <select> form field
def select_field(options, selected_item, field_name):
    options = [(str(v),str(v)) for v in options]
    html = ['<select name="%s">' % field_name]
    for k,v in options:
        tmp = '<option '
        if k == selected_item:
            tmp += 'selected '
        tmp += 'value="%s">%s</option>' % (k,v)
        html.append(tmp)
    html.append('</select>')
    return '\n'.join(html)

# Renders a collection of <select> fields for datetime values
def datetime_field(current_dt, field_name):
    if current_dt == None:
        current_dt = datetime.datetime.now()
    day = select_field(range(1, 32), current_dt.day, field_name + "_day")
    month = select_field(range(1, 13), current_dt.month, field_name + "_month")
    year = select_field(range(datetime.datetime.now().year, datetime.datetime.now().year + 10), current_dt.year, field_name + "_year")
    hour = select_field(range(1, 13), current_dt.hour, field_name + "_hour")
    minute = select_field(range(1, 60), current_dt.minute, field_name + "_minute")
    period = select_field(['AM', 'PM'], 'AM', field_name + "_period")
    return "\n".join([day, '/', month, '/', year, ' at ', hour, ':', minute, period]) 
```

正如您在评论中看到的那样，我正在尝试生成选择字段来构建日期和时间值。

我的第一个问题是，如何使日、月、小时和分钟范围使用两位数？例如，代码生成“1、2、3...”，而我想要“01、02、03”。

接下来，当字段生成时，提供的日期时间的值不会自动选择，即使我告诉 select_field 方法在值等于提供的日期时间的值时添加“选定”属性。

最后，如何获取提供的日期时间的 12 小时时段标识符 (AM/PM)？目前，我只是默认选择“AM”，但我想从日期时间本身提供这个值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T21:03:45.130

要将整数范围转换为两位数字字符串：

```
>>> range(13)
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
>>> [ '%02d' % i for i in range(13) ]
['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'] 
```

然后获取 AM/PM 指标：

```
>>> import datetime
>>> current_dt = datetime.datetime.now()
>>> current_dt
datetime.datetime(2009, 2, 4, 22, 2, 14, 390000)
>>> ['AM','PM'][current_dt.hour>=12]
'PM' 
```

瞧！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T20:58:52.067

问题一：

```
>>> '%02d' % 2
'02'
>>> '%02d' % 59
'59' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T21:22:05.640

要添加到我之前的答案，请对选择所选选项进行一些评论。

首先，如果不是拆分 HTML 标记的开始和结束，您的 HTML 生成代码会更加健壮......

```
html = ['<select name="%s">' % field_name]
for k,v in options:
    tmp = '<option '
    if k == selected_item:
            tmp += 'selected '
    tmp += 'value="%s">%s</option>' % (k,v)
    html.append(tmp)
html.append('</select>') 
```

...您将它们生成为原子整体：

```
opt_bits = ('<option %s value="%s">'% (['','selected'][str(v)==selected_item], str(v)) for v in options)
# If running Python2.5, it's better to use: 'selected' if str(v)==selected_item else '' 
html = '<select name=%s>%s</select>' % '\n'.join(opt_bits) 
```

其次，我不确定你为什么将选项列表加倍而不是像我上面那样重用相同的变量名：

```
options = [(str(v),str(v)) for v in options]   # ???? 
```

这是不必要的，除非 options 真的是一个 dict 并且您打算这样：

```
[ (k,v) for k,v in options.iteritems() ] 
```

最后，如果列表项包含引号，您的代码将中断。在 Python 文档中查找用于转义 HTML 的标准函数。

祝你好运！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T21:04:52.100

1.  向方法提供格式字符串以`select_field`显示前导零。

    ```
    >>> print "%02i" % (1, )
    01 
    ```

2.  datetime.hour 为 0-23，因此在设置字段时必须对其进行调整。这也是关于如何检测 AM/PM 的答案。确保将其正确转换回来。

# digital-signature - 用于数字签名的 PC/SC 功能

> ID：513292
> 
> 赞同：1
> 
> 时间：2009-02-04T20:54:57.893
> 
> 标签：digital-signature, smartcard

我正在尝试使用 Micrisift API 为智能卡签署 XML 文档...

到目前为止，我可以列出读卡器，连接到正确的卡并建立上下文，但之后我不确定下一步是什么......

我需要调用哪些 PC/SC 功能才能使用私有智能卡密钥签署文档？

提前致谢

哈维尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-03-04T22:38:09.990

如果您安装了中间件，则可以将[Windows CAPI](http://msdn.microsoft.com/en-us/library/aa380256.aspx)用于加密功能。一些中间件还附带了一个您可以使用的 PKCS#11 库。如果您没有任何中间件，则必须使用 PC/SC 接口自己完成，如果卡使用 Secure Messaging（或 Sado Machism），我建议您查看 ISO/IEC 7816-4 和 ISO/IEC 7816-8如果你问我）。[不幸的是，这些 ISO 规范非常昂贵，但是您可以在此处](http://www.cardwerk.com/smartcards/smartcard_standard_ISO7816-4.aspx)找到 ISO/IEC 7816-4 的一些摘录。ISO/IEC 7816-4 描述了与卡进行信息交换的 APDU 命令。[PKCS#15](http://www.rsa.com/rsalabs/node.asp?id=2141)标准对于文件在卡上的存储方式也有很大帮助。

此外，您可能需要卡制造商提供的完整规格。如果你幸运的话，你可以在~~[MuscleCard 项目](http://www.linuxnet.com/musclecard/index.html)~~或[OpenSC 项目](https://github.com/OpenSC/OpenSC/wiki)中找到你的卡片插件（它们都可以在 Windows 中工作）。

# c - （如何）我可以从套接字文件描述符中确定套接字系列吗

> ID：513298
> 
> 赞同：7
> 
> 时间：2009-02-04T20:55:31.230
> 
> 标签：c, sockets, ipc

我正在编写一个 API，其中包含 IPC 函数，这些函数将数据发送到另一个可能是本地或另一个主机上的进程。我真的很希望发送功能如此简单：

```
int mySendFunc(myDataThing_t* thing, int sd); 
```

调用者不必知道——在 mySendFunc() 调用的直接上下文中—— sd 是否导致本地或远程进程。在我看来，如果我可以这样的话：

```
switch (socketFamily(sd)) {
case AF_UNIX:
case AF_LOCAL:
   // Send without byteswapping
   break;
default:
   // Use htons() and htonl() on multi-byte values
   break;
} 
```

有人建议我可以将 socketFamily() 实现为：

```
unsigned short socketFamily(int sd)
{
   struct sockaddr sa;
   size_t len;
   getsockname(sd, &sa, &len);   
   return sa.sa_family;
} 
```

但我有点担心getsockname() 的效率，想知道我是否能负担得起每次发送。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T21:02:07.020

请参阅[getsockname(2)](http://opengroup.org/onlinepubs/007908775/xns/getsockname.html)。然后，您检查该族的*struct sockaddr*。

编辑：作为旁注，查询*信息*有时也很有用，在这种情况下是*info libc sockets*

编辑：

你真的不每次都查一下就知道了。它不能简单地被缓存，因为套接字号可以通过关闭和重新打开来重用。我刚刚查看了 glibc 代码，似乎*getsockname*只是一个系统调用，这在性能方面可能很糟糕。

但我的建议是使用某种面向对象的概念。让用户传递一个指向您之前返回给他的结构的指针，即让他使用您的 API 注册/打开套接字。然后，您可以缓存有关该套接字的任何内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T21:25:38.503

为什么不总是按网络字节顺序发送？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T21:13:33.957

如果您控制客户端和服务器代码，我有一个不同的建议，我过去曾成功使用过。

让消息的前四个字节是一个已知的整数值。然后接收器可以检查前四个字节以查看它是否与已知值匹配。如果匹配，则不需要字节交换。

当两台机器具有相同的字节序时，这使您不必进行字节交换。

# oracle - 如何在带有 Oracle 数据库的 HQL 查询中使用当前日期？

> ID：513317
> 
> 赞同：34
> 
> 时间：2009-02-04T20:58:37.107
> 
> 标签：oracle, hibernate, hql

我正在尝试使用 Hibernate 3 和 Oracle 10 编写此查询。

```
from Alert alert
where alert.expiration > current_date()
order by alert.priority, alert.updated, alert.name 
```

它正在创建这样的 SQL -

```
Hibernate: select alert0_.ANNOUNCEMENTS_ID as ANNOUNCE1_1_, alert0_.ANNOUNCEMENT
S_NAME as ANNOUNCE2_1_, alert0_.ANNOUNCEMENTS_PRIORITY as ANNOUNCE3_1_, alert0_.
ANNOUNCEMENTS_EXPIRATION as ANNOUNCE4_1_, alert0_.ANNOUNCEMENTS_UPDATE_DATE as A
NNOUNCE5_1_ from NYC311_ANNOUNCEMENTS alert0_ where (alert0_.ANNOUNCEMENTS_EXPIR
ATION>current_date()) order by  alert0_.ANNOUNCEMENTS_PRIORITY , alert0_.ANNOUNC
EMENTS_UPDATE_DATE , alert0_.ANNOUNCEMENTS_NAME 
```

当括号显然完全平衡时，我会遇到所有这些古怪的错误，例如“缺少右括号”。

为什么甲骨文对此感到恐惧？有没有更好的方法来编写我的 HQL 查询？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2009-02-04T21:11:57.080

不应该`current_date`吗？

Hibernate 会将其翻译成正确的方言。

我没有找到真正的“Hibernate 将把这个翻译成那个”的参考文档，但是这个表达式通常可以在 [HQL Expressions for Hibernate 4.3](http://docs.jboss.org/hibernate/orm/4.3/manual/en-US/html/ch16.html#queryhql-expressions)中找到。

然后是[Java Persistence API 2.0 (JPA)](https://jcp.org/en/jsr/detail?id=317)规范，它定义了 Java Persistence 查询语言 (JPQL) 的表达式及其含义，例如`current_date`：

> 4.6.17.2.3 日期时间函数 functions_returning_datetime:= CURRENT_DATE | 当前时间 | CURRENT_TIMESTAMP 日期时间函数返回数据库服务器上当前日期、时间和时间戳的值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-04T21:10:21.170

是`current_date()`休眠功能吗？

我会`sysdate`改用。像这样：

```
where alert.expiration > sysdate 
```

或者忽略一天中的时间：

```
where alert.expiration > trunc(sysdate) 
```

# .net - 如果我使用带表单身份验证的 WCF，php 或 java 客户端将如何进行身份验证？

> ID：513330
> 
> 赞同：3
> 
> 时间：2009-02-04T21:01:15.040
> 
> 标签：.net, wcf, security, interop

我有一个通用的概念证明 WCF 服务，它使用表单身份验证来保护访问。当我的客户端是 .NET 时，一切都很好（下面的 vb 代码）

```
Dim client As SupplierServiceClient = New SupplierServiceClient()
client.ClientCredentials.UserName.UserName = "xxxx@xxx.xx.xx"
client.ClientCredentials.UserName.Password = "password"

Dim SupplierList As List(Of Supplier) = client.GetSuppliers() 
```

但是因为我希望它与任何可以执行 SOAP 1.1/1.2 的人互操作 - PHP 或 Java 客户端将如何连接？

下面列出了我的 WCF web.config (fyi)

```
<system.serviceModel>
    <services>
        <service name="SampleApplicationWCF.Library.SupplierService" behaviorConfiguration="NorthwindBehavior">
            <endpoint address="" name="wsHttpSupplierService" contract="SampleApplicationWCF.Library.ISupplierService" binding="wsHttpBinding" bindingConfiguration="wsHttp"/>
            <endpoint address="https://server/SampleApplicationWCF/SupplierService.svc/Basic" name="basicHttpSupplierService" contract="SampleApplicationWCF.Library.ISupplierService" binding="basicHttpBinding" bindingConfiguration="basicHttp"/>
            <endpoint contract="IMetadataExchange" binding="mexHttpBinding" address="mex"/>
        </service>
    </services>
    <bindings>
        <wsHttpBinding>
            <binding name="wsHttp">
                <security mode="TransportWithMessageCredential">
                    <transport/>
                    <message clientCredentialType="UserName" negotiateServiceCredential="false" establishSecurityContext="true"/>
                </security>
            </binding>
        </wsHttpBinding>
        <basicHttpBinding>
            <binding name="basicHttp">
                <security mode="TransportWithMessageCredential">
                    <transport/>
                    <message clientCredentialType="UserName"/>
                </security>
            </binding>
        </basicHttpBinding>
    </bindings>
    <behaviors>
        <serviceBehaviors>
            <behavior name="NorthwindBehavior">
                <serviceMetadata httpGetEnabled="true"/>
                <serviceAuthorization principalPermissionMode="UseAspNetRoles"/>
                <serviceCredentials>
                    <userNameAuthentication userNamePasswordValidationMode="MembershipProvider"/>
                </serviceCredentials>
            </behavior>
        </serviceBehaviors>
    </behaviors>
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2011-01-19T16:28:08.287

我设法验证了一个 PHP 客户端，但并非没有付出一些努力。起初，我尝试了以下方法：

```
$header = new stdClass;
$credentials = new stdClass;
$credentials->Username="myuser";
$credentials->Password="mypass";
$header->UsernameToken = $credentials;

$securityNamespace = "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd";
$client->__setSoapHeaders($securityNamespace, 'Security', $header); 
```

它没有用。似乎 PHP5（在我的例子中是 v5.3.5）有一个错误，阻止命名空间前缀出现在嵌套的标题标签中。 [http://bugs.php.net/bug.php?id=48966](http://bugs.php.net/bug.php?id=48966)
我最终得到：

```
<UsernameToken><Username>myuser</Username><Password>myuser</Password></UsernameToken> 
```

代替：

```
<o:UsernameToken><o:Username>myuser</o:Username><o:Password>myuser</o:Password></o:UsernameToken> 
```

所以，我要做的就是将必要的 XML 硬编码到一个变量中。这很丑陋但有效：

```
$securityNamespace="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd";
$headerContent = "<o:Security xmlns:o=\"$securityNamespace\">
                    <o:UsernameToken>
                    <o:Username>myuser</o:Username>
                    <o:Password>mypass</o:Password>
                    </o:UsernameToken>
                </o:Security>";
$headerVar = new SoapVar($headerContent, XSD_ANYXML, null, null, null);
$header = new SoapHeader($securityNamespace, 'o:Security', $headerVar);
$client->__setSoapHeaders(array($header)); 
```

我希望它对某人有所帮助。再见！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T00:04:57.103

免责声明：我不是 Java 或 PHP 开发人员

通过在客户端对象上设置 UserName 值，您就是在告诉 WCF 将该信息作为 SOAP 标头的一部分通过网络传送。由于 SOAP 是一种被广泛采用的标准，我确信有一些库可以帮助您将这些信息添加到 SOAP 消息头中。我会寻找可以帮助您使用 WS-* 和/或 WS-I Basic Profile 规范来使用服务的东西。

祝你好运。

# c# - 从非托管 unicode 字符串创建 SecureString

> ID：513335
> 
> 赞同：4
> 
> 时间：2009-02-04T21:02:19.640
> 
> 标签：c#, unicode, pinvoke, marshalling, securestring

我想尝试以最好的方式将 CryptUnprotectData windows API 函数和 .net SecureString 联系在一起。CryptUnprotectData 返回一个由字节数组和字节长度组成的 DATA_BLOB 结构。在我的程序中，这将是一个 Unicode UTF-16 字符串。SecureString 有一个构造函数，它接受一个 char* 和长度参数，所以我希望能够执行以下操作：

```
SecureString ss = SecureString((char*)textBlob.pbData, textBlob.cbData / 2);
```

这行得通，除了 UTF-16 是可变长度的，所以我真的不知道用什么作为长度参数。上面的示例假设 2 字节字符 (BMP)，但对于其他平面，它可能最多为 4 字节。我需要知道字节数组中 UTF-16 字符的数量。在不复制内存中的值（从而损害安全性）的情况下，最好的方法是什么。我计划尽快清零并释放字节数组。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T21:05:38.107

据我所知，大多数 Windows API 都处理 UTF-16 代码点 - 换句话说，您将代理对视为两个代码点而不是单个字符。鉴于 SecureString 的构造函数正在处理指向 .NET`System.Char`值（即 UTF-16）的指针，我认为您得到的代码片段很好 - pbData 中的元素数量*是*其字节大小的一半。

例如，如果`pbData`包含（仅）一个代理对，则为`cbData`4 并且您仍希望将 2 作为第二个参数传入 - 因为这是`System.Char`您构造`SecureString`from 的值的数量。它是一个非 BMP unicode 字符这一事实与它所`System.Char`代表的 UTF-16 值的数量无关。

（是的，对非 BMP 数据的支持有点混乱，我怀疑很少有人能在任何地方都能做到这一点。我敢肯定我没有。幸运的是，在很多地方你不需要担心。 ..)

# javascript - 如何将 JSON URL 传递给 jQuery 函数？

> ID：513338
> 
> 赞同：3
> 
> 时间：2009-02-04T21:03:24.507
> 
> 标签：javascript, jquery, json

我在带有相应颜色变量的单选按钮之前加载了这个：

```
<script type="text/javascript">
    //<![CDATA[
    images = {"Black":"http:\/\/ecx.images-amazon.com\/images\/I\/31XwBA2m8pL.jpg", "Slate":"http:\/\/ecx.images-amazon.com\/images\/I\/31SqWkrSb6L.jpg", "White":"http:\/\/ecx.images-amazon.com\/images\/I\/31OJufgJT2L.jpg"};
    //]]>
</script> 
```

这是jQuery函数。到目前为止，我能做的最好的事情就是让第一张图片消失，留下`alt`属性。

```
function change_large_product_image(url) {
    jQuery('.largeprod img').attr('src', url);
    return false;
} 
```

这是单选按钮的示例源。

```
<label for="Black"
       style="background: #fff url(http://ecx.images-amazon.com/images/I/11TeKFAzJsL._SL30_.jpg) center center no-repeat;"
       title="Black" >
    Black
</label>
<input
    id="color_black"
    name="color"
    onclick="change_large_product_image(images['Black'])"
    type="radio"
    value="Black" /> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T21:19:10.573

解决问题的更简单方法不是尝试更改 src，而是清空容器并在其位置放置一个新的 img。例如。

```
<div class"largeprod"><img src="...old..." /></div> 
```

并使用 jQuery 将其清除并重新加载

```
$('.largeprod').empty().append('<img src="...new..."/>'); 
```

如果你想用它变得非常聪明，你可以将图像“预加载”到一个不显示的 div 中，然后克隆并将它放到你想要的位置。我使用一个系统，我将图像（和大块内容）放入隐藏的 div 中，保存它的 id 以及它进入数组的位置，然后当图像完成加载时，触发 onload 事件并将其移动到它的位置应该去。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T21:29:48.540

参数的值是多少，`url`? 看起来您可能需要解码 URL 字符串以删除“\”字符。

```
function change_large_product_image(url) {
    jQuery('.largeprod img').attr('src', decodeURI(url));
    return false;
} 
```

此外，考虑采纳 thaBadDawg 的建议。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-08T02:36:55.080

这是我的解决方案：

```
<script type="text/javascript">
    var myImages = {
        "Black":"http:\/\/ecx.images-amazon.com\/images\/I\/31XwBA2m8pL.jpg"
        ,"Slate":"http:\/\/ecx.images-amazon.com\/images\/I\/31SqWkrSb6L.jpg"
        , "White":"http:\/\/ecx.images-amazon.com\/images\/I\/31OJufgJT2L.jpg"
    };
    $(document).ready(function() {
        for ( var i in myImages ) {
            html = '<br />';
            html += '<label for="'+i+'" style="background: #fff url('+myImages[i]+') center center no-repeat;" title="'+i+'" >'+i+'</label>';
            html += '<input id="'+i+'" name="color" onclick="$(\'#largeImage\').attr(\'src\',\''+myImages[i]+'\');" type="radio" value="'+i+'" />';
            html += '<br />';
            $('body').append(html);
        }
        $('body').append("<img id='largeImage'>");
    });
</script> 
```

# java - 在 Java 应用程序中保存数据的最佳方式是什么？

> ID：513343
> 
> 赞同：9
> 
> 时间：2009-02-04T21:04:13.147
> 
> 标签：java, database, settings, state

我正在尝试找到保存简单应用程序状态的最佳方法。从数据库的角度来看，有 4/5 的表带有日期字段和关系。

因为应用程序很简单，并且我希望用户可以选择移动数据（usb pen、dropbox 等），所以我想将所有数据放在一个文件中。

执行此操作的最佳方式/lib 是什么？

XML 通常是最好的格式（可读性和开放性），但如果不使用 SAX/DOM，我还没有找到任何好的库。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T21:07:46.760

如果您想使用 XML，请查看[XStream](http://x-stream.github.io/)，用于将 Java 对象简单序列化为 XML。这是[“两分钟教程”](http://x-stream.github.io/tutorial.html)。

如果您想要一些简单的东西，标准的[Java 属性格式](http://en.wikipedia.org/wiki/.properties)也可以作为存储/加载一些小数据的一种方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T21:28:16.453

考虑使用 JDK 附带的普通 JAXB 注释：

```
@XmlRootElement  
private class Foo {  
    @XmlAttribute  
    private String text = "bar";
} 
```

这是[我的一篇博文](http://netzwerg.ch/2007/10/simple-jaxb.html)，详细介绍了 JAXB 的这种简单用法（它还提到了一种更“优雅”的基于 JAXB 的方法——以防您需要更好地控制 XML 模式，例如保证向后兼容性）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T21:21:58.417

您可能会考虑的其他 2 个选项 -

*   Hsqldb 是一个用 java 编写的小型 sql db。与您的目的更相关的是，它可以配置为简单地写入 csv 文件作为数据存储，因此您可以想象将其文本输出用作便携式数据存储并仍然使用 sql，如果您愿意的话。
*   第二种选择可能是将数据存储直接写入序列化文件，直接或通过像 prevayler 之类的库。非常好的性能和简单的实现，缺点是格式的脆弱性和不透明性。

但是如果数据足够小，xml 可能就少了很多麻烦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-05-11T17:47:55.913

如果您不需要为数据提供语义含义，那么 XML 可能是一个错误的选择。我建议使用无脂肪替代[JSON](http://www.json.org/)，它更自然地为数据结构构建。

# ruby-on-rails - 如何一次删除包含所有内容的 OU？

> ID：513348
> 
> 赞同：1
> 
> 时间：2009-02-04T21:06:47.667
> 
> 标签：ruby-on-rails, ruby, active-directory, ldap

我希望有一个 LDAP 命令可以自动删除整个 OU，包括所有子项。我看到有一个用于 windows 命令行的命令：

[删除组织单位](http://technet.microsoft.com/en-us/library/cc725787.aspx "MS TechNet：删除组织单位")

```
dsrm <OrganizationalUnitDN> [-subtree] 
```

该 -subtree 选项也会删除子级。有没有办法使用 LDAP 做到这一点？

奖励积分，如果有人知道如何使用 ActiveLdap gem 做到这一点。但我将扩展 ActiveLdap 以包含此功能。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-06T01:38:19.503

一些 LDAP 工具在其接口中实现了这一点。LDAPBrowser 想到了[Gowars LDAP 浏览器](http://www.mcs.anl.gov/~gawor/ldap/)我还没有研究过它是如何工作的，但我想它会检索从属于容器的对象的 DN 列表，然后将它们一一删除。

以任何其他方式执行此操作将取决于支持某些功能的 LDAP 服务器。我知道的大多数不直接支持这样的操作。而是任何实现它的工具，以上述方式伪造它。

# linux - 为什么当我用 Nagios 调用 ps 时，我的 Perl 脚本中只返回一行输出？

> ID：513354
> 
> 赞同：3
> 
> 时间：2009-02-04T21:07:51.767
> 
> 标签：linux, perl, nagios, nrpe

我有这个运行：

```
if (open(PS_ELF, "/bin/ps -eLf|")) {
  while (<PS_ELF>) {
    if ($_ =~ m/some regex/) {
      # do some stuff
    }
  }
} 
```

如果在本地调用，循环运行得很好，每个输出行一次`ps -eLf`

现在，如果通过[NRPE](http://nagios.sourceforge.net/docs/3_0/addons.html)从[Nagios](http://www.nagios.org)调用相同的脚本，则仅包含一行（第一行由 输出）。`PS_ELF``ps`

这让我很困惑；可能是什么原因？

也许这根本不限于 Nagios 或由 Nagios 引起，我只是为了完整起见将其包括在内。

我使用的是 SUSE Enterprise Linux 10 SP2 和 perl v5.8.8。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T18:00:57.663

我将“ps -eLf”更改为“ps -eLfww”（ww 表示无限输出），即使我不明白为什么远程调用时会有差异，这也解决了问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2011-04-12T11:57:37.220

虽然这个问题很老了，但我今天遇到了完全相同的问题。所以我想我分享我的发现。问题在于，由 NRPE 守护程序创建的进程（可以）具有与您作为 NRPE 守护程序用户直接在 shell 中执行的进程不同的环境。

我创建了以下 bash 脚本：

```
#!/bin/bash
echo `env | grep COLUMNS` 
```

这给了我当前进程的环境变量 COLUMN，它与父进程（由 NRPE 守护进程分叉的进程）具有相同的环境。

当我以 NRPE 守护程序用户身份执行此脚本时

```
$ /tmp/check_env.sh
COLUMNS=174 
```

它给了我当前 shell 窗口的值。但是当我通过 NRPE 执行这个脚本时，我得到：

```
nagios-server $ check_nrpe -H client -c check_env
COLUMNS=80 
```

这就是为什么 ps -eaf 输出限制为 80 个字符的原因，除非您使用 ww 参数来获得无限宽度，这会忽略 COLUMNS 环境变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T22:07:04.317

这可能与 NRPE 插件的工作方式有关，而不是 Perl 本身。

您的插件的工作方式与[此处](http://nagios.sourceforge.net/docs/3_0/pluginapi.html)解释的一样（返回代码 + 输出）？

# actionscript-3 - 如何编译生成的 AS

> ID：513360
> 
> 赞同：0
> 
> 时间：2009-02-04T21:08:45.633
> 
> 标签：actionscript-3, apache-flex, compiler-construction

希望你能帮助我解决这个问题。

所以，我已经与 Flex 合作了一段时间，并且有了创建纯 AS 项目的疯狂想法。

如果我使用 -keep 标志编译 Flex 应用程序，则会生成生成的动作脚本。

你们知道一种使其编译的方法，而无需通过代码并将它们粘合在一起吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T01:27:47.420

生成的 ActionScript 确实仅供参考；从这个意义上说，它并不是真的打算重新利用。事实上，如果你有的话，你很可能已经编译了你的项目（除非你从其他地方得到它），所以有人可能会问你为什么要编译生成的东西而不是你自己的源代码——但是尽管如此，虽然我还没有真正尝试过，但你应该能够将 Flex 编译器[mxmlc](http://livedocs.adobe.com/flex/3/html/help.html?content=compilers_13.html)指向你生成的源来编译它，前提是你能够让所有依赖项对齐（这可能是你的意思“将它们粘合在一起”）。

只是一个想法，虽然我还没有真正尝试过，所以你的结果可能会有所不同。不过，你想做什么？只是好奇。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T21:24:33.603

就像 Christian 提到的，生成的 AS 代码几乎可以作为参考。只是为了好玩，我尝试使用 mxmlc 从命令行编译它，但这样做的部分问题是生成的类文件与它们所代表的类不匹配。因此，您需要开始重命名一堆类文件，以便编译它们甚至可以工作。出于同样的原因，Flex 中的许多其他类都不会在其中编译。

例如，我测试的项目中只有一个源代码的 mxml 文件。生成的输出是 45 个文件。我敢肯定，如果您真的想这样做，并且愿意花时间清理这些东西，那么您可以。但我也很好奇——你为什么要这样做？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-07T05:36:23.220

其实只是好奇而已。我想了解框架是如何工作的，并看看它如何将它们合并在一起以制作最终应用程序，因为我认为生成的动作脚本文件只是最终 SWF 文件之间的一个步骤，所以我认为应该有一种方法它抓取这些文件并生成最终的应用程序。

最终，我会尝试创建一个纯粹的 actionscript 项目，只是为了看看它有多复杂，以及在开发其他东西时会发生什么错误。

我知道这听起来很疯狂，但我有一些空闲时间，哈哈哈。

# tfs - 如何在两个 TFS 分支之间找到变更集？

> ID：513364
> 
> 赞同：1
> 
> 时间：2009-02-04T21:10:32.043
> 
> 标签：tfs

是否可以获得两个不同 TFS 分支之间不同的所有变更集的列表？我不是在谈论文件差异。

我有一个主代码库（MAIN）。我从名为 (MAIN-BRANCH) 的分支中创建了一个新分支。我创建了另一个名为 (RELEASE) 的分支。我在 MAIN-BRANCH 签到五次，然后合并到 MAIN。

我想提取 RELEASE 和 MAIN 之间发生的所有变更集注释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-03-12T12:21:09.437

您可以使用 TF 合并命令为您执行此操作吗：

tf 合并 branchroot1 branchroot2 /recursive

有关更多帮助，请参阅[合并](http://msdn.microsoft.com/en-us/library/bd6dxhfy.aspx)命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-18T09:44:35.603

在 TFS 2005 中这是不可能的，注释和变更集详细信息不会从一个分支传递到另一个分支。您必须查看发生变更集的分支并比较日期以找到所需的日期。

# configuration - 我可以让 Nginx 以不同的方式记录某些类型的请求吗？

> ID：513377
> 
> 赞同：2
> 
> 时间：2009-02-04T21:14:05.873
> 
> 标签：configuration, logging, nginx

我希望 Nginx 将以*/path*开头的请求记录到某个日志文件。像这样：

*   *[http://domain.com/path/to/dir](http://domain.com/path/to/dir)* =**已记录**
*   *[http://www.domain.com/to/some/dir/path/](http://www.domain.com/to/some/dir/path/)* =**未记录**
*   *[http://sub.domain.com/](http://sub.domain.com/)* =**未记录**

抱歉，如果这含糊不清，但我是 nginx 配置业务的新手。随时问我在做什么的问题，我会尽我所能回答他们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T21:54:05.200

```
location /foobar {
 access_log /var/log/foobar.log;
} 
```

# c# - MSI、UAC 和身份不明的发布者。如何更改身份不明的发布者？

> ID：513379
> 
> 赞同：18
> 
> 时间：2009-02-04T21:14:10.677
> 
> 标签：c#, windows-installer, certificate, uac

我目前正在为我的一个应用程序开发一个 MSI 包。它运作良好；但是，在安装开始之前，我收到了预期的 UAC 窗口，询问我是否信任来自*Unidentified Publisher*的这个程序。**我关心的不是 UAC 本身，而是*Unidentified Publisher*。我该如何改变呢？**我听说我需要一个特殊的证书......如果是这种情况，我在哪里可以得到它？

[![替代文字](https://i.stack.imgur.com/rcxbk.png)](https://i.stack.imgur.com/rcxbk.png)
[（来源：[backuphowto.info](http://www.backuphowto.info/files/images/review/2008/04/shadowexplorer/shadowexplorer-1.png)）]

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2009-02-04T22:34:16.773

这是一个很好的参考...

[John Robbin 的代码签名文章](http://www.wintellect.com/cs/blogs/jrobbins/archive/2007/12/21/code-signing-it-s-cheaper-and-easier-than-you-thought.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-04T22:34:33.230

您需要一个***代码签名证书。***

我使用并推荐[Comodo](http://www.comodo.com/)，它的费用[仅为 179 美元/年](http://www.instantssl.com/code-signing/)。[与 Verisign 每年 499 美元](http://www.verisign.com/products-services/security-services/code-signing/digital-ids-code-signing/index.html)相比，这是一个真正的便宜货

# cocoa-touch - UIScrollView的减速率可以修改吗？

> ID：513396
> 
> 赞同：27
> 
> 时间：2009-02-04T21:18:25.070
> 
> 标签：cocoa-touch

**由于最初提出此问题，因此通过OS 3.0 中引入的[decelerationRate 属性添加了 UIScrollView 减速率自定义。](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/doc/uid/TP40006922-CH3-DontLinkElementID_2)**

* * *

我有一个 UIScrollView 我想改变它的减速率。为了清楚起见，我说的是当您在滚动视图上滑动手指并且在您抬起手指后视图继续滚动（但逐渐变慢）时。我想提高减速率，使其比默认情况下更快停止。

我见过一些应用程序，其中 UIScrollViews 似乎减速得更快。UIScrollView 中似乎没有用于此的 API，但我想知道是否有其他方法可以做到这一点。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-01-03T11:23:17.337

您可以使用[UIScrollView](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html)的[decelerationRate](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIScrollView_Class/Reference/UIScrollView.html#//apple_ref/doc/uid/TP40006922-CH3-SW44)属性来控制它。即使它是浮动的，**它也不接受 UIScrollViewDecelerationRateNormal 或 UIScrollViewDecelerationRateFast 以外的任何值**。看下面的代码

```
NSLog(@"1\. decelerationRate %f", scrollview.decelerationRate);

scrollview.decelerationRate = UIScrollViewDecelerationRateNormal;
NSLog(@"2\. decelerationRate %f", scrollview.decelerationRate);

scrollview.decelerationRate = UIScrollViewDecelerationRateFast;
NSLog(@"3\. decelerationRate %f", scrollview.decelerationRate);

scrollview.decelerationRate = 0.7;
NSLog(@"4\. decelerationRate %f", scrollview.decelerationRate);

scrollview.decelerationRate = 0.995;
NSLog(@"5\. decelerationRate %f", scrollview.decelerationRate); 
```

上面的代码给出了以下输出，很明显我们不能不使用自定义减速率。

```
2012-01-03 11:59:41.164 testviewv2[10023:707] 1\. decelerationRate 0.998000
2012-01-03 11:59:41.172 testviewv2[10023:707] 2\. decelerationRate 0.998000
2012-01-03 11:59:41.173 testviewv2[10023:707] 3\. decelerationRate 0.990000
2012-01-03 11:59:41.175 testviewv2[10023:707] 4\. decelerationRate 0.990000
2012-01-03 11:59:41.176 testviewv2[10023:707] 5\. decelerationRate 0.998000 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2010-08-11T22:00:40.327

是的，我通过执行以下操作成功更改了减速率：

```
scrollView.decelerationRate = UIScrollViewDecelerationRateFast; 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2012-06-30T04:18:02.513

我发现通过使用 KVC 修改实例变量，`_decelerationFactor`我可以将速率更改为`UIScrollViewDecelerationRateNormal`or以外的值`UIScrollViewDecelerationRateFast`。我`UIScrollView`将所有内容子类化并包装在一个 try 块中

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code
        @try {
            CGFloat decelerationRate = UIScrollViewDecelerationRateFast +(UIScrollViewDecelerationRateNormal - UIScrollViewDecelerationRateFast) * .52;
            [self setValue:[NSValue valueWithCGSize:CGSizeMake(decelerationRate,decelerationRate)] forKey:@"_decelerationFactor"];

        }
        @catch (NSException *exception) {
            // if they modify the way it works under us.
        }

    }
    return self;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-02-23T19:46:15.600

有一个非常简单的方法。覆盖setter方法。

```
@interface UIArbitraryDeceleratingScrollView : UIScrollView

@property(nonatomic,assign) CGFloat decelerationRate;

@end

@implementation UIArbitraryDeceleratingScrollView

@synthesize decelerationRate = _decelerationRate;

- (void)setDecelerationRate:(CGFloat)dr
{
    [super setDecelerationRate:dr];
    _decelerationRate = dr;
}

@end 
```

现在分配您想要的，例如：

```
_scroller.decelerationRate = (UIScrollViewDecelerationRateNormal+UIScrollViewDecelerationRateFast)/2.1; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T21:22:38.977

这是可能的，但您必须继承 UIScrollView 并覆盖所有触摸处理。这不会是我选择的项目——它需要大量的工作才能让它正确。

# c# - C# 中的匿名委托和泛型列表

> ID：513397
> 
> 赞同：5
> 
> 时间：2009-02-04T21:18:28.127
> 
> 标签：c#, generics, anonymous-delegates

你能解释一下下面的代码吗：

```
private static List<Post> _Posts;
public static Post GetPost(Guid id)
{
    return _Posts.Find(delegate(Post p)
    {
        return p.Id == id;
    });
} 
```

1.  通过这种方式在通用列表中查找对象有什么意义？他可以简单地迭代列表。

2.  这个委托方法如何调用 list 的每个元素？

**注意：**如果这有一个通用名称，你能更新我的问题的标题吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-04T21:43:14.270

您说得对，他可以遍历列表，您可以将问题中的代码视为在概念上与以下代码相同：

```
private static Post GetPost(Guid id)
{
    Post p = default(Post);

    foreach (Post post in _Posts)
    {
        if (post.Id == id)
        {
            p = post;
            break;
        }
    }

    return p;
} 
```

它需要更少的代码来编写你的代码片段，重要的是你现在说的是你想要找到的东西，而不是如何找到它：

```
private static Post GetPost(Guid id)
{
    return _Posts.Find(delegate(Post p)
    {
        return p.Id == id;
    });
} 
```

在 C# 3.0 中，这可以使用所谓的“ [lambda 表达式](http://msdn.microsoft.com/en-us/library/bb397687.aspx)”进一步缩短为：

```
private static Post NewGetPost(Guid id)
{
    return _Posts.Find(p => p.Id == id);
} 
```

使用最少的可读代码来实现相同的目标使该代码的编写者和读者都更快乐。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T21:22:34.437

他正在使用匿名代表。他本可以使用[lambda 表达式](http://msdn.microsoft.com/en-us/library/bb397687.aspx)：

```
Posts.Find(p => p.Id == id) 
```

此外，在方法中包装对列表的访问在这种情况下没有任何效果，并且会将列表的元素暴露给外部调用者。这是不好的做法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T21:24:38.100

1.  List 基本上遍历每个元素并检查该元素是否为此返回 true `Predicate<T>`。它本质上是一个快捷方式，因此您不必遍历列表。`List<T>.Find(Predicate<T>)`可能还有一些内置的优化。
2.  您使用以下语法调用委托：

`delegateInstance(arg1,arg2);`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T21:23:31.097

如果您使用 C# 3.0 或更高版本，您可以使用 Linq 在列表中快速查找对象。

```
public static Post GetPost(Guid id)
{
    return (from p in _Posts
            where p.Id == id
            select p).First();
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T22:14:56.717

List.Find(Predicate match) 不是 LINQ 扩展方法，因为该方法自 2.0 以来就已在框架中，如 MSDN 所示。其次，使用 Find() 没有任何问题。它往往比它的替代品更具可读性：

经典的：

```
public static Post GetPost(Guid id)
{
  bool found = false;

  foreach(post in _Posts)
  { 
    if post.Id == id return post;
  }
  return default(Post);
} 
```

林克：

```
public static Post GetPost(Guid id)
{
  var post = (
    from p in _Posts 
    where p.Id = id 
    select p
  ).FirstOrDefault();
} 
```

使用 List.Find() 会立即告诉您您正在寻找一个项目，而另一个您必须遵循逻辑来确定这一点。Find() 基本上封装了对列表项的迭代。如果您在 Post 类上有一个方法，`public bool HasId(Guid id)`那么您可以编写

```
_Post.Find(post.HasId(id)); 
```

# excel - EXCEL VBA CSV 日期格式问题

> ID：513400
> 
> 赞同：2
> 
> 时间：2009-02-04T21:19:26.080
> 
> 标签：excel, vba

我是 Excel VBA 新手。如果我问的是一个明显的问题，我深表歉意。我有一个在 Excel 工作表中打开的 CSV 文本文件。文件的一行包含格式为“YY-MMM”的日期信息（即：9-FEB 或 10-MAY）。当 Excel 电子表格打开文件时，日期信息将更改为“mm/dd/yyyy”格式并读作 02/09/2009 或 05/10/2009，其中 YY-MMM 现在是 MM/YY/2009，（即：9-FEB 变为 02/09/2009，10-MAY 变为 05/10 /2009）。

我想知道是否可以将字段从 YY-MMM 重新格式化为 mm/01/yyyy。

我试图在将日期字段转换为文本后解析它

```
Range("B11", "IV11").NumberFormat = "text" 
```

但是，该值是序列日期且不可解析。

我一直没有成功寻找 NumberFormat 选项的列表。

如果您能指出我的方向，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T22:20:11.573

只是为了回答您的部分问题，以下是日期格式选项列表（不包括时间）：

```
d = day of month, e.g. 7
dd = zero-padded day of month, e.g. 07
ddd = abbreviated day name, e.g. Thu
dddd = full day name, e.g. Thursday 
```

一个月差不多。。。

```
m = month number, e.g. 7
mm = zero padded month number, e.g. 07
mmm = abbreviated month name, e.g. Jul
mmmm = full month name, e.g. July 
```

岁月更简单...

```
yy = 2 digit year number, e.g. 09
yyyy = 4 digit year number, e.g. 2009 
```

您可以将它们组合起来并在其中放置您喜欢的任何分隔符

例如

```
YY-MMM, 09-FEB
DDDD-DD-MMM-YY, Wednesday-04-Feb-09
dd/mm/yyyy, 04/02/2009
mm/dd/yyyy, 02/04/2009 
```

我刚刚尝试了一些事情，我认为您最好的选择是更改文本文件中的格式以符合更标准的日期安排。如果你可以反转它们（例如 MMM-YY），你会很好，或者将它们分成单独的列（如果你在导入时定义 - 作为分隔符和逗号？）。这是 Excel 试图变得聪明是一种痛苦的情况。

高温高压

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T02:04:36.020

如果您当前正在使用`File > Open`打开 CSV 文件，请尝试`Data > Import External Data > Import Data`改用。这会调出文本导入向导，这可能会让您在如何导入文件方面更加灵活。具体来说，它允许您将文件中的列声明为文本，以便 Excel 不会尝试解析该值

正如西蒙所解释的，您对当前日期格式的术语不正确。`9-FEB`对应于`d-mmm`格式和`02-19-2009`（注意，在此示例中故意更改为明确的日期；2009 年 2 月 9 日在美国是 2 月 9 日，但在英国是 9 月 2 日）对应于`mm-dd-yyyy`

如果您想更改`NumberFormat`从单元格 B11 开始并以单元格 IV11 结束的范围的文本，那么您将使用：

`Range("B11:IV11").NumberFormat = "@"`

@ 表示文本格式，您需要 : 运算符来指示连续的单元格范围。您的原始示例`Range("B11","IV11")`实际上表明单元格 B11 和 IV11 的联合，因此只会影响两个单元格

将数据结构化为行而不是列是不寻常的。与其将您的日期放在第 11 行中，不如将它们放在 K 列中更常见，这样您就可以使用`Range("K2:K65535")`或仅使用`Rows("K")`大多数内置的 Excel 内容（如排序和自动筛选）假设您的数据无论如何都按列排列. 第 1 行通常包含列名，然后每个后续行包含一条单独的记录。您可能想查看如何生成 CSV 文件，看看是否可以将其切换为更可用的基于列的结构

如果您`19-FEB`在单元格中有一个类似于文本的日期，那么假设您总是希望年份部分是当前年份，您可以将其更改为`mm/dd/yyyy`VBA 格式的月份的第一天。此示例仅更改一个单元格，但您可以将其用作更广泛解决方案的基础：

```
Option Explicit

Sub main()

Dim strOrigValue As String

With ThisWorkbook.Worksheets("Sheet1").Range("B11")
    strOrigValue = .Value

    .NumberFormat = "mm/dd/yyyy"
    .Value = DateSerial(Year(Date), Month(strOrigValue), 1)
End With

End Sub 
```

`DateSerial`根据给定的年、月和日创建日期序列号。`Year(Date)`从当前系统日期中提取年份部分，从`Month(strOrigValue)`单元格中已经存在的数据中提取月份部分，我们想要该月的第一天

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-12-01T22:48:07.937

为了读取日期，您可以执行以下操作：

```
myDate = DateValue(dateText) 
```

尽管对于 excel 如何解释日期以及它在可能存储的日期方面有哪些技术限制存在一些警告。（您可能需要阅读最大和最小日期，以及 excel 如何解释两位数 >30 与 <30 的年份等）

为了格式化日期，您可以使用以下三个功能之一：

```
myDateText = DatePart("yyyy", myDate) & "/" & DatePart("mm", myDate) & "/" & DatePart("dd", myDate) 
```

或这个

```
Format (myDate, "yyyy/mm/dd") 
```

或这个

```
FormatDateTime(#1/1/2020#, vbShortDate) 
```

您可以搜索 google 以获取有关每个功能的更多文档。对于 format 函数，你会想找到一个很好的参考——我见过一些相当不完整的参考。MSDN 往往有好的，但并非总是如此。如果您想了解更多详细信息，请随意提出此答案。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2009-02-04T22:10:44.620

这假设您的 2 位数年份是 2000。一旦您的日期不正确 9-Feb = 02/02/2009，您可以使用以下公式将其转换为您想要的日期：=DATE(Day(B11)+2000,月(B11),1)

# asp.net - LINQ to SQL：在 SQL 2000 上使用手动关联进行内部连接

> ID：513401
> 
> 赞同：2
> 
> 时间：2009-02-04T21:19:30.793
> 
> 标签：asp.net, sql, vb.net, linq, linq-to-sql

我有两张表处于一对多关系中。（产品和数量打破定价）。在数据库级别，我无法在两个表之间创建关系。我将这两个表带入 LINQ 并手动创建了关联。

我需要做一个大的 LINQ 查询并连接表。我的问题是它没有使用连接来获取数据。LINQ 在主表上使用 1 次选择，然后为该主表中的每一行选择 1 次。

```
Dim db As New LSSStyleDataContext(connString)

Dim options As New DataLoadOptions()
options.LoadWith(Function(c As commerce_product) c.commerce_qty_breaks)
db.LoadOptions = options

Dim dbProducts = (From prods In db.commerce_products).ToList 
```

关于为什么会这样的任何想法？谢谢！保罗

编辑：这是两个表：

```
CREATE TABLE [dbo].[commerce_product](
    [pf_id] [int] NOT NULL,
    [name] [varchar](500) COLLATE SQL_Latin1_General_CP1_CI_AS         
    [description] [text] COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
    [restricted] [varchar](5) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
   CONSTRAINT [PK_commerce_product_1] PRIMARY KEY NONCLUSTERED 
 (
    [pf_id] ASC
  ) ON [PRIMARY]
  ) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY] 
```

还有另一张桌子：

```
CREATE TABLE [dbo].[commerce_qty_break](
    [pf_id] [int] NOT NULL,
    [sku] [varchar](100) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,
    [qty] [int] NOT NULL,
    [list_price] [int] NOT NULL,
    [break_id] [int] NOT NULL,
    CONSTRAINT [PK_commerce_qty_break] PRIMARY KEY CLUSTERED 
    (
    [pf_id] ASC,
    [qty] ASC,
    [break_id] ASC
    ) ON [PRIMARY]
    ) ON [PRIMARY] 
```

DBML 很简单，只有两个表。我在两个表之间创建了一个关联，“commerce_product”是父表，“commerce_qty_break”是由“PF_ID”加入的子表。

我可以这样写：

```
Dim dbproducts = From prods In db.commerce_products _
    Join qtys In db.commerce_qty_breaks On prods.pf_id Equals qtys.pf_id _
    Select prods 
```

而且我看到它在查询中加入了表，但是一旦我尝试旋转“qty_breaks”，它就会开始执行选择以获取该信息。

我完全被难住了。

编辑 2：这是 DBML：

```
<?xml version="1.0" encoding="utf-8"?>
<Database Name="LSScommerceDB_DevB" Class="LSSStyleDataContext" xmlns="http://schemas.microsoft.com/linqtosql/dbml/2007">
  <Connection Mode="AppSettings" ConnectionString="***" SettingsObjectName="HSLPriceUpdate.My.MySettings" SettingsPropertyName="LSScommerceDB_DevBConnectionString" Provider="System.Data.SqlClient" />
  <Table Name="dbo.commerce_product" Member="commerce_products">
    <Type Name="commerce_product">
      <Column Name="pf_id" Type="System.Int32" DbType="Int NOT NULL" IsPrimaryKey="true" CanBeNull="false" />
      <Column Name="name" Type="System.String" DbType="VarChar(500)" CanBeNull="true" />
      <Column Name="description" Type="System.String" DbType="Text" CanBeNull="true" UpdateCheck="Never" />
      <Column Name="list_price" Type="System.Int32" DbType="Int" CanBeNull="true" />
      <Column Name="image_file" Type="System.String" DbType="VarChar(255)" CanBeNull="true" />
      <Column Name="image_width" Type="System.Int32" DbType="Int" CanBeNull="true" />
      <Column Name="image_height" Type="System.Int32" DbType="Int" CanBeNull="true" />
      <Column Name="sale_price" Type="System.Int32" DbType="Int" CanBeNull="true" />
      <Column Name="sale_start" Type="System.DateTime" DbType="DateTime" CanBeNull="true" />
      <Column Name="sale_end" Type="System.DateTime" DbType="DateTime" CanBeNull="true" />
      <Column Name="attr_label1" Type="System.String" DbType="VarChar(100)" CanBeNull="true" />
      <Column Name="attr_label2" Type="System.String" DbType="VarChar(100)" CanBeNull="true" />
      <Column Name="attr_label3" Type="System.String" DbType="VarChar(100)" CanBeNull="true" />
      <Column Name="attr_label4" Type="System.String" DbType="VarChar(100)" CanBeNull="true" />
      <Column Name="attr_label5" Type="System.String" DbType="VarChar(100)" CanBeNull="true" />
      <Column Name="sku" Type="System.String" DbType="VarChar(100)" CanBeNull="true" />
      <Column Name="UOM" Type="System.String" DbType="VarChar(50)" CanBeNull="true" />
      <Column Name="Sell_Pack" Type="System.String" DbType="VarChar(50)" CanBeNull="true" />
      <Column Name="mfg_model_number" Type="System.String" DbType="VarChar(50)" CanBeNull="true" />
      <Column Name="mfg_id" Type="System.Int32" DbType="Int" CanBeNull="true" />
      <Column Name="logo_file" Type="System.String" DbType="VarChar(255)" CanBeNull="true" />
      <Column Name="drop_ship" Type="System.String" DbType="VarChar(50)" CanBeNull="true" />
      <Column Name="lead_time" Type="System.Int32" DbType="Int" CanBeNull="true" />
      <Column Name="hazard_flag" Type="System.String" DbType="VarChar(50)" CanBeNull="true" />
      <Column Name="publish_date" Type="System.DateTime" DbType="DateTime" CanBeNull="true" />
      <Column Name="restricted" Type="System.String" DbType="VarChar(5)" CanBeNull="true" />
      <Association Name="commerce_product_commerce_qty_break" Member="commerce_qty_breaks" ThisKey="pf_id" OtherKey="pf_id" Type="commerce_qty_break" />
    </Type>
  </Table>
  <Table Name="dbo.commerce_qty_break" Member="commerce_qty_breaks">
    <Type Name="commerce_qty_break">
      <Column Name="pf_id" Type="System.Int32" DbType="Int NOT NULL" IsPrimaryKey="true" CanBeNull="false" />
      <Column Name="sku" Type="System.String" DbType="VarChar(100) NOT NULL" CanBeNull="false" />
      <Column Name="qty" Type="System.Int32" DbType="Int NOT NULL" IsPrimaryKey="true" CanBeNull="false" />
      <Column Name="list_price" Type="System.Int32" DbType="Int NOT NULL" CanBeNull="false" />
      <Column Name="sale_price" Type="System.Int32" DbType="Int" CanBeNull="true" />
      <Column Name="sale_start" Type="System.DateTime" DbType="DateTime NOT NULL" CanBeNull="false" />
      <Column Name="sale_end" Type="System.DateTime" DbType="DateTime" CanBeNull="true" />
      <Column Name="break_id" Type="System.Int32" DbType="Int NOT NULL" IsPrimaryKey="true" CanBeNull="false" />
      <Association Name="commerce_product_commerce_qty_break" Member="commerce_product" ThisKey="pf_id" OtherKey="pf_id" Type="commerce_product" IsForeignKey="true" />
    </Type>
  </Table>
</Database> 
```

编辑 3：显然这只是 SQL 2000 中的一个问题。SQL 2008 工作正常。我有其他表在 SQL 2000 中进行预加载，但我不知道这两个表之间有什么区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-07T07:22:27.733

我创建了一个 VB 控制台应用程序并在此处创建了架构。

另外-关系是PK-> PK，这是否意味着它应该是一对一的关系？

我在表格中分别填充了一行（见下文）并运行了您在上面列出的代码。我运行了 SQL Profiler，它只查询了一次：

```
SELECT [t0].[pf_id], [t0].[name], [t0].[description], [t0].[restricted], 
[t1].[pf_id] AS [pf_id2], [t1].[sku], [t1].[qty], [t1].[list_price], 
[t1].[break_id], (
SELECT COUNT(*)
FROM [dbo].[commerce_qty_break] AS [t2]
WHERE [t2].[pf_id] = [t0].[pf_id]
) AS [value]
FROM [dbo].[commerce_product] AS [t0]
LEFT OUTER JOIN [dbo].[commerce_qty_break] AS [t1] ON [t1].[pf_id] = [t0].[pf_id]
ORDER BY [t0].[pf_id], [t1].[qty], [t1].[break_id] 
```

我想确保数据选项强制进行深度加载，所以我添加了一些额外的代码 - 这是我使用的完整代码（并且只跟踪了上面的单个查询）：

```
Dim options As New DataLoadOptions()

options.LoadWith(Function(c As commerce_product) c.commerce_qty_breaks)
db.LoadOptions = options

Dim dbProducts = (From prods In db.commerce_products).ToList

Dim dbProduct = dbProducts.First().commerce_qty_breaks
Dim x = dbProduct.First().list_price 
```

这是测试数据：

```
INSERT INTO [Test].[dbo].[commerce_product] ([pf_id],[name],[description],[restricted]) VALUES (1,'Test','Test','Test')
GO
INSERT INTO [Test].[dbo].[commerce_qty_break] ([pf_id],[sku],[qty],[list_price],[break_id]) VALUES (1,'22',1,1,1)
GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T23:13:42.777

嘿，我不确定我是否完全理解你的问题，但这里有一些信息，

默认情况下，LINQ to SQL 采用惰性绑定，这意味着它不会在需要时查询数据库。这就是您收到多个查询的原因。

您可以做一些事情来避免对数据库的多次点击：

1.  您可以在 LINQ to SQL 设计器中全局关闭延迟绑定。但是，如果您的表有任何关系，您将始终执行 JOINS。

2.  您在 LINQ 查询中手动执行 JOIN。如果这样做，则必须指定要在 LINQ 查询中返回的“字段”以取回 JOINED 数据。如果你这样做，那么你将返回一个匿名类型

**注意：** LINQ to SQL 不支持左连接。如果你用谷歌搜索 LINQ to SQL Left Joins，你会看到很多关于这个特定主题的信息

干杯，祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-11T16:58:20.087

去抢[LINQPad](http://www.linqpad.net/)。玩这样的东西非常棒。

你尝试过这样的事情吗？

```
Dim dbproducts = From prods In db.commerce_products _
    Join qtys In db.commerce_qty_breaks On prods.pf_id Equals qtys.pf_id _
    Select new {prods, qtys} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-08-25T19:00:43.497

我最终使用了实体框架，一切都很好。

# asp.net - using 语句是否阻止我关闭或销毁对象？

> ID：513407
> 
> 赞同：3
> 
> 时间：2009-02-04T21:20:37.280
> 
> 标签：asp.net, using

如果我使用类似的东西：

```
using (OdbcConnection conn = new OdbcConnection(....))
{
  conn.open();
  my commands and sql, etc.
} 
```

我必须做一个 conn.close(); 还是 using 语句使我无法进行最后一次通话？它会处理 using 块中的所有内容吗？例如，如果我调用其他不相关的对象，它是否也会自动处理这些对象？

谢谢你。在阅读了有关在 Microsoft 网站上使用的信息后，我不清楚。我想确保我没有任何内存泄漏。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T21:26:13.337

1.  using 块将处理 OdbcConnection。
2.  正常范围规则适用于 using 块内声明的任何内容。
3.  using 块不会清理任何其他 IDisposable 对象。它只清理声明的项目
    *   请注意，您可以使用块进行嵌套，或者如果项目是相同的类型，则可以同时初始化多个项目。

[有关如何在 C#](https://stackoverflow.com/questions/185381/how-do-i-programmatically-use-the-using-keyword-in-c/185636#185636)中使用 using 关键字的更多信息，请参阅我的其他答案的顶部。

我还应该提到，您可以在完成连接以释放资源后立即关闭（处置）连接。指导方针说调用者应该能够重复调用 dispose 方法。using 块本质上只是一个安全网，允许在大多数情况下编写更清晰的代码。

* * *

[编辑] 例如 using 中的多个初始化：如果对象是相同的类型，则在同一 using 中初始化多个对象，而无需嵌套 using 块：

```
using (Bitmap b1 = new Bitmap("file1"), b2 = new Bitmap("file2")) 
{ ... } 
```

Joel Coehoorn 提到了堆叠，这是嵌套但省略了大括号，就像您可以在`for`, or`if`语句中省略大括号一样。UI 不会使用缩进重新格式化。我很好奇IL是什么样的。

```
using(Bitmap b = new Bitmap("filex"))
using(Graphics g = Graphics.FromImage(b))
{ 
} 
```

使用将不同的对象放在同一个使用中是错误的`error CS1044: Cannot use more than one type in a for, using, fixed, or declaration statement.`

```
// error CS1044
using(Bitmap b = new Bitmap("filex"), Graphics g = Graphics.FromImage(b)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T21:21:46.187

using 语句将为您处理调用 Close 和 Dispose 方法。

[Scott Hanselman](http://www.hanselman.com/blog/WhyTheUsingStatementIsBetterThanASharpStickInTheEyeAndASqlConnectionRefactoringExample.aspx)对 using 语句有一个很好的解释。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T21:27:21.900

using 语句确保实现 IDisposable 的对象被释放。它只会处理在 using 块中引用的对象，因此您的代码基本上等同于：

```
OdbcConnection conn = new ....;
try
{
   conn.open();
   conn.....
}
finally
{
   conn.dispose();
} 
```

# asp.net - 从控制台应用程序打开 web.config？

> ID：513410
> 
> 赞同：24
> 
> 时间：2009-02-04T21:21:03.473
> 
> 标签：asp.net, web-config

我有一个控制台 capplication，它在托管一堆 web.config 文件的同一台计算机上运行。我需要控制台应用程序打开每个 web.config 文件并解密连接字符串，然后测试连接字符串是否有效。

我遇到的问题是 OpenExeConfiguration 需要一个 winforms 应用程序配置文件 (app.dll.config) 并且 OpenWebConfiguration 需要通过 IIS 运行。因为这是我的本地机器，所以我没有运行 IIS（我使用 Visual Studio 的内置服务器）。

有没有一种方法可以打开 web.config 文件，同时仍然获得 .NET 解密连接字符串的功能的稳健性？

谢谢

**更新** 如果您直接查询 IIS 或者是您要查找 web.config 的相关网站，则 OpenWebConfiguration 有效。我想要完成的是相同类型的功能，但是从控制台应用程序打开我的同一台机器上的网站的 web.config 文件，而不使用 IIS 查询，因为 IIS 没有在我的机器上运行。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-05T15:48:17.697

好的，我明白了...编译并访问了它，所以我知道它可以工作...

```
 VirtualDirectoryMapping vdm = new VirtualDirectoryMapping(@"C:\test", true);
            WebConfigurationFileMap wcfm = new WebConfigurationFileMap();
            wcfm.VirtualDirectories.Add("/", vdm);

            // Get the Web application configuration object.
            Configuration config = WebConfigurationManager.OpenMappedWebConfiguration(wcfm, "/");

            ProtectSection(config, @"connectionStrings", "DataProtectionConfigurationProvider"); 
```

这是假设您在名为 C:\Test 的目录中有一个名为 web.config 的文件。

我调整了@Dillie-O 的方法以将配置作为参数。

您还必须引用 System.Web 和 System.configuration 以及包含在 web.config 中设置的配置处理程序的任何 dll。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T21:52:34.297

当 ConfigurationManager 类从配置文件中抓取一个部分时，它具有一个“IsProtected”属性，它可以为您抓取的给定部分推断出该属性。如果它受到保护，您可以使用一些代码取消保护它。

加密/解密的基本方法是这样的（取自下面的文章链接）：

```
private void ProtectSection(string sectionName, string provider)
{
    Configuration config =
        WebConfigurationManager.
            OpenWebConfiguration(Request.ApplicationPath);

    ConfigurationSection section =
                 config.GetSection(sectionName);

    if (section != null &&
              !section.SectionInformation.IsProtected)
    {
        section.SectionInformation.ProtectSection(provider);
        config.Save();
    }
}

private void UnProtectSection(string sectionName)
{
    Configuration config =
        WebConfigurationManager.
            OpenWebConfiguration(Request.ApplicationPath);

    ConfigurationSection section =
              config.GetSection(sectionName);

    if (section != null &&
          section.SectionInformation.IsProtected)
    {
        section.SectionInformation.UnprotectSection();
        config.Save();
    }
} 
```

查看[这篇文章](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)以获取有关使用此功能的完整详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-06T21:42:57.913

```
 public static string WebKey(string key)
    {

        var configFile = new System.IO.FileInfo(webconfigPath);
        var vdm = new VirtualDirectoryMapping(configFile.DirectoryName, true, configFile.Name);
        var wcfm = new WebConfigurationFileMap();
        wcfm.VirtualDirectories.Add("/", vdm);
        System.Configuration.Configuration config = WebConfigurationManager.OpenMappedWebConfiguration(wcfm, "/");
        System.Configuration.AppSettingsSection appSettingSection = (System.Configuration.AppSettingsSection)config.GetSection("appSettings");
        System.Configuration.KeyValueConfigurationElement kv = appSettingSection.Settings.AllKeys
                         .Where(x => x.Equals(key))
                         .Select(x => appSettingSection.Settings[key])
                         .FirstOrDefault();

        return kv != null ? kv.Value : string.Empty;

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T22:54:23.737

我认为您想使用 WebConfigurationManager 类及其[OpenWebConfiguration](http://msdn.microsoft.com/en-us/library/ms151456.aspx)方法。

它需要一个指向 web.config 的路径，并且应该像在基于 HTTPContext 的应用程序中一样打开它。

# .net - RegexOptions.Compiled 是如何工作的？

> ID：513412
> 
> 赞同：180
> 
> 时间：2009-02-04T21:21:22.537
> 
> 标签：.net, regex

当您将正则表达式标记为要编译的正则表达式时，幕后发生了什么？这个比较/与缓存的正则表达式有何不同？

使用这些信息，您如何确定与性能提升相比，计算成本何时可以忽略不计？

* * *

## 回答 #1

> 赞同：319
> 
> 时间：2011-10-09T23:49:24.550

`RegexOptions.Compiled`[指示正则表达式引擎使用轻量级代码生成 ( LCG](https://docs.microsoft.com/en-us/archive/blogs/joelpob/hello-world-lcg-lightweight-code-gen-style) )将正则表达式表达式编译为 IL 。这种编译发生在对象的构建过程中，并**大大**减慢了它的速度。反过来，使用正则表达式的匹配更快。

如果您不指定此标志，则您的正则表达式将被视为“已解释”。

举个例子：

```
public static void TimeAction(string description, int times, Action func)
{
    // warmup
    func();

    var watch = new Stopwatch();
    watch.Start();
    for (int i = 0; i < times; i++)
    {
        func();
    }
    watch.Stop();
    Console.Write(description);
    Console.WriteLine(" Time Elapsed {0} ms", watch.ElapsedMilliseconds);
}

static void Main(string[] args)
{
    var simple = "^\\d+$";
    var medium = @"^((to|from)\W)?(?<url>http://[\w\.:]+)/questions/(?<questionId>\d+)(/(\w|-)*)?(/(?<answerId>\d+))?";
    var complex = @"^(([^<>()[\]\\.,;:\s@""]+"
      + @"(\.[^<>()[\]\\.,;:\s@""]+)*)|("".+""))@"
      + @"((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}"
      + @"\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+"
      + @"[a-zA-Z]{2,}))$";

    string[] numbers = new string[] {"1","two", "8378373", "38737", "3873783z"};
    string[] emails = new string[] { "sam@sam.com", "sss@s", "sjg@ddd.com.au.au", "onelongemail@oneverylongemail.com" };

    foreach (var item in new[] {
        new {Pattern = simple, Matches = numbers, Name = "Simple number match"},
        new {Pattern = medium, Matches = emails, Name = "Simple email match"},
        new {Pattern = complex, Matches = emails, Name = "Complex email match"}
    })
    {
        int i = 0;
        Regex regex;

        TimeAction(item.Name + " interpreted uncached single match (x1000)", 1000, () =>
        {
            regex = new Regex(item.Pattern);
            regex.Match(item.Matches[i++ % item.Matches.Length]);
        });

        i = 0;
        TimeAction(item.Name + " compiled uncached single match (x1000)", 1000, () =>
        {
            regex = new Regex(item.Pattern, RegexOptions.Compiled);
            regex.Match(item.Matches[i++ % item.Matches.Length]);
        });

        regex = new Regex(item.Pattern);
        i = 0;
        TimeAction(item.Name + " prepared interpreted match (x1000000)", 1000000, () =>
        {
            regex.Match(item.Matches[i++ % item.Matches.Length]);
        });

        regex = new Regex(item.Pattern, RegexOptions.Compiled);
        i = 0;
        TimeAction(item.Name + " prepared compiled match (x1000000)", 1000000, () =>
        {
            regex.Match(item.Matches[i++ % item.Matches.Length]);
        });

    }
} 
```

它对 3 个不同的正则表达式执行 4 次测试。首先，它测试一个**单独**的匹配项（已编译与未编译）。其次，它测试重用相同正则表达式的重复匹配。

我机器上的结果（在发行版中编译，没有附加调试器）

### 1000 个单一匹配项（构造正则表达式、匹配和处置）

```
类型 | 平台 | 平凡的数字 | 简单的电子邮件检查 | 分机电子邮件检查
-------------------------------------------------- ----------------------------
解释 | x86 | 4 毫秒 | 26 毫秒 | 31 毫秒
解释 | x64 | 5 毫秒 | 29 毫秒 | 35 毫秒
编译 | x86 | 913 毫秒 | 3775 毫秒 | 4487 毫秒
编译 | x64 | 3300 毫秒 | 21985 毫秒 | 22793 毫秒

```

### 1,000,000 次匹配 - 重用 Regex 对象

```
类型 | 平台 | 平凡的数字 | 简单的电子邮件检查 | 分机电子邮件检查
-------------------------------------------------- ----------------------------
解释 | x86 | 422 毫秒 | 461 毫秒 | 2122 毫秒
解释 | x64 | 436 毫秒 | 463 毫秒 | 2167 毫秒
编译 | x86 | 279 毫秒 | 166 毫秒 | 1268 毫秒
编译 | x64 | 281 毫秒 | 176 毫秒 | 1180 毫秒

```

这些结果表明，在重用对象的情况下，编译的正则表达式的速度可以提高**60% 。****然而**，在某些情况下，构建速度可能会慢**3 个数量级以上。**`Regex`

 ****它还表明，在编译正则表达式时，.NET的**x64 版本可能会****慢 5 到 6 倍。**

* * *

建议在以下情况下**使用编译版本**

1.  您不关心对象初始化成本并且需要额外的性能提升。（请注意，我们在这里谈论的是几分之一毫秒）
2.  您有点关心初始化成本，但是重用 Regex 对象的次数如此之多，以至于它将在您的应用程序生命周期中对其进行补偿。

* * *

### 工作中的 Spanner，Regex 缓存

正则表达式引擎包含一个 LRU 缓存，它保存使用类上的静态方法测试的最后 15 个正则表达式`Regex`。

例如：`Regex.Replace`等`Regex.Match`。都使用Regex缓存。

缓存的大小可以通过设置来增加[`Regex.CacheSize`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.cachesize.aspx)。它在应用程序的生命周期中随时接受大小更改。

新的正则表达式仅由Regex 类上**的静态助手缓存。**但是，如果您构造对象，则会检查缓存（以进行重用和碰撞），但是，您构造的正则表达式**不会附加到缓存**中。

这个缓存是一个**普通**的LRU 缓存，它是使用一个简单的双链表实现的。如果您碰巧将其增加到 5000，并在静态帮助程序上使用 5000 次不同的调用，则每个正则表达式构造都会抓取 5000 个条目以查看它之前是否已被缓存。检查周围有一个**锁**，因此检查会降低并行度并引入线程阻塞。

这个数字设置得非常低，以保护自己免受此类情况的影响，但在某些情况下，您可能别无选择，只能增加它。

我**强烈建议**永远**不要**将`RegexOptions.Compiled`选项传递给静态助手。

例如：

```
\\ WARNING: bad code
Regex.IsMatch("10000", @"\\d+", RegexOptions.Compiled) 
```

原因是您冒着丢失 LRU 缓存的风险，这将触发**超级昂贵**的编译。此外，您不知道您所依赖的库在做什么，因此几乎没有能力控制或预测缓存的**最佳**大小。

另请参阅：[BCL 团队博客](https://blogs.msdn.microsoft.com/bclteam/2010/06/25/optimizing-regular-expression-performance-part-i-working-with-the-regex-class-and-regex-objects-ron-petrusha/)

* * *

**注意**：这与 .NET 2.0 和 .NET 4.0 相关。4.5 中有一些预期的变化，可能会导致对其进行修订。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2009-02-04T21:31:00.347

BCL 团队博客中的这篇文章给出了一个很好的概述：“[正则表达式性能](http://blogs.msdn.com/bclteam/archive/2004/11/12/256783.aspx)”。

简而言之，有三种类型的正则表达式（每种执行速度都比前一种快）：

1.  **解释的**

    动态创建快，执行慢

2.  **已编译**（您似乎要问的那个）

    动态创建速度较慢，执行速度快（适合循环执行）

3.  **预编译**

    在您的应用程序的编译时创建（没有运行时创建惩罚），快速执行

因此，如果您打算只执行一次正则表达式，或者在应用程序的非性能关键部分（即用户输入验证）中执行，您可以使用选项 1。

如果您打算在循环中运行正则表达式（即逐行解析文件），则应使用选项 2。

如果您有许多正则表达式永远不会为您的应用程序更改并且被频繁使用，您可以选择选项 3。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-04T21:37:53.393

应该注意的是，自 .NET 2.0 以来，正则表达式的性能已经通过未编译的正则表达式的 MRU 缓存得到了改进。Regex 库代码不再每次都重新解释相同的未编译正则表达式。

因此，编译和运行的正则表达式可能会带来更大的性能*损失。*除了较慢的加载时间外，系统还使用更多内存来将正则表达式编译为操作码。

本质上，当前的建议要么不编译正则表达式，要么提前将它们编译成单独的程序集。

参考：BCL 团队博客[正则表达式性能 [David Gutierrez]](http://blogs.msdn.com/bclteam/archive/2004/11/12/256783.aspx)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T21:34:07.847

1)[编译正则表达式的基类库团队](http://blogs.msdn.com/bclteam/archive/2004/11/12/256783.aspx)

2) [Coding Horror，参考#1，权衡取舍](https://blog.codinghorror.com/to-compile-or-not-to-compile/)

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2019-08-04T06:35:45.630

我希望下面的代码能帮助你理解 re.compile 函数的概念

```
import re

x="""101 COM    Computers
205 MAT   Mathematics
189 ENG   English
222 SCI Science
333 TA  Tamil
5555 KA  Kannada
6666  TL  Telugu
777777 FR French
"""

#compile reg expression / successfully compiled regex can be used in any regex 
#functions    
find_subject_code=re.compile("\d+",re.M)
#using compiled regex in regex function way - 1
out=find_subject_code.findall(x)
print(out)
#using compiled regex in regex function way - 2
out=re.findall(find_numbers,x)
print(out)

#few more eg:
#find subject name
find_subjectnames=re.compile("(\w+$)",re.M) 
out=find_subjectnames.findall(x)
print(out)

#find subject SHORT name
find_subject_short_names=re.compile("[A-Z]{2,3}",re.M) 
out=find_subject_short_names.findall(x)
print(out) 
```

# php - 在 ZF 视图脚本中使用 FlashMessenger 和 PartialLoop

> ID：513417
> 
> 赞同：0
> 
> 时间：2009-02-04T21:22:11.927
> 
> 标签：php, zend-framework

我有两个与 FlashMessenger 视图助手相关的问题。这两个问题都是做这个代码：

我的操作方法：

```
private $_messages; // set to $this->_helper->FlashMessenger; in init()

public function loginAction() {
    // > login validation <

    // Switch based on the result code
    switch ($result->getCode()) {
        // > snip several cases <

        case Zend_Auth_Result::FAILURE_CREDENTIAL_INVALID:
            $this->_messages->addMessage("That wasn't the right password."); 
        break;

        case Zend_Auth_Result::SUCCESS:
            $this->_messages->addMessage('Logged you in successfully. Welcome back!');
            $this->_helper->Redirector('index', 'home');
        break;
    }

    // >snip<

    $this->view->messages = $this->_messages->getMessages();
    $this->render();
} 
```

我的布局（Zend_Layout）视图脚本：

```
<?php if (isset($this->messages) && count($this->messages) > 0) {
    print_r($this->messages);
    //$this->partialLoop('partials/messages.phtml', $this->messages);
} ?> 
```

### 为什么第一次设置消息不输出？

我有一种感觉，这与存储在会话中的信使有关，但我确信这与我的实现有关。

当我向表单提交错误值时，直到我再次发送表单或刷新后才会收到消息。

### 将其发送给`PartialLoop`助手的好方法是什么？

信使的输出类似于：

```
Array(
    [0] => 'Message',
    [1] => 'Second message' //etc.
) 
```

但这对 a 没有好处，`PartialLoop`因为我需要获取消息（它需要每条消息都是一个数组，包含一个`'message' => 'Message string'`键/值对）。

有没有更好的方法，而不是在将数组提交到视图之前重写数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T22:36:27.360

生病引用[文档](http://framework.zend.com/manual/en/zend.controller.actionhelpers.html#zend.controller.actionhelpers.flashmessenger)。

> 10.8.4.4.1。介绍
> 
> FlashMessenger 帮助器允许您传递用户可能需要在下一个请求中看到的消息。为此，FlashMessenger 使用 Zend_Session_Namespace 来存储消息以供将来或下一个请求检索。

基本上，这意味着是的，您必须刷新页面才能看到消息。

编辑 PartialLoop：

你可以试试这个：

```
foreach ($array as $message) {
  $newArray[]['message'] = $message;
} 
```

但是您不必使用 PartialLoop。您可以将其发送到 Partial 并在那里循环。或者甚至在你的视图中循环它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T08:11:06.640

关于[OIS](https://stackoverflow.com/questions/513417/using-flashmessenger-with-partialloop-in-zf-view-scripts/513707#513707)，我想补充一点，您可以在将它们添加到 FlashMessenger 的同一请求中检索 Flash 消息。在这种情况下，您必须使用`Zend_Controller_Action_Helper_FlashMessenger::getCurrentMessages()`.

在您的情况下，您必须更改线路

```
$this->view->messages = $this->_messages->getMessages(); 
```

到

```
$this->view->messages = $this->_messages->getCurrentMessages(); 
```

希望有帮助。

# javascript - 缩小 js 文件的 javascript 工具在哪里？

> ID：513419
> 
> 赞同：-1
> 
> 时间：2009-02-04T21:22:30.270
> 
> 标签：javascript

我找不到那个缩小 javascript 的工具。

它是一个基于java的工具。

我以为道格拉斯克劳福德做到了，但甚至在他的网站上都找不到！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T21:23:53.560

您在寻找 JSMin 吗？

[http://www.crockford.com/javascript/jsmin.html](http://www.crockford.com/javascript/jsmin.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T21:24:40.923

其中有很多。

*   [雅虎](http://developer.yahoo.com/yui/compressor/)
*   [Douglas Crockford 的在线界面](http://fmarcia.info/jsmin/test.html)

顺便说一句，Crockford 的工具是[“javascript minify”在 Google 上排名第二的结果](http://www.google.com/search?q=javascript+minify)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T21:24:38.193

好吧，如果您想要真正的道格拉斯·克罗克福德（Douglas **Crockford**），那就在这里：
[http://javascript.crockford.com/jsmin.html](http://javascript.crockford.com/jsmin.html)

否则，Google for "js minifier" 应该至少找到一些替代方案。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T21:24:56.647

我会使用[JSMin](http://crockford.com/javascript/jsmin)或[YUI Compressor](http://developer.yahoo.com/yui/compressor/)

两者都是很好的工具。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T21:27:29.433

[维基百科](http://en.wikipedia.org/wiki/Minify)中有一个完整的列表。不仅是 Javascript，而且至少有 3 个。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T21:24:12.843

[http://www.crockford.com/javascript/jsmin.html](http://www.crockford.com/javascript/jsmin.html)

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-04T21:25:15.367

你在想 Mike Hall 的[Crunchinator](http://www.brainjar.com/js/crunch/)吗？

# sharepoint - 如何将 Sharepoint 中的用户权限限制为单个调查

> ID：513420
> 
> 赞同：0
> 
> 时间：2009-02-04T21:22:33.063
> 
> 标签：sharepoint, sharepoint-2007, permissions

我在 Sharepoint 中设置了一个用户组，该用户组有权访问单个站点。我想限制这些组访问该站点内的单个调查。有没有办法将 Sharepoint 权限设置为更精细的级别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T21:29:42.347

您可以使用受限访问权限级别仅授予对特定列表、视图或页面的访问权限

进入您要授予人们访问权限的列表或视图，转到设置 --> 列表设置 --> 此列表的权限

然后，您可以将直接权限授予无权访问层次结构中更高级别的任何对象的用户。

# c++-cli - 有没有办法使用 C++/CLI 管理的枚举作为数组下标？

> ID：513423
> 
> 赞同：-1
> 
> 时间：2009-02-04T21:22:55.480
> 
> 标签：c++-cli

我有一个枚举声明为

```
enum class AccessLevel : int
{
    ReadOnly = 0,
    Excluded = 1,
    ReadWrite = 2,
}; 
```

和一个声明为的数组

```
static array<String^>^ _accessMap = gcnew array<String^> { "R", "X", "W" }; 
```

我想做这样的事情：

```
AccessLevel^ access = access::ReadOnly;
String^ foo = _accessMap[access]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T21:59:37.873

```
public enum struct AccessLevel
{
        ReadOnly = 0,
        Excluded = 1,
        ReadWrite = 2,
};

AccessLevel access = access::ReadOnly; 
```

您可能需要强制转换为 int

```
String^ foo = _accessMap[(int)access]; 
```

# xml - 在 C# LINQ to XML 中从 National Weather Service SOAP 服务解析 XML

> ID：513440
> 
> 赞同：2
> 
> 时间：2009-02-04T21:25:43.777
> 
> 标签：xml, linq, c#-3.0, weather

我是一名初级 C# 程序员，正在尝试开发一个库，该库将允许我封装解析从 NWS 返回的 XML 并返回表示数据的集合的讨厌细节。

我的 SOAP 请求会以这种形式返回一个 XML 文档：

```
<?xml version="1.0" encoding="UTF-8"?>
<dwml version="1.0" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://www.nws.noaa.gov/forecasts/xml/DWMLgen/schema/DWML.xsd">
  <head>
    <product srsName="WGS 1984" concise-name="time-series" operational-mode="official">
      <title>NOAA's National Weather Service Forecast Data</title>
      <field>meteorological</field>
      <category>forecast</category>
      <creation-date refresh-frequency="PT1H">2009-02-04T20:01:00Z</creation-date>
    </product>
    <source>
      <more-information>http://www.nws.noaa.gov/forecasts/xml/</more-information>
      <production-center>Meteorological Development Laboratory<sub-center>Product Generation Branch</sub-center></production-center>
      <disclaimer>http://www.nws.noaa.gov/disclaimer.html</disclaimer>
      <credit>http://www.weather.gov/</credit>
      <credit-logo>http://www.weather.gov/images/xml_logo.gif</credit-logo>
      <feedback>http://www.weather.gov/feedback.php</feedback>
    </source>
  </head>
  <data>
    <location>
      <location-key>point1</location-key>
      <point latitude="42.23" longitude="-83.27"/>
    </location>
    <moreWeatherInformation applicable-location="point1">http://forecast.weather.gov/MapClick.php?textField1=42.23&amp;textField2=-83.27</moreWeatherInformation>
    <time-layout time-coordinate="local" summarization="none">
      <layout-key>k-p24h-n7-1</layout-key>
      <start-valid-time>2009-02-04T07:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-04T19:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-05T07:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-05T19:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-06T07:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-06T19:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-07T07:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-07T19:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-08T07:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-08T19:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-09T07:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-09T19:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-10T07:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-10T19:00:00-05:00</end-valid-time>
    </time-layout>
    <time-layout time-coordinate="local" summarization="none">
      <layout-key>k-p24h-n6-2</layout-key>
      <start-valid-time>2009-02-04T19:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-05T08:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-05T19:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-06T08:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-06T19:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-07T08:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-07T19:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-08T08:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-08T19:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-09T08:00:00-05:00</end-valid-time>
      <start-valid-time>2009-02-09T19:00:00-05:00</start-valid-time>
      <end-valid-time>2009-02-10T08:00:00-05:00</end-valid-time>
    </time-layout>
    <parameters applicable-location="point1">
      <temperature type="maximum" units="Fahrenheit" time-layout="k-p24h-n7-1">
        <name>Daily Maximum Temperature</name>
        <value>15</value>
        <value>19</value>
        <value>33</value>
        <value>46</value>
        <value>41</value>
        <value>43</value>
        <value>44</value>
      </temperature>
      <temperature type="minimum" units="Fahrenheit" time-layout="k-p24h-n6-2">
        <name>Daily Minimum Temperature</name>
        <value>-2</value>
        <value>16</value>
        <value>29</value>
        <value>32</value>
        <value>27</value>
        <value>32</value>
      </temperature>
    </parameters>
  </data>
</dwml> 
```

我试图将这个 XML 中的最大和最小临时值放在单独的字符串集合中，同时使用 LINQ 忽略“名称”元素。

编辑：这是我用来从 Web 参考获取 XML 的代码：

```
 WeatherNWS.ndfdXML client = new TestNWS.WeatherNWS.ndfdXML();

    string XMLZip = client.LatLonListZipCode("48180");

    XElement myElement = XElement.Parse(XMLZip);
    string[] myString = myElement.Value.Split(',');

    decimal lat = Convert.ToDecimal(myString[0]);
    decimal lon = Convert.ToDecimal(myString[1]);

    weatherParametersType parameters = new weatherParametersType();

    parameters.maxt = true;
    parameters.mint = true;

    string XML = client.NDFDgen(lat, lon, productType.timeseries, DateTime.Now, DateTime.Now.AddDays(7), parameters); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T22:54:06.920

这应该能够为您获得最高温度，您只需更改 where 过滤器即可获得最低温度

```
 using System.Xml.Linq;
 \\...

 XDocument xmlDoc = XDocument.Load("YourXml.xml");
 var maximums = from tempvalue in xmlDoc.Descendants("temperature").Elements("value")
                           where tempvalue.Parent.Attribute("type").Value == "maximum"
                           select (string)tempvalue;

List<string> returnme = maximums.ToList<string>();
return returnme; 
```

希望这有帮助。

注意：我对 C# 中的 Linq to Xml 有点生疏，所以它可能不是最优雅的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T22:53:58.543

您可能需要解析使用 xpath 返回的 xml 以提取所需的数据。[这里](http://msdn.microsoft.com/en-us/library/d271ytdx(VS.71).aspx)有一个简短的例子。

或者，您可以创建一个镜像 xml 结构的类结构，并使用 XmlSerializer 将 xml 反序列化为对象，但在这种情况下，这可能比它的价值更麻烦。

# c# - 窗口不再位于顶部时的 WPF 事件

> ID：513443
> 
> 赞同：1
> 
> 时间：2009-02-04T21:26:26.783
> 
> 标签：c#, wpf, events, window

我有一个 WPF 窗口 (window1)，其所有者是 window2。如果用户单击 window2、桌面或其他任何东西以使 window1 不在 z 顺序之上，我想将 window1 的可见性设置为隐藏。即，窗口需要在顶部或隐藏。这可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T21:36:21.133

是的。

```
public Window1()
{
    InitializeComponent();    
    this.Deactivated += new EventHandler(Window1_Deactivated);
}

void Window1_Deactivated(object sender, EventArgs e)
{
    Visibility = Visibility.Collapsed;
} 
```

请注意，这也会将其从任务栏中删除。

# iphone - 目标-c：确定正则表达式是否匹配字符串

> ID：513450
> 
> 赞同：0
> 
> 时间：2009-02-04T21:28:24.377
> 
> 标签：iphone, objective-c, cocoa-touch

以下代码有什么问题？

```
-(IBAction)numFieldDoneEditing{
        NSPredicate * regexTest = [NSPredicate predicateWithFormat: @"SELF MATCHES '^\\d*\\.\\d{2}$'"];
        NSString *text = [[NSString alloc] initWithFormat: @"%@", numberField.text];
        if ([regexTest evaluateWithObject: text] == YES) {
                //do something
        }
        else{
                //do something else
        }
        [text release];
        [regexTest release];
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T21:38:44.000

出于某种原因，您必须为正则表达式规范中的序列转义*两次反斜杠：*`\d`

```
NSPredicate * regexTest = [NSPredicate predicateWithFormat: @"SELF MATCHES '^\\\\d*\\.\\\\d{2}$'"]; 
```

您的代码的其他一些问题：

*   您不应该释放该`regexText`对象，因为您不是所有者。它不是使用名为`init`or的方法创建的`copy`。请参阅[Cocoa 的内存管理编程指南](http://developer.apple.com/documentation/Cocoa/Conceptual/MemoryMgmt/MemoryMgmt.html)
*   这更像是一个风格问题，但如果你有一个布尔变量，不要将它与 YES 或 NO 进行比较，它只会使代码更难理解。只需直接测试它或它的逆。例如：

    ```
    // Positive test:
    if([regexTest evaluateWithObject: text])
        ; // do stuff

    // Negative test
    if(![regexTest evaluateWithObject: text])
        ; // do stuff 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T18:34:49.797

由于您使用 iphone 和 cocoa-touch 对此进行了标记，因此值得注意的是 NSPredicate 在 iPhone 上不可用。它仍然可以在模拟器中工作，因为它使用桌面框架，但它不能在 iPhone 本身上工作。

# mysql - 慢查询日志顶部附近的 MySQL“SET NAMES”

> ID：513452
> 
> 赞同：4
> 
> 时间：2009-02-04T21:28:50.697
> 
> 标签：mysql, performance, logging

在最近推出的一个网站上，我注意到，在网站上的实际繁重查询中，在数百万个查询中，成本最高的请求实际上是 SET NAMES，平均时钟超过 2.3 秒，而各种多连接联合查询时间远低于 2 秒。最后，这将它置于慢查询日志的顶部附近，我只是想不出优化它的方法。

这似乎不是一个常见的问题，因为我没有发现它在谷歌上搜索。

由于 SET NAMES 是关于排序的，这里是相关信息：

*   MySQL 字符集是 UTF-8 Unicode (utf8)
*   数据库连接排序规则是 utf8_unicode_ci
*   数据库及其所有表使用 utf8_general_ci

FWIW，这是运行 MySQL 5.0.45-log。数据库服务器是本地主机。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-05T09:28:02.443

如果所有查询都很慢，则 SET NAMES 在服务器上的优先级可能很低，因此要等到负载停止。如果您有很多其他查询需要很长时间执行，您可能需要先尝试优化这些查询。

这个“问题”的另一个解决方案可能是将其添加到服务器上的 my.cnf 中：

```
[mysqld]
init-connect = 'SET NAMES utf8' 
```

这确保了客户端连接时字符集设置为 UTF-8，因此客户端不必等待此“查询”的结果。您可能希望在您的软件中禁用 SET NAMES 查询。

主要是，除非你真的有很多 SET NAMES 需要这么长时间，否则我不会太担心。

# .net - ISAPI 重写 3 规则语法

> ID：513454
> 
> 赞同：1
> 
> 时间：2009-02-04T21:29:07.840
> 
> 标签：.net, iis, url-rewriting, isapi

我正在安装 ISAPI Rewrite 3。我想用它做以下事情：

使用 ISAPI Rewrite 3 提供 HTTP 文档的盒子有一个假设的 URL [http://www.foo.com](http://www.foo.com)。

我想要一个将[http://www.foo.com/blog](http://www.foo.com/blog)指向[http://blog.foo.com](http://blog.foo.com)的规则。我不想要物理重定向。我更喜欢代理，这样看起来我们就不会离开 www.foo.com。

如何使用 ISAPI Rewrite 编写此规则？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T21:45:43.627

尝试这个：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^www\.example\.com$
RewriteRule ^blog$ http://blog.example.com/ [P] 
```

# javascript - 在 javascript 中创建一个对象，该对象具有一个带有可选名称/值对的“init”方法

> ID：513466
> 
> 赞同：2
> 
> 时间：2009-02-04T21:32:06.587
> 
> 标签：javascript, arrays, initialization

我见过许多 javascript 对象都有一个“init”方法，您可以将值传递给该方法以设置对象。

当传入名称/值对数组时，它们如何在内部处理其私有变量的初始化，例如：

myObject.init( {prop1: "blah", prop2: "asdf", ..., propn: "n"} );

具体来说，其中一些值可以是可选的，因此如果在初始化期间传入了名称/值对，您将如何设置默认值然后覆盖它们。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T21:40:59.407

```
var myObject = {
  init: function(options) {
    this.foo = options.foo || 'some default';
    this.bar = options.requiredArg;

    if (!this.bar) raiseSomeError();
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2011-07-04T14:26:32.937

这在 FF5、IE8、Chrome 12、Opera v11.5 上测试正常。默认值是什么并不重要，如果它们的键在调用列表中，它们将被覆盖，否则它们将被单独留下。

```
var myObject = {
   prop1: 'default1',
   prop2: 'default2',
   prop3: 'default3',
   prop4: 'default4',
   prop5: 'default5',
   prop6: 'default6',
   init: function(options) {
      for(key in options) {
         if(this.hasOwnProperty(key)) {
            this[key] = options[key]
         }
      }
   }
}

myObject.init( {prop1: "blah", prop2: "asdf", prop5: "n"} ) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T21:53:29.803

我能想到的最简洁的方法是使用包含所有默认属性的默认对象，如下所示：

```
function init( args ) {
    this.value = 'value' in args ? args.value : defaults.value;
} 
```

您甚至可以使用 for 循环遍历默认对象，这样您就不必跟踪您希望对象包含哪些属性。

您应该使用“in”运算符，因为实际上可以将属性的值设置为未定义。将属性设置为未定义是有效的，在这种情况下，它实际上被视为已设置，确保未设置值的唯一方法是检查它是否根本不在对象中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2011-07-04T14:44:22.380

更好的是，从对象中获取 init 方法，以便您可以将 init 用于其他对象。

这在 FF5、IE8、Chrome 12、Opera v11.5 上测试正常。默认值是什么并不重要，如果它们的键在调用列表中，它们将被覆盖，否则它们将被单独留下。

```
var myGlobal = {
   init: function(obj, options) {
      for(key in options) {
         if(obj.hasOwnProperty(key)) {
            obj[key] = options[key]
         }
      }
   }
}

var myObject = {
   prop1: 'default1',
   prop2: 'default2',
   prop3: 'default3',
   prop4: 'default4',
   prop5: 'default5',
   prop6: 'default6'
}

myGlobal.init( myObject, {prop1: "blah", prop2: "asdf", prop5: "n"} ) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T21:39:01.487

哦让我们看看

编辑：更新，这确实有效

```
 function myObject(){}

myObject.prototype.init = function (argObj)
{
    if (!argObj)
    {
        argObj = new Object();
    }

    var abc = (argObj['abc'] != undefined) ? argObj['abc'] : "default value 1";
    var defg = (argObj['defg'] != undefined) ? argObj['defg'] : "default value 2";
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T21:36:39.230

您可以使用三元运算符来检查是否设置了初始化数组的元素，如果设置则使用它，否则使用默认值。例如，假设初始化数据作为一个名为`init`...的对象传递。

```
var myObject = {
  init: function(opts) {
     this.foo=(typeof(opts.foo)!="undefined")?opts.foo:'default value';
  }
} 
```

或者，您可以只复制初始化数组，覆盖先前设置的值

```
var myObject = {
  init: function(opts) {
      this.foo='default value';

      for (name in opts)
      {
         this[name]=opts[name];
      }
  } 
```

请注意，像这样的成语

```
this.foo = opts.foo || 'some default'; 
```

如果 opts.foo 设置为评估为 false 的值，例如 0，则失败

# c# - 使用管理员用户登录到某些域并使用 C# 复制文件客户端计算机

> ID：513469
> 
> 赞同：1
> 
> 时间：2009-02-04T21:32:59.750
> 
> 标签：c#, file-io, permissions, copy, dns

我有一个项目可以将文件复制到我域中另一个客户端的桌面。有 300 多台客户端计算机。但是有一个问题。当我在域中的非管理员用户帐户中运行此项目时。它无法复制文件关于访问被拒绝，用户限制的错误。当用户开始复制文件时，我想在非管理员用户帐户中执行这样的程序；首先，我的程序将通过在我的管理员用户帐户中登录到域来获得管理员访问权限，而不是复制文件。然后注销。我该怎么做？我想用 C# 做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T22:04:40.547

我有一个类似的问题：生产需要运行我的一个程序，该程序处理网络上他们没有任何访问权限的位置上的文件。

我最终使用了 Impersonation，它允许我在我的程序在运行时设置的一组凭据下运行文件处理线程。

在 AD 中，我创建了一个具有所有必需权限的特殊用户帐户，供该程序独占使用。

我知道它根本不安全，但它确实有效，甚至有人破解我的程序以获取这些凭据的可能性很小。

无论如何，看看[Impersonation](http://msdn.microsoft.com/en-us/library/system.security.principal.windowsimpersonationcontext(VS.80).aspx)我发现这些资源很有帮助：

[安全地冒充另一个用户](http://blogs.msdn.com/shawnfa/archive/2005/03/22/400749.aspx)

[Brian Low 的 ImpersonationHelper 类](http://www.brianlow.com/index.php/2007/04/20/impersonate-user/)

-杰伊

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T21:44:41.427

从程序本身或从另一个程序启动程序时，您可以切换权限。您可以使用两个程序来执行此操作，一个作为用户帐户运行，然后启动您的特权应用程序。（或使用不同的命令行启动自身以指示不同的运行模式。）

要以其他用户身份在 C# 中启动程序，请执行以下操作，

```
// Create a secure version of the password
SecureString pass = new SecureString();
foreach ( char c in _pass.Text )
{
   pass.AppendChar( c );
}

Process process = Process.Start( "PrivilegedProgram.exe", _arguments, _user.Text, pass, _domain.Text ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T21:42:35.630

您需要将线程更改为管理员用户的上下文。如何以安全的方式做到这一点是一个挑战。这听起来像是一个快速实用程序，但是安全性可能不是什么大问题。运行该实用程序后，只需更改管理员密码即可。

# java - 小程序失败中的 SAX 解析器

> ID：513475
> 
> 赞同：2
> 
> 时间：2009-02-04T21:34:44.490
> 
> 标签：java, applet, sax

我的源代码中有一行非常简单的代码：

```
XMLReader xmlReaderFactory = XMLReaderFactory.createXMLReader(); 
```

这在应用程序中完美无缺，但是，从小程序中，它尝试从服务器加载“.class”文件（没有类名，只是您看到的扩展名），然后无法给我一个解析器。

```
Exception in thread "Thread-13" java.lang.ClassFormatError: Incompatible magic value 218762506 in class file 
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(Unknown Source)
    at java.security.SecureClassLoader.defineClass(Unknown Source)
    at sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at java.lang.ClassLoader.loadClass(Unknown Source)
    at org.xml.sax.helpers.NewInstance.newInstance(Unknown Source)
    at org.xml.sax.helpers.XMLReaderFactory.loadClass(Unknown Source)
    at org.xml.sax.helpers.XMLReaderFactory.createXMLReader(Unknown Source) 
```

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T22:08:25.030

看起来好像您正在尝试配置使用 JRE 之外的 SAX 实现。配置指向以至少两个空行开头的 Windows 文本文件。SAX 实现可以通过系统属性进行配置，也可以`org.xml.sax.driver`包含在名称为 jar 的文件中`META-INF/services/org.xml.sax.driver`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T21:37:40.850

您可能会从服务器获取该类文件的 404 错误。有关详细信息，请参阅此[错误报告](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4975146)。

# qa - 用于质量检查的录音软件

> ID：513478
> 
> 赞同：6
> 
> 时间：2009-02-04T21:36:00.230
> 
> 标签：qa

Windows 上是否有任何软件可以记录 QA 人员所做的事情？它不需要能够**重播**动作......它只需要能够被**观看**（就像视频一样）。

我试图解决的问题是，有时 QA 会遇到错误，但不记得他们做了什么来得到它。使用这个工具，他们可以重播他们正在做的事情。

理想情况下，它应该记录在“循环缓冲区”中（例如半小时长），以便只有最后半小时可用于重播。这将消除维护记录的需要（即定期删除它）。

显然，免费或低成本是最好的:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T21:40:15.307

Camtesia 不是免费的，而且几乎是标准的。您可能想看看[Camstudio](http://camstudio.org/)，它是一个免费的替代品。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-04T21:44:25.720

通常最好在 VM 中而不是在真机上安装 QA 测试软件，如果他们使用 VMWare，可以要求它录制视频 - 这似乎工作得很好。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-02-24T01:21:49.053

Windows 7 中的“问题步骤记录器”。
记录屏幕和交互并创建一个漂亮的压缩 HTML 存档，您可以保存并通过电子邮件发送。

[![替代文字](https://i.stack.imgur.com/uKYVr.jpg)](https://i.stack.imgur.com/uKYVr.jpg)
[（来源：[techtree.com](http://images.techtree.com/ttimages/story/107000_problem-steps-recorder.jpg)）]

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T21:44:26.843

[Jing](http://www.jingproject.com/)项目是否符合您的需求？（Camtasia 的“小弟弟”。）

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-07-29T10:24:57.053

您可以使用免费下载的 Selinium，它有一个浏览器插件，可用于记录场景。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T20:38:17.567

这是来自 MS 的免费软件：http: [//communityclips.officelabs.com/Default.aspx](http://communityclips.officelabs.com/Default.aspx)（我从未尝试过，但听说过好东西）。

我以前使用过 hypercam：[http](http://www.hyperionics.com/hc/) ://www.hyperionics.com/hc/并取得了成功。虽然不录制音频。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-11-03T20:20:11.303

录制的视频非常适合作为附加项目。您首先需要知道如何编写错误报告的 QA 人员。否则，在很多情况下视频都无济于事。就像有人说你*在应用程序中按 ALT+F 菜单后没有打开*视频不会有太大帮助。但是当他写道，***在应用程序中按右****ALT +F 菜单未打开***后，您就会知道要求他们使用左 ALT。（当然，好的质量检查人员在开始提交错误报告之前至少会尝试两种替代方法，但这只是一个示例）。
如果好的 QA 人太难找，或者太贵，或者你别无选择，只能选择那个人 9client 代表），而不是尝试使用视频录制软件。**

 *** * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-11-03T20:31:25.057

您是否查看过 Visual Studio 2010中的[历史调试功能？](http://blogs.msdn.com/ianhu/archive/2009/05/13/historical-debugging-in-visual-studio-team-system-2010.aspx)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-02-24T01:27:37.810

Visual Studio 2010 中的“测试管理器”。

记录：

*   详细的交互步骤（键盘、鼠标、...）
*   堆栈跟踪
*   系统信息（CPU、内存等）
*   视频可选...

这里有很好的信息 [http://blogs.msdn.com/anutthara/pages/resources-for-test-tools-in-visual-studio-2010.aspx](http://blogs.msdn.com/anutthara/pages/resources-for-test-tools-in-visual-studio-2010.aspx)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-11-01T15:48:23.223

qTrace 是我发现的一个免费工具，类似于问题步骤记录器，但有更多选项来注释屏幕截图。

[http://www.qasymphony.com/qtracev3-beta.html](http://www.qasymphony.com/qtracev3-beta.html)

它还与 JIRA 集成，我相信它也与其他错误跟踪器集成。很漂亮的工具。

# iphone - 如何在 iPhone 应用程序中枚举和加载资源？

> ID：513480
> 
> 赞同：2
> 
> 时间：2009-02-04T21:36:11.773
> 
> 标签：iphone, cocoa-touch

我正在尝试用资源中的图像集合填充 NSArray。但是，为了获得最大的灵活性，我试图避免对文件名进行硬编码，甚至避免对文件的数量进行硬编码。

通常，我会从苹果的示例代码中执行类似此示例的操作：

```
kNumImages = 5;  //or whatever
NSMutableArray *images;
for (i = 1; i <= kNumImages; i++)
{
    NSString *imageName = [NSString stringWithFormat:@"image%d.jpg", i];
    [images addObject:[UIImage imageNamed:imageName];
} 
```

但是，我试图完全避免 kNumImages。有没有办法在资源上运行正则表达式或其他东西？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-04T21:45:30.770

这是我的 iPhone 应用程序中的一个片段

```
// Load item icons  
paths = [[NSBundle mainBundle] pathsForResourcesOfType:@"png" inDirectory:nil];
for (NSString *filename in paths) {
  filename = [[filename componentsSeparatedByString:@"/"] lastObject];
  if ([filename hasPrefix:@"ItemIcon"]) {
    [UIImage imageNamed:filename];
  }
} 
```

它遍历所有具有 png 扩展名的资源，文件名以“ItemIcon”开头，然后加载到 UIImage 的内置缓存中。

如果您将它们放在特定目录中，则需要指定directory: 参数。

# ruby - 真正的 sinatra(ruby/rack) after_filter 的最快方法是什么？

> ID：513491
> 
> 赞同：7
> 
> 时间：2009-02-04T21:39:51.237
> 
> 标签：ruby, performance, sinatra, callback

好的，这是一个简单的任务。在将 html 呈现给客户端后，我想使用请求中的信息执行 db 调用。

我正在使用 sinatra，因为它是一个轻量级的微框架，但如果它更快/更容易（机架？），我真的很喜欢 ruby​​ 中的任何东西。我只想获取 url 并根据 url 将客户端重定向到其他地方。

那么，如何使用 rack/sinatra 作为一个真正的 after_filter。而 after_filter 我的意思是在响应发送到客户端之后。还是没有线程就无法实现？

我分叉了 sinatra 并添加了过滤器，但是没有办法刷新响应，即使是假设流文件（显然是二进制文件）的 send_data 也会等待 after_filters。

我见过这个问题：[Multipart-response-in-ruby](https://stackoverflow.com/questions/367151/multipart-response-in-ruby-rack)，但答案是针对rails的。而且我不确定它是否真的刷新了对客户端的响应，然后允许之后进行处理。

Rack::Callbacks 在回调之前和之后都有一些回调，但即使是那些看起来它们会在响应发送到客户端之前运行这里的[Rack::Callbacks](http://github.com/rack/rack-contrib/blob/ec0fb58ee4782b29483cba58833d1a67ac33252e/lib/rack/contrib/callbacks.rb)实现（添加评论）：

```
def call(env)
  @before.each {|c| c.call(env) }
  response = @app.call(env)
  @after.each {|c| c.call(env) }
  response 
  #i am guessing when this method returns then the response is sent to the client.
end 
```

所以我知道我可以用 rake 通过 shell 调用后台任务。但是最好不要太...还有[NeverBlock](http://www.espace.com.eg/neverblock)但这对于执行单独的进程而不延迟响应是否有好处，或者它仍然会使应用程序整体等待（我认为它会）？

我知道这很多，但简而言之，它是在 ruby​​/sinatra/rack 中发送响应之后真正运行的简单 after_filter。

感谢您阅读或回答我的问题！:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T23:33:44.280

将 run_later 端口修改为 rails 以实现该文件在此处可用的技巧：

[http://github.com/pmamediagroup/sinatra_run_later/tree/master](http://github.com/pmamediagroup/sinatra_run_later/tree/master)

# tags - 机器标签的数据库模式？

> ID：513493
> 
> 赞同：1
> 
> 时间：2009-02-04T21:40:34.743
> 
> 标签：tags, rdbms, rdf, tagging

机器标签是更精确的标签：[http](http://www.flickr.com/groups/api/discuss/72157594497877875) ://www.flickr.com/groups/api/discuss/72157594497877875 。它们允许用户基本上以 object:property=value 格式将任何东西标记为对象

关于实现这一点的 rdbms 模式的任何提示？只是想知道是否有人已经涉足这个。我想架构与在 rdbms 中实现 rdf 三元组非常相似

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T22:21:05.253

除非您开始尝试进行一些优化，否则您最终会得到一个包含 Object、Property 和 Value 列的表，每条记录代表一个三元组。

任何更复杂的事情，我建议查看 Jena、Sesame 等的文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-05-16T16:36:03.753

如果您想继续使用 RDBMS 方法，则以下模式可能有效

```
CREATE TABLE predicates (
  id INT PRIMARY KEY,
  namespace VARCHAR(255),
  localName VARCHAR(255)
) 

CREATE TABLE values (
  subject INT,
  predicate INT,
  value VARCHAR(255)
) 
```

表谓词保存标签定义和值。

但马特也是对的。如果有更多需求，那么使用支持 SQL 持久性的 RDF 引擎可能是可行的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-12T14:51:39.273

I ended up implementing [this schema](http://github.com/cldwalker/has_machine_tags/blob/master/test/schema.rb)

# apache-flex - 如何从具有过滤功能的集合中删除项目，然后添加不符合过滤条件的新项目？

> ID：513498
> 
> 赞同：1
> 
> 时间：2009-02-04T21:42:03.570
> 
> 标签：apache-flex, actionscript, collections, filtering

我有一个集合，我想删除所有将某个属性设置为 true 的项目。我使用 filterFunction 来完成此操作。我的问题是，如何将新项目添加到该属性设置为 true 的集合中？filterFunction 仍然被应用，并且该项目没有被添加....

我是否必须遍历整个集合并一次删除一个项目？我认为这正是 refresh() 所做的。

谢谢。

```
<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="vertical">
    <mx:Script>
        private function hideSpecialItems():void
        {
            items.filterFunction = 
                function (item:Object):Boolean
                {
                    return item.isSpecial;
                }

            items.refresh();

            trace(items.length.toString()); // 2
        }

        private function addSpecialItem():void
        {
            items.addItem({name: "new Special Item", isSpecial: true});

            trace(items.length.toString()); // Item is added - returns 3
        }

        private function addNormalItem():void
        {
            items.addItem({name: "new Item", isSpecial: false});

            trace(items.length.toString()); // Item not added - returns 2
        }
    </mx:Script>

    <mx:ApplicationControlBar>
        <mx:Button label="Hide Items That Aren't Special" click="hideSpecialItems();" />

        <mx:Button label="Add a Normal Item" click="addNormalItem();" />

        <mx:Button label="Add a Special Item" click="addSpecialItem();" />
    </mx:ApplicationControlBar>

    <mx:ArrayCollection id="items">
        <mx:Array>
            <mx:Object name="item 1" isSpecial="{false}" />
            <mx:Object name="item 2" isSpecial="{false}" />
            <mx:Object name="item 3" isSpecial="{false}" />
            <mx:Object name="item 4" isSpecial="{true}" />
            <mx:Object name="item 5" isSpecial="{true}" />
            <mx:Object name="item 6" isSpecial="{false}" />
        </mx:Array>
    </mx:ArrayCollection>

    <mx:DataGrid dataProvider="{items}" />
</mx:Application> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T21:51:00.183

`filterFunction`实际上并没有从 ArrayCollection 中删除项目。它只是将它们隐藏在视图之外。您仍然可以看到 ArrayCollection.source 属性中的所有项目。

如果您在仍然应用 filterFunction 时添加新项目，它们也会受到过滤。

要从列表中永久删除项目，请将其转换为 Array 并使用`Array#filter`.

```
var newCollection:ArrayCollection = 
    new ArrayCollection(oldCollection.toArray().filter(myFilterFunction)) 
```

# c++ - 验证命令行参数的简单方法

> ID：513508
> 
> 赞同：2
> 
> 时间：2009-02-04T21:44:47.263
> 
> 标签：c++, visual-studio-2008

如何检查 argv（参数向量）是否包含字符，即：AZ

想确保 argv 只包含无符号整数

例如：

```
if argv[1] contained "7abc7\0" - ERROR

if argv[1] contains "1234\0" - OK 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T21:49:56.673

```
 bool isuint(char const *c) {
   while (*c) {
     if (!isdigit(*c++)) return false;
   }
   return true;
 }

 ...
 if (isuint(argv[1])) ... 
```

可以根据需要对 NULL c 指针和空字符串进行额外的错误检查。

**更新**：（添加了缺少的 C++）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T21:54:42.593

这个怎么样：

```
const std::string numbers="0123456789";

for(int i=1; i<argc; i++) {
  if(std::string(argv[i]).find_first_not_of(numbers)!=std::string::npos)
    // error, act accordingly
    ;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T21:49:49.810

[http://www.dreamincode.net/code/snippet591.htm](http://www.dreamincode.net/code/snippet591.htm)

```
#include <iostream>
#include <limits>

using namespace std;

int main() {
  int number = 0;
  cout << "Enter an integer: ";
  cin >> number;
  cin.ignore(numeric_limits<int>::max(), '\n');

  if (!cin || cin.gcount() != 1)
    cout << "Not a numeric value.";
  else
    cout << "Your entered number: " << number;
  return 0;
} 
```

当然，修改为在 argv 而不是 cin 上进行操作。

不过，这可能不是您想要的——在它上面运行一些测试，如果您不明白它的作用，请检查输出。

-亚当

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T21:59:16.907

一种更灵活的方法（即：可能比您在问题中要求的更多）但仍然很容易使用是使用[getopts](http://www.gnu.org/software/libtool/manual/libc/Getopt.html)，它是 libc 的一部分

# php - 从 php 中的函数返回变量（返回不起作用）

> ID：513511
> 
> 赞同：8
> 
> 时间：2009-02-04T21:45:01.880
> 
> 标签：php

我正在函数内部构建一个 XML 页面，出于某种奇怪的原因，我没有从函数中吐出全部内容。我试过了

```
return $thisXml;
}
echo $thisXML; 
```

我只得到函数之前变量中的 xml 声明。如果我在函数中添加回声，我会按我应该的方式取回所有内容。

我的页面基本上看起来像这样

```
$thisXml = 'xml declaration stuff';

function getThisXML($thisXML){
  for(i=1; i<5; i++){
  $query "has the 5 in it";

  while ($mysqlQuery =mysql_fetch_array($theQuery) {
    $thisXml.='add the xml';
  }
  $thisXml.='close the last element';
  return $thisXml;
}

echo $thisXml; 
```

正如我所说，如果我用'echo'替换'return'，我会得到所有漂亮的xml。如果我在函数外回显，我只会得到原始声明。

真的很奇怪，我整天都在为此苦苦挣扎。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-04T21:47:26.010

```
return $thisXml;
}
echo $thisXML; 
```

$这个XML；只存在于函数的范围内。要么制作 $thisXML; 全局（坏主意）或`echo getThisXML()`getThisXML 是返回的函数`$thisXML`；

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T21:49:10.827

您实际上是否在以下意义上调用该函数：

```
$thisXml = getThisXML($someinput); 
```

也许是一个愚蠢的问题，但我在你的描述中没有看到。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2009-02-04T22:04:32.933

您需要调用该函数！

```
$thisXml = 'xml declaration stuff';

echo getThisXML($thisXML); 
```

或者通过引用传递变量：

```
$thisXml = 'xml declaration stuff';

function getThisXML(&$thisXML){
  ...
  return $thisXml;
}

getThisXML($thisXML);
echo $thisXml; 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T21:50:15.787

您必须调用该函数并应用于`echo`返回值：

```
 $thisXml = '…';
 echo getThisXML($thisXml); 
```

或者你通过[引用](http://docs.php.net/manual/en/language.references.php)传递变量。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T21:48:06.740

您正在尝试使用在函数范围内定义的变量。

采用：

```
$thisXML;

function do(){
 global $thisXML;
 $thisXML = "foobar";
}

print $thisXML; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T21:50:29.607

返回一个变量并不意味着它会全局影响该变量，这意味着函数调用会评估为使用它的那个值。

```
$my_var = 5;

function my_func() {
  $my_var = 10;
  return $my_var;
}

print my_func();
print "\n";
print $my_var; 
```

这将打印

```
10
5 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-07T16:55:56.437

```
You can create function in php this way:

<?php

$name = array("ghp", "hamid", "amin", "Linux");
function find()
{
    $find = 0;
    if(in_array('hamid', $name))
    {
      $find = 1;
      return $find;
    }
    else 
    {
      return $find;
    }
}

//###################
$answare = find();
echo $answare;
?> 
```

# css - print.css 正在打印非常小的文本

> ID：513550
> 
> 赞同：1
> 
> 时间：2009-02-04T21:57:38.860
> 
> 标签：css

我的 print.css 页面打印出来非常小，超级缩小，文字像 6 pt.：

```
@charset "UTF-8";
/* CSS Document */

body {
   background: white;
   font-size: 12pt;
   /* Change text colour to black (useful for light text on a dark background) */
.lighttext
    color: #000 
}
/* Remove unwanted elements */
#menu, #header, #nav, #prod, #home, #our, #work, #whole, #contact, #circle, #logo, #flower, #navblank, #bottom, .noprint
{
display: none;
}

#wrapper, #content {
   width: auto;
   margin: 0 5%;
   padding: 0;
   border: 0;
   float: none !important;
   color: black;
   background: transparent none;
   }
div#content {
   margin-left: 10%;
   padding-top: 1em;
   border-top: 1px solid #930;
   }
div#mast {
   margin-bottom: -8px;
   }
div#mast img {
   vertical-align: bottom;
   }
a:link, a:visited {
   color: #520;
   background: transparent;
   font-weight: bold;
   text-decoration: underline;
   }
#content a:link:after, #content a:visited:after {
   content: " (" attr(href) ") ";
   font-size: 90%;
   }
#content a[href^="/"]:after {
   content: " (http://www.alistapart.com" attr(href) ") ";
   } 
```

不明白为什么 - 有没有人有任何建议来纠正这个 print.css 的输出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T22:55:29.973

由于 pt 代表 1/72 英寸的点，我会冒险猜测它可能取决于屏幕尺寸，尽管实际上它可能是任意数量的东西。我们真的需要更多信息。

您是否尝试过使用 em 代替？它们是处理字体大小的最佳方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T22:02:58.880

为了排除这种情况，字体大小的绝对值（而不是 90%）怎么样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T22:49:03.123

检查是否有任何脚本可以修改内联样式，忘记了适用于所有媒体类型的 CSS。尝试添加！重要。然后检查您的打印选项。如果它是像缩小以适应的东西，那么你在 CSS 中无能为力。还可以尝试使用其他浏览器进行打印，也许可以进行诊断。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T00:54:03.417

也许您在打印时正在加载另一个样式表？它在打印预览中是什么样子的？

您可能有另一个样式表，您不打算加载该样式表进行打印，但无论如何正在加载该样式表以进行打印。检查“媒体”属性：

类似这样的内容将加载到屏幕上或打印中：[link rel="stylesheet" href="css/style.css" type="text/css" media="all" /]

这也是：[link rel="stylesheet" href="css/style.css" type="text/css" /]

当然，这仅用于打印：[link rel="stylesheet" href="css/print.css" type="text/css" media="print" /]

要防止加载样式表进行打印，请使用以下内容： [link rel="stylesheet" href="css/print.css" type="text/css" media="screen, projection" /]

（注意：使用尖括号，而不是我上面的方括号。不知何故 4 空格缩进对我不起作用）

[有关媒体属性类型的更多信息](http://www.w3.org/TR/html4/types.html#h-6.13)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T01:07:25.950

你错过了`}`关闭你的`body`声明：

```
body {
   background: white;
   font-size: 12pt;
   /* Change text colour to black (useful for light text on a dark background) */
}
.lighttext
    color: #000 
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T01:16:04.077

尝试按 ctrl+0 您可能在不知不觉中减小了浏览器端的字体大小

# javascript - 使用 jQuery 和 HTML 对 XML 数据进行分页

> ID：513567
> 
> 赞同：1
> 
> 时间：2009-02-04T22:02:10.083
> 
> 标签：javascript, jquery, html, xml

我有一个包含问题列表的 XML 文件。我想在 HTML 页面加载时加载列表中的第一个问题，并将答案加载为单选按钮。选择其中一个单选按钮时，我想显示结果以及继续按钮。继续按钮将转到 XML 文件中的第二个元素。

所以，到目前为止，我有以下内容：

```
function generateQuestion(i) {
    $(document).ready(function() {
        $.get('quiz.xml', function(d) {
            alert('Loaded XML');
            $(d).find('question').get(0, function() {
                alert('Loaded Question');
                var $question = $(this);
                var questionContent = $question.attr("content");
                $(questionContent).appendTo("#quizQuestion");
            });
        });
    });
} 
```

但是，问题中的内容永远不会加载到元素中。当我去获取文档中的第一个元素时，它看起来像挂起。我的猜测是没有重载将对象注入函数。

我对么？任何人都有任何快速资源来显示我想要生成的基本测验样示例？

更新：我已将代码更新为以下内容，它似乎被属性属性捕获：

```
function generateQuestion(i) {
    $(document).ready(function() {
        $.get('quiz.xml', function(d) {
            var $question = $(d).find('question').get(i);
            var questionContent = $question.attr('content');
            alert(questionContent);
            $(questionContent).appendTo("#quizQuestion");
        });
    });
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T22:27:28.020

get() 函数返回未包装的 set 元素，在这种情况下它将是 xml 元素。

```
$.get('quiz.xml', function(d) {
    var question = $(d).find('question :eq(0)');
    var questionContent = question.attr('content');
    alert(questionContent);
    $(questionContent).appendTo("#quizQuestion");
}); 
```

另一种选择是重新包装对象

```
$.get('quiz.xml', function(d) {
    var question = $(d).find('question').get(0);
    var questionContent = $(question).attr('content');
    alert(questionContent);
    $(questionContent).appendTo("#quizQuestion");
}); 
```

另外，我不确定你为什么在函数调用中包含 $(document).ready 。你什么时候调用这个函数。如果它在文档加载之后，那么你真的不需要那个。

# apache-flex - Flex 3 - 如何使用代码选择列表中的第一项？

> ID：513585
> 
> 赞同：1
> 
> 时间：2009-02-04T22:06:01.433
> 
> 标签：apache-flex, actionscript-3, actionscript, flex3

我的代码中有几个项目的常规控件。

```
<mx:List id="myList">
    <mx:String>Item 1</mx:String>
    <mx:String>Item 2</mx:String>
</mx:List> 
```

我还有一些其他代码可以运行并填充列表。如何使用代码选择新填充列表中的第一项？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-04T22:14:55.627

`myList.selectedItem`如果您有对要选择的对象的引用，或者`myList.selectedIndex`如果您有数据源的索引，那将是。这两个属性都继承自 ListBase 类。它们记录在 ActionScript 3.0 语言参考中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T06:03:54.447

尝试像这样使用 List 的 dataProvider 的 getItemAt 方法... myList.dataProvider.getItemAt(0)。

# struts2 - 使用 div 而非跨度的 Struts 错误/消息

> ID：513587
> 
> 赞同：0
> 
> 时间：2009-02-04T22:06:32.133
> 
> 标签：struts2

我们使用and添加 Struts 错误和消息，然后使用`ActionSupport.addActionError(...)`and`addActionMessage(...)`输出结果。`<actionerror class="x"/>``<actionmessage class="x"/>`

当这些标签输出消息时，它们以以下形式输出：`<ul><li><span class="x">msg</span></li></ul>`

如您所见，您可以指定 css 类（在本例中为“x”）以应用格式。问题是我们想要应用`margin-top`和`margin-bottom`css 属性，而您不能将这些属性（我收集）用于`<span>`元素 - 只能用于`<div>`元素。

那么有没有办法让这些 Struts 标记使用 a`<div>`而不是 a来输出错误/消息`<span>`？

谢谢。

* * *

更新：

根据下面的答案/解决方法，我只是将 struts 标记包含在一个 div 中：

```
<div class="error-status">
  <s:actionerror cssClass="error"/>
  <s:actionmessage cssClass="status" />
</div> 
```

error-status CSS 类在 LI 上设置属性：

```
.error-status LI { MARGIN-TOP: 5px; MARGIN-BOTTOM: 5px; display: block; }
.error { COLOR: red }
.status { color: #0066CC } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T22:15:55.717

如果您也应用，您可以将边距应用到跨度`display:block`。

但最佳解决方案是对`li`元素应用边距。

# windows - 如何在 Windows 上使用 ActivePerl 打开浏览器访问 URL？

> ID：513591
> 
> 赞同：3
> 
> 时间：2009-02-04T22:06:47.937
> 
> 标签：windows, perl, browser

在 Windows 上的 ActivePerl 中，如何打开浏览器访问某个 URL？

在 Python 中，有`webbrowser.open(url)`，但我似乎找不到 Perl 等价物。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T22:21:20.653

不确定是否有“正确”的方法可以做到这一点，但这应该可行：

```
my @command = ('start', $url);
system(@command); 
```

“开始”是一个 Windows 命令，它将使用任何相关的程序来打开参数。因此，只要 $url 看起来像一个 URL（确保它以 http(s):// 开头），它就应该启动浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T22:27:08.083

我知道您在 Windows 上使用 ActivePerl，但如果您想要可移植性，那么`system()`调用可能是错误的方法。在 OS X 上，您可以更改`'start'`为`'open'`，但在许多其他系统上，您必须使用另一个词，或者可能根本没有等效的命令。这种事情实际上是依赖于操作系统和浏览器的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-11T20:23:11.760

在 Windows 上：在现代 unixen 上启动（也就是说，那些安装了 xdg-utils 的）：xdg-open

# ruby-on-rails - 在 Redmine 安装中修改 link_to 的行为（ruby on rails）

> ID：513594
> 
> 赞同：1
> 
> 时间：2009-02-04T22:07:39.727
> 
> 标签：ruby-on-rails, redmine

我正在尝试修改 Redmine 安装的 UI（Redmine 0.7.3.devel.2093 (MySQL)）。

当您在 Redmine 中查看项目时，它会生成该项目的所有子项目的列表。

例如，**app/views/projects/index.rhtml**调用**link_to**函数：

```
<% if @project_tree[project].any? %>
    <p><%= l(:label_subproject_plural) %>:
    <%= @project_tree[project].sort.collect {|subproject| 
       link_to(h(subproject.name), {:action => 'show', :id => subproject}, :class => (User.current.member_of?(subproject) ? "subp fav" : "subp"))}.join(', ') %></p>
<% end %> 
```

输出以下 HTML：

```
<p>Subprojects:
<a href="/projects/show/foo" class="subp fav">Foo Subproject</a>, <a href="/projects/show/bar" class="subp">Bar Subproject</a>, <a href="/projects/show/baz" class="subp fav">Baz Subproject</a></p> 
```

我们发现以逗号分隔的子项目列表很难在视觉上解析。我们希望将每个子项目列在自己的行上。（任何标记都可以——每个链接上的 UL、OL 或 P 标记都是理想的，但是使用 BR 而不是逗号则完全可以。）

进行此更改的最佳方法是什么？我找不到**`link_to`**应用程序中定义的位置；grepping for**`def link_to(`**和类似的结果什么都没有。我是一个 UI 类型，所以我真的不明白 Rails 是如何处理这些东西的——它似乎没有在视图模板中定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T22:18:19.753

您可以直接在您提供的代码中执行此操作。只是改变

```
join(', ') 
```

到

```
join('<br />') 
```

那应该这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T22:19:32.030

**link_to**由 Rails 框架提供 - 它不会将链接生成为列表 - 它只是创建单个链接。问题是 sort.collect 和生成对 link_to 的调用的块

这应该可以，将子项目放入列表项

```
<% @project_tree[project].sort.collect do |subproject| %>
  <li>        
    <%= link_to(h(subproject.name), {:action => 'show', :id => subproject}, :class => (User.current.member_of?(subproject) ? "subp fav" : "subp")) %>
  </li>
<% end %> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T02:19:10.517

我想指出，最新版本的 Redmine trunk 将项目列表更改为使用 HTML 列表（ul 和 li）。

# java - 如果性能很重要，我应该使用 Java 的 String.format() 吗？

> ID：513600
> 
> 赞同：234
> 
> 时间：2009-02-04T22:09:29.273
> 
> 标签：java, string, performance, string-formatting, micro-optimization

我们必须一直为日志输出等构建字符串。在 JDK 版本中，我们了解了何时使用`StringBuffer`（许多附加，线程安全）和`StringBuilder`（许多附加，非线程安全）。

使用上有什么建议`String.format()`？它是有效的，还是我们被迫坚持对性能很重要的单行代码进行串联？

例如丑陋的旧风格，

```
String s = "What do you get if you multiply " + varSix + " by " + varNine + "?"; 
```

与整洁的新样式（String.format，可能更慢）相比，

```
String s = String.format("What do you get if you multiply %d by %d?", varSix, varNine); 
```

注意：我的具体用例是贯穿我的代码的数百个“单行”日志字符串。它们不涉及循环，所以`StringBuilder`太重了。我`String.format()`特别感兴趣。

* * *

## 回答 #1

> 赞同：249
> 
> 时间：2009-08-15T11:03:05.757

我采用了[hhafez](https://stackoverflow.com/a/513705/1845976)代码并添加了**内存测试**：

```
private static void test() {
    Runtime runtime = Runtime.getRuntime();
    long memory;
    ...
    memory = runtime.freeMemory();
    // for loop code
    memory = memory-runtime.freeMemory(); 
```

我为每种方法分别运行它，'+' 运算符、String.format 和 StringBuilder（调用 toString()），因此使用的内存不会受到其他方法的影响。我添加了更多连接，使字符串为“Blah”+ i +“Blah”+ i +“Blah”+ i +“Blah”。

结果如下（平均每次运行 5 次）：
**接近时间（毫秒） 分配的内存（长）
'+' 运算符 747 320,504
String.format 16484 373,312
StringBuilder 769 57,344** 

我们可以看到 String '+' 和 StringBuilder 在时间上实际上是相同的，但是 StringBuilder 在内存使用方面要高效得多。当我们在足够短的时间间隔内有许多日志调用（或任何其他涉及字符串的语句）时，这一点非常重要，因此垃圾收集器不会清理由“+”运算符产生的许多字符串实例。

顺便说一句，不要忘记在构建消息之前检查日志记录**级别。**

结论：

1.  我将继续使用 StringBuilder。
2.  我有太多的时间或太少的生活。

* * *

## 回答 #2

> 赞同：134
> 
> 时间：2009-02-04T22:35:34.883

我写了一个小类来测试两者的性能更好，并且 + 领先于格式。乘以 5 到 6 倍。自己尝试一下

```
import java.io.*;
import java.util.Date;

public class StringTest{

    public static void main( String[] args ){
    int i = 0;
    long prev_time = System.currentTimeMillis();
    long time;

    for( i = 0; i< 100000; i++){
        String s = "Blah" + i + "Blah";
    }
    time = System.currentTimeMillis() - prev_time;

    System.out.println("Time after for loop " + time);

    prev_time = System.currentTimeMillis();
    for( i = 0; i<100000; i++){
        String s = String.format("Blah %d Blah", i);
    }
    time = System.currentTimeMillis() - prev_time;
    System.out.println("Time after for loop " + time);

    }
} 
```

对不同的 N 运行上述代码表明两者的行为都是线性的，但`String.format`速度要慢 5-30 倍。

原因是在当前的实现中，`String.format`首先用正则表达式解析输入，然后再填充参数。另一方面，与 plus 的连接由 javac（而不是 JIT）优化并`StringBuilder.append`直接使用。

![运行时比较](https://i.stack.imgur.com/qCZyw.png)

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2015-06-25T21:52:34.897

这里提供的所有基准都有一些[缺陷](https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java)，因此结果不可靠。

我很惊讶没有人使用[JMH](http://openjdk.java.net/projects/code-tools/jmh/)进行基准测试，所以我这样做了。

结果：

```
Benchmark             Mode  Cnt     Score     Error  Units
MyBenchmark.testOld  thrpt   20  9645.834 ± 238.165  ops/s  // using +
MyBenchmark.testNew  thrpt   20   429.898 ±  10.551  ops/s  // using String.format 
```

单位是每秒的操作次数，越多越好。[基准源代码](https://gist.github.com/AdamStelmaszczyk/72f0a2511428e36e495c#file-mybenchmark-java)。使用 OpenJDK IcedTea 2.5.4 Java 虚拟机。

因此，旧样式（使用 +）要快得多。

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2011-06-29T14:34:33.080

JAVAC 1.6 自动将您的旧丑陋样式编译为：

```
StringBuilder sb = new StringBuilder("What do you get if you multiply ");
sb.append(varSix);
sb.append(" by ");
sb.append(varNine);
sb.append("?");
String s =  sb.toString(); 
```

所以这和使用 StringBuilder 完全没有区别。

String.format 的重量级要大得多，因为它创建了一个新的 Formatter，解析您的输入格式字符串，创建一个 StringBuilder，将所有内容附加到它并调用 toString()。

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2011-08-20T03:36:46.470

Java 的 String.format 是这样工作的：

1.  它解析格式字符串，分解成格式块列表
2.  它迭代格式块，渲染成 StringBuilder，它基本上是一个数组，可以根据需要调整自身大小，方法是复制到一个新数组中。这是必要的，因为我们还不知道分配最终 String 的大小
3.  StringBuilder.toString() 将他的内部缓冲区复制到一个新的字符串中

如果此数据的最终目的地是流（例如呈现网页或写入文件），您可以将格式块直接组装到流中：

```
new PrintStream(outputStream, autoFlush, encoding).format("hello {0}", "world"); 
```

我推测优化器会优化掉格式字符串的处理。如果是这样，您将获得与手动展开 String.format 到 StringBuilder相当的[摊销性能。](http://en.wikipedia.org/wiki/Amortized_analysis)

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2009-02-05T00:09:56.517

要扩展/纠正上面的第一个答案，实际上 String.format 不会帮助翻译。
当您打印日期/时间（或数字格式等）时，String.format 将有所帮助，其中存在本地化（l10n）差异（即，某些国家/地区将打印 04Feb2009，而其他国家/地区将打印 Feb042009）。
通过翻译，您只是在谈论将任何可外部化的字符串（例如错误消息和诸如此类的东西）移动到属性包中，以便您可以使用 ResourceBundle 和 MessageFormat 为正确的语言使用正确的包。

综观以上所有内容，我会说性能方面，String.format 与普通连接归结为您喜欢的内容。如果您更喜欢查看对 .format 的调用而不是串联，那么请务必使用它。
毕竟，阅读的代码比编写的要多得多。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2009-02-04T22:18:24.153

在您的示例中，性能概率并没有太大差异，但还有其他问题需要考虑：即内存碎片。即使是连接操作也在创建一个新字符串，即使它是临时的（GC 它需要时间，而且工作量更大）。String.format() 更具可读性，并且涉及更少的碎片。

此外，如果您经常使用特定格式，请不要忘记您可以直接使用 Formatter() 类（所有 String.format() 所做的就是实例化一个一次性使用的 Formatter 实例）。

此外，您应该注意的其他事项：小心使用 substring()。例如：

```
String getSmallString() {
  String largeString = // load from file; say 2M in size
  return largeString.substring(100, 300);
} 
```

那个大字符串仍在内存中，因为这正是 Java 子字符串的工作方式。更好的版本是：

```
 return new String(largeString.substring(100, 300)); 
```

或者

```
 return String.format("%s", largeString.substring(100, 300)); 
```

如果您同时做其他事情，第二种形式可能更有用。

* * *

## 回答 #8

> 赞同：5
> 
> 时间：2009-02-04T22:14:41.587

通常，您应该使用 String.Format，因为它相对较快并且支持全球化（假设您实际上是在尝试编写用户可以阅读的内容）。如果您尝试翻译一个字符串而不是每个语句 3 个或更多（尤其是对于语法结构截然不同的语言），它还可以更容易地进行全球化。

现在，如果您从不打算翻译任何内容，那么要么依赖 Java 内置的 + 运算符转换为`StringBuilder`. `StringBuilder`或者明确地使用 Java 。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-05-21T20:05:28.817

**仅从 Logging 的角度来看的另一个角度。**

我看到很多与登录此线程相关的讨论，所以想在回答中添加我的经验。可能有人会觉得它有用。

我猜想使用格式化程序进行日志记录的动机来自于避免字符串连接。基本上，如果您不打算记录它，您不希望有字符串 concat 的开销。

除非您想记录，否则您实际上并不需要连接/格式化。假设我定义了这样的方法

```
public void logDebug(String... args, Throwable t) {
    if(debugOn) {
       // call concat methods for all args
       //log the final debug message
    }
} 
```

在这种方法中，如果它是调试消息并且 debugOn = false，则根本不会真正调用 cancat/formatter

尽管在这里使用 StringBuilder 而不是格式化程序会更好。主要动机是避免任何这些。

同时我不喜欢为每个日志语句添加“if”块，因为

*   影响可读性
*   减少我的单元测试的覆盖率——当你想确保每一行都经过测试时，这会让人感到困惑。

因此，我更喜欢使用上述方法创建一个日志实用程序类，并在任何地方使用它，而不用担心性能损失和任何其他相关问题。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2009-02-04T23:00:08.560

我刚刚修改了 hhafez 的测试以包含 StringBuilder。StringBuilder 在 XP 上使用 jdk 1.6.0_10 客户端比 String.format 快 33 倍。使用 -server 开关将系数降低到 20。

```
public class StringTest {

   public static void main( String[] args ) {
      test();
      test();
   }

   private static void test() {
      int i = 0;
      long prev_time = System.currentTimeMillis();
      long time;

      for ( i = 0; i < 1000000; i++ ) {
         String s = "Blah" + i + "Blah";
      }
      time = System.currentTimeMillis() - prev_time;

      System.out.println("Time after for loop " + time);

      prev_time = System.currentTimeMillis();
      for ( i = 0; i < 1000000; i++ ) {
         String s = String.format("Blah %d Blah", i);
      }
      time = System.currentTimeMillis() - prev_time;
      System.out.println("Time after for loop " + time);

      prev_time = System.currentTimeMillis();
      for ( i = 0; i < 1000000; i++ ) {
         new StringBuilder("Blah").append(i).append("Blah");
      }
      time = System.currentTimeMillis() - prev_time;
      System.out.println("Time after for loop " + time);
   }
} 
```

虽然这可能听起来很激烈，但我认为它仅在极少数情况下相关，因为绝对数字非常低：100 万个简单的 String.format 调用需要 4 秒 - 只要我将它们用于日志记录或像。

**更新：**正如 sjbotha 在评论中指出的那样， StringBuilder 测试是无效的，因为它缺少一个 final `.toString()`。

`String.format(.)`在我的机器上，正确的加速因子`StringBuilder`是 23（带`-server`开关的是 16）。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-06-25T21:01:11.577

这是 hhafez 条目的修改版本。它包括一个字符串生成器选项。

```
public class BLA
{
public static final String BLAH = "Blah ";
public static final String BLAH2 = " Blah";
public static final String BLAH3 = "Blah %d Blah";

public static void main(String[] args) {
    int i = 0;
    long prev_time = System.currentTimeMillis();
    long time;
    int numLoops = 1000000;

    for( i = 0; i< numLoops; i++){
        String s = BLAH + i + BLAH2;
    }
    time = System.currentTimeMillis() - prev_time;

    System.out.println("Time after for loop " + time);

    prev_time = System.currentTimeMillis();
    for( i = 0; i<numLoops; i++){
        String s = String.format(BLAH3, i);
    }
    time = System.currentTimeMillis() - prev_time;
    System.out.println("Time after for loop " + time);

    prev_time = System.currentTimeMillis();
    for( i = 0; i<numLoops; i++){
        StringBuilder sb = new StringBuilder();
        sb.append(BLAH);
        sb.append(i);
        sb.append(BLAH2);
        String s = sb.toString();
    }
    time = System.currentTimeMillis() - prev_time;
    System.out.println("Time after for loop " + time);

} 
```

}

for 循环 391 之后的时间 for 循环 4163 之后的时间 for 循环 227 之后的时间

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2009-02-04T22:16:05.703

这个问题的答案很大程度上取决于您的特定 Java 编译器如何优化它生成的字节码。字符串是不可变的，理论上，每个“+”操作都可以创建一个新的。但是，您的编译器几乎可以肯定地优化了构建长字符串的临时步骤。上面两行代码完全有可能生成完全相同的字节码。

唯一真正了解的方法是在当前环境中迭代地测试代码。编写一个以迭代方式连接字符串的 QD 应用程序，并查看它们如何相互超时。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-12-05T17:10:19.453

考虑`"hello".concat( "world!" )`在连接中使用少量字符串。与其他方法相比，它的性能甚至可能更好。

如果您有超过 3 个字符串，则可以考虑使用 StringBuilder 或仅使用 String，具体取决于您使用的编译器。

# command-line - xargs 无法识别 bash 别名

> ID：513611
> 
> 赞同：66
> 
> 时间：2009-02-04T22:12:52.260
> 
> 标签：command-line, xargs, bash

我正在尝试运行以下命令：

```
find . -iname '.#*' -print0 | xargs -0 -L 1 foobar 
```

其中“foobar”是在我的 .bashrc 文件中定义的别名或函数（在我的例子中，它是一个带有一个参数的函数）。显然 xargs 不承认这些是它可以运行的东西。有没有聪明的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2009-02-04T22:53:22.803

既然只有你的交互式 shell 知道别名，为什么不直接运行别名而不通过分叉`xargs`呢？

```
find . -iname '.#*' -print0 | while read -r -d '' i; do foobar "$i"; done 
```

如果您确定您的文件名中没有换行符（ick，为什么会这样？），您可以将其简化为

```
find . -iname '.#*' -print | while read -r i; do foobar "$i"; done 
```

甚至只是`find -iname '.#*' | ...`，因为默认目录是`.`并且默认操作是`-print`.

另一种选择：

```
 IFS=$'\n'; for i in `find -iname '.#*'`; do foobar "$i"; done 
```

告诉 Bash 单词仅在换行符处拆分（默认值：`IFS=$' \t\n'`）。不过，您应该小心这一点；有些脚本不能很好地应对更改的`$IFS`.

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2010-07-19T10:26:21.267

使用 Bash，您还可以指定传递给别名（或函数）的参数数量，如下所示：

```
alias myFuncOrAlias='echo'  # alias defined in your ~/.bashrc, ~/.profile, ...
echo arg1 arg2 | xargs -n 1 bash -cil 'myFuncOrAlias "$1"' arg0
echo arg1 arg2 | xargs  bash -cil 'myFuncOrAlias "$@"' arg0 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2020-01-21T14:50:38.460

在被别名的命令中添加尾随空格会导致其他别名命令扩展：

```
alias xargs='xargs ' # aliased commands passed to xargs will be expanded 
```

有关更多信息，请参阅此答案：
[https ://stackoverflow.com/a/59842439/11873710](https://stackoverflow.com/a/59842439/11873710)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2009-02-04T22:18:33.467

这不起作用，因为`xargs`期望能够`exec`将*程序*作为其参数给出。

由于`foobar`在您的情况下只是一个`bash`别名或函数，因此没有要执行的程序。

虽然它涉及启动由 .`bash`返回的每个文件`find`，但您可以编写一个小的 shell 脚本：

```
#!/bin/bash
. $(HOME)/.bashrc
func $* 
```

然后将该脚本的名称作为参数传递给`xargs`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-02-04T22:16:47.603

我通常使用这样的查找：

```
find . -iname '' -exec cmd '{}' \; 
```

'{}' 将被替换为文件名，而 \; 是终止执行链所必需的。但是，如果这不适用于您的函数，您可能需要通过 bash 运行它：

```
find .. |sed -e "s/.*/cmd '&'/"|bash 
```

Find 将每个文件打印在一行上，sed 只是在您的命令前面加上前缀，然后将其通过管道传输到 bash 以执行。先跳过|bash 看看会发生什么。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-23T11:26:56.197

尝试

```
find . -iname '.#*' -print0 | xargs -0 -L 1 $(foobar) 
```

# flash - Flash Player 6 中的非工作 alpha [放弃]

> ID：513620
> 
> 赞同：0
> 
> 时间：2009-02-04T22:15:05.050
> 
> 标签：flash, actionscript-2, jpeg, alpha

我有一个 flash 项目，由于要求必须向后兼容 flash 6。除了由 <MovieClip>.loadMovie 加载的前 6 个（共 17 个）jpeg 图像外，一切正常。阿尔法设置。

如果我重新排列用于向 Flash 电影提供图像 url 的 XML 文件中图像的顺序，新的前六个图像无法响应 alpha，而旧的六个图像将响应 alpha。

关于可能是什么原因的任何想法？

编辑：我添加了代码来尝试等待图像首先使用 onClipEvent(data) 完全加载。图像似乎在动画开始之前预加载，但 alpha 属性仍然不起作用。

编辑 2：我刚刚使用了擦除类型转换而不是淡入淡出。我希望永远不必再使用 Flash 6。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-05T17:38:31.343

使用 loadClip 而不是 loadMovie 并确保您收听“onLoadInit”：

```
var container:MovieClip = createEmptyMovieClip("container", getNextHighestDepth());
var mcLoader:MovieClipLoader = new MovieClipLoader();

mcLoader.addListener(this);
mcLoader.loadClip("YourImage.jpg", container);

function onLoadInit(mc:MovieClip) {
trace("onLoadInit: " + mc); 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T10:37:19.917

在更改 alpha 之前，您是否正在等待所有图像正确加载？您需要侦听 INIT 事件（不确定 as2 中的确切名称），以便它们可用于您的代码。

# opengl - 在 win32 服务中离屏渲染到纹理

> ID：513650
> 
> 赞同：1
> 
> 时间：2009-02-04T22:20:57.017
> 
> 标签：opengl, windows-services

我正在尝试编写一个可以渲染到纹理的 C++ Windows 服务。我已经将代码作为常规控制台应用程序运行，但是当作为服务运行时`wglGetProcAddress()`返回 NULL。

谁能告诉我这是否可行，如果可以，我需要做什么才能使 OpenGL 在服务进程中工作？

* * *

### 编辑：

我还没有让它在 Vista 下工作，但它在 XP 下工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-19T20:52:51.363

您可以使用 Mesa3D 获得功能齐全的软件渲染器。只需构建 Mesa3D 并将其中构建的 opengl32.dll 与您的应用程序放在一起。这应该使您能够使用 OpenGL 2.1 和扩展。我们使用它来测试 Windows 服务中的 Opengl 应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T18:09:29.707

服务在非交互式桌面中运行。这些桌面不连接到计算机的物理显示设备，而是连接到逻辑显示设备。逻辑显示设备是非常基本的通用 VGA 设备，设置为 1024 X 768，没有花里胡哨。

服务可以使用大多数 GDI 功能，但不能使用 DirectX 或 OpenGL 等高级图形功能。因此，您可以创建窗口、创建或检索设备上下文并进行一些相当复杂的绘图和渲染，但您只能使用简单的 GDI（和一些 GDI+）。

如果您在 wglGetProcAddress 返回 NULL 后检查 GetLastError，您应该得到失败的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T22:28:47.453

OpenGL 需要桌面访问权限来创建渲染上下文，并且默认情况下服务没有桌面访问权限。

您需要以交互模式运行服务。为此，请进入管理工具中的服务属性。在您设置服务的登录用户的地方，您可以选择以交互模式运行服务，或者类似于“允许服务与桌面交互”的选项。您也可以尝试将服务记录为另一个用户。

如果您正在使用 .Net IIS 应用程序，您还必须强制服务器的托管部分以另一个用户身份登录。

**编辑：**

我忘了说，用户当前必须登录加速硬件桌面并且机器不能被锁定。这很糟糕，但这是我之前让它工作的唯一方法。我们有肮脏的脚本，一旦机器启动就让用户登录。

附带说明一下，我们使用的是 DirectX，因此它可能不适用于 OpenGL。

# language-agnostic - 如何选择位标志值？

> ID：513656
> 
> 赞同：2
> 
> 时间：2009-02-04T22:22:54.673
> 
> 标签：language-agnostic, code-generation, bit-fields, bitflags

我有一组选项，一些正交（可以以任何组合组合），一些排他（只允许从集合中选择一个），并且需要选择一组`enum`值，以便它们可以按位组合`or`并提取与位`and`。我希望`or`-ing 无效组合是可检测的。

有没有这样的生成**工具**`enums`？

**为清晰起见进行编辑**

我正在寻找可以利用某些标志无效的事实来减少使用的位数的东西。我能够检测错误的要求是软的。如果事情搞砸了，我*不需要知道使用了什么。*

我正在使用 C#，但任何解决方案都应该有帮助。

一个示例模式是：

```
0011 00
0101 00
1001 00
0110 00
1010 00
1100 00

0000 01
0000 10 
```

得到 6 个独占标志和 2 的正交对成 6 位

快速测试表明 5 位给出 9 个值，6 位给出 20，...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-04T22:40:15.450

我所知道的最好的通用方法与其说是一种工具，不如说是一种约定：定义这样的位标志列表：

```
FLAG_1                    0x00000001
FLAG_2                    0x00000002
FLAG_3                    0x00000004
FLAG_4                    0x00000008
FLAG_5                    0x00000010
FLAG_6                    0x00000020 
```

它很容易使用，因为数字继续向左移动的 1、2、4、8 模式。

编辑：回应评论。好吧，如果您真的想要将位标志与独占枚举结合起来，那么您基本上要做的就是将位列表的部分分段，以将其视为数字空间。因此，您可以使用 0x1 和 0x2 这两个位，现在您可以使用这两个位来表示 0-3。就像是：

```
OPT_1_VAL_1               0x00000000
OPT_1_VAL_2               0x00000001
OPT_1_VAL_3               0x00000002
OPT_1_VAL_4               0x00000003
FLAG_1                    0x00000004
FLAG_2                    0x00000008
FLAG_3                    0x00000010
FLAG_4                    0x00000020 
```

您使用的屏蔽逻辑必须更复杂。要查找标志，您可以执行 if(settings & FLAG_1)，但对于选项空间，您必须执行 if((settings & OPT_1_VAL_3) == OPT_1_VAL_3)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T23:04:19.693

我不知道有什么工具，但这里有一个技巧可以让唯一位枚举更容易生成：

```
public enum Critters
{
   Amorphous = 0,
   Sloth =     1 << 0,
   Armadillo = 1 << 1,
   Weasel =    1 << 2,
   Crab =      1 << 3,
   Partridge = 1 << 4,
   Parakeet =  1 << 5,
   Rhino =     1 << 6
}; 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-05T00:14:59.907

为了表示一组“**独占**的”`n`选项（即必须选择一个），我们至少需要`ceil(log2(n))`位。例如，option`k`可以用`k`base-中的数字表示`2`。

为了表示一组“**正交**”`n`选项（即`0, 1, ..., n`可以选择任何大小的组合），我们至少需要`n`位。例如，选项`k0, k1, k2`可以用二进制数表示，除了 bits 之外，它的位为零`0, 1, 2`。

因此，为了同时表示多个选项集，我们将每个选项集所需的位数相加（取决于它是“独占”还是“正交”）以获得所需的总位数。

**简而言之，要选择枚举值，**

*   “独占”选项`k`使用`k << r`
*   “正交”选项`k0, k1, ..., k{n-1}`使用`0x1 << r, 0x1 << (r+1), ..., 0x1 << (r+n-1)`

其中 offset`r`是前面的选项集使用的位数。

* * *

**如何**在 Java 中自动执行此构造的示例：

```
/**
 * Construct a set of enum values, for the given sizes and types 
 * (exclusive vs orthogonal) of options sets.
 *
 * @param optionSetSizes
 *     number of elements in each option set
 * @param isOptionSetExclusive
 *     true if corresponding option set is exclusive, false if
 *     orthogonal
 * @returns
 *     array of m elements representing the enum values, where 
 *     m is the sum of option set sizes. The enum values are 
 *     given in the order of the option sets in optionSetSizes 
 *     and isOptionSetExclusive.
 */ 
int[] constructEnumValues(
        int[] optionSetSizes, 
        boolean[] isOptionSetExclusive)
{
    assert optionSetSizes.length == isOptionSetExclusive.length;

    // determine length of the return value
    int m = 0; 
    for (int i = 0; i < optionSetSizes.length; i++) m += optionSetSizes[i];
    int[] vals = new int[m];

    int r = 0; // number of bits used by the preceding options sets
    int c = 0; // counter for enum values used 

    for (int i = 0; i < optionSetSizes.length; i++)
    {
        // size of this option set
        int n = optionSetSizes[i];                   

        // is this option set exclusive?
        boolean exclusive = isOptionSetExclusive[i]; 

        for (int k = 0; k < n; k++)
        {
            vals[c] = (exclusive) ? (k << r) : (0x1 << (r + k));
            c++;
        }

        r += (exclusive) ? (int) Math.ceil(Math.log(n)/Math.log(2)) : n; 
    } 

    return vals;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T22:39:50.397

> ...需要选择一组枚举值，以便它们可以组合...

你*真的*需要手动选择它们吗？例如，Java[`EnumSet`](http://java.sun.com/javase/6/docs/api/java/util/EnumSet.html)为您完成了繁琐的工作，并为您提供了一个[`Set`](http://java.sun.com/javase/6/docs/api/java/util/Set.html)用于操作这些标志的接口。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T22:44:10.917

使用 2 的幂，以便每个标志对应于单个位位置。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-02-04T22:39:12.363

为此，您可以使用标准枚举（在 C# 中）。为此，您需要设置[FlagsAttribute](http://msdn.microsoft.com/en-us/library/ms229062(VS.80).aspx)，然后专门为这些值编号。代码看起来像这样：

```
[Flags]
public enum AvailableColours {
    black = 1,
    red = 2,
    green = 4,
    blue = 8,
    white = 16,
} 
```

然后，标准的按位运算符将按预期工作。

[编辑] 嗯，好的，你想生成可能的组合，对吧？您的要求非常具体，所以如果有任何工具接近您想要的，我会感到非常惊讶。我认为您将不得不自己动手。我假设你想要这些作为字符串，对吗？这是一些实用程序代码，至少可以帮助您入门：

```
public const int BITS_IN_BYTE = 8;
public const int BYTES_IN_INT = sizeof(int);
public const int BITS_IN_INT = BYTES_IN_INT * BITS_IN_BYTE;

/// <summary>
/// Display the bits in an integer
/// </summary>
/// <param name="intToDisplay">The integer to display</param>
/// <returns>A string representation of the bits</returns>
public string IntToBitString(int intToDisplay) {
    StringBuilder sb = new StringBuilder();
    AppendBitString(intToDisplay, sb);
    return sb.ToString();
}

/// <summary>
/// Displays the bits in an integer array
/// </summary>
/// <param name="intsToDisplay">Arrau to display</param>
/// <returns>String representation of the bits</returns>
public string IntArrayToBitString(int[] intsToDisplay) {
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < intsToDisplay.Length -1; i++) {
        AppendBitString(intsToDisplay[i], sb);
        sb.Append(' ');
    }
    if (intsToDisplay.Length - 1 > 0)
        AppendBitString(intsToDisplay[intsToDisplay.Length - 1], sb);
    return sb.ToString();
}

private void AppendBitString(int intToAppend, StringBuilder sb) {
    for (int j = BITS_IN_INT - 1; j >= 0; j--) {
        sb.Append((intToAppend >> j) & 1);
        if (j % 4 == 0 && j > 1)
            sb.Append(' ');
    }
}

/// <summary>
/// Creates an integer from a bit string. This method can be used
/// to explicitly set bits in an integer during testing.
/// </summary>
/// <example>
/// int i = bitUtil.IntFromBitString("0000 0000 0000 0100");
/// </example>
/// <param name="bitString">String representing the individual bits</param>
/// <returns></returns>
public int IntFromBitString(String bitString) {
    int returnInt = 0;
    int currentBitPos = bitString.Length;
    for (int i = bitString.Length - 1; i >= 0; i--) {
        char c = bitString[i];
        if (Char.IsWhiteSpace(c)) continue;

        if (c == '1') {
            returnInt |= 1 << (bitString.Length - currentBitPos);
        }
        currentBitPos--;
    }
    return returnInt;
}

/// <summary>
/// Tests the status of an individual bit in and integer. It is 0 based starting from the most
/// significant bit. 
/// </summary>
/// <param name="bits">The integer to test</param>
/// <param name="pos">The position we're interested in</param>
/// <returns>True if the bit is set, false otherwise</returns>
public bool IsBitOn(int bits, int pos) {
    int shiftAmnt = (BITS_IN_INT - 1) - pos;
    return ((bits >> shiftAmnt) & 1) == 1;
}

/// <summary>
/// Calculates the number of integers (as in an array of ints) required to
/// store a given number of bits
/// </summary>
/// <param name="bitsNeeded">The total count of required bits</param>
/// <returns>The number of integers required to represent a given bit count</returns>
public int RequiredSizeOfIntArray(int bitsNeeded) {
    return (bitsNeeded / BITS_IN_INT) + (((bitsNeeded % BITS_IN_INT) == 0) ? 0 : 1);
}

/// <summary>
/// Calculates which array element would hold the individual bit for a given bit position
/// </summary>
/// <param name="bitPos">The position of the interesting bit</param>
/// <returns>An index into an array of integers</returns>
public int ArrayPositionForBit(int bitPos) {
    return bitPos / BITS_IN_INT;
}

/// <summary>
/// Sets an individual bit to a given value
/// </summary>
/// <param name="bits">The integer containing the bits</param>
/// <param name="pos">The position in the integer to set</param>
/// <param name="isSet">True for on, False for off</param>
public void SetBit(ref int bits, int pos, bool isSet) {
    int posToSet = (BITS_IN_INT - 1) - pos;
    if (isSet)
        bits |= 1 << posToSet;
    else
        bits &= ~(1 << posToSet);
}

/// <summary>
/// Converts an array of integers into a comma seperated list
/// of hexidecimal values.
/// </summary>
/// <param name="bits">The array of integers</param>
/// <returns>String format</returns>
public String IntArrayToHexString(int[] bits) {
    StringBuilder sb = new StringBuilder();
    for (int i = 0; i < bits.Length - 1; i++) {
        sb.Append(bits[i].ToString("X"));
        sb.Append(',');
    }
    if (bits.Length > 0) {
        sb.Append(bits[bits.Length - 1].ToString("X"));
    }
    return sb.ToString();
}

/// <summary>
/// Parses a comma seperated list of hexidecimal values and
/// returns an array of integers for those values
/// </summary>
/// <param name="hexString">Comma seperated hex values</param>
/// <returns>integer array</returns>
public int[] HexStringToIntArray(String hexString) {
    string[] hexVals = hexString.Split(new char[] {','});
    int[] retInts = new int[hexVals.Length];
    for (int i = 0; i < hexVals.Length; i++) {
        retInts[i] = Int32.Parse(hexVals[i], System.Globalization.NumberStyles.HexNumber);
    }
    return retInts;
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2009-02-05T00:37:44.933

您确定需要使用位域吗？

根据我的经验，具有一组布尔数据成员的类几乎总是最佳选择。

我听说过使用位域而不是更大的布尔值（通常是一个字节）的唯一论点是它应该更快。与所有优化一样，在不测量性能的情况下进行是一个坏主意。

一旦它被封装在一个类中，如果您决定更改表示以进行优化，您就可以做到这一点，而不会遇到很多其他代码。

# c# - 为什么使用 Windows 工作流？

> ID：513657
> 
> 赞同：33
> 
> 时间：2009-02-04T22:23:51.863
> 
> 标签：c#, .net, workflow, workflow-foundation

与滚动您自己的工作流框架相比，使用 Windows Workflow Foundation (WF) 有什么好处？

据我所知，WF 只提供了一个非常简单的运行时引擎、一堆类和一个用于定义工作流的架构（基于 XAML）。所有困难的事情，例如持久性、为运行时提供主机进程以及实现分布式工作流（跨进程）都由您决定。

此外，使用 WF 有一个学习曲线……如果我们创建自己的工作流框架，我们将简单地利用所有开发人员已经拥有的技能（C#、XML、SQL 等）。

我从一位 MS 布道者那里看到了这个博客，它试图解释为什么我们应该使用 WF：

[为什么是工作流？...](http://blogs.msdn.com/jamescon/archive/2005/09/22/472702.aspx)

IMO 在说服方面做得不好，因为它只是说它有助于“开发人员的生产力”，同时承认开发人员可以自己动手。

这里的任何聪明人能想出一个更好的理由吗？

**下面给出的答案摘要：**

* * *

我认为最有说服力的原因是，使用标准化的工作流平台（例如 WF（而不是滚动您自己的））将使您能够利用 MS 和第三方提供的 Visual Designer 等当前和未来的工具。

此外，由于它是基于 .NET 技术的 MS 堆栈的一部分，因此它可能会与未来的 MS 技术（例如 Azure）有更好的集成/迁移路径。

最后，拥有 WF 经验的开发人员数量将会增加（因为这将使他们的职业生涯受益），将其转变为 SQL 或 HTML 等基本商品技能，这意味着将更容易找到可以开始使用它的人最小的加速时间。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-08-15T15:44:53.290

使用 WF 的选择需要一些评估，我将尝试在此处提供一个相当全面的列表，说明优缺点。请记住，如果您要使用 WF，请不要使用 WF4+ 以外的任何东西，因为它已经过重写并且经过了严格审查，超过了它的前辈。

# 优点

*   成本
*   灵活性
*   耐用性
*   可分配性
*   未来

## 成本

在与其他路径进行比较时，需要注意 WF 的成本。这些路径可能包括[BizTalk](http://www.microsoft.com/biztalk)，一个基于开源代码的框架，如[Objectflow](http://objectflow.codeplex.com/)，甚至是你自己的。请记住，除非您需要一些非常简单的东西，否则每次滚动您自己的方法都是最昂贵的方法。因此，如果您需要相当大的功能，但还需要控制源代码，我会推荐一个开源框架。

## 灵活性

与 BizTalk 之类的框架相比，WF 是一个非常灵活的框架。在 WF 中，您可以编写自己的自定义活动并在框架之外执行您需要执行的操作 - 这确实为您提供了所需的功能。

## 耐用性

WF 包含一个非常强大的持久性框架。从某种意义上说，它是持久的，工作流的状态可以持久化，工作流可以设置为空闲（以保留资源），然后稍后再调用。**但是**，这种持久性更进一步，因为它已经设置为跨主机场的持久性。换句话说，工作流可以在一台主机上启动、持久化，然后在另一台主机上调用。

**假设工作流通过 Web 服务（即 WorkflowService）托管。**

## 可分配性

WF 已设置为跨主机场分布。

**假设工作流通过 Web 服务（即 WorkflowService）托管。**

## 未来

WF 是 BizTalk 的替代编排引擎，实际上是由构建 BizTalk 的同一个人开发的。因此，WF 在微软堆栈中有着光明的未来。事实上，现在微软正在努力构建单独的组件，以用组件替换 BizTalk 的每个功能。例如，[Windows Server AppFabric](http://www.microsoft.com/en-us/server-cloud/windows-server/appfabric.aspx)（更具体地说是 IIS 插件）是当今 BizTalk 中存在的监视服务的替代品。

微软为什么要这样做？因为 BizTalk 不太适合云，因为它是一个大规模安装，而他们正在构建的组件可以部署到云解决方案中。

# 缺点

*   灵活性
*   监控

## 灵活性

WF 的灵活性也可能是它的缺陷，因为有时您不需要它提供的灵活性，因此会花费更多时间来构建您本来只想包含在内的东西。有时您需要一个框架，该框架可以做出很多假设并且可能不符合惯例（例如 MVC）。但是，一般来说，我发现将 WF4 框架与Ron Jacobs 提供的开源[扩展结合起来时，情况并非如此。](http://wf.codeplex.com/)

## 监控

WF的监控还很年轻，这是它最大的陷阱。**但是，随着时间的推移，这将非常**迅速地推进，同时您可以使用[自定义跟踪](http://msdn.microsoft.com/en-us/library/cc299397.aspx)机制构建自己的监控工具。

# 资源

您最好的资源是[Ron Jacobs](http://blogs.msdn.com/b/rjacobs/)。我从未见过比他更愿意帮助必须使用 Microsoft 框架的开发人员社区的人。相信我，他通过多种渠道提供了大量有关 WF 的信息，只需上 Google 并查看。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T22:29:08.920

我能想到的倾向于在另一个工作流框架上使用 WF 的主要原因是：

1.  微软支持它作为框架的核心部分，因此它可以/将更容易集成到他们的其他技术中，如 Sharepoint 和 Azure“云应用程序”
2.  该工具可能会在另外几个版本中得到改进并且非常流畅，这应该会提高开发人员的生产力

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2009-02-04T22:28:54.897

我不得不在我的工作中创建工作流活动，我什至不能告诉你答案。

一个不太合理的原因是无效值/输入可以在工作流程图的设计时被确定和拒绝，因此编译时错误基本上不存在（假设您编写的所有样板代码都没有编译时错误）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2009-02-04T22:30:18.357

简短的回答：它是**免费**的，它可以完成工作。如果您可以推出更好的框架来管理工作流程并希望将时间花在上面，那么一定要这样做。但是考虑到**您的时间是物有所值**的，那么您愿意投入多少资金来构建更好的工作流程管理框架？我可以看到越来越贵。

此外，我很确定持久性（到磁盘或 SQL）是开箱即用的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2009-02-04T22:26:52.903

Visual Studio 中有一些相当不错的设计器支持，我不想自己动手，而且它是由其他人而不是我支持的框架，这意味着有人修复了架构错误并进行主要测试，让我来测试只是我的工作流程。我的意思是，我可以推出自己的 GDI+ 调用版本，但我宁愿不这样做。我自己的序列化框架、XML 解析器或 .NET 框架的一些其他元素也是如此。

归根结底，这些东西是作为工具包提供的。您是否选择使用工具完全取决于您要解决的问题、工具的适用性以及您可用于实现目标的时间和资源。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-02T06:56:42.897

它是一项新技术，或者您可以说它是最新的，并承诺不断更新功能。

它尊重以前的工作环境并使用它并添加那些对长期运行程序（大型项目）的开发非常有帮助的功能。

它将所有功能直接生成到开发人员手中，这些功能以前在后台运行，缺乏内部核心概念和程序员之间的交互。

是的，它有点复杂，但它也为程序员提供了更多的权力。

您可以期待在未来会有更好的框架和功能。它是编程的未来，所以我们今天就开始学习它。

# vbscript - vbscript：测试记录集中是否存在列

> ID：513660
> 
> 赞同：6
> 
> 时间：2009-02-04T22:24:09.010
> 
> 标签：vbscript

呸，VBScript。

我试图弄清楚如何让这个语句起作用：

```
if (not rsObject("columnNameThatDoesntExist") is nothing) then 
' do some stuff
end if
' else do nothin 
```

其中 rsObject 是 RecordSet 而 columnNameThatDoesntExist 是......你知道的。我正在寻找类似 rsObject.Columns.Contains(string) 的东西。但是当然找不到。

编辑：看起来循环 rsObject.Fields 是一个选项，这是唯一的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T22:38:31.820

我相信你有你的理由，但如果你不知道你从数据库中回调哪些字段，你总是可以使用 On Error Resume Next 和 On Error Goto 0 来忽略抛出的错误。对我来说似乎是一个坏方法，但它会起作用

```
blnItWasntThere = True
On Error Resume Next
If (rsObject("columnNameThatDoesntExist") <> "") Then 
  blnItWasntThere = False
  ...
  ...
  ...
End If
On Error Goto 0

If blnItWasntThere Then
'handle this error'
End If 
```

但是话虽如此，我认为您会更担心您要返回的神秘记录集。

或者制作自己的功能

```
Function ColumnExists(objRS, Column)
  Dim blnOutput, x
  blnOutput = True
  On Error Resume Next
  x = objRS(Column)
  If err.Number <> 0 Then blnOutput = False
  On Error Goto 0
  ColumnExists = blnOutput
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T22:59:06.520

要么 looooop 并检查它是否在那里，或者只是尝试抓住它：

```
Dim oRs:Set oRs = Nothing
On Error Resume Next
Set oRs = rsObject("columnNameThatDoesntExist")
On Error Goto 0
If Not rsObject("columnNameThatDoesntExist" Is Nothing Then 
    ' ...
End If 
```

# .net - ASP.NET MVC - MapRoute 与 routes.Add（和 404s）

> ID：513663
> 
> 赞同：20
> 
> 时间：2009-02-04T22:25:22.437
> 
> 标签：.net, asp.net-mvc, url-routing, asp.net-mvc-routing

我刚刚开始使用 ASP.NET MVC。

MapRoute 和 routes.Add 有什么区别？我应该只使用 MapRoute 吗？我可以映射多条路线吗？哪些“地图”优先……您首先或最后调用的那些？

我希望能够为用户做一些类似于 StackOverflow 的事情。但我希望 URL 适合这种模式：
“User/{domain}/{username}”被路由到 UserController

并为所有其他请求执行典型的 ASP.NET MVC 路由。前任：

```
 routes.MapRoute(
            "Default", "{controller}/{action}/{id}",
            new { controller = "Home", action = "Index", id = "" }  
        ); 
```

**更新：**
使用 URL 时：[http://localhost:3962/User/MYDOMAIN/BTYNDALL](http://localhost:3962/User/MYDOMAIN/BTYNDALL)
我收到错误：*HTTP 404。您要查找的资源（或其依赖项之一）可能已被删除，但名称已更改，或暂时不可用。*

这是我正在使用的代码：

```
public class MvcApplication : System.Web.HttpApplication
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "User",                                                     
            "User/{domain}/{username}",                           
            new { controller = "User", action = "Index" }      
        );

        routes.MapRoute(
            "Default",                                              
            "{controller}/{action}/{id}",                           
            new { controller = "Home", action = "Index", id = "" }  
        );

    }

    protected void Application_Start()
    {
        RegisterRoutes(RouteTable.Routes);
    }
} 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2009-02-04T22:30:30.213

`MapRoute()`是一个扩展方法`Routes.Add()`。使用`MapRoute()`, 除非你需要做一些比它允许的更复杂的事情。

路由按照定义的顺序进行评估，因此您首先调用的那些。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-04T23:16:56.437

您的用户控制器应该有

```
public class UserController : Controller {
    public ActionResult Index(string domain, string username) { return View(); }
} 
```

用户控制器的 Index 方法上的两个变量是从路由中获取的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2010-05-01T17:58:26.513

采用！

```
public class MvcApplication : System.Web.HttpApplication
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            "User",                                                     
            "User/{domain}/{username}",                           
            new { controller = "User", action = "Index", username= UrlParameter.Optional }      
        );

       }

    protected void Application_Start()
    {
        RegisterRoutes(RouteTable.Routes);
    }
} 
```

# c# - 一次性使用图案

> ID：513672
> 
> 赞同：14
> 
> 时间：2009-02-04T22:27:41.187
> 
> 标签：c#

```
 using (FileStream fileStream = new FileStream(path))
  {
    // do something
  } 
```

现在我知道 using 模式是 IDisposable 的实现，即设置了 Try/Catch/Finally 并在对象上调用 Dispose。我的问题是如何处理 Close 方法。

[MSDN](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)说它没有被调用，但我已经阅读了其他内容。

我知道 FileStream 从[这里](http://msdn.microsoft.com/en-us/library/ms227422.aspx)解释的 Stream 继承。现在说不要覆盖 Close()，因为它是由 Dispose() 调用的。

那么有些类是在它们的 Dispose() 方法中调用 Close() 还是使用调用 Close()？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-04T22:30:00.557

该`using`语句*只*知道`Dispose()`，但`Stream.Dispose`调用`Close()`，如[MSDN 中所述](http://msdn.microsoft.com/en-us/library/ms227422.aspx)：

> 请注意，由于向后兼容性要求，此方法的实现与 Dispose 模式的推荐指南不同。此方法调用 Close，然后调用 Stream.Dispose(Boolean)。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2009-02-04T22:29:35.970

仅使用调用 Dispose()。Dispose() 方法可能会调用 Close() 如果它是这样实现的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T22:31:02.037

Close() 不是 IDisposable 接口的一部分，因此 using 无法知道是否应该调用它。using 只会调用 Dispose()，但智能设计的对象会在 Dispose() 方法中关闭自己。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-04T22:30:25.360

我不认为 using 调用 Close()，它无法知道它应该调用该特定函数。所以它一定是调用 dispose，而那又是调用 close。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T22:30:48.247

在 .Net 类中，Close() 调用 Dispose()。你也应该这样做。

# python - 非 ASCII 编码文件中的换行符

> ID：513675
> 
> 赞同：1
> 
> 时间：2009-02-04T22:28:09.470
> 
> 标签：python, encoding, file

我正在使用 Python 2.6 读取带有 windows 行结尾 ('\r\n') 的 latin2 编码文件。

```
import codecs

file = codecs.open('stackoverflow_secrets.txt', encoding='latin2', mode='rt')
line = file.readline()
print(repr(line)) 
```

输出：`u'login: yabcok\n'`

```
file = codecs.open('stackoverflow_secrets.txt', encoding='latin2', mode='r')
line = file.readline()
print(repr(line)) 
```

或者

```
file = codecs.open('stackoverflow_secrets.txt', encoding='latin2', mode='rb')
line = file.readline()
print(repr(line)) 
```

输出：`u'password: l1x1%Dm\r\n'`

我的问题：

1.  为什么文本模式不是默认模式？文档另有说明。`codecs`模块通常与二进制文件一起使用吗？
2.  为什么没有从 readline() 输出中删除换行符？这是烦人和多余的。
3.  有没有办法为非 ASCII 编码的文件指定换行符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T23:13:09.550

你确定你的例子是正确的吗？编解码器模块的[文档说：](http://docs.python.org/library/codecs.html#module-codecs)

> 注意：文件总是以二进制模式打开，即使没有指定二进制模式。这样做是为了避免由于使用 8 位值进行编码而导致的数据丢失。这意味着在读写时不会自动转换 '\n'。

在我的系统上，使用 Latin-2 编码文件 + DOS 行结尾，“rt”、“r”和“rb”之间没有区别（免责声明：我在 Linux 上使用 2.5）。

的文档`open`也没有提到“t”标志，所以这种行为似乎有点奇怪。

换行符不会从行中删除，因为并非所有返回的行都`readline`可能以换行符结尾。如果文件不以换行符结尾，则最后一行不带换行符。（我显然想不出更好的解释）。

换行符不会因编码而异（至少在使用 ASCII 表示 0-127 的编码中不会有所不同），仅基于平台。您可以在打开文件时在模式中指定“U”，Python 将检测任何形式的换行符，无论是 Windows、Mac 还是 Unix。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T01:23:09.630

> 模式='rt'

'rt' 本身并不是一个实模式 - 它与 'r' 的作用相同。

> 为什么文本模式不是默认模式？

请参阅 Torsten 的回答。

此外，如果您使用的不是 Windows，那么文本模式文件的行为无论如何都与二进制文件相同。

您可能会想到“U”通用换行模式，它试图允许其他平台的文本模式文件工作。虽然可以将“U”标志传递给 codecs.open，但鉴于上面概述的文档，我认为这是[bug](http://bugs.python.org/issue691291)。当然，UTF-16 和一些东亚编解码器的结果会出错，所以不要依赖它。

> 为什么没有从 readline() 输出中删除换行符？

有必要能够判断文件的最后一行是否以尾随换行符结尾。

# eclipse - Eclipse 项目未在 Mac 上构建，原因是“存在不同情况的资源”错误

> ID：513676
> 
> 赞同：16
> 
> 时间：2009-02-04T22:28:24.133
> 
> 标签：eclipse, macos

我正在尝试按照说明将android java源导入mac上的eclipse：

[http://source.android.com/source/using-eclipse.html](http://source.android.com/source/using-eclipse.html)

我确实在 Mac 上创建了一个新分区（'Mac OS Extended，区分大小写，记录）。我能够在命令行成功构建 android sdk。

但是当我尝试创建一个新的 eclipse 项目时，我得到了这个错误，它阻止了 eclipse 构建 android 源代码：

```
The project was not built due to "A resource exists with a different
case: '/android/out/target/common/obj/JAVA_LIBRARIES/
android_stubs_current_intermediates/classes/MANIFEST.mf'.". 
Fix the problem, then try refreshing this project and building it since it may
be inconsistent android 
```

你能告诉我如何解决我的问题吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2011-02-01T16:01:39.827

我刚遇到这个问题。当您的包名称大小写不匹配时，就会发生这种情况。我通过关闭 Eclipse 并协调我的项目文件夹（在 bin、gen 和 src 下）以及我的 AndroidManifest.xml 中的所有包名称来解决它。一旦一切都匹配，我重新打开 Eclipse，进行了清理和构建，错误就消失了。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-07-12T05:24:38.273

当我在同一个项目中定义了不同案例的 2 个单独的包时遇到了这个问题

src/main -> com.mycompany.project.DAO

src/test > com.mycompany.project.dao

实际上，第二个包是用于 JUnit 测试用例的，不应该在构建路径上。当我从构建路径中删除第二个包时（右键单击 src/test -> 从构建路径中删除），这个错误就消失了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-01-20T12:48:15.770

Just check your Manifest file. The package name/path should be correct. Then just delete R.java file, and clean the project. If dat doesnt solve the problem, close eclipse, and start again. I faced same issue on windows.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-11T09:18:02.253

右键单击您的项目，选择构建路径 -> 配置构建路径。在“源项目”选项卡下检查单词“BIN”的大小写。如果 BIN 大写，则使其与项目树层次结构中的相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-28T09:05:07.673

只需解决同样的问题。

清理项目并删除 R 文件。

重新启动eclipse，然后检查“问题”选项卡

我发现两个 R 文件不匹配，更正它并解决问题！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-18T06:00:22.553

这是因为你的 jar 文件。取出罐子并添加正确的罐子。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-03-24T18:18:57.873

对我来说，有效的是将工作区“切换到新工作区”。（因为旧的被污染了）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-03-16T10:51:47.397

**1_**将清单 XML 标记中的“package”参数与 Src Java 文件中的包名称完全匹配。

com.example.myapp**不是**com.example.MyApp

**2_**删除Gen文件夹中的所有东西

**3_**项目 -> 清理

享受**:)**

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-05-29T21:04:59.263

将现有项目导入 Eclipse 时，我遇到了同样的问题。我命名了新项目包`com.example.myproject`，但旧活动正在引用`package com.example.MyProject`（注意大写的差异）。在我重命名包后，项目构建良好。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-11-07T23:28:09.827

自己尝试了上述许多解决方案。我发现最好从我的工作区中删除应用程序并重新导入它。之后自己解决了。

# database - 如何对随时间缓慢变化的数据建模？

> ID：513677
> 
> 赞同：3
> 
> 时间：2009-02-04T22:28:29.327
> 
> 标签：database, sql-server-2005, time

假设我得到了大量（200 万行？）本应是静态且不变的数据。应该是。这些数据每月重新发布一次。有哪些方法可用于 1）了解哪些数据点每个月都发生了变化，以及 2）使用给定时间点的数据？

**解决方案 1)**天真地保存数据的每个快照，按日期注释。差异感知由一些内部程序处理，但按日期消耗数据是微不足道的。缺点，空间需求激增了一个数量级。

**解决方案 2A)**使用内部程序，跟踪差异发生的时间并将它们存储在 EAV 表中，并按日期进行注释。空间要求低，但与原始数据集成的消耗变得笨拙。

**解决方案 2B)**使用内部程序，跟踪差异发生的时间并将它们存储在一个看起来很像原始表的稀疏填充表中，只填充更改的数据和更改的日期。缺点，模型是稀疏的，并且与原始数据集成的消费不是微不足道的。

我想，基本上，我如何将时间维度集成到关系数据库中，同时牢记数据的查看和时间段之间差异的意识？

这是否与数据仓库有关？

闻起来像……慢慢改变维度？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T23:23:12.167

我有一个类似的问题 - 每天一次将大型平面文件导入数据库。大多数数据是不变的。

向表中添加两个额外的列，starting_date 和ending_date。ending_date 的默认值应该是将来的某个时间。

要将一个文件与下一个文件进行比较，请按关键列对它们进行排序，然后从每个文件中读取一行。

*   如果键相等：比较其余列以查看数据是否已更改。如果行数据相等，则该行已经在数据库中，没有什么可做的；如果不同，则将数据库中的现有行更新为今天的结束日期，并插入一个开始日期为今天的新行。从两个文件中读取一个新行。
*   如果旧文件中的键较小：该行已被删除。将ending_date 更新为今天。从旧文件中读取新行。
*   如果新文件中的键较小：插入了一行。将起始日期为今天的行插入数据库。从新文件中读取新行。

重复，直到您从两个文件中读取所有内容。

现在要查询在任何日期都有效的行，只需在 start_date 和 end_date 之间使用 where 子句 test_date 进行选择。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2010-07-27T12:57:46.893

你也可以从数据仓库这本书中学习。基本上有三种处理变化数据的方法。看看这篇关于 SCD 的维基百科文章，但它本质上是表格： [http ://en.wikipedia.org/wiki/Slowly_changeing_dimension](http://en.wikipedia.org/wiki/Slowly_changing_dimension)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T22:37:00.293

这在很大程度上取决于您如何存储数据。有两个因素需要考虑：

*   数据多久更改一次？
*   数据变化多少？

区别很重要。如果它经常变化但变化不大，那么带注释的快照将非常低效。如果它不经常更改但很多，那么它们是一个更好的解决方案。

这还取决于您是否需要查看数据在特定时间点的样子。

例如，如果您使用 Oracle，您可以使用[闪回查询](http://www.oracle-base.com/articles/9i/FlashbackQuery.php)在任意点查看数据的一致视图。

就我个人而言，我认为您最好增量存储它，并且至少使用某种形式的审计来跟踪更改，以便您可以在需要时恢复历史快照。但就像我说的，这取决于很多因素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-04T22:39:42.020

如果是我，我会每个月保存整个内容（不一定在数据库中，而是作为数据文件或离线文本文件） - 你会很高兴你这样做了。即使行大小为 4096 字节（疯狂的猜测），您也只是在谈论每月 8G 的磁盘。您可以在 300G 驱动器上节省很多个月的时间。多年来我一直在做类似的事情，当我每天下载超过 1G 的数据到数据仓库时。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-04T22:49:51.750

在我看来，这听起来更像是源代码版本控制系统所面临的问题。这些存储补丁用于在发生更改时创建更改。所以如果一个文件没有变化，或者只有几行变化，那么需要存储的补丁就比较小了。系统还存储每个补丁所贡献的版本。因此，当查看特定文件的特定版本时，会恢复初始版本并应用所有补丁，直到请求的版本。

在您非常一般的情况下，您需要将数据分成块。希望有你可以使用的自然划分，但如果这个划分必须是任意的，那应该没问题。每当发生更改时，存储受影响块的补丁并记录新版本。现在，当您想要查看特定日期时，找到早于查看日期的最后一个版本，为已请求的块应用补丁并显示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-04T22:50:05.133

你能做到以下几点：

```
1\. Each month BCP all data into a temporary table
2\. Run a script or stored procedure to update the primary table 
   (which has an additional  DateTime column as  part of a composite key), 
   with any changes made.
3\. Repeat each month. 
```

这应该会为您提供一个表格，您可以在特定日期查询数据。

此外，每次更改都会被记录下来，并且表的大小不应随着时间的推移而发生显着变化。

但是，作为对此的备份，我会按照 Brennan 的建议存储每个数据文件。

# c# - 自定义文本框控件和验证显示

> ID：513678
> 
> 赞同：2
> 
> 时间：2009-02-04T22:28:47.267
> 
> 标签：c#, asp.net, custom-controls

我创建了一个自定义 TextBox 控件，其中还包含一个RequiredFieldValidator。一切正常，但问题在于显示。显示是这样的：

```
[TextBox Control] [Validation Error Message] 
```

我希望显示是这样的：（验证错误消息应该在文本框的顶部）

```
[Validation Error Messsage] 
[TextBox Control] 
```

我的控件继承自 TextBox 控件。我怎样才能像上面那样创建显示。我尝试使用 Table 控件并在 Table 中插入 TextBox 和 Validation 控件，但它给了我某种堆栈溢出错误。

这是代码：

```
protected override void Render(System.Web.UI.HtmlTextWriter writer) {
    base.Render(writer);

    if(_req != null)
        _req.RenderControl(writer);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-10T15:52:12.187

你真的很接近做对了！试试这个：

```
protected override void Render(System.Web.UI.HtmlTextWriter writer)
{
    if(_req != null)
        _req.RenderControl(writer);
    base.Render(writer);
} 
```

这将在您的 TextBox 之前而不是之后呈现验证控件。如果你想进一步改变外观，那么 css 可能是要走的路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T22:41:44.963

这是丑陋的解决方案：

```
protected override void Render(System.Web.UI.HtmlTextWriter writer)
        {
           if (_req != null)
           {
               writer.Write("<div style='float:top;'>");
               _req.RenderControl(writer);
               writer.Write("</div>");
           }

           base.Render(writer);
        } 
```

# linux - Linux 中的上下文切换需要多长时间？

> ID：513692
> 
> 赞同：3
> 
> 时间：2009-02-04T22:30:56.047
> 
> 标签：linux, performance, multithreading, low-level

我很好奇在 Linux 中改变上下文需要多少个周期。我专门使用 E5405 Xeon (x64)，但我也很想看看它与其他平台的比较。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-05T21:37:13.080

有一个名为 LMBench 的免费应用程序，由 Larry McVoy 和朋友编写。它提供了一堆操作系统和硬件基准测试，其中一个测试称为 lat_ctx，它测量上下文切换延迟。谷歌 lmbench 并在您自己的硬件上检查自己。这是获得对您有意义的数字的唯一方法。

吉拉德

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-04T22:43:04.853

在你的机器上运行**vmstat**，同时做一些需要大量上下文切换的事情。它不会告诉您实际切换需要多长时间，但会告诉您每秒执行多少次切换。

然后，与切换上下文相比，您必须估计每个时间片在执行实际代码上花费了多少。也许是 100:1 之类的？我不知道。1000:1？

我的一台机器现在每秒大约进行 3000 次切换，即每个时间片 0.3 毫秒。100:1 的比率意味着实际切换需要 0.003 毫秒。

但是，对于多核、产生执行的线程等，我不会从这样的猜测中得出任何结论:)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2009-02-04T22:48:31.470

我编写的代码能够以每秒 200k 个数据包的速度回显（小）UDP 数据包。

这表明可以在不超过 2.5 微秒内进行上下文切换，而实际的上下文切换可能花费的时间可能会少一些。

# java - 如何在单个 Eclipse 项目中设置多个源文件夹？

> ID：513697
> 
> 赞同：18
> 
> 时间：2009-02-04T22:31:48.337
> 
> 标签：java, eclipse

我有几个有点独立的程序，从概念上讲可以适合单个项目。但是，我无法告诉 Eclipse 在项目文件夹中创建多个文件夹。

一个简单的结构形式是：

```
/UberProject
/UberProject/ProgramA/
/UberProject/ProgramA/com/pkg/NiftyReader.java
/UberProject/ProgramB/
/UberProject/ProgramB/com/pkg/NiftyWriter.java 
```

也就是说，`ProgramA`并且`ProgramB`都是项目（事实上，它们是当前现有的 Java 项目），它们在概念上适合`UberProject`.

我不认为我应该`UberProject`成为一个 Java 项目。例如，它不是类路径。 `ProgramA`并且`ProgramB` *看起来*它们应该是 Java 项目（它们也可能使用不同的构建依赖项），但我认为在 Eclipse 3.3 中无法在其下创建两个`UberProject`旨在包含 Java 代码的文件夹。我曾考虑向两个子项目中的每一个添加一个 .project 文件，但我也不确定这是否合适。Eclipse 帮助没有帮助，我没有看到关于这个特定问题的任何内容。

只是要清楚一点：假设给定存在的必要性`UberProject`。 `UberProject`可以是 Java 项目，也可以不是；没关系。（顺便说一下，它确实包含其他不包含 Java 代码的文件夹。）

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2009-02-04T22:52:50.620

可能有几种方法可以做到这一点：

1) UberProject 是你的 JavaProject。右键单击 ProgramA -> 构建路径 -> 用作源文件夹。右键单击 ProgramB -> 构建路径 -> 用作源文件夹。ProgramA 和 ProgramB 都将对同一目录进行增量构建。

2）两个java项目（ProgramA和ProgramB）。您可以使用 UberProject 作为最简单的 Eclipse 工作区，或者您可以使用外部工作区并将 ProgramA 和 ProgramB 作为外部项目导入。

可能还有其他方法（maven 多模块项目）。您的选择可能取决于您是否在项目之间存在循环依赖关系。尝试 1 和 2 并查看最适合您的应该相对容易。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-04T23:00:29.730

您可以在一个项目中拥有多个源目录，但是您的描述听起来像是您想要一个项目中的多个子项目，而 Eclipse 不允许（据我所知）。

如果您真的只想要多个源目录，其中`ProgramA`,`ProgramB`等仅包含 java 文件而没有其他内容，那么您可以相对容易地做到这一点。在包资源管理器中右键单击您的项目，然后选择`Build Path -> Configure Build Path...`. 在弹出的对话框中，确保`Java Build Path`在左窗格中选中，单击`Source`选项卡，然后单击`Add Folder...`按钮。`ProgramA`从列表中选择，然后重复 for`ProgramB`等。

如果您希望每个源文件夹都有自己的输出文件夹，只需选中`Allow output folders for source folders`复选框并根据需要编辑输出文件夹。

如果这实际上不是您想要做的，那么另一种选择可能是将您的项目分组到一个工作集中。工作集不是 UberProject，但它确实有助于在包资源管理器中组织您的项目。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T22:34:10.407

你需要优步项目吗？我有相同的布局，但有多个使用 File|New 项目创建的顶级项目。如果没有，您能否将其设为 General 而不是 Java 项目？

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-02-04T22:55:25.857

因此，您可以通过在工作区中拥有两个 Java 项目来实现。
那么问题是如何在“UberProject”下将两个项目组合在一起

一种方法是拥有一个“UberProject”工作区，并在 UberProjects 之间切换工作区。另一种方法是将“UberProject”定义为工作集（Window:Working Sets）并将 PrmgramA 和 ProgramB 添加为该工作集的项目。选择该工作集，您只会看到那些项目。

您可以拥有一个 java 项目，并为其定义多个源文件夹。这通常是针对同一项目中的“主要”与“测试”层次结构进行的。

有办法，也有办法。选择一个适合你的:-)

# ruby-on-rails - 有没有人写过一个插件来为 ActiveResource 添加最后的润色？

> ID：513698
> 
> 赞同：3
> 
> 时间：2009-02-04T22:33:11.487
> 
> 标签：ruby-on-rails, plugins, activeresource

[我在我的 Ruby on Rails 应用程序中使用ActiveResource](http://api.rubyonrails.org/classes/ActiveResource/Base.html)已经有一段时间了，我开始真的觉得它需要最后的润色才能让它从“相当不错”变成“漂亮”。

我希望能够像使用 ActiveRecord 一样使用 ActiveResource。如果我可以使用ActiveResources 和其他细节`has\_many`，`belongs\_to`它会让我的生活更轻松。

所以我四处寻找一个插件来做到这一点，但没有找到任何运气。有人写过吗？有人知道正在进行的项目吗？

* * *

### **存在的理由**

假设我有一个管理的应用程序`Users`和另一个管理的应用程序`UserRequests`。我想避免我的应用程序之间的任何循环依赖，因此我决定`Users`应用程序将完全不知道`UserRequests`. 但是当然， a`UserRequest`应该属于 a `User`，并且 a`User`应该有很多`UserRequests`。

因此，在`Users`应用程序中，我所拥有的只是一个`User`ActiveRecord，其中包含所有必要的控制器内容以使其可通过 ActiveResource 使用。

复杂的东西在`UserRequests`应用程序中。我有一个`UserRequest`ActiveRecord 和一个`User`ActiveResource。我很想编写`UserRequest` `belongs_to`一个 User ActiveResource 和一个`User`ActiveResource的事实`has_many` `UserRequests`。

在另一种情况下，它可能是相反的方式（ActiveRecord `has_many`ActiveResources，ActiveResource`belongs_to`是 ActiveRecord）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-04T22:55:09.273

Ryan Daigle[提议](http://ryandaigle.com/articles/2008/11/10/implement-ruby-proxy-objects-with-roxy)用他的 Roxy gem 做类似的事情。从他的预告片部分：

> 我希望很快有一个扩展库，它利用 Roxy 在 ActiveResource 中提供类似 ActiveRecord 的关联定义。

[他给出的示例显示了使用Roxy](http://github.com/yfactorial/roxy/tree/master)实现起来不会太困难。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T16:37:57.457

我刚刚遇到了[Hyperactive Resource 插件](http://wiki.github.com/lukegalea/hyperactiveresource)。我现在正在看它……看起来不错。

有趣的是，我决定编写自己的插件，并且正在为它寻找一个好名字。我想找到一个名称，给人的感觉是“ActiveResource++”，ActiveResource 的增强版本。我在“SexyResource”和“HyperactiveResource”之间犹豫不决，认为前者在政治上不够正确。所以我开始编写我的 HyperactiveResource 插件......直到我想知道是否有人已经想到了这个名字。事实证明有人做到了。插件就在那里。凉爽的！但是，我们开发人员的想法是一样的，这有点可怕，不是吗？;-)

# flash - 带有缩略图的 Flash 本地文件浏览器

> ID：513703
> 
> 赞同：1
> 
> 时间：2009-02-04T22:34:44.353
> 
> 标签：flash, actionscript, upload, file-browser

有没有办法让 Flash 文件浏览器允许用户浏览他们的本地计算机、查看 jpg 和其他图像的缩略图并上传选定的文件？这就像 Facebook 使用的 ActiveX/Java 小程序。有什么想法或例子吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T01:00:34.327

您可以使用 FileReference 对象，它允许用户浏览他的文件系统（它会弹出本机 OS UI 控件，所以如果您想要制作文件浏览器本身，恐怕这是不可能的，至少在普通 swf ）。

在 flash player 10 中，您可以直接使用本地文件；将文件加载到 swf 中，修改并保存回来（它需要用户交互，即鼠标单击，然后再次弹出“保存文件”本机对话框；出于安全原因，您不能直接写入文件） . 对于以前的版本，您必须先将文件上传到服务器，然后再将其下载回来才能进行修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T23:11:59.833

Adobe AIR 应该能够做到这一点。通过将 Flash 放入 AIR“容器”中，它应该拥有比普通 Flash 应用程序更多的权限。
[Adobe AIR](http://www.adobe.com/products/air/)

不确定您是否可以从浏览器中的 Flash 执行此操作。

Facebook 的东西是 Java。所以Java可以做到。

Silverlight 或许可以做到。没有把握。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T05:43:24.677

要回答您的问题，遗憾的是，您无法专门在浏览器嵌入的 SWF 中专门复制 Facebook 图像上传控件的功能，不，没有允许从 Web 浏览器中直接访问文件系统的 Actionscript API。

两张海报都是正确的，但在不同的点上——AIR 可以做到（在某些限制下，使用`flash.filesystem.File`），并且您可以浏览到（使用本机操作系统文件选择对话框，使用`flash.net.FileReference`），选择一个或多个文件并将其上传到Web 服务器——但是在 Flash 播放器插件范围内工作的 Web 浏览器中，不可能枚举本地目录的内容并以这种方式显示缩略图图像。不是单独使用 Flash。（或者甚至是 Silverlight，就​​此而言。）

对不起，我希望我有一个更好的答案给你。如果应用程序需要基于 Web，Java 看起来仍然是最合理的选择。不过，您可能还会研究[JavaFX](http://javafx.com/) ——我自己还没有使用过它，但它可能会提供其他两个没有的东西。祝你好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-07T14:50:29.653

您可以尝试使用[HippoHX](http://hippohx.com/)构建一个具有 Flash 前端/GUI 的无限制桌面应用程序。它将[Neko](http://nekovm.org/)用于小型系统层应用程序，该应用程序可以完全访问所有系统资源。据我所知，没有直接在浏览器中执行此操作的解决方案，请接受使用 Java。

# sql-server - sql2008中违反主键约束的详细错误信息？

> ID：513718
> 
> 赞同：4
> 
> 时间：2009-02-04T22:39:22.020
> 
> 标签：sql-server, sql-server-2008

我将大量行插入到一个空表中，其中一列上有一个主键约束。如果出现重复键错误，有没有办法找出导致错误的键（或行）的值？

遗憾的是，在插入之前验证数据不是我现在可以做的事情。

使用 SQL 2008。

谢谢！

* * *

做计数（*）/分组是我试图避免的事情，这是从数百个不同的数据库（其中一些在远程服务器上）插入数亿行......我不有时间或空间进行两次插入。

提供者的数据应该是唯一的，但不幸的是，他们的验证似乎不能 100% 正常工作，我试图至少看看它在哪里失败，这样我就可以帮助他们排除故障。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T16:36:55.773

没有一种方法不会减慢您的进程，但这里有一种方法可以使它更容易。您可以在该表上添加一个代替触发器以进行插入和更新。触发器将在插入之前检查每条记录，并确保它不会导致主键冲突。您甚至可以创建第二个表来捕获违规行为，并在该表上使用不同的主键（如标识字段），触发器会将行插入到错误捕获表中。

这是触发器如何工作的示例：

```
CREATE TRIGGER mytrigger ON sometable
INSTEAD OF INSERT
AS BEGIN
  INSERT INTO sometable SELECT * FROM inserted WHERE ISNUMERIC(somefield) = 1 FROM inserted;
  INSERT INTO sometableRejects SELECT * FROM inserted WHERE ISNUMERIC(somefield) = 0 FROM inserted;
END 
```

在该示例中，我在将数据插入表之前检查一个字段以确保它是数字的。您需要修改该代码以检查是否存在主键违规 - 例如，您可能会将 INSERTED 表连接到您自己的现有表中，并且只插入未找到匹配项的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T14:13:06.127

解决方案将取决于这种情况发生的频率。如果时间小于 10%，那么我会执行以下操作：

1.  插入数据
2.  如果错误，则执行 Bravax 的修订解决方案（删除约束、插入、查找 dup、报告并终止 dup、启用约束）。

这意味着它只会在错误发生的几次上花费您。

如果这种情况发生得更频繁，那么我会考虑让男孩们去看看提供者:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T22:54:47.573

修订：
由于您不想插入两次，您可以：

```
Drop the primary key constraint.
Insert all data into the table
Find any duplicates, and remove them
Then re-add the primary key constraint 
```

上一个回复：将数据插入到没有主键约束的表的副本中。

然后对其运行查询以确定 rpimary 键列具有重复值的行。

```
select count(*), <Primary Key>
from table
group by <Primary Key>
having count(*) > 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T19:13:09.250

使用 SSIS 导入数据并让它作为数据流的一部分进行检查。这是最好的处理方式。SSIS 可以将不良记录发送到表中（您可以稍后将其发送给供应商以帮助他们清理行为）并处理好的记录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2010-03-08T16:25:15.137

我不敢相信 SSIS 不会轻易解决这个“现实”，因为，让我们面对现实吧，您经常需要并且希望能够：

1.  查看是否存在具有某个唯一键或主键的记录
2.  如果没有，请插入
3.  如果是这样，请忽略它或更新它。

我不明白如果没有以易于使用的方式内置的这种功能，他们将如何让产品推出市场。例如，设置组件的属性以自动检查这一点。

# google-search - Google 搜索 URL 中未记录的 fp 查询参数

> ID：513719
> 
> 赞同：7
> 
> 时间：2009-02-04T22:39:24.547
> 
> 标签：google-search

[搜索协议参考](http://code.google.com/apis/searchappliance/documentation/52/xml_reference.html)没有提到任何关于 fp 参数的内容。然而，它似乎有时会出现。有谁知道它的作用？

# ms-access - Access 2003 - 表单上另一个数据库中的字段

> ID：513727
> 
> 赞同：0
> 
> 时间：2009-02-04T22:41:19.660
> 
> 标签：ms-access, forms, lambda, field

我正在“修复”一个旧的 Access 数据库，客户要求将 DATE 字段添加到表单中。问题是，我以前从未使用过 Access。我是一个 SQL 人，我构建了自己的 UI。这种形式的事情正在使我变得更好。

好的 - 所以我有两个表： tblQuestionairre QuestionairreID EventID blah blah blah

tblEvent EventID DateTime 等等等等

现在，我正在编辑 frmQuestionairre（Questionairre 表格）。Questionairre Table (tblQuestionairre) 中的所有信息都在这里。问题是，我需要在此表单的某处添加 DateTime 字段，以便客户可以看到输入问题的时间。如您所见，我的链接项是 EventID。

尽我所能，我不能只使用“表达式生成器”从事件表中“添加”日期时间。我需要为当前加载的 Questionairre 加载正确的 DateTime。每个 Questionairre 都链接到一个事件。

如何将此字段添加到 Questionairre 表单？我不断收到#Name？错误，这显然是因为它不知道链接EventID上的两个表..想法？

编辑：是的，这是一个简单的一对一关系。是的，该字段需要可编辑。

答案：=DLookUp("[DateEntered]","tblEvent","EventID=" & Forms!frmQuestionnaire!EventID)

编辑：现在我已经显示了，我不能编辑它！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-02-04T22:56:30.003

最快的方法是在表单的 OnCurrent 事件中使用 DLookup 函数。OnCurrent 在加载新记录并且 DLookup 执行返回一个值的简单数据库查找时触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T22:52:30.433

如果我正确阅读了这个问题，那么您在 tblQuestionairre 和 tblEvent 之间的 EventID 上有 1-1 关系吗？

如果是这样，只需打开表单的属性表并编辑“数据”选项卡上的“记录源”属性，使其基于连接两个表的查询，而不仅仅是 tblQuestionairre。您甚至可以使用属性表中的构建器来构建查询。

一旦你设置好了，你应该能够在表单上放置一个新的文本框并将它的控制源（再次在属性表的数据选项卡上）设置为“日期时间”字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-19T02:03:50.077

您需要更改 Form 的 RecordSource，以便它链接到连接两个表而不是一个表的查询。

在您的情况下，编辑 RecordSource 属性并使用设计器创建查询或单击 SQL 按钮输入如下内容：

```
SELECT tblQuestionaire.QuestionaireID, 
       tblQuestionaire.EventID,
       tblQuestionaire.blahblah,
       tblEvent.DateTime,
       tblEvent.blahblahblah
FROM tblQuestionaire 
INNER JOIN tblEvent 
      ON tblQuestionaire.EventID=tblEvent.EnventID; 
```

这假设您在表之间具有严格的 1 对 1 关系，否则，`LEFT JOIN`如果它是 1 对 [0,1] 关系，则使用 a。

# cocoa-touch - 绘制路径时CALayer闪烁

> ID：513731
> 
> 赞同：0
> 
> 时间：2009-02-04T22:42:45.837
> 
> 标签：cocoa-touch, core-animation, calayer

我正在使用 a`CALayer`通过`drawLayer:inContext`委托方法显示路径，该方法位于图层所属视图的视图控制器中。每次用户在屏幕上移动手指时，路径都会更新并重新绘制图层。但是，绘图跟不上触摸：在显示路径的最后两个点时总是有轻微的延迟。它也会闪烁，但只是在再次显示最后两三个点时。如果我只是在视图中进行绘图`drawRect`，它可以正常工作并且绘图绝对足够快。

有谁知道它为什么会这样？我怀疑这与图层缓冲有关，但我找不到任何有关它的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2010-04-20T22:30:59.333

`[UIView new]`只是 . 的简写`[[UIView alloc] init]`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2010-11-18T11:09:22.517

在方法之前给出以下内容`setNeedsDisplay`::

```
[CATransaction begin];

[CATransaction setValue:[NSNumber numberWithFloat:someDelay] forKey:kCATransactionAnimationDuration];

[aLayer setNeedsDisplay];                    
[CATransaction commit]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-10T22:22:49.473

[使用图层托管视图](https://stackoverflow.com/questions/351503/whats-the-difference-between-a-coreanimation-layer-backed-view-and-a-layer-hosti)可能会更好。

不要使用 drawLayer:inContext: 方法，而是设置您想要的视图并向其添加 CALayer：

```
UIView *layerHosting = [[UIView alloc] initWithFrame:frame];
[layerHosting setLayer:[[CALayer new] autorelease]]; 
```

希望有帮助！

# jquery - jQuery 隐藏显示 div 在 Internet Explorer 中不起作用

> ID：513735
> 
> 赞同：4
> 
> 时间：2009-02-04T22:43:47.080
> 
> 标签：jquery, internet-explorer

当我单击`togglediv`时，**`commentdiv`**必须可见或隐藏。以下代码在 Firefox 上运行，但不在 Internet Explorer 上：

```
$(document).ready(function(){
    $("#togglediv").click(function(){ 
        if( $("#commentdiv").is(":visible") ) {
            $("#commentdiv").hide("slow");
            $("#togglediv").text("show");
        } else {
            $("#commentdiv").show("slow");
            $("#togglediv").text("hide");
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-02-04T22:49:03.577

jquery 中有一个功能**切换**功能，它可以完全按照您的意愿进行操作，而无需检查可见性：

```
$("#commentdiv").toggle("slow"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2009-02-04T22:53:26.780

我会尝试：

```
$(document).ready(function() {
  $("#togglediv").click(function() {
    // note: do this first because the :hidden test fails if you
    // do it after triggering a slow animation
    $("#togglediv").text($("#commentdiv").is(":hidden") ? "Hide" : "Sgiw");
    $("#commentdiv").toggle('slow');
  });
}); 
```

**编辑：**作为对您的评论的回应，此示例在 IE7/FF3 中非常适合我。 **注意：**使用慢速效果时，我确实必须颠倒语句的顺序。有趣的！

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <title>Test</title>
  <style type="text/css">
    #togglediv { padding: 5px; background-color: yellow; }
    #commentdiv { padding: 5px; background-color: #CCC; height: 100px; }
  </style>
</head>
<body>
  <div id="togglediv">Hide</div>
  <div id="commentdiv">thanks for answer. but i have tried this code, it was okay. i want to use toggle("slow") effect. this effect is runing firefox, but not i.e. is it a bug?</div>
  <script type="text/javascript" src="jquery-1.3.1.js"></script>
  <script type="text/javascript">
  $(function() {
    $("#togglediv").click(function() {
      $("#togglediv").text($("#commentdiv").is(":hidden") ? "Hide" : "Show");
      $("#commentdiv").toggle('slow');
    });
  });
  </script>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-04T22:50:58.737

你错过了一个结束 }

尝试

```
 $(document).ready(function(){
             $("#togglediv").click(function(){
                if($("#commentdiv").is(":visible")){
                $("#commentdiv").hide("slow"); $("#togglediv").text("show");
                }
                else{
                $("#commentdiv").show("slow"); $("#togglediv").text("hide");
                }
            }
        }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-12-02T18:04:36.047

我注意到一些有趣的事情，我认为上面的 cletus 已经提到了，如果你将“显示”行的顺序与“文本”行切换 - 它似乎开始工作了。我对此没有任何解释；很高兴知道幕后发生了什么。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2011-02-28T06:44:22.753

```
if(document.getElementById(ThisObj).style.display == 'none')
{
    document.getElementById(ThisObj).style.display = 'block';
}
else
{
    document.getElementById(ThisObj).style.display = 'none';
} 
```

有用：）

# php - mysql 'max_user_connections' 的更友好的错误消息

> ID：513747
> 
> 赞同：1
> 
> 时间：2009-02-04T22:47:44.140
> 
> 标签：php, mysql

我有一个网站是 MySQL/PHP。有时，我无法连接，因为

```
Warning: mysql_connect() [function.mysql-connect]:
User foo has already more than 'max_user_connections' active connections in /home/foo/public_html/utilities.php 
```

我使用折扣网络托管服务，并不能真正阻止它偶尔发生。（至少我认为我做不到。）我怎样才能给用户一个比这个神秘的信息更友好的信息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T22:52:39.280

如果您关闭显示错误（无论如何您可能应该在生产中这样做），那么如果连接尝试失败，您可以打印自己的错误。

```
ini_set('display_errors', false);
if (!$link = mysql_connect($host, $user, $pass)) {
    die('could not connect...');
} 
```

如果您无法更改 ini 设置，您可以使用 @ 抑制警告

```
if (!$link = @mysql_connect($host, $user, $pass)) {
    die('could not connect...');
} 
```

如果您抑制警告，您将无法看到连接失败的原因，这可能是您想要的，也可能不是您想要的。但是，您可以改为记录错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T22:52:15.927

[梨MDB2](http://pear.php.net/package/MDB2)

我会使用 Pear MD2B，更好的错误消息，代码和数据库之间的良好层。

还有很多好处。更改现有代码也很容易。

# sql-server - SSRS 多值参数 - 过滤器实现的适当层

> ID：513765
> 
> 赞同：3
> 
> 时间：2009-02-04T22:53:24.503
> 
> 标签：sql-server, sql-server-2008, reporting-services, ssrs-2008

在 sql 报告服务中使用多值参数时，使用数据集本身的过滤器实现列表过滤器是否更合适，数据区域控制或更改驱动数据集的实际查询？

SSRS 将支持任何场景，所以我问，除了为什么应该在一个级别而不是另一个级别上完成这一显而易见的事情之外，还有其他原因吗？

对我来说，修改查询本身并要求 RDBMS 处理过滤将是最有效的，但对于 SSRS 数据处理扩展如何处理这种情况，我可能遗漏了一些东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T14:00:55.027

你是对的。方法是将参数传递给数据库引擎。

Reporting Services 只能用于呈现内容。您需要传回客户端 Web 浏览器的数据越少，报告的呈现速度就越快。

您可能会发现我对有关使用多值参数的类似帖子的回答。

[在 Reporting Services 中为单个参数传递多个值](https://stackoverflow.com/questions/512105/passing-multiple-values-for-a-single-parmeter-in-reporting-services/512300#512300)

希望这会有所帮助，但请随时提出您可能有的任何其他问题。

干杯，约翰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-20T19:09:37.593

使用表值 UDF 是一种很好的方法，但仍然存在一个问题 - 如果在许多查询位置调用此函数，甚至在内部选择内部，可能会出现性能问题。您可以使用表变量（或临时表 ether）解决此问题：

```
DECLARE @Param (Value INT)
INSERT INTO @Param (Value) 
SELECT Param FROM dbo.fn_MVParam(@sParameterString,',')
...
where someColumn IN(SELECT Value FROM @Param) 
```

所以函数只会被调用一次。

另外，如果您不使用存储过程，而是使用嵌入式 SQL 查询，则可以将 MVP 放入查询中： ... where someColumn IN(@Param) ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-25T08:25:32.220

使用 RDBMS 进行主过滤

SSRS 为数据驱动显示和/或动态显示提供过滤。特别适用于子报告等

# vb.net - 在不运行的情况下安装 ClickOnce

> ID：513768
> 
> 赞同：10
> 
> 时间：2009-02-04T22:53:54.970
> 
> 标签：vb.net, deployment, clickonce

安装 ClickOnce 应用程序时，程序会在安装后运行。*不*运行就可以安装吗？

我知道我可以使用设置和部署项目并创建安装程序，但我更喜欢使用 ClickOnce。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T23:14:07.287

我猜你可以伪造它。引入一个“IsInstalled”布尔属性，默认为 false。然后在 Program.cs 中，将 Main() 方法更改为如下所示：

```
[STAThread]
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);

    if (!Properties.Settings.Default.IsInstalled)
    {
        Properties.Settings.Default.IsInstalled = true;
        Properties.Settings.Default.Save();

        MessageBox.Show("Install Complete");
        return;
    }

    Application.Run(new Form1());
} 
```

因此，现在当应用程序首次安装时，它会检查该属性并向用户显示一条消息，然后退出。

如果您想变得棘手，那么您可以查看解析部署的激活 URI 并具有一个 URI 参数，该参数指定程序是在首次安装时运行还是静默关闭。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-03-02T10:29:28.417

您可以通过在[Mage](http://msdn.microsoft.com/en-us/library/xhctdw55.aspx)中编辑应用程序清单来做到这一点。有一个复选框可以在安装后停止应用程序运行。

如果您不习惯手动或使用 Mage 编辑清单，那么您可以使用内置部署类来检查这是否是应用程序第一次运行。

```
using System.Deployment.Application

[STAThread]
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);

    if (ApplicationDeployment.CurrentDeployment.IsFirstRun)
    {
        MessageBox.Show("Install Complete");
        return;
    }

    Application.Run(new Form1());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-02T21:12:26.670

在尝试了所有建议的解决方案但仍然遇到相同的问题后，我摆弄了一段时间，并将几个解决方案组合成一个真正**有效**的解决方案。

仅设置“isInstalled”属性的问题是升级后会保留该值，因此每次安装新版本时，它都会再次运行应用程序。但是使用应用程序清单文件和 Mage 只是为了解决这个小问题，工作量太大而且太复杂。

所以我所做的是获取应用程序运行版本的当前构建#，将其保存到一个属性中，然后每次都根据运行版本检查该属性。这是有效的，因为每次发布都会增加版本号。

1) 更改您的程序集版本以在 AssemblyInfo.cs 中使用通配符：

`[assembly: AssemblyVersion("1.0.*")]`

2) 如果在构建时引发“确定性”错误，请打开您的 .csproj 文件并在 PropertyGroup 部分中将确定性设置为**false**

`<Deterministic>false</Deterministic>`

3）添加这个防呆功能来获取正在运行的汇编版本：

```
private Version GetRunningVersion()
{
    try
    {
        return System.Deployment.Application.ApplicationDeployment.CurrentDeployment.CurrentVersion;
    }
    catch
    {
        return System.Reflection.Assembly.GetExecutingAssembly().GetName().Version;
    }
} 
```

4) 在项目的属性中，打开设置选项卡，并添加一个名为**lastVersion** (String, User) 的设置。将值留空。

5) 添加此属性以用于确定这是否是应用程序安装后第一次运行。

```
private bool isFirstRun
{
    get { return Properties.Settings.Default.lastVersion != GetRunningVersion().ToString(); }
} 
```

6）然后在您的代码中，在检查 isFirstRun*后添加：*

```
if (isFirstRun)
{
    Properties.Settings.Default.lastVersion = GetRunningVersion().ToString();
    Properties.Settings.Default.Save();
} 
```

# java - Flex/LCDS 服务器到数据源分页

> ID：513774
> 
> 赞同：39
> 
> 时间：2009-02-04T22:54:33.627
> 
> 标签：java, apache-flex, dataservice, lcds

我正在尝试将服务器设置为数据源分页服务。我已经设置好所有东西，以便调用我的汇编程序并返回值，但我没有得到“分页”调用。

具体来说：

```
public Collection fill(List fillArgs, int begin, int rows) 
```

总是用`begin == -1`and调用`rows == -1`，而不是获取真正的值来翻页。此外：

```
public boolean useFillPage(List fillParameters) 
```

永远不会被调用（我的实现总是为所有参数返回 true）。看起来它从未被调用，因为 JavaAdapter 没有从 Flex 客户端接收 pageSize 标头。

这是我的目标配置：

```
<destination id="invoiceListDataService">
  <adapter ref="java-dao" />
  <properties>
    <scope>session</scope>
    <source>com.williams.finance.invoice.dao.InvoiceReviewListAssembler</source>
    <network>
      <paging enabled="true" pageSize="100" />
    </network>
    <metadata>
      <identity property="invoiceNumber"/>
    </metadata>
  </properties>
</destination> 
```

还有我调用数据服务的 Flex 代码：

```
myDataService = new DataService("invoiceListDataService");
myDataService.autoSyncEnabled=false;
myDataService.fill(invoiceReviewListModel.invoiceList, params); 
```

我在这里错过了什么吗？任何想法从哪里开始寻找？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2011-08-13T14:20:27.720

首先，您的适配器定义是什么？尝试这个：

```
<adapters>
    <adapter-definition class="flex.data.adapters.JavaAdapter" 
        id="java-dao"></adapter-definition>
</adapters> 
```

其次，将**custom="true"**属性添加到您的**分页**属性。

```
<paging enabled="true" pageSize="100" custom="true"/> 
```

第三，可能将您的**范围**更改为**应用程序**

第四，在您的目标定义中，添加 adapter="java-dao" 而不是引用它。

```
<destination adapter="java-dao"  id="invoiceListDataService"> 
```

第五，确保您重写了必要的方法（useFillPage、Collection fill 等）

```
@Override
public boolean useFillPage(List fillParameters)
{
    // enabling paged-fill for all fills
    return true;
} 
```

有关类似问题的一些有用回复，请参阅此线程：http: [//www.mail-archive.com/flexcoders@yahoogroups.com/msg111746.html](http://www.mail-archive.com/flexcoders@yahoogroups.com/msg111746.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2011-08-26T06:50:53.020

您的目标配置看起来很完整。

仔细检查您的汇编程序是否扩展了 AbstractAssembler：

```
public class InvoiceReviewListAssembler extends AbstractAssembler 
```

并且您至少覆盖以下内容：

```
@Override
public int count(List arg0) {
    return -1; // or return the collection length.
}

@Override
public boolean useFillPage(List fillParameters) {       
    return true;
}

@Override
public Collection fill(List fillParameters,
                       PropertySpecifier ps,
                       int startIndex,
                       int numItems) {
   // TODO
} 
```

# asp.net - 为什么 ASP.NET 为域和子域生成相同的 cookie 密钥？

> ID：513782
> 
> 赞同：2
> 
> 时间：2009-02-04T22:58:01.250
> 
> 标签：asp.net, authentication, cookies, forms-authentication, subdomain

### 漏洞：

我有一个 ASP.NET Web 应用程序，它偶尔会为“.www.mydomain.com”和“www.mydomain.com”设置相同的 cookie 键。我试图弄清楚 ASP.NET 设置的默认 cookie 域，以及我如何不小心将站点编码为有时会在前面加上“。” 到 cookie 域。

当 2 个 cookie 具有相同的密钥并从浏览器向上发送时，ASP.NET Web 应用程序无法区分两者，因为域值未在标头中发送。（见我[之前的问题](https://stackoverflow.com/questions/481230/why-are-request-cookie-poperties-null-or-incorrect-on-asp-net-postback)）

### 证据：

我已经在 Web 服务器上启用了 W3C 日志记录，并验证了这两个 cookie 都是从客户端发送的。这是日志文件中的一个示例（为简洁起见，已配对）。

```
80 GET /default.aspx page= 200 0 0 - - - - - +MyCookie2=sessionID=559ddb9b-0f38-4878-bb07-834c2ca9caae;+MyCookie2=sessionID=e13d83cd-eac2-46fc-b39d-01826b91cb2c; 
```

### 可能的因素：

我正在使用启用子域的表单身份验证。

这是我的 web.config 设置：

```
<authentication mode="Forms">
<forms domain="mydomain.com" enableCrossAppRedirects="true" loginUrl="/login" requireSSL="false" timeout="5259600" />
        </authentication> 
```

以下是设置自定义 cookie 的示例：

```
HttpCookie cookie1 = new HttpCookie("MyCookie1") {HttpOnly = true, Expires = expiration};
logosCookie["email"] = user.Email;
logosCookie["keycode"] = user.PasswordHash;
logosCookie["version"] = currentCookieVersion;
context.Response.Cookies.Remove("cookie1");
context.Response.Cookies.Add(cookie1);

// set FormsAuth cookie manually so we can add the UserId to the ticket UserData
var userData = "UserId=" + user.UserID;
FormsAuthenticationTicket ticket = new FormsAuthenticationTicket(2, user.Email, now, expiration, true, userData);

string str = FormsAuthentication.Encrypt(ticket);
HttpCookie cookie = new HttpCookie(FormsAuthentication.FormsCookieName, str)
    {
        HttpOnly = true,
        Path = FormsAuthentication.FormsCookiePath,
        Secure = FormsAuthentication.RequireSSL,
        Expires = ticket.Expiration
    };
if (FormsAuthentication.CookieDomain != null)
{
    cookie.Domain = FormsAuthentication.CookieDomain;
}

context.Response.Cookies.Remove(FormsAuthentication.FormsCookieName);
context.Response.Cookies.Add(cookie1 ); 
```

这是另一个设置 cookie 的示例。

```
var cookie2 = new HttpCookie("MyCookie2");
cookie2[CookieSessionIdKey] = Guid.NewGuid();
cookie2.Expires = DateTime.Now.AddYears(10);
HttpContext.Current.Response.Cookies.Set(cookie2); 
```

### 不良分辨率：

我可以手动强制 cookie 域为特定值，但我想避免明确声明域。我更喜欢使用默认的框架行为并更改我对 ASP.NET 的使用以避免在“。”之前添加。到自定义 cookie 的 cookie 域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-25T01:43:27.317

当服务器在响应中没有明确设置域时，浏览器可以自由分配 cookie 域值。当响应中没有提供域时，我还没有弄清楚究竟是什么条件导致浏览器在 cookie 域上设置“www.mydomain.com”与“.mydomain.com”，但它确实发生了。

我觉得这是将 .ASPAUTH cookie 域值显式设置为“.mydomain.com”以启用跨子域身份验证的结果，同时将其他自定义 cookie 域设置为默认值（空字符串或“”）。

我将采用不受欢迎的解决方案，并为所有自定义 cookie 明确设置 cookie 域以避免浏览器怪癖。

# c# - 我如何知道 WindowsFormsHost 何时在 WPF 中调整大小？

> ID：513783
> 
> 赞同：5
> 
> 时间：2009-02-04T22:58:18.860
> 
> 标签：c#, .net, wpf, xaml

我在 WindowsFormsHost 中有一个 Windows 窗体映射，我需要它来调整窗口大小。

我只是不确定要听什么事件来做到这一点。我需要地图仅在鼠标启动后才调整大小，否则它会滞后，并在您非常缓慢地调整窗口大小时尝试绘制自己一百万次。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-05T00:43:22.970

等待计时器是一个非常非常糟糕的主意，很简单，它是一种启发式方法，您在猜测调整大小操作何时完成。

更好的想法是从方法派生一个类[`WindowsFormsHost`](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.windowsformshost.aspx)并覆盖该[`WndProc`](http://msdn.microsoft.com/en-us/library/system.windows.forms.integration.windowsformshost.wndproc.aspx)方法，处理[`WM_SIZE`](http://msdn.microsoft.com/en-us/library/ms632646%28VS.85%29.aspx)消息。这是在大小操作完成时发送到窗口的消息（与[`WM_SIZING`](http://msdn.microsoft.com/en-us/library/ms632647%28VS.85%29.aspx)在此过程中发送的消息相反）。

您还可以处理`WM_SIZING`消息，而不是在收到此消息时调用基本实现`WndProc`，以防止消息被处理并让地图一直重绘自身。

`WndProc`类上的方法的文档`Control`显示了如何覆盖`WndProc`方法：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.control.wndproc(VS.71).aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.wndproc(VS.71).aspx)

尽管它是针对不同的班级，但它是完全相同的校长。

此外，您将需要`WM_SIZING`和`WM_SIZE`常量的值，您可以在此处找到：

[http://www.pinvoke.net/default.aspx/Enums/WindowsMessages.html](http://www.pinvoke.net/default.aspx/Enums/WindowsMessages.html)

请注意，您不需要上面链接中的所有内容，只需要这两个值的声明：

```
/// <summary>
/// The WM_SIZING message is sent to a window that
/// the user is resizing.  By processing this message,
/// an application can monitor the size and position
/// of the drag rectangle and, if needed, change its
/// size or position. 
/// </summary>
const int WM_SIZING = 0x0214;

/// <summary>
/// The WM_SIZE message is sent to a window after its
/// size has changed.
/// </summary>
const int WM_SIZE = 0x0005; 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2010-03-06T23:08:46.017

根据这里的建议：

[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/8453ab09-ce0e-4e14-b30b-3244b51c13c4](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/8453ab09-ce0e-4e14-b30b-3244b51c13c4)

他们建议使用计时器，并且每次触发 SizeChanged 事件时，您只需重新启动计时器。这样，计时器就不会一直调用“Tick”来检查尺寸是否发生了变化——每次尺寸变化时，计时器只会关闭一次。也许不太理想，但我不必处理任何低级 Windows 的东西。这种方法也适用于任何 wpf 用户控件，而不仅仅是 wpf 窗口。

```
public MyUserControl()
{
    _resizeTimer.Tick += _resizeTimer_Tick;
}

DispatcherTimer _resizeTimer = new DispatcherTimer { Interval = new TimeSpan(0, 0, 0, 0, 1500), IsEnabled = false };

private void UserControl_SizeChanged(object sender, SizeChangedEventArgs e)
{
    _resizeTimer.IsEnabled = true;
    _resizeTimer.Stop();
    _resizeTimer.Start();
}

int tickCount = 0;
void _resizeTimer_Tick(object sender, EventArgs e)
{
    _resizeTimer.IsEnabled = false;
    //you can get rid of this, it just helps you see that this event isn't getting fired all the time
    Console.WriteLine("TICK" + tickCount++);

    //Do important one-time resizing work here
    //...
} 
```

# assembly - 如果小于，哪个是正确的分支指令

> ID：513785
> 
> 赞同：2
> 
> 时间：2009-02-04T22:59:17.737
> 
> 标签：assembly, branch, 6502

我昨天写了一个答案： [你见过或做过的最酷的黑客是什么？](https://stackoverflow.com/questions/192479/whats-the-coolest-hack-youve-seen-or-done) 而且我非常努力地记住我的 6502 组件，我一生都无法记住如果小于...

```
 :1
  lda $C010
  cmp #$80
  bcc :1  ; branch if less than? I forget how to do that.
  lda $C000
  jsr $FDF0   ;output the accumulator value to the screen 
```

有人知道指令是什么吗？BNE 和 BEQ 相等，BCC 用于进位，CMP 基本上是 SBC，会影响进位，但我不确定它是否适用于这种情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-09-22T07:50:01.550

**如果小于 ，则 BCC 是分支**；BCS 大于等于分支。[这里](http://www.6502.org/tutorials/compare_beyond.html)有一个很好的教程。

然而 stu 的代码可以在没有 CMP 的情况下更简洁地编写：

```
BIT $C010     ;clear the keyboard strobe
:1
LDA $C000     ;check for a keypress
BPL :1        ;taken if no keypress
JSR $FDFO     ;print the key 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T23:20:11.390

第一次谷歌点击：[http ://en.wikibooks.org/wiki/6502_Assembly#Branch](http://en.wikibooks.org/wiki/6502_Assembly#Branch)

# java - 如何配置 JBOSS 以在 Web 应用程序中使用 xml 库？

> ID：513786
> 
> 赞同：0
> 
> 时间：2009-02-04T22:59:22.883
> 
> 标签：java, jboss

JBOSS 正在抛出一个：

```
java.lang.NoSuchMethodError: org.w3c.dom.Document.getDocumentURI()Ljava/lang/String;

```

加载 wsdl 时出错。我可以将它配置为更喜欢我的 WAR 中的库而不是系统或应用服务器库吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T00:02:11.073

应用程序服务器*应该*已经在使用任何 JAR`WEB-INF/lib`以及系统和应用程序服务器库路径 - 标准方法是用于`WEB-INF/lib`将类加载委托给应用程序服务器库的 ClassLoader，它将类加载委托给服务器库，并且只有当父类加载器找不到该类时，它才会尝试加载它自己的类。

换句话说，如果你把同一个类`WEB-INF/lib`和应用服务器的 lib 放在一起，后面的 JAR 就会一直被使用。这意味着可以通过在应用服务器的库和应用服务器的库中使用具有相同名称但不同版本的类来创建冲突`WEB-INF/lib`- 您确定这不是导致您的问题的原因吗？你能解决冲突吗？

一些应用服务器（不确定 JBoss，但我知道 WebSphere 允许）允许您配置类加载器，以便首先检查子加载器（子优先与父优先），但这种类型的配置可能会导致其他问题。

# python - 使用 ZipFile 模块从 zipfile 中删除文件

> ID：513788
> 
> 赞同：43
> 
> 时间：2009-02-04T23:00:26.110
> 
> 标签：python, zip, delete-file

我想从 zipfile 中删除文件的唯一方法是创建一个临时 zipfile 而不删除要删除的文件，然后将其重命名为原始文件名。

在 python 2.4 中，ZipInfo 类有一个属性`file_offset`，因此可以创建第二个 zip 文件并将数据复制到其他文件而无需解压缩/重新压缩。

这`file_offset`在 python 2.6 中是缺失的，那么除了通过解压缩每个文件然后重新压缩它来创建另一个 zipfile 之外，还有其他选择吗？

是否有直接删除zipfile中文件的方法，我搜索并没有找到任何东西。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2009-02-04T23:31:37.063

以下片段对我有用（从 Zip 存档中删除所有 *.exe 文件）：

```
zin = zipfile.ZipFile ('archive.zip', 'r')
zout = zipfile.ZipFile ('archve_new.zip', 'w')
for item in zin.infolist():
    buffer = zin.read(item.filename)
    if (item.filename[-4:] != '.exe'):
        zout.writestr(item, buffer)
zout.close()
zin.close() 
```

如果您将所有内容都读入内存，则可以消除对第二个文件的需要。但是，这个片段重新压缩了所有内容。

经过仔细检查，这`ZipInfo.header_offset`是从文件开始的偏移量。名称具有误导性，但主 Zip 标头实际上存储在文件末尾。我的十六进制编辑器证实了这一点。

因此，您将遇到的问题如下：您还需要删除主标题中的目录条目，否则它将指向一个不再存在的文件。如果您也保留要删除的文件的本地标头，则保持主标头完整可能会起作用，但我不确定。你是怎么用旧模块做的？

在不修改主标题的情况下，打开它时出现错误“zipfile 中缺少 X 字节”。[这](http://www.pkware.com/documents/casestudies/APPNOTE.TXT)可能会帮助您了解如何修改主标题。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-08-17T16:54:19.287

不是很优雅，但这就是我的做法：

```
import subprocess
import zipfile

z = zipfile.ZipFile(zip_filename)

files_to_del = filter( lambda f: f.endswith('exe'), z.namelist()]

cmd=['zip', '-d', zip_filename] + files_to_del
subprocess.check_call(cmd)

# reload the modified archive
z = zipfile.ZipFile(zip_filename) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-01-01T10:33:50.430

`delete_from_zip_file`¹ 中的例程[`ruamel.std.zipfile`](https://pypi.python.org/pypi?:action=display&name=ruamel.std.zipfile)允许您根据 ZIP 中的完整路径或基于 ( `re`) 模式删除文件。例如，您可以删除所有使用的`.exe`文件`test.zip`

```
from ruamel.std.zipfile import delete_from_zip_file

delete_from_zip_file('test.zip', pattern='.*.exe') 
```

（请注意 前的点`*`）。

这与 mdm 的解决方案类似（包括需要重新压缩），但在内存中重新创建 ZIP 文件（使用 class [`InMemZipFile()`](https://bitbucket.org/ruamel/std.zipfile/src/faa2c8fc9e0072f57857078059ded42192af5435/__init__.py?at=default&fileviewer=file-view-default#__init__.py-57)），在完全读取后覆盖旧文件。

* * *

¹[免责声明：我是该软件包的作者。]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-09-09T09:19:26.053

基于[Elias Zamaria](https://stackoverflow.com/users/28324/elias-zamaria)对该问题的评论。

通读[https://bugs.python.org/issue6818](https://bugs.python.org/issue6818)后，我想提供有关它的更新。

今天，解决方案已经存在，尽管由于缺少作者的贡献者协议而没有被 Python 批准。

不过，您可以从[https://github.com/python/cpython/blob/659eb048cc9cac73c46349eb29845bc5cd630f09/Lib/zipfile.py](https://github.com/python/cpython/blob/659eb048cc9cac73c46349eb29845bc5cd630f09/Lib/zipfile.py)获取代码并从中创建一个单独的文件。之后，只需从您的项目中引用它，而不是内置的 python 库：`import myproject.zipfile as zipfile`.

用法：

```
with zipfile.ZipFile(f"archive.zip", "a") as z:
    z.remove(f"firstfile.txt") 
```

我相信它将包含在未来的 python 版本中。对我来说，它就像给定用例的魅力。

# php - AJAX - 执行的 shell 命令的进度条

> ID：513793
> 
> 赞同：1
> 
> 时间：2009-02-04T23:01:36.017
> 
> 标签：php, ajax, linux, shell, progress-bar

我在我的网站上使用 AJAX，我想向用户显示我的服务器正在下载的文件的进度。

下载是由**向 shell 输出百分比**的脚本完成的。我想将此信息传递回使用 AJAX 的用户。我怎样才能做到这一点？

感谢您的任何帮助和指导。

我希望您的解决方案不涉及写入文本文件并从文本文件中检索该百分比！我想太多了。

## 编辑 - 更多信息

它是一个 Linux Shell 命令 - Fedora Core 10。

目前这是 shell 输出的样子：

```
[download]   9.9% of 10.09M at 10.62M/s ETA 00:00 
```

百分比发生了变化，我希望捕获它并在它发生变化时将其发送回用户。

为了执行这个，我使用了 PHP 的 exec() 函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T23:20:02.750

[您可以使用popen](http://uk3.php.net/popen)代替 exec 。这将为您提供一个与 fread 一起使用的句柄，以获取您的命令在发生时生成的输出。

您需要解析它对百分比指示器所做的更新。一旦你有了这些数据，有几种方法可以把它送到客户端，例如使用“ [comet](http://en.wikipedia.org/wiki/Comet_(programming)) ”风格的推送，或者让 Ajax 请求轮询更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T23:35:03.453

我还没有尝试过，但我认为这种方法会奏效。

你需要三件：

1.  让 shell 脚本将其流输出到连接到端口的 netcat
2.  有一个 php 脚本侦听来自所述端口的传入数据的流，更新 memcache 或某些数据库中的记录并完成百分比。
3.  让您的 Web 脚本定期向服务器发出 ajax 调用，该服务器在您的后端存储中检查此值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-06-17T00:57:34.770

我正在研究类似的问题。我必须解析我的视频转换 shell 脚本的输出。我使用`popen`并解析返回的输出`resource`。起初我使用`fgets`但没有将更新的值识别为新行。所以我创建了一个简单的函数来接受一个可选的`$arg_delimiter`，这样你就可以检查其他返回类型，比如`chr(13)`回车。示例代码稍作修改，因此未经测试，因为在我的情况下，这些函数是我的解析器对象上的方法。

```
function get_line ($arg_handle, $arg_delimiter = NULL)
{
  $delimiter = (NULL !== $arg_delimiter) ? $arg_delimiter : chr(10);
  $result    = array();

  while ( ! feof($arg_handle))
  {
    $currentCharacter = fgetc($arg_handle);

    if ($delimiter === $currentCharacter)
    {
      return implode('', $result);
    }

    $result[] = $currentCharacter;
  }

  return implode('', $result);
} 
```

我只是循环这样的结果`popen()` `resource`：

```
 $command = '/usr/bin/yourcommand';
  $handle  = popen($command . ' 2>&1', 'r');

  while ( ! feof($handle))
  {
    $line = get_line($handle, chr(13));

    preg_match($yourParserRegex, $line, $data);

    if (count($data) > 0)
    {
      printf("<script type='text/javascript'>\n  //<![CDATA[\n    window.alert('Result: %s');\n  // ]]>\n</script>"
            ,$data[1]
            );
      flush();
    }

  } 
```

现在你需要做的就是弄清楚彗星的东西。

# c# - Visual Studio WinForms 设计器不实例化对象

> ID：513798
> 
> 赞同：3
> 
> 时间：2009-02-04T23:02:55.233
> 
> 标签：c#, winforms, designer, instantiation

我创建了一个派生自 System.Windows.Forms.ContextMenuStrip 类的类，而不是作为用户控件，只是一个带有构造函数和一个事件处理程序的普通 .cs 类。

当我将这个类从工具箱拖到设计器上时，它会为它创建一个私有成员和几个属性，但不会实例化一个对象。

因此，在运行时我得到“对象引用未设置为对象的实例。”，因为设计器从不生成该行：

this.searchGridContextMenu1 = new SearchGridContextMenu();

内部初始化组件。

它曾经生成这条线，事实上，我一直把它从我的 Vault 存储库放回去，但设计师只是再次“吃掉它”。

更新：我现在尝试使用同一个类创建一个用户控件，但这样做也有同样的问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2009-06-03T20:25:27.623

我在另一个问题上交叉发布了此评论，但由于这与此处相关，因此再次出现。

当用户控件无法加载到 Visual Studio 设计器中时，您需要执行此操作。这些指令适用于 vb.net 项目，但 c# 应该类似。此外，在执行此操作之前，请关闭所有打开的窗口（或至少关闭您正在处理的控件的源文件和设计器文件。）

最后一件事。您应该做的第一件事是确保重新启动 Visual Studio 不能解决问题。如果没有，您可以尝试以下步骤。这些说明假定错误的用户控件位于 Visual Studio 的控件库项目中。如果不是，您应该能够稍微调整方向以使其工作，但当控件位于其自己的项目中时，它会容易得多。

请执行下列操作：

1.  使控件库成为您的启动项目。
2.  打开控件库项目的属性，然后单击调试选项卡。
3.  在 Start Action 下单击 Start external program 选项并浏览到 Visual Studio 可执行文件。

注意：这意味着当您运行解决方案时，它将启动另一个 Visual Studio 实例，而不是实际运行您的解决方案。Visual Studion 的第一个实例 (INSTANCE_1) 将在您运行时“托管”第二个 Visual Studio 实例 (INSTANCE_2)。

4.  运行您的解决方案。INSTANCE_2 将加载。
5.  切换回 INSTANCE_1。
6.  在 INSTANCE_1 中按 CTRL-ALT-E。这将打开例外对话框。选中 Common Language Runtime Exceptions 旁边的 THROWN 列复选框。

注意：这将确保 INSTANCE_1 将在任何运行时错误时中断，即使它在 try 块中被击中。

7.  切换到 INSTANCE_2。在解决方案资源管理器中双击打开错误用户控件。

您应该会发现 INSTANCE_1 OF Visual Studio 应该在导致设计器不加载控件的代码行处停止。修复代码（这通常意味着在引用对象属性之前测试 IsNot Nothing ......但可能意味着其他事情。）

此外，有时我发现控件将在 INSTANCE_2 中加载，而不是在 INSTANCE_1 中出现错误。在这种情况下，只需停止调试...关闭 INSTANCE_2。保存/重新启动 INSTANCE_1，您的问题通常会消失。

教训是这样的。用户控件必须能够加载/引用所有对象及其成员，以便将其加载到设计器中。因此，对于将被放置到其他容器上的用户控件，我通常会设计事件来通知父控件，而不是尝试将对象推送到子控件中。

希望这有助于将来参考这个老问题。

赛斯

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2011-07-13T11:03:45.190

我没看错吗？Visual Studio 删除构造控件实例的行？

你的构造函数是公开的吗？在某些时候，我将构造函数的可访问性从公共更改为内部 - 努力做好，阻止讨厌的用户访问他们不应该访问的东西 - 但后来我遭受了与你描述的相同的影响，我一直不得不添加我的构造函数返回 InitializeComponent。

我花了几个月的时间才意识到我的错误……只是一直认为这是 Visual Studio 中的一个错误。改回public，没有问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T23:22:53.353

从控件继承是不够的。这是我必须实施以使其工作的最低要求：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WinForms
{
    class Foo : System.Windows.Forms.ContextMenuStrip
    {
        public Foo()
        {
            InitializeComponent();
        }

        protected override void OnPaint(PaintEventArgs pe)
        {
            base.OnPaint(pe);
        }

        /// <summary>
        /// Required designer variable.
        /// </summary>
        private System.ComponentModel.IContainer components = null;

        /// <summary>
        /// Clean up any resources being used.
        /// </summary>
        /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
        protected override void Dispose(bool disposing)
        {
            if (disposing && (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Component Designer generated code

        /// <summary>
        /// Required method for Designer support - do not modify 
        /// the contents of this method with the code editor.
        /// </summary>
        private void InitializeComponent()
        {
            components = new System.ComponentModel.Container();
        }

        #endregion
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2010-02-15T13:00:21.847

This problem occurs when InitializeComponent () crosses with base and inherited components. Solution is call the component's designer's method. Otherwise the base method will be called.

> ```
> public Form()
> {
>     this.InitializeComponent(); 
>     // base.InitializeComponent <-- default one is thisone
> } 
> ```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-29T09:44:36.090

将我的无参数构造函数从内部更改为公共已经解决了这个问题

# java - 什么工具可以为动态创建的查询建议索引和覆盖索引？

> ID：513799
> 
> 赞同：2
> 
> 时间：2009-02-04T23:02:57.260
> 
> 标签：java, mysql, dynamic, indexing

我们的 Web 应用程序基本上是动态生成表和关系。它还生成基本级别的索引。我们正在寻找能够建议索引的 MySQL 分析器。我们遇到了这两个分析器：

[MYSQL JET PROFILER](http://www.jetprofiler.com)：不会告诉使用什么索引或覆盖索引来完成这项工作。

[ROT](http://ritmark.com/)：不适用于实时数据库，基本上您必须在差异文件中提供查询和模式。

以上这些都不能完成这项工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2009-04-18T19:37:34.803

[QOT](http://ritmark.com)支持服务器端模式。查看最新的 Launchpad 版本。此外，它从不需要“差异”文件。您只需要提供普通的 SQL 脚本，例如 mysqldump 生成的脚本。现在支持两种方式（即脚本和实时连接）。

BR，弗拉基米尔

# javascript - 有没有办法从 FBJS 的画布访问 iframe 的窗口对象？（Facebook）

> ID：513800
> 
> 赞同：3
> 
> 时间：2009-02-04T23:03:46.447
> 
> 标签：javascript, facebook, fbml

从 facebook 画布，我需要能够访问 iframe 窗口。通常你可以用window.frames 来做这件事，但FJBS 似乎不允许访问window 对象。

有没有人想出如何访问窗口对象？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2009-02-05T08:31:26.163

你可以试试这个。让我知道它是如何工作的。

```
var myIframe = document.getElementById('myIframeId');

// could retrieve window or document depending on the browser
// (if FBJS allows it!?)
var myIframeWin = myIframe.contentWindow || myIframe.contentDocument;

if( !myIframeWin.document ) { //we've found the document
    myIframeWin = myIframeWin.getParentNode(); //FBJS version of parentNode
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2010-02-25T11:16:34.317

**[浏览器根据同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)**的原则处理域安全

**[以及跨域通信](http://softwareas.com/cross-domain-communication-with-iframes)**的规律

[您还将在此博客文章http://piecesofrakesh.blogspot.com/2007/11/how-to-build-readwrite-javascript-api.html](http://piecesofrakesh.blogspot.com/2007/11/how-to-build-readwrite-javascript-api.html)上找到有关创建读写 JS API 的有趣读物

# php - PHP XMLReader 获取父节点？

> ID：513802
> 
> 赞同：3
> 
> 时间：2009-02-04T23:03:57.413
> 
> 标签：php, parsing, xmlreader

使用 XMLReader 方法解析 XML 文件时，如何获取元素的父节点？

```
$xml = new XMLReader();
$xml->XML($xmlString);
while($xml->read())
{

$xml->localName; // gives tag name
$xml->value; // gives tag value

// how do I access the parent of this element 
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2009-02-05T04:00:28.673

简短版：你没有，至少不是直接的。程序员可以使用 XMLReader 将上下文编码到他们的解析算法中。

长版：PHP 的 XMLReader 是所谓的*拉解析器*。拉解析器与基于树/dom 的解析器的不同之处在于它们可以处理文本流。换句话说，他们可以在获得整个文档之前开始解析文档。这与 SimpleXML 或 DOMDocument 等基于树的/DOM 解析器不同，后者需要将整个文档加载到内存中，然后才能执行任何操作。

优点是，如果您有一个 75MB 的 XML 文件，则不需要 75MB 的空闲 RAM 来处理它（就像使用基于树的解析器一样）。权衡是拉解析器永远不会有整个文档的上下文。唯一具有他们目前正在处理的任何节点的上下文。

另一种思考方式是基于树/dom 的解析器必须了解文档的每个部分，因为它不知道您要向它询问什么。但是，您和拉解析器做出了不同的安排。它会不断向您抛出节点，并由您自己处理它们的内容。

这是一些示例代码（希望）接近您所追求的。

```
$xml = new XMLReader(); 
$xml->open('example.xml');
$last_node_at_depth = array();
while($xml->read())
{               
    //stash the XML of the entire node in an array indexed by depth
    //you're probably better off stashing exactly what you need from
    $last_node_at_depth[$xml->depth] = $xml->readOuterXML();

    $xml->localName; // gives tag name
    $xml->value;     // gives tag value     

    //so, right now we're at depth n in the XML document.  depth n-1 
    //would be our parent node
    if ($xml->depth > 0) {
        //gives the fragment that starts with the parent node       
        $last_node_at_depth[($xml->depth-1)];   
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-06T08:00:42.663

我已经开始使用 XMLReader 的 expand() 函数。它给出了当前 xml 标签的 DOM 表示。我在父节点上使用了 expand()，它给了我父标签的 DOM 元素，然后使用通常的 DOMDocument() 解析方式提取了子值。

```
//usage
$xml = new XMLReader();
$xml = $xml->XML($xmlResponse);
while($xml->read())
{
$parent = $xml->expand();

$firstChildValue = $parent->getElementsByTagName('child')->item(0)->nodeValue;
} 
```

使用 expand 函数只会将 XML 的大部分内容加载到内存中，而不是将整个 XML 加载到内存中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T23:07:59.903

我想你想要：[XMLReader::moveToElement](http://ca.php.net/manual/en/xmlreader.movetoelement.php)

# python - 如何使用 gdata-python-client 分发脚本？

> ID：513806
> 
> 赞同：3
> 
> 时间：2009-02-04T23:06:11.950
> 
> 标签：python, gdata-api

我编写了几个使用 gdata API 的脚本，它们（显然）都有我的 API 密钥和纯文本的客户端 ID。我应该如何分发这些？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T23:16:32.663

将变量移动到单独的模块中，并用虚拟值替换您的值。确保捕获无效密钥并提供有关如何获取密钥以及放置密钥的说明。在您的代码中，您可以只从该模块导入值。

```
import gdata_api_key
print gdata_api_key.key_value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T23:18:05.607

如果我们假设您希望客户端使用他们自己的密钥，我建议将它们放在默认为（无效）哨兵值的配置文件中。

另一方面，如果您希望脚本使用您的密钥，那么您能做的最好的就是混淆它。毕竟，如果您的程序可以读取它，那么攻击者（使用调试器）也可以读取它。

# sql - 数组是否有 SQL 参数绑定？

> ID：513818
> 
> 赞同：21
> 
> 时间：2009-02-04T23:12:16.463
> 
> 标签：sql, perl, arrays, binding, parameters

是否有标准方法在 SQL 查询中绑定数组（标量）？我想绑定到一个`IN`子句中，如下所示：

```
SELECT * FROM junk WHERE junk.id IN (?); 
```

我碰巧使用`Perl::DBI`which 将参数强制转换为标量，所以我最终得到了无用的查询，例如：

```
SELECT * FROM junk WHERE junk.id IN ('ARRAY(0xdeadbeef)'); 
```

**澄清：**我把查询放在自己的`.sql`文件中，所以字符串已经形成。在答案提到动态创建查询字符串的地方，我可能会进行搜索和替换。

**编辑：**这个问题是[Parameterizing a SQL IN 子句的重复？](https://stackoverflow.com/questions/337704/parameterizing-a-sql-in-clause). 我最初认为它应该这样关闭，但它似乎正在积累一些好的 Perl 特定信息。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2009-02-05T11:44:15.787

如果您不喜欢那里的地图，可以使用“x”运算符：

```
my $params = join ', ' => ('?') x @foo;
my $sql    = "SELECT * FROM table WHERE id IN ($params)";
my $sth    = $dbh->prepare( $sql );
$sth->execute( @foo ); 
```

'?' 周围需要括号。因为这会强制“x”在列表上下文中。

阅读“perldoc perlop”并搜索“二进制“x”以获取更多信息（位于“乘法运算符”部分）。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2009-02-05T04:29:32.920

您指定“这是带有一个参数的查询的 SQL”——当您需要多个参数时，这将不起作用。当然，处理起来很痛苦。已经建议的另外两个变体：

1) 使用 DBI->quote 代替占位符。

```
my $sql = "select foo from bar where baz in ("
           . join(",", map { $dbh->quote($_) } @bazs)
           . ")";
my $data = $dbh->selectall_arrayref($sql); 
```

2）使用 ORM 为你做这种低级的事情。例如 DBIx::Class 或 Rose::DB::Object。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2009-02-05T00:53:00.720

我做类似的事情：

```
my $dbh = DBI->connect( ... );
my @vals= ( 1,2,3,4,5 );
my $sql = 'SELECT * FROM table WHERE id IN (' . join( ',', map { '?' } @vals ) . ')';
my $sth = $dbh->prepare( $sql );
$sth->execute( @vals ); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2009-02-05T20:17:28.153

还有另一种构建 SQL 的方法是使用类似[SQL::Abstract](http://search.cpan.org/dist/SQL-Abstract/) ....

```
use SQL::Abstract;
my $sql    = SQL::Abstract->new;
my $values = [ 1..3 ];
my $query  = $sql->select( 'table', '*', { id => { -in => $values } } );

say $query;   # => SELECT * FROM table WHERE ( id IN ( ?, ?, ? ) ) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2009-02-05T11:25:08.227

使用plain `DBI`，您必须自己构建SQL，如上所述。[DBIx::Simple](http://search.cpan.org/perldoc?DBIx::Simple)（一个包装器`DBI`）自动使用'??'为你做这件事 符号：

```
$db->query("select * from foo where bar in (??)", @values); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2009-02-04T23:22:25.320

在 python 中，我总是最终做了类似的事情：

```
query = 'select * from junk where junk.id in ('
for id in junkids:
  query = query + '?,'
query = query + ')'

cursor.execute(query, junkids) 
```

...它本质上是用一个“？”构建一个查询。对于列表的每个元素。

（如果那里也有其他参数，则需要确保在执行查询时正确排列）

[编辑以使非 python 人员更容易理解代码。有一个错误，查询将在最后一个 ? 之后有一个额外的逗号，我将保留它，因为修复它只会模糊总体思路]

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-02-05T12:57:49.243

我使用[DBIx::DWIW](http://search.cpan.org/dist/DBIx-DWIW/)。它包含一个名为 InList() 的函数。这将创建列表所需的 SQL 部分。但是，这仅在您将所有 SQL 都放在程序中而不是在单独的文件中时才有效。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-05-31T13:08:45.430

采用

```
SELECT * FROM junk WHERE junk.id = ANY (?); 
```

反而

# winapi - 是否有任何安全的方法可以在单例 COM 对象中保留来自另一个 dll 的 COM 对象的成员指针？

> ID：513822
> 
> 赞同：0
> 
> 时间：2009-02-04T23:13:33.403
> 
> 标签：winapi, dll, com, singleton

我最近遇到了一个`COM`使用**单例类工厂**的对象的问题，该对象的成员是指向在与单例对象不同的 DLL 中实现的其他 COM 对象的指针。

这些其他 COM 对象是由单例对象创建的，这是对它们的唯一引用。

由于单例对象在其模块被卸载之前永远不会被销毁，似乎正在发生的事情是有时在那个点上，实现其他 COM 对象（单例的成员）的 DLL 已经被卸载，在这种情况下会有当单例在其析构函数中释放对这些对象的引用时发生崩溃。

实现其他 COM 对象的 DLL 知道存在对对象的引用并`S_FALSE`从其`DllCanUnloadNow`方法返回。

但是，这似乎并不能阻止 DLL 总是被卸载。

是否有任何安全的方法可以在单例 COM 对象中保留来自另一个 dll 的 COM 对象的成员指针？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-04T23:30:33.850

您很可能正遭受“错误”的模块卸载顺序的困扰。请参阅[为什么以“错误”的顺序卸载 DLL？](http://blogs.msdn.com/oldnewthing/archive/2005/05/23/421024.aspx)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T23:23:51.180

如果您有一个指向 COM 对象的指针（也称为“保持引用”），那么该 COM 对象在您释放它之前不会消失。

如果尚未释放 COM 对象，则不应卸载实现其代码的 DLL：请参阅[DllCanUnloadNow](http://msdn.microsoft.com/en-us/library/ms690368(VS.85).aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T23:51:01.050

当单例获取 COM 接口的实现时，应该在获取到的指针上的实现上调用 IUnknown::AddRef。

当您访问包含这些引用的单例字段时也是如此。获得引用后，应调用 IUnknown::AddRef，然后在完成后调用 IUnknown::Release。

这样，如果单例被回收并且它持有的所有指针都被释放，如果您在另一段代码中持有其中一个，您将不会丢失实例，因为您增加了引用计数。

您还应该考虑使用[CComPtr 模板](http://msdn.microsoft.com/en-us/library/ezzw7k98(vs.80).aspx)来帮助管理引用计数：

[http://msdn.microsoft.com/en-us/library/ezzw7k98(vs.80).aspx](http://msdn.microsoft.com/en-us/library/ezzw7k98(vs.80).aspx)

您可能还想查看引用计数的规则，您*必须*遵守这些规则：

[http://msdn.microsoft.com/en-us/library/ms810016.aspx](http://msdn.microsoft.com/en-us/library/ms810016.aspx)

查找标题为“引用计数规则”的部分

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T00:39:56.473

假设 Jeff Stong 是对的，请尝试以下方法之一：

*   不要释放 COM 对象（让它泄漏）。

*   创建从包含单例的 DLL 到包含 COM 对象的 DLL 的链接时（不仅仅是运行时）依赖项。

*   在进程开始死亡和 DLL 开始被强制卸载之前，告诉单例死亡和/或释放 COM 对象。

# c# - 如何将此序列转换为此哈希？

> ID：513823
> 
> 赞同：1
> 
> 时间：2009-02-04T23:13:36.677
> 
> 标签：c#, .net, hash

我正在使用 C# .net (2.0) 中的应用程序中的 Web 服务，它返回值（作为字符串），如下所示：

```
%23k.%0d%16%c4%8a%18%efG%28%b9c%12%b7%f1%e2%e7j%93 
```

我知道这样做的真正价值是：

```
236B2E0D16C48A18EF4728B96312B7F1E2E76A93 
```

但我不知道如何从返回值转换为实际值。

有什么想法吗？

无论如何，谢谢你的时间。干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T23:20:20.987

往下走：

如果遇到 '%' 复制接下来的两个字符

否则将找到的字符的ASCII码作为十六进制输出

```
%23  => 23
k    => 6B
.    => 2E
%0d  => 0D 
```

[ASCII 表](http://www.asciitable.com/)

但在代码中，我很确定这会起作用：

```
char c = 'k';
int ascii = (int)c;
string hex = ascii.ToString("X2"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T23:43:05.557

感谢罗布的信息。如果有人想要这里的完整方法，那就是：

```
static private string convertInfoHash(string encodedHash)
{
    string convertedHash = string.Empty;
    for (int i = 0; i < encodedHash.Length; i++)
    {
        if (encodedHash[i] == '%')
        {
            convertedHash += String.Format("{0}{1}",encodedHash[i + 1],encodedHash[i + 2]);
            i += 2;
        }
        else
        {
            int ascii = (int)encodedHash[i];
            convertedHash += ascii.ToString("X2");

        }
    }

    return convertedHash;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-04T23:15:46.360

我不确定，但尝试使用 System.Web.HttpUtility.UrlDecode 方法

# sql - 如何在 postgres 中“命名”查询

> ID：513831
> 
> 赞同：13
> 
> 时间：2009-02-04T23:17:02.787
> 
> 标签：sql, postgresql, jdbc

在 postgresql 中，查询日志中的查询如下所示：

```
2009-02-05 00:12:27 CET LOG:  duration: 3781.634 ms  execute <unnamed>: SELECT QUERY .... 
```

是否有可能将更有用的东西放入“< unnamed >”中，就像请求查询的 url 一样？

是否有任何其他可能性可以使用 java 中的 jdbc 在 postgresql 中跟踪查询的来源？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-05T00:47:15.053

简短的回答是“不”

可以在准备语句时使用[PREPARE](http://www.postgresql.org/docs/8.3/static/sql-prepare.html)命令设置名称，但这需要重写所有 SQL。没有选项可以简单地将名称参数添加到您的 JDBC 方法中。

JDBC 驱动程序同时使用命名和未命名的预处理语句。当它希望重用它们时，它会给它们一个名称，如果相同的 PreparedStatement 对象被执行 5 次，它会认为这是合适的（尽管这可以通过设置 prepareThreshold 进行配置）。

文档在[这里](http://jdbc.postgresql.org/documentation/83/server-prepare.html)

更多信息也可以通过搜索[PostgreSQL JDBC 邮件列表找到](http://archives.postgresql.org/pgsql-jdbc/)

# java - 如何比较 Java 中的字符串？

> ID：513832
> 
> 赞同：724
> 
> 时间：2009-02-04T23:17:07.873
> 
> 标签：java, string, equality

到目前为止，我一直`==`在我的程序中使用运算符来比较我的所有字符串。但是，我遇到了一个错误，将其中一个`.equals()`改为，它修复了这个错误。

`==`坏吗？什么时候应该使用，什么时候不应该使用？有什么不同？

* * *

## 回答 #1

> 赞同：5882
> 
> 时间：2009-02-04T23:19:49.770

`==`测试引用相等性（它们是否是同一个对象）。

`.equals()`测试值相等（它们在逻辑上是否“相等”）。

[Objects.equals()](http://docs.oracle.com/javase/7/docs/api/java/util/Objects.html#equals(java.lang.Object,%20java.lang.Object))`null`在调用之前检查，`.equals()`因此您不必这样做（从 JDK7 开始可用，在[Guava](https://github.com/google/guava/wiki/CommonObjectUtilitiesExplained#equals)中也可用）。

因此，如果您想测试两个字符串是否具有相同的值，您可能需要使用`Objects.equals()`.

```
// These two have the same value
new String("test").equals("test") // --> true 

// ... but they are not the same object
new String("test") == "test" // --> false 

// ... neither are these
new String("test") == new String("test") // --> false 

// ... but these are because literals are interned by 
// the compiler and thus refer to the same object
"test" == "test" // --> true 

// ... string literals are concatenated by the compiler
// and the results are interned.
"test" == "te" + "st" // --> true

// ... but you should really just call Objects.equals()
Objects.equals("test", new String("test")) // --> true
Objects.equals(null, "test") // --> false
Objects.equals(null, null) // --> true 
```

您几乎**总是**想使用`Objects.equals()`. 在您**知道**自己正在处理[实习](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#intern--)字符串的**极少数**情况下，您*可以*使用.***`==`***

 ***从[JLS 3.10.5。*字符串文字*](https://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#jls-3.10.5)：

> 此外，字符串字面量始终指代*同*一个 class 实例`String`。这是因为字符串文字 - 或者更一般地说，作为常量表达式的值的字符串（[第 15.28 节](https://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.28)） - 是“内部的”，以便使用 方法共享唯一实例`String.intern`。

类似的例子也可以在[JLS 3.10.5-1](https://docs.oracle.com/javase/specs/jls/se8/html/jls-3.html#d5e1634)中找到。

### 其他需要考虑的方法

[String.equalsIgnoreCase()](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#equalsIgnoreCase-java.lang.String-)忽略大小写的值相等。但是请注意，此方法在各种与语言环境相关的情况下可能会产生意外结果，请参阅[此问题](https://stackoverflow.com/questions/44238749/equalsignorecase-not-working-as-intended)。

[String.contentEquals()](https://docs.oracle.com/javase/8/docs/api/java/lang/String.html#contentEquals-java.lang.CharSequence-)将 the`String`的内容与 any 的内容进行比较`CharSequence`（Java 1.5 起可用）。使您不必在进行相等比较之前将您的 StringBuffer 等转换为字符串，但将空值检查留给您。

* * *

## 回答 #2

> 赞同：758
> 
> 时间：2009-02-04T23:50:40.817

`==`测试对象引用，`.equals()`测试字符串值。

有时看起来好像是在`==`比较值，因为 Java 做了一些幕后工作来确保相同的内联字符串实际上是同一个对象。

例如：

```
String fooString1 = new String("foo");
String fooString2 = new String("foo");

// Evaluates to false
fooString1 == fooString2;

// Evaluates to true
fooString1.equals(fooString2);

// Evaluates to true, because Java uses the same object
"bar" == "bar"; 
```

**但要注意空值！**

`==`处理`null`字符串很好，但从空字符串调用`.equals()`会导致异常：

```
String nullString1 = null;
String nullString2 = null;

// Evaluates to true
System.out.print(nullString1 == nullString2);

// Throws a NullPointerException
System.out.print(nullString1.equals(nullString2)); 
```

因此，如果您知道这`fooString1`可能为空，请告诉读者，通过编写

```
System.out.print(fooString1 != null && fooString1.equals("bar")); 
```

以下内容更短，但它检查 null 的情况不太明显：

```
System.out.print("bar".equals(fooString1));  // "bar" is never null
System.out.print(Objects.equals(fooString1, "bar"));  // Java 7 required 
```

* * *

## 回答 #3

> 赞同：467
> 
> 时间：2013-01-02T14:05:35.707

`==`比较对象引用。

`.equals()`比较字符串值。

有时`==`会产生比较字符串值的错觉，例如以下情况：

```
String a="Test";
String b="Test";
if(a==b) ===> true 
```

这是因为当您创建任何字符串字面量时，JVM 首先会在字符串池中搜索该字面量，如果找到匹配项，则会为新字符串提供相同的引用。正因为如此，我们得到：

**(a==b) ===> 真**

```
 String Pool
     b -----------------> "test" <-----------------a 
```

但是，`==`在以下情况下失败：

```
String a="test";
String b=new String("test");
if (a==b) ===> false 
```

在这种情况下，`new String("test")`语句 new String 将在堆上创建，并且该引用将被提供给`b`，因此`b`将在堆上而不是在字符串池中提供引用。

现在`a`指向字符串池中的字符串，同时`b`指向堆上的字符串。因此我们得到：

**如果（a==b）===> 错误。**

```
 String Pool
     "test" <-------------------- a

                   Heap
     "test" <-------------------- b 
```

虽然`.equals()`总是比较 String 的值，所以它在两种情况下都为真：

```
String a="Test";
String b="Test";
if(a.equals(b)) ===> true

String a="test";
String b=new String("test");
if(a.equals(b)) ===> true 
```

所以使用`.equals()`总是更好。

* * *

## 回答 #4

> 赞同：229
> 
> 时间：2009-02-04T23:21:25.540

`==`操作员检查两个字符串是否是完全相同的对象。

该`.equals()`方法将检查两个字符串是否具有相同的值。

* * *

## 回答 #5

> 赞同：186
> 
> 时间：2009-02-05T10:54:17.493

Java 中的字符串是不可变的。这意味着每当您尝试更改/修改字符串时，您都会获得一个新实例。您不能更改原始字符串。这样做是为了可以缓存这些字符串实例。一个典型的程序包含大量的字符串引用，缓存这些实例可以减少内存占用并提高程序的性能。

使用 == 运算符进行字符串比较时，您不是在比较字符串的内容，而是在实际比较内存地址。如果它们都相等，则返回 true ，否则返回 false 。而字符串中的equals比较字符串内容。

所以问题是如果所有字符串都缓存在系统中，为什么`==`返回false而equals返回true？嗯，这是可能的。如果您`String str = new String("Testing")`创建一个新字符串，即使缓存已经包含具有相同内容的字符串，您最终也会在缓存中创建一个新字符串。总之`"MyString" == new String("MyString")`总是会返回false。

Java 还讨论了函数 intern() 可用于字符串以使其成为缓存的一部分，因此`"MyString" == new String("MyString").intern()`将返回 true。

注意： == 运算符比 equals 快得多，因为您正在比较两个内存地址，但您需要确保代码没有在代码中创建新的 String 实例。否则你会遇到错误。

* * *

## 回答 #6

> 赞同：151
> 
> 时间：2009-02-04T23:25:04.830

```
String a = new String("foo");
String b = new String("foo");
System.out.println(a == b); // prints false
System.out.println(a.equals(b)); // prints true 
```

确保你明白为什么。这是因为`==`比较只比较参考；该`equals()`方法对内容进行逐个字符的比较。

当您为`a`and调用 new 时`b`，每个人都会获得一个指向`"foo"`字符串表中的新引用。参考文献不同，但内容相同。

* * *

## 回答 #7

> 赞同：129
> 
> 时间：2009-02-04T23:20:18.647

是的，很糟糕……

`==`意味着您的两个字符串引用是完全相同的对象。您可能听说过这种情况，因为 Java 保留了某种文字表（它确实如此），但情况并非总是如此。一些字符串以不同的方式加载，由其他字符串构造等等，所以你绝不能假设两个相同的字符串存储在同一个位置。

Equals 为您进行真正的比较。

* * *

## 回答 #8

> 赞同：126
> 
> 时间：2009-02-04T23:19:49.940

是的，`==`不利于比较字符串（实际上是任何对象，除非您知道它们是规范的）。 `==`只是比较对象引用。 `.equals()`测试平等。对于字符串，它们通常是相同的，但正如您所发现的，这并不总是得到保证。

* * *

## 回答 #9

> 赞同：122
> 
> 时间：2013-04-02T09:15:33.830

Java 有一个字符串池，Java 在该池下管理字符串对象的内存分配。请参阅[**Java 中的字符串池**](https://stackoverflow.com/questions/3801343/what-is-string-pool-in-java)

当您使用`==`运算符检查（比较）两个对象时，它会将地址相等性与字符串池进行比较。如果两个 String 对象具有相同的地址引用，则返回`true`，否则返回`false`。但是如果要比较两个 String 对象的内容，则必须重写该`equals`方法。

`equals`实际上是 Object 类的方法，但它被重写到 String 类中，并给出了一个新的定义，它比较了 object 的内容。

```
Example:
    stringObjectOne.equals(stringObjectTwo); 
```

但请注意它尊重字符串的情况。如果您想要不区分大小写的比较，那么您必须使用 String 类的 equalsIgnoreCase 方法。

让我们来看看：

```
String one   = "HELLO"; 
String two   = "HELLO"; 
String three = new String("HELLO"); 
String four  = "hello"; 

one == two;   // TRUE
one == three; // FALSE
one == four;  // FALSE

one.equals(two);            // TRUE
one.equals(three);          // TRUE
one.equals(four);           // FALSE
one.equalsIgnoreCase(four); // TRUE 
```

* * *

## 回答 #10

> 赞同：105
> 
> 时间：2009-02-05T08:14:48.927

我同意zacherates的回答。

但是你可以做的是调用`intern()`你的非文字字符串。

从 zacherates 示例：

```
// ... but they are not the same object
new String("test") == "test" ==> false 
```

如果您实习非文字字符串相等是`true`：

```
new String("test").intern() == "test" ==> true 
```

* * *

## 回答 #11

> 赞同：103
> 
> 时间：2009-02-04T23:20:08.413

**`==`比较 Java**中的对象引用，对象也不例外`String`。

**为了比较对象（包括`String`）的实际内容，必须使用`equals`方法**。

如果两个`String`对象的比较`==`结果是`true`，那是因为`String`对象是被实习的，并且 Java 虚拟机有多个引用指向 的同一个实例`String`。不应期望将`String`包含相同内容的一个对象与另一个`String`对象进行比较`==`，以评估为`true`。

* * *

## 回答 #12

> 赞同：101
> 
> 时间：2009-02-04T23:20:47.273

`.equals()`比较一个类中的数据（假设函数已实现）。 `==`比较指针位置（对象在内存中的位置）。

`==`如果两个对象（NOT TALKING ABOUT PRIMITIVES）都指向同一个对象实例，则返回 true。 `.equals()`如果两个对象包含相同的数据，则返回 true [`equals()`Versus `==`in Java](http://www.java-samples.com/showtutorial.php?tutorialid=221)

这可能会帮助你。

* * *

## 回答 #13

> 赞同：100
> 
> 时间：2013-03-28T12:22:37.447

`==`执行**引用**相等检查，这 2 个对象（在本例中为字符串）是否引用内存中的同一对象。

该`equals()`方法将检查2 个对象的**内容**或**状态是否相同。**

显然`==`更快，但是如果您只想判断 2 `String`s 是否包含相同的文本，在许多情况下会（可能）给出错误的结果。

绝对推荐使用该`equals()`方法。

不用担心性能。鼓励使用的一些事情`String.equals()`：

1.  执行`String.equals()`第一次检查引用相等性（使用`==`），如果两个字符串通过引用相同，则不执行进一步计算！
2.  如果 2 个字符串引用不相同，`String.equals()`接下来将检查字符串的长度。这也是一个快速的操作，因为`String`该类存储了字符串的长度，无需计算字符或代码点。如果长度不同，则不执行进一步检查，我们知道它们不可能相等。
3.  只有当我们走到这一步时，才会真正比较两个字符串的内容，这将是一个速记比较：如果我们发现一个不匹配的字符（在两个字符串中的相同位置），并不是所有的字符都会被比较)，将不再检查其他字符。

总而言之，即使我们保证字符串是实习生，使用该`equals()`方法仍然不是人们可能认为的那样开销，绝对是推荐的方式。如果您想要一个有效的引用检查，那么在语言规范和实现保证相同的枚举值将是相同的对象（通过引用）的情况下使用枚举。

* * *

## 回答 #14

> 赞同：83
> 
> 时间：2013-06-11T09:17:11.060

如果您像我一样，当我第一次开始使用 Java 时，我想使用“==”运算符来测试两个 String 实例是否相等，但无论好坏，这在 Java 中都不是正确的方法。

在本教程中，我将演示几种正确比较 Java 字符串的不同方法，从我大部分时间使用的方法开始。在本 Java 字符串比较教程的最后，我还将讨论为什么“==”运算符在比较 Java 字符串时不起作用。

**选项 1：Java String 与 equals 方法比较** 大多数时候（可能是 95% 的时间）我用 Java String 类的 equals 方法比较字符串，如下所示：

```
if (string1.equals(string2)) 
```

此 String equals 方法查看两个 Java 字符串，如果它们包含完全相同的字符串，则认为它们相等。

看一个使用 equals 方法的快速字符串比较示例，如果运行以下测试，两个字符串将不会被视为相等，因为字符不完全相同（字符的大小写不同）：

```
String string1 = "foo";
String string2 = "FOO";

if (string1.equals(string2))
{
    // this line will not print because the
    // java string equals method returns false:
    System.out.println("The two strings are the same.")
} 
```

但是，当两个字符串包含完全相同的字符串时，equals 方法将返回 true，如下例所示：

```
String string1 = "foo";
String string2 = "foo";

// test for equality with the java string equals method
if (string1.equals(string2))
{
    // this line WILL print
    System.out.println("The two strings are the same.")
} 
```

**选项 2：使用 equalsIgnoreCase 方法进行字符串比较**

在某些字符串比较测试中，您需要忽略字符串是大写还是小写。当您想以这种不区分大小写的方式测试字符串是否相等时，请使用 String 类的 equalsIgnoreCase 方法，如下所示：

```
String string1 = "foo";
String string2 = "FOO";

 // java string compare while ignoring case
 if (string1.equalsIgnoreCase(string2))
 {
     // this line WILL print
     System.out.println("Ignoring case, the two strings are the same.")
 } 
```

**选项 3：使用 compareTo 方法比较 Java 字符串**

还有第三种比较不常用的方法来比较 Java 字符串，那就是使用 String 类的 compareTo 方法。如果两个字符串完全相同，则 compareTo 方法将返回值 0（零）。下面是这个字符串比较方法的简单示例：

```
String string1 = "foo bar";
String string2 = "foo bar";

// java string compare example
if (string1.compareTo(string2) == 0)
{
    // this line WILL print
    System.out.println("The two strings are the same.")
} 
```

当我在写 Java 中的这个相等概念时，重要的是要注意 Java 语言在基本 Java Object 类中包含一个 equals 方法。每当您创建自己的对象并且想要提供一种方法来查看对象的两个实例是否“相等”时，您应该在您的类中覆盖（并实现）这个 equals 方法（以 Java 语言提供的相同方式String equals 方法中的这种相等/比较行为）。

您可能想看看这个[==、.equals()、compareTo() 和 compare()](http://www.ensta-paristech.fr/~diam/java/online/notes-java/data/expressions/22compareobjects.html)

* * *

## 回答 #15

> 赞同：78
> 
> 时间：2013-03-24T14:01:20.520

功能：

```
public float simpleSimilarity(String u, String v) {
    String[] a = u.split(" ");
    String[] b = v.split(" ");

    long correct = 0;
    int minLen = Math.min(a.length, b.length);

    for (int i = 0; i < minLen; i++) {
        String aa = a[i];
        String bb = b[i];
        int minWordLength = Math.min(aa.length(), bb.length());

        for (int j = 0; j < minWordLength; j++) {
            if (aa.charAt(j) == bb.charAt(j)) {
                correct++;
            }
        }
    }

    return (float) (((double) correct) / Math.max(u.length(), v.length()));
} 
```

测试：

```
String a = "This is the first string.";

String b = "this is not 1st string!";

// for exact string comparison, use .equals

boolean exact = a.equals(b);

// For similarity check, there are libraries for this
// Here I'll try a simple example I wrote

float similarity = simple_similarity(a,b); 
```

* * *

## 回答 #16

> 赞同：78
> 
> 时间：2013-07-25T05:08:18.870

`==`操作员检查两个引用是否指向同一个对象。`.equals()`检查实际的字符串内容（值）。

注意该`.equals()`方法属于类`Object`（所有类的超类）。您需要根据您的类要求覆盖它，但对于 String 它已经实现，它会检查两个字符串是否具有相同的值。

*   **情况1**

    ```
    String s1 = "Stack Overflow";
    String s2 = "Stack Overflow";
    s1 == s2;      //true
    s1.equals(s2); //true 
    ```

    原因：创建的不带 null 的字符串字面量存储在堆的 permgen 区域的字符串池中。所以 s1 和 s2 都指向池中的同一个对象。

*   **案例2**

    ```
    String s1 = new String("Stack Overflow");
    String s2 = new String("Stack Overflow");
    s1 == s2;      //false
    s1.equals(s2); //true 
    ```

    原因：如果您使用关键字创建 String 对象`new`，则会在堆上为其分配一个单独的空间。

* * *

## 回答 #17

> 赞同：54
> 
> 时间：2012-04-12T05:25:59.517

`==`比较对象的引用值，而类`equals()`中的方法`java.lang.String`比较对象的内容`String`（与另一个对象）。

* * *

## 回答 #18

> 赞同：51
> 
> 时间：2013-01-08T04:37:14.720

我认为，当您定义 a 时，您就定义了`String`一个对象。所以你需要使用`.equals()`. 当您使用原始数据类型时，您必须使用（和任何对象）`==`但`String`必须使用`.equals()`.

* * *

## 回答 #19

> 赞同：49
> 
> 时间：2013-12-18T19:26:34.653

如果该`equals()`方法存在于`java.lang.Object`类中，并且需要检查对象状态的等价性！这意味着，对象的内容。而`==`操作员需要检查实际的对象实例是否相同。

*例子*

考虑两个不同的参考变量，`str1`和`str2`：

```
str1 = new String("abc");
str2 = new String("abc"); 
```

如果您使用`equals()`

```
System.out.println((str1.equals(str2))?"TRUE":"FALSE"); 
```

您将获得输出，`TRUE`就像您使用`==`.

```
System.out.println((str1==str2) ? "TRUE" : "FALSE"); 
```

现在您将获得`FALSE`as 输出，因为两者`str1`和`str2`都指向两个不同的对象，即使它们共享相同的字符串内容。这是因为`new String()`每次都会创建一个新对象。

* * *

## 回答 #20

> 赞同：45
> 
> 时间：2013-04-30T06:14:22.447

运算符*==*始终用于**对象引用比较**，而 String 类*.equals()*方法被覆盖以进行**内容比较**：

```
String s1 = new String("abc");
String s2 = new String("abc");
System.out.println(s1 == s2); // It prints false (reference comparison)
System.out.println(s1.equals(s2)); // It prints true (content comparison) 
```

* * *

## 回答 #21

> 赞同：40
> 
> 时间：2012-09-03T04:55:32.520

所有对象都保证有一个`.equals()`方法，因为 Object 包含一个方法，`.equals()`，它返回一个布尔值。如果需要进一步定义，则覆盖此方法是子类的工作。如果没有它（即使用`==`），则只会检查两个对象之间的内存地址是否相等。String 覆盖此`.equals()`方法，它不使用内存地址，而是返回字符级别的字符串比较是否相等。

一个重要的注意事项是字符串存储在一个集中池中，因此一旦创建了字符串，它就会永远存储在同一地址的程序中。字符串不会改变，它们是不可变的。这就是为什么如果您有大量的字符串处理要做，那么使用常规字符串连接是一个坏主意。相反，您将使用`StringBuilder`提供的类。请记住，指向该字符串的指针可以更改，如果您有兴趣查看两个指针是否相同，那`==`将是一个不错的选择。字符串本身没有。

* * *

## 回答 #22

> 赞同：39
> 
> 时间：2013-05-29T02:51:02.743

您还可以使用该`compareTo()`方法比较两个字符串。如果 compareTo 结果为 0，则两个字符串相等，否则被比较的字符串不相等。

比较`==`引用而不比较实际字符串。如果您确实使用`new String(somestring).intern()`then 创建了每个字符串，则可以使用`==`运算符比较两个字符串，否则只能使用 equals() 或 compareTo 方法。

* * *

## 回答 #23

> 赞同：39
> 
> 时间：2014-01-14T11:07:15.467

在 Java 中，当`==`运算符用于比较 2 个对象时，它会检查对象是否引用内存中的同一位置。换句话说，它检查这两个对象名称是否基本上是对同一内存位置的引用。

Java`String`类实际上覆盖了类中的默认`equals()`实现`Object`——它覆盖了方法，因此它只检查字符串的值，而不是它们在内存中的位置。这意味着如果您调用该`equals()`方法来比较 2 个`String`对象，那么只要实际的字符序列相等，两个对象就被认为是相等的。

> `==`操作员检查两个字符串是否是完全相同的对象。

> 该`.equals()`方法检查两个字符串是否具有相同的值。

# lambda - 如何重构这个 switch 语句？

> ID：513837
> 
> 赞同：1
> 
> 时间：2009-02-04T23:17:54.983
> 
> 标签：lambda, switch-statement

昨天我在玩 jQGrid 插件和 ASP.NET。一切都很好，我的网格现在可以工作了，但是我有两种方法可以让我的代码有异味。

臭臭方法：

```
private IOrderedEnumerable<Employee> GetOrderedEmployees(Column sortColumn, bool ascending)
    {
        switch (sortColumn)
        {
            case Column.Name:
                {
                    return GetOrderedEmployees(e => e.Name, ascending);
                }
            case Column.Salary:
                {
                    return GetOrderedEmployees(e => e.Salary, ascending);
                }
            default:
                {
                    return GetOrderedEmployees(e => e.ID, ascending);
                }
        }
    }

    private IOrderedEnumerable<Employee> GetOrderedEmployees<TSortKey>(Func<Employee, TSortKey> func, bool ascending)
    {
        return ascending ? Context.Employees.OrderBy(func) : Context.Employees.OrderByDescending(func);
    } 
```

我不知道如何正确重构它们。似乎最好的解决方案是`return e=>e.Name`在 switch 语句中只返回 lambdas (fe )，但是怎么做呢？

在 switch 语句中，`ascending`参数被传递了 3 次。不是重复吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2009-02-04T23:20:03.733

我想你可能在这里过分了。返回 lambdas (IMO) 比简单的 switch 语句或 if;else if;else 块更令人困惑。可能有更好的方法，但有时您确实需要检查条件，尤其是对于列（我讨厌使用 ListViews，但它们是必要的并且通常需要这种代码。）

我认为您不需要重构任何东西。如果该 switch 语句成为维护方面的难题，那么请继续进行，但并非所有 switch 语句都构成“代码异味”。

为了解决您的代码重复问题，您可以使用开关来获取 e.?? 首先是值，将其保存下来，然后在方法结束时调用该函数一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-04T23:22:47.220

有一些模式可能在这里起作用，但是提供者呢？您可以创建一个提供 GetOrderEmployees 的 Provider，然后传入您想要使用的 Provider 而不是排序列。

编辑 - 但我也认为第一张海报的评论有很多优点 - 无论如何不要为小土豆制定复杂的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T00:08:31.963

如果您只是想减少代码中的重复：

```
private IOrderedEnumerable<Employee> GetOrderedEmployees(Column sortColumn, bool ascending)
{
    Func<Employee, TSortKey> func = e => e.ID;

    switch (sortColumn)
    {
        case Column.Name:
            {
                func = e => e.Name;
            }
        case Column.Salary:
            {
                func = e => e.Salary;
            }
    }

    return GetOrderedEmployees(func, ascending);
}

private IOrderedEnumerable<Employee> GetOrderedEmployees<TSortKey>(Func<Employee, TSortKey> func, bool ascending)
{
    return ascending ? Context.Employees.OrderBy(func) : Context.Employees.OrderByDescending(func);
} 
```

（我不精通 .NET；请原谅任何语法错误。）

# c# - 更有效的正则表达式或替代方法？

> ID：513865
> 
> 赞同：4
> 
> 时间：2009-02-04T23:23:44.270
> 
> 标签：c#, .net, regex

我有一个超过一百万行的文件。

```
 {<uri::rdfserver#null> <uri::d41d8cd98f00b204e9800998ecf8427e> <uri::TickerDailyPriceVolume> "693702"^^<xsd:long>}
 {<uri::rdfserver#null> <uri::d41d8cd98f00b204e9800998ecf8427e> <uri::TickerDailyPriceId> <uri::20fb8f7d-30ef-dd11-a78d-001f29e570a8>} 
```

每一行都是一个语句。

```
struct Statement
    string C;
    string S;
    string P;
    string O;
    string T; 
```

目前我在 while 循环中使用 TextReader 并使用正则表达式解析每一行：

```
Regex lineParse = new Regex(@"[^<|\""]*\w[^>\""]*", RegexOptions.Singleline | RegexOptions.Compiled); 
```

进行此解析需要相当长的时间，我希望有人可以为我指出更有效的解析策略。

有些行有 5 个匹配项，有些有 4 个。以下是每行的解析方式：

```
{<uri::rdfserver#null> <uri::d41d8cd98f00b204e9800998ecf8427e> <uri::TickerDailyPriceVolume> "693702"^^<xsd:long>}

Statement()
    C = uri::rdfserver#null
    S = uri::d41d8cd98f00b204e9800998ecf8427e
    P = uri::TickerDailyPriceVolume
    O = 693702
    T = xsd:long

{<uri::rdfserver#null> <uri::d41d8cd98f00b204e9800998ecf8427e> <uri::TickerDailyPriceId> <uri::20fb8f7d-30ef-dd11-a78d-001f29e570a8>}

Statement()
    C = uri::rdfserver#null
    S = uri::d41d8cd98f00b204e9800998ecf8427e
    P = uri::TickerDailyPriceId
    O = uri::20fb8f7d-30ef-dd11-a78d-001f29e570a8 
```

评论中的附加信息：“我看到的性能不佳实际上是由于我在代码中设置了一个条件断点。没有那个断点，一切都很快。如果有人有任何改进的想法，我会有兴趣”——埃里克·斯库诺弗

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2009-02-04T23:39:17.657

最快的（如下图）是简单的字符串拆分：

```
line.Split(new char[] { '{', '<', '>', '}', ' ', '^', '"' },
           StringSplitOptions.RemoveEmptyEntries); 
```

下一个最快的是锚定正则表达式（丑陋）：

```
Regex lineParse
    = new Regex(@"^\{(<([^>]+)>\s*){3,4}(""([^""]+)""\^\^<([^>]+)>\s*)?\}$",
                RegexOptions.Compiled);
Match m = lineParse.Match(line);
if (m.Groups[2].Captures.Count == 3)
{
    Data data = new Data { C = m.Groups[2].Captures[0].Value,
        S = m.Groups[2].Captures[1].Value, P = m.Groups[2].Captures[2].Value,
        O = m.Groups[4].Value, T = m.Groups[5].Value };
} else {
    Data data = new Data { C = m.Groups[2].Captures[0].Value,
        S = m.Groups[2].Captures[1].Value, P = m.Groups[2].Captures[2].Value,
        O = m.Groups[2].Captures[3].Value, T = String.Empty };
} 
```

1M 行随机数据的时序（String.Split 作为基线）：

```
Method                #1  Wall (Diff)       #2  Wall (Diff)
------------------------------------------------------------
line.Split                3.6s (1.00x)         3.1s (1.00x)
myRegex.Match             5.1s (1.43x)         3.3s (1.10x)
itDependsRegex.Matches    6.8s (1.88x)         4.4s (1.44x)
stateMachine              8.4s (2.34x)         5.6s (1.82x)
alanM.Matches             9.1s (2.52x)         7.8s (2.52x)
yourRegex.Matches        18.3s (5.06x)        12.1s (3.90x) 
```

**更新为包括 @AlanM 和 @itdepends 正则表达式。**Regex.Matches 似乎比 Regex.Match 慢，但是，您为解析器提供的上下文线索越多，它的性能就越好。@AlanM 使用的单个否定字符类是最容易阅读的，但比最神秘的（我的）慢。向@itdepends 致敬，因为它是产生最快时间的最简单的正则表达式。好的，虽然我认为编写状态机来解析行会很疯狂，但它实际上并没有表现不佳......感谢@RexM 的建议。我还增加了在家中使用 Q6600 的次数（#2）与工作中的旧 Xeon（#1）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2009-02-05T02:50:26.520

有时状态机比正则表达式快得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-05T00:10:31.290

经过一些测试，我想出了：

```
@"<(?<capture>[^>]+)>|""(?<capture>[^""]+)""" 
```

该值需要通过 match.Groups[1].Value 访问。

在我的非科学测试中，它比原始问题中的速度快 75-80%。

**比赛与比赛**

在生产中，我通常使用 Match，但在上面使用 Matches。我从来没有真正考虑过性能影响，所以做了一些测试，所以使用完全相同的**正则表达式**：

```
for(Match match = regex.Match(input); match.Success; match = match.NextMatch())
// min 5.01 sec
// max 5.15 sec

foreach(Match match in regex.Matches(input))
// min 5.66 sec
// max 6.07 sec 
```

所以 Match 当然可以比 Matches 更快。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2009-02-05T02:52:41.697

据我所知，到目前为止提供的正则表达式比它们需要的要复杂得多。如果 @sixlettervariables 的 Split 方法有效，则 Matches 应该使用这个正则表达式：

```
@"[^{}<> ^""]+" 
```

但我仍然希望 String.Split 方法更快。

# delphi - Delphi Prism / VS 2008：一键从代码切换到设计？

> ID：513870
> 
> 赞同：1
> 
> 时间：2009-02-04T23:24:45.470
> 
> 标签：delphi, visual-studio-2008, ide, oxygene

多年来，我使用了几个版本的 Delphi IDE。当我使用 Delphi Prism 时，我必须处理 Visual Studio——就我而言，尤其是 VS 2008。

对我来说最烦人的事情之一是我必须右键单击我的表单才能切换到代码编辑器，反之亦然。在 Delphi 中，只需按一下`F12`键即可在代码和表单设计器之间切换。

有没有办法让这个快捷方式在 Visual Studio 中工作？在我看来，当我查看键盘选项时，我至少需要 2 个快捷键。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-02-05T00:26:13.240

您可以使用默认键：

*   来自“表单设计器”—— `F7`
*   从代码到“表单设计器” - `Shift`+`F7`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2009-02-05T09:04:17.657

你见过免费的[DPack](http://www.usysware.com/dpack/)吗？这是一系列 IDE 增强功能，旨在提高您的工作效率，包括用于 Visual Studio 的 Delphi 键盘映射。

最好的祝福，

西蒙

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2009-02-08T22:52:37.943

`F12`通过使用键盘选项绑定`F12`到`View.ViewCode`、`View.ViewMarku`p 和 ，我已经模拟了 Delphi 的行为`View.ViewDesigner`。

您可以根据要在它们之间旋转的方式将它们绑定在不同的视图中。例如，在 ASP.NET 应用程序中，我使用以下内容：

*   HTML 编辑器源视图`F12`==>`View.ViewCode`

*   文本编辑器`F12`==>`View.ViewDesigner`

*   HTML 编辑器设计视图`F12`==>`View.ViewMarkup`

# python - Python：用于查找表的列表与字典

> ID：513882
> 
> 赞同：192
> 
> 时间：2009-02-04T23:28:41.203
> 
> 标签：python, performance

我有大约 1000 万个值需要放入某种类型的查找表中，所以我想知道*list*或*dict*哪个更有效？

我知道你可以为两者做这样的事情：

```
if something in dict_of_stuff:
    pass 
```

和

```
if something in list_of_stuff:
    pass 
```

我的想法是 dict 会更快，更有效。

谢谢你的帮助。

**编辑 1**
关于我正在尝试做的事情的更多信息。 [欧拉问题 92](http://projecteuler.net/index.php?section=problems&id=92)。我正在制作一个查找表，以查看计算的值是否已全部计算完毕。

**编辑 2**
查找效率。

**编辑 3**
没有与价值相关的价值......所以*一套*会更好吗？

* * *

## 回答 #1

> 赞同：241
> 
> 时间：2009-02-04T23:38:36.020

# 速度

列表中的查找是 O(n)，字典中的查找是摊销 O(1)，关于数据结构中的项目数。如果您不需要关联值，请使用集合。

# 记忆

字典和集合都使用散列，它们使用的内存比仅用于对象存储要多得多。根据*Beautiful Code*中的 AM Kuchling 的说法，该实现试图保持哈希 2/3 满，因此您可能会浪费相当多的内存。

如果您不即时添加新条目（您根据更新的问题添加了新条目），则可能值得对列表进行排序并使用二进制搜索。这是 O(log n)，对于字符串来说可能会更慢，对于没有自然排序的对象来说是不可能的。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2009-02-04T23:31:41.587

dict 是一个哈希表，因此找到键非常快。所以在dict和list之间，dict会更快。但是，如果您没有要关联的值，则使用集合会更好。它是一个哈希表，没有“表”部分。

* * *

编辑：对于你的新问题，是的，一套会更好。只需创建 2 个集合，一个用于以 1 结尾的序列，另一个用于以 89 结尾的序列。我已经使用集合成功地解决了这个问题。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2009-02-23T19:24:39.140

[`set()`](https://docs.python.org/2/tutorial/datastructures.html#sets)正是你想要的。O(1) 查找，并且比字典小。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2012-06-28T09:16:06.480

我做了一些基准测试，结果发现 dict 比 list 和 set 对于大型数据集更快，在 linux 上的 i7 CPU 上运行 python 2.7.3：

*   `python -mtimeit -s 'd=range(10**7)' '5*10**6 in d'`

    10 个循环，3 个循环中的最佳：每个循环 64.2 毫秒

*   `python -mtimeit -s 'd=dict.fromkeys(range(10**7))' '5*10**6 in d'`

    10000000 个循环，3 个中最好的：每个循环 0.0759 微秒

*   `python -mtimeit -s 'from sets import Set; d=Set(range(10**7))' '5*10**6 in d'`

    1000000 个循环，3 个中最好的：每个循环 0.262 微秒

如您所见，dict 比 list 快得多，比 set 快大约 3 倍。不过，在某些应用程序中，您可能仍希望选择 set 以使其美观。如果数据集非常小（< 1000 个元素），则列表的性能非常好。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2009-02-04T23:37:45.053

你想要一个字典。

对于 Python 中的（未排序的）列表，“in”操作需要 O(n) 时间——当你有大量数据时不好。另一方面，dict 是一个哈希表，因此您可以预期 O(1) 查找时间。

正如其他人所指出的，如果您只有键而不是键/值对，您可能会选择一个集合（一种特殊类型的 dict）。

有关的：

*   [Python wiki](http://wiki.python.org/moin/TimeComplexity)：有关 Python 容器操作的时间复杂度的信息。
*   [SO](https://stackoverflow.com/questions/45228/where-can-i-find-the-time-and-memory-efficencies-of-the-built-in-sequence-types-i)：Python容器操作时间和内存复杂度

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-06-07T13:33:24.567

作为一组新的测试表明@EriF89 经过这么多年仍然正确：

```
$ python -m timeit -s "l={k:k for k in xrange(5000)}"    "[i for i in xrange(10000) if i in l]"
1000 loops, best of 3: 1.84 msec per loop
$ python -m timeit -s "l=[k for k in xrange(5000)]"    "[i for i in xrange(10000) if i in l]"
10 loops, best of 3: 573 msec per loop
$ python -m timeit -s "l=tuple([k for k in xrange(5000)])"    "[i for i in xrange(10000) if i in l]"
10 loops, best of 3: 587 msec per loop
$ python -m timeit -s "l=set([k for k in xrange(5000)])"    "[i for i in xrange(10000) if i in l]"
1000 loops, best of 3: 1.88 msec per loop 
```

在这里，我们还比较了 a ，它在某些用例中`tuple`比已知更快（并且使用更少的内存）。`lists`在查找表的情况下，`tuple`流线型没有更好的。

`dict`和都`set`表现得非常好。这带来了一个有趣的点，与@SilentGhost 关于唯一性的答案相关：如果 OP 在数据集中有 10M 值，并且不知道其中是否存在重复项，那么值得保持其元素的集合/字典并行使用实际数据集，并测试该集/字典中的存在。10M 数据点可能只有 10 个唯一值，这是一个更小的搜索空间！

SilentGhost 关于 dicts 的错误实际上很有启发性，因为可以使用 dict 将重复的数据（值）关联到非重复的集合（键）中，从而保留一个数据对象来保存所有数据，但仍然像查找表一样快。例如，一个 dict 键可以是要查找的值，而该值可以是该值出现的虚构列表中的索引列表。

例如，如果要搜索的源数据列表是`l=[1,2,3,1,2,1,4]`，则可以通过将其替换为以下 dict 来优化搜索和内存：

```
>>> from collections import defaultdict
>>> d = defaultdict(list)
>>> l=[1,2,3,1,2,1,4]
>>> for i, e in enumerate(l):
...     d[e].append(i)
>>> d
defaultdict(<class 'list'>, {1: [0, 3, 5], 2: [1, 4], 3: [2], 4: [6]}) 
```

有了这个字典，人们可以知道：

1.  *如果*一个值在原始数据集中（即`2 in d`返回`True`）
2.  *值在*原始数据集中的位置（即`d[2]`返回在原始数据列表中找到数据的索引列表`[1, 4]`：）

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2009-02-04T23:30:48.780

如果数据是唯一的 set() 将是最有效的，但有两个 - dict（这也需要唯一性，哎呀 :)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-02-23T19:03:30.610

您实际上不需要在表中存储 1000 万个值，因此这两种方式都不是什么大问题。

提示：想想在第一次平方和运算之后你的结果可以有多大。最大可能的结果将远小于 1000 万……

# c# - 从其他应用程序问题中捕获选定的文本

> ID：513883
> 
> 赞同：-1
> 
> 时间：2009-02-04T23:28:57.007
> 
> 标签：c#, winapi

我用 C# 编写了一小段代码来从其他应用程序中捕获选定的文本：

```
SendKeys.SendWait("^c");
string searchedText = Convert.ToString(Clipboard.GetText()); 
```

我的问题是，如果我从浏览器 Chrome 捕获文本，任何人都知道为什么会发生这种情况，或者是否有其他方法可以完成相同的任务

**更新**

我正在执行此应用程序以从任何其他应用程序中捕获选定的文本，并在用户按下热键时将其保存在文件中。

```
protected override void WndProc(ref System.Windows.Forms.Message m)
    {
        // let the base class process the message
        base.WndProc(ref m);

        // if this is a WM_HOTKEY message, notify the parent object
        const int WM_HOTKEY = 0x312;
        if (m.Msg == WM_HOTKEY)
        {
                SendKeys.SendWait("^c");
                string searchedText = Convert.ToString(Clipboard.GetText());
                Save(searchedText);
                Clipboard.Clear();
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-04T23:40:59.807

好吧，您在这里假设 Ctrl-C 总是将文本复制到每个应用程序中的剪贴板。这是一个很大的禁忌，你不知道什么会将文本复制到剪贴板。

此外，应该说，如果您不是专门尝试更改剪贴板的内容，那么使用剪贴板是一个非常糟糕的主意。您似乎只是在使用它从另一个应用程序复制内容。

话虽如此，我建议您为此使用 Microsoft UI 自动化库。它的参考在这里：

[http://msdn.microsoft.com/en-us/library/ms747327.aspx](http://msdn.microsoft.com/en-us/library/ms747327.aspx)

MSDN 杂志上也有一篇关于这个主题的好文章：

[http://msdn.microsoft.com/en-us/magazine/cc163288.aspx](http://msdn.microsoft.com/en-us/magazine/cc163288.aspx)

具体来说，如果您希望获得选定的文本，那么您需要查看位于以下位置的[UI 自动化 TextPattern 概述](http://msdn.microsoft.com/en-us/library/ms745158.aspx)：

[http://msdn.microsoft.com/en-us/library/ms745158.aspx](http://msdn.microsoft.com/en-us/library/ms745158.aspx)

# html - 常见问题的语义 HTML 标记

> ID：513888
> 
> 赞同：36
> 
> 时间：2009-02-04T23:31:25.143
> 
> 标签：html, css, markup, semantics

我想建立一个问答页面。

它不是列表，也不是表格数据，我不确定是否或如何使用`<dl><dt><dd>`.

构建它并使用 css 格式化它的最佳语义方式是什么？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2009-02-04T23:48:29.430

我总是将 <dl> 用于常见问题解答。通常使 <dt> 成为要链接的问题索引的锚点。

**编辑...**

我应该提一下，这是我对最语义化方法的解释。正如我所看到的，这正是 <dl> 旨在标记的那种东西。

至于CSS，它真的很主观。我为 <dt> 做典型的标题风格，字体粗细，字体大小可能略高，字母/单词间距可能更大。

任何能与网站上的其他视觉效果很好地结合在一起的东西，并使问题和答案之间的关系立即显而易见......

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2009-02-04T23:32:41.833

我会选择最简单的模型；每个问题都是一个标题，在段落标签中有答案。我认为，清晰、合乎逻辑且语义清晰。

我不使用提到的定义列表标签的原因是，从纯语义的角度来看，我认为问题和答案不符合纯术语和定义的模式。

# unit-testing - 单元测试 XQuery

> ID：513895
> 
> 赞同：7
> 
> 时间：2009-02-04T23:32:51.240
> 
> 标签：unit-testing, xquery

我一直在使用 XQuery（通过 Java 和 .NET 接口）处理文档存储库，想知道是否有人对 XQuery 模块进行单元测试有任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-15T19:07:46.880

有几个 XQuery 单元测试框架，但大多数都是为特定的 XQuery 处理器专门编写的。这不是一个完整的列表，但包括了我所知道的大多数流行的列表：

**马克逻辑**

Roxy 单元测试器[https://github.com/marklogic/roxy/wiki/Unit-Testing](https://github.com/marklogic/roxy/wiki/Unit-Testing)

XQUT [https://github.com/mblakele/xqut](https://github.com/mblakele/xqut)

xray [https://github.com/robwhitby/xray](https://github.com/robwhitby/xray)

**存在**

XQSuite [http://exist-db.org/exist/apps/doc/xqsuite.xml](http://exist-db.org/exist/apps/doc/xqsuite.xml)

**BaseX**

XQuery 单元模块[http://docs.basex.org/wiki/Unit_Module](http://docs.basex.org/wiki/Unit_Module)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-10T23:01:12.110

这是针对此问题的快速 DIY 类型解决方案： ~~[Poor man's unit testing with XQuery](http://jimfuller.blogspot.com/2007/09/poor-mans-unit-testing-with-xquery.html)~~（死链接）。

这种方法似乎已被接受并扩展用于[xprocxq](http://code.google.com/p/xprocxq/source/browse/trunk/main/test/)项目的测试。

存在其他工具，例如[XTC](http://www.fgeorges.org/xslt/xslt-unit/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2010-08-05T15:44:06.303

此链接可能会影响您的开发。这只是一个想法，但您可以使用各种单元测试用例设计想法在此基础上进行更多开发和增强。

因为 Xml 是元数据世界的王者，所以它很容易设计和运行。

1.  通过捕获所有细节来设计测试用例 XML

    1.  测试数据（输入和预期结果）
    2.  测试用例 ID
    3.  测试用例局部方法
2.  根据细节动态调用。

[职能](http://thewallaceline.blogspot.com/2009/04/xquery-unit-tests.html)

[示例测试脚本](http://www.cems.uwe.ac.uk/xmlwiki/UnitTest2/Tests/unittests.xml)

[结果](http://www.cems.uwe.ac.uk/xmlwiki/UnitTest2/runTests.xql?uri=/db/Wiki/UnitTest2/Tests/unittests.xml)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-15T17:43:00.643

试试[XQSuite](http://exist-db.org/exist/apps/doc/xqsuite.xml?q=xquery%20unit%20test&field=all&id=D1.2.8#D1.2.8)

它非常光滑；这是“最小的例子”：

`declare namespace test="http://exist-db.org/xquery/xqsuite";`

`declare function %test:assertEquals("Hello world") local:hello() { "Hello world" };`

此外，[XSpec](https://code.google.com/p/xspec/wiki/GettingStarted)非常适合 XSLT 测试（例如，提供格式良好的 HTML 测试结果）但似乎需要对 XQuery 测试进行一些工作。该项目似乎在过去几年中变得不活跃。

# html - IE：链接到文件的条件注释

> ID：513896
> 
> 赞同：0
> 
> 时间：2009-02-04T23:32:57.637
> 
> 标签：html

全部。我在 IE 中使用条件注释来解决我在 IE7 中遇到的一些 CSS 问题。

我有一个适用于 firefox 和 ie7 的 all.css 文件，其中包含一些只能解决 IE7 css 问题的执行。我对 all_iefixes.css 进行了修复，这两个文件都在 App_Themes/Default/ 文件夹中。

我使用了一个母版页（Default.master），我的所有页面都继承了该母版页。例如，在另一个文件夹内的某些页面上，localhost/myapp/blah1/blah.aspx 将无法获取 App_Themes/Default 文件夹中的 all_iefixes.css 如果我更改

```
<!--[if IE]><style type="text/css">@import "all_iefixes.css";</style><![endif]--> 
```

至

```
<!--[if IE]><style type="text/css">@import "./../App_Themes/Default/all_iefixes.css";</style><![endif]--> 
```

那么它将适用于 blah1 文件夹内的页面，但它会破坏不在 blah1 文件夹内的其他页面。

我想我可以创建几个母版页，并取决于我想将我的 aspx 页面放在哪里，然后我可以调整链接，但我认为这是一个相当“愚蠢”的修复（？）。有没有一种优雅的方式来做到这一点。

杰克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-04T23:47:00.463

您应该避免在母版页中使用相对路径，除非您可以使用代码生成它：

您可以尝试使用服务器标签来解析路径，但这并不总是可行的（例如，如果您在代码中操作控制树）

```
@import "<% this.ResolveUrl("~/App_Themes/Default/all_iefixes.css") %>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-04T23:49:32.830

来自上层的+1。但是，我宁愿[在 ASP.NET 中使用浏览器文件](http://msdn.microsoft.com/en-us/library/ms228122.aspx)。

# unix - 如何在两个 TTY 之间创建循环？

> ID：513908
> 
> 赞同：2
> 
> 时间：2009-02-04T23:39:28.437
> 
> 标签：unix, tty

每个 Hello 都有一个响应。第二个 TTY 将向发件人 TTY 发送一个问候，反之亦然：

```
echo 'echo hello > /dev/pts/1' > /dev/pts/0 
```

第一个接收者应该向原始发送者发送“hello”，但它没有。怎么了？

**[澄清]**我有两个shell正在运行。/dev/pts/1 是初始发送者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T00:54:52.700

当您向您发送回显命令时，`/dev/pts/0`实际上只是将该回显的输出发送到另一个 TTY 的**输出**- 您**没有**将它发送到另一个 TTY 的**输入**缓冲区。因此，您的嵌套`echo`命令只会显示在另一个 TTY 上，但不会执行。

有一个`ioctl()`调用`TIOCSTI`可用于在另一个 TTY 上伪造输入，但前提是您对该另一个 TTY 具有“写入”权限。

许多年前，我记得我和一些朋友在某些版本的 UNIX 上发现了漏洞，这些漏洞没有正确地执行 TIOCSTI 的安全权限。如果 root 已将终端留在某处登录，则可以让 root 用户的终端代表您输入命令...

# html - 如何使用 XSLT 构建按字母顺序排列的手风琴？

> ID：513911
> 
> 赞同：2
> 
> 时间：2009-02-04T23:40:20.010
> 
> 标签：html, xslt

给定以下 XML：

```
<databases>
    <database>
        <title_display>Aardvark</title_display>
    </database>
    <database>
        <title_display>Apple</title_display>
    </database>
    <database>
        <title_display>Blue</title_display>
    </database>
    <database>
        <title_display>Car</title_display>
    </database>
</databases> 
```

如何使用 XSLT 获得以下 HTML 输出？

```
<h2>A</h2>
<div class="a-content">
    <ul>
        <li>Aardvark</li>
        <li>Aardvark</li>
    </ul>
</div>

<h2>B</h2>
<div class="b-content">
    <ul>
        <li>Blue</li>
    </ul>
</div>

<h2>C</h2>
<div class="c-content">
    <ul>
        <li>Car</li>
    </ul>
</div> 
```

我可以放心地假设所有`<database>`元素都已按字母顺序排列。谢谢！

编辑：为了将来参考，“手风琴”部分是 HTML 用 Ja​​vaScript 变成了手风琴元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-02-05T07:18:28.510

**这是一个更有效的解决方案，使用经典的 Muenchian 方法进行分组 - with keys**。

**这种转变**：

```
<xsl:stylesheet version="1.0"
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:variable name="vLower" select=
 "'abcdefghijklmnopqrstuvwxyz'"/>

 <xsl:variable name="vUpper" select=
 "'ABCDEFGHIJKLMNOPQRSTUVWXYZ'"/>

 <xsl:key name="kTitleBy1stLetter" match="database"
  use="substring(title_display,1,1)"/>

    <xsl:template match="/*">
      <xsl:for-each select=
      "database
        [generate-id()
        =
         generate-id(key('kTitleBy1stLetter',
                         substring(title_display,1,1)
                         )[1]
                    )
        ]"
      >
        <xsl:variable name="v1st" 
         select="substring(title_display,1,1)"/>
        <h2><xsl:value-of select="$v1st"/></h2>
        <div class="{translate($v1st, 
                     $vUpper,
                     $vLower)}-content">
          <ul>
            <xsl:for-each select=
              "key('kTitleBy1stLetter',$v1st)">
               <li><xsl:value-of select="title_display"/></li>
            </xsl:for-each>
          </ul>
      </div>
      </xsl:for-each>
    </xsl:template>
</xsl:stylesheet> 
```

**当应用于最初提供的 XML 文档时**：

```
<databases>
    <database>
        <title_display>Aardvark</title_display>
    </database>
    <database>
        <title_display>Apple</title_display>
    </database>
    <database>
        <title_display>Blue</title_display>
    </database>
    <database>
        <title_display>Car</title_display>
    </database>
</databases> 
```

**产生了想要的结果**：

```
<h2>A</h2>
<div class="a-content">
   <ul>
      <li>Aardvark</li>
      <li>Apple</li>
   </ul>
</div>
<h2>B</h2>
<div class="b-content">
   <ul>
      <li>Blue</li>
   </ul>
</div>
<h2>C</h2>
<div class="c-content">
   <ul>
      <li>Car</li>
   </ul>
</div> 
```

**请注意，Muenchian 方法比**使用 轴上所有`database`元素进行比较的 O(N^2) 解决方案要高效得多。`preceding-sibling::`

**此外，此解决方案生成`class`具有所需大写字母的属性值**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T00:07:51.203

你可以试试这个进行分组。请注意，xslt2.0 有一个 for-each-group 使这更容易。

```
<xsl:stylesheet 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
  version="1.0">
  <xsl:output method="html"/>

  <xsl:template match="/databases">
    <xsl:for-each select="database">
        <xsl:variable name="Init" select="substring(title_display,1,1)"/>
        <xsl:if test="not(preceding-sibling::*[substring(title_display,1,1)=$Init])">
            <h2><xsl:value-of select="$Init"/></h2>
            <div>
            <xsl:attribute name="class">
                <xsl:value-of select="$Init"/><xsl:text>-content</xsl:text>
            </xsl:attribute>
            <ul>
            <xsl:for-each select="../database[substring(title_display,1,1)=$Init]">
                 <li><xsl:value-of select="title_display"/></li>
            </xsl:for-each>
            </ul>
            </div>
        </xsl:if>
    </xsl:for-each>
  </xsl:template>

</xsl:stylesheet> 
```

这通过遍历所有数据库来工作，但只为以每个字母开头的第一个数据库发出数据。然后它会选择所有以该字母开头的项目并将它们作为一个组进行处理。

您的另一个选择是使用 xslt 中的[Muenchian](http://www.jenitennison.com/xslt/grouping/muenchian.html)分组方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T00:26:57.170

这是 Josh 解决方案的不区分大小写版本：

```
<xsl:variable name="lower">abcdefghijklmnopqrstuvwxyz</xsl:variable>
<xsl:variable name="upper">ABCDEFGHIJKLMNOPQRSTUVWXYZ</xsl:variable>

<xsl:for-each select="databases/database">
    <xsl:variable name="Init" select="translate(substring(title_display,1,1), $lower, $upper)"/>
    <xsl:if test="not(preceding-sibling::*[translate(substring(title_display,1,1), $lower, $upper)=$Init])">
        <h2><xsl:value-of select="$Init"/></h2>
        <div>
            <xsl:attribute name="class">
                <xsl:value-of select="translate(substring($Init,1,1), $upper, $lower)"/><xsl:text>-content</xsl:text>
            </xsl:attribute>
            <ul>
                <xsl:for-each select="../database[translate(substring(title_display,1,1), $lower, $upper)=$Init]">
                    <li><xsl:value-of select="title_display"/></li>
                </xsl:for-each>
            </ul>
        </div>
    </xsl:if>
</xsl:for-each> 
```

# vb.net - 数组或列表中的项目是否保持其顺序？

> ID：513912
> 
> 赞同：4
> 
> 时间：2009-02-04T23:40:34.393
> 
> 标签：vb.net, arrays, string, sorting

我在 VS2008 中编写 VB.NET。

我有一个逗号分隔的数字字符串，即 16,7,99,1456,1,3

我在 VB 中这样做：

```
Dim MyArr() As String = MyString.Split(",") 
```

MyArr 会按照它们在字符串中的顺序保留项目吗？

如果我这样做：

```
For Each S as String in MyString.Split(",")
    'Do something with S
    'Will my items be in the same order they were
    'in the string?
Next 
```

我对其进行了测试，它似乎保持了排序顺序，但它会~总是~保持顺序吗？

如果它不保持顺序，那么拆分字符串并保持顺序的好方法是什么？

我之所以问，是因为 MSDN Array 文档说：“不能保证对数组进行排序。” 所以我有点不确定。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-04T23:43:48.660

是的，在您的示例中，这些项目将保持原始顺序。

MSDN 文档指出 Array 不一定因为它是 Array 而排序，但是一旦项目在 Array 中，它们就不会重新排列。Split() 操作将根据给定的标记将其分解，并保留顺序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-04T23:44:08.630

是的，这些操作将保持秩序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-04T23:48:24.597

是的，String.Split 沿着字符串走，一切都会保持秩序。来自 .NET 反射器：

```
private string[] InternalSplitKeepEmptyEntries(int[] sepList, int[] lengthList, int numReplaces, int count)
{
    int startIndex = 0;
    int index = 0;
    count--;
    int num3 = (numReplaces < count) ? numReplaces : count;
    string[] strArray = new string[num3 + 1];
    for (int i = 0; (i < num3) && (startIndex < this.Length); i++)
    {
        strArray[index++] = this.Substring(startIndex, sepList[i] - startIndex);
        startIndex = sepList[i] + ((lengthList == null) ? 1 : lengthList[i]);
    }
    if ((startIndex < this.Length) && (num3 >= 0))
    {
        strArray[index] = this.Substring(startIndex);
        return strArray;
    }
    if (index == num3)
    {
        strArray[index] = Empty;
    }
    return strArray;
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2009-02-04T23:48:11.630

在 .NET 中，字符串是[不可变对象](http://en.wikipedia.org/wiki/Immutable_object)。长话短说，字符串 S 和 Split(",") 返回的字符串存在于不同的内存中。

# c++ - 使用 OpenSSL 查询 X509 证书的扩展

> ID：513919
> 
> 赞同：9
> 
> 时间：2009-02-04T23:45:56.393
> 
> 标签：c++, ssl, openssl

我正在使用 OpenSSL 库的 X509 证书类，我需要查询“密钥使用”扩展名。

在放弃 OpenSSL 的蒸汽软件“文档”后，一些暗中的网络搜索最终显示我需要调用

```
X509_get_ext_d2i(X509 *x, int nid, int *crit, int *idx) 
```

并通过 objects.h 标头搜索显示正确的 NID。

问题是，这个调用返回一个指向 void 的指针，它显然可以指向各种结构，具体取决于所要求的扩展。

由于这些似乎都没有记录，因此无法弄清楚如何解析函数返回的内容。

谁能给我指出一个真正讨论这个问题的文档，而不是仅仅列出我自己可以找到的东西（函数配置文件、它来自哪个文件等）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2010-09-16T12:03:54.713

阅读密钥用法的最简单解决方案似乎是

```
X509* x509_cert = ...
// without X509_check_ca x509_cert->ex_kusage always returns 0 (no idea why)
int ca = X509_check_ca(x509_cert);
unsigned long usage = x509_cert->ex_kusage; 
```

结果值在 opensc/pkcs15-init.h 中定义

```
SC_PKCS15INIT_X509_DIGITAL_SIGNATURE     0x0080UL
SC_PKCS15INIT_X509_NON_REPUDIATION       0x0040UL
SC_PKCS15INIT_X509_KEY_ENCIPHERMENT      0x0020UL
SC_PKCS15INIT_X509_DATA_ENCIPHERMENT     0x0010UL
SC_PKCS15INIT_X509_KEY_AGREEMENT         0x0008UL
SC_PKCS15INIT_X509_KEY_CERT_SIGN         0x0004UL
SC_PKCS15INIT_X509_CRL_SIGN              0x0002UL 
```

我通过找到以下openssl源文件的代码来到了那个灵魂

```
/* Handle key usage */
if((usage=X509_get_ext_d2i(x, NID_key_usage, NULL, NULL))) {
    if(usage->length > 0) {
        x->ex_kusage = usage->data[0];
        if(usage->length > 1) 
        x->ex_kusage |= usage->data[1] << 8;
    } else x->ex_kusage = 0;
    x->ex_flags |= EXFLAG_KUSAGE;
    ASN1_BIT_STRING_free(usage);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T02:10:35.417

第二个参数（nid）确定返回的类型。

看这段代码：

[http://opengrok.creo.hu/dragonfly/xref/src/crypto/openssl-0.9/crypto/x509v3/v3_purp.c#X509_check_ purpose](http://opengrok.creo.hu/dragonfly/xref/src/crypto/openssl-0.9/crypto/x509v3/v3_purp.c#X509_check_purpose)

看来，对于密钥使用 NID，它返回 ASN1_BIT_STRING。（第 361 行）。

# autotools - README.in 如何在 autotools 中使用？

> ID：513924
> 
> 赞同：2
> 
> 时间：2009-02-04T23:47:51.227
> 
> 标签：autotools

我正在使用 acmkdir 初始化一个新项目，它创建了一个 README.in 文件和一个 README 文件。

README.in 是否真的被某些东西用来创建自述文件？如果不是，它的目的是什么？我希望了解 acmkdir 创建的所有文件，这些文件让我很困惑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T00:18:27.700

README.in文件是 README 的“源文件” **。**在 make 时，您的 README.in 将针对**@VERSION@**之类的变量进行处理，并且将为您的构建插入正确的值。

[你可以在这里](http://www.google.com/codesearch/p?hl=en#4sK25pC4wlY/bibletime-1.5.3/README.in&q=README.in)看到一个例子。

# c# - 数据库中的一些数据更改。如何触发一些 C# 代码对这些更改做一些工作？

> ID：513940
> 
> 赞同：6
> 
> 时间：2009-02-04T23:57:15.233
> 
> 标签：c#, database, ado.net, odp.net

假设我有一些带有数据库的应用程序 A。现在我想添加另一个应用程序 B，它应该跟踪应用程序 A 的数据库更改。应用程序 B 应该在数据发生更改时进行一些计算。两个应用程序之间没有直接通信。两者都只能看到数据库。

基本问题是：数据库中的一些数据变化。如何触发一些 C# 代码对这些更改做一些工作？

* * *

为了给答案一些刺激，我提到了一些我目前正在考虑的方法：

1.  使应用程序 B 轮询感兴趣的表中的更改。优点：方法简单。缺点：流量很大，尤其是涉及到很多表的时候。
2.  引入触发器，它将在某些事件上触发。当他们开火时，他们应该将一些条目写入“事件表”。应用程序 B 只需要轮询那个“事件表”。优点：流量少。缺点：逻辑以触发器的形式放入数据库中。（这不是触发器的“邪恶”问题。这是一个设计问题，这使其成为劣势。）
3.  摆脱轮询方法并使用 SqlDependency 类来获得更改通知。优点：（也许？）比轮询方法更少的流量。缺点：不独立于数据库。（我知道 ODP.NET 中的 OracleDependency，但是其他数据库呢？）

什么方法更有利？也许我在上述方法中错过了一些主要（不利）优势？也许还有其他一些我没有想到的方法？

* * *

编辑1：数据库独立性是......让我们称之为......“销售人员”的一个因素。我可以使用 SqlDependency 或 OracleDependency。对于 DB2 或其他数据库，我可以回退到轮询方法。这只是一个成本和收益的问题，我至少想考虑一下，以便我可以讨论它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T00:04:04.970

我会选择解决方案＃1（轮询），因为避免独立应用程序之间的依赖关系和直接连接有助于降低复杂性和问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T00:06:29.973

我认为您已经涵盖了我想到的方法，没有绝对的“最佳”方法，重要的是**您的**要求和优先事项。

我个人喜欢 SqlDependency 类的优雅；无论如何，对于大多数应用程序来说，数据库独立性在现实世界中的重要性是什么？但是，如果您优先考虑拥有数据库独立性，那么您就不能使用它。

轮询是我的第二个最爱，因为它使数据库免受触发器和应用程序逻辑的影响；无论如何，这确实不是一个坏选择，因为正如您所说，它很简单。如果应用程序 B 可以在“注意到”数据库更改之前一次等待几分钟，那将是一个不错的选择。

所以我的回答是：视情况而定。:)

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2009-02-05T00:29:30.737

我会选择#1。实际上，它并没有您想象的那么多流量。如果您的数据不经常更改，您可能会对此感到悲观，并且只获取一些让您对表更改表示赞同或反对的内容。

如果您在设计架构时考虑到了轮询，那么每次轮询可能不会真正产生那么多的命中。

*   如果您只是添加记录，而不是更改它们，那么在特定表上检查最高 id 可能就足够了。

*   如果要全部更新它们，则可以存储时间戳列并对其进行索引，然后查找最大时间戳。

*   并且您可以发送一个 ubber 查询来（有效地）轮询多个表并返回已更改表的列表。

这个答案中没有什么特别聪明，我只是想表明#1 可能不像最初看起来那么糟糕。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T00:01:52.073

1.  你真的关心数据库独立性吗？
2.  为每种具有相同公共接口的数据库类型创建不同的机制真的很难吗？

> 我知道 ODP.NET 中的 OracleDependency，但是其他数据库呢？

SQL Server 有类似的东西，但我从未使用过它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T00:44:02.860

您可以创建一个 MySqlDependency 类，并实现 SqlDependency 或 SqlDependencyForOracle（池化）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-04-01T09:58:38.027

您可以在 a 中使用 SQL 触发器`SQL CLR Database Project`并在该项目中运行您的代码，请参阅：[https ://msdn.microsoft.com/en-us/library/938d9dz2.aspx](https://msdn.microsoft.com/en-us/library/938d9dz2.aspx)

或者，在触发器内部，您可以向您实际想要在触发器上执行的项目`SQL CLR Database Project`发出请求。`SQL CLR Database Project`

# .net - 如何再次重复相同的 ASP.NET MVC 操作？

> ID：513942
> 
> 赞同：2
> 
> 时间：2009-02-04T23:59:01.390
> 
> 标签：.net, asp.net-mvc, routing, actionlink

我有一个名为 List 的操作，它显示搜索结果。它通过查询字符串接收参数，因为它们是可选的。我的方法签名如下所示：

```
public ActionResult List(List<int> categoryIDs, string school, int? stateID, int? page) 
```

CategoryIDs 是一个多选框，我正在通过 GET 请求执行所有操作。我需要做的是在我的视图中创建一个指向下一页的链接，但保留相同的搜索参数。我知道我可以手动构建链接，但可以使用任何内置路由方法，特别是当 categoryID 必须格式化为“？categoryID=1&categoryID=2&categoryID=3”才能绑定到列表时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-02-05T08:43:29.397

我认为默认情况下没有`ActionLink`重载可以帮助您做到这一点。您需要`RouteValueDictionary`使用要包含的参数填充实例。

对于类别列表，请尝试 s/t like`categoryIDs=2,3,4,5`等，因为`RouteValueDictionary`. 之后，在action方法中需要将字符串解析成整数列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-05T04:26:51.210

你应该能够做到这一点：

默认情况下应传入所有当前值。我必须尝试一下，以确保我引用了正确的重载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-20T01:43:41.467

我喜欢将对象作为参数传递给搜索操作，然后将参数对象传递给视图。所以在你的控制器中有一些这样的代码（注意我使用的是[Rob Conery 的 PagedList 类](http://blog.wekeroad.com/blog/aspnet-mvc-pagedlistt/)）：

```
public class SearchParameters {
    public string School { get; set; }
    public int? StateID { get; set; }
    public int? Page { get; set; }

    public SearchParameters GetPage(int page) {
        return new SearchParameters {
            School = School,
            StateID = StateID,
            Page = page
        };
    }
}

public class SearchViewModel {
    public PagedList<[YourResultType]> Results { get; set; }
    public SearchParameters Parameters { get; set; }
}

// ...

public ActionResult Search(SearchParameters parameters) {
    IQueryable<[YourResultType]> query;
    // ... do some stuff to get your search results

    return View("Search", new SearchViewModel {
        Results = query.ToPagedList(parameters.Page - 1), 15),
        Parameters = parameters
    });
} 
```

因此，您的搜索视图继承自通用 ViewPage<T> 并具有如下页面声明：

```
<%@ Page ... Inherits="ViewPage<SearchViewModel>" %> 
```

然后在你的搜索视图中，你可以做这样的事情......

```
<% for(int i = 0; i < Model.Results.TotalPages; i++) { %>
    <%= Html.ActionLink(i + 1).ToString(), "Search",
        Model.Parameters.GetPage(i + 1)) %>
<% } %> 
```

# .net - ASP.NET MVC - Response.Write 代码 - 将其放入 Controller、SingleFile 或 CodeBehind

> ID：513944
> 
> 赞同：3
> 
> 时间：2009-02-05T00:01:33.697
> 
> 标签：.net, asp.net-mvc

如果您要在最后一刻将页面生成为字符串并通过 Response.Write 输出所有内容，您应该将这段代码放在哪里？

我需要能够动态地向客户端编写一堆 JavaScript 以使用一些新的 Google 可视化 jsapi。我注意到 MVC 框架的最新版本“不鼓励”视图上的 CodeBehinds。这真的是演示代码。它应该去哪里？这里的首选方法是什么......我从来都不是“SingleFile”的粉丝。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2009-02-05T00:21:16.370

您还可以使用该`ActionResult`类型`Content`将纯字符串返回给浏​​览器。

```
public ActionResult myAction() {
    Return Content("Hello World!");
} 
```

但是，我不确定这是否是返回 JavaScript 时的最佳方法。您可能要考虑编写自己的`JavaScriptResult`继承`ActionResult`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T00:20:07.603

代码是否可参数化？那就是你可以通过一些小的参数集来控制一个调用和另一个调用之间的差异吗？如果是这样，那么我会考虑编写一个 HtmlHelper 扩展来生成它。然后我会在我的视图中使用扩展来生成代码。如果不能从模型或 RouteValues 派生参数，则从控制器通过 ViewData 将参数传递给视图。

```
<%= Html.GenerateGoogleVisAPI( ViewData["someThing"],
                               ViewData["otherThing"] ) %> 
```

另一种选择是将其制成 ViewUserControl——您可以将模型和 ViewData 传递给该控件。您仍然可以通过视图包含此内容。

```
<% Html.RenderPartial( "GoogleVisControl",
                       ViewData["GoogleVisModel"],
                       ViewData ); %> 
```

**编辑**：

我的 HtmlHelperExtensions 通常放在一个单独的类库项目中。所以我的层次结构看起来像下面这样。请注意，为了简洁起见，我省略了每个级别的相关测试项目，但它们也会在那里。如果您有多个应用程序使用相同的数据层，则数据层可能完全存在于单独的解决方案中，具体取决于您是每个应用程序有一个解决方案还是每个解决方案有多个应用程序。我将项目引用添加到类库项目的 Web 项目中。

```
+-Project.Web
 +-内容
 +-控制器
 +-型号
 +-视图
  +-...
  +-共享
   +-错误.aspx
   +-GoogleVisControl.ascx
   +-LoginUserControl.ascx
   +-Site.Master
   +-...
  +-...
 +-...
+-Project.Common
+-Project.Common.Web
 +-HtmlHelperExtensions.cs
 +-...
+-项目.数据
 +...

```

# .net - 使用 ASP.NET MVC 身份验证的“记住我”不起作用

> ID：513949
> 
> 赞同：15
> 
> 时间：2009-02-05T00:04:28.073
> 
> 标签：.net, asp.net-mvc, cookies, membership

我有一个标准的 ASP.NET MVC（RC 刷新）Web 项目，具有标准的 ASP.NET 成员资格提供程序和项目模板中包含的帐户控制器。

当我在登录表单中选中“记住我”时，网站仍然没有记住我。（Firefox 记住了我的用户名和密码，但我期望发生的是自动登录）。

我必须手动设置和检查 cookie 吗？如果是这样，最好怎么做？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-05T00:28:31.440

您需要将 true/false 传递给 SetAuthCookie 方法。

```
public ActionResult Login (string email, string password, bool rememberMe, string returnUrl)  
{

    // snip

    FormsAuth.SetAuthCookie(username, rememberMe); // <- true/false

    // snip
} 
```

并确保它`bool rememberMe`反映了登录页面上复选框的状态。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2009-02-05T00:25:44.053

您需要在检查记住ME框时处理登录的控制器方法中生成持久cookie。如果您正在使用`RedirectFromLoginPage`，请将 createPersistentCookie 参数设置为`true`。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-07-27T17:35:17.820

这 3 种方法帮助我持久化 cookie。

请注意，如果用户取消选择“记住我”，您将需要删除 cookie。

```
 private const string RememberMeCookieName = "MyCookieName";

        private string CheckForCookieUserName()
        {
            string returnValue = string.Empty;
            HttpCookie rememberMeUserNameCookie = Request.Cookies.Get(RememberMeCookieName);
            if (null != rememberMeUserNameCookie)
            {
                /* Note, the browser only sends the name/value to the webserver, and not the expiration date */
                returnValue = rememberMeUserNameCookie.Value;
            }

            return returnValue;
        }

        private void CreateRememberMeCookie(string userName)
        {
            HttpCookie rememberMeCookie = new HttpCookie(RememberMeCookieName, userName);
            rememberMeCookie.Expires = DateTime.MaxValue;
            Response.SetCookie(rememberMeCookie);
        }

        private void RemoveRememberMeCookie()
        {
            /* k1ll the cookie ! */
            HttpCookie rememberMeUserNameCookie = Request.Cookies[RememberMeCookieName];
            if (null != rememberMeUserNameCookie)
            {
                Response.Cookies.Remove(RememberMeCookieName);
                rememberMeUserNameCookie.Expires = DateTime.Now.AddYears(-1);
                rememberMeUserNameCookie.Value = null;
                Response.SetCookie(rememberMeUserNameCookie);
            }
        } 
```

# c# - 在运行时指定泛型集合类型参数

> ID：513952
> 
> 赞同：25
> 
> 时间：2009-02-05T00:05:29.320
> 
> 标签：c#, generics, casting, runtime

我有：

```
class Car {..}
class Other{
  List<T> GetAll(){..}
} 
```

我想要做：

```
Type t = typeof(Car);
List<t> Cars = GetAll<t>(); 
```

我怎样才能做到这一点？

我想从数据库中返回一个通用集合，该集合是我在运行时使用反射发现的。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2009-02-05T00:10:47.560

```
Type generic = typeof(List<>);    
Type specific = generic.MakeGenericType(typeof(int));    
ConstructorInfo ci = specific.GetConstructor(Type.EmptyTypes);    
object o = ci.Invoke(new object[] { }); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2009-02-05T00:11:32.647

您可以为此使用反射：

```
Type t = typeof(Car);
System.Type genericType= generic.MakeGenericType(new System.Type[] { t});
Activator.CreateInstance(genericType, args); 
```

# rules - 我正在为我的团队编写编程思维规则：你的规则是什么？

> ID：513953
> 
> 赞同：44
> 
> 时间：2009-02-05T00:05:47.960
> 
> 标签：rules

一段时间以来，我一直在编写一份清单，以帮助我分享编程方法的**原因**和想法，以及**如何**做某事。

为此，我想建立一个清单：

*   最佳实践，
*   最好的想法，
*   最好的方法...

这有助于程序员以最有效的方式分析、思考、处理、解决和实施的能力。

我在整个 Stack Overflow 的问题中看到了数十条非常有价值的评论，但我找不到将它们放在一起的地方。关于 Stack Overflow 的观点最有争议。但是，我只是在寻找可以分享并帮助我的团队的明智见解，我通过更好的编程更好地处理和解决问题。

希望这可以成为收​​集一两个简明、深刻且易于分享、重复和回顾的衬里的地方。如果我们对每个答案都保持一条规则，那么投票赞成/反对可能是最容易的。

我将从第一个开始。

**DRY - 不要重复自己 - 在代码、注释或文档中。**

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2009-02-05T00:08:23.383

总是让代码比你找到它时好一点。

* * *

## 回答 #2

> 赞同：52
> 
> 时间：2009-02-05T00:10:08.157

代码在进入[版本控制系统](http://en.wikipedia.org/wiki/Revision_control)之前是不存在的。

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2009-02-05T00:28:41.957

不要害怕承认“我不知道”并问。

10 分钟询问某人可以节省一天的时间拉你的头发！

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2009-02-05T00:14:36.413

**[不要重新发明轮子](http://en.wikipedia.org/wiki/Reinventing_the_wheel)**

如果核心库中*应该*有一个函数 - 可能有。

* * *

## 回答 #5

> 赞同：32
> 
> 时间：2009-02-05T01:04:13.273

**KISS - 保持简单，愚蠢。**
选择最简单的可行解决*方案*。
在需要之前不要让事情变得（太）复杂。
仅仅因为其他人都在使用一些复杂的框架来解决他们的问题，并不意味着你必须这样做。

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2009-02-05T00:27:51.630

**可维护性很重要。**

编写代码，就好像最终维护它的人很疯狂并且知道你住在哪里一样。

* * *

## 回答 #7

> 赞同：27
> 
> 时间：2009-02-05T00:11:49.713

**别人*不会*修。**

如果问题引起您的注意，请拥有足够长的时间以确保以一种或另一种方式处理它。

* * *

## 回答 #8

> 赞同：26
> 
> 时间：2009-02-05T00:18:02.117

除非有明显的问题，否则不要优化。
大多数时候，当人们在证明有必要之前尝试优化代码时，他们会花费大量资源，使代码更难阅读和维护，并且没有明显的效果。有时他们甚至会使情况变得更糟。

> “我们应该忘记小的效率，比如大约 97% 的时间：过早的优化是万恶之源。”
> ——唐纳德·克努斯

* * *

## 回答 #9

> 赞同：24
> 
> 时间：2009-02-05T00:17:21.277

**它能有多难？**
不要让任何问题吓倒你。

* * *

## 回答 #10

> 赞同：23
> 
> 时间：2009-02-05T01:01:12.357

**不要收集需求——挖掘需求**

需求很少停留在表面上。它们深埋在假设、误解和政治的层层之下

通过[务实的程序员](http://www.pragprog.com/the-pragmatic-programmer)

* * *

## 回答 #11

> 赞同：20
> 
> 时间：2009-02-05T00:33:43.083

遵循[SOLID 原则](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)：

**[单一职责原则](http://www.objectmentor.com/resources/articles/srp.pdf)(SRP)**

> 改变班级的理由不应该不止一个。

**[开闭原则](http://www.objectmentor.com/resources/articles/ocp.pdf)(OCP)**

> 软件实体（类、模块、函数等）应该对扩展开放，对修改关闭。

**[里氏替换原则](http://www.objectmentor.com/resources/articles/lsp.pdf)(LSP)**

> 使用指向基类的指针或引用的函数必须能够在不知情的情况下使用派生类的对象。

**[接口隔离原则](http://www.objectmentor.com/resources/articles/isp.pdf)(ISP)**

> 不应强迫客户依赖他们不使用的接口。

**[依赖倒置原则](http://www.objectmentor.com/resources/articles/dip.pdf)（DIP）**

> A. 高级模块不应依赖于低级模块。两者都应该依赖于抽象。
> 
> B. 抽象不应依赖于细节。细节应该取决于抽象。

* * *

## 回答 #12

> 赞同：16
> 
> 时间：2009-02-05T01:08:34.277

我认为“Python 之禅”下列出的几乎所有内容都适用于每个“编程思维规则”列表。从 'python -c "import this"' 开始：

Python 之禅，蒂姆·彼得斯 (Tim Peters)

*   美丽总比丑陋好。
*   显式优于隐式。
*   简单胜于复杂。
*   复杂胜于复杂。
*   平面优于嵌套。
*   稀疏比密集好。
*   可读性很重要。
*   特殊情况不足以打破规则。
*   虽然实用胜过纯洁。
*   错误永远不应该悄无声息地过去。
*   除非明确沉默。
*   面对模棱两可，拒绝猜测的诱惑。
*   应该有一种——最好只有一种——明显的方法来做到这一点。
*   虽然这种方式一开始可能并不明显，除非你是荷兰人。
*   现在总比没有好。
*   虽然从来没有比*现在*更好。
*   如果实现很难解释，那是个坏主意。
*   如果实现很容易解释，那可能是个好主意。
*   命名空间是一个很棒的想法——让我们做更多的事情！

* * *

## 回答 #13

> 赞同：16
> 
> 时间：2009-02-05T07:58:32.080

最佳实践：**用你的大脑**
不要不考虑任何趋势/原则/模式

* * *

## 回答 #14

> 赞同：15
> 
> 时间：2009-02-05T00:13:30.537

**测试驱动开发 (TDD) 让程序员晚上睡得更好**

> 澄清一下：有些人似乎认为 TDD 只是一种不称职的编码人员从 A 到 B 跛行的方式，而不会让所有事情变得太多，如果你知道你在做什么，那就意味着不需要 (unit)测试方法。*这完全忽略了测试驱动开发的重点。*TDD 大约是三件事（更新：显然是四件事）：
> 
> 1.  **重构魔法**。拥有一整套测试意味着您可以进行其他疯狂的重构特技，在应用程序的整个结构之间进行调整，而不会错过由此产生的 200 种疯狂的微妙副作用中的任何一种。即使是最好的程序员也不愿意在没有良好（单元）测试覆盖率的情况下重构他们的核心类和接口，因为如果没有它们，几乎不可能追踪所有小的“涟漪效应”。
>     
>     
> 2.  **及早发现陷阱**。如果您以正确的方式编写测试，则意味着强迫自己考虑所有边缘情况。通常，一旦实际开发开始，这会导致更好的设计选择，因为编码人员已经考虑了一些可能需要不同继承结构或更灵活设计模式的棘手情况。在初始规划和分析期间，这些更改的需求通常并不明显或不直观，但这些确切的更改可以使应用程序更容易扩展和维护。
>     
>     
> 3.  **确保编写测试**。TDD 要求您在编写代码之前编写测试。当然，这可能会让人头疼，因为与编写*实际*代码相比，编写测试是乏味的——而且通常也需要更长的时间。但是，这样做是确保编写测试的唯一方法。如果您认为代码完成后您会记得编写测试，那您几乎总是错的。
>     
>     
> 4.  **强迫你写出更好的代码**。由于 TDD 强制所有代码都是可测试的（在对其进行测试之前，您不会编写代码），因此它需要您编写更多解耦代码，以便您可以单独测试组件。所以 TDD 迫使你编写更好的代码。（*谢谢，Esko*）

* * *

## 回答 #15

> 赞同：15
> 
> 时间：2009-02-05T08:29:07.587

在你问你的同事并打断他的编码之前先谷歌一下。

* * *

## 回答 #16

> 赞同：13
> 
> 时间：2009-02-05T00:18:41.790

更少的代码总比更多的好，只要它比大量的代码更有意义。

* * *

## 回答 #17

> 赞同：13
> 
> 时间：2009-02-05T01:10:09.767

**懒惰的程序员的习惯**

当你第一次被要求做某事时，就去做（对）。

第二次要求您执行此操作时，请制作一个自动执行此操作的工具。

第三次，如果工具不能解决问题，请设计一种特定领域的语言来生成更多工具。

*（不要太认真）*

* * *

## 回答 #18

> 赞同：10
> 
> 时间：2009-02-05T00:58:13.410

**成为变革的催化剂**

你不能强迫人们改变。相反，向他们展示未来的样子并帮助他们参与创造它。

通过[务实的程序员](http://www.pragprog.com/the-pragmatic-programmer)

* * *

## 回答 #19

> 赞同：10
> 
> 时间：2009-02-05T01:08:38.117

**调试时不要惊慌**

深呼吸并思考！关于可能导致该错误的原因。

通过[务实的程序员](http://www.pragprog.com/the-pragmatic-programmer)

* * *

## 回答 #20

> 赞同：10
> 
> 时间：2009-02-05T01:10:48.767

**您可以复制和粘贴以使其正常工作，但您不能保持这种状态。**

重复的代码是一个中间步骤，而不是最终产品。

* * *

## 回答 #21

> 赞同：9
> 
> 时间：2009-02-05T00:59:34.030

**这既是你所说的，也是你所说的方式**

如果你不能有效地传达它们，那么有伟大的想法是没有意义的。

通过[务实的程序员](http://www.pragprog.com/the-pragmatic-programmer)

* * *

## 回答 #22

> 赞同：9
> 
> 时间：2009-02-05T08:02:46.173

> **始终编​​写代码，就好像最终维护您的代码的人是一个知道您住在哪里的暴力精神病患者一样。**

来自：[编码恐怖](https://blog.codinghorror.com/coding-for-violent-psychopaths/)

* * *

## 回答 #23

> 赞同：7
> 
> 时间：2009-02-05T00:07:17.273

**尽早发布，经常发布**

* * *

## 回答 #24

> 赞同：7
> 
> 时间：2009-02-05T00:11:57.497

Build Breaker 购买午餐

* * *

## 回答 #25

> 赞同：7
> 
> 时间：2009-02-05T00:34:51.927

首先正确构建它。让它快第二。

* * *

## 回答 #26

> 赞同：7
> 
> 时间：2009-02-06T06:36:32.943

**经常进行代码审查**

代码审查和重构是一项持续的任务。在我看来，这里有一些关于代码审查的好处：

1.  它提高了代码质量。
2.  它有助于将可重用代码重构为可重用库。
3.  它可以帮助您向其他开发人员学习。
4.  它可以帮助您从错误中吸取教训，并刷新您对以前编写的天才代码的记忆。

* * *

## 回答 #27

> 赞同：6
> 
> 时间：2009-02-05T00:40:39.357

任何可能影响应用程序运行方式的东西都应该被视为代码，这意味着将其置于版本控制中。尤其是构建脚本和数据库架构和数据 (.sql) 文件。

* * *

## 回答 #28

> 赞同：5
> 
> 时间：2009-02-05T00:09:00.857

**[约定优于配置](http://en.wikipedia.org/wiki/Convention_over_configuration)**

特别是在约定很强大并且可以牺牲一些灵活性的情况下。

* * *

## 回答 #29

> 赞同：5
> 
> 时间：2009-02-05T01:53:15.700

**参与开源开发**

如果您在项目中使用开源代码，请记住将您的错误修复和改进发布回社区。*这本身*不是一个开发最佳实践，但它绝对是程序员努力争取的心态。

* * *

## 回答 #30

> 赞同：5
> 
> 时间：2009-02-05T12:40:51.290

**了解您使用的工具**

在你明白为什么要使用它之前，不要使用它；不要在不知道为什么的情况下使用工具；不要依赖你的框架或语言设计器总是适合你的情况，但也不要假设他们是错误的，直到被证明是错误的！

* * *

## 回答 #31

> 赞同：4
> 
> 时间：2009-02-05T01:05:28.340

**思考！关于你的工作**

关闭自动驾驶仪并进行控制。不断地批评和评价你的工作。

通过[务实的程序员](http://www.pragprog.com/the-pragmatic-programmer)

* * *

## 回答 #32

> 赞同：4
> 
> 时间：2009-02-05T02:12:08.860

把你的工作想象成一门手艺，而不是一项职责。

* * *

## 回答 #33

> 赞同：4
> 
> 时间：2009-02-05T10:30:47.463

**退一步看全图**

每隔一段时间，你应该从你的代码中退后一步，用抽象的术语思考你在做什么。如果你不这样做，你会忽略几天后会回来咬你的东西。

我喜欢深入研究代码，但有时我需要回到表面呼吸一些空气……

* * *

## 回答 #34

> 赞同：3
> 
> 时间：2009-02-05T00:23:00.970

计划第一，设计第二，代码第三，始终测试。

* * *

## 回答 #35

> 赞同：3
> 
> 时间：2009-02-05T01:09:23.433

1.  受众——我们构建的一切都是为了受众，最终用户和其他编码人员都将使用它。确保两者都可以使用。

2.  简单——如果你发现自己实现了一些复杂而令人费解的东西，你可能会错过一个更有效、更简单的解决方案。

3.  质量，而不是完美——记住什么是重要的——在一个时间范围内提供质量。如果您将估算值翻倍，那么提供完美将无法节省您的时间。

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2009-02-05T12:14:03.137

[如果你被卡住了，就说出来（即使你只和橡皮鸭](http://c2.com/cgi/wiki?RubberDucking)说话）

* * *

## 回答 #37

> 赞同：3
> 
> 时间：2009-02-08T00:59:00.033

**永远不要告诉企业一切！**

重构是你工作的一部分，而不是需要讨论的事情。如果您总是添加一点“估计”时间来进行必要的重构，那么就不会有任何抱怨！

* * *

## 回答 #38

> 赞同：2
> 
> 时间：2009-02-05T00:11:35.063

**设计模式是你的朋友**

确保将《[四人帮》](http://en.wikipedia.org/wiki/Design_Patterns)的副本放在某处作为参考。

* * *

## 回答 #39

> 赞同：2
> 
> 时间：2009-02-05T01:14:33.593

***不一定是艺术，但一定要准时***

新闻界的一条老规矩，我必须通过艰苦的方式学习。

* * *

## 回答 #40

> 赞同：2
> 
> 时间：2009-02-05T11:12:18.690

始终构建原型。十分之九，这将是值得的一天/一周/一个月。推论：在原型上花费的时间长度应该与主要项目的长度/大小成正比。

* * *

## 回答 #41

> 赞同：2
> 
> 时间：2009-02-05T20:19:11.363

**[雅尼](http://en.wikipedia.org/wiki/You_aren%27t_gonna_need_it)**

**你不需要它**

批评你的所作所为，AKA 认为！

* * *

## 回答 #42

> 赞同：2
> 
> 时间：2009-02-05T23:46:57.543

请参阅博客文章*[实用程序员快速参考指南](http://www.codinghorror.com/blog/files/Pragmatic%20Quick%20Reference.htm)*。*

* * *

## 回答 #43

> 赞同：2
> 
> 时间：2009-02-06T13:21:46.870

**[数量永远胜过质量](http://www.codinghorror.com/blog/archives/001160.html)**

编码更多（即使它不是很好）将使您更好地了解好的代码应该是什么样子。

* * *

## 回答 #44

> 赞同：1
> 
> 时间：2009-02-05T00:34:11.040

宣布一切。永远不要将 15 个函数嵌套到 1 个变量中。

* * *

## 回答 #45

> 赞同：1
> 
> 时间：2009-02-05T00:43:14.500

与其说“我不知道”，不如说“我想知道”。它将您的方法从避免/反应转变为主动发现和增长。

* * *

## 回答 #46

> 赞同：1
> 
> 时间：2009-02-05T00:43:48.167

**红色，绿色，重构！**

TDD 或[测试驱动开发](http://www.agiledata.org/essays/tdd.html)。

1.  为您要开发的功能编写测试，确保它们失败，因为您还没有编写任何代码。

2.  编写使测试通过所需的最少代码量。

3.  根据需要进行重构，以提高效率或清晰度。

4.  重构后，确保您的测试仍然通过。

* * *

## 回答 #47

> 赞同：1
> 
> 时间：2009-02-05T05:04:36.267

这来自史蒂夫麦康奈尔

“每一行新代码都应该通过调试器单步执行”

* * *

## 回答 #48

> 赞同：1
> 
> 时间：2009-02-05T10:42:25.490

**从来没有你想的那么容易**

这是对另一个[答案](https://stackoverflow.com/questions/513953/i-am-compiling-a-rules-of-programming-mindset-for-my-team-what-are-yours/513984#513984)的回应，但并不矛盾！两者都是应遵循的宝贵原则。

* * *

## 回答 #49

> 赞同：1
> 
> 时间：2009-02-05T20:32:32.537

对于数据库...

**尽可能标准化。然后再次正常化。**

拥有一个良好的数据库（在结构和数据方面）对于减轻编程压力至关重要。

* * *

## 回答 #50

> 赞同：1
> 
> 时间：2009-02-06T06:49:06.133

您的代码应该非常简单，以至于任何查看它的人都可以在不阅读任何文档的情况下理解它的作用。

但无论如何不要忘记记录所有内容。

如果您的 API 使用起来不是很简单，那么 API 就有问题。重构它，直到不费吹灰之力就能正确使用。

在您编写任何代码之前，请先研究一下框架是否已经为您尝试做的事情提供了内置支持或可扩展接口。

* * *

## 回答 #51

> 赞同：1
> 
> 时间：2009-02-06T06:57:48.907

尽早发现错误：

*   使用静态类型语言，以便编译器和静态分析可以帮助您。
*   单元测试（第一个或最后一个）
*   代码审查
*   持续集成
*   最后，最重要的事情——持续学习。

* * *

## 回答 #52

> 赞同：0
> 
> 时间：2009-02-05T00:47:36.707

了解[SOLID](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)原则（或任何其他原则或方法）的意图。

* * *

## 回答 #53

> 赞同：0
> 
> 时间：2009-02-05T01:07:21.597

**有些事情做得比描述的要好**

不要陷入规范螺旋——在某些时候你需要开始编码。

通过[务实的程序员](http://www.pragprog.com/the-pragmatic-programmer)

* * *

## 回答 #54

> 赞同：0
> 
> 时间：2009-02-05T01:16:39.083

努力寻找需要最少代码的解决方案。

* * *

## 回答 #55

> 赞同：0
> 
> 时间：2009-02-05T02:01:57.680

**创建软件就像……盖房子。**

您可以尝试在没有蓝图、计划、经验、建筑师或合格技工的情况下构建它。

因此，它几乎总是会花费更多、花费更长的时间，并且充满未来、持续不断的惊喜，需要你的时间和金钱。

仅仅因为有人可以在没有蓝图的情况下建造棚屋并不意味着他们应该这样做。

* * *

## 回答 #56

> 赞同：0
> 
> 时间：2009-02-05T02:07:05.610

我在上一份工作中为我的团队创建了一个文档，因为他们没有*任何*编程指南、建议或任何东西……它开始变得相当大，但一切都说得通。

我很乐意分享。但这不仅仅是一条规则，它更像是“编码指南”。

以下是我的文档包含的示例大纲：

```
        A. 源代码
           一种。格式化
           湾。变量命名
           C。错误处理
           d。日志记录
           e. 文本编辑器
           F。范围声明
           G。评论/评论块
           H。文档
           一世。API/库开发标准

       B. 源代码控制
          一种。入住/退房
          湾。版本信息
          C。什么属于源代码管理？

```

这是A部分的一个例子。

* * *

```
 ## 源代码 
文本编辑器：
```

文本编辑器的选择完全取决于开发人员。字体应该是等距的，不大于 18 并且不小于 8。虽然这是开发人员的选择，但代码注释应该出现在源文件的顶部，指示哪个编辑器、字体、字体大小以及缩进大小（如果适用）应该在场。有关更多信息，请参阅评论/评论块。

```
标签：
```

标签不应该在源文件中。制表符应替换为空格，并且缩进为 4。

```
行尾：
```

行尾应采用 CRLF 格式。大多数 {your company name} 源代码都在 Windows 平台上，因此应将行尾设置为 CRLF 以便在 Windows 上可读。任何源文件中都不应混合行尾。

```
线长：
```

大多数行的行长不应超过 200 个字符。很长的单语句源行是可以接受的。函数定义或函数调用应该被分解（并记录在案）。（有关更多信息，请参阅 API/库部分。）

* * *

当然，这适用于美国，您的 MMV，您必须调整规则以匹配您的编码风格。

* * *

## 回答 #57

> 赞同：0
> 
> 时间：2009-02-05T08:20:11.723

不要试图让事情变得更简单。

知道你在做什么比单元测试更可取。

了解技术优于测试驱动开发。

你为什么要用反复试验的方法来浪费你的生命？

* * *

## 回答 #58

> 赞同：0
> 
> 时间：2009-02-05T11:45:29.653

“我只是看不到它怎么会失败”只是“它会失败，我只是看不到如何”，并且重新排列了单词。测试一切！

* * *

## 回答 #59

> 赞同：0
> 
> 时间：2009-02-05T13:28:13.877

1.  理解/演练好的、**坏的和丑陋**的应用程序代码。您将更好地了解哪些有效，哪些无效。

2.  **与人（包括 IT 和业务）交谈，**不要害怕提出问题。这以两种方式对您有用：-

    a) 你变得更平易近人，因为你看起来比*不说话的书呆子更人性化*

    b) 您对应用程序进行编码/设计的方法是基于真实的答案——不仅仅是文档/电子邮件，这可能已经过时了。

* * *

## 回答 #60

> 赞同：0
> 
> 时间：2009-02-06T08:23:38.373

始终为您的代码编写文档！半年后你不会记得它是如何工作的。所以不要在没有文档的情况下编写任何代码！

* * *

## 回答 #61

> 赞同：0
> 
> 时间：2009-02-06T19:19:45.523

第一次从来都不容易。之后每次都可以轻松完成。这就像你第一次开车去某个地方时试图找到一条捷径。在 GPS 之前。

* * *

## 回答 #62

> 赞同：0
> 
> 时间：2009-02-08T00:54:06.363

**根据定义，没有单元测试的代码是被破坏的。**

不言自明。

* * *

## 回答 #63

> 赞同：0
> 
> 时间：2009-03-10T00:46:07.767

对某事（流程/软件）知之甚少的人是世界上最危险的人。

* * *

## 回答 #64

> 赞同：0
> 
> 时间：2009-04-11T19:59:13.983

编写不言自明的代码（然后仍然记录它），其中包括

*   有意义的名称避免缩写，尤其是辅音簇
*   刚刚引入的函数使真实代码像伪代码一样读取
*   在一个代码单元等内保持抽象级别不变。

# c# - C# - 如何按日期对 DataTable 进行排序

> ID：513961
> 
> 赞同：6
> 
> 时间：2009-02-05T00:08:51.963
> 
> 标签：c#, date, datatable

我有一个包含日期列的数据表，但我不知道如何按该列对其进行排序。有什么建议么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2009-02-05T00:12:21.707

```
DataView view = DataTable.DefaultView;
view.Sort = "DateColumn"; 
```

# linux - ssh 和窗口 ID

> ID：513968
> 
> 赞同：2
> 
> 时间：2009-02-05T00:10:57.827
> 
> 标签：linux, ssh, solaris, debian, x11

我在学校有一个项目要做，这让我感到困惑......我正在通过我自己的 Debian 盒子通过 SSH 连接到计算机实验室的一台 Solaris 计算机

```
ssh -Y name@***.cs.<school> 
```

我可以很好地进入，X11 似乎也可以正常工作。然而，这个特殊的项目需要我们通过 xwininfo 找到一个 netscape 窗口的窗口 id，并在下面的命令中使用这个信息

```
netscape -id 0xa00029 -remote 'openFile(/path/to/html/file)' 
```

现在，如果这个 netscape 是我打开的唯一窗口（xterm 除外），那么前面的命令就可以正常工作。但是，如果我打开了任何其他 iceweasel 窗口（无论我打开 netscape/iceweasel 的顺序如何），该命令将转发到我的 iceweasel，尽管事实上我在 SSH 会话中运行该命令**并且**两个窗口非常不同的窗口ID。

所有这些最终都必须进入一个 C 程序，但我什至无法手动让它可靠地工作！

有任何想法吗？

PS我刚刚看到这可能会有所帮助。当我使用相同的命令通过 Cygwin/X 进行 SSH 连接时，出现此错误

```
Warning: No xauth data; using fake authentication data for X11 forwarding. 
```

不确定这是否重要，因为我仍然可以（显然）完美地使用 X11。

谢谢。

PPS -id 开关记录在 netscape 手册页中：

```
-id window-id
      Identifies an X window to receive -remote commands.  If
      you do not specify a window, the first window found is
      used. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T00:35:22.207

当您使用 ssh -Y 时，您请求将远程客户端转发到具有完全权限的本地 X 服务器。Netscape/Mozilla/Firefox/Iceweasel/等。远程协议通过 X 服务器运行，因此它也会被转发。

[http://www.mozilla.org/unix/remote.html](http://www.mozilla.org/unix/remote.html)记录了协议，并没有提及`-id`. 快速查看源代码（例如，[http](http://mxr.mozilla.org/seamonkey/source/widget/src/xremoteclient/XRemoteClient.cpp#202) ://mxr.mozilla.org/seamonkey/source/widget/src/xremoteclient/XRemoteClient.cpp#202 ）看起来也没有希望有一个`-id`选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-02-08T22:06:44.683

我坐在一台实际的机器上执行相同的测试，它们也都失败了……我会打开 2 个 netscape 窗口并尝试一次将命令定向到一个。最近打开的一个可以正常工作，但是任何指向另一个的命令都会被转发到同一个窗口，所以在这一点上，我确信问题在于命令没有正确执行和/或该系统上的所有内容**真的，真的**老了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-07-29T22:26:32.463

> 如果我打开了任何其他 iceweasel 窗口（无论我打开 netscape/iceweasel 的顺序如何），该命令将转发到我的 iceweasel，尽管事实上我在 SSH 会话中运行该命令并且两个窗口具有非常不同的窗口身份证

Iceweasel 就是这样编码的。它试图为该用户的所有打开的窗口只运行一个进程。

使用`-no-remote`命令行选项来避免它。看`http://kb.mozillazine.org/Command_line_arguments`

# silverlight - Silverlight MVVM 应用程序中服务定位器的用途是什么？

> ID：513977
> 
> 赞同：4
> 
> 时间：2009-02-05T00:13:47.477
> 
> 标签：silverlight, mvvm

我正在尝试为我的 MVVM Silverlight 应用程序整合所有部分，并且我看到一些博客涉及服务定位器。

什么是服务定位器，什么时候应该使用它？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2009-02-05T08:38:29.003

我将 ServiceLocator 与 MVVM 结合使用，以启用从 View 到 ViewModel 的声明性绑定。

ServiceLocator 是基于拉的，而 IoC 容器是基于推的。例如：

如果您使用 IoC 容器，您可能会创建如下内容：

```
public MyViewModel(IDataRepository repository)
{
} 
```

IoC 容器将在构造对象时将 IDataRepository 实例推送到对象中。

如果您使用 ServiceLocator，您通常会编写如下代码：

```
public MyViewModel()
{
    _repository = ServiceLocator.Instance.DataRepository;
} 
```

因此，在这种情况下，ViewModel 正在从 ServiceLocator 中提取 IDataRepository 接口的一个实例。

ServiceLocator 可能由 IoC 容器支持（但不是必需的）。

这样做的好处是您可以将 ServiceLocator 作为资源添加到 App.xaml 文件中，然后以声明方式从视图中访问它。

```
<UserControl 
    DataContext="{Binding Path=MyViewModel, 
                  Source={StaticResource serviceLocator}}">...</UserControl> 
```

MyViewModel 可能由 IoC 容器创建，但它是使用数据绑定和 ServiceLocator 拉入视图的。

我的[博客上有一篇关于 Silverlihgt/MVVM 上下文中的依赖注入、IoC 和 ServiceLocators 的](http://jonas.follesoe.no/2008/07/24/youcard-re-visited-implementing-dependency-injection-in-silverlight/)博文。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T03:58:07.197

服务定位器是一种类似于依赖注入的设计模式。

它允许消费者针对接口而不是具体类进行编程。

查看CodePlex 上托管的[Common Service Locator 。](http://www.codeplex.com/CommonServiceLocator)

# ruby-on-rails - Windows 上的“rails”命令

> ID：513981
> 
> 赞同：2
> 
> 时间：2009-02-05T00:14:52.170
> 
> 标签：ruby-on-rails

所以我使用 Windows Installer 安装了 Ruby On Rails。

现在启动指南说我必须启动一个终端并运行 Rails 命令来创建一个项目。我没有终端，如何执行 Rails 命令并创建项目？

Windows 中的 CMD 命令行无法识别“rails”

我不认为这是一个 PATH 问题，因为当我在“Bin”目录中时，有“rails.bat”和“rails”没有扩展名。如果我运行 Rails.bat，我会收到“文件名、目录名或卷标语法不正确”。

无论我传递什么参数，我都会收到该消息。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2009-02-05T00:54:56.147

由于双引号，这似乎是 rails.bat 文件中的错误，例如：

```
@"ruby.exe"" "%~dpn0" %* 
```

去掉双引号：

[http://sepitfalls.blogspot.com/2008/12/updateing-rubygems-broke-gem-command.html](http://sepitfalls.blogspot.com/2008/12/updateing-rubygems-broke-gem-command.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-02-05T00:19:34.720

**获取终端**

1.  开始 > 运行... 或 Windows 键 + R

2.  输入“cmd”并回车。

**将文件夹添加到命令行的路径**

在 Windows XP 上（Vista 类似）

开始 > 控制面板 > 系统

单击“高级”选项卡

点击“环境变量”

在“系统变量”下双击路径并进行相应的编辑。

您需要打开一个新的命令行才能使更新的路径生效。使用 XP，我不得不重新启动以强制它生效，但这不是必需的。

* * *

Path 变量是一个以分号分隔的文件夹列表，命令行或“终端”在其中查找命令。

您可能必须自己找到 rails 命令。我会尝试寻找 rails.bat 或 rails.cmd 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-02-05T00:18:09.417

我认为他们的意思是命令窗口。尝试从命令行运行它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2009-02-05T00:37:46.650

我不知道 Windows Ruby on Rails intaller 将其文件放在哪里，但最终的解决方案是您需要确保“rails”命令是您的 PATH - 您可以通过右键单击“我的电脑”来查看/修改它，选择属性，转到高级选项卡，然后单击“环境变量”，然后向下滚动，直到看到“PATH”并相应地调整它。您可能需要找到“rails”命令所在的目录并附加到现有 PATH 条目的末尾，插入一个“;” 在输入新路径以将其附加到现有 PATH 之前。

因此，找到“rails”的位置并将其目录添加到您的 PATH 中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2009-02-05T00:38:39.550

您可能必须更改 Windows 中的 PATH 以指向安装了 rails 可执行文件的位置。

PATH 环境变量用于确定 Windows 查找内容的位置；例如，当您键入“calc”时，Windows 将搜索其 PATH 并最终找到并运行 C:\Windows\calc.exe。在您的情况下，PATH 不包含您需要的目录，因此当您键入“rails”时，Windows 不会在该目录中搜索 rails.exe。

要解决此问题，请右键单击“我的电脑”->“属性”->“高级”->“环境变量”，然后修改 PATH 以包含您的 rails.exe 所在的目录。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2009-02-05T01:08:11.737

我建议在 Windows 上使用 cygwin 进行 Rails 开发 - 太多的社区正在使用 *nix。如果您安装了开发工具包，您将自动拥有 svn、git 和其他与各种 rails 插件安装相关的最终需要的 doo-dad。如果您想使用 capistrano 进行部署，则安装与您找到的所有说明相同。此外，人们将参考的其他提示和技巧对您的工作与对他们的工作完全相同，而对于本机 Windows，有些事情是不同的，并且所有附件工具都必须单独安装。

# wpf - 带有 .Net 3.5 无 sp1 的 WPF 工具包数据网格

> ID：513985
> 
> 赞同：0
> 
> 时间：2009-02-05T00:17:24.803
> 
> 标签：wpf, .net-3.5, datagrid, wpftoolkit

我一直在尝试在我公司内部部署的 WPF 应用程序中使用 WPF 工具包，但该工具包需要 .Net 3.5 sp1。该工具包的 sp0 和 sp1 之间的唯一区别是使用的`MultiSelector`类`DataGrid`。

我的问题是，有没有人知道解决方法，所以不需要 sp1？有`MultiSelector`我可以使用的自定义类吗？

我知道该工具包是在 sp1 之前启动的，但我不确定在`MultiSelector`添加之前取得了什么样的进展。

我尝试使用`ILDasm`来获取`MultiSelector`该类的 IL 代码并生成我自己的代码，但我没有取得任何成功，因为它`Selector`在`PresentationFramework.dll`.

在这个问题上的任何帮助都会很好，并且将每个人都升级到 .Net 3.5 sp1 目前不是一个选择。

如果有人知道另一个`DataGrid`可以用来代替 WPF 工具包的免费控件，我们也将不胜感激。

谢谢，

-诺亚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-02-05T01:02:11.873

您将无法使用不同的 MultiSelector，因为工具包中的 MultiSelector 对 SP1 版本框架中的类型具有硬引用。即使您确实创建了自己的 MultiSelector 以供使用，您也必须更改网格控件以使用您的，这需要将其反编译为源代码，修改它，然后重新编译它，这超出了 PITA 的范围，可能违反了EULA 也是如此。

至于免费的数据网格替代方案，我会查看 Xceeds DataGrid for WPF。Express 版是免费的：

[http://xceed.com/Grid_WPF_Intro.html](http://xceed.com/Grid_WPF_Intro.html)

# .net - .NET：如何将图像加载到 ImageList 中？

> ID：513995
> 
> 赞同：1
> 
> 时间：2009-02-05T00:21:48.070
> 
> 标签：.net, image, imagelist

我有一个包含一系列图像的图像，例如：

> [![在此处输入图像描述](https://i.stack.imgur.com/MzWW1.png)](https://i.stack.imgur.com/MzWW1.png)

在过去，我会使用以下 API 调用将图像加载到[ImageList 通用控件中：](http://msdn.microsoft.com/en-us/library/bb761389(VS.85).aspx)

*   [ImageList_Add](http://msdn.microsoft.com/en-us/library/bb761512(VS.85).aspx)
*   [ImageList_LoadImage](http://msdn.microsoft.com/en-us/library/bb761557(VS.85).aspx)
*   [IImageList::添加](http://msdn.microsoft.com/en-us/library/bb761435(VS.85).aspx)

[使用.NET ImageList 类](http://msdn.microsoft.com/en-us/library/system.windows.forms.imagelist.aspx)实现相同结果的 .NET 方法是什么？

* * *

**注意：**图像只是一个例子。我的实际图像是一个传统的工具栏图像列表图像，有 179 个 16x16 按钮图像。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-02-05T00:29:27.977

使用 imageList1.Images.Add() 怎么样？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2009-02-05T01:09:12.327

听起来您正在尝试添加包含在单个图像对象中的多个图像。在这种情况下，你想使用

图像列表1.图像。[AddStrip](http://msdn.microsoft.com/en-us/library/system.windows.forms.imagelist.imagecollection.addstrip.aspx) (imageSeries)

来自[msdn 文档](http://msdn.microsoft.com/en-us/library/system.windows.forms.imagelist.imagecollection.addstrip.aspx)：“条带是单个图像，被视为并排排列的多个图像”

# jquery - JQuery .get vs load() 性能问题

> ID：513997
> 
> 赞同：8
> 
> 时间：2009-02-05T00:22:30.953
> 
> 标签：jquery

是不是更好用

```
$.get("http://www.example.com/mydirectory", function(data) {
        $(".someclass").html(data);
}); 
```

或者

```
$('.tripPlannerBottom').load("http://www.example.com/mydirectory"); 
```

任何速度或性能优势？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2009-02-05T00:28:46.480

我没有基准数据来支持我的主张，但通过查看源代码，$.get + html() 和 .load() 基本相同。.load() 是 .get() + html() 的便捷包装器

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2009-02-05T08:23:15.103

.load、.get 和 .post 是 .ajax 方法的包装器。如果使用 .ajax 方法，除了您在键入时无需创建设置而节省的几个字符之外，没有性能提升。*********