# StackOverflow 问答 000759000-000759999

# mysql - 在同一列中引用外键

> ID：759008
> 
> 赞同：2
> 
> 时间：2009-04-17T04:20:21.990
> 
> 标签：mysql, database-design, polymorphic-associations

我正在为 mysql 设计一个 bd 方案。我的数据库存储 3 种点：a、b 或 c，路径由 n 对点组成：

路线 = [ (a1 or b1 or c1 ; a2 or b2 or c2), (a2 or b2 or c2 ; a3 or b3 or c3), ...]

```
create table a_points (
    point_id    serial      not null,
    owner_id    bigint unsigned not null,
    name        varchar(20) not null,

    primary key (point_id),
    foreign key (owner_id) references othertable (other_id)
    ) engine = InnoDB;

create table b_points (
    point_id    serial      not null,
    owner_id    bigint unsigned not null,
    name        varchar(20) not null,
    fields      varchar(20) not null,

    primary key (point_id),
    foreign key (owner_id) references othertable (owner_id)

    ) engine = InnoDB;

create table c_points (
    point_id    serial      not null,
    name        varchar(20) not null,
    cfields     varchar(20) not null,

    primary key (point_id)
    ) engine = InnoDB;

create table paths (
    path_id serial          not null,
    name        varchar(20) not null,

    primary key (path_id)
    ) engine = InnoDB;

create table point_pairs (
    pair_id     serial      not null,
    path_id bigint  unsigned    not null,
    point_from  bigint unsigned not null,
    point_to    bigint unsigned not null,
    table_from  varchar(9)  not null,
    table_to    varchar(9)  not null,

    primary key (pair_id),
    foreign key (path_id) references paths (path_id)
    ) engine = InnoDB; 
```

(*) 一对点是 (m, n) 或从 m 到 n

So I'm storing pair of points together with their path's id. My problem is that I had to create two columns identifying the tables' name of m and n. table_from for m and table_to for n. Thus I'd have to use these two columns in my code to know what kind of points are saved in a route (path and point_pairs table). My question: Does MySql provide something for referencing n foreign keys in the same column? I already thought about joining a, b and c point tables but I'd have to add a type column to this new table and my php classes would become useless.

Thanks in advance!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2009-04-17T05:08:19.470

You're using a pattern called Polymorphic Associations, and no, there's no way to do that and use foreign keys to enforce referential integrity.

I suggest you make one common table that `a_points`, `b_points`, and `c_points` reference. Then your point pairs can reference that common table.

```
a_points -->
b_points -->  common_points  <-- point_pairs
c_points --> 
```

In other words, the way to make Polymorphic Associations work is to reverse the direction of the reference.

# c - 我可以比较浮点数并将其添加到 C 中的整数吗？

> ID：759014
> 
> 赞同：20
> 
> 时间：2009-04-17T04:23:28.610
> 
> 标签：c, floating-point, integer

我可以将浮点数与整数进行比较吗？

浮点数会与代码中的整数进行比较吗？

```
float f;     // f has a saved predetermined floating-point value to it  
if (f >=100){__asm__reset...etc} 
```

还有，我能不能...

```
float f;
int x = 100;
x+=f; 
```

我必须使用从姿态参考系统接收到的浮点值**f来调整控制 PWM 信号以校正姿态的位置值****x**。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2009-04-17T04:30:53.070

第一个会正常工作。100 将被转换为浮点数，IEE754 可以将所有整数完全表示为浮点数，最多约为 2 ^(23)。

第二个也可以，但首先会转换为整数，因此您将失去精度（如果您将浮点数转换为整数，这是不可避免的）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2009-04-17T07:28:33.860

Since you've identified yourself as unfamiliar with the subtleties of floating point numbers, I'll refer you to this fine paper by David Goldberg: [What Every Computer Scientist Should Know About Floating-Point Arithmetic](http://www.validlab.com/goldberg/paper.pdf) ([reprint](http://docs.sun.com/source/806-3568/ncg_goldberg.html) at Sun).

After you've been scared by that, the reality is that *most* of the time floating point is a huge boon to getting calculations done. And modern compilers and languages (including C) handle conversions sensibly so that you don't have to worry about them. Unless you do.

The points raised about precision are certainly valid. An [IEEE float](http://en.wikipedia.org/wiki/IEEE_floating-point_standard) effectively has only 24 bits of precision, which is less than a 32-bit integer. Use of `double` for intermediate calculations will push all rounding and precision loss out to the conversion back to `float` or `int`.

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2009-04-17T18:19:50.253

Mixed-mode arithmetic (arithmetic between operands of different types and/or sizes) is legal but fragile. The C standard defines rules for type promotion in order to convert the operands to a common representation. Automatic type promotion allows the compiler to do something sensible for mixed-mode operations, but "sensible" does not necessarily mean "correct."

To really know whether or not the behavior is correct you must first understand the rules for promotion and then understand the representation of the data types. In *very* general terms:

*   shorter types are converted to longer types (`float` to `double`, `short` to `int`, etc.)
*   integer types are converted to floating-point types
*   signed/unsigned conversions favor avoiding data loss (whether signed is converted to unsigned or vice-versa depends on the size of the respective types)

Whether code like `x > y` (where `x` and `y` have different types) is right or wrong depends on the values that `x` and `y` can take. In my experience it's common practice to prohibit (via the coding standard) implicit type conversions. The programmer must consider the context and explicitly perform any type conversions necessary.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2009-04-17T05:49:46.487

Can you compare a float and an integer, sure. But the problem you will run into is precision. On most C/C++ implementations, float and int have the same size (4 bytes) and wildly different precision levels. Neither type can hold all values of the other type. Since one type cannot be converted to the other type without loss of precision and the types cannot be native compared, doing a comparison without considering another type will result in precision loss in some scenarios.

What you can do to avoid precision loss is to convert both types to a type which has enough precision to represent all values of float and int. On **most** systems, double will do just that. So the following usually does a non-lossy comparison

```
float f = getSomeFloat();
int i = getSomeInt();
if ( (double)i == (double)f ) { 
   ...
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2009-04-17T04:35:35.667

LHS 定义了精度，所以如果你的 LHS 是 int 而 RHS 是 float，那么这会导致精度损失。

还可以看看 FP 相关的[CFAQ](http://c-faq.com/fp/index.html)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2009-04-17T05:40:20.143

Yes, you can compare them, you can do math on them without terribly much regard for which is which, in most cases. But only most. The big bugaboo is that you can check for `f<i` etc. but should not check for `f==i`. An integer and a float that 'should' be identical in value are not necessarily identical.

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2009-04-17T04:26:43.067

是的，它会正常工作的。具体来说，为了转换的目的，int 将被转换为 float。在第二个中，您需要强制转换为 int 但否则应该没问题。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2009-04-17T05:32:57.010

是的，有时它会完全符合您的预期。

正如其他人所指出的那样，比较例如 1.0 == 1 会起作用，因为在比较之前整数 1 是类型转换为`double`(not `float`) 的。

但是，其他比较可能不会。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2010-10-28T08:41:22.647

About that, the notation 1.0 is of type double so the comparison is made in double by type promotion rules like said before. 1.f or 1.0f is of type float and the comparison would have been made in float. And it would have worked as well since we said that 2^23 first integers are representible in a float.

# asp.net - 如果我不知道在哪里放置断点，如何在调试时强制中断进程？

> ID：759018
> 
> 赞同：2
> 
> 时间：2009-04-17T04:25:22.867
> 
> 标签：asp.net, visual-studio-2008, debugging

当我不知道进程遇到什么代码时，如何强制 asp.net 应用程序在 VS 2008 中中断？我遇到了一个问题，代码中似乎有一些循环，并且在放置了无数个断点之后找不到它。我想强制应用程序中断，以便我可以看到问题所在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2009-04-17T04:28:42.657

您可以通过按暂停（全部中断）“||”来中断它 调试工具栏中的按钮。

# return-value - 如何处理 ANTLR 中的列表返回值

> ID：759028
> 
> 赞同：6
> 
> 时间：2009-04-17T04:29:51.077
> 
> 标签：return-value, antlr, action, antlrworks

在 ANTLR 中解决此问题的正确方法是什么：

我有一个简单的语法规则，比如一个包含任意数量元素的列表。

```
list
: '[]' 
| '[' value (COMMA value)* ']' 
```

如果我想为列表分配一个返回值，并且该值是生产中返回值的实际列表，那么正确的方法是什么？我正在娱乐的替代方案是：

*   在全局范围内创建我自己的堆栈以跟踪这些列表
*   尝试检查我下面的树节点并以这种方式提取信息
*   以某种巧妙而酷炫的方式访问它，我希望能找到我可以从与规则相关联的操作中轻松访问此类列表的方法。

我想问题是：酷孩子是怎么做到的？

（仅供参考，我正在使用 ANTLR 的 python API，但如果你用另一种语言打我，我可以处理）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2009-04-17T04:41:40.800

在 C# 中，它可能看起来像这样：

```
list returns [ List<string> ValueList ]
    @init
    {
        $ValueList = new List<string>();
    }
    : '[]'
    | '[' value {$ValueList.Add(value);} (COMMA value {$ValueList.Add(value);})* ']'
    ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-05-24T17:38:37.150

我想一个更直接的方法可能是

```
list returns [ List values ]
: '[]' 
| '[' vs+=value (COMMA vs+=value)* ']' {
        $values = $vs;
} 
```

# php - 如何上传/调整用数码相机拍摄的图像？

> ID：759031
> 
> 赞同：0
> 
> 时间：2009-04-17T04:30:12.840
> 
> 标签：php, image, gd, imagemagick

我正在建造一个画廊，目标是降低进入门槛。我的用户是使用数码相机拍照的人，因此每张图像的文件大小在 200 - 400 KB 之间。

我在使用 GD 库时遇到的问题是，当服务器有 64 MB 的限制时，每个图像在调整大小和上传时使用大约 90MB 的内存+。

当我使用 ImageMagick 时，它会超时并引发内部服务器错误。

我想知道是否有人对上传/调整如此大的图像大小有任何经验，可以给我一些指示。

谢谢，
列维

编辑：这是我要上传的代码

```
 /** Begin Multiple Image Upload**/     
        $numberImages = count($_FILES['galFile']['name'])-1;

for($i=1;$i<=$numberImages;$i++)
{
$imageName = $_FILES['galFile']['name'][$i];
            $imageType = $_FILES['galFile']['type'][$i];
            $imageSize = $_FILES['galFile']['size'][$i];
            $imageTemp = $_FILES['galFile']['tmp_name'][$i];
            $imageError = $_FILES['galFile']['error'][$i];

            //Make sure it is an image
            if(in_array(end(explode(".", $imageName)), $allowed))
            {
                 //Where to upload image to
                 $uploadFile = $uploadDir . $imageName;
                 if (file_exists($uploadFile))
        {
            //What to do if file already exists
            //Append random number to the end
            $front = explode(".", $imageName);
            $randomNum = rand(1,100);
            $front[0] = $front[0].$randomNum;
            $imageName = $front[0].".".$front[1];
            $uploadFile = $uploadDir . $imageName;
        }
                  if(move_uploaded_file($imageTemp,$uploadFile))
                  {
                  //Add $imageName to DB
                   $query = "INSERT INTO galleryImages VALUES(\"0\",\"$lastInsert\",\"$imageName\",\"$i\")";
               mysql_query($query);
               reSizePic($uploadFile);
                  }
            }
} 
```

这是我用来调整大小的 GD 代码：

```
function reSizePic($image)
{
$source_pic = $image;
$destination_pic = $image;
$max_width = 660;
$max_height = 500;

$src = imagecreatefromjpeg($source_pic);
list($width,$height)=getimagesize($source_pic);

$x_ratio = $max_width / $width;
$y_ratio = $max_height / $height;

if(($width <= $max_width) && ($height <= $max_height))
{
    $tn_width = $width;
    $tn_height = $height;
}
elseif (($x_ratio * $height) < $max_height)
{
    $tn_height = ceil($x_ratio * $height);
    $tn_width = $max_width;
}
else
{
    $tn_width = ceil($y_ratio * $width);
    $tn_height = $max_height;
}

$tmp = imagecreatetruecolor($tn_width,$tn_height);

imagecopyresampled($tmp,$src,0,0,0,0,$tn_width, $tn_height,$width,$height);

imagejpeg($tmp,$destination_pic,100);
imagedestroy($src);
imagedestroy($tmp);
} 
```

这是我用来调整大小的 ImageMagick 代码：

```
$resource = NewMagickWand(); 
MagickReadImage($resource,$image); 
MagickSetImageCompressionQuality( $resource, 100);
$resource = MagickTransformImage($resource,'0x0','660x500');
MagickWriteImage($resource, $image);
DestroyMagickWand($resource); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2009-04-17T05:39:53.373

[http://pl.php.net/imagecreatefromjpeg](http://pl.php.net/imagecreatefromjpeg)

> 使用 imagecreatefromjpeg() 加载图像所需的内存是图像尺寸和图像位深度的函数，乘以开销。它可以通过以下公式计算：Num bytes = Width * Height * Bytes per pixel * Overhead fudge factor 其中 Bytes per pixel = Bit depth/8，或 Bits per channel * Num channels / 8。

那是关于GD的部分。现在ImageMagick：你有没有尝试过更简单的方法：

```
$thumb = new Imagick('image.jpg');
$thumb->resizeImage($w,$h,Imagick::FILTER_LANCZOS,1);
$thumb->writeImage('thumb.jpg');
$thumb->destroy(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2009-04-24T12:47:16.130

请将以下代码放在您的 php 文件顶部。

ini_set("memory_limit","500M");

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T06:56:01.863

我对这个问题一无所知，但以下答案是否有用

[处理照片上传的最佳方式是什么？](https://stackoverflow.com/questions/74315/what-is-the-best-way-to-handle-photo-uploads)

万一**不是**，请忽略它。

# c# - c#中的动态文件上传

> ID：759033
> 
> 赞同：1
> 
> 时间：2009-04-17T04:30:35.193
> 
> 标签：c#, asp.net

我完全不知道如何使用 c# 在 asp.net 中使用单个上传按钮上传多个文件。事先不知道有多少文件。有人可以给我提供 c# 中的代码吗？我将不胜感激。

提前致谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2009-04-17T04:35:38.207

使用单个上传控件无法进行多次上传（您必须上传一个文件，然后在上传第一个文件后再次重复整个过程）。

您可以使用 IFrame 和一些 JS 来安装一个这样的控件，该控件将允许您一次上传多个文件（但是，一次只会将一个文件发布到服务器，而且它更好，因为服务器）。

或者，您可以使用一些使用 Java 技术 (Applets) 或在 Flash 中创建的第三方控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2009-04-17T04:39:18.307

这是一个使用多个文本框和浏览按钮来收集最多 5 个文件的路径然后一次上传的示例。

[DotNetJunkies 文件上传教程](http://www.dotnetjunkies.com/Tutorial/81E0C3A9-1B40-425C-B150-B578FE724A39.dcik)

这个来自 MSDN 的使用[File Field Control](http://msdn.microsoft.com/en-us/library/aa478971.aspx)来完成同样的事情。

这两篇文章中都有很多代码可以帮助您顺利进行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2009-04-17T05:04:46.173

您可以创建一个上传输入并拥有一个按钮以使用 Javascript 更动态地添加。当您单击保存按钮时，文件将全部位于 Request.Files 中。

```
<script type="text/javascript">
    var uploadCount = 2;
    function AddUpload()
    {
        var uploads = document.getElementById("uploads");
        var id = "upload" + uploadCount;
        uploads.innerHTML += ("<input type='file' id='" + id + "' name='" + id + "' />");
    }
</script>

<a href="javascript: void(0);" onclick="javascript: AddUpload();">Add Upload</a>
<div id="uploads">
    <asp:FileUpload runat="server" ID="upload1" />
</div>
<asp:Button runat="server" ID="btnSave" Text="Save" /> 
```

# java - 如何将字符串转换为时间格式并添加两个小时

> ID：759036
> 
> 赞同：31
> 
> 时间：2009-04-17T04:31:56.640
> 
> 标签：java, datetime

我在项目中有以下要求。

我有一个按名称输入的字段`startDate`，用户输入格式`YYYY-MM-DD HH:MM:SS`。我需要为该`startDate`字段中的用户输入添加两个小时。我该怎么做。

提前致谢

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2009-04-17T04:42:07.070

您可以使用 SimpleDateFormat 将字符串转换为日期。之后你有两个选择，

*   制作一个日历对象，然后使用它来添加两个小时，或者
*   从该日期对象获取以毫秒为单位的时间，并添加两个小时，例如 (2 * 60 * 60 * 1000)

    ```
    SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");

    // replace with your start date string
    Date d = df.parse("2008-04-16 00:05:05"); 
    Calendar gc = new GregorianCalendar();
    gc.setTime(d);
    gc.add(Calendar.HOUR, 2);
    Date d2 = gc.getTime(); 
    ```

    或者，

    ```
    SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");

    // replace with your start date string
    Date d = df.parse("2008-04-16 00:05:05");
    Long time = d.getTime();
    time +=(2*60*60*1000);
    Date d2 = new Date(time); 
    ```

看看这些教程。

*   [SimpleDateFormat 教程](http://java.sun.com/docs/books/tutorial/i18n/format/simpleDateFormat.html)
*   [日历教程](http://www.java2s.com/Tutorial/Java/0040__Data-Type/ThejavautilCalendarClass.htm)

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2009-04-17T15:52:40.920

作为[Joda Time](http://joda-time.sourceforge.net/)库的粉丝，以下是使用 Joda 的方法[`DateTime`](http://joda-time.sourceforge.net/api-release/org/joda/time/DateTime.html)：

```
import org.joda.time.format.*;
import org.joda.time.*;

...    

String dateString = "2009-04-17 10:41:33";

// parse the string
DateTimeFormatter formatter = DateTimeFormat.forPattern("yyyy-MM-dd HH:mm:ss");
DateTime dateTime = formatter.parseDateTime(dateString);

// add two hours
dateTime = dateTime.plusHours(2); // easier than mucking about with Calendar and constants

System.out.println(dateTime); 
```

`java.util.Date`如果您在此转换之前/之后仍然需要使用对象，Joda `DateTime`API 提供了一些简单[`toDate()`](http://joda-time.sourceforge.net/api-release/org/joda/time/base/AbstractInstant.html#toDate())的[`toCalendar()`](http://joda-time.sourceforge.net/api-release/org/joda/time/base/AbstractDateTime.html#toCalendar(java.util.Locale))方法来轻松翻译。

与 Java 日期/日历 API 相比，Joda API 提供了更多便利。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-07-25T06:54:54.950

试试这个，我测试它，工作正常

```
Date date = null;
String str = "2012/07/25 12:00:00";
DateFormat formatter = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
date = formatter.parse(str);
Calendar calendar = Calendar.getInstance();
calendar.setTime(date);
calendar.add(Calendar.HOUR, 2);
System.out.println(calendar.getTime());  // Output : Wed Jul 25 14:00:00 IST 2012 
```

如果您想转换输入类型而不是添加此代码

```
formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
str=formatter.format(calendar.getTime());
System.out.println(str);  // Output : 2012-07-25 14:00:00 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2009-04-17T04:42:29.407

使用`SimpleDateFormat`类`parse()`方法。此方法将返回一个`Date`对象。然后，您可以为此创建一个`Calendar`对象`Date`并为其添加 2 小时。

```
SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
Date date = formatter.parse(theDateToParse);
Calendar cal = Calendar.getInstance();
cal.setTime(date);
cal.add(Calendar.HOUR_OF_DAY, 2);
cal.getTime(); // This will give you the time you want. 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2011-09-09T08:53:31.867

```
//the parsed time zone offset:
DateTimeFormatter dateFormat = DateTimeFormat.forPattern("yyyy-MM-dd'T'HH:mm:ss.SSSZ");
String fromDateTimeObj = "2011-01-03T12:00:00.000-0800";
DateTime fromDatetime = dateFormat.withOffsetParsed().parseDateTime(fromDateTimeObj); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-08T16:17:04.547

添加两次的基本程序：
您可以根据需要使用if else修改小时：分钟：秒。
该程序向您展示了如何将两个对象的值相加并返回另一个对象。

```
class demo
{private int hour,min,sec;
    void input(int hour,int min,int sec)
    {this.hour=hour;
    this.min=min;
    this.sec=sec;

    }
    demo add(demo d2)//demo  because we are returning object
    {   demo obj=new demo();
    obj.hour=hour+d2.hour;
    obj.min=min+d2.min;
    obj.sec=sec+d2.sec;
    return obj;//Returning object and later on it gets allocated to demo d3                    
    }
    void display()
    {
        System.out.println(hour+":"+min+":"+sec);
    }
    public static  void main(String args[])
    {
        demo d1=new demo();
        demo d2=new demo();
        d1.input(2, 5, 10);
        d2.input(3, 3, 3);
        demo d3=d1.add(d2);//Note another object is created
        d3.display();

    }

} 
```

**修改时间加法程序**

```

 `class demo
 {private int hour,min,sec;
    void input(int hour,int min,int sec)
    {this.hour=(hour>12&&hour<24)?(hour-12):hour;
    this.min=(min>60)?0:min;
    this.sec=(sec>60)?0:sec;

    }
    demo add(demo d2)
    {   demo obj=new demo();
    obj.hour=hour+d2.hour;
    obj.min=min+d2.min;
    obj.sec=sec+d2.sec;
    if(obj.sec>60)
    {obj.sec-=60;
        obj.min++;
    }
    if(obj.min>60)
    {   obj.min-=60;
        obj.hour++;
    }
        return obj;
    }
    void display()
    {
        System.out.println(hour+":"+min+":"+sec);
    }
    public static  void main(String args[])
    {
        demo d1=new demo();
        demo d2=new demo();
        d1.input(12, 55, 55);
        d2.input(12, 7, 6);
        demo d3=d1.add(d2);
        d3.display();

    }

 }` 

            回答 #7

赞同：1

时间：2015-03-26T09:59:51.693

此示例是日期时间和时区的总和（字符串值）

```
String DateVal = "2015-03-26 12:00:00";
String TimeVal = "02:00:00";

SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
SimpleDateFormat sdf2 = new SimpleDateFormat("HH:mm:ss");

Date reslt = sdf.parse( DateVal );
Date timeZ = sdf2.parse( TimeVal );
//Increase Date Time
reslt.setHours( reslt.getHours() + timeZ.getHours());
reslt.setMinutes( reslt.getMinutes() + timeZ.getMinutes());
reslt.setSeconds( reslt.getSeconds() + timeZ.getSeconds());

System.printLn.out( sdf.format(reslt) );//Result(+2 Hours):  2015-03-26 14:00:00 
```

谢谢 ：）

            回答 #8

赞同：1

时间：2018-01-26T06:21:42.247

            回答 #9

赞同：1

时间：2017-05-19T17:24:02.707

这将为您提供所需的时间（例如：21:31 PM）

```
//Add 2 Hours to just TIME
SimpleDateFormat formatter = new SimpleDateFormat("HH:mm:ss a");
Date date2 = formatter.parse("19:31:51 PM");
Calendar cal2 = Calendar.getInstance();
cal2.setTime(date2);
cal2.add(Calendar.HOUR_OF_DAY, 2);
SimpleDateFormat printTimeFormat = new SimpleDateFormat("HH:mm a");
System.out.println(printTimeFormat.format(cal2.getTime())); 
```

        chm - 在 .chm 文件中创建工具栏

ID：759038

赞同：0

时间：2009-04-17T04:33:02.397

标签：chm

我从多个 html 文件创建了一个 .chm 文件。现在我想在 .chm 文件的顶部显示我自己的工具栏。我已经安装了“htmlhelp.exe”来从 html 文件创建 .chm。

我们可以创建自己的工具栏吗？

            回答 #1

赞同：1

时间：2009-04-17T04:35:28.973

不，不支持。不幸的是，CHM 并不是一个特别强大的工具。Help 2.x 也无济于事，因为微软决定不让除他们自己以外的任何人拥有查看器工具。（有第三方的，但它们不是很好。）并不是说它会添加你正在寻找的功能......我想只是发泄一下。

        sml - SML 函数调用不会将参数解析为参数

ID：759040

赞同：0

时间：2009-04-17T04:34:21.940

标签：sml, smlnj

我在调用 SML 函数时遇到了一个优先问题，替代：

```
fun substitute v new (typevar q) = ... 
```

我从另一个函数调用它：

```
fun new_type_vars (typevar v) non_gens = 
                   substitute v new_var() (typevar v) 
```

但我收到一个错误：

```
    C:/sml/type_checker.sml:22.48-23.44 错误：运算符和操作数不一致 [tycon mismatch]
      运算符域：type_exp
      操作数：单位 -> 字符串
      表达：
        （替代 v）new_var

```

这似乎表明它正在尝试调用（替换 v），然后使用参数 new_var 调用该调用的结果。

我尝试在整个内容周围添加括号，但这没有帮助，当我在参数周围添加括号时，`(v new_var...)`它认为 v 是 new_var 上的函数应用程序。这个函数调用是怎么回事？

            回答 #1

赞同：1

时间：2009-04-17T06:10:32.083

我不明白一切，因为你没有给出不同操作和变量的所有类型。

但是您遇到的一般问题是您已经猜到了，SML 从左侧执行函数调用（并绑定变量）。这里有一个例子：

```
fun f a:int b:int c:string = ... 
```

因此 f 是 int -> int -> string -> ... 类型的函数，并隐式添加括号 fun (((fa:int) b:int) c:int) = ...

这意味着您可以像这样使用它：

```
var f2 = f 3; 
```

f2 现在的类型是 int -> string -> ...

            回答 #2

赞同：1

时间：2009-04-17T06:19:31.890

你可能想改变

```
substitute v new_var() (typevar v) 
```

到

```
substitute v (new_var()) (typevar v) 
```

（布塔的回答解释了原因。）

        ajax - 如何在 grails remoteFunction 中使用 onLoading 事件

ID：759049

赞同：3

时间：2009-04-17T04:38:03.477

标签：ajax, frameworks, grails

我在 grails 中做一个 Web 应用程序。我在 gsp 页面中使用 remoteFunction。它现在正在工作。在“onloading”事件中我想调用“showSpinner()”javascript 函数。我的示例 gsp 代码是：

```
<div class="menuButton" onclick="${remoteFunction(action: 'index', controller: 'file',     update: [success: 'ajax', failure: 'ajax'])}">
      <label class="menu">File upload</label>
  </div> 
```

任何人都可以提供帮助。

            回答 #1

赞同：4

时间：2009-04-19T13:25:31.757

您可以为 Prototype Ajax 请求的 onLoading 事件全局注册一个所谓的 Ajax.Responder。这将触发页面中的每个 remoteFunction/Ajax 调用。为此，您应该在 gsp 页面或布局中的某处放置类似的内容：

```
<script type="text/javascript">
function showSpinner() {
   // TODO show spinner
}
function hideSpinner() {
   // TODO hide spinner
}
Ajax.Responders.register({
   onLoading: function() {
      showSpinner();
   },
   onComplete: function() {
      if(!Ajax.activeRequestCount) hideSpinner();
   }
});
</script> 
```

您当然需要实现 showSpinner 和 hideSpinner 函数。作为一个完整的示例，您可以使用以下内容：

```
<script type="text/javascript">
   function showSpinner() {
      $('spinner').show();
   }
   function hideSpinner() {
      $('spinner').hide();
   }
   Ajax.Responders.register({
      onLoading: function() {
         showSpinner();
      },
      onComplete: function() {     
         if(!Ajax.activeRequestCount) hideSpinner();
      }
   });
</script>
<div id="spinner" style="display: none;">
   <img src="${createLinkTo(dir:'images',file:'spinner.gif')}" alt="Loading..." width="16" height="16" />
</div> 
```

            回答 #2

赞同：3

时间：2011-12-10T01:27:41.747

如果您使用 JQuery 插件，请使用：

```
$(document).ready(function() {
    $("#spinner").bind("ajaxSend", function() {
        $(this).fadeIn();
    }).bind("ajaxComplete", function() {
        $(this).fadeOut();
    })}
); 
```

        sql-server - sql server 调优

ID：759057

赞同：1

时间：2009-04-17T04:42:14.043

标签：sql-server, performance

当我们执行任何查询时，查询优化器如何确定估计的行大小？

            回答 #1

赞同：2

时间：2009-04-17T04:53:25.450

SQL Server 使用统计信息和当前数据集来执行此分析。这是一个[非常详细的链接](http://msdn.microsoft.com/en-us/library/dd535534.aspx)，涵盖了 SQL 2008 的查询优化器用来为您计算的数据。

此外，[此链接](http://blogs.msdn.com/queryoptteam/archive/2006/08/29/730521.aspx)更详细地说明了优化器如何生成具有内部行估计的查询计划。

            回答 #2

赞同：0

时间：2009-04-17T04:47:51.330

查询优化器将检查当前数据，并在没有数据可用时假设最坏的情况。一些数据库供应商做了一个普通的案例，但如果没有数据，最好假设更糟的情况。如果您正在谈论估计返回的行数，那完全是另一回事。

        formatting - PowerBuilder：国际货币格式

ID：759061

赞同：2

时间：2009-04-17T04:45:46.407

标签：formatting, internationalization, currency, powerbuilder

背景

美国的用户是我们应用程序的初始用户群，但已经扩展到加拿大、英国和斯堪的纳维亚用户也使用该系统的地步。

PowerBuilder 数据窗口不喜欢带有小数和句点转置的斯堪的纳维亚货币格式 (###.###,00)。当我们尝试在数据窗口中设置格式时，它抱怨说格式无效。

我们不可能是唯一遇到这个问题的人，但我在 Internet 上的常规搜索中并没有看到很多关于这个主题的内容。

我们目前的解决方法

目前，其中一位开发人员找到了一种解决方法，让登录脚本更改 Windows 操作系统上会话的货币格式，并将“[货币]”放在数据窗口字段的格式属性中以获取操作系统的格式。  

这似乎可行，但出于多种原因，我认为这不是最佳解决方案。

1.  它要求我们的斯堪的纳维亚用户通过与其他用户不同的图标运行应用程序。我不必详细说明使用两个不同的图标登录应用程序有多糟糕，以及让每个图标启动不同格式脚本的维护麻烦。
2.  它只解决了用户会话中单一货币的货币格式问题。随着我们的应用程序变得更加国际化，我们可能需要能够在同一份报告中显示多种货币。

一定会有更好的办法

我相当肯定有人会告诉我我需要阅读 Spolsky 的 unicode 文章。但除此之外，我对更简洁的 PowerBuilder 解决方案的细节感兴趣，如果有人有的话。提前致谢。

            回答 #1

赞同：2

时间：2009-04-19T09:19:46.697

来自 PB 关于定义显示格式的帮助：

**数字和货币设置** 

为确保应用程序在其部署的任何国家/地区都具有相同的行为，DataWindow 表达式和用于显示格式和编辑掩码的掩码需要使用美国符号表示数字。也就是说，当您在 DataWindow 表达式或数字掩码中指定数字时，逗号始终表示千位分隔符，句点始终表示小数位。您还应该始终使用 $ 符号来表示货币符号。

在运行时，为数字和货币显示本地正确的符号。逗号和句点将替换为在 Windows 控制面板的区域或国际设置属性表中用户的数字设置中定义的分隔符。掩码中的 $ 符号将替换为 Windows 控制面板中用户的货币设置中定义的本地货币符号。例如，在逗号代表小数位而句点代表千位的国家/地区，用户会看到这些格式的数字。

这可能不是您希望得到的答案......我可以建议的是：

*   对于报告，使用一个计算字段，该字段将按照您想要的任何方式格式化数字，并将其显示为字符串。
*   对于输入字段，使用内置货币掩码。无论如何，用户可能会觉得使用默认系统区域设置更舒服。

        elisp - 您如何在 elisp 中使用 (list-at-point)？

ID：759068

赞同：1

时间：2009-04-17T04:52:25.297

标签：elisp

我有时使用 (number-at-point), (string-at-point), (sexp-at-point) 我需要：

（点列表）

我希望能够获取一些文本，例如：

A B C D

并使用 list-at-point 将其作为 elisp 列表抓取，然后对其进行一些处理。

但我似乎无法让 list-at-point 返回除 nil 之外的任何内容。

我在 Windows 上使用 Emacs，v22.3.1

            回答 #1

赞同：4

时间：2009-04-17T05:54:07.147

看来您发现了一个错误，依赖的功能`form-at-point`似乎都不适合我，而依赖的功能`thing-at-point`却可以。查看 elisp 源中的文件`thngatpt.el`。

该功能有足够的头发，我现在无法调试它，但它显然没有做它宣传的事情。谷歌搜索显示其他投诉。

您可能会看看是否将其替换[`thingatpt+.el`](http://www.emacswiki.org/emacs/thingatpt+.el)为更好。

            回答 #2

赞同：1

时间：2012-07-24T15:42:38.127

使用 lisp，您可以使用提供的 parentize 命令

[http://launchpad.net/sx-emacs-werkstatt/](http://launchpad.net/s-x-emacs-werkstatt/)

查看下载

;;; ar-parentized-atpt 是 `thing-at-point-utils.el' 中的一个交互式 Lisp 函数。

它必然是 s-)。

(ar-parentized-atpt &optional ARG NO-DELIMITERS)

如果有，则返回父节点，否则返回 nil。可选的 NO-DELIMITERS 修剪 THING，即返回带分隔符`brackteted',`的对象，如括号等，不带分隔符。

        asp.net - 您如何编写单元测试来测试 ASP.NET Web 表单应用程序的 CSRF 漏洞？

ID：759069

赞同：4

时间：2009-04-17T04:52:39.273

标签：asp.net, security, unit-testing

我们有一个可能容易受到跨站点请求伪造 (CSRF) 攻击的 ASP.NET Web 表单应用程序。我们如何开始编写一个单元测试来提醒我们这一点？使用 NUnit。一些提示或指示会很棒。

            回答 #1

赞同：1

时间：2009-04-24T23:42:26.273

CSRF 是一种攻击，其中用户被欺骗（例如通过电子邮件中的链接）代表攻击者执行操作，同时已经在您的网站上进行了身份验证。

有几种方法可以降低您应该测试的风险 -

*   GET 请求不应有副作用 - 所有操作都应仅使用 POST 请求完成。攻击者更难生成来自用户的 POST 请求。
*   您希望将随机唯一的每页字符串发送给用户并在返回服务器时进行检查。用户的 cookie 将在攻击者引起的请求中发送，但攻击者不会知道表单中存储的字符串。在 .NET 中，我认为您可以为此使用 Viewstate。
*   对于特别敏感（或易受攻击）的操作或在一段时间不活动后，您可以请求用户重复身份验证

[OWASP](http://www.owasp.org)（由 Torbjørn 链接）确实是一个极好的资源，包含更详细的解释和建议。

            回答 #2

赞同：0

时间：2009-04-23T08:07:43.530

您需要了解 CSRF 是如何完成的。进入黑客的思维方式。然后，您需要创建执行 CSRF 的自动化测试。这可能不是单元测试（测试单个单元），更像是集成测试。当你成功执行 CSRF 攻击时——当你的测试是红色的——你将能够解决问题。

查看[CSRF 常见问题解答](http://www.cgisecurity.com/csrf-faq.html)以获取有关如何执行攻击的更多信息。这里有一篇很好的关于[CSRF 测试的](http://www.owasp.org/index.php/Testing_for_CSRF_(OWASP-SM-005))wiki 文章，你应该看看。

        wcf-data-services - 查询拦截器抛出：不能为不属于实体集的查询映射视图的实体构造函数指定相关实体

ID：759073

赞同：1

时间：2009-04-17T04:54:59.427

标签：wcf-data-services

我们在应用程序的 ADO.NET 数据服务中使用查询拦截器，根据用户有权访问的数据过滤每个实体的结果集。但是，我们的一个查询拦截器抛出了以下异常：

内部 .NET Framework 数据提供程序错误 1004、0，无法为不属于实体集的查询映射视图的实体构造函数指定相关实体。

何时/为什么抛出此异常？

为了给这篇文章添加一些上下文，我在我的 URL 中使用了以下过滤条件：

$filter=(OnlineItems/Products/ProductId eq 856)

查询拦截器在哪里：

```
 [QueryInterceptor("OnlineItems")]
        public Expression<Func<OnlineItems, bool>> QueryOnlineItems()
        {
            return item => (item.Products.Any(p => p.Price > 10));
        } 
```

作为黑暗中的刺，我想这将是对产品进行过滤以及对产品进行扩展的组合，但我不确定这如何导致整个事情崩溃。

            回答 #1

赞同：1

时间：2009-04-20T07:46:08.367

出于某种原因，这有效：

```
[QueryInterceptor("OnlineItems")]
public Expression<Func<OnlineItems, bool>> QueryOnlineItems()
{
    return item => (item.Products.Count(p => p.Price > 10) > 0);
} 
```

有谁知道为什么这会起作用而不是“任何”案例？

            回答 #2

赞同：0

时间：2010-12-16T00:00:26.577

EF CTP5 仍然有这个错误！无论如何，现在有一个简单的解决方法

```
[QueryInterceptor("OnlineItems")]
public Expression<Func<OnlineItems, bool>> QueryOnlineItems()
{
    return item => item.Products.FirstOrDefault(p => p.Price > 10) != null;
} 
```

在此处查看更多信息：[http ://social.msdn.microsoft.com/Forums/en/adodotnetdataservices/thread/b5c49e69-3b5f-4606-8b40-4025dc8e5cb1?prof=required](http://social.msdn.microsoft.com/Forums/en/adodotnetdataservices/thread/b5c49e69-3b5f-4606-8b40-4025dc8e5cb1?prof=required)

请注意， Count() 完全是垃圾性能！

        javascript - 如何在 JavaScript 中推断日期对象的日期？

ID：759080

赞同：0

时间：2009-04-17T04:57:55.457

标签：javascript

如何在 JavaScript 中推断日期对象的日期？
例子：
如果我将日期分配给如下对象：

```
var date_value = this.cfg.getProperty(cfgPageDate); 
```

date_value 中的日期格式如下：

```
Fri May 29 2009 00:00:00 GMT+1000 (AUS Eastern Standard Time) 
```

我怎样才能从这个对象中推断出一天，以便对象日期如下：

```
Thu May 28 2009 00:00:00 GMT+1000 (AUS Eastern Standard Time) 
```

            回答 #1

赞同：2

时间：2009-04-17T05:03:38.640

```
var dat = new Date('2009/05/29');
alert (dat.setDate(dat.getDate()-1)); 
```

        c# - 我如何屏幕抓取网络邮件页面？

ID：759085

赞同：0

时间：2009-04-17T04:59:04.953

标签：c#, screen-scraping

我正在做一个项目，我需要登录一个网站并抓取网页内容。我尝试了以下代码：

```
protected void Page_Load(object sender, EventArgs e)
{
    WebClient webClient = new WebClient();
    string strUrl = "http://www.mail.yahoo.com?username=sakthivel123&password=operator&login=1";
    byte[] reqHTML;
    reqHTML = webClient.DownloadData(strUrl);
    UTF8Encoding objUTF8 = new UTF8Encoding();
    Label1.Text = objUTF8.GetString(reqHTML1);
} 
```

这会刮掉邮件的登录页面。但我需要抓取我的收件箱详细信息。请指导我如何进一步进行，在此先感谢。

            回答 #1

赞同：1

时间：2009-04-17T05:05:03.753

请参阅此[问题](https://stackoverflow.com/questions/611092/how-do-you-login-to-a-webpage-and-retrieve-its-content-in-c)和相关问题。我们必须先研究网页的 HTML 源代码，然后才能正确废弃它。所以手动登录，获取收件箱页面的来源，然后研究它来抓取它。

为什么不使用 yahoo 的 webmail [API](http://developer.yahoo.com/mail/)？这是一个更好的解决方案。

            回答 #2

赞同：0

时间：2009-04-17T05:03:37.237

看到这个问题 -[编写一个扫描电子商务网站并从中提取产品图片+价格+描述的C#程序](https://stackoverflow.com/questions/519387/writing-a-c-program-that-scans-ecommerce-website-and-extracts-products-pictures)

PS：它被称为“scrape”，执行屏幕抓取的行为将被称为（你猜对了！）“Screen scraping”。用作动词时，“scrap”一词表示丢弃 - 例如“项目已废弃！” ;-)

            回答 #3

赞同：0

时间：2009-04-17T05:20:19.660

我建议您首先使用一个名为 Fiddler 的工具来分析目标站点和浏览器之间的通信。您可以查看所有的 http 标头、cookie、内容等。

一旦您的 webClient 对象能够复制浏览器的操作，包括登录、设置适当的 cookie 等，您就可以自动执行该过程。

最后，一旦您拥有所需的 HTML，就可以使用正则表达式从中提取您想要的信息。

        c# - 试图在 C# 中理解 Postgres 的二进制复制格式

ID：759101

赞同：3

时间：2009-04-17T05:09:24.337

标签：c#, .net, postgresql

[考虑PostgreSQL 文档](http://www.postgresql.org/docs/8.3/interactive/sql-copy.html)中有关二进制复制的以下文本：

11 字节序列 PGCOPY\n\377\r\n\0 — 请注意，零字节是签名的必需部分。（签名旨在允许轻松识别已被非 8 位干净传输修改的文件。此签名将通过行尾翻译过滤器、丢弃零字节、丢弃高位或平价变化。）

我可以创建标题的其余部分，但 \377 是什么意思？我认为您在单个字节中可以拥有的最大值是 256？
此外，在示例中：

```
0000000   P   G   C   O   P   Y  \n 377  \r  \n  \0  \0  \0  \0  \0  \0
0000020  \0  \0  \0  \0 003  \0  \0  \0 002   A   F  \0  \0  \0 013   A
0000040   F   G   H   A   N   I   S   T   A   N 377 377 377 377  \0 003
0000060  \0  \0  \0 002   A   L  \0  \0  \0 007   A   L   B   A   N   I
0000100   A 377 377 377 377  \0 003  \0  \0  \0 002   D   Z  \0  \0  \0
0000120 007   A   L   G   E   R   I   A 377 377 377 377  \0 003  \0  \0
0000140  \0 002   Z   M  \0  \0  \0 006   Z   A   M   B   I   A 377 377
0000160 377 377  \0 003  \0  \0  \0 002   Z   W  \0  \0  \0  \b   Z   I
0000200   M   B   A   B   W   E 377 377 377 377 377 377 
```

当我解释格式时，那些相同的 377 值代表什么，它们不应该是 \0 吗？
如果有人可以对格式的其余部分提供帮助，我们将不胜感激。我*可以*作弊并使用 CVS 数据库副本，但是由于我需要复制的行数（以百万计），我知道二进制格式在速度方面比 CVS 格式有很多优势。

            回答 #1

赞同：5

时间：2009-04-17T05:30:20.963

是八进制 - 它的`\377`十进制值为 255。关于格式还有什么特别让您感到困惑的吗？

            回答 #2

赞同：0

时间：2009-04-17T09:06:44.047

基本上你不会通过使用二进制格式获得任何显着的加速。它有不同的好处，但更快地加载数据并不是其中之一。

只需使用标准 csv 和 COPY 命令就可以了。

        sql - 从单个表中多次返回 SQL 中的一行？

ID：759104

赞同：0

时间：2009-04-17T05:11:47.917

标签：sql

假设我有一个表 CUSTOMERS，其键为 CUSTOMER_ID。我想根据查询返回多行：

```
SELECT NAME FROM CUSTOMERS WHERE CUSTOMER_ID in (130,130); 
```

尽管我希望它出现两次，但这始终返回匹配的单行。我的动机有点复杂，比上面的小例子复杂得多。我想将此信息剪切并粘贴到的电子表格是我无权访问的复杂连接的结果。我拥有的列表有 43,000 条记录。过去，我通过将行卸载到文件中并遍历我的输入列表并 grepping 输出来完成此操作。我可以使用一个简洁的 SQL 技巧吗？

            回答 #1

赞同：3

时间：2009-04-17T06:14:22.743

方法一：

您可以`UNION ALL`对自己进行查询。那应该使行加倍。

```
 SELECT NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (130,131,...)
UNION ALL
    SELECT NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (130,131,...) 
```

那应该这样做。我希望你有一个很好的理由，因为它根本上是错误的。

方法二：

创建一个虚拟表，一列两行。加入它，没有任何限制，允许数据库创建笛卡尔积：

```
CREATE TABLE dummy ( foo INTEGER PRIMARY KEY );
INSERT INTO dummy VALUES (1);
INSERT INTO dummy VALUES (2);

SELECT NAME FROM CUSTOMERS JOIN dummy WHERE CUSTOMER_ID IN (130,131,...) 
```

您可以使用具有一堆值 1.. *n*的虚拟表通过更改连接条件/where 子句来生成每行的1 到*n 个副本。*

            回答 #2

赞同：1

时间：2009-04-17T05:16:54.130

无论生成“IN (130, 130)”的逻辑都可以很容易地生成  

从 CUSTOMER_ID = 130 的客户中

选择名称 从 CUSTOMER_ID = 130 的客户中选择名称

这会给你两次（并且可能更容易生成）。

            回答 #3

赞同：1

时间：2009-04-17T05:20:18.070

这是一种可能的解决方案：

```
SELECT c.NAME FROM CUSTOMERS c 
JOIN (SELECT 130 AS CUSTOMER_ID UNION ALL SELECT 130) x 
  USING (CUSTOMER_ID); 
```

请注意，选择不命名表的语法取决于供应商。例如，上面的示例适用于 MySQL 和 Microsoft SQL Server，但不适用于 Oracle。

您还可以将值`130, 130`作为单独的行存储在临时表中，然后将临时表连接到`CUSTOMERS`.

        visual-studio - Visual Studio - 从元数据查看类型

ID：759105

赞同：3

时间：2009-04-17T05:12:04.237

标签：visual-studio

我记得在我以前安装的 Visual Studio 中，当我对当前解决方案中没有的类型使用“转到定义”选项时，它会显示一个选项卡，显示从元数据反映的类型。我当前的安装直接进入对象浏览器。我更喜欢查看元数据版本。

有什么方法可以选择默认行为，或者这是否在 VS 版本之间发生了变化？

提前致谢！

            回答 #1

赞同：1

时间：2009-04-17T05:21:07.083

为此，必须将包含该类的 dll 作为引用添加到您的项目中。

            回答 #2

赞同：1

时间：2009-04-17T05:45:00.287

从 Visual Studio 2005 开始，这应该是 C# 的默认行为，我不知道如何更改它。你在使用 VB.Net 吗？如果是这样，进入对象浏览器是“按设计”，没有办法改变它。  

**编辑**

OP 评论说 C# 是这里有问题的语言，所以 VB.Net 的猜测是不正确的。  

另一种选择是尝试将您的设置重置为 C# 默认值。如果存在更改行为的受支持设置，则重置为默认设置应撤消设置

*   工具 -> 选项 -> 导入/导出设置
*   按照步骤重置所有设置
*   选择 C# 开发人员
*   重启VS

            回答 #3

赞同：1

时间：2009-05-19T08:55:55.593

尤里卡！

*“代码定义窗口是一个只读的编辑器视图，它显示活动项目中存储或引用的代码文件中符号的定义。要显示此窗口，请从视图菜单中选择代码定义窗口。当窗口首先打开，它显示最后选择的符号的定义。如果没有定义可用，则显示未选择定义。此窗口可以停靠在集成开发环境 (IDE) 的任何方便的边缘。默认情况下，显示在代码编辑器下方。”*

        iphone - 如何在 iPhone 中寻找流媒体音频？

ID：759106

赞同：4

时间：2009-04-17T05:12:24.953

标签：iphone, ios, audio-streaming

我需要开发一个音频流应用程序，它具有播放、暂停和搜索（快进）的能力。我已经实现了除了 seek 之外的所有操作。我正在使用 Matt 的音频流[示例代码](http://cocoawithlove.com/2008/09/streaming-and-playing-live-mp3-stream.html)。任何人都可以详细解释如何实现音频搜索操作。我对搜索操作有了一个想法。IE。使用`AudioQueueGetCurrentTime()`方法。但我无法得到整个概念来实现它。那么你能帮我提供一个示例代码吗？

在此先感谢， 赛姆

            回答 #1

赞同：4

时间：2009-04-17T16:46:22.600

伙计，我正在做同样的事情。我看着永远！！！

我试过了

```
SInt64 byteOffset;
            UInt32 ioFlags;
            NSLog(@"seek to packet %i", mainMP3delegate.seek_Packet);
            OSStatus err = AudioFileStreamSeek(inAudioFileStream, mainMP3delegate.seek_Packet, &byteOffset, &ioFlags);
            if (err) { PRINTERROR("seek error");  myData->failed = true;} 
```

我试图将开始时间更改为我想要的地方

音频时间戳 ts；ts.mFlags = kAudioTimeStampSampleTimeValid; ts.mSampleTime = 111110; NSLog(@"采样时间 %f", ts.mSampleTime); ts.mSampleTime = mainMP3delegate.MP3_Timestamp; NSLog(@"采样时间 %f", ts.mSampleTime);

```
 err = AudioQueueStart(myData->audioQueue, &ts.mSampleTime);
         if (err) { PRINTERROR("AudioQueueStart"); myData->failed = true; return err; }     
         myData->started = true; 
```

但都没有奏效

我知道它很简单，我只是不知道，所以我出价让elance找人来解决它，甚至是为了钱！！！[http://www.elance.com/jobs/16779786/iphone_application_audio_streaming_seek_scrub&&catId=11033&backurl=aHR0cDovL3d3dy5lbGFuY2UuY29tL3BocC9zZWFyY2gvbWFpbi9lb2xzZWFyY2gucGhwP21hdGNoVHlwZT1wcm9qZWN0I21hdGNoS2V5d29yZHM9aXBob25lJTIwc3RyZWFtJTIwc2VlayZzb3J0Qnk9JnNvcnRPcmRlcj0mcGFnZT0xJmNhdEZpbHRlcj0xMDAmc3ViY2F0RmlsdGVyPSZ0aW1lbGVmdEZpbHRlcj0mdGltZWxpc3RlZEZpbHRlcj0mYnVkZ2V0RmlsdGVyPS0xJmZlYXR1cmVkcHJvamVjdEZpbHRlcj1mYWxzZSZlc2Nyb3dwcm9qZWN0RmlsdGVyPWZhbHNlJmIyYnByb2plY3RGaWx0ZXI9ZmFsc2UmaG91cmx5cHJvamVjdEZpbHRlcj10cnVlJmZpeGVkcHJvamVjdEZpbHRlcj10cnVlJnN0YXR1c0ZpbHRlcj0xMDAzNyZhbWV4cHJvamVjdEZpbHRlcj0%3D&job_tier=11188](http://www.elance.com/jobs/16779786/iphone_application_audio_streaming_seek_scrub&&catId=11033&backurl=aHR0cDovL3d3dy5lbGFuY2UuY29tL3BocC9zZWFyY2gvbWFpbi9lb2xzZWFyY2gucGhwP21hdGNoVHlwZT1wcm9qZWN0I21hdGNoS2V5d29yZHM9aXBob25lJTIwc3RyZWFtJTIwc2VlayZzb3J0Qnk9JnNvcnRPcmRlcj0mcGFnZT0xJmNhdEZpbHRlcj0xMDAmc3ViY2F0RmlsdGVyPSZ0aW1lbGVmdEZpbHRlcj0mdGltZWxpc3RlZEZpbHRlcj0mYnVkZ2V0RmlsdGVyPS0xJmZlYXR1cmVkcHJvamVjdEZpbHRlcj1mYWxzZSZlc2Nyb3dwcm9qZWN0RmlsdGVyPWZhbHNlJmIyYnByb2plY3RGaWx0ZXI9ZmFsc2UmaG91cmx5cHJvamVjdEZpbHRlcj10cnVlJmZpeGVkcHJvamVjdEZpbHRlcj10cnVlJnN0YXR1c0ZpbHRlcj0xMDAzNyZhbWV4cHJvamVjdEZpbHRlcj0%3D&job_tier=11188)

但是，没有运气。我最终（现在）下载了 mp3 并通过缓冲区进行搜索，如下所示，但这不是一个好的解决方案。

[http://lists.apple.com/archives/coreaudio-api/2009/Jan//msg00143.html](http://lists.apple.com/archives/coreaudio-api/2009/Jan//msg00143.html)

男人！如果你想通了或者有人想通了，我会发疯的。我还对有人正在开发的rentacoder出价，

            回答 #2

赞同：0

时间：2012-03-02T11:39:42.150

我也在使用 Matt 的音频流示例代码，但我无法用他的代码实现良好的搜索。

现在我正在使用 MPMoviePlayerController 进行音频流式传输，它的搜索功能效果很好。唯一的问题是总时间是逐步计算的，只有下载到最后才能知道总时间。

[MPMoviePlayerController 类参考](https://developer.apple.com/library/ios/#DOCUMENTATION/MediaPlayer/Reference/MPMoviePlayerController_Class/Reference/Reference.html)

        software-quality - 软件消亡的迹象

ID：759108

赞同：6

时间：2009-04-17T05:13:50.050

标签：software-quality

软件正在消亡的迹象是什么？

开发人员如何发现早期警告以防止软件死亡？

从用户的角度来看，我认为这很清楚 - 他们不能有效地使用什么，他们就会垃圾。

除此之外，软件可能会因为它的代码而死掉——架构、编码风格、代码库的大小、代码库的组织和程序员的质量。

我想知道如何倾听软件死亡的迹象并采取纠正措施。任何著名的示例软件因为没有开发人员听过这些迹象而死了吗？任何垂死软件被保存的例子？

            回答 #1

赞同：16

时间：2009-04-17T05:51:17.310

以下任何一项都清楚地表明您的系统在濒危物种名单上：

*   允许存在单点故障（只有一个人理解）
*   管理层没有分配资源来修复缺陷
*   六个月没有积极开发
*   一年没有发布周期
*   底层供应商产品/库停止支持
*   资源从一个项目中撤出并且在一个季度内被替换不超过两次
*   环境变化（例如更多的用户）没有得到补救
*   未测量性能并且不定期进行调整（性能下降）
*   基础设施变化迫在眉睫（操作系统、数据库、硬件）
*   由于系统中的缺陷、挫折或错误，用户已经创建了解决方法
*   用户基数正在下降

保持项目活力的方法：

*   公开和直接地让您的管理层参与
*   准确报告缺陷率并根据管理成本对其进行量化
*   尽可能多地自动化构建、测试、打包和部署周期
*   尽可能将系统模块化
*   制定明确的指标并在必要时调整应用程序
*   了解您的用户认为最重要的内容并满足这些需求

在起死回生的软件库上，我不得不将功能区放在首位[Objective-C](http://en.wikipedia.org/wiki/NeXTSTEP)。

            回答 #2

赞同：10

时间：2009-04-17T05:18:41.413

在这里插入胡思乱想的 Windows 笑话。

确实有几个迹象：

*   提高缺陷到达率
*   每个缺陷的修复成本更高
*   每个新功能的成本更高

所有这些都表明代码中的*熵*较高，即低信噪比。

有很多方法可以解决这个问题；可能最有效的方法是识别具有高缺陷率的模块——缺陷往往具有帕累托分布，即 20% 的模块占缺陷的 80%。您为这些模块构建了一个测试框架，然后从一个干净的页面重新实现它们，构建良好的测试（适当地使用单元测试框架等），然后将它们重新安装到整个系统中。

            回答 #3

赞同：6

时间：2009-04-17T07:10:32.250

我相信由于您似乎想到的内部“技术原因”而死亡的软件相对较少。我真的想不出任何例子。也许是德尔福（虽然那还没有死，只是病得很重）。

软件死机似乎更为常见，因为

*   底层硬件或操作系统过时，软件无法进行转换（WordPerfect，Lotus 1-2-3）
*   竞争产品提供卓越的功能，而市场领导者因自满而停滞不前（Amiga）
*   该软件因“范式变化”而过时（Encarta）

虽然前两点可能通常部分是质量问题的过错（这使得对市场变化做出反应的速度太慢且成本太高），但后者并非如此。

            回答 #4

赞同：3

时间：2009-04-17T05:21:42.030

不会很快修复关键错误。假设您发布的新版本存在影响 10% 用户的错误。如果您不及时修复它并发布一个固定版本，这些用户将无法完全使用该程序并会寻找替代品。当您最终发布延迟的固定版本时，它们就消失了。

            回答 #5

赞同：3

时间：2009-04-17T06:07:01.280

当开发人员找借口_不_接触或支持软件时。

            回答 #6

赞同：0

时间：2009-04-17T05:30:12.803

唯一重要的衡量标准是源自您上面提到的“用户视角”的衡量标准。

最有可能的候选人是：

1\. 支持请求增加，

2\. 销售额减少。

        icons - 最终 .exe 的 ILMERGE 图标

ID：759109

赞同：1

时间：2009-04-17T05:14:22.623

标签：icons, ilmerge

我有几个 dll 和一个 .exe 文件（称为 input.exe）。这些当前使用 ILMERGE 合并到单个 output.exe 文件中。

input.exe 文件带有一个图标。但是，创建的 output.exe 在 input.exe 中没有图标

所以总结一下，我想要一个 output.exe 的图标（使用 ILMERGE 创建）

你能帮我解决这个问题吗？

谢谢。

            回答 #1

赞同：3

时间：2009-10-01T14:03:24.170

您应该将 input.exe 指定为主程序集（命令行中指定的第一个程序集），并且它应该在合并的可执行文件中包含图标。

至少我使用的版本是这样的：2.9.210.0。

            回答 #2

赞同：-3

时间：2009-04-17T05:23:59.607

为什么不使用[工具](http://www.shelllabs.com/)并根据需要制作任何图标？

        c# - 如何在 C# 中的控制台窗口上显示列表项

ID：759133

赞同：68

时间：2009-04-17T05:25:47.447

标签：c#, console-application

我有一个`List`包含所有数据库名称的。我必须在控制台中显示该列表中包含的项目（使用`Console.WriteLine()`）。我怎样才能做到这一点？

            回答 #1

赞同：93

时间：2009-04-17T06:17:14.407

实际上你可以很简单地做到这一点，因为列表有一个方法，而且你可以作为一个方法组`ForEach`传入。`Console.WriteLine`然后，编译器将使用隐式转换将方法组转换为，在这种情况下，`Action<int>`并从组中选择最具体的方法，在这种情况下`Console.WriteLine(int)`：

```
 var list = new List<int>(Enumerable.Range(0, 50));

  list.ForEach(Console.WriteLine); 
```

也适用于字符串 =)

完全迂腐（我并不是建议您更改答案 - 只是为了感兴趣而发表评论）`Console.WriteLine`是一个方法组。然后编译器使用从方法组到 的隐式转换`Action<int>`，选择最具体的方法（`Console.WriteLine(int)`在这种情况下）。

            回答 #2

赞同：44

时间：2016-04-14T05:08:36.770

虽然答案`List<T>.ForEach`非常好。

我发现[`String.Join<T>(string separator, IEnumerable<T> values)`](https://msdn.microsoft.com/en-us/library/dd783876(v=vs.110).aspx)方法更有用。

例子 ：

```
List<string> numbersStrLst = new List<string>
            { "One", "Two", "Three","Four","Five"};

Console.WriteLine(String.Join(", ", numbersStrLst));//Output:"One, Two, Three, Four, Five"

int[] numbersIntAry = new int[] {1, 2, 3, 4, 5};
Console.WriteLine(String.Join("; ", numbersIntAry));//Output:"1; 2; 3; 4; 5" 
```

评论 ：

如果 separator 为**null**，则使用空字符串 ( `String.Empty`) 代替。如果 values 的任何成员为**null**，则使用空字符串代替。

`Join(String, IEnumerable<String>)`是一种方便的方法，可让您连接**IEnumerable(Of String)**集合中的每个元素，而无需先将元素转换为字符串数组。它对语言集成查询 (LINQ) 查询表达式特别有用。

这应该可以很好地解决问题，而对于其他人来说，具有数组值。使用相同方法的其他重载，[String.Join Method (String, Object[])](https://msdn.microsoft.com/en-us/library/dd988350(v=vs.110).aspx)

参考：[https ://msdn.microsoft.com/en-us/library/dd783876(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/dd783876(v=vs.110).aspx)

            回答 #3

赞同：35

时间：2009-04-17T05:29:00.153

假设项目适当地覆盖`ToString`：

```
public void WriteToConsole(IEnumerable items)
{
    foreach (object o in items)
    {
        Console.WriteLine(o);
    }
} 
```

（在这个循环中使用泛型没有任何优势——我们最终还是会调用`Console.WriteLine(object)`，所以它仍然会像`foreach`在这种情况下的部分中那样装箱。）

编辑：使用的答案`List<T>.ForEach`非常好。

在您有任意序列的情况下（例如，作为 LINQ 表达式的结果），我上面的循环更加灵活，但如果您肯定有一个，`List<T>`我会说这`List<T>.ForEach`是一个更好的选择。

一个优点`List<T>.ForEach`是，如果您有一个具体的列表类型，它将使用最合适的重载。例如：

```
List<int> integers = new List<int> { 1, 2, 3 };
List<string> strings = new List<string> { "a", "b", "c" };

integers.ForEach(Console.WriteLine);
strings.ForEach(Console.WriteLine); 
```

写出整数时，这将使用`Console.WriteLine(int)`，而写出字符串时，它将使用`Console.WriteLine(string)`。如果没有特定的重载可用（或者如果您只是使用泛型`List<T>`并且编译器不知道是什么`T`），它将使用`Console.WriteLine(object)`.

顺便说一下，注意`Console.WriteLine`用作方法组。这比使用 lambda 表达式更简洁，实际上*效率*更高（因为委托*只是*对 的调用`Console.WriteLine`，而不是对方法的调用，而该方法又只是调用`Console.WriteLine`）。

            回答 #4

赞同：21

时间：2009-04-17T06:11:56.637

您还可以使用 List 的内置 foreach，例如：

```
List<T>.ForEach(item => Console.Write(item)); 
```

此代码的运行速度也~~明显~~更快！

上面的代码还使您能够操作 Console.WriteLine，例如：

```
List<T>.ForEach(item => Console.Write(item + ",")); //Put a,b etc. 
```

            回答 #5

赞同：17

时间：2013-04-17T13:44:16.447

```
Console.WriteLine(string.Join<TYPE>("\n", someObjectList)); 
```

            回答 #6

赞同：1

时间：2017-04-13T12:15:47.143

我发现这更容易理解：

```
List<string> names = new List<string> { "One", "Two", "Three", "Four", "Five" };
        for (int i = 0; i < names.Count; i++)
        {
            Console.WriteLine(names[i]);
        } 
```

            回答 #7

赞同：0

时间：2018-08-01T06:44:41.097

假设我们需要在命令提示符下查看一些来自数据库表的数据。首先我们创建一个列表。Team_Details 是我的属性类。

```
 List<Team_Details> teamDetails = new List<Team_Details>(); 
```

然后您可以连接到数据库并执行数据检索部分并将其保存到列表中，如下所示。

```
 string connetionString = "Data Source=.;Initial Catalog=your DB name;Integrated Security=True;MultipleActiveResultSets=True";
            using (SqlConnection conn = new SqlConnection(connetionString)){
            string getTeamDetailsQuery = "select * from Team";
            conn.Open();
            using (SqlCommand cmd = new SqlCommand(getTeamDetailsQuery, conn))
                    {
                        SqlDataReader rdr = cmd.ExecuteReader();
                    {
                        teamDetails.Add(new Team_Details
                        {
                            Team_Name = rdr.GetString(rdr.GetOrdinal("Team_Name")),
                            Team_Lead = rdr.GetString(rdr.GetOrdinal("Team_Lead")),
                        });
                    } 
```

然后您可以在命令提示符下打印此列表，如下所示。

```
foreach (Team_Details i in teamDetails)
                        {
                            Console.WriteLine(i.Team_Name);
                            Console.WriteLine(i.Team_Lead);
                        } 
```

        database - Zend_Db_Table：当插入导致错误时会发生什么？

ID：759134

赞同：1

时间：2009-04-17T05:25:53.780

标签：database, zend-framework, error-handling, exception-handling

这可能是一个容易回答的问题，但我没有在文档中看到它......

当插入导致错误时会发生什么？是否抛出异常？什么样的？我试图了解尝试在唯一的列中插入重复数据时会发生什么。

所以我觉得我需要先做一些检查......

```
protected function _emailAlreadySubscribed($email)
{
    $select = $this->_model->select()->where('email = ?', $email);
    $rows = $table->fetchAll($select);
    if ($rows->count()) {
        return true;
    }
    return false;
} 
```

这是正确的检查方法吗？

            回答 #1

赞同：3

时间：2009-04-17T06:32:00.487

不，检查电子邮件是否已存在*不是*有效的解决方案。其他人可以在您的检查之后但在您的`INSERT`. 唯一的解决方案是锁定整个表。

当您违反 中的唯一键时`Zend_Db_Table::insert()`，会抛出一个`Zend_Db_Statement_Exception`（或其子类）。

另请参阅[MySQL 插入：首先测试？](https://stackoverflow.com/questions/440131/mysql-insert-test-first/440165#440165)

            回答 #2

赞同：2

时间：2009-07-18T09:50:09.797

我一直在使用 Zend Framework 来尝试检测数据库异常并处理它们。不幸的是，一旦您发现异常，getCode() 方法似乎总是返回“0”，所以我最终使用以下代码来检查重复项：

```
try { 
    $model->insert($data);
    $added++; 
} catch (Zend_Db_Exception $e) {
    if(strstr($e->getMessage(), '1062 Duplicate')) {
        // duplicate
        $duplicates++;
    } else {
        // general error
        $errors++;
    }
} 
```

不是我所知道的最优雅的代码，所以如果有人知道如何更好地处理这些异常或有异常代码参考，请加入！

            回答 #3

赞同：0

时间：2009-04-18T14:25:33.837

对于插入，我确保我的数据库表具有正确的索引（在这种情况下，emailAddress 上的唯一索引），然后我只是将我的插入包装在一个 try/catch 块中。

我让数据库告诉我这是否是骗局而不是先检查。

当数据库失败时插入会抛出异常。然后，您可以使用异常检查数据库失败的原因并向您的用户显示适当的消息。

        asp.net-mvc - 尝试上传文件的 MVC 问题

ID：759138

赞同：0

时间：2009-04-17T05:27:57.753

标签：asp.net-mvc

我用谷歌搜索了这段代码来上传一个带有 MVC 的文件。

```
<form method="post" enctype="multipart/form-data" action="/Task/SaveFile">
<input type="file" id="FileBlob" name="FileBlob"/>
<input type="submit"  value="Save"/>
<input type="button" value="Cancel" onclick="window.location.href='/'" />
</form> 
```

但是当我浏览一个文件并提交表单时询问表单[“FileBlob”]它是空的？？？？

马尔科姆

编辑：我在表单中添加了一个文本框，我可以得到这个值。只是输入类型文件不起作用？

```
bool errors = false;
   //this field is never empty, it contains the selected filename
   if ( string.IsNullOrEmpty( forms["FileBlob"] ) )
   {
       errors = true;
       ModelState.AddModelError( "FileBlob", "Please upload a file" );
   }
   else
   {
      string sFileName = forms["FileBlob"];
      var file = Request.Files["FileBlob"];
      //'file' is always null, and Request.Files.Count is always 0 ???
      if ( file != null )
      {
         byte[] buf = new byte[file.ContentLength];
         file.InputStream.Read( buf, 0, file.ContentLength );
         //do stuff with the bytes
      }
      else
      {
         errors = true;
         ModelState.AddModelError( "FileBlob", "Please upload a file" );
      }
   }
   if ( errors )
   {
      return ShowTheFormAgainResult(); 
   }
   else
   {
      return View();
   }
} 
```

            回答 #1

赞同：2

时间：2009-04-17T13:43:38.670

哇，这是一个令人困惑的设置，我个人绝不会将所有这些 if 语句和空值通过 jquery 验证做的事情复杂化，你也可以做服务器端验证。而不是在这里检查`if(errors)`do`if(ModelState.IsValid){ return View();}`是一个更好的解释

[http://msdn.microsoft.com/en-us/library/dd410404.aspx](http://msdn.microsoft.com/en-us/library/dd410404.aspx)

这样你就可以摆脱那个布尔设置。

也在这里检查

[http://blogs.msdn.com/stcheng/archive/2009/03/20/asp-net-how-to-implement-file-upload-and-download-in-asp-net-mvc.aspx](http://blogs.msdn.com/stcheng/archive/2009/03/20/asp-net-how-to-implement-file-upload-and-download-in-asp-net-mvc.aspx)

为了更轻松地实现您的上传结构。我已经使用它并且没有遇到任何问题。

            回答 #2

赞同：0

时间：2009-11-16T11:26:24.830

[这个答案](https://stackoverflow.com/questions/1653469/1653508#1653508)可能会有所帮助。另外，我建议不要在上传文件中发布其他表单字段。在单独的操作中单独执行此操作。当然，这为用户提供了 2 个步骤，但相信我，这对您来说是值得的。

        c# - 在图片框中迭代图像

ID：759148

赞同：0

时间：2009-04-17T05:31:49.197

标签：c#

我正在使用 PictureBox 循环浏览图像。我正在使用面板，将我的 PictureBox 放在面板内。每次我放一张新图片时，我都会清除面板。如果我这样做，图片开始闪烁。如何停止闪烁？

            回答 #1

赞同：1

时间：2009-04-17T05:35:27.707

与其清除面板并创建一个新的`PictureBox`，为什么不保持不变`PictureBox`而是更改`Image`属性以反映您要显示的新图像？

        php - 这至少是轻度安全的 php 代码吗？

ID：759149

赞同：1

时间：2009-04-17T05:32:22.097

标签：php, mysql, security, post, mysql-real-escape-string

我有一堆 $_POST 变量通过长格式发送，而不是用 a 对每个变量进行硬编码`mysql_escape_string()`，我可以执行以下操作吗？我不知道这是否真的是安全和/或可行的代码。

```
foreach ($_POST as &$post_item){
    $post_item = mysql_escape_string($post_item);
} 
```

我相当肯定，因为我使用的是 &，它通过引用而不是值传递它，所以我实际上是在更改 $_POST 中的值。

另外，我应该`mysql_real_escape_string()`改用吗？

编辑：我正在使用 PDO 和 prepare() 以及上述方法。这对我有用吗？

            回答 #1

赞同：10

时间：2009-04-17T05:37:55.750

为什么不使用`array_map()`？

```
array_map(mysql_real_escape_string, $_POST); 
```

但实际上您应该使用参数化/准备好的语句。

`mysql_real_escape_string()`考虑当前数据库字符集，`mysql_escape_string()`不考虑。因此，相比之下，前者是更好的选择。

编辑（跟进OP对问题的编辑）：

由于您已经执行了 PDO 准备语句，因此无需修改您的值。PDO 负责一切，这就是它的全部意义（**如果你真的将所有数据都放在参数中，那就是**- 只是连接字符串来构建 SQL 语句会导致有或没有 PDO 的灾难）。预先转义值会导致数据库中的值转义。

            回答 #2

赞同：3

时间：2009-04-17T05:41:22.527

`mysql_real_escape_string()`是的，如果你要走那条路，你应该使用。但是确保变量安全发送到数据库的正确方法是使用[参数化查询](http://en.wikipedia.org/wiki/SQL_injection#Using_Parameterized_Statements)，这些查询通过[mysqli](http://php.net/mysqli)函数或[PDO](http://php.net/pdo)在 PHP 中提供。

            回答 #3

赞同：1

时间：2009-04-17T05:47:18.083

In addition to the previous comments, another benefit to using parameterised queries is that the database will be able to do better optimisations and probably use a cached query plan so you will get better performance.

        message-queue - 为什么选择 ActiveMQ，而不是简单的 Queue/Mutex？

ID：759151

赞同：4

时间：2009-04-17T05:33:41.673

标签：message-queue, activemq

明天我将介绍我选择进程内消息队列实现的理由，但我无法阐明我的推理。我的共同设计者建议我们实现一个简单的异步队列，只使用一个基本的作业列表和一个互斥体来控制访问，我建议在嵌入式模式下使用 ActiveMQ。我个人对 ActiveMQ 印象深刻，我希望有一些好的、可靠的论据来支持我的直觉。

如果重要的话，应用程序基本上是 1 个生产者/n 个消费者，具有特定于正在处理的各个作业的优先级和类型信息。

值得注意的是，到目前为止，该解决方案的可管理性和可扩展性还不是强有力的论据。如果有人可以让我的论点更有力，我会很高兴。论坛能帮我解决吗？

            回答 #1

赞同：4

时间：2009-04-17T05:52:54.230

你同事的论点并非没有道理。将 ActiveMQ 添加到项目中会添加另一个依赖项。它的使用可能会更复杂，并且比定制解决方案占用的空间更大。此外，由于您正在采用它，因此维护和保持平稳运行可能会成为您的责任 - 错误和所有。

也就是说，ActiveMQ（和其他队列）会做一些你可以自己写的事情，但可能会很痛苦。支持整个 JMS API 就是其中之一（尽管我假设您使用的是 Java……如果您不是，那么这一点是无效的）。在高内存情况下将多余的消息序列化到磁盘是另一种方法。持久订阅者和消息选择器是我想到的其他一些事情。看起来大部分都是花里胡哨的东西，但它们对于可靠的消息传递变得非常重要。

无论您决定什么，都将消息代理的最终选择从客户端代码中封装起来，以使其更容易切换。

            回答 #2

赞同：3

时间：2009-04-17T05:39:04.827

如果可管理性和可扩展性不是高优先级，那么我想知道您想要使用可管理消息队列的原因是什么？也许你的同事是对的，你真的不需要额外的功能集？

            回答 #3

赞同：3

时间：2009-04-17T05:48:59.687

不必在奇怪的边缘情况下调试并发代码是一个很大的好处。我不知道这个结构作为你整个项目的一部分有多重要，但是如果消息队列是你项目的重要组成部分，那么你可以通过使用其他人编写的、已经调试过的实现来获得*巨大*的好处，并且会为你维护。如果它只是一个不重要的子系统的某个一次性部分，那么你最终会做什么可能并不重要。但如果它很关键，我宁愿提交错误报告也不愿花时间调试并发代码（我已经开始害怕退缩了！）。

简短的版本：不要让 NIH 综合症阻止您使用别人的工作来更快、更好、更便宜地完成工作。但是，也不要从鼹鼠丘中建造一座山。

        php - phpmyadmin mysql错误

ID：759152

赞同：0

时间：2009-04-17T05:33:57.867

标签：php, mysql, mysql-error-1045

我有Debian服务器。

我通过命令行的 phpmyadmin 和 mysql 早些时候运行良好。但是突然我在访问 phpmyadmin 时遇到了这个错误。

[http://myserver/phpmyadmin](http://myserver/phpmyadmin)

2003 - 服务器没有响应

当我尝试通过命令行访问时

```
mysql -u userid -p
Enter password:
ERROR 1045 (28000): Access denied for user 'userid'@'localhost' (using password: YES) 
```

当我通过这个访问时

```
mysql -h ipaddress -u userid -p 
```

连接需要很长时间。

            回答 #1

赞同：0

时间：2009-04-17T05:41:52.153

您可以检查 my.ini 中的“绑定地址”和 config.inc.php（phpMyAdmin）中的 $cfg['Servers'][$i]['host'] 值是否匹配。如果没有，请将它们或两者都更改为“localhost”以仅用于本地主机访问或服务器的真实 IP 地址以从其他主机访问。

            回答 #2

赞同：0

时间：2009-04-17T14:16:47.827

mysql 日志是否说明了这个错误？

            回答 #3

赞同：0

时间：2009-04-17T14:20:12.453

检查 mysql 用户名和密码是否`config.inc.php`与您在 mysql 配置文件中设置的匹配。如果你不能让它工作，你可能想问你的网络主机。

            回答 #4

赞同：0

时间：2009-04-27T12:37:19.623

用户通常收到此错误的原因之一是他们的防火墙配置不正确，并且不允许与 3306 等端口的传出连接（这在我身上发生过不止一次）。请检查您是否属于这种情况。

        vba - VBA：如何制作和重命名幻灯片

ID：759154

赞同：0

时间：2009-04-17T05:36:01.277

标签：vba, powerpoint

我需要一个示例场景的帮助：

我有一张幻灯片，上面有一个命令按钮。单击时，它应弹出一个窗口/图像，再次单击时应处理该窗口。我们能做到。当复制到另一个卡片组时，我无法使用卡片组 1 中的默认幻灯片名称。如何使带有 VBA 代码的幻灯片在不进行任何修改的情况下在任何卡片组中工作？另外，如何在 VBA 中重命名幻灯片？

            回答 #1

赞同：1

时间：2009-04-17T06:04:41.380

您使用的是哪个版本的 Powerpoint？我不确定您的命令按钮如何与套牌名称相关联。复制幻灯片应自动更新代码。

如果您在将幻灯片复制到新演示文稿时遇到问题，您可以尝试使用模板或 PowerPoint 加载项，以便您在一个操作中插入按钮和代码。

        subsonic - 使用条件 where 参数查询

ID：759157

赞同：0

时间：2009-04-17T05:37:08.980

标签：subsonic

在 2.1 之前，我能够编写这样的代码（使用 AddWhere）：

```
Query q = new Query(Search.Schema);
q.BuildSelectCommand();
if (!String.IsNullOrEmpty(barcode)) q.AddWhere("Barcode", Comparison.Like, "%" +     barcode.Trim() + "%");
if (!String.IsNullOrEmpty(fromDate)) q.AddWhere("FromDate", Comparison.GreaterOrEquals, fromDate);
if (!String.IsNullOrEmpty(toDate)) q.AddWhere("ToDate", Comparison.LessOrEquals, fromDate);
if (!String.IsNullOrEmpty(department)) q.AddWhere("DeptNo", Comparison.Like, "%" + department.Trim() + "%");
if (!String.IsNullOrEmpty(series)) q.AddWhere("SeriesNo", Comparison.Like, "%" + series.Trim() + "%");
if (!String.IsNullOrEmpty(altcode)) q.AddWhere("AltCode", Comparison.Like, "%" + altcode.Trim() + "%"); 
```

这使我能够创建漂亮的搜索表单，并且只搜索用户输入表单的变量，我试图用 2.1 以简单的方式重现此功能，但无法弄清楚。有没有人有什么建议？

            回答 #1

赞同：2

时间：2009-04-17T06:36:24.533

我想出的解决方案是：

```
SqlQuery q = new Select("syKey").From<Search>().Where("1").IsEqualTo("1");
if (!String.IsNullOrEmpty(barcode)) q.And("Barcode").Like("%" + barcode.Trim() + "%");
if (!String.IsNullOrEmpty(fromDate)) q.And("FromDate").IsGreaterThanOrEqualTo(fromDate);
if (!String.IsNullOrEmpty(toDate)) q.And("ToDate").IsLessThanOrEqualTo(fromDate);
if (!String.IsNullOrEmpty(department)) q.And("DeptNo").Like("%" + department.Trim() + "%");
if (!String.IsNullOrEmpty(series)) q.And("SeriesNo").Like("%" + series.Trim() + "%");
if (!String.IsNullOrEmpty(altcode)) q.And("AltCode").Like("%" + altcode.Trim() + "%"); 
```

注意默认 Where("1").IsEqualTo("1") 我可以动态地将“And”添加到查询中以使其工作。很高兴看到 AddWhere 被带回来，这样您就可以继续将 WHERE 命令堆叠在一起。

            回答 #2

赞同：0

时间：2009-04-17T06:08:42.663

```
IDataReader rdr=new Select().From<Search>().Where("barcode").Like(..)
.And("FromDate").GreaterThan(..)
.And("ToDate").LessOrEqualTo(..)
.And("DeptNo").Like()
...
.ExecuteReader(); 
```

[http://blog.wekeroad.com/2008/01/10/subsonic-version-21-pakala-preview-the-new-query-tool/](http://blog.wekeroad.com/2008/01/10/subsonic-version-21-pakala-preview-the-new-query-tool/)

现在，如果你喜欢冒险，你可以使用 3.0（正在开发中），你可以使用 Linq 来做到这一点：

[http://code.google.com/p/subsonicthree/](http://code.google.com/p/subsonicthree/)

我很乐意在这里提供帮助...

        c# - 如何在 WPF 窗口中移动网格面板

ID：759160

赞同：3

时间：2009-04-17T05:38:42.253

标签：c#, wpf, grid, move

你好，

如何在 WPF 窗口内移动（拖动）网格面板？网格面板没有位置或位置或 X 和 Y 坐标属性。我所看到的只是使用鼠标将网格面板从其当前位置移动到新位置，以便显示在其下方“隐藏”的控件。

任何指针？

非常感谢。

            回答 #1

赞同：15

时间：2009-04-17T16:25:53.960

以下是一些帮助您入门的代码示例：

在 XAML 中：

创建一个网格并在其上定义一个渲染变换：

```
<Grid x:Name="grid" Background="Blue" 
      Width="100" Height="100" 
      MouseDown="Grid_MouseDown" MouseMove="Grid_MouseMove" MouseUp="Grid_MouseUp">
    <Grid.RenderTransform>
        <TranslateTransform x:Name="tt"/>
    </Grid.RenderTransform>
</Grid> 
```

命名您希望网格在其中移动的控件：

```
<Window x:Name="window" ...>
    <Grid x:Name="grid"...
</Window> 
```

在后面的代码中：

```
Point m_start;
Vector m_startOffset;

private void Grid_MouseDown(object sender, MouseButtonEventArgs e)
{
    m_start = e.GetPosition(window);
    m_startOffset = new Vector(tt.X, tt.Y);
    grid.CaptureMouse();
}

private void Grid_MouseMove(object sender, MouseEventArgs e)
{
    if (grid.IsMouseCaptured)
    {
        Vector offset = Point.Subtract(e.GetPosition(window), m_start);

        tt.X = m_startOffset.X + offset.X;
        tt.Y = m_startOffset.Y + offset.Y;
    }
}

private void Grid_MouseUp(object sender, MouseButtonEventArgs e)
{
    grid.ReleaseMouseCapture();
} 
```

            回答 #2

赞同：3

时间：2015-11-23T22:06:33.983

***基于 Josh G 的回答***

如果您想移动一个网格，乔希的回答非常好，但缺乏移动多个元素的能力。

这是分别移动几个元素的方法

XAML

```
<Grid x:Name="gridHost">
    <Grid x:Name="gridBlue" Background="Blue" Width="100" Height="100" MouseDown="Grid_MouseDown" MouseMove="Grid_MouseMove" MouseUp="Grid_MouseUp" Margin="-100,0,0,0">
        <Grid.RenderTransform>
            <TranslateTransform/>
        </Grid.RenderTransform>
    </Grid>
    <Grid x:Name="gridRed" Background="Red" Width="100" Height="100" MouseDown="Grid_MouseDown" MouseMove="Grid_MouseMove" MouseUp="Grid_MouseUp" Margin="100,0,0,0">
        <Grid.RenderTransform>
            <TranslateTransform/>
        </Grid.RenderTransform>
    </Grid>
</Grid> 
```

背后的代码

```
Point m_start;
    Vector m_startOffset;

    private void Grid_MouseDown(object sender, MouseButtonEventArgs e)
    {
        FrameworkElement element = sender as Grid;
        TranslateTransform translate = element.RenderTransform as TranslateTransform;

        m_start = e.GetPosition(gridHost);
        m_startOffset = new Vector(translate.X, translate.Y);
        element.CaptureMouse();
    }

    private void Grid_MouseMove(object sender, MouseEventArgs e)
    {
        FrameworkElement element = sender as Grid;
        TranslateTransform translate = element.RenderTransform as TranslateTransform;

        if (element.IsMouseCaptured)
        {
            Vector offset = Point.Subtract(e.GetPosition(gridHost), m_start);

            translate.X = m_startOffset.X + offset.X;
            translate.Y = m_startOffset.Y + offset.Y;
        }
    }

    private void Grid_MouseUp(object sender, MouseButtonEventArgs e)
    {
        FrameworkElement element = sender as Grid;
        element.ReleaseMouseCapture();
    } 
```

            回答 #3

赞同：0

时间：2009-04-17T22:03:11.730

只需将网格面板放在画布内而不是直接放在窗口中 - 这将为其提供 X/Y 坐标。

然后，您可以使用自定义附加属性实现拖放行为，例如此处详述（[http://www.deepcode.co.uk/archive/2008/11/16/using-attached-properties-to-compose-new -behaviour.aspx](http://www.deepcode.co.uk/archive/2008/11/16/using-attached-properties-to-compose-new-behaviour.aspx) )

            回答 #4

赞同：0

时间：2014-06-20T07:13:50.243

```
 public void dragme(object sender, MouseButtonEventArgs e)
    {
        if (_Move.IsChecked == true)
            db.Attach((DependencyObject)sender); 
```

}

//// MouseDragElementBehavior db;

```
 private void canvass_PreviewMouseDown(object sender, MouseButtonEventArgs e) 
    {
if (_Move.IsChecked == true && filmgrid.Visibility == Visibility.Visible)// == true)  
            {
                filmgrid.PreviewMouseDown += new MouseButtonEventHandler(dragme); 
            } 
```

}

        ruby-on-rails - Postgresql 特定的数据库错误：“ActiveRecord::StatementInvalid: PGError: ERROR: operator does not exist”

ID：759167

赞同：2

时间：2009-04-17T05:41:22.903

标签：ruby-on-rails, postgresql

我的状态模型如下所示：

```
class State < ActiveRecord::Base
  belongs_to :country
  named_scope :order_by_name, :order => :name

  validates_presence_of [:country, :name]

  def <=>(other)
    name <=> other.name
  end

end 
```

我的国家模型如下所示：

```
class Country < ActiveRecord::Base
  has_many :states
  named_scope :order_by_name, :order => :name  

  def <=>(other)
    name <=> other.name
  end
end 
```

这适用于 SQLite 环境：

```
>> Country.find_by_iso("US").states
=> [#<State id: 1, name: "Alaska", abbr: "AK",  #  ..... 
```

但是在 postgresql 环境中，我得到了这个：

```
>> Country.find_by_iso("US").states
ActiveRecord::StatementInvalid: PGError: ERROR:  operator does not exist: character varying = integer
LINE 1: SELECT * FROM "states" WHERE ("states".country_id = 214) 
                                                          ^
HINT:  No operator matches the given name and argument type(s). You might need to add explicit type casts.
: SELECT * FROM "states" WHERE ("states".country_id = 214) 
```

有什么想法吗？

            回答 #1

赞同：8

时间：2009-04-17T06:01:28.313

错误消息很清楚，您正在尝试在不同类型之间进行比较，因此会出现“字符变化 = 整数”通知。

解决方案：将 country_id 设为“int”类型的列，而不是“varchar”。

        php - Moodle的视频插件

ID：759179

赞同：4

时间：2009-04-17T05:48:49.810

标签：php, moodle, plugins

目前我们使用的moodle没有视频插件。我已经开发了moodle的视频插件。我想将插件添加到我们机构正在使用的moodle软件中。我我是开源新手。如何包含插件。如何进行集成，以便我下次使用moodle时可以使用视频插件。插件是用php编写的

            回答 #1

赞同：2

时间：2010-06-23T15:23:58.953

这是 Moodle 开发**新模块**的官方文档：http :
 [//docs.moodle.org/en/newmodule](http://docs.moodle.org/en/newmodule)

从建议的**模板**开始（download.moodle.org/plugins19/mod/NEWMODULE.zip）来包装你的代码。

您可以随时查看**Kaltura.com**的视频插件代码 ( [http://www.kaltura.org/kaltura-moodle-plugin-installation-guide](http://www.kaltura.org/kaltura-moodle-plugin-installation-guide) )，了解如何在 Moodle 中实现视频。一般来说。

            回答 #2

赞同：1

时间：2009-04-17T10:12:55.153

将插件安装到 Moodle 中就像将它们复制到 /mod/ 目录一样简单。SQL 表将被写入和更新。

然后你应该能够在下次登录时看到这个模块。

编辑：

检查该文件夹和文件的权限是否正确。检查文件 version.php 是否存在且正确（检查其他模块以了解其完成方式）。检查目录结构是否正确。

如果一切都失败了，我会检查一些与您类似的其他模块并模仿它们的设置过程

编辑2：

我能帮助你的已经不多了。对不起。

            回答 #3

赞同：1

时间：2009-04-20T05:50:55.007

感谢您的帮助。我们完全按照您的建议进行了尝试，但没有成功。这是我们得到的回应...

模块 devtp: C:\wamp\www\moodle/mod/devtp/version.php 不可读

其中，'devtp' 是我们要添加的插件目录的名称。

您是否认为我们错过了为我们的插件包含任何相关文件，或者是因为我们需要包含一些可以使插件与当前版本的 MOODLE 兼容的文件。我们的 Moodle 版本是 1.9。

等待你的回复。

            回答 #4

赞同：0

时间：2009-04-22T08:58:30.327

我们现在包含了 version.php 文件，因此错误“Module devtp: C:\wamp\www\moodle/mod/devtp/version.php was not readable”不再出现。感谢您的帮助。但是，我们的模块仍然没有包含在 Moodle 的通知中。我们咨询了 MOODLE 站点以寻求帮助，“ [http://docs.moodle.org/en/Installing_contributed_modules_or_plugins](http://docs.moodle.org/en/Installing_contributed_modules_or_plugins) ”并按照说明进行操作：//访问您的本地 Moodle 站点[http ://localhost:8888/moodle19/](http://localhost:8888/moodle19/) 

站点管理通知滚动到页面底部并单击“继续”//

但事实是，我们的模块既没有出现在通知下，也没有继续出现。

等待你的回复...

            回答 #5

赞同：0

时间：2013-01-09T13:56:30.630

将视频添加到 Moodle 课程的一种简单方法（如果您不想创建或投资插件）是在 Moodle 课程中创建一个新的“页面”类型资源。

在该页面的 HTML 代码中添加用于嵌入视频的代码。视频可以托管在 youtube 或您自己的 CDN 上。对于自己的 CDN，您可能必须使用 video.js

        asp.net - asp.net gridview 控件不显示分页号码

ID：759180

赞同：0

时间：2009-04-17T05:48:58.563

标签：asp.net, gridview

我的 asp.net 网站有母版页。在使用母版页的页面之一上，我有 2 个网格视图控件。两者都绑定到自己的数据源控件。我试图在网格上启用分页，但没有显示分页。

请帮忙。

            回答 #1

赞同：0

时间：2009-04-17T06:08:43.443

尝试将 PageSize 属性设置为较小的值，例如 5，看看它是否出现。

也尝试设置`AllowCustomPaging="true"`属性。

        javascript - 在 JavaScript 中拆分字符串

ID：759185

赞同：0

时间：2009-04-17T05:50:21.587

标签：javascript, string

我尝试如下拆分数据，但显示错误“dat.split is not a function”。任何人都知道我该如何解决这个问题？

```
var dat = new Date("2009/12/12");
var r = dat.split('/'); 
```

            回答 #1

赞同：2

时间：2009-04-17T05:54:10.733

你不能`split()`是一个日期 - 你可以`split()`是一个字符串，但是：

```
var dat = "2009/12/12"; 
var r = dat.split('/'); 
```

返回：

```
["2009", "12", "12"] 
```

要对日期执行等效操作，请使用以下内容：

```
var dat = new Date();
var r = [dat.getFullYear(), dat.getMonth() + 1, dat.getDate()]; 
```

返回：

```
[2009, 4, 17] 
```

            回答 #2

赞同：1

时间：2009-04-17T05:53:26.400

尝试

```
dat.toString().split('/'); 
```

但此解决方案取决于语言环境

            回答 #3

赞同：1

时间：2009-04-17T05:56:50.557

您只想获取年、月和日吗？在这种情况下，您最好使用不依赖于语言环境的解决方案并调用以下函数：

```
dat.getDay();
dat.getMonth();
dat.getFullYear(); 
```

当然它们不会被零填充，但这很容易做到。

        sql - SQL Server 索引

ID：759199

赞同：3

时间：2009-04-17T06:00:17.240

标签：sql, sql-server

聚集索引扫描和聚集索引查找有什么区别？

            回答 #1

赞同：4

时间：2009-04-17T06:19:24.917

聚集索引扫描是对具有聚集索引的表进行的表扫描。默认情况下，主键是聚集索引，因此基本上是具有主键的表。

当谓词包含除主键以外的列（并且没有其他索引可用于满足谓词）时，会发生聚集索引扫描。

当谓词在索引中包含一个或多个列时，就会发生聚集索引查找（和非聚集索引查找）。这允许查询处理器根据索引查找行范围，而无需扫描。

            回答 #2

赞同：2

时间：2009-04-17T06:18:25.137

聚集索引 SCAN 从头到尾扫描整个聚集索引（= 数据表）。

聚集索引 SEEK 只扫描该索引的一个（希望很小）部分/部分 --> 快得多！

马克

            回答 #3

赞同：2

时间：2009-04-17T06:18:41.643

扫描会命中索引中的每个条目，而搜索只会向下遍历被查询的项目，从而使搜索速度更快。一般来说，除非必要，否则应避免扫描。

            回答 #4

赞同：1

时间：2009-04-17T06:28:19.793

当条件适合索引数据时使用搜索，以便它可以有效地利用索引，例如在如下查询中：

```
select Name from Table where Group = 42 
```

由于比较是直接值，因此可以很容易地用于定位项目所在的索引部分。

当条件更复杂时使用扫描，以便必须评估索引中的每个值，例如在如下查询中：

```
select Name from Table where right(cast(group as varchar), 2) = '00' 
```

由于条件使用从索引中计算出来的值，该值不能轻易地用于隔离索引的一部分，因此必须评估所有项目。

        c - 用双精度表示整数

ID：759201

赞同：23

时间：2009-04-17T06:00:44.010

标签：c, math, floating-point, precision, ieee-754

double（给定字节数，具有合理的尾数/指数平衡）能否始终完全精确地保持该字节数一半的无符号整数的范围？

例如，一个 8 字节的 double 能否完全精确地保存一个 4 字节的 unsigned int 的数字范围？

这将归结为如果一个两字节浮点数可以容纳一字节无符号整数的范围。

一字节的无符号整数当然是 0 -> 255。

            回答 #1

赞同：44

时间：2009-04-17T06:08:27.547

IEEE754 64 位双精度可以表示任何 32 位整数，因为它有 53 位奇数^((a))位可用于精度，而 32 位整数只需要 32 位 :-)

（非 IEEE754 双精度）64 位浮点数的精度低于 32 位是合理的。这将允许真正巨大的数字（由于指数），但以精度为代价。

底线是，如果浮点数的尾数中的精度位比整数中的位多（并且指数中有足够的位来缩放它），那么它可以在不损失精度的情况下表示。

^((a))从技术上讲，第 53 位精度是`1`在序列开头隐含的，因此“可变性”的数量可能只有 52 位。无论是 52 还是 53，仍然足够位来表示每个 32 位整数。

            回答 #2

赞同：7

时间：2009-04-17T06:09:15.813

是的。保证浮点数（或双精度数）准确表示不需要截断的任何整数。对于双精度数，有 53 位精度，因此足以准确表示任何 32 位整数，以及 64 位整数的一小部分（从统计上讲）。

            回答 #3

赞同：2

时间：2009-04-17T06:09:37.500

您可以准确表示的范围取决于您的实现中的许多因素，但您可以通过以下方式来降低它的下限：如果指数字段设置为 0，您可以准确表示宽度为你的尾数字段（假设一个符号位）。对于 IEEE 754 双精度，这意味着您可以精确地表示 52 位数字。通常，您的尾数将超过整个结构宽度的一半。

            回答 #4

赞同：-5

时间：2009-04-17T06:08:55.237

在谈论浮点数时，我不会使用“完全精确”这个词。但是是的，a`double`可以表示一个 32 位整数。

我不知道浮点数和整数的其他哪些组合也是如此。

实际上，您不想费心使用高于机器支持的浮点数，因此只需切换到使用 bignums 的有理算术即可。这样，您就可以保证精度。

        php - PHP：仅在 HTML 标记之外转义引号（正则表达式）

ID：759203

赞同：1

时间：2009-04-17T06:01:35.317

标签：php, html, regex, escaping

什么正则表达式可以识别 HTML 标记（已经被验证）之外的双引号以将它们转义为`&quot;`?

            回答 #1

赞同：6

时间：2009-04-17T06:33:28.237

没有这样的正则表达式。

```
<p>
  <!-- <a href=" --> is this outside " a tag <!-- "> foo </a> --> or not?
</p> 
```

如果你想这样做，很遗憾你必须使用 HTML 解析器。由于您已经验证了 HTML，您可能已经有一个解析器可以使用。

            回答 #2

赞同：1

时间：2009-04-17T06:46:20.920

不要为此使用正则表达式，使用（或编写）解析器。

以下代码假定输入的 HTML 字符串格式正确（如您所述）。请注意，如果遇到无效输入，代码将中断！

如果你不能确定格式是否正确，你可以试试[PHP Tidy 。](http://de.php.net/tidy)

```
<?php
$html = '<tag>text "text"<tag attr="value"><!-- "text" --> text</tag> "text".';
echo html_escape_quotes($html);

/* Parses input HTML and escapes any literal double quotes 
   in the text content with &quot;. Leaves comments alone.  */
function html_escape_quotes($html)
{
  $output = "";
  $length = strlen($html);
  $delim  = "<";
  $offset = 0;
  while ($offset < $length) {
    $tokpos = strpos($html, $delim, $offset);
    if ($tokpos === false) $tokpos = $length;

    $token  = substr($html, $offset, $tokpos - $offset);
    $offset = $tokpos;

    if ($delim == "<") {
      $token = str_replace('"', '&quot;', $token);
      $delim = substr($html, $offset, 4) == "<!--" ? "-->" : ">";
    } else {
      $delim = "<";
    }

    $output .= $token;
  }
  return $output;
}
?> 
```

            回答 #3

赞同：0

时间：2009-04-17T10:45:01.113

这是可能的。

您也许可以使用正则表达式来做到这一点，类似于下面的内容。您将不得不多次运行它，因为此正则表达式仅将标签之间的 1 " 替换为 '。

```
Serach: (\<.+?\>.+?)(")(.+?\</.+?\>)
Replace: $1'$3 
```

但是，更好的方法是利用回调来进行函数替换。只需创建将标签内容发送到函数的 RE，然后可以简单地将 " 替换为您想要的任何内容。

[在此处](http://www.regular-expressions.info/php.html)查看更多信息。搜索回调。正如 derobert 所说，您可能需要在此之前删除评论:)

            回答 #4

赞同：0

时间：2009-09-18T13:02:21.373

不是最好的（不是在所有情况下都适用）但对我来说已经足够了：

```
function quoting(&$data) {
    $quot  = '(["\x93\x94\x84]|\&#8220;|\&#8222;|\&#8221;|\&ldquo;|\&bdquo;|\&rdquo;|\&quo;|\&#34;)';
    $parse = '<q>$2</q>';
    $data  = preg_replace('/="([^"]*)"/', '*%Q:$1%*', $data);
    $data  = preg_replace("/$quot(.*?)$quot/", $parse, $data);
    $data  = preg_replace('/\*%Q:(.*?)%\*/', '="$1"', $data);
} 
```

            回答 #5

赞同：0

时间：2009-04-17T11:17:05.153

您可以尝试使用以下表达式拆分字符串并将标签与文本数据分开：

```
<(?:\?[^?]+\?>|[A-Za-z]+(?:[^">]+|"[^"]*")*|!(?:\[CDATA\[(?:[^\]]+|](?:[^\]]|][^>]))*]]|--(?:[^-]+|-(?!->))*--))> 
```

这将（希望）匹配任何 XML PI、元素标记、CDATA 和注释块。

所以：

```
$parts = preg_split('/(<(?:\?[^?]+\?>|[A-Za-z]+(?:[^">]+|"[^"]*")*|!(?:\[CDATA\[(?:[^\]]+|](?:[^\]]|][^>]))*]]|--(?:[^-]+|-(?!->))*--))>)/', $str, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE);
$str = '';
foreach ($parts as $part) {
    if ($part[0] == '<') {
        $str .= $part;
    } else {
        $str .= str_replace('"', '&quot;', $part);
    }
} 
```

但我怀疑这是否非常有效。真正的解析器会更有效率和正确。

            回答 #6

赞同：0

时间：2009-04-17T06:26:01.407

这行得通吗？    

```
\"(?!\s*\w*>) 
```

        java - 在 Java 中表示线程注释的最有效数据结构？

ID：759208

赞同：4

时间：2009-04-17T06:03:55.453

标签：java, data-structures, tree, reddit, threaded-comments

我想用 Java 表示**线程注释**。这看起来类似于***reddit.com上的评论方式***

```
hello
   hello
      hello
      hello
   hello
   hello
      hello 
```

如上例所示，响应以适当的缩进嵌套在 HTML 中，以反映它们与先前评论的关系。

在 Java 中表示这一点的有效方法是什么？

我在想某种**树数据结构**是合适的。

但是，是否有一个特别能*最有效*地最小化树遍历的方法？

如果我对每条评论都进行投票，这将很重要。因为每次投票后都需要对树进行重新排序——这在计算上可能是一项昂贵的操作。

顺便说一句，如果有人知道 Java 中有一个开源的现有实现，那也会有所帮助。

            回答 #1

赞同：10

时间：2009-04-17T06:14:53.040

我会使用链表的级别。

```
message1
    message2
        message3
        message4
    message5
    message6
        message7 
```

每个节点都有一个指向它的指针：

```
- forward sibling  (2->5, 3->4, 5->6,                   1/4/6/7->NULL).
- backward sibling (4->3, 5->2, 6->5,                   1/2/3/7->NULL).
- first child      (1->2, 2->3, 6->7,                   3/4/5/7->NULL).
- parent           (2->1, 3->2, 4->2, 5->1, 6->1, 7->6,       1->NULL). 
```

在每个级别中，消息将按投票计数（或您想要使用的任何其他分数）在列表中排序。

这将为您移动事物提供最大的灵活性，并且您可以`message2`仅通过更改父级和该级别的链接来移动整个子树（例如，）。

例如，say`message6`获得大量选票，使其比`message5`. 更改是（调整下一个和上一个兄弟指针）：

*   `message2 -> message6`
*   `message6 -> message5`
*   `message5 -> NULL`.

要得到：

```
message1
    message2
        message3
        message4
    message6
        message7
    message5 
```

如果它一直持续到获得的票数超过`message2`，则会发生以下情况：

*   `message6 -> message2`
*   `message2 -> message5`

*AND*的第一个子指针`message1`设置为`message6`（它是`message2`），仍然相对容易获得：

```
message1
    message6
        message7
    message2
        message3
        message4
    message5 
```

仅当分数更改导致消息变得大于其上兄弟或小于其下兄弟时才需要重新排序。您无需在每次更改分数后重新排序。

            回答 #2

赞同：4

时间：2009-04-17T06:11:47.353

树是正确的（使用 getLastSibling 和 getNextSibling），但是如果您正在存储/查询数据，您可能希望存储每个条目的沿袭，或者通过前序遍历存储编号：

[http://www.sitepoint.com/article/hierarchical-data-database/2/](http://www.sitepoint.com/article/hierarchical-data-database/2/)

对于丢失确切数量的子节点，您可以留下间隙以尽量减少重新编号。不过，我不确定这是否会比每次遍历树快得多。我想这取决于你的树长得有多深。

也可以看看：

[SQL - 如何存储和导航层次结构？](https://stackoverflow.com/questions/38801/sql-how-to-store-and-navigate-hierarchies)
[http://www.ibase.ru/devinfo/DBMSTrees/sqltrees.html](http://www.ibase.ru/devinfo/DBMSTrees/sqltrees.html)（此方案也称为 Celko 树）

            回答 #3

赞同：0

时间：2009-04-17T06:09:55.937

如果我对每条评论都进行投票，这将很重要。因为每次投票后都需要对树进行重新排序——这在计算上可能是一项昂贵的操作。

对我来说，这听起来像是一个过早的优化，甚至可能是一个错误的优化。

您的树数据结构对于表示您的数据来说听起来是合乎逻辑的。我说坚持下去。只有在检测到和测量性能问题并且可以与替代方案进行比较时，才可以稍后对其进行优化。

        c# - 为什么 C# 编译器显式声明一个类型实现的所有接口？

ID：759215

赞同：14

时间：2009-04-17T06:07:14.103

标签：c#, .net, clr, cil

C# 编译器似乎明确指出了它的所有接口，以及它的基类实现。CLI 规范说这不是必需的。我见过其他一些编译器没有明确地发出这个，它似乎工作正常。C# 这样做有什么区别或原因吗？

底部的 C# 为 B 生成的 MSIL 是：

```
.class private auto ansi beforefieldinit B
       extends A
       implements IAdvanced,
                  ISimple 
```

它不需要指定 ISimple，因为 A 像 IAdvanced 一样实现它。C#代码：

```
interface ISimple {
    int Basic { get;  }
    int Zero { get;  }
}
interface IAdvanced : ISimple {
    string Major { get; }
}
class A : ISimple {
    int ISimple.Basic {
        get { return 1; }
    }
    int ISimple.Zero {
        get{ return 0;}
    }
}
class B : A, IAdvanced {
    string IAdvanced.Major {
        get { return "B"; }
    }
} 
```

            回答 #1

赞同：8

时间：2009-04-17T06:33:25.443

我不认为我们可以在这里知道任何明确的答案，除非我们有编译器开发人员加入。但是，我们可以猜测原因。它可能是：

1.  用于优化 - 也许它为 JIT 编译器节省了一些工作。
2.  为了可读性 - 使人眼在查看 MSIL 输出时更容易掌握类型实现的内容。
3.  因为这就是暑期实习生实施它的方式，而且由于它运行良好，没有人会改变它以防万一它坏了。

        c# - 在 C# 中实现组合和聚合？

ID：759216

赞同：8

时间：2009-04-17T06:07:25.350

标签：c#, oop

我/（最好的方法是）如何在 C# 中实现组合和聚合？

感谢 123 开发者

            回答 #1

赞同：20

时间：2009-04-17T07:41:58.383

这是一个非常抽象的问题，因为组合和聚合都非常相似并且实际上只是在概念上有所不同，并且不一定在代码级别。（即，您可能认为具有 Engine 的 Car 是组合，而 Dog 具有 fleas 是聚合，但如果您在代码中建模它们，没有什么能阻止您以相同的方式实现它们）。

但是，如果您想打破差异并尝试强制添加软件设计决策以突出这些差异，我想您可以做这样的事情......以[维基百科为例](http://en.wikipedia.org/wiki/Object_composition#Aggregation)：

聚合与普通组合的不同之处在于它并不意味着所有权。在组合中，当拥有对象被销毁时，包含的对象也会被销毁。在聚合中，这不一定是正确的。例如，一所大学拥有多个系（例如化学），每个系都有许多教授。如果大学关闭，这些系将不复存在，但这些系的教授将继续存在。因此，大学可以看作是系的组合，而系则是教授的集合。此外，教授可以在多个系工作，但一个系不能隶属于多个大学。

您可以构建此代码来表示它（具有尽可能多的组合/聚合的人为指示）：

```
public class University : IDisposable
{
    private IList<Department> departments = new List<Department>();

    public void AddDepartment(string name)
    {
        //Since the university is in charge of the lifecycle of the
        //departments, it creates them (composition)
        departments.Add(new Department(this, name));
    }

    public void Dispose()
    {
        //destroy the university...
        //destroy the departments too... (composition)
        foreach (var department in departments)
        {
            department.Dispose();
        }
    }
}

public class Department : IDisposable
{
    //Department makes no sense if it isn't connected to exactly one
    //University (composition)
    private University uni;
    private string name;

    //list of Professors can be added to, meaning that one professor could
    //be a member of many departments (aggregation)
    public IList<Professor> Professors { get; set; }

    // internal constructor since a Department makes no sense on its own,
    //we should try to limit how it can be created (composition)
    internal Department(University uni, string name)
    {
        this.uni = uni;
        this.name = name;
    }

    public void Dispose()
    {
        //destroy the department, but let the Professors worry about
        //themselves (aggregation)
    }
}

public class Professor
{
} 
```

            回答 #2

赞同：5

时间：2009-04-17T07:32:11.637

好吧，在一个所有对象都通过引用访问的垃圾收集世界中，严格组合和聚合之间的细微差别（所有权）有点模糊 - 所以*通常*（使用类时）它归结为另一个对象的字段或收藏：

```
class Building {
    private readonly List<Room> rooms = new List<Room>();
    public IList<Room> Rooms {get {return rooms;}}

    public Address Address {get;set;}
    //...
}
class Address {
    public string Line1 {get;set;}
    public string PostCode {get;set;}
    //...
}
class Room {
    public string Name {get;set;}
    public int Capacity {get;set;}
    //...
} 
```

如果我错过了重点，请澄清...

当您讨论 s 时，事情会涉及更多`struct`- 但通常在谈论 OO 概念时，`struct`使用仅限于值字段......

        c# - 从 wpf 数据网格中获取元素

ID：759227

赞同：1

时间：2009-04-17T06:11:25.873

标签：c#, wpf, .net-3.5, datagrid

我有 wpf 数据网格，在其中一列中，我在其中添加了复选框，现在的问题是如何获得它的“IsChecked”属性？

注意：我没有将该列绑定到任何数据上下文，它是一个模板列

谢谢

            回答 #1

赞同：1

时间：2009-04-17T06:15:13.633

这取决于您如何使用 DataGrid。在正确的 MVVM 数据绑定模式中，您可能已经将类的 bool 属性绑定到复选框，并且每当复选框更改其值时，您将在 ViewModel 类中收到属性更改通知。

            回答 #2

赞同：0

时间：2009-04-17T06:13:31.530

你需要要么

1.  使用 XAML 中的变量或标识符记录这些复选框。或者，
2.  使用某些识别功能（谓词）遍历网格的子节点以查找复选框。

        c# - 将嵌套 XML 加载到数据集中

ID：759243

赞同：1

时间：2009-04-17T06:20:24.883

标签：c#, xml, dataset

如何将以下嵌套 XML 加载到 DataSet 中？

```
<items>
  <item>
   <id>i1</id>
   <name>item1</name>
   <subitems>
    <name>subitem1</name>
    <name>subitem2</name>
   </subitems>
  </item>
  <item>
   <id>i2</id>
   <name>item2</name>
   <subitems>
    <name>subitem1</name>
    <name>subitem2</name>
   </subitems>
  </item>
 </items> 
```

我可以得到尽可能多的“项目”表，但我如何获得子项目？

```
 MemoryStream itemsStream = new MemoryStream(Encoding.ASCII.GetBytes(itemsXML));
 DataSet itemsSet = new DataSet();
 itemsSet.ReadXml(itemsStream);
 foreach (DataRow itemRow in itemsSet.Tables["item"].Rows) {
     Console.WriteLine("column id=" + itemRow["id"] as string + " name=" + itemRow["name"] as string);
 } 
```

            回答 #1

赞同：2

时间：2009-04-17T08:55:03.200

这对我有用，我唯一的自由是更改子项的字段名称。

子项的原始 XML

```
 <subitems>
     <name>subitem1</name>
     <name>subitem2</name>
   </subitems> 
```

为子项修改 XML

```
 <subitems>
       <name1>subitem1</name1>
       <name2>subitem2</name2>
   </subitems> 
```

这是代码。

```
 DataSet myDS = new DataSet();
        DataTable myTable = new DataTable("item");
        myTable.Columns.Add("id", typeof(string));
        myTable.Columns.Add("name", typeof(string));
        myTable.Columns.Add("name1", typeof(string));
        myTable.Columns.Add("name2", typeof(string));

        myDS.Tables.Add(myTable);

        string xmlData = "<items>  <item>   <id>i1</id>   <name>item1</name>   <subitems>    <name1>subitem1</name1>    <name2>subitem2</name2>   </subitems>  </item>  <item>   <id>i2</id>   <name>item2</name>   <subitems>    <name1>subitem3</name1>    <name2>subitem4</name2>   </subitems></item></items>";
        System.IO.MemoryStream itemsStream = new System.IO.MemoryStream(Encoding.ASCII.GetBytes(xmlData));

        myDS.ReadXml(itemsStream, XmlReadMode.IgnoreSchema);
        foreach (DataRow itemRow in myDS.Tables["item"].Rows)
        {
            MessageBox.Show("column id=" + itemRow["id"]  + " name=" + itemRow["name"]);
            MessageBox.Show(itemRow["name1"].ToString() + " - " + itemRow["name2"].ToString());
        } 
```

            回答 #2

赞同：0

时间：2011-04-26T21:53:23.247

使用数据集 ReadXml。您必须向后关注以下链接上的文章：

[http://msdn.microsoft.com/en-us/library/7sfkwf9s(v=VS.100).aspx](http://msdn.microsoft.com/en-us/library/7sfkwf9s(v=VS.100).aspx)

例如：

```
DataSet ds = new DataSet();
ds.ReadXml(new StringReader(nestedXml));
StringBuilder sb = new StringBuilder();
ds.WriteXml(new StringWriter(sb));
Response.Write(sb.ToString()); 
```

当然，您可以使用`ds.Tables[0]`and单独读取表格`ds.Tables[1]`

            回答 #3

赞同：0

时间：2013-08-30T12:26:14.787

```
String sss = @"<items>
<item>
  <id>i1</id>
   <name>item1</name>
    <subitems>
     <name>subitem1</name>
     <name>subitem2</name>
    </subitems>
   </item>
   <item>
    <id>i2</id>
     <name>item2</name>
      <subitems>
       <name>subitem1</name>
       <name>subitem2</name>
      </subitems>
     </item>
    </items>";

StringReader rr = new StringReader(sss);
DataSet sdread = new DataSet();
sdread.ReadXml(rr); 
```

        sql-server - SQL Server：表中的最大行数

ID：759244

赞同：81

时间：2009-04-17T06:20:46.490

标签：sql-server, database-design

我开发的软件将大量数据存储在其中一个数据库表（SQL Server 版本 8、9 或 10）中。假设每天大约有 100,000 条记录插入到该表中。这大约是每年 3600 万条记录。由于担心性能下降，我决定每天创建一个新表（名称中包含当前日期的表）以减少每个表的记录数。

你能告诉我，这是否是个好主意？SQL Server 表有记录限制吗？或者您知道在性能显着降低之前可以在表中存储多少条记录（或多或少）？

            回答 #1

赞同：95

时间：2010-10-06T20:51:48.793

这些是[SQL Server 2008 R2 的一些最大容量规范](http://msdn.microsoft.com/en-us/library/ms143432.aspx) 

*   数据库大小：524,272 TB
*   每个 SQL Server 实例的数据库：32,767
*   每个数据库的文件组：32,767
*   每个数据库的文件：32,767
*   文件大小（数据）：16 TB
*   文件大小（日志）：2 TB
*   每张桌子的行数：*受可用存储空间的限制*
*   每个数据库的表：*受数据库中对象数量的限制*

            回答 #2

赞同：61

时间：2014-03-04T13:48:56.200

我在 SQL Server 2008 R2 中有一个包含超过 60 亿行的三列表。

我们每天查询它，为我们的客户创建每分钟的系统分析图表。我没有注意到任何数据库性能下降（尽管它每天增长约 1 GB 的事实确实使管理备份比我想要的要复杂一些）。

**2016 年 7 月更新**

[![行数](https://i.stack.imgur.com/xam3E.png)](https://i.stack.imgur.com/xam3E.png)

在备份变得足够大以至于我们决定截断超过两年的记录（约 700 GB 存储在多个备份中，包括昂贵的磁带上）之前，我们将其记录到了**大约 245 亿行。**值得注意的是，性能并不是这个决定的重要动力（即，它仍然工作得很好）。

对于任何发现自己试图从 SQL Server 中删除 200 亿行的人，我强烈推荐[这篇文章](http://social.technet.microsoft.com/wiki/contents/articles/20651.sql-server-delete-a-huge-amount-of-data-from-a-table.aspx)。链接失效时的相关代码（阅读文章以获得完整解释）：

```
ALTER DATABASE DeleteRecord SET RECOVERY SIMPLE;
GO

BEGIN TRY
    BEGIN TRANSACTION
        -- Bulk logged 
        SELECT  *
        INTO    dbo.bigtable_intermediate
        FROM    dbo.bigtable
        WHERE   Id % 2 = 0;

        -- minimal logged because DDL-Operation 
        TRUNCATE TABLE dbo.bigtable;  

        -- Bulk logged because target table is exclusivly locked! 
        SET IDENTITY_INSERT dbo.bigTable ON;
        INSERT INTO dbo.bigtable WITH (TABLOCK) (Id, c1, c2, c3)
        SELECT Id, c1, c2, c3 FROM dbo.bigtable_intermediate ORDER BY Id;
        SET IDENTITY_INSERT dbo.bigtable OFF;
    COMMIT
END TRY
BEGIN CATCH
    IF @@TRANCOUNT > 0
        ROLLBACK
END CATCH

ALTER DATABASE DeleteRecord SET RECOVERY FULL;
GO 
```

**2016 年 11 月更新**

如果您打算将这么多数据存储在一个表中：不要。我强烈建议您考虑表分区（如果您正在运行企业版，则手动或使用内置功能）。这使得删除旧数据就像每周（每周/每月/等）截断一次表一样容易。如果您没有 Enterprise（我们没有），您可以简单地编写一个脚本，该脚本每月运行一次，删除超过 2 年的表，创建下个月的表，并重新生成连接所有分区的动态视图表放在一起，方便查询。显然，“每月一次”和“超过 2 年”应该由您根据对您的用例有意义的内容来定义。

            回答 #3

赞同：37

时间：2009-04-17T06:27:34.180

很难给出一个通用的答案。这实际上取决于许多因素：

*   你的行是多大的
*   你存储什么样的数据（字符串、blob、数字）
*   您如何处理您的数据（只需将其保存为存档，定期查询）
*   你的桌子上有索引吗 - 有多少
*   你的服务器规格是什么

等等

正如此处其他地方所回答的那样，每天 100,000 份，因此每张桌子都是多余的——我建议每月或每周甚至每季度一次。您拥有的表越多，维护/查询的噩梦就越大。

            回答 #4

赞同：20

时间：2009-04-17T06:23:40.880

我不具体了解 MSSQL，但 3600 万行对于企业数据库来说并不大 - 使用大型机数据库，100,000 行对我来说听起来像是一个配置表:-)。

*虽然我不是微软某些*软件的忠实粉丝，但这不是我们在这里讨论的 Access：我假设他们可以使用他们的企业 DBMS 处理相当大的数据库大小。

我怀疑，如果确实需要划分的话，日子可能是一个太好的决议，无法划分它。

            回答 #5

赞同：20

时间：2009-04-17T06:27:32.963

我不知道行数限制，但我知道有超过 1.7 亿行的表。您可以使用分区表 (2005+) 或连接多个表的视图来加速它。

            回答 #6

赞同：6

时间：2010-10-06T21:01:09.667

我们在 SQL Server 2005 和 2008 中有超过 10 亿行的表（每天增加 3000 万行）。我无法想象每天把它分成一张新桌子的老鼠窝。

添加适当的磁盘空间（无论如何您都需要）和 RAM 要便宜得多。

            回答 #7

赞同：4

时间：2009-04-22T09:02:42.703

这取决于，但我会说为了简单起见，最好将所有东西都放在一张桌子上。

每天 100,000 行并不是一个巨大的数量。（取决于您的服务器硬件）。我个人见过 MSSQL 在单个表中处理多达 100M 行而没有任何问题。只要您保持索引井井有条，一切都会好起来的。关键是要有*大量*内存，这样就不必将索引换出到磁盘。

另一方面，这取决于您如何使用数据，如果您需要进行大量查询，并且可能需要跨越多天的不太可能的数据（因此您不需要加入表），它将是更快地将其分成多个表。这通常用于工业过程控制等应用中，您可能每 10 秒读取 50,000 台仪器的值。在这种情况下，速度非常重要，但简单性不是。

            回答 #8

赞同：3

时间：2010-10-06T21:11:53.957

我们在一个表上溢出了一次整数主键（大约 24 亿行）。如果存在行数限制，那么您不可能每年仅达到 3600 万行。

            回答 #9

赞同：2

时间：2009-04-22T08:25:36.397

您可以填充该表，直到您有足够的磁盘空间。
为了获得更好的性能，您可以尝试迁移到 SQL Server 2005，然后对表进行分区并将部分放在不同的磁盘上（如果您有真正可以帮助您的 RAID 配置）。分区只能在 SQL Server 2005 的企业版中进行。您可以查看[此链接中的分区示例](https://docs.microsoft.com/en-us/previous-versions/technet-magazine/cc162478(v=msdn.10))。
您也可以尝试为最常用的数据部分创建视图，这也是解决方案之一。

            回答 #10

赞同：0

时间：2012-08-10T21:49:55.973

我在 Windows2003 上的 SQL Server 8 上遇到的最大表是 7.99 亿，有 5 列。但是是否好意要根据 SLA 和使用案例来衡量——例如加载 50-100,000,000 条记录，看看它是否仍然有效。

            回答 #11

赞同：-1

时间：2010-01-18T05:39:05.400

```
SELECT Top 1 sysobjects.[name], max(sysindexes.[rows]) AS TableRows, 
  CAST( 
    CASE max(sysindexes.[rows]) 
      WHEN 0 THEN -0 
      ELSE LOG10(max(sysindexes.[rows])) 
    END 
    AS NUMERIC(5,2)) 
  AS L10_TableRows 
FROM sysindexes INNER JOIN sysobjects ON sysindexes.[id] = sysobjects.[id] 
WHERE sysobjects.xtype = 'U' 
GROUP BY sysobjects.[name] 
ORDER BY max(rows) DESC 
```

            回答 #12

赞同：-4

时间：2012-09-07T18:10:55.950

每月对表进行分区。这是处理每天大量涌入的表的最佳方式，无论是 oracle 还是 MSSQL。

        xml - 如何在 xml 中编写相对 unix 路径

ID：759247

赞同：-2

时间：2009-04-17T06:21:42.523

标签：xml, linux, path

当我在 unix 中运行一个进程时，路径指向 /abc/1/2/3

我正在为在路径中运行的进程在 xml 中设置一个属性。我拥有的一处房产

```
< property name="log.path" value="/abc/4/5"/ > 
```

问题是我不能像上面那样给出绝对路径（“/abc/1/2/3”）。我必须给出类似“../../../4/5”的东西。

```
< property name="log.path" value="../../../4/5"/ > 
```

我的问题是为什么上述评估不起作用？目前它正在将 value 中给出的路径视为常量。

            回答 #1

赞同：2

时间：2009-04-17T09:04:56.407

XML 只是一种用于存储结构化数据的标准化格式......它没有指定元素属性的*含义*，因为它不知道（例如）该属性在语义上是 Unix 类型的路径。

所以这实际上不是关于 XML 的问题，而是关于读取 XML 的应用程序如何处理指定路径的问题。例如（如前所述），它认为当前的目录将影响相对路径的解释......假设应用程序实际上正确解析了相对路径。

            回答 #2

赞同：0

时间：2009-04-17T08:22:18.210

查看[http://en.wikipedia.org/wiki/Path_(computing)](http://en.wikipedia.org/wiki/Path_(computing))

总之，你所做的是绝对正确的。如果它不起作用，则问题可能是应用程序执行时，它在与您期望的文件夹不同的文件夹中执行。

如果您提供更多详细信息可以解决

坦迈

            回答 #3

赞同：0

时间：2009-04-20T06:57:00.340

好的，我们来分析一下。

当我在 unix 中运行一个进程时，路径指向 /abc/1/2/3

现在该进程的可执行文件是否存在于*/abc/1/2/3*或*/abc/1/2/3*是您的进程的[当前工作目录](http://en.wikipedia.org/wiki/Current_working_directory)？

如果进程的当前工作目录是*/abc/1/2/3*并且该进程读取该 XML 文件并尝试直接使用其中的路径以及诸如*open*之类的系统调用，那么相对路径表示法*../../。 ./4/5*应该可以工作。但是，如果路径*/abc/1/2/3*不是当前工作目录，而只是可执行文件的位置，则*../../../4/5*无法工作，因为当前工作目录不是*/abc /1/2/3*和相对路径总是对当前工作目录起作用。

确保检查*/abc/1/2/3*是否真的是当前工作目录，而不仅仅是可执行位置。

        apache - www 到非 www 重定向 .htaccess 代码不在我的网站上工作？

ID：759251

赞同：0

时间：2009-04-17T06:26:03.573

标签：apache, .htaccess, url-routing

我想通过 .htaccess将[http://www.example.com](http://www.example.com)重定向到[http://example.com 。](http://example.com)我已经找到并尝试了下面列出的代码，但没有任何效果。任何机构都可以告诉我解决方案。

[当我输入http://www.example.com](http://www.example.com)`Socket Error 10049`时，我在所有代码上都收到此错误

我主机的**Apache 版本是 2.0.63**。我的 .htaccess 文件位于 public_html/

```
Options +Followsymlinks
RewriteEngine on
RewriteBase /
RewriteCond %{HTTP_HOST} .
RewriteCond %{HTTP_HOST} ^www\.example\.com
RewriteRule (.*) http://example.com/$1 [R=301,L,QSA]

RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.example\.com
RewriteRule (.*) http://example.com/$1 [R=301,L]

RewriteEngine On
RewriteCond %{HTTP_HOST} ^www.example.com
RewriteRule (.*) http://example.com/ [R=301,L]

RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.example\.com [NC]
RewriteRule (.*) http://example.com/$1 [R=301,L] 

RewriteEngine On
RewriteCond %{HTTP_HOST} .
RewriteCond %{HTTP_HOST} !^example\.com
RewriteRule (.*) http://example.com/$1 [R=301,L] 

RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\. [NC]
RewriteRule ^(.*)$ %{HTTP_HOST}$1 [C]
RewriteRule ^www\.(.*)$ http://$1 [L,R=301] 
```

            回答 #1

赞同：3

时间：2009-04-18T05:17:08.257

我在所有代码上都收到此错误 Socket Error 10049

我不认为这是由 www 重定向引起的。这通常是您尝试在服务器没有的 IP 地址上“监听”时得到的结果。（通常当您将 httpd.conf 从一台服务器复制到另一台服务器时。）

顺便说一句，如果您可以访问 httpd.conf，那么使用“重定向”对单个站点进行重定向会更简单、更快捷。

```
<VirtualHost *:80>
    ServerName example.com
    ...real settings...
</VirtualHost>
<VirtualHost *:80>
    ServerName www.example.com
    Redirect permanent / http://example.com/
</VirtualHost> 
```

            回答 #2

赞同：0

时间：2009-04-17T06:29:10.027

[http://no-www.org/](http://no-www.org/)

尝试

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
```

            回答 #3

赞同：0

时间：2009-09-29T15:38:09.310

希望这可以帮助。

[http://basilvarghese.co.cc/using-htaccess-for-redirection.html](http://basilvarghese.co.cc/using-htaccess-for-redirection.html)

        c# - 在 Excel 中插入行（后期绑定）

ID：759253

赞同：0

时间：2009-04-17T06:26:27.117

标签：c#, excel

我正在尝试将行插入 Excel。我正在使用后期绑定。我打开了 excel 工作簿，复制工作表，将值插入单元格，但我无法弄清楚如何在特定行之后插入新行。

            回答 #1

赞同：1

时间：2009-04-17T06:56:59.070

我有一个从 .NET 控制 MS Office 的爱好项目：[MS Office for .NET](http://www.codeplex.com/msofficefornet) - 有一些小示例。

确定如何做某事的最佳方法。是打开excel，开始宏录制，做我想做的事情，停止宏录制，然后查看VBA并将代码复制到我的项目中。

        excel - 复制文件时将宏重新分配给命令按钮

ID：759256

赞同：3

时间：2009-04-17T06:27:56.487

标签：excel, vba

当源工作表复制到新工作簿中的目标工作表时，我在 XL 中遇到了关于重新定义单选按钮的宏分配的问题。

当我单击目标工作表中的单选按钮时，它会尝试打开源工作簿以运行分配给该按钮的宏。

我已经检查并且目标工作簿确实具有与原始源工作簿相同的宏副本。但是，通过右键单击单选按钮上的/分配宏，我发现路径仍然指向源工作簿/工作表。

我从源工作表运行它时尝试了以下代码，但它不起作用。

代码：

```
wbkDESTINATION.Sheets("1-Start").Select
ActiveSheet.Shapes("Option Button 1").Select
Selection.OnAction = "Sheet1.WEEKLY" 
```

感谢您的建议，即如何修改最后一个`Selection.OnAction`代码，以便 XL 知道从目标工作表中选择它，而不是跳回原始源工作簿。

谢谢

            回答 #1

赞同：0

时间：2009-04-21T11:39:11.697

哦！刚刚意识到您正在使用表单控件。您可以通过显式引用工作簿来确保调用所需的过程，如下所示：

```
wbkDESTINATION.Sheets("1-Start").Select
ActiveSheet.Shapes("Option Button 1").Select
Selection.OnAction = ThisWorkbook.name & "!Sheet1.WEEKLY" 
```

~~我认为虽然控件出现在 Shapes 集合中，但它们实际上是 OLE 对象，在工作表代码模块中具有自己的 _click 事件，并且不能通过`onaction`. 但是，可以预见的是，对于这一重要区别的帮助是模糊的。~~~~我自己在测试过程中证实了这一点；控件始终引用父工作表中的 _click 事件。你是如何复制工作表的？我尝试使用用户界面，并通过标准和工作表代码模块以编程方式，每次都得到相同的结果。~~

            回答 #2

赞同：0

时间：2017-11-08T10:16:58.047

这是相当更新的，但我将其发布给未来的寻求者。

我遇到了这个问题，因为我遇到了与提到的完全相同的问题。最后，我找到了以下解决方案，并获得了有关如何从源工作表中删除连接的提示（如果它们存在）。

[https://www.thespreadsheetguru.com/blog/correcting-shape-assigned-macro-links-after-copying-worksheet-vba](https://www.thespreadsheetguru.com/blog/correcting-shape-assigned-macro-links-after-copying-worksheet-vba)

        javascript - 计算一个系列的所有组合

ID：759259

赞同：3

时间：2009-04-17T06:29:20.947

标签：javascript, set, combinations

我有一个项目清单，每个项目都有一个数量。

```
var items = {
    1: 12,   // we have 12 x item1
    2: 1,    // we have 1 x item2
    3: 1,
    4: 7,
    5: 2,
    6: 2
}; 
```

或者，这可以被视为：

```
var items = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
             2, 3, 4, 4, 4, 4, 4, 4, 4, 5, 5, 6, 6]; 
```

您将如何获取这些项目的每个组合的列表，请记住顺序完全不重要（因此`[1,2,3] == [3,2,1]`），并且并非每个项目都必须存在于结果中。

我想输出可能如下所示：

```
[1]
[1, 1]
[1, 2]
[1, 3]
... 
```

或者，甚至更好：

```
{1 : 1}          // 1 x item1
{1 : 2}          // 2 x item1 
{1 : 1, 2 : 1}   // 1 x item1, 1 x item2
{1 : 1, 3 : 1}
.... 
```

            回答 #1

赞同：2

时间：2009-04-17T14:46:44.853

**更新：**发布此答案后，我注意到[现有答案](https://stackoverflow.com/questions/759259/calculate-all-combinations-of-a-series/759293#759293)具有相同的方法，但我仍然会保留我的答案，因为它更冗长，甚至有工作代码:)

如果原始项目池中的每个项目只有一个实例，并且您的项目表示二进制数字；

```
var items {
    1 : 1,
    2 : 1,
    4 : 1,
    8 : 1,
    16: 1,
    32: 1
}; 
```

问题将被简化为生成可以由这些数字表示的所有数字的序列：

*   0（[ ] - 没有项目）
*   1 ([ 1 ])
*   2 ([ 2 ])
*   3 ([ 2, 1 ])
*   4 ([ 4 ])
*   等等

因此，您的问题可以被视为简单地询问可以由 - 不是二进制 - 而是[混合基数](http://en.wikipedia.org/wiki/Mixed_radix)数字系统表示的数字序列。

这意味着，您可以为这个奇怪的编号系统编写一个计数器来遍历值 0 和 MAX。因此，您将从增加最低有效数字开始，并在您用尽该数字可以采用的所有可能值时继续到更高有效数字。

```
var items = {
    1: 12,   // we have 12 x item1
    2: 1,    // we have 1 x item2
    3: 1,
    4: 7,
    5: 2,
    6: 2
};

var counter = {
    1: 0,
    2: 0,
    3: 0,
    4: 0,
    5: 0,
    6: 0
};

function increment(digit) {
    if (digit > 6) {
        return false;
    }

    var value = counter[digit] + 1;

    if (value > items[digit]) {
        counter[digit] = 0;
        return increment(digit + 1);
    }

    counter[digit] = value;

    return true;
}

while (increment(1)) {
    var set = [];

    for (var digit in counter) {
        var value = counter[digit];

        for (var i = 0; i < value; i++) {
            set.push(digit);
        }
    }

    document.write("<div>" + set + "</div>");
} 
```

输出看起来像这样：

```
1
1,1
1,1,1

---- 剪断 ----

2
1,2
1,1,2

---- 大剪 ----

1,1,1,1,1,1,1,1,2,3,4,4,4,4,4,4,4,5,5,6,6
1,1,1,1,1,1,1,1,1,2,3,4,4,4,4,4,4,4,5,5,6,6
1,1,1,1,1,1,1,1,1,1,2,3,4,4,4,4,4,4,4,5,5,6,6
1,1,1,1,1,1,1,1,1,1,1,2,3,4,4,4,4,4,4,4,5,5,6,6
1,1,1,1,1,1,1,1,1,1,1,1,2,3,4,4,4,4,4,4,4,5,5,6,6

```

            回答 #2

赞同：2

时间：2009-04-17T06:52:33.887

我假设每个项目的数量是有限的。

我会在这里使用增量：从空开始并尽可能添加项目 1。完成后，删除所有 1 并添加 2 并再次开始添加。当一个达到容量时，将它们全部删除，再添加 2 个并重新开始。当 2s 达到容量时，将它们删除并添加 3\. 等等......

有点像数字工作。

好的，让我们尝试编码...带有递增整数键的哈希是一个数组；-) 更容易假设数组的第一个元素是“浮动基数”数字的正确数字。这是javaScript：

```
var limits = [1, 3, 5, 2];

function out(arr){
  var text = '';
  for (var i=0; i < arr.length; i++){
    text += arr[i] + '.'
  }
  var log = document.getElementById('log');
  var p = document.createElement('p');
  log.appendChild(p);
  p.innerHTML = '<span>' + text + '</span>';
}

function generateNextSet(set){
  for (var i = 0; i < set.length; i++){
    var amount = set[i];
    if (amount + 1 > limits[i]){
      set[i] = 0;
    } else {
      set[i] = amount + 1;
      return set;
    }
  }
  return false;
}

function generateSets(){
  var initial_set = [0, 0, 0, 0]
  var set = generateNextSet(initial_set);
  out(set);
  while (set = generateNextSet(set)) {
    out(set);
  }
}; 
```

将 id 为“log”的 div 添加到文档中，并以某种方式启动**generateSets()**方法来检查输出。

            回答 #3

赞同：1

时间：2009-04-17T06:38:47.273

只需进行正常组合即可。

对于每个有 n 个数量大于 1 的数字的基本集合，循环遍历所有数量：[5,6] -> [5,5,6], [5,6,6], [5,5,6, 6]。

```
[]
[1] -> [1,1], [1,1,1] etc
  [1,2] -> [1,1,2], ...
  [1,3] -> [1,1,3]
  [1,4] -> [1,1,4], ...., [1,4,4], -- all combinations of all multi quantity
[2]
[3]
[4] -> [4,4], [4,4,4] etc
[5] -> [5,5]
[6] -> [6,6] 
```

ETC...

另一种方法（伪代码）：

```
Combinations: {N -> N} -> [[N]]
Combinations(s) == CombinationsX(s, [])

CombinationsX: {N -> N} X [N] -> [[N]]
Combinationsx(s, g) ==
  if s = {} then return []
  else
    {a -> b} = hd s
    ts = tl s
    res = Combinationsx(ts, g) 
    for q in 1..b do
      g = g + [a]
      res = res ++ Combinationsx(ts, g)
    return res 
```

            回答 #4

赞同：0

时间：2009-04-17T19:31:37.213

[组合生成](http://www.merriampark.com/comb.htm)的一个很好的资源是 Kenneth H. Rosen 在[*离散数学及其应用*](http://www.mhhe.com/math/advmath/rosen/)中描述的算法。很多问题都可以利用这个通用算法，把它放在你的工具箱里是件好事。

        sql-server-2005 - 在 TFS 构建服务器上构建 VS 数据库项目的问题

ID：759260

赞同：1

时间：2009-04-17T06:29:44.627

标签：sql-server-2005, visual-studio-2008, tfs, vsdb

我有两个 Visual Studio 数据库项目。两者都在我的本地开发环境中构建良好。在 TFS 构建服务器上，使用包含两个项目的 TFS 构建解决方案，一个构建正常，另一个失败并出现以下错误：

```
Task "SqlBuildTask"
  Creating a model to represent the project...
C:\Program Files\MSBuild\Microsoft\VisualStudio\v9.0\TeamData\Microsoft.Data.Schema.SqlTasks.targets(58,5): error MSB4018: The "SqlBuildTask" task failed unexpectedly.
C:\Program Files\MSBuild\Microsoft\VisualStudio\v9.0\TeamData\Microsoft.Data.Schema.SqlTasks.targets(58,5): error MSB4018: System.NullReferenceException: Object reference not set to an instance of an object.
C:\Program Files\MSBuild\Microsoft\VisualStudio\v9.0\TeamData\Microsoft.Data.Schema.SqlTasks.targets(58,5): error MSB4018:    at Microsoft.Data.Schema.Tasks.TaskHostLoader.Load(ITaskHost providedHost, TaskLoggingHelper providedLogger)
C:\Program Files\MSBuild\Microsoft\VisualStudio\v9.0\TeamData\Microsoft.Data.Schema.SqlTasks.targets(58,5): error MSB4018:    at Microsoft.Data.Schema.Tasks.DBBuildTask.Execute()
C:\Program Files\MSBuild\Microsoft\VisualStudio\v9.0\TeamData\Microsoft.Data.Schema.SqlTasks.targets(58,5): error MSB4018:    at Microsoft.Build.BuildEngine.TaskEngine.ExecuteInstantiatedTask(EngineProxy engineProxy, ItemBucket bucket, TaskExecutionMode howToExecuteTask, ITask task, Boolean& taskResult) 
```

我注意到构建日志中有以下差异，我认为这是相关的，但我不知道是什么原因造成的。

好项目：

```
Overriding target "Build" in project "C:\Windows\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets" with target "Build" from project "C:\Program Files\MSBuild\Microsoft\VisualStudio\v9.0\TeamData\Microsoft.VisualStudio.TeamSystem.Data.Tasks.targets". 
```

失败的项目：

```
Overriding target "Build" in project "C:\Windows\Microsoft.NET\Framework\v3.5\Microsoft.Common.targets" with target "Build" from project "C:\Program Files\MSBuild\Microsoft\VisualStudio\v9.0\TeamData\Microsoft.Data.Schema.Common.targets". 
```

两个数据库项目都包括以下导入（仅）：

```
<Import Project="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\v9.0\TeamData\Microsoft.Data.Schema.SqlTasks.targets" /> 
```

欢迎提供线索！

            回答 #1

赞同：3

时间：2009-04-17T19:25:00.973

啊，问题是我没有在构建服务器上安装 GDR 版本。一个项目是使用 VSDB RTM 创建的，另一个是使用 VSDB GDR 创建的。

要是有更好的错误信息来帮助诊断就好了！

        python - 如何删除 CGI 显示的临时文件（图像）？

ID：759271

赞同：2

时间：2009-04-17T06:37:22.753

标签：python, image, cgi

我编写了一个 python CGI 脚本，它将文件转换为 .jpgs 并在一个简单的 HTML 页面中显示它们。我不想用这些 .jpg 文件弄乱文件夹，所以我使用 tempfile.NamedTemporaryFile 创建一个文件来存储转换后的 .jpg 输出。一切都很好，但我想在页面显示后删除这个文件。目前我设置了 delete=False ，但我似乎无法在不导致 img 链接损坏的情况下删除文件。

            回答 #1

赞同：3

时间：2009-04-17T08:33:55.577

您不能从您的 cgi 脚本中删除该文件。因为只有在脚本完成运行后才会将 html 页面发送给用户。然后用户浏览器解析 html 并获取 jpg 文件。

最简单的选择是将临时文件写入子目录并定期清理该目录（仅在最后几分钟内）。有一些方法可以改进这个过程，但它们可能毫无意义。

一个更高级的选项（这也可能毫无意义，取决于您的场景）是配置 Web 服务器以在“get jpg”请求上运行脚本。然后您可以通过脚本流式传输 jpg。这样你就会知道何时获取 jpg。在此脚本中，您可以异步调用下标来删除 jpg 文件。

        c++ - C++ 迭代器的生命周期和有效性是多少？

ID：759274

赞同：11

时间：2009-04-17T06:40:01.217

标签：c++, stl, iterator, object-lifetime

我计划在 C++ 中实现一个事物列表，其中元素可能会被乱序删除。我不希望我需要任何类型的随机访问（我只需要定期扫描列表），并且项目的顺序也不重要。

所以我想*`std::list<Thing*> with this->position = insert(lst.end(), thing)`*应该做的伎俩。我希望 Thing 类记住每个实例的位置，以便我以后可以*`lst.erase(this->position)`*在恒定时间内轻松完成。

但是，我对 C++ STL 容器还是有点陌生​​，我不知道将迭代器保留这么长时间是否安全。特别是考虑到在插入的事物之前和之后会删除其他元素，然后它就消失了。

            回答 #1

赞同：13

时间：2009-04-17T06:52:50.220

在列表中，所有迭代器在插入期间保持有效，只有擦除元素的迭代器在擦除期间无效。

在您的情况下，即使在插入的 Thing* 之前和之后删除了其他元素，保持迭代器也应该没问题。

**编辑**：

矢量和双端队列的其他详细信息：

*向量*：  

*   inserting --- 如果发生重新分配，所有迭代器都将无效，否则它是有效的。
*   擦除----擦除点之后的所有迭代器都无效。

*双端队列*：

*   插入 --- 所有迭代器都无效。
*   擦除----所有迭代器都无效。

            回答 #2

赞同：4

时间：2009-04-17T08:53:53.673

这取决于您使用的容器。

检查：[http](http://www.sgi.com/tech/stl/)
 ://www.sgi.com/tech/stl/
最后查看每个容器文档，它们将描述迭代器保持有效的条件。

对于 std::list<> 它们在所有条件下都保持有效，直到它们实际引用的元素从容器中删除（此时它们无效）。

        wcf - WCF 架构

ID：759276

赞同：2

时间：2009-04-17T06:43:20.040

标签：wcf, wcf-security

我正忙着设计一个 WCF 应用程序。该应用程序的目的是让保险会员通过网络访问他们的保险信息。

问题在于我们的网络架构，我不确定我必须使用哪种类型或组合的安全性。

在我们的内部网络中，我们有一个 UNIX 环境，我使用 EntireX .net 包装器访问它，我们有一个 Oracle 10g 数据存储，我通过企业库访问它。

我创建了一个包含业务对象的 BLL 和一个通过 Enterprise Library/EntireX 填充这些对象的 DAL。

我创建了一个带有 2 个 WCF 服务的 WCF 服务层，一个用于访问 oracle 存储，一个用于访问 unix，它们引用 BLL。

我将在防火墙内使用 SQL 2005 的生产服务器上的 IIS 中托管此服务。我们购买了一个我们正在为其创建 DMZ 的 Web 服务器，该 Web 服务器将仅通过端口 443 和/或端口 80 与生产服务器通信。我们公司的 Internet 将可以访问 DMZ 中的 Web 服务器。

表示层将是一个 ASP.Net 前端，它使用 Channelfactory 在代码中调用服务。我使用客户端必须向服务提供的 X509 客户端证书。该服务受 SSL 保护。前端将位于 DMZ 中的 Web 服务器上。

我正在使用带有传输安全性和 clientCredentialType="Certificate" 的 wsHttpBinding，它工作正常，但我想将登录信息传递给服务。我想把它添加到邮件标题中。

现在，我正处于怀疑我的设计可行性的阶段。有人可以给我一些关于在这种情况下我必须使用什么绑定和安全性、如何传递登录信息以及我必须在我的演示层中拥有什么才能最安全的提示。我们可以控制哪些端口将通过防火墙打开到内部生产服务器。我们将只有 1 个 ASP.Net 客户端托管在 DMZ 的 Web 服务器上，但只有 HTTPS 或 HTTP 访问生产服务器。

非常感谢瑞恩

谢谢

            回答 #1

赞同：1

时间：2009-04-17T07:16:00.960

我认为你的方法听起来不错。如果您的 WCF 服务将仅由您的前端 asp.net 应用程序使用，我可能会考虑在 Windows 服务中托管服务层并使用 TCP 绑定（那么您将不必处理 IIS 并且可能没有证书） . 但这可能需要您稍微更改基础架构要求（您仍然可以使用端口 80/443，但您将面临与使用 IIS 通常使用的端口相关的其他烦人问题）。您可以从 IIS/HTTP 绑定开始，然后在对整个应用程序的影响最小的情况下进行切换（这就是 WCF 的优点）。

关于服务本身，我还会考虑在您的两个存储库之上发布 1 个简单的外观。这样，您的客户就不会将自己与您的 oracle db 和 unix 系统的概念相结合。不过，这值得商榷，您只提到了所使用的技术，如果这两个系统代表不同的业务领域，那么将它们分开是有意义的。如果您只是因为它们是两个不同的系统而将它们拆分，那么我会尝试从 UI 中抽象出这些系统。

对于传递凭据，我建议将授权策略与声明结合使用。如果您还没有找到有关此主题的更多帮助，请查看 leastprivilege.com。这是[一篇](http://www.leastprivilege.com/UsingIdentityModelAuthorizationPoliciesContextAndClaimsTransformation.aspx)让您入门的文章

        asp.net - 动态文本框文本 - asp.net

ID：759277

赞同：1

时间：2009-04-17T06:43:36.963

标签：asp.net

我正在尝试尽可能多地将我的演示文稿和逻辑分开，但是有一个问题。

如何将文本属性设置为我的设计文件中的动态值？我想这样做：

```
<asp:Textbox id="txtUrl" runat="server" Text="<%= user.URL %>" /> 
```

但这会失败。我是否被迫从后面的代码中执行此操作？

            回答 #1

赞同：2

时间：2009-04-17T07:10:22.750

```
<asp:Textbox id="txtUrl" runat="server" Text="<%# user.URL %>" /> 
```

这一切都与#有关。但直到 txtUrl.DataBind() 或对象层次结构中更高级别的东西（如页面）调用 DataBind() 时才会设置它。

            回答 #2

赞同：1

时间：2009-04-17T06:45:52.247

这个怎么样 ：

```
<input type="text" 
  id="txtUrl" name="txtUrl" runat="server" 
  value='<%= user.URL %>' /> 
```

            回答 #3

赞同：0

时间：2009-04-17T06:44:48.757

您可以使用绑定而不是评估。

此代码将文本框的`Text`属性绑定到`Url`由`MyData.GetLoggedInUser()`. 这允许双向绑定。

```
<asp:FormView ID="UserView" runat="server" DataSourceID="LoggedInUser">
    <ItemTemplate>
        <asp:TextBox ID="tb" 
                     runat="server" 
                     Text='<%# Bind("Url") %>'></asp:TextBox>
    </ItemTemplate>
</asp:FormView>
<asp:ObjectDataSource ID="LoggedInUser" 
                      runat="server" 
                      SelectMethod="GetLoggedInUser" 
                      TypeName="MyData">
</asp:ObjectDataSource> 
```

        c++ - 运行解释 C++？

ID：759279

赞同：17

时间：2009-04-17T06:44:47.307

标签：c++, interpreted-language

有没有办法我可以以解释而不是编译的方式运行 c++ 代码？所以我可以即时编辑代码和编写函数？

有关的：

*   [您是否使用过任何 C++ 解释器（不是编译器）？](https://stackoverflow.com/questions/69539/have-you-used-any-of-the-c-interpreters-not-compilers/)

            回答 #1

赞同：10

时间：2009-04-17T06:49:40.633

看看[Ch](http://www.softintegration.com/)，一个可嵌入的 C++ 解释器。

Ch 是一个可嵌入的 C/C++ 解释器，用于跨平台脚本、shell 编程、2D/3D 绘图、数值计算和嵌入式脚本。Ch 是 C/C++ 编译器的免费且用户友好的替代方案，供初学者学习 C/C++。

            回答 #2

赞同：5

时间：2009-04-17T09:25:51.007

Ch 和 CINT（通常作为 ROOT 系统的一部分）将解释 C++。但是，我对 CINT 的体验并不好：语言支持不完整（特别是在涉及模板的情况下），执行速度要慢得多，存在诸如变量范围和循环退出的错误历史，以及 (IMO)这比它的价值更麻烦。作为一门语言，C++ 的设计非常不适合解释性使用。

如果您需要运行解释型代码，为什么不使用 Python 或 Ruby 等现代解释型语言呢？如果需要，可以使用 SWIG 之类的工具将它们连接到现有的 C/C++ 库。

            回答 #3

赞同：3

时间：2010-03-11T08:34:42.753

试试这些：

*   对于 C/C++：http: [//sourceforge.net/projects/igcc/](http://sourceforge.net/projects/igcc/)
*   仅适用于 C： http: [//neugierig.org/software/c-repl/](http://neugierig.org/software/c-repl/)

            回答 #4

赞同：2

时间：2009-04-17T07:02:22.817

**[CINT](http://root.cern.ch/drupal/content/cint)**（[自述文件](http://root.cern.ch/viewvc/trunk/cint/README.txt)）当然有单步执行。不过，我不确定是否要即时修改。

            回答 #5

赞同：0

时间：2009-04-17T12:22:08.273

This doesnt exactly answer your question, but perhaps it will help.

The MS C++ compiler supports Edit and Continue, which allows you to stop, make changes, recompile & continue without shutting down you program.

            回答 #6

赞同：0

时间：2009-05-29T20:25:29.313

早在一月份，我在 CUSEC 的演示营中看到了关于**[ccons的演示。](http://code.google.com/p/ccons/)**它的目的是提供一个像 python 那样的交互式解释器。那时它还处于早期阶段，但给我留下了深刻的印象。

        java - 将 Facebook 功能整合到 Java Web 应用程序中的最佳开源 Java 库？

ID：759286

赞同：8

时间：2009-04-17T06:50:01.597

标签：java, web-applications, open-source, facebook

将 Facebook 功能添加到 Java Web 应用程序的最佳开源 Java 库是什么？

            回答 #1

赞同：10

时间：2010-10-08T22:03:36.343

对于最简单和最新的 API，到目前为止我喜欢 RestFB。

[http://restfb.com/](http://restfb.com/)

            回答 #2

赞同：7

时间：2009-04-17T08:31:15.443

自从 facebook 停止支持 Java API 以来，尝试提供 Java API 的工作已经被一个 google 编码小组所承担：

[http://code.google.com/p/facebook-java-api/](http://code.google.com/p/facebook-java-api/)

API 是在[MIT License](http://www.opensource.org/licenses/mit-license.php)下提供的。

            回答 #3

赞同：2

时间：2011-09-14T04:30:40.437

如果您的技术能力符合要求，这是迄今为止最先进的选择：

[http://code.google.com/p/batchfb/](http://code.google.com/p/batchfb/)

它会自动批处理多个请求，因此您不必考虑它。如果您超出最大批处理大小并且您位于支持异步获取的平台（如 App Engine）上，BatchFB 甚至会并行执行它们。

        django - 你如何将文件放在 Django 中的夹具中？

ID：759288

赞同：11

时间：2009-04-17T06:50:37.680

标签：django, testing, fixture

我可以很容易地用文件名填充 Django 夹具中的 FileField 或 ImageField 的字段，但是该文件不存在，当我尝试测试我的应用程序时它会失败，因为该文件不存在。

如何在 Django 固定装置中正确填充 FileField 或 Imagefield，以便文件本身也可用？

            回答 #1

赞同：8

时间：2009-04-18T22:53:35.627

恐怕简短的回答是您不能使用 FileField 或 ImageField 类来做到这一点；他们只是存储一个文件路径，对文件的实际数据没有真正的概念。然而，长答案是，如果您利用 Django API 编写您自己的[自定义模型字段](http://docs.djangoproject.com/en/dev/howto/custom-model-fields/#howto-custom-model-fields)，那么一切皆有可能。

至少，您需要实现`value_to_string`转换数据以进行序列化的方法（上面链接中的 django 文档中有一个示例）。请注意，上面 URL 链接中的示例还提到了子类化 FileField 和 ImageField，这对您的情况很有帮助！

您还必须决定是否应该将数据存储在数据库或文件系统中。如果是前者，您必须将自定义类实现为 Blob 字段，包括为您希望支持的每个 DB 进行自定义；当 HTML 请求 .gif/.jpg/.png/.whatever url 时，您还必须为如何将数据从数据库返回给用户提供一些支持。如果是后者，这是更聪明的方式，恕我直言，您必须实现将二进制数据序列化、反序列化到文件系统的方法。无论哪种方式，如果您将它们实现为 FileField 和 ImageField 的子类，您仍然应该能够使用需要此类 django 功能的管理工具和其他模块。

当且仅当您选择使用更复杂的 blob 方法时，这里有一段代码来自一个处理 MySQL 和 PostgreSQL 的 blob 的旧项目（在我学习 Django 时）；您可能会发现一些改进，因为我没有接触过它：-) 但是，它不处理序列化，因此您必须使用上面的方法添加它。

```
from django.db import models
from django.conf import settings

class BlobValueWrapper(object):
    """Wrap the blob value so that we can override the unicode method.
    After the query succeeds, Django attempts to record the last query
    executed, and at that point it attempts to force the query string
    to unicode. This does not work for binary data and generates an
    uncaught exception.
    """
    def __init__(self, val):
        self.val = val

    def __str__(self):
        return 'blobdata'

    def __unicode__(self):
        return u'blobdata'

class BlobField(models.Field):
    """A field for persisting binary data in databases that we support."""
    __metaclass__ = models.SubfieldBase

    def db_type(self):
        if settings.DATABASE_ENGINE == 'mysql':
            return 'LONGBLOB'
        elif settings.DATABASE_ENGINE == 'postgresql_psycopg2':
            return 'bytea'
        else:
            raise NotImplementedError

    def to_python(self, value):
        if settings.DATABASE_ENGINE == 'postgresql_psycopg2':
            if value is None:
                return value
            return str(value)
        else:
            return value

    def get_db_prep_save(self, value):
        if value is None:
            return None
        if settings.DATABASE_ENGINE =='postgresql_psycopg2':
            return psycopg2.Binary(value)
        else:
            return BlobValueWrapper(value) 
```

            回答 #2

赞同：7

时间：2009-04-20T15:42:54.490

没有办法在序列化的夹具中“包含”文件。如果创建一个测试夹具，你只需要自己做；确保某些测试文件实际存在于 FileField/ImageField 值所引用的位置。这些字段的值是相对于 MEDIA_ROOT 的路径：如果需要，可以设置 MEDIA_ROOT~~在您的测试 setUp() 方法中~~在自定义 test_settings.py 中，以确保无论您将测试文件放在哪里都可以找到它们。

**编辑**：如果您想在 setUp() 方法中执行此操作，您也可以直接使用monkeypatch default_storage：

```
from django.core.files.storage import default_storage

class MyTest(TestCase):

  def setUp(self):
    self._old_default_storage_location = default_storage.location
    default_storage.location = '/some/other/place'

  def tearDown(self):
    default_storage.location = self._old_default_storage_location 
```

这似乎行得通。default_storage 是[一个记录在案的公共 API](http://docs.djangoproject.com/en/dev/topics/files/#storage-objects)，所以这应该是可靠的。

        sql - 在 sql 中更改日期格式

ID：759292

赞同：1

时间：2009-04-17T06:52:22.153

标签：sql, sql-server, sql-server-2005, tsql

我在数据库中有 mm/dd/yyyy 格式的日期。我想以 dd/mm/yyyy 的形式显示。任何人都可以帮忙吗？我想与日期相处。

            回答 #1

赞同：2

时间：2009-04-17T06:59:53.243

转换（VARCHAR（10），您的字段，103）

根据您的评论-您也想要时间。

```
 select (CONVERT(VARCHAR(10), YourField, 103) + ' ' + CONVERT(VARCHAR(15), YourField, 108)) as DateTime 
```

[http://msdn.microsoft.com/en-us/library/aa226054.aspx](http://msdn.microsoft.com/en-us/library/aa226054.aspx)

            回答 #2

赞同：1

时间：2009-04-17T07:02:25.203

日期值根本没有格式。当您将其转换为字符串时，它会得到它的格式。

您可以使用该`convert`函数来转换数据库中的值，但您应该将其留给用户界面中的代码。

            回答 #3

赞同：0

时间：2009-04-17T07:04:46.447

Guffa 所说的，以及来自在线书籍的内容：http: [//msdn.microsoft.com/en-us/library/aa226054.aspx](http://msdn.microsoft.com/en-us/library/aa226054.aspx)

转换（VARCHAR（10），列，103）

103 是 yyyy 

3 是 yy

        math - 将小数转换为混合基数（基数）

ID：759296

赞同：9

时间：2009-04-17T06:55:56.327

标签：math, mixed-radix

如何将十进制数转换为[混合基数](http://en.wikipedia.org/wiki/Mixed_radix)表示法？

我猜想给定每个基数的数组和十进制数的输入，它应该输出每列值的数组。

            回答 #1

赞同：7

时间：2009-04-17T07:05:51.233

伪代码：

```
bases = [24, 60, 60]
input = 86462                       #One day, 1 minute, 2 seconds
output = []

for base in reverse(bases)
    output.prepend(input mod base)
    input = input div base          #div is integer division (round down) 
```

            回答 #2

赞同：3

时间：2009-04-17T07:06:20.920

数字 -> 设置：

```
factors = [52,7,24,60,60,1000]
value = 662321
for i in n-1..0
  res[i] = value mod factors[i]
  value = value div factors[i] 
```

反过来：

如果您有 32(52)、5(7)、7(24)、45(60)、15(60)、500(1000) 之类的数字，并且希望将其转换为十进制：

取数字 n，乘以 n-1 的因子，继续 n-1..n=0

```
values = [32,5,7,45,15,500]
factors = [52,7,24,60,60,1000]

res = 0;
for i in 0..n-1
  res = res * factors[i] + values[i] 
```

你有号码。

            回答 #3

赞同：2

时间：2018-08-13T16:52:14.517

在`Java`你可以做

```
public static int[] Number2MixedRadix(int[] base, int number) throws Exception {
            //NB if the max number you want @ a position is say 3 then the base@ tha position
            //in your base array should be 4 not 3

            int[] RadixFigures = new int[base.length];
            int[] PositionPowers = new int[base.length];
            PositionPowers[base.length-1] = 1;
            for (int k = base.length-2,pow = 1; k >-1; k--){
                pow*=base[k+1];
                PositionPowers[k]=pow;
            }for (int k = 0; k<base.length; k++){
                RadixFigures[k]=number/PositionPowers[k];
                if(RadixFigures[k]>base[k])throw new Exception("RadixFigure@["+k+"] => ("+RadixFigures[k]+") is > base@["+k+"] => ("+base[k]+") | ( number is Illegal )");
                number=number%PositionPowers[k];
            }return RadixFigures;
        } 
```

**例子**

```
//e.g. mixed-radix base for 1day
int[] base = new int[]{1, 24, 60, 60};//max-day,max-hours,max-minutes,max-seconds
int[] MixedRadix = Number2MixedRadix(base, 19263);//19263 seconds
//this would give [0,5,21,3] => as per 0days 5hrs 21mins 3secs 
```

**逆转**

```
 public static int MixedRadix2Number(int[] RadixFigures,int[] base) throws Exception {
            if(RadixFigures.length!=base.length)throw new Exception("RadixFigures.length must be = base.length");
            int number=0;
            int[] PositionPowers = new int[base.length];
            PositionPowers[base.length-1] = 1;
            for (int k = base.length-2,pow = 1; k >-1; k--){
                pow*=base[k+1];
                PositionPowers[k]=pow;
            }for (int k = 0; k<base.length; k++){
                number+=(RadixFigures[k]*PositionPowers[k]);
                if(RadixFigures[k]>base[k])throw new Exception("RadixFigure@["+k+"] => ("+RadixFigures[k]+") is > base@["+k+"] => ("+base[k]+") | ( number is Illegal )");
            }return number;
        } 
```

            回答 #4

赞同：1

时间：2009-04-17T08:07:54.330

我想出了一个稍微不同的方法，可能不如这里的其他方法好，但我想我还是要分享一下：

```
 var theNumber = 313732097; 

    //             ms   s   m   h    d
    var bases = [1000, 60, 60, 24, 365];
    var placeValues = [];  // initialise an array
    var currPlaceValue = 1;

    for (var i = 0, l = bases.length; i < l; ++i) {
        placeValues.push(currPlaceValue);
        currPlaceValue *= bases[i];
    }
    console.log(placeValues);
    // this isn't relevant for this specific problem, but might
    // be useful in related problems.
    var maxNumber = currPlaceValue - 1;

    var output = new Array(placeValues.length);

    for (var v = placeValues.length - 1; v >= 0; --v) {
        output[v] = Math.floor(theNumber / placeValues[v]);
        theNumber %= placeValues[v];
    }

    console.log(output);
    // [97, 52, 8, 15, 3] --> 3 days, 15 hours, 8 minutes, 52 seconds, 97 milliseconds
```

            回答 #5

赞同：0

时间：2019-09-08T19:05:39.687

我之前尝试了一些示例，发现了一个他们没有涵盖的边缘情况，如果你最大化你的规模，你需要在最后一步的结果之前

```
def intToMix(number,radix=[10]):
    mixNum=[]

    radix.reverse()
    for i in range(0,len(radix)):
        mixNum.append(number%radix[i])
        number//=radix[i]
    mixNum.append(number)
    mixNum.reverse()
    radix.reverse()
    return mixNum

num=60*60*24*7

radix=[7,24,60,60]

tmp1=intToMix(num,radix) 
```

        java - struts2.xml - 不能包含其他 .xml 文件

ID：759303

赞同：1

时间：2009-04-17T06:59:05.337

标签：java, struts2

我正在使用 struts2，因为我的 struts.xml 文件包含如下代码：

```
<?xml version="1.0" encoding="UTF-8" ?> 
```

```
<constant name="struts.enable.DynamicMethodInvocation" value="false" />
<constant name="struts.devMode" value="true" />

<include file="strutsAuthentication.xml"/>

<package name="default" extends="struts-default">
    <interceptors>
        <interceptor-stack name="crudStack">
            <interceptor-ref name="checkbox" />
            <interceptor-ref name="params" />
            <interceptor-ref name="static-params" />
            <interceptor-ref name="defaultStack" />
        </interceptor-stack>
    </interceptors>
</package> 
```

我已经在 strutsAuthentication.xml 中指定了所有必需的操作。该代码是：

```
<struts>
<package name="authentication" extends="default" namespace="/authentication">
    <action name="saveCountry" class="saveCountryAction">
        <interceptor-ref name="defaultStack" />
        <result name="success">/savecountry.jsp</result>
        <result name="error">/error.jsp</result>
    </action>

</package> 
```

当我将我的应用程序部署到 tomcat 中时，它会警告我：

WARN (org.apache.struts2.components.Form:308) - 找不到指定操作的配置：命名空间中的“saveCountry”：“”。表单动作默认为“动作”属性的文字值。

这意味着 struts.xml 不能包含 strutsAuthentication.xml。有人有解决办法吗？？提前谢谢....

            回答 #1

赞同：0

时间：2009-04-18T06:02:13.967

得到了解决方案....对于上述问题，我在从 jsp 页面调用操作时犯了一个错误。因此，在调用动作类时应包含命名空间名称“身份验证”。最终解决方案是：“authentication/saveCountry.action”。

            回答 #2

赞同：0

时间：2009-04-18T06:12:57.997

我不知道您使用的是什么版本的 struts2，但如果您使用的是 2.1.x 分支，您应该查看约定插件[http://cwiki.apache.org/S2PLUGINS/convention-plugin.html](http://cwiki.apache.org/S2PLUGINS/convention-plugin.html)。您可以摆脱 99% 的 XML 配置。

            回答 #3

赞同：0

时间：2011-07-25T10:17:20.023

作为补充说明。我们不应该在 JSP 页面中使用“xyz.action”。如果我们以后需要或决定将 url-pattern 从 .action 更改为 .do 或 .html 等。我们必须更改所有 JSP 页面。编写链接的更好方法是：

```
<a href="<s:url namespace="nsname" action="actionName" method="methodName"/>">Link Text</a> 
```

        iis - IIS7 中的 DefaultAppPool 和 Classic .NET AppPool 有什么区别？

ID：759304

赞同：48

时间：2009-04-17T06:59:29.143

标签：iis, web-applications, iis-7, application-pool

我在 IIS 中遇到超时问题。在 web.config 中，会话超时设置为 60 分钟，但 20 分钟后会话结束。

此问题仅在 IIS7 中出现，在 IIS5 中不会出现。

经过一番调查，我发现这是由于应用程序池超时。如果应用程序池有 20 分钟没有做任何事情，IIS 将结束会话。

如果应用程序使用的是 defaultAppPool，这总是会发生，但如果我将应用程序池更改为经典的 .NET 应用程序池，则不会发生超时。

两种模式都有空闲超时，但*只有*在 DefaultAppPool 中才会出现这种情况。

*   为什么是这样？
*   成为 Classic .NET AppPool 和 DefaultAppPool 有什么区别？
*   经典和集成之间的管道有什么区别？

            回答 #1

赞同：55

时间：2009-05-14T14:17:11.023

IIS7 进行了一些重大更改以更好地支持 WCF，其中一个关键部分是新的集成应用程序池。本次 PDC 会议从提高 WCF 服务性能的角度讨论了其中的一些挑战：http: [//channel9.msdn.com/pdc2008/TL38/](http://channel9.msdn.com/pdc2008/TL38/)

此页面很好地概述了 IIS7 架构：[http](http://learn.iis.net/page.aspx/101/introduction-to-iis7-architecture/) ://learn.iis.net/page.aspx/101/introduction-to-iis7-architecture/ 。我在本文中包含了一些关于以下两种不同类型的应用程序池的关键信息：

**集成应用池模式**

当应用程序池处于集成模式时，您可以利用 IIS 和 ASP.NET 的集成请求处理体系结构。当应用程序池中的工作进程收到请求时，该请求会通过一个有序的事件列表。每个事件调用必要的本地和托管模块来处理请求的一部分并生成响应。在集成模式下运行应用程序池有几个好处。首先将 IIS 和 ASP.NET 的请求处理模型集成到一个统一的进程模型中。此模型消除了以前在 IIS 和 ASP.NET 中重复的步骤，例如身份验证。此外，集成模式使托管功能可用于所有内容类型。

**经典应用池模式**

当应用程序池处于经典模式时，IIS 7.0 处理请求的方式与 IIS 6.0 工作进程隔离模式相同。ASP.NET 请求首先通过 IIS 中的本机处理步骤，然后被路由到 Aspnet_isapi.dll 以在托管运行时中处理托管代码。最后，请求通过 IIS 路由回以发送响应。IIS 和 ASP.NET 请求处理模型的这种分离导致一些处理步骤的重复，例如身份验证和授权。此外，托管代码功能（例如表单身份验证）仅适用于 ASP.NET 应用程序或您已为其脚本映射所有请求以由 aspnet_isapi.dll 处理的应用程序。在将生产环境升级到 IIS 7.0 并将应用程序分配到集成模式下的应用程序池之前，请务必在集成模式下测试现有应用程序的兼容性。如果应用程序无法在集成模式下工作，您应该只将应用程序添加到经典模式下的应用程序池中。例如，您的应用程序可能依赖于从 IIS 传递到托管运行时的身份验证令牌，并且由于 IIS 7.0 中的新体系结构，该过程会破坏您的应用程序。

            回答 #2

赞同：4

时间：2009-04-18T20:36:27.797

经典池通过使用 IIS 和 ISAPI 的单独处理管道来处理应用程序池中的请求。集成使用集成管道，IIS 和 ASP.NET a（更好的性能）仅使用一个进程即可利用 IIS 7.0 的改进功能。好的做法是为每个应用程序创建一个新的应用程序池，然后根据应用程序需求单独配置。

**经典模式**遵循以下步骤：

1.传入的HTTP请求是通过IIS核心接收的。

2.请求通过ISAPI处理。

3.请求通过ASP.NET处理。

4.请求通过ISAPI回传。

5\. 请求通过 IIS 核心返回，最终传递 HTTP 响应

**集成模式**使用：

1.传入的HTTP请求是通过IIS核心和ASP.NET接收的。

2.适当的处理程序执行请求并传递 HTTP 响应

根据 web.config 增加会话超时

请记住，增加这会导致应用程序消耗更多资源，例如内存

            回答 #3

赞同：2

时间：2009-05-09T04:57:40.523

我想你的问题已经有了答案。IIS 6 和 7 有一个应用程序池超时的概念，这与会话超时不同。

模式之间有什么区别......已经解决了。我不确定您关于管道和模式差异的问题如何与您的问题相关 - 超时。

一些观点：空闲超时不会发生在有任何流量的网站上。您可能遇到了仅出现在 QA 站点或您的开发箱中的问题。空闲超时设置的存在是为了节省您的开发盒和每月 5 美元的托管公司的资源，这些公司有很多未充分利用的网站（例如我的博客）。您可能不希望公共站点上的空闲超时。

**会话超时**- 在 web 配置中设置，如果*用户*没有访问服务器，他们的会话超时。  

**空闲超时**20 分钟内没有人完全接触 Web 服务器，因此请关闭以节省资源。在[IIS 6](http://msdn.microsoft.com/en-us/library/aa720391(VS.71).aspx)中，它位于应用程序池的性能选项卡上 - 并且很容易禁用。在 IIS 7 中，您可以在应用程序池高级设置或[processModel 元素](http://msdn.microsoft.com/en-us/library/7w2sway1(VS.71).aspx)中进行设置。我运行的 IIS 7 不如 IIS 6 多，但看起来从 web.config 中删除元素或设置为 0 会获得无限空闲超时。

            回答 #4

赞同：0

时间：2009-05-12T21:39:28.957

DefaultAppPool 忽略 web.config 中的会话超时设置，但 ASPNet 应用程序池将使用 web.config 中的设置。

        c# - 在运行时动态设置控件颜色的最佳方法

ID：759310

赞同：1

时间：2009-04-17T07:02:38.900

标签：c#, asp.net, c#-3.0

我目前在运行时加载控件，并想设置颜色，但不是命名颜色。我在想我需要创建一个颜色对象，设置它的颜色然后分配它，任何方向？谢谢

            回答 #1

赞同：1

时间：2009-04-17T07:20:55.800

您可以使用 Color.FromName() 方法来设置颜色：

```
txt.ForeColor = System.Drawing.Color.FromName("#00B300");
txt.ForeColor = System.Drawing.Color.FromName("red"); 
```

        c# - 将数据写入文件的最有效方法是什么？

ID：759312

赞同：0

时间：2009-04-17T07:02:57.293

标签：c#, winapi, file-io

我需要在我的应用程序中写入大量数据。数据定期到达并推入队列。

```
//producer
queue_.push( new_data );// new_data is a 64kb memory range
PostThreadMessage(worker_thread_id_, MyMsg, 0, 0);//notify the worker thread 
```

之后，我需要将此数据写入文件。我有另一个线程，它从队列中获取数据并将其写入。

```
//consumer
while(GetMessage(msg, 0, 0))
{
   data = queue_.pop();
   WriteFile(file_handle_, data.begin(), data.size(), &io_bytes, NULL);
} 
```

这很简单，但效率不高。另一个机会是使用 IO 完成端口。

```
//producer
//file must be associated with io completion port
WriteFile( file_handle_
         , new_data.begin()
         , new_data.size()
         , &io_bytes
         , new my_overlaped(new_data) ); 
```

消费者只是删除未使用的缓冲区

```
my_completion_key* ck = 0;
my_overlapped* op = 0;
DWORD res = GetQueuedIOCompletionStatus(completion_port_, &io_bytes, &ck, &op);
//process errors
delete op->data; 
```

在 Windows 上执行大量文件 i/o 操作的首选方法是什么？

            回答 #1

赞同：1

时间：2009-05-14T01:48:39.060

很难说，因为不清楚您当前的方法遇到了什么样的问题。在专用的“编写器”线程中进行异步不应导致显着的性能改进。

如果您有少量但频繁的写入（因此频繁的 WriteFile 成本成为瓶颈），我建议实施一种惰性写入 - 收集数据并在达到某个容量阈值时将其刷新到文件中。

        model-view-controller - MVC 的替代品是什么？

ID：759314

赞同：3

时间：2009-04-17T07:04:27.023

标签：model-view-controller, language-agnostic, design-patterns, architecture

似乎我参与的每个项目都使用模型视图控制器架构，这就是我推出自己的项目的方式。有替代方案吗？否则如何创建具有持久存储和用户界面的应用程序？

            回答 #1

赞同：8

时间：2009-04-17T07:50:34.447

[MVC](http://en.wikipedia.org/wiki/Model-view-controller)已经存在了一段时间。这是一个经过时间考验和证明的[模式](http://en.wikipedia.org/wiki/Design_Pattern)。许多框架利用[MVC 模式](http://en.wikipedia.org/wiki/Model-view-controller#Implementations_of_MVC_as_web-based_frameworks)。Martin Fowler 将 MVC 解构为：[Supervising Presenter](http://martinfowler.com/eaaDev/SupervisingPresenter.html)和[Passive View](http://martinfowler.com/eaaDev/PassiveScreen.html)。

建筑师[Christopher Alexander](http://en.wikipedia.org/wiki/Christopher_Alexander)说得最好：

每个模式都描述了一个在我们的环境中反复出现的问题，然后描述了该问题解决方案的核心，这样您就可以使用该解决方案一百万次，而不必以同样的方式重复使用两次。

我不确定您为什么要从 MVC 迁移。您是否遇到过 MVC 无法很好解决的问题？为了**给您一个更好的答案**，我们需要更多地了解您的**问题域**。

*考虑模式/架构*时要考虑的事项：如果您正在构建具有[Myspace](http://www.myspace.com/)类型架构的东西，您将需要一个健壮的架构 (MVC)。如果您通过网络创建一个简单的 crud 界面 - 几乎任何事情都可以。

对于不是 MVC 的 .Net Web 表单（我假设是 Web，因为您没有说厚或 Web 客户端），维护它们是一场噩梦。寿命超过几年的 Web 表单应用程序往往会变成[大泥球](http://www.laputan.org/mud/)。即便如此，开发人员也发现了将[MVC 与 Web 表单](https://stackoverflow.com/questions/664446/mvp-on-asp-net-webforms)一起使用的方法。

具有讽刺意味的是，ASP.NET Web 表单中缺乏 MVC 架构是导致[ASP.Net MVC 框架](http://www.asp.net/mvc/)开发的主要抱怨之一。

根据经验，如果您不使用某些 MVCesk 方法，您的解决方案将变得难以维护和臃肿。这些应用程序将缓慢而痛苦地死去。

如果您的解决方案是一次性的小型项目，那么一定要把一些东西放在一起。哎呀，有一些工具可以生成从屏幕到数据访问层的所有内容。无论做什么都可以完成工作。

            回答 #2

赞同：6

时间：2009-04-17T07:11:02.077

使用 VB6 和 Delphi 等工具构建的经典 CRUD 应用程序具有用户界面、持久存储并且不使用 MVC。他们中的大多数使用直接链接到数据库字段的数据感知控件

            回答 #3

赞同：4

时间：2009-04-17T08:14:55.763

比较可能有用的各种 MV* 模式的几个链接：[WPF 模式：MVC、MVP 或 MVVM 或...？](http://www.orbifold.net/default/?p=550)& [MVC、MVP 和 MVVM](http://www.silverlightkb.com/Default.aspx?Page=MVC,%20MVP%20and%20MVVM&AspxAutoDetectCookieSupport=1)

            回答 #4

赞同：3

时间：2009-04-17T07:29:24.513

查看 MVP 模型视图演示器。

            回答 #5

赞同：0

时间：2009-04-17T07:12:22.090

用户界面是视图，应用程序总是有一个模型，两者之间的桥梁是控制器。整个 MVC 并没有什么特别之处，因为事情总是如此。

最多您可以摆脱 Controller 并让您的视图与您的模型对话，但您会失去灵活性。

            回答 #6

赞同：0

时间：2010-11-19T06:23:31.227

我开发了 ASP.NET MVC 的替代方案。您可以获得相同的松散耦合和关注点分离，但不同之处在于您如何构建项目。

我的博客上有几个视频、框架的源代码、一个示例项目和一些 VS.NET 插件（新项目项、新生成器和新视图）。

[ASP.NET 生成器](http://www.matlus.com/2010/11/builder-for-aspnet/)

一些关键的区别特性是 1\. 模板只是 html - 没有代码与模板混合 2\. 模板因此可以跨视图重用，网站设计人员可以在他们选择的设计工具中设计模板 3\. 强类型代码（没有 ViewData 和其他东西）所以您将获得 intillisense、编译时检查、F12 导航等。 4\. 您将页面构建为视图的组合，而不是由内而外的方法 5\. 视图可以被视为“真实”类。6\. 一切都已编译，因此无需运行时编译

还有很多其他差​​异化因素。

            回答 #7

赞同：0

时间：2011-03-29T15:16:44.357

理论上 ：

MVC 是一种经过验证的技术和 yada-yada-yada，它是网站的理想选择。

但在一个真实的案例中：

一个使用 MVC 的严肃项目需要一个框架，因此您正在遵循一个具有所有限制和限制的框架。所以，在这一点上，MVC的具体实现是规则而不是简单的“指南”。

此外，当 MVC 将要连接到模型而不是简单的 POST/GET 时，MVC 对于网站也会失败，它会因 xml 异步而失败，并且会因 ajax 而失败。(*)

(*) 存在一些补丁，但设计必须清晰且实用，如果您需要“修补”，那么它既不清晰也不实用。

我个人认为 MVC 的主要问题是它在控制器上投入了太多精力，大多数项目在控制器部分使用的代码不超过 5 行。

ps：大多数“做得很好”的 MVC 项目都是 3 层项目。  

ps2：MVC 不包括一些框架，只是一个流行词，不是一个严肃的术语，它在“mvc 的解释”组中有所体现。

        c++ - const_cast 是否会导致实际的代码发射？

ID：759315

赞同：8

时间：2009-04-17T07:04:42.857

标签：c++, constants, memory-model, const-cast, data-representation

*const_cast*是否只是告诉编译器“停止抱怨，将其视为非常量指针”的一种方式？是否存在将*const_cast*本身翻译成实际机器代码的情况？

            回答 #1

赞同：12

时间：2009-04-17T07:11:59.237

不，它只是在编译时删除 const 属性。

            回答 #2

赞同：5

时间：2009-04-17T07:24:39.033

可以想象，可能存在 const 指针与非 const 指针具有不同表示的架构，在这种情况下，编译器将不得不发出一些代码。但是，我不知道有任何这样的架构。

            回答 #3

赞同：3

时间：2009-04-17T07:20:13.397

const_cast 只是丢弃了属性的常量性，仅此而已。

            回答 #4

赞同：2

时间：2012-07-20T18:53:48.877

`const`不会改变类型的表示，特别是 的表示`T*`与`T const*`.

考虑：

```
int i, 
    * const cpi = &i,
    * const * pcpi = &cpi;
int const * const * pcpci = pcpi; // cpi is now int const* 
```

的表示`cpi`同时表示一个`int*`和一个`int const*`通孔`*pcpci`。

初始化时的表示`cpi`无法更改。`pcpci`

当然，如果指针对象有非有效位，编译器可以随机翻转它们；特别是，`const_cast`可以翻转指针的非有效位，但任何隐式转换也可以。我认为这种情况在现实世界中是不存在的。

当两个不同的位模式导致相同的地址值（当偏移量足够大时基数+偏移量）时，同样适用。

        java - 使用 BorderLayout 从 JPanel 中删除 CENTER 元素

ID：759321

赞同：28

时间：2009-04-17T07:07:44.083

标签：java, swing, layout, constraints, components

有什么方法可以删除`Component`添加到`CENTER`a`JPanel`的 a `BorderLayout`，而不必引用它`Component`本身？

            回答 #1

赞同：49

时间：2009-04-17T07:21:48.167

像这样的东西？

```
BorderLayout layout = (BorderLayout)panel.getLayout();
panel.remove(layout.getLayoutComponent(BorderLayout.CENTER)); 
```

        c# - 如何在 VS2008 中选择性地打开或关闭特定类别的代码分析构建警告？

ID：759331

赞同：0

时间：2009-04-17T07:12:48.860

标签：c#, visual-studio-2008, ide

HMI/Dialog/UI 在哪里选择我希望收到通知的构建警告类型？

例如

```
Warning 77  CA1725 : Microsoft.Naming : In member 'x', change parameter name 'a' to 'b' in order to match the identifier as it has been declared in 'd'.    <filename> 
```

没有那么重要

```
Warning 75  CA2200 : Microsoft.Usage : 'a' rethrows a caught exception and specifies it explicitly as an argument. Use 'throw' without an argument instead, in order to preserve the stack location where the exception was initially raised.   <filename> 
```

我刚刚继承了大量代码.. 噪音太大了。我在构建警告上右键单击时看到了抑制消息...但恐怕我无法重新打开它:)

这似乎比必要的更痛苦......我错过了什么吗？

            回答 #1

赞同：3

时间：2009-04-17T07:16:58.383

我怀疑这取决于项目类型，但如果有的话，请查看“构建”选项卡下的项目属性页面。例如，在 C# 项目中，它位于项目属性“Build”、“Suppress warnings”中。

编辑：此文本框是您通常输入警告编号的位置，例如 2200 和 1725。但是，这些是提供给*编译器*的选项。如果这是 FxCop 规则，我认为它不会对您有所帮助。

您可以[使用 attributes 在特定位置抑制 FxCop 消息](http://www.adrianbanks.co.uk/?p=30)，或转到项目页面和“代码分析”选项卡以进行项目范围的设置。

        php - 使用php的通知消息

ID：759340

赞同：0

时间：2009-04-17T07:18:08.910

标签：php, windows, notifications

我正在用 php 开发一个应用程序。我需要在 Windows 任务栏上显示通知消息。所以请帮助我...如何使用 php 来做到这一点。

            回答 #1

赞同：4

时间：2009-04-17T07:21:35.533

使用 PHP，您的域就是 Web 浏览器。您可以在浏览器或弹出窗口中显示消息。您无法连接到操作系统。

            回答 #2

赞同：2

时间：2009-04-17T07:33:45.813

可能[PHPGTK](http://gtk.php.net/)可以帮助你。但是你的问题有点**味道**，因为正如 Sohnee 所说，PHP 是为创建网页或与网络高度相关的东西而设计的。

但是，如果您提供更多信息，您会做什么，为什么这样做等等，它可能会对我们有所帮助......

            回答 #3

赞同：0

时间：2009-04-19T10:08:51.353

With C# for .NET you can easily write a notifier application which resides in the tray.

I just have written an XML based notifier application which communicates (XML data transfer) with a server that runs php.  The IDE comes with a sample notifier application. If you are familiar with c# then go and get it. 

It's open source
[Goto SharpDevelopment IDE](http://www.icsharpcode.net/OpenSource/SD/)

            回答 #4

赞同：0

时间：2009-04-19T10:38:14.263

What you can do, is develop a program that does this in another language, and then call it via [system()](http://is.php.net/manual/en/function.system.php) in PHP.

Note that the notification will only pop up on the server. Since no actual PHP code is run on the client's machine.

            回答 #5

赞同：0

时间：2009-04-17T09:40:49.177

您可以使用 ajax 更改窗口标题以在任务栏中显示消息。这就是我认为使用 webapp 所能达到的程度。

            回答 #6

赞同：0

时间：2009-04-17T15:40:56.407

您可能想要寻找 Growl 库。在寡妇上，它需要一些额外的软件。谷歌出现：

*   [http://forums.cocoaforge.com/viewtopic.php?f=6&t=16872](http://forums.cocoaforge.com/viewtopic.php?f=6&t=16872)
*   [http://github.com/tylerhall/php-growl/tree/master](http://github.com/tylerhall/php-growl/tree/master)

        c++ - 以编程方式打开和关闭控制台

ID：759341

赞同：1

时间：2009-04-17T07:18:29.503

标签：c++, windows, console

我正在用 C++ 编写一个窗口程序，但我希望可以选择弹出一个控制台以从程序内部输出（例如我的程序幕后发生的各种事情，以查看一切是否正常）正确行事）。是否有捷径可寻？

编辑：

在这种特殊情况下，我在 Windows 上使用[sfml](http://www.sfml-dev.org)，但就这个问题而言，它可以是任何 API 或平台（最好是独立于平台的解决方案）

            回答 #1

赞同：3

时间：2009-04-17T07:21:30.757

如果您谈论的是 MS Windows，而您的问题并不清楚，您可以使用[AllocConsole](http://msdn.microsoft.com/en-us/library/ms681944%28VS.85%29.aspx) API 创建控制台。为您的应用程序。

**编辑：**您说它可以是任何平台，但这并不是因为许多平台都没有控制台的概念。因此，跨平台解决方案是不可能的。

            回答 #2

赞同：2

时间：2009-04-17T07:23:37.743

有处理控制台管理的 Windows API 函数。[这](http://msdn.microsoft.com/en-us/library/ms681944(VS.85).aspx)可能是一个很好的起点。

            回答 #3

赞同：1

时间：2009-04-17T07:21:34.830

只需打开一个控制台很容易，`system("cmd.exe");`但通信部分并不那么容易。我的直觉告诉我，存在满足您需求的第三方。在尝试使用 3rd 方库之前，可能值得查看 win32api 或[AllocConsole](http://msdn.microsoft.com/en-us/library/ms681944(VS.85).aspx) API（如果您使用的是 .NET）。

        asp.net - 获取包含 HTML 标记的文本子字符串

ID：759342

赞同：4

时间：2009-04-17T07:18:44.837

标签：asp.net, html, string

获取包含 HTML 标记的文本子字符串

假设您需要以下内容的前 10 个字符：

"<p>这是第 1 段</p>这是第 2 段</p>"

输出将是：

“<p>这是”

返回的文本包含一个未闭合的 P 标记。如果这被渲染到页面上，后续的内容会受到打开的 P 标签的影响。理想情况下，首选输出将关闭任何未关闭的 HTML 标记，与打开时相反：

"<p>this is</p>" 我想要一个返回 HTML 子串的函数，确保没有标签未闭合

            回答 #1

赞同：3

时间：2009-04-17T08:15:30.347

您需要教您的代码如何理解您的字符串实际上是 HTML 或 XML。仅将其视为字符串不会让您以您想要的方式使用它。这意味着首先将其转换为正确的格式，然后使用该格式。

使用 XSL 样式表

如果您的 HTML 是格式良好的 XML，请将其加载到一个`XMLDocument`并通过 XSL 样式表运行，该样式表执行以下操作：

```
<xsl:template match="p">
  <xsl:value-of select="substring(text(), 0, 10)" />
</xsl:template> 
```

使用 HTML 解析器

如果它不是格式良好的 XML（如在您的示例`</p>`中，中间突然出现），则需要使用[某种 HTML 解析器](http://www.google.com/search?q=c%23+html+parser)，例如[HTML Agility Pack](http://www.codeplex.com/htmlagilitypack)（请参阅[有关 C# HTML 解析器的这个问题](https://stackoverflow.com/questions/100358/looking-for-c-html-parser)） .

不要使用正则表达式，因为[HTML 太复杂而无法使用 regex 进行解析](https://stackoverflow.com/questions/590747/using-regular-expressions-to-parse-html-why-not)。

            回答 #2

赞同：2

时间：2011-04-06T18:35:49.490

您可以使用下一个静态函数。有关工作示例检查：[http](http://www.koodr.com/item/438c2e9c-62a8-45fc-9ca2-db1479f412e1) ://www.koodr.com/item/438c2e9c-62a8-45fc-9ca2-db1479f412e1 。你也可以把它变成一个扩展方法。

```
public static string HtmlSubstring (string html, int maxlength) {
//initialize regular expressions
string htmltag = "</?\\w+((\\s+\\w+(\\s*=\\s*(?:\".*?\"|'.*?'|[^'\">\\s]+))?)+\\s*|\\s*)/?>";
string emptytags = "<(\\w+)((\\s+\\w+(\\s*=\\s*(?:\".*?\"|'.*?'|[^'\">\\s]+))?)+\\s*|\\s*)/?></\\1>";

//match all html start and end tags, otherwise get each character one by one..
var expression = new Regex(string.Format("({0})|(.?)", htmltag)); 
MatchCollection matches = expression.Matches(html);

int i = 0;
StringBuilder content = new StringBuilder();
foreach (Match match in matches)
{
    if (match.Value.Length == 1
        && i < maxlength) 
    {                    
        content.Append(match.Value);
        i++; 
    }
    //the match contains a tag
    else if (match.Value.Length > 1) 
        content.Append(match.Value);
}

return Regex.Replace(content.ToString(), emptytags, string.Empty); } 
```

            回答 #3

赞同：1

时间：2009-04-17T07:34:18.763

您的要求非常不清楚，因此大部分都是猜测。此外，您没有提供任何有助于阐明您想要做什么的代码。

一种解决方案可能是：

一个。`<p>`找到和`</p>`标签之间的文本。您可以为此使用以下正则表达式或使用简单的字符串搜索：

```
\<p\>(.*?)\</p\> 
```

湾。在找到的文本中，应用 a`Substring()`以提取所需的文本。

C。`<p>`在和`</p>`标签之间放回提取的文本。

            回答 #4

赞同：0

时间：2012-12-28T11:59:46.557

试试这个代码（python 3.x）：

```
notags=('img','br','hr')
def substring2(html,size):
    if len(html) <= size:
        return html
    result,tag,count='','',0
    tags=[]
    for c in html:
        result += c
        if c == '<':
            intag=True
        elif c=='>':
            intag=False
            tag=tag.split()[0]
            if tag[0] == '/':
                tag = tag.replace('/','')
                if tag not in notags:
                    tags.pop()
            else:
                if tag[-1] != '/' and tag not in notags:
                    tags.append(tag)
            tag=''
        else:
            if intag: 
                tag += c
            else:
                count+=1
                if count>=size: break
    while len(tags)>0:
        result += '</{0}>'.format(tags.pop())
    return result

s='<div class="main">html <code>substring</code> function written by <span>imxylz</span>, using <a href="http://www.python.org">python</a> language</div>'
print(s)
for size in (30,40,55):
    print(substring2(s,size)) 
```

**输出**

```
<div class="main">html <code>substring</code> function written by <span>imxylz</span>, using <a href="http://www.python.org">python</a> language</div>
<div class="main">html <code>substring</code> function writte</div>
<div class="main">html <code>substring</code> function written by <span>imxyl</span></div>
<div class="main">html <code>substring</code> function written by <span>imxylz</span>, using <a href="http://www.python.org">python</a></div> 
```

**更多的**

[请参阅github 上](https://gist.github.com/4397068)的代码。

另一个[问题](https://stackoverflow.com/questions/6118904/substring-without-breaking-html-c-sharp#14068972)。

            回答 #5

赞同：0

时间：2009-04-17T07:26:05.787

您可以遍历 html 字符串以检测尖括号并构建一组标签以及每个标签是否有匹配的结束标签。问题是，HTML 允许使用非结束标签，例如 img、br、meta - 所以您需要了解这些。您还需要有规则来检查关闭的顺序，因为仅将打开与关闭匹配不会生成有效的 HTML - 如果您打开一个 div，然后 ap 然后关闭 div 然后关闭 p，那就是'无效。

        sql - Zend Framework：如何最好地检索经过身份验证的用户的名字？

ID：759348

赞同：1

时间：2009-04-17T07:21:20.680

标签：sql, zend-framework, authentication, identity, zend-auth

我可以通过这样做来获取用户名：

```
public function indexAction()
{
    $this->view->username = Zend_Auth::getInstance()->getIdentity();
} 
```

“用户名”是表中验证身份的列。“名字”也是该表中的一列。Zend_Auth 是否只存储用户名？或者有没有办法从表中用户的行访问其他列？

            回答 #1

赞同：3

时间：2009-04-17T07:28:32.817

因此，您使用的是 DbTable 适配器，对。您是否像这样在身份验证后检索表行：

```
$authAdapter->getResultRowObject() 
```

那么是的，整个用户行都可用。试试看嘛！

从手册：

除了在认证结果对象上 getIdentity() 方法的可用性之外，Zend_Auth_Adapter_DbTable 还支持在认证成功时检索表行：

```
// Print the identity
echo $result->getIdentity() . "\n\n";

// Print the result row
print_r($authAdapter->getResultRowObject());

/* Output:
my_username

Array
(
    [id] => 1
    [username] => my_username
    [password] => my_password
    [real_name] => My Real Name
)
*/ 
```

[或者自己看看！](http://framework.zend.com/manual/en/zend.auth.adapter.dbtable.html)

        html-agility-pack - 图像标签未使用 HTMLAgilityPack 关闭

ID：759355

赞同：10

时间：2009-04-17T07:22:41.287

标签：html-agility-pack

使用 HTMLAgilityPack 写出一个新的图像节点，它似乎删除了图像的结束标记，例如应该是但是当你检查外部 html 时，有 .

```
string strIMG = "<img src='" + imgPath + "' height='" + pubImg.Height + "px' width='" + pubImg.Width + "px' />";

HtmlNode newNode = HtmlNode.Create(strIMG); 
```

这会破坏 xhtml。

            回答 #1

赞同：22

时间：2009-11-24T11:43:17.790

告诉它按照 Micky 的建议输出 XML 是可行的，但如果您有其他不想要 XML 的原因，请尝试以下操作：

```
doc.OptionWriteEmptyNodes = true; 
```

            回答 #2

赞同：3

时间：2012-08-23T16:39:51.190

编辑 1：以下是如何修复 HTML Agilty Pack 文档以正确显示图像 (img) 标签：

```
if (HtmlNode.ElementsFlags.ContainsKey("img"))
{   HtmlNode.ElementsFlags["img"] = HtmlElementFlag.Closed;}
else
{   HtmlNode.ElementsFlags.Add("img", HtmlElementFlag.Closed);} 
```

将“img”替换为任何其他标签以修复它们（输入、选择和选项经常出现）。根据需要重复。请记住，这将产生而不是 ，因为 HAP 错误会阻止同时设置“关闭”和“空”标志。
[资料来源：迈克·布里奇](http://htmlagilitypack.codeplex.com/discussions/53782)

原始答案：刚刚研究了这个问题的解决方案，但没有找到任何足够的答案（正确设置了文档类型，使用输出为 XML、检查语法、AutoCloseOnEnd 和写入空节点选项），我能够用一个肮脏的黑客来解决这个问题. 这肯定不会彻底解决每个人的问题，但对于任何将生成的 html/xml 作为字符串返回（例如通过 Web 服务）的人，简单的解决方案是使用敏捷包不知道会破坏的虚假标签。一旦你完成了你需要对你的文档做的所有事情，为每个让你头疼的标签调用一次以下方法（值得注意的例子是 option、input 和 img）。紧接着，渲染你的最终字符串，并对每个以某个字符串为前缀的标签进行简单替换（在本例中为“Fix_”，并返回你的字符串。

```
private void fixHAPUnclosedTags(ref HtmlDocument doc, string tagName, bool hasInnerText = false)
{
    HtmlNode tagReplacement = null;
    foreach(var tag in doc.DocumentNode.SelectNodes("//"+tagName))
    {
        tagReplacement = HtmlTextNode.CreateNode("<fix_"+tagName+"></fix_"+tagName+">");
        foreach(var attr in tag.Attributes)
        {
            tagReplacement.SetAttributeValue(attr.Name, attr.Value);
        }
        if(hasInnerText)//for option tags and other non-empty nodes, the next (text) node will be its inner HTML
        {
            tagReplacement.InnerHtml = tag.InnerHtml + tag.NextSibling.InnerHtml;
            tag.NextSibling.Remove();
        }
        tag.ParentNode.ReplaceChild(tagReplacement, tag);
    }
} 
```

作为一个注释，如果我是一个赌徒，我会猜想上面 MikeBridge 的回答无意中确定了包中这个错误的来源——某些东西导致关闭和空标志是互斥的

此外，经过更多挖掘，我似乎并不是唯一采用这种方法的人：
 [HtmlAgilityPack Drops Option End Tags](https://stackoverflow.com/questions/293342/htmlagilitypack-drops-option-end-tags)

此外，在您只需要非空元素的情况下，在同一个问题中列出了一个非常简单的修复程序，以及[此处](http://htmlagilitypack.codeplex.com/discussions/14982?ProjectName=htmlagilitypack)的 HAP codeplex 讨论：这基本上将 Mike Bridge 的答案中列出的空标志选项永久设置在任何地方。      

            回答 #3

赞同：2

时间：2009-10-13T01:15:11.037

有一个选项可以打开 XML 输出，从而消除此问题。

```
var htmlDoc = new HtmlDocument();
htmlDoc.OptionOutputAsXml = true;
htmlDoc.LoadHtml(rawHtml); 
```

            回答 #4

赞同：1

时间：2012-07-26T09:26:57.743

这似乎是 HtmlAgilityPack 的一个错误。有很多方法可以重现这一点，例如：

```
Debug.WriteLine(HtmlNode.CreateNode("<img id=\"bla\"></img>").OuterHtml); 
```

输出格式错误的 HTML。在其他答案中使用建议的修复没有任何作用。

```
HtmlDocument doc = new HtmlDocument();
doc.OptionOutputAsXml = true;
HtmlNode node = doc.CreateElement("x");
node.InnerHtml = "<img id=\"bla\"></img>";
doc.DocumentNode.AppendChild(node);
Debug.WriteLine(doc.DocumentNode.OuterHtml); 
```

生成格式错误的 XML / XHTML，例如`<x><img id="bla"></x>`

[为此，我在 CodePlex 中创建了一个问题。](http://htmlagilitypack.codeplex.com/workitem/32972)

        silverlight - MVVM 模式中的 Silverlight 子窗口

ID：759360

赞同：11

时间：2009-04-17T07:24:59.923

标签：silverlight, silverlight-3.0, mvvm

我正在尝试使用 Silverlight (3) 中的 MVVM 模式从 ChildWindow/popup 中获取数据的正确方法。例如：我有一个带有数据输入表单的主页，我想打开一个包含客户列表的弹出窗口。当用户选择客户时，我想将所选客户转移到主页。这就是我目前正在使用的（示例）代码：

**主页**

```
public partial class MainPage : UserControl
{
    public MainPageViewModel ViewModel { get; private set; }

    public MainPage()
    {
        InitializeComponent();
        ViewModel = new MainPageViewModel();
        DataContext = ViewModel;
    }

    private void SearchCustomer_Click(object sender, RoutedEventArgs e)
    {
        ViewModel.SearchCustomer();
    }
}

public class MainPageViewModel: ViewModel
{
    private string customer;
    public string Customer
    {
        get { return customer; }
        set { customer = value; RaisePropertyChanged("Customer"); }
    }

    public void SearchCustomer()
    {
        // Called from a view
        SearchWindow searchWindow = new SearchWindow();
        searchWindow.Closed += (sender, e) =>
        {
            if ((bool)searchWindow.DialogResult)
            {
                Customer = searchWindow.ViewModel.SelectedCustomer.ToString();
            }
        };
        searchWindow.Show();
    }
} 
```

**子窗口**

```
public partial class SearchWindow : ChildWindow
{
    public SearchWindowViewModel ViewModel { get; private set; }

    public SearchWindow()
    {
        InitializeComponent();
        ViewModel = new SearchWindowViewModel();
        DataContext = ViewModel;
    }

    private void OKButton_Click(object sender, RoutedEventArgs e)
    {
        DialogResult = ViewModel.OkButtonClick();
    }

    private void CancelButton_Click(object sender, RoutedEventArgs e)
    {
        DialogResult = ViewModel.CancelButtonClick();
    }
}

public class SearchWindowViewModel: ViewModel
{
    private Customer selectedCustomer;        
    private ObservableCollection<Customer> customers;

    public ObservableCollection<Customer> Customers
    {
        get { return customers; }
        set {customers = value; RaisePropertyChanged("Customers"); }
    }

    public Customer SelectedCustomer
    {
        get { return selectedCustomer; }
        set { selectedCustomer = value; RaisePropertyChanged("SelectedCustomer"); }
    }

    public SearchWindowViewModel()
    {
        Customers = new ObservableCollection<Customer>();
        ISearchService searchService = new FakeSearchService();
        foreach (Customer customer in searchService.FindCustomers("dummy"))
            Customers.Add(customer);
    }

    public bool? OkButtonClick()
    {
        if (SelectedCustomer != null)
            return true;
        else
            return null; // show some error message before that
    }

    public bool? CancelButtonClick()
    {
        return false;
    }
} 
```

这是正确的方法还是有更“简单”的方法？

干杯，韩国

            回答 #1

赞同：6

时间：2009-04-20T11:53:00.423

这里更成问题的是在 VM 中使用 View 特定的术语和类型。点击事件，DialogResults 不应该在您的 ViewModels 附近。  

关于这个问题，我在这里有一个类似的问题：
 [Handling Dialogs in WPF with MVVM](https://stackoverflow.com/questions/454868/handling-dialogs-in-wpf-with-mvvm)

我接受的答案是使用中介者模式来解决这个问题。看一看。:)

            回答 #2

赞同：1

时间：2010-07-02T09:03:13.163

**Chinch mvvm helper library**是一个很好的支持打开子窗口的 MVVM库。您可以在[http://www.codeproject.com/KB/silverlight/SL4FileUploadAnd_SL4_MVVM.aspx](http://www.codeproject.com/KB/silverlight/SL4FileUploadAnd_SL4_MVVM.aspx)查看示例。

        regex - 将 URL 从 http://example.com/blog/ 重写为 http://blog.example.com/

ID：759361

赞同：4

时间：2009-04-17T07:25:14.540

标签：regex, apache, .htaccess, mod-rewrite

我应该使用什么`RewriteRule`（使用`.htaccess`/ `mod_rewrite`）来重定向`http://example.com/blog/`（有`www`或没有）到`http://blog.example.com/`？

我正在使用以下内容，但得到一个重定向循环：

```
RewriteEngine On
RewriteCond %{HTTP_HOST} !^www\.example\.com [NC]
RewriteRule ^(.*)$ http://www.example.com/blog/ [L,R=301]

RewriteCond %{HTTP_HOST} www\.example\.com [NC]
RewriteRule ^(.*)$ http://www.example.com/blog/ [L,R=301] 
```

            回答 #1

赞同：6

时间：2009-04-17T07:39:39.170

在您现有的规则中，您似乎有一些错误的方法，我认为没有必要进行否定（即`!`）测试。

```
RewriteEngine On
RewriteCond %{HTTP_HOST} ^(www\.)?example\.com [NC]
RewriteRule ^/blog/$ http://blog.example.com/ [L,R=301] 
```

但是，我建议您不要使用该`RewriteCond`指令来检查主机名，只需确保该规则适用`VirtualHost`于`www.example.com`.

```
<VirtualHost ...>
ServerName www.example.com
ServerAlias example.com

RewriteRule ^/blog/ http://blog.example.com/ [L,R=301]
</VirtualHost> 
```

（注意：假设`blog.example.com`并且`www.example.com`实际上是独立的虚拟主机）

        web-crawler - 用于抓取和挖掘网站数据的最佳开源库或应用程序

ID：759363

赞同：3

时间：2009-04-17T07:26:03.633

标签：web-crawler, data-mining, extraction, text-extraction

我想知道用于抓取和分析网站的最佳 eopen-source 库是什么。一个例子是爬虫物业机构，我想从多个站点获取信息并将它们聚合到我自己的站点中。为此，我需要抓取网站并提取物业广告。

            回答 #1

赞同：8

时间：2009-04-17T07:43:57.553

[我使用优秀的 python 包urllib2](http://www.voidspace.org.uk/python/articles/urllib2.shtml)、[mechanize](http://wwwsearch.sourceforge.net/mechanize/)和[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/documentation.html)做了很多抓取。

我还建议查看[lxml](http://blog.ianbicking.org/2008/12/10/lxml-an-underappreciated-web-scraping-library/)和[Scrapy](http://dev.scrapy.org/)，尽管我目前不使用它们（仍计划尝试 scrapy）。

Perl 语言也有很好的抓取工具。

            回答 #2

赞同：1

时间：2009-06-02T14:13:16.200

PHP/cURL 是一个非常强大的组合，特别是如果你想直接在网页中使用结果...

            回答 #3

赞同：1

时间：2009-07-01T14:57:00.650

与莫罗佐夫先生一样，我也进行了大量的抓取工作，主要是在工作地点。如果有帮助的话，我从来不用求助于机械化。Beautifulsoup 与 urllib2 结合使用就足够了。

我用过lxml，很棒。但是，如果您需要的话，我相信几个月前当我尝试它时，Google 应用程序可能无法使用它。

感谢 Morozov 先生提到 Scrapy。没听说过。

            回答 #4

赞同：0

时间：2009-10-15T22:16:37.580

除了 Scrapy，你还应该看看[Parselets](http://parselets.com/)

        c# - 了解 WinDbg 输出

ID：759365

赞同：2

时间：2009-04-17T07:26:57.873

标签：c#, c++, exception, dll, windbg

我有一个 Winform 应用程序 (C#)，它从 dll 导入一些函数。

有时在运行应用程序时，我会遇到以下异常：

System.AccessViolationException：试图读取或写入受保护的内存。这通常表明其他内存已损坏。

我抓住它`AppDomain.CurrentDomain.UnhandledException`。

所以我尝试用 WinDbg 调试它。我能够捕获异常并获得以下输出：

**!分析-v**

```
FAULTING_IP: 
KERNEL32!SetErrorMode+14b
77e6c427 8a08            mov     cl,byte ptr [eax]

EXCEPTION_RECORD:  ffffffff -- (.exr 0xffffffffffffffff)
ExceptionAddress: 77e6c427 (KERNEL32!SetErrorMode+0x0000014b)
   ExceptionCode: c0000005 (Access violation)
  ExceptionFlags: 00000000
NumberParameters: 2
   Parameter[0]: 00000000
   Parameter[1]: 087deadc
Attempt to read from address 087deadc

FAULTING_THREAD:  00000b1c

PROCESS_NAME:  App.exe

ERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at "0x%08lx" referenced memory at "0x%08lx". The memory could not be "%s".

EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - The instruction at "0x%08lx" referenced memory at "0x%08lx". The memory could not be "%s".

EXCEPTION_PARAMETER1:  00000000

EXCEPTION_PARAMETER2:  087deadc

READ_ADDRESS:  087deadc 

FOLLOWUP_IP: 
KERNEL32!SetErrorMode+14b
77e6c427 8a08            mov     cl,byte ptr [eax]

NTGLOBALFLAG:  0

APPLICATION_VERIFIER_FLAGS:  0

MANAGED_STACK: !dumpstack -EE
OS Thread Id: 0xb1c (34)
Current frame: 
ChildEBP RetAddr  Caller,Callee

ADDITIONAL_DEBUG_TEXT:  Followup set based on attribute [UnloadedModule_Arch_AX] from Frame:[0] on thread:[b1c] ; Enable Pageheap/AutoVerifer

DEFAULT_BUCKET_ID:  HEAP_CORRUPTION

PRIMARY_PROBLEM_CLASS:  HEAP_CORRUPTION

BUGCHECK_STR:  APPLICATION_FAULT_HEAP_CORRUPTION_INVALID_POINTER_READ

LAST_CONTROL_TRANSFER:  from 7a0aa797 to 77e6c427

STACK_TEXT:  
WARNING: Stack unwind information not available. Following frames may be wrong.
08bddc6c 7a0aa797 00000000 00000001 087deadc KERNEL32!SetErrorMode+0x14b
08bddd68 7c82a124 056306e8 08bddf9c 7c82a0b8 mscorwks!CorLaunchApplication+0x281f8
08bddd74 7c82a0b8 7c82a0fc 00000001 00000004 ntdll!RtlpAllocateFromHeapLookaside+0x13
08bddf9c 00000000 00000000 00000000 00000000 ntdll!RtlAllocateHeap+0x1dd

STACK_COMMAND:  .ecxr ; ~~[b1c] ; .frame 0 ; ~34s ; kb

SYMBOL_NAME:  ure.dll!Unloaded

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: ure.dll

IMAGE_NAME:  ure.dll

DEBUG_FLR_IMAGE_TIMESTAMP:  750063

FAILURE_BUCKET_ID:  HEAP_CORRUPTION_c0000005_ure.dll!Unloaded

BUCKET_ID:  APPLICATION_FAULT_HEAP_CORRUPTION_INVALID_POINTER_READ_ure.dll!Unloaded

WATSON_STAGEONE_URL:  http://watson.microsoft.com/StageOne/App_exe/1_2009_403_12/49e707a9/KERNEL32_dll/5_2_3790_4062/46264680/c0000005/0002c427.htm?Retriage=1

Followup: MachineOwner 
```

这意味着什么？我该怎么办？

提前感谢您的任何提示！

            回答 #1

赞同：2

时间：2009-04-17T07:56:26.633

它看起来`ure.dll`已经被卸载，并且引用它的~~NlsAnsiToUnicode~~ MultiByteToWideChar() 调用失败。您可以`.symfix`先运行`!analyze -v`以确认这一点。

那是您要导入的DLL吗？如果没有，你有内存损坏。否则，错误可能在该 DLL 中。您是否使用 P/Invoke 导入它？

是的，卸载的 DLL 信息已损坏。正如您可能猜到的那样，它是 .NET 的`culture.dll`，Windbg 正在读取其中的“邪教”部分作为时间戳和校验和。尝试重新启动并执行以下操作：

```
.symfix
sxe ud
g 
```

当断点命中时：

```
kb 
```

（这就是告诉 Windbg 一直运行到 DLL 被卸载，然后转储堆栈）

运行一会儿让模块卸载，然后执行以下命令。然后让 Windbg 运行，直到出现异常，再次执行此命令进行比较：

```
db ntdll!RtlpUnloadEventTrace 
```

（这是卸载模块表的开始，它正在损坏。）

        c++ - 生成的子退出状态 = 127

ID：759366

赞同：1

时间：2009-04-17T07:27:03.583

标签：c++, spawn, waitpid

我使用 posix_spawnp 执行不同的进程，并检查状态（使用 waitpid）以确保正确创建了孩子

```
 int iRet = posix_spawnp(&iPID, zPath, NULL, NULL, argv, environ);       

    if (iRet != 0)
    {
        return false;
    }

    int iState;
    waitpid(static_cast<pid_t>(iPID), &iState, WNOHANG);
    cout << "Wait: PID " << iPID << " | State " << iState << endl;

    if (WIFEXITED(iState)) {
        printf("Child exited with RC=%d\n",WEXITSTATUS(iState));
    }
    else if (WIFSIGNALED(iState)) {
        printf("Child exited via signal %d\n",WTERMSIG(iState));
    }
    else
    {
        printf("Child is NORMAL");
    } 
```

起初，这可以正确执行，我收到以下消息：

等待：PID 15911 | 状态 0 孩子以 RC=0 退出

多次执行同一个进程后，子进程开始退出，状态为 127。

等待：PID 15947 | 状态 32512 孩子以 RC=127 退出

发生这种情况后，我无法让孩子再次产卵。我将上面给出的代码部分包含在一个 for 循环中，但它不会正确生成。如果我重新启动父进程，它会工作一段时间，但同样的问题会在一段时间后再次出现。

我在这里做错了什么？

            回答 #1

赞同：1

时间：2009-04-17T12:28:52.063

检查[此链接](http://publib.boulder.ibm.com/infocenter/systems/index.jsp?topic=/com.ibm.aix.basetechref/doc/basetrf1/posix_spawn.htm)。

例如：

EINVAL file_actions 或 attrp 指定的值无效。

posix_spawn 和 posix_spawnp 子例程的错误代码受以下情况影响： 如果在调用进程从 posix_spawn 或 posix_spawnp 函数成功返回后发生此错误，则子进程可能以退出状态 127 退出。

出于多种原因，它看起来可能会以 127 退出。

            回答 #2

赞同：0

时间：2009-04-17T07:53:52.100

检查返回代码`waitpid()`以确保它没有问题。

代码读取的方式表明您一次只生成一个子进程（否则无需`waitpid()`在循环内调用）。但是在那种情况下，我不希望使用`WNOHANG`.

        javascript - 独立于浏览器的 JavaScript 调试器？

ID：759374

赞同：2

时间：2009-04-17T07:30:19.787

标签：javascript, debugging, firebug, toolbar

有谁知道是否存在独立于浏览器的调试器...

例如，我一直在 Firefox 中使用 Firebug，但如果 Web 开发人员使用其他浏览器 - 什么都没有。

我想知道是否有某种“全局”调试器可以附加到任何浏览器并进行调试？

有任何想法吗？

            回答 #1

赞同：3

时间：2009-04-17T07:35:10.087

几乎所有的浏览器都有自己的 JavaScript 调试器。仅仅是因为它们没有提供相同的 API（如果它们提供了一些）来访问 JavaScript 引擎。

因此，为了完成您的列表，您拥有适用于 Opera 的 DragonFly 和适用于基于 WebKit 的浏览器（如 Safari）的 WebInspector。

            回答 #2

赞同：3

时间：2009-04-17T07:36:54.060

Firebug 的制造商还制作了[Firebug Lite](http://getfirebug.com/lite.html)，这是一个可以包含在网页中的 JavaScript 文件。他们说它适用于 IE、Opera 和 Safari。

史蒂夫

            回答 #3

赞同：3

时间：2009-04-17T07:55:39.477

由于每个浏览器都有自己的引擎和自己的怪癖等，因此或多或少不可能拥有通用调试器。

[Aptana](http://www.aptana.com/)实际上只是针对 Web 项目重新命名的 Eclipse，它在 IDE 中内置了一个调试器，并且在理论上接近了这个理想。它使用 Eclipse 平台的调试接口，但仍需要插入浏览器。在 Firefox 中，这通过插入...Firebug 的 JS 调试器来工作。但是，它允许您直接从 IDE 设置断点和单步执行代码（对于外部 JS 文件非常有用）。IE调试需要购买Pro版，质量无法保证。AFAIK，它不支持其他浏览器。

            回答 #4

赞同：2

时间：2009-04-17T09:30:24.007

我运行一个 Web 服务，允许开发人员“调试”他们的 Javascript，即通过[Javascript 验证器](http://www.jslint.com/)查找错误。有关使用“全局”vim 编辑器进行设置的详细信息，请参阅[HTML5 IDE指南。](http://wiki.whatwg.org/wiki/IDE)

            回答 #5

赞同：2

时间：2009-04-17T07:43:25.590

对于 IE，您还可以使用 Visual Studio 来调试 JavaScript - 它比 Microsoft Script Debugger 更好。我不确定快递版是否也能做到这一点。

**补充：** VS2005和VS2008都可以进行JS调试，当然新的产品更好。

            回答 #6

赞同：1

时间：2009-04-17T08:46:44.173

简短的回答：我不这么认为，但我希望你能找到一个，因为我很想拥有一个。

但是，如果你最近没有关注[IE 开发](http://blogs.msdn.com/ie/archive/2008/09/03/developer-tools-in-internet-explorer-8-beta-2.aspx "IE开发")，现在使用 IE8 进行 IE 的 JScript 调试就不会那么痛苦了；默认情况下，它包括一些开发工具，这些工具几乎可以完成 Firebug 所做的所有事情，但 AJAX 调试除外（但我更喜欢 AJAX 的协议分析器）。它甚至实现了一个可执行控制台，其中包括几个来自 Firebug 的 console.X 方法！

我很想说，探查器比 Firebug 的要好 - 仅仅是因为它可以让您将结果直接导出到 CSV。实际的调试器与 JS 调试器一样功能齐全，具有步进/断点/直接输入。

另外，我还没有听到文[克曼](http://www.mozilla.org/projects/venkman/ "文克曼")提到过；它是 Firefox 调试（和其他 Mozilla Javascript）的祖父。不像 Firebug 那样受欢迎，但它肯定有它的追随者。

此页面上还有很多很好的信息：[wikibooks.org/wiki/JavaScript/Debugging](http://en.wikibooks.org/wiki/JavaScript/Debugging "wikibooks.org/wiki/JavaScript/调试")

            回答 #7

赞同：1

时间：2009-04-17T07:52:06.177

您可以使用 Visual Studio 的快速版调试 javascript。看[这里](http://www.berniecode.com/blog/2007/03/08/how-to-debug-javascript-with-visual-web-developer-express/)了解详情

            回答 #8

赞同：0

时间：2009-04-17T07:36:57.977

javascript 取决于您使用的浏览器（因此存在兼容性问题）。要调试资源管理器，您可以使用：[Microsoft Script debugger](http://www.filewatcher.com/m/scd10en.exe.669648.0.0.html)

            回答 #9

赞同：0

时间：2013-06-18T03:02:26.773

您可以使用 jsdt，您可以从  [https://code.google.com/p/jsdt/获取一些信息](https://code.google.com/p/jsdt/)

        java - JFileChooser 的替代品

ID：759376

赞同：18

时间：2009-04-17T07:32:15.880

标签：java, user-interface, jfilechooser

我请求对当前使用 JFileChooser 的小程序进行一些更改。

主要的抱怨之一是文件选择器使用起来很麻烦，因为它的行为与本机小部件不同，尤其是在导航到根级别时。

因此，知道了这一点以及 JFileChooser 遭受的所有其他问题（例如 Windows 上的 zip 文件缓存......），我想知道 java 世界中是否存在可行的替代方案。  

当然，也有使用本机小部件的 SWT，但将小程序大小增加 25 并不是一个真正的选择。那么，文件选择器有更好的纯 java 实现吗？

            回答 #1

赞同：12

时间：2009-04-17T08:15:06.060

AWT[`FileDialog`](http://java.sun.com/javase/6/docs/api/java/awt/FileDialog.html "文件对话框")实际上确实使用了本机组件，但与大多数 AWT 与 Swing 的问题一样，它的灵活性和可定制性远不如 Swing 的`JFileChooser`. 所以有一个权衡：`JFileChooser`可能有一个笨重的用户界面，但它通常更适合大多数用途。但是，如果您真的希望您的文件选择对话框看起来和感觉像原生对话框，那么您可以使用`FileDialog`.

            回答 #2

赞同：6

时间：2010-03-02T05:29:04.613

我知道这有点晚了，但它可能会帮助其他用户。您可以将应用程序的 UI 自定义为操作系统的 UI：

```
try {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    } catch (Exception e) {e.printStackTrace();     } 
```

            回答 #3

赞同：5

时间：2010-02-10T08:05:33.933

您也可以尝试[XFileDialog](http://code.google.com/p/xfiledialog/ "xfile对话框")。还没有尝试太多，但看起来值得评估。

            回答 #4

赞同：2

时间：2017-06-13T09:20:37.613

如果可用，我围绕 JavaFX 的文件选择器编写了一个[包装器。](https://github.com/veluria/NativeJFileChooser)如果包含在您的应用程序中，您可以替换

```
JFileChooser fileChooser = new JFileChooser(); 
```

和

```
JFileChooser fileChooser = new NativeJFileChooser(); 
```

然后它将使用底层平台的本机（和现代）文件选择器。并非一切都 100% 相同，因此请确保事后对其进行测试，但大多数事情都应该顺利进行。

            回答 #5

赞同：0

时间：2009-04-17T12:49:41.640

正如@htw 所说，如果外观是您的主要关注点，请使用*FileDialog 。*通过使用*FileDialog*请注意，您将无法使用许多方便的方法...

我用过[VFSJFileChooser](http://vfsjfilechooser.sourceforge.net)几次。它没有 JFileChooser 错误（由于 zip 文件加载缓慢，仅限 Windows），但界面不是“原生”的。

        c# - 如何使用 asp.net 在不离开现有页面的情况下执行 url 或超链接

ID：759381

赞同：0

时间：2009-04-17T07:33:48.390

标签：c#

我用过这段代码

```
WebClient webClient = new WebClient();
byte[] reqHTML;
reqHTML = webClient.DownloadData(url); 
```

用于执行 url。在这里我有一个问题，在使用此代码时，是否设置了 cookie？

            回答 #1

赞同：1

时间：2009-04-17T07:42:56.760

WebClient 默认不发送 Cookie。您可以编写使用[cookie 容器](http://msdn.microsoft.com/en-us/library/system.net.cookiecontainer.aspx)的实现：

```
public class CookieAwareWebClient : WebClient  
{  
    private CookieContainer _container = new CookieContainer();  

    protected override WebRequest GetWebRequest(Uri address)  
    {  
        WebRequest request = base.GetWebRequest(address);  

        if (request is HttpWebRequest)  
            ((HttpWebRequest)request).CookieContainer = _container;  

        return request;  
    }  
} 
```

            回答 #2

赞同：0

时间：2009-04-17T07:38:34.477

如果您的意思是来自正在执行的 ASP.NET 页面的 cookie - 那么不：我很确定这**根本**`WebClient`不会查看当前正在执行的 Web 请求上的 cookie。 如果你想要这个功能，你可以在浏览器中使用 AJAX 吗？也许通过 jQuery？这应该按照标准浏览器规则流动上下文等。

或者，您将不得不自己处理 cookie（即，将它们复制到 中`WebClient`，如果需要，再返回）。

# jquery - ASP.NET+jQuery，如何反序列化 JSON？

> ID：759385
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T07:34:33.893
> 
>         
> 
> 标签：jquery

我想反序列化下面的 JSON 字符串，使用 jQuery 每个函数，但该项目未定义。

下面有代码，但是，如果我使用 asp.net 2.0 + Web 服务并填充 DataTable 并传递给 System.Web.Script.Serialization.JavaScriptSerializer 类并返回这些 JSON 字符串。

```
<html>
<head>
    <script type="text/javascript" src="js/jquery-1.3.2.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            var $strJson = '[';
            $strJson += '{"Code":"a","Name":"Sam","Country":"US"},';
            $strJson += '{"Code":"b","Name":"John","Country":"CN"},';
            $strJson += '{"Code":"c","Name":"Mary","Country":"TW"}';
            $strJson += ']';
            $.each($strJson, function (key, item) {
                alert(item);
                if (key == 0) return false; //Prevent infinity loop
            });
        });
    </script>
</head>
<body>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T17:44:13.537

只需使用内置的 JavaScript eval 方法：

```
$.each(eval('(' + $strJson + ')'), function(key, item) { 
```

顺便说一句，您不需要在 JavaScript 中对变量使用 $ 符号。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T07:43:04.543

您是否尝试过使用 ASP.NET 的 Sys.Serialization.JavaScriptSerializer 的[反序列](http://msdn.microsoft.com/en-us/library/bb383812.aspx)化方法？

```
var result = Sys.Serialization.JavaScriptSerializer.deserialize($strJson); 
```

或者，有[json_parse](http://www.json.org/json_parse.js)

```
var result = json_parse($strJson, [reviver]) 
```

> 此方法解析 JSON 文本以生成对象或数组。它可以抛出一个 SyntaxError 异常。
> 
>   
>   
> 
> 可选的 reviver 参数是一个可以过滤和转换结果的函数。它接收每个键和值，并使用其返回值而不是原始值。如果它返回它收到的内容，那么结构不会被修改。如果返回未定义，则删除该成员。

[工作示例在这里](http://jsbin.com/ibapa)。这是代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script src="http://www.json.org/json_parse.js"></script>
<script type="text/javascript">
      $(function() {

            var $strJson =  '[';
            $strJson +=  '{"Code":"a","Name":"Sam","Country":"US"},';
            $strJson +=  '{"Code":"b","Name":"John","Country":"CN"},';
            $strJson +=  '{"Code":"c","Name":"Mary","Country":"TW"}';
            $strJson +=  ']';

            var result = json_parse($strJson);

            $.each(result, function(key, item) {
             alert("Code: " + item.Code + " ,Name: " + item.Name + " ,Country: " + item.Country);
             //Taken the following out as it prevents objects after the first from being "alerted"
             //if ( key == 0) return false; //Prevent infinity loop
             });
      });
</script>
<title>Sandbox</title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
</head>
<body>
    <p>Example Page</p>
</body>
</html> 
```

# c# - 使用 asp.net 和 C# 在 Web 应用程序中呈现分页文本

> ID：759389
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T07:35:09.320
> 
>         
> 
> 标签：c#, asp.net, text-rendering

嗨，我有一个大的 html 格式的文本。我想在页面中显示文本（如在 MS Word 中）。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-11-26T19:44:55.567

最好的方法是在带有组件的 PDF 中呈现它（可以是[来自 WebSuperGoo 的 ABCPdf](http://www.websupergoo.com/abcpdf-1.htm)或其他解决方案）

```
Doc theDoc = new Doc();
theDoc.Rect.Inset(72, 144);
theDoc.Page = theDoc.AddPage();
int theID;
theID = theDoc.AddImageUrl("http://www.yahoo.com/"); 
while (true) {
  theDoc.FrameRect(); // add a black border
  if (!theDoc.Chainable(theID))
    break;
  theDoc.Page = theDoc.AddPage();
  theID = theDoc.AddImageToChain(theID);
} 

for (int i = 1; i <= theDoc.PageCount; i++) {
  theDoc.PageNumber = i;
  theDoc.Flatten();
}

theDoc.Save(Server.MapPath("pagedhtml.pdf"));
theDoc.Clear(); 
```

# ant - 如果脚本被取消，如何终止从 Ant 任务启动的进程？

> ID：759395
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T07:36:28.913
> 
>         
> 
> 标签：ant, process, copy-paste

我创建了一个 Ant 任务来编译 VB6 应用程序。

在对源文件进行一些预处理之后，我从`VB6.exe`适当的参数开始使用

```
Process p = Runtime.getRuntime().exec(...);
p.waitFor(); 
```

但是，当我在 Ant 运行时按 Ctrl+C 时，脚本和我的任务会终止，但生成的进程仍在运行。

当 Ant 脚本终止时，如何自动终止我启动的进程？如果我按 Ctrl+C 会发生什么？我的任务是立即终止还是有什么反应？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:12:20.217

`Runtime.exec()`在单独的操作系统进程中运行命令。当您按下 Ctrl+C 时，您会终止 Java 进程。

你可以试试`Runtime.addShutdownHook(Thread hook)`。当您按下 Ctrl+C 时 JVM 正在关闭时，将调用此钩子线程。实现钩子线程，它将尝试终止您启动的进程。要终止该进程，您需要找出该操作系统上的命令并在`Runtime.exec()`.

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:07:05.467

您可能对此代码感兴趣：

```
 final Process process = new ProcessBuilder("blah blah").start();
    Runtime.getRuntime().addShutdownHook(new Thread() {

        @Override
        public void run() {
            process.destroy();
        }

    });
    process.waitFor(); 
```

**addShutdownHook**的 javadoc ：

> Java 虚拟机关闭以响应两种事件：
> 
>   
>   
> 
> *   程序正常退出，当最后一个非守护线程退出或调用 exit（等效于 System.exit）方法时，或
> 
> *   虚拟机响应用户中断（例如键入 ^C）
>     
>       或系统范围的事件（例如用户注销或系统关闭）而终止。

# sifr - sifr3 - 预取不起作用？

> ID：759398
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T07:37:05.930
> 
>         
> 
> 标签：sifr

我在启用 sifr 3 的站点的加载时间/大小方面遇到问题，并发现在我的应用程序中多次请求了字体 swf。这可以在 firebug 的网络选项卡以及 apache 日志中看到。

在[http://novemberborn.net/flash/prefetching-movies](http://novemberborn.net/flash/prefetching-movies)上有一些预取指令。但是，这不起作用，预取方法不可用（仍在文档中！）。我知道预取是自动完成的，但这似乎不起作用。

即使在 sifr 下载包的演示页面中，在浏览器缓存为空的情况下，rockwell.swf 和 cochin.swf 也获得了多次点击！Firefox 3 和 IE7 都...

有机会简单快速地修复吗？

问候，西蒙

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-10-09T06:03:41.997

您可以选择搬到 Cufon 吗？你会发现它更容易使用并且并不古怪。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-18T20:15:27.503

从根本上说，这是浏览器和 Flash 播放器之间的问题。当 sIFR 将 Flash 电影插入页面时，浏览器使用 Flash 电影的路径初始化 Flash 插件。如果电影尚未在本地缓存中，则从服务器请求它。由于电影是在几毫秒内插入的，这意味着对每个插入的电影都发出请求。

sIFR 试图通过预取 Flash 电影来防止这种情况发生。它基于会话 cookie 为每个浏览器会话执行此操作。这只会触发对电影文件的请求，并希望在替换开始时该文件已在缓存中。因此，尽早加载 sIFR JavaScript 代码并通过将 Flash 电影传递给该`sIFR.activate()`方法来正确激活 sIFR 非常重要。

根据我的经验，可靠地测试此过程的唯一方法是清除浏览器缓存，关闭所有浏览器实例（以摆脱会话 cookie），然后打开浏览器并直接进入您要测试的页面。我发现浏览器中的活动监视器并不可靠，因此请通过 HTTP 代理或服务器日志进行检查。

我可以做的剩下的一项改进是尝试检测预取的进度，并推迟替换元素，直到预取完成。

# sql-server - SQL Server 中 DECIMAL 和 NUMERIC 之间有什么区别吗？

> ID：759401
> 
>         
> 
> 赞同：133
> 
>         
> 
> 时间：2009-04-17T07:38:19.547
> 
>         
> 
> 标签：sql-server, sqldatatypes

SQL Server 中 DECIMAL 和 NUMERIC 数据类型之间有什么区别吗？

什么时候应该使用 DECIMAL，什么时候应该使用 NUMERIC？

* * *

## 回答 #1

> 赞同：109
> 
>             
> 
> 时间：2009-04-17T07:43:37.867

他们是一样的。数字在功能上等同于十进制。

MSDN：[十进制和数字](https://msdn.microsoft.com/en-us/library/ms187746.aspx)

* * *

## 回答 #2

> 赞同：42
> 
>             
> 
> 时间：2009-04-17T08:49:08.333

这就是 SQL2003 标准（第 6.1 节数据类型）对这两者所说的：

```
 <exact numeric type> ::=
    NUMERIC [ <left paren> <precision> [ <comma> <scale> ] <right paren> ]
  | DECIMAL [ <left paren> <precision> [ <comma> <scale> ] <right paren> ]
  | DEC [ <left paren> <precision> [ <comma> <scale> ] <right paren> ]
  | SMALLINT
  | INTEGER
  | INT
  | BIGINT

 ...

21) NUMERIC specifies the data type
    exact numeric, with the decimal
    precision and scale specified by the
    <precision> and <scale>.

22) DECIMAL specifies the data type
    exact numeric, with the decimal scale
    specified by the <scale> and the
    implementation-defined decimal
    precision equal to or greater than the
    value of the specified <precision>. 
```

* * *

## 回答 #3

> 赞同：11
> 
>             
> 
> 时间：2009-04-17T07:46:31.400

据我所知，NUMERIC 和 DECIMAL 数据类型之间没有区别。它们是彼此的同义词，可以使用任何一个。DECIMAL 和 NUMERIC 数据类型是具有固定精度和小数位数的数值数据类型。

编辑：

与几位同事交谈可能与 DECIMAL 是 ANSI SQL 标准和 NUMERIC 是 Mircosoft 更喜欢的一种有关，因为它在编程语言中更常见。...也许 ;）

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2017-08-26T20:52:02.937

Joakim Backman 的回答是具体的，但这可能会使其更加清晰。

有一个小的区别。根据 SQL For Dummies，第 8 版（2013 年）：

> DECIMAL 数据类型类似于 NUMERIC。...不同之处在于您的实现可能指定的精度大于您指定的精度 - 如果是这样，则实现使用更高的精度。如果您不指定精度或小数位数，则实现使用默认值，就像使用 NUMERIC 类型一样。

似乎*某些*SQL 实现的区别在于数据完整性。DECIMAL 允许从基于某些系统默认值定义的内容中溢出，而 NUMERIC 则不允许。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2016-07-26T16:52:35.363

它们是同义词，完全没有区别。十进制和数字数据类型是具有固定精度和小数位数的数字数据类型。

```
-- Initialize a variable, give it a data type and an initial value

declare @myvar as decimal(18,8) or numeric(18,8)----- 9 bytes needed

-- Increse that the vaue by 1

set @myvar = 123456.7

--Retrieve that value

select @myvar as myVariable 
```

* * *

## 回答 #6

> 赞同：-2
> 
>             
> 
> 时间：2018-09-05T15:28:43.123

它们完全相同。使用时保持一致。在您的数据库中使用其中之一

# tfs - 根据标签或日期分支移动文件夹

> ID：759402
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T07:38:31.920
> 
>         
> 
> 标签：tfs, branch, label

我已经使用“move”命令在 tfs 中移动了一个文件夹，但现在我无法根据日期或标签从移动的文件夹中创建分支（标签是在源位于旧文件夹中时创建的）。但是，我可以基于“最新版本”创建一个分支。我收到一条错误消息“如果我尝试对标签进行分支，则没有项目匹配。我猜测标签在移动之前使用旧文件夹引用文件。如果我尝试“获取特定版本”，我也没有得到任何文件按日期或标签。

我试图回滚移动文件夹，但这给了我诸如“发生意外错误”之类的错误。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-06-06T23:23:43.347

如果您需要从移动之前的时间点分支，则需要指定旧名称。

```
# fails
tf branch $/project/folder-newname $/project/folder-somebranch /version:Loldlabel

# should work
tf branch $/project/folder-oldname $/project/folder-somebranch /version:Loldlabel 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-22T09:17:08.427

与回滚相关的错误是我必须先回滚文件夹重命名。然后我可以回滚移动文件夹。  

# .net - 在对象层次结构中处理空引用的更好方法

> ID：759407
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-17T07:39:32.713
> 
>         
> 
> 标签：.net, null, nullreferenceexception

我正在寻找一种处理对象层次结构中空引用的好方法。

IE：

```
if(null == Object1.Object2.Object3.Property) 
```

如果说 Object2 为空，此示例将引发空引用异常。

就我而言，我不在乎什么是空的，只是有些东西是空的。我真的不想在我想做这样的事情的每个地方都放置 try/catch，所以我一直在寻找替代方案。

我实验过？？运算符，但这会在两个级别之后产生一些难看的代码。

任何想法表示赞赏。

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T08:10:35.663

现在这可能是切线......但我建议改变设计以避免丑陋和痛苦  

呼叫`Object1.Object2.Object3.Property`违反[了得墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter)。相反，如果您应该获得该属性，则 Object1 应该公开一个属性本身...所以您应该调用`Object1.RetrievedFromTheDepthsProperty`

为什么需要这样做.. 如果 Type Object2 的设计者更改了由 ' 返回的 Object 的类型Object3' 字段/属性到没有您要查找的属性的字段/属性，您将被冲洗掉。客户端对Object1的内部结构了解太多。如果 Object1 封装了内部数据所在的位置，那么您可以安全地应对未来的更改。此外，此属性可以根据需要在内部进行所有空值检查......让您更清洁

```
if (Object1.RetrievedFromTheDepthsProperty == null) {...} 
```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T07:43:19.193

这（空安全解除引用）是偶尔提出的，不是的；目前没有明确的答案，除了：

```
if(Object1 == null || Object1.Object2 == null
        || Object1.Object2.Object3 == null
        || Object1.Object2.Object3.Property == null) 
```

如果需要（通过引入变量），您可以做一些小的缓存，但这会变得更加丑陋：

```
SomeType2 obj2;
SomeType3 obj3;
if(Object1 == null || (obj2 = Object1.Object2) == null
        || (obj3 = obj2.Object3) == null
        || obj3.Property == null) 
```

一般来说，我建议不要使用上述方法，除非你真的、*真的*不想调用一个属性两次（因为它比属性应该做的工作更多）

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T08:05:10.077

您可以使用[Null Object 模式](http://en.wikipedia.org/wiki/Null_Object_pattern "空对象模式")。

```
class Car {
    Engine engine = null;

    public Engine Engine { 
        get { 
            return engine ?? new NullEngine();
        }
    }
}

class Engine {
    string make;
    public virtual string Make { get { return make; } }
}

class NullEngine : Engine {
    public override string Make { get { return null; } }
} 
```

然后你可以这样做：

```
Car car;
if (car.Engine.Make != null) Console.WriteLine(car.Engine.Make); 
```

代替：

```
Car car;
if (car.Engine != null && car.Engine.Make != null) Console.WriteLine(car.Engine.Make); 
```

请注意，为整个模型定义“空对象”需要做很多工作。您还需要非常小心，以免混淆模型的用户。如果您传递 null 并忘记检查它，代码往往会迅速爆炸，但是“null 对象”可以更容易地深入调用堆栈并导致微妙的问题，因为它不是一个真实的对象。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:04:43.197

不直接回答您的问题 - 只是一些提示：

*   尝试使用[Null 对象](http://www.cs.oberlin.edu/~jwalker/nullObjPattern/) 

*   到目前为止，似乎不适合通过层次结构（您的三个级别），也许在第一/第二级别上可以回答条件的某种方法会有所帮助

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T07:49:46.370

通常，如果您不关心对象层次结构中哪个属性为空，则不要对其进行测试。为应用程序使用全局错误处理程序（这将取决于应用程序 ASP.NET、WinForms 的类型......）并告诉用户出了点问题。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-05-18T11:15:27.887

我强烈建议您查看以下帖子：
 [http ://www.hardcodet.net/2008/12/observe-dependencies-through-lambda-expressions-part1](http://www.hardcodet.net/2008/12/observe-dependencies-through-lambda-expressions-part1)

它指的是类似的问题，并且还允许您轻松处理更改。

# asp.net-mvc - MVC - 视图中的条件

> ID：759412
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-17T07:41:03.473
> 
>         
> 
> 标签：asp.net-mvc, model-view-controller

引用 NerdDinner ASP.NET MVC 示例应用程序

```
 <%@ Control Language="C#" Inherits="System.Web.Mvc.ViewUserControl" %>
<%
    if (Request.IsAuthenticated) {
%>
        Welcome <b><%= Html.Encode(Page.User.Identity.Name) %></b>!
        [ <%= Html.ActionLink("Log Off", "LogOff", "Account") %> ]
<%
    }
    else {
%> 
        [ <%= Html.ActionLink("Log On", "LogOn", "Account") %> ]
<%
    }
%> 
```

这是来自名为 LoginStatus.ascx 的局部视图用户控件。如您所见，存在改变视图的“整个”输出的条件。这是正确的方法吗。如果有控制器评估这种情况然后渲染适当的局部视图会更好吗？

无论您对上一个问题的回答如何，我如何在 ASP.NET MVC 中采用后一种方法，即父视图能否调用控制器（而不是执行 UserControl 的 RenderPartial）并让它决定要呈现哪个局部视图？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T08:06:18.967

这种方法怎么样：

**解决方案 1**：

创建一个扩展方法`HtmlHelper`，将根据请求呈现“WelcomeMessage.Anonymous.aspx”或“WelcomeMessage.Authenticated.aspx”视图。

```
<%= Html.LoginStatus() => 
```

并将这些视图放在 /Views/Shared 下

```
/Views/Shared/LoginStatus.Anonymous.ascx
/Views/Shared/LoginStatus.Authenticated.ascx 
```

**解决方案 2**：

只需在 LoginStatus.ascx`if / else`中用 ASP.NET 的[LoginView控件替换语句](http://www.dotnetjunkies.ddj.com/QuickStartv20/aspnet/doc/ctrlref/login/loginview.aspx)

```
<asp:LoginView Runat="Server">
    <LoggiedInTemplate>
        Welcome, <%= Html.Encode(Model.UserName) %>!
        <button>Sign Out</button>
    </LoggedInTemplate>
    <AnonymousTemplate>
        <button>Sign In</button> | <button>Join Now!</button>
    </AnonymousTemplate>
</asp:LoginView> 
```

**另见**：

*   [ASP.NET MVC 最佳实践、提示和技巧](https://stackoverflow.com/questions/709429/asp-net-mvc-best-practices-tips-and-tricks)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T07:58:49.717

我认为，如果视图要根据某些条件相应地发生变化，则视图有责任强制执行此操作。但是，如果条件改变的不是外观（即“负数应为红色”）而是行为（即“如果用户已登录，她/他必须看到 LOGOUT 按钮而不是 LOGIN 按钮”），那么由控制器来决定. 您可能会在控制器和页面之间引入“渲染器”级别。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:10:58.363

我认为你所做的一切都很好。显示的变化等小事可以而且应该由视图来承担。

例如，我有一个由单独的 ascx 呈现的主菜单。里面有很多这样的小检查，以确定要显示的文本以及要应用于列表元素的样式。

如果有重大决定，比如考虑基于某些用户操作呈现什么视图，那么控制器会质疑业务逻辑并决定返回哪个视图以及重定向到哪里。但是，如果它是一个非常稳定的 UI 元素，其中只有文本和颜色选项略有变化，那么将必要的逻辑放入其中。

您还可以将一个单独的模型传递给您的 ascx，其中有几个标志定义应该显示什么以及如何显示。然后设置这些标志的实际逻辑将在业务逻辑级别的其他地方，您的所有视图将做的只是查看这些标志并相应地呈现。

别担心，你做对了。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:19:34.190

您可以在控制器中执行此操作，而不是决定用户是否在视图中通过身份验证，如下所示：

```
public ActionResult ShowAPage()
{
   if(!HttpContext.User.Identity.IsAuthenticated) 
   {
      return RedirectToRoute("ShowLoginPage")
   }
   return View();
} 
```

然后，您可以重定向到登录页面，而不是在视图中包含此逻辑，这并不是真正的关注点分离。

一种非常酷的方法是为经过身份验证的用户使用不同的母版页，而不是为未经过身份验证的用户使用不同的母版页。我认为您希望始终显示登录或注销链接，这样您可以使用 ActionFilter 根据用户的身份验证更改母版页。然后，您的登录用户可以获得诸如导航栏之类的内容，您可能希望对外界隐藏这些内容，而无需您在显示逻辑中决定这一点。

这是不使用动作过滤器的一种方法，但您可以使用各种方法，一种很好的方法是创建一个自定义控制器，该控制器继承自控制器并覆盖 View 方法以选择适当的母版页。

```
public ActionResult ShowAPage()
{
   if(!HttpContext.User.Identity.IsAuthenticated) 
   {
      return View("ShowAPageView", "LoggedInMasterPageName");
   }
   return View("ShowAPageView", "LoggedOutMasterPageName");    
} 
```

希望这可以帮助。

# c# - asp.net中的货币格式字符串

> ID：759425
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-17T07:46:43.023
> 
>         
> 
> 标签：c#, asp.net, currency, cultureinfo

我正在使用基础设施网络网格，需要格式化货币字符串。为此，我需要一个包含诸如“$ ### ###,00”之类的模式的字符串，并且我希望它来自我当前的 CultureInfo。我怎样才能做到这一点？我是否需要从以下信息中手动编写它：

```
CultureInfo.CreateSpecificCulture(myLanguageId).NumberFormat.CurrencyGroupSeparator
CultureInfo.CreateSpecificCulture(myLanguageId).NumberFormat.CurrencyGroupSizes
CultureInfo.CreateSpecificCulture(myLanguageId).NumberFormat.CurrencyDecimalDigits
CultureInfo.CreateSpecificCulture(myLanguageId).NumberFormat.CurrencyDecimalSeparator 
```

等等等等

是单线解决方案吗？

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-04-17T07:50:21.953

```
decimal moneyvalue = 1921.39m;
string s = String.Format("{0:C}", moneyvalue); 
```

将使用当前区域性。

确保您的 web.config 中有以下内容：

```
<system.web>
   <globalization culture="auto" uiCulture="auto"/>
</system.web> 
```

或如 ck 建议的那样，在您的页面中声明等价物

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-28T11:52:43.637

感谢您的所有回答。事实证明我的要求是错误的。infragistics 网格不希望模式字符串知道使用哪些分隔符，它将模式字符串用于小数等，然后查询当前文化的其余部分。所以这不是问题。不管怎么说，还是要谢谢你！

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T07:52:47.110

添加到 Greg Dean 的答案中，您可能需要

```
Culture="auto" UICulture="auto" 
```

在页面的@Page 声明中。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T07:52:47.283

首先 - 如果您是特定于文化的，为什么不使用“C”作为格式字符串，从而使用文化的货币格式。

[自定义数字格式字符串](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx)没有货币标记；但是，我怀疑您可以将[货币符号](http://msdn.microsoft.com/en-us/library/system.globalization.numberformatinfo.currencysymbol.aspx)附加到使用“### ###,00”格式化的字符串中。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-06-30T07:41:37.993

我们的项目中有几乎相似的要求。我们所做的是使用基础设施的 webcurrencyedit 控件，将其设置为必须显示货币的列的 editorcontrolid，然后设置 webcurrencyedit 控件的文化。

# c# - 虚拟扩展方法？

> ID：759426
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-04-17T07:48:22.847
> 
>         
> 
> 标签：c#, extension-methods, virtual

我有一个在客户端应用程序和服务器应用程序中使用的类。在服务器应用程序中，我通过扩展方法向类添加了一些功能。效果很好。现在我想要更多：

我的类 (B) 继承自另一个类 (A)。

我想将一个虚函数附加到 A（比如说 Execute() ），然后在 B 中实现该函数。但仅限于服务器中。Execute() 方法将需要使用只有服务器知道的类型来执行只能在服务器上执行的操作。

有许多类型从 A 继承，就像 B 一样，我想为它们中的每一个实现 Execute()。

我希望我可以向 A 添加一个虚拟扩展方法，但这个想法似乎并没有实现。我正在寻找解决这个问题的最优雅的方法，不管有没有扩展方法。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T07:59:07.517

不，没有虚拟扩展方法之类的东西。您可以使用重载，但这不支持多态性。听起来您可能想查看依赖注入（等）之类的东西，以便在不同的环境中添加不同的代码（依赖项） - 并在常规虚拟方法中使用它：

```
class B {
     public B(ISomeUtility util) {
         // store util
     }
     public override void Execute() {
         if(util != null) util.Foo();
     }
} 
```

然后使用 DI 框架在运行时提供特定`ISomeUtility`于服务器的实现`B`。您可以使用中央`static`注册表（IOC，但没有 DI）做同样的事情：

```
 override void Execute() {
        ISomeUtility util = Registry.Get<ISomeUtility>();
        if(util != null) util.Foo();
    } 
```

（你需要在哪里写`Registry`等；加上在服务器上，注册`ISomeUtility`实现）

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2011-02-11T18:49:41.167

您可以使用新的动态类型功能来避免为方法构建类型注册表：

```
using System;
using System.Collections.Generic;
using System.Linq;
using visitor.Extension;

namespace visitor
{
    namespace Extension
    {
        static class Extension
        {
            public static void RunVisitor(this IThing thing, IThingOperation thingOperation)
            {
                thingOperation.Visit((dynamic)thing);
            }

            public static ITransformedThing GetTransformedThing(this IThing thing, int arg)
            {
                var x = new GetTransformedThing {Arg = arg};
                thing.RunVisitor(x);
                return x.Result;
            }
        }
    }

    interface IThingOperation
    {
        void Visit(IThing iThing);
        void Visit(AThing aThing);
        void Visit(BThing bThing);
        void Visit(CThing cThing);
        void Visit(DThing dThing);
    }

    interface ITransformedThing { }

    class ATransformedThing : ITransformedThing { public ATransformedThing(AThing aThing, int arg) { } }
    class BTransformedThing : ITransformedThing { public BTransformedThing(BThing bThing, int arg) { } }
    class CTransformedThing : ITransformedThing { public CTransformedThing(CThing cThing, int arg) { } }
    class DTransformedThing : ITransformedThing { public DTransformedThing(DThing dThing, int arg) { } }

    class GetTransformedThing : IThingOperation
    {
        public int Arg { get; set; }

        public ITransformedThing Result { get; private set; }

        public void Visit(IThing iThing) { Result = null; }
        public void Visit(AThing aThing) { Result = new ATransformedThing(aThing, Arg); }
        public void Visit(BThing bThing) { Result = new BTransformedThing(bThing, Arg); }
        public void Visit(CThing cThing) { Result = new CTransformedThing(cThing, Arg); }
        public void Visit(DThing dThing) { Result = new DTransformedThing(dThing, Arg); }
    }

    interface IThing {}
    class Thing : IThing {}
    class AThing : Thing {}
    class BThing : Thing {}
    class CThing : Thing {}
    class DThing : Thing {}
    class EThing : Thing { }

    class Program
    {
        static void Main(string[] args)
        {
            var things = new List<IThing> { new AThing(), new BThing(), new CThing(), new DThing(), new EThing() };
            var transformedThings = things.Select(thing => thing.GetTransformedThing(4)).Where(transformedThing => transformedThing != null).ToList();
            foreach (var transformedThing in transformedThings)
            {
                Console.WriteLine(transformedThing.GetType().ToString());
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T15:41:03.570

我会建议类似以下内容。可以通过添加对检测没有调度映射的中间类层次结构类型的支持并根据运行时层次结构调用最近的调度方法来改进此代码。它还可以通过使用反射来检测 ExecuteInteral() 的过载并将它们自动添加到调度映射中来改进。

```
using System;
using System.Collections.Generic;

namespace LanguageTests2
{
    public class A { }

    public class B : A {}

    public class C : B {}

    public static class VirtualExtensionMethods
    {
        private static readonly IDictionary<Type,Action<A>> _dispatchMap 
            = new Dictionary<Type, Action<A>>();

        static VirtualExtensionMethods()
        {
            _dispatchMap[typeof(A)] = x => ExecuteInternal( (A)x );
            _dispatchMap[typeof(B)] = x => ExecuteInternal( (B)x );
            _dispatchMap[typeof(C)] = x => ExecuteInternal( (C)x );
        }

        public static void Execute( this A instance )
        {
            _dispatchMap[instance.GetType()]( instance );
        }

        private static void ExecuteInternal( A instance )
        {
            Console.WriteLine("\nCalled ToString() on: " + instance);
        }

        private static void ExecuteInternal(B instance)
        {
            Console.WriteLine( "\nCalled ToString() on: " + instance );
        }

        private static void ExecuteInternal(C instance)
        {
            Console.WriteLine("\nCalled ToString() on: " + instance);
        }
    }

    public class VirtualExtensionsTest
    {
        public static void Main()
        {
            var instanceA = new A();
            var instanceB = new B();
            var instanceC = new C();

            instanceA.Execute();
            instanceB.Execute();
            instanceC.Execute();
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:05:05.287

虚拟意味着以 OOP 方式继承，而扩展方法是“只是”静态方法，通过一点语法糖，编译器允许您假装调用其第一个参数类型的实例。所以不，虚拟扩展方法是不可能的。

查看 Marc Gravell 的答案，了解您的问题的可能解决方案。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:08:47.947

您可以实现服务寄存器。示例（服务器端）：

```
static IDictionary<Type, IService> serviceRegister;

public void ServerMethod(IBusinessType object)
{
  serviceRegister[obect.GetType()].Execute(object);
} 
```

您需要的是服务器中的服务，它们实现服务器端功能，而不是扩展方法。我不会在扩展方法中投入太多逻辑。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:39:40.633

让我检查一下：您有一个继承自 A 的类层次结构，大概是根据您的业务领域构建的。然后，您要根据类的执行位置添加行为。到目前为止，您已经使用了扩展方法，但现在您发现无法让它们随着您的类层次结构而变化。您在服务器上附加了哪些类型的行为？

如果是事务管理和安全之类的东西，通过依赖注入实现的策略 à la Marc 的建议应该很好用。您还可以考虑通过委托和 lambda 实现[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)，以获得更有限的 DI 版本。但是，尚不清楚客户端代码当前如何使用您的类及其在服务器上的扩展方法。其他类对您如何添加服务器端功能的依赖程度如何？它们是当前期望找到扩展方法的仅服务器端类吗？

在任何情况下，听起来您都需要仔细的可测试性设计和测试策略，因为您要沿两个同时的维度（继承层次结构、执行环境）引入变化。我相信您正在使用单元测试？检查您选择的任何解决方案（例如，通过配置进行 DI）与测试和模拟的交互是否良好。

# unix - 为什么有用户上下文和内核上下文... unix

> ID：759428
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T07:48:34.297
> 
>         
> 
> 标签：unix, operating-system, scheduling

操作系统相关的问题不知道我是否可以在这里问

但我想我会在这个论坛上得到适当的解释

当一个进程在用户上下文中执行时......内核上下文中的更高优先级进程不会一直阻塞用户上下文中的进程......

对我来说是朦胧的……概念

……

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T08:41:49.550

操作系统中有两种主要的调度器，抢占式调度器和非抢占式调度器。

非抢占式调度程序的行为会像您想象的那样，具有更高权限和更高优先级的进程将继续使用 cpu 直到它完成或直到它阻塞（例如在互斥锁上或调用 yield 显式释放 cpu 以便调度另一个。）

但是非抢占式调度器很少见，linux调度器不是那种。它使用时间片让进程在取消调度之前工作一小段时间，它还包括优先级但保持以较低优先级调度进程，你应该看看[这篇 linux scheduler article](http://www.ibm.com/developerworks/linux/library/l-scheduler/)。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T08:48:36.727

[这篇 Stackoverflow 帖子](https://stackoverflow.com/questions/556405/what-do-real-user-and-sys-mean-in-the-output-of-time1)有一个讨论，其中包括对内核模式如何工作的简要说明以及对一些行话的解释。特别是查看标题为“内核与用户模式的简要介绍”的部分。这可能有助于阐明您的问题。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:00:51.117

内核模式下的进程也可以在达到量程时被抢占。

维基百科：[抢占](http://en.wikipedia.org/wiki/Preemption_%28computing%29)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:01:13.610

[http://en.wikipedia.org/wiki/Ring_0](http://en.wikipedia.org/wiki/Ring_0)

# image-processing - 寻找值得信赖的 JPEG 批量转换器/大小调整器

> ID：759435
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T07:52:46.410
> 
>         
> 
> 标签：image-processing, jpeg

我有一批需要转换为 JPEG 的 PNG 文件。我正在寻找一个免费的值得信赖的实用程序，它将为我提供最优化的 JPEG。

我找到了一些付费实用程序，并且我有 Photoshop，但我想要一些专门用于该任务的东西，我不想意外下载间谍软件。

我真的很惊讶没有在 StackOverflow 上找到这个问题，但如果存在任何类似问题，请指出我的方向。

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T07:53:53.490

一个词：[ImageMagick](http://www.imagemagick.org/script/index.php)。

不确定它是否会生成您可以获得的绝对最小的 JPEG，但它肯定很好，并且将是我的首选。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T08:00:14.207

[IrfanView](http://www.irfanview.com/)是另一种选择。它具有“批量转换/重命名”功能，但它是一个仅限 Windows 的 GUI 应用程序。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T07:55:31.923

Imagemagick ( [http://www.imagemagick.org/script/index.php](http://www.imagemagick.org/script/index.php) ) 可以批量转换图片。

mogrify -format jpg *.png <= 将所有 png 文件转换为 jpg

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T07:57:37.503

ImageMagick[转换](http://www.imagemagick.org/script/convert.php)实用程序应该可以满足您的所有要求。您可以使用[许多选项](http://www.imagemagick.org/Usage/formats/#jpg_write)来控制 JPEG 输出质量。

# python - 子进程在 Python 中检测父进程的死亡

> ID：759443
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-04-17T07:56:42.327
> 
>         
> 
> 标签：python, subprocess

Python中的子进程有没有办法检测父进程是否已经死亡？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T08:02:38.927

如果你的 Python 进程在 Linux 下运行，并且`prctl()`暴露了系统调用，你可以在[这里](https://stackoverflow.com/questions/284325/how-to-make-child-process-die-after-parent-exits)使用答案。

当父进程终止时，这可能会导致向子进程发送信号。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2010-11-19T20:58:53.943

[假设在您开始执行此操作时父级还活着，您可以使用psutil](https://github.com/giampaolo/psutil)检查它在繁忙循环中是否仍然活着：

```
import psutil, os, time
me = psutil.Process(os.getpid())
while 1:
    if me.parent is not None:
        # still alive
        time.sleep(0.1)
        continue
    else:
        print "my parent is gone" 
```

不是很好但是...

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-10-05T10:32:39.707

我所知道的唯一可靠的方法是专门为此目的创建一个管道。孩子将不得不反复尝试从管道中读取，最好以非阻塞方式或使用 select。当管道不再存在时（可能是由于父母去世），它会报错。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:01:56.387

您可能会在进程的早期就读取父进程的 ID，然后进行检查，但这当然容易出现竞争条件。进行生成的父级可能立即死亡，甚至在您的进程开始执行其第一条指令之前。

除非您有办法验证给定的 PID 是否指的是“预期的”父级，否则我认为很难做到可靠。

# mysql - Rails 2.3.2 的 MySQL 全文索引（迁移问题）

> ID：759447
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-17T07:57:40.873
> 
>         
> 
> 标签：mysql, sql, ruby-on-rails, mysql-error-1170

我在 Rails 2.3.2 应用程序中使用 MySQL 全文索引。我在迁移中通过本机 SQL 添加了索引。但是有一个已知问题会导致 schema.rb 出现问题。Rails 不理解全文索引并尝试创建普通索引。这在从 schema.rb 创建数据库时会导致错误（例如 testing、specs 等）：

```
Mysql::Error: BLOB/TEXT column 'text' used in key specification without a key length: CREATE  INDEX `fulltext_sms` ON `sms` (`text`) 
```

有没有办法在 Rails 2.3.2 中解决这个问题而无需猴子修补 Rails？如果没有，解决这个问题的最佳方法是什么？

谢谢！

我的迁移：

```
class FulltextIndexCustomersSmsMessage < ActiveRecord::Migration
  def self.up
    execute('ALTER TABLE sms ENGINE = MyISAM')
    execute('ALTER TABLE customers ENGINE = MyISAM')
    execute('CREATE FULLTEXT INDEX fulltext_sms ON sms (text(500))')
    execute('CREATE FULLTEXT INDEX fulltext_customer ON customers (fullname(255))')
  end

  def self.down
    execute('ALTER TABLE sms ENGINE = innodb')
    execute('ALTER TABLE customers ENGINE = innodb')
    execute('DROP INDEX fulltext_sms ON sms')
    execute('DROP INDEX fulltext_customer ON customers')
  end
end 
```

架构.rb：

```
add_index "sms", ["text"], :name => "fulltext_sms" 
```

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-05-16T18:26:46.803

我认为你需要在你的 environment.rb 中设置它：

```
config.active_record.schema_format = :sql 
```

这里参考：[https ://rails.lighthouseapp.com/projects/8994/tickets/74-problem-with-tests-and-custom-mysql-fulltext-indexes](https://rails.lighthouseapp.com/projects/8994/tickets/74-problem-with-tests-and-custom-mysql-fulltext-indexes)

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-18T14:55:56.243

How about using one of the full-text search engines that can be easily plugged into Rails? Saves you the trouble of doing it all yourself with mysql. Two good options, that provide lots of customization, are:

*   Sphinx with ThinkingSphinx plugin (or UltraSphinx). [http://ts.freelancing-gods.com/](http://ts.freelancing-gods.com/)

*   Ferret with acts_as_ferret plugin. [http://www.railsenvy.com/2007/2/19/acts-as-ferret-tutorial](http://www.railsenvy.com/2007/2/19/acts-as-ferret-tutorial)

# .net - 如何查看 .net JITer 生成的机器代码的反汇编？

> ID：759462
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T08:03:35.167
> 
>         
> 
> 标签：.net, visual-studio-2008, debugging, disassembly

如何查看 .net JITer 生成的机器代码的反汇编？显示反汇编窗口菜单选项在哪里找不到。甚至它的工具栏按钮也处于禁用状态。如果我没记错的话，确实可以看到拆卸，但必须使用一些技巧，不幸的是我不记得那个技巧是什么了。有人可以在这里提供一些指示吗？

调试环境：VS2008（我猜你可以在WinDbg和一些调试器扩展（SOS.dll？）中看到反汇编没有太大的痛苦，现在我认为VS2008也可能使用相同的dll让我检查并回复你。如果我错了，请随时纠正我。）

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:25:39.013

在 VS2008 Team System Developer Edition 的 C# 项目中，反汇编窗口对我来说工作正常。

实际上 - 有一件事没有像我希望的那样工作 - 我无法进入框架代码。也许某个地方的某些设置可能会让我这样做，我不知道。但是我可以为我自己的代码逐步完成反汇编。

您使用的是 VS2008 Express 吗？也许这有一些限制。

总是有cordbg（哎呀！）。

当然，JITer 在调试器下运行时会生成未优化的代码。您可以跳过一些障碍来避免这种情况 - 例如在 JIT 完成您想要查看的任何工作之后附加到流程。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:40:09.400

嗨，不幸的是，show debug window 命令仍然无法正常工作，但您可以使用名为 SOS.dll 的调试器扩展 dll 来调试/反汇编 .net 代码，这里有一些链接（注意这适用于 VS2008 和 WinDbg）...

1) [MSDN: SOS Debugging Extension (SOS.dll)](http://msdn.microsoft.com/en-us/library/bb190764.aspx)

2)[在 Windbg 中使用 SOS 的一些一般技巧](http://blogs.msdn.com/rextang/archive/2007/07/24/4026494.aspx)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-20T22:47:10.133

似乎对我来说工作正常。您是否启用了地址级别调试？工具 | 选项 | 调试 | 一般 | 启用地址级调试？

要获得反汇编窗口，请转到调试 | 窗户 | 反汇编（我正在使用 c# 开发人员配置文件）

或者，在命令行窗口中，键入 Debug.Dissassembly

# activation - 远程激活/停用和防止停业

> ID：759464
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T08:04:48.253
> 
>         
> 
> 标签：activation

我负责一个使用互联网在站点之间传输数据的应用程序，并且一些客户对付款感到尴尬，因此我们需要一种机制来允许我们切断非付款人的服务。我想防止管理员使用防火墙来阻止我们的检查，但相反，我想为我们公司的网站因某种原因消失并且无法访问提供一些余地。

我想象的方案是：

```
server makes twice daily check to web page using a URL like:
http://www.ourcompany.com/check.php?myID=GUID&Code=MyCode 
```

然后，这将返回一个响应，其中包含任何感兴趣的内容或 GUID 和一个值。

```
GUID=0 
```

该零表示服务器应该停止操作。为了使其再次工作，服务器将每 5 分钟检查一次相同的信息，直到该值与它认为应该将其传入的代码转换为的值匹配。

这个方案对我来说很有意义，但问题实际上是如何防止阻塞。鉴于我们知道我们必须能够访问互联网，我们应该在无法从我们的网络服务器获得响应的情况下继续操作多长时间？是 14 天，然后我们还是把它关掉是最好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-08-31T14:29:50.937

我最终使用的解决方案与我建议的差不多。是的，使用此处概述的工具可以将其击败，但总比没有好。

该应用程序每天检查以访问包含使用公钥加密加密的控制文件的网站。它在内存中解密，如果找到它的 GUID，那么它必须匹配一个代码。要禁用该操作，代码设置为 0（零），这将始终失败。禁用时，它每两分钟检查一次以允许快速恢复。还有一种手动机制可以生成代码，该代码可以在服务器出现故障时工作一周。

该代码最多允许 14 天不连接到服务器，然后才会将其视为故意阻止它。10 天后，它会显示一条错误消息，要求他们联系支持。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:19:12.710

这种方法真的很容易规避：只需使用本地 dns 服务器将 www.ourcompany.com 指向本地机器，或者使用 http 代理。然后用户可以向程序返回他们想要的任何响应。

假设用户没有规避检查，那么您在没有确认的情况下继续操作多长时间是业务决策，而不是编程决策。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-18T13:31:04.200

用户可以使用诸如 OWASP WebScarab 之类的工具来动态更改值以颠覆您的安全模型。您需要包含一些更困难的内容，例如需要安全通道、比较公钥等。

# regex - awk 或 sed：获取 [this text] 的最佳方式

> ID：759468
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T08:05:04.397
> 
>         
> 
> 标签：regex, sed, awk

我正在尝试从日志文件中解析各种信息，其中一些放在方括号内。例如：

```
Tue, 06 Nov 2007 10:04:11 INFO     processor:receive: [someuserid], [somemessage]  msgtype=[T] 
```

使用 sed、awk 或其他 unix 实用程序从这些行中获取“someuserid”的优雅方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T08:07:41.817

**[像](http://en.wikipedia.org/wiki/Cut_(Unix))** 
这样使用它：`cut -f2 -d[ | cut -f1 -d]`

```
bart@hal9k:~> YOURTEXT="Tue, 06 Nov 2007 10:04:11 INFO     processor:receive: [someuserid], [somemessage]  msgtype=[T]"
bart@hal9k:~> SOMEID=`echo $YOURTEXT | cut -f2 -d[ | cut -f1 -d]`
bart@hal9k:~> echo $SOMEID
someuserid 
```

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T16:16:02.657

*如果你想对所有*带括号的字段做点什么，我会使用 Perl：

```
perl -lne '
    my @fields = /\[(.*?)\]/g;
    # do something with @fields, like:
    print join(":", @fields);
' logfile ... 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-11-28T06:37:12.413

使用 bash 外壳

```
while read -r line
do
   case "$line" in
        *processor*receive* ) 
            t=${line#*[}
            echo ${t%%]*}
            ;;
   esac
done < "file" 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2010-03-17T08:36:33.527

```
sed -n '/INFO/{s/.[^[]*\[//;s/\].*//p}' file 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2010-03-17T09:21:22.503

使用 AWK：

```
cat file | awk -F[\]\[] '{print $2}' 
```

我发现多个分隔符在某些旧版本的 AWK 中不起作用。如果没有，您可以使用两个 awk：

```
cat file | awk -F[ '{print $2}' | awk -F] '{print $1}' 
```

# biztalk - 使用 BizTalk 2006 加入记录

> ID：759472
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T08:06:04.317
> 
>         
> 
> 标签：biztalk, biztalk-2006

我有一个问题正在尝试使用 BizTalk 解决，并希望您对解决它的最佳方法有一些想法。我正在使用平面文件适配器加载平面文件。此文件包含许多不同类型的记录。类型 1 记录是父记录。其余类型都使用各种外键链接到父记录。我正在寻找一种转换，它将获取通过加载平面文件（包含所有类型的记录）创建的消息并将其转换为消息，该消息是基于外键连接所有记录的结果。因此，结果消息中的每条记录都将包含来自所有记录类型的列，因为消息记录将是连接的结果。

例如，平面文件可能包含以下记录：

```
* Type1
* Type1
* Type2
* Type2
* Type3
* Type4
* Type4 
```

转换后的消息可能包含如下记录：

```
* Type1 columns, type2 columns, type3 columns, type4 columns
* Type1 columns, type2 columns, type4 columns 
```

我一直在研究实现这一目标的选项，但希望有些人可能对前进的道路提出建议。

我尝试过的事情是：

*   将原始消息拆分为具有每种类型记录的消息，然后使用多源映射将它们连接起来。我很难做到这一点，因为我不确定要使用什么 functoid。

*   将子记录插入 SQL 数据库，以便可以使用 SQL 查找 functoid 填充父记录中的其他列。这比我希望的要慢一些，并且具有使用数据库的额外依赖性。

*   使用 DTS 加载文件，将其转换为格式并以合并格式写出文件以供 BizTalk 使用。这既简单又快速，但不使用 BizTalk。

任何有关如何继续充分利用 BizTalk 的建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-05-07T09:46:52.337

也许您可以尝试使用所谓的“Muenchian 方法”为映射编写自定义 xslt。这是一种使用 xslt 对 xml 输入进行排序的方法。在这种情况下，输入可能是 BizTalk 提供的平面文件的 xml 表示形式。

[请参阅http://biztalkhotrod.com/Documents/BizTalk_HotRod_Issue6_Q2_2009.pdf](http://biztalkhotrod.com/Documents/BizTalk_HotRod_Issue6_Q2_2009.pdf)上的 HotRod 杂志 2009 年第 2 季度问题。   
该问题还涉及在 BizTalk 中使用自定义 xslt 的主题。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-06T02:59:17.643

这听起来更像是一个 ETL 问题。我建议SSIS。我过去曾将 BizTalk 用于 ETL，但结果一直没有好。

# vb.net - VB.NET 中的 C 指针等价物是什么？

> ID：759474
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T08:06:39.167
> 
>         
> 
> 标签：vb.net, pointers

VB.NET 中与指针最相似的东西是什么，就像 C 指针一样？

我有`TreeView`一个班内。我需要公开一些可以被外部对象修改的特定节点（或叶子）。

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T08:30:40.217

C#，我也相信 VB.Net，将致力于引用的概念。本质上，这意味着当你说

A a = 新 A()

'a' 是一个参考，而不是实际的对象。

所以如果我去

B b = a

b 是对同一底层对象的另一个引用。

当你想公开任何内部对象时，你可以简单地通过公开“属性”来做到这一点。确保您不提供属性的设置器，或者如果提供，则有代码来检查该值是否合法。

当您希望将对象作为参数传递，并且希望被调用的方法能够更改引用（与对象相反）时，使用 ByRef。

如上所述，如果你发布一些代码，它会更容易解释。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T08:44:25.490

Nathan W 已经提出了可以表示指针或句柄的[IntPtr](http://msdn.microsoft.com/en-us/library/system.intptr(VS.71).aspx)结构，然而，虽然这个结构是 .NET 框架的一部分，但 .NET 确实没有单独的指针，当然也不像 C 指针。

这主要是因为 .NET Framework 是一个“托管”平台，内存由 CLR 管理、分配、分配和释放，而开发人员无需担心（即没有 malloc 命令！）这主要是因为这个您实际上无法访问直接内存地址的内存管理。

.NET Framework 中最接近的可以被认为是“指针”（但实际上不是指针）的东西是[委托](http://www.codeproject.com/KB/vb/Delegate.aspx)。您可以将[委托](http://www.developerfusion.com/article/5251/delegates-in-vbnet/)视为“函数指针”，但是，从最严格的意义上讲，它并不是真正的指针。  [委托](http://msdn.microsoft.com/en-us/library/system.delegate.aspx)向调用函数添加类型安全，允许代码“调用”委托实例以确保它使用正确的参数调用正确的方法。这与“传统”指针不同，因为它们不是类型安全的，并且仅引用内存地址。

委托在 .NET Framework 中无处不在，每当您使用[事件](http://msdn.microsoft.com/en-us/library/17sde2xt(VS.71).aspx)或响应事件时，您都在使用委托。

如果您想使用 C# 而不是 VB.NET，您可以编写标记为“[不安全](http://msdn.microsoft.com/en-us/library/chfa2zb8(VS.71).aspx)”的代码。这允许 unsafe 块中的代码在 CLR 的保护之外运行。反过来，这允许使用“真正的”[指针](http://www.c-sharpcorner.com/UploadFile/rajeshvs/PointersInCSharp11112005051624AM/PointersInCSharp.aspx)，就像 C 一样，但是，它们仍然有一些限制（例如可以在指向的内存地址处）。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2012-05-29T21:01:35.003

最好的方法是手动分配所有内容：

您可以随意向上或向下移动每个堆栈，而无需推送或弹出。

```
Dim Stack(4095) as Byte    'for 8bit   - 1 bytes each entry
Dim Stack(4095) as Integer 'for 16bit  - 2 bytes each entry
Dim Stack(4095) as Long    'for 32bit  - 4 bytes each entry
Dim Stack(4095) as Double  'for 64 bit - 8 bytes each entry

Dim i as integer           'Where i is your Stack Pointer(0 through 4095)
Dim int as integer         'Byte Integer Long or Double  (8, 16, 32, 64 bit)

for i = 0 to 4095

    int = i

    Stack(i) = int/256                         'For 8bit  Byte
    Stack(i) = int                             'For 16bit Integer
    Stack(i) = Microsoft.VisualBasic.MKL$(int) 'For 32bit Long
    Stack(i) = Microsoft.VisualBasic.MKD$(int) 'For 64bit Double

    MsgBox(Microsoft.VisualBasic.HEX$(Stack(i))) 'To See Bitwise Length Per Entry

next i 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:11:29.687

如果您使用的是 VB，那么唯一真正接近指针的是[IntPtr](http://msdn.microsoft.com/en-us/library/system.intptr(VS.71).aspx)。如果您有权访问 C#，则可以使用不安全的 C# 代码来执行指针工作。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:14:53.673

如果您希望从子例程中传回某些内容，则可以通过引用传递它——如“ByRef myParamter as Object”中所示。

最佳答案在某种程度上取决于您要做什么。

# jquery - jQuery 突出显示表格行

> ID：759475
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-17T08:06:48.077
> 
>         
> 
> 标签：jquery, wordpress

我需要在鼠标悬停时突出显示表格行。看起来是一件很容易的事情，对吧？特别是使用 jQuery。但很可惜，我没那么幸运。

我已经测试了突出显示表格行的不同解决方案，但似乎没有任何效果:-(

我已经测试了以下脚本：

```
// TEST one    
jQuery(document).ready(function() { 

  jQuery("#storeListTable tr").mouseover(function () { 
    $(this).parents('#storeListTable tr').toggleClass("highlight"); 
    alert('test'); // Just to test the mouseover event works
  }); 

});

//TEST 2
jQuery(document).ready(function() { 

   $("#storeListTable tbody tr").hover( 
     function() {  // mouseover 
          $(this).addClass('highlight'); 
     }, 
     function() {  // mouseout 
          $(this).removeClass('highlight'); 
     } 
   );
}); 
```

**这是我的 HTML 代码**

```
<html> 
  <head> 
  <title>Title</title> 
  <link rel="stylesheet" href="css/storeLocator.css" type="text/css" 
media="screen" charset="utf-8" /> 
  <script type="text/javascript" src="js/jquery.js" charset="utf-8"></ 
script> 
  </head> 
  <body> 

<table id="storeListTable"> 
    <thead> 
      <tr class="even"> 
        <th>ID</th> 
        <th>Navn</th> 
        <th>E-post</th> 
        <th>Nettside</th> 
      </tr> 
    </thead> 
    <tbody> 
      <tr class="" id="store1"> 
        <td>10</td> 
        <td>Boss Store Oslo</td> 
        <td> <a href="mailto:">E-post</a></td> 
        <td> <a href="#">www</a></td> 
      </tr> 
      <tr class="" id="store3"> 
        <td>8</td> 
        <td>Brandstad Oslo City</td> 
        <td> <a href="mailto:a@brandstad.no">E-post</a></td> 
        <td> <a href="#">www</a></td> 
      </tr> 
      <tr class="even" id="store4"> 
        <td>7</td> 
        <td>Fashion Partner AS</td> 
        <td> <a href="mailto:b@fashionpartners.com">E-post</a></td> 
        <td> <a href="#">www</a></td> 
      </tr> 
      <tr class="" id="store5"> 
        <td>1</td> 
        <td>Follestad</td> 
        <td> <a href="mailto:c@online.no">E-post</a></td> 
        <td> <a href="#">www</a></td> 
      </tr> 
      <tr class="even" id="store6"> 
        <td>2</td> 
        <td>Follestad</td> 
        <td> <a href="mailto:d@follestad.com">E-post</a></td> 
        <td> <a href="#">www</a></td> 
      </tr> 
    </tbody> 
  </table> 
  </body> 
</html> 
```

所以....谁能给我一个正确的方向推动？

* * *

**更新**   

我不再使用 jQuery 来突出显示表格行，而是使用 CSS。

这适用于列表元素，但我猜这也适用于表格行：

li:nth-child(odd) { 背景色：#f3f3f3; }

* * *

## 回答 #1

> 赞同：33
> 
>             
> 
> 时间：2009-04-20T15:45:26.090

如果您不需要 IE6 支持，可以使用一些简单的 CSS 来完成突出显示：

```
#table tr:hover {
  background-color: #ff8080;
} 
```

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-04-18T06:04:27.050

试试这个插件[http://p.sohei.org/jquery-plugins/columnhover/](http://p.sohei.org/jquery-plugins/columnhover/)

这是你如何使用它。

```
<script type="text/javascript"> 
    $(document).ready(function()
    {
        $('#storeListTable').columnHover({ hoverClass:'highlight'});
    });
</script> 
```

小心

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T09:36:33.320

测试时是否真的弹出警报消息？

如果是这样，则问题可能出在您的 CSS 上。我花了很长时间才意识到应用于 tr 标签的大多数样式都没有任何效果。所以，一般来说，你需要对行中的每个 td 应用样式

```
.highlight td {highlighted appearance} 
```

而不是

```
.highlight {highlighted appearance} 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-18T05:03:44.123

+1 wheresrhys。使用背景规则`.highlight td`使您的“测试 2”对我来说很好。

'TEST 1' 不会，因为不必要的`parents()`调用。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2011-07-12T20:31:29.767

有一次，我找到了这个解决方案 - 完美运行 - 只需添加！不幸的是，我不认识作者:(

```
<script type="text/javascript">

    $("#table_id").not(':first').hover(
        function () {
            $(this).css("background","red");
        }, 
        function () {
            $(this).css("background","");
        }
    );

    </script> 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2012-05-30T09:27:39.160

看看这个
[如何在鼠标悬停时突出显示表格中的行？](http://jqfaq.com/how-to-highlight-rows-in-a-table-on-mouse-hover/)

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2012-07-21T11:44:43.467

当然，使用简单 CSS 的 Julian 解决方案是首选。如果你想在javascript中动态地做，你可以这样做

```
$('#storeListTable').on('mouseenter','div',function(){$(this).css('background','white');});
$('#storeListTable').on('mouseleave','div',function(){$(this).css('background','');}); 
```

如果每行有更多 div，则可以通过给每一行 class="row" 并将 'div.row' 作为 on() 的第二个参数来指定要突出显示的 div。

# scripting - 显示目录大小的批处理文件

> ID：759481
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T08:08:09.507
> 
>         
> 
> 标签：scripting, batch-file, directory, size

我想修改这个脚本。我不能让它接受通配符：

```
@echo off
setLocal EnableDelayedExpansion
set /a value=0
set /a sum=0
FOR /R %1 %%I IN (*) DO (
set /a value=%%~zI/1024
set /a sum=!sum!+!value!
)
@echo Size is: !sum! k 
```

它位于一个名为 dirsize 的批处理文件中，调用方式如下：

```
dirsize c:\folder 
```

我希望它为我检查文件夹大小。这是一个例子，Firefox中的缓存：

```
dirsize C:\users\%username%\AppData\Local\Mozilla\Firefox\*.default\Cache 
```

它返回值 0。

但如果我去

```
dirsize C:\users\%username%\AppData\Local\Mozilla\Firefox\sr1znnb4.default\Cache 
```

它有效，我得到返回的值 55322。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-08-17T01:36:51.720

当然，PowerShell 使这变得简单：

```
    (gci . -Recurse | Measure-Object -Property Length -Sum).Sum

```

PowerShell 已经安装在 Windows 7 上。跟上潮流吧！:-)

此外，`C:\users\%USERNAME%\AppData\`这不是查找 AppData 的可靠方法。尝试`%APPDATA%`（或`$env:APPDATA`在 PowerShell 中）。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-08-24T17:24:11.127

对于初学者来说，可以说通配符在整个批处理文件中都没有得到很好的支持，特别是在**for 循环**中。

这就是我想出的：

**DirSize.cmd** "*有效路径*"

```
@echo off
rem Args[1]= "Path" or "valid path with wildcard"
set _size=0
set dRaw=%~1
echo %~1|findstr "*"&& set dSource=%~dp1|| (
    set dSource=%~1\
    if not "%dRaw:~-1%"=="\" set dRaw=%dRaw%\
)
for /f "delims=" %%D in ('dir /ad /b %dRaw%') do call :DirSize "%dSource%%%~D"
set /a size=_size/1024
echo size=%size% k (%_size% bytes)
exit /b 0

:DirSize
    call :FileSize "%~1"
    for /f "delims=" %%d in ('dir /ad /b "%~1"2^>nul') do call :DirSize "%~1\%%~d"
    exit /b 0

:FileSize
    for /f "delims=" %%f in ('dir /a-d /b "%~1\"2^>nul') do for %%F in (%1\%%f) do set /a _size+=%%~zF
    exit /b 0 
```

**___用法___**

**参数：**需要是包含**或**不包含通配符的路径（不是文件）。**输入dir** ***path***时路径必须有效

 ***___Notes___**

这个脚本会检查所有文件和子目录，甚至是隐藏/系统的。更改 dir **/a**参数并添加**-hs**（如 /ad-hs）以删除此行为。

我现在根据自己的喜好修改了参数检查，所以我认为它是可用的。

我希望这有帮助。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:48:52.040

如果你有一个 Windows 版本`grep`（你可以在[GNU utility for Win32](http://unxutils.sourceforge.net/)找到一个）你可以做这样的事情：

```
dir /s %1 | grep --after-context=1 "Total Files Listed:" 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:49:30.390

您需要将当前拥有的内容包装在另一个`for`循环中，该循环将其扩展`*`为一系列目录。

所以

```
@echo off
setLocal EnableDelayedExpansion
set /a sum=0
for /d %%D in (%1) do (
  FOR /R %%D %%I IN (*) DO (
    set /a value=%%~zI/1024
    set /a sum=!sum!+!value!
  )
)
echo Size is: !sum! k 
```

可能工作（虽然未经测试，但应该给你一个大致的想法）

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2014-08-16T22:12:24.833

此代码会将目录大小限制增加到 2,000,000 TB，并将显示更实际的大小，如果文件夹包含太多文件，这将很有用。

```
rem SET DIR=%1
SET DIR=C:\DIR1\

IF NOT EXIST "%DIR%" (
ECHO Directory "%DIR%" does not exist.
goto END
)

setlocal EnableDelayedExpansion

set GB=
set SIZE=

set exp=000000000

FOR /R "%DIR%" %%F IN (*) DO (
set /a SIZE=!SIZE!+%%~zF
if !SIZE! geq 1!exp! (
set /a GB=!GB!+!SIZE:~0,-9!
for /f "tokens=* delims=0" %%a in ("!SIZE:~-9!") do set SIZE=%%a
)
)
if not defined SIZE set SIZE=0
if not defined GB goto EOS

FOR /L %%N IN (1,1,9) DO (
if "!SIZE:~%%N!" == "" (
set SIZE=!GB!!exp:~%%N!!SIZE!
goto EOS
)
)
:EOS

call :Divide !SIZE! 1024 SIZEKB

echo Size is: !SIZE!B (!SIZEKB!kB)

endlocal

:END
pause
exit

:Divide
set Num1=%~1
set Num2=%~2
set %3=
set Num=
set Number=
IF !Num2! EQU 0 goto :EOF
FOR /L %%N IN (0,1,18) DO (
if "!Num1:~%%N!" == "" goto :EOD
set Number=!Number!!Num1:~%%N,1!
if !Number! geq !Num2! (
  set /a quotient=!Number!/!Num2!
  set /a Number=!Number!-!quotient!*!Num2!
  if !Number! equ 0 set Number=
  set Num=!Num!!quotient!
) else (
  if defined Num set Num=!Num!0
)
)
:EOD
if not defined Num set Num=0
set %3=%Num%
goto :EOF 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2015-05-19T04:35:33.670

比通过 FOR 快 10 倍。具有能够使用 DIR 命令的任何允许参数（在本例中为 /S）的优势

```
@ECHO OFF

SET folder="C:\WINDOWS"

call:timer

ECHO Processing, please wait...

CALL :folderSize size %folder% "/S"

CALL :strNumDivide sizeKb %size% 1024
CALL :strNumDivide sizeMb %sizeKb% 1024
CALL :strNumDivide sizeGb %sizeMb% 1024

CALL :formatNumber size %size%
CALL :formatNumber sizeKb %sizeKb%
CALL :formatNumber sizeMb %sizeMb%
CALL :formatNumber sizeGb %sizeGb%

ECHO.
ECHO Size of %folder%: 
ECHO.

ECHO %size% bytes
ECHO %sizeKb% Kb
ECHO %sizeMb% Mb
ECHO %sizeGb% Gb
ECHO.

pause
exit /b

:: Function to calculate the size of a directory and its subdirectories
::----------------------------------------------------------------------
:folderSize <returnVariableName> <folder> [DIR parameters]
    SetLocal EnableExtensions EnableDelayedExpansion

    SET folder=%2
    SET params=%~3

    IF NOT DEFINED folder SET folder="%CD%"

    DIR %params% /W "%folder:"=%" > %TEMP%\folderSize.tmp

    FOR /F "tokens=1 delims=:" %%x IN ('findstr /n /e ":" %TEMP%\folderSize.tmp') DO (SET line=%%x)

    IF DEFINED line (

        SET /A line = !line! + 1

        FOR /F "tokens=4 delims= " %%i IN ('findstr /n "bytes" %TEMP%\folderSize.tmp^|findstr "!line!:"') DO (SET size=%%i)
        SET size=!size:.=!

    ) ELSE (

        FOR /F "tokens=3 delims= " %%i IN ('findstr /e "bytes" %TEMP%\folderSize.tmp') DO (SET size=%%i)
        SET size=!size:.=!

    )

    DEL %TEMP%\folderSize.tmp > nul

    EndLocal & SET "%~1=%size%"

GOTO:EOF

:: Extras functions to convert between different units and to give numerical format
:: --------------------------------------------------------------------------------
:strNumDivide <returnVariableName> <stringNum> <divisor>
    SetLocal EnableExtensions EnableDelayedExpansion 

    SET strNum=%~2
    SET divisor=%~3

    SET result=
    SET number=

    IF !divisor! EQU 0 GOTO:EOF

    FOR /L %%n IN (0,1,18) DO (
        IF NOT "!strNum:~%%n!" == "" (
            SET number=!number!!strNum:~%%n,1!

            IF !number! GEQ !divisor! (
                SET /A quotient=!number! / !divisor!
                SET /A number=!number! - !quotient! * !divisor!
                IF !number! EQU 0 SET number=
                SET result=!result!!quotient!
            ) ELSE (
                IF DEFINED result SET result=!result!0
            )
        )
    )

    IF NOT DEFINED result SET "result=0"
    EndLocal & SET "%~1=%result%"

GOTO:EOF

:formatNumber <returnVariableName> <number> [separator [group size]] 
    SetLocal EnableExtensions EnableDelayedExpansion 
    SET "raw=%~2"
    SET "separator=%~3" 
    SET "group=%~4" 
    SET "answer=" 
    IF NOT DEFINED raw GOTO :EOF
    IF NOT DEFINED separator SET "separator=."
    IF NOT DEFINED group SET "group=3"

    FOR %%g IN (-%group%) DO (
        FOR /F "tokens=1,2 delims=,." %%a IN ("%raw%") DO ( 
            SET int=%%a
            SET frac=%%b

            FOR /F "delims=:" %%c IN ('^(ECHO;!int!^& Echo.NEXT LINE^)^|FindStr /O "NEXT LINE"') DO (
                SET /A length=%%c-3
            ) 

            FOR %%c IN (!length!) DO ( 
                SET radix=!raw:~%%c,1!
            )

            FOR /L %%i IN (!length!, %%g, 1) DO ( 
                SET answer=!int:~%%g!!separator!!answer! 
                SET int=!int:~0,%%g!
            ) 
        ) 
    )
    SET answer=%answer: =%
    SET answer=%answer:~0,-1%

    EndLocal & SET "%~1=%answer%%radix%%frac%" 
Goto :EOF 
```

结果输出示例：（在示例中，例程用了 3 秒计算了大小为 28GB 的​​ C:\WINDOWS 的大小）

```
Processing, please wait...

Size of "C:\WINDOWS":

30.936.389.769 bytes
30.211.318 Kb
29.503 Mb
28 Gb

Elapsed Time: 3 secs 
```

# c# - 如何更改 XmlSchemaElement.SchemaType（或：SchemaType 和 ElementSchemaType 之间的区别）

> ID：759484
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T08:09:24.777
> 
>         
> 
> 标签：c#, .net, c#-3.0, xsd

我正在开发一个 XML 编辑器，它从相应的 XSD 文件中获取他的所有信息。要使用 XSD 文件，我使用 System.Xml.Schema 命名空间 (XmlSchema*)。由于 XML 中的“xsi:type”属性，我必须更改 XmlSchemaElement 的 XmlSchemaType。到目前为止，我在我的代码中使用了“XmlSchemaElement”的“ [ElementSchemaType](http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschemaelement.elementschematype.aspx) ”属性。它的好处是：**它是只读的**。

在“XmlSchemaElement”中还有一个“ [SchemaType](http://msdn.microsoft.com/en-us/library/system.xml.schema.xmlschemaelement.elementschematype.aspx) ”属性，它**不是只读**的，但始终为空（是的，XmlSchema 和 XmlSchemaSet 已编译）。

**那么如何更改“XmlSchemaElement”的类型呢？或者，同样的问题：这两个属性之间有什么区别？**

一些技术数据：C#、.NET 3.5

两者的 MSDN 文档几乎相同：

*SchemaType 文档：*

> 获取或设置元素的类型。这可以是复杂类型或简单类型。

*ElementSchemaType 文档：*

> 根据元素的 SchemaType 或 SchemaTypeName 值获取表示元素类型的 XmlSchemaType 对象。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:24:03.690

好的，我找到了反射的（坏）解决方案：

```
private static string XML_SCHEMA_ELEMENT_SET_ELEMENT_TYPE_MEMBER_NAME = "SetElementType";

public static void ChangeElementType(this XmlSchemaElement element, XmlSchemaType type)
{
        element.GetType().InvokeMember(XML_SCHEMA_ELEMENT_SET_ELEMENT_TYPE_MEMBER_NAME,
            BindingFlags.InvokeMethod | BindingFlags.NonPublic | BindingFlags.Instance,
            null, element, new object[] { type });
} 
```

我对 .NET Reflector 进行了分析，它们有两个属性，它们包含一个“XmlSchemaType”。一种不是只读的，用于 XML 序列化（它具有 Xml* 属性），另一种是只读的，我认为用于编译后使用 - 所以它或多或少是“静态”信息。这个伟大设计的好处是：您不能干净地读取 XSD，更改某些部分并再次保存它。好的，我不测试它，但这就是代码告诉我的。

所以这里是“XmlSchemaElement”有趣的源代码部分：

```
private XmlSchemaType elementType;
// ...
private XmlSchemaType type;
// ...
[XmlIgnore]
public XmlSchemaType ElementSchemaType
{
    get
    {
        return this.elementType;
    }
}
// ...
[XmlElement("complexType", typeof(XmlSchemaComplexType)), XmlElement("simpleType", typeof(XmlSchemaSimpleType))]
public XmlSchemaType SchemaType
{
    get
    {
        return this.type;
    }
    set
    {
        this.type = value;
    }
}
// ...
internal void SetElementType(XmlSchemaType value)
{
    this.elementType = value;
} 
```

# web-services - 如何连接到 CRM IFD Web 服务？

> ID：759500
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T08:20:35.780
> 
>         
> 
> 标签：web-services, dynamics-crm, dynamics-crm-4

我已从 SDK 中获取代码并仅进行了一项修改以设置身份验证类型，但当我尝试连接时，我收到“未经授权”错误。

我的代码是：

```
// Set up the CRM Service.
CrmAuthenticationToken token = new CrmAuthenticationToken();
token.AuthenticationType = 2;
token.OrganizationName = "TESTCRM";

CrmService service = new CrmService();
service.Url = "https://testcrm.ifdtestsystem.com/MSCrmServices/2007/CrmService.asmx";
service.CrmAuthenticationTokenValue = token;
//service.Credentials = System.Net.CredentialCache.DefaultCredentials;
service.Credentials = new NetworkCredential("Bill", "Password");

// Create an account entity and assign data to some attributes.
account newAccount = new account();
newAccount.name = "Greg Bike Store";
newAccount.accountnumber = "123456";
newAccount.address1_postalcode = "98052";
newAccount.address1_city = "Redmond";

// Call the Create method to create an account.
Guid accountId = service.Create(newAccount); 
```

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-23T18:40:18.020

使用 SPLA (IFD) 时，您还需要使用 crmticket 填充令牌。可以通过查询 CrmDiscoveryService 来检索票据。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-05-04T12:35:09.587

[本文档](http://msdn.microsoft.com/en-us/library/cc151010.aspx)包含如何使用 CrmDiscoveryService 获取票证并设置 CrmService 的合理示例。

请注意，将不再需要服务的 Credentials 属性，因为所有身份验证信息都将包含在票证中。

希望这可以帮助

# sql - SSD 驱动器的 TPC 或其他数据库基准

> ID：759501
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T08:20:52.707
> 
>         
> 
> 标签：sql, database, hardware, benchmarking, solid-state-drive

很长一段时间以来，我一直对 SSD 驱动器感兴趣。我在数据库方面做了很多工作，并且我一直很想找到使用和不使用 SSD 驱动器执行的基准测试，例如 TPC-H。

在外面听起来好像会有一个，但不幸的是我没能找到一个。我找到的最接近答案的是这篇博文中的第一条评论。

[http://dcsblog.burtongroup.com/data_center_strategies/2008/11/intels-enterprise-ssd-performance.html](http://dcsblog.burtongroup.com/data_center_strategies/2008/11/intels-enterprise-ssd-performance.html)

当谈到企业中的 SSD 技术时，写这篇文章的人似乎是一个相当大的反对者，因为声称在混合读/写工作负载下性能不足。

还有其他基准，例如 
[this](http://www.anandtech.com/storage/showdoc.aspx?i=3531&p=25)
和
[this](http://www.tomshardware.com/reviews/intel-x25-e-ssd,2158-5.html) 
，它们显示了绝对荒谬的数字。虽然我不怀疑他们，但我很好奇第一个链接中所说的评论者所说的是否属实。

无论如何，如果有人能找到在 SSD 上使用 DB 完成的基准测试，那就太好了。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T19:36:06.420

我已经测试和使用它们一段时间了，虽然我有自己的意见（非常积极），但我认为 Anandtech.com 的测试文档比我能写的任何东西都要好，看看你的想法；

[http://www.anandtech.com/show/2739](http://www.anandtech.com/show/2739)

问候，

菲尔。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-18T21:52:45.647

SSD 的问题在于，它们只有在模式被规范化为 3NF 或 5NF 时才真正有意义，从而删除“所有”冗余数据。将“速度非规范化”的混乱转移到 SSD 不会有成效，大量冗余数据将使 SSD 成本过高。  

对某些现有应用程序执行此操作意味着将现有表（引用）重新定义为视图，将规范化的表封装在幕后。引擎的 cpu 合成行有时间损失。原始模式越非规范化，重构和迁移到 SSD 的好处就越大。即使在 SSD 上，这些非规范化模式也会运行得更慢，这可能是由于必须检索和写入的大量数据。

未指示将日志放在 SSD 上；这是一个以顺序写入为主（正常情况下只写）操作，SSD（闪存类型；一家名为 Texas Memory Systems 的公司长期以来一直在构建基于 RAM 的子系统）的物理特性使得这一点没有被指出。适当缓冲的传统防锈驱动器会很好。

注意 anandtech 文章；英特尔驱动器是唯一正常工作的驱动器。到 2009 年底，这种情况可能会发生变化，但到目前为止，只有英特尔驱动器有资格被认真使用。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-09-15T14:30:59.907

我已经在 SSD 上运行一个相当大的 SQL2008 数据库 9 个月了。（600GB，超过 10 亿行，每秒 500 个事务）。我会说我测试过的大多数 SSD 驱动器对于这种用途来说都太慢了。但是，如果您使用高端英特尔，并仔细选择您的 RAID 配置，结果会很棒。我们说的是每秒 20,000 次以上的随机读/写。根据我的经验，如果你坚持使用 RAID1，你会得到最好的结果。我等不及英特尔推出 320GB 固态硬盘了！预计它们将于 2009 年 9 月上市……

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-18T05:57:42.900

正式的 TPC 基准测试使用 SSD 可能需要一段时间才能出现，因为 TPC 基准测试有两个部分 - 速度（每单位时间的事务）和每单位成本（每单位时间的事务）。随着 SSD 的高速化，您必须将 DB 的大小扩展得更大，从而使用更多的 SSD，从而成本更高。因此，即使您可能会获得极好的速度，但对于完全扩展的（可审计的、可发布的）TPC 基准测试来说，成本仍然是令人望而却步的。这将在一段时间内保持不变，就像几年后一样，而 SSD 比相应数量的旋转磁盘更昂贵。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-06-29T20:32:07.963

评论：

“......非常有兴趣找到使用和不使用 SSD 驱动器执行的基准测试，例如 TPC-H。”

（仅供参考并充分披露，我是化名“J Scouter”，上面提到并链接的“企业中 SSD 技术的相当大的反对者”。）

所以....这是出现的第一个线索。

戴尔和 Fusion-IO 发布了第一个使用闪存设备进行存储的经过审核的基准测试。

基准是 TPC-H，它是一个“决策支持”基准。这一点很重要，因为 TPC-H 需要一种几乎完全“只读”的工作负载模式——SSD 的完美环境，因为它完全避免了写入性能问题。

在 Flash SSD 狂热者为我们描绘的场景中，这个应用程序代表了一个软音调、一个轻柔的高球，以及一个简单的 Flash-SSD 数据库应用程序的“本垒打”。

结果？基于闪存 SSD 的数据库应用程序的第一个经过审核的基准测试，以及一个只读的基准测试，结果（此处是鼓声）......在测试的可比 (100GB) 系统中排名第五。

这个闪存 SSD 系统每小时产生的查询量大约是 Sun 2007 年发布的基于磁盘的系统结果的 30%。

当然，尽管这款基于 Flash 的系统会在性价比方面获胜，对吧？

Dell/Fusion-IO 系统以每小时每查询 1.46 美元的价格排在第三位。成本/性能最佳的基于磁盘的系统的每小时查询成本的两倍以上。

再次记住，这是针对 TPC-H 的，它是一个几乎“只读”的应用程序。

这与 MS Cambridge 研究团队一年多前的发现几乎完全一致——从经济或能源的角度来看，没有任何企业工作负载可以让 Flash 产生 ROI

迫不及待地想看到 TPC-C、TPC-E 或 SPC-1，但根据上面链接的研究论文，SSD 需要变得便宜几个数量级才能让它们在企业应用程序中有意义.

# c++ - C++ 中的内部 typedef - 好风格还是坏风格？

> ID：759512
> 
>         
> 
> 赞同：190
> 
>         
> 
> 时间：2009-04-17T08:25:08.953
> 
>         
> 
> 标签：c++, coding-style, typedef

我最近发现自己经常做的事情是声明与该类中的特定类相关的 typedef，即

```
class Lorem
{
    typedef boost::shared_ptr<Lorem> ptr;
    typedef std::vector<Lorem::ptr>  vector;

//
// ...
//
}; 
```

然后在代码的其他地方使用这些类型：

```
Lorem::vector lorems;
Lorem::ptr    lorem( new Lorem() );

lorems.push_back( lorem ); 
```

我喜欢它的原因：

*   它减少了类模板引入的噪音，`std::vector<Lorem>`变得`Lorem::vector`等。

*   它用作意图声明 - 在上面的示例中，Lorem 类旨在通过引用计数`boost::shared_ptr`并存储在向量中。

*   它允许更改实现——即，如果 Lorem 需要`boost::intrusive_ptr`在稍后阶段更改为侵入式引用计数（通过），那么这将对代码的影响最小。

*   我认为它看起来“更漂亮”，并且可以说更容易阅读。

不喜欢的理由：

*   依赖项有时会出现问题 - 如果你想嵌入，比如说，`Lorem::vector`在另一个类中，但只需要（或想要）转发声明 Lorem（而不是在其头文件中引入依赖项），那么你最终不得不使用显式类型（例如，`boost::shared_ptr<Lorem>`而不是`Lorem::ptr`），这有点不一致。

*   它可能不是很常见，因此更难理解？

我试图对我的编码风格保持客观，所以最好能得到一些其他的意见，这样我就可以稍微剖析一下我的想法。

* * *

## 回答 #1

> 赞同：166
> 
>             
> 
> 时间：2009-04-17T08:31:03.307

我认为它是优秀的风格，我自己使用它。尽可能地限制名称的范围总是最好的，而使用类是在 C++ 中做到这一点的最佳方式。例如，C++ 标准库在类中大量使用 typedef。

* * *

## 回答 #2

> 赞同：13
> 
>             
> 
> 时间：2010-01-05T13:33:54.597

> 它用作意图声明 - 在上面的示例中，Lorem 类旨在通过 boost::shared_ptr 进行引用计数并存储在向量中。

这正是它*没有*做的事情。

如果我在代码中看到 'Foo::Ptr'，我完全不知道它是 shared_ptr 还是 Foo*（STL 的 ::pointer typedefs 是 T*，请记住）或其他什么。*特别是。*如果它是共享指针，我根本不提供 typedef，而是在代码中明确使用 shared_ptr。

实际上，我几乎从不在模板元编程之外使用 typedef。

> STL 一直在做这种事情

具有根据成员函数和嵌套 typedef 定义概念的 STL 设计是一个历史性的死胡同，现代模板库使用自由函数和特征类（参见 Boost.Graph），因为这些不排除内置类型对概念进行建模，并且因为它可以更容易地调整不是根据给定模板库的概念设计的类型。

不要以 STL 作为犯同样错误的理由。

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2009-04-17T08:44:36.580

Typedef 是C++ 中[基于策略的设计和特征](http://www.boost.org/community/generic_programming.html#traits)所基于的，因此 C++ 中泛型编程的力量源于 typedef 本身。  

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T08:35:36.913

Typdefs 绝对是很好的风格。你所有的“我喜欢的理由”都是好的和正确的。

关于你遇到的问题。好吧，前向声明不是圣杯。你可以简单地设计你的代码来避免多层次的依赖。

您可以将 typedef 移到类之外，但是 Class::ptr 比 ClassPtr 漂亮得多，所以我不这样做。就像我的命名空间一样 - 事物在范围内保持连接。  

有时我做到了

```
Trait<Loren>::ptr
Trait<Loren>::collection
Trait<Loren>::map 
```

它可以是所有域类的默认值，并且可以对某些域类进行一些专门化。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T08:36:43.527

STL 一直在做这种类型的事情——typedef 是 STL 中许多类的接口的一部分。

```
reference
iterator
size_type
value_type
etc... 
```

都是类型定义，它们是各种 STL 模板类的接口的一部分。

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T14:13:54.730

这是一个好主意的另一票。我在编写一个在时间和空间上都必须高效的模拟时开始这样做。所有的值类型都有一个 Ptr typedef，它最初是一个 boost 共享指针。然后我进行了一些分析并将其中一些更改为 boost 侵入式指针，而无需更改使用这些对象的任何代码。  

请注意，这仅在您知道将在何处使用类并且所有用途都具有相同要求时才有效。例如，我不会在库代码中使用它，因为您在编写库时无法知道将在其中使用它的上下文。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2014-01-18T08:28:57.630

目前我正在编写代码，它大量使用这些类型定义。到目前为止，这很好。

但是我注意到经常有迭代的 typedef，定义被分成几个类，你永远不知道你在处理什么类型。我的任务是总结隐藏在这些 typedef 后面的一些复杂数据结构的大小——所以我不能依赖现有的接口。结合三到六级嵌套命名空间，然后就变得混乱了。

所以在使用它们之前，有几点需要考虑

*   还有其他人需要这些类型定义吗？该课程是否被其他课程大量使用？

*   我是缩短使用时间还是隐藏课程？（在隐藏的情况下，您也可以考虑接口。）

*   其他人是否在使用该代码？他们是如何做到的呢？他们会认为这更容易还是会感到困惑？

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T08:31:08.937

当 typedef 仅在类本身中使用（即被声明为私有）时，我认为这是一个好主意。但是，由于您给出的确切原因，如果 typedef 需要在课堂之外知道，我不会使用它。在这种情况下，我建议将它们移到课堂外。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:28:24.653

我建议将这些 typedef 移到课堂之外。这样，您就可以消除对共享指针和向量类的直接依赖，并且仅在需要时才可以包含它们。除非您在类实现中使用这些类型，否则我认为它们不应该是内部类型定义。

你喜欢它的原因仍然是匹配的，因为它们是通过 typedef 的类型别名来解决的，而不是通过在你的类中声明它们。

# c# - C# 在 MVC 中集中重复 VIewData

> ID：759519
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-17T08:27:13.800
> 
>         
> 
> 标签：c#, asp.net-mvc, viewdata

当用户登录我的应用程序时，我想在整个应用程序中显示他的名字。我正在使用 asp.net MVC 框架。但我不想要的是必须在每个控制器中放入类似的东西：

```
ViewData["User"] = Session["User"]; 
```

这是因为您可能不会重复自己。（我相信这是 OO 编程的 DRY [Don't Repeat Yourself] 原则。） ViewData["User"] 在我的主页上。所以我的问题是，在一个地方处理我的 ViewData["User"] 的巧妙方法是什么？

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-04-17T08:29:28.893

您可以在控制器基类或应用于控制器/动作的动作过滤器中相当容易地做到这一点。无论哪种情况，您都有机会在操作之前（或之后）触摸请求 - 因此您可以在此处添加此功能。

例如：

```
public class UserInfoAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(
        ActionExecutingContext filterContext)
    {
        base.OnActionExecuting(filterContext);
        filterContext.Controller.ViewData["user"] = "Foo";
    }
}
...
[HandleError, UserInfo]
public class HomeController : Controller
{...} 
```

（也可以在*动作*（方法）级别使用）

* * *

或具有共同的基类：

```
public abstract class ControllerBase : Controller
{
    protected override void OnActionExecuting(
        ActionExecutingContext filterContext)
    {
        ViewData["user"] = "Bar";
        base.OnActionExecuting(filterContext);
    }
}

[HandleError]
public class HomeController : ControllerBase
{...} 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2010-05-04T09:07:18.427

已经一年了，但我刚刚偶然发现了这个问题，我相信有一个更好的答案。

Jimmy Bogard 将接受的答案中描述的解决方案描述为反模式，并提供了一个更好的解决方案，包括`RenderAction`：[http ://www.lostechies.com/blogs/jimmy_bogard/archive/2009/06/18/the-filter-viewdata-反模式.aspx](http://www.lostechies.com/blogs/jimmy_bogard/archive/2009/06/18/the-filter-viewdata-anti-pattern.aspx)

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T08:40:41.880

使用 UserName 属性为您的模型创建一个基类：

```
public abstract class ModelBase
{
    public string UserName { get; set; }
} 
```

为您的控制器创建一个基类并覆盖它的 OnActionExecuted 方法。在其中检查模型是否派生自 BaseModel，如果是，则设置它的 UserName 属性。

```
public class ControllerBase : Controller
{
    protected override void OnActionExecuted(
        ActionExecutedContext filterContext)
    {
        var modelBase = ViewData.Model as ModelBase;

        if (modelBase != null)
        {
            modelBase.UserName = "foo";
        }

        base.OnActionExecuted(filterContext);
    }
} 
```

然后您将能够在视图中显示用户的用户名，如下所示：

```
<%= Html.Encode(Model.UserName) %> 
```

**另见**：

*   [ASP.NET MVC 最佳实践、提示和技巧](https://stackoverflow.com/questions/709429/asp-net-mvc-best-practices-tips-and-tricks)

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2011-12-16T21:42:48.423

在整个应用程序中提供持久模型数据的另一种方法是用您的自定义控制器覆盖 DefaultFactoryController。在您的 CustomerFactoryController 中，您可以将 ViewBag 与您想要保留的模型相结合。  

# iphone - iPhone / Objective C 嵌套 C 结构

> ID：759524
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T08:28:12.143
> 
>         
> 
> 标签：iphone, objective-c, data-structures, nested

有人可以确认目标 C 中不允许嵌套 C 结构吗？

通过嵌套结构，我的意思是：

```
struct Tex2D
{
    GLfloat u;
    GLfloat v;
};

// quad uv cords
struct TexQuad
{
    Tex2D   uv[4];
}; 
```

我似乎在编译这个时遇到了各种各样的问题。很难找到任何关于此的文档，因为这是完全有效的 c 代码。

干杯丰富

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-04-17T08:36:00.377

您所拥有的不是有效的 C 代码。请记住，在 C 中，当您声明一个结构变量时，您必须将其显式引用为结构，如下所示：

```
struct StructType myStruct; 
```

我见过的最常见的解决方法是将结构声明与 typedef 捆绑在一起，如下所示：

```
typedef struct _Tex2D
{
    GLfloat     u;
    GLfloat     v;
} Tex2D;

// quad uv cords
typedef struct _TexQuad
{
    Tex2D       uv[4];
} TexQuad; 
```

这样，您就可以创建新的结构变量而无需使用`struct`关键字。

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T08:33:30.727

就像在 C 中一样，在引用结构时必须使用关键字 struct。:-)

```
// quad uv cords
struct TexQuad
{
    struct Tex2D       uv[4];
}; 
```

作品！

# c# - 通用列表/字典

> ID：759525
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-17T08:28:18.930
> 
>         
> 
> 标签：c#, generics

我正在尝试通过反射输出对象图。其中有几种通用类型（列表、字典）。我不知道它们包含的类型（字符串、对象等），但想列出它们（使用 .ToString()）。

那么，有没有办法以通用方式输出通用列表/字典，这意味着无需为每个键 <-> 值组合编写重载函数？

我认为 .NET 4.0 将是可能的，但目前还没有。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T08:40:40.693

如果您使用反射，泛型会变得非常棘手。你能简单地使用非通用接口吗？`IDictionary`/ `IList`? 这会容易得多......就像**：**

```
static void Write(object obj) {
    if (obj == null) { }
    else if (obj is IDictionary) { Write((IDictionary)obj); }
    else if (obj is IList) { Write((IList)obj); }
    else { Console.WriteLine(obj); }
}
static void Write(IList data) {
    foreach (object obj in data) {
        Console.WriteLine(obj);
    }
}
static void Write(IDictionary data) {
    foreach (DictionaryEntry entry in data) {
        Console.WriteLine(entry.Key + "=" + entry.Value);
    }
} 
```

# .net - 使用 WPF，如何根据子 TextBlock 的内容折叠 TextBlock？

> ID：759528
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T08:28:58.130
> 
>         
> 
> 标签：.net, wpf, data-binding, .net-3.5

我必须显示一大堆属性/值。我的问题是所有这些属性都没有值，所以我不想在这种情况下显示这些。

使用一些代码会更容易理解我的问题：

```
<StackPanel DataContext=...>
<TextBlock>Info1:<TextBlock Text={Binding Path=Info1} /></TextBlock>
<TextBlock>Info2:<TextBlock Text={Binding Path=Info2} /></TextBlock>
<TextBlock>Info3:<TextBlock Text={Binding Path=Info3} /></TextBlock>
</StackPanel> 
```

基本上，根据子TextBlock的内容，我想折叠父TextBlock。我的想法是使用适用于所有 TextBlock 的样式并检查内容，如果没有，则折叠父级...不幸的是，我无法从 DataTrigger 访问父级。可能你会有一个比这更简洁的解决方案:)

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:55:35.397

您可以使用简单的转换器将外部文本块的可见性绑定到内部文本块的文本：

```
<TextBlock Name="outer1" 
           Visibility="{Binding ElementName=inner1, Path=Text, Converter={StaticResource MyConverter}}">
    Info1:<TextBlock Name="inner1" Text="{Binding Path=Info1}" />
</TextBlock> 
```

或将外部文本块的可见性直接绑定到 Info1：

```
 <TextBlock Visibility="{Binding Path=Info1, Converter={StaticResource MyConverter}}">
    Info1:<TextBlock Text="{Binding Path=Info1}" />
</TextBlock> 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-12-14T15:41:18.343

如果您在模板或样式中，则可以使用触发器来设置外部文本块的可见性。

例如，在[DataTemplate](http://msdn.microsoft.com/en-us/library/ms742521.aspx)的情况下：

```
<DataTemplate.Triggers>
    <DataTrigger Binding="{Binding Path=Info1}" Value="">
        <Setter Property="Visibility" TargetName="pnlInfo1" Value="Hidden" />
    </DataTrigger>
    <!-- and so on ... -->
</DataTemplate.Triggers> 
```

根据您的需要调整触发器。例如，您可以隐藏它，`null`或者使用 gcores 建议的转换器来进行更多花哨的检查。

# c# - Subsonic 3 - 隐藏的命名空间 - 可能是我

> ID：759535
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T08:30:54.787
> 
>         
> 
> 标签：c#, vb.net, subsonic, namespaces, subsonic3

今天是星期五，所以我很可能在这里做一些愚蠢的事情。事实上，我会花钱买它。

我正在玩 Subsonic - 很高兴地进入 v2.2，但对 v3 alpha 很感兴趣

跟着 Rob 的网络直播，照他做的，看着 T4 生成代码，去使用新的命名空间，哦。没有命名空间。

*我可以在每个生成的 .cs 文件中看到命名空间 Test.Data ， tt 文件和subsonic.dll*一样包含在项目中，没有错误（我设法摆脱了重复指令的警告）但是我只是看不到命名空间。

为了测试它，我正在构建一个简单的*vb.net*控制台应用程序，所以想知道那里是否存在冲突。对同一个数据库使用 v2.2 可以正常工作。

准备好让你指点和笑。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T10:07:01.577

是的，正如我想的那样，我是星期五的 n00b。

直到现在才意识到除了 asp.net 项目之外，您不能让 vb.net 和 c# 代码共存。

将拆分为单独的程序集并从那里开始。

“这里没什么可看的，请走吧……”

周末愉快。

埃德

# asp.net - asp.net server.execute

> ID：759543
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T08:32:47.327
> 
>         
> 
> 标签：asp.net

我正在使用 server.execute 调用另一个表单我的代码看起来像这样

```
<div>
<% server.execute("default2.aspx") %>
</div> 
```

我的问题是 default2.aspx 的大小更大，所以当我将高度应用于 div 时，default2.aspx 与默认页面中的其他内容重叠

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:40:37.340

不是设置高度的选项吗？通常，如果未设置高度，则默认为“自动”

您还可以使用：

```
div
{
height:500px;
overflow: auto;
} 
```

如果内容对于该区域来说太大，将出现一个滚动条。

使用您的代码：

```
<div style="height:500px;overflow: auto;">
<% server.execute("default2.aspx") %>
</div> 
```

# c# - 使用 DataGridView 中的 DateTime 列计算总小时数

> ID：759551
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T08:35:17.633
> 
>         
> 
> 标签：c#, datetime, datagridview

我在 datagridview 中的每一行都需要进行计算。我想要的是遍历具有两列日期时间的datagridview中的所有行。一个代表 LogInTime，一个代表 LogOutTime。我想获取数据网格视图中显示的行的所有登录时间和注销时间之间的总小时数和分钟数。关于如何实现这一点的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:47:39.210

您的 DataGridView 绑定到什么？使用 Linq 表达式或 DataTable.Compute() 调用在后面的代码上更容易进行这样的计算。

一个示例 Linq 表达式：

```
var minutes = listOfLogins.Sum(l => l.LogOutTime.Subtract(l.LoginTime).TotalMinutes);
Console.WriteLine("{0}h, {1}m", (int)(minutes / 60), minutes % 60); 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:51:51.710

您可以从另一个日期中减去一个日期以获得一个 TimeSpan 单位，该单位将为您提供所需的数据。

您需要在源数据中进行计算，或者在行数据绑定事件中获取数据并进行计算。

# haskell - {2n+3m+1|n,m∈N} 如何以列表理解的形式表达？（N是包括0的自然数集）

> ID：759554
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T08:35:34.807
> 
>         
> 
> 标签：haskell, list-comprehension

如何以列表理解形式表达 {2n+3m+1|n,m∈N}？N是自然数的集合，包括0。

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-04-17T09:14:45.573

不久：

```
1:[3..] 
```

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-04-17T08:44:30.327

不是 {2n+3m+1|n,m ∈ ℕ} = ℕ - {0,2} 吗？

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-04-18T03:09:28.687

以下 Haskell 函数将为您提供两个列表中的所有对，即使其中一个或两个是无限的。每对只出现一次：

```
allPairs :: [a] -> [b] -> [(a, b)]
allPairs _ [] = []
allPairs [] _ = []
allPairs (a:as) (b:bs) = 
   (a, b) : ([(a, b) | b <- bs] `merge` 
             [(a, b) | a <- as] `merge` 
             allPairs as bs)
  where merge (x:xs) l = x : merge l xs
        merge []     l = l 
```

然后你可以把你的清单写成    

```
[2 * n + 3 * m + 1 | (n,m) <- allPairs [0..] [0..] ] 
```

要了解它的工作原理，请绘制一个无限的四分之一平面，然后查看结果

```
take 100 $ allPairs [0..] [0..] 
```

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T17:38:20.417

`[2*n + 3*m +1 | m <- [0..], n <- [0..]]`不会工作，因为它从所有的 开始`m = 0`并经过`n`，然后有`m = 1`并经过所有的 n 等。但只是`m = 0`部分是无限的，所以你永远不会到达 m = 1 或 2 或 3 等。所以`[2*n + 3*m +1 | m <- [0..], n <- [0..]]`与 完全相同`[2*n + 3*0 +1 | n <- [0..]]`。

要生成所有这些，您要么需要像用户 vartec 和 Hynek -Pichi- Vychodil 一样意识到，您想要的数字集只是自然数 - {0,2}。或者您需要以某种方式枚举所有对 (m,n) 以使 m,n 为非负数。一种方法是沿着每个相同的“对角线”走`m + n`。所以我们从 where 的数字开始`m + n = 0`，然后是 where的数字`m + n = 1`，等等。这些对角线中的每一个都有有限数量的对，所以你总是会继续下一个，所有对 (m,n) 最终将是算了。

如果我们让`i = m + n`and `j = m`，则`[(m, n) | m <- [0..], n <- [0..]]`变为`[(j, i - j) | i <- [0..], j <- [0..i]]`

所以对你来说，你可以做

```
[2*(i-j) + 3*j +1 | i <- [0..], j <- [0..i]] 
```

（当然，此方法也会为您生成重复项，因为有多个 (m,n) 对在您的表达式中生成相同的数字。）

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-19T20:41:24.547

您可以尝试枚举所有整数对。此代码基于[加州大学伯克利分校](http://www.cs.berkeley.edu/~wkahan/Math55/pairs.ps)描述的枚举（不包括 0）

```
data Pair=Pair Int Int deriving Show

instance Enum Pair where
    toEnum n=let l k=truncate (1/2 + sqrt(2.0*fromIntegral k-1))
                 m k=k-(l k-1)*(l k) `div` 2
             in 
               Pair (m n) (1+(l n)-(m n))
    fromEnum (Pair x y)=x+((x+y-1)*(x+y-2)) `div` 2 
```

但是您可以使用另一个枚举。

然后你可以这样做：

```
[2*n+3*m+1|Pair n m<-map toEnum [1..]] 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-12-24T23:37:12.310

我的 0.2：

```
trans = concat [ f n | n <- [1..]]
 where 
  mklst x = (\(a,b) -> a++b).unzip.(take x).repeat
  f n | n `mod` 2 == 0 = r:(mklst n (u,l))
      | otherwise      = u:(mklst n (r,d))
  u = \(a,b)->(a,b+1)
  d = \(a,b)->(a,b-1)
  l = \(a,b)->(a-1,b)
  r = \(a,b)->(a+1,b)

mkpairs acc (f:fs) = acc':mkpairs acc' fs
                  where acc' = f acc
allpairs = (0,0):mkpairs (0,0) trans          
result = [2*n + 3*m + 1 | (n,m) <- allpairs] 
```

# sql-server - SQL Server Stored Proc 的运行时间比在 Management Studio 中从文本执行的相同查询要长得多

> ID：759559
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-04-17T08:36:05.010
> 
>         
> 
> 标签：sql-server, sql-server-2005

所以这里有点奇怪......我有一个需要 40 秒才能运行的存储过程。我将存储过程的内容复制到一个新的查询窗口，更改 2 个输入参数（它们都是日期），以便声明和设置它们，然后运行查询。它基本上是即时的，不到 1 秒的执行。唯一的区别是存储过程将 2 个日期作为参数。

任何人都知道什么可以做到这一点？

（我正在运行 SQL Server 2005）

* * *

## 回答 #1

> 赞同：14
> 
>             
> 
> 时间：2009-04-17T08:43:42.823

重新编译会嗅探参数，因此不会有任何区别。

[这篇文章解释了我的说法](http://www.microsoft.com/technet/prodtechnol/sql/2005/recomp.mspx#E6TAE)......

> ...参数值在编译或重新编译期间被嗅探...

您需要屏蔽参数：

```
ALTER PROCEDURE [uspFoo]
    @Date1 datetime,
    @Date2 datetime
AS
BEGIN
    DECLARE @IDate1 datetime, @IDate2 datetime;
    SELECT @IDate1 = @Date1, @IDate2 = @Date2;
    -- Stuff here that depends on @IDate1 and @IDate2
END 
```

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2013-10-23T13:25:37.560

正如 gbn 所说，这是一个参数嗅探问题。他建议的另一种方法是在查询末尾包含以下行：

```
OPTION (RECOMPILE) 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:59:12.067

运行探查器并捕获执行的查询计划。检查以查看差异是什么 - 您可能能够调整查询或强制执行特定计划。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2012-08-06T21:51:03.570

我有一个类似的问题，发现它是因为我将参数设置为 DATE 但在 WHERE 子句中与之比较的列在 DATETIME 中，所以就像 SSMS 正在转换它的每一行的数据类型比较。将参数数据类型更改为 DATETIME 或如上所述屏蔽参数可解决此问题。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2021-08-23T18:28:43.423

有同样的问题，我试图解决参数嗅探，也使用了重新编译选项，但对我不起作用..然后知道在更新查询中添加 ASSUME_MIN_SELECTIVITY_FOR_FILTER_ESTIMATES 可以解决我的问题..

# javascript - 可以在 Js 小部件中使用 Jquery 以插入到其他站点

> ID：759563
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T08:37:45.147
> 
>         
> 
> 标签：javascript, jquery

如果我想在我的网站上提供一个其他人可以在他们的网页上插入的小部件，请通过：

我可以在该文件中导入和使用 Jquery，以便用户无需手动将其添加到他的页面。

我该怎么做？（我也是 Javascript 新手）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:43:56.427

您可以进行简单的复制和粘贴（即，将 jQuery 文件中的代码复制到您自己的 JavaScript 文件中）。

但是，如果您想将文件分开，您可以将 jQuery 脚本添加到 DOM，如下所示：

```
var script = document.createElement("script");
script.src = "path/to/jQuery.js";
document.getElementsByTagName("head")[0].appendChild(script); 
```

史蒂夫

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2012-07-26T15:03:41.170

这是关于该主题的精彩帖子：http: [//alexmarandon.com/articles/web_widget_jquery/](http://alexmarandon.com/articles/web_widget_jquery/)

# c# - MVC 中的 C# 句柄 GUI

> ID：759564
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T08:38:17.080
> 
>         
> 
> 标签：c#, asp.net-mvc, panel

我正在使用 asp.net MVC 框架。在我的应用程序中，用户必须登录。当用户名和密码的组合正确时，带有菜单的 div（或面板？）必须变得可见。但是我该怎么做呢？当我的面板 pnlMenu 命名时，在我的控制器中我不能执行以下操作：

```
pnlMenu.visible = true; 
```

那么，我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-18T02:06:35.420

您应该做的是在您的控制器中检查用户是否已登录并在 ViewData 中设置一个值，如下所示：

```
ViewData["IsLoggedIn"] = true; 
```

然后在您的视图中，您可以根据此值设置方法的可见性。这样，如果您稍后更改视图，或者决定拥有多个视图，它们每个都可以使用该值，并且您的视图和控制器之间没有任何耦合。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T08:41:48.740

在您的视图上创建一个方法或属性，使您能够隐藏或显示适当的控件？

然后，在您的控制器中，您可以访问视图的该属性或方法，不是吗？

您不想在控制器中的视图上引用特定的“控件”，因为 MVC 的一个想法是您可以将 UI 替换为另一个实现（web / win / ...）并利用相同的控制器和应用程序逻辑。然后，您只想描述您的视图应该支持的操作，因此，在描述您的视图必须支持的“合同”的界面中，您应该创建一个名为“ChangeState(bool loggedIn)”的方法。

在控制器中，您可以在用户登录后调用此方法。

# visual-studio - 我的 Visual Studio 将所有整数、长变量值作为十六进制

> ID：759565
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-04-17T08:38:43.177
> 
>         
> 
> 标签：visual-studio, visual-studio-2005

我的 Visual Studio 2005 有一个问题。我初始化了一个整数变量并将调试器附加到它以在运行时检查它的值。当我运行应用程序时，它显示的变量值是十六进制的，相当于初始化的值。

如何将其更改为以十进制显示？

谢谢

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-04-17T08:40:47.323

右键单击该值（例如在“Locals”面板中）并取消选中“Hexadecimal Display”。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2009-04-17T08:41:21.127

右键单击查看器中的值，选择标有“十六进制显示”的菜单项，然后取消选中标记。

# python - 如何使文本换行匹配vim中的当前缩进级别？

> ID：759577
> 
>         
> 
> 赞同：13
> 
>         
> 
> 时间：2009-04-17T08:41:31.283
> 
>         
> 
> 标签：python, vim, word-wrap

有谁知道让 vim 换行长文本行的方法，这样换行文本的位置基于当前行的缩进？我不想重新格式化我的代码，只是为了让它漂亮地显示。

例如，如果我设置我的设置，以便该行：

```
print 'ProcessorError(%r, %r, %r)' % (self.file, self.index, self.message) 
```

包装为：

```
print 'ProcessorError(%r, %r, %r)' % (self.file, self.index,
    self.message) 
```

那么如果我写一个这样的代码块：

```
 def __repr__(self):
        return 'ProcessorError(%r, %r, %r)' % (self.file, self.index, self.message) 
```

它包装成这样的：

```
 def __repr__(self):
        return 'ProcessorError(%r, %r, %r)' % (self.file, self.index,
    self.message) 
```

我希望它显示为：

```
 def __repr__(self):
        return 'ProcessorError(%r, %r, %r)' % (self.file, self.index,
            self.message) 
```

**编辑：**阅读 Don Werve 的回复后，似乎我确实在寻找该`breakindent`选项，但该选项仍在“等待更新的补丁”列表中（请参阅[Vim TODO](http://vimdoc.sourceforge.net/htmldoc/todo.html)）。所以我想知道让 vim 工作的*最简单方法*`breakindent`是什么？（我不在乎我必须使用什么版本的 vim。）

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-11-20T17:21:46.427

我[在 SuperUser 上问了同样的问题](https://superuser.com/questions/72714/vim-line-wrap-with-indent)，最终找到了这个问题，找到了补丁，并[更新了补丁](https://retracile.net/blog/2009/11/20/12.00)以与 Fedora 11 中的 Vim 7.2.148 一起使用。

您可以使用`yumdownloader --source vim`来获取源 RPM。然后在spec文件中添加`Patch3312:`一行`%patch3012 -p1`一行，构建rpm。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T15:38:33.137

您正在寻找`breakindent`

您可能还想参考[这个线程](http://newsgroups.derkeiler.com/Archive/Comp/comp.editors/2005-07/msg00056.html)。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-18T06:37:56.673

我推荐这个 vimscript：

[http://www.vim.org/scripts/script.php?script_id=974](http://www.vim.org/scripts/script.php?script_id=974)

“这个 python 的缩进脚本试图更接近 PEP 8 ( [http://www.python.org/peps/pep-0008.html](http://www.python.org/peps/pep-0008.html) ) 中的建议。特别是，它处理由 open (括号) 暗示的延续线, [braces] 和 {braces} 正确，并且它以不同的方式缩进多行 if/for/while 语句。”

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-18T07:16:01.700

有关控制 Python 代码的缩进，请参阅`:h ft-python-indent`。`shiftwidth`例如，如果您在有一个未闭合的括号时执行换行符，这将使 Vim 缩进两次：

```
let g:pyindent_open_paren = '&sw * 2' 
```

但是`&sw * 2`是默认设置，所以不确定为什么它不适合您。它适用于手动换行符或`textwidth`诱导换行符。

`.vimrc`在 Vim 进入 Python 模式之前，上述设置需要或需要以某种方式设置。确保`:setf python`或您处于 Python 模式。

* * *

## 回答 #5

> 赞同：-1
> 
>             
> 
> 时间：2009-04-17T08:44:05.317

我认为 set textwidth=80 应该这样做。

# sql - 如何在 MySQL 中实现关键字搜索？

> ID：759580
> 
>         
> 
> 赞同：40
> 
>         
> 
> 时间：2009-04-17T08:43:36.817
> 
>         
> 
> 标签：sql, mysql, search

我是 SQL 编程新手。

我有一个表格作业，其中的字段是`id`, `position`, `category`, `location`, `salary range`, `description`, `refno`.

我想从前端实现**关键字搜索。**关键字可以驻留在上表的任何字段中。

这是我尝试过的查询，但它包含很多重复的行：

```
SELECT
    a.*,
    b.catname
FROM
    job a,
    category b
WHERE
    a.catid = b.catid AND
    a.jobsalrange = '15001-20000' AND
    a.jobloc = 'Berkshire' AND
    a.jobpos LIKE '%sales%' OR
    a.jobloc LIKE '%sales%' OR
    a.jobsal LIKE '%sales%' OR
    a.jobref LIKE '%sales%' OR
    a.jobemail LIKE '%sales%' OR
    a.jobsalrange LIKE '%sales%' OR
    b.catname LIKE '%sales%' 
```

* * *

## 回答 #1

> 赞同：57
> 
>             
> 
> 时间：2009-04-17T08:48:56.523

对于 VARCHAR 字段上的单个关键字，您可以使用[`LIKE`](http://dev.mysql.com/doc/refman/5.0/en/string-comparison-functions.html)：

```
SELECT id, category, location
FROM table
WHERE
(
    category LIKE '%keyword%'
    OR location LIKE '%keyword%'
) 
```

对于描述，您通常最好添加全文索引并进行[全文搜索](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)（仅限 MyISAM）：

```
SELECT id, description
FROM table
WHERE MATCH (description) AGAINST('keyword1 keyword2') 
```

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T08:50:56.427

```
SELECT 
    *
FROM 
    yourtable
WHERE 
    id LIKE '%keyword%' 
    OR position LIKE '%keyword%'
    OR category LIKE '%keyword%'
    OR location LIKE '%keyword%'
    OR description LIKE '%keyword%'
    OR refno LIKE '%keyword%'; 
```

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T08:47:59.223

理想情况下，有一个包含以下字段的关键字表：

```
Keyword
Id
Count (possibly) 
```

带有关键字索引。在另一个表上创建一个插入/更新/删除触发器，以便在更改行时，提取每个关键字并将其放入（或替换）该表中。

您还需要一个不计为关键字的单词表（if、and、so、but、...）。

通过这种方式，您将获得想要查找关键字的查询的最佳速度，并且您可以（相对容易地）实现更复杂的查询，例如“包含 Java 和 RCA1802”。

`"LIKE"`查询将起作用，但它们也不会扩展。

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T09:12:03.050

就个人而言，我不会`LIKE`在 ID 字段或任何其他数字字段上使用字符串比较。搜索 ID#“ **216** ”返回 16 **216**、**216** 51、3 **216** 087、53 **216** 68... 等是没有意义的；工资也一样。

此外，如果您想使用准备好的语句来防止 SQL 注入，您可以使用如下查询字符串：

```
SELECT * FROM job WHERE `position` LIKE CONCAT('%', ? ,'%') OR ... 
```

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2013-02-26T12:54:38.317

我将解释我通常喜欢的方法：

首先，您需要考虑到，对于这种方法，您将牺牲内存以提高计算速度。其次，您需要具有编辑表结构的权限。

1）添加一个字段（我通常称之为“摘要”），您可以在其中存储表中的所有数据。

该字段将如下所示：

**“n-n1-n2-n3-n4-n5-n6-n7-n8-n9”等..**  其中 n 是一个单词

我使用正则表达式 thar 将“”替换为“-”来实现这一点。该字段是所有表数据“消化”在一个字符串中的结果。

2) 在摘要字段上使用 LIKE 语句 %keyword% ：

```
SELECT * FROM table WHERE digest LIKE %keyword% 
```

你甚至可以用一个小循环构建一个 qUery，这样你就可以同时搜索多个关键字，如下所示：

```
SELECT * FROM table WHERE 
 digest LIKE %keyword1% AND 
 digest LIKE %keyword2% AND 
 digest LIKE %keyword3% ... 
```

* * *

## 回答 #6

> 赞同：6
> 
>             
> 
> 时间：2013-05-28T14:20:33.300

您可以在此处的线程中找到另一个更简单的选项：[Match Against..以及](https://stackoverflow.com/questions/6259647/mysql-match-against-order-by-relevance-and-column)[11.9.2 中](http://dev.mysql.com/doc/refman/4.1/en/fulltext-boolean.html)的更详细帮助。[布尔全文搜索](http://dev.mysql.com/doc/refman/4.1/en/fulltext-boolean.html)

这是以防万一有人需要更紧凑的选择。这将需要在表中创建一个索引 FULLTEXT，这很容易完成。

有关如何创建索引 (MySQL) 的信息：[MySQL FULLTEXT Indexing and Searching](http://www.petefreitag.com/item/477.cfm)

在`FULLTEXT`索引中，您可以列出多个列，结果将是一个带有名为 的索引的 SQL 语句`search`：

```
SELECT *,MATCH (`column`) AGAINST('+keyword1* +keyword2* +keyword3*') as relevance  FROM `documents`USE INDEX(search) WHERE MATCH (`column`) AGAINST('+keyword1* +keyword2* +keyword3*' IN BOOLEAN MODE) ORDER BY relevance; 
```

我尝试了多个列，但没有运气。即使索引中允许有多个列，您仍然需要为每列创建一个索引，以便与 Match/Against 语句一起使用。

根据您的标准，您可以使用任一选项。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2017-11-10T06:32:42.867

我知道这有点晚了，但我对我们的应用程序所做的就是这样。希望这会对某人有所帮助。但这对我有用：

```
SELECT * FROM `landmarks` WHERE `landmark_name` OR `landmark_description` OR `landmark_address` LIKE '%keyword'
OR `landmark_name` OR `landmark_description` OR `landmark_address` LIKE 'keyword%' 
OR `landmark_name` OR `landmark_description` OR `landmark_address` LIKE '%keyword%' 
```

# c++ - c ++ #define一个带括号的宏？

> ID：759584
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-04-17T08:44:25.177
> 
>         
> 
> 标签：c++, macros

而不是每次都执行以下操作

```
start();

// some code here

stop(); 
```

我想定义某种宏，它可以编写如下：

```
startstop()
{

//code here

} 
```

在 C++ 中可能吗？

* * *

## 回答 #1

> 赞同：41
> 
>             
> 
> 时间：2009-04-17T08:49:25.290

您可以使用一个小的 C++ 辅助类来做一些非常接近的事情。

```
class StartStopper {
public:
    StartStopper() { start(); }
    ~StartStopper() { stop(); }
}; 
```

然后在您的代码中：

```
{
    StartStopper ss;
    // code here
} 
```

当执行进入块并构造`ss`变量时，`start()`将调用该函数。当执行离开块时，`StartStopper`将自动调用析构函数，然后调用`stop()`.

* * *

## 回答 #2

> 赞同：14
> 
>             
> 
> 时间：2009-04-17T08:49:19.673

在 C++ 中执行此操作的惯用方式称为[Resource Acquisition Is Initialization](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)，或简称为 RAII。除了提供您想要的之外，它还具有异常安全的额外好处：`stop`即使您的代码抛出异常，也会调用该函数。

定义一个保护结构：

```
struct startstop_guard
{
    startstop_guard()
    {
        start();
    }
    ~startstop_guard()
    {
        stop();
    }
}; 
```

然后用这种方式重写你的代码：

```
{
    startstop_guard g;
    // your code
} 
```

守卫的析构函数（以及`stop`函数）将在封闭块的末尾自动调用。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T09:29:54.240

其他答案已经很好地解决了问题的 RAII 方面，所以**我将解决它的语法方面**。

```
#define startstop for(Starter s; s.loop; s.loop = false)
struct Starter {
    bool loop;
    Starter() { start(); loop = true; }
    ~Starter() { stop(); }
}; 
```

**像这样使用**：

```
startstop {
    // some code
} 
```

应该是不言自明的。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T08:49:52.997

```
#define startstop(x, y, ...) for( /* use macro args */ ) 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T08:59:02.490

具有 RAII 和 boost::function ( std::function ) 的通用解决方案。

```
class starter
{
    typedef boost::function< void () > action;
    action end_;
public:
    starter(action start, action end):
        end_(end)
    { 
        log("starter start");
        start(); 
    }
    ~starter()
    { 
        log("starter end");
        end_() ; 
    }
};
int main()
{
    {
        starter s(start, stop);
        middle();
    }

    return 0;
} 
```

或测试和检查这个想法

```
 void print(const std::string& message)
    {
        std::cout << message << std::endl;
    }
    int main()
    {
        starter s(boost::bind(print, "globalstart"),
                  boost::bind(print, "globalend")); 

        {
            starter s(boost::bind(print, "start"),
                      boost::bind(print, "end")); 
            std::cout << "middle" << std::endl;
        }
        return 0;
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:49:19.767

你想做什么？我建议将[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)视为一种比宏黑客更面向 C++ 的做事方式，其所有无法预料的后果。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:50:56.427

不要使用宏。您可以改用内联函数，因为它提供类型检查和其他功能。你可以看看这里：[内联函数](http://www.parashift.com/c++-faq-lite/inline-functions.html#faq-9.5)

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2010-07-26T17:31:32.780

归功于这个想法。我想我会填写其余的

`#define startstop() for(start();isStarted();stop())`

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2009-04-18T16:15:25.100

在 c# 中，您可以使用 IDisposable 模式，并在 Dispose() 方法中实现您的 Stop() 功能，但如果您使用的是 c++ 的 .net 变体，这将起作用。

# ajax - Ajax 请求和 text/xml

> ID：759591
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T08:45:09.153
> 
>         
> 
> 标签：ajax, firefox, xmldocument

我正在通过 ajax 请求和 xml 文件，服务器使用标题 text/xml 来返回数据。Firefox 读取此标头并将数据转换为 XMLDocument 对象，这意味着我不能将它与 jQuery 一起使用。如何将我的 XML 文档作为纯文本获取？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T08:57:18.797

返回的`xmlHttp`对象具有 responseXML 属性。这映射到一个 XmlDocument。如果您阅读`textContent`本文档的子节点，您将能够检索纯文本响应。

例如：

```
// Works on FF. For IE, you can read the lastChild.text property.
var responseText = xmlHttp.responseXML.lastChild.textContent; 
```

或者，您可以访问 responseText 属性以将整个响应作为字符串获取：

```
// Works on both IE and FF.
var responseText = xmlHttp.responseText; 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:02:23.230

通过序列化修复它：

```
var serializer = new XMLSerializer();
var text = serializer.serializeToString(xmldoc); 
```

# java - 如何在 Java 中使用“多个”SSL 证书？

> ID：759603
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T08:48:53.607
> 
>         
> 
> 标签：java, ssl, system-properties

我有一个同时与多个主机通信的应用程序。在这种情况下，我需要使用多个密钥库来建立与其他主机的通信。

在这种情况下，设置系统属性“javax.net.ssl.keyStore”是有问题的。我发现了一篇[较早的帖子](https://stackoverflow.com/questions/271506/why-system-setproperty-cannot-change-the-classpath-at-run-time/272062)很好地讨论了这个问题。

那么解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T14:36:56.127

您可以将多个证书导入单个密钥库。
[钥匙工具](http://www.sslshopper.com/article-most-common-java-keytool-keystore-commands.html)

# asp.net-mvc - 命名约定 - 控制器有一条规则，模型和视图没有规则

> ID：759617
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-17T08:50:43.477
> 
>         
> 
> 标签：asp.net-mvc, model-view-controller, naming-conventions

在 ASP.NET MVC 中，控制器存在于一个名为 Controllers 的文件夹中。他们的名字必须结束`Controller`，否则事情就不起作用（你得到一个 HTTP 404 错误）。

但是，模型名称不必以 . 结尾`Model`，视图名称不必以`View`.

这似乎不一致......为什么（从 MVC 或设计的角度）控制器名称必须结束`Controller`？

其他 MVC 框架有这个要求吗？

## 编辑

由于这似乎是我不提倡反对它的约定（请参阅[约定优于配置](http://en.wikipedia.org/wiki/Convention_over_Configuration)！），但我想了解它背后的原因。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-04-18T12:32:03.687

控制器约定是路由可以轻松找到控制器而无需额外配置。添加所需的 Controller 结尾可以降低您通过 MVC 路由意外暴露对象的可能性。

Views 也有一个内置的约定。默认情况下，视图应位于以您的控制器命名的文件夹中，并与调用它们的操作命名相同，这就是使您的操作中的方法调用 View() 无需指定视图即可工作的原因。无论如何，我经常发现自己指定了视图，但如果您正在寻找一种约定，这绝对是框架鼓励的约定。

从模型的角度来看，您是正确的，没有标准约定。这是因为 ASP.NET MVC 框架从不直接接触模型。它需要一个约定让控制器从路由中找到它们，并且它需要一个约定让视图从控制器中找到它们......但是模型只能从控制器中的逻辑访问，所以框架不需要知道它们.

话虽如此，我已经看到大多数人构建他们的模型，就像他们在 MVC 之前构建他们的实体或领域模型一样。如果您使用的是活动记录模式，则将模型命名为与它们映射到的表相对应，如果您更多地关注域，则将模型命名为与它们正在建模的域的部分相对应。此外，我看到越来越多的人创建了一组视图模型，这些视图模型仅用于向 UI 呈现数据，并且是通过从您的域中的各种模型中提取部分来创建的。模型绝对是 ASP.NET MVC 中最不自以为是的部分，但在 imo 中这是一件好事，因为人们在这个领域有非常不同的工作方式。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T09:01:09.410

这只是一个约定而不是要求！您可以通过自定义 DefaultControllerFactory 或创建自己的控制器工厂来更改此行为。

请参阅[此处](http://msdn.microsoft.com/en-us/library/system.web.mvc.defaultcontrollerfactory.aspx)了解更多信息。MvcContrib 项目中也有一些示例，它们从依赖注入引擎注入控制器。在[这里查看](http://www.codeplex.com/MVCContrib)。

# asp.net - 如何将 FooterRow 添加到最初没有价值的 Gridview

> ID：759621
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T08:51:59.073
> 
>         
> 
> 标签：asp.net, vb.net, gridview, footer

我有一个 Gridview，其中最初没有填充任何行。意味着我没有将任何数据源设置为gridview。我必须通过添加footerrow来填充gridview。我已经将footerrow的可见性设为true。所以一个错误是“对象未设置为对象的实例”。可能是什么这是什么原因？有人可以帮忙吗？

实际上我需要通过FooterRow将数据添加到Gridview中。插入几条记录后，我需要将这些数据插入到数据库中。所以，我希望这个Gridview只将数据插入到数据库中。对于特定的“FileID”，我有很多记录，这就是我使用 Gridview 的原因。还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:07:29.413

请参阅此问题：[如何在 GridView 中插入行](https://stackoverflow.com/questions/594088/how-to-insert-row-in-grid-view)。

对象引用错误可能是因为您没有为 GridView 设置数据源。在这种情况下，Gridview 将不会呈现。

**编辑：**

我已经链接到另一个问题，它提供了一个非常有用的链接来完成您想要的功能类型。由于您似乎没有找到它，这里是相关链接 -[如何使用 SqlDataSource 在 GridView 中轻松插入行？](https://web.archive.org/web/20131110230848/http://www.aspdotnetfaq.com/Faq/How-to-insert-row-in-GridView-with-SqlDataSource.aspx)

本文展示了如何使用`EmptyDataTemplate`GridView 来启用使用 GridView 的记录插入。请注意，您必须稍微修改逻辑才能一次性插入一组记录，而不是一次插入一个。

如果您对此解决方案有疑问，请通过评论澄清。

# python - 如何将cherrypy用作静态文件的Web服务器？

> ID：759627
> 
>         
> 
> 赞同：18
> 
>         
> 
> 时间：2009-04-17T08:54:26.213
> 
>         
> 
> 标签：python, cherrypy

`.html`将 CherryPy 用作将在某个文件夹中显示文件的 Web 服务器有什么简单的方法吗？所有 CherryPy 介绍性文档都声明内容是动态生成的：

```
import cherrypy
class HelloWorld(object):
    def index(self):
        return "Hello World!"
    index.exposed = True
cherrypy.quickstart(HelloWorld()) 
```

有什么简单的方法可以`index.html`代替 HelloWorld.index() 方法吗？

* * *

## 回答 #1

> 赞同：35
> 
>             
> 
> 时间：2009-04-17T11:53:00.620

这个简单的代码将提供当前目录中的文件。

```
import os
import cherrypy

PATH = os.path.abspath(os.path.dirname(__file__))
class Root(object): pass

cherrypy.tree.mount(Root(), '/', config={
        '/': {
                'tools.staticdir.on': True,
                'tools.staticdir.dir': PATH,
                'tools.staticdir.index': 'index.html',
            },
    })

cherrypy.quickstart() 
```

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T09:06:31.317

以下是有关使用 CherryPy 提供静态内容的一些信息：http: [//docs.cherrypy.org/stable/progguide/files/static.html](http://docs.cherrypy.org/stable/progguide/files/static.html)

顺便说一句，这是通过 HTTP 与 python 共享当前目录的简单方法：

```
# Python 3
$ python -m http.server [端口]

# Python 2
$ python -m SimpleHTTPServer [端口]

```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T11:48:02.957

```
# encode: utf-8

import cherrypy
WEB_ROOT = "c:\\webserver\\root\\"

class CServer( object ) :
    @cherrypy.expose
    def do_contact(self, **params):
        pass

cherrypy.server.socket_port = 80
# INADDR_ANY: listen on all interfaces
cherrypy.server.socket_host = '0.0.0.0'
conf = { '/':
  { 'tools.staticdir.on' : True,
    'tools.staticdir.dir' : WEB_ROOT,
    'tools.staticdir.index' : 'index.html' } }
cherrypy.quickstart( CServer(), config = conf ) 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2021-01-06T14:06:35.553

我发布了这个新答案，因为已接受答案的解决方案已过时。这个简单的代码将提供当前目录中的文件。

```
import os
import cherrypy

PATH = os.path.abspath(os.path.dirname(__file__))
class Root(object): pass

cherrypy.tree.mount(Root(), '/', config={
        '/': {
                'tools.staticdir.on': True,
                'tools.staticdir.dir': PATH,
                'tools.staticdir.index': 'index.html',
            },
    })

cherrypy.engine.start()
cherrypy.engine.block() 
```

当然，这只是对已经发布的内容的总结。

# javascript - Jquery：如何检查元素是否具有某些 css 类/样式

> ID：759631
> 
>         
> 
> 赞同：91
> 
>         
> 
> 时间：2009-04-17T08:56:29.673
> 
>         
> 
> 标签：javascript, jquery, css

我有一个 div：

```
<div class="test" id="someElement" style="position: absolute"></div> 
```

有什么方法可以检查某个元素是否：

```
$("#someElement") 
```

有一个特定的类（在我的例子中，“测试”）。

或者，有没有办法检查 en 元素是否具有某种样式？在这个例子中，我想知道元素是否有“ `position: absolute`”。

非常感谢你！

* * *

## 回答 #1

> 赞同：290
> 
>             
> 
> 时间：2009-04-17T09:02:04.107

CSS 样式是键值对，而不仅仅是“标签”。默认情况下，每个元素都有一套完整的 CSS 样式分配给它，其中大多数隐式使用浏览器默认设置，其中一些在 CSS 样式表中显式地重新定义。

要获取分配给元素的特定 CSS 条目的值并进行比较：

```
if ($('#yourElement').css('position') == 'absolute')
{
   // true
} 
```

如果您没有重新定义样式，您将获得该特定元素的浏览器默认值。

* * *

## 回答 #2

> 赞同：60
> 
>             
> 
> 时间：2009-04-17T09:01:03.000

```
if($('#someElement').hasClass('test')) {
  ... do something ...
}
else {
  ... do something else ...
} 
```

* * *

## 回答 #3

> 赞同：13
> 
>             
> 
> 时间：2014-02-26T12:43:48.127

```
if ($("element class or id name").css("property") == "value") {
    your code....
} 
```

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2015-01-21T23:25:08.750

或者，如果您需要访问具有该属性且不使用 id 的元素，则可以采用以下方法：

```
$("img").each(function () {
        if ($(this).css("float") == "left") { $(this).addClass("left"); }
        if ($(this).css("float") == "right") { $(this).addClass("right"); }
    }) 
```

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:01:50.377

我找到了一种解决方案：

```
$("#someElement")[0].className.match("test") 
```

但不知何故，我相信有更好的方法！

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2018-07-29T14:22:27.680

问题是要求两个不同的东西：

1.  一个元素有特定的类

2.  一个元素有一定的风格。

第二个问题已经回答了。对于第一个，我会这样做：

```
if($("#someElement").is(".test")){
    // Has class test assigned, eventually combined with other classes
}
else{
    // Does not have it
} 
```

# java - 创建一个可以同时支持真实对象和 NullObject 的工厂

> ID：759632
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T08:57:10.387
> 
>         
> 
> 标签：java, reflection, proxy, network-programming

我想创建一个工厂来创建一个 smack XMPPConnection。如果无法建立连接，工厂应该返回真正的 XMPPConnection 或 NullObject。

然而 smack 的 XMPPConnection 是一个具体的类。

它没有实现任何接口，所以我不能使用java动态代理API来代理傻瓜。我可以扩展 XMPPConnection 但这不是很优雅。

还有其他选择吗？请注意，工厂绝不能返回 null ！

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T09:02:22.763

您必须创建自己的接口，该接口基本上复制 XMPPConnection 并创建一个实现该接口并包装真实 XMPPConnection 类的适配器。这样你也可以有一个 NullXMPPConnection 。

# php - 使用 HTML_ToPDF 类 (PHP) 将 HTML 转换为 PDF

> ID：759634
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T08:57:27.347
> 
>         
> 
> 标签：php, pdf-generation, debian

在我的项目中，我使用[HTML_ToPDF](http://rustyparts.com/pdf.php) PHP 类，它使用[html2ps](http://user.it.uu.se/~jan/html2ps.html)脚本将 HTML 转换为 PDF 文件。

最近我将我的生产服务器升级到 Debian 5 (Lenny)，之后`HTML_ToPDF`就不再工作了：

`convert()`类中的方法`HTML_ToPDF`返回此错误：

```
Error: there was a problem running the html2ps command.  Error code returned: 127\.  setDebug() for more information. 
```

而且， html2ps 调用的输出是：

```
/usr/bin/perl: symbol lookup error: /usr/lib/perl5/auto/Compress/Zlib/Zlib.so: undefined symbol: Perl_Tstack_sp_ptr 
```

任何帮助将不胜感激，谢谢！

**[编辑]**
经过一些测试，我发现问题只发生在包含图像（标签）的 HTML 上。当 html2ps 找到第一张图片时，它会崩溃。转换没有图像的 HTML 可以正常工作。任何的想法？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:09:14.100

这是从 HTML 到 PS 的初始转换的问题。通常是由于 HTML 写得不好。

你能展示一些你试图转换的例子吗？

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:39:46.927

老实说，我发现[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)比 html2ps 好得多，尽管它处于相当早期的开发阶段。

我写[了一篇关于它的博客](http://ciaranmcnulty.com/blog/2009/04/converting-html-to-pdf-using-wkhtmltopdf)，但如果你不想阅读它，它基本上使用 KHTML/Webkit 的渲染引擎来渲染页面，这比编写完整的 HTML 渲染器的通常方法更明智。

分布式二进制文件在我的 Debian 服务器上运行良好，坦率地说，结果非常好。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T12:04:51.560

试试这个

apt-get install perl=5.8.8-7etch6 perl-base=5.8.8-7etch6 perl-modules=5.8.8-7etch6 debconf-i18n=1.5.11etch2 liblocale-gettext-perl=1.05-1 libtext-iconv-perl =1.4-3 libtext-wrapi18n-perl=0.06-5 libtext-charwidth-perl=0.04-4 html2ps=1.0b5-2 libapache2-mod-perl2=2.0.2-2.4 libcompress-zlib-perl=1.42-2 libfuse- perl=0.07-2+b2 libhtml-parser-perl=3.55-1 libhtml-tree-perl=3.19.01-2 libio-zlib-perl=1.04-1 libwww-perl=5.805-1 perlmagick=7:6.2.4.5 .dfsg1-0.14 snmpd=5.2.3-7etch4 xhtml2ps mysql-client=5.0.32-7etch8 mysql-client-5.0=5.0.32-7etch8 libdbd-mysql-perl=3.0008-1 libdbi-perl=1.53-1etch1

[http://www.deberias.com](http://www.deberias.com)

# asp.net-mvc - 我怎么知道我所有的动作方法名称都是正确的？

> ID：759635
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T08:57:42.493
> 
>         
> 
> 标签：asp.net-mvc

在我的 ASP.NET MVC 控制器类中，我有操作方法。

在我看来，我`Html.ActionLink`的 s 将这些操作方法的名称设置为它们的`actionName`值。

在这两个位置中的任何一个错字都会破坏事情。是否有任何工具可以以这种方式检查我的控制器和视图的有效性？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:02:25.383

在[mvc 期货程序](http://aspnet.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24471)集中，有 ActionLink 的重载，它们采用一个表达式，例如：

```
<%=Html.ActionLink<ProductsController>(o => o.Create(), "New")%> 
```

这些可以在编译时检查并且是“重构友好的”。

您将需要执行几个额外的步骤来强制 Visual Studio 编译您的视图，以便在名称不匹配时出现错误（[详情请点击此处](http://webdevdotnet.blogspot.com/2009/02/aspnet-mvc-rc-compiler-post-build-step.html)）

# visual-studio - 更新解决方案中所有程序集的版本号

> ID：759644
> 
>         
> 
> 赞同：30
> 
>         
> 
> 时间：2009-04-17T09:00:11.253
> 
>         
> 
> 标签：visual-studio, assemblies

我在 Visual Studio 中有一个相当大的解决方案。有没有办法一次性更新解决方案中所有程序集的主要/次要版本号？

* * *

## 回答 #1

> 赞同：49
> 
>             
> 
> 时间：2009-04-17T09:03:49.123

您可以在解决方案中的所有项目之间共享一个 AssemblyInfo.cs 文件。此共享文件应包含版本号。要共享它，您必须使用 VS 中的添加现有文件并在文件对话框中选择添加为链接。每个项目都有其私有和共享的 AssemblyInfo.cs。私有的仍然包含非版本属性。

我有一个 TeamCity 设置，我使用实际构建版本在每个 TeamCity 构建中生成共享文件，它运行良好。

* * *

## 回答 #2

> 赞同：11
> 
>             
> 
> 时间：2009-04-17T09:05:36.937

我们有一个带有版本号的 AssemblyInfoCommon.cs，并通过引用包含在每个项目中。其他 AssemblyInfo.cs 文件仍然存在，但仅包含特定于程序集的信息（标题和描述）。因此，对于每个 C# 项目，我们只有一个文件要更新。

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2009-04-17T09:11:24.550

您还可以在您的一个类中拥有一个公共 const 字符串，它表示内部版本号，并在您的所有 AssemblyInfo.cs 中将其用于不同的项目。当然，这必须在所有其他项目都引用的项目中才能工作。

如果您不喜欢在所有项目中引用相同的 AssemblyInfo.cs，这是一个不错的选择。

编辑：注意！当您使用多种语言（在我的情况下为 F# 和 C#）时，这也适用。

* * *

## 回答 #4

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T09:01:31.297

搜索/替换？

毕竟版本号存储在文本文件中（每个项目的 Properties 文件夹下的 AssemblyInfo.cs）。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:32:37.790

我前段时间在一个需要高度管理版本控制的项目中使用了一个非常有用的实用程序：

[http://www.codeproject.com/KB/macros/versioningcontrolledbuild.aspx](http://www.codeproject.com/KB/macros/versioningcontrolledbuild.aspx)

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2015-12-16T15:35:31.620

您还可以创建一些“核心”程序集，并将每个程序集引用添加到“核心”程序集。“核心”程序集将保持不变。在这种情况下，每个程序集信息文件中的程序集版本将从“核心”常量设置。例如：

“核心”程序集的文件 Ver.cs 具有常量： public const string Value = "0.0.0.99";

在每个解决方案中，程序集信息将：[程序集：AssemblyFileVersion(Ver.Value)]

# .htaccess - 使用 RewriteProxy 衍生“屏蔽”外部 url 链接

> ID：759645
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T09:00:15.873
> 
>         
> 
> 标签：.htaccess, url-rewriting, isapi

我有一个简单的重写规则，它使用 Helicon Isapi_Rewrite 3 RewriteProxy derictive 写入外部域。

示例：RewriteProxy 博客[http://blog.com](http://blog.com)

但是，外部站点上的链接并没有像我预期的那样被代理屏蔽。他们仍然指向[http://blog.com/link1](http://blog.com/link1)而不是[http://mysite/blog/link1](http://mysite/blog/link1)。

谁能指出我解决这个问题的正确方向？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2011-06-02T22:19:55.383

Helicon Tech 论坛上的讨论解决了同样的问题。
[http://www.helicontech.com/forum/8460-rewrite_proxy_to_2d_machine.html](http://www.helicontech.com/forum/8460-rewrite_proxy_to_2d_machine.html)

第一个示例提供**ISAPI Rewrite 2**的代码，但该线程在页面下方包含**ISAPI Rewrite 3**语法。这是他们为您的示例改编的版本 3 代码。

```
RewriteEngine on
RewriteBase /
RewriteRule ^blog$ http://mysite/blog/ [NC,R=301]
RewriteProxy ^/blog(/.*)?$ http\://blog.com$1 [NC,U] 
```

（这是未经测试的，因为我正在运行 ISAPI Rewrite 2。）请注意，在尝试反向代理我的“主”域下的另一个站点时，我遇到了一些障碍。您也可能会发现这些问题。

**1) 非相对链接**

除非应用程序已经从头开始编码以假设反向代理，否则我发现它可能会中断。使用所有相关链接的基本 HTML 页面都可以使用。但是，通过包含此代码的反向代理提供 HTML 将映射到[http://mysite/page_from_the_root.html](http://mysite/page_from_the_root.html)。ISAPI Rewrite 不知道拦截该请求，但如果用户的浏览器点击[http://mysite/blog/page_from_the_root.html ，它将代理内容](http://mysite/blog/page_from_the_root.html)

**2) 饼干**

Blog.com 可能会从 blog.com 域写入 cookie。通过 MySite 域提供的页面可能无法访问这些 cookie，具体取决于用户的浏览器设置。

**3) JavaScript 和 AJAX**

**4) SSL 证书**

# excel - 如何仅对未过滤掉的excel中的那些行求和？

> ID：759656
> 
>         
> 
> 赞同：55
> 
>         
> 
> 时间：2009-04-17T09:02:28.737
> 
>         
> 
> 标签：excel, excel-formula

我使用`SUM(B1..B20)`公式对一列求和，但是当我按相邻列过滤数据时，总和不会更新以仅反映那些未过滤掉的行。如何做到这一点？

* * *

## 回答 #1

> 赞同：100
> 
>             
> 
> 时间：2009-04-17T10:31:13.640

您需要使用**[SUBTOTAL](https://support.office.com/en-us/article/SUBTOTAL-function-7b027003-f060-4ade-9040-e478765b9939)**函数。**SUBTOTAL**函数忽略已被过滤器排除的行。

公式如下所示：

```
=SUBTOTAL(9,B1:B20) 
```

函数编号**9**告诉它在数据范围**B1:B20上使用****SUM**函数。  

 **如果您通过隐藏行进行“*过滤*”，则函数编号应更新为**109**。

```
=SUBTOTAL(109,B1:B20) 
```

函数编号**109**也用于**SUM**函数，但忽略隐藏的行。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2014-01-22T17:42:32.687

如果您没有使用自动过滤器（即您有手动隐藏的行），您将需要使用该[`AGGREGATE`](https://support.office.com/en-us/article/AGGREGATE-function-43b9278e-6aa7-4f17-92b6-e19993fa26df)功能而不是`SUBTOTAL`.

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:32:04.500

当您使用自动过滤器过滤结果时，Excel 甚至都懒得隐藏它们：它只是将行高设置为零（至少到 2003 年，2007 年不确定）。

所以下面的自定义函数应该给你一个开始做你想做的事（用整数测试，没有玩过其他任何东西）：

```
Function SumVis(r As Range)
    Dim cell As Excel.Range
    Dim total As Variant

    For Each cell In r.Cells
        If cell.Height <> 0 Then
            total = total + cell.Value
        End If
    Next

    SumVis = total
End Function 
```

编辑：

您需要在工作簿中创建一个模块来放入函数，然后您可以像任何其他函数一样在工作表上调用它 (=SumVis(A1:A14))。如果您需要帮助设置模块，请告诉我。

# code-analysis - 您使用什么重复检测阈值？

> ID：759657
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T09:03:14.727
> 
>         
> 
> 标签：code-analysis, dry, code-duplication

我们都同意重复是邪恶的，应该避免（不要重复自己的原则）。为确保这一点，应使用静态分析代码，如[Simian](http://www.redhillconsulting.com.au/products/simian/)（多语言）或[Clone Detective](http://www.codeplex.com/CloneDetectiveVS)（Visual Studio 插件）

我刚刚阅读了[Ayende 关于科比的帖子](http://ayende.com/Blog/archive/2009/04/17/kobe-ndash-architectural-overview.aspx)，他说：

> Kobe 的 8.5% 是复制粘贴代码。那就是在灵敏度调高的情况下，如果我们将阈值设置为 3，这是我通常所做的，它会上升到 12.5%。

我认为 3 作为阈值非常低。在我的公司，我们提供质量代码分析即服务，我们的默认重复阈值设置为 20，并且存在大量重复。我无法想象如果我们将其设置为 3，我们的客户甚至都不可能考虑更正。

我理解 Ayende 对 Kobe 的看法：它是一个官方样本，并被宣传为“旨在指导您规划、构建和实施 Web 2.0 应用程序和服务”。所以对质量的期望很高。

**但是对于您的项目，您使用什么最小阈值进行复制？**

*相关问题：[您如何狂热地消除代码重复？](https://stackoverflow.com/questions/296056/how-fanatically-do-you-eliminate-code-duplication)*

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-06-16T19:53:32.527

三是一个很好的经验法则，但这取决于。重构以消除重复通常涉及将代码库和 API 的概念简单性换成更小的代码库，一旦有人理解它就更易于维护。我通常从这个角度来评估事情。

在一种极端情况下，如果修复重复项使代码更具可读性并且对代码的概念复杂性几乎没有增加或根本没有增加，那么任何重复都是不可接受的。这方面的一个例子是，只要将重复的代码巧妙地分解为一个简单的引用透明函数，该函数执行的操作很容易解释和命名。

当需要更复杂、重量级的解决方案（例如元编程、OO 设计模式等）时，我可能会允许 4 或 5 个实例，尤其是在重复的片段很小的情况下。在这些情况下，我觉得解决方案的概念复杂性使治愈比生病更糟糕，直到真的有很多实例。

在最极端的情况下，我正在使用的代码库是一个非常快速发展的原型，我对项目可能发展的方向知之甚少，无法绘制出既合理简单又合理面向未来的抽象线，我只是放弃。在这样的代码库中，我认为只关注权宜之计和完成工作比好的设计更好，即使同一段代码被重复 20 次。通常，创建所有重复的原型部分无论如何都会相对很快被丢弃，一旦你知道原型的哪些部分将被保留，你总是可以重构这些部分。如果没有将被丢弃的部分产生的额外约束，在这个阶段重构通常会更容易。

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T09:10:45.003

我不知道什么是好的“指标”，但我会说我通常努力的目标是

*   如果您在两个地方有相同的代码，并且

*   代码是相同的意图（而不仅仅是巧合相同）

然后重构以消除重复。所有的重复都是坏的。我很少让代码在两个地方，而在三个地方，它肯定必须去。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:07:47.163

我个人对此非常狂热。我尝试设计我的项目以避免代码重复。我的目标是让阈值保持在较低的个位数，如果我无法达到，则意味着我的设计还不够好，我需要回到绘图板或重构。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2010-01-20T16:53:47.117

取决于编程语言。（“克隆侦探”家伙似乎意识到了这一点：“编程语言约束”是他第一次演讲中的框框之一。）

在 Lisp 程序中，*任何*重复的表达式都很容易被重构——我猜你会称之为阈值 2。一切都是由表达式组成的，并且有宏来翻译表达式，所以很少有任何借口可以复制任何东西甚至一次。（关于我能想到的唯一难以提取的东西就是 LOOP 子句，事实上，很多人正是因为这个原因而主张避免使用 LOOP。）

在许多其他语言中，程序由具有具有语句的方法的类组成，因此很难仅提取一个表达式并在两个不同的文件中使用它。通常，这意味着在提取事物时更改事物的结构。通常还需要类型安全，这可能会受到限制（除非你想一直编写*大量*反射代码来逃避它，但如果你这样做了，你不应该使用静态语言）。如果我让我当前的静态类型程序完全 DRY，它既不会更短，也不会更容易维护。

我想这样做的结果是我们真正想要的是“易于维护”。有时，在某些语言中，这意味着“只需在此处发表评论，说明您复制的内容和原因”。DRY 是可维护代码的良好指标。如果你经常重复，那不是一个好兆头。但是追逐任何单一的统计数据也往往是不好的——否则，我们会通过简单地优化来解决我们所有的问题。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2010-03-11T14:17:05.027

我认为我们需要结合

*   重复的行数

*   复制的次数

*   重复项彼此之间有多“接近”，

    例如，如果不同的产品恰好位于同一个源代码控制系统中，那么如果它们采用相同的方法，情况就会大不相同。

*   自任何包含重复代码的方法被更改以来的时间。

So as to get a good trade-off between cost/benefit of removing the duplicates.

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-08-23T05:56:20.010

我们的[CloneDR](http://www.semanticdesigns.com/Products/Clone)在大型源系统中查找重复代码，包括精确副本和接近未命中，并由语言语法参数化。它支持 Java、C#、COBOL、C++、PHP 和许多其他语言。

它接受许多参数来定义“什么是克隆？”，包括：a）相似度阈值，控制两个代码块必须有多相似才能被声明为克隆（通常 95% 是好的）b）最小克隆的行数大小（3 往往是一个不错的选择） c) 参数的数量（对文本的明显更改；5 往往是一个不错的选择）使用这些设置，它往往会在它处理的几乎所有内容中找到 10-15% 的冗余代码。

# iphone - UITextView 背景图片

> ID：759658
> 
>         
> 
> 赞同：37
> 
>         
> 
> 时间：2009-04-17T09:03:42.587
> 
>         
> 
> 标签：iphone, cocoa-touch, uitextview

如何设置背景图像`UITextView`？

* * *

## 回答 #1

> 赞同：72
> 
>             
> 
> 时间：2009-04-17T09:46:02.470

您可以拥有一个`UIImageView`包含背景图像和同级的`UITextView`兄弟，然后在 Interface Builder 中移动文本视图以与图像视图重叠（或者如果以编程方式将它们都添加到同一个父视图中）。您还需要确保文本视图不是**不透明**的，并给它一个**0% 的不透明度背景**。

* * *

## 回答 #2

> 赞同：45
> 
>             
> 
> 时间：2009-04-17T11:23:43.127

```
UITextView *textView = [[UITextView alloc]initWithFrame: window.frame];
textView.text = @"text\n text\n text";
UIImageView *imgView = [[UIImageView alloc]initWithFrame: textView.frame];
imgView.image = [UIImage imageNamed: @"myImage.jpg"];
[textView addSubview: imgView];
[textView sendSubviewToBack: imgView];
[window addSubview: textView]; 
```

* * *

## 回答 #3

> 赞同：42
> 
>             
> 
> 时间：2011-01-20T13:14:16.067

**@durai：**您的图像有高度限制，如果在向下滚动后出现空白背景，则会出现白色背景，然后您可以重复相同的图像。

**这可能会有所帮助：**

```
textView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed: @"Image.png"]]; 
```

* * *

## 回答 #4

> 赞同：11
> 
>             
> 
> 时间：2010-11-11T09:53:48.327

只是一个澄清，当尝试来自**@oxigen**的答案#9 时，我发现这一行：

```
UIImageView *imgView = [[UIImageView alloc]initWithFrame: textView.frame]; 
```

是相对的`textView.frame`。因此，如果您希望它完全重叠，则您的`x`和`y`值需要为 0,0，这意味着您想要类似的东西：

```
UIImageView *imgView = [[UIImageView alloc]initWithFrame:textView.bounds]; 
```

* * *

## 回答 #5

> 赞同：6
> 
>             
> 
> 时间：2012-12-14T16:21:47.353

我找到了一种简单的方法来设置背景图像。

h 文件

```
@interface FNTextView : UITextView

@end 
```

文件

```
...
- (void)drawRect:(CGRect)rect
{
    [self.bgImage drawInRect:rect];

    [super drawRect:rect];
}

- (void)initHandler
{
    self.bgImage = [[UIImage imageNamed:@"textview_bg"] resizableImageWithCapInsets:UIEdgeInsetsMake(4, 4, 4, 4)];
}
... 
```

* * *

## 回答 #6

> 赞同：5
> 
>             
> 
> 时间：2013-09-18T08:57:46.860

```
[txtView setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"image.png"]]]; 
```

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2012-03-12T13:24:15.203

对于平铺背景，我喜欢这个解决方案

```
UIImage *patternImage = [UIImage imageNamed:@"image.png"];
UIColor* color = [UIColor colorWithPatternImage:patternImage];
textView.backgroundColor = color; 
```

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:35:58.640

不确定，但您可以尝试以下操作，假设您的背景图像由 UIImageView 处理：

[myTextView addSubview: myImageView];

请注意，您可能需要更改 UITextView 的 alpha/opaque 属性的值。

亲切的问候。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2012-12-05T10:51:25.767

```
UITextView *textView=[[UITextView alloc]initWithFrame: CGRectMake(20, 20, 40, 40)];
textView.text = @"this is a test \n this is test \n this is a test";
UIImageView *img = [[UIImageView alloc]initWithFrame: textView.frame];
img.image = [UIImage imageNamed: @"image.png"];
[self.view addSubview:textView];
[self.view insertSubview:img belowSubview:textView]; 
```

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2013-03-20T16:56:59.247

@dulcanwilcox 和 @oxigen 的答案都有效，但是，如果图像被用来显示某种边框，另外可以调整背景图像的大小。

```
UITextView *textView = [[UITextView alloc]initWithFrame: window.frame];
textView.text = @"Some text...";

UIImageView *imgView = [[UIImageView alloc]initWithFrame: textView.frame];
imgView.image = [[UIImage imageNamed: @"image"] resizableImageWithCapInsets:UIEdgeInsetsMake(8, 8, 8, 8)];

[textView addSubview:imgView];
[textView sendSubviewToBack:imgView];

[window addSubview:textView]; 
```

查看[resizableImageWithCapInsets:(UIEdgeInsets)capInsets](https://developer.apple.com/reference/uikit/uiimage/1624102-resizableimagewithcapinsets)的文档。

# visual-studio - Visual Studio 中的项目路径问题

> ID：759661
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T09:04:58.777
> 
>         
> 
> 标签：visual-studio, ssis, path

我在将我的 SSIS 项目移动到新 PC 时遇到问题。

目前我的所有项目都在 C:\Documents and Settings\myname\My Documents\Visual Studio 2005\Projects

但是我的 .dtsx 包位于不同的文件夹中。这个文件夹在我的新电脑上不存在。因此，每当我尝试在我的新 PC 上打开项目时，它都会抱怨它找不到有意义的路径等。所以我想要做的是将我的 .dtsx 包保存回项目文件夹中。

我的问题是当我打开项目并右键单击 .dtsx 文件的属性时，我无法弄清楚如何更改为 .dtsx 文件的路径，路径显示为灰色且不可编辑。如果我将 dtsx 文件另存为...并指向新文件夹，它会保存并更新灰色路径，但是当我再次打开项目时，它会恢复到旧路径。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T09:39:58.740

您可以在文本编辑器中打开项目文件并首先编辑 .dtsx 文件的路径，然后双击打开项目文件，它将从项目文件中指定的路径加载 .dtsx 文件。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2013-07-30T11:00:16.187

如果您的 dtsx 文件大写更改为小写，则将您的 dtsx 文件再次重命名为任何其他名称并构建它。它肯定会工作。

# c - C中的指针算术

> ID：759663
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-04-17T09:05:10.103
> 
>         
> 
> 标签：c, pointers, pointer-arithmetic

考虑以下代码片段：

```
int (*p)[3];
int (*q)[3];

q = p;
q++;
printf("%d, %d\n", q, p);
printf("%d\n", q-p); 
```

我知道指针算术是智能的，这意味着该操作`q++`向前推进`q`了足够的字节以指向下一个 3 整数数组，所以第一个打印是 ' `12, 0`' 我并不感到惊讶，这意味着递增`q`使它在 12 中变大。

但第二版*确实*让我吃惊。它打印 1！

那么为什么它会打印 1 而不是 12？这让我很困惑。

* * *

## 回答 #1

> 赞同：27
> 
>             
> 
> 时间：2009-04-17T09:07:54.980

与`++`增量运算符一样，`-`带指针的减法运算符也考虑了所指向对象的大小。具体来说，返回的结果是指针值中的字节数差异除以指向对象的大小（在您的示例中为 12）。所以差值是 12 个字节，除以大小 12 或 1。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T09:34:44.277

如果您真的想知道差异，请将每个指针转换为 (char*)，然后转换为 (int)，然后再减去。那应该会给你答案。  

此代码为您提供绝对值：

```
printf("%d\n", abs((int)((char*)q) - (int)((char*)p))); 
```

记得包含 math.h。

编辑：正如评论中指出的那样，我们不需要双重演员。将每个指针指针转换为一个 int 然后减去，给出的答案与上面的（不必要的）双重转换相同。

```
printf("%d\n", abs((int)(q) - (int)(p))); 
```

# .net - 任何人都知道一个好的.Net国际象棋引擎

> ID：759664
> 
>         
> 
> 赞同：11
> 
>         
> 
> 时间：2009-04-17T09:05:36.857
> 
>         
> 
> 标签：.net, chess

我正在寻找一个不错的.Net 国际象棋引擎。如果有一个好的国际象棋现有的，有什么建议可以推荐一个好的候选人来移植到.Net？

* * *

## 回答 #1

> 赞同：12
> 
>             
> 
> 时间：2009-04-17T09:19:28.137

Valil.Chess不是这样的引擎，但[Valil.Chess](http://www.valil.com/winfx/)是一款出色的 .NET 国际象棋游戏（有可用的源代码 - 因此您可以访问游戏的“引擎”），它赢得了[2004 年 11 月 Code Project 提交奖](http://blogs.msdn.com/coding4fun/archive/2006/01/24/517109.aspx)。

还有[SharpChess](https://github.com/PeterHughes/SharpChess)，它也是一个完整的国际象棋游戏，用 C# 编写。

至于可以转换为 .NET 的通用 Chess 引擎，有很多可用的，并且根据挑战，您可以从许多引擎中挑选并在 .NET 中实现。[这里](http://en.wikipedia.org/wiki/Chess_engine#Freely_available_chess_engines)有一个很好的起点列表，还显示了每个引擎的[Elo 评级](http://en.wikipedia.org/wiki/Elo_rating_system)。即使重新实现[FICS](http://www.freechess.org/)的服务器端也肯定是一个挑战！:)

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-04-21T18:56:50.897

我写了一个计算机国际象棋博客，带您完成从头开始用 C# 编写国际象棋引擎的所有步骤，它包括一个计算机国际象棋链接部分和一个国际象棋游戏入门工具包。

[http://www.chessbin.com](http://www.chessbin.com)

亚当·贝伦特

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T09:13:57.197

SharpChess 引擎代码 (C#) 可在此处获得：

[搜索引擎源代码](http://sharpchess.com/?page=50%20Development/02%20Engine%20Code)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:15:15.743

你可以试试[SharpChess](http://sharpchess.com/)或[ChEngine](http://www.codeplex.com/ChEngine/)。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:25:29.713

我还推荐[SharpChess](http://sharpchess.com/)作为 .Net 的起点。当我开发我的引擎（在 VB、Delphi、C# 中）时，我经常提到 Robert Hyatt 教授的[Crafty](http://en.wikipedia.org/wiki/Crafty)。（看看 Crafty 的进步版本是一种乐趣。）

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2020-11-30T04:25:59.913

对于多年后到达这里的人，我检查了其他答案中最受欢迎的建议——显然是**SharpChess——此时**它似乎**已经过时**了；上次提交是在 6 年前，有许多悬而未决的问题、断开的链接和单元测试似乎不完整，不足以证明引擎是如何工作的，至少对于大多数不熟悉国际象棋引擎的人来说。

我发现这个名为[StockChess](https://www.codeproject.com/Articles/1159746/StockChess)的项目是一个简单的 WPF 应用程序，它使用了一个名为[Stockfish](https://stockfishchess.org/about/)的国际象棋引擎的可执行文件，自称是`the strongest open source chess engine nowadays`.

我发现**StockChess在它的**[页面](https://www.codeproject.com/Articles/1159746/StockChess)上有一个合理的解释它是如何工作的。您可能可以将其用作起点，这就是我正在做的事情。

# linq - Linq 到实体自引用关系映射

> ID：759677
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T09:09:53.353
> 
>         
> 
> 标签：linq, entity-framework, linq-to-entities, entity-relationship

如何使用 LinqToEntity 映射一个名为 category 的表，其中 Id 作为主键，该表具有名为 ParenCategoryId 的自我引用？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-19T02:06:02.187

创建一个从 ID 指向 ParentCategoryID 的 FK。EF 应该从那里获取导航属性。该名称将毫无用处，因此您必须做一些额外的工作（通过代码生成器或 T4 模板）才能将其重命名为更适合的名称，例如“ParentCategory”。

# java - 您将 SQL 查询放在哪里？

> ID：759680
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-17T09:10:37.033
> 
>         
> 
> 标签：java, sql, jdbc

我们混合使用 EJB 2.1 和 JDBC 来访问我们的数据库。

我刚刚让一位同事提到将他的 SQL 查询放入 .properties 文件的想法。

你如何以及在哪里放置你的 SQL 查询？

编辑：

您是否将其与代码内联，放入类实例化中？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T09:18:25.703

在[DAO](http://en.wikipedia.org/wiki/Data_Access_Object)中，因为我认为它们是我的应用程序的一部分，而不是应用程序的可配置（可由系统管理员更改）元素。

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T10:23:02.337

我们将 SQL 查询存储为 DAO 中的字符串文字。DAO 对应用程序的其余部分隐藏了可能丑陋的 SQL 语法。当您深入研究 DAO 代码时，将 SQL 查询放在将要使用它们的上下文中有助于使代码更易于理解。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T10:13:30.533

在我现在工作的地方，我们使用属性文件来存储我们的 SQL 查询。我非常喜欢它，因为我一直认为它在代码中看起来相当混乱。我真的不认为它可以由系统管理员配置，因为它们都将与 jar 捆绑在一起，因此是不可见的。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:21:25.963

我使用 Ibatis，所以所有查询都驻留在 Ibatis XML 文件中。如果不是 Ibatis，那么在 DAO java 代码中。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:10:59.617

我通常将查询作为静态字符串添加到使用它们的 DAO 实现中。

# c# - 强制事件在内部触发

> ID：759681
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T09:10:44.317
> 
>         
> 
> 标签：c#, events, composite-controls

在复合控件中，如何在内部触发事件？

IE。我填充了一些数据，看到它处于正确的状态（只有一个项目），然后触发我的项目选择事件，调用源页面的 OnItemSelected 事件。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:15:26.193

一些控件实现了 ISupportInitialize 接口，该接口具有 BeginInit()/EndInit() 方法。如果您正在对控件进行批量更新，您可以使用 BeginInit() 阻止事件，并在完成后调用 EndInit()。最后，您将所选项目设置为触发事件或直接调用事件。

# asp.net-mvc - 您是否希望操作方法不返回 ActionResult？

> ID：759689
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T09:14:29.363
> 
>         
> 
> 标签：asp.net-mvc

在 ASP.NET MVC 中，[约定](http://www.asp.net/learn/mvc/tutorial-03-cs.aspx)是控制器操作方法应返回一个`ActionResult`（或派生自 的类型`ActionResult`）。

但是，您可以编写一个返回几乎任何内容的公共方法，如果（从浏览器）调用该方法，框架会将返回值打包为 a`ContentResult`并且浏览器会收到一个纯文本页面。

这一切都非常有趣——但你愿意这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:19:45.903

当你想直接从你的控制器渲染一些东西时？例如使用 Response.Write(...); （或使用其他响应方法）。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:20:27.463

不从操作方法返回任何内容本质上是不响应客户端的 HTTP 请求。

在某些情况下，一个空请求可能是有意义的（HTTP 状态足以作为回复），但所有 Web 应用程序模式都会返回更多的东西（如果我理解正确的话，包括 REST：实体的新状态）。

# iphone - iphone：UIImageView 性能不佳

> ID：759697
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T09:17:04.740
> 
>         
> 
> 标签：iphone

大家好，我正在为 iphone 开发谷歌地图应用程序的每一个人，我都被 UIImagView 创建的在屏幕上移动的方式所困扰，此外我还创建了 3*3 UIImageViews，这样我就可以一次收集大量数据。 ..

但是我正在做的图像运动不好

水平偏移 = mapCenterImgView.center.x;

final_x = touch.x - 水平偏移；

mapCenterImgView.frame = CGRectMake(final_x, 0, 320, 490);

这用于中心图像......但是平滑和滑动是无法实现的，除了当我对其他视图执行一些类似的方法时，它会导致周围完全混乱......

请提出一些改善我的状况的建议...请>>>    

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-08-11T01:51:22.090

由于您使用的是 UIImageView，因此您可以轻松使用石英的内置动画功能！

[http://www.switchonthecode.com/tutorials/creating-basic-animations-on-iphone](http://www.switchonthecode.com/tutorials/creating-basic-animations-on-iphone)

# .net - 使用 Codedom 编写 VB.Net 属性

> ID：759700
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T09:18:47.637
> 
>         
> 
> 标签：.net, vb.net, codedom

查看[MSDN](http://msdn.microsoft.com/en-us/library/system.codedom.codepropertysetvaluereferenceexpression(loband).aspx)上的示例代码：

这

```
 ' Declares a type.
    Dim type1 As New CodeTypeDeclaration("Type1")

    ' Declares a constructor.
    Dim constructor1 As New CodeConstructor
    constructor1.Attributes = MemberAttributes.Public
    type1.Members.Add(constructor1)

    ' Declares an integer field.
    Dim field1 As New CodeMemberField("System.Int32", "integerField")
    type1.Members.Add(field1)

    ' Declares a property.
    Dim property1 As New CodeMemberProperty
    property1.Name = "integerProperty"
    property1.Type = New CodeTypeReference(GetType(Integer))
    ' Declares a property get statement to return the value of the integer field.
    property1.GetStatements.Add(New CodeMethodReturnStatement(New CodeFieldReferenceExpression(New CodeThisReferenceExpression, "integerField")))
    ' Declares a property set statement to set the value to the integer field.
    ' The CodePropertySetValueReferenceExpression represents the value argument passed to the property set statement.
    property1.SetStatements.Add(New CodeAssignStatement(New CodeFieldReferenceExpression(New CodeThisReferenceExpression, "integerField"), New CodePropertySetValueReferenceExpression))
    type1.Members.Add(property1)

    Dim dump As New VBCodeProvider
    Dim gen As Compiler.ICodeGenerator = dump.CreateGenerator
    Dim opt As New Compiler.CodeGeneratorOptions

    gen.GenerateCodeFromType(type1, Console.Out, opt) 
```

应该生成

```
Public Class Type1

   Private integerField As Integer

   Public Sub New()
       MyBase.New()
   End Sub

   Private Property integerProperty() As Integer
       Get
           Return Me.integerField
       End Get
       Set(ByVal Value As Integer)
           Me.integerField = value
       End Set
   End Property
End Class 
```

但我没有看到它生成 Set 方法的参数，即我得到：

```
 Set
           Me.integerField = value
       End Set 
```

鉴于我已经必须在示例代码中添加位以实际命名属性以匹配其示例输出，我怀疑缺少导致此问题的细节，但我似乎无法追踪它？在编译代码时，如果不手动添加参数，我将无法使用属性，这在某种程度上违背了目的。知道缺少什么吗？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:51:42.983

[这篇 DevCity 文章](http://www.devcity.net/Articles/71/codedom_1.aspx)上的评论 #3表明这无关紧要，但我知道[Reflector](http://www.red-gate.com/products/reflector/)的行为确实符合您的预期，尽管它*可能*有自己的代码生成实现......

# c# - 评论接口、实现还是两者兼而有之？

> ID：759703
> 
>         
> 
> 赞同：143
> 
>         
> 
> 时间：2009-04-17T09:19:29.743
> 
>         
> 
> 标签：c#, java, comments, interface

我想我们所有人（当我们可能被打扰时！）评论我们的界面。例如

```
/// <summary>
/// Foo Interface
/// </summary>
public interface Foo
{
    /// <summary>
    /// Will 'bar'
    /// </summary>
    /// <param name="wibble">Wibble factor</param>
    void Bar(string wibble);
} 
```

您是否还评论了实现（也可以提供给客户，例如作为 aa 库的一部分）？如果是这样，您如何管理使两者保持同步？还是您只是添加“查看文档界面”评论？

谢谢

* * *

## 回答 #1

> 赞同：110
> 
>             
> 
> 时间：2009-04-17T09:27:46.697

作为一般规则，我使用与代码相同的 DRY（不要重复自己）原则：

*   在界面上，记录界面

*   在实施时，记录实施细节

**Java 特定**：在记录实现时，使用 {@inheritDoc} 标记从接口中“包含”javadocs。

了解更多信息：

*   [官方 javadoc 文档](http://java.sun.com/j2se/1.4.2/docs/tooldocs/windows/javadoc.html#inheritingcomments)

*   一些非官方的[建议](http://jtauber.com/blog/2004/05/11/inheriting_doc_in_javadoc_and_eclipse/)。

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2020-05-24T09:46:02.013

C#用法：

界面可能如下所示：

```
 /// <summary>
    /// Helper class to access various properties for the current site.
    /// </summary>
    public interface ISiteHelper
    {
        /// <summary>
        /// Gets the site id of the current site
        /// </summary>
        /// <returns>The site id.</returns>
        int GetSiteID();
    }
} 
```

实现可能如下所示：

```
/// <inheritdoc />
public class SiteHelper: ISiteHelper
{
    /// <inheritdoc />
    public int GetSiteID()
    {
        return CommonRepository.GetSiteID();
    }
} 
```

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T09:21:28.067

如果您使用[GhostDoc](http://www.roland-weigelt.de/ghostdoc/)插件，它会在您右键单击并在方法上选择“Document This”时使用界面中的注释更新实现。

* * *

## 回答 #4

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T09:26:07.527

仅限界面。注释两者是重复的，如果代码更改，这两组注释最终可能会不同步。用“implements MyInterface”评论实现......像Doxygen这样的东西会生成包含派生文档到文档中的文档以用于实现无论如何（如果您正确设置它们）。

* * *

## 回答 #5

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T09:26:42.453

对于 C# 它取决于 IMO：如果您使用显式接口实现，那么我不会记录实现。

但是，如果您直接实现接口并将接口的成员与您的对象公开，那么这些方法也必须记录在案。

正如 Nath 所说，您可以使用 GhostDoc 将接口的文档自动插入到实现中。我将 Document This 命令映射到 Ctrl+Shift+D 快捷方式，它是我几乎自动按下的击键之一。我相信 ReSharper 在为您实现方法时还可以选择插入接口的文档。

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T09:27:46.070

我们只是对接口进行注释，注释很容易与派生类或基类/接口不同步，将它放在一个地方很不错。

尽管看起来@Nath 可能会建议使用自动化文档工具来帮助将事物保持在一起（如果您使用它，听起来很酷）。在 WhereIWorkAndYouDontCare 中，注释是针对开发人员的，因此首选代码中的单个位置

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T09:23:32.510

注释接口应该是足够的文档来弄清楚如何使用实际的实现。我向实现添加注释的唯一时间是它是否具有插入以满足接口的私有函数，但是它们将是仅限内部的注释，并且不会在在线文档中看到或对客户可用。

实现就是这样，只要它们符合接口，就不需要单独记录它们。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2019-08-17T14:27:33.750

您当然可以同时评论两者，但是您会遇到维护两者的问题（如前所述）。然而，在这个时代，任何消费代码真的不会使用 IoC/DI 并且不使用接口吗？鉴于此，如果您只想打扰评论一个，我强烈建议您评论界面。这样，您的代码的使用者很可能会得到很好的智能提示。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2017-12-21T00:19:11.327

我创建了一个对 XML 文档文件进行后处理的工具，以添加对 <inheritdoc/> 标记的支持。

虽然它对源代码中的 Intellisense 没有帮助，但它确实允许将修改后的 XML 文档文件包含在 NuGet 包中，因此可以在引用的 NuGet 包中与 Intellisense 一起使用。

它位于 www.inheritdoc.io（提供免费版本）。

# asp.net - 在 iframe 中丢失会话状态，但在弹出窗口中没有

> ID：759706
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-17T09:19:53.627
> 
>         
> 
> 标签：asp.net, iframe, session-state

我们正在开发一个网上商店，并使用第三方 UI 处理付款。

我们选择在 iframe inside out 结账页面内显示支付 UI，尽管（我们现在意识到）支付解决方案提供商建议使用顶级窗口。

现在发生的情况是，在 IE7/IE8 中，支付 UI 在第一次回发（在 iframe 内）时会丢失会话状态，而在 Firefox 中，它工作得很好。我们观察到支付 UI 是使用 ASP.NET 开发的。

我的印象是，就服务器而言，从 iframe 引用与从顶级窗口引用之间没有区别，但显然是有区别的。

有人有线索吗？iframe 做了什么可能对支付服务器产生影响，导致它丢失会话状态？

会不会（我突然意识到）是 cookie 处理的差异？也许更严格的安全？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T09:37:37.967

大概是这个原因造成的：

> Internet Explorer 6 引入了对隐私首选项平台 (P3P) 项目的支持。P3P 标准指出，如果 FRAMESET 或父窗口引用 FRAME 或子窗口内的另一个站点，则子站点被视为第三方内容。Internet Explorer 使用默认的 Medium 隐私设置，默默地拒绝从第三方站点发送的 cookie。

[http://support.microsoft.com/kb/323752/en-us](http://support.microsoft.com/kb/323752/en-us)

曾经听有人说IFrame其实是IE的一个新实例，但显然它有点复杂。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:49:14.507

您可能会发现[Milan Negovan 的这篇文章](http://aspnetresources.com/blog/frames_webforms_and_rejected_cookies.aspx)有助于解释为什么框架页面会获得单独的会话 ID。文章还谈到了上面 Gerrie Schenck 提到的 P3P 解决方案。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T09:39:16.310

因此您的代码/站点的结构将类似于：

1.  站点 A 的第 1 页有一个显示站点 B 的 iframe

2.  iframe 更新，现在显示站点 A 的第 2 页

当您右键单击 iframe 的内容时，您可以验证该 url 是否对应于站点 A？

如果您调试，第 2 页是否按预期触发断点？

# c++ - 存储霍夫曼树的有效方法

> ID：759707
> 
>         
> 
> 赞同：39
> 
>         
> 
> 时间：2009-04-17T09:20:19.850
> 
>         
> 
> 标签：c++, performance, huffman-code

我正在编写一个霍夫曼编码/解码工具，并且正在寻找一种有效的方法来存储为存储在输出文件内部而创建的霍夫曼树。

目前我正在实施两个不同的版本。

1.  这将整个文件逐个字符读入内存，并为整个文件建立一个频率表。这只需要输出一次树，因此效率不是那么大，除非输入文件很小。

2.  我正在使用的另一种方法是读取一块大小约为 64 KB 的数据，然后对其进行频率分析，创建一棵树并对其进行编码。但是，在这种情况下，在每个块之前，我需要输出我的频率树，以便解码器能够重新构建其树并正确解码编码文件。这是效率确实到位的地方，因为我想节省尽可能多的空间。

到目前为止，在我的搜索中，我还没有找到一种将树存储在尽可能小的空间中的好方法，我希望 StackOverflow 社区可以帮助我找到一个好的解决方案！

* * *

## 回答 #1

> 赞同：89
> 
>             
> 
> 时间：2009-04-17T09:38:28.713

由于您已经必须实现代码以在字节组织的流/文件之上处理按位层，因此这是我的建议。

不要存储实际频率，解码不需要它们。但是，您确实需要实际的树。

所以对于每个节点，从根开始：

1.  如果叶子节点：输出 1 位 + N 位字符/字节

2.  如果不是叶节点，则输出 0 位。然后以相同的方式对两个子节点（先左后右）进行编码

要阅读，请执行以下操作：

1.  读位。如果为 1，则读取 N 位字符/字节，返回没有子节点的新节点

2.  如果位为 0，则以相同的方式解码左右子节点，并返回带有这些子节点的新节点，但没有值

叶节点基本上是任何没有子节点的节点。

使用这种方法，您可以在编写输出之前计算输出的确切大小，以确定收益是否足以证明努力的合理性。这假设您有一个键/值对字典，其中包含每个字符的频率，其中频率是实际出现的次数。

计算伪代码：

```
Tree-size = 10 * NUMBER_OF_CHARACTERS - 1
Encoded-size = Sum(for each char,freq in table: freq * len(PATH(char))) 
```

树大小的计算考虑了叶节点和非叶节点，并且内联节点比字符数少一个。

SIZE_OF_ONE_CHARACTER 将是位数，这两个将为您提供我对树的方法 + 编码数据将占用的总位数。

PATH(c) 是一个函数/表，它将产生从根到树中该字符的位路径。

这是一个看起来像 C# 的伪代码，它假设一个字符只是一个简单的字节。

```
void EncodeNode(Node node, BitWriter writer)
{
    if (node.IsLeafNode)
    {
        writer.WriteBit(1);
        writer.WriteByte(node.Value);
    }
    else
    {
        writer.WriteBit(0);
        EncodeNode(node.LeftChild, writer);
        EncodeNode(node.Right, writer);
    }
} 
```

要读回它：

```
Node ReadNode(BitReader reader)
{
    if (reader.ReadBit() == 1)
    {
        return new Node(reader.ReadByte(), null, null);
    }
    else
    {
        Node leftChild = ReadNode(reader);
        Node rightChild = ReadNode(reader);
        return new Node(0, leftChild, rightChild);
    }
} 
```

一个示例（简化、使用属性等）节点实现：

```
public class Node
{
    public Byte Value;
    public Node LeftChild;
    public Node RightChild;

    public Node(Byte value, Node leftChild, Node rightChild)
    {
        Value = value;
        LeftChild = leftChild;
        RightChild = rightChild;
    }

    public Boolean IsLeafNode
    {
        get
        {
            return LeftChild == null;
        }
    }
} 
```

* * *

这是来自特定示例的示例输出。

输入： AAAAAAABCCCCCCDDEEEEE

频率：

*   答：6

*   乙：1

*   C: 6

*   D: 2

*   E：5

每个字符只有 8 位，因此树的大小将是 10 * 5 - 1 = 49 位。

树可能如下所示：

```
 20
  ----------
  |        8
  |     -------
 12     |     3
-----   |   -----
A   C   E   B   D
6   6   5   1   2 
```

所以每个字符的路径如下（0为左，1为右）：

*   答：00

*   乙：110

*   C: 01

*   D: 111

*   E：10

所以要计算输出大小：

*   答：6 次出现 * 2 位 = 12 位

*   B：1 次出现 * 3 位 = 3 位

*   C：6 次出现 * 2 位 = 12 位

*   D：2 次出现 * 3 位 = 6 位

*   E：5 次出现 * 2 位 = 10 位

编码字节的总和为 12+3+12+6+10 = 43 位

将其添加到树中的 49 位，输出将是 92 位或 12 个字节。与存储未编码的原始 20 个字符所需的 20 * 8 字节相比，您将节省 8 个字节。

最终输出，包括开始的树，如下所示。流 (AE) 中的每个字符都被编码为 8 位，而 0 和 1 只是一个位。流中的空间只是将树与编码数据分开，在最终输出中不占用任何空间。

```
001A1C01E01B1D 0000000000001100101010101011111111010101010 
```

* * *

对于您在评论中的具体示例 AABCDEF，您将得到以下信息：

输入：AABCDEF

频率：

*   A2

*   乙：1

*   C: 1

*   D: 1

*   E：1

*   女：1

树：

```
 7
  -------------
  |           4
  |       ---------
  3       2       2
-----   -----   -----
A   B   C   D   E   F
2   1   1   1   1   1 
```

路径：

*   答：00

*   乙：01

*   C: 100

*   D: 101

*   E: 110

*   女：111

树：001A1B001C1D01E1F = 59 位

数据：000001100101110111 = 18 位

总和：59 + 18 = 77 位 = 10 字节

由于原来是 8 位 = 56 的 7 个字符，因此您将有太多这样的小数据的开销。

* * *

## 回答 #2

> 赞同：12
> 
>             
> 
> 时间：2009-06-02T22:04:28.320

如果您对树的生成有足够的控制权，则可以使其成为规范树（例如，与[DEFLATE](https://en.wikipedia.org/wiki/DEFLATE)相同），这基本上意味着您创建规则来解决构建树时的任何模棱两可的情况。然后，就像 DEFLATE 一样，您实际需要存储的只是每个字符的代码长度。

也就是说，如果你有上面提到的树/代码 Lasse：

*   答：00

*   乙：110

*   C: 01

*   D: 111

*   E：10

然后你可以将它们存储为：2、3、2、3、2

这实际上是足够的信息来重新生成霍夫曼表，假设您总是使用相同的字符集——比如 ASCII。（这意味着你不能跳过字母——你必须为每个字母列出一个代码长度，即使它是零。）

如果您还限制了位长度（例如 7 位），则可以使用短二进制字符串存储这些数字中的每一个。所以 2,3,2,3,2 变成 010 011 010 011 010 - 适合 2 个字节。

如果你想变得*非常*疯狂，你可以做 DEFLATE 所做的事情，并为这些代码的长度制作另一个霍夫曼表，并预先存储它的代码长度。特别是因为他们添加了“连续插入零 N 次”的额外代码以进一步缩短内容。

如果您已经熟悉霍夫曼编码，则 DEFLATE 的 RFC 还不错：   [http ://www.ietf.org/rfc/rfc1951.txt](http://www.ietf.org/rfc/rfc1951.txt)

* * *

## 回答 #3

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T09:32:05.750

分支是0叶子是1。首先遍历树深度以获得它的“形状”

```
e.g. the shape for this tree

0 - 0 - 1 (A)
|    \- 1 (E)
  \
    0 - 1 (C)
     \- 0 - 1 (B)
         \- 1 (D)

would be 001101011 
```

紧随其后的是相同深度一阶 AECBD 中的字符位（阅读时您会知道从树的形状中期望有多少字符）。然后输出消息的代码。然后，您将拥有一长串位，您可以将其划分为字符以进行输出。

如果您正在对其进行分块，您可以测试为下一个块存储树与为前一个块重用树一样有效，并且树形状为“1”作为仅重用来自前一个块的树的指示符.

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:29:25.240

树通常是从字节的频率表中创建的。因此，存储该表，或者仅存储按频率排序的字节本身，然后即时重新创建树。这当然假设您正在构建树以表示单个字节，而不是更大的块。

**更新**：正如 j_random_hacker 在评论中指出的那样，您实际上不能这样做：您需要频率值本身。当您构建树时，它们会组合并向上“冒泡”。[本页](http://www.siggraph.org/education/materials/HyperGraph/video/mpeg/mpegfaq/huffman_tutorial.html)描述了从频率表构建树的方式。作为奖励，它还通过提到一种保存树的方法来避免删除这个答案：

> > > 输出霍夫曼树本身的最简单方法是，从根开始，先转储左侧，然后转储右侧。对于每个节点，您输出一个 0，对于每个叶子，您输出一个 1，后跟 N 位表示该值。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2013-08-15T03:36:29.143

更好的方法

树：

```
 7
     -------------
     |           4
     |       ---------
     3       2       2
   -----   -----   -----
   A   B   C   D   E   F
   2   1   1   1   1   1 : frequencies
   2   2   3   3   3   3 : tree depth (encoding bits) 
```

现在只需导出此表：

```
 depth number of codes
   ----- ---------------
     2   2 [A B]
     3   4 [C D E F] 
```

您不需要使用相同的二叉树，只需保留计算出的树深度，即编码位数。所以只需保持未压缩值的向量 [ABCDEF] 按树深度排序，使用相对索引而不是这个单独的向量。现在为每个深度重新创建对齐的位模式：

```
 depth number of codes
   ----- ---------------
     2   2 [00x 01x]
     3   4 [100 101 110 111] 
```

您立即看到的是，只有每行中的第一位模式是重要的。您将获得以下查找表：

```
 first pattern depth first index
    ------------- ----- -----------
    000           2     0
    100           3     2 
```

这个 LUT 的尺寸非常小（即使你的 Huffman 代码可以是 32 位长，它也只会包含 32 行），实际上第一个模式始终为空，在执行模式的二分查找时可以完全忽略它在其中（这里只需要比较一个模式以了解位深度是 2 还是 3，并获得关联数据存储在向量中的第一个索引）。在我们的示例中，您需要在最多 31 个值的搜索空间中执行输入模式的快速二进制搜索，即最多 5 个整数比较。这 31 个比较例程可以在 31 个代码中进行优化，以避免所有循环，并且在浏览整数二叉查找树时必须管理状态。所有这个表都适合小的固定长度（对于不超过 32 位的 Huffman 代码，LUT 最多只需要 31 行，

换句话说，上面的 LUT 每个需要 31 个 32 位大小的整数，32 个字节来存储位深度值：但是您可以通过暗示深度列（以及深度 1 的第一行）来避免这种情况：

```
 first pattern (depth) first index
    ------------- ------- -----------
    (000)          (1)    (0)
     000           (2)     0
     100           (3)     2
     000           (4)     6
     000           (5)     6
     ...           ...     ...
     000           (32)    6 
```

所以你的 LUT 包含 [000, 100, 000(30times)]。要在其中搜索，您必须找到输入位模式在两个模式之间的位置：它必须低于此 LUT 中下一个位置的模式，但仍高于或等于当前位置的模式（如果两个位置包含相同的模式，当前行将不匹配，输入模式适合下面）。然后你将分而治之，最多使用 5 次测试（二分查找需要单个代码，其中嵌入了 5 个 if/then/else 嵌套级别，它有 32 个分支，达到的分支直接指示不存在的位深度需要存储；然后您对第二个表执行单个直接索引查找以返回第一个索引；您在解码值向量中附加地导出最终索引）。

一旦您在查找表中获得一个位置（在第一列中搜索），您就会立即获得从输入中获取的位数，然后是向量的起始索引。通过减去第一个索引后的基本位掩码，您获得的位深度可用于直接导出调整后的索引位置。

总之：永远不要存储链接的二叉树，并且您不需要任何循环来执行查找，它只需要 5 个嵌套的 if 比较 31 个模式表中固定位置的模式，以及一个包含起始偏移量的 31 个整数表解码值的向量（在嵌套 if/then/else 测试的第一个分支中，向量的起始偏移量是隐含的，它始终为零；它也是最频繁的分支，因为它匹配最短的代码这是最常见的解码值）。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2021-08-24T15:24:41.760

有两种主要方法可以将霍夫曼代码 LUT 存储为其他答案状态。您可以存储树的几何形状，0 表示节点，1 表示叶子，然后放入所有叶子值，或者您可以使用规范的霍夫曼编码，存储霍夫曼代码的长度。

问题是，根据情况，一种方法比另一种方法更好。假设您要压缩的数据中唯一符号的数量（`aabbbcdddd`，有 4 个唯一符号，`a, b, c, d`）是`n`。

沿着树中的符号存储树的几何形状的位数是`10n - 1`。

假设您按照代码长度的符号顺序存储代码长度，并且代码长度为 8 位（256 个符号字母的代码长度不会超过 8 位），代码长度表的大小将是平坦的 2048 位。

当您有大量唯一符号（例如 256 个）时，将需要 2559 位来存储树的几何形状。在这种情况下，码长表的效率要高得多。准确地说，511 位更有效。

但是如果你只有 5 个唯一的符号，那么树几何结构只需要 49 位，在这种情况下，与存储代码长度表相比，存储树几何结构几乎要好 2000 位。

树几何对 最有效`n < 205`，而代码长度表对 更有效`n >= 205`。那么，为什么不两全其美，并使用两者呢？在压缩数据的开头有 1 位表示下一个无论多少位将采用代码长度表的格式，还是哈夫曼树的几何形状。

其实为什么不加两位呢，当都为0的时候，没有表，数据是未压缩的。因为有时，您无法获得压缩！最好在文件开头有一个 0x00 字节，告诉解码器不要担心做任何事情。通过不包括表或树的几何图形来节省空间，并节省时间，不必不必要地压缩和解压缩数据。

# java - DTO、DAO 和 DCO。什么是 DCO？

> ID：759708
> 
>         
> 
> 赞同：15
> 
>         
> 
> 时间：2009-04-17T09:20:21.813
> 
>         
> 
> 标签：java, terminology, acronym

我对 DCO 含义的搜索毫无结果，所以我决定在这里问。在我的 Java 应用程序中，有很多类，如 EmployeeDetailsDto、EmployeeDetailsDao，但最近我也遇到了 EmployeeDetailsDco。有谁知道DCO代表什么？

* * *

## 回答 #1

> 赞同：27
> 
>             
> 
> 时间：2009-04-17T09:34:06.727

> DTO =[数据传输对象](http://msdn.microsoft.com/en-us/library/ms978717.aspx)
> 
>   
>   
> 
> DAO =[数据访问对象](http://java.sun.com/blueprints/patterns/DAO.html)
> 
>   
>   
> 
> DCO = 
>   [动态可配置对象](http://209.85.229.132/search?q=cache:21UeLR983rEJ:legion.virginia.edu/WinterWorkshop/slides/Class_System/class_system.PPT+Dynamically+Configurable+object+dco&cd=2&hl=en&ct=clnk)？

从[文章](http://209.85.229.132/search?q=cache:21UeLR983rEJ:legion.virginia.edu/WinterWorkshop/slides/Class_System/class_system.PPT+Dynamically+Configurable+object+dco&cd=2&hl=en&ct=clnk)

### 动态可配置对象 (DCO)

一个对象，其实现在运行后可以增量更改

*   由界面元素组成

*   公共职能

*   私有函数

*   私有数据以及所有访问函数

*   成员函数支持对界面元素的增量更改

*   添加、删除或更改

* * *

## 回答 #2

> 赞同：5
> 
>             
> 
> 时间：2009-04-20T15:44:12.413

我刚刚和那个曾经记得这代表什么的人交谈过。具有讽刺意味的是，他不再这样做了。这家公司的任何其他人也没有。

我能找到的解释是，它基本上是一个 DTO，但他们想使用 DCO 来区分 Hibernate 使用的 DTO 和外部系统使用的 DCO，在本例中是 LDAP。

所以我相信，正如 Bhushan 所暗示的那样，DCO 的含义实际上可能是 Data Carrying object 或类似的东西，在这种情况下，它确实只是 DTO 的另一个名称。回答接受。谢谢你的时间！我以为 DCO 是开发人员广泛使用的公认首字母缩略词，但事实证明就是这样……抱歉。

**编辑**

* * *

对于那些感兴趣的人来说，答案是数据容器对象。我在公司引起了足够的轰动，所以最终一位同事通过电子邮件向 DCO 术语的本地发起者发送了电子邮件，如果有人仍然想知道，它代表**Data Container Object**。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:56:50.510

我只能说数据携带对象不是DCO的意思，将“数据携带对象”放在谷歌中，它不会返回任何命中。

因此，条款必须是错误的。

好的，尝试谷歌搜索“数据对象 DCO”

并得到了这个[结果](http://seer.entsupport.symantec.com/docs/239883.htm)，这表明 DCO 的意思是“数据更改对象”

我的猜测是 DCO 是一个保存对象数据更改的对象，即“差异”。

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:37:09.263

重构 Dto 并删除 DTO 后缀。

您可能希望将 Dao 更改为 Store 或类似的东西。

首先，最后没有 Dto/dco 的 EmployeeSetails 显然是一个持有与员工相关的值的值类。如果没有另一个术语，很明显它不是一个实用程序——它应该被称为诸如 EmployeeDetailsUtil/Helper 之类的东西。

您的 dao 应该被称为 EmployeeSetailsS​​tore，因为它描述了它的功能，即 EmployeeSetsils 的存储。将它们放置在何处或放置在何处无关紧要，它们隐藏在您的代码中。如果你真的想要，如果它使用 Hibernate，你可以称它为 HibernateEmploteeDetaileStore 等。您的接口应称为 EmployeeSetailsS​​tore。实现者或此接口将使用接口名称作为开始并将 impl 技术添加到该基本名称。

最后但并非最不重要的一点是，这里的 String 是一个 char 数组的值，但在这种情况下添加 Dto 是丑陋而愚蠢的。

只能使用像 Url 这样众所周知的首字母缩略词。最后，商店永远不会令人困惑，而您提到的所有首字母缩略词并没有使事情变得更清楚，并且在这种情况下引入了 co fusion 和这个涂层时间。

如果您使用我建议的内容来衡量打字，那么您实际上输入的字符更少，一切都会更清晰。毕竟我们都是快速打字员，所以总是以清晰而不是简洁为目标，所以还有一些额外的字符。最后，我们花更多的时间阅读、理解等而不是打字，所以在类名中添加一些额外的字符根本不会降低生产力......

不要吝啬……从一开始就做好。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T09:25:01.633

我从未听说过 DCO，但它是否只是 DTO 的另一个名称？

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T09:39:08.087

这可能是命令对象。

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2020-08-27T00:16:34.413

我使用 DCO 作为数据转换对象。

例如，您有：

1.  用于`dto.User`通过网络传输用户（例如，使用 Jackson 注释并映射到 JSON 接口）和：

2.  用于`dao.User`将用户存储在数据库中（例如，使用 JPA 注释并映射到具有来自 JSON 传输对象的不同字段和格式的遗留数据库）

您需要在两者之间进行转换。

与其在不属于它们的 DTO 或 DAO 中编写该转换逻辑，不如将它们放在 DCO 中。

所以你有`dco.User`：

```
package com.mycompany.myapp.dco;

// converts between data access objects (DAOs) and data transfer objects (DTOs).
public class User {
    com.mycompany.myapp.dao.User toDao(com.mycompany.myapp.dto.User) {
        // dto to dao conversion.
    }

    // could call this method fromDao if that is preferred.
    com.mycompany.myapp.dto.User toDto(com.mycompany.myapp.dao.User) {
        // dao to dto conversion.
    }
} 
```

然后，您可以轻松实现和测试转换，并在整个服务层需要它们的任何地方调用它们。

当您需要在模型和视图模型之间进行转换时，这种模式的另一种用法可能是在 UI 的[模型视图视图模型 MVVM架构中。](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel)在这种情况下，视图模型与视图绑定，并且可以由用户在 UI 中直接操作进行更改，但模型保持独立，例如当您想要加载或保存更改到磁盘时。在这种情况下，提供数据转换对象（我称之为 DCO）可以帮助在相似事物的两种不同表示之间来回转换。

注意，在这种理解下，DCO 实际上只是一组函数，而不是一个有状态的对象。因此，您可以将其称为 DataConvertor，或者您可以将所有转换函数放在一个工厂类中，用于您需要转换的所有对象的整个域层（如果您愿意）。

这只是我有时会做的事情，不一定是标准。其他人可能会使用 DCO 来代表其他东西。

# c# - 从 C# 源文件中提取文档注释

> ID：759714
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-17T09:22:18.363
> 
>         
> 
> 标签：c#, visual-studio, documentation, comments

有谁知道任何工具可以让您直接从 .cs 文件中提取评论到一些简单的文本甚至剪贴板中？如果这样的工具也可以在方法级别上工作，那就更好了。

我**不是**在寻找像 Sandcastle 这样在构建时工作的东西，我在寻找适用于单个源代码文件的东西。基本上我需要将一大块方法签名和相关的文档注释复制到一个文本文件中，但是我厌倦了删除“///”并重新格式化这些行。我希望能够右键单击一个方法并在“将文档复制到剪贴板”的行中有一个上下文菜单项。

有没有这样的工具？

* * *

## 回答 #1

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T13:10:55.067

我刚刚写了一个工具来做到这一点。它只是几行代码，还没有完成，但扩展起来非常简单（我明天可能会在某个地方这样做）。  

结果：只需从菜单中单击提取，结果将显示在**剪贴板**上。

![替代文字](https://lh3.ggpht.com/_0JKcAS7pLxo/Seh-4axt0SI/AAAAAAAABtU/IH0lM88MFwI/extractComments.jpg)

两个非常简单的步骤：

1.  编写一个以文件为参数的程序，从该文件中获取一些文本并将它们粘贴到剪贴板。

2.  将该程序集成到您的 IDE 中。  

**第 1 步，第 1 部分**
主程序，获取文件，将其发送到“提取器”并将结果写入剪贴板。

```
class Program
{
    [STAThread] 
    static void Main(string[] args)
    {           
        if (args.Length == 0) return;
        FileInfo f = new FileInfo(args[0]);
        Extracter e = new Extracter(f.OpenText().ReadToEnd());
        Clipboard.SetText(e.GetExtractedText());
    }
} 
```

**第 1 部分，第 2 部分**
提取器：当然使用正则表达式从中获取您需要的所有文本模式，并返回符合要求的字符串。我已经省略了帖子密度的评论，因为原理很简单并且已经解释过。

```
public class Extracter
    {
        private Regex re;
        // extend/adapt regex patterns for better result.
        const String RE_COMMENT_AND_NEXT_LINE= @"(?<=([\/]{3})).+";

        public string FileText { get; set; }

        public Extracter(String FileText)
        {
            this.FileText = FileText;
        }

        public String GetExtractedText() 
        {
            StringBuilder sb = new StringBuilder(String.Empty);
            re = new Regex(RE_COMMENT_AND_NEXT_LINE);
            foreach (Match match in  re.Matches(FileText))
            {
                sb.Append(match.ToString());
            }
            return sb.ToString();

        }
    } 
```

**第 2 步：添加到 IDE**

IDE 依赖当然，但总是很容易。请参阅我的 VS2008 屏幕截图：

![替代文字](https://lh4.ggpht.com/_0JKcAS7pLxo/SeiCha3GZwI/AAAAAAAABtc/JDd85aKfEOw/externalTools.jpg)

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-29T15:40:10.260

无需自己动手，看看[cr-documentor](http://code.google.com/p/cr-documentor/)。

> CR_Documentor 是 DXCore 的一个插件，
>   [它](http://www.devexpress.com/Downloads/NET/IDETools/DXCore/)允许您在 Visual Studio 的工具窗口中预览文档在渲染时的外观。

它工作得很好，但我怀疑它与 Resharper 一起运行有点不稳定，所以我禁用它直到我使用它。

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T13:23:45.583

评论表单 .cs 文件会自动转到 xml 文件。以下是说明：

*   打开项目属性 -> 构建

*   转到底部，有“输出”部分

*   启用“XML 文档文件”复选框并设置此文件的输出路径

*   当您构建代码时，此文件会将您的代码的所有文档复制到其中。

从项目中获得所有评论后，您可以随心所欲地使用它。

[http://msdn.microsoft.com/en-us/magazine/cc302121.aspx](http://msdn.microsoft.com/en-us/magazine/cc302121.aspx)

推荐：

您可以在日常工作中禁用它，就像项目大小增加一样，在构建过程中需要时间来生成此文件，因为它需要填充所有注释。只需在发布代码时运行，以便获得所有文档。

# java - 如何在 JAVA 中从 MySQL 获取当前年份和月份？

> ID：759715
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T09:23:17.690
> 
>         
> 
> 标签：java, mysql

我想从 MySQL 中获取当前年份和月份的记录。

我正在通过获取今天的记录

今天：("recDate","=", new Date());

像这样，如何获取当前月份和当前年份？

提前致谢

*   格纳尼亚尔祖拜尔

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T09:36:55.037

不需要传递参数，MySQL 可以自己计算出当前的年份和月份：

```
SELECT * FROM table
WHERE  YEAR(recDate) =  YEAR(CURDATE())
  AND MONTH(recDate) = MONTH(CURDATE()) 
```

或者，或者，

```
SELECT * FROM table
WHERE DATE_FORMAT(recDate, '%Y%m') = DATE_FORMAT(NOW(), '%Y%m') 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:27:39.770

```
import java.util.Calendar;

public class CalendarExample
{
    public static void main(String[] args)
    {
        Calendar cal = Calendar.getInstance();
        int day = cal.get(Calendar.DATE);
        int month = cal.get(Calendar.MONTH) + 1;
        int year = cal.get(Calendar.YEAR);
        int dow = cal.get(Calendar.DAY_OF_WEEK);
        int dom = cal.get(Calendar.DAY_OF_MONTH);
        int doy = cal.get(Calendar.DAY_OF_YEAR);

        System.out.println("Current Date: " + cal.getTime());
        System.out.println("Day: " + day);
        System.out.println("Month: " + month);
        System.out.println("Year: " + year);
        System.out.println("Day of Week: " + dow);
        System.out.println("Day of Month: " + dom);
        System.out.println("Day of Year: " + doy);
    }
} 
```

下面是这个例子的结果：

当前日期：星期四 12 月 29 日 13:41:09 ICT 2005 日期：29 月：12 年：2005 星期几：5 月份日期：29 一年中的日期：363

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T09:32:08.027

我不知道 mysql 中的确切功能，但你用谷歌搜索它们。在 Java 代码中的 SQL 中，在日期列上使用 CONVERT 函数并将其等同于当前日期，该日期也使用 convert 函数。Convert 函数会将日期缩减为仅月份和年份，这样它将仅作为字符串进行比较。

# c# - 有没有一种自动处理数组和强类型集合之间转换的好方法？

> ID：759718
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T09:24:32.927
> 
>         
> 
> 标签：c#, collections

背景：

我有一个很大的解决方案，其中数百个函数将强类型集合作为参数并将它们用作返回值。

该解决方案引用了一个生成的代理，它将调用转换为总是以 int[] 或 Order[] 格式返回集合的 web 服务，或者无论它是什么类型。代理将它们包装为 IntCollection 或 OrderCollection。

现在我想直接引用程序集。当我这样做时，我得到了针对数组的接口，而不是代理生成的强类型集合。这当然会破坏所有代码。

我正在寻找一种聪明的方法来处理这个问题并避免重写数千行代码。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:36:08.627

`IntCollection`etc属于你吗？您可以添加一个隐式转换运算符：

```
class IntCollection : Collection<int> {
    public IntCollection() : base() { }
    public IntCollection(IList<int> data) : base(data) { }
    public static implicit operator int[](IntCollection items) {
        return items.ToArray(); // LINQ, but can do manually
    }
    public static implicit operator IntCollection (int[] items){
         return new IntCollection(items);
    }
} 
```

通常，这将是接口（`IList<Foo>`等）帮助的时间之一——但接口在 Web 服务中通常不能很好地工作。根据代码当前的功能，您可能可以进行“全部替换”修复 - 不过有点激烈；除此之外...您将不得不更改奇数位的代码。

一些想法：

*   切换到`var`（在 C# 3.0 中）可能会使更改最小化 - 即`var orders = svc.GetOrders()`；在大多数情况下，不同的实现会有“足够相似”的 API

    *   resharper 可能会对此有所帮助

*   使用 LINQ ( `.ToList()`, `.ToArray()`) 可能充当 shim

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T09:26:29.880

从数组创建强类型集合。例如，您可以从数组创建通用列表。

```
int[] oIntArray;
List<int> = new List<int>(oIntArray); 
```

# apache-flex - Flash 网格补间/动画

> ID：759719
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T09:24:58.653
> 
>         
> 
> 标签：apache-flex, flash, actionscript-3, papervision3d, mesh

**有没有办法在 Flash 创作工具中正确补间/动画网格？**

补间形状不识别特定顶点的移动，不保留连接并且通常会搞砸。对于任何重要的网格来说，形状提示都太少了，而且无论如何都要耗费太多的体力劳动。

我正在尝试在两个网格形状之间完成平滑动画，但保留了所有点和顶点，并且没有添加新的点/顶点。

有问题的网格是严格的 2D 的，但我不介意该解决方案是否需要 Actionscript/Papervision3D 协助，尽管关键帧网格状态的创作需要在 Flash 创作工具中以交互方式完成（过于复杂的形状/运动无法手动编码）。

*想法？*

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T09:47:11.250

根据动画，骨骼可能会有所帮助。虽然您需要 Flash CS4 才能使用它们。它们可从标准工具栏中获得。

# java - java中的openssl des3解密

> ID：759722
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T09:25:38.697
> 
>         
> 
> 标签：java

有没有办法解密使用 openssl -des3 enc 命令加密的文件。openssl究竟是如何使用密码和盐来制作密钥的？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T19:43:00.693

OpenSSL 的`enc`实用程序对密码使用非标准（和低质量）的密钥派生算法。以下代码显示了`enc`实用程序如何在给定盐和密码的情况下生成密钥和初始化向量。请注意，在指定选项`enc`时将“salt”值存储在加密文件`-salt`中（这对于安全性至关重要）。

```
public InputStream decrypt(InputStream is, byte[] password)
  throws GeneralSecurityException, IOException
{
  /* Parse the "salt" value from the stream. */
  byte[] header = new byte[16];
  for (int idx = 0; idx < header.length;) {
    int n = is.read(header, idx, header.length - idx);
    if (n < 0)
      throw new EOFException("File header truncated.");
    idx += n;
  }
  String magic = new String(header, 0, 8, "US-ASCII");
  if (!"Salted__".equals(magic))
    throw new IOException("Expected salt in header.");

  /* Compute the key and IV with OpenSSL's non-standard method. */
  SecretKey secret;
  IvParameterSpec iv;
  byte[] digest = new byte[32];
  try {
    MessageDigest md5 = MessageDigest.getInstance("MD5");
    md5.update(password);
    md5.update(header, 8, 8);
    md5.digest(digest, 0, 16);
    md5.update(digest, 0, 16);
    md5.update(password);
    md5.update(header, 8, 8);
    md5.digest(digest, 16, 16);
    iv = new IvParameterSpec(digest, 24, 8);
    DESedeKeySpec keySpec = new DESedeKeySpec(digest);
    SecretKeyFactory factory = SecretKeyFactory.getInstance("DESede");
    secret = factory.generateSecret(keySpec);
  }
  finally {
    Arrays.fill(digest, (byte) 0);
  }

  /* Initialize the cipher. */
  Cipher cipher = Cipher.getInstance("DESede/CBC/PKCS5Padding");
  cipher.init(Cipher.DECRYPT_MODE, secret, iv);
  return new CipherInputStream(is, cipher);
} 
```

此密钥和 IV 生成在[`EVP_BytesToKey(3)`文档中进行了描述。](http://www.openssl.org/docs/crypto/EVP_BytesToKey.html)该`enc`命令`1`用作迭代`count`（这是一个坏主意，并在我的版本的手册页中注明为一个错误`enc`），并使用 MD5 作为摘要算法——一种“损坏的”算法。

目前尚不清楚 OpenSSL 如何将文本密码转换为字节。我猜它使用默认的平台字符编码。因此，如果您被`String`密码困住（不好，因为它不能“归零”），您可以调用[`password.getBytes()`](http://java.sun.com/javase/6/docs/api/java/lang/String.html#getBytes())将其转换为`byte[]`.

如果可以，请使用 Java 6[`Console`](http://java.sun.com/javase/6/docs/api/java/io/Console.html#readPassword())或 Swing 之类的工具[`JPasswordField`](http://java.sun.com/javase/6/docs/api/javax/swing/JPasswordField.html)来获取密码。这些返回一个数组，因此您可以在完成后从内存中“删除”密码：[`Arrays.fill(password, '\0');`](http://java.sun.com/javase/6/docs/api/java/util/Arrays.html#fill(char[],%20char))

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2011-03-16T22:40:39.250

谢谢你，埃里克森，你的帖子。它极大地帮助我尝试重新创建 openssl 的密钥和 IV 例程密码。  

我最终得到了一些稍微不同的东西，可能是因为我需要解密河豚加密的数据而不是 DES。见下文。

我还发现 openssl 在遇到字节 00、0a 或 0d 时会停止读取密码。一般来说，我认为 openssl 只读取字节 11 和 127 之间的密码字符。因此对于下面的示例，我有在此之前的代码，如果它包含 00、0a 或 0d，则截断密码。

```
 /* Compute the key and IV with OpenSSL's non-standard method. */
     final byte[] digest = new byte[32];
     final MessageDigest md5 = MessageDigest.getInstance("MD5");
     md5.update(password, 0);
     // append the salt
     md5.update(salt);
     // run the digest and output 16 bytes to the first 16 bytes to the digest array. Digest is reset
     md5.digest(digest, 0, 16);
     // write the first 16 bytes from the digest array back to the buffer
     md5.update(digest, 0, 16);
     // append the password
     md5.update(password, 0);
     // append the salt
     md5.update(salt);
     // run the digest and output 16 bytes to the last 16 bytes of the digest array
     md5.digest(digest, 16, 16);
     key = Arrays.copyOfRange(digest, 0, 16);
     iv = Arrays.copyOfRange(digest, 16, 24); 
```

上面的代码可以使用 org.bouncycastle.crypto.generators.OpenSSLPBEParametersGenerator 替换为 3 行。它成为了

```
final OpenSSLPBEParametersGenerator generator = new OpenSSLPBEParametersGenerator();
generator.init(password, salt);
final ParametersWithIV ivParam = (ParametersWithIV)generator.generateDerivedParameters(16, 8);
final KeyParameter keyParameter = (KeyParameter)ivParam.getParameters(); 
```

# c++ - 问题嵌套 boost::lambda::bind-s

> ID：759728
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T09:27:20.037
> 
>         
> 
> 标签：c++, boost-lambda

我有一个通用功能：

```
void ImageAlbum::ExpressButtonPressed(
    boost::function<
        void (
            thumb::PhotoPrintThumbnail*,
            thumb::PhotoPrintFormat,
            thumb::PhotoPrintQuantity
        )
    > memberToCall
) {
    ...

    BOOST_FOREACH(thumb::PhotoPrintThumbnail *pThumbnail, m_thumbs.GetSelected()) {
    memberToCall(
            pThumbnail,
            m_expressSel.GetSelectedFormat(),
            m_expressSel.GetSelectedQuantity()
        );
    }

    ...
} 
```

我可以成功调用：

```
ExpressButtonPressed(boost::bind(&thumb::PhotoPrintThumbnail::AddQuantity, _1, _2, _3)); 
```

然后，我需要将它们全部替换为一种格式，而不是向缩略图中添加一定数量的某种格式。更准确地说，使用 1 个元素的列表，如下所示：

```
ExpressButtonPressed(
    boost::lambda::bind(
        &thumb::PhotoPrintThumbnail::SetFormats,
        _1,
        boost::lambda::bind(
            boost::lambda::constructor<thumb::PhotoPrintThumbnail::LoadedFormats>(),
            1,
            boost::lambda::bind(
                boost::lambda::constructor<thumb::PhotoPrintThumbnail::LoadedFormat>(),
                _2,
                _3
            )
        )
    )
); 
```

这导致“boost/lambda/detail/actions.hpp(96) : error C2665: 'boost::lambda::function_adaptor::apply' : 2 个重载都不能转换所有参数类型”。

我在这里做错了什么？

顺便提一句

```
class PhotoPrintThumbnail {
public:
...
    typedef std::pair<PhotoPrintFormat, PhotoPrintQuantity> LoadedFormat;
    typedef std::list<LoadedFormat> LoadedFormats;
    void SetFormats(const LoadedFormats &formats); 
```

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T19:57:36.837

您是否碰巧在使用 lambda 的代码中使用了 #include boost/bind.hpp？这将导致对占位符（_1、_2 等）的不合格使用解析为由 Boost.Bind 定义的那些，并且这些与 Boost.Lambda 不能很好地混合。

重写代码以显式使用 boost::lambda::_[1,2,3] 而不是非限定名称在我的 VC 7.1 设置中编译得很好。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T12:52:21.243

不确定您使用的是什么版本的 Boost 或什么编译器。使用 boost 1.37 和 VS2005 我可以得到同样的错误。我怀疑可能是模板扩展的核心错误导致了 SFINAE 问题。

例如取出最里面的表达式：

```
boost::function<
    PhotoPrintThumbnail::LoadedFormat (
            PhotoPrintFormat,
            PhotoPrintQuantity
    )
> func = boost::lambda::bind
                ( boost::lambda::constructor<PhotoPrintThumbnail::LoadedFormat>()
                , _1
                , _2
                ); 
```

这对我来说看起来不错，但也失败了，尽管有：

std::pair<_Ty1,_Ty2>::pair' ：3 个重载都不能转换所有参数类型

错误。

当然你可以使用：

```
void func
( PhotoPrintThumbnail* ppt
, const PhotoPrintFormat& ppf
, const PhotoPrintQuantity& ppq
)
{
    ppt->SetFormats (PhotoPrintThumbnail::LoadedFormats (1, PhotoPrintThumbnail::LoadedFormat (ppf, ppq)));
}

ExpressButtonPressed (func); 
```

这更清晰*并且可以编译*。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T12:58:49.527

我认为在第一次绑定时，您应该将构造的对象（由第二次绑定产生）绑定为方法的第一个参数（它应该是构造对象的地址）：

```
ExpressButtonPressed(
    boost::lambda::bind(
        &thumb::PhotoPrintThumbnail::SetFormats,
        boost::lambda::bind(
                boost::lambda::constructor<thumb::PhotoPrintThumbnail::LoadedFormats>(),
                1,
                boost::lambda::bind(
                        boost::lambda::constructor<thumb::PhotoPrintThumbnail::LoadedFormat>(),
                        _2,
                        _3
                )
        ),
        _1
    )
); 
```

我没有尝试编译代码。另一个可能的问题是第二个绑定函子可能会按值返回构造的对象，而第一个绑定需要一个指向对象的指针（作为 this 指针），因此您仍然需要一个指针作为 SetFormats 的第一个绑定参数。

# python - 在 Python 中使用多层生成器的性能注意事项？

> ID：759729
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T09:27:20.910
> 
>         
> 
> 标签：python, performance, generator

使用链接在一起的大量生成器而不是仅使用单个生成器是否有任何性能考虑。

例如：

```
def A(self, items):
    for item in self.AB(items):
        if object.A():
            yield item

def AB(self, items):
    for object in self.ABC(objects):
        if object.A() or object.B():
            yield object

def ABC(self, objects):
    for object in objects:
        if object.A() or object.B() or object.C():
            yield object 
```

显然，调用`A(objects)`将通过三个不同的生成器，但在许多情况下，如果有不同的生成器来处理不同的过滤，它会使代码更好地重用。谁能指出使用这种技术对性能有重大影响？

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T11:04:33.093

链接生成器没有任何问题，但在这个例子中，A 没有理由调用 self.AB，它可以循环项目以获得相同的结果。

您应该尽可能清楚地编写代码，如果速度很慢，则使用分析器来确定瓶颈在哪里。诸如此类的人为示例与现实相去甚远，无法作为有用的绩效指标。

# .net - 在标准 ASP.NET 2.0 TreeView 中单击树节点时调用方法

> ID：759731
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T09:27:44.730
> 
>         
> 
> 标签：.net, asp.net, vb.net, .net-2.0

我有一个使用 XML 数据源动态填充的树视图。TreeView 中的叶节点尝试在页面内的 iframe 中打开 URL。

这一切都很好，但我希望隐藏 iframe，直到选择叶节点为止。

有谁知道点击节点时会触发什么事件？我尝试了 SelectedNodeChanged 事件，但这似乎没有被触发！

或者有没有其他方法可以做到这一点？

更新 - TreeView 代码如下所示

```
<asp:TreeView ID="TreeView1" runat="server" OnSelectedNodeChanged="TreeView1_SelectedNodeChanged" DataSourceID="XmlDataSource2" AutoGenerateDataBindings="False">
  <DataBindings>
     <asp:TreeNodeBinding DataMember="Node"  NavigateUrlField="URL" ValueField="Name" TargetField="iframe" SelectAction="Select" />         
  </DataBindings>
</asp:TreeView> 
```

在摆弄我的代码时，我注意到当我从代码中删除 NavigateUrlField="URL" 时，树会触发 SelectedNodeChange 事件，但如果放回 NavigateUrlField="URL" 则不会触发。

关于我如何解决这个问题的任何想法？？？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T09:57:50.587

这`SelectedNodeChanged`是在您的场景中捕获的正确事件。也许更多细节可能有助于确定为什么不引发此事件。

此外，您应该记住，除非`SelectAction`节点的 设置为`Select`或，否则 TreeView 可能根本不会引发事件`SelectExpand`。这可能是一个值得研究的点。

**编辑：（在OP更新到原始问题之后）：**

* * *

这种行为是很自然的。当您设置`NavigateUrl`TreeNode 时，它​​会进入“导航模式”。这意味着它呈现为超链接而不是可点击节点。因此，此类 TreeNode 的所有选择事件都被禁用，并且`SelectedNode`TreeView 的属性将返回空引用。这是因为 TreeNode 的目的仅仅是重定向到提供的 URL。

现在，有几个解决方案可以解决这个问题：

一种。不是以`NavigateUrl`声明方式设置属性，而是处理事件并根据单击的节点（ ）有条件地`SelectedNodeChanged`设置 IFrame 的属性。还将 IFrame 的可见性设置为 True。`src``SelectedNode`

湾。将客户端脚本附加到`onclick`设置 IFrame 可见性的 TreeView 事件。[Madhur Ahuja 的博客](http://blogs.msdn.com/mahuja/archive/2008/11/29/adding-client-script-to-treenode-click-event.aspx)和[此处](http://pushpontech.blogspot.com/2007/06/getting-treenode-values-on-client-side.html)提供了有关如何执行此操作的示例。

希望这可以帮助！:-)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T09:31:44.113

AfterSelect 事件在节点选择发生更改后触发。在树中的选择更改之前的 BeforeSelect。

# sql-server - 将非规范化的关系数据从 Excel 导入 SQL Server

> ID：759734
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T09:28:05.867
> 
>         
> 
> 标签：sql-server, excel, import, etl

我需要将 Excel 电子表格中的数据导入 SQL Server，但数据不是关系/规范化格式，因此导入向导不会删除它（据我所知）。

数据格式如下：

```
Category    SubCategory     Name        Description

Category#1  SubCategory#1   Product#1   Description#1
Category#1  SubCategory#1   Product#2   Description#2
Category#1  SubCategory#2   Product#3   Description#3
Category#1  SubCategory#2   Product#4   Description#4
Category#2  SubCategory#3   Product#5   Description#5 
```

（抱歉，我缺乏在早上这个时候拿出“真实”数据的创造力......）

每行包含一个唯一的产品，但类别结构是重复的。我想将此数据导入三个表：

```
Category
SubCategory
Product 
```

（我知道 SubCategory 应该真正包含在 Category 中，DB 不是我的设计）

我需要一种方法来根据类别导入唯一行，然后是子类别列，然后在将其他列导入产品时，根据名称获取对子类别的引用。

如果没有编写脚本，有没有办法使用导入向导或其他工具来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T09:49:55.737

不久前我遇到了类似的问题，但没有找到任何简单的方法来使用导入向导来做到这一点。我解决导入的方法（因为这是一项一次性任务，而不是会一直闲逛的事情）是从 excel 创建一个简单的宏（VBA），它会简单地调用一个存储的过程，使用每一行作为参数。

存储过程会智能地插入每个参数（列），然后抓取 ID 用作下一个参数插入的外键。

例如：

```
    声明 @CategoryID INT
    声明 @SubCategoryID INT

    -- 检查类别是否存在
    如果不存在（SELECT * FROM tblCategories WHERE CategoryName = @pCategoryName）
    开始

        -- 你的insert语句在这里，然后获取ID

        SET @CurrencyID = scope_identity()

    结尾
    别的
    开始

        -- 这里设置类别ID

    结尾

```

VBA 宏的代码类似于：

```
私有子 CommandButton1_Click()

    将 cnt 调暗为 ADODB.Connection
    将 wbBook 调暗为工作簿
    将 wsSheet 调暗为工作表
    将 intActiveRow 变暗
    将 intInsuranceProduct 调暗为变体

    ' 获取我们的连接
    设置 cnt = CreateConnection()

    ' 读取输入表
    设置 wbBook = ActiveWorkbook
    设置 wsSheet = wbBook.Worksheets(1)

    ' 忽略标题行
    intActiveRow = 2

    ' 将每一行处理到数据库中
     Do While (wsSheet.Cells(intActiveRow, 1) "")

         ' 执行存储过程，GenerateScript 会创建你的 SQL
         cnt.Execute (GenerateScript(wsSheet, intActiveRow))

         ' 为行数增加 i
         intActiveRow = intActiveRow + 1

     环形

    万一

    '打扫干净。

    cnt.关闭
    设置 cnt = 无
    设置 wbBook = 无
    设置 wsSheet = 无

结束子

```

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:55:21.980

您可能想要调查以前称为 DTS（数据转换服务）的[SSIS （SQL Server 集成服务）。](http://msdn.microsoft.com/en-us/library/ms139914.aspx)

在 SSIS 中，可以使用[Excel 作为数据源](http://msdn.microsoft.com/en-us/library/ms141683.aspx)，您可以在其中指定数据的过滤器和转换以加载到适当的 SQL Server 表中。这可能需要一些研究，但它是一个非常强大的工具，如果您需要做一些非开箱即用的事情，它还支持创建脚本任务的能力。

* * *

## 回答 #3

> 赞同：-1
> 
>             
> 
> 时间：2010-05-08T20:23:45.830

实际上，专门为这种类型的工作开发的一个很好的软件是 Relational Excel - 有一个试用版，但它可以在试用期过后使用，它只是每隔一段时间显示一次唠叨屏幕。www.relationalexcel.com

* * *

## 回答 #4

> 赞同：-1
> 
>             
> 
> 时间：2017-12-31T01:23:56.950

很快的解决方法是使用MS Access中的“分析表”工具，你的表将是Normalyze，试试吧！

# sharepoint - SharePoint 2007 发布网站和 Web 部件中的受众定位

> ID：759737
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T09:29:13.010
> 
>         
> 
> 标签：sharepoint, moss, caml

在发布站点中，我有一个 Web 部件，它必须显示列表中具有受众目标字段的新闻项目。我正在使用 CAML 查询来检索少量最后的新闻项目。   

**是否可以在 CAML 查询中指定目标受众？**如果没有，我该怎么做？检索所有结果，然后在循环中应用过滤器？

我实际上是在复制内容查询 Web 部件，并且我需要在我的自定义 Web 部件中定位受众。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T13:30:32.493

不可以，不能在 CAML 查询中指定受众定位。我认为这与 CAML 查询是 WSS 事物和 Audiences 是 MOSS 共享服务有关。您需要做的是在 CAML 查询中包含受众字段，即在 SPQuery.ViewFields 属性中添加 <FieldRef Name='Target_x0020_Audiences'/>。然后在每个列表项上按受众筛选结果代码。使用 AudienceManager 类来测试当前用户是否是受众的成员。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-04-19T16:59:47.170

好吧，我找到了一个解决方法，当我尝试检查当前用户是否是特定发布页面的受众成员以及该受众的名称时，我遇到了一个问题。这是我想出的解决方法。

```
 // Run through the pages building the list items
foreach (SPListItem li in pages)
{
  // Get a reference to the publishing page
  PublishingPage p = PublishingPage.GetPublishingPage(li);

  // Make sure the page has been approved
  if (li.ModerationInformation.Status == SPModerationStatusType.Approved)
  {
    // Check if this page has an audience
    if (string.IsNullOrEmpty(p.Audience))
      // Add to everyone list
    else
    {
      // Split the audiences
      string[] Audiences = p.Audience.Split(';');

      // Check each audience to see if this user can see it
      foreach (string audPart in Audiences)
      {
        AudienceManager audienceManager = new AudienceManager();

        // Get a reference to the audience
        // IsGuid is an extenstion method i wrtoe
        if (audPart.IsGuid())
        {
          if (audienceManager.Audiences.AudienceExist(new Guid(audPart)))
            aud = audienceManager.Audiences[new Guid(audPart)];
        }
        else
        {
          if (audienceManager.Audiences.AudienceExist(audPart))
            aud = audienceManager.Audiences[audPart];
        }

        // Ensure we have a reference to the audience
        if (aud != null)
        {

          // store the item in the temp variables
          switch (aud.AudienceName)
          {
            case "All site users":
              // Add to everyone list
              break;

            case "Some List":
              if (audienceManager.IsMemberOfAudience(web.CurrentUser.LoginName, aud.AudienceID))
              {
                // Add to other list
              }
              break;

            case "Other List":
              if (audienceManager.IsMemberOfAudience(web.CurrentUser.LoginName, aud.AudienceID))
              {
                // Add to other list
              }
              break;
          }

        }
      }
    }
  }
} 
```

正如您所看到的，它实际上只是通过使用 AudienceManager.Audiences.AudienceExist 检查受众是否存在，并通过使用默认访问器 AudienceManager.Audiences[GUID] 来获取对它的引用；

# python - 来自 sys.getrefcount 的意外结果

> ID：759740
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-17T09:29:39.313
> 
>         
> 
> 标签：python, garbage-collection

当我输入：

```
>>> astrd = 123
>>> import sys
>>> sys.getrefcount(astrd)
3
>>> 
```

我不知道在哪里`astrd`使用了 3 次？

* * *

## 回答 #1

> 赞同：9
> 
>             
> 
> 时间：2009-04-17T09:45:43.203

不是`astrd`that 被引用了 3 次，而是 value `123`。`astrd`只是（不可变）数字 123 的名称，可以多次引用。除此之外，通常共享小整数：

```
>>> astrd = 123
>>> sys.getrefcount(astrd)
4
>>> j = 123
>>> sys.getrefcount(astrd)
5 
```

在第二个赋值中，没有创建新`j`的整数，而只是整数的新名称`123`。

然而，给定非常大的整数，这不成立：

```
>>> i = 823423442583
>>> sys.getrefcount(i)
2
>>> j = 823423442583
>>> sys.getrefcount(i)
2 
```

共享整数是 CPython（以及其他）的实现细节。由于小整数经常被实例化，共享它们可以节省大量内存。这是因为整数首先是不可变的。

对于第二个示例中的附加参考，请参见。[codeape 的回答](https://stackoverflow.com/questions/759740/sys-getrefcount/759763#759763)。

* * *

## 回答 #2

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T09:37:41.103

从[getrefcount 文档字符串](http://docs.python.org/2/library/sys.html#sys.getrefcount)：

> ...返回的计数通常比您预期的高一，因为它包含（临时）引用作为`getrefcount()`.

其他两个引用意味着 python 在内部持有对该对象的两个引用。也许 locals() 和 globals() 字典都算作一个参考？

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T09:42:22.010

我认为它计算了对 123 的引用，尝试其他示例，例如

```
>>> import sys
>>> astrd = 1
>>> sys.getrefcount(astrd)
177
>>> astrd = 9802374987193847
>>> sys.getrefcount(astrd)
2
>>> 
```

9802374987193847 的引用计数符合 codeape 的答案。

这可能是因为数字是不可变的。例如，如果您使用列表，它将始终为 2（来自一个干净的提示）。

顺便说一句，我也得到 123 的 2，也许你的设置有些不同？或者可能与时间有关？

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T09:45:05.983

int 以一种特殊的方式实现，它们被缓存和共享，这就是为什么你没有得到 1。

而python，使用引用计数的对象。astrd 本身就是一个引用，因此您实际上获得了对 int '123' 的引用数。尝试使用另一种（用户定义的）类型，你会得到 1。

# .net - .Net 全文搜索库

> ID：759764
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T09:37:55.033
> 
>         
> 
> 标签：.net, nhibernate, full-text-search

我昨天发布了一个[关于](https://stackoverflow.com/questions/756860/integrating-nhibernate-search-with-nhibernate-2)在 nhibernate v2 中使用 Nhibernate 搜索的问题，但没有收到任何回复。这向我证实了我需要重新考虑使用 NHibernate.Search 并查看替代的全文搜索解决方案。我希望能够对文档进行索引和搜索，并在搜索结果中显示文档的相关摘录。

如果我不能使用 Nhibernate.search，那么我自己将 Lucene 集成到 Nhibernate 中似乎没有多大意义，是否有任何替代方案。我看过[Searcharoo](http://www.searcharoo.net/)，我喜欢它，因为它的代码有很好的文档记录，我很乐意将它集成到 Nhibernate 中。

还有更多我应该看的图书馆吗？我应该只使用没有 Nhibernate.Search 的 lucene 吗？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T09:46:52.797

[Lucene.Net](http://incubator.apache.org/lucene.net/)是我在各种项目中使用的东西。

[LINQ to Lucene](http://codeplex.com/linqtolucene)是我从事的一个项目，可以解决您的一些问题。Lucene 要求您严格控制索引和搜索。当您想为大型系统构建高性能搜索引擎时，这非常有用。不好，如果您只想要在幕后“正常工作”的东西。

我已经为 LINQ to SQL 类写了一篇关于[LINQ To Lucene](http://vijay.screamingpens.com/Tags/Lucene.NET/default.aspx)的帖子，但它适用于任何 POCO 情况。

**更新：** 
我不熟悉 Nhibernate 到 Lucene 系统，也不知道它的可配置性。在使用 Lucene.Net 构建真正的搜索子系统之后，我遇到了一些在构建索引和查询索引时必须处理的棘手问题。

*   搜索索引字段的存储与数据库*非常*不同。数据库模式（或 ORM 实体）与索引“模式”之间很少存在一对一的映射。

*   如果您想访问高级搜索引擎功能，如加权查询、关键字突出显示、自定义比较器（排序器）（等等）——您会发现自动化的 ORM<-->Lucene 桥是不够的。所有这些都需要手动构建查询对象图，而不是使用基本的 Lucene 查询语法。

本质上，如果您希望您的搜索引擎不仅仅是最基本的东西，那么您将希望直接使用 Lucene.Net。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2010-11-30T12:18:16.270

我曾经使用 DotLucene，但遇到了一些问题。一个重要的事实是它需要完全信任才能运行。

我已经开始使用 SearchAroo：[http ://www.searcharoo.net/](http://www.searcharoo.net/)

它使用 XML 数据存储，我发现它的性能与 dot lucene 非常相似。

如果您正在寻找另一种选择，我肯定会看看。

# dynamics-crm - 如何在 CRM 中创建一个网页，用于讨论 IFD 和内部部署的 Web 服务？

> ID：759769
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T09:39:10.193
> 
>         
> 
> 标签：dynamics-crm, dynamics-crm-4, crm

我们有三台服务器，它们都共享同一个数据库。一台服务器面向互联网。

我在 CRM 的 IFRAME 中有一个网页，它使用本地连接的标准方法与 CRM Web 服务对话。当此 IFRAME 通过 IFD 显示且用户通过表单身份验证元素登录时，系统会要求您提供登录凭据。

我该如何解决这个问题？

编辑

以 CRM 服务为目标的 IFRAME 位于四台服务器上。其中两台服务器用于 IFD 和内部部署。另外两个仅用于内部部署。它们都在同一个域中。所有用户都是内部用户，如果他们使用客户的计算机或网吧的机器，可以通过网络登录，因此无法使用VPN。

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-24T10:03:28.303

我怀疑问题不是服务，而是 IFrame。当您通过内部部署向 MSCRM 进行身份验证时，您正在执行 Windows 身份验证，并且当您应该再次完成身份验证请求的 IFrame 时。由于浏览器知道它需要的一切，这一切都是透明的。

使用 IFD 时，您没有在 Web 服务器级别使用身份验证 - 您正在使用基于应用程序级别的表单进行身份验证。您的 IFrame 虽然仍然需要身份验证，因此 iframe 会提示进行身份验证。

如果您遇到服务问题，则会显示 IFrame，并且触发服务调用的任何操作都会失败并出现 400 或 500 错误。

那么问题来了，如何构建一个可以满足 Windows 身份验证和基于表单的网页？嗯，这在 MSCRM 中很容易，首先确保您没有在网页上运行身份验证 - 将其设置为匿名。这样可以确保不再弹出窗口，然后确保您使用 CrmAuthenticationToken 代码来获取令牌并将其用于所有调用。您不应该设置服务本身的 .Credentials 属性。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-24T16:56:15.097

假设您在 CRM 网站（而不是其自己的虚拟目录）中部署您的页面，那么这里将向您指出 Robert 提到的 SDK 文章：

请参阅标题为：来自 ASPX 页面的身份验证的 SDK 主题。

根据我的经验，您应该始终在 CRM 网站的网页中使用 CRMImpersonator。

现在，如果您在自己的网站上运行自己的页面：您将希望看到 Discovery 服务并获得用于访问服务的 CRM Ticket。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-24T01:19:54.537

几个问题可以更好地理解您的问题。以 CrmService 为目标的 iframe 是否位于同一 IFD 服务器上？IFD 服务器是否与其他服务器位于同一域中？当您说用户已登录时，您是指本地域用户还是外部用户？

# python - 如何使用数字 id 检索 google appengine 实体？

> ID：759771
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T09:39:55.183
> 
>         
> 
> 标签：python, google-app-engine

是否可以使用其数字 ID 从 google appengine 检索实体，如果可以，如何？我尝试使用：

key = Key.from_path("ModelName", numericId) m = ModelName.get(key)

但生成的密钥不正确。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-21T02:38:15.710

您正在寻找这个：[http ://code.google.com/appengine/docs/python/datastore/modelclass.html#Model_get_by_id](http://code.google.com/appengine/docs/python/datastore/modelclass.html#Model_get_by_id)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T09:55:13.307

[使用密钥获取实体](http://code.google.com/intl/nl-NL/appengine/docs/python/datastore/creatinggettinganddeletingdata.html#Getting_an_Entity_Using_a_Key)

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T11:27:23.617

原来我需要做

key = Key.from_path(Application_ModelName, numeric_id)

在我查看实体的 dict() 之前不清楚

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2014-01-25T15:40:21.303

其他答案是指旧的 DB API。默认情况下，新应用程序将使用 NDB 数据存储，其 API 略有不同。您仍然可以执行 Model.get_by_id(id, parent) 通过 id 检索实体，但 NDB 还支持指定应用程序和命名空间的选项。有关详细信息，请参阅[文档](https://developers.google.com/appengine/docs/python/ndb/modelclass#Model_get_by_id)。

# c++ - 有人有一个优化的功能来通过 alpha 预乘位图吗？

> ID：759778
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T09:44:09.730
> 
>         
> 
> 标签：c++, winapi, gdi+, alphablending

GDIPlus 混合函数使用 alpha 位图的预乘 rgb 通道来提高效率。然而，通过 alpha 进行预乘是非常昂贵的，因为您必须逐个处理每个像素。

它似乎是 SSE 组装的一个很好的候选者。这里有人想分享它的实现吗？我知道这是一项艰苦的工作，所以这就是我问的原因。我不是想偷你的工作。如果可以的话，你会得到我所有的考虑来分享这个。

编辑：我不想通过软件进行 alpha 混合。我正在尝试将图像中每个像素的每个颜色分量与其 alpha 预乘。我这样做是因为 alpha 混合是通过以下公式完成的：dst=src *src.alpha+dst* (1-dst.alpha) 但是 AlphaBlend Win32 函数确实实现了 dst=src+dst(1-dst.alpha)优化原因。要获得正确的结果，您需要在调用 AlphaBlend 之前 src 等于 src*src.alpha。

因为我对汇编知之甚少，所以我会花一些时间来写，所以我问是否有人愿意分享它的实现。SSE 会很棒，因为在论文中，软件 alpha 混合的增益是 300%。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:58:34.547

有一篇很好的文章在这里找到。它有点旧，但您可能会在它使用 MMX 实现 alpha 混合的部分中找到一些有用的东西。这可以很容易地转换为 SSE 指令以利用更大的寄存器大小（128 位）

[MMX 增强的 Alpha 混合](http://www.gamedev.net/reference/articles/article817.asp)

英特尔应用笔记在这里，带有源代码

[使用 MMX™ 指令实现 Alpha 混合](ftp://download.intel.com/ids/mmx/MMX_App_Alpha_Blending.pdf)

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T17:05:57.467

您可能想看看[Eigen](http://eigen.tuxfamily.org/) C++ 模板库。它允许您使用使用优化的汇编器并支持 SSE/Altivec 的高级 C++ 代码。

> 快速地。（见基准）。
> 
>    表达式模板允许在适当的时候智能地删除临时变量并启用惰性求值——Eigen 会自动处理这一点并在大多数情况下也处理别名。对 SSE（2 和更高版本）和 AltiVec 指令集执行显式矢量化，并优雅地回退到非矢量化代码。表达式模板允许对整个表达式全局执行这些优化。使用固定大小的对象，可以避免动态内存分配，并且在有意义时展开循环。对于大型矩阵，需要特别注意缓存友好性。  
> 
>   
>   
> 
> 优雅的。（参见 API 展示）。
> 
>   由于表达式模板，API 非常干净且富有表现力。在 Eigen 之上实现算法感觉就像在复制伪代码。您可以使用复杂的表达式并仍然依赖 Eigen 来生成优化代码：您无需手动将表达式分解为小步骤。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T17:34:18.710

使用本机 Win32 GDI api 处理每个像素并不昂贵。

见 MSDN

# wpf - DataGridCheckBoxColumn 的单击事件

> ID：759779
> 
>         
> 
> 赞同：26
> 
>         
> 
> 时间：2009-04-17T09:44:49.587
> 
>         
> 
> 标签：wpf, events, datagrid, wpfdatagrid

我有一个`DataGrid`带有 的 WPF 表单`DataGridCheckBoxColumn`，但我没有找到任何点击事件，选中和取消选中它......

这些活动是否适用于`DataGridCheckBoxColumn`？如果没有，请提出一些我可以使用的解决方法。

* * *

## 回答 #1

> 赞同：27
> 
>             
> 
> 时间：2013-03-06T12:33:31.897

引用威廉汉的回答：http: [//social.msdn.microsoft.com/Forums/ar/wpf/thread/9e3cb8bc-a860-44e7-b4da-5c8b8d40126d](http://social.msdn.microsoft.com/Forums/ar/wpf/thread/9e3cb8bc-a860-44e7-b4da-5c8b8d40126d)

它只是将一个事件添加到列中。这是一个很好的简单解决方案。

> 也许您可以使用`EventSetter`以下示例：
> 
>   
>   
> 
> 标记：
> 
> ```
> <Window x:Class="DataGridCheckBoxColumnTest.MainWindow"
>         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
>         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
>         xmlns:local="clr-namespace:DataGridCheckBoxColumnTest"
>         Title="MainWindow" Height="350" Width="525">
>     <Window.Resources>
>         <local:People x:Key="People"/>
>     </Window.Resources>
>     <Grid>
>         <DataGrid ItemsSource="{StaticResource People}" AutoGenerateColumns="False">
>             <DataGrid.Columns>
>                 <DataGridTextColumn Binding="{Binding Path=Name}" Header="Name"/>
>                 <DataGridCheckBoxColumn Binding="{Binding Path=LikeCar}" Header="LikeCar">
>                     <DataGridCheckBoxColumn.CellStyle>
>                         <Style>
>                             <EventSetter Event="CheckBox.Checked" Handler="OnChecked"/>
>                         </Style>
>                     </DataGridCheckBoxColumn.CellStyle>
>                 </DataGridCheckBoxColumn>
>             </DataGrid.Columns>
>         </DataGrid>
>     </Grid>
> </Window> 
> ```
> 
>   
>   
> 
> 代码：
> 
> ```
> using System;
> using System.Windows;
> 
> namespace DataGridCheckBoxColumnTest
> {
>     /// <summary>
>     /// Interaction logic for MainWindow.xaml
>     /// </summary>
>     public partial class MainWindow : Window
>     {
>         public MainWindow()
>         {
>             InitializeComponent();
>         }
> 
>         void OnChecked(object sender, RoutedEventArgs e)
>         {
>             throw new NotImplementedException();
>         }
>     }
> }
> 
> namespace DataGridCheckBoxColumnTest
> {
>     public class Person
>     {
>         public Person(string name, bool likeCar)
>         {
>             Name = name;
>             LikeCar = likeCar;
>         }
>         public string Name { set; get; }
>         public bool LikeCar { set; get; }
>     }
> }
> 
> using System.Collections.Generic;
> 
> namespace DataGridCheckBoxColumnTest
> {
>     public class People : List<Person>
>     {
>         public People()
>         {
>             Add(new Person("Tom", false));
>             Add(new Person("Jen", false));
>         }
>     }
> } 
> ```

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2011-04-27T20:36:52.140

扩展上面提到的 DataGridCell 概念，这是我们用来让它工作的。

...XAML...

```
 <DataGrid Grid.ColumnSpan="2" Name="dgMissingNames" ItemsSource="{Binding Path=TheMissingChildren}" Style="{StaticResource NameListGrid}" SelectionChanged="DataGrid_SelectionChanged">
        <DataGrid.Columns>
            <DataGridTemplateColumn CellStyle="{StaticResource NameListCol}">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <CheckBox IsChecked="{Binding Path=Checked, UpdateSourceTrigger=PropertyChanged}" Name="theCheckbox" />
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>                            
            </DataGridTemplateColumn>
            <DataGridTextColumn Binding="{Binding Path=SKU}" Header="Album" />
            <DataGridTextColumn Binding="{Binding Path=Name}" Header="Name" "/>
            <DataGridTextColumn Binding="{Binding Path=Pronunciation}" Header="Pronunciation" />
        </DataGrid.Columns>
    </DataGrid> 
```

TheMissingChildren 是一个 ObservableCollection 对象，它包含数据元素列表，其中包括我们用来填充数据网格的布尔字段“Checked”。

此处的 SelectionChanged 代码将在底层 TheMissingChildren 对象中设置选中的布尔值并触发项目列表的刷新。这样可以确保无论您在何处单击该行，该框都会被选中并显示新状态。单击复选框或行中的某处将打开/关闭检查。

```
private void DataGrid_SelectionChanged(object sender, SelectionChangedEventArgs e)
{
    DataGrid ThisGrid = (DataGrid)sender;
    CheckedMusicFile ThisMusicfile = (CheckedMusicFile)ThisGrid.SelectedItem;
    ThisMusicfile.Checked = !ThisMusicfile.Checked;
    ThisGrid.Items.Refresh();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:28:43.443

```
<wpf:DataGridCheckBoxColumn Header="Cool?" Width="40" Binding="{Binding IsCool}"/> 
```

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2013-02-20T23:52:25.747

这样的事情怎么样。

```
partial class SomeAwesomeCollectionItems : INotifyPropertyChanged
{
    public event PropertyChanged;
    protected void OnPropertyChanged(string property)
    {
        if (PropertyChanged != null) PropertyChanged(this, new PropertyChangedEventArgs(property);
    }

    private bool _IsSelected;
    public bool IsSelected { get { return _IsSelected; } set { _IsSelected = Value; OnPropertyChanged("IsSelected"); } }
} 
```

然后在 XAML

```
<DataGrid ItemsSource="{Binding Path=SomeAwesomeCollection"} SelectionMode="Single">
    <DataGrid.Resources>
        <Style TargetType="{x:Type DataGridRow}"
               BasedOn="{StaticResource {x:Type DataGridRow}}">
        <!--Note that you will probably need to base on other style if you have stylized your DataGridRow-->
            <Setter Property="IsSelected" Value="{Binding Path=IsSelected, UpdateSourceTrigger=PropertyChanged}" />
        </Style>
    </DataGrid.Resources
    <DataGrid.Columns>
        <DataGridCheckBoxColumn Binding="{Binding Path=IsSelected, UpdateSourceTrigger=PropertyChanged}" />
        <!--More Columns-->
    </DataGrid.Columns>
</DataGrid> 
```

但是，使用这种方法的一个注意事项是，您可能会遇到虚拟化问题并且检查项目未清除（不确定，尚未使用 SelectionMode="Single" 进行测试）。如果是这种情况，我发现最简单的解决方法是关闭虚拟化，但也许有更好的方法来解决这个特定问题。

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2019-02-19T18:58:59.573

如果您不想将事件添加到您的样式中，您也可以这样做。      

```
 <DataGridCheckBoxColumn x:Name="name" Header="name?" Binding="{Path=Name}"
                <DataGridCheckBoxColumn.CellStyle>
                    <Style TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}">
                        <EventSetter Event="CheckBox.Checked" Handler="Checked"/>
                    </Style>
                </DataGridCheckBoxColumn.CellStyle>
            </DataGridCheckBoxColumn>eckBoxColumn.CellStyle>
        </DataGridCheckBoxColumn> 
```

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2021-11-16T18:14:27.423

在xml中试试这个

```
<DataGridCheckBoxColumn Header="" IsThreeState="False" Binding="{Binding isCheck, NotifyOnTargetUpdated=True,  UpdateSourceTrigger=PropertyChanged}" /> 
```

在c#中

```
 public partial class UploadWindow : Window
    {
     ObservableCollection<Items> pl = new ObservableCollection<Items>();

      class Items
      {
        public bool isCheck { get; set; }
      }

      public UploadWindow(Dictionary<string, object> ipDictionary)
      {
        InitializeComponent();
        GridView1.ItemsSource = pl;
      }
     } 
```

就我而言，我需要找到所有选中的复选框

```
var allChecked = pl.Where(x => x.isCheck == true); 
```

# java - 伦巴第 Java API

> ID：759781
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T09:45:38.383
> 
>         
> 
> 标签：java

谁能给我一些用于 Lombardi BPM 的 JAVA API 的链接。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-05-29T22:29:32.293

据我所知，纯 Java API 已被弃用，剩下的就是 Web API。它对我有用，即使它有点记录不足。您可以从[开发人员指南](https://support.lombardi.com/docs/archive/Teamworks6/Teamworks6.2/Teamworks-6.2-Developers_Guide.pdf)中获得更多信息。

# design-patterns - Dispatcher 视图和 Service to work 设计模式有什么区别？

> ID：759784
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T09:46:17.633
> 
>         
> 
> 标签：design-patterns, jakarta-ee

Dispatcher 视图和 Service to work 设计模式之间的主要区别是什么？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-05-02T09:41:37.180

主要区别在于，Service to Worker 描述了在控制器和调度程序中“预先”具有更多行为的架构，而 Dispatcher View 描述了将更多行为移回视图处理时的架构。因此，这两种模式暗示了一个连续统一体，其中行为要么被封装得更靠近前面，要么被移到更远的流程流中。-（[太阳蓝图，调度员视图模式](http://java.sun.com/j2ee/patterns/DispatcherView.html)）

# nunit - 通过 cc.net 运行时，TestFixtureSetUp 偶尔会失败

> ID：759787
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T09:47:22.857
> 
>         
> 
> 标签：nunit, cruisecontrol.net

我正在使用 cc.net 1.4.2 运行每晚构建。我也在使用 nunit2.4.8。如果我手动强制构建它可以正常工作，但我的大多数夜间计划构建都失败了，说 testfixture 设置失败。这是 nunit2.4.8 中的一些错误还是其他事情，因为我无法找出原因

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-23T15:04:58.317

是否与计划每晚运行的 cc.net 项目相同？如果不是，它们的配置方式可能会有所不同。如果它们相同，我建议在测试夹具设置代码中添加一些日志记录，以查看是否可以跟踪问题。可能是服务器上运行的每晚任务（可能是备份或病毒扫描）导致了问题。另一种可能性是在另一台服务器上运行的任务（例如，使数据库脱机。）我不认为这是 NUnit 中的错误。

# c# - C#无法检查会话是否存在？

> ID：759795
> 
>         
> 
> 赞同：16
> 
>         
> 
> 时间：2009-04-17T09:51:06.170
> 
>         
> 
> 标签：c#, asp.net-mvc, session, exists

执行以下操作时出现错误：

```
if(Session["value"] != null)
{
   // code
} 
```

我得到的错误是这样的：

你调用的对象是空的。

为什么是这样？我总是这样检查我的会话？我正在使用 MVC 框架，这与它有关吗？

编辑：

代码在 Controller 的构造函数中：

```
public class MyController : ControllerBase
{
    private int mVar;

    public MyController()
    {
        if (Session["value"] != null)
        {
            mVar= (int)Session["value"];
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：21
> 
>             
> 
> 时间：2009-04-17T09:57:43.550

[] 是一个索引器，它的作用类似于类上的方法。

在这种情况下，Session 为空，您无法对其执行索引。

做这个：

```
if(Session != null && Session["value"] != null)
{
   // code
} 
```

* * *

## 回答 #2

> 赞同：18
> 
>             
> 
> 时间：2009-04-17T09:59:10.723

*会话仅在操作处理*期间才真正存在- 我不希望它在控制器的构造函数中有效。例如，控制器可能（据我所知）在请求之间重复使用。

您将需要在操作（方法）中或（可能更合适）在操作过滤器或`OnActionExecuting`（等）方法中执行此操作：

```
public abstract class ControllerBase : Controller
{
    protected override void OnActionExecuting(
        ActionExecutingContext filterContext)
    {
        // code involving this.Session // edited to simplify
        base.OnActionExecuting(filterContext); // re-added in edit
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:56:29.543

你必须这样做——

```
if(null != HttpContext.Current.Session["Value"])
{
    //Code here.
} 
```

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:56:36.267

您收到此错误是因为“会话”对象为空。因此，不可能查看它的 ["value"] 位。我不熟悉 MVC，但是要么存在更大的问题，即未创建 Session 对象，要么您在生命周期的错误点访问它，或者您只需要测试来检查 Session ！=空值。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:04:08.340

您使用的语法：

```
if (Session["mySessionVariable"] != null)
{

} 
```

... 是在 ASP.NET 中检查 Session 对象的正确方法。我怀疑问题是因为您使用的是 ASP.NET MVC。

也许我们的一些 MVC 专家可以启发我们在 ASP.NET MVC 中执行此操作的正确方法。

**编辑：**我看到 Marc Gravell 在我打字时发布了他的答案。这应该是有启发性的。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2011-03-20T11:29:15.630

我通过这种方式解决：

```
if (Session.Count > 0 && Session["mySessionVariable"].ToString() != null)
{

} 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2014-03-08T12:47:07.400

```
if(Session != null && Session["name"] != null && Session["name"].ToString()!="")
{
   //fire code
} 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2017-04-28T17:05:02.203

您还可以使用：

```
if (Session == null || String.IsNullOrEmpty((string)Session["session_object"])){
   // Do something
} 
```

# language-agnostic - 设计模式是增加还是减少应用程序的复杂性？

> ID：759796
> 
>         
> 
> 赞同：7
> 
>         
> 
> 时间：2009-04-17T09:52:44.653
> 
>         
> 
> 标签：language-agnostic, design-patterns

我只是在看这个关于 SQL 的问题，然后按照[关于 DAO 的链接到 wikipedia](http://en.wikipedia.org/wiki/Data_Access_Object)。它提到了一个缺点：

> “与许多设计模式一样，设计模式会增加应用程序的复杂性。” -[维基百科](http://en.wikipedia.org/wiki/Data_Access_Object)

这突然让我想知道这个想法是从哪里来的（因为它没有引用）。就我个人而言，我一直认为模式会降低应用程序的复杂性，但我可能会产生妄想，所以我想知道这种复杂性是否基于某些东西。

谢谢。

* * *

## 回答 #1

> 赞同：13
> 
>             
> 
> 时间：2009-04-17T09:56:12.320

如果阅读代码的人了解设计模式及其概念，并且能够在实际使用中识别设计模式（不仅仅是书中的示例），那么他们确实会降低复杂性。

然而，我发现很多初级开发人员，他们对设计模式了解不多，或者根本不了解它们，他们认为使用它们会增加代码的复杂性。

我可以理解：你突然有更多的类或代码要通过来解决起初似乎很简单的问题。如果您没有意识到设计模式的好处，那么被黑的解决方案总是看起来更好。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2013-09-09T16:31:29.170

我喜欢设计模式，但它们（除了像 Singleton 这样简单的模式）**肯定会增加**应用程序的复杂性。它们为设计增加了一些维度，这对于新手设计师来说并不直观（并且不是编程语言功能的一部分）。

有些人可能会觉得模式降低了复杂性，因为它们在软件的非功能性需求（如可维护性、可扩展性、可重用性等）方面带来了好处。但是，我不同意，并将这些好处视为*复杂性投资的回报*。也许在某些情况下，模式会降低复杂性，但像这样的理论讨论会散发出更多的热量。到目前为止，几乎没有一个答案使用具体示例，保存[https://stackoverflow.com/a/760968/1168342](https://stackoverflow.com/a/760968/1168342)。

具体来说，许多模式通过引入在应用模式之前不存在于设计中的新结构（接口、方法等），**[意外增加了设计的复杂性。](https://en.wikipedia.org/wiki/Accidental_complexity)**

让我们以[访客](https://en.wikipedia.org/wiki/Visitor_pattern)为例。

> 访问者是一种将操作与它们操作的对象结构分离的方法。在使用访问者的解决方案之前，操作被硬编码到对象结构的每个元素中。开发人员面临的挑战是添加新操作涉及修改各种元素中的代码。
> 
> 在应用了访问者模式之后，多了一个访问者的类层次结构，它封装了操作。解决方案中的控制流肯定更复杂，并且更难调试（任何实现了访问者并尝试使用[接受/访问的](http://www.plantuml.com:80/plantuml/img/ZSj12W8n30NGVKzHPZKkfWVeObo8Lt0VOi1Wsobj37XxEuBIBWGtWP__Vhrpob0WsYhFGEqMHdd4ODfN63b34ZkXFmMc99E5Qd7ioEEMi93GEL3y81gHVj65AyjMtaWDBYjvGAGiinuCeB22K9lJighN7SzouzfrQdHV7NjzfIxyKpldVe8kwD2y0000)[双重调度](https://en.wikipedia.org/wiki/Double_dispatch)调用的程序流的人都知道这一点）。
> 
> 根据内聚单元理解和维护访问者函数比将函数编码到被访问的固定结构中的每个元素中的替代方案要简单。这就是模式的好处。

很难量化地说明意外复杂性增加了多少，或者添加新操作变得多么容易。我当然不同意笼统地说从长远来看，应用模式会降低复杂性的答案。这不像您的设计“忘记”了访问者方法添加的双重调度，只是因为您拥有更容易添加操作的代码。复杂性是您为获得可维护性收益而付出的代价（或税收）。

## 模式仍需应用

不管一个人对模式的熟悉程度如何，任何给定的模式都必须*应用于*解决方案。该应用程序每次都会有所不同（Martin Fowler 说[模式只是半生不熟的解决方案](http://martinfowler.com/ieeeSoftware/patterns.pdf)）。开发人员将始终必须了解哪些类在现有设计中扮演什么角色，这受制于通常不重要的[基本复杂性（应用程序问题的复杂性）。](https://en.wikipedia.org/wiki/Essential_complexity)

在最好的情况下，理解应用在已经很复杂的应用程序中的设计模式可能是微不足道的，但这不是零努力：

*   模式并不总是以相同的方式应用。模式有很多变体——我想到了代理。我不确定每个人都*同意*如何应用任何给定的模式。

*   引入一种模式（例如，封装算法的策略）通常会导致其他模式来正确管理事物（例如，工厂来实例化具体的策略）。

*   引入一种模式通常会导致更多的责任。使用工厂时的对象清理并非易事（也没有在 GoF 中记录）。有多少人知道所谓的[Lapsed-listener 问题](https://en.wikipedia.org/wiki/Lapsed_listener_problem)？

*   如果对模式需求的假设发生变化（例如，不再需要策略模式提供的多个封装算法），会发生什么？稍后删除模式将是额外的工作。如果您不删除它，新开发人员在加入时可能会被它的存在所欺骗。模式在模式中扮演角色的类之间交织在一起。删除并非易事。

[Erich Gamma 在 ECOOP 2006](https://link.springer.com/chapter/10.1007/11785477_1)上给出了一个轶事，设计师在一个案例中决定从商业多平台 GUI 小部件框架中删除抽象工厂模式（经典的抽象工厂示例！*）*[。](https://en.wikipedia.org/wiki/Abstract_factory_pattern)正如我记得的轶事一样，复杂 GUI 中的多级间接（多态调用）对客户端代码的性能造成了重大影响。客户抱怨 GUI 反应迟钝，“优化”是删除间接性。在这种情况下，性能胜过可维护性；这种模式只是让编码人员高兴，而不是最终用户。

## DAO 示例

就您在问题中引用的 DAO 示例而言，如果您正在编写一个永远不需要在不同数据库中运行的应用程序，那么 DAO 模式就是一个不必要的复杂程度。通常，如果您的代码不需要模式应该提供的好处，那么应用该模式将不必要地增加应用程序的复杂性。

## 旋转门隐喻

以建筑物为例，让我们将旋转门视为一种建筑设计模式。下图来自维基百科：

![旋转门](https://i.stack.imgur.com/h5URH.jpg "http://commons.wikimedia.org/wiki/File:RevolvingDoorDiag2007.jpg")

**您可以“看到”这样一扇门的额外复杂性。**旋转门的好处在于节能。他们试图解决人们经常进出建筑物的问题，并且打开/关闭标准门使得每次在建筑物内部和外部之间交换过多的空气。

安装旋转门作为两居室房屋的入口可能没有意义，因为没有足够的交通量来证明额外的复杂性是合理的。旋转门仍然*可以*在两居室的房子里使用。节能方面的好处会很小（实际上可能更糟，因为相对于传统门的尺寸和气密性）。与传统门相比，门肯定会花费更多，并且会占用更多空间。

* * *

## 回答 #3

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T09:59:38.630

设计模式通常会导致围绕问题的额外抽象级别，如果处理不当，过多的抽象会导致复杂性。

然而，由于设计模式提供了一个通用的词汇来交流想法，它们也降低了复杂性并提高了可维护性。

归根结底，这是一把双刃剑，但我无法想象我会避免使用设计模式的情况......

* * *

## 回答 #4

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T10:08:42.743

有一种臭名昭著的疾病，称为“有模式综合症的小男孩”，通常会袭击最近第一次阅读 GoF 书籍并突然发现无处不在的模式的人。这会增加复杂性和不必要的抽象。

在我看来，模式最好作为发现或重构来解决特定问题添加到代码中。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T09:58:43.063

设计模式增加了代码并将其分成多个部分。如果设计模式和概念是已知的，那么它听起来并不复杂，但是基于您不知道的设计模式的代码，那么它看起来很复杂。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:03:34.503

正如格罗弗所说，设计模式的力量取决于程序员在看到它们时识别它们的能力。这就像将一个数学问题简化为一个更简单的问题，然后他们解决更简单的问题。但是，对于没有意识到这一点的人来说，您似乎刚刚制造了另一个问题。

我认为当您使用模式来解决问题时，使用注释和/或描述性名称来明确记录总是一个好主意。如果他没有意识到这一点，这甚至可能会教育另一个遇到它的程序员有关该模式的知识。

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:21:32.683

我认为这取决于“观众”，即代码库的维护开发人员。如果他们是设计模式文盲，那么是的，它会增加复杂性，因为大多数人不理解的东西都是“复杂的”。

如果团队了解设计模式，即他们了解基础知识并了解设计模式为何有用的前提（并且当它们没有用时同样重要），那么我认为它们会降低复杂性。

毕竟，计算机科学可能是一门羽翼未丰的科学，但它拥有数十年的经验。很可能有人以前已经解决过你的问题一次。答案是设计模式、数据结构还是算法。

我比较喜欢[Dylan Beattie](https://stackoverflow.com/users/5017/)这个幽默的[解释](http://dylanbeattie.blogspot.com/2009/02/specs-bugs-rocknroll.html)。我推荐阅读（如果没有别的可以在星期五早上浪费五分钟！）

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T12:30:16.367

设计模式的工作方式类似于面向对象编程的算法。向您展示如何以有意义的关系将对象组合在一起以执行特定任务。所以我会说是的，它们通过让您更好地理解软件的设计来降低复杂性。与过程程序中的算法相同。

如果我告诉你 X 使用的是带冒泡排序的链表，那么跟随程序员正在做的事情会容易得多。

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T15:48:50.790

在短期内，设计模式往往会增加代码的复杂性。他们在可能不是绝对必要的地方添加了额外的抽象。但是，从长远来看，它们会降低复杂性，因为未来的增强和更改以简单的方式适合模式。如果没有这些模式，这些更改将更具侵入性，并且复杂性可能会更高。

以装饰器模式为例。第一次使用它会增加复杂性，因为现在您必须为对象定义一个接口并创建另一个类来添加装饰。这很可能通过一个简单的属性来完成并完成。然而，当你达到 5 或 20 个装饰时，装饰器的复杂性远低于属性。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2010-04-01T08:57:12.173

我在 GoF 模式的范围内对这个主题进行了一些研究。我观察到设计模式重构后的 OO Metric 值波动，您可以使用[此链接查看](http://sites.google.com/site/barisaydinoz/barisaydinoz%27sthesis)。

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2019-04-23T19:56:42.693

从长远来看，设计模式肯定会预先增加复杂性，以换取更多模块化、可维护、灵活和可扩展的代码。也许迭代器模式最好地体现了它。

使用索引来迭代列表显然是非常简单和直观的事情，但设计模式将其封装为迭代器，它肯定比简单的索引更复杂。

权衡的是，公平地说它已经消除了（实现）简单性，但作为回报，它更灵活地从容器中移除了迭代责任并将其客观化，从而可以重用。

这就是你的设计模式。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:09:08.657

设计模式不会增加复杂性，它可以使事情更容易阅读和维护。对于新来的人来说，整合你的开发团队可能会更困难，但这种努力总体上是有益的。

问题是设计模式作为一个整体，但它的滥用

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T15:41:36.530

它们***既不***应该增加也不应该减少复杂性。

您应该***始终***为您的代码使用适当的设计。这可能使用或不使用常见的设计模式。

设计模式的主要好处是

*   通过学习它们，您已将更多设计工具添加到您的工具箱中

*   通过学习他们的名字，如果你使用它们并发表评论说明你正在使用的模式，它可以帮助读者更简洁地理解你的设计意图

当我在霍普金斯大学教授模式时，我强调的两件大事是：

*   模式都是关于*意图的交流*

*   不要将任何特定模式用作金锤；将它们锁定在您的工具箱中，只有在对您的应用程序有意义时才将它们拉出。

# python - 将原始 SQL 映射到多个相关的 Django 模型

> ID：759797
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T09:52:49.083
> 
>         
> 
> 标签：python, sql, mysql, django, django-models

由于性能原因，我不能使用 Django 的 ORM 查询方法，我必须使用原始 SQL 来处理一些复杂的问题。我想找到一种将 SQL 查询的结果映射到多个模型的方法。

我知道我可以使用以下语句将查询结果映射到一个模型，但我不知道如何使用它来映射到相关模型（就像我可以使用 Django 中的 select_related 语句一样）。

```
model_instance = MyModel(**dict(zip(field_names, row_data))) 
```

是否有一种相对简单的方法可以映射查询结果集中的相关表的字段？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T11:54:36.170

首先，你能证明 ORM 正在阻止你的表现吗？有时性能问题只是糟糕的数据库设计或不正确的索引。通常这是因为试图将 Django 的 ORM 强制安装到遗留数据库设计中。存储过程和触发器会对性能产生不利影响——尤其是在使用 Django 时，触发器代码应该在 Python 模型代码中。

有时性能不佳是应用程序问题。这包括在数据库中进行的不必要的排序操作。

最常见的性能问题是“过度获取”数据的应用程序。随便使用该`.all()`方法并创建大型内存集合。这会破坏性能。必须尽可能少地触及 Django 查询集，以便将查询集迭代器提供给模板进行显示。

一旦选择绕过 ORM，就必须解决对象关系阻抗不匹配问题。再次。具体来说，关系“导航”没有“相关”的概念：它必须是使用外键对关系集进行的一级提取。通过 SQL 组装一个复杂的内存对象模型非常困难。循环引用使这非常困难。将 FK 解析为集合很难。

如果要使用原始 SQL，则有两种选择。

1.  避开“选择相关”——它不存在——实施起来很痛苦。

2.  发明您自己的类似 ORM 的“选择相关”功能。一种常见的方法是添加有状态的 getter，它们 (a) 检查私有缓存以查看它们是否获取了相关对象，如果该对象不存在，(b) 从数据库中获取相关对象并更新缓存。

在发明自己的有状态 getter 的过程中，您将重新发明 Django，您可能会发现它不是 ORM 层，而是数据库设计或应用程序设计问题。

# php - PHP $_SERVER['REMOTE_ADDR'] 有时会解析为空字符串

> ID：759799
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T09:53:11.033
> 
>         
> 
> 标签：php

从多台机器访问我的站点时，$_SERVER['REMOTE_ADDR'] 总是解析为空字符串。这可能是什么原因？

**附加信息：**
其中一台机器在 localhost 上运行该站点。本地主机上的机器不应该总是解析为 127.0.0.1 吗？

我的设置是 LAMP。一个开发者。运行站点 localhost 并且有问题的机器是 Mac 并运行 XAMPP。我认为我们的现场登台环境是 CentOS（共享主机）。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T09:58:30.210

我猜这是由于地址缺少反向委托造成的。除非绝对必要，否则应避免反向解析。

它不仅在延迟方面很昂贵，而且还会产生意想不到的结果，因为不需要解决什么问题——或者根本不需要解决什么问题。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2013-03-28T08:44:55.023

我刚刚遇到了这个问题，事实证明 PHP 代码`''`在运行我的代码之前将其设置为显式。这是因为 IPv6 远程地址与其仅 IPv4 的正则表达式不匹配。

把这个留在这里以防其他人有同样的问题，这对我来说是一个太简单的理由来发现它。

有问题的模块是 simplemachinesforum。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:07:26.833

尝试从这些机器上查看 phpinfo() 并查看它们呈现的内容。

# java - Apache XML 安全库是否与 IBM 的 JDK 兼容

> ID：759800
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T09:53:31.203
> 
>         
> 
> 标签：java, xml, security, apache

我开发了一个使用 Apache XML 安全库进行 xml 加密和签名的应用程序。它在 SUN 的 JDK 上运行没有任何问题，但是，IBM JDK 给了我很多问题。

它没有正确签名（验证失败），pkcs11 提供程序无法加密。

似乎这个问题是因为 IBM 提供了自己的安全提供商。我试图注释掉那些提供程序（即 fips），我几乎设法获得了与 sun 的 jdk 相同的行为，除了 pkcs11 提供程序，它总是失败。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2010-12-06T23:45:19.443

这个线程有帮助吗 - [http://www.ibm.com/developerworks/forums/message.jspa?messageID=1315965](http://www.ibm.com/developerworks/forums/message.jspa?messageID=1315965)？

过去，我在 Apache Tomcat 中启用 SSL 的 Web 应用程序遇到了麻烦，因为当您定义安全连接器时，Tomcat 默认使用 algorithm=SunX509。使用 IBM JDK 时，您必须通过显式使用 algorithm=Ibmx509 来覆盖。

我猜你的问题的根源有一个类似的问题。

# sql - SQL生成实体-属性-值结构化数据报告

> ID：759811
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T09:57:00.400
> 
>         
> 
> 标签：sql

我有 3 张桌子：

产品主管：

```
ProductId    PName     PDescription 
```

属性：

```
AttributeID  attName
----         ----
1            Brand
2            Category
3            Artist 
```

产品属性值

```
paId   ProductId  AttributeID AttributeValues 
```

一个`product`可以有多个`attributes`。

这是所需的输出：

```
ProductId  ProductDesc  Brand    Category    Artist
---        ---          ---      ---         ---
1          sadasd       Brand1   Category1   Artist1
2          sadasds      Brand2   Category3   Artist4 
```

我怎样才能得到这个输出？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:07:50.203

您应该为要提取的每个属性值离开连接，例如

```
select p.ProductId,p.ProductDesc,
a1.AttributeValues as Brand,
a2.AttributeValues as Category, 
a3.AttributeValues as Artist,
from Product p
left join ProductAttributeValues a1 on(p.ProductId=a1.ProductId and a1.AttributeID=1)
left join ProductAttributeValues a2 on(p.ProductId=a2.ProductId and a2.AttributeID=2)
left join ProductAttributeValues a3 on(p.ProductId=a3.ProductId and a3.AttributeID=3) 
```

把它改回英文，“给我所有的产品，如果它们存在的话，给我一个品牌、类别和艺术家属性”

我假设产品的每个属性只有一个或零个值。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:10:44.847

假设每个产品的每个属性只出现一次：

```
SELECT 
  pm.ProductId as ProductId,
  pm.PDescription as ProductDesc,
  pav_Brand.AttributeValues as Brand,
  pav_Category.AttributeValues as Category,
  pav_Artist.AttributeValues as Artist
FROM
  ProductMaster pm
    inner join ProductAttributeValues pav_Brand 
      on pm.productId == pav_Brand.ProductId
    inner join Attributes a_Brand 
      on pav_Brand.AttributeId = a_Brand.AttributeId
        AND a_Brand.attName = 'Brand'
    inner join ProductAttributeValues pav_Category 
      on pm.productId == pav_Category.ProductId
    inner join Attributes a_Category 
      on pav_Category.AttributeId = a_Category.AttributeId
        AND a_Brand.attName = 'Category'
    inner join ProductAttributeValues pav_Artist 
      on pm.productId == pav_Artist.ProductId
    inner join Attributes a_Artist 
      on pav_Category.AttributeId = a_Artist.AttributeId
        AND a_Brand.attName = 'Artist' 
```

如果数据并不总是可用，您可以使用左外连接。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:04:39.010

试试这个查询，也许需要一些调整

```
Select pm.ProductId, pm.PDescription, pav1.AttributeValues, pav2.AttributeValues, pav3.AttributeValues 
from Productmaster pm, ProductAttributeValues pav1, ProductAttributeValues pav2, ProductAttributeValues pav3 
where pm.ProductId = pav1.ProductId 
and pav1.AttributeID = 1 
and pm.ProductId = pav2.ProductId 
and pav2.AttributeID = 2 
and pm.ProductId = pav3.ProductId 
and pav3.AttributeID = 3 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:10:46.093

```
SELECT  ProductId, ProductDesc,
        (
        SELECT  AttributeValues
        FROM    ProductAttributeValues pv
        WHERE   pv.AttributeID = 1
                AND pv.ProductID = p.ProductID
        ) AS Brand,
        (
        SELECT  AttributeValues
        FROM    ProductAttributeValues pv
        WHERE   pv.AttributeID = 2
                AND pv.ProductID = p.ProductID
        ) AS Category,
        (
        SELECT  AttributeValues
        FROM    ProductAttributeValues pv
        WHERE   pv.AttributeID = 3
                AND pv.ProductID = p.ProductID
        ) AS Artist
FROM    Products p 
```

# javascript - 第二个 $(document).ready 事件 jQuery

> ID：759822
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-17T10:00:24.137
> 
>         
> 
> 标签：javascript, jquery, html, blocking, ads

我正在使用一些带有 $(document).ready() 的外部 jQuery 在文档就绪事件触发后插入广告，例如：

```
$(document).ready( function() {
  $('#leaderboard').html("<strong>ad code</strong>");     
}); 
```

这是为了防止用户界面因广告加载缓慢而被阻塞。到目前为止，它运行良好。

现在我需要通过我们的 CMS 系统插入更多广告，这不能是外部 JS 文件的一部分，所以我想知道我可以使用第二个文档就绪事件并使用内联脚本标签插入它吗？如果是这样，首先执行外部 JS 文档就绪事件或内联脚本的顺序是什么？

* * *

## 回答 #1

> 赞同：10
> 
>             
> 
> 时间：2009-04-17T10:04:06.997

您可以使用任意数量的事件方法，jquery 将它们加入队列中。方法调用的顺序与定义顺序相同 - 最后添加的是最后调用。

一个有用的事情可能还在于，您可以使用 ajax 加载带有脚本的 html 代码，并且当代码加载到 DOM 时，$().ready() 也会被调用，因此您可以动态加载广告。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-04-17T10:16:05.627

是的，添加多个 $(documents).ready()s 不是问题。所有将在就绪事件上执行。

但是请注意，您的代码示例是错误的。$(document).ready() 接受一个函数，而不是一个表达式。所以你应该给它一个这样的函数：

```
 $(document).ready( function() {
  $('#leaderboard').html("<strong>ad code</strong>");     
 }); 
```

该函数将在文档准备好时执行。

* * *

## 回答 #3

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T10:04:39.367

这是一个关于多文档就绪[的小教程](http://www.learningjquery.com/2006/09/multiple-document-ready)

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T10:15:34.757

> jQuery 方式的一个额外好处是您可以有多个 ready() 定义。这是所有 jQuery 事件的情况。
> 
>   
>   
> 
> $(document).ready(function () { alert("Number One"); });
> 
>   
>   
> 
> $(document).ready(function () { alert("第二个");

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2011-08-05T13:44:14.623

JQuery 按照定义的顺序调用就绪函数。如果您想先加载一些数据并延迟执行，请使用[holdReady()](http://api.jquery.com/jQuery.holdReady/)。

# delphi - Delphi - 如何解决这种奇怪的 TGrid 行为？

> ID：759823
> 
>         
> 
> 赞同：4
> 
>         
> 
> 时间：2009-04-17T10:00:27.880
> 
>         
> 
> 标签：delphi, drag-and-drop, vcl, delphi-2007

德尔福 2007。

我有一个 TGrid 的行数超过了屏幕上的容量，并且网格的高度使得底部有一个部分绘制的行。当我单击这部分行时，它会跳起来完全可见（通过 Grids.pas 中名为“ClampInView”的过程）。但它并没有停止。由于鼠标现在位于一个新的部分绘制的行上，所以它也会跳起来。

最终效果是单击部分绘制的行开始选择垂直列中的单元格，一直旋转到底部（或直到您释放鼠标）。

我已经在一个新的 winforms 项目上复制了这个，只有一个 100 行的网格，没有代码，所以我很确定这不是我在代码中做错的事情。

这对我来说很糟糕，因为我在实际代码中的表单具有拖放类型的行为，因此在部分行上单击并释放 ~0.1 秒后将拾取单元格中的项目并将其放下约 50 行。当您单击一个单元格时，这绝对不是您所期望的。

有什么建议可以解决/解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T16:40:31.960

这就是我一直在做的事情，因为我认为部分可见的行很俗气。我调整了网格的大小，使其客户区是行高的偶数倍。您可以在设计时执行此操作，或者也可以通过代码轻松执行此操作。如果您有可重新调整大小的行，那么踢球者将是。如果是这种情况，那么只需将用于调整网格大小的代码放在行调整大小事件的事件处理程序中（我相信它有一个）。  

这不仅可以防止您尝试修复的行为，而且（在我看来）还可以使您的 UI 看起来更干净！

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T10:46:13.293

如果用户在“坏”位置单击，您可以尝试在网格中覆盖 MouseDown，并且不要调用继承的 MouseDown。

# ruby-on-rails - 在内存中更新预先加载的关联

> ID：759824
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T10:00:33.730
> 
>         
> 
> 标签：ruby-on-rails, activerecord, associations, eager-loading

在我当前的 Rails 应用程序中，我将大量数据从数据库中提取到内存中，以便我可以启动一个长时间运行的后台任务，我不想每 5 秒访问一次数据库。

这一切都很好，但我有一些不雅的代码，如果可能的话，我想去掉它们。

例如，我有一个用户模型，并且用户模型可以以联系人的形式链接到其他用户模型，而联系人又可以链接回第一个用户模型，依此类推。建模如下（感谢 Milan Novota 早期的帮助）：-

```
class User < ActiveRecord::Base
  has_many :contact_records, :foreign_key => :owner_id
  has_many :contacts, :through => :contact_records, :class_name => "User"
end

class ContactRecord < ActiveRecord::Base
  belongs_to :owner, :class_name => "User"
  belongs_to :user
end 
```

所以现在我可以输入

```
user_a_contacts = user_a.contact_records
=> [user_b, user_c] 
```

并获取用户 a 的所有联系人。现在假设我想通过用户 a 获取用户 b 的联系人（想不出我为什么会这样做，但这只是一个例子！）

```
user_b_contacts = user_a_contacts.first.contact_records
=> [user_a, user_c] 
```

现在我可以得到用户 a 的名字（以一种复杂的、迂回的、从未在现实世界中使用的方式）

```
user_a_name = user_b_contacts.first.name
=> "Jamie" 
```

到目前为止，一切都很好。现在我更改用户 a 的名称

```
user_a.name = "Sandy"
=> "Sandy" 
```

如果像以前一样从数据库中再次访问用户 a 的名称，我会得到

```
user_a_name = user_b_contacts.first.name
=> "Sandy" 
```

但是，如果我渴望加载并将这个值保存在内存中，我会得到

```
user_a_name = user_b_contacts.first.name
=> "Jamie" 
```

但执行以下操作给了我正确的答案

```
user_a.name
=> "Sandy" 
```

很明显，预加载为原始用户和从 ContactRecord 对象预加载的用户创建不同的用户对象。

所以（最后！）我的问题是：-

目前，我已经通过使用来解决这个问题

```
@users.each.detect{|user| user == user_b_contacts.first} 
```

（其中@users 是预先加载的用户对象列表）。有没有办法可以更新预先加载的用户对象？

请注意： -

a）我正在使用以下内容进行急切加载

```
User.find(:all, :include => [ {:contact_records => :contacts] } ]) 
```

b) 显然这不是我正在使用的实际代码，但为了显示该代码，会有更多的解释和说明，我想我已经让你厌烦了！相信我，我使用的真实示例确实需要这种结构才能正常工作，尽管看起来很奇怪！;)

c) 我可能在重构示例时引入了拼写错误和错误，但请忽略这些。我只需要知道是否可以在不访问数据库的情况下重新加载热切的用户。

提前谢谢了！

更新：如下所述，模型数据在流程运行结束之前不会保存到数据库中，因此重新加载将不起作用，因为数据库中的数据不会改变。

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T11:25:52.357

好的。我将把你的问题浓缩成一个新问题并回答那个问题。如果我误解了，请原谅我，这不是你要问的。

**问题**

> 如果`user`是我`contacts`提前加载了关联的 ActiveRecord 模型，当关联在数据库中发生更改时`User.first(:include => :contacts)`，如何刷新`contacts`关联？

**回答**

您可以通过我知道的两种方式使关联缓存无效。首先你可以这样做：

```
user.reload 
```

这将从头开始重新加载整个用户模型。一个稍微不那么激烈的方法是这样做

```
user.clear_association_cache 
```

这不会重新加载所有`user`，但会清除缓存的关联。

无论哪种方式，下次您这样做`user.contacts`时都会从数据库中重新加载它们。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T12:47:58.960

非常感谢您的回复，丹尼尔。虽然你的问题并不完全正确，但你让我意识到我错过了一个关键点！数据库记录不会更新，因为我没有保存！在任何时候。

我正在做的事情的要点是将模型数据提取到实例变量中，以加快后台进程。因此，第一次加载的数据在进程运行结束之前不会保存回数据库。

我希望的是一种方法，您可以在急切加载时指定一列的值与已加载的另一个模型相关。

例如，

```
User.find(:all, :include => [ {:contact_records => (:contacts as User)] } ]) 
```

或类似的。

据我所知，Rails 中没有这样的语法，但是我希望我错了！:)

希望这使它更清楚一点，并再次感谢您的回复。

# html - 列出在其他元素下呈现的项目。IE7 CSS HTML

> ID：759832
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T10:05:16.870
> 
>         
> 
> 标签：html, css, internet-explorer-7

我有一个使用以下代码的菜单栏，当单击标题列表项时，它们调用 showHide 函数将内部列表的类更改为具有显示块而不是无的类。

在 ie6 和 ff 上工作正常，chrome 歌剧等。但在 ie7 上，内部列表呈现在主列表中的其他元素下。我尝试的一切似乎都打破了其他浏览器。

非常感谢任何帮助。

```
<ul id="FOOMENU" style="list-style-type: none; padding-left: 10px; text-decoration: none;">   
<li class="navItemsHeader"><b>View by..</b></li>

<li>
<b><a style="text-decoration:none;" href="javascript:void(0);" onclick="showHide('foobarMenu');">foobar..</a></b>
</li>

<li id="foobarMenu" class="hideMenu">
                                <ul style="list-style-type:none; padding-left:10px; text-decoration:none; ">
                                    <li>DYNAMIC LIST OF LINKS HERE.</li>

                                </ul>
</li> 
```

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:25:54.060

我会使用[jQuery](http://docs.jquery.com/Downloading_jQuery)之类的 javascript 库，因为它会为您处理所有跨浏览器问题，并且具有诸如 toggle() 等有用的方法来显示和隐藏元素。

jQuery 代码类似于

```
$(".hideMenu").click(function() {
    $(this+"> ul").toggle();
}); 
```

此外，如果您想隐藏以前显示的子菜单，您可以使用：

```
$(".hideMenu").click(function() {
    $(".hideMenu > ul").hide();
    $(this).children("ul").show();
}); 
```

# c# - 闭包有什么特别之处？

> ID：759837
> 
>         
> 
> 赞同：12
> 
>         
> 
> 时间：2009-04-17T10:07:03.747
> 
>         
> 
> 标签：c#, closures

我一直在[阅读这篇关于闭包](http://www.devsource.com/c/a/Languages/Cigars-Lambda-Expressions-and-NET/1/)的文章，他们说：

*   “所有管道都是自动的”

*   编译器“创建一个包装类”并“延长变量的寿命”

*   “您可以放心使用局部变量”

*   .NET 编译器会为您处理管道等问题。

所以我根据他们的代码做了一个例子，对我来说，似乎闭包的行为类似于常规命名方法，它们也“无忧无虑地处理局部变量”并且“所有管道都是自动的”。

**或者这个“局部变量的包装”解决了什么问题使闭包如此特别/有趣/有用？**

```
using System;
namespace TestingLambda2872
{
    class Program
    {
        static void Main(string[] args)
        {
            Func<int, int> AddToIt = AddToItClosure();

            Console.WriteLine("the result is {0}", AddToIt(3)); //returns 30
            Console.ReadLine();
        }

        public static Func<int, int> AddToItClosure()
        {
            int a = 27;
            Func<int, int> func = s => s + a;
            return func;
        }
    }
} 
```

# 回答

所以这个问题的答案是阅读Jon Skeet 关于Marc 指出[的闭包的文章。](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)本文不仅展示了 C# 中 lambda 表达式的演变，还展示了 Java 中如何处理闭包，这是本主题的优秀读物。

* * *

## 回答 #1

> 赞同：20
> 
>             
> 
> 时间：2009-04-17T10:18:41.160

您的示例不清楚，并且（IMO）没有显示典型的捕获用法（唯一捕获的是`a`，它始终为 3，所以不是很有趣）。

考虑这个教科书示例（谓词）：

```
List<Person> people = ...
string nameToFind = ...
Person found = people.Find(person => person.Name == nameToFind); 
```

现在尝试不关闭；即使我们很懒，你也需要做更多的工作：

```
PersonFinder finder = new PersonFinder();
finder.nameToFind = ...
Person found = people.Find(finder.IsMatch);
...
class PersonFinder {
    public string nameToFind; // a public field to mirror the C# capture
    public bool IsMatch(Person person) {
        return person.Name == nameToFind;
    }
} 
```

捕获方法进一步扩展到不同范围内的许多变量 -隐藏了**许多复杂性。**

除了名称之外，以上是 C# 编译器在幕后所做的近似。请注意，当涉及其他范围时，我们开始链接不同的捕获类（即内部范围具有对外部范围的捕获类的引用）。相当复杂。

Jon Skeet[在这里有一篇很好的文章，](http://csharpindepth.com/Articles/Chapter5/Closures.aspx)[在他的书中](http://www.manning.com/skeet/)还有更多。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:19:41.733

闭包是编译器的一个功能。你看不到它，它只是让你编写的代码工作。

没有它，对 AddToIt(3) 的调用将失败，因为底层 lamda 在 AddToItClusure() 的范围内使用局部变量 a = 27。调用 AddToIt 时该变量不存在。

但是由于闭包，编译器使用的一种机制，代码可以工作，你不必关心它。

# vba - 在 Microsoft Word 文档中存储任意元数据

> ID：759840
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-17T10:08:21.077
> 
>         
> 
> 标签：vba, ms-office, ms-word

我需要将自定义元数据存储在 Word 文档中。“文档属性”限制为 255 个字节，但我有 >> 10k 的数据

我们正在使用 VBA 编写一个 word 扩展来与我们的应用程序交互，并希望将我们的应用程序数据存储在 word 文档中。这个想法是，用户可以只共享 word 文档，而不共享我们应用程序的任何其他数据文件。

有谁知道如何在 Office 2003+ 文档中有效地存储任意元数据？

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-04-17T10:31:23.063

刚刚在 VBA 编辑器即时窗口中尝试了这个：

```
ActiveDocument.Variables.Add "foo", String(10000, ".")

? Len(ActiveDocument.Variables("foo"))
10000 
```

文档变量与文档一起存储。正如我刚刚发现的那样，它们似乎达到了 65280 个 Unicode 字符（在 Word 2003 中测试；**更新：**此限制在 Word 2007 和 2010 中是相同的）。

如果您担心数据接近 60k，我建议将其拆分为多个变量，或者在存储之前对其进行压缩。[这篇文章](https://stackoverflow.com/questions/167888/how-can-i-gzip-compress-a-file-from-excel-vba-using-code-in-an-xla-file-only/168539#168539)展示了在 VBA 中执行此操作的一些选项。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T10:38:13.233

它不完全符合您的要求，因为它不适用于 Word 2003。但是，您仍然可能对它感兴趣（否则我建议您使用 Tomalak 建议的文档变量）：

在 Word 2007（及更高版本）中，您可以将任意 XML 文档作为**[Custom XML](http://msdn.microsoft.com/en-us/library/bb608618.aspx)**嵌入到 Word 文档中。

MSDN 上的这篇文章中描述了一个示例：[如何：使用 VSTO 加载项将自定义 XML 部件添加到文档中](http://msdn.microsoft.com/en-us/library/bb608612.aspx)

# python - 向 django 模型方法添加请求？

> ID：759850
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-17T10:11:04.097
> 
>         
> 
> 标签：python, django, django-models

我正在跟踪模型上的用户状态。对于“课程”模型，我的状态为“已完成”、“正在学习”、“已查看”。在模型列表的视图中，我想添加用户状态。做这个的最好方式是什么？

一个想法：添加`request`到模型方法就可以了。那可能吗？

编辑：我的意思是在 templatecode:`{{ lesson.get_status }}`中，带有`get_status(self, request)`. 可能吗？它不起作用（还）。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T11:38:56.130

如果你的状态是一个变化的值，你必须把它分成两个独立的部分。

1.  更新状态。这必须在视图函数中调用。然而，真正的工作属于模型。视图函数调用模型方法并进行保存。

2.  显示状态。这只是状态的一些字符串表示。

模型

```
class MyStatefulModel( models.Model ):
    theState = models.CharField( max_length=64 )
    def changeState( self ):
        if theState is None:
            theState= "viewed"
        elif theState is "viewed":
            theState= "learning"
        etc. 
```

查看功能

```
 def show( request, object_id ):
     object= MyStatefulModel.objects.get( id=object_id )
     object.changeState()
     object.save()
     render_to_response( ... ) 
```

模板

```
 <p>Your status is {{object.theState}}.</p> 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:24:58.507

是的，您可以使用请求参数向模型添加方法：

```
class MyModel(models.Model):
    fields....

    def update_status(self, request):
        make something with the request... 
```

# c# - 如何从 Visual Studio 以调试模式运行 NUnit？

> ID：759854
> 
>         
> 
> 赞同：120
> 
>         
> 
> 时间：2009-04-17T10:11:47.213
> 
>         
> 
> 标签：c#, visual-studio-2008, unit-testing, testing, nunit

我最近一直在为我一直在研究的一些 C# 构建一个测试框架。我在我的工作区中设置了 NUnit 和一个新项目来测试组件。如果我从 Nunit (v2.4) 加载我的单元测试，一切都会很好，但我已经到了在调试模式下运行并设置一些断点非常有用的地步。

我已经尝试了几个指南的建议，这些指南都建议更改测试项目的“调试”属性：

```
Start external program: C:\Program Files\NUnit 2.4.8\bin\nunit-console.exe
Command line arguments: /assembly: <full-path-to-solution>\TestDSP\bin\Debug\TestDSP.dll 
```

我在那里使用控制台版本，但也尝试过调用 GUI。当我尝试开始调试时，两者都给我同样的错误：

```
Cannot start test project 'TestDSP' because the project does not contain any tests. 
```

这是因为我通常将 \DSP.nunit 加载到 Nunit GUI 中，而这就是进行测试的地方吗？

我开始认为问题可能是 VS 想要运行它自己的测试框架，这就是它找不到 NUnit 测试的原因？

**编辑**：对于那些询问测试装置的人，我在 TestDSP 项目中的 .cs 文件之一大致如下所示：

```
namespace Some.TestNamespace
{
    // Testing framework includes
    using NUnit.Framework;

    [TestFixture]
    public class FirFilterTest
    {
        [Test]
        public void Test01_ConstructorTest()
        {
            ...some tests...
        }
    }
} 
```

...我对 C# 和 NUnit 测试框架还很陌生，所以我完全有可能错过了一些关键信息 ;-)

**最终解决方案**：最大的问题是我使用的项目。如果您选择`Other Languages -> Visual C# -> Test -> Test Project`...当您选择项目类型时，据我所知，Visual Studio 将尝试使用它自己的测试框架。您应该选择一个**普通**的C# 类库项目，然后我选择的答案中的说明将起作用。

* * *

## 回答 #1

> 赞同：102
> 
>             
> 
> 时间：2009-04-17T10:18:05.437

当我需要调试我的 NUnit 测试时，我只需`nunit-agent.exe`使用“调试|附加到进程”附加到 NUnit GUI 应用程序并从 GUI 运行测试。我的测试（或他们正在测试的代码）中的任何断点都会被命中。我是否误解了您的问题，或者这对您有用吗？

* * *

## 回答 #2

> 赞同：46
> 
>             
> 
> 时间：2009-04-17T10:20:01.907

我使用与您尝试 Jon 相同的技术，没有 /assembly 标志，即

```
Start External Program: C:\Program Files\NUnit 2.4.8\bin\nunit.exe

Command line arguments: "<path>\bin\Debug\Quotes.Domain.Tests.dll" 
```

TestDSP.dll 是否包含您所有的 TestFixtures？

由于我的测试项目不是解决方案中的启动项目，我通过右键单击测试项目并选择 Debug --> Start New Instance 来运行我的测试

* * *

## 回答 #3

> 赞同：22
> 
>             
> 
> 时间：2010-06-11T10:10:04.073

只需删除看起来像的线

```
<ProjectTypeGuids>
    {3AC096D0-A1C2-E12C-1390-A8335801FDAB};{FAE04EC0-301F-11D3-BF4B-00C04F79EFBC}
</ProjectTypeGuids> 
```

从您的项目文件中。这一行基本上告诉 VS.Net 它是一个测试项目，因此是“无法启动测试项目”。仅供参考，第一个 Guid 说“这是一个测试”，第二个说“它是 C#”。有关这些指南的信息：[http ://www.mztools.com/Articles/2008/MZ2008017.aspx](http://www.mztools.com/Articles/2008/MZ2008017.aspx)

* * *

## 回答 #4

> 赞同：18
> 
>             
> 
> 时间：2012-02-28T22:01:12.720

除了@Justin 提供的答案之外，这里还有一些关于 NUnit 2.6 的详细信息。

使用 NUnit 2.6 附加到 nunit.exe 或 nunit-console.exe 而不是代理。@Justin 指出的配置略有不同。下面是来自 nunit.exe.config 的示例（与 nunit-console.exe.config 相同）。

```
<startup useLegacyV2RuntimeActivationPolicy="true">
  <!-- Comment out the next line to force use of .NET 4.0 -->
  <supportedRuntime version="v2.0.50727" />  
  <supportedRuntime version="v4.0.30319" />
</startup> 
```

对于 .NET 4 测试项目，要获得断点，您必须按照注释的建议注释掉或删除 v2.0 行。一旦我这样做了，我就能够调试 .NET 4.0 测试项目。

* * *

## 回答 #5

> 赞同：18
> 
>             
> 
> 时间：2012-09-10T00:01:15.643

如果您使用的是 NUnit 2.4 或更新版本，您可以将以下代码放入您的[`SetUpFixture`](http://www.nunit.org/index.php?p=setupFixture&r=2.4)课程中。（您可以使用旧版本执行此操作，但您需要执行与 . 等效的任何操作`SetUpFixture`，或将其复制到测试本身。）

```
[SetUpFixture]
public class SetupFixtureClass
{
    [SetUp]
    public void StartTesting()
    {
        System.Diagnostics.Debugger.Launch();
    }
} 
```

当[`Debugger.Launch()`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.launch.aspx)您在 NUnit 中单击运行时，会导致显示以下对话框。

![JIT 调试器对话框](https://i.stack.imgur.com/Bjb2M.png)

然后，您在打开项目的情况下选择正在运行的 Visual Studio 实例（我的屏幕截图中的第二个），然后将附加调试器，并且任何断点或异常都将显示在 Visual Studio 中。

* * *

## 回答 #6

> 赞同：12
> 
>             
> 
> 时间：2017-04-16T14:29:42.763

在 Nunit 3.0.1（我使用的是 VS2013）中，从主菜单 > 测试 > Windows > 测试资源管理器打开。然后在“测试资源管理器”中，右键单击测试用例，您可能会看到：
[![在此处输入图像描述](https://i.stack.imgur.com/Q47vM.png)](https://i.stack.imgur.com/Q47vM.png)

希望这可以帮助。

* * *

## 回答 #7

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T10:13:13.683

安装[TestDriven.NET](http://www.testdriven.net/)，它是 Visual Studio 的插件

从那里您可以右键单击单元测试程序集并单击运行测试以运行整个套件，右键单击 TestFixture 类以仅运行该类中的测试，或右键单击测试方法以仅运行该方法。

如果您需要在调试模式下对测试进行断点，您还可以选择使用调试器进行测试。

* * *

## 回答 #8

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T10:39:58.083

试试 NUnitit - 一个用于调试 NUnit 测试用例的开源 Visual Studio 插件

主页 -   [http://nunitit.codeplex.com/](http://nunitit.codeplex.com/)

* * *

## 回答 #9

> 赞同：5
> 
>             
> 
> 时间：2009-10-29T15:05:10.287

从项目文件中删除 ProjectTypeGuids。

* * *

## 回答 #10

> 赞同：3
> 
>             
> 
> 时间：2016-10-18T12:00:57.477

现在有图片：

1.  运行 NUnit gui（[从这里下载 2.6.2](https://sourceforge.net/projects/nunit/)）然后转到`File -> Open Project`

[![在此处输入图像描述](https://i.stack.imgur.com/WTVzJ.png)](https://i.stack.imgur.com/WTVzJ.png)

2.  `.dll`从 bin 文件夹 ( `C:\......\[SolutionFolder][ProjectFolder]\bin\Debug\xxxxTests.dll`)中选择您的测试

3.  转到 Visual Studio `Debug -> Attach to process`（将打开附加到进程窗口）

4.  从列表中向下滚动并选择，`nunit-agent.exe`然后单击`Attach`

[![在此处输入图像描述](https://i.stack.imgur.com/HhO6Y.png)](https://i.stack.imgur.com/HhO6Y.png)

5.  此时测试中的断点应该变成成熟的红色（来自空心）。

6.  单击`Run`，`Nunit Gui`您应该会遇到断点...

希望这可以节省您一些时间。

* * *

## 回答 #11

> 赞同：2
> 
>             
> 
> 时间：2010-12-15T21:52:47.803

如果项目路径包含空格，例如路径中的“新项目”，`<path>\bin\Debug\New Project\Quotes.Domain.Tests.dll`则将 Start Option --> Command Line Arguments 项目路径用双引号引起来。

我花了很多时间来弄清楚这一点。

* * *

## 回答 #12

> 赞同：2
> 
>             
> 
> 时间：2012-01-16T16:48:09.957

如果您能够让控制台/或 GUI 工作，但您的断点没有被命中，这可能是因为您的应用程序运行的 .NET 运行时与 NUnit 不同。检查您的 nunit-console.exe.config / nunit.exe.config 是否指定了运行时。（配置与 nunit exe 位于同一目录中。）使用启动节点指定运行时：

```
<configuration>
    <startup>
       <supportedRuntime version="4.0" />
    </startup> 
```

* * *

## 回答 #13

> 赞同：1
> 
>             
> 
> 时间：2010-03-28T11:39:14.420

关于[帕特里克麦克唐纳](https://stackoverflow.com/users/61989/patrick-mcdonald)先生所说的

> 由于我的测试项目不是解决方案中的启动项目，我通过右键单击测试项目并选择 Debug --> Start New Instance 来运行我的测试

我尝试申请我的测试类库，但在路径方面遇到了一些错误，所以我尝试删除“命令行参数”，幸运的是它运行良好且符合预期。

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T11:06:39.500

听起来您正在尝试使用错误的库。只有当您使用的 dll 包含 TestFixtures 时，NUnit 才能启动。

在 TestDriven.Net 上 +1。我有机会多次使用它。[您可以根据http://testdriven.net/purchase_licenses.aspx](http://testdriven.net/purchase_licenses.aspx)上的许可证下载个人版本进行评估。

* * *

## 回答 #15

> 赞同：0
> 
>             
> 
> 时间：2010-06-08T19:08:20.427

我在 MSTest 上遇到了同样的错误。我发现在**Test Output**窗口中，一些测试有重复的 ID 并且无法加载。我删除了所有重复的测试，现在我可以在启动项目时运行测试。

* * *

## 回答 #16

> 赞同：0
> 
>             
> 
> 时间：2012-04-11T15:39:37.333

现在还有一个扩展“Visual NUnit”，它允许您在 Visual Studio 中运行测试，就像内置测试框架句柄一样。在扩展管理器中查看它。

* * *

## 回答 #17

> 赞同：0
> 
>             
> 
> 时间：2013-10-31T09:17:40.400

打开 Visual Studio ---> 您的项目---> 选择“属性”---> 选择“调试”-> 选择“启动外部程序”并在那里设置 NUnit 的路径（例如：启动外部程序 = C :\Program Files\NUnit 2.6.2\bin\nunit.exe) ---->保存

设置好后点击调试

* * *

## 回答 #18

> 赞同：0
> 
>             
> 
> 时间：2015-10-20T14:00:30.207

对我来说，解决方案是调整 nunit 配置文件。要将 nunit 与 4.5-.Net 框架和 x64 构建选项一起使用，我必须在启动标记中添加一行（支持的运行时版本）。

```
<startup useLegacyV2RuntimeActivationPolicy="true">
        <!-- Comment out the next line to force use of .NET 4.0 -->
        <supportedRuntime version="v4.0.30319" />
</startup> 
```

之后，我可以通过右键单击 Testproject Debug -> Start new instance 开始。之前，我需要再次手动将项目附加到流程中。

我的 Debug 属性是 C:\Program Files (x86)\NUnit 2.6.4\bin\nunit.exe，带有要测试的 .dll 位置的参数。

更多信息：[使用 .NET 4.0 进行测试的 nunit](http://christianspecht.de/2012/06/24/getting-nunit-2-6-0-to-work-in-a-net-4-0-solution/)

* * *

## 回答 #19

> 赞同：-2
> 
>             
> 
> 时间：2009-04-17T10:56:15.093

看看这是否有帮助..
[如何在 Visual Studio 中添加 NUnit](https://stackoverflow.com/questions/196740/how-to-add-nunit-in-visual-studio)

*（RighteousRant）虽然我个人不喜欢这种方法。如果您在测试驱动代码时需要调试器，这是一种“气味”，因为您没有足够的信心/不知道您的代码是如何工作的并且需要调试器告诉你。如果操作正确，TDD 应该让您不再需要调试器。仅在极少数情况下或当您涉足其他人的代码时才使用“将调试器附加到 NUIt”。*

# java - 安装 Java EE 应用程序有哪些好的 InstallAnywhere 替代品？

> ID：759855
> 
>         
> 
> 赞同：46
> 
>         
> 
> 时间：2009-04-17T10:12:18.990
> 
>         
> 
> 标签：java, installation, jakarta-ee, windows-installer

您会推荐哪种（商业或免费）安装程序工具来代替[InstallAnywhere](https://www.flexerasoftware.com/producer/products/software-installation/installanywhere/)作为 Java EE 应用程序的安装程序？你特别喜欢它的什么，它的缺点是什么？

一些要求：

*   必须支持在安装过程中**运行自定义 Java 代码**

*   必须支持 Windows，包括最新的 64 位版本，如 Windows Server 2008；对其他目标操作系统的支持是一个加分项

*   必须能够将捆绑的应用程序服务器（例如[Resin](http://caucho.com/)或[Tomcat](http://tomcat.apache.org/)）安装为 Windows 上的服务

*   必须支持基本的东西，如复制和移动文件、编辑配置文件、提取 ZIP 等。

*   （必须支持捆绑特定版本的 JRE；至少包含要提取的 ZIP）

编辑：还有几点：

*   最好不依赖于目标机器上预装的 JRE（或任何其他 3rd 方运行时环境或库）；也就是说，可以生成独立的Windows .exe（或.msi）

*   该工具最好是跨平台的，以便可以在 Linux、Windows 或 Mac 上完成安装程序开发。

*   最好有一个不错的 GUI 来将安装程序放在一起。但是，一旦完成，就**必须**可以跳过 GUI 并使安装程序构建成为自动构建过程的一部分。

* * *

## 回答 #1

> 赞同：59
> 
>             
> 
> 时间：2009-04-24T15:16:34.400

在这种情况下，不幸的是，SO 并没有告诉我们太多我们不知道的事情（事实上，我们最终选择的工具在任何答案中都没有提到）。但是，我在这里发布我们的经验，因为它们以后可能对其他人有所帮助。

我们（快速）评估了以下安装工具，主要是通过查看他们的网站并浏览网络上的其他信息：[Actual Installer](http://www.actualinstaller.com/)、[Advanced Installer](http://www.advancedinstaller.com)、[BitRock InstallBuilder](http://installbuilder.bitrock.com/)、[Inno Setup](http://www.jrsoftware.org/isinfo.php)、[Install Creator](http://www.clickteam.com/eng/installcreator.php)、[Installer VISE for Windows](http://www.mindvision.com/winvise.asp)、[InstallShield](http://www.flexerasoftware.com/products/software-installation/installshield-software-installer/)、[install4j](http://www.ej-technologies.com/products/install4j/overview.html)、[IzPack](http://izpack.org/)、[NSIS](http://nsis.sourceforge.net/)、[openInstaller](http://java.net/projects/openinstaller/)、[Scriptlogic MSI Studio](http://www.scriptlogic.com/products/msi-studio/)、[Smart Install Maker](http://www.sminstall.com/)、[Symantec Wise Installation Studio](http://www.symantec.com/business/wise-installation-studio)和[WiX](http://wix.sourceforge.net/)。

我们很早就筛选掉了其中的大部分，最终选出了两个供进一步评估的选项：**[BitRock InstallBuilder](http://installbuilder.bitrock.com/)**和**[install4j](http://www.ej-technologies.com/products/install4j/overview.html)**。对于这些工具，我们下载了评估版本并进行了一些原型设计，以查看对我们最重要的东西是否真的得到支持，以及让它们工作起来有多容易或多难。

这两个选项在很多方面都很好（并且两者似乎都是 InstallAnywhere 的不错替代品）：

*   他们生成完全原生且漂亮的 Windows .exe 安装程序，易于使用您自己的图形等进行自定义。

*   这两种工具都可以轻松实现自动化，以便从 Ant 触发安装程序构建。（使用 install4j，我只花了五分钟就[学会了它](http://resources.ej-technologies.com/install4j/help/doc/indexRedirect.html?http&&&resources.ej-technologies.com/install4j/help/doc/cli/ant.html)，然后实现了它。）

*   两家公司似乎都有很好的支持（嗯，至少对于评估其产品的潜在客户而言 ;-) 尤其是来自 BitRock，我们得到了非常快速的回复。

在以下方面，对于我们的需求，install4j 似乎比 BitRock 更好（当然，其中许多是主观的，所以 YMMV）：

*   install4j 肯定对运行自定义 Java 代码有更好的支持——它可以在安装过程中的任何时候完成，无论系统上是否有任何预安装的 JRE。

*   BitRock 使用更硬编码的安装步骤序列，而 install4j 更灵活。在 install4j 中，添加自定义屏幕和表单（带有或不带有自定义 Java 代码）、询问用户输入等，可以在安装任何文件之前或之后的任何时间完成。  

*   还有一些基本的事情，比如定义要复制到目标系统的文件集，以及添加一个安装步骤来替换配置文件中的某些字符串，在 install4j 中似乎更容易一些。

*   install4j 对 JRE 捆绑有更好的支持

*   在 Linux 上创建安装程序时，install4j IDE 的外观和感觉比 BitRock 更好（更“原生”）

*   （install4j 的[许可选项](http://www.ej-technologies.com/buy/install4j/overview.html)对我们来说更好——我们强烈推荐几个浮动许可，而不是所有开发人员的命名许可或昂贵的“站点许可”）

所以最终我们选择了**install4j**。以下是有关它令人印象深刻的原因的更多详细信息：

*   它的 IDE 是您将安装程序放在一起的地方，非常简单且易于使用 - 即使不查看文档，我也可以快速找出我想要的大多数事情。当我确实必须检查文档中的某些内容时（例如，如何引用[安装程序变量](http://resources.ej-technologies.com/install4j/help/doc/indexRedirect.html?http&&&resources.ej-technologies.com/install4j/help/doc/helptopics/concepts/variables.html)；如何[开始针对 install4j API 编写自定义 Java 代码](http://resources.ej-technologies.com/install4j/help/doc/indexRedirect.html?http&&&resources.ej-technologies.com/install4j/help/doc/helptopics/extending/api.html)），很快就找到了我需要的东西。

*   您可以在安装过程中完全自定义屏幕和操作，还可以随时添加自定义屏幕和操作（针对其[Java API](http://resources.ej-technologies.com/install4j/help/api/)编码）。这对我们很重要，因为我们需要重用旧 InstallAnywhere 安装程序中现有的自定义 Java 代码。

*   *在一些小细节上，install4j 似乎是Java*开发人员的理想选择。例如，如果您想添加一个验证脚本来检查某些用户输入，您可以在 install4j IDE 本身中非常快速地编写代码，*使用普通的旧 Java*，并使用类似于 IntelliJ IDEA 的编码辅助。

*   我们认为 install4j 浮动许可证的成本是合理的，考虑到该工具有多好（与 InstallAnywhere 的夸大定价相比，这简直是讨价还价......）

*   简而言之，它似乎是可用于部署 Java 应用程序的最佳安装工具。

* * *

## 回答 #2

> 赞同：9
> 
>             
> 
> 时间：2009-04-17T13:27:01.410

我们创建了[BitRock InstallBuilder](http://installbuilder.bitrock.com)，这是一个跨平台的安装工具，在使用 InstallAnywhere 以及特别是它的表亲（现已不复存在）InstallShield MP 的一些令人沮丧的经历之后。我们一半以上的客户使用我们的工具来打包基于 Java 的软件，但该工具是本地的，而不是基于 Java 的。这意味着我们有许多优势，例如原生外观（包括 Vista、GTK、Qt 等），并且无需在安装之前进行自解压（启动更快，空间要求更少）等等。要回答您的具体问题：

*   支持在多个时间点（例如显示某个页面、正在复制文件、卸载时等）在安装过程中调用 Java 代码。该代码不在安装程序中编译，但可以在外部调用并在安装程序中使用结果。如果您更具体地了解您需要哪种代码，我可以提供具体的示例代码。对于需要手动添加到其他安装程序的功能，我们有很多内置操作，因此您可能不需要首先编写该代码！

*   我们支持所有版本的 Windows，包括 64 位和 Windows 2008（多个客户已使用我们的安装程序在这些平台上进行了认证）

*   我们支持捆绑的应用服务器，包括 Tomcat、Resin、JBoss 等。查看[BitNami](http://bitnami.org)以了解我们创建的此类堆栈的示例。

*   我们支持复制和移动文件、替换配置文件中的值、解压缩文件和大多数其他常见的安装功能。我们的原则之一是安装程序应为常见的安装操作提供内置支持，并具有用于调用特定于客户产品的外部代码的简单、干净的界面。

*   我们支持捆绑 JRE，正如您提到的，通常只需捆绑 JRE 目录并在启动脚本中为 JAVA_HOME 设置适当的值

您可以看看我们的一些[客户](http://installbuilder.bitrock.com/customers.html)，例如 MySQL、Samsung、Motorola、GitHub 等。InstallBuilder 是一种商业产品，但我们为开源项目提供免费许可证，并为小型企业和 microISV 提供折扣。

* * *

## 回答 #3

> 赞同：8
> 
>             
> 
> 时间：2013-03-21T02:43:38.927

只想补充一点，我的公司已经使用 InstallAnywhere 大约 6 年了，但我们决定继续前进。原因有两个。

首先，他们的定价是绝对的高速公路抢劫，与 INstall4J 和 BitRock 等直接竞争对手相比，许可受到严格限制。  

我对 InstallAnywhere 的另一个问题是该产品只进行了最低限度的维护。我已经通过许多不同的版本使用该产品 6-7 年，并且很少修复错误，您肯定不能期待新功能。基本上你可以期待的是，他们会在新版本的 windows/mac 发布时增加对它的支持。他们的支持费用非常昂贵，但我从未真正实施过支持请求。当我第一次购买该产品时，我相信它来自一家名为 ZeroG 的公司，该公司只专注于该产品。他们实际上维护和改进了产品。那时，这是唯一真正的门票，他们在竞争中取得了飞跃。  

然后它被 Macrovision 和 Flexera 收购。自从 ZeroG 出售该产品以来，它一直是所属公司的辅助产品，并且对它的关注度一直很低。似乎购买它更多是为了完成一套产品，而不是因为公司实际上想要维护产品。  

请注意，请仔细评估这些产品，因为您可能会与它们联系在一起。我们本来会更早地离开产品，但我们不仅在安装程序上投入了大量精力，而且还根据产品的功能/限制设置了自动更新方案，以至于离开产品的成本很高，因为劳动力投资在新产品中重现这一点。  

只是我的看法，但我不推荐InstallAnywhere。  

* * *

## 回答 #4

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T10:34:31.823

我可以担保[izPack](http://izpack.org/)。它是基于 Ant 的，因此您可以在其中打包 Ant 安装，并且 Ant 安装可以包含自定义任务和/或在 Ant build.xml 中编写的脚本（例如，使用 Groovy、Beanshell 或任何支持 BSF 的脚本语言）。因此，它将涵盖您的可定制要求。

我过去曾将它用于上述所有内容 - 解压缩/服务/自定义代码。它是多平台的，尽管我不能保证上面的特定实例（64 位 Windows）。但如果它运行 Java，你应该没问题。

一个令人头疼的是JRE。您显然需要*一些*JRE 来运行它。但是我认为您应该能够在 izPack 中打包并执行特定的 JRE 安装。

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2012-08-31T08:34:06.170

目前我们正在使用[GetDown](http://code.google.com/p/getdown/)来处理我们的 Swing 应用程序的分发。我们使用 Tomcat 分发更新并使用[GetDown](http://code.google.com/p/getdown/)下载这些更新。它非常灵活和强大，并且比 java WebStart 好得多，并且因为它为更改生成校验和，所以它节省了带宽并下载了刚刚更改的文件。

一个很好的教程：[http ://www.hascode.com/2012/05/creating-updatable-java-applications-using-getdown-and-the-getdown-maven-plugin/](http://www.hascode.com/2012/05/creating-updatable-java-applications-using-getdown-and-the-getdown-maven-plugin/)

项目网站：[https ://github.com/threerings/getdown](https://github.com/threerings/getdown)

* * *

## 回答 #6

> 赞同：3
> 
>             
> 
> 时间：2009-05-02T12:24:56.380

在多平台环境中部署始终是一大麻烦。它认为最佳解决方案将针对为所有平台创建本机包，如 RPM、DEB 或 MSI ......也可以在无人值守的情况下安装。

开发人员应该致力于使应用程序能够自我修复并且无需安装即可运行。

这样做可以最大限度地减少部署工作。

我知道这不是您所要求的完全解决方案，但有时您可以通过这种方式获得更好的结果。

请记住，如果您遵循这些，您将获得 Linux 上的免费更新服务。

我仍然希望微软会添加类似于 MSI 的东西（这不需要你在他们那里注册）。同时对于 Windows，您可以查看刚刚作为开源发布的 Google Updater - [http://code.google.com/p/omaha/](http://code.google.com/p/omaha/) 

[他们为 Mac OS http://code.google.com/p/update-engine/](http://code.google.com/p/update-engine/)发布了一个类似的产品，但遗憾的是他们没有考虑从这两个产品中创建一个产品。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2016-03-29T16:36:14.450

您可以尝试使用[SetupBuilder Gradle 插件](https://github.com/i-net-software/SetupBuilder)来使用简单的 Gradle 构建脚本创建本机 *.msi 安装程序。

*   这是免费的。

*   支持 32 位和 64 位 Windows。还有Linux和OSX。

*   在 Windows 和 OSX 下捆绑 Java VM，不需要预装 Java VM。

*   可以在安装之前或之后运行 Java 代码。

*   可以创建一个 Windows 服务/守护进程。

*   没有 GUI，但使用 Gradle。如果您已经使用 Gradle 作为构建脚本语言，那么这非常容易。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:22:18.607

你可能对[launch4j感兴趣](http://launch4j.sourceforge.net/) 

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2009-04-25T13:38:20.837

Jonik，感谢您发布如此详细的体验反馈。我想写一个后续答案，因为你提出了一些好观点。

在满足某些基本要求（不幸的是，InstallAnywhere 不再满足）之后，并没有真正的“坏”或“好”工具，而是更适合某些项目的工具。您似乎仔细研究了所有选项，并且 install4j 将更适合您的项目。这可能是一个不错的选择，因为您从以前的安装程序中获得了想要重用的现有 Java 代码库（尽管我想认为 InstallBuilder 不需要其中一些代码:)

关于 InstallBuilder，我们支持使用 <insertBefore> 标签自定义屏幕顺序（我们可能应该更好地记录这一点）。捆绑 JRE 也很简单（在大多数情况下仅包括 java/ 文件夹），但我认为您的批评是正确的：因为这是一项常见任务，我们应该更好地记录/使其可通过 GUI 访问，包括在所有支持的平台中拖放。我们已经在我们的路线图中改进了您提到的领域的 GUI。有趣的是，我们的许多客户发现 XML 格式非常易于使用，以至于他们更喜欢使用他们的编程编辑器来编辑它（就像他们在编辑 HTML 一样）

最后，关于许可，如果那些额外的程序员只是构建安装程序（而不是设计它们）或为构建或持续集成机器购买额外的许可，我们当前的模型不需要购买额外的许可。在任何情况下，install4j 的几个浮动许可证都比 BitRock 的完整企业站点许可证贵：）

再次感谢你的反馈

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2009-05-03T23:25:11.543

我建议看一下**cmInstall**，可以在 
[http://sourceforge.net/projects/cminstall/找到](http://sourceforge.net/projects/cminstall/)

它几乎可以满足您的所有要求，并且是开源的。另外，我是它的开发者之一 :)。

1.  [是] 必须支持在安装过程中运行自定义 Java 代码

2.  [是] 必须支持 Windows，包括最新的 64 位版本，如 Windows Server 2008；对其他目标操作系统的支持是一个加分项

3.  [可以通过使用 3rd 方库轻松完成 - 例如：Tanuki Software] 必须能够在 Windows 上安装捆绑的应用程序服务器（如 Resin 或 Tomcat）作为服务

4.  [是]必须支持基本的东西，如复制和移动文件、编辑配置文件、提取 ZIP 等。

5.  [是 - 或者您可以通过编程方式下载和解压缩它]必须支持捆绑特定版本的 JRE；至少通过包含要提取的 ZIP

    6.[否-它需要安装jdk 1.6，未来计划支持.exe或.msi]最好不依赖于目标机器上预装的JRE（或任何其他第3方运行时环境或库）；也就是说，可以生成独立的Windows .exe（或.msi）

6.  [是] 该工具最好是跨平台的，以便安装程序开发可以在 Linux、Windows 或 Mac 上完成。

    7.[否 - cminstall 框架是“基于开发人员的” - 但易于使用。只需阅读[http://sourceforge.net/project/showfiles.php?group_id=250019&package_id=305489](http://sourceforge.net/project/showfiles.php?group_id=250019&package_id=305489)中的教程，看看它是多么容易构建安装程序！] 最好有一个不错的 GUI 来将安装程序放在一起。但是，一旦完成，就必须可以跳过 GUI 并使安装程序构建成为自动构建过程的一部分。

* * *

## 回答 #11

> 赞同：1
> 
>             
> 
> 时间：2017-06-27T08:51:54.870

我还审查了一些开源多平台安装程序。这是我的评论：

1.  [BitRock InstallBuilder](https://installbuilder.bitrock.com/)：仅适用于免费和开源开发人员，因为它提供免费许可用于开源项目。

2.  [InstallJammer](https://sourceforge.net/projects/installjammer/)：良好的免费和开源多平台安装程序。只有一个担心，一旦从 InstallJammer 下载可执行构建，防病毒程序就会立即将其删除。不知何故，从 InstallJammer 构建的文件被视为误报。在发布之前，您必须使用更多的安全证书。

3.  [Izpack](http://izpack.org/)：良好的免费和开源多平台安装程序。对于不习惯使用蚂蚁的人来说，这可能有点麻烦。[与PackJacket](http://packjacket.sourceforge.net/)等 GUI 前端一起使用时可能会很棒。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:16:51.133

我见过几个人推荐[IzPack](http://izpack.org/)，但老实说我不知道​​它是否符合您的要求。它至少是免费的:)

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:56:35.250

Sun 提供了一个开源安装程序：

**[打开安装程序](http://java.net/projects/openinstaller/)**

我确信您要求的所有功能都得到支持。

但对我来说似乎有点难以配置。

但你猜怎么着：它不仅有一个 GUI，还有一个（伪图形）CLI。

不错的截图和信息[**在这里**](http://blogs.oracle.com/bytor/entry/openinstaller_gui_and_cui_parity)。

# java - POI 3.2 图像高度/宽度控制

> ID：759856
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-17T10:12:45.183
> 
>         
> 
> 标签：java, image, apache-poi

使用 POI 3.2 版

问题：无法将图像调整为其原始高度和宽度。我可以将图像添加到 excel 文件中。

添加图像后，我调用 picture.resize(); 方法。

后来我通过调用 sheet.setColumnWidth(columnindex, columnwidth) 来调整 excel 文件的列大小，图像丢失其原始高度/宽度。

请帮忙。

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2011-08-26T13:04:25.750

我发现即使您没有在图片所锚定的列上调用，也不能调用`picture.resize()`直到之后。`sheet.autoSizeColumn(i)``autoSizeColumn(i)`

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2012-05-10T14:46:26.437

在具有自定义字体的 HSSFWorkbook 上，我执行了以下操作以使徽标以正确的尺寸显示：

```
CreationHelper helper = wb.getCreationHelper();
Drawing drawing = sheet.createDrawingPatriarch();
ClientAnchor anchor = helper.createClientAnchor();
anchor.setDx1(LOGO_MARGIN * XSSFShape.EMU_PER_PIXEL);
anchor.setDx2(LOGO_WIDTH_IN_FUNNY_POI_FORMAT * XSSFShape.EMU_PER_PIXEL);
anchor.setDy1(LOGO_MARGIN * XSSFShape.EMU_PER_PIXEL);
anchor.setDy2(LOGO_HEIGHT_IN_FUNNY_POI_FORMAT * XSSFShape.EMU_PER_PIXEL);
drawing.createPicture(anchor, pictureIndex); 
```

我将 LOGO_HEIGHT... 和 LOGO_WIDTH.. 设置为所需的图像像素大小。

生成的图像不是原始比例，也不是预期的像素大小。所以我使用了预期尺寸/当前尺寸比率并相应地调整了 LOGO_WIDTH.. 和 LOGO_HEIGHT..。不漂亮，但它有效：/

然后不要打电话`Picture.resize()`。

请参阅[Apache POIU 错误 52504](https://issues.apache.org/bugzilla/show_bug.cgi?id=52504)或[此新闻组讨论有关 poi`Picture.resize()`](http://apache-poi.1045710.n5.nabble.com/Bug-of-HSSFPicture-resize-td2300077.html)和[POI 插入图片的快速指南](http://poi.apache.org/spreadsheet/quick-guide.html#Images)。

**更新**：当前代码如下所示，原始图像为 2000x450：

```
LOGO_MARGIN = 2;
int index = getLogoPictureIndex();
CreationHelper helper = this.wb.getCreationHelper();

Drawing drawing = this.sheet.createDrawingPatriarch();
ClientAnchor anchor = helper.createClientAnchor();

anchor.setDx1(LOGO_MARGIN * XSSFShape.EMU_PER_PIXEL);
anchor.setDy1(LOGO_MARGIN * XSSFShape.EMU_PER_PIXEL);

Picture pic = drawing.createPicture(anchor, index);
pic.resize(0.064); 
```

* * *

## 回答 #3

> 赞同：2
> 
>             
> 
> 时间：2014-06-09T09:54:03.473

好的解决方案是使用带有 scale 参数的 resize() 函数：

```
double scale = 0.3;
Picture pict = drawing.createPicture(anchor, pictureIdx);
pict.resize(scale); 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-07-15T21:38:18.167

在完成 setcolumnwidth() 之后，您不应该只握住图片对象并最后调用 resize() 吗？

# linux - 运行多个 Evince 实例

> ID：759859
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T10:13:12.717
> 
>         
> 
> 标签：linux, multiple-instances

我有一个 wxPython 应用程序，我正在使用 Evince 来显示它生成的报告。由于我想在用户关闭相应的 Evince 实例后删除每个报告，因此我的应用程序使用执行 subprocess.call() 的线程来调用 Evince，然后在子进程终止时删除报告。

只要用户一次只查看一份报告，此方法就可以正常工作，因为如果他打开一份报告，然后打开另一份报告（不关闭前一份报告），则先前的 Evince 实例将被“回收”以显示新报告，因此子进程。 call() 立即返回，文件很快被删除。

有没有办法强制 Evince 每次都使用一个新实例？

(Xubuntu 8.10)

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-20T07:09:12.387

Wouter Bolsterlee[建议](http://mail.gnome.org/archives/evince-list/2009-April/msg00018.html)：

> dbus-launch --exit-with-session evince file://...

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-19T23:26:42.607

你不能用 evince 做到这一点。尝试将其作为新功能推荐给开发人员。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2011-07-01T13:44:27.753

看起来 Ubuntu Lucid (2.30) 附带的版本**确实**适用于我的用例......也许他们改变了主意 :)

# css - 如何停止 IE6 通过负边距裁剪位于其父级之外的元素？

> ID：759862
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T10:13:59.503
> 
>         
> 
> 标签：css, internet-explorer, internet-explorer-6

我有一个元素通过负边距定位在其父级之外，如下所示：

```
<style>
.parent {
    height: 1%;
}

.element {
    float: left;
    margin-left: -4px;
}
</style>

...

<div class="parent">
    <div class="element">Element</div>
</div> 
```

在Internet Explorer 6 中，位于`.element`其父元素之外的部分被剪裁，即不可见、隐藏、切断。我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T10:15:39.920

分配`position: relative;`给`.element`，像这样：

```
<style>
.parent {
    height: 1%;
}

.element {
    float: left;
    margin-left: -4px;
    position: relative; /* Fixes clipping issue in IE 6 */
}
</style>

...

<div class="parent">
    <div class="element">Element</div>
</div> 
```

仅当父元素 hasLayout 时才需要这样做（这是一大堆蠕虫无法进入这里）。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-18T05:40:09.853

```
<style>
.parent {
    height: 1%;
    overflow: auto;
    _zoom: 1; /*ie6 hack forces has layout*/
}

.element {
    float: left;
    margin-left: -4px;
}
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-05-18T17:02:31.383

这发生在 IE6 中的负边距和浮点数相结合的情况下。

如果可以的话，摆脱浮动：

```
。元素 {
   浮动：无：
   缩放：1；
}

```

# asp.net - ASP.NET MVC 用户 - 您是否错过了 WebForms 中的任何内容？

> ID：759863
> 
>         
> 
> 赞同：20
> 
>         
> 
> 时间：2009-04-17T10:14:24.290
> 
>         
> 
> 标签：asp.net, asp.net-mvc, webforms

有很多关于 ASP.NET WebForms 和 ASP.NET MVC 之间差异的文章和讨论比较了这两个框架的相对优点。

对于任何有使用 WebForms 并且已经迁移到 MVC 的经验的人，我有一个不同的问题：

WebForms 拥有的、MVC 没有的、您真正想念的第一件事是什么？

## 编辑

没有人提到 WebForms 验证控件。我现在正在处理一些具有一些相关验证规则的代码，并且为这些实现客户端验证被证明是缓慢的。

* * *

## 回答 #1

> 赞同：24
> 
>             
> 
> 时间：2009-04-17T14:48:29.107

作为一名 PHP/Classic ASP 人员，我大约在 5 年前涉足 webforms 世界。在不得不用脚本语言手动编码表格网格、日历等内容之后，看起来 web 表单将成为一个巨大的帮助之手。它是......直到你需要除了交替行颜色等之外的一点点定制。是的，您可以通过一些拖放动作运行一个网格视图。但是，即使是看似简单的事情的定制也可能变成数小时的折磨和研究。

我还认为 .NET 在线中给出的许多示例都过于简单化了，以使 Web 表单看起来“简单”。当然，您可以让 gridview 只显示 100,000 条记录表中的 10 条记录，但是您是否意识到默认情况下所有记录都被加载到内存中？作为纠正该问题过于复杂的一个例子，我花了一段时间创建一个仅加载记录块的可分页网格视图，但它不起作用。经过一个小时的研究，我发现您必须删除 IDE 插入到代码隐藏中的额外属性。当像这样愚蠢的东西让你落后时，这并不有趣。

而且在每一个转折点，它都会发生。

甚至不要让我开始使用视图状态。  

但后来云分开了，.NET MVC 交给了我们。现在这是一个框架。如果您是 Web 开发人员，您应该知道当有人向您的 Web 服务器发出请求时会发生什么。Webforms 放在上面的抽象层和杂乱无章是一种伤害。

在大多数情况下，我能够以 PHP 脚本的速度开发应用程序，并且最终可以完全控制 UI。这就是它的一切。

并且作为附加说明：当人们发现他们必须使用 <%= %> 标签等时，他们需要停止抱怨他们在 MVC 视图中创建“标签汤”。将你的gridview拖放到页面上，设置所有属性，然后查看它给你的废话。而且您还没有完成，现在您必须附加事件并将更多与 gridview 相关的代码放入您的代码文件中。谈论搞砸编码体验。任何一天我都会使用一个简单的 foreach 循环。

* * *

## 回答 #2

> 赞同：17
> 
>             
> 
> 时间：2009-04-17T10:21:56.410

没有 ：）

我真的很喜欢 ASP.NET MVC 的工作方式。我想控制我的 HTML。我不需要控制。我们可以使用 HTML 助手和第三方工具（例如 jQuery 和所有可用的插件）获得相同的功能。

这是一个关于如何在 ASP.NET MVC 上使用类似 gridview 和[jQuery 网格的示例。](http://haacked.com/archive/2009/04/14/using-jquery-grid-with-asp.net-mvc.aspx)

尽管 Ruby on Rails 是一个更成熟的框架，但我确实认为 ASP.NET MVC 走在了正确的轨道上。

* * *

## 回答 #3

> 赞同：9
> 
>             
> 
> 时间：2009-04-17T10:26:31.140

我想念gridview，它很简单，只需很少的努力就可以内置排序和分页。我一直在使用网格功能，但在 mvc 中仍然没有找到好的替代方案

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-08-17T07:31:34.060

好吧，我确实想念一些东西：

在几秒钟内拥有可分页网格的能力。

虽然这不太公平，因为我还必须创建一个类来提供给 ObjectDataSource 以进行有效的分页。而且分页只能在 JavaScript 上工作，否则我必须编写代码来读取 QueryString（例如 &pag=2 等）等等。

事实上……我想没有太多的想念。

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T10:45:58.863

页面上只有一个表单的简单性。我认为 html 表单功能有点尴尬而且不是很直观，我想 webforms 创建者试图抽象出 webforms 中的表单处理是有充分理由的。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T14:29:50.713

我敢肯定，随着时间的推移，其中一个差异会得到纠正，即 Web 表单的在线参考资料和示例数量庞大，而 MVC 的数量相对较少。然而，有人可能会争辩说，很多关于 Web 表单的材料都涵盖了诸如页面生命周期之类的主题，而 MVC 不再需要这些主题（谢天谢地）。

* * *

## 回答 #7

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T14:57:58.663

直到现在真的什么都没有。

当我看到丑陋的 WebForms 代码时，我绝对想念 MVC，我想把它全部清除，现在让一切变得透明、干净和美观。

当然，只有时间才能证明新来的女孩是否真的比你的老妻子更好。

* * *

## 回答 #8

> 赞同：2
> 
>             
> 
> 时间：2009-04-19T05:08:26.833

听起来很疯狂，我想念日历控件。不是用于日期选择器或类似的东西，而是用于安排应用程序，您希望在其中显示整页的月份一览/展望风格的事件日历，其中包含您通过日渲染事件注入的可选择或可点击的链接。

如果有人知道 MVC 替代方案，请分享！在这种情况下自己滚动是可行的，但有点痛苦。

* * *

## 回答 #9

> 赞同：2
> 
>             
> 
> 时间：2009-08-17T07:40:38.303

Viewstate 是我想念的东西——直到我记得它引起的问题。  

然后我下定决心，寻找另一种方法（更智能的模型绑定、ajax 等），结果通常会更好（但发现和实现速度较慢）。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2010-04-27T08:50:58.090

我最想念的是文档。WebForms，因为它相对成熟，有很多官方文档，也有很多 3rd 方示例和片段可用。然而，这正在改进所有项目，并且随着 MVC 的发展势头，我希望它能够达到同等水平。

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:55:39.650

也没什么。

WebForms 自动完成了很多工作，但我经常不得不修改它以满足我的需要。MVC 让我做我想做的事，我可以破解它来让事情做得更好/更快。

我喜欢控制输出，喜欢干净、轻巧的风格。

* * *

## 回答 #12

> 赞同：0
> 
>             
> 
> 时间：2009-12-20T22:54:32.573

输出缓存并没有真正在 ASP.NET MVC 中实现（从版本 2 开始）。有一些技巧可以让它工作，比如[将 Web 控件与`OutputCache`指令](http://blog.codeville.net/2008/10/15/partial-output-caching-in-aspnet-mvc/)一起使用，或者[使用`WriteSubstitution`](http://haacked.com/archive/2008/11/05/donut-caching-in-asp.net-mvc.aspx)，但所有这些技巧都在某种程度上违背了 MVC 的本质。除了整个动作方法之外的任何东西的输出缓存在 ASP.NET MVC 中工作*确实很*棘手，并且总是会导致巨大的技术债务。由于输出缓存，尤其是在较新版本的 IIS 中，与数据层缓存相比具有令人难以置信的性能，这是一种耻辱。

* * *

## 回答 #13

> 赞同：0
> 
>             
> 
> 时间：2010-04-27T08:42:31.657

拖放控件的简单性。在不久的将来可能会在 mvc4 中看到其中的一些

* * *

## 回答 #14

> 赞同：0
> 
>             
> 
> 时间：2014-09-21T06:43:26.990

参考：- [http://www.codeproject.com/Articles/808297/Things-you-will-miss-in-ASP-NET-MVC-as-an-ASP-NET](http://www.codeproject.com/Articles/808297/Things-you-will-miss-in-ASP-NET-MVC-as-an-ASP-NET)

我不会说我想念，因为所有的变化都在发生。但是是的，我会想念下面的

1.  可爱的服务器控制谁只是眨眼间给出输出。

2.  后面的代码文件。由于某种原因，双击并转到后面的代码让我更胜一筹。

3.  视图状态魔术。

4.  现在我需要为 POST 和 GET 头疼。

![在此处输入图像描述](https://i.stack.imgur.com/Fy6o5.png)

# jquery - 如何将 DOM 节点创建为对象？

> ID：759887
> 
>         
> 
> 赞同：54
> 
>         
> 
> 时间：2009-04-17T10:22:49.857
> 
>         
> 
> 标签：jquery, dom

我想创建一个 DOM 节点，设置“id”属性，然后将其附加到“body”。以下似乎不起作用，因为 jQuery 没有将我的模板视为对象：

```
var template = "<li><div class='bar'>bla</div></li>";
template.find('li').attr('id','1234');
$(body).append(template); 
```

我如何告诉 jQuery 将其视为对象以便 find() 对其进行处理？

* * *

## 回答 #1

> 赞同：74
> 
>             
> 
> 时间：2009-04-17T10:32:50.283

我会先把它放在 DOM 中。我不确定为什么我的第一个示例失败了。这真的很奇怪。

```
var e = $("<ul><li><div class='bar'>bla</div></li></ul>");
$('li', e).attr('id','a1234');  // set the attribute 
$('body').append(e); // put it into the DOM 
```

放置 e （返回元素）给出了应用 CSS 选择器的jQuery[上下文。](https://api.jquery.com/jQuery/#jQuery-selector-context)这使它无法将 ID 应用于 DOM 树中的其他元素。

问题似乎是您没有使用 UL。如果你在 DOM 树中放置一个裸 li，你就会遇到问题。我认为它可以处理/解决这个问题，但它不能。

您可能不会将裸 LI 放在您的 DOM 树中以进行“真正的”实现，但 UL 是此工作所必需的。叹。

示例：http:
 [//jsbin.com/iceqo](http://jsbin.com/iceqo)

顺便说一句，您可能还对[微模板感兴趣](http://ejohn.org/blog/javascript-micro-templating/)。

* * *

## 回答 #2

> 赞同：27
> 
>             
> 
> 时间：2009-04-17T10:33:43.900

试试这个：

```
var div = $('<div></div>').addClass('bar').text('bla');
var li = $('<li></li>').attr('id', '1234');
li.append(div);

$('body').append(li); 
```

显然，直接将 li 附加到 body 是没有意义的。基本上，诀窍是使用 $('your html here') 构造 DOM 元素树。我建议使用 CSS 修饰符（.text()、.addClass() 等）而不是让 jquery 解析原始 HTML，这样以后更改内容会更容易。

* * *

## 回答 #3

> 赞同：15
> 
>             
> 
> 时间：2012-09-19T23:54:24.370

```
var template = $( "<li>", { id: "1234", html:
  $( "<div>", { class: "bar", text: "bla" } )
});
$('body').append(template); 
```

那这个呢？

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T10:50:24.343

首先将你的模板变成一个 jQuery 对象：

```
 var template = $("<li><div class='bar'>bla</div></li>"); 
```

然后设置属性并将其附加到 DOM。

```
 template.find('li').attr('id','1234');
 $(document.body).append(template); 
```

但是请注意，将 li 直接添加到 DOM 根本没有意义，因为 li 应该始终是 ul 或 ol 的子级。另外最好不要让 jQuery 解析原始 HTML。而是创建一个li，设置它的属性。创建一个 div 并设置它的属性。将 div 插入到 li 中，然后将 li 附加到 DOM。

* * *

## 回答 #5

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T11:04:18.023

这是一个班轮：

```
$("<li><div class='bar'>bla</div></li>").find("li").attr("id","1234").end().appendTo("body") 
```

但我想知道为什么您想在稍后阶段添加“id”属性，而不是直接在模板中注入它。

* * *

## 回答 #6

> 赞同：2
> 
>             
> 
> 时间：2016-12-19T18:42:50.403

您的示例失败的三个原因。

1.  原始的“模板”变量不是 jQuery/DOM 对象，无法解析，它是一个字符串。通过将其包装在 $() 中使其成为 jQuery 对象，例如：template = $(template)

2.  一旦 'template' 变量是一个 jQuery 对象，您需要意识到 <li> 是根对象。因此，您无法搜索 LI 根节点并获得任何结果。只需将 ID 应用于 jQuery 对象。

3.  当您将 ID 分配给 HTML 元素时，它不能以数字字符开头，在 HTML5 之前的任何 HTML 版本中。它必须以字母字符开头。对于 HTML5，这可以是任何非空白字符。有关详细信息，请参阅：[HTML 中 id 属性的有效值是什么？](https://stackoverflow.com/questions/70579/what-are-valid-values-for-the-id-attribute-in-html)

PS：示例代码的最后一个问题是 LI 不能应用于 BODY。根据 HTML 要求，它必须始终包含在一个列表中，即 UL 或 OL。

# php - PHP - 大整数 mod 计算

> ID：759888
> 
>         
> 
> 赞同：8
> 
>         
> 
> 时间：2009-04-17T10:22:55.580
> 
>         
> 
> 标签：php, integer, math, modulo

我需要计算大量的模数，例如：

```
<?php

    $largenum = 95635000009453274121700;

    echo $largenum % 97;

?> 
```

它不起作用......因为 $largenum 对于 PHP 中的 int 来说太大了。

知道怎么做吗？

* * *

## 回答 #1

> 赞同：24
> 
>             
> 
> 时间：2009-04-17T10:25:05.480

使用**[`bcmod()`](http://www.php.net/manual/en/function.bcmod.php)**BCMath**[任意精度数学](http://www.php.net/manual/en/book.bc.php)**：

```
$largenum = '95635000009453274121700';
echo bcmod($largenum, '97'); 
```

请注意，这`$largenum`是作为字符串传递的，而不是转换为 int 的。

# python - python ctypes 和 sysctl

> ID：759892
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T10:24:38.570
> 
>         
> 
> 标签：python, c, linux, ctypes

我有以下代码

```
import sys
from ctypes import *
from ctypes.util import find_library

libc = cdll.LoadLibrary(find_library("c"))
CTL_KERN = 1
KERN_SHMMAX = 34
sysctl_names = {
    'memory_shared_buffers' : (CTL_KERN, KERN_SHMMAX),
    }

def posix_sysctl_long(name):
    _mem = c_uint64(0)
    _arr = c_int * 2
    _name = _arr()
    _name[0] = c_int(sysctl_names[name][0])
    _name[1] = c_int(sysctl_names[name][1])
    result = libc.sysctl(_name, byref(_mem), c_size_t(sizeof(_mem)), None, c_size_t(0))
    if result != 0:
        raise Exception('sysctl returned with error %s' % result)
    return _mem.value

print posix_sysctl_long('memory_shared_buffers') 
```

产生以下结果：

```
Traceback (most recent call last):
  File "test.py", line 23, in <module>
    print posix_sysctl_long('memory_shared_buffers')
  File "test.py", line 20, in posix_sysctl_long
    raise Exception('sysctl returned with error %s' % result)
Exception: sysctl returned with error -1 
```

我猜我做错了什么。什么是正确的调用约定？我将如何找出究竟出了什么问题？

* * *

## 回答 #1

> 赞同：7
> 
>             
> 
> 时间：2009-04-17T12:49:11.813

您没有为 sysctl 函数提供正确的值。可以在[此处](http://www.linuxjournal.com/article/2365)找到有关 sysctl() 参数的详细信息。

这是您的错误：

*   您忘记了*nlen*参数（第二个参数）

*   oldlenp参数是指向大小的指针，而不是直接的*大小*

这是正确的功能（稍有改进）：

```
def posix_sysctl_long(name):
    _mem = c_uint64(0)
    _def = sysctl_names[name]
    _arr = c_int * len(_def)
    _name = _arr()
    for i, v in enumerate(_def):
        _name[i] = c_int(v)
    _sz = c_size_t(sizeof(_mem))
    result = libc.sysctl(_name, len(_def), byref(_mem), byref(_sz), None, c_size_t(0))
    if result != 0:
        raise Exception('sysctl returned with error %s' % result)
    return _mem.value 
```

# sql - 将服务器名称作为变量

> ID：759893
> 
>         
> 
> 赞同：6
> 
>         
> 
> 时间：2009-04-17T10:24:48.807
> 
>         
> 
> 标签：sql, sql-server, tsql

我正在尝试从不同的服务器获取数据，并且服务器名称可能会更改。所以我将服务器名称设置为参数。我的 sql 存储过程的想法是这样的

```
CREATE PROCEDURE [dbo].[GetData]
        @ServerName
AS
BEGIN
    SELECT * FROM @ServerName.ClientDataBase.dbo.Client
END 
```

有谁知道如何实现这一目标？

数据库版本为sql server 2005

* * *

## 回答 #1

> 赞同：5
> 
>             
> 
> 时间：2009-04-17T10:25:57.820

使用动态 SQL，但是这可能是邪恶的：

```
exec('select * from ' + @ServerName + '.ClientDatabase.dbo.Client') 
```

* * *

## 回答 #2

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T10:59:35.413

看看使用同义词

创建语法（来自 MSDN）：

```
CREATE SYNONYM [ schema_name_1\. ] synonym_name FOR < object >

< object > :: =
{
    [ server_name.[ database_name ] . [ schema_name_2 ].| 
         database_name . [ schema_name_2 ].| schema_name_2\. ] object_name
} 
```

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T11:32:06.553

你可以设置一个链接服务器，说“BOB”。

然后您可以调用 sp_setnetname 来更改底层目标服务器，但保留名称 BOB。

所以你的代码是：

```
CREATE PROCEDURE [dbo].[GetData]
        @ServerName
AS
BEGIN
    EXEC sp_setnetname 'BOB', @ServerName
    SELECT * FROM BOB.ClientDataBase.dbo.Client
END 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2013-03-23T18:16:51.913

```
-- Proc to get remove server name (domaine+instance name)

IF OBJECT_ID('dbo.getRemoteName') IS NOT NULL
        DROP PROC dbo.getRemoteName;
GO
CREATE PROC dbo.getRemoteName
 @id AS INT,
 @RETURN AS VARCHAR(100) OUTPUT
AS 
BEGIN 
 DECLARE @GetInstances TABLE
 ( id INT IDENTITY(0,1),
  VALUE NVARCHAR(100),
   instanceName NVARCHAR(100),
  DATA NVARCHAR(100))

 INSERT INTO @GetInstances
 EXECUTE xp_regread
 @rootkey = 'HKEY_LOCAL_MACHINE',
 @KEY = 'SOFTWAREMicrosoftMicrosoft SQL Server',
 @value_name = 'InstalledInstances'

 -- order ascendant 
 -- Select * from @GetInstances -- uncomment to see all the instances that your have
 SELECT @RETURN=instanceName FROM @GetInstances WHERE id=@id ORDER BY instanceName ASC;
 SET @RETURN=HOST_NAME()+''+@RETURN;
END;
GO

DECLARE @RETURN AS VARCHAR(100);
-- get the instance number 0
EXEC getRemoteName 0, @RETURN OUTPUT;
PRINT @RETURN; 

-- 

exec('SELECT * FROM ['+@RETURN+'].RemoteDatabase.dbo.SampleTable'); 
```

# delphi - 让“私人”成员表现得像“严格私人”

> ID：759896
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T10:25:29.287
> 
>         
> 
> 标签：delphi, oop

即将推出的 Delphi 版本中启用该功能的功能怎么样？

也许它可能是一个编译器开关，将所有 ** `private`**s 提升为 ** `strict private`**s。

...或者它可能是新的[非传统编译器字体端](http://edn.embarcadero.com/article/39174)Nick Hodges 正在谈论的一个特性。=>**`private`**的行为总是像**`strict private`**.

**编辑：**我想要这个的原因是因为我不想在我的修饰符中添加数千个`strict`s 。`private`此外，“严格私有”行为是我熟悉的任何面向对象语言的默认行为！

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-04-17T10:42:14.397

引用文章：

> 因此，我们正在努力创建一个“新的 Delphi”和一个新的编译器架构，以保持您现有的代码正常工作，使用 Delphi 和 C++Builder 生成 64 位二进制文​​件，也许还有一些其他类型的二进制文件，而我们在它。这一切都必须正确完成，以便一切都为您服务。

我将其解释为，如果 codegear 要改变 private 的行为。然后他们将提供一个选项来保持旧的行为，就像他们过去所做的那样。

只是为了澄清，在一个类中有 6 个不同的访问级别（好的 7，但不推荐使用自动化）。

```
public: Anything that can access the object can access this.
protected: Methods in the class and its subclasses and anything in the same unit can access.
strict protected: Methods in the class and its subclasses can access.
private: Methods in the class and anything in the same unit can access.
strict private: Methods in the class.
published: As public buth with runtime information for the object inspector. 
```

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T16:19:08.297

当前的私有实现对于声明它的单元之外的所有内容都是私有的。因此，如果您不想添加**严格**语句的原因是您不想修改现有单元，那么除了破坏任何单元之外，您将一无所获访问同一单元中的类的现有代码。只要你现有的单位没有被修改，那么**严格**和非**严格私人**之间的区别就是学术性的。  

**如果您对严格**行为的推理是使用编译器来帮助您*重构*利用较少**私有**行为的代码，那么一次将**严格**添加到一个类是一种很好的增量方法，因此您可以获得可编译且可测试状态更频繁。整个销售行为的改变需要在您知道其中任何一个是否有效之前修复所有违规行为。

**私有**行为的原因类似于 C++ 的**朋友**——它允许某些类（或过程代码）访问**私有**成员。*VCL*和*RTL*大量使用了这种行为，因此编译器切换或全面更改会破坏所有代码。  

Delphi 的**private**实现对于所有实际目的来说都是私有的，因为通常您控制声明您的类的单元。如果您只*为每个单元声明一个类*，并且从不包含过程代码，那么区别只是学术上的。  

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T15:06:30.920

我不太明白这个问题。但是你为什么需要这个功能呢？如果这是您想要的，为什么不直接用 Strict Privates 替换代码中的 Privates？

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T18:29:40.823

我预计您想要更改含义的原因`private`是您想要更严格的行为而不必破坏向后兼容性。我想你正在制作一个你希望在 Delphi 7 和更早版本中使用的库，它没有`strict`修饰符。

但如果这不是你的理由，那么我认为你没有太多工作要做。您可以使用简单的脚本轻松地将所有`private`代码转换为。`strict private`

```
perl -i.bak -pe 's/(?<!\bstrict )\b(private|protected)\b/strict $1/ig' *.pas

```

这需要任何`private`或`protected`尚未严格的并放在`strict`它前面。它就地修改文件。（当心；它也可能在字符串文字中插入“严格”。）

所以无论如何，我认为我们不会`private`很快看到变得严格。这样做可能会破坏旧代码，并且实际上并没有太多实际收益。它让纯粹主义者拥有“更纯粹”的代码，但他们已经可以通过简单地使用`strict`. 我认为，如果我们要拥有“默认严格”可见性，那么更改的时间就是`strict`最初引入的时间。但是就像今天的情况一样，我们已经有了一种获得严格可见性说明符的方法，因此不需要进行其他更改。

# c# - 知道哪些字段已更改的工作流

> ID：759899
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T10:26:04.793
> 
>         
> 
> 标签：c#, sharepoint, workflow

我正在编写一个工作流，该工作流需要根据某人编辑项目时更改的字段来执行某些操作。例如，如果用户进入并从项目（员工）中删除角色（工作），那么我需要工作流来意识到角色字段已更改，推断出哪个角色被删除（或可能添加），然后通知该角色的经理并执行任何其他必要的任务。另一个示例是，如果项目中的地址字段发生更改，则需要将更改通知相应的人力资源部门。

为此，我将在工作流启动时尝试一个代码块，它比较前两个历史条目，并且任何不同的字段都将被标记为已更改，我将根据每个字段采取适当的操作。

谁能告诉我获得此功能的其他选择是什么，因为我想知道是否有更好的方法。谢谢

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T23:24:24.610

我会在列表上启用版本控制，然后使用：

```
SPListItem currentItem = workflowProperties.Item;
SPListItemVersion previousItemVersion = currentItem.Versions[1];
//Compare the fields in currentItem and previousItemVersion 
```

但是，如果我正确理解您的问题，那就是您即将要做的事情。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T11:18:10.033

使用 SPD 工作流程不会那么难，具体取决于角色的数量。

创建一个列，然后进入内容类型并将其隐藏。创建在新的或更改时执行的 SPD 工作流。比较隐藏列和用户输入的列，如果发生更改，将值与角色名称进行比较，然后执行需要完成的操作。完成后，将用户输入的列复制到隐藏列中。

丑陋而冗长，但如果您没有能力在服务器上实现工作流代码，感谢企业 IT，那么它是一种选择。

# versioning - 是否在许多工具中同步构建数字？

> ID：759902
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T10:26:40.843
> 
>         
> 
> 标签：versioning

我们目前有许多办公产品和嵌入式产品。它们都具有相同的版本方案*major*。*未成年人*。*内部版本号*。*svn 修订版*。随着夜间和手动构建增加构建号。

从开发支持方面来看，这使得管理“正确版本”变得非常容易，但是当一个工具从 v10 更改为 v200 并且我们说没有任何更改时，现场支持人员会感到恐慌。

由于我们对它的热爱，我们错过了这个方案（所有同步）有什么问题吗？

更新：这是在飞跃增加的内部*版本号*，主要次要仅按年度类型规模更改。

在时间 x 的所有文件的*svn 修订版*都是相同的，但没有人真正注意到这一点。

所有 .exe 和 .dll 等都具有相同的 XYWZ 编号。所以当我们在嵌入式产品上做很多工作时，办公产品从 1.1.10.1234 到 1.1.132.4321。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:47:21.933

我不会真的说这是一个问题，只要他们可以轻松地查找更改日志以查看更改的内容。

但从逻辑上思考，如果任何产品中都没有更新任何库，也没有对产品本身进行任何更改，那么版本号应该保持不变。

我能提出的唯一建议是改用一个过时的版本号，这样主要和次要版本就不会变化得这么快。像 9.0417.yyyy.xxxx 这样的东西将是 2009 年 4 月 17 日发布的版本，其中 yyyy 和 xxxx 的内部版本号作为 svn 修订版。如果您不想更改主要编号并希望将日期保留在次要中，​​您可以使用 Microsoft 的版本控制风格。[在http://blogs.msdn.com/jensenh/archive/2005/11/11/491779.aspx](http://blogs.msdn.com/jensenh/archive/2005/11/11/491779.aspx)上有一篇很好的关于 Microsoft 如何进行版本控制的博客文章。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T11:01:35.690

我使用了聚合版本控制方案。所以你说你有很多产品，如果部署的字段版本共享相同的修订号 - 我假设这意味着如果你更新你的嵌入式库，办公产品不使用这些库，办公产品仍然会得到一个新的修订号，即使其中没​​有更改任何代码。

所以在聚合方案中，SYSTEM有一个大版本号，每个子系统都有自己的。我正在使用 clearcase 表示法，因为我不知道 svn 中等价物的术语：顶级组件在其下具有层次结构中的所有子组件（认为一个组件就像一个包含代码的文件夹，因此所有内容都在该文件夹共享相同的版本，或“基线”，如 clearcase 所称）。

如果我在顶级系统组件中创建一个新基线（版本），它会用新版本对其进行标记，并且所有子组件也会获得一个新版本（可能具有不同的版本控制方案），但前提是它们已经更改。

对于顶级系统版本，我们使用日期时间基线和“版本号”。然后，每个子系统都有major/minor/build/svn。此外，我们不会在“about->help”或等效项中显示 svn 和内部版本号，只有深入了解一些“系统配置”文件才能提取实际的内部版本/svn 编号（例如，通过查看在可执行文件中的元数据）。这样，用户只能看到主要/次要版本，而不是构建和 svn 编号的 gobbledigook。

# xcode - 如何将 Xcode 中的源代码插入 OpenOffice 而不为每一行获取一个段落？

> ID：759903
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T10:27:31.560
> 
>         
> 
> 标签：xcode, formatting, openoffice.org

这对于良好的文档很重要，但目前它不能很好地工作。如果我将源代码从 Xcode 编辑器复制到 OpenOffice Writer 中，那么每一行都是一个单独的段落。我有源代码的段落样式，但是由于有多个段落，我得到了很多不必要的空格。

我可以编写一个将这些源代码段落组合成一个段落的宏，还是有一种简单的方法来处理这个问题？将某些内容复制到剪贴板时，可能是 Xcode 中的一些文本格式设置？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-18T00:34:13.537

抱歉，如果我在这里偏离了标记，但是当您在 Open Office 中粘贴时，而不是正常粘贴 ctrl-v，您是否尝试过使用 ctrl-shif-v？选择性粘贴，然后选择无格式文本。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:42:05.940

我猜您的源代码段落样式在段落之前或之后包含垂直空格。你只需要删除那个空格。

# sockets - 可以发送我输入的原始消息的简单套接字服务器？

> ID：759905
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T10:27:59.907
> 
>         
> 
> 标签：sockets, putty

是否存在一个简单的套接字服务器来发送我想发送给所有客户端的任何消息？我需要这样做来测试套接字客户端。而 FAFAIK Putty 无法做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T11:11:42.170

我不确定你想要什么，但也许看看 netcat（几乎所有平台都有端口，只需搜索 netcat）。

有关 netcat 功能的概述，请查看[它的手册页](http://www.openbsd.org/cgi-bin/man.cgi?query=nc)。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T11:41:01.337

如果它是 tcp 套接字，您可以使用“telnet portno”

# python - sys.getrefcount 延续

> ID：759906
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T10:28:15.537
> 
>         
> 
> 标签：python, del

[链接文本](https://stackoverflow.com/questions/759740/sys-getrefcount/759763#759763)

我得到了引用计数的概念

因此，当我执行“del astrd”时，引用计数降至零并且 astrd 被 gc 收集？

这是示例代码。我在昨天的问题之后开发的这些代码：[链接文本](https://stackoverflow.com/questions/755694/delete-pyc)

一个.py：

定义 abc():

```
print "Hello"
print "123"
print '345' 
```

二.py：

```
import one
#reload(one)

#def defg():

one.abc() 
```

三.py：

```
import os,sys,gc
from time import sleep

import two
#reload(two)
#two.defg()

sleep(20)

directory = os.listdir('.')

for filename in directory:

        if filename[-3:] == 'pyc':

                print '- ' + filename

                print sys.getrefcount(filename)

                file_name = os.path.splitext (filename)[0]

                del file_name   # remove the local reference

                del sys.modules[os.path.splitext (filename)[0]] # removes import

                gc.collect()    # garbage collect

                #del sys.modules[filename]

                #del filename

                #os.remove(filename) 
```

我在three.py 中所做的是否正确？是否有任何不必要的步骤？如果是，为什么？

请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：8
> 
>             
> 
> 时间：2009-04-17T10:50:02.147

我相信内存会在 refcount 达到零的那一刻自动释放。GC 不参与。

python GC 是可选的，仅在存在具有引用周期的不可访问对象时使用。事实上，`gc.disable()`如果您确定您的程序不会创建引用循环，则可以调用。

至于原来的问题：

*   当你这样做时`del astrd`，你会从本地命名空间中删除对对象的引用（无论 asstrd 引用什么）的绑定。

*   如果这意味着引用计数为零，则释放对象使用的内存。

*   所以`del`不会删除对象，它会取消绑定引用。如果取消绑定引用导致引用计数达到零，则删除对象是一种副作用。

请注意，上述内容仅适用于 CPython。我相信 Jython 和 IronPython 使用 JVM/CLR GC 机制，根本不使用引用计数。

方便`gc.get_objects`返回 python 解释器跟踪的所有对象实例的列表。例子：

```
导入 gc

类测试（对象）：
    经过

def number_of_test_instances():
    return len([obj for obj in gc.get_objects() if isinstance(obj, test)])

对于范围内的我（100）：
    t = 测试（）

print "创建和放弃100个实例，现在有", \
    number_of_test_instances(), \
    “python 解释器已知的实例。”

# 请注意，在正常操作中，GC 会
# 检测不可达对象并启动
# 立即收集它们
gc.disable()

对于范围内的我（100）：
    t = 测试（）
    tt = t

print "用循环引用创建和放弃了 100 个实例，现在有", \
    number_of_test_instances(), \
    “python 解释器已知的实例。”

gc.collect()
print "手动执行 gc.collect() 后，现在有", \
    number_of_test_instances(), \
    “python 解释器已知的实例。”

```

运行这个程序给出：

```
创建和放弃 100 个实例，现在有 1 个实例为 Python 解释器所知。
使用循环引用创建和放弃 100 个实例，现在有 100 个实例为 Python 解释器所知。
手动执行 gc.collect() 后，python 解释器现在知道 1 个实例。

```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:32:41.563

它有**机会**在下一次 GC 收集运行时被收集。

见：[http ://docs.python.org/library/gc.html](http://docs.python.org/library/gc.html)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T16:04:25.603

你能提供一些关于你在做什么的背景吗？`del`除了清理您不想公开的事物的名称空间之外，很少有任何理由显式使用on 变量。我不确定你为什么打电话`del file_name`或跑步`gc.collect()`。（`del sys.modules[filename]`很好 - 这是 del 的不同用法）

对于对象，当它们最终确定的确切时间无关紧要时（例如，像 file_name 这样的字符串），您也可以让变量退出范围 - 当您的函数完成时，它将被收集，并且不会造成任何伤害直到那时。手动调用`del`此类变量只会使您的代码混乱。

对于需要立即完成的对象（例如打开的文件或持有的锁），无论如何您都不应该依赖垃圾收集器 - 不能保证立即收集这些对象。它恰好在标准 C python 实现中这样做，但在 Jython 或 IronPython 中没有，因此不能保证。`close`相反，您应该通过调用或使用 new`with`构造来显式清理此类对象。

唯一的另一个原因可能是您分配了非常大量的内存，并且希望在引用它的变量自然超出范围之前发出信号您已经完成了它。

但是，您的示例似乎不适合这两种情况，所以我不确定您为什么要手动调用垃圾收集器。

# java - 如何使用 iText 在每个页面上添加总页码？

> ID：759909
> 
>         
> 
> 赞同：31
> 
>         
> 
> 时间：2009-04-17T10:29:59.387
> 
>         
> 
> 标签：java, itext

如何使用 iText 在每页上添加总页码？

* * *

## 回答 #1

> 赞同：15
> 
>             
> 
> 时间：2009-04-17T10:50:36.467

1.  使用虚拟页数处理从 a`PdfWriter`到 a的输出。`bytestream`

2.  `PdfReader`从中创建一个`bytestream`，调用`PdfReader.getNumberOfPages`以获取实际的页数。

3.  重新创建 PDF 输出，知道页数是多少，相应地更改页脚。

这很混乱，但是如果没有两次通过的方法，就没有简单的方法来了解页数。有关操作 PDF 的详细信息，请参阅[示例代码](http://developers.itextpdf.com/examples/columntext-examples-itext5/adding-page-numbers-existing-pdf)。

* * *

## 回答 #2

> 赞同：8
> 
>             
> 
> 时间：2012-08-23T17:17:17.743

您可以创建一个继承自然`PdfPageEventHelper`
后覆盖这两个函数的类，如下所示：

```
Imports System.Collections.Generic
Imports System.Text

Imports iTextSharp.text.pdf
Imports iTextSharp.text

Namespace PDF_EnteteEtPiedDePage
    Public Class EnteteEtPiedDePage
        Inherits PdfPageEventHelper
        ' This is the contentbyte object of the writer
        Private cb As PdfContentByte

        ' we will put the final number of pages in a template
        Private template As PdfTemplate

        ' this is the BaseFont we are going to use for the header / footer
        Private bf As BaseFont = Nothing

        ' This keeps track of the creation time
        Private PrintTime As DateTime = DateTime.Now

        ' we override the onOpenDocument method
        Public Overrides Sub OnOpenDocument(writer As PdfWriter, document As Document)
            Try
                PrintTime = DateTime.Now
                bf = BaseFont.CreateFont(BaseFont.HELVETICA, BaseFont.CP1252, BaseFont.NOT_EMBEDDED)
                cb = writer.DirectContent
                template = cb.CreateTemplate(50, 50)
            Catch de As DocumentException
            Catch ioe As System.IO.IOException
            End Try
        End Sub

        Public Overrides Sub OnStartPage(writer As PdfWriter, document As Document)
            MyBase.OnStartPage(writer, document)

            Dim pageSize As Rectangle = document.PageSize

        End Sub

        Public Overrides Sub OnEndPage(writer As PdfWriter, document As Document)
            MyBase.OnEndPage(writer, document)

            Dim pageN As Integer = writer.PageNumber
            Dim text As [String] = "Page " & pageN & " de "
            Dim len As Single = bf.GetWidthPoint(text, 8)

            Dim pageSize As Rectangle = document.PageSize

            cb.SetRGBColorFill(100, 100, 100)

            cb.BeginText()
            cb.SetFontAndSize(bf, 8)
            cb.SetTextMatrix(pageSize.GetLeft(40), pageSize.GetBottom(30))
            cb.ShowText(text)
            cb.EndText()

            cb.AddTemplate(template, pageSize.GetLeft(40) + len, pageSize.GetBottom(30))

            cb.BeginText()
            cb.SetFontAndSize(bf, 8)
            cb.ShowTextAligned(PdfContentByte.ALIGN_RIGHT, "Imprimé le : " & PrintTime.ToShortDateString() & " à " & PrintTime.ToShortTimeString, pageSize.GetRight(40), pageSize.GetBottom(30), 0)
            cb.EndText()
        End Sub

        Public Overrides Sub OnCloseDocument(writer As PdfWriter, document As Document)
            MyBase.OnCloseDocument(writer, document)

            template.BeginText()
            template.SetFontAndSize(bf, 8)
            template.SetTextMatrix(0, 0)
            template.ShowText("" & Convert.ToString((writer.PageNumber - 1)))
            template.EndText()
        End Sub

    End Class
End Namespace 
```

然后在这之后只需设置你的值`pdfwriter PageEvent`  ：

```
Dim PageEventHandler = New EnteteEtPiedDePage()
            aPdfWriter.PageEvent = PageEventHandler 
```

* * *

## 回答 #3

> 赞同：4
> 
>             
> 
> 时间：2012-01-05T18:13:47.007

没有更多的搜索，这里是解决方案。如果他们删除此链接，我会将代码发布到我的网站并托管该链接。

[iText 页码示例](http://itextpdf.com/examples/iia.php?id=128)

* * *

## 回答 #4

> 赞同：3
> 
>             
> 
> 时间：2011-07-16T01:53:55.687

这是我使用的代码。将页面写入输出不会增加太多开销。

```
outputStream = new ByteArrayOutputStream();
output = new DataOutputStream(outputStream);
document = new Document();
writer = PdfWriter.getInstance(document, output);
document.open();
contentByte = writer.getDirectContent();
....add stuff
document.close();
writer.close();
byte[] output = outputStream.toByteArray();
PdfReader reader = new PdfReader(output);
//reset the output
outputStream = new ByteArrayOutputStream();
output = new DataOutputStream(outputStream);
document = new Document();
writer = PdfWriter.getInstance(document, output);
document.open();
PdfStamper stamper = new PdfStamper(reader, outputStream);
//add the pages
for (int i = 1; i <= pageCount; i++)
{
    contentByte = stamper.getOverContent(i);
    addParagraph("Page " + i + " of " + pageCount, new Point(500, 30), boldTextFont);  // my own paragraph font
}
stamper.close(); 
```

* * *

## 回答 #5

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T10:43:35.173

从快速的网络搜索中提醒自己这一点；看一眼

[例子](http://1t3xt.info/examples/browse/?page=example&id=223)

相关方法是`onEndPage()`生成“X”并`onCloseDocument()`在您点击文档末尾时生成“Y”。

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2014-03-10T19:07:00.317

这是一个方便的功能！（基于 Milhous 的方法）（这里使用 itext 版本 4.1.6.0）

```
public static byte[] AddPageNumbers(byte[] pdf)
        {
            PdfReader reader = new PdfReader(pdf);
            var Pages = reader.NumberOfPages;
            MemoryStream ms = new MemoryStream();

            PdfStamper stamper = new PdfStamper(reader, ms);
            for (int i = 1; i <= Pages; i++)
            {
                PdfContentByte overContent;
                Font Signature = FontFactory.GetFont("Calibiri", 9, iTextSharp.text.Font.NORMAL, Color.BLACK);
                overContent = stamper.GetOverContent(i);
                var helv = BaseFont.CreateFont(BaseFont.HELVETICA, BaseFont.WINANSI, BaseFont.NOT_EMBEDDED);
                overContent.SaveState();
                overContent.BeginText();
                overContent.SetFontAndSize(helv, 10.0f);
                overContent.SetTextMatrix(PageSize.LETTER.Width / 2 - 20, PageSize.LETTER.Height - (PageSize.LETTER.Height - 20));
                overContent.ShowText("Page " + (i) + " of " + Pages);
                overContent.EndText();
                overContent.RestoreState();
            }
            stamper.Close();            
            return ms.ToArray();
        } 
```

* * *

## 回答 #7

> 赞同：0
> 
>             
> 
> 时间：2014-01-22T14:20:36.513

试试这个，因为我也遇到了这个问题，而且我也新建了这个库，所以在经历了很多麻烦之后，我得到的结果只是尝试应用逻辑两次，就像我在评论中提到的那样。

```
class PdfReportServlet extends HttpServlet
{
    public static int total = 0;

    public static int getTotal() 
    {
        return total;
    }

    public static void setTotal(int total) {
        PdfReportServlet .total = total;
    }

    public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException 
    {
        String reportFor = request.getParameter("report");
        if(!"".equals(reportFor))
        {
            if(reportFor.equals("pdf"))
            {
    /* 
       from here logic starts
    */
                response.setContentType("application/pdf");
                Document document = new Document(PageSize.LETTER.rotate());
                try
                {
                    ByteArrayOutputStream bos = new ByteArrayOutputStream();
                    PdfWriter pdfWriter = PdfWriter.getInstance(document, bos);
                    PdfReport pdfReport = new PdfReport();
                    pdfWriter.setPageEvent(pdfReport);
                    document.open();
                    String id = request.getParameter("id");
                    DettagliFamigliaPDFReport.generatePDFReport(document,id);
                    document.close();

                    /*
                     * now again give new references to Document and PdfWriter classes.
                     */

                    document = new Document(PageSize.LETTER.rotate());

                    pdfWriter = PdfWriter.getInstance(document, response.getOutputStream());
                    PDFReport.setTotalPages(getTotal());/*##PAGES_TOTAL here i set total Pages which i get from above logic */
                    PdfReport pdfReport = new PdfReport();
                    pdfWriter.setPageEvent(pdfReport);
                    document.open();
                    id = request.getParameter("id");
                    PDFReport.generatePDFReport(document,id);
                    document.close();

                }
                catch(DocumentException de){
                    de.printStackTrace();
                }
                catch (Exception e) {
                    e.printStackTrace();
                }
            }
        }
    }

}

/*
    Here below i write the class inherits the PdfPageEventHelper class and also having generatePDFReport() method.
*/

public class PDFReport extends PdfPageEventHelper
{
    public static PdfTemplate template;
    public static int totalPages=0;

    public static int getTotalPages() {
        return totalPages;
    }

    public static void setTotalPages(int totalPages) {
        DettagliFamigliaPDFReport.totalPages = totalPages;
    }

    public static void generatePDFReport(Document document,String id)
    {
        // here your data to write on page of pdf.
    }

    @Override
    public void onOpenDocument(PdfWriter writer, Document doc) 
    {
        template = writer.getDirectContent().createTemplate(100, 100);
    }

    int totalPage = 0;
    @Override
    public void onCloseDocument(PdfWriter writer, Document doc) 
    {
        totalPage = writer.getPageNumber() - 1;/* at the end this method calls and you will get total number of pages.*/
        PdfReportServlet.setTotal(totalPage); /* while first time logic of servlet executes then i set the total pages to servlet's variable using this logic.
and second time servlet's logic is executing i passed totalPages to this class variable
where i marked ##PAGES_TOTAL  */
    }

    @Override
    public void onStartPage(PdfWriter writer, Document doc) {
        // Here i write header logic when each time page starts.
    }

    @Override`enter code here`
    public void onEndPage(PdfWriter writer, Document doc) 
    {
        Rectangle rect = writer.getPageSize();
        float width = rect.getWidth()/2;   

        DateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy");
        Date date = new Date();

        String footerOne = "This document is printed on date "+dateFormat.format(date)+" - Page. "+writer.getPageNumber()+" of "+getTotalPages();

        Paragraph paraOne = new Paragraph(footerOne);

        Font fontFooter = new Font();
        fontFooter.setSize(8);
        fontFooter.setColor(Color.gray);

        paraOne.setFont(fontFooter);

        Phrase footerPhraseOne = new Phrase(paraOne);
        ColumnText.showTextAligned(writer.getDirectContent(),
                Element.ALIGN_CENTER, footerPhraseOne,
                width, 30, 0);
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
>             
> 
> 时间：2015-03-30T20:53:01.763

这是您的代码片段：

```
final PdfWriter writer = PdfWriter.getInstance(document, outputStream);
writer.setPageEvent(new PageStamper()); 
```

和编号代码：

```
import com.itextpdf.text.*;
import com.itextpdf.text.pdf.*;
import com.itextpdf.tool.xml.*;
import com.itextpdf.tool.xml.css.*;

import java.io.IOException;

/**
 * Adds page number to al the pages except the first.
 */
public class PageStamper extends PdfPageEventHelper {
    private static final Logger logger = Logger.getLogger(PageStamper.class);

    @Override
    public void onEndPage(PdfWriter writer, Document document) {
        final int currentPageNumber = writer.getCurrentPageNumber();

        if (currentPageNumber == 1) {
            return;
        }

        try {
            final Rectangle pageSize = document.getPageSize();
            final PdfContentByte directContent = writer.getDirectContent();

            directContent.setColorFill(BaseColor.GRAY);
            directContent.setFontAndSize(BaseFont.createFont(), 10);

            directContent.setTextMatrix(pageSize.getRight(40), pageSize.getBottom(30));
            directContent.showText(String.valueOf(currentPageNumber));

        } catch (DocumentException | IOException e) {
            logger.error("PDF generation error", e);
        }
    }
} 
```

**此代码可在此处找到：http: [//blog.abelsky.com/2014/01/22/adding-page-number-to-itext-generated-pdf/](http://blog.abelsky.com/2014/01/22/adding-page-number-to-itext-generated-pdf/)。非常感谢，andy722**

* * *

## 回答 #9

> 赞同：0
> 
>             
> 
> 时间：2016-02-22T20:29:01.447

正如其他答案所示，您首先需要创建 pdf，然后查看您创建的 pdf 包含多少页，然后将页脚添加到每页。执行此操作的理想类是 PdfStamper，其目的是向现有 pdf/现有 pdf 页面添加其他元素。

这是一个基于 Milhous 示例的详细示例：

```
Font smallFont = FontFactory.getFont("Arial", 9, Font.NORMAL);
ByteArrayOutputStream pdfOutputStream = new ByteArrayOutputStream();
Document document = new Document(PageSize.A4, 70, 70, 40, 40);
PdfWriter pdfWriter = PdfWriter.getInstance(document, pdfOutputStream);

document.open();
//CREATE PDF HERE - ADD CONTENT TO DOCUMENT
document.close();

int pageCount = pdfWriter.getPageNumber()-1;
byte[] pdfAsBytes = pdfOutputStream.toByteArray();

//add footer
PdfReader reader = new PdfReader(pdfAsBytes);
ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
DataOutputStream output = new DataOutputStream(outputStream);
document = new Document();
document.open();
PdfStamper stamper = new PdfStamper(reader, output);
for (int i = 1; i <= pageCount; i++) {
  ColumnText.showTextAligned(stamper.getOverContent(i), 
    Element.ALIGN_CENTER, new Phrase(i+"/" + pageCount, smallFont), 550, 30, 0);
}
stamper.close();
byte[] finalPdfAsBytes = outputStream.toByteArray(); 
```

* * *

## 回答 #10

> 赞同：0
> 
>             
> 
> 时间：2016-07-29T09:30:36.850

这是用 Java 转换的 Rama 代码（至少是其中的一部分）

```
public class test extends PdfPageEventHelper{
    private int _pg = 0;
    private BaseFont font;

    @Override
    public void onEndPage(PdfWriter writer, Document document) {
        _pg++;
        PdfContentByte cb = writer.getDirectContent();
        cb.beginText();
        try {
            Rectangle pageSize = document.getPageSize();
            cb.setFontAndSize(font, 8);
            cb.setTextMatrix(pageSize.getLeft(40), pageSize.getBottom(15));
            String s = "Page " + _pg + "/";
            cb.showText(s);
            cb.addTemplate(template, pageSize.getLeft(40) + font.getWidthPoint(s, 8), pageSize.getBottom(15));
        } catch (Exception exc) {
            logger.warn("got Exception : " + exc.getMessage());
        }
        cb.endText();
    }

    @Override
    public void onOpenDocument(PdfWriter writer, Document document) {
        super.onOpenDocument(writer, document);
        template = writer.getDirectContent().createTemplate(50, 50);
        try {
            font = BaseFont.createFont(BaseFont.COURIER, BaseFont.WINANSI, BaseFont.NOT_EMBEDDED);
        } catch (Exception exc) {
            logger.warn("got Exception : " + exc.getMessage());
        }
    }

    @Override
    public void onCloseDocument(PdfWriter writer, Document document) {
        super.onCloseDocument(writer, document);

        template.beginText();
        try {
            template.setFontAndSize(font, 8);
            template.setTextMatrix(0f, 0f);
            template.showText("" + (writer.getPageNumber() - 1));
        } catch (Exception ex) {
            logger.error(ex);
        }
        template.endText();
    }

} 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2019-04-05T11:32:20.880

经过两天的努力！我终于得到了 PDF 中的总页数。实际上，我的客户要求是仅在 PDF 的最后一页显示页脚。我就是这样做的，希望它对将来的人有所帮助。第 1 步：像这样创建将从**PdfPageEventHelper继承的新类。**

```
public class ITextEvents : PdfPageEventHelper
{
public int pageNos { get; set; }

/// <summary>
/// CALLED ON EACH PAGE END PAGE, 
/// </summary>
/// <param name="writer"></param>
/// <param name="document"></param>
public override void OnEndPage(iTextSharp.text.pdf.PdfWriter writer, iTextSharp.text.Document document)
{
//LOGIC: TO SHOW DISCLAIMER ONLY ON LAST PAGE
if (document.PageNumber == pageNos)
{
//Create new Paragraph
Paragraph p = new Paragraph();
//ADD CHUNK IN PARAGRAPH
p.Add(new Chunk("Heading-Text: ", FontFactory.GetFont("Calibri",11,Font.BOLD)));
p.Add(new Chunk("Details sow in footer", FontFactory.GetFont("Calibri", 10)));
//PARAGRAPH TEXT ALIGNMENT. 
p.Alignment = Element.ALIGN_LEFT;
//CREATE PDF TABLE, FOR ADDING NEW CELL AND ROW IN THE PDF
PdfPTable footerTbl = new PdfPTable(1);
//SETING TABLE WIDTH
footerTbl.TotalWidth = 580;
footerTbl.HorizontalAlignment = Element.ALIGN_LEFT;
//ADDING CELL IN THE TABLE
PdfPCell cell = new PdfPCell(p);
//CELL LAYOUT DESIGN
cell.Border = 1;
cell.PaddingLeft = 10;
cell.PaddingRight = 10;
footerTbl.AddCell(cell);
//ADDING TABLE IN THE PDF
footerTbl.WriteSelectedRows(0, -1, 10, 110, writer.DirectContent);
}
}

/// <summary>
/// THIS METHOD WILL GET TOTAL PDF PAGES COUNT,
/// REQUIREMENT OF THIS METHOD WAS IS TO SHOW FOOTER ON LAST PAGE IN THE PDF. 
/// </summary>
/// <param name="HistoryHTML"></param>
/// <param name="Name"></param>
/// <param name="filePath"></param>
/// <returns></returns>
public int GetTotalPageCount(string HistoryHTML, String Name, string filePath)
{
try
{
using (MemoryStream stream = new System.IO.MemoryStream())
{
StringReader sr = new StringReader(HistoryHTML);
Document pdfDoc = new Document(PageSize.A4, 30f, 30f, 30f, 90f);
PdfWriter writer = PdfWriter.GetInstance(pdfDoc, stream);
pdfDoc.Open();
XMLWorkerHelper.GetInstance().ParseXHtml(writer, pdfDoc, sr);
pdfDoc.Close();

bool exists = System.IO.Directory.Exists(filePath);
if (!exists)
    System.IO.Directory.CreateDirectory(filePath);
System.IO.File.WriteAllBytes((filePath + @"\FileName-" + Name + ".pdf"), stream.ToArray());

string path = AppDomain.CurrentDomain.BaseDirectory + @"FolderPath\" + "FileName-" + Name + ".pdf";

PdfReader pdfReader = new PdfReader(path);
int numberOfPages = pdfReader.NumberOfPages;
pdfReader.Close();
stream.Close();
return numberOfPages;

}
}
catch (Exception ex)
{
CommonFunction.logElmahError(ex);
}
return -1;
}
} 
```

在从流生成 pdf 文件之前，调用此方法以获取总页数。

```
int pageCount = new Common.ITextEvents().GetTotalPageCount(HistoryHTML, Name, Server.MapPath("~/FolderPath")); 
```

为了更好地理解，我提供了控制器端代码。

```
public string ExportPDF(string HistoryHTML, String Name)
        {
            int pageCount = new Common.ITextEvents().GetTotalPageCount(HistoryHTML, Name, Server.MapPath("~/FolderPath"));

            using (MemoryStream stream = new System.IO.MemoryStream())
            {
                StringReader sr = new StringReader(HistoryHTML);
                Document pdfDoc = new Document(PageSize.A4, 30f, 30f, 30f, 30f);
                PdfWriter writer = PdfWriter.GetInstance(pdfDoc, stream);
                pdfDoc.Open();

                //APPEND DISCLAIMER TEXT ACCORING TO HIPAA RULES.
                writer.PageEvent = new Common.ITextEvents() { pageNo = pageCount };

                XMLWorkerHelper.GetInstance().ParseXHtml(writer, pdfDoc, sr);
                pdfDoc.Close();

                bool exists = System.IO.Directory.Exists(Server.MapPath("~/FolderPath"));
                if (!exists)
                    System.IO.Directory.CreateDirectory(Server.MapPath("~/FolderPath"));
                System.IO.File.WriteAllBytes(Server.MapPath("~/FolderPath/" + Name + ".pdf"), stream.ToArray());

                return File(stream.ToArray(), "application/pdf", "FileName-" + Name + "-" + Name + ".pdf");
            }
        } 
```

# java - 使用 java，如何获取 solaris zfs 文件系统上的可用空间量？

> ID：759912
> 
>         
> 
> 赞同：3
> 
>         
> 
> 时间：2009-04-17T10:30:56.280
> 
>         
> 
> 标签：java, file-io, zfs

使用 java，如何获取 solaris zfs 文件系统上的可用空间量？

我有一个 SunFire x4140，内置硬盘安装为 /。它还有一个连接的 JBOD，具有 7.6TB 的 HDD 空间，配置为 ZFS 文件系统并安装为 /app。

我使用 java.io.File.getUsableSpace 或 java.io.File.getFreeSpace 来获取文件系统上的可用空间量。在 /（板载）HDD FS 上它可以正常工作。

在 /app（zfs 分区）上，File.getFreeSpace、File.getUsableSpace 和 File.getTotalSpace 都返回 0（零）。有谁知道为什么？java.io.File.getUsableSpace 是否在 ZFS 上工作，如果可以，如何？

下面显示了相关机器上的 zfs 文件系统：

> /usr/sbin/zfs 列表

```
NAME                USED  AVAIL  REFER  MOUNTPOINT
internal            196K  98.4G     1K  none
internal/logs        18K  98.4G    18K  /logs
j4200-1             442G  7.57T  2.44K  none
j4200-1/app         442G  7.57T   153M  /app
j4200-1/app@first   442G      -   442G  - 
```

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T10:38:27.570

我不知道为什么，但您可能会看一下[libzfs](https://zfs.dev.java.net/)，它将 zfs 命令包装在一个不错的 java API 中

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2012-01-27T14:07:50.047

df -kP 命令返回可用空间，但最通用的方法是使用

Apache Commons IO 
 [FileSystemUtils.freeSpaceKb("/volume");](http://commons.apache.org/io/apidocs/org/apache/commons/io/FileSystemUtils.html#freeSpaceKb%28java.lang.String%29)

它利用 df 以及 Windows 的 dir

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T18:00:23.187

“df”命令报告什么？这是否也没有正确报告 zfs 上的可用空间？

# asp.net - 通过 ajax 调用页面时 ASP.Net 验证不起作用

> ID：759913
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T10:30:59.710
> 
>         
> 
> 标签：asp.net, validation

我有一个页面“MyPage.aspx”，它使用原型调用“MyForm.aspx”

new Ajax.Updater('display', '/myform.aspx' 等....

但是，当页面呈现时，页面上没有验证脚本。

即，当我通过 ajax 调用页面时，我看不到如下脚本。如果只是调用 myForm.aspx 我会看到以下脚本

```
<script type="text/javascript">
//<![CDATA[
var FlagForm1_RequiredFieldValidator1 = document.all ? document.all["FlagForm1_RequiredFieldValidator1"] : document.getElementById("FlagForm1_RequiredFieldValidator1");
FlagForm1_RequiredFieldValidator1.controltovalidate = "FlagForm1_TextBoxName";
FlagForm1_RequiredFieldValidator1.errormessage = "RequiredFieldValidator";
FlagForm1_RequiredFieldValidator1.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
FlagForm1_RequiredFieldValidator1.initialvalue = "";
var FlagForm1_RequiredFieldValidator2 = document.all ? document.all["FlagForm1_RequiredFieldValidator2"] : document.getElementById("FlagForm1_RequiredFieldValidator2");
FlagForm1_RequiredFieldValidator2.controltovalidate = "FlagForm1_TextBoxEmail";
FlagForm1_RequiredFieldValidator2.errormessage = "RequiredFieldValidator";
FlagForm1_RequiredFieldValidator2.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
FlagForm1_RequiredFieldValidator2.initialvalue = "";
var FlagForm1_RequiredFieldValidator3 = document.all ? document.all["FlagForm1_RequiredFieldValidator3"] : document.getElementById("FlagForm1_RequiredFieldValidator3");
FlagForm1_RequiredFieldValidator3.controltovalidate = "FlagForm1_TextBoxComment";
FlagForm1_RequiredFieldValidator3.errormessage = "RequiredFieldValidator";
FlagForm1_RequiredFieldValidator3.evaluationfunction = "RequiredFieldValidatorEvaluateIsValid";
FlagForm1_RequiredFieldValidator3.initialvalue = "";
//]]>
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2009-04-20T21:10:14.097

你需要设置 evalscripts:true。正如属性名称所暗示的，这允许对脚本进行评估。此外，您需要将脚本放在父页面中。

```
 var myAjax = new Ajax.Updater(
                    'container',
                    url,
                    {
                    asynchronous:true,
                    method: 'get',
                    parameters: pars,
                    evalScripts: true,
                    onFailure: reportError
                    }
                 ); 
```

# sharepoint - 是否可以限制 Sharepoint 列表视图中显示的文本行？

> ID：759915
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-17T10:31:14.030
> 
>         
> 
> 标签：sharepoint

解释这一点的最清晰方法是使用图像：

[http://i42.tinypic.com/fc1gdk.png](http://i42.tinypic.com/fc1gdk.png)

我只想显示“解决方案”字段的前两行，否则如果解决方案很长，浏览列表会变得非常困难。这可能吗？我查看了列表和视图选项，但没有任何明显之处。

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T11:22:05.173

看不到图像，企业阻塞，但对于文本列，这将起作用。

创建一个新列并计算它，使公式 =left("your column",2000) 然后在您的视图中使用计算的列。

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2010-08-05T20:09:17.763

这是如何做到的，是的，它有点复杂：

首先，创建一个单行文本列，我将其命名为 Content

二、创建一个计算列，我称之为ContentCalc，设置公式为=[Content]

三、删除第一列Content，然后重新创建为多行文本列

第四，创建第三列，我将其命名为 Summary，并将公式设置为 =LEFT([ContentCalc],60)，其中 60 是您想要截断的任意数量的字符

最后，为了摆脱这些东西，将以下源插入到列表下方的内容编辑器 Web 部件中：

```
<script type="text/javascript">
  var theTDs = document.getElementsByTagName("TD");
  var i=0;
  var TDContent = " ";
  while (i < theTDs.length)
  {
    try
    {
      TDContent = theTDs[i].innerText || theTDs[i].textContent;
      if (TDContent.indexOf("<div") == 0)
        {
          theTDs[i].innerHTML = TDContent;
        }
    }
  catch(err){}
  i=i+1;
  }
</script> 
```

我从这个链接中得到了大部分内容，但我不得不稍微修改一下说明，而且仍然需要一段时间才能完全正确地实施。

然后，如果您想让 Calc 列不显示在“显示”表单中，则必须创建一个自定义表单。

注意：此 javascript 不适用于扩展富文本，因为它会在截断后影响，并且 div 标记对于我截断的数量来说太长了。通过扩展截断中的字符数量，我能够使其大部分工作。还有一些边缘情况我还没有完全弄清楚。

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2018-06-27T14:11:10.743

这是一个旧线程，但以防万一有人偶然发现它寻求帮助……有一种更简单的方法可以通过 html 代码完成此操作。查看列表时，编辑页面。添加 Web 部件：内容和媒体 > 脚本编辑器并粘贴以下代码。

```
<style type="text/css">
.ms-vb2 .ms-rtestate-field {
max-width: 250px;
max-height: 38px;
overflow: hidden;
}

.ms-vb2 .ms-rtestate-field:hover {
max-height: none;
}
</style>
<h2>
</h2> 
```

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2011-11-03T11:46:59.033

使用如下所述的展开折叠技巧：http: [//salaudeen.blogspot.com/2010/07/expand-collapse-for-multiline-text.html](http://salaudeen.blogspot.com/2010/07/expand-collapse-for-multiline-text.html)

# c++ - 需要用户输入字符串/检查字符串长度（C++）

> ID：759920
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T10:33:18.300
> 
>         
> 
> 标签：c++, string, input

我需要从用户那里接受一串 5 个数字（只有 5 个）。我应该使用

```
istringstream 
```

对于相同的 ？

我不能逃避这样的事情吗？

```
int main()
{
    char *InputMain;
    InputMain=(char *)malloc(5+1);
    cout << "Enter the number : " <<endl;
    cin.getline ( InputMain, 5, '\n' );              // Input goes into InputMain
    cout << "The number entered is : " << InputMain <<endl;
    cin.get();
} 
```

然后是下一部分。。

我如何确保用户只输入 5 个字符？也许如果用户输入超过 5 个字符，我应该显示一个警告，说只允许 5 个字符..

还有一个问题，因为这本质上是一个字符串，所以我需要通过解析字符串中的每个字符并检查相应的 ASCII 值（对于数字）来验证输入是否仅为数字。这种方法是否正确？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T10:40:27.597

不幸的是，没有可移植的方法来限制 C++ 中输入的字符数。但无论您使用什么平台，都会提供一些机制：例如在 Windows 上，查找[Console functions](http://msdn.microsoft.com/en-us/library/ms682073(VS.85).aspx)。

如果您确实使用来自 的普通旧 C++ iostreams 输入`cin`，那么将初始文本读入`std::string`using是一个好主意`istream& getline(istream&, string&)`——这将防止缓冲区溢出，因为`string`s 会根据需要调整大小。（您涉及`getline(InputMain, 5, '\n')`的代码在技术上是安全的，因为它不会将超过 5 个字符读入`InputMain`，但此代码很脆弱 - 如果您后来决定需要 6 个字符，您很容易忘记更新对 的调用`malloc()`，从而导致崩溃。另外，您需要记住`free(InputMain)`. 但正如我所说，请`string`改用。）

**关于解析：**

无论您将输入读入`string`使用`getline(cin, str)`代码还是某些特定于平台的代码，一旦输入，您需要以数字的形式将其取出。这是`istringstream`该类有用的地方——它允许您将现有的`string`视为要读取的流，因此您可以使用格式化的输入`>>`运算符：

```
string str;
if (!getline(cin, str)) {
    cerr << "Something went seriously wrong...\n";
}

istringstream iss(str);
int i;
iss >> i;    // Extract an integer value from the stream that wraps str

if (!iss) {
    // Extraction failed (or a more serious problem like EOF reached)
    cerr << "Enter a number dammit!\n";
} else if (i < 1000 || i > 9999) {
    cerr << "Out of range!\n";
} else {
    // Process i
} 
```

如果您使用的是 C++ iostreams，您实际上可以直接从中提取，`cin`而不是通过 a`string`和 an `istringstream`：

```
int i;
cin >> i;    // Extract an integer value from cin 
```

然而，这可能会产生微妙的不良影响；值得注意的是，用户键入的行上的任何其他字符（特别是`'\n'`当他们按下 Enter 键时键入的字符）都将保留在输入缓冲区中以供下一个`<<`操作读取。通常这无关紧要，但有时确实如此：例如，如果您跟进`cin.get();`，期望这将等待按键，它不会 - 它只会读取`'\n'`（或用户键入的第一个非数字字符）。

# java - JarScan，扫描特定类的所有子文件夹中的所有 JAR 文件

> ID：759923
> 
>         
> 
> 赞同：10
> 
>         
> 
> 时间：2009-04-17T10:35:05.457
> 
>         
> 
> 标签：java, class, jar

尽管我们部署了最新版本，但我们看到正在使用的类的旧版本。要扫描应用服务器的所有子文件夹中的所有 JAR 文件，我们如何编写一个小的 shell 脚本来打印找到该特定类的 JARS 文件的文件名？

* * *

## 回答 #1

> 赞同：19
> 
>             
> 
> 时间：2009-04-17T10:56:00.353

就像是：

```
find . -name '*.jar' | while read jarfile; do if jar tf "$jarfile" | grep org/jboss/Main; then echo "$jarfile"; fi; done 
```

你可以这样总结：

```
jarscan() {
  pattern=$(echo $1 | tr . /)
  find . -name '*.jar' | while read jarfile; do if jar tf "$jarfile" | grep "$pattern"; then echo "$jarfile"; fi; done
} 
```

然后`jarscan org.jboss.Main`会在当前目录下找到的所有jar文件中搜索该类

* * *

## 回答 #2

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T10:53:19.330

不直接回答您的问题，但也许这会解决您的问题：您可以通过在代码中添加一个简单的行来打印出加载特定类的位置（例如 jar 文件）：

```
System.err.println(YourClass.class.getProtectionDomain().getCodeSource()); 
```

然后你就会确定它来自哪里。

* * *

## 回答 #3

> 赞同：3
> 
>             
> 
> 时间：2009-05-18T19:37:54.067

[JAR Explorer](https://github.com/javalite/jar-explorer)工具非常有用。

它会弹出一个带有两个面板的 GUI 窗口。您可以选择一个目录，该工具将扫描该目录中的所有 JAR 文件，然后让您搜索特定的类。然后，下方面板会亮起，其中列出了所有扫描的 JAR 文件中该类的命中列表。

* * *

## 回答 #4

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T10:38:30.910

如果您只需要结果，那么您可以安装 agentransack [http://www.mythicsoft.com/agenttransack/](http://www.mythicsoft.com/agentransack/)并进行包含文本搜索。Agentransack 也会在 jar 和 zip 文件中进行搜索。

* * *

## 回答 #5

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:36:20.667

现在在这里回答这个问题是一个简单的 shell 命令，它为我们做了这个。

```
for jarFile in $(
    ls -R | 
    awk '
        match($0, ".*:") { 
            folder=$0 
        } 
        ! match($0, ".*:") {
            print folder$0 
        }' | 
        grep "\.jar" | 
        sed -e "s/:/\//g"
); 
do  
    unzip -l $jarFile; 
done | 
awk '
    match($0, "Archive.*") { 
        jar=$0 
    } 
    ! match($0, "Archive.*") {
        print jar" : "$0 
    }' | 
grep org.jboss.Main 
```

* * *

## 回答 #6

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:46:34.103

几年前，我编写了一个实用程序[类查找](http://www.oopsconsultancy.com/software/classfind/index.html)来解决此类问题。将您的类路径设置为指向您的 .jar 集，classfind 会告诉您它将在哪些 jar 中找到特定的类。

```
example% classfind -c Document
/usr/java/j2sdk1.4.0/jre/lib/rt.jar -> org.w3c.dom.Document
/usr/java/j2sdk1.4.0/jre/lib/rt.jar -> javax.swing.text.Document 
```

* * *

## 回答 #7

> 赞同：1
> 
>             
> 
> 时间：2009-09-21T13:08:30.077

您可能还想看看 Java 工具[JarScan](https://jarscan.dev.java.net/)。

可以按类名和包搜索。

当 Total Commander 不可用并且只允许执行 Java 时，它会很有帮助。

* * *

## 回答 #8

> 赞同：1
> 
>             
> 
> 时间：2011-06-01T08:28:38.213

```
#! /bin/sh

path=$1
segment=$2

if [ -z "$path" ] || [ -z "$segment"  ]
then 
    echo "Usage: $0 <path> <segment>"
    exit
fi

for jar in $path/*.jar ; do echo " *** $jar *** " ; jar tf $jar| grep --color=always $segment; done; 
```

# sql - mysql中的运算符优先级

> ID：759925
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T10:35:22.947
> 
>         
> 
> 标签：sql, mysql

哪个运算符：`/`或`*`将具有更高的优先级`MySQL`？

* * *

## 回答 #1

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T10:39:48.660

像大多数编程语言一样，mysql按照它们出现的顺序从左到右执行`/`和（以及 DIV、% 和 MOD）。`*`例如：

```
1 / 2 * 3 / 4 / 5 * 6 
```

相当于

```
((((1 / 2) * 3) / 4) / 5) * 6 
```

有关运算符优先级的完整列表，请参阅[http://dev.mysql.com/doc/refman/5.0/en/operator-precedence.html](http://dev.mysql.com/doc/refman/5.0/en/operator-precedence.html)。

* * *

## 回答 #2

> 赞同：2
> 
>             
> 
> 时间：2009-04-17T10:40:00.093

运算符按优先级从高到低排列：

1.  二进制，整理

2.  NOT（逻辑否定），！（逻辑否定）

3.  .- (一元减号), ~ (一元位反转)

4.  ^（按位异或比较）

5.  .* (乘法), / (除法), % (模数)

6.  .-（减法），+（加法）

7.  <<（左移），>>（右移）

8.  &（按位与）

9.  | （按位或）

10.  < > 等比较运算符

11.  之间，而不是之间

12.  AND &&（连接 - 逻辑加法）

13.  XOR（逻辑异或比较）

14.  或 || （析取 - 要么/或比较）

根据列表，比较 BINARY 运算符优先于 BETWEEN 和 & 运算符。上面同一行的运算符具有相同的优先级，并按使用顺序进行评估。

来源[http://www.learn-mysql-tutorial.com/Expressions.cfm](http://www.learn-mysql-tutorial.com/Expressions.cfm)

* * *

## 回答 #3

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:38:27.057

它们是相同的，请参见[http://dev.mysql.com/doc/refman/5.0/en/operator-precedence.html](http://dev.mysql.com/doc/refman/5.0/en/operator-precedence.html)

* * *

## 回答 #4

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T10:39:58.067

它们具有相同的优先级，* 列在最前面，MySQL 将从左到右计算。

[http://dev.mysql.com/doc/refman/5.0/en/operator-precedence.html](http://dev.mysql.com/doc/refman/5.0/en/operator-precedence.html)

我的建议是使用方括号 () 来说明问题。

最好检查一下，这可以通过 MySQL 轻松完成：

```
mysql> SELECT 2*3/2, 2/3*2, 2*(3/2) ;
+--------+--------+---------+
| 2*3/2  | 2/3*2  | 2*(3/2) |
+--------+--------+---------+
| 3.0000 | 1.3333 |  3.0000 | 
+--------+--------+---------+
1 row in set (0.00 sec) 
```

* * *

## 回答 #5

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:38:23.407

> / 或 * 将在 mysql 中具有最高优先级。

它们具有相同的优先级。

* * *

## 回答 #6

> 赞同：0
> 
>             
> 
> 时间：2009-04-18T11:18:05.703

答案是：应该没关系。如果您有一个不确定如何计算的表达式，请使用括号。他们是免费的。

# html - 富文本 IDE

> ID：759961
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T10:47:14.087
> 
>         
> 
> 标签：html, css, ide, fckeditor

有谁知道基于 javascript 的富文本框，它的行为有点像 IDE，因此在管理系统中，我可以为 CSS 和/或 HTML 提供一个文本区域以将其写入框中，并且输入是彩色编码的如果您在 Notepad++、Visual Studio 等中进行编辑，颜色的自定义将非常棒，但肯定不是必需的！

我确信必须至少有一个，但我很难通过谷歌搜索找到任何结果，而是获得了 FCKEditor 样式富文本框的大量结果。

谢谢你的帮助！

史蒂夫

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T11:14:10.370

[CodeMirror 看起来](http://marijn.haverbeke.nl/codemirror/)像你想要的。

我也打算推荐[Bespin](http://labs.mozilla.com/projects/bespin/)，但我认为浏览器技术需要赶上它（它使用 HTML 5 等）

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T11:16:17.247

我对你需要什么感到有点困惑。我的理解是您正在寻找一种工具，您在一个文本框中输入 HTML，在另一个文本框中输入 CSS，并且该工具将样式应用于 HTML 以像 Notepad++ 中一样为 HTML 着色。

如果是这种情况，我不知道您期望的最终结果是什么。它是内联样式，以便您可以将结果粘贴到页面上并显示它吗？对我来说，这一切听起来会让事情变得比你手工做的更复杂——可维护性等等。我认为你不会在任何地方找到这样的工具，这对我来说似乎不合逻辑。

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T11:28:11.943

不确定我是否理解你的问题，但你应该看看 
[syntaxhighlighter](http://code.google.com/p/syntaxhighlighter/)

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T12:58:27.890

我也从另一个来源发送了这个，用于另一个名为“CodePress”的选项：[Sourceforge 上的 CodePress 链接](http://sourceforge.net/projects/codepress) 

这包括行号和不同的语言选项，我认为可能对某人有用，从外观上看，我更喜欢这个选项而不是 CodeMirror。

# reporting-services - 从总计中排除隐藏的表格行

> ID：759963
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T10:48:04.053
> 
>         
> 
> 标签：reporting-services

我创建了一个带有组过滤器的表，因此一些值保持隐藏。但是，显示上述值的 sum() 的行仍然计算过滤后的值。

通常我会将过滤器应用于查询，但我也在同一个报告的其他表中使用相同的数据集，所以这不是一个选项。

我在这里遗漏了什么，还是这是 MS Reporting Services 中的一个缺陷？

* * *

## 回答 #1

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T12:40:23.223

这似乎是 SSRS 的“功能”，显然是因为它在呈现数据表的详细信息部分之前计算表头和表尾中的值。

解决此问题的一种方法是将派生的布尔列添加到您的数据集（假设您的数据源是 SQL Server，使用 CASE 语句或类似语句）显示是否应从需要过滤器的表中排除该行。

然后，您可以更改表格过滤器以检查指标，并使用表达式执行条件求和以汇总正确的总数。就像是

```
=SUM(Iif(Fields!ExcludeRow.Value = True,0,Fields!ValueToSum.Value)) 
```

* * *

## 回答 #2

> 赞同：1
> 
>             
> 
> 时间：2009-11-24T19:18:16.313

这更像是一个问题而不是答案......

如果您仅在行组级别知道该行是否隐藏，如何解决此问题？

即，如果您正在按此行组过滤总计，即您不能有一个字段来指示数据集中是否排除了行。

例如：我有 AR 老化报告，其中有每个月的总数，患者。我需要过滤掉每个患者（患者行组）的负总数，但我也有列组 - 每个月，所以我的数据集不能是每个患者的粒度，因此，SSRS 唯一可以决定是隐藏还是显示行位于行组级别...

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2013-09-27T14:24:30.373

我遇到了同样的问题，但是我有太多的列总计在哪里输入 Iif()。我通过从组中删除过滤器并将过滤器放入 Tablix 属性对话框来解决它（选择 Tablix，右键单击左上角的灰色框并选择 Tablixc 属性）。

# c# - 在“foreach”循环中修改列表的最佳方法是什么？

> ID：759966
> 
>         
> 
> 赞同：96
> 
>         
> 
> 时间：2009-04-17T10:48:53.803
> 
>         
> 
> 标签：c#, .net, list, enumeration, enumerable

C# / .NET 4.0 中的一个新特性是您可以在 a 中更改您的枚举`foreach`而不会出现异常。有关此更改的信息，请参阅 Paul Jackson 的博客条目*[并发的有趣副作用：在枚举时从集合中删除项目。](https://web.archive.org/web/20160308065012/www.lovethedot.net/2009/03/interesting-side-effect-of-concurrency.html)*

执行以下操作的最佳方法是什么？

```
foreach(var item in Enumerable)
{
    foreach(var item2 in item.Enumerable)
    {
        item.Add(new item2)
    }
} 
```

通常我使用 an`IList`作为缓存/缓冲区直到 结束`foreach`，但是有更好的方法吗？

* * *

## 回答 #1

> 赞同：86
> 
>             
> 
> 时间：2009-04-17T10:56:17.700

foreach 中使用的集合是不可变的。这在很大程度上是设计使然。

[正如MSDN](http://msdn.microsoft.com/en-us/library/ttw7t8t6.aspx)上所说：

> foreach 语句用于遍历集合以获取您想要的信息，但不能用于从源集合中添加或删除项目以避免不可预知的副作用。**如果您需要从源集合中添加或删除项目，请使用 for 循环。**

[Poko 提供的链接](http://www.lovethedot.net/2009/03/interesting-side-effect-of-concurrency.html)中的帖子表明这在新的并发集合中是允许的。

* * *

## 回答 #2

> 赞同：15
> 
>             
> 
> 时间：2009-04-17T10:56:48.837

在这种情况下使用 IEnumerable 扩展方法制作枚举的副本，然后对其进行枚举。这会将每个内部可枚举中的每个元素的副本添加到该枚举。

```
foreach(var item in Enumerable)
{
    foreach(var item2 in item.Enumerable.ToList())
    {
        item.Add(item2)
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
>             
> 
> 时间：2015-08-26T12:04:23.040

为了说明 Nippysaurus 的答案：如果您要将新项目**添加**到列表中并且想在同一个枚举期间也处理新添加的项目，那么您可以只使用**for**循环而不是**foreach**循环，问题解决了 :)

```
var list = new List<YourData>();
... populate the list ...

//foreach (var entryToProcess in list)
for (int i = 0; i < list.Count; i++)
{
    var entryToProcess = list[i];

    var resultOfProcessing = DoStuffToEntry(entryToProcess);

    if (... condition ...)
        list.Add(new YourData(...));
} 
```

对于可运行的示例：

```
void Main()
{
    var list = new List<int>();
    for (int i = 0; i < 10; i++)
        list.Add(i);

    //foreach (var entry in list)
    for (int i = 0; i < list.Count; i++)
    {
        var entry = list[i];
        if (entry % 2 == 0)
            list.Add(entry + 1);

        Console.Write(entry + ", ");
    }

    Console.Write(list);
} 
```

最后一个例子的输出：

0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 1, 3, 5, 7, 9,

清单（15 项） 

0 

1 

2 

3 

4 

5 

6 

7 

8 

9 

1 

3 

5 

7 

9

* * *

## 回答 #4

> 赞同：8
> 
>             
> 
> 时间：2009-04-28T23:36:16.397

如前所述，但带有代码示例：

```
foreach(var item in collection.ToArray())
    collection.Add(new Item...); 
```

* * *

## 回答 #5

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T10:51:32.033

在这种情况下，您应该真正使用`for()`而不是。`foreach()`

* * *

## 回答 #6

> 赞同：4
> 
>             
> 
> 时间：2009-04-17T12:17:12.763

您不能在枚举时更改可枚举集合，因此您必须在枚举之前或之后进行更改。

`for`循环是一个不错的选择，但如果你的集合`IEnumerable`没有实现`ICollection`，那就不可能了。

任何一个：

1）先复制收藏。枚举复制的集合并在枚举过程中更改原始集合。(@tvanfosson)

或者

2）保留更改列表并在枚举后提交。

* * *

## 回答 #7

> 赞同：3
> 
>             
> 
> 时间：2009-04-17T11:02:43.223

这是您可以做到的（快速而肮脏的解决方案。如果您*真的*需要这种行为，您应该重新考虑您的设计或覆盖所有`IList<T>`成员并聚合源列表）：

```
using System;
using System.Collections.Generic;

namespace ConsoleApplication3
{
    public class ModifiableList<T> : List<T>
    {
        private readonly IList<T> pendingAdditions = new List<T>();
        private int activeEnumerators = 0;

        public ModifiableList(IEnumerable<T> collection) : base(collection)
        {
        }

        public ModifiableList()
        {
        }

        public new void Add(T t)
        {
            if(activeEnumerators == 0)
                base.Add(t);
            else
                pendingAdditions.Add(t);
        }

        public new IEnumerator<T> GetEnumerator()
        {
            ++activeEnumerators;

            foreach(T t in ((IList<T>)this))
                yield return t;

            --activeEnumerators;

            AddRange(pendingAdditions);
            pendingAdditions.Clear();
        }
    }

    class Program
    {
        static void Main(string[] args)
        {
            ModifiableList<int> ints = new ModifiableList<int>(new int[] { 2, 4, 6, 8 });

            foreach(int i in ints)
                ints.Add(i * 2);

            foreach(int i in ints)
                Console.WriteLine(i * 2);
        }
    }
} 
```

* * *

## 回答 #8

> 赞同：3
> 
>             
> 
> 时间：2015-03-30T08:53:51.080

[LINQ](http://en.wikipedia.org/wiki/Language_Integrated_Query)对于处理集合非常有效。

你的类型和结构对我来说不清楚，但我会尽我所能来适应你的例子。

从您的代码看来，对于每个项目，您都从它自己的“可枚举”属性中添加了该项目的所有内容。这很简单：

```
foreach (var item in Enumerable)
{
    item = item.AddRange(item.Enumerable));
} 
```

作为一个更一般的例子，假设我们想要迭代一个集合并删除某个条件为真的项目。避免`foreach`，使用 LINQ：

```
myCollection = myCollection.Where(item => item.ShouldBeKept); 
```

根据每个现有项目添加项目？没问题：

```
myCollection = myCollection.Concat(myCollection.Select(item => new Item(item.SomeProp))); 
```

* * *

## 回答 #9

> 赞同：1
> 
>             
> 
> 时间：2013-01-27T19:05:03.240

从性能角度来看，最好的方法可能是使用一个或两个数组。将列表复制到数组，对数组进行操作，然后从数组中构建一个新列表。访问数组元素比访问列表项要快，并且 a`List<T>`和 a之间的转换`T[]`可以使用快速的“批量复制”操作，从而避免访问单个项目相关的开销。

例如，假设您有一个`List<string>`并希望列表中以`T`“Boo”开头的每个字符串后跟一个项目，而以“U”开头的每个字符串都被完全删除。最佳方法可能是这样的：

```
int srcPtr,destPtr;
string[] arr;

srcPtr = theList.Count;
arr = new string[srcPtr*2];
theList.CopyTo(arr, theList.Count); // Copy into second half of the array
destPtr = 0;
for (; srcPtr < arr.Length; srcPtr++)
{
  string st = arr[srcPtr];
  char ch = (st ?? "!")[0]; // Get first character of string, or "!" if empty
  if (ch != 'U')
    arr[destPtr++] = st;
  if (ch == 'T')
    arr[destPtr++] = "Boo";
}
if (destPtr > arr.Length/2) // More than half of dest. array is used
{
  theList = new List<String>(arr); // Adds extra elements
  if (destPtr != arr.Length)
    theList.RemoveRange(destPtr, arr.Length-destPtr); // Chop to proper length
}
else
{
  Array.Resize(ref arr, destPtr);
  theList = new List<String>(arr); // Adds extra elements
} 
```

如果`List<T>`提供一种从数组的一部分构造列表的方法会很有帮助，但我不知道有任何有效的方法可以做到这一点。尽管如此，对数组的操作还是相当快的。值得注意的是，从列表中添加和删除项目不需要“推动”其他项目。每个项目都直接写入数组中的相应位置。

* * *

## 回答 #10

> 赞同：1
> 
>             
> 
> 时间：2018-09-21T12:50:39.447

要添加到蒂莫的答案 LINQ 也可以这样使用：

```
items = items.Select(i => {

     ...
     //perform some logic adding / updating.

     return i / return new Item();
     ...

     //To remove an item simply have logic to return null.

     //Then attach the Where to filter out nulls

     return null;
     ...

}).Where(i => i != null); 
```

* * *

## 回答 #11

> 赞同：0
> 
>             
> 
> 时间：2018-10-30T09:13:17.073

我已经写了一个简单的步骤，但是因为这个性能会下降

这是我的代码片段：-

```
for (int tempReg = 0; tempReg < reg.Matches(lines).Count; tempReg++)
                            {
                                foreach (Match match in reg.Matches(lines))
                                {
                                    var aStringBuilder = new StringBuilder(lines);
                                    aStringBuilder.Insert(startIndex, match.ToString().Replace(",", " ");
                                    lines[k] = aStringBuilder.ToString();
                                    tempReg = 0;
                                    break;
                                }
                            } 
```

# asp.net - 服务器.执行

> ID：759967
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T10:49:39.963
> 
>         
> 
> 标签：asp.net

你好

我在我的 default.aspx 中使用 server.execute 来调用 default2.aspx 是否可以触发 default2.aspx 页面并控制来自 default.aspx 的事件

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T11:01:41.603

当你不得不使用这样的东西时，你的 Web 应用程序的架构有问题。深入了解母版页并尝试按照设计使用的方式使用 ASP.NET。

# windows - 自定义安装操作

> ID：759969
> 
>         
> 
> 赞同：1
> 
>         
> 
> 时间：2009-04-17T10:49:57.950
> 
>         
> 
> 标签：windows, installation, service

我现在找到了很多例子，但我没有一个更聪明。

简介很简单。在安装期间，应该会弹出一个对话框并询问用户数据库凭据。然后应该使用这些来创建注册表项。密钥的路径始终相同，但密钥本身是从用户输入生成的数据库连接字符串。

它应该要求提供服务器、数据库名称、用户和密码。有一个“测试”按钮会很好，但不是必需的。

这是针对 Windows 服务的。

看起来我要添加一个从安装程序继承并覆盖安装和卸载方法的类。在信息变得乱码之前，这大约是我所得到的。

这些信息不在我的书中:)。在安装我的服务并使用对表单的响应来生成注册表项时如何向用户呈现表单的任何想法。

干杯

ps

回应回应；）。环境为Visual Studio，目标系统为windows 2003。服务器采用.net framework V2开发。

这是在安装服务的 Visual Studio 中创建的标准设置项目。

* * *

## 回答 #1

> 赞同：2
> 
>             
> 
> 时间：2009-04-18T12:46:16.383

Visual Studio 作为安装作者非常有限，我什至不确定它是否可以实现您所追求的目标。如果您一定要使用 Windows Installer，我建议您看一下[WiX](http://wix.sourceforge.net/)。如果没有，[NSIS](http://nsis.sourceforge.net/)可能是适合您的工具。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T11:09:44.563

您应该从描述您的环境开始——您的目标是 Windows Installer 吗？您使用的是哪个安装创作软件。另请注意，纯文本注册表值可能不是存储用户凭据的最佳选择。

# asp.net - 用于 Google Chrome 的 Javascript 检测和在 Google Chrome 中启用 javascript

> ID：759973
> 
>         
> 
> 赞同：2
> 
>         
> 
> 时间：2009-04-17T10:50:57.043
> 
>         
> 
> 标签：asp.net, javascript, asp.net-ajax, cross-browser

我的应用程序的 JavaScript 可以在 Firefox 和 IE 上运行，但不能在 Google Chrome 上运行。是在谷歌浏览器中启用 javascript 的问题吗？或者我必须将任何代码放入 javascript 中以获取 Google chrome 浏览器的 XMLHttpRequest 对象。

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2011-12-26T01:01:03.633

如果代码在其他两个浏览器中有效，但在 Chrome 中无效，您需要查看“ajaxFunction”的代码，因为这显然是让 Chrome 头疼的原因。正如@Artem 提到的，Ctrl+Shift+J 将调出 Javascript 控制台（将其切换到“脚本”选项卡），您可以轻松检查任何错误。

* * *

## 回答 #2

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T10:58:25.683

Google Chrome 的 Javascript 引擎对 JS 的解释与提到的其他浏览器非常相似。什么似乎不起作用？

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T11:18:11.423

Chrome 中有一个 Javascript 控制台，按 Ctrl+Shift+J 打开它并检查错误。

* * *

## 回答 #4

> 赞同：0
> 
>             
> 
> 时间：2009-07-02T13:09:22.617

[这个问题](https://stackoverflow.com/questions/508994/asp-net-dropdownlist-autopostback-and-google-chrome)与这个问题有关吗？问题可能是 .NET 认为您使用的是 Safari 浏览器而不是 Chrome ......

# asp.net - 清除 CreateUserWizard、登录控件上的字段

> ID：759980
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T10:54:26.113
> 
>         
> 
> 标签：asp.net, login, createuserwizard

我在页面上有一个 createuserwizard 和一个登录控件。它们都是自定义的（标准文本框被 RadTextBoxes 替换）

当我在表单中输入一个值并刷新浏览器而不提交时，表单会保留它们的值。有什么办法可以在刷新时清除这些字段。

我已经尝试在控件上设置 settinf EnableViewState false（如网络上的某处所见），但它不起作用

如果页面为 !IsPostBack，我已在页面加载中添加代码以清除字段。它看起来像这样

```
 if (!IsPostBack)
    {
        ((RadTextBox)Login1.FindControl("Username")).Text="";
        ((RadTextBox)Login1.FindControl("Password")).Text = "";

        ((RadTextBox)CreateUserWizard1.CreateUserStep.ContentTemplateContainer.FindControl("Username")).Text = "";
        ((RadTextBox)CreateUserWizard1.CreateUserStep.ContentTemplateContainer.FindControl("Password")).Text = "";
        ((RadTextBox)CreateUserWizard1.CreateUserStep.ContentTemplateContainer.FindControl("confirmPassword")).Text = "";
        ((RadTextBox)CreateUserWizard1.CreateUserStep.ContentTemplateContainer.FindControl("Email")).Text = "";
    } 
```

仍然无济于事任何建议

* * *

## 回答 #1

> 赞同：0
> 
>             
> 
> 时间：2010-03-31T10:28:34.857

原来是Mozilla firefox中RadTextBox的行为

# ruby - 开源 Ruby 加密 Gem 的建议

> ID：759989
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T10:57:04.640
> 
>         
> 
> 标签：ruby, rubygems

我需要一个 gem 来在 Ruby 中对要存储在数据库中的值执行简单的字符串加密和解密。任何人都可以建议一个好的开源 gem 来使用它吗？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T11:25:02.733

这取决于您对简单的含义 - 加密算法或 gem 的使用？

如果你需要非玩具加密，那么我建议你看看'crypt' gem。

# vb.net - VB.NET 如何将 int 减少到小数点后 1 位？

> ID：759990
> 
>         
> 
> 赞同：5
> 
>         
> 
> 时间：2009-04-17T10:57:27.260
> 
>         
> 
> 标签：vb.net

我正在使用下面的代码将文件大小以字节为单位（测试文件为 31718 字节）转换为 KB（30.974609375 KB），但我想将其显示到小数点后一位（即 30.9 KB）。我将如何在 VB.NET 中执行此操作？

```
New FileInfo(FileName).Length / 1024 
```

谢谢

* * *

## 回答 #1

> 赞同：11
> 
>             
> 
> 时间：2009-04-17T11:01:16.050

```
Math.Round(New FileInfo(FileName).Length / 1024,1) 
```

* * *

## 回答 #2

> 赞同：6
> 
>             
> 
> 时间：2009-04-17T11:03:54.030

如果只是显示输出需要四舍五入，则使用 ToString 中的格式

```
Double.ToString("0.0") 
```

* * *

## 回答 #3

> 赞同：0
> 
>             
> 
> 时间：2009-04-17T13:17:47.750

如果您需要将其截断但不四舍五入（如您的示例所示），则使用 Math.FLoor()

```
 Decimal val = Math.Floor(New FileInfo(FileName).Length / 102.4) / 10; 
```

# html - 控制第三方脚本图像的大小

> ID：759993
> 
>         
> 
> 赞同：0
> 
>         
> 
> 时间：2009-04-17T11:00:03.713
> 
>         
> 
> 标签：html

我的网页中嵌入了以下脚本：

```
<script src="http://www.weatherforecastmap.com/weather2.php?zona=malaysia_kuala-lumpur" ></script> 
```

鉴于脚本将显示图像，我将脚本嵌入到面板中。无论如何确保图像脚本会根据屏幕尺寸自动调整大小（以便图像始终位于面板内）？

* * *

## 回答 #1

> 赞同：1
> 
>             
> 
> 时间：2009-04-17T11:04:00.647

将该脚本放在具有固定宽度的 div 中并设置图像样式 - 即：

```
<div id="thescript">
  <script src="..."></script>
</div> 
```

风格：

```
/* CSS */
#thescript{
  width: 200px;
  height: 200px;
  overflow: hidden;
}

/* alternative */
#thescript img{
  width: 200px;
} 
```

另一方面，如果您想依赖屏幕尺寸，那么我猜您正在搜索 % 宽度而不是固定像素。*** 
```